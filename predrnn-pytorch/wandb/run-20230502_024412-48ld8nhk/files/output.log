
load model: /work/09012/haoli1/ls6/ERA5_PredRNN/checkpoints/WV_0_PC_1_EH_0_PS_40/model_test_schedule_sampling_DynaMean.ckpt
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012001_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012002_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012003_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012004_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012005_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012006_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012007_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012008_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012009_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012010_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012011_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012012_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012013_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012014_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012015_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012016_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012017_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012018_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012019_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012020_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012000_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012001_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012002_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012003_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012004_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012005_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012006_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012007_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012008_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012009_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012010_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012011_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012012_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012013_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012014_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012015_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012016_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012017_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012018_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012019_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012020_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012000_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012001_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012002_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012003_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012004_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012005_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012006_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012007_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012008_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012009_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012010_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012011_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012012_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012013_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012014_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012015_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012016_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012017_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012018_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012019_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012020_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012000_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012001_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012002_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012003_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012004_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012005_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012006_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012007_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012008_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012009_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012010_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012011_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012012_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012013_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012014_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012015_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012016_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012017_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012018_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012019_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012020_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012000_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012001_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012002_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012003_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012004_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012005_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012006_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012007_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012008_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012009_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012010_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012011_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012012_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012013_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012014_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012015_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012016_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012017_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012018_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012019_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012000_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012001_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012002_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012003_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012004_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012005_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012006_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012007_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012008_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012009_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012010_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012011_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012012_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012013_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012014_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012015_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012016_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012017_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012018_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012019_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012020_3_24hr.npz
train_data_files nums: 124
mnist test iterator, Loading data from /scratch/09012/haoli1/ERA5/val_dataset/era5_train_09012020_3_24hr.npz
NaN value num: 0
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012018_3_24hr.npz
NaN value num: 0
Iteration: 1, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44728925824165344, gen p mean: -0.0594337061047554, mean p set: 0.44776955246925354
loss_pred:0.014639350585639477, decouple_loss:0.0009447744814679027
The modified gen p mean: 0.4476151466369629, gen p mean: -0.0550389438867569, mean p set: 0.448095440864563
loss_pred:0.014148085378110409, decouple_loss:0.0009718866785988212
The modified gen p mean: 0.4487624168395996, gen p mean: -0.051923274993896484, mean p set: 0.4492427408695221
loss_pred:0.01470899861305952, decouple_loss:0.0009928027866408229
/work/09012/haoli1/ls6/Pyt/lib/python3.9/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '
Iteration: 2, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448001891374588, gen p mean: -0.04847641661763191, mean p set: 0.4484822154045105
loss_pred:0.022779081016778946, decouple_loss:0.006525247357785702
The modified gen p mean: 0.44780221581459045, gen p mean: -0.052785079926252365, mean p set: 0.44828253984451294The modified gen p mean: 0.44787734746932983, gen p mean: -0.050656311213970184, mean p set: 0.4483576714992523
loss_pred:0.022815389558672905, decouple_loss:0.0066022807732224464
loss_pred:0.02230522409081459, decouple_loss:0.006471352186053991
Iteration: 3, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478529691696167, gen p mean: -0.0486006960272789, mean p set: 0.4483332633972168
loss_pred:0.016470741480588913, decouple_loss:0.005089092999696732
The modified gen p mean: 0.4484274089336395, gen p mean: -0.0517561100423336, mean p set: 0.4489077031612396The modified gen p mean: 0.4481147229671478, gen p mean: -0.050896450877189636, mean p set: 0.4485950171947479
loss_pred:0.016699720174074173, decouple_loss:0.004804052412509918
loss_pred:0.015909738838672638, decouple_loss:0.005086591001600027
Iteration: 4, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44771310687065125, gen p mean: -0.050470639020204544, mean p set: 0.44819343090057373
loss_pred:0.01621164008975029, decouple_loss:0.0031536498572677374
The modified gen p mean: 0.44806361198425293, gen p mean: -0.048773542046546936, mean p set: 0.44854387640953064The modified gen p mean: 0.447199285030365, gen p mean: -0.05092371255159378, mean p set: 0.4476796090602875
loss_pred:0.01637418009340763, decouple_loss:0.0031956383027136326
loss_pred:0.016275491565465927, decouple_loss:0.0031535890884697437
Iteration: 5, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44773542881011963, gen p mean: -0.05320274084806442, mean p set: 0.4482157230377197
The modified gen p mean: 0.4481903612613678, gen p mean: -0.05157659202814102, mean p set: 0.4486706554889679
loss_pred:0.015204746276140213, decouple_loss:0.002803477691486478
loss_pred:0.015078549273312092, decouple_loss:0.0027896021492779255
The modified gen p mean: 0.4474197030067444, gen p mean: -0.05045711249113083, mean p set: 0.4478999972343445
loss_pred:0.0157040823251009, decouple_loss:0.0030411246698349714
Iteration: 6, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44771623611450195, gen p mean: -0.05483069270849228, mean p set: 0.44819650053977966
loss_pred:0.015077998861670494, decouple_loss:0.003571947803720832
The modified gen p mean: 0.44806525111198425, gen p mean: -0.05451059341430664, mean p set: 0.44854554533958435The modified gen p mean: 0.44763636589050293, gen p mean: -0.05470248684287071, mean p set: 0.4481166899204254
loss_pred:0.016020845621824265, decouple_loss:0.003716751467436552
loss_pred:0.014821438118815422, decouple_loss:0.0033858155366033316
Iteration: 7, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44780269265174866, gen p mean: -0.060555730015039444, mean p set: 0.44828298687934875
loss_pred:0.015629583969712257, decouple_loss:0.0028662849217653275
The modified gen p mean: 0.44788506627082825, gen p mean: -0.06173856183886528, mean p set: 0.44836533069610596The modified gen p mean: 0.4478335976600647, gen p mean: -0.0576200932264328, mean p set: 0.4483139216899872
loss_pred:0.015141368843615055, decouple_loss:0.0028448610100895166
loss_pred:0.01548934169113636, decouple_loss:0.0030247573740780354
Iteration: 8, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44754910469055176, gen p mean: -0.06422176957130432, mean p set: 0.44802939891815186
loss_pred:0.015204591676592827, decouple_loss:0.0030973476823419333
The modified gen p mean: 0.448560506105423, gen p mean: -0.05985290929675102, mean p set: 0.44904080033302307The modified gen p mean: 0.4481160640716553, gen p mean: -0.06647102534770966, mean p set: 0.44859638810157776
loss_pred:0.015671279281377792, decouple_loss:0.003208013717085123
loss_pred:0.01452615950256586, decouple_loss:0.0031037558801472187
Iteration: 9, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44832858443260193, gen p mean: -0.049924585968256, mean p set: 0.4488089084625244
loss_pred:0.0151781365275383, decouple_loss:0.002773778513073921
The modified gen p mean: 0.44751855731010437, gen p mean: -0.053188689053058624, mean p set: 0.44799885153770447The modified gen p mean: 0.4477217197418213, gen p mean: -0.05490119755268097, mean p set: 0.448201984167099
loss_pred:0.014482093043625355, decouple_loss:0.0026964987628161907
loss_pred:0.01424023974686861, decouple_loss:0.0028657440561801195
Iteration: 10, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479815363883972, gen p mean: -0.044275540858507156, mean p set: 0.44846177101135254
loss_pred:0.015076295472681522, decouple_loss:0.0025908390525728464
The modified gen p mean: 0.4472784698009491, gen p mean: -0.04927350953221321, mean p set: 0.4477587640285492
The modified gen p mean: 0.44799745082855225, gen p mean: -0.05047793313860893, mean p set: 0.44847777485847473
loss_pred:0.015144125558435917, decouple_loss:0.0026786522939801216
loss_pred:0.014889872632920742, decouple_loss:0.002733520232141018
2023-05-02 02:47:31 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.045028019696474075, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.03987588733434677, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04005444049835205, mean p set: 0.4500633478164673
loss_pred:0.02010851725935936, decouple_loss:0.0026813028380274773
loss_pred:0.01896708831191063, decouple_loss:0.0024871528148651123
loss_pred:0.01899842359125614, decouple_loss:0.0025226555299013853
WV_0_PC_1_EH_0_PS_40, loss: 0.0194861963391304, avg_mse: 0.027860606089234352
current test mse: 0.027861
Iteration: 11, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447795033454895, gen p mean: -0.0449269562959671, mean p set: 0.4482753276824951
The modified gen p mean: 0.4479043781757355, gen p mean: -0.044235192239284515, mean p set: 0.44838467240333557
The modified gen p mean: 0.44762691855430603, gen p mean: -0.04760102927684784, mean p set: 0.44810721278190613
loss_pred:0.0149001469835639, decouple_loss:0.002530669793486595
loss_pred:0.015640970319509506, decouple_loss:0.002650829032063484
loss_pred:0.01497227419167757, decouple_loss:0.002392437541857362
Iteration: 12, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44878119230270386, gen p mean: -0.041648730635643005, mean p set: 0.44926151633262634
loss_pred:0.014318839646875858, decouple_loss:0.0024475466925650835
The modified gen p mean: 0.4475034475326538, gen p mean: -0.04337385296821594, mean p set: 0.4479837417602539The modified gen p mean: 0.44778382778167725, gen p mean: -0.03678320720791817, mean p set: 0.44826412200927734
loss_pred:0.014661590568721294, decouple_loss:0.002543081296607852
loss_pred:0.015078837051987648, decouple_loss:0.0025005571078509092
Iteration: 13, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44811341166496277, gen p mean: -0.03488950431346893, mean p set: 0.44859370589256287
loss_pred:0.014782237820327282, decouple_loss:0.002586488611996174
The modified gen p mean: 0.4486851990222931, gen p mean: -0.034344110637903214, mean p set: 0.4491655230522156
The modified gen p mean: 0.448133647441864, gen p mean: -0.038756925612688065, mean p set: 0.4486139416694641
loss_pred:0.014430132694542408, decouple_loss:0.002326683374121785
loss_pred:0.014764783903956413, decouple_loss:0.0023530435282737017
Iteration: 14, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480687975883484, gen p mean: -0.03996827080845833, mean p set: 0.4485490918159485
loss_pred:0.01536533422768116, decouple_loss:0.0020170286297798157
The modified gen p mean: 0.44841691851615906, gen p mean: -0.03533247485756874, mean p set: 0.44889721274375916The modified gen p mean: 0.44791802763938904, gen p mean: -0.036999113857746124, mean p set: 0.44839832186698914
loss_pred:0.0141633041203022, decouple_loss:0.0021255547180771828
loss_pred:0.014166227541863918, decouple_loss:0.0022019515745341778
Iteration: 15, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478616714477539, gen p mean: -0.04390748217701912, mean p set: 0.448341965675354
loss_pred:0.014689306728541851, decouple_loss:0.0019418253796175122
The modified gen p mean: 0.44790560007095337, gen p mean: -0.04088253527879715, mean p set: 0.44838589429855347The modified gen p mean: 0.44794991612434387, gen p mean: -0.0401073694229126, mean p set: 0.44843021035194397
loss_pred:0.014448664151132107, decouple_loss:0.0018753665499389172
loss_pred:0.014417496509850025, decouple_loss:0.0019436458824202418
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 16, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44741693139076233, gen p mean: -0.04668617248535156, mean p set: 0.44789719581604004
loss_pred:0.014227344654500484, decouple_loss:0.0019312880467623472
The modified gen p mean: 0.4475390315055847, gen p mean: -0.044331200420856476, mean p set: 0.4480193257331848The modified gen p mean: 0.44880369305610657, gen p mean: -0.043149542063474655, mean p set: 0.44928398728370667
loss_pred:0.014542615972459316, decouple_loss:0.002070001093670726
loss_pred:0.014668267220258713, decouple_loss:0.001984233036637306
Iteration: 17, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477713108062744, gen p mean: -0.049504395574331284, mean p set: 0.4482516348361969
loss_pred:0.01424126885831356, decouple_loss:0.00183382211253047
The modified gen p mean: 0.44822627305984497, gen p mean: -0.04659406468272209, mean p set: 0.4487065374851227The modified gen p mean: 0.4475157856941223, gen p mean: -0.047211822122335434, mean p set: 0.4479960799217224
loss_pred:0.014069938100874424, decouple_loss:0.0019317981787025928
loss_pred:0.01434693206101656, decouple_loss:0.002017619786784053
Iteration: 18, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483509063720703, gen p mean: -0.05115799978375435, mean p set: 0.4488312005996704
loss_pred:0.01352827437222004, decouple_loss:0.0018881539581343532
The modified gen p mean: 0.4482947587966919, gen p mean: -0.05274895578622818, mean p set: 0.448775053024292The modified gen p mean: 0.44799932837486267, gen p mean: -0.05396770313382149, mean p set: 0.44847962260246277
loss_pred:0.014716355130076408, decouple_loss:0.001788420369848609
loss_pred:0.014627179130911827, decouple_loss:0.001730648335069418
Iteration: 19, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44844841957092285, gen p mean: -0.0494869239628315, mean p set: 0.44892874360084534
loss_pred:0.01407764945179224, decouple_loss:0.0017553061479702592
The modified gen p mean: 0.44749873876571655, gen p mean: -0.05014834180474281, mean p set: 0.44797900319099426The modified gen p mean: 0.44795525074005127, gen p mean: -0.051365405321121216, mean p set: 0.44843557476997375
loss_pred:0.014094616286456585, decouple_loss:0.0017222098540514708
loss_pred:0.014046522788703442, decouple_loss:0.001708802068606019
Iteration: 20, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44744616746902466, gen p mean: -0.04807429015636444, mean p set: 0.44792643189430237
loss_pred:0.014108906500041485, decouple_loss:0.001736651174724102
The modified gen p mean: 0.44811728596687317, gen p mean: -0.048128705471754074, mean p set: 0.44859760999679565
The modified gen p mean: 0.4491630792617798, gen p mean: -0.04774567112326622, mean p set: 0.4496433436870575
loss_pred:0.014682893641293049, decouple_loss:0.0018319166265428066
loss_pred:0.013944119215011597, decouple_loss:0.0016731580253690481
2023-05-02 02:49:26 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.05021379142999649, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04497513547539711, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.04517228901386261, mean p set: 0.4500633478164673
loss_pred:0.019194727763533592, decouple_loss:0.0018292373279109597
loss_pred:0.01814800128340721, decouple_loss:0.0017372115980833769
loss_pred:0.018150782212615013, decouple_loss:0.001819952274672687
WV_0_PC_1_EH_0_PS_40, loss: 0.018587609753012657, avg_mse: 0.026816612109541893
current test mse: 0.026817
At step 20, Best test: 0.026817
save model to /work/09012/haoli1/ls6/ERA5_PredRNN/checkpoints/WV_0_PC_1_EH_0_PS_40/model_test_schedule_sampling_DynaMean.ckpt
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012008_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012008_3_24hr.npz
NaN value num: 0
Iteration: 21, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44609305262565613, gen p mean: -0.048286303877830505, mean p set: 0.4465733468532562
loss_pred:0.016437994316220284, decouple_loss:0.0016895161243155599
The modified gen p mean: 0.44563257694244385, gen p mean: -0.045750267803668976, mean p set: 0.44611287117004395The modified gen p mean: 0.44762691855430603, gen p mean: -0.0500778965651989, mean p set: 0.44810721278190613
loss_pred:0.0165629293769598, decouple_loss:0.001717221923172474
loss_pred:0.01587888039648533, decouple_loss:0.001872504479251802
Iteration: 22, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44600096344947815, gen p mean: -0.04677080363035202, mean p set: 0.44648122787475586
loss_pred:0.015758492052555084, decouple_loss:0.0015871722716838121
The modified gen p mean: 0.448067307472229, gen p mean: -0.04330368712544441, mean p set: 0.4485476016998291The modified gen p mean: 0.44573476910591125, gen p mean: -0.04629576951265335, mean p set: 0.44621503353118896
loss_pred:0.015896879136562347, decouple_loss:0.0016130851581692696
loss_pred:0.015092692337930202, decouple_loss:0.0016825988423079252
Iteration: 23, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44588515162467957, gen p mean: -0.04394388198852539, mean p set: 0.44636544585227966
loss_pred:0.015469610691070557, decouple_loss:0.0015378841198980808
The modified gen p mean: 0.44793447852134705, gen p mean: -0.049748148769140244, mean p set: 0.44841480255126953The modified gen p mean: 0.4474918842315674, gen p mean: -0.04166518524289131, mean p set: 0.4479721784591675
loss_pred:0.015096046030521393, decouple_loss:0.0015726309502497315
loss_pred:0.015521076507866383, decouple_loss:0.0015788355376571417
Iteration: 24, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44680672883987427, gen p mean: -0.04868756979703903, mean p set: 0.44728702306747437
loss_pred:0.016028698533773422, decouple_loss:0.0016048940597102046
The modified gen p mean: 0.4468127191066742, gen p mean: -0.04407162591814995, mean p set: 0.4472929835319519The modified gen p mean: 0.4461541473865509, gen p mean: -0.04367095232009888, mean p set: 0.4466344118118286
loss_pred:0.015178381465375423, decouple_loss:0.0014630339574068785
loss_pred:0.015886405482888222, decouple_loss:0.0016577983042225242
Iteration: 25, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44643568992614746, gen p mean: -0.04259399697184563, mean p set: 0.44691601395606995
loss_pred:0.016313347965478897, decouple_loss:0.0015705028781667352
The modified gen p mean: 0.44811761379241943, gen p mean: -0.041027750819921494, mean p set: 0.44859790802001953The modified gen p mean: 0.44722557067871094, gen p mean: -0.04596244916319847, mean p set: 0.44770586490631104
loss_pred:0.015225370414555073, decouple_loss:0.0015165049117058516
loss_pred:0.01563441753387451, decouple_loss:0.0016010524705052376
Iteration: 26, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4455968141555786, gen p mean: -0.04320197179913521, mean p set: 0.4460771083831787
loss_pred:0.015589922666549683, decouple_loss:0.0014146887697279453
The modified gen p mean: 0.44649001955986023, gen p mean: -0.03985362499952316, mean p set: 0.4469703137874603The modified gen p mean: 0.4463377296924591, gen p mean: -0.04836566373705864, mean p set: 0.4468180239200592
loss_pred:0.015608984977006912, decouple_loss:0.001456273952499032
loss_pred:0.01629391685128212, decouple_loss:0.0014540530974045396
Iteration: 27, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44694775342941284, gen p mean: -0.04230101779103279, mean p set: 0.4474280774593353
loss_pred:0.015770066529512405, decouple_loss:0.0013565467670559883
The modified gen p mean: 0.4459913969039917, gen p mean: -0.04629729688167572, mean p set: 0.4464716613292694The modified gen p mean: 0.4463740587234497, gen p mean: -0.045621540397405624, mean p set: 0.4468543529510498
loss_pred:0.015397287905216217, decouple_loss:0.001336655463092029
loss_pred:0.016003455966711044, decouple_loss:0.0012662780936807394
Iteration: 28, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468720555305481, gen p mean: -0.04755200073122978, mean p set: 0.4473523199558258
loss_pred:0.015429031103849411, decouple_loss:0.0014140469720587134
The modified gen p mean: 0.4458196759223938, gen p mean: -0.040637604892253876, mean p set: 0.4462999701499939The modified gen p mean: 0.44701701402664185, gen p mean: -0.04668983817100525, mean p set: 0.44749733805656433
loss_pred:0.01602235995233059, decouple_loss:0.0013761043082922697
loss_pred:0.015834705904126167, decouple_loss:0.0014639011351391673
Iteration: 29, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.445686012506485, gen p mean: -0.0458567850291729, mean p set: 0.4461663067340851
loss_pred:0.015764791518449783, decouple_loss:0.0012488274369388819
The modified gen p mean: 0.44586387276649475, gen p mean: -0.04556811600923538, mean p set: 0.44634416699409485The modified gen p mean: 0.44659650325775146, gen p mean: -0.04959993064403534, mean p set: 0.44707679748535156
loss_pred:0.01582157239317894, decouple_loss:0.001298639108426869
loss_pred:0.015937021002173424, decouple_loss:0.0013500223867595196
Iteration: 30, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44685351848602295, gen p mean: -0.0498589426279068, mean p set: 0.44733378291130066
loss_pred:0.016022250056266785, decouple_loss:0.0013451692648231983
The modified gen p mean: 0.446650892496109, gen p mean: -0.05028185248374939, mean p set: 0.4471311867237091The modified gen p mean: 0.4469850957393646, gen p mean: -0.054437994956970215, mean p set: 0.4474653899669647
loss_pred:0.015147244557738304, decouple_loss:0.001273901667445898
loss_pred:0.015868226066231728, decouple_loss:0.0012252787128090858
2023-05-02 02:52:02 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.057730261236429214, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.05317272990942001, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.0531807504594326, mean p set: 0.4500633478164673
loss_pred:0.018612170591950417, decouple_loss:0.0013434537686407566
loss_pred:0.017574425786733627, decouple_loss:0.0013954731402918696
loss_pred:0.017608072608709335, decouple_loss:0.0013685651356354356
WV_0_PC_1_EH_0_PS_40, loss: 0.018000014126300812, avg_mse: 0.025841940194368362
current test mse: 0.025842
At step 30, Best test: 0.025842
save model to /work/09012/haoli1/ls6/ERA5_PredRNN/checkpoints/WV_0_PC_1_EH_0_PS_40/model_test_schedule_sampling_DynaMean.ckpt
Iteration: 31, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467600882053375, gen p mean: -0.0528341680765152, mean p set: 0.4472403824329376
loss_pred:0.01570679247379303, decouple_loss:0.0012188411783427
The modified gen p mean: 0.4465961754322052, gen p mean: -0.05249251052737236, mean p set: 0.4470764696598053
The modified gen p mean: 0.44582054018974304, gen p mean: -0.05528513342142105, mean p set: 0.44630083441734314
loss_pred:0.01574365608394146, decouple_loss:0.0012832735665142536
loss_pred:0.01563936471939087, decouple_loss:0.0012754646595567465
Iteration: 32, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4462442994117737, gen p mean: -0.05874721705913544, mean p set: 0.4467245936393738
loss_pred:0.015324242413043976, decouple_loss:0.0011524894507601857
The modified gen p mean: 0.4463348984718323, gen p mean: -0.05578022822737694, mean p set: 0.4468151926994324The modified gen p mean: 0.4461958110332489, gen p mean: -0.06021116301417351, mean p set: 0.4466760754585266
loss_pred:0.015586783178150654, decouple_loss:0.0011549490736797452
loss_pred:0.015527667477726936, decouple_loss:0.0011342628858983517
Iteration: 33, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446292519569397, gen p mean: -0.061066944152116776, mean p set: 0.44677287340164185
loss_pred:0.01582776941359043, decouple_loss:0.0011645705671980977
The modified gen p mean: 0.4474466145038605, gen p mean: -0.062028586864471436, mean p set: 0.44792690873146057The modified gen p mean: 0.4469824731349945, gen p mean: -0.05677054077386856, mean p set: 0.4474627375602722
loss_pred:0.015568813309073448, decouple_loss:0.0012873320374637842
loss_pred:0.015991700813174248, decouple_loss:0.0011546433670446277
Iteration: 34, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475557506084442, gen p mean: -0.05828479677438736, mean p set: 0.4480360448360443
loss_pred:0.015401346608996391, decouple_loss:0.001233525457791984
The modified gen p mean: 0.4454820156097412, gen p mean: -0.059043653309345245, mean p set: 0.4459622800350189The modified gen p mean: 0.4488474428653717, gen p mean: -0.0558224618434906, mean p set: 0.4493277370929718
loss_pred:0.015254243277013302, decouple_loss:0.0011956797679886222
loss_pred:0.0149296959862113, decouple_loss:0.001211903290823102
Iteration: 35, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4456685185432434, gen p mean: -0.05710649490356445, mean p set: 0.4461488425731659
loss_pred:0.01567433960735798, decouple_loss:0.001159754814580083
The modified gen p mean: 0.4462193548679352, gen p mean: -0.05879393219947815, mean p set: 0.4466996490955353The modified gen p mean: 0.44751420617103577, gen p mean: -0.05695552006363869, mean p set: 0.4479944705963135
loss_pred:0.01588321477174759, decouple_loss:0.001091489102691412
loss_pred:0.015725819393992424, decouple_loss:0.0012215597089380026
Iteration: 36, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469037353992462, gen p mean: -0.060838520526885986, mean p set: 0.4473839998245239
loss_pred:0.014816791750490665, decouple_loss:0.0010965062538161874
The modified gen p mean: 0.4486481845378876, gen p mean: -0.05605873465538025, mean p set: 0.44912847876548767The modified gen p mean: 0.44628211855888367, gen p mean: -0.057237252593040466, mean p set: 0.4467623829841614
loss_pred:0.016123663634061813, decouple_loss:0.0010902639478445053
loss_pred:0.014856258407235146, decouple_loss:0.0011466372525319457
Iteration: 37, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4456902742385864, gen p mean: -0.05577598512172699, mean p set: 0.4461705982685089
loss_pred:0.015701889991760254, decouple_loss:0.001051482860930264
The modified gen p mean: 0.44619178771972656, gen p mean: -0.053618378937244415, mean p set: 0.44667208194732666The modified gen p mean: 0.44696301221847534, gen p mean: -0.05894199013710022, mean p set: 0.44744330644607544
loss_pred:0.014929796569049358, decouple_loss:0.0011231476673856378
loss_pred:0.015657253563404083, decouple_loss:0.0010781032033264637
Iteration: 38, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4463704824447632, gen p mean: -0.05309932678937912, mean p set: 0.4468507766723633
loss_pred:0.015001436695456505, decouple_loss:0.0010794592089951038
The modified gen p mean: 0.44578951597213745, gen p mean: -0.049618981778621674, mean p set: 0.44626984000205994
The modified gen p mean: 0.44824230670928955, gen p mean: -0.056910522282123566, mean p set: 0.44872260093688965
loss_pred:0.0158309917896986, decouple_loss:0.001131067518144846
loss_pred:0.01493212953209877, decouple_loss:0.0011755127925425768
Iteration: 39, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471279978752136, gen p mean: -0.05906182527542114, mean p set: 0.44760826230049133
loss_pred:0.015325167216360569, decouple_loss:0.0011406397679820657
The modified gen p mean: 0.4459577202796936, gen p mean: -0.051681552082300186, mean p set: 0.4464380145072937The modified gen p mean: 0.44668063521385193, gen p mean: -0.04798015579581261, mean p set: 0.44716089963912964
loss_pred:0.014828030951321125, decouple_loss:0.0010394747368991375
loss_pred:0.015228701755404472, decouple_loss:0.001061721588484943
Iteration: 40, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44646117091178894, gen p mean: -0.04542066901922226, mean p set: 0.44694146513938904
loss_pred:0.015631770715117455, decouple_loss:0.0011196155101060867
The modified gen p mean: 0.446490615606308, gen p mean: -0.04714754968881607, mean p set: 0.4469709098339081The modified gen p mean: 0.4464409351348877, gen p mean: -0.05179108679294586, mean p set: 0.4469212293624878
loss_pred:0.015284779481589794, decouple_loss:0.0010076052276417613
loss_pred:0.015064259991049767, decouple_loss:0.0010970329167321324
2023-05-02 02:54:01 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.0506461001932621, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.046538256108760834, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.046208400279283524, mean p set: 0.4500633478164673
loss_pred:0.018532617017626762, decouple_loss:0.0011151075595989823
loss_pred:0.01746555045247078, decouple_loss:0.0010968808783218265
loss_pred:0.01752009242773056, decouple_loss:0.0010947718983516097
WV_0_PC_1_EH_0_PS_40, loss: 0.017894532531499863, avg_mse: 0.025762859731912613
current test mse: 0.025763
At step 40, Best test: 0.025763
save model to /work/09012/haoli1/ls6/ERA5_PredRNN/checkpoints/WV_0_PC_1_EH_0_PS_40/model_test_schedule_sampling_DynaMean.ckpt
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012009_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012009_3_24hr.npz
NaN value num: 0
Iteration: 41, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44959643483161926, gen p mean: -0.041804470121860504, mean p set: 0.45007672905921936
loss_pred:0.01674223318696022, decouple_loss:0.0010063101071864367
The modified gen p mean: 0.4508477449417114, gen p mean: -0.044264934957027435, mean p set: 0.4513280689716339The modified gen p mean: 0.4525103271007538, gen p mean: -0.040873367339372635, mean p set: 0.4529906213283539
loss_pred:0.016312481835484505, decouple_loss:0.0010818549199029803
loss_pred:0.01619391143321991, decouple_loss:0.00110193423461169
Iteration: 42, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493584632873535, gen p mean: -0.04685255140066147, mean p set: 0.4498387575149536
loss_pred:0.017026185989379883, decouple_loss:0.001105843810364604
The modified gen p mean: 0.45151445269584656, gen p mean: -0.04641350731253624, mean p set: 0.45199474692344666The modified gen p mean: 0.44981101155281067, gen p mean: -0.04419576749205589, mean p set: 0.45029133558273315
loss_pred:0.01720419153571129, decouple_loss:0.0010348709765821695
loss_pred:0.016127394512295723, decouple_loss:0.001033333013765514
Iteration: 43, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45031842589378357, gen p mean: -0.04613973945379257, mean p set: 0.45079872012138367
loss_pred:0.01745307818055153, decouple_loss:0.0010163165861740708
The modified gen p mean: 0.4527937173843384, gen p mean: -0.04402774199843407, mean p set: 0.4532740116119385The modified gen p mean: 0.4508407711982727, gen p mean: -0.03889886289834976, mean p set: 0.4513210654258728
loss_pred:0.01733013056218624, decouple_loss:0.001046141260303557
loss_pred:0.016302326694130898, decouple_loss:0.0009442071313969791
Iteration: 44, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505032002925873, gen p mean: -0.041926249861717224, mean p set: 0.4509834945201874
loss_pred:0.016590215265750885, decouple_loss:0.0010358321014791727
The modified gen p mean: 0.4516625702381134, gen p mean: -0.04371369630098343, mean p set: 0.4521428644657135The modified gen p mean: 0.45203572511672974, gen p mean: -0.04121297970414162, mean p set: 0.45251601934432983
loss_pred:0.016040079295635223, decouple_loss:0.0009864810854196548
loss_pred:0.01647828333079815, decouple_loss:0.0010751807130873203
Iteration: 45, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4510924220085144, gen p mean: -0.04341854900121689, mean p set: 0.4515727162361145
loss_pred:0.016327325254678726, decouple_loss:0.0010777118150144815
The modified gen p mean: 0.4508695900440216, gen p mean: -0.03903840854763985, mean p set: 0.4513498842716217The modified gen p mean: 0.45180270075798035, gen p mean: -0.04099169746041298, mean p set: 0.45228299498558044
loss_pred:0.016292665153741837, decouple_loss:0.0010788370855152607
loss_pred:0.016543347388505936, decouple_loss:0.0010778851574286819
Iteration: 46, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45118770003318787, gen p mean: -0.041622094810009, mean p set: 0.45166799426078796
loss_pred:0.016744175925850868, decouple_loss:0.0011487017618492246
The modified gen p mean: 0.4504394233226776, gen p mean: -0.04602145403623581, mean p set: 0.4509196877479553The modified gen p mean: 0.45099058747291565, gen p mean: -0.04271699860692024, mean p set: 0.45147088170051575
loss_pred:0.016971800476312637, decouple_loss:0.0012490504886955023
loss_pred:0.01616887003183365, decouple_loss:0.0012067480711266398
Iteration: 47, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4520491063594818, gen p mean: -0.0406084842979908, mean p set: 0.4525294005870819
loss_pred:0.016460414975881577, decouple_loss:0.001019480056129396
The modified gen p mean: 0.4502943754196167, gen p mean: -0.04259101673960686, mean p set: 0.4507746696472168
The modified gen p mean: 0.45124033093452454, gen p mean: -0.05132890120148659, mean p set: 0.45172062516212463
loss_pred:0.01731753535568714, decouple_loss:0.001081732683815062
loss_pred:0.017139680683612823, decouple_loss:0.001098048989661038
Iteration: 48, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497741162776947, gen p mean: -0.04896450415253639, mean p set: 0.4502543807029724
loss_pred:0.01699450984597206, decouple_loss:0.0010734491515904665
The modified gen p mean: 0.4500633478164673, gen p mean: -0.043472662568092346, mean p set: 0.45054367184638977The modified gen p mean: 0.44945886731147766, gen p mean: -0.04156138375401497, mean p set: 0.44993916153907776
loss_pred:0.01602754555642605, decouple_loss:0.0010474005248397589
loss_pred:0.016345927491784096, decouple_loss:0.001083948533050716
Iteration: 49, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44928792119026184, gen p mean: -0.04334810748696327, mean p set: 0.4497682452201843
loss_pred:0.016701966524124146, decouple_loss:0.0010610980680212379
The modified gen p mean: 0.44968274235725403, gen p mean: -0.04030619561672211, mean p set: 0.4501630365848541The modified gen p mean: 0.45142194628715515, gen p mean: -0.050351228564977646, mean p set: 0.45190224051475525
loss_pred:0.015967195853590965, decouple_loss:0.0011153594823554158
loss_pred:0.01707913540303707, decouple_loss:0.001113966922275722
Iteration: 50, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.451815128326416, gen p mean: -0.04451699182391167, mean p set: 0.4522954225540161
loss_pred:0.01636812463402748, decouple_loss:0.0010353352408856153
The modified gen p mean: 0.4494033455848694, gen p mean: -0.04674557223916054, mean p set: 0.4498836398124695The modified gen p mean: 0.45034050941467285, gen p mean: -0.044300153851509094, mean p set: 0.45082080364227295
loss_pred:0.01633303612470627, decouple_loss:0.0010069496929645538
loss_pred:0.01611211895942688, decouple_loss:0.0009899444412440062
2023-05-02 02:56:37 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.05213424190878868, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.047664955258369446, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04744991660118103, mean p set: 0.4500633478164673
loss_pred:0.01837090589106083, decouple_loss:0.0010517120826989412
loss_pred:0.017299458384513855, decouple_loss:0.001075712381862104
loss_pred:0.017359061166644096, decouple_loss:0.0010421137558296323
WV_0_PC_1_EH_0_PS_40, loss: 0.017729301005601883, avg_mse: 0.02543560042977333
current test mse: 0.025436
At step 50, Best test: 0.025436
save model to /work/09012/haoli1/ls6/ERA5_PredRNN/checkpoints/WV_0_PC_1_EH_0_PS_40/model_test_schedule_sampling_DynaMean.ckpt
Iteration: 51, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4510827362537384, gen p mean: -0.04269793629646301, mean p set: 0.4515630006790161
loss_pred:0.01623196341097355, decouple_loss:0.0009703923715278506
The modified gen p mean: 0.453704297542572, gen p mean: -0.041403379291296005, mean p set: 0.45418456196784973The modified gen p mean: 0.4502983093261719, gen p mean: -0.04252474382519722, mean p set: 0.450778603553772
loss_pred:0.016503576189279556, decouple_loss:0.000979230972006917loss_pred:0.016945362091064453, decouple_loss:0.0009752525947988033
Iteration: 52, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.452109694480896, gen p mean: -0.0471779927611351, mean p set: 0.4525899887084961
loss_pred:0.016359444707632065, decouple_loss:0.0011683560442179441
The modified gen p mean: 0.45179039239883423, gen p mean: -0.04519818723201752, mean p set: 0.4522706866264343The modified gen p mean: 0.4513101875782013, gen p mean: -0.04312615096569061, mean p set: 0.4517904818058014
loss_pred:0.01736309938132763, decouple_loss:0.0010684741428121924
loss_pred:0.016902249306440353, decouple_loss:0.0011313105933368206
Iteration: 53, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4516680836677551, gen p mean: -0.058012574911117554, mean p set: 0.4521483778953552
The modified gen p mean: 0.4511794149875641, gen p mean: -0.051090724766254425, mean p set: 0.4516597390174866
loss_pred:0.017015090212225914, decouple_loss:0.0012081427266821265
loss_pred:0.015893762931227684, decouple_loss:0.0010982041712850332
The modified gen p mean: 0.44962504506111145, gen p mean: -0.047697145491838455, mean p set: 0.45010536909103394
loss_pred:0.016273463144898415, decouple_loss:0.0011169675271958113
Iteration: 54, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4515419900417328, gen p mean: -0.047142088413238525, mean p set: 0.4520223140716553
loss_pred:0.0168765839189291, decouple_loss:0.0009219211642630398
The modified gen p mean: 0.45172128081321716, gen p mean: -0.047464657574892044, mean p set: 0.45220157504081726The modified gen p mean: 0.4517233073711395, gen p mean: -0.044954847544431686, mean p set: 0.452203631401062
loss_pred:0.01680288091301918, decouple_loss:0.0009081331663765013
loss_pred:0.01602989062666893, decouple_loss:0.0008957174140959978
Iteration: 55, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494931697845459, gen p mean: -0.04878104478120804, mean p set: 0.449973464012146
loss_pred:0.016725050285458565, decouple_loss:0.0009822141146287322
The modified gen p mean: 0.4498800039291382, gen p mean: -0.04928160458803177, mean p set: 0.4503602981567383The modified gen p mean: 0.4498148262500763, gen p mean: -0.045301564037799835, mean p set: 0.4502951502799988
loss_pred:0.01642783172428608, decouple_loss:0.0009855868993327022
loss_pred:0.016209039837121964, decouple_loss:0.0010437935125082731
Iteration: 56, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499562978744507, gen p mean: -0.046235114336013794, mean p set: 0.4504365921020508
loss_pred:0.015937654301524162, decouple_loss:0.0009048206848092377
The modified gen p mean: 0.4493976831436157, gen p mean: -0.0489262193441391, mean p set: 0.44987794756889343The modified gen p mean: 0.4533882737159729, gen p mean: -0.04399817809462547, mean p set: 0.453868567943573
loss_pred:0.016821185126900673, decouple_loss:0.0010192588670179248
loss_pred:0.016305427998304367, decouple_loss:0.0010450533591210842
Iteration: 57, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45193731784820557, gen p mean: -0.04420032724738121, mean p set: 0.45241761207580566
loss_pred:0.016504425555467606, decouple_loss:0.0009731939062476158
The modified gen p mean: 0.45313552021980286, gen p mean: -0.046217337250709534, mean p set: 0.45361581444740295The modified gen p mean: 0.45246824622154236, gen p mean: -0.045177675783634186, mean p set: 0.45294854044914246
loss_pred:0.016298064962029457, decouple_loss:0.0010386448120698333
loss_pred:0.01593106985092163, decouple_loss:0.0010033699218183756
Iteration: 58, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4510711133480072, gen p mean: -0.04645899683237076, mean p set: 0.4515514075756073
loss_pred:0.016942977905273438, decouple_loss:0.0012593513820320368
The modified gen p mean: 0.4517834484577179, gen p mean: -0.04667005315423012, mean p set: 0.452263742685318The modified gen p mean: 0.4511820375919342, gen p mean: -0.04478622227907181, mean p set: 0.4516623318195343
loss_pred:0.016149865463376045, decouple_loss:0.0011177798733115196
loss_pred:0.01619371958076954, decouple_loss:0.001164170098491013
Iteration: 59, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45053043961524963, gen p mean: -0.045398179441690445, mean p set: 0.45101073384284973
loss_pred:0.016919085755944252, decouple_loss:0.001027004444040358
The modified gen p mean: 0.4499293267726898, gen p mean: -0.04865789785981178, mean p set: 0.4504096210002899The modified gen p mean: 0.45086970925331116, gen p mean: -0.04424385353922844, mean p set: 0.45135000348091125
loss_pred:0.016833031550049782, decouple_loss:0.001048388658091426
loss_pred:0.016403397545218468, decouple_loss:0.0010737167904153466
Iteration: 60, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450502872467041, gen p mean: -0.0483764223754406, mean p set: 0.4509831368923187
loss_pred:0.016841597855091095, decouple_loss:0.0010278703412041068
The modified gen p mean: 0.4514254629611969, gen p mean: -0.04167454317212105, mean p set: 0.451905757188797The modified gen p mean: 0.4517621099948883, gen p mean: -0.042621809989213943, mean p set: 0.4522424042224884
loss_pred:0.016749868169426918, decouple_loss:0.0010943153174594045
loss_pred:0.01618693396449089, decouple_loss:0.0011075990041717887
2023-05-02 02:58:37 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.05288982391357422, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04822330176830292, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.04813563451170921, mean p set: 0.4500633478164673
loss_pred:0.018343862146139145, decouple_loss:0.001218703924678266
loss_pred:0.01729843020439148, decouple_loss:0.001168056740425527
loss_pred:0.01733618788421154, decouple_loss:0.0012173670111224055
WV_0_PC_1_EH_0_PS_40, loss: 0.017719563096761703, avg_mse: 0.02537808194756508
current test mse: 0.025378
At step 60, Best test: 0.025378
save model to /work/09012/haoli1/ls6/ERA5_PredRNN/checkpoints/WV_0_PC_1_EH_0_PS_40/model_test_schedule_sampling_DynaMean.ckpt
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012003_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012003_3_24hr.npz
NaN value num: 0
Iteration: 61, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45105841755867004, gen p mean: -0.03956014662981033, mean p set: 0.45153874158859253
loss_pred:0.016469327732920647, decouple_loss:0.0011697827139869332
The modified gen p mean: 0.4495593011379242, gen p mean: -0.038889080286026, mean p set: 0.4500395953655243The modified gen p mean: 0.4523261487483978, gen p mean: -0.04436419904232025, mean p set: 0.4528064429759979
loss_pred:0.01641138456761837, decouple_loss:0.0011332129361107945
loss_pred:0.016583578661084175, decouple_loss:0.00116242584772408
Iteration: 62, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4524238407611847, gen p mean: -0.03913459554314613, mean p set: 0.4529041349887848
The modified gen p mean: 0.451555460691452, gen p mean: -0.03951140493154526, mean p set: 0.4520357549190521
loss_pred:0.0165801290422678, decouple_loss:0.0009811228374019265
The modified gen p mean: 0.45141056180000305, gen p mean: -0.03888038918375969, mean p set: 0.45189085602760315
loss_pred:0.01687570847570896, decouple_loss:0.0010190641041845083
loss_pred:0.017100082710385323, decouple_loss:0.0010236118687316775
Iteration: 63, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45280566811561584, gen p mean: -0.04036376252770424, mean p set: 0.45328596234321594
The modified gen p mean: 0.450979620218277, gen p mean: -0.04412531852722168, mean p set: 0.4514599144458771
loss_pred:0.017865687608718872, decouple_loss:0.0012318389490246773
loss_pred:0.017532074823975563, decouple_loss:0.001217982149682939
The modified gen p mean: 0.4524010121822357, gen p mean: -0.03779216110706329, mean p set: 0.4528812766075134
loss_pred:0.017552748322486877, decouple_loss:0.0012063869507983327
Iteration: 64, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45089420676231384, gen p mean: -0.045786499977111816, mean p set: 0.45137453079223633
loss_pred:0.01742691919207573, decouple_loss:0.0011147536570206285
The modified gen p mean: 0.4516414701938629, gen p mean: -0.043732449412345886, mean p set: 0.4521217942237854The modified gen p mean: 0.4513852894306183, gen p mean: -0.042313359677791595, mean p set: 0.451865553855896
loss_pred:0.01712341420352459, decouple_loss:0.0010411359835416079
loss_pred:0.01792113482952118, decouple_loss:0.0011200206354260445
Iteration: 65, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4519972503185272, gen p mean: -0.05048522353172302, mean p set: 0.45247751474380493
loss_pred:0.017457937821745872, decouple_loss:0.0012129639508202672
The modified gen p mean: 0.4518498182296753, gen p mean: -0.046939898282289505, mean p set: 0.4523301124572754The modified gen p mean: 0.45245373249053955, gen p mean: -0.04961495101451874, mean p set: 0.45293402671813965
loss_pred:0.017427874729037285, decouple_loss:0.0012203408405184746
loss_pred:0.017624923959374428, decouple_loss:0.0011679304298013449
Iteration: 66, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4518781304359436, gen p mean: -0.0530497208237648, mean p set: 0.4523584544658661
loss_pred:0.01743442751467228, decouple_loss:0.0013799765147268772
The modified gen p mean: 0.45218440890312195, gen p mean: -0.046448320150375366, mean p set: 0.45266470313072205The modified gen p mean: 0.45007583498954773, gen p mean: -0.046519685536623, mean p set: 0.45055609941482544
loss_pred:0.01680535450577736, decouple_loss:0.001319465576671064
loss_pred:0.017720108851790428, decouple_loss:0.0012775370851159096
Iteration: 67, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4509037435054779, gen p mean: -0.04744488000869751, mean p set: 0.451384037733078
The modified gen p mean: 0.45027273893356323, gen p mean: -0.04541846364736557, mean p set: 0.45075303316116333
loss_pred:0.01575871929526329, decouple_loss:0.0010742282029241323
loss_pred:0.01627863384783268, decouple_loss:0.0009690473671071231The modified gen p mean: 0.4516950845718384, gen p mean: -0.051760297268629074, mean p set: 0.4521753489971161
loss_pred:0.017272507771849632, decouple_loss:0.0011048963060602546
Iteration: 68, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45001766085624695, gen p mean: -0.0487104207277298, mean p set: 0.45049792528152466
The modified gen p mean: 0.45311492681503296, gen p mean: -0.046339474618434906, mean p set: 0.45359519124031067
loss_pred:0.016491297632455826, decouple_loss:0.0012588450917974114
loss_pred:0.01681126467883587, decouple_loss:0.001183840911835432
The modified gen p mean: 0.4513300359249115, gen p mean: -0.04504285380244255, mean p set: 0.4518103301525116
loss_pred:0.016252655535936356, decouple_loss:0.0011087754974141717
Iteration: 69, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4518425166606903, gen p mean: -0.05017209053039551, mean p set: 0.452322781085968
loss_pred:0.017832061275839806, decouple_loss:0.0012804042780771852
The modified gen p mean: 0.4516810476779938, gen p mean: -0.04530256614089012, mean p set: 0.45216134190559387The modified gen p mean: 0.45218974351882935, gen p mean: -0.0494854599237442, mean p set: 0.45267003774642944
loss_pred:0.01733148843050003, decouple_loss:0.0012476779520511627
loss_pred:0.017336297780275345, decouple_loss:0.0011195831466466188
Iteration: 70, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4509216845035553, gen p mean: -0.04970260336995125, mean p set: 0.4514019787311554
The modified gen p mean: 0.45250239968299866, gen p mean: -0.04533849284052849, mean p set: 0.45298269391059875
loss_pred:0.016091490164399147, decouple_loss:0.0011140918359160423
loss_pred:0.017165979370474815, decouple_loss:0.0010569135192781687
The modified gen p mean: 0.4525472819805145, gen p mean: -0.04410954937338829, mean p set: 0.453027606010437
loss_pred:0.016335902735590935, decouple_loss:0.00107053283136338
2023-05-02 03:01:08 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.05990033596754074, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.05535241216421127, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.05530194193124771, mean p set: 0.4500633478164673
loss_pred:0.018347982317209244, decouple_loss:0.0012822957942262292
loss_pred:0.017242437228560448, decouple_loss:0.0012092811521142721
loss_pred:0.017339732497930527, decouple_loss:0.001283245044760406
WV_0_PC_1_EH_0_PS_40, loss: 0.01770629733800888, avg_mse: 0.025352906435728073
current test mse: 0.025353
At step 70, Best test: 0.025353
save model to /work/09012/haoli1/ls6/ERA5_PredRNN/checkpoints/WV_0_PC_1_EH_0_PS_40/model_test_schedule_sampling_DynaMean.ckpt
Iteration: 71, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45289239287376404, gen p mean: -0.04615078493952751, mean p set: 0.45337265729904175
loss_pred:0.016624506562948227, decouple_loss:0.00103591731749475
The modified gen p mean: 0.45319274067878723, gen p mean: -0.04973358288407326, mean p set: 0.45367300510406494The modified gen p mean: 0.45133569836616516, gen p mean: -0.0507102869451046, mean p set: 0.45181599259376526
loss_pred:0.01786625012755394, decouple_loss:0.0012325638672336936loss_pred:0.016586482524871826, decouple_loss:0.001070374040864408
Iteration: 72, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4512156546115875, gen p mean: -0.04808976128697395, mean p set: 0.4516959488391876
loss_pred:0.015810610726475716, decouple_loss:0.0011055077193304896
The modified gen p mean: 0.45151811838150024, gen p mean: -0.04662841185927391, mean p set: 0.45199838280677795The modified gen p mean: 0.45103371143341064, gen p mean: -0.05180973932147026, mean p set: 0.45151403546333313
loss_pred:0.01711174286901951, decouple_loss:0.0011018807999789715
loss_pred:0.016661884263157845, decouple_loss:0.0011466173455119133
Iteration: 73, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4510553181171417, gen p mean: -0.0521683469414711, mean p set: 0.4515356123447418
loss_pred:0.017102790996432304, decouple_loss:0.001070275204256177
The modified gen p mean: 0.45141056180000305, gen p mean: -0.054521869868040085, mean p set: 0.45189085602760315The modified gen p mean: 0.45145028829574585, gen p mean: -0.05210348591208458, mean p set: 0.45193058252334595
loss_pred:0.01636049710214138, decouple_loss:0.0010401097824797034
loss_pred:0.016275905072689056, decouple_loss:0.001065560500137508
Iteration: 74, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508257210254669, gen p mean: -0.05378260836005211, mean p set: 0.451306015253067
loss_pred:0.017590831965208054, decouple_loss:0.0013562990352511406
The modified gen p mean: 0.44988471269607544, gen p mean: -0.05490283668041229, mean p set: 0.45036500692367554The modified gen p mean: 0.45166030526161194, gen p mean: -0.051772892475128174, mean p set: 0.45214059948921204
loss_pred:0.0157292652875185, decouple_loss:0.0013062113430351019
loss_pred:0.017050789669156075, decouple_loss:0.0014043990522623062
Iteration: 75, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45357760787010193, gen p mean: -0.05315602943301201, mean p set: 0.45405787229537964
loss_pred:0.016923461109399796, decouple_loss:0.0011443766998127103
The modified gen p mean: 0.4512692093849182, gen p mean: -0.054059188812971115, mean p set: 0.4517495334148407The modified gen p mean: 0.45132654905319214, gen p mean: -0.05180024355649948, mean p set: 0.4518068730831146
loss_pred:0.01692984066903591, decouple_loss:0.0011720762122422457
loss_pred:0.01701190322637558, decouple_loss:0.0011583165032789111
Iteration: 76, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45105090737342834, gen p mean: -0.05493946745991707, mean p set: 0.45153123140335083
loss_pred:0.015967683866620064, decouple_loss:0.0013595526106655598
The modified gen p mean: 0.4519060552120209, gen p mean: -0.05601917579770088, mean p set: 0.4523863196372986The modified gen p mean: 0.4522726237773895, gen p mean: -0.057244040071964264, mean p set: 0.452752947807312
loss_pred:0.016112223267555237, decouple_loss:0.0012972719268873334
loss_pred:0.017505912110209465, decouple_loss:0.0012407256290316582
Iteration: 77, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4515415132045746, gen p mean: -0.05178793892264366, mean p set: 0.4520217776298523
loss_pred:0.016797693446278572, decouple_loss:0.0012286941055208445
The modified gen p mean: 0.4517439305782318, gen p mean: -0.060502029955387115, mean p set: 0.4522242546081543The modified gen p mean: 0.4534507393836975, gen p mean: -0.04867025837302208, mean p set: 0.4539310038089752
loss_pred:0.016053887084126472, decouple_loss:0.001199990976601839
loss_pred:0.016797760501503944, decouple_loss:0.0011352812871336937
Iteration: 78, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502457082271576, gen p mean: -0.05488020181655884, mean p set: 0.4507259726524353
loss_pred:0.0165699515491724, decouple_loss:0.001035146415233612
The modified gen p mean: 0.45231249928474426, gen p mean: -0.04778258875012398, mean p set: 0.45279279351234436The modified gen p mean: 0.4531794488430023, gen p mean: -0.04996311292052269, mean p set: 0.45365968346595764
loss_pred:0.017667820677161217, decouple_loss:0.0010661015985533595
loss_pred:0.016609732061624527, decouple_loss:0.001032056286931038
Iteration: 79, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504961371421814, gen p mean: -0.05500226095318794, mean p set: 0.4509764611721039
loss_pred:0.01620781235396862, decouple_loss:0.0011704876087605953
The modified gen p mean: 0.44988885521888733, gen p mean: -0.05137401819229126, mean p set: 0.4503691494464874The modified gen p mean: 0.4517342746257782, gen p mean: -0.05661396682262421, mean p set: 0.4522145688533783
loss_pred:0.016539473086595535, decouple_loss:0.0012468001805245876
loss_pred:0.017270660027861595, decouple_loss:0.0011569226626306772
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012018_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012018_3_24hr.npz
NaN value num: 0
Iteration: 80, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486909806728363, gen p mean: -0.05744672194123268, mean p set: 0.4491713047027588
loss_pred:0.01557988952845335, decouple_loss:0.001112195779569447
The modified gen p mean: 0.44943419098854065, gen p mean: -0.0669395923614502, mean p set: 0.44991445541381836The modified gen p mean: 0.4483445882797241, gen p mean: -0.06060028821229935, mean p set: 0.4488248825073242
loss_pred:0.015158899128437042, decouple_loss:0.0011553822550922632
loss_pred:0.015546103939414024, decouple_loss:0.0011182831367477775
2023-05-02 03:03:44 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.06662651896476746, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.061617784202098846, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.061899151653051376, mean p set: 0.4500633478164673
loss_pred:0.018473461270332336, decouple_loss:0.0011294716969132423
loss_pred:0.01737109012901783, decouple_loss:0.0010940704960376024
loss_pred:0.01748204417526722, decouple_loss:0.0010842736810445786
WV_0_PC_1_EH_0_PS_40, loss: 0.017830662429332733, avg_mse: 0.025600837543606758
current test mse: 0.025601
Iteration: 81, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490033984184265, gen p mean: -0.06410176306962967, mean p set: 0.4494836926460266
The modified gen p mean: 0.448900431394577, gen p mean: -0.058764562010765076, mean p set: 0.4493807256221771
The modified gen p mean: 0.4490712583065033, gen p mean: -0.06458680331707001, mean p set: 0.4495515525341034
loss_pred:0.014698178507387638, decouple_loss:0.0010797082213684916
loss_pred:0.014688336290419102, decouple_loss:0.001164695480838418
loss_pred:0.015296127647161484, decouple_loss:0.0010933814337477088
Iteration: 82, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495351314544678, gen p mean: -0.0541585236787796, mean p set: 0.4500153958797455
loss_pred:0.014625223353505135, decouple_loss:0.0012451946968212724
The modified gen p mean: 0.4475609362125397, gen p mean: -0.06599122285842896, mean p set: 0.4480412006378174The modified gen p mean: 0.44786709547042847, gen p mean: -0.06197956204414368, mean p set: 0.44834738969802856
loss_pred:0.014740096405148506, decouple_loss:0.0011337331961840391
loss_pred:0.014741288498044014, decouple_loss:0.0011311389971524477
Iteration: 83, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478102922439575, gen p mean: -0.06320907175540924, mean p set: 0.44829061627388
loss_pred:0.01449100486934185, decouple_loss:0.0011611859081313014
The modified gen p mean: 0.44885823130607605, gen p mean: -0.05932728573679924, mean p set: 0.44933852553367615The modified gen p mean: 0.44794365763664246, gen p mean: -0.05898093804717064, mean p set: 0.44842392206192017
loss_pred:0.013836836442351341, decouple_loss:0.0011549550108611584
loss_pred:0.014490582048892975, decouple_loss:0.0011148379417136312
Iteration: 84, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44955405592918396, gen p mean: -0.0529002770781517, mean p set: 0.45003435015678406
loss_pred:0.014167532324790955, decouple_loss:0.0012429055059328675
The modified gen p mean: 0.4500401020050049, gen p mean: -0.04997873678803444, mean p set: 0.450520396232605The modified gen p mean: 0.44827431440353394, gen p mean: -0.05842973664402962, mean p set: 0.4487546384334564
loss_pred:0.01452931109815836, decouple_loss:0.0013429264072328806
loss_pred:0.015199961140751839, decouple_loss:0.0013275978853926063
Iteration: 85, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479655921459198, gen p mean: -0.05815795436501503, mean p set: 0.4484458863735199
loss_pred:0.014265784993767738, decouple_loss:0.0012533629778772593
The modified gen p mean: 0.4492180645465851, gen p mean: -0.05452027544379234, mean p set: 0.4496983587741852The modified gen p mean: 0.44879254698753357, gen p mean: -0.05177656561136246, mean p set: 0.44927287101745605
loss_pred:0.014737343415617943, decouple_loss:0.0012783813290297985
loss_pred:0.014812431298196316, decouple_loss:0.001240341691300273
Iteration: 86, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44982975721359253, gen p mean: -0.0491790808737278, mean p set: 0.450310081243515
loss_pred:0.014888259582221508, decouple_loss:0.0014341423520818353
The modified gen p mean: 0.4480951428413391, gen p mean: -0.0528317429125309, mean p set: 0.4485754370689392The modified gen p mean: 0.44948524236679077, gen p mean: -0.04786819592118263, mean p set: 0.44996556639671326
loss_pred:0.0145057812333107, decouple_loss:0.0013968345010653138
loss_pred:0.014608479104936123, decouple_loss:0.001436157850548625
Iteration: 87, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44853314757347107, gen p mean: -0.04586336389183998, mean p set: 0.44901344180107117
loss_pred:0.014610210433602333, decouple_loss:0.0012360862456262112
The modified gen p mean: 0.4499236047267914, gen p mean: -0.04985784739255905, mean p set: 0.4504038989543915The modified gen p mean: 0.4490126073360443, gen p mean: -0.04473699629306793, mean p set: 0.4494929015636444
loss_pred:0.014249610714614391, decouple_loss:0.0013120911316946149
loss_pred:0.014425985515117645, decouple_loss:0.0012892333324998617
Iteration: 88, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485279321670532, gen p mean: -0.05143674090504646, mean p set: 0.4490082263946533
loss_pred:0.013484274037182331, decouple_loss:0.0015173301799222827
The modified gen p mean: 0.44929611682891846, gen p mean: -0.04477440565824509, mean p set: 0.44977647066116333The modified gen p mean: 0.44802823662757874, gen p mean: -0.05278167128562927, mean p set: 0.44850850105285645
loss_pred:0.014156723394989967, decouple_loss:0.0014286264777183533
loss_pred:0.013754446059465408, decouple_loss:0.0013122226810082793
Iteration: 89, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44861990213394165, gen p mean: -0.042922552675008774, mean p set: 0.44910016655921936
loss_pred:0.014537880197167397, decouple_loss:0.0013588450383394957
The modified gen p mean: 0.44851556420326233, gen p mean: -0.0406162366271019, mean p set: 0.4489958584308624The modified gen p mean: 0.44937974214553833, gen p mean: -0.040328461676836014, mean p set: 0.44986000657081604
loss_pred:0.01440958958119154, decouple_loss:0.0013725231401622295
loss_pred:0.014108319766819477, decouple_loss:0.0014401917578652501
Iteration: 90, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488747715950012, gen p mean: -0.04816960170865059, mean p set: 0.4493550956249237
loss_pred:0.014175978489220142, decouple_loss:0.0014967843890190125
The modified gen p mean: 0.44875583052635193, gen p mean: -0.04887789115309715, mean p set: 0.449236124753952The modified gen p mean: 0.4498286247253418, gen p mean: -0.04392139986157417, mean p set: 0.4503089487552643
loss_pred:0.013672043569386005, decouple_loss:0.0014528932515531778
loss_pred:0.0134591581299901, decouple_loss:0.0014882930554449558
2023-05-02 03:05:37 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.050511814653873444, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.0457841232419014, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.046069663017988205, mean p set: 0.4500633478164673
loss_pred:0.01926356554031372, decouple_loss:0.0015389856416732073
loss_pred:0.018174029886722565, decouple_loss:0.001461297506466508
loss_pred:0.0182185061275959, decouple_loss:0.0015240430366247892
WV_0_PC_1_EH_0_PS_40, loss: 0.018627440556883812, avg_mse: 0.027075057849287987
current test mse: 0.027075
Iteration: 91, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491003453731537, gen p mean: -0.044261328876018524, mean p set: 0.4495806396007538
The modified gen p mean: 0.44893208146095276, gen p mean: -0.042008522897958755, mean p set: 0.44941237568855286
The modified gen p mean: 0.449282169342041, gen p mean: -0.045636195689439774, mean p set: 0.4497624933719635
loss_pred:0.014409951865673065, decouple_loss:0.001380278030410409
loss_pred:0.014344733208417892, decouple_loss:0.001364820753224194
loss_pred:0.013654184527695179, decouple_loss:0.001431873650290072
Iteration: 92, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44923946261405945, gen p mean: -0.04399366304278374, mean p set: 0.44971972703933716
loss_pred:0.013996396213769913, decouple_loss:0.0012977110454812646
The modified gen p mean: 0.4479248821735382, gen p mean: -0.04164932668209076, mean p set: 0.4484051764011383The modified gen p mean: 0.44823339581489563, gen p mean: -0.049806006252765656, mean p set: 0.4487136900424957
loss_pred:0.014499991200864315, decouple_loss:0.0013265095185488462
loss_pred:0.014230077154934406, decouple_loss:0.0013177350629121065
Iteration: 93, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44961708784103394, gen p mean: -0.049277931451797485, mean p set: 0.4500974118709564
loss_pred:0.01395467109978199, decouple_loss:0.0013395482674241066
The modified gen p mean: 0.4494502544403076, gen p mean: -0.04862343892455101, mean p set: 0.4499305486679077The modified gen p mean: 0.449035108089447, gen p mean: -0.04396608844399452, mean p set: 0.4495154023170471
loss_pred:0.01391549315303564, decouple_loss:0.0012828673934563994
loss_pred:0.01341618224978447, decouple_loss:0.0013934398302808404
Iteration: 94, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487936794757843, gen p mean: -0.04766840115189552, mean p set: 0.4492739737033844
loss_pred:0.014167486689984798, decouple_loss:0.001428966294042766
The modified gen p mean: 0.44800862669944763, gen p mean: -0.05611047521233559, mean p set: 0.44848892092704773The modified gen p mean: 0.44849181175231934, gen p mean: -0.04937705397605896, mean p set: 0.44897210597991943
loss_pred:0.014161045663058758, decouple_loss:0.001441418076865375
loss_pred:0.014121702872216702, decouple_loss:0.0014174218522384763
Iteration: 95, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493091106414795, gen p mean: -0.05113716050982475, mean p set: 0.4497894048690796
loss_pred:0.01349620521068573, decouple_loss:0.0012767810840159655
The modified gen p mean: 0.4510590732097626, gen p mean: -0.043801113963127136, mean p set: 0.4515393376350403
The modified gen p mean: 0.44916248321533203, gen p mean: -0.04700625687837601, mean p set: 0.44964277744293213
loss_pred:0.014192053116858006, decouple_loss:0.0013472288846969604
loss_pred:0.014400532469153404, decouple_loss:0.0013596658827736974
Iteration: 96, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4506921172142029, gen p mean: -0.046041339635849, mean p set: 0.451172411441803
loss_pred:0.014025133103132248, decouple_loss:0.001418122905306518
The modified gen p mean: 0.4483950436115265, gen p mean: -0.050713911652565, mean p set: 0.4488753378391266The modified gen p mean: 0.4478776156902313, gen p mean: -0.05457140505313873, mean p set: 0.4483579099178314
loss_pred:0.014242627657949924, decouple_loss:0.0013553921598941088
loss_pred:0.013292413204908371, decouple_loss:0.0013557744678109884
Iteration: 97, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44823217391967773, gen p mean: -0.05482593923807144, mean p set: 0.44871246814727783
loss_pred:0.01394579652696848, decouple_loss:0.0013875585282221437
The modified gen p mean: 0.44784530997276306, gen p mean: -0.057887058705091476, mean p set: 0.44832560420036316The modified gen p mean: 0.45006632804870605, gen p mean: -0.04446171596646309, mean p set: 0.45054665207862854
loss_pred:0.013355753384530544, decouple_loss:0.0014408683637157083
loss_pred:0.013678448274731636, decouple_loss:0.0013100524665787816
Iteration: 98, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45011135935783386, gen p mean: -0.05247695371508598, mean p set: 0.45059165358543396
loss_pred:0.01393238827586174, decouple_loss:0.0012581604532897472
The modified gen p mean: 0.44862130284309387, gen p mean: -0.04909620061516762, mean p set: 0.44910159707069397The modified gen p mean: 0.4490082561969757, gen p mean: -0.04663689434528351, mean p set: 0.4494885504245758
loss_pred:0.013839954510331154, decouple_loss:0.0013495879247784615
loss_pred:0.014658031985163689, decouple_loss:0.0013631538022309542
Iteration: 99, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44851458072662354, gen p mean: -0.046026721596717834, mean p set: 0.44899484515190125
loss_pred:0.014543002471327782, decouple_loss:0.0013419766910374165
The modified gen p mean: 0.44956347346305847, gen p mean: -0.04425450786948204, mean p set: 0.45004376769065857The modified gen p mean: 0.4494500756263733, gen p mean: -0.05038851127028465, mean p set: 0.4499303698539734
loss_pred:0.013271511532366276, decouple_loss:0.0012915722327306867
loss_pred:0.014305783435702324, decouple_loss:0.001410365686751902
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012013_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012013_3_24hr.npz
NaN value num: 0
Iteration: 100, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44784659147262573, gen p mean: -0.04521842673420906, mean p set: 0.44832685589790344
loss_pred:0.013319621793925762, decouple_loss:0.001230549649335444
The modified gen p mean: 0.4472711682319641, gen p mean: -0.04758179932832718, mean p set: 0.4477514624595642The modified gen p mean: 0.44681647419929504, gen p mean: -0.04990197718143463, mean p set: 0.44729676842689514
loss_pred:0.013149101287126541, decouple_loss:0.001150454394519329
loss_pred:0.013647526502609253, decouple_loss:0.001224607927724719
2023-05-02 03:08:06 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.048287708312273026, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.043895259499549866, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.044031158089637756, mean p set: 0.4500633478164673
loss_pred:0.019117005169391632, decouple_loss:0.0012830921914428473
loss_pred:0.017976421862840652, decouple_loss:0.0012789189349859953
loss_pred:0.018054651096463203, decouple_loss:0.0013366537168622017
WV_0_PC_1_EH_0_PS_40, loss: 0.018447671085596085, avg_mse: 0.02683142200112343
current test mse: 0.026831
Iteration: 101, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44799256324768066, gen p mean: -0.04260115325450897, mean p set: 0.44847285747528076
The modified gen p mean: 0.4478999078273773, gen p mean: -0.038314253091812134, mean p set: 0.4483802020549774
The modified gen p mean: 0.4465150237083435, gen p mean: -0.04350816830992699, mean p set: 0.4469953179359436
loss_pred:0.013474904000759125, decouple_loss:0.0012380200205370784
loss_pred:0.013613205403089523, decouple_loss:0.0011568644549697638
loss_pred:0.013544942252337933, decouple_loss:0.0012334134662523866
Iteration: 102, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44652217626571655, gen p mean: -0.04869246855378151, mean p set: 0.44700247049331665
loss_pred:0.013545981608331203, decouple_loss:0.0014165503671392798
The modified gen p mean: 0.448482483625412, gen p mean: -0.045695748180150986, mean p set: 0.4489628076553345The modified gen p mean: 0.44891631603240967, gen p mean: -0.04058420658111572, mean p set: 0.4493965804576874
loss_pred:0.013495092280209064, decouple_loss:0.001291935914196074
loss_pred:0.013337871059775352, decouple_loss:0.0012458083219826221
Iteration: 103, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483893811702728, gen p mean: -0.042230844497680664, mean p set: 0.4488696753978729
loss_pred:0.013414444401860237, decouple_loss:0.00134147924836725
The modified gen p mean: 0.448162704706192, gen p mean: -0.036487776786088943, mean p set: 0.4486429989337921The modified gen p mean: 0.4468412697315216, gen p mean: -0.05146300047636032, mean p set: 0.4473215639591217
loss_pred:0.013441599905490875, decouple_loss:0.001327809877693653
loss_pred:0.013687257654964924, decouple_loss:0.0013519258936867118
Iteration: 104, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478975832462311, gen p mean: -0.0424233116209507, mean p set: 0.4483778774738312
loss_pred:0.013485456816852093, decouple_loss:0.0012379596009850502
The modified gen p mean: 0.44819068908691406, gen p mean: -0.04255465045571327, mean p set: 0.4486709535121918The modified gen p mean: 0.4469221234321594, gen p mean: -0.047331951558589935, mean p set: 0.4474024176597595
loss_pred:0.012991546653211117, decouple_loss:0.0012213325826451182
loss_pred:0.013343515805900097, decouple_loss:0.0013201907277107239
Iteration: 105, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480471909046173, gen p mean: -0.05253148078918457, mean p set: 0.4485274851322174
loss_pred:0.013379622250795364, decouple_loss:0.0013245230074971914
The modified gen p mean: 0.4482991695404053, gen p mean: -0.04409433901309967, mean p set: 0.44877946376800537The modified gen p mean: 0.44889259338378906, gen p mean: -0.043073251843452454, mean p set: 0.44937291741371155
loss_pred:0.01296175830066204, decouple_loss:0.0012292545288801193
loss_pred:0.013372993096709251, decouple_loss:0.0011801337823271751
Iteration: 106, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4462844133377075, gen p mean: -0.04782954975962639, mean p set: 0.44676467776298523
loss_pred:0.013172067701816559, decouple_loss:0.0011580378049984574
The modified gen p mean: 0.4466283917427063, gen p mean: -0.04762202873826027, mean p set: 0.447108656167984The modified gen p mean: 0.44776859879493713, gen p mean: -0.0543709434568882, mean p set: 0.44824886322021484
loss_pred:0.013059573248028755, decouple_loss:0.00116279989015311
loss_pred:0.013182517141103745, decouple_loss:0.0013299634447321296
Iteration: 107, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44627130031585693, gen p mean: -0.04870310053229332, mean p set: 0.44675159454345703
loss_pred:0.013793705962598324, decouple_loss:0.0012158203171566129
The modified gen p mean: 0.4487040936946869, gen p mean: -0.04812326654791832, mean p set: 0.449184387922287The modified gen p mean: 0.44708889722824097, gen p mean: -0.048399798572063446, mean p set: 0.44756919145584106
loss_pred:0.013203621841967106, decouple_loss:0.0010957651538774371
loss_pred:0.013857115991413593, decouple_loss:0.0012007014593109488
Iteration: 108, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44876283407211304, gen p mean: -0.04047665372490883, mean p set: 0.44924309849739075
loss_pred:0.013518443331122398, decouple_loss:0.001180174178443849
The modified gen p mean: 0.4469245970249176, gen p mean: -0.04929903522133827, mean p set: 0.4474049210548401The modified gen p mean: 0.44725826382637024, gen p mean: -0.05597301945090294, mean p set: 0.4477385878562927
loss_pred:0.013251354917883873, decouple_loss:0.0012151909759268165
loss_pred:0.013236570172011852, decouple_loss:0.0012721221428364515
Iteration: 109, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479988217353821, gen p mean: -0.05422068387269974, mean p set: 0.4484791159629822
loss_pred:0.013235638849437237, decouple_loss:0.0011604779865592718
The modified gen p mean: 0.4481365978717804, gen p mean: -0.05287494882941246, mean p set: 0.4486168920993805The modified gen p mean: 0.44711393117904663, gen p mean: -0.05453905835747719, mean p set: 0.44759422540664673
loss_pred:0.013236184604465961, decouple_loss:0.0010884181829169393
loss_pred:0.012885297648608685, decouple_loss:0.0011192553211003542
Iteration: 110, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44750797748565674, gen p mean: -0.04539285600185394, mean p set: 0.44798827171325684
loss_pred:0.01274662185460329, decouple_loss:0.001144175766967237
The modified gen p mean: 0.4485373795032501, gen p mean: -0.047499462962150574, mean p set: 0.4490176737308502The modified gen p mean: 0.4470464587211609, gen p mean: -0.04782771319150925, mean p set: 0.4475267231464386
loss_pred:0.013188616372644901, decouple_loss:0.0011766565730795264
loss_pred:0.013451467268168926, decouple_loss:0.0011936959344893694
2023-05-02 03:10:02 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.0513334646821022, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.047082118690013885, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.04725046828389168, mean p set: 0.4500633478164673
loss_pred:0.019207002595067024, decouple_loss:0.0011613478418439627
loss_pred:0.018050774931907654, decouple_loss:0.001203964464366436
loss_pred:0.018167924135923386, decouple_loss:0.0011861642124131322
WV_0_PC_1_EH_0_PS_40, loss: 0.018534427508711815, avg_mse: 0.02704405039548874
current test mse: 0.027044
Iteration: 111, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477558732032776, gen p mean: -0.051267363131046295, mean p set: 0.4482361972332001
The modified gen p mean: 0.44779109954833984, gen p mean: -0.05258338153362274, mean p set: 0.44827136397361755
The modified gen p mean: 0.4467791020870209, gen p mean: -0.05244263634085655, mean p set: 0.44725939631462097
loss_pred:0.013100726529955864, decouple_loss:0.0011325967498123646
loss_pred:0.01304459199309349, decouple_loss:0.0011652964167296886
loss_pred:0.013047154061496258, decouple_loss:0.001200145692564547
Iteration: 112, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44745805859565735, gen p mean: -0.05276508256793022, mean p set: 0.44793838262557983
loss_pred:0.013106155209243298, decouple_loss:0.0011917584342882037
The modified gen p mean: 0.4473112225532532, gen p mean: -0.04854975640773773, mean p set: 0.44779151678085327
The modified gen p mean: 0.4487799406051636, gen p mean: -0.050925809890031815, mean p set: 0.44926023483276367
loss_pred:0.013195537962019444, decouple_loss:0.0010962135856971145
loss_pred:0.013173993676900864, decouple_loss:0.0011351905995979905
Iteration: 113, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474093019962311, gen p mean: -0.04489343613386154, mean p set: 0.4478895962238312
loss_pred:0.012753954157233238, decouple_loss:0.0010989957954734564
The modified gen p mean: 0.446549654006958, gen p mean: -0.04721148684620857, mean p set: 0.4470299780368805The modified gen p mean: 0.44788146018981934, gen p mean: -0.052067987620830536, mean p set: 0.44836175441741943
loss_pred:0.013531056232750416, decouple_loss:0.0011922740377485752
loss_pred:0.013088437728583813, decouple_loss:0.0011900506215170026
Iteration: 114, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44742703437805176, gen p mean: -0.052138254046440125, mean p set: 0.44790735840797424
loss_pred:0.01291733793914318, decouple_loss:0.0011611675145104527
The modified gen p mean: 0.4480850100517273, gen p mean: -0.04551965370774269, mean p set: 0.4485653042793274The modified gen p mean: 0.44724029302597046, gen p mean: -0.04907301068305969, mean p set: 0.44772061705589294
loss_pred:0.012782815843820572, decouple_loss:0.0011257955338805914
loss_pred:0.013160314410924911, decouple_loss:0.0011313923168927431
Iteration: 115, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467009902000427, gen p mean: -0.04586602747440338, mean p set: 0.4471812844276428
loss_pred:0.013152279891073704, decouple_loss:0.0011188056087121367
The modified gen p mean: 0.4472111463546753, gen p mean: -0.05109529569745064, mean p set: 0.4476914703845978
The modified gen p mean: 0.44752824306488037, gen p mean: -0.0501105934381485, mean p set: 0.44800853729248047
loss_pred:0.013020345941185951, decouple_loss:0.0011171360965818167
loss_pred:0.013148108497262001, decouple_loss:0.0010691372444853187
Iteration: 116, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474667012691498, gen p mean: -0.05285841226577759, mean p set: 0.4479469656944275
loss_pred:0.012912657111883163, decouple_loss:0.0010610626777634025The modified gen p mean: 0.44629597663879395, gen p mean: -0.053029224276542664, mean p set: 0.44677630066871643
The modified gen p mean: 0.44747141003608704, gen p mean: -0.05483608320355415, mean p set: 0.44795170426368713
loss_pred:0.013347579166293144, decouple_loss:0.0011544058797881007
loss_pred:0.013265176676213741, decouple_loss:0.001140156527981162
Iteration: 117, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44691383838653564, gen p mean: -0.05024676397442818, mean p set: 0.44739410281181335
loss_pred:0.013582282699644566, decouple_loss:0.0012054485268890858
The modified gen p mean: 0.44763094186782837, gen p mean: -0.05074445158243179, mean p set: 0.4481112062931061The modified gen p mean: 0.44717198610305786, gen p mean: -0.05560373514890671, mean p set: 0.44765228033065796
loss_pred:0.01301585603505373, decouple_loss:0.0011136040557175875
loss_pred:0.013458948582410812, decouple_loss:0.0010639422107487917
Iteration: 118, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474468231201172, gen p mean: -0.05287961661815643, mean p set: 0.4479270875453949
loss_pred:0.012659819796681404, decouple_loss:0.0011166970944032073
The modified gen p mean: 0.446719229221344, gen p mean: -0.05808402970433235, mean p set: 0.4471994936466217The modified gen p mean: 0.4470864534378052, gen p mean: -0.05958079919219017, mean p set: 0.44756677746772766
loss_pred:0.013286996632814407, decouple_loss:0.0011248370865359902
loss_pred:0.01305009052157402, decouple_loss:0.0010293647646903992
Iteration: 119, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470941126346588, gen p mean: -0.05200615152716637, mean p set: 0.4475743770599365
loss_pred:0.013437105342745781, decouple_loss:0.0011361745418980718
The modified gen p mean: 0.44732221961021423, gen p mean: -0.05815897881984711, mean p set: 0.4478025436401367The modified gen p mean: 0.4479955732822418, gen p mean: -0.05893831327557564, mean p set: 0.4484758675098419
loss_pred:0.012681127525866032, decouple_loss:0.0011330991983413696
loss_pred:0.012956688180565834, decouple_loss:0.0010639176471158862
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012017_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012017_3_24hr.npz
NaN value num: 0
Iteration: 120, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44759809970855713, gen p mean: -0.054523810744285583, mean p set: 0.4480784237384796
loss_pred:0.013941577635705471, decouple_loss:0.001144674839451909
The modified gen p mean: 0.44725844264030457, gen p mean: -0.05211259424686432, mean p set: 0.44773876667022705The modified gen p mean: 0.4492904543876648, gen p mean: -0.05618904158473015, mean p set: 0.4497707486152649
loss_pred:0.013637148775160313, decouple_loss:0.0012532490072771907
loss_pred:0.01358615793287754, decouple_loss:0.0012053350219503045
2023-05-02 03:12:31 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.05295950174331665, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04882014915347099, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04894811287522316, mean p set: 0.4500633478164673
loss_pred:0.01902795024216175, decouple_loss:0.0011509389150887728
loss_pred:0.01788153313100338, decouple_loss:0.001154305529780686
loss_pred:0.017993228510022163, decouple_loss:0.0011728524696081877
WV_0_PC_1_EH_0_PS_40, loss: 0.018358871340751648, avg_mse: 0.026723308488726616
current test mse: 0.026723
Iteration: 121, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44875583052635193, gen p mean: -0.04365230351686478, mean p set: 0.4492361843585968
The modified gen p mean: 0.44741275906562805, gen p mean: -0.05075262114405632, mean p set: 0.44789305329322815
The modified gen p mean: 0.4486768841743469, gen p mean: -0.04174072667956352, mean p set: 0.4491572082042694
loss_pred:0.01417215634137392, decouple_loss:0.0011322393547743559
loss_pred:0.013235250487923622, decouple_loss:0.001211655093356967
loss_pred:0.013315198011696339, decouple_loss:0.0011839442886412144
Iteration: 122, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488871693611145, gen p mean: -0.046014606952667236, mean p set: 0.4493674635887146
loss_pred:0.013919373974204063, decouple_loss:0.0011306200176477432
The modified gen p mean: 0.4477007985115051, gen p mean: -0.04822654649615288, mean p set: 0.4481810927391052The modified gen p mean: 0.4472748041152954, gen p mean: -0.05212414264678955, mean p set: 0.4477550983428955
loss_pred:0.014318104833364487, decouple_loss:0.0011315012816339731
loss_pred:0.01361360214650631, decouple_loss:0.0011126426979899406
Iteration: 123, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44893336296081543, gen p mean: -0.0450553223490715, mean p set: 0.4494136571884155
loss_pred:0.012860014103353024, decouple_loss:0.001196819357573986
The modified gen p mean: 0.44836118817329407, gen p mean: -0.044467512518167496, mean p set: 0.44884148240089417
The modified gen p mean: 0.44853317737579346, gen p mean: -0.04836834594607353, mean p set: 0.44901350140571594
loss_pred:0.01309683732688427, decouple_loss:0.001081181806512177
loss_pred:0.013143173418939114, decouple_loss:0.00110455765388906
Iteration: 124, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44788235425949097, gen p mean: -0.04851863160729408, mean p set: 0.44836267828941345
loss_pred:0.013749288395047188, decouple_loss:0.0013690380146726966
The modified gen p mean: 0.44756239652633667, gen p mean: -0.03409016877412796, mean p set: 0.44804272055625916The modified gen p mean: 0.4482285976409912, gen p mean: -0.04281316325068474, mean p set: 0.4487088918685913
loss_pred:0.013471678830683231, decouple_loss:0.0011598208220675588
loss_pred:0.013136981055140495, decouple_loss:0.0011806351831182837
Iteration: 125, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478819668292999, gen p mean: -0.04739970341324806, mean p set: 0.44836223125457764
loss_pred:0.013603374361991882, decouple_loss:0.0012706647394225001
The modified gen p mean: 0.4497976005077362, gen p mean: -0.04428410902619362, mean p set: 0.4502778649330139The modified gen p mean: 0.44822728633880615, gen p mean: -0.033955588936805725, mean p set: 0.44870755076408386
loss_pred:0.01403480302542448, decouple_loss:0.0013278665719553828
loss_pred:0.013150814920663834, decouple_loss:0.0010470376582816243
Iteration: 126, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495009481906891, gen p mean: -0.04723672568798065, mean p set: 0.4499812126159668
loss_pred:0.013023932464420795, decouple_loss:0.0013940893113613129
The modified gen p mean: 0.44960030913352966, gen p mean: -0.03705480694770813, mean p set: 0.45008060336112976The modified gen p mean: 0.4483802318572998, gen p mean: -0.03655999153852463, mean p set: 0.4488604962825775
loss_pred:0.01350411307066679, decouple_loss:0.0012103042099624872
loss_pred:0.013087977655231953, decouple_loss:0.0011608817148953676
Iteration: 127, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44799745082855225, gen p mean: -0.047465626150369644, mean p set: 0.44847777485847473
loss_pred:0.01393790915608406, decouple_loss:0.001001498894765973
The modified gen p mean: 0.44941335916519165, gen p mean: -0.044955283403396606, mean p set: 0.449893593788147The modified gen p mean: 0.4481185972690582, gen p mean: -0.04211084172129631, mean p set: 0.4485989212989807
loss_pred:0.013495130464434624, decouple_loss:0.0010633643250912428
loss_pred:0.013992763124406338, decouple_loss:0.0010912456782534719
Iteration: 128, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44885775446891785, gen p mean: -0.047509096562862396, mean p set: 0.44933804869651794
loss_pred:0.012654566206037998, decouple_loss:0.001105610397644341
The modified gen p mean: 0.4480818510055542, gen p mean: -0.03504258394241333, mean p set: 0.4485621154308319The modified gen p mean: 0.44861671328544617, gen p mean: -0.0426446758210659, mean p set: 0.44909700751304626
loss_pred:0.01336808130145073, decouple_loss:0.0012114542769268155
loss_pred:0.013019689358770847, decouple_loss:0.0009947617072612047
Iteration: 129, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494127631187439, gen p mean: -0.04439635947346687, mean p set: 0.449893057346344
loss_pred:0.01330944336950779, decouple_loss:0.001045983750373125
The modified gen p mean: 0.4475306272506714, gen p mean: -0.04464292526245117, mean p set: 0.44801095128059387The modified gen p mean: 0.44893890619277954, gen p mean: -0.04745697230100632, mean p set: 0.44941920042037964
loss_pred:0.013425583951175213, decouple_loss:0.0011721554910764098
loss_pred:0.013774821534752846, decouple_loss:0.0012250200379639864
Iteration: 130, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479621946811676, gen p mean: -0.04955675080418587, mean p set: 0.4484424889087677
loss_pred:0.01350058801472187, decouple_loss:0.0011467250296846032
The modified gen p mean: 0.4484682083129883, gen p mean: -0.04761306568980217, mean p set: 0.448948472738266The modified gen p mean: 0.4483950734138489, gen p mean: -0.048223480582237244, mean p set: 0.44887539744377136
loss_pred:0.013363717123866081, decouple_loss:0.0011979022528976202
loss_pred:0.01288152951747179, decouple_loss:0.001252781949006021
2023-05-02 03:14:25 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.04885544627904892, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.044755853712558746, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.0447615310549736, mean p set: 0.4500633478164673
loss_pred:0.019138092175126076, decouple_loss:0.0011743177892640233
loss_pred:0.018019238486886024, decouple_loss:0.0012106687063351274
loss_pred:0.018090642988681793, decouple_loss:0.001270643319003284
WV_0_PC_1_EH_0_PS_40, loss: 0.01847691833972931, avg_mse: 0.0269561056047678
current test mse: 0.026956
Iteration: 131, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44984617829322815, gen p mean: -0.04243612661957741, mean p set: 0.45032650232315063
The modified gen p mean: 0.4493180811405182, gen p mean: -0.05005137249827385, mean p set: 0.4497983753681183
The modified gen p mean: 0.4492121636867523, gen p mean: -0.04594416171312332, mean p set: 0.4496924579143524
loss_pred:0.013050317764282227, decouple_loss:0.0011963521828874946
loss_pred:0.013293770141899586, decouple_loss:0.0010786313796415925
loss_pred:0.0132759315893054, decouple_loss:0.001187866902910173
Iteration: 132, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447651207447052, gen p mean: -0.04881885647773743, mean p set: 0.4481314718723297
loss_pred:0.013794747181236744, decouple_loss:0.001102521433494985
The modified gen p mean: 0.44864314794540405, gen p mean: -0.0486881360411644, mean p set: 0.44912344217300415
The modified gen p mean: 0.44869518280029297, gen p mean: -0.048985276371240616, mean p set: 0.44917547702789307
loss_pred:0.013528564013540745, decouple_loss:0.0010490351123735309
loss_pred:0.012331681326031685, decouple_loss:0.001096126390621066
Iteration: 133, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483799636363983, gen p mean: -0.04800976440310478, mean p set: 0.4488602578639984
loss_pred:0.01305749174207449, decouple_loss:0.0011266625951975584
The modified gen p mean: 0.44682613015174866, gen p mean: -0.05061231181025505, mean p set: 0.44730639457702637The modified gen p mean: 0.4478216767311096, gen p mean: -0.05038115009665489, mean p set: 0.44830194115638733
loss_pred:0.013115767389535904, decouple_loss:0.001011599088087678
loss_pred:0.013188705779612064, decouple_loss:0.0011925144353881478
Iteration: 134, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487735331058502, gen p mean: -0.04864126071333885, mean p set: 0.4492538273334503
loss_pred:0.013267692178487778, decouple_loss:0.0010494780726730824
The modified gen p mean: 0.4488367736339569, gen p mean: -0.04927053302526474, mean p set: 0.449317067861557The modified gen p mean: 0.44900357723236084, gen p mean: -0.05031760409474373, mean p set: 0.44948384165763855
loss_pred:0.012692023999989033, decouple_loss:0.001151150674559176
loss_pred:0.013502871617674828, decouple_loss:0.0010524664539843798
Iteration: 135, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44782891869544983, gen p mean: -0.05113840475678444, mean p set: 0.4483092129230499
loss_pred:0.0130382739007473, decouple_loss:0.0011423534015193582
The modified gen p mean: 0.4490025043487549, gen p mean: -0.043241795152425766, mean p set: 0.449482798576355The modified gen p mean: 0.44853904843330383, gen p mean: -0.049208495765924454, mean p set: 0.44901934266090393
loss_pred:0.013584185391664505, decouple_loss:0.0010785339400172234
loss_pred:0.013163330964744091, decouple_loss:0.0009927303763106465
Iteration: 136, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44753146171569824, gen p mean: -0.05007931962609291, mean p set: 0.4480117857456207
loss_pred:0.013171382248401642, decouple_loss:0.0010596249485388398
The modified gen p mean: 0.4486500322818756, gen p mean: -0.04837619885802269, mean p set: 0.4491303265094757The modified gen p mean: 0.44720131158828735, gen p mean: -0.04845667630434036, mean p set: 0.44768157601356506
loss_pred:0.012858521193265915, decouple_loss:0.000995913171209395
loss_pred:0.01322305016219616, decouple_loss:0.001097800093702972
Iteration: 137, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471893906593323, gen p mean: -0.050582174211740494, mean p set: 0.44766971468925476
loss_pred:0.013711354695260525, decouple_loss:0.0011297878809273243
The modified gen p mean: 0.44885721802711487, gen p mean: -0.04290318489074707, mean p set: 0.44933751225471497The modified gen p mean: 0.4478338658809662, gen p mean: -0.05048314481973648, mean p set: 0.4483141601085663
loss_pred:0.013387742452323437, decouple_loss:0.0010132536990568042
loss_pred:0.013407905586063862, decouple_loss:0.0010239437688142061
Iteration: 138, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481375813484192, gen p mean: -0.04882726073265076, mean p set: 0.4486178159713745
loss_pred:0.013075646944344044, decouple_loss:0.0010492244036868215
The modified gen p mean: 0.4494490623474121, gen p mean: -0.04895291104912758, mean p set: 0.4499293565750122The modified gen p mean: 0.44714075326919556, gen p mean: -0.049957599490880966, mean p set: 0.44762104749679565
loss_pred:0.013633019290864468, decouple_loss:0.001041679410263896
loss_pred:0.013360931538045406, decouple_loss:0.0010406606597825885
Iteration: 139, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448723167181015, gen p mean: -0.04616943746805191, mean p set: 0.4492034912109375
loss_pred:0.013280718587338924, decouple_loss:0.0009804795263335109
The modified gen p mean: 0.44762134552001953, gen p mean: -0.04816954955458641, mean p set: 0.44810163974761963The modified gen p mean: 0.4480086863040924, gen p mean: -0.04760100692510605, mean p set: 0.4484889805316925
loss_pred:0.013075162656605244, decouple_loss:0.0010474948212504387
loss_pred:0.01335218083113432, decouple_loss:0.001084461691789329
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012002_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012002_3_24hr.npz
NaN value num: 0
Iteration: 140, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4517676830291748, gen p mean: -0.04058590531349182, mean p set: 0.4522479474544525
loss_pred:0.016214627772569656, decouple_loss:0.0011615005787461996
The modified gen p mean: 0.4514114260673523, gen p mean: -0.03730050474405289, mean p set: 0.4518917500972748The modified gen p mean: 0.4513724744319916, gen p mean: -0.04012755677103996, mean p set: 0.4518527686595917
loss_pred:0.016294414177536964, decouple_loss:0.0011929124593734741
loss_pred:0.016408400610089302, decouple_loss:0.0010659769177436829
2023-05-02 03:16:53 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.04420765861868858, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.040430352091789246, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04025479033589363, mean p set: 0.4500633478164673
loss_pred:0.018873492255806923, decouple_loss:0.0013283712323755026
loss_pred:0.017754727974534035, decouple_loss:0.0012543278280645609
loss_pred:0.01786424219608307, decouple_loss:0.0012706115376204252
WV_0_PC_1_EH_0_PS_40, loss: 0.018228378146886826, avg_mse: 0.026433667168021202
current test mse: 0.026434
Iteration: 141, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490102529525757, gen p mean: -0.044147610664367676, mean p set: 0.4494905471801758
The modified gen p mean: 0.450093537569046, gen p mean: -0.04449790343642235, mean p set: 0.4505738615989685
The modified gen p mean: 0.45199519395828247, gen p mean: -0.03988794982433319, mean p set: 0.45247551798820496
loss_pred:0.016199471428990364, decouple_loss:0.001244142185896635
loss_pred:0.015577750280499458, decouple_loss:0.0016500833444297314
loss_pred:0.01589500531554222, decouple_loss:0.0013748720521107316
Iteration: 142, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45140236616134644, gen p mean: -0.035360608249902725, mean p set: 0.4518826901912689
The modified gen p mean: 0.44997966289520264, gen p mean: -0.03111787512898445, mean p set: 0.45045995712280273
loss_pred:0.016583764925599098, decouple_loss:0.0012292824685573578
loss_pred:0.016343647614121437, decouple_loss:0.001250668428838253
The modified gen p mean: 0.45104700326919556, gen p mean: -0.03436500206589699, mean p set: 0.45152729749679565
loss_pred:0.016438335180282593, decouple_loss:0.001244350802153349
Iteration: 143, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497230648994446, gen p mean: -0.035914719104766846, mean p set: 0.4502033293247223
loss_pred:0.01615225337445736, decouple_loss:0.0012106163194403052
The modified gen p mean: 0.4477841854095459, gen p mean: -0.030999740585684776, mean p set: 0.4482645094394684The modified gen p mean: 0.44890162348747253, gen p mean: -0.032956983894109726, mean p set: 0.449381947517395
loss_pred:0.016439547762274742, decouple_loss:0.00123108783736825
loss_pred:0.01730688475072384, decouple_loss:0.0011984477750957012
Iteration: 144, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45227617025375366, gen p mean: -0.027592351660132408, mean p set: 0.45275649428367615
loss_pred:0.015696179121732712, decouple_loss:0.001177117694169283
The modified gen p mean: 0.4503028690814972, gen p mean: -0.030042754486203194, mean p set: 0.4507831633090973The modified gen p mean: 0.4521656334400177, gen p mean: -0.03170692175626755, mean p set: 0.4526459276676178
loss_pred:0.01696672849357128, decouple_loss:0.0012256641639396548
loss_pred:0.01613520458340645, decouple_loss:0.0011900612153112888
Iteration: 145, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504455626010895, gen p mean: -0.033812232315540314, mean p set: 0.4509258568286896
loss_pred:0.01626388542354107, decouple_loss:0.001261804485693574
The modified gen p mean: 0.44982659816741943, gen p mean: -0.035976819694042206, mean p set: 0.45030689239501953The modified gen p mean: 0.4502885341644287, gen p mean: -0.035638272762298584, mean p set: 0.4507688283920288
loss_pred:0.01570018380880356, decouple_loss:0.0012143115745857358
loss_pred:0.016573695465922356, decouple_loss:0.0013078624615445733
Iteration: 146, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44969338178634644, gen p mean: -0.03663596510887146, mean p set: 0.45017367601394653
loss_pred:0.016088705509901047, decouple_loss:0.0013745598262175918
The modified gen p mean: 0.4493011236190796, gen p mean: -0.03044573962688446, mean p set: 0.4497814178466797The modified gen p mean: 0.45144110918045044, gen p mean: -0.033807218074798584, mean p set: 0.4519214332103729
loss_pred:0.016610588878393173, decouple_loss:0.0011333238799124956
loss_pred:0.01556971576064825, decouple_loss:0.0012616603635251522
Iteration: 147, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45216304063796997, gen p mean: -0.03150192275643349, mean p set: 0.45264333486557007
loss_pred:0.015578973107039928, decouple_loss:0.001169824507087469
The modified gen p mean: 0.4518192410469055, gen p mean: -0.032087452709674835, mean p set: 0.4522995054721832The modified gen p mean: 0.45145851373672485, gen p mean: -0.03630855306982994, mean p set: 0.45193883776664734
loss_pred:0.0157688707113266, decouple_loss:0.0011695969151332974
loss_pred:0.015220140106976032, decouple_loss:0.0012300357921048999
Iteration: 148, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44761791825294495, gen p mean: -0.04495151340961456, mean p set: 0.44809824228286743
loss_pred:0.015633637085556984, decouple_loss:0.0012320451205596328
The modified gen p mean: 0.4513234794139862, gen p mean: -0.03882049024105072, mean p set: 0.4518038034439087The modified gen p mean: 0.44860783219337463, gen p mean: -0.0459478534758091, mean p set: 0.44908812642097473
loss_pred:0.015470472164452076, decouple_loss:0.001222927588969469
loss_pred:0.015551441349089146, decouple_loss:0.0012583916541188955
Iteration: 149, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45001256465911865, gen p mean: -0.040997471660375595, mean p set: 0.4504929184913635
loss_pred:0.01611843705177307, decouple_loss:0.001109439181163907
The modified gen p mean: 0.45017823576927185, gen p mean: -0.038664430379867554, mean p set: 0.45065850019454956The modified gen p mean: 0.44975754618644714, gen p mean: -0.04450663551688194, mean p set: 0.45023781061172485
loss_pred:0.01585335284471512, decouple_loss:0.0011439810041338205
loss_pred:0.01606224663555622, decouple_loss:0.001223709899932146
Iteration: 150, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4528353810310364, gen p mean: -0.03164145350456238, mean p set: 0.4533156752586365
loss_pred:0.01632792316377163, decouple_loss:0.001150250667706132
The modified gen p mean: 0.44893309473991394, gen p mean: -0.04828735068440437, mean p set: 0.44941338896751404The modified gen p mean: 0.4497659504413605, gen p mean: -0.04324747994542122, mean p set: 0.45024624466896057
loss_pred:0.015614582225680351, decouple_loss:0.0012002300936728716
loss_pred:0.01584716886281967, decouple_loss:0.001183549058623612
2023-05-02 03:18:50 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.04771335422992706, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04346850886940956, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.04328351840376854, mean p set: 0.4500633478164673
loss_pred:0.018438592553138733, decouple_loss:0.0012325396528467536
loss_pred:0.01737770065665245, decouple_loss:0.0013309947680681944
loss_pred:0.017461171373724937, decouple_loss:0.0012118798913434148
WV_0_PC_1_EH_0_PS_40, loss: 0.017822079360485077, avg_mse: 0.025600310415029526
current test mse: 0.0256
Iteration: 151, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44945916533470154, gen p mean: -0.04807838425040245, mean p set: 0.44993945956230164
The modified gen p mean: 0.4494996964931488, gen p mean: -0.03634826838970184, mean p set: 0.4499800503253937
The modified gen p mean: 0.4500460922718048, gen p mean: -0.03852687031030655, mean p set: 0.4505264163017273
loss_pred:0.015260016545653343, decouple_loss:0.0011827810667455196
loss_pred:0.015732627362012863, decouple_loss:0.0011370605789124966
loss_pred:0.016735460609197617, decouple_loss:0.0011318614706397057
Iteration: 152, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490277171134949, gen p mean: -0.04735279828310013, mean p set: 0.4495079815387726
loss_pred:0.015859324485063553, decouple_loss:0.0011200554436072707
The modified gen p mean: 0.44904351234436035, gen p mean: -0.04545377194881439, mean p set: 0.44952380657196045The modified gen p mean: 0.44978219270706177, gen p mean: -0.049026742577552795, mean p set: 0.45026248693466187
loss_pred:0.016452964395284653, decouple_loss:0.0010638897074386477
loss_pred:0.01584315299987793, decouple_loss:0.0011499320389702916
Iteration: 153, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45092499256134033, gen p mean: -0.04513071849942207, mean p set: 0.45140528678894043
loss_pred:0.0155282998457551, decouple_loss:0.001083065988495946
The modified gen p mean: 0.4490024149417877, gen p mean: -0.051453374326229095, mean p set: 0.4494827091693878The modified gen p mean: 0.4501555562019348, gen p mean: -0.045698974281549454, mean p set: 0.4506358802318573
loss_pred:0.016620010137557983, decouple_loss:0.0011184322647750378
loss_pred:0.016069507226347923, decouple_loss:0.0011711205588653684
Iteration: 154, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491592049598694, gen p mean: -0.04350383207201958, mean p set: 0.44963955879211426
loss_pred:0.016364093869924545, decouple_loss:0.0011221987660974264
The modified gen p mean: 0.4524897634983063, gen p mean: -0.04746939241886139, mean p set: 0.45297008752822876The modified gen p mean: 0.4485812485218048, gen p mean: -0.04437476024031639, mean p set: 0.4490615427494049
loss_pred:0.015592662617564201, decouple_loss:0.0010469836415722966
loss_pred:0.017043933272361755, decouple_loss:0.0011272025294601917
Iteration: 155, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505285620689392, gen p mean: -0.049584031105041504, mean p set: 0.4510088264942169
loss_pred:0.015155810862779617, decouple_loss:0.0010756711708381772
The modified gen p mean: 0.4478794038295746, gen p mean: -0.0455101802945137, mean p set: 0.4483596682548523The modified gen p mean: 0.4514055550098419, gen p mean: -0.051079925149679184, mean p set: 0.451885849237442
loss_pred:0.01622500829398632, decouple_loss:0.0012310048332437873
loss_pred:0.01700865849852562, decouple_loss:0.0010792051907628775
Iteration: 156, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44910696148872375, gen p mean: -0.050025682896375656, mean p set: 0.44958722591400146
loss_pred:0.01624384894967079, decouple_loss:0.0011460842797532678
The modified gen p mean: 0.448527067899704, gen p mean: -0.050384264439344406, mean p set: 0.44900739192962646The modified gen p mean: 0.4505431652069092, gen p mean: -0.05423800274729729, mean p set: 0.4510234594345093
loss_pred:0.0162859745323658, decouple_loss:0.0011490151518955827
loss_pred:0.01627984270453453, decouple_loss:0.0011300718178972602
Iteration: 157, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493712782859802, gen p mean: -0.050736866891384125, mean p set: 0.4498515725135803
loss_pred:0.015331920236349106, decouple_loss:0.001085239346139133
The modified gen p mean: 0.44928374886512756, gen p mean: -0.048505790531635284, mean p set: 0.44976404309272766The modified gen p mean: 0.44863754510879517, gen p mean: -0.04938614368438721, mean p set: 0.44911783933639526
loss_pred:0.016084007918834686, decouple_loss:0.0010711754439398646
loss_pred:0.01584816351532936, decouple_loss:0.001088421791791916
Iteration: 158, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501246511936188, gen p mean: -0.04907882958650589, mean p set: 0.45060494542121887
loss_pred:0.016255995258688927, decouple_loss:0.0010979754151776433
The modified gen p mean: 0.4504621624946594, gen p mean: -0.04573290795087814, mean p set: 0.4509424567222595The modified gen p mean: 0.4510818123817444, gen p mean: -0.047378528863191605, mean p set: 0.45156213641166687
loss_pred:0.016115713864564896, decouple_loss:0.0012961633037775755
loss_pred:0.016717854887247086, decouple_loss:0.0011457778746262193
Iteration: 159, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499203860759735, gen p mean: -0.04231349751353264, mean p set: 0.4504006803035736
loss_pred:0.015998059883713722, decouple_loss:0.0011267269728705287
The modified gen p mean: 0.4485863745212555, gen p mean: -0.05358443781733513, mean p set: 0.4490666687488556The modified gen p mean: 0.4500269293785095, gen p mean: -0.045664165169000626, mean p set: 0.4505072236061096
loss_pred:0.0155918188393116, decouple_loss:0.0011408348800614476
loss_pred:0.015718048438429832, decouple_loss:0.0011479780077934265
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012006_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012006_3_24hr.npz
NaN value num: 0
Iteration: 160, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45255032181739807, gen p mean: -0.042949557304382324, mean p set: 0.4530305862426758
loss_pred:0.01605668105185032, decouple_loss:0.0011757616885006428
The modified gen p mean: 0.45343250036239624, gen p mean: -0.04526534304022789, mean p set: 0.4539128243923187The modified gen p mean: 0.4533478021621704, gen p mean: -0.04471296817064285, mean p set: 0.4538280665874481
loss_pred:0.016157330945134163, decouple_loss:0.0010901116766035557
loss_pred:0.0161592960357666, decouple_loss:0.0011853605974465609
2023-05-02 03:21:19 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.050058070570230484, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04625057429075241, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.046003557741642, mean p set: 0.4500633478164673
loss_pred:0.018410632386803627, decouple_loss:0.001136660692282021
loss_pred:0.01735536940395832, decouple_loss:0.001143705565482378
loss_pred:0.0174366757273674, decouple_loss:0.0011210677912458777
WV_0_PC_1_EH_0_PS_40, loss: 0.017790917307138443, avg_mse: 0.02557442896068096
current test mse: 0.025574
Iteration: 161, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502704441547394, gen p mean: -0.03676534444093704, mean p set: 0.4507507383823395
The modified gen p mean: 0.4530271589756012, gen p mean: -0.03682703897356987, mean p set: 0.4535074532032013
The modified gen p mean: 0.4523593485355377, gen p mean: -0.037029702216386795, mean p set: 0.4528396725654602
loss_pred:0.01573869213461876, decouple_loss:0.0010740334400907159
loss_pred:0.01573445275425911, decouple_loss:0.0011254936689510942loss_pred:0.015542690642178059, decouple_loss:0.0010720477439463139
Iteration: 162, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45459312200546265, gen p mean: -0.03640959411859512, mean p set: 0.45507341623306274
loss_pred:0.01619386114180088, decouple_loss:0.0011703401105478406
The modified gen p mean: 0.4536208212375641, gen p mean: -0.03688695281744003, mean p set: 0.4541010856628418The modified gen p mean: 0.4506906270980835, gen p mean: -0.037509553134441376, mean p set: 0.451170951128006
loss_pred:0.01568431779742241, decouple_loss:0.0011470672907307744
loss_pred:0.015527578070759773, decouple_loss:0.001121874083764851
Iteration: 163, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4530910849571228, gen p mean: -0.042294349521398544, mean p set: 0.4535713493824005
loss_pred:0.015872502699494362, decouple_loss:0.0010039189364761114
The modified gen p mean: 0.45443862676620483, gen p mean: -0.03652982413768768, mean p set: 0.45491892099380493The modified gen p mean: 0.4528639018535614, gen p mean: -0.042054224759340286, mean p set: 0.4533441960811615
loss_pred:0.016012676060199738, decouple_loss:0.0010787517530843616
loss_pred:0.016544224694371223, decouple_loss:0.0010408263187855482
Iteration: 164, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4532182514667511, gen p mean: -0.03945617005228996, mean p set: 0.4536985456943512
loss_pred:0.016405625268816948, decouple_loss:0.001059114933013916
The modified gen p mean: 0.45436426997184753, gen p mean: -0.03445484861731529, mean p set: 0.45484453439712524The modified gen p mean: 0.4528731405735016, gen p mean: -0.04058505594730377, mean p set: 0.4533534049987793
loss_pred:0.015751337632536888, decouple_loss:0.0010504305828362703
loss_pred:0.015980850905179977, decouple_loss:0.0010933609446510673
Iteration: 165, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4523785710334778, gen p mean: -0.04323752224445343, mean p set: 0.4528588652610779
loss_pred:0.01594655029475689, decouple_loss:0.0011160861467942595
The modified gen p mean: 0.45313799381256104, gen p mean: -0.04597596451640129, mean p set: 0.45361828804016113The modified gen p mean: 0.4537653625011444, gen p mean: -0.04292646050453186, mean p set: 0.4542456865310669
loss_pred:0.01589493453502655, decouple_loss:0.0011410900624468923
loss_pred:0.01567508652806282, decouple_loss:0.0011252042604610324
Iteration: 166, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45317336916923523, gen p mean: -0.04123692587018013, mean p set: 0.4536536633968353
loss_pred:0.015964264050126076, decouple_loss:0.0010352663230150938
The modified gen p mean: 0.45026296377182007, gen p mean: -0.03881878778338432, mean p set: 0.45074325799942017The modified gen p mean: 0.453774631023407, gen p mean: -0.048539016395807266, mean p set: 0.45425495505332947
loss_pred:0.01656906120479107, decouple_loss:0.0010474981972947717
loss_pred:0.01626768335700035, decouple_loss:0.0009950128151103854
Iteration: 167, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45297107100486755, gen p mean: -0.045419011265039444, mean p set: 0.45345136523246765
loss_pred:0.016298972070217133, decouple_loss:0.0011669876985251904
The modified gen p mean: 0.453561395406723, gen p mean: -0.046087827533483505, mean p set: 0.4540416896343231The modified gen p mean: 0.45216047763824463, gen p mean: -0.04214543104171753, mean p set: 0.45264074206352234
loss_pred:0.015578712336719036, decouple_loss:0.0010338873835280538
loss_pred:0.016583450138568878, decouple_loss:0.0010666492162272334
Iteration: 168, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45288413763046265, gen p mean: -0.040953632444143295, mean p set: 0.45336446166038513
loss_pred:0.0162325669080019, decouple_loss:0.0010479078628122807
The modified gen p mean: 0.45244985818862915, gen p mean: -0.04163607954978943, mean p set: 0.45293015241622925The modified gen p mean: 0.4535242021083832, gen p mean: -0.04039181023836136, mean p set: 0.4540044963359833
loss_pred:0.015301651321351528, decouple_loss:0.001060319715179503
loss_pred:0.01706366054713726, decouple_loss:0.0010710773058235645
Iteration: 169, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4540155529975891, gen p mean: -0.04488544538617134, mean p set: 0.4544958472251892
loss_pred:0.01585782878100872, decouple_loss:0.0011294190771877766
The modified gen p mean: 0.45329082012176514, gen p mean: -0.0395522378385067, mean p set: 0.4537711441516876The modified gen p mean: 0.4543045163154602, gen p mean: -0.044998567551374435, mean p set: 0.4547848105430603
loss_pred:0.016223398968577385, decouple_loss:0.0012015961110591888
loss_pred:0.01621364802122116, decouple_loss:0.0010833845008164644
Iteration: 170, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45303255319595337, gen p mean: -0.04376087337732315, mean p set: 0.45351284742355347
loss_pred:0.016146628186106682, decouple_loss:0.0010196504881605506
The modified gen p mean: 0.4532108008861542, gen p mean: -0.03301122784614563, mean p set: 0.45369112491607666The modified gen p mean: 0.4521951973438263, gen p mean: -0.039332542568445206, mean p set: 0.4526754915714264
loss_pred:0.016620073467493057, decouple_loss:0.0010831045219674706
loss_pred:0.01608850434422493, decouple_loss:0.0011763671645894647
2023-05-02 03:23:13 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.052738938480615616, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04906339570879936, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.0488743856549263, mean p set: 0.4500633478164673
loss_pred:0.018518421798944473, decouple_loss:0.0013810350792482495
loss_pred:0.01735963113605976, decouple_loss:0.0011860623490065336
loss_pred:0.01754302717745304, decouple_loss:0.001281798118725419
WV_0_PC_1_EH_0_PS_40, loss: 0.017871174961328506, avg_mse: 0.025719759985804558
current test mse: 0.02572
Iteration: 171, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45239129662513733, gen p mean: -0.037484101951122284, mean p set: 0.4528715908527374
The modified gen p mean: 0.45335716009140015, gen p mean: -0.03843802213668823, mean p set: 0.45383745431900024
The modified gen p mean: 0.4529658555984497, gen p mean: -0.04129190742969513, mean p set: 0.4534461498260498
loss_pred:0.01614261232316494, decouple_loss:0.0011029300512745976
loss_pred:0.015105056576430798, decouple_loss:0.0011802231892943382
loss_pred:0.016107643023133278, decouple_loss:0.0011618616990745068
Iteration: 172, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4529619812965393, gen p mean: -0.04059077054262161, mean p set: 0.4534422755241394
loss_pred:0.016010364517569542, decouple_loss:0.0010570213198661804
The modified gen p mean: 0.4537457823753357, gen p mean: -0.048739124089479446, mean p set: 0.4542261064052582
The modified gen p mean: 0.4525143504142761, gen p mean: -0.04256944730877876, mean p set: 0.45299461483955383
loss_pred:0.015922848135232925, decouple_loss:0.001044384203851223
loss_pred:0.015843750908970833, decouple_loss:0.0011962923454120755
Iteration: 173, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.453923761844635, gen p mean: -0.04085494205355644, mean p set: 0.4544040560722351
loss_pred:0.016950329765677452, decouple_loss:0.0011199178406968713
The modified gen p mean: 0.4524138271808624, gen p mean: -0.040713123977184296, mean p set: 0.4528941214084625The modified gen p mean: 0.45247045159339905, gen p mean: -0.04109261557459831, mean p set: 0.45295077562332153
loss_pred:0.015148705802857876, decouple_loss:0.0010886711534112692
loss_pred:0.015812698751688004, decouple_loss:0.001068623154424131
Iteration: 174, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.453023225069046, gen p mean: -0.03881172835826874, mean p set: 0.4535035192966461
loss_pred:0.0160527303814888, decouple_loss:0.001033369218930602
The modified gen p mean: 0.4534468352794647, gen p mean: -0.04485001787543297, mean p set: 0.45392709970474243The modified gen p mean: 0.4524284303188324, gen p mean: -0.0415923036634922, mean p set: 0.4529087543487549
loss_pred:0.01593329757452011, decouple_loss:0.0011272478150203824
loss_pred:0.01606026105582714, decouple_loss:0.0012460063444450498
Iteration: 175, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45189180970191956, gen p mean: -0.04155917093157768, mean p set: 0.45237207412719727
loss_pred:0.015833169221878052, decouple_loss:0.0009911024244502187
The modified gen p mean: 0.45182642340660095, gen p mean: -0.04208695888519287, mean p set: 0.45230671763420105The modified gen p mean: 0.4535083472728729, gen p mean: -0.03379011154174805, mean p set: 0.453988641500473
loss_pred:0.01680605113506317, decouple_loss:0.0009715722408145666
loss_pred:0.01628083735704422, decouple_loss:0.0009464063914492726
Iteration: 176, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4538981318473816, gen p mean: -0.050402384251356125, mean p set: 0.4543784260749817
loss_pred:0.015907466411590576, decouple_loss:0.0011379251955077052
The modified gen p mean: 0.45387405157089233, gen p mean: -0.034234438091516495, mean p set: 0.45435431599617004The modified gen p mean: 0.4527731239795685, gen p mean: -0.04000401496887207, mean p set: 0.45325344800949097
loss_pred:0.015615375712513924, decouple_loss:0.0011715181171894073
loss_pred:0.01605609804391861, decouple_loss:0.0009720285306684673
Iteration: 177, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4541272819042206, gen p mean: -0.04552667215466499, mean p set: 0.45460760593414307
loss_pred:0.016335980966687202, decouple_loss:0.0010815126588568091
The modified gen p mean: 0.4534195065498352, gen p mean: -0.042770866304636, mean p set: 0.4538998007774353The modified gen p mean: 0.4534859359264374, gen p mean: -0.049696873873472214, mean p set: 0.45396625995635986
loss_pred:0.015916842967271805, decouple_loss:0.0010970841394737363
loss_pred:0.01522950828075409, decouple_loss:0.0010496015893295407
Iteration: 178, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45275554060935974, gen p mean: -0.0403786264359951, mean p set: 0.45323580503463745
loss_pred:0.015592511743307114, decouple_loss:0.00122313410975039
The modified gen p mean: 0.4530012309551239, gen p mean: -0.04096066951751709, mean p set: 0.453481525182724The modified gen p mean: 0.4525662958621979, gen p mean: -0.04531766474246979, mean p set: 0.453046590089798
loss_pred:0.016358446329832077, decouple_loss:0.0012617247411981225
loss_pred:0.016096988692879677, decouple_loss:0.001213355571962893
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012008_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012008_3_24hr.npz
NaN value num: 0
Iteration: 179, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44643884897232056, gen p mean: -0.0565987154841423, mean p set: 0.44691917300224304
loss_pred:0.014665969647467136, decouple_loss:0.0012385420268401504
The modified gen p mean: 0.44778189063072205, gen p mean: -0.05245610699057579, mean p set: 0.44826218485832214
The modified gen p mean: 0.4467870593070984, gen p mean: -0.052770860493183136, mean p set: 0.4472673535346985
loss_pred:0.014231564477086067, decouple_loss:0.0011938586831092834
loss_pred:0.014442844316363335, decouple_loss:0.0011908411979675293
Iteration: 180, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490039348602295, gen p mean: -0.0543927401304245, mean p set: 0.449484258890152
loss_pred:0.014469178393483162, decouple_loss:0.0011258332524448633
The modified gen p mean: 0.4479027986526489, gen p mean: -0.05747644603252411, mean p set: 0.4483831226825714The modified gen p mean: 0.44802576303482056, gen p mean: -0.05223078653216362, mean p set: 0.44850608706474304
loss_pred:0.013951192609965801, decouple_loss:0.0011149476049467921
loss_pred:0.01418486051261425, decouple_loss:0.0010468517430126667
2023-05-02 03:25:42 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.05961625277996063, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.056126389652490616, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.05598720908164978, mean p set: 0.4500633478164673
loss_pred:0.01862216740846634, decouple_loss:0.0011753233848139644
loss_pred:0.017474910244345665, decouple_loss:0.0011715313885360956
loss_pred:0.01763487607240677, decouple_loss:0.0011633321410045028
WV_0_PC_1_EH_0_PS_40, loss: 0.017969153821468353, avg_mse: 0.02590011991560459
current test mse: 0.0259
Iteration: 181, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44781970977783203, gen p mean: -0.059262827038764954, mean p set: 0.44829997420310974
The modified gen p mean: 0.4483543634414673, gen p mean: -0.054472483694553375, mean p set: 0.4488346576690674
The modified gen p mean: 0.44851401448249817, gen p mean: -0.05846469849348068, mean p set: 0.4489942789077759
loss_pred:0.014342648908495903, decouple_loss:0.0012267156271263957
loss_pred:0.01411851029843092, decouple_loss:0.0011030882596969604
loss_pred:0.014066082425415516, decouple_loss:0.0013852125266566873
Iteration: 182, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44713103771209717, gen p mean: -0.05443023890256882, mean p set: 0.44761136174201965
loss_pred:0.013741329312324524, decouple_loss:0.0012669841526076198
The modified gen p mean: 0.4476199746131897, gen p mean: -0.06405791640281677, mean p set: 0.4481002688407898The modified gen p mean: 0.44692468643188477, gen p mean: -0.05199740082025528, mean p set: 0.44740498065948486
loss_pred:0.013690819032490253, decouple_loss:0.0011897931108251214
loss_pred:0.013793818652629852, decouple_loss:0.001416431157849729
Iteration: 183, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482094943523407, gen p mean: -0.054701708257198334, mean p set: 0.4486897885799408
loss_pred:0.013574086129665375, decouple_loss:0.0013141751987859607
The modified gen p mean: 0.44797995686531067, gen p mean: -0.04867371544241905, mean p set: 0.44846025109291077The modified gen p mean: 0.4475749433040619, gen p mean: -0.05140344426035881, mean p set: 0.4480552673339844
loss_pred:0.013621529564261436, decouple_loss:0.0012604973744601011
loss_pred:0.01373580377548933, decouple_loss:0.0012755285715684295
Iteration: 184, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44779497385025024, gen p mean: -0.0500807948410511, mean p set: 0.44827526807785034
loss_pred:0.0140845887362957, decouple_loss:0.0012956929858773947
The modified gen p mean: 0.4479162395000458, gen p mean: -0.05353223904967308, mean p set: 0.4483965039253235The modified gen p mean: 0.4477499723434448, gen p mean: -0.047042496502399445, mean p set: 0.4482302665710449
loss_pred:0.013711744919419289, decouple_loss:0.0013234034413471818
loss_pred:0.013505687937140465, decouple_loss:0.0014073287602514029
Iteration: 185, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44751372933387756, gen p mean: -0.052903540432453156, mean p set: 0.4479939937591553
loss_pred:0.01364283449947834, decouple_loss:0.00131854391656816
The modified gen p mean: 0.4484352171421051, gen p mean: -0.051338084042072296, mean p set: 0.4489155113697052The modified gen p mean: 0.4472697973251343, gen p mean: -0.04811488091945648, mean p set: 0.4477500915527344
loss_pred:0.013501990586519241, decouple_loss:0.0012814904330298305
loss_pred:0.013719498179852962, decouple_loss:0.0012508289655670524
Iteration: 186, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44743573665618896, gen p mean: -0.05077533423900604, mean p set: 0.44791606068611145
loss_pred:0.013265484943985939, decouple_loss:0.0012842344585806131
The modified gen p mean: 0.44767674803733826, gen p mean: -0.04877739027142525, mean p set: 0.44815701246261597The modified gen p mean: 0.44847428798675537, gen p mean: -0.04413627088069916, mean p set: 0.44895458221435547
loss_pred:0.013286291621625423, decouple_loss:0.0013005414512008429
loss_pred:0.013650468550622463, decouple_loss:0.0014122650027275085
Iteration: 187, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483950734138489, gen p mean: -0.04602671414613724, mean p set: 0.448875367641449
loss_pred:0.01352654304355383, decouple_loss:0.0013872586423531175
The modified gen p mean: 0.44977760314941406, gen p mean: -0.04672293737530708, mean p set: 0.45025789737701416The modified gen p mean: 0.4469769597053528, gen p mean: -0.04215412959456444, mean p set: 0.4474572539329529
loss_pred:0.01352651696652174, decouple_loss:0.0013599019730463624
loss_pred:0.013126342557370663, decouple_loss:0.0014110771007835865
Iteration: 188, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469151496887207, gen p mean: -0.04800679162144661, mean p set: 0.4473954439163208
loss_pred:0.013791854493319988, decouple_loss:0.0013311352813616395
The modified gen p mean: 0.4468684494495392, gen p mean: -0.051604557782411575, mean p set: 0.4473487436771393The modified gen p mean: 0.4471588730812073, gen p mean: -0.04662170633673668, mean p set: 0.4476391673088074
loss_pred:0.013430296443402767, decouple_loss:0.001475923229008913
loss_pred:0.01325936708599329, decouple_loss:0.0014511748449876904
Iteration: 189, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44645363092422485, gen p mean: -0.04344787821173668, mean p set: 0.44693389534950256
loss_pred:0.013527119532227516, decouple_loss:0.0013177383225411177
The modified gen p mean: 0.44617441296577454, gen p mean: -0.042668964713811874, mean p set: 0.44665467739105225The modified gen p mean: 0.4479721784591675, gen p mean: -0.04612887650728226, mean p set: 0.4484524726867676
loss_pred:0.013800011947751045, decouple_loss:0.0013374381233006716
loss_pred:0.013608312234282494, decouple_loss:0.0013190919999033213
Iteration: 190, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466054439544678, gen p mean: -0.03953199461102486, mean p set: 0.4470857083797455
loss_pred:0.013771570287644863, decouple_loss:0.0012215838069096208
The modified gen p mean: 0.44798722863197327, gen p mean: -0.04872925952076912, mean p set: 0.44846752285957336The modified gen p mean: 0.4480445384979248, gen p mean: -0.04160532355308533, mean p set: 0.4485248327255249
loss_pred:0.012937620282173157, decouple_loss:0.001273716683499515
loss_pred:0.013348540291190147, decouple_loss:0.001264294725842774
2023-05-02 03:27:35 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.048478931188583374, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.044538531452417374, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04478486254811287, mean p set: 0.4500633478164673
loss_pred:0.019150251522660255, decouple_loss:0.0015235531609505415
loss_pred:0.018132822588086128, decouple_loss:0.0014672719407826662loss_pred:0.018106890842318535, decouple_loss:0.0014875743072479963
WV_0_PC_1_EH_0_PS_40, loss: 0.018537964671850204, avg_mse: 0.026955099776387215
current test mse: 0.026955
Iteration: 191, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483235776424408, gen p mean: -0.04137983173131943, mean p set: 0.4488039016723633
The modified gen p mean: 0.4468735456466675, gen p mean: -0.04901454970240593, mean p set: 0.44735386967658997
The modified gen p mean: 0.44828876852989197, gen p mean: -0.04235426336526871, mean p set: 0.44876906275749207
loss_pred:0.012722746469080448, decouple_loss:0.001452106167562306
loss_pred:0.012907953932881355, decouple_loss:0.0014017962384968996
loss_pred:0.013780957087874413, decouple_loss:0.001362297683954239
Iteration: 192, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473857879638672, gen p mean: -0.04447953775525093, mean p set: 0.4478660821914673
loss_pred:0.01331963762640953, decouple_loss:0.001272853696718812
The modified gen p mean: 0.4479478597640991, gen p mean: -0.0475548580288887, mean p set: 0.4484281837940216
The modified gen p mean: 0.44934898614883423, gen p mean: -0.04316853731870651, mean p set: 0.4498293101787567
loss_pred:0.013423169031739235, decouple_loss:0.0011626100167632103
loss_pred:0.014075213111937046, decouple_loss:0.0011985761811956763
Iteration: 193, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44810476899147034, gen p mean: -0.04295005649328232, mean p set: 0.4485850930213928
loss_pred:0.012882976792752743, decouple_loss:0.001472019706852734
The modified gen p mean: 0.44762831926345825, gen p mean: -0.04580030217766762, mean p set: 0.44810861349105835The modified gen p mean: 0.44826120138168335, gen p mean: -0.04266545549035072, mean p set: 0.44874149560928345
loss_pred:0.01292925700545311, decouple_loss:0.0014021068345755339
loss_pred:0.013132398016750813, decouple_loss:0.0013813030673190951
Iteration: 194, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472024142742157, gen p mean: -0.04796387627720833, mean p set: 0.4476827085018158
loss_pred:0.013432098552584648, decouple_loss:0.0011429406004026532
The modified gen p mean: 0.44948098063468933, gen p mean: -0.047806739807128906, mean p set: 0.4499613046646118The modified gen p mean: 0.4489873945713043, gen p mean: -0.0471281073987484, mean p set: 0.4494676887989044
loss_pred:0.013052997179329395, decouple_loss:0.0013167831348255277
loss_pred:0.013134426437318325, decouple_loss:0.001357660279609263
Iteration: 195, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477563798427582, gen p mean: -0.05154239758849144, mean p set: 0.4482366442680359
loss_pred:0.012639698572456837, decouple_loss:0.0015135979047045112
The modified gen p mean: 0.44765836000442505, gen p mean: -0.04706847295165062, mean p set: 0.44813862442970276The modified gen p mean: 0.44811391830444336, gen p mean: -0.04820895567536354, mean p set: 0.44859424233436584
loss_pred:0.013792650774121284, decouple_loss:0.0014208487700670958
loss_pred:0.013442743569612503, decouple_loss:0.0014891114551573992
Iteration: 196, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448159396648407, gen p mean: -0.04873165860772133, mean p set: 0.4486396908760071
loss_pred:0.01336660049855709, decouple_loss:0.0012186216190457344
The modified gen p mean: 0.44857507944107056, gen p mean: -0.058142583817243576, mean p set: 0.44905540347099304The modified gen p mean: 0.449179083108902, gen p mean: -0.050102923065423965, mean p set: 0.4496593773365021
loss_pred:0.013158091343939304, decouple_loss:0.0013598020887002349
loss_pred:0.012903065420687199, decouple_loss:0.0012180455960333347
Iteration: 197, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44793081283569336, gen p mean: -0.050775591284036636, mean p set: 0.44841110706329346
loss_pred:0.013831036165356636, decouple_loss:0.0011965322773903608
The modified gen p mean: 0.4472668468952179, gen p mean: -0.04741014167666435, mean p set: 0.447747141122818The modified gen p mean: 0.44690239429473877, gen p mean: -0.04449837654829025, mean p set: 0.44738268852233887
loss_pred:0.013624830171465874, decouple_loss:0.001286273472942412
loss_pred:0.013091441243886948, decouple_loss:0.0011633371468633413
Iteration: 198, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44668376445770264, gen p mean: -0.04942306876182556, mean p set: 0.44716405868530273
loss_pred:0.013107188045978546, decouple_loss:0.0011786440154537559
The modified gen p mean: 0.4486221671104431, gen p mean: -0.045240290462970734, mean p set: 0.4491024613380432The modified gen p mean: 0.4473644196987152, gen p mean: -0.04826913774013519, mean p set: 0.4478446841239929
loss_pred:0.012854051776230335, decouple_loss:0.0010903344955295324
loss_pred:0.01356897596269846, decouple_loss:0.0012017556000500917
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012009_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012009_3_24hr.npz
NaN value num: 0
Iteration: 199, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450425922870636, gen p mean: -0.04201719909906387, mean p set: 0.4509062170982361
loss_pred:0.01683802530169487, decouple_loss:0.0013751561054959893
The modified gen p mean: 0.45255064964294434, gen p mean: -0.04421811178326607, mean p set: 0.4530309736728668The modified gen p mean: 0.45209187269210815, gen p mean: -0.039948541671037674, mean p set: 0.45257216691970825
loss_pred:0.016628867015242577, decouple_loss:0.0014848512364551425
loss_pred:0.01620093546807766, decouple_loss:0.0014378858031705022
Iteration: 200, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45263397693634033, gen p mean: -0.03974603861570358, mean p set: 0.45311427116394043
loss_pred:0.01600651443004608, decouple_loss:0.001345951808616519
The modified gen p mean: 0.4500288665294647, gen p mean: -0.03682374954223633, mean p set: 0.4505091905593872The modified gen p mean: 0.45280054211616516, gen p mean: -0.03395640850067139, mean p set: 0.45328083634376526
loss_pred:0.016279928386211395, decouple_loss:0.001400723704136908
loss_pred:0.016965685412287712, decouple_loss:0.001471866387873888
2023-05-02 03:30:05 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.04494640603661537, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04082358628511429, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04105735570192337, mean p set: 0.4500633478164673
loss_pred:0.018779044970870018, decouple_loss:0.0015193299623206258
loss_pred:0.017738724127411842, decouple_loss:0.00146641512401402
loss_pred:0.017724832519888878, decouple_loss:0.0014613032108172774
WV_0_PC_1_EH_0_PS_40, loss: 0.018154986202716827, avg_mse: 0.02624272182583809
current test mse: 0.026243
Iteration: 201, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45204970240592957, gen p mean: -0.028656765818595886, mean p set: 0.45252999663352966
The modified gen p mean: 0.45206841826438904, gen p mean: -0.032501209527254105, mean p set: 0.45254871249198914
The modified gen p mean: 0.45123565196990967, gen p mean: -0.033936452120542526, mean p set: 0.4517159163951874
loss_pred:0.01736057549715042, decouple_loss:0.001421175547875464
loss_pred:0.016181502491235733, decouple_loss:0.00120671431068331
loss_pred:0.01678008772432804, decouple_loss:0.0012818509712815285
Iteration: 202, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44911253452301025, gen p mean: -0.03368743881583214, mean p set: 0.44959282875061035
loss_pred:0.016648883000016212, decouple_loss:0.0012897643027827144
The modified gen p mean: 0.44949814677238464, gen p mean: -0.03349956125020981, mean p set: 0.44997847080230713The modified gen p mean: 0.45153066515922546, gen p mean: -0.03779001161456108, mean p set: 0.4520109295845032
loss_pred:0.015841225162148476, decouple_loss:0.001399760483764112
loss_pred:0.016536936163902283, decouple_loss:0.0012422747677192092
Iteration: 203, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513115882873535, gen p mean: -0.031258441507816315, mean p set: 0.4517918825149536
loss_pred:0.015999186784029007, decouple_loss:0.0014288098318502307
The modified gen p mean: 0.45276182889938354, gen p mean: -0.036651112139225006, mean p set: 0.45324212312698364The modified gen p mean: 0.45261350274086, gen p mean: -0.029789606109261513, mean p set: 0.4530937969684601
loss_pred:0.01635776273906231, decouple_loss:0.0013622577534988523
loss_pred:0.015326772816479206, decouple_loss:0.0014214753173291683
Iteration: 204, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45212826132774353, gen p mean: -0.03954814746975899, mean p set: 0.45260855555534363
loss_pred:0.015398469753563404, decouple_loss:0.0013731091748923063
The modified gen p mean: 0.4523252844810486, gen p mean: -0.03869229555130005, mean p set: 0.45280560851097107
The modified gen p mean: 0.4507342576980591, gen p mean: -0.03565444052219391, mean p set: 0.4512145519256592
loss_pred:0.015625858679413795, decouple_loss:0.001378376386128366
loss_pred:0.01647971011698246, decouple_loss:0.0013354492839425802
Iteration: 205, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500044584274292, gen p mean: -0.03803342953324318, mean p set: 0.4504847228527069
loss_pred:0.016337571665644646, decouple_loss:0.0014325936790555716
The modified gen p mean: 0.4495428800582886, gen p mean: -0.033919304609298706, mean p set: 0.4500231444835663The modified gen p mean: 0.452853798866272, gen p mean: -0.031994208693504333, mean p set: 0.4533340632915497
loss_pred:0.0161272082477808, decouple_loss:0.0013799744192510843
loss_pred:0.01695959083735943, decouple_loss:0.0014812425943091512
Iteration: 206, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4520549774169922, gen p mean: -0.037181306630373, mean p set: 0.4525352716445923
loss_pred:0.017101861536502838, decouple_loss:0.0011635494884103537
The modified gen p mean: 0.45100846886634827, gen p mean: -0.03593127056956291, mean p set: 0.45148876309394836The modified gen p mean: 0.45032015442848206, gen p mean: -0.03753063082695007, mean p set: 0.45080041885375977
loss_pred:0.016663916409015656, decouple_loss:0.0012863180600106716
loss_pred:0.0164420697838068, decouple_loss:0.001252164482139051
Iteration: 207, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450872540473938, gen p mean: -0.04034829139709473, mean p set: 0.4513528347015381
loss_pred:0.01670917496085167, decouple_loss:0.0013602973194792867
The modified gen p mean: 0.4535921514034271, gen p mean: -0.041993141174316406, mean p set: 0.4540724456310272The modified gen p mean: 0.4516717791557312, gen p mean: -0.03891279175877571, mean p set: 0.4521520435810089
loss_pred:0.015712957829236984, decouple_loss:0.0013543592067435384
loss_pred:0.01596403494477272, decouple_loss:0.0013235369697213173
Iteration: 208, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4519517719745636, gen p mean: -0.035853464156389236, mean p set: 0.4524320662021637
loss_pred:0.015920737758278847, decouple_loss:0.0013453741557896137
The modified gen p mean: 0.4514251947402954, gen p mean: -0.03560234606266022, mean p set: 0.4519054889678955The modified gen p mean: 0.45326361060142517, gen p mean: -0.04354681819677353, mean p set: 0.45374393463134766
loss_pred:0.015977397561073303, decouple_loss:0.0013778313295915723
loss_pred:0.015522947534918785, decouple_loss:0.001330588711425662
Iteration: 209, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44926100969314575, gen p mean: -0.044026438146829605, mean p set: 0.44974127411842346
loss_pred:0.016040684655308723, decouple_loss:0.0013042489299550653
The modified gen p mean: 0.45060452818870544, gen p mean: -0.047988325357437134, mean p set: 0.45108485221862793The modified gen p mean: 0.452254056930542, gen p mean: -0.04333404824137688, mean p set: 0.4527343511581421
loss_pred:0.01561594009399414, decouple_loss:0.001332300715148449
loss_pred:0.0156907606869936, decouple_loss:0.001302699209190905
Iteration: 210, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4525910019874573, gen p mean: -0.03687819838523865, mean p set: 0.4530712962150574
loss_pred:0.015702424570918083, decouple_loss:0.0013122601667419076
The modified gen p mean: 0.4524647891521454, gen p mean: -0.04051922261714935, mean p set: 0.45294511318206787The modified gen p mean: 0.4501611590385437, gen p mean: -0.039505843073129654, mean p set: 0.4506414532661438
loss_pred:0.015384078957140446, decouple_loss:0.001308135804720223
loss_pred:0.016054049134254456, decouple_loss:0.0013168236473575234
2023-05-02 03:32:01 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.0543932281434536, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.05041584372520447, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.05078645423054695, mean p set: 0.4500633478164673
loss_pred:0.018660375848412514, decouple_loss:0.0013897139579057693
loss_pred:0.017553213983774185, decouple_loss:0.0013675515074282885
loss_pred:0.01756000705063343, decouple_loss:0.0014280397444963455
WV_0_PC_1_EH_0_PS_40, loss: 0.017994288355112076, avg_mse: 0.025920046493411064
current test mse: 0.02592
Iteration: 211, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4532754719257355, gen p mean: -0.04564473778009415, mean p set: 0.45375576615333557
The modified gen p mean: 0.455077588558197, gen p mean: -0.044524941593408585, mean p set: 0.4555578827857971
The modified gen p mean: 0.4516910910606384, gen p mean: -0.046337760984897614, mean p set: 0.4521713852882385
loss_pred:0.015379659831523895, decouple_loss:0.001343056675978005
loss_pred:0.015412595123052597, decouple_loss:0.001183397602289915
loss_pred:0.016043774783611298, decouple_loss:0.0012712833704426885
Iteration: 212, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511748254299164, gen p mean: -0.04635654017329216, mean p set: 0.4516550898551941
loss_pred:0.015643442049622536, decouple_loss:0.0013237579260021448
The modified gen p mean: 0.45168358087539673, gen p mean: -0.038753487169742584, mean p set: 0.4521639347076416The modified gen p mean: 0.4539457857608795, gen p mean: -0.04255053028464317, mean p set: 0.4544260501861572
loss_pred:0.016183318570256233, decouple_loss:0.0012463352177292109
loss_pred:0.015750810503959656, decouple_loss:0.0011904945131391287
Iteration: 213, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508156180381775, gen p mean: -0.05296000465750694, mean p set: 0.4512959122657776
loss_pred:0.015255050733685493, decouple_loss:0.0012306803837418556
The modified gen p mean: 0.4511377513408661, gen p mean: -0.05190339684486389, mean p set: 0.4516180753707886The modified gen p mean: 0.45129072666168213, gen p mean: -0.04503189027309418, mean p set: 0.45177099108695984
loss_pred:0.015644285827875137, decouple_loss:0.0012834755470976233
loss_pred:0.016041172668337822, decouple_loss:0.0013579148799180984
Iteration: 214, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45117950439453125, gen p mean: -0.04139140620827675, mean p set: 0.45165982842445374
loss_pred:0.016164494678378105, decouple_loss:0.0012478026328608394
The modified gen p mean: 0.4517531096935272, gen p mean: -0.03920810669660568, mean p set: 0.4522334337234497The modified gen p mean: 0.44975900650024414, gen p mean: -0.04171258956193924, mean p set: 0.45023927092552185
loss_pred:0.016239037737250328, decouple_loss:0.0014949932228773832
loss_pred:0.016566786915063858, decouple_loss:0.0012924423208460212
Iteration: 215, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4519859254360199, gen p mean: -0.04499797895550728, mean p set: 0.45246621966362
loss_pred:0.01581752859055996, decouple_loss:0.0011647503124549985
The modified gen p mean: 0.4524706304073334, gen p mean: -0.0469803661108017, mean p set: 0.45295095443725586The modified gen p mean: 0.4509032368659973, gen p mean: -0.048785384744405746, mean p set: 0.4513835310935974
loss_pred:0.015551846474409103, decouple_loss:0.001220055390149355
loss_pred:0.015974316745996475, decouple_loss:0.0013027394888922572
Iteration: 216, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4509732723236084, gen p mean: -0.04335346072912216, mean p set: 0.4514535665512085
loss_pred:0.016078317537903786, decouple_loss:0.0013200349640101194
The modified gen p mean: 0.45114395022392273, gen p mean: -0.044112928211688995, mean p set: 0.4516242742538452
The modified gen p mean: 0.45118018984794617, gen p mean: -0.04465760290622711, mean p set: 0.45166051387786865
loss_pred:0.01573471538722515, decouple_loss:0.0012369260657578707
loss_pred:0.015770230442285538, decouple_loss:0.001332909450866282
Iteration: 217, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45269447565078735, gen p mean: -0.049712926149368286, mean p set: 0.45317476987838745
loss_pred:0.015397007577121258, decouple_loss:0.0009665220859460533
The modified gen p mean: 0.45268043875694275, gen p mean: -0.04636145383119583, mean p set: 0.45316070318222046The modified gen p mean: 0.45258569717407227, gen p mean: -0.04705600440502167, mean p set: 0.45306602120399475
loss_pred:0.015792828053236008, decouple_loss:0.0010025922674685717
loss_pred:0.016053779050707817, decouple_loss:0.0012324585113674402
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012005_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012005_3_24hr.npz
NaN value num: 0
Iteration: 218, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4510252773761749, gen p mean: -0.055045485496520996, mean p set: 0.451505571603775
loss_pred:0.016924042254686356, decouple_loss:0.001048731035552919
The modified gen p mean: 0.4510059058666229, gen p mean: -0.043422870337963104, mean p set: 0.45148617029190063The modified gen p mean: 0.4514378309249878, gen p mean: -0.055118102580308914, mean p set: 0.4519181549549103
loss_pred:0.016906723380088806, decouple_loss:0.0011716317385435104
loss_pred:0.0157568771392107, decouple_loss:0.0010895539307966828
Iteration: 219, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45057252049446106, gen p mean: -0.045342013239860535, mean p set: 0.45105281472206116
loss_pred:0.015571658499538898, decouple_loss:0.0011917741503566504
The modified gen p mean: 0.4524074196815491, gen p mean: -0.04911496117711067, mean p set: 0.45288771390914917The modified gen p mean: 0.4527597725391388, gen p mean: -0.04890168458223343, mean p set: 0.4532400667667389
loss_pred:0.018102938309311867, decouple_loss:0.0011542747961357236
loss_pred:0.018103724345564842, decouple_loss:0.0012025710893794894
Iteration: 220, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4515439569950104, gen p mean: -0.05351204425096512, mean p set: 0.4520242512226105
loss_pred:0.016295356675982475, decouple_loss:0.0009858272969722748
The modified gen p mean: 0.45116761326789856, gen p mean: -0.05132003873586655, mean p set: 0.45164790749549866The modified gen p mean: 0.4506426751613617, gen p mean: -0.05052618682384491, mean p set: 0.4511229395866394
loss_pred:0.016883794218301773, decouple_loss:0.00112808495759964
loss_pred:0.017152929678559303, decouple_loss:0.0011131759965792298
2023-05-02 03:34:33 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.05620209500193596, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.052250951528549194, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.05239534750580788, mean p set: 0.4500633478164673
loss_pred:0.018410591408610344, decouple_loss:0.0013864574721083045
loss_pred:0.017375420778989792, decouple_loss:0.0013364459155127406
loss_pred:0.017433980479836464, decouple_loss:0.0013043569633737206
WV_0_PC_1_EH_0_PS_40, loss: 0.017807118594646454, avg_mse: 0.025573531165719032
current test mse: 0.025574
Iteration: 221, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4509257674217224, gen p mean: -0.05007329210639, mean p set: 0.4514060616493225
The modified gen p mean: 0.45133134722709656, gen p mean: -0.05186004564166069, mean p set: 0.45181164145469666
The modified gen p mean: 0.45110514760017395, gen p mean: -0.04849756881594658, mean p set: 0.45158541202545166
loss_pred:0.017352595925331116, decouple_loss:0.001234389841556549
loss_pred:0.017568226903676987, decouple_loss:0.001239919918589294
loss_pred:0.01774601824581623, decouple_loss:0.0011343505466356874
Iteration: 222, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503636956214905, gen p mean: -0.05685785785317421, mean p set: 0.4508439898490906
loss_pred:0.015707068145275116, decouple_loss:0.0012140162289142609
The modified gen p mean: 0.45039990544319153, gen p mean: -0.04742272198200226, mean p set: 0.45088016986846924The modified gen p mean: 0.45191532373428345, gen p mean: -0.058394622057676315, mean p set: 0.45239561796188354
loss_pred:0.01638530194759369, decouple_loss:0.0012551966356113553
loss_pred:0.016853181645274162, decouple_loss:0.0011717247543856502
Iteration: 223, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511990249156952, gen p mean: -0.05013630911707878, mean p set: 0.4516793489456177
loss_pred:0.01768697053194046, decouple_loss:0.001209594076499343
The modified gen p mean: 0.4515528380870819, gen p mean: -0.04770693555474281, mean p set: 0.4520331025123596The modified gen p mean: 0.4512471556663513, gen p mean: -0.056995414197444916, mean p set: 0.45172742009162903
loss_pred:0.01716581918299198, decouple_loss:0.0014038393273949623
loss_pred:0.01745796948671341, decouple_loss:0.001044836244545877
Iteration: 224, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.451057106256485, gen p mean: -0.05467201769351959, mean p set: 0.4515374004840851
loss_pred:0.017312807962298393, decouple_loss:0.0012739443918690085
The modified gen p mean: 0.45028239488601685, gen p mean: -0.056661445647478104, mean p set: 0.45076268911361694The modified gen p mean: 0.45221853256225586, gen p mean: -0.05884760990738869, mean p set: 0.45269879698753357
loss_pred:0.017494887113571167, decouple_loss:0.0012478798162192106
loss_pred:0.01610456593334675, decouple_loss:0.001282037002965808
Iteration: 225, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4518134593963623, gen p mean: -0.055952806025743484, mean p set: 0.4522937834262848
loss_pred:0.015289013274013996, decouple_loss:0.0012178662000223994
The modified gen p mean: 0.45290449261665344, gen p mean: -0.05552784726023674, mean p set: 0.45338475704193115The modified gen p mean: 0.4500422775745392, gen p mean: -0.05807662010192871, mean p set: 0.45052260160446167
loss_pred:0.01607750542461872, decouple_loss:0.0012042633024975657
loss_pred:0.016848934814333916, decouple_loss:0.001118970918469131
Iteration: 226, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45155468583106995, gen p mean: -0.050412409007549286, mean p set: 0.45203498005867004
loss_pred:0.017299771308898926, decouple_loss:0.001366744632832706
The modified gen p mean: 0.45097115635871887, gen p mean: -0.05198283866047859, mean p set: 0.45145145058631897The modified gen p mean: 0.45149075984954834, gen p mean: -0.05122135952115059, mean p set: 0.45197105407714844
loss_pred:0.0164149422198534, decouple_loss:0.0013360793236643076
loss_pred:0.016712190583348274, decouple_loss:0.0014295898145064712
Iteration: 227, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45060813426971436, gen p mean: -0.046929825097322464, mean p set: 0.45108845829963684
loss_pred:0.016849519684910774, decouple_loss:0.0012255852343514562
The modified gen p mean: 0.4523831307888031, gen p mean: -0.04776925593614578, mean p set: 0.4528633952140808The modified gen p mean: 0.452442467212677, gen p mean: -0.04994513466954231, mean p set: 0.4529227614402771
loss_pred:0.01734369434416294, decouple_loss:0.0013677960960194468
loss_pred:0.0165324155241251, decouple_loss:0.0012326956493780017
Iteration: 228, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4510725140571594, gen p mean: -0.04454461857676506, mean p set: 0.4515528082847595
loss_pred:0.01777469925582409, decouple_loss:0.0012382393470034003
The modified gen p mean: 0.4502906799316406, gen p mean: -0.053962092846632004, mean p set: 0.4507710039615631The modified gen p mean: 0.4494110643863678, gen p mean: -0.05444610118865967, mean p set: 0.4498913586139679
loss_pred:0.01712537556886673, decouple_loss:0.0011825298424810171
loss_pred:0.01566249690949917, decouple_loss:0.0011656387941911817
Iteration: 229, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45230168104171753, gen p mean: -0.042642880231142044, mean p set: 0.45278200507164
loss_pred:0.016590837389230728, decouple_loss:0.0012402018764987588
The modified gen p mean: 0.4506296217441559, gen p mean: -0.04207630828022957, mean p set: 0.4511098861694336The modified gen p mean: 0.45133718848228455, gen p mean: -0.04263642802834511, mean p set: 0.45181748270988464
loss_pred:0.017194578424096107, decouple_loss:0.0011802351800724864
loss_pred:0.017562083899974823, decouple_loss:0.0011388565180823207
Iteration: 230, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4523986279964447, gen p mean: -0.04598454013466835, mean p set: 0.4528789222240448
loss_pred:0.01586168259382248, decouple_loss:0.0010890072444453835
The modified gen p mean: 0.4510226249694824, gen p mean: -0.04306395351886749, mean p set: 0.4515029489994049The modified gen p mean: 0.45118051767349243, gen p mean: -0.04750780761241913, mean p set: 0.45166081190109253
loss_pred:0.015528074465692043, decouple_loss:0.0010866224765777588
loss_pred:0.016180185601115227, decouple_loss:0.001101301982998848
2023-05-02 03:36:29 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.04951814189553261, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04557373374700546, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.045645665377378464, mean p set: 0.4500633478164673
loss_pred:0.018533501774072647, decouple_loss:0.0012912959791719913
loss_pred:0.017512263730168343, decouple_loss:0.0011721057817339897
loss_pred:0.017513183876872063, decouple_loss:0.0011563608422875404
WV_0_PC_1_EH_0_PS_40, loss: 0.01791331171989441, avg_mse: 0.025769706815481186
current test mse: 0.02577
Iteration: 231, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4510195255279541, gen p mean: -0.04063400626182556, mean p set: 0.4514998197555542
The modified gen p mean: 0.4505358338356018, gen p mean: -0.04581516608595848, mean p set: 0.4510160982608795
The modified gen p mean: 0.4513143002986908, gen p mean: -0.04636426642537117, mean p set: 0.4517945945262909
loss_pred:0.015530536882579327, decouple_loss:0.0010107900016009808
loss_pred:0.017793264240026474, decouple_loss:0.0010506989201530814
loss_pred:0.017039155587553978, decouple_loss:0.0011081912089139223
Iteration: 232, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450927734375, gen p mean: -0.04361336678266525, mean p set: 0.4514080286026001
loss_pred:0.017590893432497978, decouple_loss:0.0010438876925036311
The modified gen p mean: 0.45191705226898193, gen p mean: -0.04733680933713913, mean p set: 0.45239734649658203The modified gen p mean: 0.45163244009017944, gen p mean: -0.04617371782660484, mean p set: 0.45211273431777954
loss_pred:0.015734298154711723, decouple_loss:0.0011344626545906067
loss_pred:0.01712917909026146, decouple_loss:0.0011643620673567057
Iteration: 233, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507334530353546, gen p mean: -0.03784434124827385, mean p set: 0.4512137174606323
loss_pred:0.015545888803899288, decouple_loss:0.0009869660716503859
The modified gen p mean: 0.45093539357185364, gen p mean: -0.042672522366046906, mean p set: 0.45141565799713135The modified gen p mean: 0.45126786828041077, gen p mean: -0.043172746896743774, mean p set: 0.45174819231033325
loss_pred:0.01715748757123947, decouple_loss:0.0010761196026578546
loss_pred:0.01751137711107731, decouple_loss:0.0010538907954469323
Iteration: 234, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4509143531322479, gen p mean: -0.03906591609120369, mean p set: 0.4513946771621704
loss_pred:0.0166054405272007, decouple_loss:0.0010365513153374195
The modified gen p mean: 0.4512057602405548, gen p mean: -0.0518948957324028, mean p set: 0.4516860842704773The modified gen p mean: 0.4509027600288391, gen p mean: -0.051928985863924026, mean p set: 0.4513830542564392
loss_pred:0.017573505640029907, decouple_loss:0.0012213997542858124
loss_pred:0.01638922095298767, decouple_loss:0.0010736536933109164
Iteration: 235, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45289456844329834, gen p mean: -0.04820113256573677, mean p set: 0.45337486267089844
loss_pred:0.01588844694197178, decouple_loss:0.0011594606330618262
The modified gen p mean: 0.45106038451194763, gen p mean: -0.051508668810129166, mean p set: 0.45154067873954773The modified gen p mean: 0.4508022367954254, gen p mean: -0.037893712520599365, mean p set: 0.4512825310230255
loss_pred:0.017406070604920387, decouple_loss:0.0011143771698698401
loss_pred:0.01587582752108574, decouple_loss:0.0012533190893009305
Iteration: 236, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513819217681885, gen p mean: -0.045345645397901535, mean p set: 0.4518622159957886
loss_pred:0.016530808061361313, decouple_loss:0.0010553273605182767
The modified gen p mean: 0.45209985971450806, gen p mean: -0.04185529053211212, mean p set: 0.45258012413978577The modified gen p mean: 0.4517457187175751, gen p mean: -0.04531402140855789, mean p set: 0.45222604274749756
loss_pred:0.01758825220167637, decouple_loss:0.001157349906861782
loss_pred:0.017186548560857773, decouple_loss:0.001163901761174202
Iteration: 237, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45060622692108154, gen p mean: -0.045851223170757294, mean p set: 0.45108652114868164
loss_pred:0.01779676415026188, decouple_loss:0.0010266752215102315
The modified gen p mean: 0.45139768719673157, gen p mean: -0.04533851146697998, mean p set: 0.45187801122665405The modified gen p mean: 0.45149368047714233, gen p mean: -0.050208378583192825, mean p set: 0.45197397470474243
loss_pred:0.015367208980023861, decouple_loss:0.0010625404538586736
loss_pred:0.017502691596746445, decouple_loss:0.0010831851977854967
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012004_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012004_3_24hr.npz
NaN value num: 0
Iteration: 238, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45232877135276794, gen p mean: -0.041515275835990906, mean p set: 0.45280906558036804
loss_pred:0.017188390716910362, decouple_loss:0.0011194591643288732
The modified gen p mean: 0.4518677890300751, gen p mean: -0.045666780322790146, mean p set: 0.45234808325767517The modified gen p mean: 0.4510282874107361, gen p mean: -0.044955380260944366, mean p set: 0.4515085816383362
loss_pred:0.01748901791870594, decouple_loss:0.0011202741879969835
loss_pred:0.016729621216654778, decouple_loss:0.0010655374499037862
Iteration: 239, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45227837562561035, gen p mean: -0.043351300060749054, mean p set: 0.45275866985321045
loss_pred:0.017014803364872932, decouple_loss:0.0012420862913131714
The modified gen p mean: 0.451592355966568, gen p mean: -0.043157029896974564, mean p set: 0.4520726501941681The modified gen p mean: 0.45282846689224243, gen p mean: -0.043196454644203186, mean p set: 0.45330876111984253
loss_pred:0.018246034160256386, decouple_loss:0.0011359748896211386
loss_pred:0.01647191494703293, decouple_loss:0.0010532644810155034
Iteration: 240, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4525918662548065, gen p mean: -0.039514556527137756, mean p set: 0.4530721604824066
loss_pred:0.01718158647418022, decouple_loss:0.001104820054024458
The modified gen p mean: 0.45037102699279785, gen p mean: -0.04302142933011055, mean p set: 0.45085132122039795The modified gen p mean: 0.4518062174320221, gen p mean: -0.032870590686798096, mean p set: 0.4522865414619446
loss_pred:0.01744432933628559, decouple_loss:0.0010555655462667346
loss_pred:0.016690120100975037, decouple_loss:0.0011318932520225644
2023-05-02 03:38:57 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.04564065858721733, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.041301850229501724, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.04138273373246193, mean p set: 0.4500633478164673
loss_pred:0.01849472150206566, decouple_loss:0.0010583786061033607
loss_pred:0.01743915304541588, decouple_loss:0.0011750304838642478
loss_pred:0.017533479258418083, decouple_loss:0.0011141692521050572
WV_0_PC_1_EH_0_PS_40, loss: 0.017878245562314987, avg_mse: 0.025702346116304398
current test mse: 0.025702
Iteration: 241, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4509446620941162, gen p mean: -0.028712725266814232, mean p set: 0.4514249265193939
The modified gen p mean: 0.4518401324748993, gen p mean: -0.03344332426786423, mean p set: 0.4523204565048218
The modified gen p mean: 0.45244100689888, gen p mean: -0.037559039890766144, mean p set: 0.4529213011264801
loss_pred:0.017056193202733994, decouple_loss:0.0009727163123898208
loss_pred:0.0170550849288702, decouple_loss:0.0010261423885822296
loss_pred:0.016823727637529373, decouple_loss:0.0011004552943632007
Iteration: 242, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4535503685474396, gen p mean: -0.03698263317346573, mean p set: 0.45403069257736206
The modified gen p mean: 0.45204538106918335, gen p mean: -0.03386124223470688, mean p set: 0.45252567529678345
loss_pred:0.016544794663786888, decouple_loss:0.0011655188864097
loss_pred:0.01691487245261669, decouple_loss:0.001024504890665412
The modified gen p mean: 0.4520740807056427, gen p mean: -0.031880252063274384, mean p set: 0.4525543749332428
loss_pred:0.017517391592264175, decouple_loss:0.0010253384243696928
Iteration: 243, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4515552222728729, gen p mean: -0.03317232057452202, mean p set: 0.45203545689582825
The modified gen p mean: 0.4516531229019165, gen p mean: -0.035263873636722565, mean p set: 0.4521334171295166
loss_pred:0.017970556393265724, decouple_loss:0.0010389707749709487
loss_pred:0.017062097787857056, decouple_loss:0.001077944994904101
The modified gen p mean: 0.4523482322692871, gen p mean: -0.039680950343608856, mean p set: 0.4528285562992096
loss_pred:0.017253851518034935, decouple_loss:0.0011063235579058528
Iteration: 244, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45235347747802734, gen p mean: -0.036249902099370956, mean p set: 0.45283377170562744
loss_pred:0.01687874272465706, decouple_loss:0.0010705012828111649
The modified gen p mean: 0.4523889422416687, gen p mean: -0.03875327855348587, mean p set: 0.4528692364692688The modified gen p mean: 0.4518625736236572, gen p mean: -0.03443295881152153, mean p set: 0.4523428976535797
loss_pred:0.01700083166360855, decouple_loss:0.0010904590599238873
loss_pred:0.017571384087204933, decouple_loss:0.0009256246848963201
Iteration: 245, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4517376720905304, gen p mean: -0.041036296635866165, mean p set: 0.4522179961204529
loss_pred:0.01849948987364769, decouple_loss:0.0010809632949531078
The modified gen p mean: 0.4525832533836365, gen p mean: -0.039401985704898834, mean p set: 0.4530635178089142The modified gen p mean: 0.4515679180622101, gen p mean: -0.04627520963549614, mean p set: 0.45204824209213257
loss_pred:0.01667657308280468, decouple_loss:0.0011938001262024045
loss_pred:0.016668153926730156, decouple_loss:0.0011168179335072637
Iteration: 246, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45354726910591125, gen p mean: -0.039869360625743866, mean p set: 0.45402759313583374
loss_pred:0.017086831852793694, decouple_loss:0.0010407238733023405
The modified gen p mean: 0.45173218846321106, gen p mean: -0.04568156972527504, mean p set: 0.45221248269081116The modified gen p mean: 0.45181334018707275, gen p mean: -0.03954722732305527, mean p set: 0.45229360461235046
loss_pred:0.01691417209804058, decouple_loss:0.0011093803914263844
loss_pred:0.016401607543230057, decouple_loss:0.0010804625926539302
Iteration: 247, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45097580552101135, gen p mean: -0.04660077765583992, mean p set: 0.45145612955093384
loss_pred:0.017115795984864235, decouple_loss:0.0009772542398422956
The modified gen p mean: 0.45391517877578735, gen p mean: -0.04314325004816055, mean p set: 0.45439544320106506The modified gen p mean: 0.44969916343688965, gen p mean: -0.051226984709501266, mean p set: 0.45017948746681213
loss_pred:0.01727941632270813, decouple_loss:0.0010890561388805509
loss_pred:0.015934202820062637, decouple_loss:0.0010201797122135758
Iteration: 248, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4518778324127197, gen p mean: -0.050574421882629395, mean p set: 0.4523581564426422
loss_pred:0.01663210056722164, decouple_loss:0.001105442875996232
The modified gen p mean: 0.45240339636802673, gen p mean: -0.046902965754270554, mean p set: 0.45288369059562683
The modified gen p mean: 0.45119160413742065, gen p mean: -0.04608561098575592, mean p set: 0.45167189836502075
loss_pred:0.01708359643816948, decouple_loss:0.0009632880100980401
loss_pred:0.016429584473371506, decouple_loss:0.0010463193757459521
Iteration: 249, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45139169692993164, gen p mean: -0.04911859333515167, mean p set: 0.4518720209598541
loss_pred:0.01743389293551445, decouple_loss:0.0009592748247087002
The modified gen p mean: 0.45107153058052063, gen p mean: -0.04561850056052208, mean p set: 0.4515518248081207The modified gen p mean: 0.4513051211833954, gen p mean: -0.04316192492842674, mean p set: 0.45178544521331787
loss_pred:0.01665685512125492, decouple_loss:0.0009744575945660472
loss_pred:0.017367957159876823, decouple_loss:0.0010281929280608892
Iteration: 250, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45200252532958984, gen p mean: -0.05493113026022911, mean p set: 0.45248281955718994
loss_pred:0.01712380349636078, decouple_loss:0.0010531935840845108
The modified gen p mean: 0.45025843381881714, gen p mean: -0.0557963028550148, mean p set: 0.45073869824409485The modified gen p mean: 0.4523914158344269, gen p mean: -0.047320589423179626, mean p set: 0.452871710062027
loss_pred:0.016732295975089073, decouple_loss:0.0011914308415725827
loss_pred:0.016884874552488327, decouple_loss:0.0010510616702958941
2023-05-02 03:40:53 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.05791780725121498, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.053117647767066956, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.053590431809425354, mean p set: 0.4500633478164673
loss_pred:0.018441732972860336, decouple_loss:0.001153480145148933
loss_pred:0.017339525744318962, decouple_loss:0.0011620279401540756
loss_pred:0.01746639795601368, decouple_loss:0.0011724396608769894
WV_0_PC_1_EH_0_PS_40, loss: 0.01780734956264496, avg_mse: 0.025578079745173454
current test mse: 0.025578
Iteration: 251, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45355916023254395, gen p mean: -0.04684944823384285, mean p set: 0.45403948426246643
The modified gen p mean: 0.4534086585044861, gen p mean: -0.050112951546907425, mean p set: 0.4538889527320862
The modified gen p mean: 0.45184358954429626, gen p mean: -0.044609252363443375, mean p set: 0.45232388377189636
loss_pred:0.016927434131503105, decouple_loss:0.0010317735141143203
loss_pred:0.016444094479084015, decouple_loss:0.0010650074109435081loss_pred:0.016137531027197838, decouple_loss:0.0010287394979968667
Iteration: 252, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45415034890174866, gen p mean: -0.045807842165231705, mean p set: 0.45463061332702637
loss_pred:0.016579527407884598, decouple_loss:0.0009784535504877567
The modified gen p mean: 0.45387494564056396, gen p mean: -0.044185612350702286, mean p set: 0.45435523986816406The modified gen p mean: 0.4531554579734802, gen p mean: -0.04591354727745056, mean p set: 0.4536357522010803
loss_pred:0.016744103282690048, decouple_loss:0.001021642703562975
loss_pred:0.017149925231933594, decouple_loss:0.0009642272489145398
Iteration: 253, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513547122478485, gen p mean: -0.04660872370004654, mean p set: 0.4518350064754486
loss_pred:0.01679505594074726, decouple_loss:0.0012594208819791675
The modified gen p mean: 0.4525035321712494, gen p mean: -0.053453173488378525, mean p set: 0.4529838562011719The modified gen p mean: 0.4515188932418823, gen p mean: -0.041545506566762924, mean p set: 0.4519991874694824
loss_pred:0.01632857136428356, decouple_loss:0.0012554238783195615
loss_pred:0.01718566007912159, decouple_loss:0.0012057095300406218
Iteration: 254, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.452921062707901, gen p mean: -0.05188325047492981, mean p set: 0.4534013867378235
loss_pred:0.016206659376621246, decouple_loss:0.0011695688590407372
The modified gen p mean: 0.45087969303131104, gen p mean: -0.04915200173854828, mean p set: 0.45135995745658875The modified gen p mean: 0.45356109738349915, gen p mean: -0.04570934921503067, mean p set: 0.45404139161109924
loss_pred:0.016986194998025894, decouple_loss:0.001042366842739284
loss_pred:0.016553880646824837, decouple_loss:0.001124722883105278
Iteration: 255, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4512805640697479, gen p mean: -0.0514339879155159, mean p set: 0.45176082849502563
loss_pred:0.01629849523305893, decouple_loss:0.0012210694840177894
The modified gen p mean: 0.45161670446395874, gen p mean: -0.04681338369846344, mean p set: 0.45209699869155884The modified gen p mean: 0.4516083300113678, gen p mean: -0.05026105046272278, mean p set: 0.4520886242389679
loss_pred:0.01848594844341278, decouple_loss:0.0010842891642823815
loss_pred:0.018231192603707314, decouple_loss:0.0011471137404441833
Iteration: 256, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45169565081596375, gen p mean: -0.04172713682055473, mean p set: 0.45217597484588623
loss_pred:0.01760057546198368, decouple_loss:0.0010586269199848175
The modified gen p mean: 0.4517289102077484, gen p mean: -0.05035428702831268, mean p set: 0.4522091746330261The modified gen p mean: 0.4515969753265381, gen p mean: -0.047593433409929276, mean p set: 0.45207729935646057
loss_pred:0.018213799223303795, decouple_loss:0.0011494103819131851
loss_pred:0.01730235293507576, decouple_loss:0.0011117125395685434
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012004_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012004_3_24hr.npz
NaN value num: 0
Iteration: 257, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498940706253052, gen p mean: -0.048926934599876404, mean p set: 0.45037439465522766
loss_pred:0.016312044113874435, decouple_loss:0.0010830677347257733
The modified gen p mean: 0.4505697786808014, gen p mean: -0.048305001109838486, mean p set: 0.4510500431060791The modified gen p mean: 0.4511455297470093, gen p mean: -0.04585719108581543, mean p set: 0.451625794172287
loss_pred:0.015754252672195435, decouple_loss:0.0010083835804834962
loss_pred:0.016843559220433235, decouple_loss:0.0011687350925058126
Iteration: 258, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45040133595466614, gen p mean: -0.04682450369000435, mean p set: 0.4508816599845886
loss_pred:0.015723124146461487, decouple_loss:0.0011740789050236344
The modified gen p mean: 0.44915157556533813, gen p mean: -0.05208997800946236, mean p set: 0.44963186979293823The modified gen p mean: 0.4512999355792999, gen p mean: -0.05425921082496643, mean p set: 0.4517802298069
loss_pred:0.01785275712609291, decouple_loss:0.0012507683131843805
loss_pred:0.016348084434866905, decouple_loss:0.0012356146471574903
Iteration: 259, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45012643933296204, gen p mean: -0.05136643350124359, mean p set: 0.45060670375823975
loss_pred:0.01675858348608017, decouple_loss:0.0011333116563037038
The modified gen p mean: 0.45160409808158875, gen p mean: -0.05537394434213638, mean p set: 0.45208439230918884The modified gen p mean: 0.4489753246307373, gen p mean: -0.04911179095506668, mean p set: 0.4494556486606598
loss_pred:0.016281526535749435, decouple_loss:0.0011874849442392588
loss_pred:0.016274800524115562, decouple_loss:0.0010435046860948205
Iteration: 260, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4512156546115875, gen p mean: -0.04293425381183624, mean p set: 0.4516959488391876
loss_pred:0.01620253175497055, decouple_loss:0.0011739678448066115
The modified gen p mean: 0.4502315819263458, gen p mean: -0.04927828907966614, mean p set: 0.4507118761539459The modified gen p mean: 0.4519050121307373, gen p mean: -0.05090875178575516, mean p set: 0.4523853361606598
loss_pred:0.01647190935909748, decouple_loss:0.0011968397302553058
loss_pred:0.016263695433735847, decouple_loss:0.0012047714553773403
2023-05-02 03:43:24 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.05820402875542641, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.05355405807495117, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.05367607995867729, mean p set: 0.4500633478164673
loss_pred:0.01841766946017742, decouple_loss:0.001238366705365479
loss_pred:0.017364732921123505, decouple_loss:0.001184983761049807
loss_pred:0.01742536947131157, decouple_loss:0.0011493159690871835
WV_0_PC_1_EH_0_PS_40, loss: 0.017795469611883163, avg_mse: 0.025531651452183723
current test mse: 0.025532
Iteration: 261, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499926269054413, gen p mean: -0.05594419687986374, mean p set: 0.4504729211330414
The modified gen p mean: 0.44884514808654785, gen p mean: -0.057184044271707535, mean p set: 0.44932547211647034
The modified gen p mean: 0.45189952850341797, gen p mean: -0.04473941773176193, mean p set: 0.4523797929286957
loss_pred:0.016308411955833435, decouple_loss:0.001120570581406355
loss_pred:0.01620456948876381, decouple_loss:0.0010894756997004151loss_pred:0.01635819673538208, decouple_loss:0.0010927118128165603
Iteration: 262, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513068199157715, gen p mean: -0.05428418517112732, mean p set: 0.4517871141433716
The modified gen p mean: 0.4513562023639679, gen p mean: -0.04647866636514664, mean p set: 0.4518364667892456
loss_pred:0.016142530366778374, decouple_loss:0.0010867000091820955
loss_pred:0.016219088807702065, decouple_loss:0.0010325643233954906
The modified gen p mean: 0.4502876102924347, gen p mean: -0.05290507525205612, mean p set: 0.4507678747177124
loss_pred:0.01576409861445427, decouple_loss:0.0010303157614544034
Iteration: 263, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4510978162288666, gen p mean: -0.05453198775649071, mean p set: 0.4515781104564667
loss_pred:0.015421981923282146, decouple_loss:0.001115518040023744
The modified gen p mean: 0.4515685737133026, gen p mean: -0.05482260510325432, mean p set: 0.4520488977432251The modified gen p mean: 0.4497564733028412, gen p mean: -0.05625573918223381, mean p set: 0.45023679733276367
loss_pred:0.016319509595632553, decouple_loss:0.0011962554417550564
loss_pred:0.015780659392476082, decouple_loss:0.0010331847006455064
Iteration: 264, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44896626472473145, gen p mean: -0.05521560460329056, mean p set: 0.44944655895233154
loss_pred:0.015625352039933205, decouple_loss:0.0010668912436813116
The modified gen p mean: 0.45094335079193115, gen p mean: -0.058942362666130066, mean p set: 0.45142364501953125The modified gen p mean: 0.45169833302497864, gen p mean: -0.053185511380434036, mean p set: 0.4521786570549011
loss_pred:0.015339693054556847, decouple_loss:0.0011278273304924369
loss_pred:0.01635582000017166, decouple_loss:0.0011044093407690525
Iteration: 265, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507538080215454, gen p mean: -0.05860496312379837, mean p set: 0.4512340724468231
loss_pred:0.016998108476400375, decouple_loss:0.0010616600047796965
The modified gen p mean: 0.4501567482948303, gen p mean: -0.06111753731966019, mean p set: 0.4506370425224304The modified gen p mean: 0.4513264298439026, gen p mean: -0.05200621113181114, mean p set: 0.4518067240715027
loss_pred:0.015369761735200882, decouple_loss:0.0010227508610114455
loss_pred:0.017932314425706863, decouple_loss:0.0011899066157639027
Iteration: 266, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44992178678512573, gen p mean: -0.057135701179504395, mean p set: 0.4504021108150482
loss_pred:0.016949675977230072, decouple_loss:0.0011033794144168496
The modified gen p mean: 0.45132601261138916, gen p mean: -0.056430522352457047, mean p set: 0.45180633664131165The modified gen p mean: 0.4523080885410309, gen p mean: -0.05612568557262421, mean p set: 0.452788382768631
loss_pred:0.016687046736478806, decouple_loss:0.001051541417837143
loss_pred:0.01592126116156578, decouple_loss:0.001030638930387795
Iteration: 267, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44930869340896606, gen p mean: -0.05259448662400246, mean p set: 0.44978898763656616
loss_pred:0.01577446050941944, decouple_loss:0.0010779129806905985
The modified gen p mean: 0.4498480260372162, gen p mean: -0.05015373229980469, mean p set: 0.4503283202648163The modified gen p mean: 0.4498899281024933, gen p mean: -0.051951002329587936, mean p set: 0.45037025213241577
loss_pred:0.01647643744945526, decouple_loss:0.0012646578252315521
loss_pred:0.015465851873159409, decouple_loss:0.0012764985440298915
Iteration: 268, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4523484706878662, gen p mean: -0.05061013996601105, mean p set: 0.4528287649154663
loss_pred:0.015840869396924973, decouple_loss:0.0010961543302983046
The modified gen p mean: 0.4510286748409271, gen p mean: -0.053458768874406815, mean p set: 0.4515089690685272The modified gen p mean: 0.44933953881263733, gen p mean: -0.054148029536008835, mean p set: 0.4498198330402374
loss_pred:0.016239527612924576, decouple_loss:0.0011957923416048288
loss_pred:0.016413161531090736, decouple_loss:0.0011441598180681467
Iteration: 269, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45169180631637573, gen p mean: -0.05142250284552574, mean p set: 0.45217210054397583
The modified gen p mean: 0.44841814041137695, gen p mean: -0.051682814955711365, mean p set: 0.44889846444129944
loss_pred:0.016033697873353958, decouple_loss:0.0013262350112199783
loss_pred:0.017523551359772682, decouple_loss:0.001354892156086862
The modified gen p mean: 0.4504311978816986, gen p mean: -0.04137125611305237, mean p set: 0.4509114921092987
loss_pred:0.015566756017506123, decouple_loss:0.0013171662576496601
Iteration: 270, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4519164264202118, gen p mean: -0.04354819655418396, mean p set: 0.4523966908454895
The modified gen p mean: 0.4495828449726105, gen p mean: -0.05162966996431351, mean p set: 0.45006316900253296
loss_pred:0.015484729781746864, decouple_loss:0.001212665461935103
loss_pred:0.016134461387991905, decouple_loss:0.0011698692105710506
The modified gen p mean: 0.45046737790107727, gen p mean: -0.053909849375486374, mean p set: 0.45094767212867737
loss_pred:0.017453711479902267, decouple_loss:0.0013476917520165443
2023-05-02 03:45:19 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.054120760411024094, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.049418121576309204, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04934457689523697, mean p set: 0.4500633478164673
loss_pred:0.0184919536113739, decouple_loss:0.0013467310927808285
loss_pred:0.01746477745473385, decouple_loss:0.0014535426162183285
loss_pred:0.01746361143887043, decouple_loss:0.001370094483718276
WV_0_PC_1_EH_0_PS_40, loss: 0.017876287922263145, avg_mse: 0.025679197162389755
current test mse: 0.025679
Iteration: 271, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44880664348602295, gen p mean: -0.0468478798866272, mean p set: 0.44928696751594543
The modified gen p mean: 0.45008283853530884, gen p mean: -0.045883309096097946, mean p set: 0.4505631625652313
The modified gen p mean: 0.4493047595024109, gen p mean: -0.05410853773355484, mean p set: 0.449785053730011
loss_pred:0.015890581533312798, decouple_loss:0.0013831863179802895
loss_pred:0.015265414491295815, decouple_loss:0.001181060099042952loss_pred:0.015638696029782295, decouple_loss:0.001378495479002595
Iteration: 272, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4519311189651489, gen p mean: -0.05139308050274849, mean p set: 0.452411413192749
loss_pred:0.0159764401614666, decouple_loss:0.0013427664525806904
The modified gen p mean: 0.45015203952789307, gen p mean: -0.049731235951185226, mean p set: 0.4506323039531708The modified gen p mean: 0.45001593232154846, gen p mean: -0.04850100353360176, mean p set: 0.45049622654914856
loss_pred:0.016582906246185303, decouple_loss:0.0011136409593746066
loss_pred:0.016927093267440796, decouple_loss:0.0012288835132494569
Iteration: 273, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449628621339798, gen p mean: -0.04837604612112045, mean p set: 0.45010891556739807
loss_pred:0.01629684492945671, decouple_loss:0.0015849592164158821
The modified gen p mean: 0.450145959854126, gen p mean: -0.04138381779193878, mean p set: 0.4506262540817261The modified gen p mean: 0.4487839937210083, gen p mean: -0.050211235880851746, mean p set: 0.4492642879486084
loss_pred:0.016110332682728767, decouple_loss:0.0015187935205176473
loss_pred:0.015376568771898746, decouple_loss:0.0014683482004329562
Iteration: 274, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514380693435669, gen p mean: -0.0456094965338707, mean p set: 0.4519183933734894
loss_pred:0.015158598311245441, decouple_loss:0.0011920237448066473
The modified gen p mean: 0.45228272676467896, gen p mean: -0.04957819730043411, mean p set: 0.45276302099227905The modified gen p mean: 0.4513000547885895, gen p mean: -0.05088954046368599, mean p set: 0.4517803192138672
loss_pred:0.016052905470132828, decouple_loss:0.0012834168737754226
loss_pred:0.016879519447684288, decouple_loss:0.0011942296987399459
Iteration: 275, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45040568709373474, gen p mean: -0.04773404449224472, mean p set: 0.4508860111236572
loss_pred:0.016000190749764442, decouple_loss:0.0013492177240550518
The modified gen p mean: 0.45013299584388733, gen p mean: -0.053285758942365646, mean p set: 0.4506132900714874The modified gen p mean: 0.4499150216579437, gen p mean: -0.055162061005830765, mean p set: 0.4503953158855438
loss_pred:0.0160824041813612, decouple_loss:0.001399179338477552
loss_pred:0.016335608437657356, decouple_loss:0.0013367022620514035
Iteration: 276, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44856712222099304, gen p mean: -0.052323561161756516, mean p set: 0.44904741644859314
loss_pred:0.01753569021821022, decouple_loss:0.0014419377548620105
The modified gen p mean: 0.4495391845703125, gen p mean: -0.053443994373083115, mean p set: 0.4500194787979126The modified gen p mean: 0.4497143030166626, gen p mean: -0.04997967928647995, mean p set: 0.4501945972442627
loss_pred:0.015641212463378906, decouple_loss:0.001174097298644483
loss_pred:0.01636800542473793, decouple_loss:0.0012118974700570107
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012000_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012000_3_24hr.npz
NaN value num: 0
Iteration: 277, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44937461614608765, gen p mean: -0.0469079352915287, mean p set: 0.44985491037368774
loss_pred:0.014311609789729118, decouple_loss:0.0012956669088453054
The modified gen p mean: 0.44705814123153687, gen p mean: -0.050318412482738495, mean p set: 0.44753846526145935The modified gen p mean: 0.4474874436855316, gen p mean: -0.05183926224708557, mean p set: 0.4479677379131317
loss_pred:0.014216586016118526, decouple_loss:0.0013545072870329022
loss_pred:0.013506518676877022, decouple_loss:0.001489797723479569
Iteration: 278, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491988718509674, gen p mean: -0.052976544946432114, mean p set: 0.4496791362762451
loss_pred:0.01386637706309557, decouple_loss:0.0011532644275575876
The modified gen p mean: 0.4482777416706085, gen p mean: -0.05148009955883026, mean p set: 0.4487580358982086The modified gen p mean: 0.4461825489997864, gen p mean: -0.05131594091653824, mean p set: 0.4466628134250641
loss_pred:0.014359585009515285, decouple_loss:0.001183540909551084
loss_pred:0.013100658543407917, decouple_loss:0.0012780630495399237
Iteration: 279, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44704607129096985, gen p mean: -0.05389232188463211, mean p set: 0.44752633571624756
loss_pred:0.012983026914298534, decouple_loss:0.0013779718428850174
The modified gen p mean: 0.4472803473472595, gen p mean: -0.05070528760552406, mean p set: 0.447760671377182The modified gen p mean: 0.44736942648887634, gen p mean: -0.04674719274044037, mean p set: 0.44784975051879883
loss_pred:0.013891424983739853, decouple_loss:0.0013355916598811746
loss_pred:0.013272296637296677, decouple_loss:0.0014244618359953165
Iteration: 280, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44775640964508057, gen p mean: -0.04841864854097366, mean p set: 0.44823670387268066
loss_pred:0.013647781684994698, decouple_loss:0.0012882496230304241
The modified gen p mean: 0.4485984742641449, gen p mean: -0.05261331796646118, mean p set: 0.449078768491745The modified gen p mean: 0.4482394754886627, gen p mean: -0.0541737861931324, mean p set: 0.4487197697162628
loss_pred:0.013473926112055779, decouple_loss:0.0011895435163751245
loss_pred:0.01359502412378788, decouple_loss:0.0013340647565200925
2023-05-02 03:47:51 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.05763630568981171, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.05284170061349869, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.05268508568406105, mean p set: 0.4500633478164673
loss_pred:0.018865464255213737, decouple_loss:0.0015589537797495723
loss_pred:0.0177992545068264, decouple_loss:0.001390926307067275
loss_pred:0.017763596028089523, decouple_loss:0.0014841054799035192
WV_0_PC_1_EH_0_PS_40, loss: 0.018216673284769058, avg_mse: 0.026344558224081993
current test mse: 0.026345
Iteration: 281, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44693154096603394, gen p mean: -0.05835097283124924, mean p set: 0.44741183519363403
The modified gen p mean: 0.4471632242202759, gen p mean: -0.05394168570637703, mean p set: 0.4476434886455536
The modified gen p mean: 0.4482327103614807, gen p mean: -0.05673675239086151, mean p set: 0.4487130343914032
loss_pred:0.013196729123592377, decouple_loss:0.0015045104082673788
loss_pred:0.013329767622053623, decouple_loss:0.0014256149297580123
loss_pred:0.01335381530225277, decouple_loss:0.0014802467776462436
Iteration: 282, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44793716073036194, gen p mean: -0.046980638056993484, mean p set: 0.44841745495796204
loss_pred:0.013127118349075317, decouple_loss:0.0012592057464644313
The modified gen p mean: 0.44921791553497314, gen p mean: -0.049671921879053116, mean p set: 0.44969815015792847The modified gen p mean: 0.4472601115703583, gen p mean: -0.051662150770425797, mean p set: 0.4477404057979584
loss_pred:0.01357176061719656, decouple_loss:0.001179385231807828
loss_pred:0.013266501948237419, decouple_loss:0.0014889026060700417
Iteration: 283, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481850862503052, gen p mean: -0.05635744705796242, mean p set: 0.44866541028022766
The modified gen p mean: 0.4468691051006317, gen p mean: -0.06037494167685509, mean p set: 0.4473493695259094
loss_pred:0.013415414839982986, decouple_loss:0.0015075750416144729
loss_pred:0.01331817265599966, decouple_loss:0.001600269228219986
The modified gen p mean: 0.4488963186740875, gen p mean: -0.052416618913412094, mean p set: 0.4493766129016876
loss_pred:0.01361829787492752, decouple_loss:0.001603785902261734
Iteration: 284, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449720174074173, gen p mean: -0.05161352828145027, mean p set: 0.45020049810409546
loss_pred:0.013495264574885368, decouple_loss:0.001352486084215343
The modified gen p mean: 0.4474087357521057, gen p mean: -0.05204004794359207, mean p set: 0.4478890001773834The modified gen p mean: 0.44783085584640503, gen p mean: -0.05161134898662567, mean p set: 0.4483111500740051
loss_pred:0.013432493433356285, decouple_loss:0.0013790992088615894
loss_pred:0.013810704462230206, decouple_loss:0.0014463814441114664
Iteration: 285, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492894113063812, gen p mean: -0.046351704746484756, mean p set: 0.44976967573165894
loss_pred:0.013428835198283195, decouple_loss:0.0014900964451953769
The modified gen p mean: 0.44750961661338806, gen p mean: -0.05264405161142349, mean p set: 0.44798991084098816The modified gen p mean: 0.4487685561180115, gen p mean: -0.05239300802350044, mean p set: 0.44924888014793396
loss_pred:0.012546848505735397, decouple_loss:0.0015763365663588047
loss_pred:0.013179310597479343, decouple_loss:0.0015193247236311436
Iteration: 286, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471953809261322, gen p mean: -0.05122865363955498, mean p set: 0.4476757347583771
loss_pred:0.013068445026874542, decouple_loss:0.001311508589424193
The modified gen p mean: 0.4488517940044403, gen p mean: -0.05060318857431412, mean p set: 0.4493320882320404The modified gen p mean: 0.44830477237701416, gen p mean: -0.04968860745429993, mean p set: 0.44878509640693665
loss_pred:0.013109552673995495, decouple_loss:0.0013997964560985565
loss_pred:0.012887410819530487, decouple_loss:0.0012705943081527948
Iteration: 287, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464573562145233, gen p mean: -0.049858350306749344, mean p set: 0.4469376802444458
loss_pred:0.013535642996430397, decouple_loss:0.0016302622389048338
The modified gen p mean: 0.4488774240016937, gen p mean: -0.05458010733127594, mean p set: 0.4493577182292938The modified gen p mean: 0.4501919448375702, gen p mean: -0.043729521334171295, mean p set: 0.4506722390651703
loss_pred:0.01254568062722683, decouple_loss:0.0017913453048095107
loss_pred:0.013743512332439423, decouple_loss:0.0014908351004123688
Iteration: 288, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487161636352539, gen p mean: -0.05328823998570442, mean p set: 0.4491964280605316
loss_pred:0.01259523257613182, decouple_loss:0.001371530699543655
The modified gen p mean: 0.44876593351364136, gen p mean: -0.045197781175374985, mean p set: 0.44924619793891907The modified gen p mean: 0.44902482628822327, gen p mean: -0.04672347754240036, mean p set: 0.44950512051582336
loss_pred:0.013014005497097969, decouple_loss:0.0013685307931154966
loss_pred:0.013614952564239502, decouple_loss:0.0013462972128763795
Iteration: 289, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473118782043457, gen p mean: -0.05091898888349533, mean p set: 0.4477921724319458
loss_pred:0.012964565306901932, decouple_loss:0.0018190370174124837
The modified gen p mean: 0.4484160542488098, gen p mean: -0.04732904210686684, mean p set: 0.4488963484764099The modified gen p mean: 0.4473854601383209, gen p mean: -0.04991577938199043, mean p set: 0.44786572456359863
loss_pred:0.012867598794400692, decouple_loss:0.0015371389454230666
loss_pred:0.012822934426367283, decouple_loss:0.0018754755146801472
Iteration: 290, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44923028349876404, gen p mean: -0.05346311628818512, mean p set: 0.4497106075286865
loss_pred:0.01317325048148632, decouple_loss:0.001250583678483963
The modified gen p mean: 0.447660356760025, gen p mean: -0.048352327197790146, mean p set: 0.4481406807899475The modified gen p mean: 0.4478943645954132, gen p mean: -0.04870704188942909, mean p set: 0.4483746588230133
loss_pred:0.01303874608129263, decouple_loss:0.0015776139916852117
loss_pred:0.013077044859528542, decouple_loss:0.0016056213062256575
2023-05-02 03:49:44 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.05350186303257942, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04909060522913933, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.048715971410274506, mean p set: 0.4500633478164673
loss_pred:0.019188886508345604, decouple_loss:0.0013582169776782393
loss_pred:0.018063461408019066, decouple_loss:0.0015235149767249823
loss_pred:0.01800885610282421, decouple_loss:0.0013312224764376879
WV_0_PC_1_EH_0_PS_40, loss: 0.018490618094801903, avg_mse: 0.026903215795755386
current test mse: 0.026903
Iteration: 291, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480293095111847, gen p mean: -0.04824983701109886, mean p set: 0.4485096037387848
The modified gen p mean: 0.44794392585754395, gen p mean: -0.049248870462179184, mean p set: 0.44842419028282166
The modified gen p mean: 0.4493301808834076, gen p mean: -0.045311372727155685, mean p set: 0.4498105049133301
loss_pred:0.013002113439142704, decouple_loss:0.0014717949088662863
loss_pred:0.01314603816717863, decouple_loss:0.0014644789043813944
loss_pred:0.013232138939201832, decouple_loss:0.0014984328299760818
Iteration: 292, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488295614719391, gen p mean: -0.05442039296030998, mean p set: 0.4493098258972168
The modified gen p mean: 0.4490028917789459, gen p mean: -0.04812845215201378, mean p set: 0.44948315620422363
loss_pred:0.012506651692092419, decouple_loss:0.0013005919754505157
loss_pred:0.013133152388036251, decouple_loss:0.001298028277233243
The modified gen p mean: 0.4460190236568451, gen p mean: -0.04981556162238121, mean p set: 0.4464992880821228
loss_pred:0.013402416370809078, decouple_loss:0.0014955101069062948
Iteration: 293, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500364661216736, gen p mean: -0.04631095007061958, mean p set: 0.4505167305469513
The modified gen p mean: 0.4491006135940552, gen p mean: -0.04698072373867035, mean p set: 0.4495809078216553
loss_pred:0.013647941872477531, decouple_loss:0.001230374677106738
loss_pred:0.013319525867700577, decouple_loss:0.0011759797343984246
The modified gen p mean: 0.44790494441986084, gen p mean: -0.04573936015367508, mean p set: 0.44838523864746094
loss_pred:0.013456148095428944, decouple_loss:0.0013857634039595723
Iteration: 294, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473456144332886, gen p mean: -0.045714396983385086, mean p set: 0.44782590866088867
loss_pred:0.013355945236980915, decouple_loss:0.001252389862202108
The modified gen p mean: 0.4476581811904907, gen p mean: -0.04851486533880234, mean p set: 0.4481384754180908The modified gen p mean: 0.44693103432655334, gen p mean: -0.04978404566645622, mean p set: 0.44741132855415344
loss_pred:0.012457054108381271, decouple_loss:0.0013592977775260806
loss_pred:0.013261754997074604, decouple_loss:0.001584210665896535
Iteration: 295, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44831985235214233, gen p mean: -0.052756454795598984, mean p set: 0.44880014657974243
loss_pred:0.01256385538727045, decouple_loss:0.0013640002580359578
The modified gen p mean: 0.44661128520965576, gen p mean: -0.050939757376909256, mean p set: 0.44709157943725586The modified gen p mean: 0.4481538236141205, gen p mean: -0.052327536046504974, mean p set: 0.44863414764404297
loss_pred:0.012828017584979534, decouple_loss:0.001506002270616591
loss_pred:0.012726319022476673, decouple_loss:0.0013776215491816401
Iteration: 296, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464013874530792, gen p mean: -0.04402081295847893, mean p set: 0.4468816816806793
The modified gen p mean: 0.44701385498046875, gen p mean: -0.044861260801553726, mean p set: 0.44749414920806885
loss_pred:0.01317692082375288, decouple_loss:0.0014572764048352838
The modified gen p mean: 0.44858017563819885, gen p mean: -0.041903432458639145, mean p set: 0.44906049966812134loss_pred:0.012997252866625786, decouple_loss:0.0016107783885672688
loss_pred:0.013120044022798538, decouple_loss:0.0013664583675563335
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012002_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012002_3_24hr.npz
NaN value num: 0
Iteration: 297, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45049548149108887, gen p mean: -0.03867246210575104, mean p set: 0.45097577571868896
loss_pred:0.017013151198625565, decouple_loss:0.0015031556831672788
The modified gen p mean: 0.44835230708122253, gen p mean: -0.04262448847293854, mean p set: 0.448832631111145The modified gen p mean: 0.45126938819885254, gen p mean: -0.046243488788604736, mean p set: 0.45174965262413025
loss_pred:0.016462910920381546, decouple_loss:0.0013700645649805665
loss_pred:0.017508961260318756, decouple_loss:0.001576435985043645
Iteration: 298, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44874173402786255, gen p mean: -0.031673479825258255, mean p set: 0.44922199845314026
loss_pred:0.018094195052981377, decouple_loss:0.0012374744983389974
The modified gen p mean: 0.45023903250694275, gen p mean: -0.03921746462583542, mean p set: 0.45071932673454285The modified gen p mean: 0.448119193315506, gen p mean: -0.037164051085710526, mean p set: 0.4485994875431061
loss_pred:0.016805320978164673, decouple_loss:0.001290950458496809
loss_pred:0.017035428434610367, decouple_loss:0.0012558514717966318
Iteration: 299, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4510021209716797, gen p mean: -0.04299342259764671, mean p set: 0.4514824450016022
loss_pred:0.016392121091485023, decouple_loss:0.0013615057105198503
The modified gen p mean: 0.44946759939193726, gen p mean: -0.034592319279909134, mean p set: 0.44994789361953735The modified gen p mean: 0.45099693536758423, gen p mean: -0.037970274686813354, mean p set: 0.4514772295951843
loss_pred:0.01795608550310135, decouple_loss:0.0014244100311771035
loss_pred:0.016394034028053284, decouple_loss:0.0013731324579566717
Iteration: 300, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503400921821594, gen p mean: -0.040828216820955276, mean p set: 0.4508203864097595
loss_pred:0.016609709709882736, decouple_loss:0.0014225093182176352
The modified gen p mean: 0.4493979215621948, gen p mean: -0.03881852701306343, mean p set: 0.44987818598747253The modified gen p mean: 0.4519505202770233, gen p mean: -0.04042549431324005, mean p set: 0.4524308443069458
loss_pred:0.017319153994321823, decouple_loss:0.0015823736321181059
loss_pred:0.016590474173426628, decouple_loss:0.0014673506375402212
2023-05-02 03:52:14 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.05318319424986839, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04874998703598976, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04896383360028267, mean p set: 0.45035696029663086
loss_pred:0.018671533092856407, decouple_loss:0.0014869080623611808
loss_pred:0.017581501975655556, decouple_loss:0.001307570724748075loss_pred:0.017656007781624794, decouple_loss:0.0013370985398069024
WV_0_PC_1_EH_0_PS_40, loss: 0.018038541078567505, avg_mse: 0.02593243308365345
current test mse: 0.025932
Iteration: 301, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511899948120117, gen p mean: -0.04800237715244293, mean p set: 0.4516703188419342
The modified gen p mean: 0.45023593306541443, gen p mean: -0.039230018854141235, mean p set: 0.4507162272930145
The modified gen p mean: 0.4511793255805969, gen p mean: -0.04615151509642601, mean p set: 0.451659619808197
loss_pred:0.016017427667975426, decouple_loss:0.0013288643676787615
loss_pred:0.017471332103013992, decouple_loss:0.0013909114059060812
loss_pred:0.016281822696328163, decouple_loss:0.0012112086405977607
Iteration: 302, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513176381587982, gen p mean: -0.04388098418712616, mean p set: 0.4517979323863983
loss_pred:0.015583892352879047, decouple_loss:0.0012179880868643522
The modified gen p mean: 0.4506933093070984, gen p mean: -0.046412818133831024, mean p set: 0.4511736333370209The modified gen p mean: 0.4506831169128418, gen p mean: -0.0420597605407238, mean p set: 0.4511634409427643
loss_pred:0.016330722719430923, decouple_loss:0.0013499143533408642
loss_pred:0.01664813980460167, decouple_loss:0.0012951693497598171
Iteration: 303, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45018303394317627, gen p mean: -0.048822369426488876, mean p set: 0.450663298368454
loss_pred:0.01710035279393196, decouple_loss:0.0012172770220786333
The modified gen p mean: 0.448144793510437, gen p mean: -0.04360123351216316, mean p set: 0.4486250877380371The modified gen p mean: 0.450381875038147, gen p mean: -0.04742646589875221, mean p set: 0.45086219906806946
loss_pred:0.016997339203953743, decouple_loss:0.0012904288014397025
loss_pred:0.016909386962652206, decouple_loss:0.0012711042072623968
Iteration: 304, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45046085119247437, gen p mean: -0.042353708297014236, mean p set: 0.45094114542007446
loss_pred:0.016082940623164177, decouple_loss:0.0013545070542022586
The modified gen p mean: 0.45115718245506287, gen p mean: -0.047677189111709595, mean p set: 0.45163747668266296The modified gen p mean: 0.45141905546188354, gen p mean: -0.046171050518751144, mean p set: 0.45189934968948364
loss_pred:0.015829652547836304, decouple_loss:0.001370139536447823
loss_pred:0.015668030828237534, decouple_loss:0.0013800566084682941
Iteration: 305, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450458288192749, gen p mean: -0.04289352148771286, mean p set: 0.4509385824203491
loss_pred:0.016485288739204407, decouple_loss:0.001231778529472649
The modified gen p mean: 0.4481845796108246, gen p mean: -0.037047453224658966, mean p set: 0.4486648738384247The modified gen p mean: 0.4508376717567444, gen p mean: -0.040558602660894394, mean p set: 0.4513179361820221
loss_pred:0.017292341217398643, decouple_loss:0.0011461263056844473
loss_pred:0.015620322898030281, decouple_loss:0.001247120788320899
Iteration: 306, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507354199886322, gen p mean: -0.044625528156757355, mean p set: 0.4512156844139099
loss_pred:0.01601451076567173, decouple_loss:0.0012379150139167905
The modified gen p mean: 0.4498558044433594, gen p mean: -0.040998511016368866, mean p set: 0.4503360688686371The modified gen p mean: 0.45038577914237976, gen p mean: -0.04594726487994194, mean p set: 0.45086607336997986
loss_pred:0.01716231368482113, decouple_loss:0.0012625801609829068
loss_pred:0.016834227368235588, decouple_loss:0.0012109354138374329
Iteration: 307, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498421251773834, gen p mean: -0.04936475679278374, mean p set: 0.45032238960266113
loss_pred:0.016823098063468933, decouple_loss:0.0014351729769259691
The modified gen p mean: 0.44900110363960266, gen p mean: -0.04258959740400314, mean p set: 0.44948139786720276The modified gen p mean: 0.45125365257263184, gen p mean: -0.04800110682845116, mean p set: 0.45173394680023193
loss_pred:0.016104254871606827, decouple_loss:0.0013164287665858865
loss_pred:0.01691560633480549, decouple_loss:0.001524209277704358
Iteration: 308, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45114797353744507, gen p mean: -0.05059616640210152, mean p set: 0.45162826776504517
loss_pred:0.015410929918289185, decouple_loss:0.0011079664109274745
The modified gen p mean: 0.4519405663013458, gen p mean: -0.052510425448417664, mean p set: 0.4524208605289459The modified gen p mean: 0.4484885632991791, gen p mean: -0.03960739076137543, mean p set: 0.4489688575267792
loss_pred:0.017045363783836365, decouple_loss:0.0012288327561691403
loss_pred:0.01753661036491394, decouple_loss:0.001147664850577712
Iteration: 309, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45053473114967346, gen p mean: -0.05384393781423569, mean p set: 0.45101502537727356
loss_pred:0.01617978699505329, decouple_loss:0.0012981139589101076
The modified gen p mean: 0.4514671266078949, gen p mean: -0.056735869497060776, mean p set: 0.4519474506378174The modified gen p mean: 0.45182275772094727, gen p mean: -0.053842827677726746, mean p set: 0.45230305194854736
loss_pred:0.01560685969889164, decouple_loss:0.0014524605358019471
loss_pred:0.01628304459154606, decouple_loss:0.0014143524458631873
Iteration: 310, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45188194513320923, gen p mean: -0.057026054710149765, mean p set: 0.4523622393608093
loss_pred:0.016245434060692787, decouple_loss:0.0011995909735560417
The modified gen p mean: 0.449162095785141, gen p mean: -0.050108812749385834, mean p set: 0.4496423602104187The modified gen p mean: 0.44925788044929504, gen p mean: -0.048456285148859024, mean p set: 0.44973814487457275
loss_pred:0.017231231555342674, decouple_loss:0.0014219562290236354
loss_pred:0.01776166819036007, decouple_loss:0.0013785575283691287
2023-05-02 03:54:09 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.06414418667554855, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.05954817309975624, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.059628646820783615, mean p set: 0.4500633478164673
loss_pred:0.018485495820641518, decouple_loss:0.0018285408150404692
loss_pred:0.017457133159041405, decouple_loss:0.0015094674890860915
loss_pred:0.01750973053276539, decouple_loss:0.0016300255665555596
WV_0_PC_1_EH_0_PS_40, loss: 0.0179002545773983, avg_mse: 0.025680042803287506
current test mse: 0.02568
Iteration: 311, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45224758982658386, gen p mean: -0.05228291451931, mean p set: 0.45272788405418396
The modified gen p mean: 0.45063912868499756, gen p mean: -0.05570177733898163, mean p set: 0.45111945271492004
The modified gen p mean: 0.4504604637622833, gen p mean: -0.04935573786497116, mean p set: 0.4509407579898834
loss_pred:0.015513714402914047, decouple_loss:0.001468030852265656
loss_pred:0.016144288703799248, decouple_loss:0.001583905890583992
loss_pred:0.01709316298365593, decouple_loss:0.0016944804228842258
Iteration: 312, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450633704662323, gen p mean: -0.056568510830402374, mean p set: 0.4511139988899231
loss_pred:0.01675880141556263, decouple_loss:0.001466519315727055
The modified gen p mean: 0.44897031784057617, gen p mean: -0.05169575661420822, mean p set: 0.44945064187049866The modified gen p mean: 0.44920992851257324, gen p mean: -0.048575010150671005, mean p set: 0.44969022274017334
loss_pred:0.017121080309152603, decouple_loss:0.0014526557642966509
loss_pred:0.016380716115236282, decouple_loss:0.0013986699050292373
Iteration: 313, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513459801673889, gen p mean: -0.052890315651893616, mean p set: 0.451826274394989
loss_pred:0.01630341075360775, decouple_loss:0.0014252811670303345
The modified gen p mean: 0.4506647288799286, gen p mean: -0.04718654230237007, mean p set: 0.4511450529098511The modified gen p mean: 0.4508954584598541, gen p mean: -0.05297805368900299, mean p set: 0.4513757526874542
loss_pred:0.015792982652783394, decouple_loss:0.0012685676338151097
loss_pred:0.015485895797610283, decouple_loss:0.0012411572970449924
Iteration: 314, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4520038962364197, gen p mean: -0.04708559438586235, mean p set: 0.4524841606616974
loss_pred:0.01622639037668705, decouple_loss:0.0013326018815860152
The modified gen p mean: 0.4498581290245056, gen p mean: -0.04445282742381096, mean p set: 0.4503384232521057The modified gen p mean: 0.4517821669578552, gen p mean: -0.045459918677806854, mean p set: 0.4522624611854553
loss_pred:0.015802711248397827, decouple_loss:0.0013235330116003752
loss_pred:0.016319885849952698, decouple_loss:0.001401533605530858
Iteration: 315, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.451149046421051, gen p mean: -0.046690765768289566, mean p set: 0.4516293406486511
loss_pred:0.01610616408288479, decouple_loss:0.0012408203911036253
The modified gen p mean: 0.4502313733100891, gen p mean: -0.052210211753845215, mean p set: 0.4507116973400116The modified gen p mean: 0.44991326332092285, gen p mean: -0.05218198150396347, mean p set: 0.4503934979438782
loss_pred:0.01647830940783024, decouple_loss:0.001381434267386794
loss_pred:0.01722831465303898, decouple_loss:0.0014358588960021734
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012013_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012013_3_24hr.npz
NaN value num: 0
Iteration: 316, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45106467604637146, gen p mean: -0.04955317825078964, mean p set: 0.45154494047164917
loss_pred:0.01613680087029934, decouple_loss:0.0015575229190289974
The modified gen p mean: 0.4522620439529419, gen p mean: -0.05331483483314514, mean p set: 0.452742338180542The modified gen p mean: 0.45029664039611816, gen p mean: -0.055344898253679276, mean p set: 0.45077693462371826
loss_pred:0.016015436500310898, decouple_loss:0.0015585412038490176
loss_pred:0.016223415732383728, decouple_loss:0.0013599023222923279
Iteration: 317, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45241329073905945, gen p mean: -0.0569617934525013, mean p set: 0.45289358496665955
loss_pred:0.01621929742395878, decouple_loss:0.0012529856758192182
The modified gen p mean: 0.4519435167312622, gen p mean: -0.05777386203408241, mean p set: 0.4524238109588623The modified gen p mean: 0.45130977034568787, gen p mean: -0.04680221527814865, mean p set: 0.45179006457328796
loss_pred:0.016374872997403145, decouple_loss:0.0011518022511154413
loss_pred:0.01689809374511242, decouple_loss:0.001260264660231769
Iteration: 318, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45175155997276306, gen p mean: -0.05313944071531296, mean p set: 0.45223185420036316
loss_pred:0.016595376655459404, decouple_loss:0.0015537460567429662
The modified gen p mean: 0.4494660496711731, gen p mean: -0.0548408068716526, mean p set: 0.4499463438987732The modified gen p mean: 0.4516170918941498, gen p mean: -0.04439663141965866, mean p set: 0.4520973861217499
loss_pred:0.017482979223132133, decouple_loss:0.001328009064309299
loss_pred:0.0170991662889719, decouple_loss:0.00136941100936383
Iteration: 319, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44944626092910767, gen p mean: -0.05302858352661133, mean p set: 0.44992655515670776
loss_pred:0.017198581248521805, decouple_loss:0.001130234799347818
The modified gen p mean: 0.4530012309551239, gen p mean: -0.05320654809474945, mean p set: 0.453481525182724The modified gen p mean: 0.4512418508529663, gen p mean: -0.056973181664943695, mean p set: 0.451722115278244
loss_pred:0.01591424085199833, decouple_loss:0.0012409068876877427
loss_pred:0.017516544088721275, decouple_loss:0.0014375379541888833
Iteration: 320, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45014870166778564, gen p mean: -0.05334136635065079, mean p set: 0.45062902569770813
loss_pred:0.01656954362988472, decouple_loss:0.001384154544211924
The modified gen p mean: 0.45027369260787964, gen p mean: -0.048834189772605896, mean p set: 0.4507540166378021The modified gen p mean: 0.4499052166938782, gen p mean: -0.04891795665025711, mean p set: 0.45038551092147827
loss_pred:0.016956383362412453, decouple_loss:0.0014298248570412397
loss_pred:0.016479525715112686, decouple_loss:0.0017389756394550204
2023-05-02 03:56:40 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.057383399456739426, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.05275937542319298, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.052807919681072235, mean p set: 0.4500633478164673
loss_pred:0.018366537988185883, decouple_loss:0.0016187973087653518
loss_pred:0.01726618781685829, decouple_loss:0.0013531073927879333
loss_pred:0.017361029982566833, decouple_loss:0.0015211531426757574
WV_0_PC_1_EH_0_PS_40, loss: 0.017739471048116684, avg_mse: 0.02540447935461998
current test mse: 0.025404
Iteration: 321, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.452606201171875, gen p mean: -0.04453094303607941, mean p set: 0.4530864953994751
The modified gen p mean: 0.45108503103256226, gen p mean: -0.049983683973550797, mean p set: 0.45156532526016235
The modified gen p mean: 0.45170366764068604, gen p mean: -0.052553556859493256, mean p set: 0.45218396186828613
loss_pred:0.017733266577124596, decouple_loss:0.0014594343956559896
loss_pred:0.016035357490181923, decouple_loss:0.0014895034255459905
loss_pred:0.016952620819211006, decouple_loss:0.0013637098018079996
Iteration: 322, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4517829120159149, gen p mean: -0.046648137271404266, mean p set: 0.452263206243515
loss_pred:0.01663762331008911, decouple_loss:0.0011099983239546418
The modified gen p mean: 0.45045387744903564, gen p mean: -0.0530666820704937, mean p set: 0.45093417167663574The modified gen p mean: 0.4517129063606262, gen p mean: -0.04322579503059387, mean p set: 0.4521932005882263
loss_pred:0.016720015555620193, decouple_loss:0.001088518532924354
loss_pred:0.017127681523561478, decouple_loss:0.0010941175278276205
Iteration: 323, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4506767988204956, gen p mean: -0.04718738794326782, mean p set: 0.4511570930480957
loss_pred:0.017551345750689507, decouple_loss:0.0015351601177826524
The modified gen p mean: 0.4509936571121216, gen p mean: -0.046006519347429276, mean p set: 0.4514739513397217The modified gen p mean: 0.4498281180858612, gen p mean: -0.052212104201316833, mean p set: 0.4503083825111389
loss_pred:0.017217382788658142, decouple_loss:0.0015235035680234432
loss_pred:0.017247240990400314, decouple_loss:0.0016386855859309435
Iteration: 324, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4506543278694153, gen p mean: -0.04751671478152275, mean p set: 0.4511346220970154
loss_pred:0.01732346974313259, decouple_loss:0.0013050453271716833
The modified gen p mean: 0.44963374733924866, gen p mean: -0.054883357137441635, mean p set: 0.45011407136917114The modified gen p mean: 0.45107385516166687, gen p mean: -0.04515520855784416, mean p set: 0.45155417919158936
loss_pred:0.017142824828624725, decouple_loss:0.001432091579772532
loss_pred:0.017465461045503616, decouple_loss:0.001300713513046503
Iteration: 325, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4512133300304413, gen p mean: -0.05430714040994644, mean p set: 0.4516936242580414
loss_pred:0.017708927392959595, decouple_loss:0.0014003929682075977
The modified gen p mean: 0.451000839471817, gen p mean: -0.05203628912568092, mean p set: 0.4514811336994171The modified gen p mean: 0.45127442479133606, gen p mean: -0.04919455572962761, mean p set: 0.45175471901893616
loss_pred:0.016951747238636017, decouple_loss:0.0013588910223916173
loss_pred:0.017298422753810883, decouple_loss:0.001289282226935029
Iteration: 326, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4515957236289978, gen p mean: -0.05179687589406967, mean p set: 0.4520759880542755
loss_pred:0.016500728204846382, decouple_loss:0.0013192531187087297
The modified gen p mean: 0.4509449005126953, gen p mean: -0.04827676713466644, mean p set: 0.4514252245426178The modified gen p mean: 0.4520995318889618, gen p mean: -0.05542050674557686, mean p set: 0.4525797963142395
loss_pred:0.016417937353253365, decouple_loss:0.0015242986846715212
loss_pred:0.01674703322350979, decouple_loss:0.0014009929727762938
Iteration: 327, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4510102868080139, gen p mean: -0.05097705125808716, mean p set: 0.451490581035614
loss_pred:0.01676536165177822, decouple_loss:0.0013986905105412006
The modified gen p mean: 0.4504777491092682, gen p mean: -0.05267961323261261, mean p set: 0.4509580433368683The modified gen p mean: 0.4502072036266327, gen p mean: -0.052911918610334396, mean p set: 0.4506874978542328
loss_pred:0.017728349193930626, decouple_loss:0.0014320367481559515
loss_pred:0.016561655327677727, decouple_loss:0.001261540804989636
Iteration: 328, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503312408924103, gen p mean: -0.05466752126812935, mean p set: 0.4508115351200104
loss_pred:0.016339845955371857, decouple_loss:0.001320944749750197
The modified gen p mean: 0.4505440890789032, gen p mean: -0.05966914817690849, mean p set: 0.4510243833065033The modified gen p mean: 0.4504963755607605, gen p mean: -0.055489543825387955, mean p set: 0.4509766697883606
loss_pred:0.016999470070004463, decouple_loss:0.0013555582845583558
loss_pred:0.016985977068543434, decouple_loss:0.0011190318036824465
Iteration: 329, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450015127658844, gen p mean: -0.05375730246305466, mean p set: 0.4504954218864441
loss_pred:0.017009060829877853, decouple_loss:0.0011771806748583913
The modified gen p mean: 0.45153576135635376, gen p mean: -0.05302777886390686, mean p set: 0.45201605558395386The modified gen p mean: 0.4508785307407379, gen p mean: -0.056356001645326614, mean p set: 0.451358824968338
loss_pred:0.017035912722349167, decouple_loss:0.001173745607957244
loss_pred:0.016847623512148857, decouple_loss:0.0013143854448571801
Iteration: 330, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45014965534210205, gen p mean: -0.055806826800107956, mean p set: 0.45062994956970215
loss_pred:0.01748775877058506, decouple_loss:0.0011517443927004933
The modified gen p mean: 0.4500358998775482, gen p mean: -0.05127008259296417, mean p set: 0.4505161941051483The modified gen p mean: 0.4513689875602722, gen p mean: -0.04836602881550789, mean p set: 0.4518493115901947
loss_pred:0.016736850142478943, decouple_loss:0.0012443973682820797
loss_pred:0.017105646431446075, decouple_loss:0.0011288168607279658
2023-05-02 03:58:35 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.06192920729517937, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.057070862501859665, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.057111721485853195, mean p set: 0.4500633478164673
loss_pred:0.018379876390099525, decouple_loss:0.0013452470302581787
loss_pred:0.017276102676987648, decouple_loss:0.0012843478471040726
loss_pred:0.01742507889866829, decouple_loss:0.0013385404599830508
WV_0_PC_1_EH_0_PS_40, loss: 0.017759820446372032, avg_mse: 0.025459712371230125
current test mse: 0.02546
Iteration: 331, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513828158378601, gen p mean: -0.05658116564154625, mean p set: 0.4518631398677826
The modified gen p mean: 0.45092010498046875, gen p mean: -0.05489708483219147, mean p set: 0.45140039920806885
The modified gen p mean: 0.45241865515708923, gen p mean: -0.05379931256175041, mean p set: 0.45289894938468933
loss_pred:0.016536718234419823, decouple_loss:0.0016823846381157637
loss_pred:0.017585139721632004, decouple_loss:0.0015493620885536075
loss_pred:0.016425009816884995, decouple_loss:0.0011885539861395955
Iteration: 332, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4523983597755432, gen p mean: -0.04876286908984184, mean p set: 0.4528786242008209
The modified gen p mean: 0.4509691596031189, gen p mean: -0.04587756097316742, mean p set: 0.451449453830719
loss_pred:0.01678897812962532, decouple_loss:0.001126580755226314
loss_pred:0.0163789801299572, decouple_loss:0.0012430218048393726
The modified gen p mean: 0.45170968770980835, gen p mean: -0.04361583665013313, mean p set: 0.45218998193740845
loss_pred:0.016938578337430954, decouple_loss:0.001036971341818571
Iteration: 333, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.451759397983551, gen p mean: -0.046351708471775055, mean p set: 0.4522396922111511
loss_pred:0.016605591401457787, decouple_loss:0.0011579078854992986
The modified gen p mean: 0.45068854093551636, gen p mean: -0.05544992536306381, mean p set: 0.45116883516311646The modified gen p mean: 0.45086175203323364, gen p mean: -0.05259326472878456, mean p set: 0.45134201645851135
loss_pred:0.01758028380572796, decouple_loss:0.001296292059123516
loss_pred:0.01708141900599003, decouple_loss:0.0011724905343726277
Iteration: 334, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45238882303237915, gen p mean: -0.052591338753700256, mean p set: 0.45286911725997925
loss_pred:0.016586678102612495, decouple_loss:0.0011994411470368505
The modified gen p mean: 0.4513470530509949, gen p mean: -0.04623584821820259, mean p set: 0.45182737708091736The modified gen p mean: 0.45031309127807617, gen p mean: -0.053899962455034256, mean p set: 0.4507933557033539
loss_pred:0.016544964164495468, decouple_loss:0.0010374506236985326
loss_pred:0.01655089296400547, decouple_loss:0.0009615359012968838
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012015_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012015_3_24hr.npz
NaN value num: 0
Iteration: 335, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4512256383895874, gen p mean: -0.04877045005559921, mean p set: 0.4517059326171875
loss_pred:0.018163491040468216, decouple_loss:0.001095446408726275
The modified gen p mean: 0.4497857689857483, gen p mean: -0.0529048889875412, mean p set: 0.4502660930156708The modified gen p mean: 0.45174381136894226, gen p mean: -0.04383374750614166, mean p set: 0.45222410559654236
loss_pred:0.016929304227232933, decouple_loss:0.0010975456098094583
loss_pred:0.017739789560437202, decouple_loss:0.001047919038683176
Iteration: 336, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491286873817444, gen p mean: -0.04877449944615364, mean p set: 0.4496089518070221
loss_pred:0.017763745039701462, decouple_loss:0.001131705241277814
The modified gen p mean: 0.45053184032440186, gen p mean: -0.04841817915439606, mean p set: 0.45101216435432434The modified gen p mean: 0.45101234316825867, gen p mean: -0.04666856303811073, mean p set: 0.45149263739585876
loss_pred:0.016829485073685646, decouple_loss:0.0012092427350580692
loss_pred:0.016636446118354797, decouple_loss:0.00124530796892941
Iteration: 337, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497421085834503, gen p mean: -0.051504045724868774, mean p set: 0.450222373008728
loss_pred:0.017165763303637505, decouple_loss:0.0011901974212378263
The modified gen p mean: 0.4504856467247009, gen p mean: -0.04452101141214371, mean p set: 0.450965940952301
The modified gen p mean: 0.45325765013694763, gen p mean: -0.049425411969423294, mean p set: 0.45373791456222534
loss_pred:0.017548944801092148, decouple_loss:0.0011850969167426229
loss_pred:0.01808568462729454, decouple_loss:0.0011803772067651153
Iteration: 338, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4528255760669708, gen p mean: -0.04728270322084427, mean p set: 0.45330584049224854
loss_pred:0.017718307673931122, decouple_loss:0.0010501607321202755
The modified gen p mean: 0.4497118890285492, gen p mean: -0.05140596255660057, mean p set: 0.4501922130584717
The modified gen p mean: 0.44956886768341064, gen p mean: -0.04362814873456955, mean p set: 0.45004913210868835
loss_pred:0.016857802867889404, decouple_loss:0.0012504407204687595
loss_pred:0.01764187589287758, decouple_loss:0.0011170444777235389
Iteration: 339, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45058462023735046, gen p mean: -0.057174257934093475, mean p set: 0.45106494426727295
loss_pred:0.01686570793390274, decouple_loss:0.0013229136820882559
The modified gen p mean: 0.44994911551475525, gen p mean: -0.050098858773708344, mean p set: 0.45042943954467773The modified gen p mean: 0.45146024227142334, gen p mean: -0.040025826543569565, mean p set: 0.45194050669670105
loss_pred:0.017096012830734253, decouple_loss:0.0012509056832641363
loss_pred:0.017358027398586273, decouple_loss:0.0014103682478889823
Iteration: 340, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4520019292831421, gen p mean: -0.04941875860095024, mean p set: 0.4524822235107422
loss_pred:0.01689739152789116, decouple_loss:0.0011147432960569859
The modified gen p mean: 0.45049893856048584, gen p mean: -0.047873709350824356, mean p set: 0.45097923278808594
The modified gen p mean: 0.4490912854671478, gen p mean: -0.049064796417951584, mean p set: 0.4495715796947479
loss_pred:0.016458630561828613, decouple_loss:0.0011393839959055185
loss_pred:0.017169421538710594, decouple_loss:0.0011672311229631305
2023-05-02 04:01:06 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.059663984924554825, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.05481436848640442, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.05458958074450493, mean p set: 0.4500633478164673
loss_pred:0.018420381471514702, decouple_loss:0.0015469923382624984
loss_pred:0.01727834716439247, decouple_loss:0.0012558872113004327
loss_pred:0.017478283494710922, decouple_loss:0.0012894117971882224
WV_0_PC_1_EH_0_PS_40, loss: 0.017793875187635422, avg_mse: 0.025510134175419807
current test mse: 0.02551
Iteration: 341, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449121356010437, gen p mean: -0.052232980728149414, mean p set: 0.4496016502380371
The modified gen p mean: 0.44890713691711426, gen p mean: -0.0484495647251606, mean p set: 0.44938743114471436
The modified gen p mean: 0.4517269432544708, gen p mean: -0.04307951033115387, mean p set: 0.45220720767974854
loss_pred:0.01722540333867073, decouple_loss:0.0012122854823246598
loss_pred:0.017343604937195778, decouple_loss:0.0012589922407642007
loss_pred:0.016496941447257996, decouple_loss:0.0012043672613799572
Iteration: 342, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44866570830345154, gen p mean: -0.04546164348721504, mean p set: 0.44914600253105164
loss_pred:0.017505722120404243, decouple_loss:0.0010718785924836993
The modified gen p mean: 0.45019111037254333, gen p mean: -0.057222384959459305, mean p set: 0.45067140460014343The modified gen p mean: 0.44844138622283936, gen p mean: -0.04968509078025818, mean p set: 0.44892165064811707
loss_pred:0.01692820154130459, decouple_loss:0.001002241624519229
loss_pred:0.017320025712251663, decouple_loss:0.0010929717682301998
Iteration: 343, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484596252441406, gen p mean: -0.05025970935821533, mean p set: 0.4489399194717407
loss_pred:0.016212768852710724, decouple_loss:0.0011394268367439508
The modified gen p mean: 0.4528867304325104, gen p mean: -0.050400808453559875, mean p set: 0.4533670246601105The modified gen p mean: 0.4490957260131836, gen p mean: -0.054071709513664246, mean p set: 0.4495759904384613
loss_pred:0.017618125304579735, decouple_loss:0.0011369027197360992
loss_pred:0.01694006286561489, decouple_loss:0.001170578645542264
Iteration: 344, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482678472995758, gen p mean: -0.05268815904855728, mean p set: 0.4487481415271759
loss_pred:0.017404478043317795, decouple_loss:0.0009477610583417118
The modified gen p mean: 0.4484226703643799, gen p mean: -0.05246344953775406, mean p set: 0.4489029347896576The modified gen p mean: 0.44913262128829956, gen p mean: -0.05481526628136635, mean p set: 0.44961294531822205
loss_pred:0.017197344452142715, decouple_loss:0.0010704563464969397
loss_pred:0.01606397144496441, decouple_loss:0.0010192579356953502
Iteration: 345, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492291510105133, gen p mean: -0.05272504314780235, mean p set: 0.4497094452381134
loss_pred:0.016957808285951614, decouple_loss:0.0010598314693197608
The modified gen p mean: 0.4490293562412262, gen p mean: -0.0514259971678257, mean p set: 0.4495096802711487The modified gen p mean: 0.45079657435417175, gen p mean: -0.05030251294374466, mean p set: 0.45127683877944946
loss_pred:0.01729704439640045, decouple_loss:0.0009661064250394702
loss_pred:0.01671574078500271, decouple_loss:0.0011037795338779688
Iteration: 346, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44832563400268555, gen p mean: -0.05022762343287468, mean p set: 0.44880592823028564
loss_pred:0.016560055315494537, decouple_loss:0.0012157862074673176
The modified gen p mean: 0.45114290714263916, gen p mean: -0.05154290422797203, mean p set: 0.45162320137023926The modified gen p mean: 0.4524902105331421, gen p mean: -0.05354459583759308, mean p set: 0.4529705345630646
loss_pred:0.017123732715845108, decouple_loss:0.0012951918179169297
loss_pred:0.016893737018108368, decouple_loss:0.0012017274275422096
Iteration: 347, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45107409358024597, gen p mean: -0.043330054730176926, mean p set: 0.4515543580055237
loss_pred:0.017796671018004417, decouple_loss:0.0014226745115593076
The modified gen p mean: 0.4511186480522156, gen p mean: -0.04609339311718941, mean p set: 0.4515989124774933The modified gen p mean: 0.4510059058666229, gen p mean: -0.04926939681172371, mean p set: 0.45148617029190063
loss_pred:0.017584946006536484, decouple_loss:0.0011303259525448084
loss_pred:0.017848540097475052, decouple_loss:0.001127571682445705
Iteration: 348, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44881466031074524, gen p mean: -0.049556050449609756, mean p set: 0.44929495453834534
loss_pred:0.016876475885510445, decouple_loss:0.0014351216377690434
The modified gen p mean: 0.44957685470581055, gen p mean: -0.0575568862259388, mean p set: 0.45005717873573303The modified gen p mean: 0.45077425241470337, gen p mean: -0.04813240468502045, mean p set: 0.45125457644462585
loss_pred:0.017027784138917923, decouple_loss:0.0013763685710728168
loss_pred:0.01693689450621605, decouple_loss:0.0013108965940773487
Iteration: 349, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486089050769806, gen p mean: -0.050967488437891006, mean p set: 0.4490891993045807
loss_pred:0.017366468906402588, decouple_loss:0.0011752007994800806
The modified gen p mean: 0.448651522397995, gen p mean: -0.05379873514175415, mean p set: 0.4491318166255951The modified gen p mean: 0.4492603838443756, gen p mean: -0.053952161222696304, mean p set: 0.4497406780719757
loss_pred:0.015885263681411743, decouple_loss:0.0013231817865744233
loss_pred:0.01617337390780449, decouple_loss:0.0015457716071978211
Iteration: 350, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502372443675995, gen p mean: -0.053710129112005234, mean p set: 0.4507175385951996
loss_pred:0.016983428969979286, decouple_loss:0.0012654658639803529
The modified gen p mean: 0.44978469610214233, gen p mean: -0.055933427065610886, mean p set: 0.45026499032974243The modified gen p mean: 0.4495984613895416, gen p mean: -0.05656690150499344, mean p set: 0.4500787556171417
loss_pred:0.016043055802583694, decouple_loss:0.001154026947915554
loss_pred:0.017433904111385345, decouple_loss:0.0010086570400744677
2023-05-02 04:03:01 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.0664636641740799, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.06157942861318588, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.06138726696372032, mean p set: 0.4500633478164673
loss_pred:0.01839272305369377, decouple_loss:0.0015461866278201342
loss_pred:0.017251675948500633, decouple_loss:0.0012927006464451551
loss_pred:0.017456602305173874, decouple_loss:0.001417236984707415
WV_0_PC_1_EH_0_PS_40, loss: 0.017771270126104355, avg_mse: 0.025483403354883194
current test mse: 0.025483
Iteration: 351, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493042826652527, gen p mean: -0.05866193771362305, mean p set: 0.4497845768928528
The modified gen p mean: 0.45049571990966797, gen p mean: -0.0551290325820446, mean p set: 0.45097601413726807
The modified gen p mean: 0.4501085579395294, gen p mean: -0.054296594113111496, mean p set: 0.4505888819694519
loss_pred:0.01754622347652912, decouple_loss:0.0016367650823667645
loss_pred:0.017870813608169556, decouple_loss:0.0013323647435754538
loss_pred:0.017433056607842445, decouple_loss:0.00146643933840096
Iteration: 352, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45025038719177246, gen p mean: -0.055691443383693695, mean p set: 0.4507306218147278
loss_pred:0.017167169600725174, decouple_loss:0.0012801394332200289
The modified gen p mean: 0.45099177956581116, gen p mean: -0.04810754582285881, mean p set: 0.45147207379341125The modified gen p mean: 0.449856698513031, gen p mean: -0.06229472905397415, mean p set: 0.4503369629383087
loss_pred:0.01764647290110588, decouple_loss:0.0015433382941409945
loss_pred:0.016591163352131844, decouple_loss:0.001307420083321631
Iteration: 353, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44919833540916443, gen p mean: -0.05675283074378967, mean p set: 0.4496786296367645
loss_pred:0.01662714220583439, decouple_loss:0.0010878756875172257
The modified gen p mean: 0.4489806294441223, gen p mean: -0.056843724101781845, mean p set: 0.4494609236717224The modified gen p mean: 0.4498249292373657, gen p mean: -0.057237014174461365, mean p set: 0.45030519366264343
loss_pred:0.016561158001422882, decouple_loss:0.0011689943494275212
loss_pred:0.017005156725645065, decouple_loss:0.0011560741113498807
Iteration: 354, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44951188564300537, gen p mean: -0.054931070655584335, mean p set: 0.44999220967292786
loss_pred:0.017162702977657318, decouple_loss:0.0012074523838236928
The modified gen p mean: 0.4488903880119324, gen p mean: -0.05521859973669052, mean p set: 0.4493706524372101The modified gen p mean: 0.4508938789367676, gen p mean: -0.05202840641140938, mean p set: 0.4513741731643677
loss_pred:0.016675740480422974, decouple_loss:0.0010785720078274608
loss_pred:0.016969935968518257, decouple_loss:0.0011931509943678975
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012003_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012003_3_24hr.npz
NaN value num: 0
Iteration: 355, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4526509642601013, gen p mean: -0.05434807017445564, mean p set: 0.4531312584877014
loss_pred:0.01759699173271656, decouple_loss:0.0013346148189157248
The modified gen p mean: 0.4527396261692047, gen p mean: -0.05202697962522507, mean p set: 0.4532198905944824
The modified gen p mean: 0.4492345154285431, gen p mean: -0.05712355673313141, mean p set: 0.4497148096561432
loss_pred:0.017666511237621307, decouple_loss:0.0012394667137414217
loss_pred:0.01725088059902191, decouple_loss:0.0012721255188807845
Iteration: 356, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45171692967414856, gen p mean: -0.04836122319102287, mean p set: 0.45219725370407104
loss_pred:0.016538115218281746, decouple_loss:0.0011939372634515166
The modified gen p mean: 0.4501267671585083, gen p mean: -0.06174096092581749, mean p set: 0.4506070911884308The modified gen p mean: 0.44726434350013733, gen p mean: -0.06198306009173393, mean p set: 0.4477446675300598
loss_pred:0.016438981518149376, decouple_loss:0.0012091464595869184
loss_pred:0.01722644828259945, decouple_loss:0.001139144878834486
Iteration: 357, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502153694629669, gen p mean: -0.051995448768138885, mean p set: 0.450695663690567
The modified gen p mean: 0.45070335268974304, gen p mean: -0.04996011406183243, mean p set: 0.4511836767196655
loss_pred:0.01741980016231537, decouple_loss:0.0010795595590025187
The modified gen p mean: 0.4500858783721924, gen p mean: -0.04970411956310272, mean p set: 0.4505661725997925
loss_pred:0.017687328159809113, decouple_loss:0.0011213237885385752
loss_pred:0.016495980322360992, decouple_loss:0.0011008071014657617
Iteration: 358, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45217227935791016, gen p mean: -0.04764653742313385, mean p set: 0.45265257358551025
loss_pred:0.016661327332258224, decouple_loss:0.0012208705302327871
The modified gen p mean: 0.45048776268959045, gen p mean: -0.053169481456279755, mean p set: 0.45096808671951294The modified gen p mean: 0.4523540735244751, gen p mean: -0.046601034700870514, mean p set: 0.4528343677520752
loss_pred:0.016500316560268402, decouple_loss:0.0011399418581277132
loss_pred:0.016690770164132118, decouple_loss:0.0011464623967185616
Iteration: 359, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489035904407501, gen p mean: -0.05562284588813782, mean p set: 0.4493838846683502
loss_pred:0.0176529623568058, decouple_loss:0.001228689099662006
The modified gen p mean: 0.449763685464859, gen p mean: -0.05540153756737709, mean p set: 0.4502440094947815The modified gen p mean: 0.4502222537994385, gen p mean: -0.04540669918060303, mean p set: 0.4507025480270386
loss_pred:0.017956530675292015, decouple_loss:0.0012052466627210379
loss_pred:0.017728006467223167, decouple_loss:0.0011971761705353856
Iteration: 360, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44918400049209595, gen p mean: -0.04638027027249336, mean p set: 0.44966429471969604
The modified gen p mean: 0.44983574748039246, gen p mean: -0.04730014503002167, mean p set: 0.45031604170799255
loss_pred:0.01765468716621399, decouple_loss:0.0011006337590515614
loss_pred:0.0174265094101429, decouple_loss:0.0011331571731716394
The modified gen p mean: 0.4497276544570923, gen p mean: -0.05715933442115784, mean p set: 0.45020797848701477
loss_pred:0.017331058159470558, decouple_loss:0.0011569359339773655
2023-05-02 04:05:35 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.05490966513752937, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.050388187170028687, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.0501212403178215, mean p set: 0.4500633478164673
loss_pred:0.01837608776986599, decouple_loss:0.0012100437888875604
loss_pred:0.017261797562241554, decouple_loss:0.001261792378500104
loss_pred:0.017411883920431137, decouple_loss:0.0012696251505985856
WV_0_PC_1_EH_0_PS_40, loss: 0.017745614051818848, avg_mse: 0.025422457605600357
current test mse: 0.025422
Iteration: 361, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.451625794172287, gen p mean: -0.04773832857608795, mean p set: 0.4521060883998871
The modified gen p mean: 0.4485595226287842, gen p mean: -0.05557394400238991, mean p set: 0.44903984665870667
The modified gen p mean: 0.4488403797149658, gen p mean: -0.05083085596561432, mean p set: 0.4493206739425659
loss_pred:0.016448529437184334, decouple_loss:0.0011113571235910058
loss_pred:0.017146553844213486, decouple_loss:0.001083775539882481
loss_pred:0.01668088510632515, decouple_loss:0.0012451930670067668
Iteration: 362, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4515535533428192, gen p mean: -0.04365472495555878, mean p set: 0.4520338773727417
loss_pred:0.017176302149891853, decouple_loss:0.0010946954134851694
The modified gen p mean: 0.4512633979320526, gen p mean: -0.04713552072644234, mean p set: 0.4517436623573303The modified gen p mean: 0.4503084421157837, gen p mean: -0.04882630705833435, mean p set: 0.4507887363433838
loss_pred:0.01756514236330986, decouple_loss:0.0010425326181575656
loss_pred:0.01630588434636593, decouple_loss:0.0010048155672848225
Iteration: 363, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44972240924835205, gen p mean: -0.047537125647068024, mean p set: 0.45020267367362976
loss_pred:0.017892755568027496, decouple_loss:0.0010772671084851027
The modified gen p mean: 0.4530010223388672, gen p mean: -0.04573487117886543, mean p set: 0.4534813165664673The modified gen p mean: 0.44970133900642395, gen p mean: -0.04495268687605858, mean p set: 0.45018163323402405
loss_pred:0.017163516953587532, decouple_loss:0.0011861074017360806
loss_pred:0.017427820712327957, decouple_loss:0.001338410540483892
Iteration: 364, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44980499148368835, gen p mean: -0.04422805458307266, mean p set: 0.45028528571128845
loss_pred:0.016421904787421227, decouple_loss:0.0011031203903257847
The modified gen p mean: 0.44869184494018555, gen p mean: -0.04842309653759003, mean p set: 0.44917213916778564The modified gen p mean: 0.44876691699028015, gen p mean: -0.049678679555654526, mean p set: 0.44924721121788025
loss_pred:0.016574710607528687, decouple_loss:0.0011912656482309103
loss_pred:0.016671551391482353, decouple_loss:0.0011354626622051
Iteration: 365, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44933873414993286, gen p mean: -0.04962104931473732, mean p set: 0.44981902837753296
loss_pred:0.0165103767067194, decouple_loss:0.0011958350660279393
The modified gen p mean: 0.4506075978279114, gen p mean: -0.04401465132832527, mean p set: 0.4510878920555115The modified gen p mean: 0.4495389461517334, gen p mean: -0.03890296444296837, mean p set: 0.4500192403793335
loss_pred:0.017703959718346596, decouple_loss:0.001026354730129242
loss_pred:0.017023781314492226, decouple_loss:0.0009804413421079516
Iteration: 366, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44949871301651, gen p mean: -0.0400308296084404, mean p set: 0.4499790072441101
loss_pred:0.017219774425029755, decouple_loss:0.001180991530418396
The modified gen p mean: 0.4496883749961853, gen p mean: -0.03575886785984039, mean p set: 0.4501686692237854The modified gen p mean: 0.44846272468566895, gen p mean: -0.04962702840566635, mean p set: 0.44894298911094666
loss_pred:0.01685352809727192, decouple_loss:0.001137681771069765
loss_pred:0.01605493202805519, decouple_loss:0.0011647316860035062
Iteration: 367, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44984570145606995, gen p mean: -0.0354117825627327, mean p set: 0.45032599568367004
loss_pred:0.01653381437063217, decouple_loss:0.0010061966022476554
The modified gen p mean: 0.4498113691806793, gen p mean: -0.04303472116589546, mean p set: 0.4502916932106018The modified gen p mean: 0.4496876001358032, gen p mean: -0.041841618716716766, mean p set: 0.45016786456108093
loss_pred:0.01749865710735321, decouple_loss:0.001037711394019425
loss_pred:0.01743839494884014, decouple_loss:0.0009913283865898848
Iteration: 368, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511922299861908, gen p mean: -0.041951652616262436, mean p set: 0.4516725242137909
loss_pred:0.017273632809519768, decouple_loss:0.0010596980573609471
The modified gen p mean: 0.4498523473739624, gen p mean: -0.04040384292602539, mean p set: 0.4503326416015625The modified gen p mean: 0.45282161235809326, gen p mean: -0.0386461578309536, mean p set: 0.45330190658569336
loss_pred:0.0176993440836668, decouple_loss:0.0011211257660761476
loss_pred:0.016546580940485, decouple_loss:0.0011275402503088117
Iteration: 369, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45256516337394714, gen p mean: -0.03885463997721672, mean p set: 0.45304545760154724
loss_pred:0.016966095194220543, decouple_loss:0.001154684810899198
The modified gen p mean: 0.45271623134613037, gen p mean: -0.039238348603248596, mean p set: 0.4531964957714081The modified gen p mean: 0.45007792115211487, gen p mean: -0.035927679389715195, mean p set: 0.4505581855773926
loss_pred:0.017153941094875336, decouple_loss:0.0011558736441656947
loss_pred:0.016902461647987366, decouple_loss:0.0010632692137733102
Iteration: 370, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45304596424102783, gen p mean: -0.045754916965961456, mean p set: 0.45352625846862793
loss_pred:0.016831588000059128, decouple_loss:0.0012041247682645917
The modified gen p mean: 0.44997432827949524, gen p mean: -0.043230872601270676, mean p set: 0.45045459270477295The modified gen p mean: 0.44953402876853943, gen p mean: -0.041829727590084076, mean p set: 0.4500143229961395
loss_pred:0.016010265797376633, decouple_loss:0.0011113586369901896
loss_pred:0.016558142378926277, decouple_loss:0.0011199564905837178
2023-05-02 04:07:31 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.053085293620824814, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04795411601662636, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04820915311574936, mean p set: 0.4500633478164673
loss_pred:0.01838068850338459, decouple_loss:0.0013235867954790592
loss_pred:0.017258169129490852, decouple_loss:0.0012408726615831256
loss_pred:0.01739467680454254, decouple_loss:0.0012810572516173124
WV_0_PC_1_EH_0_PS_40, loss: 0.017741937190294266, avg_mse: 0.025435088202357292
current test mse: 0.025435
Iteration: 371, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491724371910095, gen p mean: -0.04333589971065521, mean p set: 0.4496527314186096
The modified gen p mean: 0.45039209723472595, gen p mean: -0.03836393728852272, mean p set: 0.45087239146232605
The modified gen p mean: 0.45013394951820374, gen p mean: -0.040269460529088974, mean p set: 0.45061424374580383
loss_pred:0.0168690737336874, decouple_loss:0.0009977520676329732
loss_pred:0.017208226025104523, decouple_loss:0.001083014183677733
loss_pred:0.016603605821728706, decouple_loss:0.0010283385636284947
Iteration: 372, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45297864079475403, gen p mean: -0.04396548867225647, mean p set: 0.4534589648246765
loss_pred:0.01643575355410576, decouple_loss:0.0012277857167646289
The modified gen p mean: 0.44934505224227905, gen p mean: -0.0425611175596714, mean p set: 0.44982537627220154The modified gen p mean: 0.4505920112133026, gen p mean: -0.04858555644750595, mean p set: 0.4510722756385803
loss_pred:0.016539933159947395, decouple_loss:0.0010366510832682252
loss_pred:0.01711076684296131, decouple_loss:0.0010116870980709791
Iteration: 373, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4535812437534332, gen p mean: -0.04612370952963829, mean p set: 0.45406150817871094
loss_pred:0.01628103107213974, decouple_loss:0.0011187010677531362
The modified gen p mean: 0.44992244243621826, gen p mean: -0.039852891117334366, mean p set: 0.45040273666381836The modified gen p mean: 0.44892454147338867, gen p mean: -0.050370097160339355, mean p set: 0.4494048058986664
loss_pred:0.016765480861067772, decouple_loss:0.0011091927299275994
loss_pred:0.016105355694890022, decouple_loss:0.0010996756609529257
Iteration: 374, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45316675305366516, gen p mean: -0.042393334209918976, mean p set: 0.45364704728126526
loss_pred:0.016390778124332428, decouple_loss:0.001103829126805067
The modified gen p mean: 0.44873303174972534, gen p mean: -0.04629620909690857, mean p set: 0.44921332597732544The modified gen p mean: 0.4514254331588745, gen p mean: -0.04585963115096092, mean p set: 0.451905757188797
loss_pred:0.01708097755908966, decouple_loss:0.0011448368895798922
loss_pred:0.016433995217084885, decouple_loss:0.0010401711333543062
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012018_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012018_3_24hr.npz
NaN value num: 0
Iteration: 375, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44927510619163513, gen p mean: -0.0439198762178421, mean p set: 0.4497554302215576
loss_pred:0.016615230590105057, decouple_loss:0.0010251012863591313
The modified gen p mean: 0.44968530535697937, gen p mean: -0.04224613308906555, mean p set: 0.45016559958457947The modified gen p mean: 0.4483364522457123, gen p mean: -0.04546196758747101, mean p set: 0.44881677627563477
loss_pred:0.01600485108792782, decouple_loss:0.000995262642391026
loss_pred:0.017070837318897247, decouple_loss:0.0010396870784461498
Iteration: 376, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45017117261886597, gen p mean: -0.04723869264125824, mean p set: 0.4506514370441437
loss_pred:0.016611851751804352, decouple_loss:0.0011251579271629453
The modified gen p mean: 0.450303316116333, gen p mean: -0.046885862946510315, mean p set: 0.4507836401462555The modified gen p mean: 0.45070236921310425, gen p mean: -0.040879711508750916, mean p set: 0.45118266344070435
loss_pred:0.01719822734594345, decouple_loss:0.001075149979442358
loss_pred:0.01707015186548233, decouple_loss:0.001122541492804885
Iteration: 377, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45277726650238037, gen p mean: -0.04456472396850586, mean p set: 0.45325756072998047
loss_pred:0.016270654276013374, decouple_loss:0.0013638964155688882
The modified gen p mean: 0.451749712228775, gen p mean: -0.04509345814585686, mean p set: 0.45222997665405273The modified gen p mean: 0.44804269075393677, gen p mean: -0.0466158427298069, mean p set: 0.44852298498153687
loss_pred:0.01701950468122959, decouple_loss:0.0011839643120765686
loss_pred:0.01726245880126953, decouple_loss:0.0012743723345920444
Iteration: 378, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44935178756713867, gen p mean: -0.043651022017002106, mean p set: 0.44983211159706116
loss_pred:0.016287950798869133, decouple_loss:0.0011243377812206745
The modified gen p mean: 0.45148998498916626, gen p mean: -0.048022691160440445, mean p set: 0.45197030901908875The modified gen p mean: 0.4494902491569519, gen p mean: -0.03864338994026184, mean p set: 0.4499705135822296
loss_pred:0.017172764986753464, decouple_loss:0.001065707765519619
loss_pred:0.016213634982705116, decouple_loss:0.0010766071500256658
Iteration: 379, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508529305458069, gen p mean: -0.04848889261484146, mean p set: 0.451333224773407
loss_pred:0.016334017738699913, decouple_loss:0.0012479881988838315
The modified gen p mean: 0.44866201281547546, gen p mean: -0.04484305903315544, mean p set: 0.44914230704307556The modified gen p mean: 0.45090603828430176, gen p mean: -0.051178090274333954, mean p set: 0.45138633251190186
loss_pred:0.016461847350001335, decouple_loss:0.0010695583187043667
loss_pred:0.016390075907111168, decouple_loss:0.0012736428761854768
Iteration: 380, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497639238834381, gen p mean: -0.05189986154437065, mean p set: 0.4502442479133606
loss_pred:0.016636963933706284, decouple_loss:0.0011265194043517113
The modified gen p mean: 0.4496780037879944, gen p mean: -0.04254567623138428, mean p set: 0.4501582682132721The modified gen p mean: 0.4509352147579193, gen p mean: -0.05245453119277954, mean p set: 0.4514155387878418
loss_pred:0.01621515303850174, decouple_loss:0.0011121687712147832
loss_pred:0.0164595078676939, decouple_loss:0.0010521685471758246
2023-05-02 04:10:00 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.054660774767398834, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04958875849843025, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.04998117685317993, mean p set: 0.4500633478164673
loss_pred:0.018357187509536743, decouple_loss:0.0012423580046743155
loss_pred:0.017275815829634666, decouple_loss:0.001281853998079896
loss_pred:0.01737542264163494, decouple_loss:0.001312371576204896
WV_0_PC_1_EH_0_PS_40, loss: 0.017733419314026833, avg_mse: 0.025428669527173042
current test mse: 0.025429
Iteration: 381, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511845111846924, gen p mean: -0.05178425833582878, mean p set: 0.4516648054122925
The modified gen p mean: 0.45035213232040405, gen p mean: -0.04907544329762459, mean p set: 0.45083242654800415
The modified gen p mean: 0.4490574598312378, gen p mean: -0.05217030644416809, mean p set: 0.4495377540588379
loss_pred:0.01620219647884369, decouple_loss:0.001093601225875318
loss_pred:0.015768516808748245, decouple_loss:0.0011434314073994756loss_pred:0.0165267251431942, decouple_loss:0.0010183068225160241
Iteration: 382, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498998820781708, gen p mean: -0.05245806276798248, mean p set: 0.4503801465034485
loss_pred:0.016303880140185356, decouple_loss:0.0011573692318052053
The modified gen p mean: 0.45089441537857056, gen p mean: -0.048709481954574585, mean p set: 0.45137470960617065The modified gen p mean: 0.4501718282699585, gen p mean: -0.04354427754878998, mean p set: 0.4506521224975586
loss_pred:0.016743609681725502, decouple_loss:0.0010676563251763582
loss_pred:0.01763715222477913, decouple_loss:0.001075170235708356
Iteration: 383, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513542652130127, gen p mean: -0.042977474629879, mean p set: 0.4518345892429352
loss_pred:0.01678233966231346, decouple_loss:0.001050821621902287
The modified gen p mean: 0.4514182209968567, gen p mean: -0.050136417150497437, mean p set: 0.4518985152244568The modified gen p mean: 0.4496941566467285, gen p mean: -0.05232683941721916, mean p set: 0.4501744508743286
loss_pred:0.01630503125488758, decouple_loss:0.001008673687465489
loss_pred:0.01664472371339798, decouple_loss:0.001000830321572721
Iteration: 384, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45249879360198975, gen p mean: -0.043045077472925186, mean p set: 0.45297905802726746
loss_pred:0.017420480027794838, decouple_loss:0.0010875085135921836
The modified gen p mean: 0.44956615567207336, gen p mean: -0.04981395974755287, mean p set: 0.4500464200973511The modified gen p mean: 0.4484054744243622, gen p mean: -0.04479179158806801, mean p set: 0.4488857686519623
loss_pred:0.016355231404304504, decouple_loss:0.001011865446344018
loss_pred:0.0174790620803833, decouple_loss:0.001216501579619944
Iteration: 385, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513772428035736, gen p mean: -0.04015347361564636, mean p set: 0.4518575668334961
loss_pred:0.01727110706269741, decouple_loss:0.0009802785934880376
The modified gen p mean: 0.4502318203449249, gen p mean: -0.03990998491644859, mean p set: 0.4507121443748474The modified gen p mean: 0.45285534858703613, gen p mean: -0.043837495148181915, mean p set: 0.45333564281463623
loss_pred:0.016152838245034218, decouple_loss:0.0009472461533732712
loss_pred:0.015609659254550934, decouple_loss:0.0011152441147714853
Iteration: 386, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448230504989624, gen p mean: -0.038922447711229324, mean p set: 0.4487107992172241
loss_pred:0.01700151152908802, decouple_loss:0.0009943145560100675
The modified gen p mean: 0.4515188932418823, gen p mean: -0.040672123432159424, mean p set: 0.4519991874694824The modified gen p mean: 0.4486974775791168, gen p mean: -0.042411550879478455, mean p set: 0.4491777718067169
loss_pred:0.017568964511156082, decouple_loss:0.001244644052349031
loss_pred:0.016415337100625038, decouple_loss:0.00118417723570019
Iteration: 387, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45122775435447693, gen p mean: -0.04450896754860878, mean p set: 0.4517081081867218
loss_pred:0.017338575795292854, decouple_loss:0.0010220989352092147
The modified gen p mean: 0.45244041085243225, gen p mean: -0.040172163397073746, mean p set: 0.45292070508003235The modified gen p mean: 0.4506523609161377, gen p mean: -0.03724304214119911, mean p set: 0.4511326253414154
loss_pred:0.01739785075187683, decouple_loss:0.0010103443637490273
loss_pred:0.017621224746108055, decouple_loss:0.0011099274270236492
Iteration: 388, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487243592739105, gen p mean: -0.04028069227933884, mean p set: 0.4492046535015106
loss_pred:0.017217300832271576, decouple_loss:0.0011677378788590431
The modified gen p mean: 0.45077523589134216, gen p mean: -0.04466899111866951, mean p set: 0.4512555003166199The modified gen p mean: 0.45008784532546997, gen p mean: -0.03954305872321129, mean p set: 0.45056816935539246
loss_pred:0.017346207052469254, decouple_loss:0.001180216670036316
loss_pred:0.01677621342241764, decouple_loss:0.0011496151564642787
Iteration: 389, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45324620604515076, gen p mean: -0.04506519436836243, mean p set: 0.45372650027275085
loss_pred:0.015490694902837276, decouple_loss:0.0011940165422856808
The modified gen p mean: 0.45195165276527405, gen p mean: -0.042625706642866135, mean p set: 0.45243194699287415The modified gen p mean: 0.4500799775123596, gen p mean: -0.04573996737599373, mean p set: 0.45056024193763733
loss_pred:0.017292017117142677, decouple_loss:0.0012694906909018755
loss_pred:0.01687769964337349, decouple_loss:0.0012370378244668245
Iteration: 390, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45093390345573425, gen p mean: -0.050965070724487305, mean p set: 0.45141419768333435
loss_pred:0.01695830747485161, decouple_loss:0.00107577966991812
The modified gen p mean: 0.4507392644882202, gen p mean: -0.047135885804891586, mean p set: 0.4512195587158203The modified gen p mean: 0.4524685740470886, gen p mean: -0.04705177992582321, mean p set: 0.4529488980770111
loss_pred:0.017311830073595047, decouple_loss:0.0011488486779853702
loss_pred:0.01640060357749462, decouple_loss:0.001027173944748938
2023-05-02 04:11:54 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.056486502289772034, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.0513899140059948, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.051692795008420944, mean p set: 0.4500633478164673
loss_pred:0.018395135179162025, decouple_loss:0.0012419386766850948
loss_pred:0.01734420843422413, decouple_loss:0.001191818155348301
loss_pred:0.017467226833105087, decouple_loss:0.001279576332308352
WV_0_PC_1_EH_0_PS_40, loss: 0.01779741235077381, avg_mse: 0.025567928329110146
current test mse: 0.025568
Iteration: 391, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45074790716171265, gen p mean: -0.05086374282836914, mean p set: 0.45122823119163513
The modified gen p mean: 0.45035824179649353, gen p mean: -0.05282244086265564, mean p set: 0.450838565826416
The modified gen p mean: 0.45143282413482666, gen p mean: -0.05552515760064125, mean p set: 0.45191308856010437
loss_pred:0.01631050743162632, decouple_loss:0.0011494269128888845
loss_pred:0.01756424456834793, decouple_loss:0.0012780451215803623
loss_pred:0.017391318455338478, decouple_loss:0.0012444230960682034
Iteration: 392, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4517655074596405, gen p mean: -0.049048904329538345, mean p set: 0.4522458016872406
loss_pred:0.017543328925967216, decouple_loss:0.0009726149146445096
The modified gen p mean: 0.4508698880672455, gen p mean: -0.0463780015707016, mean p set: 0.4513501822948456The modified gen p mean: 0.4512171447277069, gen p mean: -0.05175694450736046, mean p set: 0.451697438955307
loss_pred:0.016963768750429153, decouple_loss:0.0010938195046037436
loss_pred:0.017273616045713425, decouple_loss:0.001041498500853777
Iteration: 393, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501558840274811, gen p mean: -0.05606832727789879, mean p set: 0.4506361782550812
loss_pred:0.016808385029435158, decouple_loss:0.001232309965416789
The modified gen p mean: 0.4518306851387024, gen p mean: -0.05405735224485397, mean p set: 0.4523109793663025The modified gen p mean: 0.4507633149623871, gen p mean: -0.0549621656537056, mean p set: 0.4512436091899872
loss_pred:0.016437754034996033, decouple_loss:0.0012173865688964725
loss_pred:0.017158793285489082, decouple_loss:0.0012953695841133595
Iteration: 394, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44978851079940796, gen p mean: -0.05131468176841736, mean p set: 0.45026880502700806
loss_pred:0.01647793874144554, decouple_loss:0.0010680928826332092
The modified gen p mean: 0.4499867856502533, gen p mean: -0.05285044386982918, mean p set: 0.4504671096801758The modified gen p mean: 0.4526841342449188, gen p mean: -0.049947720021009445, mean p set: 0.4531644284725189
loss_pred:0.016510173678398132, decouple_loss:0.0011260327883064747
loss_pred:0.015832478180527687, decouple_loss:0.00108164397533983
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012013_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012013_3_24hr.npz
NaN value num: 0
Iteration: 395, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44859418272972107, gen p mean: -0.044341228902339935, mean p set: 0.4490744471549988
loss_pred:0.016003716737031937, decouple_loss:0.0010903296060860157
The modified gen p mean: 0.4505457878112793, gen p mean: -0.040727123618125916, mean p set: 0.4510261118412018The modified gen p mean: 0.45007219910621643, gen p mean: -0.041157159954309464, mean p set: 0.45055249333381653
loss_pred:0.015428004786372185, decouple_loss:0.0011684574419632554
loss_pred:0.01522183045744896, decouple_loss:0.001184386550448835
Iteration: 396, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44859281182289124, gen p mean: -0.03962167724967003, mean p set: 0.44907310605049133
loss_pred:0.016225352883338928, decouple_loss:0.0010423815110698342
The modified gen p mean: 0.447441041469574, gen p mean: -0.04160737618803978, mean p set: 0.4479213356971741The modified gen p mean: 0.4474096894264221, gen p mean: -0.042285531759262085, mean p set: 0.44788995385169983
loss_pred:0.015201582573354244, decouple_loss:0.0011477145599201322
loss_pred:0.015225691720843315, decouple_loss:0.0011059064418077469
Iteration: 397, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45001155138015747, gen p mean: -0.0413164459168911, mean p set: 0.45049184560775757
loss_pred:0.016340207308530807, decouple_loss:0.0012838924303650856
The modified gen p mean: 0.4498942792415619, gen p mean: -0.03499782457947731, mean p set: 0.4503746032714844The modified gen p mean: 0.4506209194660187, gen p mean: -0.03507177159190178, mean p set: 0.4511011838912964
loss_pred:0.015911269932985306, decouple_loss:0.0012925313785672188
loss_pred:0.01606564223766327, decouple_loss:0.0013729013735428452
Iteration: 398, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44818419218063354, gen p mean: -0.038291264325380325, mean p set: 0.44866451621055603
loss_pred:0.015466727316379547, decouple_loss:0.0010774724651128054
The modified gen p mean: 0.4474698603153229, gen p mean: -0.03729755058884621, mean p set: 0.447950154542923The modified gen p mean: 0.4481179416179657, gen p mean: -0.0335000604391098, mean p set: 0.4485982656478882
loss_pred:0.01581222377717495, decouple_loss:0.0010692805517464876
loss_pred:0.01657106727361679, decouple_loss:0.0010682527208700776
Iteration: 399, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45013856887817383, gen p mean: -0.037298306822776794, mean p set: 0.4506188929080963
loss_pred:0.015550471842288971, decouple_loss:0.001162966014817357
The modified gen p mean: 0.44839757680892944, gen p mean: -0.03543327748775482, mean p set: 0.44887787103652954The modified gen p mean: 0.44747990369796753, gen p mean: -0.04042595997452736, mean p set: 0.4479601979255676
loss_pred:0.01639721915125847, decouple_loss:0.0012348615564405918
loss_pred:0.014635906554758549, decouple_loss:0.001303300610743463
Iteration: 400, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486122727394104, gen p mean: -0.03929390758275986, mean p set: 0.4490925371646881
loss_pred:0.01570243574678898, decouple_loss:0.0011556183453649282
The modified gen p mean: 0.45031341910362244, gen p mean: -0.035575587302446365, mean p set: 0.4507937431335449
The modified gen p mean: 0.44817742705345154, gen p mean: -0.035818811506032944, mean p set: 0.44865772128105164
loss_pred:0.015288343653082848, decouple_loss:0.0011122336145490408
loss_pred:0.015497860498726368, decouple_loss:0.0011423873947933316
2023-05-02 04:14:20 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.04879274591803551, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04385431483387947, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04418338090181351, mean p set: 0.4500633478164673
loss_pred:0.018624143674969673, decouple_loss:0.0012420893181115389
loss_pred:0.017652790993452072, decouple_loss:0.0011881939135491848loss_pred:0.017471054568886757, decouple_loss:0.0011321916244924068
WV_0_PC_1_EH_0_PS_40, loss: 0.017975371330976486, avg_mse: 0.02589241974055767
current test mse: 0.025892
Iteration: 401, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44791412353515625, gen p mean: -0.03903471305966377, mean p set: 0.44839444756507874
The modified gen p mean: 0.449121356010437, gen p mean: -0.03979591652750969, mean p set: 0.4496016502380371
The modified gen p mean: 0.44968751072883606, gen p mean: -0.03010982647538185, mean p set: 0.45016783475875854
loss_pred:0.015297800302505493, decouple_loss:0.0011244198540225625
loss_pred:0.015045971609652042, decouple_loss:0.0011289314134046435loss_pred:0.016129020601511, decouple_loss:0.001121831825003028
Iteration: 402, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447834849357605, gen p mean: -0.038620851933956146, mean p set: 0.4483151137828827
loss_pred:0.015819169580936432, decouple_loss:0.0012151029659435153
The modified gen p mean: 0.4498848617076874, gen p mean: -0.03957584872841835, mean p set: 0.4503651261329651The modified gen p mean: 0.44838863611221313, gen p mean: -0.04030231758952141, mean p set: 0.44886893033981323
loss_pred:0.015644362196326256, decouple_loss:0.0011185531038790941
loss_pred:0.015867561101913452, decouple_loss:0.0012379405088722706
Iteration: 403, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502808153629303, gen p mean: -0.04087985306978226, mean p set: 0.4507611393928528
loss_pred:0.016202401369810104, decouple_loss:0.0011346834944561124
The modified gen p mean: 0.45010942220687866, gen p mean: -0.040524836629629135, mean p set: 0.45058971643447876The modified gen p mean: 0.4500277042388916, gen p mean: -0.03885069489479065, mean p set: 0.4505079984664917
loss_pred:0.01511324755847454, decouple_loss:0.0009912444511428475
loss_pred:0.015142755582928658, decouple_loss:0.0010548373684287071
Iteration: 404, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481814205646515, gen p mean: -0.04439358785748482, mean p set: 0.4486616849899292
loss_pred:0.016439763829112053, decouple_loss:0.0013276905519887805
The modified gen p mean: 0.4497024118900299, gen p mean: -0.03745425492525101, mean p set: 0.4501826763153076The modified gen p mean: 0.44833803176879883, gen p mean: -0.042247261852025986, mean p set: 0.44881829619407654
loss_pred:0.014919433742761612, decouple_loss:0.0014071098994463682
loss_pred:0.015869438648223877, decouple_loss:0.0011884985724464059
Iteration: 405, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44847986102104187, gen p mean: -0.04061775282025337, mean p set: 0.44896015524864197
loss_pred:0.016432268545031548, decouple_loss:0.00115008105058223
The modified gen p mean: 0.4478377103805542, gen p mean: -0.04522611200809479, mean p set: 0.4483179748058319The modified gen p mean: 0.44774141907691956, gen p mean: -0.03793568164110184, mean p set: 0.44822174310684204
loss_pred:0.01567082107067108, decouple_loss:0.001085504307411611
loss_pred:0.016466496512293816, decouple_loss:0.0011908254818990827
Iteration: 406, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447145938873291, gen p mean: -0.0458575077354908, mean p set: 0.4476262331008911
loss_pred:0.014531949535012245, decouple_loss:0.0012986374786123633
The modified gen p mean: 0.4500086009502411, gen p mean: -0.038568466901779175, mean p set: 0.4504888951778412The modified gen p mean: 0.45040223002433777, gen p mean: -0.04002026841044426, mean p set: 0.45088252425193787
loss_pred:0.015730073675513268, decouple_loss:0.001297416747547686
loss_pred:0.014831088483333588, decouple_loss:0.0012423718580976129
Iteration: 407, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507506787776947, gen p mean: -0.03899013623595238, mean p set: 0.4512310028076172
loss_pred:0.014621677808463573, decouple_loss:0.0011662902543321252
The modified gen p mean: 0.4484219253063202, gen p mean: -0.036545295268297195, mean p set: 0.4489021897315979The modified gen p mean: 0.45023879408836365, gen p mean: -0.03934028744697571, mean p set: 0.45071908831596375
loss_pred:0.015300057828426361, decouple_loss:0.0011439047520980239
loss_pred:0.015852374956011772, decouple_loss:0.0012904144823551178
Iteration: 408, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44965460896492004, gen p mean: -0.03096691705286503, mean p set: 0.45013487339019775
loss_pred:0.015602286905050278, decouple_loss:0.0010990208247676492
The modified gen p mean: 0.4477819502353668, gen p mean: -0.03320934623479843, mean p set: 0.44826221466064453The modified gen p mean: 0.45067405700683594, gen p mean: -0.0340799018740654, mean p set: 0.45115435123443604
loss_pred:0.016275843605399132, decouple_loss:0.0012422387953847647
loss_pred:0.0160857941955328, decouple_loss:0.0012068854412063956
Iteration: 409, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44778764247894287, gen p mean: -0.03734423220157623, mean p set: 0.4482679069042206
loss_pred:0.015656571835279465, decouple_loss:0.0012271218001842499
The modified gen p mean: 0.4497668147087097, gen p mean: -0.033107690513134, mean p set: 0.4502470791339874The modified gen p mean: 0.45033779740333557, gen p mean: -0.03350452706217766, mean p set: 0.45081809163093567
loss_pred:0.016095157712697983, decouple_loss:0.0012499385047703981
loss_pred:0.015513976104557514, decouple_loss:0.0014304349897429347
Iteration: 410, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44734182953834534, gen p mean: -0.034390129148960114, mean p set: 0.44782212376594543
loss_pred:0.015900202095508575, decouple_loss:0.0011815405450761318
The modified gen p mean: 0.4473850131034851, gen p mean: -0.032171331346035004, mean p set: 0.4478653073310852
The modified gen p mean: 0.44752296805381775, gen p mean: -0.03603244200348854, mean p set: 0.44800323247909546
loss_pred:0.015870966017246246, decouple_loss:0.0011959041003137827
loss_pred:0.015581419691443443, decouple_loss:0.001133437966927886
2023-05-02 04:16:14 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.04615555331110954, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.041750796139240265, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.041742950677871704, mean p set: 0.4500633478164673
loss_pred:0.01874404400587082, decouple_loss:0.0013122976524755359
loss_pred:0.017572306096553802, decouple_loss:0.0012111420510336757
loss_pred:0.017731821164488792, decouple_loss:0.0012448456836864352
WV_0_PC_1_EH_0_PS_40, loss: 0.018078861758112907, avg_mse: 0.02607784792780876
current test mse: 0.026078
Iteration: 411, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498419165611267, gen p mean: -0.03495493531227112, mean p set: 0.4503222107887268
The modified gen p mean: 0.450177401304245, gen p mean: -0.035039108246564865, mean p set: 0.4506576955318451The modified gen p mean: 0.4489588439464569, gen p mean: -0.036651890724897385, mean p set: 0.449439138174057
loss_pred:0.01553041860461235, decouple_loss:0.0010649400064721704
loss_pred:0.0155428946018219, decouple_loss:0.0011572112562134862
loss_pred:0.015274060890078545, decouple_loss:0.001139983767643571
Iteration: 412, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44726619124412537, gen p mean: -0.04060874879360199, mean p set: 0.44774648547172546
loss_pred:0.01465578842908144, decouple_loss:0.0011949747567996383
The modified gen p mean: 0.44850990176200867, gen p mean: -0.04170394316315651, mean p set: 0.44899022579193115The modified gen p mean: 0.45012199878692627, gen p mean: -0.04179725795984268, mean p set: 0.45060229301452637
loss_pred:0.015083344653248787, decouple_loss:0.0010937053011730313
loss_pred:0.015272275544703007, decouple_loss:0.001242640893906355
Iteration: 413, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502868950366974, gen p mean: -0.035876914858818054, mean p set: 0.4507671892642975
loss_pred:0.01556867640465498, decouple_loss:0.0011270930990576744
The modified gen p mean: 0.4506320655345917, gen p mean: -0.036418039351701736, mean p set: 0.45111238956451416The modified gen p mean: 0.44985494017601013, gen p mean: -0.0328754298388958, mean p set: 0.45033523440361023
loss_pred:0.015617857687175274, decouple_loss:0.001231365604326129
loss_pred:0.01604418270289898, decouple_loss:0.0012828392209485173
Iteration: 414, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483879804611206, gen p mean: -0.03850361332297325, mean p set: 0.4488682746887207
loss_pred:0.014808323234319687, decouple_loss:0.0011652498506009579
The modified gen p mean: 0.44942229986190796, gen p mean: -0.042550865560770035, mean p set: 0.44990259408950806The modified gen p mean: 0.44900307059288025, gen p mean: -0.03940736502408981, mean p set: 0.44948336482048035
loss_pred:0.015313856303691864, decouple_loss:0.0010104825487360358
loss_pred:0.016048913821578026, decouple_loss:0.001074950210750103
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012017_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012017_3_24hr.npz
NaN value num: 0
Iteration: 415, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45013341307640076, gen p mean: -0.036037541925907135, mean p set: 0.45061367750167847
loss_pred:0.0162192489951849, decouple_loss:0.0012362264096736908
The modified gen p mean: 0.45138242840766907, gen p mean: -0.03621712699532509, mean p set: 0.4518626928329468The modified gen p mean: 0.4513818025588989, gen p mean: -0.037601035088300705, mean p set: 0.45186206698417664
loss_pred:0.016119644045829773, decouple_loss:0.0012380267726257443
loss_pred:0.01676143892109394, decouple_loss:0.0011780158383771777
Iteration: 416, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.451567679643631, gen p mean: -0.0370204783976078, mean p set: 0.4520479440689087
loss_pred:0.015560746192932129, decouple_loss:0.0012114888522773981
The modified gen p mean: 0.45000511407852173, gen p mean: -0.038455575704574585, mean p set: 0.4504854083061218The modified gen p mean: 0.4512491226196289, gen p mean: -0.03665195405483246, mean p set: 0.451729416847229
loss_pred:0.016415556892752647, decouple_loss:0.0012166335945948958
loss_pred:0.016672683879733086, decouple_loss:0.001225807936862111
Iteration: 417, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45201826095581055, gen p mean: -0.04033278673887253, mean p set: 0.45249855518341064
loss_pred:0.016323892399668694, decouple_loss:0.0010995251359418035
The modified gen p mean: 0.45196521282196045, gen p mean: -0.048005811870098114, mean p set: 0.45244550704956055The modified gen p mean: 0.45300528407096863, gen p mean: -0.038910161703825, mean p set: 0.4534855782985687
loss_pred:0.015257815830409527, decouple_loss:0.0010873539140447974
loss_pred:0.01616796851158142, decouple_loss:0.001144369482062757
Iteration: 418, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44973111152648926, gen p mean: -0.0390513576567173, mean p set: 0.45021140575408936
loss_pred:0.01616550050675869, decouple_loss:0.0011855985503643751
The modified gen p mean: 0.4512441158294678, gen p mean: -0.03977638855576515, mean p set: 0.45172441005706787The modified gen p mean: 0.45171889662742615, gen p mean: -0.04162485525012016, mean p set: 0.45219916105270386
loss_pred:0.016777586191892624, decouple_loss:0.0011789518175646663
loss_pred:0.01642025262117386, decouple_loss:0.0011707907542586327
Iteration: 419, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505445659160614, gen p mean: -0.04166455566883087, mean p set: 0.4510248601436615
The modified gen p mean: 0.4516770541667938, gen p mean: -0.042030032724142075, mean p set: 0.4521573483943939
loss_pred:0.016022097319364548, decouple_loss:0.0011050282046198845
loss_pred:0.01632414385676384, decouple_loss:0.0011818584753200412
The modified gen p mean: 0.4515107274055481, gen p mean: -0.042633283883333206, mean p set: 0.4519910514354706
loss_pred:0.015860527753829956, decouple_loss:0.001123332534916699
Iteration: 420, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4527052342891693, gen p mean: -0.041806451976299286, mean p set: 0.4531855285167694
loss_pred:0.016154080629348755, decouple_loss:0.0012230026768520474
The modified gen p mean: 0.45161569118499756, gen p mean: -0.041176360100507736, mean p set: 0.45209604501724243The modified gen p mean: 0.45119526982307434, gen p mean: -0.042053770273923874, mean p set: 0.4516755938529968
loss_pred:0.016075756400823593, decouple_loss:0.001138638355769217
loss_pred:0.015915697440505028, decouple_loss:0.0011474266648292542
2023-05-02 04:18:41 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.05363944172859192, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.049188125878572464, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.04946369677782059, mean p set: 0.4500633478164673
loss_pred:0.01858774945139885, decouple_loss:0.001260656164959073
loss_pred:0.01742774248123169, decouple_loss:0.0011458925437182188
loss_pred:0.017644474282860756, decouple_loss:0.0012007422046735883
WV_0_PC_1_EH_0_PS_40, loss: 0.017946777865290642, avg_mse: 0.025841014459729195
current test mse: 0.025841
Iteration: 421, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4522381126880646, gen p mean: -0.040592823177576065, mean p set: 0.4527184069156647
The modified gen p mean: 0.4510997235774994, gen p mean: -0.04150872305035591, mean p set: 0.4515799880027771
The modified gen p mean: 0.45163705945014954, gen p mean: -0.03979590907692909, mean p set: 0.45211732387542725
loss_pred:0.01602316088974476, decouple_loss:0.001133810030296445
loss_pred:0.015918241813778877, decouple_loss:0.0010986020788550377loss_pred:0.016210557892918587, decouple_loss:0.001119409454986453
Iteration: 422, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505527913570404, gen p mean: -0.04010641574859619, mean p set: 0.4510330855846405
loss_pred:0.015863172709941864, decouple_loss:0.0011307834647595882
The modified gen p mean: 0.45136523246765137, gen p mean: -0.04337487742304802, mean p set: 0.4518454968929291The modified gen p mean: 0.4526066780090332, gen p mean: -0.0428142324090004, mean p set: 0.4530870020389557
loss_pred:0.01579541712999344, decouple_loss:0.0011007256107404828
loss_pred:0.01574564538896084, decouple_loss:0.0011335902381688356
Iteration: 423, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4521905481815338, gen p mean: -0.04361725598573685, mean p set: 0.4526708424091339
loss_pred:0.01597467251121998, decouple_loss:0.0010695598321035504
The modified gen p mean: 0.4500552713871002, gen p mean: -0.04263465851545334, mean p set: 0.45053553581237793The modified gen p mean: 0.452006995677948, gen p mean: -0.04228058457374573, mean p set: 0.4524872899055481
loss_pred:0.015663525089621544, decouple_loss:0.0011546147288754582
loss_pred:0.01631559431552887, decouple_loss:0.001084475195966661
Iteration: 424, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505494236946106, gen p mean: -0.046576499938964844, mean p set: 0.4510296881198883
loss_pred:0.01627681776881218, decouple_loss:0.001097315107472241
The modified gen p mean: 0.45184701681137085, gen p mean: -0.04627992585301399, mean p set: 0.4523273706436157The modified gen p mean: 0.4515424966812134, gen p mean: -0.04736298695206642, mean p set: 0.4520227611064911
loss_pred:0.015727246180176735, decouple_loss:0.0011873389594256878
loss_pred:0.015726836398243904, decouple_loss:0.001087530399672687
Iteration: 425, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45214712619781494, gen p mean: -0.04927588254213333, mean p set: 0.45262742042541504
loss_pred:0.01590532623231411, decouple_loss:0.0010901326313614845
The modified gen p mean: 0.4494275450706482, gen p mean: -0.04377572983503342, mean p set: 0.4499078094959259The modified gen p mean: 0.45215368270874023, gen p mean: -0.044362615793943405, mean p set: 0.4526340067386627
loss_pred:0.015798673033714294, decouple_loss:0.0012179730692878366
loss_pred:0.015986936166882515, decouple_loss:0.0010740376310423017
Iteration: 426, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513913691043854, gen p mean: -0.04680899530649185, mean p set: 0.4518716335296631
loss_pred:0.015679236501455307, decouple_loss:0.0009961846517398953
The modified gen p mean: 0.4519518315792084, gen p mean: -0.0458795391023159, mean p set: 0.45243212580680847The modified gen p mean: 0.45157450437545776, gen p mean: -0.048045527189970016, mean p set: 0.45205479860305786
loss_pred:0.015563826076686382, decouple_loss:0.0011439408408477902
loss_pred:0.01536548137664795, decouple_loss:0.0011686066864058375
Iteration: 427, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45116686820983887, gen p mean: -0.0484684519469738, mean p set: 0.45164716243743896
loss_pred:0.01566334255039692, decouple_loss:0.0011773505248129368
The modified gen p mean: 0.4520340859889984, gen p mean: -0.04592416062951088, mean p set: 0.4525144100189209The modified gen p mean: 0.45214730501174927, gen p mean: -0.04224168509244919, mean p set: 0.452627569437027
loss_pred:0.01596131920814514, decouple_loss:0.0012078039580956101
loss_pred:0.016295848414301872, decouple_loss:0.0013956554466858506
Iteration: 428, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45213308930397034, gen p mean: -0.0464104525744915, mean p set: 0.45261338353157043
loss_pred:0.016260022297501564, decouple_loss:0.0009929697262123227
The modified gen p mean: 0.45151954889297485, gen p mean: -0.04508855938911438, mean p set: 0.45199981331825256The modified gen p mean: 0.4515998959541321, gen p mean: -0.04643926024436951, mean p set: 0.45208021998405457
loss_pred:0.015437544323503971, decouple_loss:0.0010431684786453843
loss_pred:0.016026655212044716, decouple_loss:0.0010034958831965923
Iteration: 429, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496256113052368, gen p mean: -0.04423980414867401, mean p set: 0.4501059055328369
loss_pred:0.01607334241271019, decouple_loss:0.0011962952557951212
The modified gen p mean: 0.45209887623786926, gen p mean: -0.04600102826952934, mean p set: 0.452579140663147The modified gen p mean: 0.4515809118747711, gen p mean: -0.045810382813215256, mean p set: 0.4520612061023712
loss_pred:0.016178620979189873, decouple_loss:0.00102606147993356
loss_pred:0.01596297137439251, decouple_loss:0.0011515102814882994
Iteration: 430, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4518471956253052, gen p mean: -0.049576789140701294, mean p set: 0.4523274898529053
loss_pred:0.01569598726928234, decouple_loss:0.001074685133062303
The modified gen p mean: 0.4508665204048157, gen p mean: -0.04974495992064476, mean p set: 0.45134681463241577The modified gen p mean: 0.45156458020210266, gen p mean: -0.043761733919382095, mean p set: 0.45204487442970276
loss_pred:0.015343034639954567, decouple_loss:0.0011606597108766437
loss_pred:0.015199697576463223, decouple_loss:0.0010532715823501348
2023-05-02 04:20:36 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.056508179754018784, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.05215166136622429, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.05241154506802559, mean p set: 0.4500633478164673
loss_pred:0.01851690746843815, decouple_loss:0.001276281545870006
loss_pred:0.017445314675569534, decouple_loss:0.0011961020063608885
loss_pred:0.017599087208509445, decouple_loss:0.0012612794525921345
WV_0_PC_1_EH_0_PS_40, loss: 0.01791599951684475, avg_mse: 0.02580617554485798
current test mse: 0.025806
Iteration: 431, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4525078535079956, gen p mean: -0.04088638722896576, mean p set: 0.4529881477355957
The modified gen p mean: 0.4520275294780731, gen p mean: -0.04706776142120361, mean p set: 0.4525078237056732
The modified gen p mean: 0.4521413743495941, gen p mean: -0.04276265949010849, mean p set: 0.4526216387748718
loss_pred:0.01606033742427826, decouple_loss:0.0010570710292086005
loss_pred:0.01602274738252163, decouple_loss:0.0012865647440776229
loss_pred:0.01576930098235607, decouple_loss:0.0011262447806075215
Iteration: 432, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45160794258117676, gen p mean: -0.0430862195789814, mean p set: 0.45208823680877686
loss_pred:0.015313074924051762, decouple_loss:0.001178156933747232
The modified gen p mean: 0.4523071050643921, gen p mean: -0.042281705886125565, mean p set: 0.4527874290943146The modified gen p mean: 0.4520478844642639, gen p mean: -0.0512978695333004, mean p set: 0.4525282084941864
loss_pred:0.01488166581839323, decouple_loss:0.00119276181794703
loss_pred:0.01595294661819935, decouple_loss:0.0011061544064432383
Iteration: 433, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45109444856643677, gen p mean: -0.04193118214607239, mean p set: 0.45157474279403687
loss_pred:0.01571343094110489, decouple_loss:0.0012248227139934897
The modified gen p mean: 0.45136353373527527, gen p mean: -0.04424341395497322, mean p set: 0.45184382796287537The modified gen p mean: 0.4511058032512665, gen p mean: -0.045625410974025726, mean p set: 0.4515860676765442
loss_pred:0.01532062143087387, decouple_loss:0.0011760889319702983
loss_pred:0.015229379758238792, decouple_loss:0.0012447703629732132
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012009_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012009_3_24hr.npz
NaN value num: 0
Iteration: 434, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469071924686432, gen p mean: -0.05011606588959694, mean p set: 0.4473875164985657
loss_pred:0.01831045188009739, decouple_loss:0.0012118056183680892
The modified gen p mean: 0.44672462344169617, gen p mean: -0.05169481784105301, mean p set: 0.44720491766929626The modified gen p mean: 0.4473632574081421, gen p mean: -0.05165501683950424, mean p set: 0.4478435218334198
loss_pred:0.01814560405910015, decouple_loss:0.0012243477394804358
loss_pred:0.018023943528532982, decouple_loss:0.0012123888591304421
Iteration: 435, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465142488479614, gen p mean: -0.04799696058034897, mean p set: 0.4469945430755615
loss_pred:0.017822811380028725, decouple_loss:0.0012328188167884946
The modified gen p mean: 0.4470256268978119, gen p mean: -0.04930470138788223, mean p set: 0.4475059509277344The modified gen p mean: 0.44800692796707153, gen p mean: -0.04530876502394676, mean p set: 0.44848722219467163
loss_pred:0.018090732395648956, decouple_loss:0.0011946874437853694
loss_pred:0.01723095402121544, decouple_loss:0.0012277141213417053
Iteration: 436, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44769012928009033, gen p mean: -0.05012322962284088, mean p set: 0.44817039370536804
loss_pred:0.017327161505818367, decouple_loss:0.0011443201219663024
The modified gen p mean: 0.44652819633483887, gen p mean: -0.049837369471788406, mean p set: 0.44700849056243896The modified gen p mean: 0.4475644528865814, gen p mean: -0.04771991819143295, mean p set: 0.4480447769165039
loss_pred:0.017704539000988007, decouple_loss:0.0012041762238368392
loss_pred:0.01762359030544758, decouple_loss:0.0011106334859505296
Iteration: 437, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475695490837097, gen p mean: -0.05156556889414787, mean p set: 0.4480498135089874
loss_pred:0.01802390068769455, decouple_loss:0.0012717589270323515
The modified gen p mean: 0.44863221049308777, gen p mean: -0.05307481065392494, mean p set: 0.4491124749183655The modified gen p mean: 0.4481431543827057, gen p mean: -0.049136754125356674, mean p set: 0.4486234486103058
loss_pred:0.017508529126644135, decouple_loss:0.0012803375720977783
loss_pred:0.01777130737900734, decouple_loss:0.0011670335661619902
Iteration: 438, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448119193315506, gen p mean: -0.05969099700450897, mean p set: 0.4485994875431061
loss_pred:0.01750139519572258, decouple_loss:0.0012839867267757654
The modified gen p mean: 0.44686856865882874, gen p mean: -0.05111849308013916, mean p set: 0.44734886288642883The modified gen p mean: 0.4468706548213959, gen p mean: -0.04931805282831192, mean p set: 0.4473509192466736
loss_pred:0.017299802973866463, decouple_loss:0.0012581085320562124
loss_pred:0.018033845350146294, decouple_loss:0.001129103940911591
Iteration: 439, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44676363468170166, gen p mean: -0.05462547391653061, mean p set: 0.44724392890930176
loss_pred:0.017645763233304024, decouple_loss:0.0012401238782331347
The modified gen p mean: 0.4477561116218567, gen p mean: -0.05850522220134735, mean p set: 0.4482364058494568The modified gen p mean: 0.44692349433898926, gen p mean: -0.05561956390738487, mean p set: 0.44740378856658936
loss_pred:0.017070122063159943, decouple_loss:0.0013945694081485271
loss_pred:0.017602428793907166, decouple_loss:0.0012951975222676992
Iteration: 440, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473225772380829, gen p mean: -0.05867861956357956, mean p set: 0.44780290126800537
loss_pred:0.017916079610586166, decouple_loss:0.0010651082266122103
The modified gen p mean: 0.44688674807548523, gen p mean: -0.055143337696790695, mean p set: 0.44736701250076294The modified gen p mean: 0.44664105772972107, gen p mean: -0.054002586752176285, mean p set: 0.44712138175964355
loss_pred:0.018050970509648323, decouple_loss:0.0011120635317638516
loss_pred:0.017901649698615074, decouple_loss:0.0010959104401990771
2023-05-02 04:23:03 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.06002093851566315, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.05516650155186653, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.05556955933570862, mean p set: 0.4500633478164673
loss_pred:0.01842445321381092, decouple_loss:0.0012464970350265503
loss_pred:0.01740237884223461, decouple_loss:0.0012358446838334203
loss_pred:0.017491575330495834, decouple_loss:0.0012366622686386108
WV_0_PC_1_EH_0_PS_40, loss: 0.01783478632569313, avg_mse: 0.025578662753105164
current test mse: 0.025579
Iteration: 441, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491763114929199, gen p mean: -0.05918591842055321, mean p set: 0.4496566355228424
The modified gen p mean: 0.45010483264923096, gen p mean: -0.057635340839624405, mean p set: 0.45058512687683105
The modified gen p mean: 0.4482971429824829, gen p mean: -0.056293029338121414, mean p set: 0.4487774670124054
loss_pred:0.01673039421439171, decouple_loss:0.00118752580601722
loss_pred:0.01766197569668293, decouple_loss:0.0011607162887230515
loss_pred:0.01691891998052597, decouple_loss:0.0011713592102751136
Iteration: 442, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44609692692756653, gen p mean: -0.05447370186448097, mean p set: 0.446577250957489
loss_pred:0.017080536112189293, decouple_loss:0.001115925027988851
The modified gen p mean: 0.4457154870033264, gen p mean: -0.05366775020956993, mean p set: 0.4461957514286041The modified gen p mean: 0.44842782616615295, gen p mean: -0.057550422847270966, mean p set: 0.44890812039375305
loss_pred:0.016804087907075882, decouple_loss:0.0011432113824412227
loss_pred:0.017165297642350197, decouple_loss:0.0011872341856360435
Iteration: 443, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482758045196533, gen p mean: -0.051064930856227875, mean p set: 0.44875606894493103
loss_pred:0.016956999897956848, decouple_loss:0.0011687594233080745
The modified gen p mean: 0.4476662278175354, gen p mean: -0.05322354659438133, mean p set: 0.4481465220451355The modified gen p mean: 0.44661030173301697, gen p mean: -0.05611544847488403, mean p set: 0.4470905661582947
loss_pred:0.017810292541980743, decouple_loss:0.0011199887376278639
loss_pred:0.017189081758260727, decouple_loss:0.0012103032786399126
Iteration: 444, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44650033116340637, gen p mean: -0.05243249610066414, mean p set: 0.44698062539100647
loss_pred:0.018020397052168846, decouple_loss:0.001061958377249539
The modified gen p mean: 0.4494776129722595, gen p mean: -0.05547177419066429, mean p set: 0.449957937002182The modified gen p mean: 0.447566956281662, gen p mean: -0.05416775494813919, mean p set: 0.4480472505092621
loss_pred:0.01645573228597641, decouple_loss:0.0011371265863999724
loss_pred:0.017037123441696167, decouple_loss:0.001179079874418676
Iteration: 445, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476235508918762, gen p mean: -0.05244927480816841, mean p set: 0.44810381531715393
loss_pred:0.017858950421214104, decouple_loss:0.0011106678284704685
The modified gen p mean: 0.4480510652065277, gen p mean: -0.04771237075328827, mean p set: 0.4485313296318054The modified gen p mean: 0.44708481431007385, gen p mean: -0.05624627321958542, mean p set: 0.44756510853767395
loss_pred:0.017314402386546135, decouple_loss:0.000982522964477539
loss_pred:0.017061296850442886, decouple_loss:0.0010408498346805573
Iteration: 446, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44708743691444397, gen p mean: -0.05145509913563728, mean p set: 0.44756776094436646
loss_pred:0.01735471561551094, decouple_loss:0.0011445581912994385
The modified gen p mean: 0.4485849440097809, gen p mean: -0.05515921860933304, mean p set: 0.449065238237381The modified gen p mean: 0.4488506019115448, gen p mean: -0.0555107481777668, mean p set: 0.4493309259414673
loss_pred:0.01761532574892044, decouple_loss:0.001138183637522161
loss_pred:0.0174203272908926, decouple_loss:0.0011175943072885275
Iteration: 447, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474089741706848, gen p mean: -0.04947411268949509, mean p set: 0.4478892683982849
loss_pred:0.016964176669716835, decouple_loss:0.0011026894208043814
The modified gen p mean: 0.4484080970287323, gen p mean: -0.053426407277584076, mean p set: 0.4488883912563324The modified gen p mean: 0.4470927119255066, gen p mean: -0.05420354753732681, mean p set: 0.4475730061531067
loss_pred:0.017589261755347252, decouple_loss:0.001100827706977725
loss_pred:0.017310811206698418, decouple_loss:0.001063957461155951
Iteration: 448, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474196135997772, gen p mean: -0.05551992729306221, mean p set: 0.4478999078273773
loss_pred:0.018129032105207443, decouple_loss:0.001087758457288146
The modified gen p mean: 0.44786545634269714, gen p mean: -0.05047648027539253, mean p set: 0.44834578037261963The modified gen p mean: 0.4472569525241852, gen p mean: -0.056177087128162384, mean p set: 0.4477372169494629
loss_pred:0.017267579212784767, decouple_loss:0.0010812865803018212
loss_pred:0.01753179170191288, decouple_loss:0.0011287268716841936
Iteration: 449, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492039978504181, gen p mean: -0.05966523662209511, mean p set: 0.4496842920780182
loss_pred:0.016475383192300797, decouple_loss:0.0011104525765404105
The modified gen p mean: 0.44656431674957275, gen p mean: -0.05919931083917618, mean p set: 0.44704464077949524The modified gen p mean: 0.4471374452114105, gen p mean: -0.05530398711562157, mean p set: 0.4476177394390106
loss_pred:0.016683297231793404, decouple_loss:0.0010320435976609588
loss_pred:0.017013944685459137, decouple_loss:0.001053384505212307
Iteration: 450, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465080201625824, gen p mean: -0.06008899211883545, mean p set: 0.4469883143901825
loss_pred:0.017162730917334557, decouple_loss:0.0010572599712759256
The modified gen p mean: 0.44741904735565186, gen p mean: -0.05856924504041672, mean p set: 0.44789931178092957The modified gen p mean: 0.4464051425457001, gen p mean: -0.05518361181020737, mean p set: 0.44688549637794495
loss_pred:0.016963714733719826, decouple_loss:0.0011969637125730515
loss_pred:0.018744392320513725, decouple_loss:0.001239502802491188
2023-05-02 04:24:58 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.06192595884203911, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.05665448680520058, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.057326555252075195, mean p set: 0.4500633478164673
loss_pred:0.018324503675103188, decouple_loss:0.0010818280279636383
loss_pred:0.017300430685281754, decouple_loss:0.0011184033937752247
loss_pred:0.017430730164051056, decouple_loss:0.0010859782341867685
WV_0_PC_1_EH_0_PS_40, loss: 0.01773999258875847, avg_mse: 0.02545851096510887
current test mse: 0.025459
Iteration: 451, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44678249955177307, gen p mean: -0.057420697063207626, mean p set: 0.44726279377937317
The modified gen p mean: 0.4462997615337372, gen p mean: -0.057315658777952194, mean p set: 0.4467800557613373
The modified gen p mean: 0.44580331444740295, gen p mean: -0.05495220795273781, mean p set: 0.44628363847732544
loss_pred:0.01749163493514061, decouple_loss:0.0009956774301826954
loss_pred:0.017813704907894135, decouple_loss:0.0009708523284643888
loss_pred:0.01786612719297409, decouple_loss:0.0009873524541035295
Iteration: 452, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44856974482536316, gen p mean: -0.054217226803302765, mean p set: 0.44905006885528564
loss_pred:0.017252981662750244, decouple_loss:0.0012467188062146306
The modified gen p mean: 0.44796597957611084, gen p mean: -0.055749278515577316, mean p set: 0.44844627380371094The modified gen p mean: 0.4482744634151459, gen p mean: -0.05610577389597893, mean p set: 0.44875475764274597
loss_pred:0.01756688766181469, decouple_loss:0.0012141033075749874
loss_pred:0.017387645319104195, decouple_loss:0.0011492825578898191
Iteration: 453, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472668468952179, gen p mean: -0.062363479286432266, mean p set: 0.447747141122818
loss_pred:0.01742349937558174, decouple_loss:0.001162407104857266
The modified gen p mean: 0.447181761264801, gen p mean: -0.05424438789486885, mean p set: 0.4476620852947235The modified gen p mean: 0.44779491424560547, gen p mean: -0.058666765689849854, mean p set: 0.44827520847320557
loss_pred:0.017575908452272415, decouple_loss:0.0011318684555590153
loss_pred:0.017248887568712234, decouple_loss:0.0009828582406044006
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012012_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012012_3_24hr.npz
NaN value num: 0
Iteration: 454, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.452502965927124, gen p mean: -0.05105281248688698, mean p set: 0.4529832601547241
loss_pred:0.01524957362562418, decouple_loss:0.001400087377987802
The modified gen p mean: 0.4525713324546814, gen p mean: -0.05073324963450432, mean p set: 0.4530515968799591The modified gen p mean: 0.45019587874412537, gen p mean: -0.05097988620400429, mean p set: 0.45067617297172546
loss_pred:0.016260256990790367, decouple_loss:0.0012628788826987147
loss_pred:0.01554564107209444, decouple_loss:0.0012567911762744188
Iteration: 455, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502578377723694, gen p mean: -0.05397675186395645, mean p set: 0.4507381319999695
loss_pred:0.01576571725308895, decouple_loss:0.0011977878166362643
The modified gen p mean: 0.4503800570964813, gen p mean: -0.054023873060941696, mean p set: 0.4508603513240814The modified gen p mean: 0.4486158788204193, gen p mean: -0.05058583989739418, mean p set: 0.4490962028503418
loss_pred:0.016173021867871284, decouple_loss:0.0010832087136805058
loss_pred:0.016237545758485794, decouple_loss:0.0011078089009970427
Iteration: 456, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490496814250946, gen p mean: -0.05434746667742729, mean p set: 0.4495299756526947
loss_pred:0.01657080091536045, decouple_loss:0.0011695213615894318
The modified gen p mean: 0.44950199127197266, gen p mean: -0.049907784909009933, mean p set: 0.44998228549957275
The modified gen p mean: 0.44874173402786255, gen p mean: -0.055079154670238495, mean p set: 0.44922199845314026
loss_pred:0.016065502539277077, decouple_loss:0.0012320986716076732
loss_pred:0.015603996813297272, decouple_loss:0.0012175844749435782
Iteration: 457, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502831995487213, gen p mean: -0.051294103264808655, mean p set: 0.4507634937763214
loss_pred:0.016154078766703606, decouple_loss:0.0012507167411968112
The modified gen p mean: 0.4491751790046692, gen p mean: -0.05269084498286247, mean p set: 0.4496554732322693The modified gen p mean: 0.45037806034088135, gen p mean: -0.05436386168003082, mean p set: 0.45085835456848145
loss_pred:0.015908025205135345, decouple_loss:0.0013975598849356174
loss_pred:0.01592472568154335, decouple_loss:0.0011252537369728088
Iteration: 458, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501749277114868, gen p mean: -0.06065193936228752, mean p set: 0.4506552517414093
loss_pred:0.01629926636815071, decouple_loss:0.001445583999156952
The modified gen p mean: 0.4498424530029297, gen p mean: -0.052704211324453354, mean p set: 0.4503227472305298The modified gen p mean: 0.45145395398139954, gen p mean: -0.052432116121053696, mean p set: 0.45193424820899963
loss_pred:0.016147233545780182, decouple_loss:0.0013163022231310606
loss_pred:0.016450587660074234, decouple_loss:0.0013251743512228131
Iteration: 459, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493556320667267, gen p mean: -0.0555601492524147, mean p set: 0.4498359262943268
loss_pred:0.01569606550037861, decouple_loss:0.0013652589404955506
The modified gen p mean: 0.44853904843330383, gen p mean: -0.05791810527443886, mean p set: 0.4490193724632263The modified gen p mean: 0.44869574904441833, gen p mean: -0.051567573100328445, mean p set: 0.44917601346969604
loss_pred:0.015148741193115711, decouple_loss:0.0013720686547458172
loss_pred:0.015767330303788185, decouple_loss:0.0013082913355901837
Iteration: 460, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495808780193329, gen p mean: -0.056941475719213486, mean p set: 0.450061172246933
loss_pred:0.01634947396814823, decouple_loss:0.001292270259000361
The modified gen p mean: 0.44954437017440796, gen p mean: -0.04739726334810257, mean p set: 0.45002463459968567The modified gen p mean: 0.44999271631240845, gen p mean: -0.05201535299420357, mean p set: 0.45047301054000854
loss_pred:0.015409600920975208, decouple_loss:0.0012054282706230879
loss_pred:0.0162908136844635, decouple_loss:0.0014789784327149391
2023-05-02 04:27:30 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.05966266989707947, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.05465067923069, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.05509812757372856, mean p set: 0.4500633478164673
loss_pred:0.018636131659150124, decouple_loss:0.0013570392038673162
loss_pred:0.017579149454832077, decouple_loss:0.0012619083281606436
loss_pred:0.017695507034659386, decouple_loss:0.0013336132979020476
WV_0_PC_1_EH_0_PS_40, loss: 0.018036138266324997, avg_mse: 0.02598966471850872
current test mse: 0.02599
Iteration: 461, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500104784965515, gen p mean: -0.05424202233552933, mean p set: 0.4504907429218292
The modified gen p mean: 0.44925758242607117, gen p mean: -0.04698430001735687, mean p set: 0.44973790645599365
The modified gen p mean: 0.45023179054260254, gen p mean: -0.04765738546848297, mean p set: 0.45071205496788025
loss_pred:0.01611861027777195, decouple_loss:0.001281075761653483
loss_pred:0.016126420348882675, decouple_loss:0.0012941196328029037
loss_pred:0.01563333533704281, decouple_loss:0.001154875149950385
Iteration: 462, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497430920600891, gen p mean: -0.048960138112306595, mean p set: 0.4502233564853668
loss_pred:0.01541748084127903, decouple_loss:0.0011987561592832208
The modified gen p mean: 0.4503077566623688, gen p mean: -0.04586576297879219, mean p set: 0.45078805088996887The modified gen p mean: 0.4494835436344147, gen p mean: -0.04530720412731171, mean p set: 0.44996383786201477
loss_pred:0.015903253108263016, decouple_loss:0.0012661953223869205
loss_pred:0.016288163140416145, decouple_loss:0.0012117454316467047
Iteration: 463, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498305916786194, gen p mean: -0.03944031521677971, mean p set: 0.4503108859062195
loss_pred:0.015881091356277466, decouple_loss:0.0010716712567955256
The modified gen p mean: 0.4499151110649109, gen p mean: -0.05061504617333412, mean p set: 0.450395405292511The modified gen p mean: 0.4490959942340851, gen p mean: -0.04621781036257744, mean p set: 0.44957631826400757
loss_pred:0.015012769959867, decouple_loss:0.0011710585094988346
loss_pred:0.015796419233083725, decouple_loss:0.0013104839017614722
Iteration: 464, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4521687924861908, gen p mean: -0.041991595178842545, mean p set: 0.4526490569114685
loss_pred:0.015217900276184082, decouple_loss:0.0013609667075797915
The modified gen p mean: 0.45020461082458496, gen p mean: -0.04533814266324043, mean p set: 0.45068490505218506The modified gen p mean: 0.44941961765289307, gen p mean: -0.04427885264158249, mean p set: 0.44989991188049316
loss_pred:0.015716372057795525, decouple_loss:0.001357399974949658
loss_pred:0.0157462190836668, decouple_loss:0.0012686711270362139
Iteration: 465, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498869776725769, gen p mean: -0.04210713133215904, mean p set: 0.4503673017024994
loss_pred:0.014989469200372696, decouple_loss:0.0010946599068120122
The modified gen p mean: 0.4494783282279968, gen p mean: -0.05002371221780777, mean p set: 0.4499586224555969The modified gen p mean: 0.4500272572040558, gen p mean: -0.0485166572034359, mean p set: 0.4505075514316559
loss_pred:0.016295814886689186, decouple_loss:0.0012117077130824327
loss_pred:0.015415767207741737, decouple_loss:0.0011477329535409808
Iteration: 466, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45002520084381104, gen p mean: -0.0438094325363636, mean p set: 0.4505055248737335
loss_pred:0.015335732139647007, decouple_loss:0.0013198897941038013
The modified gen p mean: 0.4508987367153168, gen p mean: -0.03990284726023674, mean p set: 0.45137903094291687The modified gen p mean: 0.45165199041366577, gen p mean: -0.04587981477379799, mean p set: 0.45213228464126587
loss_pred:0.016450833529233932, decouple_loss:0.0012653073063120246
loss_pred:0.015099430456757545, decouple_loss:0.0012674774043262005
Iteration: 467, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4522729516029358, gen p mean: -0.044384751468896866, mean p set: 0.4527532756328583
loss_pred:0.015822231769561768, decouple_loss:0.0012771985493600368
The modified gen p mean: 0.4503837525844574, gen p mean: -0.04181978851556778, mean p set: 0.4508640468120575The modified gen p mean: 0.4533083140850067, gen p mean: -0.04589260742068291, mean p set: 0.4537885785102844
loss_pred:0.014587130397558212, decouple_loss:0.0012325559509918094
loss_pred:0.015385371632874012, decouple_loss:0.0011481463443487883
Iteration: 468, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488760232925415, gen p mean: -0.04358094185590744, mean p set: 0.4493563175201416
loss_pred:0.01592942140996456, decouple_loss:0.0011605082545429468
The modified gen p mean: 0.4493119716644287, gen p mean: -0.046415530145168304, mean p set: 0.4497922658920288The modified gen p mean: 0.45147770643234253, gen p mean: -0.04766623303294182, mean p set: 0.4519580006599426
loss_pred:0.015832116827368736, decouple_loss:0.0012404953595250845
loss_pred:0.01618199609220028, decouple_loss:0.0013368179788812995
Iteration: 469, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45172998309135437, gen p mean: -0.04684928432106972, mean p set: 0.45221027731895447
loss_pred:0.01535834837704897, decouple_loss:0.0012489313958212733
The modified gen p mean: 0.45040807127952576, gen p mean: -0.04722963273525238, mean p set: 0.45088836550712585The modified gen p mean: 0.44951504468917847, gen p mean: -0.041631728410720825, mean p set: 0.44999533891677856
loss_pred:0.015728898346424103, decouple_loss:0.0012385171139612794
loss_pred:0.015610539354383945, decouple_loss:0.0012153481366112828
Iteration: 470, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508315324783325, gen p mean: -0.05061500519514084, mean p set: 0.4513118267059326
loss_pred:0.015082431957125664, decouple_loss:0.0012995736906304955
The modified gen p mean: 0.4519721567630768, gen p mean: -0.04994204640388489, mean p set: 0.4524524509906769
The modified gen p mean: 0.4509672224521637, gen p mean: -0.0418195016682148, mean p set: 0.4514475464820862
loss_pred:0.014913885854184628, decouple_loss:0.0012135545257478952
loss_pred:0.016118906438350677, decouple_loss:0.0012668650597333908
2023-05-02 04:29:25 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.05461468547582626, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830535888672, gen p mean: -0.0499848797917366, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04999159649014473, mean p set: 0.45035696029663086
loss_pred:0.018643340095877647, decouple_loss:0.0014190939255058765
loss_pred:0.0177207812666893, decouple_loss:0.0013266243040561676
loss_pred:0.017536019906401634, decouple_loss:0.0013184321578592062
WV_0_PC_1_EH_0_PS_40, loss: 0.018034450709819794, avg_mse: 0.026008877903223038
current test mse: 0.026009
Iteration: 471, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45013538002967834, gen p mean: -0.04324333742260933, mean p set: 0.45061564445495605
The modified gen p mean: 0.45121529698371887, gen p mean: -0.041906554251909256, mean p set: 0.45169559121131897
The modified gen p mean: 0.45056042075157166, gen p mean: -0.04600644111633301, mean p set: 0.45104068517684937
loss_pred:0.015679195523262024, decouple_loss:0.001201388193294406
loss_pred:0.01504463143646717, decouple_loss:0.0012777213705703616
loss_pred:0.01598454639315605, decouple_loss:0.0011411982122808695
Iteration: 472, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4525343179702759, gen p mean: -0.044172175228595734, mean p set: 0.45301464200019836
loss_pred:0.015042876824736595, decouple_loss:0.0012469784123823047
The modified gen p mean: 0.44978445768356323, gen p mean: -0.04300157353281975, mean p set: 0.4502647817134857The modified gen p mean: 0.4496683180332184, gen p mean: -0.0422055721282959, mean p set: 0.4501486122608185
loss_pred:0.015602088533341885, decouple_loss:0.0012110183015465736
loss_pred:0.015748901292681694, decouple_loss:0.001146008144132793
Iteration: 473, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481469690799713, gen p mean: -0.05139368399977684, mean p set: 0.4486272633075714
loss_pred:0.015450650826096535, decouple_loss:0.0012051812373101711
The modified gen p mean: 0.452386736869812, gen p mean: -0.04761836305260658, mean p set: 0.4528670310974121The modified gen p mean: 0.44931164383888245, gen p mean: -0.045263294130563736, mean p set: 0.44979190826416016
loss_pred:0.015032116323709488, decouple_loss:0.0012161844642832875
loss_pred:0.015791868790984154, decouple_loss:0.0011446785647422075
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012006_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012006_3_24hr.npz
NaN value num: 0
Iteration: 474, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474453926086426, gen p mean: -0.05886233597993851, mean p set: 0.4479256868362427
loss_pred:0.014421717263758183, decouple_loss:0.0012150073889642954
The modified gen p mean: 0.44865065813064575, gen p mean: -0.05135646462440491, mean p set: 0.44913092255592346The modified gen p mean: 0.44868409633636475, gen p mean: -0.051877353340387344, mean p set: 0.44916436076164246
loss_pred:0.014178752899169922, decouple_loss:0.001138403546065092
loss_pred:0.014362269081175327, decouple_loss:0.0011429586447775364
Iteration: 475, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44944050908088684, gen p mean: -0.053407832980155945, mean p set: 0.44992080330848694
loss_pred:0.014885913580656052, decouple_loss:0.0012835984816774726
The modified gen p mean: 0.4488055408000946, gen p mean: -0.053734634071588516, mean p set: 0.4492858350276947The modified gen p mean: 0.44881996512413025, gen p mean: -0.05766943842172623, mean p set: 0.44930025935173035
loss_pred:0.014386617578566074, decouple_loss:0.0013539043720811605
loss_pred:0.014255601912736893, decouple_loss:0.0011340209748595953
Iteration: 476, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44877612590789795, gen p mean: -0.058643460273742676, mean p set: 0.44925642013549805
loss_pred:0.014412710443139076, decouple_loss:0.0012908310163766146
The modified gen p mean: 0.44784513115882874, gen p mean: -0.05759153142571449, mean p set: 0.44832542538642883The modified gen p mean: 0.4499695599079132, gen p mean: -0.05885812267661095, mean p set: 0.4504498541355133
loss_pred:0.014543125405907631, decouple_loss:0.001226210966706276
loss_pred:0.014120216481387615, decouple_loss:0.0013687098398804665
Iteration: 477, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477083086967468, gen p mean: -0.055567048490047455, mean p set: 0.4481886029243469
The modified gen p mean: 0.44808343052864075, gen p mean: -0.06234653666615486, mean p set: 0.44856372475624084
loss_pred:0.014069817960262299, decouple_loss:0.0012300461530685425
loss_pred:0.014287233352661133, decouple_loss:0.001152746961452067
The modified gen p mean: 0.4474776089191437, gen p mean: -0.06714233756065369, mean p set: 0.4479579031467438
loss_pred:0.014098705723881721, decouple_loss:0.0012512080138549209
Iteration: 478, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480079710483551, gen p mean: -0.062173496931791306, mean p set: 0.4484882652759552
loss_pred:0.014027691446244717, decouple_loss:0.0012170441914349794
The modified gen p mean: 0.4486697316169739, gen p mean: -0.06609165668487549, mean p set: 0.449150025844574The modified gen p mean: 0.4473377764225006, gen p mean: -0.06178863346576691, mean p set: 0.4478180706501007
loss_pred:0.014012910425662994, decouple_loss:0.0012275781482458115
loss_pred:0.014314709231257439, decouple_loss:0.001368956291116774
Iteration: 479, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484126567840576, gen p mean: -0.060481831431388855, mean p set: 0.4488929510116577
loss_pred:0.014176953583955765, decouple_loss:0.0012892994564026594
The modified gen p mean: 0.44882193207740784, gen p mean: -0.0520201213657856, mean p set: 0.44930222630500793
The modified gen p mean: 0.44793662428855896, gen p mean: -0.05259980261325836, mean p set: 0.44841691851615906
loss_pred:0.014480656944215298, decouple_loss:0.001313096727244556
loss_pred:0.013843324966728687, decouple_loss:0.0012772977352142334
Iteration: 480, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481826722621918, gen p mean: -0.05461105331778526, mean p set: 0.44866296648979187
The modified gen p mean: 0.44782355427742004, gen p mean: -0.0512113943696022, mean p set: 0.44830384850502014
loss_pred:0.014242899604141712, decouple_loss:0.0013351074885576963
loss_pred:0.013563853688538074, decouple_loss:0.0012081436580047011
The modified gen p mean: 0.4481750428676605, gen p mean: -0.05803526192903519, mean p set: 0.4486553370952606
loss_pred:0.014089755713939667, decouple_loss:0.0012760194949805737
2023-05-02 04:31:55 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.05455639958381653, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.05021961033344269, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.050135716795921326, mean p set: 0.4500633478164673
loss_pred:0.019166795536875725, decouple_loss:0.0012986889341846108
loss_pred:0.018027910962700844, decouple_loss:0.0012269929284229875
loss_pred:0.018126100301742554, decouple_loss:0.001241691061295569
WV_0_PC_1_EH_0_PS_40, loss: 0.018503058701753616, avg_mse: 0.026933537796139717
current test mse: 0.026934
Iteration: 481, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476868510246277, gen p mean: -0.04609433934092522, mean p set: 0.4481671154499054
The modified gen p mean: 0.44792136549949646, gen p mean: -0.04728829115629196, mean p set: 0.44840162992477417
The modified gen p mean: 0.44786936044692993, gen p mean: -0.053044721484184265, mean p set: 0.44834965467453003
loss_pred:0.014094186946749687, decouple_loss:0.0012355948565527797
loss_pred:0.014002012088894844, decouple_loss:0.0012194711016491055
loss_pred:0.013991344720125198, decouple_loss:0.0012887332122772932
Iteration: 482, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487764537334442, gen p mean: -0.05138985812664032, mean p set: 0.4492567181587219
loss_pred:0.013879136182367802, decouple_loss:0.001178887439891696
The modified gen p mean: 0.44945159554481506, gen p mean: -0.05218575522303581, mean p set: 0.44993188977241516The modified gen p mean: 0.44835829734802246, gen p mean: -0.05819522961974144, mean p set: 0.44883859157562256
loss_pred:0.01360719371587038, decouple_loss:0.001118420623242855
loss_pred:0.013798556290566921, decouple_loss:0.0012847117614001036
Iteration: 483, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44897907972335815, gen p mean: -0.056643687188625336, mean p set: 0.44945937395095825
loss_pred:0.013451356440782547, decouple_loss:0.001144673558883369
The modified gen p mean: 0.4484025537967682, gen p mean: -0.05140328407287598, mean p set: 0.4488828480243683The modified gen p mean: 0.44917070865631104, gen p mean: -0.06066899001598358, mean p set: 0.4496510326862335
loss_pred:0.013808242045342922, decouple_loss:0.0012697697384282947
loss_pred:0.01386753935366869, decouple_loss:0.0014417528873309493
Iteration: 484, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44816169142723083, gen p mean: -0.05524838715791702, mean p set: 0.4486420452594757
loss_pred:0.014260743744671345, decouple_loss:0.001235685427673161
The modified gen p mean: 0.4485883116722107, gen p mean: -0.05511276051402092, mean p set: 0.4490686058998108The modified gen p mean: 0.44849711656570435, gen p mean: -0.05487857758998871, mean p set: 0.44897738099098206
loss_pred:0.014784876257181168, decouple_loss:0.0014076491352170706
loss_pred:0.01377945113927126, decouple_loss:0.0013304337626323104
Iteration: 485, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44923076033592224, gen p mean: -0.048495326191186905, mean p set: 0.44971105456352234
loss_pred:0.014177791774272919, decouple_loss:0.0012519489973783493
The modified gen p mean: 0.4484231173992157, gen p mean: -0.05636552721261978, mean p set: 0.4489034116268158The modified gen p mean: 0.44840681552886963, gen p mean: -0.057639461010694504, mean p set: 0.4488871097564697
loss_pred:0.01396992802619934, decouple_loss:0.0013303350424394011
loss_pred:0.013778991997241974, decouple_loss:0.0012577358866110444
Iteration: 486, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483506679534912, gen p mean: -0.057094015181064606, mean p set: 0.4488309919834137
loss_pred:0.014077714644372463, decouple_loss:0.0014448425499722362
The modified gen p mean: 0.4501950442790985, gen p mean: -0.05485675856471062, mean p set: 0.4506753385066986The modified gen p mean: 0.4478321671485901, gen p mean: -0.05232493579387665, mean p set: 0.4483124613761902
loss_pred:0.014056757092475891, decouple_loss:0.0013075810857117176
loss_pred:0.013479864224791527, decouple_loss:0.001389011973515153
Iteration: 487, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485201835632324, gen p mean: -0.05696796625852585, mean p set: 0.44900044798851013
loss_pred:0.01378196943551302, decouple_loss:0.0014211975503712893
The modified gen p mean: 0.44895660877227783, gen p mean: -0.05526471883058548, mean p set: 0.44943690299987793The modified gen p mean: 0.4480856955051422, gen p mean: -0.05510047823190689, mean p set: 0.4485659599304199
loss_pred:0.013453266583383083, decouple_loss:0.001418420928530395
loss_pred:0.013705102726817131, decouple_loss:0.0012721779057756066
Iteration: 488, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44884926080703735, gen p mean: -0.051351383328437805, mean p set: 0.44932955503463745
loss_pred:0.014284733682870865, decouple_loss:0.0012550954706966877
The modified gen p mean: 0.4479890465736389, gen p mean: -0.06156942993402481, mean p set: 0.448469340801239The modified gen p mean: 0.4479455053806305, gen p mean: -0.05846177414059639, mean p set: 0.4484257698059082
loss_pred:0.013617400079965591, decouple_loss:0.001252441550604999
loss_pred:0.013626990839838982, decouple_loss:0.0012220593634992838
Iteration: 489, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44917911291122437, gen p mean: -0.05203360691666603, mean p set: 0.44965940713882446
loss_pred:0.013586485758423805, decouple_loss:0.0012410555500537157
The modified gen p mean: 0.4489497244358063, gen p mean: -0.05047091469168663, mean p set: 0.449429988861084The modified gen p mean: 0.4494444727897644, gen p mean: -0.054023999720811844, mean p set: 0.4499247372150421
loss_pred:0.014119850471615791, decouple_loss:0.0013596095377579331
loss_pred:0.013687285594642162, decouple_loss:0.001227005966939032
Iteration: 490, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44971179962158203, gen p mean: -0.052227847278118134, mean p set: 0.45019209384918213
loss_pred:0.014044847339391708, decouple_loss:0.0012718264479190111
The modified gen p mean: 0.44858604669570923, gen p mean: -0.057248543947935104, mean p set: 0.4490663409233093The modified gen p mean: 0.4487152397632599, gen p mean: -0.044889919459819794, mean p set: 0.44919553399086
loss_pred:0.013447146862745285, decouple_loss:0.001120791886933148
loss_pred:0.014171176590025425, decouple_loss:0.0011898112716153264
2023-05-02 04:33:49 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.053152553737163544, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04912012442946434, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.04914291575551033, mean p set: 0.4500633478164673
loss_pred:0.01916325092315674, decouple_loss:0.0011270493268966675
loss_pred:0.018014144152402878, decouple_loss:0.0011381226358935237
loss_pred:0.018111128360033035, decouple_loss:0.0011041698744520545
WV_0_PC_1_EH_0_PS_40, loss: 0.018485665321350098, avg_mse: 0.026939265429973602
current test mse: 0.026939
Iteration: 491, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471559524536133, gen p mean: -0.05371759459376335, mean p set: 0.4476362466812134
The modified gen p mean: 0.4485749304294586, gen p mean: -0.049201592803001404, mean p set: 0.44905519485473633
The modified gen p mean: 0.44761672616004944, gen p mean: -0.04694977030158043, mean p set: 0.4480970501899719
loss_pred:0.013621147722005844, decouple_loss:0.0010493365116417408
loss_pred:0.014100293628871441, decouple_loss:0.001229799003340304
loss_pred:0.013586549088358879, decouple_loss:0.001117745996452868
Iteration: 492, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487597346305847, gen p mean: -0.05049094185233116, mean p set: 0.4492400586605072
The modified gen p mean: 0.4476096034049988, gen p mean: -0.04966194927692413, mean p set: 0.4480898678302765
loss_pred:0.014238491654396057, decouple_loss:0.001412552664987743
loss_pred:0.013763890601694584, decouple_loss:0.0015193521976470947
The modified gen p mean: 0.4491414427757263, gen p mean: -0.04503045603632927, mean p set: 0.4496217370033264
loss_pred:0.013770869001746178, decouple_loss:0.001547948457300663
Iteration: 493, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485422968864441, gen p mean: -0.04727059602737427, mean p set: 0.4490225911140442
loss_pred:0.013747056946158409, decouple_loss:0.0012551851104944944
The modified gen p mean: 0.4497270882129669, gen p mean: -0.048745498061180115, mean p set: 0.450207382440567The modified gen p mean: 0.4492274224758148, gen p mean: -0.04949019476771355, mean p set: 0.4497077465057373
loss_pred:0.013422319665551186, decouple_loss:0.0012766557047143579
loss_pred:0.013759779743850231, decouple_loss:0.0014260172611102462
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012010_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012010_3_24hr.npz
NaN value num: 0
Iteration: 494, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503122568130493, gen p mean: -0.050839558243751526, mean p set: 0.4507925808429718
loss_pred:0.01685592159628868, decouple_loss:0.001416740589775145
The modified gen p mean: 0.4508810043334961, gen p mean: -0.04598071053624153, mean p set: 0.4513612687587738The modified gen p mean: 0.4512008726596832, gen p mean: -0.04120682179927826, mean p set: 0.4516811966896057
loss_pred:0.016091622412204742, decouple_loss:0.0013628621818497777
loss_pred:0.017243506386876106, decouple_loss:0.0014651347883045673
Iteration: 495, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45126527547836304, gen p mean: -0.04630618914961815, mean p set: 0.45174556970596313
loss_pred:0.017438774928450584, decouple_loss:0.00148891587741673
The modified gen p mean: 0.4503536522388458, gen p mean: -0.044411513954401016, mean p set: 0.45083388686180115The modified gen p mean: 0.4510484039783478, gen p mean: -0.045021865516901016, mean p set: 0.45152872800827026
loss_pred:0.01706170290708542, decouple_loss:0.001425892231054604
loss_pred:0.016936270520091057, decouple_loss:0.0014037949731573462
Iteration: 496, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45091378688812256, gen p mean: -0.04393673315644264, mean p set: 0.45139408111572266
The modified gen p mean: 0.45181915163993835, gen p mean: -0.04335717856884003, mean p set: 0.45229944586753845
loss_pred:0.01703949272632599, decouple_loss:0.0013400510651990771
loss_pred:0.01668088510632515, decouple_loss:0.0012920594308525324
The modified gen p mean: 0.4503781795501709, gen p mean: -0.041758500039577484, mean p set: 0.450858473777771
loss_pred:0.01748378574848175, decouple_loss:0.0012683626264333725
Iteration: 497, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487875998020172, gen p mean: -0.04293113946914673, mean p set: 0.4492678940296173
The modified gen p mean: 0.44879794120788574, gen p mean: -0.04507759213447571, mean p set: 0.44927823543548584
loss_pred:0.01692807860672474, decouple_loss:0.0012315430212765932
loss_pred:0.017208360135555267, decouple_loss:0.0013490666169673204
The modified gen p mean: 0.450673371553421, gen p mean: -0.04178640618920326, mean p set: 0.4511536657810211
loss_pred:0.016006894409656525, decouple_loss:0.00136391946580261
Iteration: 498, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45096102356910706, gen p mean: -0.04697605222463608, mean p set: 0.45144134759902954
The modified gen p mean: 0.4509302079677582, gen p mean: -0.04492054879665375, mean p set: 0.45141053199768066
loss_pred:0.016524748876690865, decouple_loss:0.0017707690130919218
loss_pred:0.017277082428336143, decouple_loss:0.0014179963618516922
The modified gen p mean: 0.45091620087623596, gen p mean: -0.044122498482465744, mean p set: 0.45139649510383606
loss_pred:0.017364565283060074, decouple_loss:0.001432181685231626
Iteration: 499, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504936635494232, gen p mean: -0.044893670827150345, mean p set: 0.4509739875793457
The modified gen p mean: 0.45000413060188293, gen p mean: -0.041981153190135956, mean p set: 0.45048442482948303
loss_pred:0.01681370660662651, decouple_loss:0.001347667770460248
loss_pred:0.01687086932361126, decouple_loss:0.0014955546939745545
The modified gen p mean: 0.4508250653743744, gen p mean: -0.040469031780958176, mean p set: 0.4513053894042969
loss_pred:0.01633019931614399, decouple_loss:0.0015574984718114138
Iteration: 500, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450674831867218, gen p mean: -0.05044180527329445, mean p set: 0.4511551260948181
The modified gen p mean: 0.450306236743927, gen p mean: -0.04783504456281662, mean p set: 0.4507865309715271
loss_pred:0.01758567802608013, decouple_loss:0.0014376381877809763
loss_pred:0.01624247245490551, decouple_loss:0.0013173447223380208
The modified gen p mean: 0.45160576701164246, gen p mean: -0.042907800525426865, mean p set: 0.45208606123924255
loss_pred:0.016760675236582756, decouple_loss:0.0014217838179320097
2023-05-02 04:36:17 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.04683627933263779, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04359111934900284, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.043243199586868286, mean p set: 0.4500633478164673
loss_pred:0.01860000565648079, decouple_loss:0.0018527392530813813
loss_pred:0.017455991357564926, decouple_loss:0.0017018630169332027
loss_pred:0.01761758327484131, decouple_loss:0.001706081093288958
WV_0_PC_1_EH_0_PS_40, loss: 0.01797887310385704, avg_mse: 0.025858035311102867
current test mse: 0.025858
Iteration: 501, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500894844532013, gen p mean: -0.04730845242738724, mean p set: 0.4505697786808014
The modified gen p mean: 0.45102566480636597, gen p mean: -0.0413653627038002, mean p set: 0.45150595903396606
The modified gen p mean: 0.4501175284385681, gen p mean: -0.04008646681904793, mean p set: 0.4505978226661682
loss_pred:0.016458449885249138, decouple_loss:0.0014222452882677317
loss_pred:0.0177707951515913, decouple_loss:0.0014076990773901343
loss_pred:0.01642821729183197, decouple_loss:0.0014087277231737971
Iteration: 502, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498886168003082, gen p mean: -0.04859001934528351, mean p set: 0.4503689110279083
The modified gen p mean: 0.45150989294052124, gen p mean: -0.040487032383680344, mean p set: 0.45199018716812134
loss_pred:0.016850054264068604, decouple_loss:0.0013441579649224877
loss_pred:0.016399212181568146, decouple_loss:0.0012234037276357412
The modified gen p mean: 0.4511512517929077, gen p mean: -0.04114416614174843, mean p set: 0.4516315758228302
loss_pred:0.017053229734301567, decouple_loss:0.0013280482962727547
Iteration: 503, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4512858986854553, gen p mean: -0.03911949321627617, mean p set: 0.45176616311073303
loss_pred:0.016537867486476898, decouple_loss:0.00128297065384686
The modified gen p mean: 0.45087429881095886, gen p mean: -0.037153877317905426, mean p set: 0.45135459303855896The modified gen p mean: 0.45217272639274597, gen p mean: -0.040125079452991486, mean p set: 0.45265302062034607
loss_pred:0.016231276094913483, decouple_loss:0.0012219154741615057
loss_pred:0.01596071943640709, decouple_loss:0.0012574736028909683
Iteration: 504, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449104905128479, gen p mean: -0.04121072590351105, mean p set: 0.4495851993560791
loss_pred:0.016657887026667595, decouple_loss:0.0012593528954312205
The modified gen p mean: 0.4508184790611267, gen p mean: -0.03617475926876068, mean p set: 0.4512987732887268The modified gen p mean: 0.45252034068107605, gen p mean: -0.041451431810855865, mean p set: 0.45300063490867615
loss_pred:0.01632613129913807, decouple_loss:0.0013175738276913762
loss_pred:0.016038669273257256, decouple_loss:0.001243986771441996
Iteration: 505, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45080429315567017, gen p mean: -0.049951374530792236, mean p set: 0.45128458738327026
loss_pred:0.01713620126247406, decouple_loss:0.0013695728266611695
The modified gen p mean: 0.4503456652164459, gen p mean: -0.04147179424762726, mean p set: 0.4508259892463684The modified gen p mean: 0.4498027265071869, gen p mean: -0.04525628685951233, mean p set: 0.450283020734787
loss_pred:0.0157858207821846, decouple_loss:0.0012069513322785497
loss_pred:0.016371022909879684, decouple_loss:0.0014958229148760438
Iteration: 506, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45170944929122925, gen p mean: -0.04254312068223953, mean p set: 0.45218974351882935
loss_pred:0.016960639506578445, decouple_loss:0.0013664395082741976
The modified gen p mean: 0.4500954747200012, gen p mean: -0.044422995299100876, mean p set: 0.4505757987499237The modified gen p mean: 0.4503021836280823, gen p mean: -0.0444636270403862, mean p set: 0.45078244805336
loss_pred:0.016397476196289062, decouple_loss:0.001330112456344068
loss_pred:0.016660772264003754, decouple_loss:0.0013750597136095166
Iteration: 507, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45091506838798523, gen p mean: -0.04597539082169533, mean p set: 0.45139533281326294
loss_pred:0.016467073932290077, decouple_loss:0.0011581139406189322
The modified gen p mean: 0.4500940144062042, gen p mean: -0.047411978244781494, mean p set: 0.4505743086338043The modified gen p mean: 0.4513743817806244, gen p mean: -0.04341670498251915, mean p set: 0.4518546462059021
loss_pred:0.016628801822662354, decouple_loss:0.0011076184455305338
loss_pred:0.017104217782616615, decouple_loss:0.0011171011719852686
Iteration: 508, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45182347297668457, gen p mean: -0.04874430224299431, mean p set: 0.4523037374019623
loss_pred:0.016693469136953354, decouple_loss:0.0011845685075968504
The modified gen p mean: 0.4504493772983551, gen p mean: -0.05283179506659508, mean p set: 0.4509296715259552The modified gen p mean: 0.45211341977119446, gen p mean: -0.05012866482138634, mean p set: 0.45259371399879456
loss_pred:0.01658475212752819, decouple_loss:0.0011309217661619186
loss_pred:0.017051098868250847, decouple_loss:0.0012118128361180425
Iteration: 509, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4515972435474396, gen p mean: -0.05112141743302345, mean p set: 0.4520775377750397
loss_pred:0.015994681045413017, decouple_loss:0.0010678149992600083
The modified gen p mean: 0.4508441686630249, gen p mean: -0.048504892736673355, mean p set: 0.4513244926929474The modified gen p mean: 0.4497884511947632, gen p mean: -0.05092368647456169, mean p set: 0.4502687156200409
loss_pred:0.016896598041057587, decouple_loss:0.001172573072835803
loss_pred:0.016309643164277077, decouple_loss:0.0013071543071419
Iteration: 510, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503532350063324, gen p mean: -0.05205550417304039, mean p set: 0.4508335292339325
loss_pred:0.016713596880435944, decouple_loss:0.0013020823244005442
The modified gen p mean: 0.45011213421821594, gen p mean: -0.054450295865535736, mean p set: 0.4505924582481384The modified gen p mean: 0.45113709568977356, gen p mean: -0.05246557295322418, mean p set: 0.45161738991737366
loss_pred:0.016296612098813057, decouple_loss:0.0011672741966322064
loss_pred:0.016093747690320015, decouple_loss:0.0012415272649377584
2023-05-02 04:38:11 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.05376226082444191, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.049706194549798965, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.04987522214651108, mean p set: 0.4500633478164673
loss_pred:0.01847323589026928, decouple_loss:0.0016130065778270364
loss_pred:0.017389854416251183, decouple_loss:0.0014848954742774367
loss_pred:0.01752130687236786, decouple_loss:0.0015023935120552778
WV_0_PC_1_EH_0_PS_40, loss: 0.017871471121907234, avg_mse: 0.025690782815217972
current test mse: 0.025691
Iteration: 511, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507063925266266, gen p mean: -0.047906335443258286, mean p set: 0.4511867165565491
The modified gen p mean: 0.4508654475212097, gen p mean: -0.04973572865128517, mean p set: 0.4513457417488098
The modified gen p mean: 0.451437383890152, gen p mean: -0.04703373461961746, mean p set: 0.4519176781177521
loss_pred:0.016174813732504845, decouple_loss:0.0013812420656904578
loss_pred:0.01719122752547264, decouple_loss:0.0012946465285494924loss_pred:0.01738002896308899, decouple_loss:0.001218121498823166
Iteration: 512, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505714178085327, gen p mean: -0.0502019003033638, mean p set: 0.4510516822338104
loss_pred:0.01630895771086216, decouple_loss:0.0012420207494869828
The modified gen p mean: 0.4501503109931946, gen p mean: -0.05118925869464874, mean p set: 0.45063063502311707
The modified gen p mean: 0.45136839151382446, gen p mean: -0.04689241200685501, mean p set: 0.4518486559391022
loss_pred:0.015944955870509148, decouple_loss:0.0012502679601311684
loss_pred:0.01608639769256115, decouple_loss:0.0014280102914199233
Iteration: 513, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4506232440471649, gen p mean: -0.046963125467300415, mean p set: 0.4511035680770874
loss_pred:0.01698993146419525, decouple_loss:0.0014337131287902594
The modified gen p mean: 0.4505902826786041, gen p mean: -0.04118448123335838, mean p set: 0.4510705769062042The modified gen p mean: 0.4505552351474762, gen p mean: -0.04236147552728653, mean p set: 0.4510355293750763
loss_pred:0.016328053548932076, decouple_loss:0.0013402578188106418
loss_pred:0.016040099784731865, decouple_loss:0.0013558693462982774
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012012_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012012_3_24hr.npz
NaN value num: 0
Iteration: 514, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4531868100166321, gen p mean: -0.03763275966048241, mean p set: 0.4536671042442322
loss_pred:0.017132865265011787, decouple_loss:0.0012912607053294778
The modified gen p mean: 0.45124709606170654, gen p mean: -0.03361571207642555, mean p set: 0.45172739028930664The modified gen p mean: 0.4525606632232666, gen p mean: -0.0370660275220871, mean p set: 0.4530409872531891
loss_pred:0.016865653917193413, decouple_loss:0.001275366172194481
loss_pred:0.017097394913434982, decouple_loss:0.00120887893717736
Iteration: 515, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45073312520980835, gen p mean: -0.03585504740476608, mean p set: 0.45121341943740845
loss_pred:0.01672995090484619, decouple_loss:0.0011178471613675356
The modified gen p mean: 0.45237085223197937, gen p mean: -0.03351788595318794, mean p set: 0.45285117626190186The modified gen p mean: 0.4508955180644989, gen p mean: -0.033102814108133316, mean p set: 0.451375812292099
loss_pred:0.017403047531843185, decouple_loss:0.0012348314048722386
loss_pred:0.017747515812516212, decouple_loss:0.001104635768570006
Iteration: 516, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511535167694092, gen p mean: -0.03100561909377575, mean p set: 0.4516338109970093
loss_pred:0.01693618856370449, decouple_loss:0.0011677754810079932
The modified gen p mean: 0.452274888753891, gen p mean: -0.03954308480024338, mean p set: 0.4527551829814911The modified gen p mean: 0.45140978693962097, gen p mean: -0.03898866847157478, mean p set: 0.45189008116722107
loss_pred:0.01707170531153679, decouple_loss:0.0012816631933674216
loss_pred:0.017314579337835312, decouple_loss:0.001249138731509447
Iteration: 517, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4527921676635742, gen p mean: -0.028713151812553406, mean p set: 0.4532724618911743
loss_pred:0.017286591231822968, decouple_loss:0.0012088868534192443
The modified gen p mean: 0.4513090252876282, gen p mean: -0.036351028829813004, mean p set: 0.4517892897129059The modified gen p mean: 0.45122694969177246, gen p mean: -0.03737928718328476, mean p set: 0.45170727372169495
loss_pred:0.017032498493790627, decouple_loss:0.001119455206207931
loss_pred:0.016603806987404823, decouple_loss:0.0011063439305871725
Iteration: 518, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45342594385147095, gen p mean: -0.03546551242470741, mean p set: 0.45390620827674866
loss_pred:0.017614373937249184, decouple_loss:0.0011893374612554908
The modified gen p mean: 0.4503174126148224, gen p mean: -0.04175625741481781, mean p set: 0.4507977068424225The modified gen p mean: 0.45061156153678894, gen p mean: -0.038555458188056946, mean p set: 0.4510918855667114
loss_pred:0.01701602339744568, decouple_loss:0.001329693477600813
loss_pred:0.016709350049495697, decouple_loss:0.001251035020686686
Iteration: 519, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45296192169189453, gen p mean: -0.041877951472997665, mean p set: 0.45344221591949463
The modified gen p mean: 0.45041078329086304, gen p mean: -0.03939447179436684, mean p set: 0.45089107751846313
loss_pred:0.017597340047359467, decouple_loss:0.0013803769834339619
loss_pred:0.017169060185551643, decouple_loss:0.0012170512927696109
The modified gen p mean: 0.4518972635269165, gen p mean: -0.03926845267415047, mean p set: 0.4523775279521942
loss_pred:0.016934331506490707, decouple_loss:0.0012963915942236781
Iteration: 520, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513874351978302, gen p mean: -0.05072619020938873, mean p set: 0.4518677592277527
The modified gen p mean: 0.4513908624649048, gen p mean: -0.04009370878338814, mean p set: 0.4518711566925049
loss_pred:0.0169112179428339, decouple_loss:0.0012382174609228969
loss_pred:0.017243005335330963, decouple_loss:0.00109489809256047
The modified gen p mean: 0.45076799392700195, gen p mean: -0.04129573702812195, mean p set: 0.45124828815460205
loss_pred:0.016922203823924065, decouple_loss:0.0011386845726519823
2023-05-02 04:40:44 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.05595925450325012, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.05176066607236862, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.052061524242162704, mean p set: 0.4500633478164673
loss_pred:0.018392549827694893, decouple_loss:0.0013558963546529412
loss_pred:0.017329903319478035, decouple_loss:0.0015065032057464123
loss_pred:0.017394252121448517, decouple_loss:0.0013693063519895077
WV_0_PC_1_EH_0_PS_40, loss: 0.01777609810233116, avg_mse: 0.025466065853834152
current test mse: 0.025466
Iteration: 521, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4515746235847473, gen p mean: -0.04821745678782463, mean p set: 0.4520549178123474
The modified gen p mean: 0.45094770193099976, gen p mean: -0.04215401038527489, mean p set: 0.45142796635627747The modified gen p mean: 0.4523821473121643, gen p mean: -0.0518745593726635, mean p set: 0.452862411737442
loss_pred:0.01695278473198414, decouple_loss:0.0012494134716689587
loss_pred:0.017820674926042557, decouple_loss:0.0012559547321870923
loss_pred:0.016320805996656418, decouple_loss:0.0011474608909338713
Iteration: 522, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45103585720062256, gen p mean: -0.043808236718177795, mean p set: 0.45151615142822266
loss_pred:0.016659270972013474, decouple_loss:0.0013433212880045176
The modified gen p mean: 0.45261579751968384, gen p mean: -0.03807837888598442, mean p set: 0.45309609174728394The modified gen p mean: 0.45216771960258484, gen p mean: -0.05016433820128441, mean p set: 0.4526480436325073
loss_pred:0.01673482544720173, decouple_loss:0.001217651879414916
loss_pred:0.017283184453845024, decouple_loss:0.0013029759284108877
Iteration: 523, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45251381397247314, gen p mean: -0.04023708403110504, mean p set: 0.45299410820007324
loss_pred:0.017099618911743164, decouple_loss:0.001089725992642343
The modified gen p mean: 0.45308157801628113, gen p mean: -0.04221249371767044, mean p set: 0.4535618722438812The modified gen p mean: 0.4514777958393097, gen p mean: -0.05623400956392288, mean p set: 0.4519580900669098
loss_pred:0.017284967005252838, decouple_loss:0.0011950174812227488
loss_pred:0.016647975891828537, decouple_loss:0.0010974413016811013
Iteration: 524, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4520992636680603, gen p mean: -0.042981501668691635, mean p set: 0.4525795578956604
loss_pred:0.017325928434729576, decouple_loss:0.0011540281120687723
The modified gen p mean: 0.451018363237381, gen p mean: -0.053957499563694, mean p set: 0.4514986276626587The modified gen p mean: 0.45312532782554626, gen p mean: -0.04183599725365639, mean p set: 0.45360562205314636
loss_pred:0.017551878467202187, decouple_loss:0.0011387760750949383
loss_pred:0.017010841518640518, decouple_loss:0.0011265628272667527
Iteration: 525, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45189446210861206, gen p mean: -0.05268903821706772, mean p set: 0.45237478613853455
loss_pred:0.01731991581618786, decouple_loss:0.0012777263764292002
The modified gen p mean: 0.45206180214881897, gen p mean: -0.050722308456897736, mean p set: 0.45254209637641907The modified gen p mean: 0.45180171728134155, gen p mean: -0.05209822207689285, mean p set: 0.45228198170661926
loss_pred:0.01709495298564434, decouple_loss:0.0011809320421889424
loss_pred:0.017404720187187195, decouple_loss:0.0012102716136723757
Iteration: 526, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45076045393943787, gen p mean: -0.04770778864622116, mean p set: 0.45124077796936035
loss_pred:0.015926329419016838, decouple_loss:0.0010615997016429901
The modified gen p mean: 0.4529753029346466, gen p mean: -0.04741239547729492, mean p set: 0.4534555673599243The modified gen p mean: 0.4532085359096527, gen p mean: -0.05261262133717537, mean p set: 0.4536888301372528
loss_pred:0.016902394592761993, decouple_loss:0.0009594811126589775
loss_pred:0.017696356400847435, decouple_loss:0.0010631266050040722
Iteration: 527, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4526253044605255, gen p mean: -0.03936684876680374, mean p set: 0.4531055986881256
loss_pred:0.017067518085241318, decouple_loss:0.0011729977559298277
The modified gen p mean: 0.4521215856075287, gen p mean: -0.04646053910255432, mean p set: 0.4526018798351288The modified gen p mean: 0.45143890380859375, gen p mean: -0.04865202680230141, mean p set: 0.45191919803619385
loss_pred:0.016443492844700813, decouple_loss:0.001181248459033668
loss_pred:0.01686949096620083, decouple_loss:0.0011021899990737438
Iteration: 528, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4520900845527649, gen p mean: -0.0459931306540966, mean p set: 0.4525703489780426
loss_pred:0.017026329413056374, decouple_loss:0.001069919322617352
The modified gen p mean: 0.45133817195892334, gen p mean: -0.04796928912401199, mean p set: 0.45181846618652344The modified gen p mean: 0.45320776104927063, gen p mean: -0.05469474568963051, mean p set: 0.45368802547454834
loss_pred:0.017014095559716225, decouple_loss:0.001139519503340125
loss_pred:0.017451036721467972, decouple_loss:0.0010349027579650283
Iteration: 529, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45267388224601746, gen p mean: -0.039226386696100235, mean p set: 0.45315417647361755
loss_pred:0.01699143648147583, decouple_loss:0.00109244289342314
The modified gen p mean: 0.45333120226860046, gen p mean: -0.04652482271194458, mean p set: 0.45381149649620056The modified gen p mean: 0.45252203941345215, gen p mean: -0.04055112600326538, mean p set: 0.45300236344337463
loss_pred:0.017191238701343536, decouple_loss:0.0010730281937867403
loss_pred:0.016897521913051605, decouple_loss:0.0010845968499779701
Iteration: 530, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4510819911956787, gen p mean: -0.04326007142663002, mean p set: 0.4515622556209564
loss_pred:0.016842512413859367, decouple_loss:0.0011113353539258242
The modified gen p mean: 0.4524537920951843, gen p mean: -0.05402262136340141, mean p set: 0.4529340863227844The modified gen p mean: 0.45210137963294983, gen p mean: -0.045587897300720215, mean p set: 0.45258164405822754
loss_pred:0.017483914270997047, decouple_loss:0.001075972686521709
loss_pred:0.017286868765950203, decouple_loss:0.0012054473627358675
2023-05-02 04:42:39 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.059878941625356674, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.05605340376496315, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.05619078502058983, mean p set: 0.4500633478164673
loss_pred:0.018423687666654587, decouple_loss:0.001253305235877633
loss_pred:0.017346808686852455, decouple_loss:0.0012950837844982743
loss_pred:0.017411476001143456, decouple_loss:0.0011930209584534168
WV_0_PC_1_EH_0_PS_40, loss: 0.017789682373404503, avg_mse: 0.025443721562623978
current test mse: 0.025444
Iteration: 531, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4536404609680176, gen p mean: -0.049001533538103104, mean p set: 0.45412078499794006
The modified gen p mean: 0.450235515832901, gen p mean: -0.05336584150791168, mean p set: 0.4507158100605011
The modified gen p mean: 0.45095402002334595, gen p mean: -0.05048464611172676, mean p set: 0.45143428444862366
loss_pred:0.016222627833485603, decouple_loss:0.0010491012362763286
loss_pred:0.01648360677063465, decouple_loss:0.001195698045194149
loss_pred:0.01693148724734783, decouple_loss:0.0011087580351158977
Iteration: 532, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508211314678192, gen p mean: -0.05387419834733009, mean p set: 0.4513013958930969
loss_pred:0.016704505309462547, decouple_loss:0.0011909125605598092
The modified gen p mean: 0.4524152874946594, gen p mean: -0.05932758376002312, mean p set: 0.4528955817222595The modified gen p mean: 0.45273756980895996, gen p mean: -0.055045269429683685, mean p set: 0.45321789383888245
loss_pred:0.017281780019402504, decouple_loss:0.001444437075406313
loss_pred:0.016811156645417213, decouple_loss:0.0013259354745969176
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012008_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012008_3_24hr.npz
NaN value num: 0
Iteration: 533, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4522383213043213, gen p mean: -0.05002391338348389, mean p set: 0.4527186155319214
loss_pred:0.016646195203065872, decouple_loss:0.001176333986222744
The modified gen p mean: 0.4503987729549408, gen p mean: -0.04831182211637497, mean p set: 0.4508790671825409The modified gen p mean: 0.4495670199394226, gen p mean: -0.05120443180203438, mean p set: 0.4500472843647003
loss_pred:0.017493050545454025, decouple_loss:0.0011805944377556443
loss_pred:0.01731904037296772, decouple_loss:0.0011378228664398193
Iteration: 534, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45205265283584595, gen p mean: -0.04721609875559807, mean p set: 0.45253291726112366
loss_pred:0.016688255593180656, decouple_loss:0.0012691282900050282
The modified gen p mean: 0.4504108428955078, gen p mean: -0.05479459464550018, mean p set: 0.4508911669254303The modified gen p mean: 0.4505055248737335, gen p mean: -0.05659594386816025, mean p set: 0.450985848903656
loss_pred:0.01690063439309597, decouple_loss:0.0014524075668305159
loss_pred:0.016811605542898178, decouple_loss:0.0015166017692536116
Iteration: 535, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489685595035553, gen p mean: -0.047340843826532364, mean p set: 0.4494488537311554
loss_pred:0.016340794041752815, decouple_loss:0.001031710533425212
The modified gen p mean: 0.4496085047721863, gen p mean: -0.04617559164762497, mean p set: 0.4500887989997864The modified gen p mean: 0.44924798607826233, gen p mean: -0.05273186415433884, mean p set: 0.4497282803058624
loss_pred:0.016822190955281258, decouple_loss:0.0010601149406284094
loss_pred:0.016666071489453316, decouple_loss:0.0011880658566951752
Iteration: 536, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44940486550331116, gen p mean: -0.04988295957446098, mean p set: 0.44988515973091125
loss_pred:0.016917813569307327, decouple_loss:0.001371797057799995
The modified gen p mean: 0.45234429836273193, gen p mean: -0.04380913823843002, mean p set: 0.45282456278800964
The modified gen p mean: 0.45146384835243225, gen p mean: -0.04627138003706932, mean p set: 0.45194414258003235
loss_pred:0.017292529344558716, decouple_loss:0.0014615139225497842
loss_pred:0.01701522246003151, decouple_loss:0.0013460034970194101
Iteration: 537, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45300352573394775, gen p mean: -0.04460068419575691, mean p set: 0.45348381996154785
loss_pred:0.01736687310039997, decouple_loss:0.001169691327959299
The modified gen p mean: 0.44862332940101624, gen p mean: -0.048998378217220306, mean p set: 0.44910362362861633The modified gen p mean: 0.45108312368392944, gen p mean: -0.04736495390534401, mean p set: 0.45156344771385193
loss_pred:0.016741177067160606, decouple_loss:0.0011356432223692536
loss_pred:0.016522502526640892, decouple_loss:0.0011412532767280936
Iteration: 538, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44874706864356995, gen p mean: -0.052693165838718414, mean p set: 0.44922736287117004
loss_pred:0.017095236107707024, decouple_loss:0.0012563797645270824
The modified gen p mean: 0.4510420858860016, gen p mean: -0.049301743507385254, mean p set: 0.4515224099159241The modified gen p mean: 0.45046067237854004, gen p mean: -0.05689387023448944, mean p set: 0.45094096660614014
loss_pred:0.017426827922463417, decouple_loss:0.0011679560411721468
loss_pred:0.016686225309967995, decouple_loss:0.0012280502123758197
Iteration: 539, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44906169176101685, gen p mean: -0.05442943423986435, mean p set: 0.44954198598861694
loss_pred:0.01698554866015911, decouple_loss:0.001103752525523305
The modified gen p mean: 0.452693909406662, gen p mean: -0.05137642100453377, mean p set: 0.4531742036342621The modified gen p mean: 0.44922390580177307, gen p mean: -0.05442184582352638, mean p set: 0.4497041702270508
loss_pred:0.017078008502721786, decouple_loss:0.001235581119544804
loss_pred:0.01602851040661335, decouple_loss:0.0011540293926373124
Iteration: 540, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44958770275115967, gen p mean: -0.05312114953994751, mean p set: 0.45006799697875977
loss_pred:0.016206884756684303, decouple_loss:0.0010144185507670045
The modified gen p mean: 0.4499739110469818, gen p mean: -0.05897902324795723, mean p set: 0.4504542350769043
The modified gen p mean: 0.44886985421180725, gen p mean: -0.05033746361732483, mean p set: 0.44935014843940735
loss_pred:0.01681973598897457, decouple_loss:0.0011004374828189611
loss_pred:0.015652749687433243, decouple_loss:0.0011026610154658556
2023-05-02 04:45:13 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.06181208789348602, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.057588133960962296, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.05774153023958206, mean p set: 0.4500633478164673
loss_pred:0.01836647093296051, decouple_loss:0.0012635851744562387
loss_pred:0.01726572960615158, decouple_loss:0.0013168371515348554
loss_pred:0.017415599897503853, decouple_loss:0.001225192565470934
WV_0_PC_1_EH_0_PS_40, loss: 0.017746027559041977, avg_mse: 0.025436382740736008
current test mse: 0.025436
Iteration: 541, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514771103858948, gen p mean: -0.05225354805588722, mean p set: 0.4519574046134949
The modified gen p mean: 0.45059144496917725, gen p mean: -0.049267396330833435, mean p set: 0.45107173919677734
The modified gen p mean: 0.4501669406890869, gen p mean: -0.05258066579699516, mean p set: 0.450647234916687
loss_pred:0.016640568152070045, decouple_loss:0.0011044236598536372
loss_pred:0.016839925199747086, decouple_loss:0.0011333419242873788loss_pred:0.016727954149246216, decouple_loss:0.001156359096057713
Iteration: 542, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45141664147377014, gen p mean: -0.05101844295859337, mean p set: 0.45189690589904785
loss_pred:0.0162641741335392, decouple_loss:0.0010513736633583903
The modified gen p mean: 0.45238858461380005, gen p mean: -0.04726790264248848, mean p set: 0.45286887884140015The modified gen p mean: 0.44990274310112, gen p mean: -0.058862730860710144, mean p set: 0.4503830373287201
loss_pred:0.01612558774650097, decouple_loss:0.0010746386833488941
loss_pred:0.01623622514307499, decouple_loss:0.0011315401643514633
Iteration: 543, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45036736130714417, gen p mean: -0.054482411593198776, mean p set: 0.45084765553474426
loss_pred:0.016329674050211906, decouple_loss:0.000997213996015489
The modified gen p mean: 0.44975170493125916, gen p mean: -0.05280832201242447, mean p set: 0.45023199915885925The modified gen p mean: 0.44859978556632996, gen p mean: -0.05655157193541527, mean p set: 0.44908010959625244
loss_pred:0.016936061903834343, decouple_loss:0.0010060739004984498
loss_pred:0.016388623043894768, decouple_loss:0.0010321992449462414
Iteration: 544, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44940727949142456, gen p mean: -0.05763687938451767, mean p set: 0.44988757371902466
loss_pred:0.016020946204662323, decouple_loss:0.0010725943138822913
The modified gen p mean: 0.4485670328140259, gen p mean: -0.04919976741075516, mean p set: 0.44904735684394836The modified gen p mean: 0.4517990052700043, gen p mean: -0.050287604331970215, mean p set: 0.45227932929992676
loss_pred:0.01595001108944416, decouple_loss:0.001047411933541298
loss_pred:0.017294760793447495, decouple_loss:0.0011218897998332977
Iteration: 545, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505070447921753, gen p mean: -0.052090827375650406, mean p set: 0.4509873688220978
loss_pred:0.016536783427000046, decouple_loss:0.001079146983101964
The modified gen p mean: 0.45180878043174744, gen p mean: -0.048464443534612656, mean p set: 0.45228907465934753The modified gen p mean: 0.4520147144794464, gen p mean: -0.04849720746278763, mean p set: 0.4524949789047241
loss_pred:0.016869589686393738, decouple_loss:0.0012271024752408266
loss_pred:0.01645156554877758, decouple_loss:0.0012411011848598719
Iteration: 546, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44939979910850525, gen p mean: -0.048728689551353455, mean p set: 0.44988009333610535
loss_pred:0.015715129673480988, decouple_loss:0.0009559194440953434
The modified gen p mean: 0.45020562410354614, gen p mean: -0.04346732422709465, mean p set: 0.45068594813346863The modified gen p mean: 0.4515248239040375, gen p mean: -0.04678015783429146, mean p set: 0.45200514793395996
loss_pred:0.016682932153344154, decouple_loss:0.0010161165846511722
loss_pred:0.016947120428085327, decouple_loss:0.0009656460024416447
Iteration: 547, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44965505599975586, gen p mean: -0.04483933001756668, mean p set: 0.45013532042503357
loss_pred:0.017496692016720772, decouple_loss:0.0012177646858617663
The modified gen p mean: 0.4495231807231903, gen p mean: -0.05202731490135193, mean p set: 0.4500034749507904The modified gen p mean: 0.4499431252479553, gen p mean: -0.04649698734283447, mean p set: 0.4504234194755554
loss_pred:0.01737167313694954, decouple_loss:0.001141146058216691
loss_pred:0.018110962584614754, decouple_loss:0.0011853610631078482
Iteration: 548, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490223824977875, gen p mean: -0.04594632610678673, mean p set: 0.4495026767253876
loss_pred:0.015982529148459435, decouple_loss:0.0010544724063947797
The modified gen p mean: 0.4521111249923706, gen p mean: -0.03858936205506325, mean p set: 0.4525914490222931The modified gen p mean: 0.4497916102409363, gen p mean: -0.04202371463179588, mean p set: 0.45027193427085876
loss_pred:0.017301540821790695, decouple_loss:0.0011824015527963638
loss_pred:0.016819268465042114, decouple_loss:0.0010515169706195593
Iteration: 549, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45123109221458435, gen p mean: -0.04392734169960022, mean p set: 0.45171138644218445
loss_pred:0.017033353447914124, decouple_loss:0.0009881614241749048
The modified gen p mean: 0.45002949237823486, gen p mean: -0.05023619905114174, mean p set: 0.4505097270011902The modified gen p mean: 0.449367880821228, gen p mean: -0.047970760613679886, mean p set: 0.4498482048511505
loss_pred:0.01648217998445034, decouple_loss:0.0011540348641574383
loss_pred:0.016970695927739143, decouple_loss:0.0010987306013703346
Iteration: 550, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450987309217453, gen p mean: -0.043069027364254, mean p set: 0.4514676034450531
loss_pred:0.01740155555307865, decouple_loss:0.0010749256471171975
The modified gen p mean: 0.45040997862815857, gen p mean: -0.04293237626552582, mean p set: 0.45089030265808105The modified gen p mean: 0.44960305094718933, gen p mean: -0.04860321432352066, mean p set: 0.45008331537246704
loss_pred:0.016396092250943184, decouple_loss:0.0010082671651616693
loss_pred:0.01763058453798294, decouple_loss:0.0010740566067397594
2023-05-02 04:47:09 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.05742058530449867, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.05315036326646805, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.053225867450237274, mean p set: 0.4500633478164673
loss_pred:0.018342675641179085, decouple_loss:0.0011179132852703333
loss_pred:0.017261052504181862, decouple_loss:0.001131033175624907
loss_pred:0.01736965775489807, decouple_loss:0.0011077531380578876
WV_0_PC_1_EH_0_PS_40, loss: 0.017713740468025208, avg_mse: 0.025399362668395042
current test mse: 0.025399
Iteration: 551, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45184168219566345, gen p mean: -0.047774672508239746, mean p set: 0.45232194662094116
The modified gen p mean: 0.448866069316864, gen p mean: -0.04850032180547714, mean p set: 0.4493463933467865
The modified gen p mean: 0.45179152488708496, gen p mean: -0.04591870680451393, mean p set: 0.45227181911468506
loss_pred:0.0169377438724041, decouple_loss:0.0012354718055576086
loss_pred:0.016883159056305885, decouple_loss:0.001243125181645155
loss_pred:0.017854997888207436, decouple_loss:0.0010722227161750197
Iteration: 552, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490245580673218, gen p mean: -0.04924049973487854, mean p set: 0.4495048522949219
The modified gen p mean: 0.4519024193286896, gen p mean: -0.0501873679459095, mean p set: 0.4523826837539673
loss_pred:0.016827499493956566, decouple_loss:0.001359443413093686
loss_pred:0.01640552282333374, decouple_loss:0.0011548183392733335
The modified gen p mean: 0.4496305584907532, gen p mean: -0.04892900958657265, mean p set: 0.45011085271835327
loss_pred:0.01717059500515461, decouple_loss:0.0010329249780625105
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012019_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012019_3_24hr.npz
NaN value num: 0
Iteration: 553, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469608664512634, gen p mean: -0.05693550035357475, mean p set: 0.4474412202835083
loss_pred:0.017830463126301765, decouple_loss:0.0011809549760073423
The modified gen p mean: 0.44954463839530945, gen p mean: -0.05438438802957535, mean p set: 0.45002496242523193The modified gen p mean: 0.4479981064796448, gen p mean: -0.06086673587560654, mean p set: 0.44847843050956726
loss_pred:0.018073655664920807, decouple_loss:0.001103052287362516
loss_pred:0.017677877098321915, decouple_loss:0.0011281967163085938
Iteration: 554, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493086040019989, gen p mean: -0.05576486140489578, mean p set: 0.449788898229599
loss_pred:0.018112912774086, decouple_loss:0.0013763319002464414
The modified gen p mean: 0.44989821314811707, gen p mean: -0.05515163391828537, mean p set: 0.45037850737571716The modified gen p mean: 0.4493502676486969, gen p mean: -0.05715062469244003, mean p set: 0.449830561876297
loss_pred:0.0176787618547678, decouple_loss:0.0014174244133755565
loss_pred:0.017713384702801704, decouple_loss:0.0012005396420136094
Iteration: 555, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501849114894867, gen p mean: -0.05744167044758797, mean p set: 0.4506652057170868
loss_pred:0.017014117911458015, decouple_loss:0.0011069555766880512
The modified gen p mean: 0.44958388805389404, gen p mean: -0.06107141077518463, mean p set: 0.45006415247917175The modified gen p mean: 0.44697055220603943, gen p mean: -0.06024134159088135, mean p set: 0.44745081663131714
loss_pred:0.018341418355703354, decouple_loss:0.0012623972725123167
loss_pred:0.017564525827765465, decouple_loss:0.0011738990433514118
Iteration: 556, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447001188993454, gen p mean: -0.06271456927061081, mean p set: 0.4474814832210541
loss_pred:0.01751434989273548, decouple_loss:0.0012872210936620831
The modified gen p mean: 0.44869571924209595, gen p mean: -0.057246480137109756, mean p set: 0.44917601346969604The modified gen p mean: 0.4503835141658783, gen p mean: -0.06192251667380333, mean p set: 0.4508638381958008
loss_pred:0.01658984087407589, decouple_loss:0.0012484926264733076
loss_pred:0.01835380494594574, decouple_loss:0.0014055005740374327
Iteration: 557, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476543366909027, gen p mean: -0.060547761619091034, mean p set: 0.4481346309185028
loss_pred:0.018135391175746918, decouple_loss:0.0011700461618602276
The modified gen p mean: 0.4491023123264313, gen p mean: -0.06348053365945816, mean p set: 0.44958263635635376The modified gen p mean: 0.44840848445892334, gen p mean: -0.06299812346696854, mean p set: 0.44888877868652344
loss_pred:0.017427440732717514, decouple_loss:0.001161494292318821
loss_pred:0.017274055629968643, decouple_loss:0.0011449872981756926
Iteration: 558, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484270215034485, gen p mean: -0.06795600056648254, mean p set: 0.4489073157310486
loss_pred:0.017819954082369804, decouple_loss:0.0011674450943246484
The modified gen p mean: 0.44856566190719604, gen p mean: -0.0607030913233757, mean p set: 0.44904592633247375The modified gen p mean: 0.44943666458129883, gen p mean: -0.06884085386991501, mean p set: 0.44991692900657654
loss_pred:0.018096253275871277, decouple_loss:0.0011893557384610176
loss_pred:0.018495582044124603, decouple_loss:0.0013674625661224127
Iteration: 559, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44855383038520813, gen p mean: -0.05855882167816162, mean p set: 0.4490341246128082
loss_pred:0.0167275108397007, decouple_loss:0.0014211456291377544
The modified gen p mean: 0.44730862975120544, gen p mean: -0.06379658728837967, mean p set: 0.44778892397880554The modified gen p mean: 0.4487517476081848, gen p mean: -0.06487885862588882, mean p set: 0.4492320418357849
loss_pred:0.01725609600543976, decouple_loss:0.0014622273156419396
loss_pred:0.0175072830170393, decouple_loss:0.0011768147815018892
Iteration: 560, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478062391281128, gen p mean: -0.06576884537935257, mean p set: 0.4482865631580353
loss_pred:0.017867838963866234, decouple_loss:0.0011502065462991595
The modified gen p mean: 0.4495466649532318, gen p mean: -0.057653021067380905, mean p set: 0.45002689957618713The modified gen p mean: 0.44869694113731384, gen p mean: -0.0631929486989975, mean p set: 0.44917726516723633
loss_pred:0.017574163153767586, decouple_loss:0.0011588918277993798
loss_pred:0.017539341002702713, decouple_loss:0.001044686185196042
2023-05-02 04:49:37 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.0631546676158905, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.058936428278684616, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.05876393988728523, mean p set: 0.4500633478164673
loss_pred:0.01839814893901348, decouple_loss:0.0011680010939016938
loss_pred:0.01734442263841629, decouple_loss:0.0012477054260671139
loss_pred:0.017385924234986305, decouple_loss:0.0011546090245246887
WV_0_PC_1_EH_0_PS_40, loss: 0.01776900514960289, avg_mse: 0.02546289749443531
current test mse: 0.025463
Iteration: 561, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475134313106537, gen p mean: -0.06196744740009308, mean p set: 0.4479937255382538
The modified gen p mean: 0.45017313957214355, gen p mean: -0.06450032442808151, mean p set: 0.45065340399742126
The modified gen p mean: 0.4491044580936432, gen p mean: -0.06127673387527466, mean p set: 0.4495847821235657
loss_pred:0.017409488558769226, decouple_loss:0.0014500021934509277
loss_pred:0.017176585271954536, decouple_loss:0.0013958754716441035
loss_pred:0.017375042662024498, decouple_loss:0.0011504399590194225
Iteration: 562, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45018404722213745, gen p mean: -0.058675121515989304, mean p set: 0.45066434144973755
loss_pred:0.017462529242038727, decouple_loss:0.0010680623818188906
The modified gen p mean: 0.45001980662345886, gen p mean: -0.05459187552332878, mean p set: 0.4505000710487366The modified gen p mean: 0.44981130957603455, gen p mean: -0.05765444040298462, mean p set: 0.45029157400131226
loss_pred:0.01745954528450966, decouple_loss:0.0010825457284227014
loss_pred:0.017370808869600296, decouple_loss:0.0011181766167283058
Iteration: 563, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44948768615722656, gen p mean: -0.05701861158013344, mean p set: 0.44996798038482666
loss_pred:0.017521288245916367, decouple_loss:0.0012441505677998066
The modified gen p mean: 0.44899827241897583, gen p mean: -0.05424086004495621, mean p set: 0.4494785666465759The modified gen p mean: 0.4486750662326813, gen p mean: -0.051497843116521835, mean p set: 0.44915536046028137
loss_pred:0.01758042722940445, decouple_loss:0.0011573364026844501
loss_pred:0.01791050098836422, decouple_loss:0.001368607277981937
Iteration: 564, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485195279121399, gen p mean: -0.05537722632288933, mean p set: 0.4489997923374176
loss_pred:0.017655083909630775, decouple_loss:0.0013311038492247462
The modified gen p mean: 0.4487714469432831, gen p mean: -0.0495256707072258, mean p set: 0.44925177097320557The modified gen p mean: 0.45032182335853577, gen p mean: -0.0542522631585598, mean p set: 0.45080211758613586
loss_pred:0.0175013467669487, decouple_loss:0.0015375399962067604
loss_pred:0.017274076119065285, decouple_loss:0.0017110682092607021
Iteration: 565, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490557014942169, gen p mean: -0.05365562438964844, mean p set: 0.44953596591949463
loss_pred:0.017346646636724472, decouple_loss:0.0011775766033679247
The modified gen p mean: 0.44785863161087036, gen p mean: -0.05181568115949631, mean p set: 0.44833892583847046The modified gen p mean: 0.44812843203544617, gen p mean: -0.04585792496800423, mean p set: 0.44860872626304626
loss_pred:0.017707224935293198, decouple_loss:0.0012081064051017165
loss_pred:0.01669544167816639, decouple_loss:0.0011979597620666027
Iteration: 566, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490993618965149, gen p mean: -0.04981065168976784, mean p set: 0.449579656124115
loss_pred:0.017690647393465042, decouple_loss:0.001429754658602178
The modified gen p mean: 0.4484054744243622, gen p mean: -0.051957957446575165, mean p set: 0.4488857388496399The modified gen p mean: 0.44894909858703613, gen p mean: -0.043990589678287506, mean p set: 0.4494294226169586
loss_pred:0.017501596361398697, decouple_loss:0.0015976366121321917
loss_pred:0.017599351704120636, decouple_loss:0.0013619499513879418
Iteration: 567, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447456419467926, gen p mean: -0.052397552877664566, mean p set: 0.4479367434978485
loss_pred:0.016705112531781197, decouple_loss:0.0010529982391744852
The modified gen p mean: 0.4493815302848816, gen p mean: -0.05201278254389763, mean p set: 0.4498618543148041The modified gen p mean: 0.44922003149986267, gen p mean: -0.05406839773058891, mean p set: 0.44970032572746277
loss_pred:0.016993699595332146, decouple_loss:0.0010682495776563883
loss_pred:0.01753063127398491, decouple_loss:0.001057154731824994
Iteration: 568, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44828230142593384, gen p mean: -0.0589422844350338, mean p set: 0.4487626254558563
loss_pred:0.01695890538394451, decouple_loss:0.001093648374080658
The modified gen p mean: 0.4507370889186859, gen p mean: -0.05617261305451393, mean p set: 0.451217383146286The modified gen p mean: 0.44789648056030273, gen p mean: -0.05233431234955788, mean p set: 0.44837674498558044
loss_pred:0.016896573826670647, decouple_loss:0.001261456054635346
loss_pred:0.01641077548265457, decouple_loss:0.0011878869263455272
Iteration: 569, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487094581127167, gen p mean: -0.055748436599969864, mean p set: 0.4491897523403168
loss_pred:0.017352648079395294, decouple_loss:0.0011409188155084848
The modified gen p mean: 0.44901084899902344, gen p mean: -0.05479152128100395, mean p set: 0.44949114322662354The modified gen p mean: 0.44915780425071716, gen p mean: -0.055939361453056335, mean p set: 0.44963809847831726
loss_pred:0.017087047919631004, decouple_loss:0.0011503801215440035
loss_pred:0.017022594809532166, decouple_loss:0.0010709045454859734
Iteration: 570, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44962507486343384, gen p mean: -0.0592970997095108, mean p set: 0.45010536909103394
loss_pred:0.017559269443154335, decouple_loss:0.0010890013072639704
The modified gen p mean: 0.4491068422794342, gen p mean: -0.05507376790046692, mean p set: 0.4495871365070343The modified gen p mean: 0.4495875835418701, gen p mean: -0.05940592288970947, mean p set: 0.4500678777694702
loss_pred:0.017560221254825592, decouple_loss:0.00104897643905133
loss_pred:0.016917655244469643, decouple_loss:0.0010259668342769146
2023-05-02 04:51:32 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.05915570631623268, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830535888672, gen p mean: -0.05515576899051666, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.05526607483625412, mean p set: 0.45035696029663086
loss_pred:0.018419384956359863, decouple_loss:0.0011103113647550344
loss_pred:0.0174036156386137, decouple_loss:0.0011896671494469047
loss_pred:0.01737174019217491, decouple_loss:0.0012262293603271246
WV_0_PC_1_EH_0_PS_40, loss: 0.017790351063013077, avg_mse: 0.025535864755511284
current test mse: 0.025536
Iteration: 571, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497879445552826, gen p mean: -0.05535721033811569, mean p set: 0.4502682387828827
The modified gen p mean: 0.4474480152130127, gen p mean: -0.05995145067572594, mean p set: 0.4479283094406128
The modified gen p mean: 0.4487400949001312, gen p mean: -0.052339181303977966, mean p set: 0.4492203891277313
loss_pred:0.016977641731500626, decouple_loss:0.0011743293143808842
loss_pred:0.01762479543685913, decouple_loss:0.0011133829830214381
loss_pred:0.017487328499555588, decouple_loss:0.0011201439192518592
Iteration: 572, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479564130306244, gen p mean: -0.05404776707291603, mean p set: 0.4484367072582245
loss_pred:0.017407208681106567, decouple_loss:0.001107883988879621
The modified gen p mean: 0.4475889503955841, gen p mean: -0.060614656656980515, mean p set: 0.4480692446231842The modified gen p mean: 0.4494367837905884, gen p mean: -0.05442529916763306, mean p set: 0.4499170780181885
loss_pred:0.017070334404706955, decouple_loss:0.001020677387714386
loss_pred:0.016833964735269547, decouple_loss:0.000988418236374855
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012017_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012017_3_24hr.npz
NaN value num: 0
Iteration: 573, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44897353649139404, gen p mean: -0.04745155945420265, mean p set: 0.44945380091667175
loss_pred:0.016877422109246254, decouple_loss:0.0012878933921456337
The modified gen p mean: 0.4488689601421356, gen p mean: -0.04683080315589905, mean p set: 0.4493492543697357The modified gen p mean: 0.4509466290473938, gen p mean: -0.041299957782030106, mean p set: 0.4514269232749939
loss_pred:0.016988996416330338, decouple_loss:0.0013890631962567568
loss_pred:0.017160845920443535, decouple_loss:0.001418656436726451
Iteration: 574, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498642385005951, gen p mean: -0.051154475659132004, mean p set: 0.4503445625305176
loss_pred:0.01677725277841091, decouple_loss:0.0012166369706392288
The modified gen p mean: 0.45033565163612366, gen p mean: -0.04767373576760292, mean p set: 0.45081597566604614The modified gen p mean: 0.44945964217185974, gen p mean: -0.0473976768553257, mean p set: 0.44993993639945984
loss_pred:0.016611497849225998, decouple_loss:0.001107585965655744
loss_pred:0.01727599836885929, decouple_loss:0.0011947897728532553
Iteration: 575, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45016372203826904, gen p mean: -0.0439768023788929, mean p set: 0.45064401626586914
loss_pred:0.016475090757012367, decouple_loss:0.0011394604807719588
The modified gen p mean: 0.4508129060268402, gen p mean: -0.049389004707336426, mean p set: 0.4512932300567627The modified gen p mean: 0.4511813223361969, gen p mean: -0.04239585995674133, mean p set: 0.451661616563797
loss_pred:0.016164731234312057, decouple_loss:0.0010995847405865788
loss_pred:0.016545860096812248, decouple_loss:0.0010469491826370358
Iteration: 576, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44987753033638, gen p mean: -0.054183878004550934, mean p set: 0.4503578245639801
loss_pred:0.016944589093327522, decouple_loss:0.0012152052950114012
The modified gen p mean: 0.45019641518592834, gen p mean: -0.05124802142381668, mean p set: 0.45067667961120605The modified gen p mean: 0.44983845949172974, gen p mean: -0.04571259766817093, mean p set: 0.45031872391700745
loss_pred:0.016414623707532883, decouple_loss:0.0010955907637253404
loss_pred:0.016037220135331154, decouple_loss:0.0010859566973522305
Iteration: 577, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45056432485580444, gen p mean: -0.05173134803771973, mean p set: 0.45104461908340454
loss_pred:0.01668114773929119, decouple_loss:0.0011638025753200054
The modified gen p mean: 0.44822803139686584, gen p mean: -0.04168260097503662, mean p set: 0.44870832562446594The modified gen p mean: 0.44889262318611145, gen p mean: -0.04865849018096924, mean p set: 0.44937294721603394
loss_pred:0.017056018114089966, decouple_loss:0.001084612333215773
loss_pred:0.016140982508659363, decouple_loss:0.001051711500622332
Iteration: 578, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44992145895957947, gen p mean: -0.04930585250258446, mean p set: 0.45040175318717957
loss_pred:0.016134697943925858, decouple_loss:0.0011890970636159182
The modified gen p mean: 0.451181560754776, gen p mean: -0.04870776832103729, mean p set: 0.4516618549823761The modified gen p mean: 0.45051079988479614, gen p mean: -0.049118537455797195, mean p set: 0.45099109411239624
loss_pred:0.01595677062869072, decouple_loss:0.0011010465677827597
loss_pred:0.01623806729912758, decouple_loss:0.0010429854737594724
Iteration: 579, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44860315322875977, gen p mean: -0.04515065252780914, mean p set: 0.44908347725868225
loss_pred:0.016512298956513405, decouple_loss:0.001117695588618517
The modified gen p mean: 0.4502236843109131, gen p mean: -0.0528750903904438, mean p set: 0.4507039785385132The modified gen p mean: 0.44883400201797485, gen p mean: -0.04347425326704979, mean p set: 0.44931429624557495
loss_pred:0.016167370602488518, decouple_loss:0.000990680418908596
loss_pred:0.017146676778793335, decouple_loss:0.001153317978605628
Iteration: 580, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495700001716614, gen p mean: -0.04554920271039009, mean p set: 0.45005032420158386
loss_pred:0.016118057072162628, decouple_loss:0.0010806068312376738
The modified gen p mean: 0.4495130479335785, gen p mean: -0.04708796367049217, mean p set: 0.4499933123588562The modified gen p mean: 0.4482896029949188, gen p mean: -0.0464659221470356, mean p set: 0.4487698972225189
loss_pred:0.016968635842204094, decouple_loss:0.0011542600113898516
loss_pred:0.01610509678721428, decouple_loss:0.001151221338659525
2023-05-02 04:54:07 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.05412894859910011, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.05026181414723396, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.05025323107838631, mean p set: 0.4500633478164673
loss_pred:0.018423667177557945, decouple_loss:0.0013755583204329014
loss_pred:0.017348812893033028, decouple_loss:0.0011710978578776121
loss_pred:0.01739473082125187, decouple_loss:0.0012021346483379602
WV_0_PC_1_EH_0_PS_40, loss: 0.017784884199500084, avg_mse: 0.02550783008337021
current test mse: 0.025508
Iteration: 581, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45004984736442566, gen p mean: -0.04858846589922905, mean p set: 0.45053014159202576
The modified gen p mean: 0.45127686858177185, gen p mean: -0.042032960802316666, mean p set: 0.45175716280937195
The modified gen p mean: 0.4508385956287384, gen p mean: -0.0466700941324234, mean p set: 0.4513188898563385
loss_pred:0.016471274197101593, decouple_loss:0.0013601960381492972
loss_pred:0.016159899532794952, decouple_loss:0.0012364593567326665
loss_pred:0.016947411000728607, decouple_loss:0.0013095646863803267
Iteration: 582, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499850869178772, gen p mean: -0.04680083692073822, mean p set: 0.4504653811454773
loss_pred:0.01598772592842579, decouple_loss:0.001078509259968996
The modified gen p mean: 0.4501137137413025, gen p mean: -0.04256066679954529, mean p set: 0.4505939483642578The modified gen p mean: 0.4485991299152374, gen p mean: -0.04504138603806496, mean p set: 0.4490794241428375
loss_pred:0.01647796668112278, decouple_loss:0.0011604472529143095
loss_pred:0.016766497865319252, decouple_loss:0.0011677901493385434
Iteration: 583, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495947062969208, gen p mean: -0.048902854323387146, mean p set: 0.4500750005245209
loss_pred:0.01650884374976158, decouple_loss:0.001324347103945911
The modified gen p mean: 0.44997742772102356, gen p mean: -0.04380093514919281, mean p set: 0.45045775175094604The modified gen p mean: 0.45103394985198975, gen p mean: -0.04830872267484665, mean p set: 0.45151427388191223
loss_pred:0.015968769788742065, decouple_loss:0.0012830720515921712
loss_pred:0.016676178202033043, decouple_loss:0.0014060601824894547
Iteration: 584, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450148344039917, gen p mean: -0.0454656146466732, mean p set: 0.4506286382675171
loss_pred:0.016050001606345177, decouple_loss:0.00108534493483603
The modified gen p mean: 0.4504992961883545, gen p mean: -0.04880445450544357, mean p set: 0.4509795904159546The modified gen p mean: 0.4493566155433655, gen p mean: -0.046257179230451584, mean p set: 0.44983693957328796
loss_pred:0.01661127246916294, decouple_loss:0.001194770447909832
loss_pred:0.016666222363710403, decouple_loss:0.0011449781013652682
Iteration: 585, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490130841732025, gen p mean: -0.047457825392484665, mean p set: 0.449493408203125
loss_pred:0.01649499125778675, decouple_loss:0.0013154997723177075
The modified gen p mean: 0.4503641128540039, gen p mean: -0.04860526695847511, mean p set: 0.4508443772792816The modified gen p mean: 0.45013922452926636, gen p mean: -0.04556325450539589, mean p set: 0.45061951875686646
loss_pred:0.015950007364153862, decouple_loss:0.0013439543545246124
loss_pred:0.016340136528015137, decouple_loss:0.0012209246633574367
Iteration: 586, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44998276233673096, gen p mean: -0.04359830170869827, mean p set: 0.45046308636665344
loss_pred:0.016154931858181953, decouple_loss:0.001188155496492982
The modified gen p mean: 0.4503107964992523, gen p mean: -0.04668543115258217, mean p set: 0.45079106092453003The modified gen p mean: 0.45019397139549255, gen p mean: -0.04186699539422989, mean p set: 0.45067429542541504
loss_pred:0.016013726592063904, decouple_loss:0.001139650703407824
loss_pred:0.0163434986025095, decouple_loss:0.0011471981415525079
Iteration: 587, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45033618807792664, gen p mean: -0.0383334644138813, mean p set: 0.4508165121078491
loss_pred:0.016148125752806664, decouple_loss:0.0011561629362404346
The modified gen p mean: 0.44889456033706665, gen p mean: -0.04393593594431877, mean p set: 0.44937488436698914The modified gen p mean: 0.450810045003891, gen p mean: -0.04534618929028511, mean p set: 0.4512903094291687
loss_pred:0.01625540480017662, decouple_loss:0.0012413226068019867
loss_pred:0.016645489260554314, decouple_loss:0.0012393679935485125
Iteration: 588, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482422471046448, gen p mean: -0.041805434972047806, mean p set: 0.4487225413322449
loss_pred:0.016197869554162025, decouple_loss:0.0011518584797158837
The modified gen p mean: 0.4498552083969116, gen p mean: -0.05160708352923393, mean p set: 0.45033547282218933The modified gen p mean: 0.4502759575843811, gen p mean: -0.0432712696492672, mean p set: 0.4507562518119812
loss_pred:0.016383113339543343, decouple_loss:0.0012698074569925666
loss_pred:0.016666868701577187, decouple_loss:0.001094146049581468
Iteration: 589, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507595896720886, gen p mean: -0.050035327672958374, mean p set: 0.4512398838996887
loss_pred:0.016899364069104195, decouple_loss:0.0010813651606440544
The modified gen p mean: 0.4494018256664276, gen p mean: -0.04968811571598053, mean p set: 0.4498820900917053The modified gen p mean: 0.45010191202163696, gen p mean: -0.049992047250270844, mean p set: 0.45058220624923706
loss_pred:0.015994740650057793, decouple_loss:0.0010606247233226895
loss_pred:0.01640697941184044, decouple_loss:0.0011620530858635902
Iteration: 590, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4509267508983612, gen p mean: -0.043370913714170456, mean p set: 0.4514070451259613
loss_pred:0.01712360791862011, decouple_loss:0.0012142159976065159
The modified gen p mean: 0.4485202133655548, gen p mean: -0.04351640120148659, mean p set: 0.4490005075931549The modified gen p mean: 0.4501436650753021, gen p mean: -0.04848941043019295, mean p set: 0.4506239891052246
loss_pred:0.016132088378071785, decouple_loss:0.0010999210644513369
loss_pred:0.015686269849538803, decouple_loss:0.0010983591200783849
2023-05-02 04:56:02 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.05494716763496399, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.05067805200815201, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.05087903514504433, mean p set: 0.4500633478164673
loss_pred:0.01841196045279503, decouple_loss:0.0014152901712805033
loss_pred:0.01729392074048519, decouple_loss:0.0011908883461728692
loss_pred:0.01743372716009617, decouple_loss:0.0012023585150018334
WV_0_PC_1_EH_0_PS_40, loss: 0.01777667924761772, avg_mse: 0.025514457374811172
current test mse: 0.025514
Iteration: 591, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44882988929748535, gen p mean: -0.04287939891219139, mean p set: 0.44931018352508545
The modified gen p mean: 0.4483577311038971, gen p mean: -0.04805350303649902, mean p set: 0.4488380551338196
The modified gen p mean: 0.45017290115356445, gen p mean: -0.047421883791685104, mean p set: 0.4506531357765198
loss_pred:0.016145911067724228, decouple_loss:0.0010361699387431145
loss_pred:0.01659300923347473, decouple_loss:0.0010406842920929193loss_pred:0.016371477395296097, decouple_loss:0.0010253541404381394
Iteration: 592, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498046040534973, gen p mean: -0.04156692326068878, mean p set: 0.4502848982810974
loss_pred:0.01630362868309021, decouple_loss:0.001188026275485754
The modified gen p mean: 0.44861552119255066, gen p mean: -0.045980893075466156, mean p set: 0.44909584522247314The modified gen p mean: 0.44860726594924927, gen p mean: -0.04250115528702736, mean p set: 0.44908758997917175
loss_pred:0.01619221270084381, decouple_loss:0.0011088168248534203
loss_pred:0.016800925135612488, decouple_loss:0.0011651241220533848
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012020_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012020_3_24hr.npz
NaN value num: 0
Iteration: 593, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488781988620758, gen p mean: -0.05293013155460358, mean p set: 0.4493584930896759
loss_pred:0.01913588121533394, decouple_loss:0.0011025683488696814
The modified gen p mean: 0.45013242959976196, gen p mean: -0.0529911182820797, mean p set: 0.45061272382736206The modified gen p mean: 0.448944091796875, gen p mean: -0.0518617108464241, mean p set: 0.4494244158267975
loss_pred:0.018638208508491516, decouple_loss:0.0012767165899276733
loss_pred:0.017095167189836502, decouple_loss:0.0012122484622523189
Iteration: 594, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45037803053855896, gen p mean: -0.05383256450295448, mean p set: 0.45085832476615906
loss_pred:0.01811397075653076, decouple_loss:0.0011231193784624338
The modified gen p mean: 0.4497183859348297, gen p mean: -0.04917634651064873, mean p set: 0.4501986801624298The modified gen p mean: 0.4497492015361786, gen p mean: -0.05276927724480629, mean p set: 0.4502294957637787
loss_pred:0.01854543387889862, decouple_loss:0.0011191020021215081
loss_pred:0.017526017501950264, decouple_loss:0.0010885794181376696
Iteration: 595, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489402174949646, gen p mean: -0.052725695073604584, mean p set: 0.4494204819202423
loss_pred:0.018746284767985344, decouple_loss:0.0012936802813783288
The modified gen p mean: 0.4499054551124573, gen p mean: -0.05378825590014458, mean p set: 0.450385719537735The modified gen p mean: 0.4494567811489105, gen p mean: -0.04845895990729332, mean p set: 0.4499370753765106
loss_pred:0.01791529729962349, decouple_loss:0.0011399189243093133
loss_pred:0.017622552812099457, decouple_loss:0.0011887967120856047
Iteration: 596, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44987934827804565, gen p mean: -0.06046802178025246, mean p set: 0.45035961270332336
loss_pred:0.018365483731031418, decouple_loss:0.001122338930144906
The modified gen p mean: 0.44877198338508606, gen p mean: -0.048832572996616364, mean p set: 0.44925227761268616The modified gen p mean: 0.4490707218647003, gen p mean: -0.058683764189481735, mean p set: 0.4495510160923004
loss_pred:0.017869452014565468, decouple_loss:0.0011168810306116939
loss_pred:0.019399741664528847, decouple_loss:0.001231173169799149
Iteration: 597, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44948074221611023, gen p mean: -0.05393407493829727, mean p set: 0.4499610364437103
loss_pred:0.017786148935556412, decouple_loss:0.001121793407946825
The modified gen p mean: 0.4496626853942871, gen p mean: -0.0557195320725441, mean p set: 0.4501429796218872The modified gen p mean: 0.44935736060142517, gen p mean: -0.05572297051548958, mean p set: 0.44983765482902527
loss_pred:0.01660074293613434, decouple_loss:0.0011854462791234255
loss_pred:0.017009973526000977, decouple_loss:0.0011486263247206807
Iteration: 598, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498935341835022, gen p mean: -0.05225605517625809, mean p set: 0.4503738284111023
loss_pred:0.017413314431905746, decouple_loss:0.0012381041888147593
The modified gen p mean: 0.44919371604919434, gen p mean: -0.05177829787135124, mean p set: 0.44967401027679443The modified gen p mean: 0.4484509229660034, gen p mean: -0.05122390389442444, mean p set: 0.4489312171936035
loss_pred:0.017336208373308182, decouple_loss:0.0011084735160693526
loss_pred:0.017841486260294914, decouple_loss:0.0011121529387310147
Iteration: 599, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44849124550819397, gen p mean: -0.052575498819351196, mean p set: 0.44897153973579407
loss_pred:0.017554162070155144, decouple_loss:0.0011801882646977901
The modified gen p mean: 0.4497009813785553, gen p mean: -0.056279681622982025, mean p set: 0.4501812756061554The modified gen p mean: 0.4489961862564087, gen p mean: -0.053835272789001465, mean p set: 0.4494764804840088
loss_pred:0.01780790090560913, decouple_loss:0.0012686927802860737
loss_pred:0.01714423857629299, decouple_loss:0.0012158022727817297
Iteration: 600, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492141306400299, gen p mean: -0.05949627235531807, mean p set: 0.44969442486763
loss_pred:0.01910209469497204, decouple_loss:0.0011031635804101825
The modified gen p mean: 0.4495718479156494, gen p mean: -0.05290963500738144, mean p set: 0.4500521421432495The modified gen p mean: 0.44969406723976135, gen p mean: -0.05754463002085686, mean p set: 0.45017439126968384
loss_pred:0.016796715557575226, decouple_loss:0.0011823001550510526
loss_pred:0.018325941637158394, decouple_loss:0.0010984117398038507
2023-05-02 04:58:43 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.056210439652204514, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.05224529653787613, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.05236145108938217, mean p set: 0.4500633478164673
loss_pred:0.01837397739291191, decouple_loss:0.001321398071013391
loss_pred:0.017285464331507683, decouple_loss:0.0013883549254387617
loss_pred:0.017428845167160034, decouple_loss:0.0013339135330170393
WV_0_PC_1_EH_0_PS_40, loss: 0.017763491719961166, avg_mse: 0.02545410767197609
current test mse: 0.025454
Iteration: 601, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494662880897522, gen p mean: -0.055367156863212585, mean p set: 0.4499465525150299
The modified gen p mean: 0.4492073953151703, gen p mean: -0.05588001385331154, mean p set: 0.4496876895427704
The modified gen p mean: 0.4499937891960144, gen p mean: -0.050980038940906525, mean p set: 0.4504740536212921
loss_pred:0.01734739914536476, decouple_loss:0.0011857367353513837
loss_pred:0.016963133588433266, decouple_loss:0.0013356379931792617
loss_pred:0.01793937385082245, decouple_loss:0.0012199555058032274
Iteration: 602, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44877657294273376, gen p mean: -0.054289981722831726, mean p set: 0.44925686717033386
loss_pred:0.01762976311147213, decouple_loss:0.0010441223857924342
The modified gen p mean: 0.4492981731891632, gen p mean: -0.054942596703767776, mean p set: 0.4497784972190857The modified gen p mean: 0.44872575998306274, gen p mean: -0.05144227296113968, mean p set: 0.44920605421066284
loss_pred:0.017900433391332626, decouple_loss:0.0012284619733691216
loss_pred:0.01946263015270233, decouple_loss:0.001022898475639522
Iteration: 603, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44877368211746216, gen p mean: -0.05176836624741554, mean p set: 0.44925400614738464
loss_pred:0.017560144886374474, decouple_loss:0.0012786054285243154
The modified gen p mean: 0.44904962182044983, gen p mean: -0.051434800028800964, mean p set: 0.4495299160480499The modified gen p mean: 0.44819748401641846, gen p mean: -0.04974871873855591, mean p set: 0.44867777824401855
loss_pred:0.01762695610523224, decouple_loss:0.0013050218112766743
loss_pred:0.017504030838608742, decouple_loss:0.0012665443355217576
Iteration: 604, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449593186378479, gen p mean: -0.045875247567892075, mean p set: 0.4500735104084015
loss_pred:0.017492659389972687, decouple_loss:0.00115428795106709
The modified gen p mean: 0.44881120324134827, gen p mean: -0.04939825460314751, mean p set: 0.44929149746894836The modified gen p mean: 0.44827064871788025, gen p mean: -0.04730448126792908, mean p set: 0.44875091314315796
loss_pred:0.0181792713701725, decouple_loss:0.0012990526156499982
loss_pred:0.018043147400021553, decouple_loss:0.0012436741963028908
Iteration: 605, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486444592475891, gen p mean: -0.0430251769721508, mean p set: 0.4491247832775116
loss_pred:0.01755675859749317, decouple_loss:0.0010441099293529987
The modified gen p mean: 0.4496510624885559, gen p mean: -0.04496672749519348, mean p set: 0.4501313269138336The modified gen p mean: 0.4482547640800476, gen p mean: -0.04041770100593567, mean p set: 0.4487350583076477
loss_pred:0.017620693892240524, decouple_loss:0.0012096961727365851
loss_pred:0.017593009397387505, decouple_loss:0.0010294306557625532
Iteration: 606, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497392773628235, gen p mean: -0.04919425770640373, mean p set: 0.4502195417881012
loss_pred:0.0176850575953722, decouple_loss:0.0011547296307981014
The modified gen p mean: 0.44947925209999084, gen p mean: -0.04359622672200203, mean p set: 0.44995957612991333The modified gen p mean: 0.4486953318119049, gen p mean: -0.038837678730487823, mean p set: 0.449175626039505
loss_pred:0.017598574981093407, decouple_loss:0.0012642969377338886
loss_pred:0.01806739717721939, decouple_loss:0.0011434946209192276
Iteration: 607, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44963371753692627, gen p mean: -0.05283425375819206, mean p set: 0.450113981962204
loss_pred:0.017716262489557266, decouple_loss:0.0013459422625601292
The modified gen p mean: 0.44972893595695496, gen p mean: -0.049029115587472916, mean p set: 0.45020923018455505The modified gen p mean: 0.44922593235969543, gen p mean: -0.04659062251448631, mean p set: 0.4497062563896179
loss_pred:0.018149999901652336, decouple_loss:0.0011597018456086516
loss_pred:0.01762918196618557, decouple_loss:0.0011607075575739145
Iteration: 608, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44816696643829346, gen p mean: -0.052501995116472244, mean p set: 0.44864723086357117
loss_pred:0.017695382237434387, decouple_loss:0.0010851348051801324
The modified gen p mean: 0.44985097646713257, gen p mean: -0.05116412788629532, mean p set: 0.45033130049705505The modified gen p mean: 0.44971853494644165, gen p mean: -0.05203409865498543, mean p set: 0.45019885897636414
loss_pred:0.018152639269828796, decouple_loss:0.001134524936787784
loss_pred:0.018013980239629745, decouple_loss:0.001183218089863658
Iteration: 609, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501723051071167, gen p mean: -0.053814053535461426, mean p set: 0.4506526291370392
loss_pred:0.018470292910933495, decouple_loss:0.0012420773273333907
The modified gen p mean: 0.44917982816696167, gen p mean: -0.05267691984772682, mean p set: 0.44966015219688416The modified gen p mean: 0.4485274851322174, gen p mean: -0.048864662647247314, mean p set: 0.4490078091621399
loss_pred:0.017459671944379807, decouple_loss:0.001137919956818223
loss_pred:0.0170658640563488, decouple_loss:0.001088606775738299
Iteration: 610, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44961875677108765, gen p mean: -0.05299452319741249, mean p set: 0.45009905099868774
loss_pred:0.01807817816734314, decouple_loss:0.001312218140810728
The modified gen p mean: 0.44895654916763306, gen p mean: -0.04934680461883545, mean p set: 0.44943687319755554The modified gen p mean: 0.4487052857875824, gen p mean: -0.05067289620637894, mean p set: 0.4491855800151825
loss_pred:0.017384717240929604, decouple_loss:0.0011527310125529766
loss_pred:0.017461631447076797, decouple_loss:0.001090790145099163
2023-05-02 05:00:39 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.05555069446563721, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.051318030804395676, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.051432639360427856, mean p set: 0.4500633478164673
loss_pred:0.01824410818517208, decouple_loss:0.0011914294445887208
loss_pred:0.01722605712711811, decouple_loss:0.001110936515033245
loss_pred:0.017309844493865967, decouple_loss:0.0011342017678543925
WV_0_PC_1_EH_0_PS_40, loss: 0.01765061356127262, avg_mse: 0.025272928178310394
current test mse: 0.025273
At step 610, Best test: 0.025273
save model to /work/09012/haoli1/ls6/ERA5_PredRNN/checkpoints/WV_0_PC_1_EH_0_PS_40/model_test_schedule_sampling_DynaMean.ckpt
Iteration: 611, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44995811581611633, gen p mean: -0.05422697588801384, mean p set: 0.45043838024139404
loss_pred:0.01731259934604168, decouple_loss:0.0011786880204454064
The modified gen p mean: 0.4486680030822754, gen p mean: -0.05802495405077934, mean p set: 0.4491483271121979The modified gen p mean: 0.4481431245803833, gen p mean: -0.05149271339178085, mean p set: 0.4486234188079834
loss_pred:0.017386000603437424, decouple_loss:0.001268036081455648
loss_pred:0.01744806580245495, decouple_loss:0.0012613391736522317
Iteration: 612, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502822160720825, gen p mean: -0.05882769823074341, mean p set: 0.4507625102996826
loss_pred:0.018242869526147842, decouple_loss:0.0012711738236248493
The modified gen p mean: 0.4479087293148041, gen p mean: -0.05239273980259895, mean p set: 0.4483890235424042The modified gen p mean: 0.44854292273521423, gen p mean: -0.05088060349225998, mean p set: 0.44902318716049194
loss_pred:0.017251694574952126, decouple_loss:0.0014827628619968891
loss_pred:0.017285535112023354, decouple_loss:0.001300570322200656
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012015_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012015_3_24hr.npz
NaN value num: 0
Iteration: 613, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477511942386627, gen p mean: -0.06002272665500641, mean p set: 0.4482314884662628
loss_pred:0.015291387215256691, decouple_loss:0.0013710034545511007
The modified gen p mean: 0.448258638381958, gen p mean: -0.046320244669914246, mean p set: 0.4487389624118805The modified gen p mean: 0.44882652163505554, gen p mean: -0.048561643809080124, mean p set: 0.44930681586265564
loss_pred:0.016544457525014877, decouple_loss:0.001448209397494793
loss_pred:0.016400029882788658, decouple_loss:0.00141366315074265
Iteration: 614, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4453616142272949, gen p mean: -0.0590759813785553, mean p set: 0.44584187865257263
loss_pred:0.01572912558913231, decouple_loss:0.001217903452925384
The modified gen p mean: 0.44729089736938477, gen p mean: -0.05428849533200264, mean p set: 0.44777119159698486The modified gen p mean: 0.44798973202705383, gen p mean: -0.048715680837631226, mean p set: 0.44847002625465393
loss_pred:0.015317401848733425, decouple_loss:0.0014004455879330635
loss_pred:0.016093401238322258, decouple_loss:0.0012560845352709293
Iteration: 615, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44903576374053955, gen p mean: -0.054613128304481506, mean p set: 0.44951605796813965
The modified gen p mean: 0.4484703540802002, gen p mean: -0.05735790729522705, mean p set: 0.4489506781101227
loss_pred:0.015048285946249962, decouple_loss:0.00133074342738837
loss_pred:0.015287481248378754, decouple_loss:0.0013569799484685063
The modified gen p mean: 0.4474603533744812, gen p mean: -0.0533987395465374, mean p set: 0.4479406476020813
loss_pred:0.015023295767605305, decouple_loss:0.0013012842973694205
Iteration: 616, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44597387313842773, gen p mean: -0.05182197690010071, mean p set: 0.44645413756370544
The modified gen p mean: 0.4471625089645386, gen p mean: -0.047617822885513306, mean p set: 0.44764280319213867
loss_pred:0.014991465024650097, decouple_loss:0.001232966547831893
loss_pred:0.015260099433362484, decouple_loss:0.0012516046408563852
The modified gen p mean: 0.44821885228157043, gen p mean: -0.05427022650837898, mean p set: 0.44869908690452576
loss_pred:0.014629587531089783, decouple_loss:0.0014921401161700487
Iteration: 617, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482066035270691, gen p mean: -0.050374142825603485, mean p set: 0.4486868679523468
loss_pred:0.014768593944609165, decouple_loss:0.0012755409115925431
The modified gen p mean: 0.4485549032688141, gen p mean: -0.048262741416692734, mean p set: 0.4490351974964142The modified gen p mean: 0.44719794392585754, gen p mean: -0.05437251552939415, mean p set: 0.44767823815345764
loss_pred:0.014240662567317486, decouple_loss:0.001258455216884613
loss_pred:0.014469364657998085, decouple_loss:0.0013177817454561591
Iteration: 618, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471014440059662, gen p mean: -0.049618277698755264, mean p set: 0.4475817382335663
The modified gen p mean: 0.44732344150543213, gen p mean: -0.046641185879707336, mean p set: 0.44780370593070984
loss_pred:0.01461044792085886, decouple_loss:0.0013710280181840062
The modified gen p mean: 0.4474680721759796, gen p mean: -0.05192002281546593, mean p set: 0.4479483664035797loss_pred:0.015125008299946785, decouple_loss:0.0014406562549993396
loss_pred:0.014436797238886356, decouple_loss:0.0013218919048085809
Iteration: 619, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4463062286376953, gen p mean: -0.05368254706263542, mean p set: 0.4467865526676178
loss_pred:0.014898816123604774, decouple_loss:0.0013231984339654446
The modified gen p mean: 0.44762107729911804, gen p mean: -0.05104091763496399, mean p set: 0.4481014013290405The modified gen p mean: 0.4487364590167999, gen p mean: -0.04570571333169937, mean p set: 0.4492167532444
loss_pred:0.014576281420886517, decouple_loss:0.001408798387274146
loss_pred:0.015310565009713173, decouple_loss:0.0012375654187053442
Iteration: 620, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44919610023498535, gen p mean: -0.0408945232629776, mean p set: 0.44967639446258545
loss_pred:0.014695100486278534, decouple_loss:0.0014464606065303087
The modified gen p mean: 0.44716429710388184, gen p mean: -0.04775272309780121, mean p set: 0.44764459133148193The modified gen p mean: 0.4484391212463379, gen p mean: -0.04649607092142105, mean p set: 0.448919415473938
loss_pred:0.014120087027549744, decouple_loss:0.00150378979742527
loss_pred:0.014372967183589935, decouple_loss:0.0015117807779461145
2023-05-02 05:03:15 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.05146500840783119, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04797375947237015, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.04775656759738922, mean p set: 0.4500633478164673
loss_pred:0.019387971609830856, decouple_loss:0.0016443190397694707
loss_pred:0.018213322386145592, decouple_loss:0.0014536010567098856
loss_pred:0.018332038074731827, decouple_loss:0.0014602853916585445
WV_0_PC_1_EH_0_PS_40, loss: 0.018720414489507675, avg_mse: 0.02724725566804409
current test mse: 0.027247
Iteration: 621, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468974173069, gen p mean: -0.047630347311496735, mean p set: 0.4473777115345001
The modified gen p mean: 0.4472449719905853, gen p mean: -0.049822866916656494, mean p set: 0.4477252662181854
The modified gen p mean: 0.4490232765674591, gen p mean: -0.04543335735797882, mean p set: 0.4495036005973816
loss_pred:0.01519920863211155, decouple_loss:0.0013806864153593779
loss_pred:0.014726385474205017, decouple_loss:0.0015057047130540013loss_pred:0.015085102990269661, decouple_loss:0.0013797009596601129
Iteration: 622, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4459594190120697, gen p mean: -0.05296923965215683, mean p set: 0.4464397132396698
loss_pred:0.014732839539647102, decouple_loss:0.0013714166125282645
The modified gen p mean: 0.4480310380458832, gen p mean: -0.04744124412536621, mean p set: 0.4485113322734833The modified gen p mean: 0.44841551780700684, gen p mean: -0.05234513059258461, mean p set: 0.44889581203460693
loss_pred:0.013927950523793697, decouple_loss:0.0014417677884921432
loss_pred:0.014493227936327457, decouple_loss:0.00153890042565763
Iteration: 623, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489551782608032, gen p mean: -0.050979409366846085, mean p set: 0.4494354724884033
loss_pred:0.014308208599686623, decouple_loss:0.0014859158545732498
The modified gen p mean: 0.4485762417316437, gen p mean: -0.053676787763834, mean p set: 0.4490565061569214The modified gen p mean: 0.44597193598747253, gen p mean: -0.05470205098390579, mean p set: 0.44645223021507263
loss_pred:0.014363792724907398, decouple_loss:0.001778948586434126
loss_pred:0.01405940018594265, decouple_loss:0.001584961311891675
Iteration: 624, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44896137714385986, gen p mean: -0.04641401395201683, mean p set: 0.44944167137145996
loss_pred:0.014614061452448368, decouple_loss:0.0012136782752349973
The modified gen p mean: 0.4475211799144745, gen p mean: -0.05317201837897301, mean p set: 0.4480014741420746The modified gen p mean: 0.4481883943080902, gen p mean: -0.05363418906927109, mean p set: 0.4486686885356903
loss_pred:0.013978165574371815, decouple_loss:0.0012834422523155808
loss_pred:0.01432571280747652, decouple_loss:0.0015255535254254937
Iteration: 625, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44764211773872375, gen p mean: -0.05793943256139755, mean p set: 0.44812238216400146
loss_pred:0.014319014735519886, decouple_loss:0.0014928373275324702
The modified gen p mean: 0.4475595951080322, gen p mean: -0.05113141983747482, mean p set: 0.4480399191379547The modified gen p mean: 0.4471522867679596, gen p mean: -0.052515909075737, mean p set: 0.4476326107978821
loss_pred:0.01366617064923048, decouple_loss:0.0015203419607132673
loss_pred:0.01380777359008789, decouple_loss:0.0013943426311016083
Iteration: 626, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486062824726105, gen p mean: -0.05561528727412224, mean p set: 0.44908660650253296
loss_pred:0.013820267282426357, decouple_loss:0.0016892680432647467
The modified gen p mean: 0.4483889937400818, gen p mean: -0.050636518746614456, mean p set: 0.4488692581653595The modified gen p mean: 0.44835665822029114, gen p mean: -0.0546611063182354, mean p set: 0.4488369822502136
loss_pred:0.01425433624535799, decouple_loss:0.0014462099643424153
loss_pred:0.014257471077144146, decouple_loss:0.0014009465230628848
Iteration: 627, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44746753573417664, gen p mean: -0.056239522993564606, mean p set: 0.44794782996177673
loss_pred:0.014322059229016304, decouple_loss:0.0014242808101698756
The modified gen p mean: 0.44778892397880554, gen p mean: -0.056340087205171585, mean p set: 0.44826918840408325The modified gen p mean: 0.44937098026275635, gen p mean: -0.046544864773750305, mean p set: 0.44985130429267883
loss_pred:0.01402218360453844, decouple_loss:0.0014239867450669408
loss_pred:0.014261944219470024, decouple_loss:0.0013624695129692554
Iteration: 628, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480283856391907, gen p mean: -0.04936660826206207, mean p set: 0.44850867986679077
loss_pred:0.014041732996702194, decouple_loss:0.0014360963832587004
The modified gen p mean: 0.4482795298099518, gen p mean: -0.04924159124493599, mean p set: 0.4487598240375519The modified gen p mean: 0.447185218334198, gen p mean: -0.04897100850939751, mean p set: 0.4476655125617981
loss_pred:0.014351633377373219, decouple_loss:0.001431780867278576
loss_pred:0.013407173566520214, decouple_loss:0.0012775375507771969
Iteration: 629, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44818437099456787, gen p mean: -0.05043076351284981, mean p set: 0.4486646354198456
loss_pred:0.013917465694248676, decouple_loss:0.0012712259776890278
The modified gen p mean: 0.44793835282325745, gen p mean: -0.04769089072942734, mean p set: 0.44841864705085754The modified gen p mean: 0.44779133796691895, gen p mean: -0.04927193745970726, mean p set: 0.44827160239219666
loss_pred:0.013939653523266315, decouple_loss:0.0012900251895189285
loss_pred:0.014706876128911972, decouple_loss:0.001296894159168005
Iteration: 630, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477037787437439, gen p mean: -0.05388602986931801, mean p set: 0.448184072971344
loss_pred:0.01368451863527298, decouple_loss:0.0013821936445310712
The modified gen p mean: 0.4484618008136749, gen p mean: -0.04819800332188606, mean p set: 0.4489421248435974The modified gen p mean: 0.4474125802516937, gen p mean: -0.05083954334259033, mean p set: 0.4478928744792938
loss_pred:0.013727137818932533, decouple_loss:0.001226159161888063
loss_pred:0.013640174642205238, decouple_loss:0.0012933813268318772
2023-05-02 05:05:11 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.05167536437511444, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04847957193851471, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.0477566197514534, mean p set: 0.4500633478164673
loss_pred:0.019222291186451912, decouple_loss:0.001328343409113586
loss_pred:0.018092716112732887, decouple_loss:0.0013628164306282997
loss_pred:0.018097084015607834, decouple_loss:0.0013462655479088426
WV_0_PC_1_EH_0_PS_40, loss: 0.018537988886237144, avg_mse: 0.026994263753294945
current test mse: 0.026994
Iteration: 631, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447562575340271, gen p mean: -0.05047359690070152, mean p set: 0.4480428397655487
The modified gen p mean: 0.445667028427124, gen p mean: -0.05480208992958069, mean p set: 0.4461473524570465
The modified gen p mean: 0.4479886591434479, gen p mean: -0.05166633799672127, mean p set: 0.448468953371048
loss_pred:0.013900375925004482, decouple_loss:0.0013276432873681188
loss_pred:0.014109895564615726, decouple_loss:0.0014790568966418505loss_pred:0.013522230088710785, decouple_loss:0.0013439701870083809
Iteration: 632, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44641435146331787, gen p mean: -0.05402914807200432, mean p set: 0.44689464569091797
loss_pred:0.014225789345800877, decouple_loss:0.0012745549902319908
The modified gen p mean: 0.446358859539032, gen p mean: -0.04819076135754585, mean p set: 0.4468391239643097The modified gen p mean: 0.4479629695415497, gen p mean: -0.05484749749302864, mean p set: 0.44844329357147217
loss_pred:0.014036973938345909, decouple_loss:0.0012146898079663515
loss_pred:0.013686126098036766, decouple_loss:0.0013548826100304723
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012015_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012015_3_24hr.npz
NaN value num: 0
Iteration: 633, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505573809146881, gen p mean: -0.045631203800439835, mean p set: 0.4510376751422882
loss_pred:0.016981061547994614, decouple_loss:0.0014620688743889332
The modified gen p mean: 0.4501286447048187, gen p mean: -0.048563145101070404, mean p set: 0.4506089687347412The modified gen p mean: 0.4507257342338562, gen p mean: -0.04573047161102295, mean p set: 0.4512060284614563
loss_pred:0.017386529594659805, decouple_loss:0.0015423698350787163
loss_pred:0.0170497577637434, decouple_loss:0.0015222430229187012
Iteration: 634, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473506510257721, gen p mean: -0.04800952970981598, mean p set: 0.4478309452533722
loss_pred:0.017590684816241264, decouple_loss:0.0013280549319460988
The modified gen p mean: 0.44873711466789246, gen p mean: -0.04765763133764267, mean p set: 0.44921740889549255The modified gen p mean: 0.44674253463745117, gen p mean: -0.05087203532457352, mean p set: 0.44722285866737366
loss_pred:0.018217315897345543, decouple_loss:0.0014117163373157382
loss_pred:0.016812678426504135, decouple_loss:0.0013054775772616267
Iteration: 635, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497939646244049, gen p mean: -0.04871552437543869, mean p set: 0.4502742886543274
loss_pred:0.01769096963107586, decouple_loss:0.001349664875306189
The modified gen p mean: 0.4494977295398712, gen p mean: -0.04835659638047218, mean p set: 0.4499780237674713The modified gen p mean: 0.44912129640579224, gen p mean: -0.042575445026159286, mean p set: 0.44960159063339233
loss_pred:0.018356019631028175, decouple_loss:0.0013974757166579366
loss_pred:0.016505330801010132, decouple_loss:0.0014248632360249758
Iteration: 636, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44995397329330444, gen p mean: -0.046951774507761, mean p set: 0.45043426752090454
loss_pred:0.01660013757646084, decouple_loss:0.0014016586355865002
The modified gen p mean: 0.44786566495895386, gen p mean: -0.05448097735643387, mean p set: 0.44834598898887634The modified gen p mean: 0.45003271102905273, gen p mean: -0.044990770518779755, mean p set: 0.45051300525665283
loss_pred:0.01725682057440281, decouple_loss:0.0012944294139742851
loss_pred:0.016907688230276108, decouple_loss:0.00135597656480968
Iteration: 637, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480634927749634, gen p mean: -0.05160384252667427, mean p set: 0.4485437870025635
loss_pred:0.0178728848695755, decouple_loss:0.0012758397497236729
The modified gen p mean: 0.4490819573402405, gen p mean: -0.04892272502183914, mean p set: 0.4495622515678406The modified gen p mean: 0.4493924081325531, gen p mean: -0.053749289363622665, mean p set: 0.4498726725578308
loss_pred:0.01806938461959362, decouple_loss:0.0013196426443755627
loss_pred:0.01798369735479355, decouple_loss:0.0013961014337837696
Iteration: 638, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507047235965729, gen p mean: -0.04453530162572861, mean p set: 0.4511849880218506
loss_pred:0.016439398750662804, decouple_loss:0.0013016986194998026
The modified gen p mean: 0.45026326179504395, gen p mean: -0.048865851014852524, mean p set: 0.45074358582496643The modified gen p mean: 0.44839611649513245, gen p mean: -0.06001122668385506, mean p set: 0.44887641072273254
loss_pred:0.01728881150484085, decouple_loss:0.001384109491482377
loss_pred:0.017380930483341217, decouple_loss:0.0013820092426612973
Iteration: 639, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476284086704254, gen p mean: -0.04608309268951416, mean p set: 0.4481086730957031
loss_pred:0.017867427319288254, decouple_loss:0.0013236838858574629
The modified gen p mean: 0.4507276713848114, gen p mean: -0.04678896814584732, mean p set: 0.4512079358100891The modified gen p mean: 0.4484102725982666, gen p mean: -0.0498724989593029, mean p set: 0.4488905668258667
loss_pred:0.016250524669885635, decouple_loss:0.0012818330433219671
loss_pred:0.016947634518146515, decouple_loss:0.0013481301721185446
Iteration: 640, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44769155979156494, gen p mean: -0.047251977026462555, mean p set: 0.44817185401916504
loss_pred:0.01714528165757656, decouple_loss:0.0012452863156795502
The modified gen p mean: 0.45077434182167053, gen p mean: -0.04629813879728317, mean p set: 0.45125463604927063The modified gen p mean: 0.45010796189308167, gen p mean: -0.05076434090733528, mean p set: 0.4505882263183594
loss_pred:0.015257488004863262, decouple_loss:0.0014425027184188366
loss_pred:0.016774281859397888, decouple_loss:0.0012355662183836102
2023-05-02 05:07:43 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.05890795961022377, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.05558472499251366, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.05509338900446892, mean p set: 0.4500633478164673
loss_pred:0.018533574417233467, decouple_loss:0.0015180523041635752
loss_pred:0.01741422526538372, decouple_loss:0.0013877645833417773
loss_pred:0.017538897693157196, decouple_loss:0.0014569296035915613
WV_0_PC_1_EH_0_PS_40, loss: 0.01790161244571209, avg_mse: 0.02568621188402176
current test mse: 0.025686
Iteration: 641, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44911545515060425, gen p mean: -0.048656582832336426, mean p set: 0.44959574937820435
The modified gen p mean: 0.4500325322151184, gen p mean: -0.05207524821162224, mean p set: 0.4505128264427185
The modified gen p mean: 0.4507928788661957, gen p mean: -0.047449201345443726, mean p set: 0.4512731432914734
loss_pred:0.016179824247956276, decouple_loss:0.001412249286659062
loss_pred:0.016702624037861824, decouple_loss:0.001288301544263959
loss_pred:0.016393573954701424, decouple_loss:0.0013710801722481847
Iteration: 642, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505627155303955, gen p mean: -0.05287426337599754, mean p set: 0.4510430097579956
loss_pred:0.01648552529513836, decouple_loss:0.0011631787056103349
The modified gen p mean: 0.45025137066841125, gen p mean: -0.05319366231560707, mean p set: 0.45073163509368896The modified gen p mean: 0.4487427771091461, gen p mean: -0.06396251171827316, mean p set: 0.4492231011390686
loss_pred:0.01736900396645069, decouple_loss:0.0012058726279065013
loss_pred:0.017330296337604523, decouple_loss:0.0011485111899673939
Iteration: 643, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477318227291107, gen p mean: -0.06404173374176025, mean p set: 0.4482121169567108
loss_pred:0.01705094240605831, decouple_loss:0.001302604447118938
The modified gen p mean: 0.4507608711719513, gen p mean: -0.052056122571229935, mean p set: 0.4512411952018738The modified gen p mean: 0.4517247974872589, gen p mean: -0.05194365978240967, mean p set: 0.4522051215171814
loss_pred:0.015447794459760189, decouple_loss:0.001361922943033278
loss_pred:0.01570894941687584, decouple_loss:0.0012829020852223039
Iteration: 644, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44797125458717346, gen p mean: -0.052276547998189926, mean p set: 0.44845154881477356
loss_pred:0.016960956156253815, decouple_loss:0.0014007241697981954
The modified gen p mean: 0.4480366110801697, gen p mean: -0.057981014251708984, mean p set: 0.4485168755054474The modified gen p mean: 0.44914600253105164, gen p mean: -0.05122928321361542, mean p set: 0.44962626695632935
loss_pred:0.016634095460176468, decouple_loss:0.0014040992828086019
loss_pred:0.01735709421336651, decouple_loss:0.0012442768784239888
Iteration: 645, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482898414134979, gen p mean: -0.05253790691494942, mean p set: 0.448770135641098
loss_pred:0.016970202326774597, decouple_loss:0.001253749942407012
The modified gen p mean: 0.44891270995140076, gen p mean: -0.053646303713321686, mean p set: 0.44939300417900085The modified gen p mean: 0.44841670989990234, gen p mean: -0.05117257311940193, mean p set: 0.44889700412750244
loss_pred:0.01751631498336792, decouple_loss:0.0012601008638739586
loss_pred:0.016609685495495796, decouple_loss:0.0012635299935936928
Iteration: 646, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45105379819869995, gen p mean: -0.05040671303868294, mean p set: 0.45153409242630005
loss_pred:0.016004906967282295, decouple_loss:0.0013341535814106464
The modified gen p mean: 0.44673827290534973, gen p mean: -0.057850636541843414, mean p set: 0.44721853733062744The modified gen p mean: 0.44947001338005066, gen p mean: -0.05128719285130501, mean p set: 0.44995033740997314
loss_pred:0.016426555812358856, decouple_loss:0.0012410561321303248
loss_pred:0.017023038119077682, decouple_loss:0.0012342754052951932
Iteration: 647, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45115989446640015, gen p mean: -0.05205158144235611, mean p set: 0.45164018869400024
loss_pred:0.015384458936750889, decouple_loss:0.0011456869542598724
The modified gen p mean: 0.4490266442298889, gen p mean: -0.05167923495173454, mean p set: 0.4495069682598114The modified gen p mean: 0.4493338465690613, gen p mean: -0.0596790537238121, mean p set: 0.4498141407966614
loss_pred:0.01771177351474762, decouple_loss:0.0011879961239174008
loss_pred:0.017228247597813606, decouple_loss:0.0011762971989810467
Iteration: 648, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471046030521393, gen p mean: -0.058710478246212006, mean p set: 0.44758492708206177
loss_pred:0.016244173049926758, decouple_loss:0.001222287304699421
The modified gen p mean: 0.4476175606250763, gen p mean: -0.059492532163858414, mean p set: 0.4480978846549988The modified gen p mean: 0.45086026191711426, gen p mean: -0.05225512012839317, mean p set: 0.45134055614471436
loss_pred:0.017130954191088676, decouple_loss:0.001269212574698031
loss_pred:0.017206916585564613, decouple_loss:0.0013759649591520429
Iteration: 649, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44984108209609985, gen p mean: -0.06025920435786247, mean p set: 0.45032137632369995
loss_pred:0.01687907800078392, decouple_loss:0.001124200876802206
The modified gen p mean: 0.44794589281082153, gen p mean: -0.06396160274744034, mean p set: 0.44842615723609924The modified gen p mean: 0.4486440122127533, gen p mean: -0.05427497997879982, mean p set: 0.449124276638031
loss_pred:0.016562072560191154, decouple_loss:0.0011618975549936295
loss_pred:0.0163715947419405, decouple_loss:0.0012134622083976865
Iteration: 650, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507363736629486, gen p mean: -0.05376216024160385, mean p set: 0.4512166678905487
loss_pred:0.016012800857424736, decouple_loss:0.0011506134178489447
The modified gen p mean: 0.44949010014533997, gen p mean: -0.05844801291823387, mean p set: 0.44997039437294006The modified gen p mean: 0.4485575556755066, gen p mean: -0.05890979990363121, mean p set: 0.4490378499031067
loss_pred:0.017234371975064278, decouple_loss:0.001188503229059279
loss_pred:0.01667485572397709, decouple_loss:0.001203108811751008
2023-05-02 05:09:37 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.06559045612812042, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.06154350936412811, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.06141841039061546, mean p set: 0.4500633478164673
loss_pred:0.018409300595521927, decouple_loss:0.0013578921789303422
loss_pred:0.01732066087424755, decouple_loss:0.0012967989314347506
loss_pred:0.01737850531935692, decouple_loss:0.0013289795024320483
WV_0_PC_1_EH_0_PS_40, loss: 0.017769217491149902, avg_mse: 0.02549365535378456
current test mse: 0.025494
Iteration: 651, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44963186979293823, gen p mean: -0.053918059915304184, mean p set: 0.45011213421821594
The modified gen p mean: 0.44819462299346924, gen p mean: -0.06484529376029968, mean p set: 0.44867488741874695
The modified gen p mean: 0.4485870599746704, gen p mean: -0.0588960126042366, mean p set: 0.4490673840045929
loss_pred:0.01717982068657875, decouple_loss:0.0011271224357187748
loss_pred:0.01693957857787609, decouple_loss:0.001084949355572462
loss_pred:0.016440263018012047, decouple_loss:0.0012702662497758865
Iteration: 652, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502987265586853, gen p mean: -0.05633728206157684, mean p set: 0.4507790505886078
loss_pred:0.016450675204396248, decouple_loss:0.00119690946303308
The modified gen p mean: 0.4471445083618164, gen p mean: -0.05975545942783356, mean p set: 0.4476247727870941The modified gen p mean: 0.4496336281299591, gen p mean: -0.05726643279194832, mean p set: 0.4501139223575592
loss_pred:0.016884511336684227, decouple_loss:0.001123537658713758
loss_pred:0.017109449952840805, decouple_loss:0.0012197323376312852
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012011_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012011_3_24hr.npz
NaN value num: 0
Iteration: 653, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44795286655426025, gen p mean: -0.05230395123362541, mean p set: 0.44843316078186035
loss_pred:0.017171766608953476, decouple_loss:0.0013747018529102206
The modified gen p mean: 0.45353665947914124, gen p mean: -0.057652805000543594, mean p set: 0.4540169835090637The modified gen p mean: 0.449347585439682, gen p mean: -0.05535685643553734, mean p set: 0.4498278796672821
loss_pred:0.015886057168245316, decouple_loss:0.0016016184817999601
loss_pred:0.016894469037652016, decouple_loss:0.0013232409255579114
Iteration: 654, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44893988966941833, gen p mean: -0.056848183274269104, mean p set: 0.44942015409469604
loss_pred:0.01672085002064705, decouple_loss:0.0011263599153608084
The modified gen p mean: 0.4502812325954437, gen p mean: -0.05378125235438347, mean p set: 0.4507615268230438The modified gen p mean: 0.4511868953704834, gen p mean: -0.05342274531722069, mean p set: 0.4516671597957611
loss_pred:0.016721388325095177, decouple_loss:0.0010962311644107103
loss_pred:0.016836557537317276, decouple_loss:0.0010683711152523756
Iteration: 655, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4536886215209961, gen p mean: -0.048494670540094376, mean p set: 0.4541688859462738
The modified gen p mean: 0.4490417540073395, gen p mean: -0.05305268242955208, mean p set: 0.4495220482349396
loss_pred:0.016108468174934387, decouple_loss:0.0013660056283697486
loss_pred:0.01673867367208004, decouple_loss:0.0012837693793699145
The modified gen p mean: 0.4527755677700043, gen p mean: -0.04864726588129997, mean p set: 0.45325586199760437
loss_pred:0.01658502221107483, decouple_loss:0.0012609789846464992
Iteration: 656, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45012110471725464, gen p mean: -0.04487026482820511, mean p set: 0.45060133934020996
loss_pred:0.015829341486096382, decouple_loss:0.001153002493083477
The modified gen p mean: 0.4534391462802887, gen p mean: -0.04163114354014397, mean p set: 0.4539194405078888The modified gen p mean: 0.45334023237228394, gen p mean: -0.04347221925854683, mean p set: 0.4538205564022064
loss_pred:0.015879947692155838, decouple_loss:0.0011242057662457228
loss_pred:0.01697934791445732, decouple_loss:0.001132249366492033
Iteration: 657, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45116493105888367, gen p mean: -0.04511789605021477, mean p set: 0.45164522528648376
loss_pred:0.016459140926599503, decouple_loss:0.001218669698573649
The modified gen p mean: 0.4527861773967743, gen p mean: -0.04248860105872154, mean p set: 0.4532664716243744The modified gen p mean: 0.45214441418647766, gen p mean: -0.043656427413225174, mean p set: 0.45262470841407776
loss_pred:0.015983261168003082, decouple_loss:0.0012584298383444548
loss_pred:0.016097258776426315, decouple_loss:0.0011159226996824145
Iteration: 658, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44961437582969666, gen p mean: -0.047247327864170074, mean p set: 0.45009464025497437
The modified gen p mean: 0.4538688063621521, gen p mean: -0.046968139708042145, mean p set: 0.4543490707874298
loss_pred:0.016286566853523254, decouple_loss:0.0010695972014218569
loss_pred:0.015790782868862152, decouple_loss:0.0011139498092234135
The modified gen p mean: 0.4484826624393463, gen p mean: -0.046250119805336, mean p set: 0.4489629566669464
loss_pred:0.01685916818678379, decouple_loss:0.0010597162181511521
Iteration: 659, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45189160108566284, gen p mean: -0.042059555649757385, mean p set: 0.45237189531326294
loss_pred:0.016156863421201706, decouple_loss:0.001189839094877243
The modified gen p mean: 0.45051145553588867, gen p mean: -0.039196617901325226, mean p set: 0.4509917199611664
The modified gen p mean: 0.4490250051021576, gen p mean: -0.04274701327085495, mean p set: 0.4495052993297577
loss_pred:0.016135990619659424, decouple_loss:0.0010667815804481506
loss_pred:0.016564933583140373, decouple_loss:0.0010035537416115403
Iteration: 660, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503997564315796, gen p mean: -0.03839685767889023, mean p set: 0.45088011026382446
loss_pred:0.015855655074119568, decouple_loss:0.0010354911210015416
The modified gen p mean: 0.44904935359954834, gen p mean: -0.04424980282783508, mean p set: 0.44952961802482605The modified gen p mean: 0.4522474408149719, gen p mean: -0.039168935269117355, mean p set: 0.452727735042572
loss_pred:0.016632184386253357, decouple_loss:0.0010332546662539244
loss_pred:0.01574612408876419, decouple_loss:0.0010444849031046033
2023-05-02 05:12:08 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.05007695034146309, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.046032462269067764, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04610293358564377, mean p set: 0.4500633478164673
loss_pred:0.018364621326327324, decouple_loss:0.0012673995224758983
loss_pred:0.01734153740108013, decouple_loss:0.0011770437704399228
loss_pred:0.017361924052238464, decouple_loss:0.0011749464320018888
WV_0_PC_1_EH_0_PS_40, loss: 0.017749685794115067, avg_mse: 0.025485489517450333
current test mse: 0.025485
Iteration: 661, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45138779282569885, gen p mean: -0.044674381613731384, mean p set: 0.45186808705329895
The modified gen p mean: 0.45128703117370605, gen p mean: -0.04243513569235802, mean p set: 0.45176732540130615
The modified gen p mean: 0.4513629972934723, gen p mean: -0.03880723938345909, mean p set: 0.4518432915210724
loss_pred:0.016181791201233864, decouple_loss:0.001028825412504375
loss_pred:0.015399531461298466, decouple_loss:0.0011116433888673782
loss_pred:0.016558490693569183, decouple_loss:0.0010856366716325283
Iteration: 662, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496348202228546, gen p mean: -0.0476577989757061, mean p set: 0.4501151144504547
The modified gen p mean: 0.452358216047287, gen p mean: -0.0387856550514698, mean p set: 0.4528384804725647
loss_pred:0.016452454030513763, decouple_loss:0.0010763811878859997
loss_pred:0.01571013405919075, decouple_loss:0.0011576669057831168
The modified gen p mean: 0.45214828848838806, gen p mean: -0.038657624274492264, mean p set: 0.45262858271598816
loss_pred:0.016474086791276932, decouple_loss:0.0010393982520326972
Iteration: 663, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490574598312378, gen p mean: -0.04431304708123207, mean p set: 0.4495377540588379
loss_pred:0.016948433592915535, decouple_loss:0.001003839890472591
The modified gen p mean: 0.4515826106071472, gen p mean: -0.04077373445034027, mean p set: 0.4520629048347473The modified gen p mean: 0.4518738090991974, gen p mean: -0.04269688203930855, mean p set: 0.4523541033267975
loss_pred:0.015828367322683334, decouple_loss:0.0010694960365071893
loss_pred:0.016339432448148727, decouple_loss:0.0009906924096867442
Iteration: 664, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503602981567383, gen p mean: -0.03665747866034508, mean p set: 0.4508405923843384
loss_pred:0.015834257006645203, decouple_loss:0.0012115358840674162
The modified gen p mean: 0.45162874460220337, gen p mean: -0.0400233119726181, mean p set: 0.45210903882980347The modified gen p mean: 0.44776785373687744, gen p mean: -0.046346575021743774, mean p set: 0.4482481777667999
loss_pred:0.016181718558073044, decouple_loss:0.0010954063618555665
loss_pred:0.016728149726986885, decouple_loss:0.001165228895843029
Iteration: 665, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45263221859931946, gen p mean: -0.04391906410455704, mean p set: 0.45311251282691956
loss_pred:0.015268860384821892, decouple_loss:0.0010522273369133472
The modified gen p mean: 0.45027536153793335, gen p mean: -0.03888922929763794, mean p set: 0.45075568556785583The modified gen p mean: 0.45114827156066895, gen p mean: -0.04520579054951668, mean p set: 0.45162856578826904
loss_pred:0.015384265221655369, decouple_loss:0.0010182709665969014
loss_pred:0.01610233262181282, decouple_loss:0.0010388698428869247
Iteration: 666, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45109039545059204, gen p mean: -0.041733987629413605, mean p set: 0.45157068967819214
loss_pred:0.01611356809735298, decouple_loss:0.0010000340407714248
The modified gen p mean: 0.4494574964046478, gen p mean: -0.04406547546386719, mean p set: 0.4499378204345703The modified gen p mean: 0.45147180557250977, gen p mean: -0.04309864714741707, mean p set: 0.45195209980010986
loss_pred:0.016425447538495064, decouple_loss:0.0009892293019220233
loss_pred:0.016304833814501762, decouple_loss:0.00098133971914649
Iteration: 667, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4521077275276184, gen p mean: -0.04345100000500679, mean p set: 0.4525880217552185
loss_pred:0.015777915716171265, decouple_loss:0.0010486232349649072
The modified gen p mean: 0.44802621006965637, gen p mean: -0.04433845728635788, mean p set: 0.44850653409957886The modified gen p mean: 0.4496529698371887, gen p mean: -0.048199936747550964, mean p set: 0.4501332640647888
loss_pred:0.016942020505666733, decouple_loss:0.001084689050912857
loss_pred:0.016483893617987633, decouple_loss:0.001107021700590849
Iteration: 668, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4536969065666199, gen p mean: -0.04252292215824127, mean p set: 0.45417720079421997
loss_pred:0.01696709357202053, decouple_loss:0.0010106266709044576
The modified gen p mean: 0.44808679819107056, gen p mean: -0.04872205853462219, mean p set: 0.44856709241867065The modified gen p mean: 0.45065250992774963, gen p mean: -0.04830010607838631, mean p set: 0.45113280415534973
loss_pred:0.015426271595060825, decouple_loss:0.0011166336480528116
loss_pred:0.01686738058924675, decouple_loss:0.0010113351745530963
Iteration: 669, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45254823565483093, gen p mean: -0.04380009323358536, mean p set: 0.4530285596847534
loss_pred:0.016224397346377373, decouple_loss:0.0011382795637473464
The modified gen p mean: 0.4529041349887848, gen p mean: -0.03833356499671936, mean p set: 0.4533843994140625The modified gen p mean: 0.4519825875759125, gen p mean: -0.03891800343990326, mean p set: 0.4524628818035126
loss_pred:0.016547594219446182, decouple_loss:0.001067566336132586
loss_pred:0.01612679660320282, decouple_loss:0.0011285170912742615
Iteration: 670, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44916778802871704, gen p mean: -0.04365750402212143, mean p set: 0.44964808225631714
loss_pred:0.016932310536503792, decouple_loss:0.0010414071148261428
The modified gen p mean: 0.4502444267272949, gen p mean: -0.039558734744787216, mean p set: 0.450724720954895The modified gen p mean: 0.44947126507759094, gen p mean: -0.04444406181573868, mean p set: 0.4499515891075134
loss_pred:0.015916654840111732, decouple_loss:0.0010717359837144613
loss_pred:0.016682108864188194, decouple_loss:0.001059160684235394
2023-05-02 05:14:04 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.049381233751773834, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04532264173030853, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.0456201508641243, mean p set: 0.4500633478164673
loss_pred:0.01834665797650814, decouple_loss:0.001277842908166349
loss_pred:0.017298074439167976, decouple_loss:0.0011387018021196127
loss_pred:0.01736776903271675, decouple_loss:0.0011668872321024537
WV_0_PC_1_EH_0_PS_40, loss: 0.017730556428432465, avg_mse: 0.025443559512495995
current test mse: 0.025444
Iteration: 671, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44835197925567627, gen p mean: -0.04089224338531494, mean p set: 0.44883227348327637
The modified gen p mean: 0.4514996409416199, gen p mean: -0.03726576268672943, mean p set: 0.45197993516921997
The modified gen p mean: 0.4479731619358063, gen p mean: -0.04454426467418671, mean p set: 0.448453426361084
loss_pred:0.016740988940000534, decouple_loss:0.0011454038321971893
loss_pred:0.016781136393547058, decouple_loss:0.0011488497257232666
loss_pred:0.016189061105251312, decouple_loss:0.0010530566796660423
Iteration: 672, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44970130920410156, gen p mean: -0.042473673820495605, mean p set: 0.45018160343170166
loss_pred:0.016864925622940063, decouple_loss:0.001100835157558322
The modified gen p mean: 0.4505225718021393, gen p mean: -0.03565971925854683, mean p set: 0.4510028660297394The modified gen p mean: 0.45277470350265503, gen p mean: -0.03754272311925888, mean p set: 0.4532550275325775
loss_pred:0.015812242403626442, decouple_loss:0.0012448708293959498
loss_pred:0.015861770138144493, decouple_loss:0.001231869449838996
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012007_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012007_3_24hr.npz
NaN value num: 0
Iteration: 673, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476816654205322, gen p mean: -0.04385089874267578, mean p set: 0.44816192984580994
loss_pred:0.014342962764203548, decouple_loss:0.001244817627593875
The modified gen p mean: 0.44723644852638245, gen p mean: -0.04392280802130699, mean p set: 0.44771671295166016The modified gen p mean: 0.4479518532752991, gen p mean: -0.04958391189575195, mean p set: 0.44843214750289917
loss_pred:0.0142469247803092, decouple_loss:0.0013498939806595445
loss_pred:0.015048795379698277, decouple_loss:0.0012268220307305455
Iteration: 674, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44729694724082947, gen p mean: -0.04745519161224365, mean p set: 0.44777724146842957
loss_pred:0.014891298487782478, decouple_loss:0.0010920416098088026
The modified gen p mean: 0.4484296441078186, gen p mean: -0.04911435768008232, mean p set: 0.4489099383354187The modified gen p mean: 0.44796133041381836, gen p mean: -0.05069371685385704, mean p set: 0.44844159483909607
loss_pred:0.013949323445558548, decouple_loss:0.0010595695348456502
loss_pred:0.013945495709776878, decouple_loss:0.001080716378055513
Iteration: 675, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477725923061371, gen p mean: -0.04786338657140732, mean p set: 0.4482528567314148
The modified gen p mean: 0.4472711682319641, gen p mean: -0.04309076815843582, mean p set: 0.4477514326572418
loss_pred:0.01396146323531866, decouple_loss:0.0011794622987508774
loss_pred:0.014623451046645641, decouple_loss:0.001096013467758894
The modified gen p mean: 0.4474695920944214, gen p mean: -0.050472892820835114, mean p set: 0.4479498863220215
loss_pred:0.01396317407488823, decouple_loss:0.0011592762311920524
Iteration: 676, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44715479016304016, gen p mean: -0.04874768480658531, mean p set: 0.44763508439064026
The modified gen p mean: 0.44750353693962097, gen p mean: -0.051604095846414566, mean p set: 0.44798383116722107
loss_pred:0.013995370827615261, decouple_loss:0.0010803877376019955
loss_pred:0.01485876739025116, decouple_loss:0.001125456066802144
The modified gen p mean: 0.4480270743370056, gen p mean: -0.053288377821445465, mean p set: 0.4485073983669281
loss_pred:0.013919186778366566, decouple_loss:0.0011038659140467644
Iteration: 677, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493151009082794, gen p mean: -0.0454985536634922, mean p set: 0.4497953951358795
The modified gen p mean: 0.448378324508667, gen p mean: -0.04894401505589485, mean p set: 0.4488586187362671
loss_pred:0.014481219463050365, decouple_loss:0.0012120110914111137
loss_pred:0.014094002544879913, decouple_loss:0.001140872249379754
The modified gen p mean: 0.447090744972229, gen p mean: -0.05475148558616638, mean p set: 0.4475710391998291
loss_pred:0.01361671183258295, decouple_loss:0.0012098060688003898
Iteration: 678, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44755682349205017, gen p mean: -0.04580652341246605, mean p set: 0.44803711771965027
loss_pred:0.014234179630875587, decouple_loss:0.0013632623013108969
The modified gen p mean: 0.446613073348999, gen p mean: -0.05033474043011665, mean p set: 0.4470933675765991The modified gen p mean: 0.4484992027282715, gen p mean: -0.049706995487213135, mean p set: 0.4489794969558716
loss_pred:0.013786171562969685, decouple_loss:0.001248982036486268
loss_pred:0.013932986184954643, decouple_loss:0.0013084443053230643
Iteration: 679, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485977590084076, gen p mean: -0.04233985394239426, mean p set: 0.4490780532360077
loss_pred:0.01410247664898634, decouple_loss:0.0013351787347346544
The modified gen p mean: 0.44745561480522156, gen p mean: -0.04342260956764221, mean p set: 0.44793590903282166The modified gen p mean: 0.449061781167984, gen p mean: -0.04090173915028572, mean p set: 0.4495420455932617
loss_pred:0.013843612745404243, decouple_loss:0.0013634420465677977
loss_pred:0.013675196096301079, decouple_loss:0.0013338342541828752
Iteration: 680, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484996497631073, gen p mean: -0.05080942064523697, mean p set: 0.4489799737930298
loss_pred:0.01369087677448988, decouple_loss:0.001294081681407988
The modified gen p mean: 0.4481548070907593, gen p mean: -0.045083507895469666, mean p set: 0.4486351013183594The modified gen p mean: 0.44728946685791016, gen p mean: -0.044712264090776443, mean p set: 0.44776979088783264
loss_pred:0.013406265527009964, decouple_loss:0.0012906016781926155
loss_pred:0.013528048992156982, decouple_loss:0.00128927081823349
2023-05-02 05:16:38 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.04515541344881058, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04109591618180275, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.041057877242565155, mean p set: 0.4500633478164673
loss_pred:0.019141700118780136, decouple_loss:0.0014215805567800999
loss_pred:0.018098386004567146, decouple_loss:0.0015109528321772814
loss_pred:0.01813654787838459, decouple_loss:0.0014402121305465698
WV_0_PC_1_EH_0_PS_40, loss: 0.018531758338212967, avg_mse: 0.02695772796869278
current test mse: 0.026958
Iteration: 681, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44808003306388855, gen p mean: -0.041462987661361694, mean p set: 0.44856035709381104
The modified gen p mean: 0.44857344031333923, gen p mean: -0.04166058823466301, mean p set: 0.44905373454093933
The modified gen p mean: 0.4475187361240387, gen p mean: -0.04241654649376869, mean p set: 0.4479990005493164
loss_pred:0.01331103965640068, decouple_loss:0.0013826468493789434
loss_pred:0.013643703423440456, decouple_loss:0.0014664488844573498
loss_pred:0.014024455100297928, decouple_loss:0.0013841720065101981
Iteration: 682, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44736185669898987, gen p mean: -0.0426645465195179, mean p set: 0.44784215092658997
loss_pred:0.01352759450674057, decouple_loss:0.0012722924584522843
The modified gen p mean: 0.4483753740787506, gen p mean: -0.04396551474928856, mean p set: 0.4488556683063507The modified gen p mean: 0.4473142623901367, gen p mean: -0.040379807353019714, mean p set: 0.4477945566177368
loss_pred:0.013687013648450375, decouple_loss:0.0012651567813009024
loss_pred:0.014020084403455257, decouple_loss:0.0013512404402717948
Iteration: 683, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486527442932129, gen p mean: -0.04812392219901085, mean p set: 0.449133038520813
loss_pred:0.013759912922978401, decouple_loss:0.0015031101647764444
The modified gen p mean: 0.44777804613113403, gen p mean: -0.04342835396528244, mean p set: 0.44825834035873413The modified gen p mean: 0.4473004639148712, gen p mean: -0.04523468390107155, mean p set: 0.4477807283401489
loss_pred:0.01368789840489626, decouple_loss:0.0014874571934342384
loss_pred:0.014096763916313648, decouple_loss:0.0014579301932826638
Iteration: 684, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44812268018722534, gen p mean: -0.048950549215078354, mean p set: 0.44860297441482544
loss_pred:0.013282953761518002, decouple_loss:0.0013818690786138177
The modified gen p mean: 0.44877690076828003, gen p mean: -0.043938543647527695, mean p set: 0.4492571949958801
The modified gen p mean: 0.4490264058113098, gen p mean: -0.0392187274992466, mean p set: 0.4495067000389099
loss_pred:0.013515014201402664, decouple_loss:0.0015058559365570545
loss_pred:0.013190324418246746, decouple_loss:0.001434452598914504
Iteration: 685, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44711461663246155, gen p mean: -0.04407864809036255, mean p set: 0.44759488105773926
loss_pred:0.014059987850487232, decouple_loss:0.0013690843479707837
The modified gen p mean: 0.4482242465019226, gen p mean: -0.0496598556637764, mean p set: 0.4487045109272003The modified gen p mean: 0.4483779966831207, gen p mean: -0.043467119336128235, mean p set: 0.4488582909107208
loss_pred:0.013590962626039982, decouple_loss:0.0013734785607084632
loss_pred:0.013690377585589886, decouple_loss:0.0012823698343709111
Iteration: 686, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476211667060852, gen p mean: -0.04939620569348335, mean p set: 0.4481014907360077
loss_pred:0.013486380688846111, decouple_loss:0.0012958431616425514
The modified gen p mean: 0.4481242001056671, gen p mean: -0.04791821166872978, mean p set: 0.4486044645309448The modified gen p mean: 0.44817668199539185, gen p mean: -0.05151840299367905, mean p set: 0.44865697622299194
loss_pred:0.013187918812036514, decouple_loss:0.0012591170379891992
loss_pred:0.01371809933334589, decouple_loss:0.0013335898984223604
Iteration: 687, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477311670780182, gen p mean: -0.05295221135020256, mean p set: 0.4482114315032959
loss_pred:0.013053536415100098, decouple_loss:0.0013061470817774534
The modified gen p mean: 0.4485163986682892, gen p mean: -0.050556521862745285, mean p set: 0.4489966928958893The modified gen p mean: 0.44872990250587463, gen p mean: -0.05087974667549133, mean p set: 0.44921019673347473
loss_pred:0.013592839241027832, decouple_loss:0.001358792302198708
loss_pred:0.013933990150690079, decouple_loss:0.0012948281364515424
Iteration: 688, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44834771752357483, gen p mean: -0.054281070828437805, mean p set: 0.4488280117511749
loss_pred:0.013543404638767242, decouple_loss:0.0013686405727639794
The modified gen p mean: 0.44846057891845703, gen p mean: -0.05447278916835785, mean p set: 0.44894084334373474The modified gen p mean: 0.4481067955493927, gen p mean: -0.052875153720378876, mean p set: 0.4485870599746704
loss_pred:0.013282859697937965, decouple_loss:0.001282650395296514
loss_pred:0.01290882658213377, decouple_loss:0.0012982641346752644
Iteration: 689, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44763848185539246, gen p mean: -0.05239877104759216, mean p set: 0.44811877608299255
loss_pred:0.013251918368041515, decouple_loss:0.0012100782478228211
The modified gen p mean: 0.44725486636161804, gen p mean: -0.05208653584122658, mean p set: 0.44773516058921814The modified gen p mean: 0.4483889937400818, gen p mean: -0.05842437595129013, mean p set: 0.4488692879676819
loss_pred:0.013970568776130676, decouple_loss:0.0014209543587639928
loss_pred:0.013598696328699589, decouple_loss:0.0011946485610678792
Iteration: 690, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480278789997101, gen p mean: -0.052745796740055084, mean p set: 0.4485081434249878
loss_pred:0.013815909624099731, decouple_loss:0.0012531982501968741
The modified gen p mean: 0.4493856132030487, gen p mean: -0.04513953626155853, mean p set: 0.4498658776283264
The modified gen p mean: 0.4474526643753052, gen p mean: -0.05220940709114075, mean p set: 0.4479329288005829
loss_pred:0.013835049234330654, decouple_loss:0.0012052288511767983
loss_pred:0.01306169107556343, decouple_loss:0.0012255125911906362
2023-05-02 05:18:33 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.0533943735063076, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04944045841693878, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04928530007600784, mean p set: 0.4500633478164673
loss_pred:0.019167669117450714, decouple_loss:0.0013480382040143013
loss_pred:0.018108699470758438, decouple_loss:0.0012488580541685224
loss_pred:0.01816106215119362, decouple_loss:0.0012442138977348804
WV_0_PC_1_EH_0_PS_40, loss: 0.01854316145181656, avg_mse: 0.027036773040890694
current test mse: 0.027037
Iteration: 691, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44764864444732666, gen p mean: -0.050887566059827805, mean p set: 0.44812890887260437
The modified gen p mean: 0.4479582905769348, gen p mean: -0.04895506799221039, mean p set: 0.4484385848045349
The modified gen p mean: 0.44736239314079285, gen p mean: -0.05299031361937523, mean p set: 0.44784268736839294
loss_pred:0.014153096824884415, decouple_loss:0.0012339422246441245
loss_pred:0.013800229877233505, decouple_loss:0.001277998206205666
loss_pred:0.013224822469055653, decouple_loss:0.0011575835524126887
Iteration: 692, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481460750102997, gen p mean: -0.04875786229968071, mean p set: 0.4486263692378998
loss_pred:0.013712409883737564, decouple_loss:0.0013048909604549408
The modified gen p mean: 0.4483235776424408, gen p mean: -0.04845505580306053, mean p set: 0.4488038718700409The modified gen p mean: 0.44693225622177124, gen p mean: -0.04881232604384422, mean p set: 0.4474125802516937
loss_pred:0.012966996058821678, decouple_loss:0.0012809153413400054
loss_pred:0.013124637305736542, decouple_loss:0.0011695974972099066
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012014_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012014_3_24hr.npz
NaN value num: 0
Iteration: 693, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45077088475227356, gen p mean: -0.039735257625579834, mean p set: 0.45125120878219604
loss_pred:0.016430838033556938, decouple_loss:0.001396829611621797
The modified gen p mean: 0.4532553255558014, gen p mean: -0.0382600799202919, mean p set: 0.4537356197834015The modified gen p mean: 0.4525906443595886, gen p mean: -0.04727933183312416, mean p set: 0.4530709385871887
loss_pred:0.016632404178380966, decouple_loss:0.0015035128453746438
loss_pred:0.015975503250956535, decouple_loss:0.0013513130834326148
Iteration: 694, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45292118191719055, gen p mean: -0.034668873995542526, mean p set: 0.45340150594711304
loss_pred:0.016363082453608513, decouple_loss:0.0011942723067477345
The modified gen p mean: 0.4504399001598358, gen p mean: -0.03754061087965965, mean p set: 0.4509201943874359The modified gen p mean: 0.450580358505249, gen p mean: -0.03487108647823334, mean p set: 0.4510606527328491
loss_pred:0.01617903634905815, decouple_loss:0.001322580617852509
loss_pred:0.01619650050997734, decouple_loss:0.0013721490977331996
Iteration: 695, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4519236981868744, gen p mean: -0.03778085112571716, mean p set: 0.4524039626121521
loss_pred:0.015405828133225441, decouple_loss:0.001417344668880105
The modified gen p mean: 0.450194776058197, gen p mean: -0.036236561834812164, mean p set: 0.45067504048347473The modified gen p mean: 0.45299434661865234, gen p mean: -0.038447339087724686, mean p set: 0.45347464084625244
loss_pred:0.015865255147218704, decouple_loss:0.00141930824611336
loss_pred:0.01578894816339016, decouple_loss:0.001429309486411512
Iteration: 696, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45159539580345154, gen p mean: -0.034913089126348495, mean p set: 0.45207569003105164
loss_pred:0.015855107456445694, decouple_loss:0.0011158022098243237
The modified gen p mean: 0.44915416836738586, gen p mean: -0.03962726145982742, mean p set: 0.44963446259498596The modified gen p mean: 0.4503708779811859, gen p mean: -0.03391966223716736, mean p set: 0.4508511424064636
loss_pred:0.015915056690573692, decouple_loss:0.0012264302931725979
loss_pred:0.016099214553833008, decouple_loss:0.0011355308815836906
Iteration: 697, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496538043022156, gen p mean: -0.04059033468365669, mean p set: 0.4501340985298157
loss_pred:0.01615140214562416, decouple_loss:0.0012479220749810338
The modified gen p mean: 0.449970006942749, gen p mean: -0.035204898566007614, mean p set: 0.4504503011703491
The modified gen p mean: 0.4513232409954071, gen p mean: -0.03936919942498207, mean p set: 0.4518035352230072
loss_pred:0.01654600165784359, decouple_loss:0.0013106537517160177
loss_pred:0.015994403511285782, decouple_loss:0.0012770352186635137
Iteration: 698, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500267803668976, gen p mean: -0.03324073553085327, mean p set: 0.4505070447921753
loss_pred:0.016962723806500435, decouple_loss:0.0012134015560150146
The modified gen p mean: 0.44960248470306396, gen p mean: -0.0357634611427784, mean p set: 0.45008277893066406The modified gen p mean: 0.4504378139972687, gen p mean: -0.04021647199988365, mean p set: 0.4509181082248688
loss_pred:0.015904486179351807, decouple_loss:0.001245990744791925
loss_pred:0.015889771282672882, decouple_loss:0.0011568955378606915
Iteration: 699, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45139604806900024, gen p mean: -0.04240928590297699, mean p set: 0.45187634229660034
loss_pred:0.015877509489655495, decouple_loss:0.00122509291395545
The modified gen p mean: 0.4500027298927307, gen p mean: -0.04274854063987732, mean p set: 0.4504829943180084The modified gen p mean: 0.4520683288574219, gen p mean: -0.0453701913356781, mean p set: 0.4525485932826996
loss_pred:0.014827257953584194, decouple_loss:0.0012068530777469277
loss_pred:0.015775339677929878, decouple_loss:0.0012559707975015044
Iteration: 700, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4518848955631256, gen p mean: -0.04859835281968117, mean p set: 0.4523652195930481
loss_pred:0.016238074749708176, decouple_loss:0.0011643009493127465
The modified gen p mean: 0.45062196254730225, gen p mean: -0.040463268756866455, mean p set: 0.45110225677490234
The modified gen p mean: 0.4504302144050598, gen p mean: -0.044429611414670944, mean p set: 0.4509105384349823
loss_pred:0.015855999663472176, decouple_loss:0.0012370427139103413
loss_pred:0.01595582254230976, decouple_loss:0.0011809113202616572
2023-05-02 05:21:12 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.05158565193414688, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04792929068207741, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04789759963750839, mean p set: 0.4500633478164673
loss_pred:0.018649877980351448, decouple_loss:0.0013970769941806793
loss_pred:0.017513103783130646, decouple_loss:0.0013675409136340022
loss_pred:0.017642175778746605, decouple_loss:0.0013381700264289975
WV_0_PC_1_EH_0_PS_40, loss: 0.0180034339427948, avg_mse: 0.02595973201096058
current test mse: 0.02596
Iteration: 701, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44920673966407776, gen p mean: -0.04687392711639404, mean p set: 0.44968703389167786
The modified gen p mean: 0.45090562105178833, gen p mean: -0.04033337160944939, mean p set: 0.4513859152793884
The modified gen p mean: 0.4492179751396179, gen p mean: -0.04517953470349312, mean p set: 0.4496982991695404
loss_pred:0.015542379580438137, decouple_loss:0.001307685044594109
loss_pred:0.016584444791078568, decouple_loss:0.0013255701633170247
loss_pred:0.016365185379981995, decouple_loss:0.0013370804954320192
Iteration: 702, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45325326919555664, gen p mean: -0.040466830134391785, mean p set: 0.4537335932254791
loss_pred:0.016046816483139992, decouple_loss:0.0010614176280796528
The modified gen p mean: 0.4500598609447479, gen p mean: -0.03972570225596428, mean p set: 0.45054012537002563The modified gen p mean: 0.45108312368392944, gen p mean: -0.041162796318531036, mean p set: 0.45156341791152954
loss_pred:0.01614551432430744, decouple_loss:0.0011039481032639742
loss_pred:0.015742119401693344, decouple_loss:0.001116946805268526
Iteration: 703, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44935160875320435, gen p mean: -0.036033693701028824, mean p set: 0.44983193278312683
loss_pred:0.017031025141477585, decouple_loss:0.0012564259814098477
The modified gen p mean: 0.45138290524482727, gen p mean: -0.04314955696463585, mean p set: 0.45186319947242737The modified gen p mean: 0.4501752555370331, gen p mean: -0.04278204217553139, mean p set: 0.4506555497646332
loss_pred:0.016071505844593048, decouple_loss:0.0013535035541281104
loss_pred:0.016001278534531593, decouple_loss:0.0013849885435774922
Iteration: 704, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45263898372650146, gen p mean: -0.03829166665673256, mean p set: 0.45311927795410156
loss_pred:0.015686960890889168, decouple_loss:0.0011373989982530475
The modified gen p mean: 0.45007872581481934, gen p mean: -0.041987743228673935, mean p set: 0.45055902004241943The modified gen p mean: 0.4526252746582031, gen p mean: -0.039796505123376846, mean p set: 0.4531055688858032
loss_pred:0.015797659754753113, decouple_loss:0.001171070383861661
loss_pred:0.016068296507000923, decouple_loss:0.0011247707298025489
Iteration: 705, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45049917697906494, gen p mean: -0.04202788695693016, mean p set: 0.45097947120666504
loss_pred:0.01589915342628956, decouple_loss:0.001216973876580596
The modified gen p mean: 0.44951656460762024, gen p mean: -0.04016949236392975, mean p set: 0.44999685883522034The modified gen p mean: 0.4507702589035034, gen p mean: -0.03584796562790871, mean p set: 0.4512505531311035
loss_pred:0.016367563977837563, decouple_loss:0.0013147381832823157
loss_pred:0.015471028164029121, decouple_loss:0.0011969387996941805
Iteration: 706, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45270371437072754, gen p mean: -0.045665908604860306, mean p set: 0.45318400859832764
loss_pred:0.01627674326300621, decouple_loss:0.0011262783082202077
The modified gen p mean: 0.4502231180667877, gen p mean: -0.040528010576963425, mean p set: 0.4507034122943878The modified gen p mean: 0.45261842012405396, gen p mean: -0.042988359928131104, mean p set: 0.45309871435165405
loss_pred:0.015795113518834114, decouple_loss:0.0010318589629605412
loss_pred:0.015857312828302383, decouple_loss:0.0011541256681084633
Iteration: 707, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45024293661117554, gen p mean: -0.04251862317323685, mean p set: 0.45072323083877563
loss_pred:0.015315407887101173, decouple_loss:0.0011973970104008913
The modified gen p mean: 0.45041683316230774, gen p mean: -0.04396774619817734, mean p set: 0.4508971571922302The modified gen p mean: 0.4494049847126007, gen p mean: -0.0441485159099102, mean p set: 0.4498852789402008
loss_pred:0.016373012214899063, decouple_loss:0.0011557210236787796
loss_pred:0.0157200638204813, decouple_loss:0.001264102989807725
Iteration: 708, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494568109512329, gen p mean: -0.0459141805768013, mean p set: 0.449937105178833
loss_pred:0.015096600167453289, decouple_loss:0.0011138675035908818
The modified gen p mean: 0.4504570960998535, gen p mean: -0.04920930415391922, mean p set: 0.450937420129776The modified gen p mean: 0.4497902989387512, gen p mean: -0.04658729210495949, mean p set: 0.4502705931663513
loss_pred:0.015967776998877525, decouple_loss:0.0011243480257689953
loss_pred:0.015212181955575943, decouple_loss:0.001118029817007482
Iteration: 709, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44996151328086853, gen p mean: -0.047692637890577316, mean p set: 0.450441837310791
loss_pred:0.01580149494111538, decouple_loss:0.0012510753003880382
The modified gen p mean: 0.45020055770874023, gen p mean: -0.04592202976346016, mean p set: 0.45068085193634033The modified gen p mean: 0.4517694413661957, gen p mean: -0.0464116632938385, mean p set: 0.4522497057914734
loss_pred:0.015206572599709034, decouple_loss:0.0011603407328948379
loss_pred:0.016076555475592613, decouple_loss:0.0011405826080590487
Iteration: 710, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514337480068207, gen p mean: -0.05450621247291565, mean p set: 0.4519140422344208
loss_pred:0.016260812059044838, decouple_loss:0.0011830654693767428
The modified gen p mean: 0.4506898522377014, gen p mean: -0.04742645099759102, mean p set: 0.4511701166629791The modified gen p mean: 0.45214036107063293, gen p mean: -0.05511308088898659, mean p set: 0.45262065529823303
loss_pred:0.015568457543849945, decouple_loss:0.0012335901847109199
loss_pred:0.016018662601709366, decouple_loss:0.0011614273535087705
2023-05-02 05:23:07 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.056444454938173294, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830833911896, gen p mean: -0.05250980705022812, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.05252371355891228, mean p set: 0.45035696029663086
loss_pred:0.01861484721302986, decouple_loss:0.001479691476561129
loss_pred:0.01759752444922924, decouple_loss:0.001347975223325193
loss_pred:0.017425840720534325, decouple_loss:0.0013709559570997953
WV_0_PC_1_EH_0_PS_40, loss: 0.017949379980564117, avg_mse: 0.025849057361483574
current test mse: 0.025849
Iteration: 711, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450313001871109, gen p mean: -0.0456254705786705, mean p set: 0.4507932960987091
The modified gen p mean: 0.45054343342781067, gen p mean: -0.04669304937124252, mean p set: 0.4510236978530884
The modified gen p mean: 0.4500761032104492, gen p mean: -0.04752441123127937, mean p set: 0.4505563974380493
loss_pred:0.016460629180073738, decouple_loss:0.001122049055993557
loss_pred:0.015249866060912609, decouple_loss:0.0011188257485628128loss_pred:0.015459072776138783, decouple_loss:0.0011212443932890892
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012005_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012005_3_24hr.npz
NaN value num: 0
Iteration: 712, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44971132278442383, gen p mean: -0.04978327825665474, mean p set: 0.4501916468143463
loss_pred:0.017369288951158524, decouple_loss:0.0014417263446375728
The modified gen p mean: 0.44838595390319824, gen p mean: -0.05131792277097702, mean p set: 0.4488662779331207The modified gen p mean: 0.4487854838371277, gen p mean: -0.05365270748734474, mean p set: 0.4492657780647278
loss_pred:0.016779951751232147, decouple_loss:0.001342713600024581
loss_pred:0.01641768217086792, decouple_loss:0.0014035938074812293
Iteration: 713, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482744038105011, gen p mean: -0.04804754629731178, mean p set: 0.4487546980381012
loss_pred:0.016379257664084435, decouple_loss:0.0012778806267306209
The modified gen p mean: 0.4484393894672394, gen p mean: -0.050371669232845306, mean p set: 0.4489196836948395The modified gen p mean: 0.4492219388484955, gen p mean: -0.0535096600651741, mean p set: 0.4497022032737732
loss_pred:0.017270468175411224, decouple_loss:0.0012338528176769614
loss_pred:0.016161836683750153, decouple_loss:0.0012151545379310846
Iteration: 714, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500262141227722, gen p mean: -0.05272143334150314, mean p set: 0.4505065083503723
The modified gen p mean: 0.4498195946216583, gen p mean: -0.05066145956516266, mean p set: 0.4502998888492584
loss_pred:0.016255993396043777, decouple_loss:0.0012766009895130992
loss_pred:0.01610247604548931, decouple_loss:0.0013517334591597319
The modified gen p mean: 0.44820013642311096, gen p mean: -0.05307736247777939, mean p set: 0.44868043065071106
loss_pred:0.016630245372653008, decouple_loss:0.0013823143672198057
Iteration: 715, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44845184683799744, gen p mean: -0.05287100374698639, mean p set: 0.44893211126327515
loss_pred:0.016342446208000183, decouple_loss:0.0012679646024480462
The modified gen p mean: 0.4495837986469269, gen p mean: -0.050301216542720795, mean p set: 0.450064092874527The modified gen p mean: 0.4502217173576355, gen p mean: -0.05339294672012329, mean p set: 0.4507019817829132
loss_pred:0.01666109263896942, decouple_loss:0.001220453530550003
loss_pred:0.016073759645223618, decouple_loss:0.0012691207230091095
Iteration: 716, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44973480701446533, gen p mean: -0.05654251575469971, mean p set: 0.45021507143974304
loss_pred:0.016468575224280357, decouple_loss:0.0012691201409325004
The modified gen p mean: 0.4473685026168823, gen p mean: -0.05263086035847664, mean p set: 0.4478487968444824The modified gen p mean: 0.44869494438171387, gen p mean: -0.0564962737262249, mean p set: 0.44917523860931396
loss_pred:0.016370918601751328, decouple_loss:0.0013256070669740438
loss_pred:0.016596410423517227, decouple_loss:0.001331891631707549
Iteration: 717, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496310353279114, gen p mean: -0.05566782504320145, mean p set: 0.4501113295555115
loss_pred:0.01624610275030136, decouple_loss:0.0013638206291943789
The modified gen p mean: 0.44945579767227173, gen p mean: -0.054176826030015945, mean p set: 0.44993606209754944The modified gen p mean: 0.45032787322998047, gen p mean: -0.05390406399965286, mean p set: 0.45080816745758057
loss_pred:0.016545895487070084, decouple_loss:0.0013042261125519872
loss_pred:0.01612057350575924, decouple_loss:0.0012520257150754333
Iteration: 718, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44815143942832947, gen p mean: -0.054291002452373505, mean p set: 0.44863176345825195
loss_pred:0.016842177137732506, decouple_loss:0.0015015843091532588
The modified gen p mean: 0.4484138786792755, gen p mean: -0.051018692553043365, mean p set: 0.4488941431045532The modified gen p mean: 0.4503535032272339, gen p mean: -0.054609235376119614, mean p set: 0.45083382725715637
loss_pred:0.015998931601643562, decouple_loss:0.0015158329624682665
loss_pred:0.015818018466234207, decouple_loss:0.001450678100809455
Iteration: 719, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483083486557007, gen p mean: -0.05333436280488968, mean p set: 0.4487886428833008
loss_pred:0.016315922141075134, decouple_loss:0.0013329674256965518
The modified gen p mean: 0.44807255268096924, gen p mean: -0.05802439525723457, mean p set: 0.44855284690856934The modified gen p mean: 0.44799548387527466, gen p mean: -0.050814587622880936, mean p set: 0.44847577810287476
loss_pred:0.01608889177441597, decouple_loss:0.001222053891979158
loss_pred:0.016593098640441895, decouple_loss:0.0012250266736373305
Iteration: 720, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44858092069625854, gen p mean: -0.05376371368765831, mean p set: 0.44906121492385864
loss_pred:0.01663191057741642, decouple_loss:0.001349452300928533
The modified gen p mean: 0.4497861862182617, gen p mean: -0.050966326147317886, mean p set: 0.45026645064353943The modified gen p mean: 0.44840115308761597, gen p mean: -0.05276166647672653, mean p set: 0.44888144731521606
loss_pred:0.015820244327187538, decouple_loss:0.0012880184222012758
loss_pred:0.01581156998872757, decouple_loss:0.0013124480610713363
2023-05-02 05:25:39 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.05612641200423241, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830535888672, gen p mean: -0.05213533341884613, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.052086569368839264, mean p set: 0.45035696029663086
loss_pred:0.01859281025826931, decouple_loss:0.0012481771409511566
loss_pred:0.017566803842782974, decouple_loss:0.0012489616638049483loss_pred:0.017471080645918846, decouple_loss:0.0012928122887387872
WV_0_PC_1_EH_0_PS_40, loss: 0.017940064892172813, avg_mse: 0.025833196938037872
current test mse: 0.025833
Iteration: 721, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44764530658721924, gen p mean: -0.05280245840549469, mean p set: 0.4481256306171417
The modified gen p mean: 0.4490582346916199, gen p mean: -0.05337974801659584, mean p set: 0.44953852891921997
The modified gen p mean: 0.44969338178634644, gen p mean: -0.05547543987631798, mean p set: 0.45017367601394653
loss_pred:0.015930023044347763, decouple_loss:0.0012627574615180492
loss_pred:0.01697438955307007, decouple_loss:0.0012314030900597572loss_pred:0.0162351094186306, decouple_loss:0.0013180578825995326
Iteration: 722, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487479627132416, gen p mean: -0.050502412021160126, mean p set: 0.4492282271385193
loss_pred:0.01655196025967598, decouple_loss:0.0010268137557432055
The modified gen p mean: 0.4486786425113678, gen p mean: -0.04911236837506294, mean p set: 0.4491589367389679The modified gen p mean: 0.45045018196105957, gen p mean: -0.05484267324209213, mean p set: 0.4509304463863373
loss_pred:0.016049567610025406, decouple_loss:0.0012163077481091022
loss_pred:0.016227606683969498, decouple_loss:0.0011005402775481343
Iteration: 723, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489058256149292, gen p mean: -0.04927230626344681, mean p set: 0.4493860900402069
loss_pred:0.016239523887634277, decouple_loss:0.0012999671744182706
The modified gen p mean: 0.44896426796913147, gen p mean: -0.047770753502845764, mean p set: 0.44944456219673157The modified gen p mean: 0.4496042728424072, gen p mean: -0.04665642976760864, mean p set: 0.4500845670700073
loss_pred:0.01658620312809944, decouple_loss:0.0013423910131677985
loss_pred:0.01570848561823368, decouple_loss:0.0013311818474903703
Iteration: 724, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491669237613678, gen p mean: -0.04520736634731293, mean p set: 0.4496472179889679
loss_pred:0.016427600756287575, decouple_loss:0.0010779150761663914
The modified gen p mean: 0.4489072859287262, gen p mean: -0.04925243929028511, mean p set: 0.4493875503540039The modified gen p mean: 0.4509904682636261, gen p mean: -0.05060647800564766, mean p set: 0.4514707326889038
loss_pred:0.01670699566602707, decouple_loss:0.0010571626480668783
loss_pred:0.015690375119447708, decouple_loss:0.0010873685823753476
Iteration: 725, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498697817325592, gen p mean: -0.04419683292508125, mean p set: 0.4503500759601593
loss_pred:0.015909377485513687, decouple_loss:0.0011767885880544782
The modified gen p mean: 0.4502228796482086, gen p mean: -0.04823853448033333, mean p set: 0.4507031738758087The modified gen p mean: 0.44764411449432373, gen p mean: -0.04536227881908417, mean p set: 0.44812440872192383
loss_pred:0.016304757446050644, decouple_loss:0.0011312792776152492
loss_pred:0.015683786943554878, decouple_loss:0.0012384740402922034
Iteration: 726, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448699414730072, gen p mean: -0.04860945791006088, mean p set: 0.4491797089576721
loss_pred:0.016408322378993034, decouple_loss:0.0011291345581412315
The modified gen p mean: 0.4499596357345581, gen p mean: -0.04775603115558624, mean p set: 0.4504399299621582The modified gen p mean: 0.44749295711517334, gen p mean: -0.04847295209765434, mean p set: 0.44797325134277344
loss_pred:0.01572674885392189, decouple_loss:0.0010601943358778954
loss_pred:0.016586894169449806, decouple_loss:0.0010725423926487565
Iteration: 727, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474797248840332, gen p mean: -0.04752548411488533, mean p set: 0.4479599893093109
loss_pred:0.016287311911582947, decouple_loss:0.0010229443432763219
The modified gen p mean: 0.4494518041610718, gen p mean: -0.04613184928894043, mean p set: 0.4499320983886719The modified gen p mean: 0.44862014055252075, gen p mean: -0.04266055300831795, mean p set: 0.44910046458244324
loss_pred:0.01614374667406082, decouple_loss:0.00115778052713722
loss_pred:0.016078591346740723, decouple_loss:0.0011944274883717299
Iteration: 728, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480952024459839, gen p mean: -0.04500361531972885, mean p set: 0.448575496673584
loss_pred:0.01655695028603077, decouple_loss:0.0010205794824287295
The modified gen p mean: 0.44978079199790955, gen p mean: -0.048802342265844345, mean p set: 0.45026108622550964The modified gen p mean: 0.4486227035522461, gen p mean: -0.04482732713222504, mean p set: 0.4491029977798462
loss_pred:0.01646673120558262, decouple_loss:0.001199502730742097
loss_pred:0.016618262976408005, decouple_loss:0.0010321583831682801
Iteration: 729, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45030322670936584, gen p mean: -0.04898941144347191, mean p set: 0.45078352093696594
loss_pred:0.0157012939453125, decouple_loss:0.0010575678898021579
The modified gen p mean: 0.4493016004562378, gen p mean: -0.04722939059138298, mean p set: 0.4497818946838379The modified gen p mean: 0.447918564081192, gen p mean: -0.045560307800769806, mean p set: 0.4483988583087921
loss_pred:0.01662699319422245, decouple_loss:0.001050191349349916
loss_pred:0.01571584865450859, decouple_loss:0.0009956153808161616
Iteration: 730, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489375054836273, gen p mean: -0.050227563828229904, mean p set: 0.4494177997112274
loss_pred:0.01641279272735119, decouple_loss:0.0011517420643940568
The modified gen p mean: 0.4498950242996216, gen p mean: -0.05073239654302597, mean p set: 0.4503753185272217The modified gen p mean: 0.44879260659217834, gen p mean: -0.04922253265976906, mean p set: 0.44927293062210083
loss_pred:0.015829717740416527, decouple_loss:0.0010631134500727057
loss_pred:0.016460632905364037, decouple_loss:0.00111857068259269
2023-05-02 05:27:34 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.05578096583485603, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.0514209009706974, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.05177944526076317, mean p set: 0.4500633478164673
loss_pred:0.0185384638607502, decouple_loss:0.0011761749628931284
loss_pred:0.0174541138112545, decouple_loss:0.0012061168672516942
loss_pred:0.017554061487317085, decouple_loss:0.0012381295673549175
WV_0_PC_1_EH_0_PS_40, loss: 0.01790921948850155, avg_mse: 0.025805188342928886
current test mse: 0.025805
Iteration: 731, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479368031024933, gen p mean: -0.05598640441894531, mean p set: 0.4484170973300934
The modified gen p mean: 0.44886526465415955, gen p mean: -0.0518953874707222, mean p set: 0.44934555888175964The modified gen p mean: 0.4479649066925049, gen p mean: -0.05173060670495033, mean p set: 0.44844523072242737
loss_pred:0.016356930136680603, decouple_loss:0.001253642374649644
loss_pred:0.016311854124069214, decouple_loss:0.0011357201728969812
loss_pred:0.01624745875597, decouple_loss:0.0011669122613966465
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012012_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012012_3_24hr.npz
NaN value num: 0
Iteration: 732, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45196977257728577, gen p mean: -0.04945344105362892, mean p set: 0.45245006680488586
loss_pred:0.015445143915712833, decouple_loss:0.001452788943424821
The modified gen p mean: 0.45110011100769043, gen p mean: -0.05032949149608612, mean p set: 0.4515804052352905The modified gen p mean: 0.45101550221443176, gen p mean: -0.05068352818489075, mean p set: 0.45149579644203186
loss_pred:0.016329685226082802, decouple_loss:0.0012376246741041541
loss_pred:0.01586851477622986, decouple_loss:0.001325719989836216
Iteration: 733, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500582218170166, gen p mean: -0.0511711947619915, mean p set: 0.4505384862422943
loss_pred:0.01607169769704342, decouple_loss:0.00114628323353827
The modified gen p mean: 0.45044654607772827, gen p mean: -0.05085895583033562, mean p set: 0.45092687010765076The modified gen p mean: 0.4483598470687866, gen p mean: -0.05328076332807541, mean p set: 0.4488401710987091
loss_pred:0.01627976819872856, decouple_loss:0.0011994184460490942
loss_pred:0.015868734568357468, decouple_loss:0.0010695341043174267
Iteration: 734, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4509352147579193, gen p mean: -0.047453589737415314, mean p set: 0.4514155089855194
loss_pred:0.015760794281959534, decouple_loss:0.0011898023076355457
The modified gen p mean: 0.45289766788482666, gen p mean: -0.05062315985560417, mean p set: 0.45337799191474915The modified gen p mean: 0.4490213394165039, gen p mean: -0.05406096950173378, mean p set: 0.4495016634464264
loss_pred:0.015151976607739925, decouple_loss:0.0012775223003700376
loss_pred:0.01705816015601158, decouple_loss:0.0012299508089199662
Iteration: 735, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4524904787540436, gen p mean: -0.05187302827835083, mean p set: 0.4529707729816437
loss_pred:0.015561893582344055, decouple_loss:0.0011723189381882548
The modified gen p mean: 0.4498851001262665, gen p mean: -0.0524994432926178, mean p set: 0.4503653943538666The modified gen p mean: 0.45086923241615295, gen p mean: -0.05630071088671684, mean p set: 0.45134952664375305
loss_pred:0.016999511048197746, decouple_loss:0.001092090387828648
loss_pred:0.016194263473153114, decouple_loss:0.0010690604103729129
Iteration: 736, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45041942596435547, gen p mean: -0.04998163878917694, mean p set: 0.45089974999427795
loss_pred:0.01563183404505253, decouple_loss:0.0011269657406955957
The modified gen p mean: 0.4495577812194824, gen p mean: -0.06007381156086922, mean p set: 0.45003804564476013
The modified gen p mean: 0.4506535828113556, gen p mean: -0.0500175878405571, mean p set: 0.4511338472366333
loss_pred:0.01585838384926319, decouple_loss:0.0013130208244547248
loss_pred:0.015779728069901466, decouple_loss:0.001092569320462644
Iteration: 737, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481806755065918, gen p mean: -0.05230994150042534, mean p set: 0.4486609697341919
loss_pred:0.0163557305932045, decouple_loss:0.0011624610051512718
The modified gen p mean: 0.4528330862522125, gen p mean: -0.04849804937839508, mean p set: 0.45331335067749023The modified gen p mean: 0.44989341497421265, gen p mean: -0.05072818323969841, mean p set: 0.45037373900413513
loss_pred:0.014922254718840122, decouple_loss:0.0011297346791252494
loss_pred:0.01581236906349659, decouple_loss:0.001111540012061596
Iteration: 738, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4529532790184021, gen p mean: -0.04151786491274834, mean p set: 0.4534335732460022
loss_pred:0.014965731650590897, decouple_loss:0.001204158877953887
The modified gen p mean: 0.45205241441726685, gen p mean: -0.04487307369709015, mean p set: 0.45253270864486694The modified gen p mean: 0.4504432678222656, gen p mean: -0.04954717680811882, mean p set: 0.4509235620498657
loss_pred:0.0160786435008049, decouple_loss:0.0012933964608237147
loss_pred:0.016311490908265114, decouple_loss:0.001287192339077592
Iteration: 739, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488624632358551, gen p mean: -0.046378474682569504, mean p set: 0.4493427276611328
loss_pred:0.016739265993237495, decouple_loss:0.0012192229041829705
The modified gen p mean: 0.45096173882484436, gen p mean: -0.04853971675038338, mean p set: 0.45144200325012207The modified gen p mean: 0.4533085525035858, gen p mean: -0.04051890969276428, mean p set: 0.4537888467311859
loss_pred:0.016011634841561317, decouple_loss:0.0010841548210009933
loss_pred:0.01528792455792427, decouple_loss:0.0011236825957894325
Iteration: 740, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4527561664581299, gen p mean: -0.042325541377067566, mean p set: 0.45323646068573
loss_pred:0.015070438385009766, decouple_loss:0.0010973506141453981
The modified gen p mean: 0.4500754475593567, gen p mean: -0.044487323611974716, mean p set: 0.4505557417869568The modified gen p mean: 0.4525958001613617, gen p mean: -0.04505278542637825, mean p set: 0.4530760943889618
loss_pred:0.016134681180119514, decouple_loss:0.0011954604415223002
loss_pred:0.014681125059723854, decouple_loss:0.0011355951428413391
2023-05-02 05:30:06 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.051110632717609406, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.0467645637691021, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.046959809958934784, mean p set: 0.4500633478164673
loss_pred:0.018408937379717827, decouple_loss:0.0011422601528465748
loss_pred:0.01733596809208393, decouple_loss:0.0012140803737565875
loss_pred:0.017403947189450264, decouple_loss:0.0012603577924892306
WV_0_PC_1_EH_0_PS_40, loss: 0.01777656190097332, avg_mse: 0.025558941066265106
current test mse: 0.025559
Iteration: 741, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496776759624481, gen p mean: -0.04540926590561867, mean p set: 0.45015794038772583
The modified gen p mean: 0.44934824109077454, gen p mean: -0.04074127972126007, mean p set: 0.449828565120697
The modified gen p mean: 0.449384868144989, gen p mean: -0.04492037370800972, mean p set: 0.4498651623725891
loss_pred:0.016626546159386635, decouple_loss:0.0011112983338534832
loss_pred:0.01651349663734436, decouple_loss:0.0010449010878801346
loss_pred:0.016568008810281754, decouple_loss:0.0010572592727839947
Iteration: 742, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45197778940200806, gen p mean: -0.04642854258418083, mean p set: 0.45245808362960815
loss_pred:0.014782634563744068, decouple_loss:0.001213982468470931
The modified gen p mean: 0.44982409477233887, gen p mean: -0.04677600786089897, mean p set: 0.45030441880226135The modified gen p mean: 0.45035654306411743, gen p mean: -0.045652493834495544, mean p set: 0.4508368670940399
loss_pred:0.016218123957514763, decouple_loss:0.0010650930926203728
loss_pred:0.01532969530671835, decouple_loss:0.001129765878431499
Iteration: 743, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495936930179596, gen p mean: -0.04565452039241791, mean p set: 0.4500739574432373
loss_pred:0.015783242881298065, decouple_loss:0.001091292011551559
The modified gen p mean: 0.4485822021961212, gen p mean: -0.051013726741075516, mean p set: 0.4490624964237213The modified gen p mean: 0.44985833764076233, gen p mean: -0.05163769796490669, mean p set: 0.4503386318683624
loss_pred:0.016139905899763107, decouple_loss:0.001044088858179748
loss_pred:0.016926653683185577, decouple_loss:0.001033878535963595
Iteration: 744, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499675929546356, gen p mean: -0.047750648111104965, mean p set: 0.4504478871822357
loss_pred:0.016295531764626503, decouple_loss:0.0011036479845643044
The modified gen p mean: 0.4505613446235657, gen p mean: -0.048691678792238235, mean p set: 0.45104163885116577
The modified gen p mean: 0.45028501749038696, gen p mean: -0.04452351853251457, mean p set: 0.4507652819156647
loss_pred:0.015897223725914955, decouple_loss:0.0011280352482572198
loss_pred:0.01614847220480442, decouple_loss:0.0011185531038790941
Iteration: 745, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45071595907211304, gen p mean: -0.05219831317663193, mean p set: 0.45119625329971313
loss_pred:0.01655949093401432, decouple_loss:0.0010250440100207925
The modified gen p mean: 0.4490398168563843, gen p mean: -0.04892454668879509, mean p set: 0.4495201110839844The modified gen p mean: 0.4487227201461792, gen p mean: -0.0519336573779583, mean p set: 0.4492030143737793
loss_pred:0.016016166657209396, decouple_loss:0.000996250077150762
loss_pred:0.016574235633015633, decouple_loss:0.001073493855074048
Iteration: 746, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494932293891907, gen p mean: -0.04612944275140762, mean p set: 0.4499734938144684
loss_pred:0.01677163690328598, decouple_loss:0.0009752537007443607
The modified gen p mean: 0.450252503156662, gen p mean: -0.043783362954854965, mean p set: 0.4507328271865845The modified gen p mean: 0.4525145888328552, gen p mean: -0.042304959148168564, mean p set: 0.45299485325813293
loss_pred:0.015818024054169655, decouple_loss:0.0010119463549926877
loss_pred:0.015495691448450089, decouple_loss:0.0010052700527012348
Iteration: 747, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4510343670845032, gen p mean: -0.041640300303697586, mean p set: 0.45151469111442566
loss_pred:0.016093499958515167, decouple_loss:0.001050681108608842
The modified gen p mean: 0.45018482208251953, gen p mean: -0.0485115610063076, mean p set: 0.450665146112442The modified gen p mean: 0.4485224783420563, gen p mean: -0.04562466964125633, mean p set: 0.44900277256965637
loss_pred:0.016696054488420486, decouple_loss:0.0009967009536921978
loss_pred:0.015480601228773594, decouple_loss:0.0009168550022877753
Iteration: 748, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44856002926826477, gen p mean: -0.0408497117459774, mean p set: 0.44904032349586487
loss_pred:0.0163714736700058, decouple_loss:0.001090147183276713
The modified gen p mean: 0.4493253827095032, gen p mean: -0.045584358274936676, mean p set: 0.44980570673942566The modified gen p mean: 0.4501342177391052, gen p mean: -0.03970654681324959, mean p set: 0.45061448216438293
loss_pred:0.015924528241157532, decouple_loss:0.001021771808154881
loss_pred:0.01576298289000988, decouple_loss:0.0010204896098002791
Iteration: 749, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44972747564315796, gen p mean: -0.03824944794178009, mean p set: 0.45020779967308044
loss_pred:0.01592445746064186, decouple_loss:0.0009504147456027567
The modified gen p mean: 0.4493951201438904, gen p mean: -0.03628847748041153, mean p set: 0.4498754143714905The modified gen p mean: 0.4493572413921356, gen p mean: -0.03980810567736626, mean p set: 0.4498375654220581
loss_pred:0.016575168818235397, decouple_loss:0.000933400122448802
loss_pred:0.016210757195949554, decouple_loss:0.0009394573280587792
Iteration: 750, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495698809623718, gen p mean: -0.039498377591371536, mean p set: 0.4500502049922943
loss_pred:0.01599813438951969, decouple_loss:0.0009798681130632758
The modified gen p mean: 0.4500119090080261, gen p mean: -0.03989468514919281, mean p set: 0.4504922032356262The modified gen p mean: 0.44808024168014526, gen p mean: -0.04263019934296608, mean p set: 0.44856053590774536
loss_pred:0.016196435317397118, decouple_loss:0.000978324213065207
loss_pred:0.01668495126068592, decouple_loss:0.001072545419447124
2023-05-02 05:32:01 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.04793170839548111, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04385173320770264, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.04388895258307457, mean p set: 0.4500633478164673
loss_pred:0.018475135788321495, decouple_loss:0.0011314598377794027
loss_pred:0.017354514449834824, decouple_loss:0.0011011213064193726
loss_pred:0.017438529059290886, decouple_loss:0.0011013024486601353
WV_0_PC_1_EH_0_PS_40, loss: 0.017811626195907593, avg_mse: 0.0256184209138155
current test mse: 0.025618
Iteration: 751, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45049506425857544, gen p mean: -0.041185300797224045, mean p set: 0.45097532868385315
The modified gen p mean: 0.45188695192337036, gen p mean: -0.044210877269506454, mean p set: 0.45236724615097046
The modified gen p mean: 0.45096853375434875, gen p mean: -0.047224581241607666, mean p set: 0.45144885778427124
loss_pred:0.01645311899483204, decouple_loss:0.000979964155703783
loss_pred:0.015623935498297215, decouple_loss:0.0010082360822707415
loss_pred:0.015658430755138397, decouple_loss:0.0010527606355026364
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012016_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012016_3_24hr.npz
NaN value num: 0
Iteration: 752, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470779299736023, gen p mean: -0.04928181692957878, mean p set: 0.4475582540035248
loss_pred:0.017602458596229553, decouple_loss:0.0010756003903225064
The modified gen p mean: 0.44814085960388184, gen p mean: -0.04549027979373932, mean p set: 0.44862115383148193The modified gen p mean: 0.44723373651504517, gen p mean: -0.04529920965433121, mean p set: 0.44771403074264526
loss_pred:0.0173454862087965, decouple_loss:0.0011773041915148497
loss_pred:0.017090123146772385, decouple_loss:0.0012215252500027418
Iteration: 753, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474761188030243, gen p mean: -0.048212435096502304, mean p set: 0.4479564428329468
loss_pred:0.017451053485274315, decouple_loss:0.0011146465549245477
The modified gen p mean: 0.44838374853134155, gen p mean: -0.04434078186750412, mean p set: 0.44886404275894165The modified gen p mean: 0.4470103681087494, gen p mean: -0.04851115494966507, mean p set: 0.4474906623363495
loss_pred:0.01579904556274414, decouple_loss:0.001176065648905933
loss_pred:0.017344968393445015, decouple_loss:0.0012198800686746836
Iteration: 754, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447206974029541, gen p mean: -0.05266633257269859, mean p set: 0.4476872384548187
loss_pred:0.01669798605144024, decouple_loss:0.0011256117140874267
The modified gen p mean: 0.4472391903400421, gen p mean: -0.05458877608180046, mean p set: 0.4477194845676422The modified gen p mean: 0.4472741186618805, gen p mean: -0.056337639689445496, mean p set: 0.4477544128894806
loss_pred:0.01612512581050396, decouple_loss:0.0010732797672972083
loss_pred:0.017117219045758247, decouple_loss:0.0010479328921064734
Iteration: 755, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480978846549988, gen p mean: -0.052749957889318466, mean p set: 0.44857820868492126
loss_pred:0.016909906640648842, decouple_loss:0.0011406652629375458
The modified gen p mean: 0.44831234216690063, gen p mean: -0.0489395447075367, mean p set: 0.44879260659217834The modified gen p mean: 0.44712480902671814, gen p mean: -0.055233389139175415, mean p set: 0.44760507345199585
loss_pred:0.015892835333943367, decouple_loss:0.0010953029850497842
loss_pred:0.017008543014526367, decouple_loss:0.0010962047381326556
Iteration: 756, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469808340072632, gen p mean: -0.052756402641534805, mean p set: 0.4474611282348633
loss_pred:0.016270777210593224, decouple_loss:0.0010585110867395997
The modified gen p mean: 0.44771137833595276, gen p mean: -0.056465502828359604, mean p set: 0.44819167256355286The modified gen p mean: 0.448380708694458, gen p mean: -0.06224404647946358, mean p set: 0.4488610029220581
loss_pred:0.017429498955607414, decouple_loss:0.0010399232851341367
loss_pred:0.017459135502576828, decouple_loss:0.0010421155020594597
Iteration: 757, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44833508133888245, gen p mean: -0.058069903403520584, mean p set: 0.44881540536880493
loss_pred:0.01680266298353672, decouple_loss:0.0011302335187792778
The modified gen p mean: 0.4467546343803406, gen p mean: -0.06341284513473511, mean p set: 0.4472349286079407The modified gen p mean: 0.44908756017684937, gen p mean: -0.05504222586750984, mean p set: 0.44956785440444946
loss_pred:0.016895929351449013, decouple_loss:0.0011013245675712824
loss_pred:0.017124274745583534, decouple_loss:0.0010546020930632949
Iteration: 758, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475862383842468, gen p mean: -0.056667666882276535, mean p set: 0.4480665326118469
loss_pred:0.0161371361464262, decouple_loss:0.001107113086618483
The modified gen p mean: 0.44618886709213257, gen p mean: -0.06254018843173981, mean p set: 0.4466691315174103The modified gen p mean: 0.44829297065734863, gen p mean: -0.056154765188694, mean p set: 0.44877323508262634
loss_pred:0.01707511581480503, decouple_loss:0.001117959152907133
loss_pred:0.017071926966309547, decouple_loss:0.0010735798859968781
Iteration: 759, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44806674122810364, gen p mean: -0.06100562959909439, mean p set: 0.44854697585105896
loss_pred:0.01729714684188366, decouple_loss:0.0011798449559137225
The modified gen p mean: 0.4476652443408966, gen p mean: -0.06367624551057816, mean p set: 0.4481455683708191The modified gen p mean: 0.447444349527359, gen p mean: -0.061982352286577225, mean p set: 0.4479246735572815
loss_pred:0.017291126772761345, decouple_loss:0.0012664260575547814
loss_pred:0.017542822286486626, decouple_loss:0.0011583000887185335
Iteration: 760, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4455741345882416, gen p mean: -0.06031101197004318, mean p set: 0.4460543990135193
loss_pred:0.017043190076947212, decouple_loss:0.0012277300702407956
The modified gen p mean: 0.44706201553344727, gen p mean: -0.0595092698931694, mean p set: 0.4475422501564026The modified gen p mean: 0.4476057291030884, gen p mean: -0.06017368286848068, mean p set: 0.44808605313301086
loss_pred:0.016865193843841553, decouple_loss:0.001277955831028521
loss_pred:0.01738709770143032, decouple_loss:0.001185353146865964
2023-05-02 05:34:31 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.05936693027615547, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.05502541363239288, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.055444683879613876, mean p set: 0.4500633478164673
loss_pred:0.01848549209535122, decouple_loss:0.0011567932087928057
loss_pred:0.017423171550035477, decouple_loss:0.0011008024448528886
loss_pred:0.017557520419359207, decouple_loss:0.0010780165903270245
WV_0_PC_1_EH_0_PS_40, loss: 0.01787765510380268, avg_mse: 0.025756927207112312
current test mse: 0.025757
Iteration: 761, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474298655986786, gen p mean: -0.06214715912938118, mean p set: 0.4479101598262787
The modified gen p mean: 0.4465150833129883, gen p mean: -0.05722779780626297, mean p set: 0.4469953775405884
The modified gen p mean: 0.44873499870300293, gen p mean: -0.05909235402941704, mean p set: 0.4492153227329254
loss_pred:0.017118394374847412, decouple_loss:0.0010552778840065002
loss_pred:0.017178097739815712, decouple_loss:0.0010946576949208975
loss_pred:0.0173821821808815, decouple_loss:0.0011413785396143794
Iteration: 762, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470826983451843, gen p mean: -0.053283412009477615, mean p set: 0.4475629925727844
loss_pred:0.016254911199212074, decouple_loss:0.001161015359684825
The modified gen p mean: 0.4467078745365143, gen p mean: -0.05537780746817589, mean p set: 0.4471881687641144The modified gen p mean: 0.4483150541782379, gen p mean: -0.05023520812392235, mean p set: 0.448795348405838
loss_pred:0.01651967689394951, decouple_loss:0.0011151132639497519
loss_pred:0.01687435805797577, decouple_loss:0.0011379028437659144
Iteration: 763, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44649913907051086, gen p mean: -0.05470111221075058, mean p set: 0.44697946310043335
loss_pred:0.01698135957121849, decouple_loss:0.0011308466782793403
The modified gen p mean: 0.44745978713035583, gen p mean: -0.05071431025862694, mean p set: 0.4479401111602783The modified gen p mean: 0.44564107060432434, gen p mean: -0.05282340943813324, mean p set: 0.44612136483192444
loss_pred:0.017101915553212166, decouple_loss:0.0011124643497169018
loss_pred:0.01739942841231823, decouple_loss:0.001123626483604312
Iteration: 764, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474543035030365, gen p mean: -0.04882928356528282, mean p set: 0.4479345977306366
loss_pred:0.016727477312088013, decouple_loss:0.0010961469961330295
The modified gen p mean: 0.44718053936958313, gen p mean: -0.04450426623225212, mean p set: 0.4476608335971832The modified gen p mean: 0.44587671756744385, gen p mean: -0.04996761307120323, mean p set: 0.44635701179504395
loss_pred:0.01717202737927437, decouple_loss:0.001104887924157083
loss_pred:0.015418034978210926, decouple_loss:0.0011928367894142866
Iteration: 765, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466773569583893, gen p mean: -0.04841449111700058, mean p set: 0.4471576511859894
loss_pred:0.016579706221818924, decouple_loss:0.0011059832759201527
The modified gen p mean: 0.44818711280822754, gen p mean: -0.046681489795446396, mean p set: 0.44866740703582764The modified gen p mean: 0.44696423411369324, gen p mean: -0.04771248251199722, mean p set: 0.44744452834129333
loss_pred:0.01674468070268631, decouple_loss:0.0010925347451120615
loss_pred:0.0165619608014822, decouple_loss:0.0010898092295974493
Iteration: 766, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475901424884796, gen p mean: -0.05250957980751991, mean p set: 0.4480704367160797
loss_pred:0.01651753857731819, decouple_loss:0.0011391662992537022
The modified gen p mean: 0.4473735988140106, gen p mean: -0.05029402673244476, mean p set: 0.4478538930416107The modified gen p mean: 0.44686082005500793, gen p mean: -0.04833124950528145, mean p set: 0.4473411440849304
loss_pred:0.016177084296941757, decouple_loss:0.001112147350795567
loss_pred:0.016651295125484467, decouple_loss:0.0010556280612945557
Iteration: 767, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464946985244751, gen p mean: -0.05066091939806938, mean p set: 0.4469749927520752
loss_pred:0.017280004918575287, decouple_loss:0.0014053002232685685
The modified gen p mean: 0.4470864534378052, gen p mean: -0.0515056811273098, mean p set: 0.44756677746772766The modified gen p mean: 0.44929271936416626, gen p mean: -0.05170528218150139, mean p set: 0.44977301359176636
loss_pred:0.016736887395381927, decouple_loss:0.0014272780390456319
loss_pred:0.0169118233025074, decouple_loss:0.0014791827416047454
Iteration: 768, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484826326370239, gen p mean: -0.05480575934052467, mean p set: 0.448962926864624
loss_pred:0.017044993117451668, decouple_loss:0.0011520730331540108
The modified gen p mean: 0.4475539028644562, gen p mean: -0.05456268787384033, mean p set: 0.4480341970920563The modified gen p mean: 0.44716790318489075, gen p mean: -0.056041788309812546, mean p set: 0.44764822721481323
loss_pred:0.017635853961110115, decouple_loss:0.0012034170795232058
loss_pred:0.016194622963666916, decouple_loss:0.0012538321316242218
Iteration: 769, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44731447100639343, gen p mean: -0.05338645353913307, mean p set: 0.44779476523399353
loss_pred:0.01569204032421112, decouple_loss:0.0012525197817012668
The modified gen p mean: 0.44815248250961304, gen p mean: -0.0570940338075161, mean p set: 0.44863274693489075The modified gen p mean: 0.4461660385131836, gen p mean: -0.056356046348810196, mean p set: 0.4466463625431061
loss_pred:0.016604842618107796, decouple_loss:0.0012696735793724656
loss_pred:0.01710383966565132, decouple_loss:0.0012421999126672745
Iteration: 770, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44743454456329346, gen p mean: -0.057168155908584595, mean p set: 0.44791483879089355
loss_pred:0.01746450737118721, decouple_loss:0.0011857880745083094
The modified gen p mean: 0.44669753313064575, gen p mean: -0.056759078055620193, mean p set: 0.44717782735824585The modified gen p mean: 0.4465456008911133, gen p mean: -0.05684707313776016, mean p set: 0.447025865316391
loss_pred:0.01610950194299221, decouple_loss:0.0012847735779359937
loss_pred:0.0157273318618536, decouple_loss:0.0012700083898380399
2023-05-02 05:36:25 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.057844460010528564, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.053473614156246185, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.0539090521633625, mean p set: 0.4500633478164673
loss_pred:0.018499283120036125, decouple_loss:0.001123220776207745
loss_pred:0.017433278262615204, decouple_loss:0.0011209470685571432
loss_pred:0.01754491776227951, decouple_loss:0.0011010334128513932
WV_0_PC_1_EH_0_PS_40, loss: 0.01788157969713211, avg_mse: 0.02577430196106434
current test mse: 0.025774
Iteration: 771, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478066861629486, gen p mean: -0.05314594507217407, mean p set: 0.4482869803905487
The modified gen p mean: 0.44613581895828247, gen p mean: -0.0571712888777256, mean p set: 0.44661614298820496
The modified gen p mean: 0.4488820433616638, gen p mean: -0.053859464824199677, mean p set: 0.4493623375892639
loss_pred:0.01632292941212654, decouple_loss:0.0011223283363506198
loss_pred:0.0167876947671175, decouple_loss:0.0010644858703017235
loss_pred:0.017124777659773827, decouple_loss:0.001055411295965314
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012014_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012014_3_24hr.npz
NaN value num: 0
Iteration: 772, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487953782081604, gen p mean: -0.04223978891968727, mean p set: 0.4492756426334381
loss_pred:0.01766388863325119, decouple_loss:0.0012175673618912697
The modified gen p mean: 0.4521694481372833, gen p mean: -0.043058060109615326, mean p set: 0.4526497423648834The modified gen p mean: 0.44853904843330383, gen p mean: -0.04661961644887924, mean p set: 0.44901934266090393
loss_pred:0.01618700474500656, decouple_loss:0.0011308339890092611
loss_pred:0.016513273119926453, decouple_loss:0.0011461093090474606
Iteration: 773, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44890737533569336, gen p mean: -0.04105697572231293, mean p set: 0.44938766956329346
loss_pred:0.01608322560787201, decouple_loss:0.001266577746719122
The modified gen p mean: 0.4491342604160309, gen p mean: -0.03919490426778793, mean p set: 0.4496145248413086The modified gen p mean: 0.44764041900634766, gen p mean: -0.04684305936098099, mean p set: 0.44812071323394775
loss_pred:0.016981644555926323, decouple_loss:0.0011718098539859056
loss_pred:0.017350008711218834, decouple_loss:0.0011245209025219083
Iteration: 774, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44856590032577515, gen p mean: -0.04158126562833786, mean p set: 0.44904619455337524
loss_pred:0.017221657559275627, decouple_loss:0.0011955559020861983
The modified gen p mean: 0.4486335217952728, gen p mean: -0.044342610985040665, mean p set: 0.4491138160228729The modified gen p mean: 0.4492426812648773, gen p mean: -0.044999998062849045, mean p set: 0.4497230052947998
loss_pred:0.016708647832274437, decouple_loss:0.0011473186314105988
loss_pred:0.01606861501932144, decouple_loss:0.0013658347306773067
Iteration: 775, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45027220249176025, gen p mean: -0.041466426104307175, mean p set: 0.45075252652168274
loss_pred:0.016479138284921646, decouple_loss:0.0011685258941724896
The modified gen p mean: 0.44919106364250183, gen p mean: -0.03994399681687355, mean p set: 0.44967135787010193The modified gen p mean: 0.45032864809036255, gen p mean: -0.04959828034043312, mean p set: 0.45080891251564026
loss_pred:0.0166180282831192, decouple_loss:0.0011449942830950022
loss_pred:0.016906486824154854, decouple_loss:0.0013518707128241658
Iteration: 776, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44963958859443665, gen p mean: -0.047867923974990845, mean p set: 0.45011985301971436
loss_pred:0.015778634697198868, decouple_loss:0.0011931838234886527
The modified gen p mean: 0.44781234860420227, gen p mean: -0.046696893870830536, mean p set: 0.44829264283180237The modified gen p mean: 0.4478864371776581, gen p mean: -0.04208596423268318, mean p set: 0.4483667314052582
loss_pred:0.01674874685704708, decouple_loss:0.0011399155482649803
loss_pred:0.01648031547665596, decouple_loss:0.0011150394566357136
Iteration: 777, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44993776082992554, gen p mean: -0.049166519194841385, mean p set: 0.45041805505752563
loss_pred:0.015869861468672752, decouple_loss:0.0011445253621786833
The modified gen p mean: 0.45031604170799255, gen p mean: -0.04257659614086151, mean p set: 0.45079630613327026The modified gen p mean: 0.4510965049266815, gen p mean: -0.04254781827330589, mean p set: 0.4515767991542816
loss_pred:0.016010647639632225, decouple_loss:0.001210857997648418
loss_pred:0.015505059622228146, decouple_loss:0.0012085041962563992
Iteration: 778, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503253102302551, gen p mean: -0.04067562147974968, mean p set: 0.4508056342601776
loss_pred:0.015599898993968964, decouple_loss:0.001115637831389904
The modified gen p mean: 0.4473547339439392, gen p mean: -0.04763609170913696, mean p set: 0.4478350281715393The modified gen p mean: 0.44923341274261475, gen p mean: -0.04251434653997421, mean p set: 0.44971367716789246
loss_pred:0.016452573239803314, decouple_loss:0.00122494762763381
loss_pred:0.01721029356122017, decouple_loss:0.0011990850325673819
Iteration: 779, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494793713092804, gen p mean: -0.04547847434878349, mean p set: 0.4499596655368805
loss_pred:0.015798814594745636, decouple_loss:0.001159205101430416
The modified gen p mean: 0.4495643079280853, gen p mean: -0.048800889402627945, mean p set: 0.4500446021556854The modified gen p mean: 0.44784224033355713, gen p mean: -0.04786507412791252, mean p set: 0.4483225345611572
loss_pred:0.01653129607439041, decouple_loss:0.0012459151912480593
loss_pred:0.01689617894589901, decouple_loss:0.001130768796429038
Iteration: 780, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448962539434433, gen p mean: -0.04982919245958328, mean p set: 0.4494428038597107
loss_pred:0.0163999255746603, decouple_loss:0.0010567335411906242
The modified gen p mean: 0.4497719407081604, gen p mean: -0.04723281040787697, mean p set: 0.4502522349357605The modified gen p mean: 0.45079007744789124, gen p mean: -0.05111032351851463, mean p set: 0.45127037167549133
loss_pred:0.01567869819700718, decouple_loss:0.0010654742363840342
loss_pred:0.01652645505964756, decouple_loss:0.0010920867789536715
2023-05-02 05:38:57 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.062386952340602875, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830535888672, gen p mean: -0.05840498208999634, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.05795919522643089, mean p set: 0.45035696029663086
loss_pred:0.01845012977719307, decouple_loss:0.0013311904622241855
loss_pred:0.017478369176387787, decouple_loss:0.001546444371342659
loss_pred:0.017346002161502838, decouple_loss:0.0015793705824762583
WV_0_PC_1_EH_0_PS_40, loss: 0.017832450568675995, avg_mse: 0.02561139687895775
current test mse: 0.025611
Iteration: 781, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495418071746826, gen p mean: -0.04832613468170166, mean p set: 0.4500221312046051
The modified gen p mean: 0.44972679018974304, gen p mean: -0.05040069296956062, mean p set: 0.45020708441734314
The modified gen p mean: 0.45048201084136963, gen p mean: -0.054405733942985535, mean p set: 0.4509623348712921
loss_pred:0.017120318487286568, decouple_loss:0.001115598832257092
loss_pred:0.015619510784745216, decouple_loss:0.0010633558267727494
loss_pred:0.016884738579392433, decouple_loss:0.0011757573811337352
Iteration: 782, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45043060183525085, gen p mean: -0.05321931838989258, mean p set: 0.45091089606285095
loss_pred:0.015843790024518967, decouple_loss:0.0010973495664075017
The modified gen p mean: 0.4499434530735016, gen p mean: -0.05249274894595146, mean p set: 0.4504237771034241The modified gen p mean: 0.45106568932533264, gen p mean: -0.05470063537359238, mean p set: 0.45154598355293274
loss_pred:0.016379449516534805, decouple_loss:0.0011225190246477723
loss_pred:0.016117844730615616, decouple_loss:0.0010958199854940176
Iteration: 783, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45083239674568176, gen p mean: -0.05043947696685791, mean p set: 0.45131269097328186
loss_pred:0.01534369308501482, decouple_loss:0.0010866036172956228
The modified gen p mean: 0.44892337918281555, gen p mean: -0.04620598629117012, mean p set: 0.44940370321273804The modified gen p mean: 0.4511122405529022, gen p mean: -0.053831521421670914, mean p set: 0.4515925347805023
loss_pred:0.016369152814149857, decouple_loss:0.0009527452057227492
loss_pred:0.01560218259692192, decouple_loss:0.0009981348412111402
Iteration: 784, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44889235496520996, gen p mean: -0.045523419976234436, mean p set: 0.44937264919281006
loss_pred:0.01689387485384941, decouple_loss:0.001094788545742631
The modified gen p mean: 0.4502425789833069, gen p mean: -0.0540691576898098, mean p set: 0.4507228434085846The modified gen p mean: 0.4508521556854248, gen p mean: -0.0545102022588253, mean p set: 0.4513324499130249
loss_pred:0.0161824319511652, decouple_loss:0.001116165891289711
loss_pred:0.01594633236527443, decouple_loss:0.0010870250407606363
Iteration: 785, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44947919249534607, gen p mean: -0.05175216495990753, mean p set: 0.4499594569206238
loss_pred:0.01600774936378002, decouple_loss:0.0012644395465031266
The modified gen p mean: 0.4514255225658417, gen p mean: -0.05296104773879051, mean p set: 0.4519057869911194The modified gen p mean: 0.44983917474746704, gen p mean: -0.05249936506152153, mean p set: 0.45031946897506714
loss_pred:0.017489444464445114, decouple_loss:0.0011174343526363373
loss_pred:0.01645534485578537, decouple_loss:0.001121674431487918
Iteration: 786, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44781580567359924, gen p mean: -0.048390910029411316, mean p set: 0.44829609990119934
loss_pred:0.016260115429759026, decouple_loss:0.0011515788501128554
The modified gen p mean: 0.45023971796035767, gen p mean: -0.044967420399188995, mean p set: 0.45072001218795776The modified gen p mean: 0.4482405185699463, gen p mean: -0.04587068408727646, mean p set: 0.4487208127975464
loss_pred:0.01644655503332615, decouple_loss:0.0012474402319639921
loss_pred:0.015782734379172325, decouple_loss:0.0011495270300656557
Iteration: 787, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481632709503174, gen p mean: -0.04517950862646103, mean p set: 0.4486435651779175
loss_pred:0.015651723369956017, decouple_loss:0.0010824414202943444
The modified gen p mean: 0.44736045598983765, gen p mean: -0.04790353775024414, mean p set: 0.44784078001976013The modified gen p mean: 0.44900259375572205, gen p mean: -0.043387092649936676, mean p set: 0.44948288798332214
loss_pred:0.015572178177535534, decouple_loss:0.001204479718580842
loss_pred:0.016146620735526085, decouple_loss:0.0011500511318445206
Iteration: 788, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504087269306183, gen p mean: -0.047420620918273926, mean p set: 0.450888991355896
loss_pred:0.015898287296295166, decouple_loss:0.0011605953332036734
The modified gen p mean: 0.4504573941230774, gen p mean: -0.04829564690589905, mean p set: 0.4509376883506775The modified gen p mean: 0.4477938711643219, gen p mean: -0.0466751903295517, mean p set: 0.4482741951942444
loss_pred:0.016145111992955208, decouple_loss:0.0011308997636660933
loss_pred:0.0163499154150486, decouple_loss:0.0011174544924870133
Iteration: 789, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495052695274353, gen p mean: -0.044779222458601, mean p set: 0.4499855935573578
loss_pred:0.01576271280646324, decouple_loss:0.0011016634525731206
The modified gen p mean: 0.45113056898117065, gen p mean: -0.04505554586648941, mean p set: 0.45161086320877075The modified gen p mean: 0.45154479146003723, gen p mean: -0.04847996309399605, mean p set: 0.45202508568763733
loss_pred:0.01776880957186222, decouple_loss:0.001153265475295484
loss_pred:0.0162906926125288, decouple_loss:0.001153207034803927
Iteration: 790, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45174407958984375, gen p mean: -0.04554111883044243, mean p set: 0.45222434401512146
loss_pred:0.01617891527712345, decouple_loss:0.0012108355294913054
The modified gen p mean: 0.4473794400691986, gen p mean: -0.053655415773391724, mean p set: 0.4478597342967987The modified gen p mean: 0.4506310820579529, gen p mean: -0.04732326418161392, mean p set: 0.451111376285553
loss_pred:0.016476819291710854, decouple_loss:0.0012595579028129578
loss_pred:0.01566280797123909, decouple_loss:0.0011560419807210565
2023-05-02 05:40:52 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.062104035168886185, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.057814840227365494, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.05805092304944992, mean p set: 0.4500633478164673
loss_pred:0.018489979207515717, decouple_loss:0.0013896720483899117
loss_pred:0.01756361871957779, decouple_loss:0.001316359848715365
loss_pred:0.017370538786053658, decouple_loss:0.0014059663517400622
WV_0_PC_1_EH_0_PS_40, loss: 0.017876580357551575, avg_mse: 0.02569565363228321
current test mse: 0.025696
Iteration: 791, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44945552945137024, gen p mean: -0.05538469925522804, mean p set: 0.44993579387664795The modified gen p mean: 0.44846534729003906, gen p mean: -0.053417451679706573, mean p set: 0.4489456117153168
The modified gen p mean: 0.44895386695861816, gen p mean: -0.05479200556874275, mean p set: 0.44943416118621826
loss_pred:0.015494531951844692, decouple_loss:0.00122983253095299
loss_pred:0.01606343500316143, decouple_loss:0.0012700080405920744
loss_pred:0.01584770530462265, decouple_loss:0.0012939918087795377
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012014_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012014_3_24hr.npz
NaN value num: 0
Iteration: 792, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480167031288147, gen p mean: -0.05858398973941803, mean p set: 0.4484969973564148
loss_pred:0.017892317846417427, decouple_loss:0.001445045112632215
The modified gen p mean: 0.4461558759212494, gen p mean: -0.06272689998149872, mean p set: 0.4466361403465271The modified gen p mean: 0.4483528137207031, gen p mean: -0.057679276913404465, mean p set: 0.44883307814598083
loss_pred:0.017006685957312584, decouple_loss:0.0013877006713300943
loss_pred:0.017890023067593575, decouple_loss:0.00136370281688869
Iteration: 793, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44634953141212463, gen p mean: -0.058913540095090866, mean p set: 0.44682982563972473
The modified gen p mean: 0.4463445842266083, gen p mean: -0.057349663227796555, mean p set: 0.4468248784542084
loss_pred:0.01727338321506977, decouple_loss:0.0012456432450562716
loss_pred:0.016720309853553772, decouple_loss:0.001159936422482133
The modified gen p mean: 0.4473405182361603, gen p mean: -0.06072907894849777, mean p set: 0.4478208124637604
loss_pred:0.017517223954200745, decouple_loss:0.001136848353780806
Iteration: 794, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469979703426361, gen p mean: -0.05536571890115738, mean p set: 0.4474782347679138
The modified gen p mean: 0.445794939994812, gen p mean: -0.05887920781970024, mean p set: 0.4462752044200897
loss_pred:0.016916224732995033, decouple_loss:0.0012282219249755144
loss_pred:0.017179390415549278, decouple_loss:0.0012736860662698746
The modified gen p mean: 0.44614872336387634, gen p mean: -0.05919134244322777, mean p set: 0.44662904739379883
loss_pred:0.0169584508985281, decouple_loss:0.0012494232505559921
Iteration: 795, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481840431690216, gen p mean: -0.05084807053208351, mean p set: 0.4486643373966217
loss_pred:0.017981620505452156, decouple_loss:0.0012303543044254184
The modified gen p mean: 0.4461723566055298, gen p mean: -0.05529281869530678, mean p set: 0.4466526508331299The modified gen p mean: 0.4487491250038147, gen p mean: -0.05136195942759514, mean p set: 0.4492294192314148
loss_pred:0.016783257946372032, decouple_loss:0.0012081030290573835
loss_pred:0.017542248591780663, decouple_loss:0.0012281235540285707
Iteration: 796, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484892189502716, gen p mean: -0.04930443689227104, mean p set: 0.4489694833755493
loss_pred:0.017552917823195457, decouple_loss:0.0014603061135858297
The modified gen p mean: 0.4462824761867523, gen p mean: -0.05187258496880531, mean p set: 0.4467627704143524The modified gen p mean: 0.4463683068752289, gen p mean: -0.05124760419130325, mean p set: 0.4468485414981842
loss_pred:0.016168948262929916, decouple_loss:0.0011646009515970945
loss_pred:0.01686122640967369, decouple_loss:0.0012099501909688115
Iteration: 797, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44673365354537964, gen p mean: -0.041633591055870056, mean p set: 0.4472139775753021
loss_pred:0.01666221022605896, decouple_loss:0.0011676326394081116
The modified gen p mean: 0.4477706551551819, gen p mean: -0.04827307537198067, mean p set: 0.448250949382782The modified gen p mean: 0.4477894604206085, gen p mean: -0.0424707755446434, mean p set: 0.44826972484588623
loss_pred:0.017436394467949867, decouple_loss:0.0012100342428311706
loss_pred:0.016276370733976364, decouple_loss:0.0011594477109611034
Iteration: 798, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44776710867881775, gen p mean: -0.04663272574543953, mean p set: 0.44824743270874023
loss_pred:0.017481019720435143, decouple_loss:0.001123066060245037
The modified gen p mean: 0.4467674791812897, gen p mean: -0.04060885310173035, mean p set: 0.44724777340888977The modified gen p mean: 0.4469245672225952, gen p mean: -0.04513731226325035, mean p set: 0.4474048614501953
loss_pred:0.016657080501317978, decouple_loss:0.0011343704536557198
loss_pred:0.016766712069511414, decouple_loss:0.0011702871415764093
Iteration: 799, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44708576798439026, gen p mean: -0.046438898891210556, mean p set: 0.44756606221199036
loss_pred:0.016465354710817337, decouple_loss:0.0010860345792025328
The modified gen p mean: 0.44600510597229004, gen p mean: -0.045201290398836136, mean p set: 0.44648540019989014The modified gen p mean: 0.44731974601745605, gen p mean: -0.04783632233738899, mean p set: 0.44780007004737854
loss_pred:0.01671084202826023, decouple_loss:0.001163290929980576
loss_pred:0.017477747052907944, decouple_loss:0.0010933100711554289
Iteration: 800, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44714465737342834, gen p mean: -0.04451877996325493, mean p set: 0.44762495160102844
loss_pred:0.016278453171253204, decouple_loss:0.0011872673640027642
The modified gen p mean: 0.4462166130542755, gen p mean: -0.049412354826927185, mean p set: 0.4466968774795532The modified gen p mean: 0.44829297065734863, gen p mean: -0.04837420582771301, mean p set: 0.44877323508262634
loss_pred:0.017169803380966187, decouple_loss:0.0011472353944554925
loss_pred:0.01714206300675869, decouple_loss:0.0011461394606158137
2023-05-02 05:43:21 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.05489002540707588, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.050222598016262054, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.05080106109380722, mean p set: 0.4500633478164673
loss_pred:0.018428783863782883, decouple_loss:0.0011178066488355398
loss_pred:0.017344648018479347, decouple_loss:0.0012302846880629659
loss_pred:0.017495492473244667, decouple_loss:0.0011546831810846925
WV_0_PC_1_EH_0_PS_40, loss: 0.01781468838453293, avg_mse: 0.025585008785128593
current test mse: 0.025585
Iteration: 801, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44622454047203064, gen p mean: -0.048575855791568756, mean p set: 0.44670480489730835
The modified gen p mean: 0.4470100402832031, gen p mean: -0.04969702661037445, mean p set: 0.4474903643131256
The modified gen p mean: 0.4462904930114746, gen p mean: -0.05283881723880768, mean p set: 0.4467707574367523
loss_pred:0.016427237540483475, decouple_loss:0.0010836998699232936
loss_pred:0.01668544113636017, decouple_loss:0.0010567272547632456
loss_pred:0.017102718353271484, decouple_loss:0.0011219452135264874
Iteration: 802, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466865062713623, gen p mean: -0.04770544543862343, mean p set: 0.4471668004989624
loss_pred:0.01747198961675167, decouple_loss:0.0011618382995948195
The modified gen p mean: 0.4475116431713104, gen p mean: -0.05320608243346214, mean p set: 0.44799190759658813The modified gen p mean: 0.4487219750881195, gen p mean: -0.05362383648753166, mean p set: 0.4492022693157196
loss_pred:0.017707884311676025, decouple_loss:0.0011121666757389903
loss_pred:0.015952039510011673, decouple_loss:0.0010366177884861827
Iteration: 803, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44678714871406555, gen p mean: -0.04882710054516792, mean p set: 0.44726744294166565
loss_pred:0.016647592186927795, decouple_loss:0.0012172653805464506
The modified gen p mean: 0.44886305928230286, gen p mean: -0.052278030663728714, mean p set: 0.44934335350990295The modified gen p mean: 0.44753193855285645, gen p mean: -0.055452004075050354, mean p set: 0.44801223278045654
loss_pred:0.017681416124105453, decouple_loss:0.0012631070567294955
loss_pred:0.01743891090154648, decouple_loss:0.0011765743838623166
Iteration: 804, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475215971469879, gen p mean: -0.049809589982032776, mean p set: 0.448001891374588
loss_pred:0.017485523596405983, decouple_loss:0.0010498086921870708
The modified gen p mean: 0.44682130217552185, gen p mean: -0.051113031804561615, mean p set: 0.44730156660079956The modified gen p mean: 0.44828104972839355, gen p mean: -0.0485103614628315, mean p set: 0.44876134395599365
loss_pred:0.016989346593618393, decouple_loss:0.0010909168049693108
loss_pred:0.018080992624163628, decouple_loss:0.0010291236685588956
Iteration: 805, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44763386249542236, gen p mean: -0.051879316568374634, mean p set: 0.44811415672302246
loss_pred:0.017530974000692368, decouple_loss:0.0012551210820674896
The modified gen p mean: 0.4482387900352478, gen p mean: -0.048671744763851166, mean p set: 0.4487190544605255The modified gen p mean: 0.4460732042789459, gen p mean: -0.047792088240385056, mean p set: 0.446553498506546
loss_pred:0.017524665221571922, decouple_loss:0.0012268099235370755
loss_pred:0.016563786193728447, decouple_loss:0.001173773081973195
Iteration: 806, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4462827146053314, gen p mean: -0.04785330966114998, mean p set: 0.4467630088329315
loss_pred:0.017067765817046165, decouple_loss:0.001032498781569302
The modified gen p mean: 0.4473278820514679, gen p mean: -0.04464134946465492, mean p set: 0.4478082060813904The modified gen p mean: 0.4468817412853241, gen p mean: -0.05054116249084473, mean p set: 0.4473620653152466
loss_pred:0.016683150082826614, decouple_loss:0.0011665443889796734
loss_pred:0.017046067863702774, decouple_loss:0.0011076247319579124
Iteration: 807, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4462626874446869, gen p mean: -0.047935377806425095, mean p set: 0.446742981672287
loss_pred:0.017085690051317215, decouple_loss:0.001028330298140645
The modified gen p mean: 0.44834718108177185, gen p mean: -0.04804591089487076, mean p set: 0.44882747530937195The modified gen p mean: 0.4469219148159027, gen p mean: -0.04429740831255913, mean p set: 0.4474022090435028
loss_pred:0.017467517405748367, decouple_loss:0.0010736120166257024
loss_pred:0.017470993101596832, decouple_loss:0.0010451962007209659
Iteration: 808, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44689828157424927, gen p mean: -0.046657174825668335, mean p set: 0.44737857580184937
loss_pred:0.0172283835709095, decouple_loss:0.00113091547973454
The modified gen p mean: 0.4469447135925293, gen p mean: -0.045503877103328705, mean p set: 0.4474250078201294The modified gen p mean: 0.44780921936035156, gen p mean: -0.046465303748846054, mean p set: 0.44828951358795166
loss_pred:0.01742282696068287, decouple_loss:0.0011936018709093332
loss_pred:0.016405358910560608, decouple_loss:0.0011140215210616589
Iteration: 809, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489080309867859, gen p mean: -0.04823874682188034, mean p set: 0.449388325214386
loss_pred:0.01693875901401043, decouple_loss:0.0011072218185290694
The modified gen p mean: 0.44659125804901123, gen p mean: -0.052392225712537766, mean p set: 0.44707152247428894The modified gen p mean: 0.44592970609664917, gen p mean: -0.053697600960731506, mean p set: 0.44641000032424927
loss_pred:0.016286639496684074, decouple_loss:0.0010341324377804995
loss_pred:0.016847115010023117, decouple_loss:0.0010613303165882826
Iteration: 810, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44858789443969727, gen p mean: -0.048104725778102875, mean p set: 0.44906821846961975
loss_pred:0.01629343070089817, decouple_loss:0.001092542428523302
The modified gen p mean: 0.44708535075187683, gen p mean: -0.05307694524526596, mean p set: 0.44756564497947693The modified gen p mean: 0.44636473059654236, gen p mean: -0.05267731100320816, mean p set: 0.44684502482414246
loss_pred:0.01589084416627884, decouple_loss:0.001005131984129548
loss_pred:0.01612148806452751, decouple_loss:0.0010199695825576782
2023-05-02 05:45:15 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.05397731065750122, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04939466342329979, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830237865448, gen p mean: -0.04989899322390556, mean p set: 0.4500633478164673
loss_pred:0.018327496945858, decouple_loss:0.0012190899578854442
loss_pred:0.017313309013843536, decouple_loss:0.0012067462084814906
loss_pred:0.01743249222636223, decouple_loss:0.0011883581755682826
WV_0_PC_1_EH_0_PS_40, loss: 0.017751336097717285, avg_mse: 0.025503648445010185
current test mse: 0.025504
Iteration: 811, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477754831314087, gen p mean: -0.05141833797097206, mean p set: 0.4482557475566864
The modified gen p mean: 0.4468585252761841, gen p mean: -0.0518181137740612, mean p set: 0.4473387897014618
The modified gen p mean: 0.44618138670921326, gen p mean: -0.04811042174696922, mean p set: 0.44666171073913574
loss_pred:0.016621984541416168, decouple_loss:0.0010464489459991455
loss_pred:0.016998665407299995, decouple_loss:0.001104900031350553
loss_pred:0.016441266983747482, decouple_loss:0.0011277515441179276
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012013_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012013_3_24hr.npz
NaN value num: 0
Iteration: 812, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44815319776535034, gen p mean: -0.055437326431274414, mean p set: 0.44863349199295044
loss_pred:0.01667652279138565, decouple_loss:0.001103562070056796
The modified gen p mean: 0.44686761498451233, gen p mean: -0.05332324653863907, mean p set: 0.4473479390144348The modified gen p mean: 0.44728413224220276, gen p mean: -0.05302534997463226, mean p set: 0.44776445627212524
loss_pred:0.01773190125823021, decouple_loss:0.0010232302593067288
loss_pred:0.016874141991138458, decouple_loss:0.0010749826906248927
Iteration: 813, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44699329137802124, gen p mean: -0.05829398334026337, mean p set: 0.44747358560562134
loss_pred:0.01649339869618416, decouple_loss:0.001222951803356409
The modified gen p mean: 0.44791150093078613, gen p mean: -0.051059167832136154, mean p set: 0.44839179515838623The modified gen p mean: 0.445488303899765, gen p mean: -0.05082794278860092, mean p set: 0.4459685981273651
loss_pred:0.016747966408729553, decouple_loss:0.00120768032502383
loss_pred:0.01669028028845787, decouple_loss:0.0011232602410018444
Iteration: 814, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44656896591186523, gen p mean: -0.045519229024648666, mean p set: 0.44704926013946533
loss_pred:0.017254838719964027, decouple_loss:0.0011355631286278367
The modified gen p mean: 0.4479556679725647, gen p mean: -0.04835441708564758, mean p set: 0.4484359920024872The modified gen p mean: 0.4469752311706543, gen p mean: -0.04656629264354706, mean p set: 0.4474555552005768
loss_pred:0.016321124508976936, decouple_loss:0.001006426988169551
loss_pred:0.01664423942565918, decouple_loss:0.0010086382972076535
Iteration: 815, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44695407152175903, gen p mean: -0.04333706945180893, mean p set: 0.44743436574935913
loss_pred:0.01624879240989685, decouple_loss:0.001377928419969976
The modified gen p mean: 0.44673311710357666, gen p mean: -0.04831365495920181, mean p set: 0.44721341133117676The modified gen p mean: 0.446698933839798, gen p mean: -0.04740488529205322, mean p set: 0.44717922806739807
loss_pred:0.01706724241375923, decouple_loss:0.0013708719052374363
loss_pred:0.016533026471734047, decouple_loss:0.0012484589824452996
Iteration: 816, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4459565579891205, gen p mean: -0.04764588549733162, mean p set: 0.4464368224143982
loss_pred:0.01685200072824955, decouple_loss:0.0012362950947135687
The modified gen p mean: 0.4461911916732788, gen p mean: -0.04619918763637543, mean p set: 0.4466714859008789The modified gen p mean: 0.4480953514575958, gen p mean: -0.045458681881427765, mean p set: 0.44857561588287354
loss_pred:0.016746677458286285, decouple_loss:0.0010354840196669102
loss_pred:0.016702163964509964, decouple_loss:0.001032208208926022
Iteration: 817, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44737508893013, gen p mean: -0.053366709500551224, mean p set: 0.4478553533554077
loss_pred:0.01707993820309639, decouple_loss:0.0013786208583042026
The modified gen p mean: 0.4467950761318207, gen p mean: -0.04829488322138786, mean p set: 0.44727540016174316The modified gen p mean: 0.4478701055049896, gen p mean: -0.04869237169623375, mean p set: 0.4483503997325897
loss_pred:0.0165572427213192, decouple_loss:0.0010674935765564442
loss_pred:0.01634456403553486, decouple_loss:0.0012048324570059776
Iteration: 818, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464389681816101, gen p mean: -0.045153647661209106, mean p set: 0.4469192922115326
loss_pred:0.01740754395723343, decouple_loss:0.0010007151868194342
The modified gen p mean: 0.4478500783443451, gen p mean: -0.0474749393761158, mean p set: 0.4483303725719452The modified gen p mean: 0.4478020966053009, gen p mean: -0.05377799645066261, mean p set: 0.4482823610305786
loss_pred:0.01675056479871273, decouple_loss:0.001024113968014717
loss_pred:0.01636708714067936, decouple_loss:0.0010580727830529213
Iteration: 819, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486715495586395, gen p mean: -0.04858435317873955, mean p set: 0.44915181398391724
loss_pred:0.01693561300635338, decouple_loss:0.0011631111847236753
The modified gen p mean: 0.44800689816474915, gen p mean: -0.046475768089294434, mean p set: 0.44848719239234924The modified gen p mean: 0.4469386339187622, gen p mean: -0.04485611990094185, mean p set: 0.4474189281463623
loss_pred:0.016687164083123207, decouple_loss:0.0011591720394790173
loss_pred:0.016863854601979256, decouple_loss:0.001115051214583218
Iteration: 820, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464642107486725, gen p mean: -0.05625180900096893, mean p set: 0.4469445049762726
loss_pred:0.016141541302204132, decouple_loss:0.0011462811380624771
The modified gen p mean: 0.44741541147232056, gen p mean: -0.05182153359055519, mean p set: 0.44789573550224304The modified gen p mean: 0.44781437516212463, gen p mean: -0.049208298325538635, mean p set: 0.44829463958740234
loss_pred:0.016430463641881943, decouple_loss:0.0012431793147698045
loss_pred:0.017142312601208687, decouple_loss:0.0013208031887188554
2023-05-02 05:47:43 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.05196132883429527, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.047781601548194885, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830237865448, gen p mean: -0.047918595373630524, mean p set: 0.4500633478164673
loss_pred:0.01838654652237892, decouple_loss:0.001106763374991715
loss_pred:0.017303315922617912, decouple_loss:0.001239656237885356
loss_pred:0.017418058589100838, decouple_loss:0.0011722065974026918
WV_0_PC_1_EH_0_PS_40, loss: 0.017761286348104477, avg_mse: 0.025521419942378998
current test mse: 0.025521
Iteration: 821, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471263885498047, gen p mean: -0.049201034009456635, mean p set: 0.4476066827774048
The modified gen p mean: 0.4456179440021515, gen p mean: -0.04887104034423828, mean p set: 0.446098268032074
The modified gen p mean: 0.4476120173931122, gen p mean: -0.053302668035030365, mean p set: 0.4480923116207123
loss_pred:0.016702186316251755, decouple_loss:0.0011087978491559625
loss_pred:0.01631580851972103, decouple_loss:0.0011003308463841677loss_pred:0.017189016565680504, decouple_loss:0.001383447553962469
Iteration: 822, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470158815383911, gen p mean: -0.0514342300593853, mean p set: 0.4474962055683136
loss_pred:0.0167799424380064, decouple_loss:0.0014888286823406816
The modified gen p mean: 0.44687533378601074, gen p mean: -0.047136690467596054, mean p set: 0.44735562801361084The modified gen p mean: 0.4479420483112335, gen p mean: -0.05129167065024376, mean p set: 0.44842231273651123
loss_pred:0.016890840604901314, decouple_loss:0.0011258019367232919
loss_pred:0.01628532074391842, decouple_loss:0.001377059263177216
Iteration: 823, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44664090871810913, gen p mean: -0.05234320089221001, mean p set: 0.44712120294570923
loss_pred:0.017243752256035805, decouple_loss:0.0010646641021594405
The modified gen p mean: 0.4469863176345825, gen p mean: -0.057624489068984985, mean p set: 0.44746658205986023The modified gen p mean: 0.4463730454444885, gen p mean: -0.055482253432273865, mean p set: 0.446853369474411
loss_pred:0.01713634841144085, decouple_loss:0.0013300300342962146
loss_pred:0.016467366367578506, decouple_loss:0.0012445931788533926
Iteration: 824, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4462970495223999, gen p mean: -0.045980051159858704, mean p set: 0.44677734375
loss_pred:0.01683490350842476, decouple_loss:0.0012620744528248906
The modified gen p mean: 0.4477015435695648, gen p mean: -0.053919464349746704, mean p set: 0.4481818377971649The modified gen p mean: 0.4484342336654663, gen p mean: -0.05182579159736633, mean p set: 0.448914498090744
loss_pred:0.01638904958963394, decouple_loss:0.0012700485531240702
loss_pred:0.016503293067216873, decouple_loss:0.001185867004096508
Iteration: 825, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464874863624573, gen p mean: -0.04645504802465439, mean p set: 0.4469677805900574
loss_pred:0.01726403832435608, decouple_loss:0.0010606258874759078
The modified gen p mean: 0.44726109504699707, gen p mean: -0.04777657985687256, mean p set: 0.44774138927459717The modified gen p mean: 0.44674113392829895, gen p mean: -0.052241332828998566, mean p set: 0.44722142815589905
loss_pred:0.017387162894010544, decouple_loss:0.0010970804141834378
loss_pred:0.017086252570152283, decouple_loss:0.001036653877235949
Iteration: 826, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44770678877830505, gen p mean: -0.053461089730262756, mean p set: 0.44818708300590515
loss_pred:0.016435464844107628, decouple_loss:0.0011105271987617016
The modified gen p mean: 0.4473097324371338, gen p mean: -0.051380936056375504, mean p set: 0.4477900266647339The modified gen p mean: 0.4464631974697113, gen p mean: -0.050987936556339264, mean p set: 0.4469434916973114
loss_pred:0.016736522316932678, decouple_loss:0.0010923839872702956
loss_pred:0.016657734289765358, decouple_loss:0.0009918055729940534
Iteration: 827, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44826653599739075, gen p mean: -0.05462906137108803, mean p set: 0.44874683022499084
loss_pred:0.016684100031852722, decouple_loss:0.0010584292467683554
The modified gen p mean: 0.4470379650592804, gen p mean: -0.05502067878842354, mean p set: 0.4475182592868805The modified gen p mean: 0.4460814893245697, gen p mean: -0.05575086921453476, mean p set: 0.4465617835521698
loss_pred:0.016442587599158287, decouple_loss:0.0012116313446313143
loss_pred:0.016108926385641098, decouple_loss:0.0011002511018887162
Iteration: 828, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477238059043884, gen p mean: -0.05124155804514885, mean p set: 0.4482041299343109
loss_pred:0.01635669358074665, decouple_loss:0.0010725189931690693
The modified gen p mean: 0.44760680198669434, gen p mean: -0.05226260796189308, mean p set: 0.4480871260166168The modified gen p mean: 0.4473837912082672, gen p mean: -0.051383715122938156, mean p set: 0.4478640854358673
loss_pred:0.016519220545887947, decouple_loss:0.0011293640127405524
loss_pred:0.01705285720527172, decouple_loss:0.0011851649032905698
Iteration: 829, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44642043113708496, gen p mean: -0.04735938459634781, mean p set: 0.44690072536468506
loss_pred:0.016566867008805275, decouple_loss:0.0010895526502281427
The modified gen p mean: 0.4460989236831665, gen p mean: -0.04482073336839676, mean p set: 0.4465792179107666The modified gen p mean: 0.4461131691932678, gen p mean: -0.04829816892743111, mean p set: 0.4465934634208679
loss_pred:0.01641886495053768, decouple_loss:0.0012187116080895066
loss_pred:0.01610671728849411, decouple_loss:0.0011799340136349201
Iteration: 830, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471037983894348, gen p mean: -0.046392772346735, mean p set: 0.4475840926170349
loss_pred:0.016049642115831375, decouple_loss:0.0009457163396291435
The modified gen p mean: 0.4472595155239105, gen p mean: -0.04752165079116821, mean p set: 0.4477398097515106The modified gen p mean: 0.4473395347595215, gen p mean: -0.04469427838921547, mean p set: 0.4478198289871216
loss_pred:0.017228135839104652, decouple_loss:0.0009824869921430945
loss_pred:0.016158632934093475, decouple_loss:0.0009919942822307348
2023-05-02 05:49:38 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.04809039458632469, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04382167384028435, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.044193435460329056, mean p set: 0.4500633478164673
loss_pred:0.018332280218601227, decouple_loss:0.0011593371164053679
loss_pred:0.01726573519408703, decouple_loss:0.0013593954499810934
loss_pred:0.017353074625134468, decouple_loss:0.00125626299995929
WV_0_PC_1_EH_0_PS_40, loss: 0.017713282257318497, avg_mse: 0.025422358885407448
current test mse: 0.025422
Iteration: 831, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44801342487335205, gen p mean: -0.04531971365213394, mean p set: 0.44849371910095215
The modified gen p mean: 0.4456440508365631, gen p mean: -0.04457303509116173, mean p set: 0.4461243748664856
The modified gen p mean: 0.44780197739601135, gen p mean: -0.044438909739255905, mean p set: 0.44828227162361145
loss_pred:0.01722734235227108, decouple_loss:0.001242992584593594
loss_pred:0.016610613092780113, decouple_loss:0.001078809262253344loss_pred:0.016492290422320366, decouple_loss:0.001350240665487945
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012019_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012019_3_24hr.npz
NaN value num: 0
Iteration: 832, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45200395584106445, gen p mean: -0.033793531358242035, mean p set: 0.45248425006866455
loss_pred:0.01770942099392414, decouple_loss:0.0013107388513162732
The modified gen p mean: 0.4528390169143677, gen p mean: -0.04037151485681534, mean p set: 0.45331934094429016The modified gen p mean: 0.45176437497138977, gen p mean: -0.03739776462316513, mean p set: 0.4522446393966675
loss_pred:0.017385410144925117, decouple_loss:0.0013686914462596178
loss_pred:0.017835181206464767, decouple_loss:0.0015117868315428495
Iteration: 833, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45230743288993835, gen p mean: -0.03924668952822685, mean p set: 0.45278772711753845
loss_pred:0.018226346001029015, decouple_loss:0.0011102509452030063
The modified gen p mean: 0.4539492428302765, gen p mean: -0.04114355891942978, mean p set: 0.454429566860199The modified gen p mean: 0.45178577303886414, gen p mean: -0.03314712271094322, mean p set: 0.4522660970687866
loss_pred:0.01703362539410591, decouple_loss:0.0012042380403727293
loss_pred:0.017736531794071198, decouple_loss:0.0011386669939383864
Iteration: 834, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45329633355140686, gen p mean: -0.03809769079089165, mean p set: 0.45377665758132935
loss_pred:0.01669096015393734, decouple_loss:0.001470476039685309
The modified gen p mean: 0.4531635642051697, gen p mean: -0.03649324178695679, mean p set: 0.4536438286304474The modified gen p mean: 0.4525024890899658, gen p mean: -0.03786103054881096, mean p set: 0.45298275351524353
loss_pred:0.017749173566699028, decouple_loss:0.0011966939782723784
loss_pred:0.017685575410723686, decouple_loss:0.0013597746146842837
Iteration: 835, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4524392783641815, gen p mean: -0.04253116250038147, mean p set: 0.4529195725917816
loss_pred:0.01724661886692047, decouple_loss:0.0012165553634986281
The modified gen p mean: 0.45474687218666077, gen p mean: -0.043438758701086044, mean p set: 0.45522719621658325The modified gen p mean: 0.45203307271003723, gen p mean: -0.03986556455492973, mean p set: 0.45251336693763733
loss_pred:0.01738164760172367, decouple_loss:0.0011879918165504932
loss_pred:0.018141256645321846, decouple_loss:0.0011721079936251044
Iteration: 836, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45353963971138, gen p mean: -0.043588828295469284, mean p set: 0.4540198743343353
loss_pred:0.01704670675098896, decouple_loss:0.0010078344494104385
The modified gen p mean: 0.4530549943447113, gen p mean: -0.04771053418517113, mean p set: 0.4535352885723114The modified gen p mean: 0.4526750147342682, gen p mean: -0.04684406891465187, mean p set: 0.4531553387641907
loss_pred:0.017070354893803596, decouple_loss:0.001196875236928463
loss_pred:0.016924355179071426, decouple_loss:0.0010427078232169151
Iteration: 837, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45303648710250854, gen p mean: -0.0437828004360199, mean p set: 0.45351678133010864
loss_pred:0.0169890895485878, decouple_loss:0.0013208446325734258
The modified gen p mean: 0.45128047466278076, gen p mean: -0.04554266110062599, mean p set: 0.45176076889038086The modified gen p mean: 0.45155638456344604, gen p mean: -0.043867312371730804, mean p set: 0.45203670859336853
loss_pred:0.017691539600491524, decouple_loss:0.0013526345137506723
loss_pred:0.01580745540559292, decouple_loss:0.0011987248435616493
Iteration: 838, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4538276195526123, gen p mean: -0.0454845167696476, mean p set: 0.4543079137802124
loss_pred:0.017080798745155334, decouple_loss:0.0012614064617082477
The modified gen p mean: 0.4527387320995331, gen p mean: -0.04762481525540352, mean p set: 0.4532190263271332The modified gen p mean: 0.4519207775592804, gen p mean: -0.046554189175367355, mean p set: 0.4524010717868805
loss_pred:0.016756003722548485, decouple_loss:0.0013536653714254498
loss_pred:0.01757311448454857, decouple_loss:0.0012561958283185959
Iteration: 839, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45458200573921204, gen p mean: -0.04749688878655434, mean p set: 0.45506227016448975
loss_pred:0.017128009349107742, decouple_loss:0.0010545548284426332
The modified gen p mean: 0.45190316438674927, gen p mean: -0.04630637168884277, mean p set: 0.452383428812027The modified gen p mean: 0.453336626291275, gen p mean: -0.04641975089907646, mean p set: 0.4538169205188751
loss_pred:0.01750115305185318, decouple_loss:0.0011506980517879128
loss_pred:0.01624799333512783, decouple_loss:0.0011152211809530854
Iteration: 840, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4532589316368103, gen p mean: -0.05049549788236618, mean p set: 0.4537392258644104
loss_pred:0.017240265384316444, decouple_loss:0.001405313378199935
The modified gen p mean: 0.45258259773254395, gen p mean: -0.05117229372262955, mean p set: 0.45306292176246643The modified gen p mean: 0.45436638593673706, gen p mean: -0.05356927588582039, mean p set: 0.45484670996665955
loss_pred:0.0174716804176569, decouple_loss:0.0014820363139733672
loss_pred:0.016905028373003006, decouple_loss:0.0012124828062951565
2023-05-02 05:52:10 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.062207818031311035, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.05801507085561752, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.05845359340310097, mean p set: 0.4500633478164673
loss_pred:0.018423330038785934, decouple_loss:0.0018964660121127963
loss_pred:0.017258502542972565, decouple_loss:0.0015419499250128865
loss_pred:0.017411435022950172, decouple_loss:0.0016774549148976803
WV_0_PC_1_EH_0_PS_40, loss: 0.017783019691705704, avg_mse: 0.025479473173618317
current test mse: 0.025479
Iteration: 841, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45258578658103943, gen p mean: -0.05361015722155571, mean p set: 0.4530661106109619
The modified gen p mean: 0.4527120292186737, gen p mean: -0.05381414666771889, mean p set: 0.4531923532485962
The modified gen p mean: 0.45108649134635925, gen p mean: -0.05152192339301109, mean p set: 0.45156678557395935
loss_pred:0.01774364523589611, decouple_loss:0.0014964379370212555
loss_pred:0.016496801748871803, decouple_loss:0.00160785426851362
loss_pred:0.01679300330579281, decouple_loss:0.0016048451652750373
Iteration: 842, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45173004269599915, gen p mean: -0.048071637749671936, mean p set: 0.45221033692359924
loss_pred:0.016459405422210693, decouple_loss:0.001170964096672833
The modified gen p mean: 0.4518159031867981, gen p mean: -0.05183848738670349, mean p set: 0.4522961974143982
The modified gen p mean: 0.4515621066093445, gen p mean: -0.04456322267651558, mean p set: 0.4520424008369446
loss_pred:0.017740348353981972, decouple_loss:0.0012515400303527713
loss_pred:0.017525935545563698, decouple_loss:0.0011180284200236201
Iteration: 843, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503503441810608, gen p mean: -0.04482756555080414, mean p set: 0.4508306682109833
loss_pred:0.017491083592176437, decouple_loss:0.0012209875276312232
The modified gen p mean: 0.4526388347148895, gen p mean: -0.04872557893395424, mean p set: 0.453119158744812The modified gen p mean: 0.4518929421901703, gen p mean: -0.047908931970596313, mean p set: 0.4523732364177704
loss_pred:0.017683980986475945, decouple_loss:0.0012889563804492354
loss_pred:0.017599398270249367, decouple_loss:0.00126864283811301
Iteration: 844, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45171183347702026, gen p mean: -0.045854631811380386, mean p set: 0.45219212770462036
loss_pred:0.016593577340245247, decouple_loss:0.001150621916167438
The modified gen p mean: 0.45193517208099365, gen p mean: -0.04111311957240105, mean p set: 0.4524155259132385The modified gen p mean: 0.45184892416000366, gen p mean: -0.041731782257556915, mean p set: 0.45232921838760376
loss_pred:0.016627848148345947, decouple_loss:0.0011615505209192634
loss_pred:0.01697240024805069, decouple_loss:0.0011880678357556462
Iteration: 845, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45369771122932434, gen p mean: -0.042996086180210114, mean p set: 0.45417800545692444
loss_pred:0.01698451302945614, decouple_loss:0.0011278413003310561
The modified gen p mean: 0.45357224345207214, gen p mean: -0.04566674306988716, mean p set: 0.45405256748199463The modified gen p mean: 0.45094922184944153, gen p mean: -0.04110237956047058, mean p set: 0.4514295160770416
loss_pred:0.01696113869547844, decouple_loss:0.0011495626531541348
loss_pred:0.017255360260605812, decouple_loss:0.00106704980134964
Iteration: 846, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45314475893974304, gen p mean: -0.042945049703121185, mean p set: 0.45362505316734314
loss_pred:0.017744556069374084, decouple_loss:0.001259004813618958
The modified gen p mean: 0.4536791443824768, gen p mean: -0.04310653358697891, mean p set: 0.4541594386100769The modified gen p mean: 0.4533623158931732, gen p mean: -0.042701356112957, mean p set: 0.4538425803184509
loss_pred:0.017505640164017677, decouple_loss:0.001327852951362729
loss_pred:0.017211290076375008, decouple_loss:0.0012954284902662039
Iteration: 847, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4525487422943115, gen p mean: -0.04872699826955795, mean p set: 0.4530290365219116
loss_pred:0.01657026633620262, decouple_loss:0.0010695073287934065
The modified gen p mean: 0.45224201679229736, gen p mean: -0.04159063845872879, mean p set: 0.45272231101989746The modified gen p mean: 0.45225900411605835, gen p mean: -0.04880513250827789, mean p set: 0.45273926854133606
loss_pred:0.016696559265255928, decouple_loss:0.001063748262822628
loss_pred:0.016644202172756195, decouple_loss:0.001221020007506013
Iteration: 848, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4519190490245819, gen p mean: -0.045028287917375565, mean p set: 0.452399343252182
loss_pred:0.016994860023260117, decouple_loss:0.001329206395894289
The modified gen p mean: 0.4529039263725281, gen p mean: -0.04769362136721611, mean p set: 0.4533842206001282The modified gen p mean: 0.45166417956352234, gen p mean: -0.04920825734734535, mean p set: 0.45214447379112244
loss_pred:0.01778317056596279, decouple_loss:0.0014103438006713986
loss_pred:0.01713387295603752, decouple_loss:0.001151163363829255
Iteration: 849, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45110735297203064, gen p mean: -0.04407508298754692, mean p set: 0.45158764719963074
loss_pred:0.017177283763885498, decouple_loss:0.001069277641363442
The modified gen p mean: 0.4545176923274994, gen p mean: -0.0527944453060627, mean p set: 0.4549979567527771The modified gen p mean: 0.45232123136520386, gen p mean: -0.04443403705954552, mean p set: 0.45280152559280396
loss_pred:0.017231639474630356, decouple_loss:0.0010386561043560505
loss_pred:0.01721317693591118, decouple_loss:0.001212944625876844
Iteration: 850, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4543944001197815, gen p mean: -0.04861028864979744, mean p set: 0.4548746943473816
loss_pred:0.01698857918381691, decouple_loss:0.000983797013759613
The modified gen p mean: 0.45160800218582153, gen p mean: -0.0502149797976017, mean p set: 0.45208826661109924The modified gen p mean: 0.4523218870162964, gen p mean: -0.046747561544179916, mean p set: 0.4528021812438965
loss_pred:0.01619584485888481, decouple_loss:0.001111428951844573
loss_pred:0.017530592158436775, decouple_loss:0.0010471424320712686
2023-05-02 05:54:07 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.05921836942434311, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.05553059279918671, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.05541902408003807, mean p set: 0.4500633478164673
loss_pred:0.018394354730844498, decouple_loss:0.0014081691624596715
loss_pred:0.01735934428870678, decouple_loss:0.0012937969295307994
loss_pred:0.017505619674921036, decouple_loss:0.0012738625518977642
WV_0_PC_1_EH_0_PS_40, loss: 0.017819371074438095, avg_mse: 0.025591760873794556
current test mse: 0.025592
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012020_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012020_3_24hr.npz
NaN value num: 0
Iteration: 851, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45031100511550903, gen p mean: -0.04898528754711151, mean p set: 0.45079126954078674
loss_pred:0.017159827053546906, decouple_loss:0.0013400601455941796
The modified gen p mean: 0.4521675705909729, gen p mean: -0.048229001462459564, mean p set: 0.452647864818573The modified gen p mean: 0.4521905481815338, gen p mean: -0.045667316764593124, mean p set: 0.4526708722114563
loss_pred:0.016270114108920097, decouple_loss:0.0015011413488537073
loss_pred:0.0165543332695961, decouple_loss:0.0011467484291642904
Iteration: 852, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4520556330680847, gen p mean: -0.04866471514105797, mean p set: 0.4525359272956848
loss_pred:0.016696782782673836, decouple_loss:0.0011134885717183352
The modified gen p mean: 0.45069485902786255, gen p mean: -0.048736367374658585, mean p set: 0.45117518305778503The modified gen p mean: 0.45024070143699646, gen p mean: -0.04976018890738487, mean p set: 0.45072096586227417
loss_pred:0.017672786489129066, decouple_loss:0.0011279607424512506
loss_pred:0.016498038545250893, decouple_loss:0.001096132444217801
Iteration: 853, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503253102302551, gen p mean: -0.04842080920934677, mean p set: 0.4508056044578552
loss_pred:0.017310095950961113, decouple_loss:0.0010903929360210896
The modified gen p mean: 0.452411949634552, gen p mean: -0.049324993044137955, mean p set: 0.4528922438621521The modified gen p mean: 0.4494536221027374, gen p mean: -0.048438843339681625, mean p set: 0.4499339163303375
loss_pred:0.016509145498275757, decouple_loss:0.0012084959307685494
loss_pred:0.017515908926725388, decouple_loss:0.0012184529332444072
Iteration: 854, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45025834441185, gen p mean: -0.04905959591269493, mean p set: 0.4507386088371277
loss_pred:0.01705044135451317, decouple_loss:0.0010875213192775846
The modified gen p mean: 0.45059725642204285, gen p mean: -0.0475621297955513, mean p set: 0.45107758045196533The modified gen p mean: 0.4508916735649109, gen p mean: -0.04708436131477356, mean p set: 0.4513719379901886
loss_pred:0.016962409019470215, decouple_loss:0.001078551053069532
loss_pred:0.016868891194462776, decouple_loss:0.0011222421890124679
Iteration: 855, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4517481029033661, gen p mean: -0.04635630175471306, mean p set: 0.4522283971309662
loss_pred:0.016524890437722206, decouple_loss:0.001359401154331863
The modified gen p mean: 0.4534585177898407, gen p mean: -0.046321503818035126, mean p set: 0.4539388418197632The modified gen p mean: 0.45040634274482727, gen p mean: -0.05115281045436859, mean p set: 0.450886607170105
loss_pred:0.016693314537405968, decouple_loss:0.0013344442704692483
loss_pred:0.01764766313135624, decouple_loss:0.001281344797462225
Iteration: 856, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4516531229019165, gen p mean: -0.046334296464920044, mean p set: 0.4521334171295166
loss_pred:0.016991565003991127, decouple_loss:0.0011478443630039692
The modified gen p mean: 0.45178914070129395, gen p mean: -0.04715193063020706, mean p set: 0.45226943492889404The modified gen p mean: 0.44965657591819763, gen p mean: -0.05264335498213768, mean p set: 0.45013684034347534
loss_pred:0.01700316183269024, decouple_loss:0.0011139912530779839
loss_pred:0.01760290376842022, decouple_loss:0.00109934713691473
Iteration: 857, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4521346390247345, gen p mean: -0.04853223264217377, mean p set: 0.452614963054657
The modified gen p mean: 0.4522361159324646, gen p mean: -0.05331345647573471, mean p set: 0.4527163803577423
loss_pred:0.016725264489650726, decouple_loss:0.0012259652139618993
loss_pred:0.017028046771883965, decouple_loss:0.0015017035184428096The modified gen p mean: 0.4495322108268738, gen p mean: -0.04978753998875618, mean p set: 0.4500125050544739
loss_pred:0.017656555399298668, decouple_loss:0.0012599187903106213
Iteration: 858, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45130977034568787, gen p mean: -0.04792283475399017, mean p set: 0.4517900347709656
loss_pred:0.016620729118585587, decouple_loss:0.0011528721079230309
The modified gen p mean: 0.4532828629016876, gen p mean: -0.051917169243097305, mean p set: 0.45376312732696533The modified gen p mean: 0.4515621066093445, gen p mean: -0.04782939702272415, mean p set: 0.4520423710346222
loss_pred:0.0163206048309803, decouple_loss:0.0011137307155877352
loss_pred:0.01626409962773323, decouple_loss:0.0009934487752616405
Iteration: 859, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508422911167145, gen p mean: -0.05115492269396782, mean p set: 0.4513225853443146
loss_pred:0.01660190150141716, decouple_loss:0.0011776635656133294
The modified gen p mean: 0.45201101899147034, gen p mean: -0.05841536447405815, mean p set: 0.4524913430213928The modified gen p mean: 0.4529750347137451, gen p mean: -0.0529695563018322, mean p set: 0.4534553289413452
loss_pred:0.01699700765311718, decouple_loss:0.0011398117057979107
loss_pred:0.016572821885347366, decouple_loss:0.0012012635124847293
Iteration: 860, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450623482465744, gen p mean: -0.0512673519551754, mean p set: 0.4511038064956665
loss_pred:0.016519401222467422, decouple_loss:0.0011208700016140938
The modified gen p mean: 0.4500981867313385, gen p mean: -0.05303535982966423, mean p set: 0.4505784809589386The modified gen p mean: 0.45066696405410767, gen p mean: -0.04993536323308945, mean p set: 0.45114725828170776
loss_pred:0.01695757359266281, decouple_loss:0.0011475523933768272
loss_pred:0.016925841569900513, decouple_loss:0.0010248173493891954
2023-05-02 05:56:41 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.06270004063844681, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.05815745145082474, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.0583992637693882, mean p set: 0.4500633478164673
loss_pred:0.018221694976091385, decouple_loss:0.0015710688894614577
loss_pred:0.017222249880433083, decouple_loss:0.0014605666510760784
loss_pred:0.017346007749438286, decouple_loss:0.0014895672211423516
WV_0_PC_1_EH_0_PS_40, loss: 0.01767200604081154, avg_mse: 0.02528877556324005
current test mse: 0.025289
Iteration: 861, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505334794521332, gen p mean: -0.05119868367910385, mean p set: 0.45101380348205566
The modified gen p mean: 0.45202091336250305, gen p mean: -0.05356631800532341, mean p set: 0.45250123739242554
The modified gen p mean: 0.45361801981925964, gen p mean: -0.05503096804022789, mean p set: 0.45409834384918213
loss_pred:0.01631353050470352, decouple_loss:0.0014878135407343507
loss_pred:0.016674773767590523, decouple_loss:0.0012674350291490555
loss_pred:0.01656745746731758, decouple_loss:0.0014852873282507062
Iteration: 862, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45291367173194885, gen p mean: -0.05339820310473442, mean p set: 0.45339396595954895The modified gen p mean: 0.45033156871795654, gen p mean: -0.05904613435268402, mean p set: 0.45081186294555664
loss_pred:0.017039593309164047, decouple_loss:0.001213190727867186loss_pred:0.017203565686941147, decouple_loss:0.0011745187221094966
The modified gen p mean: 0.4506854712963104, gen p mean: -0.05401066690683365, mean p set: 0.45116573572158813
loss_pred:0.016876019537448883, decouple_loss:0.0010361199965700507
Iteration: 863, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45275965332984924, gen p mean: -0.056533340364694595, mean p set: 0.45323994755744934
The modified gen p mean: 0.45337003469467163, gen p mean: -0.05328699201345444, mean p set: 0.4538503587245941
loss_pred:0.017072971910238266, decouple_loss:0.0013045715168118477
loss_pred:0.015729833394289017, decouple_loss:0.0012521594762802124
The modified gen p mean: 0.4520135819911957, gen p mean: -0.04978218674659729, mean p set: 0.4524938464164734
loss_pred:0.016766196116805077, decouple_loss:0.0011942485580220819
Iteration: 864, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45199593901634216, gen p mean: -0.05555212125182152, mean p set: 0.45247623324394226
The modified gen p mean: 0.4517291784286499, gen p mean: -0.05580999329686165, mean p set: 0.4522095024585724
loss_pred:0.017295293509960175, decouple_loss:0.0010999691439792514
loss_pred:0.01729675568640232, decouple_loss:0.0010616416111588478
The modified gen p mean: 0.4503832757472992, gen p mean: -0.060428403317928314, mean p set: 0.4508635997772217
loss_pred:0.01699322648346424, decouple_loss:0.0010376181453466415
Iteration: 865, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4518354833126068, gen p mean: -0.053992416709661484, mean p set: 0.4523157775402069
The modified gen p mean: 0.4520168602466583, gen p mean: -0.052831459790468216, mean p set: 0.45249712467193604
loss_pred:0.01705019176006317, decouple_loss:0.0011120509589090943
loss_pred:0.01670067198574543, decouple_loss:0.0010232198983430862
The modified gen p mean: 0.45126330852508545, gen p mean: -0.055758532136678696, mean p set: 0.45174357295036316
loss_pred:0.017180342227220535, decouple_loss:0.0011095362715423107
Iteration: 866, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491192400455475, gen p mean: -0.056548405438661575, mean p set: 0.4495995044708252
loss_pred:0.01713329181075096, decouple_loss:0.0012079665903002024
The modified gen p mean: 0.45062869787216187, gen p mean: -0.05498150736093521, mean p set: 0.45110899209976196The modified gen p mean: 0.4523312449455261, gen p mean: -0.055818136781454086, mean p set: 0.4528115391731262
loss_pred:0.017405586317181587, decouple_loss:0.001103327376767993
loss_pred:0.017205586656928062, decouple_loss:0.001166938804090023
Iteration: 867, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44940948486328125, gen p mean: -0.05754809454083443, mean p set: 0.44988977909088135
The modified gen p mean: 0.4513704478740692, gen p mean: -0.05051885545253754, mean p set: 0.4518507122993469loss_pred:0.017413483932614326, decouple_loss:0.0011255458230152726
The modified gen p mean: 0.45081716775894165, gen p mean: -0.04958154633641243, mean p set: 0.45129746198654175
loss_pred:0.017526794224977493, decouple_loss:0.001049408339895308
loss_pred:0.01773867756128311, decouple_loss:0.001059067202731967
Iteration: 868, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44847601652145386, gen p mean: -0.05639323964715004, mean p set: 0.44895628094673157
loss_pred:0.01731385849416256, decouple_loss:0.00125462980940938
The modified gen p mean: 0.45292168855667114, gen p mean: -0.051154814660549164, mean p set: 0.45340198278427124The modified gen p mean: 0.45171672105789185, gen p mean: -0.05252590402960777, mean p set: 0.45219701528549194
loss_pred:0.016266383230686188, decouple_loss:0.001227087457664311
loss_pred:0.016497906297445297, decouple_loss:0.0012185784289613366
Iteration: 869, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4535071551799774, gen p mean: -0.05286131426692009, mean p set: 0.4539874494075775
loss_pred:0.01607975922524929, decouple_loss:0.0010825400240719318
The modified gen p mean: 0.45002231001853943, gen p mean: -0.04909497871994972, mean p set: 0.4505026042461395The modified gen p mean: 0.45054683089256287, gen p mean: -0.047431617975234985, mean p set: 0.45102712512016296
loss_pred:0.017436707392334938, decouple_loss:0.0012416738318279386
loss_pred:0.01735747419297695, decouple_loss:0.0010409443639218807
Iteration: 870, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4527318775653839, gen p mean: -0.046905651688575745, mean p set: 0.453212171792984
loss_pred:0.016739847138524055, decouple_loss:0.0012574776774272323
The modified gen p mean: 0.4515724778175354, gen p mean: -0.05094999447464943, mean p set: 0.4520528018474579The modified gen p mean: 0.45327553153038025, gen p mean: -0.0509633831679821, mean p set: 0.45375579595565796
loss_pred:0.016696080565452576, decouple_loss:0.0011037583462893963
loss_pred:0.016247548162937164, decouple_loss:0.0012224011588841677
2023-05-02 05:58:37 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.05678293853998184, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.05262839049100876, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.05243450403213501, mean p set: 0.4500633478164673
loss_pred:0.018267285078763962, decouple_loss:0.0013361468445509672
loss_pred:0.017234576866030693, decouple_loss:0.0013229264877736568
loss_pred:0.01733177714049816, decouple_loss:0.001266215112991631
WV_0_PC_1_EH_0_PS_40, loss: 0.017676634714007378, avg_mse: 0.02531026490032673
current test mse: 0.02531
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012002_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012002_3_24hr.npz
NaN value num: 0
Iteration: 871, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450796902179718, gen p mean: -0.04946276172995567, mean p set: 0.4512771964073181
loss_pred:0.01645612344145775, decouple_loss:0.001222890568897128
The modified gen p mean: 0.4491126239299774, gen p mean: -0.04317466542124748, mean p set: 0.4495929181575775The modified gen p mean: 0.44913122057914734, gen p mean: -0.049860190600156784, mean p set: 0.44961148500442505
loss_pred:0.016234418377280235, decouple_loss:0.0011261082254350185
loss_pred:0.016049755737185478, decouple_loss:0.000993301160633564
Iteration: 872, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44972312450408936, gen p mean: -0.05279591679573059, mean p set: 0.45020341873168945
loss_pred:0.01643911935389042, decouple_loss:0.0011566446628421545
The modified gen p mean: 0.4495282769203186, gen p mean: -0.0488959401845932, mean p set: 0.4500085711479187The modified gen p mean: 0.450626939535141, gen p mean: -0.05089763551950455, mean p set: 0.4511072635650635
loss_pred:0.01646292954683304, decouple_loss:0.0011278786696493626
loss_pred:0.016690954566001892, decouple_loss:0.0011138422414660454
Iteration: 873, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44909465312957764, gen p mean: -0.05125843733549118, mean p set: 0.44957494735717773
loss_pred:0.0150594562292099, decouple_loss:0.0011080456897616386
The modified gen p mean: 0.4496802091598511, gen p mean: -0.06193360313773155, mean p set: 0.4501604735851288The modified gen p mean: 0.450175404548645, gen p mean: -0.05727686733007431, mean p set: 0.45065566897392273
loss_pred:0.016143212094902992, decouple_loss:0.0010416627628728747
loss_pred:0.015425161458551884, decouple_loss:0.001206695567816496
Iteration: 874, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45152056217193604, gen p mean: -0.057278137654066086, mean p set: 0.45200085639953613
loss_pred:0.016027014702558517, decouple_loss:0.0010596164502203465
The modified gen p mean: 0.4511414170265198, gen p mean: -0.055588360875844955, mean p set: 0.4516216814517975The modified gen p mean: 0.4518599212169647, gen p mean: -0.05400760471820831, mean p set: 0.4523402154445648
loss_pred:0.016759470105171204, decouple_loss:0.0011217958526685834
loss_pred:0.01724759116768837, decouple_loss:0.001119042164646089
Iteration: 875, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489581882953644, gen p mean: -0.05736808478832245, mean p set: 0.4494384825229645
loss_pred:0.015303919091820717, decouple_loss:0.0011989809572696686
The modified gen p mean: 0.44900307059288025, gen p mean: -0.055436644703149796, mean p set: 0.44948339462280273The modified gen p mean: 0.4491424560546875, gen p mean: -0.0629151239991188, mean p set: 0.4496227502822876
loss_pred:0.015790235251188278, decouple_loss:0.0011573658557608724
loss_pred:0.015222791582345963, decouple_loss:0.0010145525448024273
Iteration: 876, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498962461948395, gen p mean: -0.05849744379520416, mean p set: 0.4503765404224396
loss_pred:0.01636253297328949, decouple_loss:0.001213024603202939
The modified gen p mean: 0.45158398151397705, gen p mean: -0.061477839946746826, mean p set: 0.45206427574157715The modified gen p mean: 0.45032089948654175, gen p mean: -0.06082174926996231, mean p set: 0.45080122351646423
loss_pred:0.016134850680828094, decouple_loss:0.0011992737418040633
loss_pred:0.016351807862520218, decouple_loss:0.0012742489343509078
Iteration: 877, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492533504962921, gen p mean: -0.053961385041475296, mean p set: 0.4497336745262146
The modified gen p mean: 0.45019733905792236, gen p mean: -0.05962216854095459, mean p set: 0.45067763328552246
loss_pred:0.016033688560128212, decouple_loss:0.001033926964737475
loss_pred:0.016080832108855247, decouple_loss:0.001021497417241335
The modified gen p mean: 0.4504595994949341, gen p mean: -0.05939938873052597, mean p set: 0.45093992352485657
loss_pred:0.016735127195715904, decouple_loss:0.0010872824350371957
Iteration: 878, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44943132996559143, gen p mean: -0.055555976927280426, mean p set: 0.44991159439086914
loss_pred:0.015423605218529701, decouple_loss:0.001162686850875616
The modified gen p mean: 0.4525979459285736, gen p mean: -0.059652503579854965, mean p set: 0.4530782699584961The modified gen p mean: 0.4495278596878052, gen p mean: -0.05457359924912453, mean p set: 0.4500081539154053
loss_pred:0.01633259654045105, decouple_loss:0.0011941648554056883
loss_pred:0.016278833150863647, decouple_loss:0.0010879754554480314
Iteration: 879, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45159292221069336, gen p mean: -0.0485663004219532, mean p set: 0.45207321643829346
loss_pred:0.016610434278845787, decouple_loss:0.0011059221578761935
The modified gen p mean: 0.44964835047721863, gen p mean: -0.06096174195408821, mean p set: 0.4501286447048187The modified gen p mean: 0.44988107681274414, gen p mean: -0.05402321368455887, mean p set: 0.4503614008426666
loss_pred:0.014843585900962353, decouple_loss:0.001077272929251194
loss_pred:0.016327690333127975, decouple_loss:0.0011118409456685185
Iteration: 880, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497954249382019, gen p mean: -0.05781541392207146, mean p set: 0.450275719165802
loss_pred:0.014538967981934547, decouple_loss:0.0010212018387392163
The modified gen p mean: 0.45003461837768555, gen p mean: -0.05227858945727348, mean p set: 0.45051491260528564The modified gen p mean: 0.45127204060554504, gen p mean: -0.05507735162973404, mean p set: 0.45175236463546753
loss_pred:0.015483919531106949, decouple_loss:0.0010836889268830419
loss_pred:0.016592102125287056, decouple_loss:0.0012548858067020774
2023-05-02 06:01:19 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.06093438342213631, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.05674481391906738, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.05665597692131996, mean p set: 0.4500633478164673
loss_pred:0.018376197665929794, decouple_loss:0.0013297339901328087
loss_pred:0.01730247586965561, decouple_loss:0.00127125543076545
loss_pred:0.017451396211981773, decouple_loss:0.0011878445511683822
WV_0_PC_1_EH_0_PS_40, loss: 0.01777317188680172, avg_mse: 0.025524768978357315
current test mse: 0.025525
Iteration: 881, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45185157656669617, gen p mean: -0.05255061760544777, mean p set: 0.45233187079429626
The modified gen p mean: 0.44934189319610596, gen p mean: -0.046970121562480927, mean p set: 0.44982221722602844
The modified gen p mean: 0.44902923703193665, gen p mean: -0.04701947420835495, mean p set: 0.44950950145721436
loss_pred:0.016290821135044098, decouple_loss:0.0010814856505021453
loss_pred:0.016421420499682426, decouple_loss:0.0011437759967520833
loss_pred:0.016354527324438095, decouple_loss:0.0011131890350952744
Iteration: 882, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45126524567604065, gen p mean: -0.05376669391989708, mean p set: 0.45174553990364075
loss_pred:0.01627253368496895, decouple_loss:0.0013948377454653382
The modified gen p mean: 0.44909989833831787, gen p mean: -0.05421189218759537, mean p set: 0.44958019256591797The modified gen p mean: 0.45121848583221436, gen p mean: -0.04985232278704643, mean p set: 0.45169880986213684
loss_pred:0.01526271179318428, decouple_loss:0.0013723875163123012
loss_pred:0.015991682186722755, decouple_loss:0.001339381211437285
Iteration: 883, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44907745718955994, gen p mean: -0.054615605622529984, mean p set: 0.4495577812194824
loss_pred:0.016083380207419395, decouple_loss:0.001297211041674018
The modified gen p mean: 0.44946157932281494, gen p mean: -0.052921272814273834, mean p set: 0.44994187355041504The modified gen p mean: 0.4493807256221771, gen p mean: -0.0509583055973053, mean p set: 0.4498610198497772
loss_pred:0.015598801895976067, decouple_loss:0.001267395680770278
loss_pred:0.01629391685128212, decouple_loss:0.00117166165728122
Iteration: 884, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497600793838501, gen p mean: -0.04673697426915169, mean p set: 0.4502403438091278
loss_pred:0.015348341315984726, decouple_loss:0.0012311374302953482
The modified gen p mean: 0.44958749413490295, gen p mean: -0.042546190321445465, mean p set: 0.45006775856018066The modified gen p mean: 0.4497816562652588, gen p mean: -0.048794522881507874, mean p set: 0.4502619802951813
loss_pred:0.015520201064646244, decouple_loss:0.0014397070044651628
loss_pred:0.01611587218940258, decouple_loss:0.0012219909112900496
Iteration: 885, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498801827430725, gen p mean: -0.04848853871226311, mean p set: 0.4503604471683502
loss_pred:0.015047586522996426, decouple_loss:0.0013185495045036077
The modified gen p mean: 0.449188768863678, gen p mean: -0.04749053344130516, mean p set: 0.4496690630912781The modified gen p mean: 0.44922783970832825, gen p mean: -0.04516436159610748, mean p set: 0.44970813393592834
loss_pred:0.015266085974872112, decouple_loss:0.0011732698185369372
loss_pred:0.01581527851521969, decouple_loss:0.0013446708908304572
Iteration: 886, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504971206188202, gen p mean: -0.03910215571522713, mean p set: 0.4509774148464203
loss_pred:0.016295677050948143, decouple_loss:0.0012128065573051572
The modified gen p mean: 0.4511968195438385, gen p mean: -0.04457176849246025, mean p set: 0.451677143573761The modified gen p mean: 0.4493029713630676, gen p mean: -0.04418492317199707, mean p set: 0.4497832953929901
loss_pred:0.016141921281814575, decouple_loss:0.001158609869889915
loss_pred:0.01618725247681141, decouple_loss:0.0012956107966601849
Iteration: 887, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511229395866394, gen p mean: -0.03874054551124573, mean p set: 0.4516032636165619
loss_pred:0.015644701197743416, decouple_loss:0.0014347085962072015
The modified gen p mean: 0.4500953257083893, gen p mean: -0.039019763469696045, mean p set: 0.4505756199359894The modified gen p mean: 0.4499051570892334, gen p mean: -0.03742372244596481, mean p set: 0.4503854513168335
loss_pred:0.01659386418759823, decouple_loss:0.00114225666038692
loss_pred:0.015034887008368969, decouple_loss:0.001178318285383284
Iteration: 888, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45217129588127136, gen p mean: -0.04558780789375305, mean p set: 0.45265159010887146
loss_pred:0.015731997787952423, decouple_loss:0.0012959406012669206
The modified gen p mean: 0.4493320882320404, gen p mean: -0.049598779529333115, mean p set: 0.4498123526573181The modified gen p mean: 0.44948163628578186, gen p mean: -0.03912423923611641, mean p set: 0.44996196031570435
loss_pred:0.016271328553557396, decouple_loss:0.0011803969973698258
loss_pred:0.016063595190644264, decouple_loss:0.0013101595686748624
Iteration: 889, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45023706555366516, gen p mean: -0.04760124161839485, mean p set: 0.45071735978126526
loss_pred:0.01518084853887558, decouple_loss:0.001275163609534502
The modified gen p mean: 0.4514003098011017, gen p mean: -0.0423244945704937, mean p set: 0.4518806040287018The modified gen p mean: 0.45139554142951965, gen p mean: -0.051041752099990845, mean p set: 0.45187583565711975
loss_pred:0.016076255589723587, decouple_loss:0.0012622460490092635
loss_pred:0.016212912276387215, decouple_loss:0.001202003681100905
Iteration: 890, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499098062515259, gen p mean: -0.04946993663907051, mean p set: 0.45039013028144836
loss_pred:0.01600172556936741, decouple_loss:0.0012407557806000113
The modified gen p mean: 0.44972220063209534, gen p mean: -0.05360250174999237, mean p set: 0.45020246505737305The modified gen p mean: 0.44930359721183777, gen p mean: -0.04844970628619194, mean p set: 0.44978389143943787
loss_pred:0.016069620847702026, decouple_loss:0.001116963685490191
loss_pred:0.015028013847768307, decouple_loss:0.0010926047107204795
2023-05-02 06:03:14 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.05809084698557854, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.05400945991277695, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.05407920479774475, mean p set: 0.4500633478164673
loss_pred:0.01839652843773365, decouple_loss:0.0013600729871541262
loss_pred:0.01729166880249977, decouple_loss:0.0012769525637850165
loss_pred:0.017444992437958717, decouple_loss:0.001261750585399568
WV_0_PC_1_EH_0_PS_40, loss: 0.017776042222976685, avg_mse: 0.02552148886024952
current test mse: 0.025521
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012005_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012005_3_24hr.npz
NaN value num: 0
Iteration: 891, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44955798983573914, gen p mean: -0.05890016630291939, mean p set: 0.45003825426101685
loss_pred:0.01458769291639328, decouple_loss:0.001325748162344098
The modified gen p mean: 0.448984295129776, gen p mean: -0.05630112439393997, mean p set: 0.4494645595550537The modified gen p mean: 0.44862890243530273, gen p mean: -0.056222960352897644, mean p set: 0.44910916686058044
loss_pred:0.014631596393883228, decouple_loss:0.0012032717932015657loss_pred:0.014665602706372738, decouple_loss:0.0012605433585122228
Iteration: 892, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44758477807044983, gen p mean: -0.04883432388305664, mean p set: 0.4480650722980499
loss_pred:0.014285631477832794, decouple_loss:0.0011582428123801947
The modified gen p mean: 0.4487270712852478, gen p mean: -0.050946325063705444, mean p set: 0.4492073655128479The modified gen p mean: 0.4475170075893402, gen p mean: -0.0520160011947155, mean p set: 0.4479973018169403
loss_pred:0.014464940875768661, decouple_loss:0.0011662052711471915
loss_pred:0.014226906932890415, decouple_loss:0.001314060646109283
Iteration: 893, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44666147232055664, gen p mean: -0.052161309868097305, mean p set: 0.44714176654815674
loss_pred:0.014558386988937855, decouple_loss:0.0014982350403442979
The modified gen p mean: 0.44933342933654785, gen p mean: -0.05154596269130707, mean p set: 0.44981372356414795The modified gen p mean: 0.4489459991455078, gen p mean: -0.04623031988739967, mean p set: 0.4494262933731079
loss_pred:0.013944324105978012, decouple_loss:0.0014705088688060641
loss_pred:0.014512433670461178, decouple_loss:0.001421814551576972
Iteration: 894, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44863730669021606, gen p mean: -0.04719117656350136, mean p set: 0.44911760091781616
loss_pred:0.01448430772870779, decouple_loss:0.0014792783185839653
The modified gen p mean: 0.4486353397369385, gen p mean: -0.04875730723142624, mean p set: 0.4491156041622162The modified gen p mean: 0.44882646203041077, gen p mean: -0.051012683659791946, mean p set: 0.44930675625801086
loss_pred:0.014252008870244026, decouple_loss:0.0013308391207829118
loss_pred:0.014137141406536102, decouple_loss:0.0014366875402629375
Iteration: 895, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44876736402511597, gen p mean: -0.047162532806396484, mean p set: 0.44924765825271606
loss_pred:0.013799838721752167, decouple_loss:0.0016208668239414692
The modified gen p mean: 0.44847407937049866, gen p mean: -0.05018780753016472, mean p set: 0.44895440340042114The modified gen p mean: 0.4478552043437958, gen p mean: -0.045875828713178635, mean p set: 0.4483354985713959
loss_pred:0.01444457471370697, decouple_loss:0.001337417052127421
loss_pred:0.013950807973742485, decouple_loss:0.0013836045982316136
Iteration: 896, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480783939361572, gen p mean: -0.04419659450650215, mean p set: 0.44855865836143494
loss_pred:0.014015468768775463, decouple_loss:0.0015690831933170557
The modified gen p mean: 0.4482080042362213, gen p mean: -0.04300050809979439, mean p set: 0.4486883282661438
The modified gen p mean: 0.4487854838371277, gen p mean: -0.04431411996483803, mean p set: 0.44926580786705017
loss_pred:0.014064881019294262, decouple_loss:0.0014449601294472814
loss_pred:0.014054023660719395, decouple_loss:0.001464108470827341
Iteration: 897, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477640390396118, gen p mean: -0.04439692571759224, mean p set: 0.4482443630695343
loss_pred:0.014259140007197857, decouple_loss:0.0012868483318015933
The modified gen p mean: 0.4480448067188263, gen p mean: -0.04880480840802193, mean p set: 0.4485251009464264The modified gen p mean: 0.44737279415130615, gen p mean: -0.04805997014045715, mean p set: 0.44785305857658386
loss_pred:0.01405942440032959, decouple_loss:0.0013926757965236902
loss_pred:0.014378693886101246, decouple_loss:0.0013258163817226887
Iteration: 898, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448775053024292, gen p mean: -0.04551077261567116, mean p set: 0.4492553174495697
loss_pred:0.013999157585203648, decouple_loss:0.0014728540554642677
The modified gen p mean: 0.4485594630241394, gen p mean: -0.04761965200304985, mean p set: 0.4490397274494171The modified gen p mean: 0.44823095202445984, gen p mean: -0.042522940784692764, mean p set: 0.44871124625205994
loss_pred:0.01421081181615591, decouple_loss:0.0015170322731137276
loss_pred:0.01395939476788044, decouple_loss:0.0015594040742143989
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 899, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447951078414917, gen p mean: -0.04847997799515724, mean p set: 0.4484313726425171
loss_pred:0.013867621310055256, decouple_loss:0.0014598533743992448
The modified gen p mean: 0.4487197995185852, gen p mean: -0.04580402374267578, mean p set: 0.4492001235485077
The modified gen p mean: 0.4482119381427765, gen p mean: -0.045588746666908264, mean p set: 0.4486922323703766
loss_pred:0.013721025548875332, decouple_loss:0.0014011338353157043
loss_pred:0.01424902118742466, decouple_loss:0.0013355041155591607
Iteration: 900, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484032988548279, gen p mean: -0.04757060110569, mean p set: 0.4488835632801056
loss_pred:0.013518359512090683, decouple_loss:0.0015244603855535388
The modified gen p mean: 0.4485744833946228, gen p mean: -0.04704274982213974, mean p set: 0.4490547776222229The modified gen p mean: 0.44858911633491516, gen p mean: -0.04955797269940376, mean p set: 0.44906941056251526
loss_pred:0.013793783262372017, decouple_loss:0.0015699451323598623
loss_pred:0.01372377946972847, decouple_loss:0.0015267739072442055
2023-05-02 06:05:44 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.04997561499476433, mean p set: 0.4502691626548767
The modified gen p mean: 0.4498766362667084, gen p mean: -0.046327341347932816, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830237865448, gen p mean: -0.04636530578136444, mean p set: 0.4500633478164673
loss_pred:0.019111692905426025, decouple_loss:0.0014583043521270156
loss_pred:0.018038958311080933, decouple_loss:0.0014087024610489607
loss_pred:0.01811092346906662, decouple_loss:0.0013731417711824179
WV_0_PC_1_EH_0_PS_40, loss: 0.018491193652153015, avg_mse: 0.026894118636846542
current test mse: 0.026894
Iteration: 901, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44805780053138733, gen p mean: -0.046523403376340866, mean p set: 0.44853806495666504
The modified gen p mean: 0.44889020919799805, gen p mean: -0.049369968473911285, mean p set: 0.44937053322792053
The modified gen p mean: 0.4478801488876343, gen p mean: -0.0467749759554863, mean p set: 0.4483604431152344
loss_pred:0.013878501951694489, decouple_loss:0.0014689998934045434
loss_pred:0.013736264780163765, decouple_loss:0.001400690758600831
loss_pred:0.014151453040540218, decouple_loss:0.0014328558463603258
Iteration: 902, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479963183403015, gen p mean: -0.04928455129265785, mean p set: 0.4484765827655792
loss_pred:0.013752011582255363, decouple_loss:0.0013806220376864076
The modified gen p mean: 0.44862377643585205, gen p mean: -0.04686915501952171, mean p set: 0.44910410046577454The modified gen p mean: 0.44635310769081116, gen p mean: -0.04809226840734482, mean p set: 0.44683340191841125
loss_pred:0.014113272540271282, decouple_loss:0.0014100848929956555
loss_pred:0.014124083332717419, decouple_loss:0.0013558589853346348
Iteration: 903, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44772353768348694, gen p mean: -0.038825295865535736, mean p set: 0.4482038617134094
loss_pred:0.013777979649603367, decouple_loss:0.0013478640466928482
The modified gen p mean: 0.4491446018218994, gen p mean: -0.04654194414615631, mean p set: 0.4496248662471771The modified gen p mean: 0.4494702219963074, gen p mean: -0.042781006544828415, mean p set: 0.44995051622390747
loss_pred:0.013657760806381702, decouple_loss:0.0013078615302219987
loss_pred:0.013864357955753803, decouple_loss:0.0014176677213981748
Iteration: 904, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473927617073059, gen p mean: -0.03846641257405281, mean p set: 0.447873055934906
loss_pred:0.013859654776751995, decouple_loss:0.0013172710314393044
The modified gen p mean: 0.44756248593330383, gen p mean: -0.04467891529202461, mean p set: 0.44804278016090393The modified gen p mean: 0.4480121433734894, gen p mean: -0.04668309539556503, mean p set: 0.4484924077987671
loss_pred:0.0140983946621418, decouple_loss:0.00130477175116539
loss_pred:0.013728637248277664, decouple_loss:0.001380008878186345
Iteration: 905, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485089182853699, gen p mean: -0.05310174450278282, mean p set: 0.44898921251296997
loss_pred:0.013389707542955875, decouple_loss:0.0012981274630874395
The modified gen p mean: 0.4477488100528717, gen p mean: -0.04703205078840256, mean p set: 0.4482291042804718The modified gen p mean: 0.4495488703250885, gen p mean: -0.05040314048528671, mean p set: 0.450029194355011
loss_pred:0.0138029670342803, decouple_loss:0.0012217749608680606
loss_pred:0.013834449462592602, decouple_loss:0.0013581296661868691
Iteration: 906, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483334422111511, gen p mean: -0.04834499582648277, mean p set: 0.4488137364387512
loss_pred:0.013713727705180645, decouple_loss:0.001376531203277409
The modified gen p mean: 0.44868943095207214, gen p mean: -0.05025105178356171, mean p set: 0.44916975498199463The modified gen p mean: 0.44877079129219055, gen p mean: -0.048260513693094254, mean p set: 0.44925105571746826
loss_pred:0.013993866741657257, decouple_loss:0.0012487322092056274
loss_pred:0.013685280457139015, decouple_loss:0.001275246380828321
Iteration: 907, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487454891204834, gen p mean: -0.050332073122262955, mean p set: 0.4492258131504059
loss_pred:0.013675381429493427, decouple_loss:0.0012984091881662607
The modified gen p mean: 0.44870543479919434, gen p mean: -0.05273650959134102, mean p set: 0.4491857588291168
The modified gen p mean: 0.4471951425075531, gen p mean: -0.05041130259633064, mean p set: 0.4476754069328308
loss_pred:0.013823754154145718, decouple_loss:0.001211024122312665
loss_pred:0.013861024752259254, decouple_loss:0.0012735649943351746
Iteration: 908, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44903212785720825, gen p mean: -0.05024076998233795, mean p set: 0.44951245188713074
loss_pred:0.013148676604032516, decouple_loss:0.0012935665436089039
The modified gen p mean: 0.44869399070739746, gen p mean: -0.05329890921711922, mean p set: 0.44917428493499756
The modified gen p mean: 0.44808676838874817, gen p mean: -0.05493426322937012, mean p set: 0.44856706261634827
loss_pred:0.01359021570533514, decouple_loss:0.0012398669496178627
loss_pred:0.013814076781272888, decouple_loss:0.0012908916687592864
Iteration: 909, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481388032436371, gen p mean: -0.0520404689013958, mean p set: 0.44861912727355957
loss_pred:0.013575089164078236, decouple_loss:0.0012354865903034806
The modified gen p mean: 0.4472561478614807, gen p mean: -0.05441481992602348, mean p set: 0.4477364122867584The modified gen p mean: 0.4492049813270569, gen p mean: -0.053162477910518646, mean p set: 0.449685275554657
loss_pred:0.014048240147531033, decouple_loss:0.0012835325906053185
loss_pred:0.01347772590816021, decouple_loss:0.0012531370157375932
Iteration: 910, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44839170575141907, gen p mean: -0.05337958410382271, mean p set: 0.44887199997901917
loss_pred:0.013478262349963188, decouple_loss:0.0011358645278960466
The modified gen p mean: 0.4482963979244232, gen p mean: -0.05451130121946335, mean p set: 0.4487766921520233
The modified gen p mean: 0.4474312961101532, gen p mean: -0.04979012534022331, mean p set: 0.4479115903377533
loss_pred:0.013758040964603424, decouple_loss:0.0011793680023401976
loss_pred:0.013619414530694485, decouple_loss:0.001149197923950851
2023-05-02 06:07:40 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.053763117641210556, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.05021560192108154, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.05034876614809036, mean p set: 0.4500633478164673
loss_pred:0.01893560029566288, decouple_loss:0.001276499591767788
loss_pred:0.017917901277542114, decouple_loss:0.0013002011692151427
loss_pred:0.01798103004693985, decouple_loss:0.0012812268687412143
WV_0_PC_1_EH_0_PS_40, loss: 0.018342476338148117, avg_mse: 0.0266551710665226
current test mse: 0.026655
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012019_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012019_3_24hr.npz
NaN value num: 0
Iteration: 911, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4524185061454773, gen p mean: -0.036357562988996506, mean p set: 0.452898770570755
loss_pred:0.0168622899800539, decouple_loss:0.0016636464279145002
The modified gen p mean: 0.4516751766204834, gen p mean: -0.04106832295656204, mean p set: 0.4521554708480835The modified gen p mean: 0.45104217529296875, gen p mean: -0.04043171554803848, mean p set: 0.45152246952056885
loss_pred:0.016338491812348366, decouple_loss:0.0015052326489239931
loss_pred:0.017666814848780632, decouple_loss:0.0016020808834582567
Iteration: 912, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45146703720092773, gen p mean: -0.04050358384847641, mean p set: 0.4519473612308502
loss_pred:0.016760196536779404, decouple_loss:0.0012919065775349736
The modified gen p mean: 0.452144593000412, gen p mean: -0.04067738354206085, mean p set: 0.4526248872280121The modified gen p mean: 0.45107710361480713, gen p mean: -0.03617560490965843, mean p set: 0.4515573978424072
loss_pred:0.016396673396229744, decouple_loss:0.0012144166976213455
loss_pred:0.015535964630544186, decouple_loss:0.0013136975467205048
Iteration: 913, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4509282410144806, gen p mean: -0.041410237550735474, mean p set: 0.4514085352420807
loss_pred:0.015913862735033035, decouple_loss:0.0014930005418136716
The modified gen p mean: 0.4529097080230713, gen p mean: -0.03637518733739853, mean p set: 0.4533900320529938The modified gen p mean: 0.4504564106464386, gen p mean: -0.03492305055260658, mean p set: 0.4509367048740387
loss_pred:0.015645649284124374, decouple_loss:0.001329778810031712
loss_pred:0.015704354271292686, decouple_loss:0.0014567999169230461
Iteration: 914, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496847987174988, gen p mean: -0.03716573119163513, mean p set: 0.45016512274742126
loss_pred:0.016314474865794182, decouple_loss:0.001443411223590374
The modified gen p mean: 0.4514961838722229, gen p mean: -0.03294267877936363, mean p set: 0.451976478099823The modified gen p mean: 0.4501418471336365, gen p mean: -0.03556138649582863, mean p set: 0.4506221413612366
loss_pred:0.01600063033401966, decouple_loss:0.0015672652516514063
loss_pred:0.01667018234729767, decouple_loss:0.0013008004752919078
Iteration: 915, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4518786370754242, gen p mean: -0.0408620610833168, mean p set: 0.4523589313030243
loss_pred:0.015847332775592804, decouple_loss:0.001300802337937057
The modified gen p mean: 0.4517216682434082, gen p mean: -0.03932419791817665, mean p set: 0.4522019624710083The modified gen p mean: 0.4505757689476013, gen p mean: -0.038280367851257324, mean p set: 0.4510560631752014
loss_pred:0.0160561241209507, decouple_loss:0.001335053937509656
loss_pred:0.016444336622953415, decouple_loss:0.0014176222030073404
Iteration: 916, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45168137550354004, gen p mean: -0.039441823959350586, mean p set: 0.4521616995334625
loss_pred:0.01665671356022358, decouple_loss:0.0013375317212194204
The modified gen p mean: 0.451174259185791, gen p mean: -0.043921519070863724, mean p set: 0.4516545534133911The modified gen p mean: 0.45073387026786804, gen p mean: -0.04094638302922249, mean p set: 0.45121413469314575
loss_pred:0.016564399003982544, decouple_loss:0.0013205851428210735
loss_pred:0.015974607318639755, decouple_loss:0.001446041278541088
Iteration: 917, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497269093990326, gen p mean: -0.048530373722314835, mean p set: 0.4502072036266327
loss_pred:0.01622837781906128, decouple_loss:0.0012620801571756601
The modified gen p mean: 0.4505290687084198, gen p mean: -0.053859543055295944, mean p set: 0.4510093629360199The modified gen p mean: 0.45158693194389343, gen p mean: -0.04874815791845322, mean p set: 0.45206722617149353
loss_pred:0.016586799174547195, decouple_loss:0.0012208978878334165
loss_pred:0.015774888917803764, decouple_loss:0.001223039347678423
Iteration: 918, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45307403802871704, gen p mean: -0.046814337372779846, mean p set: 0.4535543620586395
loss_pred:0.015575735829770565, decouple_loss:0.001442929613403976
The modified gen p mean: 0.45027273893356323, gen p mean: -0.0431789793074131, mean p set: 0.45075303316116333The modified gen p mean: 0.4519047737121582, gen p mean: -0.04502742737531662, mean p set: 0.4523850381374359
loss_pred:0.015875397250056267, decouple_loss:0.0014847522834315896
loss_pred:0.016334516927599907, decouple_loss:0.0014757441822439432
Iteration: 919, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45015791058540344, gen p mean: -0.04986283555626869, mean p set: 0.45063820481300354
loss_pred:0.01589178293943405, decouple_loss:0.0012259003706276417
The modified gen p mean: 0.4502018690109253, gen p mean: -0.04821036756038666, mean p set: 0.450682133436203
The modified gen p mean: 0.45010125637054443, gen p mean: -0.04128129407763481, mean p set: 0.45058155059814453
loss_pred:0.016372747719287872, decouple_loss:0.0012000103015452623
loss_pred:0.01582256332039833, decouple_loss:0.0011401638621464372
Iteration: 920, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507963955402374, gen p mean: -0.04548830911517143, mean p set: 0.4512766897678375
loss_pred:0.016197068616747856, decouple_loss:0.001235365867614746
The modified gen p mean: 0.450790673494339, gen p mean: -0.04791320487856865, mean p set: 0.4512709379196167The modified gen p mean: 0.4510781764984131, gen p mean: -0.047234371304512024, mean p set: 0.4515584707260132
loss_pred:0.01596464216709137, decouple_loss:0.0012219699565321207
loss_pred:0.016726840287446976, decouple_loss:0.0012217354960739613
2023-05-02 06:10:12 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.05718442052602768, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.05357068032026291, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.05356990918517113, mean p set: 0.4500633478164673
loss_pred:0.01844748854637146, decouple_loss:0.0015743836993351579
loss_pred:0.017519837245345116, decouple_loss:0.0015275062760338187
loss_pred:0.017387129366397858, decouple_loss:0.0015333134215325117
WV_0_PC_1_EH_0_PS_40, loss: 0.017862072214484215, avg_mse: 0.025668272748589516
current test mse: 0.025668
Iteration: 921, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4515930414199829, gen p mean: -0.04537747800350189, mean p set: 0.452073335647583
The modified gen p mean: 0.45102861523628235, gen p mean: -0.04785958677530289, mean p set: 0.45150890946388245
The modified gen p mean: 0.44992557168006897, gen p mean: -0.040830060839653015, mean p set: 0.45040586590766907
loss_pred:0.01577376015484333, decouple_loss:0.0018664271337911487
loss_pred:0.01616583950817585, decouple_loss:0.001474363962188363
loss_pred:0.015315978787839413, decouple_loss:0.0016736508114263415
Iteration: 922, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45063239336013794, gen p mean: -0.053433116525411606, mean p set: 0.45111268758773804
loss_pred:0.01514172088354826, decouple_loss:0.0012268938589841127
The modified gen p mean: 0.45237085223197937, gen p mean: -0.0492282398045063, mean p set: 0.45285114645957947The modified gen p mean: 0.4512689709663391, gen p mean: -0.0462283194065094, mean p set: 0.4517492651939392
loss_pred:0.015714777633547783, decouple_loss:0.0014097692910581827
loss_pred:0.015351190231740475, decouple_loss:0.0012581914197653532
Iteration: 923, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511336088180542, gen p mean: -0.05017964914441109, mean p set: 0.4516139328479767
loss_pred:0.016415901482105255, decouple_loss:0.0015511480160057545
The modified gen p mean: 0.45152682065963745, gen p mean: -0.051895227283239365, mean p set: 0.45200711488723755The modified gen p mean: 0.45099154114723206, gen p mean: -0.04786135256290436, mean p set: 0.45147183537483215
loss_pred:0.015679048374295235, decouple_loss:0.0014389794087037444
loss_pred:0.016364477574825287, decouple_loss:0.0014806302497163415
Iteration: 924, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45111170411109924, gen p mean: -0.05179355666041374, mean p set: 0.45159196853637695
loss_pred:0.01637568697333336, decouple_loss:0.0013923010556027293
The modified gen p mean: 0.4504019021987915, gen p mean: -0.055855892598629, mean p set: 0.450882226228714
The modified gen p mean: 0.451937735080719, gen p mean: -0.045874737203121185, mean p set: 0.4524179995059967
loss_pred:0.015094426460564137, decouple_loss:0.0014446900459006429
loss_pred:0.01620600000023842, decouple_loss:0.0013780707959085703
Iteration: 925, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507935345172882, gen p mean: -0.04613330215215683, mean p set: 0.4512738585472107
The modified gen p mean: 0.4506165683269501, gen p mean: -0.04872523993253708, mean p set: 0.4510968327522278
loss_pred:0.016371726989746094, decouple_loss:0.0011738388566300273
loss_pred:0.016055475920438766, decouple_loss:0.001190167386084795
The modified gen p mean: 0.4511029124259949, gen p mean: -0.04939395189285278, mean p set: 0.45158323645591736
loss_pred:0.016502462327480316, decouple_loss:0.0012428961927071214
Iteration: 926, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45135343074798584, gen p mean: -0.05181319639086723, mean p set: 0.4518337547779083
loss_pred:0.016057690605521202, decouple_loss:0.001134589547291398
The modified gen p mean: 0.4512355327606201, gen p mean: -0.05354246124625206, mean p set: 0.4517157971858978The modified gen p mean: 0.4517934322357178, gen p mean: -0.0540962778031826, mean p set: 0.4522736966609955
loss_pred:0.016614248976111412, decouple_loss:0.0011072845663875341
loss_pred:0.01568160206079483, decouple_loss:0.0012612357968464494
Iteration: 927, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45139825344085693, gen p mean: -0.05161536857485771, mean p set: 0.45187854766845703
loss_pred:0.016364749521017075, decouple_loss:0.0011885904241353273
The modified gen p mean: 0.45018839836120605, gen p mean: -0.05365481972694397, mean p set: 0.45066869258880615
The modified gen p mean: 0.4505321681499481, gen p mean: -0.05284392088651657, mean p set: 0.4510124921798706
loss_pred:0.016326596960425377, decouple_loss:0.0013505358947440982
loss_pred:0.015814701095223427, decouple_loss:0.0012960000894963741
Iteration: 928, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45051705837249756, gen p mean: -0.050866737961769104, mean p set: 0.45099735260009766
loss_pred:0.015451873652637005, decouple_loss:0.0010902993381023407
The modified gen p mean: 0.4508490264415741, gen p mean: -0.046953845769166946, mean p set: 0.4513293206691742
The modified gen p mean: 0.4509286880493164, gen p mean: -0.050332240760326385, mean p set: 0.4514089822769165
loss_pred:0.015647627413272858, decouple_loss:0.001099164830520749
loss_pred:0.016079314053058624, decouple_loss:0.001085366471670568
Iteration: 929, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45177724957466125, gen p mean: -0.04848554730415344, mean p set: 0.45225754380226135
loss_pred:0.016624322161078453, decouple_loss:0.0010956403566524386
The modified gen p mean: 0.45081135630607605, gen p mean: -0.044480372220277786, mean p set: 0.45129165053367615The modified gen p mean: 0.45241662859916687, gen p mean: -0.04691115766763687, mean p set: 0.4528968930244446
loss_pred:0.015902817249298096, decouple_loss:0.001169859548099339
loss_pred:0.015329991467297077, decouple_loss:0.0012461486039683223
Iteration: 930, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45104271173477173, gen p mean: -0.04881230741739273, mean p set: 0.4515230059623718
loss_pred:0.015539530664682388, decouple_loss:0.0012065331684425473
The modified gen p mean: 0.45098811388015747, gen p mean: -0.04972197860479355, mean p set: 0.45146840810775757The modified gen p mean: 0.4502286911010742, gen p mean: -0.04229316860437393, mean p set: 0.4507089853286743
loss_pred:0.016285188496112823, decouple_loss:0.0013120959047228098
loss_pred:0.015628604218363762, decouple_loss:0.0012905880575999618
2023-05-02 06:12:07 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.05516353249549866, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830535888672, gen p mean: -0.05131431668996811, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.05171338468790054, mean p set: 0.45035696029663086
loss_pred:0.01841483823955059, decouple_loss:0.0014012960018590093
loss_pred:0.017512774094939232, decouple_loss:0.0014317187014967203
loss_pred:0.017411263659596443, decouple_loss:0.0015401218552142382
WV_0_PC_1_EH_0_PS_40, loss: 0.017852511256933212, avg_mse: 0.025644998997449875
current test mse: 0.025645
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012004_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012004_3_24hr.npz
NaN value num: 0
Iteration: 931, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4518240690231323, gen p mean: -0.040772344917058945, mean p set: 0.4523043632507324
loss_pred:0.0163275059312582, decouple_loss:0.0013010037364438176
The modified gen p mean: 0.45158591866493225, gen p mean: -0.045350346714258194, mean p set: 0.45206621289253235The modified gen p mean: 0.45130518078804016, gen p mean: -0.048794977366924286, mean p set: 0.45178547501564026
loss_pred:0.016987884417176247, decouple_loss:0.0011023766128346324
loss_pred:0.01648140698671341, decouple_loss:0.0011827851412817836
Iteration: 932, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45085665583610535, gen p mean: -0.04001500830054283, mean p set: 0.45133697986602783
loss_pred:0.017204442992806435, decouple_loss:0.001080244081094861
The modified gen p mean: 0.4515613615512848, gen p mean: -0.043673109263181686, mean p set: 0.4520416855812073
The modified gen p mean: 0.4532161355018616, gen p mean: -0.03863689675927162, mean p set: 0.4536963999271393
loss_pred:0.01711144857108593, decouple_loss:0.0011433819308876991
loss_pred:0.01666289195418358, decouple_loss:0.0011019870871677995
Iteration: 933, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492541551589966, gen p mean: -0.04208681732416153, mean p set: 0.4497344493865967
loss_pred:0.016628248617053032, decouple_loss:0.0012270925799384713
The modified gen p mean: 0.45173248648643494, gen p mean: -0.044389985501766205, mean p set: 0.45221275091171265The modified gen p mean: 0.45129385590553284, gen p mean: -0.040319595485925674, mean p set: 0.45177412033081055
loss_pred:0.016924023628234863, decouple_loss:0.0011730460682883859
loss_pred:0.016246819868683815, decouple_loss:0.0011105710873380303
Iteration: 934, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514947235584259, gen p mean: -0.04285147786140442, mean p set: 0.451975017786026
loss_pred:0.016478728502988815, decouple_loss:0.0010821613250300288
The modified gen p mean: 0.4531627595424652, gen p mean: -0.042705610394477844, mean p set: 0.4536430835723877The modified gen p mean: 0.44974735379219055, gen p mean: -0.04658205434679985, mean p set: 0.45022767782211304
loss_pred:0.017358863726258278, decouple_loss:0.0011387210106477141
loss_pred:0.01730663701891899, decouple_loss:0.0011645040940493345
Iteration: 935, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45236364006996155, gen p mean: -0.04989004507660866, mean p set: 0.45284390449523926
loss_pred:0.017119809985160828, decouple_loss:0.0010537116322666407
The modified gen p mean: 0.45080551505088806, gen p mean: -0.044191885739564896, mean p set: 0.45128580927848816The modified gen p mean: 0.4526613652706146, gen p mean: -0.04324007034301758, mean p set: 0.45314162969589233
loss_pred:0.01667872630059719, decouple_loss:0.0010494852904230356
loss_pred:0.017278611660003662, decouple_loss:0.0010917915496975183
Iteration: 936, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4512452185153961, gen p mean: -0.04309004172682762, mean p set: 0.4517255127429962
loss_pred:0.016684362664818764, decouple_loss:0.0010522056836634874
The modified gen p mean: 0.45051953196525574, gen p mean: -0.04368366301059723, mean p set: 0.45099982619285583The modified gen p mean: 0.45270460844039917, gen p mean: -0.042381059378385544, mean p set: 0.45318490266799927
loss_pred:0.01696709729731083, decouple_loss:0.0010049004340544343
loss_pred:0.017520930618047714, decouple_loss:0.0010745343752205372
Iteration: 937, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45134761929512024, gen p mean: -0.04117133095860481, mean p set: 0.45182791352272034
loss_pred:0.017090918496251106, decouple_loss:0.0012082107132300735
The modified gen p mean: 0.4496020972728729, gen p mean: -0.04666789248585701, mean p set: 0.450082391500473The modified gen p mean: 0.4496833384037018, gen p mean: -0.048213038593530655, mean p set: 0.4501636028289795
loss_pred:0.01694609597325325, decouple_loss:0.001208414090797305
loss_pred:0.017094679176807404, decouple_loss:0.0012020025169476867
Iteration: 938, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491100311279297, gen p mean: -0.04249172657728195, mean p set: 0.4495902955532074
loss_pred:0.016536276787519455, decouple_loss:0.0010756023693829775
The modified gen p mean: 0.4494071900844574, gen p mean: -0.0460568331182003, mean p set: 0.4498874545097351The modified gen p mean: 0.4512578845024109, gen p mean: -0.04789743945002556, mean p set: 0.451738178730011
loss_pred:0.016342025250196457, decouple_loss:0.0010386494686827064
loss_pred:0.016882579773664474, decouple_loss:0.001248953165486455
Iteration: 939, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485553801059723, gen p mean: -0.0495549701154232, mean p set: 0.4490357041358948
loss_pred:0.01677451655268669, decouple_loss:0.0012000255519524217
The modified gen p mean: 0.4505396783351898, gen p mean: -0.051951032131910324, mean p set: 0.4510199725627899The modified gen p mean: 0.45225515961647034, gen p mean: -0.04551955312490463, mean p set: 0.45273545384407043
loss_pred:0.017088226974010468, decouple_loss:0.001226398628205061
loss_pred:0.017133980989456177, decouple_loss:0.0012826526071876287
Iteration: 940, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4516095221042633, gen p mean: -0.05372222885489464, mean p set: 0.452089786529541
loss_pred:0.015758777037262917, decouple_loss:0.0011113965883851051
The modified gen p mean: 0.4497973322868347, gen p mean: -0.05747043713927269, mean p set: 0.4502776563167572
The modified gen p mean: 0.45004647970199585, gen p mean: -0.05547233670949936, mean p set: 0.45052674412727356
loss_pred:0.016418924555182457, decouple_loss:0.0011899598175659776
loss_pred:0.01653563603758812, decouple_loss:0.0012179991463199258
2023-05-02 06:14:40 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.06573992222547531, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.061381347477436066, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.06171780079603195, mean p set: 0.4500633478164673
loss_pred:0.018189964815974236, decouple_loss:0.0013636751100420952
loss_pred:0.017179904505610466, decouple_loss:0.0014909743331372738
loss_pred:0.01729946956038475, decouple_loss:0.0014134766533970833
WV_0_PC_1_EH_0_PS_40, loss: 0.01762758195400238, avg_mse: 0.02521894872188568
current test mse: 0.025219
At step 940, Best test: 0.025219
save model to /work/09012/haoli1/ls6/ERA5_PredRNN/checkpoints/WV_0_PC_1_EH_0_PS_40/model_test_schedule_sampling_DynaMean.ckpt
Iteration: 941, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499387741088867, gen p mean: -0.05955398082733154, mean p set: 0.4504190683364868
loss_pred:0.017358018085360527, decouple_loss:0.0011344276135787368
The modified gen p mean: 0.4488845467567444, gen p mean: -0.055537689477205276, mean p set: 0.4493648409843445The modified gen p mean: 0.45221543312072754, gen p mean: -0.05471208691596985, mean p set: 0.45269572734832764
loss_pred:0.016702059656381607, decouple_loss:0.0012779377866536379loss_pred:0.01592148281633854, decouple_loss:0.0011111118365079165
Iteration: 942, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45076581835746765, gen p mean: -0.05411311611533165, mean p set: 0.45124614238739014
loss_pred:0.016908986493945122, decouple_loss:0.0014104361180216074
The modified gen p mean: 0.4512547254562378, gen p mean: -0.05605994537472725, mean p set: 0.4517350196838379The modified gen p mean: 0.4514922499656677, gen p mean: -0.05004793405532837, mean p set: 0.4519725739955902
loss_pred:0.01708473637700081, decouple_loss:0.0013712041545659304
loss_pred:0.016416776925325394, decouple_loss:0.001226093270815909
Iteration: 943, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45052701234817505, gen p mean: -0.06052097678184509, mean p set: 0.45100730657577515
loss_pred:0.017018603160977364, decouple_loss:0.0010478710755705833
The modified gen p mean: 0.45084866881370544, gen p mean: -0.05771181359887123, mean p set: 0.45132896304130554The modified gen p mean: 0.4520755112171173, gen p mean: -0.05345357209444046, mean p set: 0.4525558054447174
loss_pred:0.01713610626757145, decouple_loss:0.0010618905071169138
loss_pred:0.016415776684880257, decouple_loss:0.0011651627719402313
Iteration: 944, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45043182373046875, gen p mean: -0.056279636919498444, mean p set: 0.45091211795806885
loss_pred:0.017358705401420593, decouple_loss:0.0011467131553217769
The modified gen p mean: 0.45059874653816223, gen p mean: -0.05369340628385544, mean p set: 0.45107904076576233The modified gen p mean: 0.44854339957237244, gen p mean: -0.0545274019241333, mean p set: 0.44902369379997253
loss_pred:0.016600817441940308, decouple_loss:0.001239326666109264
loss_pred:0.017003875225782394, decouple_loss:0.0011255466379225254
Iteration: 945, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513400197029114, gen p mean: -0.053786735981702805, mean p set: 0.4518203139305115
loss_pred:0.016718028113245964, decouple_loss:0.0011830141302198172
The modified gen p mean: 0.45272067189216614, gen p mean: -0.04981880262494087, mean p set: 0.45320096611976624The modified gen p mean: 0.4515460133552551, gen p mean: -0.056788790971040726, mean p set: 0.4520263373851776
loss_pred:0.017328914254903793, decouple_loss:0.0012274016626179218
loss_pred:0.01623561792075634, decouple_loss:0.0012306754942983389
Iteration: 946, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4521658420562744, gen p mean: -0.052682437002658844, mean p set: 0.4526461362838745
loss_pred:0.01592325232923031, decouple_loss:0.0010801606113091111
The modified gen p mean: 0.4487006366252899, gen p mean: -0.05121126398444176, mean p set: 0.44918093085289The modified gen p mean: 0.4497767388820648, gen p mean: -0.05207858979701996, mean p set: 0.4502570331096649
loss_pred:0.017443334683775902, decouple_loss:0.0010331424418836832
loss_pred:0.0167413130402565, decouple_loss:0.0011930923210456967
Iteration: 947, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492374658584595, gen p mean: -0.04598432779312134, mean p set: 0.44971778988838196
loss_pred:0.016926486045122147, decouple_loss:0.0012292381143197417
The modified gen p mean: 0.45077332854270935, gen p mean: -0.04828805848956108, mean p set: 0.45125362277030945The modified gen p mean: 0.45051440596580505, gen p mean: -0.0526948906481266, mean p set: 0.45099470019340515
loss_pred:0.01707269437611103, decouple_loss:0.0012594712898135185
loss_pred:0.01631159335374832, decouple_loss:0.0012339521199464798
Iteration: 948, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491153657436371, gen p mean: -0.04409365728497505, mean p set: 0.44959568977355957
loss_pred:0.01690172776579857, decouple_loss:0.0010407721856608987
The modified gen p mean: 0.4504566192626953, gen p mean: -0.04239393025636673, mean p set: 0.4509369134902954The modified gen p mean: 0.4496880769729614, gen p mean: -0.04283228516578674, mean p set: 0.4501683712005615
loss_pred:0.017241980880498886, decouple_loss:0.001061075716279447
loss_pred:0.017269525676965714, decouple_loss:0.00103268853854388
Iteration: 949, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45371267199516296, gen p mean: -0.04250238090753555, mean p set: 0.4541929364204407
loss_pred:0.017147449776530266, decouple_loss:0.0012149817775934935
The modified gen p mean: 0.4489477574825287, gen p mean: -0.04685879126191139, mean p set: 0.4494280517101288The modified gen p mean: 0.4493904411792755, gen p mean: -0.04896722733974457, mean p set: 0.4498707354068756
loss_pred:0.015967760235071182, decouple_loss:0.0011903152335435152
loss_pred:0.01651717908680439, decouple_loss:0.0012327423319220543
Iteration: 950, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45213818550109863, gen p mean: -0.04306378588080406, mean p set: 0.45261847972869873
loss_pred:0.016726301982998848, decouple_loss:0.0011771261924877763
The modified gen p mean: 0.4509754776954651, gen p mean: -0.044003311544656754, mean p set: 0.4514558017253876
The modified gen p mean: 0.45142248272895813, gen p mean: -0.04536832123994827, mean p set: 0.4519027769565582
loss_pred:0.017022214829921722, decouple_loss:0.0010918867774307728
loss_pred:0.016269436106085777, decouple_loss:0.0011755900923162699
2023-05-02 06:16:41 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.05265289545059204, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.048906609416007996, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04895874485373497, mean p set: 0.4500633478164673
loss_pred:0.01822672039270401, decouple_loss:0.0013864326756447554
loss_pred:0.01718457229435444, decouple_loss:0.00123736378736794
loss_pred:0.017333321273326874, decouple_loss:0.001282832701690495
WV_0_PC_1_EH_0_PS_40, loss: 0.01764664798974991, avg_mse: 0.02526245266199112
current test mse: 0.025262
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012000_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012000_3_24hr.npz
NaN value num: 0
Iteration: 951, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474044740200043, gen p mean: -0.05222681164741516, mean p set: 0.44788476824760437
loss_pred:0.015679392963647842, decouple_loss:0.0014191234949976206
The modified gen p mean: 0.44622308015823364, gen p mean: -0.0533723458647728, mean p set: 0.44670340418815613The modified gen p mean: 0.44721201062202454, gen p mean: -0.049273062497377396, mean p set: 0.44769227504730225
loss_pred:0.016191640868782997, decouple_loss:0.0013014075811952353
loss_pred:0.015934376046061516, decouple_loss:0.0014653861289843917
Iteration: 952, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472954571247101, gen p mean: -0.04949565976858139, mean p set: 0.44777578115463257
loss_pred:0.016156909987330437, decouple_loss:0.0012554387794807553
The modified gen p mean: 0.4472602307796478, gen p mean: -0.056076884269714355, mean p set: 0.4477405250072479The modified gen p mean: 0.44848692417144775, gen p mean: -0.056593798100948334, mean p set: 0.44896718859672546
loss_pred:0.016603983938694, decouple_loss:0.001401985064148903
loss_pred:0.016087928786873817, decouple_loss:0.001232400187291205
Iteration: 953, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44698768854141235, gen p mean: -0.0548999086022377, mean p set: 0.44746798276901245
loss_pred:0.01620686985552311, decouple_loss:0.001342949690297246
The modified gen p mean: 0.44558024406433105, gen p mean: -0.055060405284166336, mean p set: 0.44606053829193115
The modified gen p mean: 0.447578489780426, gen p mean: -0.0532628558576107, mean p set: 0.44805875420570374
loss_pred:0.016053153201937675, decouple_loss:0.0012543939519673586
loss_pred:0.015752816572785378, decouple_loss:0.0013805264607071877
Iteration: 954, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477144181728363, gen p mean: -0.05366334691643715, mean p set: 0.4481947124004364
loss_pred:0.017228571698069572, decouple_loss:0.0012121638283133507
The modified gen p mean: 0.4456823468208313, gen p mean: -0.057248812168836594, mean p set: 0.4461626410484314The modified gen p mean: 0.4469488859176636, gen p mean: -0.058920230716466904, mean p set: 0.44742920994758606
loss_pred:0.0155657222494483, decouple_loss:0.0012480876175686717
loss_pred:0.01602599211037159, decouple_loss:0.0012614981969818473
Iteration: 955, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44661179184913635, gen p mean: -0.06034887582063675, mean p set: 0.44709208607673645
loss_pred:0.016026252880692482, decouple_loss:0.0012063713511452079
The modified gen p mean: 0.44754984974861145, gen p mean: -0.0550847090780735, mean p set: 0.44803011417388916The modified gen p mean: 0.4494279623031616, gen p mean: -0.06359337270259857, mean p set: 0.44990822672843933
loss_pred:0.016265610232949257, decouple_loss:0.0014148368500173092
loss_pred:0.01729770004749298, decouple_loss:0.0012222181539982557
Iteration: 956, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464568793773651, gen p mean: -0.05793125554919243, mean p set: 0.4469371736049652
loss_pred:0.015917936339974403, decouple_loss:0.0012978645972907543
The modified gen p mean: 0.4471409320831299, gen p mean: -0.060931675136089325, mean p set: 0.44762122631073The modified gen p mean: 0.4470890462398529, gen p mean: -0.06453819572925568, mean p set: 0.447569340467453
loss_pred:0.016249829903244972, decouple_loss:0.0013238043757155538
loss_pred:0.01594511978328228, decouple_loss:0.0012621013447642326
Iteration: 957, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44905394315719604, gen p mean: -0.06263197213411331, mean p set: 0.44953420758247375
loss_pred:0.01612916961312294, decouple_loss:0.0012483978644013405
The modified gen p mean: 0.44735077023506165, gen p mean: -0.055391017347574234, mean p set: 0.44783106446266174The modified gen p mean: 0.44675564765930176, gen p mean: -0.060487356036901474, mean p set: 0.44723597168922424
loss_pred:0.0160470400005579, decouple_loss:0.0012651627184823155
loss_pred:0.016156617552042007, decouple_loss:0.0012907683849334717
Iteration: 958, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484701454639435, gen p mean: -0.05314228683710098, mean p set: 0.4489504396915436
loss_pred:0.016720764338970184, decouple_loss:0.0011875620111823082
The modified gen p mean: 0.4463949501514435, gen p mean: -0.05862214043736458, mean p set: 0.4468752145767212The modified gen p mean: 0.4471758306026459, gen p mean: -0.056121986359357834, mean p set: 0.44765612483024597
loss_pred:0.015584246255457401, decouple_loss:0.0012178248725831509
loss_pred:0.015885652974247932, decouple_loss:0.0013865239452570677
Iteration: 959, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44772693514823914, gen p mean: -0.05406276509165764, mean p set: 0.44820722937583923
loss_pred:0.016686435788869858, decouple_loss:0.001137198880314827
The modified gen p mean: 0.44786348938941956, gen p mean: -0.05333545058965683, mean p set: 0.44834375381469727The modified gen p mean: 0.4471486806869507, gen p mean: -0.049498558044433594, mean p set: 0.44762900471687317
loss_pred:0.016865937039256096, decouple_loss:0.0011950178304687142
loss_pred:0.015870211645960808, decouple_loss:0.001111090648919344
Iteration: 960, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44768059253692627, gen p mean: -0.05160166695713997, mean p set: 0.448160856962204
loss_pred:0.016293365508317947, decouple_loss:0.0015022961888462305
The modified gen p mean: 0.4484092891216278, gen p mean: -0.05191749706864357, mean p set: 0.4488895833492279
The modified gen p mean: 0.4472357928752899, gen p mean: -0.0506126768887043, mean p set: 0.4477160573005676
loss_pred:0.016062509268522263, decouple_loss:0.0013465178199112415
loss_pred:0.015865199267864227, decouple_loss:0.0014289772370830178
2023-05-02 06:19:20 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.051428742706775665, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04730307310819626, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.047538939863443375, mean p set: 0.4500633478164673
loss_pred:0.01830814592540264, decouple_loss:0.0011222525499761105
loss_pred:0.017288129776716232, decouple_loss:0.001161098014563322
loss_pred:0.01742158830165863, decouple_loss:0.0011775329476222396
WV_0_PC_1_EH_0_PS_40, loss: 0.01773030310869217, avg_mse: 0.025440270081162453
current test mse: 0.02544
Iteration: 961, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470657706260681, gen p mean: -0.04165555536746979, mean p set: 0.447546124458313
The modified gen p mean: 0.446189284324646, gen p mean: -0.05093264579772949, mean p set: 0.4466695487499237
The modified gen p mean: 0.4470345973968506, gen p mean: -0.05244846269488335, mean p set: 0.4475148916244507
loss_pred:0.01588553749024868, decouple_loss:0.0010758230928331614
loss_pred:0.016153568401932716, decouple_loss:0.0011725594522431493
loss_pred:0.016982706263661385, decouple_loss:0.001087845885194838
Iteration: 962, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478931128978729, gen p mean: -0.051297783851623535, mean p set: 0.448373407125473
loss_pred:0.01600642129778862, decouple_loss:0.001241072197444737
The modified gen p mean: 0.44732069969177246, gen p mean: -0.04862937703728676, mean p set: 0.44780099391937256The modified gen p mean: 0.44653427600860596, gen p mean: -0.0479123480618, mean p set: 0.44701457023620605
loss_pred:0.015760840848088264, decouple_loss:0.0011475087376311421
loss_pred:0.01615414023399353, decouple_loss:0.0011539317201822996
Iteration: 963, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44772329926490784, gen p mean: -0.05620818957686424, mean p set: 0.44820359349250793
loss_pred:0.016024727374315262, decouple_loss:0.001172131858766079
The modified gen p mean: 0.4471362829208374, gen p mean: -0.0555906742811203, mean p set: 0.4476166069507599The modified gen p mean: 0.4463563859462738, gen p mean: -0.04989921674132347, mean p set: 0.4468367099761963
loss_pred:0.015787262469530106, decouple_loss:0.0011815170291811228
loss_pred:0.01586737111210823, decouple_loss:0.0011349896667525172
Iteration: 964, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44595327973365784, gen p mean: -0.05153292044997215, mean p set: 0.4464336037635803
loss_pred:0.015815438702702522, decouple_loss:0.0011334223672747612
The modified gen p mean: 0.44739392399787903, gen p mean: -0.05485768988728523, mean p set: 0.4478742182254791The modified gen p mean: 0.4474177360534668, gen p mean: -0.053279779851436615, mean p set: 0.4478980302810669
loss_pred:0.016438815742731094, decouple_loss:0.0010862722992897034
loss_pred:0.01599286124110222, decouple_loss:0.0010190655011683702
Iteration: 965, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44758981466293335, gen p mean: -0.04771698638796806, mean p set: 0.44807007908821106
loss_pred:0.016042372211813927, decouple_loss:0.0010979135986417532
The modified gen p mean: 0.4472832679748535, gen p mean: -0.0506444051861763, mean p set: 0.4477635622024536The modified gen p mean: 0.4469406008720398, gen p mean: -0.0579376257956028, mean p set: 0.4474208950996399
loss_pred:0.015928519889712334, decouple_loss:0.001031183055602014
loss_pred:0.01560487225651741, decouple_loss:0.0010872619459405541
Iteration: 966, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475298225879669, gen p mean: -0.047417182475328445, mean p set: 0.4480101466178894
loss_pred:0.01589254103600979, decouple_loss:0.0010364929912611842
The modified gen p mean: 0.4465195834636688, gen p mean: -0.055909089744091034, mean p set: 0.44699984788894653The modified gen p mean: 0.44760647416114807, gen p mean: -0.05308753252029419, mean p set: 0.44808676838874817
loss_pred:0.01599004864692688, decouple_loss:0.0010942494263872504
loss_pred:0.0156662929803133, decouple_loss:0.001019809627905488
Iteration: 967, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473946988582611, gen p mean: -0.05572352185845375, mean p set: 0.4478749930858612
loss_pred:0.01609993353486061, decouple_loss:0.001059263595379889
The modified gen p mean: 0.446994811296463, gen p mean: -0.05490277335047722, mean p set: 0.4474751055240631
The modified gen p mean: 0.44681090116500854, gen p mean: -0.056197378784418106, mean p set: 0.44729119539260864
loss_pred:0.015425327233970165, decouple_loss:0.0010047286050394177
loss_pred:0.015749862417578697, decouple_loss:0.0010891070123761892
Iteration: 968, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44694972038269043, gen p mean: -0.04738061875104904, mean p set: 0.44742998480796814
loss_pred:0.016997115686535835, decouple_loss:0.0011041795369237661
The modified gen p mean: 0.44731462001800537, gen p mean: -0.05209406092762947, mean p set: 0.44779494404792786The modified gen p mean: 0.4461573362350464, gen p mean: -0.05326899513602257, mean p set: 0.44663766026496887
loss_pred:0.016354475170373917, decouple_loss:0.001021054689772427
loss_pred:0.015635736286640167, decouple_loss:0.0009821390267461538
Iteration: 969, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472377598285675, gen p mean: -0.0505707710981369, mean p set: 0.4477180242538452
loss_pred:0.016808124259114265, decouple_loss:0.0010608135489746928
The modified gen p mean: 0.4473946690559387, gen p mean: -0.05480651557445526, mean p set: 0.4478749632835388The modified gen p mean: 0.44615963101387024, gen p mean: -0.055116698145866394, mean p set: 0.4466399550437927
loss_pred:0.015741046518087387, decouple_loss:0.0010072068544104695
loss_pred:0.01575823687016964, decouple_loss:0.0010123084066435695
Iteration: 970, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476718306541443, gen p mean: -0.05864522606134415, mean p set: 0.448152095079422
loss_pred:0.015876343473792076, decouple_loss:0.0010289454367011786
The modified gen p mean: 0.4480492174625397, gen p mean: -0.052340324968099594, mean p set: 0.4485294818878174The modified gen p mean: 0.44671186804771423, gen p mean: -0.05881296098232269, mean p set: 0.44719216227531433
loss_pred:0.016498863697052002, decouple_loss:0.0010413682321086526
loss_pred:0.015351515263319016, decouple_loss:0.0010276043321937323
2023-05-02 06:21:15 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.061565183103084564, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.057077158242464066, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.0576556995511055, mean p set: 0.4500633478164673
loss_pred:0.0183285903185606, decouple_loss:0.0011565727181732655
loss_pred:0.017254427075386047, decouple_loss:0.0010380452731624246
loss_pred:0.017369640991091728, decouple_loss:0.0010332994861528277
WV_0_PC_1_EH_0_PS_40, loss: 0.017704686149954796, avg_mse: 0.02541215345263481
current test mse: 0.025412
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012019_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012019_3_24hr.npz
NaN value num: 0
Iteration: 971, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490394592285156, gen p mean: -0.058804262429475784, mean p set: 0.44951972365379333
loss_pred:0.015053858980536461, decouple_loss:0.0010852565756067634
The modified gen p mean: 0.44782623648643494, gen p mean: -0.05013125762343407, mean p set: 0.44830653071403503The modified gen p mean: 0.44886156916618347, gen p mean: -0.05831912159919739, mean p set: 0.44934189319610596
loss_pred:0.015109911561012268, decouple_loss:0.0011036386713385582
loss_pred:0.015219139866530895, decouple_loss:0.0010214740177616477
Iteration: 972, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479733109474182, gen p mean: -0.05620351433753967, mean p set: 0.4484536051750183
loss_pred:0.0156441368162632, decouple_loss:0.0010825443314388394
The modified gen p mean: 0.4481983184814453, gen p mean: -0.05758143216371536, mean p set: 0.4486786425113678The modified gen p mean: 0.44751986861228943, gen p mean: -0.06182514503598213, mean p set: 0.4480001628398895
loss_pred:0.015886809676885605, decouple_loss:0.0012077261926606297
loss_pred:0.015461346134543419, decouple_loss:0.0010788552463054657
Iteration: 973, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492949843406677, gen p mean: -0.05650990456342697, mean p set: 0.4497752785682678
loss_pred:0.01449357345700264, decouple_loss:0.0012275476474314928
The modified gen p mean: 0.44853857159614563, gen p mean: -0.05408196151256561, mean p set: 0.44901883602142334
The modified gen p mean: 0.4486227035522461, gen p mean: -0.06021912768483162, mean p set: 0.4491029977798462
loss_pred:0.014849630184471607, decouple_loss:0.0012049681972712278
loss_pred:0.01443186029791832, decouple_loss:0.0011775143211707473
Iteration: 974, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494486153125763, gen p mean: -0.056897010654211044, mean p set: 0.449928879737854
loss_pred:0.014734595082700253, decouple_loss:0.0012633705046027899
The modified gen p mean: 0.4484134614467621, gen p mean: -0.05441966652870178, mean p set: 0.4488937258720398The modified gen p mean: 0.4475499987602234, gen p mean: -0.04540562629699707, mean p set: 0.4480302929878235
loss_pred:0.015282145701348782, decouple_loss:0.0013917014002799988
loss_pred:0.014935086481273174, decouple_loss:0.0012391629861667752
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 975, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494834542274475, gen p mean: -0.05011342838406563, mean p set: 0.4499637186527252
loss_pred:0.014628655277192593, decouple_loss:0.0013574876356869936
The modified gen p mean: 0.4494735300540924, gen p mean: -0.04623575136065483, mean p set: 0.4499538242816925The modified gen p mean: 0.44856327772140503, gen p mean: -0.053239766508340836, mean p set: 0.4490435719490051
loss_pred:0.014576435089111328, decouple_loss:0.001297740382142365
loss_pred:0.014589862897992134, decouple_loss:0.001277920906431973
Iteration: 976, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487845003604889, gen p mean: -0.046338602900505066, mean p set: 0.4492647647857666
loss_pred:0.013898982666432858, decouple_loss:0.0011766807874664664
The modified gen p mean: 0.44903847575187683, gen p mean: -0.044049832969903946, mean p set: 0.44951876997947693The modified gen p mean: 0.4481312036514282, gen p mean: -0.042985208332538605, mean p set: 0.4486114978790283
loss_pred:0.0144080501049757, decouple_loss:0.001320133451372385
loss_pred:0.014711455442011356, decouple_loss:0.001332474173977971
Iteration: 977, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489285945892334, gen p mean: -0.04729270190000534, mean p set: 0.4494089186191559
loss_pred:0.014475107192993164, decouple_loss:0.0012284384574741125
The modified gen p mean: 0.44908520579338074, gen p mean: -0.04732057824730873, mean p set: 0.44956550002098083
The modified gen p mean: 0.448160320520401, gen p mean: -0.03928816318511963, mean p set: 0.4486406445503235
loss_pred:0.014810259453952312, decouple_loss:0.001349303754977882
loss_pred:0.014538221061229706, decouple_loss:0.0012465630425140262
Iteration: 978, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44877126812934875, gen p mean: -0.047681279480457306, mean p set: 0.44925159215927124
loss_pred:0.013974535278975964, decouple_loss:0.0013174315681681037
The modified gen p mean: 0.44797804951667786, gen p mean: -0.049653131514787674, mean p set: 0.44845834374427795The modified gen p mean: 0.4489925801753998, gen p mean: -0.046696215867996216, mean p set: 0.44947290420532227
loss_pred:0.014242700301110744, decouple_loss:0.001314137363806367
loss_pred:0.01394242886453867, decouple_loss:0.0014695464633405209
Iteration: 979, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449418306350708, gen p mean: -0.0533006377518177, mean p set: 0.4498986005783081
loss_pred:0.014135037548840046, decouple_loss:0.001282602665014565
The modified gen p mean: 0.4477930963039398, gen p mean: -0.0482914112508297, mean p set: 0.4482733905315399The modified gen p mean: 0.4488866925239563, gen p mean: -0.048144176602363586, mean p set: 0.4493670165538788
loss_pred:0.014332614839076996, decouple_loss:0.0012238171184435487
loss_pred:0.013879845850169659, decouple_loss:0.0011970659252256155
Iteration: 980, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448279470205307, gen p mean: -0.04892726615071297, mean p set: 0.4487597644329071
loss_pred:0.014333263039588928, decouple_loss:0.0013762752059847116
The modified gen p mean: 0.4486974775791168, gen p mean: -0.049792759120464325, mean p set: 0.44917774200439453The modified gen p mean: 0.44809702038764954, gen p mean: -0.05516951531171799, mean p set: 0.448577344417572
loss_pred:0.014615822583436966, decouple_loss:0.0014420121442526579
loss_pred:0.01388171873986721, decouple_loss:0.0014330188278108835
2023-05-02 06:23:48 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.05364407226443291, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04946351423859596, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.04936426132917404, mean p set: 0.4500633478164673
loss_pred:0.01914864405989647, decouple_loss:0.0013765101321041584
loss_pred:0.018011607229709625, decouple_loss:0.0012823655270040035
loss_pred:0.018049899488687515, decouple_loss:0.001297827111557126
WV_0_PC_1_EH_0_PS_40, loss: 0.018469329923391342, avg_mse: 0.026867203414440155
current test mse: 0.026867
Iteration: 981, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486866295337677, gen p mean: -0.04740358889102936, mean p set: 0.4491669833660126
The modified gen p mean: 0.44952592253685, gen p mean: -0.057448431849479675, mean p set: 0.4500062167644501
The modified gen p mean: 0.4478198289871216, gen p mean: -0.05211542919278145, mean p set: 0.4483001232147217
loss_pred:0.014343944378197193, decouple_loss:0.0013467136304825544
loss_pred:0.013946231454610825, decouple_loss:0.0012219796190038323
loss_pred:0.01437571831047535, decouple_loss:0.0012407588073983788
Iteration: 982, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44894957542419434, gen p mean: -0.0550646036863327, mean p set: 0.44942986965179443
loss_pred:0.014323127456009388, decouple_loss:0.0012938311556354165
The modified gen p mean: 0.44819584488868713, gen p mean: -0.05240553244948387, mean p set: 0.4486761689186096The modified gen p mean: 0.4483850598335266, gen p mean: -0.05259188637137413, mean p set: 0.4488653242588043
loss_pred:0.0139622176066041, decouple_loss:0.001319454750046134
loss_pred:0.014032136648893356, decouple_loss:0.0013248990289866924
Iteration: 983, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493986666202545, gen p mean: -0.054129209369421005, mean p set: 0.4498789310455322
The modified gen p mean: 0.4480119049549103, gen p mean: -0.04435090720653534, mean p set: 0.448492169380188
loss_pred:0.01389913260936737, decouple_loss:0.001352995284833014
The modified gen p mean: 0.4475438594818115, gen p mean: -0.05465054512023926, mean p set: 0.4480241537094116
loss_pred:0.014393548481166363, decouple_loss:0.0012806217418983579
loss_pred:0.01420045830309391, decouple_loss:0.0012516416609287262
Iteration: 984, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489932656288147, gen p mean: -0.0534634068608284, mean p set: 0.4494735598564148
The modified gen p mean: 0.4479416608810425, gen p mean: -0.04894024506211281, mean p set: 0.4484219551086426
loss_pred:0.014015350490808487, decouple_loss:0.0012674808967858553
loss_pred:0.013972197659313679, decouple_loss:0.0011777614708989859
The modified gen p mean: 0.4490557909011841, gen p mean: -0.05504750460386276, mean p set: 0.4495360851287842
loss_pred:0.014407923445105553, decouple_loss:0.001413587830029428
Iteration: 985, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483930170536041, gen p mean: -0.055355653166770935, mean p set: 0.4488733410835266
loss_pred:0.014182605780661106, decouple_loss:0.0013040772173553705
The modified gen p mean: 0.44813084602355957, gen p mean: -0.053482815623283386, mean p set: 0.44861117005348206The modified gen p mean: 0.4486387372016907, gen p mean: -0.049870818853378296, mean p set: 0.44911903142929077
loss_pred:0.013995234854519367, decouple_loss:0.0012502317549660802
loss_pred:0.013922270387411118, decouple_loss:0.001315250527113676
Iteration: 986, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489581286907196, gen p mean: -0.04823661595582962, mean p set: 0.4494384229183197
loss_pred:0.013582253828644753, decouple_loss:0.0013774909311905503
The modified gen p mean: 0.44788870215415955, gen p mean: -0.050381340086460114, mean p set: 0.44836896657943726The modified gen p mean: 0.4493795335292816, gen p mean: -0.054682303220033646, mean p set: 0.4498598277568817
loss_pred:0.014332358725368977, decouple_loss:0.001360364374704659
loss_pred:0.013786914758384228, decouple_loss:0.0013085633981972933
Iteration: 987, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495750963687897, gen p mean: -0.05553377792239189, mean p set: 0.45005539059638977
loss_pred:0.013768425211310387, decouple_loss:0.0011962042190134525
The modified gen p mean: 0.449386328458786, gen p mean: -0.057782500982284546, mean p set: 0.4498666524887085The modified gen p mean: 0.4491598606109619, gen p mean: -0.05298067629337311, mean p set: 0.4496401250362396
loss_pred:0.01425317395478487, decouple_loss:0.0011649483349174261
loss_pred:0.013949992135167122, decouple_loss:0.0012780949473381042
Iteration: 988, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489731192588806, gen p mean: -0.05392757058143616, mean p set: 0.4494534134864807
loss_pred:0.013544676825404167, decouple_loss:0.0011915588984265924
The modified gen p mean: 0.4473295211791992, gen p mean: -0.054165538400411606, mean p set: 0.4478098452091217The modified gen p mean: 0.4491133987903595, gen p mean: -0.05580931901931763, mean p set: 0.4495936930179596
loss_pred:0.013715707696974277, decouple_loss:0.0012173376744613051
loss_pred:0.014469836838543415, decouple_loss:0.0012057740241289139
Iteration: 989, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489569664001465, gen p mean: -0.058801356703042984, mean p set: 0.4494372606277466
loss_pred:0.013694875873625278, decouple_loss:0.0011221360182389617
The modified gen p mean: 0.4485247731208801, gen p mean: -0.05167863145470619, mean p set: 0.4490050673484802The modified gen p mean: 0.4488207697868347, gen p mean: -0.059022724628448486, mean p set: 0.4493010640144348
loss_pred:0.014043627306818962, decouple_loss:0.0011219565058127046
loss_pred:0.014289447106420994, decouple_loss:0.001227626926265657
Iteration: 990, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44924524426460266, gen p mean: -0.05598297342658043, mean p set: 0.44972550868988037
loss_pred:0.01391538791358471, decouple_loss:0.001156121026724577
The modified gen p mean: 0.4491555094718933, gen p mean: -0.0571451373398304, mean p set: 0.4496358335018158The modified gen p mean: 0.4491564631462097, gen p mean: -0.05968411639332771, mean p set: 0.4496367573738098
loss_pred:0.013561687432229519, decouple_loss:0.001124383183196187
loss_pred:0.013755370862782001, decouple_loss:0.0012033844832330942
2023-05-02 06:25:44 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.05788712948560715, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.05382860451936722, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.05357437953352928, mean p set: 0.4500633478164673
loss_pred:0.01904211938381195, decouple_loss:0.0012649245327338576
loss_pred:0.017983004450798035, decouple_loss:0.001328892307356
loss_pred:0.018018824979662895, decouple_loss:0.0012885963078588247
WV_0_PC_1_EH_0_PS_40, loss: 0.018412690609693527, avg_mse: 0.026798995211720467
current test mse: 0.026799
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012012_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012012_3_24hr.npz
NaN value num: 0
Iteration: 991, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471054971218109, gen p mean: -0.05686749145388603, mean p set: 0.447585791349411
loss_pred:0.013881963677704334, decouple_loss:0.0012244487879797816
The modified gen p mean: 0.44882553815841675, gen p mean: -0.061446815729141235, mean p set: 0.44930580258369446The modified gen p mean: 0.4465208947658539, gen p mean: -0.05831090360879898, mean p set: 0.44700121879577637
loss_pred:0.013803022913634777, decouple_loss:0.0012418051483109593loss_pred:0.01410176232457161, decouple_loss:0.001391200115904212
Iteration: 992, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470162093639374, gen p mean: -0.052622005343437195, mean p set: 0.4474965035915375
loss_pred:0.014190731570124626, decouple_loss:0.0012222526129335165
The modified gen p mean: 0.44603610038757324, gen p mean: -0.051586803048849106, mean p set: 0.44651639461517334The modified gen p mean: 0.4473579227924347, gen p mean: -0.054655011743307114, mean p set: 0.4478381872177124
loss_pred:0.014024618081748486, decouple_loss:0.0012422442669048905
loss_pred:0.01422034576535225, decouple_loss:0.001199119258671999
Iteration: 993, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4460639953613281, gen p mean: -0.04760902374982834, mean p set: 0.4465442895889282
loss_pred:0.013964984565973282, decouple_loss:0.0013365300837904215
The modified gen p mean: 0.44798222184181213, gen p mean: -0.049046944826841354, mean p set: 0.44846251606941223The modified gen p mean: 0.4471782445907593, gen p mean: -0.05229679495096207, mean p set: 0.4476585388183594
loss_pred:0.014014855027198792, decouple_loss:0.0013088195119053125
loss_pred:0.013717728666961193, decouple_loss:0.0012263390235602856
Iteration: 994, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4460238814353943, gen p mean: -0.05036577954888344, mean p set: 0.446504145860672
loss_pred:0.01392025500535965, decouple_loss:0.0012230969732627273
The modified gen p mean: 0.4476472735404968, gen p mean: -0.048586081713438034, mean p set: 0.4481275677680969The modified gen p mean: 0.44808536767959595, gen p mean: -0.048036497086286545, mean p set: 0.44856566190719604
loss_pred:0.014048486948013306, decouple_loss:0.001218749093823135
loss_pred:0.01372088585048914, decouple_loss:0.00115298037417233
Iteration: 995, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44686564803123474, gen p mean: -0.04550456255674362, mean p set: 0.4473459720611572
loss_pred:0.014076600782573223, decouple_loss:0.0011178343556821346
The modified gen p mean: 0.4469093978404999, gen p mean: -0.048560962080955505, mean p set: 0.44738972187042236The modified gen p mean: 0.44758936762809753, gen p mean: -0.047718893736600876, mean p set: 0.44806966185569763
loss_pred:0.014318508096039295, decouple_loss:0.0011978421825915575
loss_pred:0.014026742428541183, decouple_loss:0.001212164293974638
Iteration: 996, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468885660171509, gen p mean: -0.04688186198472977, mean p set: 0.447368860244751
loss_pred:0.014209112152457237, decouple_loss:0.0011574748205021024
The modified gen p mean: 0.44719478487968445, gen p mean: -0.04937395080924034, mean p set: 0.44767507910728455The modified gen p mean: 0.44802191853523254, gen p mean: -0.05312012508511543, mean p set: 0.44850221276283264
loss_pred:0.013776721432805061, decouple_loss:0.0011656904825940728
loss_pred:0.013329695910215378, decouple_loss:0.001205230364575982
Iteration: 997, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468631148338318, gen p mean: -0.04778973013162613, mean p set: 0.4473433792591095
loss_pred:0.013931390829384327, decouple_loss:0.0011546630412340164
The modified gen p mean: 0.44735151529312134, gen p mean: -0.04896140471100807, mean p set: 0.44783177971839905The modified gen p mean: 0.44670695066452026, gen p mean: -0.048761654645204544, mean p set: 0.44718724489212036
loss_pred:0.014120100997388363, decouple_loss:0.0011002529645338655
loss_pred:0.014294257387518883, decouple_loss:0.0011399596696719527
Iteration: 998, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4462994337081909, gen p mean: -0.05338582769036293, mean p set: 0.4467797577381134
loss_pred:0.014148831367492676, decouple_loss:0.0011318472679704428
The modified gen p mean: 0.44683948159217834, gen p mean: -0.053131554275751114, mean p set: 0.44731974601745605The modified gen p mean: 0.4470537006855011, gen p mean: -0.05178321152925491, mean p set: 0.4475339949131012
loss_pred:0.013653027825057507, decouple_loss:0.001132030040025711
loss_pred:0.014039825648069382, decouple_loss:0.0012187932152301073
Iteration: 999, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4461408257484436, gen p mean: -0.049228668212890625, mean p set: 0.4466211497783661
loss_pred:0.013799523934721947, decouple_loss:0.001100363559089601
The modified gen p mean: 0.4460422694683075, gen p mean: -0.050075847655534744, mean p set: 0.4465225338935852The modified gen p mean: 0.4459840655326843, gen p mean: -0.05329534783959389, mean p set: 0.4464643895626068
loss_pred:0.014013705775141716, decouple_loss:0.0010546002304181457
loss_pred:0.014008683152496815, decouple_loss:0.001120491186156869
Iteration: 1000, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44724735617637634, gen p mean: -0.05414556339383125, mean p set: 0.44772762060165405
loss_pred:0.013305415399372578, decouple_loss:0.0011205603368580341
The modified gen p mean: 0.4468706548213959, gen p mean: -0.05394647270441055, mean p set: 0.44735097885131836The modified gen p mean: 0.4484224021434784, gen p mean: -0.059490401297807693, mean p set: 0.4489026963710785
loss_pred:0.013474543578922749, decouple_loss:0.0010747566120699048
loss_pred:0.013528597541153431, decouple_loss:0.0011554897064343095
2023-05-02 06:28:16 itr: 1000
training loss: [0.01358637 0.01336144 0.01352828]
2023-05-02 06:28:16 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.055200956761837006, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.051176052540540695, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.05099496245384216, mean p set: 0.4500633478164673
loss_pred:0.01896987110376358, decouple_loss:0.0011857390636578202
loss_pred:0.01795235648751259, decouple_loss:0.0011162126902490854
loss_pred:0.017956720665097237, decouple_loss:0.0011284768115729094
WV_0_PC_1_EH_0_PS_40, loss: 0.018350157886743546, avg_mse: 0.026711909100413322
current test mse: 0.026712
Iteration: 1001, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44708243012428284, gen p mean: -0.052949458360672, mean p set: 0.4475627839565277
The modified gen p mean: 0.4470779299736023, gen p mean: -0.056731197983026505, mean p set: 0.4475582242012024
The modified gen p mean: 0.4468006491661072, gen p mean: -0.05358820781111717, mean p set: 0.4472809433937073
loss_pred:0.014146488159894943, decouple_loss:0.001149468356743455
loss_pred:0.012902597896754742, decouple_loss:0.0010868387762457132
loss_pred:0.013217209838330746, decouple_loss:0.0011001315433532
Iteration: 1002, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469147026538849, gen p mean: -0.04926581308245659, mean p set: 0.447394996881485
loss_pred:0.013874462805688381, decouple_loss:0.0011495401849970222
The modified gen p mean: 0.4473232924938202, gen p mean: -0.05306084454059601, mean p set: 0.4478035867214203The modified gen p mean: 0.44653886556625366, gen p mean: -0.04965047538280487, mean p set: 0.44701918959617615
loss_pred:0.01397656835615635, decouple_loss:0.0011245086789131165
loss_pred:0.01368778944015503, decouple_loss:0.0011817042250186205
Iteration: 1003, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478108584880829, gen p mean: -0.04876568913459778, mean p set: 0.44829118251800537
loss_pred:0.013794992119073868, decouple_loss:0.0011868566507473588
The modified gen p mean: 0.44709211587905884, gen p mean: -0.04823384806513786, mean p set: 0.4475724399089813The modified gen p mean: 0.4472261667251587, gen p mean: -0.04582950845360756, mean p set: 0.4477064609527588
loss_pred:0.013788270764052868, decouple_loss:0.001187762594781816
loss_pred:0.013428958132863045, decouple_loss:0.0011364761739969254
Iteration: 1004, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446971595287323, gen p mean: -0.04691344499588013, mean p set: 0.4474518895149231
loss_pred:0.01373126171529293, decouple_loss:0.001107881311327219
The modified gen p mean: 0.4471133053302765, gen p mean: -0.05055325850844383, mean p set: 0.447593629360199The modified gen p mean: 0.44676217436790466, gen p mean: -0.048244889825582504, mean p set: 0.44724246859550476
loss_pred:0.013625191524624825, decouple_loss:0.0011449471348896623
loss_pred:0.013623914681375027, decouple_loss:0.0010682508582249284
Iteration: 1005, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4458525478839874, gen p mean: -0.05046955868601799, mean p set: 0.4463328719139099
loss_pred:0.013744410127401352, decouple_loss:0.001124948845244944
The modified gen p mean: 0.44733887910842896, gen p mean: -0.05000980198383331, mean p set: 0.44781920313835144The modified gen p mean: 0.4469561278820038, gen p mean: -0.04736717417836189, mean p set: 0.4474363923072815
loss_pred:0.014105581678450108, decouple_loss:0.0011873963521793485
loss_pred:0.013718683272600174, decouple_loss:0.0012108513619750738
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1006, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478234350681305, gen p mean: -0.04854320362210274, mean p set: 0.4483036994934082
loss_pred:0.01324869878590107, decouple_loss:0.0011579344281926751
The modified gen p mean: 0.4471958875656128, gen p mean: -0.052060388028621674, mean p set: 0.4476762115955353The modified gen p mean: 0.44654273986816406, gen p mean: -0.050956543534994125, mean p set: 0.44702303409576416
loss_pred:0.013574285432696342, decouple_loss:0.0010719799902290106
loss_pred:0.013863736763596535, decouple_loss:0.0012428693007677794
Iteration: 1007, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44609978795051575, gen p mean: -0.04646541178226471, mean p set: 0.44658011198043823
loss_pred:0.014034435153007507, decouple_loss:0.00111256237141788
The modified gen p mean: 0.4467619061470032, gen p mean: -0.051549021154642105, mean p set: 0.44724223017692566The modified gen p mean: 0.44785261154174805, gen p mean: -0.052534639835357666, mean p set: 0.44833290576934814
loss_pred:0.0137535585090518, decouple_loss:0.0010834448039531708
loss_pred:0.013861221261322498, decouple_loss:0.001149405026808381
Iteration: 1008, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44771742820739746, gen p mean: -0.049652550369501114, mean p set: 0.44819772243499756
loss_pred:0.014315081760287285, decouple_loss:0.0011355102760717273
The modified gen p mean: 0.4480898678302765, gen p mean: -0.052322085946798325, mean p set: 0.448570191860199The modified gen p mean: 0.4469614624977112, gen p mean: -0.0504932776093483, mean p set: 0.4474417567253113
loss_pred:0.013953540474176407, decouple_loss:0.001039853086695075
loss_pred:0.013704401440918446, decouple_loss:0.0011521534761413932
Iteration: 1009, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44670340418815613, gen p mean: -0.04773131012916565, mean p set: 0.4471836984157562
loss_pred:0.013925470411777496, decouple_loss:0.001136906910687685
The modified gen p mean: 0.4462510943412781, gen p mean: -0.047363147139549255, mean p set: 0.44673141837120056The modified gen p mean: 0.447511225938797, gen p mean: -0.04655248299241066, mean p set: 0.4479915201663971
loss_pred:0.014376204460859299, decouple_loss:0.0011131238425150514
loss_pred:0.013296817429363728, decouple_loss:0.0012160961050540209
Iteration: 1010, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4461708962917328, gen p mean: -0.04401065409183502, mean p set: 0.4466512203216553
loss_pred:0.014214889146387577, decouple_loss:0.0011516386875882745
The modified gen p mean: 0.44644370675086975, gen p mean: -0.04687206819653511, mean p set: 0.44692397117614746The modified gen p mean: 0.4469868242740631, gen p mean: -0.04932253435254097, mean p set: 0.4474670886993408
loss_pred:0.013759606517851353, decouple_loss:0.001198826008476317
loss_pred:0.01348603144288063, decouple_loss:0.001121200853958726
2023-05-02 06:30:11 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.04670353978872299, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.0430445559322834, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04288123548030853, mean p set: 0.4500633478164673
loss_pred:0.019059713929891586, decouple_loss:0.0011574594536796212
loss_pred:0.017943020910024643, decouple_loss:0.0010918434709310532
loss_pred:0.018017489463090897, decouple_loss:0.0011060532415285707
WV_0_PC_1_EH_0_PS_40, loss: 0.01839599758386612, avg_mse: 0.0268046073615551
current test mse: 0.026805
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012014_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012014_3_24hr.npz
NaN value num: 0
Iteration: 1011, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45019152760505676, gen p mean: -0.037655964493751526, mean p set: 0.45067182183265686
loss_pred:0.015968214720487595, decouple_loss:0.0010856755543500185
The modified gen p mean: 0.4501833915710449, gen p mean: -0.03729163855314255, mean p set: 0.450663685798645The modified gen p mean: 0.44946563243865967, gen p mean: -0.03865319862961769, mean p set: 0.4499458968639374
loss_pred:0.015783580020070076, decouple_loss:0.001186526264064014
loss_pred:0.017175152897834778, decouple_loss:0.0011339901247993112
Iteration: 1012, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4518488347530365, gen p mean: -0.03445208817720413, mean p set: 0.4523291289806366
loss_pred:0.016930479556322098, decouple_loss:0.0012525721685960889
The modified gen p mean: 0.45081618428230286, gen p mean: -0.030621645972132683, mean p set: 0.45129647850990295The modified gen p mean: 0.45051509141921997, gen p mean: -0.037163808941841125, mean p set: 0.45099538564682007
loss_pred:0.016069907695055008, decouple_loss:0.001122058485634625
loss_pred:0.016646364703774452, decouple_loss:0.0011382391676306725
Iteration: 1013, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.452470064163208, gen p mean: -0.03499000146985054, mean p set: 0.4529503583908081
loss_pred:0.01678403653204441, decouple_loss:0.001119405496865511
The modified gen p mean: 0.4489746391773224, gen p mean: -0.034131526947021484, mean p set: 0.4494549334049225The modified gen p mean: 0.449428915977478, gen p mean: -0.03567245230078697, mean p set: 0.4499092102050781
loss_pred:0.01572609320282936, decouple_loss:0.0011697805020958185
loss_pred:0.01675877347588539, decouple_loss:0.0011643781326711178
Iteration: 1014, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4522462785243988, gen p mean: -0.03906064108014107, mean p set: 0.4527266025543213
loss_pred:0.017110969871282578, decouple_loss:0.0012213067384436727
The modified gen p mean: 0.44825175404548645, gen p mean: -0.03980265557765961, mean p set: 0.44873207807540894The modified gen p mean: 0.4483395516872406, gen p mean: -0.0368308424949646, mean p set: 0.4488198161125183
loss_pred:0.016515284776687622, decouple_loss:0.0011791938450187445
loss_pred:0.017099108546972275, decouple_loss:0.001151124364696443
Iteration: 1015, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489809274673462, gen p mean: -0.04437411576509476, mean p set: 0.4494612514972687
loss_pred:0.016762321814894676, decouple_loss:0.0012137473095208406
The modified gen p mean: 0.44933462142944336, gen p mean: -0.040022581815719604, mean p set: 0.44981491565704346The modified gen p mean: 0.449812114238739, gen p mean: -0.043919291347265244, mean p set: 0.4502924084663391
loss_pred:0.017496194690465927, decouple_loss:0.0012108988594263792
loss_pred:0.016452405601739883, decouple_loss:0.0012154970318078995
Iteration: 1016, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45023342967033386, gen p mean: -0.047183625400066376, mean p set: 0.45071372389793396
loss_pred:0.01605604588985443, decouple_loss:0.0010708404006436467
The modified gen p mean: 0.44875484704971313, gen p mean: -0.04665907844901085, mean p set: 0.44923514127731323The modified gen p mean: 0.44875380396842957, gen p mean: -0.04603442922234535, mean p set: 0.4492340683937073
loss_pred:0.01701236702501774, decouple_loss:0.001130828633904457
loss_pred:0.017177512869238853, decouple_loss:0.001170631730929017
Iteration: 1017, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489710330963135, gen p mean: -0.049907978624105453, mean p set: 0.4494513273239136
loss_pred:0.01667076349258423, decouple_loss:0.0012703778920695186
The modified gen p mean: 0.4510181248188019, gen p mean: -0.044044721871614456, mean p set: 0.45149844884872437The modified gen p mean: 0.4500284194946289, gen p mean: -0.050093140453100204, mean p set: 0.450508713722229
loss_pred:0.015293649397790432, decouple_loss:0.0011958484537899494
loss_pred:0.016139205545186996, decouple_loss:0.0012157383607700467
Iteration: 1018, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44902458786964417, gen p mean: -0.04990120604634285, mean p set: 0.4495048522949219
loss_pred:0.016708504408597946, decouple_loss:0.0012717192294076085
The modified gen p mean: 0.44906073808670044, gen p mean: -0.04888312146067619, mean p set: 0.44954103231430054The modified gen p mean: 0.4484897255897522, gen p mean: -0.05073331668972969, mean p set: 0.4489700198173523
loss_pred:0.01661190576851368, decouple_loss:0.0013546869158744812
loss_pred:0.016186904162168503, decouple_loss:0.001381642883643508
Iteration: 1019, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482707977294922, gen p mean: -0.045477814972400665, mean p set: 0.4487510621547699
loss_pred:0.016880962997674942, decouple_loss:0.0012283930554986
The modified gen p mean: 0.4523509442806244, gen p mean: -0.04497404024004936, mean p set: 0.4528312385082245The modified gen p mean: 0.4490300416946411, gen p mean: -0.04740670323371887, mean p set: 0.4495103359222412
loss_pred:0.015739284455776215, decouple_loss:0.0011629331856966019
loss_pred:0.016434768214821815, decouple_loss:0.0012963220942765474
Iteration: 1020, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448906809091568, gen p mean: -0.04381561651825905, mean p set: 0.4493871033191681
loss_pred:0.01594318076968193, decouple_loss:0.00119096040725708
The modified gen p mean: 0.4494486451148987, gen p mean: -0.047397252172231674, mean p set: 0.4499289393424988The modified gen p mean: 0.4494033455848694, gen p mean: -0.044227346777915955, mean p set: 0.4498836100101471
loss_pred:0.016202377155423164, decouple_loss:0.0011961120180785656
loss_pred:0.016864653676748276, decouple_loss:0.0012736619682982564
2023-05-02 06:32:51 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.051764003932476044, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04769701138138771, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04775915667414665, mean p set: 0.4500633478164673
loss_pred:0.018604779615998268, decouple_loss:0.0014142878353595734
loss_pred:0.017549730837345123, decouple_loss:0.0013162230607122183
loss_pred:0.017598547041416168, decouple_loss:0.0013432061532512307
WV_0_PC_1_EH_0_PS_40, loss: 0.01798558235168457, avg_mse: 0.02593647688627243
current test mse: 0.025936
Iteration: 1021, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497763216495514, gen p mean: -0.04715615138411522, mean p set: 0.4502566158771515
The modified gen p mean: 0.44973310828208923, gen p mean: -0.04579039290547371, mean p set: 0.4502134323120117
The modified gen p mean: 0.4490131735801697, gen p mean: -0.040489744395017624, mean p set: 0.4494934380054474
loss_pred:0.016164015978574753, decouple_loss:0.0012411137577146292
loss_pred:0.016861921176314354, decouple_loss:0.0013757376000285149
loss_pred:0.015968898311257362, decouple_loss:0.0012251009466126561
Iteration: 1022, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44990232586860657, gen p mean: -0.04375532269477844, mean p set: 0.45038262009620667
The modified gen p mean: 0.44969624280929565, gen p mean: -0.04429788514971733, mean p set: 0.45017653703689575loss_pred:0.01604481413960457, decouple_loss:0.001124172704294324
The modified gen p mean: 0.44814273715019226, gen p mean: -0.0457226000726223, mean p set: 0.44862303137779236
loss_pred:0.01605873368680477, decouple_loss:0.0011648957151919603
loss_pred:0.016523554921150208, decouple_loss:0.0012613332364708185
Iteration: 1023, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490867257118225, gen p mean: -0.046299807727336884, mean p set: 0.449567049741745
loss_pred:0.016846664249897003, decouple_loss:0.0011160969734191895
The modified gen p mean: 0.44812560081481934, gen p mean: -0.052486639469861984, mean p set: 0.44860586524009705The modified gen p mean: 0.4493236839771271, gen p mean: -0.04730021581053734, mean p set: 0.4498039484024048
loss_pred:0.016367940232157707, decouple_loss:0.0011285435175523162
loss_pred:0.016911063343286514, decouple_loss:0.0011926298029720783
Iteration: 1024, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45186713337898254, gen p mean: -0.04730916768312454, mean p set: 0.45234742760658264
loss_pred:0.01564735174179077, decouple_loss:0.001116483355872333
The modified gen p mean: 0.4506288766860962, gen p mean: -0.04837231710553169, mean p set: 0.4511091411113739The modified gen p mean: 0.4509003162384033, gen p mean: -0.04769657552242279, mean p set: 0.4513806104660034
loss_pred:0.016051461920142174, decouple_loss:0.0011862963438034058
loss_pred:0.016018740832805634, decouple_loss:0.0012206619139760733
Iteration: 1025, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513009190559387, gen p mean: -0.04583122208714485, mean p set: 0.4517812132835388
loss_pred:0.01634308136999607, decouple_loss:0.0010794515255838633
The modified gen p mean: 0.45175954699516296, gen p mean: -0.045808061957359314, mean p set: 0.45223987102508545The modified gen p mean: 0.4486936330795288, gen p mean: -0.047423314303159714, mean p set: 0.4491738975048065
loss_pred:0.015706973150372505, decouple_loss:0.0011081669945269823
loss_pred:0.01641944795846939, decouple_loss:0.0012095073470845819
Iteration: 1026, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45149093866348267, gen p mean: -0.05066477507352829, mean p set: 0.45197123289108276
loss_pred:0.017234859988093376, decouple_loss:0.0011804334353655577
The modified gen p mean: 0.44966378808021545, gen p mean: -0.05250163748860359, mean p set: 0.45014408230781555The modified gen p mean: 0.44900038838386536, gen p mean: -0.05131998658180237, mean p set: 0.44948065280914307
loss_pred:0.01657310500741005, decouple_loss:0.0014209288638085127
loss_pred:0.01638811081647873, decouple_loss:0.001351589453406632
Iteration: 1027, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484437108039856, gen p mean: -0.053356822580099106, mean p set: 0.4489240050315857
loss_pred:0.01624506153166294, decouple_loss:0.0012399534462019801
The modified gen p mean: 0.4508685767650604, gen p mean: -0.04425770416855812, mean p set: 0.4513488709926605The modified gen p mean: 0.44838154315948486, gen p mean: -0.05219676345586777, mean p set: 0.44886186718940735
loss_pred:0.016462307423353195, decouple_loss:0.001265566679649055
loss_pred:0.016261622309684753, decouple_loss:0.001141793909482658
Iteration: 1028, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487544596195221, gen p mean: -0.05034290999174118, mean p set: 0.4492347836494446
loss_pred:0.016051869839429855, decouple_loss:0.00108684366568923
The modified gen p mean: 0.4502730667591095, gen p mean: -0.05372604355216026, mean p set: 0.4507533609867096The modified gen p mean: 0.4495542049407959, gen p mean: -0.05091628432273865, mean p set: 0.4500344693660736
loss_pred:0.01587735302746296, decouple_loss:0.001047657453455031
loss_pred:0.016957465559244156, decouple_loss:0.0011306606465950608
Iteration: 1029, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44963744282722473, gen p mean: -0.05248131975531578, mean p set: 0.45011773705482483
loss_pred:0.017107199877500534, decouple_loss:0.0011440784437581897
The modified gen p mean: 0.4490962624549866, gen p mean: -0.052798792719841, mean p set: 0.4495765268802643The modified gen p mean: 0.44761693477630615, gen p mean: -0.05364885926246643, mean p set: 0.44809725880622864
loss_pred:0.016450345516204834, decouple_loss:0.0011352188885211945
loss_pred:0.016522116959095, decouple_loss:0.0012378868414089084
Iteration: 1030, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450116902589798, gen p mean: -0.049805138260126114, mean p set: 0.45059719681739807
loss_pred:0.015525988303124905, decouple_loss:0.0011322370264679193
The modified gen p mean: 0.45069873332977295, gen p mean: -0.04499703273177147, mean p set: 0.45117899775505066The modified gen p mean: 0.44789403676986694, gen p mean: -0.05461585521697998, mean p set: 0.44837433099746704
loss_pred:0.01592826470732689, decouple_loss:0.0011426322162151337
loss_pred:0.016185231506824493, decouple_loss:0.0010741633595898747
2023-05-02 06:34:45 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.05626139044761658, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.051867641508579254, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.052152905613183975, mean p set: 0.4500633478164673
loss_pred:0.018627217039465904, decouple_loss:0.0013290934730321169
loss_pred:0.017550498247146606, decouple_loss:0.0012930314987897873
loss_pred:0.017667220905423164, decouple_loss:0.0012988090747967362
WV_0_PC_1_EH_0_PS_40, loss: 0.018013663589954376, avg_mse: 0.026010317727923393
current test mse: 0.02601
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012017_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012017_3_24hr.npz
NaN value num: 0
Iteration: 1031, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489613473415375, gen p mean: -0.05432407185435295, mean p set: 0.4494416415691376
loss_pred:0.01799272932112217, decouple_loss:0.0012099698651582003
The modified gen p mean: 0.447767436504364, gen p mean: -0.05341450870037079, mean p set: 0.4482477605342865The modified gen p mean: 0.44838833808898926, gen p mean: -0.04684682935476303, mean p set: 0.44886863231658936
loss_pred:0.017718547955155373, decouple_loss:0.001270092325285077
loss_pred:0.017478113994002342, decouple_loss:0.00138389365747571
Iteration: 1032, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476719796657562, gen p mean: -0.05595548823475838, mean p set: 0.4481523036956787
loss_pred:0.01754871755838394, decouple_loss:0.0012440872378647327
The modified gen p mean: 0.44767841696739197, gen p mean: -0.05721757933497429, mean p set: 0.44815871119499207The modified gen p mean: 0.4480712413787842, gen p mean: -0.054643869400024414, mean p set: 0.44855156540870667
loss_pred:0.017535636201500893, decouple_loss:0.0011982677970081568
loss_pred:0.016845712438225746, decouple_loss:0.001207074848935008
Iteration: 1033, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44756460189819336, gen p mean: -0.04601426050066948, mean p set: 0.44804492592811584
loss_pred:0.017580391839146614, decouple_loss:0.0010470581473782659
The modified gen p mean: 0.4477475881576538, gen p mean: -0.05107450485229492, mean p set: 0.4482278525829315The modified gen p mean: 0.44836854934692383, gen p mean: -0.05011672526597977, mean p set: 0.4488488733768463
loss_pred:0.017577389255166054, decouple_loss:0.0010745105100795627
loss_pred:0.01771332137286663, decouple_loss:0.0011132394429296255
Iteration: 1034, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469981789588928, gen p mean: -0.04889972507953644, mean p set: 0.4474784731864929
loss_pred:0.01761821284890175, decouple_loss:0.0011604884639382362
The modified gen p mean: 0.4473387598991394, gen p mean: -0.04372703656554222, mean p set: 0.4478190541267395The modified gen p mean: 0.4474430978298187, gen p mean: -0.044031158089637756, mean p set: 0.44792336225509644
loss_pred:0.017592506483197212, decouple_loss:0.0011551055358722806
loss_pred:0.017439579591155052, decouple_loss:0.0012139853788539767
Iteration: 1035, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44760873913764954, gen p mean: -0.05035367235541344, mean p set: 0.44808903336524963
loss_pred:0.017337478697299957, decouple_loss:0.0011787628754973412
The modified gen p mean: 0.44850581884384155, gen p mean: -0.0449904128909111, mean p set: 0.44898611307144165The modified gen p mean: 0.44729775190353394, gen p mean: -0.045216239988803864, mean p set: 0.44777801632881165
loss_pred:0.017345502972602844, decouple_loss:0.0011172681115567684
loss_pred:0.01787305250763893, decouple_loss:0.0011347271502017975
Iteration: 1036, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478350579738617, gen p mean: -0.04796677827835083, mean p set: 0.4483153223991394
loss_pred:0.01743915118277073, decouple_loss:0.001129818963818252
The modified gen p mean: 0.4486573338508606, gen p mean: -0.04496397078037262, mean p set: 0.4491376578807831The modified gen p mean: 0.44737720489501953, gen p mean: -0.050680965185165405, mean p set: 0.44785749912261963
loss_pred:0.018090739846229553, decouple_loss:0.0011219498701393604
loss_pred:0.01784365065395832, decouple_loss:0.0010743836173787713
Iteration: 1037, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488667845726013, gen p mean: -0.05235041677951813, mean p set: 0.4493470788002014
loss_pred:0.017145244404673576, decouple_loss:0.0010776574490591884
The modified gen p mean: 0.4475162625312805, gen p mean: -0.050929855555295944, mean p set: 0.447996586561203The modified gen p mean: 0.44886964559555054, gen p mean: -0.05074380710721016, mean p set: 0.449349969625473
loss_pred:0.017702827230095863, decouple_loss:0.0010749344946816564
loss_pred:0.01678447425365448, decouple_loss:0.001165967434644699
Iteration: 1038, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485129415988922, gen p mean: -0.05289776250720024, mean p set: 0.4489932656288147
loss_pred:0.016884952783584595, decouple_loss:0.00115727458614856
The modified gen p mean: 0.44823214411735535, gen p mean: -0.052081599831581116, mean p set: 0.44871240854263306The modified gen p mean: 0.4474294185638428, gen p mean: -0.046210967004299164, mean p set: 0.4479096829891205
loss_pred:0.017599202692508698, decouple_loss:0.001127133029513061
loss_pred:0.018126510083675385, decouple_loss:0.0011226622154936194
Iteration: 1039, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472518265247345, gen p mean: -0.051621824502944946, mean p set: 0.4477321207523346
loss_pred:0.01808430254459381, decouple_loss:0.0010522574884817004
The modified gen p mean: 0.4482339322566986, gen p mean: -0.0527954027056694, mean p set: 0.4487142562866211The modified gen p mean: 0.44755542278289795, gen p mean: -0.0563148632645607, mean p set: 0.44803571701049805
loss_pred:0.01754615642130375, decouple_loss:0.0009817829122766852
loss_pred:0.016978144645690918, decouple_loss:0.0011522147106006742
Iteration: 1040, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474272131919861, gen p mean: -0.049453020095825195, mean p set: 0.4479075074195862
loss_pred:0.017738914117217064, decouple_loss:0.0010367111535742879
The modified gen p mean: 0.44795748591423035, gen p mean: -0.05260062217712402, mean p set: 0.44843775033950806The modified gen p mean: 0.44846925139427185, gen p mean: -0.05428570136427879, mean p set: 0.44894954562187195
loss_pred:0.01740243099629879, decouple_loss:0.0011533615179359913
loss_pred:0.017232507467269897, decouple_loss:0.0010538388742133975
2023-05-02 06:37:12 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.055407434701919556, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.05140173062682152, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.05161978304386139, mean p set: 0.4500633478164673
loss_pred:0.01825365610420704, decouple_loss:0.0010719848796725273
loss_pred:0.01724274456501007, decouple_loss:0.001027777441777289
loss_pred:0.017347076907753944, decouple_loss:0.0010618044761940837
WV_0_PC_1_EH_0_PS_40, loss: 0.01766718551516533, avg_mse: 0.02534300833940506
current test mse: 0.025343
Iteration: 1041, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479679763317108, gen p mean: -0.05551540479063988, mean p set: 0.4484483003616333
The modified gen p mean: 0.44800901412963867, gen p mean: -0.053145330399274826, mean p set: 0.44848933815956116
The modified gen p mean: 0.4476569592952728, gen p mean: -0.05406113713979721, mean p set: 0.4481372833251953
loss_pred:0.0170180294662714, decouple_loss:0.0010491865687072277
loss_pred:0.017259707674384117, decouple_loss:0.0010280030546709895
loss_pred:0.018138393759727478, decouple_loss:0.0010106639238074422
Iteration: 1042, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44815874099731445, gen p mean: -0.05713639035820961, mean p set: 0.44863903522491455
loss_pred:0.017262622714042664, decouple_loss:0.0010268008336424828
The modified gen p mean: 0.44805869460105896, gen p mean: -0.05604647845029831, mean p set: 0.44853898882865906The modified gen p mean: 0.4473279118537903, gen p mean: -0.05562816560268402, mean p set: 0.4478082060813904
loss_pred:0.017605405300855637, decouple_loss:0.0010935699101537466
loss_pred:0.01755969040095806, decouple_loss:0.0010128786088898778
Iteration: 1043, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478950798511505, gen p mean: -0.05975015088915825, mean p set: 0.4483753740787506
loss_pred:0.016203083097934723, decouple_loss:0.0010818266309797764
The modified gen p mean: 0.44846978783607483, gen p mean: -0.05843505263328552, mean p set: 0.44895002245903015
The modified gen p mean: 0.44726303219795227, gen p mean: -0.05260976776480675, mean p set: 0.44774329662323
loss_pred:0.017257146537303925, decouple_loss:0.0010834143031388521
loss_pred:0.017587976530194283, decouple_loss:0.0009794262005016208
Iteration: 1044, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470137655735016, gen p mean: -0.05303426831960678, mean p set: 0.4474940896034241
The modified gen p mean: 0.44846218824386597, gen p mean: -0.05541649088263512, mean p set: 0.44894248247146606
The modified gen p mean: 0.447792649269104, gen p mean: -0.054665032774209976, mean p set: 0.4482729434967041
loss_pred:0.017578495666384697, decouple_loss:0.0011779622873291373
loss_pred:0.01699134334921837, decouple_loss:0.0011684094788506627
loss_pred:0.017860669642686844, decouple_loss:0.0010898036416620016
Iteration: 1045, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475019872188568, gen p mean: -0.05155695974826813, mean p set: 0.4479822516441345
loss_pred:0.01764599420130253, decouple_loss:0.001248421729542315
The modified gen p mean: 0.44836103916168213, gen p mean: -0.052764490246772766, mean p set: 0.4488413631916046The modified gen p mean: 0.4483512341976166, gen p mean: -0.05713772773742676, mean p set: 0.44883155822753906
loss_pred:0.017605703324079514, decouple_loss:0.0012761744437739253
loss_pred:0.017590634524822235, decouple_loss:0.0012388555333018303
Iteration: 1046, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447937935590744, gen p mean: -0.050411406904459, mean p set: 0.44841820001602173
loss_pred:0.016659080982208252, decouple_loss:0.0011613478418439627
The modified gen p mean: 0.4484626352787018, gen p mean: -0.04800645262002945, mean p set: 0.44894295930862427The modified gen p mean: 0.4490114450454712, gen p mean: -0.053662609308958054, mean p set: 0.44949179887771606
loss_pred:0.016658779233694077, decouple_loss:0.001128035830333829
loss_pred:0.017512861639261246, decouple_loss:0.0012356978841125965
Iteration: 1047, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475322663784027, gen p mean: -0.04404270648956299, mean p set: 0.4480125904083252
loss_pred:0.017326952889561653, decouple_loss:0.0012979521416127682
The modified gen p mean: 0.4477936327457428, gen p mean: -0.043708983808755875, mean p set: 0.4482739567756653The modified gen p mean: 0.44819241762161255, gen p mean: -0.039733920246362686, mean p set: 0.44867268204689026
loss_pred:0.01748048886656761, decouple_loss:0.0013983509270474315
loss_pred:0.017362752929329872, decouple_loss:0.0012618101900443435
Iteration: 1048, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44839388132095337, gen p mean: -0.0472857728600502, mean p set: 0.44887417554855347
loss_pred:0.016925424337387085, decouple_loss:0.001061605871655047
The modified gen p mean: 0.44765704870224, gen p mean: -0.04791427031159401, mean p set: 0.4481373429298401The modified gen p mean: 0.44797033071517944, gen p mean: -0.04672021418809891, mean p set: 0.44845062494277954
loss_pred:0.016553238034248352, decouple_loss:0.0011474468046799302
loss_pred:0.017212623730301857, decouple_loss:0.0011750945122912526
Iteration: 1049, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489119350910187, gen p mean: -0.05425412580370903, mean p set: 0.4493922293186188
loss_pred:0.017186803743243217, decouple_loss:0.0012147007510066032
The modified gen p mean: 0.44849756360054016, gen p mean: -0.048663560301065445, mean p set: 0.44897785782814026The modified gen p mean: 0.44793975353240967, gen p mean: -0.05077332630753517, mean p set: 0.44842007756233215
loss_pred:0.017350049689412117, decouple_loss:0.0011597172124311328
loss_pred:0.017034882679581642, decouple_loss:0.0011403887765482068
Iteration: 1050, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480228126049042, gen p mean: -0.05026036873459816, mean p set: 0.4485030770301819
loss_pred:0.01687037944793701, decouple_loss:0.001205481356009841
The modified gen p mean: 0.4482516348361969, gen p mean: -0.05084393545985222, mean p set: 0.4487318992614746The modified gen p mean: 0.4476771950721741, gen p mean: -0.0528685636818409, mean p set: 0.44815748929977417
loss_pred:0.01774454675614834, decouple_loss:0.0010755761759355664
loss_pred:0.017520621418952942, decouple_loss:0.001019823714159429
2023-05-02 06:39:05 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.057425014674663544, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.053052809089422226, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.053238049149513245, mean p set: 0.4500633478164673
loss_pred:0.018220094963908195, decouple_loss:0.0012346659786999226
loss_pred:0.017285209149122238, decouple_loss:0.0010927601251751184
loss_pred:0.017249731346964836, decouple_loss:0.0011085030855610967
WV_0_PC_1_EH_0_PS_40, loss: 0.017642278224229813, avg_mse: 0.025301983579993248
current test mse: 0.025302
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012001_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012001_3_24hr.npz
NaN value num: 0
Iteration: 1051, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504612982273102, gen p mean: -0.053013917058706284, mean p set: 0.4509415924549103
loss_pred:0.015763450413942337, decouple_loss:0.0011569301132112741
The modified gen p mean: 0.45045655965805054, gen p mean: -0.04846567288041115, mean p set: 0.45093685388565063The modified gen p mean: 0.4510978162288666, gen p mean: -0.05247047543525696, mean p set: 0.4515781104564667
loss_pred:0.016502726823091507, decouple_loss:0.0011203852482140064
loss_pred:0.01624068059027195, decouple_loss:0.001192197436466813
Iteration: 1052, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502004384994507, gen p mean: -0.04745091125369072, mean p set: 0.4506807327270508
loss_pred:0.01584571786224842, decouple_loss:0.001036795205436647
The modified gen p mean: 0.44800224900245667, gen p mean: -0.05579867959022522, mean p set: 0.44848257303237915The modified gen p mean: 0.4500531256198883, gen p mean: -0.05155593529343605, mean p set: 0.4505334198474884
loss_pred:0.015892094001173973, decouple_loss:0.0010800109012052417
loss_pred:0.015340040437877178, decouple_loss:0.0009905800689011812
Iteration: 1053, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44832876324653625, gen p mean: -0.05470917373895645, mean p set: 0.44880905747413635
loss_pred:0.015806160867214203, decouple_loss:0.001097836415283382
The modified gen p mean: 0.44881415367126465, gen p mean: -0.04900970309972763, mean p set: 0.44929447770118713
The modified gen p mean: 0.4477993845939636, gen p mean: -0.05483262240886688, mean p set: 0.4482796788215637
loss_pred:0.015421640127897263, decouple_loss:0.0010523819364607334
loss_pred:0.01600244641304016, decouple_loss:0.0010063039371743798
Iteration: 1054, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45037880539894104, gen p mean: -0.04445871710777283, mean p set: 0.45085906982421875
loss_pred:0.015968013554811478, decouple_loss:0.001006496837362647
The modified gen p mean: 0.45157793164253235, gen p mean: -0.046979378908872604, mean p set: 0.45205825567245483The modified gen p mean: 0.44996246695518494, gen p mean: -0.047187965363264084, mean p set: 0.45044276118278503
loss_pred:0.01598697155714035, decouple_loss:0.0010917807230725884
loss_pred:0.01548632699996233, decouple_loss:0.0009953504195436835
Iteration: 1055, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448527067899704, gen p mean: -0.045905325561761856, mean p set: 0.44900739192962646
loss_pred:0.015973487868905067, decouple_loss:0.0010946468682959676
The modified gen p mean: 0.4486495554447174, gen p mean: -0.042991820722818375, mean p set: 0.4491298198699951The modified gen p mean: 0.4507182240486145, gen p mean: -0.051253028213977814, mean p set: 0.4511985182762146
loss_pred:0.015563730150461197, decouple_loss:0.001120227389037609
loss_pred:0.015678362920880318, decouple_loss:0.0012328424490988255
Iteration: 1056, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450158029794693, gen p mean: -0.040474142879247665, mean p set: 0.4506383240222931
loss_pred:0.01566697098314762, decouple_loss:0.0011060518445447087
The modified gen p mean: 0.4515479505062103, gen p mean: -0.046889085322618484, mean p set: 0.4520282447338104The modified gen p mean: 0.45187345147132874, gen p mean: -0.04845760017633438, mean p set: 0.45235374569892883
loss_pred:0.015511308796703815, decouple_loss:0.0010656240629032254
loss_pred:0.015617352910339832, decouple_loss:0.0010484716622158885
Iteration: 1057, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.451168417930603, gen p mean: -0.0415060929954052, mean p set: 0.4516487121582031
loss_pred:0.016060516238212585, decouple_loss:0.0011439388617873192
The modified gen p mean: 0.44808316230773926, gen p mean: -0.047240640968084335, mean p set: 0.44856342673301697The modified gen p mean: 0.45060259103775024, gen p mean: -0.04077311232686043, mean p set: 0.45108291506767273
loss_pred:0.015822090208530426, decouple_loss:0.0010683375876396894
loss_pred:0.015367901884019375, decouple_loss:0.0010029386030510068
Iteration: 1058, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45089951157569885, gen p mean: -0.04804674908518791, mean p set: 0.45137983560562134
loss_pred:0.01555367186665535, decouple_loss:0.0015466287732124329
The modified gen p mean: 0.4497433304786682, gen p mean: -0.04091916233301163, mean p set: 0.4502235949039459The modified gen p mean: 0.45025596022605896, gen p mean: -0.045753370970487595, mean p set: 0.45073628425598145
loss_pred:0.015822883695364, decouple_loss:0.0011111501371487975
loss_pred:0.015753451734781265, decouple_loss:0.0010471451096236706
Iteration: 1059, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44978296756744385, gen p mean: -0.045937150716781616, mean p set: 0.45026326179504395
loss_pred:0.01589299365878105, decouple_loss:0.0011322060599923134
The modified gen p mean: 0.4509420394897461, gen p mean: -0.04906369745731354, mean p set: 0.4514223337173462The modified gen p mean: 0.44979265332221985, gen p mean: -0.04355401545763016, mean p set: 0.45027294754981995
loss_pred:0.015698017552495003, decouple_loss:0.001109438599087298
loss_pred:0.01570500060915947, decouple_loss:0.0011672195978462696
Iteration: 1060, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494893252849579, gen p mean: -0.049140509217977524, mean p set: 0.449969619512558
loss_pred:0.016219286248087883, decouple_loss:0.0011823062086477876
The modified gen p mean: 0.45109590888023376, gen p mean: -0.04720138758420944, mean p set: 0.45157620310783386The modified gen p mean: 0.4483596086502075, gen p mean: -0.04823119565844536, mean p set: 0.44883993268013
loss_pred:0.015980137512087822, decouple_loss:0.0011421027593314648
loss_pred:0.015210769139230251, decouple_loss:0.0011715595610439777
2023-05-02 06:41:36 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.06007787957787514, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.055491719394922256, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.05600103735923767, mean p set: 0.4500633478164673
loss_pred:0.018506936728954315, decouple_loss:0.0011818143539130688
loss_pred:0.01749151386320591, decouple_loss:0.0011160117574036121loss_pred:0.017521770671010017, decouple_loss:0.0010914854938164353
WV_0_PC_1_EH_0_PS_40, loss: 0.017896562814712524, avg_mse: 0.025769134983420372
current test mse: 0.025769
Iteration: 1061, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480987787246704, gen p mean: -0.0577143132686615, mean p set: 0.4485791027545929
The modified gen p mean: 0.4492226541042328, gen p mean: -0.05642027035355568, mean p set: 0.4497029781341553
The modified gen p mean: 0.45107895135879517, gen p mean: -0.05146453157067299, mean p set: 0.45155924558639526
loss_pred:0.015604497864842415, decouple_loss:0.0010224576108157635
loss_pred:0.01576230861246586, decouple_loss:0.0009767793817445636
loss_pred:0.015357687138020992, decouple_loss:0.001029214821755886
Iteration: 1062, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45139291882514954, gen p mean: -0.052963949739933014, mean p set: 0.45187318325042725
loss_pred:0.015395788475871086, decouple_loss:0.0011644817423075438
The modified gen p mean: 0.44953253865242004, gen p mean: -0.051923658698797226, mean p set: 0.45001283288002014The modified gen p mean: 0.4508593678474426, gen p mean: -0.055981531739234924, mean p set: 0.4513396918773651
loss_pred:0.015149620361626148, decouple_loss:0.0011254956480115652
loss_pred:0.015151997096836567, decouple_loss:0.0009960164315998554
Iteration: 1063, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499184191226959, gen p mean: -0.05049850046634674, mean p set: 0.450398713350296
loss_pred:0.015173351392149925, decouple_loss:0.0009899020660668612
The modified gen p mean: 0.447933554649353, gen p mean: -0.050376325845718384, mean p set: 0.44841381907463074The modified gen p mean: 0.4487482011318207, gen p mean: -0.05075652524828911, mean p set: 0.44922852516174316
loss_pred:0.015293131582438946, decouple_loss:0.001043769996613264
loss_pred:0.015462935902178288, decouple_loss:0.0010830617975443602
Iteration: 1064, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4512201249599457, gen p mean: -0.04395969212055206, mean p set: 0.4517004191875458
loss_pred:0.01528002880513668, decouple_loss:0.0010779924923554063
The modified gen p mean: 0.44839081168174744, gen p mean: -0.046399299055337906, mean p set: 0.44887110590934753The modified gen p mean: 0.4506099224090576, gen p mean: -0.04223230853676796, mean p set: 0.4510902166366577
loss_pred:0.01589677669107914, decouple_loss:0.001060732756741345
loss_pred:0.015563394874334335, decouple_loss:0.001115594059228897
Iteration: 1065, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482850432395935, gen p mean: -0.04271100461483002, mean p set: 0.4487653374671936
loss_pred:0.015687933191657066, decouple_loss:0.0011371088912710547
The modified gen p mean: 0.45011764764785767, gen p mean: -0.03892888128757477, mean p set: 0.45059797167778015The modified gen p mean: 0.44834089279174805, gen p mean: -0.04159031808376312, mean p set: 0.44882118701934814
loss_pred:0.016158318147063255, decouple_loss:0.0009826314635574818
loss_pred:0.015729328617453575, decouple_loss:0.0011561560677364469
Iteration: 1066, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4516884684562683, gen p mean: -0.04370037466287613, mean p set: 0.4521687626838684
loss_pred:0.015871303156018257, decouple_loss:0.001123142777942121
The modified gen p mean: 0.4490036070346832, gen p mean: -0.04051917418837547, mean p set: 0.4494839310646057The modified gen p mean: 0.45214930176734924, gen p mean: -0.03983573243021965, mean p set: 0.45262959599494934
loss_pred:0.015020234510302544, decouple_loss:0.0011458632070571184
loss_pred:0.015108962543308735, decouple_loss:0.0010797872673720121
Iteration: 1067, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4517090320587158, gen p mean: -0.04028668254613876, mean p set: 0.4521893560886383
loss_pred:0.01566649228334427, decouple_loss:0.001071379636414349
The modified gen p mean: 0.4497833549976349, gen p mean: -0.037284333258867264, mean p set: 0.4502636790275574The modified gen p mean: 0.4490911662578583, gen p mean: -0.03829886019229889, mean p set: 0.44957149028778076
loss_pred:0.016023291274905205, decouple_loss:0.0010529544670134783
loss_pred:0.01514769159257412, decouple_loss:0.0010512281442061067
Iteration: 1068, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.452107310295105, gen p mean: -0.04427092894911766, mean p set: 0.45258763432502747
loss_pred:0.0157647505402565, decouple_loss:0.0013573315227404237
The modified gen p mean: 0.45202067494392395, gen p mean: -0.04360998794436455, mean p set: 0.45250096917152405The modified gen p mean: 0.45140671730041504, gen p mean: -0.03888888657093048, mean p set: 0.45188701152801514
loss_pred:0.01576893776655197, decouple_loss:0.0013327341293916106
loss_pred:0.015269299037754536, decouple_loss:0.001021887524984777
Iteration: 1069, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476472735404968, gen p mean: -0.0443742573261261, mean p set: 0.44812753796577454
loss_pred:0.015614339150488377, decouple_loss:0.001223732833750546
The modified gen p mean: 0.451642781496048, gen p mean: -0.047116056084632874, mean p set: 0.4521230459213257The modified gen p mean: 0.45068931579589844, gen p mean: -0.047644175589084625, mean p set: 0.4511696398258209
loss_pred:0.015665262937545776, decouple_loss:0.001245098770596087
loss_pred:0.015560843981802464, decouple_loss:0.0011646325001493096
Iteration: 1070, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486802816390991, gen p mean: -0.04511314630508423, mean p set: 0.4491605758666992
loss_pred:0.015395727008581161, decouple_loss:0.0010388585506007075
The modified gen p mean: 0.4507247507572174, gen p mean: -0.047215573489665985, mean p set: 0.4512050449848175The modified gen p mean: 0.44859692454338074, gen p mean: -0.04964221641421318, mean p set: 0.44907721877098083
loss_pred:0.015198486857116222, decouple_loss:0.0009896614355966449
loss_pred:0.01564149372279644, decouple_loss:0.0010353773832321167
2023-05-02 06:43:31 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.05272339656949043, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04839399829506874, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04880928993225098, mean p set: 0.4500633478164673
loss_pred:0.01853746362030506, decouple_loss:0.0013007670640945435
loss_pred:0.01749582402408123, decouple_loss:0.001201731152832508
loss_pred:0.017586447298526764, decouple_loss:0.0012013138039037585
WV_0_PC_1_EH_0_PS_40, loss: 0.017934976145625114, avg_mse: 0.02585860714316368
current test mse: 0.025859
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012008_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012008_3_24hr.npz
NaN value num: 0
Iteration: 1071, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4527287781238556, gen p mean: -0.04303179308772087, mean p set: 0.4532091021537781
loss_pred:0.01616315171122551, decouple_loss:0.0011280737817287445
The modified gen p mean: 0.4522738754749298, gen p mean: -0.042488422244787216, mean p set: 0.4527541399002075The modified gen p mean: 0.4512979984283447, gen p mean: -0.0440782867372036, mean p set: 0.4517782926559448
loss_pred:0.016267111524939537, decouple_loss:0.0010464343940839171
loss_pred:0.015927458181977272, decouple_loss:0.0011063996935263276
Iteration: 1072, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4525628387928009, gen p mean: -0.03996950760483742, mean p set: 0.453043133020401
loss_pred:0.015478269197046757, decouple_loss:0.001114706858061254
The modified gen p mean: 0.45276474952697754, gen p mean: -0.04316995292901993, mean p set: 0.45324504375457764The modified gen p mean: 0.45130714774131775, gen p mean: -0.04726018011569977, mean p set: 0.45178741216659546
loss_pred:0.01571260206401348, decouple_loss:0.0011500711552798748
loss_pred:0.015293043106794357, decouple_loss:0.0011413376778364182
Iteration: 1073, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45308828353881836, gen p mean: -0.03747166693210602, mean p set: 0.45356857776641846
loss_pred:0.015157676301896572, decouple_loss:0.0010850640246644616
The modified gen p mean: 0.4524848163127899, gen p mean: -0.04076104238629341, mean p set: 0.4529651403427124The modified gen p mean: 0.45349135994911194, gen p mean: -0.038769155740737915, mean p set: 0.45397165417671204
loss_pred:0.015174281783401966, decouple_loss:0.0012127432273700833
loss_pred:0.015314647927880287, decouple_loss:0.0011131246574223042
Iteration: 1074, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503451883792877, gen p mean: -0.04212316498160362, mean p set: 0.4508254826068878
loss_pred:0.016622401773929596, decouple_loss:0.0010745762847363949
The modified gen p mean: 0.452887624502182, gen p mean: -0.03995572403073311, mean p set: 0.4533679187297821The modified gen p mean: 0.45323196053504944, gen p mean: -0.03467057645320892, mean p set: 0.45371225476264954
loss_pred:0.01527504064142704, decouple_loss:0.0010730222566053271
loss_pred:0.015862993896007538, decouple_loss:0.001092232996597886
Iteration: 1075, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4530266225337982, gen p mean: -0.03273162245750427, mean p set: 0.4535069465637207
loss_pred:0.015274010598659515, decouple_loss:0.0010397774167358875
The modified gen p mean: 0.45069366693496704, gen p mean: -0.0337652862071991, mean p set: 0.45117396116256714The modified gen p mean: 0.4519471526145935, gen p mean: -0.03819223493337631, mean p set: 0.452427476644516
loss_pred:0.015468373894691467, decouple_loss:0.0010971499141305685
loss_pred:0.015635687857866287, decouple_loss:0.0009737112559378147
Iteration: 1076, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45062190294265747, gen p mean: -0.031850386410951614, mean p set: 0.4511021673679352
loss_pred:0.015917519107460976, decouple_loss:0.0011223142500966787
The modified gen p mean: 0.4536525011062622, gen p mean: -0.04541822150349617, mean p set: 0.4541327655315399The modified gen p mean: 0.45104438066482544, gen p mean: -0.03765888139605522, mean p set: 0.4515247046947479
loss_pred:0.015717938542366028, decouple_loss:0.001148909330368042
loss_pred:0.01571083441376686, decouple_loss:0.0011696023866534233
Iteration: 1077, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.452810138463974, gen p mean: -0.03933728486299515, mean p set: 0.4532904326915741
loss_pred:0.015794750303030014, decouple_loss:0.0011078526731580496
The modified gen p mean: 0.4500243067741394, gen p mean: -0.03831685706973076, mean p set: 0.4505046308040619
The modified gen p mean: 0.45126619935035706, gen p mean: -0.043910685926675797, mean p set: 0.45174646377563477
loss_pred:0.016200421378016472, decouple_loss:0.0010596171487122774
loss_pred:0.015987195074558258, decouple_loss:0.0009902090532705188
Iteration: 1078, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45117849111557007, gen p mean: -0.04006426781415939, mean p set: 0.4516587555408478
loss_pred:0.015231876634061337, decouple_loss:0.0011904177954420447
The modified gen p mean: 0.45151814818382263, gen p mean: -0.04035601392388344, mean p set: 0.45199844241142273
The modified gen p mean: 0.4518735408782959, gen p mean: -0.04467654973268509, mean p set: 0.4523538649082184
loss_pred:0.015953540802001953, decouple_loss:0.001128654694184661
loss_pred:0.015589225105941296, decouple_loss:0.0011351476423442364
Iteration: 1079, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511004686355591, gen p mean: -0.04471956938505173, mean p set: 0.4515807330608368
loss_pred:0.015975376591086388, decouple_loss:0.001268464489839971
The modified gen p mean: 0.45352113246917725, gen p mean: -0.042979031801223755, mean p set: 0.45400142669677734The modified gen p mean: 0.45072656869888306, gen p mean: -0.04715552181005478, mean p set: 0.45120686292648315
loss_pred:0.01556309126317501, decouple_loss:0.001063532312400639
loss_pred:0.015462107956409454, decouple_loss:0.0009818850085139275
Iteration: 1080, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45269879698753357, gen p mean: -0.042549218982458115, mean p set: 0.45317909121513367
loss_pred:0.015612485818564892, decouple_loss:0.000962649064604193
The modified gen p mean: 0.45249542593955994, gen p mean: -0.04420065879821777, mean p set: 0.45297572016716003The modified gen p mean: 0.4520490765571594, gen p mean: -0.046338070183992386, mean p set: 0.4525293707847595
loss_pred:0.016085412353277206, decouple_loss:0.001035080524161458
loss_pred:0.015802429988980293, decouple_loss:0.0011558379046618938
2023-05-02 06:46:02 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.0577906034886837, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.053719162940979004, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.054004814475774765, mean p set: 0.4500633478164673
loss_pred:0.01852802373468876, decouple_loss:0.0013576821656897664
loss_pred:0.017431946471333504, decouple_loss:0.0010937261395156384
loss_pred:0.01754337176680565, decouple_loss:0.0011268629459664226
WV_0_PC_1_EH_0_PS_40, loss: 0.017894085496664047, avg_mse: 0.025766996666789055
current test mse: 0.025767
Iteration: 1081, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45210379362106323, gen p mean: -0.04580719769001007, mean p set: 0.45258408784866333
The modified gen p mean: 0.45215561985969543, gen p mean: -0.04077047482132912, mean p set: 0.45263591408729553
The modified gen p mean: 0.4529445469379425, gen p mean: -0.0432857982814312, mean p set: 0.4534248113632202
loss_pred:0.015714870765805244, decouple_loss:0.0010595297208055854
loss_pred:0.015846069902181625, decouple_loss:0.0009347897721454501loss_pred:0.015563320368528366, decouple_loss:0.0010886178351938725
Iteration: 1082, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4535878896713257, gen p mean: -0.04152414947748184, mean p set: 0.45406821370124817
The modified gen p mean: 0.45416638255119324, gen p mean: -0.05032838508486748, mean p set: 0.45464667677879333
loss_pred:0.015509650111198425, decouple_loss:0.0010686551686376333
loss_pred:0.015298190526664257, decouple_loss:0.0010845373617485166
The modified gen p mean: 0.4534977972507477, gen p mean: -0.04456624388694763, mean p set: 0.4539780914783478
loss_pred:0.01585652306675911, decouple_loss:0.0010924871312454343
Iteration: 1083, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504817724227905, gen p mean: -0.04367649555206299, mean p set: 0.450962096452713
loss_pred:0.015885015949606895, decouple_loss:0.0012056722771376371
The modified gen p mean: 0.45166248083114624, gen p mean: -0.05212792381644249, mean p set: 0.4521428048610687The modified gen p mean: 0.45254582166671753, gen p mean: -0.05331653729081154, mean p set: 0.45302614569664
loss_pred:0.01525681558996439, decouple_loss:0.0011515761725604534
loss_pred:0.014529509469866753, decouple_loss:0.0012212704168632627
Iteration: 1084, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4512730836868286, gen p mean: -0.053808871656656265, mean p set: 0.4517534077167511
loss_pred:0.015183934010565281, decouple_loss:0.0010708204936236143
The modified gen p mean: 0.45226365327835083, gen p mean: -0.04338223859667778, mean p set: 0.4527439475059509The modified gen p mean: 0.4538218379020691, gen p mean: -0.04368486627936363, mean p set: 0.4543021321296692
loss_pred:0.015454515814781189, decouple_loss:0.0012148745590820909
loss_pred:0.015371646732091904, decouple_loss:0.0012246682308614254
Iteration: 1085, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45330971479415894, gen p mean: -0.04405491426587105, mean p set: 0.45378997921943665
loss_pred:0.015184614807367325, decouple_loss:0.0011222176253795624
The modified gen p mean: 0.4527757465839386, gen p mean: -0.04949172958731651, mean p set: 0.4532560408115387The modified gen p mean: 0.4535704255104065, gen p mean: -0.042756013572216034, mean p set: 0.4540506899356842
loss_pred:0.015714682638645172, decouple_loss:0.0011427266290411353
loss_pred:0.015220295637845993, decouple_loss:0.0011021967511624098
Iteration: 1086, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4519036114215851, gen p mean: -0.04369720444083214, mean p set: 0.4523839056491852
loss_pred:0.015289509668946266, decouple_loss:0.0011867426801472902
The modified gen p mean: 0.4507077634334564, gen p mean: -0.052780263125896454, mean p set: 0.4511880576610565The modified gen p mean: 0.45364370942115784, gen p mean: -0.04974082484841347, mean p set: 0.4541240334510803
loss_pred:0.01605597697198391, decouple_loss:0.0012763134436681867
loss_pred:0.015427210368216038, decouple_loss:0.0012198911281302571
Iteration: 1087, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498867392539978, gen p mean: -0.045857835561037064, mean p set: 0.4503670632839203
loss_pred:0.015569948591291904, decouple_loss:0.0012153235729783773
The modified gen p mean: 0.4537309408187866, gen p mean: -0.05766090378165245, mean p set: 0.4542112350463867The modified gen p mean: 0.45190176367759705, gen p mean: -0.047436293214559555, mean p set: 0.45238205790519714
loss_pred:0.01562783494591713, decouple_loss:0.0011376894544810057
loss_pred:0.015593445859849453, decouple_loss:0.0012017086846753955
Iteration: 1088, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4523571729660034, gen p mean: -0.04765097051858902, mean p set: 0.4528374671936035
loss_pred:0.015535910613834858, decouple_loss:0.0011465160641819239
The modified gen p mean: 0.4521459639072418, gen p mean: -0.04629644751548767, mean p set: 0.4526262879371643The modified gen p mean: 0.4518187940120697, gen p mean: -0.052244819700717926, mean p set: 0.4522990584373474
loss_pred:0.015720106661319733, decouple_loss:0.001142262015491724
loss_pred:0.015094874426722527, decouple_loss:0.0012496724957600236
Iteration: 1089, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502796530723572, gen p mean: -0.047414351254701614, mean p set: 0.4507599174976349
loss_pred:0.01552241388708353, decouple_loss:0.0011784955859184265
The modified gen p mean: 0.4529880881309509, gen p mean: -0.04759366810321808, mean p set: 0.4534684121608734The modified gen p mean: 0.4529775083065033, gen p mean: -0.05239669606089592, mean p set: 0.4534578025341034
loss_pred:0.015276403166353703, decouple_loss:0.0011636530980467796
loss_pred:0.01515465509146452, decouple_loss:0.001211904687806964
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012001_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012001_3_24hr.npz
NaN value num: 0
Iteration: 1090, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497394263744354, gen p mean: -0.04729647561907768, mean p set: 0.4502197206020355
loss_pred:0.01685277558863163, decouple_loss:0.0011823836248368025
The modified gen p mean: 0.4497472047805786, gen p mean: -0.052655547857284546, mean p set: 0.4502274990081787The modified gen p mean: 0.449690580368042, gen p mean: -0.05143522471189499, mean p set: 0.4501708745956421
loss_pred:0.01578715071082115, decouple_loss:0.0012700286461040378
loss_pred:0.01619272492825985, decouple_loss:0.0012277754722163081
2023-05-02 06:48:44 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.06112690642476082, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.056846290826797485, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.05728006735444069, mean p set: 0.4500633478164673
loss_pred:0.018482210114598274, decouple_loss:0.00140620197635144
loss_pred:0.017370272427797318, decouple_loss:0.0012864293530583382
loss_pred:0.01748727448284626, decouple_loss:0.0013212576741352677
WV_0_PC_1_EH_0_PS_40, loss: 0.017846817150712013, avg_mse: 0.025648362934589386
current test mse: 0.025648
Iteration: 1091, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45021122694015503, gen p mean: -0.05151791498064995, mean p set: 0.45069149136543274
The modified gen p mean: 0.4493815004825592, gen p mean: -0.04881831631064415, mean p set: 0.4498618245124817
The modified gen p mean: 0.4502882659435272, gen p mean: -0.05446278676390648, mean p set: 0.4507685601711273
loss_pred:0.015999440103769302, decouple_loss:0.0012867115437984467
loss_pred:0.01653486117720604, decouple_loss:0.0013702205615118146
loss_pred:0.01607438549399376, decouple_loss:0.0011615785770118237
Iteration: 1092, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45032647252082825, gen p mean: -0.04681507870554924, mean p set: 0.45080679655075073
loss_pred:0.015984518453478813, decouple_loss:0.001165074179880321
The modified gen p mean: 0.44863617420196533, gen p mean: -0.045012813061475754, mean p set: 0.44911646842956543
The modified gen p mean: 0.447966068983078, gen p mean: -0.04726414754986763, mean p set: 0.4484463632106781
loss_pred:0.015930769965052605, decouple_loss:0.0011715478030964732
loss_pred:0.01549997366964817, decouple_loss:0.0011578163830563426
Iteration: 1093, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45033854246139526, gen p mean: -0.04857976362109184, mean p set: 0.450818806886673
loss_pred:0.016619112342596054, decouple_loss:0.0010258348193019629
The modified gen p mean: 0.44751405715942383, gen p mean: -0.04301243647933006, mean p set: 0.44799432158470154The modified gen p mean: 0.4512284994125366, gen p mean: -0.04805310443043709, mean p set: 0.4517087936401367
loss_pred:0.01666823960840702, decouple_loss:0.0010800031013786793
loss_pred:0.015956168994307518, decouple_loss:0.0009782230481505394
Iteration: 1094, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501236379146576, gen p mean: -0.042164530605077744, mean p set: 0.4506039321422577
loss_pred:0.015958189964294434, decouple_loss:0.0013079672353342175
The modified gen p mean: 0.44756880402565, gen p mean: -0.044029854238033295, mean p set: 0.4480490982532501The modified gen p mean: 0.448236882686615, gen p mean: -0.04267674684524536, mean p set: 0.44871723651885986
loss_pred:0.016189374029636383, decouple_loss:0.0010718979174271226
loss_pred:0.016374751925468445, decouple_loss:0.0011087056482210755
Iteration: 1095, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482101798057556, gen p mean: -0.04201246425509453, mean p set: 0.4486904740333557
loss_pred:0.015759067609906197, decouple_loss:0.0009871398797258735
The modified gen p mean: 0.4502367079257965, gen p mean: -0.04555187746882439, mean p set: 0.4507170021533966The modified gen p mean: 0.44732335209846497, gen p mean: -0.044749628752470016, mean p set: 0.44780364632606506
loss_pred:0.01627213880419731, decouple_loss:0.0011424176627770066
loss_pred:0.016357287764549255, decouple_loss:0.001159626292064786
Iteration: 1096, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476509988307953, gen p mean: -0.04616159945726395, mean p set: 0.4481312930583954
loss_pred:0.016060970723628998, decouple_loss:0.0011345833772793412
The modified gen p mean: 0.449078768491745, gen p mean: -0.041251953691244125, mean p set: 0.4495590925216675The modified gen p mean: 0.44922035932540894, gen p mean: -0.04290489852428436, mean p set: 0.4497006833553314
loss_pred:0.0159792248159647, decouple_loss:0.001103977207094431
loss_pred:0.01671396568417549, decouple_loss:0.001049158745445311
Iteration: 1097, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480181336402893, gen p mean: -0.04300635680556297, mean p set: 0.4484984576702118
loss_pred:0.016100071370601654, decouple_loss:0.0010919414926320314
The modified gen p mean: 0.44768673181533813, gen p mean: -0.04527181014418602, mean p set: 0.44816699624061584The modified gen p mean: 0.447935551404953, gen p mean: -0.04206421226263046, mean p set: 0.4484158456325531
loss_pred:0.01600894145667553, decouple_loss:0.0011276319855824113
loss_pred:0.01609162613749504, decouple_loss:0.0011056815274059772
Iteration: 1098, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44973328709602356, gen p mean: -0.04310101643204689, mean p set: 0.45021358132362366
loss_pred:0.01502037514001131, decouple_loss:0.0011646891944110394
The modified gen p mean: 0.44969457387924194, gen p mean: -0.04620366171002388, mean p set: 0.45017489790916443The modified gen p mean: 0.4479019045829773, gen p mean: -0.04374608397483826, mean p set: 0.448382169008255
loss_pred:0.016166238114237785, decouple_loss:0.0010293000377714634
loss_pred:0.016534963622689247, decouple_loss:0.0011783646186813712
Iteration: 1099, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480859339237213, gen p mean: -0.04482331499457359, mean p set: 0.4485662281513214
loss_pred:0.016221296042203903, decouple_loss:0.0012037737760692835
The modified gen p mean: 0.44779157638549805, gen p mean: -0.04693114757537842, mean p set: 0.44827190041542053The modified gen p mean: 0.4474199712276459, gen p mean: -0.04833949729800224, mean p set: 0.44790026545524597
loss_pred:0.015678424388170242, decouple_loss:0.0010969474678859115
loss_pred:0.01570572517812252, decouple_loss:0.00131554389372468
Iteration: 1100, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44836822152137756, gen p mean: -0.0469425767660141, mean p set: 0.44884851574897766
loss_pred:0.016523877158761024, decouple_loss:0.0011980311246588826
The modified gen p mean: 0.4495708644390106, gen p mean: -0.048064038157463074, mean p set: 0.4500511884689331The modified gen p mean: 0.44882693886756897, gen p mean: -0.044918809086084366, mean p set: 0.44930723309516907
loss_pred:0.015684492886066437, decouple_loss:0.0012082256143912673
loss_pred:0.015896407887339592, decouple_loss:0.001162027707323432
2023-05-02 06:50:40 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.05631764233112335, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.05201452225446701, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.05242781713604927, mean p set: 0.4500633478164673
loss_pred:0.01842721924185753, decouple_loss:0.0014335322193801403
loss_pred:0.017388517037034035, decouple_loss:0.0011878116056323051
loss_pred:0.017468970268964767, decouple_loss:0.0012844187440350652
WV_0_PC_1_EH_0_PS_40, loss: 0.017826665192842484, avg_mse: 0.02562348172068596
current test mse: 0.025623
Iteration: 1101, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505366086959839, gen p mean: -0.0454094335436821, mean p set: 0.45101693272590637
The modified gen p mean: 0.4500649571418762, gen p mean: -0.04472994804382324, mean p set: 0.45054522156715393
The modified gen p mean: 0.44963377714157104, gen p mean: -0.04781433194875717, mean p set: 0.45011407136917114
loss_pred:0.016566265374422073, decouple_loss:0.0010598425287753344
loss_pred:0.015454561449587345, decouple_loss:0.0011933189816772938
loss_pred:0.016511978581547737, decouple_loss:0.0012138818856328726
Iteration: 1102, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45021921396255493, gen p mean: -0.0454881377518177, mean p set: 0.45069950819015503
loss_pred:0.015376737341284752, decouple_loss:0.0013218336971476674
The modified gen p mean: 0.44751742482185364, gen p mean: -0.05045613646507263, mean p set: 0.44799768924713135The modified gen p mean: 0.45100706815719604, gen p mean: -0.04644163325428963, mean p set: 0.45148739218711853
loss_pred:0.015998737886548042, decouple_loss:0.0012590624392032623
loss_pred:0.016284629702568054, decouple_loss:0.001181545201689005
Iteration: 1103, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44960716366767883, gen p mean: -0.04391039162874222, mean p set: 0.45008742809295654
loss_pred:0.015768717974424362, decouple_loss:0.001166737056337297
The modified gen p mean: 0.44992679357528687, gen p mean: -0.04562002420425415, mean p set: 0.4504070580005646The modified gen p mean: 0.45038384199142456, gen p mean: -0.04484189674258232, mean p set: 0.45086413621902466
loss_pred:0.015870854258537292, decouple_loss:0.001243898645043373
loss_pred:0.015627451241016388, decouple_loss:0.0011424475815147161
Iteration: 1104, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45018166303634644, gen p mean: -0.04403005167841911, mean p set: 0.4506619870662689
loss_pred:0.01600397191941738, decouple_loss:0.001302240532822907
The modified gen p mean: 0.4505389928817749, gen p mean: -0.04046762362122536, mean p set: 0.451019287109375The modified gen p mean: 0.44733551144599915, gen p mean: -0.04164654016494751, mean p set: 0.44781580567359924
loss_pred:0.015624821186065674, decouple_loss:0.00124309491366148
loss_pred:0.016413837671279907, decouple_loss:0.0012582523049786687
Iteration: 1105, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491611123085022, gen p mean: -0.0429108552634716, mean p set: 0.4496413767337799
loss_pred:0.016003616154193878, decouple_loss:0.0011834618635475636
The modified gen p mean: 0.4475920796394348, gen p mean: -0.04812350124120712, mean p set: 0.4480723738670349The modified gen p mean: 0.45018360018730164, gen p mean: -0.04064357280731201, mean p set: 0.45066389441490173
loss_pred:0.015854094177484512, decouple_loss:0.0012729957234114408
loss_pred:0.016005491837859154, decouple_loss:0.0014021542156115174
Iteration: 1106, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502338469028473, gen p mean: -0.03811325877904892, mean p set: 0.450714111328125
loss_pred:0.015164528973400593, decouple_loss:0.0011148256016895175
The modified gen p mean: 0.44783496856689453, gen p mean: -0.04382801428437233, mean p set: 0.44831526279449463The modified gen p mean: 0.4480643570423126, gen p mean: -0.041998934000730515, mean p set: 0.4485446512699127
loss_pred:0.016558755189180374, decouple_loss:0.001154978876002133
loss_pred:0.015723753720521927, decouple_loss:0.0011457066284492612
Iteration: 1107, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45052462816238403, gen p mean: -0.04523682966828346, mean p set: 0.45100489258766174
loss_pred:0.015882106497883797, decouple_loss:0.0011089467443525791
The modified gen p mean: 0.4509035348892212, gen p mean: -0.04341661557555199, mean p set: 0.4513837993144989The modified gen p mean: 0.4488028287887573, gen p mean: -0.04126686230301857, mean p set: 0.4492831230163574
loss_pred:0.015812668949365616, decouple_loss:0.001102582667954266
loss_pred:0.015482937917113304, decouple_loss:0.0011361705837771297
Iteration: 1108, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492908716201782, gen p mean: -0.04591193050146103, mean p set: 0.4497711658477783
loss_pred:0.01671724207699299, decouple_loss:0.0010952489683404565
The modified gen p mean: 0.44767817854881287, gen p mean: -0.04695700481534004, mean p set: 0.44815847277641296The modified gen p mean: 0.4475097954273224, gen p mean: -0.046166956424713135, mean p set: 0.4479900598526001
loss_pred:0.015770332887768745, decouple_loss:0.0010646623559296131
loss_pred:0.016565455123782158, decouple_loss:0.0010545477271080017
Iteration: 1109, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500119984149933, gen p mean: -0.05117308720946312, mean p set: 0.45049232244491577
loss_pred:0.0157435555011034, decouple_loss:0.0013785342453047633
The modified gen p mean: 0.4503447413444519, gen p mean: -0.049156442284584045, mean p set: 0.4508250057697296The modified gen p mean: 0.44820454716682434, gen p mean: -0.04855294153094292, mean p set: 0.44868484139442444
loss_pred:0.016492726281285286, decouple_loss:0.0010960000799968839
loss_pred:0.01537232007831335, decouple_loss:0.0011413587490096688
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012015_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012015_3_24hr.npz
NaN value num: 0
Iteration: 1110, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489671587944031, gen p mean: -0.05348707735538483, mean p set: 0.4494474530220032
loss_pred:0.01789860986173153, decouple_loss:0.0011935620568692684
The modified gen p mean: 0.446615993976593, gen p mean: -0.050662241876125336, mean p set: 0.4470962882041931The modified gen p mean: 0.44634801149368286, gen p mean: -0.056707244366407394, mean p set: 0.44682827591896057
loss_pred:0.018220366910099983, decouple_loss:0.001197287579998374
loss_pred:0.018165037035942078, decouple_loss:0.0012863047886639833
2023-05-02 06:53:15 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.05695340782403946, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.05242164433002472, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.052843496203422546, mean p set: 0.4500633478164673
loss_pred:0.018369661644101143, decouple_loss:0.0011391669977456331
loss_pred:0.017299389466643333, decouple_loss:0.001161104766651988
loss_pred:0.017378954216837883, decouple_loss:0.0011563302250579
WV_0_PC_1_EH_0_PS_40, loss: 0.01774027943611145, avg_mse: 0.025471337139606476
current test mse: 0.025471
Iteration: 1111, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44811344146728516, gen p mean: -0.05466751754283905, mean p set: 0.44859373569488525
The modified gen p mean: 0.4463558495044708, gen p mean: -0.05652359873056412, mean p set: 0.4468361735343933
The modified gen p mean: 0.4460795223712921, gen p mean: -0.05424987152218819, mean p set: 0.4465598464012146
loss_pred:0.017188183963298798, decouple_loss:0.0011259012389928102
loss_pred:0.01748630590736866, decouple_loss:0.0011242132168263197loss_pred:0.017330914735794067, decouple_loss:0.001039834227412939
Iteration: 1112, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44625091552734375, gen p mean: -0.05999717116355896, mean p set: 0.44673120975494385
loss_pred:0.01738695427775383, decouple_loss:0.0011752466671168804
The modified gen p mean: 0.44656720757484436, gen p mean: -0.052931368350982666, mean p set: 0.44704747200012207The modified gen p mean: 0.44641926884651184, gen p mean: -0.05349554121494293, mean p set: 0.4468995928764343
loss_pred:0.017361566424369812, decouple_loss:0.0011216733837500215
loss_pred:0.017415599897503853, decouple_loss:0.0011037944350391626
Iteration: 1113, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477715492248535, gen p mean: -0.053500305861234665, mean p set: 0.4482518434524536
loss_pred:0.017161624506115913, decouple_loss:0.0010947863338515162
The modified gen p mean: 0.4471330940723419, gen p mean: -0.053466375917196274, mean p set: 0.44761335849761963The modified gen p mean: 0.44541826844215393, gen p mean: -0.05379544943571091, mean p set: 0.44589856266975403
loss_pred:0.017486589029431343, decouple_loss:0.001113414065912366
loss_pred:0.018221484497189522, decouple_loss:0.0010933451121672988
Iteration: 1114, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479663372039795, gen p mean: -0.05625765025615692, mean p set: 0.4484466016292572
loss_pred:0.017807599157094955, decouple_loss:0.0010737864067777991
The modified gen p mean: 0.4461279511451721, gen p mean: -0.061572372913360596, mean p set: 0.4466082453727722The modified gen p mean: 0.44745323061943054, gen p mean: -0.05478699505329132, mean p set: 0.44793352484703064
loss_pred:0.01679079607129097, decouple_loss:0.001230234862305224
loss_pred:0.01727914996445179, decouple_loss:0.0010601034155115485
Iteration: 1115, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474209249019623, gen p mean: -0.05918068438768387, mean p set: 0.4479012191295624
loss_pred:0.017788659781217575, decouple_loss:0.0010892823338508606
The modified gen p mean: 0.4471026659011841, gen p mean: -0.05523522198200226, mean p set: 0.4475829601287842The modified gen p mean: 0.4458533823490143, gen p mean: -0.05875082686543465, mean p set: 0.4463336765766144
loss_pred:0.016606399789452553, decouple_loss:0.0010816478170454502
loss_pred:0.017527393996715546, decouple_loss:0.0012733946787193418
Iteration: 1116, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44572141766548157, gen p mean: -0.05580296739935875, mean p set: 0.44620171189308167
loss_pred:0.017759311944246292, decouple_loss:0.0012688972055912018
The modified gen p mean: 0.446683794260025, gen p mean: -0.06143663078546524, mean p set: 0.4471641182899475The modified gen p mean: 0.4478738307952881, gen p mean: -0.060550257563591, mean p set: 0.4483541250228882
loss_pred:0.017696304246783257, decouple_loss:0.0011573891388252378
loss_pred:0.01731564849615097, decouple_loss:0.001303710276260972
Iteration: 1117, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44683387875556946, gen p mean: -0.06020340695977211, mean p set: 0.44731420278549194
loss_pred:0.017371276393532753, decouple_loss:0.0011450884630903602
The modified gen p mean: 0.4467689096927643, gen p mean: -0.054072655737400055, mean p set: 0.44724923372268677The modified gen p mean: 0.44697073101997375, gen p mean: -0.05848615989089012, mean p set: 0.44745099544525146
loss_pred:0.01745092123746872, decouple_loss:0.0011293814750388265
loss_pred:0.01759692281484604, decouple_loss:0.001159998937509954
Iteration: 1118, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4461621940135956, gen p mean: -0.061105433851480484, mean p set: 0.4466424882411957
loss_pred:0.017566481605172157, decouple_loss:0.0011136865941807628
The modified gen p mean: 0.447578489780426, gen p mean: -0.06315234303474426, mean p set: 0.4480588138103485The modified gen p mean: 0.44539394974708557, gen p mean: -0.0588533841073513, mean p set: 0.44587424397468567
loss_pred:0.01760590821504593, decouple_loss:0.0011297131422907114
loss_pred:0.01764168031513691, decouple_loss:0.001286516198888421
Iteration: 1119, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44663065671920776, gen p mean: -0.06500094383955002, mean p set: 0.4471109211444855
loss_pred:0.01753827929496765, decouple_loss:0.001050840481184423
The modified gen p mean: 0.445504754781723, gen p mean: -0.062067389488220215, mean p set: 0.4459850490093231The modified gen p mean: 0.4474359452724457, gen p mean: -0.059479884803295135, mean p set: 0.4479162395000458
loss_pred:0.016842614859342575, decouple_loss:0.0010493986774235964
loss_pred:0.01706911437213421, decouple_loss:0.0010395471472293139
Iteration: 1120, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446939617395401, gen p mean: -0.05901198089122772, mean p set: 0.4474199414253235
loss_pred:0.01799684762954712, decouple_loss:0.001100993831641972
The modified gen p mean: 0.44757893681526184, gen p mean: -0.06082790344953537, mean p set: 0.44805923104286194The modified gen p mean: 0.44816336035728455, gen p mean: -0.06112539768218994, mean p set: 0.44864365458488464
loss_pred:0.017394516617059708, decouple_loss:0.0011798185296356678
loss_pred:0.01695897802710533, decouple_loss:0.0011134044034406543
2023-05-02 06:55:08 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.061422619968652725, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.05696136876940727, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.05737927928566933, mean p set: 0.4500633478164673
loss_pred:0.01829586923122406, decouple_loss:0.001214315416291356
loss_pred:0.017296357080340385, decouple_loss:0.0011616562260314822
loss_pred:0.01740868017077446, decouple_loss:0.0011264556087553501
WV_0_PC_1_EH_0_PS_40, loss: 0.017725344747304916, avg_mse: 0.025438517332077026
current test mse: 0.025439
Iteration: 1121, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4452609717845917, gen p mean: -0.06399954110383987, mean p set: 0.4457412362098694
The modified gen p mean: 0.44718998670578003, gen p mean: -0.06107105314731598, mean p set: 0.4476702809333801
The modified gen p mean: 0.44766369462013245, gen p mean: -0.05918746441602707, mean p set: 0.44814398884773254
loss_pred:0.017104508355259895, decouple_loss:0.0010900582419708371
loss_pred:0.01702512428164482, decouple_loss:0.001068647368811071loss_pred:0.01686478778719902, decouple_loss:0.0011260949540883303
Iteration: 1122, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44770190119743347, gen p mean: -0.06310614943504333, mean p set: 0.44818219542503357
loss_pred:0.01732158660888672, decouple_loss:0.0012001764262095094
The modified gen p mean: 0.44587939977645874, gen p mean: -0.05894031375646591, mean p set: 0.44635969400405884The modified gen p mean: 0.4478876292705536, gen p mean: -0.05878203362226486, mean p set: 0.4483678936958313
loss_pred:0.017320293933153152, decouple_loss:0.0011642974568530917
loss_pred:0.01704062521457672, decouple_loss:0.0011618450516834855
Iteration: 1123, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44684791564941406, gen p mean: -0.05332275107502937, mean p set: 0.44732820987701416
loss_pred:0.01794053055346012, decouple_loss:0.0011166217736899853
The modified gen p mean: 0.4461263120174408, gen p mean: -0.055223092436790466, mean p set: 0.4466065764427185The modified gen p mean: 0.44784945249557495, gen p mean: -0.06025295332074165, mean p set: 0.44832971692085266
loss_pred:0.017014391720294952, decouple_loss:0.0011095009976997972
loss_pred:0.017701679840683937, decouple_loss:0.0010862665949389338
Iteration: 1124, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44537967443466187, gen p mean: -0.05436771363019943, mean p set: 0.4458599388599396
loss_pred:0.016940053552389145, decouple_loss:0.0012157310266047716
The modified gen p mean: 0.4479116201400757, gen p mean: -0.0505099780857563, mean p set: 0.4483919143676758The modified gen p mean: 0.445453941822052, gen p mean: -0.05933734402060509, mean p set: 0.4459342360496521
loss_pred:0.01683659479022026, decouple_loss:0.0012726950226351619
loss_pred:0.01699342206120491, decouple_loss:0.001233662129379809
Iteration: 1125, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471697509288788, gen p mean: -0.05353406444191933, mean p set: 0.4476500451564789
loss_pred:0.01734829880297184, decouple_loss:0.0011116606183350086
The modified gen p mean: 0.4480862617492676, gen p mean: -0.05474882200360298, mean p set: 0.4485665559768677The modified gen p mean: 0.4479689598083496, gen p mean: -0.055806513875722885, mean p set: 0.4484492540359497
loss_pred:0.01739128865301609, decouple_loss:0.0010237112874165177
loss_pred:0.01672408916056156, decouple_loss:0.0010457724565640092
Iteration: 1126, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44735226035118103, gen p mean: -0.057630181312561035, mean p set: 0.4478325843811035
The modified gen p mean: 0.44873663783073425, gen p mean: -0.051760233938694, mean p set: 0.44921690225601196
loss_pred:0.017663031816482544, decouple_loss:0.0010510437423363328
loss_pred:0.01706959493458271, decouple_loss:0.001085515832528472
The modified gen p mean: 0.44740989804267883, gen p mean: -0.053645968437194824, mean p set: 0.44789019227027893
loss_pred:0.017030714079737663, decouple_loss:0.0010536662302911282
Iteration: 1127, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478360414505005, gen p mean: -0.054748836904764175, mean p set: 0.4483163356781006
loss_pred:0.017013560980558395, decouple_loss:0.0010294746607542038
The modified gen p mean: 0.44685637950897217, gen p mean: -0.054644156247377396, mean p set: 0.44733667373657227The modified gen p mean: 0.4470093846321106, gen p mean: -0.05379563942551613, mean p set: 0.4474896788597107
loss_pred:0.016944140195846558, decouple_loss:0.0011177893029525876
loss_pred:0.017809705808758736, decouple_loss:0.001023629680275917
Iteration: 1128, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481044113636017, gen p mean: -0.05672462284564972, mean p set: 0.4485847055912018
loss_pred:0.017310304567217827, decouple_loss:0.0014332757564261556
The modified gen p mean: 0.4462960660457611, gen p mean: -0.06512802094221115, mean p set: 0.4467763900756836The modified gen p mean: 0.44561466574668884, gen p mean: -0.05326700955629349, mean p set: 0.44609498977661133
loss_pred:0.01706729643046856, decouple_loss:0.001179618644528091
loss_pred:0.017256880179047585, decouple_loss:0.0011897996300831437
Iteration: 1129, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4458296597003937, gen p mean: -0.05232005938887596, mean p set: 0.4463099241256714
loss_pred:0.017353620380163193, decouple_loss:0.0011410174192860723
The modified gen p mean: 0.44643425941467285, gen p mean: -0.05768373981118202, mean p set: 0.44691455364227295The modified gen p mean: 0.4470862150192261, gen p mean: -0.0573991984128952, mean p set: 0.44756653904914856
loss_pred:0.016646401956677437, decouple_loss:0.0010248590260744095
loss_pred:0.017204564064741135, decouple_loss:0.0010714452946558595
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012006_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012006_3_24hr.npz
NaN value num: 0
Iteration: 1130, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449148952960968, gen p mean: -0.060608360916376114, mean p set: 0.4496292173862457
loss_pred:0.017230458557605743, decouple_loss:0.0012069956865161657
The modified gen p mean: 0.4493914246559143, gen p mean: -0.06320959329605103, mean p set: 0.4498717188835144The modified gen p mean: 0.44778746366500854, gen p mean: -0.06234459951519966, mean p set: 0.44826775789260864
loss_pred:0.01751401275396347, decouple_loss:0.0012523592449724674
loss_pred:0.01854581944644451, decouple_loss:0.001220017671585083
2023-05-02 06:57:37 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.0647287517786026, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.060247424989938736, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.06054382398724556, mean p set: 0.4500633478164673
loss_pred:0.018257757648825645, decouple_loss:0.0013207464944571257
loss_pred:0.01723654754459858, decouple_loss:0.0012838804395869374
loss_pred:0.017344310879707336, decouple_loss:0.0012535147834569216
WV_0_PC_1_EH_0_PS_40, loss: 0.017677176743745804, avg_mse: 0.025349877774715424
current test mse: 0.02535
Iteration: 1131, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44787687063217163, gen p mean: -0.05954285338521004, mean p set: 0.44835713505744934
The modified gen p mean: 0.4479990005493164, gen p mean: -0.06271664798259735, mean p set: 0.4484792649745941
The modified gen p mean: 0.447256863117218, gen p mean: -0.06171650439500809, mean p set: 0.4477371573448181
loss_pred:0.01693928986787796, decouple_loss:0.001360821770504117
loss_pred:0.017712846398353577, decouple_loss:0.0012810085900127888loss_pred:0.0176505446434021, decouple_loss:0.001246425206772983
Iteration: 1132, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478694796562195, gen p mean: -0.05856503173708916, mean p set: 0.44834980368614197
The modified gen p mean: 0.44717299938201904, gen p mean: -0.058861009776592255, mean p set: 0.44765329360961914
loss_pred:0.019019849598407745, decouple_loss:0.0010622454574331641
loss_pred:0.017929507419466972, decouple_loss:0.0010399111779406667The modified gen p mean: 0.4469103515148163, gen p mean: -0.060285534709692, mean p set: 0.447390615940094
loss_pred:0.018184902146458626, decouple_loss:0.001130337710492313
Iteration: 1133, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470460116863251, gen p mean: -0.06108853593468666, mean p set: 0.4475262761116028
loss_pred:0.018037227913737297, decouple_loss:0.001475003082305193
The modified gen p mean: 0.447131872177124, gen p mean: -0.05637767165899277, mean p set: 0.44761213660240173The modified gen p mean: 0.44811561703681946, gen p mean: -0.062119849026203156, mean p set: 0.44859588146209717
loss_pred:0.018159495666623116, decouple_loss:0.0012521634344011545
loss_pred:0.017774885520339012, decouple_loss:0.0013325938489288092
Iteration: 1134, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44697391986846924, gen p mean: -0.05503842979669571, mean p set: 0.44745421409606934
loss_pred:0.01698637381196022, decouple_loss:0.0011264786589890718
The modified gen p mean: 0.4489961862564087, gen p mean: -0.05857517570257187, mean p set: 0.4494765102863312The modified gen p mean: 0.4474940299987793, gen p mean: -0.05590169131755829, mean p set: 0.447974294424057
loss_pred:0.016109630465507507, decouple_loss:0.0011705169454216957
loss_pred:0.016561508178710938, decouple_loss:0.0011558793485164642
Iteration: 1135, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486241340637207, gen p mean: -0.05039745196700096, mean p set: 0.4491044282913208
loss_pred:0.017047397792339325, decouple_loss:0.0013051526620984077
The modified gen p mean: 0.447129487991333, gen p mean: -0.055227648466825485, mean p set: 0.4476097822189331The modified gen p mean: 0.4483519494533539, gen p mean: -0.054808370769023895, mean p set: 0.448832243680954
loss_pred:0.018664037808775902, decouple_loss:0.0014004757395014167
loss_pred:0.01802283711731434, decouple_loss:0.0013427550438791513
Iteration: 1136, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44690850377082825, gen p mean: -0.05466609075665474, mean p set: 0.44738876819610596
loss_pred:0.018377766013145447, decouple_loss:0.0013736701803281903
The modified gen p mean: 0.4474138915538788, gen p mean: -0.05451403185725212, mean p set: 0.44789421558380127The modified gen p mean: 0.4469853341579437, gen p mean: -0.053415246307849884, mean p set: 0.4474656283855438
loss_pred:0.01728964038193226, decouple_loss:0.0011835172772407532
loss_pred:0.016708804294466972, decouple_loss:0.001181475818157196
Iteration: 1137, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44832828640937805, gen p mean: -0.047975361347198486, mean p set: 0.44880858063697815
loss_pred:0.016788527369499207, decouple_loss:0.0012382562272250652
The modified gen p mean: 0.4469222128391266, gen p mean: -0.05006036534905434, mean p set: 0.4474024772644043The modified gen p mean: 0.4497276246547699, gen p mean: -0.05397038534283638, mean p set: 0.45020791888237
loss_pred:0.017431437969207764, decouple_loss:0.0013014766154810786
loss_pred:0.01722840406000614, decouple_loss:0.0014016989152878523
Iteration: 1138, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471716582775116, gen p mean: -0.05393974110484123, mean p set: 0.4476519823074341
loss_pred:0.01657100021839142, decouple_loss:0.0010696141980588436
The modified gen p mean: 0.44916048645973206, gen p mean: -0.05002279207110405, mean p set: 0.44964075088500977The modified gen p mean: 0.4465521275997162, gen p mean: -0.05727770924568176, mean p set: 0.4470324218273163
loss_pred:0.017380021512508392, decouple_loss:0.001244718674570322
loss_pred:0.017082521691918373, decouple_loss:0.0010637674713507295
Iteration: 1139, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496716260910034, gen p mean: -0.056224215775728226, mean p set: 0.45015189051628113
loss_pred:0.017486168071627617, decouple_loss:0.0011828233255073428
The modified gen p mean: 0.4487018287181854, gen p mean: -0.05446792393922806, mean p set: 0.4491821527481079The modified gen p mean: 0.44879695773124695, gen p mean: -0.04861510545015335, mean p set: 0.44927728176116943
loss_pred:0.01618156209588051, decouple_loss:0.0011532050557434559
loss_pred:0.016466833651065826, decouple_loss:0.001297993236221373
Iteration: 1140, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477471709251404, gen p mean: -0.058036524802446365, mean p set: 0.4482274651527405
loss_pred:0.01809764839708805, decouple_loss:0.0010944283567368984
The modified gen p mean: 0.44918811321258545, gen p mean: -0.05365271121263504, mean p set: 0.44966837763786316The modified gen p mean: 0.44772282242774963, gen p mean: -0.05537138506770134, mean p set: 0.44820311665534973
loss_pred:0.017243335023522377, decouple_loss:0.001023976830765605
loss_pred:0.017254896461963654, decouple_loss:0.0010661112610250711
2023-05-02 06:59:33 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.05991128459572792, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.05496937036514282, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.05540476366877556, mean p set: 0.4500633478164673
loss_pred:0.018275516107678413, decouple_loss:0.0011483351700007915
loss_pred:0.01722588948905468, decouple_loss:0.0011292131384834647
loss_pred:0.01740203984081745, decouple_loss:0.0011311639100313187
WV_0_PC_1_EH_0_PS_40, loss: 0.017691291868686676, avg_mse: 0.025378473103046417
current test mse: 0.025378
Iteration: 1141, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44813400506973267, gen p mean: -0.05731358379125595, mean p set: 0.44861429929733276
The modified gen p mean: 0.44851288199424744, gen p mean: -0.05695014446973801, mean p set: 0.44899317622184753
The modified gen p mean: 0.44698935747146606, gen p mean: -0.05323025956749916, mean p set: 0.44746968150138855
loss_pred:0.016819898039102554, decouple_loss:0.0010321447625756264
loss_pred:0.01664193533360958, decouple_loss:0.0011146430624648929
loss_pred:0.016554387286305428, decouple_loss:0.001053719432093203
Iteration: 1142, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44807928800582886, gen p mean: -0.052816927433013916, mean p set: 0.44855955243110657
loss_pred:0.017085310071706772, decouple_loss:0.0011122373398393393
The modified gen p mean: 0.44750961661338806, gen p mean: -0.05398843064904213, mean p set: 0.44798994064331055The modified gen p mean: 0.44741854071617126, gen p mean: -0.05670735612511635, mean p set: 0.44789883494377136
loss_pred:0.01738855242729187, decouple_loss:0.00113547348883003
loss_pred:0.018365897238254547, decouple_loss:0.0011505952570587397
Iteration: 1143, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44831886887550354, gen p mean: -0.060112420469522476, mean p set: 0.44879916310310364
loss_pred:0.017704354599118233, decouple_loss:0.0011046788422390819
The modified gen p mean: 0.4483039975166321, gen p mean: -0.05781233310699463, mean p set: 0.4487842917442322The modified gen p mean: 0.4487006664276123, gen p mean: -0.051725391298532486, mean p set: 0.4491809606552124
loss_pred:0.017542270943522453, decouple_loss:0.0011187471682205796
loss_pred:0.01671453006565571, decouple_loss:0.0010489901760593057
Iteration: 1144, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491839110851288, gen p mean: -0.05550765246152878, mean p set: 0.4496642053127289
loss_pred:0.016697371378540993, decouple_loss:0.001188380760140717
The modified gen p mean: 0.4493010640144348, gen p mean: -0.05454085394740105, mean p set: 0.4497813284397125The modified gen p mean: 0.447294145822525, gen p mean: -0.05821936950087547, mean p set: 0.4477744400501251
loss_pred:0.017009535804390907, decouple_loss:0.0010072479490190744
loss_pred:0.017131797969341278, decouple_loss:0.0012463318416848779
Iteration: 1145, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44984591007232666, gen p mean: -0.05532305687665939, mean p set: 0.45032617449760437
loss_pred:0.01714223064482212, decouple_loss:0.001068578101694584
The modified gen p mean: 0.44690948724746704, gen p mean: -0.058988966047763824, mean p set: 0.4473898112773895The modified gen p mean: 0.44792255759239197, gen p mean: -0.058137983083724976, mean p set: 0.44840285181999207
loss_pred:0.016468342393636703, decouple_loss:0.0010124273831024766
loss_pred:0.01773763820528984, decouple_loss:0.0010775377741083503
Iteration: 1146, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464704096317291, gen p mean: -0.05431554093956947, mean p set: 0.44695067405700684
loss_pred:0.017460867762565613, decouple_loss:0.001089397701434791
The modified gen p mean: 0.4474733769893646, gen p mean: -0.059307653456926346, mean p set: 0.4479536712169647The modified gen p mean: 0.44731876254081726, gen p mean: -0.05381312221288681, mean p set: 0.44779905676841736
loss_pred:0.017599785700440407, decouple_loss:0.0010497474577277899
loss_pred:0.017496168613433838, decouple_loss:0.0011083479039371014
Iteration: 1147, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501868486404419, gen p mean: -0.05554720014333725, mean p set: 0.450667142868042
loss_pred:0.017317909747362137, decouple_loss:0.0013034517178311944
The modified gen p mean: 0.44772812724113464, gen p mean: -0.058168500661849976, mean p set: 0.44820842146873474The modified gen p mean: 0.44830429553985596, gen p mean: -0.058179233223199844, mean p set: 0.44878458976745605
loss_pred:0.01727152429521084, decouple_loss:0.001261399476788938
loss_pred:0.01612907275557518, decouple_loss:0.0011284275678917766
Iteration: 1148, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485624432563782, gen p mean: -0.05513341724872589, mean p set: 0.44904273748397827
loss_pred:0.016370130702853203, decouple_loss:0.001032862113788724
The modified gen p mean: 0.447347491979599, gen p mean: -0.058479465544223785, mean p set: 0.4478277862071991The modified gen p mean: 0.44750362634658813, gen p mean: -0.05301317200064659, mean p set: 0.4479839503765106
loss_pred:0.01787237450480461, decouple_loss:0.0011041054967790842
loss_pred:0.017993830144405365, decouple_loss:0.0011588464258238673
Iteration: 1149, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44909271597862244, gen p mean: -0.05647895857691765, mean p set: 0.44957301020622253
loss_pred:0.017014652490615845, decouple_loss:0.0009795963997021317
The modified gen p mean: 0.44660401344299316, gen p mean: -0.06150053068995476, mean p set: 0.44708430767059326The modified gen p mean: 0.44814759492874146, gen p mean: -0.05059410631656647, mean p set: 0.44862788915634155
loss_pred:0.017203714698553085, decouple_loss:0.0010552520398050547
loss_pred:0.01626240648329258, decouple_loss:0.0010800660820677876
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012018_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012018_3_24hr.npz
NaN value num: 0
Iteration: 1150, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4461628794670105, gen p mean: -0.05052223429083824, mean p set: 0.4466431736946106
loss_pred:0.01742970384657383, decouple_loss:0.0013041634811088443
The modified gen p mean: 0.4503829777240753, gen p mean: -0.05404622480273247, mean p set: 0.4508633017539978The modified gen p mean: 0.44652047753334045, gen p mean: -0.052681755274534225, mean p set: 0.44700080156326294
loss_pred:0.01624901220202446, decouple_loss:0.0013053813017904758
loss_pred:0.017642272636294365, decouple_loss:0.0012512211687862873
2023-05-02 07:02:09 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.055161252617836, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.05056363716721535, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.051122698932886124, mean p set: 0.4500633478164673
loss_pred:0.018260784447193146, decouple_loss:0.001055439468473196
loss_pred:0.01725851185619831, decouple_loss:0.0010542039526626468loss_pred:0.01738166995346546, decouple_loss:0.0010341160232201219
WV_0_PC_1_EH_0_PS_40, loss: 0.01768605224788189, avg_mse: 0.025355394929647446
current test mse: 0.025355
Iteration: 1151, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44772714376449585, gen p mean: -0.05356796085834503, mean p set: 0.44820740818977356
The modified gen p mean: 0.44826894998550415, gen p mean: -0.05031978711485863, mean p set: 0.44874924421310425
The modified gen p mean: 0.44796857237815857, gen p mean: -0.05623982101678848, mean p set: 0.4484488368034363
loss_pred:0.016665568575263023, decouple_loss:0.0011143110459670424
loss_pred:0.01648852229118347, decouple_loss:0.0009873008821159601
loss_pred:0.016891291365027428, decouple_loss:0.0010892871068790555
Iteration: 1152, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485817849636078, gen p mean: -0.05387933924794197, mean p set: 0.4490620791912079
loss_pred:0.017542051151394844, decouple_loss:0.0012028127675876021
The modified gen p mean: 0.4480954706668854, gen p mean: -0.04900157079100609, mean p set: 0.4485757648944855The modified gen p mean: 0.4467930793762207, gen p mean: -0.052199799567461014, mean p set: 0.4472734034061432
loss_pred:0.01650392636656761, decouple_loss:0.0011095225345343351
loss_pred:0.017635030671954155, decouple_loss:0.0013609071029350162
Iteration: 1153, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473567306995392, gen p mean: -0.050725437700748444, mean p set: 0.4478370249271393
loss_pred:0.016955863684415817, decouple_loss:0.0012294903863221407
The modified gen p mean: 0.4478619694709778, gen p mean: -0.05412151291966438, mean p set: 0.4483422338962555The modified gen p mean: 0.45025891065597534, gen p mean: -0.05371492728590965, mean p set: 0.4507392346858978
loss_pred:0.016102105379104614, decouple_loss:0.0012108576484024525
loss_pred:0.016836484894156456, decouple_loss:0.0011168994242325425
Iteration: 1154, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44757699966430664, gen p mean: -0.05682200938463211, mean p set: 0.44805729389190674
loss_pred:0.016925662755966187, decouple_loss:0.0011846731649711728
The modified gen p mean: 0.4490949809551239, gen p mean: -0.05196550861001015, mean p set: 0.449575275182724The modified gen p mean: 0.447700172662735, gen p mean: -0.0524241179227829, mean p set: 0.4481804668903351
loss_pred:0.016851339489221573, decouple_loss:0.001063380273990333
loss_pred:0.016384517773985863, decouple_loss:0.0011075931834056973
Iteration: 1155, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44710925221443176, gen p mean: -0.05825618654489517, mean p set: 0.44758954644203186
The modified gen p mean: 0.44624578952789307, gen p mean: -0.0596577450633049, mean p set: 0.44672608375549316
loss_pred:0.016924254596233368, decouple_loss:0.001311908708885312
loss_pred:0.017110276967287064, decouple_loss:0.001267763669602573
The modified gen p mean: 0.4472379982471466, gen p mean: -0.0536140613257885, mean p set: 0.4477182924747467
loss_pred:0.017302686348557472, decouple_loss:0.0014289068058133125
Iteration: 1156, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44721996784210205, gen p mean: -0.05680844932794571, mean p set: 0.44770026206970215
loss_pred:0.017322983592748642, decouple_loss:0.0012814325746148825
The modified gen p mean: 0.4488906264305115, gen p mean: -0.051662642508745193, mean p set: 0.44937095046043396The modified gen p mean: 0.44722893834114075, gen p mean: -0.05609841272234917, mean p set: 0.44770923256874084
loss_pred:0.016836341470479965, decouple_loss:0.0012734633637592196
loss_pred:0.017174048349261284, decouple_loss:0.0013270287308841944
Iteration: 1157, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44760385155677795, gen p mean: -0.05649299547076225, mean p set: 0.44808417558670044
loss_pred:0.017113590613007545, decouple_loss:0.0010708100162446499
The modified gen p mean: 0.44801101088523865, gen p mean: -0.0542779415845871, mean p set: 0.44849130511283875The modified gen p mean: 0.4467270076274872, gen p mean: -0.051751770079135895, mean p set: 0.44720733165740967
loss_pred:0.016626985743641853, decouple_loss:0.0010963211534544826
loss_pred:0.015924667939543724, decouple_loss:0.001033363165333867
Iteration: 1158, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474814534187317, gen p mean: -0.054135214537382126, mean p set: 0.4479617476463318
loss_pred:0.01601259969174862, decouple_loss:0.0010955585166811943
The modified gen p mean: 0.44797590374946594, gen p mean: -0.054519739001989365, mean p set: 0.44845619797706604The modified gen p mean: 0.44830670952796936, gen p mean: -0.05678742378950119, mean p set: 0.44878700375556946
loss_pred:0.015331911854445934, decouple_loss:0.0010969117283821106
loss_pred:0.016863295808434486, decouple_loss:0.0011465838178992271
Iteration: 1159, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44583308696746826, gen p mean: -0.057986557483673096, mean p set: 0.44631341099739075
loss_pred:0.017209233716130257, decouple_loss:0.0012595833977684379
The modified gen p mean: 0.44938093423843384, gen p mean: -0.057634346187114716, mean p set: 0.44986119866371155The modified gen p mean: 0.4495514929294586, gen p mean: -0.05264240503311157, mean p set: 0.4500318169593811
loss_pred:0.016499241814017296, decouple_loss:0.0012294972548261285
loss_pred:0.015924731269478798, decouple_loss:0.0012406866298988461
Iteration: 1160, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473099708557129, gen p mean: -0.05543607100844383, mean p set: 0.447790265083313
loss_pred:0.016479752957820892, decouple_loss:0.0011442432878538966
The modified gen p mean: 0.448026180267334, gen p mean: -0.05347132682800293, mean p set: 0.4485064744949341The modified gen p mean: 0.44899240136146545, gen p mean: -0.048532675951719284, mean p set: 0.44947269558906555
loss_pred:0.016536619514226913, decouple_loss:0.0010798076400533319
loss_pred:0.01673656702041626, decouple_loss:0.0011341270292177796
2023-05-02 07:04:04 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.053799938410520554, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04970436915755272, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.050392307341098785, mean p set: 0.4500633478164673
loss_pred:0.018425777554512024, decouple_loss:0.001201918232254684
loss_pred:0.01734865829348564, decouple_loss:0.001204728614538908
loss_pred:0.017510805279016495, decouple_loss:0.0012453541858121753
WV_0_PC_1_EH_0_PS_40, loss: 0.017822613939642906, avg_mse: 0.02563621662557125
current test mse: 0.025636
Iteration: 1161, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4461364150047302, gen p mean: -0.05197318270802498, mean p set: 0.4466167390346527
The modified gen p mean: 0.4480680525302887, gen p mean: -0.05864334851503372, mean p set: 0.4485483467578888
The modified gen p mean: 0.44806066155433655, gen p mean: -0.05569285899400711, mean p set: 0.44854092597961426
loss_pred:0.016748834401369095, decouple_loss:0.0011856270721182227
loss_pred:0.017162183299660683, decouple_loss:0.0012947864597663283
loss_pred:0.016793306916952133, decouple_loss:0.0012838698457926512
Iteration: 1162, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491898715496063, gen p mean: -0.04881995543837547, mean p set: 0.44967013597488403
loss_pred:0.015745284035801888, decouple_loss:0.0011309599503874779
The modified gen p mean: 0.44820618629455566, gen p mean: -0.04806184768676758, mean p set: 0.44868648052215576
The modified gen p mean: 0.44825199246406555, gen p mean: -0.05116910859942436, mean p set: 0.44873231649398804
loss_pred:0.016316579654812813, decouple_loss:0.0011380395153537393
loss_pred:0.01601254567503929, decouple_loss:0.0012215026654303074
Iteration: 1163, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44810646772384644, gen p mean: -0.052629344165325165, mean p set: 0.4485867917537689
loss_pred:0.01652870886027813, decouple_loss:0.0012407213216647506
The modified gen p mean: 0.44777607917785645, gen p mean: -0.04997262731194496, mean p set: 0.44825637340545654The modified gen p mean: 0.4492214322090149, gen p mean: -0.0477161779999733, mean p set: 0.4497016966342926
loss_pred:0.016626782715320587, decouple_loss:0.001122169429436326
loss_pred:0.016352377831935883, decouple_loss:0.001240644371137023
Iteration: 1164, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476563334465027, gen p mean: -0.04754423350095749, mean p set: 0.4481366276741028
loss_pred:0.01606755331158638, decouple_loss:0.0012908207718282938
The modified gen p mean: 0.4476211667060852, gen p mean: -0.04862473905086517, mean p set: 0.4481014907360077The modified gen p mean: 0.4470476806163788, gen p mean: -0.05175888165831566, mean p set: 0.4475279748439789
loss_pred:0.016901765018701553, decouple_loss:0.0011766570387408137
loss_pred:0.017067361623048782, decouple_loss:0.0011728046229109168
Iteration: 1165, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483500123023987, gen p mean: -0.047821369022130966, mean p set: 0.4488303065299988
loss_pred:0.016034316271543503, decouple_loss:0.0011211112141609192
The modified gen p mean: 0.44753506779670715, gen p mean: -0.047003865242004395, mean p set: 0.44801533222198486The modified gen p mean: 0.44650816917419434, gen p mean: -0.04766424000263214, mean p set: 0.4469884932041168
loss_pred:0.0159137062728405, decouple_loss:0.0011389658320695162
loss_pred:0.016467485576868057, decouple_loss:0.0012541738105937839
Iteration: 1166, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44887346029281616, gen p mean: -0.046847980469465256, mean p set: 0.44935378432273865
loss_pred:0.016566313803195953, decouple_loss:0.0013376213610172272
The modified gen p mean: 0.44850054383277893, gen p mean: -0.05165844038128853, mean p set: 0.44898083806037903The modified gen p mean: 0.4467003345489502, gen p mean: -0.051511459052562714, mean p set: 0.4471806287765503
loss_pred:0.016461193561553955, decouple_loss:0.0013110755244269967
loss_pred:0.01682542823255062, decouple_loss:0.001187848043628037
Iteration: 1167, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483039677143097, gen p mean: -0.05238094925880432, mean p set: 0.4487842321395874
loss_pred:0.016268718987703323, decouple_loss:0.0010956383775919676
The modified gen p mean: 0.44676050543785095, gen p mean: -0.05306955426931381, mean p set: 0.44724079966545105The modified gen p mean: 0.4488983452320099, gen p mean: -0.05178394168615341, mean p set: 0.4493786096572876
loss_pred:0.01717241108417511, decouple_loss:0.0010422281920909882
loss_pred:0.015993472188711166, decouple_loss:0.001040541916154325
Iteration: 1168, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475128948688507, gen p mean: -0.04997141659259796, mean p set: 0.4479931592941284
loss_pred:0.015865985304117203, decouple_loss:0.001375954132527113
The modified gen p mean: 0.44797283411026, gen p mean: -0.05067968741059303, mean p set: 0.4484530985355377The modified gen p mean: 0.4482826292514801, gen p mean: -0.05856126919388771, mean p set: 0.4487628936767578
loss_pred:0.015801601111888885, decouple_loss:0.001255171955563128
loss_pred:0.016588419675827026, decouple_loss:0.0017967470921576023
Iteration: 1169, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44812726974487305, gen p mean: -0.048574239015579224, mean p set: 0.44860756397247314
loss_pred:0.015704059973359108, decouple_loss:0.0012081319000571966
The modified gen p mean: 0.4490673840045929, gen p mean: -0.05325813218951225, mean p set: 0.4495477080345154The modified gen p mean: 0.4481285512447357, gen p mean: -0.05230056867003441, mean p set: 0.4486088454723358
loss_pred:0.01596822217106819, decouple_loss:0.001191150164231658
loss_pred:0.016040842980146408, decouple_loss:0.001284395344555378
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012019_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012019_3_24hr.npz
NaN value num: 0
Iteration: 1170, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44803234934806824, gen p mean: -0.048387400805950165, mean p set: 0.44851261377334595
loss_pred:0.014042859897017479, decouple_loss:0.0013296602992340922
The modified gen p mean: 0.44822654128074646, gen p mean: -0.05137258768081665, mean p set: 0.44870686531066895The modified gen p mean: 0.4488588571548462, gen p mean: -0.04968559369444847, mean p set: 0.4493391215801239
loss_pred:0.01548699103295803, decouple_loss:0.0013625319115817547
loss_pred:0.014998454600572586, decouple_loss:0.0012183982180431485
2023-05-02 07:06:48 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.05535321310162544, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.05109851807355881, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.05150803551077843, mean p set: 0.4500633478164673
loss_pred:0.01854771003127098, decouple_loss:0.0012770628090947866
loss_pred:0.01741955243051052, decouple_loss:0.001107444753870368
loss_pred:0.017576390877366066, decouple_loss:0.0011536256643012166
WV_0_PC_1_EH_0_PS_40, loss: 0.017906853929162025, avg_mse: 0.025804203003644943
current test mse: 0.025804
Iteration: 1171, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497874081134796, gen p mean: -0.05176594853401184, mean p set: 0.4502677023410797
The modified gen p mean: 0.4483937621116638, gen p mean: -0.04757079854607582, mean p set: 0.4488740861415863
The modified gen p mean: 0.44948598742485046, gen p mean: -0.05552772060036659, mean p set: 0.44996631145477295
loss_pred:0.014271313324570656, decouple_loss:0.0011751150013878942
loss_pred:0.014912620186805725, decouple_loss:0.0010990917216986418
loss_pred:0.01488287840038538, decouple_loss:0.0011983613949269056
Iteration: 1172, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497798681259155, gen p mean: -0.04892684891819954, mean p set: 0.45026013255119324
The modified gen p mean: 0.45080986618995667, gen p mean: -0.0462031252682209, mean p set: 0.45129016041755676
loss_pred:0.014862850308418274, decouple_loss:0.0013077177572995424
loss_pred:0.014713863842189312, decouple_loss:0.001293711131438613
The modified gen p mean: 0.450296014547348, gen p mean: -0.0431847982108593, mean p set: 0.4507763385772705
loss_pred:0.014469730667769909, decouple_loss:0.0014467714354395866
Iteration: 1173, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503858983516693, gen p mean: -0.04376019537448883, mean p set: 0.4508661925792694
loss_pred:0.014380807988345623, decouple_loss:0.0013188478769734502
The modified gen p mean: 0.44965091347694397, gen p mean: -0.045454978942871094, mean p set: 0.45013123750686646The modified gen p mean: 0.4501102566719055, gen p mean: -0.042694658041000366, mean p set: 0.4505905210971832
loss_pred:0.014688393101096153, decouple_loss:0.0012829634360969067
loss_pred:0.014605613425374031, decouple_loss:0.0012446806067600846
Iteration: 1174, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498368203639984, gen p mean: -0.05159423127770424, mean p set: 0.4503171145915985
loss_pred:0.014011556282639503, decouple_loss:0.0013806727947667241
The modified gen p mean: 0.44969239830970764, gen p mean: -0.049984272569417953, mean p set: 0.45017269253730774The modified gen p mean: 0.44837287068367004, gen p mean: -0.04612158611416817, mean p set: 0.44885316491127014
loss_pred:0.014193584211170673, decouple_loss:0.0014007496647536755
loss_pred:0.014610548503696918, decouple_loss:0.0014903595438227057
Iteration: 1175, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492749571800232, gen p mean: -0.038464270532131195, mean p set: 0.4497552812099457
loss_pred:0.014097800478339195, decouple_loss:0.0013647719752043486
The modified gen p mean: 0.44860759377479553, gen p mean: -0.046872735023498535, mean p set: 0.44908788800239563The modified gen p mean: 0.44802966713905334, gen p mean: -0.049043573439121246, mean p set: 0.44850999116897583
loss_pred:0.014859545044600964, decouple_loss:0.0013821508036926389
loss_pred:0.014532659202814102, decouple_loss:0.001510634203441441
Iteration: 1176, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44797298312187195, gen p mean: -0.04264858365058899, mean p set: 0.44845327734947205
loss_pred:0.013811806216835976, decouple_loss:0.0013258293038234115
The modified gen p mean: 0.4491842985153198, gen p mean: -0.042537808418273926, mean p set: 0.4496645927429199The modified gen p mean: 0.44886115193367004, gen p mean: -0.04068417474627495, mean p set: 0.44934147596359253
loss_pred:0.01416994072496891, decouple_loss:0.001221228507347405
loss_pred:0.014606076292693615, decouple_loss:0.0013184701092541218
Iteration: 1177, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44901031255722046, gen p mean: -0.041848864406347275, mean p set: 0.44949063658714294
loss_pred:0.013978696428239346, decouple_loss:0.0015396614326164126
The modified gen p mean: 0.44836920499801636, gen p mean: -0.044593438506126404, mean p set: 0.44884949922561646The modified gen p mean: 0.44919630885124207, gen p mean: -0.04171343892812729, mean p set: 0.4496765732765198
loss_pred:0.014557779766619205, decouple_loss:0.0015743542462587357
loss_pred:0.014447314664721489, decouple_loss:0.0014577364781871438
Iteration: 1178, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500710964202881, gen p mean: -0.03982388228178024, mean p set: 0.4505513906478882
loss_pred:0.013851311057806015, decouple_loss:0.0012906101765111089
The modified gen p mean: 0.4492708444595337, gen p mean: -0.04115983843803406, mean p set: 0.4497511684894562The modified gen p mean: 0.449203222990036, gen p mean: -0.04518337920308113, mean p set: 0.4496835172176361
loss_pred:0.014341005124151707, decouple_loss:0.001497156685218215
loss_pred:0.013765397481620312, decouple_loss:0.0014954757643863559
Iteration: 1179, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484655559062958, gen p mean: -0.045408643782138824, mean p set: 0.4489458501338959
loss_pred:0.013871154747903347, decouple_loss:0.0015039155259728432
The modified gen p mean: 0.44943392276763916, gen p mean: -0.03952779993414879, mean p set: 0.44991418719291687The modified gen p mean: 0.4501873850822449, gen p mean: -0.03762849420309067, mean p set: 0.45066767930984497
loss_pred:0.014126289635896683, decouple_loss:0.0012363222194835544
loss_pred:0.014461511746048927, decouple_loss:0.0012496947310864925
Iteration: 1180, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44858768582344055, gen p mean: -0.04059825465083122, mean p set: 0.44906798005104065
loss_pred:0.014106792397797108, decouple_loss:0.001443991088308394
The modified gen p mean: 0.4496931731700897, gen p mean: -0.041066452860832214, mean p set: 0.4501734673976898The modified gen p mean: 0.450138658285141, gen p mean: -0.03956133872270584, mean p set: 0.4506189823150635
loss_pred:0.01403773296624422, decouple_loss:0.0014301869086921215
loss_pred:0.013877004384994507, decouple_loss:0.0015489934012293816
2023-05-02 07:08:41 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.04672368988394737, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04275840148329735, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.0429006926715374, mean p set: 0.4500633478164673
loss_pred:0.01909167692065239, decouple_loss:0.0014209779910743237
loss_pred:0.017906630411744118, decouple_loss:0.0014075093204155564
loss_pred:0.017999062314629555, decouple_loss:0.0013446914963424206
WV_0_PC_1_EH_0_PS_40, loss: 0.018402010202407837, avg_mse: 0.026741011068224907
current test mse: 0.026741
Iteration: 1181, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44965627789497375, gen p mean: -0.043145567178726196, mean p set: 0.45013657212257385
The modified gen p mean: 0.44863173365592957, gen p mean: -0.044161390513181686, mean p set: 0.4491119980812073
The modified gen p mean: 0.4508246183395386, gen p mean: -0.03878804296255112, mean p set: 0.45130491256713867
loss_pred:0.014016978442668915, decouple_loss:0.0012407146859914064
loss_pred:0.013861317187547684, decouple_loss:0.0012475964613258839
loss_pred:0.014291404746472836, decouple_loss:0.0014582048170268536
Iteration: 1182, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500034749507904, gen p mean: -0.044706009328365326, mean p set: 0.4504837691783905
loss_pred:0.014188426546752453, decouple_loss:0.0012629411648958921
The modified gen p mean: 0.44926688075065613, gen p mean: -0.04297788813710213, mean p set: 0.4497471749782562The modified gen p mean: 0.4488268494606018, gen p mean: -0.046394843608140945, mean p set: 0.4493071436882019
loss_pred:0.013251408003270626, decouple_loss:0.0012625760864466429
loss_pred:0.014263446442782879, decouple_loss:0.001409777905791998
Iteration: 1183, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485131502151489, gen p mean: -0.04915973171591759, mean p set: 0.448993444442749
loss_pred:0.013938769698143005, decouple_loss:0.001268788706511259
The modified gen p mean: 0.4480578303337097, gen p mean: -0.04635639116168022, mean p set: 0.4485381245613098The modified gen p mean: 0.44947436451911926, gen p mean: -0.044227395206689835, mean p set: 0.44995465874671936
loss_pred:0.01399948913604021, decouple_loss:0.0013542239321395755
loss_pred:0.014569127932190895, decouple_loss:0.0012451520888134837
Iteration: 1184, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493621587753296, gen p mean: -0.049969471991062164, mean p set: 0.4498424530029297
loss_pred:0.014180809259414673, decouple_loss:0.0013335489202290773
The modified gen p mean: 0.4496731758117676, gen p mean: -0.04573466628789902, mean p set: 0.4501534700393677The modified gen p mean: 0.4489395022392273, gen p mean: -0.05009292811155319, mean p set: 0.4494198262691498
loss_pred:0.01428267452865839, decouple_loss:0.001384714967571199
loss_pred:0.014348717406392097, decouple_loss:0.0012801220873370767
Iteration: 1185, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45058590173721313, gen p mean: -0.04769444465637207, mean p set: 0.45106619596481323
loss_pred:0.013510767370462418, decouple_loss:0.0011396111221984029
The modified gen p mean: 0.4492861032485962, gen p mean: -0.0471365749835968, mean p set: 0.4497663974761963The modified gen p mean: 0.44903796911239624, gen p mean: -0.05247855558991432, mean p set: 0.4495182931423187
loss_pred:0.013946624472737312, decouple_loss:0.0011860271915793419
loss_pred:0.01379413716495037, decouple_loss:0.0012080997694283724
Iteration: 1186, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449287086725235, gen p mean: -0.04898541793227196, mean p set: 0.4497673809528351
loss_pred:0.014075233601033688, decouple_loss:0.0013288237387314439
The modified gen p mean: 0.4490286111831665, gen p mean: -0.04742049053311348, mean p set: 0.4495089054107666The modified gen p mean: 0.4506630301475525, gen p mean: -0.04556039348244667, mean p set: 0.451143354177475
loss_pred:0.013750177808105946, decouple_loss:0.0012489818036556244
loss_pred:0.013999014161527157, decouple_loss:0.0012348219752311707
Iteration: 1187, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492380917072296, gen p mean: -0.04605206847190857, mean p set: 0.4497183561325073
The modified gen p mean: 0.44874081015586853, gen p mean: -0.05243513733148575, mean p set: 0.449221134185791
loss_pred:0.014235733076930046, decouple_loss:0.0012901105219498277
loss_pred:0.013387962244451046, decouple_loss:0.0013142158277332783
The modified gen p mean: 0.44765859842300415, gen p mean: -0.046913135796785355, mean p set: 0.44813892245292664
loss_pred:0.014694646932184696, decouple_loss:0.0012444851454347372
Iteration: 1188, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489181935787201, gen p mean: -0.04554538056254387, mean p set: 0.4493984878063202
loss_pred:0.01411979179829359, decouple_loss:0.0011101275449618697
The modified gen p mean: 0.44919705390930176, gen p mean: -0.04662550240755081, mean p set: 0.44967731833457947The modified gen p mean: 0.45090633630752563, gen p mean: -0.041595458984375, mean p set: 0.45138660073280334
loss_pred:0.013647920452058315, decouple_loss:0.0011750927660614252
loss_pred:0.013793094083666801, decouple_loss:0.0011879121884703636
Iteration: 1189, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502295255661011, gen p mean: -0.039716124534606934, mean p set: 0.45070981979370117
loss_pred:0.01400808896869421, decouple_loss:0.0012700615916401148
The modified gen p mean: 0.4501243233680725, gen p mean: -0.0392264723777771, mean p set: 0.4506046175956726The modified gen p mean: 0.44911807775497437, gen p mean: -0.039687540382146835, mean p set: 0.44959837198257446
loss_pred:0.014157437719404697, decouple_loss:0.001197932055220008
loss_pred:0.01448015682399273, decouple_loss:0.0011931124608963728
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012011_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012011_3_24hr.npz
NaN value num: 0
Iteration: 1190, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464486241340637, gen p mean: -0.046388134360313416, mean p set: 0.4469289183616638
loss_pred:0.014230241067707539, decouple_loss:0.0011016800999641418
The modified gen p mean: 0.44582653045654297, gen p mean: -0.044989071786403656, mean p set: 0.44630685448646545The modified gen p mean: 0.4480065703392029, gen p mean: -0.051413409411907196, mean p set: 0.448486864566803
loss_pred:0.015076343901455402, decouple_loss:0.0011659972369670868
loss_pred:0.014729408547282219, decouple_loss:0.001141987508162856
2023-05-02 07:11:14 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.049018386751413345, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.045136746019124985, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04536188393831253, mean p set: 0.4500633478164673
loss_pred:0.018867559731006622, decouple_loss:0.0012664778623729944
loss_pred:0.01782125234603882, decouple_loss:0.0012697512283921242
loss_pred:0.017803743481636047, decouple_loss:0.0012873101513832808
WV_0_PC_1_EH_0_PS_40, loss: 0.01822791062295437, avg_mse: 0.02646363526582718
current test mse: 0.026464
Iteration: 1191, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479667842388153, gen p mean: -0.04863426834344864, mean p set: 0.4484470784664154
The modified gen p mean: 0.4462599754333496, gen p mean: -0.045549631118774414, mean p set: 0.4467402696609497
The modified gen p mean: 0.4456796944141388, gen p mean: -0.054127953946590424, mean p set: 0.4461599588394165
loss_pred:0.014525726437568665, decouple_loss:0.0013939319178462029
loss_pred:0.014602613635361195, decouple_loss:0.001254997099749744
loss_pred:0.015054509043693542, decouple_loss:0.0012244214303791523
Iteration: 1192, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44646894931793213, gen p mean: -0.04844897240400314, mean p set: 0.44694921374320984
loss_pred:0.014550318010151386, decouple_loss:0.0010801710886880755
The modified gen p mean: 0.4469195306301117, gen p mean: -0.048032164573669434, mean p set: 0.4473998546600342The modified gen p mean: 0.4473292827606201, gen p mean: -0.05153438821434975, mean p set: 0.4478095471858978
loss_pred:0.014243004843592644, decouple_loss:0.0010788232320919633
loss_pred:0.014224410988390446, decouple_loss:0.001215959433466196
Iteration: 1193, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44817230105400085, gen p mean: -0.048690516501665115, mean p set: 0.44865259528160095
loss_pred:0.014196679927408695, decouple_loss:0.00121231225784868
The modified gen p mean: 0.44883668422698975, gen p mean: -0.05048637464642525, mean p set: 0.44931700825691223The modified gen p mean: 0.4473477900028229, gen p mean: -0.048636920750141144, mean p set: 0.4478280544281006
loss_pred:0.014279358088970184, decouple_loss:0.0013614882482215762
loss_pred:0.014323192648589611, decouple_loss:0.0013533653691411018
Iteration: 1194, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44568493962287903, gen p mean: -0.054517537355422974, mean p set: 0.4461652636528015
loss_pred:0.014518585056066513, decouple_loss:0.0012518748408183455
The modified gen p mean: 0.4463035464286804, gen p mean: -0.047600157558918, mean p set: 0.4467838406562805The modified gen p mean: 0.44647493958473206, gen p mean: -0.04902460053563118, mean p set: 0.44695523381233215
loss_pred:0.01404966413974762, decouple_loss:0.001179227721877396
loss_pred:0.013978205621242523, decouple_loss:0.0011301814811304212
Iteration: 1195, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478110373020172, gen p mean: -0.04844645410776138, mean p set: 0.4482913017272949
loss_pred:0.014316586777567863, decouple_loss:0.001314409775659442
The modified gen p mean: 0.44609495997428894, gen p mean: -0.04839358106255531, mean p set: 0.4465752840042114The modified gen p mean: 0.44710493087768555, gen p mean: -0.044450677931308746, mean p set: 0.44758522510528564
loss_pred:0.01445364486426115, decouple_loss:0.0012000433634966612
loss_pred:0.014345459640026093, decouple_loss:0.0011532744392752647
Iteration: 1196, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475928544998169, gen p mean: -0.046235933899879456, mean p set: 0.448073148727417
loss_pred:0.014375709928572178, decouple_loss:0.0012807140592485666
The modified gen p mean: 0.4467124044895172, gen p mean: -0.04678165912628174, mean p set: 0.4471926689147949The modified gen p mean: 0.44904762506484985, gen p mean: -0.049547091126441956, mean p set: 0.44952791929244995
loss_pred:0.014709752053022385, decouple_loss:0.001317253103479743
loss_pred:0.014251708053052425, decouple_loss:0.0012563937343657017
Iteration: 1197, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481782019138336, gen p mean: -0.04821428284049034, mean p set: 0.4486584961414337
loss_pred:0.014215591363608837, decouple_loss:0.0012003122828900814
The modified gen p mean: 0.44751572608947754, gen p mean: -0.05028741434216499, mean p set: 0.44799599051475525The modified gen p mean: 0.448574036359787, gen p mean: -0.05014818161725998, mean p set: 0.4490543007850647
loss_pred:0.01386553980410099, decouple_loss:0.001269244123250246
loss_pred:0.01462394930422306, decouple_loss:0.0012510438682511449
Iteration: 1198, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4458253085613251, gen p mean: -0.04726206511259079, mean p set: 0.44630563259124756
loss_pred:0.013931439258158207, decouple_loss:0.0011968145845457911
The modified gen p mean: 0.44885820150375366, gen p mean: -0.05258992314338684, mean p set: 0.44933852553367615The modified gen p mean: 0.4461468756198883, gen p mean: -0.04446597024798393, mean p set: 0.4466271698474884
loss_pred:0.014438400976359844, decouple_loss:0.0012883562594652176
loss_pred:0.014503320679068565, decouple_loss:0.0010952077573165298
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1199, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468764066696167, gen p mean: -0.05127402022480965, mean p set: 0.4473566710948944
loss_pred:0.014160189777612686, decouple_loss:0.0010920100612565875
The modified gen p mean: 0.44667911529541016, gen p mean: -0.0518018864095211, mean p set: 0.44715940952301025The modified gen p mean: 0.4467659592628479, gen p mean: -0.04726918041706085, mean p set: 0.447246253490448
loss_pred:0.014531182125210762, decouple_loss:0.0012400834821164608
loss_pred:0.014124469831585884, decouple_loss:0.0010861915070563555
Iteration: 1200, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466908872127533, gen p mean: -0.05402838811278343, mean p set: 0.4471711814403534
loss_pred:0.014205724000930786, decouple_loss:0.001133910845965147
The modified gen p mean: 0.44810667634010315, gen p mean: -0.052260708063840866, mean p set: 0.44858697056770325The modified gen p mean: 0.4472636580467224, gen p mean: -0.052497442811727524, mean p set: 0.4477439522743225
loss_pred:0.014426936395466328, decouple_loss:0.0010927513940259814
loss_pred:0.013895183801651001, decouple_loss:0.0011066169245168567
2023-05-02 07:13:09 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.052075013518333435, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.0477730818092823, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.048081930726766586, mean p set: 0.4500633478164673
loss_pred:0.01892147585749626, decouple_loss:0.0012674718163907528
loss_pred:0.017893077805638313, decouple_loss:0.0013474853476509452
loss_pred:0.01791388727724552, decouple_loss:0.0012166086817160249
WV_0_PC_1_EH_0_PS_40, loss: 0.0183066725730896, avg_mse: 0.02661677449941635
current test mse: 0.026617
Iteration: 1201, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44525769352912903, gen p mean: -0.054378412663936615, mean p set: 0.44573795795440674
The modified gen p mean: 0.4483022391796112, gen p mean: -0.04882819578051567, mean p set: 0.4487825632095337
The modified gen p mean: 0.4459315240383148, gen p mean: -0.04949507117271423, mean p set: 0.4464118480682373
loss_pred:0.014891967177391052, decouple_loss:0.0012687722919508815
loss_pred:0.0140457171946764, decouple_loss:0.0011919382959604263
loss_pred:0.01403042208403349, decouple_loss:0.0012684414396062493
Iteration: 1202, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4459937512874603, gen p mean: -0.04590233042836189, mean p set: 0.44647401571273804
The modified gen p mean: 0.4474453330039978, gen p mean: -0.05256548523902893, mean p set: 0.4479255974292755
loss_pred:0.014474050141870975, decouple_loss:0.0011712310370057821
loss_pred:0.014714756049215794, decouple_loss:0.0011944440193474293
The modified gen p mean: 0.44620752334594727, gen p mean: -0.047089189291000366, mean p set: 0.44668781757354736
loss_pred:0.014848138205707073, decouple_loss:0.001162231434136629
Iteration: 1203, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44746020436286926, gen p mean: -0.04937078431248665, mean p set: 0.44794052839279175
The modified gen p mean: 0.44734594225883484, gen p mean: -0.04478466138243675, mean p set: 0.44782623648643494
loss_pred:0.014006347395479679, decouple_loss:0.0013893905561417341
loss_pred:0.014124087058007717, decouple_loss:0.0013441129121929407
The modified gen p mean: 0.44603100419044495, gen p mean: -0.04395926743745804, mean p set: 0.44651132822036743
loss_pred:0.014735376462340355, decouple_loss:0.0011855921475216746
Iteration: 1204, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4463250935077667, gen p mean: -0.04230690002441406, mean p set: 0.44680535793304443The modified gen p mean: 0.4468863010406494, gen p mean: -0.04667414724826813, mean p set: 0.4473665952682495
loss_pred:0.013847682625055313, decouple_loss:0.0010856372537091374loss_pred:0.014331204816699028, decouple_loss:0.0012517948634922504
The modified gen p mean: 0.44664016366004944, gen p mean: -0.04543228819966316, mean p set: 0.44712045788764954
loss_pred:0.014089818112552166, decouple_loss:0.0010847407393157482
Iteration: 1205, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44625359773635864, gen p mean: -0.04577728733420372, mean p set: 0.44673389196395874
loss_pred:0.013951851986348629, decouple_loss:0.0010579493828117847
The modified gen p mean: 0.44627127051353455, gen p mean: -0.04470249265432358, mean p set: 0.44675159454345703The modified gen p mean: 0.44879674911499023, gen p mean: -0.047469377517700195, mean p set: 0.44927704334259033
loss_pred:0.014080999419093132, decouple_loss:0.0011694264831021428
loss_pred:0.014278688468039036, decouple_loss:0.0012977789156138897
Iteration: 1206, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44760069251060486, gen p mean: -0.045968666672706604, mean p set: 0.44808098673820496
loss_pred:0.014303822070360184, decouple_loss:0.0011294397991150618
The modified gen p mean: 0.4472138583660126, gen p mean: -0.04665704816579819, mean p set: 0.4476941227912903The modified gen p mean: 0.44859594106674194, gen p mean: -0.049299467355012894, mean p set: 0.44907623529434204
loss_pred:0.014774519950151443, decouple_loss:0.0012066825293004513
loss_pred:0.014475409872829914, decouple_loss:0.0011146320030093193
Iteration: 1207, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44677528738975525, gen p mean: -0.04876101762056351, mean p set: 0.44725558161735535
The modified gen p mean: 0.44577547907829285, gen p mean: -0.0456719808280468, mean p set: 0.44625577330589294
loss_pred:0.014103327877819538, decouple_loss:0.0010845984797924757
loss_pred:0.01447474304586649, decouple_loss:0.001183556392788887The modified gen p mean: 0.44641295075416565, gen p mean: -0.05060836300253868, mean p set: 0.44689324498176575
loss_pred:0.01458683144301176, decouple_loss:0.0011654592817649245
Iteration: 1208, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44820308685302734, gen p mean: -0.049683138728141785, mean p set: 0.44868341088294983
loss_pred:0.014139794744551182, decouple_loss:0.0013013924472033978
The modified gen p mean: 0.4474707841873169, gen p mean: -0.05300644785165787, mean p set: 0.447951078414917The modified gen p mean: 0.4452894926071167, gen p mean: -0.05433405563235283, mean p set: 0.4457697868347168
loss_pred:0.014082583598792553, decouple_loss:0.0011197931598871946
loss_pred:0.01393920835107565, decouple_loss:0.001195294433273375
Iteration: 1209, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44739651679992676, gen p mean: -0.048988062888383865, mean p set: 0.44787678122520447
loss_pred:0.014341030269861221, decouple_loss:0.0010989176807925105
The modified gen p mean: 0.4468235969543457, gen p mean: -0.0540432408452034, mean p set: 0.4473038911819458The modified gen p mean: 0.4466208219528198, gen p mean: -0.05513999983668327, mean p set: 0.4471011161804199
loss_pred:0.014155147597193718, decouple_loss:0.0011139267589896917
loss_pred:0.014032124541699886, decouple_loss:0.001074964297004044
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012002_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012002_3_24hr.npz
NaN value num: 0
Iteration: 1210, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44906169176101685, gen p mean: -0.053979579359292984, mean p set: 0.44954198598861694
loss_pred:0.017516115680336952, decouple_loss:0.0011549195041880012
The modified gen p mean: 0.44608253240585327, gen p mean: -0.04801062494516373, mean p set: 0.446562796831131The modified gen p mean: 0.447207510471344, gen p mean: -0.05029704421758652, mean p set: 0.4476877748966217
loss_pred:0.017217708751559258, decouple_loss:0.0010908721014857292
loss_pred:0.017274955287575722, decouple_loss:0.0011506403097882867
2023-05-02 07:15:42 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.04968002438545227, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04536692053079605, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04578511789441109, mean p set: 0.4500633478164673
loss_pred:0.018625009804964066, decouple_loss:0.0012650355929508805
loss_pred:0.017662469297647476, decouple_loss:0.0013279347913339734
loss_pred:0.017656393349170685, decouple_loss:0.0012069424847140908
WV_0_PC_1_EH_0_PS_40, loss: 0.018044624477624893, avg_mse: 0.026089802384376526
current test mse: 0.02609
Iteration: 1211, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44631367921829224, gen p mean: -0.04707096517086029, mean p set: 0.44679397344589233
The modified gen p mean: 0.44877079129219055, gen p mean: -0.04920167848467827, mean p set: 0.44925111532211304
The modified gen p mean: 0.4473472237586975, gen p mean: -0.04955008625984192, mean p set: 0.4478275179862976
loss_pred:0.017040321603417397, decouple_loss:0.0011258873855695128
loss_pred:0.018277419731020927, decouple_loss:0.0012237763730809093
loss_pred:0.016816172748804092, decouple_loss:0.0012746505672112107
Iteration: 1212, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44694700837135315, gen p mean: -0.04457462579011917, mean p set: 0.44742733240127563
loss_pred:0.017055904492735863, decouple_loss:0.0012402613647282124
The modified gen p mean: 0.447806715965271, gen p mean: -0.04826453700661659, mean p set: 0.4482870399951935The modified gen p mean: 0.4457029104232788, gen p mean: -0.044884417206048965, mean p set: 0.4461832046508789
loss_pred:0.016643358394503593, decouple_loss:0.001261205761693418
loss_pred:0.016794193536043167, decouple_loss:0.0013217178639024496
Iteration: 1213, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486159682273865, gen p mean: -0.049039576202631, mean p set: 0.44909629225730896
loss_pred:0.01735352911055088, decouple_loss:0.001342940959148109
The modified gen p mean: 0.44649532437324524, gen p mean: -0.0427226684987545, mean p set: 0.44697561860084534The modified gen p mean: 0.44711974263191223, gen p mean: -0.04716115817427635, mean p set: 0.44760003685951233
loss_pred:0.01671433076262474, decouple_loss:0.00135750079061836
loss_pred:0.016422230750322342, decouple_loss:0.0012993777636438608
Iteration: 1214, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44587406516075134, gen p mean: -0.04424300789833069, mean p set: 0.44635435938835144
loss_pred:0.01583251729607582, decouple_loss:0.0011994625674560666
The modified gen p mean: 0.4482938349246979, gen p mean: -0.048561256378889084, mean p set: 0.448774129152298The modified gen p mean: 0.4477980136871338, gen p mean: -0.047234512865543365, mean p set: 0.4482783079147339
loss_pred:0.017077861353754997, decouple_loss:0.001277560368180275
loss_pred:0.016456449404358864, decouple_loss:0.0012806057929992676
Iteration: 1215, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447517454624176, gen p mean: -0.050881654024124146, mean p set: 0.4479977488517761
loss_pred:0.016827290877699852, decouple_loss:0.0013186120195314288
The modified gen p mean: 0.44767045974731445, gen p mean: -0.05003247782588005, mean p set: 0.44815075397491455The modified gen p mean: 0.4487651586532593, gen p mean: -0.04959053173661232, mean p set: 0.4492454528808594
loss_pred:0.016814270988106728, decouple_loss:0.0013375122798606753
loss_pred:0.016474857926368713, decouple_loss:0.0013584010303020477
Iteration: 1216, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4457554519176483, gen p mean: -0.05257325991988182, mean p set: 0.4462357461452484
loss_pred:0.016962360590696335, decouple_loss:0.0013340295990929008
The modified gen p mean: 0.44793158769607544, gen p mean: -0.053334493190050125, mean p set: 0.44841188192367554The modified gen p mean: 0.44659224152565, gen p mean: -0.05123024061322212, mean p set: 0.4470725357532501
loss_pred:0.016383355483412743, decouple_loss:0.0013531165895983577
loss_pred:0.01733643375337124, decouple_loss:0.0011796635808423162
Iteration: 1217, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4459373950958252, gen p mean: -0.05377886816859245, mean p set: 0.4464176893234253
loss_pred:0.016286740079522133, decouple_loss:0.0011644670739769936
The modified gen p mean: 0.4461633265018463, gen p mean: -0.055593520402908325, mean p set: 0.446643590927124The modified gen p mean: 0.4488300383090973, gen p mean: -0.05565449967980385, mean p set: 0.4493103623390198
loss_pred:0.016445891931653023, decouple_loss:0.0012287816498428583
loss_pred:0.016458047553896904, decouple_loss:0.0012192492140457034
Iteration: 1218, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44572097063064575, gen p mean: -0.05632921680808067, mean p set: 0.44620129466056824
loss_pred:0.01625242456793785, decouple_loss:0.0012240111827850342
The modified gen p mean: 0.4467291533946991, gen p mean: -0.06083686277270317, mean p set: 0.4472094774246216The modified gen p mean: 0.4467082917690277, gen p mean: -0.05472540110349655, mean p set: 0.4471885859966278
loss_pred:0.015593448653817177, decouple_loss:0.0013574718032032251
loss_pred:0.01671324111521244, decouple_loss:0.0013504752423614264
Iteration: 1219, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44721871614456177, gen p mean: -0.06125766038894653, mean p set: 0.4476989805698395
loss_pred:0.016988292336463928, decouple_loss:0.0012156638549640775
The modified gen p mean: 0.44848331809043884, gen p mean: -0.061784762889146805, mean p set: 0.44896358251571655The modified gen p mean: 0.4463766813278198, gen p mean: -0.05731669068336487, mean p set: 0.4468569755554199
loss_pred:0.016391899436712265, decouple_loss:0.0012186469975858927
loss_pred:0.016524864360690117, decouple_loss:0.0012548710219562054
Iteration: 1220, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4461938142776489, gen p mean: -0.05865347385406494, mean p set: 0.446674108505249
loss_pred:0.01609347015619278, decouple_loss:0.0010581719689071178
The modified gen p mean: 0.4467898905277252, gen p mean: -0.05846921354532242, mean p set: 0.44727015495300293The modified gen p mean: 0.44585973024368286, gen p mean: -0.05921861156821251, mean p set: 0.44634005427360535
loss_pred:0.016683587804436684, decouple_loss:0.0010805820347741246
loss_pred:0.016987429931759834, decouple_loss:0.0011414013570174575
2023-05-02 07:17:34 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.06302425265312195, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.05857745558023453, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.059096187353134155, mean p set: 0.4500633478164673
loss_pred:0.018307210877537727, decouple_loss:0.0012567793019115925
loss_pred:0.017231129109859467, decouple_loss:0.0012664365349337459
loss_pred:0.01730792224407196, decouple_loss:0.0012560015311464667
WV_0_PC_1_EH_0_PS_40, loss: 0.017678407952189445, avg_mse: 0.025320276618003845
current test mse: 0.02532
Iteration: 1221, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44630491733551025, gen p mean: -0.06535740941762924, mean p set: 0.44678524136543274
The modified gen p mean: 0.44708073139190674, gen p mean: -0.060529742389917374, mean p set: 0.4475610554218292
The modified gen p mean: 0.44572705030441284, gen p mean: -0.05953238159418106, mean p set: 0.44620731472969055
loss_pred:0.017215019091963768, decouple_loss:0.001222616876475513
loss_pred:0.016405193135142326, decouple_loss:0.0012768678134307265
loss_pred:0.01643483340740204, decouple_loss:0.0012614154256880283
Iteration: 1222, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44563642144203186, gen p mean: -0.0589994415640831, mean p set: 0.44611674547195435
The modified gen p mean: 0.44953835010528564, gen p mean: -0.059647634625434875, mean p set: 0.45001867413520813
loss_pred:0.016345586627721786, decouple_loss:0.0011030046734958887
loss_pred:0.01644231379032135, decouple_loss:0.001216630102135241
The modified gen p mean: 0.44560834765434265, gen p mean: -0.061521224677562714, mean p set: 0.44608867168426514
loss_pred:0.017170028761029243, decouple_loss:0.001252317219041288
Iteration: 1223, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464660584926605, gen p mean: -0.06205175444483757, mean p set: 0.446946382522583
The modified gen p mean: 0.4478932023048401, gen p mean: -0.06314640492200851, mean p set: 0.4483734667301178
loss_pred:0.016854017972946167, decouple_loss:0.0012048815842717886
loss_pred:0.016415223479270935, decouple_loss:0.0013006124645471573
The modified gen p mean: 0.44663166999816895, gen p mean: -0.05708688870072365, mean p set: 0.44711199402809143
loss_pred:0.016998305916786194, decouple_loss:0.0013624755665659904
Iteration: 1224, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44690144062042236, gen p mean: -0.05901113897562027, mean p set: 0.44738173484802246
loss_pred:0.016784045845270157, decouple_loss:0.0012223091907799244
The modified gen p mean: 0.4471961259841919, gen p mean: -0.06370018422603607, mean p set: 0.447676420211792The modified gen p mean: 0.44695520401000977, gen p mean: -0.05876142159104347, mean p set: 0.44743549823760986
loss_pred:0.01728973165154457, decouple_loss:0.0013537819031625986
loss_pred:0.01702563650906086, decouple_loss:0.001266175415366888
Iteration: 1225, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4463149309158325, gen p mean: -0.05892915278673172, mean p set: 0.44679519534111023
The modified gen p mean: 0.447654664516449, gen p mean: -0.060218412429094315, mean p set: 0.4481349289417267
loss_pred:0.016248567029833794, decouple_loss:0.0011663397308439016
loss_pred:0.01702919416129589, decouple_loss:0.0012902223970741034
The modified gen p mean: 0.446042537689209, gen p mean: -0.05937587097287178, mean p set: 0.44652286171913147
loss_pred:0.016662487760186195, decouple_loss:0.0012576848967000842
Iteration: 1226, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44654712080955505, gen p mean: -0.06098609045147896, mean p set: 0.44702741503715515
loss_pred:0.015944084152579308, decouple_loss:0.0014350998681038618
The modified gen p mean: 0.44721418619155884, gen p mean: -0.0592096745967865, mean p set: 0.44769448041915894The modified gen p mean: 0.44687435030937195, gen p mean: -0.05841558799147606, mean p set: 0.44735464453697205
loss_pred:0.016507133841514587, decouple_loss:0.0014095184160396457
loss_pred:0.01616913452744484, decouple_loss:0.0014561708085238934
Iteration: 1227, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4462195634841919, gen p mean: -0.05796487629413605, mean p set: 0.4466998875141144
The modified gen p mean: 0.44681331515312195, gen p mean: -0.05878158658742905, mean p set: 0.44729360938072205
loss_pred:0.016489358618855476, decouple_loss:0.0010464779334142804
The modified gen p mean: 0.4496762156486511, gen p mean: -0.05968126282095909, mean p set: 0.4501565396785736
loss_pred:0.016396591439843178, decouple_loss:0.0011284786742180586
loss_pred:0.01631592959165573, decouple_loss:0.0012287459103390574
Iteration: 1228, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4463620185852051, gen p mean: -0.058821264654397964, mean p set: 0.4468423128128052
The modified gen p mean: 0.44660162925720215, gen p mean: -0.05387948080897331, mean p set: 0.44708189368247986
loss_pred:0.016599856317043304, decouple_loss:0.0012290633749216795
loss_pred:0.016851166263222694, decouple_loss:0.0012165273074060678
The modified gen p mean: 0.4469471573829651, gen p mean: -0.061545051634311676, mean p set: 0.4474274814128876
loss_pred:0.015988653525710106, decouple_loss:0.0013392703840509057
Iteration: 1229, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44580021500587463, gen p mean: -0.061542317271232605, mean p set: 0.44628050923347473
loss_pred:0.01632108725607395, decouple_loss:0.0011269432725384831
The modified gen p mean: 0.44606515765190125, gen p mean: -0.05659003183245659, mean p set: 0.44654545187950134The modified gen p mean: 0.44691091775894165, gen p mean: -0.060398418456315994, mean p set: 0.44739121198654175
loss_pred:0.01708834432065487, decouple_loss:0.0010908301919698715
loss_pred:0.017058266326785088, decouple_loss:0.001152095734141767
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012015_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012015_3_24hr.npz
NaN value num: 0
Iteration: 1230, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45182010531425476, gen p mean: -0.04593431204557419, mean p set: 0.45230039954185486
loss_pred:0.01704237423837185, decouple_loss:0.0012540790485218167
The modified gen p mean: 0.4490700364112854, gen p mean: -0.04874333366751671, mean p set: 0.4495503306388855The modified gen p mean: 0.44938963651657104, gen p mean: -0.04859102889895439, mean p set: 0.44986993074417114
loss_pred:0.017096884548664093, decouple_loss:0.0012718809302896261
loss_pred:0.016245778650045395, decouple_loss:0.0012581171467900276
2023-05-02 07:20:01 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.05526761710643768, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.05129869282245636, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.051621679216623306, mean p set: 0.4500633478164673
loss_pred:0.018317298963665962, decouple_loss:0.0012092419201508164
loss_pred:0.017192618921399117, decouple_loss:0.0011263454798609018
loss_pred:0.017306514084339142, decouple_loss:0.001147065544500947
WV_0_PC_1_EH_0_PS_40, loss: 0.01766352169215679, avg_mse: 0.025321461260318756
current test mse: 0.025321
Iteration: 1231, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45065775513648987, gen p mean: -0.047848355025053024, mean p set: 0.45113804936408997
The modified gen p mean: 0.4498754143714905, gen p mean: -0.047967858612537384, mean p set: 0.4503557085990906
The modified gen p mean: 0.45097872614860535, gen p mean: -0.04444189742207527, mean p set: 0.45145899057388306
loss_pred:0.01737813465297222, decouple_loss:0.0011595890391618013
loss_pred:0.016386471688747406, decouple_loss:0.0012463383609429002
loss_pred:0.016248932108283043, decouple_loss:0.0012955552665516734
Iteration: 1232, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450418084859848, gen p mean: -0.04349389672279358, mean p set: 0.4508983790874481
The modified gen p mean: 0.4493275582790375, gen p mean: -0.03967894986271858, mean p set: 0.44980788230895996
loss_pred:0.016415484249591827, decouple_loss:0.001208808273077011
loss_pred:0.016991132870316505, decouple_loss:0.0011573882075026631
The modified gen p mean: 0.4499472379684448, gen p mean: -0.04464808851480484, mean p set: 0.45042750239372253
loss_pred:0.016529371961951256, decouple_loss:0.0011886050924658775
Iteration: 1233, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490688443183899, gen p mean: -0.04530804604291916, mean p set: 0.4495491087436676The modified gen p mean: 0.4509621262550354, gen p mean: -0.04748161509633064, mean p set: 0.4514424204826355
loss_pred:0.016466422006487846, decouple_loss:0.0013012309791520238
loss_pred:0.01555104460567236, decouple_loss:0.0012746178545057774
The modified gen p mean: 0.4493100941181183, gen p mean: -0.04225330054759979, mean p set: 0.4497903883457184
loss_pred:0.017085595056414604, decouple_loss:0.0013370733940973878
Iteration: 1234, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45032623410224915, gen p mean: -0.051265399903059006, mean p set: 0.45080649852752686
The modified gen p mean: 0.45081645250320435, gen p mean: -0.04870622977614403, mean p set: 0.45129671692848206
loss_pred:0.016243228688836098, decouple_loss:0.0011980053968727589
loss_pred:0.016188515350222588, decouple_loss:0.0011383222881704569
The modified gen p mean: 0.4497341513633728, gen p mean: -0.045468080788850784, mean p set: 0.4502144455909729
loss_pred:0.01657317951321602, decouple_loss:0.0011549979681149125
Iteration: 1235, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45042118430137634, gen p mean: -0.04695070907473564, mean p set: 0.45090147852897644
The modified gen p mean: 0.4497908651828766, gen p mean: -0.05184577777981758, mean p set: 0.4502711296081543loss_pred:0.017162246629595757, decouple_loss:0.0011825136607512832
The modified gen p mean: 0.45088908076286316, gen p mean: -0.05546651780605316, mean p set: 0.45136934518814087
loss_pred:0.015963949263095856, decouple_loss:0.0012026483891531825
loss_pred:0.016921162605285645, decouple_loss:0.0011899071978405118
Iteration: 1236, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500710070133209, gen p mean: -0.05648259073495865, mean p set: 0.4505513310432434
The modified gen p mean: 0.448814332485199, gen p mean: -0.05131993815302849, mean p set: 0.4492945969104767
loss_pred:0.015775665640830994, decouple_loss:0.0011409551370888948
loss_pred:0.01669256202876568, decouple_loss:0.0011229300871491432
The modified gen p mean: 0.450862318277359, gen p mean: -0.04943414404988289, mean p set: 0.4513426423072815
loss_pred:0.017189232632517815, decouple_loss:0.0011606086045503616
Iteration: 1237, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491346776485443, gen p mean: -0.05307401716709137, mean p set: 0.4496149718761444
The modified gen p mean: 0.44982007145881653, gen p mean: -0.05303662270307541, mean p set: 0.4503003656864166
loss_pred:0.016751324757933617, decouple_loss:0.0011603878811001778
loss_pred:0.016684111207723618, decouple_loss:0.0011878416407853365
The modified gen p mean: 0.449320912361145, gen p mean: -0.05164643004536629, mean p set: 0.44980117678642273
loss_pred:0.01644490659236908, decouple_loss:0.0011842824751511216
Iteration: 1238, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45001962780952454, gen p mean: -0.05735763534903526, mean p set: 0.45049992203712463
The modified gen p mean: 0.4500060975551605, gen p mean: -0.06019150838255882, mean p set: 0.4504863917827606
loss_pred:0.01637437380850315, decouple_loss:0.0011192705715075135
loss_pred:0.016913991421461105, decouple_loss:0.001078154193237424
The modified gen p mean: 0.45079559087753296, gen p mean: -0.057353533804416656, mean p set: 0.45127591490745544
loss_pred:0.01701921783387661, decouple_loss:0.0011194413527846336
Iteration: 1239, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44986680150032043, gen p mean: -0.05498466268181801, mean p set: 0.45034709572792053
The modified gen p mean: 0.45057016611099243, gen p mean: -0.06034117937088013, mean p set: 0.45105046033859253loss_pred:0.016973886638879776, decouple_loss:0.0014865606790408492
The modified gen p mean: 0.44991549849510193, gen p mean: -0.056990623474121094, mean p set: 0.450395792722702
loss_pred:0.01734745129942894, decouple_loss:0.0011879012454301119
loss_pred:0.016831912100315094, decouple_loss:0.00118157803080976
Iteration: 1240, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507622718811035, gen p mean: -0.06368926167488098, mean p set: 0.4512425363063812
The modified gen p mean: 0.4503765106201172, gen p mean: -0.05568904057145119, mean p set: 0.4508568048477173
loss_pred:0.015665993094444275, decouple_loss:0.001295199035666883
loss_pred:0.01655401848256588, decouple_loss:0.0012657521292567253
The modified gen p mean: 0.4507591426372528, gen p mean: -0.05756257846951485, mean p set: 0.4512394070625305
loss_pred:0.01716831512749195, decouple_loss:0.0011179326102137566
2023-05-02 07:21:54 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.06690503656864166, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.06256666034460068, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.06308192759752274, mean p set: 0.4500633478164673
loss_pred:0.018459832295775414, decouple_loss:0.0013249224284663796
loss_pred:0.01737673208117485, decouple_loss:0.001190554117783904
loss_pred:0.017478296533226967, decouple_loss:0.001199459540657699
WV_0_PC_1_EH_0_PS_40, loss: 0.017833536490797997, avg_mse: 0.02561192587018013
current test mse: 0.025612
Iteration: 1241, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505538046360016, gen p mean: -0.054276276379823685, mean p set: 0.4510340988636017
The modified gen p mean: 0.4507042169570923, gen p mean: -0.061803583055734634, mean p set: 0.4511845111846924
The modified gen p mean: 0.45013561844825745, gen p mean: -0.05599282309412956, mean p set: 0.45061591267585754
loss_pred:0.016229715198278427, decouple_loss:0.0012617298634722829
loss_pred:0.01644115149974823, decouple_loss:0.0011933976784348488
loss_pred:0.01589580439031124, decouple_loss:0.001148464623838663
Iteration: 1242, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500775933265686, gen p mean: -0.05629444867372513, mean p set: 0.4505578577518463
The modified gen p mean: 0.4497520625591278, gen p mean: -0.05457588657736778, mean p set: 0.4502323865890503
loss_pred:0.01618305593729019, decouple_loss:0.0011545863235369325
loss_pred:0.01644904725253582, decouple_loss:0.001204785774461925
The modified gen p mean: 0.4482330083847046, gen p mean: -0.05194425955414772, mean p set: 0.4487132728099823
loss_pred:0.016706526279449463, decouple_loss:0.0011433345498517156
Iteration: 1243, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45054006576538086, gen p mean: -0.05415576323866844, mean p set: 0.45102033019065857
loss_pred:0.016290051862597466, decouple_loss:0.001023026998154819
The modified gen p mean: 0.4505615532398224, gen p mean: -0.05198569968342781, mean p set: 0.4510418474674225The modified gen p mean: 0.4508325159549713, gen p mean: -0.053550854325294495, mean p set: 0.4513128101825714
loss_pred:0.016345418989658356, decouple_loss:0.0010105551918968558
loss_pred:0.01645003631711006, decouple_loss:0.0010527268750593066
Iteration: 1244, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491664469242096, gen p mean: -0.05067942664027214, mean p set: 0.4496467411518097
loss_pred:0.017203738912940025, decouple_loss:0.001076095039024949
The modified gen p mean: 0.4508225619792938, gen p mean: -0.05361398681998253, mean p set: 0.4513028562068939The modified gen p mean: 0.44882383942604065, gen p mean: -0.04809240251779556, mean p set: 0.44930416345596313
loss_pred:0.016127552837133408, decouple_loss:0.0010085086105391383
loss_pred:0.016212379559874535, decouple_loss:0.0011279789032414556
Iteration: 1245, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44957202672958374, gen p mean: -0.05241036415100098, mean p set: 0.45005232095718384
loss_pred:0.01669333130121231, decouple_loss:0.0010685877641662955
The modified gen p mean: 0.45051419734954834, gen p mean: -0.05048371106386185, mean p set: 0.4509945213794708The modified gen p mean: 0.4498096704483032, gen p mean: -0.04854651167988777, mean p set: 0.45028993487358093
loss_pred:0.016346201300621033, decouple_loss:0.0011384905083104968
loss_pred:0.016040032729506493, decouple_loss:0.0011172108352184296
Iteration: 1246, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4512409567832947, gen p mean: -0.05468088760972023, mean p set: 0.4517212510108948
loss_pred:0.01618044823408127, decouple_loss:0.0010201006662100554
The modified gen p mean: 0.44912439584732056, gen p mean: -0.05099548399448395, mean p set: 0.44960469007492065The modified gen p mean: 0.4498710632324219, gen p mean: -0.04938499256968498, mean p set: 0.450351357460022
loss_pred:0.01665208674967289, decouple_loss:0.0010109299328178167
loss_pred:0.016463734209537506, decouple_loss:0.0010324644390493631
Iteration: 1247, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44989699125289917, gen p mean: -0.04845559597015381, mean p set: 0.45037728548049927
loss_pred:0.017276091501116753, decouple_loss:0.0010995378252118826
The modified gen p mean: 0.45072463154792786, gen p mean: -0.049839749932289124, mean p set: 0.45120492577552795The modified gen p mean: 0.45020169019699097, gen p mean: -0.054056212306022644, mean p set: 0.4506819546222687
loss_pred:0.017135588452219963, decouple_loss:0.001102337148040533
loss_pred:0.01572457142174244, decouple_loss:0.0010919691994786263
Iteration: 1248, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4506491422653198, gen p mean: -0.05587713420391083, mean p set: 0.4511294364929199
loss_pred:0.01657704822719097, decouple_loss:0.0010056886821985245
The modified gen p mean: 0.45042797923088074, gen p mean: -0.051624178886413574, mean p set: 0.45090827345848083The modified gen p mean: 0.4506174921989441, gen p mean: -0.057893306016922, mean p set: 0.4510977864265442
loss_pred:0.015882810577750206, decouple_loss:0.0010462296195328236
loss_pred:0.016681544482707977, decouple_loss:0.0010258492548018694
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012016_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012016_3_24hr.npz
NaN value num: 0
Iteration: 1249, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44666460156440735, gen p mean: -0.05836466699838638, mean p set: 0.44714486598968506
loss_pred:0.015061339363455772, decouple_loss:0.0012328336015343666
The modified gen p mean: 0.44754254817962646, gen p mean: -0.05477789416909218, mean p set: 0.44802284240722656The modified gen p mean: 0.4466681480407715, gen p mean: -0.05609568580985069, mean p set: 0.4471484422683716
loss_pred:0.015540900640189648, decouple_loss:0.0010703778825700283
loss_pred:0.015324040316045284, decouple_loss:0.001192140276543796
Iteration: 1250, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44960805773735046, gen p mean: -0.06152200326323509, mean p set: 0.4500883221626282
The modified gen p mean: 0.44842371344566345, gen p mean: -0.06243732571601868, mean p set: 0.44890403747558594
loss_pred:0.014870015904307365, decouple_loss:0.0012694516917690635
loss_pred:0.015119241550564766, decouple_loss:0.0011546871392056346
The modified gen p mean: 0.4469491243362427, gen p mean: -0.059022098779678345, mean p set: 0.4474294185638428
loss_pred:0.014812439680099487, decouple_loss:0.0010903835063800216
2023-05-02 07:24:21 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.0641108825802803, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.05933576077222824, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.059822116047143936, mean p set: 0.4500633478164673
loss_pred:0.01859769970178604, decouple_loss:0.0013026465894654393
loss_pred:0.01750710979104042, decouple_loss:0.001203250023536384
loss_pred:0.0176539346575737, decouple_loss:0.0012570881517603993
WV_0_PC_1_EH_0_PS_40, loss: 0.017982296645641327, avg_mse: 0.025916343554854393
current test mse: 0.025916
Iteration: 1251, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482465088367462, gen p mean: -0.06434822082519531, mean p set: 0.4487267732620239
The modified gen p mean: 0.44851794838905334, gen p mean: -0.05848666653037071, mean p set: 0.44899824261665344
The modified gen p mean: 0.44696342945098877, gen p mean: -0.062196146696805954, mean p set: 0.44744372367858887
loss_pred:0.01541750505566597, decouple_loss:0.0013067645486444235
loss_pred:0.015194392763078213, decouple_loss:0.0011628028005361557
loss_pred:0.015004833228886127, decouple_loss:0.0011796929175034165
Iteration: 1252, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468767046928406, gen p mean: -0.05859556421637535, mean p set: 0.4473569989204407
The modified gen p mean: 0.4466017484664917, gen p mean: -0.06270801275968552, mean p set: 0.4470820426940918
loss_pred:0.014711047522723675, decouple_loss:0.0011227075010538101
loss_pred:0.014915253967046738, decouple_loss:0.0013502584770321846The modified gen p mean: 0.4483170807361603, gen p mean: -0.0616854652762413, mean p set: 0.448797345161438
loss_pred:0.015378166921436787, decouple_loss:0.0011905707651749253
Iteration: 1253, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44629180431365967, gen p mean: -0.06199764460325241, mean p set: 0.44677209854125977
loss_pred:0.0151226706802845, decouple_loss:0.0012788281310349703
The modified gen p mean: 0.44655951857566833, gen p mean: -0.06369251012802124, mean p set: 0.44703981280326843The modified gen p mean: 0.44941359758377075, gen p mean: -0.05914321541786194, mean p set: 0.44989389181137085
loss_pred:0.014540595933794975, decouple_loss:0.001284942147321999
loss_pred:0.015306422486901283, decouple_loss:0.001244774553924799
Iteration: 1254, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4463586211204529, gen p mean: -0.05854859575629234, mean p set: 0.4468388855457306
loss_pred:0.01510976254940033, decouple_loss:0.0013430769322440028
The modified gen p mean: 0.44772204756736755, gen p mean: -0.05093541368842125, mean p set: 0.44820234179496765The modified gen p mean: 0.44690871238708496, gen p mean: -0.052556686103343964, mean p set: 0.44738900661468506
loss_pred:0.014808136969804764, decouple_loss:0.001218073652125895
loss_pred:0.01501605473458767, decouple_loss:0.0012125092325732112
Iteration: 1255, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44748455286026, gen p mean: -0.05182286351919174, mean p set: 0.4479648470878601
loss_pred:0.014854999259114265, decouple_loss:0.0011724837822839618
The modified gen p mean: 0.44689786434173584, gen p mean: -0.05222397670149803, mean p set: 0.44737815856933594The modified gen p mean: 0.44634178280830383, gen p mean: -0.057434264570474625, mean p set: 0.4468221068382263
loss_pred:0.014809398911893368, decouple_loss:0.0014005393022671342
loss_pred:0.01486796885728836, decouple_loss:0.0012020731810480356
Iteration: 1256, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44765305519104004, gen p mean: -0.05491235852241516, mean p set: 0.44813334941864014
The modified gen p mean: 0.4477654695510864, gen p mean: -0.05726371705532074, mean p set: 0.4482457637786865
loss_pred:0.014664745889604092, decouple_loss:0.0013590134913101792
loss_pred:0.014667639508843422, decouple_loss:0.0013669569743797183
The modified gen p mean: 0.4486178457736969, gen p mean: -0.0502430684864521, mean p set: 0.449098140001297
loss_pred:0.014850105158984661, decouple_loss:0.001315350062213838
Iteration: 1257, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470483064651489, gen p mean: -0.04926249012351036, mean p set: 0.44752857089042664
loss_pred:0.014786526560783386, decouple_loss:0.0013809625525027514
The modified gen p mean: 0.4476257264614105, gen p mean: -0.050885461270809174, mean p set: 0.4481060206890106The modified gen p mean: 0.4469279646873474, gen p mean: -0.052839312702417374, mean p set: 0.4474082589149475
loss_pred:0.015159804373979568, decouple_loss:0.0012083735782653093
loss_pred:0.015587388537824154, decouple_loss:0.001279168645851314
Iteration: 1258, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468589127063751, gen p mean: -0.051748234778642654, mean p set: 0.44733917713165283
The modified gen p mean: 0.446621298789978, gen p mean: -0.05092960223555565, mean p set: 0.4471015930175781loss_pred:0.014555243775248528, decouple_loss:0.0012911515077576041
The modified gen p mean: 0.44705286622047424, gen p mean: -0.05006616190075874, mean p set: 0.44753316044807434
loss_pred:0.015745675191283226, decouple_loss:0.001340796472504735
loss_pred:0.015361646190285683, decouple_loss:0.0013636385556310415
Iteration: 1259, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44801685214042664, gen p mean: -0.050908736884593964, mean p set: 0.4484971761703491
loss_pred:0.014129926450550556, decouple_loss:0.0013184902491047978
The modified gen p mean: 0.4477772116661072, gen p mean: -0.050174493342638016, mean p set: 0.4482575058937073The modified gen p mean: 0.44798144698143005, gen p mean: -0.04591389372944832, mean p set: 0.44846174120903015
loss_pred:0.014787383377552032, decouple_loss:0.001360013266094029
loss_pred:0.014377076178789139, decouple_loss:0.0011486030416563153
Iteration: 1260, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473516047000885, gen p mean: -0.044474825263023376, mean p set: 0.4478318989276886
loss_pred:0.01526334136724472, decouple_loss:0.0013447378296405077
The modified gen p mean: 0.4464806616306305, gen p mean: -0.0471348762512207, mean p set: 0.4469609558582306The modified gen p mean: 0.44723808765411377, gen p mean: -0.04764452204108238, mean p set: 0.4477183520793915
loss_pred:0.014274670742452145, decouple_loss:0.0013868366368114948
loss_pred:0.015567167662084103, decouple_loss:0.0013278855476528406
2023-05-02 07:26:15 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.051595669239759445, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04782472178339958, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.047688793390989304, mean p set: 0.4500633478164673
loss_pred:0.019047558307647705, decouple_loss:0.0013856937875971198
loss_pred:0.018082818016409874, decouple_loss:0.0013374033151194453
loss_pred:0.018092453479766846, decouple_loss:0.0013157284120097756
WV_0_PC_1_EH_0_PS_40, loss: 0.018474925309419632, avg_mse: 0.026883812621235847
current test mse: 0.026884
Iteration: 1261, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472801387310028, gen p mean: -0.043560296297073364, mean p set: 0.4477604627609253
The modified gen p mean: 0.4471610486507416, gen p mean: -0.041349127888679504, mean p set: 0.4476413428783417
The modified gen p mean: 0.44703513383865356, gen p mean: -0.04417113959789276, mean p set: 0.44751542806625366
loss_pred:0.014392241835594177, decouple_loss:0.0012931153178215027
loss_pred:0.014751613140106201, decouple_loss:0.0012506216298788786
loss_pred:0.014880627393722534, decouple_loss:0.0012826492311432958
Iteration: 1262, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44759413599967957, gen p mean: -0.0509154386818409, mean p set: 0.44807443022727966
loss_pred:0.014019995927810669, decouple_loss:0.0015029854839667678
The modified gen p mean: 0.4483056962490082, gen p mean: -0.05228445678949356, mean p set: 0.4487859904766083The modified gen p mean: 0.4484513998031616, gen p mean: -0.04579925909638405, mean p set: 0.4489316940307617
loss_pred:0.014265265315771103, decouple_loss:0.0016639699460938573
loss_pred:0.014410262927412987, decouple_loss:0.0016300181159749627
Iteration: 1263, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480094313621521, gen p mean: -0.047324832528829575, mean p set: 0.4484897553920746
loss_pred:0.014397765509784222, decouple_loss:0.00139155937358737
The modified gen p mean: 0.4469186067581177, gen p mean: -0.053079091012477875, mean p set: 0.4473989009857178The modified gen p mean: 0.4464671313762665, gen p mean: -0.055116232484579086, mean p set: 0.4469473958015442
loss_pred:0.014703767374157906, decouple_loss:0.0013915915042161942
loss_pred:0.015166657976806164, decouple_loss:0.001371770049445331
Iteration: 1264, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475051164627075, gen p mean: -0.04859647527337074, mean p set: 0.44798544049263
loss_pred:0.015048003755509853, decouple_loss:0.0014132363721728325
The modified gen p mean: 0.4476337432861328, gen p mean: -0.05421685054898262, mean p set: 0.4481140077114105The modified gen p mean: 0.4490155577659607, gen p mean: -0.05289227142930031, mean p set: 0.4494958221912384
loss_pred:0.014324437826871872, decouple_loss:0.001631933730095625
loss_pred:0.014419925399124622, decouple_loss:0.001543789403513074
Iteration: 1265, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468691945075989, gen p mean: -0.05840914696455002, mean p set: 0.4473494589328766
loss_pred:0.01527863647788763, decouple_loss:0.0016058982582762837
The modified gen p mean: 0.4468850791454315, gen p mean: -0.05563891679048538, mean p set: 0.44736534357070923The modified gen p mean: 0.4481349587440491, gen p mean: -0.048796262592077255, mean p set: 0.44861525297164917
loss_pred:0.014816421084105968, decouple_loss:0.001571611501276493
loss_pred:0.014871854335069656, decouple_loss:0.0014674405101686716
Iteration: 1266, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473802447319031, gen p mean: -0.047507308423519135, mean p set: 0.4478605389595032
loss_pred:0.015102354809641838, decouple_loss:0.0013182413531467319
The modified gen p mean: 0.4466789960861206, gen p mean: -0.049366939812898636, mean p set: 0.4471592903137207The modified gen p mean: 0.44651761651039124, gen p mean: -0.05216313898563385, mean p set: 0.44699788093566895
loss_pred:0.014742361381649971, decouple_loss:0.0014603539602831006
loss_pred:0.014027134515345097, decouple_loss:0.0013407490914687514
Iteration: 1267, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44680145382881165, gen p mean: -0.04825175553560257, mean p set: 0.44728177785873413
loss_pred:0.014638864435255527, decouple_loss:0.0016349924262613058
The modified gen p mean: 0.44755107164382935, gen p mean: -0.04387316480278969, mean p set: 0.44803139567375183The modified gen p mean: 0.4492481052875519, gen p mean: -0.04634835198521614, mean p set: 0.4497283697128296
loss_pred:0.014126800000667572, decouple_loss:0.001754330936819315
loss_pred:0.014662723988294601, decouple_loss:0.001616205438040197
Iteration: 1268, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475826025009155, gen p mean: -0.046686165034770966, mean p set: 0.4480628967285156
loss_pred:0.014236615970730782, decouple_loss:0.0013612292241305113
The modified gen p mean: 0.4484936594963074, gen p mean: -0.04719071462750435, mean p set: 0.44897395372390747The modified gen p mean: 0.4476301968097687, gen p mean: -0.045045312494039536, mean p set: 0.4481104910373688
loss_pred:0.014253504574298859, decouple_loss:0.001352120190858841
loss_pred:0.013881421647965908, decouple_loss:0.0013577535282820463
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012011_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012011_3_24hr.npz
NaN value num: 0
Iteration: 1269, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472469389438629, gen p mean: -0.04724746569991112, mean p set: 0.4477272629737854
loss_pred:0.016728701069951057, decouple_loss:0.001585380989126861
The modified gen p mean: 0.4455285668373108, gen p mean: -0.043832819908857346, mean p set: 0.4460088610649109The modified gen p mean: 0.44762560725212097, gen p mean: -0.0443936288356781, mean p set: 0.4481058716773987
loss_pred:0.01687219738960266, decouple_loss:0.0013443616917356849
loss_pred:0.016536345705389977, decouple_loss:0.0013698760885745287
Iteration: 1270, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475497603416443, gen p mean: -0.04348248615860939, mean p set: 0.4480300843715668
loss_pred:0.016000615432858467, decouple_loss:0.0013423770433291793
The modified gen p mean: 0.44699934124946594, gen p mean: -0.047462888062000275, mean p set: 0.44747960567474365The modified gen p mean: 0.44651171565055847, gen p mean: -0.04654821753501892, mean p set: 0.4469919800758362
loss_pred:0.017943745478987694, decouple_loss:0.0013377716531977057
loss_pred:0.015723148360848427, decouple_loss:0.001263595069758594
2023-05-02 07:28:44 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.04696876183152199, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04305792227387428, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.043177567422389984, mean p set: 0.4500633478164673
loss_pred:0.018660439178347588, decouple_loss:0.001380494679324329
loss_pred:0.01768626645207405, decouple_loss:0.0013732074294239283
loss_pred:0.017681943252682686, decouple_loss:0.0013505391543731093
WV_0_PC_1_EH_0_PS_40, loss: 0.018077954649925232, avg_mse: 0.026093801483511925
current test mse: 0.026094
Iteration: 1271, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475606679916382, gen p mean: -0.04511087015271187, mean p set: 0.44804099202156067
The modified gen p mean: 0.44760170578956604, gen p mean: -0.050015661865472794, mean p set: 0.4480820298194885
The modified gen p mean: 0.4468826949596405, gen p mean: -0.046519629657268524, mean p set: 0.4473629891872406
loss_pred:0.016224147751927376, decouple_loss:0.0013126713456586003
loss_pred:0.01690772734582424, decouple_loss:0.001265720115043223
loss_pred:0.016815185546875, decouple_loss:0.0013150364393368363
Iteration: 1272, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474649131298065, gen p mean: -0.043173179030418396, mean p set: 0.4479452073574066
The modified gen p mean: 0.4474712014198303, gen p mean: -0.045687831938266754, mean p set: 0.44795146584510803
loss_pred:0.015780802816152573, decouple_loss:0.00144136231392622
loss_pred:0.01674465835094452, decouple_loss:0.0013068331172689795
The modified gen p mean: 0.4470180869102478, gen p mean: -0.04519171267747879, mean p set: 0.4474983811378479
loss_pred:0.01695806346833706, decouple_loss:0.0013361591845750809
Iteration: 1273, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44846656918525696, gen p mean: -0.03749324381351471, mean p set: 0.44894686341285706
The modified gen p mean: 0.4464336037635803, gen p mean: -0.04069329798221588, mean p set: 0.4469138979911804
loss_pred:0.016325518488883972, decouple_loss:0.0012841690331697464
loss_pred:0.017847923561930656, decouple_loss:0.0012729163281619549
The modified gen p mean: 0.446107417345047, gen p mean: -0.04146158695220947, mean p set: 0.4465877413749695
loss_pred:0.016442306339740753, decouple_loss:0.0014119588304311037
Iteration: 1274, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484110474586487, gen p mean: -0.0414644330739975, mean p set: 0.4488913118839264
loss_pred:0.016416344791650772, decouple_loss:0.0012533572735264897
The modified gen p mean: 0.448434442281723, gen p mean: -0.04226092994213104, mean p set: 0.44891470670700073The modified gen p mean: 0.4469090700149536, gen p mean: -0.040213655680418015, mean p set: 0.4473893940448761
loss_pred:0.016659509390592575, decouple_loss:0.0012521175667643547
loss_pred:0.01575816050171852, decouple_loss:0.0012722944375127554
Iteration: 1275, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44816645979881287, gen p mean: -0.04071252793073654, mean p set: 0.4486467242240906
loss_pred:0.01645185425877571, decouple_loss:0.0013886014930903912
The modified gen p mean: 0.4479265809059143, gen p mean: -0.038345806300640106, mean p set: 0.4484068751335144The modified gen p mean: 0.44960349798202515, gen p mean: -0.043879833072423935, mean p set: 0.45008379220962524
loss_pred:0.016462314873933792, decouple_loss:0.0012456909753382206
loss_pred:0.01573161408305168, decouple_loss:0.0012987194349989295
Iteration: 1276, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44749292731285095, gen p mean: -0.047904469072818756, mean p set: 0.44797322154045105
loss_pred:0.01657208800315857, decouple_loss:0.001304355449974537
The modified gen p mean: 0.4480271637439728, gen p mean: -0.04122230038046837, mean p set: 0.4485074579715729The modified gen p mean: 0.44840705394744873, gen p mean: -0.046541761606931686, mean p set: 0.4488873779773712
loss_pred:0.01626242883503437, decouple_loss:0.001272181631065905
loss_pred:0.016583319753408432, decouple_loss:0.0012120369356125593
Iteration: 1277, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475783109664917, gen p mean: -0.05049967020750046, mean p set: 0.4480586349964142
loss_pred:0.016462458297610283, decouple_loss:0.001447134418413043
The modified gen p mean: 0.44786781072616577, gen p mean: -0.048754677176475525, mean p set: 0.44834810495376587The modified gen p mean: 0.44687747955322266, gen p mean: -0.049039874225854874, mean p set: 0.44735774397850037
loss_pred:0.01608259417116642, decouple_loss:0.001291888183914125
loss_pred:0.016247883439064026, decouple_loss:0.0013527487171813846
Iteration: 1278, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44763243198394775, gen p mean: -0.05234280973672867, mean p set: 0.44811269640922546
loss_pred:0.016417695209383965, decouple_loss:0.0013254269724711776
The modified gen p mean: 0.4475327730178833, gen p mean: -0.053376540541648865, mean p set: 0.4480130672454834The modified gen p mean: 0.4476946294307709, gen p mean: -0.049182191491127014, mean p set: 0.44817492365837097
loss_pred:0.01621241867542267, decouple_loss:0.0012110320385545492
loss_pred:0.015408128499984741, decouple_loss:0.0012865763856098056
Iteration: 1279, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447560578584671, gen p mean: -0.052947137504816055, mean p set: 0.4480408728122711
loss_pred:0.01695718988776207, decouple_loss:0.0013037346070632339
The modified gen p mean: 0.44798776507377625, gen p mean: -0.055087435990571976, mean p set: 0.44846805930137634The modified gen p mean: 0.4484841525554657, gen p mean: -0.055432338267564774, mean p set: 0.4489644169807434
loss_pred:0.01574425958096981, decouple_loss:0.001314442022703588
loss_pred:0.01647859252989292, decouple_loss:0.0012986052315682173
Iteration: 1280, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448818176984787, gen p mean: -0.051326684653759, mean p set: 0.4492984712123871
loss_pred:0.015202904120087624, decouple_loss:0.0012977635487914085
The modified gen p mean: 0.44700631499290466, gen p mean: -0.05171845108270645, mean p set: 0.44748660922050476The modified gen p mean: 0.44728726148605347, gen p mean: -0.053356822580099106, mean p set: 0.44776758551597595
loss_pred:0.015637440606951714, decouple_loss:0.0014116195961833
loss_pred:0.01658160239458084, decouple_loss:0.0013348320499062538
2023-05-02 07:30:40 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.056955285370349884, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.05262826755642891, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.05314989015460014, mean p set: 0.4500633478164673
loss_pred:0.018449898809194565, decouple_loss:0.0014116093516349792
loss_pred:0.017379967495799065, decouple_loss:0.0012160342885181308
loss_pred:0.01743422821164131, decouple_loss:0.0012721189996227622
WV_0_PC_1_EH_0_PS_40, loss: 0.01781969517469406, avg_mse: 0.02560802735388279
current test mse: 0.025608
Iteration: 1281, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4458010792732239, gen p mean: -0.05530307814478874, mean p set: 0.44628140330314636
The modified gen p mean: 0.44786718487739563, gen p mean: -0.056411948055028915, mean p set: 0.44834744930267334
The modified gen p mean: 0.44710806012153625, gen p mean: -0.05666321888566017, mean p set: 0.44758832454681396
loss_pred:0.01767243817448616, decouple_loss:0.0012682544765993953
loss_pred:0.016367314383387566, decouple_loss:0.0013091241708025336
loss_pred:0.01608176901936531, decouple_loss:0.0011619566939771175
Iteration: 1282, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44835206866264343, gen p mean: -0.055928852409124374, mean p set: 0.44883236289024353
The modified gen p mean: 0.44696488976478577, gen p mean: -0.05799790471792221, mean p set: 0.44744521379470825
loss_pred:0.016437964513897896, decouple_loss:0.001517624594271183
loss_pred:0.016193466261029243, decouple_loss:0.001372125232592225
The modified gen p mean: 0.4478825628757477, gen p mean: -0.0576074980199337, mean p set: 0.4483628571033478
loss_pred:0.01728574000298977, decouple_loss:0.001379638910293579
Iteration: 1283, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44946858286857605, gen p mean: -0.057809311896562576, mean p set: 0.44994887709617615
loss_pred:0.015919934958219528, decouple_loss:0.0012480765581130981
The modified gen p mean: 0.4482695758342743, gen p mean: -0.05920494347810745, mean p set: 0.4487498700618744The modified gen p mean: 0.44796356558799744, gen p mean: -0.05585702136158943, mean p set: 0.44844383001327515
loss_pred:0.01568787917494774, decouple_loss:0.001230793073773384
loss_pred:0.015495523810386658, decouple_loss:0.0012120762839913368
Iteration: 1284, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44839927554130554, gen p mean: -0.05876641720533371, mean p set: 0.448879599571228
loss_pred:0.015855196863412857, decouple_loss:0.0012749446323141456
The modified gen p mean: 0.4475351572036743, gen p mean: -0.05648393556475639, mean p set: 0.448015421628952The modified gen p mean: 0.4468432068824768, gen p mean: -0.05967610329389572, mean p set: 0.4473235011100769
loss_pred:0.015348325483500957, decouple_loss:0.0015845169546082616
loss_pred:0.017563441768288612, decouple_loss:0.0015614995500072837
Iteration: 1285, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490186870098114, gen p mean: -0.054872896522283554, mean p set: 0.4494989514350891
loss_pred:0.01587407849729061, decouple_loss:0.001293567125685513
The modified gen p mean: 0.44710034132003784, gen p mean: -0.05478902533650398, mean p set: 0.4475806653499603The modified gen p mean: 0.44828546047210693, gen p mean: -0.05576666072010994, mean p set: 0.44876575469970703
loss_pred:0.016137946397066116, decouple_loss:0.0013125328114256263
loss_pred:0.016124015673995018, decouple_loss:0.0013099650386720896
Iteration: 1286, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481637179851532, gen p mean: -0.05341768264770508, mean p set: 0.4486440122127533
loss_pred:0.016447532922029495, decouple_loss:0.0011698997113853693
The modified gen p mean: 0.44791361689567566, gen p mean: -0.052404701709747314, mean p set: 0.44839391112327576The modified gen p mean: 0.44752395153045654, gen p mean: -0.055970363318920135, mean p set: 0.44800424575805664
loss_pred:0.015421734191477299, decouple_loss:0.0012201115023344755
loss_pred:0.01532108522951603, decouple_loss:0.0011635735863819718
Iteration: 1287, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477567672729492, gen p mean: -0.05365116894245148, mean p set: 0.44823703169822693
loss_pred:0.017590356990695, decouple_loss:0.0013270610943436623
The modified gen p mean: 0.4478951394557953, gen p mean: -0.049074724316596985, mean p set: 0.4483754336833954
The modified gen p mean: 0.449051171541214, gen p mean: -0.05080204829573631, mean p set: 0.4495314955711365
loss_pred:0.016350438818335533, decouple_loss:0.0012140977196395397
loss_pred:0.016343658789992332, decouple_loss:0.001261339639313519
Iteration: 1288, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475826621055603, gen p mean: -0.053543321788311005, mean p set: 0.4480629861354828
loss_pred:0.016425905749201775, decouple_loss:0.0011409050785005093
The modified gen p mean: 0.4478885233402252, gen p mean: -0.049103427678346634, mean p set: 0.44836878776550293The modified gen p mean: 0.4477537274360657, gen p mean: -0.04738664627075195, mean p set: 0.4482339918613434
loss_pred:0.015808576717972755, decouple_loss:0.0011298938188701868
loss_pred:0.016100380569696426, decouple_loss:0.0011692715343087912
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012006_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012006_3_24hr.npz
NaN value num: 0
Iteration: 1289, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44688403606414795, gen p mean: -0.0462331660091877, mean p set: 0.44736430048942566
loss_pred:0.01497483067214489, decouple_loss:0.0014316262677311897
The modified gen p mean: 0.44732606410980225, gen p mean: -0.05168604105710983, mean p set: 0.44780635833740234The modified gen p mean: 0.44832292199134827, gen p mean: -0.048448942601680756, mean p set: 0.44880321621894836
loss_pred:0.015415658243000507, decouple_loss:0.001353000639937818
loss_pred:0.014814779162406921, decouple_loss:0.001295112306252122
Iteration: 1290, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44723570346832275, gen p mean: -0.050072215497493744, mean p set: 0.44771599769592285
loss_pred:0.014502222649753094, decouple_loss:0.0011786556569859385
The modified gen p mean: 0.4472196102142334, gen p mean: -0.052454669028520584, mean p set: 0.4476999342441559The modified gen p mean: 0.4485522210597992, gen p mean: -0.05661402642726898, mean p set: 0.4490325152873993
loss_pred:0.014777416363358498, decouple_loss:0.0011732683051377535
loss_pred:0.014181726612150669, decouple_loss:0.001248989487066865
2023-05-02 07:33:13 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.05729612708091736, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.0523747056722641, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.05321960523724556, mean p set: 0.4500633478164673
loss_pred:0.01855511963367462, decouple_loss:0.0012499948497861624
loss_pred:0.017476458102464676, decouple_loss:0.0012734181946143508
loss_pred:0.017528938129544258, decouple_loss:0.0012259292416274548
WV_0_PC_1_EH_0_PS_40, loss: 0.017915993928909302, avg_mse: 0.025811582803726196
current test mse: 0.025812
Iteration: 1291, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44862890243530273, gen p mean: -0.05398150160908699, mean p set: 0.44910916686058044
The modified gen p mean: 0.4481634795665741, gen p mean: -0.05408398061990738, mean p set: 0.4486437737941742
loss_pred:0.014404759742319584, decouple_loss:0.001184247899800539
The modified gen p mean: 0.4472769796848297, gen p mean: -0.05627718195319176, mean p set: 0.4477572739124298
loss_pred:0.014777772128582, decouple_loss:0.0012205165112391114
loss_pred:0.01541947666555643, decouple_loss:0.001235460746102035
Iteration: 1292, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44745659828186035, gen p mean: -0.056463293731212616, mean p set: 0.44793686270713806
loss_pred:0.014464037492871284, decouple_loss:0.0012302848044782877
The modified gen p mean: 0.44688132405281067, gen p mean: -0.05767250061035156, mean p set: 0.44736161828041077The modified gen p mean: 0.44823774695396423, gen p mean: -0.057954952120780945, mean p set: 0.44871804118156433
loss_pred:0.014454223215579987, decouple_loss:0.0012551863910630345
loss_pred:0.014245988801121712, decouple_loss:0.0012747535947710276
Iteration: 1293, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44660720229148865, gen p mean: -0.06284645199775696, mean p set: 0.44708749651908875
loss_pred:0.014949954114854336, decouple_loss:0.0012465798063203692
The modified gen p mean: 0.4477618634700775, gen p mean: -0.05828610062599182, mean p set: 0.4482421875The modified gen p mean: 0.44747069478034973, gen p mean: -0.051341596990823746, mean p set: 0.4479510188102722
loss_pred:0.014746380038559437, decouple_loss:0.0011619491269811988
loss_pred:0.014191923663020134, decouple_loss:0.001250357716344297
Iteration: 1294, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488238990306854, gen p mean: -0.05788422003388405, mean p set: 0.44930416345596313
loss_pred:0.013877110555768013, decouple_loss:0.0013726298930123448
The modified gen p mean: 0.44734084606170654, gen p mean: -0.05305948480963707, mean p set: 0.44782111048698425The modified gen p mean: 0.4473671317100525, gen p mean: -0.05707242339849472, mean p set: 0.4478473961353302
loss_pred:0.014326930977404118, decouple_loss:0.001337373978458345
loss_pred:0.014652412384748459, decouple_loss:0.0014640992740169168
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1295, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468052387237549, gen p mean: -0.05779280886054039, mean p set: 0.44728556275367737
loss_pred:0.014704061672091484, decouple_loss:0.0013331938534975052
The modified gen p mean: 0.44699323177337646, gen p mean: -0.05272889509797096, mean p set: 0.44747352600097656The modified gen p mean: 0.44814372062683105, gen p mean: -0.05431756749749184, mean p set: 0.44862401485443115
loss_pred:0.014473352581262589, decouple_loss:0.0012343282578513026
loss_pred:0.014122121967375278, decouple_loss:0.0011513910721987486
Iteration: 1296, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466507136821747, gen p mean: -0.053739260882139206, mean p set: 0.4471310079097748
loss_pred:0.013761217705905437, decouple_loss:0.0014977246755734086
The modified gen p mean: 0.4471854269504547, gen p mean: -0.04911069571971893, mean p set: 0.4476657211780548The modified gen p mean: 0.4493085741996765, gen p mean: -0.05451454222202301, mean p set: 0.4497888684272766
loss_pred:0.013831937685608864, decouple_loss:0.001635557389818132
loss_pred:0.01343232486397028, decouple_loss:0.0017275220016017556
Iteration: 1297, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44653046131134033, gen p mean: -0.0542214959859848, mean p set: 0.44701075553894043
loss_pred:0.014390627853572369, decouple_loss:0.0011907679727301002
The modified gen p mean: 0.4480040967464447, gen p mean: -0.048553671687841415, mean p set: 0.4484843611717224The modified gen p mean: 0.4472491145133972, gen p mean: -0.05249829962849617, mean p set: 0.4477294087409973
loss_pred:0.013876705430448055, decouple_loss:0.0013406856451183558
loss_pred:0.014260648749768734, decouple_loss:0.0011980507988482714
Iteration: 1298, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476940333843231, gen p mean: -0.05237094685435295, mean p set: 0.44817429780960083
loss_pred:0.013972277753055096, decouple_loss:0.0015157833695411682
The modified gen p mean: 0.447664350271225, gen p mean: -0.046588294208049774, mean p set: 0.4481446444988251The modified gen p mean: 0.4476637840270996, gen p mean: -0.04784030094742775, mean p set: 0.4481441080570221
loss_pred:0.01470197830349207, decouple_loss:0.001357048749923706
loss_pred:0.013824178837239742, decouple_loss:0.0014570598723366857
Iteration: 1299, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479466378688812, gen p mean: -0.046412743628025055, mean p set: 0.4484269320964813
loss_pred:0.013622334226965904, decouple_loss:0.0015331367030739784
The modified gen p mean: 0.4478028416633606, gen p mean: -0.04850346967577934, mean p set: 0.4482831358909607The modified gen p mean: 0.4470902979373932, gen p mean: -0.04841344803571701, mean p set: 0.4475705623626709
loss_pred:0.013825968839228153, decouple_loss:0.0013843657216057181
loss_pred:0.013658381067216396, decouple_loss:0.0015406757593154907
Iteration: 1300, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467688798904419, gen p mean: -0.050843581557273865, mean p set: 0.4472491443157196
loss_pred:0.01421399973332882, decouple_loss:0.0015584597131237388
The modified gen p mean: 0.44689297676086426, gen p mean: -0.0455520898103714, mean p set: 0.44737330079078674The modified gen p mean: 0.44675448536872864, gen p mean: -0.04979495704174042, mean p set: 0.44723477959632874
loss_pred:0.014226090162992477, decouple_loss:0.0014607860939577222
loss_pred:0.014516848139464855, decouple_loss:0.0015054766554385424
2023-05-02 07:35:07 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.047641266137361526, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.043228138238191605, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.04350202530622482, mean p set: 0.4500633478164673
loss_pred:0.01914932020008564, decouple_loss:0.0015701663214713335
loss_pred:0.017999764531850815, decouple_loss:0.0016090552089735866
loss_pred:0.018059121444821358, decouple_loss:0.0015597010497003794
WV_0_PC_1_EH_0_PS_40, loss: 0.018481716513633728, avg_mse: 0.026879552751779556
current test mse: 0.02688
Iteration: 1301, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473397731781006, gen p mean: -0.042589571326971054, mean p set: 0.4478200376033783
The modified gen p mean: 0.44754335284233093, gen p mean: -0.04511398822069168, mean p set: 0.44802361726760864
The modified gen p mean: 0.44815999269485474, gen p mean: -0.04475140571594238, mean p set: 0.44864028692245483
loss_pred:0.014067639596760273, decouple_loss:0.001504819723777473
loss_pred:0.014424679800868034, decouple_loss:0.001507377135567367
loss_pred:0.013747895136475563, decouple_loss:0.0014766701497137547
Iteration: 1302, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44795045256614685, gen p mean: -0.05216621235013008, mean p set: 0.44843074679374695
loss_pred:0.013914191164076328, decouple_loss:0.0012532342225313187
The modified gen p mean: 0.4482698440551758, gen p mean: -0.05244551599025726, mean p set: 0.4487501382827759The modified gen p mean: 0.4474377930164337, gen p mean: -0.04390749707818031, mean p set: 0.4479181170463562
loss_pred:0.013740803115069866, decouple_loss:0.0012915803818032146
loss_pred:0.013557950966060162, decouple_loss:0.0013274300144985318
Iteration: 1303, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472901225090027, gen p mean: -0.05701131746172905, mean p set: 0.4477703869342804
loss_pred:0.014066394418478012, decouple_loss:0.001477253856137395
The modified gen p mean: 0.4471207857131958, gen p mean: -0.04828914627432823, mean p set: 0.4476010799407959The modified gen p mean: 0.447831928730011, gen p mean: -0.053147152066230774, mean p set: 0.4483122229576111
loss_pred:0.013745144009590149, decouple_loss:0.0013739983551204205
loss_pred:0.013636241666972637, decouple_loss:0.0014425460249185562
Iteration: 1304, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481145143508911, gen p mean: -0.05267041176557541, mean p set: 0.4485948383808136
loss_pred:0.01399588119238615, decouple_loss:0.0011677831644192338
The modified gen p mean: 0.44681665301322937, gen p mean: -0.05449782684445381, mean p set: 0.4472969174385071The modified gen p mean: 0.4484044313430786, gen p mean: -0.05174017325043678, mean p set: 0.4488847255706787
loss_pred:0.01340394839644432, decouple_loss:0.0012145250802859664
loss_pred:0.013541093096137047, decouple_loss:0.0013080843491479754
Iteration: 1305, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44820716977119446, gen p mean: -0.04873304441571236, mean p set: 0.44868743419647217
loss_pred:0.01349667552858591, decouple_loss:0.0013790137600153685
The modified gen p mean: 0.44773998856544495, gen p mean: -0.051948171108961105, mean p set: 0.44822028279304504The modified gen p mean: 0.447611540555954, gen p mean: -0.049938954412937164, mean p set: 0.4480918347835541
loss_pred:0.013611719943583012, decouple_loss:0.0014074034988880157
loss_pred:0.014455348253250122, decouple_loss:0.0013307922054082155
Iteration: 1306, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473111629486084, gen p mean: -0.04882276803255081, mean p set: 0.4477914571762085
loss_pred:0.013549118302762508, decouple_loss:0.0012833689106628299
The modified gen p mean: 0.44682765007019043, gen p mean: -0.046029526740312576, mean p set: 0.4473079442977905
The modified gen p mean: 0.4474269449710846, gen p mean: -0.05062788352370262, mean p set: 0.4479072690010071
loss_pred:0.013780918903648853, decouple_loss:0.0013306259643286467
loss_pred:0.013319844380021095, decouple_loss:0.0012392130447551608
Iteration: 1307, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44660675525665283, gen p mean: -0.04916957765817642, mean p set: 0.4470870792865753
loss_pred:0.014447947032749653, decouple_loss:0.0015039967838674784
The modified gen p mean: 0.44693994522094727, gen p mean: -0.05098173767328262, mean p set: 0.44742023944854736The modified gen p mean: 0.4472962021827698, gen p mean: -0.045748114585876465, mean p set: 0.4477764964103699
loss_pred:0.013531089760363102, decouple_loss:0.0012840561103075743
loss_pred:0.013632253743708134, decouple_loss:0.001329277059994638
Iteration: 1308, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44622570276260376, gen p mean: -0.04932656139135361, mean p set: 0.44670602679252625
loss_pred:0.014396768994629383, decouple_loss:0.0012765269493684173
The modified gen p mean: 0.4473554193973541, gen p mean: -0.04990052059292793, mean p set: 0.4478357136249542The modified gen p mean: 0.4468085765838623, gen p mean: -0.055425722151994705, mean p set: 0.4472888708114624
loss_pred:0.013524889014661312, decouple_loss:0.0011979263508692384
loss_pred:0.013747136108577251, decouple_loss:0.0012386958114802837
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012008_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012008_3_24hr.npz
NaN value num: 0
Iteration: 1309, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44705235958099365, gen p mean: -0.050408609211444855, mean p set: 0.44753265380859375
loss_pred:0.014134674333035946, decouple_loss:0.0012475064722821116
The modified gen p mean: 0.44656574726104736, gen p mean: -0.04773697629570961, mean p set: 0.44704607129096985The modified gen p mean: 0.44634103775024414, gen p mean: -0.05532610043883324, mean p set: 0.44682133197784424
loss_pred:0.014250237494707108, decouple_loss:0.001432288670912385
loss_pred:0.014155060984194279, decouple_loss:0.0013927534455433488
Iteration: 1310, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44651535153388977, gen p mean: -0.05036911740899086, mean p set: 0.44699564576148987
loss_pred:0.014206178486347198, decouple_loss:0.0013210528995841742
The modified gen p mean: 0.44759318232536316, gen p mean: -0.047707851976156235, mean p set: 0.44807347655296326The modified gen p mean: 0.4465217888355255, gen p mean: -0.04901077225804329, mean p set: 0.4470020830631256
loss_pred:0.014038963243365288, decouple_loss:0.0012742283288389444
loss_pred:0.014067976735532284, decouple_loss:0.001276062917895615
2023-05-02 07:37:37 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.047534313052892685, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.043555743992328644, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.04376045987010002, mean p set: 0.4500633478164673
loss_pred:0.018996967002749443, decouple_loss:0.001295954454690218
loss_pred:0.01790885254740715, decouple_loss:0.0011694307904690504
loss_pred:0.017989762127399445, decouple_loss:0.0011979754781350493
WV_0_PC_1_EH_0_PS_40, loss: 0.018359582871198654, avg_mse: 0.026721591129899025
current test mse: 0.026722
Iteration: 1311, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44700536131858826, gen p mean: -0.04569815844297409, mean p set: 0.44748565554618835
The modified gen p mean: 0.4460671544075012, gen p mean: -0.04637689143419266, mean p set: 0.4465474784374237
The modified gen p mean: 0.4466235339641571, gen p mean: -0.04209326207637787, mean p set: 0.4471038281917572
loss_pred:0.014028686098754406, decouple_loss:0.0011214297264814377
loss_pred:0.01384214498102665, decouple_loss:0.0012028386117890477
loss_pred:0.014148865826427937, decouple_loss:0.00120601337403059
Iteration: 1312, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44681304693222046, gen p mean: -0.04279061034321785, mean p set: 0.44729331135749817
loss_pred:0.01425859797745943, decouple_loss:0.0012727275025099516
The modified gen p mean: 0.44740474224090576, gen p mean: -0.043008413165807724, mean p set: 0.44788506627082825The modified gen p mean: 0.4477647542953491, gen p mean: -0.041021887212991714, mean p set: 0.4482450783252716
loss_pred:0.013943563215434551, decouple_loss:0.0012013098457828164
loss_pred:0.013998232781887054, decouple_loss:0.0013904479565098882
Iteration: 1313, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4456709921360016, gen p mean: -0.044750846922397614, mean p set: 0.4461512565612793
loss_pred:0.014120019972324371, decouple_loss:0.001145420828834176
The modified gen p mean: 0.4461154639720917, gen p mean: -0.045865774154663086, mean p set: 0.44659578800201416The modified gen p mean: 0.4465196132659912, gen p mean: -0.04253970831632614, mean p set: 0.4469999372959137
loss_pred:0.01424733828753233, decouple_loss:0.0011654449626803398
loss_pred:0.013839918188750744, decouple_loss:0.001267233514226973
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1314, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470561444759369, gen p mean: -0.0422397218644619, mean p set: 0.4475364685058594
loss_pred:0.01384640671312809, decouple_loss:0.0011907207081094384
The modified gen p mean: 0.44715139269828796, gen p mean: -0.041622817516326904, mean p set: 0.4476316571235657The modified gen p mean: 0.4479460120201111, gen p mean: -0.04589122161269188, mean p set: 0.44842633605003357
loss_pred:0.014400959946215153, decouple_loss:0.0011439082445576787
loss_pred:0.013651536777615547, decouple_loss:0.0012081648455932736
Iteration: 1315, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466151297092438, gen p mean: -0.04812216758728027, mean p set: 0.44709545373916626
loss_pred:0.013727241195738316, decouple_loss:0.0011805774411186576
The modified gen p mean: 0.44734692573547363, gen p mean: -0.04968246445059776, mean p set: 0.44782721996307373The modified gen p mean: 0.44698432087898254, gen p mean: -0.04740846902132034, mean p set: 0.44746461510658264
loss_pred:0.01382061094045639, decouple_loss:0.001174011267721653
loss_pred:0.013829304836690426, decouple_loss:0.00116224423982203
Iteration: 1316, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4452042877674103, gen p mean: -0.04865094646811485, mean p set: 0.4456845819950104
loss_pred:0.013953846879303455, decouple_loss:0.0011573097435757518
The modified gen p mean: 0.44678202271461487, gen p mean: -0.04974373057484627, mean p set: 0.44726231694221497The modified gen p mean: 0.4453771114349365, gen p mean: -0.04909443110227585, mean p set: 0.445857435464859
loss_pred:0.014236826449632645, decouple_loss:0.0011740168556571007
loss_pred:0.01390493381768465, decouple_loss:0.001081679598428309
Iteration: 1317, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44682130217552185, gen p mean: -0.05057501047849655, mean p set: 0.44730156660079956
loss_pred:0.013949940912425518, decouple_loss:0.0010801191674545407
The modified gen p mean: 0.4463663399219513, gen p mean: -0.051760345697402954, mean p set: 0.446846604347229The modified gen p mean: 0.4469769597053528, gen p mean: -0.05082046613097191, mean p set: 0.4474572241306305
loss_pred:0.014159939251840115, decouple_loss:0.0013837860897183418
loss_pred:0.013811655342578888, decouple_loss:0.0011029420420527458
Iteration: 1318, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468703269958496, gen p mean: -0.04980599880218506, mean p set: 0.4473506212234497
loss_pred:0.014033479616045952, decouple_loss:0.0012405648594722152
The modified gen p mean: 0.44657984375953674, gen p mean: -0.048815011978149414, mean p set: 0.44706007838249207The modified gen p mean: 0.4461233913898468, gen p mean: -0.04649054631590843, mean p set: 0.4466037154197693
loss_pred:0.01371875498443842, decouple_loss:0.0011025764979422092
loss_pred:0.014141783118247986, decouple_loss:0.0011884277919307351
Iteration: 1319, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44756370782852173, gen p mean: -0.04517197608947754, mean p set: 0.4480440020561218
loss_pred:0.013625404797494411, decouple_loss:0.0010736274998635054
The modified gen p mean: 0.4466867446899414, gen p mean: -0.042337313294410706, mean p set: 0.4471670687198639The modified gen p mean: 0.44679540395736694, gen p mean: -0.04733646661043167, mean p set: 0.44727569818496704
loss_pred:0.014127553440630436, decouple_loss:0.001073265797458589
loss_pred:0.013852695003151894, decouple_loss:0.001083877868950367
Iteration: 1320, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44605761766433716, gen p mean: -0.04330907762050629, mean p set: 0.44653791189193726
loss_pred:0.014005141332745552, decouple_loss:0.001228728098794818
The modified gen p mean: 0.4463392496109009, gen p mean: -0.047008197754621506, mean p set: 0.446819543838501The modified gen p mean: 0.4467865228652954, gen p mean: -0.05033542215824127, mean p set: 0.4472668468952179
loss_pred:0.014171177521348, decouple_loss:0.0014522966230288148
loss_pred:0.013715796172618866, decouple_loss:0.0011863323161378503
2023-05-02 07:39:30 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.04679994657635689, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04290825501084328, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04299028217792511, mean p set: 0.4500633478164673
loss_pred:0.018990999087691307, decouple_loss:0.0012463678140193224
loss_pred:0.017930688336491585, decouple_loss:0.0014845408732071519
loss_pred:0.018000129610300064, decouple_loss:0.0012718926882371306
WV_0_PC_1_EH_0_PS_40, loss: 0.018373986706137657, avg_mse: 0.026747744530439377
current test mse: 0.026748
Iteration: 1321, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466697573661804, gen p mean: -0.04532884061336517, mean p set: 0.4471500515937805
The modified gen p mean: 0.44770076870918274, gen p mean: -0.041402772068977356, mean p set: 0.44818106293678284
The modified gen p mean: 0.4484494924545288, gen p mean: -0.044185787439346313, mean p set: 0.4489297568798065
loss_pred:0.01359659992158413, decouple_loss:0.001311608124524355
loss_pred:0.014118168503046036, decouple_loss:0.0013981714146211743loss_pred:0.013908854685723782, decouple_loss:0.00137731630820781
Iteration: 1322, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44680383801460266, gen p mean: -0.0458134263753891, mean p set: 0.44728413224220276
loss_pred:0.013646659441292286, decouple_loss:0.0011863253312185407
The modified gen p mean: 0.44643449783325195, gen p mean: -0.044451870024204254, mean p set: 0.44691479206085205The modified gen p mean: 0.44632676243782043, gen p mean: -0.04744252189993858, mean p set: 0.44680705666542053
loss_pred:0.014292668551206589, decouple_loss:0.0012263715034350753
loss_pred:0.013908603228628635, decouple_loss:0.0012389322509989142
Iteration: 1323, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4460991322994232, gen p mean: -0.04955948889255524, mean p set: 0.4465794563293457
loss_pred:0.014198962599039078, decouple_loss:0.0011769256088882685
The modified gen p mean: 0.4459965229034424, gen p mean: -0.04820847883820534, mean p set: 0.44647684693336487The modified gen p mean: 0.446666419506073, gen p mean: -0.04773231968283653, mean p set: 0.4471467435359955
loss_pred:0.013825921341776848, decouple_loss:0.0010984146501868963
loss_pred:0.014726866967976093, decouple_loss:0.001067899982444942
Iteration: 1324, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468380808830261, gen p mean: -0.0480005219578743, mean p set: 0.4473183751106262
loss_pred:0.013840727508068085, decouple_loss:0.0010280967690050602
The modified gen p mean: 0.44674137234687805, gen p mean: -0.0505860298871994, mean p set: 0.44722166657447815The modified gen p mean: 0.44680145382881165, gen p mean: -0.05258473381400108, mean p set: 0.44728177785873413
loss_pred:0.013737127184867859, decouple_loss:0.001107718562707305
loss_pred:0.01372793223708868, decouple_loss:0.0011892702896147966
Iteration: 1325, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44517549872398376, gen p mean: -0.051284052431583405, mean p set: 0.44565579295158386
loss_pred:0.01373391505330801, decouple_loss:0.0012289376463741064
The modified gen p mean: 0.44694983959198, gen p mean: -0.049440767616033554, mean p set: 0.4474301338195801The modified gen p mean: 0.44610631465911865, gen p mean: -0.049171436578035355, mean p set: 0.44658660888671875
loss_pred:0.013982122763991356, decouple_loss:0.001028404920361936
loss_pred:0.013859345577657223, decouple_loss:0.0011185797629877925
Iteration: 1326, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44701674580574036, gen p mean: -0.047389015555381775, mean p set: 0.44749704003334045
loss_pred:0.014529762789607048, decouple_loss:0.0010836611036211252
The modified gen p mean: 0.44530779123306274, gen p mean: -0.052457112818956375, mean p set: 0.44578808546066284The modified gen p mean: 0.44758808612823486, gen p mean: -0.04616084322333336, mean p set: 0.44806838035583496
loss_pred:0.013294692151248455, decouple_loss:0.0010690252529457211
loss_pred:0.013533854857087135, decouple_loss:0.0011493520578369498
Iteration: 1327, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44712936878204346, gen p mean: -0.048231855034828186, mean p set: 0.44760966300964355
loss_pred:0.014322808012366295, decouple_loss:0.001198326121084392
The modified gen p mean: 0.4467034637928009, gen p mean: -0.05096927285194397, mean p set: 0.447183758020401The modified gen p mean: 0.4472448229789734, gen p mean: -0.04965166747570038, mean p set: 0.4477251172065735
loss_pred:0.013980844058096409, decouple_loss:0.0011248111259192228
loss_pred:0.013916224241256714, decouple_loss:0.0012046074261888862
Iteration: 1328, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44643330574035645, gen p mean: -0.05625488609075546, mean p set: 0.44691362977027893
loss_pred:0.01398494839668274, decouple_loss:0.001100360881537199
The modified gen p mean: 0.44725301861763, gen p mean: -0.05082715302705765, mean p set: 0.4477333426475525The modified gen p mean: 0.4468805193901062, gen p mean: -0.053985897451639175, mean p set: 0.4473608434200287
loss_pred:0.014582930132746696, decouple_loss:0.0011051824549213052
loss_pred:0.013828600756824017, decouple_loss:0.00119858852121979
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012001_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012001_3_24hr.npz
NaN value num: 0
Iteration: 1329, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470754563808441, gen p mean: -0.05238480493426323, mean p set: 0.4475557208061218
loss_pred:0.016649527475237846, decouple_loss:0.0012614254374057055
The modified gen p mean: 0.4459201991558075, gen p mean: -0.055401887744665146, mean p set: 0.44640052318573The modified gen p mean: 0.44870543479919434, gen p mean: -0.048964060842990875, mean p set: 0.44918572902679443
loss_pred:0.016046009957790375, decouple_loss:0.0011411525774747133
loss_pred:0.016652638092637062, decouple_loss:0.0010933888843283057
Iteration: 1330, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44632381200790405, gen p mean: -0.045839790254831314, mean p set: 0.44680410623550415
loss_pred:0.01601533778011799, decouple_loss:0.0013112686574459076
The modified gen p mean: 0.4453831911087036, gen p mean: -0.053101569414138794, mean p set: 0.4458634853363037The modified gen p mean: 0.44588375091552734, gen p mean: -0.04805557057261467, mean p set: 0.44636404514312744
loss_pred:0.01602107845246792, decouple_loss:0.0011918728705495596
loss_pred:0.01551560778170824, decouple_loss:0.0012217146577313542
2023-05-02 07:41:55 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.04983178898692131, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04589661583304405, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.04606969282031059, mean p set: 0.4500633478164673
loss_pred:0.01867670752108097, decouple_loss:0.0012488733045756817
loss_pred:0.017673388123512268, decouple_loss:0.0011742932256311178loss_pred:0.017596151679754257, decouple_loss:0.0011985372984781861
WV_0_PC_1_EH_0_PS_40, loss: 0.018042445182800293, avg_mse: 0.02610756643116474
current test mse: 0.026108
Iteration: 1331, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446638286113739, gen p mean: -0.048584967851638794, mean p set: 0.4471185803413391
The modified gen p mean: 0.4459381401538849, gen p mean: -0.04701128602027893, mean p set: 0.446418434381485
The modified gen p mean: 0.44609618186950684, gen p mean: -0.04860125109553337, mean p set: 0.44657647609710693
loss_pred:0.015516906976699829, decouple_loss:0.0012018914567306638
loss_pred:0.015778031200170517, decouple_loss:0.0012077835854142904
loss_pred:0.016559770330786705, decouple_loss:0.0012105880305171013
Iteration: 1332, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44807305932044983, gen p mean: -0.046470560133457184, mean p set: 0.4485533535480499
loss_pred:0.016444671899080276, decouple_loss:0.0011309304973110557
The modified gen p mean: 0.44540107250213623, gen p mean: -0.04620653763413429, mean p set: 0.44588136672973633The modified gen p mean: 0.4462381899356842, gen p mean: -0.04334280639886856, mean p set: 0.4467185139656067
loss_pred:0.016582824289798737, decouple_loss:0.0010933083249256015
loss_pred:0.01645328477025032, decouple_loss:0.001092730788514018
Iteration: 1333, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464147090911865, gen p mean: -0.04987896606326103, mean p set: 0.4468950033187866
loss_pred:0.015600241720676422, decouple_loss:0.0013143697287887335
The modified gen p mean: 0.447072833776474, gen p mean: -0.044846270233392715, mean p set: 0.4475530982017517The modified gen p mean: 0.44712579250335693, gen p mean: -0.04434098303318024, mean p set: 0.44760608673095703
loss_pred:0.01626860909163952, decouple_loss:0.001392427715472877
loss_pred:0.016370244324207306, decouple_loss:0.0014041593531146646
Iteration: 1334, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482974410057068, gen p mean: -0.043389227241277695, mean p set: 0.4487777352333069
loss_pred:0.016532370820641518, decouple_loss:0.0011877145152539015
The modified gen p mean: 0.44679054617881775, gen p mean: -0.04852839186787605, mean p set: 0.44727084040641785The modified gen p mean: 0.4472513496875763, gen p mean: -0.046354349702596664, mean p set: 0.4477316439151764
loss_pred:0.016026711091399193, decouple_loss:0.0012029347708448768
loss_pred:0.01606137305498123, decouple_loss:0.0011473397025838494
Iteration: 1335, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44680359959602356, gen p mean: -0.04933451861143112, mean p set: 0.44728389382362366
loss_pred:0.016286399215459824, decouple_loss:0.0013609702000394464
The modified gen p mean: 0.44593241810798645, gen p mean: -0.05143361911177635, mean p set: 0.44641271233558655The modified gen p mean: 0.44733691215515137, gen p mean: -0.05091036856174469, mean p set: 0.44781720638275146
loss_pred:0.015717733651399612, decouple_loss:0.0012907803757116199
loss_pred:0.015967298299074173, decouple_loss:0.0011526447487995028
Iteration: 1336, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481053948402405, gen p mean: -0.05367589369416237, mean p set: 0.44858571887016296
loss_pred:0.0161779522895813, decouple_loss:0.0014086924493312836
The modified gen p mean: 0.44823575019836426, gen p mean: -0.048888593912124634, mean p set: 0.44871607422828674The modified gen p mean: 0.446050226688385, gen p mean: -0.047463543713092804, mean p set: 0.4465305209159851
loss_pred:0.016269786283373833, decouple_loss:0.0012086560018360615
loss_pred:0.01591181382536888, decouple_loss:0.0011185330804437399
Iteration: 1337, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44680696725845337, gen p mean: -0.05744180455803871, mean p set: 0.44728726148605347
loss_pred:0.01522921770811081, decouple_loss:0.0012429129565134645
The modified gen p mean: 0.44915899634361267, gen p mean: -0.05656372010707855, mean p set: 0.44963929057121277The modified gen p mean: 0.4456712305545807, gen p mean: -0.05078025534749031, mean p set: 0.4461515247821808
loss_pred:0.015479490160942078, decouple_loss:0.0012285816483199596
loss_pred:0.016158271580934525, decouple_loss:0.0013029978144913912
Iteration: 1338, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44729194045066833, gen p mean: -0.05332319438457489, mean p set: 0.44777223467826843
loss_pred:0.01619110256433487, decouple_loss:0.0011895118514075875
The modified gen p mean: 0.4465714693069458, gen p mean: -0.051430437713861465, mean p set: 0.4470517337322235The modified gen p mean: 0.44666028022766113, gen p mean: -0.05647130683064461, mean p set: 0.44714057445526123
loss_pred:0.016080111265182495, decouple_loss:0.0012144283391535282
loss_pred:0.016049277037382126, decouple_loss:0.001425496768206358
Iteration: 1339, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475783109664917, gen p mean: -0.057197440415620804, mean p set: 0.4480586051940918
loss_pred:0.016069985926151276, decouple_loss:0.0012470532674342394
The modified gen p mean: 0.4482898414134979, gen p mean: -0.05695345252752304, mean p set: 0.4487701654434204The modified gen p mean: 0.44878455996513367, gen p mean: -0.058509014546871185, mean p set: 0.44926485419273376
loss_pred:0.01581471785902977, decouple_loss:0.0011900803074240685
loss_pred:0.016355887055397034, decouple_loss:0.001214082119986415
Iteration: 1340, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464987814426422, gen p mean: -0.048456016927957535, mean p set: 0.4469790756702423
loss_pred:0.015561033971607685, decouple_loss:0.0013182667316868901
The modified gen p mean: 0.4473308026790619, gen p mean: -0.05334000661969185, mean p set: 0.447811096906662The modified gen p mean: 0.44939735531806946, gen p mean: -0.056785956025123596, mean p set: 0.44987761974334717
loss_pred:0.015531588345766068, decouple_loss:0.001110642682760954
loss_pred:0.015700137242674828, decouple_loss:0.0010819577146321535
2023-05-02 07:43:50 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.052283041179180145, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04803861677646637, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.048248860985040665, mean p set: 0.4500633478164673
loss_pred:0.018418660387396812, decouple_loss:0.001218436285853386
loss_pred:0.01734641008079052, decouple_loss:0.001146363210864365
loss_pred:0.017395926639437675, decouple_loss:0.0011345373932272196
WV_0_PC_1_EH_0_PS_40, loss: 0.017778653651475906, avg_mse: 0.025563260540366173
current test mse: 0.025563
Iteration: 1341, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4463096559047699, gen p mean: -0.0500265434384346, mean p set: 0.44678995013237
The modified gen p mean: 0.44904494285583496, gen p mean: -0.04787221550941467, mean p set: 0.44952526688575745
The modified gen p mean: 0.44722527265548706, gen p mean: -0.0493292436003685, mean p set: 0.44770559668540955
loss_pred:0.01567285694181919, decouple_loss:0.0011088172905147076
loss_pred:0.01605452038347721, decouple_loss:0.001195389311760664
loss_pred:0.015623264946043491, decouple_loss:0.0010657209204509854
Iteration: 1342, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44568878412246704, gen p mean: -0.05012572929263115, mean p set: 0.4461691081523895
loss_pred:0.015821000561118126, decouple_loss:0.0010891638230532408
The modified gen p mean: 0.44648781418800354, gen p mean: -0.047352083027362823, mean p set: 0.446968138217926The modified gen p mean: 0.4458862841129303, gen p mean: -0.05135435238480568, mean p set: 0.446366548538208
loss_pred:0.01613518036901951, decouple_loss:0.0010529881110414863
loss_pred:0.015658795833587646, decouple_loss:0.0010813967091962695
Iteration: 1343, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488806128501892, gen p mean: -0.04324289783835411, mean p set: 0.4493609070777893
loss_pred:0.01638924889266491, decouple_loss:0.0012418016558513045
The modified gen p mean: 0.4460093379020691, gen p mean: -0.04972065985202789, mean p set: 0.4464896619319916The modified gen p mean: 0.4464939832687378, gen p mean: -0.04653366282582283, mean p set: 0.4469743072986603
loss_pred:0.016228148713707924, decouple_loss:0.0012581914197653532
loss_pred:0.01572534628212452, decouple_loss:0.0011833709431812167
Iteration: 1344, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483083188533783, gen p mean: -0.047224290668964386, mean p set: 0.4487886130809784
loss_pred:0.016276976093649864, decouple_loss:0.001060444861650467
The modified gen p mean: 0.4477458596229553, gen p mean: -0.05231715738773346, mean p set: 0.4482261538505554The modified gen p mean: 0.44616612792015076, gen p mean: -0.05241122096776962, mean p set: 0.44664642214775085
loss_pred:0.015402430668473244, decouple_loss:0.001186832902021706
loss_pred:0.01588430255651474, decouple_loss:0.0011716000735759735
Iteration: 1345, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471196234226227, gen p mean: -0.05283121019601822, mean p set: 0.4475998878479004
loss_pred:0.016489852219820023, decouple_loss:0.0012453377712517977
The modified gen p mean: 0.44714638590812683, gen p mean: -0.052517276257276535, mean p set: 0.4476267099380493The modified gen p mean: 0.44793540239334106, gen p mean: -0.058903682976961136, mean p set: 0.4484156668186188
loss_pred:0.01633056066930294, decouple_loss:0.001133110374212265
loss_pred:0.015191926620900631, decouple_loss:0.0012078486615791917
Iteration: 1346, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4456835389137268, gen p mean: -0.05914061889052391, mean p set: 0.4461638331413269
loss_pred:0.01572135090827942, decouple_loss:0.0011168386554345489
The modified gen p mean: 0.44561290740966797, gen p mean: -0.05567743256688118, mean p set: 0.44609320163726807The modified gen p mean: 0.44538137316703796, gen p mean: -0.05852244421839714, mean p set: 0.44586169719696045
loss_pred:0.01492924615740776, decouple_loss:0.0011511099291965365
loss_pred:0.0155870970338583, decouple_loss:0.0010922403307631612
Iteration: 1347, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473434090614319, gen p mean: -0.055747684091329575, mean p set: 0.4478236734867096
loss_pred:0.016374176368117332, decouple_loss:0.001111143734306097
The modified gen p mean: 0.44636714458465576, gen p mean: -0.05590997636318207, mean p set: 0.44684743881225586The modified gen p mean: 0.4471910297870636, gen p mean: -0.05733076483011246, mean p set: 0.4476713538169861
loss_pred:0.016055235639214516, decouple_loss:0.0011768994154408574
loss_pred:0.015571590512990952, decouple_loss:0.0012131191324442625
Iteration: 1348, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44633185863494873, gen p mean: -0.05728207528591156, mean p set: 0.44681212306022644
loss_pred:0.0160826463252306, decouple_loss:0.0009920059237629175
The modified gen p mean: 0.4475814700126648, gen p mean: -0.056002549827098846, mean p set: 0.4480617940425873The modified gen p mean: 0.4475260376930237, gen p mean: -0.05847148969769478, mean p set: 0.4480063021183014
loss_pred:0.016222316771745682, decouple_loss:0.0011046903673559427
loss_pred:0.01514680590480566, decouple_loss:0.0010062785586342216
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012007_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012007_3_24hr.npz
NaN value num: 0
Iteration: 1349, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44970178604125977, gen p mean: -0.053523950278759, mean p set: 0.45018208026885986
loss_pred:0.013215923681855202, decouple_loss:0.0010987432906404138
The modified gen p mean: 0.4494439661502838, gen p mean: -0.05232063680887222, mean p set: 0.4499242305755615
The modified gen p mean: 0.44617775082588196, gen p mean: -0.05162974074482918, mean p set: 0.44665804505348206
loss_pred:0.01392429694533348, decouple_loss:0.0011799241183325648
loss_pred:0.013884739950299263, decouple_loss:0.0011615842813625932
Iteration: 1350, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448035329580307, gen p mean: -0.04946990683674812, mean p set: 0.4485156238079071
loss_pred:0.01345041487365961, decouple_loss:0.0011560439597815275
The modified gen p mean: 0.44856446981430054, gen p mean: -0.053946610540151596, mean p set: 0.44904476404190063The modified gen p mean: 0.44881513714790344, gen p mean: -0.05077574774622917, mean p set: 0.44929543137550354
loss_pred:0.014216046780347824, decouple_loss:0.0011491853510960937
loss_pred:0.01385223027318716, decouple_loss:0.0012812357163056731
2023-05-02 07:46:21 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.05297541990876198, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.049094539135694504, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.04938403517007828, mean p set: 0.4500633478164673
loss_pred:0.01863674446940422, decouple_loss:0.0012385136215016246
loss_pred:0.017568204551935196, decouple_loss:0.0012118732556700706
loss_pred:0.01760821044445038, decouple_loss:0.001186839770525694
WV_0_PC_1_EH_0_PS_40, loss: 0.017998341470956802, avg_mse: 0.025985708460211754
current test mse: 0.025986
Iteration: 1351, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44795140624046326, gen p mean: -0.048459842801094055, mean p set: 0.44843170046806335
The modified gen p mean: 0.4468880295753479, gen p mean: -0.05084868520498276, mean p set: 0.447368323802948
The modified gen p mean: 0.4477677047252655, gen p mean: -0.053473588079214096, mean p set: 0.4482479691505432
loss_pred:0.01395554281771183, decouple_loss:0.0011357393814250827
loss_pred:0.013431123457849026, decouple_loss:0.0011574594536796212
loss_pred:0.013849915005266666, decouple_loss:0.0011212242534384131
Iteration: 1352, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468289613723755, gen p mean: -0.055763211101293564, mean p set: 0.447309285402298The modified gen p mean: 0.4482154846191406, gen p mean: -0.049987584352493286, mean p set: 0.44869574904441833
loss_pred:0.013294806703925133, decouple_loss:0.001187133020721376
loss_pred:0.01390586607158184, decouple_loss:0.0012510843807831407
The modified gen p mean: 0.4474041759967804, gen p mean: -0.053571224212646484, mean p set: 0.4478845000267029
loss_pred:0.013554082252085209, decouple_loss:0.001266899867914617
Iteration: 1353, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44771867990493774, gen p mean: -0.05088149756193161, mean p set: 0.44819900393486023
loss_pred:0.013609764166176319, decouple_loss:0.0013652602210640907
The modified gen p mean: 0.4485395550727844, gen p mean: -0.05116156488656998, mean p set: 0.4490198791027069The modified gen p mean: 0.4484303593635559, gen p mean: -0.0483730211853981, mean p set: 0.4489106833934784
loss_pred:0.013856255449354649, decouple_loss:0.0013016161974519491
loss_pred:0.014016739092767239, decouple_loss:0.0012513863621279597
Iteration: 1354, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464145600795746, gen p mean: -0.054647207260131836, mean p set: 0.4468948543071747
loss_pred:0.01311630941927433, decouple_loss:0.0012585642980411649
The modified gen p mean: 0.4468555450439453, gen p mean: -0.05121409893035889, mean p set: 0.4473358392715454The modified gen p mean: 0.4483628571033478, gen p mean: -0.05092298984527588, mean p set: 0.4488431215286255
loss_pred:0.013134583830833435, decouple_loss:0.0012052133679389954
loss_pred:0.01342746987938881, decouple_loss:0.001184777240268886
Iteration: 1355, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482412040233612, gen p mean: -0.05216304585337639, mean p set: 0.4487214982509613The modified gen p mean: 0.4476761221885681, gen p mean: -0.04909738525748253, mean p set: 0.4481564164161682
loss_pred:0.013448158279061317, decouple_loss:0.001236467738635838
loss_pred:0.013345849700272083, decouple_loss:0.001196267083287239
The modified gen p mean: 0.447837769985199, gen p mean: -0.054054390639066696, mean p set: 0.4483180344104767
loss_pred:0.014417339116334915, decouple_loss:0.0012150555849075317
Iteration: 1356, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479919672012329, gen p mean: -0.0469004325568676, mean p set: 0.448472261428833
loss_pred:0.012989595532417297, decouple_loss:0.001407749718055129
The modified gen p mean: 0.44891947507858276, gen p mean: -0.0473613515496254, mean p set: 0.44939976930618286The modified gen p mean: 0.4470553696155548, gen p mean: -0.05186343938112259, mean p set: 0.4475356340408325
loss_pred:0.013353411108255386, decouple_loss:0.0015704642282798886
loss_pred:0.013392924331128597, decouple_loss:0.0014827840495854616
Iteration: 1357, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466460645198822, gen p mean: -0.047035474330186844, mean p set: 0.4471263289451599
loss_pred:0.012988406233489513, decouple_loss:0.0011961351847276092
The modified gen p mean: 0.44812509417533875, gen p mean: -0.04349212348461151, mean p set: 0.44860541820526123
The modified gen p mean: 0.4474222660064697, gen p mean: -0.04915114492177963, mean p set: 0.4479025602340698
loss_pred:0.013587980531156063, decouple_loss:0.0012150034308433533
loss_pred:0.013165585696697235, decouple_loss:0.0011577619006857276
Iteration: 1358, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483945369720459, gen p mean: -0.04111672192811966, mean p set: 0.4488748610019684
loss_pred:0.013686596415936947, decouple_loss:0.0017338150646537542
The modified gen p mean: 0.4471645653247833, gen p mean: -0.044597040861845016, mean p set: 0.4476448595523834The modified gen p mean: 0.4492429792881012, gen p mean: -0.04336949437856674, mean p set: 0.4497232735157013
loss_pred:0.013397983275353909, decouple_loss:0.0016002844786271453
loss_pred:0.013115324079990387, decouple_loss:0.001756342244334519
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1359, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495560824871063, gen p mean: -0.043924808502197266, mean p set: 0.4500364065170288
loss_pred:0.013058113865554333, decouple_loss:0.0013423541095107794
The modified gen p mean: 0.4482189118862152, gen p mean: -0.04263943061232567, mean p set: 0.4486992359161377The modified gen p mean: 0.4485229551792145, gen p mean: -0.04364846646785736, mean p set: 0.44900330901145935
loss_pred:0.012990618124604225, decouple_loss:0.001312893582507968
loss_pred:0.013476395979523659, decouple_loss:0.0013801968889310956
Iteration: 1360, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475903809070587, gen p mean: -0.05174979567527771, mean p set: 0.4480707347393036
loss_pred:0.013978802599012852, decouple_loss:0.0014408978167921305
The modified gen p mean: 0.45016229152679443, gen p mean: -0.04810728877782822, mean p set: 0.4506426155567169The modified gen p mean: 0.4500880539417267, gen p mean: -0.04702603816986084, mean p set: 0.4505683481693268
loss_pred:0.01284338440746069, decouple_loss:0.0013752221129834652
loss_pred:0.012807941995561123, decouple_loss:0.0012129927054047585
2023-05-02 07:48:14 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.049759138375520706, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04535116255283356, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.0459054671227932, mean p set: 0.4500633478164673
loss_pred:0.019032998010516167, decouple_loss:0.0015915937256067991
loss_pred:0.01797603815793991, decouple_loss:0.0014361358480527997
loss_pred:0.01802235096693039, decouple_loss:0.0014434928307309747
WV_0_PC_1_EH_0_PS_40, loss: 0.018418315798044205, avg_mse: 0.026801180094480515
current test mse: 0.026801
Iteration: 1361, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491856098175049, gen p mean: -0.04784616827964783, mean p set: 0.449665904045105
The modified gen p mean: 0.44784075021743774, gen p mean: -0.04873814433813095, mean p set: 0.44832107424736023
The modified gen p mean: 0.4480733871459961, gen p mean: -0.04558137059211731, mean p set: 0.4485537111759186
loss_pred:0.014476615935564041, decouple_loss:0.0013465320225805044
loss_pred:0.012757182121276855, decouple_loss:0.001426251488737762
loss_pred:0.01391147542744875, decouple_loss:0.0012927902862429619
Iteration: 1362, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44702860713005066, gen p mean: -0.05084335431456566, mean p set: 0.44750893115997314
loss_pred:0.013006320223212242, decouple_loss:0.001367444172501564
The modified gen p mean: 0.44904133677482605, gen p mean: -0.04877331852912903, mean p set: 0.44952166080474854The modified gen p mean: 0.447005033493042, gen p mean: -0.05038899928331375, mean p set: 0.4474853575229645
loss_pred:0.013087991625070572, decouple_loss:0.0013697354588657618
loss_pred:0.012859520502388477, decouple_loss:0.0012678480707108974
Iteration: 1363, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44713225960731506, gen p mean: -0.04844481125473976, mean p set: 0.4476125240325928
The modified gen p mean: 0.4480031430721283, gen p mean: -0.043140117079019547, mean p set: 0.4484834671020508
loss_pred:0.013200630433857441, decouple_loss:0.001282106968574226
loss_pred:0.013231796212494373, decouple_loss:0.001210987800732255
The modified gen p mean: 0.447710245847702, gen p mean: -0.04508008807897568, mean p set: 0.4481905400753021
loss_pred:0.01329533476382494, decouple_loss:0.0013830997049808502
Iteration: 1364, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44832944869995117, gen p mean: -0.04390614479780197, mean p set: 0.4488097131252289
loss_pred:0.013331850990653038, decouple_loss:0.0012262605596333742
The modified gen p mean: 0.4475352168083191, gen p mean: -0.04505031183362007, mean p set: 0.4480155408382416The modified gen p mean: 0.4475768506526947, gen p mean: -0.049579426646232605, mean p set: 0.4480571746826172
loss_pred:0.013297537341713905, decouple_loss:0.0012645288370549679
loss_pred:0.014242677949368954, decouple_loss:0.001412637997418642
Iteration: 1365, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44823968410491943, gen p mean: -0.042545873671770096, mean p set: 0.44871997833251953
loss_pred:0.012907342053949833, decouple_loss:0.0012442837469279766
The modified gen p mean: 0.4477846920490265, gen p mean: -0.04468419402837753, mean p set: 0.4482649564743042The modified gen p mean: 0.448089063167572, gen p mean: -0.04197932034730911, mean p set: 0.4485693573951721
loss_pred:0.013215970247983932, decouple_loss:0.0012071669334545732
loss_pred:0.012858905829489231, decouple_loss:0.001210339367389679
Iteration: 1366, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44793441891670227, gen p mean: -0.04177894443273544, mean p set: 0.44841471314430237
loss_pred:0.013524706475436687, decouple_loss:0.001235154690220952
The modified gen p mean: 0.44707077741622925, gen p mean: -0.043527111411094666, mean p set: 0.44755110144615173The modified gen p mean: 0.4482479691505432, gen p mean: -0.04295392706990242, mean p set: 0.4487282633781433
loss_pred:0.013446914032101631, decouple_loss:0.0011987980687990785
loss_pred:0.013517089188098907, decouple_loss:0.0011819418286904693
Iteration: 1367, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472527801990509, gen p mean: -0.04429946839809418, mean p set: 0.4477330446243286
loss_pred:0.013096529059112072, decouple_loss:0.0011304299114271998
The modified gen p mean: 0.4469155967235565, gen p mean: -0.04616594314575195, mean p set: 0.4473958909511566The modified gen p mean: 0.4461434781551361, gen p mean: -0.04640787094831467, mean p set: 0.4466237425804138
loss_pred:0.01315306592732668, decouple_loss:0.0011343165533617139
loss_pred:0.012853171676397324, decouple_loss:0.0012878638226538897
Iteration: 1368, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466298222541809, gen p mean: -0.045443955808877945, mean p set: 0.447110116481781
loss_pred:0.01363711804151535, decouple_loss:0.0012296774657443166
The modified gen p mean: 0.44588345289230347, gen p mean: -0.04454677551984787, mean p set: 0.44636374711990356The modified gen p mean: 0.44678202271461487, gen p mean: -0.043104611337184906, mean p set: 0.44726231694221497
loss_pred:0.012946992181241512, decouple_loss:0.0011324809165671468
loss_pred:0.013964076526463032, decouple_loss:0.0012237763730809093
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012005_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012005_3_24hr.npz
NaN value num: 0
Iteration: 1369, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4523015320301056, gen p mean: -0.038644831627607346, mean p set: 0.4527818560600281
loss_pred:0.01633465103805065, decouple_loss:0.0013434825232252479
The modified gen p mean: 0.45404502749443054, gen p mean: -0.04390718415379524, mean p set: 0.45452532172203064The modified gen p mean: 0.4510310888290405, gen p mean: -0.04167185723781586, mean p set: 0.4515113830566406
loss_pred:0.01699247397482395, decouple_loss:0.001408219337463379
loss_pred:0.016438009217381477, decouple_loss:0.0012647107942029834
Iteration: 1370, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.454100102186203, gen p mean: -0.03949255496263504, mean p set: 0.4545804262161255
loss_pred:0.016615815460681915, decouple_loss:0.001312566571868956
The modified gen p mean: 0.4518640637397766, gen p mean: -0.033882539719343185, mean p set: 0.4523443579673767The modified gen p mean: 0.45204100012779236, gen p mean: -0.03313745930790901, mean p set: 0.45252126455307007
loss_pred:0.0158927571028471, decouple_loss:0.0013467947719618678
loss_pred:0.016373688355088234, decouple_loss:0.0013249185867607594
2023-05-02 07:50:48 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.040914781391620636, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.037011176347732544, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.03723859041929245, mean p set: 0.4500633478164673
loss_pred:0.018649619072675705, decouple_loss:0.0014421676751226187
loss_pred:0.01760338619351387, decouple_loss:0.0014320005429908633
loss_pred:0.017652330920100212, decouple_loss:0.0014001692179590464
WV_0_PC_1_EH_0_PS_40, loss: 0.018039684742689133, avg_mse: 0.026073811575770378
current test mse: 0.026074
Iteration: 1371, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494636654853821, gen p mean: -0.030239472165703773, mean p set: 0.4499439597129822
The modified gen p mean: 0.4507555365562439, gen p mean: -0.03400221839547157, mean p set: 0.451235830783844
The modified gen p mean: 0.4514361023902893, gen p mean: -0.028321674093604088, mean p set: 0.4519164264202118
loss_pred:0.016750382259488106, decouple_loss:0.0014779819175601006
loss_pred:0.016041820868849754, decouple_loss:0.0014284929493442178
loss_pred:0.015504852868616581, decouple_loss:0.0013643306447193027
Iteration: 1372, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511702358722687, gen p mean: -0.02501259371638298, mean p set: 0.4516505002975464
loss_pred:0.01604839786887169, decouple_loss:0.0012631973950192332
The modified gen p mean: 0.45282450318336487, gen p mean: -0.026708563789725304, mean p set: 0.4533047676086426
The modified gen p mean: 0.45060399174690247, gen p mean: -0.024056317284703255, mean p set: 0.45108428597450256
loss_pred:0.016519196331501007, decouple_loss:0.001259849057532847
loss_pred:0.016628913581371307, decouple_loss:0.0012655445607379079
Iteration: 1373, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4527290463447571, gen p mean: -0.025948364287614822, mean p set: 0.4532093107700348
loss_pred:0.01613866537809372, decouple_loss:0.0012998938327655196
The modified gen p mean: 0.45258834958076477, gen p mean: -0.023815905675292015, mean p set: 0.45306864380836487The modified gen p mean: 0.4497024118900299, gen p mean: -0.03132988512516022, mean p set: 0.45018270611763
loss_pred:0.016425583511590958, decouple_loss:0.0014058795059099793
loss_pred:0.015589472837746143, decouple_loss:0.0013551806332543492
Iteration: 1374, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501189887523651, gen p mean: -0.026067791506648064, mean p set: 0.4505993127822876
loss_pred:0.016112113371491432, decouple_loss:0.0012207386316731572
The modified gen p mean: 0.45161470770835876, gen p mean: -0.02385045774281025, mean p set: 0.45209503173828125The modified gen p mean: 0.45183470845222473, gen p mean: -0.019240859895944595, mean p set: 0.45231500267982483
loss_pred:0.01577949896454811, decouple_loss:0.001181051367893815
loss_pred:0.01557241566479206, decouple_loss:0.0011715171858668327
Iteration: 1375, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4540458917617798, gen p mean: -0.03138475492596626, mean p set: 0.45452621579170227
loss_pred:0.015147431753575802, decouple_loss:0.001410384546034038
The modified gen p mean: 0.45040595531463623, gen p mean: -0.02840868942439556, mean p set: 0.45088624954223633The modified gen p mean: 0.45334434509277344, gen p mean: -0.0253318902105093, mean p set: 0.45382463932037354
loss_pred:0.01619049534201622, decouple_loss:0.0012261008378118277
loss_pred:0.016344042494893074, decouple_loss:0.0012502740137279034
Iteration: 1376, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45042428374290466, gen p mean: -0.03654475882649422, mean p set: 0.45090457797050476
loss_pred:0.015909601002931595, decouple_loss:0.0012166729429736733
The modified gen p mean: 0.4512365162372589, gen p mean: -0.029207797721028328, mean p set: 0.451716810464859The modified gen p mean: 0.4530911147594452, gen p mean: -0.030796095728874207, mean p set: 0.4535713791847229
loss_pred:0.015942411497235298, decouple_loss:0.001329978695139289
loss_pred:0.01592360809445381, decouple_loss:0.0013151749735698104
Iteration: 1377, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4525851309299469, gen p mean: -0.03312874212861061, mean p set: 0.453065425157547
loss_pred:0.016591819003224373, decouple_loss:0.0011353978188708425
The modified gen p mean: 0.45201167464256287, gen p mean: -0.03560993820428848, mean p set: 0.45249199867248535The modified gen p mean: 0.4538334906101227, gen p mean: -0.03557956963777542, mean p set: 0.45431381464004517
loss_pred:0.01583346724510193, decouple_loss:0.0011686799116432667
loss_pred:0.01614932157099247, decouple_loss:0.0011925221187993884
Iteration: 1378, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4519652724266052, gen p mean: -0.04033004119992256, mean p set: 0.4524455666542053
loss_pred:0.01599755324423313, decouple_loss:0.001254618400707841
The modified gen p mean: 0.451201468706131, gen p mean: -0.035729870200157166, mean p set: 0.4516817331314087The modified gen p mean: 0.45228126645088196, gen p mean: -0.039201728999614716, mean p set: 0.45276156067848206
loss_pred:0.016044829040765762, decouple_loss:0.0011841371888294816
loss_pred:0.015810469165444374, decouple_loss:0.0013214412610977888
Iteration: 1379, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45174407958984375, gen p mean: -0.043289441615343094, mean p set: 0.45222437381744385
loss_pred:0.01615765690803528, decouple_loss:0.0012121443869546056
The modified gen p mean: 0.4507405161857605, gen p mean: -0.040888842195272446, mean p set: 0.4512208104133606The modified gen p mean: 0.45024573802948, gen p mean: -0.03882821276783943, mean p set: 0.4507260322570801
loss_pred:0.016352716833353043, decouple_loss:0.0011582847218960524
loss_pred:0.016433661803603172, decouple_loss:0.0011715717846527696
Iteration: 1380, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4534416198730469, gen p mean: -0.03941328451037407, mean p set: 0.453921914100647
loss_pred:0.016018912196159363, decouple_loss:0.001313784858211875
The modified gen p mean: 0.45130792260169983, gen p mean: -0.03729766979813576, mean p set: 0.4517882466316223The modified gen p mean: 0.4531160593032837, gen p mean: -0.04665672779083252, mean p set: 0.4535963535308838
loss_pred:0.016044780611991882, decouple_loss:0.0011623705504462123
loss_pred:0.015775084495544434, decouple_loss:0.0012861202703788877
2023-05-02 07:52:42 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.04777669161558151, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.0438581220805645, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.04412234574556351, mean p set: 0.4500633478164673
loss_pred:0.018295584246516228, decouple_loss:0.0013157138600945473
loss_pred:0.017282869666814804, decouple_loss:0.0013693354558199644
loss_pred:0.017329806461930275, decouple_loss:0.00135447783395648
WV_0_PC_1_EH_0_PS_40, loss: 0.017703412100672722, avg_mse: 0.02540552243590355
current test mse: 0.025406
Iteration: 1381, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45058473944664, gen p mean: -0.03889648988842964, mean p set: 0.4510650634765625
The modified gen p mean: 0.4505560100078583, gen p mean: -0.04407906532287598, mean p set: 0.4510363042354584
The modified gen p mean: 0.450573205947876, gen p mean: -0.031684234738349915, mean p set: 0.45105352997779846
loss_pred:0.016796590760350227, decouple_loss:0.001278633251786232
loss_pred:0.01578339748084545, decouple_loss:0.00142861797939986
loss_pred:0.01601228676736355, decouple_loss:0.0013387700309976935
Iteration: 1382, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45310527086257935, gen p mean: -0.04375716671347618, mean p set: 0.45358556509017944
loss_pred:0.016153819859027863, decouple_loss:0.0013853606069460511
The modified gen p mean: 0.45038139820098877, gen p mean: -0.033510200679302216, mean p set: 0.45086169242858887The modified gen p mean: 0.45194631814956665, gen p mean: -0.03934135288000107, mean p set: 0.45242658257484436
loss_pred:0.01658688858151436, decouple_loss:0.0012713196920230985
loss_pred:0.016051599755883217, decouple_loss:0.0013107690028846264
Iteration: 1383, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493984580039978, gen p mean: -0.04182043671607971, mean p set: 0.4498787522315979
loss_pred:0.015455271117389202, decouple_loss:0.0011567027540877461
The modified gen p mean: 0.4548639953136444, gen p mean: -0.04268677532672882, mean p set: 0.4553443193435669The modified gen p mean: 0.4519379734992981, gen p mean: -0.04233207553625107, mean p set: 0.4524182975292206
loss_pred:0.01608429290354252, decouple_loss:0.0012993738055229187
loss_pred:0.01556619442999363, decouple_loss:0.0012532894033938646
Iteration: 1384, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45240914821624756, gen p mean: -0.04214407503604889, mean p set: 0.45288947224617004
loss_pred:0.015864906832575798, decouple_loss:0.0013223531423136592
The modified gen p mean: 0.4499375522136688, gen p mean: -0.039577022194862366, mean p set: 0.4504178762435913The modified gen p mean: 0.4503895938396454, gen p mean: -0.040252234786748886, mean p set: 0.45086991786956787
loss_pred:0.01586594246327877, decouple_loss:0.001302259275689721
loss_pred:0.016009153798222542, decouple_loss:0.0013557784259319305
Iteration: 1385, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504230320453644, gen p mean: -0.04257935658097267, mean p set: 0.4509033262729645
loss_pred:0.01581200398504734, decouple_loss:0.0011911350302398205
The modified gen p mean: 0.45273321866989136, gen p mean: -0.040374454110860825, mean p set: 0.45321348309516907The modified gen p mean: 0.44958361983299255, gen p mean: -0.0431719571352005, mean p set: 0.45006391406059265
loss_pred:0.01523892767727375, decouple_loss:0.0012089264346286654
loss_pred:0.016012636944651604, decouple_loss:0.0012186240637674928
Iteration: 1386, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4515925645828247, gen p mean: -0.03827068209648132, mean p set: 0.4520728290081024
loss_pred:0.015496871434152126, decouple_loss:0.0011733240680769086
The modified gen p mean: 0.4523387551307678, gen p mean: -0.041622716933488846, mean p set: 0.4528190791606903The modified gen p mean: 0.45217084884643555, gen p mean: -0.03850790858268738, mean p set: 0.45265111327171326
loss_pred:0.015848228707909584, decouple_loss:0.001310933381319046
loss_pred:0.016227323561906815, decouple_loss:0.0012055012630298734
Iteration: 1387, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505912661552429, gen p mean: -0.04079516604542732, mean p set: 0.451071560382843
loss_pred:0.015994790941476822, decouple_loss:0.0010905659291893244
The modified gen p mean: 0.45198854804039, gen p mean: -0.04636278375983238, mean p set: 0.4524688422679901The modified gen p mean: 0.44977107644081116, gen p mean: -0.046031609177589417, mean p set: 0.45025137066841125
loss_pred:0.01580536738038063, decouple_loss:0.0010768102947622538
loss_pred:0.016021234914660454, decouple_loss:0.0011430045124143362
Iteration: 1388, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45290035009384155, gen p mean: -0.03866396099328995, mean p set: 0.45338064432144165
loss_pred:0.016374845057725906, decouple_loss:0.0012409943155944347
The modified gen p mean: 0.45117464661598206, gen p mean: -0.03745107725262642, mean p set: 0.45165497064590454The modified gen p mean: 0.4532493054866791, gen p mean: -0.04238307476043701, mean p set: 0.4537295699119568
loss_pred:0.01686709001660347, decouple_loss:0.0011178917484357953
loss_pred:0.01577872596681118, decouple_loss:0.0011809449642896652
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012001_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012001_3_24hr.npz
NaN value num: 0
Iteration: 1389, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45352527499198914, gen p mean: -0.04011659696698189, mean p set: 0.45400553941726685
loss_pred:0.015780119225382805, decouple_loss:0.0012369980104267597
The modified gen p mean: 0.45202162861824036, gen p mean: -0.042616065591573715, mean p set: 0.45250189304351807The modified gen p mean: 0.45168137550354004, gen p mean: -0.04031909257173538, mean p set: 0.4521616995334625
loss_pred:0.016183417290449142, decouple_loss:0.001086652628146112
loss_pred:0.016408391296863556, decouple_loss:0.0010773485992103815
Iteration: 1390, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4523485600948334, gen p mean: -0.03629452735185623, mean p set: 0.45282885432243347
loss_pred:0.015612039715051651, decouple_loss:0.0010061325738206506
The modified gen p mean: 0.45083943009376526, gen p mean: -0.04041288048028946, mean p set: 0.45131972432136536The modified gen p mean: 0.45128318667411804, gen p mean: -0.03939646854996681, mean p set: 0.4517635107040405
loss_pred:0.01625850796699524, decouple_loss:0.0010728217894211411
loss_pred:0.016387606039643288, decouple_loss:0.0010891292477026582
2023-05-02 07:55:10 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.04923576861619949, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.0454561784863472, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04570351541042328, mean p set: 0.4500633478164673
loss_pred:0.01828068122267723, decouple_loss:0.001237906632013619
loss_pred:0.017234036698937416, decouple_loss:0.0011349256383255124
loss_pred:0.017330758273601532, decouple_loss:0.001126166433095932
WV_0_PC_1_EH_0_PS_40, loss: 0.017673475667834282, avg_mse: 0.02535245381295681
current test mse: 0.025352
Iteration: 1391, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513283669948578, gen p mean: -0.04041570797562599, mean p set: 0.4518086314201355
The modified gen p mean: 0.45261451601982117, gen p mean: -0.03717446327209473, mean p set: 0.45309484004974365
The modified gen p mean: 0.45112499594688416, gen p mean: -0.03581736609339714, mean p set: 0.45160529017448425
loss_pred:0.016366910189390182, decouple_loss:0.0010844545904546976
loss_pred:0.01676992140710354, decouple_loss:0.0012012383667752147
loss_pred:0.01592656970024109, decouple_loss:0.0010577129432931542
Iteration: 1392, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45091119408607483, gen p mean: -0.03915998339653015, mean p set: 0.4513914883136749
loss_pred:0.016137046739459038, decouple_loss:0.0012270984007045627
The modified gen p mean: 0.45107680559158325, gen p mean: -0.03791309893131256, mean p set: 0.45155712962150574The modified gen p mean: 0.45009109377861023, gen p mean: -0.03666291385889053, mean p set: 0.4505713880062103
loss_pred:0.016149301081895828, decouple_loss:0.0012817991664633155
loss_pred:0.01593269221484661, decouple_loss:0.00128280371427536
Iteration: 1393, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45159706473350525, gen p mean: -0.04737937077879906, mean p set: 0.4520774185657501
loss_pred:0.016194786876440048, decouple_loss:0.0013171931495890021
The modified gen p mean: 0.4511992931365967, gen p mean: -0.0386541485786438, mean p set: 0.4516795575618744The modified gen p mean: 0.4515265226364136, gen p mean: -0.0390128530561924, mean p set: 0.45200681686401367
loss_pred:0.016285188496112823, decouple_loss:0.0010670515475794673
loss_pred:0.01586053892970085, decouple_loss:0.0011070762993767858
Iteration: 1394, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45068320631980896, gen p mean: -0.03797995671629906, mean p set: 0.45116350054740906
loss_pred:0.01621328853070736, decouple_loss:0.0011754934675991535
The modified gen p mean: 0.45079854130744934, gen p mean: -0.039142362773418427, mean p set: 0.4512788653373718The modified gen p mean: 0.4519747793674469, gen p mean: -0.042760878801345825, mean p set: 0.4524551033973694
loss_pred:0.016664210706949234, decouple_loss:0.001201578532345593
loss_pred:0.016065964475274086, decouple_loss:0.0012168203247711062
Iteration: 1395, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513355791568756, gen p mean: -0.04161135107278824, mean p set: 0.4518158733844757
loss_pred:0.016737034544348717, decouple_loss:0.0011695298599079251
The modified gen p mean: 0.4514450132846832, gen p mean: -0.04900524765253067, mean p set: 0.45192527770996094The modified gen p mean: 0.452980101108551, gen p mean: -0.04307147487998009, mean p set: 0.4534603953361511
loss_pred:0.016442425549030304, decouple_loss:0.0013052376452833414
loss_pred:0.01576848328113556, decouple_loss:0.0011367341503500938
Iteration: 1396, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4516487717628479, gen p mean: -0.04503755643963814, mean p set: 0.4521290957927704
loss_pred:0.015679584816098213, decouple_loss:0.0010945218382403255
The modified gen p mean: 0.4516104459762573, gen p mean: -0.04485800117254257, mean p set: 0.4520907402038574The modified gen p mean: 0.45130497217178345, gen p mean: -0.05218697339296341, mean p set: 0.45178526639938354
loss_pred:0.01596529223024845, decouple_loss:0.0011187827913090587
loss_pred:0.016509423032402992, decouple_loss:0.0011278853053227067
Iteration: 1397, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4528735876083374, gen p mean: -0.04636746644973755, mean p set: 0.4533538818359375
loss_pred:0.015825049951672554, decouple_loss:0.0011009561130777001
The modified gen p mean: 0.45055311918258667, gen p mean: -0.055816736072301865, mean p set: 0.45103341341018677
The modified gen p mean: 0.45081257820129395, gen p mean: -0.04939033463597298, mean p set: 0.45129284262657166
loss_pred:0.016347922384738922, decouple_loss:0.0011009970912709832
loss_pred:0.016047805547714233, decouple_loss:0.0011104608420282602
Iteration: 1398, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505007266998291, gen p mean: -0.05389968305826187, mean p set: 0.4509810209274292
loss_pred:0.016695866361260414, decouple_loss:0.0011783530935645103
The modified gen p mean: 0.4521564841270447, gen p mean: -0.05635019764304161, mean p set: 0.4526367783546448The modified gen p mean: 0.4534478485584259, gen p mean: -0.04906352981925011, mean p set: 0.4539281725883484
loss_pred:0.01599092409014702, decouple_loss:0.0011927648447453976
loss_pred:0.01585405319929123, decouple_loss:0.0012031195219606161
Iteration: 1399, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503172039985657, gen p mean: -0.0541146881878376, mean p set: 0.45079749822616577
loss_pred:0.0165226012468338, decouple_loss:0.0011037536896765232
The modified gen p mean: 0.45036497712135315, gen p mean: -0.05341533198952675, mean p set: 0.45084527134895325The modified gen p mean: 0.4518086910247803, gen p mean: -0.05656727775931358, mean p set: 0.452288955450058
loss_pred:0.016777044162154198, decouple_loss:0.0010280628921464086
loss_pred:0.015705132856965065, decouple_loss:0.0011135266395285726
Iteration: 1400, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4533771276473999, gen p mean: -0.054615724831819534, mean p set: 0.453857421875
loss_pred:0.015561224892735481, decouple_loss:0.0011663077166303992
The modified gen p mean: 0.45133912563323975, gen p mean: -0.0537450797855854, mean p set: 0.45181941986083984The modified gen p mean: 0.4521545469760895, gen p mean: -0.06019320711493492, mean p set: 0.4526348412036896
loss_pred:0.016438039019703865, decouple_loss:0.0011552430223673582
loss_pred:0.01639470085501671, decouple_loss:0.0012389051262289286
2023-05-02 07:57:06 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.0632963702082634, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.0589386448264122, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.05970286577939987, mean p set: 0.4500633478164673
loss_pred:0.018287457525730133, decouple_loss:0.001361992908641696
loss_pred:0.01721770316362381, decouple_loss:0.001370261306874454
loss_pred:0.01736541837453842, decouple_loss:0.0012894669780507684
WV_0_PC_1_EH_0_PS_40, loss: 0.01769055612385273, avg_mse: 0.025357915088534355
current test mse: 0.025358
Iteration: 1401, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45164602994918823, gen p mean: -0.05203203856945038, mean p set: 0.45212632417678833
The modified gen p mean: 0.4527490735054016, gen p mean: -0.05263717100024223, mean p set: 0.4532293677330017
The modified gen p mean: 0.45076414942741394, gen p mean: -0.051034048199653625, mean p set: 0.45124444365501404
loss_pred:0.01561939436942339, decouple_loss:0.0011434312909841537
loss_pred:0.015457802452147007, decouple_loss:0.0011254474520683289
loss_pred:0.016625970602035522, decouple_loss:0.0011789309792220592
Iteration: 1402, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45115646719932556, gen p mean: -0.04748639464378357, mean p set: 0.45163676142692566
loss_pred:0.01605808734893799, decouple_loss:0.0011648177169263363
The modified gen p mean: 0.4514846205711365, gen p mean: -0.05352887883782387, mean p set: 0.4519648849964142The modified gen p mean: 0.45068272948265076, gen p mean: -0.049986012279987335, mean p set: 0.45116302371025085
loss_pred:0.016789991408586502, decouple_loss:0.0011040102690458298
loss_pred:0.01639695279300213, decouple_loss:0.0012475813273340464
Iteration: 1403, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45123812556266785, gen p mean: -0.045006781816482544, mean p set: 0.45171838998794556
loss_pred:0.016187869012355804, decouple_loss:0.001064820447936654
The modified gen p mean: 0.4532676935195923, gen p mean: -0.043770961463451385, mean p set: 0.45374795794487The modified gen p mean: 0.45175886154174805, gen p mean: -0.047140058130025864, mean p set: 0.45223915576934814
loss_pred:0.015607612207531929, decouple_loss:0.0012310186866670847
loss_pred:0.016076775267720222, decouple_loss:0.0012011100770905614
Iteration: 1404, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45204198360443115, gen p mean: -0.05500815436244011, mean p set: 0.45252230763435364
loss_pred:0.016305018216371536, decouple_loss:0.0013541551306843758
The modified gen p mean: 0.4512366056442261, gen p mean: -0.045176051557064056, mean p set: 0.45171689987182617The modified gen p mean: 0.45059406757354736, gen p mean: -0.04577429220080376, mean p set: 0.45107436180114746
loss_pred:0.01667427457869053, decouple_loss:0.0010780111188068986
loss_pred:0.01602139137685299, decouple_loss:0.0010610654717311263
Iteration: 1405, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45170262455940247, gen p mean: -0.04260801151394844, mean p set: 0.45218291878700256
loss_pred:0.016595540568232536, decouple_loss:0.0011255800491198897
The modified gen p mean: 0.45212656259536743, gen p mean: -0.04752000793814659, mean p set: 0.4526068866252899The modified gen p mean: 0.45364895462989807, gen p mean: -0.046021718531847, mean p set: 0.45412924885749817
loss_pred:0.015521845780313015, decouple_loss:0.0011360602220520377
loss_pred:0.01609767973423004, decouple_loss:0.0012185866944491863
Iteration: 1406, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4515432119369507, gen p mean: -0.04522830620408058, mean p set: 0.4520235061645508
loss_pred:0.015604612417519093, decouple_loss:0.0010296069085597992
The modified gen p mean: 0.45145851373672485, gen p mean: -0.04279840737581253, mean p set: 0.45193883776664734The modified gen p mean: 0.45398658514022827, gen p mean: -0.04664698988199234, mean p set: 0.45446687936782837
loss_pred:0.016431322321295738, decouple_loss:0.0010321728186681867
loss_pred:0.01573001593351364, decouple_loss:0.0011268358211964369
Iteration: 1407, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45120954513549805, gen p mean: -0.04809942469000816, mean p set: 0.45168986916542053
loss_pred:0.01595122553408146, decouple_loss:0.0011864460539072752
The modified gen p mean: 0.4508376121520996, gen p mean: -0.047250229865312576, mean p set: 0.4513179063796997The modified gen p mean: 0.4526425898075104, gen p mean: -0.05565327778458595, mean p set: 0.4531228840351105
loss_pred:0.016232779249548912, decouple_loss:0.0013433708809316158
loss_pred:0.0170014426112175, decouple_loss:0.0011426364071667194
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012013_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012013_3_24hr.npz
NaN value num: 0
Iteration: 1408, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466029703617096, gen p mean: -0.05790935084223747, mean p set: 0.4470832645893097
loss_pred:0.014778021723031998, decouple_loss:0.0013068136759102345
The modified gen p mean: 0.445743203163147, gen p mean: -0.061421580612659454, mean p set: 0.44622352719306946The modified gen p mean: 0.4476061463356018, gen p mean: -0.06095167249441147, mean p set: 0.4480864405632019
loss_pred:0.015327412635087967, decouple_loss:0.0013689271872863173
loss_pred:0.015288763679564, decouple_loss:0.001332611427642405
Iteration: 1409, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44710981845855713, gen p mean: -0.06802541762590408, mean p set: 0.4475901126861572
The modified gen p mean: 0.44666650891304016, gen p mean: -0.06932251155376434, mean p set: 0.44714680314064026
loss_pred:0.015319976955652237, decouple_loss:0.0010961577063426375
loss_pred:0.01553349383175373, decouple_loss:0.0014820984797552228
The modified gen p mean: 0.44724833965301514, gen p mean: -0.06448492407798767, mean p set: 0.44772863388061523
loss_pred:0.01480703055858612, decouple_loss:0.0012609247351065278
Iteration: 1410, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475097358226776, gen p mean: -0.07094565778970718, mean p set: 0.4479900598526001
loss_pred:0.015385868027806282, decouple_loss:0.0011734440922737122
The modified gen p mean: 0.44725650548934937, gen p mean: -0.0702192634344101, mean p set: 0.44773682951927185The modified gen p mean: 0.44697147607803345, gen p mean: -0.07129345834255219, mean p set: 0.44745174050331116
loss_pred:0.014957226812839508, decouple_loss:0.0011704275384545326
loss_pred:0.01498820073902607, decouple_loss:0.0012609456898644567
2023-05-02 07:59:38 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.07356700301170349, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.06953992694616318, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.07002612948417664, mean p set: 0.4500633478164673
loss_pred:0.01858643628656864, decouple_loss:0.0013868178939446807
loss_pred:0.017478449270129204, decouple_loss:0.0012895166873931885
loss_pred:0.017591120675206184, decouple_loss:0.0013422955526039004
WV_0_PC_1_EH_0_PS_40, loss: 0.017952313646674156, avg_mse: 0.025860879570245743
current test mse: 0.025861
Iteration: 1411, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44658491015434265, gen p mean: -0.07451502978801727, mean p set: 0.44706523418426514
The modified gen p mean: 0.446255624294281, gen p mean: -0.07409217953681946, mean p set: 0.4467359483242035
The modified gen p mean: 0.44652870297431946, gen p mean: -0.07200314849615097, mean p set: 0.44700896739959717
loss_pred:0.014545423910021782, decouple_loss:0.0012686647241935134
loss_pred:0.014935318380594254, decouple_loss:0.0012519587762653828loss_pred:0.014770413748919964, decouple_loss:0.001460874336771667
Iteration: 1412, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446501761674881, gen p mean: -0.06597098708152771, mean p set: 0.44698208570480347
The modified gen p mean: 0.44590476155281067, gen p mean: -0.06469893455505371, mean p set: 0.44638508558273315
loss_pred:0.015050830319523811, decouple_loss:0.001435111160390079
loss_pred:0.014584696851670742, decouple_loss:0.0013491284335032105
The modified gen p mean: 0.4459882080554962, gen p mean: -0.0681016817688942, mean p set: 0.4464685022830963
loss_pred:0.014818064868450165, decouple_loss:0.0012711751041933894
Iteration: 1413, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4458150565624237, gen p mean: -0.05993553623557091, mean p set: 0.4462953209877014
The modified gen p mean: 0.44695645570755005, gen p mean: -0.06517644226551056, mean p set: 0.44743674993515015
loss_pred:0.01419832743704319, decouple_loss:0.0013136869529262185
loss_pred:0.014501212164759636, decouple_loss:0.0014535258524119854
The modified gen p mean: 0.44611862301826477, gen p mean: -0.06232428923249245, mean p set: 0.44659891724586487
loss_pred:0.014562586322426796, decouple_loss:0.001382369315251708
Iteration: 1414, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4456627666950226, gen p mean: -0.05873633921146393, mean p set: 0.4461430609226227
The modified gen p mean: 0.44624581933021545, gen p mean: -0.05927196890115738, mean p set: 0.44672611355781555
loss_pred:0.014579559676349163, decouple_loss:0.0014210683293640614
loss_pred:0.014500314369797707, decouple_loss:0.0015026959590613842
The modified gen p mean: 0.4474700093269348, gen p mean: -0.059378933161497116, mean p set: 0.4479503035545349
loss_pred:0.013639096170663834, decouple_loss:0.0013406825019046664
Iteration: 1415, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469921588897705, gen p mean: -0.0608702190220356, mean p set: 0.4474724233150482
The modified gen p mean: 0.4478497803211212, gen p mean: -0.05893116071820259, mean p set: 0.4483300447463989
loss_pred:0.014432625845074654, decouple_loss:0.0014242868637666106
loss_pred:0.014553755521774292, decouple_loss:0.0015708418795838952
The modified gen p mean: 0.44697436690330505, gen p mean: -0.06046828627586365, mean p set: 0.44745466113090515
loss_pred:0.01424690056592226, decouple_loss:0.0013734917156398296
Iteration: 1416, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44771623611450195, gen p mean: -0.053891658782958984, mean p set: 0.44819650053977966
loss_pred:0.013785541988909245, decouple_loss:0.0013283789157867432
The modified gen p mean: 0.4472000300884247, gen p mean: -0.054356422275304794, mean p set: 0.44768035411834717The modified gen p mean: 0.4474562704563141, gen p mean: -0.05390491336584091, mean p set: 0.4479365348815918
loss_pred:0.013816270977258682, decouple_loss:0.0014665228081867099
loss_pred:0.0145202511921525, decouple_loss:0.0013908140826970339
Iteration: 1417, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44668832421302795, gen p mean: -0.05608467012643814, mean p set: 0.44716861844062805
loss_pred:0.01396098267287016, decouple_loss:0.001269334927201271
The modified gen p mean: 0.4464870095252991, gen p mean: -0.05835210159420967, mean p set: 0.44696730375289917The modified gen p mean: 0.447532594203949, gen p mean: -0.05863647535443306, mean p set: 0.4480128884315491
loss_pred:0.013951527886092663, decouple_loss:0.001312894280999899
loss_pred:0.015141002833843231, decouple_loss:0.0013471330748870969
Iteration: 1418, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467817544937134, gen p mean: -0.058903031051158905, mean p set: 0.44726207852363586
loss_pred:0.014385495334863663, decouple_loss:0.0013529404532164335
The modified gen p mean: 0.44607841968536377, gen p mean: -0.05693608522415161, mean p set: 0.4465586841106415
The modified gen p mean: 0.44704368710517883, gen p mean: -0.058879703283309937, mean p set: 0.44752398133277893
loss_pred:0.014548606239259243, decouple_loss:0.00139264774043113
loss_pred:0.014061113819479942, decouple_loss:0.001368612633086741
Iteration: 1419, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4463846683502197, gen p mean: -0.053813353180885315, mean p set: 0.4468649923801422
loss_pred:0.014392245560884476, decouple_loss:0.0012164113577455282
The modified gen p mean: 0.4462282955646515, gen p mean: -0.05219554901123047, mean p set: 0.446708619594574The modified gen p mean: 0.4463469684123993, gen p mean: -0.05619420111179352, mean p set: 0.4468272626399994
loss_pred:0.01453419215977192, decouple_loss:0.0012858748668804765
loss_pred:0.014000315219163895, decouple_loss:0.0014275003923103213
Iteration: 1420, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44677552580833435, gen p mean: -0.05621366202831268, mean p set: 0.44725584983825684
loss_pred:0.013945258222520351, decouple_loss:0.00141999963670969
The modified gen p mean: 0.4473629295825958, gen p mean: -0.05804435908794403, mean p set: 0.4478432536125183The modified gen p mean: 0.4472186267375946, gen p mean: -0.05382557585835457, mean p set: 0.4476989209651947
loss_pred:0.014241693541407585, decouple_loss:0.0012377873063087463
loss_pred:0.014252264983952045, decouple_loss:0.0012503491016104817
2023-05-02 08:01:32 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.05438801273703575, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.05015043914318085, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.05061762407422066, mean p set: 0.4500633478164673
loss_pred:0.01901162602007389, decouple_loss:0.0014190145302563906
loss_pred:0.01800527609884739, decouple_loss:0.0013940413482487202
loss_pred:0.018017902970314026, decouple_loss:0.0013086316175758839
WV_0_PC_1_EH_0_PS_40, loss: 0.01841362938284874, avg_mse: 0.02675519697368145
current test mse: 0.026755
Iteration: 1421, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44697561860084534, gen p mean: -0.04893960803747177, mean p set: 0.44745591282844543
The modified gen p mean: 0.4455908238887787, gen p mean: -0.04947569966316223, mean p set: 0.4460710883140564
The modified gen p mean: 0.44630762934684753, gen p mean: -0.051018133759498596, mean p set: 0.44678789377212524
loss_pred:0.0134589159861207, decouple_loss:0.0012316269567236304
loss_pred:0.014271922409534454, decouple_loss:0.001267803949303925
loss_pred:0.013865982182323933, decouple_loss:0.0012119913008064032
Iteration: 1422, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44654765725135803, gen p mean: -0.050550565123558044, mean p set: 0.44702792167663574
The modified gen p mean: 0.4476163685321808, gen p mean: -0.049250125885009766, mean p set: 0.4480966627597809
loss_pred:0.013913349248468876, decouple_loss:0.0012441650032997131
loss_pred:0.014148108661174774, decouple_loss:0.0011865950655192137
The modified gen p mean: 0.44708752632141113, gen p mean: -0.05290418863296509, mean p set: 0.44756782054901123
loss_pred:0.013682067394256592, decouple_loss:0.0012322429101914167
Iteration: 1423, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465055763721466, gen p mean: -0.05336857587099075, mean p set: 0.4469858705997467
loss_pred:0.014048649929463863, decouple_loss:0.0014537493698298931
The modified gen p mean: 0.4465186297893524, gen p mean: -0.05222376063466072, mean p set: 0.4469989240169525The modified gen p mean: 0.44653964042663574, gen p mean: -0.05064655840396881, mean p set: 0.4470199644565582
loss_pred:0.01428349781781435, decouple_loss:0.0012952849501743913
loss_pred:0.013901823200285435, decouple_loss:0.001281239790841937
Iteration: 1424, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470585584640503, gen p mean: -0.051795583218336105, mean p set: 0.4475388824939728
loss_pred:0.013609948568046093, decouple_loss:0.001312929904088378
The modified gen p mean: 0.4474034011363983, gen p mean: -0.05379079654812813, mean p set: 0.447883665561676The modified gen p mean: 0.4472411274909973, gen p mean: -0.05922788009047508, mean p set: 0.4477214217185974
loss_pred:0.01426334585994482, decouple_loss:0.0013329519424587488
loss_pred:0.0139160780236125, decouple_loss:0.0013065239181742072
Iteration: 1425, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44661709666252136, gen p mean: -0.050548531115055084, mean p set: 0.44709739089012146
loss_pred:0.01422980334609747, decouple_loss:0.0014380139764398336
The modified gen p mean: 0.4475902318954468, gen p mean: -0.05303329974412918, mean p set: 0.4480704963207245The modified gen p mean: 0.4475697875022888, gen p mean: -0.0561811737716198, mean p set: 0.4480500817298889
loss_pred:0.014009960927069187, decouple_loss:0.0017443244578316808
loss_pred:0.013260267674922943, decouple_loss:0.0012466342886909842
Iteration: 1426, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44795098900794983, gen p mean: -0.05497196689248085, mean p set: 0.4484312832355499
loss_pred:0.013970627449452877, decouple_loss:0.0012706334237009287
The modified gen p mean: 0.44674399495124817, gen p mean: -0.054570090025663376, mean p set: 0.44722431898117065The modified gen p mean: 0.44626617431640625, gen p mean: -0.05075892433524132, mean p set: 0.44674646854400635
loss_pred:0.01395444106310606, decouple_loss:0.0013692006468772888
loss_pred:0.013451873324811459, decouple_loss:0.0010910009732469916
Iteration: 1427, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44773462414741516, gen p mean: -0.049073901027441025, mean p set: 0.44821488857269287
loss_pred:0.01395435445010662, decouple_loss:0.0011828138958662748
The modified gen p mean: 0.44701576232910156, gen p mean: -0.053682148456573486, mean p set: 0.44749605655670166The modified gen p mean: 0.4466501772403717, gen p mean: -0.054247625172138214, mean p set: 0.4471304714679718
loss_pred:0.013646426610648632, decouple_loss:0.001265955506823957
loss_pred:0.013976309448480606, decouple_loss:0.0012705785920843482
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012018_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012018_3_24hr.npz
NaN value num: 0
Iteration: 1428, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45096904039382935, gen p mean: -0.0433841198682785, mean p set: 0.45144933462142944
loss_pred:0.016566595062613487, decouple_loss:0.001535095740109682
The modified gen p mean: 0.4495902359485626, gen p mean: -0.044448915868997574, mean p set: 0.4500705301761627The modified gen p mean: 0.44973820447921753, gen p mean: -0.050975650548934937, mean p set: 0.4502184987068176
loss_pred:0.01756402477622032, decouple_loss:0.0013704205630347133
loss_pred:0.01796848513185978, decouple_loss:0.0013223171699792147
Iteration: 1429, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499695599079132, gen p mean: -0.051073767244815826, mean p set: 0.4504498541355133
loss_pred:0.01822500117123127, decouple_loss:0.001280899508856237
The modified gen p mean: 0.4520878493785858, gen p mean: -0.04673435539007187, mean p set: 0.4525681734085083The modified gen p mean: 0.44996291399002075, gen p mean: -0.04824210703372955, mean p set: 0.45044317841529846
loss_pred:0.01730000227689743, decouple_loss:0.001386188087053597
loss_pred:0.01750386878848076, decouple_loss:0.0013272501528263092
Iteration: 1430, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4521706998348236, gen p mean: -0.050084520131349564, mean p set: 0.4526509940624237
loss_pred:0.018458835780620575, decouple_loss:0.0012432427611202002
The modified gen p mean: 0.45389434695243835, gen p mean: -0.045714087784290314, mean p set: 0.45437467098236084The modified gen p mean: 0.45219242572784424, gen p mean: -0.0488416813313961, mean p set: 0.45267269015312195
loss_pred:0.01676642894744873, decouple_loss:0.0012268986320123076
loss_pred:0.01654389128088951, decouple_loss:0.001183779095299542
2023-05-02 08:03:59 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.05871869623661041, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.054588522762060165, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.0551147386431694, mean p set: 0.4500633478164673
loss_pred:0.018523644655942917, decouple_loss:0.0017280899919569492
loss_pred:0.01750265434384346, decouple_loss:0.0014539227122440934
loss_pred:0.01759360171854496, decouple_loss:0.0014995152596384287
WV_0_PC_1_EH_0_PS_40, loss: 0.017951324582099915, avg_mse: 0.02584869973361492
current test mse: 0.025849
Iteration: 1431, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4522593319416046, gen p mean: -0.04919041693210602, mean p set: 0.4527396559715271
The modified gen p mean: 0.4518769085407257, gen p mean: -0.04589847847819328, mean p set: 0.4523571729660034
The modified gen p mean: 0.4535161852836609, gen p mean: -0.048051025718450546, mean p set: 0.453996479511261
loss_pred:0.016546154394745827, decouple_loss:0.0012472817907109857
loss_pred:0.01688576489686966, decouple_loss:0.0012864674208685756
loss_pred:0.01658996194601059, decouple_loss:0.0013824914349243045
Iteration: 1432, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500679075717926, gen p mean: -0.049919355660676956, mean p set: 0.4505482017993927
The modified gen p mean: 0.45372727513313293, gen p mean: -0.04585915803909302, mean p set: 0.45420756936073303
loss_pred:0.017207717522978783, decouple_loss:0.0013626997824758291
loss_pred:0.016902482137084007, decouple_loss:0.0012664094101637602
The modified gen p mean: 0.4523758292198181, gen p mean: -0.04818606749176979, mean p set: 0.4528560936450958
loss_pred:0.017062921077013016, decouple_loss:0.0013226678129285574
Iteration: 1433, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4522046744823456, gen p mean: -0.044770438224077225, mean p set: 0.4526849389076233
loss_pred:0.01706599071621895, decouple_loss:0.0012869688216596842
The modified gen p mean: 0.4526808559894562, gen p mean: -0.04800117015838623, mean p set: 0.4531611502170563The modified gen p mean: 0.45253220200538635, gen p mean: -0.04942714422941208, mean p set: 0.45301249623298645
loss_pred:0.016750315204262733, decouple_loss:0.001281375763937831
loss_pred:0.017311805859208107, decouple_loss:0.0012294957414269447
Iteration: 1434, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511641561985016, gen p mean: -0.04887596517801285, mean p set: 0.4516444504261017
The modified gen p mean: 0.45075225830078125, gen p mean: -0.048558156937360764, mean p set: 0.45123252272605896
loss_pred:0.01776232197880745, decouple_loss:0.001240790355950594
loss_pred:0.017434678971767426, decouple_loss:0.0012940749293193221
The modified gen p mean: 0.45085394382476807, gen p mean: -0.04904899373650551, mean p set: 0.45133426785469055
loss_pred:0.01749930903315544, decouple_loss:0.001184085733257234
Iteration: 1435, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45037972927093506, gen p mean: -0.05225569009780884, mean p set: 0.45086002349853516
loss_pred:0.01744746044278145, decouple_loss:0.0012828101171180606
The modified gen p mean: 0.45031094551086426, gen p mean: -0.05365201458334923, mean p set: 0.45079126954078674The modified gen p mean: 0.452505886554718, gen p mean: -0.047784317284822464, mean p set: 0.4529861509799957
loss_pred:0.01701469160616398, decouple_loss:0.0012574156280606985
loss_pred:0.016488593071699142, decouple_loss:0.0012964963680133224
Iteration: 1436, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499722421169281, gen p mean: -0.05009308457374573, mean p set: 0.4504525363445282
loss_pred:0.017209038138389587, decouple_loss:0.0012229328276589513
The modified gen p mean: 0.4502183198928833, gen p mean: -0.048021771013736725, mean p set: 0.4506986141204834
The modified gen p mean: 0.4519071877002716, gen p mean: -0.04264775663614273, mean p set: 0.4523874819278717
loss_pred:0.017375603318214417, decouple_loss:0.0012465097242966294
loss_pred:0.016164546832442284, decouple_loss:0.0012676946353167295
Iteration: 1437, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45092833042144775, gen p mean: -0.05018175393342972, mean p set: 0.45140859484672546
loss_pred:0.01765032298862934, decouple_loss:0.0011725438525900245
The modified gen p mean: 0.4505867660045624, gen p mean: -0.05009576305747032, mean p set: 0.4510670304298401The modified gen p mean: 0.45147353410720825, gen p mean: -0.044611405581235886, mean p set: 0.45195385813713074
loss_pred:0.016599377617239952, decouple_loss:0.0011310006957501173
loss_pred:0.015810539945960045, decouple_loss:0.0011359862983226776
Iteration: 1438, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45085057616233826, gen p mean: -0.04738323763012886, mean p set: 0.45133084058761597
loss_pred:0.016898056492209435, decouple_loss:0.001106897252611816
The modified gen p mean: 0.45030415058135986, gen p mean: -0.05066471919417381, mean p set: 0.45078444480895996The modified gen p mean: 0.4506599009037018, gen p mean: -0.04717639833688736, mean p set: 0.4511401653289795
loss_pred:0.017212510108947754, decouple_loss:0.0011094381334260106
loss_pred:0.017007553949952126, decouple_loss:0.0011551297502592206
Iteration: 1439, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504055976867676, gen p mean: -0.05023888126015663, mean p set: 0.4508858919143677
loss_pred:0.017179958522319794, decouple_loss:0.0010999244404956698
The modified gen p mean: 0.4500938355922699, gen p mean: -0.0486031211912632, mean p set: 0.4505741000175476
The modified gen p mean: 0.4508111774921417, gen p mean: -0.04296489432454109, mean p set: 0.4512914717197418
loss_pred:0.01763327606022358, decouple_loss:0.0011386936530470848
loss_pred:0.016559336334466934, decouple_loss:0.0012227145489305258
Iteration: 1440, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505920112133026, gen p mean: -0.04768854007124901, mean p set: 0.4510722756385803
loss_pred:0.017482172697782516, decouple_loss:0.0014090078184381127
The modified gen p mean: 0.45059317350387573, gen p mean: -0.05104460567235947, mean p set: 0.45107343792915344
The modified gen p mean: 0.4505715072154999, gen p mean: -0.05201641842722893, mean p set: 0.45105183124542236
loss_pred:0.016813764348626137, decouple_loss:0.0012599783949553967
loss_pred:0.017813049256801605, decouple_loss:0.0011688674567267299
2023-05-02 08:05:54 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.06134722754359245, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.057337742298841476, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.05736563727259636, mean p set: 0.4500633478164673
loss_pred:0.01836489886045456, decouple_loss:0.0014708818634971976
loss_pred:0.01731528900563717, decouple_loss:0.001253663096576929
loss_pred:0.01739320158958435, decouple_loss:0.0013165329582989216
WV_0_PC_1_EH_0_PS_40, loss: 0.017758481204509735, avg_mse: 0.025471685454249382
current test mse: 0.025472
Iteration: 1441, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45123785734176636, gen p mean: -0.05133569985628128, mean p set: 0.45171812176704407
The modified gen p mean: 0.45068255066871643, gen p mean: -0.0532679446041584, mean p set: 0.45116284489631653
The modified gen p mean: 0.45101141929626465, gen p mean: -0.04932305961847305, mean p set: 0.45149174332618713
loss_pred:0.01646326668560505, decouple_loss:0.0012283902615308762
loss_pred:0.01763552986085415, decouple_loss:0.0011131975334137678
loss_pred:0.0171087384223938, decouple_loss:0.0011733316350728273
Iteration: 1442, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501114785671234, gen p mean: -0.05753549933433533, mean p set: 0.4505917727947235
The modified gen p mean: 0.4515415132045746, gen p mean: -0.05173270404338837, mean p set: 0.4520217776298523
loss_pred:0.016503794118762016, decouple_loss:0.0011571777286008
loss_pred:0.01616411656141281, decouple_loss:0.0013143087271600962
The modified gen p mean: 0.4502878189086914, gen p mean: -0.05774257704615593, mean p set: 0.4507681429386139
loss_pred:0.01673957332968712, decouple_loss:0.0012215911410748959
Iteration: 1443, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45017921924591064, gen p mean: -0.05803485959768295, mean p set: 0.45065951347351074
loss_pred:0.01654661074280739, decouple_loss:0.0012109949020668864
The modified gen p mean: 0.45108628273010254, gen p mean: -0.058066390454769135, mean p set: 0.451566606760025The modified gen p mean: 0.4490162134170532, gen p mean: -0.059477247297763824, mean p set: 0.4494965374469757
loss_pred:0.01795244961977005, decouple_loss:0.0011447372380644083
loss_pred:0.017639758065342903, decouple_loss:0.0011057398514822125
Iteration: 1444, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45093464851379395, gen p mean: -0.05720348283648491, mean p set: 0.45141491293907166
loss_pred:0.017188556492328644, decouple_loss:0.001267721294425428
The modified gen p mean: 0.4508972465991974, gen p mean: -0.060130633413791656, mean p set: 0.4513775408267975The modified gen p mean: 0.45233258605003357, gen p mean: -0.06065795570611954, mean p set: 0.45281288027763367
loss_pred:0.01645057275891304, decouple_loss:0.0011414347682148218
loss_pred:0.017938973382115364, decouple_loss:0.0011413689935579896
Iteration: 1445, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4522205889225006, gen p mean: -0.05815544351935387, mean p set: 0.4527009129524231
loss_pred:0.016142886132001877, decouple_loss:0.0011206787312403321
The modified gen p mean: 0.45046618580818176, gen p mean: -0.054129645228385925, mean p set: 0.4509464502334595
The modified gen p mean: 0.45007598400115967, gen p mean: -0.060291264206171036, mean p set: 0.45055627822875977
loss_pred:0.016384556889533997, decouple_loss:0.001270875334739685
loss_pred:0.01707134209573269, decouple_loss:0.0011958739487454295
Iteration: 1446, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4521578848361969, gen p mean: -0.05752092972397804, mean p set: 0.452638179063797
loss_pred:0.01712670922279358, decouple_loss:0.0011510156327858567
The modified gen p mean: 0.44997653365135193, gen p mean: -0.06035022810101509, mean p set: 0.450456827878952The modified gen p mean: 0.4502720534801483, gen p mean: -0.06243542209267616, mean p set: 0.450752317905426
loss_pred:0.017718547955155373, decouple_loss:0.00103985785972327
loss_pred:0.016245609149336815, decouple_loss:0.0010679191909730434
Iteration: 1447, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45066073536872864, gen p mean: -0.05760625749826431, mean p set: 0.45114099979400635
loss_pred:0.01684817671775818, decouple_loss:0.0011148222256451845
The modified gen p mean: 0.4499717652797699, gen p mean: -0.05816929042339325, mean p set: 0.45045205950737The modified gen p mean: 0.4501606523990631, gen p mean: -0.056309256702661514, mean p set: 0.4506409764289856
loss_pred:0.01711062341928482, decouple_loss:0.001174638164229691
loss_pred:0.01674792729318142, decouple_loss:0.001125606126151979
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012018_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012018_3_24hr.npz
NaN value num: 0
Iteration: 1448, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514514207839966, gen p mean: -0.05535100772976875, mean p set: 0.4519317150115967
loss_pred:0.018211709335446358, decouple_loss:0.0011272573610767722
The modified gen p mean: 0.4515368342399597, gen p mean: -0.05000835657119751, mean p set: 0.4520170986652374The modified gen p mean: 0.4529380202293396, gen p mean: -0.04954173415899277, mean p set: 0.4534182846546173
loss_pred:0.018182186409831047, decouple_loss:0.0012020119465887547
loss_pred:0.017458410933613777, decouple_loss:0.0010980714578181505
Iteration: 1449, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495961666107178, gen p mean: -0.051433395594358444, mean p set: 0.4500764310359955
loss_pred:0.016545945778489113, decouple_loss:0.0011695829452946782
The modified gen p mean: 0.45113590359687805, gen p mean: -0.04977048560976982, mean p set: 0.45161619782447815The modified gen p mean: 0.45329105854034424, gen p mean: -0.05430217832326889, mean p set: 0.4537713825702667
loss_pred:0.01751510053873062, decouple_loss:0.0010828013764694333
loss_pred:0.017162514850497246, decouple_loss:0.0011316511081531644
Iteration: 1450, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45042169094085693, gen p mean: -0.05556628853082657, mean p set: 0.45090195536613464
The modified gen p mean: 0.4527312219142914, gen p mean: -0.05114450305700302, mean p set: 0.4532114863395691
loss_pred:0.016442179679870605, decouple_loss:0.001162304193712771
loss_pred:0.016912374645471573, decouple_loss:0.0011470301542431116
The modified gen p mean: 0.45099908113479614, gen p mean: -0.05591794103384018, mean p set: 0.45147937536239624
loss_pred:0.016192732378840446, decouple_loss:0.0011703561758622527
2023-05-02 08:08:26 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.06273497641086578, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.05883113667368889, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.05895264074206352, mean p set: 0.4500633478164673
loss_pred:0.018381068482995033, decouple_loss:0.001379102119244635
loss_pred:0.017292730510234833, decouple_loss:0.0014260713942348957
loss_pred:0.01734837330877781, decouple_loss:0.0013157891808077693
WV_0_PC_1_EH_0_PS_40, loss: 0.017742741852998734, avg_mse: 0.0254475437104702
current test mse: 0.025448
Iteration: 1451, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45320290327072144, gen p mean: -0.05880475044250488, mean p set: 0.4536832273006439
The modified gen p mean: 0.4508812725543976, gen p mean: -0.05335477739572525, mean p set: 0.45136159658432007
The modified gen p mean: 0.45190173387527466, gen p mean: -0.05339302122592926, mean p set: 0.45238202810287476
loss_pred:0.01570582576096058, decouple_loss:0.0011580679565668106
loss_pred:0.016141897067427635, decouple_loss:0.0013854332501068711
loss_pred:0.01635320670902729, decouple_loss:0.0011084137950092554
Iteration: 1452, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45307889580726624, gen p mean: -0.05313555523753166, mean p set: 0.45355919003486633
loss_pred:0.017443297430872917, decouple_loss:0.0012401649728417397
The modified gen p mean: 0.4502507150173187, gen p mean: -0.05501002445816994, mean p set: 0.4507310390472412The modified gen p mean: 0.4506078064441681, gen p mean: -0.05155635252594948, mean p set: 0.4510881304740906
loss_pred:0.016492580994963646, decouple_loss:0.0013144033728167415
loss_pred:0.01641157642006874, decouple_loss:0.001297630020417273
Iteration: 1453, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44963768124580383, gen p mean: -0.05410934239625931, mean p set: 0.45011797547340393
loss_pred:0.015549568459391594, decouple_loss:0.0012707175919786096
The modified gen p mean: 0.4496065676212311, gen p mean: -0.05623447895050049, mean p set: 0.4500868618488312The modified gen p mean: 0.45238861441612244, gen p mean: -0.045111242681741714, mean p set: 0.45286890864372253
loss_pred:0.01856692135334015, decouple_loss:0.001123094349168241
loss_pred:0.015341410413384438, decouple_loss:0.0012923283502459526
Iteration: 1454, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4519538879394531, gen p mean: -0.04718754440546036, mean p set: 0.4524341821670532
The modified gen p mean: 0.45179131627082825, gen p mean: -0.040925282984972, mean p set: 0.45227164030075073
loss_pred:0.01607695408165455, decouple_loss:0.0011880171950906515
loss_pred:0.018045566976070404, decouple_loss:0.0012172593269497156
The modified gen p mean: 0.4504154622554779, gen p mean: -0.04466308653354645, mean p set: 0.4508957266807556
loss_pred:0.016089564189314842, decouple_loss:0.0012647033436223865
Iteration: 1455, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.451896607875824, gen p mean: -0.047883011400699615, mean p set: 0.4523768723011017
loss_pred:0.015774430707097054, decouple_loss:0.0011774252634495497
The modified gen p mean: 0.4540480971336365, gen p mean: -0.045483510941267014, mean p set: 0.4545283913612366The modified gen p mean: 0.4541676640510559, gen p mean: -0.04605993628501892, mean p set: 0.454647958278656
loss_pred:0.015697509050369263, decouple_loss:0.001153273624368012
loss_pred:0.01638777367770672, decouple_loss:0.001129720127210021
Iteration: 1456, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501402974128723, gen p mean: -0.04765714704990387, mean p set: 0.4506206214427948
loss_pred:0.015355022624135017, decouple_loss:0.0014116655802354217
The modified gen p mean: 0.4533970057964325, gen p mean: -0.042819391936063766, mean p set: 0.4538773000240326The modified gen p mean: 0.4523985683917999, gen p mean: -0.04572215676307678, mean p set: 0.45287883281707764
loss_pred:0.018012501299381256, decouple_loss:0.0013316682307049632
loss_pred:0.01563601940870285, decouple_loss:0.0011407677084207535
Iteration: 1457, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4533480405807495, gen p mean: -0.04314053803682327, mean p set: 0.4538283348083496
The modified gen p mean: 0.450214147567749, gen p mean: -0.04894162714481354, mean p set: 0.4506944417953491
loss_pred:0.017293820157647133, decouple_loss:0.0012034213868901134
loss_pred:0.016564728692173958, decouple_loss:0.0012423810549080372
The modified gen p mean: 0.4499393105506897, gen p mean: -0.05030441656708717, mean p set: 0.4504196047782898
loss_pred:0.015223221853375435, decouple_loss:0.0011521243723109365
Iteration: 1458, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4518018662929535, gen p mean: -0.04130582511425018, mean p set: 0.452282190322876
loss_pred:0.016482990235090256, decouple_loss:0.0011833446333184838
The modified gen p mean: 0.454966276884079, gen p mean: -0.047295548021793365, mean p set: 0.45544660091400146The modified gen p mean: 0.45127907395362854, gen p mean: -0.050401076674461365, mean p set: 0.45175933837890625
loss_pred:0.016269363462924957, decouple_loss:0.0011410177685320377
loss_pred:0.01586725562810898, decouple_loss:0.0012349772732704878
Iteration: 1459, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4519626498222351, gen p mean: -0.045121096074581146, mean p set: 0.4524429440498352
loss_pred:0.016223376616835594, decouple_loss:0.0010327292839065194
The modified gen p mean: 0.4505513906478882, gen p mean: -0.05055728182196617, mean p set: 0.4510316848754883The modified gen p mean: 0.45206931233406067, gen p mean: -0.046184342354536057, mean p set: 0.45254963636398315
loss_pred:0.01598244346678257, decouple_loss:0.0010527374688535929
loss_pred:0.017218399792909622, decouple_loss:0.0011687504593282938
Iteration: 1460, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4548651874065399, gen p mean: -0.04859276860952377, mean p set: 0.45534548163414
The modified gen p mean: 0.45375755429267883, gen p mean: -0.048794906586408615, mean p set: 0.4542378783226013
loss_pred:0.015815220773220062, decouple_loss:0.0012408188777044415
loss_pred:0.01673807017505169, decouple_loss:0.001201604725793004
The modified gen p mean: 0.4507195055484772, gen p mean: -0.04597296565771103, mean p set: 0.4511997699737549
loss_pred:0.015883587300777435, decouple_loss:0.0011755323503166437
2023-05-02 08:10:20 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.05818196013569832, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.054556798189878464, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.05431535094976425, mean p set: 0.4500633478164673
loss_pred:0.01839083805680275, decouple_loss:0.0013044275110587478
loss_pred:0.017291415482759476, decouple_loss:0.0012099876767024398
loss_pred:0.01740861125290394, decouple_loss:0.0012524956837296486
WV_0_PC_1_EH_0_PS_40, loss: 0.017759736627340317, avg_mse: 0.0255124568939209
current test mse: 0.025512
Iteration: 1461, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4531858265399933, gen p mean: -0.04568055644631386, mean p set: 0.45366615056991577
The modified gen p mean: 0.4514559805393219, gen p mean: -0.05025045946240425, mean p set: 0.451936274766922
The modified gen p mean: 0.4529207944869995, gen p mean: -0.04957415908575058, mean p set: 0.4534010887145996
loss_pred:0.016540994867682457, decouple_loss:0.001245655003003776
loss_pred:0.01798069477081299, decouple_loss:0.0012912913225591183
loss_pred:0.01702709123492241, decouple_loss:0.0011969521874561906
Iteration: 1462, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4521179795265198, gen p mean: -0.0434180311858654, mean p set: 0.45259830355644226
loss_pred:0.01684664748609066, decouple_loss:0.0010702008148655295
The modified gen p mean: 0.4521256983280182, gen p mean: -0.05032096803188324, mean p set: 0.4526059925556183The modified gen p mean: 0.4521728754043579, gen p mean: -0.04984039440751076, mean p set: 0.452653169631958
loss_pred:0.017335163429379463, decouple_loss:0.0010889440309256315
loss_pred:0.01748865656554699, decouple_loss:0.0012066883500665426
Iteration: 1463, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45315924286842346, gen p mean: -0.05212223529815674, mean p set: 0.45363950729370117
loss_pred:0.016973040997982025, decouple_loss:0.0013483291259035468
The modified gen p mean: 0.45300745964050293, gen p mean: -0.04853764921426773, mean p set: 0.453487753868103The modified gen p mean: 0.45120471715927124, gen p mean: -0.04554741829633713, mean p set: 0.45168498158454895
loss_pred:0.017188027501106262, decouple_loss:0.0012903213500976562
loss_pred:0.01668526977300644, decouple_loss:0.0013292038347572088
Iteration: 1464, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4525775909423828, gen p mean: -0.04973263666033745, mean p set: 0.4530578553676605
loss_pred:0.01765231415629387, decouple_loss:0.0012750116875395179
The modified gen p mean: 0.45349952578544617, gen p mean: -0.05081316456198692, mean p set: 0.45397984981536865The modified gen p mean: 0.4530724287033081, gen p mean: -0.05287385731935501, mean p set: 0.4535527229309082
loss_pred:0.015418510884046555, decouple_loss:0.0010980929946526885
loss_pred:0.017594465985894203, decouple_loss:0.0013107392005622387
Iteration: 1465, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4530890882015228, gen p mean: -0.05407671630382538, mean p set: 0.4535693824291229
loss_pred:0.016399074345827103, decouple_loss:0.001101997564546764
The modified gen p mean: 0.45374709367752075, gen p mean: -0.05222928151488304, mean p set: 0.45422741770744324The modified gen p mean: 0.4508505165576935, gen p mean: -0.04931769147515297, mean p set: 0.4513308107852936
loss_pred:0.01641094498336315, decouple_loss:0.0012234452879056334
loss_pred:0.016335243359208107, decouple_loss:0.0010947524569928646
Iteration: 1466, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498823881149292, gen p mean: -0.05366150662302971, mean p set: 0.4503626525402069
loss_pred:0.01593383401632309, decouple_loss:0.0012786152074113488
The modified gen p mean: 0.452873170375824, gen p mean: -0.054149143397808075, mean p set: 0.4533534646034241The modified gen p mean: 0.4504041075706482, gen p mean: -0.05552283674478531, mean p set: 0.4508844316005707
loss_pred:0.01682436652481556, decouple_loss:0.0010754861868917942
loss_pred:0.015680991113185883, decouple_loss:0.0011764232767745852
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012011_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012011_3_24hr.npz
NaN value num: 0
Iteration: 1467, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4519166648387909, gen p mean: -0.05004258081316948, mean p set: 0.4523969888687134
loss_pred:0.016700251027941704, decouple_loss:0.0013591963797807693
The modified gen p mean: 0.45133957266807556, gen p mean: -0.052042633295059204, mean p set: 0.45181983709335327The modified gen p mean: 0.4526183307170868, gen p mean: -0.05264139920473099, mean p set: 0.4530986547470093
loss_pred:0.01613248512148857, decouple_loss:0.0017087344313040376
loss_pred:0.017142310738563538, decouple_loss:0.0014842527452856302
Iteration: 1468, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4506340026855469, gen p mean: -0.04627758637070656, mean p set: 0.451114296913147
loss_pred:0.016902346163988113, decouple_loss:0.0012393576325848699
The modified gen p mean: 0.4532608687877655, gen p mean: -0.046399205923080444, mean p set: 0.453741192817688The modified gen p mean: 0.45192664861679077, gen p mean: -0.04469114542007446, mean p set: 0.45240697264671326
loss_pred:0.015980791300535202, decouple_loss:0.0012650692369788885
loss_pred:0.016724349930882454, decouple_loss:0.0013553873868659139
Iteration: 1469, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45208415389060974, gen p mean: -0.04281684011220932, mean p set: 0.45256444811820984
loss_pred:0.01634647697210312, decouple_loss:0.0011835190234705806
The modified gen p mean: 0.4521663784980774, gen p mean: -0.04343445599079132, mean p set: 0.4526466727256775The modified gen p mean: 0.4521476924419403, gen p mean: -0.047270290553569794, mean p set: 0.4526279866695404
loss_pred:0.0169826652854681, decouple_loss:0.0012755334610119462
loss_pred:0.017449261620640755, decouple_loss:0.0012780072866007686
Iteration: 1470, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513983428478241, gen p mean: -0.048951443284749985, mean p set: 0.4518786072731018
loss_pred:0.016834460198879242, decouple_loss:0.0012692982563748956
The modified gen p mean: 0.45150282979011536, gen p mean: -0.04762391746044159, mean p set: 0.45198309421539307The modified gen p mean: 0.4517366290092468, gen p mean: -0.043756965547800064, mean p set: 0.4522169232368469
loss_pred:0.016764875501394272, decouple_loss:0.0012741809478029609
loss_pred:0.01661333255469799, decouple_loss:0.0012023230083286762
2023-05-02 08:12:49 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.05546196177601814, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.051633503288030624, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.051714230328798294, mean p set: 0.4500633478164673
loss_pred:0.01835370436310768, decouple_loss:0.001306511927396059
loss_pred:0.017276708036661148, decouple_loss:0.0011640728916972876
loss_pred:0.017427098006010056, decouple_loss:0.0012733029434457421
WV_0_PC_1_EH_0_PS_40, loss: 0.017748236656188965, avg_mse: 0.025477133691310883
current test mse: 0.025477
Iteration: 1471, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4533820152282715, gen p mean: -0.0468757338821888, mean p set: 0.4538623094558716
The modified gen p mean: 0.4524117708206177, gen p mean: -0.04340006411075592, mean p set: 0.4528920352458954
The modified gen p mean: 0.45180779695510864, gen p mean: -0.046641428023576736, mean p set: 0.45228806138038635
loss_pred:0.016356635838747025, decouple_loss:0.001276130205951631
loss_pred:0.01690547913312912, decouple_loss:0.0012881708098575473
loss_pred:0.016921391710639, decouple_loss:0.0012606839882209897
Iteration: 1472, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4523658752441406, gen p mean: -0.04175205156207085, mean p set: 0.4528461992740631
loss_pred:0.01656036078929901, decouple_loss:0.0013392389519140124
The modified gen p mean: 0.4510209262371063, gen p mean: -0.040281668305397034, mean p set: 0.45150119066238403The modified gen p mean: 0.4520944654941559, gen p mean: -0.04425325617194176, mean p set: 0.452574759721756
loss_pred:0.016556518152356148, decouple_loss:0.0014861664967611432
loss_pred:0.017205899581313133, decouple_loss:0.001523505081422627
Iteration: 1473, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4532967507839203, gen p mean: -0.05181470140814781, mean p set: 0.453777015209198
loss_pred:0.016262762248516083, decouple_loss:0.0013358811847865582
The modified gen p mean: 0.450969934463501, gen p mean: -0.04147939756512642, mean p set: 0.45145025849342346The modified gen p mean: 0.4526510536670685, gen p mean: -0.03831261768937111, mean p set: 0.4531313478946686
loss_pred:0.016431346535682678, decouple_loss:0.0013479674234986305
loss_pred:0.01708081364631653, decouple_loss:0.0012813444482162595
Iteration: 1474, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45091700553894043, gen p mean: -0.04321879521012306, mean p set: 0.4513972997665405
loss_pred:0.01650332659482956, decouple_loss:0.0011738735483959317
The modified gen p mean: 0.4520457088947296, gen p mean: -0.04222123697400093, mean p set: 0.4525260329246521The modified gen p mean: 0.4526793360710144, gen p mean: -0.04802606999874115, mean p set: 0.4531596302986145
loss_pred:0.016291173174977303, decouple_loss:0.001280889380723238
loss_pred:0.01700354926288128, decouple_loss:0.001130306045524776
Iteration: 1475, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45338529348373413, gen p mean: -0.03846453130245209, mean p set: 0.45386558771133423
loss_pred:0.015834107995033264, decouple_loss:0.0011525243753567338
The modified gen p mean: 0.4512045383453369, gen p mean: -0.04342476651072502, mean p set: 0.4516848623752594The modified gen p mean: 0.4518676698207855, gen p mean: -0.04211065173149109, mean p set: 0.4523479640483856
loss_pred:0.016173390671610832, decouple_loss:0.0011678158771246672
loss_pred:0.016530415043234825, decouple_loss:0.0011405976256355643
Iteration: 1476, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503568708896637, gen p mean: -0.0354054793715477, mean p set: 0.4508371949195862
loss_pred:0.016776075586676598, decouple_loss:0.0010529729770496488
The modified gen p mean: 0.45086798071861267, gen p mean: -0.03642122074961662, mean p set: 0.4513482451438904The modified gen p mean: 0.45314139127731323, gen p mean: -0.03635630011558533, mean p set: 0.45362168550491333
loss_pred:0.016322847455739975, decouple_loss:0.0010928809642791748
loss_pred:0.015603451058268547, decouple_loss:0.0011317454045638442
Iteration: 1477, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45173466205596924, gen p mean: -0.03764864802360535, mean p set: 0.45221495628356934
loss_pred:0.016607001423835754, decouple_loss:0.0011919339885935187
The modified gen p mean: 0.45147210359573364, gen p mean: -0.03841061890125275, mean p set: 0.45195239782333374The modified gen p mean: 0.45155203342437744, gen p mean: -0.03399116173386574, mean p set: 0.45203232765197754
loss_pred:0.016719279810786247, decouple_loss:0.0011177763808518648
loss_pred:0.016776192933321, decouple_loss:0.0012441975995898247
Iteration: 1478, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45193371176719666, gen p mean: -0.030970802530646324, mean p set: 0.45241400599479675
loss_pred:0.016395360231399536, decouple_loss:0.0011116801761090755
The modified gen p mean: 0.45355185866355896, gen p mean: -0.03291691094636917, mean p set: 0.45403215289115906The modified gen p mean: 0.4521658420562744, gen p mean: -0.035116855055093765, mean p set: 0.4526461064815521
loss_pred:0.015730662271380424, decouple_loss:0.001037726877257228
loss_pred:0.016601134091615677, decouple_loss:0.0011612990638241172
Iteration: 1479, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4515134394168854, gen p mean: -0.035592611879110336, mean p set: 0.4519937038421631
The modified gen p mean: 0.4532409608364105, gen p mean: -0.04473939538002014, mean p set: 0.4537212550640106
loss_pred:0.016216516494750977, decouple_loss:0.0010256300447508693
loss_pred:0.016303222626447678, decouple_loss:0.0010915922466665506
The modified gen p mean: 0.45242398977279663, gen p mean: -0.03596063330769539, mean p set: 0.4529043138027191
loss_pred:0.01603694073855877, decouple_loss:0.001098179374821484
Iteration: 1480, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45241695642471313, gen p mean: -0.034617189317941666, mean p set: 0.45289722084999084
The modified gen p mean: 0.4522055387496948, gen p mean: -0.03517365828156471, mean p set: 0.4526858329772949
loss_pred:0.01623358018696308, decouple_loss:0.0013336234260350466
loss_pred:0.01647329144179821, decouple_loss:0.0012608887627720833
The modified gen p mean: 0.4512758255004883, gen p mean: -0.042732156813144684, mean p set: 0.4517561197280884
loss_pred:0.016646435484290123, decouple_loss:0.001350385951809585
2023-05-02 08:14:42 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.04881211370229721, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.045206885784864426, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04545002803206444, mean p set: 0.4500633478164673
loss_pred:0.018335092812776566, decouple_loss:0.0011963826837018132
loss_pred:0.017257049679756165, decouple_loss:0.0011311352718621492
loss_pred:0.01740986667573452, decouple_loss:0.0011491298209875822
WV_0_PC_1_EH_0_PS_40, loss: 0.017725281417369843, avg_mse: 0.02546457014977932
current test mse: 0.025465
Iteration: 1481, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45310261845588684, gen p mean: -0.038666825741529465, mean p set: 0.45358291268348694
The modified gen p mean: 0.4506920278072357, gen p mean: -0.03901585564017296, mean p set: 0.4511723518371582
The modified gen p mean: 0.45239338278770447, gen p mean: -0.04286060482263565, mean p set: 0.45287367701530457
loss_pred:0.016114305704832077, decouple_loss:0.0011019441299140453
loss_pred:0.015544898808002472, decouple_loss:0.0010197549127042294
loss_pred:0.01696806773543358, decouple_loss:0.0010754287941381335
Iteration: 1482, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4535418748855591, gen p mean: -0.036615028977394104, mean p set: 0.4540221691131592
loss_pred:0.01568564772605896, decouple_loss:0.0012793006608262658
The modified gen p mean: 0.4507414400577545, gen p mean: -0.04129721596837044, mean p set: 0.4512217342853546The modified gen p mean: 0.45258283615112305, gen p mean: -0.03911306709051132, mean p set: 0.45306316018104553
loss_pred:0.016335804015398026, decouple_loss:0.0011221814202144742
loss_pred:0.016525045037269592, decouple_loss:0.001415997976437211
Iteration: 1483, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45180609822273254, gen p mean: -0.04068945720791817, mean p set: 0.45228642225265503
loss_pred:0.01639610528945923, decouple_loss:0.0010581696406006813
The modified gen p mean: 0.4514908492565155, gen p mean: -0.045539114624261856, mean p set: 0.4519711136817932The modified gen p mean: 0.4520377218723297, gen p mean: -0.03830600902438164, mean p set: 0.4525179862976074
loss_pred:0.01590918004512787, decouple_loss:0.001016763155348599
loss_pred:0.016980411484837532, decouple_loss:0.0010931186843663454
Iteration: 1484, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45345133543014526, gen p mean: -0.05024632811546326, mean p set: 0.45393162965774536
loss_pred:0.016616985201835632, decouple_loss:0.0011115215020254254
The modified gen p mean: 0.4512392580509186, gen p mean: -0.04279002547264099, mean p set: 0.45171958208084106The modified gen p mean: 0.4527105689048767, gen p mean: -0.04079432040452957, mean p set: 0.4531908929347992
loss_pred:0.016180699691176414, decouple_loss:0.0011247923830524087
loss_pred:0.015828311443328857, decouple_loss:0.001050088438205421
Iteration: 1485, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4518750011920929, gen p mean: -0.0409531369805336, mean p set: 0.452355295419693
loss_pred:0.01631392352283001, decouple_loss:0.001122232642956078
The modified gen p mean: 0.45124927163124084, gen p mean: -0.03825864568352699, mean p set: 0.45172953605651855The modified gen p mean: 0.4527018964290619, gen p mean: -0.05382542312145233, mean p set: 0.4531821608543396
loss_pred:0.015996186062693596, decouple_loss:0.0010809066006913781
loss_pred:0.015797115862369537, decouple_loss:0.0010544160613790154
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012004_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012004_3_24hr.npz
NaN value num: 0
Iteration: 1486, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473828077316284, gen p mean: -0.05507047846913338, mean p set: 0.4478631317615509
loss_pred:0.014328846707940102, decouple_loss:0.0013930440181866288
The modified gen p mean: 0.44865861535072327, gen p mean: -0.04593542218208313, mean p set: 0.44913890957832336The modified gen p mean: 0.44806262850761414, gen p mean: -0.047854695469141006, mean p set: 0.44854292273521423
loss_pred:0.014633777551352978, decouple_loss:0.0012818184914067388
loss_pred:0.01468336395919323, decouple_loss:0.0011829748982563615
Iteration: 1487, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44786959886550903, gen p mean: -0.06151881068944931, mean p set: 0.4483499228954315
loss_pred:0.014522269368171692, decouple_loss:0.001183860469609499
The modified gen p mean: 0.4487585425376892, gen p mean: -0.0586378239095211, mean p set: 0.4492388665676117The modified gen p mean: 0.4508858025074005, gen p mean: -0.059111740440130234, mean p set: 0.4513660967350006
loss_pred:0.01422919612377882, decouple_loss:0.0011547133326530457
loss_pred:0.014902151189744473, decouple_loss:0.001199726713821292
Iteration: 1488, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479284882545471, gen p mean: -0.06925801187753677, mean p set: 0.448408842086792
loss_pred:0.01465982012450695, decouple_loss:0.0010832978878170252
The modified gen p mean: 0.45018258690834045, gen p mean: -0.06813980638980865, mean p set: 0.45066288113594055The modified gen p mean: 0.44872063398361206, gen p mean: -0.0608694888651371, mean p set: 0.44920095801353455
loss_pred:0.014194827526807785, decouple_loss:0.0011426970595493913
loss_pred:0.014675337821245193, decouple_loss:0.001091974787414074
Iteration: 1489, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44727641344070435, gen p mean: -0.07677629590034485, mean p set: 0.44775673747062683
loss_pred:0.01379411667585373, decouple_loss:0.0013826863141730428
The modified gen p mean: 0.4481760263442993, gen p mean: -0.0774713009595871, mean p set: 0.4486563205718994The modified gen p mean: 0.4475422203540802, gen p mean: -0.07108359783887863, mean p set: 0.4480225145816803
loss_pred:0.01399629283696413, decouple_loss:0.0012905634939670563
loss_pred:0.01455178577452898, decouple_loss:0.0011938689276576042
Iteration: 1490, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482540488243103, gen p mean: -0.07608296722173691, mean p set: 0.4487343728542328
The modified gen p mean: 0.4481866657733917, gen p mean: -0.07444412261247635, mean p set: 0.44866693019866943loss_pred:0.014823495410382748, decouple_loss:0.001249691704288125
The modified gen p mean: 0.44756534695625305, gen p mean: -0.0776219367980957, mean p set: 0.44804564118385315
loss_pred:0.014209932647645473, decouple_loss:0.001165239023976028
loss_pred:0.013963187113404274, decouple_loss:0.00135279621463269
2023-05-02 08:17:16 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.07756339758634567, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.07296827435493469, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.07368874549865723, mean p set: 0.4500633478164673
loss_pred:0.0188607107847929, decouple_loss:0.0011905600549653172
loss_pred:0.017768701538443565, decouple_loss:0.0012141673360019922
loss_pred:0.01787291280925274, decouple_loss:0.0012098742881789804
WV_0_PC_1_EH_0_PS_40, loss: 0.01822768524289131, avg_mse: 0.02635498344898224
current test mse: 0.026355
Iteration: 1491, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476674795150757, gen p mean: -0.0759265348315239, mean p set: 0.4481477439403534
The modified gen p mean: 0.4487471878528595, gen p mean: -0.06898011267185211, mean p set: 0.4492274820804596
The modified gen p mean: 0.447750449180603, gen p mean: -0.07486642152070999, mean p set: 0.4482307732105255
loss_pred:0.013586853630840778, decouple_loss:0.001099567860364914
loss_pred:0.014301629737019539, decouple_loss:0.0011633980320766568
loss_pred:0.014070199802517891, decouple_loss:0.001136541715823114
Iteration: 1492, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482608735561371, gen p mean: -0.07361354678869247, mean p set: 0.4487411379814148
loss_pred:0.013480590656399727, decouple_loss:0.0012245248071849346
The modified gen p mean: 0.4482864737510681, gen p mean: -0.07404841482639313, mean p set: 0.4487667679786682The modified gen p mean: 0.44871824979782104, gen p mean: -0.0621723048388958, mean p set: 0.44919851422309875
loss_pred:0.014466378837823868, decouple_loss:0.0012066068593412638
loss_pred:0.013859016820788383, decouple_loss:0.0011898244265466928
Iteration: 1493, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44707104563713074, gen p mean: -0.0707448199391365, mean p set: 0.44755133986473083
The modified gen p mean: 0.44837528467178345, gen p mean: -0.05991482362151146, mean p set: 0.44885557889938354
loss_pred:0.013363339006900787, decouple_loss:0.0012314064661040902
loss_pred:0.013963935896754265, decouple_loss:0.0011725013609975576
The modified gen p mean: 0.4481053054332733, gen p mean: -0.06745078414678574, mean p set: 0.4485855996608734
loss_pred:0.01418705377727747, decouple_loss:0.0012760370736941695
Iteration: 1494, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477931559085846, gen p mean: -0.06465527415275574, mean p set: 0.4482734203338623
loss_pred:0.013348233886063099, decouple_loss:0.0011721678311005235
The modified gen p mean: 0.4492338299751282, gen p mean: -0.06443733721971512, mean p set: 0.44971415400505066The modified gen p mean: 0.4483461380004883, gen p mean: -0.06692671775817871, mean p set: 0.4488264322280884
loss_pred:0.013491321355104446, decouple_loss:0.0012317996006458998
loss_pred:0.014150184579193592, decouple_loss:0.001248435932211578
Iteration: 1495, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475911259651184, gen p mean: -0.06067753583192825, mean p set: 0.4480714499950409
loss_pred:0.013280733488500118, decouple_loss:0.0012266651028767228
The modified gen p mean: 0.4483553469181061, gen p mean: -0.055431049317121506, mean p set: 0.44883567094802856The modified gen p mean: 0.4477776288986206, gen p mean: -0.05583947151899338, mean p set: 0.4482579529285431
loss_pred:0.014328207820653915, decouple_loss:0.0012250972213223577
loss_pred:0.014030706137418747, decouple_loss:0.0012067268835380673
Iteration: 1496, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496217966079712, gen p mean: -0.06063525006175041, mean p set: 0.4501021206378937
loss_pred:0.01350032165646553, decouple_loss:0.001300257514230907
The modified gen p mean: 0.4502047300338745, gen p mean: -0.055663060396909714, mean p set: 0.450685054063797The modified gen p mean: 0.44732072949409485, gen p mean: -0.055112361907958984, mean p set: 0.44780102372169495
loss_pred:0.014157983474433422, decouple_loss:0.0012562520569190383
loss_pred:0.014152083545923233, decouple_loss:0.0012036364059895277
Iteration: 1497, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465603828430176, gen p mean: -0.0591253861784935, mean p set: 0.44704070687294006
loss_pred:0.01337566040456295, decouple_loss:0.0013012123527005315
The modified gen p mean: 0.4494085907936096, gen p mean: -0.05387329310178757, mean p set: 0.44988885521888733The modified gen p mean: 0.4480462074279785, gen p mean: -0.05763372778892517, mean p set: 0.4485265016555786
loss_pred:0.01359286718070507, decouple_loss:0.0012051830999553204
loss_pred:0.014050613157451153, decouple_loss:0.00121335091535002
Iteration: 1498, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44648703932762146, gen p mean: -0.06167283281683922, mean p set: 0.44696733355522156
loss_pred:0.013246382586658001, decouple_loss:0.0013168954756110907
The modified gen p mean: 0.4484059512615204, gen p mean: -0.056044235825538635, mean p set: 0.4488862454891205The modified gen p mean: 0.44796425104141235, gen p mean: -0.06155885010957718, mean p set: 0.44844454526901245
loss_pred:0.014094939455389977, decouple_loss:0.001275047310627997
loss_pred:0.013366935774683952, decouple_loss:0.0012611813144758344
Iteration: 1499, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448636531829834, gen p mean: -0.0640636458992958, mean p set: 0.4491168260574341
loss_pred:0.01407301239669323, decouple_loss:0.0012163150822743773
The modified gen p mean: 0.4490843415260315, gen p mean: -0.06606077402830124, mean p set: 0.4495646357536316The modified gen p mean: 0.44615504145622253, gen p mean: -0.06358718127012253, mean p set: 0.44663533568382263
loss_pred:0.013561639003455639, decouple_loss:0.0012234473833814263
loss_pred:0.013468523509800434, decouple_loss:0.0012367988238111138
Iteration: 1500, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488388001918793, gen p mean: -0.05395802855491638, mean p set: 0.449319064617157
loss_pred:0.01404237188398838, decouple_loss:0.0012247813865542412
The modified gen p mean: 0.44788697361946106, gen p mean: -0.0635257214307785, mean p set: 0.44836726784706116The modified gen p mean: 0.4483340084552765, gen p mean: -0.054533109068870544, mean p set: 0.4488143026828766
loss_pred:0.013117715716362, decouple_loss:0.0012002881849184632
loss_pred:0.013761675916612148, decouple_loss:0.0012039386201649904
2023-05-02 08:19:09 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.05868129804730415, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.05426163226366043, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.05481933802366257, mean p set: 0.4500633478164673
loss_pred:0.01905335858464241, decouple_loss:0.0012733261100947857
loss_pred:0.018061378970742226, decouple_loss:0.001238701050169766
loss_pred:0.018102554604411125, decouple_loss:0.001223611063323915
WV_0_PC_1_EH_0_PS_40, loss: 0.01846802607178688, avg_mse: 0.026882674545049667
current test mse: 0.026883
Iteration: 1501, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44847527146339417, gen p mean: -0.05452503263950348, mean p set: 0.44895556569099426
The modified gen p mean: 0.44828712940216064, gen p mean: -0.05622642859816551, mean p set: 0.44876742362976074
The modified gen p mean: 0.44879150390625, gen p mean: -0.05865718424320221, mean p set: 0.4492718279361725
loss_pred:0.014133715070784092, decouple_loss:0.001334821106866002
loss_pred:0.013822258450090885, decouple_loss:0.001337200403213501
loss_pred:0.013719580136239529, decouple_loss:0.00117406970821321
Iteration: 1502, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4463944733142853, gen p mean: -0.05737414211034775, mean p set: 0.4468747675418854
The modified gen p mean: 0.44761234521865845, gen p mean: -0.05156851187348366, mean p set: 0.44809263944625854
loss_pred:0.0171707421541214, decouple_loss:0.001601635362021625
loss_pred:0.016821088269352913, decouple_loss:0.0013921158388257027
The modified gen p mean: 0.4474851191043854, gen p mean: -0.05383968725800514, mean p set: 0.44796544313430786
loss_pred:0.01716482639312744, decouple_loss:0.0014505432918667793
Iteration: 1503, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465106725692749, gen p mean: -0.05212580785155296, mean p set: 0.446990966796875
The modified gen p mean: 0.4483143091201782, gen p mean: -0.05074846372008324, mean p set: 0.44879457354545593
loss_pred:0.01808023266494274, decouple_loss:0.001715350430458784
loss_pred:0.017424166202545166, decouple_loss:0.0015487365890294313The modified gen p mean: 0.4486162066459656, gen p mean: -0.049642302095890045, mean p set: 0.4490965008735657
loss_pred:0.018717212602496147, decouple_loss:0.0015661624493077397
Iteration: 1504, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467921555042267, gen p mean: -0.04422842711210251, mean p set: 0.4472724497318268
loss_pred:0.015992429107427597, decouple_loss:0.0022494245786219835
The modified gen p mean: 0.44782358407974243, gen p mean: -0.04040525108575821, mean p set: 0.44830387830734253The modified gen p mean: 0.44850486516952515, gen p mean: -0.03735368326306343, mean p set: 0.44898515939712524
loss_pred:0.016452692449092865, decouple_loss:0.002324549714103341
loss_pred:0.015609076246619225, decouple_loss:0.0021921549923717976
Iteration: 1505, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44935524463653564, gen p mean: -0.040036391466856, mean p set: 0.44983553886413574
loss_pred:0.018541548401117325, decouple_loss:0.0032143357675522566
The modified gen p mean: 0.4487621486186981, gen p mean: -0.03903929516673088, mean p set: 0.4492424428462982The modified gen p mean: 0.44810235500335693, gen p mean: -0.04264024272561073, mean p set: 0.4485826790332794
loss_pred:0.017967263236641884, decouple_loss:0.0032453425228595734
loss_pred:0.018267661333084106, decouple_loss:0.003196112811565399
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012011_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012011_3_24hr.npz
NaN value num: 0
Iteration: 1506, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4510660171508789, gen p mean: 0.006616402417421341, mean p set: 0.4515463411808014
loss_pred:0.03245650231838226, decouple_loss:0.0034249883610755205
The modified gen p mean: 0.4497401714324951, gen p mean: 0.002904360881075263, mean p set: 0.4502204656600952The modified gen p mean: 0.45159173011779785, gen p mean: 0.004111444111913443, mean p set: 0.45207199454307556
loss_pred:0.03267764672636986, decouple_loss:0.0033434354700148106
loss_pred:0.03103836067020893, decouple_loss:0.0032456624321639538
Iteration: 1507, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490172863006592, gen p mean: -0.041550423949956894, mean p set: 0.4494975507259369
loss_pred:0.032536331564188004, decouple_loss:0.005774905439466238
The modified gen p mean: 0.4495244026184082, gen p mean: -0.03949212282896042, mean p set: 0.4500047266483307The modified gen p mean: 0.44990256428718567, gen p mean: -0.03978773579001427, mean p set: 0.45038288831710815
loss_pred:0.0321158803999424, decouple_loss:0.00594391580671072
loss_pred:0.033768266439437866, decouple_loss:0.005621599033474922
Iteration: 1508, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502185583114624, gen p mean: -0.05098170414566994, mean p set: 0.4506988525390625
The modified gen p mean: 0.44895100593566895, gen p mean: -0.05005958676338196, mean p set: 0.44943130016326904
loss_pred:0.04584290459752083, decouple_loss:0.006030300632119179
loss_pred:0.0464891642332077, decouple_loss:0.006124681327491999
The modified gen p mean: 0.449925035238266, gen p mean: -0.04702412709593773, mean p set: 0.4504052996635437
loss_pred:0.04541287571191788, decouple_loss:0.005971754435449839
Iteration: 1509, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45033106207847595, gen p mean: -0.06355126947164536, mean p set: 0.45081138610839844
loss_pred:0.03691001608967781, decouple_loss:0.007774138357490301
The modified gen p mean: 0.44911232590675354, gen p mean: -0.05872984603047371, mean p set: 0.449592649936676The modified gen p mean: 0.4513145387172699, gen p mean: -0.04901904612779617, mean p set: 0.45179483294487
loss_pred:0.03566090390086174, decouple_loss:0.007604773622006178
loss_pred:0.036463793367147446, decouple_loss:0.008236318826675415
Iteration: 1510, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45037171244621277, gen p mean: 0.009018689393997192, mean p set: 0.4508519768714905The modified gen p mean: 0.451831579208374, gen p mean: 0.009526601061224937, mean p set: 0.4523118734359741
loss_pred:0.03051069751381874, decouple_loss:0.007259925827383995
loss_pred:0.03259974718093872, decouple_loss:0.00725123705342412
The modified gen p mean: 0.4509523808956146, gen p mean: 0.011739290319383144, mean p set: 0.4514326751232147
loss_pred:0.030812740325927734, decouple_loss:0.007133445702493191
2023-05-02 08:21:36 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: 0.05157434195280075, mean p set: 0.4502691626548767
The modified gen p mean: 0.4498766362667084, gen p mean: 0.060635749250650406, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: 0.0589265339076519, mean p set: 0.4500633478164673
loss_pred:0.032731980085372925, decouple_loss:0.009163170121610165
loss_pred:0.031266044825315475, decouple_loss:0.00920551922172308
loss_pred:0.031494852155447006, decouple_loss:0.009349402971565723
WV_0_PC_1_EH_0_PS_40, loss: 0.0322929285466671, avg_mse: 0.039144549518823624
current test mse: 0.039145
Iteration: 1511, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45027145743370056, gen p mean: 0.05764128267765045, mean p set: 0.45075175166130066
The modified gen p mean: 0.44838088750839233, gen p mean: 0.06142064556479454, mean p set: 0.44886115193367004
The modified gen p mean: 0.45062196254730225, gen p mean: 0.05859113112092018, mean p set: 0.45110228657722473
loss_pred:0.03181196376681328, decouple_loss:0.009370340965688229
loss_pred:0.031894560903310776, decouple_loss:0.009661477990448475
loss_pred:0.030582785606384277, decouple_loss:0.009175852872431278
Iteration: 1512, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492405652999878, gen p mean: -0.043594393879175186, mean p set: 0.4497208595275879
loss_pred:0.028218118473887444, decouple_loss:0.00831124372780323
The modified gen p mean: 0.45185530185699463, gen p mean: -0.03748559579253197, mean p set: 0.4523356258869171The modified gen p mean: 0.45020654797554016, gen p mean: -0.0461694709956646, mean p set: 0.45068684220314026
loss_pred:0.027184950187802315, decouple_loss:0.00834500603377819
loss_pred:0.027504580095410347, decouple_loss:0.008564712479710579
Iteration: 1513, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45103469491004944, gen p mean: -0.09145962446928024, mean p set: 0.45151498913764954
The modified gen p mean: 0.450730562210083, gen p mean: -0.08015099167823792, mean p set: 0.4512108564376831loss_pred:0.02704130858182907, decouple_loss:0.010600450448691845
The modified gen p mean: 0.45075684785842896, gen p mean: -0.08765309303998947, mean p set: 0.45123711228370667
loss_pred:0.026086589321494102, decouple_loss:0.009854370728135109
loss_pred:0.0271382387727499, decouple_loss:0.01068010926246643
Iteration: 1514, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44979918003082275, gen p mean: -0.0862625390291214, mean p set: 0.45027947425842285
loss_pred:0.024946965277194977, decouple_loss:0.006830652244389057
The modified gen p mean: 0.4501641094684601, gen p mean: -0.0789903774857521, mean p set: 0.4506444036960602The modified gen p mean: 0.4503304064273834, gen p mean: -0.08434764295816422, mean p set: 0.45081067085266113
loss_pred:0.02438642643392086, decouple_loss:0.006818165071308613
loss_pred:0.024828365072607994, decouple_loss:0.006863620597869158
Iteration: 1515, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495488703250885, gen p mean: -0.0708760917186737, mean p set: 0.4500291645526886
loss_pred:0.0234853383153677, decouple_loss:0.007969142869114876
The modified gen p mean: 0.4513510763645172, gen p mean: -0.07301710546016693, mean p set: 0.45183131098747253The modified gen p mean: 0.4494132697582245, gen p mean: -0.07357227802276611, mean p set: 0.4498935639858246
loss_pred:0.02396123856306076, decouple_loss:0.007641507312655449
loss_pred:0.02255021594464779, decouple_loss:0.0077140009962022305
Iteration: 1516, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504880905151367, gen p mean: -0.04806394502520561, mean p set: 0.4509684145450592
loss_pred:0.023198634386062622, decouple_loss:0.006935081444680691
The modified gen p mean: 0.44896262884140015, gen p mean: -0.049738310277462006, mean p set: 0.44944292306900024
The modified gen p mean: 0.4501987099647522, gen p mean: -0.0494559109210968, mean p set: 0.4506790041923523
loss_pred:0.022742081433534622, decouple_loss:0.006911491043865681
loss_pred:0.022757763043045998, decouple_loss:0.00684801209717989
Iteration: 1517, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499324858188629, gen p mean: -0.03710120543837547, mean p set: 0.4504128098487854
loss_pred:0.022253718227148056, decouple_loss:0.007171825971454382
The modified gen p mean: 0.4491015076637268, gen p mean: -0.037835702300071716, mean p set: 0.4495818316936493The modified gen p mean: 0.45214927196502686, gen p mean: -0.038017574697732925, mean p set: 0.45262953639030457
loss_pred:0.022391896694898605, decouple_loss:0.007021641358733177
loss_pred:0.022833311930298805, decouple_loss:0.007090428844094276
Iteration: 1518, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4506820738315582, gen p mean: -0.03930039703845978, mean p set: 0.45116233825683594
loss_pred:0.021892236545681953, decouple_loss:0.006224924232810736
The modified gen p mean: 0.4505167007446289, gen p mean: -0.03875694423913956, mean p set: 0.450996994972229The modified gen p mean: 0.4500146210193634, gen p mean: -0.04126284271478653, mean p set: 0.4504949152469635
loss_pred:0.021691221743822098, decouple_loss:0.006383113097399473
loss_pred:0.021833635866642, decouple_loss:0.006303407717496157
Iteration: 1519, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491910934448242, gen p mean: -0.04569101333618164, mean p set: 0.4496713876724243
loss_pred:0.02193448506295681, decouple_loss:0.006429188884794712
The modified gen p mean: 0.44981926679611206, gen p mean: -0.053431279957294464, mean p set: 0.45029953122138977The modified gen p mean: 0.4492666721343994, gen p mean: -0.0484456792473793, mean p set: 0.4497469365596771
loss_pred:0.021749937906861305, decouple_loss:0.006592130754143
loss_pred:0.022210247814655304, decouple_loss:0.006073945667594671
Iteration: 1520, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45050111413002014, gen p mean: -0.05922195687890053, mean p set: 0.45098140835762024
loss_pred:0.02131046913564205, decouple_loss:0.00572552252560854
The modified gen p mean: 0.44838547706604004, gen p mean: -0.05540960654616356, mean p set: 0.4488658010959625The modified gen p mean: 0.4500886797904968, gen p mean: -0.05925069749355316, mean p set: 0.4505689740180969
loss_pred:0.021705683320760727, decouple_loss:0.005830792710185051
loss_pred:0.021902505308389664, decouple_loss:0.0058748009614646435
2023-05-02 08:23:29 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.06736178696155548, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.06020375341176987, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.0631217211484909, mean p set: 0.4500633478164673
loss_pred:0.02656809613108635, decouple_loss:0.006650892086327076
loss_pred:0.025474760681390762, decouple_loss:0.006696673575788736
loss_pred:0.025744786486029625, decouple_loss:0.006680775433778763
WV_0_PC_1_EH_0_PS_40, loss: 0.026263020932674408, avg_mse: 0.03329276666045189
current test mse: 0.033293
Iteration: 1521, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45067375898361206, gen p mean: -0.06332582235336304, mean p set: 0.45115405321121216
The modified gen p mean: 0.4500882625579834, gen p mean: -0.05994167551398277, mean p set: 0.4505685865879059
The modified gen p mean: 0.4511227011680603, gen p mean: -0.05753747373819351, mean p set: 0.4516029953956604
loss_pred:0.024370675906538963, decouple_loss:0.007105798460543156
loss_pred:0.023564012721180916, decouple_loss:0.006856347434222698
loss_pred:0.024765830487012863, decouple_loss:0.0073010968044400215
Iteration: 1522, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493039548397064, gen p mean: -0.059876058250665665, mean p set: 0.4497842490673065
The modified gen p mean: 0.45003727078437805, gen p mean: -0.05983429029583931, mean p set: 0.45051753520965576
loss_pred:0.023100774735212326, decouple_loss:0.005135148297995329
loss_pred:0.023362241685390472, decouple_loss:0.005302769597619772
The modified gen p mean: 0.4499701261520386, gen p mean: -0.06021663919091225, mean p set: 0.45045042037963867
loss_pred:0.02351665124297142, decouple_loss:0.005247469060122967
Iteration: 1523, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45193350315093994, gen p mean: -0.058318763971328735, mean p set: 0.45241379737854004
The modified gen p mean: 0.44981467723846436, gen p mean: -0.06154516339302063, mean p set: 0.45029497146606445
loss_pred:0.022947167977690697, decouple_loss:0.005361111834645271
loss_pred:0.02288130298256874, decouple_loss:0.005325338337570429
The modified gen p mean: 0.4502076208591461, gen p mean: -0.06511577218770981, mean p set: 0.4506879150867462
loss_pred:0.023398974910378456, decouple_loss:0.005341139156371355
Iteration: 1524, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44908955693244934, gen p mean: -0.06740792840719223, mean p set: 0.44956985116004944
The modified gen p mean: 0.449672669172287, gen p mean: -0.06329631805419922, mean p set: 0.4501529335975647
loss_pred:0.021071070805191994, decouple_loss:0.004825306124985218
loss_pred:0.020892346277832985, decouple_loss:0.0048501151613891125
The modified gen p mean: 0.4490228295326233, gen p mean: -0.06236075237393379, mean p set: 0.4495031237602234
loss_pred:0.021034350618720055, decouple_loss:0.0047810981050133705
Iteration: 1525, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498765468597412, gen p mean: -0.04991806671023369, mean p set: 0.4503568708896637
loss_pred:0.021569067612290382, decouple_loss:0.004519076086580753
The modified gen p mean: 0.45027074217796326, gen p mean: -0.04893060773611069, mean p set: 0.45075103640556335The modified gen p mean: 0.44988730549812317, gen p mean: -0.049645375460386276, mean p set: 0.45036759972572327
loss_pred:0.021460937336087227, decouple_loss:0.0046075680293142796
loss_pred:0.021635977551341057, decouple_loss:0.004499493166804314
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012001_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012001_3_24hr.npz
NaN value num: 0
Iteration: 1526, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467913806438446, gen p mean: -0.04483522102236748, mean p set: 0.4472716748714447
loss_pred:0.021520398557186127, decouple_loss:0.0049750967882573605
The modified gen p mean: 0.447295606136322, gen p mean: -0.040768101811409, mean p set: 0.4477759003639221The modified gen p mean: 0.44755247235298157, gen p mean: -0.044975645840168, mean p set: 0.4480327367782593
loss_pred:0.020892921835184097, decouple_loss:0.00494020152837038
loss_pred:0.020945394411683083, decouple_loss:0.004920265171676874
Iteration: 1527, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474721848964691, gen p mean: -0.039346132427453995, mean p set: 0.4479525089263916
The modified gen p mean: 0.44812071323394775, gen p mean: -0.03324516862630844, mean p set: 0.44860100746154785
loss_pred:0.021165603771805763, decouple_loss:0.004834960680454969
loss_pred:0.020723089575767517, decouple_loss:0.005044983699917793
The modified gen p mean: 0.4469364285469055, gen p mean: -0.03405428305268288, mean p set: 0.447416752576828
loss_pred:0.020620383322238922, decouple_loss:0.004953565541654825
Iteration: 1528, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44609716534614563, gen p mean: -0.03546103090047836, mean p set: 0.4465774595737457
The modified gen p mean: 0.4473952651023865, gen p mean: -0.036326419562101364, mean p set: 0.4478755593299866loss_pred:0.024771464988589287, decouple_loss:0.004615649580955505
The modified gen p mean: 0.44738903641700745, gen p mean: -0.030478594824671745, mean p set: 0.44786933064460754
loss_pred:0.024357803165912628, decouple_loss:0.0047304644249379635
loss_pred:0.02413284219801426, decouple_loss:0.004613046068698168
Iteration: 1529, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470263123512268, gen p mean: -0.028413688763976097, mean p set: 0.4475066065788269
loss_pred:0.023333022370934486, decouple_loss:0.004482594318687916
The modified gen p mean: 0.4472956657409668, gen p mean: -0.03064071014523506, mean p set: 0.4477759599685669The modified gen p mean: 0.44660335779190063, gen p mean: -0.03005892038345337, mean p set: 0.44708362221717834
loss_pred:0.024270327761769295, decouple_loss:0.004572225734591484
loss_pred:0.023985128849744797, decouple_loss:0.0044845216907560825
Iteration: 1530, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44766610860824585, gen p mean: -0.0455448254942894, mean p set: 0.44814640283584595
The modified gen p mean: 0.4482124447822571, gen p mean: -0.04160776734352112, mean p set: 0.4486927390098572
loss_pred:0.022461477667093277, decouple_loss:0.004857752006500959
loss_pred:0.02212490141391754, decouple_loss:0.0049340794794261456The modified gen p mean: 0.44753625988960266, gen p mean: -0.045426443219184875, mean p set: 0.44801655411720276
loss_pred:0.021213503554463387, decouple_loss:0.004754639696329832
2023-05-02 08:26:02 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.08177509158849716, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.07437612116336823, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.07655461132526398, mean p set: 0.4500633478164673
loss_pred:0.025734640657901764, decouple_loss:0.006078124046325684
loss_pred:0.024556299671530724, decouple_loss:0.005775585770606995
loss_pred:0.02511301450431347, decouple_loss:0.005987041164189577
WV_0_PC_1_EH_0_PS_40, loss: 0.02543199621140957, avg_mse: 0.03487603738903999
current test mse: 0.034876
Iteration: 1531, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476989805698395, gen p mean: -0.0737462192773819, mean p set: 0.44817930459976196
The modified gen p mean: 0.4467073678970337, gen p mean: -0.07865703105926514, mean p set: 0.4471876323223114
The modified gen p mean: 0.448147714138031, gen p mean: -0.07517995685338974, mean p set: 0.4486280083656311
loss_pred:0.022948171943426132, decouple_loss:0.005529853515326977
loss_pred:0.02387426793575287, decouple_loss:0.0060088555328547955
loss_pred:0.023860884830355644, decouple_loss:0.005769794341176748
Iteration: 1532, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480387568473816, gen p mean: -0.057681478559970856, mean p set: 0.4485190510749817
loss_pred:0.025203155353665352, decouple_loss:0.005376885179430246
The modified gen p mean: 0.4466308355331421, gen p mean: -0.05780007690191269, mean p set: 0.4471111297607422The modified gen p mean: 0.4465222954750061, gen p mean: -0.05488595739006996, mean p set: 0.4470026195049286
loss_pred:0.024991296231746674, decouple_loss:0.0048674168065190315
loss_pred:0.024655107408761978, decouple_loss:0.004919455386698246
Iteration: 1533, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44818082451820374, gen p mean: -0.04751065745949745, mean p set: 0.4486611485481262
loss_pred:0.02328331395983696, decouple_loss:0.005508674308657646
The modified gen p mean: 0.44875603914260864, gen p mean: -0.044463399797677994, mean p set: 0.44923636317253113The modified gen p mean: 0.4482123553752899, gen p mean: -0.04264877736568451, mean p set: 0.44869264960289
loss_pred:0.023647062480449677, decouple_loss:0.005023834761232138
loss_pred:0.023174628615379333, decouple_loss:0.005533932242542505
Iteration: 1534, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4463751018047333, gen p mean: -0.05618659779429436, mean p set: 0.4468553960323334
loss_pred:0.022377509623765945, decouple_loss:0.005385170225054026
The modified gen p mean: 0.4466248154640198, gen p mean: -0.04701433703303337, mean p set: 0.4471050798892975The modified gen p mean: 0.446953147649765, gen p mean: -0.053076617419719696, mean p set: 0.4474334716796875
loss_pred:0.021612437441945076, decouple_loss:0.005471538752317429
loss_pred:0.022213242948055267, decouple_loss:0.005232565570622683
Iteration: 1535, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465309977531433, gen p mean: -0.060173965990543365, mean p set: 0.4470112919807434
loss_pred:0.020905887708067894, decouple_loss:0.006372527219355106
The modified gen p mean: 0.44717469811439514, gen p mean: -0.06334643065929413, mean p set: 0.44765499234199524The modified gen p mean: 0.4469571113586426, gen p mean: -0.060840897262096405, mean p set: 0.44743743538856506
loss_pred:0.021876173093914986, decouple_loss:0.0063775996677577496
loss_pred:0.021723398938775063, decouple_loss:0.006657790392637253
Iteration: 1536, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44737738370895386, gen p mean: -0.06949027627706528, mean p set: 0.44785767793655396
loss_pred:0.02224886417388916, decouple_loss:0.006547377910465002
The modified gen p mean: 0.4474543631076813, gen p mean: -0.06879017502069473, mean p set: 0.447934627532959
The modified gen p mean: 0.4460698068141937, gen p mean: -0.06443902850151062, mean p set: 0.4465501010417938
loss_pred:0.02137470617890358, decouple_loss:0.006664984859526157
loss_pred:0.02205173671245575, decouple_loss:0.006754319649189711
Iteration: 1537, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473174214363098, gen p mean: -0.06230544671416283, mean p set: 0.4477977156639099
The modified gen p mean: 0.44814741611480713, gen p mean: -0.05961354076862335, mean p set: 0.44862768054008484
loss_pred:0.02052232436835766, decouple_loss:0.005612820852547884
loss_pred:0.020287323743104935, decouple_loss:0.005756809841841459The modified gen p mean: 0.4472768306732178, gen p mean: -0.05893516167998314, mean p set: 0.4477570950984955
loss_pred:0.020604152232408524, decouple_loss:0.0056254006922245026
Iteration: 1538, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44784805178642273, gen p mean: -0.06237287074327469, mean p set: 0.44832831621170044
loss_pred:0.020311756059527397, decouple_loss:0.005517324898391962
The modified gen p mean: 0.44685688614845276, gen p mean: -0.05712710693478584, mean p set: 0.4473371207714081The modified gen p mean: 0.44667768478393555, gen p mean: -0.05772700160741806, mean p set: 0.44715800881385803
loss_pred:0.019273564219474792, decouple_loss:0.005424782633781433
loss_pred:0.01929648406803608, decouple_loss:0.005483618471771479
Iteration: 1539, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44640475511550903, gen p mean: -0.05358421429991722, mean p set: 0.44688504934310913
loss_pred:0.01950692944228649, decouple_loss:0.00509047694504261
The modified gen p mean: 0.44614535570144653, gen p mean: -0.06056709215044975, mean p set: 0.44662564992904663
The modified gen p mean: 0.44719362258911133, gen p mean: -0.052294135093688965, mean p set: 0.4476739168167114
loss_pred:0.019933460280299187, decouple_loss:0.0051268343813717365
loss_pred:0.01971103437244892, decouple_loss:0.005154899787157774
Iteration: 1540, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44689351320266724, gen p mean: -0.05868063494563103, mean p set: 0.4473738372325897
loss_pred:0.018647609278559685, decouple_loss:0.004938836675137281
The modified gen p mean: 0.44665172696113586, gen p mean: -0.056312188506126404, mean p set: 0.44713205099105835The modified gen p mean: 0.447307288646698, gen p mean: -0.05725967511534691, mean p set: 0.4477875828742981
loss_pred:0.019638666883111, decouple_loss:0.004995020106434822
loss_pred:0.01931123435497284, decouple_loss:0.005095900036394596
2023-05-02 08:27:55 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.06104659661650658, mean p set: 0.4502691626548767
The modified gen p mean: 0.4498766362667084, gen p mean: -0.05275290459394455, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.05518408864736557, mean p set: 0.4500633478164673
loss_pred:0.021619627252221107, decouple_loss:0.004878252744674683
loss_pred:0.02042127400636673, decouple_loss:0.004521222785115242
loss_pred:0.02068462409079075, decouple_loss:0.004688828717917204
WV_0_PC_1_EH_0_PS_40, loss: 0.021143313497304916, avg_mse: 0.028461478650569916
current test mse: 0.028461
Iteration: 1541, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44794782996177673, gen p mean: -0.052615631371736526, mean p set: 0.44842812418937683
The modified gen p mean: 0.4478078782558441, gen p mean: -0.057737190276384354, mean p set: 0.4482881724834442
The modified gen p mean: 0.4482475817203522, gen p mean: -0.05142911896109581, mean p set: 0.44872787594795227
loss_pred:0.01849871501326561, decouple_loss:0.004589459393173456
loss_pred:0.019040383398532867, decouple_loss:0.004517875146120787loss_pred:0.018818948417901993, decouple_loss:0.004834262188524008
Iteration: 1542, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484021067619324, gen p mean: -0.05418231338262558, mean p set: 0.44888240098953247
The modified gen p mean: 0.44684138894081116, gen p mean: -0.055995866656303406, mean p set: 0.44732168316841125
loss_pred:0.01863924413919449, decouple_loss:0.004381028935313225
loss_pred:0.018555331975221634, decouple_loss:0.004224766511470079
The modified gen p mean: 0.44669532775878906, gen p mean: -0.060622867196798325, mean p set: 0.44717565178871155
loss_pred:0.019174596294760704, decouple_loss:0.004373186733573675
Iteration: 1543, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44716647267341614, gen p mean: -0.058175861835479736, mean p set: 0.44764676690101624
The modified gen p mean: 0.44720712304115295, gen p mean: -0.0555686429142952, mean p set: 0.44768741726875305
loss_pred:0.018771417438983917, decouple_loss:0.004395054187625647
loss_pred:0.018247192725539207, decouple_loss:0.004382707178592682
The modified gen p mean: 0.44715994596481323, gen p mean: -0.06349175423383713, mean p set: 0.44764021039009094
loss_pred:0.018920211121439934, decouple_loss:0.0043466598726809025
Iteration: 1544, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44691500067710876, gen p mean: -0.06528212130069733, mean p set: 0.44739529490470886
The modified gen p mean: 0.4471932649612427, gen p mean: -0.06032125651836395, mean p set: 0.4476735293865204
loss_pred:0.01761479303240776, decouple_loss:0.003852699650451541
loss_pred:0.01856394112110138, decouple_loss:0.004055614583194256
The modified gen p mean: 0.4466235935688019, gen p mean: -0.06575752794742584, mean p set: 0.4471038579940796
loss_pred:0.01936591975390911, decouple_loss:0.0038457822520285845
Iteration: 1545, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471668303012848, gen p mean: -0.060606133192777634, mean p set: 0.4476470947265625
The modified gen p mean: 0.44703614711761475, gen p mean: -0.06323089450597763, mean p set: 0.44751641154289246
loss_pred:0.017857268452644348, decouple_loss:0.003649607300758362
loss_pred:0.017689241096377373, decouple_loss:0.0036995781119912863
The modified gen p mean: 0.4472036063671112, gen p mean: -0.06332322955131531, mean p set: 0.4476839005947113
loss_pred:0.01735846698284149, decouple_loss:0.0038032149896025658
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012007_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012007_3_24hr.npz
NaN value num: 0
Iteration: 1546, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45220547914505005, gen p mean: -0.05937359482049942, mean p set: 0.45268580317497253
loss_pred:0.020006194710731506, decouple_loss:0.0038668462075293064
The modified gen p mean: 0.4521689713001251, gen p mean: -0.057640448212623596, mean p set: 0.45264923572540283The modified gen p mean: 0.45134875178337097, gen p mean: -0.053955528885126114, mean p set: 0.45182904601097107
loss_pred:0.018839752301573753, decouple_loss:0.0040314230136573315
loss_pred:0.020505886524915695, decouple_loss:0.00396236265078187
Iteration: 1547, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4528239965438843, gen p mean: -0.05393550172448158, mean p set: 0.4533042907714844
loss_pred:0.018418503925204277, decouple_loss:0.003813473042100668
The modified gen p mean: 0.4508441388607025, gen p mean: -0.05927878990769386, mean p set: 0.4513244330883026The modified gen p mean: 0.4513745903968811, gen p mean: -0.057611215859651566, mean p set: 0.4518548846244812
loss_pred:0.019550878554582596, decouple_loss:0.003694458631798625
loss_pred:0.019526463001966476, decouple_loss:0.003679987508803606
Iteration: 1548, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4539802670478821, gen p mean: -0.053189411759376526, mean p set: 0.45446059107780457
loss_pred:0.01789863593876362, decouple_loss:0.004131929948925972
The modified gen p mean: 0.4543343782424927, gen p mean: -0.05232711508870125, mean p set: 0.4548146724700928The modified gen p mean: 0.4515138268470764, gen p mean: -0.0514010451734066, mean p set: 0.4519941210746765
loss_pred:0.01820620708167553, decouple_loss:0.004027554299682379
loss_pred:0.018689947202801704, decouple_loss:0.003973069600760937
Iteration: 1549, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4509720802307129, gen p mean: -0.05542284622788429, mean p set: 0.451452374458313
loss_pred:0.01866518147289753, decouple_loss:0.0037867792416363955
The modified gen p mean: 0.45227065682411194, gen p mean: -0.05081307515501976, mean p set: 0.45275095105171204The modified gen p mean: 0.4521137475967407, gen p mean: -0.053627919405698776, mean p set: 0.4525940418243408
loss_pred:0.017434818670153618, decouple_loss:0.003597666509449482
loss_pred:0.018307918682694435, decouple_loss:0.003595980117097497
Iteration: 1550, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508156180381775, gen p mean: -0.045135680586099625, mean p set: 0.4512959122657776
loss_pred:0.018177025020122528, decouple_loss:0.003900294890627265
The modified gen p mean: 0.45276230573654175, gen p mean: -0.04692719131708145, mean p set: 0.45324259996414185The modified gen p mean: 0.45169582962989807, gen p mean: -0.04381271079182625, mean p set: 0.4521760940551758
loss_pred:0.01734056882560253, decouple_loss:0.003804632928222418
loss_pred:0.018469572067260742, decouple_loss:0.003847169689834118
2023-05-02 08:30:26 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.05028426647186279, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.042495518922805786, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.043523844331502914, mean p set: 0.4500633478164673
loss_pred:0.02041679434478283, decouple_loss:0.003964354284107685
loss_pred:0.019205525517463684, decouple_loss:0.0037576828617602587
loss_pred:0.019437424838542938, decouple_loss:0.0037665986455976963
WV_0_PC_1_EH_0_PS_40, loss: 0.01987805962562561, avg_mse: 0.02756364643573761
current test mse: 0.027564
Iteration: 1551, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4527190923690796, gen p mean: -0.03948009014129639, mean p set: 0.4531993865966797
The modified gen p mean: 0.45249706506729126, gen p mean: -0.03808610141277313, mean p set: 0.45297735929489136
The modified gen p mean: 0.4506838619709015, gen p mean: -0.03779483959078789, mean p set: 0.4511641561985016
loss_pred:0.017771920189261436, decouple_loss:0.0038184323348104954
loss_pred:0.01790672540664673, decouple_loss:0.0038364583160728216
loss_pred:0.01731751300394535, decouple_loss:0.0037127798423171043
Iteration: 1552, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4529423713684082, gen p mean: -0.03429911285638809, mean p set: 0.4534226953983307
The modified gen p mean: 0.4539129436016083, gen p mean: -0.03204070031642914, mean p set: 0.45439326763153076
loss_pred:0.017760131508111954, decouple_loss:0.0034264971036463976
loss_pred:0.017560794949531555, decouple_loss:0.0033608407247811556
The modified gen p mean: 0.4516972601413727, gen p mean: -0.03353847563266754, mean p set: 0.4521775543689728
loss_pred:0.018721582368016243, decouple_loss:0.0033443013671785593
Iteration: 1553, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45271334052085876, gen p mean: -0.028455812484025955, mean p set: 0.45319366455078125
The modified gen p mean: 0.4527140259742737, gen p mean: -0.030425187200307846, mean p set: 0.4531942903995514
loss_pred:0.016657749190926552, decouple_loss:0.0031802444718778133
loss_pred:0.018057608976960182, decouple_loss:0.0031975351739674807The modified gen p mean: 0.4520118236541748, gen p mean: -0.03200395032763481, mean p set: 0.4524921178817749
loss_pred:0.01788068376481533, decouple_loss:0.0030582286417484283
Iteration: 1554, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45347917079925537, gen p mean: -0.03341221809387207, mean p set: 0.45395946502685547
The modified gen p mean: 0.4508700668811798, gen p mean: -0.029599720612168312, mean p set: 0.4513503611087799
loss_pred:0.017281094565987587, decouple_loss:0.0030160988681018353
loss_pred:0.01853286102414131, decouple_loss:0.0028441620524972677
The modified gen p mean: 0.4505382776260376, gen p mean: -0.03127136453986168, mean p set: 0.4510186016559601
loss_pred:0.018165258690714836, decouple_loss:0.003007128369063139
Iteration: 1555, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4522089660167694, gen p mean: -0.034303124994039536, mean p set: 0.4526892900466919
The modified gen p mean: 0.45233041048049927, gen p mean: -0.03732778877019882, mean p set: 0.45281070470809937
loss_pred:0.017929695546627045, decouple_loss:0.002773633459582925
loss_pred:0.018010852858424187, decouple_loss:0.0027177080046385527
The modified gen p mean: 0.4513258635997772, gen p mean: -0.03671035170555115, mean p set: 0.45180612802505493
loss_pred:0.018543094396591187, decouple_loss:0.002800023416057229
Iteration: 1556, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45082202553749084, gen p mean: -0.03562682121992111, mean p set: 0.45130228996276855
loss_pred:0.01734834350645542, decouple_loss:0.00266091781668365
The modified gen p mean: 0.4522453844547272, gen p mean: -0.03867743909358978, mean p set: 0.4527256488800049
The modified gen p mean: 0.4522281885147095, gen p mean: -0.03824297711253166, mean p set: 0.45270848274230957
loss_pred:0.0178226288408041, decouple_loss:0.0026345914229750633
loss_pred:0.018254127353429794, decouple_loss:0.002542318543419242
Iteration: 1557, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513583183288574, gen p mean: -0.04169272631406784, mean p set: 0.4518386423587799
loss_pred:0.018147429451346397, decouple_loss:0.00262117525562644
The modified gen p mean: 0.45131009817123413, gen p mean: -0.039028532803058624, mean p set: 0.4517904222011566The modified gen p mean: 0.45097970962524414, gen p mean: -0.037551093846559525, mean p set: 0.45146000385284424
loss_pred:0.018691234290599823, decouple_loss:0.0025913603603839874
loss_pred:0.017549000680446625, decouple_loss:0.002617834135890007
Iteration: 1558, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45180991291999817, gen p mean: -0.04032841697335243, mean p set: 0.45229020714759827
loss_pred:0.01828540675342083, decouple_loss:0.0026154599618166685
The modified gen p mean: 0.4510241150856018, gen p mean: -0.04534117504954338, mean p set: 0.4515043795108795
The modified gen p mean: 0.4522641897201538, gen p mean: -0.04126940667629242, mean p set: 0.4527444541454315
loss_pred:0.0174446739256382, decouple_loss:0.0025145355612039566
loss_pred:0.01818779669702053, decouple_loss:0.002695851493626833
Iteration: 1559, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4524080753326416, gen p mean: -0.04256149008870125, mean p set: 0.4528883397579193
loss_pred:0.01736719347536564, decouple_loss:0.002415750175714493
The modified gen p mean: 0.4511820375919342, gen p mean: -0.03931553661823273, mean p set: 0.4516623318195343The modified gen p mean: 0.4514199197292328, gen p mean: -0.03759540617465973, mean p set: 0.4519002437591553
loss_pred:0.016872329637408257, decouple_loss:0.0024477133993059397
loss_pred:0.01794917695224285, decouple_loss:0.002374645322561264
Iteration: 1560, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507489502429962, gen p mean: -0.04030783101916313, mean p set: 0.4512292742729187
loss_pred:0.018972190096974373, decouple_loss:0.002374096307903528
The modified gen p mean: 0.45056912302970886, gen p mean: -0.036677733063697815, mean p set: 0.4510493874549866
The modified gen p mean: 0.4521506130695343, gen p mean: -0.0425758957862854, mean p set: 0.4526309072971344
loss_pred:0.01759851537644863, decouple_loss:0.002301233820617199
loss_pred:0.018903015181422234, decouple_loss:0.002402947749942541
2023-05-02 08:32:21 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.0563410259783268, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04769958555698395, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.05005086958408356, mean p set: 0.4500633478164673
loss_pred:0.01977451518177986, decouple_loss:0.002792235929518938
loss_pred:0.01867339387536049, decouple_loss:0.002598562277853489
loss_pred:0.01881752535700798, decouple_loss:0.002627408131957054
WV_0_PC_1_EH_0_PS_40, loss: 0.019222116097807884, avg_mse: 0.026997286826372147
current test mse: 0.026997
Iteration: 1561, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4536548852920532, gen p mean: -0.043286800384521484, mean p set: 0.4541351795196533
The modified gen p mean: 0.4511546194553375, gen p mean: -0.04705861583352089, mean p set: 0.4516349136829376
The modified gen p mean: 0.45272040367126465, gen p mean: -0.042772069573402405, mean p set: 0.45320072770118713
loss_pred:0.017153674736618996, decouple_loss:0.0024157206062227488
loss_pred:0.016788700595498085, decouple_loss:0.002525896765291691
loss_pred:0.018190689384937286, decouple_loss:0.0025172813329845667
Iteration: 1562, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4510827362537384, gen p mean: -0.05011014640331268, mean p set: 0.4515630006790161
loss_pred:0.018290262669324875, decouple_loss:0.002267431002110243
The modified gen p mean: 0.45048317313194275, gen p mean: -0.04968990013003349, mean p set: 0.45096346735954285The modified gen p mean: 0.45246726274490356, gen p mean: -0.04938826337456703, mean p set: 0.45294755697250366
loss_pred:0.01817120611667633, decouple_loss:0.0022887876257300377
loss_pred:0.0170906912535429, decouple_loss:0.002320115454494953
Iteration: 1563, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45221826434135437, gen p mean: -0.045864276587963104, mean p set: 0.45269855856895447
loss_pred:0.01678714156150818, decouple_loss:0.0024730167351663113
The modified gen p mean: 0.4528367221355438, gen p mean: -0.048118848353624344, mean p set: 0.4533170461654663
The modified gen p mean: 0.4530586898326874, gen p mean: -0.04839625209569931, mean p set: 0.4535389542579651
loss_pred:0.0174711961299181, decouple_loss:0.0026187472976744175
loss_pred:0.01676131784915924, decouple_loss:0.002589557087048888
Iteration: 1564, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45104166865348816, gen p mean: -0.04884815216064453, mean p set: 0.45152196288108826
loss_pred:0.01784936711192131, decouple_loss:0.002214823616668582
The modified gen p mean: 0.45270633697509766, gen p mean: -0.04398958012461662, mean p set: 0.45318663120269775
The modified gen p mean: 0.4498565196990967, gen p mean: -0.04707043617963791, mean p set: 0.4503368139266968
loss_pred:0.01688527874648571, decouple_loss:0.002102822298184037
loss_pred:0.017661182209849358, decouple_loss:0.0021693126764148474
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012016_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012016_3_24hr.npz
NaN value num: 0
Iteration: 1565, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514193832874298, gen p mean: -0.03979629650712013, mean p set: 0.4518997073173523
loss_pred:0.01902063935995102, decouple_loss:0.002409229287877679
The modified gen p mean: 0.4522475302219391, gen p mean: -0.04151920974254608, mean p set: 0.4527277946472168The modified gen p mean: 0.45156583189964294, gen p mean: -0.049888599663972855, mean p set: 0.45204612612724304
loss_pred:0.018733825534582138, decouple_loss:0.002363783773034811
loss_pred:0.01724555529654026, decouple_loss:0.00231199455447495
Iteration: 1566, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45147013664245605, gen p mean: -0.04959587752819061, mean p set: 0.45195040106773376
loss_pred:0.017167791724205017, decouple_loss:0.0022404806222766638
The modified gen p mean: 0.45079344511032104, gen p mean: -0.046098850667476654, mean p set: 0.45127376914024353The modified gen p mean: 0.4506746828556061, gen p mean: -0.04488220065832138, mean p set: 0.4511549472808838
loss_pred:0.018785744905471802, decouple_loss:0.002046359935775399
loss_pred:0.018482239916920662, decouple_loss:0.0021083136089146137
Iteration: 1567, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511711001396179, gen p mean: -0.05245168134570122, mean p set: 0.45165136456489563
loss_pred:0.01783067174255848, decouple_loss:0.0023711081594228745
The modified gen p mean: 0.4522682726383209, gen p mean: -0.0519862174987793, mean p set: 0.4527485966682434The modified gen p mean: 0.45016083121299744, gen p mean: -0.04928387328982353, mean p set: 0.45064112544059753
loss_pred:0.017985664308071136, decouple_loss:0.0024262017104774714
loss_pred:0.01854746602475643, decouple_loss:0.0023782483767718077
Iteration: 1568, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507175385951996, gen p mean: -0.04451579600572586, mean p set: 0.45119786262512207
loss_pred:0.017960522323846817, decouple_loss:0.0021489006467163563
The modified gen p mean: 0.4507941007614136, gen p mean: -0.05603345111012459, mean p set: 0.45127442479133606The modified gen p mean: 0.4539720416069031, gen p mean: -0.05506327748298645, mean p set: 0.45445236563682556
loss_pred:0.018070081248879433, decouple_loss:0.002308072056621313
loss_pred:0.017728587612509727, decouple_loss:0.0022144890390336514
Iteration: 1569, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45201635360717773, gen p mean: -0.0426473543047905, mean p set: 0.4524966776371002
loss_pred:0.018403418362140656, decouple_loss:0.0023092820774763823
The modified gen p mean: 0.4511788487434387, gen p mean: -0.05565081909298897, mean p set: 0.4516591429710388The modified gen p mean: 0.45111456513404846, gen p mean: -0.05148959532380104, mean p set: 0.45159485936164856
loss_pred:0.017486710101366043, decouple_loss:0.002268451265990734
loss_pred:0.016774261370301247, decouple_loss:0.0021842936985194683
Iteration: 1570, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4532153904438019, gen p mean: -0.043691445142030716, mean p set: 0.453695684671402
loss_pred:0.01717604510486126, decouple_loss:0.002081932732835412
The modified gen p mean: 0.45178964734077454, gen p mean: -0.052364714443683624, mean p set: 0.45226994156837463The modified gen p mean: 0.4511578381061554, gen p mean: -0.04313357174396515, mean p set: 0.4516381621360779
loss_pred:0.016651542857289314, decouple_loss:0.0020242135506123304
loss_pred:0.01794585958123207, decouple_loss:0.0020024392288178205
2023-05-02 08:34:53 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.05801496282219887, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.049657225608825684, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.052110686898231506, mean p set: 0.4500633478164673
loss_pred:0.01942611113190651, decouple_loss:0.002469711471349001
loss_pred:0.018295198678970337, decouple_loss:0.0024372050538659096
loss_pred:0.018501006066799164, decouple_loss:0.0025090479757636786
WV_0_PC_1_EH_0_PS_40, loss: 0.01886437088251114, avg_mse: 0.02665397711098194
current test mse: 0.026654
Iteration: 1571, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45145928859710693, gen p mean: -0.04415407031774521, mean p set: 0.45193958282470703
The modified gen p mean: 0.451314777135849, gen p mean: -0.04184173792600632, mean p set: 0.4517951011657715
The modified gen p mean: 0.4532906711101532, gen p mean: -0.04495465010404587, mean p set: 0.4537709653377533
loss_pred:0.017704132944345474, decouple_loss:0.002002103254199028
loss_pred:0.017098816111683846, decouple_loss:0.002064882544800639
loss_pred:0.018059322610497475, decouple_loss:0.0019244736758992076
Iteration: 1572, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45226386189460754, gen p mean: -0.04585442319512367, mean p set: 0.45274418592453003
loss_pred:0.016784468665719032, decouple_loss:0.002097667194902897
The modified gen p mean: 0.4505062401294708, gen p mean: -0.046197570860385895, mean p set: 0.45098650455474854The modified gen p mean: 0.4512425363063812, gen p mean: -0.04859178885817528, mean p set: 0.4517228305339813
loss_pred:0.016603639349341393, decouple_loss:0.002103606704622507
loss_pred:0.01823127456009388, decouple_loss:0.0021797341760247946
Iteration: 1573, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45160067081451416, gen p mean: -0.040359076112508774, mean p set: 0.45208099484443665
loss_pred:0.017591966316103935, decouple_loss:0.0019994485192000866
The modified gen p mean: 0.45239225029945374, gen p mean: -0.046134963631629944, mean p set: 0.45287254452705383The modified gen p mean: 0.4538593888282776, gen p mean: -0.04692680016160011, mean p set: 0.4543396830558777
loss_pred:0.017543641850352287, decouple_loss:0.0020234088879078627
loss_pred:0.0177131537348032, decouple_loss:0.0021383215207606554
Iteration: 1574, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4534396529197693, gen p mean: -0.04654192179441452, mean p set: 0.4539199471473694
loss_pred:0.01664375141263008, decouple_loss:0.0021320751402527094
The modified gen p mean: 0.4516028165817261, gen p mean: -0.03637802228331566, mean p set: 0.4520830810070038The modified gen p mean: 0.4506503641605377, gen p mean: -0.043379027396440506, mean p set: 0.4511306881904602
loss_pred:0.0171269029378891, decouple_loss:0.0020766269881278276
loss_pred:0.017819415777921677, decouple_loss:0.002175025874748826
Iteration: 1575, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4516121447086334, gen p mean: -0.041234977543354034, mean p set: 0.45209240913391113
loss_pred:0.017181016504764557, decouple_loss:0.0018428163602948189
The modified gen p mean: 0.4505658447742462, gen p mean: -0.040935225784778595, mean p set: 0.4510461390018463The modified gen p mean: 0.45070749521255493, gen p mean: -0.044564660638570786, mean p set: 0.45118778944015503
loss_pred:0.01837894134223461, decouple_loss:0.0019671828486025333
loss_pred:0.01726534776389599, decouple_loss:0.0020443296525627375
Iteration: 1576, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45154112577438354, gen p mean: -0.038419876247644424, mean p set: 0.45202142000198364
loss_pred:0.018134796991944313, decouple_loss:0.0022514071315526962
The modified gen p mean: 0.45178744196891785, gen p mean: -0.043198712170124054, mean p set: 0.45226770639419556The modified gen p mean: 0.4506472647190094, gen p mean: -0.036352913826704025, mean p set: 0.4511275291442871
loss_pred:0.01676577515900135, decouple_loss:0.0022869587410241365
loss_pred:0.018348898738622665, decouple_loss:0.002135203219950199
Iteration: 1577, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4522643983364105, gen p mean: -0.04282423481345177, mean p set: 0.45274466276168823
loss_pred:0.017965877428650856, decouple_loss:0.0021496950648725033
The modified gen p mean: 0.4532765746116638, gen p mean: -0.0504261814057827, mean p set: 0.4537568688392639The modified gen p mean: 0.45270445942878723, gen p mean: -0.04823287948966026, mean p set: 0.45318475365638733
loss_pred:0.01636183261871338, decouple_loss:0.00210758694447577
loss_pred:0.016749372705817223, decouple_loss:0.0019514531595632434
Iteration: 1578, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511440396308899, gen p mean: -0.04846775159239769, mean p set: 0.45162433385849
loss_pred:0.01794845424592495, decouple_loss:0.0018649958074092865
The modified gen p mean: 0.45244085788726807, gen p mean: -0.037546537816524506, mean p set: 0.45292118191719055
The modified gen p mean: 0.4507308900356293, gen p mean: -0.04053601995110512, mean p set: 0.45121118426322937
loss_pred:0.017825482413172722, decouple_loss:0.001777003169991076
loss_pred:0.017779435962438583, decouple_loss:0.0020627090707421303
Iteration: 1579, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45206692814826965, gen p mean: -0.047822702676057816, mean p set: 0.45254722237586975
loss_pred:0.016678310930728912, decouple_loss:0.0018581536132842302
The modified gen p mean: 0.4502146244049072, gen p mean: -0.045904263854026794, mean p set: 0.4506949186325073The modified gen p mean: 0.44989460706710815, gen p mean: -0.04937834292650223, mean p set: 0.45037490129470825
loss_pred:0.018049608916044235, decouple_loss:0.0018198626348748803
loss_pred:0.01779480278491974, decouple_loss:0.0018056852277368307
Iteration: 1580, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4525543451309204, gen p mean: -0.05476561188697815, mean p set: 0.4530346095561981
loss_pred:0.016881242394447327, decouple_loss:0.001695459010079503
The modified gen p mean: 0.4510784447193146, gen p mean: -0.04678647592663765, mean p set: 0.4515587389469147The modified gen p mean: 0.45204421877861023, gen p mean: -0.04746534302830696, mean p set: 0.4525245428085327
loss_pred:0.017561964690685272, decouple_loss:0.001670363824814558
loss_pred:0.016419045627117157, decouple_loss:0.0017130784690380096
2023-05-02 08:36:47 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.0565730445086956, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04959340766072273, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.051045335829257965, mean p set: 0.4500633478164673
loss_pred:0.01925906166434288, decouple_loss:0.0022061725612729788
loss_pred:0.018121544271707535, decouple_loss:0.0021731064189225435
loss_pred:0.01841273345053196, decouple_loss:0.0021694297902286053
WV_0_PC_1_EH_0_PS_40, loss: 0.018706925213336945, avg_mse: 0.026537524536252022
current test mse: 0.026538
Iteration: 1581, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45174500346183777, gen p mean: -0.04177935793995857, mean p set: 0.45222529768943787
The modified gen p mean: 0.45160356163978577, gen p mean: -0.044767044484615326, mean p set: 0.4520838260650635
The modified gen p mean: 0.45175787806510925, gen p mean: -0.04850693419575691, mean p set: 0.45223820209503174
loss_pred:0.017481032758951187, decouple_loss:0.0016568033024668694
loss_pred:0.01796620339155197, decouple_loss:0.0017264018533751369
loss_pred:0.017266778275370598, decouple_loss:0.0016825249185785651
Iteration: 1582, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4519716203212738, gen p mean: -0.03869865834712982, mean p set: 0.4524519443511963
loss_pred:0.017910940572619438, decouple_loss:0.0017974574584513903
The modified gen p mean: 0.4513789713382721, gen p mean: -0.037534378468990326, mean p set: 0.4518592655658722The modified gen p mean: 0.4514380693435669, gen p mean: -0.04761886969208717, mean p set: 0.451918363571167
loss_pred:0.016682667657732964, decouple_loss:0.0017309203976765275
loss_pred:0.01809251867234707, decouple_loss:0.0017472318140789866
Iteration: 1583, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4512234926223755, gen p mean: -0.04023437574505806, mean p set: 0.4517037868499756
loss_pred:0.017965851351618767, decouple_loss:0.0016387909417971969
The modified gen p mean: 0.4525368809700012, gen p mean: -0.0405532531440258, mean p set: 0.45301714539527893The modified gen p mean: 0.45112621784210205, gen p mean: -0.03856375068426132, mean p set: 0.45160651206970215
loss_pred:0.017488857731223106, decouple_loss:0.0017191992374137044
loss_pred:0.01788635365664959, decouple_loss:0.0016206775326281786
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012012_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012012_3_24hr.npz
NaN value num: 0
Iteration: 1584, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471989572048187, gen p mean: -0.05470900610089302, mean p set: 0.4476792514324188
loss_pred:0.0188516266644001, decouple_loss:0.002367990091443062
The modified gen p mean: 0.44697442650794983, gen p mean: -0.050548993051052094, mean p set: 0.4474547207355499The modified gen p mean: 0.44820907711982727, gen p mean: -0.04265844449400902, mean p set: 0.448689341545105
loss_pred:0.017974501475691795, decouple_loss:0.0028918327298015356
loss_pred:0.01758337765932083, decouple_loss:0.002280235756188631
Iteration: 1585, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44721081852912903, gen p mean: -0.04557681456208229, mean p set: 0.4476911425590515
loss_pred:0.018159326165914536, decouple_loss:0.001989553915336728
The modified gen p mean: 0.44757914543151855, gen p mean: -0.04962277412414551, mean p set: 0.44805940985679626The modified gen p mean: 0.44743895530700684, gen p mean: -0.050137393176555634, mean p set: 0.44791924953460693
loss_pred:0.01842714659869671, decouple_loss:0.002031621988862753
loss_pred:0.01824203133583069, decouple_loss:0.002217654837295413
Iteration: 1586, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44688481092453003, gen p mean: -0.045974455773830414, mean p set: 0.4473651349544525
loss_pred:0.017893515527248383, decouple_loss:0.00211159186437726
The modified gen p mean: 0.44799524545669556, gen p mean: -0.04798514023423195, mean p set: 0.44847550988197327The modified gen p mean: 0.44848814606666565, gen p mean: -0.04483422636985779, mean p set: 0.4489684998989105
loss_pred:0.018184641376137733, decouple_loss:0.002347337082028389
loss_pred:0.01781715638935566, decouple_loss:0.00208756560459733
Iteration: 1587, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44812196493148804, gen p mean: -0.049242425709962845, mean p set: 0.44860225915908813
loss_pred:0.018652761355042458, decouple_loss:0.002132625551894307
The modified gen p mean: 0.4482465386390686, gen p mean: -0.04920836538076401, mean p set: 0.4487268626689911The modified gen p mean: 0.44805577397346497, gen p mean: -0.049675650894641876, mean p set: 0.44853606820106506
loss_pred:0.018104828894138336, decouple_loss:0.002034589182585478
loss_pred:0.01790785789489746, decouple_loss:0.002115996554493904
Iteration: 1588, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447120726108551, gen p mean: -0.04950665310025215, mean p set: 0.4476010203361511
loss_pred:0.017765341326594353, decouple_loss:0.0018103549955412745
The modified gen p mean: 0.4468125104904175, gen p mean: -0.05313655361533165, mean p set: 0.4472928047180176The modified gen p mean: 0.4469181001186371, gen p mean: -0.05090885981917381, mean p set: 0.4473983943462372
loss_pred:0.01886146329343319, decouple_loss:0.0019063429208472371
loss_pred:0.017579976469278336, decouple_loss:0.0016907178796827793
Iteration: 1589, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477062225341797, gen p mean: -0.0470414012670517, mean p set: 0.4481865465641022
loss_pred:0.017394274473190308, decouple_loss:0.0016287576872855425
The modified gen p mean: 0.44717904925346375, gen p mean: -0.04598146304488182, mean p set: 0.44765937328338623
The modified gen p mean: 0.44690123200416565, gen p mean: -0.05062186345458031, mean p set: 0.44738152623176575
loss_pred:0.017540082335472107, decouple_loss:0.0018315217457711697
loss_pred:0.018560538068413734, decouple_loss:0.001789065427146852
Iteration: 1590, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472615420818329, gen p mean: -0.05740278214216232, mean p set: 0.447741836309433
loss_pred:0.01810603402554989, decouple_loss:0.002048287307843566
The modified gen p mean: 0.447712779045105, gen p mean: -0.05232059210538864, mean p set: 0.4481930732727051The modified gen p mean: 0.4474490284919739, gen p mean: -0.055848293006420135, mean p set: 0.4479292929172516
loss_pred:0.018389008939266205, decouple_loss:0.0019550747238099575
loss_pred:0.017681341618299484, decouple_loss:0.002331097610294819
2023-05-02 08:39:15 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.05573951080441475, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.047898244112730026, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.049611642956733704, mean p set: 0.4500633478164673
loss_pred:0.01889020949602127, decouple_loss:0.0017975447699427605
loss_pred:0.01789596863090992, decouple_loss:0.0016382609028369188
loss_pred:0.018078749999403954, decouple_loss:0.0016458930913358927
WV_0_PC_1_EH_0_PS_40, loss: 0.018373005092144012, avg_mse: 0.026082973927259445
current test mse: 0.026083
Iteration: 1591, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481102526187897, gen p mean: -0.056528106331825256, mean p set: 0.44859054684638977
The modified gen p mean: 0.4467247426509857, gen p mean: -0.05390501767396927, mean p set: 0.4472050368785858
The modified gen p mean: 0.4471152424812317, gen p mean: -0.05210554227232933, mean p set: 0.4475955367088318
loss_pred:0.016950491815805435, decouple_loss:0.0016800779849290848
loss_pred:0.01803559809923172, decouple_loss:0.0016919554909691215
loss_pred:0.018594959750771523, decouple_loss:0.001656541135162115
Iteration: 1592, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475243091583252, gen p mean: -0.04996012523770332, mean p set: 0.4480046033859253
loss_pred:0.01760859042406082, decouple_loss:0.00210942211560905
The modified gen p mean: 0.4461824595928192, gen p mean: -0.053914133459329605, mean p set: 0.4466627538204193The modified gen p mean: 0.4468170702457428, gen p mean: -0.055383067578077316, mean p set: 0.4472973346710205
loss_pred:0.01765589602291584, decouple_loss:0.0020511667244136333
loss_pred:0.018705714493989944, decouple_loss:0.001919517875649035
Iteration: 1593, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44835320115089417, gen p mean: -0.05476287379860878, mean p set: 0.44883349537849426
loss_pred:0.01748272404074669, decouple_loss:0.0018959809094667435
The modified gen p mean: 0.44686359167099, gen p mean: -0.05362994968891144, mean p set: 0.4473438560962677The modified gen p mean: 0.44602862000465393, gen p mean: -0.05008062347769737, mean p set: 0.44650891423225403
loss_pred:0.01819043979048729, decouple_loss:0.001913033309392631
loss_pred:0.017414094880223274, decouple_loss:0.0018238839693367481
Iteration: 1594, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44788414239883423, gen p mean: -0.04733620584011078, mean p set: 0.4483644366264343
loss_pred:0.017262475565075874, decouple_loss:0.001699037617072463
The modified gen p mean: 0.4466514587402344, gen p mean: -0.045908354222774506, mean p set: 0.4471317529678345The modified gen p mean: 0.44804710149765015, gen p mean: -0.04695070907473564, mean p set: 0.44852742552757263
loss_pred:0.01867605932056904, decouple_loss:0.001537688192911446
loss_pred:0.018697194755077362, decouple_loss:0.0016282628057524562
Iteration: 1595, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44798991084098816, gen p mean: -0.04172834753990173, mean p set: 0.44847017526626587
loss_pred:0.017507512122392654, decouple_loss:0.0017051055328920484
The modified gen p mean: 0.44822704792022705, gen p mean: -0.03969864919781685, mean p set: 0.44870737195014954The modified gen p mean: 0.44696685671806335, gen p mean: -0.04403330385684967, mean p set: 0.44744715094566345
loss_pred:0.01737087592482567, decouple_loss:0.0017988430336117744
loss_pred:0.018403958529233932, decouple_loss:0.0017490603495389223
Iteration: 1596, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44801080226898193, gen p mean: -0.042442288249731064, mean p set: 0.44849109649658203
loss_pred:0.01759050227701664, decouple_loss:0.00152445281855762
The modified gen p mean: 0.4484855830669403, gen p mean: -0.04463614523410797, mean p set: 0.4489658772945404The modified gen p mean: 0.44729796051979065, gen p mean: -0.0444011464715004, mean p set: 0.44777825474739075
loss_pred:0.018335118889808655, decouple_loss:0.0016652316553518176
loss_pred:0.018168454989790916, decouple_loss:0.001551456400193274
Iteration: 1597, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44743624329566956, gen p mean: -0.0421757847070694, mean p set: 0.44791650772094727
loss_pred:0.01767636463046074, decouple_loss:0.00162219547200948
The modified gen p mean: 0.4474271237850189, gen p mean: -0.03849630430340767, mean p set: 0.44790738821029663The modified gen p mean: 0.4473952651023865, gen p mean: -0.03960970789194107, mean p set: 0.4478755593299866
loss_pred:0.017473626881837845, decouple_loss:0.0016123242676258087
loss_pred:0.017200442031025887, decouple_loss:0.0015766287688165903
Iteration: 1598, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474976360797882, gen p mean: -0.04346071183681488, mean p set: 0.4479779005050659
loss_pred:0.018714992329478264, decouple_loss:0.001749696210026741
The modified gen p mean: 0.44837939739227295, gen p mean: -0.04195162281394005, mean p set: 0.44885969161987305The modified gen p mean: 0.44496357440948486, gen p mean: -0.03922949731349945, mean p set: 0.4454438388347626
loss_pred:0.017590222880244255, decouple_loss:0.0015191087732091546
loss_pred:0.018058784306049347, decouple_loss:0.0015560113824903965
Iteration: 1599, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476768970489502, gen p mean: -0.04793943092226982, mean p set: 0.4481572210788727
loss_pred:0.018379531800746918, decouple_loss:0.001425312366336584
The modified gen p mean: 0.44724637269973755, gen p mean: -0.0431646928191185, mean p set: 0.44772669672966003The modified gen p mean: 0.4483972191810608, gen p mean: -0.05131658911705017, mean p set: 0.4488775134086609
loss_pred:0.0173353124409914, decouple_loss:0.0013941481010988355
loss_pred:0.017622502520680428, decouple_loss:0.0015156830195337534
Iteration: 1600, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467393159866333, gen p mean: -0.05159775912761688, mean p set: 0.4472196698188782
loss_pred:0.017420070245862007, decouple_loss:0.00141666189301759
The modified gen p mean: 0.4472980797290802, gen p mean: -0.05580020323395729, mean p set: 0.4477783739566803The modified gen p mean: 0.4466222822666168, gen p mean: -0.05026274546980858, mean p set: 0.44710254669189453
loss_pred:0.018677782267332077, decouple_loss:0.0016933507286012173
loss_pred:0.018392568454146385, decouple_loss:0.0015186002710834146
2023-05-02 08:41:09 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.05363335460424423, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.046064622700214386, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.04801218956708908, mean p set: 0.4500633478164673
loss_pred:0.018731897696852684, decouple_loss:0.0015058827120810747
loss_pred:0.017711976543068886, decouple_loss:0.0016038221074268222
loss_pred:0.017910674214363098, decouple_loss:0.001514745526947081
WV_0_PC_1_EH_0_PS_40, loss: 0.0181952565908432, avg_mse: 0.02585824392735958
current test mse: 0.025858
Iteration: 1601, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44732797145843506, gen p mean: -0.047367509454488754, mean p set: 0.44780823588371277
The modified gen p mean: 0.44450643658638, gen p mean: -0.04610171169042587, mean p set: 0.4449867010116577
The modified gen p mean: 0.4465027153491974, gen p mean: -0.04521530494093895, mean p set: 0.4469830095767975
loss_pred:0.01805007830262184, decouple_loss:0.001623496413230896
loss_pred:0.017169222235679626, decouple_loss:0.0014657141873613
loss_pred:0.01830223947763443, decouple_loss:0.001780213788151741
Iteration: 1602, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44446447491645813, gen p mean: -0.046336062252521515, mean p set: 0.4449447691440582
loss_pred:0.018493765965104103, decouple_loss:0.0017044908599928021
The modified gen p mean: 0.44686487317085266, gen p mean: -0.05088764801621437, mean p set: 0.44734519720077515The modified gen p mean: 0.44554173946380615, gen p mean: -0.04983600974082947, mean p set: 0.44602203369140625
loss_pred:0.01800335943698883, decouple_loss:0.0015896421391516924
loss_pred:0.01793847419321537, decouple_loss:0.0017299280734732747
Iteration: 1603, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476078748703003, gen p mean: -0.04871645197272301, mean p set: 0.4480881989002228
loss_pred:0.01719166897237301, decouple_loss:0.0017342872451990843
The modified gen p mean: 0.4471440017223358, gen p mean: -0.050334859639406204, mean p set: 0.4476243257522583The modified gen p mean: 0.4448031783103943, gen p mean: -0.04975953698158264, mean p set: 0.4452835023403168
loss_pred:0.01812082715332508, decouple_loss:0.0015027659246698022
loss_pred:0.018392575904726982, decouple_loss:0.0015509611694142222
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012020_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012020_3_24hr.npz
NaN value num: 0
Iteration: 1604, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45273497700691223, gen p mean: -0.040992844849824905, mean p set: 0.4532153010368347
loss_pred:0.018093859776854515, decouple_loss:0.0018558434676378965
The modified gen p mean: 0.4542893171310425, gen p mean: -0.03990470618009567, mean p set: 0.45476964116096497The modified gen p mean: 0.45358502864837646, gen p mean: -0.04210314527153969, mean p set: 0.45406532287597656
loss_pred:0.017249450087547302, decouple_loss:0.001551052206195891
loss_pred:0.017021339386701584, decouple_loss:0.0016468989197164774
Iteration: 1605, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45453307032585144, gen p mean: -0.03886350989341736, mean p set: 0.45501336455345154
loss_pred:0.017322339117527008, decouple_loss:0.001597519963979721
The modified gen p mean: 0.4537821114063263, gen p mean: -0.03801973909139633, mean p set: 0.4542624056339264The modified gen p mean: 0.45215287804603577, gen p mean: -0.03471110016107559, mean p set: 0.45263317227363586
loss_pred:0.018044356256723404, decouple_loss:0.0018687391420826316
loss_pred:0.01733325608074665, decouple_loss:0.0015939524164423347
Iteration: 1606, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4539887309074402, gen p mean: -0.03722308203577995, mean p set: 0.4544689953327179
loss_pred:0.01725519448518753, decouple_loss:0.0016311610816046596
The modified gen p mean: 0.45294082164764404, gen p mean: -0.03861486166715622, mean p set: 0.45342111587524414The modified gen p mean: 0.45216551423072815, gen p mean: -0.035004835575819016, mean p set: 0.45264583826065063
loss_pred:0.017299052327871323, decouple_loss:0.0015972338151186705
loss_pred:0.016836218535900116, decouple_loss:0.0015504584880545735
Iteration: 1607, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4522591829299927, gen p mean: -0.03630586341023445, mean p set: 0.4527394771575928
The modified gen p mean: 0.45247185230255127, gen p mean: -0.035528894513845444, mean p set: 0.452952116727829
loss_pred:0.01773820072412491, decouple_loss:0.0014772386057302356
loss_pred:0.01781470701098442, decouple_loss:0.0015145677607506514
The modified gen p mean: 0.4514142572879791, gen p mean: -0.0322946161031723, mean p set: 0.4518945813179016
loss_pred:0.01803336851298809, decouple_loss:0.0015130873071029782
Iteration: 1608, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4526561498641968, gen p mean: -0.029748594388365746, mean p set: 0.4531364440917969
The modified gen p mean: 0.4542848467826843, gen p mean: -0.03631935641169548, mean p set: 0.4547651410102844
loss_pred:0.017997216433286667, decouple_loss:0.0015875408425927162
loss_pred:0.01704327017068863, decouple_loss:0.0016075996682047844
The modified gen p mean: 0.45335814356803894, gen p mean: -0.03548151254653931, mean p set: 0.45383843779563904
loss_pred:0.017307069152593613, decouple_loss:0.0014091513585299253
Iteration: 1609, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45424720644950867, gen p mean: -0.036888036876916885, mean p set: 0.45472750067710876
loss_pred:0.016639942303299904, decouple_loss:0.001424059853889048
The modified gen p mean: 0.4532047510147095, gen p mean: -0.03655346482992172, mean p set: 0.45368504524230957The modified gen p mean: 0.4537462890148163, gen p mean: -0.0361543707549572, mean p set: 0.4542265832424164
loss_pred:0.01809007301926613, decouple_loss:0.001463182969018817
loss_pred:0.01718401536345482, decouple_loss:0.001513517927378416
Iteration: 1610, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45326536893844604, gen p mean: -0.03832259774208069, mean p set: 0.45374566316604614
loss_pred:0.01719582825899124, decouple_loss:0.0015068083303049207
The modified gen p mean: 0.45330193638801575, gen p mean: -0.03424747660756111, mean p set: 0.45378226041793823The modified gen p mean: 0.45327383279800415, gen p mean: -0.03868887946009636, mean p set: 0.45375412702560425
loss_pred:0.01717413403093815, decouple_loss:0.0016013631829991937
loss_pred:0.017037317156791687, decouple_loss:0.0016347378259524703
2023-05-02 08:43:46 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.053082048892974854, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04536940157413483, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.04851076751947403, mean p set: 0.4500633478164673
loss_pred:0.019014546647667885, decouple_loss:0.0018497593700885773
loss_pred:0.01811431534588337, decouple_loss:0.0018115413840860128
loss_pred:0.0180997122079134, decouple_loss:0.0016565975965932012
WV_0_PC_1_EH_0_PS_40, loss: 0.01849815621972084, avg_mse: 0.02645397000014782
current test mse: 0.026454
Iteration: 1611, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45152685046195984, gen p mean: -0.033263906836509705, mean p set: 0.45200714468955994
The modified gen p mean: 0.4531184434890747, gen p mean: -0.03990168496966362, mean p set: 0.4535987377166748
The modified gen p mean: 0.4509071409702301, gen p mean: -0.03242866322398186, mean p set: 0.4513874351978302
loss_pred:0.01723642647266388, decouple_loss:0.0014448194997385144
loss_pred:0.0164638739079237, decouple_loss:0.0013278675032779574
loss_pred:0.017891045659780502, decouple_loss:0.0013738375855609775
Iteration: 1612, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45392748713493347, gen p mean: -0.037121985107660294, mean p set: 0.45440778136253357
loss_pred:0.017043957486748695, decouple_loss:0.0014108868781477213
The modified gen p mean: 0.45172128081321716, gen p mean: -0.03663017600774765, mean p set: 0.4522015452384949The modified gen p mean: 0.45223119854927063, gen p mean: -0.043254535645246506, mean p set: 0.4527115225791931
loss_pred:0.017513979226350784, decouple_loss:0.0014845652040094137
loss_pred:0.01703241467475891, decouple_loss:0.0013675112277269363
Iteration: 1613, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511502683162689, gen p mean: -0.03276338055729866, mean p set: 0.4516305923461914
loss_pred:0.018047474324703217, decouple_loss:0.0014911816688254476
The modified gen p mean: 0.4520069360733032, gen p mean: -0.03365354239940643, mean p set: 0.4524872601032257The modified gen p mean: 0.453517884016037, gen p mean: -0.03497559204697609, mean p set: 0.4539981782436371
loss_pred:0.016813240945339203, decouple_loss:0.0015630788402631879
loss_pred:0.01701362431049347, decouple_loss:0.00150844338349998
Iteration: 1614, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4526360332965851, gen p mean: -0.03698355704545975, mean p set: 0.4531163275241852
loss_pred:0.01703765243291855, decouple_loss:0.0014237784780561924
The modified gen p mean: 0.4521391689777374, gen p mean: -0.03839779272675514, mean p set: 0.45261943340301514The modified gen p mean: 0.45353010296821594, gen p mean: -0.03581588342785835, mean p set: 0.45401036739349365
loss_pred:0.01744665391743183, decouple_loss:0.0016017163870856166
loss_pred:0.016940923407673836, decouple_loss:0.00143969408236444
Iteration: 1615, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45377692580223083, gen p mean: -0.03832511231303215, mean p set: 0.45425722002983093
loss_pred:0.017058873549103737, decouple_loss:0.0014312145067378879
The modified gen p mean: 0.4523431360721588, gen p mean: -0.03661537915468216, mean p set: 0.4528234302997589The modified gen p mean: 0.4526059925556183, gen p mean: -0.04006212204694748, mean p set: 0.453086256980896
loss_pred:0.017689354717731476, decouple_loss:0.0015515686245635152
loss_pred:0.017408447340130806, decouple_loss:0.0015364729333668947
Iteration: 1616, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45242059230804443, gen p mean: -0.03818250447511673, mean p set: 0.45290088653564453
loss_pred:0.01752702333033085, decouple_loss:0.0015147188678383827
The modified gen p mean: 0.45457717776298523, gen p mean: -0.04104208946228027, mean p set: 0.4550575017929077The modified gen p mean: 0.45212578773498535, gen p mean: -0.03871165215969086, mean p set: 0.45260608196258545
loss_pred:0.017246881499886513, decouple_loss:0.001631400315091014
loss_pred:0.01772085204720497, decouple_loss:0.001676398329436779
Iteration: 1617, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45371973514556885, gen p mean: -0.044480565935373306, mean p set: 0.45420005917549133
loss_pred:0.01646364852786064, decouple_loss:0.0013985881814733148
The modified gen p mean: 0.4533141255378723, gen p mean: -0.04346644878387451, mean p set: 0.4537944197654724The modified gen p mean: 0.4530980587005615, gen p mean: -0.04177020862698555, mean p set: 0.4535783529281616
loss_pred:0.017135731875896454, decouple_loss:0.0013216125080361962
loss_pred:0.01667880266904831, decouple_loss:0.0013227981980890036
Iteration: 1618, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4510022699832916, gen p mean: -0.04492130130529404, mean p set: 0.4514826238155365
loss_pred:0.01703338511288166, decouple_loss:0.001359836314804852
The modified gen p mean: 0.4529957175254822, gen p mean: -0.047829873859882355, mean p set: 0.4534760117530823The modified gen p mean: 0.452199250459671, gen p mean: -0.05021674558520317, mean p set: 0.4526795446872711
loss_pred:0.017071308568120003, decouple_loss:0.001518579781986773
loss_pred:0.017396850511431694, decouple_loss:0.0013428437523543835
Iteration: 1619, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4533783197402954, gen p mean: -0.048690397292375565, mean p set: 0.4538586437702179
loss_pred:0.016887307167053223, decouple_loss:0.0013540799263864756
The modified gen p mean: 0.45261460542678833, gen p mean: -0.051191139966249466, mean p set: 0.4530949294567108The modified gen p mean: 0.45269808173179626, gen p mean: -0.04727625846862793, mean p set: 0.45317837595939636
loss_pred:0.01698332652449608, decouple_loss:0.0012641907669603825
loss_pred:0.017187533900141716, decouple_loss:0.001308171427808702
Iteration: 1620, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45162105560302734, gen p mean: -0.044992487877607346, mean p set: 0.45210132002830505
loss_pred:0.01705065928399563, decouple_loss:0.0013885603984817863
The modified gen p mean: 0.45416200160980225, gen p mean: -0.04618438705801964, mean p set: 0.45464229583740234The modified gen p mean: 0.4525827467441559, gen p mean: -0.042640846222639084, mean p set: 0.45306307077407837
loss_pred:0.016757259145379066, decouple_loss:0.0015456086257472634
loss_pred:0.017141122370958328, decouple_loss:0.0012488608481362462
2023-05-02 08:45:41 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.061033982783555984, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.05168762803077698, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.055997084826231, mean p set: 0.4500633478164673
loss_pred:0.018987130373716354, decouple_loss:0.0017638970166444778
loss_pred:0.018131904304027557, decouple_loss:0.0017080873949453235
loss_pred:0.018162209540605545, decouple_loss:0.001647539553232491
WV_0_PC_1_EH_0_PS_40, loss: 0.018512407317757607, avg_mse: 0.026496294885873795
current test mse: 0.026496
Iteration: 1621, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4521203637123108, gen p mean: -0.042820677161216736, mean p set: 0.4526006579399109
The modified gen p mean: 0.45208877325057983, gen p mean: -0.0464320182800293, mean p set: 0.45256906747817993The modified gen p mean: 0.4539163112640381, gen p mean: -0.04427235946059227, mean p set: 0.45439663529396057
loss_pred:0.016489537432789803, decouple_loss:0.0013574587646871805
loss_pred:0.01740172691643238, decouple_loss:0.0013934081653133035
loss_pred:0.017482830211520195, decouple_loss:0.0013942373916506767
Iteration: 1622, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45180827379226685, gen p mean: -0.04361768439412117, mean p set: 0.45228859782218933
loss_pred:0.017413249239325523, decouple_loss:0.0012689721770584583
The modified gen p mean: 0.4530690610408783, gen p mean: -0.03970765322446823, mean p set: 0.4535493850708008The modified gen p mean: 0.4529549181461334, gen p mean: -0.03912933170795441, mean p set: 0.4534352123737335
loss_pred:0.01691376231610775, decouple_loss:0.0014373098965734243
loss_pred:0.017447054386138916, decouple_loss:0.0014061619294807315
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012009_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012009_3_24hr.npz
NaN value num: 0
Iteration: 1623, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44789427518844604, gen p mean: -0.042323123663663864, mean p set: 0.44837456941604614
loss_pred:0.016490833833813667, decouple_loss:0.0015838214894756675
The modified gen p mean: 0.44974711537361145, gen p mean: -0.05155887454748154, mean p set: 0.45022737979888916The modified gen p mean: 0.4483877420425415, gen p mean: -0.055495865643024445, mean p set: 0.4488680362701416
loss_pred:0.017190126702189445, decouple_loss:0.001633514417335391
loss_pred:0.01649831421673298, decouple_loss:0.0016467607347294688
Iteration: 1624, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492068290710449, gen p mean: -0.046970512717962265, mean p set: 0.449687123298645
loss_pred:0.01693035662174225, decouple_loss:0.0017358518671244383
The modified gen p mean: 0.4499039649963379, gen p mean: -0.04388685151934624, mean p set: 0.4503842294216156The modified gen p mean: 0.4464895725250244, gen p mean: -0.04747823253273964, mean p set: 0.4469698667526245
loss_pred:0.016963455826044083, decouple_loss:0.0016263688448816538
loss_pred:0.01661568321287632, decouple_loss:0.001788479508832097
Iteration: 1625, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481106400489807, gen p mean: -0.042508453130722046, mean p set: 0.4485909342765808
loss_pred:0.017004340887069702, decouple_loss:0.0015785295981913805
The modified gen p mean: 0.44880861043930054, gen p mean: -0.047900788486003876, mean p set: 0.449288934469223The modified gen p mean: 0.4475764036178589, gen p mean: -0.0427994579076767, mean p set: 0.448056697845459
loss_pred:0.01664590649306774, decouple_loss:0.001608787919394672
loss_pred:0.01623125933110714, decouple_loss:0.0015174599830061197
Iteration: 1626, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491627514362335, gen p mean: -0.04999277740716934, mean p set: 0.44964301586151123
loss_pred:0.01671227253973484, decouple_loss:0.0015573992859572172
The modified gen p mean: 0.44935813546180725, gen p mean: -0.05366884917020798, mean p set: 0.44983842968940735The modified gen p mean: 0.4472452998161316, gen p mean: -0.04429515078663826, mean p set: 0.4477255642414093
loss_pred:0.016895409673452377, decouple_loss:0.001620263559743762
loss_pred:0.01616824045777321, decouple_loss:0.0016181680839508772
Iteration: 1627, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501529335975647, gen p mean: -0.0464106947183609, mean p set: 0.4506332576274872
loss_pred:0.015483721159398556, decouple_loss:0.0018274399917572737
The modified gen p mean: 0.44998177886009216, gen p mean: -0.04656486585736275, mean p set: 0.45046207308769226The modified gen p mean: 0.4504079520702362, gen p mean: -0.04731648042798042, mean p set: 0.4508882462978363
loss_pred:0.015827970579266548, decouple_loss:0.0017760545015335083
loss_pred:0.01592135615646839, decouple_loss:0.0017453200416639447
Iteration: 1628, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478687345981598, gen p mean: -0.048718228936195374, mean p set: 0.4483490288257599
loss_pred:0.016149451956152916, decouple_loss:0.001744154840707779
The modified gen p mean: 0.44662219285964966, gen p mean: -0.05346500501036644, mean p set: 0.44710251688957214
The modified gen p mean: 0.4484628736972809, gen p mean: -0.0512041375041008, mean p set: 0.448943167924881
loss_pred:0.01588955894112587, decouple_loss:0.0017599092097952962
loss_pred:0.01605420745909214, decouple_loss:0.0015061110025271773
Iteration: 1629, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44856056571006775, gen p mean: -0.056214045733213425, mean p set: 0.44904085993766785
loss_pred:0.015816044062376022, decouple_loss:0.001688191550783813
The modified gen p mean: 0.44848164916038513, gen p mean: -0.05544831603765488, mean p set: 0.44896194338798523The modified gen p mean: 0.4502018690109253, gen p mean: -0.04697396606206894, mean p set: 0.450682133436203
loss_pred:0.01613904908299446, decouple_loss:0.0017800279892981052
loss_pred:0.016368357464671135, decouple_loss:0.0017688308143988252
Iteration: 1630, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44850537180900574, gen p mean: -0.05048668384552002, mean p set: 0.44898566603660583
loss_pred:0.01573682203888893, decouple_loss:0.0018550865352153778
The modified gen p mean: 0.44852960109710693, gen p mean: -0.0451139360666275, mean p set: 0.44900989532470703The modified gen p mean: 0.4480966627597809, gen p mean: -0.04748879373073578, mean p set: 0.4485769271850586
loss_pred:0.0162336565554142, decouple_loss:0.001650076126679778
loss_pred:0.01593737304210663, decouple_loss:0.0016126279952004552
2023-05-02 08:48:10 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.05523116886615753, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04879807308316231, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04990100860595703, mean p set: 0.4500633478164673
loss_pred:0.018936054781079292, decouple_loss:0.0019464697688817978
loss_pred:0.017963798716664314, decouple_loss:0.0019291216740384698
loss_pred:0.01818455383181572, decouple_loss:0.0018847077153623104
WV_0_PC_1_EH_0_PS_40, loss: 0.018457474187016487, avg_mse: 0.02633928880095482
current test mse: 0.026339
Iteration: 1631, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495813846588135, gen p mean: -0.05167470499873161, mean p set: 0.4500616788864136
The modified gen p mean: 0.44869935512542725, gen p mean: -0.051004283130168915, mean p set: 0.44917967915534973
The modified gen p mean: 0.4473860263824463, gen p mean: -0.051923755556344986, mean p set: 0.4478663504123688
loss_pred:0.015449997037649155, decouple_loss:0.0018980716122314334
loss_pred:0.01613621972501278, decouple_loss:0.0017376616597175598
loss_pred:0.01579154282808304, decouple_loss:0.0017497693188488483
Iteration: 1632, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44981876015663147, gen p mean: -0.0506381019949913, mean p set: 0.45029905438423157
loss_pred:0.015639716759324074, decouple_loss:0.0016825213097035885
The modified gen p mean: 0.4477268159389496, gen p mean: -0.053417082875967026, mean p set: 0.44820713996887207The modified gen p mean: 0.4481542408466339, gen p mean: -0.04805528745055199, mean p set: 0.448634535074234
loss_pred:0.01587090827524662, decouple_loss:0.001680715591646731
loss_pred:0.016011971980333328, decouple_loss:0.0018333105836063623
Iteration: 1633, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44910913705825806, gen p mean: -0.049965452402830124, mean p set: 0.44958946108818054
loss_pred:0.01576046273112297, decouple_loss:0.0015869495691731572
The modified gen p mean: 0.4487565755844116, gen p mean: -0.04448957368731499, mean p set: 0.4492368996143341The modified gen p mean: 0.44854825735092163, gen p mean: -0.05209878832101822, mean p set: 0.44902855157852173
loss_pred:0.015789920464158058, decouple_loss:0.00159388966858387
loss_pred:0.015971647575497627, decouple_loss:0.001597980153746903
Iteration: 1634, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44772836565971375, gen p mean: -0.04929837957024574, mean p set: 0.44820865988731384
loss_pred:0.015965264290571213, decouple_loss:0.0017500246176496148
The modified gen p mean: 0.4494730532169342, gen p mean: -0.05139584094285965, mean p set: 0.4499533474445343The modified gen p mean: 0.4487477242946625, gen p mean: -0.05231606215238571, mean p set: 0.4492279887199402
loss_pred:0.01552818063646555, decouple_loss:0.0018167176749557257
loss_pred:0.015509276650846004, decouple_loss:0.0017971494235098362
Iteration: 1635, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491323232650757, gen p mean: -0.05190352350473404, mean p set: 0.4496126174926758
loss_pred:0.015251110307872295, decouple_loss:0.001796467462554574
The modified gen p mean: 0.44952392578125, gen p mean: -0.0552438348531723, mean p set: 0.4500042200088501The modified gen p mean: 0.44813576340675354, gen p mean: -0.04947736859321594, mean p set: 0.44861605763435364
loss_pred:0.015699362382292747, decouple_loss:0.0017347262473776937
loss_pred:0.015799975022673607, decouple_loss:0.0016456677112728357
Iteration: 1636, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493604004383087, gen p mean: -0.04905995354056358, mean p set: 0.4498407244682312
loss_pred:0.015520785935223103, decouple_loss:0.0014884750125929713
The modified gen p mean: 0.45015114545822144, gen p mean: -0.046794768422842026, mean p set: 0.45063140988349915The modified gen p mean: 0.44901955127716064, gen p mean: -0.05158321186900139, mean p set: 0.44949984550476074
loss_pred:0.01585494540631771, decouple_loss:0.001428917981684208
loss_pred:0.015309526585042477, decouple_loss:0.0014818899799138308
Iteration: 1637, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493992328643799, gen p mean: -0.051256418228149414, mean p set: 0.44987955689430237
loss_pred:0.0153996292501688, decouple_loss:0.001730281044729054
The modified gen p mean: 0.4491191506385803, gen p mean: -0.052567388862371445, mean p set: 0.4495994448661804The modified gen p mean: 0.44884318113327026, gen p mean: -0.05188650265336037, mean p set: 0.44932347536087036
loss_pred:0.015649817883968353, decouple_loss:0.0016371837118640542
loss_pred:0.01505552139133215, decouple_loss:0.0015399018302559853
Iteration: 1638, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448865681886673, gen p mean: -0.04956357926130295, mean p set: 0.4493459463119507
loss_pred:0.015698419883847237, decouple_loss:0.0016909484984353185
The modified gen p mean: 0.4497900903224945, gen p mean: -0.05002326890826225, mean p set: 0.4502703547477722The modified gen p mean: 0.4494432210922241, gen p mean: -0.04191992059350014, mean p set: 0.4499235153198242
loss_pred:0.015724152326583862, decouple_loss:0.001656882232055068
loss_pred:0.015801087021827698, decouple_loss:0.0014581106370314956
Iteration: 1639, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490791857242584, gen p mean: -0.04708416387438774, mean p set: 0.4495595097541809
loss_pred:0.015391606837511063, decouple_loss:0.0015991647960618138
The modified gen p mean: 0.44796690344810486, gen p mean: -0.04259635508060455, mean p set: 0.44844722747802734The modified gen p mean: 0.44927430152893066, gen p mean: -0.043870773166418076, mean p set: 0.44975459575653076
loss_pred:0.015624837949872017, decouple_loss:0.0016345903277397156
loss_pred:0.01523576769977808, decouple_loss:0.0015887842746451497
Iteration: 1640, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476395547389984, gen p mean: -0.046540603041648865, mean p set: 0.4481198489665985
loss_pred:0.015032944269478321, decouple_loss:0.0017487183213233948
The modified gen p mean: 0.4478866457939148, gen p mean: -0.04122127965092659, mean p set: 0.4483669102191925The modified gen p mean: 0.4481092393398285, gen p mean: -0.034870974719524384, mean p set: 0.4485895335674286
loss_pred:0.015421099960803986, decouple_loss:0.0014666903298348188
loss_pred:0.01512143760919571, decouple_loss:0.0015168070094659925
2023-05-02 08:50:05 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.04744112491607666, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04040929302573204, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04255184531211853, mean p set: 0.4500633478164673
loss_pred:0.019147569313645363, decouple_loss:0.0017448000144213438
loss_pred:0.018067101016640663, decouple_loss:0.0016132760792970657
loss_pred:0.018209751695394516, decouple_loss:0.001622196170501411
WV_0_PC_1_EH_0_PS_40, loss: 0.01855781301856041, avg_mse: 0.026659371331334114
current test mse: 0.026659
Iteration: 1641, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486571252346039, gen p mean: -0.04577964171767235, mean p set: 0.449137419462204
The modified gen p mean: 0.44897758960723877, gen p mean: -0.04380456358194351, mean p set: 0.44945788383483887
The modified gen p mean: 0.44882890582084656, gen p mean: -0.04330258443951607, mean p set: 0.44930922985076904
loss_pred:0.015376503579318523, decouple_loss:0.001670686062425375
loss_pred:0.01553464774042368, decouple_loss:0.0016533605521544814
loss_pred:0.01489058043807745, decouple_loss:0.0017712987028062344
Iteration: 1642, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493882358074188, gen p mean: -0.040329206734895706, mean p set: 0.4498685300350189
loss_pred:0.01540870126336813, decouple_loss:0.0016677012899890542
The modified gen p mean: 0.44888004660606384, gen p mean: -0.043482668697834015, mean p set: 0.44936034083366394The modified gen p mean: 0.4484004080295563, gen p mean: -0.03304016590118408, mean p set: 0.44888070225715637
loss_pred:0.015044949017465115, decouple_loss:0.0015621030470356345
loss_pred:0.014856145717203617, decouple_loss:0.0016402845503762364
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012020_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012020_3_24hr.npz
NaN value num: 0
Iteration: 1643, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45154711604118347, gen p mean: -0.033641885966062546, mean p set: 0.45202744007110596
loss_pred:0.01763180084526539, decouple_loss:0.001742098480463028
The modified gen p mean: 0.4515971839427948, gen p mean: -0.03961312770843506, mean p set: 0.4520774781703949The modified gen p mean: 0.4530668556690216, gen p mean: -0.04408901184797287, mean p set: 0.4535471498966217
loss_pred:0.017153505235910416, decouple_loss:0.0016025550430640578
loss_pred:0.01702485792338848, decouple_loss:0.0016154582845047116
Iteration: 1644, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4530324935913086, gen p mean: -0.034190837293863297, mean p set: 0.4535127878189087
loss_pred:0.01779884099960327, decouple_loss:0.0016634026542305946
The modified gen p mean: 0.4515398144721985, gen p mean: -0.033730968832969666, mean p set: 0.4520201086997986The modified gen p mean: 0.4519554674625397, gen p mean: -0.03403933718800545, mean p set: 0.45243576169013977
loss_pred:0.016823839396238327, decouple_loss:0.0016129495343193412
loss_pred:0.017813485115766525, decouple_loss:0.0016441363841295242
Iteration: 1645, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45123711228370667, gen p mean: -0.0350860171020031, mean p set: 0.45171743631362915
loss_pred:0.01742180995643139, decouple_loss:0.00153589085675776
The modified gen p mean: 0.45225995779037476, gen p mean: -0.03984127566218376, mean p set: 0.45274025201797485The modified gen p mean: 0.45110756158828735, gen p mean: -0.039214495569467545, mean p set: 0.45158782601356506
loss_pred:0.017493082210421562, decouple_loss:0.001549137057736516
loss_pred:0.017473699524998665, decouple_loss:0.001686030882410705
Iteration: 1646, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44984734058380127, gen p mean: -0.03857644274830818, mean p set: 0.45032763481140137
loss_pred:0.017613409087061882, decouple_loss:0.0016746172914281487
The modified gen p mean: 0.45179077982902527, gen p mean: -0.04020039737224579, mean p set: 0.45227110385894775The modified gen p mean: 0.45236918330192566, gen p mean: -0.042220838367938995, mean p set: 0.45284944772720337
loss_pred:0.01728917472064495, decouple_loss:0.0015450400533154607
loss_pred:0.01708071678876877, decouple_loss:0.0016682140994817019
Iteration: 1647, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513815939426422, gen p mean: -0.03348713740706444, mean p set: 0.4518618583679199
loss_pred:0.01707036793231964, decouple_loss:0.0015254105674102902
The modified gen p mean: 0.4498354196548462, gen p mean: -0.04033656790852547, mean p set: 0.4503157436847687The modified gen p mean: 0.44985446333885193, gen p mean: -0.03974488750100136, mean p set: 0.450334757566452
loss_pred:0.017677292227745056, decouple_loss:0.001598946750164032
loss_pred:0.01703968457877636, decouple_loss:0.0014177667908370495
Iteration: 1648, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4533770680427551, gen p mean: -0.037392809987068176, mean p set: 0.45385733246803284
loss_pred:0.01743149943649769, decouple_loss:0.0015714444452896714
The modified gen p mean: 0.4526446461677551, gen p mean: -0.037980008870363235, mean p set: 0.4531249403953552
The modified gen p mean: 0.45259809494018555, gen p mean: -0.048151444643735886, mean p set: 0.45307838916778564
loss_pred:0.017318537458777428, decouple_loss:0.0015698607312515378
loss_pred:0.0164707750082016, decouple_loss:0.0015792176127433777
Iteration: 1649, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45037195086479187, gen p mean: -0.039625342935323715, mean p set: 0.4508522152900696
loss_pred:0.01744954101741314, decouple_loss:0.0014508813619613647
The modified gen p mean: 0.4525221288204193, gen p mean: -0.03468922898173332, mean p set: 0.4530024528503418The modified gen p mean: 0.4522134065628052, gen p mean: -0.03283274173736572, mean p set: 0.45269373059272766
loss_pred:0.017203764989972115, decouple_loss:0.001490418566390872
loss_pred:0.01710580289363861, decouple_loss:0.0013782820897176862
Iteration: 1650, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511301815509796, gen p mean: -0.042596835643053055, mean p set: 0.4516104459762573
loss_pred:0.017171291634440422, decouple_loss:0.001468261587433517
The modified gen p mean: 0.45236605405807495, gen p mean: -0.036458712071180344, mean p set: 0.45284631848335266The modified gen p mean: 0.4521292448043823, gen p mean: -0.03806468844413757, mean p set: 0.45260950922966003
loss_pred:0.016838762909173965, decouple_loss:0.0014835057081654668
loss_pred:0.017819905653595924, decouple_loss:0.0014550986234098673
2023-05-02 08:52:35 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.0462661013007164, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.039802636951208115, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04144834354519844, mean p set: 0.4500633478164673
loss_pred:0.018891876563429832, decouple_loss:0.0015830446500331163
loss_pred:0.017804045230150223, decouple_loss:0.0015306392451748252
loss_pred:0.017974743619561195, decouple_loss:0.0015265308320522308
WV_0_PC_1_EH_0_PS_40, loss: 0.018300892785191536, avg_mse: 0.02623482421040535
current test mse: 0.026235
Iteration: 1651, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4525023102760315, gen p mean: -0.035465702414512634, mean p set: 0.4529826045036316
The modified gen p mean: 0.4513130187988281, gen p mean: -0.03727668896317482, mean p set: 0.4517933130264282
The modified gen p mean: 0.45186764001846313, gen p mean: -0.03896357864141464, mean p set: 0.45234790444374084
loss_pred:0.0169152170419693, decouple_loss:0.001307167112827301
loss_pred:0.01691175252199173, decouple_loss:0.0015027874615043402
loss_pred:0.01680261455476284, decouple_loss:0.00142282887827605
Iteration: 1652, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45230579376220703, gen p mean: -0.03236500546336174, mean p set: 0.45278608798980713
loss_pred:0.017968107014894485, decouple_loss:0.0013101602671667933
The modified gen p mean: 0.45223894715309143, gen p mean: -0.034037474542856216, mean p set: 0.45271924138069153The modified gen p mean: 0.4502890408039093, gen p mean: -0.040590137243270874, mean p set: 0.450769305229187
loss_pred:0.01659454219043255, decouple_loss:0.0013304854510352015
loss_pred:0.016496598720550537, decouple_loss:0.0013290056958794594
Iteration: 1653, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.451688677072525, gen p mean: -0.03324337676167488, mean p set: 0.4521689713001251
loss_pred:0.016952844336628914, decouple_loss:0.0014514437643811107
The modified gen p mean: 0.4491223990917206, gen p mean: -0.037122692912817, mean p set: 0.4496026933193207The modified gen p mean: 0.4516649544239044, gen p mean: -0.03426184132695198, mean p set: 0.4521452486515045
loss_pred:0.01691262610256672, decouple_loss:0.001382125774398446
loss_pred:0.017749739810824394, decouple_loss:0.0014975140802562237
Iteration: 1654, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45016443729400635, gen p mean: -0.03775322064757347, mean p set: 0.45064473152160645
loss_pred:0.01768815703690052, decouple_loss:0.0014835576293990016
The modified gen p mean: 0.45134252309799194, gen p mean: -0.03712892904877663, mean p set: 0.45182281732559204The modified gen p mean: 0.44991931319236755, gen p mean: -0.03826059028506279, mean p set: 0.45039960741996765
loss_pred:0.01710359752178192, decouple_loss:0.0012902800226584077
loss_pred:0.01739526353776455, decouple_loss:0.0014740979531779885
Iteration: 1655, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45213136076927185, gen p mean: -0.03472333401441574, mean p set: 0.45261165499687195
loss_pred:0.016056161373853683, decouple_loss:0.0012851146748289466
The modified gen p mean: 0.45018839836120605, gen p mean: -0.039792075753211975, mean p set: 0.45066869258880615The modified gen p mean: 0.4497220814228058, gen p mean: -0.04199174419045448, mean p set: 0.4502023756504059
loss_pred:0.016443785279989243, decouple_loss:0.001468520611524582
loss_pred:0.01767919771373272, decouple_loss:0.0013870965922251344
Iteration: 1656, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45063936710357666, gen p mean: -0.03938587009906769, mean p set: 0.45111966133117676
loss_pred:0.01737644337117672, decouple_loss:0.001334847416728735
The modified gen p mean: 0.4527318775653839, gen p mean: -0.036961138248443604, mean p set: 0.453212171792984The modified gen p mean: 0.4531138837337494, gen p mean: -0.033453620970249176, mean p set: 0.4535941779613495
loss_pred:0.017175886780023575, decouple_loss:0.0015658269403502345
loss_pred:0.01725156418979168, decouple_loss:0.0014366722898557782
Iteration: 1657, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45192500948905945, gen p mean: -0.045593246817588806, mean p set: 0.45240524411201477
loss_pred:0.016442513093352318, decouple_loss:0.001503664068877697
The modified gen p mean: 0.45107221603393555, gen p mean: -0.04145289212465286, mean p set: 0.45155251026153564The modified gen p mean: 0.4520719647407532, gen p mean: -0.03202054649591446, mean p set: 0.45255225896835327
loss_pred:0.01717609539628029, decouple_loss:0.0013954302994534373
loss_pred:0.016143042594194412, decouple_loss:0.001385547686368227
Iteration: 1658, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4524232745170593, gen p mean: -0.0336463525891304, mean p set: 0.4529035687446594
loss_pred:0.017363665625452995, decouple_loss:0.0011790734715759754
The modified gen p mean: 0.4519454538822174, gen p mean: -0.03323473036289215, mean p set: 0.4524257183074951The modified gen p mean: 0.4498312771320343, gen p mean: -0.04559435695409775, mean p set: 0.4503115713596344
loss_pred:0.01742573268711567, decouple_loss:0.0013807982904836535
loss_pred:0.01670445129275322, decouple_loss:0.0012962508480995893
Iteration: 1659, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4516293406486511, gen p mean: -0.037305593490600586, mean p set: 0.45210960507392883
loss_pred:0.016045529395341873, decouple_loss:0.0014324376825243235
The modified gen p mean: 0.45204871892929077, gen p mean: -0.036483485251665115, mean p set: 0.4525289833545685The modified gen p mean: 0.4507010579109192, gen p mean: -0.039545390754938126, mean p set: 0.4511813521385193
loss_pred:0.016959523782134056, decouple_loss:0.0014046699507161975
loss_pred:0.01681702770292759, decouple_loss:0.0013261723797768354
Iteration: 1660, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503428041934967, gen p mean: -0.03949570283293724, mean p set: 0.4508230984210968
loss_pred:0.01731463149189949, decouple_loss:0.0014231359818950295
The modified gen p mean: 0.45240479707717896, gen p mean: -0.03408939018845558, mean p set: 0.45288509130477905The modified gen p mean: 0.45097616314888, gen p mean: -0.03649379312992096, mean p set: 0.4514564573764801
loss_pred:0.01616962067782879, decouple_loss:0.001300705480389297
loss_pred:0.01675792783498764, decouple_loss:0.001372005557641387
2023-05-02 08:54:29 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.05036016181111336, mean p set: 0.4502691626548767
The modified gen p mean: 0.4498766362667084, gen p mean: -0.0440414696931839, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04439068213105202, mean p set: 0.4500633478164673
loss_pred:0.018945474177598953, decouple_loss:0.0014644123148173094
loss_pred:0.01775389537215233, decouple_loss:0.001336607150733471
loss_pred:0.017952781170606613, decouple_loss:0.0013851975090801716
WV_0_PC_1_EH_0_PS_40, loss: 0.01828715391457081, avg_mse: 0.026230623945593834
current test mse: 0.026231
Iteration: 1661, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4527330696582794, gen p mean: -0.042160291224718094, mean p set: 0.45321333408355713
The modified gen p mean: 0.45281991362571716, gen p mean: -0.04032771289348602, mean p set: 0.4533001780509949
The modified gen p mean: 0.4506247639656067, gen p mean: -0.04209977388381958, mean p set: 0.4511050879955292
loss_pred:0.017400018870830536, decouple_loss:0.0012088915100321174
loss_pred:0.016764387488365173, decouple_loss:0.0012104713823646307
loss_pred:0.01699179783463478, decouple_loss:0.0011855639750137925
Iteration: 1662, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4530556797981262, gen p mean: -0.0398174449801445, mean p set: 0.4535359740257263
The modified gen p mean: 0.4518081247806549, gen p mean: -0.04328395426273346, mean p set: 0.4522883892059326
loss_pred:0.01694195345044136, decouple_loss:0.001332174870185554
loss_pred:0.01638573221862316, decouple_loss:0.001257800031453371
The modified gen p mean: 0.45109429955482483, gen p mean: -0.04188406467437744, mean p set: 0.45157456398010254
loss_pred:0.016657652333378792, decouple_loss:0.0013837183360010386
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012010_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012010_3_24hr.npz
NaN value num: 0
Iteration: 1663, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44660109281539917, gen p mean: -0.04709519445896149, mean p set: 0.4470813572406769
loss_pred:0.015089845284819603, decouple_loss:0.0014254223788157105
The modified gen p mean: 0.4482315480709076, gen p mean: -0.04599839821457863, mean p set: 0.4487118422985077The modified gen p mean: 0.44819462299346924, gen p mean: -0.05019880086183548, mean p set: 0.4486749470233917
loss_pred:0.015213624574244022, decouple_loss:0.001531863701529801
loss_pred:0.01575072854757309, decouple_loss:0.0014893561601638794
Iteration: 1664, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44736284017562866, gen p mean: -0.04500890150666237, mean p set: 0.44784313440322876
The modified gen p mean: 0.4477332532405853, gen p mean: -0.0454031340777874, mean p set: 0.4482135772705078
loss_pred:0.01576203480362892, decouple_loss:0.0013092539738863707
loss_pred:0.015160804614424706, decouple_loss:0.0014053197810426354
The modified gen p mean: 0.4474979639053345, gen p mean: -0.045233529061079025, mean p set: 0.44797828793525696
loss_pred:0.015488066710531712, decouple_loss:0.0012995176948606968
Iteration: 1665, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465268850326538, gen p mean: -0.046374112367630005, mean p set: 0.4470071494579315
The modified gen p mean: 0.4474668502807617, gen p mean: -0.04711190611124039, mean p set: 0.4479471743106842
loss_pred:0.015122855082154274, decouple_loss:0.0014112673234194517
loss_pred:0.015465381555259228, decouple_loss:0.0013392381370067596
The modified gen p mean: 0.44594743847846985, gen p mean: -0.048680733889341354, mean p set: 0.44642776250839233
loss_pred:0.014845497906208038, decouple_loss:0.0015503891045227647
Iteration: 1666, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44761788845062256, gen p mean: -0.04364822804927826, mean p set: 0.44809815287590027
The modified gen p mean: 0.44711533188819885, gen p mean: -0.045308031141757965, mean p set: 0.44759562611579895
loss_pred:0.01470260787755251, decouple_loss:0.0013502873480319977
loss_pred:0.014733834192156792, decouple_loss:0.0013596189673990011
The modified gen p mean: 0.44677478075027466, gen p mean: -0.04520082473754883, mean p set: 0.44725507497787476
loss_pred:0.014801367186009884, decouple_loss:0.0013829641975462437
Iteration: 1667, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476853609085083, gen p mean: -0.047161541879177094, mean p set: 0.4481656849384308
The modified gen p mean: 0.4473322331905365, gen p mean: -0.05021625757217407, mean p set: 0.4478125274181366
loss_pred:0.015208084136247635, decouple_loss:0.0013861862244084477
loss_pred:0.014645356684923172, decouple_loss:0.001319047180004418
The modified gen p mean: 0.4477154016494751, gen p mean: -0.047753702849149704, mean p set: 0.4481956660747528
loss_pred:0.015100264921784401, decouple_loss:0.0013536851620301604
Iteration: 1668, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483828842639923, gen p mean: -0.05129311606287956, mean p set: 0.4488631784915924
The modified gen p mean: 0.4475243091583252, gen p mean: -0.05191509425640106, mean p set: 0.4480046033859253
loss_pred:0.01508339773863554, decouple_loss:0.0013024897780269384
loss_pred:0.014696851372718811, decouple_loss:0.0012343927519395947
The modified gen p mean: 0.4479389786720276, gen p mean: -0.047935646027326584, mean p set: 0.4484192430973053
loss_pred:0.015605221502482891, decouple_loss:0.0012960622552782297
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1669, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44717881083488464, gen p mean: -0.0482134148478508, mean p set: 0.44765913486480713
The modified gen p mean: 0.44725489616394043, gen p mean: -0.05088071897625923, mean p set: 0.4477352201938629
loss_pred:0.01564246416091919, decouple_loss:0.0012667353730648756
loss_pred:0.015514920465648174, decouple_loss:0.0012369214091449976The modified gen p mean: 0.4484720230102539, gen p mean: -0.04724676534533501, mean p set: 0.448952317237854
loss_pred:0.015363779850304127, decouple_loss:0.0013966266997158527
Iteration: 1670, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44661808013916016, gen p mean: -0.044296249747276306, mean p set: 0.44709837436676025
The modified gen p mean: 0.4460480511188507, gen p mean: -0.04708290100097656, mean p set: 0.4465283155441284
loss_pred:0.015297655016183853, decouple_loss:0.0014367642579600215
loss_pred:0.015353230759501457, decouple_loss:0.0014594128588214517
The modified gen p mean: 0.4478013515472412, gen p mean: -0.0405779667198658, mean p set: 0.4482816159725189
loss_pred:0.015175134874880314, decouple_loss:0.0014133420772850513
2023-05-02 08:56:58 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.04274177551269531, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.03759602829813957, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.038072146475315094, mean p set: 0.4500633478164673
loss_pred:0.019328899681568146, decouple_loss:0.0014682005858048797
loss_pred:0.018215738236904144, decouple_loss:0.001361299306154251
loss_pred:0.018350305035710335, decouple_loss:0.0013861616607755423
WV_0_PC_1_EH_0_PS_40, loss: 0.018701909109950066, avg_mse: 0.027032699435949326
current test mse: 0.027033
Iteration: 1671, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480712115764618, gen p mean: -0.043663520365953445, mean p set: 0.4485515058040619
The modified gen p mean: 0.44749343395233154, gen p mean: -0.040805574506521225, mean p set: 0.44797375798225403
The modified gen p mean: 0.44779473543167114, gen p mean: -0.039358582347631454, mean p set: 0.44827502965927124
loss_pred:0.015425748191773891, decouple_loss:0.0013196897925809026
loss_pred:0.016162926331162453, decouple_loss:0.0013964571990072727
loss_pred:0.016339866444468498, decouple_loss:0.0014528523897752166
Iteration: 1672, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447325736284256, gen p mean: -0.04204760119318962, mean p set: 0.4478060305118561
loss_pred:0.015349688939750195, decouple_loss:0.001600288087502122
The modified gen p mean: 0.44731026887893677, gen p mean: -0.03715447708964348, mean p set: 0.44779056310653687The modified gen p mean: 0.4480925500392914, gen p mean: -0.03787267953157425, mean p set: 0.4485728442668915
loss_pred:0.015019772574305534, decouple_loss:0.0013297328259795904
loss_pred:0.01527787372469902, decouple_loss:0.00142818340100348
Iteration: 1673, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481610953807831, gen p mean: -0.033852554857730865, mean p set: 0.4486413896083832
loss_pred:0.014633908867835999, decouple_loss:0.0013437794987112284
The modified gen p mean: 0.44760996103286743, gen p mean: -0.035882219672203064, mean p set: 0.44809025526046753The modified gen p mean: 0.4473015367984772, gen p mean: -0.041148532181978226, mean p set: 0.4477818012237549
loss_pred:0.015005833469331264, decouple_loss:0.0012907537166029215
loss_pred:0.014936859719455242, decouple_loss:0.0012601971393451095
Iteration: 1674, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485853910446167, gen p mean: -0.04029742255806923, mean p set: 0.4490656852722168
loss_pred:0.015214298851788044, decouple_loss:0.0014319652691483498
The modified gen p mean: 0.44840723276138306, gen p mean: -0.04043633118271828, mean p set: 0.44888749718666077The modified gen p mean: 0.44836685061454773, gen p mean: -0.04298187047243118, mean p set: 0.44884711503982544
loss_pred:0.01448903139680624, decouple_loss:0.0013507846742868423
loss_pred:0.015270061790943146, decouple_loss:0.0013363318284973502
Iteration: 1675, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446433961391449, gen p mean: -0.05027862265706062, mean p set: 0.44691428542137146
loss_pred:0.015270103700459003, decouple_loss:0.0014978954568505287
The modified gen p mean: 0.44772443175315857, gen p mean: -0.0521211102604866, mean p set: 0.44820475578308105The modified gen p mean: 0.44790297746658325, gen p mean: -0.048801206052303314, mean p set: 0.44838324189186096
loss_pred:0.015322805382311344, decouple_loss:0.0013419304741546512
loss_pred:0.01571624167263508, decouple_loss:0.0013858724851161242
Iteration: 1676, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472237527370453, gen p mean: -0.053408022969961166, mean p set: 0.4477040469646454
loss_pred:0.01496441476047039, decouple_loss:0.001531577785499394
The modified gen p mean: 0.4468335509300232, gen p mean: -0.056551139801740646, mean p set: 0.4473138451576233The modified gen p mean: 0.44671371579170227, gen p mean: -0.05438510701060295, mean p set: 0.44719401001930237
loss_pred:0.015498287975788116, decouple_loss:0.0016014782013371587
loss_pred:0.015699870884418488, decouple_loss:0.0015054014511406422
Iteration: 1677, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4462706446647644, gen p mean: -0.059720657765865326, mean p set: 0.4467509686946869
loss_pred:0.015026794746518135, decouple_loss:0.001477060723118484
The modified gen p mean: 0.44793900847435, gen p mean: -0.05690968781709671, mean p set: 0.44841933250427246The modified gen p mean: 0.44788992404937744, gen p mean: -0.05581144243478775, mean p set: 0.44837021827697754
loss_pred:0.015766983851790428, decouple_loss:0.0013814885169267654
loss_pred:0.015005902387201786, decouple_loss:0.0013017244637012482
Iteration: 1678, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472489058971405, gen p mean: -0.05414197966456413, mean p set: 0.447729229927063
loss_pred:0.01486885640770197, decouple_loss:0.0014173625968396664
The modified gen p mean: 0.4461391866207123, gen p mean: -0.05493883788585663, mean p set: 0.44661951065063477The modified gen p mean: 0.4463503360748291, gen p mean: -0.05429266020655632, mean p set: 0.4468306601047516
loss_pred:0.014894776977598667, decouple_loss:0.0014085381990298629
loss_pred:0.014114296063780785, decouple_loss:0.0013919490156695247
Iteration: 1679, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44768717885017395, gen p mean: -0.052495185285806656, mean p set: 0.44816744327545166
The modified gen p mean: 0.44676148891448975, gen p mean: -0.051931608468294144, mean p set: 0.44724181294441223loss_pred:0.0151902474462986, decouple_loss:0.0014380831271409988
The modified gen p mean: 0.44698426127433777, gen p mean: -0.0571802593767643, mean p set: 0.44746458530426025
loss_pred:0.01440731156617403, decouple_loss:0.00148399593308568
loss_pred:0.014756117016077042, decouple_loss:0.0014636809937655926
Iteration: 1680, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44590359926223755, gen p mean: -0.05448303744196892, mean p set: 0.44638389348983765
loss_pred:0.014061485417187214, decouple_loss:0.001528564840555191
The modified gen p mean: 0.44754186272621155, gen p mean: -0.05448281392455101, mean p set: 0.44802215695381165The modified gen p mean: 0.4461376368999481, gen p mean: -0.052933841943740845, mean p set: 0.4466179311275482
loss_pred:0.014647750183939934, decouple_loss:0.0014141097199171782
loss_pred:0.014643387869000435, decouple_loss:0.0015763595001772046
2023-05-02 08:58:51 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.05579005181789398, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.05008459836244583, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.050901345908641815, mean p set: 0.4500633478164673
loss_pred:0.019149858504533768, decouple_loss:0.0015586343361064792
loss_pred:0.018189210444688797, decouple_loss:0.0014283464988693595
loss_pred:0.018172580748796463, decouple_loss:0.0014606043696403503
WV_0_PC_1_EH_0_PS_40, loss: 0.01857800967991352, avg_mse: 0.02681543119251728
current test mse: 0.026815
Iteration: 1681, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44724777340888977, gen p mean: -0.05052989348769188, mean p set: 0.4477280378341675
The modified gen p mean: 0.4479878842830658, gen p mean: -0.052887074649333954, mean p set: 0.4484681785106659
The modified gen p mean: 0.4473837912082672, gen p mean: -0.04960281029343605, mean p set: 0.4478640854358673
loss_pred:0.014468475244939327, decouple_loss:0.0014069871976971626
loss_pred:0.014891691505908966, decouple_loss:0.0013360558077692986loss_pred:0.015054132789373398, decouple_loss:0.001449009170755744
Iteration: 1682, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44764432311058044, gen p mean: -0.050692327320575714, mean p set: 0.44812464714050293
loss_pred:0.014887821860611439, decouple_loss:0.0015531692188233137
The modified gen p mean: 0.44755229353904724, gen p mean: -0.046569209545850754, mean p set: 0.44803258776664734The modified gen p mean: 0.4480936527252197, gen p mean: -0.04734838008880615, mean p set: 0.4485739767551422
loss_pred:0.014673778787255287, decouple_loss:0.0015044289175421
loss_pred:0.014765129424631596, decouple_loss:0.0014887176221236587
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012000_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012000_3_24hr.npz
NaN value num: 0
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1683, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44644027948379517, gen p mean: -0.04532144218683243, mean p set: 0.44692057371139526
loss_pred:0.01465124636888504, decouple_loss:0.0014776014722883701
The modified gen p mean: 0.44739699363708496, gen p mean: -0.0455579049885273, mean p set: 0.44787725806236267The modified gen p mean: 0.44645529985427856, gen p mean: -0.04542521759867668, mean p set: 0.44693562388420105
loss_pred:0.015066270716488361, decouple_loss:0.001496063661761582
loss_pred:0.014487870037555695, decouple_loss:0.0014557415852323174
Iteration: 1684, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474863111972809, gen p mean: -0.04120054841041565, mean p set: 0.447966605424881
loss_pred:0.014484788291156292, decouple_loss:0.0015824376605451107
The modified gen p mean: 0.44767144322395325, gen p mean: -0.04267611354589462, mean p set: 0.44815176725387573The modified gen p mean: 0.44661250710487366, gen p mean: -0.04474852979183197, mean p set: 0.44709280133247375
loss_pred:0.014239488169550896, decouple_loss:0.0014481141697615385
loss_pred:0.014497203752398491, decouple_loss:0.001484593260101974
Iteration: 1685, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44786641001701355, gen p mean: -0.041288044303655624, mean p set: 0.44834670424461365
loss_pred:0.01487644575536251, decouple_loss:0.0015124186174944043
The modified gen p mean: 0.44670215249061584, gen p mean: -0.04459698498249054, mean p set: 0.44718244671821594The modified gen p mean: 0.4470798075199127, gen p mean: -0.04087160900235176, mean p set: 0.4475601017475128
loss_pred:0.015102674253284931, decouple_loss:0.0014628212666139007
loss_pred:0.014176533557474613, decouple_loss:0.001526123145595193
Iteration: 1686, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475764036178589, gen p mean: -0.04826319217681885, mean p set: 0.448056697845459
loss_pred:0.014468051493167877, decouple_loss:0.0015312319155782461
The modified gen p mean: 0.4469894468784332, gen p mean: -0.046718452125787735, mean p set: 0.4474697411060333The modified gen p mean: 0.4478181302547455, gen p mean: -0.04629367217421532, mean p set: 0.44829845428466797
loss_pred:0.01424490287899971, decouple_loss:0.0016214034985750914
loss_pred:0.014104870148003101, decouple_loss:0.0013916658936068416
Iteration: 1687, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44844359159469604, gen p mean: -0.04459194466471672, mean p set: 0.44892388582229614
loss_pred:0.015281109139323235, decouple_loss:0.0014440561644732952
The modified gen p mean: 0.4475334584712982, gen p mean: -0.04510430991649628, mean p set: 0.4480137526988983
The modified gen p mean: 0.44641056656837463, gen p mean: -0.04619446024298668, mean p set: 0.4468908905982971
loss_pred:0.014529677107930183, decouple_loss:0.0013221325352787971
loss_pred:0.014409113675355911, decouple_loss:0.0013066554674878716
Iteration: 1688, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44827795028686523, gen p mean: -0.04808798059821129, mean p set: 0.44875821471214294
loss_pred:0.015078839845955372, decouple_loss:0.001366217969916761
The modified gen p mean: 0.44692403078079224, gen p mean: -0.05136830732226372, mean p set: 0.44740432500839233The modified gen p mean: 0.4470362365245819, gen p mean: -0.047519002109766006, mean p set: 0.447516530752182
loss_pred:0.014221308752894402, decouple_loss:0.0013516134349629283
loss_pred:0.014901986345648766, decouple_loss:0.0014814950991421938
Iteration: 1689, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44691750407218933, gen p mean: -0.052814584225416183, mean p set: 0.44739779829978943
loss_pred:0.014273365028202534, decouple_loss:0.001399443601258099
The modified gen p mean: 0.4487743079662323, gen p mean: -0.049107570201158524, mean p set: 0.4492546021938324The modified gen p mean: 0.4471036195755005, gen p mean: -0.053865715861320496, mean p set: 0.4475838840007782
loss_pred:0.01418203953653574, decouple_loss:0.0014308864483609796
loss_pred:0.014438553713262081, decouple_loss:0.0014960571425035596
Iteration: 1690, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476753771305084, gen p mean: -0.05075651407241821, mean p set: 0.4481556713581085
loss_pred:0.014332681894302368, decouple_loss:0.0013536905171349645
The modified gen p mean: 0.4461483657360077, gen p mean: -0.04806414991617203, mean p set: 0.4466286599636078The modified gen p mean: 0.44925034046173096, gen p mean: -0.04655129835009575, mean p set: 0.44973060488700867
loss_pred:0.014291276223957539, decouple_loss:0.0013347479980438948
loss_pred:0.01419450156390667, decouple_loss:0.001330309547483921
2023-05-02 09:01:25 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.049539677798748016, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.043318599462509155, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.04474004730582237, mean p set: 0.4500633478164673
loss_pred:0.018960773944854736, decouple_loss:0.001376352971419692
loss_pred:0.01795709878206253, decouple_loss:0.0012850146740674973
loss_pred:0.017948316410183907, decouple_loss:0.0013182510156184435
WV_0_PC_1_EH_0_PS_40, loss: 0.018355056643486023, avg_mse: 0.026443056762218475
current test mse: 0.026443
Iteration: 1691, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4455268085002899, gen p mean: -0.047896210104227066, mean p set: 0.44600710272789
The modified gen p mean: 0.44701990485191345, gen p mean: -0.04660507291555405, mean p set: 0.44750016927719116
The modified gen p mean: 0.44697317481040955, gen p mean: -0.04511876776814461, mean p set: 0.44745346903800964
loss_pred:0.014757933095097542, decouple_loss:0.001257199328392744
loss_pred:0.014752253890037537, decouple_loss:0.0012317874934524298
loss_pred:0.015005731023848057, decouple_loss:0.0012911870144307613
Iteration: 1692, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466509222984314, gen p mean: -0.04278557375073433, mean p set: 0.4471312463283539
loss_pred:0.014276184141635895, decouple_loss:0.001456347992643714
The modified gen p mean: 0.44737598299980164, gen p mean: -0.04414663091301918, mean p set: 0.44785624742507935The modified gen p mean: 0.4468054175376892, gen p mean: -0.04611560329794884, mean p set: 0.4472857117652893
loss_pred:0.014159061014652252, decouple_loss:0.0013252347707748413
loss_pred:0.013907144777476788, decouple_loss:0.0013135436456650496
Iteration: 1693, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468916654586792, gen p mean: -0.04116569831967354, mean p set: 0.4473719894886017
loss_pred:0.01463544461876154, decouple_loss:0.0011787469265982509
The modified gen p mean: 0.44735249876976013, gen p mean: -0.03881054371595383, mean p set: 0.44783279299736023The modified gen p mean: 0.4458523094654083, gen p mean: -0.04133588448166847, mean p set: 0.4463326036930084
loss_pred:0.014246931299567223, decouple_loss:0.0012795525835826993
loss_pred:0.01390335988253355, decouple_loss:0.0011206783819943666
Iteration: 1694, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44839704036712646, gen p mean: -0.03974742442369461, mean p set: 0.44887736439704895
loss_pred:0.014631385914981365, decouple_loss:0.0013830484822392464
The modified gen p mean: 0.44797658920288086, gen p mean: -0.03864891827106476, mean p set: 0.44845691323280334The modified gen p mean: 0.448159784078598, gen p mean: -0.03762352466583252, mean p set: 0.44864004850387573
loss_pred:0.01452390756458044, decouple_loss:0.0013185153948143125
loss_pred:0.014831384643912315, decouple_loss:0.0013532787561416626
Iteration: 1695, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44655048847198486, gen p mean: -0.04306910187005997, mean p set: 0.44703078269958496
loss_pred:0.014364832080900669, decouple_loss:0.0013286515604704618
The modified gen p mean: 0.4465515911579132, gen p mean: -0.040553025901317596, mean p set: 0.4470318555831909The modified gen p mean: 0.4465046525001526, gen p mean: -0.042161259800195694, mean p set: 0.4469849467277527
loss_pred:0.014142380096018314, decouple_loss:0.0013139426009729505
loss_pred:0.014007531106472015, decouple_loss:0.001255687209777534
Iteration: 1696, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44827088713645935, gen p mean: -0.044652581214904785, mean p set: 0.44875115156173706
loss_pred:0.01486570481210947, decouple_loss:0.0014599678106606007
The modified gen p mean: 0.44768601655960083, gen p mean: -0.04488499090075493, mean p set: 0.4481663107872009The modified gen p mean: 0.447029709815979, gen p mean: -0.04239823669195175, mean p set: 0.4475100040435791
loss_pred:0.013957793824374676, decouple_loss:0.0013439441099762917
loss_pred:0.014669366180896759, decouple_loss:0.0014103599824011326
Iteration: 1697, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44876816868782043, gen p mean: -0.04512463137507439, mean p set: 0.44924843311309814
loss_pred:0.014259018003940582, decouple_loss:0.0013677488313987851
The modified gen p mean: 0.44633227586746216, gen p mean: -0.047939810901880264, mean p set: 0.44681257009506226The modified gen p mean: 0.4480457603931427, gen p mean: -0.04519779607653618, mean p set: 0.4485260546207428
loss_pred:0.013878853060305119, decouple_loss:0.0012448348570615053
loss_pred:0.014709923416376114, decouple_loss:0.0013045115629211068
Iteration: 1698, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44729194045066833, gen p mean: -0.05056849867105484, mean p set: 0.44777220487594604
loss_pred:0.014055523090064526, decouple_loss:0.001447199727408588
The modified gen p mean: 0.44630932807922363, gen p mean: -0.043760091066360474, mean p set: 0.44678959250450134The modified gen p mean: 0.4478625953197479, gen p mean: -0.045917876064777374, mean p set: 0.44834285974502563
loss_pred:0.014455673284828663, decouple_loss:0.0014498498057946563
loss_pred:0.013944065198302269, decouple_loss:0.0013323259772732854
Iteration: 1699, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466387629508972, gen p mean: -0.048093248158693314, mean p set: 0.4471190571784973
loss_pred:0.013715259730815887, decouple_loss:0.0013251736527308822
The modified gen p mean: 0.44717806577682495, gen p mean: -0.042737945914268494, mean p set: 0.44765836000442505The modified gen p mean: 0.44723886251449585, gen p mean: -0.045541055500507355, mean p set: 0.44771912693977356
loss_pred:0.014506899751722813, decouple_loss:0.001384033472277224
loss_pred:0.014073051512241364, decouple_loss:0.001342716277576983
Iteration: 1700, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4455258548259735, gen p mean: -0.044015392661094666, mean p set: 0.4460061490535736
loss_pred:0.014085382223129272, decouple_loss:0.0011997667606920004
The modified gen p mean: 0.44916799664497375, gen p mean: -0.043537482619285583, mean p set: 0.44964826107025146The modified gen p mean: 0.4454604387283325, gen p mean: -0.04580700397491455, mean p set: 0.44594070315361023
loss_pred:0.013874338008463383, decouple_loss:0.001241974881850183
loss_pred:0.01418183371424675, decouple_loss:0.0012269517173990607
2023-05-02 09:03:21 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.0465114489197731, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04032129794359207, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04185076430439949, mean p set: 0.4500633478164673
loss_pred:0.01897982694208622, decouple_loss:0.0013074238086119294
loss_pred:0.017952661961317062, decouple_loss:0.001352714723907411
loss_pred:0.017990559339523315, decouple_loss:0.001289708656258881
WV_0_PC_1_EH_0_PS_40, loss: 0.0183735154569149, avg_mse: 0.026557011529803276
current test mse: 0.026557
Iteration: 1701, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446512371301651, gen p mean: -0.04438571631908417, mean p set: 0.4469926357269287
The modified gen p mean: 0.4466874897480011, gen p mean: -0.04066209867596626, mean p set: 0.4471677839756012
The modified gen p mean: 0.4467404782772064, gen p mean: -0.042256370186805725, mean p set: 0.4472208023071289
loss_pred:0.01397623773664236, decouple_loss:0.0012486431514844298
loss_pred:0.014561685733497143, decouple_loss:0.0012115893187001348
loss_pred:0.014120829291641712, decouple_loss:0.0012378602987155318
Iteration: 1702, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473676085472107, gen p mean: -0.04140213131904602, mean p set: 0.4478478729724884
loss_pred:0.013907233253121376, decouple_loss:0.0011336152674630284
The modified gen p mean: 0.44714266061782837, gen p mean: -0.04567175731062889, mean p set: 0.44762295484542847The modified gen p mean: 0.446135550737381, gen p mean: -0.043752893805503845, mean p set: 0.4466158449649811
loss_pred:0.013742750510573387, decouple_loss:0.001155067584477365
loss_pred:0.01397103350609541, decouple_loss:0.0012118349550291896
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012016_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012016_3_24hr.npz
NaN value num: 0
Iteration: 1703, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502740204334259, gen p mean: -0.0323852002620697, mean p set: 0.450754314661026
loss_pred:0.018463561311364174, decouple_loss:0.0013235390651971102
The modified gen p mean: 0.44926226139068604, gen p mean: -0.038009162992239, mean p set: 0.4497425854206085The modified gen p mean: 0.448621541261673, gen p mean: -0.036811139434576035, mean p set: 0.4491018056869507
loss_pred:0.018482929095625877, decouple_loss:0.0013397065922617912
loss_pred:0.017921162769198418, decouple_loss:0.0012187942629680037
Iteration: 1704, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44984233379364014, gen p mean: -0.03290758654475212, mean p set: 0.45032259821891785
loss_pred:0.018300050869584084, decouple_loss:0.0012893041130155325
The modified gen p mean: 0.4493388235569, gen p mean: -0.036301981657743454, mean p set: 0.44981908798217773The modified gen p mean: 0.4487699568271637, gen p mean: -0.04317489266395569, mean p set: 0.4492502808570862
loss_pred:0.01783186011016369, decouple_loss:0.0012360623804852366
loss_pred:0.01799512654542923, decouple_loss:0.0013544714311137795
Iteration: 1705, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44940534234046936, gen p mean: -0.030428897589445114, mean p set: 0.44988563656806946
loss_pred:0.017686082050204277, decouple_loss:0.001381522393785417
The modified gen p mean: 0.44968050718307495, gen p mean: -0.03739063814282417, mean p set: 0.45016080141067505The modified gen p mean: 0.4486255347728729, gen p mean: -0.032370224595069885, mean p set: 0.44910579919815063
loss_pred:0.018599344417452812, decouple_loss:0.0012769850436598063
loss_pred:0.017869632691144943, decouple_loss:0.0012927302159368992
Iteration: 1706, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45142218470573425, gen p mean: -0.035288337618112564, mean p set: 0.45190247893333435
loss_pred:0.018671466037631035, decouple_loss:0.0012147970264777541
The modified gen p mean: 0.45022648572921753, gen p mean: -0.03305643051862717, mean p set: 0.45070680975914The modified gen p mean: 0.450111985206604, gen p mean: -0.03153669834136963, mean p set: 0.4505922794342041
loss_pred:0.0181806031614542, decouple_loss:0.0012449371861293912
loss_pred:0.017823411151766777, decouple_loss:0.0012176097370684147
Iteration: 1707, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495851397514343, gen p mean: -0.04348311945796013, mean p set: 0.4500654339790344
loss_pred:0.017697660252451897, decouple_loss:0.0013803004985675216
The modified gen p mean: 0.45045432448387146, gen p mean: -0.0338161326944828, mean p set: 0.45093461871147156The modified gen p mean: 0.44864264130592346, gen p mean: -0.040130365639925, mean p set: 0.44912293553352356
loss_pred:0.01916373521089554, decouple_loss:0.0013808446237817407
loss_pred:0.01850600354373455, decouple_loss:0.001495854463428259
Iteration: 1708, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503208100795746, gen p mean: -0.035845834761857986, mean p set: 0.4508011043071747
loss_pred:0.01779164746403694, decouple_loss:0.0012426212197169662
The modified gen p mean: 0.4502299427986145, gen p mean: -0.036639254540205, mean p set: 0.4507102370262146The modified gen p mean: 0.44944408535957336, gen p mean: -0.04475255683064461, mean p set: 0.44992440938949585
loss_pred:0.01792951300740242, decouple_loss:0.0012055705301463604
loss_pred:0.017830589786171913, decouple_loss:0.0013890205882489681
Iteration: 1709, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44942376017570496, gen p mean: -0.04406369850039482, mean p set: 0.44990405440330505
loss_pred:0.017768006771802902, decouple_loss:0.0011778431944549084
The modified gen p mean: 0.4490357041358948, gen p mean: -0.045198652893304825, mean p set: 0.4495159983634949The modified gen p mean: 0.44923296570777893, gen p mean: -0.0483538992702961, mean p set: 0.4497132897377014
loss_pred:0.018143918365240097, decouple_loss:0.0012499782023951411
loss_pred:0.017672641202807426, decouple_loss:0.001246375497430563
Iteration: 1710, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45003122091293335, gen p mean: -0.03740189969539642, mean p set: 0.45051151514053345
loss_pred:0.01778104156255722, decouple_loss:0.0011275334982201457
The modified gen p mean: 0.44992658495903015, gen p mean: -0.03537439554929733, mean p set: 0.45040687918663025
The modified gen p mean: 0.4489953815937042, gen p mean: -0.04636059328913689, mean p set: 0.4494756758213043
loss_pred:0.017805514857172966, decouple_loss:0.0011526687303557992
loss_pred:0.01710093766450882, decouple_loss:0.0011829191353172064
2023-05-02 09:05:55 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.0457400381565094, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.039437782019376755, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.041018638759851456, mean p set: 0.4500633478164673
loss_pred:0.01854204386472702, decouple_loss:0.0013207184383645654
loss_pred:0.01753556914627552, decouple_loss:0.0012723098043352365
loss_pred:0.017627211287617683, decouple_loss:0.0012825282756239176
WV_0_PC_1_EH_0_PS_40, loss: 0.017966201528906822, avg_mse: 0.0257122702896595
current test mse: 0.025712
Iteration: 1711, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489370584487915, gen p mean: -0.04081366956233978, mean p set: 0.4494173526763916
The modified gen p mean: 0.4498112201690674, gen p mean: -0.03645404800772667, mean p set: 0.4502915143966675
The modified gen p mean: 0.44959181547164917, gen p mean: -0.03434400632977486, mean p set: 0.45007210969924927
loss_pred:0.017153173685073853, decouple_loss:0.0011601842707023025
loss_pred:0.01779230125248432, decouple_loss:0.0011982553405687213loss_pred:0.01764534041285515, decouple_loss:0.0011527875903993845
Iteration: 1712, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502841830253601, gen p mean: -0.04030770808458328, mean p set: 0.4507644772529602
The modified gen p mean: 0.45172709226608276, gen p mean: -0.035569414496421814, mean p set: 0.45220738649368286
loss_pred:0.018386051058769226, decouple_loss:0.0011664275079965591
loss_pred:0.017858797684311867, decouple_loss:0.0010786667698994279
The modified gen p mean: 0.4503733515739441, gen p mean: -0.03840937465429306, mean p set: 0.4508536458015442
loss_pred:0.01762889139354229, decouple_loss:0.001110284822061658
Iteration: 1713, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490235149860382, gen p mean: -0.045198049396276474, mean p set: 0.4495038390159607
loss_pred:0.01735241711139679, decouple_loss:0.0011660205200314522
The modified gen p mean: 0.44938379526138306, gen p mean: -0.03725268691778183, mean p set: 0.44986405968666077The modified gen p mean: 0.45207497477531433, gen p mean: -0.037558089941740036, mean p set: 0.45255526900291443
loss_pred:0.018225504085421562, decouple_loss:0.0011778490152209997
loss_pred:0.01781092956662178, decouple_loss:0.001229461282491684
Iteration: 1714, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490238428115845, gen p mean: -0.044388435781002045, mean p set: 0.44950413703918457
loss_pred:0.018678536638617516, decouple_loss:0.0013200887478888035
The modified gen p mean: 0.4497458040714264, gen p mean: -0.03991378843784332, mean p set: 0.4502260982990265The modified gen p mean: 0.4481066167354584, gen p mean: -0.039428502321243286, mean p set: 0.44858694076538086
loss_pred:0.017913131043314934, decouple_loss:0.0011381786316633224
loss_pred:0.018623653799295425, decouple_loss:0.001335226115770638
Iteration: 1715, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497734606266022, gen p mean: -0.0402970053255558, mean p set: 0.4502537250518799
loss_pred:0.017493952065706253, decouple_loss:0.0010762097081169486
The modified gen p mean: 0.4505566358566284, gen p mean: -0.03644699975848198, mean p set: 0.4510369300842285The modified gen p mean: 0.45060786604881287, gen p mean: -0.04036835581064224, mean p set: 0.45108816027641296
loss_pred:0.018001612275838852, decouple_loss:0.0011062907287850976
loss_pred:0.017136482521891594, decouple_loss:0.0011280807666480541
Iteration: 1716, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45044082403182983, gen p mean: -0.04198634251952171, mean p set: 0.45092108845710754
loss_pred:0.018615633249282837, decouple_loss:0.0012978597078472376
The modified gen p mean: 0.44960206747055054, gen p mean: -0.03414901718497276, mean p set: 0.45008236169815063The modified gen p mean: 0.44964754581451416, gen p mean: -0.045225199311971664, mean p set: 0.45012786984443665
loss_pred:0.017269210889935493, decouple_loss:0.0012558064190670848
loss_pred:0.01822417974472046, decouple_loss:0.001350722392089665
Iteration: 1717, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44978150725364685, gen p mean: -0.03860824182629585, mean p set: 0.45026183128356934
loss_pred:0.01792464405298233, decouple_loss:0.0010977349011227489
The modified gen p mean: 0.44803759455680847, gen p mean: -0.04334285110235214, mean p set: 0.4485178589820862The modified gen p mean: 0.44998836517333984, gen p mean: -0.03895634785294533, mean p set: 0.45046865940093994
loss_pred:0.017554786056280136, decouple_loss:0.0011147827608510852
loss_pred:0.017588207498192787, decouple_loss:0.001144957379437983
Iteration: 1718, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448740154504776, gen p mean: -0.045308325439691544, mean p set: 0.4492204785346985
loss_pred:0.01763775758445263, decouple_loss:0.001164408982731402
The modified gen p mean: 0.4498051106929779, gen p mean: -0.047336217015981674, mean p set: 0.450285404920578The modified gen p mean: 0.44977566599845886, gen p mean: -0.03738454356789589, mean p set: 0.45025599002838135
loss_pred:0.017550189048051834, decouple_loss:0.001246968749910593
loss_pred:0.0175875723361969, decouple_loss:0.001189516857266426
Iteration: 1719, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496156871318817, gen p mean: -0.035810645669698715, mean p set: 0.4500959813594818
loss_pred:0.01805647276341915, decouple_loss:0.0011402078671380877
The modified gen p mean: 0.4489772617816925, gen p mean: -0.037869133055210114, mean p set: 0.449457585811615The modified gen p mean: 0.44919735193252563, gen p mean: -0.03833621367812157, mean p set: 0.44967761635780334
loss_pred:0.018218178302049637, decouple_loss:0.0010853130370378494
loss_pred:0.01803978718817234, decouple_loss:0.0011508066672831774
Iteration: 1720, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45063337683677673, gen p mean: -0.04176636412739754, mean p set: 0.4511137008666992
loss_pred:0.01743776910007, decouple_loss:0.0010223804274573922
The modified gen p mean: 0.4496327340602875, gen p mean: -0.042486973106861115, mean p set: 0.4501130282878876The modified gen p mean: 0.4495774507522583, gen p mean: -0.04302019253373146, mean p set: 0.4500577449798584
loss_pred:0.0175202414393425, decouple_loss:0.0011408766731619835
loss_pred:0.016980350017547607, decouple_loss:0.0010508224368095398
2023-05-02 09:07:51 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.04908497631549835, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04280154034495354, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04420342296361923, mean p set: 0.4500633478164673
loss_pred:0.018446464091539383, decouple_loss:0.0012810559710487723
loss_pred:0.01747262477874756, decouple_loss:0.0011712698033079505
loss_pred:0.017582828179001808, decouple_loss:0.0011911278124898672
WV_0_PC_1_EH_0_PS_40, loss: 0.017894698306918144, avg_mse: 0.025603311136364937
current test mse: 0.025603
Iteration: 1721, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501861035823822, gen p mean: -0.03792019560933113, mean p set: 0.4506663978099823
The modified gen p mean: 0.44956380128860474, gen p mean: -0.04451591894030571, mean p set: 0.4500441253185272
The modified gen p mean: 0.4495059847831726, gen p mean: -0.042867034673690796, mean p set: 0.4499862790107727
loss_pred:0.017601359635591507, decouple_loss:0.0010707161854952574
loss_pred:0.017896229401230812, decouple_loss:0.0011379863135516644
loss_pred:0.017724892124533653, decouple_loss:0.0010934588499367237
Iteration: 1722, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492156505584717, gen p mean: -0.03628099709749222, mean p set: 0.4496959447860718
loss_pred:0.01805044896900654, decouple_loss:0.0010902263456955552
The modified gen p mean: 0.44938403367996216, gen p mean: -0.04296297952532768, mean p set: 0.44986429810523987The modified gen p mean: 0.44985249638557434, gen p mean: -0.04736979305744171, mean p set: 0.45033276081085205
loss_pred:0.01767539419233799, decouple_loss:0.0011656491551548243
loss_pred:0.017482124269008636, decouple_loss:0.0011365637183189392
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012010_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012010_3_24hr.npz
NaN value num: 0
Iteration: 1723, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479084014892578, gen p mean: -0.04921155050396919, mean p set: 0.4483886957168579
loss_pred:0.015203855000436306, decouple_loss:0.0010743658058345318
The modified gen p mean: 0.4480065703392029, gen p mean: -0.04142360761761665, mean p set: 0.448486864566803The modified gen p mean: 0.4471595585346222, gen p mean: -0.043783679604530334, mean p set: 0.4476398825645447
loss_pred:0.015707658603787422, decouple_loss:0.0010970537550747395
loss_pred:0.014953977428376675, decouple_loss:0.0011433317558839917
Iteration: 1724, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489342272281647, gen p mean: -0.045556917786598206, mean p set: 0.44941452145576477
loss_pred:0.01526936236768961, decouple_loss:0.0012165425578132272
The modified gen p mean: 0.44746914505958557, gen p mean: -0.04478397220373154, mean p set: 0.44794946908950806The modified gen p mean: 0.4472044110298157, gen p mean: -0.04536028951406479, mean p set: 0.44768473505973816
loss_pred:0.015591057948768139, decouple_loss:0.0012448775814846158
loss_pred:0.015663834288716316, decouple_loss:0.0011800403008237481
Iteration: 1725, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488455653190613, gen p mean: -0.04287207871675491, mean p set: 0.449325829744339
loss_pred:0.014523421414196491, decouple_loss:0.001260146964341402
The modified gen p mean: 0.4472237229347229, gen p mean: -0.046363044530153275, mean p set: 0.4477039873600006The modified gen p mean: 0.4485773742198944, gen p mean: -0.04772979021072388, mean p set: 0.4490576982498169
loss_pred:0.014663709327578545, decouple_loss:0.0011606946354731917
loss_pred:0.014665869064629078, decouple_loss:0.0011926041916012764
Iteration: 1726, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466698467731476, gen p mean: -0.04183760657906532, mean p set: 0.4471501410007477
loss_pred:0.015182727947831154, decouple_loss:0.0012996442383155227
The modified gen p mean: 0.446647047996521, gen p mean: -0.049668822437524796, mean p set: 0.4471273422241211The modified gen p mean: 0.447517991065979, gen p mean: -0.04402255266904831, mean p set: 0.4479982852935791
loss_pred:0.015528698451817036, decouple_loss:0.0012298537185415626
loss_pred:0.014737514778971672, decouple_loss:0.0011140306014567614
Iteration: 1727, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478238523006439, gen p mean: -0.04765677452087402, mean p set: 0.448304146528244
loss_pred:0.014935964718461037, decouple_loss:0.001253278343938291
The modified gen p mean: 0.448211133480072, gen p mean: -0.04374020919203758, mean p set: 0.44869139790534973The modified gen p mean: 0.44711413979530334, gen p mean: -0.046139612793922424, mean p set: 0.44759440422058105
loss_pred:0.014937463216483593, decouple_loss:0.001137270126491785
loss_pred:0.014730311930179596, decouple_loss:0.0011919711250811815
Iteration: 1728, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44832539558410645, gen p mean: -0.04779144749045372, mean p set: 0.44880568981170654
loss_pred:0.01473318599164486, decouple_loss:0.0011142374714836478
The modified gen p mean: 0.4486684501171112, gen p mean: -0.04536457732319832, mean p set: 0.4491487443447113The modified gen p mean: 0.44917985796928406, gen p mean: -0.03787288814783096, mean p set: 0.44966015219688416
loss_pred:0.01452354434877634, decouple_loss:0.0011694116983562708
loss_pred:0.014689681120216846, decouple_loss:0.0012310897000133991
Iteration: 1729, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482623040676117, gen p mean: -0.04749748483300209, mean p set: 0.4487426280975342
loss_pred:0.01476791501045227, decouple_loss:0.0014461306855082512
The modified gen p mean: 0.44876834750175476, gen p mean: -0.040262363851070404, mean p set: 0.44924864172935486The modified gen p mean: 0.4464516043663025, gen p mean: -0.04501364007592201, mean p set: 0.4469318985939026
loss_pred:0.01463836058974266, decouple_loss:0.001326781464740634
loss_pred:0.015537776052951813, decouple_loss:0.0014703600900247693
Iteration: 1730, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447181761264801, gen p mean: -0.03705768287181854, mean p set: 0.4476620554924011
loss_pred:0.01535701472312212, decouple_loss:0.0011574903037399054
The modified gen p mean: 0.4472768306732178, gen p mean: -0.03722061961889267, mean p set: 0.4477570950984955The modified gen p mean: 0.44760164618492126, gen p mean: -0.043012309819459915, mean p set: 0.448081910610199
loss_pred:0.015450544655323029, decouple_loss:0.0011289421236142516
loss_pred:0.015325363725423813, decouple_loss:0.0011711366241797805
2023-05-02 09:10:30 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.04535069689154625, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.03944241255521774, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.040647540241479874, mean p set: 0.4500633478164673
loss_pred:0.018831299617886543, decouple_loss:0.0014083260903134942
loss_pred:0.017868824303150177, decouple_loss:0.001365727512165904
loss_pred:0.017927136272192, decouple_loss:0.0012905888725072145
WV_0_PC_1_EH_0_PS_40, loss: 0.01827683113515377, avg_mse: 0.026348719373345375
current test mse: 0.026349
Iteration: 1731, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44848939776420593, gen p mean: -0.04152359813451767, mean p set: 0.44896969199180603
The modified gen p mean: 0.44849157333374023, gen p mean: -0.039874814450740814, mean p set: 0.44897186756134033
The modified gen p mean: 0.44741079211235046, gen p mean: -0.04333718121051788, mean p set: 0.44789108633995056
loss_pred:0.01544948760420084, decouple_loss:0.001581272459588945
loss_pred:0.014953318051993847, decouple_loss:0.0014069207245483994
loss_pred:0.014985252171754837, decouple_loss:0.0015602371422573924
Iteration: 1732, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465717077255249, gen p mean: -0.037962522357702255, mean p set: 0.4470519721508026
loss_pred:0.014770873822271824, decouple_loss:0.0011954752262681723
The modified gen p mean: 0.4468585252761841, gen p mean: -0.04380996525287628, mean p set: 0.4473388195037842The modified gen p mean: 0.4484303593635559, gen p mean: -0.040122754871845245, mean p set: 0.448910653591156
loss_pred:0.014056301675736904, decouple_loss:0.0012655426980927587
loss_pred:0.014545229263603687, decouple_loss:0.0013171322643756866
Iteration: 1733, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44812920689582825, gen p mean: -0.03825032711029053, mean p set: 0.44860947132110596
loss_pred:0.01468012947589159, decouple_loss:0.0013521037762984633
The modified gen p mean: 0.4477115571498871, gen p mean: -0.03954291716217995, mean p set: 0.4481918513774872The modified gen p mean: 0.4467315375804901, gen p mean: -0.03843504562973976, mean p set: 0.4472118318080902
loss_pred:0.01483066100627184, decouple_loss:0.0012592367129400373
loss_pred:0.014572775922715664, decouple_loss:0.0013763941824436188
Iteration: 1734, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477587342262268, gen p mean: -0.04299468919634819, mean p set: 0.4482389986515045
loss_pred:0.014319369569420815, decouple_loss:0.0013237951789051294
The modified gen p mean: 0.4480511248111725, gen p mean: -0.04469757154583931, mean p set: 0.44853144884109497The modified gen p mean: 0.44752150774002075, gen p mean: -0.040346574038267136, mean p set: 0.44800183176994324
loss_pred:0.014296445995569229, decouple_loss:0.0013299370184540749
loss_pred:0.0151222450658679, decouple_loss:0.0013471036218106747
Iteration: 1735, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44710662961006165, gen p mean: -0.04957278445363045, mean p set: 0.44758692383766174
loss_pred:0.015116983093321323, decouple_loss:0.0012434297241270542
The modified gen p mean: 0.4479628801345825, gen p mean: -0.04426640644669533, mean p set: 0.448443204164505The modified gen p mean: 0.4472235441207886, gen p mean: -0.041275832802057266, mean p set: 0.44770386815071106
loss_pred:0.014386896044015884, decouple_loss:0.0013271571369841695
loss_pred:0.01468551717698574, decouple_loss:0.0011875263880938292
Iteration: 1736, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476369321346283, gen p mean: -0.04954170435667038, mean p set: 0.4481172263622284
loss_pred:0.015062877908349037, decouple_loss:0.0013539165956899524
The modified gen p mean: 0.4480394124984741, gen p mean: -0.04517575353384018, mean p set: 0.4485197067260742The modified gen p mean: 0.44782304763793945, gen p mean: -0.043611787259578705, mean p set: 0.44830334186553955
loss_pred:0.01547144539654255, decouple_loss:0.0012631438439711928
loss_pred:0.014742224477231503, decouple_loss:0.0013447694946080446
Iteration: 1737, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44840559363365173, gen p mean: -0.03260580450296402, mean p set: 0.44888588786125183
loss_pred:0.01488544512540102, decouple_loss:0.0012895188992843032
The modified gen p mean: 0.44752365350723267, gen p mean: -0.03993760421872139, mean p set: 0.44800394773483276The modified gen p mean: 0.4469422698020935, gen p mean: -0.033290788531303406, mean p set: 0.447422593832016
loss_pred:0.014681306667625904, decouple_loss:0.0013175442581996322
loss_pred:0.015032805502414703, decouple_loss:0.001259081531316042
Iteration: 1738, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480860233306885, gen p mean: -0.03283276781439781, mean p set: 0.4485662877559662
loss_pred:0.014406884089112282, decouple_loss:0.0014057249063625932
The modified gen p mean: 0.447172075510025, gen p mean: -0.03562718257308006, mean p set: 0.4476523995399475The modified gen p mean: 0.44818034768104553, gen p mean: -0.02704315446317196, mean p set: 0.44866064190864563
loss_pred:0.01480068638920784, decouple_loss:0.0013094706228002906
loss_pred:0.015062443912029266, decouple_loss:0.001512525719590485
Iteration: 1739, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481221139431, gen p mean: -0.03017916902899742, mean p set: 0.4486024081707001
loss_pred:0.014950718730688095, decouple_loss:0.0012530082603916526
The modified gen p mean: 0.4481261670589447, gen p mean: -0.029782302677631378, mean p set: 0.4486064314842224The modified gen p mean: 0.447144091129303, gen p mean: -0.02797992341220379, mean p set: 0.44762441515922546
loss_pred:0.014947024174034595, decouple_loss:0.001292961067520082
loss_pred:0.015236354433000088, decouple_loss:0.0014445270644500852
Iteration: 1740, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44782400131225586, gen p mean: -0.038064874708652496, mean p set: 0.44830429553985596
loss_pred:0.014565203338861465, decouple_loss:0.001518766744993627
The modified gen p mean: 0.44689860939979553, gen p mean: -0.04107135161757469, mean p set: 0.44737890362739563The modified gen p mean: 0.4477773904800415, gen p mean: -0.038381483405828476, mean p set: 0.4482576549053192
loss_pred:0.015226026996970177, decouple_loss:0.0014756248565390706
loss_pred:0.015173631720244884, decouple_loss:0.0013706303434446454
2023-05-02 09:12:26 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.04630713537335396, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.03986888751387596, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.041502200067043304, mean p set: 0.4500633478164673
loss_pred:0.019203992560505867, decouple_loss:0.001509430818259716
loss_pred:0.01825966127216816, decouple_loss:0.0014213018584996462
loss_pred:0.018336301669478416, decouple_loss:0.0014228059444576502
WV_0_PC_1_EH_0_PS_40, loss: 0.01867254450917244, avg_mse: 0.02706655114889145
current test mse: 0.027067
Iteration: 1741, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472287595272064, gen p mean: -0.03909749910235405, mean p set: 0.4477090537548065
The modified gen p mean: 0.4472210109233856, gen p mean: -0.04892648383975029, mean p set: 0.4477013349533081
The modified gen p mean: 0.4473575949668884, gen p mean: -0.04035560414195061, mean p set: 0.4478378891944885
loss_pred:0.0142373563721776, decouple_loss:0.0013897998724132776
loss_pred:0.014565762132406235, decouple_loss:0.001459050108678639
loss_pred:0.01493850164115429, decouple_loss:0.001506949309259653
Iteration: 1742, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469960927963257, gen p mean: -0.043261799961328506, mean p set: 0.4474763870239258
loss_pred:0.015059069730341434, decouple_loss:0.0014341470086947083
The modified gen p mean: 0.446898490190506, gen p mean: -0.04398803412914276, mean p set: 0.4473787844181061The modified gen p mean: 0.44735005497932434, gen p mean: -0.04861237108707428, mean p set: 0.44783034920692444
loss_pred:0.014794040471315384, decouple_loss:0.0013031336711719632
loss_pred:0.015074276365339756, decouple_loss:0.0014844292309135199
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012009_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012009_3_24hr.npz
NaN value num: 0
Iteration: 1743, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44558775424957275, gen p mean: -0.05402518808841705, mean p set: 0.44606801867485046
loss_pred:0.0151951489970088, decouple_loss:0.0014444241533055902
The modified gen p mean: 0.44679686427116394, gen p mean: -0.05284580960869789, mean p set: 0.44727712869644165The modified gen p mean: 0.44741398096084595, gen p mean: -0.04743252694606781, mean p set: 0.44789430499076843
loss_pred:0.014945851638913155, decouple_loss:0.001392305945046246
loss_pred:0.014985175803303719, decouple_loss:0.0013339779106900096
Iteration: 1744, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476727545261383, gen p mean: -0.04820355772972107, mean p set: 0.4481530487537384
loss_pred:0.01465134508907795, decouple_loss:0.0013624035054817796
The modified gen p mean: 0.4478175938129425, gen p mean: -0.04744771495461464, mean p set: 0.4482978880405426The modified gen p mean: 0.44852009415626526, gen p mean: -0.04741298779845238, mean p set: 0.44900041818618774
loss_pred:0.01504545845091343, decouple_loss:0.001486912020482123
loss_pred:0.014624099247157574, decouple_loss:0.0014313864521682262
Iteration: 1745, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44661805033683777, gen p mean: -0.05097704008221626, mean p set: 0.44709834456443787
loss_pred:0.014713644981384277, decouple_loss:0.0014164116000756621
The modified gen p mean: 0.44803324341773987, gen p mean: -0.043475355952978134, mean p set: 0.44851356744766235The modified gen p mean: 0.4454862177371979, gen p mean: -0.049080442637205124, mean p set: 0.445966511964798
loss_pred:0.015349147841334343, decouple_loss:0.0014555073576048017
loss_pred:0.01528110820800066, decouple_loss:0.0013250336050987244
Iteration: 1746, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493890106678009, gen p mean: -0.04141227528452873, mean p set: 0.449869304895401
loss_pred:0.015204578638076782, decouple_loss:0.0013864664360880852
The modified gen p mean: 0.44784677028656006, gen p mean: -0.04296482726931572, mean p set: 0.44832706451416016The modified gen p mean: 0.4471273422241211, gen p mean: -0.044540129601955414, mean p set: 0.4476076066493988
loss_pred:0.014829374849796295, decouple_loss:0.0013776408741250634
loss_pred:0.014723626896739006, decouple_loss:0.0013751770602539182
Iteration: 1747, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44697925448417664, gen p mean: -0.04650987684726715, mean p set: 0.44745954871177673
loss_pred:0.014722672291100025, decouple_loss:0.0013220105320215225
The modified gen p mean: 0.44982993602752686, gen p mean: -0.04309425875544548, mean p set: 0.45031026005744934The modified gen p mean: 0.4470822811126709, gen p mean: -0.04433341696858406, mean p set: 0.447562575340271
loss_pred:0.014813721179962158, decouple_loss:0.0013913650764152408
loss_pred:0.01473607774823904, decouple_loss:0.001371470163576305
Iteration: 1748, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472886323928833, gen p mean: -0.03984535485506058, mean p set: 0.4477689266204834
loss_pred:0.014842062257230282, decouple_loss:0.0012345595750957727
The modified gen p mean: 0.4480317533016205, gen p mean: -0.040886130183935165, mean p set: 0.4485120475292206The modified gen p mean: 0.44688740372657776, gen p mean: -0.039494890719652176, mean p set: 0.44736772775650024
loss_pred:0.01524503156542778, decouple_loss:0.0012860280694440007
loss_pred:0.0145772285759449, decouple_loss:0.0013031399575993419
Iteration: 1749, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483940899372101, gen p mean: -0.04130047932267189, mean p set: 0.44887441396713257
loss_pred:0.014981028623878956, decouple_loss:0.001220813486725092
The modified gen p mean: 0.44608765840530396, gen p mean: -0.04531469568610191, mean p set: 0.44656795263290405The modified gen p mean: 0.44623613357543945, gen p mean: -0.04743773862719536, mean p set: 0.44671642780303955
loss_pred:0.014990270137786865, decouple_loss:0.001299933297559619
loss_pred:0.014607605524361134, decouple_loss:0.0013046753592789173
Iteration: 1750, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474327862262726, gen p mean: -0.039787836372852325, mean p set: 0.4479130506515503
loss_pred:0.014600987546145916, decouple_loss:0.0013008067617192864
The modified gen p mean: 0.44727861881256104, gen p mean: -0.04446056857705116, mean p set: 0.44775891304016113
The modified gen p mean: 0.4468348026275635, gen p mean: -0.04152800887823105, mean p set: 0.4473150670528412
loss_pred:0.014769681729376316, decouple_loss:0.001573843532241881
loss_pred:0.014688200317323208, decouple_loss:0.0016118946950882673
2023-05-02 09:15:04 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.04501025006175041, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.039235156029462814, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.0398557074368, mean p set: 0.4500633478164673
loss_pred:0.018956629559397697, decouple_loss:0.0013686661841347814
loss_pred:0.017979906871914864, decouple_loss:0.0013144928961992264
loss_pred:0.018117543309926987, decouple_loss:0.0013627372682094574
WV_0_PC_1_EH_0_PS_40, loss: 0.018418792635202408, avg_mse: 0.026621388271450996
current test mse: 0.026621
Iteration: 1751, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448513925075531, gen p mean: -0.04220752790570259, mean p set: 0.4489942789077759
The modified gen p mean: 0.44778165221214294, gen p mean: -0.04266972467303276, mean p set: 0.44826194643974304
The modified gen p mean: 0.44761431217193604, gen p mean: -0.04413493350148201, mean p set: 0.4480946362018585
loss_pred:0.014658642001450062, decouple_loss:0.0013077519834041595
loss_pred:0.014800925739109516, decouple_loss:0.0012335021747276187
loss_pred:0.015141511335968971, decouple_loss:0.001313819782808423
Iteration: 1752, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44736161828041077, gen p mean: -0.04342593252658844, mean p set: 0.44784191250801086
loss_pred:0.014494377188384533, decouple_loss:0.0013745398027822375
The modified gen p mean: 0.44713956117630005, gen p mean: -0.04816092178225517, mean p set: 0.44761988520622253
The modified gen p mean: 0.4471665322780609, gen p mean: -0.04267042130231857, mean p set: 0.447646826505661
loss_pred:0.014569289982318878, decouple_loss:0.0013792793033644557
loss_pred:0.014726253226399422, decouple_loss:0.001554770627990365
Iteration: 1753, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44773581624031067, gen p mean: -0.041608989238739014, mean p set: 0.44821611046791077
loss_pred:0.014857002533972263, decouple_loss:0.0012262153904885054
The modified gen p mean: 0.44698143005371094, gen p mean: -0.043669212609529495, mean p set: 0.4474617540836334The modified gen p mean: 0.44732388854026794, gen p mean: -0.04021352156996727, mean p set: 0.44780421257019043
loss_pred:0.014651336707174778, decouple_loss:0.001190400798805058
loss_pred:0.014457708224654198, decouple_loss:0.0011829710565507412
Iteration: 1754, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44779470562934875, gen p mean: -0.037984512746334076, mean p set: 0.44827497005462646
loss_pred:0.014287153258919716, decouple_loss:0.0013418612070381641
The modified gen p mean: 0.4483659267425537, gen p mean: -0.04451185092329979, mean p set: 0.4488462209701538The modified gen p mean: 0.448018342256546, gen p mean: -0.0448949970304966, mean p set: 0.4484986364841461
loss_pred:0.01455328706651926, decouple_loss:0.0012875800020992756
loss_pred:0.014352967031300068, decouple_loss:0.0012730516027659178
Iteration: 1755, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44719719886779785, gen p mean: -0.04485411196947098, mean p set: 0.44767752289772034
loss_pred:0.014330289326608181, decouple_loss:0.0012213995214551687
The modified gen p mean: 0.446424663066864, gen p mean: -0.04604843631386757, mean p set: 0.4469049572944641The modified gen p mean: 0.4473932087421417, gen p mean: -0.0451783649623394, mean p set: 0.4478735327720642
loss_pred:0.014403557404875755, decouple_loss:0.0011805113172158599
loss_pred:0.014748729765415192, decouple_loss:0.0012538984883576632
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1756, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44727686047554016, gen p mean: -0.043718449771404266, mean p set: 0.44775715470314026
loss_pred:0.014481723308563232, decouple_loss:0.0012328914599493146
The modified gen p mean: 0.44861432909965515, gen p mean: -0.0411398820579052, mean p set: 0.44909462332725525The modified gen p mean: 0.44614720344543457, gen p mean: -0.04819260165095329, mean p set: 0.4466274678707123
loss_pred:0.014384840615093708, decouple_loss:0.001270042615942657
loss_pred:0.014739732258021832, decouple_loss:0.0012174791190773249
Iteration: 1757, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478420615196228, gen p mean: -0.04192039743065834, mean p set: 0.4483223557472229
loss_pred:0.01430758647620678, decouple_loss:0.001201224629767239
The modified gen p mean: 0.44909846782684326, gen p mean: -0.04805650934576988, mean p set: 0.44957879185676575The modified gen p mean: 0.4461551308631897, gen p mean: -0.047609977424144745, mean p set: 0.4466353952884674
loss_pred:0.014680646359920502, decouple_loss:0.001280654571019113
loss_pred:0.01422722265124321, decouple_loss:0.0012861783616244793
Iteration: 1758, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44854751229286194, gen p mean: -0.04105156660079956, mean p set: 0.44902777671813965
loss_pred:0.01461360976099968, decouple_loss:0.0012294553453102708
The modified gen p mean: 0.44753408432006836, gen p mean: -0.038437023758888245, mean p set: 0.44801437854766846The modified gen p mean: 0.44760698080062866, gen p mean: -0.0440291129052639, mean p set: 0.448087215423584
loss_pred:0.01441655121743679, decouple_loss:0.0013232061173766851
loss_pred:0.014132825657725334, decouple_loss:0.00117736856918782
Iteration: 1759, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44821032881736755, gen p mean: -0.04334110766649246, mean p set: 0.44869065284729004
The modified gen p mean: 0.4483204185962677, gen p mean: -0.04314257577061653, mean p set: 0.4488007128238678
loss_pred:0.014439046382904053, decouple_loss:0.0011750998673960567
loss_pred:0.014477802440524101, decouple_loss:0.0012018010020256042
The modified gen p mean: 0.4487951695919037, gen p mean: -0.038129936903715134, mean p set: 0.4492754638195038
loss_pred:0.014519009739160538, decouple_loss:0.0013902893988415599
Iteration: 1760, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44760459661483765, gen p mean: -0.041499994695186615, mean p set: 0.44808489084243774
loss_pred:0.01411291491240263, decouple_loss:0.0011909841559827328
The modified gen p mean: 0.4474954903125763, gen p mean: -0.03939720615744591, mean p set: 0.4479758143424988
The modified gen p mean: 0.44930770993232727, gen p mean: -0.04159006476402283, mean p set: 0.449787974357605
loss_pred:0.014020138420164585, decouple_loss:0.0012632831931114197
loss_pred:0.014306802302598953, decouple_loss:0.0013098366325721145
2023-05-02 09:16:59 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.041598327457904816, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.03630998358130455, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.037051573395729065, mean p set: 0.4500633478164673
loss_pred:0.018967024981975555, decouple_loss:0.0012723805848509073
loss_pred:0.017981190234422684, decouple_loss:0.0013183404225856066
loss_pred:0.01804966665804386, decouple_loss:0.0012643501395359635
WV_0_PC_1_EH_0_PS_40, loss: 0.018396880477666855, avg_mse: 0.026646096259355545
current test mse: 0.026646
Iteration: 1761, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475298225879669, gen p mean: -0.041058462113142014, mean p set: 0.44801008701324463
The modified gen p mean: 0.4468082785606384, gen p mean: -0.04102853313088417, mean p set: 0.4472885727882385
The modified gen p mean: 0.4461553990840912, gen p mean: -0.04163685068488121, mean p set: 0.4466356933116913
loss_pred:0.014351537451148033, decouple_loss:0.0012454078532755375
loss_pred:0.014634582214057446, decouple_loss:0.0013826134381815791
loss_pred:0.014437073841691017, decouple_loss:0.0012768859742209315
Iteration: 1762, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483109414577484, gen p mean: -0.03540907800197601, mean p set: 0.4487912356853485
loss_pred:0.014723275788128376, decouple_loss:0.001119182095862925
The modified gen p mean: 0.4487041234970093, gen p mean: -0.042416274547576904, mean p set: 0.449184387922287The modified gen p mean: 0.4494333267211914, gen p mean: -0.03864950314164162, mean p set: 0.4499136209487915
loss_pred:0.014326275326311588, decouple_loss:0.0011752014979720116
loss_pred:0.014359334483742714, decouple_loss:0.0010569406440481544
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012011_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012011_3_24hr.npz
NaN value num: 0
Iteration: 1763, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475812315940857, gen p mean: -0.03453095257282257, mean p set: 0.4480615258216858
loss_pred:0.01443502213805914, decouple_loss:0.0012879325076937675
The modified gen p mean: 0.44769522547721863, gen p mean: -0.041028060019016266, mean p set: 0.4481755197048187The modified gen p mean: 0.44757816195487976, gen p mean: -0.04076163098216057, mean p set: 0.44805845618247986
loss_pred:0.013930547051131725, decouple_loss:0.0013174386695027351
loss_pred:0.01400446891784668, decouple_loss:0.0013615840580314398
Iteration: 1764, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44797438383102417, gen p mean: -0.03191152587532997, mean p set: 0.44845467805862427
loss_pred:0.014124508947134018, decouple_loss:0.0012187102111056447
The modified gen p mean: 0.44794023036956787, gen p mean: -0.03657987341284752, mean p set: 0.44842052459716797The modified gen p mean: 0.44962751865386963, gen p mean: -0.034133344888687134, mean p set: 0.45010778307914734
loss_pred:0.014443456195294857, decouple_loss:0.001160953426733613
loss_pred:0.013965222053229809, decouple_loss:0.0011260572355240583
Iteration: 1765, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446834534406662, gen p mean: -0.041140079498291016, mean p set: 0.4473148286342621
loss_pred:0.014011012390255928, decouple_loss:0.0012722833780571818
The modified gen p mean: 0.4473905861377716, gen p mean: -0.03309588506817818, mean p set: 0.4478708505630493The modified gen p mean: 0.4471130669116974, gen p mean: -0.03696690499782562, mean p set: 0.4475933611392975
loss_pred:0.014147344045341015, decouple_loss:0.001271720975637436
loss_pred:0.015081350691616535, decouple_loss:0.0013433166313916445
Iteration: 1766, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475351572036743, gen p mean: -0.03833761438727379, mean p set: 0.4480154812335968
loss_pred:0.01374365109950304, decouple_loss:0.0012357636587694287
The modified gen p mean: 0.4485373795032501, gen p mean: -0.03274590149521828, mean p set: 0.4490176737308502The modified gen p mean: 0.44773584604263306, gen p mean: -0.0383727103471756, mean p set: 0.44821614027023315
loss_pred:0.014644887298345566, decouple_loss:0.0011909216409549117
loss_pred:0.014727682806551456, decouple_loss:0.0011816745391115546
Iteration: 1767, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44741091132164, gen p mean: -0.03706790879368782, mean p set: 0.4478912055492401
The modified gen p mean: 0.44765564799308777, gen p mean: -0.03838605061173439, mean p set: 0.44813597202301025
loss_pred:0.015099827200174332, decouple_loss:0.0013122677337378263
loss_pred:0.014894576743245125, decouple_loss:0.0013828029623255134
The modified gen p mean: 0.4474719762802124, gen p mean: -0.03614278510212898, mean p set: 0.4479523003101349
loss_pred:0.014818785712122917, decouple_loss:0.0012230270076543093
Iteration: 1768, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478502869606018, gen p mean: -0.04276769235730171, mean p set: 0.4483305513858795
loss_pred:0.014704916626214981, decouple_loss:0.0012663258239626884
The modified gen p mean: 0.44768840074539185, gen p mean: -0.04788962006568909, mean p set: 0.44816869497299194The modified gen p mean: 0.4486345052719116, gen p mean: -0.03699657320976257, mean p set: 0.4491148293018341
loss_pred:0.01428766269236803, decouple_loss:0.0011836395133286715
loss_pred:0.014233523979783058, decouple_loss:0.001229490851983428
Iteration: 1769, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481147825717926, gen p mean: -0.047322701662778854, mean p set: 0.4485950767993927
The modified gen p mean: 0.44812625646591187, gen p mean: -0.04098505899310112, mean p set: 0.44860655069351196
loss_pred:0.013827950693666935, decouple_loss:0.0011430263984948397
loss_pred:0.014011762104928493, decouple_loss:0.0010974477045238018
The modified gen p mean: 0.44720175862312317, gen p mean: -0.044989198446273804, mean p set: 0.44768205285072327
loss_pred:0.015055076219141483, decouple_loss:0.0012466753832995892
Iteration: 1770, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44778740406036377, gen p mean: -0.04255129396915436, mean p set: 0.4482676684856415
The modified gen p mean: 0.4478898048400879, gen p mean: -0.04348576068878174, mean p set: 0.4483700692653656
loss_pred:0.01447200495749712, decouple_loss:0.00119887909386307
loss_pred:0.013669759035110474, decouple_loss:0.0012648672563955188
The modified gen p mean: 0.44797784090042114, gen p mean: -0.045561566948890686, mean p set: 0.44845813512802124
loss_pred:0.01358158141374588, decouple_loss:0.0012130984105169773
2023-05-02 09:19:31 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.0463147796690464, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04077492281794548, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.04165542870759964, mean p set: 0.4500633478164673
loss_pred:0.019028399139642715, decouple_loss:0.0012647402472794056
loss_pred:0.018020471557974815, decouple_loss:0.0011693529086187482
loss_pred:0.01803242415189743, decouple_loss:0.0011664868798106909
WV_0_PC_1_EH_0_PS_40, loss: 0.018420441076159477, avg_mse: 0.02673909440636635
current test mse: 0.026739
Iteration: 1771, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467989206314087, gen p mean: -0.04457537457346916, mean p set: 0.4472792148590088
The modified gen p mean: 0.4486341178417206, gen p mean: -0.03784066066145897, mean p set: 0.4491144120693207
The modified gen p mean: 0.44720330834388733, gen p mean: -0.03746390715241432, mean p set: 0.4476836025714874
loss_pred:0.013812307268381119, decouple_loss:0.0012469341745600104
loss_pred:0.014311548322439194, decouple_loss:0.0011276865843683481
loss_pred:0.013877172023057938, decouple_loss:0.0010864600772038102
Iteration: 1772, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44766753911972046, gen p mean: -0.0382688045501709, mean p set: 0.44814783334732056
loss_pred:0.014401420019567013, decouple_loss:0.0010886465897783637
The modified gen p mean: 0.4481104910373688, gen p mean: -0.04343334957957268, mean p set: 0.44859078526496887The modified gen p mean: 0.4471355974674225, gen p mean: -0.03904701769351959, mean p set: 0.4476158618927002
loss_pred:0.01482434757053852, decouple_loss:0.0011340886121615767
loss_pred:0.013572381809353828, decouple_loss:0.0010973203461617231
Iteration: 1773, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490791857242584, gen p mean: -0.03324428200721741, mean p set: 0.4495594799518585
loss_pred:0.013958992436528206, decouple_loss:0.0012094223638996482
The modified gen p mean: 0.4478875398635864, gen p mean: -0.04044375568628311, mean p set: 0.44836780428886414The modified gen p mean: 0.4488285183906555, gen p mean: -0.04286299645900726, mean p set: 0.449308842420578
loss_pred:0.013308645226061344, decouple_loss:0.0011504861759021878
loss_pred:0.014816776849329472, decouple_loss:0.0012370074400678277
Iteration: 1774, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44808363914489746, gen p mean: -0.03589081019163132, mean p set: 0.44856393337249756
loss_pred:0.014566803351044655, decouple_loss:0.0011261795880272985
The modified gen p mean: 0.44705930352211, gen p mean: -0.04625241085886955, mean p set: 0.44753962755203247The modified gen p mean: 0.44704321026802063, gen p mean: -0.03988221660256386, mean p set: 0.4475235044956207
loss_pred:0.013849016278982162, decouple_loss:0.0011462672846391797
loss_pred:0.013945147395133972, decouple_loss:0.001106047653593123
Iteration: 1775, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476890563964844, gen p mean: -0.04004378244280815, mean p set: 0.4481693506240845
loss_pred:0.013586742803454399, decouple_loss:0.001191060640849173
The modified gen p mean: 0.4482946991920471, gen p mean: -0.037866655737161636, mean p set: 0.4487749934196472The modified gen p mean: 0.44732335209846497, gen p mean: -0.045645955950021744, mean p set: 0.44780364632606506
loss_pred:0.013990899547934532, decouple_loss:0.0012284924741834402
loss_pred:0.014382942579686642, decouple_loss:0.0011818994535133243
Iteration: 1776, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44715616106987, gen p mean: -0.03775827959179878, mean p set: 0.4476364552974701
loss_pred:0.014625810086727142, decouple_loss:0.0011687740916386247
The modified gen p mean: 0.4470285177230835, gen p mean: -0.03916218504309654, mean p set: 0.4475088119506836The modified gen p mean: 0.44653698801994324, gen p mean: -0.03752406686544418, mean p set: 0.44701725244522095
loss_pred:0.014689521864056587, decouple_loss:0.0011445754207670689
loss_pred:0.014376881532371044, decouple_loss:0.0010661500273272395
Iteration: 1777, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44750165939331055, gen p mean: -0.039991848170757294, mean p set: 0.44798195362091064
loss_pred:0.014011172577738762, decouple_loss:0.0011357510229572654
The modified gen p mean: 0.44774556159973145, gen p mean: -0.03696077689528465, mean p set: 0.44822585582733154The modified gen p mean: 0.4473133087158203, gen p mean: -0.04423198476433754, mean p set: 0.4477936327457428
loss_pred:0.014666568487882614, decouple_loss:0.00120174465700984
loss_pred:0.013501309789717197, decouple_loss:0.0012454320676624775
Iteration: 1778, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44764891266822815, gen p mean: -0.041717588901519775, mean p set: 0.44812917709350586
loss_pred:0.014136319048702717, decouple_loss:0.0011383413802832365
The modified gen p mean: 0.44870516657829285, gen p mean: -0.04160323366522789, mean p set: 0.44918543100357056The modified gen p mean: 0.4471810758113861, gen p mean: -0.041864294558763504, mean p set: 0.4476613700389862
loss_pred:0.013575227931141853, decouple_loss:0.001143583212979138
loss_pred:0.014345059171319008, decouple_loss:0.0011318553006276488
Iteration: 1779, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44780397415161133, gen p mean: -0.039826806634664536, mean p set: 0.4482842683792114
loss_pred:0.014684528112411499, decouple_loss:0.001317517482675612
The modified gen p mean: 0.4468989074230194, gen p mean: -0.04608609527349472, mean p set: 0.4473792016506195The modified gen p mean: 0.449092298746109, gen p mean: -0.03269917517900467, mean p set: 0.4495725929737091
loss_pred:0.013877074234187603, decouple_loss:0.0012839360861107707
loss_pred:0.013942494057118893, decouple_loss:0.001263161888346076
Iteration: 1780, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44815152883529663, gen p mean: -0.04296868294477463, mean p set: 0.44863179326057434
loss_pred:0.013638930395245552, decouple_loss:0.0011347096879035234
The modified gen p mean: 0.4481607973575592, gen p mean: -0.044342972338199615, mean p set: 0.4486410617828369The modified gen p mean: 0.44735175371170044, gen p mean: -0.041236985474824905, mean p set: 0.44783204793930054
loss_pred:0.01366912666708231, decouple_loss:0.001118851825594902
loss_pred:0.014403156004846096, decouple_loss:0.0012430176138877869
2023-05-02 09:21:26 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.04403669759631157, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.03859845921397209, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.03953354433178902, mean p set: 0.4500633478164673
loss_pred:0.019053904339671135, decouple_loss:0.0011421763338148594
loss_pred:0.018027249723672867, decouple_loss:0.001192800235003233loss_pred:0.018074939027428627, decouple_loss:0.0011427236022427678
WV_0_PC_1_EH_0_PS_40, loss: 0.018443327397108078, avg_mse: 0.026803597807884216
current test mse: 0.026804
Iteration: 1781, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494800865650177, gen p mean: -0.030672186985611916, mean p set: 0.4499603509902954
The modified gen p mean: 0.44776228070259094, gen p mean: -0.035422805696725845, mean p set: 0.44824254512786865
The modified gen p mean: 0.44668814539909363, gen p mean: -0.039119187742471695, mean p set: 0.4471684396266937
loss_pred:0.014369288459420204, decouple_loss:0.0010998784564435482
loss_pred:0.013793054036796093, decouple_loss:0.001174451899714768
loss_pred:0.014755245298147202, decouple_loss:0.0011383626842871308
Iteration: 1782, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44857919216156006, gen p mean: -0.0383940264582634, mean p set: 0.44905948638916016
loss_pred:0.014243045821785927, decouple_loss:0.001101017463952303
The modified gen p mean: 0.4480414092540741, gen p mean: -0.03690163418650627, mean p set: 0.4485217034816742The modified gen p mean: 0.44727474451065063, gen p mean: -0.04219313710927963, mean p set: 0.44775503873825073
loss_pred:0.013651435263454914, decouple_loss:0.0010906633688136935
loss_pred:0.013794747181236744, decouple_loss:0.0012060748413205147
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012010_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012010_3_24hr.npz
NaN value num: 0
Iteration: 1783, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44943326711654663, gen p mean: -0.03663996234536171, mean p set: 0.44991356134414673
loss_pred:0.017599254846572876, decouple_loss:0.0014284518547356129
The modified gen p mean: 0.4522785544395447, gen p mean: -0.03983701393008232, mean p set: 0.4527588486671448The modified gen p mean: 0.44757890701293945, gen p mean: -0.03714584559202194, mean p set: 0.44805923104286194
loss_pred:0.017241578549146652, decouple_loss:0.0012286179699003696
loss_pred:0.01688438467681408, decouple_loss:0.0014117936370894313
Iteration: 1784, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44778576493263245, gen p mean: -0.029644252732396126, mean p set: 0.44826605916023254
loss_pred:0.018006151542067528, decouple_loss:0.0012499716831371188
The modified gen p mean: 0.448701411485672, gen p mean: -0.030871829017996788, mean p set: 0.4491817057132721The modified gen p mean: 0.4500812888145447, gen p mean: -0.029944347217679024, mean p set: 0.4505615830421448
loss_pred:0.016736095771193504, decouple_loss:0.0012026896001771092
loss_pred:0.017076214775443077, decouple_loss:0.0012038833228871226
Iteration: 1785, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45065584778785706, gen p mean: -0.02459581568837166, mean p set: 0.45113611221313477
loss_pred:0.017503423616290092, decouple_loss:0.001303679309785366
The modified gen p mean: 0.4486565887928009, gen p mean: -0.024703362956643105, mean p set: 0.449136883020401The modified gen p mean: 0.44971993565559387, gen p mean: -0.028947778046131134, mean p set: 0.4502002000808716
loss_pred:0.01672397367656231, decouple_loss:0.001293547684326768
loss_pred:0.01786024682223797, decouple_loss:0.0013048695400357246
Iteration: 1786, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44837361574172974, gen p mean: -0.02547113411128521, mean p set: 0.44885390996932983
loss_pred:0.016498595476150513, decouple_loss:0.0012928020441904664
The modified gen p mean: 0.4501053988933563, gen p mean: -0.022481516003608704, mean p set: 0.4505856931209564
The modified gen p mean: 0.44841107726097107, gen p mean: -0.02061113901436329, mean p set: 0.44889137148857117
loss_pred:0.01708112470805645, decouple_loss:0.0013203794369474053
loss_pred:0.017631439492106438, decouple_loss:0.001140778069384396
Iteration: 1787, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44821226596832275, gen p mean: -0.019526688382029533, mean p set: 0.44869256019592285
loss_pred:0.016950810328125954, decouple_loss:0.0013387020444497466
The modified gen p mean: 0.44928550720214844, gen p mean: -0.019563931971788406, mean p set: 0.44976580142974854The modified gen p mean: 0.4491461515426636, gen p mean: -0.018221508711576462, mean p set: 0.44962644577026367
loss_pred:0.01721012033522129, decouple_loss:0.001266252133063972
loss_pred:0.017160890623927116, decouple_loss:0.001243945793248713
Iteration: 1788, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497770667076111, gen p mean: -0.029312605038285255, mean p set: 0.45025739073753357
loss_pred:0.017912738025188446, decouple_loss:0.001445301342755556
The modified gen p mean: 0.44929370284080505, gen p mean: -0.021598326042294502, mean p set: 0.44977399706840515The modified gen p mean: 0.4508529603481293, gen p mean: -0.02207762748003006, mean p set: 0.45133325457572937
loss_pred:0.017029155045747757, decouple_loss:0.0012925243936479092
loss_pred:0.01716288924217224, decouple_loss:0.0012652212753891945
Iteration: 1789, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4515320658683777, gen p mean: -0.024570852518081665, mean p set: 0.4520123302936554
loss_pred:0.01662621647119522, decouple_loss:0.0012947903014719486
The modified gen p mean: 0.4496040344238281, gen p mean: -0.020199397578835487, mean p set: 0.4500843286514282The modified gen p mean: 0.44969040155410767, gen p mean: -0.019320782274007797, mean p set: 0.45017069578170776
loss_pred:0.01771104522049427, decouple_loss:0.0013179496163502336
loss_pred:0.01703936606645584, decouple_loss:0.0012436273973435163
Iteration: 1790, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491357207298279, gen p mean: -0.02412588894367218, mean p set: 0.44961604475975037
loss_pred:0.01641249656677246, decouple_loss:0.001295594614930451
The modified gen p mean: 0.45162808895111084, gen p mean: -0.029895391315221786, mean p set: 0.4521084129810333The modified gen p mean: 0.44730284810066223, gen p mean: -0.027374612167477608, mean p set: 0.44778314232826233
loss_pred:0.017149649560451508, decouple_loss:0.0013289687922224402
loss_pred:0.01766793616116047, decouple_loss:0.0014357002219185233
2023-05-02 09:23:58 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.03180034086108208, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.026700660586357117, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.027449525892734528, mean p set: 0.4500633478164673
loss_pred:0.01848401315510273, decouple_loss:0.001269455999135971
loss_pred:0.017503157258033752, decouple_loss:0.0011706966906785965
loss_pred:0.01744905672967434, decouple_loss:0.0012012978550046682
WV_0_PC_1_EH_0_PS_40, loss: 0.0178727675229311, avg_mse: 0.025616435334086418
current test mse: 0.025616
Iteration: 1791, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44835227727890015, gen p mean: -0.020653827115893364, mean p set: 0.44883257150650024
The modified gen p mean: 0.4499530494213104, gen p mean: -0.02167220041155815, mean p set: 0.4504333436489105
The modified gen p mean: 0.45128291845321655, gen p mean: -0.02702760137617588, mean p set: 0.45176324248313904
loss_pred:0.015945903956890106, decouple_loss:0.0012822957942262292
loss_pred:0.016406547278165817, decouple_loss:0.0012256361078470945
loss_pred:0.0163877010345459, decouple_loss:0.0011958919931203127
Iteration: 1792, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45025697350502014, gen p mean: -0.026283912360668182, mean p set: 0.45073726773262024
loss_pred:0.016853000968694687, decouple_loss:0.0013676168164238334
The modified gen p mean: 0.4498325288295746, gen p mean: -0.02424905262887478, mean p set: 0.4503127932548523The modified gen p mean: 0.45054158568382263, gen p mean: -0.025474440306425095, mean p set: 0.45102187991142273
loss_pred:0.016677139326930046, decouple_loss:0.0013439302565529943
loss_pred:0.016254015266895294, decouple_loss:0.001264608814381063
Iteration: 1793, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44956454634666443, gen p mean: -0.02849833481013775, mean p set: 0.4500448405742645
loss_pred:0.016786789521574974, decouple_loss:0.0011895644711330533
The modified gen p mean: 0.45168885588645935, gen p mean: -0.0322447344660759, mean p set: 0.45216912031173706The modified gen p mean: 0.45136386156082153, gen p mean: -0.02782776951789856, mean p set: 0.45184415578842163
loss_pred:0.01671511121094227, decouple_loss:0.0011925783473998308
loss_pred:0.01604003831744194, decouple_loss:0.0012395528610795736
Iteration: 1794, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45009303092956543, gen p mean: -0.025299571454524994, mean p set: 0.45057329535484314
loss_pred:0.017390068620443344, decouple_loss:0.001158877625130117
The modified gen p mean: 0.44861117005348206, gen p mean: -0.02613702416419983, mean p set: 0.44909143447875977The modified gen p mean: 0.44807860255241394, gen p mean: -0.028050502762198448, mean p set: 0.44855889678001404
loss_pred:0.016829218715429306, decouple_loss:0.0013469007099047303
loss_pred:0.016805125400424004, decouple_loss:0.0012305595446377993
Iteration: 1795, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44873663783073425, gen p mean: -0.026116928085684776, mean p set: 0.44921693205833435
loss_pred:0.017200199887156487, decouple_loss:0.0011231467360630631
The modified gen p mean: 0.4502078890800476, gen p mean: -0.030206086114048958, mean p set: 0.4506881833076477The modified gen p mean: 0.450407475233078, gen p mean: -0.03700035810470581, mean p set: 0.4508877694606781
loss_pred:0.016618479043245316, decouple_loss:0.0012240700889378786
loss_pred:0.01684439368546009, decouple_loss:0.0015652930596843362
Iteration: 1796, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44727781414985657, gen p mean: -0.027041789144277573, mean p set: 0.44775813817977905
loss_pred:0.01643303409218788, decouple_loss:0.001169355702586472
The modified gen p mean: 0.4475676119327545, gen p mean: -0.025944845750927925, mean p set: 0.4480479061603546The modified gen p mean: 0.4491610527038574, gen p mean: -0.025691166520118713, mean p set: 0.4496413469314575
loss_pred:0.016951218247413635, decouple_loss:0.0011528063332661986
loss_pred:0.01723686419427395, decouple_loss:0.001069031422957778
Iteration: 1797, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473363757133484, gen p mean: -0.03597599267959595, mean p set: 0.4478166699409485
loss_pred:0.0173756405711174, decouple_loss:0.0012979559833183885
The modified gen p mean: 0.45008379220962524, gen p mean: -0.035509202629327774, mean p set: 0.45056405663490295The modified gen p mean: 0.45021939277648926, gen p mean: -0.0337580181658268, mean p set: 0.45069968700408936
loss_pred:0.017297247424721718, decouple_loss:0.0012680664658546448
loss_pred:0.016186514869332314, decouple_loss:0.0012589741963893175
Iteration: 1798, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44755303859710693, gen p mean: -0.028542926535010338, mean p set: 0.44803333282470703
loss_pred:0.01630878821015358, decouple_loss:0.0012320280075073242
The modified gen p mean: 0.4499647319316864, gen p mean: -0.03285211697220802, mean p set: 0.4504449665546417The modified gen p mean: 0.4478659927845001, gen p mean: -0.028364676982164383, mean p set: 0.4483462870121002
loss_pred:0.01711011864244938, decouple_loss:0.00129176233895123
loss_pred:0.016767004504799843, decouple_loss:0.0012459367280825973
Iteration: 1799, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481247663497925, gen p mean: -0.030666958540678024, mean p set: 0.4486050307750702
loss_pred:0.01702950708568096, decouple_loss:0.0011228861985728145
The modified gen p mean: 0.4521802067756653, gen p mean: -0.04098927602171898, mean p set: 0.4526605010032654The modified gen p mean: 0.45137128233909607, gen p mean: -0.034069180488586426, mean p set: 0.45185160636901855
loss_pred:0.015934156253933907, decouple_loss:0.0012367084855213761
loss_pred:0.017412105575203896, decouple_loss:0.0011779838241636753
Iteration: 1800, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44999951124191284, gen p mean: -0.034173332154750824, mean p set: 0.45047977566719055
loss_pred:0.0160725899040699, decouple_loss:0.001225894084200263
The modified gen p mean: 0.44725048542022705, gen p mean: -0.03475455567240715, mean p set: 0.44773074984550476The modified gen p mean: 0.4471800923347473, gen p mean: -0.03604552894830704, mean p set: 0.4476604163646698
loss_pred:0.016594162210822105, decouple_loss:0.0013008113019168377
loss_pred:0.017327312380075455, decouple_loss:0.0013104124227538705
2023-05-02 09:25:52 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.044268205761909485, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.03954580798745155, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04034803807735443, mean p set: 0.4500633478164673
loss_pred:0.018381662666797638, decouple_loss:0.0012436523102223873
loss_pred:0.017340339720249176, decouple_loss:0.0012115680146962404
loss_pred:0.017405526712536812, decouple_loss:0.0012979005696251988
WV_0_PC_1_EH_0_PS_40, loss: 0.017771728336811066, avg_mse: 0.025432372465729713
current test mse: 0.025432
Iteration: 1801, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448749303817749, gen p mean: -0.03420261666178703, mean p set: 0.4492295980453491
The modified gen p mean: 0.4492734372615814, gen p mean: -0.0409516878426075, mean p set: 0.4497537314891815
The modified gen p mean: 0.4515502452850342, gen p mean: -0.03975928947329521, mean p set: 0.4520305097103119
loss_pred:0.01571507565677166, decouple_loss:0.0012037073029205203
loss_pred:0.0168681088835001, decouple_loss:0.001203472726047039
loss_pred:0.016445888206362724, decouple_loss:0.0011277399025857449
Iteration: 1802, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513677954673767, gen p mean: -0.039844002574682236, mean p set: 0.4518480598926544
loss_pred:0.015581758692860603, decouple_loss:0.001072200946509838
The modified gen p mean: 0.44747841358184814, gen p mean: -0.04176706448197365, mean p set: 0.44795873761177063The modified gen p mean: 0.4510563313961029, gen p mean: -0.03482712060213089, mean p set: 0.451536625623703
loss_pred:0.016954848542809486, decouple_loss:0.0011811577714979649
loss_pred:0.017435884103178978, decouple_loss:0.001044581993483007
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012007_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012007_3_24hr.npz
NaN value num: 0
Iteration: 1803, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478556215763092, gen p mean: -0.042152341455221176, mean p set: 0.4483358860015869
loss_pred:0.017475584521889687, decouple_loss:0.0011794960591942072
The modified gen p mean: 0.44694846868515015, gen p mean: -0.042640320956707, mean p set: 0.44742879271507263The modified gen p mean: 0.4468402862548828, gen p mean: -0.043885160237550735, mean p set: 0.4473206102848053
loss_pred:0.01812884770333767, decouple_loss:0.0011238461593165994
loss_pred:0.017831096425652504, decouple_loss:0.0011303636711090803
Iteration: 1804, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44702011346817017, gen p mean: -0.0395604707300663, mean p set: 0.44750040769577026
loss_pred:0.017387786880135536, decouple_loss:0.0011909104650840163
The modified gen p mean: 0.44702795147895813, gen p mean: -0.04102358967065811, mean p set: 0.44750818610191345The modified gen p mean: 0.44815143942832947, gen p mean: -0.04157327860593796, mean p set: 0.44863173365592957
loss_pred:0.01697371155023575, decouple_loss:0.0012005214812234044
loss_pred:0.017094366252422333, decouple_loss:0.0011955946683883667
Iteration: 1805, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44680461287498474, gen p mean: -0.04683839902281761, mean p set: 0.44728490710258484
loss_pred:0.016555065289139748, decouple_loss:0.0013113418826833367
The modified gen p mean: 0.44786643981933594, gen p mean: -0.04375951364636421, mean p set: 0.44834673404693604The modified gen p mean: 0.4471753239631653, gen p mean: -0.0435197688639164, mean p set: 0.447655588388443
loss_pred:0.01757095754146576, decouple_loss:0.0012013701489195228
loss_pred:0.01732715032994747, decouple_loss:0.0011891216272488236
Iteration: 1806, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468744695186615, gen p mean: -0.047497838735580444, mean p set: 0.4473547637462616
loss_pred:0.016496405005455017, decouple_loss:0.0010910147102549672
The modified gen p mean: 0.4478886127471924, gen p mean: -0.04728202521800995, mean p set: 0.44836893677711487The modified gen p mean: 0.44762206077575684, gen p mean: -0.04482487216591835, mean p set: 0.4481023848056793
loss_pred:0.01659170724451542, decouple_loss:0.0011092060012742877
loss_pred:0.01721280813217163, decouple_loss:0.0010979896178469062
Iteration: 1807, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475628137588501, gen p mean: -0.05453602597117424, mean p set: 0.4480431377887726
loss_pred:0.01704716868698597, decouple_loss:0.0013638483360409737
The modified gen p mean: 0.44634732604026794, gen p mean: -0.05225446820259094, mean p set: 0.44682762026786804
The modified gen p mean: 0.4470593333244324, gen p mean: -0.04887014254927635, mean p set: 0.44753962755203247
loss_pred:0.01645417883992195, decouple_loss:0.0012306327698752284
loss_pred:0.016763512045145035, decouple_loss:0.001157774473540485
Iteration: 1808, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44612568616867065, gen p mean: -0.05043261498212814, mean p set: 0.44660601019859314
loss_pred:0.016469217836856842, decouple_loss:0.0011546285822987556
The modified gen p mean: 0.44645819067955017, gen p mean: -0.04963577538728714, mean p set: 0.44693848490715027The modified gen p mean: 0.4468475878238678, gen p mean: -0.054830387234687805, mean p set: 0.4473278820514679
loss_pred:0.017219921573996544, decouple_loss:0.001107316347770393
loss_pred:0.01737101376056671, decouple_loss:0.0011027343571186066
Iteration: 1809, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44663500785827637, gen p mean: -0.04917382448911667, mean p set: 0.4471152722835541
loss_pred:0.01687460206449032, decouple_loss:0.0010716106044128537
The modified gen p mean: 0.4478103816509247, gen p mean: -0.05454278364777565, mean p set: 0.44829070568084717The modified gen p mean: 0.44728296995162964, gen p mean: -0.05300198495388031, mean p set: 0.4477632939815521
loss_pred:0.017464231699705124, decouple_loss:0.0011706292862072587
loss_pred:0.017269110307097435, decouple_loss:0.0011511689517647028
Iteration: 1810, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44716039299964905, gen p mean: -0.055303312838077545, mean p set: 0.44764068722724915
loss_pred:0.01683150604367256, decouple_loss:0.0012067609932273626
The modified gen p mean: 0.4470949172973633, gen p mean: -0.05309155583381653, mean p set: 0.4475752115249634The modified gen p mean: 0.4486711323261261, gen p mean: -0.05226318538188934, mean p set: 0.4491514265537262
loss_pred:0.01630784198641777, decouple_loss:0.0011000209487974644
loss_pred:0.016316493973135948, decouple_loss:0.001325569348409772
2023-05-02 09:28:24 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.050656817853450775, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.0455130897462368, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.046291254460811615, mean p set: 0.4500633478164673
loss_pred:0.018297189846634865, decouple_loss:0.0011060923570767045
loss_pred:0.017207643017172813, decouple_loss:0.001225237618200481
loss_pred:0.01728103868663311, decouple_loss:0.0011556718964129686
WV_0_PC_1_EH_0_PS_40, loss: 0.01765340566635132, avg_mse: 0.025218842551112175
current test mse: 0.025219
At step 1810, Best test: 0.025219
save model to /work/09012/haoli1/ls6/ERA5_PredRNN/checkpoints/WV_0_PC_1_EH_0_PS_40/model_test_schedule_sampling_DynaMean.ckpt
Iteration: 1811, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44776391983032227, gen p mean: -0.044634588062763214, mean p set: 0.44824421405792236
loss_pred:0.017479417845606804, decouple_loss:0.0010360899614170194
The modified gen p mean: 0.4468744397163391, gen p mean: -0.045761026442050934, mean p set: 0.4473547041416168The modified gen p mean: 0.447847843170166, gen p mean: -0.05225016176700592, mean p set: 0.4483281373977661
loss_pred:0.016886137425899506, decouple_loss:0.00103374058380723
loss_pred:0.017226962372660637, decouple_loss:0.0010774991242215037
Iteration: 1812, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44801634550094604, gen p mean: -0.04534176364541054, mean p set: 0.44849663972854614
The modified gen p mean: 0.44891098141670227, gen p mean: -0.04782874509692192, mean p set: 0.44939130544662476
loss_pred:0.016786256805062294, decouple_loss:0.0010795330163091421
loss_pred:0.01689966209232807, decouple_loss:0.0010996682103723288
The modified gen p mean: 0.448213666677475, gen p mean: -0.041936296969652176, mean p set: 0.4486939311027527
loss_pred:0.01707369275391102, decouple_loss:0.0010784316109493375
Iteration: 1813, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473426938056946, gen p mean: -0.04716905951499939, mean p set: 0.4478229880332947
The modified gen p mean: 0.4475528299808502, gen p mean: -0.04338189214468002, mean p set: 0.4480331242084503
loss_pred:0.01627950929105282, decouple_loss:0.0010988935828208923
loss_pred:0.01644224114716053, decouple_loss:0.001082458533346653
The modified gen p mean: 0.44669944047927856, gen p mean: -0.04232914373278618, mean p set: 0.44717973470687866
loss_pred:0.017684543505311012, decouple_loss:0.0011339487973600626
Iteration: 1814, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484260082244873, gen p mean: -0.043001022189855576, mean p set: 0.4489063620567322
loss_pred:0.016762834042310715, decouple_loss:0.001020926283672452
The modified gen p mean: 0.4478079080581665, gen p mean: -0.04438432678580284, mean p set: 0.448288232088089The modified gen p mean: 0.4457228481769562, gen p mean: -0.040763258934020996, mean p set: 0.44620317220687866
loss_pred:0.016436437144875526, decouple_loss:0.0010252890642732382
loss_pred:0.01690959557890892, decouple_loss:0.0010283979354426265
Iteration: 1815, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482361078262329, gen p mean: -0.04480590671300888, mean p set: 0.448716402053833
loss_pred:0.01618831977248192, decouple_loss:0.0010790112428367138
The modified gen p mean: 0.4477159082889557, gen p mean: -0.044112611562013626, mean p set: 0.4481962025165558The modified gen p mean: 0.4466511309146881, gen p mean: -0.04412836953997612, mean p set: 0.4471314251422882
loss_pred:0.017302028834819794, decouple_loss:0.0010687803151085973
loss_pred:0.016637684777379036, decouple_loss:0.0012949270894750953
Iteration: 1816, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471132159233093, gen p mean: -0.047648169100284576, mean p set: 0.4475935399532318
loss_pred:0.01665722019970417, decouple_loss:0.0010620149550959468
The modified gen p mean: 0.447050541639328, gen p mean: -0.04636680707335472, mean p set: 0.4475308060646057The modified gen p mean: 0.44653043150901794, gen p mean: -0.0470530167222023, mean p set: 0.44701069593429565
loss_pred:0.016731781885027885, decouple_loss:0.001107758260332048
loss_pred:0.01694485917687416, decouple_loss:0.0011301299091428518
Iteration: 1817, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471675157546997, gen p mean: -0.04104713723063469, mean p set: 0.4476478397846222
loss_pred:0.01689067855477333, decouple_loss:0.001143278437666595
The modified gen p mean: 0.44810450077056885, gen p mean: -0.04426880553364754, mean p set: 0.44858479499816895The modified gen p mean: 0.44772493839263916, gen p mean: -0.04221075400710106, mean p set: 0.44820523262023926
loss_pred:0.01636158861219883, decouple_loss:0.001074301078915596
loss_pred:0.017137890681624413, decouple_loss:0.0011937476228922606
Iteration: 1818, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44723790884017944, gen p mean: -0.04174448549747467, mean p set: 0.44771823287010193
loss_pred:0.017446698620915413, decouple_loss:0.0011125939199700952
The modified gen p mean: 0.44892945885658264, gen p mean: -0.04663333296775818, mean p set: 0.44940972328186035The modified gen p mean: 0.4490271210670471, gen p mean: -0.04365217313170433, mean p set: 0.4495074450969696
loss_pred:0.016129327937960625, decouple_loss:0.0011085276491940022
loss_pred:0.016720417886972427, decouple_loss:0.0011483152629807591
Iteration: 1819, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468745291233063, gen p mean: -0.04514344409108162, mean p set: 0.447354793548584
loss_pred:0.01734919846057892, decouple_loss:0.0011392119340598583
The modified gen p mean: 0.4479794204235077, gen p mean: -0.04194742068648338, mean p set: 0.4484597444534302The modified gen p mean: 0.4477410912513733, gen p mean: -0.04417738690972328, mean p set: 0.4482213854789734
loss_pred:0.01689978688955307, decouple_loss:0.0011161004658788443
loss_pred:0.01588127203285694, decouple_loss:0.001096951775252819
Iteration: 1820, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479723274707794, gen p mean: -0.04585136100649834, mean p set: 0.4484526515007019
loss_pred:0.016558296978473663, decouple_loss:0.0010894370498135686
The modified gen p mean: 0.4484494626522064, gen p mean: -0.0446920283138752, mean p set: 0.4489297568798065The modified gen p mean: 0.4477768838405609, gen p mean: -0.046762172132730484, mean p set: 0.4482572078704834
loss_pred:0.016398906707763672, decouple_loss:0.0011087199673056602
loss_pred:0.017024433240294456, decouple_loss:0.001054690801538527
2023-05-02 09:30:24 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.05076681077480316, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04600949212908745, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.046621646732091904, mean p set: 0.4500633478164673
loss_pred:0.018259527161717415, decouple_loss:0.0010751048102974892
loss_pred:0.0171787329018116, decouple_loss:0.0010921709472313523
loss_pred:0.017269190400838852, decouple_loss:0.001048555364832282
WV_0_PC_1_EH_0_PS_40, loss: 0.017622746527194977, avg_mse: 0.025194915011525154
current test mse: 0.025195
At step 1820, Best test: 0.025195
save model to /work/09012/haoli1/ls6/ERA5_PredRNN/checkpoints/WV_0_PC_1_EH_0_PS_40/model_test_schedule_sampling_DynaMean.ckpt
Iteration: 1821, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44741570949554443, gen p mean: -0.049394458532333374, mean p set: 0.44789600372314453
loss_pred:0.017044510692358017, decouple_loss:0.0010936885373666883
The modified gen p mean: 0.4463687837123871, gen p mean: -0.047137122601270676, mean p set: 0.44684910774230957
The modified gen p mean: 0.4465724527835846, gen p mean: -0.04808930307626724, mean p set: 0.4470527172088623
loss_pred:0.017024170607328415, decouple_loss:0.0011445485288277268
loss_pred:0.017893711104989052, decouple_loss:0.0010538719361647964
Iteration: 1822, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4458576440811157, gen p mean: -0.048394057899713516, mean p set: 0.4463379681110382
loss_pred:0.01706618443131447, decouple_loss:0.0010388047667220235
The modified gen p mean: 0.4462895691394806, gen p mean: -0.047913193702697754, mean p set: 0.4467698633670807
The modified gen p mean: 0.44811150431632996, gen p mean: -0.050862327218055725, mean p set: 0.44859179854393005
loss_pred:0.016387034207582474, decouple_loss:0.0009855815442278981
loss_pred:0.01719207689166069, decouple_loss:0.0010921463835984468
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012016_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012016_3_24hr.npz
NaN value num: 0
Iteration: 1823, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44996967911720276, gen p mean: -0.0419858954846859, mean p set: 0.45045000314712524
loss_pred:0.01748545840382576, decouple_loss:0.0013054234441369772
The modified gen p mean: 0.4477386474609375, gen p mean: -0.04733280837535858, mean p set: 0.4482189118862152The modified gen p mean: 0.4502688944339752, gen p mean: -0.03830445185303688, mean p set: 0.4507491886615753
loss_pred:0.01795385591685772, decouple_loss:0.0012438650010153651
loss_pred:0.01740596815943718, decouple_loss:0.00149820395745337
Iteration: 1824, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45012331008911133, gen p mean: -0.043901532888412476, mean p set: 0.4506036043167114
loss_pred:0.01735438033938408, decouple_loss:0.0010922836372628808
The modified gen p mean: 0.44883424043655396, gen p mean: -0.04365215823054314, mean p set: 0.44931453466415405
The modified gen p mean: 0.4503643810749054, gen p mean: -0.038335736840963364, mean p set: 0.4508446753025055
loss_pred:0.01752575859427452, decouple_loss:0.001106679206714034
loss_pred:0.01686123013496399, decouple_loss:0.0012391606578603387
Iteration: 1825, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45097795128822327, gen p mean: -0.04462080076336861, mean p set: 0.451458215713501
loss_pred:0.016943970695137978, decouple_loss:0.001359360758215189
The modified gen p mean: 0.44812336564064026, gen p mean: -0.044384270906448364, mean p set: 0.44860365986824036The modified gen p mean: 0.44817906618118286, gen p mean: -0.042245157063007355, mean p set: 0.44865939021110535
loss_pred:0.016878221184015274, decouple_loss:0.0012546796351671219
loss_pred:0.0169999860227108, decouple_loss:0.0011801202781498432
Iteration: 1826, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449848473072052, gen p mean: -0.04472737014293671, mean p set: 0.4503287672996521
loss_pred:0.017818454653024673, decouple_loss:0.0011174564715474844
The modified gen p mean: 0.4501352906227112, gen p mean: -0.04550512135028839, mean p set: 0.45061561465263367The modified gen p mean: 0.4495847821235657, gen p mean: -0.045874666422605515, mean p set: 0.45006507635116577
loss_pred:0.016897177323698997, decouple_loss:0.001146675436757505
loss_pred:0.018053540959954262, decouple_loss:0.0011688844533637166
Iteration: 1827, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504496455192566, gen p mean: -0.043833792209625244, mean p set: 0.4509299099445343
loss_pred:0.016914160922169685, decouple_loss:0.00112895667552948
The modified gen p mean: 0.4506303369998932, gen p mean: -0.0436120368540287, mean p set: 0.4511106312274933The modified gen p mean: 0.44793641567230225, gen p mean: -0.04752684384584427, mean p set: 0.44841670989990234
loss_pred:0.016657128930091858, decouple_loss:0.0010961119551211596
loss_pred:0.01727905683219433, decouple_loss:0.0011870507150888443
Iteration: 1828, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488838016986847, gen p mean: -0.043652914464473724, mean p set: 0.4493641257286072
loss_pred:0.016442371532320976, decouple_loss:0.001104419818148017
The modified gen p mean: 0.44779255986213684, gen p mean: -0.04994528368115425, mean p set: 0.44827285408973694The modified gen p mean: 0.44713103771209717, gen p mean: -0.05006897449493408, mean p set: 0.4476113021373749
loss_pred:0.017505764961242676, decouple_loss:0.0011281140614300966
loss_pred:0.017757156863808632, decouple_loss:0.0010645246366038918
Iteration: 1829, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45028096437454224, gen p mean: -0.042411692440509796, mean p set: 0.45076125860214233
loss_pred:0.016874490305781364, decouple_loss:0.0011293735587969422
The modified gen p mean: 0.45044204592704773, gen p mean: -0.037125300616025925, mean p set: 0.4509223401546478The modified gen p mean: 0.4488801956176758, gen p mean: -0.040062833577394485, mean p set: 0.44936051964759827
loss_pred:0.01671457476913929, decouple_loss:0.0011946193408221006
loss_pred:0.016889628022909164, decouple_loss:0.0011701975017786026
Iteration: 1830, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45065709948539734, gen p mean: -0.039929263293743134, mean p set: 0.45113739371299744
loss_pred:0.016647251322865486, decouple_loss:0.0011455414351075888
The modified gen p mean: 0.450557142496109, gen p mean: -0.039774782955646515, mean p set: 0.4510374367237091
The modified gen p mean: 0.449520468711853, gen p mean: -0.039596304297447205, mean p set: 0.45000073313713074
loss_pred:0.016582561656832695, decouple_loss:0.0011577591067180037
loss_pred:0.01676827482879162, decouple_loss:0.0010924856178462505
2023-05-02 09:33:01 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.05168767645955086, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04666673392057419, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.047447461634874344, mean p set: 0.4500633478164673
loss_pred:0.01833472214639187, decouple_loss:0.0012030702782794833
loss_pred:0.017167488113045692, decouple_loss:0.0013960726791992784
loss_pred:0.01728140190243721, decouple_loss:0.0012833494693040848
WV_0_PC_1_EH_0_PS_40, loss: 0.017659246921539307, avg_mse: 0.025222456082701683
current test mse: 0.025222
Iteration: 1831, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44845783710479736, gen p mean: -0.04909789562225342, mean p set: 0.4489381015300751
The modified gen p mean: 0.44891878962516785, gen p mean: -0.043612703680992126, mean p set: 0.44939908385276794
The modified gen p mean: 0.44792625308036804, gen p mean: -0.04250798374414444, mean p set: 0.44840651750564575
loss_pred:0.017439140006899834, decouple_loss:0.0014362065121531487
loss_pred:0.01691945269703865, decouple_loss:0.0011696398723870516
loss_pred:0.01607251912355423, decouple_loss:0.0012904064496979117
Iteration: 1832, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44906988739967346, gen p mean: -0.04028110206127167, mean p set: 0.44955018162727356
loss_pred:0.017143990844488144, decouple_loss:0.000999062554910779
The modified gen p mean: 0.44855108857154846, gen p mean: -0.04647965356707573, mean p set: 0.44903138279914856The modified gen p mean: 0.4523296058177948, gen p mean: -0.03793765977025032, mean p set: 0.4528099000453949
loss_pred:0.016656000167131424, decouple_loss:0.0011816270416602492
loss_pred:0.016582190990447998, decouple_loss:0.0010669874027371407
Iteration: 1833, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479113817214966, gen p mean: -0.038385163992643356, mean p set: 0.4483916759490967
loss_pred:0.017346426844596863, decouple_loss:0.0010311079677194357
The modified gen p mean: 0.44882020354270935, gen p mean: -0.04681636393070221, mean p set: 0.44930049777030945The modified gen p mean: 0.45000165700912476, gen p mean: -0.038175273686647415, mean p set: 0.45048198103904724
loss_pred:0.01692797616124153, decouple_loss:0.001084556570276618
loss_pred:0.016685321927070618, decouple_loss:0.0011857375502586365
Iteration: 1834, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450179785490036, gen p mean: -0.03908757492899895, mean p set: 0.4506600499153137
loss_pred:0.017228368669748306, decouple_loss:0.0010134894400835037
The modified gen p mean: 0.4496050179004669, gen p mean: -0.03815433382987976, mean p set: 0.450085312128067The modified gen p mean: 0.44871675968170166, gen p mean: -0.03445972502231598, mean p set: 0.44919705390930176
loss_pred:0.016838259994983673, decouple_loss:0.0010256047826260328
loss_pred:0.016887135803699493, decouple_loss:0.0010174991330131888
Iteration: 1835, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44960471987724304, gen p mean: -0.041217297315597534, mean p set: 0.4500850439071655
loss_pred:0.016828272491693497, decouple_loss:0.0010466036619618535
The modified gen p mean: 0.44886693358421326, gen p mean: -0.03962511941790581, mean p set: 0.44934722781181335The modified gen p mean: 0.4476385712623596, gen p mean: -0.046806588768959045, mean p set: 0.44811883568763733
loss_pred:0.017117874696850777, decouple_loss:0.0011183284223079681
loss_pred:0.01701117679476738, decouple_loss:0.0011344915255904198
Iteration: 1836, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45041823387145996, gen p mean: -0.037512339651584625, mean p set: 0.45089852809906006
loss_pred:0.017226556316018105, decouple_loss:0.0011232903925701976
The modified gen p mean: 0.44930577278137207, gen p mean: -0.03996405005455017, mean p set: 0.4497860372066498The modified gen p mean: 0.44890159368515015, gen p mean: -0.036840058863162994, mean p set: 0.44938188791275024
loss_pred:0.01729019358754158, decouple_loss:0.000962225953117013
loss_pred:0.01648823358118534, decouple_loss:0.0009115700959227979
Iteration: 1837, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495719373226166, gen p mean: -0.038532648235559464, mean p set: 0.45005226135253906
loss_pred:0.017604393884539604, decouple_loss:0.0011279298923909664
The modified gen p mean: 0.4481503665447235, gen p mean: -0.04033205658197403, mean p set: 0.448630690574646The modified gen p mean: 0.4481627643108368, gen p mean: -0.041943326592445374, mean p set: 0.4486430585384369
loss_pred:0.01655454747378826, decouple_loss:0.0012101804604753852
loss_pred:0.016446305438876152, decouple_loss:0.0010613786289468408
Iteration: 1838, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44987601041793823, gen p mean: -0.04820933938026428, mean p set: 0.4503563344478607
loss_pred:0.01644248515367508, decouple_loss:0.0011291810078546405
The modified gen p mean: 0.44959649443626404, gen p mean: -0.04105681553483009, mean p set: 0.45007678866386414The modified gen p mean: 0.4485177993774414, gen p mean: -0.04177577793598175, mean p set: 0.4489981234073639
loss_pred:0.017452210187911987, decouple_loss:0.0010653800563886762
loss_pred:0.016427483409643173, decouple_loss:0.0011732416460290551
Iteration: 1839, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4519200921058655, gen p mean: -0.038990847766399384, mean p set: 0.4524003565311432
loss_pred:0.016875000670552254, decouple_loss:0.0012186631793156266
The modified gen p mean: 0.449825257062912, gen p mean: -0.03965605050325394, mean p set: 0.4503055810928345The modified gen p mean: 0.4497251510620117, gen p mean: -0.03925744816660881, mean p set: 0.4502054452896118
loss_pred:0.017091475427150726, decouple_loss:0.0012278949143365026
loss_pred:0.017021074891090393, decouple_loss:0.0011592538794502616
Iteration: 1840, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44997620582580566, gen p mean: -0.04078539460897446, mean p set: 0.45045650005340576
loss_pred:0.016499260440468788, decouple_loss:0.0010924135567620397
The modified gen p mean: 0.4481624364852905, gen p mean: -0.03822646290063858, mean p set: 0.448642760515213The modified gen p mean: 0.4512498378753662, gen p mean: -0.03644995391368866, mean p set: 0.4517301619052887
loss_pred:0.017550894990563393, decouple_loss:0.0012039670255035162
loss_pred:0.016915924847126007, decouple_loss:0.001198828686028719
2023-05-02 09:34:56 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.04913022369146347, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.044356100261211395, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04489178583025932, mean p set: 0.4500633478164673
loss_pred:0.018283771350979805, decouple_loss:0.0012737851357087493
loss_pred:0.01712988130748272, decouple_loss:0.0012371123302727938
loss_pred:0.017212431877851486, decouple_loss:0.0012057744897902012
WV_0_PC_1_EH_0_PS_40, loss: 0.01760397106409073, avg_mse: 0.025153473019599915
current test mse: 0.025153
At step 1840, Best test: 0.025153
save model to /work/09012/haoli1/ls6/ERA5_PredRNN/checkpoints/WV_0_PC_1_EH_0_PS_40/model_test_schedule_sampling_DynaMean.ckpt
Iteration: 1841, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45057058334350586, gen p mean: -0.03258145600557327, mean p set: 0.45105084776878357
loss_pred:0.017002249136567116, decouple_loss:0.0012595239095389843
The modified gen p mean: 0.4494689106941223, gen p mean: -0.045227110385894775, mean p set: 0.4499492049217224The modified gen p mean: 0.45036041736602783, gen p mean: -0.04296717047691345, mean p set: 0.45084071159362793
loss_pred:0.016226472333073616, decouple_loss:0.001284717465750873
loss_pred:0.01640087366104126, decouple_loss:0.0011969681363552809
Iteration: 1842, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492427706718445, gen p mean: -0.03450651094317436, mean p set: 0.4497230648994446
loss_pred:0.01726120337843895, decouple_loss:0.0010652433848008513
The modified gen p mean: 0.44977954030036926, gen p mean: -0.03677336126565933, mean p set: 0.45025986433029175The modified gen p mean: 0.45015621185302734, gen p mean: -0.03621302917599678, mean p set: 0.45063650608062744
loss_pred:0.016852157190442085, decouple_loss:0.0010721604339778423
loss_pred:0.017068281769752502, decouple_loss:0.0010905731469392776
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012012_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012012_3_24hr.npz
NaN value num: 0
Iteration: 1843, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470200538635254, gen p mean: -0.04817492887377739, mean p set: 0.4475003480911255
loss_pred:0.015146388672292233, decouple_loss:0.0011627745116129518
The modified gen p mean: 0.4474269449710846, gen p mean: -0.045148011296987534, mean p set: 0.4479072690010071The modified gen p mean: 0.44647812843322754, gen p mean: -0.04651112109422684, mean p set: 0.44695839285850525
loss_pred:0.015343583188951015, decouple_loss:0.0012477057753130794
loss_pred:0.015751633793115616, decouple_loss:0.0012046381598338485
Iteration: 1844, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448669970035553, gen p mean: -0.0472957119345665, mean p set: 0.4491502642631531
loss_pred:0.016027530655264854, decouple_loss:0.0010988183785229921
The modified gen p mean: 0.44765475392341614, gen p mean: -0.04832824692130089, mean p set: 0.44813501834869385The modified gen p mean: 0.44889020919799805, gen p mean: -0.04639091342687607, mean p set: 0.44937047362327576
loss_pred:0.01537445466965437, decouple_loss:0.0010509983403608203
loss_pred:0.016274603083729744, decouple_loss:0.0010739489225670695
Iteration: 1845, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467921853065491, gen p mean: -0.04973069950938225, mean p set: 0.44727250933647156
loss_pred:0.015199699439108372, decouple_loss:0.0011356823379173875
The modified gen p mean: 0.44769424200057983, gen p mean: -0.05062687024474144, mean p set: 0.44817450642585754The modified gen p mean: 0.44812050461769104, gen p mean: -0.04525978863239288, mean p set: 0.44860079884529114
loss_pred:0.015590041875839233, decouple_loss:0.0011080014519393444
loss_pred:0.01505260355770588, decouple_loss:0.0012506104540079832
Iteration: 1846, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484599530696869, gen p mean: -0.055102236568927765, mean p set: 0.448940247297287
loss_pred:0.015593226067721844, decouple_loss:0.0010613281046971679
The modified gen p mean: 0.4474744498729706, gen p mean: -0.051378440111875534, mean p set: 0.4479547441005707The modified gen p mean: 0.4477033019065857, gen p mean: -0.05086759477853775, mean p set: 0.4481835961341858
loss_pred:0.015147442929446697, decouple_loss:0.0010330379009246826
loss_pred:0.014438411220908165, decouple_loss:0.0010591737227514386
Iteration: 1847, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44730570912361145, gen p mean: -0.05937676131725311, mean p set: 0.44778600335121155
loss_pred:0.014875213615596294, decouple_loss:0.00142089300788939
The modified gen p mean: 0.44812092185020447, gen p mean: -0.055022548884153366, mean p set: 0.44860121607780457The modified gen p mean: 0.44685396552085876, gen p mean: -0.05937095358967781, mean p set: 0.4473342299461365
loss_pred:0.015075763687491417, decouple_loss:0.001273889560252428
loss_pred:0.014103087596595287, decouple_loss:0.0013094611931592226
Iteration: 1848, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478203058242798, gen p mean: -0.058894965797662735, mean p set: 0.4483005702495575
loss_pred:0.015216104686260223, decouple_loss:0.0011953263310715556
The modified gen p mean: 0.44741907715797424, gen p mean: -0.058394405990839005, mean p set: 0.44789940118789673The modified gen p mean: 0.4480159282684326, gen p mean: -0.05166333541274071, mean p set: 0.4484962224960327
loss_pred:0.015331140719354153, decouple_loss:0.0012159397592768073
loss_pred:0.014969711191952229, decouple_loss:0.0010934318415820599
Iteration: 1849, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477179944515228, gen p mean: -0.058630820363759995, mean p set: 0.4481982886791229
loss_pred:0.01421919371932745, decouple_loss:0.0012618069304153323
The modified gen p mean: 0.446382999420166, gen p mean: -0.060053933411836624, mean p set: 0.4468632936477661The modified gen p mean: 0.4476092755794525, gen p mean: -0.05393865704536438, mean p set: 0.4480895698070526
loss_pred:0.014300139620900154, decouple_loss:0.001202902989462018
loss_pred:0.01450763363391161, decouple_loss:0.0012474298710003495
Iteration: 1850, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447234183549881, gen p mean: -0.057633738964796066, mean p set: 0.4477144777774811
loss_pred:0.014744703657925129, decouple_loss:0.0011907571461051702
The modified gen p mean: 0.44814231991767883, gen p mean: -0.05716817080974579, mean p set: 0.44862261414527893The modified gen p mean: 0.447037011384964, gen p mean: -0.057557255029678345, mean p set: 0.4475173056125641
loss_pred:0.013939004391431808, decouple_loss:0.0012278294889256358
loss_pred:0.014716017991304398, decouple_loss:0.0012928345240652561
2023-05-02 09:37:32 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.05752396956086159, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.05242171138525009, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.052906934171915054, mean p set: 0.4500633478164673
loss_pred:0.01891346275806427, decouple_loss:0.0014024021802470088
loss_pred:0.017814137041568756, decouple_loss:0.0013567192945629358
loss_pred:0.017899509519338608, decouple_loss:0.0013931269058957696
WV_0_PC_1_EH_0_PS_40, loss: 0.01827824115753174, avg_mse: 0.02638769894838333
current test mse: 0.026388
Iteration: 1851, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478985369205475, gen p mean: -0.05333277955651283, mean p set: 0.4483788311481476
The modified gen p mean: 0.4475524127483368, gen p mean: -0.051423899829387665, mean p set: 0.4480327069759369
The modified gen p mean: 0.44732311367988586, gen p mean: -0.055684980005025864, mean p set: 0.44780340790748596
loss_pred:0.01430772989988327, decouple_loss:0.0012530181556940079
loss_pred:0.01478020753711462, decouple_loss:0.0012327656149864197
loss_pred:0.014224519953131676, decouple_loss:0.0012921416200697422
Iteration: 1852, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474908113479614, gen p mean: -0.05196031555533409, mean p set: 0.4479711353778839
loss_pred:0.014517143368721008, decouple_loss:0.0012599831679835916
The modified gen p mean: 0.4472869336605072, gen p mean: -0.05395309627056122, mean p set: 0.4477671980857849The modified gen p mean: 0.44838908314704895, gen p mean: -0.05159761384129524, mean p set: 0.44886934757232666
loss_pred:0.01427350752055645, decouple_loss:0.0012391040800139308
loss_pred:0.01444711908698082, decouple_loss:0.0012954147532582283
Iteration: 1853, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44597822427749634, gen p mean: -0.045748449862003326, mean p set: 0.44645851850509644
loss_pred:0.014277894981205463, decouple_loss:0.0015070609515532851
The modified gen p mean: 0.44869041442871094, gen p mean: -0.043277159333229065, mean p set: 0.44917070865631104The modified gen p mean: 0.44743579626083374, gen p mean: -0.045592617243528366, mean p set: 0.44791606068611145
loss_pred:0.01487996056675911, decouple_loss:0.001464870641939342
loss_pred:0.014717991463840008, decouple_loss:0.0015862836735323071
Iteration: 1854, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44752028584480286, gen p mean: -0.043552279472351074, mean p set: 0.44800058007240295
loss_pred:0.013571732677519321, decouple_loss:0.0012369690230116248
The modified gen p mean: 0.44695988297462463, gen p mean: -0.048642344772815704, mean p set: 0.4474402070045471The modified gen p mean: 0.4477330446243286, gen p mean: -0.04264213517308235, mean p set: 0.4482133686542511
loss_pred:0.014396877959370613, decouple_loss:0.0014308608369901776
loss_pred:0.014274951070547104, decouple_loss:0.0012443397426977754
Iteration: 1855, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478236734867096, gen p mean: -0.04270758852362633, mean p set: 0.4483039677143097
loss_pred:0.013485918752849102, decouple_loss:0.0014097921084612608
The modified gen p mean: 0.4468739926815033, gen p mean: -0.03898874297738075, mean p set: 0.4473542869091034The modified gen p mean: 0.44803979992866516, gen p mean: -0.04535455256700516, mean p set: 0.44852009415626526
loss_pred:0.014235448092222214, decouple_loss:0.001485444256104529
loss_pred:0.014376523904502392, decouple_loss:0.0015457883710041642
Iteration: 1856, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44789811968803406, gen p mean: -0.04165569692850113, mean p set: 0.44837847352027893
loss_pred:0.013804029673337936, decouple_loss:0.001387596596032381
The modified gen p mean: 0.44654789566993713, gen p mean: -0.04434194415807724, mean p set: 0.4470282196998596The modified gen p mean: 0.4481739103794098, gen p mean: -0.0396849662065506, mean p set: 0.4486541748046875
loss_pred:0.01413029432296753, decouple_loss:0.0013603594852611423
loss_pred:0.014865915291011333, decouple_loss:0.0014271140098571777
Iteration: 1857, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467793107032776, gen p mean: -0.04140214994549751, mean p set: 0.4472596049308777
loss_pred:0.014046267606317997, decouple_loss:0.0013722656294703484
The modified gen p mean: 0.4469403028488159, gen p mean: -0.04524921253323555, mean p set: 0.4474206268787384The modified gen p mean: 0.44876790046691895, gen p mean: -0.039518579840660095, mean p set: 0.44924822449684143
loss_pred:0.013952146284282207, decouple_loss:0.0013927732361480594
loss_pred:0.014072241261601448, decouple_loss:0.0014164050808176398
Iteration: 1858, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476260542869568, gen p mean: -0.04513271525502205, mean p set: 0.4481063485145569
loss_pred:0.014660210348665714, decouple_loss:0.0014891688479110599
The modified gen p mean: 0.4471847116947174, gen p mean: -0.0485934279859066, mean p set: 0.4476650059223175The modified gen p mean: 0.44773608446121216, gen p mean: -0.04419783130288124, mean p set: 0.44821637868881226
loss_pred:0.014503811486065388, decouple_loss:0.0013540501240640879
loss_pred:0.014034698717296124, decouple_loss:0.0015150182880461216
Iteration: 1859, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472026228904724, gen p mean: -0.04920153692364693, mean p set: 0.4476828873157501
loss_pred:0.013856763951480389, decouple_loss:0.0014071734622120857
The modified gen p mean: 0.44849735498428345, gen p mean: -0.04774363711476326, mean p set: 0.44897761940956116The modified gen p mean: 0.4477849304676056, gen p mean: -0.045326292514801025, mean p set: 0.4482652246952057
loss_pred:0.013838774524629116, decouple_loss:0.0013028200482949615
loss_pred:0.01445714756846428, decouple_loss:0.0014849889557808638
Iteration: 1860, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472866654396057, gen p mean: -0.051607318222522736, mean p set: 0.4477669298648834
loss_pred:0.013944540172815323, decouple_loss:0.001289334031753242
The modified gen p mean: 0.44864141941070557, gen p mean: -0.04116758331656456, mean p set: 0.4491216838359833The modified gen p mean: 0.4469078481197357, gen p mean: -0.052891917526721954, mean p set: 0.4473881721496582
loss_pred:0.014008302241563797, decouple_loss:0.0013828050578013062
loss_pred:0.01389700174331665, decouple_loss:0.0012923888862133026
2023-05-02 09:39:26 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.050028085708618164, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04498738422989845, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04552425444126129, mean p set: 0.4500633478164673
loss_pred:0.019070923328399658, decouple_loss:0.00124532007612288
loss_pred:0.0180225670337677, decouple_loss:0.0012557260924950242
loss_pred:0.01808583177626133, decouple_loss:0.0012245679972693324
WV_0_PC_1_EH_0_PS_40, loss: 0.018455199897289276, avg_mse: 0.026818815618753433
current test mse: 0.026819
Iteration: 1861, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4456293284893036, gen p mean: -0.04325634241104126, mean p set: 0.4461096227169037
The modified gen p mean: 0.44865262508392334, gen p mean: -0.04202878102660179, mean p set: 0.44913291931152344
The modified gen p mean: 0.44790810346603394, gen p mean: -0.04566746577620506, mean p set: 0.44838836789131165
loss_pred:0.014601864852011204, decouple_loss:0.0012169757392257452
loss_pred:0.013983208686113358, decouple_loss:0.0012284512631595135
loss_pred:0.01373220793902874, decouple_loss:0.0012737459037452936
Iteration: 1862, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474409818649292, gen p mean: -0.04656960815191269, mean p set: 0.4479212760925293
loss_pred:0.01391396764665842, decouple_loss:0.0014354722807183862
The modified gen p mean: 0.4477022588253021, gen p mean: -0.041842278093099594, mean p set: 0.4481825828552246The modified gen p mean: 0.44628408551216125, gen p mean: -0.0409269742667675, mean p set: 0.44676437973976135
loss_pred:0.013766410760581493, decouple_loss:0.0012838005786761642
loss_pred:0.014009179547429085, decouple_loss:0.0012769087916240096
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012005_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012005_3_24hr.npz
NaN value num: 0
Iteration: 1863, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.452714741230011, gen p mean: -0.035037919878959656, mean p set: 0.4531950354576111
loss_pred:0.01709720678627491, decouple_loss:0.0013298273552209139
The modified gen p mean: 0.4524059295654297, gen p mean: -0.03624428063631058, mean p set: 0.4528862237930298The modified gen p mean: 0.45134809613227844, gen p mean: -0.03399930149316788, mean p set: 0.4518284201622009
loss_pred:0.016176091507077217, decouple_loss:0.0012651734286919236
loss_pred:0.01569577492773533, decouple_loss:0.0013176890788599849
Iteration: 1864, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4519527554512024, gen p mean: -0.029052773490548134, mean p set: 0.4524330198764801
loss_pred:0.015571290627121925, decouple_loss:0.0012313437182456255
The modified gen p mean: 0.4542931020259857, gen p mean: -0.02845161221921444, mean p set: 0.4547733962535858The modified gen p mean: 0.4519331455230713, gen p mean: -0.032164618372917175, mean p set: 0.4524134397506714
loss_pred:0.016655493527650833, decouple_loss:0.001191448885947466
loss_pred:0.015401252545416355, decouple_loss:0.0011873177718371153
Iteration: 1865, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4520867168903351, gen p mean: -0.03373470902442932, mean p set: 0.4525669813156128
loss_pred:0.016698701307177544, decouple_loss:0.0012787871528416872
The modified gen p mean: 0.4527427554130554, gen p mean: -0.03058948554098606, mean p set: 0.45322301983833313The modified gen p mean: 0.4527265727519989, gen p mean: -0.032170478254556656, mean p set: 0.453206866979599
loss_pred:0.01460272166877985, decouple_loss:0.001259747426956892
loss_pred:0.015042065642774105, decouple_loss:0.0013299980200827122
Iteration: 1866, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4520016610622406, gen p mean: -0.028112253174185753, mean p set: 0.4524819552898407
loss_pred:0.016516881063580513, decouple_loss:0.001250919420272112
The modified gen p mean: 0.45305269956588745, gen p mean: -0.02771272510290146, mean p set: 0.45353299379348755The modified gen p mean: 0.4513065814971924, gen p mean: -0.023903701454401016, mean p set: 0.4517868459224701
loss_pred:0.01625097543001175, decouple_loss:0.0012329265009611845
loss_pred:0.0156083470210433, decouple_loss:0.0011964207515120506
Iteration: 1867, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4529833197593689, gen p mean: -0.03294914588332176, mean p set: 0.4534636437892914
loss_pred:0.016758142039179802, decouple_loss:0.0014861546223983169
The modified gen p mean: 0.4524511694908142, gen p mean: -0.022943682968616486, mean p set: 0.4529314935207367The modified gen p mean: 0.45231372117996216, gen p mean: -0.02889259159564972, mean p set: 0.45279404520988464
loss_pred:0.015225997194647789, decouple_loss:0.0012972622644156218
loss_pred:0.016508333384990692, decouple_loss:0.0013808292569592595
Iteration: 1868, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45258498191833496, gen p mean: -0.02829144336283207, mean p set: 0.45306530594825745
loss_pred:0.014883637428283691, decouple_loss:0.0011508635943755507
The modified gen p mean: 0.45320218801498413, gen p mean: -0.03139323368668556, mean p set: 0.45368245244026184The modified gen p mean: 0.4527721405029297, gen p mean: -0.0331326499581337, mean p set: 0.4532524347305298
loss_pred:0.015778128057718277, decouple_loss:0.0012204884551465511
loss_pred:0.015341063030064106, decouple_loss:0.0012158972676843405
Iteration: 1869, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4525592029094696, gen p mean: -0.03048594295978546, mean p set: 0.4530394971370697
loss_pred:0.015905357897281647, decouple_loss:0.0014039244269952178
The modified gen p mean: 0.4522419273853302, gen p mean: -0.031730715185403824, mean p set: 0.4527222514152527The modified gen p mean: 0.4548449218273163, gen p mean: -0.026032904163002968, mean p set: 0.4553252160549164
loss_pred:0.0152966920286417, decouple_loss:0.0014263108605518937
loss_pred:0.01606142893433571, decouple_loss:0.0013687449973076582
Iteration: 1870, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4533917009830475, gen p mean: -0.028725046664476395, mean p set: 0.4538719952106476
loss_pred:0.016086043789982796, decouple_loss:0.0011648193467408419
The modified gen p mean: 0.4515909254550934, gen p mean: -0.027208887040615082, mean p set: 0.4520712196826935The modified gen p mean: 0.453250527381897, gen p mean: -0.032337985932826996, mean p set: 0.45373082160949707
loss_pred:0.015412756241858006, decouple_loss:0.0011183512397110462
loss_pred:0.014362744055688381, decouple_loss:0.001170569914393127
2023-05-02 09:41:51 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.04001700133085251, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.03527333587408066, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.036096151918172836, mean p set: 0.4500633478164673
loss_pred:0.018611233681440353, decouple_loss:0.0015416211681440473
loss_pred:0.017510008066892624, decouple_loss:0.0015656034229323268
loss_pred:0.01755320094525814, decouple_loss:0.0015419641276821494
WV_0_PC_1_EH_0_PS_40, loss: 0.01796896755695343, avg_mse: 0.02583281509578228
current test mse: 0.025833
Iteration: 1871, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45377808809280396, gen p mean: -0.024282870814204216, mean p set: 0.45425835251808167
The modified gen p mean: 0.45311427116394043, gen p mean: -0.03250637277960777, mean p set: 0.4535945653915405
The modified gen p mean: 0.45179280638694763, gen p mean: -0.032074738293886185, mean p set: 0.45227310061454773
loss_pred:0.01681896485388279, decouple_loss:0.0016258427640423179
loss_pred:0.016151076182723045, decouple_loss:0.0015486112097278237
loss_pred:0.014310039579868317, decouple_loss:0.0013738716952502728
Iteration: 1872, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4525388479232788, gen p mean: -0.026159372180700302, mean p set: 0.4530191123485565
loss_pred:0.016229931265115738, decouple_loss:0.0012148363748565316
The modified gen p mean: 0.45301079750061035, gen p mean: -0.02868945710361004, mean p set: 0.45349109172821045The modified gen p mean: 0.4516843557357788, gen p mean: -0.03021869994699955, mean p set: 0.4521646797657013
loss_pred:0.015386209823191166, decouple_loss:0.001257927855476737
loss_pred:0.015403191559016705, decouple_loss:0.0012296102941036224
Iteration: 1873, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45258545875549316, gen p mean: -0.02319752424955368, mean p set: 0.4530657231807709
loss_pred:0.015120789408683777, decouple_loss:0.00136100547388196
The modified gen p mean: 0.4518902897834778, gen p mean: -0.02512931264936924, mean p set: 0.4523705840110779The modified gen p mean: 0.4516180157661438, gen p mean: -0.03442929685115814, mean p set: 0.4520983099937439
loss_pred:0.015926025807857513, decouple_loss:0.001349533791653812
loss_pred:0.015292407013475895, decouple_loss:0.0013600237434729934
Iteration: 1874, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45237550139427185, gen p mean: -0.029445571824908257, mean p set: 0.45285579562187195
loss_pred:0.01627451367676258, decouple_loss:0.0012342191766947508
The modified gen p mean: 0.4519041180610657, gen p mean: -0.030373143032193184, mean p set: 0.45238441228866577The modified gen p mean: 0.45199093222618103, gen p mean: -0.02970692329108715, mean p set: 0.45247119665145874
loss_pred:0.01497106533497572, decouple_loss:0.001269581844098866
loss_pred:0.016132129356265068, decouple_loss:0.0012258029310032725
Iteration: 1875, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4529091417789459, gen p mean: -0.03510313108563423, mean p set: 0.45338940620422363
loss_pred:0.015521125867962837, decouple_loss:0.0012938559520989656
The modified gen p mean: 0.45410701632499695, gen p mean: -0.034849658608436584, mean p set: 0.45458728075027466The modified gen p mean: 0.45320364832878113, gen p mean: -0.034956756979227066, mean p set: 0.4536839425563812
loss_pred:0.015748361125588417, decouple_loss:0.001408127136528492
loss_pred:0.01685728132724762, decouple_loss:0.0013424281496554613
Iteration: 1876, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45416387915611267, gen p mean: -0.028943991288542747, mean p set: 0.45464417338371277
loss_pred:0.016176825389266014, decouple_loss:0.0011485937284305692
The modified gen p mean: 0.4525115191936493, gen p mean: -0.03206813707947731, mean p set: 0.4529918134212494The modified gen p mean: 0.452231764793396, gen p mean: -0.035421907901763916, mean p set: 0.4527120590209961
loss_pred:0.016581008210778236, decouple_loss:0.001184441614896059
loss_pred:0.01593714766204357, decouple_loss:0.001209654612466693
Iteration: 1877, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4524298310279846, gen p mean: -0.029456743970513344, mean p set: 0.4529101252555847
loss_pred:0.014914830215275288, decouple_loss:0.0013338152784854174
The modified gen p mean: 0.45363762974739075, gen p mean: -0.040568843483924866, mean p set: 0.45411795377731323The modified gen p mean: 0.4526849389076233, gen p mean: -0.031192585825920105, mean p set: 0.4531652331352234
loss_pred:0.014898617751896381, decouple_loss:0.0014206451596692204
loss_pred:0.015905436128377914, decouple_loss:0.0013862589839845896
Iteration: 1878, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45210444927215576, gen p mean: -0.03548960015177727, mean p set: 0.45258474349975586
loss_pred:0.016574479639530182, decouple_loss:0.001148589071817696
The modified gen p mean: 0.4518020749092102, gen p mean: -0.033253662288188934, mean p set: 0.4522823691368103The modified gen p mean: 0.4533199667930603, gen p mean: -0.03982165455818176, mean p set: 0.4538002610206604
loss_pred:0.015663255006074905, decouple_loss:0.0011365606915205717
loss_pred:0.015393995679914951, decouple_loss:0.0011539357947185636
Iteration: 1879, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.452146053314209, gen p mean: -0.0362585186958313, mean p set: 0.45262637734413147
loss_pred:0.015417980961501598, decouple_loss:0.0012473224196583033
The modified gen p mean: 0.4513419568538666, gen p mean: -0.03322722762823105, mean p set: 0.4518222510814667The modified gen p mean: 0.4527815580368042, gen p mean: -0.03850608691573143, mean p set: 0.4532618522644043
loss_pred:0.015428208746016026, decouple_loss:0.001199031830765307
loss_pred:0.01686333492398262, decouple_loss:0.0011678638402372599
Iteration: 1880, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4535498023033142, gen p mean: -0.03892922401428223, mean p set: 0.4540300667285919
loss_pred:0.01541553158313036, decouple_loss:0.0010786455823108554
The modified gen p mean: 0.45313453674316406, gen p mean: -0.04150260239839554, mean p set: 0.45361486077308655The modified gen p mean: 0.45272377133369446, gen p mean: -0.03806497901678085, mean p set: 0.45320409536361694
loss_pred:0.014583840034902096, decouple_loss:0.0010938048362731934
loss_pred:0.015865717083215714, decouple_loss:0.0010826574871316552
2023-05-02 09:43:46 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.04727006331086159, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04222332313656807, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04277266189455986, mean p set: 0.4500633478164673
loss_pred:0.018596602603793144, decouple_loss:0.00137128378264606
loss_pred:0.017476048320531845, decouple_loss:0.001182404113933444
loss_pred:0.017527887597680092, decouple_loss:0.0012701096711680293
WV_0_PC_1_EH_0_PS_40, loss: 0.01793057844042778, avg_mse: 0.025781946256756783
current test mse: 0.025782
Iteration: 1881, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4525059163570404, gen p mean: -0.03454270213842392, mean p set: 0.4529862403869629
The modified gen p mean: 0.452522873878479, gen p mean: -0.03550143167376518, mean p set: 0.4530031979084015
The modified gen p mean: 0.45121005177497864, gen p mean: -0.036413971334695816, mean p set: 0.45169031620025635
loss_pred:0.015471674501895905, decouple_loss:0.0011150308419018984
loss_pred:0.01588783785700798, decouple_loss:0.0012411257484927773
loss_pred:0.014410728588700294, decouple_loss:0.0012744416017085314
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012007_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012007_3_24hr.npz
NaN value num: 0
Iteration: 1882, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44888585805892944, gen p mean: -0.039412617683410645, mean p set: 0.44936615228652954
loss_pred:0.015456601977348328, decouple_loss:0.0010950010037049651
The modified gen p mean: 0.45045509934425354, gen p mean: -0.036638304591178894, mean p set: 0.45093539357185364The modified gen p mean: 0.4492669999599457, gen p mean: -0.038571812212467194, mean p set: 0.4497472941875458
loss_pred:0.016212325543165207, decouple_loss:0.0011114508379250765
loss_pred:0.015338468365371227, decouple_loss:0.001087168580852449
Iteration: 1883, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449098140001297, gen p mean: -0.03576543554663658, mean p set: 0.4495784640312195
loss_pred:0.015830177813768387, decouple_loss:0.0011813484597951174
The modified gen p mean: 0.448742538690567, gen p mean: -0.03604153171181679, mean p set: 0.4492228329181671The modified gen p mean: 0.4483919143676758, gen p mean: -0.031553108245134354, mean p set: 0.4488722085952759
loss_pred:0.0156417079269886, decouple_loss:0.0012538251467049122
loss_pred:0.015885304659605026, decouple_loss:0.001202902989462018
Iteration: 1884, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45073339343070984, gen p mean: -0.032667797058820724, mean p set: 0.45121368765830994
loss_pred:0.01474522054195404, decouple_loss:0.0010291971266269684
The modified gen p mean: 0.44856712222099304, gen p mean: -0.03307594358921051, mean p set: 0.44904738664627075The modified gen p mean: 0.4489796757698059, gen p mean: -0.03261394426226616, mean p set: 0.4494599997997284
loss_pred:0.015971453860402107, decouple_loss:0.0010035437298938632
loss_pred:0.015480895526707172, decouple_loss:0.0010221883421763778
Iteration: 1885, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44779276847839355, gen p mean: -0.032273516058921814, mean p set: 0.44827306270599365
The modified gen p mean: 0.45030295848846436, gen p mean: -0.03601532429456711, mean p set: 0.45078325271606445
loss_pred:0.015559537336230278, decouple_loss:0.0012739988742396235
The modified gen p mean: 0.4501005709171295, gen p mean: -0.031068746000528336, mean p set: 0.4505808651447296
loss_pred:0.016137752681970596, decouple_loss:0.0012696811463683844
loss_pred:0.015813592821359634, decouple_loss:0.0011360443895682693
Iteration: 1886, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487535059452057, gen p mean: -0.038722045719623566, mean p set: 0.4492338001728058
loss_pred:0.015442192554473877, decouple_loss:0.0012052064994350076
The modified gen p mean: 0.4481292963027954, gen p mean: -0.031183632090687752, mean p set: 0.44860953092575073The modified gen p mean: 0.44732365012168884, gen p mean: -0.029897762462496758, mean p set: 0.44780394434928894
loss_pred:0.015274050645530224, decouple_loss:0.0012734801275655627
loss_pred:0.015335717238485813, decouple_loss:0.0012139335740357637
Iteration: 1887, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504678249359131, gen p mean: -0.03111564926803112, mean p set: 0.4509481191635132
loss_pred:0.0164335984736681, decouple_loss:0.0012547282967716455
The modified gen p mean: 0.45119157433509827, gen p mean: -0.03106856532394886, mean p set: 0.45167189836502075The modified gen p mean: 0.4493372142314911, gen p mean: -0.035627443343400955, mean p set: 0.4498175084590912
loss_pred:0.01541586872190237, decouple_loss:0.001167657901532948
loss_pred:0.016205448657274246, decouple_loss:0.0012348006712272763
Iteration: 1888, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44951292872428894, gen p mean: -0.03188282623887062, mean p set: 0.44999319314956665
The modified gen p mean: 0.44907498359680176, gen p mean: -0.029370807111263275, mean p set: 0.44955530762672424
loss_pred:0.015720181167125702, decouple_loss:0.0011127876350656152
loss_pred:0.015679500997066498, decouple_loss:0.0011827207636088133
The modified gen p mean: 0.44936704635620117, gen p mean: -0.039684660732746124, mean p set: 0.44984734058380127
loss_pred:0.016495807096362114, decouple_loss:0.0011072383495047688
Iteration: 1889, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494897425174713, gen p mean: -0.0365988165140152, mean p set: 0.4499700367450714
loss_pred:0.0161528829485178, decouple_loss:0.0012765744468197227
The modified gen p mean: 0.44828465580940247, gen p mean: -0.03608248010277748, mean p set: 0.44876495003700256The modified gen p mean: 0.45038244128227234, gen p mean: -0.035570353269577026, mean p set: 0.45086273550987244
loss_pred:0.016131138429045677, decouple_loss:0.0011914980132132769
loss_pred:0.016520380973815918, decouple_loss:0.0011855788761749864
Iteration: 1890, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479636251926422, gen p mean: -0.04402899742126465, mean p set: 0.4484439492225647
loss_pred:0.01569814421236515, decouple_loss:0.0013432411942631006
The modified gen p mean: 0.4505018889904022, gen p mean: -0.03506874293088913, mean p set: 0.45098215341567993The modified gen p mean: 0.45000436902046204, gen p mean: -0.038176070898771286, mean p set: 0.45048466324806213
loss_pred:0.01671108976006508, decouple_loss:0.0011774925515055656
loss_pred:0.015864361077547073, decouple_loss:0.0012488315114751458
2023-05-02 09:46:14 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.052405450493097305, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.046350058168172836, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.04846611246466637, mean p set: 0.4500633478164673
loss_pred:0.018747029826045036, decouple_loss:0.001351907616481185
loss_pred:0.01779361441731453, decouple_loss:0.0013302626321092248
loss_pred:0.017730198800563812, decouple_loss:0.0012755240313708782
WV_0_PC_1_EH_0_PS_40, loss: 0.01815624348819256, avg_mse: 0.02612564153969288
current test mse: 0.026126
Iteration: 1891, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44873544573783875, gen p mean: -0.043721117079257965, mean p set: 0.44921573996543884
The modified gen p mean: 0.450958251953125, gen p mean: -0.03949956223368645, mean p set: 0.4514385461807251
The modified gen p mean: 0.44839420914649963, gen p mean: -0.04254652559757233, mean p set: 0.44887450337409973
loss_pred:0.015184334479272366, decouple_loss:0.0012163413921371102
loss_pred:0.015151412226259708, decouple_loss:0.0013347141211852431
loss_pred:0.016320830211043358, decouple_loss:0.001240869634784758
Iteration: 1892, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492523670196533, gen p mean: -0.04617302864789963, mean p set: 0.4497326612472534
loss_pred:0.01633777655661106, decouple_loss:0.0012176280142739415
The modified gen p mean: 0.45088982582092285, gen p mean: -0.04133206978440285, mean p set: 0.45137009024620056The modified gen p mean: 0.4502352178096771, gen p mean: -0.03876758739352226, mean p set: 0.4507155418395996
loss_pred:0.014947811141610146, decouple_loss:0.0011954475194215775
loss_pred:0.014293349348008633, decouple_loss:0.0011815878096967936
Iteration: 1893, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44951075315475464, gen p mean: -0.044503387063741684, mean p set: 0.44999101758003235
loss_pred:0.015858253464102745, decouple_loss:0.0013719587586820126
The modified gen p mean: 0.4485502243041992, gen p mean: -0.04629741236567497, mean p set: 0.44903048872947693The modified gen p mean: 0.44945529103279114, gen p mean: -0.03696879372000694, mean p set: 0.4499356150627136
loss_pred:0.015791289508342743, decouple_loss:0.0013233587378636003
loss_pred:0.015708787366747856, decouple_loss:0.0012977952137589455
Iteration: 1894, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501960277557373, gen p mean: -0.0405564047396183, mean p set: 0.4506763517856598
The modified gen p mean: 0.4497455358505249, gen p mean: -0.040368396788835526, mean p set: 0.450225830078125
loss_pred:0.01579947955906391, decouple_loss:0.0012815188383683562
loss_pred:0.016472091898322105, decouple_loss:0.0012438426492735744
The modified gen p mean: 0.4491819441318512, gen p mean: -0.04375731945037842, mean p set: 0.4496622681617737
loss_pred:0.015460805036127567, decouple_loss:0.001226346124894917
Iteration: 1895, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44813019037246704, gen p mean: -0.041239142417907715, mean p set: 0.44861045479774475
The modified gen p mean: 0.448784202337265, gen p mean: -0.036634162068367004, mean p set: 0.4492644667625427
loss_pred:0.015450986102223396, decouple_loss:0.0011868284782394767
loss_pred:0.015388786792755127, decouple_loss:0.001133933779783547
The modified gen p mean: 0.4500219225883484, gen p mean: -0.0313592292368412, mean p set: 0.4505022168159485
loss_pred:0.015874672681093216, decouple_loss:0.0012285877019166946
Iteration: 1896, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44935426115989685, gen p mean: -0.03463742882013321, mean p set: 0.44983452558517456
The modified gen p mean: 0.45016512274742126, gen p mean: -0.034181859344244, mean p set: 0.45064541697502136
loss_pred:0.015705516561865807, decouple_loss:0.0012355237267911434
loss_pred:0.015606103464961052, decouple_loss:0.0012464916799217463
The modified gen p mean: 0.44946929812431335, gen p mean: -0.03390292450785637, mean p set: 0.44994959235191345
loss_pred:0.015772955492138863, decouple_loss:0.001247558742761612
Iteration: 1897, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486050605773926, gen p mean: -0.04002586379647255, mean p set: 0.4490853548049927
The modified gen p mean: 0.44841963052749634, gen p mean: -0.03733259439468384, mean p set: 0.44889989495277405
loss_pred:0.015051526017487049, decouple_loss:0.001329960417933762
loss_pred:0.015622725710272789, decouple_loss:0.0013298585545271635
The modified gen p mean: 0.448365181684494, gen p mean: -0.03829147294163704, mean p set: 0.4488454759120941
loss_pred:0.015686027705669403, decouple_loss:0.0012516235001385212
Iteration: 1898, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500592350959778, gen p mean: -0.03896721452474594, mean p set: 0.4505395293235779
loss_pred:0.01618308015167713, decouple_loss:0.0012601569760590792
The modified gen p mean: 0.4500577747821808, gen p mean: -0.03402179107069969, mean p set: 0.4505380690097809The modified gen p mean: 0.4483434557914734, gen p mean: -0.038944851607084274, mean p set: 0.4488237500190735
loss_pred:0.015331956557929516, decouple_loss:0.0011051883921027184
loss_pred:0.015760738402605057, decouple_loss:0.0010882028145715594
Iteration: 1899, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488302171230316, gen p mean: -0.039944861084222794, mean p set: 0.4493105113506317
loss_pred:0.01586754061281681, decouple_loss:0.0012976389843970537
The modified gen p mean: 0.44930654764175415, gen p mean: -0.040335264056921005, mean p set: 0.44978684186935425The modified gen p mean: 0.4476589858531952, gen p mean: -0.038723237812519073, mean p set: 0.4481392800807953
loss_pred:0.01508096419274807, decouple_loss:0.0012189092813059688
loss_pred:0.015278263948857784, decouple_loss:0.0012892117956653237
Iteration: 1900, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449989914894104, gen p mean: -0.035275354981422424, mean p set: 0.4504702091217041
loss_pred:0.01576295495033264, decouple_loss:0.0013000776525586843
The modified gen p mean: 0.448661208152771, gen p mean: -0.035340435802936554, mean p set: 0.4491414725780487The modified gen p mean: 0.44851192831993103, gen p mean: -0.03746024891734123, mean p set: 0.44899222254753113
loss_pred:0.01568901538848877, decouple_loss:0.0011604827595874667
loss_pred:0.014476671814918518, decouple_loss:0.001157455611974001
2023-05-02 09:48:07 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.04848400503396988, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.0440315417945385, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.044512275606393814, mean p set: 0.4500633478164673
loss_pred:0.018671071156859398, decouple_loss:0.0013011868577450514
loss_pred:0.01762242056429386, decouple_loss:0.001279458636417985
loss_pred:0.01767713949084282, decouple_loss:0.001273888279683888
WV_0_PC_1_EH_0_PS_40, loss: 0.018054451793432236, avg_mse: 0.025969048961997032
current test mse: 0.025969
Iteration: 1901, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504282474517822, gen p mean: -0.035098593682050705, mean p set: 0.4509085714817047
The modified gen p mean: 0.4501855969429016, gen p mean: -0.03546525537967682, mean p set: 0.4506658911705017
The modified gen p mean: 0.4498671889305115, gen p mean: -0.03439142927527428, mean p set: 0.45034751296043396
loss_pred:0.016253123059868813, decouple_loss:0.0011977197136729956
loss_pred:0.015600600279867649, decouple_loss:0.001222683466039598
loss_pred:0.015285118483006954, decouple_loss:0.0011991792125627398
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012000_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012000_3_24hr.npz
NaN value num: 0
Iteration: 1902, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497229754924774, gen p mean: -0.037571411579847336, mean p set: 0.4502032399177551
loss_pred:0.017850499600172043, decouple_loss:0.0012011436047032475
The modified gen p mean: 0.450955867767334, gen p mean: -0.04180549457669258, mean p set: 0.4514361619949341The modified gen p mean: 0.45099037885665894, gen p mean: -0.039556462317705154, mean p set: 0.45147067308425903
loss_pred:0.01709653250873089, decouple_loss:0.0012065358459949493
loss_pred:0.016444388777017593, decouple_loss:0.0013359923614189029
Iteration: 1903, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44912153482437134, gen p mean: -0.03600454330444336, mean p set: 0.44960182905197144
loss_pred:0.017972135916352272, decouple_loss:0.0012092497199773788
The modified gen p mean: 0.45180249214172363, gen p mean: -0.03656993806362152, mean p set: 0.45228278636932373The modified gen p mean: 0.4509980082511902, gen p mean: -0.03715722635388374, mean p set: 0.4514783024787903
loss_pred:0.017675364390015602, decouple_loss:0.0013415166176855564
loss_pred:0.016107629984617233, decouple_loss:0.0011387295089662075
Iteration: 1904, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45126044750213623, gen p mean: -0.03467338904738426, mean p set: 0.45174074172973633
loss_pred:0.016513245180249214, decouple_loss:0.0011637938441708684
The modified gen p mean: 0.4512881934642792, gen p mean: -0.037343841046094894, mean p set: 0.4517684876918793The modified gen p mean: 0.4501146972179413, gen p mean: -0.03652401268482208, mean p set: 0.4505949914455414
loss_pred:0.016303371638059616, decouple_loss:0.0012312710750848055
loss_pred:0.01736266165971756, decouple_loss:0.0011888582957908511
Iteration: 1905, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483369290828705, gen p mean: -0.03291352465748787, mean p set: 0.4488172233104706
The modified gen p mean: 0.4518822729587555, gen p mean: -0.03343157842755318, mean p set: 0.4523625671863556
loss_pred:0.017418507486581802, decouple_loss:0.0011930811451748013
loss_pred:0.017897168174386024, decouple_loss:0.001168329268693924
The modified gen p mean: 0.4505423605442047, gen p mean: -0.03293995559215546, mean p set: 0.4510226845741272
loss_pred:0.016264306381344795, decouple_loss:0.001163751701824367
Iteration: 1906, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4521511495113373, gen p mean: -0.03393642231822014, mean p set: 0.4526314437389374
The modified gen p mean: 0.4504566490650177, gen p mean: -0.029831038787961006, mean p set: 0.4509369432926178loss_pred:0.01647304743528366, decouple_loss:0.001217527431435883
The modified gen p mean: 0.4509517252445221, gen p mean: -0.03320521488785744, mean p set: 0.4514320194721222
loss_pred:0.016578415408730507, decouple_loss:0.0011675232090055943
loss_pred:0.017359016463160515, decouple_loss:0.0012241629883646965
Iteration: 1907, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4510155916213989, gen p mean: -0.028250887989997864, mean p set: 0.45149585604667664
The modified gen p mean: 0.4503180980682373, gen p mean: -0.028077982366085052, mean p set: 0.4507984220981598loss_pred:0.01677587255835533, decouple_loss:0.001117100240662694
The modified gen p mean: 0.4518599510192871, gen p mean: -0.03146613761782646, mean p set: 0.4523402452468872
loss_pred:0.017402568832039833, decouple_loss:0.0010824475903064013
loss_pred:0.017140811309218407, decouple_loss:0.0011481127003207803
Iteration: 1908, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45023050904273987, gen p mean: -0.026239166036248207, mean p set: 0.45071083307266235
The modified gen p mean: 0.4514044225215912, gen p mean: -0.028547901660203934, mean p set: 0.4518847167491913
loss_pred:0.01642400585114956, decouple_loss:0.0011281853076070547
loss_pred:0.01618870534002781, decouple_loss:0.001117707695811987
The modified gen p mean: 0.45327427983283997, gen p mean: -0.030468029901385307, mean p set: 0.45375457406044006
loss_pred:0.01710536703467369, decouple_loss:0.0011594302486628294
Iteration: 1909, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492076337337494, gen p mean: -0.03008107841014862, mean p set: 0.4496879279613495
The modified gen p mean: 0.4513819217681885, gen p mean: -0.02806701511144638, mean p set: 0.4518622159957886
loss_pred:0.017756320536136627, decouple_loss:0.001079925918020308
loss_pred:0.016817286610603333, decouple_loss:0.0009948848746716976
The modified gen p mean: 0.45056188106536865, gen p mean: -0.027767961844801903, mean p set: 0.45104217529296875
loss_pred:0.016832754015922546, decouple_loss:0.0010272847721353173
Iteration: 1910, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45096805691719055, gen p mean: -0.03003084845840931, mean p set: 0.45144835114479065
The modified gen p mean: 0.45139259099960327, gen p mean: -0.03292977437376976, mean p set: 0.45187288522720337
loss_pred:0.01686340570449829, decouple_loss:0.0011558253318071365
loss_pred:0.016673892736434937, decouple_loss:0.001051887171342969
The modified gen p mean: 0.4517207741737366, gen p mean: -0.03329778090119362, mean p set: 0.45220106840133667
loss_pred:0.01665773056447506, decouple_loss:0.0011498044477775693
2023-05-02 09:50:45 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.039856765419244766, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.035396553575992584, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.0356084369122982, mean p set: 0.4500633478164673
loss_pred:0.018369529396295547, decouple_loss:0.00119818898383528
loss_pred:0.01732252724468708, decouple_loss:0.0012433161027729511
loss_pred:0.01738242246210575, decouple_loss:0.0012147147208452225
WV_0_PC_1_EH_0_PS_40, loss: 0.017752431333065033, avg_mse: 0.025394311174750328
current test mse: 0.025394
Iteration: 1911, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45236870646476746, gen p mean: -0.032668229192495346, mean p set: 0.45284903049468994
The modified gen p mean: 0.45077645778656006, gen p mean: -0.030999964103102684, mean p set: 0.45125675201416016
The modified gen p mean: 0.4494740962982178, gen p mean: -0.027811765670776367, mean p set: 0.4499543607234955
loss_pred:0.016060570254921913, decouple_loss:0.0011524433502927423
loss_pred:0.017031824216246605, decouple_loss:0.0011820035288110375
loss_pred:0.01660376973450184, decouple_loss:0.0011402114760130644
Iteration: 1912, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45081281661987305, gen p mean: -0.03537149354815483, mean p set: 0.45129311084747314
loss_pred:0.01584797538816929, decouple_loss:0.0010408347006887197
The modified gen p mean: 0.4505453109741211, gen p mean: -0.03275325521826744, mean p set: 0.4510255753993988The modified gen p mean: 0.4494144916534424, gen p mean: -0.034312423318624496, mean p set: 0.4498947560787201
loss_pred:0.01649562269449234, decouple_loss:0.0011252053081989288
loss_pred:0.017146319150924683, decouple_loss:0.0011041517136618495
Iteration: 1913, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449690043926239, gen p mean: -0.03285884112119675, mean p set: 0.4501703083515167
loss_pred:0.015891263261437416, decouple_loss:0.0010522803058847785
The modified gen p mean: 0.45048147439956665, gen p mean: -0.03529913350939751, mean p set: 0.45096179842948914The modified gen p mean: 0.4514085352420807, gen p mean: -0.03568056970834732, mean p set: 0.4518887996673584
loss_pred:0.01709102652966976, decouple_loss:0.0011358588235452771
loss_pred:0.01585383713245392, decouple_loss:0.001058748341165483
Iteration: 1914, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503440260887146, gen p mean: -0.039039988070726395, mean p set: 0.4508242905139923
The modified gen p mean: 0.4503093957901001, gen p mean: -0.03603414073586464, mean p set: 0.4507897198200226
loss_pred:0.01647680252790451, decouple_loss:0.0010000804904848337
loss_pred:0.016131576150655746, decouple_loss:0.0010254902299493551
The modified gen p mean: 0.4490741789340973, gen p mean: -0.04042964428663254, mean p set: 0.449554443359375
loss_pred:0.017260145395994186, decouple_loss:0.0011215003905817866
Iteration: 1915, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4526783525943756, gen p mean: -0.04243607074022293, mean p set: 0.4531586468219757
loss_pred:0.016478653997182846, decouple_loss:0.0010263058356940746
The modified gen p mean: 0.44994574785232544, gen p mean: -0.042514536529779434, mean p set: 0.4504260718822479The modified gen p mean: 0.45169541239738464, gen p mean: -0.04023566469550133, mean p set: 0.45217567682266235
loss_pred:0.01734207384288311, decouple_loss:0.0010579321533441544
loss_pred:0.016456175595521927, decouple_loss:0.0009789241012185812
Iteration: 1916, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494269788265228, gen p mean: -0.039228834211826324, mean p set: 0.4499072730541229
The modified gen p mean: 0.45204994082450867, gen p mean: -0.04647297412157059, mean p set: 0.45253023505210876
loss_pred:0.015561750158667564, decouple_loss:0.0009981098119169474
loss_pred:0.016529597342014313, decouple_loss:0.0010384958004578948
The modified gen p mean: 0.45176178216934204, gen p mean: -0.043525807559490204, mean p set: 0.45224204659461975
loss_pred:0.016148660331964493, decouple_loss:0.0009979509050026536
Iteration: 1917, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45169195532798767, gen p mean: -0.04524235054850578, mean p set: 0.45217224955558777
loss_pred:0.016291189938783646, decouple_loss:0.001079178531654179
The modified gen p mean: 0.45051661133766174, gen p mean: -0.04284628853201866, mean p set: 0.45099693536758423The modified gen p mean: 0.45087891817092896, gen p mean: -0.04487605020403862, mean p set: 0.45135921239852905
loss_pred:0.016298066824674606, decouple_loss:0.0009984568459913135
loss_pred:0.0164499469101429, decouple_loss:0.0010783273028209805
Iteration: 1918, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45067211985588074, gen p mean: -0.04249058663845062, mean p set: 0.4511524438858032
loss_pred:0.016694199293851852, decouple_loss:0.001021896256133914
The modified gen p mean: 0.45157966017723083, gen p mean: -0.04376750811934471, mean p set: 0.45205995440483093The modified gen p mean: 0.45314085483551025, gen p mean: -0.04620208963751793, mean p set: 0.45362117886543274
loss_pred:0.016888484358787537, decouple_loss:0.0010259817354381084
loss_pred:0.01659497059881687, decouple_loss:0.0011149601778015494
Iteration: 1919, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45009326934814453, gen p mean: -0.04258366674184799, mean p set: 0.45057356357574463
The modified gen p mean: 0.4506039619445801, gen p mean: -0.042839545756578445, mean p set: 0.4510842561721802
loss_pred:0.017406705766916275, decouple_loss:0.0009898272110149264
loss_pred:0.015918077901005745, decouple_loss:0.0009767167503014207
The modified gen p mean: 0.4500580132007599, gen p mean: -0.042441193014383316, mean p set: 0.45053830742836
loss_pred:0.016282031312584877, decouple_loss:0.0009807718452066183
Iteration: 1920, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450970321893692, gen p mean: -0.04086606577038765, mean p set: 0.4514505863189697
loss_pred:0.016156857833266258, decouple_loss:0.0010040311608463526
The modified gen p mean: 0.45196449756622314, gen p mean: -0.04481292515993118, mean p set: 0.45244479179382324The modified gen p mean: 0.45200175046920776, gen p mean: -0.04133618250489235, mean p set: 0.45248204469680786
loss_pred:0.016632672399282455, decouple_loss:0.0010728280758485198
loss_pred:0.015752604231238365, decouple_loss:0.001004267600364983
2023-05-02 09:52:40 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.04850786179304123, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04402764141559601, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.0443800687789917, mean p set: 0.4500633478164673
loss_pred:0.018286611884832382, decouple_loss:0.0011335801100358367
loss_pred:0.017215725034475327, decouple_loss:0.0011441423557698727
loss_pred:0.01730659045279026, decouple_loss:0.0011052443878725171
WV_0_PC_1_EH_0_PS_40, loss: 0.01765935868024826, avg_mse: 0.025266008451581
current test mse: 0.025266
Iteration: 1921, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450878381729126, gen p mean: -0.040139034390449524, mean p set: 0.4513586759567261
The modified gen p mean: 0.45119035243988037, gen p mean: -0.043580062687397, mean p set: 0.45167064666748047
The modified gen p mean: 0.450830340385437, gen p mean: -0.04093264788389206, mean p set: 0.4513106644153595
loss_pred:0.016218099743127823, decouple_loss:0.0010163834085687995
loss_pred:0.01632554829120636, decouple_loss:0.0009864261373877525
loss_pred:0.015872173011302948, decouple_loss:0.001066673081368208
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012002_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012002_3_24hr.npz
NaN value num: 0
Iteration: 1922, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44669926166534424, gen p mean: -0.04625597596168518, mean p set: 0.44717955589294434
loss_pred:0.01495453529059887, decouple_loss:0.001281023258343339
The modified gen p mean: 0.44840073585510254, gen p mean: -0.04632383584976196, mean p set: 0.448881059885025The modified gen p mean: 0.447457492351532, gen p mean: -0.04909211024641991, mean p set: 0.44793781638145447
loss_pred:0.015991773456335068, decouple_loss:0.0012235527392476797
loss_pred:0.0153927868232131, decouple_loss:0.001193203846924007
Iteration: 1923, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465464651584625, gen p mean: -0.04575781524181366, mean p set: 0.4470267593860626
loss_pred:0.015249636955559254, decouple_loss:0.0010336089180782437
The modified gen p mean: 0.44681262969970703, gen p mean: -0.04169749468564987, mean p set: 0.44729292392730713The modified gen p mean: 0.4475288987159729, gen p mean: -0.03981202840805054, mean p set: 0.448009192943573
loss_pred:0.015767954289913177, decouple_loss:0.0010817813454195857
loss_pred:0.015886208042502403, decouple_loss:0.0010503996163606644
Iteration: 1924, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474099576473236, gen p mean: -0.046596914529800415, mean p set: 0.4478902518749237
loss_pred:0.015305311419069767, decouple_loss:0.0011645859340205789
The modified gen p mean: 0.44693711400032043, gen p mean: -0.04771261289715767, mean p set: 0.44741740822792053The modified gen p mean: 0.4481351971626282, gen p mean: -0.04777045175433159, mean p set: 0.44861549139022827
loss_pred:0.015074869617819786, decouple_loss:0.0010936777107417583
loss_pred:0.015680154785513878, decouple_loss:0.0011055092327296734
Iteration: 1925, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44622603058815, gen p mean: -0.052903808653354645, mean p set: 0.4467063546180725
loss_pred:0.014830678701400757, decouple_loss:0.0010993757750838995
The modified gen p mean: 0.44587817788124084, gen p mean: -0.054095424711704254, mean p set: 0.44635844230651855The modified gen p mean: 0.4459763467311859, gen p mean: -0.05366618558764458, mean p set: 0.446456640958786
loss_pred:0.01433626003563404, decouple_loss:0.0010883400682359934
loss_pred:0.015011174604296684, decouple_loss:0.001232659094966948
Iteration: 1926, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44501030445098877, gen p mean: -0.060132548213005066, mean p set: 0.44549062848091125
loss_pred:0.01472014281898737, decouple_loss:0.0011464051203802228
The modified gen p mean: 0.4485483765602112, gen p mean: -0.05055435374379158, mean p set: 0.4490286707878113The modified gen p mean: 0.4464516043663025, gen p mean: -0.053058065474033356, mean p set: 0.4469318985939026
loss_pred:0.01488360483199358, decouple_loss:0.0011869826121255755
loss_pred:0.015126658603549004, decouple_loss:0.0012296821223571897
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1927, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44644805788993835, gen p mean: -0.060960493981838226, mean p set: 0.44692835211753845
loss_pred:0.01433972455561161, decouple_loss:0.0012042507296428084
The modified gen p mean: 0.4490334689617157, gen p mean: -0.05714951083064079, mean p set: 0.4495137631893158The modified gen p mean: 0.44722050428390503, gen p mean: -0.05926848202943802, mean p set: 0.4477007985115051
loss_pred:0.014732656069099903, decouple_loss:0.0011818490456789732
loss_pred:0.014773061498999596, decouple_loss:0.0011944136349484324
Iteration: 1928, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471326470375061, gen p mean: -0.06109253317117691, mean p set: 0.4476129114627838
loss_pred:0.015090007334947586, decouple_loss:0.0012147754896432161
The modified gen p mean: 0.4469771385192871, gen p mean: -0.06099216267466545, mean p set: 0.4474574029445648The modified gen p mean: 0.44642338156700134, gen p mean: -0.05573757365345955, mean p set: 0.44690370559692383
loss_pred:0.014713658019900322, decouple_loss:0.001220680889673531
loss_pred:0.01495774183422327, decouple_loss:0.0011646854691207409
Iteration: 1929, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477289915084839, gen p mean: -0.06042933836579323, mean p set: 0.448209285736084
The modified gen p mean: 0.44497737288475037, gen p mean: -0.06539726257324219, mean p set: 0.4454576373100281
loss_pred:0.014344269409775734, decouple_loss:0.0012220136122778058
loss_pred:0.014511515386402607, decouple_loss:0.0013347277417778969
The modified gen p mean: 0.4478619396686554, gen p mean: -0.06255001574754715, mean p set: 0.4483422338962555
loss_pred:0.014500919729471207, decouple_loss:0.001138857682235539
Iteration: 1930, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44721493124961853, gen p mean: -0.061825379729270935, mean p set: 0.44769522547721863
The modified gen p mean: 0.44790756702423096, gen p mean: -0.05984475091099739, mean p set: 0.44838783144950867
loss_pred:0.014267267659306526, decouple_loss:0.0012466375483199954
loss_pred:0.014567197300493717, decouple_loss:0.0012778100790455937
The modified gen p mean: 0.44786348938941956, gen p mean: -0.05693019554018974, mean p set: 0.44834378361701965
loss_pred:0.014086959883570671, decouple_loss:0.0012315592030063272
2023-05-02 09:55:10 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.05698651820421219, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.05209890753030777, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.052630312740802765, mean p set: 0.4500633478164673
loss_pred:0.018956350162625313, decouple_loss:0.0012449264759197831
loss_pred:0.017843211069703102, decouple_loss:0.0012484996113926172
loss_pred:0.01792525127530098, decouple_loss:0.0012395970989018679
WV_0_PC_1_EH_0_PS_40, loss: 0.018303822726011276, avg_mse: 0.0264715775847435
current test mse: 0.026472
Iteration: 1931, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44810187816619873, gen p mean: -0.055173054337501526, mean p set: 0.44858217239379883
The modified gen p mean: 0.44796085357666016, gen p mean: -0.05488567426800728, mean p set: 0.44844114780426025
The modified gen p mean: 0.44673678278923035, gen p mean: -0.05155297741293907, mean p set: 0.44721704721450806
loss_pred:0.014464609324932098, decouple_loss:0.0011388328857719898
loss_pred:0.01444213092327118, decouple_loss:0.0011764683295041323
loss_pred:0.014348725788295269, decouple_loss:0.0011078015668317676
Iteration: 1932, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472739100456238, gen p mean: -0.04504786431789398, mean p set: 0.4477542042732239
loss_pred:0.015194605104625225, decouple_loss:0.0012171025155112147
The modified gen p mean: 0.4464872479438782, gen p mean: -0.05242227762937546, mean p set: 0.44696754217147827The modified gen p mean: 0.4458503723144531, gen p mean: -0.05112512782216072, mean p set: 0.4463306665420532
loss_pred:0.013446279801428318, decouple_loss:0.0015975922578945756
loss_pred:0.014191451482474804, decouple_loss:0.0012776299845427275
Iteration: 1933, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44668179750442505, gen p mean: -0.04753870889544487, mean p set: 0.44716206192970276
loss_pred:0.014460288919508457, decouple_loss:0.001226907130330801
The modified gen p mean: 0.44668105244636536, gen p mean: -0.04686613753437996, mean p set: 0.44716131687164307The modified gen p mean: 0.44660383462905884, gen p mean: -0.04922376573085785, mean p set: 0.44708412885665894
loss_pred:0.01392618753015995, decouple_loss:0.0012492432724684477
loss_pred:0.014706033281981945, decouple_loss:0.0012837835820391774
Iteration: 1934, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44720014929771423, gen p mean: -0.04563761129975319, mean p set: 0.4476804733276367
loss_pred:0.01511386688798666, decouple_loss:0.0012027702759951353
The modified gen p mean: 0.4466274380683899, gen p mean: -0.04174312204122543, mean p set: 0.44710773229599The modified gen p mean: 0.44710928201675415, gen p mean: -0.04568351060152054, mean p set: 0.44758957624435425
loss_pred:0.014567101374268532, decouple_loss:0.001207009656354785
loss_pred:0.014336132444441319, decouple_loss:0.0013190744211897254
Iteration: 1935, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44610586762428284, gen p mean: -0.0432211272418499, mean p set: 0.4465861916542053
loss_pred:0.013848822563886642, decouple_loss:0.0012315060012042522
The modified gen p mean: 0.44727280735969543, gen p mean: -0.0405091866850853, mean p set: 0.44775307178497314The modified gen p mean: 0.44760170578956604, gen p mean: -0.04425119236111641, mean p set: 0.44808200001716614
loss_pred:0.01339550968259573, decouple_loss:0.001198190962895751
loss_pred:0.013338946737349033, decouple_loss:0.0012521202443167567
Iteration: 1936, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478778541088104, gen p mean: -0.04092986881732941, mean p set: 0.4483581483364105
loss_pred:0.013796660117805004, decouple_loss:0.0012060292065143585
The modified gen p mean: 0.44632357358932495, gen p mean: -0.040416084229946136, mean p set: 0.44680383801460266The modified gen p mean: 0.4474528431892395, gen p mean: -0.04463586583733559, mean p set: 0.4479331374168396
loss_pred:0.014339213259518147, decouple_loss:0.0012562128249555826
loss_pred:0.014258166775107384, decouple_loss:0.001321969786658883
Iteration: 1937, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477178752422333, gen p mean: -0.04647112637758255, mean p set: 0.4481981694698334
loss_pred:0.014679452404379845, decouple_loss:0.0013817941071465611
The modified gen p mean: 0.44691750407218933, gen p mean: -0.04288676753640175, mean p set: 0.44739776849746704The modified gen p mean: 0.4470152258872986, gen p mean: -0.0429634228348732, mean p set: 0.4474954903125763
loss_pred:0.014355210587382317, decouple_loss:0.001257408643141389
loss_pred:0.014560640789568424, decouple_loss:0.0011862259125337005
Iteration: 1938, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44723257422447205, gen p mean: -0.04378046840429306, mean p set: 0.44771286845207214
loss_pred:0.013946219347417355, decouple_loss:0.0013204083079472184
The modified gen p mean: 0.44696521759033203, gen p mean: -0.04068377986550331, mean p set: 0.44744551181793213The modified gen p mean: 0.4462986886501312, gen p mean: -0.042388636618852615, mean p set: 0.4467789828777313
loss_pred:0.014082306995987892, decouple_loss:0.0012505317572504282
loss_pred:0.014249246567487717, decouple_loss:0.00136155157815665
Iteration: 1939, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.445803701877594, gen p mean: -0.0453076995909214, mean p set: 0.4462839961051941
loss_pred:0.014285121113061905, decouple_loss:0.0014309585094451904
The modified gen p mean: 0.4455787241458893, gen p mean: -0.04325893893837929, mean p set: 0.4460590183734894The modified gen p mean: 0.44646063446998596, gen p mean: -0.04117682948708534, mean p set: 0.44694095849990845
loss_pred:0.014005378820002079, decouple_loss:0.0012093301629647613
loss_pred:0.01504111010581255, decouple_loss:0.001395947067067027
Iteration: 1940, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4455007314682007, gen p mean: -0.05125150457024574, mean p set: 0.44598105549812317
loss_pred:0.01391481515020132, decouple_loss:0.0012758157681673765
The modified gen p mean: 0.4485968351364136, gen p mean: -0.04499651864171028, mean p set: 0.44907715916633606The modified gen p mean: 0.4462679922580719, gen p mean: -0.04567326232790947, mean p set: 0.446748286485672
loss_pred:0.014201273210346699, decouple_loss:0.0012431395007297397
loss_pred:0.01398517843335867, decouple_loss:0.0012188215041533113
2023-05-02 09:57:05 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.04883941635489464, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04392454773187637, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.04432179033756256, mean p set: 0.4500633478164673
loss_pred:0.01889042556285858, decouple_loss:0.0012685436522588134
loss_pred:0.017790663987398148, decouple_loss:0.0013068907428532839loss_pred:0.01785089448094368, decouple_loss:0.0012366195442155004
WV_0_PC_1_EH_0_PS_40, loss: 0.01824086159467697, avg_mse: 0.02639586664736271
current test mse: 0.026396
Iteration: 1941, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44661030173301697, gen p mean: -0.047240033745765686, mean p set: 0.4470905363559723
The modified gen p mean: 0.4478340148925781, gen p mean: -0.044307079166173935, mean p set: 0.44831427931785583
The modified gen p mean: 0.44754672050476074, gen p mean: -0.049085456877946854, mean p set: 0.44802701473236084
loss_pred:0.013048162683844566, decouple_loss:0.0012038089334964752
loss_pred:0.013645648956298828, decouple_loss:0.0012076779967173934
loss_pred:0.014159075915813446, decouple_loss:0.0011074086651206017
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012017_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012017_3_24hr.npz
NaN value num: 0
Iteration: 1942, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45030316710472107, gen p mean: -0.038046542555093765, mean p set: 0.4507834315299988
loss_pred:0.0172762181609869, decouple_loss:0.00138431740924716
The modified gen p mean: 0.4500156044960022, gen p mean: -0.04572248458862305, mean p set: 0.4504959285259247The modified gen p mean: 0.4516895115375519, gen p mean: -0.0428919680416584, mean p set: 0.4521697759628296
loss_pred:0.018336674198508263, decouple_loss:0.0012677746126428246
loss_pred:0.017361117526888847, decouple_loss:0.0014816084876656532
Iteration: 1943, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4528787434101105, gen p mean: -0.04124770686030388, mean p set: 0.45335903763771057
loss_pred:0.017463717609643936, decouple_loss:0.001257516909390688
The modified gen p mean: 0.45240646600723267, gen p mean: -0.042215246707201004, mean p set: 0.45288676023483276The modified gen p mean: 0.4518701732158661, gen p mean: -0.04266614839434624, mean p set: 0.4523504674434662
loss_pred:0.01785840094089508, decouple_loss:0.001374151324853301
loss_pred:0.018394799903035164, decouple_loss:0.0012527426006272435
Iteration: 1944, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45021703839302063, gen p mean: -0.045092470943927765, mean p set: 0.4506973326206207
loss_pred:0.017126668244600296, decouple_loss:0.001356167602352798
The modified gen p mean: 0.45169976353645325, gen p mean: -0.0412861667573452, mean p set: 0.45218008756637573The modified gen p mean: 0.4493335485458374, gen p mean: -0.045616619288921356, mean p set: 0.4498138427734375
loss_pred:0.017837483435869217, decouple_loss:0.0013785160845145583
loss_pred:0.017028268426656723, decouple_loss:0.0014515160582959652
Iteration: 1945, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488823413848877, gen p mean: -0.04434464871883392, mean p set: 0.4493626356124878
loss_pred:0.01717374473810196, decouple_loss:0.001386071089655161
The modified gen p mean: 0.44973355531692505, gen p mean: -0.042955175042152405, mean p set: 0.45021387934684753The modified gen p mean: 0.449844092130661, gen p mean: -0.04433497413992882, mean p set: 0.4503243863582611
loss_pred:0.017178261652588844, decouple_loss:0.0012647908879444003
loss_pred:0.017542799934744835, decouple_loss:0.0012903298484161496
Iteration: 1946, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4522644281387329, gen p mean: -0.036988891661167145, mean p set: 0.452744722366333
loss_pred:0.017021557316184044, decouple_loss:0.0013362704776227474
The modified gen p mean: 0.44988295435905457, gen p mean: -0.03674742579460144, mean p set: 0.45036324858665466The modified gen p mean: 0.44944971799850464, gen p mean: -0.04272880777716637, mean p set: 0.44993001222610474
loss_pred:0.016861872747540474, decouple_loss:0.001296338508836925
loss_pred:0.016968119889497757, decouple_loss:0.0011939819669350982
Iteration: 1947, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44941064715385437, gen p mean: -0.04092523455619812, mean p set: 0.44989094138145447
loss_pred:0.01694665476679802, decouple_loss:0.0012754834024235606
The modified gen p mean: 0.4499061107635498, gen p mean: -0.04411008954048157, mean p set: 0.4503864049911499The modified gen p mean: 0.44949042797088623, gen p mean: -0.044298797845840454, mean p set: 0.44997072219848633
loss_pred:0.01871112920343876, decouple_loss:0.0012681145453825593
loss_pred:0.01794884353876114, decouple_loss:0.001395710278302431
Iteration: 1948, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489936828613281, gen p mean: -0.044083431363105774, mean p set: 0.4494739770889282
loss_pred:0.017690535634756088, decouple_loss:0.001171553391031921
The modified gen p mean: 0.4491058588027954, gen p mean: -0.041352879256010056, mean p set: 0.4495861530303955The modified gen p mean: 0.4522947669029236, gen p mean: -0.035691969096660614, mean p set: 0.4527750313282013
loss_pred:0.01809077337384224, decouple_loss:0.0011758350301533937
loss_pred:0.017209231853485107, decouple_loss:0.0011346034007146955
Iteration: 1949, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499351978302002, gen p mean: -0.04183243215084076, mean p set: 0.4504155218601227
loss_pred:0.019082171842455864, decouple_loss:0.0011088959872722626
The modified gen p mean: 0.4494694173336029, gen p mean: -0.039881158620119095, mean p set: 0.449949711561203The modified gen p mean: 0.4502570331096649, gen p mean: -0.04151677340269089, mean p set: 0.450737327337265
loss_pred:0.017852015793323517, decouple_loss:0.0011571146314963698
loss_pred:0.0168038010597229, decouple_loss:0.0011463752016425133
Iteration: 1950, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4520352780818939, gen p mean: -0.033374883234500885, mean p set: 0.452515572309494
loss_pred:0.017660964280366898, decouple_loss:0.001232635579071939
The modified gen p mean: 0.45171207189559937, gen p mean: -0.036506954580545425, mean p set: 0.4521923363208771The modified gen p mean: 0.4487507939338684, gen p mean: -0.0390179343521595, mean p set: 0.4492310881614685
loss_pred:0.017537379637360573, decouple_loss:0.0013203640701249242
loss_pred:0.017436150461435318, decouple_loss:0.0011745474766939878
2023-05-02 09:59:31 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.04309844225645065, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.038296397775411606, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.038456957787275314, mean p set: 0.4500633478164673
loss_pred:0.018414022400975227, decouple_loss:0.001167887356132269
loss_pred:0.01732845976948738, decouple_loss:0.0011176700936630368
loss_pred:0.017396317794919014, decouple_loss:0.001130066579207778
WV_0_PC_1_EH_0_PS_40, loss: 0.017769861966371536, avg_mse: 0.025488296523690224
current test mse: 0.025488
Iteration: 1951, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4519834518432617, gen p mean: -0.03114955686032772, mean p set: 0.4524637460708618
The modified gen p mean: 0.451952189207077, gen p mean: -0.03417278081178665, mean p set: 0.4524324834346771
The modified gen p mean: 0.4517619013786316, gen p mean: -0.03379719331860542, mean p set: 0.4522422254085541
loss_pred:0.017041899263858795, decouple_loss:0.0010475710732862353
loss_pred:0.01794394478201866, decouple_loss:0.0010600631358101964
loss_pred:0.017123566940426826, decouple_loss:0.0011127726174890995
Iteration: 1952, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45147889852523804, gen p mean: -0.03467535972595215, mean p set: 0.45195919275283813
loss_pred:0.017632022500038147, decouple_loss:0.0010617077350616455
The modified gen p mean: 0.4494214653968811, gen p mean: -0.039102666079998016, mean p set: 0.4499017596244812The modified gen p mean: 0.44881120324134827, gen p mean: -0.037009574472904205, mean p set: 0.44929152727127075
loss_pred:0.01793837547302246, decouple_loss:0.0010736361145973206
loss_pred:0.017196914181113243, decouple_loss:0.0011821069056168199
Iteration: 1953, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4520312249660492, gen p mean: -0.03437354788184166, mean p set: 0.4525114893913269
loss_pred:0.017384454607963562, decouple_loss:0.0012125825742259622
The modified gen p mean: 0.4523078501224518, gen p mean: -0.034295614808797836, mean p set: 0.4527881443500519The modified gen p mean: 0.45204421877861023, gen p mean: -0.03362971916794777, mean p set: 0.4525245130062103
loss_pred:0.017018316313624382, decouple_loss:0.0011049703462049365
loss_pred:0.01763705350458622, decouple_loss:0.001155711943283677
Iteration: 1954, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4519214630126953, gen p mean: -0.030827704817056656, mean p set: 0.4524017870426178
loss_pred:0.016677016392350197, decouple_loss:0.0011863221880048513
The modified gen p mean: 0.45026251673698425, gen p mean: -0.041325051337480545, mean p set: 0.45074281096458435The modified gen p mean: 0.45170989632606506, gen p mean: -0.039004288613796234, mean p set: 0.45219019055366516
loss_pred:0.017326420173048973, decouple_loss:0.0011320484336465597
loss_pred:0.018002429977059364, decouple_loss:0.0011264801723882556
Iteration: 1955, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486709535121918, gen p mean: -0.04130752012133598, mean p set: 0.44915124773979187
loss_pred:0.016708368435502052, decouple_loss:0.001091856975108385
The modified gen p mean: 0.4492368698120117, gen p mean: -0.03936634957790375, mean p set: 0.4497171640396118The modified gen p mean: 0.4522203207015991, gen p mean: -0.03582180291414261, mean p set: 0.45270055532455444
loss_pred:0.016486916691064835, decouple_loss:0.0011173777747899294
loss_pred:0.017142489552497864, decouple_loss:0.0010446601081639528
Iteration: 1956, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45227012038230896, gen p mean: -0.03501802310347557, mean p set: 0.45275044441223145
loss_pred:0.01724369451403618, decouple_loss:0.001072643673978746
The modified gen p mean: 0.4502771496772766, gen p mean: -0.043409038335084915, mean p set: 0.4507574439048767The modified gen p mean: 0.45142990350723267, gen p mean: -0.034983936697244644, mean p set: 0.45191019773483276
loss_pred:0.017296219244599342, decouple_loss:0.001090005156584084
loss_pred:0.01832554303109646, decouple_loss:0.001162642496638
Iteration: 1957, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4516439735889435, gen p mean: -0.03619600459933281, mean p set: 0.4521242678165436
loss_pred:0.018070276826620102, decouple_loss:0.0010329848155379295
The modified gen p mean: 0.450868159532547, gen p mean: -0.03832218796014786, mean p set: 0.4513484537601471The modified gen p mean: 0.45140278339385986, gen p mean: -0.03582512587308884, mean p set: 0.45188307762145996
loss_pred:0.01782665215432644, decouple_loss:0.0010611653560772538
loss_pred:0.016959942877292633, decouple_loss:0.0009693833417259157
Iteration: 1958, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4521124064922333, gen p mean: -0.04302519932389259, mean p set: 0.4525927007198334
loss_pred:0.016814474016427994, decouple_loss:0.0010978940408676863
The modified gen p mean: 0.45233818888664246, gen p mean: -0.039667967706918716, mean p set: 0.45281848311424255The modified gen p mean: 0.4501321017742157, gen p mean: -0.04559291899204254, mean p set: 0.4506123960018158
loss_pred:0.01695604994893074, decouple_loss:0.001250340254046023
loss_pred:0.01687198132276535, decouple_loss:0.001094516832381487
Iteration: 1959, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514210820198059, gen p mean: -0.04373608157038689, mean p set: 0.4519013464450836
loss_pred:0.01734851859509945, decouple_loss:0.0010738661512732506
The modified gen p mean: 0.4498606324195862, gen p mean: -0.046179842203855515, mean p set: 0.45034095644950867The modified gen p mean: 0.45123687386512756, gen p mean: -0.038349345326423645, mean p set: 0.45171716809272766
loss_pred:0.017748501151800156, decouple_loss:0.0011110844789072871
loss_pred:0.017927125096321106, decouple_loss:0.0010708199115470052
Iteration: 1960, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498410224914551, gen p mean: -0.041611447930336, mean p set: 0.4503213167190552
loss_pred:0.016444342210888863, decouple_loss:0.0010850033722817898
The modified gen p mean: 0.4504345655441284, gen p mean: -0.040248263627290726, mean p set: 0.4509148597717285The modified gen p mean: 0.45226559042930603, gen p mean: -0.03706246614456177, mean p set: 0.45274588465690613
loss_pred:0.01674962230026722, decouple_loss:0.0010115260956808925
loss_pred:0.01654333621263504, decouple_loss:0.0010984943946823478
2023-05-02 10:01:25 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.050954826176166534, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.045993972569704056, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.04670769348740578, mean p set: 0.4500633478164673
loss_pred:0.01831774041056633, decouple_loss:0.0011656841961666942
loss_pred:0.01728016883134842, decouple_loss:0.0010738975834101439
loss_pred:0.017313113436102867, decouple_loss:0.0011211343808099627
WV_0_PC_1_EH_0_PS_40, loss: 0.017693020403385162, avg_mse: 0.025359606370329857
current test mse: 0.02536
Iteration: 1961, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499744772911072, gen p mean: -0.0488642118871212, mean p set: 0.4504547715187073
The modified gen p mean: 0.4497663080692291, gen p mean: -0.04550059139728546, mean p set: 0.4502466022968292
The modified gen p mean: 0.4489927887916565, gen p mean: -0.04448612406849861, mean p set: 0.4494730830192566
loss_pred:0.017584312707185745, decouple_loss:0.001081836293451488
loss_pred:0.01856514811515808, decouple_loss:0.0010780657175928354loss_pred:0.017688024789094925, decouple_loss:0.0010390769457444549
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012003_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012003_3_24hr.npz
NaN value num: 0
Iteration: 1962, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44794660806655884, gen p mean: -0.04569131135940552, mean p set: 0.44842690229415894
loss_pred:0.015985213220119476, decouple_loss:0.0011047078296542168
The modified gen p mean: 0.4490705132484436, gen p mean: -0.05003048852086067, mean p set: 0.4495508372783661The modified gen p mean: 0.44782301783561707, gen p mean: -0.0478379912674427, mean p set: 0.44830331206321716
loss_pred:0.01738586649298668, decouple_loss:0.0010626426665112376
loss_pred:0.016754159703850746, decouple_loss:0.0011814183089882135
Iteration: 1963, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44767633080482483, gen p mean: -0.045255791395902634, mean p set: 0.44815659523010254
loss_pred:0.01753850094974041, decouple_loss:0.001138467574492097
The modified gen p mean: 0.4483935832977295, gen p mean: -0.045782219618558884, mean p set: 0.4488738775253296The modified gen p mean: 0.44786274433135986, gen p mean: -0.04924570769071579, mean p set: 0.44834303855895996
loss_pred:0.01627236045897007, decouple_loss:0.0011185514740645885
loss_pred:0.01625547744333744, decouple_loss:0.0011623098980635405
Iteration: 1964, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44754353165626526, gen p mean: -0.04903555288910866, mean p set: 0.44802385568618774
loss_pred:0.01718568615615368, decouple_loss:0.0010239933617413044
The modified gen p mean: 0.44791704416275024, gen p mean: -0.04359818249940872, mean p set: 0.44839733839035034The modified gen p mean: 0.4486355185508728, gen p mean: -0.05192061513662338, mean p set: 0.4491157829761505
loss_pred:0.016749737784266472, decouple_loss:0.0010602549882605672
loss_pred:0.016143688932061195, decouple_loss:0.0011024142149835825
Iteration: 1965, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486146569252014, gen p mean: -0.05141659826040268, mean p set: 0.4490949809551239
loss_pred:0.016216116026043892, decouple_loss:0.0009750263998284936
The modified gen p mean: 0.44992712140083313, gen p mean: -0.05097129940986633, mean p set: 0.4504074156284332The modified gen p mean: 0.44775399565696716, gen p mean: -0.04636232927441597, mean p set: 0.4482342600822449
loss_pred:0.01647942326962948, decouple_loss:0.001107613556087017
loss_pred:0.016666067764163017, decouple_loss:0.0009699480724520981
Iteration: 1966, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44711536169052124, gen p mean: -0.04902496933937073, mean p set: 0.44759565591812134
loss_pred:0.016795380041003227, decouple_loss:0.0010462121572345495
The modified gen p mean: 0.44861719012260437, gen p mean: -0.049001697450876236, mean p set: 0.44909751415252686The modified gen p mean: 0.44802042841911316, gen p mean: -0.052117474377155304, mean p set: 0.44850072264671326
loss_pred:0.017004821449518204, decouple_loss:0.0010805835481733084
loss_pred:0.017276408150792122, decouple_loss:0.001044340431690216
Iteration: 1967, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480273425579071, gen p mean: -0.050065409392118454, mean p set: 0.4485076069831848
loss_pred:0.01732795685529709, decouple_loss:0.0009791988413780928
The modified gen p mean: 0.4487381875514984, gen p mean: -0.05188586562871933, mean p set: 0.4492185115814209The modified gen p mean: 0.4477604329586029, gen p mean: -0.0491674430668354, mean p set: 0.448240727186203
loss_pred:0.01643897220492363, decouple_loss:0.0011644167825579643
loss_pred:0.016412755474448204, decouple_loss:0.0010919402120634913
Iteration: 1968, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481610059738159, gen p mean: -0.0543551929295063, mean p set: 0.448641300201416
loss_pred:0.015979083254933357, decouple_loss:0.001148476731032133
The modified gen p mean: 0.4480516016483307, gen p mean: -0.049368031322956085, mean p set: 0.4485318660736084The modified gen p mean: 0.4501098394393921, gen p mean: -0.05481826141476631, mean p set: 0.4505901634693146
loss_pred:0.015983212739229202, decouple_loss:0.0011693481355905533
loss_pred:0.01645447313785553, decouple_loss:0.0010520669165998697
Iteration: 1969, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44791170954704285, gen p mean: -0.051553983241319656, mean p set: 0.44839203357696533
loss_pred:0.016614150255918503, decouple_loss:0.0009966593934223056
The modified gen p mean: 0.4476093649864197, gen p mean: -0.05128854140639305, mean p set: 0.4480896592140198The modified gen p mean: 0.44783344864845276, gen p mean: -0.0509030818939209, mean p set: 0.44831374287605286
loss_pred:0.016443990170955658, decouple_loss:0.0010428201640024781
loss_pred:0.016801493242383003, decouple_loss:0.0010130512528121471
Iteration: 1970, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483061730861664, gen p mean: -0.05293954163789749, mean p set: 0.4487864673137665
loss_pred:0.01649611070752144, decouple_loss:0.0010094826575368643
The modified gen p mean: 0.4488072693347931, gen p mean: -0.05637548118829727, mean p set: 0.4492875933647156The modified gen p mean: 0.44779732823371887, gen p mean: -0.051345109939575195, mean p set: 0.4482775628566742
loss_pred:0.016283662989735603, decouple_loss:0.0010618343949317932
loss_pred:0.016907762736082077, decouple_loss:0.0010173125192523003
2023-05-02 10:04:06 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.05526231974363327, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.05023197829723358, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.0509595163166523, mean p set: 0.4500633478164673
loss_pred:0.018316900357604027, decouple_loss:0.0010740031721070409
loss_pred:0.017255496233701706, decouple_loss:0.0010580269154161215
loss_pred:0.017293062061071396, decouple_loss:0.0010175055358558893
WV_0_PC_1_EH_0_PS_40, loss: 0.017674311995506287, avg_mse: 0.025328408926725388
current test mse: 0.025328
Iteration: 1971, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481784403324127, gen p mean: -0.05098577216267586, mean p set: 0.4486587643623352
The modified gen p mean: 0.44783735275268555, gen p mean: -0.05257946625351906, mean p set: 0.44831764698028564
The modified gen p mean: 0.4485088884830475, gen p mean: -0.05129779875278473, mean p set: 0.4489891827106476
loss_pred:0.017109153792262077, decouple_loss:0.0010005375370383263
loss_pred:0.016504723578691483, decouple_loss:0.0010014859726652503
loss_pred:0.016303569078445435, decouple_loss:0.000986043713055551
Iteration: 1972, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44803908467292786, gen p mean: -0.048581406474113464, mean p set: 0.44851937890052795
loss_pred:0.01715157926082611, decouple_loss:0.0009186434908770025
The modified gen p mean: 0.4482074975967407, gen p mean: -0.05048888549208641, mean p set: 0.4486878216266632The modified gen p mean: 0.44949501752853394, gen p mean: -0.05823845416307449, mean p set: 0.4499753415584564
loss_pred:0.016045108437538147, decouple_loss:0.00098410586360842
loss_pred:0.01655176281929016, decouple_loss:0.0009385328157804906
Iteration: 1973, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44844934344291687, gen p mean: -0.05549962446093559, mean p set: 0.44892963767051697
loss_pred:0.017018869519233704, decouple_loss:0.0010766573250293732
The modified gen p mean: 0.4467676877975464, gen p mean: -0.0513041727244854, mean p set: 0.4472479820251465The modified gen p mean: 0.4494318962097168, gen p mean: -0.05393845960497856, mean p set: 0.4499121904373169
loss_pred:0.016294457018375397, decouple_loss:0.0010572955943644047
loss_pred:0.017015282064676285, decouple_loss:0.0010313352104276419
Iteration: 1974, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44961830973625183, gen p mean: -0.05416205897927284, mean p set: 0.4500986337661743
loss_pred:0.01627308316528797, decouple_loss:0.0011252445401623845
The modified gen p mean: 0.4497392177581787, gen p mean: -0.058836519718170166, mean p set: 0.4502195119857788The modified gen p mean: 0.4493980407714844, gen p mean: -0.050970058888196945, mean p set: 0.4498783349990845
loss_pred:0.015655437484383583, decouple_loss:0.0011809838470071554
loss_pred:0.016061143949627876, decouple_loss:0.0011296267621219158
Iteration: 1975, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44883784651756287, gen p mean: -0.056316960602998734, mean p set: 0.44931817054748535
loss_pred:0.016857363283634186, decouple_loss:0.0010932058794423938
The modified gen p mean: 0.44936156272888184, gen p mean: -0.05900544673204422, mean p set: 0.44984182715415955The modified gen p mean: 0.44859200716018677, gen p mean: -0.052995823323726654, mean p set: 0.4490722715854645
loss_pred:0.016380971297621727, decouple_loss:0.0009700944647192955
loss_pred:0.016767779365181923, decouple_loss:0.0010031574638560414
Iteration: 1976, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44731348752975464, gen p mean: -0.05404781550168991, mean p set: 0.44779375195503235
loss_pred:0.01698272116482258, decouple_loss:0.0010388607624918222
The modified gen p mean: 0.44792941212654114, gen p mean: -0.054348599165678024, mean p set: 0.44840967655181885The modified gen p mean: 0.4478890895843506, gen p mean: -0.052760787308216095, mean p set: 0.4483693838119507
loss_pred:0.016161395236849785, decouple_loss:0.0010995531920343637
loss_pred:0.016699813306331635, decouple_loss:0.001042849151417613
Iteration: 1977, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480580687522888, gen p mean: -0.05283389985561371, mean p set: 0.4485383629798889
loss_pred:0.01617777720093727, decouple_loss:0.0009946399368345737
The modified gen p mean: 0.44758614897727966, gen p mean: -0.05451909825205803, mean p set: 0.44806647300720215The modified gen p mean: 0.4495101273059845, gen p mean: -0.058450642973184586, mean p set: 0.4499904215335846
loss_pred:0.015693683177232742, decouple_loss:0.0009949072264134884
loss_pred:0.01594226248562336, decouple_loss:0.0010285144671797752
Iteration: 1978, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483537971973419, gen p mean: -0.060815971344709396, mean p set: 0.44883406162261963
loss_pred:0.01663975603878498, decouple_loss:0.0009475505212321877
The modified gen p mean: 0.4483758807182312, gen p mean: -0.05541097745299339, mean p set: 0.4488562047481537The modified gen p mean: 0.44805678725242615, gen p mean: -0.05375789478421211, mean p set: 0.44853708148002625
loss_pred:0.017009783536195755, decouple_loss:0.0011302751954644918
loss_pred:0.016962507739663124, decouple_loss:0.0010113567113876343
Iteration: 1979, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448249876499176, gen p mean: -0.057881880551576614, mean p set: 0.4487301707267761
loss_pred:0.016940541565418243, decouple_loss:0.0009790435433387756
The modified gen p mean: 0.44802820682525635, gen p mean: -0.0523863323032856, mean p set: 0.44850850105285645
The modified gen p mean: 0.447353333234787, gen p mean: -0.05105078965425491, mean p set: 0.4478336274623871
loss_pred:0.01702907495200634, decouple_loss:0.0010117870988324285
loss_pred:0.017525572329759598, decouple_loss:0.000980243319645524
Iteration: 1980, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44823142886161804, gen p mean: -0.050729576498270035, mean p set: 0.44871172308921814
loss_pred:0.017367452383041382, decouple_loss:0.0009795301593840122
The modified gen p mean: 0.449266254901886, gen p mean: -0.05658399686217308, mean p set: 0.44974657893180847The modified gen p mean: 0.449124813079834, gen p mean: -0.05664367601275444, mean p set: 0.4496051073074341
loss_pred:0.01653984561562538, decouple_loss:0.001256315503269434
loss_pred:0.01609346829354763, decouple_loss:0.001245234627276659
2023-05-02 10:06:00 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.053801439702510834, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04904261231422424, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830237865448, gen p mean: -0.04976232349872589, mean p set: 0.4500633478164673
loss_pred:0.018415899947285652, decouple_loss:0.0010736591648310423
loss_pred:0.017376653850078583, decouple_loss:0.0011309931287541986
loss_pred:0.017423877492547035, decouple_loss:0.0010803861077874899
WV_0_PC_1_EH_0_PS_40, loss: 0.01779356226325035, avg_mse: 0.02557424269616604
current test mse: 0.025574
Iteration: 1981, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44801104068756104, gen p mean: -0.05287910997867584, mean p set: 0.44849133491516113
The modified gen p mean: 0.44820448756217957, gen p mean: -0.05134310945868492, mean p set: 0.44868478178977966
The modified gen p mean: 0.4468841552734375, gen p mean: -0.04900377243757248, mean p set: 0.44736447930336
loss_pred:0.01680941879749298, decouple_loss:0.0010515957837924361
loss_pred:0.01640871912240982, decouple_loss:0.0009326286381110549
loss_pred:0.01693587750196457, decouple_loss:0.0010004137875512242
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012005_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012005_3_24hr.npz
NaN value num: 0
Iteration: 1982, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493323266506195, gen p mean: -0.05164661258459091, mean p set: 0.4498126208782196
loss_pred:0.014712059870362282, decouple_loss:0.001243981416337192
The modified gen p mean: 0.4501170217990875, gen p mean: -0.049926288425922394, mean p set: 0.4505973160266876The modified gen p mean: 0.44795697927474976, gen p mean: -0.05403481423854828, mean p set: 0.44843724370002747
loss_pred:0.014325962401926517, decouple_loss:0.0011758282780647278
loss_pred:0.014665525406599045, decouple_loss:0.001206959248520434
Iteration: 1983, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44836828112602234, gen p mean: -0.05346192046999931, mean p set: 0.44884857535362244
loss_pred:0.014494635164737701, decouple_loss:0.0010373799595981836
The modified gen p mean: 0.4484518766403198, gen p mean: -0.045605190098285675, mean p set: 0.4489321708679199The modified gen p mean: 0.4472036063671112, gen p mean: -0.05024613440036774, mean p set: 0.4476839303970337
loss_pred:0.014102750457823277, decouple_loss:0.0010601909598335624
loss_pred:0.014420735649764538, decouple_loss:0.0010261997813358903
Iteration: 1984, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45044636726379395, gen p mean: -0.04422656446695328, mean p set: 0.45092666149139404
loss_pred:0.014373399317264557, decouple_loss:0.001058950088918209
The modified gen p mean: 0.4505947232246399, gen p mean: -0.04895661398768425, mean p set: 0.4510750472545624The modified gen p mean: 0.44875338673591614, gen p mean: -0.043199192732572556, mean p set: 0.4492337107658386
loss_pred:0.014188156463205814, decouple_loss:0.0010884463554248214
loss_pred:0.014019199647009373, decouple_loss:0.0011230470845475793
Iteration: 1985, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44891074299812317, gen p mean: -0.0460461862385273, mean p set: 0.44939103722572327
loss_pred:0.014320933260023594, decouple_loss:0.001073456951417029
The modified gen p mean: 0.4475288987159729, gen p mean: -0.042930588126182556, mean p set: 0.448009192943573The modified gen p mean: 0.4502430558204651, gen p mean: -0.0402107797563076, mean p set: 0.4507233798503876
loss_pred:0.014086712151765823, decouple_loss:0.001087661599740386
loss_pred:0.014385928399860859, decouple_loss:0.001032296335324645
Iteration: 1986, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507712423801422, gen p mean: -0.040588248521089554, mean p set: 0.4512515664100647
loss_pred:0.014232166111469269, decouple_loss:0.001226393855176866
The modified gen p mean: 0.4475174844264984, gen p mean: -0.042614538222551346, mean p set: 0.4479977786540985
The modified gen p mean: 0.4483104348182678, gen p mean: -0.0429500974714756, mean p set: 0.4487907588481903
loss_pred:0.013912035152316093, decouple_loss:0.001106718205846846
loss_pred:0.014410601928830147, decouple_loss:0.0010519534116610885
Iteration: 1987, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45020556449890137, gen p mean: -0.04320620745420456, mean p set: 0.4506858289241791
loss_pred:0.013980671763420105, decouple_loss:0.0011149811325594783
The modified gen p mean: 0.4494454860687256, gen p mean: -0.04622108116745949, mean p set: 0.4499257802963257The modified gen p mean: 0.4494202733039856, gen p mean: -0.04157523810863495, mean p set: 0.4499005675315857
loss_pred:0.014311585575342178, decouple_loss:0.0010619084350764751
loss_pred:0.013851015828549862, decouple_loss:0.0010644678259268403
Iteration: 1988, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44892197847366333, gen p mean: -0.04475531354546547, mean p set: 0.4494022727012634
loss_pred:0.014777450822293758, decouple_loss:0.0011812379816547036
The modified gen p mean: 0.4498547315597534, gen p mean: -0.041113972663879395, mean p set: 0.4503350555896759The modified gen p mean: 0.4490760564804077, gen p mean: -0.049267157912254333, mean p set: 0.4495563805103302
loss_pred:0.013977371156215668, decouple_loss:0.0011559163685888052
loss_pred:0.014250868000090122, decouple_loss:0.0011973315849900246
Iteration: 1989, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502853751182556, gen p mean: -0.04224066063761711, mean p set: 0.4507656991481781
loss_pred:0.01372559368610382, decouple_loss:0.0011512837372720242
The modified gen p mean: 0.45016369223594666, gen p mean: -0.042447857558727264, mean p set: 0.45064398646354675The modified gen p mean: 0.4490041136741638, gen p mean: -0.0517270490527153, mean p set: 0.4494844079017639
loss_pred:0.013302074745297432, decouple_loss:0.0011062446283176541
loss_pred:0.014263569377362728, decouple_loss:0.0011589631903916597
Iteration: 1990, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496975243091583, gen p mean: -0.04542312026023865, mean p set: 0.4501778185367584
loss_pred:0.013829897157847881, decouple_loss:0.0012976998696103692
The modified gen p mean: 0.449152410030365, gen p mean: -0.05251416936516762, mean p set: 0.4496326744556427The modified gen p mean: 0.44841185212135315, gen p mean: -0.04575229063630104, mean p set: 0.44889214634895325
loss_pred:0.014224031008780003, decouple_loss:0.0011071759508922696
loss_pred:0.013908849097788334, decouple_loss:0.0011763162910938263
2023-05-02 10:08:30 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.0543379932641983, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04942840710282326, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.049987852573394775, mean p set: 0.4500633478164673
loss_pred:0.0190869327634573, decouple_loss:0.0012684352695941925
loss_pred:0.018049029633402824, decouple_loss:0.0012350052129477262
loss_pred:0.01809450052678585, decouple_loss:0.0012036878615617752
WV_0_PC_1_EH_0_PS_40, loss: 0.018471941351890564, avg_mse: 0.026882609352469444
current test mse: 0.026883
Iteration: 1991, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45058080554008484, gen p mean: -0.04712119325995445, mean p set: 0.45106109976768494
The modified gen p mean: 0.4489338994026184, gen p mean: -0.05083644017577171, mean p set: 0.4494141638278961
The modified gen p mean: 0.4499286413192749, gen p mean: -0.04941462352871895, mean p set: 0.450408935546875
loss_pred:0.013502033427357674, decouple_loss:0.0012323255650699139
loss_pred:0.013563171960413456, decouple_loss:0.0011887898435816169
loss_pred:0.014630635268986225, decouple_loss:0.001144726062193513
Iteration: 1992, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472403824329376, gen p mean: -0.053208593279123306, mean p set: 0.4477207064628601
loss_pred:0.013589104637503624, decouple_loss:0.001226563355885446
The modified gen p mean: 0.4496532380580902, gen p mean: -0.05061148852109909, mean p set: 0.4501335322856903The modified gen p mean: 0.4505392014980316, gen p mean: -0.048265308141708374, mean p set: 0.4510194957256317
loss_pred:0.013584239408373833, decouple_loss:0.0012056983541697264
loss_pred:0.01353529654443264, decouple_loss:0.0011211867677047849
Iteration: 1993, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447736918926239, gen p mean: -0.051214199513196945, mean p set: 0.4482172131538391
loss_pred:0.013897868804633617, decouple_loss:0.0011727181263267994
The modified gen p mean: 0.44969743490219116, gen p mean: -0.05288068205118179, mean p set: 0.45017769932746887The modified gen p mean: 0.4502201974391937, gen p mean: -0.05245286598801613, mean p set: 0.4507005214691162
loss_pred:0.013608576729893684, decouple_loss:0.0011642759200185537
loss_pred:0.013431183993816376, decouple_loss:0.001223505474627018
Iteration: 1994, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478796720504761, gen p mean: -0.04936477914452553, mean p set: 0.44835996627807617
loss_pred:0.014153909869492054, decouple_loss:0.0012893086532130837
The modified gen p mean: 0.4490104019641876, gen p mean: -0.04730191081762314, mean p set: 0.44949066638946533The modified gen p mean: 0.44931894540786743, gen p mean: -0.05130308121442795, mean p set: 0.4497992694377899
loss_pred:0.014215723611414433, decouple_loss:0.0011615522671490908
loss_pred:0.013452516868710518, decouple_loss:0.0012060815934091806
Iteration: 1995, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44825124740600586, gen p mean: -0.04962647706270218, mean p set: 0.44873154163360596
loss_pred:0.013554675504565239, decouple_loss:0.0013105421094223857
The modified gen p mean: 0.4494057595729828, gen p mean: -0.05237101763486862, mean p set: 0.4498860538005829The modified gen p mean: 0.44905534386634827, gen p mean: -0.04332784190773964, mean p set: 0.44953563809394836
loss_pred:0.014030362479388714, decouple_loss:0.0012775046052411199
loss_pred:0.013708464801311493, decouple_loss:0.001209707697853446
Iteration: 1996, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503425657749176, gen p mean: -0.04367470741271973, mean p set: 0.4508228898048401
loss_pred:0.01335962861776352, decouple_loss:0.0010575293563306332
The modified gen p mean: 0.44910547137260437, gen p mean: -0.04623866453766823, mean p set: 0.44958579540252686The modified gen p mean: 0.4499109387397766, gen p mean: -0.04562218114733696, mean p set: 0.4503912329673767
loss_pred:0.013209005817770958, decouple_loss:0.0011199244763702154
loss_pred:0.01422774139791727, decouple_loss:0.0011800751090049744
Iteration: 1997, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494415819644928, gen p mean: -0.050769876688718796, mean p set: 0.4499218463897705
loss_pred:0.013752700760960579, decouple_loss:0.001225348562002182
The modified gen p mean: 0.4504186511039734, gen p mean: -0.04527057334780693, mean p set: 0.4508989155292511The modified gen p mean: 0.4504387676715851, gen p mean: -0.04283285513520241, mean p set: 0.4509190618991852
loss_pred:0.013877293094992638, decouple_loss:0.0012454623356461525
loss_pred:0.01347909215837717, decouple_loss:0.0012965691275894642
Iteration: 1998, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500133991241455, gen p mean: -0.04204852133989334, mean p set: 0.4504936933517456
loss_pred:0.013145219534635544, decouple_loss:0.0010630189208313823
The modified gen p mean: 0.44959110021591187, gen p mean: -0.04482770338654518, mean p set: 0.45007139444351196The modified gen p mean: 0.4495620131492615, gen p mean: -0.04533106088638306, mean p set: 0.4500423073768616
loss_pred:0.013774069026112556, decouple_loss:0.0011861431412398815
loss_pred:0.014056088402867317, decouple_loss:0.0013156416825950146
Iteration: 1999, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44951102137565613, gen p mean: -0.040898945182561874, mean p set: 0.4499913156032562
loss_pred:0.013404719531536102, decouple_loss:0.0012909454526379704
The modified gen p mean: 0.44941654801368713, gen p mean: -0.044034697115421295, mean p set: 0.4498968720436096The modified gen p mean: 0.45028233528137207, gen p mean: -0.043562036007642746, mean p set: 0.45076262950897217
loss_pred:0.013341252692043781, decouple_loss:0.0013357932912185788
loss_pred:0.013262185268104076, decouple_loss:0.001392174744978547
Iteration: 2000, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487708508968353, gen p mean: -0.04082002118229866, mean p set: 0.4492511451244354
loss_pred:0.014168323948979378, decouple_loss:0.0012123025953769684
The modified gen p mean: 0.44922763109207153, gen p mean: -0.041456401348114014, mean p set: 0.449707955121994The modified gen p mean: 0.449002742767334, gen p mean: -0.04529111832380295, mean p set: 0.4494830369949341
loss_pred:0.01383005827665329, decouple_loss:0.0012305998243391514
loss_pred:0.01356325764209032, decouple_loss:0.0012203938094899058
2023-05-02 10:10:24 itr: 2000
training loss: [0.01362428 0.01422894 0.01389159]
save model to /work/09012/haoli1/ls6/ERA5_PredRNN/checkpoints/WV_0_PC_1_EH_0_PS_40/model_2000.ckpt
2023-05-02 10:10:28 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.05019218847155571, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04548157379031181, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04577728360891342, mean p set: 0.4500633478164673
loss_pred:0.019117573276162148, decouple_loss:0.0012797393137589097
loss_pred:0.018039314076304436, decouple_loss:0.001314485794864595
loss_pred:0.018070077523589134, decouple_loss:0.0013195719802752137
WV_0_PC_1_EH_0_PS_40, loss: 0.018474219366908073, avg_mse: 0.02689734473824501
current test mse: 0.026897
Iteration: 2001, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500689208507538, gen p mean: -0.04270085319876671, mean p set: 0.4505492150783539
The modified gen p mean: 0.44887134432792664, gen p mean: -0.04889623448252678, mean p set: 0.4493516683578491
The modified gen p mean: 0.448622465133667, gen p mean: -0.04397212713956833, mean p set: 0.4491027593612671
loss_pred:0.01394916046410799, decouple_loss:0.0013518219348043203
loss_pred:0.013239373452961445, decouple_loss:0.0013529856223613024
loss_pred:0.01399922277778387, decouple_loss:0.0012380246771499515
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012010_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012010_3_24hr.npz
NaN value num: 0
Iteration: 2002, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44897574186325073, gen p mean: -0.0386696420609951, mean p set: 0.44945603609085083
loss_pred:0.016189226880669594, decouple_loss:0.0012857832480221987
The modified gen p mean: 0.4518813490867615, gen p mean: -0.046108126640319824, mean p set: 0.4523616135120392The modified gen p mean: 0.45179256796836853, gen p mean: -0.05002986639738083, mean p set: 0.45227286219596863
loss_pred:0.01703130267560482, decouple_loss:0.0013144217664375901
loss_pred:0.017291277647018433, decouple_loss:0.0013289727503433824
Iteration: 2003, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513089656829834, gen p mean: -0.04392426088452339, mean p set: 0.4517892897129059
loss_pred:0.016214288771152496, decouple_loss:0.0014539887197315693
The modified gen p mean: 0.4505755603313446, gen p mean: -0.05071829631924629, mean p set: 0.4510558545589447The modified gen p mean: 0.4519064426422119, gen p mean: -0.0451790913939476, mean p set: 0.452386736869812
loss_pred:0.01741105318069458, decouple_loss:0.001469808747060597
loss_pred:0.016482146456837654, decouple_loss:0.0013561616651713848
Iteration: 2004, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4525426924228668, gen p mean: -0.0432179756462574, mean p set: 0.4530230164527893
loss_pred:0.016517486423254013, decouple_loss:0.0013428672682493925
The modified gen p mean: 0.45095574855804443, gen p mean: -0.04260112717747688, mean p set: 0.45143604278564453The modified gen p mean: 0.45302069187164307, gen p mean: -0.0427694097161293, mean p set: 0.45350101590156555
loss_pred:0.01624590903520584, decouple_loss:0.001356809982098639
loss_pred:0.017077909782528877, decouple_loss:0.0013033226132392883
Iteration: 2005, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4517442584037781, gen p mean: -0.04481879621744156, mean p set: 0.4522245526313782
loss_pred:0.016031086444854736, decouple_loss:0.001339897164143622
The modified gen p mean: 0.4516013264656067, gen p mean: -0.042855799198150635, mean p set: 0.4520816504955292The modified gen p mean: 0.44999122619628906, gen p mean: -0.04245329275727272, mean p set: 0.45047152042388916
loss_pred:0.016801759600639343, decouple_loss:0.0013469872064888477
loss_pred:0.016063036397099495, decouple_loss:0.001222581835463643
Iteration: 2006, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4527859687805176, gen p mean: -0.04187760874629021, mean p set: 0.4532662332057953
loss_pred:0.016571640968322754, decouple_loss:0.0014388497220352292
The modified gen p mean: 0.45329049229621887, gen p mean: -0.0404982827603817, mean p set: 0.45377078652381897The modified gen p mean: 0.4518691301345825, gen p mean: -0.04448575899004936, mean p set: 0.452349454164505
loss_pred:0.016492659226059914, decouple_loss:0.0013814095873385668
loss_pred:0.01629170961678028, decouple_loss:0.001453840988688171
Iteration: 2007, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496695399284363, gen p mean: -0.03242851421236992, mean p set: 0.4501498341560364
loss_pred:0.016216546297073364, decouple_loss:0.0013136891648173332
The modified gen p mean: 0.4496181607246399, gen p mean: -0.0332389660179615, mean p set: 0.4500984251499176The modified gen p mean: 0.4508105218410492, gen p mean: -0.03831050172448158, mean p set: 0.4512908160686493
loss_pred:0.016108034178614616, decouple_loss:0.0013172072358429432
loss_pred:0.016296178102493286, decouple_loss:0.0014186380431056023
Iteration: 2008, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4518463611602783, gen p mean: -0.03390605375170708, mean p set: 0.4523266553878784
loss_pred:0.016913259401917458, decouple_loss:0.0013520732754841447
The modified gen p mean: 0.451960027217865, gen p mean: -0.038514506071805954, mean p set: 0.4524403214454651The modified gen p mean: 0.451686829328537, gen p mean: -0.0419137105345726, mean p set: 0.4521671235561371
loss_pred:0.016809817403554916, decouple_loss:0.0013180343667045236
loss_pred:0.016440726816654205, decouple_loss:0.0014465044951066375
Iteration: 2009, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45254799723625183, gen p mean: -0.034571923315525055, mean p set: 0.4530283212661743
loss_pred:0.016490306705236435, decouple_loss:0.0013353689573705196
The modified gen p mean: 0.4514986574649811, gen p mean: -0.03941158205270767, mean p set: 0.4519789516925812The modified gen p mean: 0.45169639587402344, gen p mean: -0.03951757773756981, mean p set: 0.45217666029930115
loss_pred:0.017326857894659042, decouple_loss:0.0013667461462318897
loss_pred:0.016652876511216164, decouple_loss:0.0015003291191533208
Iteration: 2010, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489378333091736, gen p mean: -0.027355659753084183, mean p set: 0.4494180977344513
loss_pred:0.016153747215867043, decouple_loss:0.00130890600848943
The modified gen p mean: 0.45396310091018677, gen p mean: -0.03196580708026886, mean p set: 0.4544433653354645The modified gen p mean: 0.4513707756996155, gen p mean: -0.04061804339289665, mean p set: 0.4518510699272156
loss_pred:0.01685858517885208, decouple_loss:0.001311946427449584
loss_pred:0.01713836006820202, decouple_loss:0.0013945742975920439
2023-05-02 10:12:54 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.04128020629286766, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.035785578191280365, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.036372702568769455, mean p set: 0.4500633478164673
loss_pred:0.018841058015823364, decouple_loss:0.0014769958797842264
loss_pred:0.017889058217406273, decouple_loss:0.0013833276461809874
loss_pred:0.017839867621660233, decouple_loss:0.0014351174468174577
WV_0_PC_1_EH_0_PS_40, loss: 0.018261585384607315, avg_mse: 0.026427481323480606
current test mse: 0.026427
Iteration: 2011, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45202934741973877, gen p mean: -0.03697358816862106, mean p set: 0.4525096118450165
The modified gen p mean: 0.450985848903656, gen p mean: -0.03425123915076256, mean p set: 0.4514661431312561
The modified gen p mean: 0.4506036043167114, gen p mean: -0.033220887184143066, mean p set: 0.4510838985443115
loss_pred:0.01645502634346485, decouple_loss:0.001412654179148376
loss_pred:0.01613825373351574, decouple_loss:0.0014165870379656553
loss_pred:0.016266856342554092, decouple_loss:0.0015364565188065171
Iteration: 2012, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45124655961990356, gen p mean: -0.03559941425919533, mean p set: 0.45172688364982605
loss_pred:0.017415182664990425, decouple_loss:0.0012707646237686276
The modified gen p mean: 0.45253288745880127, gen p mean: -0.033614642918109894, mean p set: 0.45301321148872375The modified gen p mean: 0.4520858824253082, gen p mean: -0.034247323870658875, mean p set: 0.4525661766529083
loss_pred:0.01631067506968975, decouple_loss:0.001288729952648282
loss_pred:0.016748996451497078, decouple_loss:0.001147873466834426
Iteration: 2013, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511801600456238, gen p mean: -0.03748041018843651, mean p set: 0.4516604542732239
loss_pred:0.016321947798132896, decouple_loss:0.0014756182208657265
The modified gen p mean: 0.45122531056404114, gen p mean: -0.038744036108255386, mean p set: 0.45170560479164124The modified gen p mean: 0.4515172839164734, gen p mean: -0.03366793319582939, mean p set: 0.4519975483417511
loss_pred:0.01562158390879631, decouple_loss:0.0014614484971389174
loss_pred:0.016168618574738503, decouple_loss:0.0015245229005813599
Iteration: 2014, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4520367681980133, gen p mean: -0.041303906589746475, mean p set: 0.4525170624256134
loss_pred:0.016654204577207565, decouple_loss:0.0011371347354725003
The modified gen p mean: 0.45270365476608276, gen p mean: -0.03792230412364006, mean p set: 0.45318397879600525The modified gen p mean: 0.4533981680870056, gen p mean: -0.03573141619563103, mean p set: 0.4538784623146057
loss_pred:0.01627911627292633, decouple_loss:0.0011294209398329258
loss_pred:0.016709085553884506, decouple_loss:0.0011564652668312192
Iteration: 2015, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4510897696018219, gen p mean: -0.038641080260276794, mean p set: 0.4515700936317444
loss_pred:0.016051186248660088, decouple_loss:0.0012902580201625824
The modified gen p mean: 0.4513400197029114, gen p mean: -0.037846628576517105, mean p set: 0.4518203139305115The modified gen p mean: 0.452846497297287, gen p mean: -0.039308708161115646, mean p set: 0.4533267617225647
loss_pred:0.0170576311647892, decouple_loss:0.0013384238118305802
loss_pred:0.01648627780377865, decouple_loss:0.001327918958850205
Iteration: 2016, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501783847808838, gen p mean: -0.034554094076156616, mean p set: 0.4506586492061615
loss_pred:0.016310084611177444, decouple_loss:0.001204759581014514
The modified gen p mean: 0.4516639709472656, gen p mean: -0.03761583939194679, mean p set: 0.4521442651748657The modified gen p mean: 0.45040854811668396, gen p mean: -0.04083125665783882, mean p set: 0.45088884234428406
loss_pred:0.01596061885356903, decouple_loss:0.001214662566781044
loss_pred:0.017481597140431404, decouple_loss:0.001166948932223022
Iteration: 2017, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4517357647418976, gen p mean: -0.03999270498752594, mean p set: 0.4522160291671753
loss_pred:0.016291208565235138, decouple_loss:0.0009910432854667306
The modified gen p mean: 0.4511350989341736, gen p mean: -0.04335496202111244, mean p set: 0.4516153931617737The modified gen p mean: 0.45183253288269043, gen p mean: -0.04322715476155281, mean p set: 0.4523128271102905
loss_pred:0.015904070809483528, decouple_loss:0.0010121057275682688
loss_pred:0.017043476924300194, decouple_loss:0.0012118008453398943
Iteration: 2018, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45147353410720825, gen p mean: -0.03910723701119423, mean p set: 0.45195385813713074
loss_pred:0.017298856750130653, decouple_loss:0.0010565753327682614
The modified gen p mean: 0.45082804560661316, gen p mean: -0.0441504530608654, mean p set: 0.45130833983421326The modified gen p mean: 0.44998785853385925, gen p mean: -0.0380038321018219, mean p set: 0.45046815276145935
loss_pred:0.01672210544347763, decouple_loss:0.001154889352619648
loss_pred:0.01575140282511711, decouple_loss:0.0010644359281286597
Iteration: 2019, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.451240211725235, gen p mean: -0.04344633221626282, mean p set: 0.4517205059528351
loss_pred:0.016555290669202805, decouple_loss:0.0011043889680877328
The modified gen p mean: 0.4507720172405243, gen p mean: -0.037159793078899384, mean p set: 0.4512523412704468The modified gen p mean: 0.4514321982860565, gen p mean: -0.04182333126664162, mean p set: 0.4519124925136566
loss_pred:0.016705919057130814, decouple_loss:0.0011506351875141263
loss_pred:0.01754894107580185, decouple_loss:0.0011747990502044559
Iteration: 2020, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4537601172924042, gen p mean: -0.03947107493877411, mean p set: 0.4542403817176819
loss_pred:0.016632506623864174, decouple_loss:0.001036930363625288
The modified gen p mean: 0.45015931129455566, gen p mean: -0.03740070387721062, mean p set: 0.4506395757198334The modified gen p mean: 0.4516017436981201, gen p mean: -0.04347800090909004, mean p set: 0.4520820379257202
loss_pred:0.01659630984067917, decouple_loss:0.0010883485665544868
loss_pred:0.01711731031537056, decouple_loss:0.001027316669933498
2023-05-02 10:14:49 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.047652993351221085, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04217411205172539, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04361649602651596, mean p set: 0.4500633478164673
loss_pred:0.018817666918039322, decouple_loss:0.0013062854995951056
loss_pred:0.01790199615061283, decouple_loss:0.0012386429589241743loss_pred:0.01782146655023098, decouple_loss:0.0012366471346467733
WV_0_PC_1_EH_0_PS_40, loss: 0.018243402242660522, avg_mse: 0.02640409767627716
current test mse: 0.026404
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012003_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012003_3_24hr.npz
NaN value num: 0
Iteration: 2021, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504152834415436, gen p mean: -0.03806648403406143, mean p set: 0.4508955478668213
loss_pred:0.015630176290869713, decouple_loss:0.0010582589311525226
The modified gen p mean: 0.4531958997249603, gen p mean: -0.033568546175956726, mean p set: 0.45367616415023804The modified gen p mean: 0.45045846700668335, gen p mean: -0.03746376186609268, mean p set: 0.45093876123428345
loss_pred:0.016452686861157417, decouple_loss:0.0010243229335173965
loss_pred:0.01581059955060482, decouple_loss:0.001113169826567173
Iteration: 2022, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45129311084747314, gen p mean: -0.04116271808743477, mean p set: 0.45177337527275085
loss_pred:0.016176210716366768, decouple_loss:0.0010239017428830266
The modified gen p mean: 0.45255526900291443, gen p mean: -0.036928169429302216, mean p set: 0.45303553342819214The modified gen p mean: 0.4518912732601166, gen p mean: -0.03931351378560066, mean p set: 0.4523715376853943
loss_pred:0.015363194979727268, decouple_loss:0.001104619586840272
loss_pred:0.015657560899853706, decouple_loss:0.0011096564121544361
Iteration: 2023, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504478871822357, gen p mean: -0.04485206678509712, mean p set: 0.4509281814098358
loss_pred:0.016256125643849373, decouple_loss:0.0011040274985134602
The modified gen p mean: 0.4518289268016815, gen p mean: -0.03681783005595207, mean p set: 0.4523092210292816The modified gen p mean: 0.4520137310028076, gen p mean: -0.034419480711221695, mean p set: 0.4524940252304077
loss_pred:0.01588098146021366, decouple_loss:0.0010647247545421124
loss_pred:0.015368401072919369, decouple_loss:0.0011276438599452376
Iteration: 2024, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44994911551475525, gen p mean: -0.037476081401109695, mean p set: 0.45042940974235535
loss_pred:0.01647956483066082, decouple_loss:0.0010027053067460656
The modified gen p mean: 0.451941579580307, gen p mean: -0.03660902380943298, mean p set: 0.4524218738079071The modified gen p mean: 0.45172634720802307, gen p mean: -0.04189654812216759, mean p set: 0.45220664143562317
loss_pred:0.015519434586167336, decouple_loss:0.0010493486188352108
loss_pred:0.015339079312980175, decouple_loss:0.0010414302814751863
Iteration: 2025, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45128461718559265, gen p mean: -0.03887089341878891, mean p set: 0.45176488161087036
loss_pred:0.015764061361551285, decouple_loss:0.001199500635266304
The modified gen p mean: 0.4512656629085541, gen p mean: -0.04042406752705574, mean p set: 0.4517459571361542The modified gen p mean: 0.45119988918304443, gen p mean: -0.03712949901819229, mean p set: 0.4516802132129669
loss_pred:0.015378056094050407, decouple_loss:0.0010369522497057915
loss_pred:0.015145336277782917, decouple_loss:0.0011204848997294903
Iteration: 2026, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45076966285705566, gen p mean: -0.037864431738853455, mean p set: 0.45124995708465576
loss_pred:0.01555241271853447, decouple_loss:0.001136672217398882
The modified gen p mean: 0.45191967487335205, gen p mean: -0.04094341769814491, mean p set: 0.45239993929862976
The modified gen p mean: 0.4502285420894623, gen p mean: -0.0406692773103714, mean p set: 0.4507088363170624
loss_pred:0.015839051455259323, decouple_loss:0.0011448770528659225
loss_pred:0.015683380886912346, decouple_loss:0.0010077670449391007
Iteration: 2027, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4533810317516327, gen p mean: -0.03985567390918732, mean p set: 0.4538613259792328
loss_pred:0.015805061906576157, decouple_loss:0.0008908419404178858
The modified gen p mean: 0.4514588415622711, gen p mean: -0.03647809475660324, mean p set: 0.4519391357898712The modified gen p mean: 0.4492797553539276, gen p mean: -0.03946005553007126, mean p set: 0.4497600495815277
loss_pred:0.01503017172217369, decouple_loss:0.0009816199308261275
loss_pred:0.01611611619591713, decouple_loss:0.0010225813603028655
Iteration: 2028, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45107418298721313, gen p mean: -0.04104657098650932, mean p set: 0.45155444741249084
loss_pred:0.01519417017698288, decouple_loss:0.0011758492328226566
The modified gen p mean: 0.4497283101081848, gen p mean: -0.0404532253742218, mean p set: 0.4502086043357849The modified gen p mean: 0.4522086977958679, gen p mean: -0.042276300489902496, mean p set: 0.45268896222114563
loss_pred:0.01566264219582081, decouple_loss:0.0011336269089952111
loss_pred:0.015193729661405087, decouple_loss:0.0010497032199054956
Iteration: 2029, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4518909454345703, gen p mean: -0.03723469376564026, mean p set: 0.4523712396621704
loss_pred:0.01653420180082321, decouple_loss:0.0010644571157172322
The modified gen p mean: 0.4522443115711212, gen p mean: -0.04212465137243271, mean p set: 0.4527246057987213The modified gen p mean: 0.4515930414199829, gen p mean: -0.04301610589027405, mean p set: 0.4520733654499054
loss_pred:0.015242459252476692, decouple_loss:0.0009895536350086331
loss_pred:0.015775315463542938, decouple_loss:0.001004729070700705
Iteration: 2030, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4510365128517151, gen p mean: -0.04138089716434479, mean p set: 0.4515168070793152
loss_pred:0.015635449439287186, decouple_loss:0.0009770285105332732
The modified gen p mean: 0.4520318806171417, gen p mean: -0.03774501755833626, mean p set: 0.45251214504241943The modified gen p mean: 0.45121800899505615, gen p mean: -0.03822940215468407, mean p set: 0.45169830322265625
loss_pred:0.015901917591691017, decouple_loss:0.0009824784938246012
loss_pred:0.01532916259020567, decouple_loss:0.0009608731488697231
2023-05-02 10:17:16 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.05070194974541664, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04627380147576332, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04625577852129936, mean p set: 0.4500633478164673
loss_pred:0.01850932464003563, decouple_loss:0.0011650434462353587
loss_pred:0.017474740743637085, decouple_loss:0.0011012029135599732loss_pred:0.0174761563539505, decouple_loss:0.0011201108573004603
WV_0_PC_1_EH_0_PS_40, loss: 0.017876513302326202, avg_mse: 0.025717968121170998
current test mse: 0.025718
Iteration: 2031, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511014521121979, gen p mean: -0.04084641858935356, mean p set: 0.4515817165374756
The modified gen p mean: 0.45080623030662537, gen p mean: -0.04210355877876282, mean p set: 0.45128652453422546
The modified gen p mean: 0.4496269226074219, gen p mean: -0.04233656823635101, mean p set: 0.45010724663734436
loss_pred:0.01572609320282936, decouple_loss:0.0009724995470605791
loss_pred:0.016287775710225105, decouple_loss:0.0009492954122833908
loss_pred:0.01541459746658802, decouple_loss:0.0010299567366018891
Iteration: 2032, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4518243670463562, gen p mean: -0.043150585144758224, mean p set: 0.4523046314716339
loss_pred:0.015671921893954277, decouple_loss:0.0009193313890136778
The modified gen p mean: 0.45262864232063293, gen p mean: -0.03941953927278519, mean p set: 0.45310890674591064The modified gen p mean: 0.45057961344718933, gen p mean: -0.03897029906511307, mean p set: 0.4510599374771118
loss_pred:0.01572394371032715, decouple_loss:0.000950005603954196
loss_pred:0.015355834737420082, decouple_loss:0.000918285921216011
Iteration: 2033, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45102256536483765, gen p mean: -0.03902297839522362, mean p set: 0.45150282979011536
loss_pred:0.0153876394033432, decouple_loss:0.0010127733694389462
The modified gen p mean: 0.4518423080444336, gen p mean: -0.04059059917926788, mean p set: 0.4523225724697113The modified gen p mean: 0.45061710476875305, gen p mean: -0.04134351387619972, mean p set: 0.45109736919403076
loss_pred:0.015657221898436546, decouple_loss:0.0009349014144390821
loss_pred:0.015074845403432846, decouple_loss:0.0009967193473130465
Iteration: 2034, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45086026191711426, gen p mean: -0.04531942307949066, mean p set: 0.45134058594703674
loss_pred:0.015411666594445705, decouple_loss:0.001058601657859981
The modified gen p mean: 0.44986599683761597, gen p mean: -0.04229492321610451, mean p set: 0.45034632086753845The modified gen p mean: 0.4500848352909088, gen p mean: -0.04660619795322418, mean p set: 0.4505651295185089
loss_pred:0.015429973602294922, decouple_loss:0.0010503210360184312
loss_pred:0.01578168384730816, decouple_loss:0.0009785509901121259
Iteration: 2035, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45181411504745483, gen p mean: -0.041196465492248535, mean p set: 0.45229440927505493
loss_pred:0.016492916271090508, decouple_loss:0.001173621159978211
The modified gen p mean: 0.4521043300628662, gen p mean: -0.04577210918068886, mean p set: 0.4525846242904663The modified gen p mean: 0.45187821984291077, gen p mean: -0.04378606379032135, mean p set: 0.45235851407051086
loss_pred:0.0154328104108572, decouple_loss:0.0009655433823354542
loss_pred:0.01605980470776558, decouple_loss:0.0011444827541708946
Iteration: 2036, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514724612236023, gen p mean: -0.04451631009578705, mean p set: 0.4519527554512024
loss_pred:0.015197210945189, decouple_loss:0.0010860939510166645
The modified gen p mean: 0.45282426476478577, gen p mean: -0.04230624809861183, mean p set: 0.4533045291900635The modified gen p mean: 0.45082539319992065, gen p mean: -0.04499591514468193, mean p set: 0.45130568742752075
loss_pred:0.015167995356023312, decouple_loss:0.001020377385430038
loss_pred:0.015374572947621346, decouple_loss:0.001103383838199079
Iteration: 2037, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44996029138565063, gen p mean: -0.044874560087919235, mean p set: 0.45044055581092834
loss_pred:0.016308343037962914, decouple_loss:0.0010885260999202728
The modified gen p mean: 0.45056819915771484, gen p mean: -0.04512089863419533, mean p set: 0.45104846358299255The modified gen p mean: 0.4503079950809479, gen p mean: -0.047210875898599625, mean p set: 0.450788289308548
loss_pred:0.01575050689280033, decouple_loss:0.0010394828859716654
loss_pred:0.015501403249800205, decouple_loss:0.0011137669207528234
Iteration: 2038, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44978269934654236, gen p mean: -0.04071303829550743, mean p set: 0.45026299357414246
loss_pred:0.016122525557875633, decouple_loss:0.001031471067108214
The modified gen p mean: 0.45068755745887756, gen p mean: -0.04297066479921341, mean p set: 0.45116788148880005The modified gen p mean: 0.45287275314331055, gen p mean: -0.041413113474845886, mean p set: 0.45335304737091064
loss_pred:0.015995429828763008, decouple_loss:0.001076315063983202
loss_pred:0.016314076259732246, decouple_loss:0.0011067898012697697
Iteration: 2039, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45170214772224426, gen p mean: -0.04341752454638481, mean p set: 0.45218244194984436
loss_pred:0.015955660492181778, decouple_loss:0.0010150348534807563
The modified gen p mean: 0.4513220489025116, gen p mean: -0.04123493656516075, mean p set: 0.4518023431301117The modified gen p mean: 0.4525086283683777, gen p mean: -0.04360317438840866, mean p set: 0.4529889225959778
loss_pred:0.015412973240017891, decouple_loss:0.0010416075820103288
loss_pred:0.015300953760743141, decouple_loss:0.0010737230768427253
Iteration: 2040, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4506872892379761, gen p mean: -0.04384709149599075, mean p set: 0.45116758346557617
loss_pred:0.015442276373505592, decouple_loss:0.001118960790336132
The modified gen p mean: 0.45046862959861755, gen p mean: -0.0426182821393013, mean p set: 0.45094895362854004
The modified gen p mean: 0.45116060972213745, gen p mean: -0.04415010288357735, mean p set: 0.45164093375205994
loss_pred:0.01580437272787094, decouple_loss:0.0010153762996196747
loss_pred:0.015082458965480328, decouple_loss:0.0010348999639973044
2023-05-02 10:19:11 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.05376851186156273, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.048792995512485504, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.04954715818166733, mean p set: 0.4500633478164673
loss_pred:0.018393557518720627, decouple_loss:0.001257668249309063
loss_pred:0.017377329990267754, decouple_loss:0.0011276607401669025
loss_pred:0.017392555251717567, decouple_loss:0.0011290021939203143
WV_0_PC_1_EH_0_PS_40, loss: 0.017779720947146416, avg_mse: 0.025554288178682327
current test mse: 0.025554
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012015_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012015_3_24hr.npz
NaN value num: 0
Iteration: 2041, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4463682472705841, gen p mean: -0.05423982813954353, mean p set: 0.4468485414981842
loss_pred:0.01519404724240303, decouple_loss:0.0011086727026849985
The modified gen p mean: 0.44630181789398193, gen p mean: -0.050817422568798065, mean p set: 0.44678211212158203The modified gen p mean: 0.4473856985569, gen p mean: -0.053627099841833115, mean p set: 0.4478660225868225
loss_pred:0.015457252971827984, decouple_loss:0.0011628393549472094
loss_pred:0.01629067026078701, decouple_loss:0.0011721906485036016
Iteration: 2042, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44418957829475403, gen p mean: -0.052042506635189056, mean p set: 0.44466984272003174
loss_pred:0.015841541811823845, decouple_loss:0.001158083905465901
The modified gen p mean: 0.4465024173259735, gen p mean: -0.05278000608086586, mean p set: 0.446982741355896The modified gen p mean: 0.4479641318321228, gen p mean: -0.05101461336016655, mean p set: 0.4484444558620453
loss_pred:0.01610511541366577, decouple_loss:0.0011392257874831557
loss_pred:0.015467573888599873, decouple_loss:0.0011227757204324007
Iteration: 2043, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4463280439376831, gen p mean: -0.04923888295888901, mean p set: 0.4468083381652832
loss_pred:0.01501714251935482, decouple_loss:0.0011519081890583038
The modified gen p mean: 0.44683507084846497, gen p mean: -0.05168287083506584, mean p set: 0.44731536507606506The modified gen p mean: 0.4471440613269806, gen p mean: -0.049775637686252594, mean p set: 0.4476243555545807
loss_pred:0.015721824020147324, decouple_loss:0.0012662993976846337
loss_pred:0.015312332659959793, decouple_loss:0.0011765810195356607
Iteration: 2044, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44599515199661255, gen p mean: -0.052207984030246735, mean p set: 0.44647544622421265
loss_pred:0.01598580926656723, decouple_loss:0.0011514383368194103
The modified gen p mean: 0.4465227425098419, gen p mean: -0.04882057011127472, mean p set: 0.447003036737442The modified gen p mean: 0.44592511653900146, gen p mean: -0.05076491832733154, mean p set: 0.44640541076660156
loss_pred:0.015566564165055752, decouple_loss:0.001102279406040907
loss_pred:0.015070373192429543, decouple_loss:0.0010963492095470428
Iteration: 2045, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44563719630241394, gen p mean: -0.044924769550561905, mean p set: 0.44611749053001404
loss_pred:0.01518965419381857, decouple_loss:0.0012255978072062135
The modified gen p mean: 0.4470517337322235, gen p mean: -0.04957094416022301, mean p set: 0.4475320279598236The modified gen p mean: 0.44618162512779236, gen p mean: -0.04455810412764549, mean p set: 0.44666188955307007
loss_pred:0.015455842949450016, decouple_loss:0.0010634521022439003
loss_pred:0.014921198599040508, decouple_loss:0.0010497624753043056
Iteration: 2046, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44547614455223083, gen p mean: -0.05161566287279129, mean p set: 0.44595643877983093
loss_pred:0.01476259808987379, decouple_loss:0.001178210019133985
The modified gen p mean: 0.44647565484046936, gen p mean: -0.05167635902762413, mean p set: 0.44695594906806946The modified gen p mean: 0.44705435633659363, gen p mean: -0.05141745135188103, mean p set: 0.4475346803665161
loss_pred:0.014515480026602745, decouple_loss:0.001155357458628714
loss_pred:0.015937576070427895, decouple_loss:0.0011825604597106576
Iteration: 2047, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4449184238910675, gen p mean: -0.0528373084962368, mean p set: 0.4453986883163452
loss_pred:0.015681209042668343, decouple_loss:0.0014261973556131124
The modified gen p mean: 0.44546782970428467, gen p mean: -0.04865896701812744, mean p set: 0.4459480941295624The modified gen p mean: 0.44681501388549805, gen p mean: -0.05056537315249443, mean p set: 0.44729533791542053
loss_pred:0.014695268124341965, decouple_loss:0.0011902828700840473
loss_pred:0.014827444218099117, decouple_loss:0.001206042361445725
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 2048, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470646381378174, gen p mean: -0.05061659216880798, mean p set: 0.4475449025630951
loss_pred:0.01552380621433258, decouple_loss:0.0013300444697961211
The modified gen p mean: 0.44696277379989624, gen p mean: -0.05199890956282616, mean p set: 0.44744303822517395The modified gen p mean: 0.44660240411758423, gen p mean: -0.0512203648686409, mean p set: 0.4470827281475067
loss_pred:0.015333130955696106, decouple_loss:0.001266285078600049
loss_pred:0.014732860028743744, decouple_loss:0.0011824427638202906
Iteration: 2049, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44675591588020325, gen p mean: -0.04595606401562691, mean p set: 0.44723621010780334
loss_pred:0.014989657327532768, decouple_loss:0.0012266022386029363
The modified gen p mean: 0.44717806577682495, gen p mean: -0.05117492750287056, mean p set: 0.44765836000442505The modified gen p mean: 0.44671282172203064, gen p mean: -0.051785849034786224, mean p set: 0.44719311594963074
loss_pred:0.014630172401666641, decouple_loss:0.0013172373874112964
loss_pred:0.014865524135529995, decouple_loss:0.0011994113447144628
Iteration: 2050, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471549987792969, gen p mean: -0.04786309972405434, mean p set: 0.44763532280921936
loss_pred:0.01569930836558342, decouple_loss:0.00118557782843709
The modified gen p mean: 0.4464186131954193, gen p mean: -0.05075707659125328, mean p set: 0.4468989372253418The modified gen p mean: 0.44665899872779846, gen p mean: -0.05517083778977394, mean p set: 0.44713932275772095
loss_pred:0.015658855438232422, decouple_loss:0.001241109101101756
loss_pred:0.01554503571242094, decouple_loss:0.0012894427636638284
2023-05-02 10:21:47 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.05439642071723938, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.049430448561906815, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.05004487931728363, mean p set: 0.4500633478164673
loss_pred:0.01944306120276451, decouple_loss:0.0013070092536509037
loss_pred:0.018453914672136307, decouple_loss:0.0012130610411986709
loss_pred:0.018457695841789246, decouple_loss:0.0012369534233585
WV_0_PC_1_EH_0_PS_40, loss: 0.01884750835597515, avg_mse: 0.02752353623509407
current test mse: 0.027524
Iteration: 2051, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44716018438339233, gen p mean: -0.059088800102472305, mean p set: 0.4476405084133148
The modified gen p mean: 0.4469248056411743, gen p mean: -0.05633647367358208, mean p set: 0.447405070066452
The modified gen p mean: 0.44587963819503784, gen p mean: -0.054703980684280396, mean p set: 0.4463599622249603
loss_pred:0.01592206582427025, decouple_loss:0.0013379844604060054
loss_pred:0.0151805579662323, decouple_loss:0.0012358558597043157
loss_pred:0.014787698164582253, decouple_loss:0.0012610726989805698
Iteration: 2052, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465615153312683, gen p mean: -0.058034345507621765, mean p set: 0.4470418095588684
loss_pred:0.014952320605516434, decouple_loss:0.0011269031092524529
The modified gen p mean: 0.44701582193374634, gen p mean: -0.06355928629636765, mean p set: 0.44749611616134644The modified gen p mean: 0.4456939697265625, gen p mean: -0.059042613953351974, mean p set: 0.446174293756485
loss_pred:0.014766822569072247, decouple_loss:0.001161335501819849
loss_pred:0.01504778116941452, decouple_loss:0.0012360945111140609
Iteration: 2053, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467942416667938, gen p mean: -0.05773965269327164, mean p set: 0.4472745358943939
loss_pred:0.015115643851459026, decouple_loss:0.001294544548727572
The modified gen p mean: 0.44706955552101135, gen p mean: -0.05521080642938614, mean p set: 0.44754984974861145The modified gen p mean: 0.44704344868659973, gen p mean: -0.057759206742048264, mean p set: 0.44752374291419983
loss_pred:0.016211140900850296, decouple_loss:0.0013540287036448717
loss_pred:0.015164140611886978, decouple_loss:0.0013660641852766275
Iteration: 2054, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4457946717739105, gen p mean: -0.044152576476335526, mean p set: 0.446274995803833
loss_pred:0.015374010428786278, decouple_loss:0.001272600726224482
The modified gen p mean: 0.4451724886894226, gen p mean: -0.04504886269569397, mean p set: 0.4456527829170227The modified gen p mean: 0.4465303421020508, gen p mean: -0.04358769953250885, mean p set: 0.4470106363296509
loss_pred:0.014940109103918076, decouple_loss:0.0013113630702719092
loss_pred:0.015096548944711685, decouple_loss:0.0013295289827510715
Iteration: 2055, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465557038784027, gen p mean: -0.03763911873102188, mean p set: 0.4470359981060028
loss_pred:0.014537986367940903, decouple_loss:0.001216772012412548
The modified gen p mean: 0.4476493299007416, gen p mean: -0.034933093935251236, mean p set: 0.44812965393066406The modified gen p mean: 0.44725629687309265, gen p mean: -0.03875032439827919, mean p set: 0.44773659110069275
loss_pred:0.015470638871192932, decouple_loss:0.0012565945507958531
loss_pred:0.014733300544321537, decouple_loss:0.00123653095215559
Iteration: 2056, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476238787174225, gen p mean: -0.03297039121389389, mean p set: 0.4481041729450226
loss_pred:0.015690160915255547, decouple_loss:0.0013943384401500225
The modified gen p mean: 0.446176677942276, gen p mean: -0.03243773430585861, mean p set: 0.4466569721698761The modified gen p mean: 0.44665977358818054, gen p mean: -0.03340652212500572, mean p set: 0.44714006781578064
loss_pred:0.015463972464203835, decouple_loss:0.0013473767321556807
loss_pred:0.01517560239881277, decouple_loss:0.0013577834470197558
Iteration: 2057, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44558170437812805, gen p mean: -0.03535531833767891, mean p set: 0.44606199860572815
loss_pred:0.014665474183857441, decouple_loss:0.001388575416058302
The modified gen p mean: 0.4460996687412262, gen p mean: -0.03493879362940788, mean p set: 0.4465799629688263The modified gen p mean: 0.44583043456077576, gen p mean: -0.03546810522675514, mean p set: 0.44631072878837585
loss_pred:0.014409178867936134, decouple_loss:0.0013494023587554693
loss_pred:0.014428725466132164, decouple_loss:0.0012785051949322224
Iteration: 2058, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464435279369354, gen p mean: -0.04546159878373146, mean p set: 0.4469238221645355
loss_pred:0.015864916145801544, decouple_loss:0.0013124283868819475
The modified gen p mean: 0.44556576013565063, gen p mean: -0.04724954813718796, mean p set: 0.44604605436325073The modified gen p mean: 0.44722798466682434, gen p mean: -0.04563334956765175, mean p set: 0.44770827889442444
loss_pred:0.014805584214627743, decouple_loss:0.0013251716736704111
loss_pred:0.015401385724544525, decouple_loss:0.0012994403950870037
Iteration: 2059, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.445913702249527, gen p mean: -0.05041160807013512, mean p set: 0.44639402627944946
loss_pred:0.014696000143885612, decouple_loss:0.0014124674489721656
The modified gen p mean: 0.4459589421749115, gen p mean: -0.052249208092689514, mean p set: 0.4464392364025116The modified gen p mean: 0.4458606541156769, gen p mean: -0.05219893530011177, mean p set: 0.4463409185409546
loss_pred:0.01497756689786911, decouple_loss:0.0013432455016300082
loss_pred:0.014858579263091087, decouple_loss:0.0013608754379674792
Iteration: 2060, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44565340876579285, gen p mean: -0.05498699098825455, mean p set: 0.44613370299339294
loss_pred:0.014498905278742313, decouple_loss:0.001431692624464631
The modified gen p mean: 0.44659748673439026, gen p mean: -0.05741879716515541, mean p set: 0.44707778096199036The modified gen p mean: 0.4471542239189148, gen p mean: -0.05619516223669052, mean p set: 0.4476345181465149
loss_pred:0.01484770979732275, decouple_loss:0.0013947129482403398
loss_pred:0.014817684888839722, decouple_loss:0.0015014753444120288
2023-05-02 10:23:43 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.05801535025238991, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.05308033525943756, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.0539080910384655, mean p set: 0.4500633478164673
loss_pred:0.018948737531900406, decouple_loss:0.0013518220512196422
loss_pred:0.017846373841166496, decouple_loss:0.001356632448732853
loss_pred:0.017937904223799706, decouple_loss:0.0013832218246534467
WV_0_PC_1_EH_0_PS_40, loss: 0.01831253431737423, avg_mse: 0.026493895798921585
current test mse: 0.026494
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012016_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012016_3_24hr.npz
NaN value num: 0
Iteration: 2061, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44748654961586, gen p mean: -0.05419204756617546, mean p set: 0.4479668438434601
loss_pred:0.015123180113732815, decouple_loss:0.0013617340009659529
The modified gen p mean: 0.44733738899230957, gen p mean: -0.054948996752500534, mean p set: 0.44781771302223206The modified gen p mean: 0.4479086697101593, gen p mean: -0.054038580507040024, mean p set: 0.4483889639377594
loss_pred:0.01503975223749876, decouple_loss:0.0014552860520780087loss_pred:0.01438741572201252, decouple_loss:0.0013424966018646955
Iteration: 2062, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475264549255371, gen p mean: -0.05494071543216705, mean p set: 0.4480067491531372
loss_pred:0.014650113880634308, decouple_loss:0.0013886471278965473
The modified gen p mean: 0.4485894441604614, gen p mean: -0.05310539901256561, mean p set: 0.4490697383880615The modified gen p mean: 0.44720011949539185, gen p mean: -0.0548369474709034, mean p set: 0.44768041372299194
loss_pred:0.014183358289301395, decouple_loss:0.0014248742954805493
loss_pred:0.014163941144943237, decouple_loss:0.0013581047533079982
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 2063, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474899172782898, gen p mean: -0.04925725609064102, mean p set: 0.4479702413082123
loss_pred:0.014318807981908321, decouple_loss:0.001476170844398439
The modified gen p mean: 0.4475800395011902, gen p mean: -0.05257449671626091, mean p set: 0.4480603337287903The modified gen p mean: 0.44779056310653687, gen p mean: -0.052869245409965515, mean p set: 0.4482708275318146
loss_pred:0.015083231963217258, decouple_loss:0.0013962042285129428
loss_pred:0.014290395192801952, decouple_loss:0.0015183218056336045
Iteration: 2064, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44745901226997375, gen p mean: -0.048308078199625015, mean p set: 0.44793930649757385
loss_pred:0.014578046277165413, decouple_loss:0.0012838010443374515
The modified gen p mean: 0.4481313228607178, gen p mean: -0.04698939993977547, mean p set: 0.4486115872859955The modified gen p mean: 0.4471803605556488, gen p mean: -0.04729897901415825, mean p set: 0.4476606547832489
loss_pred:0.014537022449076176, decouple_loss:0.0013374524423852563
loss_pred:0.014769375324249268, decouple_loss:0.0012311037862673402
Iteration: 2065, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44858667254447937, gen p mean: -0.045775048434734344, mean p set: 0.4490669369697571
loss_pred:0.014150252565741539, decouple_loss:0.0012950784293934703
The modified gen p mean: 0.4470789432525635, gen p mean: -0.04215241223573685, mean p set: 0.44755926728248596The modified gen p mean: 0.4475241005420685, gen p mean: -0.049720000475645065, mean p set: 0.4480043649673462
loss_pred:0.015088530257344246, decouple_loss:0.00140192243270576
loss_pred:0.01480069663375616, decouple_loss:0.001215820899233222
Iteration: 2066, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476320445537567, gen p mean: -0.0420551635324955, mean p set: 0.4481123387813568
loss_pred:0.013797633349895477, decouple_loss:0.0012759508099406958
The modified gen p mean: 0.4469631016254425, gen p mean: -0.04520424082875252, mean p set: 0.447443425655365The modified gen p mean: 0.4476644992828369, gen p mean: -0.047769639641046524, mean p set: 0.4481448233127594
loss_pred:0.0143646951764822, decouple_loss:0.0012732661562040448
loss_pred:0.014969374053180218, decouple_loss:0.0012702860403805971
Iteration: 2067, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478148818016052, gen p mean: -0.05306503549218178, mean p set: 0.4482952058315277
loss_pred:0.014227994717657566, decouple_loss:0.0012782593257725239
The modified gen p mean: 0.44654354453086853, gen p mean: -0.04723166674375534, mean p set: 0.44702383875846863The modified gen p mean: 0.4475558400154114, gen p mean: -0.04567589610815048, mean p set: 0.4480361342430115
loss_pred:0.014607468619942665, decouple_loss:0.0011618701973930001
loss_pred:0.014312997460365295, decouple_loss:0.0011765498202294111
Iteration: 2068, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44758734107017517, gen p mean: -0.0508812814950943, mean p set: 0.44806763529777527
loss_pred:0.014097192324697971, decouple_loss:0.0013458168832585216
The modified gen p mean: 0.44719043374061584, gen p mean: -0.053914763033390045, mean p set: 0.44767072796821594The modified gen p mean: 0.44735559821128845, gen p mean: -0.046360988169908524, mean p set: 0.44783589243888855
loss_pred:0.014696023426949978, decouple_loss:0.0012337681837379932
loss_pred:0.013952909037470818, decouple_loss:0.0011685692006722093
Iteration: 2069, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44729742407798767, gen p mean: -0.0513836070895195, mean p set: 0.44777771830558777
loss_pred:0.014223795384168625, decouple_loss:0.0011214388068765402
The modified gen p mean: 0.4472975432872772, gen p mean: -0.05238209664821625, mean p set: 0.4477778375148773The modified gen p mean: 0.4473910331726074, gen p mean: -0.0467551089823246, mean p set: 0.4478713572025299
loss_pred:0.013767062686383724, decouple_loss:0.0012277603382244706
loss_pred:0.014856849797070026, decouple_loss:0.0012157898163422942
Iteration: 2070, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468156695365906, gen p mean: -0.0518624521791935, mean p set: 0.44729599356651306
loss_pred:0.013669216074049473, decouple_loss:0.0012265443801879883
The modified gen p mean: 0.447537362575531, gen p mean: -0.05319510027766228, mean p set: 0.4480176270008087The modified gen p mean: 0.4476095139980316, gen p mean: -0.05160566419363022, mean p set: 0.4480897784233093
loss_pred:0.014229165390133858, decouple_loss:0.0011302577331662178
loss_pred:0.014220130629837513, decouple_loss:0.0010876909364014864
2023-05-02 10:26:14 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.053770240396261215, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04877519607543945, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04967163875699043, mean p set: 0.4500633478164673
loss_pred:0.018964558839797974, decouple_loss:0.0011957280803471804
loss_pred:0.017948200926184654, decouple_loss:0.0012064655311405659
loss_pred:0.01793786697089672, decouple_loss:0.001169942319393158
WV_0_PC_1_EH_0_PS_40, loss: 0.018343079835176468, avg_mse: 0.026635095477104187
current test mse: 0.026635
Iteration: 2071, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44752684235572815, gen p mean: -0.05419605225324631, mean p set: 0.44800713658332825
The modified gen p mean: 0.447619765996933, gen p mean: -0.05070095136761665, mean p set: 0.4481000304222107
The modified gen p mean: 0.448035329580307, gen p mean: -0.05053051933646202, mean p set: 0.4485156238079071
loss_pred:0.013541211374104023, decouple_loss:0.0011229243827983737
loss_pred:0.014335960149765015, decouple_loss:0.0012000163551419973
loss_pred:0.014030328020453453, decouple_loss:0.0012782060075551271
Iteration: 2072, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44719046354293823, gen p mean: -0.05052436515688896, mean p set: 0.44767072796821594
loss_pred:0.014378509484231472, decouple_loss:0.001177758676931262
The modified gen p mean: 0.44701892137527466, gen p mean: -0.0507323332130909, mean p set: 0.44749921560287476The modified gen p mean: 0.44772130250930786, gen p mean: -0.0537872239947319, mean p set: 0.44820162653923035
loss_pred:0.014655398204922676, decouple_loss:0.0011759268818423152
loss_pred:0.014467073604464531, decouple_loss:0.0011052271584048867
Iteration: 2073, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469161927700043, gen p mean: -0.05485082045197487, mean p set: 0.44739648699760437
loss_pred:0.01480190735310316, decouple_loss:0.0011961701093241572
The modified gen p mean: 0.44814151525497437, gen p mean: -0.05381382256746292, mean p set: 0.4486217796802521The modified gen p mean: 0.4477626085281372, gen p mean: -0.053207460790872574, mean p set: 0.4482428729534149
loss_pred:0.013900112360715866, decouple_loss:0.0011257622390985489
loss_pred:0.014042913913726807, decouple_loss:0.0011787564726546407
Iteration: 2074, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44665274024009705, gen p mean: -0.04686611518263817, mean p set: 0.44713303446769714
loss_pred:0.013751586899161339, decouple_loss:0.0010549461003392935
The modified gen p mean: 0.4471185505390167, gen p mean: -0.04880905523896217, mean p set: 0.4475988745689392The modified gen p mean: 0.4473235309123993, gen p mean: -0.04866082966327667, mean p set: 0.4478038251399994
loss_pred:0.014055376872420311, decouple_loss:0.0010753247188404202
loss_pred:0.01407011691480875, decouple_loss:0.0012493986869230866
Iteration: 2075, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44698387384414673, gen p mean: -0.04930170252919197, mean p set: 0.4474641680717468
loss_pred:0.014541206881403923, decouple_loss:0.001128620933741331
The modified gen p mean: 0.4483296573162079, gen p mean: -0.05247238278388977, mean p set: 0.4488099217414856The modified gen p mean: 0.44744566082954407, gen p mean: -0.05153360217809677, mean p set: 0.44792598485946655
loss_pred:0.014678687788546085, decouple_loss:0.0010819690069183707
loss_pred:0.014167015440762043, decouple_loss:0.001110946061089635
Iteration: 2076, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476642608642578, gen p mean: -0.04580830782651901, mean p set: 0.4481445848941803
loss_pred:0.013850714080035686, decouple_loss:0.0010111097944900393
The modified gen p mean: 0.44601359963417053, gen p mean: -0.0465162955224514, mean p set: 0.44649389386177063The modified gen p mean: 0.44710057973861694, gen p mean: -0.05501094087958336, mean p set: 0.44758090376853943
loss_pred:0.013663495890796185, decouple_loss:0.001009592437185347
loss_pred:0.014118735678493977, decouple_loss:0.0010891301790252328
Iteration: 2077, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44779273867607117, gen p mean: -0.046064965426921844, mean p set: 0.4482730031013489
loss_pred:0.01399826817214489, decouple_loss:0.0011099576950073242
The modified gen p mean: 0.44677072763442993, gen p mean: -0.048246726393699646, mean p set: 0.44725102186203003The modified gen p mean: 0.446276992559433, gen p mean: -0.046957675367593765, mean p set: 0.4467572569847107
loss_pred:0.013641854748129845, decouple_loss:0.001013569999486208
loss_pred:0.013924304395914078, decouple_loss:0.0010740171419456601
Iteration: 2078, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4463063180446625, gen p mean: -0.04902754724025726, mean p set: 0.44678664207458496
loss_pred:0.013933653011918068, decouple_loss:0.0010203627170994878
The modified gen p mean: 0.44785478711128235, gen p mean: -0.04894809424877167, mean p set: 0.44833505153656006The modified gen p mean: 0.44776326417922974, gen p mean: -0.05162174627184868, mean p set: 0.44824355840682983
loss_pred:0.014285760931670666, decouple_loss:0.0012845791643485427
loss_pred:0.01438368484377861, decouple_loss:0.0012050262885168195
Iteration: 2079, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44715288281440735, gen p mean: -0.04774228855967522, mean p set: 0.44763314723968506
loss_pred:0.014477894641458988, decouple_loss:0.0011357078328728676
The modified gen p mean: 0.44800665974617004, gen p mean: -0.0501193068921566, mean p set: 0.44848695397377014The modified gen p mean: 0.44759684801101685, gen p mean: -0.04722534120082855, mean p set: 0.44807714223861694
loss_pred:0.013926483690738678, decouple_loss:0.001114433049224317
loss_pred:0.014046469703316689, decouple_loss:0.0011833354365080595
Iteration: 2080, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471842646598816, gen p mean: -0.045620519667863846, mean p set: 0.4476645588874817
loss_pred:0.014208410866558552, decouple_loss:0.0010612924816086888
The modified gen p mean: 0.4472668766975403, gen p mean: -0.0493050217628479, mean p set: 0.44774720072746277The modified gen p mean: 0.4477413594722748, gen p mean: -0.047906458377838135, mean p set: 0.4482216238975525
loss_pred:0.013559756800532341, decouple_loss:0.0010629819007590413
loss_pred:0.014500940218567848, decouple_loss:0.0011189390206709504
2023-05-02 10:28:09 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.0497463122010231, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.044906117022037506, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.0457230880856514, mean p set: 0.4500633478164673
loss_pred:0.01899939961731434, decouple_loss:0.0011898830998688936
loss_pred:0.017910338938236237, decouple_loss:0.0010892471764236689
loss_pred:0.017944632098078728, decouple_loss:0.0011678156442940235
WV_0_PC_1_EH_0_PS_40, loss: 0.018342239782214165, avg_mse: 0.02669433504343033
current test mse: 0.026694
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012017_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012017_3_24hr.npz
NaN value num: 0
Iteration: 2081, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484468698501587, gen p mean: -0.042752914130687714, mean p set: 0.4489271342754364
loss_pred:0.01357673667371273, decouple_loss:0.0011196081759408116
The modified gen p mean: 0.44735920429229736, gen p mean: -0.049567125737667084, mean p set: 0.4478394687175751The modified gen p mean: 0.44890785217285156, gen p mean: -0.044805094599723816, mean p set: 0.44938814640045166
loss_pred:0.013857295736670494, decouple_loss:0.0011248470982536674
loss_pred:0.014242858625948429, decouple_loss:0.0010488006519153714
Iteration: 2082, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482780992984772, gen p mean: -0.0460578128695488, mean p set: 0.4487583637237549
loss_pred:0.014191512949764729, decouple_loss:0.0010718884877860546
The modified gen p mean: 0.44809165596961975, gen p mean: -0.045446719974279404, mean p set: 0.44857192039489746The modified gen p mean: 0.4472324848175049, gen p mean: -0.05372105538845062, mean p set: 0.447712779045105
loss_pred:0.014263528399169445, decouple_loss:0.001080734538845718
loss_pred:0.013859398663043976, decouple_loss:0.0011431865859776735
Iteration: 2083, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44700318574905396, gen p mean: -0.05286169424653053, mean p set: 0.44748347997665405
loss_pred:0.013824526220560074, decouple_loss:0.0011318579781800508
The modified gen p mean: 0.4476214051246643, gen p mean: -0.04944382235407829, mean p set: 0.4481017291545868
The modified gen p mean: 0.4478228688240051, gen p mean: -0.04649079963564873, mean p set: 0.4483031630516052
loss_pred:0.013584272004663944, decouple_loss:0.0011194710386916995
loss_pred:0.013995278626680374, decouple_loss:0.0010859441244974732
Iteration: 2084, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44781357049942017, gen p mean: -0.05327647551894188, mean p set: 0.4482938349246979
loss_pred:0.013716435991227627, decouple_loss:0.0011796070029959083
The modified gen p mean: 0.44872283935546875, gen p mean: -0.05104383826255798, mean p set: 0.44920313358306885The modified gen p mean: 0.44745364785194397, gen p mean: -0.0527988038957119, mean p set: 0.4479339122772217
loss_pred:0.013429947197437286, decouple_loss:0.0012728255242109299
loss_pred:0.013860591687262058, decouple_loss:0.0010737230768427253
Iteration: 2085, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44637301564216614, gen p mean: -0.054265111684799194, mean p set: 0.44685330986976624
loss_pred:0.013688894920051098, decouple_loss:0.0011857254430651665
The modified gen p mean: 0.44733431935310364, gen p mean: -0.04888217896223068, mean p set: 0.44781461358070374The modified gen p mean: 0.447463721036911, gen p mean: -0.04720183461904526, mean p set: 0.4479440450668335
loss_pred:0.014440094120800495, decouple_loss:0.0010815744753926992
loss_pred:0.013830977492034435, decouple_loss:0.0011123692383989692
Iteration: 2086, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44616711139678955, gen p mean: -0.05162205919623375, mean p set: 0.44664737582206726
loss_pred:0.01392743643373251, decouple_loss:0.001077143824659288
The modified gen p mean: 0.4479690492153168, gen p mean: -0.045106470584869385, mean p set: 0.4484493136405945The modified gen p mean: 0.4473021924495697, gen p mean: -0.05340927094221115, mean p set: 0.4477825164794922
loss_pred:0.013360121287405491, decouple_loss:0.0010892864083871245
loss_pred:0.013839968480169773, decouple_loss:0.0011779589112848043
Iteration: 2087, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447857141494751, gen p mean: -0.04884642735123634, mean p set: 0.4483374059200287
loss_pred:0.013250736519694328, decouple_loss:0.0012217999901622534
The modified gen p mean: 0.44853079319000244, gen p mean: -0.044969238340854645, mean p set: 0.4490111172199249The modified gen p mean: 0.4487875998020172, gen p mean: -0.05082666501402855, mean p set: 0.4492678940296173
loss_pred:0.013218273408710957, decouple_loss:0.0011846666457131505
loss_pred:0.013217639178037643, decouple_loss:0.0011017208453267813
Iteration: 2088, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44783005118370056, gen p mean: -0.044583819806575775, mean p set: 0.44831034541130066
loss_pred:0.01412368193268776, decouple_loss:0.000995753100141883
The modified gen p mean: 0.44781047105789185, gen p mean: -0.04891309514641762, mean p set: 0.44829073548316956The modified gen p mean: 0.4478549063205719, gen p mean: -0.04707366228103638, mean p set: 0.448335200548172
loss_pred:0.01413109339773655, decouple_loss:0.0009521908359602094
loss_pred:0.013218730688095093, decouple_loss:0.0009721086244098842
Iteration: 2089, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44783854484558105, gen p mean: -0.04897362366318703, mean p set: 0.44831880927085876
loss_pred:0.013632770627737045, decouple_loss:0.001119722961448133
The modified gen p mean: 0.44816282391548157, gen p mean: -0.04663413017988205, mean p set: 0.44864311814308167The modified gen p mean: 0.44762372970581055, gen p mean: -0.047320231795310974, mean p set: 0.44810402393341064
loss_pred:0.013382013887166977, decouple_loss:0.001101279049180448
loss_pred:0.01310805045068264, decouple_loss:0.0011131984647363424
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 2090, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482062757015228, gen p mean: -0.04587023705244064, mean p set: 0.4486865699291229
loss_pred:0.013292133808135986, decouple_loss:0.0010156937642022967
The modified gen p mean: 0.44823944568634033, gen p mean: -0.04835541918873787, mean p set: 0.44871973991394043The modified gen p mean: 0.4478556215763092, gen p mean: -0.04295101389288902, mean p set: 0.4483359158039093
loss_pred:0.01366494968533516, decouple_loss:0.001054167514666915
loss_pred:0.013509321957826614, decouple_loss:0.0011376115726307034
2023-05-02 10:30:39 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.04896041005849838, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.044470563530921936, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.04518846049904823, mean p set: 0.4500633478164673
loss_pred:0.01888939179480076, decouple_loss:0.0011230004020035267
loss_pred:0.017779910936951637, decouple_loss:0.0010715979151427746
loss_pred:0.01784982904791832, decouple_loss:0.001135326107032597
WV_0_PC_1_EH_0_PS_40, loss: 0.018228542059659958, avg_mse: 0.026502719148993492
current test mse: 0.026503
Iteration: 2091, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465709626674652, gen p mean: -0.05061649531126022, mean p set: 0.4470512866973877
The modified gen p mean: 0.44830814003944397, gen p mean: -0.046442825347185135, mean p set: 0.44878846406936646
The modified gen p mean: 0.44797733426094055, gen p mean: -0.04264064505696297, mean p set: 0.44845762848854065
loss_pred:0.013279557228088379, decouple_loss:0.0010284610325470567
loss_pred:0.013598554767668247, decouple_loss:0.0009428454213775694
loss_pred:0.013355658389627934, decouple_loss:0.000938968441914767
Iteration: 2092, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44832268357276917, gen p mean: -0.0469091534614563, mean p set: 0.4488029479980469
loss_pred:0.013238674961030483, decouple_loss:0.0011353613808751106
The modified gen p mean: 0.4471516013145447, gen p mean: -0.04085153341293335, mean p set: 0.4476318955421448
The modified gen p mean: 0.4482143521308899, gen p mean: -0.04449355602264404, mean p set: 0.44869464635849
loss_pred:0.013398931361734867, decouple_loss:0.001133161480538547
loss_pred:0.013959307223558426, decouple_loss:0.0011412386083975434
Iteration: 2093, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44811657071113586, gen p mean: -0.04920635744929314, mean p set: 0.4485968351364136
loss_pred:0.01311525609344244, decouple_loss:0.0010754653485491872
The modified gen p mean: 0.448062002658844, gen p mean: -0.043668653815984726, mean p set: 0.4485422670841217The modified gen p mean: 0.4474068582057953, gen p mean: -0.04322350025177002, mean p set: 0.4478871822357178
loss_pred:0.014129821211099625, decouple_loss:0.0010237847454845905
loss_pred:0.013381286524236202, decouple_loss:0.001051381230354309
Iteration: 2094, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44795534014701843, gen p mean: -0.04835603013634682, mean p set: 0.4484356641769409
loss_pred:0.013981700874865055, decouple_loss:0.001097672968171537
The modified gen p mean: 0.4477875232696533, gen p mean: -0.04777268320322037, mean p set: 0.4482678174972534The modified gen p mean: 0.44888073205947876, gen p mean: -0.04893805459141731, mean p set: 0.44936102628707886
loss_pred:0.013439898379147053, decouple_loss:0.0009956390131264925
loss_pred:0.01305127702653408, decouple_loss:0.0010580765083432198
Iteration: 2095, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44791844487190247, gen p mean: -0.045456089079380035, mean p set: 0.44839873909950256
loss_pred:0.01423733215779066, decouple_loss:0.0010835279244929552
The modified gen p mean: 0.44824522733688354, gen p mean: -0.04372819885611534, mean p set: 0.44872552156448364The modified gen p mean: 0.4482244551181793, gen p mean: -0.04269374534487724, mean p set: 0.44870471954345703
loss_pred:0.01407284289598465, decouple_loss:0.0010864317882806063
loss_pred:0.013568699359893799, decouple_loss:0.001141244894824922
Iteration: 2096, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470321238040924, gen p mean: -0.04691961407661438, mean p set: 0.4475124180316925
loss_pred:0.013904132880270481, decouple_loss:0.0011229738593101501
The modified gen p mean: 0.44692254066467285, gen p mean: -0.04877312853932381, mean p set: 0.44740280508995056The modified gen p mean: 0.44800901412963867, gen p mean: -0.0427032932639122, mean p set: 0.44848933815956116
loss_pred:0.013606468215584755, decouple_loss:0.0010300000431016088
loss_pred:0.013193074613809586, decouple_loss:0.0010893137659877539
Iteration: 2097, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44879159331321716, gen p mean: -0.04499698430299759, mean p set: 0.44927188754081726
loss_pred:0.013114206492900848, decouple_loss:0.0011331980349496007
The modified gen p mean: 0.44752660393714905, gen p mean: -0.043019022792577744, mean p set: 0.44800689816474915The modified gen p mean: 0.4477509558200836, gen p mean: -0.040189750492572784, mean p set: 0.44823122024536133
loss_pred:0.013491746038198471, decouple_loss:0.0012299059890210629
loss_pred:0.01378201600164175, decouple_loss:0.0011057349620386958
Iteration: 2098, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479132294654846, gen p mean: -0.04324891418218613, mean p set: 0.4483935534954071
loss_pred:0.01313407439738512, decouple_loss:0.0012141335755586624
The modified gen p mean: 0.4474121034145355, gen p mean: -0.043241046369075775, mean p set: 0.447892427444458The modified gen p mean: 0.44863346219062805, gen p mean: -0.044976696372032166, mean p set: 0.44911372661590576
loss_pred:0.014163143932819366, decouple_loss:0.0011794496094807982
loss_pred:0.013307402841746807, decouple_loss:0.0012421804713085294
Iteration: 2099, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44810548424720764, gen p mean: -0.04290458932518959, mean p set: 0.44858577847480774
loss_pred:0.0134541941806674, decouple_loss:0.001125152106396854
The modified gen p mean: 0.44816482067108154, gen p mean: -0.043230090290308, mean p set: 0.44864511489868164The modified gen p mean: 0.44676509499549866, gen p mean: -0.043095942586660385, mean p set: 0.44724538922309875
loss_pred:0.013607584871351719, decouple_loss:0.0011702760821208358
loss_pred:0.014148997142910957, decouple_loss:0.0012277846690267324
Iteration: 2100, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481227993965149, gen p mean: -0.04508163034915924, mean p set: 0.448603093624115
loss_pred:0.0133431451395154, decouple_loss:0.0012309739831835032
The modified gen p mean: 0.4480210542678833, gen p mean: -0.042791955173015594, mean p set: 0.4485013484954834
The modified gen p mean: 0.44802403450012207, gen p mean: -0.04743782803416252, mean p set: 0.44850432872772217
loss_pred:0.013576660305261612, decouple_loss:0.0011589046334847808
loss_pred:0.012969082221388817, decouple_loss:0.0011464342242106795
2023-05-02 10:32:33 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.047386832535266876, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04272335395216942, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.043356072157621384, mean p set: 0.4500633478164673
loss_pred:0.018897783011198044, decouple_loss:0.0012379813706502318
loss_pred:0.017809966579079628, decouple_loss:0.001266672508791089
loss_pred:0.017857491970062256, decouple_loss:0.001275132643058896
WV_0_PC_1_EH_0_PS_40, loss: 0.018251409754157066, avg_mse: 0.026541462168097496
current test mse: 0.026541
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012004_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012004_3_24hr.npz
NaN value num: 0
Iteration: 2101, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467974007129669, gen p mean: -0.04694077745079994, mean p set: 0.447277694940567
loss_pred:0.017825717106461525, decouple_loss:0.0012640163768082857
The modified gen p mean: 0.4464915096759796, gen p mean: -0.04449092596769333, mean p set: 0.4469718039035797The modified gen p mean: 0.44529518485069275, gen p mean: -0.04712977632880211, mean p set: 0.44577544927597046
loss_pred:0.016986578702926636, decouple_loss:0.0013860968174412847loss_pred:0.016856880858540535, decouple_loss:0.0013106728438287973
Iteration: 2102, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44580167531967163, gen p mean: -0.043925121426582336, mean p set: 0.44628193974494934
The modified gen p mean: 0.44909387826919556, gen p mean: -0.05132636800408363, mean p set: 0.44957417249679565
loss_pred:0.016644369810819626, decouple_loss:0.00124046066775918
loss_pred:0.015650784596800804, decouple_loss:0.0011631324887275696
The modified gen p mean: 0.4468501806259155, gen p mean: -0.048242535442113876, mean p set: 0.4473304748535156
loss_pred:0.017276769503951073, decouple_loss:0.0012081052409484982
Iteration: 2103, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4454835057258606, gen p mean: -0.05193248391151428, mean p set: 0.4459638297557831
loss_pred:0.01700481027364731, decouple_loss:0.0011667626677080989
The modified gen p mean: 0.44696497917175293, gen p mean: -0.050900138914585114, mean p set: 0.4474453032016754
The modified gen p mean: 0.44610947370529175, gen p mean: -0.04765990376472473, mean p set: 0.44658976793289185
loss_pred:0.016634449362754822, decouple_loss:0.0012020195135846734
loss_pred:0.0167947206646204, decouple_loss:0.0011273438576608896
Iteration: 2104, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483610987663269, gen p mean: -0.05481598153710365, mean p set: 0.4488413631916046
loss_pred:0.01729370281100273, decouple_loss:0.0013735487591475248
The modified gen p mean: 0.4480064809322357, gen p mean: -0.04653448984026909, mean p set: 0.4484868049621582The modified gen p mean: 0.4483136534690857, gen p mean: -0.05319724977016449, mean p set: 0.4487939476966858
loss_pred:0.018381034955382347, decouple_loss:0.0012440562713891268
loss_pred:0.017372071743011475, decouple_loss:0.0012498332653194666
Iteration: 2105, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44702309370040894, gen p mean: -0.04932844266295433, mean p set: 0.44750338792800903
loss_pred:0.016663556918501854, decouple_loss:0.0011269907699897885
The modified gen p mean: 0.448622465133667, gen p mean: -0.04828587919473648, mean p set: 0.4491027295589447The modified gen p mean: 0.44449174404144287, gen p mean: -0.05294368416070938, mean p set: 0.4449720084667206
loss_pred:0.0171173308044672, decouple_loss:0.0011030117748305202
loss_pred:0.017059875652194023, decouple_loss:0.0010956384940072894
Iteration: 2106, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475797116756439, gen p mean: -0.05043784901499748, mean p set: 0.4480600357055664
loss_pred:0.017685184255242348, decouple_loss:0.0012159344041720033
The modified gen p mean: 0.448302686214447, gen p mean: -0.05216973274946213, mean p set: 0.4487829804420471The modified gen p mean: 0.44638708233833313, gen p mean: -0.05203433707356453, mean p set: 0.4468673765659332
loss_pred:0.016467943787574768, decouple_loss:0.001236198702827096
loss_pred:0.017008377239108086, decouple_loss:0.0011040237732231617
Iteration: 2107, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44767454266548157, gen p mean: -0.05134827271103859, mean p set: 0.44815483689308167
loss_pred:0.01695851795375347, decouple_loss:0.0011007713619619608
The modified gen p mean: 0.4461188316345215, gen p mean: -0.051975857466459274, mean p set: 0.44659915566444397The modified gen p mean: 0.44626855850219727, gen p mean: -0.05263810232281685, mean p set: 0.44674885272979736
loss_pred:0.016631538048386574, decouple_loss:0.0010304843308404088
loss_pred:0.016501130536198616, decouple_loss:0.0010456324089318514
Iteration: 2108, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44587600231170654, gen p mean: -0.04633596912026405, mean p set: 0.44635626673698425
The modified gen p mean: 0.4467070400714874, gen p mean: -0.05785520002245903, mean p set: 0.44718730449676514
loss_pred:0.016336385160684586, decouple_loss:0.0012838137336075306
loss_pred:0.016515523195266724, decouple_loss:0.001161659019999206
The modified gen p mean: 0.4479103982448578, gen p mean: -0.04889039695262909, mean p set: 0.4483906924724579
loss_pred:0.01718965545296669, decouple_loss:0.0011613507522270083
Iteration: 2109, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465527832508087, gen p mean: -0.04774349555373192, mean p set: 0.4470330774784088
loss_pred:0.016017839312553406, decouple_loss:0.0011939697433263063
The modified gen p mean: 0.44594669342041016, gen p mean: -0.05551164597272873, mean p set: 0.44642698764801025The modified gen p mean: 0.44663774967193604, gen p mean: -0.053126562386751175, mean p set: 0.44711804389953613
loss_pred:0.016582347452640533, decouple_loss:0.0010727294720709324
loss_pred:0.016543468460440636, decouple_loss:0.001107576536014676
Iteration: 2110, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474874436855316, gen p mean: -0.04450006037950516, mean p set: 0.4479677379131317
loss_pred:0.017532765865325928, decouple_loss:0.0011040616082027555
The modified gen p mean: 0.449760377407074, gen p mean: -0.044767290353775024, mean p set: 0.4502406716346741The modified gen p mean: 0.447672039270401, gen p mean: -0.043859221041202545, mean p set: 0.4481523334980011
loss_pred:0.01615879312157631, decouple_loss:0.0010506744729354978
loss_pred:0.01694032922387123, decouple_loss:0.0009761506225913763
2023-05-02 10:35:14 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.047275643795728683, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04271097853779793, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04325518012046814, mean p set: 0.4500633478164673
loss_pred:0.018154608085751534, decouple_loss:0.0012266114354133606
loss_pred:0.017104683443903923, decouple_loss:0.0010948063572868705
loss_pred:0.01717202737927437, decouple_loss:0.0010819308226928115
WV_0_PC_1_EH_0_PS_40, loss: 0.01753382943570614, avg_mse: 0.02509576641023159
current test mse: 0.025096
At step 2110, Best test: 0.025096
save model to /work/09012/haoli1/ls6/ERA5_PredRNN/checkpoints/WV_0_PC_1_EH_0_PS_40/model_test_schedule_sampling_DynaMean.ckpt
Iteration: 2111, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44722214341163635, gen p mean: -0.046650487929582596, mean p set: 0.44770243763923645
loss_pred:0.017110003158450127, decouple_loss:0.0010064303642138839
The modified gen p mean: 0.4473021924495697, gen p mean: -0.0415768176317215, mean p set: 0.4477825164794922The modified gen p mean: 0.4476396441459656, gen p mean: -0.04610457271337509, mean p set: 0.4481199383735657
loss_pred:0.016771763563156128, decouple_loss:0.0010205517755821347loss_pred:0.01661713235080242, decouple_loss:0.0011293848510831594
Iteration: 2112, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481680393218994, gen p mean: -0.047099702060222626, mean p set: 0.4486483037471771
The modified gen p mean: 0.444752037525177, gen p mean: -0.048522986471652985, mean p set: 0.4452323615550995
loss_pred:0.017446042969822884, decouple_loss:0.0011482517002150416
loss_pred:0.016125217080116272, decouple_loss:0.0010083869565278292
The modified gen p mean: 0.4465605318546295, gen p mean: -0.04292161762714386, mean p set: 0.4470408260822296
loss_pred:0.016330884769558907, decouple_loss:0.0010739433346316218
Iteration: 2113, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447294682264328, gen p mean: -0.0491543672978878, mean p set: 0.4477749764919281
loss_pred:0.01747354306280613, decouple_loss:0.0010539493523538113
The modified gen p mean: 0.44864150881767273, gen p mean: -0.051667217165231705, mean p set: 0.44912174344062805The modified gen p mean: 0.44793251156806946, gen p mean: -0.0441090390086174, mean p set: 0.44841283559799194
loss_pred:0.016708336770534515, decouple_loss:0.0010377218713983893
loss_pred:0.017032906413078308, decouple_loss:0.0010489849373698235
Iteration: 2114, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44583219289779663, gen p mean: -0.0515238456428051, mean p set: 0.4463125169277191
loss_pred:0.016657419502735138, decouple_loss:0.0010275242384523153
The modified gen p mean: 0.4471827447414398, gen p mean: -0.050214432179927826, mean p set: 0.4476630687713623The modified gen p mean: 0.4457978904247284, gen p mean: -0.04995037987828255, mean p set: 0.4462781846523285
loss_pred:0.016940699890255928, decouple_loss:0.001035179477185011
loss_pred:0.016393734142184258, decouple_loss:0.0011603105813264847
Iteration: 2115, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481664299964905, gen p mean: -0.05747944116592407, mean p set: 0.4486467242240906
loss_pred:0.01664690487086773, decouple_loss:0.0010520615614950657
The modified gen p mean: 0.4475308656692505, gen p mean: -0.051829416304826736, mean p set: 0.4480111598968506The modified gen p mean: 0.4503893554210663, gen p mean: -0.05587121099233627, mean p set: 0.450869619846344
loss_pred:0.017153209075331688, decouple_loss:0.0009663515374995768
loss_pred:0.015626700595021248, decouple_loss:0.0009613162255845964
Iteration: 2116, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44419872760772705, gen p mean: -0.05759677290916443, mean p set: 0.44467902183532715
loss_pred:0.017023226246237755, decouple_loss:0.001045618555508554
The modified gen p mean: 0.4476347863674164, gen p mean: -0.053358711302280426, mean p set: 0.44811511039733887The modified gen p mean: 0.4480220079421997, gen p mean: -0.055553872138261795, mean p set: 0.4485023021697998
loss_pred:0.01737118512392044, decouple_loss:0.0011354431044310331
loss_pred:0.01707610674202442, decouple_loss:0.00118273647967726
Iteration: 2117, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481375217437744, gen p mean: -0.05053266882896423, mean p set: 0.4486178159713745
loss_pred:0.01738969422876835, decouple_loss:0.0010031143901869655
The modified gen p mean: 0.4499937891960144, gen p mean: -0.0553116537630558, mean p set: 0.4504740536212921The modified gen p mean: 0.44514530897140503, gen p mean: -0.05843212082982063, mean p set: 0.4456256330013275
loss_pred:0.01577717252075672, decouple_loss:0.0009253085008822381
loss_pred:0.016901761293411255, decouple_loss:0.0009658852941356599
Iteration: 2118, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492722451686859, gen p mean: -0.05493283271789551, mean p set: 0.449752539396286
loss_pred:0.01599550060927868, decouple_loss:0.0010140942176803946
The modified gen p mean: 0.4452667832374573, gen p mean: -0.058008208870887756, mean p set: 0.4457470774650574The modified gen p mean: 0.4467148780822754, gen p mean: -0.050279226154088974, mean p set: 0.4471952021121979
loss_pred:0.01619638130068779, decouple_loss:0.0009424200397916138
loss_pred:0.016204124316573143, decouple_loss:0.0009802314452826977
Iteration: 2119, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492434859275818, gen p mean: -0.05076451972126961, mean p set: 0.4497237801551819
The modified gen p mean: 0.4495728313922882, gen p mean: -0.055987630039453506, mean p set: 0.4500530958175659
loss_pred:0.016438305377960205, decouple_loss:0.0009866863256320357
loss_pred:0.015243042260408401, decouple_loss:0.0008848762372508645
The modified gen p mean: 0.4470677375793457, gen p mean: -0.05253538489341736, mean p set: 0.4475480318069458
loss_pred:0.016624312847852707, decouple_loss:0.0009364341967739165
Iteration: 2120, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44853469729423523, gen p mean: -0.04582643508911133, mean p set: 0.4490150213241577
loss_pred:0.017612140625715256, decouple_loss:0.0011183759197592735
The modified gen p mean: 0.44540053606033325, gen p mean: -0.05123312398791313, mean p set: 0.44588083028793335The modified gen p mean: 0.44679969549179077, gen p mean: -0.04997820034623146, mean p set: 0.44727998971939087
loss_pred:0.016441846266388893, decouple_loss:0.001005400437861681
loss_pred:0.016930414363741875, decouple_loss:0.0009423981537111104
2023-05-02 10:37:12 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.05076403170824051, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04598080366849899, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.04684196412563324, mean p set: 0.4500633478164673
loss_pred:0.018139194697141647, decouple_loss:0.001053122105076909
loss_pred:0.01708708144724369, decouple_loss:0.0010468526743352413
loss_pred:0.017175542190670967, decouple_loss:0.0010230094194412231
WV_0_PC_1_EH_0_PS_40, loss: 0.017519323155283928, avg_mse: 0.025072559714317322
current test mse: 0.025073
At step 2120, Best test: 0.025073
save model to /work/09012/haoli1/ls6/ERA5_PredRNN/checkpoints/WV_0_PC_1_EH_0_PS_40/model_test_schedule_sampling_DynaMean.ckpt
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012001_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012001_3_24hr.npz
NaN value num: 0
Iteration: 2121, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476628601551056, gen p mean: -0.04795548692345619, mean p set: 0.4481431543827057
loss_pred:0.014431752264499664, decouple_loss:0.0010417845332995057
The modified gen p mean: 0.44811418652534485, gen p mean: -0.05005522444844246, mean p set: 0.44859448075294495The modified gen p mean: 0.4482642710208893, gen p mean: -0.04964253678917885, mean p set: 0.4487445652484894
loss_pred:0.015422012656927109, decouple_loss:0.0010622373083606362
loss_pred:0.014681924134492874, decouple_loss:0.0009684216929599643
Iteration: 2122, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44653376936912537, gen p mean: -0.04762759432196617, mean p set: 0.44701406359672546
loss_pred:0.014897085726261139, decouple_loss:0.0010079048806801438
The modified gen p mean: 0.4478665292263031, gen p mean: -0.04719632491469383, mean p set: 0.4483468234539032The modified gen p mean: 0.4461544156074524, gen p mean: -0.04966392368078232, mean p set: 0.4466347098350525
loss_pred:0.014338078908622265, decouple_loss:0.0009642371442168951
loss_pred:0.01405513845384121, decouple_loss:0.0009626211831346154
Iteration: 2123, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44720178842544556, gen p mean: -0.04376344755291939, mean p set: 0.44768208265304565
loss_pred:0.014118724502623081, decouple_loss:0.0009846605826169252
The modified gen p mean: 0.44879624247550964, gen p mean: -0.048526786267757416, mean p set: 0.44927650690078735The modified gen p mean: 0.4466207027435303, gen p mean: -0.04589121788740158, mean p set: 0.44710099697113037
loss_pred:0.013884346932172775, decouple_loss:0.0009756592335179448
loss_pred:0.01393082458525896, decouple_loss:0.001045255339704454
Iteration: 2124, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475573003292084, gen p mean: -0.04392807558178902, mean p set: 0.44803762435913086
loss_pred:0.01433086022734642, decouple_loss:0.001150845200754702
The modified gen p mean: 0.44880780577659607, gen p mean: -0.048239316791296005, mean p set: 0.44928810000419617The modified gen p mean: 0.4465905725955963, gen p mean: -0.0458969846367836, mean p set: 0.4470709264278412
loss_pred:0.014405624940991402, decouple_loss:0.0011202901368960738
loss_pred:0.014764953404664993, decouple_loss:0.0011851496528834105
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 2125, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44782647490501404, gen p mean: -0.04353847727179527, mean p set: 0.4483067989349365
loss_pred:0.015024256892502308, decouple_loss:0.0010741937439888716
The modified gen p mean: 0.4470670819282532, gen p mean: -0.0438225157558918, mean p set: 0.44754740595817566The modified gen p mean: 0.44795510172843933, gen p mean: -0.04206734523177147, mean p set: 0.44843539595603943
loss_pred:0.013790939003229141, decouple_loss:0.0011481153778731823
loss_pred:0.01437358744442463, decouple_loss:0.0010660584084689617
Iteration: 2126, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44574248790740967, gen p mean: -0.04477206990122795, mean p set: 0.4462227523326874
loss_pred:0.013448365032672882, decouple_loss:0.0014123948058113456
The modified gen p mean: 0.44815337657928467, gen p mean: -0.0467151403427124, mean p set: 0.4486336410045624The modified gen p mean: 0.44767576456069946, gen p mean: -0.04139866307377815, mean p set: 0.44815605878829956
loss_pred:0.013798743486404419, decouple_loss:0.0012264688266441226
loss_pred:0.013647313229739666, decouple_loss:0.0011905301362276077
Iteration: 2127, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44799819588661194, gen p mean: -0.04434703662991524, mean p set: 0.44847849011421204
loss_pred:0.01368209533393383, decouple_loss:0.0011704402277246118
The modified gen p mean: 0.4455767571926117, gen p mean: -0.046895548701286316, mean p set: 0.4460570514202118The modified gen p mean: 0.44865885376930237, gen p mean: -0.05003469064831734, mean p set: 0.44913914799690247
loss_pred:0.013255433179438114, decouple_loss:0.0012878264533355832
loss_pred:0.014003339223563671, decouple_loss:0.0011469930177554488
Iteration: 2128, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473060071468353, gen p mean: -0.045661717653274536, mean p set: 0.44778627157211304
loss_pred:0.013962137512862682, decouple_loss:0.001384145230986178
The modified gen p mean: 0.44775256514549255, gen p mean: -0.0472731739282608, mean p set: 0.44823282957077026The modified gen p mean: 0.4470917880535126, gen p mean: -0.045188501477241516, mean p set: 0.44757208228111267
loss_pred:0.014267964288592339, decouple_loss:0.0013670965563505888
loss_pred:0.01334067527204752, decouple_loss:0.0011977643007412553
Iteration: 2129, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44523462653160095, gen p mean: -0.049491334706544876, mean p set: 0.44571492075920105
loss_pred:0.013151518069207668, decouple_loss:0.0012837302638217807
The modified gen p mean: 0.448044091463089, gen p mean: -0.04437771439552307, mean p set: 0.4485243558883667The modified gen p mean: 0.44601139426231384, gen p mean: -0.0448145754635334, mean p set: 0.44649171829223633
loss_pred:0.013316227123141289, decouple_loss:0.001228776527568698
loss_pred:0.014299395494163036, decouple_loss:0.00126415875274688
Iteration: 2130, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4462290108203888, gen p mean: -0.04999246820807457, mean p set: 0.4467092752456665
loss_pred:0.014202739112079144, decouple_loss:0.0012046274496242404
The modified gen p mean: 0.4481727182865143, gen p mean: -0.04885927960276604, mean p set: 0.4486530125141144The modified gen p mean: 0.44843393564224243, gen p mean: -0.05277661979198456, mean p set: 0.4489142596721649
loss_pred:0.01493767648935318, decouple_loss:0.0012457802658900619
loss_pred:0.013666295446455479, decouple_loss:0.0012660376960411668
2023-05-02 10:40:01 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.050950463861227036, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.046162962913513184, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.047097817063331604, mean p set: 0.4500633478164673
loss_pred:0.01898615062236786, decouple_loss:0.0013341777957975864
loss_pred:0.01781083084642887, decouple_loss:0.001333418651483953
loss_pred:0.017920436337590218, decouple_loss:0.0013475376181304455
WV_0_PC_1_EH_0_PS_40, loss: 0.018306057900190353, avg_mse: 0.026539061218500137
current test mse: 0.026539
Iteration: 2131, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466317892074585, gen p mean: -0.049253255128860474, mean p set: 0.4471120834350586
The modified gen p mean: 0.447226345539093, gen p mean: -0.04967368766665459, mean p set: 0.4477066397666931
The modified gen p mean: 0.4472421705722809, gen p mean: -0.047705769538879395, mean p set: 0.44772249460220337
loss_pred:0.014040669426321983, decouple_loss:0.0013174868654459715
loss_pred:0.013802747242152691, decouple_loss:0.0013284798478707671
loss_pred:0.014013835228979588, decouple_loss:0.0012312051840126514
Iteration: 2132, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44603416323661804, gen p mean: -0.05109919235110283, mean p set: 0.44651445746421814
loss_pred:0.012935447506606579, decouple_loss:0.0014518683310598135
The modified gen p mean: 0.44825175404548645, gen p mean: -0.047027140855789185, mean p set: 0.44873204827308655The modified gen p mean: 0.44694462418556213, gen p mean: -0.051922496408224106, mean p set: 0.44742488861083984
loss_pred:0.014359335415065289, decouple_loss:0.0013811796670779586
loss_pred:0.013422472402453423, decouple_loss:0.0012758533703163266
Iteration: 2133, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44639313220977783, gen p mean: -0.04919911175966263, mean p set: 0.44687342643737793
loss_pred:0.014129634946584702, decouple_loss:0.0012650596909224987
The modified gen p mean: 0.4486105442047119, gen p mean: -0.051517266780138016, mean p set: 0.449090838432312The modified gen p mean: 0.4470219612121582, gen p mean: -0.04879339039325714, mean p set: 0.4475022256374359
loss_pred:0.01332674827426672, decouple_loss:0.0012641490902751684
loss_pred:0.013453633524477482, decouple_loss:0.0011845682747662067
Iteration: 2134, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44648081064224243, gen p mean: -0.04601964354515076, mean p set: 0.44696107506752014
loss_pred:0.013927548192441463, decouple_loss:0.001241080928593874
The modified gen p mean: 0.4468750059604645, gen p mean: -0.045663248747587204, mean p set: 0.4473552703857422The modified gen p mean: 0.44699421525001526, gen p mean: -0.04760804399847984, mean p set: 0.44747447967529297
loss_pred:0.013616696000099182, decouple_loss:0.0014243591576814651
loss_pred:0.013771187514066696, decouple_loss:0.0012854018714278936
Iteration: 2135, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467604160308838, gen p mean: -0.04448321461677551, mean p set: 0.4472406804561615
loss_pred:0.013766667805612087, decouple_loss:0.0012231620494276285
The modified gen p mean: 0.4470854103565216, gen p mean: -0.044977039098739624, mean p set: 0.4475656747817993The modified gen p mean: 0.4475002884864807, gen p mean: -0.04751991480588913, mean p set: 0.4479806125164032
loss_pred:0.013709258288145065, decouple_loss:0.0012359371175989509
loss_pred:0.013644914142787457, decouple_loss:0.0012491774978116155
Iteration: 2136, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464447498321533, gen p mean: -0.04523815959692001, mean p set: 0.4469250440597534
loss_pred:0.014110968448221684, decouple_loss:0.0012794636422768235
The modified gen p mean: 0.4481518268585205, gen p mean: -0.04529661312699318, mean p set: 0.4486321210861206The modified gen p mean: 0.44723355770111084, gen p mean: -0.042334627360105515, mean p set: 0.4477138817310333
loss_pred:0.013471142388880253, decouple_loss:0.0012802939163520932
loss_pred:0.013580597937107086, decouple_loss:0.0010699069825932384
Iteration: 2137, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44639071822166443, gen p mean: -0.04409541189670563, mean p set: 0.44687098264694214
loss_pred:0.013308241963386536, decouple_loss:0.0011349028209224343
The modified gen p mean: 0.44881632924079895, gen p mean: -0.046731967478990555, mean p set: 0.44929662346839905The modified gen p mean: 0.4459710121154785, gen p mean: -0.045036543160676956, mean p set: 0.4464513063430786
loss_pred:0.013972162269055843, decouple_loss:0.0011705313809216022
loss_pred:0.013200256042182446, decouple_loss:0.0011481731198728085
Iteration: 2138, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474366009235382, gen p mean: -0.038139812648296356, mean p set: 0.4479168951511383
loss_pred:0.013105642981827259, decouple_loss:0.0011878055520355701
The modified gen p mean: 0.4479070007801056, gen p mean: -0.04454575106501579, mean p set: 0.4483872950077057The modified gen p mean: 0.4466645419597626, gen p mean: -0.04252002760767937, mean p set: 0.44714486598968506
loss_pred:0.013370570726692677, decouple_loss:0.0011429048608988523
loss_pred:0.013656504452228546, decouple_loss:0.0010354935657233
Iteration: 2139, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483518898487091, gen p mean: -0.04085822403430939, mean p set: 0.4488321542739868
loss_pred:0.013250916264951229, decouple_loss:0.0011255410499870777
The modified gen p mean: 0.44770726561546326, gen p mean: -0.04427099600434303, mean p set: 0.44818755984306335The modified gen p mean: 0.447291761636734, gen p mean: -0.03948773443698883, mean p set: 0.4477720260620117
loss_pred:0.01324787363409996, decouple_loss:0.0012599083129316568
loss_pred:0.013508006930351257, decouple_loss:0.0011044566053897142
Iteration: 2140, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44669002294540405, gen p mean: -0.0446891225874424, mean p set: 0.44717034697532654
loss_pred:0.013836194761097431, decouple_loss:0.0012311709579080343
The modified gen p mean: 0.44729164242744446, gen p mean: -0.03921470791101456, mean p set: 0.44777190685272217The modified gen p mean: 0.44901183247566223, gen p mean: -0.046320851892232895, mean p set: 0.44949212670326233
loss_pred:0.013041386380791664, decouple_loss:0.0010992232710123062
loss_pred:0.013296788558363914, decouple_loss:0.0011402351083233953
2023-05-02 10:41:57 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.04462167248129845, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04036716744303703, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.04083116352558136, mean p set: 0.4500633478164673
loss_pred:0.017808720469474792, decouple_loss:0.001175660640001297
loss_pred:0.01898217387497425, decouple_loss:0.0011462913826107979
loss_pred:0.017911817878484726, decouple_loss:0.0011178920976817608
WV_0_PC_1_EH_0_PS_40, loss: 0.018291570246219635, avg_mse: 0.026599524542689323
current test mse: 0.0266
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012010_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012010_3_24hr.npz
NaN value num: 0
Iteration: 2141, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478965699672699, gen p mean: -0.04194776341319084, mean p set: 0.44837686419487
loss_pred:0.01789100095629692, decouple_loss:0.0011013895273208618
The modified gen p mean: 0.448029100894928, gen p mean: -0.04383540526032448, mean p set: 0.4485093653202057The modified gen p mean: 0.44738319516181946, gen p mean: -0.042871903628110886, mean p set: 0.44786348938941956
loss_pred:0.01785360462963581, decouple_loss:0.0011054641800001264
loss_pred:0.017206938937306404, decouple_loss:0.001203059102408588
Iteration: 2142, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44687870144844055, gen p mean: -0.04633599892258644, mean p set: 0.4473590552806854
loss_pred:0.0170780960470438, decouple_loss:0.001259982818737626
The modified gen p mean: 0.44859179854393005, gen p mean: -0.04395274817943573, mean p set: 0.44907209277153015The modified gen p mean: 0.44634953141212463, gen p mean: -0.04207533970475197, mean p set: 0.44682982563972473
loss_pred:0.017556987702846527, decouple_loss:0.0011620012810453773
loss_pred:0.016209162771701813, decouple_loss:0.0012170032132416964
Iteration: 2143, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44757428765296936, gen p mean: -0.04463847354054451, mean p set: 0.44805458188056946
loss_pred:0.016195084899663925, decouple_loss:0.0011196506675332785
The modified gen p mean: 0.4495382308959961, gen p mean: -0.04433983936905861, mean p set: 0.4500185549259186The modified gen p mean: 0.4474946856498718, gen p mean: -0.040205661207437515, mean p set: 0.4479750096797943
loss_pred:0.017032625153660774, decouple_loss:0.0012150288093835115
loss_pred:0.01775912195444107, decouple_loss:0.0011656773276627064
Iteration: 2144, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44763636589050293, gen p mean: -0.04181632027029991, mean p set: 0.448116660118103
loss_pred:0.018265500664711, decouple_loss:0.00113432586658746
The modified gen p mean: 0.44926369190216064, gen p mean: -0.047401316463947296, mean p set: 0.44974398612976074The modified gen p mean: 0.4479250907897949, gen p mean: -0.040593624114990234, mean p set: 0.4484054148197174
loss_pred:0.01691603846848011, decouple_loss:0.0012645432725548744
loss_pred:0.017897648736834526, decouple_loss:0.001301577198319137
Iteration: 2145, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44706299901008606, gen p mean: -0.041298430413007736, mean p set: 0.44754326343536377
loss_pred:0.017010146751999855, decouple_loss:0.0011129612103104591
The modified gen p mean: 0.4475911259651184, gen p mean: -0.04141133651137352, mean p set: 0.4480714499950409The modified gen p mean: 0.4463266134262085, gen p mean: -0.046020641922950745, mean p set: 0.4468069076538086
loss_pred:0.017174314707517624, decouple_loss:0.0010665137087926269
loss_pred:0.016446752473711967, decouple_loss:0.0010245856828987598
Iteration: 2146, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44886574149131775, gen p mean: -0.04117041081190109, mean p set: 0.44934606552124023
loss_pred:0.017454713582992554, decouple_loss:0.0011917991796508431
The modified gen p mean: 0.44866013526916504, gen p mean: -0.04511333256959915, mean p set: 0.44914042949676514The modified gen p mean: 0.44862696528434753, gen p mean: -0.044404156506061554, mean p set: 0.44910722970962524
loss_pred:0.017690245062112808, decouple_loss:0.001136022969149053
loss_pred:0.016784556210041046, decouple_loss:0.0012314304476603866
Iteration: 2147, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446316123008728, gen p mean: -0.043416578322649, mean p set: 0.4467964172363281
loss_pred:0.016683466732501984, decouple_loss:0.0010910360142588615
The modified gen p mean: 0.44797375798225403, gen p mean: -0.04376951605081558, mean p set: 0.4484540522098541The modified gen p mean: 0.4469502568244934, gen p mean: -0.041526030749082565, mean p set: 0.4474305510520935
loss_pred:0.01685820333659649, decouple_loss:0.0011188231874257326
loss_pred:0.01663006655871868, decouple_loss:0.0010443928185850382
Iteration: 2148, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469698369503021, gen p mean: -0.04289970546960831, mean p set: 0.44745010137557983
loss_pred:0.017946314066648483, decouple_loss:0.0011380704818293452
The modified gen p mean: 0.4462946653366089, gen p mean: -0.03983032703399658, mean p set: 0.446774959564209The modified gen p mean: 0.44793370366096497, gen p mean: -0.04046780243515968, mean p set: 0.44841399788856506
loss_pred:0.017086906358599663, decouple_loss:0.0012021316215395927
loss_pred:0.0175004992634058, decouple_loss:0.0012044321047142148
Iteration: 2149, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44695374369621277, gen p mean: -0.045038267970085144, mean p set: 0.44743403792381287
loss_pred:0.017690720036625862, decouple_loss:0.0010397714795544744
The modified gen p mean: 0.44698894023895264, gen p mean: -0.04037081450223923, mean p set: 0.4474692642688751The modified gen p mean: 0.4469059705734253, gen p mean: -0.04139164462685585, mean p set: 0.447386234998703
loss_pred:0.01781289465725422, decouple_loss:0.0010200024116784334
loss_pred:0.016632908955216408, decouple_loss:0.0011187706841155887
Iteration: 2150, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44780808687210083, gen p mean: -0.043419014662504196, mean p set: 0.4482884109020233
loss_pred:0.01653505302965641, decouple_loss:0.0011830796720460057
The modified gen p mean: 0.4465072751045227, gen p mean: -0.044241443276405334, mean p set: 0.4469875395298004The modified gen p mean: 0.44661229848861694, gen p mean: -0.03948669508099556, mean p set: 0.44709256291389465
loss_pred:0.01692313142120838, decouple_loss:0.0012668800773099065
loss_pred:0.016919447109103203, decouple_loss:0.0011684317141771317
2023-05-02 10:44:29 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.044122811406850815, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.03964562341570854, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04020879417657852, mean p set: 0.4500633478164673
loss_pred:0.018312959000468254, decouple_loss:0.001131251803599298
loss_pred:0.01725705713033676, decouple_loss:0.0011982127325609326
loss_pred:0.017292741686105728, decouple_loss:0.0011166413314640522
WV_0_PC_1_EH_0_PS_40, loss: 0.017678355798125267, avg_mse: 0.025365417823195457
current test mse: 0.025365
Iteration: 2151, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474125802516937, gen p mean: -0.04089330509305, mean p set: 0.4478928744792938
The modified gen p mean: 0.44771096110343933, gen p mean: -0.043612170964479446, mean p set: 0.44819125533103943
The modified gen p mean: 0.44860222935676575, gen p mean: -0.042735204100608826, mean p set: 0.44908249378204346
loss_pred:0.016751639544963837, decouple_loss:0.0010745240142568946
loss_pred:0.017595402896404266, decouple_loss:0.0011413194006308913loss_pred:0.01596386916935444, decouple_loss:0.001079103327356279
Iteration: 2152, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490973949432373, gen p mean: -0.040697935968637466, mean p set: 0.4495777189731598
loss_pred:0.017458375543355942, decouple_loss:0.0013181682443246245
The modified gen p mean: 0.4475124478340149, gen p mean: -0.04365826025605202, mean p set: 0.447992742061615The modified gen p mean: 0.4485020637512207, gen p mean: -0.043094735592603683, mean p set: 0.4489823877811432
loss_pred:0.01689261943101883, decouple_loss:0.0012455550022423267
loss_pred:0.017354412004351616, decouple_loss:0.0011213215766474605
Iteration: 2153, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44768568873405457, gen p mean: -0.0402652770280838, mean p set: 0.44816598296165466
loss_pred:0.017478635534644127, decouple_loss:0.0010239934781566262
The modified gen p mean: 0.4466244876384735, gen p mean: -0.0446552038192749, mean p set: 0.447104811668396The modified gen p mean: 0.4476429224014282, gen p mean: -0.04191819950938225, mean p set: 0.4481232166290283
loss_pred:0.016147086396813393, decouple_loss:0.001042159623466432
loss_pred:0.016015540808439255, decouple_loss:0.0011109807528555393
Iteration: 2154, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44806918501853943, gen p mean: -0.04276007041335106, mean p set: 0.4485495090484619
loss_pred:0.01763477921485901, decouple_loss:0.0011228829389438033
The modified gen p mean: 0.4477812349796295, gen p mean: -0.03974136710166931, mean p set: 0.4482615292072296The modified gen p mean: 0.4479468762874603, gen p mean: -0.04480881243944168, mean p set: 0.4484272003173828
loss_pred:0.01695474050939083, decouple_loss:0.0011087656021118164
loss_pred:0.017451608553528786, decouple_loss:0.0011306020896881819
Iteration: 2155, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44697925448417664, gen p mean: -0.039710238575935364, mean p set: 0.4474595785140991
loss_pred:0.015933571383357048, decouple_loss:0.0010282284347340465
The modified gen p mean: 0.4474639296531677, gen p mean: -0.04072904586791992, mean p set: 0.4479442238807678The modified gen p mean: 0.4467772841453552, gen p mean: -0.04129965975880623, mean p set: 0.4472576081752777
loss_pred:0.016393285244703293, decouple_loss:0.0010938788764178753
loss_pred:0.016228308901190758, decouple_loss:0.001141305547207594
Iteration: 2156, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499262869358063, gen p mean: -0.04480700194835663, mean p set: 0.45040658116340637
loss_pred:0.016469629481434822, decouple_loss:0.0011634747497737408
The modified gen p mean: 0.44730207324028015, gen p mean: -0.04143436998128891, mean p set: 0.44778236746788025The modified gen p mean: 0.4472706615924835, gen p mean: -0.041917867958545685, mean p set: 0.4477509558200836
loss_pred:0.017778944224119186, decouple_loss:0.0010572891915217042
loss_pred:0.01695525273680687, decouple_loss:0.0009750937460921705
Iteration: 2157, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468501806259155, gen p mean: -0.039136290550231934, mean p set: 0.4473304748535156
loss_pred:0.017073102295398712, decouple_loss:0.0011108022881671786
The modified gen p mean: 0.4478977620601654, gen p mean: -0.04217017441987991, mean p set: 0.4483780562877655The modified gen p mean: 0.44722703099250793, gen p mean: -0.0413193441927433, mean p set: 0.44770732522010803
loss_pred:0.016548320651054382, decouple_loss:0.000978377414867282
loss_pred:0.016007591038942337, decouple_loss:0.0010771392844617367
Iteration: 2158, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44795945286750793, gen p mean: -0.037814006209373474, mean p set: 0.44843971729278564
loss_pred:0.01698540523648262, decouple_loss:0.0009614802547730505
The modified gen p mean: 0.44684475660324097, gen p mean: -0.04359578341245651, mean p set: 0.44732505083084106
The modified gen p mean: 0.4468751847743988, gen p mean: -0.041459619998931885, mean p set: 0.4473554790019989
loss_pred:0.017055056989192963, decouple_loss:0.0009601553319953382
loss_pred:0.015876391902565956, decouple_loss:0.0010529266437515616
Iteration: 2159, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44669780135154724, gen p mean: -0.044207632541656494, mean p set: 0.44717806577682495
loss_pred:0.01712946966290474, decouple_loss:0.0010193022899329662
The modified gen p mean: 0.44763439893722534, gen p mean: -0.04195737838745117, mean p set: 0.44811463356018066The modified gen p mean: 0.4465520977973938, gen p mean: -0.0405157245695591, mean p set: 0.4470323920249939
loss_pred:0.017497900873422623, decouple_loss:0.001074793515726924
loss_pred:0.016717592254281044, decouple_loss:0.0010920192580670118
Iteration: 2160, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479115903377533, gen p mean: -0.04527587816119194, mean p set: 0.448391854763031
loss_pred:0.017293371260166168, decouple_loss:0.0010017658350989223
The modified gen p mean: 0.4477614462375641, gen p mean: -0.04235483705997467, mean p set: 0.4482417702674866The modified gen p mean: 0.4465983510017395, gen p mean: -0.04648198187351227, mean p set: 0.4470786452293396
loss_pred:0.016878245398402214, decouple_loss:0.0010916531318798661
loss_pred:0.01691831834614277, decouple_loss:0.0009142323979176581
2023-05-02 10:46:26 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.047746218740940094, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04315214231610298, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04389600083231926, mean p set: 0.4500633478164673
loss_pred:0.018185384571552277, decouple_loss:0.0010863066418096423
loss_pred:0.017136480659246445, decouple_loss:0.0011744063813239336
loss_pred:0.017178412526845932, decouple_loss:0.0011163235176354647
WV_0_PC_1_EH_0_PS_40, loss: 0.01755637675523758, avg_mse: 0.02515062503516674
current test mse: 0.025151
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012002_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012002_3_24hr.npz
NaN value num: 0
Iteration: 2161, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44856277108192444, gen p mean: -0.0429142527282238, mean p set: 0.44904303550720215
loss_pred:0.014503136277198792, decouple_loss:0.0011015706695616245
The modified gen p mean: 0.4499562680721283, gen p mean: -0.03406543657183647, mean p set: 0.4504365622997284The modified gen p mean: 0.4484012722969055, gen p mean: -0.04194562882184982, mean p set: 0.4488815367221832
loss_pred:0.013964761979877949, decouple_loss:0.0011244990164414048
loss_pred:0.015110817737877369, decouple_loss:0.0011189487995579839
Iteration: 2162, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44862765073776245, gen p mean: -0.04852550849318504, mean p set: 0.44910797476768494
loss_pred:0.013705992139875889, decouple_loss:0.0012328772572800517
The modified gen p mean: 0.44961124658584595, gen p mean: -0.04899342730641365, mean p set: 0.45009157061576843The modified gen p mean: 0.44836610555648804, gen p mean: -0.04741523414850235, mean p set: 0.44884639978408813
loss_pred:0.014001182280480862, decouple_loss:0.0011904877610504627
loss_pred:0.013625117018818855, decouple_loss:0.0011916584335267544
Iteration: 2163, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469147026538849, gen p mean: -0.04470786824822426, mean p set: 0.447394996881485
loss_pred:0.013536471873521805, decouple_loss:0.0011303839273750782
The modified gen p mean: 0.4490821361541748, gen p mean: -0.047864049673080444, mean p set: 0.4495624303817749The modified gen p mean: 0.4475484788417816, gen p mean: -0.045284826308488846, mean p set: 0.4480287730693817
loss_pred:0.013968439772725105, decouple_loss:0.001185835455544293
loss_pred:0.015001329593360424, decouple_loss:0.0011101001873612404
Iteration: 2164, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493548274040222, gen p mean: -0.04854103550314903, mean p set: 0.4498351216316223
loss_pred:0.013737211003899574, decouple_loss:0.0011127264006063342
The modified gen p mean: 0.4474162459373474, gen p mean: -0.048462413251399994, mean p set: 0.4478965699672699
The modified gen p mean: 0.4489430785179138, gen p mean: -0.04917416349053383, mean p set: 0.4494233727455139
loss_pred:0.01388140581548214, decouple_loss:0.0011606775224208832
loss_pred:0.014000939205288887, decouple_loss:0.0012765738647431135
Iteration: 2165, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44811615347862244, gen p mean: -0.046874020248651505, mean p set: 0.44859644770622253
loss_pred:0.013562646694481373, decouple_loss:0.0012217204784974456
The modified gen p mean: 0.44979915022850037, gen p mean: -0.04493052884936333, mean p set: 0.4502794146537781The modified gen p mean: 0.4472678005695343, gen p mean: -0.0426233671605587, mean p set: 0.447748064994812
loss_pred:0.013770612888038158, decouple_loss:0.0011527836322784424
loss_pred:0.013601193204522133, decouple_loss:0.0012117912992835045
Iteration: 2166, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44755738973617554, gen p mean: -0.04441811516880989, mean p set: 0.44803765416145325
loss_pred:0.013751901686191559, decouple_loss:0.0011149827623739839
The modified gen p mean: 0.4474972188472748, gen p mean: -0.04462020844221115, mean p set: 0.4479774832725525The modified gen p mean: 0.4474325478076935, gen p mean: -0.042104337364435196, mean p set: 0.4479128420352936
loss_pred:0.013455095700919628, decouple_loss:0.0011696475557982922
loss_pred:0.013616318814456463, decouple_loss:0.001223927945829928
Iteration: 2167, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490068554878235, gen p mean: -0.04881376773118973, mean p set: 0.4494871497154236
loss_pred:0.01251603290438652, decouple_loss:0.0013841318432241678
The modified gen p mean: 0.45075008273124695, gen p mean: -0.03780021518468857, mean p set: 0.45123034715652466The modified gen p mean: 0.4472696781158447, gen p mean: -0.04669542983174324, mean p set: 0.4477499723434448
loss_pred:0.013513454236090183, decouple_loss:0.0013265310553833842
loss_pred:0.013673825189471245, decouple_loss:0.0013732241932302713
Iteration: 2168, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44872623682022095, gen p mean: -0.04585246741771698, mean p set: 0.44920656085014343
loss_pred:0.013472759164869785, decouple_loss:0.001261852215975523
The modified gen p mean: 0.447256863117218, gen p mean: -0.03969832882285118, mean p set: 0.4477371871471405The modified gen p mean: 0.4476976692676544, gen p mean: -0.04002212733030319, mean p set: 0.4481779932975769
loss_pred:0.013721032999455929, decouple_loss:0.001201142673380673
loss_pred:0.0142510449513793, decouple_loss:0.0012390367919579148
Iteration: 2169, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486274719238281, gen p mean: -0.04278919845819473, mean p set: 0.44910773634910583
loss_pred:0.012957560829818249, decouple_loss:0.0011800196953117847
The modified gen p mean: 0.4488057494163513, gen p mean: -0.03867644444108009, mean p set: 0.4492860734462738The modified gen p mean: 0.4501930773258209, gen p mean: -0.03562956303358078, mean p set: 0.45067334175109863
loss_pred:0.013531695120036602, decouple_loss:0.0012060388689860702
loss_pred:0.013448628596961498, decouple_loss:0.001229860121384263
Iteration: 2170, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478560984134674, gen p mean: -0.04699382185935974, mean p set: 0.4483363628387451
loss_pred:0.013618496246635914, decouple_loss:0.0011632166570052505
The modified gen p mean: 0.4490741193294525, gen p mean: -0.038418516516685486, mean p set: 0.449554443359375The modified gen p mean: 0.4489038288593292, gen p mean: -0.04226348549127579, mean p set: 0.4493841528892517
loss_pred:0.013603012077510357, decouple_loss:0.0011590530630201101
loss_pred:0.013521402142941952, decouple_loss:0.0011739960173144937
2023-05-02 10:48:55 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.05088037997484207, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04671803116798401, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04730617627501488, mean p set: 0.4500633478164673
loss_pred:0.019318319857120514, decouple_loss:0.0011685332283377647
loss_pred:0.018071653321385384, decouple_loss:0.0011776317842304707
loss_pred:0.018114177510142326, decouple_loss:0.00116710492875427
WV_0_PC_1_EH_0_PS_40, loss: 0.018559938296675682, avg_mse: 0.027048205956816673
current test mse: 0.027048
Iteration: 2171, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471129775047302, gen p mean: -0.0525607168674469, mean p set: 0.4475933015346527
The modified gen p mean: 0.4467901885509491, gen p mean: -0.04886997491121292, mean p set: 0.4472704529762268
The modified gen p mean: 0.44837766885757446, gen p mean: -0.046600207686424255, mean p set: 0.44885799288749695
loss_pred:0.013251365162432194, decouple_loss:0.0011652441462501884
loss_pred:0.013790391385555267, decouple_loss:0.001218812307342887
loss_pred:0.013482042588293552, decouple_loss:0.0012225001119077206
Iteration: 2172, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44975852966308594, gen p mean: -0.047395966947078705, mean p set: 0.45023879408836365
loss_pred:0.01340241264551878, decouple_loss:0.0012474325485527515
The modified gen p mean: 0.4479535222053528, gen p mean: -0.04819807782769203, mean p set: 0.44843384623527527The modified gen p mean: 0.44798243045806885, gen p mean: -0.04839983582496643, mean p set: 0.44846272468566895
loss_pred:0.012549099512398243, decouple_loss:0.001393306185491383
loss_pred:0.013483203016221523, decouple_loss:0.0012048743665218353
Iteration: 2173, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44841745495796204, gen p mean: -0.04372614994645119, mean p set: 0.44889771938323975
loss_pred:0.01395395677536726, decouple_loss:0.0012254404136911035
The modified gen p mean: 0.44738543033599854, gen p mean: -0.04422925412654877, mean p set: 0.44786569476127625The modified gen p mean: 0.44819745421409607, gen p mean: -0.04885957017540932, mean p set: 0.44867774844169617
loss_pred:0.013352870009839535, decouple_loss:0.0012440740829333663
loss_pred:0.012929844669997692, decouple_loss:0.0012200261699035764
Iteration: 2174, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44785282015800476, gen p mean: -0.04263817518949509, mean p set: 0.44833314418792725
loss_pred:0.013810655102133751, decouple_loss:0.0012093600817024708
The modified gen p mean: 0.4481935501098633, gen p mean: -0.04984195530414581, mean p set: 0.44867387413978577The modified gen p mean: 0.4491240084171295, gen p mean: -0.05126267299056053, mean p set: 0.4496042728424072
loss_pred:0.012229248881340027, decouple_loss:0.001216523814946413
loss_pred:0.013144363649189472, decouple_loss:0.0011795222526416183
Iteration: 2175, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474261701107025, gen p mean: -0.048003703355789185, mean p set: 0.4479064643383026
loss_pred:0.01322763692587614, decouple_loss:0.0012015558313578367
The modified gen p mean: 0.448076993227005, gen p mean: -0.04349939152598381, mean p set: 0.4485572874546051The modified gen p mean: 0.4486962556838989, gen p mean: -0.04403000697493553, mean p set: 0.449176549911499
loss_pred:0.01343819685280323, decouple_loss:0.001287568360567093
loss_pred:0.013397319242358208, decouple_loss:0.0012575703440234065
Iteration: 2176, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476599097251892, gen p mean: -0.044898126274347305, mean p set: 0.4481402039527893
loss_pred:0.013060941360890865, decouple_loss:0.0011174386600032449
The modified gen p mean: 0.4488906264305115, gen p mean: -0.04761989414691925, mean p set: 0.4493709206581116The modified gen p mean: 0.44972044229507446, gen p mean: -0.05046609789133072, mean p set: 0.45020073652267456
loss_pred:0.013258155435323715, decouple_loss:0.0012156051816418767
loss_pred:0.012460659258067608, decouple_loss:0.0012478212593123317
Iteration: 2177, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489346146583557, gen p mean: -0.04633127897977829, mean p set: 0.4494149386882782
loss_pred:0.01316328439861536, decouple_loss:0.0011589077766984701
The modified gen p mean: 0.44766315817832947, gen p mean: -0.041698575019836426, mean p set: 0.44814345240592957The modified gen p mean: 0.4497550427913666, gen p mean: -0.03711293637752533, mean p set: 0.4502353370189667
loss_pred:0.013706986792385578, decouple_loss:0.001183239626698196
loss_pred:0.01317406352609396, decouple_loss:0.0011994399828836322
Iteration: 2178, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473476707935333, gen p mean: -0.040456391870975494, mean p set: 0.44782793521881104
loss_pred:0.013577839359641075, decouple_loss:0.001150116790086031
The modified gen p mean: 0.448194295167923, gen p mean: -0.04302719235420227, mean p set: 0.44867458939552307The modified gen p mean: 0.4500373601913452, gen p mean: -0.03705502301454544, mean p set: 0.4505176842212677
loss_pred:0.013679354451596737, decouple_loss:0.0012054532999172807
loss_pred:0.01285177655518055, decouple_loss:0.0011469272430986166
Iteration: 2179, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488476812839508, gen p mean: -0.050372399389743805, mean p set: 0.4493279755115509
loss_pred:0.012284539639949799, decouple_loss:0.0011989568592980504
The modified gen p mean: 0.4466942548751831, gen p mean: -0.0497976653277874, mean p set: 0.447174608707428
The modified gen p mean: 0.44839343428611755, gen p mean: -0.044400833547115326, mean p set: 0.44887375831604004
loss_pred:0.013493181206285954, decouple_loss:0.0010929132113233209
loss_pred:0.013827087357640266, decouple_loss:0.00109070201870054
Iteration: 2180, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4516567587852478, gen p mean: -0.04129626601934433, mean p set: 0.4521370232105255
loss_pred:0.013217940926551819, decouple_loss:0.001423067064024508
The modified gen p mean: 0.44915971159935, gen p mean: -0.04839956760406494, mean p set: 0.4496400058269501
The modified gen p mean: 0.44875746965408325, gen p mean: -0.04560740292072296, mean p set: 0.44923779368400574
loss_pred:0.013075847178697586, decouple_loss:0.0013362077297642827
loss_pred:0.013390512205660343, decouple_loss:0.001144978916272521
2023-05-02 10:50:50 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.04825090244412422, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.044064782559871674, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04446203634142876, mean p set: 0.4500633478164673
loss_pred:0.01914762705564499, decouple_loss:0.001140244072303176
loss_pred:0.017965499311685562, decouple_loss:0.001230420428328216
loss_pred:0.017972970381379128, decouple_loss:0.0012254099128767848
WV_0_PC_1_EH_0_PS_40, loss: 0.018421968445181847, avg_mse: 0.02685018628835678
current test mse: 0.02685
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012013_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012013_3_24hr.npz
NaN value num: 0
Iteration: 2181, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45018118619918823, gen p mean: -0.04617968201637268, mean p set: 0.45066148042678833
loss_pred:0.016347555443644524, decouple_loss:0.0013734467793256044
The modified gen p mean: 0.44862791895866394, gen p mean: -0.04664978012442589, mean p set: 0.44910821318626404The modified gen p mean: 0.45071253180503845, gen p mean: -0.047714248299598694, mean p set: 0.45119279623031616
loss_pred:0.016914213076233864, decouple_loss:0.0011775309685617685
loss_pred:0.01616540737450123, decouple_loss:0.001451117335818708
Iteration: 2182, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4506271183490753, gen p mean: -0.044067271053791046, mean p set: 0.451107382774353
loss_pred:0.016157474368810654, decouple_loss:0.0012526224600151181
The modified gen p mean: 0.4475767910480499, gen p mean: -0.040647219866514206, mean p set: 0.4480571150779724The modified gen p mean: 0.4509749412536621, gen p mean: -0.04513004794716835, mean p set: 0.4514552056789398
loss_pred:0.01662806048989296, decouple_loss:0.001171256648376584
loss_pred:0.016892852261662483, decouple_loss:0.00123945577070117
Iteration: 2183, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504499137401581, gen p mean: -0.04365234449505806, mean p set: 0.4509302079677582
loss_pred:0.01627824641764164, decouple_loss:0.001458010054193437
The modified gen p mean: 0.4491533041000366, gen p mean: -0.03836981579661369, mean p set: 0.4496335983276367The modified gen p mean: 0.44985607266426086, gen p mean: -0.03872400149703026, mean p set: 0.4503363370895386
loss_pred:0.01700148731470108, decouple_loss:0.0013845480279996991
loss_pred:0.016200479120016098, decouple_loss:0.0013777791755273938
Iteration: 2184, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501963257789612, gen p mean: -0.04004829004406929, mean p set: 0.4506766200065613
loss_pred:0.01609884202480316, decouple_loss:0.0013080504722893238
The modified gen p mean: 0.45106905698776245, gen p mean: -0.03709971532225609, mean p set: 0.45154935121536255The modified gen p mean: 0.4506102502346039, gen p mean: -0.04153984412550926, mean p set: 0.451090544462204
loss_pred:0.017297180369496346, decouple_loss:0.0012918442953377962
loss_pred:0.01589968614280224, decouple_loss:0.0012214650632813573
Iteration: 2185, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45064082741737366, gen p mean: -0.03964383900165558, mean p set: 0.45112112164497375
loss_pred:0.015911538153886795, decouple_loss:0.001263429643586278
The modified gen p mean: 0.45012757182121277, gen p mean: -0.03262961283326149, mean p set: 0.45060789585113525
The modified gen p mean: 0.44977468252182007, gen p mean: -0.03535991534590721, mean p set: 0.45025497674942017
loss_pred:0.01668371818959713, decouple_loss:0.0011116298846900463
loss_pred:0.01676933839917183, decouple_loss:0.0011367951519787312
Iteration: 2186, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507967233657837, gen p mean: -0.03667476773262024, mean p set: 0.4512770175933838
loss_pred:0.016430571675300598, decouple_loss:0.001231350819580257
The modified gen p mean: 0.44861987233161926, gen p mean: -0.034862227737903595, mean p set: 0.44910016655921936The modified gen p mean: 0.45072975754737854, gen p mean: -0.037075225263834, mean p set: 0.451210081577301
loss_pred:0.016250034794211388, decouple_loss:0.0011334780137985945
loss_pred:0.016395732760429382, decouple_loss:0.0012262801174074411
Iteration: 2187, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497682750225067, gen p mean: -0.031940899789333344, mean p set: 0.4502485692501068
loss_pred:0.016571737825870514, decouple_loss:0.0011332924477756023
The modified gen p mean: 0.4492439329624176, gen p mean: -0.035196851938962936, mean p set: 0.4497242569923401The modified gen p mean: 0.45072245597839355, gen p mean: -0.03756440058350563, mean p set: 0.45120275020599365
loss_pred:0.016853634268045425, decouple_loss:0.0011212729150429368
loss_pred:0.015854891389608383, decouple_loss:0.0011391680454835296
Iteration: 2188, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44930556416511536, gen p mean: -0.03722571209073067, mean p set: 0.44978588819503784
loss_pred:0.01700832135975361, decouple_loss:0.0011097727110609412
The modified gen p mean: 0.4508407711982727, gen p mean: -0.04095369204878807, mean p set: 0.4513210952281952The modified gen p mean: 0.4502987265586853, gen p mean: -0.03802255541086197, mean p set: 0.4507790505886078
loss_pred:0.01665986143052578, decouple_loss:0.0011663353070616722
loss_pred:0.01609043963253498, decouple_loss:0.001180276507511735
Iteration: 2189, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503313899040222, gen p mean: -0.039581526070833206, mean p set: 0.4508116841316223
loss_pred:0.016556601971387863, decouple_loss:0.0011483316775411367
The modified gen p mean: 0.4487893879413605, gen p mean: -0.041398610919713974, mean p set: 0.4492696523666382The modified gen p mean: 0.4493718147277832, gen p mean: -0.04248449578881264, mean p set: 0.4498521387577057
loss_pred:0.016303235664963722, decouple_loss:0.0010790125234052539
loss_pred:0.016811013221740723, decouple_loss:0.0011546444147825241
Iteration: 2190, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498802423477173, gen p mean: -0.04112578183412552, mean p set: 0.4503605365753174
loss_pred:0.01603943295776844, decouple_loss:0.0010584898991510272
The modified gen p mean: 0.4498160481452942, gen p mean: -0.04246462881565094, mean p set: 0.4502963423728943
The modified gen p mean: 0.4498402774333954, gen p mean: -0.049726758152246475, mean p set: 0.4503205716609955
loss_pred:0.015507221221923828, decouple_loss:0.001176133519038558
loss_pred:0.016390401870012283, decouple_loss:0.0011011192109435797
2023-05-02 10:53:24 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.050040192902088165, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04541591927409172, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.046031784266233444, mean p set: 0.4500633478164673
loss_pred:0.0185103677213192, decouple_loss:0.001240511192008853
loss_pred:0.017395367845892906, decouple_loss:0.0011305948719382286
loss_pred:0.01739995926618576, decouple_loss:0.0011476700892671943
WV_0_PC_1_EH_0_PS_40, loss: 0.017827212810516357, avg_mse: 0.025676749646663666
current test mse: 0.025677
Iteration: 2191, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44914960861206055, gen p mean: -0.04563338682055473, mean p set: 0.44962990283966064
The modified gen p mean: 0.45021581649780273, gen p mean: -0.05386169254779816, mean p set: 0.45069611072540283
The modified gen p mean: 0.4488905966281891, gen p mean: -0.04664959758520126, mean p set: 0.4493708908557892
loss_pred:0.016898028552532196, decouple_loss:0.0010519479401409626
loss_pred:0.0156322680413723, decouple_loss:0.0012346700532361865
loss_pred:0.016954263672232628, decouple_loss:0.0010044167283922434
Iteration: 2192, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45092812180519104, gen p mean: -0.04960225149989128, mean p set: 0.45140841603279114
loss_pred:0.016466433182358742, decouple_loss:0.0011041361140087247
The modified gen p mean: 0.4508361518383026, gen p mean: -0.0438089594244957, mean p set: 0.4513164758682251The modified gen p mean: 0.45036378502845764, gen p mean: -0.04282320663332939, mean p set: 0.45084407925605774
loss_pred:0.016574472188949585, decouple_loss:0.0010959323262795806
loss_pred:0.01695539429783821, decouple_loss:0.001107118441723287
Iteration: 2193, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474261403083801, gen p mean: -0.045169003307819366, mean p set: 0.4479064345359802
loss_pred:0.0162265133112669, decouple_loss:0.0010352107929065824
The modified gen p mean: 0.45054301619529724, gen p mean: -0.04932425543665886, mean p set: 0.4510233402252197The modified gen p mean: 0.4491064250469208, gen p mean: -0.04579383134841919, mean p set: 0.44958674907684326
loss_pred:0.016297584399580956, decouple_loss:0.0010806488571688533
loss_pred:0.016635557636618614, decouple_loss:0.0010462229838594794
Iteration: 2194, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501218795776367, gen p mean: -0.0477667897939682, mean p set: 0.45060214400291443
loss_pred:0.016565721482038498, decouple_loss:0.0009757056250236928
The modified gen p mean: 0.4493255913257599, gen p mean: -0.04498080909252167, mean p set: 0.4498059153556824The modified gen p mean: 0.45033878087997437, gen p mean: -0.04951116815209389, mean p set: 0.45081907510757446
loss_pred:0.016605930402874947, decouple_loss:0.0010142489336431026
loss_pred:0.016059763729572296, decouple_loss:0.0009903151076287031
Iteration: 2195, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486198127269745, gen p mean: -0.0436100959777832, mean p set: 0.4491001069545746
loss_pred:0.0162435881793499, decouple_loss:0.0010774164693430066
The modified gen p mean: 0.4497581124305725, gen p mean: -0.04206216335296631, mean p set: 0.450238436460495The modified gen p mean: 0.4503542184829712, gen p mean: -0.04153324291110039, mean p set: 0.4508344829082489
loss_pred:0.01616537570953369, decouple_loss:0.00109587621409446
loss_pred:0.016239210963249207, decouple_loss:0.001083374721929431
Iteration: 2196, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45089563727378845, gen p mean: -0.04526539891958237, mean p set: 0.45137593150138855
loss_pred:0.016966190189123154, decouple_loss:0.0010226645972579718
The modified gen p mean: 0.44876593351364136, gen p mean: -0.04364216327667236, mean p set: 0.44924622774124146The modified gen p mean: 0.45143356919288635, gen p mean: -0.04447600990533829, mean p set: 0.45191389322280884
loss_pred:0.01633257232606411, decouple_loss:0.0010112792951986194
loss_pred:0.016072459518909454, decouple_loss:0.0009678427595645189
Iteration: 2197, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490281939506531, gen p mean: -0.04135851562023163, mean p set: 0.4495084881782532
loss_pred:0.016140487045049667, decouple_loss:0.0010859353933483362
The modified gen p mean: 0.44987475872039795, gen p mean: -0.047014862298965454, mean p set: 0.45035505294799805The modified gen p mean: 0.4502270221710205, gen p mean: -0.04425695911049843, mean p set: 0.4507073163986206
loss_pred:0.0166521817445755, decouple_loss:0.0011613185051828623
loss_pred:0.01613718643784523, decouple_loss:0.0011096224188804626
Iteration: 2198, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4506642520427704, gen p mean: -0.042396798729896545, mean p set: 0.4511445164680481
loss_pred:0.01656433381140232, decouple_loss:0.000985578983090818
The modified gen p mean: 0.4509217143058777, gen p mean: -0.04086736962199211, mean p set: 0.4514020085334778The modified gen p mean: 0.45086777210235596, gen p mean: -0.04101654514670372, mean p set: 0.45134806632995605
loss_pred:0.01641358807682991, decouple_loss:0.0009651820873841643
loss_pred:0.016372952610254288, decouple_loss:0.0009429990313947201
Iteration: 2199, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502499997615814, gen p mean: -0.04030538350343704, mean p set: 0.4507302939891815
loss_pred:0.01618054322898388, decouple_loss:0.0010647270828485489
The modified gen p mean: 0.4504632353782654, gen p mean: -0.03979258984327316, mean p set: 0.4509435296058655The modified gen p mean: 0.4486290216445923, gen p mean: -0.04217476025223732, mean p set: 0.4491093158721924
loss_pred:0.01628371700644493, decouple_loss:0.0009860791033133864
loss_pred:0.01666867919266224, decouple_loss:0.0009754300699569285
Iteration: 2200, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45052289962768555, gen p mean: -0.03766268119215965, mean p set: 0.45100319385528564
loss_pred:0.015974562615156174, decouple_loss:0.000988044892437756
The modified gen p mean: 0.45121094584465027, gen p mean: -0.03814436495304108, mean p set: 0.451691210269928The modified gen p mean: 0.4492305815219879, gen p mean: -0.03628046065568924, mean p set: 0.449710875749588
loss_pred:0.01594744250178337, decouple_loss:0.0010457155294716358
loss_pred:0.01660650223493576, decouple_loss:0.0009980889735743403
2023-05-02 10:55:19 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.044066280126571655, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.03977322578430176, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.04030789062380791, mean p set: 0.4500633478164673
loss_pred:0.018529383465647697, decouple_loss:0.0011605368927121162
loss_pred:0.01738615147769451, decouple_loss:0.0010726717300713062
loss_pred:0.017419960349798203, decouple_loss:0.0010865532094612718
WV_0_PC_1_EH_0_PS_40, loss: 0.017833827063441277, avg_mse: 0.025701845064759254
current test mse: 0.025702
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012006_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012006_3_24hr.npz
NaN value num: 0
Iteration: 2201, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500167667865753, gen p mean: -0.03771413117647171, mean p set: 0.4504970610141754
loss_pred:0.01655055768787861, decouple_loss:0.0010717586847022176
The modified gen p mean: 0.45187094807624817, gen p mean: -0.033215899020433426, mean p set: 0.45235124230384827The modified gen p mean: 0.45063233375549316, gen p mean: -0.028696898370981216, mean p set: 0.45111262798309326
loss_pred:0.015803594142198563, decouple_loss:0.001020008116029203
loss_pred:0.015686050057411194, decouple_loss:0.0011563115986064076
Iteration: 2202, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45100700855255127, gen p mean: -0.03046508878469467, mean p set: 0.45148730278015137
loss_pred:0.016117103397846222, decouple_loss:0.0010512638837099075
The modified gen p mean: 0.4499807357788086, gen p mean: -0.03993157669901848, mean p set: 0.4504610598087311The modified gen p mean: 0.44925743341445923, gen p mean: -0.03567490726709366, mean p set: 0.4497377276420593
loss_pred:0.016276514157652855, decouple_loss:0.0010131294839084148
loss_pred:0.016123885288834572, decouple_loss:0.0010509336134418845
Iteration: 2203, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45117881894111633, gen p mean: -0.030593249946832657, mean p set: 0.45165911316871643
loss_pred:0.016101719811558723, decouple_loss:0.0009788729948922992
The modified gen p mean: 0.4493281841278076, gen p mean: -0.034581732004880905, mean p set: 0.4498084783554077
The modified gen p mean: 0.4511168599128723, gen p mean: -0.031027453020215034, mean p set: 0.4515971541404724
loss_pred:0.015624907799065113, decouple_loss:0.0010713483206927776
loss_pred:0.01645824871957302, decouple_loss:0.0010489951819181442
Iteration: 2204, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45170465111732483, gen p mean: -0.03033572807908058, mean p set: 0.45218491554260254
The modified gen p mean: 0.451703816652298, gen p mean: -0.033488839864730835, mean p set: 0.45218411087989807
loss_pred:0.01608472317457199, decouple_loss:0.0010734465904533863
loss_pred:0.015772754326462746, decouple_loss:0.0009810227202251554
The modified gen p mean: 0.45163416862487793, gen p mean: -0.029312824830412865, mean p set: 0.452114462852478
loss_pred:0.01623688079416752, decouple_loss:0.0010319965658709407
Iteration: 2205, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44807472825050354, gen p mean: -0.04032756760716438, mean p set: 0.44855502247810364
loss_pred:0.015635060146450996, decouple_loss:0.001007955172099173
The modified gen p mean: 0.4490896165370941, gen p mean: -0.039642367511987686, mean p set: 0.4495699107646942The modified gen p mean: 0.4493485689163208, gen p mean: -0.04090530052781105, mean p set: 0.4498288631439209
loss_pred:0.016858655959367752, decouple_loss:0.0010000932961702347
loss_pred:0.016189206391572952, decouple_loss:0.0010245299199596047
Iteration: 2206, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45155611634254456, gen p mean: -0.037609562277793884, mean p set: 0.45203638076782227
loss_pred:0.01497198548167944, decouple_loss:0.0011035525240004063
The modified gen p mean: 0.4518933594226837, gen p mean: -0.033603597432374954, mean p set: 0.4523736536502838The modified gen p mean: 0.4509750008583069, gen p mean: -0.03430468961596489, mean p set: 0.451455295085907
loss_pred:0.015548650175333023, decouple_loss:0.0009628878906369209
loss_pred:0.01593831181526184, decouple_loss:0.0010867095552384853
Iteration: 2207, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45159855484962463, gen p mean: -0.03333219140768051, mean p set: 0.45207884907722473
loss_pred:0.015683606266975403, decouple_loss:0.0009963620686903596
The modified gen p mean: 0.44951412081718445, gen p mean: -0.04821683466434479, mean p set: 0.44999441504478455The modified gen p mean: 0.4516366422176361, gen p mean: -0.040493156760931015, mean p set: 0.4521169364452362
loss_pred:0.015534237958490849, decouple_loss:0.0009747424628585577
loss_pred:0.016522616147994995, decouple_loss:0.0010301077272742987
Iteration: 2208, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45030251145362854, gen p mean: -0.037445440888404846, mean p set: 0.45078280568122864
loss_pred:0.016217360273003578, decouple_loss:0.0010105347028002143
The modified gen p mean: 0.44879651069641113, gen p mean: -0.04771227389574051, mean p set: 0.44927680492401123The modified gen p mean: 0.4493594169616699, gen p mean: -0.04555973410606384, mean p set: 0.44983968138694763
loss_pred:0.016966428607702255, decouple_loss:0.0010832063853740692
loss_pred:0.015494323335587978, decouple_loss:0.0009759772219695151
Iteration: 2209, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507134258747101, gen p mean: -0.03891193866729736, mean p set: 0.45119374990463257
loss_pred:0.01624603196978569, decouple_loss:0.001097446889616549
The modified gen p mean: 0.4516501724720001, gen p mean: -0.03991110250353813, mean p set: 0.4521304666996002
The modified gen p mean: 0.44799908995628357, gen p mean: -0.04968778043985367, mean p set: 0.44847941398620605
loss_pred:0.016204530373215675, decouple_loss:0.0009350043837912381
loss_pred:0.015712842345237732, decouple_loss:0.0009968162048608065
Iteration: 2210, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513588547706604, gen p mean: -0.039705898612737656, mean p set: 0.4518391489982605
loss_pred:0.01594345085322857, decouple_loss:0.0009562700288370252
The modified gen p mean: 0.4508605897426605, gen p mean: -0.04605918005108833, mean p set: 0.4513408839702606The modified gen p mean: 0.4522525370121002, gen p mean: -0.04310927540063858, mean p set: 0.4527328312397003
loss_pred:0.01548815332353115, decouple_loss:0.0009741164394654334
loss_pred:0.015326699241995811, decouple_loss:0.0009056506096385419
2023-05-02 10:57:53 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.054477766156196594, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.049993641674518585, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.05078185722231865, mean p set: 0.4500633478164673
loss_pred:0.018381260335445404, decouple_loss:0.0011356875766068697
loss_pred:0.017169669270515442, decouple_loss:0.0010712880175560713
loss_pred:0.017316410318017006, decouple_loss:0.0011026725405827165
WV_0_PC_1_EH_0_PS_40, loss: 0.017677608877420425, avg_mse: 0.02538386546075344
current test mse: 0.025384
Iteration: 2211, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45099201798439026, gen p mean: -0.042482368648052216, mean p set: 0.45147234201431274
The modified gen p mean: 0.45113927125930786, gen p mean: -0.037354812026023865, mean p set: 0.45161959528923035
The modified gen p mean: 0.4515303373336792, gen p mean: -0.041180938482284546, mean p set: 0.4520106315612793
loss_pred:0.015602792613208294, decouple_loss:0.0009863429004326463
loss_pred:0.015443006530404091, decouple_loss:0.0009935192065313458
loss_pred:0.016330085694789886, decouple_loss:0.0010685613378882408
Iteration: 2212, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4509863257408142, gen p mean: -0.03832259774208069, mean p set: 0.4514666199684143
loss_pred:0.01609538123011589, decouple_loss:0.0010943870292976499
The modified gen p mean: 0.4499015808105469, gen p mean: -0.04416951164603233, mean p set: 0.45038190484046936
The modified gen p mean: 0.4517109990119934, gen p mean: -0.039973169565200806, mean p set: 0.4521912932395935
loss_pred:0.015966637060046196, decouple_loss:0.0009473820100538433
loss_pred:0.015778381377458572, decouple_loss:0.000963124621193856
Iteration: 2213, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44996964931488037, gen p mean: -0.04269888252019882, mean p set: 0.45044994354248047
loss_pred:0.01525360718369484, decouple_loss:0.0010110954754054546
The modified gen p mean: 0.45136773586273193, gen p mean: -0.04066113010048866, mean p set: 0.45184803009033203The modified gen p mean: 0.4512881934642792, gen p mean: -0.033524930477142334, mean p set: 0.4517684876918793
loss_pred:0.016240304335951805, decouple_loss:0.0010875746374949813
loss_pred:0.015519475564360619, decouple_loss:0.0010371165117248893
Iteration: 2214, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504876732826233, gen p mean: -0.03745785728096962, mean p set: 0.4509679973125458
loss_pred:0.016445433720946312, decouple_loss:0.0010210128966718912
The modified gen p mean: 0.45043498277664185, gen p mean: -0.03803812712430954, mean p set: 0.45091530680656433The modified gen p mean: 0.4482744038105011, gen p mean: -0.04474480450153351, mean p set: 0.4487546980381012
loss_pred:0.015859611332416534, decouple_loss:0.0010825485223904252
loss_pred:0.015896400436758995, decouple_loss:0.001011812244541943
Iteration: 2215, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494708776473999, gen p mean: -0.041687384247779846, mean p set: 0.449951171875
loss_pred:0.01669894903898239, decouple_loss:0.0010059764608740807
The modified gen p mean: 0.44800442457199097, gen p mean: -0.045736681669950485, mean p set: 0.44848471879959106The modified gen p mean: 0.4490474462509155, gen p mean: -0.04328645393252373, mean p set: 0.4495277404785156
loss_pred:0.015814539045095444, decouple_loss:0.0009779920801520348
loss_pred:0.0159616582095623, decouple_loss:0.0009844477754086256
Iteration: 2216, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45150136947631836, gen p mean: -0.041160546243190765, mean p set: 0.45198163390159607
loss_pred:0.0160564836114645, decouple_loss:0.0010204976424574852
The modified gen p mean: 0.45097821950912476, gen p mean: -0.038338553160429, mean p set: 0.45145851373672485The modified gen p mean: 0.4517100155353546, gen p mean: -0.038543589413166046, mean p set: 0.4521903395652771
loss_pred:0.01586562767624855, decouple_loss:0.0009738632361404598
loss_pred:0.015856517478823662, decouple_loss:0.0009815581142902374
Iteration: 2217, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.451058030128479, gen p mean: -0.03962341323494911, mean p set: 0.4515382945537567
loss_pred:0.01525926124304533, decouple_loss:0.0009476347477175295
The modified gen p mean: 0.4514239430427551, gen p mean: -0.04067768156528473, mean p set: 0.4519042372703552The modified gen p mean: 0.4519844055175781, gen p mean: -0.039496034383773804, mean p set: 0.45246466994285583
loss_pred:0.015090066939592361, decouple_loss:0.0009503516484983265
loss_pred:0.01575612463057041, decouple_loss:0.000957523996476084
Iteration: 2218, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508572220802307, gen p mean: -0.03595557436347008, mean p set: 0.4513375163078308
loss_pred:0.015779605135321617, decouple_loss:0.0009612670401111245
The modified gen p mean: 0.4489649832248688, gen p mean: -0.04382931441068649, mean p set: 0.44944530725479126The modified gen p mean: 0.44951415061950684, gen p mean: -0.044725123792886734, mean p set: 0.4499944746494293
loss_pred:0.01545920129865408, decouple_loss:0.0009730559540912509
loss_pred:0.015991926193237305, decouple_loss:0.000971785862930119
Iteration: 2219, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514516294002533, gen p mean: -0.03746858984231949, mean p set: 0.4519319236278534
loss_pred:0.01574738696217537, decouple_loss:0.0010026725940406322
The modified gen p mean: 0.4486517906188965, gen p mean: -0.0426841638982296, mean p set: 0.4491320550441742The modified gen p mean: 0.4501020908355713, gen p mean: -0.04048046097159386, mean p set: 0.4505823850631714
loss_pred:0.01600681245326996, decouple_loss:0.0009554707212373614
loss_pred:0.01604372262954712, decouple_loss:0.0010324192699044943
Iteration: 2220, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4517773687839508, gen p mean: -0.035720158368349075, mean p set: 0.4522576630115509
loss_pred:0.015400605276226997, decouple_loss:0.0009147181990556419
The modified gen p mean: 0.4492376148700714, gen p mean: -0.04279555007815361, mean p set: 0.4497178792953491The modified gen p mean: 0.4498012959957123, gen p mean: -0.03818991035223007, mean p set: 0.45028162002563477
loss_pred:0.015999790281057358, decouple_loss:0.0009229379356838763
loss_pred:0.0166698656976223, decouple_loss:0.0010145565029233694
2023-05-02 10:59:48 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.04770601540803909, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04335002601146698, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.043970394879579544, mean p set: 0.4500633478164673
loss_pred:0.01829340122640133, decouple_loss:0.0010438007302582264
loss_pred:0.017157968133687973, decouple_loss:0.0009810084011405706
loss_pred:0.01725209318101406, decouple_loss:0.0010445418301969767
WV_0_PC_1_EH_0_PS_40, loss: 0.017618976533412933, avg_mse: 0.02529897913336754
current test mse: 0.025299
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012014_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012014_3_24hr.npz
NaN value num: 0
Iteration: 2221, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477819800376892, gen p mean: -0.047000158578157425, mean p set: 0.4482622444629669
loss_pred:0.015359599143266678, decouple_loss:0.0010121539235115051
The modified gen p mean: 0.44718873500823975, gen p mean: -0.04509662836790085, mean p set: 0.44766902923583984The modified gen p mean: 0.4469756484031677, gen p mean: -0.043333180248737335, mean p set: 0.4474559724330902
loss_pred:0.014943019486963749, decouple_loss:0.0010413445997983217
loss_pred:0.014565914869308472, decouple_loss:0.0010952091543003917
Iteration: 2222, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44619378447532654, gen p mean: -0.04534183442592621, mean p set: 0.44667407870292664
loss_pred:0.01542613934725523, decouple_loss:0.001047502621077001
The modified gen p mean: 0.44727882742881775, gen p mean: -0.047239769250154495, mean p set: 0.44775912165641785
The modified gen p mean: 0.4465339481830597, gen p mean: -0.04174869880080223, mean p set: 0.4470142424106598
loss_pred:0.014889153651893139, decouple_loss:0.000979050062596798
loss_pred:0.01536717638373375, decouple_loss:0.0010406090877950191
Iteration: 2223, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4460561275482178, gen p mean: -0.04670136049389839, mean p set: 0.44653645157814026
loss_pred:0.014266924001276493, decouple_loss:0.0009918002178892493
The modified gen p mean: 0.4459005892276764, gen p mean: -0.046744056046009064, mean p set: 0.4463808834552765The modified gen p mean: 0.4484091103076935, gen p mean: -0.04732357710599899, mean p set: 0.44888943433761597
loss_pred:0.014767886139452457, decouple_loss:0.0011294708820059896
loss_pred:0.014645860530436039, decouple_loss:0.0010809568921104074
Iteration: 2224, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475047290325165, gen p mean: -0.04755237698554993, mean p set: 0.4479850232601166
loss_pred:0.014817291870713234, decouple_loss:0.0010413345880806446
The modified gen p mean: 0.44621577858924866, gen p mean: -0.04223174229264259, mean p set: 0.44669607281684875The modified gen p mean: 0.4474382996559143, gen p mean: -0.04443851858377457, mean p set: 0.447918564081192
loss_pred:0.014430878683924675, decouple_loss:0.0010566641576588154
loss_pred:0.013952580280601978, decouple_loss:0.0011751815909519792
Iteration: 2225, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44649195671081543, gen p mean: -0.04895393177866936, mean p set: 0.4469722807407379
loss_pred:0.014639969915151596, decouple_loss:0.001143300556577742
The modified gen p mean: 0.44761812686920166, gen p mean: -0.046495549380779266, mean p set: 0.44809842109680176The modified gen p mean: 0.44595468044281006, gen p mean: -0.047428712248802185, mean p set: 0.44643494486808777
loss_pred:0.014478330500423908, decouple_loss:0.0012774787610396743
loss_pred:0.014221343211829662, decouple_loss:0.0011712540872395039
Iteration: 2226, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44607147574424744, gen p mean: -0.050424233078956604, mean p set: 0.44655176997184753
loss_pred:0.01488482765853405, decouple_loss:0.0010339723667129874
The modified gen p mean: 0.4457559883594513, gen p mean: -0.04859587922692299, mean p set: 0.4462362825870514The modified gen p mean: 0.4464482367038727, gen p mean: -0.04712304100394249, mean p set: 0.44692856073379517
loss_pred:0.01436078455299139, decouple_loss:0.00108801678288728
loss_pred:0.01441486831754446, decouple_loss:0.0011315904557704926
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 2227, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467751085758209, gen p mean: -0.05024605616927147, mean p set: 0.44725537300109863
loss_pred:0.01410770881921053, decouple_loss:0.001033747335895896
The modified gen p mean: 0.4467596411705017, gen p mean: -0.04626850411295891, mean p set: 0.4472399353981018The modified gen p mean: 0.44548192620277405, gen p mean: -0.052919719368219376, mean p set: 0.44596222043037415
loss_pred:0.014731147326529026, decouple_loss:0.0010652837809175253
loss_pred:0.014284119941294193, decouple_loss:0.00105158775113523
Iteration: 2228, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465043246746063, gen p mean: -0.05388742685317993, mean p set: 0.4469846189022064
loss_pred:0.014781363308429718, decouple_loss:0.001090588397346437
The modified gen p mean: 0.4472518563270569, gen p mean: -0.04982868954539299, mean p set: 0.447732150554657The modified gen p mean: 0.4478432238101959, gen p mean: -0.05176449567079544, mean p set: 0.448323518037796
loss_pred:0.014189372770488262, decouple_loss:0.0011619704309850931
loss_pred:0.014574582688510418, decouple_loss:0.0011540318373590708
Iteration: 2229, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44665440917015076, gen p mean: -0.05148796737194061, mean p set: 0.44713470339775085
loss_pred:0.014566279016435146, decouple_loss:0.0011853917967528105
The modified gen p mean: 0.447651743888855, gen p mean: -0.05220353230834007, mean p set: 0.44813206791877747The modified gen p mean: 0.4480521082878113, gen p mean: -0.052384018898010254, mean p set: 0.448532372713089
loss_pred:0.014208207838237286, decouple_loss:0.0011638542637228966
loss_pred:0.014490334317088127, decouple_loss:0.0011714615393429995
Iteration: 2230, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480176866054535, gen p mean: -0.05283159762620926, mean p set: 0.4484979510307312
loss_pred:0.014491777867078781, decouple_loss:0.00119359593372792
The modified gen p mean: 0.44568219780921936, gen p mean: -0.049980662763118744, mean p set: 0.44616246223449707The modified gen p mean: 0.44622841477394104, gen p mean: -0.053240519016981125, mean p set: 0.4467087388038635
loss_pred:0.014531630091369152, decouple_loss:0.0011197170242667198
loss_pred:0.014773176982998848, decouple_loss:0.0011431379243731499
2023-05-02 11:02:22 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.05352757126092911, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04899156093597412, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04938862845301628, mean p set: 0.4500633478164673
loss_pred:0.019135795533657074, decouple_loss:0.0013396227732300758
loss_pred:0.017959609627723694, decouple_loss:0.001143891829997301
loss_pred:0.018045322969555855, decouple_loss:0.0011681729229167104
WV_0_PC_1_EH_0_PS_40, loss: 0.018441103398799896, avg_mse: 0.026844434440135956
current test mse: 0.026844
Iteration: 2231, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466250538825989, gen p mean: -0.05094330385327339, mean p set: 0.447105348110199
The modified gen p mean: 0.44740718603134155, gen p mean: -0.050384413450956345, mean p set: 0.44788745045661926
The modified gen p mean: 0.44654616713523865, gen p mean: -0.048719506710767746, mean p set: 0.44702646136283875
loss_pred:0.014126891270279884, decouple_loss:0.0012278889771550894
loss_pred:0.014409295283257961, decouple_loss:0.001229677116498351loss_pred:0.014449778944253922, decouple_loss:0.0012169968103989959
Iteration: 2232, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44631728529930115, gen p mean: -0.04947897046804428, mean p set: 0.44679760932922363
loss_pred:0.014616783708333969, decouple_loss:0.001293219975195825
The modified gen p mean: 0.44592297077178955, gen p mean: -0.047251876443624496, mean p set: 0.44640329480171204The modified gen p mean: 0.4476187825202942, gen p mean: -0.048599839210510254, mean p set: 0.4480991065502167
loss_pred:0.014335842803120613, decouple_loss:0.001216073171235621
loss_pred:0.014275295659899712, decouple_loss:0.0012401374988257885
Iteration: 2233, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470368027687073, gen p mean: -0.05025716871023178, mean p set: 0.44751712679862976
loss_pred:0.014303700067102909, decouple_loss:0.001165770459920168
The modified gen p mean: 0.4464503824710846, gen p mean: -0.04796434938907623, mean p set: 0.4469307065010071The modified gen p mean: 0.4465695321559906, gen p mean: -0.04738298058509827, mean p set: 0.4470498263835907
loss_pred:0.013648788444697857, decouple_loss:0.0011513999197632074
loss_pred:0.014740324579179287, decouple_loss:0.0011633452959358692
Iteration: 2234, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466998875141144, gen p mean: -0.04979899525642395, mean p set: 0.4471801817417145
loss_pred:0.014534828253090382, decouple_loss:0.0013161473907530308
The modified gen p mean: 0.4455997347831726, gen p mean: -0.049697376787662506, mean p set: 0.4460800588130951The modified gen p mean: 0.4480317533016205, gen p mean: -0.048504263162612915, mean p set: 0.44851207733154297
loss_pred:0.01404608879238367, decouple_loss:0.0013123857788741589
loss_pred:0.013754923827946186, decouple_loss:0.0014318947214633226
Iteration: 2235, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467129409313202, gen p mean: -0.04833617061376572, mean p set: 0.4471932351589203
loss_pred:0.014352926053106785, decouple_loss:0.0012542337644845247
The modified gen p mean: 0.4458337724208832, gen p mean: -0.043473586440086365, mean p set: 0.4463140368461609The modified gen p mean: 0.4460196793079376, gen p mean: -0.04605318605899811, mean p set: 0.4465000033378601
loss_pred:0.01426645927131176, decouple_loss:0.0012324482668191195
loss_pred:0.01390870101749897, decouple_loss:0.0012400612467899919
Iteration: 2236, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44623321294784546, gen p mean: -0.04454762861132622, mean p set: 0.44671353697776794
loss_pred:0.014668133109807968, decouple_loss:0.0011738133616745472
The modified gen p mean: 0.44696760177612305, gen p mean: -0.044198647141456604, mean p set: 0.44744786620140076The modified gen p mean: 0.44656628370285034, gen p mean: -0.04756177216768265, mean p set: 0.44704657793045044
loss_pred:0.01435328833758831, decouple_loss:0.0011686953948810697
loss_pred:0.01430416014045477, decouple_loss:0.0012362084817141294
Iteration: 2237, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473945200443268, gen p mean: -0.04396292194724083, mean p set: 0.44787484407424927
loss_pred:0.014134977012872696, decouple_loss:0.0012415150413289666
The modified gen p mean: 0.4475099444389343, gen p mean: -0.044811781495809555, mean p set: 0.44799020886421204The modified gen p mean: 0.44653698801994324, gen p mean: -0.04712716490030289, mean p set: 0.4470173120498657
loss_pred:0.014066586270928383, decouple_loss:0.001180949853733182
loss_pred:0.014112437143921852, decouple_loss:0.0011797734769061208
Iteration: 2238, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44647157192230225, gen p mean: -0.04849548265337944, mean p set: 0.44695183634757996
loss_pred:0.014131290838122368, decouple_loss:0.001283195917494595
The modified gen p mean: 0.44689759612083435, gen p mean: -0.040562041103839874, mean p set: 0.44737792015075684The modified gen p mean: 0.4464617967605591, gen p mean: -0.04316171631217003, mean p set: 0.4469420909881592
loss_pred:0.014144591055810452, decouple_loss:0.0011927562300115824
loss_pred:0.014743613079190254, decouple_loss:0.0013189807068556547
Iteration: 2239, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479432702064514, gen p mean: -0.04358743876218796, mean p set: 0.4484235644340515
loss_pred:0.013609020039439201, decouple_loss:0.0011373806046321988
The modified gen p mean: 0.44583743810653687, gen p mean: -0.04635290801525116, mean p set: 0.44631776213645935The modified gen p mean: 0.4468311369419098, gen p mean: -0.04336155578494072, mean p set: 0.4473114311695099
loss_pred:0.013714786618947983, decouple_loss:0.0011793866287916899
loss_pred:0.013603627681732178, decouple_loss:0.0010829383973032236
Iteration: 2240, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4462399482727051, gen p mean: -0.0430002436041832, mean p set: 0.4467202425003052
loss_pred:0.0142141655087471, decouple_loss:0.0012695381883531809
The modified gen p mean: 0.4459228217601776, gen p mean: -0.04368992894887924, mean p set: 0.4464031159877777The modified gen p mean: 0.44759777188301086, gen p mean: -0.04478742182254791, mean p set: 0.44807806611061096
loss_pred:0.014115430414676666, decouple_loss:0.0011657328577712178
loss_pred:0.014265334233641624, decouple_loss:0.0011781069915741682
2023-05-02 11:04:17 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.04811035841703415, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.043502628803253174, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.0439583845436573, mean p set: 0.4500633478164673
loss_pred:0.019080214202404022, decouple_loss:0.0012599293841049075
loss_pred:0.01794765144586563, decouple_loss:0.0011667863000184298
loss_pred:0.018027355894446373, decouple_loss:0.0012352439807727933
WV_0_PC_1_EH_0_PS_40, loss: 0.018412774428725243, avg_mse: 0.02683577686548233
current test mse: 0.026836
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012003_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012003_3_24hr.npz
NaN value num: 0
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 2241, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44756534695625305, gen p mean: -0.045014165341854095, mean p set: 0.44804567098617554
loss_pred:0.01371486485004425, decouple_loss:0.001116967760026455
The modified gen p mean: 0.447377473115921, gen p mean: -0.04480980709195137, mean p set: 0.44785773754119873The modified gen p mean: 0.4480276107788086, gen p mean: -0.04632342606782913, mean p set: 0.4485079050064087
loss_pred:0.013480234891176224, decouple_loss:0.0013298396952450275
loss_pred:0.01357593759894371, decouple_loss:0.0011350850109010935
Iteration: 2242, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44785627722740173, gen p mean: -0.04673657938838005, mean p set: 0.44833654165267944
loss_pred:0.014058081433176994, decouple_loss:0.0011277529411017895
The modified gen p mean: 0.44741374254226685, gen p mean: -0.04745031148195267, mean p set: 0.44789400696754456The modified gen p mean: 0.44784730672836304, gen p mean: -0.04706922918558121, mean p set: 0.44832760095596313
loss_pred:0.013686185702681541, decouple_loss:0.001137326704338193
loss_pred:0.014104053378105164, decouple_loss:0.0011687142541632056
Iteration: 2243, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44874122738838196, gen p mean: -0.04631277173757553, mean p set: 0.44922152161598206
loss_pred:0.01402981672435999, decouple_loss:0.0010295886313542724
The modified gen p mean: 0.4476041793823242, gen p mean: -0.04686833173036575, mean p set: 0.4480845034122467The modified gen p mean: 0.44823116064071655, gen p mean: -0.04742835462093353, mean p set: 0.44871145486831665
loss_pred:0.014476749114692211, decouple_loss:0.001131329219788313
loss_pred:0.014452951028943062, decouple_loss:0.0011466958094388247
Iteration: 2244, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471968710422516, gen p mean: -0.04853310436010361, mean p set: 0.4476771950721741
loss_pred:0.01478507649153471, decouple_loss:0.0012469467474147677
The modified gen p mean: 0.4474125802516937, gen p mean: -0.04708084091544151, mean p set: 0.44789284467697144The modified gen p mean: 0.4483591914176941, gen p mean: -0.04770940914750099, mean p set: 0.4488394856452942
loss_pred:0.01348489336669445, decouple_loss:0.0011794670717790723
loss_pred:0.013723504729568958, decouple_loss:0.0011214392725378275
Iteration: 2245, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44805198907852173, gen p mean: -0.048353131860494614, mean p set: 0.4485322833061218
loss_pred:0.01324201188981533, decouple_loss:0.0010703228181228042
The modified gen p mean: 0.4481275677680969, gen p mean: -0.050352536141872406, mean p set: 0.44860783219337463The modified gen p mean: 0.4475441873073578, gen p mean: -0.04852355644106865, mean p set: 0.4480244815349579
loss_pred:0.013453950174152851, decouple_loss:0.0010315603576600552
loss_pred:0.013540099374949932, decouple_loss:0.001056933426298201
Iteration: 2246, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486088156700134, gen p mean: -0.04720274731516838, mean p set: 0.44908908009529114
loss_pred:0.013952039182186127, decouple_loss:0.0010368464281782508
The modified gen p mean: 0.44777509570121765, gen p mean: -0.04781545698642731, mean p set: 0.44825538992881775The modified gen p mean: 0.4476287364959717, gen p mean: -0.04901145026087761, mean p set: 0.4481090009212494
loss_pred:0.013491494581103325, decouple_loss:0.001130671938881278
loss_pred:0.013284046202898026, decouple_loss:0.0011484406422823668
Iteration: 2247, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473778009414673, gen p mean: -0.04485207796096802, mean p set: 0.4478580951690674
loss_pred:0.013560881838202477, decouple_loss:0.0010250294581055641
The modified gen p mean: 0.44851943850517273, gen p mean: -0.048926230520009995, mean p set: 0.4489997327327728The modified gen p mean: 0.4473952651023865, gen p mean: -0.048361167311668396, mean p set: 0.4478755593299866
loss_pred:0.012851078994572163, decouple_loss:0.0009802017593756318
loss_pred:0.013425285927951336, decouple_loss:0.0010649410542100668
Iteration: 2248, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44824665784835815, gen p mean: -0.04145967587828636, mean p set: 0.44872695207595825
loss_pred:0.013876358978450298, decouple_loss:0.0010414174757897854
The modified gen p mean: 0.44821539521217346, gen p mean: -0.04406243562698364, mean p set: 0.44869568943977356The modified gen p mean: 0.4473389685153961, gen p mean: -0.04882588982582092, mean p set: 0.4478192627429962
loss_pred:0.013792550191283226, decouple_loss:0.0010290469508618116
loss_pred:0.012696975842118263, decouple_loss:0.0009912409586831927
Iteration: 2249, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491927921772003, gen p mean: -0.04627329111099243, mean p set: 0.4496730864048004
loss_pred:0.013606393709778786, decouple_loss:0.0010002212366089225
The modified gen p mean: 0.44772955775260925, gen p mean: -0.04504457861185074, mean p set: 0.44820985198020935The modified gen p mean: 0.44710564613342285, gen p mean: -0.04670577868819237, mean p set: 0.44758591055870056
loss_pred:0.01379761565476656, decouple_loss:0.0010245251469314098
loss_pred:0.013422996737062931, decouple_loss:0.0010248922044411302
Iteration: 2250, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486084580421448, gen p mean: -0.04262126609683037, mean p set: 0.4490887224674225
loss_pred:0.013116596266627312, decouple_loss:0.0010967609705403447
The modified gen p mean: 0.4482789933681488, gen p mean: -0.044619832187891006, mean p set: 0.4487592875957489The modified gen p mean: 0.4479374587535858, gen p mean: -0.04529654607176781, mean p set: 0.4484177529811859
loss_pred:0.014206216670572758, decouple_loss:0.0011422840179875493
loss_pred:0.013917576521635056, decouple_loss:0.0009590046829544008
2023-05-02 11:06:49 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.04704424366354942, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04252481460571289, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04294143617153168, mean p set: 0.4500633478164673
loss_pred:0.018973398953676224, decouple_loss:0.0010393868433311582
loss_pred:0.017848419025540352, decouple_loss:0.0010675699450075626
loss_pred:0.017889635637402534, decouple_loss:0.0011014140909537673
WV_0_PC_1_EH_0_PS_40, loss: 0.018290624022483826, avg_mse: 0.02663533203303814
current test mse: 0.026635
Iteration: 2251, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503796696662903, gen p mean: -0.04741564020514488, mean p set: 0.4508599638938904
The modified gen p mean: 0.4478241205215454, gen p mean: -0.04393194988369942, mean p set: 0.4483044445514679
The modified gen p mean: 0.4495103657245636, gen p mean: -0.04300440102815628, mean p set: 0.4499906599521637
loss_pred:0.013520404696464539, decouple_loss:0.0010143950348719954
loss_pred:0.013213337399065495, decouple_loss:0.001063968287780881loss_pred:0.013877893798053265, decouple_loss:0.0011645890772342682
Iteration: 2252, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485880732536316, gen p mean: -0.04579845815896988, mean p set: 0.4490683674812317
loss_pred:0.013350188732147217, decouple_loss:0.0010050989221781492
The modified gen p mean: 0.4484109878540039, gen p mean: -0.045579127967357635, mean p set: 0.4488913416862488The modified gen p mean: 0.44828885793685913, gen p mean: -0.04343708977103233, mean p set: 0.44876912236213684
loss_pred:0.014230100437998772, decouple_loss:0.0010158804943785071
loss_pred:0.014000208117067814, decouple_loss:0.0009824929293245077
Iteration: 2253, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44847288727760315, gen p mean: -0.045941684395074844, mean p set: 0.44895321130752563
loss_pred:0.013285772874951363, decouple_loss:0.0010236139642074704
The modified gen p mean: 0.4484139680862427, gen p mean: -0.0474531389772892, mean p set: 0.448894202709198The modified gen p mean: 0.4482533037662506, gen p mean: -0.045658499002456665, mean p set: 0.4487335979938507
loss_pred:0.014050970785319805, decouple_loss:0.0009760386892594397
loss_pred:0.013548768125474453, decouple_loss:0.001006440375931561
Iteration: 2254, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44809481501579285, gen p mean: -0.04738551005721092, mean p set: 0.44857507944107056
loss_pred:0.012818981893360615, decouple_loss:0.0009659870993345976
The modified gen p mean: 0.4471077620983124, gen p mean: -0.0467926561832428, mean p set: 0.4475880563259125
The modified gen p mean: 0.44844356179237366, gen p mean: -0.04710692912340164, mean p set: 0.44892382621765137
loss_pred:0.013458930887281895, decouple_loss:0.0009387964382767677
loss_pred:0.013427664525806904, decouple_loss:0.001018759561702609
Iteration: 2255, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44750773906707764, gen p mean: -0.05020321533083916, mean p set: 0.44798803329467773
loss_pred:0.01307399570941925, decouple_loss:0.0010026348754763603
The modified gen p mean: 0.44813817739486694, gen p mean: -0.0485202856361866, mean p set: 0.44861847162246704The modified gen p mean: 0.4486619234085083, gen p mean: -0.04845910891890526, mean p set: 0.4491422176361084
loss_pred:0.013209364376962185, decouple_loss:0.001031214720569551
loss_pred:0.013526968657970428, decouple_loss:0.0010536658810451627
Iteration: 2256, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494568407535553, gen p mean: -0.04758873209357262, mean p set: 0.4499371349811554
loss_pred:0.013168347999453545, decouple_loss:0.0011607202468439937
The modified gen p mean: 0.4497060775756836, gen p mean: -0.04954937472939491, mean p set: 0.4501863420009613The modified gen p mean: 0.44751811027526855, gen p mean: -0.047093115746974945, mean p set: 0.44799840450286865
loss_pred:0.013332094997167587, decouple_loss:0.0010227961465716362
loss_pred:0.01402059756219387, decouple_loss:0.0009737915825098753
Iteration: 2257, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477749466896057, gen p mean: -0.046078234910964966, mean p set: 0.4482552707195282
loss_pred:0.014115691184997559, decouple_loss:0.001194794662296772
The modified gen p mean: 0.44870465993881226, gen p mean: -0.045712199062108994, mean p set: 0.44918495416641235The modified gen p mean: 0.4481653571128845, gen p mean: -0.047370657324790955, mean p set: 0.4486456513404846
loss_pred:0.013839155435562134, decouple_loss:0.0011525471927598119
loss_pred:0.013189793564379215, decouple_loss:0.0010682231513783336
Iteration: 2258, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44771498441696167, gen p mean: -0.045834191143512726, mean p set: 0.44819530844688416
loss_pred:0.013552621006965637, decouple_loss:0.0010629261378198862
The modified gen p mean: 0.44841238856315613, gen p mean: -0.044290732592344284, mean p set: 0.4488926827907562The modified gen p mean: 0.44768255949020386, gen p mean: -0.046199943870306015, mean p set: 0.44816285371780396
loss_pred:0.013633852824568748, decouple_loss:0.0010034161387011409
loss_pred:0.012842808850109577, decouple_loss:0.0009911522502079606
Iteration: 2259, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44995635747909546, gen p mean: -0.047774601727724075, mean p set: 0.45043665170669556
loss_pred:0.013469324447214603, decouple_loss:0.001165174413472414
The modified gen p mean: 0.4472796618938446, gen p mean: -0.046419475227594376, mean p set: 0.4477599561214447The modified gen p mean: 0.4491872787475586, gen p mean: -0.04722985252737999, mean p set: 0.4496676027774811
loss_pred:0.012803446501493454, decouple_loss:0.0009854641975834966
loss_pred:0.013780146837234497, decouple_loss:0.001129407319240272
Iteration: 2260, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44832953810691833, gen p mean: -0.044747382402420044, mean p set: 0.44880983233451843
loss_pred:0.014285506680607796, decouple_loss:0.0010727571789175272
The modified gen p mean: 0.4480414390563965, gen p mean: -0.04607539251446724, mean p set: 0.44852176308631897The modified gen p mean: 0.4472081959247589, gen p mean: -0.04355718195438385, mean p set: 0.447688490152359
loss_pred:0.013675232417881489, decouple_loss:0.0010133720934391022
loss_pred:0.01363018061965704, decouple_loss:0.0010713540250435472
2023-05-02 11:08:44 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.04742453992366791, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.042977966368198395, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.04337691143155098, mean p set: 0.4500633478164673
loss_pred:0.018994269892573357, decouple_loss:0.0010773456888273358
loss_pred:0.01782264932990074, decouple_loss:0.001036442699842155
loss_pred:0.01781749166548252, decouple_loss:0.0010194027563557029
WV_0_PC_1_EH_0_PS_40, loss: 0.018263690173625946, avg_mse: 0.026598051190376282
current test mse: 0.026598
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012020_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012020_3_24hr.npz
NaN value num: 0
Iteration: 2261, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44947320222854614, gen p mean: -0.04344257712364197, mean p set: 0.44995349645614624
loss_pred:0.01502681989222765, decouple_loss:0.0009384876466356218
The modified gen p mean: 0.4491085708141327, gen p mean: -0.04174179583787918, mean p set: 0.4495888352394104The modified gen p mean: 0.4512348771095276, gen p mean: -0.04260074719786644, mean p set: 0.4517151713371277
loss_pred:0.014684566296637058, decouple_loss:0.0009508977527730167
loss_pred:0.014747207053005695, decouple_loss:0.0010644267313182354
Iteration: 2262, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497264325618744, gen p mean: -0.04564334824681282, mean p set: 0.4502067267894745
loss_pred:0.014676964841783047, decouple_loss:0.0010410078102722764
The modified gen p mean: 0.4501035213470459, gen p mean: -0.04904434457421303, mean p set: 0.450583815574646The modified gen p mean: 0.44988805055618286, gen p mean: -0.04417725279927254, mean p set: 0.45036831498146057
loss_pred:0.015107614919543266, decouple_loss:0.0010945640970021486
loss_pred:0.01490833144634962, decouple_loss:0.0010204449063166976
Iteration: 2263, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504680633544922, gen p mean: -0.04262181743979454, mean p set: 0.4509483277797699
loss_pred:0.015391598455607891, decouple_loss:0.0010428305249661207
The modified gen p mean: 0.4498622715473175, gen p mean: -0.04175153002142906, mean p set: 0.4503425657749176The modified gen p mean: 0.4493504762649536, gen p mean: -0.042376503348350525, mean p set: 0.4498307406902313
loss_pred:0.014542262069880962, decouple_loss:0.001065672724507749
loss_pred:0.014202196151018143, decouple_loss:0.0011557273101061583
Iteration: 2264, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45014554262161255, gen p mean: -0.03740810230374336, mean p set: 0.45062586665153503
loss_pred:0.014547687955200672, decouple_loss:0.0010165403364226222
The modified gen p mean: 0.45015162229537964, gen p mean: -0.03799407184123993, mean p set: 0.4506319463253021The modified gen p mean: 0.4494032561779022, gen p mean: -0.03863320127129555, mean p set: 0.44988352060317993
loss_pred:0.014249221421778202, decouple_loss:0.001017089351080358
loss_pred:0.014719799160957336, decouple_loss:0.0010501113720238209
Iteration: 2265, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492187201976776, gen p mean: -0.040798429399728775, mean p set: 0.4496990144252777
loss_pred:0.015230320394039154, decouple_loss:0.0010899290209636092
The modified gen p mean: 0.44969961047172546, gen p mean: -0.04052644595503807, mean p set: 0.45017993450164795The modified gen p mean: 0.4502379298210144, gen p mean: -0.039261527359485626, mean p set: 0.4507182538509369
loss_pred:0.014726915396749973, decouple_loss:0.001088096876628697
loss_pred:0.014427612535655499, decouple_loss:0.0010600220412015915
Iteration: 2266, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493243396282196, gen p mean: -0.03915417939424515, mean p set: 0.4498046338558197
loss_pred:0.014782466925680637, decouple_loss:0.0011573449010029435
The modified gen p mean: 0.4493539035320282, gen p mean: -0.03884273022413254, mean p set: 0.4498342275619507The modified gen p mean: 0.45008423924446106, gen p mean: -0.045138951390981674, mean p set: 0.45056453347206116
loss_pred:0.01504866685718298, decouple_loss:0.0010555514600127935
loss_pred:0.014807605184614658, decouple_loss:0.000996853574179113
Iteration: 2267, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44868531823158264, gen p mean: -0.03974871337413788, mean p set: 0.4491656422615051
loss_pred:0.014566496014595032, decouple_loss:0.001068803365342319
The modified gen p mean: 0.4503428041934967, gen p mean: -0.04398933798074722, mean p set: 0.4508230984210968The modified gen p mean: 0.4503808617591858, gen p mean: -0.03884303197264671, mean p set: 0.4508611261844635
loss_pred:0.014345246367156506, decouple_loss:0.0010005348594859242
loss_pred:0.014721013605594635, decouple_loss:0.0011636270210146904
Iteration: 2268, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507172703742981, gen p mean: -0.039165981113910675, mean p set: 0.4511975646018982
loss_pred:0.0140394801273942, decouple_loss:0.0010839904425665736
The modified gen p mean: 0.4506217837333679, gen p mean: -0.039552900940179825, mean p set: 0.451102077960968The modified gen p mean: 0.4496612548828125, gen p mean: -0.045163098722696304, mean p set: 0.4501415491104126
loss_pred:0.013799956068396568, decouple_loss:0.0010966198751702905
loss_pred:0.014386728405952454, decouple_loss:0.0010262352880090475
Iteration: 2269, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44925618171691895, gen p mean: -0.0415988527238369, mean p set: 0.44973650574684143
loss_pred:0.014406141825020313, decouple_loss:0.0012013122905045748
The modified gen p mean: 0.4493504762649536, gen p mean: -0.036282967776060104, mean p set: 0.4498307704925537The modified gen p mean: 0.4505953788757324, gen p mean: -0.040551066398620605, mean p set: 0.4510757029056549
loss_pred:0.014434093609452248, decouple_loss:0.0011338706826791167
loss_pred:0.014814223162829876, decouple_loss:0.0011102892458438873
Iteration: 2270, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450135201215744, gen p mean: -0.044617436826229095, mean p set: 0.4506154954433441
loss_pred:0.014403714798390865, decouple_loss:0.0011235530255362391
The modified gen p mean: 0.44904807209968567, gen p mean: -0.03969394043087959, mean p set: 0.44952836632728577The modified gen p mean: 0.449248343706131, gen p mean: -0.03815969079732895, mean p set: 0.44972866773605347
loss_pred:0.014275219291448593, decouple_loss:0.0010217686649411917
loss_pred:0.014674216508865356, decouple_loss:0.0010227281600236893
2023-05-02 11:11:16 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.043762002140283585, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.039317402988672256, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.03968442231416702, mean p set: 0.4500633478164673
loss_pred:0.01871625892817974, decouple_loss:0.0011950167827308178
loss_pred:0.017579341307282448, decouple_loss:0.001135742524638772
loss_pred:0.017574917525053024, decouple_loss:0.001119913998991251
WV_0_PC_1_EH_0_PS_40, loss: 0.018014349043369293, avg_mse: 0.02610042691230774
current test mse: 0.0261
Iteration: 2271, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481290280818939, gen p mean: -0.04035000875592232, mean p set: 0.448609322309494
The modified gen p mean: 0.449334055185318, gen p mean: -0.04138520359992981, mean p set: 0.4498143792152405
The modified gen p mean: 0.45010730624198914, gen p mean: -0.04031086713075638, mean p set: 0.45058757066726685
loss_pred:0.014242690987884998, decouple_loss:0.00109799113124609
loss_pred:0.014628462493419647, decouple_loss:0.001164443208836019
loss_pred:0.014727175235748291, decouple_loss:0.0011334227165207267
Iteration: 2272, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489690959453583, gen p mean: -0.041110411286354065, mean p set: 0.44944941997528076
loss_pred:0.01445279736071825, decouple_loss:0.0009894748218357563
The modified gen p mean: 0.4502818286418915, gen p mean: -0.036791879683732986, mean p set: 0.4507621228694916The modified gen p mean: 0.4494397044181824, gen p mean: -0.039379216730594635, mean p set: 0.4499199688434601
loss_pred:0.014485123567283154, decouple_loss:0.0009742903639562428
loss_pred:0.014883189462125301, decouple_loss:0.0010545124532654881
Iteration: 2273, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44872456789016724, gen p mean: -0.04160808026790619, mean p set: 0.4492048919200897
loss_pred:0.014170143753290176, decouple_loss:0.001009795581921935
The modified gen p mean: 0.4496549367904663, gen p mean: -0.0388098880648613, mean p set: 0.450135201215744The modified gen p mean: 0.4501695930957794, gen p mean: -0.04229682311415672, mean p set: 0.4506498873233795
loss_pred:0.01426437683403492, decouple_loss:0.0010032209102064371
loss_pred:0.014842146076261997, decouple_loss:0.0010534990578889847
Iteration: 2274, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44990211725234985, gen p mean: -0.042209137231111526, mean p set: 0.45038241147994995
loss_pred:0.014335518702864647, decouple_loss:0.0011785832466557622
The modified gen p mean: 0.44940629601478577, gen p mean: -0.04314043000340462, mean p set: 0.44988662004470825The modified gen p mean: 0.4495578706264496, gen p mean: -0.0414070300757885, mean p set: 0.4500381648540497
loss_pred:0.013976383954286575, decouple_loss:0.0011046173749491572
loss_pred:0.01408911682665348, decouple_loss:0.0010821811156347394
Iteration: 2275, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44958531856536865, gen p mean: -0.041660912334918976, mean p set: 0.45006564259529114
loss_pred:0.014503956772387028, decouple_loss:0.0011055986396968365
The modified gen p mean: 0.45068731904029846, gen p mean: -0.04218782112002373, mean p set: 0.45116761326789856The modified gen p mean: 0.448612242937088, gen p mean: -0.03995274752378464, mean p set: 0.4490925073623657
loss_pred:0.014663100242614746, decouple_loss:0.0010995562188327312
loss_pred:0.01484554074704647, decouple_loss:0.0011579289566725492
Iteration: 2276, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45019662380218506, gen p mean: -0.038380950689315796, mean p set: 0.45067691802978516
loss_pred:0.01483127474784851, decouple_loss:0.0011048123706132174
The modified gen p mean: 0.4507772922515869, gen p mean: -0.040951721370220184, mean p set: 0.4512575566768646The modified gen p mean: 0.44966641068458557, gen p mean: -0.04122331738471985, mean p set: 0.45014673471450806
loss_pred:0.014173371717333794, decouple_loss:0.0009972386760637164
loss_pred:0.014039551839232445, decouple_loss:0.0010871129343286157
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 2277, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507904052734375, gen p mean: -0.046679094433784485, mean p set: 0.45127072930336
loss_pred:0.0144687220454216, decouple_loss:0.0011876432690769434
The modified gen p mean: 0.4487124979496002, gen p mean: -0.043858952820301056, mean p set: 0.4491928219795227The modified gen p mean: 0.45025718212127686, gen p mean: -0.041837356984615326, mean p set: 0.45073747634887695
loss_pred:0.013934982009232044, decouple_loss:0.0011521250708028674
loss_pred:0.014751101844012737, decouple_loss:0.0011895215138792992
Iteration: 2278, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491356611251831, gen p mean: -0.04598166048526764, mean p set: 0.4496159553527832
loss_pred:0.0144838010892272, decouple_loss:0.0010493923909962177
The modified gen p mean: 0.4499345123767853, gen p mean: -0.039918575435876846, mean p set: 0.4504148066043854The modified gen p mean: 0.4489012062549591, gen p mean: -0.04342405125498772, mean p set: 0.4493815302848816
loss_pred:0.014848779886960983, decouple_loss:0.0010634635109454393
loss_pred:0.014675221405923367, decouple_loss:0.0011041261022910476
Iteration: 2279, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505214989185333, gen p mean: -0.05032361298799515, mean p set: 0.4510018229484558
loss_pred:0.01523241214454174, decouple_loss:0.0010899699991568923
The modified gen p mean: 0.4508281350135803, gen p mean: -0.04874079301953316, mean p set: 0.4513084292411804The modified gen p mean: 0.4498020112514496, gen p mean: -0.044472504407167435, mean p set: 0.4502823054790497
loss_pred:0.014190935529768467, decouple_loss:0.001077868859283626
loss_pred:0.014334375038743019, decouple_loss:0.0010494468733668327
Iteration: 2280, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45044729113578796, gen p mean: -0.04101824760437012, mean p set: 0.45092761516571045
loss_pred:0.013994955457746983, decouple_loss:0.001023156219162047
The modified gen p mean: 0.44821521639823914, gen p mean: -0.0434391126036644, mean p set: 0.4486955404281616The modified gen p mean: 0.4497753381729126, gen p mean: -0.043349433690309525, mean p set: 0.4502556622028351
loss_pred:0.01452613715082407, decouple_loss:0.0010518350172787905
loss_pred:0.014637835323810577, decouple_loss:0.0010814245324581861
2023-05-02 11:13:10 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.04656263068318367, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.042372655123472214, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04277525097131729, mean p set: 0.4500633478164673
loss_pred:0.018680104985833168, decouple_loss:0.001160020474344492
loss_pred:0.017617397010326385, decouple_loss:0.0011472452897578478
loss_pred:0.017632359638810158, decouple_loss:0.0011651588138192892
WV_0_PC_1_EH_0_PS_40, loss: 0.018034495413303375, avg_mse: 0.02616354636847973
current test mse: 0.026164
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012006_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012006_3_24hr.npz
NaN value num: 0
Iteration: 2281, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513205289840698, gen p mean: -0.04391178861260414, mean p set: 0.4518008232116699
loss_pred:0.016548726707696915, decouple_loss:0.0011715044965967536
The modified gen p mean: 0.4523267447948456, gen p mean: -0.04255659505724907, mean p set: 0.4528070092201233The modified gen p mean: 0.45025017857551575, gen p mean: -0.04325278475880623, mean p set: 0.45073044300079346
loss_pred:0.016497980803251266, decouple_loss:0.0011843964457511902
loss_pred:0.01717468723654747, decouple_loss:0.001130920136347413
Iteration: 2282, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45283243060112, gen p mean: -0.035161521285772324, mean p set: 0.4533127248287201
loss_pred:0.016360800713300705, decouple_loss:0.0011830119183287024
The modified gen p mean: 0.45566442608833313, gen p mean: -0.03907832130789757, mean p set: 0.45614469051361084The modified gen p mean: 0.45029473304748535, gen p mean: -0.04297029599547386, mean p set: 0.45077502727508545
loss_pred:0.017283650115132332, decouple_loss:0.0010755812982097268
loss_pred:0.016153769567608833, decouple_loss:0.0012191087007522583
Iteration: 2283, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45167726278305054, gen p mean: -0.039581049233675, mean p set: 0.45215752720832825
loss_pred:0.01678861305117607, decouple_loss:0.0011972598731517792
The modified gen p mean: 0.45280522108078003, gen p mean: -0.04283040016889572, mean p set: 0.45328548550605774The modified gen p mean: 0.45077621936798096, gen p mean: -0.0387439951300621, mean p set: 0.45125651359558105
loss_pred:0.016032373532652855, decouple_loss:0.0013288374757394195
loss_pred:0.01640983112156391, decouple_loss:0.0013961871154606342
Iteration: 2284, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45203450322151184, gen p mean: -0.040907543152570724, mean p set: 0.45251479744911194
loss_pred:0.016543636098504066, decouple_loss:0.0010999732185155153
The modified gen p mean: 0.45141032338142395, gen p mean: -0.04149160906672478, mean p set: 0.45189061760902405
The modified gen p mean: 0.4530589282512665, gen p mean: -0.041349947452545166, mean p set: 0.45353925228118896
loss_pred:0.01632877252995968, decouple_loss:0.001167693524621427
loss_pred:0.016193050891160965, decouple_loss:0.0011507896706461906
Iteration: 2285, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45085933804512024, gen p mean: -0.037908490747213364, mean p set: 0.45133963227272034
loss_pred:0.016500376164913177, decouple_loss:0.0011666631326079369
The modified gen p mean: 0.45109182596206665, gen p mean: -0.03690678998827934, mean p set: 0.45157214999198914The modified gen p mean: 0.45286643505096436, gen p mean: -0.03905448690056801, mean p set: 0.45334672927856445
loss_pred:0.016828900203108788, decouple_loss:0.0013242997229099274
loss_pred:0.01684413105249405, decouple_loss:0.0011439267545938492
Iteration: 2286, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45488834381103516, gen p mean: -0.037376388907432556, mean p set: 0.45536860823631287
loss_pred:0.01580696739256382, decouple_loss:0.0012154353316873312
The modified gen p mean: 0.4509139657020569, gen p mean: -0.033184945583343506, mean p set: 0.451394259929657The modified gen p mean: 0.4521520137786865, gen p mean: -0.03054162673652172, mean p set: 0.4526323080062866
loss_pred:0.016440147534012794, decouple_loss:0.0011904756538569927
loss_pred:0.01657683216035366, decouple_loss:0.0011875451309606433
Iteration: 2287, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45132339000701904, gen p mean: -0.034773748368024826, mean p set: 0.45180368423461914
loss_pred:0.016184039413928986, decouple_loss:0.0012542590266093612
The modified gen p mean: 0.45100727677345276, gen p mean: -0.04001382738351822, mean p set: 0.45148760080337524The modified gen p mean: 0.4547361135482788, gen p mean: -0.031542904675006866, mean p set: 0.4552163779735565
loss_pred:0.016376672312617302, decouple_loss:0.0011353325098752975
loss_pred:0.016513966023921967, decouple_loss:0.0010799294104799628
Iteration: 2288, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493550658226013, gen p mean: -0.03441498801112175, mean p set: 0.4498353600502014
loss_pred:0.01703125610947609, decouple_loss:0.001236707204952836
The modified gen p mean: 0.45142704248428345, gen p mean: -0.033458512276411057, mean p set: 0.45190730690956116The modified gen p mean: 0.4527682662010193, gen p mean: -0.033688951283693314, mean p set: 0.4532485604286194
loss_pred:0.016550227999687195, decouple_loss:0.0011421559611335397
loss_pred:0.017095983028411865, decouple_loss:0.0011115159140899777
Iteration: 2289, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4525321125984192, gen p mean: -0.04034318029880524, mean p set: 0.4530124366283417
loss_pred:0.016039501875638962, decouple_loss:0.0011431423481553793
The modified gen p mean: 0.4525904357433319, gen p mean: -0.039952464401721954, mean p set: 0.453070729970932The modified gen p mean: 0.45221641659736633, gen p mean: -0.035175491124391556, mean p set: 0.45269668102264404
loss_pred:0.016344774514436722, decouple_loss:0.001148005248978734
loss_pred:0.016041116788983345, decouple_loss:0.0012567610247060657
Iteration: 2290, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4512932002544403, gen p mean: -0.04102129861712456, mean p set: 0.451773464679718
loss_pred:0.016741374507546425, decouple_loss:0.0011475322535261512
The modified gen p mean: 0.4509826600551605, gen p mean: -0.03173738345503807, mean p set: 0.4514629542827606The modified gen p mean: 0.44957488775253296, gen p mean: -0.03794252499938011, mean p set: 0.45005518198013306
loss_pred:0.01629822514951229, decouple_loss:0.0011362466029822826
loss_pred:0.016518287360668182, decouple_loss:0.0011754418956115842
2023-05-02 11:15:54 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.0405532605946064, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.036270175129175186, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.03686721995472908, mean p set: 0.4500633478164673
loss_pred:0.018302924931049347, decouple_loss:0.0012396408710628748
loss_pred:0.017291339114308357, decouple_loss:0.0012258889619261026
loss_pred:0.01725582778453827, decouple_loss:0.0011468606535345316
WV_0_PC_1_EH_0_PS_40, loss: 0.017676904797554016, avg_mse: 0.025401050224900246
current test mse: 0.025401
Iteration: 2291, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4521898925304413, gen p mean: -0.02744447812438011, mean p set: 0.45267021656036377
The modified gen p mean: 0.45206886529922485, gen p mean: -0.03448687121272087, mean p set: 0.45254912972450256
The modified gen p mean: 0.45258423686027527, gen p mean: -0.03655749186873436, mean p set: 0.45306456089019775
loss_pred:0.016387397423386574, decouple_loss:0.0011574531672522426
loss_pred:0.01657920517027378, decouple_loss:0.0010460041230544448loss_pred:0.016156064346432686, decouple_loss:0.0013115504989400506
Iteration: 2292, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4524964988231659, gen p mean: -0.03239738941192627, mean p set: 0.452976793050766
loss_pred:0.016593830659985542, decouple_loss:0.0011665481142699718
The modified gen p mean: 0.4518226385116577, gen p mean: -0.03866083547472954, mean p set: 0.4523029327392578The modified gen p mean: 0.45037293434143066, gen p mean: -0.0397886261343956, mean p set: 0.45085322856903076
loss_pred:0.01637800596654415, decouple_loss:0.001293269102461636
loss_pred:0.017264315858483315, decouple_loss:0.0011575638782233
Iteration: 2293, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507061541080475, gen p mean: -0.04106583446264267, mean p set: 0.4511864483356476
loss_pred:0.01700587384402752, decouple_loss:0.0010753498645499349
The modified gen p mean: 0.45246604084968567, gen p mean: -0.028212614357471466, mean p set: 0.45294633507728577The modified gen p mean: 0.452595055103302, gen p mean: -0.03487631306052208, mean p set: 0.4530753493309021
loss_pred:0.01638966239988804, decouple_loss:0.0012563914060592651
loss_pred:0.016380641609430313, decouple_loss:0.0010136450873687863
Iteration: 2294, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500974416732788, gen p mean: -0.043536413460969925, mean p set: 0.4505777657032013
loss_pred:0.016601959243416786, decouple_loss:0.0010439978213980794
The modified gen p mean: 0.45154979825019836, gen p mean: -0.04112881422042847, mean p set: 0.45203009247779846The modified gen p mean: 0.4516352713108063, gen p mean: -0.038538530468940735, mean p set: 0.45211559534072876
loss_pred:0.016458630561828613, decouple_loss:0.0010792659595608711
loss_pred:0.016114894300699234, decouple_loss:0.001034315675497055
Iteration: 2295, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4524695575237274, gen p mean: -0.04880758747458458, mean p set: 0.4529498815536499
loss_pred:0.015626447275280952, decouple_loss:0.0012540130410343409
The modified gen p mean: 0.45203670859336853, gen p mean: -0.03377186134457588, mean p set: 0.452517032623291The modified gen p mean: 0.4524969458580017, gen p mean: -0.038968365639448166, mean p set: 0.4529772400856018
loss_pred:0.01643555238842964, decouple_loss:0.0009693235042504966
loss_pred:0.016244519501924515, decouple_loss:0.0010327702620998025
Iteration: 2296, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44968923926353455, gen p mean: -0.04494169354438782, mean p set: 0.45016953349113464
loss_pred:0.016458014026284218, decouple_loss:0.0010556327179074287
The modified gen p mean: 0.45300841331481934, gen p mean: -0.04296582564711571, mean p set: 0.45348870754241943The modified gen p mean: 0.451790988445282, gen p mean: -0.041623521596193314, mean p set: 0.45227131247520447
loss_pred:0.016188232228159904, decouple_loss:0.0010359090520069003
loss_pred:0.016226952895522118, decouple_loss:0.0011046454310417175
Iteration: 2297, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4538275897502899, gen p mean: -0.038209330290555954, mean p set: 0.4543078541755676
loss_pred:0.016350852325558662, decouple_loss:0.0010945021640509367
The modified gen p mean: 0.4523903429508209, gen p mean: -0.04406943544745445, mean p set: 0.452870637178421The modified gen p mean: 0.45311006903648376, gen p mean: -0.04359029605984688, mean p set: 0.45359036326408386
loss_pred:0.017070023342967033, decouple_loss:0.0010631635086610913
loss_pred:0.016966242343187332, decouple_loss:0.0011005083797499537
Iteration: 2298, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45303037762641907, gen p mean: -0.03777353838086128, mean p set: 0.45351067185401917
loss_pred:0.016245441511273384, decouple_loss:0.0010687877656891942
The modified gen p mean: 0.45296230912208557, gen p mean: -0.0402374267578125, mean p set: 0.4534425735473633The modified gen p mean: 0.4534645974636078, gen p mean: -0.04260396212339401, mean p set: 0.4539449214935303
loss_pred:0.016329271718859673, decouple_loss:0.0010428396053612232
loss_pred:0.016277819871902466, decouple_loss:0.0010353135876357555
Iteration: 2299, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4527053236961365, gen p mean: -0.04547920078039169, mean p set: 0.4531856179237366
loss_pred:0.01590256206691265, decouple_loss:0.0010766277555376291
The modified gen p mean: 0.4508713483810425, gen p mean: -0.04249332472681999, mean p set: 0.4513516426086426The modified gen p mean: 0.4539056420326233, gen p mean: -0.04262041300535202, mean p set: 0.4543859660625458
loss_pred:0.016352713108062744, decouple_loss:0.0010205681901425123
loss_pred:0.0157990213483572, decouple_loss:0.000979178468696773
Iteration: 2300, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.451680064201355, gen p mean: -0.04011518880724907, mean p set: 0.4521603584289551
loss_pred:0.01622711308300495, decouple_loss:0.0011211112141609192
The modified gen p mean: 0.45238539576530457, gen p mean: -0.033265214413404465, mean p set: 0.4528656601905823The modified gen p mean: 0.45132389664649963, gen p mean: -0.03566254302859306, mean p set: 0.4518042206764221
loss_pred:0.01636522263288498, decouple_loss:0.001085740397684276
loss_pred:0.01583811454474926, decouple_loss:0.0010060735512524843
2023-05-02 11:17:48 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.041607338935136795, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.037064146250486374, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.03783164173364639, mean p set: 0.4500633478164673
loss_pred:0.01824226789176464, decouple_loss:0.0011377321789041162
loss_pred:0.0172763392329216, decouple_loss:0.0010757881682366133
loss_pred:0.017241524532437325, decouple_loss:0.0011648563668131828
WV_0_PC_1_EH_0_PS_40, loss: 0.017643017694354057, avg_mse: 0.02533337101340294
current test mse: 0.025333
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012004_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012004_3_24hr.npz
NaN value num: 0
Iteration: 2301, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44827932119369507, gen p mean: -0.04275909811258316, mean p set: 0.44875964522361755
loss_pred:0.014448460191488266, decouple_loss:0.0011076690861955285
The modified gen p mean: 0.447194367647171, gen p mean: -0.034525349736213684, mean p set: 0.4476746618747711
The modified gen p mean: 0.44784218072891235, gen p mean: -0.03446551412343979, mean p set: 0.44832247495651245
loss_pred:0.014973659068346024, decouple_loss:0.0010881497291848063
loss_pred:0.015375420451164246, decouple_loss:0.00102583400439471
Iteration: 2302, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475368559360504, gen p mean: -0.036872535943984985, mean p set: 0.4480171501636505
loss_pred:0.015059280209243298, decouple_loss:0.0012119156308472157
The modified gen p mean: 0.4466928243637085, gen p mean: -0.04261714592576027, mean p set: 0.4471730887889862The modified gen p mean: 0.44795340299606323, gen p mean: -0.0413675494492054, mean p set: 0.44843369722366333
loss_pred:0.01445970218628645, decouple_loss:0.0012627430260181427
loss_pred:0.014917295426130295, decouple_loss:0.0012694261968135834
Iteration: 2303, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44667744636535645, gen p mean: -0.044260889291763306, mean p set: 0.44715774059295654
loss_pred:0.01430165208876133, decouple_loss:0.0010913754813373089
The modified gen p mean: 0.4478653371334076, gen p mean: -0.03993053734302521, mean p set: 0.4483456313610077The modified gen p mean: 0.4481970965862274, gen p mean: -0.03862086310982704, mean p set: 0.4486773908138275
loss_pred:0.014596149325370789, decouple_loss:0.0010829464299604297
loss_pred:0.014219244942069054, decouple_loss:0.0010480711935088038
Iteration: 2304, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44772395491600037, gen p mean: -0.038934219628572464, mean p set: 0.44820424914360046
loss_pred:0.014543961733579636, decouple_loss:0.0011555867968127131
The modified gen p mean: 0.44809919595718384, gen p mean: -0.042464058846235275, mean p set: 0.44857946038246155The modified gen p mean: 0.44733962416648865, gen p mean: -0.043955136090517044, mean p set: 0.44781988859176636
loss_pred:0.013903604820370674, decouple_loss:0.0012854879023507237
loss_pred:0.014751939103007317, decouple_loss:0.001151124481111765
Iteration: 2305, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44812795519828796, gen p mean: -0.04426286369562149, mean p set: 0.44860827922821045
loss_pred:0.014214005321264267, decouple_loss:0.0012827960308641195
The modified gen p mean: 0.4481167495250702, gen p mean: -0.04333215579390526, mean p set: 0.4485970735549927The modified gen p mean: 0.4479922950267792, gen p mean: -0.04497358575463295, mean p set: 0.4484725892543793
loss_pred:0.013744208961725235, decouple_loss:0.0012574438005685806
loss_pred:0.013758569024503231, decouple_loss:0.0012647116091102362
Iteration: 2306, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4462664723396301, gen p mean: -0.04657657444477081, mean p set: 0.4467467665672302
loss_pred:0.013916179537773132, decouple_loss:0.0013686863239854574
The modified gen p mean: 0.44716641306877136, gen p mean: -0.041859641671180725, mean p set: 0.44764673709869385The modified gen p mean: 0.44786497950553894, gen p mean: -0.04328266903758049, mean p set: 0.44834527373313904
loss_pred:0.014255738817155361, decouple_loss:0.001340129179880023
loss_pred:0.014501886442303658, decouple_loss:0.0013178467052057385
Iteration: 2307, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4463234543800354, gen p mean: -0.05262884497642517, mean p set: 0.4468037486076355
loss_pred:0.014464090578258038, decouple_loss:0.0012135714059695601
The modified gen p mean: 0.44733601808547974, gen p mean: -0.05235382169485092, mean p set: 0.44781628251075745The modified gen p mean: 0.44792696833610535, gen p mean: -0.049262672662734985, mean p set: 0.44840726256370544
loss_pred:0.014154932461678982, decouple_loss:0.0011830610455945134
loss_pred:0.014417756348848343, decouple_loss:0.0012706005945801735
Iteration: 2308, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44784584641456604, gen p mean: -0.044863659888505936, mean p set: 0.44832614064216614
loss_pred:0.013517200015485287, decouple_loss:0.001223160419613123
The modified gen p mean: 0.44769221544265747, gen p mean: -0.0478396862745285, mean p set: 0.44817250967025757The modified gen p mean: 0.44642502069473267, gen p mean: -0.04621465131640434, mean p set: 0.4469052851200104
loss_pred:0.014176799915730953, decouple_loss:0.0013782987371087074
loss_pred:0.01391284167766571, decouple_loss:0.0014433159958571196
Iteration: 2309, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44751396775245667, gen p mean: -0.04333430901169777, mean p set: 0.44799429178237915
loss_pred:0.013657563365995884, decouple_loss:0.001218787976540625
The modified gen p mean: 0.4473298192024231, gen p mean: -0.04874731972813606, mean p set: 0.4478101134300232The modified gen p mean: 0.4468432366847992, gen p mean: -0.04918467998504639, mean p set: 0.4473235309123993
loss_pred:0.014142920263111591, decouple_loss:0.0012144838692620397
loss_pred:0.014079526998102665, decouple_loss:0.0011717533925548196
Iteration: 2310, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44762372970581055, gen p mean: -0.05070009455084801, mean p set: 0.44810402393341064
loss_pred:0.013607646338641644, decouple_loss:0.0012185227824375033
The modified gen p mean: 0.44782301783561707, gen p mean: -0.05348757654428482, mean p set: 0.44830334186553955The modified gen p mean: 0.44732123613357544, gen p mean: -0.05212125554680824, mean p set: 0.44780153036117554
loss_pred:0.013769370503723621, decouple_loss:0.0013229817850515246
loss_pred:0.014509487897157669, decouple_loss:0.0012491752859205008
2023-05-02 11:20:22 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.05113906413316727, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.0464746318757534, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.04717760160565376, mean p set: 0.4500633478164673
loss_pred:0.01885957643389702, decouple_loss:0.0012154298601672053
loss_pred:0.017834868282079697, decouple_loss:0.0012141014449298382
loss_pred:0.017874175682663918, decouple_loss:0.0011932100169360638
WV_0_PC_1_EH_0_PS_40, loss: 0.01824991963803768, avg_mse: 0.026485500857234
current test mse: 0.026486
Iteration: 2311, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483192265033722, gen p mean: -0.04473577067255974, mean p set: 0.4487995207309723
The modified gen p mean: 0.447773814201355, gen p mean: -0.05214667320251465, mean p set: 0.4482541084289551
The modified gen p mean: 0.44744789600372314, gen p mean: -0.04484618827700615, mean p set: 0.44792816042900085
loss_pred:0.013593204319477081, decouple_loss:0.001190341543406248
loss_pred:0.014228705316781998, decouple_loss:0.001163283595815301
loss_pred:0.014008388854563236, decouple_loss:0.001189132104627788
Iteration: 2312, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474705457687378, gen p mean: -0.0449620746076107, mean p set: 0.4479508101940155
loss_pred:0.014126479625701904, decouple_loss:0.0012736128410324454
The modified gen p mean: 0.4481734037399292, gen p mean: -0.04743807762861252, mean p set: 0.4486536979675293The modified gen p mean: 0.4476580023765564, gen p mean: -0.04946300759911537, mean p set: 0.4481382668018341
loss_pred:0.013503819704055786, decouple_loss:0.001340708346106112
loss_pred:0.013445577584207058, decouple_loss:0.0013423102209344506
Iteration: 2313, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4458563029766083, gen p mean: -0.0509926863014698, mean p set: 0.446336567401886
loss_pred:0.01375693827867508, decouple_loss:0.001134170568548143
The modified gen p mean: 0.4480590224266052, gen p mean: -0.047226544469594955, mean p set: 0.4485393166542053The modified gen p mean: 0.448651522397995, gen p mean: -0.045151546597480774, mean p set: 0.4491317868232727
loss_pred:0.013603395782411098, decouple_loss:0.0012075484264642
loss_pred:0.013572164811193943, decouple_loss:0.0010825922945514321
Iteration: 2314, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4460369944572449, gen p mean: -0.04569649696350098, mean p set: 0.44651728868484497
loss_pred:0.01360506471246481, decouple_loss:0.0012761506950482726
The modified gen p mean: 0.4486333727836609, gen p mean: -0.05175699293613434, mean p set: 0.449113667011261The modified gen p mean: 0.4473423361778259, gen p mean: -0.04874706640839577, mean p set: 0.447822630405426
loss_pred:0.013449553400278091, decouple_loss:0.0011823067907243967
loss_pred:0.01422920823097229, decouple_loss:0.001229443121701479
Iteration: 2315, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44725462794303894, gen p mean: -0.04750330373644829, mean p set: 0.44773492217063904
loss_pred:0.013772910460829735, decouple_loss:0.0011323729995638132
The modified gen p mean: 0.4466300308704376, gen p mean: -0.0502583310008049, mean p set: 0.4471103250980377The modified gen p mean: 0.4472848176956177, gen p mean: -0.04244307056069374, mean p set: 0.4477651119232178
loss_pred:0.014380875043570995, decouple_loss:0.0012226374819874763
loss_pred:0.01383870467543602, decouple_loss:0.0010983477113768458
Iteration: 2316, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470151662826538, gen p mean: -0.04990358278155327, mean p set: 0.4474954903125763
loss_pred:0.01435436774045229, decouple_loss:0.0011408408172428608
The modified gen p mean: 0.4483368694782257, gen p mean: -0.044809672981500626, mean p set: 0.4488171935081482The modified gen p mean: 0.4473123550415039, gen p mean: -0.049898725003004074, mean p set: 0.4477926790714264
loss_pred:0.013437923043966293, decouple_loss:0.0011242759646847844
loss_pred:0.013754721730947495, decouple_loss:0.0011082752607762814
Iteration: 2317, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466976225376129, gen p mean: -0.043899789452552795, mean p set: 0.447177916765213
loss_pred:0.013596107251942158, decouple_loss:0.0011608367785811424
The modified gen p mean: 0.4481574296951294, gen p mean: -0.051334917545318604, mean p set: 0.4486377537250519The modified gen p mean: 0.44763290882110596, gen p mean: -0.05154281482100487, mean p set: 0.44811320304870605
loss_pred:0.01358429528772831, decouple_loss:0.001104086171835661
loss_pred:0.013833319768309593, decouple_loss:0.0011179224820807576
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 2318, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44606471061706543, gen p mean: -0.0488525852560997, mean p set: 0.4465450048446655
loss_pred:0.013798665255308151, decouple_loss:0.00114388857036829
The modified gen p mean: 0.44727715849876404, gen p mean: -0.05019500106573105, mean p set: 0.44775745272636414The modified gen p mean: 0.445578396320343, gen p mean: -0.04274986684322357, mean p set: 0.4460587203502655
loss_pred:0.013690592721104622, decouple_loss:0.0010640083346515894
loss_pred:0.013625605031847954, decouple_loss:0.0011398608330637217
Iteration: 2319, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467615783214569, gen p mean: -0.049198225140571594, mean p set: 0.447241872549057
loss_pred:0.013879464007914066, decouple_loss:0.0010772142559289932
The modified gen p mean: 0.44665244221687317, gen p mean: -0.04490073397755623, mean p set: 0.44713273644447327
The modified gen p mean: 0.4466818571090698, gen p mean: -0.04588136076927185, mean p set: 0.4471621811389923
loss_pred:0.013447534292936325, decouple_loss:0.0010113065363839269
loss_pred:0.013767030090093613, decouple_loss:0.001063710660673678
Iteration: 2320, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44619256258010864, gen p mean: -0.0494973286986351, mean p set: 0.44667288661003113
loss_pred:0.013522297143936157, decouple_loss:0.0010549926664680243
The modified gen p mean: 0.44809389114379883, gen p mean: -0.04494745656847954, mean p set: 0.4485742151737213The modified gen p mean: 0.44804468750953674, gen p mean: -0.04468023031949997, mean p set: 0.44852498173713684
loss_pred:0.013489793054759502, decouple_loss:0.0009753623162396252
loss_pred:0.013965170830488205, decouple_loss:0.0010146566201001406
2023-05-02 11:22:17 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.048160891979932785, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04363644868135452, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.04418201372027397, mean p set: 0.4500633478164673
loss_pred:0.01894928142428398, decouple_loss:0.0010631068143993616
loss_pred:0.017887119203805923, decouple_loss:0.0011059072567149997
loss_pred:0.017894376069307327, decouple_loss:0.001058886875398457
WV_0_PC_1_EH_0_PS_40, loss: 0.018297391012310982, avg_mse: 0.02663159929215908
current test mse: 0.026632
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012007_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012007_3_24hr.npz
NaN value num: 0
Iteration: 2321, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45448148250579834, gen p mean: -0.04480414465069771, mean p set: 0.45496177673339844
loss_pred:0.016827382147312164, decouple_loss:0.0013672710629180074
The modified gen p mean: 0.4531993865966797, gen p mean: -0.04411594197154045, mean p set: 0.4536796808242798
The modified gen p mean: 0.4497041702270508, gen p mean: -0.03995007649064064, mean p set: 0.4501844644546509
loss_pred:0.01690300740301609, decouple_loss:0.0014076943043619394loss_pred:0.018064718693494797, decouple_loss:0.001302995253354311
Iteration: 2322, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45197051763534546, gen p mean: -0.035739582031965256, mean p set: 0.45245081186294556
loss_pred:0.016979102045297623, decouple_loss:0.001205687178298831
The modified gen p mean: 0.4503123462200165, gen p mean: -0.041210927069187164, mean p set: 0.45079267024993896The modified gen p mean: 0.4511910676956177, gen p mean: -0.03815585747361183, mean p set: 0.4516713619232178
loss_pred:0.01678800955414772, decouple_loss:0.0011475121136754751
loss_pred:0.01703321747481823, decouple_loss:0.0011803365778177977
Iteration: 2323, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502141773700714, gen p mean: -0.03906477242708206, mean p set: 0.4506944417953491
loss_pred:0.01690991036593914, decouple_loss:0.001160354702733457
The modified gen p mean: 0.45101696252822876, gen p mean: -0.034412190318107605, mean p set: 0.45149728655815125The modified gen p mean: 0.44939470291137695, gen p mean: -0.040703605860471725, mean p set: 0.44987502694129944
loss_pred:0.018388159573078156, decouple_loss:0.0010806138161569834
loss_pred:0.017431512475013733, decouple_loss:0.0011532807257026434
Iteration: 2324, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45065465569496155, gen p mean: -0.03860563784837723, mean p set: 0.45113492012023926
loss_pred:0.01730174385011196, decouple_loss:0.0011301058111712337
The modified gen p mean: 0.4515712857246399, gen p mean: -0.033420972526073456, mean p set: 0.4520516097545624The modified gen p mean: 0.45048457384109497, gen p mean: -0.035303179174661636, mean p set: 0.45096486806869507
loss_pred:0.01625809259712696, decouple_loss:0.0011188994394615293
loss_pred:0.017824338749051094, decouple_loss:0.0011575055541470647
Iteration: 2325, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.451825886964798, gen p mean: -0.04207494854927063, mean p set: 0.45230618119239807
loss_pred:0.01793159358203411, decouple_loss:0.001198265701532364
The modified gen p mean: 0.451885849237442, gen p mean: -0.040084902197122574, mean p set: 0.4523661732673645The modified gen p mean: 0.45178931951522827, gen p mean: -0.038222793489694595, mean p set: 0.452269583940506
loss_pred:0.017214640974998474, decouple_loss:0.0011783423833549023
loss_pred:0.016606833785772324, decouple_loss:0.0011721806367859244
Iteration: 2326, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45001882314682007, gen p mean: -0.04333300516009331, mean p set: 0.45049911737442017
The modified gen p mean: 0.45170649886131287, gen p mean: -0.032804787158966064, mean p set: 0.4521867632865906
loss_pred:0.01675482839345932, decouple_loss:0.0011790664866566658
loss_pred:0.016682583838701248, decouple_loss:0.0011540432460606098
The modified gen p mean: 0.45008569955825806, gen p mean: -0.03523215651512146, mean p set: 0.45056599378585815
loss_pred:0.018080534413456917, decouple_loss:0.0012061026645824313
Iteration: 2327, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44957563281059265, gen p mean: -0.038316044956445694, mean p set: 0.45005589723587036
loss_pred:0.017177322879433632, decouple_loss:0.0010655989171937108
The modified gen p mean: 0.4534813463687897, gen p mean: -0.03370007127523422, mean p set: 0.4539616107940674The modified gen p mean: 0.4512530565261841, gen p mean: -0.03632214292883873, mean p set: 0.45173338055610657
loss_pred:0.017695719376206398, decouple_loss:0.0011091039050370455
loss_pred:0.017226766794919968, decouple_loss:0.0012704511173069477
Iteration: 2328, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.451246976852417, gen p mean: -0.031155390664935112, mean p set: 0.4517273008823395
loss_pred:0.016657108440995216, decouple_loss:0.0010963967069983482
The modified gen p mean: 0.4503884017467499, gen p mean: -0.03476487100124359, mean p set: 0.45086869597435The modified gen p mean: 0.4501040279865265, gen p mean: -0.030369503423571587, mean p set: 0.4505843222141266
loss_pred:0.017477892339229584, decouple_loss:0.0011728940298780799
loss_pred:0.017740681767463684, decouple_loss:0.0011557183461263776
Iteration: 2329, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4519668221473694, gen p mean: -0.039240218698978424, mean p set: 0.45244714617729187
loss_pred:0.01667441986501217, decouple_loss:0.0011031446047127247
The modified gen p mean: 0.4508230984210968, gen p mean: -0.03457280248403549, mean p set: 0.4513033628463745The modified gen p mean: 0.45251888036727905, gen p mean: -0.03730608895421028, mean p set: 0.45299920439720154
loss_pred:0.01708659715950489, decouple_loss:0.0010413420386612415
loss_pred:0.016853896901011467, decouple_loss:0.0010080373613163829
Iteration: 2330, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45173612236976624, gen p mean: -0.03812383487820625, mean p set: 0.45221641659736633
loss_pred:0.0166525449603796, decouple_loss:0.0011269786627963185
The modified gen p mean: 0.4498804211616516, gen p mean: -0.033654436469078064, mean p set: 0.4503606855869293The modified gen p mean: 0.4500962197780609, gen p mean: -0.03761345520615578, mean p set: 0.450576514005661
loss_pred:0.01777706854045391, decouple_loss:0.001176275429315865
loss_pred:0.01635955087840557, decouple_loss:0.0011549991322681308
2023-05-02 11:24:51 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.042364977300167084, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.037591464817523956, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.038216374814510345, mean p set: 0.4500633478164673
loss_pred:0.01837729848921299, decouple_loss:0.001097902306355536
loss_pred:0.017341837286949158, decouple_loss:0.0011278350139036775
loss_pred:0.017388664186000824, decouple_loss:0.001125840819440782
WV_0_PC_1_EH_0_PS_40, loss: 0.017758462578058243, avg_mse: 0.025538798421621323
current test mse: 0.025539
Iteration: 2331, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494204521179199, gen p mean: -0.03757815808057785, mean p set: 0.44990074634552
The modified gen p mean: 0.45149409770965576, gen p mean: -0.03771277889609337, mean p set: 0.45197439193725586
The modified gen p mean: 0.4499392807483673, gen p mean: -0.030263932421803474, mean p set: 0.450419545173645
loss_pred:0.017862142994999886, decouple_loss:0.001121645444072783
loss_pred:0.016917210072278976, decouple_loss:0.0010385883506387472
loss_pred:0.016769813373684883, decouple_loss:0.0011103558354079723
Iteration: 2332, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45081081986427307, gen p mean: -0.03502301499247551, mean p set: 0.45129111409187317
loss_pred:0.017385106533765793, decouple_loss:0.0010261981515213847
The modified gen p mean: 0.4512324929237366, gen p mean: -0.03817394748330116, mean p set: 0.45171278715133667The modified gen p mean: 0.45046982169151306, gen p mean: -0.02767711691558361, mean p set: 0.45095011591911316
loss_pred:0.017229951918125153, decouple_loss:0.0010253104846924543
loss_pred:0.016448436304926872, decouple_loss:0.0010491303401067853
Iteration: 2333, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45036694407463074, gen p mean: -0.02777453511953354, mean p set: 0.45084720849990845
loss_pred:0.016829879954457283, decouple_loss:0.0010410092072561383
The modified gen p mean: 0.44842663407325745, gen p mean: -0.035208526998758316, mean p set: 0.44890692830085754The modified gen p mean: 0.4516116976737976, gen p mean: -0.03822492063045502, mean p set: 0.4520919919013977
loss_pred:0.017599571496248245, decouple_loss:0.0010314583778381348
loss_pred:0.016426244750618935, decouple_loss:0.0010994980111718178
Iteration: 2334, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4523911774158478, gen p mean: -0.037108413875103, mean p set: 0.4528714418411255
The modified gen p mean: 0.45285338163375854, gen p mean: -0.03348191827535629, mean p set: 0.45333370566368103
loss_pred:0.01619582809507847, decouple_loss:0.0009503528126515448
loss_pred:0.016644753515720367, decouple_loss:0.0009554835851304233
The modified gen p mean: 0.4530189633369446, gen p mean: -0.032476756721735, mean p set: 0.4534992575645447
loss_pred:0.016941608861088753, decouple_loss:0.0009932939428836107
Iteration: 2335, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513186514377594, gen p mean: -0.036620479077100754, mean p set: 0.4517989158630371
loss_pred:0.016903655603528023, decouple_loss:0.0011898778611794114
The modified gen p mean: 0.4551624655723572, gen p mean: -0.038765303790569305, mean p set: 0.45564278960227966
The modified gen p mean: 0.45176780223846436, gen p mean: -0.03983864560723305, mean p set: 0.45224812626838684
loss_pred:0.016273245215415955, decouple_loss:0.0011840328807011247
loss_pred:0.016019918024539948, decouple_loss:0.0010571349412202835
Iteration: 2336, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45131629705429077, gen p mean: -0.035793669521808624, mean p set: 0.45179659128189087
loss_pred:0.016922378912568092, decouple_loss:0.0011174847604706883
The modified gen p mean: 0.45007914304733276, gen p mean: -0.04375531151890755, mean p set: 0.4505594074726105The modified gen p mean: 0.45053303241729736, gen p mean: -0.0388982892036438, mean p set: 0.45101335644721985
loss_pred:0.016939980909228325, decouple_loss:0.0009930896339938045
loss_pred:0.016350746154785156, decouple_loss:0.001048351638019085
Iteration: 2337, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4517209529876709, gen p mean: -0.04002474620938301, mean p set: 0.452201247215271
loss_pred:0.017209868878126144, decouple_loss:0.0011245416244491935
The modified gen p mean: 0.448466032743454, gen p mean: -0.04176626726984978, mean p set: 0.4489463269710541The modified gen p mean: 0.45147705078125, gen p mean: -0.04201677814126015, mean p set: 0.4519573748111725
loss_pred:0.01684436947107315, decouple_loss:0.0011436702916398644
loss_pred:0.016416076570749283, decouple_loss:0.0011781520443037152
Iteration: 2338, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4518056809902191, gen p mean: -0.03894620016217232, mean p set: 0.4522860050201416
loss_pred:0.01634392701089382, decouple_loss:0.0010204246500506997
The modified gen p mean: 0.4534832239151001, gen p mean: -0.04252041131258011, mean p set: 0.4539635181427002The modified gen p mean: 0.4516301155090332, gen p mean: -0.036549489945173264, mean p set: 0.4521104097366333
loss_pred:0.01627272181212902, decouple_loss:0.0010817352449521422
loss_pred:0.016488125547766685, decouple_loss:0.0010561919771134853
Iteration: 2339, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45146384835243225, gen p mean: -0.04322915896773338, mean p set: 0.45194417238235474
loss_pred:0.016579903662204742, decouple_loss:0.0010687712347134948
The modified gen p mean: 0.45218247175216675, gen p mean: -0.04508289322257042, mean p set: 0.45266276597976685The modified gen p mean: 0.449608713388443, gen p mean: -0.04606295004487038, mean p set: 0.4500890374183655
loss_pred:0.01650497503578663, decouple_loss:0.001097682397812605
loss_pred:0.01716141775250435, decouple_loss:0.0011130529455840588
Iteration: 2340, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4509778320789337, gen p mean: -0.03953692689538002, mean p set: 0.4514580965042114
loss_pred:0.016420796513557434, decouple_loss:0.001036080764606595
The modified gen p mean: 0.4545752704143524, gen p mean: -0.04429977014660835, mean p set: 0.4550555646419525The modified gen p mean: 0.44948065280914307, gen p mean: -0.04334252327680588, mean p set: 0.44996097683906555
loss_pred:0.01599431037902832, decouple_loss:0.001014979206956923
loss_pred:0.016566473990678787, decouple_loss:0.0010653199860826135
2023-05-02 11:26:46 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.048732057213783264, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04417216032743454, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04491998255252838, mean p set: 0.4500633478164673
loss_pred:0.01829465478658676, decouple_loss:0.0010854729916900396
loss_pred:0.017312167212367058, decouple_loss:0.0011068262392655015
loss_pred:0.017283760011196136, decouple_loss:0.0011005058186128736
WV_0_PC_1_EH_0_PS_40, loss: 0.017685074359178543, avg_mse: 0.025411201640963554
current test mse: 0.025411
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012008_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012008_3_24hr.npz
NaN value num: 0
Iteration: 2341, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492671489715576, gen p mean: -0.03887011483311653, mean p set: 0.4497474730014801
loss_pred:0.01624164544045925, decouple_loss:0.00092215248150751
The modified gen p mean: 0.4483415484428406, gen p mean: -0.045210424810647964, mean p set: 0.4488218426704407The modified gen p mean: 0.4485494792461395, gen p mean: -0.044600702822208405, mean p set: 0.44902974367141724
loss_pred:0.01676662266254425, decouple_loss:0.000978564959950745
loss_pred:0.016304928809404373, decouple_loss:0.0009597676689736545
Iteration: 2342, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490615725517273, gen p mean: -0.04320986568927765, mean p set: 0.4495418667793274
loss_pred:0.015953486785292625, decouple_loss:0.001028582570143044
The modified gen p mean: 0.4488604664802551, gen p mean: -0.04482187330722809, mean p set: 0.4493407607078552The modified gen p mean: 0.44783833622932434, gen p mean: -0.045173775404691696, mean p set: 0.44831863045692444
loss_pred:0.01656048744916916, decouple_loss:0.0010122332023456693
loss_pred:0.01651180163025856, decouple_loss:0.0010560979135334492
Iteration: 2343, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44960451126098633, gen p mean: -0.0408642441034317, mean p set: 0.4500848054885864
loss_pred:0.01703721471130848, decouple_loss:0.0009466507472097874
The modified gen p mean: 0.44863197207450867, gen p mean: -0.036489088088274, mean p set: 0.44911229610443115The modified gen p mean: 0.4479730725288391, gen p mean: -0.04345560073852539, mean p set: 0.4484533667564392
loss_pred:0.015901051461696625, decouple_loss:0.0009718555957078934
loss_pred:0.01636594347655773, decouple_loss:0.0009644374949857593
Iteration: 2344, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496261477470398, gen p mean: -0.04595251753926277, mean p set: 0.4501064419746399
loss_pred:0.015740646049380302, decouple_loss:0.0011096925009042025
The modified gen p mean: 0.4480888843536377, gen p mean: -0.0417475700378418, mean p set: 0.4485691785812378The modified gen p mean: 0.44967159628868103, gen p mean: -0.04288526624441147, mean p set: 0.45015186071395874
loss_pred:0.015684418380260468, decouple_loss:0.0010397834703326225
loss_pred:0.01660599559545517, decouple_loss:0.0010833272244781256
Iteration: 2345, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449398398399353, gen p mean: -0.03543674945831299, mean p set: 0.4498787224292755
loss_pred:0.015433224849402905, decouple_loss:0.0010779447620734572
The modified gen p mean: 0.4502919018268585, gen p mean: -0.05021213740110397, mean p set: 0.4507721960544586The modified gen p mean: 0.45010000467300415, gen p mean: -0.035540614277124405, mean p set: 0.45058029890060425
loss_pred:0.015801215544342995, decouple_loss:0.0009987433440983295
loss_pred:0.01686415821313858, decouple_loss:0.000982089783065021
Iteration: 2346, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44914504885673523, gen p mean: -0.03612667694687843, mean p set: 0.4496253430843353
loss_pred:0.0156719870865345, decouple_loss:0.0009935242123901844
The modified gen p mean: 0.4510636031627655, gen p mean: -0.04117240384221077, mean p set: 0.4515438675880432The modified gen p mean: 0.44773152470588684, gen p mean: -0.03972792625427246, mean p set: 0.44821181893348694
loss_pred:0.016761088743805885, decouple_loss:0.0011063829297199845
loss_pred:0.015441754832863808, decouple_loss:0.0009902274468913674
Iteration: 2347, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44999992847442627, gen p mean: -0.041419584304094315, mean p set: 0.450480192899704
loss_pred:0.016163170337677002, decouple_loss:0.0011086524464190006
The modified gen p mean: 0.45021986961364746, gen p mean: -0.03742610663175583, mean p set: 0.45070016384124756The modified gen p mean: 0.4507077634334564, gen p mean: -0.03528846055269241, mean p set: 0.4511880874633789
loss_pred:0.0158417746424675, decouple_loss:0.0011022859252989292
loss_pred:0.016642238944768906, decouple_loss:0.0010788162471726537
Iteration: 2348, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44868695735931396, gen p mean: -0.043768446892499924, mean p set: 0.44916728138923645
loss_pred:0.015353556722402573, decouple_loss:0.00105954275932163
The modified gen p mean: 0.44915708899497986, gen p mean: -0.03875250741839409, mean p set: 0.44963738322257996The modified gen p mean: 0.4485498070716858, gen p mean: -0.03638202324509621, mean p set: 0.4490301311016083
loss_pred:0.01585318148136139, decouple_loss:0.0010220155818387866
loss_pred:0.01571505516767502, decouple_loss:0.0009816990932449698
Iteration: 2349, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482399821281433, gen p mean: -0.042521167546510696, mean p set: 0.4487202763557434
loss_pred:0.01510096900165081, decouple_loss:0.0010945415124297142
The modified gen p mean: 0.4496113359928131, gen p mean: -0.04017848148941994, mean p set: 0.4500916600227356The modified gen p mean: 0.44802236557006836, gen p mean: -0.03923143446445465, mean p set: 0.44850265979766846
loss_pred:0.01578262820839882, decouple_loss:0.0010571025777608156
loss_pred:0.015470870770514011, decouple_loss:0.0010567427380010486
Iteration: 2350, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476298689842224, gen p mean: -0.04145357012748718, mean p set: 0.4481101632118225
loss_pred:0.015202120877802372, decouple_loss:0.0009373297216370702
The modified gen p mean: 0.4499967396259308, gen p mean: -0.043235331773757935, mean p set: 0.4504770338535309The modified gen p mean: 0.45034605264663696, gen p mean: -0.04093576967716217, mean p set: 0.45082634687423706
loss_pred:0.015350820496678352, decouple_loss:0.0009048612555488944
loss_pred:0.01567087136209011, decouple_loss:0.0009171461570076644
2023-05-02 11:29:24 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.04763700067996979, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.043195098638534546, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04373622685670853, mean p set: 0.4500633478164673
loss_pred:0.018320100381970406, decouple_loss:0.0011407368583604693
loss_pred:0.01726776920258999, decouple_loss:0.0010759421857073903
loss_pred:0.01726238802075386, decouple_loss:0.0010656950762495399
WV_0_PC_1_EH_0_PS_40, loss: 0.017671458423137665, avg_mse: 0.025383153930306435
current test mse: 0.025383
Iteration: 2351, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45030975341796875, gen p mean: -0.04393550381064415, mean p set: 0.45079004764556885
The modified gen p mean: 0.44962725043296814, gen p mean: -0.043354231864213943, mean p set: 0.45010754466056824
The modified gen p mean: 0.4500763416290283, gen p mean: -0.04348818212747574, mean p set: 0.4505566358566284
loss_pred:0.015663236379623413, decouple_loss:0.0009790686890482903
loss_pred:0.01567147485911846, decouple_loss:0.0009967053774744272
loss_pred:0.0159944836050272, decouple_loss:0.001032496802508831
Iteration: 2352, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44900333881378174, gen p mean: -0.040279049426317215, mean p set: 0.44948363304138184
loss_pred:0.015849947929382324, decouple_loss:0.00109714490827173
The modified gen p mean: 0.4488687515258789, gen p mean: -0.044684454798698425, mean p set: 0.449349045753479The modified gen p mean: 0.44993531703948975, gen p mean: -0.03892076015472412, mean p set: 0.45041564106941223
loss_pred:0.016220472753047943, decouple_loss:0.001012707594782114
loss_pred:0.015973564237356186, decouple_loss:0.0009191376739181578
Iteration: 2353, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44797056913375854, gen p mean: -0.04253481328487396, mean p set: 0.44845086336135864
loss_pred:0.016276231035590172, decouple_loss:0.0008748568943701684
The modified gen p mean: 0.4495692551136017, gen p mean: -0.04070601612329483, mean p set: 0.4500495493412018The modified gen p mean: 0.4495903253555298, gen p mean: -0.04804307222366333, mean p set: 0.4500705897808075
loss_pred:0.015292160212993622, decouple_loss:0.0009234173339791596
loss_pred:0.016383836045861244, decouple_loss:0.0009430518257431686
Iteration: 2354, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45033302903175354, gen p mean: -0.04081105440855026, mean p set: 0.450813353061676
loss_pred:0.01541279535740614, decouple_loss:0.001034248387441039
The modified gen p mean: 0.4490783214569092, gen p mean: -0.035917188972234726, mean p set: 0.4495586156845093The modified gen p mean: 0.44963711500167847, gen p mean: -0.03545546531677246, mean p set: 0.4501173794269562
loss_pred:0.01673070713877678, decouple_loss:0.0010306915501132607
loss_pred:0.016450611874461174, decouple_loss:0.0010212165070697665
Iteration: 2355, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45019569993019104, gen p mean: -0.039888858795166016, mean p set: 0.45067599415779114
loss_pred:0.015425065532326698, decouple_loss:0.0009477288695052266
The modified gen p mean: 0.4500833749771118, gen p mean: -0.03787419945001602, mean p set: 0.4505636692047119The modified gen p mean: 0.44768422842025757, gen p mean: -0.040782369673252106, mean p set: 0.44816452264785767
loss_pred:0.016318384557962418, decouple_loss:0.001028915517963469
loss_pred:0.015731897205114365, decouple_loss:0.0009041459998115897
Iteration: 2356, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44924744963645935, gen p mean: -0.03502686694264412, mean p set: 0.44972777366638184
loss_pred:0.01565655507147312, decouple_loss:0.0008928878814913332
The modified gen p mean: 0.45083022117614746, gen p mean: -0.03736007213592529, mean p set: 0.45131051540374756The modified gen p mean: 0.44890129566192627, gen p mean: -0.03756502643227577, mean p set: 0.44938161969184875
loss_pred:0.01560757402330637, decouple_loss:0.0009353944333270192
loss_pred:0.016544247046113014, decouple_loss:0.0009564969222992659
Iteration: 2357, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499788284301758, gen p mean: -0.050380006432533264, mean p set: 0.4504591226577759
loss_pred:0.015702897682785988, decouple_loss:0.0011114098597317934
The modified gen p mean: 0.4493008553981781, gen p mean: -0.039655011147260666, mean p set: 0.4497811496257782The modified gen p mean: 0.44904953241348267, gen p mean: -0.03880705684423447, mean p set: 0.44952985644340515
loss_pred:0.016752002760767937, decouple_loss:0.000983826001174748
loss_pred:0.01585865393280983, decouple_loss:0.000873628887347877
Iteration: 2358, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491945803165436, gen p mean: -0.04940151050686836, mean p set: 0.44967490434646606
loss_pred:0.015337861143052578, decouple_loss:0.0008925498696044087
The modified gen p mean: 0.4498796761035919, gen p mean: -0.036407485604286194, mean p set: 0.450359970331192The modified gen p mean: 0.44935885071754456, gen p mean: -0.03893733397126198, mean p set: 0.44983911514282227
loss_pred:0.015333506278693676, decouple_loss:0.0009109100792557001
loss_pred:0.015891915187239647, decouple_loss:0.0008619464933872223
Iteration: 2359, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45041942596435547, gen p mean: -0.03906019777059555, mean p set: 0.45089972019195557
loss_pred:0.016078902408480644, decouple_loss:0.0010080210631713271
The modified gen p mean: 0.44907867908477783, gen p mean: -0.04122123867273331, mean p set: 0.4495590031147003The modified gen p mean: 0.4482998549938202, gen p mean: -0.04024771973490715, mean p set: 0.4487801790237427
loss_pred:0.01583414524793625, decouple_loss:0.0009936686838045716
loss_pred:0.015028340741991997, decouple_loss:0.0010035631712526083
Iteration: 2360, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498811662197113, gen p mean: -0.04122844710946083, mean p set: 0.4503614604473114
loss_pred:0.01541992463171482, decouple_loss:0.000984588754363358
The modified gen p mean: 0.44940653443336487, gen p mean: -0.040554966777563095, mean p set: 0.44988682866096497The modified gen p mean: 0.4493899643421173, gen p mean: -0.040138404816389084, mean p set: 0.4498702585697174
loss_pred:0.0154434097930789, decouple_loss:0.0009494610712863505
loss_pred:0.01599911041557789, decouple_loss:0.0010309037752449512
2023-05-02 11:31:19 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.04633615165948868, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.041686274111270905, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04244646057486534, mean p set: 0.4500633478164673
loss_pred:0.01730409450829029, decouple_loss:0.0011693773558363318
loss_pred:0.018343832343816757, decouple_loss:0.0011650231899693608
loss_pred:0.01731090061366558, decouple_loss:0.0012719673104584217
WV_0_PC_1_EH_0_PS_40, loss: 0.017713047564029694, avg_mse: 0.02547108381986618
current test mse: 0.025471
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012019_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012019_3_24hr.npz
NaN value num: 0
Iteration: 2361, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4523179829120636, gen p mean: -0.03988926485180855, mean p set: 0.4527982771396637
loss_pred:0.01774725690484047, decouple_loss:0.0011495607905089855
The modified gen p mean: 0.4512348175048828, gen p mean: -0.03337697312235832, mean p set: 0.4517151117324829The modified gen p mean: 0.4519239068031311, gen p mean: -0.03518291935324669, mean p set: 0.4524042010307312
loss_pred:0.017068715766072273, decouple_loss:0.0011159819550812244
loss_pred:0.016301296651363373, decouple_loss:0.001092383055947721
Iteration: 2362, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4519759714603424, gen p mean: -0.03471643105149269, mean p set: 0.4524562954902649
loss_pred:0.016705643385648727, decouple_loss:0.000919382378924638
The modified gen p mean: 0.4508418142795563, gen p mean: -0.03765024244785309, mean p set: 0.45132210850715637The modified gen p mean: 0.45085176825523376, gen p mean: -0.036941107362508774, mean p set: 0.45133206248283386
loss_pred:0.017307760193943977, decouple_loss:0.0010512160370126367
loss_pred:0.017823532223701477, decouple_loss:0.001050704624503851
Iteration: 2363, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.451535165309906, gen p mean: -0.038418833166360855, mean p set: 0.4520154595375061
loss_pred:0.01761968433856964, decouple_loss:0.0010152840986847878
The modified gen p mean: 0.4505957067012787, gen p mean: -0.04733690619468689, mean p set: 0.4510760009288788The modified gen p mean: 0.4497205913066864, gen p mean: -0.04454808309674263, mean p set: 0.4502009153366089
loss_pred:0.01689380221068859, decouple_loss:0.0010196943767368793
loss_pred:0.017499934881925583, decouple_loss:0.001057080109603703
Iteration: 2364, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45010125637054443, gen p mean: -0.04137979447841644, mean p set: 0.45058155059814453
loss_pred:0.0176381953060627, decouple_loss:0.0010566777782514691
The modified gen p mean: 0.4507615566253662, gen p mean: -0.03719894215464592, mean p set: 0.4512418508529663The modified gen p mean: 0.45130670070648193, gen p mean: -0.04048805683851242, mean p set: 0.45178699493408203
loss_pred:0.016991736367344856, decouple_loss:0.0011170258512720466
loss_pred:0.017603175714612007, decouple_loss:0.0010015711886808276
Iteration: 2365, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503616392612457, gen p mean: -0.05060764402151108, mean p set: 0.4508419334888458
loss_pred:0.01735803857445717, decouple_loss:0.000983919482678175
The modified gen p mean: 0.45073339343070984, gen p mean: -0.048163000494241714, mean p set: 0.4512137174606323The modified gen p mean: 0.44982588291168213, gen p mean: -0.046859074383974075, mean p set: 0.45030614733695984
loss_pred:0.017366928979754448, decouple_loss:0.0009457519627176225
loss_pred:0.017983214929699898, decouple_loss:0.000967170752119273
Iteration: 2366, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4518752694129944, gen p mean: -0.042522676289081573, mean p set: 0.4523555636405945
loss_pred:0.016454976052045822, decouple_loss:0.0010908188996836543
The modified gen p mean: 0.4508407413959503, gen p mean: -0.04003389924764633, mean p set: 0.451321005821228The modified gen p mean: 0.4496927261352539, gen p mean: -0.047309812158346176, mean p set: 0.450173020362854
loss_pred:0.01713917963206768, decouple_loss:0.0010413479758426547
loss_pred:0.01715785637497902, decouple_loss:0.0010845527285709977
Iteration: 2367, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497328996658325, gen p mean: -0.04967841878533363, mean p set: 0.4502132534980774
loss_pred:0.017455609515309334, decouple_loss:0.0010862556518986821
The modified gen p mean: 0.45141705870628357, gen p mean: -0.04420012980699539, mean p set: 0.45189735293388367The modified gen p mean: 0.45233818888664246, gen p mean: -0.04291105642914772, mean p set: 0.45281848311424255
loss_pred:0.018083492293953896, decouple_loss:0.0009751645848155022
loss_pred:0.016434304416179657, decouple_loss:0.0009262600215151906
Iteration: 2368, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4517272710800171, gen p mean: -0.044696178287267685, mean p set: 0.4522075653076172
loss_pred:0.01676439680159092, decouple_loss:0.0010059274500235915
The modified gen p mean: 0.4508119225502014, gen p mean: -0.049437593668699265, mean p set: 0.4512922167778015The modified gen p mean: 0.44983214139938354, gen p mean: -0.0488307923078537, mean p set: 0.45031243562698364
loss_pred:0.01794726774096489, decouple_loss:0.0014746873639523983
loss_pred:0.0171270240098238, decouple_loss:0.0011464761337265372
Iteration: 2369, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45010024309158325, gen p mean: -0.05247305706143379, mean p set: 0.45058050751686096
loss_pred:0.01769912987947464, decouple_loss:0.0012566017685458064
The modified gen p mean: 0.45082077383995056, gen p mean: -0.041019637137651443, mean p set: 0.45130112767219543
The modified gen p mean: 0.45153141021728516, gen p mean: -0.04183066263794899, mean p set: 0.45201170444488525
loss_pred:0.017070474103093147, decouple_loss:0.0011760611087083817
loss_pred:0.016461081802845, decouple_loss:0.001215801341459155
Iteration: 2370, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45210570096969604, gen p mean: -0.04845024645328522, mean p set: 0.45258599519729614
loss_pred:0.01752597652375698, decouple_loss:0.0010977068450301886
The modified gen p mean: 0.44943222403526306, gen p mean: -0.047481004148721695, mean p set: 0.44991254806518555The modified gen p mean: 0.44986769556999207, gen p mean: -0.04955846071243286, mean p set: 0.45034801959991455
loss_pred:0.016992252320051193, decouple_loss:0.0010029125260189176
loss_pred:0.017414668574929237, decouple_loss:0.0009687359561212361
2023-05-02 11:33:54 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.05189324915409088, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04715902730822563, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04783287271857262, mean p set: 0.4500633478164673
loss_pred:0.01832333579659462, decouple_loss:0.0013534229947254062
loss_pred:0.017222806811332703, decouple_loss:0.001390961348079145
loss_pred:0.017304247245192528, decouple_loss:0.0012693186290562153
WV_0_PC_1_EH_0_PS_40, loss: 0.017683692276477814, avg_mse: 0.02539411187171936
current test mse: 0.025394
Iteration: 2371, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45095786452293396, gen p mean: -0.04117932543158531, mean p set: 0.45143812894821167
The modified gen p mean: 0.4509640336036682, gen p mean: -0.03907338157296181, mean p set: 0.4514442980289459
The modified gen p mean: 0.44965270161628723, gen p mean: -0.0415639765560627, mean p set: 0.45013299584388733
loss_pred:0.01724356785416603, decouple_loss:0.0011519131949171424
loss_pred:0.017540384083986282, decouple_loss:0.0014225241029635072loss_pred:0.01704435795545578, decouple_loss:0.0010933857411146164
Iteration: 2372, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493287205696106, gen p mean: -0.04316430911421776, mean p set: 0.4498090147972107
loss_pred:0.017792971804738045, decouple_loss:0.0009747473523020744
The modified gen p mean: 0.449611634016037, gen p mean: -0.044393666088581085, mean p set: 0.4500918984413147
The modified gen p mean: 0.4518773853778839, gen p mean: -0.03688305988907814, mean p set: 0.452357679605484
loss_pred:0.01643799990415573, decouple_loss:0.0010757563868537545
loss_pred:0.017249759286642075, decouple_loss:0.0010630844626575708
Iteration: 2373, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500442445278168, gen p mean: -0.041288599371910095, mean p set: 0.45052459836006165
loss_pred:0.016995981335639954, decouple_loss:0.0009887965861707926
The modified gen p mean: 0.45026731491088867, gen p mean: -0.04230532422661781, mean p set: 0.45074760913848877The modified gen p mean: 0.45083531737327576, gen p mean: -0.03468412533402443, mean p set: 0.45131561160087585
loss_pred:0.01735108718276024, decouple_loss:0.0010326795745640993
loss_pred:0.01675022765994072, decouple_loss:0.0010280741844326258
Iteration: 2374, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45063990354537964, gen p mean: -0.041548870503902435, mean p set: 0.4511202275753021
loss_pred:0.01673275977373123, decouple_loss:0.0010845892829820514
The modified gen p mean: 0.45038220286369324, gen p mean: -0.03916957229375839, mean p set: 0.45086249709129333The modified gen p mean: 0.45209643244743347, gen p mean: -0.03520488366484642, mean p set: 0.45257672667503357
loss_pred:0.016781629994511604, decouple_loss:0.001096337684430182
loss_pred:0.01641591638326645, decouple_loss:0.0009095943532884121
Iteration: 2375, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514373242855072, gen p mean: -0.0342576764523983, mean p set: 0.4519175887107849
loss_pred:0.016745250672101974, decouple_loss:0.0011104599107056856
The modified gen p mean: 0.45006638765335083, gen p mean: -0.041293803602457047, mean p set: 0.4505466818809509The modified gen p mean: 0.45012742280960083, gen p mean: -0.0396537147462368, mean p set: 0.45060768723487854
loss_pred:0.01742270402610302, decouple_loss:0.0010347876232117414
loss_pred:0.01723688468337059, decouple_loss:0.0010930062271654606
Iteration: 2376, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45096662640571594, gen p mean: -0.03924296051263809, mean p set: 0.45144689083099365
loss_pred:0.017536187544465065, decouple_loss:0.00098137347958982
The modified gen p mean: 0.4508074223995209, gen p mean: -0.04192875698208809, mean p set: 0.4512876868247986The modified gen p mean: 0.4517497420310974, gen p mean: -0.03541932255029678, mean p set: 0.4522300362586975
loss_pred:0.01793639175593853, decouple_loss:0.0011039437958970666
loss_pred:0.017769968137145042, decouple_loss:0.0009570092079229653
Iteration: 2377, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45269036293029785, gen p mean: -0.03936157375574112, mean p set: 0.45317062735557556
loss_pred:0.017397787421941757, decouple_loss:0.0010773901594802737
The modified gen p mean: 0.45183250308036804, gen p mean: -0.039566341787576675, mean p set: 0.45231279730796814The modified gen p mean: 0.4514906108379364, gen p mean: -0.0365060493350029, mean p set: 0.4519709050655365
loss_pred:0.01710217259824276, decouple_loss:0.0011279652826488018
loss_pred:0.017778676003217697, decouple_loss:0.001067458069883287
Iteration: 2378, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511503577232361, gen p mean: -0.03663385659456253, mean p set: 0.45163068175315857
loss_pred:0.01672310382127762, decouple_loss:0.0010016438318416476
The modified gen p mean: 0.45255059003829956, gen p mean: -0.03863581642508507, mean p set: 0.45303085446357727The modified gen p mean: 0.44944486021995544, gen p mean: -0.03704143315553665, mean p set: 0.44992515444755554
loss_pred:0.01686174049973488, decouple_loss:0.001020051073282957
loss_pred:0.01711413823068142, decouple_loss:0.0011072515044361353
Iteration: 2379, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4512808918952942, gen p mean: -0.03776928782463074, mean p set: 0.4517611861228943
loss_pred:0.017128735780715942, decouple_loss:0.0010026743402704597
The modified gen p mean: 0.4503265619277954, gen p mean: -0.04218675196170807, mean p set: 0.4508068561553955The modified gen p mean: 0.4497157633304596, gen p mean: -0.04532778263092041, mean p set: 0.4501960873603821
loss_pred:0.017287783324718475, decouple_loss:0.000972673122305423
loss_pred:0.017130190506577492, decouple_loss:0.0009504103800281882
Iteration: 2380, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45078352093696594, gen p mean: -0.04319707676768303, mean p set: 0.4512638449668884
loss_pred:0.016707580536603928, decouple_loss:0.0010678278049454093
The modified gen p mean: 0.4494195580482483, gen p mean: -0.04308424890041351, mean p set: 0.449899822473526The modified gen p mean: 0.451214998960495, gen p mean: -0.03858814015984535, mean p set: 0.4516952931880951
loss_pred:0.01671978458762169, decouple_loss:0.0009348799358122051
loss_pred:0.016318339854478836, decouple_loss:0.0009397752000950277
2023-05-02 11:35:48 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.04941854998469353, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04481592774391174, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.04531531035900116, mean p set: 0.4500633478164673
loss_pred:0.018380725756287575, decouple_loss:0.0011193868704140186
loss_pred:0.017252855002880096, decouple_loss:0.0010528259444981813
loss_pred:0.017327679321169853, decouple_loss:0.0010491268476471305
WV_0_PC_1_EH_0_PS_40, loss: 0.017707442864775658, avg_mse: 0.02546703815460205
current test mse: 0.025467
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012003_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012003_3_24hr.npz
NaN value num: 0
Iteration: 2381, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490232765674591, gen p mean: -0.042786139994859695, mean p set: 0.4495035707950592
loss_pred:0.014310046099126339, decouple_loss:0.000984520884230733
The modified gen p mean: 0.4486350119113922, gen p mean: -0.04784596711397171, mean p set: 0.4491152763366699The modified gen p mean: 0.44679588079452515, gen p mean: -0.042628344148397446, mean p set: 0.44727620482444763
loss_pred:0.013719760812819004, decouple_loss:0.001018833601847291
loss_pred:0.014248526655137539, decouple_loss:0.0010306475451216102
Iteration: 2382, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44815993309020996, gen p mean: -0.0386284664273262, mean p set: 0.44864022731781006
loss_pred:0.014422743581235409, decouple_loss:0.001127969822846353
The modified gen p mean: 0.4481416344642639, gen p mean: -0.04184894263744354, mean p set: 0.448621928691864The modified gen p mean: 0.4474150538444519, gen p mean: -0.04547596350312233, mean p set: 0.4478953182697296
loss_pred:0.013648712076246738, decouple_loss:0.0011007165303453803
loss_pred:0.014548917300999165, decouple_loss:0.0010650198673829436
Iteration: 2383, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476039707660675, gen p mean: -0.04439598694443703, mean p set: 0.4480842351913452
loss_pred:0.013454336673021317, decouple_loss:0.0010842024348676205
The modified gen p mean: 0.44854143261909485, gen p mean: -0.04063700884580612, mean p set: 0.44902175664901733The modified gen p mean: 0.44795912504196167, gen p mean: -0.04288565367460251, mean p set: 0.44843941926956177
loss_pred:0.014294570311903954, decouple_loss:0.0011157965054735541
loss_pred:0.014265908859670162, decouple_loss:0.0011749806581065059
Iteration: 2384, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44846776127815247, gen p mean: -0.03691089153289795, mean p set: 0.44894805550575256
loss_pred:0.01414791215211153, decouple_loss:0.000997534953057766
The modified gen p mean: 0.44775041937828064, gen p mean: -0.037758320569992065, mean p set: 0.44823071360588074The modified gen p mean: 0.4497413635253906, gen p mean: -0.03994019329547882, mean p set: 0.4502216577529907
loss_pred:0.014146174304187298, decouple_loss:0.0010897876927629113
loss_pred:0.014407651498913765, decouple_loss:0.0010562987299636006
Iteration: 2385, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478701651096344, gen p mean: -0.0433243028819561, mean p set: 0.4483504593372345
loss_pred:0.01419924572110176, decouple_loss:0.0010015557054430246
The modified gen p mean: 0.44761529564857483, gen p mean: -0.04056220129132271, mean p set: 0.4480955898761749The modified gen p mean: 0.44682058691978455, gen p mean: -0.04198651760816574, mean p set: 0.44730088114738464
loss_pred:0.014130261726677418, decouple_loss:0.001069914666004479
loss_pred:0.013552709482610226, decouple_loss:0.0012201500358060002
Iteration: 2386, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44832903146743774, gen p mean: -0.04180220142006874, mean p set: 0.44880932569503784
loss_pred:0.013705668970942497, decouple_loss:0.0011599813587963581
The modified gen p mean: 0.4489864110946655, gen p mean: -0.03874543309211731, mean p set: 0.4494667053222656The modified gen p mean: 0.4493597447872162, gen p mean: -0.039610832929611206, mean p set: 0.44984006881713867
loss_pred:0.013705270364880562, decouple_loss:0.001091223326511681
loss_pred:0.014410411939024925, decouple_loss:0.0012020354624837637
Iteration: 2387, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477349817752838, gen p mean: -0.04154989868402481, mean p set: 0.4482152760028839
loss_pred:0.013913598842918873, decouple_loss:0.0010915518505498767
The modified gen p mean: 0.44861480593681335, gen p mean: -0.040172405540943146, mean p set: 0.44909510016441345The modified gen p mean: 0.4489436149597168, gen p mean: -0.03995615243911743, mean p set: 0.4494239091873169
loss_pred:0.013721576891839504, decouple_loss:0.0011866248678416014
loss_pred:0.01338691171258688, decouple_loss:0.001068760990165174
Iteration: 2388, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477507770061493, gen p mean: -0.04343102127313614, mean p set: 0.448231041431427
loss_pred:0.01375224906951189, decouple_loss:0.0011583182495087385
The modified gen p mean: 0.4472561478614807, gen p mean: -0.048303037881851196, mean p set: 0.4477364122867584
The modified gen p mean: 0.4474274516105652, gen p mean: -0.0402783639729023, mean p set: 0.4479077458381653
loss_pred:0.013932489790022373, decouple_loss:0.0011124395532533526
loss_pred:0.013566265814006329, decouple_loss:0.0011022615944966674
Iteration: 2389, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493885040283203, gen p mean: -0.05071420595049858, mean p set: 0.4498688280582428
loss_pred:0.013403864577412605, decouple_loss:0.0012070743832737207
The modified gen p mean: 0.448375940322876, gen p mean: -0.04956284910440445, mean p set: 0.4488562345504761The modified gen p mean: 0.4488731920719147, gen p mean: -0.048448722809553146, mean p set: 0.44935348629951477
loss_pred:0.013641534373164177, decouple_loss:0.0010851566912606359
loss_pred:0.013864275999367237, decouple_loss:0.0011066292645409703
Iteration: 2390, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44823938608169556, gen p mean: -0.048162151128053665, mean p set: 0.44871968030929565
loss_pred:0.013402965851128101, decouple_loss:0.001173386350274086
The modified gen p mean: 0.4470297396183014, gen p mean: -0.04828793182969093, mean p set: 0.4475100636482239
The modified gen p mean: 0.4490513503551483, gen p mean: -0.04513873904943466, mean p set: 0.449531614780426
loss_pred:0.013287177309393883, decouple_loss:0.001139111933298409
loss_pred:0.013732845894992352, decouple_loss:0.0011042794212698936
2023-05-02 11:38:21 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.05031144618988037, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04544643685221672, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.04610903188586235, mean p set: 0.4500633478164673
loss_pred:0.019239386543631554, decouple_loss:0.0011786516988649964
loss_pred:0.01794717274606228, decouple_loss:0.0012113716220483184
loss_pred:0.01810699701309204, decouple_loss:0.001160749583505094
WV_0_PC_1_EH_0_PS_40, loss: 0.018490366637706757, avg_mse: 0.026965148746967316
current test mse: 0.026965
Iteration: 2391, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449165403842926, gen p mean: -0.04496266320347786, mean p set: 0.4496456980705261
The modified gen p mean: 0.4480161666870117, gen p mean: -0.05038312077522278, mean p set: 0.4484964609146118
The modified gen p mean: 0.44824087619781494, gen p mean: -0.047254450619220734, mean p set: 0.44872117042541504
loss_pred:0.01388220489025116, decouple_loss:0.0011215121485292912
loss_pred:0.01336392480880022, decouple_loss:0.0010967898415401578
loss_pred:0.013008230365812778, decouple_loss:0.0011528829345479608
Iteration: 2392, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45050033926963806, gen p mean: -0.05007532611489296, mean p set: 0.45098060369491577
loss_pred:0.013402319513261318, decouple_loss:0.0012149120448157191
The modified gen p mean: 0.4487239420413971, gen p mean: -0.05011273920536041, mean p set: 0.4492042660713196The modified gen p mean: 0.4480617344379425, gen p mean: -0.04131874814629555, mean p set: 0.4485420286655426
loss_pred:0.012942291796207428, decouple_loss:0.0012312198523432016
loss_pred:0.013866059482097626, decouple_loss:0.0011874818010255694
Iteration: 2393, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44745132327079773, gen p mean: -0.04657765477895737, mean p set: 0.4479316174983978
The modified gen p mean: 0.44833943247795105, gen p mean: -0.04679548367857933, mean p set: 0.44881969690322876loss_pred:0.013859735801815987, decouple_loss:0.0012837244430556893
The modified gen p mean: 0.4505738615989685, gen p mean: -0.047892242670059204, mean p set: 0.4510541558265686
loss_pred:0.013848579488694668, decouple_loss:0.0010982508538290858
loss_pred:0.013564440421760082, decouple_loss:0.001133931684307754
Iteration: 2394, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44844579696655273, gen p mean: -0.04824737086892128, mean p set: 0.44892609119415283
loss_pred:0.01303227711468935, decouple_loss:0.0011567588662728667
The modified gen p mean: 0.4489331543445587, gen p mean: -0.05248314514756203, mean p set: 0.4494134187698364The modified gen p mean: 0.44816339015960693, gen p mean: -0.05162409320473671, mean p set: 0.4486437141895294
loss_pred:0.013353920541703701, decouple_loss:0.001208659028634429
loss_pred:0.012662578374147415, decouple_loss:0.0010838111629709601
Iteration: 2395, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480254352092743, gen p mean: -0.05470345541834831, mean p set: 0.448505699634552
loss_pred:0.013291025534272194, decouple_loss:0.0010563654359430075
The modified gen p mean: 0.4481697380542755, gen p mean: -0.04801351949572563, mean p set: 0.448650062084198The modified gen p mean: 0.4488052427768707, gen p mean: -0.05494298040866852, mean p set: 0.4492855668067932
loss_pred:0.013691688887774944, decouple_loss:0.0011632066452875733
loss_pred:0.01301918551325798, decouple_loss:0.0010626348666846752
Iteration: 2396, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44853872060775757, gen p mean: -0.0498519167304039, mean p set: 0.44901901483535767
loss_pred:0.013611801899969578, decouple_loss:0.0011938969837501645
The modified gen p mean: 0.447664350271225, gen p mean: -0.05455007776618004, mean p set: 0.4481446146965027The modified gen p mean: 0.44841325283050537, gen p mean: -0.05710017681121826, mean p set: 0.44889357686042786
loss_pred:0.01404477097094059, decouple_loss:0.0011498027015477419
loss_pred:0.013192969374358654, decouple_loss:0.0010743474122136831
Iteration: 2397, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44843608140945435, gen p mean: -0.05758464336395264, mean p set: 0.44891637563705444
loss_pred:0.01320791244506836, decouple_loss:0.001021286123432219
The modified gen p mean: 0.4482167959213257, gen p mean: -0.05657665431499481, mean p set: 0.4486970603466034The modified gen p mean: 0.4472508430480957, gen p mean: -0.05281796678900719, mean p set: 0.4477311074733734
loss_pred:0.013386311009526253, decouple_loss:0.0010415551951155066
loss_pred:0.013672192580997944, decouple_loss:0.001064593088813126
Iteration: 2398, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44936540722846985, gen p mean: -0.05498731881380081, mean p set: 0.44984567165374756
loss_pred:0.013534019701182842, decouple_loss:0.0011268461821600795
The modified gen p mean: 0.4484531581401825, gen p mean: -0.05864785984158516, mean p set: 0.4489334523677826The modified gen p mean: 0.44821345806121826, gen p mean: -0.0541914664208889, mean p set: 0.44869375228881836
loss_pred:0.0131237106397748, decouple_loss:0.0012300163507461548
loss_pred:0.013067937456071377, decouple_loss:0.0012058962602168322
Iteration: 2399, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44884786009788513, gen p mean: -0.055455900728702545, mean p set: 0.44932815432548523
loss_pred:0.012819033116102219, decouple_loss:0.0010932271834462881
The modified gen p mean: 0.4481566250324249, gen p mean: -0.05333053320646286, mean p set: 0.44863688945770264The modified gen p mean: 0.4484662711620331, gen p mean: -0.052765581756830215, mean p set: 0.4489465653896332
loss_pred:0.012856869958341122, decouple_loss:0.0010974262841045856
loss_pred:0.012941867113113403, decouple_loss:0.001066223718225956
Iteration: 2400, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476427733898163, gen p mean: -0.048237357288599014, mean p set: 0.4481230676174164
loss_pred:0.013675246387720108, decouple_loss:0.0011889435118064284
The modified gen p mean: 0.4469038248062134, gen p mean: -0.046872299164533615, mean p set: 0.44738414883613586The modified gen p mean: 0.44889310002326965, gen p mean: -0.054479390382766724, mean p set: 0.44937342405319214
loss_pred:0.013517411425709724, decouple_loss:0.0011368563864380121
loss_pred:0.01269132923334837, decouple_loss:0.0010478345211595297
2023-05-02 11:40:15 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.05007290840148926, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.045374028384685516, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.04595068469643593, mean p set: 0.4500633478164673
loss_pred:0.019183754920959473, decouple_loss:0.0010770434746518731
loss_pred:0.017939869314432144, decouple_loss:0.0010679390979930758
loss_pred:0.01810772903263569, decouple_loss:0.0010268675396218896
WV_0_PC_1_EH_0_PS_40, loss: 0.018463315442204475, avg_mse: 0.026972856372594833
current test mse: 0.026973
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012000_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012000_3_24hr.npz
NaN value num: 0
Iteration: 2401, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504871368408203, gen p mean: -0.04751567915081978, mean p set: 0.4509674608707428
loss_pred:0.016465017572045326, decouple_loss:0.00110781064722687
The modified gen p mean: 0.44950807094573975, gen p mean: -0.04228828474879265, mean p set: 0.44998836517333984The modified gen p mean: 0.45027345418930054, gen p mean: -0.04316185787320137, mean p set: 0.45075374841690063
loss_pred:0.01633852906525135, decouple_loss:0.0011355261085554957
loss_pred:0.01721883751451969, decouple_loss:0.001077790861018002
Iteration: 2402, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514518082141876, gen p mean: -0.038602255284786224, mean p set: 0.4519321024417877
loss_pred:0.016132120043039322, decouple_loss:0.001094380859285593
The modified gen p mean: 0.45127806067466736, gen p mean: -0.03700710088014603, mean p set: 0.45175832509994507The modified gen p mean: 0.44813987612724304, gen p mean: -0.04410884529352188, mean p set: 0.44862014055252075
loss_pred:0.016299139708280563, decouple_loss:0.0010595315834507346
loss_pred:0.016263322904706, decouple_loss:0.0010705619351938367
Iteration: 2403, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44974350929260254, gen p mean: -0.04169101640582085, mean p set: 0.45022377371788025
loss_pred:0.016043072566390038, decouple_loss:0.0010780933080241084
The modified gen p mean: 0.4528367817401886, gen p mean: -0.0347583033144474, mean p set: 0.4533170461654663The modified gen p mean: 0.4509528577327728, gen p mean: -0.031699039041996, mean p set: 0.4514331519603729
loss_pred:0.015827380120754242, decouple_loss:0.0010671077761799097
loss_pred:0.015666304156184196, decouple_loss:0.0010824204655364156
Iteration: 2404, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45214930176734924, gen p mean: -0.03358707204461098, mean p set: 0.45262959599494934
loss_pred:0.015794849023222923, decouple_loss:0.0010037405882030725
The modified gen p mean: 0.44974252581596375, gen p mean: -0.030812369659543037, mean p set: 0.45022279024124146The modified gen p mean: 0.44980132579803467, gen p mean: -0.033307354897260666, mean p set: 0.45028162002563477
loss_pred:0.016286121681332588, decouple_loss:0.0010750171495601535
loss_pred:0.01695392280817032, decouple_loss:0.0010941113578155637
Iteration: 2405, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44905152916908264, gen p mean: -0.029996152967214584, mean p set: 0.44953182339668274
loss_pred:0.015741346403956413, decouple_loss:0.0011089630424976349
The modified gen p mean: 0.4528837502002716, gen p mean: -0.03196272999048233, mean p set: 0.4533640444278717The modified gen p mean: 0.448850154876709, gen p mean: -0.03602415695786476, mean p set: 0.4493304491043091
loss_pred:0.015578002668917179, decouple_loss:0.0011036803480237722
loss_pred:0.016213059425354004, decouple_loss:0.001128469593822956
Iteration: 2406, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498118460178375, gen p mean: -0.035158608108758926, mean p set: 0.45029211044311523
loss_pred:0.01630926877260208, decouple_loss:0.0010435256408527493
The modified gen p mean: 0.4496873617172241, gen p mean: -0.03627379983663559, mean p set: 0.4501676559448242The modified gen p mean: 0.4513486921787262, gen p mean: -0.027753764763474464, mean p set: 0.4518289566040039
loss_pred:0.016419142484664917, decouple_loss:0.0010848139645531774
loss_pred:0.015218782238662243, decouple_loss:0.0010352004319429398
Iteration: 2407, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.451507031917572, gen p mean: -0.033267196267843246, mean p set: 0.4519873261451721
loss_pred:0.016697142273187637, decouple_loss:0.0011199438013136387
The modified gen p mean: 0.4511222541332245, gen p mean: -0.03485296294093132, mean p set: 0.4516025483608246The modified gen p mean: 0.4512248635292053, gen p mean: -0.03235480189323425, mean p set: 0.4517051577568054
loss_pred:0.015719149261713028, decouple_loss:0.0011367895640432835
loss_pred:0.016799140721559525, decouple_loss:0.0012432769872248173
Iteration: 2408, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492553770542145, gen p mean: -0.033685822039842606, mean p set: 0.4497356712818146
The modified gen p mean: 0.45150044560432434, gen p mean: -0.03396093100309372, mean p set: 0.45198073983192444
loss_pred:0.015586577355861664, decouple_loss:0.0010456856107339263
loss_pred:0.0161086767911911, decouple_loss:0.0011512397322803736
The modified gen p mean: 0.4493885636329651, gen p mean: -0.034686073660850525, mean p set: 0.4498688280582428
loss_pred:0.01621231436729431, decouple_loss:0.0010810211533680558
Iteration: 2409, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514136016368866, gen p mean: -0.03651520609855652, mean p set: 0.4518939256668091
loss_pred:0.015904922038316727, decouple_loss:0.001100189983844757
The modified gen p mean: 0.4494718015193939, gen p mean: -0.04055975377559662, mean p set: 0.449952095746994The modified gen p mean: 0.4516070485115051, gen p mean: -0.038688816130161285, mean p set: 0.45208731293678284
loss_pred:0.01541664358228445, decouple_loss:0.0011243931949138641
loss_pred:0.015908323228359222, decouple_loss:0.0011238132137805223
Iteration: 2410, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45082300901412964, gen p mean: -0.03986421227455139, mean p set: 0.45130327343940735
loss_pred:0.01572185382246971, decouple_loss:0.0010244158329442143
The modified gen p mean: 0.4490898847579956, gen p mean: -0.03880999982357025, mean p set: 0.4495701789855957The modified gen p mean: 0.4476620852947235, gen p mean: -0.04304336756467819, mean p set: 0.448142409324646
loss_pred:0.01640167646110058, decouple_loss:0.0010259054834023118
loss_pred:0.016565639525651932, decouple_loss:0.0010513877496123314
2023-05-02 11:42:47 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.045883290469646454, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.041214268654584885, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.04200667142868042, mean p set: 0.4500633478164673
loss_pred:0.018428683280944824, decouple_loss:0.0011698849266394973
loss_pred:0.017333684489130974, decouple_loss:0.0012546468060463667
loss_pred:0.017444709315896034, decouple_loss:0.0011663842014968395
WV_0_PC_1_EH_0_PS_40, loss: 0.017795540392398834, avg_mse: 0.025626853108406067
current test mse: 0.025627
Iteration: 2411, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45277971029281616, gen p mean: -0.041384510695934296, mean p set: 0.45326003432273865
The modified gen p mean: 0.4512796401977539, gen p mean: -0.03644668683409691, mean p set: 0.4517599642276764
The modified gen p mean: 0.44892239570617676, gen p mean: -0.03967771306633949, mean p set: 0.44940266013145447
loss_pred:0.015643766149878502, decouple_loss:0.0010287268087267876
loss_pred:0.015518800355494022, decouple_loss:0.0010023870272561908
loss_pred:0.015366112813353539, decouple_loss:0.0010401431936770678
Iteration: 2412, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44991931319236755, gen p mean: -0.042399924248456955, mean p set: 0.45039960741996765
loss_pred:0.016372574493288994, decouple_loss:0.0010631466284394264
The modified gen p mean: 0.4493529200553894, gen p mean: -0.038383107632398605, mean p set: 0.4498332440853119
The modified gen p mean: 0.4513408839702606, gen p mean: -0.04235804080963135, mean p set: 0.4518211781978607
loss_pred:0.01645975187420845, decouple_loss:0.0010601123794913292
loss_pred:0.01594979129731655, decouple_loss:0.0010347133502364159
Iteration: 2413, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448747456073761, gen p mean: -0.04551064968109131, mean p set: 0.44922778010368347
loss_pred:0.016081834211945534, decouple_loss:0.0010226292070001364
The modified gen p mean: 0.45149606466293335, gen p mean: -0.03362385928630829, mean p set: 0.45197638869285583The modified gen p mean: 0.45058420300483704, gen p mean: -0.042791612446308136, mean p set: 0.4510645270347595
loss_pred:0.015338648110628128, decouple_loss:0.0009658399503678083
loss_pred:0.016139380633831024, decouple_loss:0.0010242281714454293
Iteration: 2414, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44978779554367065, gen p mean: -0.03980090096592903, mean p set: 0.45026808977127075
loss_pred:0.01645834371447563, decouple_loss:0.0009903014870360494
The modified gen p mean: 0.45039644837379456, gen p mean: -0.04198318347334862, mean p set: 0.45087674260139465The modified gen p mean: 0.451978862285614, gen p mean: -0.039995793253183365, mean p set: 0.4524591267108917
loss_pred:0.016896290704607964, decouple_loss:0.0010028710821643472
loss_pred:0.015706656500697136, decouple_loss:0.0009777031373232603
Iteration: 2415, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45114535093307495, gen p mean: -0.042034465819597244, mean p set: 0.45162567496299744
loss_pred:0.01674502156674862, decouple_loss:0.0009358377428725362
The modified gen p mean: 0.4515511989593506, gen p mean: -0.04206756874918938, mean p set: 0.4520314931869507The modified gen p mean: 0.44969499111175537, gen p mean: -0.04223567247390747, mean p set: 0.4501752555370331
loss_pred:0.015759486705064774, decouple_loss:0.000992447603493929
loss_pred:0.01565266028046608, decouple_loss:0.0009533515549264848
Iteration: 2416, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498673677444458, gen p mean: -0.04362967982888222, mean p set: 0.4503476321697235
loss_pred:0.015436210669577122, decouple_loss:0.0009820593986660242
The modified gen p mean: 0.45285388827323914, gen p mean: -0.04277842491865158, mean p set: 0.45333418250083923The modified gen p mean: 0.4516649544239044, gen p mean: -0.04214465990662575, mean p set: 0.4521452486515045
loss_pred:0.01589616946876049, decouple_loss:0.0010208552703261375
loss_pred:0.015162321738898754, decouple_loss:0.0011338720796629786
Iteration: 2417, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499928653240204, gen p mean: -0.043448250740766525, mean p set: 0.4504731595516205
loss_pred:0.0161188542842865, decouple_loss:0.0009544807835482061
The modified gen p mean: 0.44903847575187683, gen p mean: -0.040471695363521576, mean p set: 0.44951876997947693The modified gen p mean: 0.4494360387325287, gen p mean: -0.04468557611107826, mean p set: 0.4499163329601288
loss_pred:0.015639901161193848, decouple_loss:0.0009506871574558318
loss_pred:0.01660347916185856, decouple_loss:0.0009452900267206132
Iteration: 2418, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45118170976638794, gen p mean: -0.04515742138028145, mean p set: 0.4516620337963104
loss_pred:0.015423190779983997, decouple_loss:0.0009384441073052585
The modified gen p mean: 0.4499671459197998, gen p mean: -0.05228222534060478, mean p set: 0.4504474103450775The modified gen p mean: 0.4512358009815216, gen p mean: -0.04080772399902344, mean p set: 0.4517160654067993
loss_pred:0.015604179352521896, decouple_loss:0.0009717851644381881
loss_pred:0.01610855758190155, decouple_loss:0.0009253418538719416
Iteration: 2419, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493926763534546, gen p mean: -0.04372360557317734, mean p set: 0.4498729407787323
loss_pred:0.016552595421671867, decouple_loss:0.000991226639598608
The modified gen p mean: 0.4507521092891693, gen p mean: -0.042124707251787186, mean p set: 0.4512324035167694The modified gen p mean: 0.450160413980484, gen p mean: -0.04156824201345444, mean p set: 0.4506407380104065
loss_pred:0.01584003120660782, decouple_loss:0.0009693109313957393
loss_pred:0.01579589582979679, decouple_loss:0.0010042738867923617
Iteration: 2420, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514739513397217, gen p mean: -0.046335507184267044, mean p set: 0.45195427536964417
loss_pred:0.015076305717229843, decouple_loss:0.000943237217143178
The modified gen p mean: 0.4511565864086151, gen p mean: -0.04583282396197319, mean p set: 0.4516368806362152The modified gen p mean: 0.4518389105796814, gen p mean: -0.04657205566763878, mean p set: 0.4523191750049591
loss_pred:0.016426393762230873, decouple_loss:0.0009768324671313167
loss_pred:0.016488388180732727, decouple_loss:0.0009510500822216272
2023-05-02 11:44:41 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.05249588191509247, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04782186076045036, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.04860614612698555, mean p set: 0.4500633478164673
loss_pred:0.018379436805844307, decouple_loss:0.0011498694075271487
loss_pred:0.017284121364355087, decouple_loss:0.001140599139034748
loss_pred:0.017387064173817635, decouple_loss:0.001148934941738844
WV_0_PC_1_EH_0_PS_40, loss: 0.01774086430668831, avg_mse: 0.02553097903728485
current test mse: 0.025531
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012009_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012009_3_24hr.npz
NaN value num: 0
Iteration: 2421, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502854347229004, gen p mean: -0.046983327716588974, mean p set: 0.4507656991481781
loss_pred:0.01765548251569271, decouple_loss:0.0011439038207754493
The modified gen p mean: 0.4505951404571533, gen p mean: -0.04233265295624733, mean p set: 0.4510754346847534The modified gen p mean: 0.45256802439689636, gen p mean: -0.04449594020843506, mean p set: 0.45304831862449646
loss_pred:0.016219457611441612, decouple_loss:0.0010649816831573844
loss_pred:0.017360186204314232, decouple_loss:0.0011443243129178882
Iteration: 2422, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4523078501224518, gen p mean: -0.04385754093527794, mean p set: 0.45278817415237427
loss_pred:0.01806860789656639, decouple_loss:0.0010546875419095159
The modified gen p mean: 0.4507160782814026, gen p mean: -0.04644680395722389, mean p set: 0.4511964023113251The modified gen p mean: 0.44851183891296387, gen p mean: -0.0439048707485199, mean p set: 0.44899213314056396
loss_pred:0.016797984018921852, decouple_loss:0.0011081956326961517
loss_pred:0.016790151596069336, decouple_loss:0.0010007182136178017
Iteration: 2423, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45106908679008484, gen p mean: -0.042346350848674774, mean p set: 0.4515494108200073
loss_pred:0.016836149618029594, decouple_loss:0.0010325958719477057
The modified gen p mean: 0.4514698088169098, gen p mean: -0.03732084110379219, mean p set: 0.4519501030445099The modified gen p mean: 0.4510774314403534, gen p mean: -0.03426399454474449, mean p set: 0.4515576958656311
loss_pred:0.01676887832581997, decouple_loss:0.0010642213746905327
loss_pred:0.01678970642387867, decouple_loss:0.00110246438998729
Iteration: 2424, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483846127986908, gen p mean: -0.04148241505026817, mean p set: 0.4488649070262909
loss_pred:0.01656675897538662, decouple_loss:0.0009540794999338686
The modified gen p mean: 0.4510738253593445, gen p mean: -0.042650241404771805, mean p set: 0.4515541195869446The modified gen p mean: 0.4503142237663269, gen p mean: -0.04561241343617439, mean p set: 0.450794517993927
loss_pred:0.016651785001158714, decouple_loss:0.0009971598628908396
loss_pred:0.016853753477334976, decouple_loss:0.0009269769652746618
Iteration: 2425, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45242762565612793, gen p mean: -0.041833359748125076, mean p set: 0.452907919883728
loss_pred:0.01699180155992508, decouple_loss:0.0010815821588039398
The modified gen p mean: 0.4507061541080475, gen p mean: -0.03176620975136757, mean p set: 0.4511864483356476The modified gen p mean: 0.45097994804382324, gen p mean: -0.03865028917789459, mean p set: 0.45146021246910095
loss_pred:0.017015695571899414, decouple_loss:0.0010546946432441473
loss_pred:0.016473475843667984, decouple_loss:0.0010637417435646057
Iteration: 2426, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45080244541168213, gen p mean: -0.030454687774181366, mean p set: 0.4512827396392822
loss_pred:0.016818780452013016, decouple_loss:0.0009701322414912283
The modified gen p mean: 0.45245257019996643, gen p mean: -0.034997448325157166, mean p set: 0.45293283462524414The modified gen p mean: 0.45115208625793457, gen p mean: -0.038720887154340744, mean p set: 0.4516323506832123
loss_pred:0.017085418105125427, decouple_loss:0.0010681796120479703
loss_pred:0.016951298341155052, decouple_loss:0.0009846322936937213
Iteration: 2427, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44933652877807617, gen p mean: -0.039721667766571045, mean p set: 0.44981685280799866
loss_pred:0.016389556229114532, decouple_loss:0.001118898275308311
The modified gen p mean: 0.4512511193752289, gen p mean: -0.03727319836616516, mean p set: 0.451731413602829The modified gen p mean: 0.4515032470226288, gen p mean: -0.03550024703145027, mean p set: 0.4519835412502289
loss_pred:0.01798775978386402, decouple_loss:0.001051578437909484
loss_pred:0.016679687425494194, decouple_loss:0.0010504419915378094
Iteration: 2428, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4519338011741638, gen p mean: -0.039834070950746536, mean p set: 0.4524140954017639
loss_pred:0.016799820587038994, decouple_loss:0.001049116370268166
The modified gen p mean: 0.45052945613861084, gen p mean: -0.041023798286914825, mean p set: 0.4510097801685333The modified gen p mean: 0.45069780945777893, gen p mean: -0.03559470176696777, mean p set: 0.45117807388305664
loss_pred:0.016714464873075485, decouple_loss:0.0009822755819186568
loss_pred:0.01714618317782879, decouple_loss:0.000972240581177175
Iteration: 2429, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45360514521598816, gen p mean: -0.0426509790122509, mean p set: 0.45408543944358826
loss_pred:0.01694103516638279, decouple_loss:0.001182502368465066
The modified gen p mean: 0.45093315839767456, gen p mean: -0.04011649265885353, mean p set: 0.45141345262527466The modified gen p mean: 0.44912317395210266, gen p mean: -0.04393497854471207, mean p set: 0.44960349798202515
loss_pred:0.017425309866666794, decouple_loss:0.000942147453315556
loss_pred:0.016499502584338188, decouple_loss:0.0009685520781204104
Iteration: 2430, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45090216398239136, gen p mean: -0.040714286267757416, mean p set: 0.45138245820999146
loss_pred:0.016626622527837753, decouple_loss:0.0010155976051464677
The modified gen p mean: 0.4494178593158722, gen p mean: -0.04723554849624634, mean p set: 0.4498981535434723The modified gen p mean: 0.45130401849746704, gen p mean: -0.04374084621667862, mean p set: 0.4517843425273895
loss_pred:0.016093187034130096, decouple_loss:0.0010563405230641365
loss_pred:0.018359573557972908, decouple_loss:0.0011010468006134033
2023-05-02 11:47:13 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.05624210834503174, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.05191547051072121, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.05254460126161575, mean p set: 0.4500633478164673
loss_pred:0.01827864907681942, decouple_loss:0.001161266933195293
loss_pred:0.01714790053665638, decouple_loss:0.0010464794468134642
loss_pred:0.017284419387578964, decouple_loss:0.0010985627304762602
WV_0_PC_1_EH_0_PS_40, loss: 0.01762542873620987, avg_mse: 0.025285767391324043
current test mse: 0.025286
Iteration: 2431, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4512985348701477, gen p mean: -0.04671812802553177, mean p set: 0.4517787992954254
The modified gen p mean: 0.45078417658805847, gen p mean: -0.045697394758462906, mean p set: 0.45126447081565857
The modified gen p mean: 0.45186030864715576, gen p mean: -0.04838069900870323, mean p set: 0.45234063267707825
loss_pred:0.01745617762207985, decouple_loss:0.0009284212719649076
loss_pred:0.01673174649477005, decouple_loss:0.0009729448356665671
loss_pred:0.016579121351242065, decouple_loss:0.0010580873349681497
Iteration: 2432, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4516259729862213, gen p mean: -0.04412207007408142, mean p set: 0.452106237411499
loss_pred:0.016774339601397514, decouple_loss:0.0009575245203450322
The modified gen p mean: 0.4520045518875122, gen p mean: -0.04498569294810295, mean p set: 0.4524848163127899The modified gen p mean: 0.45340844988822937, gen p mean: -0.049306027591228485, mean p set: 0.45388877391815186
loss_pred:0.016980983316898346, decouple_loss:0.0012154707219451666
loss_pred:0.016556676477193832, decouple_loss:0.0009644649690017104
Iteration: 2433, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499053955078125, gen p mean: -0.04874574393033981, mean p set: 0.4503856897354126
loss_pred:0.017180023714900017, decouple_loss:0.0009812074713408947
The modified gen p mean: 0.4512023627758026, gen p mean: -0.04310041666030884, mean p set: 0.4516826570034027The modified gen p mean: 0.4514826536178589, gen p mean: -0.04364006593823433, mean p set: 0.4519629180431366
loss_pred:0.016154276207089424, decouple_loss:0.0009599988698028028
loss_pred:0.017258746549487114, decouple_loss:0.0009741330868564546
Iteration: 2434, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4506705701351166, gen p mean: -0.0501907654106617, mean p set: 0.4511508643627167
loss_pred:0.016721630468964577, decouple_loss:0.0009223742526955903
The modified gen p mean: 0.4501095116138458, gen p mean: -0.051148220896720886, mean p set: 0.4505898058414459The modified gen p mean: 0.4496452510356903, gen p mean: -0.04736848548054695, mean p set: 0.4501255452632904
loss_pred:0.0171385258436203, decouple_loss:0.0011017434298992157
loss_pred:0.016038093715906143, decouple_loss:0.0009052943205460906
Iteration: 2435, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45307889580726624, gen p mean: -0.04210366681218147, mean p set: 0.45355916023254395
loss_pred:0.016934679821133614, decouple_loss:0.0010118498466908932
The modified gen p mean: 0.4514462351799011, gen p mean: -0.04778246954083443, mean p set: 0.4519265294075012
The modified gen p mean: 0.4498218894004822, gen p mean: -0.040248021483421326, mean p set: 0.4503021836280823
loss_pred:0.016413189470767975, decouple_loss:0.0009736680658534169
loss_pred:0.017185715958476067, decouple_loss:0.0010509745916351676
Iteration: 2436, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511569142341614, gen p mean: -0.046057943254709244, mean p set: 0.45163723826408386
loss_pred:0.01694655790925026, decouple_loss:0.0009470759541727602
The modified gen p mean: 0.45188799500465393, gen p mean: -0.04155990108847618, mean p set: 0.45236828923225403The modified gen p mean: 0.450695276260376, gen p mean: -0.042480193078517914, mean p set: 0.45117560029029846
loss_pred:0.017998741939663887, decouple_loss:0.0008877235813997686
loss_pred:0.016185922548174858, decouple_loss:0.0009159980691038072
Iteration: 2437, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511418342590332, gen p mean: -0.03692324832081795, mean p set: 0.4516221284866333
loss_pred:0.016442961990833282, decouple_loss:0.0009194549056701362
The modified gen p mean: 0.45162826776504517, gen p mean: -0.044771838933229446, mean p set: 0.45210859179496765The modified gen p mean: 0.4519680440425873, gen p mean: -0.04079795256257057, mean p set: 0.4524483382701874
loss_pred:0.017475806176662445, decouple_loss:0.0009033435489982367
loss_pred:0.016669997945427895, decouple_loss:0.0009727898868732154
Iteration: 2438, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45151910185813904, gen p mean: -0.0375421941280365, mean p set: 0.45199936628341675
loss_pred:0.01746608130633831, decouple_loss:0.001000986318103969
The modified gen p mean: 0.44991496205329895, gen p mean: -0.03873603045940399, mean p set: 0.45039525628089905The modified gen p mean: 0.4503227770328522, gen p mean: -0.04039410129189491, mean p set: 0.45080307126045227
loss_pred:0.01688322052359581, decouple_loss:0.0009271863382309675
loss_pred:0.016514698043465614, decouple_loss:0.0009793033823370934
Iteration: 2439, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45034295320510864, gen p mean: -0.04213466867804527, mean p set: 0.45082327723503113
loss_pred:0.017049679532647133, decouple_loss:0.0010063422378152609
The modified gen p mean: 0.45201241970062256, gen p mean: -0.03565265238285065, mean p set: 0.45249274373054504The modified gen p mean: 0.4513959586620331, gen p mean: -0.03710382431745529, mean p set: 0.45187628269195557
loss_pred:0.01741699129343033, decouple_loss:0.0009683145326562226
loss_pred:0.016635220497846603, decouple_loss:0.0011007686844095588
Iteration: 2440, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44956016540527344, gen p mean: -0.034745872020721436, mean p set: 0.45004045963287354
loss_pred:0.016744187101721764, decouple_loss:0.0008849198347888887
The modified gen p mean: 0.4515998661518097, gen p mean: -0.03173387795686722, mean p set: 0.4520801901817322
The modified gen p mean: 0.44942522048950195, gen p mean: -0.036210253834724426, mean p set: 0.44990551471710205
loss_pred:0.01648637279868126, decouple_loss:0.0010497665498405695
loss_pred:0.01644166000187397, decouple_loss:0.000896272889804095
2023-05-02 11:49:08 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.04782402142882347, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04355159401893616, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04401906952261925, mean p set: 0.4500633478164673
loss_pred:0.01822265237569809, decouple_loss:0.001052014995366335
loss_pred:0.017091406509280205, decouple_loss:0.0010692833457142115
loss_pred:0.017251022160053253, decouple_loss:0.0010430444963276386
WV_0_PC_1_EH_0_PS_40, loss: 0.017574433237314224, avg_mse: 0.02520311251282692
current test mse: 0.025203
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012014_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012014_3_24hr.npz
NaN value num: 0
Iteration: 2441, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44758838415145874, gen p mean: -0.0465017706155777, mean p set: 0.44806867837905884
loss_pred:0.014937189407646656, decouple_loss:0.0011033968767151237
The modified gen p mean: 0.44683799147605896, gen p mean: -0.04133220389485359, mean p set: 0.44731831550598145The modified gen p mean: 0.4483104348182678, gen p mean: -0.04512910544872284, mean p set: 0.44879069924354553
loss_pred:0.015311559662222862, decouple_loss:0.000994737260043621
loss_pred:0.015324289910495281, decouple_loss:0.0009659939096309245
Iteration: 2442, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44900867342948914, gen p mean: -0.04584544152021408, mean p set: 0.4494889974594116
loss_pred:0.015029532834887505, decouple_loss:0.0010255319066345692
The modified gen p mean: 0.4482654631137848, gen p mean: -0.045973870903253555, mean p set: 0.4487457573413849The modified gen p mean: 0.44694724678993225, gen p mean: -0.05025612935423851, mean p set: 0.44742754101753235
loss_pred:0.015292189083993435, decouple_loss:0.0010764350881800056
loss_pred:0.01466512493789196, decouple_loss:0.0011224818881601095
Iteration: 2443, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472653269767761, gen p mean: -0.04976416006684303, mean p set: 0.4477456510066986
The modified gen p mean: 0.447806179523468, gen p mean: -0.048372019082307816, mean p set: 0.4482864737510681
loss_pred:0.015116835944354534, decouple_loss:0.001111708814278245
loss_pred:0.014710775576531887, decouple_loss:0.0011648302897810936
The modified gen p mean: 0.4476693272590637, gen p mean: -0.048540081828832626, mean p set: 0.44814959168434143
loss_pred:0.014425315894186497, decouple_loss:0.0011438248911872506
Iteration: 2444, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44737324118614197, gen p mean: -0.0517805814743042, mean p set: 0.44785353541374207
The modified gen p mean: 0.4477446973323822, gen p mean: -0.05420994013547897, mean p set: 0.4482249617576599
loss_pred:0.014895378611981869, decouple_loss:0.0011936682276427746
loss_pred:0.014216740615665913, decouple_loss:0.0011715402361005545
The modified gen p mean: 0.44722220301628113, gen p mean: -0.05129765346646309, mean p set: 0.44770246744155884
loss_pred:0.01416240818798542, decouple_loss:0.0010557983769103885
Iteration: 2445, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476584792137146, gen p mean: -0.05858636647462845, mean p set: 0.4481387734413147
loss_pred:0.014449715614318848, decouple_loss:0.0012327681761234999
The modified gen p mean: 0.4483383893966675, gen p mean: -0.052234526723623276, mean p set: 0.4488186836242676The modified gen p mean: 0.4481663703918457, gen p mean: -0.052518680691719055, mean p set: 0.4486466944217682
loss_pred:0.014722766354680061, decouple_loss:0.0011305706575512886
loss_pred:0.014611484482884407, decouple_loss:0.0011456639040261507
Iteration: 2446, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473603069782257, gen p mean: -0.057817425578832626, mean p set: 0.4478406012058258
loss_pred:0.015058926306664944, decouple_loss:0.0011848390568047762
The modified gen p mean: 0.4468141496181488, gen p mean: -0.05744381621479988, mean p set: 0.4472944438457489The modified gen p mean: 0.4472610652446747, gen p mean: -0.05746141076087952, mean p set: 0.4477413594722748
loss_pred:0.01465123612433672, decouple_loss:0.001183789107017219
loss_pred:0.01454783882945776, decouple_loss:0.0011667493963614106
Iteration: 2447, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44612351059913635, gen p mean: -0.056704387068748474, mean p set: 0.44660380482673645
loss_pred:0.014493812806904316, decouple_loss:0.001195694087073207
The modified gen p mean: 0.4488472044467926, gen p mean: -0.05743328854441643, mean p set: 0.4493274986743927The modified gen p mean: 0.44822150468826294, gen p mean: -0.05695466697216034, mean p set: 0.44870179891586304
loss_pred:0.01427009142935276, decouple_loss:0.0011616108240559697
loss_pred:0.014469621703028679, decouple_loss:0.0011833293829113245
Iteration: 2448, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473407566547394, gen p mean: -0.058173101395368576, mean p set: 0.4478210508823395
loss_pred:0.01447595190256834, decouple_loss:0.0012130477698519826
The modified gen p mean: 0.44829726219177246, gen p mean: -0.0583220049738884, mean p set: 0.44877755641937256
The modified gen p mean: 0.447736531496048, gen p mean: -0.05762633681297302, mean p set: 0.44821682572364807
loss_pred:0.014627162367105484, decouple_loss:0.0012850266648456454
loss_pred:0.014571220614016056, decouple_loss:0.0012528436491265893
Iteration: 2449, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44754457473754883, gen p mean: -0.05806342512369156, mean p set: 0.4480248689651489
loss_pred:0.013786377385258675, decouple_loss:0.0012482833117246628
The modified gen p mean: 0.44706377387046814, gen p mean: -0.06015218421816826, mean p set: 0.44754406809806824The modified gen p mean: 0.4477505385875702, gen p mean: -0.059193458408117294, mean p set: 0.4482308626174927
loss_pred:0.014299081638455391, decouple_loss:0.0012845387682318687
loss_pred:0.014390057884156704, decouple_loss:0.0012587844394147396
Iteration: 2450, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44734418392181396, gen p mean: -0.058986496180295944, mean p set: 0.4478244483470917
loss_pred:0.01417732983827591, decouple_loss:0.0012666326947510242
The modified gen p mean: 0.44761139154434204, gen p mean: -0.060945168137550354, mean p set: 0.4480917155742645The modified gen p mean: 0.44780266284942627, gen p mean: -0.06401223689317703, mean p set: 0.44828295707702637
loss_pred:0.014159179292619228, decouple_loss:0.0012632737634703517
loss_pred:0.014386892318725586, decouple_loss:0.0013571898452937603
2023-05-02 11:51:43 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.05955884978175163, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.055529866367578506, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.055909331887960434, mean p set: 0.4500633478164673
loss_pred:0.019221605733036995, decouple_loss:0.001381276291795075
loss_pred:0.018034635111689568, decouple_loss:0.0014565569581463933
loss_pred:0.018175283446907997, decouple_loss:0.0014625319745391607
WV_0_PC_1_EH_0_PS_40, loss: 0.01854884624481201, avg_mse: 0.027020635083317757
current test mse: 0.027021
Iteration: 2451, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482875466346741, gen p mean: -0.05788175016641617, mean p set: 0.4487678110599518
The modified gen p mean: 0.4480758309364319, gen p mean: -0.05446639284491539, mean p set: 0.44855615496635437
The modified gen p mean: 0.4471362233161926, gen p mean: -0.05847131833434105, mean p set: 0.44761648774147034
loss_pred:0.013853302225470543, decouple_loss:0.0014678934821859002
loss_pred:0.013707911595702171, decouple_loss:0.0013787930365651846
loss_pred:0.013998026959598064, decouple_loss:0.0014228194486349821
Iteration: 2452, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471328854560852, gen p mean: -0.055454373359680176, mean p set: 0.4476131498813629
loss_pred:0.013594185002148151, decouple_loss:0.001273136818781495
The modified gen p mean: 0.4478815495967865, gen p mean: -0.04814654588699341, mean p set: 0.4483618438243866The modified gen p mean: 0.4472672641277313, gen p mean: -0.05093371868133545, mean p set: 0.4477475583553314
loss_pred:0.013897626660764217, decouple_loss:0.001344652846455574
loss_pred:0.013895952142775059, decouple_loss:0.0012654582969844341
Iteration: 2453, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475630521774292, gen p mean: -0.051597319543361664, mean p set: 0.4480433166027069
The modified gen p mean: 0.4461727440357208, gen p mean: -0.04970656335353851, mean p set: 0.44665300846099854
loss_pred:0.013711893931031227, decouple_loss:0.0013244739966467023
loss_pred:0.01413571834564209, decouple_loss:0.0012521360768005252
The modified gen p mean: 0.4473842680454254, gen p mean: -0.05444841459393501, mean p set: 0.4478645324707031
loss_pred:0.013719869777560234, decouple_loss:0.001408297917805612
Iteration: 2454, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475401043891907, gen p mean: -0.048599179834127426, mean p set: 0.44802039861679077
loss_pred:0.013553949072957039, decouple_loss:0.0011977595277130604
The modified gen p mean: 0.44783878326416016, gen p mean: -0.05024035647511482, mean p set: 0.44831904768943787The modified gen p mean: 0.447527676820755, gen p mean: -0.050964392721652985, mean p set: 0.4480080008506775
loss_pred:0.0139071149751544, decouple_loss:0.001238420489244163
loss_pred:0.014050866477191448, decouple_loss:0.0012231635628268123
Iteration: 2455, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474486708641052, gen p mean: -0.051314737647771835, mean p set: 0.4479289650917053
loss_pred:0.014000960625708103, decouple_loss:0.0013200596440583467
The modified gen p mean: 0.4489087164402008, gen p mean: -0.046647511422634125, mean p set: 0.4493890404701233The modified gen p mean: 0.44775915145874023, gen p mean: -0.0511772520840168, mean p set: 0.44823944568634033
loss_pred:0.01418203953653574, decouple_loss:0.0012884089956060052
loss_pred:0.014228511601686478, decouple_loss:0.0014248185325413942
Iteration: 2456, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446699857711792, gen p mean: -0.050461236387491226, mean p set: 0.4471800923347473
loss_pred:0.014031138271093369, decouple_loss:0.0011796714970842004
The modified gen p mean: 0.44856175780296326, gen p mean: -0.04958867281675339, mean p set: 0.44904205203056335The modified gen p mean: 0.44838187098503113, gen p mean: -0.04881330952048302, mean p set: 0.4488621652126312
loss_pred:0.013700705021619797, decouple_loss:0.001219381345435977
loss_pred:0.014474067836999893, decouple_loss:0.0011657034046947956
Iteration: 2457, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44771134853363037, gen p mean: -0.051831863820552826, mean p set: 0.44819164276123047
loss_pred:0.013400585390627384, decouple_loss:0.0012406088644638658
The modified gen p mean: 0.44772869348526, gen p mean: -0.05324858799576759, mean p set: 0.4482089579105377The modified gen p mean: 0.44742661714553833, gen p mean: -0.05408671498298645, mean p set: 0.4479069411754608
loss_pred:0.013994613662362099, decouple_loss:0.0012341038091108203
loss_pred:0.014141090214252472, decouple_loss:0.0012642997317016125
Iteration: 2458, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479805529117584, gen p mean: -0.0540306381881237, mean p set: 0.44846081733703613
loss_pred:0.013608819805085659, decouple_loss:0.0012584514915943146
The modified gen p mean: 0.44873046875, gen p mean: -0.048577532172203064, mean p set: 0.4492107927799225The modified gen p mean: 0.44744864106178284, gen p mean: -0.05460939183831215, mean p set: 0.44792893528938293
loss_pred:0.01425511296838522, decouple_loss:0.0011772699654102325
loss_pred:0.014062314294278622, decouple_loss:0.0012135442811995745
Iteration: 2459, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44658082723617554, gen p mean: -0.05247487127780914, mean p set: 0.44706112146377563
loss_pred:0.013898293487727642, decouple_loss:0.0011291623814031482
The modified gen p mean: 0.44723835587501526, gen p mean: -0.05434216558933258, mean p set: 0.44771865010261536The modified gen p mean: 0.44696977734565735, gen p mean: -0.05494362488389015, mean p set: 0.44745007157325745
loss_pred:0.013598287478089333, decouple_loss:0.0011914517963305116
loss_pred:0.013605822809040546, decouple_loss:0.0011333012953400612
Iteration: 2460, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478708803653717, gen p mean: -0.051614973694086075, mean p set: 0.4483511745929718
loss_pred:0.013788443990051746, decouple_loss:0.001175522687844932
The modified gen p mean: 0.4477596580982208, gen p mean: -0.05663743242621422, mean p set: 0.4482399523258209The modified gen p mean: 0.44712862372398376, gen p mean: -0.050746798515319824, mean p set: 0.44760891795158386
loss_pred:0.014078374020755291, decouple_loss:0.001167814014479518
loss_pred:0.014115477912127972, decouple_loss:0.00114623480476439
2023-05-02 11:53:37 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.057516343891620636, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.0536627359688282, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.05384146794676781, mean p set: 0.4500633478164673
loss_pred:0.01915465109050274, decouple_loss:0.0012792195193469524
loss_pred:0.017942462116479874, decouple_loss:0.0011212666286155581
loss_pred:0.018060987815260887, decouple_loss:0.0011355956085026264
WV_0_PC_1_EH_0_PS_40, loss: 0.0184449702501297, avg_mse: 0.026900365948677063
current test mse: 0.0269
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012018_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012018_3_24hr.npz
NaN value num: 0
Iteration: 2461, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44878119230270386, gen p mean: -0.0583561472594738, mean p set: 0.44926151633262634
loss_pred:0.013252552598714828, decouple_loss:0.0011679164599627256
The modified gen p mean: 0.4480019211769104, gen p mean: -0.05435730889439583, mean p set: 0.4484822154045105The modified gen p mean: 0.44799748063087463, gen p mean: -0.05917935073375702, mean p set: 0.44847777485847473
loss_pred:0.013958737254142761, decouple_loss:0.0011988594196736813
loss_pred:0.01361481100320816, decouple_loss:0.0011977418325841427
Iteration: 2462, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44712579250335693, gen p mean: -0.05664065480232239, mean p set: 0.4476061165332794
loss_pred:0.01368799339979887, decouple_loss:0.0010694462107494473
The modified gen p mean: 0.44749870896339417, gen p mean: -0.053990259766578674, mean p set: 0.44797900319099426The modified gen p mean: 0.448560506105423, gen p mean: -0.05333913862705231, mean p set: 0.44904080033302307
loss_pred:0.013029810972511768, decouple_loss:0.0010613896884024143
loss_pred:0.01396194752305746, decouple_loss:0.0010510551510378718
Iteration: 2463, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44790560007095337, gen p mean: -0.05129807069897652, mean p set: 0.44838589429855347
loss_pred:0.013799518346786499, decouple_loss:0.0011012702016159892
The modified gen p mean: 0.4476151466369629, gen p mean: -0.054413992911577225, mean p set: 0.448095440864563
The modified gen p mean: 0.44841691851615906, gen p mean: -0.049892354756593704, mean p set: 0.44889721274375916
loss_pred:0.013161872513592243, decouple_loss:0.001065936405211687
loss_pred:0.012962983921170235, decouple_loss:0.001076296204701066
Iteration: 2464, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44806525111198425, gen p mean: -0.050888869911432266, mean p set: 0.44854554533958435
loss_pred:0.012812876142561436, decouple_loss:0.0010356670245528221
The modified gen p mean: 0.447795033454895, gen p mean: -0.05444514751434326, mean p set: 0.4482753276824951The modified gen p mean: 0.4472784698009491, gen p mean: -0.05400143936276436, mean p set: 0.4477587640285492
loss_pred:0.014091992750763893, decouple_loss:0.0010954431490972638
loss_pred:0.013282177038490772, decouple_loss:0.0011687584919854999
Iteration: 2465, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44811341166496277, gen p mean: -0.04859970510005951, mean p set: 0.44859370589256287
loss_pred:0.013648892752826214, decouple_loss:0.0010554557666182518
The modified gen p mean: 0.44788503646850586, gen p mean: -0.05115503445267677, mean p set: 0.44836533069610596The modified gen p mean: 0.4477713406085968, gen p mean: -0.05096570774912834, mean p set: 0.4482516348361969
loss_pred:0.01377228181809187, decouple_loss:0.001043537980876863
loss_pred:0.013838796876370907, decouple_loss:0.0010504198726266623
Iteration: 2466, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44794991612434387, gen p mean: -0.045752763748168945, mean p set: 0.44843021035194397
loss_pred:0.013573669828474522, decouple_loss:0.0010830251267179847
The modified gen p mean: 0.4483509063720703, gen p mean: -0.04896056652069092, mean p set: 0.4488312005996704The modified gen p mean: 0.44780266284942627, gen p mean: -0.04958033934235573, mean p set: 0.44828298687934875
loss_pred:0.01301288977265358, decouple_loss:0.0010591866448521614
loss_pred:0.013813278637826443, decouple_loss:0.0009916936978697777
Iteration: 2467, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44844841957092285, gen p mean: -0.04697902128100395, mean p set: 0.44892874360084534
loss_pred:0.01355548296123743, decouple_loss:0.0009783523855730891
The modified gen p mean: 0.44811728596687317, gen p mean: -0.04742219299077988, mean p set: 0.44859760999679565The modified gen p mean: 0.44728925824165344, gen p mean: -0.05343646556138992, mean p set: 0.44776955246925354
loss_pred:0.013293776661157608, decouple_loss:0.0010793140390887856
loss_pred:0.014289302751421928, decouple_loss:0.0010572465835139155
Iteration: 2468, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44791802763938904, gen p mean: -0.04601861909031868, mean p set: 0.44839832186698914
loss_pred:0.013018916361033916, decouple_loss:0.001003010431304574
The modified gen p mean: 0.4482947587966919, gen p mean: -0.04810267314314842, mean p set: 0.448775053024292The modified gen p mean: 0.4482262134552002, gen p mean: -0.04466887190937996, mean p set: 0.4487065374851227
loss_pred:0.014127202332019806, decouple_loss:0.0009929792722687125
loss_pred:0.013351403176784515, decouple_loss:0.0009848077315837145
Iteration: 2469, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44744613766670227, gen p mean: -0.048006851226091385, mean p set: 0.44792643189430237
loss_pred:0.01367088221013546, decouple_loss:0.001038135844282806
The modified gen p mean: 0.44762691855430603, gen p mean: -0.05108823627233505, mean p set: 0.44810721278190613The modified gen p mean: 0.4484274089336395, gen p mean: -0.048326388001441956, mean p set: 0.4489077031612396
loss_pred:0.01320848148316145, decouple_loss:0.0009983144700527191
loss_pred:0.012787064537405968, decouple_loss:0.0010212435154244304
Iteration: 2470, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44719934463500977, gen p mean: -0.05046074464917183, mean p set: 0.4476796090602875
loss_pred:0.013525029644370079, decouple_loss:0.0010095718316733837
The modified gen p mean: 0.44795525074005127, gen p mean: -0.048256706446409225, mean p set: 0.44843557476997375The modified gen p mean: 0.44780221581459045, gen p mean: -0.049826767295598984, mean p set: 0.44828253984451294
loss_pred:0.01334782037883997, decouple_loss:0.0009765545255504549
loss_pred:0.013651604764163494, decouple_loss:0.0009926086058840156
2023-05-02 11:56:13 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.04887821152806282, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.044855669140815735, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.045209188014268875, mean p set: 0.4500633478164673
loss_pred:0.018978476524353027, decouple_loss:0.001060372218489647
loss_pred:0.017734907567501068, decouple_loss:0.0010481112403795123
loss_pred:0.017809540033340454, decouple_loss:0.0010056847240775824
WV_0_PC_1_EH_0_PS_40, loss: 0.01822621189057827, avg_mse: 0.026526445522904396
current test mse: 0.026526
Iteration: 2471, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477216899394989, gen p mean: -0.04897433519363403, mean p set: 0.448201984167099
The modified gen p mean: 0.4478529691696167, gen p mean: -0.04558413475751877, mean p set: 0.4483332633972168
The modified gen p mean: 0.4478616714477539, gen p mean: -0.049257390201091766, mean p set: 0.448341965675354
loss_pred:0.013557317666709423, decouple_loss:0.0010598039953038096
loss_pred:0.012798597104847431, decouple_loss:0.0010294342646375299
loss_pred:0.013349323533475399, decouple_loss:0.0010033780708909035
Iteration: 2472, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481160640716553, gen p mean: -0.050384458154439926, mean p set: 0.44859638810157776
loss_pred:0.013782601803541183, decouple_loss:0.0009925919584929943
The modified gen p mean: 0.44868525862693787, gen p mean: -0.04493315517902374, mean p set: 0.4491655230522156
The modified gen p mean: 0.449163019657135, gen p mean: -0.046178627759218216, mean p set: 0.4496433436870575
loss_pred:0.013354511931538582, decouple_loss:0.0010015330044552684
loss_pred:0.01336305495351553, decouple_loss:0.000989770982414484
Iteration: 2473, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448133647441864, gen p mean: -0.04837231710553169, mean p set: 0.4486139416694641
loss_pred:0.013164193369448185, decouple_loss:0.0010191123001277447
The modified gen p mean: 0.44806358218193054, gen p mean: -0.04635358601808548, mean p set: 0.44854387640953064The modified gen p mean: 0.4478336572647095, gen p mean: -0.045768994837999344, mean p set: 0.4483139216899872
loss_pred:0.013524488545954227, decouple_loss:0.0010350617812946439
loss_pred:0.013407176360487938, decouple_loss:0.000980321317911148
Iteration: 2474, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44751855731010437, gen p mean: -0.04776696115732193, mean p set: 0.44799885153770447
loss_pred:0.0130960363894701, decouple_loss:0.0010201288387179375
The modified gen p mean: 0.44773542881011963, gen p mean: -0.051915790885686874, mean p set: 0.4482157230377197The modified gen p mean: 0.44753900170326233, gen p mean: -0.046028971672058105, mean p set: 0.4480193257331848
loss_pred:0.013502544723451138, decouple_loss:0.0009863165905699134
loss_pred:0.013015261851251125, decouple_loss:0.0010118390200659633
Iteration: 2475, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44778385758399963, gen p mean: -0.04623234272003174, mean p set: 0.44826412200927734
loss_pred:0.013221682980656624, decouple_loss:0.000996032846160233
The modified gen p mean: 0.4480688273906708, gen p mean: -0.047704026103019714, mean p set: 0.4485490918159485The modified gen p mean: 0.448762446641922, gen p mean: -0.04552321508526802, mean p set: 0.4492427408695221
loss_pred:0.014037370681762695, decouple_loss:0.0010673009091988206
loss_pred:0.013299471698701382, decouple_loss:0.001039173104800284
Iteration: 2476, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479043781757355, gen p mean: -0.04870855063199997, mean p set: 0.44838467240333557
loss_pred:0.013037534430623055, decouple_loss:0.0010340617736801505
The modified gen p mean: 0.44799932837486267, gen p mean: -0.05023476108908653, mean p set: 0.44847962260246277The modified gen p mean: 0.44771310687065125, gen p mean: -0.05054068565368652, mean p set: 0.44819343090057373
loss_pred:0.013923688791692257, decouple_loss:0.0009715075138956308
loss_pred:0.013315219432115555, decouple_loss:0.0010074302554130554
Iteration: 2477, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481903612613678, gen p mean: -0.04989173263311386, mean p set: 0.4486706554889679
loss_pred:0.012754552997648716, decouple_loss:0.00102268997579813
The modified gen p mean: 0.4483286142349243, gen p mean: -0.045561373233795166, mean p set: 0.4488089084625244The modified gen p mean: 0.44787734746932983, gen p mean: -0.049427811056375504, mean p set: 0.4483576714992523
loss_pred:0.013905426487326622, decouple_loss:0.0010524867102503777
loss_pred:0.013684631325304508, decouple_loss:0.0010078756604343653
Iteration: 2478, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474197030067444, gen p mean: -0.04902181029319763, mean p set: 0.4478999972343445
loss_pred:0.01342194713652134, decouple_loss:0.0010008941171690822
The modified gen p mean: 0.4481147229671478, gen p mean: -0.049212291836738586, mean p set: 0.4485950171947479The modified gen p mean: 0.4475158154964447, gen p mean: -0.04648485779762268, mean p set: 0.4479960799217224
loss_pred:0.013594581745564938, decouple_loss:0.0009915585396811366
loss_pred:0.013536814600229263, decouple_loss:0.0010047570103779435
Iteration: 2479, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44798147678375244, gen p mean: -0.04508469998836517, mean p set: 0.44846177101135254
loss_pred:0.013176637701690197, decouple_loss:0.0009614239097572863
The modified gen p mean: 0.4477161765098572, gen p mean: -0.045361414551734924, mean p set: 0.44819650053977966The modified gen p mean: 0.4475034475326538, gen p mean: -0.05141573026776314, mean p set: 0.4479837417602539
loss_pred:0.012810834683477879, decouple_loss:0.0010599823435768485
loss_pred:0.013637928292155266, decouple_loss:0.0009496883722022176
Iteration: 2480, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476363956928253, gen p mean: -0.04639257490634918, mean p set: 0.4481166899204254
loss_pred:0.013751118443906307, decouple_loss:0.0010111312149092555
The modified gen p mean: 0.44754910469055176, gen p mean: -0.05122586339712143, mean p set: 0.44802939891815186The modified gen p mean: 0.44741690158843994, gen p mean: -0.046652376651763916, mean p set: 0.44789719581604004
loss_pred:0.013374232687056065, decouple_loss:0.0009474338730797172
loss_pred:0.013304391875863075, decouple_loss:0.0009521647007204592
2023-05-02 11:58:08 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.049342695623636246, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.045203495770692825, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.04572881758213043, mean p set: 0.4500633478164673
loss_pred:0.018835410475730896, decouple_loss:0.0010017973836511374
loss_pred:0.01767193153500557, decouple_loss:0.0009917274583131075
loss_pred:0.017724724486470222, decouple_loss:0.0009960660245269537
WV_0_PC_1_EH_0_PS_40, loss: 0.018127184361219406, avg_mse: 0.0263549592345953
current test mse: 0.026355
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012008_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012008_3_24hr.npz
NaN value num: 0
Iteration: 2481, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44694778323173523, gen p mean: -0.04681145399808884, mean p set: 0.4474280774593353
loss_pred:0.016075002029538155, decouple_loss:0.000976226874627173
The modified gen p mean: 0.44629257917404175, gen p mean: -0.050156835466623306, mean p set: 0.44677287340164185The modified gen p mean: 0.4472256004810333, gen p mean: -0.05067594349384308, mean p set: 0.44770586490631104
loss_pred:0.01631181500852108, decouple_loss:0.0010059438645839691
loss_pred:0.015864495187997818, decouple_loss:0.0009667687700130045
Iteration: 2482, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4463740587234497, gen p mean: -0.049476828426122665, mean p set: 0.4468543529510498
loss_pred:0.01618066430091858, decouple_loss:0.0009819164406508207
The modified gen p mean: 0.4469824731349945, gen p mean: -0.04745287075638771, mean p set: 0.4474627375602722
The modified gen p mean: 0.4456685483455658, gen p mean: -0.04641957953572273, mean p set: 0.4461488425731659
loss_pred:0.01648341864347458, decouple_loss:0.000988825224339962
loss_pred:0.016263766214251518, decouple_loss:0.0009885620092973113
Iteration: 2483, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468720257282257, gen p mean: -0.050473131239414215, mean p set: 0.4473523199558258
loss_pred:0.015468995086848736, decouple_loss:0.001105917152017355
The modified gen p mean: 0.44586387276649475, gen p mean: -0.048271216452121735, mean p set: 0.44634416699409485The modified gen p mean: 0.44649001955986023, gen p mean: -0.046532295644283295, mean p set: 0.4469703137874603
loss_pred:0.016299262642860413, decouple_loss:0.0011089163599535823
loss_pred:0.016205815598368645, decouple_loss:0.0010801426833495498
Iteration: 2484, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44824230670928955, gen p mean: -0.05445442721247673, mean p set: 0.44872260093688965
loss_pred:0.015246897004544735, decouple_loss:0.0011147542390972376
The modified gen p mean: 0.4463704824447632, gen p mean: -0.04909009858965874, mean p set: 0.4468507766723633The modified gen p mean: 0.446490615606308, gen p mean: -0.04869125783443451, mean p set: 0.4469709098339081
loss_pred:0.015475193969905376, decouple_loss:0.0010062942747026682
loss_pred:0.01571482978761196, decouple_loss:0.0010091167641803622
Iteration: 2485, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464409351348877, gen p mean: -0.0515754260122776, mean p set: 0.4469212293624878
loss_pred:0.015389596112072468, decouple_loss:0.0009914836846292019
The modified gen p mean: 0.44609305262565613, gen p mean: -0.048712313175201416, mean p set: 0.4465733468532562The modified gen p mean: 0.44643571972846985, gen p mean: -0.0489429347217083, mean p set: 0.44691601395606995
loss_pred:0.01590203307569027, decouple_loss:0.0010446847882121801
loss_pred:0.01626979000866413, decouple_loss:0.001031767576932907
Iteration: 2486, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4462442696094513, gen p mean: -0.04757196828722954, mean p set: 0.4467245936393738
loss_pred:0.015648305416107178, decouple_loss:0.0011412431485950947
The modified gen p mean: 0.44578951597213745, gen p mean: -0.04477269947528839, mean p set: 0.44626984000205994The modified gen p mean: 0.4458196759223938, gen p mean: -0.0434749536216259, mean p set: 0.4462999701499939
loss_pred:0.016301369294524193, decouple_loss:0.001206676592119038
loss_pred:0.01619238406419754, decouple_loss:0.001036277157254517
Iteration: 2487, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486481547355652, gen p mean: -0.0458415150642395, mean p set: 0.44912847876548767
loss_pred:0.01524791307747364, decouple_loss:0.0010608290322124958
The modified gen p mean: 0.446650892496109, gen p mean: -0.04480506479740143, mean p set: 0.4471311867237091The modified gen p mean: 0.44573476910591125, gen p mean: -0.04677163064479828, mean p set: 0.44621503353118896
loss_pred:0.015676157549023628, decouple_loss:0.0009904211619868875
loss_pred:0.015336240641772747, decouple_loss:0.0009568711975589395
Iteration: 2488, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44563257694244385, gen p mean: -0.04500903934240341, mean p set: 0.44611287117004395
loss_pred:0.01605587638914585, decouple_loss:0.0010424134088680148
The modified gen p mean: 0.4459913671016693, gen p mean: -0.04776606336236, mean p set: 0.4464716613292694The modified gen p mean: 0.44696301221847534, gen p mean: -0.049032289534807205, mean p set: 0.44744330644607544
loss_pred:0.015338555909693241, decouple_loss:0.0010309385834261775
loss_pred:0.01531415618956089, decouple_loss:0.0009840890998020768
Iteration: 2489, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469850957393646, gen p mean: -0.05000133067369461, mean p set: 0.4474653899669647
loss_pred:0.016060475260019302, decouple_loss:0.0010653630597516894
The modified gen p mean: 0.44690370559692383, gen p mean: -0.0479385145008564, mean p set: 0.4473839998245239The modified gen p mean: 0.44619181752204895, gen p mean: -0.04345051199197769, mean p set: 0.44667208194732666
loss_pred:0.015051241964101791, decouple_loss:0.0010054848389700055
loss_pred:0.01585080847144127, decouple_loss:0.0009559785248711705
Iteration: 2490, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475141763687134, gen p mean: -0.045135244727134705, mean p set: 0.4479944705963135
loss_pred:0.015937035903334618, decouple_loss:0.0010377519065514207
The modified gen p mean: 0.4461541473865509, gen p mean: -0.04619226232171059, mean p set: 0.4466344118118286The modified gen p mean: 0.4465961754322052, gen p mean: -0.043743208050727844, mean p set: 0.4470764696598053
loss_pred:0.015910208225250244, decouple_loss:0.0010250702034682035
loss_pred:0.015977224335074425, decouple_loss:0.0009908934589475393
2023-05-02 12:00:37 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.04726947098970413, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04320908337831497, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04365677759051323, mean p set: 0.4500633478164673
loss_pred:0.018427537754178047, decouple_loss:0.0009920281590893865
loss_pred:0.017380371689796448, decouple_loss:0.0010039531625807285
loss_pred:0.01737774722278118, decouple_loss:0.0010060715721920133
WV_0_PC_1_EH_0_PS_40, loss: 0.017778586596250534, avg_mse: 0.025664646178483963
current test mse: 0.025665
Iteration: 2491, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44588515162467957, gen p mean: -0.046682022511959076, mean p set: 0.44636544585227966
The modified gen p mean: 0.4454819858074188, gen p mean: -0.0462040938436985, mean p set: 0.4459622800350189
The modified gen p mean: 0.44712796807289124, gen p mean: -0.0530385747551918, mean p set: 0.44760826230049133
loss_pred:0.01557491160929203, decouple_loss:0.001000582822598517
loss_pred:0.015452049672603607, decouple_loss:0.0009603336802683771
loss_pred:0.015580889768898487, decouple_loss:0.0009687512647360563
Iteration: 2492, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4459577202796936, gen p mean: -0.04678524658083916, mean p set: 0.4464380145072937
loss_pred:0.015092259272933006, decouple_loss:0.0009280479280278087
The modified gen p mean: 0.4474466145038605, gen p mean: -0.04829844459891319, mean p set: 0.44792690873146057The modified gen p mean: 0.4456902742385864, gen p mean: -0.04654565453529358, mean p set: 0.4461705982685089
loss_pred:0.015897491946816444, decouple_loss:0.000986268394626677
loss_pred:0.01570630818605423, decouple_loss:0.0009767379378899932
Iteration: 2493, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.445686012506485, gen p mean: -0.046589501202106476, mean p set: 0.4461663067340851
loss_pred:0.015844929963350296, decouple_loss:0.0009426138713024557
The modified gen p mean: 0.4488474428653717, gen p mean: -0.04552759230136871, mean p set: 0.4493277370929718The modified gen p mean: 0.44811758399009705, gen p mean: -0.04582691937685013, mean p set: 0.44859790802001953
loss_pred:0.015029874630272388, decouple_loss:0.0010035907616838813
loss_pred:0.015272877179086208, decouple_loss:0.0011050066677853465
Iteration: 2494, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44628211855888367, gen p mean: -0.04946945980191231, mean p set: 0.4467623829841614
loss_pred:0.016350766643881798, decouple_loss:0.0009567523957230151
The modified gen p mean: 0.4455968141555786, gen p mean: -0.05028911679983139, mean p set: 0.4460771083831787The modified gen p mean: 0.4462193548679352, gen p mean: -0.04987827688455582, mean p set: 0.4466996490955353
loss_pred:0.01569976657629013, decouple_loss:0.0010078002233058214
loss_pred:0.015929315239191055, decouple_loss:0.0009455375256948173
Iteration: 2495, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44646114110946655, gen p mean: -0.0447300486266613, mean p set: 0.44694146513938904
loss_pred:0.015747902914881706, decouple_loss:0.0009431703947484493
The modified gen p mean: 0.44793447852134705, gen p mean: -0.054083842784166336, mean p set: 0.44841480255126953The modified gen p mean: 0.44600093364715576, gen p mean: -0.051616840064525604, mean p set: 0.44648122787475586
loss_pred:0.01569853536784649, decouple_loss:0.0009773875353857875
loss_pred:0.014809934422373772, decouple_loss:0.0009811294730752707
Iteration: 2496, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44701701402664185, gen p mean: -0.04786011949181557, mean p set: 0.44749733805656433
loss_pred:0.01593203656375408, decouple_loss:0.0009391505154781044
The modified gen p mean: 0.4475557506084442, gen p mean: -0.04567232355475426, mean p set: 0.4480360448360443The modified gen p mean: 0.44659650325775146, gen p mean: -0.047592971473932266, mean p set: 0.44707679748535156
loss_pred:0.015427622012794018, decouple_loss:0.0009578660828992724
loss_pred:0.015905441716313362, decouple_loss:0.0009850615169852972
Iteration: 2497, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4463377594947815, gen p mean: -0.047880467027425766, mean p set: 0.4468180239200592
loss_pred:0.015650896355509758, decouple_loss:0.0009779136162251234
The modified gen p mean: 0.44680672883987427, gen p mean: -0.048593487590551376, mean p set: 0.44728702306747437The modified gen p mean: 0.44685351848602295, gen p mean: -0.04308357089757919, mean p set: 0.44733378291130066
loss_pred:0.016174234449863434, decouple_loss:0.0009803216671571136
loss_pred:0.01564718969166279, decouple_loss:0.0010762783931568265
Iteration: 2498, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467600882053375, gen p mean: -0.0397331602871418, mean p set: 0.4472403824329376
loss_pred:0.015890663489699364, decouple_loss:0.0009539421880617738
The modified gen p mean: 0.44762691855430603, gen p mean: -0.045130450278520584, mean p set: 0.44810721278190613The modified gen p mean: 0.4461958110332489, gen p mean: -0.04518994316458702, mean p set: 0.4466760754585266
loss_pred:0.01532826479524374, decouple_loss:0.0009609424159862101
loss_pred:0.01568981073796749, decouple_loss:0.0009745638817548752
Iteration: 2499, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4463348984718323, gen p mean: -0.040428489446640015, mean p set: 0.4468151926994324
loss_pred:0.015643542632460594, decouple_loss:0.0009173721773549914
The modified gen p mean: 0.448067307472229, gen p mean: -0.041675057262182236, mean p set: 0.4485476016998291The modified gen p mean: 0.44582054018974304, gen p mean: -0.04405321925878525, mean p set: 0.44630083441734314
loss_pred:0.01502190064638853, decouple_loss:0.000898772559594363
loss_pred:0.01580260694026947, decouple_loss:0.0009318440570496023
Iteration: 2500, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44668063521385193, gen p mean: -0.04123852029442787, mean p set: 0.44716089963912964
loss_pred:0.015399504452943802, decouple_loss:0.0009055380942299962
The modified gen p mean: 0.4468127191066742, gen p mean: -0.0435945987701416, mean p set: 0.4472929835319519
The modified gen p mean: 0.4474918842315674, gen p mean: -0.041723210364580154, mean p set: 0.4479721784591675
loss_pred:0.015033334493637085, decouple_loss:0.0008752885623835027
loss_pred:0.015180055052042007, decouple_loss:0.0008745070081204176
2023-05-02 12:02:32 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.04419149085879326, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04027489200234413, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04074003919959068, mean p set: 0.4500633478164673
loss_pred:0.01851153001189232, decouple_loss:0.0010538188507780433
loss_pred:0.017416639253497124, decouple_loss:0.0010284488089382648
loss_pred:0.01743311807513237, decouple_loss:0.0010308549972251058
WV_0_PC_1_EH_0_PS_40, loss: 0.0178389810025692, avg_mse: 0.02577230893075466
current test mse: 0.025772
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012009_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012009_3_24hr.npz
NaN value num: 0
Iteration: 2501, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4520491063594818, gen p mean: -0.03689468279480934, mean p set: 0.4525294005870819
loss_pred:0.015723437070846558, decouple_loss:0.0009050904773175716
The modified gen p mean: 0.45172128081321716, gen p mean: -0.03790636733174324, mean p set: 0.45220157504081726The modified gen p mean: 0.45108267664909363, gen p mean: -0.035876061767339706, mean p set: 0.4515630006790161
loss_pred:0.01559244655072689, decouple_loss:0.0008805157849565148
loss_pred:0.015602820552885532, decouple_loss:0.0008698636083863676
Iteration: 2502, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45151445269584656, gen p mean: -0.04067688807845116, mean p set: 0.45199474692344666
loss_pred:0.01536403689533472, decouple_loss:0.0010075297905132174
The modified gen p mean: 0.4517834484577179, gen p mean: -0.03875521197915077, mean p set: 0.452263742685318The modified gen p mean: 0.4498148560523987, gen p mean: -0.03681154176592827, mean p set: 0.4502951502799988
loss_pred:0.01571190170943737, decouple_loss:0.0009100709576159716
loss_pred:0.015705430880188942, decouple_loss:0.0008895894861780107
Iteration: 2503, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44995635747909546, gen p mean: -0.038239650428295135, mean p set: 0.4504365921020508
loss_pred:0.01531730405986309, decouple_loss:0.0008572139195166528
The modified gen p mean: 0.4516680836677551, gen p mean: -0.047412723302841187, mean p set: 0.4521483778953552The modified gen p mean: 0.45193731784820557, gen p mean: -0.03746471926569939, mean p set: 0.45241761207580566
loss_pred:0.016345053911209106, decouple_loss:0.0010218943934887648
loss_pred:0.016015205532312393, decouple_loss:0.0009431966464035213
Iteration: 2504, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514254629611969, gen p mean: -0.03751359507441521, mean p set: 0.451905757188797
loss_pred:0.01624784991145134, decouple_loss:0.0009705256088636816
The modified gen p mean: 0.4499293267726898, gen p mean: -0.04264090210199356, mean p set: 0.4504096210002899The modified gen p mean: 0.4494033455848694, gen p mean: -0.04227171093225479, mean p set: 0.4498836398124695
loss_pred:0.01622268371284008, decouple_loss:0.0010118742939084768
loss_pred:0.01573573797941208, decouple_loss:0.0009347617160528898
Iteration: 2505, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44968274235725403, gen p mean: -0.037884023040533066, mean p set: 0.4501630365848541
loss_pred:0.015408177860081196, decouple_loss:0.0009636335889808834
The modified gen p mean: 0.45246824622154236, gen p mean: -0.03850744664669037, mean p set: 0.45294854044914246
The modified gen p mean: 0.4513101875782013, gen p mean: -0.03795265406370163, mean p set: 0.4517904818058014
loss_pred:0.01669144257903099, decouple_loss:0.0009199267369695008
loss_pred:0.015509403310716152, decouple_loss:0.0009733936167322099
Iteration: 2506, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498800039291382, gen p mean: -0.041214585304260254, mean p set: 0.4503602981567383
loss_pred:0.01567869447171688, decouple_loss:0.000976404407992959
The modified gen p mean: 0.45124033093452454, gen p mean: -0.047853194177150726, mean p set: 0.45172062516212463The modified gen p mean: 0.4505032002925873, gen p mean: -0.03858771175146103, mean p set: 0.4509834945201874
loss_pred:0.01572221703827381, decouple_loss:0.0009445633622817695
loss_pred:0.01634959504008293, decouple_loss:0.0009582298225723207
Iteration: 2507, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4510924220085144, gen p mean: -0.039811037480831146, mean p set: 0.4515727162361145
loss_pred:0.01545174140483141, decouple_loss:0.0010169688612222672
The modified gen p mean: 0.45181509852409363, gen p mean: -0.03871376812458038, mean p set: 0.4522954225540161The modified gen p mean: 0.4502983093261719, gen p mean: -0.03654580935835838, mean p set: 0.450778603553772
loss_pred:0.015715498477220535, decouple_loss:0.0010705923195928335
loss_pred:0.016362592577934265, decouple_loss:0.0010244130389764905
Iteration: 2508, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4517233073711395, gen p mean: -0.03681750223040581, mean p set: 0.452203631401062
loss_pred:0.016012802720069885, decouple_loss:0.0008895004284568131
The modified gen p mean: 0.452109694480896, gen p mean: -0.039046745747327805, mean p set: 0.4525899887084961The modified gen p mean: 0.44928792119026184, gen p mean: -0.038004834204912186, mean p set: 0.4497682452201843
loss_pred:0.0156951155513525, decouple_loss:0.0009457290288992226
loss_pred:0.015850694850087166, decouple_loss:0.0008917116210795939
Iteration: 2509, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511820375919342, gen p mean: -0.03890122473239899, mean p set: 0.4516623318195343
loss_pred:0.015539557673037052, decouple_loss:0.0010465234518051147
The modified gen p mean: 0.44981104135513306, gen p mean: -0.04038817435503006, mean p set: 0.45029133558273315The modified gen p mean: 0.4504394233226776, gen p mean: -0.04110150411725044, mean p set: 0.4509196877479553
loss_pred:0.01632869243621826, decouple_loss:0.001098352367989719
loss_pred:0.01606922037899494, decouple_loss:0.0010774551192298532
Iteration: 2510, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493976831436157, gen p mean: -0.04002518579363823, mean p set: 0.44987794756889343
loss_pred:0.016133207827806473, decouple_loss:0.0009347025188617408
The modified gen p mean: 0.45031842589378357, gen p mean: -0.04238259792327881, mean p set: 0.45079872012138367The modified gen p mean: 0.4500633776187897, gen p mean: -0.03901209309697151, mean p set: 0.45054367184638977
loss_pred:0.01642402820289135, decouple_loss:0.0009312800830230117
loss_pred:0.015184521675109863, decouple_loss:0.000982664991170168
2023-05-02 12:05:06 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.04487091302871704, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04080181196331978, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04134880006313324, mean p set: 0.4500633478164673
loss_pred:0.01851203665137291, decouple_loss:0.00107708724681288
loss_pred:0.017407726496458054, decouple_loss:0.0011154350358992815
loss_pred:0.017422709614038467, decouple_loss:0.0010617092484608293
WV_0_PC_1_EH_0_PS_40, loss: 0.017835061997175217, avg_mse: 0.02573934569954872
current test mse: 0.025739
Iteration: 2511, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508478045463562, gen p mean: -0.03949538245797157, mean p set: 0.4513280689716339
The modified gen p mean: 0.45142194628715515, gen p mean: -0.04485678672790527, mean p set: 0.45190224051475525
The modified gen p mean: 0.45118770003318787, gen p mean: -0.03740647807717323, mean p set: 0.45166799426078796
loss_pred:0.01589040830731392, decouple_loss:0.0009874909883365035
loss_pred:0.015428685583174229, decouple_loss:0.001118354732170701
loss_pred:0.016176939010620117, decouple_loss:0.0010457605822011828
Iteration: 2512, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4510711431503296, gen p mean: -0.03949110209941864, mean p set: 0.4515514075756073
loss_pred:0.016209464520215988, decouple_loss:0.0009261916275136173
The modified gen p mean: 0.45099058747291565, gen p mean: -0.03813456743955612, mean p set: 0.45147088170051575The modified gen p mean: 0.44959643483161926, gen p mean: -0.03772462159395218, mean p set: 0.45007672905921936
loss_pred:0.01572532020509243, decouple_loss:0.0009261782979592681
loss_pred:0.015318624675273895, decouple_loss:0.0009235473116859794
Iteration: 2513, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45050284266471863, gen p mean: -0.04270476847887039, mean p set: 0.4509831368923187
loss_pred:0.016289427876472473, decouple_loss:0.0010908619733527303
The modified gen p mean: 0.45251035690307617, gen p mean: -0.03697444498538971, mean p set: 0.4529906213283539The modified gen p mean: 0.44945889711380005, gen p mean: -0.03837132453918457, mean p set: 0.44993916153907776
loss_pred:0.015327238477766514, decouple_loss:0.000967720989137888
loss_pred:0.015551308169960976, decouple_loss:0.0010096129262819886
Iteration: 2514, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45203572511672974, gen p mean: -0.03777787461876869, mean p set: 0.45251601934432983
loss_pred:0.015723081305623055, decouple_loss:0.0008978938567452133
The modified gen p mean: 0.45117947459220886, gen p mean: -0.04321688041090965, mean p set: 0.4516597390174866The modified gen p mean: 0.4533883035182953, gen p mean: -0.03738013282418251, mean p set: 0.453868567943573
loss_pred:0.015265243127942085, decouple_loss:0.0008987966575659811
loss_pred:0.015501037240028381, decouple_loss:0.0009986766381189227
Iteration: 2515, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.453704297542572, gen p mean: -0.03556990996003151, mean p set: 0.45418456196784973
loss_pred:0.01572556234896183, decouple_loss:0.0008071012562140822
The modified gen p mean: 0.4508407413959503, gen p mean: -0.03657950460910797, mean p set: 0.4513210654258728The modified gen p mean: 0.4517621099948883, gen p mean: -0.03809242323040962, mean p set: 0.4522424042224884
loss_pred:0.015667421743273735, decouple_loss:0.000860385422129184
loss_pred:0.016389837488532066, decouple_loss:0.0008786781691014767
Iteration: 2516, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45053043961524963, gen p mean: -0.03995928913354874, mean p set: 0.45101073384284973
loss_pred:0.01629910059273243, decouple_loss:0.000882432796061039
The modified gen p mean: 0.4516625702381134, gen p mean: -0.04021362587809563, mean p set: 0.4521428644657135The modified gen p mean: 0.45179039239883423, gen p mean: -0.038514379411935806, mean p set: 0.4522706866264343
loss_pred:0.015213051810860634, decouple_loss:0.0008545711170881987
loss_pred:0.01620316319167614, decouple_loss:0.0008167088963091373
Iteration: 2517, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44962507486343384, gen p mean: -0.03854615241289139, mean p set: 0.45010536909103394
loss_pred:0.015571372583508492, decouple_loss:0.0008931548218242824
The modified gen p mean: 0.45086970925331116, gen p mean: -0.036678291857242584, mean p set: 0.45135000348091125The modified gen p mean: 0.45180270075798035, gen p mean: -0.036594048142433167, mean p set: 0.45228299498558044
loss_pred:0.015657490119338036, decouple_loss:0.0008985920576378703
loss_pred:0.015741907060146332, decouple_loss:0.0008913712808862329
Iteration: 2518, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4515420198440552, gen p mean: -0.03752080723643303, mean p set: 0.4520223140716553
loss_pred:0.016080226749181747, decouple_loss:0.0008257243316620588
The modified gen p mean: 0.45034050941467285, gen p mean: -0.03814690187573433, mean p set: 0.45082080364227295The modified gen p mean: 0.4497741162776947, gen p mean: -0.042739734053611755, mean p set: 0.4502543807029724
loss_pred:0.015394586138427258, decouple_loss:0.0008812847081571817
loss_pred:0.016166139394044876, decouple_loss:0.0008781533106230199
Iteration: 2519, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4527937173843384, gen p mean: -0.03789343312382698, mean p set: 0.4532740116119385
loss_pred:0.015348845161497593, decouple_loss:0.0008841863600537181
The modified gen p mean: 0.4502943754196167, gen p mean: -0.03855004161596298, mean p set: 0.4507746696472168The modified gen p mean: 0.4494931399822235, gen p mean: -0.04005689546465874, mean p set: 0.449973464012146
loss_pred:0.016385983675718307, decouple_loss:0.0008927503949962556
loss_pred:0.01597432978451252, decouple_loss:0.0008794701425358653
Iteration: 2520, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44935843348503113, gen p mean: -0.04279341921210289, mean p set: 0.4498387575149536
loss_pred:0.01609238237142563, decouple_loss:0.0009883196325972676
The modified gen p mean: 0.4508695602416992, gen p mean: -0.03568072244524956, mean p set: 0.4513498842716217The modified gen p mean: 0.45313552021980286, gen p mean: -0.0374431237578392, mean p set: 0.45361581444740295
loss_pred:0.015558747574687004, decouple_loss:0.0009164985967800021
loss_pred:0.015515236184000969, decouple_loss:0.0009725627605803311
2023-05-02 12:07:00 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.04610861465334892, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.041572168469429016, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.042223088443279266, mean p set: 0.4500633478164673
loss_pred:0.018476277589797974, decouple_loss:0.001031618332490325
loss_pred:0.017412135377526283, decouple_loss:0.000999965937808156
loss_pred:0.01742461882531643, decouple_loss:0.0009688003337942064
WV_0_PC_1_EH_0_PS_40, loss: 0.017821017652750015, avg_mse: 0.025716420263051987
current test mse: 0.025716
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012003_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012003_3_24hr.npz
NaN value num: 0
Iteration: 2521, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4515415132045746, gen p mean: -0.03330518305301666, mean p set: 0.4520217776298523
loss_pred:0.01636027731001377, decouple_loss:0.0010086396941915154
The modified gen p mean: 0.45184245705604553, gen p mean: -0.03699454665184021, mean p set: 0.452322781085968The modified gen p mean: 0.45141056180000305, gen p mean: -0.033392537385225296, mean p set: 0.45189085602760315
loss_pred:0.017161184921860695, decouple_loss:0.0009647211991250515
loss_pred:0.016319207847118378, decouple_loss:0.0010233065113425255
Iteration: 2522, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4518498182296753, gen p mean: -0.03766672685742378, mean p set: 0.4523301124572754
loss_pred:0.016685694456100464, decouple_loss:0.0009586101514287293
The modified gen p mean: 0.4508257210254669, gen p mean: -0.035989392548799515, mean p set: 0.451306015253067The modified gen p mean: 0.45166027545928955, gen p mean: -0.03305426239967346, mean p set: 0.45214059948921204
loss_pred:0.017049714922904968, decouple_loss:0.0010150921298190951
loss_pred:0.01653451658785343, decouple_loss:0.0009708657744340599
Iteration: 2523, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45145028829574585, gen p mean: -0.0362718291580677, mean p set: 0.45193058252334595
loss_pred:0.015745222568511963, decouple_loss:0.0010467901593074203
The modified gen p mean: 0.45151811838150024, gen p mean: -0.03318053111433983, mean p set: 0.45199838280677795The modified gen p mean: 0.451695054769516, gen p mean: -0.03957054018974304, mean p set: 0.4521753489971161
loss_pred:0.016587339341640472, decouple_loss:0.0011521027190610766
loss_pred:0.016441412270069122, decouple_loss:0.0010337209096178412
Iteration: 2524, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513300359249115, gen p mean: -0.035680584609508514, mean p set: 0.4518103301525116
loss_pred:0.01559474878013134, decouple_loss:0.000978527357801795
The modified gen p mean: 0.4509037435054779, gen p mean: -0.03773563355207443, mean p set: 0.451384037733078The modified gen p mean: 0.45357754826545715, gen p mean: -0.036328140646219254, mean p set: 0.45405787229537964
loss_pred:0.015031234361231327, decouple_loss:0.0009974048007279634
loss_pred:0.01632840186357498, decouple_loss:0.0010088684502989054
Iteration: 2525, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4517439603805542, gen p mean: -0.04505317285656929, mean p set: 0.4522242546081543
loss_pred:0.015496334992349148, decouple_loss:0.0010304233292117715
The modified gen p mean: 0.4516414701938629, gen p mean: -0.04004012420773506, mean p set: 0.4521217942237854The modified gen p mean: 0.4509216845035553, gen p mean: -0.04103858023881912, mean p set: 0.4514019787311554
loss_pred:0.015450765378773212, decouple_loss:0.001003685756586492
loss_pred:0.016937002539634705, decouple_loss:0.0009390267659910023
Iteration: 2526, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4510509669780731, gen p mean: -0.0398084856569767, mean p set: 0.45153123140335083
loss_pred:0.015434554778039455, decouple_loss:0.0009312283946201205
The modified gen p mean: 0.45280569791793823, gen p mean: -0.03897196426987648, mean p set: 0.45328596234321594The modified gen p mean: 0.45199719071388245, gen p mean: -0.04475267231464386, mean p set: 0.45247751474380493
loss_pred:0.016909034922719002, decouple_loss:0.0010545150144025683
loss_pred:0.016639964655041695, decouple_loss:0.0010960226645693183
Iteration: 2527, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45289239287376404, gen p mean: -0.03756696358323097, mean p set: 0.45337265729904175
loss_pred:0.01591780222952366, decouple_loss:0.000897958583664149
The modified gen p mean: 0.44988471269607544, gen p mean: -0.03989782556891441, mean p set: 0.45036500692367554The modified gen p mean: 0.45133569836616516, gen p mean: -0.04283229261636734, mean p set: 0.45181599259376526
loss_pred:0.015205536037683487, decouple_loss:0.0009596358868293464
loss_pred:0.01581951603293419, decouple_loss:0.0009345184662379324
Iteration: 2528, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4519060552120209, gen p mean: -0.039496127516031265, mean p set: 0.4523863196372986
loss_pred:0.015426850877702236, decouple_loss:0.0008898600935935974
The modified gen p mean: 0.4517342448234558, gen p mean: -0.041618213057518005, mean p set: 0.4522145688533783The modified gen p mean: 0.4525472819805145, gen p mean: -0.035179805010557175, mean p set: 0.453027606010437
loss_pred:0.016577953472733498, decouple_loss:0.0009768098825588822
loss_pred:0.01572818122804165, decouple_loss:0.0009086093632504344
Iteration: 2529, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4522726237773895, gen p mean: -0.04037861153483391, mean p set: 0.452752947807312
loss_pred:0.016833174973726273, decouple_loss:0.001030653016641736
The modified gen p mean: 0.451555460691452, gen p mean: -0.03785347193479538, mean p set: 0.4520357549190521The modified gen p mean: 0.4516810476779938, gen p mean: -0.03622646629810333, mean p set: 0.45216134190559387
loss_pred:0.01609673723578453, decouple_loss:0.0009698535432107747
loss_pred:0.01646711304783821, decouple_loss:0.0010045458329841495
Iteration: 2530, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513266086578369, gen p mean: -0.03659163415431976, mean p set: 0.4518068730831146
loss_pred:0.016270829364657402, decouple_loss:0.000880784064065665
The modified gen p mean: 0.4524010121822357, gen p mean: -0.03545640781521797, mean p set: 0.4528812766075134The modified gen p mean: 0.4518781304359436, gen p mean: -0.04407922178506851, mean p set: 0.4523584544658661
loss_pred:0.01656048558652401, decouple_loss:0.0009200715576298535
loss_pred:0.01650204509496689, decouple_loss:0.000991706270724535
2023-05-02 12:09:31 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.05070061236619949, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04582304134964943, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04655047878623009, mean p set: 0.4500633478164673
loss_pred:0.01847769320011139, decouple_loss:0.0010246625170111656
loss_pred:0.017321446910500526, decouple_loss:0.0009872467489913106
loss_pred:0.0173948984593153, decouple_loss:0.0009696806664578617
WV_0_PC_1_EH_0_PS_40, loss: 0.01778103969991207, avg_mse: 0.02562442235648632
current test mse: 0.025624
Iteration: 2531, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4510337710380554, gen p mean: -0.041532374918460846, mean p set: 0.45151403546333313
The modified gen p mean: 0.4508942663669586, gen p mean: -0.0418551042675972, mean p set: 0.45137453079223633
The modified gen p mean: 0.45319274067878723, gen p mean: -0.04187767580151558, mean p set: 0.45367300510406494
loss_pred:0.017043091356754303, decouple_loss:0.0008447244763374329
loss_pred:0.015921544283628464, decouple_loss:0.0008811933221295476
loss_pred:0.01646505482494831, decouple_loss:0.0009193891892209649
Iteration: 2532, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45245373249053955, gen p mean: -0.04638657346367836, mean p set: 0.45293402671813965
loss_pred:0.016600610688328743, decouple_loss:0.0009300379315391183
The modified gen p mean: 0.4513852596282959, gen p mean: -0.04113338142633438, mean p set: 0.451865553855896The modified gen p mean: 0.45027273893356323, gen p mean: -0.039702385663986206, mean p set: 0.45075303316116333
loss_pred:0.01626543700695038, decouple_loss:0.0009242906817235053
loss_pred:0.01545893307775259, decouple_loss:0.0008980349521152675
Iteration: 2533, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45218443870544434, gen p mean: -0.04217856377363205, mean p set: 0.45266470313072205
loss_pred:0.016036512330174446, decouple_loss:0.000915682059712708
The modified gen p mean: 0.45141056180000305, gen p mean: -0.045544181019067764, mean p set: 0.45189085602760315The modified gen p mean: 0.4500175714492798, gen p mean: -0.044556863605976105, mean p set: 0.45049792528152466
loss_pred:0.015521315857768059, decouple_loss:0.0009177820757031441
loss_pred:0.015663819387555122, decouple_loss:0.0009882827289402485
Iteration: 2534, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45105841755867004, gen p mean: -0.04451184347271919, mean p set: 0.45153874158859253
loss_pred:0.015468187630176544, decouple_loss:0.0009110557148233056
The modified gen p mean: 0.45218974351882935, gen p mean: -0.045717861503362656, mean p set: 0.45267003774642944The modified gen p mean: 0.45250239968299866, gen p mean: -0.04236908257007599, mean p set: 0.45298269391059875
loss_pred:0.016458772122859955, decouple_loss:0.0009911780944094062
loss_pred:0.016285447403788567, decouple_loss:0.0009594589355401695
Iteration: 2535, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45007583498954773, gen p mean: -0.044235922396183014, mean p set: 0.45055609941482544
loss_pred:0.016792431473731995, decouple_loss:0.0008959166589193046
The modified gen p mean: 0.4495593011379242, gen p mean: -0.0423562191426754, mean p set: 0.4500395953655243The modified gen p mean: 0.4523261487483978, gen p mean: -0.04831637442111969, mean p set: 0.4528064429759979
loss_pred:0.015570934861898422, decouple_loss:0.0008986996253952384
loss_pred:0.015728026628494263, decouple_loss:0.0009036486153490841
Iteration: 2536, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45168137550354004, gen p mean: -0.04756094887852669, mean p set: 0.4521616995334625
loss_pred:0.016724305227398872, decouple_loss:0.0010431802365928888
The modified gen p mean: 0.44988885521888733, gen p mean: -0.040349461138248444, mean p set: 0.4503691494464874
The modified gen p mean: 0.45311492681503296, gen p mean: -0.042425546795129776, mean p set: 0.45359519124031067
loss_pred:0.015807220712304115, decouple_loss:0.0009419507114216685
loss_pred:0.01604168675839901, decouple_loss:0.0009416496613994241
Iteration: 2537, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502456486225128, gen p mean: -0.04475122690200806, mean p set: 0.4507259726524353
loss_pred:0.01584629900753498, decouple_loss:0.000939276535063982
The modified gen p mean: 0.450979620218277, gen p mean: -0.04500491917133331, mean p set: 0.4514599144458771The modified gen p mean: 0.45231249928474426, gen p mean: -0.03797432780265808, mean p set: 0.45279279351234436
loss_pred:0.016701040789484978, decouple_loss:0.0010253828950226307
loss_pred:0.016581812873482704, decouple_loss:0.0009494124678894877
Iteration: 2538, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4510553181171417, gen p mean: -0.04149528220295906, mean p set: 0.4515356123447418
loss_pred:0.01626872830092907, decouple_loss:0.0009189277770929039
The modified gen p mean: 0.45317938923835754, gen p mean: -0.038463279604911804, mean p set: 0.45365968346595764The modified gen p mean: 0.4524238407611847, gen p mean: -0.0401037372648716, mean p set: 0.4529041349887848
loss_pred:0.015904920175671577, decouple_loss:0.0008810855215415359
loss_pred:0.01566438376903534, decouple_loss:0.0008695341530255973
Iteration: 2539, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4512692093849182, gen p mean: -0.039899326860904694, mean p set: 0.4517495334148407
loss_pred:0.016142871230840683, decouple_loss:0.0009439111454412341
The modified gen p mean: 0.4512156546115875, gen p mean: -0.039703670889139175, mean p set: 0.4516959488391876The modified gen p mean: 0.4534507393836975, gen p mean: -0.03615117818117142, mean p set: 0.4539310038089752
loss_pred:0.01510341465473175, decouple_loss:0.0009122285409830511
loss_pred:0.016054484993219376, decouple_loss:0.0009640429634600878
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012018_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012018_3_24hr.npz
NaN value num: 0
Iteration: 2540, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44879257678985596, gen p mean: -0.045028891414403915, mean p set: 0.44927287101745605
loss_pred:0.014821120537817478, decouple_loss:0.0010826761135831475
The modified gen p mean: 0.4479435980319977, gen p mean: -0.04751777648925781, mean p set: 0.44842392206192017The modified gen p mean: 0.449035108089447, gen p mean: -0.04039978235960007, mean p set: 0.4495154023170471
loss_pred:0.014109265059232712, decouple_loss:0.0009682690724730492
loss_pred:0.014497054740786552, decouple_loss:0.0010329182259738445
2023-05-02 12:12:04 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.05043359845876694, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04603338986635208, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.04650186002254486, mean p set: 0.4500633478164673
loss_pred:0.01854604482650757, decouple_loss:0.0011590940412133932
loss_pred:0.01740304008126259, decouple_loss:0.0010558797512203455
loss_pred:0.017429403960704803, decouple_loss:0.001044781762175262
WV_0_PC_1_EH_0_PS_40, loss: 0.017847159877419472, avg_mse: 0.025742700323462486
current test mse: 0.025743
Iteration: 2541, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490033984184265, gen p mean: -0.04745723679661751, mean p set: 0.4494836926460266
The modified gen p mean: 0.4510590434074402, gen p mean: -0.039343152195215225, mean p set: 0.4515393376350403
The modified gen p mean: 0.44861990213394165, gen p mean: -0.04293335601687431, mean p set: 0.44910016655921936
loss_pred:0.014962210319936275, decouple_loss:0.001035811728797853
loss_pred:0.013663597404956818, decouple_loss:0.0011497235391288996loss_pred:0.014680095948278904, decouple_loss:0.001121258595958352
Iteration: 2542, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44802820682525635, gen p mean: -0.04930492118000984, mean p set: 0.44850850105285645
loss_pred:0.013923331163823605, decouple_loss:0.0011426258133724332
The modified gen p mean: 0.44823217391967773, gen p mean: -0.04926130920648575, mean p set: 0.44871246814727783The modified gen p mean: 0.4498286247253418, gen p mean: -0.043247904628515244, mean p set: 0.4503089487552643
loss_pred:0.013814238831400871, decouple_loss:0.0010923885274678469
loss_pred:0.014556669630110264, decouple_loss:0.0011276804143562913
Iteration: 2543, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44945028424263, gen p mean: -0.044557809829711914, mean p set: 0.4499305486679077
loss_pred:0.013791530393064022, decouple_loss:0.0009680945659056306
The modified gen p mean: 0.4485279321670532, gen p mean: -0.04863022267818451, mean p set: 0.4490082263946533The modified gen p mean: 0.4491003453731537, gen p mean: -0.044821079820394516, mean p set: 0.4495806396007538
loss_pred:0.014100061729550362, decouple_loss:0.0010275455424562097
loss_pred:0.013480959460139275, decouple_loss:0.0011675787391141057
Iteration: 2544, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45006632804870605, gen p mean: -0.038746993988752365, mean p set: 0.45054665207862854
loss_pred:0.014060154557228088, decouple_loss:0.0012338235974311829
The modified gen p mean: 0.4475609362125397, gen p mean: -0.050660841166973114, mean p set: 0.4480412006378174The modified gen p mean: 0.4483445882797241, gen p mean: -0.04508860781788826, mean p set: 0.4488248825073242
loss_pred:0.013947480358183384, decouple_loss:0.001254684873856604
loss_pred:0.014340355060994625, decouple_loss:0.0010938076302409172
Iteration: 2545, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44955405592918396, gen p mean: -0.0426214300096035, mean p set: 0.45003435015678406
loss_pred:0.01355819869786501, decouple_loss:0.001026655314490199
The modified gen p mean: 0.4486909806728363, gen p mean: -0.03934517875313759, mean p set: 0.4491713047027588The modified gen p mean: 0.4479655921459198, gen p mean: -0.04891962185502052, mean p set: 0.4484458863735199
loss_pred:0.014469968155026436, decouple_loss:0.0010562273673713207
loss_pred:0.013888555578887463, decouple_loss:0.0011157807894051075
Iteration: 2546, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478102922439575, gen p mean: -0.05015219748020172, mean p set: 0.44829061627388
loss_pred:0.013585476204752922, decouple_loss:0.0010512997396290302
The modified gen p mean: 0.4492962062358856, gen p mean: -0.04212591424584389, mean p set: 0.44977647066116333The modified gen p mean: 0.45011141896247864, gen p mean: -0.047062598168849945, mean p set: 0.45059165358543396
loss_pred:0.01387566328048706, decouple_loss:0.0010788703802973032
loss_pred:0.014118011109530926, decouple_loss:0.0010707199107855558
Iteration: 2547, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483950734138489, gen p mean: -0.043832652270793915, mean p set: 0.4488753378391266
loss_pred:0.014231260865926743, decouple_loss:0.0011141920695081353
The modified gen p mean: 0.44851455092430115, gen p mean: -0.04584318399429321, mean p set: 0.44899484515190125The modified gen p mean: 0.4484918415546417, gen p mean: -0.04428546503186226, mean p set: 0.44897210597991943
loss_pred:0.0142278503626585, decouple_loss:0.0011530561605468392
loss_pred:0.014728567562997341, decouple_loss:0.0011096590897068381
Iteration: 2548, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44943416118621826, gen p mean: -0.05177360773086548, mean p set: 0.44991445541381836
loss_pred:0.014044156298041344, decouple_loss:0.001025782898068428
The modified gen p mean: 0.44827431440353394, gen p mean: -0.05115359276533127, mean p set: 0.4487546384334564The modified gen p mean: 0.44875583052635193, gen p mean: -0.05072915554046631, mean p set: 0.449236124753952
loss_pred:0.014331528916954994, decouple_loss:0.0011321557685732841
loss_pred:0.013477734290063381, decouple_loss:0.0010362707544118166
Iteration: 2549, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488747715950012, gen p mean: -0.05010348930954933, mean p set: 0.4493550956249237
loss_pred:0.013849001377820969, decouple_loss:0.0011488862801343203
The modified gen p mean: 0.4500400722026825, gen p mean: -0.04391825199127197, mean p set: 0.450520396232605The modified gen p mean: 0.44956347346305847, gen p mean: -0.044191740453243256, mean p set: 0.45004376769065857
loss_pred:0.01370406337082386, decouple_loss:0.0011741060297936201
loss_pred:0.01327382680028677, decouple_loss:0.0010829161619767547
Iteration: 2550, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499236047267914, gen p mean: -0.04685935750603676, mean p set: 0.4504038989543915
loss_pred:0.013710158877074718, decouple_loss:0.0010558615904301405
The modified gen p mean: 0.44823339581489563, gen p mean: -0.04923887178301811, mean p set: 0.4487136900424957The modified gen p mean: 0.44800862669944763, gen p mean: -0.05085630342364311, mean p set: 0.44848892092704773
loss_pred:0.01433724444359541, decouple_loss:0.001101676607504487
loss_pred:0.014041857793927193, decouple_loss:0.0010710792848840356
2023-05-02 12:13:58 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.04924582317471504, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04469573497772217, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04516409710049629, mean p set: 0.4500633478164673
loss_pred:0.019194936379790306, decouple_loss:0.0011869200970977545
loss_pred:0.018101738765835762, decouple_loss:0.0011805425165221095
loss_pred:0.01812627911567688, decouple_loss:0.0011679051676765084
WV_0_PC_1_EH_0_PS_40, loss: 0.018533242866396904, avg_mse: 0.027073737233877182
current test mse: 0.027074
Iteration: 2551, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44786709547042847, gen p mean: -0.045684147626161575, mean p set: 0.44834738969802856
The modified gen p mean: 0.44916248321533203, gen p mean: -0.0403793640434742, mean p set: 0.44964277744293213
The modified gen p mean: 0.44851556420326233, gen p mean: -0.03919818252325058, mean p set: 0.4489958584308624
loss_pred:0.013946318998932838, decouple_loss:0.0010791518725454807
loss_pred:0.014337919652462006, decouple_loss:0.0010620401008054614loss_pred:0.01342257484793663, decouple_loss:0.0011013374896720052
Iteration: 2552, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480951428413391, gen p mean: -0.04446903616189957, mean p set: 0.4485754370689392
loss_pred:0.014157570898532867, decouple_loss:0.0010915495222434402
The modified gen p mean: 0.4490712583065033, gen p mean: -0.04506606608629227, mean p set: 0.4495515525341034The modified gen p mean: 0.4494500458240509, gen p mean: -0.04676708206534386, mean p set: 0.4499303698539734
loss_pred:0.013498853892087936, decouple_loss:0.001013130764476955
loss_pred:0.014347046613693237, decouple_loss:0.0010367310605943203
Iteration: 2553, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487936794757843, gen p mean: -0.03974303603172302, mean p set: 0.4492739737033844
loss_pred:0.013881822116672993, decouple_loss:0.001061318558640778
The modified gen p mean: 0.44784530997276306, gen p mean: -0.04937224090099335, mean p set: 0.44832560420036316The modified gen p mean: 0.44982975721359253, gen p mean: -0.04129805415868759, mean p set: 0.450310081243515
loss_pred:0.014114145189523697, decouple_loss:0.0011219277512282133
loss_pred:0.013221126049757004, decouple_loss:0.0011770998826250434
Iteration: 2554, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492394030094147, gen p mean: -0.04150640219449997, mean p set: 0.44971972703933716
loss_pred:0.013740278780460358, decouple_loss:0.001042195945046842
The modified gen p mean: 0.44890040159225464, gen p mean: -0.04075891152024269, mean p set: 0.4493807256221771The modified gen p mean: 0.4479248821735382, gen p mean: -0.03962349146604538, mean p set: 0.4484051764011383
loss_pred:0.013750044628977776, decouple_loss:0.0010284042218700051
loss_pred:0.013843337073922157, decouple_loss:0.000983693520538509
Iteration: 2555, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44862130284309387, gen p mean: -0.04472729191184044, mean p set: 0.44910159707069397
loss_pred:0.013757742941379547, decouple_loss:0.0010858563473448157
The modified gen p mean: 0.4490126073360443, gen p mean: -0.04016287624835968, mean p set: 0.4494929015636444The modified gen p mean: 0.4490082561969757, gen p mean: -0.04282895848155022, mean p set: 0.4494885504245758
loss_pred:0.014469706453382969, decouple_loss:0.0010273983934894204
loss_pred:0.01392573956400156, decouple_loss:0.0010472764261066914
Iteration: 2556, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44937968254089355, gen p mean: -0.040577974170446396, mean p set: 0.44986000657081604
loss_pred:0.013607010245323181, decouple_loss:0.0011350151617079973
The modified gen p mean: 0.44885823130607605, gen p mean: -0.04665461927652359, mean p set: 0.44933852553367615The modified gen p mean: 0.44853314757347107, gen p mean: -0.04295075684785843, mean p set: 0.44901344180107117
loss_pred:0.013929148204624653, decouple_loss:0.0010248402832075953
loss_pred:0.013117934577167034, decouple_loss:0.0011904174461960793
Iteration: 2557, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44948524236679077, gen p mean: -0.04239009693264961, mean p set: 0.44996556639671326
loss_pred:0.013540235348045826, decouple_loss:0.0010391102405264974
The modified gen p mean: 0.4506920874118805, gen p mean: -0.039636675268411636, mean p set: 0.451172411441803The modified gen p mean: 0.4496171176433563, gen p mean: -0.04579794406890869, mean p set: 0.4500974118709564
loss_pred:0.013781954534351826, decouple_loss:0.0010539271170273423
loss_pred:0.013505133800208569, decouple_loss:0.0009987916564568877
Iteration: 2558, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478776156902313, gen p mean: -0.04919624701142311, mean p set: 0.4483579099178314
loss_pred:0.012997115962207317, decouple_loss:0.0010813954286277294
The modified gen p mean: 0.449535071849823, gen p mean: -0.04198073223233223, mean p set: 0.4500153958797455The modified gen p mean: 0.4493091106414795, gen p mean: -0.0456782691180706, mean p set: 0.4497894048690796
loss_pred:0.01322608720511198, decouple_loss:0.0010516573674976826
loss_pred:0.013287375681102276, decouple_loss:0.0010990200098603964
Iteration: 2559, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492180645465851, gen p mean: -0.04913356900215149, mean p set: 0.4496983587741852
loss_pred:0.014021513983607292, decouple_loss:0.0010914348531514406
The modified gen p mean: 0.44893208146095276, gen p mean: -0.04603362828493118, mean p set: 0.44941237568855286The modified gen p mean: 0.4492822587490082, gen p mean: -0.04784945026040077, mean p set: 0.4497624933719635
loss_pred:0.013903767801821232, decouple_loss:0.0010470302077010274
loss_pred:0.013918796554207802, decouple_loss:0.0010059423511847854
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012013_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012013_3_24hr.npz
NaN value num: 0
Iteration: 2560, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44629597663879395, gen p mean: -0.052468594163656235, mean p set: 0.44677630066871643
loss_pred:0.013690418563783169, decouple_loss:0.0010998673969879746
The modified gen p mean: 0.44877997040748596, gen p mean: -0.05200067162513733, mean p set: 0.44926023483276367The modified gen p mean: 0.44784659147262573, gen p mean: -0.04822295531630516, mean p set: 0.44832685589790344
loss_pred:0.013330431655049324, decouple_loss:0.0010591158643364906
loss_pred:0.013052934780716896, decouple_loss:0.0011141886934638023
2023-05-02 12:16:34 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.05239521712064743, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04794333875179291, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04831670969724655, mean p set: 0.4500633478164673
loss_pred:0.01899275928735733, decouple_loss:0.0010686008026823401
loss_pred:0.017886478453874588, decouple_loss:0.001046407618559897
loss_pred:0.017911573871970177, decouple_loss:0.0010411415714770555
WV_0_PC_1_EH_0_PS_40, loss: 0.018316207453608513, avg_mse: 0.02670733816921711
current test mse: 0.026707
Iteration: 2561, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472711682319641, gen p mean: -0.05013657361268997, mean p set: 0.4477514624595642
The modified gen p mean: 0.4480850100517273, gen p mean: -0.045829884707927704, mean p set: 0.4485653042793274
The modified gen p mean: 0.4462844133377075, gen p mean: -0.0464770682156086, mean p set: 0.44676467776298523
loss_pred:0.013124076649546623, decouple_loss:0.0009612888679839671
loss_pred:0.0127713019028306, decouple_loss:0.0010173780610784888
loss_pred:0.012983203865587711, decouple_loss:0.0010241999989375472
Iteration: 2562, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474093019962311, gen p mean: -0.046089768409729004, mean p set: 0.4478895962238312
loss_pred:0.012812364846467972, decouple_loss:0.0009741713874973357
The modified gen p mean: 0.4474468231201172, gen p mean: -0.04808993265032768, mean p set: 0.4479270875453949The modified gen p mean: 0.44627130031585693, gen p mean: -0.046546243131160736, mean p set: 0.44675159454345703
loss_pred:0.01368412934243679, decouple_loss:0.0010487101972103119
loss_pred:0.012836768291890621, decouple_loss:0.0009875540854409337
Iteration: 2563, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472111463546753, gen p mean: -0.0521390438079834, mean p set: 0.4476914703845978
loss_pred:0.013342059217393398, decouple_loss:0.0010665019508451223
The modified gen p mean: 0.44724029302597046, gen p mean: -0.051919084042310715, mean p set: 0.44772061705589294The modified gen p mean: 0.4483893811702728, gen p mean: -0.04609580710530281, mean p set: 0.4488696753978729
loss_pred:0.01318707037717104, decouple_loss:0.001053289626725018
loss_pred:0.013192751444876194, decouple_loss:0.000947028340306133
Iteration: 2564, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481906294822693, gen p mean: -0.0456828810274601, mean p set: 0.4486709535121918
loss_pred:0.012884082272648811, decouple_loss:0.0009905952028930187
The modified gen p mean: 0.4465150237083435, gen p mean: -0.04912542179226875, mean p set: 0.4469953179359436The modified gen p mean: 0.44788146018981934, gen p mean: -0.054997172206640244, mean p set: 0.44836175441741943
loss_pred:0.013100022450089455, decouple_loss:0.001060444861650467
loss_pred:0.01321039441972971, decouple_loss:0.0010522507363930345
Iteration: 2565, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44889259338378906, gen p mean: -0.044757649302482605, mean p set: 0.44937291741371155
loss_pred:0.01323821023106575, decouple_loss:0.0009502931497991085
The modified gen p mean: 0.4482991695404053, gen p mean: -0.0453486442565918, mean p set: 0.44877946376800537The modified gen p mean: 0.4469221234321594, gen p mean: -0.049579355865716934, mean p set: 0.4474024176597595
loss_pred:0.01278943195939064, decouple_loss:0.0009561484912410378
loss_pred:0.013095928356051445, decouple_loss:0.001014874316751957
Iteration: 2566, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44876283407211304, gen p mean: -0.04114989936351776, mean p set: 0.44924309849739075
loss_pred:0.013554167933762074, decouple_loss:0.001078386907465756
The modified gen p mean: 0.448162704706192, gen p mean: -0.0418921560049057, mean p set: 0.4486429989337921The modified gen p mean: 0.4487041234970093, gen p mean: -0.04759543389081955, mean p set: 0.449184387922287
loss_pred:0.01333659514784813, decouple_loss:0.0011204761685803533
loss_pred:0.01313086412847042, decouple_loss:0.0009539294405840337
Iteration: 2567, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489162862300873, gen p mean: -0.04571099951863289, mean p set: 0.4493965804576874
loss_pred:0.012896045111119747, decouple_loss:0.0010404514614492655
The modified gen p mean: 0.4477559030056, gen p mean: -0.05263407155871391, mean p set: 0.4482361972332001The modified gen p mean: 0.446719229221344, gen p mean: -0.05300720036029816, mean p set: 0.4471994936466217
loss_pred:0.012918036431074142, decouple_loss:0.0010264359880238771
loss_pred:0.013335037976503372, decouple_loss:0.0010831623803824186
Iteration: 2568, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44691380858421326, gen p mean: -0.04680516570806503, mean p set: 0.44739410281181335
loss_pred:0.013524523936212063, decouple_loss:0.000990737578831613
The modified gen p mean: 0.4479925334453583, gen p mean: -0.04627309739589691, mean p set: 0.44847285747528076The modified gen p mean: 0.44799885153770447, gen p mean: -0.05270402878522873, mean p set: 0.4484791159629822
loss_pred:0.01319167111068964, decouple_loss:0.0009430149802938104
loss_pred:0.01307997852563858, decouple_loss:0.0010409018723294139
Iteration: 2569, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479955732822418, gen p mean: -0.05356462299823761, mean p set: 0.4484758675098419
loss_pred:0.013035505078732967, decouple_loss:0.0009286528802476823
The modified gen p mean: 0.4481365978717804, gen p mean: -0.05123709514737129, mean p set: 0.4486168920993805The modified gen p mean: 0.44681644439697266, gen p mean: -0.052063025534152985, mean p set: 0.44729676842689514
loss_pred:0.013079925440251827, decouple_loss:0.0009814869845286012
loss_pred:0.0130014568567276, decouple_loss:0.0009753950871527195
Iteration: 2570, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44717198610305786, gen p mean: -0.04930538684129715, mean p set: 0.44765228033065796
loss_pred:0.013009615242481232, decouple_loss:0.0010509962448850274
The modified gen p mean: 0.44779109954833984, gen p mean: -0.05238610506057739, mean p set: 0.44827136397361755The modified gen p mean: 0.4485373795032501, gen p mean: -0.04553947225213051, mean p set: 0.4490176737308502
loss_pred:0.012847436591982841, decouple_loss:0.0009796286467462778
loss_pred:0.013117765076458454, decouple_loss:0.0009528719238005579
2023-05-02 12:18:29 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.050854213535785675, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04696650430560112, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04646266624331474, mean p set: 0.45035696029663086
loss_pred:0.01910092867910862, decouple_loss:0.0010428372770547867
loss_pred:0.01805875450372696, decouple_loss:0.0010004640789702535
loss_pred:0.01803465187549591, decouple_loss:0.0010132549796253443
WV_0_PC_1_EH_0_PS_40, loss: 0.018449053168296814, avg_mse: 0.02698972076177597
current test mse: 0.02699
Iteration: 2571, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470864534378052, gen p mean: -0.05320533737540245, mean p set: 0.44756677746772766
The modified gen p mean: 0.44763094186782837, gen p mean: -0.04612889513373375, mean p set: 0.4481112062931061
The modified gen p mean: 0.4468412697315216, gen p mean: -0.05232890322804451, mean p set: 0.4473215639591217
loss_pred:0.013060860335826874, decouple_loss:0.001041324925608933
loss_pred:0.013417708687484264, decouple_loss:0.0009653334855102003
loss_pred:0.013040656223893166, decouple_loss:0.001006802311167121
Iteration: 2572, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470463991165161, gen p mean: -0.04627470299601555, mean p set: 0.4475267231464386
loss_pred:0.013194731436669827, decouple_loss:0.0009322401019744575
The modified gen p mean: 0.4473222494125366, gen p mean: -0.05213499441742897, mean p set: 0.4478025436401367The modified gen p mean: 0.4466283321380615, gen p mean: -0.043688613921403885, mean p set: 0.447108656167984
loss_pred:0.012835565023124218, decouple_loss:0.0008834049804136157
loss_pred:0.01273149624466896, decouple_loss:0.0010247392347082496
Iteration: 2573, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44752824306488037, gen p mean: -0.04786200076341629, mean p set: 0.44800853729248047
loss_pred:0.012902254238724709, decouple_loss:0.0011084758443757892
The modified gen p mean: 0.44750797748565674, gen p mean: -0.044587641954422, mean p set: 0.44798827171325684The modified gen p mean: 0.4467009902000427, gen p mean: -0.0440763384103775, mean p set: 0.4471812844276428
loss_pred:0.012593152932822704, decouple_loss:0.0010609630262479186
loss_pred:0.013036763295531273, decouple_loss:0.001063198084011674
Iteration: 2574, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44692468643188477, gen p mean: -0.04607845097780228, mean p set: 0.4474049210548401
loss_pred:0.012961914762854576, decouple_loss:0.0009382807766087353
The modified gen p mean: 0.44742703437805176, gen p mean: -0.05048104748129845, mean p set: 0.44790735840797424The modified gen p mean: 0.4465497136116028, gen p mean: -0.04647642746567726, mean p set: 0.4470299780368805
loss_pred:0.012820785865187645, decouple_loss:0.0009806107264012098
loss_pred:0.01330172922462225, decouple_loss:0.0010174784110859036
Iteration: 2575, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480471909046173, gen p mean: -0.04963670298457146, mean p set: 0.4485274851322174
loss_pred:0.013098932802677155, decouple_loss:0.0009954292327165604
The modified gen p mean: 0.4470941126346588, gen p mean: -0.044973939657211304, mean p set: 0.4475743770599365The modified gen p mean: 0.44711393117904663, gen p mean: -0.05174856260418892, mean p set: 0.44759422540664673
loss_pred:0.013382251374423504, decouple_loss:0.000986499828286469
loss_pred:0.01258124504238367, decouple_loss:0.0010038599139079452
Iteration: 2576, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44776859879493713, gen p mean: -0.05123575031757355, mean p set: 0.44824886322021484
loss_pred:0.012834110297262669, decouple_loss:0.0009555552387610078
The modified gen p mean: 0.4473112225532532, gen p mean: -0.04695616289973259, mean p set: 0.44779151678085327The modified gen p mean: 0.4478999078273773, gen p mean: -0.04083564132452011, mean p set: 0.4483802020549774
loss_pred:0.013072985224425793, decouple_loss:0.001103137037716806
loss_pred:0.013017261400818825, decouple_loss:0.000995563343167305
Iteration: 2577, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44677913188934326, gen p mean: -0.05162785202264786, mean p set: 0.44725939631462097
loss_pred:0.012982933782041073, decouple_loss:0.0009771749610081315
The modified gen p mean: 0.44725826382637024, gen p mean: -0.05258752405643463, mean p set: 0.4477385878562927The modified gen p mean: 0.44708892703056335, gen p mean: -0.04572591185569763, mean p set: 0.44756919145584106
loss_pred:0.012842176482081413, decouple_loss:0.001015152083709836
loss_pred:0.013429258950054646, decouple_loss:0.0010023129871115088
Iteration: 2578, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44652217626571655, gen p mean: -0.05238230526447296, mean p set: 0.44700247049331665
loss_pred:0.01306266337633133, decouple_loss:0.0010180834215134382
The modified gen p mean: 0.447466641664505, gen p mean: -0.04995249584317207, mean p set: 0.4479469656944275The modified gen p mean: 0.44745805859565735, gen p mean: -0.053541723638772964, mean p set: 0.44793838262557983
loss_pred:0.012693936005234718, decouple_loss:0.0010527002159506083
loss_pred:0.012983320280909538, decouple_loss:0.0010398684535175562
Iteration: 2579, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478975832462311, gen p mean: -0.043283723294734955, mean p set: 0.4483778774738312
loss_pred:0.013066030107438564, decouple_loss:0.0010012055281549692
The modified gen p mean: 0.448482483625412, gen p mean: -0.050388287752866745, mean p set: 0.4489628076553345The modified gen p mean: 0.44747141003608704, gen p mean: -0.052614569664001465, mean p set: 0.44795170426368713
loss_pred:0.013012997806072235, decouple_loss:0.0010948614217340946
loss_pred:0.01305544562637806, decouple_loss:0.00123029004316777
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012017_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012017_3_24hr.npz
NaN value num: 0
Iteration: 2580, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481185972690582, gen p mean: -0.047171831130981445, mean p set: 0.4485989212989807
loss_pred:0.013921179808676243, decouple_loss:0.0010253165382891893
The modified gen p mean: 0.44759809970855713, gen p mean: -0.05056733265519142, mean p set: 0.4480784237384796The modified gen p mean: 0.448137491941452, gen p mean: -0.04843796044588089, mean p set: 0.4486178159713745
loss_pred:0.013499592430889606, decouple_loss:0.0009515511337667704
loss_pred:0.013235008344054222, decouple_loss:0.001011525746434927
2023-05-02 12:21:02 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.049905601888895035, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04563731700181961, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.0460817813873291, mean p set: 0.4500633478164673
loss_pred:0.019063053652644157, decouple_loss:0.001127198920585215
loss_pred:0.017924776300787926, decouple_loss:0.0011643916368484497
loss_pred:0.017945265397429466, decouple_loss:0.0011672491673380136
WV_0_PC_1_EH_0_PS_40, loss: 0.018368680030107498, avg_mse: 0.026829231530427933
current test mse: 0.026829
Iteration: 2581, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480818510055542, gen p mean: -0.03770160675048828, mean p set: 0.4485621154308319
The modified gen p mean: 0.4488871693611145, gen p mean: -0.0440019927918911, mean p set: 0.4493674635887146
The modified gen p mean: 0.44853323698043823, gen p mean: -0.04884688928723335, mean p set: 0.44901350140571594
loss_pred:0.012890227138996124, decouple_loss:0.0011048525338992476
loss_pred:0.013328863307833672, decouple_loss:0.0010335857514292002
loss_pred:0.01354924589395523, decouple_loss:0.0011470356257632375
Iteration: 2582, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44682610034942627, gen p mean: -0.04749346524477005, mean p set: 0.44730639457702637
loss_pred:0.013246732763946056, decouple_loss:0.0011118958937004209
The modified gen p mean: 0.4494132995605469, gen p mean: -0.04679711163043976, mean p set: 0.449893593788147The modified gen p mean: 0.44900357723236084, gen p mean: -0.046521298587322235, mean p set: 0.44948384165763855
loss_pred:0.013345614075660706, decouple_loss:0.0009160676272585988
loss_pred:0.013547474518418312, decouple_loss:0.0009668529382906854
Iteration: 2583, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44714075326919556, gen p mean: -0.04488133266568184, mean p set: 0.44762104749679565
loss_pred:0.013419374823570251, decouple_loss:0.0010763220489025116
The modified gen p mean: 0.4484682083129883, gen p mean: -0.044751349836587906, mean p set: 0.448948472738266The modified gen p mean: 0.44853904843330383, gen p mean: -0.04414626583456993, mean p set: 0.44901934266090393
loss_pred:0.013334968127310276, decouple_loss:0.0011426089331507683
loss_pred:0.013218682259321213, decouple_loss:0.0010352045064792037
Iteration: 2584, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44788235425949097, gen p mean: -0.04600958898663521, mean p set: 0.44836267828941345
loss_pred:0.01347420271486044, decouple_loss:0.0010344067122787237
The modified gen p mean: 0.4479621648788452, gen p mean: -0.046464432030916214, mean p set: 0.4484424889087677The modified gen p mean: 0.4478338658809662, gen p mean: -0.04458235949277878, mean p set: 0.4483141601085663
loss_pred:0.013354846276342869, decouple_loss:0.0010430323891341686
loss_pred:0.013327190652489662, decouple_loss:0.0009920895099639893
Iteration: 2585, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475306272506714, gen p mean: -0.04237385094165802, mean p set: 0.44801095128059387
loss_pred:0.013214495964348316, decouple_loss:0.001003954210318625
The modified gen p mean: 0.44762134552001953, gen p mean: -0.0459345318377018, mean p set: 0.44810163974761963The modified gen p mean: 0.4487735331058502, gen p mean: -0.04374774172902107, mean p set: 0.4492538273334503
loss_pred:0.013144314289093018, decouple_loss:0.0010304272873327136
loss_pred:0.013054653070867062, decouple_loss:0.0009816527599468827
Iteration: 2586, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44756239652633667, gen p mean: -0.033127229660749435, mean p set: 0.44804272055625916
loss_pred:0.01312735490500927, decouple_loss:0.0010024849325418472
The modified gen p mean: 0.4483799636363983, gen p mean: -0.04354822635650635, mean p set: 0.4488602578639984The modified gen p mean: 0.4493180811405182, gen p mean: -0.04656537249684334, mean p set: 0.4497983753681183
loss_pred:0.012957231141626835, decouple_loss:0.000987905659712851
loss_pred:0.013184367679059505, decouple_loss:0.001120164874009788
Iteration: 2587, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477007985115051, gen p mean: -0.042905718088150024, mean p set: 0.4481810927391052
loss_pred:0.013923510909080505, decouple_loss:0.0009401027928106487
The modified gen p mean: 0.44839510321617126, gen p mean: -0.04582275077700615, mean p set: 0.44887539744377136The modified gen p mean: 0.4487558901309967, gen p mean: -0.03741626441478729, mean p set: 0.4492361843585968
loss_pred:0.012696593068540096, decouple_loss:0.0009952704422175884
loss_pred:0.01278756558895111, decouple_loss:0.0009530014358460903
Iteration: 2588, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488367736339569, gen p mean: -0.044389527291059494, mean p set: 0.449317067861557
loss_pred:0.012617483735084534, decouple_loss:0.0010739736026152968
The modified gen p mean: 0.4486768841743469, gen p mean: -0.03646921366453171, mean p set: 0.4491572082042694The modified gen p mean: 0.4492904543876648, gen p mean: -0.04679238051176071, mean p set: 0.4497707486152649
loss_pred:0.012884000316262245, decouple_loss:0.0010115181794390082
loss_pred:0.013121516443789005, decouple_loss:0.0010324870236217976
Iteration: 2589, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44799745082855225, gen p mean: -0.048289764672517776, mean p set: 0.44847777485847473
loss_pred:0.013665481470525265, decouple_loss:0.0009045185288414359
The modified gen p mean: 0.44836118817329407, gen p mean: -0.042609695345163345, mean p set: 0.44884148240089417The modified gen p mean: 0.4494490623474121, gen p mean: -0.04459826275706291, mean p set: 0.4499293565750122
loss_pred:0.01276225782930851, decouple_loss:0.0008477757219225168
loss_pred:0.013540261425077915, decouple_loss:0.0009585755178704858
Iteration: 2590, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471893906593323, gen p mean: -0.046508174389600754, mean p set: 0.44766971468925476
loss_pred:0.013641715981066227, decouple_loss:0.000969703309237957
The modified gen p mean: 0.44725847244262695, gen p mean: -0.044813372194767, mean p set: 0.44773876667022705The modified gen p mean: 0.4480086863040924, gen p mean: -0.04693157970905304, mean p set: 0.4484889805316925
loss_pred:0.013211442157626152, decouple_loss:0.000996516435407102
loss_pred:0.013270875439047813, decouple_loss:0.0009695430635474622
2023-05-02 12:22:56 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.047375064343214035, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04351718723773956, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.04380013421177864, mean p set: 0.4500633478164673
loss_pred:0.01918679103255272, decouple_loss:0.0010406712535768747
loss_pred:0.018010897561907768, decouple_loss:0.0010589460143819451
loss_pred:0.018052250146865845, decouple_loss:0.0010405128123238683
WV_0_PC_1_EH_0_PS_40, loss: 0.018468981608748436, avg_mse: 0.027039814740419388
current test mse: 0.02704
Iteration: 2591, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44788190722465515, gen p mean: -0.04761526733636856, mean p set: 0.44836223125457764
The modified gen p mean: 0.44753149151802063, gen p mean: -0.04702303558588028, mean p set: 0.4480117857456207
The modified gen p mean: 0.44984617829322815, gen p mean: -0.04156051576137543, mean p set: 0.45032650232315063
loss_pred:0.01309165172278881, decouple_loss:0.0008745373343117535
loss_pred:0.013338999822735786, decouple_loss:0.0009222346707247198
loss_pred:0.01309650857001543, decouple_loss:0.0009796484373509884
Iteration: 2592, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489333927631378, gen p mean: -0.0434647873044014, mean p set: 0.4494136571884155
loss_pred:0.01246755849570036, decouple_loss:0.001141504617407918
The modified gen p mean: 0.4472012519836426, gen p mean: -0.04559728875756264, mean p set: 0.44768157601356506The modified gen p mean: 0.44864314794540405, gen p mean: -0.04516774043440819, mean p set: 0.44912344217300415
loss_pred:0.012119621969759464, decouple_loss:0.0010997424833476543
loss_pred:0.013084463775157928, decouple_loss:0.0010562288807705045
Iteration: 2593, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44838017225265503, gen p mean: -0.036472760140895844, mean p set: 0.4488604962825775
loss_pred:0.012784850783646107, decouple_loss:0.0009012590744532645
The modified gen p mean: 0.44861671328544617, gen p mean: -0.04275473952293396, mean p set: 0.44909700751304626The modified gen p mean: 0.44893890619277954, gen p mean: -0.04536964371800423, mean p set: 0.44941920042037964
loss_pred:0.012798473238945007, decouple_loss:0.0009567196830175817
loss_pred:0.013536009006202221, decouple_loss:0.0010147433495149016
Iteration: 2594, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482285976409912, gen p mean: -0.03925466537475586, mean p set: 0.4487088918685913
loss_pred:0.012736162170767784, decouple_loss:0.001041027600876987
The modified gen p mean: 0.4497976005077362, gen p mean: -0.042278360575437546, mean p set: 0.4502778649330139The modified gen p mean: 0.4495008885860443, gen p mean: -0.04491628333926201, mean p set: 0.4499812126159668
loss_pred:0.013615082018077374, decouple_loss:0.001041471492499113
loss_pred:0.012661509215831757, decouple_loss:0.001159502426162362
Iteration: 2595, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486500322818756, gen p mean: -0.04108288884162903, mean p set: 0.4491303265094757
loss_pred:0.012681565247476101, decouple_loss:0.0010247926693409681
The modified gen p mean: 0.44822725653648376, gen p mean: -0.03169466555118561, mean p set: 0.44870755076408386The modified gen p mean: 0.4492121636867523, gen p mean: -0.04110797122120857, mean p set: 0.4496924579143524
loss_pred:0.012759659439325333, decouple_loss:0.0008978875121101737
loss_pred:0.012834146618843079, decouple_loss:0.0010619662934914231
Iteration: 2596, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490025043487549, gen p mean: -0.037260111421346664, mean p set: 0.449482798576355
loss_pred:0.013435197062790394, decouple_loss:0.0009782761335372925
The modified gen p mean: 0.44869518280029297, gen p mean: -0.041905440390110016, mean p set: 0.44917547702789307The modified gen p mean: 0.44782891869544983, gen p mean: -0.0442298948764801, mean p set: 0.4483092129230499
loss_pred:0.013308909721672535, decouple_loss:0.0009886372135952115
loss_pred:0.012867522425949574, decouple_loss:0.0010091672884300351
Iteration: 2597, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44741275906562805, gen p mean: -0.042597707360982895, mean p set: 0.44789305329322815
loss_pred:0.013676540926098824, decouple_loss:0.0011010350426658988
The modified gen p mean: 0.44885721802711487, gen p mean: -0.03731432929635048, mean p set: 0.44933751225471497The modified gen p mean: 0.44782161712646484, gen p mean: -0.044778972864151, mean p set: 0.44830194115638733
loss_pred:0.012887661345303059, decouple_loss:0.0009818845428526402
loss_pred:0.013396892696619034, decouple_loss:0.0009811143390834332
Iteration: 2598, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44960033893585205, gen p mean: -0.03854004666209221, mean p set: 0.45008060336112976
loss_pred:0.013132908381521702, decouple_loss:0.0009589440887793899
The modified gen p mean: 0.44885775446891785, gen p mean: -0.04711679369211197, mean p set: 0.44933804869651794The modified gen p mean: 0.4494127631187439, gen p mean: -0.043771617114543915, mean p set: 0.449893057346344
loss_pred:0.01232441607862711, decouple_loss:0.0011177395936101675
loss_pred:0.0130043039098382, decouple_loss:0.0010014059953391552
Iteration: 2599, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476511776447296, gen p mean: -0.04761515185236931, mean p set: 0.4481314718723297
loss_pred:0.013538715429604053, decouple_loss:0.0010562101379036903
The modified gen p mean: 0.4472748041152954, gen p mean: -0.049002837389707565, mean p set: 0.4477550983428955The modified gen p mean: 0.448723167181015, gen p mean: -0.04524265229701996, mean p set: 0.4492034912109375
loss_pred:0.013233852572739124, decouple_loss:0.0010433288989588618
loss_pred:0.013164578005671501, decouple_loss:0.0009912344394251704
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012002_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012002_3_24hr.npz
NaN value num: 0
Iteration: 2600, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45104700326919556, gen p mean: -0.041857052594423294, mean p set: 0.45152729749679565
loss_pred:0.015483989380300045, decouple_loss:0.0009844526648521423
The modified gen p mean: 0.4504455626010895, gen p mean: -0.04132594168186188, mean p set: 0.4509258568286896The modified gen p mean: 0.44978219270706177, gen p mean: -0.04638411104679108, mean p set: 0.45026248693466187
loss_pred:0.015519190579652786, decouple_loss:0.0010923916706815362
loss_pred:0.015877602621912956, decouple_loss:0.0009615608141757548
2023-05-02 12:25:29 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.04712092876434326, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04321207106113434, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.04356840252876282, mean p set: 0.4500633478164673
loss_pred:0.018951689824461937, decouple_loss:0.001049219281412661
loss_pred:0.017815932631492615, decouple_loss:0.0011272488627582788
loss_pred:0.017857816070318222, decouple_loss:0.0010321197332814336
WV_0_PC_1_EH_0_PS_40, loss: 0.01826195791363716, avg_mse: 0.02662532404065132
current test mse: 0.026625
Iteration: 2601, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485863745212555, gen p mean: -0.046756260097026825, mean p set: 0.4490666687488556
The modified gen p mean: 0.44893309473991394, gen p mean: -0.04861084744334221, mean p set: 0.44941338896751404
The modified gen p mean: 0.4490024149417877, gen p mean: -0.04507003724575043, mean p set: 0.4494827091693878
loss_pred:0.015618016012012959, decouple_loss:0.001049183076247573
loss_pred:0.014982540160417557, decouple_loss:0.0009806327288970351
loss_pred:0.015003006905317307, decouple_loss:0.0012039711000397801
Iteration: 2602, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477841854095459, gen p mean: -0.035998083651065826, mean p set: 0.4482645094394684
loss_pred:0.01611696556210518, decouple_loss:0.0011109685292467475
The modified gen p mean: 0.4490276575088501, gen p mean: -0.042413026094436646, mean p set: 0.4495079815387726The modified gen p mean: 0.4500461518764496, gen p mean: -0.036325469613075256, mean p set: 0.4505264163017273
loss_pred:0.015246737748384476, decouple_loss:0.0010627772426232696
loss_pred:0.014595682732760906, decouple_loss:0.0009980467148125172
Iteration: 2603, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44928374886512756, gen p mean: -0.036974869668483734, mean p set: 0.44976404309272766
loss_pred:0.015516127459704876, decouple_loss:0.001081363414414227
The modified gen p mean: 0.45181918144226074, gen p mean: -0.0330696627497673, mean p set: 0.4522995054721832
The modified gen p mean: 0.4524897634983063, gen p mean: -0.035523466765880585, mean p set: 0.45297008752822876
loss_pred:0.014999523758888245, decouple_loss:0.0011640297016128898
loss_pred:0.01455753855407238, decouple_loss:0.0011173392413184047
Iteration: 2604, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448527067899704, gen p mean: -0.03541223332285881, mean p set: 0.44900739192962646
loss_pred:0.015634307637810707, decouple_loss:0.0010529292048886418
The modified gen p mean: 0.45141148567199707, gen p mean: -0.033749859780073166, mean p set: 0.4518917500972748The modified gen p mean: 0.45283541083335876, gen p mean: -0.02989170141518116, mean p set: 0.4533156752586365
loss_pred:0.014688299037516117, decouple_loss:0.00102392234839499
loss_pred:0.015590021386742592, decouple_loss:0.001062354538589716
Iteration: 2605, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505431652069092, gen p mean: -0.03966687247157097, mean p set: 0.4510234594345093
loss_pred:0.015580205246806145, decouple_loss:0.001144557842053473
The modified gen p mean: 0.45140236616134644, gen p mean: -0.03752675652503967, mean p set: 0.4518826901912689The modified gen p mean: 0.45092499256134033, gen p mean: -0.03522481769323349, mean p set: 0.45140528678894043
loss_pred:0.014685699716210365, decouple_loss:0.0010959389619529247
loss_pred:0.015429221093654633, decouple_loss:0.001077304594218731
Iteration: 2606, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478793740272522, gen p mean: -0.031137866899371147, mean p set: 0.4483596682548523
loss_pred:0.016304560005664825, decouple_loss:0.0011268781963735819
The modified gen p mean: 0.4497659504413605, gen p mean: -0.03952537104487419, mean p set: 0.45024624466896057The modified gen p mean: 0.44910693168640137, gen p mean: -0.03611214831471443, mean p set: 0.44958722591400146
loss_pred:0.0154807660728693, decouple_loss:0.001076781889423728
loss_pred:0.015000215731561184, decouple_loss:0.0012439035344868898
Iteration: 2607, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44863754510879517, gen p mean: -0.038283757865428925, mean p set: 0.44911783933639526
loss_pred:0.015153367072343826, decouple_loss:0.0012088078074157238
The modified gen p mean: 0.4490102529525757, gen p mean: -0.04431718960404396, mean p set: 0.4494905471801758The modified gen p mean: 0.44860783219337463, gen p mean: -0.045909278094768524, mean p set: 0.44908812642097473
loss_pred:0.014760129153728485, decouple_loss:0.0011531328782439232
loss_pred:0.014479601755738258, decouple_loss:0.0011244789930060506
Iteration: 2608, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44982656836509705, gen p mean: -0.039793357253074646, mean p set: 0.45030689239501953
loss_pred:0.014618863351643085, decouple_loss:0.001043553464114666
The modified gen p mean: 0.4505285322666168, gen p mean: -0.037673648446798325, mean p set: 0.4510088264942169The modified gen p mean: 0.45199522376060486, gen p mean: -0.03952670097351074, mean p set: 0.45247551798820496
loss_pred:0.014508829452097416, decouple_loss:0.0010947686387225986
loss_pred:0.014866896905004978, decouple_loss:0.0011653527617454529
Iteration: 2609, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502885341644287, gen p mean: -0.03957951441407204, mean p set: 0.4507688283920288
loss_pred:0.01557913888245821, decouple_loss:0.0011630187509581447
The modified gen p mean: 0.4510818123817444, gen p mean: -0.037600819021463394, mean p set: 0.45156213641166687The modified gen p mean: 0.4517676532268524, gen p mean: -0.037692081183195114, mean p set: 0.4522479474544525
loss_pred:0.015928229317069054, decouple_loss:0.0011775243328884244
loss_pred:0.014715050347149372, decouple_loss:0.0011901743710041046
Iteration: 2610, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501555562019348, gen p mean: -0.038025885820388794, mean p set: 0.4506358802318573
loss_pred:0.015813607722520828, decouple_loss:0.0010406579822301865
The modified gen p mean: 0.44904351234436035, gen p mean: -0.04001500457525253, mean p set: 0.44952380657196045The modified gen p mean: 0.45216304063796997, gen p mean: -0.03325944021344185, mean p set: 0.45264333486557007
loss_pred:0.015068628825247288, decouple_loss:0.0010989720467478037
loss_pred:0.014708979986608028, decouple_loss:0.0011045669671148062
2023-05-02 12:27:23 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.044531866908073425, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.040177516639232635, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.04058145359158516, mean p set: 0.4500633478164673
loss_pred:0.0186726413667202, decouple_loss:0.0011555892415344715
loss_pred:0.017587166279554367, decouple_loss:0.0011782756773754954
loss_pred:0.017580626532435417, decouple_loss:0.0011086814338341355
WV_0_PC_1_EH_0_PS_40, loss: 0.01800418645143509, avg_mse: 0.026090700179338455
current test mse: 0.026091
Iteration: 2611, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476179778575897, gen p mean: -0.04558616876602173, mean p set: 0.44809824228286743
The modified gen p mean: 0.45145854353904724, gen p mean: -0.03765028342604637, mean p set: 0.45193883776664734
The modified gen p mean: 0.4485812485218048, gen p mean: -0.03490256890654564, mean p set: 0.4490615427494049
loss_pred:0.016123225912451744, decouple_loss:0.0011216180864721537
loss_pred:0.014693599194288254, decouple_loss:0.0011796035105362535
loss_pred:0.01494166161864996, decouple_loss:0.001079212175682187
Iteration: 2612, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45227620005607605, gen p mean: -0.03180501237511635, mean p set: 0.45275649428367615
loss_pred:0.01473197340965271, decouple_loss:0.001117854262702167
The modified gen p mean: 0.44975754618644714, gen p mean: -0.043296996504068375, mean p set: 0.45023781061172485The modified gen p mean: 0.44937124848365784, gen p mean: -0.04042508825659752, mean p set: 0.4498515725135803
loss_pred:0.015159000642597675, decouple_loss:0.001072608050890267
loss_pred:0.014503412880003452, decouple_loss:0.0010811933316290379
Iteration: 2613, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500269293785095, gen p mean: -0.03598480299115181, mean p set: 0.4505072236061096
loss_pred:0.014921920374035835, decouple_loss:0.001015432644635439
The modified gen p mean: 0.45017823576927185, gen p mean: -0.03725855052471161, mean p set: 0.45065850019454956
The modified gen p mean: 0.4514411389827728, gen p mean: -0.03520690277218819, mean p set: 0.4519214332103729
loss_pred:0.014624412171542645, decouple_loss:0.001088891876861453
loss_pred:0.015008552931249142, decouple_loss:0.0010269035119563341
Iteration: 2614, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44969338178634644, gen p mean: -0.038647014647722244, mean p set: 0.45017367601394653
loss_pred:0.014836926944553852, decouple_loss:0.0010728987399488688
The modified gen p mean: 0.44949978590011597, gen p mean: -0.03313791751861572, mean p set: 0.4499800503253937The modified gen p mean: 0.45140552520751953, gen p mean: -0.03822086751461029, mean p set: 0.451885849237442
loss_pred:0.01570338010787964, decouple_loss:0.0009900362929329276
loss_pred:0.015354081988334656, decouple_loss:0.001036590663716197
Iteration: 2615, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513235092163086, gen p mean: -0.0382002554833889, mean p set: 0.4518038034439087
loss_pred:0.014676425606012344, decouple_loss:0.0010241566924378276
The modified gen p mean: 0.4489016532897949, gen p mean: -0.03643283247947693, mean p set: 0.449381947517395The modified gen p mean: 0.4497230052947998, gen p mean: -0.04004090651869774, mean p set: 0.4502033293247223
loss_pred:0.014970697462558746, decouple_loss:0.0010037152096629143
loss_pred:0.015388158150017262, decouple_loss:0.0010244891745969653
Iteration: 2616, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493011236190796, gen p mean: -0.03505293279886246, mean p set: 0.4497814178466797
loss_pred:0.015504654496908188, decouple_loss:0.0010158857330679893
The modified gen p mean: 0.4494591951370239, gen p mean: -0.04521927610039711, mean p set: 0.44993945956230164The modified gen p mean: 0.4503028392791748, gen p mean: -0.03547767922282219, mean p set: 0.4507831633090973
loss_pred:0.014733956195414066, decouple_loss:0.0010049284901469946
loss_pred:0.01567484252154827, decouple_loss:0.001121459063142538
Iteration: 2617, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499203860759735, gen p mean: -0.03513500839471817, mean p set: 0.4504006803035736
loss_pred:0.015232952311635017, decouple_loss:0.0010452661663293839
The modified gen p mean: 0.4501246213912964, gen p mean: -0.04059651494026184, mean p set: 0.45060494542121887The modified gen p mean: 0.4513724744319916, gen p mean: -0.037470173090696335, mean p set: 0.4518527686595917
loss_pred:0.014881410636007786, decouple_loss:0.0010074129095301032
loss_pred:0.015399524942040443, decouple_loss:0.0010200536344200373
Iteration: 2618, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450093537569046, gen p mean: -0.04583238810300827, mean p set: 0.4505738615989685
loss_pred:0.014523069374263287, decouple_loss:0.0010907803662121296
The modified gen p mean: 0.4504621624946594, gen p mean: -0.037411291152238846, mean p set: 0.4509424567222595The modified gen p mean: 0.4500126540660858, gen p mean: -0.042086161673069, mean p set: 0.4504929184913635
loss_pred:0.015216207131743431, decouple_loss:0.0009391547064296901
loss_pred:0.015219849534332752, decouple_loss:0.0010128823341801763
Iteration: 2619, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4521656334400177, gen p mean: -0.036376506090164185, mean p set: 0.4526459276676178
loss_pred:0.01501939631998539, decouple_loss:0.0010561855742707849
The modified gen p mean: 0.44997966289520264, gen p mean: -0.03513158857822418, mean p set: 0.45045995712280273
The modified gen p mean: 0.44915929436683655, gen p mean: -0.03387542441487312, mean p set: 0.44963955879211426
loss_pred:0.015033449977636337, decouple_loss:0.0009664223762229085
loss_pred:0.015503826551139355, decouple_loss:0.0010003146016970277
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012006_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012006_3_24hr.npz
NaN value num: 0
Iteration: 2620, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4530012309551239, gen p mean: -0.03251224011182785, mean p set: 0.453481525182724
loss_pred:0.016167735680937767, decouple_loss:0.0010993006872013211
The modified gen p mean: 0.4532182514667511, gen p mean: -0.03411099314689636, mean p set: 0.4536985456943512The modified gen p mean: 0.4543045163154602, gen p mean: -0.03807629644870758, mean p set: 0.4547848105430603
loss_pred:0.015869585797190666, decouple_loss:0.0009737574146129191
loss_pred:0.015703536570072174, decouple_loss:0.0009785548318177462
2023-05-02 12:29:55 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.04353596642613411, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.03951755538582802, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.039722904562950134, mean p set: 0.4500633478164673
loss_pred:0.01868683658540249, decouple_loss:0.001307799364440143
loss_pred:0.017499376088380814, decouple_loss:0.0013141212984919548
loss_pred:0.017589543014764786, decouple_loss:0.001313422922976315
WV_0_PC_1_EH_0_PS_40, loss: 0.017990842461586, avg_mse: 0.026050103828310966
current test mse: 0.02605
Iteration: 2621, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4539237916469574, gen p mean: -0.0332585908472538, mean p set: 0.4544040560722351
The modified gen p mean: 0.45277318358421326, gen p mean: -0.030653228983283043, mean p set: 0.45325344800949097
The modified gen p mean: 0.4524284303188324, gen p mean: -0.032797347754240036, mean p set: 0.4529087543487549
loss_pred:0.015757158398628235, decouple_loss:0.0011189727811142802
loss_pred:0.016435181722044945, decouple_loss:0.0011155277024954557
loss_pred:0.015285078436136246, decouple_loss:0.001114262267947197
Iteration: 2622, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4530491232872009, gen p mean: -0.032894253730773926, mean p set: 0.453529417514801
loss_pred:0.01620759628713131, decouple_loss:0.0011011866154149175
The modified gen p mean: 0.453561395406723, gen p mean: -0.03476432338356972, mean p set: 0.4540416896343231The modified gen p mean: 0.45344677567481995, gen p mean: -0.0354420505464077, mean p set: 0.45392709970474243
loss_pred:0.014996618032455444, decouple_loss:0.0010946204420179129
loss_pred:0.015447276644408703, decouple_loss:0.0011287610977888107
Iteration: 2623, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4530271589756012, gen p mean: -0.03063669241964817, mean p set: 0.4535074532032013
loss_pred:0.014770587906241417, decouple_loss:0.0010000973707064986
The modified gen p mean: 0.45459312200546265, gen p mean: -0.02966700680553913, mean p set: 0.45507341623306274The modified gen p mean: 0.45374584197998047, gen p mean: -0.040103331208229065, mean p set: 0.4542261064052582
loss_pred:0.015181672759354115, decouple_loss:0.0011583309387788177
loss_pred:0.01541856862604618, decouple_loss:0.001007289974950254
Iteration: 2624, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45334774255752563, gen p mean: -0.037995919585227966, mean p set: 0.4538280665874481
loss_pred:0.015190746635198593, decouple_loss:0.001217844313941896
The modified gen p mean: 0.4529658555984497, gen p mean: -0.03448580205440521, mean p set: 0.4534461498260498
The modified gen p mean: 0.45303255319595337, gen p mean: -0.03590009734034538, mean p set: 0.45351284742355347
loss_pred:0.01547708734869957, decouple_loss:0.001334973145276308
loss_pred:0.015528871677815914, decouple_loss:0.0010359963634982705
Iteration: 2625, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4525662958621979, gen p mean: -0.03625034540891647, mean p set: 0.453046590089798
loss_pred:0.015536925755441189, decouple_loss:0.001137360348366201
The modified gen p mean: 0.45387399196624756, gen p mean: -0.02731778472661972, mean p set: 0.45435431599617004The modified gen p mean: 0.4535083472728729, gen p mean: -0.027629898861050606, mean p set: 0.453988641500473
loss_pred:0.015582668595016003, decouple_loss:0.0011757006868720055
loss_pred:0.016255749389529228, decouple_loss:0.0011268489761278033
Iteration: 2626, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45239129662513733, gen p mean: -0.03115232102572918, mean p set: 0.4528715908527374
loss_pred:0.014556712470948696, decouple_loss:0.0010163838742300868
The modified gen p mean: 0.4502629339694977, gen p mean: -0.032183852046728134, mean p set: 0.45074325799942017The modified gen p mean: 0.45329082012176514, gen p mean: -0.03259881213307381, mean p set: 0.4537711441516876
loss_pred:0.015460311435163021, decouple_loss:0.001083971350453794
loss_pred:0.015469508245587349, decouple_loss:0.0010487675899639726
Iteration: 2627, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4525502920150757, gen p mean: -0.03818930685520172, mean p set: 0.4530305862426758
loss_pred:0.015271310694515705, decouple_loss:0.0010752117959782481
The modified gen p mean: 0.4540155529975891, gen p mean: -0.03751925006508827, mean p set: 0.4544958472251892The modified gen p mean: 0.45244985818862915, gen p mean: -0.033599428832530975, mean p set: 0.45293015241622925
loss_pred:0.015207278542220592, decouple_loss:0.0010316272964701056
loss_pred:0.014653355814516544, decouple_loss:0.0009567104862071574
Iteration: 2628, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45317336916923523, gen p mean: -0.03408215939998627, mean p set: 0.4536536633968353
loss_pred:0.015248870477080345, decouple_loss:0.001021730131469667
The modified gen p mean: 0.45321083068847656, gen p mean: -0.027744898572564125, mean p set: 0.45369112491607666The modified gen p mean: 0.45348599553108215, gen p mean: -0.04122152552008629, mean p set: 0.45396625995635986
loss_pred:0.016011500731110573, decouple_loss:0.0010410434333607554
loss_pred:0.015336758457124233, decouple_loss:0.001094362698495388
Iteration: 2629, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4506906270980835, gen p mean: -0.035388827323913574, mean p set: 0.451170951128006
loss_pred:0.014694522134959698, decouple_loss:0.001079780631698668
The modified gen p mean: 0.45216047763824463, gen p mean: -0.03513946384191513, mean p set: 0.45264074206352234The modified gen p mean: 0.4524705111980438, gen p mean: -0.03542128577828407, mean p set: 0.45295077562332153
loss_pred:0.015875035896897316, decouple_loss:0.0010169597808271646
loss_pred:0.01456527505069971, decouple_loss:0.001083051087334752
Iteration: 2630, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.453023225069046, gen p mean: -0.034149084240198135, mean p set: 0.4535035192966461
loss_pred:0.015396075323224068, decouple_loss:0.0009737078798934817
The modified gen p mean: 0.4534195363521576, gen p mean: -0.03801361471414566, mean p set: 0.4538998007774353The modified gen p mean: 0.45189180970191956, gen p mean: -0.03665665537118912, mean p set: 0.45237207412719727
loss_pred:0.014796937815845013, decouple_loss:0.0009605245431885123
loss_pred:0.015180103480815887, decouple_loss:0.0009438247070647776
2023-05-02 12:31:51 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.047858960926532745, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04423248767852783, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.044439882040023804, mean p set: 0.4500633478164673
loss_pred:0.018698550760746002, decouple_loss:0.001217295415699482
loss_pred:0.017427459359169006, decouple_loss:0.0011740003246814013
loss_pred:0.01756390742957592, decouple_loss:0.0011052594054490328
WV_0_PC_1_EH_0_PS_40, loss: 0.017954915761947632, avg_mse: 0.025973955169320107
current test mse: 0.025974
Iteration: 2631, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4523594081401825, gen p mean: -0.03585043177008629, mean p set: 0.4528396725654602
The modified gen p mean: 0.4523785710334778, gen p mean: -0.039399825036525726, mean p set: 0.4528588652610779
The modified gen p mean: 0.45288416743278503, gen p mean: -0.034689243882894516, mean p set: 0.45336446166038513
loss_pred:0.01540753711014986, decouple_loss:0.0010734187671914697
loss_pred:0.014791407622396946, decouple_loss:0.0011870122980326414
loss_pred:0.01523103378713131, decouple_loss:0.001051620696671307
Iteration: 2632, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.453432559967041, gen p mean: -0.04137952998280525, mean p set: 0.4539128243923187
loss_pred:0.015285767614841461, decouple_loss:0.0010973846074193716
The modified gen p mean: 0.45335716009140015, gen p mean: -0.035351287573575974, mean p set: 0.45383745431900024The modified gen p mean: 0.4536208212375641, gen p mean: -0.03613860160112381, mean p set: 0.4541010856628418
loss_pred:0.01553631853312254, decouple_loss:0.0010209525935351849
loss_pred:0.014802847988903522, decouple_loss:0.0010096782352775335
Iteration: 2633, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4541272819042206, gen p mean: -0.04018945246934891, mean p set: 0.45460760593414307
loss_pred:0.015748605132102966, decouple_loss:0.001000083633698523
The modified gen p mean: 0.45297110080718994, gen p mean: -0.03969265893101692, mean p set: 0.45345136523246765The modified gen p mean: 0.4525143504142761, gen p mean: -0.0396641306579113, mean p set: 0.45299461483955383
loss_pred:0.015676578506827354, decouple_loss:0.0010140036465600133
loss_pred:0.015157582238316536, decouple_loss:0.000957317475695163
Iteration: 2634, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4528730809688568, gen p mean: -0.03761904314160347, mean p set: 0.4533534049987793
loss_pred:0.015256579965353012, decouple_loss:0.0010525203542783856
The modified gen p mean: 0.453774631023407, gen p mean: -0.04353274405002594, mean p set: 0.45425495505332947The modified gen p mean: 0.4530910849571228, gen p mean: -0.0393289178609848, mean p set: 0.4535713493824005
loss_pred:0.015403485856950283, decouple_loss:0.0010855572763830423
loss_pred:0.015038741752505302, decouple_loss:0.0009656117181293666
Iteration: 2635, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4538981020450592, gen p mean: -0.04359082877635956, mean p set: 0.4543784260749817
loss_pred:0.015056981705129147, decouple_loss:0.0010948790004476905
The modified gen p mean: 0.4537653923034668, gen p mean: -0.03823559358716011, mean p set: 0.4542456865310669The modified gen p mean: 0.4528639018535614, gen p mean: -0.03890444338321686, mean p set: 0.4533441960811615
loss_pred:0.015035136602818966, decouple_loss:0.0010948822600767016
loss_pred:0.015057887881994247, decouple_loss:0.0011187988566234708
Iteration: 2636, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4521951973438263, gen p mean: -0.03501800820231438, mean p set: 0.4526754915714264
loss_pred:0.015378640964627266, decouple_loss:0.0011634521652013063
The modified gen p mean: 0.4535242021083832, gen p mean: -0.03360110893845558, mean p set: 0.4540044963359833The modified gen p mean: 0.4529619812965393, gen p mean: -0.03663850575685501, mean p set: 0.4534422755241394
loss_pred:0.016168219968676567, decouple_loss:0.0010832414263859391
loss_pred:0.015315946191549301, decouple_loss:0.0009865736356005073
Iteration: 2637, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45182642340660095, gen p mean: -0.03729785978794098, mean p set: 0.45230671763420105
loss_pred:0.015617062337696552, decouple_loss:0.0011864546686410904
The modified gen p mean: 0.45313799381256104, gen p mean: -0.04069571569561958, mean p set: 0.45361828804016113The modified gen p mean: 0.45027047395706177, gen p mean: -0.03637208044528961, mean p set: 0.4507507383823395
loss_pred:0.01490496564656496, decouple_loss:0.0011644435580819845
loss_pred:0.014902445487678051, decouple_loss:0.0011376041220501065
Iteration: 2638, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4524138271808624, gen p mean: -0.036974310874938965, mean p set: 0.4528941214084625
loss_pred:0.015116439200937748, decouple_loss:0.0010077853221446276
The modified gen p mean: 0.45443862676620483, gen p mean: -0.034394435584545135, mean p set: 0.45491892099380493The modified gen p mean: 0.45436426997184753, gen p mean: -0.03123406320810318, mean p set: 0.45484453439712524
loss_pred:0.015678562223911285, decouple_loss:0.001051291124895215
loss_pred:0.014997425489127636, decouple_loss:0.0010619917884469032
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012008_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012008_3_24hr.npz
NaN value num: 0
Iteration: 2639, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471588730812073, gen p mean: -0.04686319828033447, mean p set: 0.4476391673088074
loss_pred:0.013505593873560429, decouple_loss:0.0011907812440767884
The modified gen p mean: 0.4480445683002472, gen p mean: -0.041572071611881256, mean p set: 0.4485248327255249The modified gen p mean: 0.44793081283569336, gen p mean: -0.0480494350194931, mean p set: 0.44841110706329346
loss_pred:0.014505762606859207, decouple_loss:0.0011336369207128882
loss_pred:0.013674551621079445, decouple_loss:0.0011292482959106565
Iteration: 2640, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483543634414673, gen p mean: -0.04508271813392639, mean p set: 0.4488346576690674
loss_pred:0.01374152023345232, decouple_loss:0.0011480378452688456
The modified gen p mean: 0.44798722863197327, gen p mean: -0.050184424966573715, mean p set: 0.44846752285957336The modified gen p mean: 0.448474258184433, gen p mean: -0.04449455812573433, mean p set: 0.44895458221435547
loss_pred:0.013196222484111786, decouple_loss:0.0011700670002028346
loss_pred:0.013287430629134178, decouple_loss:0.0012064359616488218
2023-05-02 12:34:25 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.052629951387643814, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04880288988351822, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04899444803595543, mean p set: 0.4500633478164673
loss_pred:0.018900670111179352, decouple_loss:0.0012412300566211343
loss_pred:0.01762683503329754, decouple_loss:0.001172425108961761
loss_pred:0.017732979729771614, decouple_loss:0.001159331644885242
WV_0_PC_1_EH_0_PS_40, loss: 0.01814637891948223, avg_mse: 0.026343373581767082
current test mse: 0.026343
Iteration: 2641, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44643887877464294, gen p mean: -0.05230170115828514, mean p set: 0.44691917300224304
The modified gen p mean: 0.44781965017318726, gen p mean: -0.052379656583070755, mean p set: 0.44829997420310974
The modified gen p mean: 0.4494810402393341, gen p mean: -0.048245057463645935, mean p set: 0.4499613046646118
loss_pred:0.013265536166727543, decouple_loss:0.001241605612449348
loss_pred:0.013612366281449795, decouple_loss:0.0011528998147696257
loss_pred:0.013522201217710972, decouple_loss:0.0011843816610053182
Iteration: 2642, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467870891094208, gen p mean: -0.04803178459405899, mean p set: 0.4472673535346985
loss_pred:0.013675506226718426, decouple_loss:0.0011328471591696143
The modified gen p mean: 0.44826120138168335, gen p mean: -0.0438716746866703, mean p set: 0.44874149560928345The modified gen p mean: 0.44900399446487427, gen p mean: -0.04608619213104248, mean p set: 0.449484258890152
loss_pred:0.013245274312794209, decouple_loss:0.0010890091070905328
loss_pred:0.013596242293715477, decouple_loss:0.0010684782173484564
Iteration: 2643, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479028582572937, gen p mean: -0.049312494695186615, mean p set: 0.4483831226825714
loss_pred:0.013248875737190247, decouple_loss:0.0011682611657306552
The modified gen p mean: 0.4472697675228119, gen p mean: -0.04621075093746185, mean p set: 0.4477500915527344The modified gen p mean: 0.4476199448108673, gen p mean: -0.056676242500543594, mean p set: 0.4481002688407898
loss_pred:0.013213207013905048, decouple_loss:0.0011641380842775106
loss_pred:0.01336948573589325, decouple_loss:0.0011260268511250615
Iteration: 2644, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479478597640991, gen p mean: -0.04905877634882927, mean p set: 0.4484281837940216
loss_pred:0.014012654311954975, decouple_loss:0.001078954664990306
The modified gen p mean: 0.449349045753479, gen p mean: -0.04347962886095047, mean p set: 0.4498293101787567The modified gen p mean: 0.449179083108902, gen p mean: -0.04612622782588005, mean p set: 0.4496593773365021
loss_pred:0.013327215798199177, decouple_loss:0.0010247287573292851
loss_pred:0.012985524721443653, decouple_loss:0.0010282638249918818
Iteration: 2645, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479721784591675, gen p mean: -0.04817387834191322, mean p set: 0.4484524726867676
loss_pred:0.013485675677657127, decouple_loss:0.0010809116065502167
The modified gen p mean: 0.44767674803733826, gen p mean: -0.04981785640120506, mean p set: 0.44815701246261597The modified gen p mean: 0.4468684494495392, gen p mean: -0.05421344190835953, mean p set: 0.4473487436771393
loss_pred:0.013254285790026188, decouple_loss:0.0011434510815888643
loss_pred:0.013228492811322212, decouple_loss:0.0011271332623437047
Iteration: 2646, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477563202381134, gen p mean: -0.05015622824430466, mean p set: 0.4482366442680359
loss_pred:0.012640676461160183, decouple_loss:0.0010665934532880783
The modified gen p mean: 0.44797995686531067, gen p mean: -0.04447316378355026, mean p set: 0.44846025109291077The modified gen p mean: 0.4489873945713043, gen p mean: -0.04696211591362953, mean p set: 0.4494676887989044
loss_pred:0.012986643239855766, decouple_loss:0.0011064480058848858
loss_pred:0.013058394193649292, decouple_loss:0.001085006515495479
Iteration: 2647, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44713106751441956, gen p mean: -0.0489935465157032, mean p set: 0.44761136174201965
loss_pred:0.013070317916572094, decouple_loss:0.0010385734494775534
The modified gen p mean: 0.4481048285961151, gen p mean: -0.0448172427713871, mean p set: 0.4485850930213928The modified gen p mean: 0.44692468643188477, gen p mean: -0.04584300145506859, mean p set: 0.44740498065948486
loss_pred:0.013141908682882786, decouple_loss:0.001019393210299313
loss_pred:0.012808411382138729, decouple_loss:0.0010272726649418473
Iteration: 2648, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472024142742157, gen p mean: -0.047517530620098114, mean p set: 0.4476827085018158
loss_pred:0.013243509456515312, decouple_loss:0.0010361596941947937
The modified gen p mean: 0.4477499723434448, gen p mean: -0.04483584687113762, mean p set: 0.4482302665710449The modified gen p mean: 0.448159396648407, gen p mean: -0.047763776034116745, mean p set: 0.4486396908760071
loss_pred:0.012921477667987347, decouple_loss:0.0011289227986708283
loss_pred:0.013332771137356758, decouple_loss:0.001087952870875597
Iteration: 2649, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44828876852989197, gen p mean: -0.04433812201023102, mean p set: 0.44876906275749207
loss_pred:0.012533116154372692, decouple_loss:0.0010173206683248281
The modified gen p mean: 0.44778189063072205, gen p mean: -0.047450948506593704, mean p set: 0.44826218485832214The modified gen p mean: 0.44802576303482056, gen p mean: -0.044416848570108414, mean p set: 0.44850608706474304
loss_pred:0.01307233888655901, decouple_loss:0.0011695693247020245
loss_pred:0.012822851538658142, decouple_loss:0.0010487416293472052
Iteration: 2650, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44977763295173645, gen p mean: -0.04544699937105179, mean p set: 0.45025789737701416
loss_pred:0.012660541571676731, decouple_loss:0.0010473455768078566
The modified gen p mean: 0.4469769597053528, gen p mean: -0.043733108788728714, mean p set: 0.4474572539329529The modified gen p mean: 0.4479162395000458, gen p mean: -0.04644106328487396, mean p set: 0.4483965039253235
loss_pred:0.013153614476323128, decouple_loss:0.0011902515543624759
loss_pred:0.013046970590949059, decouple_loss:0.0012274986365810037
2023-05-02 12:36:19 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.048326946794986725, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04460221156477928, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04479004815220833, mean p set: 0.4500633478164673
loss_pred:0.01915735937654972, decouple_loss:0.0011454365449026227
loss_pred:0.01803891733288765, decouple_loss:0.001064560143277049
loss_pred:0.01803511753678322, decouple_loss:0.001119416207075119
WV_0_PC_1_EH_0_PS_40, loss: 0.018465956673026085, avg_mse: 0.026983920484781265
current test mse: 0.026984
Iteration: 2651, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44751372933387756, gen p mean: -0.04778807610273361, mean p set: 0.4479939937591553
The modified gen p mean: 0.44687357544898987, gen p mean: -0.04818563163280487, mean p set: 0.44735386967658997
The modified gen p mean: 0.44762831926345825, gen p mean: -0.04427643492817879, mean p set: 0.44810861349105835
loss_pred:0.012947285547852516, decouple_loss:0.0010417806915938854
loss_pred:0.013067089952528477, decouple_loss:0.001024589641019702loss_pred:0.013393710367381573, decouple_loss:0.0010687942849472165
Iteration: 2652, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473857879638672, gen p mean: -0.0437847301363945, mean p set: 0.4478660821914673
loss_pred:0.013043816201388836, decouple_loss:0.0010871547274291515
The modified gen p mean: 0.4473644196987152, gen p mean: -0.04395124688744545, mean p set: 0.4478446841239929The modified gen p mean: 0.4483950734138489, gen p mean: -0.045124609023332596, mean p set: 0.448875367641449
loss_pred:0.012964119203388691, decouple_loss:0.0011007058201357722
loss_pred:0.013337213546037674, decouple_loss:0.0011327776592224836
Iteration: 2653, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44811391830444336, gen p mean: -0.04483366385102272, mean p set: 0.44859424233436584
loss_pred:0.013222632929682732, decouple_loss:0.0009843133157119155
The modified gen p mean: 0.44857507944107056, gen p mean: -0.05376308783888817, mean p set: 0.44905540347099304The modified gen p mean: 0.44851401448249817, gen p mean: -0.04861779883503914, mean p set: 0.4489942789077759
loss_pred:0.012938757427036762, decouple_loss:0.0011169321369379759
loss_pred:0.013034660369157791, decouple_loss:0.001109977369196713
Iteration: 2654, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466054141521454, gen p mean: -0.043041348457336426, mean p set: 0.4470857083797455
loss_pred:0.013418911024928093, decouple_loss:0.0010197333758696914
The modified gen p mean: 0.4484352171421051, gen p mean: -0.048156630247831345, mean p set: 0.4489155113697052The modified gen p mean: 0.44668376445770264, gen p mean: -0.04791242256760597, mean p set: 0.44716405868530273
loss_pred:0.013126524165272713, decouple_loss:0.0010165348649024963
loss_pred:0.01296291034668684, decouple_loss:0.0009799625258892775
Iteration: 2655, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469151496887207, gen p mean: -0.051685333251953125, mean p set: 0.4473954439163208
loss_pred:0.013286790810525417, decouple_loss:0.0011641756864264607
The modified gen p mean: 0.4483236074447632, gen p mean: -0.04462224245071411, mean p set: 0.4488039016723633The modified gen p mean: 0.44779497385025024, gen p mean: -0.04823436960577965, mean p set: 0.44827526807785034
loss_pred:0.012451953254640102, decouple_loss:0.001054667285643518
loss_pred:0.01349058747291565, decouple_loss:0.001062260358594358
Iteration: 2656, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486221969127655, gen p mean: -0.04412808641791344, mean p set: 0.4491024613380432
loss_pred:0.012665876187384129, decouple_loss:0.0010263932636007667
The modified gen p mean: 0.44765833020210266, gen p mean: -0.04729541018605232, mean p set: 0.44813862442970276The modified gen p mean: 0.44645360112190247, gen p mean: -0.047895435243844986, mean p set: 0.44693389534950256
loss_pred:0.013570043258368969, decouple_loss:0.0009780963882803917
loss_pred:0.013090422376990318, decouple_loss:0.0011345043312758207
Iteration: 2657, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44743579626083374, gen p mean: -0.052800726145505905, mean p set: 0.44791606068611145
loss_pred:0.012814945541322231, decouple_loss:0.000982716679573059
The modified gen p mean: 0.4472668468952179, gen p mean: -0.046671438962221146, mean p set: 0.447747141122818The modified gen p mean: 0.4475749433040619, gen p mean: -0.04822941869497299, mean p set: 0.4480552673339844
loss_pred:0.012891325168311596, decouple_loss:0.0009886850602924824
loss_pred:0.012985250912606716, decouple_loss:0.0010067279217764735
Iteration: 2658, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44617438316345215, gen p mean: -0.04654991626739502, mean p set: 0.44665467739105225
loss_pred:0.013305055908858776, decouple_loss:0.0009981435723602772
The modified gen p mean: 0.4482094943523407, gen p mean: -0.0495060496032238, mean p set: 0.4486897885799408The modified gen p mean: 0.44690242409706116, gen p mean: -0.04519065096974373, mean p set: 0.44738268852233887
loss_pred:0.01297007780522108, decouple_loss:0.0009465850307606161
loss_pred:0.013344323262572289, decouple_loss:0.0010174732888117433
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012009_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012009_3_24hr.npz
NaN value num: 0
Iteration: 2659, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45268043875694275, gen p mean: -0.039668008685112, mean p set: 0.45316070318222046
loss_pred:0.015521346591413021, decouple_loss:0.001234872150234878
The modified gen p mean: 0.45032015442848206, gen p mean: -0.04026975482702255, mean p set: 0.45080041885375977The modified gen p mean: 0.44926100969314575, gen p mean: -0.044978998601436615, mean p set: 0.44974127411842346
loss_pred:0.01561763696372509, decouple_loss:0.0012380644911900163
loss_pred:0.015652582049369812, decouple_loss:0.0012791584013029933
Iteration: 2660, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4535921514034271, gen p mean: -0.04183120280504227, mean p set: 0.4540724456310272
loss_pred:0.01513389591127634, decouple_loss:0.0011469769524410367
The modified gen p mean: 0.4513115882873535, gen p mean: -0.03652508929371834, mean p set: 0.4517918825149536The modified gen p mean: 0.4520549476146698, gen p mean: -0.03778791055083275, mean p set: 0.4525352716445923
loss_pred:0.01605888642370701, decouple_loss:0.00121047324500978
loss_pred:0.015088004991412163, decouple_loss:0.0010799345327541232
2023-05-02 12:38:51 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.04756982997059822, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04398537427186966, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04404187947511673, mean p set: 0.4500633478164673
loss_pred:0.018866224214434624, decouple_loss:0.0014071977930143476
loss_pred:0.017791906371712685, decouple_loss:0.0014688787050545216
loss_pred:0.01779468171298504, decouple_loss:0.0013318199198693037
WV_0_PC_1_EH_0_PS_40, loss: 0.018221069127321243, avg_mse: 0.02648252435028553
current test mse: 0.026483
Iteration: 2661, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495428502559662, gen p mean: -0.03473755344748497, mean p set: 0.4500231444835663
The modified gen p mean: 0.44949817657470703, gen p mean: -0.038347937166690826, mean p set: 0.44997847080230713
The modified gen p mean: 0.4524647891521454, gen p mean: -0.034761250019073486, mean p set: 0.45294511318206787
loss_pred:0.014789038337767124, decouple_loss:0.0012618781765922904
loss_pred:0.015956833958625793, decouple_loss:0.0011554732918739319
loss_pred:0.015535471960902214, decouple_loss:0.0010924205416813493
Iteration: 2662, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.452853798866272, gen p mean: -0.03036491759121418, mean p set: 0.4533340632915497
loss_pred:0.015303890220820904, decouple_loss:0.0010364048648625612
The modified gen p mean: 0.4522540867328644, gen p mean: -0.03701263666152954, mean p set: 0.4527343511581421The modified gen p mean: 0.45326367020606995, gen p mean: -0.03686896711587906, mean p set: 0.45374393463134766
loss_pred:0.01492814440280199, decouple_loss:0.0011405941331759095
loss_pred:0.015108545310795307, decouple_loss:0.0011449657613411546
Iteration: 2663, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500044584274292, gen p mean: -0.03706202656030655, mean p set: 0.4504847228527069
loss_pred:0.015478553250432014, decouple_loss:0.0010422671912238002
The modified gen p mean: 0.45209187269210815, gen p mean: -0.03391740843653679, mean p set: 0.45257216691970825The modified gen p mean: 0.45269447565078735, gen p mean: -0.03791741281747818, mean p set: 0.45317476987838745
loss_pred:0.01484429556876421, decouple_loss:0.0009529442759230733
loss_pred:0.014804000034928322, decouple_loss:0.0010020738700404763
Iteration: 2664, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4525910019874573, gen p mean: -0.03085789643228054, mean p set: 0.4530712962150574
loss_pred:0.014952326193451881, decouple_loss:0.0011203748872503638
The modified gen p mean: 0.455077588558197, gen p mean: -0.03680337965488434, mean p set: 0.4555578827857971The modified gen p mean: 0.45117950439453125, gen p mean: -0.034015953540802, mean p set: 0.45165982842445374
loss_pred:0.015322301536798477, decouple_loss:0.0011038494994863868
loss_pred:0.015610444359481335, decouple_loss:0.0011500248219817877
Iteration: 2665, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45261350274086, gen p mean: -0.03218124061822891, mean p set: 0.4530937969684601
loss_pred:0.01526486873626709, decouple_loss:0.0010285733733326197
The modified gen p mean: 0.45123565196990967, gen p mean: -0.03677508234977722, mean p set: 0.4517159163951874The modified gen p mean: 0.45204970240592957, gen p mean: -0.03200739994645119, mean p set: 0.45252999663352966
loss_pred:0.015143061988055706, decouple_loss:0.001191119896247983
loss_pred:0.01588582433760166, decouple_loss:0.0010791816748678684
Iteration: 2666, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4506045877933502, gen p mean: -0.044600725173950195, mean p set: 0.45108485221862793
loss_pred:0.014783356338739395, decouple_loss:0.0013086427934467793
The modified gen p mean: 0.45276182889938354, gen p mean: -0.03950914368033409, mean p set: 0.45324212312698364The modified gen p mean: 0.4508725106716156, gen p mean: -0.0380738265812397, mean p set: 0.4513528347015381
loss_pred:0.014280165545642376, decouple_loss:0.0011689881794154644
loss_pred:0.015852786600589752, decouple_loss:0.0011122040450572968
Iteration: 2667, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4539457857608795, gen p mean: -0.03682851791381836, mean p set: 0.4544260501861572
loss_pred:0.015117608942091465, decouple_loss:0.001043603289872408
The modified gen p mean: 0.4496479630470276, gen p mean: -0.03564232215285301, mean p set: 0.4501282274723053The modified gen p mean: 0.4510084390640259, gen p mean: -0.036403074860572815, mean p set: 0.45148876309394836
loss_pred:0.015592319890856743, decouple_loss:0.001070781727321446
loss_pred:0.016574054956436157, decouple_loss:0.001112578553147614
Iteration: 2668, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45129069685935974, gen p mean: -0.03945745900273323, mean p set: 0.45177099108695984
loss_pred:0.015251332893967628, decouple_loss:0.0012536079157143831
The modified gen p mean: 0.4516836702823639, gen p mean: -0.03378677740693092, mean p set: 0.4521639347076416
The modified gen p mean: 0.451753169298172, gen p mean: -0.03478366509079933, mean p set: 0.4522334337234497
loss_pred:0.01547024492174387, decouple_loss:0.0012862830189988017
loss_pred:0.015425927005708218, decouple_loss:0.0012486979831010103
Iteration: 2669, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507342576980591, gen p mean: -0.03855649009346962, mean p set: 0.4512145519256592
loss_pred:0.015514109283685684, decouple_loss:0.0010205507278442383
The modified gen p mean: 0.4519859254360199, gen p mean: -0.038288481533527374, mean p set: 0.45246621966362The modified gen p mean: 0.44975897669792175, gen p mean: -0.03633400797843933, mean p set: 0.45023927092552185
loss_pred:0.015039343386888504, decouple_loss:0.0010204360587522388
loss_pred:0.015778521075844765, decouple_loss:0.0010318848071619868
Iteration: 2670, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511748254299164, gen p mean: -0.0386880561709404, mean p set: 0.4516550898551941
loss_pred:0.0149481650441885, decouple_loss:0.001223187893629074
The modified gen p mean: 0.45212826132774353, gen p mean: -0.041387155652046204, mean p set: 0.45260855555534363The modified gen p mean: 0.45206841826438904, gen p mean: -0.035312335938215256, mean p set: 0.45254871249198914
loss_pred:0.014404229819774628, decouple_loss:0.001218911842443049
loss_pred:0.015490499325096607, decouple_loss:0.0012258487986400723
2023-05-02 12:40:46 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.0462891086935997, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04242764413356781, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.0427677147090435, mean p set: 0.4500633478164673
loss_pred:0.018719278275966644, decouple_loss:0.0012215657625347376
loss_pred:0.017657827585935593, decouple_loss:0.001298734568990767
loss_pred:0.01762826181948185, decouple_loss:0.001248457352630794
WV_0_PC_1_EH_0_PS_40, loss: 0.018064603209495544, avg_mse: 0.02618572488427162
current test mse: 0.026186
Iteration: 2671, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4532754719257355, gen p mean: -0.03662579879164696, mean p set: 0.45375576615333557
The modified gen p mean: 0.45247066020965576, gen p mean: -0.036671265959739685, mean p set: 0.45295095443725586
The modified gen p mean: 0.4519517719745636, gen p mean: -0.03124382719397545, mean p set: 0.4524320662021637
loss_pred:0.015098147094249725, decouple_loss:0.0012270418228581548
loss_pred:0.014677143655717373, decouple_loss:0.0010840819450095296
loss_pred:0.014733588322997093, decouple_loss:0.001297200215049088
Iteration: 2672, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45258569717407227, gen p mean: -0.03514412045478821, mean p set: 0.45306602120399475
loss_pred:0.015375412069261074, decouple_loss:0.0011736704036593437
The modified gen p mean: 0.4504259526729584, gen p mean: -0.03344084322452545, mean p set: 0.4509062170982361The modified gen p mean: 0.4501611590385437, gen p mean: -0.030286869034171104, mean p set: 0.4506414532661438
loss_pred:0.015477246604859829, decouple_loss:0.0012026983313262463
loss_pred:0.015284871682524681, decouple_loss:0.0011952804634347558
Iteration: 2673, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45232534408569336, gen p mean: -0.03610383719205856, mean p set: 0.45280560851097107
loss_pred:0.014731970615684986, decouple_loss:0.0012639901833608747
The modified gen p mean: 0.45113781094551086, gen p mean: -0.041765451431274414, mean p set: 0.4516180753707886The modified gen p mean: 0.4514251947402954, gen p mean: -0.030021468177437782, mean p set: 0.4519054889678955
loss_pred:0.014944416470825672, decouple_loss:0.0014590728096663952
loss_pred:0.015110325068235397, decouple_loss:0.001182251493446529
Iteration: 2674, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45255064964294434, gen p mean: -0.039289239794015884, mean p set: 0.4530309736728668
loss_pred:0.015155945904552937, decouple_loss:0.0014218807918950915
The modified gen p mean: 0.45280054211616516, gen p mean: -0.03367843106389046, mean p set: 0.45328083634376526The modified gen p mean: 0.45118018984794617, gen p mean: -0.035082537680864334, mean p set: 0.45166051387786865
loss_pred:0.015048605389893055, decouple_loss:0.001157255726866424
loss_pred:0.015015299431979656, decouple_loss:0.0012020013527944684
Iteration: 2675, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45263397693634033, gen p mean: -0.03993430733680725, mean p set: 0.45311427116394043
The modified gen p mean: 0.4500288963317871, gen p mean: -0.03821798041462898, mean p set: 0.4505091905593872
loss_pred:0.014683700166642666, decouple_loss:0.0011643149191513658
loss_pred:0.01563216559588909, decouple_loss:0.0011443491093814373
The modified gen p mean: 0.44911253452301025, gen p mean: -0.03994766250252724, mean p set: 0.44959282875061035
loss_pred:0.015584239736199379, decouple_loss:0.001177581842057407
Iteration: 2676, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45153066515922546, gen p mean: -0.04418101906776428, mean p set: 0.4520109295845032
loss_pred:0.014937467873096466, decouple_loss:0.0016119801439344883
The modified gen p mean: 0.4509733021259308, gen p mean: -0.03747881203889847, mean p set: 0.4514535665512085The modified gen p mean: 0.4508156180381775, gen p mean: -0.048391468822956085, mean p set: 0.4512959122657776
loss_pred:0.015332512557506561, decouple_loss:0.0012833530781790614
loss_pred:0.014485686086118221, decouple_loss:0.0014867138816043735
Iteration: 2677, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45114395022392273, gen p mean: -0.039637140929698944, mean p set: 0.4516242742538452
loss_pred:0.015177089720964432, decouple_loss:0.001115432009100914
The modified gen p mean: 0.4509032368659973, gen p mean: -0.04482842981815338, mean p set: 0.4513835310935974The modified gen p mean: 0.45169106125831604, gen p mean: -0.044340576976537704, mean p set: 0.4521713852882385
loss_pred:0.015271076001226902, decouple_loss:0.001067094854079187
loss_pred:0.014552298933267593, decouple_loss:0.0010571314487606287
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012005_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012005_3_24hr.npz
NaN value num: 0
Iteration: 2678, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507334530353546, gen p mean: -0.04091517999768257, mean p set: 0.4512137174606323
loss_pred:0.015166467987000942, decouple_loss:0.001393723301589489
The modified gen p mean: 0.45149368047714233, gen p mean: -0.05026909336447716, mean p set: 0.45197397470474243The modified gen p mean: 0.4513143002986908, gen p mean: -0.048816949129104614, mean p set: 0.4517945945262909
loss_pred:0.01497318223118782, decouple_loss:0.0014785868115723133
loss_pred:0.015070970170199871, decouple_loss:0.0012926548952236772
Iteration: 2679, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45191532373428345, gen p mean: -0.05375147610902786, mean p set: 0.45239561796188354
loss_pred:0.01574859768152237, decouple_loss:0.0011117425747215748
The modified gen p mean: 0.45149075984954834, gen p mean: -0.04498206079006195, mean p set: 0.45197105407714844The modified gen p mean: 0.4503636956214905, gen p mean: -0.052139732986688614, mean p set: 0.4508439898490906
loss_pred:0.01621870882809162, decouple_loss:0.0010329862125217915
loss_pred:0.014924896880984306, decouple_loss:0.0010759546421468258
Iteration: 2680, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45053577423095703, gen p mean: -0.047559283673763275, mean p set: 0.4510160982608795
loss_pred:0.016314323991537094, decouple_loss:0.001556562609039247
The modified gen p mean: 0.45230168104171753, gen p mean: -0.04283669590950012, mean p set: 0.45278200507164The modified gen p mean: 0.4508022367954254, gen p mean: -0.03880428522825241, mean p set: 0.4512825310230255
loss_pred:0.016073407605290413, decouple_loss:0.0013860749313607812
loss_pred:0.0153831010684371, decouple_loss:0.001300931558944285
2023-05-02 12:43:17 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.05040191486477852, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04679739475250244, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.047033414244651794, mean p set: 0.4500633478164673
loss_pred:0.018658176064491272, decouple_loss:0.0012197581818327308
loss_pred:0.01755933277308941, decouple_loss:0.0012024397728964686
loss_pred:0.01758062280714512, decouple_loss:0.001167976763099432
WV_0_PC_1_EH_0_PS_40, loss: 0.017992548644542694, avg_mse: 0.026041638106107712
current test mse: 0.026042
Iteration: 2681, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45093539357185364, gen p mean: -0.04329381883144379, mean p set: 0.45141565799713135
The modified gen p mean: 0.4506296217441559, gen p mean: -0.04187612608075142, mean p set: 0.4511098861694336
The modified gen p mean: 0.4510725140571594, gen p mean: -0.04174299165606499, mean p set: 0.4515528082847595
loss_pred:0.016998371109366417, decouple_loss:0.0011013707844540477
loss_pred:0.01681237854063511, decouple_loss:0.0010934264864772558
loss_pred:0.016385963186621666, decouple_loss:0.001275341841392219
Iteration: 2682, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4515439569950104, gen p mean: -0.04746026173233986, mean p set: 0.4520242512226105
loss_pred:0.015335963107645512, decouple_loss:0.0013246089220046997
The modified gen p mean: 0.4510195255279541, gen p mean: -0.04201911389827728, mean p set: 0.4514998197555542The modified gen p mean: 0.4494110643863678, gen p mean: -0.04950229078531265, mean p set: 0.4498913586139679
loss_pred:0.01699884980916977, decouple_loss:0.0011905814753845334
loss_pred:0.014966807328164577, decouple_loss:0.0012218620395287871
Iteration: 2683, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45155277848243713, gen p mean: -0.03958865627646446, mean p set: 0.4520331025123596
loss_pred:0.01667805016040802, decouple_loss:0.0010888969991356134
The modified gen p mean: 0.4509143531322479, gen p mean: -0.03860929235816002, mean p set: 0.4513946771621704The modified gen p mean: 0.45191705226898193, gen p mean: -0.045876115560531616, mean p set: 0.45239734649658203
loss_pred:0.016013778746128082, decouple_loss:0.0009847950423136353
loss_pred:0.015006779693067074, decouple_loss:0.0010274404194206
Iteration: 2684, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4524074196815491, gen p mean: -0.04396656155586243, mean p set: 0.45288771390914917
loss_pred:0.017194753512740135, decouple_loss:0.00119348696898669
The modified gen p mean: 0.45039984583854675, gen p mean: -0.04050483927130699, mean p set: 0.45088016986846924
The modified gen p mean: 0.4512471556663513, gen p mean: -0.04846132546663284, mean p set: 0.45172742009162903
loss_pred:0.01603005826473236, decouple_loss:0.0011476876679807901
loss_pred:0.016195056959986687, decouple_loss:0.0013065857347100973
Iteration: 2685, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4510059058666229, gen p mean: -0.03901089355349541, mean p set: 0.45148617029190063
loss_pred:0.01595986820757389, decouple_loss:0.0010383508633822203
The modified gen p mean: 0.451057106256485, gen p mean: -0.04536855220794678, mean p set: 0.4515374004840851The modified gen p mean: 0.4509257674217224, gen p mean: -0.04497751221060753, mean p set: 0.4514060616493225
loss_pred:0.016483737155795097, decouple_loss:0.0010644409339874983
loss_pred:0.0166197270154953, decouple_loss:0.001030024024657905
Iteration: 2686, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45133134722709656, gen p mean: -0.04658569023013115, mean p set: 0.45181164145469666
loss_pred:0.016677813604474068, decouple_loss:0.0009317562798969448
The modified gen p mean: 0.4518134891986847, gen p mean: -0.047250427305698395, mean p set: 0.4522937834262848The modified gen p mean: 0.45060819387435913, gen p mean: -0.04180647432804108, mean p set: 0.45108845829963684
loss_pred:0.014467583037912846, decouple_loss:0.0009366045123897493
loss_pred:0.01595117710530758, decouple_loss:0.0009880790021270514
Iteration: 2687, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45126789808273315, gen p mean: -0.045686908066272736, mean p set: 0.45174819231033325
loss_pred:0.016386786475777626, decouple_loss:0.0010875744046643376
The modified gen p mean: 0.45097115635871887, gen p mean: -0.045038867741823196, mean p set: 0.45145145058631897The modified gen p mean: 0.45110514760017395, gen p mean: -0.044216565787792206, mean p set: 0.45158541202545166
loss_pred:0.01566261611878872, decouple_loss:0.0011611318914219737
loss_pred:0.01633351668715477, decouple_loss:0.0010786050697788596
Iteration: 2688, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45163244009017944, gen p mean: -0.0459597148001194, mean p set: 0.45211273431777954
loss_pred:0.016253061592578888, decouple_loss:0.0010919910855591297
The modified gen p mean: 0.45155468583106995, gen p mean: -0.04297548159956932, mean p set: 0.45203498005867004The modified gen p mean: 0.45057252049446106, gen p mean: -0.04166844114661217, mean p set: 0.45105281472206116
loss_pred:0.01629764400422573, decouple_loss:0.0009492645040154457
loss_pred:0.014642269350588322, decouple_loss:0.0011099515249952674
Iteration: 2689, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4510252773761749, gen p mean: -0.049524225294589996, mean p set: 0.451505571603775
loss_pred:0.015956640243530273, decouple_loss:0.0009960444876924157
The modified gen p mean: 0.45139768719673157, gen p mean: -0.04312688484787941, mean p set: 0.45187801122665405The modified gen p mean: 0.4523986279964447, gen p mean: -0.04672485217452049, mean p set: 0.4528789222240448
loss_pred:0.016599338501691818, decouple_loss:0.001122669200412929
loss_pred:0.015165923163294792, decouple_loss:0.001084359479136765
Iteration: 2690, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4512058198451996, gen p mean: -0.05215790122747421, mean p set: 0.4516860842704773
loss_pred:0.015759898349642754, decouple_loss:0.0010311560472473502
The modified gen p mean: 0.4528945982456207, gen p mean: -0.04790260270237923, mean p set: 0.45337486267089844
The modified gen p mean: 0.45060622692108154, gen p mean: -0.0452255979180336, mean p set: 0.45108652114868164
loss_pred:0.015162437222898006, decouple_loss:0.0009697481291368604
loss_pred:0.016896134242415428, decouple_loss:0.0009902087040245533
2023-05-02 12:45:11 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.05061561241745949, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.046856533735990524, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04701641574501991, mean p set: 0.4500633478164673
loss_pred:0.018709897994995117, decouple_loss:0.001237439806573093
loss_pred:0.017582958564162254, decouple_loss:0.0012507012579590082
loss_pred:0.017566047608852386, decouple_loss:0.0012447461485862732
WV_0_PC_1_EH_0_PS_40, loss: 0.018015181645751, avg_mse: 0.026085631921887398
current test mse: 0.026086
Iteration: 2691, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45290446281433105, gen p mean: -0.047228485345840454, mean p set: 0.45338475704193115
The modified gen p mean: 0.452442467212677, gen p mean: -0.04379630461335182, mean p set: 0.4529227614402771
The modified gen p mean: 0.4510226249694824, gen p mean: -0.04404941201210022, mean p set: 0.4515029489994049
loss_pred:0.014730197377502918, decouple_loss:0.0010074361925944686
loss_pred:0.015957335010170937, decouple_loss:0.0010335576953366399
loss_pred:0.016370071098208427, decouple_loss:0.00110555998980999
Iteration: 2692, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500422775745392, gen p mean: -0.04824097454547882, mean p set: 0.45052260160446167
loss_pred:0.015139881521463394, decouple_loss:0.001187978545203805
The modified gen p mean: 0.45221850275993347, gen p mean: -0.049486178904771805, mean p set: 0.45269879698753357The modified gen p mean: 0.45116761326789856, gen p mean: -0.04651210457086563, mean p set: 0.45164790749549866
loss_pred:0.015889571979641914, decouple_loss:0.001051486236974597
loss_pred:0.015133241191506386, decouple_loss:0.0011435255873948336
Iteration: 2693, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45106038451194763, gen p mean: -0.052715037018060684, mean p set: 0.45154067873954773
loss_pred:0.016375280916690826, decouple_loss:0.0011130074271932244
The modified gen p mean: 0.45118051767349243, gen p mean: -0.048985082656145096, mean p set: 0.45166081190109253The modified gen p mean: 0.450927734375, gen p mean: -0.04439281299710274, mean p set: 0.4514080286026001
loss_pred:0.01678147353231907, decouple_loss:0.0010094629833474755
loss_pred:0.015408551320433617, decouple_loss:0.0010747530031949282
Iteration: 2694, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4506426155567169, gen p mean: -0.04591898247599602, mean p set: 0.4511229395866394
loss_pred:0.01603955775499344, decouple_loss:0.0009969661477953196
The modified gen p mean: 0.4523831307888031, gen p mean: -0.042482033371925354, mean p set: 0.4528633952140808The modified gen p mean: 0.4514378607273102, gen p mean: -0.04965350776910782, mean p set: 0.4519181549549103
loss_pred:0.015668774023652077, decouple_loss:0.00103068258613348
loss_pred:0.014708062633872032, decouple_loss:0.001109778182581067
Iteration: 2695, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513819217681885, gen p mean: -0.04339290037751198, mean p set: 0.4518622159957886
loss_pred:0.01566329412162304, decouple_loss:0.0010191056644544005
The modified gen p mean: 0.45028239488601685, gen p mean: -0.047348007559776306, mean p set: 0.45076268911361694The modified gen p mean: 0.4511990249156952, gen p mean: -0.04230980575084686, mean p set: 0.4516793489456177
loss_pred:0.01642586477100849, decouple_loss:0.0010044907685369253
loss_pred:0.016547517850995064, decouple_loss:0.0009371010237373412
Iteration: 2696, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4509027898311615, gen p mean: -0.05109582468867302, mean p set: 0.4513830542564392
The modified gen p mean: 0.450290709733963, gen p mean: -0.04995959624648094, mean p set: 0.4507710039615631
loss_pred:0.016552284359931946, decouple_loss:0.0010662053246051073
loss_pred:0.01619585044682026, decouple_loss:0.001054875086992979
The modified gen p mean: 0.4517457187175751, gen p mean: -0.043335240334272385, mean p set: 0.45222604274749756
loss_pred:0.0166192464530468, decouple_loss:0.0009724620613269508
Iteration: 2697, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4527597725391388, gen p mean: -0.04384845867753029, mean p set: 0.4532400667667389
loss_pred:0.01688075251877308, decouple_loss:0.0009074560948647559
The modified gen p mean: 0.4520998001098633, gen p mean: -0.03998029977083206, mean p set: 0.45258012413978577
The modified gen p mean: 0.45133718848228455, gen p mean: -0.042086727917194366, mean p set: 0.45181748270988464
loss_pred:0.01634150557219982, decouple_loss:0.0009168216492980719
loss_pred:0.016770724207162857, decouple_loss:0.0009432138176634908
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012004_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012004_3_24hr.npz
NaN value num: 0
Iteration: 2698, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4515679180622101, gen p mean: -0.04539622366428375, mean p set: 0.45204824209213257
loss_pred:0.01589306816458702, decouple_loss:0.0012185255764052272
The modified gen p mean: 0.4518401622772217, gen p mean: -0.03862227126955986, mean p set: 0.4523204565048218The modified gen p mean: 0.4518677890300751, gen p mean: -0.04390880838036537, mean p set: 0.45234808325767517
loss_pred:0.016020677983760834, decouple_loss:0.0011431231396272779
loss_pred:0.015915310010313988, decouple_loss:0.0010801526950672269
Iteration: 2699, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4516531229019165, gen p mean: -0.03887339308857918, mean p set: 0.4521334171295166
loss_pred:0.01611112616956234, decouple_loss:0.0010578538058325648
The modified gen p mean: 0.45119166374206543, gen p mean: -0.039641521871089935, mean p set: 0.45167189836502075The modified gen p mean: 0.4517376720905304, gen p mean: -0.03904521465301514, mean p set: 0.4522179961204529
loss_pred:0.01762217842042446, decouple_loss:0.0010564237600192428
loss_pred:0.016321316361427307, decouple_loss:0.000998579547740519
Iteration: 2700, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45200249552726746, gen p mean: -0.04505905508995056, mean p set: 0.45248281955718994
loss_pred:0.016279034316539764, decouple_loss:0.0009997865417972207
The modified gen p mean: 0.45235347747802734, gen p mean: -0.03619376942515373, mean p set: 0.45283377170562744The modified gen p mean: 0.4515969753265381, gen p mean: -0.04129212349653244, mean p set: 0.45207729935646057
loss_pred:0.015864172950387, decouple_loss:0.0010810522362589836
loss_pred:0.016632933169603348, decouple_loss:0.0010450155241414905
2023-05-02 12:48:10 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.048199474811553955, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04424557462334633, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04460525885224342, mean p set: 0.4500633478164673
loss_pred:0.01862391270697117, decouple_loss:0.001216742442920804
loss_pred:0.017489979043602943, decouple_loss:0.0011987922480329871loss_pred:0.017506802454590797, decouple_loss:0.0012304323026910424
WV_0_PC_1_EH_0_PS_40, loss: 0.01793433167040348, avg_mse: 0.025912925601005554
current test mse: 0.025913
Iteration: 2701, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45356109738349915, gen p mean: -0.03652259707450867, mean p set: 0.45404139161109924
The modified gen p mean: 0.45227837562561035, gen p mean: -0.04188024625182152, mean p set: 0.45275866985321045
The modified gen p mean: 0.45169565081596375, gen p mean: -0.034136731177568436, mean p set: 0.45217597484588623
loss_pred:0.01684507541358471, decouple_loss:0.0011523880530148745
loss_pred:0.01575678214430809, decouple_loss:0.00114733399823308
loss_pred:0.015837177634239197, decouple_loss:0.0012143109925091267
Iteration: 2702, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4509446620941162, gen p mean: -0.030458124354481697, mean p set: 0.4514249265193939
loss_pred:0.015992797911167145, decouple_loss:0.0010227146558463573
The modified gen p mean: 0.45161670446395874, gen p mean: -0.037804342806339264, mean p set: 0.45209699869155884
The modified gen p mean: 0.45025843381881714, gen p mean: -0.043484773486852646, mean p set: 0.45073869824409485
loss_pred:0.0160252433270216, decouple_loss:0.0010097329504787922
loss_pred:0.01765056699514389, decouple_loss:0.0009620122727937996
Iteration: 2703, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.451592355966568, gen p mean: -0.04140884801745415, mean p set: 0.4520726501941681
The modified gen p mean: 0.4531554579734802, gen p mean: -0.03562236949801445, mean p set: 0.4536357522010803
loss_pred:0.016792617738246918, decouple_loss:0.0011394446482881904
loss_pred:0.01594139263033867, decouple_loss:0.0010585759300738573
The modified gen p mean: 0.4523914158344269, gen p mean: -0.03531185910105705, mean p set: 0.452871710062027
loss_pred:0.016074610874056816, decouple_loss:0.0011440643575042486
Iteration: 2704, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4518778920173645, gen p mean: -0.04235580936074257, mean p set: 0.4523581564426422
loss_pred:0.015698641538619995, decouple_loss:0.0011373095912858844
The modified gen p mean: 0.45087969303131104, gen p mean: -0.039495278149843216, mean p set: 0.45135995745658875The modified gen p mean: 0.45232877135276794, gen p mean: -0.03767845034599304, mean p set: 0.45280906558036804
loss_pred:0.01586204767227173, decouple_loss:0.0010388552909716964
loss_pred:0.016155943274497986, decouple_loss:0.0011227853829041123
Iteration: 2705, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45173218846321106, gen p mean: -0.03806490823626518, mean p set: 0.45221248269081116
loss_pred:0.01591646671295166, decouple_loss:0.0008942909189499915
The modified gen p mean: 0.451862633228302, gen p mean: -0.03298276662826538, mean p set: 0.4523428976535797The modified gen p mean: 0.4520740807056427, gen p mean: -0.0335875004529953, mean p set: 0.4525543749332428
loss_pred:0.016453856602311134, decouple_loss:0.0009394108783453703
loss_pred:0.016526242718100548, decouple_loss:0.0009444117895327508
Iteration: 2706, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.452161580324173, gen p mean: -0.03131731227040291, mean p set: 0.45264187455177307
loss_pred:0.016629507765173912, decouple_loss:0.0012009344063699245
The modified gen p mean: 0.44969916343688965, gen p mean: -0.040446385741233826, mean p set: 0.45017948746681213The modified gen p mean: 0.4515188932418823, gen p mean: -0.029366720467805862, mean p set: 0.4519991874694824
loss_pred:0.015696264803409576, decouple_loss:0.0010748982895165682
loss_pred:0.0161362923681736, decouple_loss:0.0012338306987658143
Iteration: 2707, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4524410367012024, gen p mean: -0.03545216843485832, mean p set: 0.4529213011264801
loss_pred:0.016026237979531288, decouple_loss:0.0009616754250600934
The modified gen p mean: 0.45204538106918335, gen p mean: -0.0337417833507061, mean p set: 0.45252567529678345The modified gen p mean: 0.45155513286590576, gen p mean: -0.03246881067752838, mean p set: 0.45203545689582825
loss_pred:0.015888402238488197, decouple_loss:0.0010100466897711158
loss_pred:0.016736196354031563, decouple_loss:0.0009576826705597341
Iteration: 2708, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4525918662548065, gen p mean: -0.038018371909856796, mean p set: 0.4530721604824066
The modified gen p mean: 0.45391517877578735, gen p mean: -0.0345783531665802, mean p set: 0.45439544320106506
loss_pred:0.015994301065802574, decouple_loss:0.0011301490012556314
loss_pred:0.015104379504919052, decouple_loss:0.0009636024478822947
The modified gen p mean: 0.45037102699279785, gen p mean: -0.04172463342547417, mean p set: 0.45085132122039795
loss_pred:0.01634904369711876, decouple_loss:0.0010161782847717404
Iteration: 2709, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4525832533836365, gen p mean: -0.03540731966495514, mean p set: 0.4530635178089142
loss_pred:0.015682488679885864, decouple_loss:0.001186324399895966
The modified gen p mean: 0.45130518078804016, gen p mean: -0.032117199152708054, mean p set: 0.45178544521331787The modified gen p mean: 0.45097583532333374, gen p mean: -0.038186803460121155, mean p set: 0.45145612955093384
loss_pred:0.01649034582078457, decouple_loss:0.0010833815904334188
loss_pred:0.016021959483623505, decouple_loss:0.000998883624561131
Iteration: 2710, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4512805640697479, gen p mean: -0.042128290981054306, mean p set: 0.45176082849502563
loss_pred:0.015418955124914646, decouple_loss:0.001197288976982236
The modified gen p mean: 0.45184358954429626, gen p mean: -0.0360422357916832, mean p set: 0.45232388377189636The modified gen p mean: 0.4518062174320221, gen p mean: -0.035608094185590744, mean p set: 0.4522865414619446
loss_pred:0.01605282351374626, decouple_loss:0.0011576642282307148
loss_pred:0.015621643513441086, decouple_loss:0.0011183808092027903
2023-05-02 12:50:05 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.05165074020624161, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04761091619729996, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04809117317199707, mean p set: 0.4500633478164673
loss_pred:0.018676472827792168, decouple_loss:0.0012987974332645535
loss_pred:0.01743411459028721, decouple_loss:0.0012442750157788396
loss_pred:0.017579548060894012, decouple_loss:0.0012434045784175396
WV_0_PC_1_EH_0_PS_40, loss: 0.017959818243980408, avg_mse: 0.025945981964468956
current test mse: 0.025946
Iteration: 2711, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45387494564056396, gen p mean: -0.03866075724363327, mean p set: 0.45435523986816406
The modified gen p mean: 0.4523889422416687, gen p mean: -0.04256032407283783, mean p set: 0.4528692364692688
The modified gen p mean: 0.4534086585044861, gen p mean: -0.04333450272679329, mean p set: 0.4538889527320862
loss_pred:0.015335333533585072, decouple_loss:0.001075912150554359
loss_pred:0.01613541506230831, decouple_loss:0.001004567719064653loss_pred:0.015876788645982742, decouple_loss:0.001169499009847641
Iteration: 2712, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45107153058052063, gen p mean: -0.040688060224056244, mean p set: 0.4515518248081207
loss_pred:0.01564612425863743, decouple_loss:0.0011369454441592097
The modified gen p mean: 0.4513547122478485, gen p mean: -0.043169938027858734, mean p set: 0.4518350064754486The modified gen p mean: 0.45355916023254395, gen p mean: -0.04255533963441849, mean p set: 0.45403948426246643
loss_pred:0.01592523232102394, decouple_loss:0.0010322921443730593
loss_pred:0.015560929663479328, decouple_loss:0.0008887851145118475
Iteration: 2713, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4529211223125458, gen p mean: -0.048478204756975174, mean p set: 0.4534013867378235
loss_pred:0.015270468778908253, decouple_loss:0.0012093648547306657
The modified gen p mean: 0.451813280582428, gen p mean: -0.04234778881072998, mean p set: 0.45229360461235046The modified gen p mean: 0.4535503685474396, gen p mean: -0.04687148332595825, mean p set: 0.45403069257736206
loss_pred:0.0155113460496068, decouple_loss:0.0012566983932629228
loss_pred:0.015451271086931229, decouple_loss:0.0011253764387220144
Iteration: 2714, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45354729890823364, gen p mean: -0.043129634112119675, mean p set: 0.45402759313583374
loss_pred:0.015868520364165306, decouple_loss:0.0009103499469347298
The modified gen p mean: 0.45240339636802673, gen p mean: -0.04857243224978447, mean p set: 0.45288369059562683The modified gen p mean: 0.4510282874107361, gen p mean: -0.048993468284606934, mean p set: 0.4515085816383362
loss_pred:0.01544189453125, decouple_loss:0.0010277512483298779
loss_pred:0.0155430156737566, decouple_loss:0.0009015798568725586
Iteration: 2715, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4523482322692871, gen p mean: -0.049613405019044876, mean p set: 0.4528285562992096
loss_pred:0.01622689515352249, decouple_loss:0.0009825907181948423
The modified gen p mean: 0.45172885060310364, gen p mean: -0.05096174031496048, mean p set: 0.4522091746330261
The modified gen p mean: 0.45139169692993164, gen p mean: -0.048250675201416016, mean p set: 0.4518720209598541
loss_pred:0.017352281138300896, decouple_loss:0.0011305002262815833
loss_pred:0.016346044838428497, decouple_loss:0.0009773176861926913
Iteration: 2716, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45415034890174866, gen p mean: -0.041846439242362976, mean p set: 0.45463061332702637
loss_pred:0.01564357616007328, decouple_loss:0.001052197883836925
The modified gen p mean: 0.4525035321712494, gen p mean: -0.048998698592185974, mean p set: 0.4529838562011719The modified gen p mean: 0.45282846689224243, gen p mean: -0.04541650414466858, mean p set: 0.45330876111984253
loss_pred:0.016120312735438347, decouple_loss:0.0011772618163377047
loss_pred:0.015333165414631367, decouple_loss:0.0011762799695134163
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012004_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012004_3_24hr.npz
NaN value num: 0
Iteration: 2717, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493047595024109, gen p mean: -0.04920089244842529, mean p set: 0.449785053730011
loss_pred:0.015701917931437492, decouple_loss:0.0009754241327755153
The modified gen p mean: 0.4500828683376312, gen p mean: -0.04047155752778053, mean p set: 0.4505631625652313The modified gen p mean: 0.4519050717353821, gen p mean: -0.04381538927555084, mean p set: 0.4523853361606598
loss_pred:0.015366851352155209, decouple_loss:0.001011995947919786
loss_pred:0.01559352595359087, decouple_loss:0.00099190603941679
Iteration: 2718, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4519163966178894, gen p mean: -0.03774445131421089, mean p set: 0.4523966908454895
loss_pred:0.015195419080555439, decouple_loss:0.0010086237452924252
The modified gen p mean: 0.4497142732143402, gen p mean: -0.0423828586935997, mean p set: 0.4501945972442627
The modified gen p mean: 0.45046737790107727, gen p mean: -0.048911042511463165, mean p set: 0.45094767212867737
loss_pred:0.017216090112924576, decouple_loss:0.0011726545635610819
loss_pred:0.016174448654055595, decouple_loss:0.0010532470187172294
Iteration: 2719, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4523484706878662, gen p mean: -0.04132390022277832, mean p set: 0.4528287649154663
loss_pred:0.015333680436015129, decouple_loss:0.000974621216300875
The modified gen p mean: 0.4498899281024933, gen p mean: -0.04139161482453346, mean p set: 0.45037025213241577The modified gen p mean: 0.45001593232154846, gen p mean: -0.04282110556960106, mean p set: 0.45049622654914856
loss_pred:0.016004104167222977, decouple_loss:0.0011117160320281982
loss_pred:0.016526522114872932, decouple_loss:0.0009998403256759048
Iteration: 2720, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502876102924347, gen p mean: -0.03903403878211975, mean p set: 0.4507678747177124
loss_pred:0.015203425660729408, decouple_loss:0.0009549102978780866
The modified gen p mean: 0.45228272676467896, gen p mean: -0.041687361896038055, mean p set: 0.45276302099227905The modified gen p mean: 0.4499150514602661, gen p mean: -0.04532237723469734, mean p set: 0.4503953158855438
loss_pred:0.015606111846864223, decouple_loss:0.0010060204658657312
loss_pred:0.015728743746876717, decouple_loss:0.0009758924134075642
2023-05-02 12:53:09 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.04655273258686066, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04269598424434662, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.042988475412130356, mean p set: 0.4500633478164673
loss_pred:0.018722495064139366, decouple_loss:0.0012647794792428613
loss_pred:0.017516769468784332, decouple_loss:0.001283601624891162
loss_pred:0.017583530396223068, decouple_loss:0.001222150749526918
WV_0_PC_1_EH_0_PS_40, loss: 0.01800377480685711, avg_mse: 0.02603854238986969
current test mse: 0.026039
Iteration: 2721, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44884514808654785, gen p mean: -0.0448373481631279, mean p set: 0.44932547211647034
The modified gen p mean: 0.4510287046432495, gen p mean: -0.044109124690294266, mean p set: 0.4515089690685272
The modified gen p mean: 0.4514380693435669, gen p mean: -0.038061682134866714, mean p set: 0.4519183933734894
loss_pred:0.01488132681697607, decouple_loss:0.0010864285286515951
loss_pred:0.015787262469530106, decouple_loss:0.0010442037601023912
loss_pred:0.015897387638688087, decouple_loss:0.0010560506489127874
Iteration: 2722, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44930869340896606, gen p mean: -0.04140447825193405, mean p set: 0.44978898763656616
loss_pred:0.01532862987369299, decouple_loss:0.0009860270656645298
The modified gen p mean: 0.45132601261138916, gen p mean: -0.0433872751891613, mean p set: 0.45180633664131165The modified gen p mean: 0.4487839937210083, gen p mean: -0.04400068148970604, mean p set: 0.4492642879486084
loss_pred:0.01599053107202053, decouple_loss:0.0010344794718548656
loss_pred:0.01560154464095831, decouple_loss:0.0010800580494105816
Iteration: 2723, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450145959854126, gen p mean: -0.036063052713871, mean p set: 0.4506262540817261
loss_pred:0.014964199624955654, decouple_loss:0.0010500242933630943
The modified gen p mean: 0.4513068199157715, gen p mean: -0.04178460314869881, mean p set: 0.4517871141433716The modified gen p mean: 0.44915157556533813, gen p mean: -0.046678684651851654, mean p set: 0.44963186979293823
loss_pred:0.015438339672982693, decouple_loss:0.001088628894649446
loss_pred:0.017044490203261375, decouple_loss:0.0011254774872213602
Iteration: 2724, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504311978816986, gen p mean: -0.036884866654872894, mean p set: 0.4509114921092987
loss_pred:0.015152149833738804, decouple_loss:0.0009898233693093061
The modified gen p mean: 0.4501520097255707, gen p mean: -0.044919148087501526, mean p set: 0.4506323039531708The modified gen p mean: 0.45040571689605713, gen p mean: -0.04125607758760452, mean p set: 0.4508860111236572
loss_pred:0.016048528254032135, decouple_loss:0.0009414792875759304
loss_pred:0.0156486164778471, decouple_loss:0.0010544642573222518
Iteration: 2725, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44856712222099304, gen p mean: -0.04640510678291321, mean p set: 0.44904741644859314
loss_pred:0.01707155816257, decouple_loss:0.0010016036685556173
The modified gen p mean: 0.4502315819263458, gen p mean: -0.042396899312734604, mean p set: 0.4507118761539459The modified gen p mean: 0.4495391845703125, gen p mean: -0.04715164005756378, mean p set: 0.4500194787979126
loss_pred:0.01521635428071022, decouple_loss:0.0009698892827145755
loss_pred:0.015770316123962402, decouple_loss:0.0010601073736324906
Iteration: 2726, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44989413022994995, gen p mean: -0.04437421262264252, mean p set: 0.45037439465522766
loss_pred:0.015403292141854763, decouple_loss:0.0009826784953474998
The modified gen p mean: 0.4513561427593231, gen p mean: -0.035764940083026886, mean p set: 0.4518364667892456The modified gen p mean: 0.449628621339798, gen p mean: -0.0445471815764904, mean p set: 0.45010891556739807
loss_pred:0.015662534162402153, decouple_loss:0.0011288931127637625
loss_pred:0.01579662412405014, decouple_loss:0.0010630509350448847
Iteration: 2727, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507538080215454, gen p mean: -0.04639945924282074, mean p set: 0.4512340724468231
loss_pred:0.016275664791464806, decouple_loss:0.001041528070345521
The modified gen p mean: 0.45094335079193115, gen p mean: -0.045182134956121445, mean p set: 0.45142364501953125The modified gen p mean: 0.4511454701423645, gen p mean: -0.03941471502184868, mean p set: 0.451625794172287
loss_pred:0.015703942626714706, decouple_loss:0.0010925054084509611
loss_pred:0.014961672946810722, decouple_loss:0.001059053116478026
Iteration: 2728, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44896626472473145, gen p mean: -0.040732208639383316, mean p set: 0.44944655895233154
loss_pred:0.014878431335091591, decouple_loss:0.0010672779753804207
The modified gen p mean: 0.4488067030906677, gen p mean: -0.039246026426553726, mean p set: 0.44928696751594543The modified gen p mean: 0.45012643933296204, gen p mean: -0.04369610920548439, mean p set: 0.45060670375823975
loss_pred:0.0147506482899189, decouple_loss:0.0009953123517334461
loss_pred:0.01586936041712761, decouple_loss:0.0010094987228512764
Iteration: 2729, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45013299584388733, gen p mean: -0.04373284801840782, mean p set: 0.4506132900714874
loss_pred:0.015823878347873688, decouple_loss:0.0010527760023251176
The modified gen p mean: 0.45160409808158875, gen p mean: -0.04802248254418373, mean p set: 0.45208439230918884
The modified gen p mean: 0.4495828449726105, gen p mean: -0.045355573296546936, mean p set: 0.45006316900253296
loss_pred:0.015609366819262505, decouple_loss:0.0013497071340680122
loss_pred:0.015507180243730545, decouple_loss:0.0012704611290246248
Iteration: 2730, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44975656270980835, gen p mean: -0.04365569353103638, mean p set: 0.45023679733276367
loss_pred:0.015601202845573425, decouple_loss:0.001026853802613914
The modified gen p mean: 0.4512999951839447, gen p mean: -0.044971052557229996, mean p set: 0.4517803192138672The modified gen p mean: 0.4510978162288666, gen p mean: -0.04082721099257469, mean p set: 0.4515781104564667
loss_pred:0.01628478430211544, decouple_loss:0.0010674670338630676
loss_pred:0.014759708195924759, decouple_loss:0.0011049779132008553
2023-05-02 12:55:03 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.04887155443429947, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04503905400633812, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.04524621367454529, mean p set: 0.4500633478164673
loss_pred:0.018613576889038086, decouple_loss:0.0011948124738410115
loss_pred:0.017502928152680397, decouple_loss:0.0011879658559337258
loss_pred:0.01758497580885887, decouple_loss:0.0012476935517042875
WV_0_PC_1_EH_0_PS_40, loss: 0.01796100288629532, avg_mse: 0.025957712903618813
current test mse: 0.025958
Iteration: 2731, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499926269054413, gen p mean: -0.04585736617445946, mean p set: 0.4504729211330414
The modified gen p mean: 0.4513264298439026, gen p mean: -0.03961167111992836, mean p set: 0.4518067240715027
The modified gen p mean: 0.4523080885410309, gen p mean: -0.04493863508105278, mean p set: 0.452788382768631
loss_pred:0.015146887861192226, decouple_loss:0.0012184008955955505
loss_pred:0.015608655288815498, decouple_loss:0.0012261224910616875
loss_pred:0.01474518608301878, decouple_loss:0.0010891667334362864
Iteration: 2732, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44992178678512573, gen p mean: -0.048608239740133286, mean p set: 0.4504021108150482
loss_pred:0.01630081608891487, decouple_loss:0.0012567687081173062
The modified gen p mean: 0.44933953881263733, gen p mean: -0.048584453761577606, mean p set: 0.4498198330402374
The modified gen p mean: 0.4504013657569885, gen p mean: -0.042286135256290436, mean p set: 0.4508816599845886
loss_pred:0.01499031949788332, decouple_loss:0.0011519934050738811
loss_pred:0.01539491768926382, decouple_loss:0.0010738397249951959
Iteration: 2733, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489753246307373, gen p mean: -0.0457647442817688, mean p set: 0.4494556486606598
loss_pred:0.015509380958974361, decouple_loss:0.0012115493882447481
The modified gen p mean: 0.4512156546115875, gen p mean: -0.036476895213127136, mean p set: 0.4516959488391876The modified gen p mean: 0.4519311487674713, gen p mean: -0.049641553312540054, mean p set: 0.452411413192749
loss_pred:0.015227138064801693, decouple_loss:0.0011179199209436774
loss_pred:0.015500333160161972, decouple_loss:0.0013153406325727701
Iteration: 2734, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4518994688987732, gen p mean: -0.03596080467104912, mean p set: 0.4523797929286957
loss_pred:0.015494940802454948, decouple_loss:0.0012087241047993302
The modified gen p mean: 0.45169180631637573, gen p mean: -0.047208625823259354, mean p set: 0.45217210054397583The modified gen p mean: 0.4515685737133026, gen p mean: -0.043540049344301224, mean p set: 0.4520488977432251
loss_pred:0.015527027659118176, decouple_loss:0.0011114823864772916
loss_pred:0.015177903696894646, decouple_loss:0.001153386547230184
Iteration: 2735, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501567482948303, gen p mean: -0.04989934340119362, mean p set: 0.4506370425224304
loss_pred:0.01714436709880829, decouple_loss:0.0012442882871255279
The modified gen p mean: 0.4505697786808014, gen p mean: -0.04253670200705528, mean p set: 0.4510500431060791The modified gen p mean: 0.451698362827301, gen p mean: -0.03874926641583443, mean p set: 0.4521786570549011
loss_pred:0.01593521237373352, decouple_loss:0.001059186295606196
loss_pred:0.014600356109440327, decouple_loss:0.001028480939567089
Iteration: 2736, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44841814041137695, gen p mean: -0.04473818093538284, mean p set: 0.44889846444129944
loss_pred:0.01681678183376789, decouple_loss:0.0010942770168185234
The modified gen p mean: 0.4512999355792999, gen p mean: -0.04639090225100517, mean p set: 0.4517802298069The modified gen p mean: 0.44984808564186096, gen p mean: -0.03738916292786598, mean p set: 0.4503283202648163
loss_pred:0.015456782653927803, decouple_loss:0.0011289268732070923
loss_pred:0.014844951219856739, decouple_loss:0.0011032265610992908
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012000_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012000_3_24hr.npz
NaN value num: 0
Iteration: 2737, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44815385341644287, gen p mean: -0.04386617988348007, mean p set: 0.44863414764404297
loss_pred:0.013128453865647316, decouple_loss:0.0011749973054975271
The modified gen p mean: 0.4488517940044403, gen p mean: -0.04133113846182823, mean p set: 0.4493320882320404The modified gen p mean: 0.44693103432655334, gen p mean: -0.04226480424404144, mean p set: 0.44741132855415344
loss_pred:0.013164852745831013, decouple_loss:0.0012536660069599748
loss_pred:0.013673984445631504, decouple_loss:0.0014357055770233274
Iteration: 2738, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493301808834076, gen p mean: -0.041211262345314026, mean p set: 0.4498105049133301
loss_pred:0.013524801470339298, decouple_loss:0.0011214666301384568
The modified gen p mean: 0.4488295614719391, gen p mean: -0.04703885316848755, mean p set: 0.4493098258972168The modified gen p mean: 0.4473119080066681, gen p mean: -0.046310096979141235, mean p set: 0.4477921724319458
loss_pred:0.013196524232625961, decouple_loss:0.001148135750554502
loss_pred:0.012921780347824097, decouple_loss:0.0011786066461354494
Iteration: 2739, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484160542488098, gen p mean: -0.045884061604738235, mean p set: 0.4488963484764099
loss_pred:0.01319178007543087, decouple_loss:0.0012928867945447564
The modified gen p mean: 0.4472804069519043, gen p mean: -0.045812077820301056, mean p set: 0.447760671377182The modified gen p mean: 0.44775640964508057, gen p mean: -0.04375752434134483, mean p set: 0.44823670387268066
loss_pred:0.013379895128309727, decouple_loss:0.0011824241373687983
loss_pred:0.013300887309014797, decouple_loss:0.0011471564648672938
Iteration: 2740, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4461824893951416, gen p mean: -0.050294484943151474, mean p set: 0.4466628134250641
loss_pred:0.013678430579602718, decouple_loss:0.0010996304918080568
The modified gen p mean: 0.4468690752983093, gen p mean: -0.054049186408519745, mean p set: 0.4473493695259094The modified gen p mean: 0.4482327401638031, gen p mean: -0.05249559134244919, mean p set: 0.4487130343914032
loss_pred:0.013143856078386307, decouple_loss:0.0011301110498607159
loss_pred:0.012949516996741295, decouple_loss:0.0012600308982655406
2023-05-02 12:58:08 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.05537625029683113, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.051508303731679916, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.051580097526311874, mean p set: 0.4500633478164673
loss_pred:0.01902461051940918, decouple_loss:0.0011248377850279212
loss_pred:0.017844269052147865, decouple_loss:0.0011034599738195539
loss_pred:0.0178670734167099, decouple_loss:0.0010901872301474214
WV_0_PC_1_EH_0_PS_40, loss: 0.018300626426935196, avg_mse: 0.02662450075149536
current test mse: 0.026624
Iteration: 2741, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491006135940552, gen p mean: -0.04744827002286911, mean p set: 0.4495809078216553
The modified gen p mean: 0.4474087059497833, gen p mean: -0.05012446269392967, mean p set: 0.4478890001773834
The modified gen p mean: 0.44937461614608765, gen p mean: -0.04860064759850502, mean p set: 0.44985491037368774
loss_pred:0.013265854679048061, decouple_loss:0.0010011243866756558
loss_pred:0.013586508110165596, decouple_loss:0.0009969227248802781
loss_pred:0.013250165618956089, decouple_loss:0.0010817719157785177
Iteration: 2742, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44750961661338806, gen p mean: -0.053019095212221146, mean p set: 0.44798991084098816
loss_pred:0.012387754395604134, decouple_loss:0.001357141649350524
The modified gen p mean: 0.4464574158191681, gen p mean: -0.051777660846710205, mean p set: 0.4469376802444458The modified gen p mean: 0.44793716073036194, gen p mean: -0.04653048515319824, mean p set: 0.44841745495796204
loss_pred:0.013394356705248356, decouple_loss:0.001302305143326521
loss_pred:0.012764914892613888, decouple_loss:0.0012373797362670302
Iteration: 2743, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44719547033309937, gen p mean: -0.05268056318163872, mean p set: 0.4476757347583771
loss_pred:0.012834575027227402, decouple_loss:0.0010240599513053894
The modified gen p mean: 0.44661131501197815, gen p mean: -0.054014381021261215, mean p set: 0.44709157943725586The modified gen p mean: 0.4501919448375702, gen p mean: -0.04653105512261391, mean p set: 0.4506722390651703
loss_pred:0.013515587896108627, decouple_loss:0.0010550698498263955
loss_pred:0.012977497652173042, decouple_loss:0.0010576879139989614
Iteration: 2744, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44823944568634033, gen p mean: -0.05239887908101082, mean p set: 0.4487197697162628
loss_pred:0.012924534268677235, decouple_loss:0.0013756336411461234
The modified gen p mean: 0.44790494441986084, gen p mean: -0.04644399508833885, mean p set: 0.44838523864746094The modified gen p mean: 0.44736945629119873, gen p mean: -0.04571038484573364, mean p set: 0.44784975051879883
loss_pred:0.013519817031919956, decouple_loss:0.0010821680771186948
loss_pred:0.012676647864282131, decouple_loss:0.0010668106842786074
Iteration: 2745, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44921785593032837, gen p mean: -0.04752962663769722, mean p set: 0.44969815015792847
loss_pred:0.013034995645284653, decouple_loss:0.0010903965448960662
The modified gen p mean: 0.44705814123153687, gen p mean: -0.0502694807946682, mean p set: 0.44753846526145935The modified gen p mean: 0.44704604148864746, gen p mean: -0.05175388604402542, mean p set: 0.44752633571624756
loss_pred:0.012394183315336704, decouple_loss:0.0012332312762737274
loss_pred:0.013167841359972954, decouple_loss:0.0012876446126028895
Iteration: 2746, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44972023367881775, gen p mean: -0.0476420558989048, mean p set: 0.45020049810409546
loss_pred:0.012968151830136776, decouple_loss:0.0010129444999620318
The modified gen p mean: 0.44858017563819885, gen p mean: -0.044942788779735565, mean p set: 0.44906049966812134The modified gen p mean: 0.44902482628822327, gen p mean: -0.04739508032798767, mean p set: 0.44950512051582336
loss_pred:0.013169941492378712, decouple_loss:0.0011051465990021825
loss_pred:0.012872911989688873, decouple_loss:0.0010670711053535342
Iteration: 2747, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44765815138816833, gen p mean: -0.04672730714082718, mean p set: 0.4481384754180908
loss_pred:0.012342032976448536, decouple_loss:0.0011861232342198491
The modified gen p mean: 0.44889628887176514, gen p mean: -0.04686322808265686, mean p set: 0.4493766129016876The modified gen p mean: 0.4473456144332886, gen p mean: -0.04501570016145706, mean p set: 0.44782590866088867
loss_pred:0.01303769089281559, decouple_loss:0.0011219236766919494
loss_pred:0.013278812170028687, decouple_loss:0.0011693278793245554
Iteration: 2748, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480293095111847, gen p mean: -0.04941612482070923, mean p set: 0.4485096037387848
loss_pred:0.01287608128041029, decouple_loss:0.0013238179963082075
The modified gen p mean: 0.4485984742641449, gen p mean: -0.04808008298277855, mean p set: 0.449078768491745The modified gen p mean: 0.4460190236568451, gen p mean: -0.04765661433339119, mean p set: 0.4464992880821228
loss_pred:0.012808266095817089, decouple_loss:0.0010845797369256616
loss_pred:0.013299500569701195, decouple_loss:0.0011270156828686595
Iteration: 2749, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44830477237701416, gen p mean: -0.049760233610868454, mean p set: 0.44878509640693665
loss_pred:0.012780286371707916, decouple_loss:0.0011667939834296703
The modified gen p mean: 0.44871610403060913, gen p mean: -0.05247192457318306, mean p set: 0.4491964280605316The modified gen p mean: 0.44701382517814636, gen p mean: -0.04811963811516762, mean p set: 0.44749414920806885
loss_pred:0.012290937826037407, decouple_loss:0.001254331087693572
loss_pred:0.012966977432370186, decouple_loss:0.0012981166364625096
Iteration: 2750, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478943645954132, gen p mean: -0.05250270664691925, mean p set: 0.4483746588230133
loss_pred:0.012763317674398422, decouple_loss:0.0011384810786694288
The modified gen p mean: 0.447660356760025, gen p mean: -0.05108843371272087, mean p set: 0.4481406807899475The modified gen p mean: 0.44923028349876404, gen p mean: -0.055431071668863297, mean p set: 0.4497106075286865
loss_pred:0.012755634263157845, decouple_loss:0.0011341811623424292
loss_pred:0.012721783481538296, decouple_loss:0.00121618015691638
2023-05-02 13:00:02 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.05586257204413414, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.05157003924250603, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.05168883129954338, mean p set: 0.4500633478164673
loss_pred:0.019228259101510048, decouple_loss:0.0011133251246064901
loss_pred:0.01801474206149578, decouple_loss:0.0011987992329522967
loss_pred:0.018077274784445763, decouple_loss:0.0011097252136096358
WV_0_PC_1_EH_0_PS_40, loss: 0.018497124314308167, avg_mse: 0.0270403902977705
current test mse: 0.02704
Iteration: 2751, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44831985235214233, gen p mean: -0.05429629981517792, mean p set: 0.44880014657974243
The modified gen p mean: 0.4500364661216736, gen p mean: -0.04645446687936783, mean p set: 0.4505167305469513
The modified gen p mean: 0.4482777416706085, gen p mean: -0.05231618136167526, mean p set: 0.4487580358982086
loss_pred:0.012217673473060131, decouple_loss:0.0012009607162326574
loss_pred:0.012402409687638283, decouple_loss:0.0010748091153800488
loss_pred:0.013451988808810711, decouple_loss:0.0011672445107251406
Iteration: 2752, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44783085584640503, gen p mean: -0.05002772435545921, mean p set: 0.4483111500740051
loss_pred:0.013222461566329002, decouple_loss:0.0011368944542482495
The modified gen p mean: 0.4487658441066742, gen p mean: -0.047129061073064804, mean p set: 0.44924619793891907The modified gen p mean: 0.4471632242202759, gen p mean: -0.052391715347766876, mean p set: 0.4476434886455536
loss_pred:0.013188532553613186, decouple_loss:0.0010777784045785666
loss_pred:0.012838993221521378, decouple_loss:0.0010579510126262903
Iteration: 2753, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474874436855316, gen p mean: -0.05132989585399628, mean p set: 0.4479677379131317
loss_pred:0.01258878968656063, decouple_loss:0.0011176017578691244
The modified gen p mean: 0.4464013874530792, gen p mean: -0.04766952618956566, mean p set: 0.4468816816806793The modified gen p mean: 0.44693154096603394, gen p mean: -0.053737424314022064, mean p set: 0.44741183519363403
loss_pred:0.013014888390898705, decouple_loss:0.001534353126771748
loss_pred:0.012800920754671097, decouple_loss:0.0011931135086342692
Iteration: 2754, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488774240016937, gen p mean: -0.05169171467423439, mean p set: 0.4493577182292938
loss_pred:0.012188390828669071, decouple_loss:0.0011774275917559862
The modified gen p mean: 0.4481850862503052, gen p mean: -0.048247285187244415, mean p set: 0.44866541028022766The modified gen p mean: 0.4490028917789459, gen p mean: -0.04431794956326485, mean p set: 0.44948315620422363
loss_pred:0.012841396033763885, decouple_loss:0.0012420788407325745
loss_pred:0.012850072234869003, decouple_loss:0.0010867987293750048
Iteration: 2755, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491988718509674, gen p mean: -0.04842051863670349, mean p set: 0.4496791362762451
loss_pred:0.012680577114224434, decouple_loss:0.0010430883849039674
The modified gen p mean: 0.4487685561180115, gen p mean: -0.04790850728750229, mean p set: 0.44924888014793396The modified gen p mean: 0.44738543033599854, gen p mean: -0.04793064668774605, mean p set: 0.44786572456359863
loss_pred:0.012665114365518093, decouple_loss:0.0012571270344778895
loss_pred:0.012516587041318417, decouple_loss:0.0011535696685314178
Iteration: 2756, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472601115703583, gen p mean: -0.045853354036808014, mean p set: 0.4477404057979584
loss_pred:0.012637780979275703, decouple_loss:0.0014190864749252796
The modified gen p mean: 0.4492894113063812, gen p mean: -0.042693860828876495, mean p set: 0.44976967573165894The modified gen p mean: 0.44794392585754395, gen p mean: -0.04646521806716919, mean p set: 0.44842419028282166
loss_pred:0.01287404540926218, decouple_loss:0.0011183647438883781
loss_pred:0.012771324254572392, decouple_loss:0.0010793583933264017
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012002_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012002_3_24hr.npz
NaN value num: 0
Iteration: 2757, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45099693536758423, gen p mean: -0.03956500440835953, mean p set: 0.4514772295951843
loss_pred:0.015245255082845688, decouple_loss:0.0010770048247650266
The modified gen p mean: 0.44920992851257324, gen p mean: -0.0369604118168354, mean p set: 0.44969022274017334The modified gen p mean: 0.45114797353744507, gen p mean: -0.04224725440144539, mean p set: 0.45162826776504517
loss_pred:0.016018152236938477, decouple_loss:0.001173166441731155
loss_pred:0.015061670914292336, decouple_loss:0.0011359814088791609
Iteration: 2758, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503400921821594, gen p mean: -0.03918464854359627, mean p set: 0.4508203864097595
loss_pred:0.015459435060620308, decouple_loss:0.0011500268010422587
The modified gen p mean: 0.45125362277030945, gen p mean: -0.04254758358001709, mean p set: 0.45173394680023193The modified gen p mean: 0.4506647288799286, gen p mean: -0.03708349168300629, mean p set: 0.4511450529098511
loss_pred:0.015241694636642933, decouple_loss:0.001143299276009202
loss_pred:0.015527108684182167, decouple_loss:0.0012063359608873725
Iteration: 2759, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4517821669578552, gen p mean: -0.034236520528793335, mean p set: 0.4522624611854553
loss_pred:0.01592092029750347, decouple_loss:0.001159361214376986
The modified gen p mean: 0.45023903250694275, gen p mean: -0.03556917607784271, mean p set: 0.45071932673454285The modified gen p mean: 0.4483523368835449, gen p mean: -0.03821172937750816, mean p set: 0.448832631111145
loss_pred:0.01527214702218771, decouple_loss:0.001150836469605565
loss_pred:0.015513644553720951, decouple_loss:0.0011714381398633122
Iteration: 2760, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484885632991791, gen p mean: -0.026860713958740234, mean p set: 0.4489688575267792
loss_pred:0.016790593042969704, decouple_loss:0.001127624767832458
The modified gen p mean: 0.45182275772094727, gen p mean: -0.037495311349630356, mean p set: 0.45230305194854736The modified gen p mean: 0.44925785064697266, gen p mean: -0.0300538782030344, mean p set: 0.44973814487457275
loss_pred:0.015494371764361858, decouple_loss:0.0012499622534960508
loss_pred:0.016960663720965385, decouple_loss:0.0011979443952441216
2023-05-02 13:02:49 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.04890449345111847, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04493746533989906, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.04501126706600189, mean p set: 0.4500633478164673
loss_pred:0.018739016726613045, decouple_loss:0.0011649311054497957
loss_pred:0.017622852697968483, decouple_loss:0.0011460192035883665
loss_pred:0.01771550439298153, decouple_loss:0.001150852651335299
WV_0_PC_1_EH_0_PS_40, loss: 0.018083488568663597, avg_mse: 0.026189753785729408
current test mse: 0.02619
Iteration: 2761, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44984209537506104, gen p mean: -0.0422753170132637, mean p set: 0.45032238960266113
The modified gen p mean: 0.451149046421051, gen p mean: -0.037234243005514145, mean p set: 0.4516293406486511
The modified gen p mean: 0.4491620361804962, gen p mean: -0.03407033532857895, mean p set: 0.4496423602104187
loss_pred:0.01639714650809765, decouple_loss:0.0012564028147608042
loss_pred:0.016117015853524208, decouple_loss:0.0011772933648899198
loss_pred:0.015449315309524536, decouple_loss:0.0011486350558698177
Iteration: 2762, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45188194513320923, gen p mean: -0.044139206409454346, mean p set: 0.4523622393608093
loss_pred:0.015566784888505936, decouple_loss:0.0011337676551192999
The modified gen p mean: 0.4520038962364197, gen p mean: -0.041000109165906906, mean p set: 0.4524841606616974The modified gen p mean: 0.4508954882621765, gen p mean: -0.044765010476112366, mean p set: 0.4513757526874542
loss_pred:0.014837433584034443, decouple_loss:0.0011455940548330545
loss_pred:0.015563077293336391, decouple_loss:0.001192498137243092
Iteration: 2763, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502314031124115, gen p mean: -0.048444714397192, mean p set: 0.4507116973400116
loss_pred:0.016273299232125282, decouple_loss:0.0010976392077282071
The modified gen p mean: 0.45115718245506287, gen p mean: -0.04754076898097992, mean p set: 0.45163747668266296The modified gen p mean: 0.44897031784057617, gen p mean: -0.0418560728430748, mean p set: 0.44945064187049866
loss_pred:0.01627945527434349, decouple_loss:0.001301629701629281
loss_pred:0.014920021407306194, decouple_loss:0.001074059633538127
Iteration: 2764, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4506933391094208, gen p mean: -0.04662061482667923, mean p set: 0.4511736333370209
loss_pred:0.015110713429749012, decouple_loss:0.0013032990973442793
The modified gen p mean: 0.4519405663013458, gen p mean: -0.04795074462890625, mean p set: 0.4524208605289459The modified gen p mean: 0.4511793255805969, gen p mean: -0.04779486730694771, mean p set: 0.451659619808197
loss_pred:0.01612759754061699, decouple_loss:0.0012177396565675735
loss_pred:0.0148331169039011, decouple_loss:0.0012098700972273946
Iteration: 2765, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45046085119247437, gen p mean: -0.042897243052721024, mean p set: 0.45094114542007446
loss_pred:0.015020438469946384, decouple_loss:0.0011117559624835849
The modified gen p mean: 0.45049548149108887, gen p mean: -0.041757311671972275, mean p set: 0.45097577571868896The modified gen p mean: 0.44900110363960266, gen p mean: -0.0430929958820343, mean p set: 0.44948139786720276
loss_pred:0.015885906293988228, decouple_loss:0.001142117427662015
loss_pred:0.015216223895549774, decouple_loss:0.001133877201937139
Iteration: 2766, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448144793510437, gen p mean: -0.04465634748339653, mean p set: 0.4486250877380371
loss_pred:0.015859778970479965, decouple_loss:0.0011110040359199047
The modified gen p mean: 0.45046043395996094, gen p mean: -0.04032747820019722, mean p set: 0.4509407579898834The modified gen p mean: 0.45053473114967346, gen p mean: -0.04566975682973862, mean p set: 0.45101502537727356
loss_pred:0.014782155863940716, decouple_loss:0.001091668731532991
loss_pred:0.01550244353711605, decouple_loss:0.0011331218993291259
Iteration: 2767, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499132037162781, gen p mean: -0.04757274314761162, mean p set: 0.4503934979438782
loss_pred:0.015749314799904823, decouple_loss:0.0011073264759033918
The modified gen p mean: 0.4508376717567444, gen p mean: -0.040644560009241104, mean p set: 0.4513179361820221The modified gen p mean: 0.45059841871261597, gen p mean: -0.04490532726049423, mean p set: 0.4510786831378937
loss_pred:0.014663598500192165, decouple_loss:0.001096817315556109
loss_pred:0.015393479727208614, decouple_loss:0.001215326483361423
Iteration: 2768, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514671266078949, gen p mean: -0.047004617750644684, mean p set: 0.4519474506378174
loss_pred:0.014838149771094322, decouple_loss:0.001026875339448452
The modified gen p mean: 0.44946759939193726, gen p mean: -0.03972426801919937, mean p set: 0.44994789361953735
The modified gen p mean: 0.450633704662323, gen p mean: -0.046019189059734344, mean p set: 0.4511139988899231
loss_pred:0.016271444037556648, decouple_loss:0.0013116821646690369
loss_pred:0.015907177701592445, decouple_loss:0.0011185711482539773
Iteration: 2769, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513176381587982, gen p mean: -0.04309401661157608, mean p set: 0.4517979323863983
loss_pred:0.014605145901441574, decouple_loss:0.0009401728166267276
The modified gen p mean: 0.45038577914237976, gen p mean: -0.04663204029202461, mean p set: 0.45086607336997986The modified gen p mean: 0.4513459801673889, gen p mean: -0.04488743096590042, mean p set: 0.451826274394989
loss_pred:0.01593666337430477, decouple_loss:0.001061120769008994
loss_pred:0.01538586150854826, decouple_loss:0.0009784909198060632
Iteration: 2770, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45063918828964233, gen p mean: -0.04597630724310875, mean p set: 0.45111945271492004
loss_pred:0.015313495881855488, decouple_loss:0.001006858074106276
The modified gen p mean: 0.44874173402786255, gen p mean: -0.03666526824235916, mean p set: 0.44922199845314026The modified gen p mean: 0.45023593306541443, gen p mean: -0.03997023031115532, mean p set: 0.4507162272930145
loss_pred:0.016254840418696404, decouple_loss:0.0010585481068119407
loss_pred:0.01524517685174942, decouple_loss:0.0009994842112064362
2023-05-02 13:04:43 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.053754694759845734, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.049141816794872284, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.049431465566158295, mean p set: 0.4500633478164673
loss_pred:0.01864631101489067, decouple_loss:0.0011564824962988496
loss_pred:0.017568716779351234, decouple_loss:0.0011487673036754131loss_pred:0.01749907061457634, decouple_loss:0.0011108722537755966
WV_0_PC_1_EH_0_PS_40, loss: 0.017961636185646057, avg_mse: 0.025933008641004562
current test mse: 0.025933
Iteration: 2771, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44939786195755005, gen p mean: -0.04241050034761429, mean p set: 0.44987818598747253The modified gen p mean: 0.45126935839653015, gen p mean: -0.0471736341714859, mean p set: 0.45174965262413025
The modified gen p mean: 0.4501829743385315, gen p mean: -0.04729568213224411, mean p set: 0.450663298368454
loss_pred:0.015798643231391907, decouple_loss:0.0010642334818840027
loss_pred:0.014532892033457756, decouple_loss:0.0009722980321384966
loss_pred:0.01582658663392067, decouple_loss:0.0010334489634260535
Iteration: 2772, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498580992221832, gen p mean: -0.03586844727396965, mean p set: 0.4503384232521057
loss_pred:0.015095064416527748, decouple_loss:0.0010417635785415769
The modified gen p mean: 0.4519505202770233, gen p mean: -0.03963008150458336, mean p set: 0.4524308443069458The modified gen p mean: 0.4511899948120117, gen p mean: -0.04538635537028313, mean p set: 0.4516703188419342
loss_pred:0.016184575855731964, decouple_loss:0.0010829600505530834
loss_pred:0.015200748108327389, decouple_loss:0.0010430826805531979
Iteration: 2773, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481845796108246, gen p mean: -0.032223381102085114, mean p set: 0.4486648738384247
loss_pred:0.01600244641304016, decouple_loss:0.0010060443310067058
The modified gen p mean: 0.4498558044433594, gen p mean: -0.03618316724896431, mean p set: 0.4503360688686371The modified gen p mean: 0.4506831765174866, gen p mean: -0.03717196732759476, mean p set: 0.4511634409427643
loss_pred:0.01562401931732893, decouple_loss:0.001079549896530807
loss_pred:0.015476120635867119, decouple_loss:0.0010589627781882882
Iteration: 2774, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507353901863098, gen p mean: -0.03967221453785896, mean p set: 0.4512156844139099
loss_pred:0.01489538699388504, decouple_loss:0.001022540032863617
The modified gen p mean: 0.4510021209716797, gen p mean: -0.040893372148275375, mean p set: 0.4514824450016022The modified gen p mean: 0.448119193315506, gen p mean: -0.037616435438394547, mean p set: 0.4485994875431061
loss_pred:0.015244078822433949, decouple_loss:0.0011131970677524805
loss_pred:0.015059266239404678, decouple_loss:0.0011096239322796464
Iteration: 2775, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45141905546188354, gen p mean: -0.04233942925930023, mean p set: 0.45189934968948364
loss_pred:0.014579424634575844, decouple_loss:0.0010116291232407093
The modified gen p mean: 0.450381875038147, gen p mean: -0.04243681579828262, mean p set: 0.45086219906806946The modified gen p mean: 0.45224758982658386, gen p mean: -0.03853664919734001, mean p set: 0.45272788405418396
loss_pred:0.01550117414444685, decouple_loss:0.0010366812348365784
loss_pred:0.016076229512691498, decouple_loss:0.0010637782979756594
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012013_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012013_3_24hr.npz
NaN value num: 0
Iteration: 2776, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45238879323005676, gen p mean: -0.042675700038671494, mean p set: 0.45286911725997925
loss_pred:0.015950189903378487, decouple_loss:0.001071400474756956
The modified gen p mean: 0.4509691596031189, gen p mean: -0.03588463366031647, mean p set: 0.451449453830719The modified gen p mean: 0.45153576135635376, gen p mean: -0.03863033652305603, mean p set: 0.45201605558395386
loss_pred:0.016307171434164047, decouple_loss:0.0010626256698742509
loss_pred:0.015809983015060425, decouple_loss:0.0011402512900531292
Iteration: 2777, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45107388496398926, gen p mean: -0.038541506975889206, mean p set: 0.45155417919158936
loss_pred:0.016701888293027878, decouple_loss:0.0010095241013914347
The modified gen p mean: 0.451000839471817, gen p mean: -0.044709134846925735, mean p set: 0.4514811336994171The modified gen p mean: 0.451595664024353, gen p mean: -0.04229739308357239, mean p set: 0.4520759880542755
loss_pred:0.01659737527370453, decouple_loss:0.0010066782124340534
loss_pred:0.015873001888394356, decouple_loss:0.0010962338419631124
Iteration: 2778, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4520995318889618, gen p mean: -0.044189054518938065, mean p set: 0.4525797963142395
loss_pred:0.015768611803650856, decouple_loss:0.0010526980040594935
The modified gen p mean: 0.4504777491092682, gen p mean: -0.039683595299720764, mean p set: 0.4509580433368683The modified gen p mean: 0.45127439498901367, gen p mean: -0.039831265807151794, mean p set: 0.45175471901893616
loss_pred:0.015954086557030678, decouple_loss:0.001073513412848115
loss_pred:0.016195660457015038, decouple_loss:0.0010075722821056843
Iteration: 2779, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450273722410202, gen p mean: -0.040086399763822556, mean p set: 0.4507540166378021
loss_pred:0.01598784700036049, decouple_loss:0.0009925573831424117
The modified gen p mean: 0.45130977034568787, gen p mean: -0.03545883297920227, mean p set: 0.45179006457328796The modified gen p mean: 0.4506767988204956, gen p mean: -0.03909473121166229, mean p set: 0.4511570930480957
loss_pred:0.01676923781633377, decouple_loss:0.0009597098687663674
loss_pred:0.01611943729221821, decouple_loss:0.0009537125006318092
Iteration: 2780, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499052166938782, gen p mean: -0.03927360102534294, mean p set: 0.45038551092147827
loss_pred:0.015610861591994762, decouple_loss:0.0009859224082902074
The modified gen p mean: 0.45134711265563965, gen p mean: -0.03625604510307312, mean p set: 0.45182737708091736The modified gen p mean: 0.4517036974430084, gen p mean: -0.044253911823034286, mean p set: 0.45218396186828613
loss_pred:0.015837453305721283, decouple_loss:0.0010871605481952429
loss_pred:0.017011715099215508, decouple_loss:0.0011933756759390235
2023-05-02 13:07:40 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.05075167864561081, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04632268473505974, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04656209796667099, mean p set: 0.4500633478164673
loss_pred:0.018552370369434357, decouple_loss:0.0011138473637402058
loss_pred:0.017457565292716026, decouple_loss:0.0010761449811980128
loss_pred:0.017517322674393654, decouple_loss:0.0010647611925378442
WV_0_PC_1_EH_0_PS_40, loss: 0.01789666712284088, avg_mse: 0.025845881551504135
current test mse: 0.025846
Iteration: 2781, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45014870166778564, gen p mean: -0.04415390267968178, mean p set: 0.45062902569770813
The modified gen p mean: 0.45092010498046875, gen p mean: -0.042905598878860474, mean p set: 0.45140039920806885
The modified gen p mean: 0.4498280882835388, gen p mean: -0.04478970915079117, mean p set: 0.4503083825111389
loss_pred:0.01643550395965576, decouple_loss:0.0009992999257519841
loss_pred:0.015793485566973686, decouple_loss:0.001024706638418138loss_pred:0.015804769471287727, decouple_loss:0.0009855441749095917
Iteration: 2782, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4517829120159149, gen p mean: -0.04028645530343056, mean p set: 0.452263206243515
loss_pred:0.01584829017519951, decouple_loss:0.0009404401644133031
The modified gen p mean: 0.4530012309551239, gen p mean: -0.043576061725616455, mean p set: 0.453481525182724The modified gen p mean: 0.45014965534210205, gen p mean: -0.04430322349071503, mean p set: 0.45062994956970215
loss_pred:0.015197288244962692, decouple_loss:0.001004706951789558
loss_pred:0.01668422482907772, decouple_loss:0.0009764472488313913
Iteration: 2783, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4510102868080139, gen p mean: -0.04158858582377434, mean p set: 0.451490581035614
loss_pred:0.01617266610264778, decouple_loss:0.0009691076120361686
The modified gen p mean: 0.4494660496711731, gen p mean: -0.04721999540925026, mean p set: 0.4499463438987732The modified gen p mean: 0.4517594277858734, gen p mean: -0.03981362283229828, mean p set: 0.4522396922111511
loss_pred:0.016433188691735268, decouple_loss:0.000979177886620164
loss_pred:0.01601536199450493, decouple_loss:0.0009450443903915584
Iteration: 2784, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45241862535476685, gen p mean: -0.047483548521995544, mean p set: 0.45289894938468933
loss_pred:0.01583416573703289, decouple_loss:0.0010234867222607136
The modified gen p mean: 0.451369047164917, gen p mean: -0.04128463193774223, mean p set: 0.4518493115901947The modified gen p mean: 0.45170968770980835, gen p mean: -0.03927145525813103, mean p set: 0.45218998193740845
loss_pred:0.016514623537659645, decouple_loss:0.0009561881306581199
loss_pred:0.01630396768450737, decouple_loss:0.0009222941007465124
Iteration: 2785, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4509936571121216, gen p mean: -0.04622547701001167, mean p set: 0.4514739513397217
loss_pred:0.01638316921889782, decouple_loss:0.0009103878401219845
The modified gen p mean: 0.45029667019844055, gen p mean: -0.05220950394868851, mean p set: 0.45077693462371826The modified gen p mean: 0.44944626092910767, gen p mean: -0.05116629973053932, mean p set: 0.44992655515670776
loss_pred:0.016172587871551514, decouple_loss:0.0009020951692946255
loss_pred:0.015287775546312332, decouple_loss:0.001013025175780058
Iteration: 2786, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45108503103256226, gen p mean: -0.050535570830106735, mean p set: 0.45156532526016235
loss_pred:0.015257345512509346, decouple_loss:0.0010665074223652482
The modified gen p mean: 0.45045387744903564, gen p mean: -0.0537579283118248, mean p set: 0.45093417167663574
The modified gen p mean: 0.4512133300304413, gen p mean: -0.05330276861786842, mean p set: 0.4516936242580414
loss_pred:0.015933386981487274, decouple_loss:0.0009425703901797533
loss_pred:0.016881581395864487, decouple_loss:0.0010561877861618996
Iteration: 2787, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4519435167312622, gen p mean: -0.05391829460859299, mean p set: 0.4524238109588623
loss_pred:0.015460475347936153, decouple_loss:0.000946712912991643
The modified gen p mean: 0.452606201171875, gen p mean: -0.044890426099300385, mean p set: 0.4530864953994751The modified gen p mean: 0.45306816697120667, gen p mean: -0.049534063786268234, mean p set: 0.45354846119880676
loss_pred:0.016222214326262474, decouple_loss:0.0009526815265417099
loss_pred:0.015706345438957214, decouple_loss:0.0009550281683914363
Iteration: 2788, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45086175203323364, gen p mean: -0.047180213034152985, mean p set: 0.45134201645851135
loss_pred:0.016448192298412323, decouple_loss:0.0009579144534654915
The modified gen p mean: 0.4513828158378601, gen p mean: -0.051190558820962906, mean p set: 0.4518631398677826The modified gen p mean: 0.44963374733924866, gen p mean: -0.0524546280503273, mean p set: 0.45011407136917114
loss_pred:0.016822783276438713, decouple_loss:0.0010990363080054522
loss_pred:0.016305437311530113, decouple_loss:0.0010145463747903705
Iteration: 2789, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4516170918941498, gen p mean: -0.03851594775915146, mean p set: 0.4520973861217499
loss_pred:0.016210155561566353, decouple_loss:0.0009553288109600544
The modified gen p mean: 0.4509449303150177, gen p mean: -0.04187151417136192, mean p set: 0.4514252245426178The modified gen p mean: 0.4500151574611664, gen p mean: -0.04328930005431175, mean p set: 0.4504954218864441
loss_pred:0.015892406925559044, decouple_loss:0.0009743646951392293
loss_pred:0.016055287793278694, decouple_loss:0.0009997810702770948
Iteration: 2790, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45068854093551636, gen p mean: -0.04798683151602745, mean p set: 0.45116883516311646
loss_pred:0.016770044341683388, decouple_loss:0.0010167156578972936
The modified gen p mean: 0.4504963755607605, gen p mean: -0.042897842824459076, mean p set: 0.4509766697883606The modified gen p mean: 0.4508785009384155, gen p mean: -0.04342902824282646, mean p set: 0.451358824968338
loss_pred:0.016280632466077805, decouple_loss:0.000956741685513407
loss_pred:0.015945039689540863, decouple_loss:0.0010017018066719174
2023-05-02 13:09:34 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.05258611589670181, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04811078682541847, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.04863209277391434, mean p set: 0.4500633478164673
loss_pred:0.018433857709169388, decouple_loss:0.0012175582814961672
loss_pred:0.017331993207335472, decouple_loss:0.001103969756513834
loss_pred:0.017383186146616936, decouple_loss:0.0011226440547034144
WV_0_PC_1_EH_0_PS_40, loss: 0.01777375116944313, avg_mse: 0.025598958134651184
current test mse: 0.025599
Iteration: 2791, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45241326093673706, gen p mean: -0.047489676624536514, mean p set: 0.45289358496665955
The modified gen p mean: 0.4517129063606262, gen p mean: -0.038848429918289185, mean p set: 0.4521932005882263
The modified gen p mean: 0.4523983597755432, gen p mean: -0.040042754262685776, mean p set: 0.4528786242008209
loss_pred:0.015951532870531082, decouple_loss:0.0010028983233496547
loss_pred:0.015407651662826538, decouple_loss:0.0009760139510035515
loss_pred:0.016279397532343864, decouple_loss:0.0009322020341642201
Iteration: 2792, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4522620439529419, gen p mean: -0.04345713555812836, mean p set: 0.452742338180542
loss_pred:0.015175653621554375, decouple_loss:0.0008960174163803458
The modified gen p mean: 0.45065435767173767, gen p mean: -0.04057012498378754, mean p set: 0.4511346220970154The modified gen p mean: 0.4500358998775482, gen p mean: -0.040523163974285126, mean p set: 0.4505161941051483
loss_pred:0.01598334312438965, decouple_loss:0.0009796832455322146
loss_pred:0.016321705654263496, decouple_loss:0.0009470048826187849
Iteration: 2793, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505440890789032, gen p mean: -0.04530959948897362, mean p set: 0.4510243833065033
loss_pred:0.016094133257865906, decouple_loss:0.0009372183121740818
The modified gen p mean: 0.45124179124832153, gen p mean: -0.048361923545598984, mean p set: 0.451722115278244The modified gen p mean: 0.45175155997276306, gen p mean: -0.042708441615104675, mean p set: 0.45223185420036316
loss_pred:0.016501715406775475, decouple_loss:0.0009921196615323424
loss_pred:0.015577992424368858, decouple_loss:0.0009375748340971768
Iteration: 2794, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502072036266327, gen p mean: -0.04195011407136917, mean p set: 0.4506874978542328
loss_pred:0.01671791449189186, decouple_loss:0.000937611679546535
The modified gen p mean: 0.45031309127807617, gen p mean: -0.04594511538743973, mean p set: 0.4507933557033539
The modified gen p mean: 0.4503312408924103, gen p mean: -0.042399849742650986, mean p set: 0.4508115351200104
loss_pred:0.01569529063999653, decouple_loss:0.0008913092315196991
loss_pred:0.015580368228256702, decouple_loss:0.0009480996523052454
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012015_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012015_3_24hr.npz
NaN value num: 0
Iteration: 2795, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4524902403354645, gen p mean: -0.043564748018980026, mean p set: 0.4529705345630646
loss_pred:0.016161035746335983, decouple_loss:0.0009861462749540806
The modified gen p mean: 0.44845959544181824, gen p mean: -0.042041514068841934, mean p set: 0.4489399194717407The modified gen p mean: 0.4510059058666229, gen p mean: -0.03984282910823822, mean p set: 0.45148617029190063
loss_pred:0.016808893531560898, decouple_loss:0.0010853902203962207
loss_pred:0.015567431226372719, decouple_loss:0.0010569242294877768
Iteration: 2796, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44890713691711426, gen p mean: -0.03982752561569214, mean p set: 0.44938743114471436
The modified gen p mean: 0.4489806294441223, gen p mean: -0.041094549000263214, mean p set: 0.4494609236717224
loss_pred:0.015788627788424492, decouple_loss:0.0009209220297634602
loss_pred:0.016353247687220573, decouple_loss:0.001034937216900289
The modified gen p mean: 0.44913265109062195, gen p mean: -0.04269986227154732, mean p set: 0.44961294531822205
loss_pred:0.016116607934236526, decouple_loss:0.0009987583616748452
Iteration: 2797, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44982486963272095, gen p mean: -0.039834871888160706, mean p set: 0.45030519366264343
loss_pred:0.016097724437713623, decouple_loss:0.0010331199737265706
The modified gen p mean: 0.45114290714263916, gen p mean: -0.039191413670778275, mean p set: 0.45162320137023926The modified gen p mean: 0.4493042528629303, gen p mean: -0.04180771857500076, mean p set: 0.4497845768928528
loss_pred:0.016247916966676712, decouple_loss:0.0011799135245382786
loss_pred:0.017222274094820023, decouple_loss:0.001033397507853806
Iteration: 2798, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490912854671478, gen p mean: -0.04044034332036972, mean p set: 0.4495715796947479
loss_pred:0.016105839982628822, decouple_loss:0.0010098512284457684
The modified gen p mean: 0.4512256383895874, gen p mean: -0.03908229619264603, mean p set: 0.4517059326171875The modified gen p mean: 0.4490293860435486, gen p mean: -0.03861517086625099, mean p set: 0.4495096802711487
loss_pred:0.01700328104197979, decouple_loss:0.0010948466369882226
loss_pred:0.016653433442115784, decouple_loss:0.0009430936770513654
Iteration: 2799, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45049571990966797, gen p mean: -0.04074035584926605, mean p set: 0.45097601413726807
loss_pred:0.016981076449155807, decouple_loss:0.0010430308757349849
The modified gen p mean: 0.4495984613895416, gen p mean: -0.04278174042701721, mean p set: 0.4500787556171417The modified gen p mean: 0.449260413646698, gen p mean: -0.042567458003759384, mean p set: 0.4497406780719757
loss_pred:0.01675019972026348, decouple_loss:0.0009414094383828342
loss_pred:0.015510207042098045, decouple_loss:0.0010677615646272898
Iteration: 2800, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4528255760669708, gen p mean: -0.0414116233587265, mean p set: 0.45330584049224854
loss_pred:0.016895407810807228, decouple_loss:0.0009907453786581755
The modified gen p mean: 0.449121356010437, gen p mean: -0.047349896281957626, mean p set: 0.4496016502380371The modified gen p mean: 0.4497118890285492, gen p mean: -0.045940473675727844, mean p set: 0.4501922130584717
loss_pred:0.01644698902964592, decouple_loss:0.001065100310370326
loss_pred:0.015888754278421402, decouple_loss:0.0009686406119726598
2023-05-02 13:12:19 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.05704239755868912, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.05258176848292351, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.05290985107421875, mean p set: 0.4500633478164673
loss_pred:0.018396439030766487, decouple_loss:0.001133121200837195
loss_pred:0.017334651201963425, decouple_loss:0.0011295081349089742
loss_pred:0.017386171966791153, decouple_loss:0.001085813855752349
WV_0_PC_1_EH_0_PS_40, loss: 0.017761562019586563, avg_mse: 0.025578035041689873
current test mse: 0.025578
Iteration: 2801, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484226703643799, gen p mean: -0.046119652688503265, mean p set: 0.4489029347896576
The modified gen p mean: 0.45053184032440186, gen p mean: -0.04425923898816109, mean p set: 0.45101216435432434
The modified gen p mean: 0.45049893856048584, gen p mean: -0.04503300040960312, mean p set: 0.45097923278808594
loss_pred:0.015792420133948326, decouple_loss:0.0009478850406594574
loss_pred:0.015348556451499462, decouple_loss:0.001022201031446457
loss_pred:0.015933511778712273, decouple_loss:0.0009979142341762781
Iteration: 2802, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45019111037254333, gen p mean: -0.055798958986997604, mean p set: 0.45067140460014343
loss_pred:0.015907635912299156, decouple_loss:0.0009340221877209842
The modified gen p mean: 0.4502503275871277, gen p mean: -0.04652417451143265, mean p set: 0.4507306218147278The modified gen p mean: 0.45174384117126465, gen p mean: -0.043298203498125076, mean p set: 0.45222410559654236
loss_pred:0.016774887219071388, decouple_loss:0.0009554209536872804
loss_pred:0.01653296872973442, decouple_loss:0.0010049025295302272
Iteration: 2803, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4517269432544708, gen p mean: -0.04495128616690636, mean p set: 0.45220720767974854
loss_pred:0.016494397073984146, decouple_loss:0.000985733000561595
The modified gen p mean: 0.4520019292831421, gen p mean: -0.05112292245030403, mean p set: 0.4524822235107422The modified gen p mean: 0.4491983652114868, gen p mean: -0.05034549534320831, mean p set: 0.4496786296367645
loss_pred:0.016030289232730865, decouple_loss:0.0010513822780922055
loss_pred:0.01601206138730049, decouple_loss:0.0010569262085482478
Iteration: 2804, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491286873817444, gen p mean: -0.050404902547597885, mean p set: 0.4496089518070221
loss_pred:0.016848014667630196, decouple_loss:0.0010385758941993117
The modified gen p mean: 0.44957685470581055, gen p mean: -0.05600002408027649, mean p set: 0.45005717873573303The modified gen p mean: 0.45325762033462524, gen p mean: -0.0497746616601944, mean p set: 0.45373791456222534
loss_pred:0.016251614317297935, decouple_loss:0.000997656024992466
loss_pred:0.016993626952171326, decouple_loss:0.0009824306471273303
Iteration: 2805, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45146018266677856, gen p mean: -0.041922520846128464, mean p set: 0.45194050669670105
loss_pred:0.016475824639201164, decouple_loss:0.0010228889295831323
The modified gen p mean: 0.45288676023483276, gen p mean: -0.04978682100772858, mean p set: 0.4533670246601105The modified gen p mean: 0.4488903284072876, gen p mean: -0.05107245221734047, mean p set: 0.4493706524372101
loss_pred:0.016080090776085854, decouple_loss:0.0009602179634384811
loss_pred:0.016045603901147842, decouple_loss:0.00100530288182199
Iteration: 2806, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44951194524765015, gen p mean: -0.04949585720896721, mean p set: 0.44999220967292786
loss_pred:0.016318760812282562, decouple_loss:0.0010288488119840622
The modified gen p mean: 0.44978469610214233, gen p mean: -0.05077037587761879, mean p set: 0.45026499032974243The modified gen p mean: 0.45079654455184937, gen p mean: -0.04817121848464012, mean p set: 0.45127683877944946
loss_pred:0.015906814485788345, decouple_loss:0.0010216908995062113
loss_pred:0.015340249054133892, decouple_loss:0.00101270095910877
Iteration: 2807, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44832563400268555, gen p mean: -0.04764527454972267, mean p set: 0.44880592823028564
loss_pred:0.015832699835300446, decouple_loss:0.0010851591359823942
The modified gen p mean: 0.44956880807876587, gen p mean: -0.04320000112056732, mean p set: 0.45004913210868835The modified gen p mean: 0.44985663890838623, gen p mean: -0.053127214312553406, mean p set: 0.4503369629383087
loss_pred:0.015661925077438354, decouple_loss:0.0010545860277488828
loss_pred:0.016617579385638237, decouple_loss:0.0013500046916306019
Iteration: 2808, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492291510105133, gen p mean: -0.04637237638235092, mean p set: 0.4497094452381134
loss_pred:0.016200603917241096, decouple_loss:0.0010830041719600558
The modified gen p mean: 0.4488146901130676, gen p mean: -0.04488517716526985, mean p set: 0.44929495453834534The modified gen p mean: 0.448651522397995, gen p mean: -0.04715045168995857, mean p set: 0.4491318166255951
loss_pred:0.01604154147207737, decouple_loss:0.001050489256158471
loss_pred:0.015160954557359219, decouple_loss:0.0010680514387786388
Iteration: 2809, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502372443675995, gen p mean: -0.0441385880112648, mean p set: 0.4507175385951996
loss_pred:0.016239101067185402, decouple_loss:0.001092779915779829
The modified gen p mean: 0.4490957260131836, gen p mean: -0.04832359775900841, mean p set: 0.4495759904384613The modified gen p mean: 0.45089393854141235, gen p mean: -0.04181623458862305, mean p set: 0.4513741731643677
loss_pred:0.016779152676463127, decouple_loss:0.0009576593874953687
loss_pred:0.01624460145831108, decouple_loss:0.0010792235843837261
Iteration: 2810, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501086175441742, gen p mean: -0.043508220463991165, mean p set: 0.4505888819694519
loss_pred:0.016715945675969124, decouple_loss:0.0012303149560466409
The modified gen p mean: 0.45101234316825867, gen p mean: -0.04183703660964966, mean p set: 0.45149263739585876The modified gen p mean: 0.4497857689857483, gen p mean: -0.04813748225569725, mean p set: 0.4502660930156708
loss_pred:0.015732401981949806, decouple_loss:0.0010881879134103656
loss_pred:0.015920210629701614, decouple_loss:0.0011190581135451794
2023-05-02 13:14:12 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.05640929192304611, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.05206435173749924, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.05233335867524147, mean p set: 0.4500633478164673
loss_pred:0.018404193222522736, decouple_loss:0.0010544887045398355
loss_pred:0.01729152724146843, decouple_loss:0.0010915191378444433
loss_pred:0.01746869459748268, decouple_loss:0.0010823622578755021
WV_0_PC_1_EH_0_PS_40, loss: 0.0177752785384655, avg_mse: 0.025589333847165108
current test mse: 0.025589
Iteration: 2811, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486089050769806, gen p mean: -0.04395826533436775, mean p set: 0.4490891993045807
The modified gen p mean: 0.44866570830345154, gen p mean: -0.042138826102018356, mean p set: 0.44914600253105164
The modified gen p mean: 0.4504856467247009, gen p mean: -0.04076002910733223, mean p set: 0.450965940952301
loss_pred:0.016620734706521034, decouple_loss:0.001095750485546887
loss_pred:0.01655709370970726, decouple_loss:0.0010346748167648911
loss_pred:0.01665881834924221, decouple_loss:0.0010355410631746054
Iteration: 2812, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44844138622283936, gen p mean: -0.04609665647149086, mean p set: 0.44892165064811707
loss_pred:0.01629551127552986, decouple_loss:0.0014135855017229915
The modified gen p mean: 0.45058467984199524, gen p mean: -0.052207645028829575, mean p set: 0.45106494426727295The modified gen p mean: 0.44994911551475525, gen p mean: -0.04639701545238495, mean p set: 0.45042943954467773
loss_pred:0.01624983176589012, decouple_loss:0.0012813106877729297
loss_pred:0.015781404450535774, decouple_loss:0.0012783482670783997
Iteration: 2813, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497421085834503, gen p mean: -0.04720539599657059, mean p set: 0.450222373008728
loss_pred:0.015978386625647545, decouple_loss:0.0010426444932818413
The modified gen p mean: 0.4511185884475708, gen p mean: -0.04011544957756996, mean p set: 0.4515989124774933The modified gen p mean: 0.45077428221702576, gen p mean: -0.04228893667459488, mean p set: 0.45125457644462585
loss_pred:0.01615246944129467, decouple_loss:0.0010605545248836279
loss_pred:0.016860803589224815, decouple_loss:0.0011131014907732606
Iteration: 2814, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45099177956581116, gen p mean: -0.035585254430770874, mean p set: 0.45147207379341125
loss_pred:0.017047761008143425, decouple_loss:0.0013399479212239385
The modified gen p mean: 0.4482678472995758, gen p mean: -0.04535354673862457, mean p set: 0.4487481415271759The modified gen p mean: 0.4510740637779236, gen p mean: -0.03702595829963684, mean p set: 0.4515543580055237
loss_pred:0.017070643603801727, decouple_loss:0.0013588774017989635
loss_pred:0.016542477533221245, decouple_loss:0.0013056965544819832
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012003_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012003_3_24hr.npz
NaN value num: 0
Iteration: 2815, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497276842594147, gen p mean: -0.05455256253480911, mean p set: 0.45020797848701477
loss_pred:0.016579722985625267, decouple_loss:0.0012240526266396046
The modified gen p mean: 0.44972240924835205, gen p mean: -0.04541298374533653, mean p set: 0.45020267367362976The modified gen p mean: 0.45316675305366516, gen p mean: -0.043717026710510254, mean p set: 0.45364704728126526
loss_pred:0.017330629751086235, decouple_loss:0.0011950485641136765
loss_pred:0.01612810418009758, decouple_loss:0.0011962406570091844
Iteration: 2816, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44983574748039246, gen p mean: -0.04414676874876022, mean p set: 0.45031604170799255
loss_pred:0.01676367036998272, decouple_loss:0.001185914734378457
The modified gen p mean: 0.44949871301651, gen p mean: -0.042763642966747284, mean p set: 0.4499790072441101The modified gen p mean: 0.44968754053115845, gen p mean: -0.046721894294023514, mean p set: 0.45016786456108093
loss_pred:0.0166764073073864, decouple_loss:0.001130018150433898
loss_pred:0.01687880977988243, decouple_loss:0.0011039761593565345
Iteration: 2817, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44855958223342896, gen p mean: -0.05121240019798279, mean p set: 0.44903984665870667
loss_pred:0.016049150377511978, decouple_loss:0.001387730473652482
The modified gen p mean: 0.4498114287853241, gen p mean: -0.04665123671293259, mean p set: 0.4502916932106018The modified gen p mean: 0.44980499148368835, gen p mean: -0.04232150688767433, mean p set: 0.45028528571128845
loss_pred:0.015807706862688065, decouple_loss:0.0012606031959876418
loss_pred:0.016800737008452415, decouple_loss:0.0012488464126363397
Iteration: 2818, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495340585708618, gen p mean: -0.041252151131629944, mean p set: 0.4500143229961395
loss_pred:0.016078345477581024, decouple_loss:0.0011264013592153788
The modified gen p mean: 0.45070335268974304, gen p mean: -0.04113857075572014, mean p set: 0.4511836767196655The modified gen p mean: 0.4512633979320526, gen p mean: -0.04234909266233444, mean p set: 0.4517436623573303
loss_pred:0.016730664297938347, decouple_loss:0.0012633202131837606
loss_pred:0.016612203791737556, decouple_loss:0.0012518466683104634
Iteration: 2819, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45007792115211487, gen p mean: -0.03891238197684288, mean p set: 0.4505581855773926
loss_pred:0.016468651592731476, decouple_loss:0.00116075633559376
The modified gen p mean: 0.45217227935791016, gen p mean: -0.040457841008901596, mean p set: 0.45265257358551025The modified gen p mean: 0.44846272468566895, gen p mean: -0.052317164838314056, mean p set: 0.44894298911094666
loss_pred:0.01602434739470482, decouple_loss:0.0013101689983159304
loss_pred:0.015562496148049831, decouple_loss:0.0011865050764754415
Iteration: 2820, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44892454147338867, gen p mean: -0.049581121653318405, mean p set: 0.4494048058986664
loss_pred:0.01552663929760456, decouple_loss:0.0012936859857290983
The modified gen p mean: 0.4498523473739624, gen p mean: -0.04470251500606537, mean p set: 0.4503326416015625The modified gen p mean: 0.45297864079475403, gen p mean: -0.041969578713178635, mean p set: 0.4534589648246765
loss_pred:0.016873406246304512, decouple_loss:0.0011477855732664466
loss_pred:0.01592293009161949, decouple_loss:0.001262660138309002
2023-05-02 13:17:13 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.051558271050453186, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830833911896, gen p mean: -0.04734289273619652, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04718897491693497, mean p set: 0.45035696029663086
loss_pred:0.01853814721107483, decouple_loss:0.0012865522876381874
loss_pred:0.01751604676246643, decouple_loss:0.0013673692010343075
loss_pred:0.017411036416888237, decouple_loss:0.0013551197480410337
WV_0_PC_1_EH_0_PS_40, loss: 0.017888560891151428, avg_mse: 0.025758355855941772
current test mse: 0.025758
Iteration: 2821, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45048782229423523, gen p mean: -0.04593324661254883, mean p set: 0.45096808671951294
The modified gen p mean: 0.45171695947647095, gen p mean: -0.038043420761823654, mean p set: 0.45219725370407104
The modified gen p mean: 0.44933873414993286, gen p mean: -0.048518531024456024, mean p set: 0.44981902837753296
loss_pred:0.015842773020267487, decouple_loss:0.0011199564905837178
loss_pred:0.01575831137597561, decouple_loss:0.0011529488256201148
loss_pred:0.01578201912343502, decouple_loss:0.0011303082574158907
Iteration: 2822, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44992244243621826, gen p mean: -0.03967583552002907, mean p set: 0.45040273666381836
loss_pred:0.016317840665578842, decouple_loss:0.0010977165075019002
The modified gen p mean: 0.4500858783721924, gen p mean: -0.04146408289670944, mean p set: 0.4505661725997925The modified gen p mean: 0.45256519317626953, gen p mean: -0.04050222784280777, mean p set: 0.45304545760154724
loss_pred:0.016410132870078087, decouple_loss:0.001373765291646123
loss_pred:0.01565336436033249, decouple_loss:0.0011975602246820927
Iteration: 2823, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44869184494018555, gen p mean: -0.04621871933341026, mean p set: 0.44917213916778564
loss_pred:0.01587294414639473, decouple_loss:0.001231892965734005
The modified gen p mean: 0.4503084123134613, gen p mean: -0.044762011617422104, mean p set: 0.4507887363433838The modified gen p mean: 0.4514254331588745, gen p mean: -0.0455351360142231, mean p set: 0.451905757188797
loss_pred:0.015556905418634415, decouple_loss:0.0010811686515808105
loss_pred:0.015853554010391235, decouple_loss:0.0011760815978050232
Iteration: 2824, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.451625794172287, gen p mean: -0.04459507763385773, mean p set: 0.4521060883998871
loss_pred:0.01637968234717846, decouple_loss:0.0011253813281655312
The modified gen p mean: 0.4502222239971161, gen p mean: -0.04103042185306549, mean p set: 0.4507025480270386The modified gen p mean: 0.4501267671585083, gen p mean: -0.05220004543662071, mean p set: 0.4506070911884308
loss_pred:0.016697047278285027, decouple_loss:0.0011675668647512794
loss_pred:0.01618167757987976, decouple_loss:0.0012973787961527705
Iteration: 2825, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496883451938629, gen p mean: -0.03904148191213608, mean p set: 0.4501686692237854
loss_pred:0.01599927619099617, decouple_loss:0.0011878600344061852
The modified gen p mean: 0.4535812437534332, gen p mean: -0.044330377131700516, mean p set: 0.45406150817871094The modified gen p mean: 0.44726434350013733, gen p mean: -0.052127156406641006, mean p set: 0.4477446675300598
loss_pred:0.015540510416030884, decouple_loss:0.0012530088424682617
loss_pred:0.015610498376190662, decouple_loss:0.0012730660382658243
Iteration: 2826, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44918400049209595, gen p mean: -0.041693251579999924, mean p set: 0.44966429471969604
loss_pred:0.016650058329105377, decouple_loss:0.0012314601335674524
The modified gen p mean: 0.4526509642601013, gen p mean: -0.04104400426149368, mean p set: 0.4531312584877014The modified gen p mean: 0.4489035904407501, gen p mean: -0.047975700348615646, mean p set: 0.4493838846683502
loss_pred:0.01653412915766239, decouple_loss:0.0012719506630674005
loss_pred:0.016510548070073128, decouple_loss:0.0011508736060932279
Iteration: 2827, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45282161235809326, gen p mean: -0.03733484447002411, mean p set: 0.45330190658569336
loss_pred:0.015726428478956223, decouple_loss:0.0013872102135792375
The modified gen p mean: 0.4511922299861908, gen p mean: -0.04162229597568512, mean p set: 0.4516725242137909The modified gen p mean: 0.4505920112133026, gen p mean: -0.043846845626831055, mean p set: 0.4510722756385803
loss_pred:0.016466481611132622, decouple_loss:0.0011668878141790628
loss_pred:0.015855012461543083, decouple_loss:0.001205789390951395
Iteration: 2828, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492344856262207, gen p mean: -0.04052712768316269, mean p set: 0.4497148096561432
loss_pred:0.016169585287570953, decouple_loss:0.001183234853670001
The modified gen p mean: 0.4527396261692047, gen p mean: -0.037217553704977036, mean p set: 0.4532198905944824The modified gen p mean: 0.4502153694629669, gen p mean: -0.03861328959465027, mean p set: 0.450695663690567
loss_pred:0.01669636182487011, decouple_loss:0.0012952738907188177
loss_pred:0.0165094006806612, decouple_loss:0.0011113194050267339
Iteration: 2829, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495389461517334, gen p mean: -0.03571249917149544, mean p set: 0.4500192403793335
loss_pred:0.016168193891644478, decouple_loss:0.0010722903534770012
The modified gen p mean: 0.45271623134613037, gen p mean: -0.03692286089062691, mean p set: 0.4531964957714081The modified gen p mean: 0.44873303174972534, gen p mean: -0.04142283648252487, mean p set: 0.44921332597732544
loss_pred:0.016297798603773117, decouple_loss:0.0011049347231164575
loss_pred:0.016210880130529404, decouple_loss:0.0011314054718241096
Iteration: 2830, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44997432827949524, gen p mean: -0.037577465176582336, mean p set: 0.45045459270477295
loss_pred:0.015341578982770443, decouple_loss:0.00104425975587219
The modified gen p mean: 0.45039209723472595, gen p mean: -0.033599402755498886, mean p set: 0.45087239146232605The modified gen p mean: 0.44934508204460144, gen p mean: -0.03685114532709122, mean p set: 0.44982537627220154
loss_pred:0.016167722642421722, decouple_loss:0.001075421692803502
loss_pred:0.01629963517189026, decouple_loss:0.0010041126515716314
2023-05-02 13:19:07 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.04705150052905083, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04243915528059006, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.0426785945892334, mean p set: 0.4500633478164673
loss_pred:0.018440453335642815, decouple_loss:0.0012391444761306047
loss_pred:0.01729869656264782, decouple_loss:0.0011679744347929955
loss_pred:0.017448263242840767, decouple_loss:0.0012061215238645673
WV_0_PC_1_EH_0_PS_40, loss: 0.017789360135793686, avg_mse: 0.02561529539525509
current test mse: 0.025615
Iteration: 2831, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4530010223388672, gen p mean: -0.036920588463544846, mean p set: 0.4534813165664673
The modified gen p mean: 0.44970133900642395, gen p mean: -0.035645991563797, mean p set: 0.45018163323402405
The modified gen p mean: 0.45304596424102783, gen p mean: -0.038777582347393036, mean p set: 0.45352625846862793
loss_pred:0.016029303893446922, decouple_loss:0.0011723372153937817
loss_pred:0.016527164727449417, decouple_loss:0.0012250944273546338
loss_pred:0.016287485137581825, decouple_loss:0.0010804787743836641
Iteration: 2832, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4523540735244751, gen p mean: -0.03552502766251564, mean p set: 0.4528343677520752
loss_pred:0.015933886170387268, decouple_loss:0.0012347687734290957
The modified gen p mean: 0.449763685464859, gen p mean: -0.045633696019649506, mean p set: 0.4502440094947815The modified gen p mean: 0.44876691699028015, gen p mean: -0.04313260689377785, mean p set: 0.44924721121788025
loss_pred:0.01578572578728199, decouple_loss:0.0012759675737470388
loss_pred:0.016882164403796196, decouple_loss:0.0012459165882319212
Iteration: 2833, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4506075978279114, gen p mean: -0.042299784719944, mean p set: 0.4510878920555115
loss_pred:0.016656184569001198, decouple_loss:0.0010438471799716353
The modified gen p mean: 0.4501339793205261, gen p mean: -0.038411084562540054, mean p set: 0.45061424374580383The modified gen p mean: 0.4491724371910095, gen p mean: -0.039577651768922806, mean p set: 0.4496527314186096
loss_pred:0.01589144766330719, decouple_loss:0.001022907323203981
loss_pred:0.016388991847634315, decouple_loss:0.001148922718130052
Iteration: 2834, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44884034991264343, gen p mean: -0.046159468591213226, mean p set: 0.4493206739425659
loss_pred:0.015647657215595245, decouple_loss:0.0013048318214714527
The modified gen p mean: 0.44984570145606995, gen p mean: -0.04073785990476608, mean p set: 0.45032599568367004The modified gen p mean: 0.4515535533428192, gen p mean: -0.03897744044661522, mean p set: 0.4520338773727417
loss_pred:0.015839047729969025, decouple_loss:0.0012638113694265485
loss_pred:0.016138294711709023, decouple_loss:0.0012278363574296236
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012018_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012018_3_24hr.npz
NaN value num: 0
Iteration: 2835, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45149004459381104, gen p mean: -0.04951924458146095, mean p set: 0.45197030901908875
loss_pred:0.01650511473417282, decouple_loss:0.0010765691986307502
The modified gen p mean: 0.45244041085243225, gen p mean: -0.045964423567056656, mean p set: 0.45292070508003235The modified gen p mean: 0.4503582715988159, gen p mean: -0.04974181577563286, mean p set: 0.450838565826416
loss_pred:0.017115319147706032, decouple_loss:0.00101863918825984
loss_pred:0.016706645488739014, decouple_loss:0.0010071401484310627
Iteration: 2836, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44968530535697937, gen p mean: -0.04727976769208908, mean p set: 0.45016559958457947
loss_pred:0.015320849604904652, decouple_loss:0.0010758345015347004
The modified gen p mean: 0.4501558840274811, gen p mean: -0.054864659905433655, mean p set: 0.4506361782550812The modified gen p mean: 0.449899822473526, gen p mean: -0.05384088307619095, mean p set: 0.4503801465034485
loss_pred:0.015792427584528923, decouple_loss:0.0012663316447287798
loss_pred:0.01622094213962555, decouple_loss:0.0010221985867246985
Iteration: 2837, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44804272055625916, gen p mean: -0.05349545553326607, mean p set: 0.44852298498153687
loss_pred:0.01626923307776451, decouple_loss:0.0010669310577213764
The modified gen p mean: 0.4508698880672455, gen p mean: -0.04708382114768028, mean p set: 0.4513501822948456The modified gen p mean: 0.45089441537857056, gen p mean: -0.05180209502577782, mean p set: 0.45137470960617065
loss_pred:0.016525035724043846, decouple_loss:0.0011222872417420149
loss_pred:0.01695677824318409, decouple_loss:0.001139881438575685
Iteration: 2838, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4512171447277069, gen p mean: -0.05309333652257919, mean p set: 0.451697438955307
loss_pred:0.016533227637410164, decouple_loss:0.0010253331856802106
The modified gen p mean: 0.4506523609161377, gen p mean: -0.048529431223869324, mean p set: 0.4511326253414154The modified gen p mean: 0.4513773024082184, gen p mean: -0.050018515437841415, mean p set: 0.4518575668334961
loss_pred:0.0166759230196476, decouple_loss:0.00099925824906677
loss_pred:0.016535155475139618, decouple_loss:0.0009630437707528472
Iteration: 2839, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45277726650238037, gen p mean: -0.050647616386413574, mean p set: 0.45325756072998047
loss_pred:0.015562398359179497, decouple_loss:0.000987075618468225
The modified gen p mean: 0.4500799775123596, gen p mean: -0.05282453075051308, mean p set: 0.45056024193763733The modified gen p mean: 0.45324620604515076, gen p mean: -0.05291667580604553, mean p set: 0.45372650027275085
loss_pred:0.01614430919289589, decouple_loss:0.0010941334767267108
loss_pred:0.014985168352723122, decouple_loss:0.0009936278220266104
Iteration: 2840, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513542950153351, gen p mean: -0.0465373620390892, mean p set: 0.4518345892429352
loss_pred:0.016106365248560905, decouple_loss:0.0011191613739356399
The modified gen p mean: 0.45035213232040405, gen p mean: -0.04928116872906685, mean p set: 0.45083242654800415The modified gen p mean: 0.4492751657962799, gen p mean: -0.047938305884599686, mean p set: 0.4497554302215576
loss_pred:0.01584472320973873, decouple_loss:0.0011278572492301464
loss_pred:0.015793684870004654, decouple_loss:0.0010242338757961988
2023-05-02 13:21:56 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.053022854030132294, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04877759516239166, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.049010828137397766, mean p set: 0.4500633478164673
loss_pred:0.018480448052287102, decouple_loss:0.0011182554299011827
loss_pred:0.017385704442858696, decouple_loss:0.0011902264086529613
loss_pred:0.017506061121821404, decouple_loss:0.0011398278875276446
WV_0_PC_1_EH_0_PS_40, loss: 0.017848210409283638, avg_mse: 0.025736061856150627
current test mse: 0.025736
Iteration: 2841, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45077523589134216, gen p mean: -0.047217708081007004, mean p set: 0.4512555003166199
The modified gen p mean: 0.45090603828430176, gen p mean: -0.049710098654031754, mean p set: 0.45138633251190186
The modified gen p mean: 0.4518306851387024, gen p mean: -0.0506611242890358, mean p set: 0.4523109793663025
loss_pred:0.016501428559422493, decouple_loss:0.0012082181638106704
loss_pred:0.01656285487115383, decouple_loss:0.0011048991000279784loss_pred:0.015565695241093636, decouple_loss:0.0010449076071381569
Iteration: 2842, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45285534858703613, gen p mean: -0.044093888252973557, mean p set: 0.45333564281463623
loss_pred:0.014910883270204067, decouple_loss:0.001064700772985816
The modified gen p mean: 0.4514182209968567, gen p mean: -0.04714302718639374, mean p set: 0.4518985152244568The modified gen p mean: 0.44935181736946106, gen p mean: -0.04240366443991661, mean p set: 0.44983211159706116
loss_pred:0.015585212968289852, decouple_loss:0.001138143241405487
loss_pred:0.01580808497965336, decouple_loss:0.0010277403052896261
Iteration: 2843, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448230504989624, gen p mean: -0.03744443506002426, mean p set: 0.4487107992172241
loss_pred:0.016338903456926346, decouple_loss:0.0011221077293157578
The modified gen p mean: 0.4526841342449188, gen p mean: -0.04190404340624809, mean p set: 0.4531644284725189The modified gen p mean: 0.44866201281547546, gen p mean: -0.03887029364705086, mean p set: 0.44914230704307556
loss_pred:0.015260457992553711, decouple_loss:0.0010489010019227862
loss_pred:0.015618005767464638, decouple_loss:0.001085521187633276
Iteration: 2844, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487243592739105, gen p mean: -0.03588134050369263, mean p set: 0.4492046535015106
loss_pred:0.01645001955330372, decouple_loss:0.0009671090519987047
The modified gen p mean: 0.4501711130142212, gen p mean: -0.03912527859210968, mean p set: 0.4506514370441437The modified gen p mean: 0.4490574300289154, gen p mean: -0.04104303941130638, mean p set: 0.4495377540588379
loss_pred:0.015719594433903694, decouple_loss:0.001077977241948247
loss_pred:0.015382694080471992, decouple_loss:0.0010805224301293492
Iteration: 2845, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44840550422668457, gen p mean: -0.03778978809714317, mean p set: 0.4488857686519623
loss_pred:0.016598522663116455, decouple_loss:0.0010526644764468074
The modified gen p mean: 0.450303316116333, gen p mean: -0.038258425891399384, mean p set: 0.4507836401462555The modified gen p mean: 0.45174968242645264, gen p mean: -0.03649432212114334, mean p set: 0.45222997665405273
loss_pred:0.016232740134000778, decouple_loss:0.00104521366301924
loss_pred:0.01644626446068287, decouple_loss:0.001339912530966103
Iteration: 2846, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507392644882202, gen p mean: -0.035031650215387344, mean p set: 0.4512195587158203
loss_pred:0.016483526676893234, decouple_loss:0.0010747771011665463
The modified gen p mean: 0.4507633149623871, gen p mean: -0.03938873112201691, mean p set: 0.4512436091899872The modified gen p mean: 0.4509352445602417, gen p mean: -0.039291027933359146, mean p set: 0.4514155387878418
loss_pred:0.01570836454629898, decouple_loss:0.0011663873447105289
loss_pred:0.01562708616256714, decouple_loss:0.0012097066501155496
Iteration: 2847, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514327645301819, gen p mean: -0.04134323075413704, mean p set: 0.45191308856010437
loss_pred:0.015484428964555264, decouple_loss:0.0009485330083407462
The modified gen p mean: 0.44978851079940796, gen p mean: -0.039956044405698776, mean p set: 0.45026880502700806The modified gen p mean: 0.4496780037879944, gen p mean: -0.031409263610839844, mean p set: 0.4501582682132721
loss_pred:0.015570300631225109, decouple_loss:0.0010077095357701182
loss_pred:0.0157903004437685, decouple_loss:0.0009878352284431458
Iteration: 2848, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502318501472473, gen p mean: -0.035159699618816376, mean p set: 0.4507121443748474
loss_pred:0.015435047447681427, decouple_loss:0.0009264436666853726
The modified gen p mean: 0.45249879360198975, gen p mean: -0.03721490129828453, mean p set: 0.45297905802726746The modified gen p mean: 0.4524685740470886, gen p mean: -0.03702526539564133, mean p set: 0.4529488980770111
loss_pred:0.016590436920523643, decouple_loss:0.001157319056801498
loss_pred:0.01571929268538952, decouple_loss:0.0012253018794581294
Iteration: 2849, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45008784532546997, gen p mean: -0.03759894520044327, mean p set: 0.45056816935539246
loss_pred:0.016097433865070343, decouple_loss:0.0009090523817576468
The modified gen p mean: 0.4501718282699585, gen p mean: -0.03703703358769417, mean p set: 0.4506521224975586The modified gen p mean: 0.4483364522457123, gen p mean: -0.04175443574786186, mean p set: 0.44881677627563477
loss_pred:0.016179105266928673, decouple_loss:0.0010686619207262993
loss_pred:0.015900427475571632, decouple_loss:0.0009239174542017281
Iteration: 2850, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4512278139591217, gen p mean: -0.04432302713394165, mean p set: 0.4517081081867218
loss_pred:0.016444088891148567, decouple_loss:0.00107431726064533
The modified gen p mean: 0.4499867856502533, gen p mean: -0.046061594039201736, mean p set: 0.4504671096801758The modified gen p mean: 0.44949018955230713, gen p mean: -0.035761673003435135, mean p set: 0.4499705135822296
loss_pred:0.015445863828063011, decouple_loss:0.0008860031375661492
loss_pred:0.01580742560327053, decouple_loss:0.000916368851903826
2023-05-02 13:23:50 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.048774585127830505, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.044600024819374084, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.044881291687488556, mean p set: 0.4500633478164673
loss_pred:0.01853814348578453, decouple_loss:0.0012753050541505218
loss_pred:0.017383519560098648, decouple_loss:0.0011114247608929873
loss_pred:0.017535274848341942, decouple_loss:0.0011110220802947879
WV_0_PC_1_EH_0_PS_40, loss: 0.017877276986837387, avg_mse: 0.0258166640996933
current test mse: 0.025817
Iteration: 2851, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495660960674286, gen p mean: -0.046676501631736755, mean p set: 0.4500464200973511
The modified gen p mean: 0.4508529305458069, gen p mean: -0.042528558522462845, mean p set: 0.451333224773407
The modified gen p mean: 0.4497639238834381, gen p mean: -0.04474732652306557, mean p set: 0.4502442479133606
loss_pred:0.01561477780342102, decouple_loss:0.001133839599788189
loss_pred:0.015458325855433941, decouple_loss:0.001111579709686339
loss_pred:0.015480054542422295, decouple_loss:0.0009378251852467656
Iteration: 2852, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4515188932418823, gen p mean: -0.040602389723062515, mean p set: 0.4519991874694824
loss_pred:0.01669233664870262, decouple_loss:0.0009960002498701215
The modified gen p mean: 0.4511845111846924, gen p mean: -0.045124463737010956, mean p set: 0.4516648054122925The modified gen p mean: 0.4496941566467285, gen p mean: -0.04933514446020126, mean p set: 0.4501744508743286
loss_pred:0.015525315888226032, decouple_loss:0.0009681502124294639
loss_pred:0.014959530904889107, decouple_loss:0.0009119143942371011
Iteration: 2853, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450702428817749, gen p mean: -0.04063715785741806, mean p set: 0.45118266344070435
loss_pred:0.01615757867693901, decouple_loss:0.0009093528497032821
The modified gen p mean: 0.4517655074596405, gen p mean: -0.042699266225099564, mean p set: 0.4522458016872406The modified gen p mean: 0.45093390345573425, gen p mean: -0.04585513845086098, mean p set: 0.45141419768333435
loss_pred:0.016556210815906525, decouple_loss:0.001002490520477295
loss_pred:0.016027484089136124, decouple_loss:0.0009421306313015521
Iteration: 2854, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486974775791168, gen p mean: -0.04533417895436287, mean p set: 0.4491777718067169
loss_pred:0.015532131306827068, decouple_loss:0.0010175328934565187
The modified gen p mean: 0.45195165276527405, gen p mean: -0.04281626641750336, mean p set: 0.45243194699287415The modified gen p mean: 0.45074793696403503, gen p mean: -0.04597141593694687, mean p set: 0.45122823119163513
loss_pred:0.016466287896037102, decouple_loss:0.0010158064542338252
loss_pred:0.016524894163012505, decouple_loss:0.0009749823366291821
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012013_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012013_3_24hr.npz
NaN value num: 0
Iteration: 2855, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507507383823395, gen p mean: -0.03875284269452095, mean p set: 0.4512310028076172
loss_pred:0.014669595286250114, decouple_loss:0.001088422373868525
The modified gen p mean: 0.44850990176200867, gen p mean: -0.04285066947340965, mean p set: 0.44899022579193115The modified gen p mean: 0.44839754700660706, gen p mean: -0.039701517671346664, mean p set: 0.44887787103652954
loss_pred:0.015341083519160748, decouple_loss:0.0012087414506822824
loss_pred:0.016041632741689682, decouple_loss:0.0011283453786745667
Iteration: 2856, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44900307059288025, gen p mean: -0.03771253675222397, mean p set: 0.44948336482048035
loss_pred:0.016033632680773735, decouple_loss:0.0012851327192038298
The modified gen p mean: 0.449121356010437, gen p mean: -0.040120579302310944, mean p set: 0.4496016502380371The modified gen p mean: 0.45031341910362244, gen p mean: -0.03716174140572548, mean p set: 0.4507937431335449
loss_pred:0.015022721141576767, decouple_loss:0.0011293546995148063
loss_pred:0.01587030105292797, decouple_loss:0.0012718400685116649
Iteration: 2857, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500086009502411, gen p mean: -0.03194174915552139, mean p set: 0.4504888951778412
loss_pred:0.014738925732672215, decouple_loss:0.0010997932404279709
The modified gen p mean: 0.44833803176879883, gen p mean: -0.035312678664922714, mean p set: 0.44881829619407654The modified gen p mean: 0.447266161441803, gen p mean: -0.03844714164733887, mean p set: 0.44774648547172546
loss_pred:0.015589949674904346, decouple_loss:0.0010612251935526729
loss_pred:0.014479381032288074, decouple_loss:0.0011783614754676819
Iteration: 2858, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498549699783325, gen p mean: -0.026342574506998062, mean p set: 0.45033523440361023
loss_pred:0.015415087342262268, decouple_loss:0.0010108835995197296
The modified gen p mean: 0.45007216930389404, gen p mean: -0.03178958222270012, mean p set: 0.45055249333381653The modified gen p mean: 0.45067405700683594, gen p mean: -0.030798211693763733, mean p set: 0.45115435123443604
loss_pred:0.014582905918359756, decouple_loss:0.0010883166687563062
loss_pred:0.015732303261756897, decouple_loss:0.0010112422751262784
Iteration: 2859, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483879804611206, gen p mean: -0.03159850463271141, mean p set: 0.4488682746887207
loss_pred:0.01467406190931797, decouple_loss:0.001119967200793326
The modified gen p mean: 0.44778189063072205, gen p mean: -0.029116757214069366, mean p set: 0.44826221466064453The modified gen p mean: 0.44859281182289124, gen p mean: -0.03093392215669155, mean p set: 0.44907310605049133
loss_pred:0.01594439521431923, decouple_loss:0.0010118361096829176
loss_pred:0.015570061281323433, decouple_loss:0.001005376921966672
Iteration: 2860, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44774147868156433, gen p mean: -0.02624901756644249, mean p set: 0.44822174310684204
loss_pred:0.01607002131640911, decouple_loss:0.0011217641877010465
The modified gen p mean: 0.44747990369796753, gen p mean: -0.03590519353747368, mean p set: 0.4479601979255676The modified gen p mean: 0.44968751072883606, gen p mean: -0.023943258449435234, mean p set: 0.45016783475875854
loss_pred:0.014197849668562412, decouple_loss:0.001168099814094603
loss_pred:0.014804438687860966, decouple_loss:0.0011665159836411476
2023-05-02 13:26:35 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.04231641814112663, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.038235824555158615, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.03838469460606575, mean p set: 0.4500633478164673
loss_pred:0.01867133565247059, decouple_loss:0.0014446323039010167
loss_pred:0.017518077045679092, decouple_loss:0.0011325348168611526
loss_pred:0.01757747121155262, decouple_loss:0.0012326532742008567
WV_0_PC_1_EH_0_PS_40, loss: 0.017985792830586433, avg_mse: 0.02599819377064705
current test mse: 0.025998
Iteration: 2861, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481180012226105, gen p mean: -0.028932880610227585, mean p set: 0.4485982656478882
The modified gen p mean: 0.44818419218063354, gen p mean: -0.03216300904750824, mean p set: 0.44866451621055603
The modified gen p mean: 0.4497668147087097, gen p mean: -0.02918756939470768, mean p set: 0.4502470791339874
loss_pred:0.01582385040819645, decouple_loss:0.0012146434746682644
loss_pred:0.015959380194544792, decouple_loss:0.0010330523364245892
loss_pred:0.014909887686371803, decouple_loss:0.0011132429353892803
Iteration: 2862, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447834849357605, gen p mean: -0.03147462382912636, mean p set: 0.4483151137828827
loss_pred:0.015371591784060001, decouple_loss:0.0010255719535052776
The modified gen p mean: 0.45010942220687866, gen p mean: -0.02976948395371437, mean p set: 0.45058971643447876The modified gen p mean: 0.4489588439464569, gen p mean: -0.03305184468626976, mean p set: 0.449439138174057
loss_pred:0.014555609785020351, decouple_loss:0.001059030881151557
loss_pred:0.015275558456778526, decouple_loss:0.0009616581373848021
Iteration: 2863, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478376805782318, gen p mean: -0.034153785556554794, mean p set: 0.4483179748058319
loss_pred:0.015253887511789799, decouple_loss:0.001097086351364851
The modified gen p mean: 0.44734182953834534, gen p mean: -0.03267854079604149, mean p set: 0.44782212376594543The modified gen p mean: 0.4497023820877075, gen p mean: -0.026827840134501457, mean p set: 0.4501826763153076
loss_pred:0.01435911376029253, decouple_loss:0.0010555953485891223
loss_pred:0.015462708659470081, decouple_loss:0.0010245662415400147
Iteration: 2864, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45013856887817383, gen p mean: -0.03370756283402443, mean p set: 0.4506188929080963
loss_pred:0.014986722730100155, decouple_loss:0.0011273744748905301
The modified gen p mean: 0.4483886659145355, gen p mean: -0.03480161726474762, mean p set: 0.44886893033981323The modified gen p mean: 0.4502808153629303, gen p mean: -0.03346692770719528, mean p set: 0.4507611393928528
loss_pred:0.015328314155340195, decouple_loss:0.0011956171365454793
loss_pred:0.015565451234579086, decouple_loss:0.0012667211703956127
Iteration: 2865, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485941231250763, gen p mean: -0.038340143859386444, mean p set: 0.4490744471549988
loss_pred:0.015141057781875134, decouple_loss:0.0011287968372926116
The modified gen p mean: 0.4500276744365692, gen p mean: -0.03479771316051483, mean p set: 0.4505079984664917The modified gen p mean: 0.447441041469574, gen p mean: -0.03771152347326279, mean p set: 0.4479213356971741
loss_pred:0.01471534464508295, decouple_loss:0.0010993854375556111
loss_pred:0.01457832008600235, decouple_loss:0.0011139897396788
Iteration: 2866, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45040223002433777, gen p mean: -0.03577587753534317, mean p set: 0.45088252425193787
loss_pred:0.015110913664102554, decouple_loss:0.000973499147221446
The modified gen p mean: 0.44778764247894287, gen p mean: -0.040625229477882385, mean p set: 0.4482679069042206The modified gen p mean: 0.4498942792415619, gen p mean: -0.034211549907922745, mean p set: 0.4503746032714844
loss_pred:0.01510161254554987, decouple_loss:0.0010483846999704838
loss_pred:0.015229152515530586, decouple_loss:0.0009936423739418387
Iteration: 2867, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45023879408836365, gen p mean: -0.036675214767456055, mean p set: 0.45071908831596375
loss_pred:0.015354360453784466, decouple_loss:0.0012274240143597126
The modified gen p mean: 0.450177401304245, gen p mean: -0.036824386566877365, mean p set: 0.4506576955318451The modified gen p mean: 0.447522908449173, gen p mean: -0.03940612077713013, mean p set: 0.44800323247909546
loss_pred:0.01511904876679182, decouple_loss:0.001122445915825665
loss_pred:0.014939631335437298, decouple_loss:0.0011863871477544308
Iteration: 2868, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44817742705345154, gen p mean: -0.03569488972425461, mean p set: 0.44865772128105164
loss_pred:0.014990109018981457, decouple_loss:0.0011490780161693692
The modified gen p mean: 0.4505458474159241, gen p mean: -0.03560991957783699, mean p set: 0.4510261118412018
The modified gen p mean: 0.4506320655345917, gen p mean: -0.03492968529462814, mean p set: 0.45111238956451416
loss_pred:0.0145499799400568, decouple_loss:0.0010035649174824357
loss_pred:0.015610559843480587, decouple_loss:0.0012331019388511777
Iteration: 2869, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45001155138015747, gen p mean: -0.03905458375811577, mean p set: 0.45049184560775757
loss_pred:0.015504840761423111, decouple_loss:0.001040073693729937
The modified gen p mean: 0.4471459686756134, gen p mean: -0.03981614485383034, mean p set: 0.4476262331008911The modified gen p mean: 0.4473850131034851, gen p mean: -0.03489452227950096, mean p set: 0.4478653073310852
loss_pred:0.014113635756075382, decouple_loss:0.0011143459705635905
loss_pred:0.015376782044768333, decouple_loss:0.0010629795724526048
Iteration: 2870, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502868950366974, gen p mean: -0.033605657517910004, mean p set: 0.4507671892642975
loss_pred:0.015183478593826294, decouple_loss:0.0011774020968005061
The modified gen p mean: 0.44847986102104187, gen p mean: -0.03218367323279381, mean p set: 0.44896015524864197The modified gen p mean: 0.4498848617076874, gen p mean: -0.035697709769010544, mean p set: 0.4503651261329651
loss_pred:0.01569966971874237, decouple_loss:0.0010986203560605645
loss_pred:0.015094258822500706, decouple_loss:0.001128681586124003
2023-05-02 13:28:29 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.046767424792051315, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.042737461626529694, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.042731739580631256, mean p set: 0.4500633478164673
loss_pred:0.01880047470331192, decouple_loss:0.001145714893937111
loss_pred:0.017617451027035713, decouple_loss:0.0010915618622675538
loss_pred:0.017733139917254448, decouple_loss:0.0010889346012845635
WV_0_PC_1_EH_0_PS_40, loss: 0.01810579188168049, avg_mse: 0.026254447177052498
current test mse: 0.026254
Iteration: 2871, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498419165611267, gen p mean: -0.03582143038511276, mean p set: 0.4503222107887268
The modified gen p mean: 0.4484219253063202, gen p mean: -0.032799553126096725, mean p set: 0.4489021897315979
The modified gen p mean: 0.45012199878692627, gen p mean: -0.03846124932169914, mean p set: 0.45060229301452637
loss_pred:0.014744765125215054, decouple_loss:0.0009858999401330948
loss_pred:0.015123860910534859, decouple_loss:0.0010024692164734006
loss_pred:0.014877408742904663, decouple_loss:0.000992714543826878
Iteration: 2872, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4506209194660187, gen p mean: -0.03346031531691551, mean p set: 0.4511011838912964
loss_pred:0.015260588377714157, decouple_loss:0.0010314129758626223
The modified gen p mean: 0.44746989011764526, gen p mean: -0.03662974759936333, mean p set: 0.447950154542923The modified gen p mean: 0.45033779740333557, gen p mean: -0.03528013080358505, mean p set: 0.45081809163093567
loss_pred:0.015006382949650288, decouple_loss:0.0010501117212697864
loss_pred:0.015093359164893627, decouple_loss:0.0010062145302072167
Iteration: 2873, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481814205646515, gen p mean: -0.03830979764461517, mean p set: 0.4486616849899292
loss_pred:0.015788398683071136, decouple_loss:0.001023723161779344
The modified gen p mean: 0.448612242937088, gen p mean: -0.038714177906513214, mean p set: 0.4490925371646881The modified gen p mean: 0.44965460896492004, gen p mean: -0.03181413933634758, mean p set: 0.45013487339019775
loss_pred:0.014966259710490704, decouple_loss:0.0010770285734906793
loss_pred:0.015150045976042747, decouple_loss:0.0011361136566847563
Iteration: 2874, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44791412353515625, gen p mean: -0.03712748736143112, mean p set: 0.44839444756507874
loss_pred:0.014349461533129215, decouple_loss:0.001028811908327043
The modified gen p mean: 0.44740962982177734, gen p mean: -0.037067245692014694, mean p set: 0.44788995385169983The modified gen p mean: 0.44942232966423035, gen p mean: -0.038380302488803864, mean p set: 0.44990259408950806
loss_pred:0.014980265870690346, decouple_loss:0.0010156672215089202
loss_pred:0.014536801725625992, decouple_loss:0.0010329493088647723
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012017_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012017_3_24hr.npz
NaN value num: 0
Iteration: 2875, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4519518315792084, gen p mean: -0.03102000616490841, mean p set: 0.45243212580680847
loss_pred:0.015324997715651989, decouple_loss:0.001165104447863996
The modified gen p mean: 0.45136523246765137, gen p mean: -0.03629857301712036, mean p set: 0.4518454968929291The modified gen p mean: 0.4523071050643921, gen p mean: -0.03277776017785072, mean p set: 0.4527874290943146
loss_pred:0.015459481626749039, decouple_loss:0.0012046762276440859
loss_pred:0.015834063291549683, decouple_loss:0.001141392276622355
Iteration: 2876, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.451567679643631, gen p mean: -0.030084963887929916, mean p set: 0.4520479440689087
loss_pred:0.014936160296201706, decouple_loss:0.0011195510160177946
The modified gen p mean: 0.4496256113052368, gen p mean: -0.030167484655976295, mean p set: 0.4501059055328369The modified gen p mean: 0.45000511407852173, gen p mean: -0.03243561089038849, mean p set: 0.4504854083061218
loss_pred:0.01576262339949608, decouple_loss:0.0011457600630819798
loss_pred:0.015874188393354416, decouple_loss:0.0010431046830490232
Iteration: 2877, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45138242840766907, gen p mean: -0.03134087845683098, mean p set: 0.4518626928329468
loss_pred:0.015235436148941517, decouple_loss:0.0009320969111286104
The modified gen p mean: 0.45116686820983887, gen p mean: -0.032040201127529144, mean p set: 0.45164716243743896The modified gen p mean: 0.452606737613678, gen p mean: -0.03409601002931595, mean p set: 0.4530870020389557
loss_pred:0.015332517214119434, decouple_loss:0.0011225419584661722
loss_pred:0.015352936461567879, decouple_loss:0.000976276642177254
Iteration: 2878, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45196521282196045, gen p mean: -0.042561572045087814, mean p set: 0.45244550704956055
loss_pred:0.014657472260296345, decouple_loss:0.0011997319525107741
The modified gen p mean: 0.45215368270874023, gen p mean: -0.03161539137363434, mean p set: 0.4526340067386627The modified gen p mean: 0.4508665204048157, gen p mean: -0.039590850472450256, mean p set: 0.45134681463241577
loss_pred:0.01543551217764616, decouple_loss:0.001293933135457337
loss_pred:0.014917595311999321, decouple_loss:0.0011568479239940643
Iteration: 2879, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4515194892883301, gen p mean: -0.03435032442212105, mean p set: 0.45199981331825256
loss_pred:0.015055934898555279, decouple_loss:0.0010881352936848998
The modified gen p mean: 0.45300525426864624, gen p mean: -0.03678913041949272, mean p set: 0.4534855782985687The modified gen p mean: 0.4510996639728546, gen p mean: -0.037107933312654495, mean p set: 0.4515799880027771
loss_pred:0.015485668554902077, decouple_loss:0.0010914140148088336
loss_pred:0.015588125213980675, decouple_loss:0.001040062983520329
Iteration: 2880, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45213308930397034, gen p mean: -0.038571324199438095, mean p set: 0.45261338353157043
loss_pred:0.01573503017425537, decouple_loss:0.001045088516548276
The modified gen p mean: 0.4511058032512665, gen p mean: -0.04129038378596306, mean p set: 0.4515860676765442The modified gen p mean: 0.4520275294780731, gen p mean: -0.04291314259171486, mean p set: 0.4525078237056732
loss_pred:0.014979517087340355, decouple_loss:0.0010472888825461268
loss_pred:0.015416300855576992, decouple_loss:0.0011231678072363138
2023-05-02 13:31:20 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.0533413365483284, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04963144659996033, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04947476089000702, mean p set: 0.4500633478164673
loss_pred:0.01877462863922119, decouple_loss:0.0011051396140828729
loss_pred:0.017579978331923485, decouple_loss:0.0011951635824516416
loss_pred:0.01769336871802807, decouple_loss:0.001139264553785324
WV_0_PC_1_EH_0_PS_40, loss: 0.018073318526148796, avg_mse: 0.026186199858784676
current test mse: 0.026186
Iteration: 2881, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45214134454727173, gen p mean: -0.039786044508218765, mean p set: 0.4526216387748718
The modified gen p mean: 0.45013341307640076, gen p mean: -0.03990385681390762, mean p set: 0.45061367750167847
The modified gen p mean: 0.4520479142665863, gen p mean: -0.04865611717104912, mean p set: 0.4525282084941864
loss_pred:0.014591394923627377, decouple_loss:0.0010318347485736012
loss_pred:0.015733037143945694, decouple_loss:0.0010898696491494775
loss_pred:0.01559185516089201, decouple_loss:0.0010848328238353133
Iteration: 2882, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45136353373527527, gen p mean: -0.04308689385652542, mean p set: 0.45184382796287537
loss_pred:0.01488539855927229, decouple_loss:0.0010310348588973284
The modified gen p mean: 0.4494275450706482, gen p mean: -0.03876751288771629, mean p set: 0.4499078094959259The modified gen p mean: 0.4505527913570404, gen p mean: -0.041205063462257385, mean p set: 0.4510330855846405
loss_pred:0.015341822057962418, decouple_loss:0.0011033848859369755
loss_pred:0.015486940741539001, decouple_loss:0.0010881404159590602
Iteration: 2883, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4527052342891693, gen p mean: -0.042976103723049164, mean p set: 0.4531855285167694
loss_pred:0.015449922531843185, decouple_loss:0.0010701385326683521
The modified gen p mean: 0.4516157805919647, gen p mean: -0.04438022896647453, mean p set: 0.45209604501724243
The modified gen p mean: 0.44973111152648926, gen p mean: -0.041855961084365845, mean p set: 0.45021140575408936
loss_pred:0.015500818379223347, decouple_loss:0.0009991752449423075
loss_pred:0.015525237657129765, decouple_loss:0.0010101775405928493
Iteration: 2884, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4518470764160156, gen p mean: -0.04448550567030907, mean p set: 0.4523273706436157
loss_pred:0.015114465728402138, decouple_loss:0.0010307535994797945
The modified gen p mean: 0.4515424370765686, gen p mean: -0.045723166316747665, mean p set: 0.4520227611064911The modified gen p mean: 0.4515102803707123, gen p mean: -0.040791742503643036, mean p set: 0.4519905745983124
loss_pred:0.015150737017393112, decouple_loss:0.0010208688909187913
loss_pred:0.01598919741809368, decouple_loss:0.0009592330316081643
Iteration: 2885, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45109444856643677, gen p mean: -0.03987177088856697, mean p set: 0.45157474279403687
loss_pred:0.015261032618582249, decouple_loss:0.00103762187063694
The modified gen p mean: 0.45157450437545776, gen p mean: -0.0406886450946331, mean p set: 0.45205479860305786The modified gen p mean: 0.45201826095581055, gen p mean: -0.0434214249253273, mean p set: 0.45249855518341064
loss_pred:0.01565704494714737, decouple_loss:0.0010347440838813782
loss_pred:0.014898707158863544, decouple_loss:0.0009699884685687721
Iteration: 2886, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4512491524219513, gen p mean: -0.04086780548095703, mean p set: 0.451729416847229
loss_pred:0.015674667432904243, decouple_loss:0.0010048667900264263
The modified gen p mean: 0.4521905481815338, gen p mean: -0.04368356987833977, mean p set: 0.4526708424091339The modified gen p mean: 0.45119526982307434, gen p mean: -0.042742058634757996, mean p set: 0.4516755938529968
loss_pred:0.015102744102478027, decouple_loss:0.001091630314476788
loss_pred:0.015409950166940689, decouple_loss:0.0009792954660952091
Iteration: 2887, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500552713871002, gen p mean: -0.04254228249192238, mean p set: 0.45053553581237793
loss_pred:0.015634853392839432, decouple_loss:0.0013078396441414952
The modified gen p mean: 0.4516770541667938, gen p mean: -0.04214909300208092, mean p set: 0.4521573483943939The modified gen p mean: 0.45171889662742615, gen p mean: -0.0429111011326313, mean p set: 0.45219916105270386
loss_pred:0.01560792326927185, decouple_loss:0.0013321031583473086
loss_pred:0.01574077643454075, decouple_loss:0.0011161474976688623
Iteration: 2888, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.451391339302063, gen p mean: -0.03950175270438194, mean p set: 0.4518716335296631
loss_pred:0.015140397474169731, decouple_loss:0.0009450241341255605
The modified gen p mean: 0.45159995555877686, gen p mean: -0.039444487541913986, mean p set: 0.45208021998405457The modified gen p mean: 0.4522381126880646, gen p mean: -0.040635813027620316, mean p set: 0.4527184069156647
loss_pred:0.01507260836660862, decouple_loss:0.0010165724670514464
loss_pred:0.015312538482248783, decouple_loss:0.000998763251118362
Iteration: 2889, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4515809118747711, gen p mean: -0.0401812307536602, mean p set: 0.4520612061023712
loss_pred:0.015485696494579315, decouple_loss:0.0009808690520003438
The modified gen p mean: 0.45138177275657654, gen p mean: -0.040910497307777405, mean p set: 0.45186206698417664The modified gen p mean: 0.4518471956253052, gen p mean: -0.044735461473464966, mean p set: 0.4523274898529053
loss_pred:0.01588670164346695, decouple_loss:0.0009263528627343476
loss_pred:0.015161150135099888, decouple_loss:0.0010413475101813674
Iteration: 2890, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45214712619781494, gen p mean: -0.04241909831762314, mean p set: 0.45262742042541504
loss_pred:0.015282210893929005, decouple_loss:0.0011694494169205427
The modified gen p mean: 0.45156458020210266, gen p mean: -0.04046863690018654, mean p set: 0.45204487442970276The modified gen p mean: 0.4505445659160614, gen p mean: -0.04047512635588646, mean p set: 0.4510248601436615
loss_pred:0.014746458269655704, decouple_loss:0.0010050276760011911
loss_pred:0.015289817936718464, decouple_loss:0.0011234978446736932
2023-05-02 13:33:14 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.053572241216897964, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04983477666974068, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04968564584851265, mean p set: 0.4500633478164673
loss_pred:0.018782729282975197, decouple_loss:0.0011660963064059615
loss_pred:0.017603106796741486, decouple_loss:0.0011455632047727704
loss_pred:0.017713654786348343, decouple_loss:0.0011516958475112915
WV_0_PC_1_EH_0_PS_40, loss: 0.018090886995196342, avg_mse: 0.026242148131132126
current test mse: 0.026242
Iteration: 2891, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45160791277885437, gen p mean: -0.04024418070912361, mean p set: 0.45208823680877686
The modified gen p mean: 0.4520340859889984, gen p mean: -0.03904745355248451, mean p set: 0.4525144100189209
The modified gen p mean: 0.45214730501174927, gen p mean: -0.03568881005048752, mean p set: 0.452627569437027
loss_pred:0.015714196488261223, decouple_loss:0.0011931929038837552
loss_pred:0.014879118651151657, decouple_loss:0.0009544082568027079
loss_pred:0.01543358899652958, decouple_loss:0.0010188259184360504
Iteration: 2892, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4512441158294678, gen p mean: -0.04308614879846573, mean p set: 0.45172441005706787
loss_pred:0.015865085646510124, decouple_loss:0.0011902488768100739
The modified gen p mean: 0.45151078701019287, gen p mean: -0.0429467111825943, mean p set: 0.4519910514354706The modified gen p mean: 0.45209887623786926, gen p mean: -0.04255203530192375, mean p set: 0.452579140663147
loss_pred:0.015675127506256104, decouple_loss:0.001123350695706904
loss_pred:0.015148445032536983, decouple_loss:0.0011481340043246746
Iteration: 2893, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505493640899658, gen p mean: -0.04542873054742813, mean p set: 0.4510296881198883
loss_pred:0.01568153128027916, decouple_loss:0.0011848926078528166
The modified gen p mean: 0.4525078535079956, gen p mean: -0.04073287546634674, mean p set: 0.4529881477355957The modified gen p mean: 0.45163705945014954, gen p mean: -0.04257703572511673, mean p set: 0.45211732387542725
loss_pred:0.015507979318499565, decouple_loss:0.0013351698871701956
loss_pred:0.015386322513222694, decouple_loss:0.0011305449297651649
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012009_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012009_3_24hr.npz
NaN value num: 0
Iteration: 2894, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482758045196533, gen p mean: -0.04610872268676758, mean p set: 0.44875606894493103
loss_pred:0.01649743691086769, decouple_loss:0.0009706277051009238
The modified gen p mean: 0.4460969567298889, gen p mean: -0.048630133271217346, mean p set: 0.446577250957489The modified gen p mean: 0.4476662278175354, gen p mean: -0.048578206449747086, mean p set: 0.4481465220451355
loss_pred:0.016464723274111748, decouple_loss:0.0010120015358552337
loss_pred:0.016834594309329987, decouple_loss:0.0009872268419712782
Iteration: 2895, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44692352414131165, gen p mean: -0.05119956284761429, mean p set: 0.44740378856658936
loss_pred:0.01684417948126793, decouple_loss:0.0012260780204087496
The modified gen p mean: 0.4474089741706848, gen p mean: -0.047149159014225006, mean p set: 0.4478892683982849The modified gen p mean: 0.448119193315506, gen p mean: -0.056221380829811096, mean p set: 0.4485994875431061
loss_pred:0.016352862119674683, decouple_loss:0.0011614847462624311
loss_pred:0.01644173637032509, decouple_loss:0.001189214875921607
Iteration: 2896, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473631680011749, gen p mean: -0.050842851400375366, mean p set: 0.4478435218334198
loss_pred:0.01668448932468891, decouple_loss:0.0011065264698117971
The modified gen p mean: 0.4472668468952179, gen p mean: -0.053959500044584274, mean p set: 0.447747141122818The modified gen p mean: 0.44842782616615295, gen p mean: -0.0510399155318737, mean p set: 0.44890812039375305
loss_pred:0.016915543004870415, decouple_loss:0.0010573995532467961
loss_pred:0.016148852184414864, decouple_loss:0.0011266712099313736
Iteration: 2897, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44708481431007385, gen p mean: -0.05355769768357277, mean p set: 0.44756510853767395
loss_pred:0.016277404502034187, decouple_loss:0.0010242121061310172
The modified gen p mean: 0.44827449321746826, gen p mean: -0.047357138246297836, mean p set: 0.44875475764274597The modified gen p mean: 0.4468685984611511, gen p mean: -0.04846951737999916, mean p set: 0.44734886288642883
loss_pred:0.01675436645746231, decouple_loss:0.0010142498649656773
loss_pred:0.01623101718723774, decouple_loss:0.0010610207682475448
Iteration: 2898, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475695490837097, gen p mean: -0.05141230300068855, mean p set: 0.4480498135089874
loss_pred:0.016944441944360733, decouple_loss:0.0011008671717718244
The modified gen p mean: 0.4476235508918762, gen p mean: -0.05046158656477928, mean p set: 0.44810381531715393
The modified gen p mean: 0.446500301361084, gen p mean: -0.05018697306513786, mean p set: 0.44698062539100647
loss_pred:0.017084205523133278, decouple_loss:0.0011148368939757347
loss_pred:0.017174821346998215, decouple_loss:0.001119739725254476
Iteration: 2899, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466102421283722, gen p mean: -0.050717078149318695, mean p set: 0.4470905661582947
loss_pred:0.016993649303913116, decouple_loss:0.0010343313915655017
The modified gen p mean: 0.4494776129722595, gen p mean: -0.051847320050001144, mean p set: 0.449957937002182The modified gen p mean: 0.44702568650245667, gen p mean: -0.048817649483680725, mean p set: 0.4475059509277344
loss_pred:0.015764309093356133, decouple_loss:0.0011680861935019493
loss_pred:0.01658756285905838, decouple_loss:0.0011298113968223333
Iteration: 2900, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44688671827316284, gen p mean: -0.04920714348554611, mean p set: 0.44736701250076294
loss_pred:0.016950126737356186, decouple_loss:0.0009503680630587041
The modified gen p mean: 0.447566956281662, gen p mean: -0.04945999011397362, mean p set: 0.4480472505092621The modified gen p mean: 0.44779491424560547, gen p mean: -0.04903751239180565, mean p set: 0.44827520847320557
loss_pred:0.016232805326581, decouple_loss:0.001106446492485702
loss_pred:0.016776565462350845, decouple_loss:0.0010467027314007282
2023-05-02 13:36:15 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.05247970670461655, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.048452939838171005, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04845103248953819, mean p set: 0.4500633478164673
loss_pred:0.0185247752815485, decouple_loss:0.0011338903568685055
loss_pred:0.017417335882782936, decouple_loss:0.0012734411284327507
loss_pred:0.017553767189383507, decouple_loss:0.0011846323031932116
WV_0_PC_1_EH_0_PS_40, loss: 0.01789182797074318, avg_mse: 0.02583165280520916
current test mse: 0.025832
Iteration: 2901, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44676363468170166, gen p mean: -0.04796871170401573, mean p set: 0.44724392890930176
The modified gen p mean: 0.44580331444740295, gen p mean: -0.04597112908959389, mean p set: 0.44628363847732544
The modified gen p mean: 0.4492040276527405, gen p mean: -0.05142473056912422, mean p set: 0.4496842920780182
loss_pred:0.01565282791852951, decouple_loss:0.0011295733274891973
loss_pred:0.016575435176491737, decouple_loss:0.0011766322422772646
loss_pred:0.01652294583618641, decouple_loss:0.0010880368063226342
Iteration: 2902, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474189877510071, gen p mean: -0.0496770441532135, mean p set: 0.44789931178092957
The modified gen p mean: 0.44652819633483887, gen p mean: -0.04882894083857536, mean p set: 0.44700849056243896
loss_pred:0.016124989837408066, decouple_loss:0.001057269866578281
loss_pred:0.016454551368951797, decouple_loss:0.0009986727964133024
The modified gen p mean: 0.4485849440097809, gen p mean: -0.05239192396402359, mean p set: 0.449065238237381
loss_pred:0.016766073182225227, decouple_loss:0.001095160492695868
Iteration: 2903, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45010483264923096, gen p mean: -0.05039690062403679, mean p set: 0.45058512687683105
loss_pred:0.015936439856886864, decouple_loss:0.0010723622981458902
The modified gen p mean: 0.44769012928009033, gen p mean: -0.049654990434646606, mean p set: 0.44817039370536804The modified gen p mean: 0.4484081268310547, gen p mean: -0.05110229551792145, mean p set: 0.4488883912563324
loss_pred:0.016066402196884155, decouple_loss:0.0010810433886945248
loss_pred:0.016680307686328888, decouple_loss:0.0010522723896428943
Iteration: 2904, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44656431674957275, gen p mean: -0.05087853968143463, mean p set: 0.44704464077949524
loss_pred:0.015897249802947044, decouple_loss:0.0009168402175419033
The modified gen p mean: 0.44571542739868164, gen p mean: -0.04666085168719292, mean p set: 0.4461957514286041The modified gen p mean: 0.4462997615337372, gen p mean: -0.04881773889064789, mean p set: 0.4467800557613373
loss_pred:0.0161680169403553, decouple_loss:0.0009725644486024976
loss_pred:0.016965722665190697, decouple_loss:0.0009811263298615813
Iteration: 2905, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44796597957611084, gen p mean: -0.04670565575361252, mean p set: 0.44844627380371094
loss_pred:0.016780678182840347, decouple_loss:0.0011361852521076798
The modified gen p mean: 0.4488506615161896, gen p mean: -0.052588075399398804, mean p set: 0.4493309259414673The modified gen p mean: 0.4468705952167511, gen p mean: -0.04468431696295738, mean p set: 0.4473509192466736
loss_pred:0.016825173050165176, decouple_loss:0.0010333721293136477
loss_pred:0.016576308757066727, decouple_loss:0.0011287559755146503
Iteration: 2906, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44805100560188293, gen p mean: -0.04398601874709129, mean p set: 0.4485313296318054
loss_pred:0.016352560371160507, decouple_loss:0.0010037879692390561
The modified gen p mean: 0.4471374452114105, gen p mean: -0.04627981036901474, mean p set: 0.4476177394390106The modified gen p mean: 0.4486321806907654, gen p mean: -0.048563893884420395, mean p set: 0.4491124749183655
loss_pred:0.016154896467924118, decouple_loss:0.0010495709720999002
loss_pred:0.016313744708895683, decouple_loss:0.0011565290624275804
Iteration: 2907, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467245936393738, gen p mean: -0.047189563512802124, mean p set: 0.44720491766929626
loss_pred:0.016658427193760872, decouple_loss:0.0010341594461351633
The modified gen p mean: 0.44786548614501953, gen p mean: -0.0430099293589592, mean p set: 0.44834578037261963The modified gen p mean: 0.44856974482536316, gen p mean: -0.042824484407901764, mean p set: 0.44905006885528564
loss_pred:0.016508834436535835, decouple_loss:0.001022815122269094
loss_pred:0.016506703570485115, decouple_loss:0.0009851731592789292
Iteration: 2908, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474196135997772, gen p mean: -0.04826013371348381, mean p set: 0.4478999078273773
loss_pred:0.017275366932153702, decouple_loss:0.001077095395885408
The modified gen p mean: 0.44640520215034485, gen p mean: -0.04482588544487953, mean p set: 0.44688549637794495The modified gen p mean: 0.4482972025871277, gen p mean: -0.04665562883019447, mean p set: 0.4487774670124054
loss_pred:0.017667561769485474, decouple_loss:0.0011471264297142625
loss_pred:0.015679098665714264, decouple_loss:0.0010198864620178938
Iteration: 2909, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475644528865814, gen p mean: -0.04600699245929718, mean p set: 0.4480447769165039
loss_pred:0.01647351309657097, decouple_loss:0.0010346983326599002
The modified gen p mean: 0.4472569227218628, gen p mean: -0.049466393887996674, mean p set: 0.4477372169494629The modified gen p mean: 0.4481431543827057, gen p mean: -0.04506285861134529, mean p set: 0.4486234486103058
loss_pred:0.016663186252117157, decouple_loss:0.0009790370240807533
loss_pred:0.01660998724400997, decouple_loss:0.0010772042442113161
Iteration: 2910, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44800692796707153, gen p mean: -0.04283236712217331, mean p set: 0.44848722219467163
loss_pred:0.016049064695835114, decouple_loss:0.001044752774760127
The modified gen p mean: 0.4473225772380829, gen p mean: -0.05046502500772476, mean p set: 0.44780290126800537The modified gen p mean: 0.4470927119255066, gen p mean: -0.04948211461305618, mean p set: 0.4475730061531067
loss_pred:0.016757285222411156, decouple_loss:0.0009742348920553923
loss_pred:0.016397077590227127, decouple_loss:0.0010809904197230935
2023-05-02 13:38:09 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.05241521820425987, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.0480911023914814, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.0485265739262104, mean p set: 0.4500633478164673
loss_pred:0.018445400521159172, decouple_loss:0.0010894696461036801
loss_pred:0.017371272668242455, decouple_loss:0.0011328752152621746
loss_pred:0.017509885132312775, decouple_loss:0.001099655986763537
WV_0_PC_1_EH_0_PS_40, loss: 0.01783088594675064, avg_mse: 0.02572275884449482
current test mse: 0.025723
Iteration: 2911, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465142488479614, gen p mean: -0.046736057847738266, mean p set: 0.4469945430755615
The modified gen p mean: 0.44678249955177307, gen p mean: -0.04806901887059212, mean p set: 0.44726279377937317
The modified gen p mean: 0.44664105772972107, gen p mean: -0.04740714281797409, mean p set: 0.44712138175964355
loss_pred:0.016882777214050293, decouple_loss:0.001078501925803721
loss_pred:0.01660526730120182, decouple_loss:0.001040200935676694
loss_pred:0.017046291381120682, decouple_loss:0.0010577937355265021
Iteration: 2912, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471818208694458, gen p mean: -0.04632333666086197, mean p set: 0.4476620852947235
loss_pred:0.016507821157574654, decouple_loss:0.0010376203572377563
The modified gen p mean: 0.4491763710975647, gen p mean: -0.05260845646262169, mean p set: 0.4496566355228424The modified gen p mean: 0.4477561116218567, gen p mean: -0.053008951246738434, mean p set: 0.4482364058494568
loss_pred:0.016078291460871696, decouple_loss:0.001035336754284799
loss_pred:0.016366399824619293, decouple_loss:0.00103184103500098
Iteration: 2913, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465080201625824, gen p mean: -0.052786387503147125, mean p set: 0.4469883143901825
loss_pred:0.01633712835609913, decouple_loss:0.001103219110518694
The modified gen p mean: 0.44708743691444397, gen p mean: -0.050755225121974945, mean p set: 0.44756776094436646The modified gen p mean: 0.4469071924686432, gen p mean: -0.04956192895770073, mean p set: 0.4473875164985657
loss_pred:0.0168058592826128, decouple_loss:0.001011453801766038
loss_pred:0.016352875158190727, decouple_loss:0.0010846346849575639
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012012_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012012_3_24hr.npz
NaN value num: 0
Iteration: 2914, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45172998309135437, gen p mean: -0.04999887943267822, mean p set: 0.45221027731895447
loss_pred:0.015425104647874832, decouple_loss:0.0011787543771788478
The modified gen p mean: 0.4490496814250946, gen p mean: -0.04838532581925392, mean p set: 0.4495299756526947The modified gen p mean: 0.4498424828052521, gen p mean: -0.04561256617307663, mean p set: 0.4503227472305298
loss_pred:0.01603534258902073, decouple_loss:0.001221064361743629
loss_pred:0.015876509249210358, decouple_loss:0.0011266546789556742
Iteration: 2915, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45037803053855896, gen p mean: -0.04861214756965637, mean p set: 0.45085835456848145
loss_pred:0.015581751242280006, decouple_loss:0.0012088106013834476
The modified gen p mean: 0.4500104486942291, gen p mean: -0.053537797182798386, mean p set: 0.4504907429218292The modified gen p mean: 0.4494195878505707, gen p mean: -0.04901426285505295, mean p set: 0.44989991188049316
loss_pred:0.015844542533159256, decouple_loss:0.0012788053136318922
loss_pred:0.015538250096142292, decouple_loss:0.0012177586322650313
Iteration: 2916, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4519721269607544, gen p mean: -0.05065542832016945, mean p set: 0.4524524509906769
loss_pred:0.014752908609807491, decouple_loss:0.001030897838063538
The modified gen p mean: 0.4490959942340851, gen p mean: -0.049438536167144775, mean p set: 0.44957631826400757
The modified gen p mean: 0.4508315324783325, gen p mean: -0.05261934921145439, mean p set: 0.4513118267059326
loss_pred:0.015080305747687817, decouple_loss:0.0010405441280454397
loss_pred:0.01546604186296463, decouple_loss:0.001053174608387053
Iteration: 2917, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494835436344147, gen p mean: -0.04444298520684242, mean p set: 0.44996383786201477
loss_pred:0.015969913452863693, decouple_loss:0.0013753609964624047
The modified gen p mean: 0.4502831995487213, gen p mean: -0.04444709047675133, mean p set: 0.4507634937763214The modified gen p mean: 0.452386736869812, gen p mean: -0.04661890119314194, mean p set: 0.4528670310974121
loss_pred:0.014928219839930534, decouple_loss:0.001294233137741685
loss_pred:0.01559576764702797, decouple_loss:0.0013449977850541472
Iteration: 2918, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498869776725769, gen p mean: -0.04397570714354515, mean p set: 0.4503673017024994
loss_pred:0.014750942587852478, decouple_loss:0.0011645128251984715
The modified gen p mean: 0.4502578377723694, gen p mean: -0.04681861028075218, mean p set: 0.4507381319999695The modified gen p mean: 0.44950199127197266, gen p mean: -0.04374966025352478, mean p set: 0.44998228549957275
loss_pred:0.01516043022274971, decouple_loss:0.0012554010609164834
loss_pred:0.01550327055156231, decouple_loss:0.0011613895185291767
Iteration: 2919, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45040807127952576, gen p mean: -0.04900440201163292, mean p set: 0.45088836550712585
loss_pred:0.015301194973289967, decouple_loss:0.0011297630844637752
The modified gen p mean: 0.45145395398139954, gen p mean: -0.043726980686187744, mean p set: 0.45193424820899963The modified gen p mean: 0.4500272572040558, gen p mean: -0.04972019046545029, mean p set: 0.4505075514316559
loss_pred:0.015949906781315804, decouple_loss:0.0011076725786551833
loss_pred:0.015651486814022064, decouple_loss:0.0010903296060860157
Iteration: 2920, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508987367153168, gen p mean: -0.041799262166023254, mean p set: 0.45137903094291687
loss_pred:0.0160234197974205, decouple_loss:0.0014300324255600572
The modified gen p mean: 0.452571302652359, gen p mean: -0.04350682720541954, mean p set: 0.4530515968799591The modified gen p mean: 0.44869574904441833, gen p mean: -0.04472573474049568, mean p set: 0.44917601346969604
loss_pred:0.015403916127979755, decouple_loss:0.0012616150779649615
loss_pred:0.015400296077132225, decouple_loss:0.0011575674870982766
2023-05-02 13:40:48 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.0573650486767292, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.053073983639478683, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.05361655354499817, mean p set: 0.4500633478164673
loss_pred:0.01867864280939102, decouple_loss:0.0011977942194789648
loss_pred:0.017597399652004242, decouple_loss:0.0011330152628943324
loss_pred:0.017669010907411575, decouple_loss:0.001170740812085569
WV_0_PC_1_EH_0_PS_40, loss: 0.018040044233202934, avg_mse: 0.026120571419596672
current test mse: 0.026121
Iteration: 2921, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45038002729415894, gen p mean: -0.04827670753002167, mean p set: 0.4508603513240814
The modified gen p mean: 0.44978445768356323, gen p mean: -0.045809485018253326, mean p set: 0.4502647817134857
The modified gen p mean: 0.45023173093795776, gen p mean: -0.044897641986608505, mean p set: 0.45071205496788025
loss_pred:0.015577270649373531, decouple_loss:0.0010154463816434145
loss_pred:0.01543376687914133, decouple_loss:0.001087031327188015
loss_pred:0.015437646768987179, decouple_loss:0.0010408373782411218
Iteration: 2922, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44853904843330383, gen p mean: -0.05314399674534798, mean p set: 0.4490193724632263
loss_pred:0.014582940377295017, decouple_loss:0.0012248056009411812
The modified gen p mean: 0.45002520084381104, gen p mean: -0.04864945262670517, mean p set: 0.4505055248737335The modified gen p mean: 0.4481469690799713, gen p mean: -0.05372167378664017, mean p set: 0.4486272633075714
loss_pred:0.014951960183680058, decouple_loss:0.0012522946344688535
loss_pred:0.015257848426699638, decouple_loss:0.001251798588782549
Iteration: 2923, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488760232925415, gen p mean: -0.04867874085903168, mean p set: 0.4493563175201416
loss_pred:0.015439006499946117, decouple_loss:0.0010982429375872016
The modified gen p mean: 0.44874173402786255, gen p mean: -0.050637222826480865, mean p set: 0.44922199845314026
The modified gen p mean: 0.4533083140850067, gen p mean: -0.049179766327142715, mean p set: 0.4537885785102844
loss_pred:0.014239550568163395, decouple_loss:0.0010865910444408655
loss_pred:0.014824497513473034, decouple_loss:0.0010595665080472827
Iteration: 2924, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45096728205680847, gen p mean: -0.04638191685080528, mean p set: 0.4514475464820862
loss_pred:0.015664979815483093, decouple_loss:0.0012022359296679497
The modified gen p mean: 0.4493556320667267, gen p mean: -0.05360368639230728, mean p set: 0.4498359262943268The modified gen p mean: 0.4491751790046692, gen p mean: -0.04929369315505028, mean p set: 0.4496554732322693
loss_pred:0.015155809000134468, decouple_loss:0.001181615749374032
loss_pred:0.015243856236338615, decouple_loss:0.0011424778494983912
Iteration: 2925, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45253437757492065, gen p mean: -0.05087814852595329, mean p set: 0.45301464200019836
loss_pred:0.014629549346864223, decouple_loss:0.0010860865004360676
The modified gen p mean: 0.44947826862335205, gen p mean: -0.05652244761586189, mean p set: 0.4499586224555969The modified gen p mean: 0.4521687626838684, gen p mean: -0.048548366874456406, mean p set: 0.4526490569114685
loss_pred:0.014850655570626259, decouple_loss:0.001075472217053175
loss_pred:0.014752372168004513, decouple_loss:0.001122724381275475
Iteration: 2926, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45121529698371887, gen p mean: -0.04935722425580025, mean p set: 0.45169559121131897
loss_pred:0.015664169564843178, decouple_loss:0.001077249413356185
The modified gen p mean: 0.4497430920600891, gen p mean: -0.05283926799893379, mean p set: 0.4502233564853668The modified gen p mean: 0.4522729516029358, gen p mean: -0.05099061504006386, mean p set: 0.4527532756328583
loss_pred:0.014938737265765667, decouple_loss:0.0009552466217428446
loss_pred:0.015271823853254318, decouple_loss:0.0010694452794268727
Iteration: 2927, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44925764203071594, gen p mean: -0.04607409983873367, mean p set: 0.44973790645599365
loss_pred:0.014987841248512268, decouple_loss:0.0010836842702701688
The modified gen p mean: 0.44999271631240845, gen p mean: -0.051018763333559036, mean p set: 0.45047301054000854The modified gen p mean: 0.44954437017440796, gen p mean: -0.04644244536757469, mean p set: 0.45002463459968567
loss_pred:0.01573597639799118, decouple_loss:0.001072642276994884
loss_pred:0.014771385118365288, decouple_loss:0.001112607424147427
Iteration: 2928, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44951504468917847, gen p mean: -0.045630134642124176, mean p set: 0.44999533891677856
loss_pred:0.015245095826685429, decouple_loss:0.0010023475624620914
The modified gen p mean: 0.45165199041366577, gen p mean: -0.04809768870472908, mean p set: 0.45213228464126587The modified gen p mean: 0.4503077566623688, gen p mean: -0.045219410210847855, mean p set: 0.45078805088996887
loss_pred:0.014611294493079185, decouple_loss:0.0011265474604442716
loss_pred:0.01532870251685381, decouple_loss:0.0010492171859368682
Iteration: 2929, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450383722782135, gen p mean: -0.043862491846084595, mean p set: 0.4508640468120575
loss_pred:0.0148561866953969, decouple_loss:0.0011044779093936086
The modified gen p mean: 0.4498305916786194, gen p mean: -0.04012672230601311, mean p set: 0.4503108859062195The modified gen p mean: 0.45147770643234253, gen p mean: -0.04824807122349739, mean p set: 0.4519580006599426
loss_pred:0.015165341086685658, decouple_loss:0.0010514629539102316
loss_pred:0.015569370239973068, decouple_loss:0.0011235582642257214
Iteration: 2930, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493119716644287, gen p mean: -0.045786987990140915, mean p set: 0.4497922658920288
loss_pred:0.015328298322856426, decouple_loss:0.0011301713529974222
The modified gen p mean: 0.45013538002967834, gen p mean: -0.041586533188819885, mean p set: 0.45061564445495605
The modified gen p mean: 0.45019587874412537, gen p mean: -0.04256991669535637, mean p set: 0.45067617297172546
loss_pred:0.014614026993513107, decouple_loss:0.0011205518385395408
loss_pred:0.014857420697808266, decouple_loss:0.0011641274904832244
2023-05-02 13:42:42 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.05069917067885399, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04658994451165199, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04681268334388733, mean p set: 0.4500633478164673
loss_pred:0.018739882856607437, decouple_loss:0.0012166542001068592
loss_pred:0.017667977139353752, decouple_loss:0.0010825637727975845
loss_pred:0.017747702077031136, decouple_loss:0.0011485308641567826
WV_0_PC_1_EH_0_PS_40, loss: 0.018109317868947983, avg_mse: 0.026255477219820023
current test mse: 0.026255
Iteration: 2931, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44931164383888245, gen p mean: -0.040079131722450256, mean p set: 0.44979190826416016
The modified gen p mean: 0.4486158788204193, gen p mean: -0.04027161747217178, mean p set: 0.4490962028503418
The modified gen p mean: 0.4501749277114868, gen p mean: -0.04703931882977486, mean p set: 0.4506552517414093
loss_pred:0.015628889203071594, decouple_loss:0.0011522287968546152
loss_pred:0.015270834788680077, decouple_loss:0.0010144878178834915
loss_pred:0.015531552955508232, decouple_loss:0.0010559945367276669
Iteration: 2932, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45020461082458496, gen p mean: -0.04177810996770859, mean p set: 0.45068490505218506
loss_pred:0.015079363249242306, decouple_loss:0.0011201120214536786
The modified gen p mean: 0.4496683180332184, gen p mean: -0.038192879408597946, mean p set: 0.4501486122608185The modified gen p mean: 0.4499151408672333, gen p mean: -0.04595908895134926, mean p set: 0.450395405292511
loss_pred:0.014557436108589172, decouple_loss:0.0011074974900111556
loss_pred:0.015206444077193737, decouple_loss:0.0011399831855669618
Iteration: 2933, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.452502965927124, gen p mean: -0.038355160504579544, mean p set: 0.4529832601547241
loss_pred:0.01434254553169012, decouple_loss:0.001037454348988831
The modified gen p mean: 0.4495808780193329, gen p mean: -0.045255761593580246, mean p set: 0.450061172246933The modified gen p mean: 0.45056042075157166, gen p mean: -0.040244556963443756, mean p set: 0.45104068517684937
loss_pred:0.015766287222504616, decouple_loss:0.0010955710895359516
loss_pred:0.015199574641883373, decouple_loss:0.0010746080661192536
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012006_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012006_3_24hr.npz
NaN value num: 0
Iteration: 2934, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44884926080703735, gen p mean: -0.04332088306546211, mean p set: 0.44932955503463745
loss_pred:0.014493771828711033, decouple_loss:0.0010063564404845238
The modified gen p mean: 0.4499695599079132, gen p mean: -0.04729180037975311, mean p set: 0.4504498541355133The modified gen p mean: 0.4478321671485901, gen p mean: -0.043273888528347015, mean p set: 0.4483124613761902
loss_pred:0.013897363096475601, decouple_loss:0.001057318295352161
loss_pred:0.01364687830209732, decouple_loss:0.0010817450238391757
Iteration: 2935, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485422968864441, gen p mean: -0.0501321516931057, mean p set: 0.4490225911140442
loss_pred:0.013896342366933823, decouple_loss:0.001130768097937107
The modified gen p mean: 0.44858604669570923, gen p mean: -0.054862067103385925, mean p set: 0.4490663409233093The modified gen p mean: 0.4483506977558136, gen p mean: -0.05149811878800392, mean p set: 0.4488309919834137
loss_pred:0.014163029380142689, decouple_loss:0.0012776205549016595
loss_pred:0.01360952015966177, decouple_loss:0.0011131666833534837
Iteration: 2936, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44782355427742004, gen p mean: -0.052006758749485016, mean p set: 0.44830384850502014
loss_pred:0.013378772884607315, decouple_loss:0.0011081662960350513
The modified gen p mean: 0.44793662428855896, gen p mean: -0.05006011202931404, mean p set: 0.44841691851615906The modified gen p mean: 0.4471559524536133, gen p mean: -0.05769898742437363, mean p set: 0.4476362466812134
loss_pred:0.013438509777188301, decouple_loss:0.0010414086282253265
loss_pred:0.014098313637077808, decouple_loss:0.0011768435360863805
Iteration: 2937, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489496946334839, gen p mean: -0.054544597864151, mean p set: 0.449429988861084
loss_pred:0.013987737707793713, decouple_loss:0.0012823385186493397
The modified gen p mean: 0.44808340072631836, gen p mean: -0.057493552565574646, mean p set: 0.44856372475624084The modified gen p mean: 0.4474776089191437, gen p mean: -0.06315366178750992, mean p set: 0.4479579031467438
loss_pred:0.013682005926966667, decouple_loss:0.0011539511615410447
loss_pred:0.013429018668830395, decouple_loss:0.0014728226233273745
Iteration: 2938, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486697316169739, gen p mean: -0.06383062899112701, mean p set: 0.449150025844574
loss_pred:0.013425029814243317, decouple_loss:0.0010489223059266806
The modified gen p mean: 0.447337806224823, gen p mean: -0.05941653624176979, mean p set: 0.4478180706501007The modified gen p mean: 0.44877612590789795, gen p mean: -0.0584857352077961, mean p set: 0.44925642013549805
loss_pred:0.013704991899430752, decouple_loss:0.0013015253935009241
loss_pred:0.013750518672168255, decouple_loss:0.0011448541190475225
Iteration: 2939, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476096034049988, gen p mean: -0.0579562783241272, mean p set: 0.4480898678302765
loss_pred:0.013780377805233002, decouple_loss:0.001275779795832932
The modified gen p mean: 0.44944050908088684, gen p mean: -0.057269759476184845, mean p set: 0.44992080330848694The modified gen p mean: 0.44881996512413025, gen p mean: -0.06031295284628868, mean p set: 0.44930025935173035
loss_pred:0.013998777605593204, decouple_loss:0.0013375120470300317
loss_pred:0.013431528583168983, decouple_loss:0.0011533627985045314
Iteration: 2940, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497270882129669, gen p mean: -0.05574129894375801, mean p set: 0.450207382440567
loss_pred:0.013647612184286118, decouple_loss:0.0011931253829970956
The modified gen p mean: 0.44882193207740784, gen p mean: -0.050145477056503296, mean p set: 0.44930222630500793The modified gen p mean: 0.4487152397632599, gen p mean: -0.048352353274822235, mean p set: 0.44919553399086
loss_pred:0.013801406137645245, decouple_loss:0.0011968630133196712
loss_pred:0.013978451490402222, decouple_loss:0.0011894121998921037
2023-05-02 13:45:22 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.05496934801340103, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.05053234100341797, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.0507424995303154, mean p set: 0.4500633478164673
loss_pred:0.019025830551981926, decouple_loss:0.0012388373725116253
loss_pred:0.017933042719960213, decouple_loss:0.0011900558602064848
loss_pred:0.017983004450798035, decouple_loss:0.0012444336898624897
WV_0_PC_1_EH_0_PS_40, loss: 0.018375180661678314, avg_mse: 0.02677248604595661
current test mse: 0.026772
Iteration: 2941, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481826722621918, gen p mean: -0.05248817801475525, mean p set: 0.44866296648979187
The modified gen p mean: 0.4491414427757263, gen p mean: -0.04714442789554596, mean p set: 0.4496217370033264
The modified gen p mean: 0.44923076033592224, gen p mean: -0.0443694032728672, mean p set: 0.44971105456352234
loss_pred:0.013681402429938316, decouple_loss:0.0011426208075135946
loss_pred:0.013645216822624207, decouple_loss:0.001363342977128923
loss_pred:0.013531001284718513, decouple_loss:0.0011593709932640195
Iteration: 2942, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44857487082481384, gen p mean: -0.047728292644023895, mean p set: 0.44905519485473633
loss_pred:0.013452365063130856, decouple_loss:0.001155996578745544
The modified gen p mean: 0.44895660877227783, gen p mean: -0.04917945712804794, mean p set: 0.44943690299987793The modified gen p mean: 0.4494444727897644, gen p mean: -0.049645036458969116, mean p set: 0.4499247372150421
loss_pred:0.013375833630561829, decouple_loss:0.0012527586659416556
loss_pred:0.013197021558880806, decouple_loss:0.0012058996362611651
Iteration: 2943, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480079710483551, gen p mean: -0.04940266162157059, mean p set: 0.4484882652759552
loss_pred:0.013353301212191582, decouple_loss:0.0010604183189570904
The modified gen p mean: 0.4479890763759613, gen p mean: -0.054998453706502914, mean p set: 0.448469340801239The modified gen p mean: 0.4484231173992157, gen p mean: -0.04786596819758415, mean p set: 0.4489034116268158
loss_pred:0.013410096988081932, decouple_loss:0.0011456911452114582
loss_pred:0.01329098828136921, decouple_loss:0.001221782760694623
Iteration: 2944, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501950442790985, gen p mean: -0.04888911917805672, mean p set: 0.4506753385066986
loss_pred:0.013556346297264099, decouple_loss:0.0011614218819886446
The modified gen p mean: 0.4487597942352295, gen p mean: -0.05148560181260109, mean p set: 0.4492400586605072The modified gen p mean: 0.4488055109977722, gen p mean: -0.04974629729986191, mean p set: 0.4492858350276947
loss_pred:0.013971786946058273, decouple_loss:0.001156897866167128
loss_pred:0.013404209166765213, decouple_loss:0.0011787381954491138
Iteration: 2945, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44761672616004944, gen p mean: -0.04846835136413574, mean p set: 0.4480970501899719
loss_pred:0.013273925520479679, decouple_loss:0.0011714716674759984
The modified gen p mean: 0.44835829734802246, gen p mean: -0.05671437084674835, mean p set: 0.44883859157562256The modified gen p mean: 0.44849705696105957, gen p mean: -0.05107162147760391, mean p set: 0.44897738099098206
loss_pred:0.013252726756036282, decouple_loss:0.001164334244094789
loss_pred:0.013096540234982967, decouple_loss:0.0011104505974799395
Iteration: 2946, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44945159554481506, gen p mean: -0.053240012377500534, mean p set: 0.44993188977241516
loss_pred:0.013278471305966377, decouple_loss:0.0012532684486359358
The modified gen p mean: 0.44840681552886963, gen p mean: -0.055362749844789505, mean p set: 0.4488871097564697The modified gen p mean: 0.4484025537967682, gen p mean: -0.05196145921945572, mean p set: 0.4488828480243683
loss_pred:0.013415589928627014, decouple_loss:0.001402685302309692
loss_pred:0.013402177952229977, decouple_loss:0.0013523930683732033
Iteration: 2947, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449179083108902, gen p mean: -0.05309867858886719, mean p set: 0.44965940713882446
loss_pred:0.013082828372716904, decouple_loss:0.0012400131672620773
The modified gen p mean: 0.44971179962158203, gen p mean: -0.05489426851272583, mean p set: 0.45019209384918213The modified gen p mean: 0.4476868510246277, gen p mean: -0.04984862729907036, mean p set: 0.4481671154499054
loss_pred:0.013677782379090786, decouple_loss:0.001200445112772286
loss_pred:0.013383513316512108, decouple_loss:0.001076442888006568
Iteration: 2948, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44865065813064575, gen p mean: -0.05365195497870445, mean p set: 0.44913092255592346
loss_pred:0.013444154523313046, decouple_loss:0.0011387965641915798
The modified gen p mean: 0.4481617510318756, gen p mean: -0.054913341999053955, mean p set: 0.4486420452594757The modified gen p mean: 0.44792136549949646, gen p mean: -0.050961051136255264, mean p set: 0.44840162992477417
loss_pred:0.0136758117005229, decouple_loss:0.00133428699336946
loss_pred:0.013330425135791302, decouple_loss:0.001176349469460547
Iteration: 2949, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44897907972335815, gen p mean: -0.054582543671131134, mean p set: 0.44945937395095825
loss_pred:0.012801092118024826, decouple_loss:0.001039951923303306
The modified gen p mean: 0.44877639412879944, gen p mean: -0.05100705474615097, mean p set: 0.4492567181587219The modified gen p mean: 0.4480856955051422, gen p mean: -0.05347241088747978, mean p set: 0.4485659599304199
loss_pred:0.013356487266719341, decouple_loss:0.0010432478738948703
loss_pred:0.013249486684799194, decouple_loss:0.0011857092613354325
Iteration: 2950, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477083086967468, gen p mean: -0.04568410664796829, mean p set: 0.4481886029243469
loss_pred:0.013303392566740513, decouple_loss:0.0011597482953220606
The modified gen p mean: 0.44784513115882874, gen p mean: -0.05072019249200821, mean p set: 0.44832542538642883The modified gen p mean: 0.4485883414745331, gen p mean: -0.049669355154037476, mean p set: 0.4490686058998108
loss_pred:0.013268444687128067, decouple_loss:0.0011566911125555634
loss_pred:0.0139998160302639, decouple_loss:0.0012031298829242587
2023-05-02 13:47:16 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.05247785151004791, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.048094697296619415, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.048324067145586014, mean p set: 0.4500633478164673
loss_pred:0.01904117874801159, decouple_loss:0.0010480006458237767
loss_pred:0.017924465239048004, decouple_loss:0.0011372588342055678
loss_pred:0.017963221296668053, decouple_loss:0.0010895683662965894
WV_0_PC_1_EH_0_PS_40, loss: 0.018364204093813896, avg_mse: 0.026780039072036743
current test mse: 0.02678
Iteration: 2951, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492274224758148, gen p mean: -0.050924912095069885, mean p set: 0.4497077465057373
The modified gen p mean: 0.4474453926086426, gen p mean: -0.056001853197813034, mean p set: 0.4479256868362427
The modified gen p mean: 0.4484126567840576, gen p mean: -0.05221802368760109, mean p set: 0.4488929510116577
loss_pred:0.013497511856257915, decouple_loss:0.0011299563338980079
loss_pred:0.013049468398094177, decouple_loss:0.0011777338804677129
loss_pred:0.013259016908705235, decouple_loss:0.0012357729719951749
Iteration: 2952, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491707384586334, gen p mean: -0.055831730365753174, mean p set: 0.4496510326862335
loss_pred:0.013193123042583466, decouple_loss:0.001186892157420516
The modified gen p mean: 0.44868406653404236, gen p mean: -0.0484345518052578, mean p set: 0.44916436076164246The modified gen p mean: 0.4481750726699829, gen p mean: -0.05391944572329521, mean p set: 0.4486553370952606
loss_pred:0.013216766528785229, decouple_loss:0.0010111816227436066
loss_pred:0.013066080398857594, decouple_loss:0.001154111116193235
Iteration: 2953, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485201835632324, gen p mean: -0.05227162316441536, mean p set: 0.44900044798851013
The modified gen p mean: 0.4479455053806305, gen p mean: -0.054956648498773575, mean p set: 0.4484257698059082
loss_pred:0.013162960298359394, decouple_loss:0.0010831548133864999
loss_pred:0.013132595457136631, decouple_loss:0.0010612246114760637
The modified gen p mean: 0.44786936044692993, gen p mean: -0.05130172148346901, mean p set: 0.44834965467453003
loss_pred:0.013371272943913937, decouple_loss:0.0012090373784303665
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012010_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012010_3_24hr.npz
NaN value num: 0
Iteration: 2954, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450306236743927, gen p mean: -0.05193036049604416, mean p set: 0.4507865309715271
loss_pred:0.015551073476672173, decouple_loss:0.0010782575700432062
The modified gen p mean: 0.44879794120788574, gen p mean: -0.04956195503473282, mean p set: 0.44927823543548584The modified gen p mean: 0.45217272639274597, gen p mean: -0.04899001494050026, mean p set: 0.45265302062034607
loss_pred:0.01625547930598259, decouple_loss:0.001118508749641478
loss_pred:0.015583773143589497, decouple_loss:0.0011074700159952044
Iteration: 2955, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508441686630249, gen p mean: -0.04436836019158363, mean p set: 0.4513244926929474
loss_pred:0.016567179933190346, decouple_loss:0.001184546505101025
The modified gen p mean: 0.4501175582408905, gen p mean: -0.043928682804107666, mean p set: 0.4505978226661682
The modified gen p mean: 0.4509161710739136, gen p mean: -0.04500754550099373, mean p set: 0.45139649510383606
loss_pred:0.015816019847989082, decouple_loss:0.0011651011882349849
loss_pred:0.016369298100471497, decouple_loss:0.001360253430902958
Iteration: 2956, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45096108317375183, gen p mean: -0.044657278805971146, mean p set: 0.45144134759902954
loss_pred:0.01560604851692915, decouple_loss:0.0011411451268941164
The modified gen p mean: 0.4508654475212097, gen p mean: -0.043259523808956146, mean p set: 0.4513457417488098The modified gen p mean: 0.4510484039783478, gen p mean: -0.042764972895383835, mean p set: 0.45152872800827026
loss_pred:0.015703266486525536, decouple_loss:0.0011230976087972522
loss_pred:0.016731008887290955, decouple_loss:0.0011993527878075838
Iteration: 2957, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45150989294052124, gen p mean: -0.04047146067023277, mean p set: 0.45199018716812134
loss_pred:0.015666794031858444, decouple_loss:0.0010964339599013329
The modified gen p mean: 0.45143741369247437, gen p mean: -0.0396554060280323, mean p set: 0.4519176781177521The modified gen p mean: 0.4508810043334961, gen p mean: -0.04129091277718544, mean p set: 0.4513612687587738
loss_pred:0.015127354301512241, decouple_loss:0.0011685508070513606
loss_pred:0.015522796660661697, decouple_loss:0.0011989208869636059
Iteration: 2958, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504936635494232, gen p mean: -0.04236946254968643, mean p set: 0.4509739875793457
The modified gen p mean: 0.4503532350063324, gen p mean: -0.04346916452050209, mean p set: 0.4508335292339325
loss_pred:0.016015009954571724, decouple_loss:0.001154302153736353
loss_pred:0.016120711341500282, decouple_loss:0.0011320345802232623
The modified gen p mean: 0.45091378688812256, gen p mean: -0.041810933500528336, mean p set: 0.45139408111572266
loss_pred:0.01578821800649166, decouple_loss:0.0011432874016463757
Iteration: 2959, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45057135820388794, gen p mean: -0.046636223793029785, mean p set: 0.4510516822338104
loss_pred:0.01586966961622238, decouple_loss:0.0011261546751484275
The modified gen p mean: 0.449104905128479, gen p mean: -0.046395882964134216, mean p set: 0.4495851993560791The modified gen p mean: 0.45102566480636597, gen p mean: -0.043744634836912155, mean p set: 0.45150595903396606
loss_pred:0.016081783920526505, decouple_loss:0.001214263611473143
loss_pred:0.015618303790688515, decouple_loss:0.0012294560438022017
Iteration: 2960, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450673371553421, gen p mean: -0.0449180044233799, mean p set: 0.4511536657810211
loss_pred:0.015155672095716, decouple_loss:0.001105239032767713
The modified gen p mean: 0.4506233036518097, gen p mean: -0.04868562892079353, mean p set: 0.4511035680770874The modified gen p mean: 0.4497883915901184, gen p mean: -0.04824541509151459, mean p set: 0.4502687156200409
loss_pred:0.016272185370326042, decouple_loss:0.001087940763682127
loss_pred:0.015675324946641922, decouple_loss:0.0011224866611883044
2023-05-02 13:49:55 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.053257159888744354, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.049312010407447815, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.049345020204782486, mean p set: 0.4500633478164673
loss_pred:0.018736256286501884, decouple_loss:0.0011775187449529767
loss_pred:0.017675595358014107, decouple_loss:0.0012091632233932614
loss_pred:0.017723890021443367, decouple_loss:0.001188072026707232
WV_0_PC_1_EH_0_PS_40, loss: 0.018104827031493187, avg_mse: 0.026253098621964455
current test mse: 0.026253
Iteration: 2961, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45035356283187866, gen p mean: -0.04730065166950226, mean p set: 0.45083388686180115
The modified gen p mean: 0.45015034079551697, gen p mean: -0.05100720375776291, mean p set: 0.45063063502311707
The modified gen p mean: 0.451200932264328, gen p mean: -0.04298241063952446, mean p set: 0.4516811966896057
loss_pred:0.015656430274248123, decouple_loss:0.0011721514165401459
loss_pred:0.016101785004138947, decouple_loss:0.0010670013725757599
loss_pred:0.015504615381360054, decouple_loss:0.0011253466363996267
Iteration: 2962, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450674831867218, gen p mean: -0.053997673094272614, mean p set: 0.4511551260948181
loss_pred:0.01656801998615265, decouple_loss:0.0010493914596736431
The modified gen p mean: 0.45126527547836304, gen p mean: -0.047908883541822433, mean p set: 0.45174556970596313The modified gen p mean: 0.4503457248210907, gen p mean: -0.047888677567243576, mean p set: 0.4508259892463684
loss_pred:0.01605721190571785, decouple_loss:0.0010092210723087192
loss_pred:0.015107625164091587, decouple_loss:0.0010488440748304129
Iteration: 2963, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503021240234375, gen p mean: -0.0473693311214447, mean p set: 0.45078244805336
loss_pred:0.015761353075504303, decouple_loss:0.0010347471106797457
The modified gen p mean: 0.45113706588745117, gen p mean: -0.04666288569569588, mean p set: 0.45161738991737366The modified gen p mean: 0.45011213421821594, gen p mean: -0.04975522682070732, mean p set: 0.4505924582481384
loss_pred:0.015245543792843819, decouple_loss:0.0010811975225806236
loss_pred:0.015650123357772827, decouple_loss:0.0011031321482732892
Iteration: 2964, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487875998020172, gen p mean: -0.04198923707008362, mean p set: 0.4492678940296173
loss_pred:0.01572933979332447, decouple_loss:0.0010405064094811678
The modified gen p mean: 0.4508184790611267, gen p mean: -0.03906356543302536, mean p set: 0.4512987732887268The modified gen p mean: 0.4503123164176941, gen p mean: -0.047078926116228104, mean p set: 0.4507925808429718
loss_pred:0.015555733814835548, decouple_loss:0.001110391691327095
loss_pred:0.015329545363783836, decouple_loss:0.0011900931131094694
Iteration: 2965, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508250951766968, gen p mean: -0.035659268498420715, mean p set: 0.4513053894042969
loss_pred:0.015354186296463013, decouple_loss:0.0009790383046492934
The modified gen p mean: 0.4500894844532013, gen p mean: -0.04515328258275986, mean p set: 0.4505697786808014The modified gen p mean: 0.45059025287628174, gen p mean: -0.03654402121901512, mean p set: 0.4510705769062042
loss_pred:0.016683926805853844, decouple_loss:0.0010504365200176835
loss_pred:0.015376896597445011, decouple_loss:0.0010094710160046816
Iteration: 2966, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45070645213127136, gen p mean: -0.0371851809322834, mean p set: 0.4511867165565491
loss_pred:0.01656840741634369, decouple_loss:0.0012322758557274938
The modified gen p mean: 0.4505552351474762, gen p mean: -0.03542674705386162, mean p set: 0.4510355293750763The modified gen p mean: 0.4512858986854553, gen p mean: -0.03711242973804474, mean p set: 0.45176616311073303
loss_pred:0.015517458319664001, decouple_loss:0.0011015809141099453
loss_pred:0.015806734561920166, decouple_loss:0.001116391853429377
Iteration: 2967, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44988858699798584, gen p mean: -0.045511797070503235, mean p set: 0.4503689110279083
loss_pred:0.01599743962287903, decouple_loss:0.001162253669463098
The modified gen p mean: 0.45252034068107605, gen p mean: -0.039670489728450775, mean p set: 0.45300063490867615The modified gen p mean: 0.45091500878334045, gen p mean: -0.03809602931141853, mean p set: 0.45139533281326294
loss_pred:0.015622609294950962, decouple_loss:0.0010778448777273297
loss_pred:0.015126360580325127, decouple_loss:0.0011402829550206661
Iteration: 2968, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503781795501709, gen p mean: -0.036974113434553146, mean p set: 0.450858473777771
loss_pred:0.016282739117741585, decouple_loss:0.0010078886989504099
The modified gen p mean: 0.4511512517929077, gen p mean: -0.03955301269888878, mean p set: 0.4516315758228302The modified gen p mean: 0.4498027265071869, gen p mean: -0.04255650192499161, mean p set: 0.450283020734787
loss_pred:0.016162613406777382, decouple_loss:0.00102190300822258
loss_pred:0.015536518767476082, decouple_loss:0.0010471099521964788
Iteration: 2969, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500940144062042, gen p mean: -0.043070223182439804, mean p set: 0.4505743086338043
loss_pred:0.01625346578657627, decouple_loss:0.0009941208409145474
The modified gen p mean: 0.4513743817806244, gen p mean: -0.03824710100889206, mean p set: 0.4518546462059021The modified gen p mean: 0.45080429315567017, gen p mean: -0.049582961946725845, mean p set: 0.45128458738327026
loss_pred:0.015862708911299706, decouple_loss:0.001046455348841846
loss_pred:0.01627168618142605, decouple_loss:0.0011677334550768137
Iteration: 2970, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45000413060188293, gen p mean: -0.042254671454429626, mean p set: 0.45048442482948303
loss_pred:0.01607883907854557, decouple_loss:0.0009121106704697013
The modified gen p mean: 0.45136839151382446, gen p mean: -0.04277396202087402, mean p set: 0.4518486559391022The modified gen p mean: 0.45160576701164246, gen p mean: -0.04299958050251007, mean p set: 0.45208606123924255
loss_pred:0.015187754295766354, decouple_loss:0.0009683395037427545
loss_pred:0.015950895845890045, decouple_loss:0.001018021022900939
2023-05-02 13:51:49 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.05229968577623367, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04836434870958328, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04879756644368172, mean p set: 0.4500633478164673
loss_pred:0.018682265654206276, decouple_loss:0.001192710129544139
loss_pred:0.01762666180729866, decouple_loss:0.0010639614192768931
loss_pred:0.017688114196062088, decouple_loss:0.0011096152011305094
WV_0_PC_1_EH_0_PS_40, loss: 0.01805511862039566, avg_mse: 0.026165910065174103
current test mse: 0.026166
Iteration: 2971, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45211341977119446, gen p mean: -0.04724865034222603, mean p set: 0.45259371399879456
The modified gen p mean: 0.4504493772983551, gen p mean: -0.0490863211452961, mean p set: 0.4509296715259552
The modified gen p mean: 0.4515972435474396, gen p mean: -0.046786267310380936, mean p set: 0.4520775377750397
loss_pred:0.015176443383097649, decouple_loss:0.0010753825772553682
loss_pred:0.01565067656338215, decouple_loss:0.0010888620745390654
loss_pred:0.01626700907945633, decouple_loss:0.0009960567113012075
Iteration: 2972, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45087429881095886, gen p mean: -0.0448327474296093, mean p set: 0.45135459303855896
loss_pred:0.015125632286071777, decouple_loss:0.0010136321652680635
The modified gen p mean: 0.45093023777008057, gen p mean: -0.046980299055576324, mean p set: 0.45141053199768066The modified gen p mean: 0.45170944929122925, gen p mean: -0.04690439626574516, mean p set: 0.45218974351882935
loss_pred:0.01608465239405632, decouple_loss:0.0011899309465661645
loss_pred:0.016201922670006752, decouple_loss:0.001043248688802123
Iteration: 2973, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450095534324646, gen p mean: -0.04913293942809105, mean p set: 0.4505757987499237
loss_pred:0.015557515434920788, decouple_loss:0.0009587341919541359
The modified gen p mean: 0.45181915163993835, gen p mean: -0.04696822166442871, mean p set: 0.45229944586753845The modified gen p mean: 0.45182347297668457, gen p mean: -0.047837551683187485, mean p set: 0.4523037374019623
loss_pred:0.015813369303941727, decouple_loss:0.0010609121527522802
loss_pred:0.015545803122222424, decouple_loss:0.000957996875513345
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012012_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012012_3_24hr.npz
NaN value num: 0
Iteration: 2974, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45252203941345215, gen p mean: -0.03631504997611046, mean p set: 0.45300236344337463
loss_pred:0.016598837450146675, decouple_loss:0.0011757189640775323
The modified gen p mean: 0.45095396041870117, gen p mean: -0.042456939816474915, mean p set: 0.45143428444862366The modified gen p mean: 0.45267388224601746, gen p mean: -0.03464648500084877, mean p set: 0.45315417647361755
loss_pred:0.016245240345597267, decouple_loss:0.0012141525512561202
loss_pred:0.01575712487101555, decouple_loss:0.001114410231821239
Iteration: 2975, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45237088203430176, gen p mean: -0.03628962114453316, mean p set: 0.45285117626190186
loss_pred:0.01626744121313095, decouple_loss:0.001226014457643032
The modified gen p mean: 0.4522748589515686, gen p mean: -0.04308110103011131, mean p set: 0.4527551829814911The modified gen p mean: 0.4526253044605255, gen p mean: -0.0326298363506794, mean p set: 0.4531055986881256
loss_pred:0.0163430105894804, decouple_loss:0.0011662418255582452
loss_pred:0.01602160930633545, decouple_loss:0.001389775425195694
Iteration: 2976, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4529753029346466, gen p mean: -0.03578714281320572, mean p set: 0.4534555673599243
loss_pred:0.01621806062757969, decouple_loss:0.0011043986305594444
The modified gen p mean: 0.4518972635269165, gen p mean: -0.03337979316711426, mean p set: 0.4523775279521942The modified gen p mean: 0.45238208770751953, gen p mean: -0.04162626340985298, mean p set: 0.452862411737442
loss_pred:0.015844525769352913, decouple_loss:0.0010662854183465242
loss_pred:0.015916593372821808, decouple_loss:0.0010696763638406992
Iteration: 2977, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450235515832901, gen p mean: -0.03743018954992294, mean p set: 0.4507158100605011
loss_pred:0.015800394117832184, decouple_loss:0.0013019032776355743
The modified gen p mean: 0.45308157801628113, gen p mean: -0.029993142932653427, mean p set: 0.4535618722438812The modified gen p mean: 0.4510819911956787, gen p mean: -0.029326211661100388, mean p set: 0.4515622556209564
loss_pred:0.016156628727912903, decouple_loss:0.0013295195531100035
loss_pred:0.01574588567018509, decouple_loss:0.0012139651225879788
Iteration: 2978, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45312532782554626, gen p mean: -0.02974696457386017, mean p set: 0.45360562205314636
loss_pred:0.0165732242166996, decouple_loss:0.0010796006536111236
The modified gen p mean: 0.45076799392700195, gen p mean: -0.03232111036777496, mean p set: 0.45124828815460205The modified gen p mean: 0.4520992636680603, gen p mean: -0.03024093247950077, mean p set: 0.4525795578956604
loss_pred:0.01587006077170372, decouple_loss:0.0011319741606712341
loss_pred:0.016450457274913788, decouple_loss:0.0010590240126475692
Iteration: 2979, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4524537920951843, gen p mean: -0.03981654345989227, mean p set: 0.4529340863227844
loss_pred:0.016647931188344955, decouple_loss:0.0013316678814589977
The modified gen p mean: 0.45320776104927063, gen p mean: -0.04272222891449928, mean p set: 0.45368802547454834The modified gen p mean: 0.45103585720062256, gen p mean: -0.03296942263841629, mean p set: 0.45151615142822266
loss_pred:0.01659194566309452, decouple_loss:0.0012234249152243137
loss_pred:0.015861524268984795, decouple_loss:0.0011304790386930108
Iteration: 2980, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4525606632232666, gen p mean: -0.03485117107629776, mean p set: 0.4530409872531891
loss_pred:0.015765221789479256, decouple_loss:0.0011557270772755146
The modified gen p mean: 0.45296192169189453, gen p mean: -0.036402132362127304, mean p set: 0.45344221591949463The modified gen p mean: 0.4511535167694092, gen p mean: -0.03180105984210968, mean p set: 0.4516338109970093
loss_pred:0.016287321224808693, decouple_loss:0.0011422878596931696
loss_pred:0.015819691121578217, decouple_loss:0.0010663621360436082
2023-05-02 13:54:28 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.05065915733575821, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.046270258724689484, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.04670463129878044, mean p set: 0.4500633478164673
loss_pred:0.018542632460594177, decouple_loss:0.001265926519408822
loss_pred:0.017440205439925194, decouple_loss:0.0011715764412656426
loss_pred:0.01753283105790615, decouple_loss:0.0011894998606294394
WV_0_PC_1_EH_0_PS_40, loss: 0.017899006605148315, avg_mse: 0.025827813893556595
current test mse: 0.025828
Iteration: 2981, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45124709606170654, gen p mean: -0.032858021557331085, mean p set: 0.45172739028930664
The modified gen p mean: 0.45094770193099976, gen p mean: -0.034255094826221466, mean p set: 0.45142796635627747
The modified gen p mean: 0.45073312520980835, gen p mean: -0.03788962960243225, mean p set: 0.45121341943740845
loss_pred:0.015476958826184273, decouple_loss:0.0011018002405762672
loss_pred:0.015621921978890896, decouple_loss:0.0010499597992748022
loss_pred:0.015261477790772915, decouple_loss:0.0010669369949027896
Iteration: 2982, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513908624649048, gen p mean: -0.03751157224178314, mean p set: 0.4518711566925049
loss_pred:0.01603417657315731, decouple_loss:0.0011169828940182924
The modified gen p mean: 0.45364052057266235, gen p mean: -0.038888875395059586, mean p set: 0.45412078499794006The modified gen p mean: 0.4526158273220062, gen p mean: -0.03380054980516434, mean p set: 0.45309609174728394
loss_pred:0.01595052145421505, decouple_loss:0.0011409184662625194
loss_pred:0.01625048741698265, decouple_loss:0.0011321288766339421
Iteration: 2983, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4527921676635742, gen p mean: -0.03514368459582329, mean p set: 0.4532724618911743
loss_pred:0.016208237037062645, decouple_loss:0.0010555888293311
The modified gen p mean: 0.4503174424171448, gen p mean: -0.04418593645095825, mean p set: 0.4507977068424225The modified gen p mean: 0.4515745937824249, gen p mean: -0.0423399992287159, mean p set: 0.4520549178123474
loss_pred:0.016625970602035522, decouple_loss:0.0011335164308547974
loss_pred:0.015973933041095734, decouple_loss:0.001197401317767799
Iteration: 2984, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4532085359096527, gen p mean: -0.04608330503106117, mean p set: 0.4536888301372528
loss_pred:0.016434285789728165, decouple_loss:0.0010762411402538419
The modified gen p mean: 0.45122694969177246, gen p mean: -0.04275169223546982, mean p set: 0.45170727372169495The modified gen p mean: 0.4533539414405823, gen p mean: -0.044494953006505966, mean p set: 0.45383426547050476
loss_pred:0.015584699809551239, decouple_loss:0.0011035001371055841
loss_pred:0.017327703535556793, decouple_loss:0.0011159444693475962
Iteration: 2985, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513874650001526, gen p mean: -0.04638909548521042, mean p set: 0.4518677592277527
loss_pred:0.015687914565205574, decouple_loss:0.0011758741457015276
The modified gen p mean: 0.4520900249481201, gen p mean: -0.03930873051285744, mean p set: 0.4525703489780426The modified gen p mean: 0.4524152874946594, gen p mean: -0.04732765257358551, mean p set: 0.4528955817222595
loss_pred:0.01634269393980503, decouple_loss:0.0012410649796947837
loss_pred:0.015958428382873535, decouple_loss:0.0011980815324932337
Iteration: 2986, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508955180644989, gen p mean: -0.036733102053403854, mean p set: 0.451375812292099
loss_pred:0.01642691157758236, decouple_loss:0.0010359177831560373
The modified gen p mean: 0.45189452171325684, gen p mean: -0.04175807163119316, mean p set: 0.45237478613853455The modified gen p mean: 0.4531867802143097, gen p mean: -0.03781639412045479, mean p set: 0.4536671042442322
loss_pred:0.015713145956397057, decouple_loss:0.0010035986779257655
loss_pred:0.016294583678245544, decouple_loss:0.0010405443608760834
Iteration: 2987, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45342588424682617, gen p mean: -0.03446352854371071, mean p set: 0.45390620827674866
loss_pred:0.01635381206870079, decouple_loss:0.0012033407110720873
The modified gen p mean: 0.4514777958393097, gen p mean: -0.045034103095531464, mean p set: 0.4519580900669098The modified gen p mean: 0.45206180214881897, gen p mean: -0.037867072969675064, mean p set: 0.45254209637641907
loss_pred:0.016037333756685257, decouple_loss:0.0014236955903470516
loss_pred:0.016057923436164856, decouple_loss:0.0011994348606094718
Iteration: 2988, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45273759961128235, gen p mean: -0.03879297524690628, mean p set: 0.45321789383888245
loss_pred:0.015903105959296227, decouple_loss:0.0010737722041085362
The modified gen p mean: 0.45133817195892334, gen p mean: -0.03847308084368706, mean p set: 0.45181846618652344The modified gen p mean: 0.45041078329086304, gen p mean: -0.03600986301898956, mean p set: 0.45089107751846313
loss_pred:0.015912124887108803, decouple_loss:0.00107030279468745
loss_pred:0.016068920493125916, decouple_loss:0.0010024788789451122
Iteration: 2989, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45076045393943787, gen p mean: -0.03788404166698456, mean p set: 0.45124077796936035
loss_pred:0.015091854147613049, decouple_loss:0.0012228303821757436
The modified gen p mean: 0.451753169298172, gen p mean: -0.04500415921211243, mean p set: 0.4522334337234497The modified gen p mean: 0.4521215856075287, gen p mean: -0.03829812631011009, mean p set: 0.4526018798351288
loss_pred:0.016389669850468636, decouple_loss:0.0010924488306045532
loss_pred:0.015769068151712418, decouple_loss:0.0011292524868622422
Iteration: 2990, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514097571372986, gen p mean: -0.041888464242219925, mean p set: 0.45189008116722107
loss_pred:0.015940047800540924, decouple_loss:0.0011972399661317468
The modified gen p mean: 0.45251384377479553, gen p mean: -0.03313611447811127, mean p set: 0.45299410820007324The modified gen p mean: 0.4508211314678192, gen p mean: -0.04007631167769432, mean p set: 0.4513013958930969
loss_pred:0.015838541090488434, decouple_loss:0.0011354056186974049
loss_pred:0.01604653336107731, decouple_loss:0.0011291255941614509
2023-05-02 13:56:24 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.05343689024448395, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04949742555618286, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.04952579364180565, mean p set: 0.4500633478164673
loss_pred:0.018498556688427925, decouple_loss:0.0012460133293643594
loss_pred:0.017401179298758507, decouple_loss:0.0011355013120919466
loss_pred:0.017431383952498436, decouple_loss:0.0012033319799229503
WV_0_PC_1_EH_0_PS_40, loss: 0.017836786806583405, avg_mse: 0.02570202387869358
current test mse: 0.025702
Iteration: 2991, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45210137963294983, gen p mean: -0.03775389865040779, mean p set: 0.45258164405822754
The modified gen p mean: 0.4518016576766968, gen p mean: -0.043338023126125336, mean p set: 0.45228198170661926
The modified gen p mean: 0.45143890380859375, gen p mean: -0.043067220598459244, mean p set: 0.45191919803619385
loss_pred:0.015479744412004948, decouple_loss:0.0011067166924476624
loss_pred:0.01639585942029953, decouple_loss:0.001261845463886857
loss_pred:0.016316287219524384, decouple_loss:0.0011642267927527428
Iteration: 2992, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45061156153678894, gen p mean: -0.044134218245744705, mean p set: 0.4510918855667114
loss_pred:0.015580732375383377, decouple_loss:0.0010150694288313389
The modified gen p mean: 0.451018363237381, gen p mean: -0.04762710630893707, mean p set: 0.4514986276626587The modified gen p mean: 0.45333120226860046, gen p mean: -0.04225606098771095, mean p set: 0.45381149649620056
loss_pred:0.016216401010751724, decouple_loss:0.00105282140430063
loss_pred:0.015873737633228302, decouple_loss:0.0011090250918641686
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012008_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012008_3_24hr.npz
NaN value num: 0
Iteration: 2993, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45205265283584595, gen p mean: -0.04111434519290924, mean p set: 0.45253291726112366
loss_pred:0.01589389331638813, decouple_loss:0.0010370026575401425
The modified gen p mean: 0.4499431252479553, gen p mean: -0.045734480023384094, mean p set: 0.4504234194755554The modified gen p mean: 0.4485670328140259, gen p mean: -0.0436883382499218, mean p set: 0.44904735684394836
loss_pred:0.015341672115027905, decouple_loss:0.0010438952594995499
loss_pred:0.017255177721381187, decouple_loss:0.0010659019462764263
Iteration: 2994, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45059144496917725, gen p mean: -0.04314422607421875, mean p set: 0.45107173919677734
loss_pred:0.01601588912308216, decouple_loss:0.0011072290362790227
The modified gen p mean: 0.4496305584907532, gen p mean: -0.04610924795269966, mean p set: 0.45011085271835327
The modified gen p mean: 0.45184168219566345, gen p mean: -0.045739952474832535, mean p set: 0.45232194662094116
loss_pred:0.016432108357548714, decouple_loss:0.0011159059358760715
loss_pred:0.016336699947714806, decouple_loss:0.0011950167827308178
Iteration: 2995, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44922390580177307, gen p mean: -0.04893104359507561, mean p set: 0.4497041702270508
loss_pred:0.01558257918804884, decouple_loss:0.0009186164243146777
The modified gen p mean: 0.44939979910850525, gen p mean: -0.04908037185668945, mean p set: 0.44988009333610535The modified gen p mean: 0.45020562410354614, gen p mean: -0.04399270564317703, mean p set: 0.45068594813346863
loss_pred:0.01518633496016264, decouple_loss:0.0009067754144780338
loss_pred:0.016042271628975868, decouple_loss:0.0009602674981579185
Iteration: 2996, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45179903507232666, gen p mean: -0.04525887593626976, mean p set: 0.45227932929992676
loss_pred:0.01641797088086605, decouple_loss:0.000996273010969162
The modified gen p mean: 0.4515248239040375, gen p mean: -0.04638155922293663, mean p set: 0.45200514793395996The modified gen p mean: 0.4522383213043213, gen p mean: -0.04333085939288139, mean p set: 0.4527186155319214
loss_pred:0.016313038766384125, decouple_loss:0.0009705304983071983
loss_pred:0.015639403834939003, decouple_loss:0.001000880147330463
Iteration: 2997, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45036736130714417, gen p mean: -0.047915998846292496, mean p set: 0.45084765553474426
loss_pred:0.01557032112032175, decouple_loss:0.0008904404239729047
The modified gen p mean: 0.4501669406890869, gen p mean: -0.04676247388124466, mean p set: 0.450647234916687The modified gen p mean: 0.45147714018821716, gen p mean: -0.045852962881326675, mean p set: 0.4519574046134949
loss_pred:0.01590629480779171, decouple_loss:0.001045920536853373
loss_pred:0.016029642894864082, decouple_loss:0.0009684073156677186
Iteration: 2998, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44886985421180725, gen p mean: -0.04480760172009468, mean p set: 0.44935014843940735
loss_pred:0.014956722967326641, decouple_loss:0.0009329188615083694
The modified gen p mean: 0.4496549963951111, gen p mean: -0.04480389133095741, mean p set: 0.45013532042503357The modified gen p mean: 0.44874706864356995, gen p mean: -0.0479280948638916, mean p set: 0.44922736287117004
loss_pred:0.016841592267155647, decouple_loss:0.001018980867229402
loss_pred:0.01618041843175888, decouple_loss:0.0009682349627837539
Iteration: 2999, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45146384835243225, gen p mean: -0.044065918773412704, mean p set: 0.45194414258003235
loss_pred:0.01604500785470009, decouple_loss:0.0009379185503348708
The modified gen p mean: 0.4499739110469818, gen p mean: -0.052333734929561615, mean p set: 0.4504542350769043The modified gen p mean: 0.4505055248737335, gen p mean: -0.049954142421483994, mean p set: 0.450985848903656
loss_pred:0.015943778678774834, decouple_loss:0.0009571146219968796
loss_pred:0.01601683348417282, decouple_loss:0.0010115420445799828
Iteration: 3000, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503987729549408, gen p mean: -0.040976233780384064, mean p set: 0.4508790671825409
loss_pred:0.016127262264490128, decouple_loss:0.0009977405425161123
The modified gen p mean: 0.45141661167144775, gen p mean: -0.042157482355833054, mean p set: 0.45189690589904785The modified gen p mean: 0.4489685297012329, gen p mean: -0.04296158626675606, mean p set: 0.4494488537311554
loss_pred:0.015436358749866486, decouple_loss:0.0009080645395442843
loss_pred:0.015451526269316673, decouple_loss:0.0008400729857385159
2023-05-02 13:59:01 itr: 3000
training loss: [0.01549353 0.01617715 0.01548176]
2023-05-02 13:59:01 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.054855480790138245, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.0512159988284111, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.05124318227171898, mean p set: 0.4500633478164673
loss_pred:0.01838640682399273, decouple_loss:0.0010740677826106548
loss_pred:0.017304733395576477, decouple_loss:0.001083873212337494
loss_pred:0.01736406236886978, decouple_loss:0.001034178421832621
WV_0_PC_1_EH_0_PS_40, loss: 0.01773827150464058, avg_mse: 0.02552243508398533
current test mse: 0.025522
Iteration: 3001, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496084749698639, gen p mean: -0.04085896909236908, mean p set: 0.4500887989997864
The modified gen p mean: 0.4490223824977875, gen p mean: -0.04427587240934372, mean p set: 0.4495026767253876
The modified gen p mean: 0.45123109221458435, gen p mean: -0.04272833466529846, mean p set: 0.45171138644218445
loss_pred:0.01624000445008278, decouple_loss:0.0009477253188379109
loss_pred:0.015971384942531586, decouple_loss:0.0009274707408621907
loss_pred:0.015323199331760406, decouple_loss:0.0010199277894571424
Iteration: 3002, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495670199394226, gen p mean: -0.04305476322770119, mean p set: 0.4500472843647003
loss_pred:0.016392450779676437, decouple_loss:0.0009732354083098471
The modified gen p mean: 0.4520147144794464, gen p mean: -0.04296395555138588, mean p set: 0.4524949789047241The modified gen p mean: 0.44924798607826233, gen p mean: -0.04728100076317787, mean p set: 0.4497282803058624
loss_pred:0.015559927560389042, decouple_loss:0.0010446941014379263
loss_pred:0.015718230977654457, decouple_loss:0.0010512908920645714
Iteration: 3003, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505070447921753, gen p mean: -0.0483253076672554, mean p set: 0.4509873688220978
loss_pred:0.015825435519218445, decouple_loss:0.0009582351776771247
The modified gen p mean: 0.45046067237854004, gen p mean: -0.05070003494620323, mean p set: 0.45094096660614014The modified gen p mean: 0.45238858461380005, gen p mean: -0.039154522120952606, mean p set: 0.45286887884140015
loss_pred:0.015704287216067314, decouple_loss:0.0009577215532772243
loss_pred:0.01540235336869955, decouple_loss:0.0010171495378017426
Iteration: 3004, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449367880821228, gen p mean: -0.05004459246993065, mean p set: 0.4498482048511505
loss_pred:0.016098687425255775, decouple_loss:0.0010471419664099813
The modified gen p mean: 0.44859978556632996, gen p mean: -0.050585754215717316, mean p set: 0.44908010959625244The modified gen p mean: 0.45234426856040955, gen p mean: -0.04301223158836365, mean p set: 0.45282456278800964
loss_pred:0.016084879636764526, decouple_loss:0.0010423241183161736
loss_pred:0.016211561858654022, decouple_loss:0.0011117345420643687
Iteration: 3005, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448866069316864, gen p mean: -0.049926355481147766, mean p set: 0.4493463933467865
loss_pred:0.017052408307790756, decouple_loss:0.0009577863966114819
The modified gen p mean: 0.45180878043174744, gen p mean: -0.04799839109182358, mean p set: 0.45228907465934753The modified gen p mean: 0.44940489530563354, gen p mean: -0.05090322718024254, mean p set: 0.44988515973091125
loss_pred:0.01607239805161953, decouple_loss:0.0011259714374318719
loss_pred:0.01590501144528389, decouple_loss:0.0009842697763815522
Iteration: 3006, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504108428955078, gen p mean: -0.05239607393741608, mean p set: 0.4508911669254303
loss_pred:0.015877211466431618, decouple_loss:0.0011049775639548898
The modified gen p mean: 0.44975170493125916, gen p mean: -0.050631340593099594, mean p set: 0.45023199915885925The modified gen p mean: 0.44940727949142456, gen p mean: -0.05489158630371094, mean p set: 0.44988757371902466
loss_pred:0.01546452660113573, decouple_loss:0.0010738116689026356
loss_pred:0.015294568613171577, decouple_loss:0.0012257947819307446
Iteration: 3007, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44960305094718933, gen p mean: -0.050686731934547424, mean p set: 0.45008331537246704
loss_pred:0.015592182986438274, decouple_loss:0.000989308231510222
The modified gen p mean: 0.44958770275115967, gen p mean: -0.05000587925314903, mean p set: 0.45006799697875977The modified gen p mean: 0.44906169176101685, gen p mean: -0.05089293420314789, mean p set: 0.44954198598861694
loss_pred:0.015964465215802193, decouple_loss:0.0009473760146647692
loss_pred:0.015247225761413574, decouple_loss:0.0009644120000302792
Iteration: 3008, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45041003823280334, gen p mean: -0.043644681572914124, mean p set: 0.45089030265808105
loss_pred:0.01667686551809311, decouple_loss:0.0010121939703822136
The modified gen p mean: 0.4500294029712677, gen p mean: -0.05073527991771698, mean p set: 0.4505097270011902The modified gen p mean: 0.4495231807231903, gen p mean: -0.051580704748630524, mean p set: 0.4500034749507904
loss_pred:0.01552541833370924, decouple_loss:0.0011789625277742743
loss_pred:0.016479939222335815, decouple_loss:0.0009410231723450124
Iteration: 3009, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45104214549064636, gen p mean: -0.04394141957163811, mean p set: 0.4515224099159241
loss_pred:0.016445225104689598, decouple_loss:0.0009043379686772823
The modified gen p mean: 0.45179152488708496, gen p mean: -0.04235147684812546, mean p set: 0.45227181911468506The modified gen p mean: 0.44979164004325867, gen p mean: -0.04094618558883667, mean p set: 0.45027193427085876
loss_pred:0.016201632097363472, decouple_loss:0.0009537378791719675
loss_pred:0.016058946028351784, decouple_loss:0.0009174042497761548
Iteration: 3010, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44990274310112, gen p mean: -0.046732719987630844, mean p set: 0.4503830373287201
loss_pred:0.015149129554629326, decouple_loss:0.0009698493522591889
The modified gen p mean: 0.45108312368392944, gen p mean: -0.04191171005368233, mean p set: 0.45156344771385193The modified gen p mean: 0.4521111845970154, gen p mean: -0.035795751959085464, mean p set: 0.4525914490222931
loss_pred:0.01563234068453312, decouple_loss:0.0009117439039982855
loss_pred:0.016415733844041824, decouple_loss:0.001017333590425551
2023-05-02 14:00:55 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.051549654453992844, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.047721195966005325, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.04764968529343605, mean p set: 0.4500633478164673
loss_pred:0.018380815163254738, decouple_loss:0.0011164565803483129
loss_pred:0.017304949462413788, decouple_loss:0.000998139614239335
loss_pred:0.017318101599812508, decouple_loss:0.0010211599292233586
WV_0_PC_1_EH_0_PS_40, loss: 0.017720218747854233, avg_mse: 0.02551027201116085
current test mse: 0.02551
Iteration: 3011, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45300352573394775, gen p mean: -0.03635961934924126, mean p set: 0.45348381996154785
The modified gen p mean: 0.4519023895263672, gen p mean: -0.04104986786842346, mean p set: 0.4523826837539673
The modified gen p mean: 0.4486233592033386, gen p mean: -0.04091602936387062, mean p set: 0.44910362362861633
loss_pred:0.0156137989833951, decouple_loss:0.0009000133140943944
loss_pred:0.01635258086025715, decouple_loss:0.0008815973997116089
loss_pred:0.015544915571808815, decouple_loss:0.0009894715622067451
Iteration: 3012, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450987309217453, gen p mean: -0.03733246028423309, mean p set: 0.4514676034450531
loss_pred:0.016452880576252937, decouple_loss:0.0009190879645757377
The modified gen p mean: 0.452693909406662, gen p mean: -0.038848038762807846, mean p set: 0.4531742036342621The modified gen p mean: 0.4490245580673218, gen p mean: -0.04117025434970856, mean p set: 0.4495048522949219
loss_pred:0.01597028784453869, decouple_loss:0.001046046381816268
loss_pred:0.016092997044324875, decouple_loss:0.0009266978013329208
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012019_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012019_3_24hr.npz
NaN value num: 0
Iteration: 3013, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44812843203544617, gen p mean: -0.044803861528635025, mean p set: 0.44860872626304626
loss_pred:0.01635078154504299, decouple_loss:0.001052047242410481
The modified gen p mean: 0.44958382844924927, gen p mean: -0.052795205265283585, mean p set: 0.45006415247917175
The modified gen p mean: 0.4485195279121399, gen p mean: -0.05216054618358612, mean p set: 0.4489997923374176
loss_pred:0.017332088202238083, decouple_loss:0.0011041047982871532
loss_pred:0.017550040036439896, decouple_loss:0.0011220790911465883
Iteration: 3014, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487094581127167, gen p mean: -0.050668105483055115, mean p set: 0.4491897523403168
loss_pred:0.016936851665377617, decouple_loss:0.0010516127804294229
The modified gen p mean: 0.44938158988952637, gen p mean: -0.04853875935077667, mean p set: 0.4498618543148041The modified gen p mean: 0.4495875835418701, gen p mean: -0.05222591757774353, mean p set: 0.4500678777694702
loss_pred:0.01671072654426098, decouple_loss:0.0010027325479313731
loss_pred:0.01677843928337097, decouple_loss:0.0010783307952806354
Iteration: 3015, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507370591163635, gen p mean: -0.055696796625852585, mean p set: 0.451217383146286
loss_pred:0.016638388857245445, decouple_loss:0.0010501741198822856
The modified gen p mean: 0.4495446979999542, gen p mean: -0.05318129062652588, mean p set: 0.45002496242523193The modified gen p mean: 0.447001188993454, gen p mean: -0.05798261612653732, mean p set: 0.4474814832210541
loss_pred:0.017158610746264458, decouple_loss:0.0010140276281163096
loss_pred:0.016929669305682182, decouple_loss:0.0010865534422919154
Iteration: 3016, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486970007419586, gen p mean: -0.05784693360328674, mean p set: 0.44917726516723633
loss_pred:0.016815509647130966, decouple_loss:0.0010957394260913134
The modified gen p mean: 0.44905567169189453, gen p mean: -0.05909113585948944, mean p set: 0.44953596591949463The modified gen p mean: 0.4490108788013458, gen p mean: -0.057437919080257416, mean p set: 0.44949114322662354
loss_pred:0.016707587987184525, decouple_loss:0.0009968130616471171
loss_pred:0.016717713326215744, decouple_loss:0.0010122543899342418
Iteration: 3017, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44899824261665344, gen p mean: -0.06023826822638512, mean p set: 0.4494785666465759
loss_pred:0.01722629927098751, decouple_loss:0.0011227278737351298
The modified gen p mean: 0.4475134313106537, gen p mean: -0.06111706793308258, mean p set: 0.4479937255382538The modified gen p mean: 0.447456419467926, gen p mean: -0.059804435819387436, mean p set: 0.4479367434978485
loss_pred:0.016762450337409973, decouple_loss:0.0010462694335728884
loss_pred:0.016263414174318314, decouple_loss:0.0010328536154702306
Iteration: 3018, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487714469432831, gen p mean: -0.05866348370909691, mean p set: 0.44925177097320557
loss_pred:0.01686936989426613, decouple_loss:0.0010652459459379315
The modified gen p mean: 0.4501849114894867, gen p mean: -0.06145764887332916, mean p set: 0.4506652057170868
The modified gen p mean: 0.4490993320941925, gen p mean: -0.059641048312187195, mean p set: 0.449579656124115
loss_pred:0.016188522800803185, decouple_loss:0.0011541175190359354
loss_pred:0.017139147967100143, decouple_loss:0.0012301607057452202
Iteration: 3019, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45018404722213745, gen p mean: -0.06206423044204712, mean p set: 0.45066434144973755
loss_pred:0.016892552375793457, decouple_loss:0.0011011072201654315
The modified gen p mean: 0.4479981064796448, gen p mean: -0.06474070996046066, mean p set: 0.44847843050956726The modified gen p mean: 0.44954657554626465, gen p mean: -0.054850105196237564, mean p set: 0.45002689957618713
loss_pred:0.01676257513463497, decouple_loss:0.001107717864215374
loss_pred:0.016831887885928154, decouple_loss:0.001049879239872098
Iteration: 3020, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44962507486343384, gen p mean: -0.06036628410220146, mean p set: 0.45010536909103394
loss_pred:0.017047880217432976, decouple_loss:0.0011415565386414528
The modified gen p mean: 0.45038357377052307, gen p mean: -0.0599249005317688, mean p set: 0.4508638381958008The modified gen p mean: 0.4479564130306244, gen p mean: -0.05797319486737251, mean p set: 0.4484367072582245
loss_pred:0.015854788944125175, decouple_loss:0.001022331533022225
loss_pred:0.016861246898770332, decouple_loss:0.0012280656956136227
2023-05-02 14:03:36 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.05932709202170372, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.054742634296417236, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.054928120225667953, mean p set: 0.4500633478164673
loss_pred:0.017354344949126244, decouple_loss:0.0012571992119774222
loss_pred:0.01845795288681984, decouple_loss:0.0012428151676431298
loss_pred:0.017404481768608093, decouple_loss:0.001225427258759737
WV_0_PC_1_EH_0_PS_40, loss: 0.01780102029442787, avg_mse: 0.02563551440834999
current test mse: 0.025636
Iteration: 3021, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484054148197174, gen p mean: -0.057747483253479004, mean p set: 0.4488857388496399
The modified gen p mean: 0.44943666458129883, gen p mean: -0.05954689905047417, mean p set: 0.44991692900657654
The modified gen p mean: 0.4469609260559082, gen p mean: -0.057425606995821, mean p set: 0.4474412202835083
loss_pred:0.016909833997488022, decouple_loss:0.001173496711999178
loss_pred:0.016862420365214348, decouple_loss:0.0011636868584901094
loss_pred:0.01748141646385193, decouple_loss:0.00121317186858505
Iteration: 3022, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491068422794342, gen p mean: -0.05110253393650055, mean p set: 0.4495871365070343
loss_pred:0.016887962818145752, decouple_loss:0.0011720926268026233
The modified gen p mean: 0.4475889205932617, gen p mean: -0.06020806357264519, mean p set: 0.4480692446231842The modified gen p mean: 0.44855383038520813, gen p mean: -0.047543447464704514, mean p set: 0.4490341246128082
loss_pred:0.016452977433800697, decouple_loss:0.0012136432342231274
loss_pred:0.01597309485077858, decouple_loss:0.0011119531700387597
Iteration: 3023, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493086040019989, gen p mean: -0.04939112067222595, mean p set: 0.449788898229599
loss_pred:0.017255203798413277, decouple_loss:0.0011803176021203399
The modified gen p mean: 0.4491044878959656, gen p mean: -0.04936676844954491, mean p set: 0.4495847821235657
The modified gen p mean: 0.4487517476081848, gen p mean: -0.050536464899778366, mean p set: 0.4492320418357849
loss_pred:0.01662280037999153, decouple_loss:0.001187324756756425
loss_pred:0.016677318140864372, decouple_loss:0.001150414696894586
Iteration: 3024, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44697055220603943, gen p mean: -0.050708889961242676, mean p set: 0.44745081663131714
loss_pred:0.016840316355228424, decouple_loss:0.001098649692721665
The modified gen p mean: 0.44869574904441833, gen p mean: -0.046206098049879074, mean p set: 0.44917601346969604The modified gen p mean: 0.4497879445552826, gen p mean: -0.04653967544436455, mean p set: 0.4502682387828827
loss_pred:0.017393456771969795, decouple_loss:0.0010762378806248307
loss_pred:0.016872329637408257, decouple_loss:0.001050665508955717
Iteration: 3025, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44915780425071716, gen p mean: -0.04537244886159897, mean p set: 0.44963809847831726
loss_pred:0.01645643822848797, decouple_loss:0.0013461614726111293
The modified gen p mean: 0.4486750662326813, gen p mean: -0.04346080496907234, mean p set: 0.44915536046028137The modified gen p mean: 0.44922003149986267, gen p mean: -0.0465615838766098, mean p set: 0.44970032572746277
loss_pred:0.016769811511039734, decouple_loss:0.001361693488433957
loss_pred:0.016725679859519005, decouple_loss:0.001388426753692329
Iteration: 3026, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476543366909027, gen p mean: -0.04472491517663002, mean p set: 0.4481346309185028
loss_pred:0.01715364307165146, decouple_loss:0.0011844424298033118
The modified gen p mean: 0.4478062391281128, gen p mean: -0.04844943806529045, mean p set: 0.4482865631580353The modified gen p mean: 0.45032182335853577, gen p mean: -0.04744428023695946, mean p set: 0.45080211758613586
loss_pred:0.017013294622302055, decouple_loss:0.00106580532155931
loss_pred:0.016533972695469856, decouple_loss:0.001225289423018694
Iteration: 3027, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493502676486969, gen p mean: -0.04928996413946152, mean p set: 0.449830561876297
loss_pred:0.016687119379639626, decouple_loss:0.001096535474061966
The modified gen p mean: 0.44981130957603455, gen p mean: -0.04898795858025551, mean p set: 0.45029157400131226The modified gen p mean: 0.4498981833457947, gen p mean: -0.04719271510839462, mean p set: 0.45037850737571716
loss_pred:0.016808267682790756, decouple_loss:0.0011734790168702602
loss_pred:0.01666898839175701, decouple_loss:0.0012025388423353434
Iteration: 3028, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45001980662345886, gen p mean: -0.04817012697458267, mean p set: 0.4505000710487366
loss_pred:0.016649611294269562, decouple_loss:0.0011411597952246666
The modified gen p mean: 0.44856566190719604, gen p mean: -0.046642716974020004, mean p set: 0.44904592633247375The modified gen p mean: 0.44828230142593384, gen p mean: -0.05513938143849373, mean p set: 0.4487626254558563
loss_pred:0.01717611774802208, decouple_loss:0.0011046506697311997
loss_pred:0.01636531762778759, decouple_loss:0.0010229038307443261
Iteration: 3029, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44730865955352783, gen p mean: -0.05207711085677147, mean p set: 0.44778892397880554
loss_pred:0.016353914514183998, decouple_loss:0.0010641677072271705
The modified gen p mean: 0.4494367837905884, gen p mean: -0.05193556472659111, mean p set: 0.4499170780181885The modified gen p mean: 0.4491023123264313, gen p mean: -0.054024308919906616, mean p set: 0.44958263635635376
loss_pred:0.0160688403993845, decouple_loss:0.0010040700435638428
loss_pred:0.01651962287724018, decouple_loss:0.001092182588763535
Iteration: 3030, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487400949001312, gen p mean: -0.05114590376615524, mean p set: 0.4492203891277313
The modified gen p mean: 0.447858601808548, gen p mean: -0.05493602156639099, mean p set: 0.44833892583847046
loss_pred:0.016355080530047417, decouple_loss:0.0010157543001696467
loss_pred:0.016961269080638885, decouple_loss:0.0010808237129822373
The modified gen p mean: 0.44948768615722656, gen p mean: -0.05726929381489754, mean p set: 0.44996798038482666
loss_pred:0.016756806522607803, decouple_loss:0.0010724341263994575
2023-05-02 14:05:31 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.05841700732707977, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.05435042083263397, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.05452321097254753, mean p set: 0.4500633478164673
loss_pred:0.018410803750157356, decouple_loss:0.001055357395671308
loss_pred:0.01732776127755642, decouple_loss:0.0011068735038861632
loss_pred:0.017389759421348572, decouple_loss:0.0010480890050530434
WV_0_PC_1_EH_0_PS_40, loss: 0.01776294782757759, avg_mse: 0.025593731552362442
current test mse: 0.025594
Iteration: 3031, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45017313957214355, gen p mean: -0.05945293605327606, mean p set: 0.45065340399742126
The modified gen p mean: 0.44840845465660095, gen p mean: -0.057117801159620285, mean p set: 0.44888877868652344
The modified gen p mean: 0.4484270215034485, gen p mean: -0.05856448411941528, mean p set: 0.4489073157310486
loss_pred:0.016814613714814186, decouple_loss:0.0010142212267965078
loss_pred:0.016365716233849525, decouple_loss:0.0009750006720423698loss_pred:0.016413722187280655, decouple_loss:0.0009685595869086683
Iteration: 3032, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44894909858703613, gen p mean: -0.05085635185241699, mean p set: 0.4494294226169586
loss_pred:0.017009662464261055, decouple_loss:0.0010228391038253903
The modified gen p mean: 0.4474480152130127, gen p mean: -0.05906328558921814, mean p set: 0.4479283094406128The modified gen p mean: 0.44789648056030273, gen p mean: -0.05389587581157684, mean p set: 0.44837674498558044
loss_pred:0.015765080228447914, decouple_loss:0.0010032065911218524
loss_pred:0.016837898641824722, decouple_loss:0.001004924182780087
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012017_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012017_3_24hr.npz
NaN value num: 0
Iteration: 3033, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44860315322875977, gen p mean: -0.04758843407034874, mean p set: 0.44908347725868225
loss_pred:0.01581951230764389, decouple_loss:0.0011517162201926112
The modified gen p mean: 0.45004984736442566, gen p mean: -0.051623936742544174, mean p set: 0.45053014159202576The modified gen p mean: 0.4485991299152374, gen p mean: -0.04785086587071419, mean p set: 0.4490794241428375
loss_pred:0.016103792935609818, decouple_loss:0.0011173454113304615
loss_pred:0.01567421853542328, decouple_loss:0.0011109622428193688
Iteration: 3034, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44985517859458923, gen p mean: -0.05397679656744003, mean p set: 0.45033547282218933
loss_pred:0.015893489122390747, decouple_loss:0.001124640111811459
The modified gen p mean: 0.4509267508983612, gen p mean: -0.04479155316948891, mean p set: 0.4514070451259613The modified gen p mean: 0.4483577311038971, gen p mean: -0.04938031733036041, mean p set: 0.4488380551338196
loss_pred:0.015823159366846085, decouple_loss:0.0009847147157415748
loss_pred:0.01658959873020649, decouple_loss:0.000986278522759676
Iteration: 3035, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44860726594924927, gen p mean: -0.04440499097108841, mean p set: 0.44908758997917175
loss_pred:0.01625150628387928, decouple_loss:0.0010332295205444098
The modified gen p mean: 0.45019641518592834, gen p mean: -0.05126591771841049, mean p set: 0.45067667961120605The modified gen p mean: 0.4495129883289337, gen p mean: -0.04749593138694763, mean p set: 0.4499933123588562
loss_pred:0.015408598817884922, decouple_loss:0.0010658700484782457
loss_pred:0.015178099274635315, decouple_loss:0.001005261205136776
Iteration: 3036, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44987753033638, gen p mean: -0.05308228358626366, mean p set: 0.4503578245639801
loss_pred:0.01603122241795063, decouple_loss:0.0012328507145866752
The modified gen p mean: 0.45033571124076843, gen p mean: -0.04700593650341034, mean p set: 0.45081597566604614The modified gen p mean: 0.4485201835632324, gen p mean: -0.0413723886013031, mean p set: 0.4490005075931549
loss_pred:0.01570008136332035, decouple_loss:0.0011697602458298206
loss_pred:0.01573503017425537, decouple_loss:0.0011817659251391888
Iteration: 3037, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450148344039917, gen p mean: -0.044000912457704544, mean p set: 0.4506286382675171
loss_pred:0.015453158877789974, decouple_loss:0.0010630948236212134
The modified gen p mean: 0.44997748732566833, gen p mean: -0.04274351894855499, mean p set: 0.45045775175094604The modified gen p mean: 0.44998276233673096, gen p mean: -0.04501575604081154, mean p set: 0.45046308636665344
loss_pred:0.015625571832060814, decouple_loss:0.0010938540799543262
loss_pred:0.015462315641343594, decouple_loss:0.0011300285113975406
Iteration: 3038, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45051082968711853, gen p mean: -0.044648777693510056, mean p set: 0.45099109411239624
loss_pred:0.015467749908566475, decouple_loss:0.00113956059794873
The modified gen p mean: 0.44889456033706665, gen p mean: -0.04422659054398537, mean p set: 0.44937488436698914The modified gen p mean: 0.4488689601421356, gen p mean: -0.04496147111058235, mean p set: 0.4493492543697357
loss_pred:0.015627069398760796, decouple_loss:0.0011477040825411677
loss_pred:0.01597689464688301, decouple_loss:0.0012698404025286436
Iteration: 3039, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44945964217185974, gen p mean: -0.043743349611759186, mean p set: 0.44993993639945984
loss_pred:0.016234353184700012, decouple_loss:0.0010905455565080047
The modified gen p mean: 0.45103394985198975, gen p mean: -0.04304298758506775, mean p set: 0.45151427388191223The modified gen p mean: 0.4508385956287384, gen p mean: -0.04089285433292389, mean p set: 0.4513188898563385
loss_pred:0.016178825870156288, decouple_loss:0.0009664962417446077
loss_pred:0.015725525096058846, decouple_loss:0.0009960598545148969
Iteration: 3040, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4509466290473938, gen p mean: -0.03581087663769722, mean p set: 0.4514269232749939
loss_pred:0.01622198149561882, decouple_loss:0.0010943362722173333
The modified gen p mean: 0.44986429810523987, gen p mean: -0.04652668535709381, mean p set: 0.4503445625305176The modified gen p mean: 0.4508129358291626, gen p mean: -0.04401256516575813, mean p set: 0.4512932300567627
loss_pred:0.015690987929701805, decouple_loss:0.0011896518990397453
loss_pred:0.015374276787042618, decouple_loss:0.0011448557488620281
2023-05-02 14:08:02 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.050989627838134766, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04711562395095825, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04752171039581299, mean p set: 0.4500633478164673
loss_pred:0.01841917634010315, decouple_loss:0.0011443342082202435
loss_pred:0.017362864688038826, decouple_loss:0.0011131889186799526
loss_pred:0.01738099195063114, decouple_loss:0.0010395139688625932
WV_0_PC_1_EH_0_PS_40, loss: 0.01777596026659012, avg_mse: 0.02560156024992466
current test mse: 0.025602
Iteration: 3041, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.451181560754776, gen p mean: -0.04215652868151665, mean p set: 0.4516618549823761
The modified gen p mean: 0.4501728415489197, gen p mean: -0.04189247265458107, mean p set: 0.4506531357765198
The modified gen p mean: 0.44822803139686584, gen p mean: -0.03680839762091637, mean p set: 0.44870832562446594
loss_pred:0.016174236312508583, decouple_loss:0.0010299988789483905
loss_pred:0.015202231705188751, decouple_loss:0.0009846496395766735
loss_pred:0.01562291756272316, decouple_loss:0.0009529566741548479
Iteration: 3042, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490130841732025, gen p mean: -0.044522061944007874, mean p set: 0.449493408203125
loss_pred:0.01568683795630932, decouple_loss:0.001097136177122593
The modified gen p mean: 0.44983839988708496, gen p mean: -0.04141997918486595, mean p set: 0.45031872391700745The modified gen p mean: 0.4493566155433655, gen p mean: -0.04330435022711754, mean p set: 0.44983693957328796
loss_pred:0.015584718436002731, decouple_loss:0.0010562536772340536
loss_pred:0.015767477452754974, decouple_loss:0.0010518708731979132
Iteration: 3043, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450810045003891, gen p mean: -0.04288751259446144, mean p set: 0.4512903094291687
loss_pred:0.016018053516745567, decouple_loss:0.0010815042769536376
The modified gen p mean: 0.4507595896720886, gen p mean: -0.04390333592891693, mean p set: 0.4512398838996887
The modified gen p mean: 0.4501018822193146, gen p mean: -0.04401831328868866, mean p set: 0.45058220624923706
loss_pred:0.01577027142047882, decouple_loss:0.0011560887796804309
loss_pred:0.01622338406741619, decouple_loss:0.0011941904667764902
Iteration: 3044, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489734470844269, gen p mean: -0.0420861579477787, mean p set: 0.44945380091667175
loss_pred:0.015677310526371002, decouple_loss:0.0009345411672256887
The modified gen p mean: 0.4482896029949188, gen p mean: -0.042125947773456573, mean p set: 0.4487698972225189The modified gen p mean: 0.4511813223361969, gen p mean: -0.037724871188402176, mean p set: 0.451661616563797
loss_pred:0.01598789170384407, decouple_loss:0.0011277329176664352
loss_pred:0.01582663506269455, decouple_loss:0.000951976515352726
Iteration: 3045, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44861555099487305, gen p mean: -0.042244330048561096, mean p set: 0.44909584522247314
loss_pred:0.015437127090990543, decouple_loss:0.0009828179609030485
The modified gen p mean: 0.4503641128540039, gen p mean: -0.0437997505068779, mean p set: 0.4508443772792816The modified gen p mean: 0.44957005977630615, gen p mean: -0.04077084735035896, mean p set: 0.45005032420158386
loss_pred:0.015393898822367191, decouple_loss:0.0011084885336458683
loss_pred:0.015257592312991619, decouple_loss:0.0009602507925592363
Iteration: 3046, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495947062969208, gen p mean: -0.044342901557683945, mean p set: 0.4500750005245209
loss_pred:0.015556934289634228, decouple_loss:0.0009649075218476355
The modified gen p mean: 0.45019397139549255, gen p mean: -0.04014274850487709, mean p set: 0.45067429542541504The modified gen p mean: 0.45013922452926636, gen p mean: -0.04181147366762161, mean p set: 0.45061951875686646
loss_pred:0.015567581169307232, decouple_loss:0.0009721979149617255
loss_pred:0.015612837858498096, decouple_loss:0.0009295045747421682
Iteration: 3047, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45016369223594666, gen p mean: -0.040314801037311554, mean p set: 0.45064401626586914
loss_pred:0.015671774744987488, decouple_loss:0.0010716647375375032
The modified gen p mean: 0.44882988929748535, gen p mean: -0.038159772753715515, mean p set: 0.44931018352508545
The modified gen p mean: 0.4503107964992523, gen p mean: -0.04517873004078865, mean p set: 0.45079106092453003
loss_pred:0.01521364226937294, decouple_loss:0.000988129060715437
loss_pred:0.01589900068938732, decouple_loss:0.0010417731245979667
Iteration: 3048, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45056435465812683, gen p mean: -0.04531938210129738, mean p set: 0.45104461908340454
loss_pred:0.015598342753946781, decouple_loss:0.001104493043385446
The modified gen p mean: 0.4504992663860321, gen p mean: -0.04361691325902939, mean p set: 0.4509795904159546The modified gen p mean: 0.4488926827907562, gen p mean: -0.04241185635328293, mean p set: 0.44937294721603394
loss_pred:0.01575467362999916, decouple_loss:0.0009658496710471809
loss_pred:0.015326052904129028, decouple_loss:0.0009308985900133848
Iteration: 3049, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482422471046448, gen p mean: -0.03807226940989494, mean p set: 0.4487225413322449
loss_pred:0.015350150875747204, decouple_loss:0.0010252007050439715
The modified gen p mean: 0.4502236843109131, gen p mean: -0.04505669325590134, mean p set: 0.4507039785385132The modified gen p mean: 0.44940176606178284, gen p mean: -0.042883411049842834, mean p set: 0.4498820900917053
loss_pred:0.015407267026603222, decouple_loss:0.0010020277695730329
loss_pred:0.015101810917258263, decouple_loss:0.001054909429512918
Iteration: 3050, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44883400201797485, gen p mean: -0.03772035986185074, mean p set: 0.44931429624557495
loss_pred:0.016089674085378647, decouple_loss:0.0009875628165900707
The modified gen p mean: 0.4502759575843811, gen p mean: -0.037946585565805435, mean p set: 0.4507562518119812The modified gen p mean: 0.4498045742511749, gen p mean: -0.03740621358156204, mean p set: 0.4502848982810974
loss_pred:0.015893224626779556, decouple_loss:0.001015229499898851
loss_pred:0.015616790391504765, decouple_loss:0.001047093654051423
2023-05-02 14:09:57 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.05167292430996895, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.0476008877158165, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04797784611582756, mean p set: 0.4500633478164673
loss_pred:0.018445612862706184, decouple_loss:0.0013139046495780349
loss_pred:0.017353348433971405, decouple_loss:0.0012166694505140185
loss_pred:0.017430417239665985, decouple_loss:0.0012603921350091696
WV_0_PC_1_EH_0_PS_40, loss: 0.017806310206651688, avg_mse: 0.02565694786608219
current test mse: 0.025657
Iteration: 3051, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45127686858177185, gen p mean: -0.03753000497817993, mean p set: 0.45175716280937195
The modified gen p mean: 0.44992145895957947, gen p mean: -0.04309060424566269, mean p set: 0.45040175318717957
The modified gen p mean: 0.4501136243343353, gen p mean: -0.037773359566926956, mean p set: 0.4505939483642578
loss_pred:0.015654023736715317, decouple_loss:0.001120302826166153
loss_pred:0.016064699739217758, decouple_loss:0.00110563263297081
loss_pred:0.01535501703619957, decouple_loss:0.0011221060995012522
Iteration: 3052, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501436948776245, gen p mean: -0.043199118226766586, mean p set: 0.4506239891052246
loss_pred:0.014995381236076355, decouple_loss:0.0009819072438403964
The modified gen p mean: 0.4499850869178772, gen p mean: -0.043454188853502274, mean p set: 0.4504653811454773The modified gen p mean: 0.45033618807792664, gen p mean: -0.03750048205256462, mean p set: 0.4508165121078491
loss_pred:0.01521727442741394, decouple_loss:0.000936931639444083
loss_pred:0.015359405428171158, decouple_loss:0.0009421063004992902
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012020_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012020_3_24hr.npz
NaN value num: 0
Iteration: 3053, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44919371604919434, gen p mean: -0.04665507376194, mean p set: 0.44967401027679443
loss_pred:0.01677439548075199, decouple_loss:0.0011583651648834348
The modified gen p mean: 0.44985103607177734, gen p mean: -0.050394654273986816, mean p set: 0.45033130049705505The modified gen p mean: 0.4492141306400299, gen p mean: -0.05446706339716911, mean p set: 0.44969442486763
loss_pred:0.018113810569047928, decouple_loss:0.0011170435464009643
loss_pred:0.017626922577619553, decouple_loss:0.0011895587667822838
Iteration: 3054, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494567811489105, gen p mean: -0.04709635674953461, mean p set: 0.4499370753765106
loss_pred:0.016774116083979607, decouple_loss:0.001262574689462781
The modified gen p mean: 0.4489961862564087, gen p mean: -0.04877777770161629, mean p set: 0.4494764804840088The modified gen p mean: 0.4497492015361786, gen p mean: -0.05202720686793327, mean p set: 0.4502294957637787
loss_pred:0.016552623361349106, decouple_loss:0.0012000289279967546
loss_pred:0.017510714009404182, decouple_loss:0.0011474661296233535
Iteration: 3055, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44987934827804565, gen p mean: -0.05743091553449631, mean p set: 0.45035961270332336
loss_pred:0.017384855076670647, decouple_loss:0.0010255960514768958
The modified gen p mean: 0.44935736060142517, gen p mean: -0.05268421396613121, mean p set: 0.44983765482902527The modified gen p mean: 0.4497392177581787, gen p mean: -0.05510783568024635, mean p set: 0.4502195417881012
loss_pred:0.015871774405241013, decouple_loss:0.0011517181992530823
loss_pred:0.0171915702521801, decouple_loss:0.0011517353123053908
Iteration: 3056, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44872575998306274, gen p mean: -0.05026588216423988, mean p set: 0.44920605421066284
loss_pred:0.016833752393722534, decouple_loss:0.001308606006205082
The modified gen p mean: 0.4492981731891632, gen p mean: -0.0537867471575737, mean p set: 0.4497784972190857The modified gen p mean: 0.4489402174949646, gen p mean: -0.054137736558914185, mean p set: 0.4494204819202423
loss_pred:0.018468573689460754, decouple_loss:0.001045265351422131
loss_pred:0.017711689695715904, decouple_loss:0.001080466783605516
Iteration: 3057, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488782286643982, gen p mean: -0.056371454149484634, mean p set: 0.4493584930896759
loss_pred:0.01788986474275589, decouple_loss:0.0011437657522037625
The modified gen p mean: 0.44819748401641846, gen p mean: -0.05139811336994171, mean p set: 0.44867777824401855The modified gen p mean: 0.44895660877227783, gen p mean: -0.04978892579674721, mean p set: 0.44943687319755554
loss_pred:0.01681714504957199, decouple_loss:0.0012246982660144567
loss_pred:0.01669931411743164, decouple_loss:0.0011150341015309095
Iteration: 3058, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44995805621147156, gen p mean: -0.052370332181453705, mean p set: 0.45043838024139404
loss_pred:0.016808167099952698, decouple_loss:0.0011698995949700475
The modified gen p mean: 0.4486953318119049, gen p mean: -0.046183571219444275, mean p set: 0.449175626039505The modified gen p mean: 0.4497185945510864, gen p mean: -0.05350354686379433, mean p set: 0.45019885897636414
loss_pred:0.01738135889172554, decouple_loss:0.0011056306539103389
loss_pred:0.017256993800401688, decouple_loss:0.001271052984520793
Iteration: 3059, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44917985796928406, gen p mean: -0.05032380297780037, mean p set: 0.44966015219688416
loss_pred:0.016634678468108177, decouple_loss:0.0011731067206710577
The modified gen p mean: 0.44849124550819397, gen p mean: -0.048380039632320404, mean p set: 0.44897153973579407
The modified gen p mean: 0.4485275149345398, gen p mean: -0.04699529707431793, mean p set: 0.4490078091621399
loss_pred:0.016598060727119446, decouple_loss:0.0012892390368506312
loss_pred:0.0166619885712862, decouple_loss:0.001267359359189868
Iteration: 3060, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499937891960144, gen p mean: -0.04659599810838699, mean p set: 0.4504740536212921
loss_pred:0.0164827648550272, decouple_loss:0.0010951757431030273
The modified gen p mean: 0.4501723051071167, gen p mean: -0.05230946093797684, mean p set: 0.4506526291370392The modified gen p mean: 0.4487052857875824, gen p mean: -0.047182127833366394, mean p set: 0.4491855800151825
loss_pred:0.01758386380970478, decouple_loss:0.00119175692088902
loss_pred:0.016684116795659065, decouple_loss:0.001088838092982769
2023-05-02 14:12:27 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.053299181163311005, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.049184758216142654, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.049499474465847015, mean p set: 0.4500633478164673
loss_pred:0.018379956483840942, decouple_loss:0.0011244959896430373
loss_pred:0.017274251207709312, decouple_loss:0.0011567382607609034
loss_pred:0.01742534153163433, decouple_loss:0.0011272784322500229
WV_0_PC_1_EH_0_PS_40, loss: 0.01774999313056469, avg_mse: 0.025535812601447105
current test mse: 0.025536
Iteration: 3061, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44961875677108765, gen p mean: -0.04979347065091133, mean p set: 0.45009905099868774
The modified gen p mean: 0.4486680030822754, gen p mean: -0.05554678291082382, mean p set: 0.4491483271121979
The modified gen p mean: 0.44854292273521423, gen p mean: -0.04799152910709381, mean p set: 0.44902318716049194
loss_pred:0.016530213877558708, decouple_loss:0.0010557417990639806
loss_pred:0.017240723595023155, decouple_loss:0.0012020558351650834
loss_pred:0.016902098432183266, decouple_loss:0.0011848658323287964
Iteration: 3062, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44922593235969543, gen p mean: -0.049811847507953644, mean p set: 0.4497062563896179
loss_pred:0.016998333856463432, decouple_loss:0.0011979450937360525
The modified gen p mean: 0.44877374172210693, gen p mean: -0.050094131380319595, mean p set: 0.44925400614738464
The modified gen p mean: 0.4481669068336487, gen p mean: -0.053108006715774536, mean p set: 0.44864723086357117
loss_pred:0.016672290861606598, decouple_loss:0.0012089431984350085
loss_pred:0.01717754453420639, decouple_loss:0.0010112323798239231
Iteration: 3063, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44904962182044983, gen p mean: -0.048074569553136826, mean p set: 0.4495299160480499
loss_pred:0.016856154426932335, decouple_loss:0.0010449588298797607
The modified gen p mean: 0.44827064871788025, gen p mean: -0.04821170121431351, mean p set: 0.44875091314315796The modified gen p mean: 0.4496626555919647, gen p mean: -0.04916800186038017, mean p set: 0.4501429796218872
loss_pred:0.016117781400680542, decouple_loss:0.0010677502723410726
loss_pred:0.01700378954410553, decouple_loss:0.00104601273778826
Iteration: 3064, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448944091796875, gen p mean: -0.04887649044394493, mean p set: 0.4494244158267975
loss_pred:0.015945816412568092, decouple_loss:0.0010656265076249838
The modified gen p mean: 0.4492073953151703, gen p mean: -0.0494438111782074, mean p set: 0.4496876895427704The modified gen p mean: 0.44877198338508606, gen p mean: -0.04234807565808296, mean p set: 0.44925227761268616
loss_pred:0.016854500398039818, decouple_loss:0.001076661515980959
loss_pred:0.017052186653017998, decouple_loss:0.001177303260192275
Iteration: 3065, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499053955078125, gen p mean: -0.04723039269447327, mean p set: 0.450385719537735
loss_pred:0.016990579664707184, decouple_loss:0.0010203203419223428
The modified gen p mean: 0.4490707218647003, gen p mean: -0.05029334872961044, mean p set: 0.4495510160923004The modified gen p mean: 0.44845089316368103, gen p mean: -0.04358365386724472, mean p set: 0.4489312171936035
loss_pred:0.018133414909243584, decouple_loss:0.0010580976959317923
loss_pred:0.016842611134052277, decouple_loss:0.0009965217905119061
Iteration: 3066, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44877657294273376, gen p mean: -0.044904857873916626, mean p set: 0.44925686717033386
loss_pred:0.016718687489628792, decouple_loss:0.001023009535856545
The modified gen p mean: 0.45013245940208435, gen p mean: -0.047699205577373505, mean p set: 0.45061272382736206The modified gen p mean: 0.449593186378479, gen p mean: -0.04211657866835594, mean p set: 0.4500735104084015
loss_pred:0.016648855060338974, decouple_loss:0.001146202441304922
loss_pred:0.017329594120383263, decouple_loss:0.0011791025754064322
Iteration: 3067, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45028218626976013, gen p mean: -0.04682646319270134, mean p set: 0.4507625102996826
loss_pred:0.01750200055539608, decouple_loss:0.0010395648423582315
The modified gen p mean: 0.4494662880897522, gen p mean: -0.043927039951086044, mean p set: 0.4499465525150299The modified gen p mean: 0.44972893595695496, gen p mean: -0.04428704455494881, mean p set: 0.45020923018455505
loss_pred:0.016091063618659973, decouple_loss:0.0010472779395058751
loss_pred:0.01725168526172638, decouple_loss:0.0011190102668479085
Iteration: 3068, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44825479388237, gen p mean: -0.03851746395230293, mean p set: 0.4487350583076477
loss_pred:0.0168839693069458, decouple_loss:0.0010679492261260748
The modified gen p mean: 0.44963371753692627, gen p mean: -0.046727266162633896, mean p set: 0.450113981962204The modified gen p mean: 0.44881120324134827, gen p mean: -0.043238718062639236, mean p set: 0.44929149746894836
loss_pred:0.017093313857913017, decouple_loss:0.0010641717817634344
loss_pred:0.01732037030160427, decouple_loss:0.0010593377519398928
Iteration: 3069, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497009813785553, gen p mean: -0.04473602771759033, mean p set: 0.4501812756061554
loss_pred:0.01697845757007599, decouple_loss:0.0010565026896074414
The modified gen p mean: 0.45037803053855896, gen p mean: -0.04578867554664612, mean p set: 0.45085832476615906The modified gen p mean: 0.44969406723976135, gen p mean: -0.04615839198231697, mean p set: 0.45017439126968384
loss_pred:0.016973260790109634, decouple_loss:0.0010649088071659207
loss_pred:0.01733090728521347, decouple_loss:0.001160943298600614
Iteration: 3070, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495718479156494, gen p mean: -0.042061783373355865, mean p set: 0.4500521421432495
loss_pred:0.01594425179064274, decouple_loss:0.000942660728469491
The modified gen p mean: 0.4486444592475891, gen p mean: -0.04188551381230354, mean p set: 0.4491247832775116The modified gen p mean: 0.44947925209999084, gen p mean: -0.041960325092077255, mean p set: 0.44995957612991333
loss_pred:0.016786042600870132, decouple_loss:0.0010537266498431563
loss_pred:0.01677020452916622, decouple_loss:0.0008852954488247633
2023-05-02 14:14:22 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.04669196903705597, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04271524399518967, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.042859598994255066, mean p set: 0.4500633478164673
loss_pred:0.018288861960172653, decouple_loss:0.0011611260706558824
loss_pred:0.017207182943820953, decouple_loss:0.001157204038463533
loss_pred:0.017334261909127235, decouple_loss:0.0011309118708595634
WV_0_PC_1_EH_0_PS_40, loss: 0.017667589709162712, avg_mse: 0.025398312136530876
current test mse: 0.025398
Iteration: 3071, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497183859348297, gen p mean: -0.043646715581417084, mean p set: 0.4501986801624298
The modified gen p mean: 0.44948074221611023, gen p mean: -0.04373287409543991, mean p set: 0.4499610364437103
The modified gen p mean: 0.4498935341835022, gen p mean: -0.04214978590607643, mean p set: 0.4503738284111023
loss_pred:0.016479847952723503, decouple_loss:0.001105907023884356
loss_pred:0.016602667048573494, decouple_loss:0.0010190251050516963
loss_pred:0.01662280596792698, decouple_loss:0.0011065065627917647
Iteration: 3072, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496510326862335, gen p mean: -0.04619409516453743, mean p set: 0.4501313269138336
loss_pred:0.016604498028755188, decouple_loss:0.0009758066153153777
The modified gen p mean: 0.4479087293148041, gen p mean: -0.044951509684324265, mean p set: 0.4483890235424042
The modified gen p mean: 0.4481431245803833, gen p mean: -0.04478118196129799, mean p set: 0.4486234188079834
loss_pred:0.0167829729616642, decouple_loss:0.0010273634688928723
loss_pred:0.016680892556905746, decouple_loss:0.0009716522181406617
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012015_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012015_3_24hr.npz
NaN value num: 0
Iteration: 3073, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484390616416931, gen p mean: -0.04447174444794655, mean p set: 0.448919415473938
loss_pred:0.01462151762098074, decouple_loss:0.0010918492916971445
The modified gen p mean: 0.44903576374053955, gen p mean: -0.04831210896372795, mean p set: 0.44951605796813965The modified gen p mean: 0.4490232765674591, gen p mean: -0.044065721333026886, mean p set: 0.4495036005973816
loss_pred:0.015564949251711369, decouple_loss:0.0010914817685261369
loss_pred:0.014459268189966679, decouple_loss:0.0010105508845299482
Iteration: 3074, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4459594190120697, gen p mean: -0.05288160964846611, mean p set: 0.4464397132396698
loss_pred:0.01501881517469883, decouple_loss:0.0011847015703096986
The modified gen p mean: 0.44764211773872375, gen p mean: -0.05417059734463692, mean p set: 0.44812238216400146The modified gen p mean: 0.4482065737247467, gen p mean: -0.04870624467730522, mean p set: 0.4486868679523468
loss_pred:0.014893232844769955, decouple_loss:0.0011442680843174458
loss_pred:0.014485764317214489, decouple_loss:0.0011263069463893771
Iteration: 3075, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44919610023498535, gen p mean: -0.041228458285331726, mean p set: 0.44967639446258545
loss_pred:0.014652901329100132, decouple_loss:0.0011674612760543823
The modified gen p mean: 0.4479886591434479, gen p mean: -0.053335338830947876, mean p set: 0.448468953371048
The modified gen p mean: 0.44896137714385986, gen p mean: -0.04201660305261612, mean p set: 0.44944167137145996
loss_pred:0.014450190588831902, decouple_loss:0.0010866677621379495
loss_pred:0.014928876422345638, decouple_loss:0.0010843736818060279
Iteration: 3076, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44937098026275635, gen p mean: -0.041784536093473434, mean p set: 0.44985130429267883
loss_pred:0.014458728022873402, decouple_loss:0.0010965908877551556
The modified gen p mean: 0.4482586979866028, gen p mean: -0.043712228536605835, mean p set: 0.4487389624118805The modified gen p mean: 0.4471625089645386, gen p mean: -0.04464641958475113, mean p set: 0.44764280319213867
loss_pred:0.015102207660675049, decouple_loss:0.001063777832314372
loss_pred:0.014460694044828415, decouple_loss:0.0013546643313020468
Iteration: 3077, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481883943080902, gen p mean: -0.0490756630897522, mean p set: 0.4486686885356903
loss_pred:0.014355525374412537, decouple_loss:0.001430546515621245
The modified gen p mean: 0.4474603533744812, gen p mean: -0.04817654937505722, mean p set: 0.4479406476020813The modified gen p mean: 0.4463062882423401, gen p mean: -0.05195093899965286, mean p set: 0.4467865526676178
loss_pred:0.01408715732395649, decouple_loss:0.0012183253420516849
loss_pred:0.01429600827395916, decouple_loss:0.0013387887738645077
Iteration: 3078, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475211799144745, gen p mean: -0.04471999779343605, mean p set: 0.4480014741420746
loss_pred:0.0139230377972126, decouple_loss:0.0012218180345371366
The modified gen p mean: 0.44719794392585754, gen p mean: -0.04827143996953964, mean p set: 0.44767823815345764The modified gen p mean: 0.44641435146331787, gen p mean: -0.04864443466067314, mean p set: 0.44689464569091797
loss_pred:0.013781326822936535, decouple_loss:0.0013370139058679342
loss_pred:0.014220178127288818, decouple_loss:0.0011718481546267867
Iteration: 3079, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44798973202705383, gen p mean: -0.03818879276514053, mean p set: 0.44847002625465393
loss_pred:0.01467594038695097, decouple_loss:0.0012590894475579262
The modified gen p mean: 0.44796302914619446, gen p mean: -0.04752148315310478, mean p set: 0.44844329357147217The modified gen p mean: 0.4472449719905853, gen p mean: -0.04554327204823494, mean p set: 0.4477252662181854
loss_pred:0.013971295207738876, decouple_loss:0.0012511026579886675
loss_pred:0.014615368098020554, decouple_loss:0.0012200931087136269
Iteration: 3080, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44793835282325745, gen p mean: -0.04274991154670715, mean p set: 0.44841864705085754
loss_pred:0.01385948620736599, decouple_loss:0.0013483039801940322
The modified gen p mean: 0.44779133796691895, gen p mean: -0.04513632878661156, mean p set: 0.44827160239219666The modified gen p mean: 0.4475595951080322, gen p mean: -0.04178750514984131, mean p set: 0.4480399191379547
loss_pred:0.014653085730969906, decouple_loss:0.0012283602263778448
loss_pred:0.013537012971937656, decouple_loss:0.0013002562336623669
2023-05-02 14:16:53 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.049715593457221985, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04610607400536537, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04592514783143997, mean p set: 0.4500633478164673
loss_pred:0.01925532892346382, decouple_loss:0.0011552070500329137
loss_pred:0.017996570095419884, decouple_loss:0.001243446720764041
loss_pred:0.018084758892655373, decouple_loss:0.0012483970494940877
WV_0_PC_1_EH_0_PS_40, loss: 0.018506336957216263, avg_mse: 0.026995081454515457
current test mse: 0.026995
Iteration: 3081, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474680721759796, gen p mean: -0.04689946398139, mean p set: 0.4479483664035797
The modified gen p mean: 0.4487364590167999, gen p mean: -0.04267857223749161, mean p set: 0.4492167532444
The modified gen p mean: 0.4477037787437439, gen p mean: -0.0524546280503273, mean p set: 0.448184072971344
loss_pred:0.013578205369412899, decouple_loss:0.0012506649363785982
loss_pred:0.0136750228703022, decouple_loss:0.001101029454730451
loss_pred:0.014572623185813427, decouple_loss:0.0012109271483495831
Iteration: 3082, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44895514845848083, gen p mean: -0.04678242653608322, mean p set: 0.4494354724884033
loss_pred:0.013983232900500298, decouple_loss:0.001172468881122768
The modified gen p mean: 0.4471014440059662, gen p mean: -0.0474785678088665, mean p set: 0.4475817382335663The modified gen p mean: 0.44746753573417664, gen p mean: -0.050758831202983856, mean p set: 0.44794782996177673
loss_pred:0.013948298990726471, decouple_loss:0.0012978067388758063
loss_pred:0.01423185970634222, decouple_loss:0.0013450784608721733
Iteration: 3083, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.445667028427124, gen p mean: -0.054931383579969406, mean p set: 0.4461473524570465
loss_pred:0.01398722268640995, decouple_loss:0.0013097201008349657
The modified gen p mean: 0.44597384333610535, gen p mean: -0.04976612702012062, mean p set: 0.44645413756370544The modified gen p mean: 0.4480283856391907, gen p mean: -0.046673670411109924, mean p set: 0.44850867986679077
loss_pred:0.013902373611927032, decouple_loss:0.0013167894212529063
loss_pred:0.01388758234679699, decouple_loss:0.0012552370317280293
Iteration: 3084, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44818437099456787, gen p mean: -0.05147286504507065, mean p set: 0.4486646354198456
loss_pred:0.013742359355092049, decouple_loss:0.00124494475312531
The modified gen p mean: 0.44860631227493286, gen p mean: -0.051251377910375595, mean p set: 0.44908660650253296The modified gen p mean: 0.44841551780700684, gen p mean: -0.05311552807688713, mean p set: 0.44889581203460693
loss_pred:0.013487073592841625, decouple_loss:0.0013843986671417952
loss_pred:0.013828042894601822, decouple_loss:0.0012768236920237541
Iteration: 3085, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482795298099518, gen p mean: -0.04792030155658722, mean p set: 0.4487598240375519
loss_pred:0.01406760886311531, decouple_loss:0.0011063084239140153
The modified gen p mean: 0.4484703838825226, gen p mean: -0.054470501840114594, mean p set: 0.4489506781101227The modified gen p mean: 0.4472908675670624, gen p mean: -0.051912691444158554, mean p set: 0.44777119159698486
loss_pred:0.014016460627317429, decouple_loss:0.0011628965148702264
loss_pred:0.013919677585363388, decouple_loss:0.0012224169913679361
Iteration: 3086, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477511942386627, gen p mean: -0.05597049370408058, mean p set: 0.4482314884662628
loss_pred:0.01354952808469534, decouple_loss:0.0012177006574347615
The modified gen p mean: 0.44597190618515015, gen p mean: -0.053353313356637955, mean p set: 0.44645223021507263The modified gen p mean: 0.4485762417316437, gen p mean: -0.051870010793209076, mean p set: 0.4490565061569214
loss_pred:0.01376910787075758, decouple_loss:0.0012775012291967869
loss_pred:0.013521281071007252, decouple_loss:0.0012183518847450614
Iteration: 3087, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44821879267692566, gen p mean: -0.05179305002093315, mean p set: 0.44869908690452576
loss_pred:0.013365155085921288, decouple_loss:0.0012700811494141817
The modified gen p mean: 0.4463588297367096, gen p mean: -0.047418441623449326, mean p set: 0.4468391239643097The modified gen p mean: 0.44882652163505554, gen p mean: -0.04548243060708046, mean p set: 0.44930681586265564
loss_pred:0.014654030092060566, decouple_loss:0.0011280206963419914
loss_pred:0.013837595470249653, decouple_loss:0.0011145290918648243
Iteration: 3088, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480310380458832, gen p mean: -0.04565027356147766, mean p set: 0.4485113322734833
loss_pred:0.013352888636291027, decouple_loss:0.00121504464186728
The modified gen p mean: 0.44732344150543213, gen p mean: -0.043609850108623505, mean p set: 0.44780370593070984The modified gen p mean: 0.4474125802516937, gen p mean: -0.050604190677404404, mean p set: 0.4478928744792938
loss_pred:0.01420896127820015, decouple_loss:0.0011931705521419644
loss_pred:0.01347455382347107, decouple_loss:0.0011904112761840224
Iteration: 3089, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471522867679596, gen p mean: -0.045607972890138626, mean p set: 0.4476326107978821
loss_pred:0.01339135691523552, decouple_loss:0.0010378744918853045
The modified gen p mean: 0.44835665822029114, gen p mean: -0.04655980318784714, mean p set: 0.4488369822502136The modified gen p mean: 0.4453616142272949, gen p mean: -0.052996180951595306, mean p set: 0.44584187865257263
loss_pred:0.013719547539949417, decouple_loss:0.001112733269110322
loss_pred:0.0141562819480896, decouple_loss:0.0011373857269063592
Iteration: 3090, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44778886437416077, gen p mean: -0.04765656590461731, mean p set: 0.44826918840408325
loss_pred:0.013619142584502697, decouple_loss:0.001087006414309144
The modified gen p mean: 0.44716429710388184, gen p mean: -0.044853609055280685, mean p set: 0.44764459133148193The modified gen p mean: 0.4483889639377594, gen p mean: -0.042165666818618774, mean p set: 0.4488692581653595
loss_pred:0.01343137864023447, decouple_loss:0.001073798630386591
loss_pred:0.013854474760591984, decouple_loss:0.00106365408282727
2023-05-02 14:18:47 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.04983816668391228, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04647992551326752, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04609008505940437, mean p set: 0.4500633478164673
loss_pred:0.019196126610040665, decouple_loss:0.001204181695356965
loss_pred:0.017994245514273643, decouple_loss:0.0011963446158915758
loss_pred:0.01802239567041397, decouple_loss:0.0011722311610355973
WV_0_PC_1_EH_0_PS_40, loss: 0.018463803455233574, avg_mse: 0.026975737884640694
current test mse: 0.026976
Iteration: 3091, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485549032688141, gen p mean: -0.04362516105175018, mean p set: 0.4490351974964142
The modified gen p mean: 0.4484618604183197, gen p mean: -0.047693848609924316, mean p set: 0.4489421248435974
The modified gen p mean: 0.4468974173069, gen p mean: -0.04636505991220474, mean p set: 0.4473777115345001
loss_pred:0.014041228219866753, decouple_loss:0.0011846052948385477
loss_pred:0.013304769061505795, decouple_loss:0.0012152350973337889
loss_pred:0.013386564329266548, decouple_loss:0.0011413444299250841
Iteration: 3092, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447185218334198, gen p mean: -0.04391074180603027, mean p set: 0.4476655125617981
loss_pred:0.013025128282606602, decouple_loss:0.0010420514736324549
The modified gen p mean: 0.44762107729911804, gen p mean: -0.04821441322565079, mean p set: 0.4481014013290405The modified gen p mean: 0.4475625157356262, gen p mean: -0.047713734209537506, mean p set: 0.4480428397655487
loss_pred:0.013113105669617653, decouple_loss:0.0010778338182717562
loss_pred:0.013652103021740913, decouple_loss:0.0011211097007617354
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012015_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012015_3_24hr.npz
NaN value num: 0
Iteration: 3093, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500325322151184, gen p mean: -0.04106718301773071, mean p set: 0.4505128264427185
loss_pred:0.015919741243124008, decouple_loss:0.0011849980801343918
The modified gen p mean: 0.44911545515060425, gen p mean: -0.03970515355467796, mean p set: 0.44959574937820435The modified gen p mean: 0.4482898414134979, gen p mean: -0.04034027084708214, mean p set: 0.448770135641098
loss_pred:0.016701119020581245, decouple_loss:0.0011611671652644873
loss_pred:0.016317835077643394, decouple_loss:0.0011370077263563871
Iteration: 3094, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45025137066841125, gen p mean: -0.04101325944066048, mean p set: 0.45073163509368896
loss_pred:0.01664169691503048, decouple_loss:0.0012003200827166438
The modified gen p mean: 0.44841673970222473, gen p mean: -0.04013925418257713, mean p set: 0.44889700412750244The modified gen p mean: 0.44769155979156494, gen p mean: -0.03980164974927902, mean p set: 0.44817185401916504
loss_pred:0.01687208190560341, decouple_loss:0.0011800684733316302
loss_pred:0.016516737639904022, decouple_loss:0.0012288696598261595
Iteration: 3095, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45086026191711426, gen p mean: -0.04016456380486488, mean p set: 0.45134055614471436
loss_pred:0.016727862879633904, decouple_loss:0.0011582003207877278
The modified gen p mean: 0.4473506510257721, gen p mean: -0.043366726487874985, mean p set: 0.4478309452533722The modified gen p mean: 0.44984108209609985, gen p mean: -0.04546697810292244, mean p set: 0.45032137632369995
loss_pred:0.016350990161299706, decouple_loss:0.0011534522054716945
loss_pred:0.016450392082333565, decouple_loss:0.0011608455097302794
Iteration: 3096, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44786569476127625, gen p mean: -0.05272319167852402, mean p set: 0.44834598898887634
loss_pred:0.0160025916993618, decouple_loss:0.0011533991200849414
The modified gen p mean: 0.44963186979293823, gen p mean: -0.042925603687763214, mean p set: 0.45011213421821594The modified gen p mean: 0.4476284086704254, gen p mean: -0.04377060756087303, mean p set: 0.4481086730957031
loss_pred:0.01645110920071602, decouple_loss:0.0011580610880628228
loss_pred:0.01683698408305645, decouple_loss:0.0012649557320401073
Iteration: 3097, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507046639919281, gen p mean: -0.043686799705028534, mean p set: 0.4511849880218506
loss_pred:0.0154642378911376, decouple_loss:0.0012240352807566524
The modified gen p mean: 0.45105382800102234, gen p mean: -0.043273307383060455, mean p set: 0.45153409242630005The modified gen p mean: 0.45010796189308167, gen p mean: -0.04782915115356445, mean p set: 0.4505882263183594
loss_pred:0.015303405933082104, decouple_loss:0.0012133739655837417
loss_pred:0.016050871461629868, decouple_loss:0.001149014220573008
Iteration: 3098, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44673827290534973, gen p mean: -0.051660582423210144, mean p set: 0.44721853733062744
loss_pred:0.0158114992082119, decouple_loss:0.001307557220570743
The modified gen p mean: 0.44797125458717346, gen p mean: -0.044932954013347626, mean p set: 0.44845154881477356The modified gen p mean: 0.4493338465690613, gen p mean: -0.052582282572984695, mean p set: 0.4498141407966614
loss_pred:0.016363268718123436, decouple_loss:0.0012629406992346048
loss_pred:0.01665661484003067, decouple_loss:0.0012909104116261005
Iteration: 3099, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44819462299346924, gen p mean: -0.055105771869421005, mean p set: 0.44867488741874695
loss_pred:0.01592082716524601, decouple_loss:0.0012248230632394552
The modified gen p mean: 0.4505627155303955, gen p mean: -0.04642084985971451, mean p set: 0.4510430097579956The modified gen p mean: 0.44914600253105164, gen p mean: -0.044903188943862915, mean p set: 0.44962626695632935
loss_pred:0.015425695106387138, decouple_loss:0.0012111964169889688
loss_pred:0.016521014273166656, decouple_loss:0.0012073991820216179
Iteration: 3100, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4517247974872589, gen p mean: -0.045044973492622375, mean p set: 0.4522051215171814
loss_pred:0.014985845424234867, decouple_loss:0.0010078169871121645
The modified gen p mean: 0.4487427771091461, gen p mean: -0.05787328630685806, mean p set: 0.4492231011390686The modified gen p mean: 0.4490819573402405, gen p mean: -0.048122212290763855, mean p set: 0.4495622515678406
loss_pred:0.01665082760155201, decouple_loss:0.0010160856181755662
loss_pred:0.016485312953591347, decouple_loss:0.0010485734092071652
2023-05-02 14:21:25 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.05494173988699913, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.05187804996967316, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.05146956443786621, mean p set: 0.4500633478164673
loss_pred:0.018708230927586555, decouple_loss:0.001359495217911899
loss_pred:0.017542915418744087, decouple_loss:0.0012804861180484295
loss_pred:0.017587754875421524, decouple_loss:0.0013431337429210544
WV_0_PC_1_EH_0_PS_40, loss: 0.01801268570125103, avg_mse: 0.02606276050209999
current test mse: 0.026063
Iteration: 3101, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45077434182167053, gen p mean: -0.04373587295413017, mean p set: 0.45125463604927063
The modified gen p mean: 0.44674256443977356, gen p mean: -0.05071069300174713, mean p set: 0.44722285866737366
The modified gen p mean: 0.4505573809146881, gen p mean: -0.045867905020713806, mean p set: 0.4510376751422882
loss_pred:0.015963109210133553, decouple_loss:0.0011327003594487906
loss_pred:0.014494363218545914, decouple_loss:0.0011604406172409654
loss_pred:0.015595356933772564, decouple_loss:0.0011954203946515918
Iteration: 3102, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501286447048187, gen p mean: -0.04772625491023064, mean p set: 0.4506089687347412
loss_pred:0.015898339450359344, decouple_loss:0.0010706192115321755
The modified gen p mean: 0.4496336281299591, gen p mean: -0.04875954985618591, mean p set: 0.4501139223575592The modified gen p mean: 0.4480365812778473, gen p mean: -0.04940279200673103, mean p set: 0.4485168755054474
loss_pred:0.015994207933545113, decouple_loss:0.0012280454393476248
loss_pred:0.0162991750985384, decouple_loss:0.0010287039913237095
Iteration: 3103, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44794586300849915, gen p mean: -0.05262810364365578, mean p set: 0.44842615723609924
loss_pred:0.015974802896380424, decouple_loss:0.0012047146447002888
The modified gen p mean: 0.4507363736629486, gen p mean: -0.04336680471897125, mean p set: 0.4512166678905487The modified gen p mean: 0.4502987563610077, gen p mean: -0.04610433429479599, mean p set: 0.4507790505886078
loss_pred:0.015502852387726307, decouple_loss:0.0011665393831208348
loss_pred:0.015820154920220375, decouple_loss:0.001133845653384924
Iteration: 3104, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448063462972641, gen p mean: -0.04861697554588318, mean p set: 0.4485437870025635
loss_pred:0.016530603170394897, decouple_loss:0.0011943483259528875
The modified gen p mean: 0.4497939646244049, gen p mean: -0.047747042030096054, mean p set: 0.4502742886543274The modified gen p mean: 0.4486439526081085, gen p mean: -0.0440383106470108, mean p set: 0.449124276638031
loss_pred:0.016364838927984238, decouple_loss:0.0011766499374061823
loss_pred:0.015740206465125084, decouple_loss:0.001206912100315094
Iteration: 3105, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490266740322113, gen p mean: -0.044610586017370224, mean p set: 0.4495069682598114
loss_pred:0.016863301396369934, decouple_loss:0.0010603799019008875
The modified gen p mean: 0.4477318227291107, gen p mean: -0.054828252643346786, mean p set: 0.4482121169567108The modified gen p mean: 0.4485870599746704, gen p mean: -0.04791805520653725, mean p set: 0.4490673840045929
loss_pred:0.01601879671216011, decouple_loss:0.0010505724931135774
loss_pred:0.01634274609386921, decouple_loss:0.0010508967097848654
Iteration: 3106, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45026326179504395, gen p mean: -0.047122325748205185, mean p set: 0.45074358582496643
loss_pred:0.016029218211770058, decouple_loss:0.0011905094143003225
The modified gen p mean: 0.44710466265678406, gen p mean: -0.051052115857601166, mean p set: 0.44758492708206177The modified gen p mean: 0.4471445083618164, gen p mean: -0.05038260668516159, mean p set: 0.4476247727870941
loss_pred:0.016476882621645927, decouple_loss:0.0011685194913297892
loss_pred:0.015527383424341679, decouple_loss:0.0011321022175252438
Iteration: 3107, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476175904273987, gen p mean: -0.05243780463933945, mean p set: 0.4480978846549988
loss_pred:0.01627517305314541, decouple_loss:0.0009925037156790495
The modified gen p mean: 0.4485575556755066, gen p mean: -0.050756461918354034, mean p set: 0.4490378499031067The modified gen p mean: 0.4507257342338562, gen p mean: -0.047214481979608536, mean p set: 0.4512060284614563
loss_pred:0.01522530522197485, decouple_loss:0.0010077800834551454
loss_pred:0.01601235568523407, decouple_loss:0.0009840409038588405
Iteration: 3108, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44873711466789246, gen p mean: -0.04978764057159424, mean p set: 0.44921740889549255
loss_pred:0.016611577942967415, decouple_loss:0.0010454041184857488
The modified gen p mean: 0.44891270995140076, gen p mean: -0.04968227073550224, mean p set: 0.44939300417900085
The modified gen p mean: 0.44839614629745483, gen p mean: -0.060656871646642685, mean p set: 0.44887641072273254
loss_pred:0.015792256221175194, decouple_loss:0.0010916658211499453
loss_pred:0.016247117891907692, decouple_loss:0.0011348541593179107
Iteration: 3109, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493923783302307, gen p mean: -0.05385051667690277, mean p set: 0.4498726725578308
loss_pred:0.016750812530517578, decouple_loss:0.0009362288401462138
The modified gen p mean: 0.44995397329330444, gen p mean: -0.05004056170582771, mean p set: 0.45043426752090454The modified gen p mean: 0.44949010014533997, gen p mean: -0.05133804678916931, mean p set: 0.44997039437294006
loss_pred:0.015617409721016884, decouple_loss:0.0009615570888854563
loss_pred:0.01641693152487278, decouple_loss:0.0010429297108203173
Iteration: 3110, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45003268122673035, gen p mean: -0.046455204486846924, mean p set: 0.45051300525665283
loss_pred:0.015832433477044106, decouple_loss:0.001157908933237195
The modified gen p mean: 0.4507276117801666, gen p mean: -0.046485427767038345, mean p set: 0.4512079358100891The modified gen p mean: 0.4484102725982666, gen p mean: -0.04938628524541855, mean p set: 0.4488905668258667
loss_pred:0.015130793675780296, decouple_loss:0.001117237377911806
loss_pred:0.016233008354902267, decouple_loss:0.0010681202402338386
2023-05-02 14:23:20 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.05353595316410065, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.050368841737508774, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.05007965490221977, mean p set: 0.4500633478164673
loss_pred:0.01862880401313305, decouple_loss:0.0012783471029251814
loss_pred:0.017563993111252785, decouple_loss:0.0011919270036742091
loss_pred:0.017536599189043045, decouple_loss:0.0012572013074532151
WV_0_PC_1_EH_0_PS_40, loss: 0.01797192543745041, avg_mse: 0.025986280292272568
current test mse: 0.025986
Iteration: 3111, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44947001338005066, gen p mean: -0.043371278792619705, mean p set: 0.44995033740997314
The modified gen p mean: 0.4507608711719513, gen p mean: -0.043178997933864594, mean p set: 0.4512411952018738
The modified gen p mean: 0.44912129640579224, gen p mean: -0.0419367253780365, mean p set: 0.44960159063339233
loss_pred:0.015580946579575539, decouple_loss:0.001067488919943571
loss_pred:0.01616554893553257, decouple_loss:0.0011154887033626437
loss_pred:0.014626996591687202, decouple_loss:0.0010691575007513165
Iteration: 3112, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494977295398712, gen p mean: -0.04418337345123291, mean p set: 0.4499780237674713
loss_pred:0.016606967896223068, decouple_loss:0.0012134049320593476
The modified gen p mean: 0.45115989446640015, gen p mean: -0.04074065014719963, mean p set: 0.45164018869400024The modified gen p mean: 0.4507928490638733, gen p mean: -0.03993377462029457, mean p set: 0.4512731432914734
loss_pred:0.015099655836820602, decouple_loss:0.0011606040643528104
loss_pred:0.01466648280620575, decouple_loss:0.001047590863890946
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012011_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012011_3_24hr.npz
NaN value num: 0
Iteration: 3113, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503602981567383, gen p mean: -0.037748437374830246, mean p set: 0.4508405923843384
loss_pred:0.015297953970730305, decouple_loss:0.001291865948587656
The modified gen p mean: 0.449347585439682, gen p mean: -0.04354123771190643, mean p set: 0.4498278796672821The modified gen p mean: 0.44893983006477356, gen p mean: -0.04805397242307663, mean p set: 0.44942015409469604
loss_pred:0.015903733670711517, decouple_loss:0.0012988370144739747
loss_pred:0.01596854254603386, decouple_loss:0.0011554384836927056
Iteration: 3114, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44776785373687744, gen p mean: -0.046636033803224564, mean p set: 0.4482481777667999
loss_pred:0.015965817496180534, decouple_loss:0.0010736315743997693
The modified gen p mean: 0.4502812325954437, gen p mean: -0.04472417011857033, mean p set: 0.4507615268230438The modified gen p mean: 0.4525482952594757, gen p mean: -0.042618975043296814, mean p set: 0.4530285596847534
loss_pred:0.015680624172091484, decouple_loss:0.0012053229147568345
loss_pred:0.01589287258684635, decouple_loss:0.0010362776229158044
Iteration: 3115, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490250051021576, gen p mean: -0.04231000691652298, mean p set: 0.4495052993297577
loss_pred:0.015751048922538757, decouple_loss:0.0013290633214637637
The modified gen p mean: 0.4502754211425781, gen p mean: -0.03835517540574074, mean p set: 0.45075568556785583The modified gen p mean: 0.44961434602737427, gen p mean: -0.04596896842122078, mean p set: 0.45009464025497437
loss_pred:0.015373501926660538, decouple_loss:0.0010685987072065473
loss_pred:0.01552877202630043, decouple_loss:0.0011901365360245109
Iteration: 3116, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4521077275276184, gen p mean: -0.040961042046546936, mean p set: 0.4525880217552185
loss_pred:0.015223047696053982, decouple_loss:0.0010150352027267218
The modified gen p mean: 0.4514996409416199, gen p mean: -0.03875106945633888, mean p set: 0.45197993516921997The modified gen p mean: 0.44904929399490356, gen p mean: -0.044089630246162415, mean p set: 0.44952961802482605
loss_pred:0.01571785844862461, decouple_loss:0.001067478908225894
loss_pred:0.015897955745458603, decouple_loss:0.0010565740521997213
Iteration: 3117, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45114827156066895, gen p mean: -0.04359083250164986, mean p set: 0.45162856578826904
loss_pred:0.014686159789562225, decouple_loss:0.0012041983427479863
The modified gen p mean: 0.44916778802871704, gen p mean: -0.043532487004995346, mean p set: 0.44964808225631714
The modified gen p mean: 0.4527747631072998, gen p mean: -0.03875397890806198, mean p set: 0.4532550275325775
loss_pred:0.01614740677177906, decouple_loss:0.001190396142192185
loss_pred:0.015309453010559082, decouple_loss:0.0011519454419612885
Iteration: 3118, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45214441418647766, gen p mean: -0.04198869317770004, mean p set: 0.45262470841407776
loss_pred:0.015243938192725182, decouple_loss:0.0010999449295923114
The modified gen p mean: 0.4527755677700043, gen p mean: -0.039698679000139236, mean p set: 0.45325586199760437The modified gen p mean: 0.44802626967430115, gen p mean: -0.041777148842811584, mean p set: 0.44850653409957886
loss_pred:0.015627548098564148, decouple_loss:0.001115124672651291
loss_pred:0.01621226966381073, decouple_loss:0.00106439262162894
Iteration: 3119, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45051145553588867, gen p mean: -0.03754432871937752, mean p set: 0.4509917199611664
loss_pred:0.015312465839087963, decouple_loss:0.0010604687267914414
The modified gen p mean: 0.45039981603622437, gen p mean: -0.03855736181139946, mean p set: 0.45088011026382446The modified gen p mean: 0.45353665947914124, gen p mean: -0.04406455531716347, mean p set: 0.4540169835090637
loss_pred:0.01501686405390501, decouple_loss:0.0011828782735392451
loss_pred:0.014971108175814152, decouple_loss:0.0012941134627908468
Iteration: 3120, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44808679819107056, gen p mean: -0.04531721770763397, mean p set: 0.44856709241867065
loss_pred:0.016080990433692932, decouple_loss:0.001084822928532958
The modified gen p mean: 0.4502444267272949, gen p mean: -0.03942450135946274, mean p set: 0.450724720954895The modified gen p mean: 0.4513629674911499, gen p mean: -0.03867728263139725, mean p set: 0.4518432915210724
loss_pred:0.01520331297069788, decouple_loss:0.001060984912328422
loss_pred:0.015256841666996479, decouple_loss:0.0010768742067739367
2023-05-02 14:25:51 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.05167673900723457, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.048443324863910675, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04819345474243164, mean p set: 0.4500633478164673
loss_pred:0.018530644476413727, decouple_loss:0.0011774731101468205
loss_pred:0.01748834364116192, decouple_loss:0.0011031756876036525
loss_pred:0.017534878104925156, decouple_loss:0.0011466608848422766
WV_0_PC_1_EH_0_PS_40, loss: 0.017908411100506783, avg_mse: 0.025882357731461525
current test mse: 0.025882
Iteration: 3121, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479731619358063, gen p mean: -0.04652897268533707, mean p set: 0.448453426361084
The modified gen p mean: 0.4536969065666199, gen p mean: -0.041078511625528336, mean p set: 0.45417720079421997
The modified gen p mean: 0.44970130920410156, gen p mean: -0.0446346141397953, mean p set: 0.45018160343170166
loss_pred:0.016028905287384987, decouple_loss:0.001026907586492598
loss_pred:0.015941064804792404, decouple_loss:0.0010824203491210938
loss_pred:0.01610797457396984, decouple_loss:0.0010846243239939213
Iteration: 3122, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45109036564826965, gen p mean: -0.04256373643875122, mean p set: 0.45157068967819214
loss_pred:0.015348208136856556, decouple_loss:0.001202843734063208
The modified gen p mean: 0.452358216047287, gen p mean: -0.04063548892736435, mean p set: 0.4528384804725647The modified gen p mean: 0.45214828848838806, gen p mean: -0.04092485085129738, mean p set: 0.45262858271598816
loss_pred:0.014920061454176903, decouple_loss:0.0013570733135566115
loss_pred:0.015539033338427544, decouple_loss:0.0010611106408759952
Iteration: 3123, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490574598312378, gen p mean: -0.046174656599760056, mean p set: 0.4495377540588379
loss_pred:0.01598786748945713, decouple_loss:0.0010736736003309488
The modified gen p mean: 0.4494574964046478, gen p mean: -0.04525834321975708, mean p set: 0.4499378204345703The modified gen p mean: 0.45012104511260986, gen p mean: -0.04298821836709976, mean p set: 0.45060133934020996
loss_pred:0.015621737577021122, decouple_loss:0.0010442580096423626
loss_pred:0.015015237964689732, decouple_loss:0.0010374889243394136
Iteration: 3124, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4534391462802887, gen p mean: -0.03724893927574158, mean p set: 0.4539194405078888
loss_pred:0.015083299949765205, decouple_loss:0.0012249377323314548
The modified gen p mean: 0.45334023237228394, gen p mean: -0.039704203605651855, mean p set: 0.4538205564022064The modified gen p mean: 0.4529041349887848, gen p mean: -0.03701142966747284, mean p set: 0.4533843994140625
loss_pred:0.015981918200850487, decouple_loss:0.001257620402611792
loss_pred:0.01587463915348053, decouple_loss:0.001259428565390408
Iteration: 3125, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44835197925567627, gen p mean: -0.03852458298206329, mean p set: 0.44883227348327637
loss_pred:0.016030702739953995, decouple_loss:0.0009824087610468268
The modified gen p mean: 0.4511868953704834, gen p mean: -0.03982732445001602, mean p set: 0.4516671597957611The modified gen p mean: 0.45162874460220337, gen p mean: -0.03699195757508278, mean p set: 0.45210903882980347
loss_pred:0.015346938744187355, decouple_loss:0.000967437750659883
loss_pred:0.01587294414639473, decouple_loss:0.0010123845422640443
Iteration: 3126, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45138776302337646, gen p mean: -0.03696025162935257, mean p set: 0.45186808705329895
loss_pred:0.014525138773024082, decouple_loss:0.0012946677161380649
The modified gen p mean: 0.4505225718021393, gen p mean: -0.030709922313690186, mean p set: 0.4510028660297394The modified gen p mean: 0.4538687467575073, gen p mean: -0.03919883072376251, mean p set: 0.4543490707874298
loss_pred:0.015152012929320335, decouple_loss:0.001191461575217545
loss_pred:0.01498667523264885, decouple_loss:0.001426674542017281
Iteration: 3127, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45189160108566284, gen p mean: -0.03206679970026016, mean p set: 0.45237189531326294
The modified gen p mean: 0.4496348202228546, gen p mean: -0.03956824913620949, mean p set: 0.4501151144504547
loss_pred:0.01528530940413475, decouple_loss:0.0010394875425845385
loss_pred:0.015514328144490719, decouple_loss:0.0010841299081221223
The modified gen p mean: 0.45065250992774963, gen p mean: -0.03699294850230217, mean p set: 0.45113280415534973
loss_pred:0.014683040790259838, decouple_loss:0.0010041154455393553
Iteration: 3128, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4515826106071472, gen p mean: -0.0318906307220459, mean p set: 0.4520629048347473
loss_pred:0.015444032847881317, decouple_loss:0.0011885284911841154
The modified gen p mean: 0.4522474408149719, gen p mean: -0.031210333108901978, mean p set: 0.452727735042572The modified gen p mean: 0.45147180557250977, gen p mean: -0.03396020084619522, mean p set: 0.45195209980010986
loss_pred:0.014850782230496407, decouple_loss:0.0011700948234647512
loss_pred:0.015366642735898495, decouple_loss:0.0011576240649446845
Iteration: 3129, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45263221859931946, gen p mean: -0.03456718102097511, mean p set: 0.45311251282691956
loss_pred:0.014412065967917442, decouple_loss:0.0009768079034984112
The modified gen p mean: 0.4496529698371887, gen p mean: -0.037126801908016205, mean p set: 0.4501332640647888The modified gen p mean: 0.45116493105888367, gen p mean: -0.03648579120635986, mean p set: 0.45164522528648376
loss_pred:0.0156144043430686, decouple_loss:0.0009899134747684002
loss_pred:0.015542767941951752, decouple_loss:0.0010981741361320019
Iteration: 3130, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484826624393463, gen p mean: -0.03805888444185257, mean p set: 0.4489629566669464
loss_pred:0.0159145500510931, decouple_loss:0.001152829616330564
The modified gen p mean: 0.4490417540073395, gen p mean: -0.03922204300761223, mean p set: 0.4495220482349396The modified gen p mean: 0.4536885619163513, gen p mean: -0.035245731472969055, mean p set: 0.4541688859462738
loss_pred:0.01588526740670204, decouple_loss:0.001194181153550744
loss_pred:0.015132243745028973, decouple_loss:0.0013246812159195542
2023-05-02 14:27:45 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.04683869332075119, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04328875243663788, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04344213753938675, mean p set: 0.4500633478164673
loss_pred:0.018564946949481964, decouple_loss:0.001125428476370871
loss_pred:0.017466675490140915, decouple_loss:0.0011510946787893772
loss_pred:0.0174790620803833, decouple_loss:0.0011957822134718299
WV_0_PC_1_EH_0_PS_40, loss: 0.017894767224788666, avg_mse: 0.025858834385871887
current test mse: 0.025859
Iteration: 3131, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.451873779296875, gen p mean: -0.037669528275728226, mean p set: 0.4523541033267975
The modified gen p mean: 0.44947129487991333, gen p mean: -0.040725838392972946, mean p set: 0.4499515891075134
The modified gen p mean: 0.44795286655426025, gen p mean: -0.036950696259737015, mean p set: 0.44843316078186035
loss_pred:0.01602085866034031, decouple_loss:0.0010736365802586079
loss_pred:0.015776528045535088, decouple_loss:0.000980067765340209
loss_pred:0.015037965029478073, decouple_loss:0.0011134390952065587
Iteration: 3132, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45128703117370605, gen p mean: -0.03985106945037842, mean p set: 0.45176732540130615
loss_pred:0.015644075348973274, decouple_loss:0.0012208742555230856
The modified gen p mean: 0.4519825875759125, gen p mean: -0.0354304313659668, mean p set: 0.4524628818035126The modified gen p mean: 0.4527861773967743, gen p mean: -0.0378066822886467, mean p set: 0.4532664716243744
loss_pred:0.015161432325839996, decouple_loss:0.0010955261532217264
loss_pred:0.015347456559538841, decouple_loss:0.0009394998196512461
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012007_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012007_3_24hr.npz
NaN value num: 0
Iteration: 3133, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44846057891845703, gen p mean: -0.04729236289858818, mean p set: 0.44894084334373474
loss_pred:0.013561531901359558, decouple_loss:0.0012471668887883425
The modified gen p mean: 0.4481067359447479, gen p mean: -0.04567714408040047, mean p set: 0.4485870599746704The modified gen p mean: 0.44817665219306946, gen p mean: -0.046992506831884384, mean p set: 0.44865697622299194
loss_pred:0.013912523165345192, decouple_loss:0.0013293836964294314
loss_pred:0.013238025829195976, decouple_loss:0.0012393255019560456
Iteration: 3134, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44755682349205017, gen p mean: -0.04138518124818802, mean p set: 0.44803711771965027
loss_pred:0.0139711182564497, decouple_loss:0.0012155481381341815
The modified gen p mean: 0.44729694724082947, gen p mean: -0.044857531785964966, mean p set: 0.44777724146842957The modified gen p mean: 0.4483753740787506, gen p mean: -0.04471886157989502, mean p set: 0.4488556683063507
loss_pred:0.01370419654995203, decouple_loss:0.0011470199096947908
loss_pred:0.014065050520002842, decouple_loss:0.0011970472987741232
Iteration: 3135, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44728946685791016, gen p mean: -0.046049363911151886, mean p set: 0.44776979088783264
loss_pred:0.013250687159597874, decouple_loss:0.0010685451561585069
The modified gen p mean: 0.4483779966831207, gen p mean: -0.04383765906095505, mean p set: 0.4488582909107208The modified gen p mean: 0.447469562292099, gen p mean: -0.0461803637444973, mean p set: 0.4479498863220215
loss_pred:0.013137095607817173, decouple_loss:0.0010734419338405132
loss_pred:0.013666557148098946, decouple_loss:0.001121990499086678
Iteration: 3136, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485163986682892, gen p mean: -0.04610170051455498, mean p set: 0.4489966928958893
loss_pred:0.013918527401983738, decouple_loss:0.0011990321800112724
The modified gen p mean: 0.4481548070907593, gen p mean: -0.047818008810281754, mean p set: 0.4486351013183594The modified gen p mean: 0.44693225622177124, gen p mean: -0.04676951467990875, mean p set: 0.4474125802516937
loss_pred:0.013313531875610352, decouple_loss:0.0010716079268604517
loss_pred:0.013047287240624428, decouple_loss:0.0010797521099448204
Iteration: 3137, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448378324508667, gen p mean: -0.04398292675614357, mean p set: 0.4488586187362671
loss_pred:0.013335684314370155, decouple_loss:0.0011007457505911589
The modified gen p mean: 0.44808003306388855, gen p mean: -0.0446307547390461, mean p set: 0.44856035709381104The modified gen p mean: 0.44872990250587463, gen p mean: -0.04647161439061165, mean p set: 0.44921019673347473
loss_pred:0.013295496813952923, decouple_loss:0.0011711607221513987
loss_pred:0.013403132557868958, decouple_loss:0.0010999618098139763
Iteration: 3138, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479518532752991, gen p mean: -0.0490020327270031, mean p set: 0.44843214750289917
loss_pred:0.013146642595529556, decouple_loss:0.0014062359696254134
The modified gen p mean: 0.4479582905769348, gen p mean: -0.04182031750679016, mean p set: 0.4484385848045349The modified gen p mean: 0.4487769305706024, gen p mean: -0.04375974461436272, mean p set: 0.4492571949958801
loss_pred:0.013159486465156078, decouple_loss:0.0012828330509364605
loss_pred:0.01325796265155077, decouple_loss:0.001173676340840757
Iteration: 3139, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44725486636161804, gen p mean: -0.04521104320883751, mean p set: 0.44773516058921814
loss_pred:0.013781548477709293, decouple_loss:0.0013011458795517683
The modified gen p mean: 0.4484991729259491, gen p mean: -0.045842383056879044, mean p set: 0.4489794969558716The modified gen p mean: 0.44736239314079285, gen p mean: -0.046862561255693436, mean p set: 0.44784268736839294
loss_pred:0.01323285885155201, decouple_loss:0.0010253700893372297
loss_pred:0.014006933197379112, decouple_loss:0.0011296166339889169
Iteration: 3140, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44745561480522156, gen p mean: -0.04427444189786911, mean p set: 0.44793590903282166
loss_pred:0.01323529239743948, decouple_loss:0.001208196859806776
The modified gen p mean: 0.44796130061149597, gen p mean: -0.04980286955833435, mean p set: 0.44844159483909607The modified gen p mean: 0.447090744972229, gen p mean: -0.04984282702207565, mean p set: 0.4475710391998291
loss_pred:0.013027071952819824, decouple_loss:0.0011694945860654116
loss_pred:0.01287266705185175, decouple_loss:0.0011271181283518672
2023-05-02 14:30:18 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.05115199461579323, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04731229320168495, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.0474160835146904, mean p set: 0.4500633478164673
loss_pred:0.019094185903668404, decouple_loss:0.0016449515242129564
loss_pred:0.01803363300859928, decouple_loss:0.0013223544228821993
loss_pred:0.018002232536673546, decouple_loss:0.0014287418453022838
WV_0_PC_1_EH_0_PS_40, loss: 0.018449952825903893, avg_mse: 0.026904817670583725
current test mse: 0.026905
Iteration: 3141, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44730043411254883, gen p mean: -0.04865099862217903, mean p set: 0.4477807283401489
The modified gen p mean: 0.4482242166996002, gen p mean: -0.05115606263279915, mean p set: 0.4487045109272003
The modified gen p mean: 0.44768163561820984, gen p mean: -0.0461915023624897, mean p set: 0.44816192984580994
loss_pred:0.013066460378468037, decouple_loss:0.001350386650301516
loss_pred:0.01357126422226429, decouple_loss:0.0013552781892940402
loss_pred:0.013168924488127232, decouple_loss:0.0013246327871456742
Iteration: 3142, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476485848426819, gen p mean: -0.04924525320529938, mean p set: 0.44812890887260437
loss_pred:0.013530724681913853, decouple_loss:0.0012125330977141857
The modified gen p mean: 0.4490264058113098, gen p mean: -0.04334275797009468, mean p set: 0.4495067000389099The modified gen p mean: 0.4483889937400818, gen p mean: -0.05648348480463028, mean p set: 0.4488692879676819
loss_pred:0.012747806496918201, decouple_loss:0.0011307982495054603
loss_pred:0.013375623151659966, decouple_loss:0.00120549276471138
Iteration: 3143, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44723644852638245, gen p mean: -0.047236643731594086, mean p set: 0.44771671295166016
loss_pred:0.013835321180522442, decouple_loss:0.0015630503185093403
The modified gen p mean: 0.4480278789997101, gen p mean: -0.0492401160299778, mean p set: 0.4485081434249878The modified gen p mean: 0.4484296441078186, gen p mean: -0.051604174077510834, mean p set: 0.4489099383354187
loss_pred:0.013487044721841812, decouple_loss:0.0013907084940001369
loss_pred:0.012890041805803776, decouple_loss:0.0014615294057875872
Iteration: 3144, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477311372756958, gen p mean: -0.04995615780353546, mean p set: 0.4482114315032959
loss_pred:0.012698066420853138, decouple_loss:0.00106004998087883
The modified gen p mean: 0.4484996795654297, gen p mean: -0.054541002959012985, mean p set: 0.4489799737930298The modified gen p mean: 0.44763845205307007, gen p mean: -0.04878045991063118, mean p set: 0.44811877608299255
loss_pred:0.012921415269374847, decouple_loss:0.0010503692319616675
loss_pred:0.013054944574832916, decouple_loss:0.0011250796960666776
Iteration: 3145, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493151009082794, gen p mean: -0.041520487517118454, mean p set: 0.4497953951358795
loss_pred:0.013508427888154984, decouple_loss:0.001268546562641859
The modified gen p mean: 0.4473142623901367, gen p mean: -0.04412681236863136, mean p set: 0.4477945566177368The modified gen p mean: 0.4481460750102997, gen p mean: -0.0479573979973793, mean p set: 0.4486263692378998
loss_pred:0.013467815704643726, decouple_loss:0.0011021196842193604
loss_pred:0.013453970663249493, decouple_loss:0.001220973557792604
Iteration: 3146, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480271339416504, gen p mean: -0.051714204251766205, mean p set: 0.4485073983669281
loss_pred:0.013029731810092926, decouple_loss:0.0011956816306337714
The modified gen p mean: 0.44715479016304016, gen p mean: -0.04669691622257233, mean p set: 0.44763508439064026The modified gen p mean: 0.44736185669898987, gen p mean: -0.046753834933042526, mean p set: 0.44784215092658997
loss_pred:0.012866541743278503, decouple_loss:0.0011879474623128772
loss_pred:0.0129700293764472, decouple_loss:0.0011000429512932897
Iteration: 3147, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446613073348999, gen p mean: -0.05208694189786911, mean p set: 0.4470933675765991
loss_pred:0.013075937516987324, decouple_loss:0.0011261141626164317
The modified gen p mean: 0.44812268018722534, gen p mean: -0.054074935615062714, mean p set: 0.44860297441482544The modified gen p mean: 0.4486527442932129, gen p mean: -0.05316336452960968, mean p set: 0.449133038520813
loss_pred:0.012752926908433437, decouple_loss:0.0011222150642424822
loss_pred:0.013124655932188034, decouple_loss:0.0010216982336714864
Iteration: 3148, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493856132030487, gen p mean: -0.04398046061396599, mean p set: 0.4498658776283264
loss_pred:0.013387705199420452, decouple_loss:0.001019343500956893
The modified gen p mean: 0.44777804613113403, gen p mean: -0.04984070360660553, mean p set: 0.44825834035873413The modified gen p mean: 0.4477725327014923, gen p mean: -0.04963531345129013, mean p set: 0.4482528567314148
loss_pred:0.013141022063791752, decouple_loss:0.0010625404538586736
loss_pred:0.012911287136375904, decouple_loss:0.0010645779548212886
Iteration: 3149, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481242001056671, gen p mean: -0.05016016215085983, mean p set: 0.4486044645309448
loss_pred:0.012692524120211601, decouple_loss:0.0010134174954146147
The modified gen p mean: 0.4485977590084076, gen p mean: -0.04812842234969139, mean p set: 0.4490780532360077The modified gen p mean: 0.44711461663246155, gen p mean: -0.048513609915971756, mean p set: 0.44759488105773926
loss_pred:0.013320045545697212, decouple_loss:0.0009864196181297302
loss_pred:0.013428137637674809, decouple_loss:0.0010716166580095887
Iteration: 3150, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44834771752357483, gen p mean: -0.05110736936330795, mean p set: 0.4488280117511749
loss_pred:0.013058437965810299, decouple_loss:0.0010759830474853516
The modified gen p mean: 0.4472711682319641, gen p mean: -0.042712949216365814, mean p set: 0.4477514326572418The modified gen p mean: 0.449061781167984, gen p mean: -0.04336622357368469, mean p set: 0.4495420455932617
loss_pred:0.013546871021389961, decouple_loss:0.0010035875020548701
loss_pred:0.01278270035982132, decouple_loss:0.0011417596833780408
2023-05-02 14:32:12 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.04985899478197098, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04611557349562645, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.04579399898648262, mean p set: 0.4500633478164673
loss_pred:0.019056443125009537, decouple_loss:0.0010768711799755692
loss_pred:0.01791086420416832, decouple_loss:0.0010956074111163616
loss_pred:0.01794201135635376, decouple_loss:0.0010191283654421568
WV_0_PC_1_EH_0_PS_40, loss: 0.01835629902780056, avg_mse: 0.026800965890288353
current test mse: 0.026801
Iteration: 3151, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474526643753052, gen p mean: -0.04691937938332558, mean p set: 0.4479329288005829
The modified gen p mean: 0.4483235776424408, gen p mean: -0.04721897467970848, mean p set: 0.4488038718700409
The modified gen p mean: 0.4476211667060852, gen p mean: -0.04796195775270462, mean p set: 0.4481014907360077
loss_pred:0.012927788309752941, decouple_loss:0.0010808642255142331
loss_pred:0.012599057517945766, decouple_loss:0.0009962914045900106
loss_pred:0.012625046074390411, decouple_loss:0.0010912836296483874
Iteration: 3152, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475186765193939, gen p mean: -0.04666794463992119, mean p set: 0.4479990005493164
loss_pred:0.01268408726900816, decouple_loss:0.0010793179972097278
The modified gen p mean: 0.44857344031333923, gen p mean: -0.0467536598443985, mean p set: 0.44905373454093933The modified gen p mean: 0.44750353693962097, gen p mean: -0.04687906801700592, mean p set: 0.44798383116722107
loss_pred:0.013857443816959858, decouple_loss:0.0011001520324498415
loss_pred:0.0132911903783679, decouple_loss:0.0011600779835134745
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012014_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012014_3_24hr.npz
NaN value num: 0
Iteration: 3153, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45062196254730225, gen p mean: -0.03596015274524689, mean p set: 0.45110225677490234
loss_pred:0.015336083248257637, decouple_loss:0.0012903658207505941
The modified gen p mean: 0.45068982243537903, gen p mean: -0.0378170982003212, mean p set: 0.4511701166629791The modified gen p mean: 0.4504302144050598, gen p mean: -0.040330804884433746, mean p set: 0.4509105384349823
loss_pred:0.015510311350226402, decouple_loss:0.0013220503460615873
loss_pred:0.015348228625953197, decouple_loss:0.001272857072763145
Iteration: 3154, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501752555370331, gen p mean: -0.040873266756534576, mean p set: 0.4506555497646332
loss_pred:0.015373174101114273, decouple_loss:0.0011273747077211738
The modified gen p mean: 0.450580358505249, gen p mean: -0.036240071058273315, mean p set: 0.4510606527328491The modified gen p mean: 0.4517693817615509, gen p mean: -0.035742148756980896, mean p set: 0.4522497057914734
loss_pred:0.015704462304711342, decouple_loss:0.0010802693432196975
loss_pred:0.015204749070107937, decouple_loss:0.001102146808989346
Iteration: 3155, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45049917697906494, gen p mean: -0.03465539589524269, mean p set: 0.45097947120666504
loss_pred:0.015466743148863316, decouple_loss:0.0011281042825430632
The modified gen p mean: 0.4496537744998932, gen p mean: -0.03862123563885689, mean p set: 0.4501340985298157The modified gen p mean: 0.449970006942749, gen p mean: -0.03351423889398575, mean p set: 0.4504503011703491
loss_pred:0.01535866316407919, decouple_loss:0.0011113532818853855
loss_pred:0.015726130455732346, decouple_loss:0.0011277571320533752
Iteration: 3156, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45263898372650146, gen p mean: -0.030059179291129112, mean p set: 0.45311927795410156
loss_pred:0.015083110891282558, decouple_loss:0.0011466714786365628
The modified gen p mean: 0.45090562105178833, gen p mean: -0.029442641884088516, mean p set: 0.4513859152793884
The modified gen p mean: 0.44915416836738586, gen p mean: -0.035591721534729004, mean p set: 0.44963446259498596
loss_pred:0.015875352546572685, decouple_loss:0.0010763003956526518
loss_pred:0.015044703148305416, decouple_loss:0.0011944612488150597
Iteration: 3157, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504399001598358, gen p mean: -0.03245409205555916, mean p set: 0.4509201943874359
loss_pred:0.01504216343164444, decouple_loss:0.0011786003597080708
The modified gen p mean: 0.45261842012405396, gen p mean: -0.030449794605374336, mean p set: 0.45309871435165405The modified gen p mean: 0.4502231180667877, gen p mean: -0.029934970661997795, mean p set: 0.4507034122943878
loss_pred:0.015209074132144451, decouple_loss:0.0011817566119134426
loss_pred:0.015255136415362358, decouple_loss:0.0011130084749311209
Iteration: 3158, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45007872581481934, gen p mean: -0.035067975521087646, mean p set: 0.45055902004241943
loss_pred:0.015264316461980343, decouple_loss:0.0011190467048436403
The modified gen p mean: 0.4518849551677704, gen p mean: -0.038033876568078995, mean p set: 0.4523652195930481The modified gen p mean: 0.45139604806900024, gen p mean: -0.03288824111223221, mean p set: 0.45187634229660034
loss_pred:0.015514564700424671, decouple_loss:0.0010649027535691857
loss_pred:0.01512551587074995, decouple_loss:0.0011567515321075916
Iteration: 3159, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45077091455459595, gen p mean: -0.034083444625139236, mean p set: 0.45125120878219604
loss_pred:0.015398412942886353, decouple_loss:0.001220560516230762
The modified gen p mean: 0.45020055770874023, gen p mean: -0.03100704587996006, mean p set: 0.45068085193634033The modified gen p mean: 0.45292118191719055, gen p mean: -0.0313810370862484, mean p set: 0.45340150594711304
loss_pred:0.014670955017209053, decouple_loss:0.0012259487994015217
loss_pred:0.015288779512047768, decouple_loss:0.0013874041615054011
Iteration: 3160, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45142993330955505, gen p mean: -0.03616756573319435, mean p set: 0.45191025733947754
loss_pred:0.015721408650279045, decouple_loss:0.0011668127262964845
The modified gen p mean: 0.4500598609447479, gen p mean: -0.03508417680859566, mean p set: 0.45054012537002563The modified gen p mean: 0.45325326919555664, gen p mean: -0.03512261062860489, mean p set: 0.4537335932254791
loss_pred:0.015550066716969013, decouple_loss:0.0012576156295835972
loss_pred:0.015347383916378021, decouple_loss:0.0011729797115549445
2023-05-02 14:34:43 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.04689798131585121, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04337932914495468, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.04327485337853432, mean p set: 0.4500633478164673
loss_pred:0.018833305686712265, decouple_loss:0.001416949206031859
loss_pred:0.017585866153240204, decouple_loss:0.0014086747542023659
loss_pred:0.01770131103694439, decouple_loss:0.001360872178338468
WV_0_PC_1_EH_0_PS_40, loss: 0.018109936267137527, avg_mse: 0.026263434439897537
current test mse: 0.026263
Iteration: 3161, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513232409954071, gen p mean: -0.03950110450387001, mean p set: 0.4518035352230072
The modified gen p mean: 0.45019471645355225, gen p mean: -0.03709190711379051, mean p set: 0.45067504048347473
The modified gen p mean: 0.45299434661865234, gen p mean: -0.03967222198843956, mean p set: 0.45347464084625244
loss_pred:0.014949952252209187, decouple_loss:0.0013827107613906264
loss_pred:0.01510249450802803, decouple_loss:0.0012131775729358196
loss_pred:0.014896883629262447, decouple_loss:0.0012198854237794876
Iteration: 3162, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4519236385822296, gen p mean: -0.04215652123093605, mean p set: 0.4524039626121521
loss_pred:0.014688887633383274, decouple_loss:0.0011284584179520607
The modified gen p mean: 0.4497902989387512, gen p mean: -0.03976505622267723, mean p set: 0.4502705931663513The modified gen p mean: 0.4503708481788635, gen p mean: -0.03878587484359741, mean p set: 0.4508511424064636
loss_pred:0.015126588754355907, decouple_loss:0.0010814518900588155
loss_pred:0.014683971181511879, decouple_loss:0.0010713721858337522
Iteration: 3163, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504570960998535, gen p mean: -0.04485355317592621, mean p set: 0.450937420129776
loss_pred:0.015337302349507809, decouple_loss:0.0011699924943968654
The modified gen p mean: 0.44935160875320435, gen p mean: -0.03957374021410942, mean p set: 0.44983193278312683The modified gen p mean: 0.4515954256057739, gen p mean: -0.040897246450185776, mean p set: 0.45207569003105164
loss_pred:0.014864573255181313, decouple_loss:0.0011591953225433826
loss_pred:0.01629253476858139, decouple_loss:0.0011692290427163243
Iteration: 3164, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514337182044983, gen p mean: -0.04745949059724808, mean p set: 0.4519140422344208
loss_pred:0.015617369674146175, decouple_loss:0.001055290806107223
The modified gen p mean: 0.44920673966407776, gen p mean: -0.04643436148762703, mean p set: 0.44968703389167786The modified gen p mean: 0.44960248470306396, gen p mean: -0.0398268923163414, mean p set: 0.45008277893066406
loss_pred:0.015485410578548908, decouple_loss:0.0012100827880203724
loss_pred:0.01509872917085886, decouple_loss:0.0011026703286916018
Iteration: 3165, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504378139972687, gen p mean: -0.044542133808135986, mean p set: 0.4509181082248688
loss_pred:0.014968188479542732, decouple_loss:0.0010575277265161276
The modified gen p mean: 0.4500027298927307, gen p mean: -0.04293949529528618, mean p set: 0.4504829943180084The modified gen p mean: 0.4526252746582031, gen p mean: -0.04262601584196091, mean p set: 0.4531055688858032
loss_pred:0.014098096638917923, decouple_loss:0.0010183132253587246
loss_pred:0.0153662646189332, decouple_loss:0.0010913818841800094
Iteration: 3166, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504168927669525, gen p mean: -0.04113113135099411, mean p set: 0.4508971571922302
loss_pred:0.015042437240481377, decouple_loss:0.0010538568021729589
The modified gen p mean: 0.4521403908729553, gen p mean: -0.04887908324599266, mean p set: 0.45262065529823303The modified gen p mean: 0.4494568109512329, gen p mean: -0.04188152775168419, mean p set: 0.449937105178833
loss_pred:0.01528412289917469, decouple_loss:0.0010896535823121667
loss_pred:0.014487502165138721, decouple_loss:0.0010382495820522308
Iteration: 3167, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500267803668976, gen p mean: -0.037143610417842865, mean p set: 0.4505070447921753
loss_pred:0.015994299203157425, decouple_loss:0.0010021249763667583
The modified gen p mean: 0.4494049847126007, gen p mean: -0.04015322029590607, mean p set: 0.4498852789402008The modified gen p mean: 0.450313001871109, gen p mean: -0.04032902792096138, mean p set: 0.4507932960987091
loss_pred:0.015609708614647388, decouple_loss:0.0010109938448294997
loss_pred:0.01470214780420065, decouple_loss:0.0009562558843754232
Iteration: 3168, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45108312368392944, gen p mean: -0.04051658511161804, mean p set: 0.45156341791152954
loss_pred:0.014999779872596264, decouple_loss:0.0010553635656833649
The modified gen p mean: 0.4520683288574219, gen p mean: -0.04257063940167427, mean p set: 0.4525485932826996The modified gen p mean: 0.45138290524482727, gen p mean: -0.04436685889959335, mean p set: 0.45186319947242737
loss_pred:0.015140638686716557, decouple_loss:0.001041021547280252
loss_pred:0.01532788947224617, decouple_loss:0.0010892818681895733
Iteration: 3169, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4527037441730499, gen p mean: -0.04115563631057739, mean p set: 0.45318400859832764
loss_pred:0.015454902313649654, decouple_loss:0.001061697956174612
The modified gen p mean: 0.44996151328086853, gen p mean: -0.03860573470592499, mean p set: 0.450441837310791The modified gen p mean: 0.4500761032104492, gen p mean: -0.03938494995236397, mean p set: 0.4505563974380493
loss_pred:0.015207777731120586, decouple_loss:0.0010952706215903163
loss_pred:0.015744175761938095, decouple_loss:0.0010626050643622875
Iteration: 3170, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492179751396179, gen p mean: -0.041144512593746185, mean p set: 0.4496982991695404
loss_pred:0.014715693891048431, decouple_loss:0.0010185393039137125
The modified gen p mean: 0.45054343342781067, gen p mean: -0.03828919306397438, mean p set: 0.4510236978530884The modified gen p mean: 0.4532553255558014, gen p mean: -0.03807114064693451, mean p set: 0.4537356197834015
loss_pred:0.014727075584232807, decouple_loss:0.0010246792808175087
loss_pred:0.015272052958607674, decouple_loss:0.0010603931732475758
2023-05-02 14:36:38 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.04839170724153519, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04481838643550873, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04461640492081642, mean p set: 0.4500633478164673
loss_pred:0.01886482536792755, decouple_loss:0.001405991381034255
loss_pred:0.017563726752996445, decouple_loss:0.0012820825213566422
loss_pred:0.017718307673931122, decouple_loss:0.0013228520983830094
WV_0_PC_1_EH_0_PS_40, loss: 0.018115803599357605, avg_mse: 0.026272663846611977
current test mse: 0.026273
Iteration: 3171, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45024290680885315, gen p mean: -0.03578802943229675, mean p set: 0.45072323083877563
The modified gen p mean: 0.4525906443595886, gen p mean: -0.045375924557447433, mean p set: 0.4530709385871887
The modified gen p mean: 0.44951653480529785, gen p mean: -0.036308906972408295, mean p set: 0.44999685883522034
loss_pred:0.01474229246377945, decouple_loss:0.0010500542121008039
loss_pred:0.014647316187620163, decouple_loss:0.001118670916184783
loss_pred:0.014779046177864075, decouple_loss:0.0010832407278940082
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012005_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012005_3_24hr.npz
NaN value num: 0
Iteration: 3172, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483083486557007, gen p mean: -0.043790049850940704, mean p set: 0.4487886428833008
loss_pred:0.01611822471022606, decouple_loss:0.0013500773347914219
The modified gen p mean: 0.44749295711517334, gen p mean: -0.04581538960337639, mean p set: 0.44797325134277344The modified gen p mean: 0.44807255268096924, gen p mean: -0.048320308327674866, mean p set: 0.44855284690856934
loss_pred:0.01636863872408867, decouple_loss:0.0011998149566352367
loss_pred:0.01599707640707493, decouple_loss:0.0012875280808657408
Iteration: 3173, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489057660102844, gen p mean: -0.044892385601997375, mean p set: 0.4493860900402069
loss_pred:0.015991399064660072, decouple_loss:0.00109354208689183
The modified gen p mean: 0.44841381907463074, gen p mean: -0.04146634042263031, mean p set: 0.4488941431045532The modified gen p mean: 0.44969335198402405, gen p mean: -0.04692405089735985, mean p set: 0.45017367601394653
loss_pred:0.01530582457780838, decouple_loss:0.0010790808591991663
loss_pred:0.01569114625453949, decouple_loss:0.0010193904163315892
Iteration: 3174, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44840115308761597, gen p mean: -0.04547593370079994, mean p set: 0.44888144731521606
loss_pred:0.015549794770777225, decouple_loss:0.0012263208627700806
The modified gen p mean: 0.44764530658721924, gen p mean: -0.04592046141624451, mean p set: 0.4481256306171417The modified gen p mean: 0.4480952024459839, gen p mean: -0.042950887233018875, mean p set: 0.448575496673584
loss_pred:0.01631181873381138, decouple_loss:0.0012839114060625434
loss_pred:0.01587110199034214, decouple_loss:0.0012207393301650882
Iteration: 3175, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44973480701446533, gen p mean: -0.05101252347230911, mean p set: 0.45021507143974304
loss_pred:0.015855686739087105, decouple_loss:0.0011088901665061712
The modified gen p mean: 0.44978076219558716, gen p mean: -0.04924488067626953, mean p set: 0.45026108622550964The modified gen p mean: 0.4491669237613678, gen p mean: -0.046219367533922195, mean p set: 0.4496472179889679
loss_pred:0.016080668196082115, decouple_loss:0.0011113741202279925
loss_pred:0.016144273802638054, decouple_loss:0.0011949981562793255
Iteration: 3176, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482744038105011, gen p mean: -0.045861776918172836, mean p set: 0.4487546980381012
The modified gen p mean: 0.44886526465415955, gen p mean: -0.04895007610321045, mean p set: 0.44934555888175964
loss_pred:0.01566116325557232, decouple_loss:0.0011413035681471229
loss_pred:0.01606728881597519, decouple_loss:0.0012242255033925176
The modified gen p mean: 0.44879260659217834, gen p mean: -0.04888993129134178, mean p set: 0.44927293062210083
loss_pred:0.016293037682771683, decouple_loss:0.001004752004519105
Iteration: 3177, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44820013642311096, gen p mean: -0.052460648119449615, mean p set: 0.44868043065071106
loss_pred:0.015860313549637794, decouple_loss:0.001083269715309143
The modified gen p mean: 0.44971132278442383, gen p mean: -0.04908771067857742, mean p set: 0.4501916468143463The modified gen p mean: 0.4499596357345581, gen p mean: -0.052834007889032364, mean p set: 0.4504399299621582
loss_pred:0.01648765616118908, decouple_loss:0.0011822638334706426
loss_pred:0.015307947993278503, decouple_loss:0.0011609289795160294
Iteration: 3178, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490582346916199, gen p mean: -0.05390240624547005, mean p set: 0.44953852891921997
loss_pred:0.016419636085629463, decouple_loss:0.0011599166318774223
The modified gen p mean: 0.4500262141227722, gen p mean: -0.05333758890628815, mean p set: 0.4505065083503723The modified gen p mean: 0.4493016302585602, gen p mean: -0.051717497408390045, mean p set: 0.4497818946838379
loss_pred:0.01551284734159708, decouple_loss:0.001044354634359479
loss_pred:0.0163253303617239, decouple_loss:0.0011086184531450272
Iteration: 3179, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448386013507843, gen p mean: -0.05296159163117409, mean p set: 0.4488662779331207
loss_pred:0.015564554370939732, decouple_loss:0.0010627543088048697
The modified gen p mean: 0.4479368329048157, gen p mean: -0.05765736103057861, mean p set: 0.4484170973300934The modified gen p mean: 0.4502216577529907, gen p mean: -0.05379841476678848, mean p set: 0.4507019817829132
loss_pred:0.015877991914749146, decouple_loss:0.0011227084323763847
loss_pred:0.015333839692175388, decouple_loss:0.0012143671046942472
Iteration: 3180, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44945579767227173, gen p mean: -0.052626293152570724, mean p set: 0.44993606209754944
loss_pred:0.015448367223143578, decouple_loss:0.0010683940490707755
The modified gen p mean: 0.4498697817325592, gen p mean: -0.05084726959466934, mean p set: 0.4503500759601593The modified gen p mean: 0.4496310353279114, gen p mean: -0.0536331906914711, mean p set: 0.4501113295555115
loss_pred:0.015300280414521694, decouple_loss:0.0010939515195786953
loss_pred:0.015670450404286385, decouple_loss:0.0011337909381836653
2023-05-02 14:39:09 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.056026894599199295, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.05186914652585983, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.052084702998399734, mean p set: 0.4500633478164673
loss_pred:0.018664555624127388, decouple_loss:0.0010222636628895998
loss_pred:0.01750025525689125, decouple_loss:0.0011107416357845068
loss_pred:0.017589278519153595, decouple_loss:0.0010820933384820819
WV_0_PC_1_EH_0_PS_40, loss: 0.017971616238355637, avg_mse: 0.026000071316957474
current test mse: 0.026
Iteration: 3181, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44896426796913147, gen p mean: -0.051075711846351624, mean p set: 0.44944456219673157
The modified gen p mean: 0.4489072561264038, gen p mean: -0.05378880724310875, mean p set: 0.4493875503540039
The modified gen p mean: 0.4502228796482086, gen p mean: -0.05412469431757927, mean p set: 0.4507031738758087
loss_pred:0.015832914039492607, decouple_loss:0.0009861537255346775
loss_pred:0.016265561804175377, decouple_loss:0.001136633101850748
loss_pred:0.01605474017560482, decouple_loss:0.0010422378545626998
Iteration: 3182, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44958382844924927, gen p mean: -0.04786156490445137, mean p set: 0.450064092874527
loss_pred:0.01592625491321087, decouple_loss:0.0010015681618824601
The modified gen p mean: 0.44869494438171387, gen p mean: -0.05383793264627457, mean p set: 0.44917523860931396The modified gen p mean: 0.45035356283187866, gen p mean: -0.05003165453672409, mean p set: 0.45083382725715637
loss_pred:0.015839356929063797, decouple_loss:0.0011480699758976698
loss_pred:0.015395952388644218, decouple_loss:0.001168766524642706
Iteration: 3183, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44796493649482727, gen p mean: -0.04818033427000046, mean p set: 0.44844523072242737
loss_pred:0.01591319590806961, decouple_loss:0.0010214241920039058
The modified gen p mean: 0.4484393894672394, gen p mean: -0.04727557674050331, mean p set: 0.4489196836948395The modified gen p mean: 0.4474796652793884, gen p mean: -0.0505334809422493, mean p set: 0.4479599893093109
loss_pred:0.015836205333471298, decouple_loss:0.0010025076335296035
loss_pred:0.015377705916762352, decouple_loss:0.0011079473188146949
Iteration: 3184, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487854838371277, gen p mean: -0.048264987766742706, mean p set: 0.4492657780647278
loss_pred:0.015807732939720154, decouple_loss:0.001024681143462658
The modified gen p mean: 0.4486786723136902, gen p mean: -0.045215580612421036, mean p set: 0.4491589367389679The modified gen p mean: 0.44815149903297424, gen p mean: -0.047458045184612274, mean p set: 0.44863176345825195
loss_pred:0.0156859178096056, decouple_loss:0.0009833199437707663
loss_pred:0.016232866793870926, decouple_loss:0.000942713872063905
Iteration: 3185, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498950242996216, gen p mean: -0.04734635353088379, mean p set: 0.4503753185272217
loss_pred:0.015316794626414776, decouple_loss:0.0010600828099995852
The modified gen p mean: 0.45032787322998047, gen p mean: -0.047475509345531464, mean p set: 0.45080816745758057The modified gen p mean: 0.447918564081192, gen p mean: -0.044136978685855865, mean p set: 0.4483988583087921
loss_pred:0.015842637047171593, decouple_loss:0.0010656395461410284
loss_pred:0.015249000862240791, decouple_loss:0.0010093997698277235
Iteration: 3186, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44858092069625854, gen p mean: -0.049280181527137756, mean p set: 0.44906121492385864
loss_pred:0.015963956713676453, decouple_loss:0.001187870278954506
The modified gen p mean: 0.4496042728424072, gen p mean: -0.045522212982177734, mean p set: 0.4500845670700073The modified gen p mean: 0.44862014055252075, gen p mean: -0.04617826268076897, mean p set: 0.44910046458244324
loss_pred:0.01509916316717863, decouple_loss:0.0009609527187421918
loss_pred:0.015620232559740543, decouple_loss:0.0013109074207022786
Iteration: 3187, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44978612661361694, gen p mean: -0.04805201664566994, mean p set: 0.45026645064353943
loss_pred:0.015213890001177788, decouple_loss:0.001038618036545813
The modified gen p mean: 0.44945183396339417, gen p mean: -0.05050810053944588, mean p set: 0.4499320983886719The modified gen p mean: 0.44764411449432373, gen p mean: -0.04974772781133652, mean p set: 0.44812440872192383
loss_pred:0.015521904453635216, decouple_loss:0.001098028034903109
loss_pred:0.015168187208473682, decouple_loss:0.001108642085455358
Iteration: 3188, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45045018196105957, gen p mean: -0.05325624719262123, mean p set: 0.4509304463863373
loss_pred:0.01529331598430872, decouple_loss:0.0010082973167300224
The modified gen p mean: 0.4487479329109192, gen p mean: -0.049246739596128464, mean p set: 0.4492282271385193The modified gen p mean: 0.44799548387527466, gen p mean: -0.047648195177316666, mean p set: 0.44847577810287476
loss_pred:0.01592872105538845, decouple_loss:0.0009903378086164594
loss_pred:0.015896199271082878, decouple_loss:0.0011037355288863182
Iteration: 3189, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486227035522461, gen p mean: -0.04723614826798439, mean p set: 0.4491029977798462
loss_pred:0.016117814928293228, decouple_loss:0.0010020134504884481
The modified gen p mean: 0.4473685026168823, gen p mean: -0.04902386665344238, mean p set: 0.4478487968444824The modified gen p mean: 0.448699414730072, gen p mean: -0.051258109509944916, mean p set: 0.4491797089576721
loss_pred:0.01566729135811329, decouple_loss:0.001074065687134862
loss_pred:0.01592227630317211, decouple_loss:0.0010344302281737328
Iteration: 3190, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45030322670936584, gen p mean: -0.04917304590344429, mean p set: 0.45078352093696594
loss_pred:0.015211638063192368, decouple_loss:0.0010172250913456082
The modified gen p mean: 0.4498195946216583, gen p mean: -0.047280412167310715, mean p set: 0.4502998888492584The modified gen p mean: 0.4489375054836273, gen p mean: -0.048971936106681824, mean p set: 0.4494177997112274
loss_pred:0.015346965752542019, decouple_loss:0.0009385874727740884
loss_pred:0.01597088947892189, decouple_loss:0.000956175324972719
2023-05-02 14:41:04 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.05426156148314476, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04995314031839371, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.05047902464866638, mean p set: 0.4500633478164673
loss_pred:0.018613826483488083, decouple_loss:0.0011865899432450533
loss_pred:0.017481284216046333, decouple_loss:0.0011333313304930925
loss_pred:0.017583219334483147, decouple_loss:0.0010696552926674485
WV_0_PC_1_EH_0_PS_40, loss: 0.017949270084500313, avg_mse: 0.02597707509994507
current test mse: 0.025977
Iteration: 3191, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492219388484955, gen p mean: -0.051994115114212036, mean p set: 0.4497022032737732
The modified gen p mean: 0.4509904682636261, gen p mean: -0.05351024866104126, mean p set: 0.4514707326889038
The modified gen p mean: 0.44845178723335266, gen p mean: -0.051395002752542496, mean p set: 0.44893211126327515
loss_pred:0.015548481605947018, decouple_loss:0.0010066330432891846
loss_pred:0.01633940264582634, decouple_loss:0.0009555212454870343
loss_pred:0.01509020570665598, decouple_loss:0.0010048238327726722
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012012_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012012_3_24hr.npz
NaN value num: 0
Iteration: 3192, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504432678222656, gen p mean: -0.05108169466257095, mean p set: 0.4509235620498657
loss_pred:0.015628177672624588, decouple_loss:0.0010140734957531095
The modified gen p mean: 0.4495936632156372, gen p mean: -0.045142751187086105, mean p set: 0.4500739574432373The modified gen p mean: 0.4485822319984436, gen p mean: -0.050679318606853485, mean p set: 0.4490624964237213
loss_pred:0.015708211809396744, decouple_loss:0.0009670960134826601
loss_pred:0.015277896076440811, decouple_loss:0.0010410512331873178
Iteration: 3193, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45018482208251953, gen p mean: -0.05365731567144394, mean p set: 0.450665146112442
loss_pred:0.015062065795063972, decouple_loss:0.0010180709650740027
The modified gen p mean: 0.449384868144989, gen p mean: -0.04688088968396187, mean p set: 0.4498651623725891The modified gen p mean: 0.4502849876880646, gen p mean: -0.04386584833264351, mean p set: 0.4507652819156647
loss_pred:0.015954522415995598, decouple_loss:0.0010589895537123084
loss_pred:0.015522032976150513, decouple_loss:0.0010917946929112077
Iteration: 3194, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44982409477233887, gen p mean: -0.0449422262609005, mean p set: 0.45030441880226135
loss_pred:0.015588031150400639, decouple_loss:0.0008595167309977114
The modified gen p mean: 0.4493951201438904, gen p mean: -0.04431917145848274, mean p set: 0.4498754143714905The modified gen p mean: 0.4500581622123718, gen p mean: -0.04548262804746628, mean p set: 0.4505384862422943
loss_pred:0.01614830642938614, decouple_loss:0.0008942268905229867
loss_pred:0.015201462432742119, decouple_loss:0.0009589653345756233
Iteration: 3195, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4510343670845032, gen p mean: -0.042254045605659485, mean p set: 0.45151469111442566
loss_pred:0.01555427722632885, decouple_loss:0.0010392911499366164
The modified gen p mean: 0.4505613446235657, gen p mean: -0.043048158288002014, mean p set: 0.45104163885116577The modified gen p mean: 0.4503566026687622, gen p mean: -0.04131217673420906, mean p set: 0.4508368670940399
loss_pred:0.015345887281000614, decouple_loss:0.001039409078657627
loss_pred:0.014792700298130512, decouple_loss:0.0009741989779286087
Iteration: 3196, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45096173882484436, gen p mean: -0.0440848171710968, mean p set: 0.45144200325012207
loss_pred:0.015296760946512222, decouple_loss:0.0009549667011015117
The modified gen p mean: 0.4500754475593567, gen p mean: -0.03929661586880684, mean p set: 0.4505557417869568The modified gen p mean: 0.45041948556900024, gen p mean: -0.0400235578417778, mean p set: 0.45089974999427795
loss_pred:0.014856078661978245, decouple_loss:0.0009220039355568588
loss_pred:0.015383783727884293, decouple_loss:0.0009517652215436101
Iteration: 3197, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45071595907211304, gen p mean: -0.04433143138885498, mean p set: 0.45119625329971313
loss_pred:0.01592557691037655, decouple_loss:0.0009399379487149417
The modified gen p mean: 0.45251452922821045, gen p mean: -0.03742058202624321, mean p set: 0.45299485325813293The modified gen p mean: 0.4524904787540436, gen p mean: -0.04057759419083595, mean p set: 0.4529707729816437
loss_pred:0.014847625978291035, decouple_loss:0.0010412937263026834
loss_pred:0.014639805071055889, decouple_loss:0.0010688751935958862
Iteration: 3198, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483598470687866, gen p mean: -0.043237097561359406, mean p set: 0.4488401710987091
loss_pred:0.015331418253481388, decouple_loss:0.0010612168116495013
The modified gen p mean: 0.4495698809623718, gen p mean: -0.04009546712040901, mean p set: 0.4500502049922943The modified gen p mean: 0.44808024168014526, gen p mean: -0.04223911836743355, mean p set: 0.44856053590774536
loss_pred:0.015418452210724354, decouple_loss:0.001062753377482295
loss_pred:0.016126681119203568, decouple_loss:0.0011381807271391153
Iteration: 3199, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4525958001613617, gen p mean: -0.03875868022441864, mean p set: 0.4530760943889618
loss_pred:0.013965696096420288, decouple_loss:0.0009306319989264011
The modified gen p mean: 0.4493572413921356, gen p mean: -0.0406373105943203, mean p set: 0.4498375654220581The modified gen p mean: 0.45101550221443176, gen p mean: -0.03939279541373253, mean p set: 0.45149579644203186
loss_pred:0.015624986961483955, decouple_loss:0.0009663692908361554
loss_pred:0.015430317260324955, decouple_loss:0.0011264034546911716
Iteration: 3200, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485224783420563, gen p mean: -0.0418606773018837, mean p set: 0.44900277256965637
loss_pred:0.01605994626879692, decouple_loss:0.0010936514008790255
The modified gen p mean: 0.44932544231414795, gen p mean: -0.04589385539293289, mean p set: 0.44980570673942566The modified gen p mean: 0.450252503156662, gen p mean: -0.03745509311556816, mean p set: 0.4507328271865845
loss_pred:0.015271478332579136, decouple_loss:0.0010095086181536317
loss_pred:0.01515904814004898, decouple_loss:0.001084888237528503
2023-05-02 14:43:37 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.045676786452531815, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04170301556587219, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.04189164936542511, mean p set: 0.4500633478164673
loss_pred:0.01859883777797222, decouple_loss:0.0011392185697332025
loss_pred:0.01745091751217842, decouple_loss:0.0011483312118798494
loss_pred:0.017553476616740227, decouple_loss:0.001134198158979416
WV_0_PC_1_EH_0_PS_40, loss: 0.017924774438142776, avg_mse: 0.025915022939443588
current test mse: 0.025915
Iteration: 3201, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45283302664756775, gen p mean: -0.037882301956415176, mean p set: 0.45331335067749023
The modified gen p mean: 0.45049503445625305, gen p mean: -0.03888051211833954, mean p set: 0.45097532868385315
The modified gen p mean: 0.45086923241615295, gen p mean: -0.044972531497478485, mean p set: 0.45134952664375305
loss_pred:0.01609770394861698, decouple_loss:0.0009621524950489402
loss_pred:0.014204731211066246, decouple_loss:0.0011640862794592977
loss_pred:0.015043468214571476, decouple_loss:0.001068340614438057
Iteration: 3202, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45205241441726685, gen p mean: -0.03950945660471916, mean p set: 0.45253270864486694
loss_pred:0.015217321924865246, decouple_loss:0.0009763301350176334
The modified gen p mean: 0.4501342177391052, gen p mean: -0.04243142157793045, mean p set: 0.45061448216438293The modified gen p mean: 0.4509352147579193, gen p mean: -0.038691435009241104, mean p set: 0.4514155089855194
loss_pred:0.015201705507934093, decouple_loss:0.0009760073153302073
loss_pred:0.014809250831604004, decouple_loss:0.0010134591720998287
Iteration: 3203, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4506535530090332, gen p mean: -0.043146975338459015, mean p set: 0.4511338472366333
loss_pred:0.015058356337249279, decouple_loss:0.0010291151702404022
The modified gen p mean: 0.4487227201461792, gen p mean: -0.04893732815980911, mean p set: 0.4492030143737793The modified gen p mean: 0.45044654607772827, gen p mean: -0.043508220463991165, mean p set: 0.45092687010765076
loss_pred:0.01579996384680271, decouple_loss:0.0011000757804140449
loss_pred:0.015047218650579453, decouple_loss:0.000982948113232851
Iteration: 3204, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45110011100769043, gen p mean: -0.044787075370550156, mean p set: 0.4515804052352905
loss_pred:0.014849571511149406, decouple_loss:0.0010056722676381469
The modified gen p mean: 0.44989341497421265, gen p mean: -0.04669341817498207, mean p set: 0.45037373900413513The modified gen p mean: 0.45197778940200806, gen p mean: -0.044355832040309906, mean p set: 0.45245808362960815
loss_pred:0.01401780266314745, decouple_loss:0.0009883431484922767
loss_pred:0.014942157082259655, decouple_loss:0.0009912559762597084
Iteration: 3205, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493483006954193, gen p mean: -0.042606718838214874, mean p set: 0.449828565120697
loss_pred:0.01571650803089142, decouple_loss:0.0011461743852123618
The modified gen p mean: 0.4500119090080261, gen p mean: -0.04604622349143028, mean p set: 0.4504922032356262The modified gen p mean: 0.4481806755065918, gen p mean: -0.04967210814356804, mean p set: 0.4486609697341919
loss_pred:0.015489584766328335, decouple_loss:0.0010990120936185122
loss_pred:0.015436924993991852, decouple_loss:0.0010612288024276495
Iteration: 3206, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499675929546356, gen p mean: -0.04503865912556648, mean p set: 0.4504478871822357
loss_pred:0.015429527498781681, decouple_loss:0.001205303007736802
The modified gen p mean: 0.4533085525035858, gen p mean: -0.04120470583438873, mean p set: 0.4537888467311859The modified gen p mean: 0.4490213990211487, gen p mean: -0.05008910223841667, mean p set: 0.4495016634464264
loss_pred:0.014510845765471458, decouple_loss:0.0011615462135523558
loss_pred:0.01619485206902027, decouple_loss:0.0012569553218781948
Iteration: 3207, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498851001262665, gen p mean: -0.04686891287565231, mean p set: 0.4503653943538666
loss_pred:0.015255093574523926, decouple_loss:0.0010722875595092773
The modified gen p mean: 0.451886922121048, gen p mean: -0.047171734273433685, mean p set: 0.45236724615097046The modified gen p mean: 0.44967761635780334, gen p mean: -0.04549045115709305, mean p set: 0.45015794038772583
loss_pred:0.015555864199995995, decouple_loss:0.0009820041013881564
loss_pred:0.014885918237268925, decouple_loss:0.0011281499173492193
Iteration: 3208, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45275619626045227, gen p mean: -0.04204629361629486, mean p set: 0.45323646068573
loss_pred:0.014402841217815876, decouple_loss:0.0009200457134284079
The modified gen p mean: 0.4495577812194824, gen p mean: -0.05381075665354729, mean p set: 0.45003804564476013The modified gen p mean: 0.44972747564315796, gen p mean: -0.04507964104413986, mean p set: 0.45020779967308044
loss_pred:0.014988383278250694, decouple_loss:0.0010877551976591349
loss_pred:0.015333685092628002, decouple_loss:0.001028683502227068
Iteration: 3209, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4529532790184021, gen p mean: -0.03782690316438675, mean p set: 0.4534335732460022
loss_pred:0.014108680188655853, decouple_loss:0.0009776103543117642
The modified gen p mean: 0.45096853375434875, gen p mean: -0.04809040203690529, mean p set: 0.45144885778427124The modified gen p mean: 0.4494932293891907, gen p mean: -0.044462960213422775, mean p set: 0.4499734938144684
loss_pred:0.01586666889488697, decouple_loss:0.001023616991005838
loss_pred:0.01595190353691578, decouple_loss:0.000989297404885292
Iteration: 3210, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45196977257728577, gen p mean: -0.040020935237407684, mean p set: 0.45245006680488586
loss_pred:0.014325518161058426, decouple_loss:0.0011243971530348063
The modified gen p mean: 0.45289772748947144, gen p mean: -0.04226982966065407, mean p set: 0.45337799191474915The modified gen p mean: 0.44856005907058716, gen p mean: -0.0447099544107914, mean p set: 0.44904032349586487
loss_pred:0.01422822941094637, decouple_loss:0.0010371446842327714
loss_pred:0.015547651797533035, decouple_loss:0.0010462600039318204
2023-05-02 14:45:32 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.04917418584227562, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04525544121861458, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04553857073187828, mean p set: 0.4500633478164673
loss_pred:0.018538566306233406, decouple_loss:0.0010705351596698165
loss_pred:0.017432015389204025, decouple_loss:0.0010227434104308486
loss_pred:0.01749281957745552, decouple_loss:0.0009960781317204237
WV_0_PC_1_EH_0_PS_40, loss: 0.017872624099254608, avg_mse: 0.025837935507297516
current test mse: 0.025838
Iteration: 3211, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490398168563843, gen p mean: -0.044584259390830994, mean p set: 0.4495201110839844
The modified gen p mean: 0.44985833764076233, gen p mean: -0.04606184363365173, mean p set: 0.4503386318683624
The modified gen p mean: 0.4488624632358551, gen p mean: -0.0444367416203022, mean p set: 0.4493427276611328
loss_pred:0.015850821509957314, decouple_loss:0.0010301494039595127
loss_pred:0.015311185270547867, decouple_loss:0.0010296899126842618
loss_pred:0.01608835905790329, decouple_loss:0.0008593218517489731
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012016_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012016_3_24hr.npz
NaN value num: 0
Iteration: 3212, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465150833129883, gen p mean: -0.04638027027249336, mean p set: 0.4469953775405884
loss_pred:0.01703009381890297, decouple_loss:0.0010579110821709037
The modified gen p mean: 0.448380708694458, gen p mean: -0.05111397057771683, mean p set: 0.4488610029220581The modified gen p mean: 0.4470779299736023, gen p mean: -0.04786217212677002, mean p set: 0.4475582540035248
loss_pred:0.016982238739728928, decouple_loss:0.0010446462547406554
loss_pred:0.016850044950842857, decouple_loss:0.001089563244022429
Iteration: 3213, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446166068315506, gen p mean: -0.04867827892303467, mean p set: 0.4466463625431061
loss_pred:0.016877377405762672, decouple_loss:0.0010480521013960242
The modified gen p mean: 0.4455741345882416, gen p mean: -0.04863528907299042, mean p set: 0.4460543990135193The modified gen p mean: 0.44873499870300293, gen p mean: -0.05168239027261734, mean p set: 0.4492153227329254
loss_pred:0.016673408448696136, decouple_loss:0.0010861814953386784
loss_pred:0.016781067475676537, decouple_loss:0.0009435451938770711
Iteration: 3214, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44814085960388184, gen p mean: -0.05043969675898552, mean p set: 0.44862115383148193
loss_pred:0.016555292531847954, decouple_loss:0.001035219756886363
The modified gen p mean: 0.4467078745365143, gen p mean: -0.05407930165529251, mean p set: 0.4471881687641144The modified gen p mean: 0.44649913907051086, gen p mean: -0.05588385835289955, mean p set: 0.44697946310043335
loss_pred:0.016507256776094437, decouple_loss:0.0010948491981253028
loss_pred:0.016467448323965073, decouple_loss:0.0010186219587922096
Iteration: 3215, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44743454456329346, gen p mean: -0.055925317108631134, mean p set: 0.44791483879089355
loss_pred:0.01703207567334175, decouple_loss:0.0010298113338649273
The modified gen p mean: 0.4470864534378052, gen p mean: -0.05453220754861832, mean p set: 0.44756677746772766The modified gen p mean: 0.4472741186618805, gen p mean: -0.058609165251255035, mean p set: 0.4477544128894806
loss_pred:0.01654423214495182, decouple_loss:0.0010739249410107732
loss_pred:0.016493801027536392, decouple_loss:0.0011826342670246959
Iteration: 3216, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475901424884796, gen p mean: -0.06069151312112808, mean p set: 0.4480704367160797
loss_pred:0.015988878905773163, decouple_loss:0.0011152656516060233
The modified gen p mean: 0.4474298357963562, gen p mean: -0.06144990026950836, mean p set: 0.4479101598262787The modified gen p mean: 0.4466773569583893, gen p mean: -0.057751040905714035, mean p set: 0.4471576511859894
loss_pred:0.016721291467547417, decouple_loss:0.001067597884684801
loss_pred:0.01625475287437439, decouple_loss:0.0010264202719554305
Iteration: 3217, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44829297065734863, gen p mean: -0.05235439911484718, mean p set: 0.44877323508262634
loss_pred:0.016341382637619972, decouple_loss:0.0009838285623118281
The modified gen p mean: 0.44771137833595276, gen p mean: -0.05556928738951683, mean p set: 0.44819167256355286The modified gen p mean: 0.4475862383842468, gen p mean: -0.05286131799221039, mean p set: 0.4480665326118469
loss_pred:0.016738498583436012, decouple_loss:0.0010417558951303363
loss_pred:0.015563822351396084, decouple_loss:0.0010177914518862963
Iteration: 3218, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476057291030884, gen p mean: -0.055279601365327835, mean p set: 0.44808605313301086
loss_pred:0.016738537698984146, decouple_loss:0.0009935136185958982
The modified gen p mean: 0.4476652443408966, gen p mean: -0.05723002552986145, mean p set: 0.4481455683708191The modified gen p mean: 0.4474543035030365, gen p mean: -0.0566539503633976, mean p set: 0.4479345977306366
loss_pred:0.016670389100909233, decouple_loss:0.0010409547248855233
loss_pred:0.0162353515625, decouple_loss:0.0010454787407070398
Iteration: 3219, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471679627895355, gen p mean: -0.05669281259179115, mean p set: 0.44764822721481323
loss_pred:0.015845488756895065, decouple_loss:0.001042067538946867
The modified gen p mean: 0.44838374853134155, gen p mean: -0.05078050121665001, mean p set: 0.44886404275894165The modified gen p mean: 0.44675466418266296, gen p mean: -0.05973024293780327, mean p set: 0.4472349286079407
loss_pred:0.016518937423825264, decouple_loss:0.0010313955135643482
loss_pred:0.016416236758232117, decouple_loss:0.0010351586388424039
Iteration: 3220, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44831228256225586, gen p mean: -0.04801075905561447, mean p set: 0.44879260659217834
loss_pred:0.016371872276067734, decouple_loss:0.0010012037819251418
The modified gen p mean: 0.4470103681087494, gen p mean: -0.05189354717731476, mean p set: 0.4474906623363495The modified gen p mean: 0.447206974029541, gen p mean: -0.0534692257642746, mean p set: 0.4476872384548187
loss_pred:0.015166102908551693, decouple_loss:0.0009469353244639933
loss_pred:0.016020571812987328, decouple_loss:0.0010271701030433178
2023-05-02 14:48:16 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.05256166309118271, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.048764150589704514, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.049083955585956573, mean p set: 0.4500633478164673
loss_pred:0.017479848116636276, decouple_loss:0.0011714083375409245
loss_pred:0.018594760447740555, decouple_loss:0.0012548285303637385
loss_pred:0.017557766288518906, decouple_loss:0.0012557507725432515
WV_0_PC_1_EH_0_PS_40, loss: 0.017938826233148575, avg_mse: 0.025935374200344086
current test mse: 0.025935
Iteration: 3221, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44686082005500793, gen p mean: -0.049995314329862595, mean p set: 0.4473411440849304
The modified gen p mean: 0.44613581895828247, gen p mean: -0.05247856676578522, mean p set: 0.44661614298820496
The modified gen p mean: 0.4469808340072632, gen p mean: -0.046569082885980606, mean p set: 0.4474611282348633
loss_pred:0.015617428347468376, decouple_loss:0.001042849849909544
loss_pred:0.016053995117545128, decouple_loss:0.0011262299958616495
loss_pred:0.01674734428524971, decouple_loss:0.0011224178597331047
Iteration: 3222, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473735988140106, gen p mean: -0.05078258737921715, mean p set: 0.4478538930416107
loss_pred:0.015706248581409454, decouple_loss:0.0011179465800523758
The modified gen p mean: 0.4478066861629486, gen p mean: -0.046573296189308167, mean p set: 0.4482869803905487The modified gen p mean: 0.44618886709213257, gen p mean: -0.05147996172308922, mean p set: 0.4466691315174103
loss_pred:0.016380304470658302, decouple_loss:0.0010757739655673504
loss_pred:0.016213247552514076, decouple_loss:0.001161040854640305
Iteration: 3223, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44669753313064575, gen p mean: -0.049928415566682816, mean p set: 0.44717782735824585
loss_pred:0.015593546442687511, decouple_loss:0.001210003742016852
The modified gen p mean: 0.44712474942207336, gen p mean: -0.049493174999952316, mean p set: 0.44760507345199585The modified gen p mean: 0.44723373651504517, gen p mean: -0.04775281995534897, mean p set: 0.44771403074264526
loss_pred:0.016162700951099396, decouple_loss:0.0011575906537473202
loss_pred:0.015104447491466999, decouple_loss:0.0013013361021876335
Iteration: 3224, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472391903400421, gen p mean: -0.05177260935306549, mean p set: 0.4477194845676422
loss_pred:0.015446912497282028, decouple_loss:0.0012128169182687998
The modified gen p mean: 0.4470826983451843, gen p mean: -0.04949777200818062, mean p set: 0.4475629925727844The modified gen p mean: 0.4488820433616638, gen p mean: -0.04775489494204521, mean p set: 0.4493623375892639
loss_pred:0.015709446743130684, decouple_loss:0.0012145423097535968
loss_pred:0.015950554981827736, decouple_loss:0.0012659057974815369
Iteration: 3225, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465455710887909, gen p mean: -0.04955453425645828, mean p set: 0.447025865316391
loss_pred:0.015240822918713093, decouple_loss:0.0011744911316782236
The modified gen p mean: 0.44718053936958313, gen p mean: -0.04606343060731888, mean p set: 0.4476608335971832The modified gen p mean: 0.4474598467350006, gen p mean: -0.04969005286693573, mean p set: 0.4479401111602783
loss_pred:0.015013559721410275, decouple_loss:0.0010173775954172015
loss_pred:0.016783559694886208, decouple_loss:0.0010428947862237692
Iteration: 3226, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447444349527359, gen p mean: -0.05006585642695427, mean p set: 0.4479246735572815
loss_pred:0.01678098551928997, decouple_loss:0.0011097753886133432
The modified gen p mean: 0.44929277896881104, gen p mean: -0.04925486072897911, mean p set: 0.44977301359176636The modified gen p mean: 0.44696423411369324, gen p mean: -0.049848053604364395, mean p set: 0.44744452834129333
loss_pred:0.01614050194621086, decouple_loss:0.0011405296390876174
loss_pred:0.016118163242936134, decouple_loss:0.0010997769422829151
Iteration: 3227, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44833511114120483, gen p mean: -0.05029980093240738, mean p set: 0.44881540536880493
loss_pred:0.016136273741722107, decouple_loss:0.0011811874574050307
The modified gen p mean: 0.44809791445732117, gen p mean: -0.04836554080247879, mean p set: 0.44857820868492126The modified gen p mean: 0.44731447100639343, gen p mean: -0.04655997082591057, mean p set: 0.44779476523399353
loss_pred:0.015046290121972561, decouple_loss:0.001118609681725502
loss_pred:0.01631251536309719, decouple_loss:0.0010987947462126613
Iteration: 3228, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475539028644562, gen p mean: -0.051030755043029785, mean p set: 0.4480341970920563
loss_pred:0.016946319490671158, decouple_loss:0.0011626253835856915
The modified gen p mean: 0.44564107060432434, gen p mean: -0.05450982600450516, mean p set: 0.44612136483192444The modified gen p mean: 0.4480666518211365, gen p mean: -0.05183429270982742, mean p set: 0.44854697585105896
loss_pred:0.01636168546974659, decouple_loss:0.0010992554016411304
loss_pred:0.01650974340736866, decouple_loss:0.0010989713482558727
Iteration: 3229, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44587671756744385, gen p mean: -0.05581340193748474, mean p set: 0.44635701179504395
loss_pred:0.016422243788838387, decouple_loss:0.0010180458193644881
The modified gen p mean: 0.4470619261264801, gen p mean: -0.054344311356544495, mean p set: 0.4475422501564026
The modified gen p mean: 0.44815242290496826, gen p mean: -0.05449015274643898, mean p set: 0.44863274693489075
loss_pred:0.01621374301612377, decouple_loss:0.0010645624715834856
loss_pred:0.01598144695162773, decouple_loss:0.0009775495855137706
Iteration: 3230, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44747617840766907, gen p mean: -0.05441918596625328, mean p set: 0.4479564428329468
loss_pred:0.01663130149245262, decouple_loss:0.0009956719586625695
The modified gen p mean: 0.4481871426105499, gen p mean: -0.0541447252035141, mean p set: 0.44866740703582764The modified gen p mean: 0.44908756017684937, gen p mean: -0.052469972521066666, mean p set: 0.44956785440444946
loss_pred:0.01589946821331978, decouple_loss:0.0009306719875894487
loss_pred:0.016248734667897224, decouple_loss:0.0010215190704911947
2023-05-02 14:50:10 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.05684925988316536, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.052762944251298904, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.05308440700173378, mean p set: 0.4500633478164673
loss_pred:0.018593277782201767, decouple_loss:0.0010062172077596188
loss_pred:0.01750284433364868, decouple_loss:0.0010170057648792863
loss_pred:0.017590774223208427, decouple_loss:0.0010019501205533743
WV_0_PC_1_EH_0_PS_40, loss: 0.01794605329632759, avg_mse: 0.02598215453326702
current test mse: 0.025982
Iteration: 3231, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483150541782379, gen p mean: -0.051927726715803146, mean p set: 0.448795348405838
The modified gen p mean: 0.4484826624393463, gen p mean: -0.053192175924777985, mean p set: 0.448962926864624
The modified gen p mean: 0.4464946985244751, gen p mean: -0.052302826195955276, mean p set: 0.4469749927520752
loss_pred:0.016620172187685966, decouple_loss:0.0009680717485025525
loss_pred:0.015944717451930046, decouple_loss:0.0010300403228029609
loss_pred:0.01638203300535679, decouple_loss:0.001000082353129983
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012014_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012014_3_24hr.npz
NaN value num: 0
Iteration: 3232, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44947919249534607, gen p mean: -0.04948889836668968, mean p set: 0.4499594569206238
loss_pred:0.01547983568161726, decouple_loss:0.00124172808136791
The modified gen p mean: 0.44784224033355713, gen p mean: -0.047460515052080154, mean p set: 0.4483225345611572The modified gen p mean: 0.45106568932533264, gen p mean: -0.04655945301055908, mean p set: 0.45154598355293274
loss_pred:0.01623811200261116, decouple_loss:0.0010698423720896244
loss_pred:0.015640119090676308, decouple_loss:0.001194454962387681
Iteration: 3233, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45079007744789124, gen p mean: -0.046819716691970825, mean p set: 0.45127037167549133
loss_pred:0.015818273648619652, decouple_loss:0.0009612551657482982
The modified gen p mean: 0.45174404978752136, gen p mean: -0.04143652319908142, mean p set: 0.45222434401512146The modified gen p mean: 0.4482405185699463, gen p mean: -0.04483616352081299, mean p set: 0.4487208127975464
loss_pred:0.01566905342042446, decouple_loss:0.0009892802918329835
loss_pred:0.015217852778732777, decouple_loss:0.0009628300904296339
Iteration: 3234, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503253102302551, gen p mean: -0.03972816839814186, mean p set: 0.4508056342601776
loss_pred:0.014913656748831272, decouple_loss:0.000994195812381804
The modified gen p mean: 0.449479341506958, gen p mean: -0.043450385332107544, mean p set: 0.4499596655368805The modified gen p mean: 0.4508521556854248, gen p mean: -0.04784558713436127, mean p set: 0.4513324499130249
loss_pred:0.01511208713054657, decouple_loss:0.0010863831266760826
loss_pred:0.015300992876291275, decouple_loss:0.0011675921268761158
Iteration: 3235, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481632709503174, gen p mean: -0.04414106160402298, mean p set: 0.4486435651779175
loss_pred:0.014960672706365585, decouple_loss:0.0010037149768322706
The modified gen p mean: 0.4492426812648773, gen p mean: -0.04633371904492378, mean p set: 0.4497230052947998The modified gen p mean: 0.4495052695274353, gen p mean: -0.04306339472532272, mean p set: 0.4499855935573578
loss_pred:0.015128319151699543, decouple_loss:0.0009801227133721113
loss_pred:0.015113042667508125, decouple_loss:0.0010121359955519438
Iteration: 3236, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44900259375572205, gen p mean: -0.0426936037838459, mean p set: 0.44948288798332214
loss_pred:0.015002873726189137, decouple_loss:0.0010040393099188805
The modified gen p mean: 0.4503285884857178, gen p mean: -0.051763396710157394, mean p set: 0.45080891251564026The modified gen p mean: 0.44781580567359924, gen p mean: -0.048676952719688416, mean p set: 0.44829609990119934
loss_pred:0.015873514115810394, decouple_loss:0.001147216884419322
loss_pred:0.015671204775571823, decouple_loss:0.0012361831031739712
Iteration: 3237, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4521694481372833, gen p mean: -0.04139987379312515, mean p set: 0.4526497423648834
loss_pred:0.01515736524015665, decouple_loss:0.0010634292848408222
The modified gen p mean: 0.44853904843330383, gen p mean: -0.045209851115942, mean p set: 0.44901934266090393The modified gen p mean: 0.44945549964904785, gen p mean: -0.047087084501981735, mean p set: 0.44993579387664795
loss_pred:0.015196999534964561, decouple_loss:0.0010778573341667652
loss_pred:0.015342400409281254, decouple_loss:0.000982165802270174
Iteration: 3238, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44895386695861816, gen p mean: -0.049464065581560135, mean p set: 0.44943416118621826
loss_pred:0.014911170117557049, decouple_loss:0.0010423734784126282
The modified gen p mean: 0.4477938711643219, gen p mean: -0.04927527531981468, mean p set: 0.4482741951942444The modified gen p mean: 0.4503159523010254, gen p mean: -0.04537134990096092, mean p set: 0.45079630613327026
loss_pred:0.01579020544886589, decouple_loss:0.001009380561299622
loss_pred:0.015074650757014751, decouple_loss:0.0010701199062168598
Iteration: 3239, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44856590032577515, gen p mean: -0.0467337891459465, mean p set: 0.44904619455337524
loss_pred:0.01602276973426342, decouple_loss:0.001106983283534646
The modified gen p mean: 0.44736045598983765, gen p mean: -0.05170756205916405, mean p set: 0.44784078001976013The modified gen p mean: 0.44994351267814636, gen p mean: -0.04663189873099327, mean p set: 0.4504237771034241
loss_pred:0.015651216730475426, decouple_loss:0.001005262602120638
loss_pred:0.015228616073727608, decouple_loss:0.0009908966021612287
Iteration: 3240, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473547339439392, gen p mean: -0.05189818888902664, mean p set: 0.4478350281715393
loss_pred:0.015402015298604965, decouple_loss:0.001078824163414538
The modified gen p mean: 0.44919106364250183, gen p mean: -0.04696543514728546, mean p set: 0.44967135787010193The modified gen p mean: 0.44892337918281555, gen p mean: -0.042879220098257065, mean p set: 0.44940370321273804
loss_pred:0.015680378302931786, decouple_loss:0.0010504452511668205
loss_pred:0.01564328745007515, decouple_loss:0.0010623608250170946
2023-05-02 14:52:46 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.06000632792711258, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.055651210248470306, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.05620579421520233, mean p set: 0.4500633478164673
loss_pred:0.01866260915994644, decouple_loss:0.001181637984700501
loss_pred:0.01746792532503605, decouple_loss:0.0010648168390616775
loss_pred:0.017594721168279648, decouple_loss:0.001055302913300693
WV_0_PC_1_EH_0_PS_40, loss: 0.01796344853937626, avg_mse: 0.025979096069931984
current test mse: 0.025979
Iteration: 3241, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45113056898117065, gen p mean: -0.049106597900390625, mean p set: 0.45161086320877075
The modified gen p mean: 0.4514255225658417, gen p mean: -0.055486809462308884, mean p set: 0.4519057869911194
The modified gen p mean: 0.4495418071746826, gen p mean: -0.0451878122985363, mean p set: 0.4500221312046051
loss_pred:0.014833311550319195, decouple_loss:0.0009753117919899523
loss_pred:0.01563120074570179, decouple_loss:0.0010778994765132666
loss_pred:0.016508160158991814, decouple_loss:0.0010253663640469313
Iteration: 3242, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44764041900634766, gen p mean: -0.053469493985176086, mean p set: 0.44812071323394775
loss_pred:0.015849953517317772, decouple_loss:0.001125100301578641
The modified gen p mean: 0.4510965049266815, gen p mean: -0.04910033568739891, mean p set: 0.4515767991542816The modified gen p mean: 0.4487953186035156, gen p mean: -0.0467546172440052, mean p set: 0.4492756426334381
loss_pred:0.014775003306567669, decouple_loss:0.0010180611861869693
loss_pred:0.016410890966653824, decouple_loss:0.0010621247347444296
Iteration: 3243, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44781234860420227, gen p mean: -0.0542951337993145, mean p set: 0.44829264283180237
loss_pred:0.015384954400360584, decouple_loss:0.001099443412385881
The modified gen p mean: 0.4497719705104828, gen p mean: -0.04840277135372162, mean p set: 0.4502522349357605The modified gen p mean: 0.45083239674568176, gen p mean: -0.04705788940191269, mean p set: 0.45131269097328186
loss_pred:0.014742405153810978, decouple_loss:0.0010049832053482533
loss_pred:0.014713805168867111, decouple_loss:0.0010941565269604325
Iteration: 3244, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45023971796035767, gen p mean: -0.048916880041360855, mean p set: 0.45072001218795776
loss_pred:0.01565253734588623, decouple_loss:0.0010750708170235157
The modified gen p mean: 0.4486335217952728, gen p mean: -0.05053075775504112, mean p set: 0.4491138160228729The modified gen p mean: 0.44889235496520996, gen p mean: -0.043565068393945694, mean p set: 0.44937264919281006
loss_pred:0.015612723305821419, decouple_loss:0.0010237667011097074
loss_pred:0.016097789630293846, decouple_loss:0.0010117709171026945
Iteration: 3245, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45154479146003723, gen p mean: -0.04956258460879326, mean p set: 0.45202508568763733
loss_pred:0.016829384490847588, decouple_loss:0.001072975224815309
The modified gen p mean: 0.45027220249176025, gen p mean: -0.04613732546567917, mean p set: 0.45075252652168274The modified gen p mean: 0.44890737533569336, gen p mean: -0.0435900054872036, mean p set: 0.44938766956329346
loss_pred:0.01498092245310545, decouple_loss:0.0010296795517206192
loss_pred:0.015652747824788094, decouple_loss:0.0011279166210442781
Iteration: 3246, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44993776082992554, gen p mean: -0.0490860678255558, mean p set: 0.45041805505752563
loss_pred:0.01504245400428772, decouple_loss:0.0010059650521725416
The modified gen p mean: 0.4495643079280853, gen p mean: -0.047094378620386124, mean p set: 0.4500446021556854The modified gen p mean: 0.44983911514282227, gen p mean: -0.04891384392976761, mean p set: 0.45031946897506714
loss_pred:0.015666645020246506, decouple_loss:0.0009849151829257607
loss_pred:0.015640657395124435, decouple_loss:0.0010196618968620896
Iteration: 3247, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44846534729003906, gen p mean: -0.04437843710184097, mean p set: 0.4489456117153168
loss_pred:0.01527242548763752, decouple_loss:0.0011022459948435426
The modified gen p mean: 0.45043063163757324, gen p mean: -0.041939202696084976, mean p set: 0.45091089606285095The modified gen p mean: 0.4502424895763397, gen p mean: -0.04679712653160095, mean p set: 0.4507228434085846
loss_pred:0.015237901359796524, decouple_loss:0.0012541437754407525
loss_pred:0.014984503388404846, decouple_loss:0.0010571799939498305
Iteration: 3248, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473794400691986, gen p mean: -0.048101332038640976, mean p set: 0.4478597342967987
loss_pred:0.015625471249222755, decouple_loss:0.0010175544302910566
The modified gen p mean: 0.44923338294029236, gen p mean: -0.04109073430299759, mean p set: 0.44971367716789246The modified gen p mean: 0.4511122405529022, gen p mean: -0.04355008527636528, mean p set: 0.4515925347805023
loss_pred:0.01611824333667755, decouple_loss:0.0011153676314279437
loss_pred:0.014836675487458706, decouple_loss:0.0009342209668830037
Iteration: 3249, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504087269306183, gen p mean: -0.04667925834655762, mean p set: 0.450888991355896
loss_pred:0.015252798795700073, decouple_loss:0.00125124619808048
The modified gen p mean: 0.44963958859443665, gen p mean: -0.048653457313776016, mean p set: 0.45011985301971436The modified gen p mean: 0.4491342604160309, gen p mean: -0.03953096643090248, mean p set: 0.4496145248413086
loss_pred:0.014905662275850773, decouple_loss:0.001306201214902103
loss_pred:0.01610579341650009, decouple_loss:0.00102881935890764
Iteration: 3250, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478864371776581, gen p mean: -0.04257429391145706, mean p set: 0.4483667314052582
loss_pred:0.015774717554450035, decouple_loss:0.0010661223204806447
The modified gen p mean: 0.4506310820579529, gen p mean: -0.041647542268037796, mean p set: 0.451111376285553The modified gen p mean: 0.4504573941230774, gen p mean: -0.0459994301199913, mean p set: 0.4509376883506775
loss_pred:0.014957568608224392, decouple_loss:0.0011522454442456365
loss_pred:0.015086428262293339, decouple_loss:0.001174482866190374
2023-05-02 14:54:42 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.053908590227365494, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04951773211359978, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.05004424974322319, mean p set: 0.4500633478164673
loss_pred:0.018597109243273735, decouple_loss:0.0014333691215142608
loss_pred:0.017436860129237175, decouple_loss:0.001150726224295795
loss_pred:0.017600849270820618, decouple_loss:0.0013052658177912235
WV_0_PC_1_EH_0_PS_40, loss: 0.017943095415830612, avg_mse: 0.025932034477591515
current test mse: 0.025932
Iteration: 3251, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45048201084136963, gen p mean: -0.04496132582426071, mean p set: 0.4509623348712921
The modified gen p mean: 0.44972679018974304, gen p mean: -0.041450031101703644, mean p set: 0.45020708441734314
The modified gen p mean: 0.4489624798297882, gen p mean: -0.04348788782954216, mean p set: 0.4494428038597107
loss_pred:0.015557891689240932, decouple_loss:0.0012041948502883315
loss_pred:0.01613977551460266, decouple_loss:0.0012420177226886153
loss_pred:0.015910902991890907, decouple_loss:0.0012197979958727956
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012014_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012014_3_24hr.npz
NaN value num: 0
Iteration: 3252, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44834721088409424, gen p mean: -0.05033682659268379, mean p set: 0.44882747530937195
loss_pred:0.0171047393232584, decouple_loss:0.0010845442302525043
The modified gen p mean: 0.44622448086738586, gen p mean: -0.04802992194890976, mean p set: 0.44670480489730835The modified gen p mean: 0.4466865062713623, gen p mean: -0.046503759920597076, mean p set: 0.4471668004989624
loss_pred:0.016866140067577362, decouple_loss:0.0010385980131104589
loss_pred:0.016364403069019318, decouple_loss:0.0010816191788762808
Iteration: 3253, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44731974601745605, gen p mean: -0.05334129557013512, mean p set: 0.44780007004737854
loss_pred:0.016266729682683945, decouple_loss:0.001273194793611765
The modified gen p mean: 0.4482387900352478, gen p mean: -0.050707075744867325, mean p set: 0.4487190544605255The modified gen p mean: 0.4469218850135803, gen p mean: -0.04728526994585991, mean p set: 0.4474022090435028
loss_pred:0.01691463403403759, decouple_loss:0.0012551972176879644
loss_pred:0.017024459317326546, decouple_loss:0.001285133883357048
Iteration: 3254, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469979405403137, gen p mean: -0.052230361849069595, mean p set: 0.4474782347679138The modified gen p mean: 0.44780921936035156, gen p mean: -0.04853476583957672, mean p set: 0.44828951358795166
loss_pred:0.015972532331943512, decouple_loss:0.001122416346333921
loss_pred:0.016027089208364487, decouple_loss:0.0011272040428593755
The modified gen p mean: 0.4469245970249176, gen p mean: -0.052454303950071335, mean p set: 0.4474048614501953
loss_pred:0.016198445111513138, decouple_loss:0.001197870704345405
Iteration: 3255, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468212425708771, gen p mean: -0.05206795781850815, mean p set: 0.44730156660079956
loss_pred:0.0165594220161438, decouple_loss:0.001114687998779118
The modified gen p mean: 0.44763386249542236, gen p mean: -0.05393335968255997, mean p set: 0.44811415672302246The modified gen p mean: 0.44636473059654236, gen p mean: -0.05247484892606735, mean p set: 0.44684502482414246
loss_pred:0.01686140149831772, decouple_loss:0.00120510533452034
loss_pred:0.01573770120739937, decouple_loss:0.001084434101358056
Iteration: 3256, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475215971469879, gen p mean: -0.05004234239459038, mean p set: 0.448001891374588
loss_pred:0.016946308314800262, decouple_loss:0.0013160526286810637
The modified gen p mean: 0.44776710867881775, gen p mean: -0.05216609686613083, mean p set: 0.44824743270874023The modified gen p mean: 0.4481840431690216, gen p mean: -0.048949845135211945, mean p set: 0.4486643373966217
loss_pred:0.017121603712439537, decouple_loss:0.0011457162909209728
loss_pred:0.016728434711694717, decouple_loss:0.001220709178596735
Iteration: 3257, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44858792424201965, gen p mean: -0.04604828357696533, mean p set: 0.44906821846961975
loss_pred:0.01590191014111042, decouple_loss:0.0012081332970410585
The modified gen p mean: 0.4463445842266083, gen p mean: -0.04743195325136185, mean p set: 0.4468248784542084
The modified gen p mean: 0.4462827146053314, gen p mean: -0.048623230308294296, mean p set: 0.4467630088329315
loss_pred:0.015741975978016853, decouple_loss:0.0012181473430246115
loss_pred:0.016479115933179855, decouple_loss:0.001129132229834795
Iteration: 3258, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483528137207031, gen p mean: -0.04516613110899925, mean p set: 0.44883307814598083
loss_pred:0.0169058907777071, decouple_loss:0.0012912715319544077
The modified gen p mean: 0.4480167031288147, gen p mean: -0.046105723828077316, mean p set: 0.4484969973564148The modified gen p mean: 0.4469447135925293, gen p mean: -0.043812546879053116, mean p set: 0.4474250078201294
loss_pred:0.01673278771340847, decouple_loss:0.0012886675540357828
loss_pred:0.016727719455957413, decouple_loss:0.0012047209311276674
Iteration: 3259, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44634953141212463, gen p mean: -0.048407770693302155, mean p set: 0.44682982563972473
loss_pred:0.016266796737909317, decouple_loss:0.0010857726447284222
The modified gen p mean: 0.4462904930114746, gen p mean: -0.04972254857420921, mean p set: 0.4467707574367523The modified gen p mean: 0.4487491250038147, gen p mean: -0.04743985831737518, mean p set: 0.4492294192314148
loss_pred:0.01650133728981018, decouple_loss:0.0011472087353467941
loss_pred:0.016536224633455276, decouple_loss:0.0010966378031298518
Iteration: 3260, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44673365354537964, gen p mean: -0.04437127336859703, mean p set: 0.4472139775753021
loss_pred:0.015797626227140427, decouple_loss:0.0011767465621232986
The modified gen p mean: 0.44828104972839355, gen p mean: -0.04814263433218002, mean p set: 0.44876134395599365The modified gen p mean: 0.44659125804901123, gen p mean: -0.050225790590047836, mean p set: 0.44707152247428894
loss_pred:0.017297891899943352, decouple_loss:0.0011212016688659787
loss_pred:0.01581396721303463, decouple_loss:0.0011856280034407973
2023-05-02 14:57:21 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.05403037741780281, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830535888672, gen p mean: -0.05020499601960182, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.049811188131570816, mean p set: 0.45035696029663086
loss_pred:0.018470287322998047, decouple_loss:0.0011542178690433502
loss_pred:0.01747847907245159, decouple_loss:0.0011194432154297829
loss_pred:0.01743301935493946, decouple_loss:0.0011537214741110802
WV_0_PC_1_EH_0_PS_40, loss: 0.017851052805781364, avg_mse: 0.025771861895918846
current test mse: 0.025772
Iteration: 3261, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4463682174682617, gen p mean: -0.052960511296987534, mean p set: 0.4468485414981842
The modified gen p mean: 0.44708576798439026, gen p mean: -0.05109868571162224, mean p set: 0.44756606221199036
The modified gen p mean: 0.4467674791812897, gen p mean: -0.04747646301984787, mean p set: 0.44724777340888977
loss_pred:0.015816938132047653, decouple_loss:0.0011159434216096997
loss_pred:0.015312996692955494, decouple_loss:0.0010399922030046582
loss_pred:0.015708131715655327, decouple_loss:0.001033055828884244
Iteration: 3262, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44678714871406555, gen p mean: -0.04891997575759888, mean p set: 0.44726744294166565
loss_pred:0.016018932685256004, decouple_loss:0.0011253774864599109
The modified gen p mean: 0.44688180088996887, gen p mean: -0.05248099938035011, mean p set: 0.4473620653152466The modified gen p mean: 0.44618138670921326, gen p mean: -0.04840308800339699, mean p set: 0.44666171073913574
loss_pred:0.016136178746819496, decouple_loss:0.00110645464155823
loss_pred:0.016414687037467957, decouple_loss:0.0011515846708789468
Iteration: 3263, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4460732042789459, gen p mean: -0.049949388951063156, mean p set: 0.446553498506546
loss_pred:0.015904448926448822, decouple_loss:0.001074504922144115
The modified gen p mean: 0.445794939994812, gen p mean: -0.05513159930706024, mean p set: 0.4462752044200897The modified gen p mean: 0.44621655344963074, gen p mean: -0.05065073072910309, mean p set: 0.4466968774795532
loss_pred:0.01624486967921257, decouple_loss:0.0011279041646048427
loss_pred:0.016324244439601898, decouple_loss:0.0010297381086274981
Iteration: 3264, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44751158356666565, gen p mean: -0.04966099560260773, mean p set: 0.44799190759658813
loss_pred:0.015293437987565994, decouple_loss:0.0011716574663296342
The modified gen p mean: 0.4462824761867523, gen p mean: -0.05184114724397659, mean p set: 0.4467627704143524The modified gen p mean: 0.44600510597229004, gen p mean: -0.04809416085481644, mean p set: 0.44648540019989014
loss_pred:0.015953555703163147, decouple_loss:0.0011284552747383714
loss_pred:0.01663561910390854, decouple_loss:0.0010014456929638982
Iteration: 3265, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4461723566055298, gen p mean: -0.052286840975284576, mean p set: 0.4466526508331299
loss_pred:0.015779899433255196, decouple_loss:0.0010224039433524013
The modified gen p mean: 0.4461558759212494, gen p mean: -0.050115711987018585, mean p set: 0.4466361403465271
The modified gen p mean: 0.4477706551551819, gen p mean: -0.05068127438426018, mean p set: 0.448250949382782
loss_pred:0.01607023924589157, decouple_loss:0.0010125794215127826
loss_pred:0.01650727353990078, decouple_loss:0.0011024363338947296
Iteration: 3266, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44708532094955444, gen p mean: -0.04945162683725357, mean p set: 0.44756564497947693
loss_pred:0.015372850932180882, decouple_loss:0.0011447682045400143
The modified gen p mean: 0.4468584656715393, gen p mean: -0.049233824014663696, mean p set: 0.4473387897014618The modified gen p mean: 0.4477754235267639, gen p mean: -0.04826050624251366, mean p set: 0.4482557475566864
loss_pred:0.015860458835959435, decouple_loss:0.0011241843458265066
loss_pred:0.016406890004873276, decouple_loss:0.001220219535753131
Iteration: 3267, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477894604206085, gen p mean: -0.044802919030189514, mean p set: 0.44826972484588623
loss_pred:0.015439636074006557, decouple_loss:0.001103586284443736
The modified gen p mean: 0.44829297065734863, gen p mean: -0.04743848741054535, mean p set: 0.44877323508262634The modified gen p mean: 0.4487219452857971, gen p mean: -0.049785565584897995, mean p set: 0.4492022693157196
loss_pred:0.01667088270187378, decouple_loss:0.001110325800254941
loss_pred:0.016290955245494843, decouple_loss:0.0011319677578285336
Iteration: 3268, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468982517719269, gen p mean: -0.04327325522899628, mean p set: 0.44737857580184937
loss_pred:0.016566108912229538, decouple_loss:0.0012193727307021618
The modified gen p mean: 0.4489080309867859, gen p mean: -0.044435031712055206, mean p set: 0.449388325214386The modified gen p mean: 0.4473279118537903, gen p mean: -0.04244031012058258, mean p set: 0.4478082060813904
loss_pred:0.016343284398317337, decouple_loss:0.001143345725722611
loss_pred:0.01596682332456112, decouple_loss:0.0010765703627839684
Iteration: 3269, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44753193855285645, gen p mean: -0.050644148141145706, mean p set: 0.44801223278045654
loss_pred:0.016666483134031296, decouple_loss:0.0015838094986975193
The modified gen p mean: 0.4470100402832031, gen p mean: -0.04332548379898071, mean p set: 0.4474903643131256The modified gen p mean: 0.44714465737342834, gen p mean: -0.04076140746474266, mean p set: 0.44762495160102844
loss_pred:0.01569419540464878, decouple_loss:0.0014204370090737939
loss_pred:0.015456786379218102, decouple_loss:0.0013577439822256565
Iteration: 3270, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44886305928230286, gen p mean: -0.047854095697402954, mean p set: 0.44934335350990295
loss_pred:0.01669476553797722, decouple_loss:0.0012580910697579384
The modified gen p mean: 0.44592970609664917, gen p mean: -0.04929885268211365, mean p set: 0.44641000032424927The modified gen p mean: 0.4484891891479492, gen p mean: -0.04717317968606949, mean p set: 0.4489694833755493
loss_pred:0.016101675108075142, decouple_loss:0.001327143982052803
loss_pred:0.016662457957863808, decouple_loss:0.001258399337530136
2023-05-02 14:59:17 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.05148399993777275, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04771517962217331, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.047011978924274445, mean p set: 0.45035696029663086
loss_pred:0.01844361424446106, decouple_loss:0.0010678822873160243
loss_pred:0.01750284619629383, decouple_loss:0.001080929534509778loss_pred:0.01743924431502819, decouple_loss:0.0012427879264578223
WV_0_PC_1_EH_0_PS_40, loss: 0.01785176247358322, avg_mse: 0.0257615614682436
current test mse: 0.025762
Iteration: 3271, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473405182361603, gen p mean: -0.05083082243800163, mean p set: 0.4478208124637604
The modified gen p mean: 0.4462626874446869, gen p mean: -0.04713234305381775, mean p set: 0.446742981672287
The modified gen p mean: 0.4461488127708435, gen p mean: -0.05358104407787323, mean p set: 0.44662904739379883
loss_pred:0.015971258282661438, decouple_loss:0.0011668259976431727
loss_pred:0.016479505226016045, decouple_loss:0.0010072275763377547
loss_pred:0.016496839001774788, decouple_loss:0.001031746156513691
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012013_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012013_3_24hr.npz
NaN value num: 0
Iteration: 3272, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479556679725647, gen p mean: -0.04966985434293747, mean p set: 0.4484359920024872
loss_pred:0.015620311722159386, decouple_loss:0.001466957968659699
The modified gen p mean: 0.4473097324371338, gen p mean: -0.0488666370511055, mean p set: 0.4477900266647339The modified gen p mean: 0.4461131691932678, gen p mean: -0.050933632999658585, mean p set: 0.4465934634208679
loss_pred:0.01569233275949955, decouple_loss:0.0016524232923984528
loss_pred:0.016146428883075714, decouple_loss:0.001228243694640696
Iteration: 3273, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44780200719833374, gen p mean: -0.04929455742239952, mean p set: 0.44828227162361145
loss_pred:0.016679992899298668, decouple_loss:0.001287019345909357
The modified gen p mean: 0.44741547107696533, gen p mean: -0.05284412205219269, mean p set: 0.44789573550224304The modified gen p mean: 0.4484342038631439, gen p mean: -0.05076507106423378, mean p set: 0.448914498090744
loss_pred:0.01595827378332615, decouple_loss:0.0010142573155462742
loss_pred:0.01597553677856922, decouple_loss:0.0011203719768673182
Iteration: 3274, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469386339187622, gen p mean: -0.046339184045791626, mean p set: 0.4474189281463623
loss_pred:0.016243403777480125, decouple_loss:0.0011678708251565695
The modified gen p mean: 0.44826653599739075, gen p mean: -0.052479956299066544, mean p set: 0.44874683022499084The modified gen p mean: 0.446698933839798, gen p mean: -0.05068619176745415, mean p set: 0.44717922806739807
loss_pred:0.016112202778458595, decouple_loss:0.0011950564803555608
loss_pred:0.016377735882997513, decouple_loss:0.0011938802199438214
Iteration: 3275, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44699329137802124, gen p mean: -0.05579260364174843, mean p set: 0.44747358560562134
loss_pred:0.015714731067419052, decouple_loss:0.0013089516432955861
The modified gen p mean: 0.4477238059043884, gen p mean: -0.048237212002277374, mean p set: 0.4482041299343109The modified gen p mean: 0.44728416204452515, gen p mean: -0.049594830721616745, mean p set: 0.44776445627212524
loss_pred:0.015558023937046528, decouple_loss:0.0013139331713318825
loss_pred:0.016731230542063713, decouple_loss:0.001242498867213726
Iteration: 3276, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44801345467567444, gen p mean: -0.0444762296974659, mean p set: 0.44849371910095215
loss_pred:0.016159959137439728, decouple_loss:0.0011594385141506791
The modified gen p mean: 0.44737508893013, gen p mean: -0.052595946937799454, mean p set: 0.4478553533554077The modified gen p mean: 0.4476068615913391, gen p mean: -0.047683268785476685, mean p set: 0.4480871260166168
loss_pred:0.016356319189071655, decouple_loss:0.001253942376933992
loss_pred:0.01584535650908947, decouple_loss:0.0011185602052137256
Iteration: 3277, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470379650592804, gen p mean: -0.048319511115550995, mean p set: 0.4475182592868805
loss_pred:0.016054097563028336, decouple_loss:0.0012595361331477761
The modified gen p mean: 0.44695407152175903, gen p mean: -0.04242204129695892, mean p set: 0.44743436574935913The modified gen p mean: 0.44791147112846375, gen p mean: -0.04663516581058502, mean p set: 0.44839179515838623
loss_pred:0.0158523079007864, decouple_loss:0.0012466652551665902
loss_pred:0.01555225532501936, decouple_loss:0.001414804020896554
Iteration: 3278, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44642043113708496, gen p mean: -0.043558064848184586, mean p set: 0.44690072536468506
loss_pred:0.015821821987628937, decouple_loss:0.001304479199461639
The modified gen p mean: 0.44770678877830505, gen p mean: -0.043714579194784164, mean p set: 0.44818708300590515The modified gen p mean: 0.44687533378601074, gen p mean: -0.040501587092876434, mean p set: 0.44735562801361084
loss_pred:0.015831096097826958, decouple_loss:0.0012490127701312304
loss_pred:0.015617722645401955, decouple_loss:0.0013029100373387337
Iteration: 3279, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4461911916732788, gen p mean: -0.04206467047333717, mean p set: 0.4466714859008789
loss_pred:0.015960026532411575, decouple_loss:0.0012315463973209262
The modified gen p mean: 0.4471263885498047, gen p mean: -0.041447512805461884, mean p set: 0.4476066827774048The modified gen p mean: 0.4469752311706543, gen p mean: -0.039905846118927, mean p set: 0.4474555552005768
loss_pred:0.015609759837388992, decouple_loss:0.0013941855868324637
loss_pred:0.015933215618133545, decouple_loss:0.0013674533693119884
Iteration: 3280, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464390277862549, gen p mean: -0.039579421281814575, mean p set: 0.4469192922115326
loss_pred:0.01671021617949009, decouple_loss:0.001201513223350048
The modified gen p mean: 0.4478501081466675, gen p mean: -0.04200655221939087, mean p set: 0.4483303725719452The modified gen p mean: 0.44815316796302795, gen p mean: -0.04590955004096031, mean p set: 0.44863349199295044
loss_pred:0.016071802005171776, decouple_loss:0.001087921322323382
loss_pred:0.015991533175110817, decouple_loss:0.0012733276234939694
2023-05-02 15:01:47 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.046549998223781586, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04252294823527336, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.042806584388017654, mean p set: 0.4500633478164673
loss_pred:0.018412331119179726, decouple_loss:0.0012688370188698173
loss_pred:0.017352784052491188, decouple_loss:0.0013510162243619561
loss_pred:0.017468318343162537, decouple_loss:0.0012425949098542333
WV_0_PC_1_EH_0_PS_40, loss: 0.017808852717280388, avg_mse: 0.02567683346569538
current test mse: 0.025677
Iteration: 3281, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44800689816474915, gen p mean: -0.042394593358039856, mean p set: 0.44848719239234924
The modified gen p mean: 0.4470159113407135, gen p mean: -0.04606292396783829, mean p set: 0.4474962055683136
The modified gen p mean: 0.4476120173931122, gen p mean: -0.047090817242860794, mean p set: 0.4480923116207123
loss_pred:0.015905901789665222, decouple_loss:0.001371327554807067
loss_pred:0.01583501510322094, decouple_loss:0.0013372133253142238
loss_pred:0.016107825562357903, decouple_loss:0.0012754850322380662
Iteration: 3282, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44809529185295105, gen p mean: -0.046334799379110336, mean p set: 0.44857561588287354
loss_pred:0.015809794887900352, decouple_loss:0.0010495634051039815
The modified gen p mean: 0.4463730454444885, gen p mean: -0.0525064691901207, mean p set: 0.446853369474411The modified gen p mean: 0.4473837912082672, gen p mean: -0.04726729914546013, mean p set: 0.4478640854358673
loss_pred:0.015869958326220512, decouple_loss:0.0011467740405350924
loss_pred:0.016321178525686264, decouple_loss:0.001203503692522645
Iteration: 3283, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44656896591186523, gen p mean: -0.04509259760379791, mean p set: 0.44704926013946533
loss_pred:0.01642138883471489, decouple_loss:0.0010764789767563343
The modified gen p mean: 0.4472610652446747, gen p mean: -0.04335053265094757, mean p set: 0.44774138927459717The modified gen p mean: 0.4472595155239105, gen p mean: -0.04936271905899048, mean p set: 0.4477398097515106
loss_pred:0.016500651836395264, decouple_loss:0.0011580847203731537
loss_pred:0.016307946294546127, decouple_loss:0.00115861720405519
Iteration: 3284, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4460988938808441, gen p mean: -0.04626679793000221, mean p set: 0.4465792179107666
loss_pred:0.01589677669107914, decouple_loss:0.0009948310907930136
The modified gen p mean: 0.4477015435695648, gen p mean: -0.050440747290849686, mean p set: 0.4481818377971649The modified gen p mean: 0.4464632272720337, gen p mean: -0.04667044058442116, mean p set: 0.4469434916973114
loss_pred:0.015680918470025063, decouple_loss:0.0009540055762045085
loss_pred:0.01609131321310997, decouple_loss:0.0009394672815687954
Iteration: 3285, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464642107486725, gen p mean: -0.055842168629169464, mean p set: 0.4469445049762726
loss_pred:0.015470864251255989, decouple_loss:0.0011299778707325459
The modified gen p mean: 0.44794201850891113, gen p mean: -0.05158022791147232, mean p set: 0.44842231273651123The modified gen p mean: 0.4460814893245697, gen p mean: -0.05369677394628525, mean p set: 0.4465617835521698
loss_pred:0.01621076464653015, decouple_loss:0.0010664524743333459
loss_pred:0.01552440132945776, decouple_loss:0.0011081668781116605
Iteration: 3286, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.445488303899765, gen p mean: -0.051261525601148605, mean p set: 0.4459685981273651
loss_pred:0.015896901488304138, decouple_loss:0.0011486212024465203
The modified gen p mean: 0.4469863176345825, gen p mean: -0.057671450078487396, mean p set: 0.44746658205986023The modified gen p mean: 0.4468676745891571, gen p mean: -0.05316879600286484, mean p set: 0.4473479390144348
loss_pred:0.016341280192136765, decouple_loss:0.001161273685283959
loss_pred:0.016210807487368584, decouple_loss:0.0010734969982877374
Iteration: 3287, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44674113392829895, gen p mean: -0.05166217312216759, mean p set: 0.44722142815589905
loss_pred:0.01656605675816536, decouple_loss:0.0010051109129562974
The modified gen p mean: 0.4462970495223999, gen p mean: -0.047043412923812866, mean p set: 0.44677734375
The modified gen p mean: 0.4459565281867981, gen p mean: -0.05353637412190437, mean p set: 0.4464368224143982
loss_pred:0.01598561368882656, decouple_loss:0.001139358151704073
loss_pred:0.015924280509352684, decouple_loss:0.0010093811433762312
Iteration: 3288, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44664090871810913, gen p mean: -0.05441711097955704, mean p set: 0.44712120294570923
loss_pred:0.016486674547195435, decouple_loss:0.001257068244740367
The modified gen p mean: 0.4473395347595215, gen p mean: -0.05102010816335678, mean p set: 0.4478198289871216The modified gen p mean: 0.4486715495586395, gen p mean: -0.052867189049720764, mean p set: 0.44915181398391724
loss_pred:0.01559110265225172, decouple_loss:0.0011465137358754873
loss_pred:0.016218343749642372, decouple_loss:0.001112207304686308
Iteration: 3289, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478020966053009, gen p mean: -0.056178852915763855, mean p set: 0.4482823610305786
loss_pred:0.015744725242257118, decouple_loss:0.0010691600618883967
The modified gen p mean: 0.4456441104412079, gen p mean: -0.04883912578225136, mean p set: 0.4461243748664856The modified gen p mean: 0.447870135307312, gen p mean: -0.05322203040122986, mean p set: 0.4483503997325897
loss_pred:0.015785112977027893, decouple_loss:0.0011429651640355587
loss_pred:0.015583952888846397, decouple_loss:0.0010108965216204524
Iteration: 3290, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4456179440021515, gen p mean: -0.048221588134765625, mean p set: 0.446098268032074
loss_pred:0.016187099739909172, decouple_loss:0.0012403185246512294
The modified gen p mean: 0.4471037983894348, gen p mean: -0.050025131553411484, mean p set: 0.4475840926170349The modified gen p mean: 0.44679510593414307, gen p mean: -0.05120663344860077, mean p set: 0.44727540016174316
loss_pred:0.015449427999556065, decouple_loss:0.0011777185136452317
loss_pred:0.015714138746261597, decouple_loss:0.0014269064413383603
2023-05-02 15:03:42 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.05139494687318802, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04738861322402954, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.047816067934036255, mean p set: 0.4500633478164673
loss_pred:0.018382225185632706, decouple_loss:0.0012269666185602546
loss_pred:0.017388012260198593, decouple_loss:0.0011659757001325488
loss_pred:0.017455939203500748, decouple_loss:0.001103849965147674
WV_0_PC_1_EH_0_PS_40, loss: 0.017800338566303253, avg_mse: 0.025675509124994278
current test mse: 0.025676
Iteration: 3291, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464874863624573, gen p mean: -0.043587494641542435, mean p set: 0.4469677805900574
The modified gen p mean: 0.44781431555747986, gen p mean: -0.04992597550153732, mean p set: 0.44829463958740234
The modified gen p mean: 0.4467330873012543, gen p mean: -0.05105442926287651, mean p set: 0.44721341133117676
loss_pred:0.015858620405197144, decouple_loss:0.0009969372767955065
loss_pred:0.016207076609134674, decouple_loss:0.001091967336833477loss_pred:0.016255753114819527, decouple_loss:0.0011622548336163163
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012019_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012019_3_24hr.npz
NaN value num: 0
Iteration: 3292, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4538276195526123, gen p mean: -0.03888698294758797, mean p set: 0.4543079137802124
loss_pred:0.016471976414322853, decouple_loss:0.0012271231971681118
The modified gen p mean: 0.45353955030441284, gen p mean: -0.039850059896707535, mean p set: 0.4540198743343353The modified gen p mean: 0.45160800218582153, gen p mean: -0.03991221264004707, mean p set: 0.45208826661109924
loss_pred:0.016182277351617813, decouple_loss:0.0011642021127045155
loss_pred:0.015702342614531517, decouple_loss:0.0011514463694766164
Iteration: 3293, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4532589316368103, gen p mean: -0.04050743579864502, mean p set: 0.4537392258644104
loss_pred:0.016466693952679634, decouple_loss:0.0010824328055605292
The modified gen p mean: 0.45225897431373596, gen p mean: -0.042311619967222214, mean p set: 0.45273926854133606The modified gen p mean: 0.45232123136520386, gen p mean: -0.03599945083260536, mean p set: 0.45280152559280396
loss_pred:0.016039559617638588, decouple_loss:0.0010387205984443426
loss_pred:0.016728270798921585, decouple_loss:0.0011157498229295015
Iteration: 3294, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45258259773254395, gen p mean: -0.040615592151880264, mean p set: 0.45306292176246643
loss_pred:0.016711818054318428, decouple_loss:0.0011876579374074936
The modified gen p mean: 0.45171183347702026, gen p mean: -0.03889140114188194, mean p set: 0.45219212770462036The modified gen p mean: 0.4519190490245819, gen p mean: -0.036954108625650406, mean p set: 0.452399343252182
loss_pred:0.015952279791235924, decouple_loss:0.001201614155434072
loss_pred:0.016448669135570526, decouple_loss:0.0011864627012982965
Iteration: 3295, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4519207775592804, gen p mean: -0.03964375704526901, mean p set: 0.4524010717868805
loss_pred:0.01665913499891758, decouple_loss:0.001219133730046451
The modified gen p mean: 0.4515621066093445, gen p mean: -0.034673988819122314, mean p set: 0.4520424008369446The modified gen p mean: 0.45458194613456726, gen p mean: -0.038643576204776764, mean p set: 0.45506227016448975
loss_pred:0.01628684438765049, decouple_loss:0.0011287950910627842
loss_pred:0.016777541488409042, decouple_loss:0.0012146274093538523
Iteration: 3296, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.453336626291275, gen p mean: -0.037735678255558014, mean p set: 0.4538169205188751
loss_pred:0.015660803765058517, decouple_loss:0.0011064311256632209
The modified gen p mean: 0.4503503441810608, gen p mean: -0.03618153929710388, mean p set: 0.4508306682109833The modified gen p mean: 0.4526388645172119, gen p mean: -0.04071372374892235, mean p set: 0.453119158744812
loss_pred:0.016743242740631104, decouple_loss:0.0011112992651760578
loss_pred:0.016985410824418068, decouple_loss:0.000980628770776093
Iteration: 3297, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45474687218666077, gen p mean: -0.04225953668355942, mean p set: 0.45522719621658325
loss_pred:0.016242800280451775, decouple_loss:0.0010998062789440155
The modified gen p mean: 0.45200395584106445, gen p mean: -0.038135968148708344, mean p set: 0.45248425006866455The modified gen p mean: 0.4525487422943115, gen p mean: -0.04334890469908714, mean p set: 0.4530290365219116
loss_pred:0.0164914783090353, decouple_loss:0.001064577023498714
loss_pred:0.015931714326143265, decouple_loss:0.0010567160788923502
Iteration: 3298, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4535723030567169, gen p mean: -0.042618799954652786, mean p set: 0.45405256748199463
loss_pred:0.016203932464122772, decouple_loss:0.0010306139010936022
The modified gen p mean: 0.4519030749797821, gen p mean: -0.039357639849185944, mean p set: 0.452383428812027The modified gen p mean: 0.45128047466278076, gen p mean: -0.04137616232037544, mean p set: 0.45176076889038086
loss_pred:0.016611373052001, decouple_loss:0.0009977470617741346
loss_pred:0.014986004680395126, decouple_loss:0.000981509918347001
Iteration: 3299, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45155638456344604, gen p mean: -0.040928661823272705, mean p set: 0.45203670859336853
loss_pred:0.01672166772186756, decouple_loss:0.0010582372779026628
The modified gen p mean: 0.4518929421901703, gen p mean: -0.04118289425969124, mean p set: 0.4523732364177704The modified gen p mean: 0.4523218870162964, gen p mean: -0.04060164466500282, mean p set: 0.4528021812438965
loss_pred:0.016627391800284386, decouple_loss:0.0011486515868455172
loss_pred:0.0167913306504488, decouple_loss:0.0011647974606603384
Iteration: 3300, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45173004269599915, gen p mean: -0.04147396236658096, mean p set: 0.45221033692359924
loss_pred:0.015583920292556286, decouple_loss:0.0012357850791886449
The modified gen p mean: 0.45166417956352234, gen p mean: -0.04527617245912552, mean p set: 0.45214447379112244The modified gen p mean: 0.45336225628852844, gen p mean: -0.042218055576086044, mean p set: 0.4538425803184509
loss_pred:0.016450388357043266, decouple_loss:0.0012725970009341836
loss_pred:0.016712049022316933, decouple_loss:0.0013652273919433355
2023-05-02 15:06:16 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.0558495819568634, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.05167083442211151, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.05233224853873253, mean p set: 0.4500633478164673
loss_pred:0.01847514510154724, decouple_loss:0.001144358073361218
loss_pred:0.017371658235788345, decouple_loss:0.0011822169180959463
loss_pred:0.01748625561594963, decouple_loss:0.001120023662224412
WV_0_PC_1_EH_0_PS_40, loss: 0.017835130915045738, avg_mse: 0.02569887787103653
current test mse: 0.025699
Iteration: 3301, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45110735297203064, gen p mean: -0.039733029901981354, mean p set: 0.45158764719963074
The modified gen p mean: 0.45314478874206543, gen p mean: -0.043363843113183975, mean p set: 0.45362505316734314
The modified gen p mean: 0.4519352614879608, gen p mean: -0.03882230445742607, mean p set: 0.4524155259132385
loss_pred:0.01584130898118019, decouple_loss:0.0009747242438606918
loss_pred:0.016577089205384254, decouple_loss:0.0009511409443803132loss_pred:0.01667872443795204, decouple_loss:0.0009786365553736687
Iteration: 3302, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45364445447921753, gen p mean: -0.041498832404613495, mean p set: 0.45412477850914
loss_pred:0.016975510865449905, decouple_loss:0.0011485277209430933
The modified gen p mean: 0.4524392783641815, gen p mean: -0.04437052458524704, mean p set: 0.4529195725917816The modified gen p mean: 0.45230743288993835, gen p mean: -0.044566553086042404, mean p set: 0.45278772711753845
loss_pred:0.01624377630650997, decouple_loss:0.0012113258708268404
loss_pred:0.01692768931388855, decouple_loss:0.0012903534807264805
Iteration: 3303, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45329633355140686, gen p mean: -0.041480306535959244, mean p set: 0.45377665758132935
loss_pred:0.015759946778416634, decouple_loss:0.0011798776686191559
The modified gen p mean: 0.4531635642051697, gen p mean: -0.040113646537065506, mean p set: 0.4536438286304474The modified gen p mean: 0.45369771122932434, gen p mean: -0.041808925569057465, mean p set: 0.45417800545692444
loss_pred:0.016546625643968582, decouple_loss:0.001178964739665389
loss_pred:0.016148079186677933, decouple_loss:0.0010587627766653895
Iteration: 3304, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45258578658103943, gen p mean: -0.04533536359667778, mean p set: 0.4530661106109619
loss_pred:0.015630407258868217, decouple_loss:0.001015662681311369
The modified gen p mean: 0.4536791443824768, gen p mean: -0.041519418358802795, mean p set: 0.4541594386100769The modified gen p mean: 0.4527120292186737, gen p mean: -0.04605896398425102, mean p set: 0.4531923532485962
loss_pred:0.01594800502061844, decouple_loss:0.0009824042208492756
loss_pred:0.01612217351794243, decouple_loss:0.0011657902505248785
Iteration: 3305, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4518159031867981, gen p mean: -0.04346936568617821, mean p set: 0.4522961974143982
loss_pred:0.016628853976726532, decouple_loss:0.0011498495005071163
The modified gen p mean: 0.45273876190185547, gen p mean: -0.04316391795873642, mean p set: 0.4532190263271332The modified gen p mean: 0.45250242948532104, gen p mean: -0.04021685943007469, mean p set: 0.45298275351524353
loss_pred:0.016422836109995842, decouple_loss:0.0011506075970828533
loss_pred:0.015832951292395592, decouple_loss:0.0011281169718131423
Iteration: 3306, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4545176923274994, gen p mean: -0.04369146004319191, mean p set: 0.4549979567527771
loss_pred:0.016306661069393158, decouple_loss:0.0009718257933855057
The modified gen p mean: 0.45108649134635925, gen p mean: -0.04114358872175217, mean p set: 0.45156678557395935The modified gen p mean: 0.4530549943447113, gen p mean: -0.043641041964292526, mean p set: 0.4535352885723114
loss_pred:0.01679990254342556, decouple_loss:0.00106360437348485
loss_pred:0.016199128702282906, decouple_loss:0.000988355721347034
Iteration: 3307, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45224201679229736, gen p mean: -0.03484219312667847, mean p set: 0.45272231101989746
loss_pred:0.01603519357740879, decouple_loss:0.0011639207368716598
The modified gen p mean: 0.45303648710250854, gen p mean: -0.03659012168645859, mean p set: 0.45351678133010864The modified gen p mean: 0.45176437497138977, gen p mean: -0.039193302392959595, mean p set: 0.4522446393966675
loss_pred:0.016047976911067963, decouple_loss:0.001230068039149046
loss_pred:0.01659819670021534, decouple_loss:0.0010735534597188234
Iteration: 3308, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45290395617485046, gen p mean: -0.03833088278770447, mean p set: 0.4533842206001282
loss_pred:0.016947587952017784, decouple_loss:0.00112827867269516
The modified gen p mean: 0.4526750147342682, gen p mean: -0.04055110737681389, mean p set: 0.4531553387641907The modified gen p mean: 0.4539492726325989, gen p mean: -0.03945767879486084, mean p set: 0.454429566860199
loss_pred:0.015895092859864235, decouple_loss:0.0009570993133820593
loss_pred:0.015844445675611496, decouple_loss:0.0009542592451907694
Iteration: 3309, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45203307271003723, gen p mean: -0.036215122789144516, mean p set: 0.45251336693763733
loss_pred:0.017068592831492424, decouple_loss:0.0011089846957474947
The modified gen p mean: 0.4528390169143677, gen p mean: -0.040236007422208786, mean p set: 0.45331934094429016The modified gen p mean: 0.4543944001197815, gen p mean: -0.03655824065208435, mean p set: 0.4548746943473816
loss_pred:0.016129301860928535, decouple_loss:0.0010558749781921506
loss_pred:0.01598880998790264, decouple_loss:0.0010635550133883953
Iteration: 3310, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45184895396232605, gen p mean: -0.035502608865499496, mean p set: 0.45232921838760376
loss_pred:0.016123991459608078, decouple_loss:0.0012045539915561676
The modified gen p mean: 0.45094922184944153, gen p mean: -0.03775966167449951, mean p set: 0.4514295160770416The modified gen p mean: 0.45178577303886414, gen p mean: -0.03629766404628754, mean p set: 0.4522660970687866
loss_pred:0.016346976161003113, decouple_loss:0.0012720859376713634
loss_pred:0.016602512449026108, decouple_loss:0.0009836634853854775
2023-05-02 15:08:11 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.054404113441705704, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.05034437030553818, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.05083630234003067, mean p set: 0.4500633478164673
loss_pred:0.018517961725592613, decouple_loss:0.0012924206675961614
loss_pred:0.017458446323871613, decouple_loss:0.0012333537451922894
loss_pred:0.017515957355499268, decouple_loss:0.0012187042739242315
WV_0_PC_1_EH_0_PS_40, loss: 0.017893197014927864, avg_mse: 0.02578151226043701
current test mse: 0.025782
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012020_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012020_3_24hr.npz
NaN value num: 0
Iteration: 3311, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45178914070129395, gen p mean: -0.04349289461970329, mean p set: 0.45226943492889404
loss_pred:0.016185324639081955, decouple_loss:0.001194969518110156
The modified gen p mean: 0.4529750347137451, gen p mean: -0.04567428305745125, mean p set: 0.4534553289413452The modified gen p mean: 0.45171672105789185, gen p mean: -0.04494035989046097, mean p set: 0.45219701528549194
loss_pred:0.016093429177999496, decouple_loss:0.001229718909598887
loss_pred:0.01593536138534546, decouple_loss:0.0012573928106576204
Iteration: 3312, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4506235420703888, gen p mean: -0.04390529915690422, mean p set: 0.4511038064956665
loss_pred:0.015931589528918266, decouple_loss:0.0013868599198758602
The modified gen p mean: 0.45201683044433594, gen p mean: -0.042827852070331573, mean p set: 0.45249712467193604The modified gen p mean: 0.4535071551799774, gen p mean: -0.046827513724565506, mean p set: 0.4539874494075775
loss_pred:0.016099482774734497, decouple_loss:0.0013180822134017944
loss_pred:0.01563219539821148, decouple_loss:0.0012292368337512016
Iteration: 3313, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504062831401825, gen p mean: -0.0488119050860405, mean p set: 0.450886607170105
loss_pred:0.016561750322580338, decouple_loss:0.0011176076950505376
The modified gen p mean: 0.45033156871795654, gen p mean: -0.051585014909505844, mean p set: 0.45081186294555664
The modified gen p mean: 0.4515725374221802, gen p mean: -0.04737285152077675, mean p set: 0.4520528018474579
loss_pred:0.016078928485512733, decouple_loss:0.0011350074782967567
loss_pred:0.01639430969953537, decouple_loss:0.001184554654173553
Iteration: 3314, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4515621066093445, gen p mean: -0.04236091673374176, mean p set: 0.4520423710346222
loss_pred:0.015652699396014214, decouple_loss:0.001118911663070321
The modified gen p mean: 0.4520556330680847, gen p mean: -0.04383215680718422, mean p set: 0.4525359272956848The modified gen p mean: 0.45059725642204285, gen p mean: -0.04423057287931442, mean p set: 0.45107758045196533
loss_pred:0.016033021733164787, decouple_loss:0.0011740295449271798
loss_pred:0.0161187332123518, decouple_loss:0.0012261648662388325
Iteration: 3315, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4521675705909729, gen p mean: -0.042390577495098114, mean p set: 0.452647864818573
loss_pred:0.015470219776034355, decouple_loss:0.001144889392890036
The modified gen p mean: 0.45025834441185, gen p mean: -0.045700185000896454, mean p set: 0.4507386088371277The modified gen p mean: 0.4532754719257355, gen p mean: -0.047320831567049026, mean p set: 0.45375579595565796
loss_pred:0.016124170273542404, decouple_loss:0.0010815850691869855
loss_pred:0.0156745295971632, decouple_loss:0.0011604761239141226
Iteration: 3316, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503253102302551, gen p mean: -0.044985581189394, mean p set: 0.4508056044578552
loss_pred:0.01645239256322384, decouple_loss:0.0010204360587522388
The modified gen p mean: 0.45031094551086426, gen p mean: -0.04399982839822769, mean p set: 0.45079126954078674The modified gen p mean: 0.45337003469467163, gen p mean: -0.043419402092695236, mean p set: 0.4538503587245941
loss_pred:0.01593688689172268, decouple_loss:0.0012834124499931931
loss_pred:0.015153207816183567, decouple_loss:0.000972498906776309
Iteration: 3317, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45062869787216187, gen p mean: -0.048645131289958954, mean p set: 0.45110899209976196
loss_pred:0.016473807394504547, decouple_loss:0.0010836604051291943
The modified gen p mean: 0.4494536519050598, gen p mean: -0.046354398131370544, mean p set: 0.4499339163303375The modified gen p mean: 0.45291367173194885, gen p mean: -0.04632609710097313, mean p set: 0.45339396595954895
loss_pred:0.01621616818010807, decouple_loss:0.0011632285313680768
loss_pred:0.01650778390467167, decouple_loss:0.001070731203071773
Iteration: 3318, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503832757472992, gen p mean: -0.05424819886684418, mean p set: 0.4508635997772217
loss_pred:0.01611938886344433, decouple_loss:0.0011282310588285327
The modified gen p mean: 0.4517481029033661, gen p mean: -0.04682324826717377, mean p set: 0.4522283971309662The modified gen p mean: 0.45199593901634216, gen p mean: -0.0491446889936924, mean p set: 0.45247623324394226
loss_pred:0.015697075054049492, decouple_loss:0.0011196060804650187
loss_pred:0.016541965305805206, decouple_loss:0.001065253745764494
Iteration: 3319, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4527318775653839, gen p mean: -0.04795931279659271, mean p set: 0.453212171792984
loss_pred:0.01603402942419052, decouple_loss:0.0011136317625641823
The modified gen p mean: 0.4521905481815338, gen p mean: -0.043632689863443375, mean p set: 0.4526708722114563The modified gen p mean: 0.45201101899147034, gen p mean: -0.054309893399477005, mean p set: 0.4524913430213928
loss_pred:0.015495709143579006, decouple_loss:0.001020466210320592
loss_pred:0.016055170446634293, decouple_loss:0.0011117516551166773
Iteration: 3320, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45069485902786255, gen p mean: -0.04783714935183525, mean p set: 0.45117518305778503
loss_pred:0.015391563065350056, decouple_loss:0.0009798307437449694
The modified gen p mean: 0.45024070143699646, gen p mean: -0.0485871322453022, mean p set: 0.45072096586227417The modified gen p mean: 0.45361801981925964, gen p mean: -0.0494459867477417, mean p set: 0.45409834384918213
loss_pred:0.016354139894247055, decouple_loss:0.0012508173240348697
loss_pred:0.0155404694378376, decouple_loss:0.0011768002295866609
2023-05-02 15:10:44 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.05809599533677101, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.05393066257238388, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.05432497337460518, mean p set: 0.4500633478164673
loss_pred:0.018349379301071167, decouple_loss:0.001154088880866766
loss_pred:0.017327016219496727, decouple_loss:0.0010442251805216074
loss_pred:0.017382966354489326, decouple_loss:0.0010352546814829111
WV_0_PC_1_EH_0_PS_40, loss: 0.017740346491336823, avg_mse: 0.02554047852754593
current test mse: 0.02554
Iteration: 3321, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508916139602661, gen p mean: -0.04776277393102646, mean p set: 0.4513719379901886
The modified gen p mean: 0.4491191804409027, gen p mean: -0.052034493535757065, mean p set: 0.4495995044708252
The modified gen p mean: 0.44847601652145386, gen p mean: -0.054303135722875595, mean p set: 0.44895628094673157
loss_pred:0.016417015343904495, decouple_loss:0.0011659077135846019
loss_pred:0.016004808247089386, decouple_loss:0.0013203767593950033
loss_pred:0.01638423092663288, decouple_loss:0.0010682635474950075
Iteration: 3322, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513704478740692, gen p mean: -0.04580617696046829, mean p set: 0.4518507122993469
loss_pred:0.0168389193713665, decouple_loss:0.0013689540792256594
The modified gen p mean: 0.45002231001853943, gen p mean: -0.047437142580747604, mean p set: 0.4505026042461395The modified gen p mean: 0.4505334794521332, gen p mean: -0.046371378004550934, mean p set: 0.45101380348205566
loss_pred:0.016645163297653198, decouple_loss:0.0012140476610511541
loss_pred:0.015910454094409943, decouple_loss:0.001166955684311688
Iteration: 3323, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4518354535102844, gen p mean: -0.04601602256298065, mean p set: 0.4523157775402069
loss_pred:0.01632712595164776, decouple_loss:0.0011502350680530071
The modified gen p mean: 0.45126327872276306, gen p mean: -0.04900069907307625, mean p set: 0.45174357295036316The modified gen p mean: 0.45054686069488525, gen p mean: -0.04608055576682091, mean p set: 0.45102712512016296
loss_pred:0.01653626561164856, decouple_loss:0.0011372074950486422
loss_pred:0.01636628434062004, decouple_loss:0.001112313591875136
Iteration: 3324, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508422911167145, gen p mean: -0.044297344982624054, mean p set: 0.4513225853443146
loss_pred:0.01581215299665928, decouple_loss:0.0010967182461172342
The modified gen p mean: 0.44965657591819763, gen p mean: -0.05022301524877548, mean p set: 0.45013684034347534The modified gen p mean: 0.45202091336250305, gen p mean: -0.0449502095580101, mean p set: 0.45250123739242554
loss_pred:0.01649288274347782, decouple_loss:0.001076300977729261
loss_pred:0.015742456540465355, decouple_loss:0.0011270268587395549
Iteration: 3325, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4517291784286499, gen p mean: -0.0443735308945179, mean p set: 0.4522095024585724
loss_pred:0.016365351155400276, decouple_loss:0.001187509624287486
The modified gen p mean: 0.45275965332984924, gen p mean: -0.04600659757852554, mean p set: 0.45323994755744934The modified gen p mean: 0.4516531229019165, gen p mean: -0.04132683947682381, mean p set: 0.4521334171295166
loss_pred:0.01627880334854126, decouple_loss:0.0011413025204092264
loss_pred:0.016079019755125046, decouple_loss:0.0011235554702579975
Iteration: 3326, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45068544149398804, gen p mean: -0.044407397508621216, mean p set: 0.45116573572158813
loss_pred:0.016012748703360558, decouple_loss:0.0010584451956674457
The modified gen p mean: 0.44940948486328125, gen p mean: -0.04939936846494675, mean p set: 0.44988977909088135The modified gen p mean: 0.4500981867313385, gen p mean: -0.044387709349393845, mean p set: 0.4505784809589386
loss_pred:0.016408562660217285, decouple_loss:0.0012336013605818152
loss_pred:0.016009069979190826, decouple_loss:0.0012121647596359253
Iteration: 3327, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45328283309936523, gen p mean: -0.04683619365096092, mean p set: 0.45376312732696533
loss_pred:0.015459432266652584, decouple_loss:0.0011866046115756035
The modified gen p mean: 0.4523312449455261, gen p mean: -0.04782350733876228, mean p set: 0.4528115391731262The modified gen p mean: 0.45081716775894165, gen p mean: -0.042237650603055954, mean p set: 0.45129746198654175
loss_pred:0.016834648326039314, decouple_loss:0.0010553192114457488
loss_pred:0.016348719596862793, decouple_loss:0.0010453460272401571
Iteration: 3328, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4521346390247345, gen p mean: -0.04576081782579422, mean p set: 0.452614963054657
loss_pred:0.01574920304119587, decouple_loss:0.0013111606240272522
The modified gen p mean: 0.45292168855667114, gen p mean: -0.04580063000321388, mean p set: 0.45340198278427124The modified gen p mean: 0.4513097405433655, gen p mean: -0.044377777725458145, mean p set: 0.4517900347709656
loss_pred:0.015713747590780258, decouple_loss:0.0013035510201007128
loss_pred:0.01547461748123169, decouple_loss:0.0011718233581632376
Iteration: 3329, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4534585177898407, gen p mean: -0.04453185200691223, mean p set: 0.4539388418197632
loss_pred:0.015704335644841194, decouple_loss:0.0010851378319784999
The modified gen p mean: 0.4522360563278198, gen p mean: -0.04847212880849838, mean p set: 0.4527163803577423The modified gen p mean: 0.4520135223865509, gen p mean: -0.042166948318481445, mean p set: 0.4524938464164734
loss_pred:0.016065703704953194, decouple_loss:0.001085191499441862
loss_pred:0.01593949645757675, decouple_loss:0.0011465678690001369
Iteration: 3330, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45066696405410767, gen p mean: -0.043032556772232056, mean p set: 0.45114725828170776
loss_pred:0.01598571054637432, decouple_loss:0.001266990788280964
The modified gen p mean: 0.452411949634552, gen p mean: -0.045825596898794174, mean p set: 0.4528922438621521The modified gen p mean: 0.4495322108268738, gen p mean: -0.04653046280145645, mean p set: 0.4500125050544739
loss_pred:0.015538741834461689, decouple_loss:0.0013188275042921305
loss_pred:0.01655641198158264, decouple_loss:0.0012818590039387345
2023-05-02 15:12:38 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.054986704140901566, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.051246631890535355, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.05164352059364319, mean p set: 0.4500633478164673
loss_pred:0.018285930156707764, decouple_loss:0.0011623637983575463
loss_pred:0.01723776012659073, decouple_loss:0.0011148431804031134
loss_pred:0.01732383482158184, decouple_loss:0.001189577393233776
WV_0_PC_1_EH_0_PS_40, loss: 0.01767362281680107, avg_mse: 0.025409873574972153
current test mse: 0.02541
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012002_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012002_3_24hr.npz
NaN value num: 0
Iteration: 3331, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45139554142951965, gen p mean: -0.04825693741440773, mean p set: 0.45187583565711975
loss_pred:0.015895439311861992, decouple_loss:0.001259142649360001
The modified gen p mean: 0.44988012313842773, gen p mean: -0.050131890922784805, mean p set: 0.4503604471683502The modified gen p mean: 0.44922783970832825, gen p mean: -0.046030521392822266, mean p set: 0.44970813393592834
loss_pred:0.01462752465158701, decouple_loss:0.0011690923711284995
loss_pred:0.015601462684571743, decouple_loss:0.001244626590050757
Iteration: 3332, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44964835047721863, gen p mean: -0.0532592236995697, mean p set: 0.4501286447048187
loss_pred:0.014325841329991817, decouple_loss:0.0010631458135321736
The modified gen p mean: 0.44902917742729187, gen p mean: -0.04301045089960098, mean p set: 0.44950950145721436The modified gen p mean: 0.4496802091598511, gen p mean: -0.05385058373212814, mean p set: 0.4501604735851288
loss_pred:0.014709502458572388, decouple_loss:0.001027939491905272
loss_pred:0.015773141756653786, decouple_loss:0.0010864181676879525
Iteration: 3333, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44930359721183777, gen p mean: -0.047708287835121155, mean p set: 0.44978389143943787
loss_pred:0.014590255916118622, decouple_loss:0.0010114925680682063
The modified gen p mean: 0.44943132996559143, gen p mean: -0.04906304553151131, mean p set: 0.44991159439086914The modified gen p mean: 0.44934192299842834, gen p mean: -0.0458076186478138, mean p set: 0.44982221722602844
loss_pred:0.014866732992231846, decouple_loss:0.0010344558395445347
loss_pred:0.015859104692935944, decouple_loss:0.001012616790831089
Iteration: 3334, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490946829319, gen p mean: -0.048453040421009064, mean p set: 0.44957494735717773
loss_pred:0.014428580179810524, decouple_loss:0.0010029807453975081
The modified gen p mean: 0.4512721002101898, gen p mean: -0.054074037820100784, mean p set: 0.45175236463546753
The modified gen p mean: 0.44909995794296265, gen p mean: -0.05493361875414848, mean p set: 0.44958019256591797
loss_pred:0.01594315469264984, decouple_loss:0.0011270374525338411
loss_pred:0.014829614199697971, decouple_loss:0.0012383778812363744
Iteration: 3335, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514003098011017, gen p mean: -0.04737810790538788, mean p set: 0.4518806040287018
loss_pred:0.015496989712119102, decouple_loss:0.0011008064029738307
The modified gen p mean: 0.45032092928886414, gen p mean: -0.05415753275156021, mean p set: 0.45080122351646423The modified gen p mean: 0.4511229395866394, gen p mean: -0.05052799731492996, mean p set: 0.4516032636165619
loss_pred:0.01541799958795309, decouple_loss:0.0010546691482886672
loss_pred:0.015257650054991245, decouple_loss:0.0010460505727678537
Iteration: 3336, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449905127286911, gen p mean: -0.049820676445961, mean p set: 0.4503854513168335
loss_pred:0.014568671584129333, decouple_loss:0.001258369069546461
The modified gen p mean: 0.4491424262523651, gen p mean: -0.05737802013754845, mean p set: 0.4496227502822876The modified gen p mean: 0.4518599212169647, gen p mean: -0.050041235983371735, mean p set: 0.4523402154445648
loss_pred:0.014538716524839401, decouple_loss:0.0010116540361195803
loss_pred:0.016366586089134216, decouple_loss:0.0010007243836298585
Iteration: 3337, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44988110661506653, gen p mean: -0.052518781274557114, mean p set: 0.4503614008426666
loss_pred:0.01558866910636425, decouple_loss:0.0011039790697395802
The modified gen p mean: 0.45121848583221436, gen p mean: -0.052174728363752365, mean p set: 0.45169880986213684The modified gen p mean: 0.450796902179718, gen p mean: -0.05594966188073158, mean p set: 0.4512771964073181
loss_pred:0.01532687246799469, decouple_loss:0.0011825752444565296
loss_pred:0.015614424832165241, decouple_loss:0.001341966213658452
Iteration: 3338, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497816562652588, gen p mean: -0.05357436090707779, mean p set: 0.4502619802951813
loss_pred:0.015467098914086819, decouple_loss:0.0011458148946985602
The modified gen p mean: 0.4493030309677124, gen p mean: -0.05344498157501221, mean p set: 0.4497832953929901The modified gen p mean: 0.4495278596878052, gen p mean: -0.0493830181658268, mean p set: 0.4500081539154053
loss_pred:0.015666259452700615, decouple_loss:0.001107198535464704
loss_pred:0.015635237097740173, decouple_loss:0.0011287357192486525
Iteration: 3339, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44948169589042664, gen p mean: -0.04562640190124512, mean p set: 0.44996196031570435
loss_pred:0.015727533027529716, decouple_loss:0.001143127796240151
The modified gen p mean: 0.44972214102745056, gen p mean: -0.05392945557832718, mean p set: 0.45020246505737305The modified gen p mean: 0.4506269693374634, gen p mean: -0.04982820153236389, mean p set: 0.4511072635650635
loss_pred:0.015368051826953888, decouple_loss:0.0010688407346606255
loss_pred:0.015895042568445206, decouple_loss:0.0011284379288554192
Iteration: 3340, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491126239299774, gen p mean: -0.04638972505927086, mean p set: 0.4495929181575775
loss_pred:0.015315786935389042, decouple_loss:0.0010901220375671983
The modified gen p mean: 0.44946160912513733, gen p mean: -0.05466749519109726, mean p set: 0.44994187355041504The modified gen p mean: 0.44900307059288025, gen p mean: -0.04649997502565384, mean p set: 0.44948339462280273
loss_pred:0.014910525642335415, decouple_loss:0.0013849290553480387
loss_pred:0.015121664851903915, decouple_loss:0.0010546769481152296
2023-05-02 15:15:10 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.058611735701560974, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.054347533732652664, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.054874490946531296, mean p set: 0.4500633478164673
loss_pred:0.01841297559440136, decouple_loss:0.001308036269620061
loss_pred:0.017288686707615852, decouple_loss:0.0011464994167909026
loss_pred:0.017394978553056717, decouple_loss:0.00116168858949095
WV_0_PC_1_EH_0_PS_40, loss: 0.017759151756763458, avg_mse: 0.025554949417710304
current test mse: 0.025555
Iteration: 3341, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504971206188202, gen p mean: -0.04517873749136925, mean p set: 0.4509774148464203
The modified gen p mean: 0.44958746433258057, gen p mean: -0.0453752800822258, mean p set: 0.45006775856018066
The modified gen p mean: 0.44990983605384827, gen p mean: -0.04867212101817131, mean p set: 0.45039013028144836
loss_pred:0.015319774858653545, decouple_loss:0.0011134393280372024
loss_pred:0.015595104545354843, decouple_loss:0.0011306697269901633
loss_pred:0.01491162646561861, decouple_loss:0.001143106259405613
Iteration: 3342, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502370357513428, gen p mean: -0.04690322279930115, mean p set: 0.45071735978126526
loss_pred:0.014535686932504177, decouple_loss:0.0013135415501892567
The modified gen p mean: 0.4493320882320404, gen p mean: -0.05376918241381645, mean p set: 0.4498123526573181The modified gen p mean: 0.449188768863678, gen p mean: -0.051738955080509186, mean p set: 0.4496690630912781
loss_pred:0.014561258256435394, decouple_loss:0.0012377655366435647
loss_pred:0.01540707889944315, decouple_loss:0.001176276826299727
Iteration: 3343, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45152056217193604, gen p mean: -0.04711492732167244, mean p set: 0.45200085639953613
loss_pred:0.015370475128293037, decouple_loss:0.0010560621740296483
The modified gen p mean: 0.4492533504962921, gen p mean: -0.044712942093610764, mean p set: 0.4497336745262146The modified gen p mean: 0.452597975730896, gen p mean: -0.049965038895606995, mean p set: 0.4530782699584961
loss_pred:0.015081829391419888, decouple_loss:0.0011666377540677786
loss_pred:0.01544359140098095, decouple_loss:0.0013585938140749931
Iteration: 3344, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45159289240837097, gen p mean: -0.04242704063653946, mean p set: 0.45207321643829346
loss_pred:0.015803823247551918, decouple_loss:0.0011777357431128621
The modified gen p mean: 0.44972312450408936, gen p mean: -0.05027947202324867, mean p set: 0.45020341873168945The modified gen p mean: 0.4511413872241974, gen p mean: -0.04493148997426033, mean p set: 0.4516216814517975
loss_pred:0.015917571261525154, decouple_loss:0.0011800379725173116
loss_pred:0.015461492352187634, decouple_loss:0.0011821689549833536
Iteration: 3345, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44913119077682495, gen p mean: -0.050879765301942825, mean p set: 0.44961148500442505
loss_pred:0.015171566046774387, decouple_loss:0.0011236382415518165
The modified gen p mean: 0.4495282769203186, gen p mean: -0.04673980921506882, mean p set: 0.4500085711479187The modified gen p mean: 0.4498962461948395, gen p mean: -0.04700031504034996, mean p set: 0.4503765404224396
loss_pred:0.01544045191258192, decouple_loss:0.001125277834944427
loss_pred:0.01544523611664772, decouple_loss:0.0011329685803502798
Iteration: 3346, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45019733905792236, gen p mean: -0.04908817261457443, mean p set: 0.45067763328552246
loss_pred:0.015309835784137249, decouple_loss:0.0012066649505868554
The modified gen p mean: 0.4500953257083893, gen p mean: -0.045597370713949203, mean p set: 0.4505756199359894The modified gen p mean: 0.4504595994949341, gen p mean: -0.0480710007250309, mean p set: 0.45093992352485657
loss_pred:0.015880966559052467, decouple_loss:0.001195702119730413
loss_pred:0.015881255269050598, decouple_loss:0.0011805029353126884
Iteration: 3347, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493807256221771, gen p mean: -0.05011744424700737, mean p set: 0.4498610198497772
loss_pred:0.015483975410461426, decouple_loss:0.001126539777033031
The modified gen p mean: 0.452171266078949, gen p mean: -0.049047891050577164, mean p set: 0.45265159010887146The modified gen p mean: 0.45158401131629944, gen p mean: -0.048759546130895615, mean p set: 0.45206427574157715
loss_pred:0.01547014806419611, decouple_loss:0.0012528165243566036
loss_pred:0.01505689974874258, decouple_loss:0.0013528343988582492
Iteration: 3348, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489581882953644, gen p mean: -0.045469991862773895, mean p set: 0.4494384825229645
loss_pred:0.014538614079356194, decouple_loss:0.0010631323093548417
The modified gen p mean: 0.4490774869918823, gen p mean: -0.053585004061460495, mean p set: 0.4495577812194824The modified gen p mean: 0.4497954249382019, gen p mean: -0.05321149528026581, mean p set: 0.450275719165802
loss_pred:0.015289208851754665, decouple_loss:0.0009755177306942642
loss_pred:0.0138277318328619, decouple_loss:0.0011194988619536161
Iteration: 3349, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511968195438385, gen p mean: -0.05015787109732628, mean p set: 0.451677143573761
loss_pred:0.015382815152406693, decouple_loss:0.0010968681890517473
The modified gen p mean: 0.45185157656669617, gen p mean: -0.04770134389400482, mean p set: 0.45233187079429626The modified gen p mean: 0.45126527547836304, gen p mean: -0.04926323890686035, mean p set: 0.45174553990364075
loss_pred:0.015617972239851952, decouple_loss:0.0009723916300572455
loss_pred:0.015379728749394417, decouple_loss:0.0011795515893027186
Iteration: 3350, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45017534494400024, gen p mean: -0.049518730491399765, mean p set: 0.45065566897392273
loss_pred:0.015219628810882568, decouple_loss:0.0009233557502739131
The modified gen p mean: 0.4497600495815277, gen p mean: -0.04804566502571106, mean p set: 0.4502403438091278The modified gen p mean: 0.45003461837768555, gen p mean: -0.045726925134658813, mean p set: 0.45051491260528564
loss_pred:0.014609038829803467, decouple_loss:0.0009575015283189714
loss_pred:0.014724832028150558, decouple_loss:0.0008976089302450418
2023-05-02 15:17:04 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.057187244296073914, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.053312066942453384, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.05355825275182724, mean p set: 0.4500633478164673
loss_pred:0.01845613308250904, decouple_loss:0.0010717416880652308
loss_pred:0.017353065311908722, decouple_loss:0.0010580653324723244
loss_pred:0.017496999353170395, decouple_loss:0.0010581082897260785
WV_0_PC_1_EH_0_PS_40, loss: 0.017821863293647766, avg_mse: 0.025708533823490143
current test mse: 0.025709
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012005_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012005_3_24hr.npz
NaN value num: 0
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 3351, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487455487251282, gen p mean: -0.05396097153425217, mean p set: 0.4492258131504059
loss_pred:0.014130430296063423, decouple_loss:0.0010359674924984574
The modified gen p mean: 0.4483334422111511, gen p mean: -0.05272504314780235, mean p set: 0.4488137364387512The modified gen p mean: 0.4487197995185852, gen p mean: -0.05340017005801201, mean p set: 0.4492001235485077
loss_pred:0.014186731539666653, decouple_loss:0.0010393696138635278loss_pred:0.01399609912186861, decouple_loss:0.0010796058923006058
Iteration: 3352, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449144572019577, gen p mean: -0.05371349677443504, mean p set: 0.4496248662471771
loss_pred:0.013915639370679855, decouple_loss:0.0011756259482353926
The modified gen p mean: 0.4478552043437958, gen p mean: -0.054096587002277374, mean p set: 0.4483354985713959The modified gen p mean: 0.4482080340385437, gen p mean: -0.05221124365925789, mean p set: 0.4486883282661438
loss_pred:0.014085501432418823, decouple_loss:0.0010928706033155322
loss_pred:0.013837365433573723, decouple_loss:0.0011341888457536697
Iteration: 3353, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486353397369385, gen p mean: -0.05036206170916557, mean p set: 0.4491156041622162
loss_pred:0.013778376393020153, decouple_loss:0.0010224905563518405
The modified gen p mean: 0.4474312961101532, gen p mean: -0.04798063635826111, mean p set: 0.4479115903377533The modified gen p mean: 0.4481388330459595, gen p mean: -0.04997636377811432, mean p set: 0.44861912727355957
loss_pred:0.013927669264376163, decouple_loss:0.0010753092356026173
loss_pred:0.013854391872882843, decouple_loss:0.0010592775652185082
Iteration: 3354, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44805780053138733, gen p mean: -0.0448872335255146, mean p set: 0.44853806495666504
loss_pred:0.013555126264691353, decouple_loss:0.0011455659987404943
The modified gen p mean: 0.448984295129776, gen p mean: -0.04665438458323479, mean p set: 0.4494645595550537The modified gen p mean: 0.4488264322280884, gen p mean: -0.049221184104681015, mean p set: 0.44930675625801086
loss_pred:0.013695566914975643, decouple_loss:0.0011545477900654078
loss_pred:0.01338193379342556, decouple_loss:0.001029095845296979
Iteration: 3355, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492050111293793, gen p mean: -0.046690963208675385, mean p set: 0.449685275554657
loss_pred:0.013683011755347252, decouple_loss:0.0010719811543822289
The modified gen p mean: 0.4481961727142334, gen p mean: -0.046644918620586395, mean p set: 0.4486764669418335The modified gen p mean: 0.4485744833946228, gen p mean: -0.045116838067770004, mean p set: 0.4490547776222229
loss_pred:0.014056580141186714, decouple_loss:0.0012285001575946808
loss_pred:0.013699769042432308, decouple_loss:0.0010762392776086926
Iteration: 3356, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494702219963074, gen p mean: -0.04282056540250778, mean p set: 0.44995051622390747
loss_pred:0.013789530843496323, decouple_loss:0.0010849932441487908
The modified gen p mean: 0.4478801488876343, gen p mean: -0.046104803681373596, mean p set: 0.4483604431152344
The modified gen p mean: 0.44903212785720825, gen p mean: -0.04452943801879883, mean p set: 0.44951245188713074
loss_pred:0.013733578845858574, decouple_loss:0.001100598368793726
loss_pred:0.013246576301753521, decouple_loss:0.0011149491183459759
Iteration: 3357, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487270712852478, gen p mean: -0.047726888209581375, mean p set: 0.4492073655128479
loss_pred:0.013119342736899853, decouple_loss:0.001127465395256877
The modified gen p mean: 0.44807833433151245, gen p mean: -0.04897633194923401, mean p set: 0.44855865836143494The modified gen p mean: 0.4486894905567169, gen p mean: -0.05023089051246643, mean p set: 0.44916975498199463
loss_pred:0.013915876857936382, decouple_loss:0.0010662232525646687
loss_pred:0.013520837761461735, decouple_loss:0.0012495374539867043
Iteration: 3358, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44858911633491516, gen p mean: -0.05336286872625351, mean p set: 0.44906941056251526
loss_pred:0.013361855410039425, decouple_loss:0.0011985577875748277
The modified gen p mean: 0.44862884283065796, gen p mean: -0.052030470222234726, mean p set: 0.44910916686058044The modified gen p mean: 0.44870543479919434, gen p mean: -0.0539531335234642, mean p set: 0.4491857588291168
loss_pred:0.013692332431674004, decouple_loss:0.0013818725710734725
loss_pred:0.013667020946741104, decouple_loss:0.0011486639268696308
Iteration: 3359, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44955798983573914, gen p mean: -0.057416319847106934, mean p set: 0.45003825426101685
loss_pred:0.013417274691164494, decouple_loss:0.0011499907122924924
The modified gen p mean: 0.44889020919799805, gen p mean: -0.055263061076402664, mean p set: 0.44937053322792053The modified gen p mean: 0.44635310769081116, gen p mean: -0.05445762723684311, mean p set: 0.44683340191841125
loss_pred:0.013776630163192749, decouple_loss:0.0012033371021971107
loss_pred:0.013772985897958279, decouple_loss:0.0011341418139636517
Iteration: 3360, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480448067188263, gen p mean: -0.05576803535223007, mean p set: 0.4485251009464264
loss_pred:0.01351400837302208, decouple_loss:0.0012284753611311316
The modified gen p mean: 0.4475170075893402, gen p mean: -0.05124782398343086, mean p set: 0.4479973018169403The modified gen p mean: 0.4473927319049835, gen p mean: -0.043443139642477036, mean p set: 0.447873055934906
loss_pred:0.013552572578191757, decouple_loss:0.001284689991734922
loss_pred:0.01372523233294487, decouple_loss:0.0012415344826877117
2023-05-02 15:19:38 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.052242476493120193, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04862532019615173, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.04863395914435387, mean p set: 0.4500633478164673
loss_pred:0.019013643264770508, decouple_loss:0.0014166203327476978
loss_pred:0.017946990206837654, decouple_loss:0.0013050342677161098
loss_pred:0.0179641991853714, decouple_loss:0.0013306414475664496
WV_0_PC_1_EH_0_PS_40, loss: 0.01837581768631935, avg_mse: 0.02677064947783947
current test mse: 0.026771
Iteration: 3361, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472561478614807, gen p mean: -0.05124703794717789, mean p set: 0.4477364122867584
The modified gen p mean: 0.4479963183403015, gen p mean: -0.052321359515190125, mean p set: 0.4484765827655792
The modified gen p mean: 0.44823095202445984, gen p mean: -0.0452268160879612, mean p set: 0.44871124625205994
loss_pred:0.013496742583811283, decouple_loss:0.0012879862915724516
loss_pred:0.013805478811264038, decouple_loss:0.0015133182751014829
loss_pred:0.013408854603767395, decouple_loss:0.0012852884829044342
Iteration: 3362, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448775053024292, gen p mean: -0.04309821128845215, mean p set: 0.4492553174495697
loss_pred:0.013296656310558319, decouple_loss:0.001172552234493196
The modified gen p mean: 0.44847413897514343, gen p mean: -0.04950905591249466, mean p set: 0.44895440340042114The modified gen p mean: 0.448012113571167, gen p mean: -0.04433612897992134, mean p set: 0.4484924077987671
loss_pred:0.013301939703524113, decouple_loss:0.0012868520570918918
loss_pred:0.013354131951928139, decouple_loss:0.0013237381353974342
Iteration: 3363, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44877079129219055, gen p mean: -0.03955059126019478, mean p set: 0.44925105571746826
The modified gen p mean: 0.44863730669021606, gen p mean: -0.04101143777370453, mean p set: 0.44911760091781616loss_pred:0.013356726616621017, decouple_loss:0.001118859858252108
The modified gen p mean: 0.4487855136394501, gen p mean: -0.041334137320518494, mean p set: 0.44926580786705017
loss_pred:0.01357384491711855, decouple_loss:0.0012493738904595375
loss_pred:0.013351352885365486, decouple_loss:0.0011947941966354847
Iteration: 3364, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44719505310058594, gen p mean: -0.04192845895886421, mean p set: 0.4476754069328308
The modified gen p mean: 0.4484032988548279, gen p mean: -0.043789561837911606, mean p set: 0.4488835632801056
loss_pred:0.013637465424835682, decouple_loss:0.0013002658961340785
loss_pred:0.012971146032214165, decouple_loss:0.001287198974750936
The modified gen p mean: 0.44737279415130615, gen p mean: -0.044318750500679016, mean p set: 0.44785305857658386
loss_pred:0.013722790405154228, decouple_loss:0.0012820130214095116
Iteration: 3365, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44869399070739746, gen p mean: -0.04728199914097786, mean p set: 0.44917428493499756
loss_pred:0.013263843022286892, decouple_loss:0.0012613722356036305
The modified gen p mean: 0.4477235674858093, gen p mean: -0.038204945623874664, mean p set: 0.4482038617134094The modified gen p mean: 0.4489460289478302, gen p mean: -0.04234549403190613, mean p set: 0.4494262933731079
loss_pred:0.013289229944348335, decouple_loss:0.001242937403731048
loss_pred:0.013620708137750626, decouple_loss:0.0011319033801555634
Iteration: 3366, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44808676838874817, gen p mean: -0.051511894911527634, mean p set: 0.44856706261634827
loss_pred:0.013520459644496441, decouple_loss:0.001351039856672287
The modified gen p mean: 0.447951078414917, gen p mean: -0.049903303384780884, mean p set: 0.4484313726425171The modified gen p mean: 0.4485594630241394, gen p mean: -0.04918942227959633, mean p set: 0.4490397274494171
loss_pred:0.013311401940882206, decouple_loss:0.001306414371356368
loss_pred:0.01351570338010788, decouple_loss:0.0013057596515864134
Iteration: 3367, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44666147232055664, gen p mean: -0.0523030087351799, mean p set: 0.44714176654815674
loss_pred:0.01363279391080141, decouple_loss:0.0011930899927392602
The modified gen p mean: 0.4475848078727722, gen p mean: -0.045858342200517654, mean p set: 0.4480650722980499The modified gen p mean: 0.4495489001274109, gen p mean: -0.05227856710553169, mean p set: 0.450029194355011
loss_pred:0.013144586235284805, decouple_loss:0.0010306888725608587
loss_pred:0.013393830507993698, decouple_loss:0.001080513233318925
Iteration: 3368, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44933339953422546, gen p mean: -0.05146798864006996, mean p set: 0.44981372356414795
loss_pred:0.01312960870563984, decouple_loss:0.0012025898322463036
The modified gen p mean: 0.44862380623817444, gen p mean: -0.050509583204984665, mean p set: 0.44910410046577454The modified gen p mean: 0.4485089182853699, gen p mean: -0.05595087260007858, mean p set: 0.44898921251296997
loss_pred:0.012924792245030403, decouple_loss:0.0012505832128226757
loss_pred:0.013592500239610672, decouple_loss:0.0012725131819024682
Iteration: 3369, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477640390396118, gen p mean: -0.04894253984093666, mean p set: 0.4482443630695343
loss_pred:0.01352748367935419, decouple_loss:0.0010869632242247462
The modified gen p mean: 0.4482963979244232, gen p mean: -0.05379614606499672, mean p set: 0.4487766921520233The modified gen p mean: 0.44839170575141907, gen p mean: -0.05340640991926193, mean p set: 0.44887199997901917
loss_pred:0.013348471373319626, decouple_loss:0.0011924207210540771
loss_pred:0.013109653256833553, decouple_loss:0.0011003604158759117
Iteration: 3370, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482119381427765, gen p mean: -0.049053169786930084, mean p set: 0.4486922323703766
loss_pred:0.013509763404726982, decouple_loss:0.001089124591089785
The modified gen p mean: 0.4487673342227936, gen p mean: -0.05166327953338623, mean p set: 0.44924765825271606The modified gen p mean: 0.4477488100528717, gen p mean: -0.04869319498538971, mean p set: 0.4482291042804718
loss_pred:0.012926435098052025, decouple_loss:0.0011557763209566474
loss_pred:0.013383696787059307, decouple_loss:0.001202573999762535
2023-05-02 15:21:33 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.05091135948896408, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.047200556844472885, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.04720420390367508, mean p set: 0.4500633478164673
loss_pred:0.01894400827586651, decouple_loss:0.001418659812770784
loss_pred:0.017863936722278595, decouple_loss:0.0012476930860430002
loss_pred:0.017845993861556053, decouple_loss:0.0012042646994814277
WV_0_PC_1_EH_0_PS_40, loss: 0.018282491713762283, avg_mse: 0.02662082388997078
current test mse: 0.026621
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012019_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012019_3_24hr.npz
NaN value num: 0
Iteration: 3371, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45104271173477173, gen p mean: -0.04226788878440857, mean p set: 0.4515230059623718
loss_pred:0.015436256304383278, decouple_loss:0.00124073657207191
The modified gen p mean: 0.45237085223197937, gen p mean: -0.04162294790148735, mean p set: 0.45285114645957947The modified gen p mean: 0.45307406783103943, gen p mean: -0.039864975959062576, mean p set: 0.4535543620586395
loss_pred:0.015407674945890903, decouple_loss:0.0013606059364974499
loss_pred:0.01521803718060255, decouple_loss:0.0013860476901754737
Iteration: 3372, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.452144593000412, gen p mean: -0.039590802043676376, mean p set: 0.4526248872280121
loss_pred:0.015447955578565598, decouple_loss:0.0011289747199043632
The modified gen p mean: 0.45081135630607605, gen p mean: -0.03432198986411095, mean p set: 0.45129165053367615
The modified gen p mean: 0.4510781764984131, gen p mean: -0.03808842599391937, mean p set: 0.4515584707260132
loss_pred:0.016363102942705154, decouple_loss:0.0011098170652985573
loss_pred:0.015581746585667133, decouple_loss:0.0010956311598420143
Iteration: 3373, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4517216682434082, gen p mean: -0.03559714928269386, mean p set: 0.4522019624710083
loss_pred:0.01562509499490261, decouple_loss:0.0014498825185000896
The modified gen p mean: 0.4496847987174988, gen p mean: -0.03627348691225052, mean p set: 0.45016512274742126The modified gen p mean: 0.45015791058540344, gen p mean: -0.04070087894797325, mean p set: 0.45063820481300354
loss_pred:0.015286171808838844, decouple_loss:0.0014200119767338037
loss_pred:0.015317502431571484, decouple_loss:0.0013686353340744972
Iteration: 3374, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4529097378253937, gen p mean: -0.03706018999218941, mean p set: 0.4533900320529938
loss_pred:0.014932489953935146, decouple_loss:0.001445249654352665
The modified gen p mean: 0.44992557168006897, gen p mean: -0.032791268080472946, mean p set: 0.45040586590766907The modified gen p mean: 0.45027273893356323, gen p mean: -0.034905314445495605, mean p set: 0.45075303316116333
loss_pred:0.015290400944650173, decouple_loss:0.001482015592046082
loss_pred:0.015356176532804966, decouple_loss:0.0013782278401777148
Iteration: 3375, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45063239336013794, gen p mean: -0.046481624245643616, mean p set: 0.45111268758773804
loss_pred:0.014648699201643467, decouple_loss:0.0014260794268921018
The modified gen p mean: 0.45123547315597534, gen p mean: -0.040778521448373795, mean p set: 0.4517157971858978The modified gen p mean: 0.4506165683269501, gen p mean: -0.03840731084346771, mean p set: 0.4510968327522278
loss_pred:0.01613660342991352, decouple_loss:0.0012665648246183991
loss_pred:0.0155944200232625, decouple_loss:0.0013602881226688623
Iteration: 3376, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45158693194389343, gen p mean: -0.04349609091877937, mean p set: 0.45206722617149353
loss_pred:0.015745840966701508, decouple_loss:0.0012878339039161801
The modified gen p mean: 0.450790673494339, gen p mean: -0.04196659103035927, mean p set: 0.4512709379196167The modified gen p mean: 0.45104217529296875, gen p mean: -0.03810309246182442, mean p set: 0.45152246952056885
loss_pred:0.015363691374659538, decouple_loss:0.0011706216027960181
loss_pred:0.01599145494401455, decouple_loss:0.0013476097956299782
Iteration: 3377, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4509286880493164, gen p mean: -0.0410950742661953, mean p set: 0.4514089822769165
loss_pred:0.015538684092462063, decouple_loss:0.0012276326306164265
The modified gen p mean: 0.4511336088180542, gen p mean: -0.043592628091573715, mean p set: 0.4516139328479767The modified gen p mean: 0.4517934322357178, gen p mean: -0.04344206675887108, mean p set: 0.4522736966609955
loss_pred:0.015041214413940907, decouple_loss:0.001359923044219613
loss_pred:0.0156540609896183, decouple_loss:0.0011698058806359768
Iteration: 3378, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502018690109253, gen p mean: -0.04341919720172882, mean p set: 0.450682133436203
loss_pred:0.015578488819301128, decouple_loss:0.0012306750286370516
The modified gen p mean: 0.4516751766204834, gen p mean: -0.041010331362485886, mean p set: 0.4521554708480835The modified gen p mean: 0.4507935643196106, gen p mean: -0.0378260612487793, mean p set: 0.4512738585472107
loss_pred:0.015305855311453342, decouple_loss:0.0013254317454993725
loss_pred:0.01590603217482567, decouple_loss:0.0011872235918417573
Iteration: 3379, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45177724957466125, gen p mean: -0.04256444796919823, mean p set: 0.45225754380226135
loss_pred:0.016165895387530327, decouple_loss:0.0012178890174254775
The modified gen p mean: 0.45073387026786804, gen p mean: -0.03978060930967331, mean p set: 0.45121413469314575The modified gen p mean: 0.4514670968055725, gen p mean: -0.04457367956638336, mean p set: 0.4519473612308502
loss_pred:0.015112885273993015, decouple_loss:0.001073718536645174
loss_pred:0.015484103932976723, decouple_loss:0.0011442371178418398
Iteration: 3380, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4509282410144806, gen p mean: -0.0456264466047287, mean p set: 0.4514085352420807
loss_pred:0.014850671403110027, decouple_loss:0.001121266046538949
The modified gen p mean: 0.4524184763431549, gen p mean: -0.03538857027888298, mean p set: 0.452898770570755The modified gen p mean: 0.4518786370754242, gen p mean: -0.04260033741593361, mean p set: 0.4523589313030243
loss_pred:0.015571542084217072, decouple_loss:0.0011185784824192524
loss_pred:0.015026958659291267, decouple_loss:0.0011550047202035785
2023-05-02 15:24:14 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.05215052515268326, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04816223680973053, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.048356834799051285, mean p set: 0.4500633478164673
loss_pred:0.018620649352669716, decouple_loss:0.0014630628284066916
loss_pred:0.01758691295981407, decouple_loss:0.001368724275380373
loss_pred:0.017527561634778976, decouple_loss:0.0013305365573614836
WV_0_PC_1_EH_0_PS_40, loss: 0.01798108033835888, avg_mse: 0.025980034843087196
current test mse: 0.02598
Iteration: 3381, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45241662859916687, gen p mean: -0.039104048162698746, mean p set: 0.4528968930244446
The modified gen p mean: 0.4512689709663391, gen p mean: -0.04076068475842476, mean p set: 0.4517492651939392
The modified gen p mean: 0.4504019320011139, gen p mean: -0.047809451818466187, mean p set: 0.450882226228714
loss_pred:0.014454376883804798, decouple_loss:0.0010621618712320924
loss_pred:0.014855260960757732, decouple_loss:0.0013388077495619655
loss_pred:0.014721384271979332, decouple_loss:0.0010216489899903536
Iteration: 3382, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504564106464386, gen p mean: -0.03729553520679474, mean p set: 0.4509367048740387
loss_pred:0.014754495583474636, decouple_loss:0.0011852908646687865
The modified gen p mean: 0.4519047439098358, gen p mean: -0.03929223120212555, mean p set: 0.4523850381374359The modified gen p mean: 0.4497269093990326, gen p mean: -0.04180401936173439, mean p set: 0.4502072036266327
loss_pred:0.015525473281741142, decouple_loss:0.0011863196268677711
loss_pred:0.01529383659362793, decouple_loss:0.0010771503439173102
Iteration: 3383, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45098817348480225, gen p mean: -0.04450192674994469, mean p set: 0.45146840810775757
loss_pred:0.01571008935570717, decouple_loss:0.0010432387934997678
The modified gen p mean: 0.45110297203063965, gen p mean: -0.04046875610947609, mean p set: 0.45158323645591736The modified gen p mean: 0.45139825344085693, gen p mean: -0.04089587926864624, mean p set: 0.45187854766845703
loss_pred:0.015900129452347755, decouple_loss:0.0010371205862611532
loss_pred:0.015764139592647552, decouple_loss:0.0010492197470739484
Iteration: 3384, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4515930414199829, gen p mean: -0.04222680628299713, mean p set: 0.452073335647583
loss_pred:0.015493595041334629, decouple_loss:0.0011676190188154578
The modified gen p mean: 0.45018839836120605, gen p mean: -0.04381581395864487, mean p set: 0.45066869258880615The modified gen p mean: 0.4508490264415741, gen p mean: -0.03886094316840172, mean p set: 0.4513293206691742
loss_pred:0.015638941898941994, decouple_loss:0.0012297095963731408
loss_pred:0.015025710687041283, decouple_loss:0.0010241585550829768
Iteration: 3385, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45168137550354004, gen p mean: -0.0386970080435276, mean p set: 0.4521616995334625
loss_pred:0.0158091951161623, decouple_loss:0.0010439361212775111
The modified gen p mean: 0.45099154114723206, gen p mean: -0.04218925163149834, mean p set: 0.45147183537483215
The modified gen p mean: 0.45102861523628235, gen p mean: -0.0443926602602005, mean p set: 0.45150890946388245
loss_pred:0.014903402887284756, decouple_loss:0.0010481057688593864
loss_pred:0.014509405009448528, decouple_loss:0.0010845845099538565
Iteration: 3386, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.451174259185791, gen p mean: -0.0430530309677124, mean p set: 0.4516545534133911
loss_pred:0.015615895390510559, decouple_loss:0.0010862034978345037
The modified gen p mean: 0.4505757689476013, gen p mean: -0.040950462222099304, mean p set: 0.4510560631752014The modified gen p mean: 0.4505322277545929, gen p mean: -0.04475995525717735, mean p set: 0.4510124921798706
loss_pred:0.015010111965239048, decouple_loss:0.0009199571795761585
loss_pred:0.01510631199926138, decouple_loss:0.0010119599755853415
Iteration: 3387, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514961838722229, gen p mean: -0.03954880312085152, mean p set: 0.451976478099823
loss_pred:0.015745313838124275, decouple_loss:0.0012129981769248843
The modified gen p mean: 0.45135343074798584, gen p mean: -0.04254622012376785, mean p set: 0.4518337547779083The modified gen p mean: 0.45051705837249756, gen p mean: -0.04333645477890968, mean p set: 0.45099735260009766
loss_pred:0.015315325930714607, decouple_loss:0.0011071739718317986
loss_pred:0.014692996628582478, decouple_loss:0.0010338007705286145
Iteration: 3388, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45152682065963745, gen p mean: -0.044648393988609314, mean p set: 0.45200711488723755
loss_pred:0.015628524124622345, decouple_loss:0.0010802018223330379
The modified gen p mean: 0.4505290687084198, gen p mean: -0.04843073710799217, mean p set: 0.4510093629360199The modified gen p mean: 0.4502286911010742, gen p mean: -0.03720409795641899, mean p set: 0.4507089853286743
loss_pred:0.014828749001026154, decouple_loss:0.0009678089991211891
loss_pred:0.014927775599062443, decouple_loss:0.001003007753752172
Iteration: 3389, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45107710361480713, gen p mean: -0.03489255532622337, mean p set: 0.4515573978424072
loss_pred:0.014721459709107876, decouple_loss:0.0011424970580264926
The modified gen p mean: 0.451937735080719, gen p mean: -0.0359547957777977, mean p set: 0.4524179995059967The modified gen p mean: 0.45010125637054443, gen p mean: -0.032522499561309814, mean p set: 0.45058155059814453
loss_pred:0.015476158820092678, decouple_loss:0.0011152493534609675
loss_pred:0.015122439712285995, decouple_loss:0.0011151734506711364
Iteration: 3390, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507963955402374, gen p mean: -0.036782532930374146, mean p set: 0.4512766897678375
loss_pred:0.015376443043351173, decouple_loss:0.001210512942634523
The modified gen p mean: 0.4501418471336365, gen p mean: -0.035090796649456024, mean p set: 0.4506221413612366The modified gen p mean: 0.45111170411109924, gen p mean: -0.04037429392337799, mean p set: 0.45159196853637695
loss_pred:0.015179971233010292, decouple_loss:0.0011633684625849128
loss_pred:0.015420653857290745, decouple_loss:0.0011066931765526533
2023-05-02 15:26:08 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.04860798642039299, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04470950365066528, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.044955480843782425, mean p set: 0.4500633478164673
loss_pred:0.018590444698929787, decouple_loss:0.0014953587669879198
loss_pred:0.01757308468222618, decouple_loss:0.0015866403700783849
loss_pred:0.017519133165478706, decouple_loss:0.0014378867344930768
WV_0_PC_1_EH_0_PS_40, loss: 0.017969554290175438, avg_mse: 0.025944361463189125
current test mse: 0.025944
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012004_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012004_3_24hr.npz
NaN value num: 0
Iteration: 3391, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45080551505088806, gen p mean: -0.03763898089528084, mean p set: 0.45128580927848816
loss_pred:0.0157069843262434, decouple_loss:0.0010332867968827486
The modified gen p mean: 0.44870060682296753, gen p mean: -0.03814040124416351, mean p set: 0.44918093085289The modified gen p mean: 0.4497767388820648, gen p mean: -0.03868788108229637, mean p set: 0.4502570331096649
loss_pred:0.016090350225567818, decouple_loss:0.0013979857321828604
loss_pred:0.01678243651986122, decouple_loss:0.0011005043052136898
Iteration: 3392, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45272067189216614, gen p mean: -0.03327631205320358, mean p set: 0.45320096611976624
loss_pred:0.016723282635211945, decouple_loss:0.0011183656752109528
The modified gen p mean: 0.44854339957237244, gen p mean: -0.037015870213508606, mean p set: 0.44902369379997253The modified gen p mean: 0.4512547254562378, gen p mean: -0.03577527031302452, mean p set: 0.4517350196838379
loss_pred:0.015716534107923508, decouple_loss:0.0011614346876740456
loss_pred:0.01605970598757267, decouple_loss:0.0011649260995909572
Iteration: 3393, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491153657436371, gen p mean: -0.034140460193157196, mean p set: 0.44959568977355957
loss_pred:0.016209034249186516, decouple_loss:0.0009488881332799792
The modified gen p mean: 0.45052701234817505, gen p mean: -0.04140835255384445, mean p set: 0.45100730657577515The modified gen p mean: 0.4504566192626953, gen p mean: -0.03190035745501518, mean p set: 0.4509369134902954
loss_pred:0.016474725678563118, decouple_loss:0.0009949736995622516
loss_pred:0.01628701575100422, decouple_loss:0.0010249628685414791
Iteration: 3394, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45051437616348267, gen p mean: -0.0423804335296154, mean p set: 0.45099470019340515
loss_pred:0.016362646594643593, decouple_loss:0.0010211777407675982
The modified gen p mean: 0.45134761929512024, gen p mean: -0.03573485091328621, mean p set: 0.45182791352272034The modified gen p mean: 0.4514922797679901, gen p mean: -0.033558569848537445, mean p set: 0.4519725739955902
loss_pred:0.016101794317364693, decouple_loss:0.0010220445692539215
loss_pred:0.0162117350846529, decouple_loss:0.0010678123217076063
Iteration: 3395, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45059874653816223, gen p mean: -0.041228242218494415, mean p set: 0.45107904076576233
loss_pred:0.015983272343873978, decouple_loss:0.0010837799636647105
The modified gen p mean: 0.4516095221042633, gen p mean: -0.043978363275527954, mean p set: 0.452089786529541The modified gen p mean: 0.45129379630088806, gen p mean: -0.04016388952732086, mean p set: 0.45177412033081055
loss_pred:0.01509876362979412, decouple_loss:0.001121623208746314
loss_pred:0.015307544730603695, decouple_loss:0.0011995446402579546
Iteration: 3396, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45142248272895813, gen p mean: -0.046163883060216904, mean p set: 0.4519027769565582
loss_pred:0.015670454129576683, decouple_loss:0.0009975709253922105
The modified gen p mean: 0.4512452185153961, gen p mean: -0.04312552511692047, mean p set: 0.4517255127429962The modified gen p mean: 0.45158591866493225, gen p mean: -0.045318130403757095, mean p set: 0.45206621289253235
loss_pred:0.015733517706394196, decouple_loss:0.001011646119877696
loss_pred:0.015786349773406982, decouple_loss:0.001000761752948165
Iteration: 3397, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45371267199516296, gen p mean: -0.04386551305651665, mean p set: 0.4541929364204407
loss_pred:0.016476916149258614, decouple_loss:0.0011565544409677386
The modified gen p mean: 0.4527045786380768, gen p mean: -0.04386894032359123, mean p set: 0.45318490266799927
The modified gen p mean: 0.44960206747055054, gen p mean: -0.047535914927721024, mean p set: 0.450082391500473
loss_pred:0.01644126884639263, decouple_loss:0.0011455850908532739
loss_pred:0.015748405829072, decouple_loss:0.0010280448477715254
Iteration: 3398, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4518240690231323, gen p mean: -0.04382568970322609, mean p set: 0.4523043632507324
loss_pred:0.015259021893143654, decouple_loss:0.0012610482517629862
The modified gen p mean: 0.45225515961647034, gen p mean: -0.04392846301198006, mean p set: 0.45273545384407043The modified gen p mean: 0.44855543971061707, gen p mean: -0.048391543328762054, mean p set: 0.4490357041358948
loss_pred:0.01620541512966156, decouple_loss:0.0011762892827391624
loss_pred:0.01557241939008236, decouple_loss:0.0010368889197707176
Iteration: 3399, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4526613652706146, gen p mean: -0.04755280166864395, mean p set: 0.45314162969589233
loss_pred:0.016184061765670776, decouple_loss:0.0010964757530018687
The modified gen p mean: 0.45076581835746765, gen p mean: -0.046788763254880905, mean p set: 0.45124614238739014The modified gen p mean: 0.4491099715232849, gen p mean: -0.04527678340673447, mean p set: 0.4495902955532074
loss_pred:0.016032123938202858, decouple_loss:0.0012314802734181285
loss_pred:0.015668772161006927, decouple_loss:0.0010128141148015857
Iteration: 3400, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44923752546310425, gen p mean: -0.04661540687084198, mean p set: 0.44971778988838196
loss_pred:0.016050642356276512, decouple_loss:0.001072040991857648
The modified gen p mean: 0.45084866881370544, gen p mean: -0.05205091834068298, mean p set: 0.45132896304130554The modified gen p mean: 0.4512578845024109, gen p mean: -0.0511215515434742, mean p set: 0.451738178730011
loss_pred:0.016362454742193222, decouple_loss:0.0011159948771819472
loss_pred:0.016008922830224037, decouple_loss:0.0010109522845596075
2023-05-02 15:28:40 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.06249630078673363, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.057990849018096924, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.05851423367857933, mean p set: 0.4500633478164673
loss_pred:0.018307112157344818, decouple_loss:0.0012329607270658016
loss_pred:0.017325885593891144, decouple_loss:0.001365350908599794
loss_pred:0.017318110913038254, decouple_loss:0.0012171185808256269
WV_0_PC_1_EH_0_PS_40, loss: 0.017713960260152817, avg_mse: 0.025480931624770164
current test mse: 0.025481
Iteration: 3401, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496833384037018, gen p mean: -0.05472585931420326, mean p set: 0.4501636028289795
The modified gen p mean: 0.4520755112171173, gen p mean: -0.04970240592956543, mean p set: 0.4525558054447174
The modified gen p mean: 0.45004647970199585, gen p mean: -0.055574931204319, mean p set: 0.45052674412727356
loss_pred:0.015490975230932236, decouple_loss:0.0012132949195802212
loss_pred:0.015886960551142693, decouple_loss:0.0013285103486850858loss_pred:0.015788281336426735, decouple_loss:0.0013389675877988338
Iteration: 3402, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45077332854270935, gen p mean: -0.05303279682993889, mean p set: 0.45125362277030945
loss_pred:0.015690669417381287, decouple_loss:0.001211299211718142
The modified gen p mean: 0.4532161355018616, gen p mean: -0.049391768872737885, mean p set: 0.4536963999271393The modified gen p mean: 0.4488845467567444, gen p mean: -0.05450260639190674, mean p set: 0.4493648409843445
loss_pred:0.015761064365506172, decouple_loss:0.0011680384632200003
loss_pred:0.016087736934423447, decouple_loss:0.001134023885242641
Iteration: 3403, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489477574825287, gen p mean: -0.05378708615899086, mean p set: 0.4494280517101288
loss_pred:0.015311327762901783, decouple_loss:0.0010846840450540185
The modified gen p mean: 0.4509755074977875, gen p mean: -0.053684040904045105, mean p set: 0.4514558017253876The modified gen p mean: 0.45043185353279114, gen p mean: -0.055235862731933594, mean p set: 0.45091211795806885
loss_pred:0.016354206949472427, decouple_loss:0.0011183423921465874
loss_pred:0.016206013038754463, decouple_loss:0.0010541054653003812
Iteration: 3404, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493904411792755, gen p mean: -0.05395304784178734, mean p set: 0.4498707354068756
loss_pred:0.015745624899864197, decouple_loss:0.0012613697908818722
The modified gen p mean: 0.4515613913536072, gen p mean: -0.051858190447092056, mean p set: 0.4520416855812073The modified gen p mean: 0.45316281914711, gen p mean: -0.0510069839656353, mean p set: 0.4536430835723877
loss_pred:0.015540202148258686, decouple_loss:0.0012241887161508203
loss_pred:0.016120925545692444, decouple_loss:0.001215229625813663
Iteration: 3405, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449407160282135, gen p mean: -0.04701192304491997, mean p set: 0.4498874545097351
loss_pred:0.015379942022264004, decouple_loss:0.0011217774590477347
The modified gen p mean: 0.45130518078804016, gen p mean: -0.05240672454237938, mean p set: 0.45178547501564026The modified gen p mean: 0.4515460133552551, gen p mean: -0.051648326218128204, mean p set: 0.4520263373851776
loss_pred:0.015454395674169064, decouple_loss:0.0011575405951589346
loss_pred:0.015430302359163761, decouple_loss:0.0011361283250153065
Iteration: 3406, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514947235584259, gen p mean: -0.0461815670132637, mean p set: 0.451975017786026
loss_pred:0.015368581749498844, decouple_loss:0.0010014057625085115
The modified gen p mean: 0.45236364006996155, gen p mean: -0.0515284463763237, mean p set: 0.45284390449523926The modified gen p mean: 0.44925418496131897, gen p mean: -0.046369656920433044, mean p set: 0.4497344493865967
loss_pred:0.015567906200885773, decouple_loss:0.001050631864927709
loss_pred:0.01620572619140148, decouple_loss:0.0010780368465930223
Iteration: 3407, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505396783351898, gen p mean: -0.04930972307920456, mean p set: 0.4510199725627899
loss_pred:0.016085626557469368, decouple_loss:0.0010317303240299225
The modified gen p mean: 0.4497973322868347, gen p mean: -0.051497045904397964, mean p set: 0.4502776563167572The modified gen p mean: 0.4521658420562744, gen p mean: -0.046669650822877884, mean p set: 0.4526461362838745
loss_pred:0.015237722545862198, decouple_loss:0.0011416275519877672
loss_pred:0.015395465306937695, decouple_loss:0.0011724536307156086
Iteration: 3408, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45213818550109863, gen p mean: -0.04443761333823204, mean p set: 0.45261847972869873
loss_pred:0.01599014736711979, decouple_loss:0.001074468600563705
The modified gen p mean: 0.45173242688179016, gen p mean: -0.04726281762123108, mean p set: 0.45221275091171265The modified gen p mean: 0.44974735379219055, gen p mean: -0.04859801009297371, mean p set: 0.45022767782211304
loss_pred:0.015782220289111137, decouple_loss:0.0010925228707492352
loss_pred:0.01603410206735134, decouple_loss:0.001182643580250442
Iteration: 3409, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499387741088867, gen p mean: -0.048141803592443466, mean p set: 0.4504190683364868
loss_pred:0.01618688926100731, decouple_loss:0.0011279089376330376
The modified gen p mean: 0.4508567452430725, gen p mean: -0.04144628345966339, mean p set: 0.45133697986602783The modified gen p mean: 0.4513400197029114, gen p mean: -0.04533591866493225, mean p set: 0.4518203139305115
loss_pred:0.01589779183268547, decouple_loss:0.0011131371138617396
loss_pred:0.015932239592075348, decouple_loss:0.001145621994510293
Iteration: 3410, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496880769729614, gen p mean: -0.03894935920834541, mean p set: 0.4501683712005615
loss_pred:0.016217567026615143, decouple_loss:0.0011059875832870603
The modified gen p mean: 0.45221543312072754, gen p mean: -0.0434633307158947, mean p set: 0.45269572734832764The modified gen p mean: 0.45051953196525574, gen p mean: -0.0429152213037014, mean p set: 0.45099982619285583
loss_pred:0.01506304182112217, decouple_loss:0.0013832823606207967
loss_pred:0.015898633748292923, decouple_loss:0.001171905780211091
2023-05-02 15:30:36 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.0546027272939682, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.05027921497821808, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.050748955458402634, mean p set: 0.4500633478164673
loss_pred:0.01830185018479824, decouple_loss:0.0013906188542023301
loss_pred:0.01731085777282715, decouple_loss:0.0012367519084364176
loss_pred:0.017337676137685776, decouple_loss:0.0012446801410987973
WV_0_PC_1_EH_0_PS_40, loss: 0.017714664340019226, avg_mse: 0.02547336556017399
current test mse: 0.025473
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012000_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012000_3_24hr.npz
NaN value num: 0
Iteration: 3411, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446994811296463, gen p mean: -0.05234488472342491, mean p set: 0.4474751055240631
loss_pred:0.015319361351430416, decouple_loss:0.001270474516786635
The modified gen p mean: 0.4459533095359802, gen p mean: -0.051019515842199326, mean p set: 0.4464336037635803The modified gen p mean: 0.44772693514823914, gen p mean: -0.05117158964276314, mean p set: 0.44820722937583923
loss_pred:0.015383733436465263, decouple_loss:0.001272991532459855loss_pred:0.016153909265995026, decouple_loss:0.001208396744914353
Iteration: 3412, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473946690559387, gen p mean: -0.0509100966155529, mean p set: 0.4478749632835388
The modified gen p mean: 0.4461573362350464, gen p mean: -0.05111289024353027, mean p set: 0.44663766026496887
loss_pred:0.015417701564729214, decouple_loss:0.0011239019222557545
loss_pred:0.015351626090705395, decouple_loss:0.0011557022808119655
The modified gen p mean: 0.4472832977771759, gen p mean: -0.04894786700606346, mean p set: 0.4477635622024536
loss_pred:0.015524362213909626, decouple_loss:0.001046579098328948
Iteration: 3413, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4463563859462738, gen p mean: -0.05114845186471939, mean p set: 0.4468367099761963
The modified gen p mean: 0.4473946988582611, gen p mean: -0.05412643775343895, mean p set: 0.4478749930858612
loss_pred:0.01547181699424982, decouple_loss:0.0013453075662255287
loss_pred:0.015683136880397797, decouple_loss:0.0013027131790295243
The modified gen p mean: 0.4474044740200043, gen p mean: -0.05510934814810753, mean p set: 0.44788476824760437
loss_pred:0.014710036106407642, decouple_loss:0.0012484516482800245
Iteration: 3414, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44694966077804565, gen p mean: -0.04754721373319626, mean p set: 0.44742998480796814
The modified gen p mean: 0.44905388355255127, gen p mean: -0.055531032383441925, mean p set: 0.44953420758247375loss_pred:0.016537483781576157, decouple_loss:0.0012858558911830187
The modified gen p mean: 0.44729548692703247, gen p mean: -0.05084274336695671, mean p set: 0.44777578115463257
loss_pred:0.015552084892988205, decouple_loss:0.0013999154325574636
loss_pred:0.015481018461287022, decouple_loss:0.0011936509981751442
Iteration: 3415, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484092891216278, gen p mean: -0.054898619651794434, mean p set: 0.4488895833492279
The modified gen p mean: 0.44681090116500854, gen p mean: -0.056699324399232864, mean p set: 0.44729119539260864loss_pred:0.015535643324255943, decouple_loss:0.0013811998069286346
The modified gen p mean: 0.446159690618515, gen p mean: -0.05405259132385254, mean p set: 0.4466399550437927
loss_pred:0.015185038559138775, decouple_loss:0.0013232948258519173
loss_pred:0.015392595902085304, decouple_loss:0.0011001181555911899
Iteration: 3416, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494279623031616, gen p mean: -0.06040554121136665, mean p set: 0.44990822672843933
loss_pred:0.015505928546190262, decouple_loss:0.0011866475688293576
The modified gen p mean: 0.4472602307796478, gen p mean: -0.05758686736226082, mean p set: 0.4477405250072479The modified gen p mean: 0.4480491578578949, gen p mean: -0.04886380583047867, mean p set: 0.4485294818878174
loss_pred:0.015247751958668232, decouple_loss:0.0012329380260780454
loss_pred:0.01605873741209507, decouple_loss:0.0011575615499168634
Iteration: 3417, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44714874029159546, gen p mean: -0.048797525465488434, mean p set: 0.44762900471687317
loss_pred:0.015231690369546413, decouple_loss:0.0011347485706210136
The modified gen p mean: 0.446189284324646, gen p mean: -0.05558283254504204, mean p set: 0.4466695487499237The modified gen p mean: 0.44735077023506165, gen p mean: -0.04882543161511421, mean p set: 0.44783106446266174
loss_pred:0.015491494908928871, decouple_loss:0.001209992216899991
loss_pred:0.015354348346590996, decouple_loss:0.0011129648191854358
Iteration: 3418, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44786345958709717, gen p mean: -0.05088096857070923, mean p set: 0.44834375381469727
The modified gen p mean: 0.44653427600860596, gen p mean: -0.051060035824775696, mean p set: 0.44701457023620605
loss_pred:0.016245437785983086, decouple_loss:0.0011361879296600819
loss_pred:0.015456735156476498, decouple_loss:0.0012523966142907739
The modified gen p mean: 0.4463949501514435, gen p mean: -0.05306238308548927, mean p set: 0.4468752145767212
loss_pred:0.014890515245497227, decouple_loss:0.0011314763687551022
Iteration: 3419, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470890164375305, gen p mean: -0.055173974484205246, mean p set: 0.447569340467453
loss_pred:0.01543494127690792, decouple_loss:0.0012392804492264986
The modified gen p mean: 0.4478931128978729, gen p mean: -0.05231459066271782, mean p set: 0.448373407125473The modified gen p mean: 0.44739392399787903, gen p mean: -0.05288610979914665, mean p set: 0.4478742182254791
loss_pred:0.015436188317835331, decouple_loss:0.0013067345134913921
loss_pred:0.015760691836476326, decouple_loss:0.0011797816259786487
Iteration: 3420, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469406008720398, gen p mean: -0.05399281904101372, mean p set: 0.4474208950996399
loss_pred:0.014881704933941364, decouple_loss:0.0010827290825545788
The modified gen p mean: 0.44558024406433105, gen p mean: -0.05007851868867874, mean p set: 0.44606053829193115The modified gen p mean: 0.44717586040496826, gen p mean: -0.04798302426934242, mean p set: 0.44765612483024597
loss_pred:0.015200696885585785, decouple_loss:0.0012548798695206642
loss_pred:0.015029345639050007, decouple_loss:0.0011942601995542645
2023-05-02 15:33:10 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.050106991082429886, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04613159969449043, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.04647836461663246, mean p set: 0.4500633478164673
loss_pred:0.018452441319823265, decouple_loss:0.001112434547394514
loss_pred:0.017373092472553253, decouple_loss:0.001099739340133965
loss_pred:0.017398135736584663, decouple_loss:0.001135996193625033
WV_0_PC_1_EH_0_PS_40, loss: 0.01779702678322792, avg_mse: 0.02565094083547592
current test mse: 0.025651
Iteration: 3421, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44731464982032776, gen p mean: -0.04655642434954643, mean p set: 0.44779494404792786
The modified gen p mean: 0.44760647416114807, gen p mean: -0.04680696874856949, mean p set: 0.44808676838874817
The modified gen p mean: 0.4476717710494995, gen p mean: -0.04891020432114601, mean p set: 0.448152095079422
loss_pred:0.015316293574869633, decouple_loss:0.001160357380285859
loss_pred:0.015770254656672478, decouple_loss:0.0011412305757403374
loss_pred:0.015103471465408802, decouple_loss:0.0010610210010781884
Iteration: 3422, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476805627346039, gen p mean: -0.0479152649641037, mean p set: 0.448160856962204
The modified gen p mean: 0.44714096188545227, gen p mean: -0.04846877232193947, mean p set: 0.44762122631073
loss_pred:0.015531692653894424, decouple_loss:0.001195215038023889
loss_pred:0.015111647546291351, decouple_loss:0.0012523045297712088
The modified gen p mean: 0.4464568793773651, gen p mean: -0.045586492866277695, mean p set: 0.4469371736049652
loss_pred:0.015290734358131886, decouple_loss:0.0012072513345628977
Iteration: 3423, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475497901439667, gen p mean: -0.045446258038282394, mean p set: 0.44803011417388916
loss_pred:0.016439201310276985, decouple_loss:0.0011786838294938207
The modified gen p mean: 0.4456823468208313, gen p mean: -0.0488283671438694, mean p set: 0.4461626410484314The modified gen p mean: 0.44698771834373474, gen p mean: -0.04821905493736267, mean p set: 0.44746798276901245
loss_pred:0.015419766306877136, decouple_loss:0.0011850034352391958
loss_pred:0.014749331399798393, decouple_loss:0.001150857424363494
Iteration: 3424, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44732069969177246, gen p mean: -0.047060899436473846, mean p set: 0.44780099391937256
loss_pred:0.014984779991209507, decouple_loss:0.000995206879451871
The modified gen p mean: 0.4471362829208374, gen p mean: -0.05154479295015335, mean p set: 0.4476166069507599The modified gen p mean: 0.4469488859176636, gen p mean: -0.05013661086559296, mean p set: 0.44742920994758606
loss_pred:0.015056906268000603, decouple_loss:0.0010433649877086282
loss_pred:0.015275928191840649, decouple_loss:0.0011483514681458473
Iteration: 3425, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44723770022392273, gen p mean: -0.04382581263780594, mean p set: 0.4477180242538452
loss_pred:0.016210712492465973, decouple_loss:0.0010814840206876397
The modified gen p mean: 0.44758978486061096, gen p mean: -0.04300299286842346, mean p set: 0.44807007908821106The modified gen p mean: 0.44848689436912537, gen p mean: -0.052380383014678955, mean p set: 0.44896718859672546
loss_pred:0.015608534216880798, decouple_loss:0.0011236460413783789
loss_pred:0.015416433103382587, decouple_loss:0.0010257031535729766
Iteration: 3426, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477144181728363, gen p mean: -0.04671941697597504, mean p set: 0.4481947124004364
loss_pred:0.016305066645145416, decouple_loss:0.0010567501885816455
The modified gen p mean: 0.4484701454639435, gen p mean: -0.04440007731318474, mean p set: 0.4489504396915436The modified gen p mean: 0.4474177360534668, gen p mean: -0.04981769248843193, mean p set: 0.4478980302810669
loss_pred:0.015873750671744347, decouple_loss:0.00104013632517308
loss_pred:0.015349035151302814, decouple_loss:0.0010790452361106873
Iteration: 3427, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470345973968506, gen p mean: -0.05253492295742035, mean p set: 0.4475148916244507
loss_pred:0.015122810378670692, decouple_loss:0.0011309005785733461
The modified gen p mean: 0.4477233290672302, gen p mean: -0.053809672594070435, mean p set: 0.44820359349250793The modified gen p mean: 0.44661176204681396, gen p mean: -0.05306575074791908, mean p set: 0.44709208607673645
loss_pred:0.015288750641047955, decouple_loss:0.0010951496660709381
loss_pred:0.015162283554673195, decouple_loss:0.0012107676593586802
Iteration: 3428, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465195834636688, gen p mean: -0.052265625447034836, mean p set: 0.44699984788894653
loss_pred:0.015341155230998993, decouple_loss:0.0011019693920388818
The modified gen p mean: 0.44675564765930176, gen p mean: -0.051778532564640045, mean p set: 0.44723597168922424The modified gen p mean: 0.447578489780426, gen p mean: -0.04892690107226372, mean p set: 0.44805875420570374
loss_pred:0.015444325283169746, decouple_loss:0.0011291040573269129
loss_pred:0.015191611833870411, decouple_loss:0.0011983760632574558
Iteration: 3429, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44671186804771423, gen p mean: -0.054467733949422836, mean p set: 0.44719216227531433
loss_pred:0.014732502400875092, decouple_loss:0.0010545989498496056
The modified gen p mean: 0.44622308015823364, gen p mean: -0.05602993071079254, mean p set: 0.44670340418815613The modified gen p mean: 0.4472357928752899, gen p mean: -0.05283796042203903, mean p set: 0.4477160573005676
loss_pred:0.015282186679542065, decouple_loss:0.0011278114980086684
loss_pred:0.01500670239329338, decouple_loss:0.0010713079245761037
Iteration: 3430, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44721198081970215, gen p mean: -0.054136570543050766, mean p set: 0.44769227504730225
loss_pred:0.015069667249917984, decouple_loss:0.0010379826417192817
The modified gen p mean: 0.4470658302307129, gen p mean: -0.04693308472633362, mean p set: 0.447546124458313The modified gen p mean: 0.4475298523902893, gen p mean: -0.04749395325779915, mean p set: 0.4480101466178894
loss_pred:0.01607787422835827, decouple_loss:0.0011135186068713665
loss_pred:0.015220687724649906, decouple_loss:0.0009973760461434722
2023-05-02 15:35:05 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.05477023869752884, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.05038996413350105, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.05100091174244881, mean p set: 0.4500633478164673
loss_pred:0.018340429291129112, decouple_loss:0.0011795167811214924
loss_pred:0.017260972410440445, decouple_loss:0.0011421634117141366
loss_pred:0.017347099259495735, decouple_loss:0.001129244570620358
WV_0_PC_1_EH_0_PS_40, loss: 0.017707016319036484, avg_mse: 0.025486992672085762
current test mse: 0.025487
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012019_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012019_3_24hr.npz
NaN value num: 0
Iteration: 3431, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491133987903595, gen p mean: -0.05367767810821533, mean p set: 0.4495936930179596
loss_pred:0.014332343824207783, decouple_loss:0.0011538203107193112
The modified gen p mean: 0.4473295509815216, gen p mean: -0.05240641534328461, mean p set: 0.4478098452091217The modified gen p mean: 0.4484594762325287, gen p mean: -0.051877740770578384, mean p set: 0.4489397704601288
loss_pred:0.015236923471093178, decouple_loss:0.0011530956253409386
loss_pred:0.014454401098191738, decouple_loss:0.00109872967004776
Iteration: 3432, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489932358264923, gen p mean: -0.05371910333633423, mean p set: 0.4494735598564148
The modified gen p mean: 0.449386328458786, gen p mean: -0.05584637075662613, mean p set: 0.4498666524887085loss_pred:0.01448039524257183, decouple_loss:0.0010283016599714756
The modified gen p mean: 0.44886156916618347, gen p mean: -0.05096879601478577, mean p set: 0.44934189319610596
loss_pred:0.014319444075226784, decouple_loss:0.0010539093054831028
loss_pred:0.014863242395222187, decouple_loss:0.0010767686180770397
Iteration: 3433, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44894957542419434, gen p mean: -0.056211866438388824, mean p set: 0.44942986965179443
loss_pred:0.014625628478825092, decouple_loss:0.001067246892489493
The modified gen p mean: 0.44856327772140503, gen p mean: -0.055867042392492294, mean p set: 0.4490435719490051The modified gen p mean: 0.4491564631462097, gen p mean: -0.05523223429918289, mean p set: 0.4496367573738098
loss_pred:0.014124059118330479, decouple_loss:0.0010853963904082775
loss_pred:0.014013824053108692, decouple_loss:0.0011818301863968372
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 3434, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489580988883972, gen p mean: -0.047927677631378174, mean p set: 0.4494384229183197
loss_pred:0.013888937421143055, decouple_loss:0.0013651847839355469
The modified gen p mean: 0.4494735598564148, gen p mean: -0.048856478184461594, mean p set: 0.4499538242816925The modified gen p mean: 0.4483930766582489, gen p mean: -0.0557667538523674, mean p set: 0.4488733410835266
loss_pred:0.014075081795454025, decouple_loss:0.00129669567104429
loss_pred:0.014476779848337173, decouple_loss:0.0013085489626973867
Iteration: 3435, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493986666202545, gen p mean: -0.05384048819541931, mean p set: 0.4498789310455322
loss_pred:0.013942963443696499, decouple_loss:0.0012503372272476554
The modified gen p mean: 0.448279470205307, gen p mean: -0.04945972561836243, mean p set: 0.4487597644329071The modified gen p mean: 0.4489569664001465, gen p mean: -0.05243383347988129, mean p set: 0.4494372606277466
loss_pred:0.014174272306263447, decouple_loss:0.0012615087907761335
loss_pred:0.013869580812752247, decouple_loss:0.001211725641041994
Iteration: 3436, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494485557079315, gen p mean: -0.05224721133708954, mean p set: 0.449928879737854
loss_pred:0.013928280211985111, decouple_loss:0.0013471705606207252
The modified gen p mean: 0.4486227035522461, gen p mean: -0.05141700059175491, mean p set: 0.4491029977798462The modified gen p mean: 0.4492949843406677, gen p mean: -0.047822270542383194, mean p set: 0.4497752785682678
loss_pred:0.013578573241829872, decouple_loss:0.0013201881665736437
loss_pred:0.013865560293197632, decouple_loss:0.0015311975730583072
Iteration: 3437, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490394592285156, gen p mean: -0.04666607826948166, mean p set: 0.44951972365379333
loss_pred:0.013929408974945545, decouple_loss:0.0012590473052114248
The modified gen p mean: 0.44788870215415955, gen p mean: -0.04535295441746712, mean p set: 0.44836896657943726The modified gen p mean: 0.4495258927345276, gen p mean: -0.052232854068279266, mean p set: 0.4500062167644501
loss_pred:0.014112422242760658, decouple_loss:0.001254239701665938
loss_pred:0.014245816506445408, decouple_loss:0.0012211434077471495
Iteration: 3438, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479733109474182, gen p mean: -0.04276035726070404, mean p set: 0.4484536051750183
loss_pred:0.01451069861650467, decouple_loss:0.0012450336944311857
The modified gen p mean: 0.4487845003604889, gen p mean: -0.046132802963256836, mean p set: 0.4492647647857666The modified gen p mean: 0.4494182765483856, gen p mean: -0.049237027764320374, mean p set: 0.4498986005783081
loss_pred:0.013486646115779877, decouple_loss:0.0012095890706405044
loss_pred:0.013686482794582844, decouple_loss:0.0012874143430963159
Iteration: 3439, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489731192588806, gen p mean: -0.045650415122509, mean p set: 0.4494534134864807
loss_pred:0.013460841029882431, decouple_loss:0.0013076827162876725
The modified gen p mean: 0.44809702038764954, gen p mean: -0.050306424498558044, mean p set: 0.448577344417572The modified gen p mean: 0.4485247731208801, gen p mean: -0.04269363358616829, mean p set: 0.4490050673484802
loss_pred:0.013528374955058098, decouple_loss:0.0013745402684435248
loss_pred:0.014200800098478794, decouple_loss:0.0012615183368325233
Iteration: 3440, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44813087582588196, gen p mean: -0.047332148998975754, mean p set: 0.44861117005348206
loss_pred:0.013842989690601826, decouple_loss:0.0012480037985369563
The modified gen p mean: 0.44853857159614563, gen p mean: -0.04300270229578018, mean p set: 0.44901883602142334The modified gen p mean: 0.4483850598335266, gen p mean: -0.049293097108602524, mean p set: 0.4488653242588043
loss_pred:0.013394244946539402, decouple_loss:0.001292821834795177
loss_pred:0.01359852496534586, decouple_loss:0.001209939713589847
2023-05-02 15:37:42 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.049904145300388336, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.045260507613420486, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.04559444636106491, mean p set: 0.4500633478164673
loss_pred:0.019155120477080345, decouple_loss:0.0012879851274192333
loss_pred:0.017991866916418076, decouple_loss:0.0013281094143167138
loss_pred:0.017993483692407608, decouple_loss:0.0013126115081831813
WV_0_PC_1_EH_0_PS_40, loss: 0.018445637077093124, avg_mse: 0.026904957368969917
current test mse: 0.026905
Iteration: 3441, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478198289871216, gen p mean: -0.04788034036755562, mean p set: 0.4483001232147217
The modified gen p mean: 0.44782623648643494, gen p mean: -0.03940926492214203, mean p set: 0.44830653071403503
The modified gen p mean: 0.4486974775791168, gen p mean: -0.0468507818877697, mean p set: 0.44917774200439453
loss_pred:0.014124691486358643, decouple_loss:0.0011980426497757435
loss_pred:0.013963817618787289, decouple_loss:0.0012145728105679154
loss_pred:0.013888186775147915, decouple_loss:0.0012135121505707502
Iteration: 3442, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44813117384910583, gen p mean: -0.04645875468850136, mean p set: 0.4486114978790283
loss_pred:0.014002435840666294, decouple_loss:0.001413534744642675
The modified gen p mean: 0.4489286243915558, gen p mean: -0.05203452333807945, mean p set: 0.4494089186191559The modified gen p mean: 0.44903847575187683, gen p mean: -0.04776152968406677, mean p set: 0.44951876997947693
loss_pred:0.013732698746025562, decouple_loss:0.001271425629965961
loss_pred:0.013801143504679203, decouple_loss:0.0012028270866721869
Iteration: 3443, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475438594818115, gen p mean: -0.05510884150862694, mean p set: 0.4480241537094116
The modified gen p mean: 0.44908517599105835, gen p mean: -0.05171374976634979, mean p set: 0.44956550002098083
loss_pred:0.013830921612679958, decouple_loss:0.001284393365494907
loss_pred:0.013846606947481632, decouple_loss:0.0011672239052131772
The modified gen p mean: 0.4480119049549103, gen p mean: -0.045626211911439896, mean p set: 0.448492169380188
loss_pred:0.013991349376738071, decouple_loss:0.0011515860678628087
Iteration: 3444, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44877132773399353, gen p mean: -0.052464015781879425, mean p set: 0.44925159215927124
The modified gen p mean: 0.4481603503227234, gen p mean: -0.0452776663005352, mean p set: 0.4486406445503235
loss_pred:0.013331020250916481, decouple_loss:0.0011933213099837303
loss_pred:0.014167477376759052, decouple_loss:0.0013219470856711268
The modified gen p mean: 0.4477930963039398, gen p mean: -0.051625899970531464, mean p set: 0.4482733905315399
loss_pred:0.013820507563650608, decouple_loss:0.0012514276895672083
Iteration: 3445, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486387372016907, gen p mean: -0.05024763569235802, mean p set: 0.44911903142929077
loss_pred:0.013585072010755539, decouple_loss:0.0010744710452854633
The modified gen p mean: 0.44819584488868713, gen p mean: -0.05420907214283943, mean p set: 0.4486761689186096The modified gen p mean: 0.4481983482837677, gen p mean: -0.0493696928024292, mean p set: 0.4486786425113678
loss_pred:0.01352497935295105, decouple_loss:0.0011330372653901577
loss_pred:0.014483129605650902, decouple_loss:0.0011673191329464316
Iteration: 3446, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44797807931900024, gen p mean: -0.05155939981341362, mean p set: 0.44845834374427795
loss_pred:0.01353475172072649, decouple_loss:0.001067769480869174
The modified gen p mean: 0.4495750963687897, gen p mean: -0.05268928036093712, mean p set: 0.45005539059638977The modified gen p mean: 0.44868671894073486, gen p mean: -0.04569481313228607, mean p set: 0.4491669833660126
loss_pred:0.013437407091259956, decouple_loss:0.0011459762463346124
loss_pred:0.013569056056439877, decouple_loss:0.001139097730629146
Iteration: 3447, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44899260997772217, gen p mean: -0.04720974341034889, mean p set: 0.44947290420532227
The modified gen p mean: 0.44924524426460266, gen p mean: -0.04732636362314224, mean p set: 0.44972550868988037
loss_pred:0.013263543136417866, decouple_loss:0.001335642416961491
loss_pred:0.013716473244130611, decouple_loss:0.0011532653588801622
The modified gen p mean: 0.4479416310787201, gen p mean: -0.045648496598005295, mean p set: 0.4484219551086426
loss_pred:0.013579818420112133, decouple_loss:0.0011436014901846647
Iteration: 3448, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490557909011841, gen p mean: -0.05069901421666145, mean p set: 0.4495360851287842
The modified gen p mean: 0.4491598606109619, gen p mean: -0.047791626304388046, mean p set: 0.4496401250362396
loss_pred:0.013878466561436653, decouple_loss:0.0011985455639660358
loss_pred:0.013626543805003166, decouple_loss:0.0011272379197180271
The modified gen p mean: 0.4484134614467621, gen p mean: -0.04874427989125252, mean p set: 0.4488937258720398
loss_pred:0.014198032207787037, decouple_loss:0.001264456077478826
Iteration: 3449, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488867223262787, gen p mean: -0.04830556735396385, mean p set: 0.4493670165538788
The modified gen p mean: 0.4494834542274475, gen p mean: -0.05015011876821518, mean p set: 0.4499637186527252
loss_pred:0.01323743350803852, decouple_loss:0.0010967833222821355
loss_pred:0.013767793774604797, decouple_loss:0.0012442884035408497
The modified gen p mean: 0.4493795335292816, gen p mean: -0.051378700882196426, mean p set: 0.4498598277568817
loss_pred:0.013387095183134079, decouple_loss:0.0013517235638573766
Iteration: 3450, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491555094718933, gen p mean: -0.053262051194906235, mean p set: 0.4496358335018158
loss_pred:0.013453512452542782, decouple_loss:0.0011666022473946214
The modified gen p mean: 0.44751986861228943, gen p mean: -0.0546087883412838, mean p set: 0.4480001628398895
The modified gen p mean: 0.4488207697868347, gen p mean: -0.05610549449920654, mean p set: 0.4493010640144348
loss_pred:0.014198854565620422, decouple_loss:0.0012453253148123622
loss_pred:0.01373028289526701, decouple_loss:0.001287641003727913
2023-05-02 15:39:37 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.0578799732029438, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.05387233570218086, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.053941186517477036, mean p set: 0.4500633478164673
loss_pred:0.018996695056557655, decouple_loss:0.001196009456180036
loss_pred:0.017837295308709145, decouple_loss:0.0011414267355576158
loss_pred:0.017901308834552765, decouple_loss:0.0011520994594320655
WV_0_PC_1_EH_0_PS_40, loss: 0.01830326020717621, avg_mse: 0.026670539751648903
current test mse: 0.026671
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012012_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012012_3_24hr.npz
NaN value num: 0
Iteration: 3451, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44653886556625366, gen p mean: -0.05539608746767044, mean p set: 0.44701918959617615
loss_pred:0.013899759389460087, decouple_loss:0.0011080391705036163
The modified gen p mean: 0.44802191853523254, gen p mean: -0.06038925424218178, mean p set: 0.44850221276283264The modified gen p mean: 0.44785261154174805, gen p mean: -0.05825505033135414, mean p set: 0.44833290576934814
loss_pred:0.013480277732014656, decouple_loss:0.0011643491452559829
loss_pred:0.01390963327139616, decouple_loss:0.00113539001904428
Iteration: 3452, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465855062007904, gen p mean: -0.057729218155145645, mean p set: 0.4470658302307129
The modified gen p mean: 0.4470537006855011, gen p mean: -0.05809272825717926, mean p set: 0.4475339949131012
loss_pred:0.014643502421677113, decouple_loss:0.001141048502177
loss_pred:0.013747974298894405, decouple_loss:0.001136950682848692
The modified gen p mean: 0.44733890891075134, gen p mean: -0.058239880949258804, mean p set: 0.44781920313835144
loss_pred:0.014049883000552654, decouple_loss:0.0012918557040393353
Iteration: 3453, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484224021434784, gen p mean: -0.06079499423503876, mean p set: 0.4489026963710785
loss_pred:0.013320296071469784, decouple_loss:0.0011408237041905522
The modified gen p mean: 0.4469614624977112, gen p mean: -0.0565260611474514, mean p set: 0.4474417567253113The modified gen p mean: 0.4471054971218109, gen p mean: -0.057540543377399445, mean p set: 0.447585791349411
loss_pred:0.013288063928484917, decouple_loss:0.0010873571736738086
loss_pred:0.013632392510771751, decouple_loss:0.0010316105326637626
Iteration: 3454, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473579227924347, gen p mean: -0.05718020349740982, mean p set: 0.4478381872177124
loss_pred:0.013352497480809689, decouple_loss:0.0010546932462602854
The modified gen p mean: 0.44676217436790466, gen p mean: -0.05524955317378044, mean p set: 0.44724246859550476The modified gen p mean: 0.4471782445907593, gen p mean: -0.05826873704791069, mean p set: 0.4476585388183594
loss_pred:0.013428268022835255, decouple_loss:0.0010430148104205728
loss_pred:0.013474560342729092, decouple_loss:0.0010172090260311961
Iteration: 3455, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4458526074886322, gen p mean: -0.05455046519637108, mean p set: 0.4463328719139099
loss_pred:0.013525721617043018, decouple_loss:0.0009744024137035012
The modified gen p mean: 0.4475112557411194, gen p mean: -0.05113391578197479, mean p set: 0.4479915201663971The modified gen p mean: 0.44709211587905884, gen p mean: -0.053468018770217896, mean p set: 0.4475724399089813
loss_pred:0.013264133594930172, decouple_loss:0.001083065872080624
loss_pred:0.013230489566922188, decouple_loss:0.0010797710856422782
Iteration: 3456, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471133351325989, gen p mean: -0.05325061082839966, mean p set: 0.447593629360199
loss_pred:0.0133725730702281, decouple_loss:0.0012028994970023632
The modified gen p mean: 0.44735151529312134, gen p mean: -0.05062422528862953, mean p set: 0.44783177971839905The modified gen p mean: 0.44683948159217834, gen p mean: -0.052578408271074295, mean p set: 0.44731974601745605
loss_pred:0.013839560560882092, decouple_loss:0.0010064804228022695
loss_pred:0.013261211104691029, decouple_loss:0.0010388545924797654
Iteration: 3457, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4460639953613281, gen p mean: -0.048745304346084595, mean p set: 0.4465442895889282
loss_pred:0.013421677052974701, decouple_loss:0.0009790286421775818
The modified gen p mean: 0.44808536767959595, gen p mean: -0.048322245478630066, mean p set: 0.44856566190719604The modified gen p mean: 0.4472261667251587, gen p mean: -0.04720057547092438, mean p set: 0.4477064609527588
loss_pred:0.013045324012637138, decouple_loss:0.0010967793641611934
loss_pred:0.013470733538269997, decouple_loss:0.0009929133811965585
Iteration: 3458, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44654273986816406, gen p mean: -0.050948530435562134, mean p set: 0.44702303409576416
loss_pred:0.013575024902820587, decouple_loss:0.0010906241368502378
The modified gen p mean: 0.4468630850315094, gen p mean: -0.04744911566376686, mean p set: 0.4473433792591095The modified gen p mean: 0.44670340418815613, gen p mean: -0.048850636929273605, mean p set: 0.4471836984157562
loss_pred:0.013413479551672935, decouple_loss:0.0010477130999788642
loss_pred:0.013678777031600475, decouple_loss:0.0009644899400882423
Iteration: 3459, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4461408257484436, gen p mean: -0.04605843499302864, mean p set: 0.4466211497783661
loss_pred:0.013337058946490288, decouple_loss:0.001031340565532446
The modified gen p mean: 0.4461709260940552, gen p mean: -0.047950878739356995, mean p set: 0.4466512203216553The modified gen p mean: 0.44686564803123474, gen p mean: -0.047723911702632904, mean p set: 0.4473459720611572
loss_pred:0.013940449804067612, decouple_loss:0.0010156636126339436
loss_pred:0.013514654710888863, decouple_loss:0.0010485340608283877
Iteration: 3460, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470162093639374, gen p mean: -0.0509926900267601, mean p set: 0.4474965035915375
loss_pred:0.013431252911686897, decouple_loss:0.0009645152022130787
The modified gen p mean: 0.4462994635105133, gen p mean: -0.052914123982191086, mean p set: 0.4467797577381134The modified gen p mean: 0.446443647146225, gen p mean: -0.05158271640539169, mean p set: 0.44692397117614746
loss_pred:0.013558413833379745, decouple_loss:0.001043588388711214
loss_pred:0.013533338904380798, decouple_loss:0.0009512577671557665
2023-05-02 15:42:11 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.052644792944192886, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04910580441355705, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04899999126791954, mean p set: 0.4500633478164673
loss_pred:0.01899016462266445, decouple_loss:0.0010693713556975126
loss_pred:0.017881881445646286, decouple_loss:0.0010543823009356856
loss_pred:0.017919030040502548, decouple_loss:0.0010760059813037515
WV_0_PC_1_EH_0_PS_40, loss: 0.018317021429538727, avg_mse: 0.02673066407442093
current test mse: 0.026731
Iteration: 3461, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469147026538849, gen p mean: -0.05004841461777687, mean p set: 0.447394996881485
The modified gen p mean: 0.4468885660171509, gen p mean: -0.04950769245624542, mean p set: 0.447368860244751
The modified gen p mean: 0.4473232924938202, gen p mean: -0.053375039249658585, mean p set: 0.4478035867214203
loss_pred:0.013194911181926727, decouple_loss:0.0011634569382295012
loss_pred:0.013452872633934021, decouple_loss:0.0010232754284515977
loss_pred:0.013619061559438705, decouple_loss:0.0010034816805273294
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 3462, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471958875656128, gen p mean: -0.050049103796482086, mean p set: 0.4476762115955353
loss_pred:0.013193449936807156, decouple_loss:0.0010034916922450066
The modified gen p mean: 0.448825478553772, gen p mean: -0.05370483174920082, mean p set: 0.44930580258369446The modified gen p mean: 0.44771745800971985, gen p mean: -0.04744749143719673, mean p set: 0.44819772243499756
loss_pred:0.013928687199950218, decouple_loss:0.0010440032929182053
loss_pred:0.013100727461278439, decouple_loss:0.000979852513410151
Iteration: 3463, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468006491661072, gen p mean: -0.048008665442466736, mean p set: 0.4472809433937073
loss_pred:0.013572826981544495, decouple_loss:0.0011424010153859854
The modified gen p mean: 0.4478108584880829, gen p mean: -0.04778604581952095, mean p set: 0.44829118251800537The modified gen p mean: 0.44719478487968445, gen p mean: -0.048487838357686996, mean p set: 0.44767507910728455
loss_pred:0.01335584744811058, decouple_loss:0.0011469817254692316
loss_pred:0.01267032790929079, decouple_loss:0.0011709387181326747
Iteration: 3464, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44798219203948975, gen p mean: -0.0467359684407711, mean p set: 0.44846251606941223
loss_pred:0.012981326319277287, decouple_loss:0.0010582449613139033
The modified gen p mean: 0.4469561278820038, gen p mean: -0.044824954122304916, mean p set: 0.4474363923072815The modified gen p mean: 0.44609978795051575, gen p mean: -0.044168274849653244, mean p set: 0.44658011198043823
loss_pred:0.01325561385601759, decouple_loss:0.0010655774967744946
loss_pred:0.013672835193574429, decouple_loss:0.0010004258947446942
Iteration: 3465, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475893974304199, gen p mean: -0.04702962189912796, mean p set: 0.44806966185569763
loss_pred:0.013339928351342678, decouple_loss:0.0009643533267080784
The modified gen p mean: 0.44670695066452026, gen p mean: -0.04661351814866066, mean p set: 0.44718724489212036The modified gen p mean: 0.4459840655326843, gen p mean: -0.04837615415453911, mean p set: 0.4464643895626068
loss_pred:0.013553631491959095, decouple_loss:0.0010592552134767175
loss_pred:0.013447700999677181, decouple_loss:0.0010374182602390647
Iteration: 3466, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44625112414360046, gen p mean: -0.04629793018102646, mean p set: 0.44673141837120056
loss_pred:0.013967804610729218, decouple_loss:0.0010316428961232305
The modified gen p mean: 0.4468706548213959, gen p mean: -0.048321980983018875, mean p set: 0.44735097885131836The modified gen p mean: 0.4470779299736023, gen p mean: -0.051467396318912506, mean p set: 0.4475582242012024
loss_pred:0.013016989454627037, decouple_loss:0.000997797935269773
loss_pred:0.012774268165230751, decouple_loss:0.0010640248656272888
Iteration: 3467, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469868242740631, gen p mean: -0.050378985702991486, mean p set: 0.4474670886993408
loss_pred:0.013125503435730934, decouple_loss:0.00099173525813967
The modified gen p mean: 0.44603610038757324, gen p mean: -0.04653305187821388, mean p set: 0.44651639461517334The modified gen p mean: 0.4478234350681305, gen p mean: -0.045886117964982986, mean p set: 0.4483036994934082
loss_pred:0.012848449870944023, decouple_loss:0.0010488887783139944
loss_pred:0.013427319005131721, decouple_loss:0.0009770700708031654
Iteration: 3468, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4460238814353943, gen p mean: -0.04911501705646515, mean p set: 0.446504145860672
loss_pred:0.013295698910951614, decouple_loss:0.0010282734874635935
The modified gen p mean: 0.44676199555397034, gen p mean: -0.04910879209637642, mean p set: 0.44724223017692566The modified gen p mean: 0.44724735617637634, gen p mean: -0.04800980165600777, mean p set: 0.44772762060165405
loss_pred:0.013332988135516644, decouple_loss:0.0010751390364021063
loss_pred:0.012833683751523495, decouple_loss:0.0010052518919110298
Iteration: 3469, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480898678302765, gen p mean: -0.050441041588783264, mean p set: 0.448570191860199
loss_pred:0.01351762842386961, decouple_loss:0.0009191389544866979
The modified gen p mean: 0.4476472735404968, gen p mean: -0.0482662096619606, mean p set: 0.4481275677680969The modified gen p mean: 0.4470824897289276, gen p mean: -0.04900393262505531, mean p set: 0.4475627839565277
loss_pred:0.013338493183255196, decouple_loss:0.0009247192647308111
loss_pred:0.012391528114676476, decouple_loss:0.000935133604798466
Iteration: 3470, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446971595287323, gen p mean: -0.04783127084374428, mean p set: 0.4474518895149231
loss_pred:0.013256550766527653, decouple_loss:0.0009375139488838613
The modified gen p mean: 0.44652092456817627, gen p mean: -0.052377667278051376, mean p set: 0.44700121879577637The modified gen p mean: 0.4469093978404999, gen p mean: -0.05018822103738785, mean p set: 0.44738972187042236
loss_pred:0.013550590723752975, decouple_loss:0.0009364569559693336
loss_pred:0.013169033452868462, decouple_loss:0.0010615256614983082
2023-05-02 15:44:08 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.051343049854040146, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.047946810722351074, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04776834696531296, mean p set: 0.4500633478164673
loss_pred:0.01895790919661522, decouple_loss:0.0011670996900647879
loss_pred:0.01786811649799347, decouple_loss:0.0010932264849543571
loss_pred:0.01788882166147232, decouple_loss:0.0012430925853550434
WV_0_PC_1_EH_0_PS_40, loss: 0.01829667203128338, avg_mse: 0.02670096606016159
current test mse: 0.026701
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012014_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012014_3_24hr.npz
NaN value num: 0
Iteration: 3471, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4510181248188019, gen p mean: -0.03862898796796799, mean p set: 0.45149844884872437
loss_pred:0.015620579943060875, decouple_loss:0.001270775217562914
The modified gen p mean: 0.4506288766860962, gen p mean: -0.04401281476020813, mean p set: 0.4511091411113739The modified gen p mean: 0.4513009190559387, gen p mean: -0.040514636784791946, mean p set: 0.4517812132835388
loss_pred:0.015499638393521309, decouple_loss:0.001253072521649301loss_pred:0.016033997759222984, decouple_loss:0.0013687905156984925
Iteration: 3472, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44812560081481934, gen p mean: -0.04773101210594177, mean p set: 0.44860586524009705
loss_pred:0.0162437055259943, decouple_loss:0.0011812604498118162
The modified gen p mean: 0.4490245580673218, gen p mean: -0.04261256754398346, mean p set: 0.4495048522949219The modified gen p mean: 0.44990232586860657, gen p mean: -0.041650477796792984, mean p set: 0.45038262009620667
loss_pred:0.016028057783842087, decouple_loss:0.0011878830846399069
loss_pred:0.01562904193997383, decouple_loss:0.0011669826926663518
Iteration: 3473, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4518488347530365, gen p mean: -0.03654714301228523, mean p set: 0.4523291289806366
loss_pred:0.015698209404945374, decouple_loss:0.0009948534425348043
The modified gen p mean: 0.452470064163208, gen p mean: -0.037147652357816696, mean p set: 0.4529503583908081The modified gen p mean: 0.4500284194946289, gen p mean: -0.0398976132273674, mean p set: 0.450508713722229
loss_pred:0.015753865242004395, decouple_loss:0.0009920374723151326
loss_pred:0.014733424410223961, decouple_loss:0.0009782835841178894
Iteration: 3474, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449812114238739, gen p mean: -0.041426945477724075, mean p set: 0.4502924084663391
loss_pred:0.015409627929329872, decouple_loss:0.001202762359753251
The modified gen p mean: 0.45023345947265625, gen p mean: -0.04019530490040779, mean p set: 0.45071372389793396The modified gen p mean: 0.44900038838386536, gen p mean: -0.03980131074786186, mean p set: 0.44948065280914307
loss_pred:0.015098799020051956, decouple_loss:0.0011227276409044862
loss_pred:0.015726298093795776, decouple_loss:0.0011235177516937256
Iteration: 3475, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44789403676986694, gen p mean: -0.04708670824766159, mean p set: 0.44837433099746704
loss_pred:0.015665298327803612, decouple_loss:0.001133626326918602
The modified gen p mean: 0.4497763216495514, gen p mean: -0.04531804472208023, mean p set: 0.4502566158771515The modified gen p mean: 0.4495542049407959, gen p mean: -0.04028376564383507, mean p set: 0.4500344693660736
loss_pred:0.01604573056101799, decouple_loss:0.0011786296963691711
loss_pred:0.016339873895049095, decouple_loss:0.0010418297024443746
Iteration: 3476, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450116902589798, gen p mean: -0.04341891407966614, mean p set: 0.45059719681739807
loss_pred:0.014949753880500793, decouple_loss:0.0010664723813533783
The modified gen p mean: 0.4490300416946411, gen p mean: -0.044567450881004333, mean p set: 0.4495103359222412The modified gen p mean: 0.4486936330795288, gen p mean: -0.04192421957850456, mean p set: 0.4491738975048065
loss_pred:0.015674682334065437, decouple_loss:0.0013145614648237824
loss_pred:0.015945272520184517, decouple_loss:0.0011549812043085694
Iteration: 3477, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45069873332977295, gen p mean: -0.04096696898341179, mean p set: 0.45117899775505066
loss_pred:0.015390895307064056, decouple_loss:0.0011415715562179685
The modified gen p mean: 0.4502730667591095, gen p mean: -0.04627037048339844, mean p set: 0.4507533609867096The modified gen p mean: 0.44906073808670044, gen p mean: -0.04497835412621498, mean p set: 0.44954103231430054
loss_pred:0.015873603522777557, decouple_loss:0.0011600489960983396
loss_pred:0.015315731056034565, decouple_loss:0.0011200659209862351
Iteration: 3478, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476169943809509, gen p mean: -0.049288250505924225, mean p set: 0.44809725880622864
loss_pred:0.015668122097849846, decouple_loss:0.0010904809460043907
The modified gen p mean: 0.4501833915710449, gen p mean: -0.04583831876516342, mean p set: 0.450663685798645The modified gen p mean: 0.4493236243724823, gen p mean: -0.048489898443222046, mean p set: 0.4498039484024048
loss_pred:0.014822586439549923, decouple_loss:0.0009915867121890187
loss_pred:0.015487815253436565, decouple_loss:0.0011272105621173978
Iteration: 3479, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45051509141921997, gen p mean: -0.048180848360061646, mean p set: 0.45099538564682007
loss_pred:0.01498667523264885, decouple_loss:0.0011507354211062193
The modified gen p mean: 0.4490867555141449, gen p mean: -0.04920829087495804, mean p set: 0.449567049741745The modified gen p mean: 0.4523509442806244, gen p mean: -0.04711378365755081, mean p set: 0.4528312385082245
loss_pred:0.01602761074900627, decouple_loss:0.001204765634611249
loss_pred:0.014971474185585976, decouple_loss:0.0011990375351160765
Iteration: 3480, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45149093866348267, gen p mean: -0.0483400858938694, mean p set: 0.45197123289108276
loss_pred:0.01643805392086506, decouple_loss:0.0011529115727171302
The modified gen p mean: 0.4522462785243988, gen p mean: -0.04852890968322754, mean p set: 0.4527266025543213The modified gen p mean: 0.45175960659980774, gen p mean: -0.04459066316485405, mean p set: 0.45223987102508545
loss_pred:0.01604309119284153, decouple_loss:0.0010776856215670705
loss_pred:0.015060976147651672, decouple_loss:0.001086477073840797
2023-05-02 15:46:43 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.054286230355501175, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987669587135315, gen p mean: -0.05049882456660271, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.050699323415756226, mean p set: 0.4500633478164673
loss_pred:0.018756886944174767, decouple_loss:0.0011549184564501047
loss_pred:0.017659571021795273, decouple_loss:0.0011203319299966097
loss_pred:0.01771542988717556, decouple_loss:0.0012504429323598742
WV_0_PC_1_EH_0_PS_40, loss: 0.018102724105119705, avg_mse: 0.02628210373222828
current test mse: 0.026282
Iteration: 3481, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494289457798004, gen p mean: -0.04518849030137062, mean p set: 0.4499092102050781
The modified gen p mean: 0.449733167886734, gen p mean: -0.048591818660497665, mean p set: 0.4502134323120117
The modified gen p mean: 0.44963744282722473, gen p mean: -0.04811657965183258, mean p set: 0.45011773705482483
loss_pred:0.01628842018544674, decouple_loss:0.0012242421507835388
loss_pred:0.014832253567874432, decouple_loss:0.001155248610302806loss_pred:0.015228424221277237, decouple_loss:0.0011351879220455885
Iteration: 3482, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487537443637848, gen p mean: -0.045522287487983704, mean p set: 0.4492340683937073
loss_pred:0.01602865383028984, decouple_loss:0.0011007495922967792
The modified gen p mean: 0.4509003162384033, gen p mean: -0.046564050018787384, mean p set: 0.4513806104660034The modified gen p mean: 0.4494032859802246, gen p mean: -0.046574998646974564, mean p set: 0.4498836100101471
loss_pred:0.015151865780353546, decouple_loss:0.0011535629164427519
loss_pred:0.015930404886603355, decouple_loss:0.0010674437507987022
Iteration: 3483, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44933462142944336, gen p mean: -0.043519582599401474, mean p set: 0.44981491565704346
loss_pred:0.016480175778269768, decouple_loss:0.00113706907723099
The modified gen p mean: 0.448906809091568, gen p mean: -0.04585743322968483, mean p set: 0.4493871033191681The modified gen p mean: 0.4483394920825958, gen p mean: -0.044374626129865646, mean p set: 0.4488198161125183
loss_pred:0.015200472436845303, decouple_loss:0.0012319241650402546
loss_pred:0.016109559684991837, decouple_loss:0.0011021309765055776
Iteration: 3484, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489710330963135, gen p mean: -0.04439638927578926, mean p set: 0.4494513273239136
loss_pred:0.015632610768079758, decouple_loss:0.0011955745285376906
The modified gen p mean: 0.4484897255897522, gen p mean: -0.04573407396674156, mean p set: 0.4489700198173523The modified gen p mean: 0.44825178384780884, gen p mean: -0.04462471604347229, mean p set: 0.44873207807540894
loss_pred:0.015451150014996529, decouple_loss:0.0015574037097394466
loss_pred:0.015476107597351074, decouple_loss:0.0014576353132724762
Iteration: 3485, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484436810016632, gen p mean: -0.04492011293768883, mean p set: 0.4489240050315857
loss_pred:0.015550429001450539, decouple_loss:0.0011822604574263096
The modified gen p mean: 0.4494486451148987, gen p mean: -0.04672391712665558, mean p set: 0.4499289393424988The modified gen p mean: 0.44838157296180725, gen p mean: -0.04346771910786629, mean p set: 0.44886186718940735
loss_pred:0.015429366379976273, decouple_loss:0.0010974404867738485
loss_pred:0.015787538141012192, decouple_loss:0.0010383052285760641
Iteration: 3486, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489809572696686, gen p mean: -0.045662954449653625, mean p set: 0.4494612514972687
loss_pred:0.015705568715929985, decouple_loss:0.0013034705771133304
The modified gen p mean: 0.44966378808021545, gen p mean: -0.04525434970855713, mean p set: 0.45014408230781555The modified gen p mean: 0.4508685767650604, gen p mean: -0.03751209005713463, mean p set: 0.4513488709926605
loss_pred:0.015633167698979378, decouple_loss:0.0011836240300908685
loss_pred:0.015761392191052437, decouple_loss:0.0013241720153018832
Iteration: 3487, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45081618428230286, gen p mean: -0.03967994824051857, mean p set: 0.45129647850990295
loss_pred:0.01550724171102047, decouple_loss:0.0012329458259046078
The modified gen p mean: 0.44969621300697327, gen p mean: -0.04663655906915665, mean p set: 0.45017653703689575The modified gen p mean: 0.44814273715019226, gen p mean: -0.047726187855005264, mean p set: 0.44862303137779236
loss_pred:0.01529093086719513, decouple_loss:0.001346129341982305
loss_pred:0.015666725113987923, decouple_loss:0.0013599001104012132
Iteration: 3488, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489746391773224, gen p mean: -0.04376208782196045, mean p set: 0.4494549334049225
loss_pred:0.015688812360167503, decouple_loss:0.0010825222125276923
The modified gen p mean: 0.4490962624549866, gen p mean: -0.047335267066955566, mean p set: 0.4495765268802643The modified gen p mean: 0.45186713337898254, gen p mean: -0.04457276687026024, mean p set: 0.45234742760658264
loss_pred:0.01565384678542614, decouple_loss:0.0010478560579940677
loss_pred:0.015010413713753223, decouple_loss:0.0010909312404692173
Iteration: 3489, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482707679271698, gen p mean: -0.04335350915789604, mean p set: 0.4487510621547699
loss_pred:0.015867747366428375, decouple_loss:0.0011723877396434546
The modified gen p mean: 0.44875484704971313, gen p mean: -0.044262535870075226, mean p set: 0.44923514127731323The modified gen p mean: 0.45019152760505676, gen p mean: -0.04324870929121971, mean p set: 0.45067182183265686
loss_pred:0.01587321050465107, decouple_loss:0.0013121174415573478
loss_pred:0.014950718730688095, decouple_loss:0.0012252730084583163
Iteration: 3490, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490131437778473, gen p mean: -0.039330627769231796, mean p set: 0.4494934380054474
loss_pred:0.015433819964528084, decouple_loss:0.001019632094539702
The modified gen p mean: 0.4487544894218445, gen p mean: -0.039565812796354294, mean p set: 0.4492347836494446The modified gen p mean: 0.44946563243865967, gen p mean: -0.04207879677414894, mean p set: 0.4499458968639374
loss_pred:0.015358702279627323, decouple_loss:0.001048814388923347
loss_pred:0.01592855341732502, decouple_loss:0.0010655162623152137
2023-05-02 15:48:39 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.047716379165649414, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04394158720970154, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.044235583394765854, mean p set: 0.4500633478164673
loss_pred:0.018761299550533295, decouple_loss:0.001288024359382689
loss_pred:0.01767132058739662, decouple_loss:0.0011651203967630863
loss_pred:0.017745070159435272, decouple_loss:0.001211760682053864
WV_0_PC_1_EH_0_PS_40, loss: 0.018120311200618744, avg_mse: 0.026322633028030396
current test mse: 0.026323
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012017_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012017_3_24hr.npz
NaN value num: 0
Iteration: 3491, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474293291568756, gen p mean: -0.04129108786582947, mean p set: 0.4479096829891205
loss_pred:0.017407750710844994, decouple_loss:0.001189734786748886
The modified gen p mean: 0.4482515752315521, gen p mean: -0.04439670965075493, mean p set: 0.4487318992614746The modified gen p mean: 0.44774752855300903, gen p mean: -0.047168344259262085, mean p set: 0.4482278525829315
loss_pred:0.01714453473687172, decouple_loss:0.0012681272346526384
loss_pred:0.01638786494731903, decouple_loss:0.001181097817607224
Iteration: 3492, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44846218824386597, gen p mean: -0.04194732382893562, mean p set: 0.44894248247146606
loss_pred:0.01721262000501156, decouple_loss:0.0011412629391998053
The modified gen p mean: 0.44805869460105896, gen p mean: -0.04347316175699234, mean p set: 0.44853898882865906The modified gen p mean: 0.44886964559555054, gen p mean: -0.04440917819738388, mean p set: 0.449349969625473
loss_pred:0.016873173415660858, decouple_loss:0.0009717292850837111
loss_pred:0.016108348965644836, decouple_loss:0.000999373965896666
Iteration: 3493, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478350579738617, gen p mean: -0.042765457183122635, mean p set: 0.4483153223991394
loss_pred:0.016476711258292198, decouple_loss:0.0012011179933324456
The modified gen p mean: 0.44765704870224, gen p mean: -0.04271000251173973, mean p set: 0.4481373429298401The modified gen p mean: 0.4477674961090088, gen p mean: -0.041037559509277344, mean p set: 0.4482477605342865
loss_pred:0.01590028777718544, decouple_loss:0.0011966194724664092
loss_pred:0.016124337911605835, decouple_loss:0.001201051170937717
Iteration: 3494, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44755542278289795, gen p mean: -0.045233678072690964, mean p set: 0.44803571701049805
loss_pred:0.016205033287405968, decouple_loss:0.0012669028947129846
The modified gen p mean: 0.448513001203537, gen p mean: -0.044920340180397034, mean p set: 0.4489932656288147The modified gen p mean: 0.44836854934692383, gen p mean: -0.04396442696452141, mean p set: 0.4488488733768463
loss_pred:0.016188642010092735, decouple_loss:0.001133818062953651
loss_pred:0.016407474875450134, decouple_loss:0.001159235485829413
Iteration: 3495, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473278820514679, gen p mean: -0.04759201034903526, mean p set: 0.4478082060813904
loss_pred:0.016888756304979324, decouple_loss:0.0010992145398631692
The modified gen p mean: 0.4475163221359253, gen p mean: -0.04841303080320358, mean p set: 0.447996586561203The modified gen p mean: 0.44846925139427185, gen p mean: -0.04640102759003639, mean p set: 0.44894954562187195
loss_pred:0.016834547743201256, decouple_loss:0.0011150893988087773
loss_pred:0.016375407576560974, decouple_loss:0.001091912155970931
Iteration: 3496, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44737720489501953, gen p mean: -0.05396922305226326, mean p set: 0.44785749912261963
loss_pred:0.016844993457198143, decouple_loss:0.001042779884301126
The modified gen p mean: 0.447672039270401, gen p mean: -0.05347931385040283, mean p set: 0.4481523036956787The modified gen p mean: 0.4483610987663269, gen p mean: -0.04885340481996536, mean p set: 0.4488413631916046
loss_pred:0.016246430575847626, decouple_loss:0.0010968747083097696
loss_pred:0.016920015215873718, decouple_loss:0.001113209524191916
Iteration: 3497, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44839388132095337, gen p mean: -0.051769427955150604, mean p set: 0.44887417554855347
loss_pred:0.016110669821500778, decouple_loss:0.0009591514244675636
The modified gen p mean: 0.44850581884384155, gen p mean: -0.04976863041520119, mean p set: 0.44898611307144165The modified gen p mean: 0.44729772210121155, gen p mean: -0.05110820755362511, mean p set: 0.44777801632881165
loss_pred:0.016855500638484955, decouple_loss:0.0009912351379171014
loss_pred:0.01636638306081295, decouple_loss:0.001009895233437419
Iteration: 3498, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44756460189819336, gen p mean: -0.048355553299188614, mean p set: 0.44804492592811584
loss_pred:0.01630505546927452, decouple_loss:0.0010073886951431632
The modified gen p mean: 0.44823214411735535, gen p mean: -0.052537091076374054, mean p set: 0.44871240854263306The modified gen p mean: 0.44901153445243835, gen p mean: -0.0550563782453537, mean p set: 0.44949179887771606
loss_pred:0.016584647819399834, decouple_loss:0.00101463682949543
loss_pred:0.016748657450079918, decouple_loss:0.0011035175994038582
Iteration: 3499, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486573338508606, gen p mean: -0.04943082854151726, mean p set: 0.4491376578807831
loss_pred:0.016985321417450905, decouple_loss:0.0010613308986648917
The modified gen p mean: 0.4489119350910187, gen p mean: -0.05637955665588379, mean p set: 0.4493922293186188The modified gen p mean: 0.4477936625480652, gen p mean: -0.04868680611252785, mean p set: 0.4482739567756653
loss_pred:0.01651076227426529, decouple_loss:0.0010855149012058973
loss_pred:0.016710488125681877, decouple_loss:0.0009709556470625103
Iteration: 3500, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473387598991394, gen p mean: -0.045872967690229416, mean p set: 0.4478190541267395
loss_pred:0.01653960905969143, decouple_loss:0.0010809394298121333
The modified gen p mean: 0.44744303822517395, gen p mean: -0.04522132873535156, mean p set: 0.44792336225509644The modified gen p mean: 0.4478950798511505, gen p mean: -0.05149143189191818, mean p set: 0.4483753740787506
loss_pred:0.016266530379652977, decouple_loss:0.0010176153155043721
loss_pred:0.015563222579658031, decouple_loss:0.0010441405465826392
2023-05-02 15:51:12 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.04858711361885071, mean p set: 0.4502691626548767
The modified gen p mean: 0.4498766362667084, gen p mean: -0.044602494686841965, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.04488576203584671, mean p set: 0.4500633478164673
loss_pred:0.018288489431142807, decouple_loss:0.0009818157413974404
loss_pred:0.01727292127907276, decouple_loss:0.0009775267681106925
loss_pred:0.017338518053293228, decouple_loss:0.001014132285490632
WV_0_PC_1_EH_0_PS_40, loss: 0.017682868987321854, avg_mse: 0.025475656613707542
current test mse: 0.025476
Iteration: 3501, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44793975353240967, gen p mean: -0.04885304719209671, mean p set: 0.44842007756233215
The modified gen p mean: 0.4480227828025818, gen p mean: -0.045290421694517136, mean p set: 0.4485030770301819
The modified gen p mean: 0.4475019574165344, gen p mean: -0.043500591069459915, mean p set: 0.4479822516441345
loss_pred:0.016847046092152596, decouple_loss:0.0009214080637320876
loss_pred:0.016436748206615448, decouple_loss:0.0009888367494568229
loss_pred:0.016200153157114983, decouple_loss:0.0009993715211749077
Iteration: 3502, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476783871650696, gen p mean: -0.05027955397963524, mean p set: 0.44815871119499207
loss_pred:0.016144702211022377, decouple_loss:0.001163318520411849
The modified gen p mean: 0.44849756360054016, gen p mean: -0.04599042609333992, mean p set: 0.44897785782814026The modified gen p mean: 0.44846972823143005, gen p mean: -0.04752107337117195, mean p set: 0.44895002245903015
loss_pred:0.01665782555937767, decouple_loss:0.0010880802292376757
loss_pred:0.01663237251341343, decouple_loss:0.0011011128081008792
Iteration: 3503, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44815874099731445, gen p mean: -0.049685679376125336, mean p set: 0.44863903522491455
loss_pred:0.016549453139305115, decouple_loss:0.0009181182831525803
The modified gen p mean: 0.44807130098342896, gen p mean: -0.049312204122543335, mean p set: 0.44855156540870667The modified gen p mean: 0.4479680359363556, gen p mean: -0.0482359305024147, mean p set: 0.4484483003616333
loss_pred:0.01628326252102852, decouple_loss:0.0008877713116817176
loss_pred:0.01581415720283985, decouple_loss:0.0010098315542563796
Iteration: 3504, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44795742630958557, gen p mean: -0.04950300604104996, mean p set: 0.44843775033950806
loss_pred:0.016533756628632545, decouple_loss:0.0010246088495478034
The modified gen p mean: 0.4476569890975952, gen p mean: -0.04975326359272003, mean p set: 0.4481372833251953The modified gen p mean: 0.44701382517814636, gen p mean: -0.04702799394726753, mean p set: 0.4474940896034241
loss_pred:0.017055008560419083, decouple_loss:0.0010539196664467454
loss_pred:0.01676524616777897, decouple_loss:0.0011525987647473812
Iteration: 3505, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44835129380226135, gen p mean: -0.05246469005942345, mean p set: 0.44883155822753906
loss_pred:0.01656702160835266, decouple_loss:0.001040473929606378
The modified gen p mean: 0.44760873913764954, gen p mean: -0.05510200560092926, mean p set: 0.44808903336524963The modified gen p mean: 0.4472630023956299, gen p mean: -0.04752451181411743, mean p set: 0.44774329662323
loss_pred:0.016338149085640907, decouple_loss:0.0012402324937283993
loss_pred:0.01632138155400753, decouple_loss:0.001015730551443994
Iteration: 3506, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44800901412963867, gen p mean: -0.050857435911893845, mean p set: 0.44848933815956116
loss_pred:0.01618158258497715, decouple_loss:0.0010409324895590544
The modified gen p mean: 0.44838833808898926, gen p mean: -0.04538949951529503, mean p set: 0.44886863231658936The modified gen p mean: 0.4489613473415375, gen p mean: -0.05120231956243515, mean p set: 0.4494416415691376
loss_pred:0.01609533652663231, decouple_loss:0.0010527587728574872
loss_pred:0.016570670530200005, decouple_loss:0.0009228643029928207
Iteration: 3507, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44793790578842163, gen p mean: -0.05136469379067421, mean p set: 0.44841820001602173
loss_pred:0.01593906804919243, decouple_loss:0.000998073723167181
The modified gen p mean: 0.44819241762161255, gen p mean: -0.04535024240612984, mean p set: 0.44867268204689026The modified gen p mean: 0.4488668143749237, gen p mean: -0.05471082776784897, mean p set: 0.4493470788002014
loss_pred:0.016048826277256012, decouple_loss:0.0010416400618851185
loss_pred:0.016693593934178352, decouple_loss:0.0012173623545095325
Iteration: 3508, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469981789588928, gen p mean: -0.04942217096686363, mean p set: 0.4474784731864929
loss_pred:0.016489297151565552, decouple_loss:0.0009209061390720308
The modified gen p mean: 0.4482339918613434, gen p mean: -0.04744834825396538, mean p set: 0.4487142562866211The modified gen p mean: 0.447792649269104, gen p mean: -0.046614959836006165, mean p set: 0.4482729434967041
loss_pred:0.01666877418756485, decouple_loss:0.0009469469077885151
loss_pred:0.0161433108150959, decouple_loss:0.0010565932607278228
Iteration: 3509, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44846266508102417, gen p mean: -0.04474165290594101, mean p set: 0.44894295930862427
loss_pred:0.015945041552186012, decouple_loss:0.0009244464454241097
The modified gen p mean: 0.44767722487449646, gen p mean: -0.04693091660737991, mean p set: 0.44815748929977417The modified gen p mean: 0.4474272131919861, gen p mean: -0.04247668758034706, mean p set: 0.4479075074195862
loss_pred:0.016941046342253685, decouple_loss:0.000890892231836915
loss_pred:0.016764860600233078, decouple_loss:0.000892497890163213
Iteration: 3510, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475322663784027, gen p mean: -0.04334323853254318, mean p set: 0.4480125904083252
loss_pred:0.016619665548205376, decouple_loss:0.0009470006334595382
The modified gen p mean: 0.4472518265247345, gen p mean: -0.04446668550372124, mean p set: 0.4477321207523346The modified gen p mean: 0.44797033071517944, gen p mean: -0.046083003282547, mean p set: 0.44845062494277954
loss_pred:0.016879500821232796, decouple_loss:0.0011526676826179028
loss_pred:0.01644243113696575, decouple_loss:0.00097751640714705
2023-05-02 15:53:07 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.04922211170196533, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04546290263533592, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.045738451182842255, mean p set: 0.4500633478164673
loss_pred:0.01827184297144413, decouple_loss:0.0009921278106048703
loss_pred:0.017243046313524246, decouple_loss:0.0009332356275990605
loss_pred:0.017274411395192146, decouple_loss:0.0008977188263088465
WV_0_PC_1_EH_0_PS_40, loss: 0.017643485218286514, avg_mse: 0.025389673188328743
current test mse: 0.02539
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012001_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012001_3_24hr.npz
NaN value num: 0
Iteration: 3511, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4517090320587158, gen p mean: -0.04578729718923569, mean p set: 0.4521893560886383
loss_pred:0.015276705846190453, decouple_loss:0.0011900821700692177
The modified gen p mean: 0.44793349504470825, gen p mean: -0.04549313336610794, mean p set: 0.44841381907463074The modified gen p mean: 0.44979265332221985, gen p mean: -0.04011140018701553, mean p set: 0.45027294754981995
loss_pred:0.014866710640490055, decouple_loss:0.0009179429616779089
loss_pred:0.015266030095517635, decouple_loss:0.0010396294528618455
Iteration: 3512, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450158029794693, gen p mean: -0.040886227041482925, mean p set: 0.4506383240222931
loss_pred:0.015243093483150005, decouple_loss:0.0010682453867048025
The modified gen p mean: 0.4504612386226654, gen p mean: -0.046641286462545395, mean p set: 0.4509415924549103The modified gen p mean: 0.4483596682548523, gen p mean: -0.04226812347769737, mean p set: 0.44883993268013
loss_pred:0.014808322302997112, decouple_loss:0.0011204674374312162
loss_pred:0.014967539347708225, decouple_loss:0.0011115300003439188
Iteration: 3513, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4515779912471771, gen p mean: -0.04534938186407089, mean p set: 0.45205825567245483
loss_pred:0.015232487581670284, decouple_loss:0.001076152897439897
The modified gen p mean: 0.45045655965805054, gen p mean: -0.043524015694856644, mean p set: 0.45093685388565063The modified gen p mean: 0.4480988383293152, gen p mean: -0.05151762068271637, mean p set: 0.4485791027545929
loss_pred:0.01519727148115635, decouple_loss:0.0011147338664159179
loss_pred:0.015674235299229622, decouple_loss:0.0010561406379565597
Iteration: 3514, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4512201249599457, gen p mean: -0.04642493650317192, mean p set: 0.4517004191875458
loss_pred:0.014894993975758553, decouple_loss:0.0009059254080057144
The modified gen p mean: 0.45140671730041504, gen p mean: -0.046999573707580566, mean p set: 0.45188701152801514The modified gen p mean: 0.4507182240486145, gen p mean: -0.052731953561306, mean p set: 0.4511985182762146
loss_pred:0.014850391075015068, decouple_loss:0.0008963203290477395
loss_pred:0.015016947872936726, decouple_loss:0.0009989688405767083
Iteration: 3515, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44996246695518494, gen p mean: -0.04486940801143646, mean p set: 0.45044276118278503
loss_pred:0.014752394519746304, decouple_loss:0.0010764169273898005
The modified gen p mean: 0.451168417930603, gen p mean: -0.04308479279279709, mean p set: 0.4516487121582031The modified gen p mean: 0.44808316230773926, gen p mean: -0.04939690977334976, mean p set: 0.44856342673301697
loss_pred:0.015525614842772484, decouple_loss:0.0011204637121409178
loss_pred:0.014646465890109539, decouple_loss:0.001137151033617556
Iteration: 3516, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45011767745018005, gen p mean: -0.04275491088628769, mean p set: 0.45059797167778015
loss_pred:0.015511523932218552, decouple_loss:0.0010062378132715821
The modified gen p mean: 0.45060259103775024, gen p mean: -0.041352029889822006, mean p set: 0.45108291506767273The modified gen p mean: 0.44834089279174805, gen p mean: -0.04659382626414299, mean p set: 0.44882118701934814
loss_pred:0.015287917107343674, decouple_loss:0.0010217949748039246
loss_pred:0.015284834429621696, decouple_loss:0.0010951923904940486
Iteration: 3517, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487482011318207, gen p mean: -0.0461655929684639, mean p set: 0.44922852516174316
loss_pred:0.014807239174842834, decouple_loss:0.0010572923347353935
The modified gen p mean: 0.44953253865242004, gen p mean: -0.044321849942207336, mean p set: 0.45001283288002014The modified gen p mean: 0.4507247507572174, gen p mean: -0.046669162809848785, mean p set: 0.4512050449848175
loss_pred:0.014798138290643692, decouple_loss:0.0011830610455945134
loss_pred:0.014696016907691956, decouple_loss:0.0010698317782953382
Iteration: 3518, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449003666639328, gen p mean: -0.04511428251862526, mean p set: 0.4494839310646057
loss_pred:0.014509248547255993, decouple_loss:0.0011826989939436316
The modified gen p mean: 0.44978296756744385, gen p mean: -0.04252994433045387, mean p set: 0.45026326179504395The modified gen p mean: 0.4476472735404968, gen p mean: -0.04621157422661781, mean p set: 0.44812753796577454
loss_pred:0.0151126803830266, decouple_loss:0.0011346415849402547
loss_pred:0.015225585550069809, decouple_loss:0.0012022553710266948
Iteration: 3519, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.452107310295105, gen p mean: -0.049574170261621475, mean p set: 0.45258763432502747
loss_pred:0.015259480103850365, decouple_loss:0.001318243914283812
The modified gen p mean: 0.45187345147132874, gen p mean: -0.0486205518245697, mean p set: 0.45235374569892883The modified gen p mean: 0.4477993845939636, gen p mean: -0.048126112669706345, mean p set: 0.4482796788215637
loss_pred:0.014813929796218872, decouple_loss:0.0012161120539531112
loss_pred:0.014779104851186275, decouple_loss:0.0011295913718640804
Iteration: 3520, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500531256198883, gen p mean: -0.04425675794482231, mean p set: 0.4505334198474884
loss_pred:0.015016051940619946, decouple_loss:0.001206787652336061
The modified gen p mean: 0.4508593678474426, gen p mean: -0.049427781254053116, mean p set: 0.4513396918773651The modified gen p mean: 0.4515479803085327, gen p mean: -0.04683598503470421, mean p set: 0.4520282447338104
loss_pred:0.014566375873982906, decouple_loss:0.0011560760904103518
loss_pred:0.014875880442559719, decouple_loss:0.0011264196364209056
2023-05-02 15:55:40 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.0524076372385025, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04843955114483833, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.048952966928482056, mean p set: 0.4500633478164673
loss_pred:0.018597394227981567, decouple_loss:0.0012017686385661364
loss_pred:0.01748563162982464, decouple_loss:0.0011357233161106706
loss_pred:0.017568327486515045, decouple_loss:0.0010981005616486073
WV_0_PC_1_EH_0_PS_40, loss: 0.017941046506166458, avg_mse: 0.025936167687177658
current test mse: 0.025936
Iteration: 3521, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45089954137802124, gen p mean: -0.050231967121362686, mean p set: 0.45137983560562134
The modified gen p mean: 0.4509420394897461, gen p mean: -0.04792005941271782, mean p set: 0.4514223337173462
The modified gen p mean: 0.44800230860710144, gen p mean: -0.04921179637312889, mean p set: 0.44848257303237915
loss_pred:0.014684490859508514, decouple_loss:0.0010895588202401996
loss_pred:0.014863947406411171, decouple_loss:0.001217594719491899
loss_pred:0.014918380416929722, decouple_loss:0.0011137881083413959
Iteration: 3522, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494893550872803, gen p mean: -0.0447390116751194, mean p set: 0.449969619512558
loss_pred:0.015463074669241905, decouple_loss:0.0011629262007772923
The modified gen p mean: 0.44909119606018066, gen p mean: -0.044738367199897766, mean p set: 0.44957149028778076The modified gen p mean: 0.4499184191226959, gen p mean: -0.04693521559238434, mean p set: 0.450398713350296
loss_pred:0.014541853219270706, decouple_loss:0.0011152817169204354
loss_pred:0.015357202850282192, decouple_loss:0.0011150744976475835
Iteration: 3523, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4506099224090576, gen p mean: -0.04406988248229027, mean p set: 0.4510902166366577
loss_pred:0.014905965887010098, decouple_loss:0.0009817008394747972
The modified gen p mean: 0.44839081168174744, gen p mean: -0.047554682940244675, mean p set: 0.44887110590934753The modified gen p mean: 0.4492226541042328, gen p mean: -0.048237234354019165, mean p set: 0.4497029781341553
loss_pred:0.01513541117310524, decouple_loss:0.0010334179969504476
loss_pred:0.014586924575269222, decouple_loss:0.0010638403473421931
Iteration: 3524, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44832876324653625, gen p mean: -0.049228962510824203, mean p set: 0.44880905747413635
loss_pred:0.014960096217691898, decouple_loss:0.001194354030303657
The modified gen p mean: 0.4486495554447174, gen p mean: -0.04293537884950638, mean p set: 0.4491298198699951
The modified gen p mean: 0.4506893754005432, gen p mean: -0.05033242702484131, mean p set: 0.4511696398258209
loss_pred:0.014894654043018818, decouple_loss:0.001309269922785461
loss_pred:0.0150600615888834, decouple_loss:0.0011940754484385252
Iteration: 3525, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482850432395935, gen p mean: -0.0482616201043129, mean p set: 0.4487653374671936
loss_pred:0.015084745362401009, decouple_loss:0.0011767047690227628
The modified gen p mean: 0.45139288902282715, gen p mean: -0.04682430252432823, mean p set: 0.45187318325042725The modified gen p mean: 0.4510978162288666, gen p mean: -0.04689403623342514, mean p set: 0.4515781104564667
loss_pred:0.01482374407351017, decouple_loss:0.0011039192322641611
loss_pred:0.015237915329635143, decouple_loss:0.001186658744700253
Iteration: 3526, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497433006763458, gen p mean: -0.04283261299133301, mean p set: 0.4502235949039459
loss_pred:0.01510645728558302, decouple_loss:0.001047826837748289
The modified gen p mean: 0.4488142132759094, gen p mean: -0.043293848633766174, mean p set: 0.44929447770118713The modified gen p mean: 0.45107895135879517, gen p mean: -0.04407665878534317, mean p set: 0.45155924558639526
loss_pred:0.015169830061495304, decouple_loss:0.0009929048828780651
loss_pred:0.014820811338722706, decouple_loss:0.0009773318888619542
Iteration: 3527, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448527067899704, gen p mean: -0.04542813077569008, mean p set: 0.44900739192962646
loss_pred:0.015087541192770004, decouple_loss:0.0010188367450609803
The modified gen p mean: 0.45109590888023376, gen p mean: -0.041342224925756454, mean p set: 0.45157620310783386The modified gen p mean: 0.4516427516937256, gen p mean: -0.050057392567396164, mean p set: 0.4521230459213257
loss_pred:0.014967366121709347, decouple_loss:0.001142120105214417
loss_pred:0.015141605399549007, decouple_loss:0.001130881137214601
Iteration: 3528, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44859692454338074, gen p mean: -0.04719964414834976, mean p set: 0.44907721877098083
loss_pred:0.014879204332828522, decouple_loss:0.001091947196982801
The modified gen p mean: 0.4516884386539459, gen p mean: -0.04791056364774704, mean p set: 0.4521687626838684The modified gen p mean: 0.45020046830177307, gen p mean: -0.03878427669405937, mean p set: 0.4506807327270508
loss_pred:0.015213166363537312, decouple_loss:0.0010391981340944767
loss_pred:0.014915838837623596, decouple_loss:0.0010360653977841139
Iteration: 3529, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486802816390991, gen p mean: -0.04370438680052757, mean p set: 0.4491605758666992
loss_pred:0.014767525717616081, decouple_loss:0.0010904396185651422
The modified gen p mean: 0.45202067494392395, gen p mean: -0.047722578048706055, mean p set: 0.45250096917152405The modified gen p mean: 0.45214930176734924, gen p mean: -0.04442990571260452, mean p set: 0.45262959599494934
loss_pred:0.015084031969308853, decouple_loss:0.001143515226431191
loss_pred:0.014426300302147865, decouple_loss:0.0011895876377820969
Iteration: 3530, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45037880539894104, gen p mean: -0.04083148017525673, mean p set: 0.45085906982421875
loss_pred:0.015251756645739079, decouple_loss:0.0010175744537264109
The modified gen p mean: 0.45025596022605896, gen p mean: -0.04537954926490784, mean p set: 0.45073628425598145The modified gen p mean: 0.4497833847999573, gen p mean: -0.0422842875123024, mean p set: 0.4502636790275574
loss_pred:0.014842006377875805, decouple_loss:0.0011583191808313131
loss_pred:0.0144729008898139, decouple_loss:0.0009627866093069315
2023-05-02 15:57:34 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.04873748868703842, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04487472400069237, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.0453093983232975, mean p set: 0.4500633478164673
loss_pred:0.018573960289359093, decouple_loss:0.0014147741021588445
loss_pred:0.017456255853176117, decouple_loss:0.0013490604469552636
loss_pred:0.017531851306557655, decouple_loss:0.0013951665023341775
WV_0_PC_1_EH_0_PS_40, loss: 0.01792334020137787, avg_mse: 0.025889728218317032
current test mse: 0.02589
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012008_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012008_3_24hr.npz
NaN value num: 0
Iteration: 3531, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4535704255104065, gen p mean: -0.03445236012339592, mean p set: 0.4540506899356842
loss_pred:0.015272637829184532, decouple_loss:0.0012597625609487295
The modified gen p mean: 0.45272883772850037, gen p mean: -0.03975014388561249, mean p set: 0.4532091021537781The modified gen p mean: 0.45104438066482544, gen p mean: -0.037693411111831665, mean p set: 0.4515247046947479
loss_pred:0.015271315351128578, decouple_loss:0.0011843782849609852loss_pred:0.015123149380087852, decouple_loss:0.0012405442539602518
Iteration: 3532, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45365244150161743, gen p mean: -0.04415525496006012, mean p set: 0.4541327655315399
loss_pred:0.014972077682614326, decouple_loss:0.0010713286465033889
The modified gen p mean: 0.4534977972507477, gen p mean: -0.03445836156606674, mean p set: 0.4539780914783478
The modified gen p mean: 0.4511784315109253, gen p mean: -0.03368818759918213, mean p set: 0.4516587555408478
loss_pred:0.015234794467687607, decouple_loss:0.0010259164264425635
loss_pred:0.014772698283195496, decouple_loss:0.0011056371731683612
Iteration: 3533, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45210379362106323, gen p mean: -0.03616306930780411, mean p set: 0.45258408784866333
loss_pred:0.015304072760045528, decouple_loss:0.0010654920479282737
The modified gen p mean: 0.45358794927597046, gen p mean: -0.031117988750338554, mean p set: 0.45406821370124817
The modified gen p mean: 0.45215561985969543, gen p mean: -0.03055616468191147, mean p set: 0.45263591408729553
loss_pred:0.014976476319134235, decouple_loss:0.0011479335371404886
loss_pred:0.014812342822551727, decouple_loss:0.0011483702110126615
Iteration: 3534, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4535066783428192, gen p mean: -0.03267312049865723, mean p set: 0.4539869725704193
loss_pred:0.015931563451886177, decouple_loss:0.0010236479574814439
The modified gen p mean: 0.4500243663787842, gen p mean: -0.03480442240834236, mean p set: 0.4505046308040619The modified gen p mean: 0.4518735706806183, gen p mean: -0.038381416350603104, mean p set: 0.4523538649082184
loss_pred:0.015296305529773235, decouple_loss:0.0010159758385270834
loss_pred:0.014927703887224197, decouple_loss:0.0009556047152727842
Iteration: 3535, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507077634334564, gen p mean: -0.044731076806783676, mean p set: 0.4511880576610565
loss_pred:0.015520507469773293, decouple_loss:0.0009604868828319013
The modified gen p mean: 0.4498867690563202, gen p mean: -0.03644164279103279, mean p set: 0.4503670632839203The modified gen p mean: 0.4520490765571594, gen p mean: -0.038866713643074036, mean p set: 0.4525293707847595
loss_pred:0.015195909887552261, decouple_loss:0.000930739683099091
loss_pred:0.015027805231511593, decouple_loss:0.0009649265557527542
Iteration: 3536, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4519471526145935, gen p mean: -0.04056799039244652, mean p set: 0.452427476644516
loss_pred:0.014952079392969608, decouple_loss:0.0008886895375326276
The modified gen p mean: 0.45190176367759705, gen p mean: -0.040267810225486755, mean p set: 0.45238205790519714The modified gen p mean: 0.45251134037971497, gen p mean: -0.035104427486658096, mean p set: 0.45299163460731506
loss_pred:0.015026606619358063, decouple_loss:0.0009047306375578046
loss_pred:0.015040239319205284, decouple_loss:0.0009003731538541615
Iteration: 3537, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45349135994911194, gen p mean: -0.03866414353251457, mean p set: 0.45397165417671204
loss_pred:0.014510470442473888, decouple_loss:0.001030883751809597
The modified gen p mean: 0.45308828353881836, gen p mean: -0.03669318929314613, mean p set: 0.45356857776641846
The modified gen p mean: 0.45166248083114624, gen p mean: -0.04545857384800911, mean p set: 0.4521428048610687
loss_pred:0.014435486868023872, decouple_loss:0.0010239335242658854
loss_pred:0.013975439593195915, decouple_loss:0.0010603464907035232
Iteration: 3538, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45416635274887085, gen p mean: -0.04445018619298935, mean p set: 0.45464667677879333
loss_pred:0.014651485718786716, decouple_loss:0.0011809412389993668
The modified gen p mean: 0.45276474952697754, gen p mean: -0.04256848990917206, mean p set: 0.45324504375457764The modified gen p mean: 0.4538218379020691, gen p mean: -0.037592362612485886, mean p set: 0.4543021321296692
loss_pred:0.014726419001817703, decouple_loss:0.0010226396843791008
loss_pred:0.014632530510425568, decouple_loss:0.0009235324105247855
Iteration: 3539, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4525458514690399, gen p mean: -0.048979368060827255, mean p set: 0.45302614569664
loss_pred:0.01462587807327509, decouple_loss:0.00102932786103338
The modified gen p mean: 0.45330971479415894, gen p mean: -0.03982752189040184, mean p set: 0.45378997921943665The modified gen p mean: 0.4512979984283447, gen p mean: -0.0454181544482708, mean p set: 0.4517782926559448
loss_pred:0.014629144221544266, decouple_loss:0.001032012514770031
loss_pred:0.015183198265731335, decouple_loss:0.0010908598778769374
Iteration: 3540, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503452181816101, gen p mean: -0.046227581799030304, mean p set: 0.4508254826068878
loss_pred:0.015562047250568867, decouple_loss:0.0010293126106262207
The modified gen p mean: 0.45126619935035706, gen p mean: -0.0469217449426651, mean p set: 0.45174646377563477The modified gen p mean: 0.45072656869888306, gen p mean: -0.04592731595039368, mean p set: 0.45120686292648315
loss_pred:0.01519818790256977, decouple_loss:0.0009582036291249096
loss_pred:0.014691611751914024, decouple_loss:0.0010084663517773151
2023-05-02 16:00:03 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.05275397375226021, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.049314238131046295, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.049583833664655685, mean p set: 0.4500633478164673
loss_pred:0.018537338823080063, decouple_loss:0.001341257942840457
loss_pred:0.017438923940062523, decouple_loss:0.0013399305753409863
loss_pred:0.017497476190328598, decouple_loss:0.0013567571295425296
WV_0_PC_1_EH_0_PS_40, loss: 0.01789187826216221, avg_mse: 0.025838704779744148
current test mse: 0.025839
Iteration: 3541, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.451273113489151, gen p mean: -0.04878993704915047, mean p set: 0.4517534077167511
The modified gen p mean: 0.45130714774131775, gen p mean: -0.048399604856967926, mean p set: 0.45178741216659546
The modified gen p mean: 0.4521459639072418, gen p mean: -0.03813447803258896, mean p set: 0.4526262879371643
loss_pred:0.014518682844936848, decouple_loss:0.0010788232320919633
loss_pred:0.014432833530008793, decouple_loss:0.0010325202019885182
loss_pred:0.014347494579851627, decouple_loss:0.0009946328354999423
Iteration: 3542, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4536437690258026, gen p mean: -0.04438142105937004, mean p set: 0.4541240334510803
loss_pred:0.01470034010708332, decouple_loss:0.0011628367938101292
The modified gen p mean: 0.4519036114215851, gen p mean: -0.03809794783592224, mean p set: 0.4523839056491852The modified gen p mean: 0.453026682138443, gen p mean: -0.03625335171818733, mean p set: 0.4535069465637207
loss_pred:0.01443577092140913, decouple_loss:0.0012401221320033073
loss_pred:0.014579891227185726, decouple_loss:0.0011085892328992486
Iteration: 3543, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.453730970621109, gen p mean: -0.049853142350912094, mean p set: 0.4542112350463867
loss_pred:0.014910239726305008, decouple_loss:0.0011747842654585838
The modified gen p mean: 0.45227381587028503, gen p mean: -0.04170393943786621, mean p set: 0.4527541399002075The modified gen p mean: 0.45323196053504944, gen p mean: -0.03628091886639595, mean p set: 0.45371225476264954
loss_pred:0.014970309101045132, decouple_loss:0.0010583392577245831
loss_pred:0.015298387035727501, decouple_loss:0.0011444457340985537
Iteration: 3544, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511004686355591, gen p mean: -0.03961441293358803, mean p set: 0.4515807330608368
loss_pred:0.015142419375479221, decouple_loss:0.0010424479842185974
The modified gen p mean: 0.4524848163127899, gen p mean: -0.039046697318553925, mean p set: 0.4529651403427124The modified gen p mean: 0.45151814818382263, gen p mean: -0.03915269300341606, mean p set: 0.45199844241142273
loss_pred:0.014479642733931541, decouple_loss:0.0010355495614930987
loss_pred:0.014988190494477749, decouple_loss:0.0010424454230815172
Iteration: 3545, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4529445171356201, gen p mean: -0.0373714342713356, mean p set: 0.4534248113632202
loss_pred:0.014991695992648602, decouple_loss:0.0014436653582379222
The modified gen p mean: 0.4529775083065033, gen p mean: -0.040736567229032516, mean p set: 0.4534578025341034The modified gen p mean: 0.452887624502182, gen p mean: -0.04005556181073189, mean p set: 0.4533679187297821
loss_pred:0.014399229548871517, decouple_loss:0.0013195904903113842
loss_pred:0.014536650851368904, decouple_loss:0.0012468212516978383
Iteration: 3546, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45249542593955994, gen p mean: -0.03870755061507225, mean p set: 0.45297572016716003
loss_pred:0.015317945741117, decouple_loss:0.0011824232060462236
The modified gen p mean: 0.4525628387928009, gen p mean: -0.03787079080939293, mean p set: 0.453043133020401The modified gen p mean: 0.4502796530723572, gen p mean: -0.03638940304517746, mean p set: 0.4507599174976349
loss_pred:0.01473928801715374, decouple_loss:0.001118877436965704
loss_pred:0.015024273656308651, decouple_loss:0.0010988774010911584
Iteration: 3547, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45269879698753357, gen p mean: -0.03803093358874321, mean p set: 0.45317909121513367
loss_pred:0.014856506139039993, decouple_loss:0.001028704340569675
The modified gen p mean: 0.45069363713264465, gen p mean: -0.03590558096766472, mean p set: 0.45117396116256714The modified gen p mean: 0.4527757465839386, gen p mean: -0.043007221072912216, mean p set: 0.4532560408115387
loss_pred:0.014701195061206818, decouple_loss:0.001185519271530211
loss_pred:0.014584334567189217, decouple_loss:0.0009797017555683851
Iteration: 3548, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504818022251129, gen p mean: -0.039129432290792465, mean p set: 0.450962096452713
loss_pred:0.015206568874418736, decouple_loss:0.001307494705542922
The modified gen p mean: 0.452810138463974, gen p mean: -0.04185572266578674, mean p set: 0.4532904326915741The modified gen p mean: 0.4529881477355957, gen p mean: -0.039304688572883606, mean p set: 0.4534684121608734
loss_pred:0.01496422290802002, decouple_loss:0.001057894085533917
loss_pred:0.014749071560800076, decouple_loss:0.0010457212338224053
Iteration: 3549, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45352113246917725, gen p mean: -0.04036878049373627, mean p set: 0.45400142669677734
loss_pred:0.014827805571258068, decouple_loss:0.0010522182565182447
The modified gen p mean: 0.45226365327835083, gen p mean: -0.03997553884983063, mean p set: 0.4527439475059509The modified gen p mean: 0.45062190294265747, gen p mean: -0.03666079416871071, mean p set: 0.4511021673679352
loss_pred:0.014654461294412613, decouple_loss:0.000985989230684936
loss_pred:0.015146184712648392, decouple_loss:0.0011257701553404331
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012001_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012001_3_24hr.npz
NaN value num: 0
Iteration: 3550, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475097954273224, gen p mean: -0.043989744037389755, mean p set: 0.4479900598526001
loss_pred:0.015918446704745293, decouple_loss:0.0012166477972641587
The modified gen p mean: 0.44768673181533813, gen p mean: -0.04824594035744667, mean p set: 0.44816699624061584The modified gen p mean: 0.44756880402565, gen p mean: -0.04625403881072998, mean p set: 0.4480490982532501
loss_pred:0.015470802783966064, decouple_loss:0.0010478973854333162
loss_pred:0.015497138723731041, decouple_loss:0.0011082470882683992
2023-05-02 16:02:42 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.05368238687515259, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.050073083490133286, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.05036802962422371, mean p set: 0.4500633478164673
loss_pred:0.018476268276572227, decouple_loss:0.001115244347602129
loss_pred:0.01742774061858654, decouple_loss:0.0011317438911646605
loss_pred:0.01749318838119507, decouple_loss:0.0010551465675234795
WV_0_PC_1_EH_0_PS_40, loss: 0.017854101955890656, avg_mse: 0.025783363729715347
current test mse: 0.025783
Iteration: 3551, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44733551144599915, gen p mean: -0.04323827847838402, mean p set: 0.44781580567359924
The modified gen p mean: 0.449078768491745, gen p mean: -0.04441038891673088, mean p set: 0.4495590925216675
The modified gen p mean: 0.4491611123085022, gen p mean: -0.04378576949238777, mean p set: 0.4496413767337799
loss_pred:0.015394852496683598, decouple_loss:0.0012161448830738664
loss_pred:0.01584143564105034, decouple_loss:0.00114834017585963
loss_pred:0.015167802572250366, decouple_loss:0.001291297492571175
Iteration: 3552, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480859339237213, gen p mean: -0.04406357184052467, mean p set: 0.4485662281513214
loss_pred:0.015434750355780125, decouple_loss:0.0013910382986068726
The modified gen p mean: 0.449690580368042, gen p mean: -0.04323187470436096, mean p set: 0.4501708745956421The modified gen p mean: 0.4501236379146576, gen p mean: -0.04477119445800781, mean p set: 0.4506039321422577
loss_pred:0.01516999676823616, decouple_loss:0.0011759671615436673
loss_pred:0.015060345642268658, decouple_loss:0.001183984219096601
Iteration: 3553, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45018357038497925, gen p mean: -0.04419542849063873, mean p set: 0.45066389441490173
loss_pred:0.015291120857000351, decouple_loss:0.0010522955562919378
The modified gen p mean: 0.44823694229125977, gen p mean: -0.04734671115875244, mean p set: 0.44871723651885986
The modified gen p mean: 0.447935551404953, gen p mean: -0.0460272952914238, mean p set: 0.4484158456325531
loss_pred:0.015321839600801468, decouple_loss:0.0011352973524481058
loss_pred:0.015349936671555042, decouple_loss:0.0012756653595715761
Iteration: 3554, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447966068983078, gen p mean: -0.046718619763851166, mean p set: 0.4484463632106781
loss_pred:0.014605178497731686, decouple_loss:0.0013044957304373384
The modified gen p mean: 0.4492204189300537, gen p mean: -0.04747409373521805, mean p set: 0.4497006833553314The modified gen p mean: 0.4476509690284729, gen p mean: -0.05166551098227501, mean p set: 0.4481312930583954
loss_pred:0.015822915360331535, decouple_loss:0.0014157970435917377
loss_pred:0.015195039100944996, decouple_loss:0.001428130897693336
Iteration: 3555, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495708644390106, gen p mean: -0.046363361179828644, mean p set: 0.4500511884689331
loss_pred:0.014962466433644295, decouple_loss:0.001267446088604629
The modified gen p mean: 0.4492908716201782, gen p mean: -0.045723024755716324, mean p set: 0.4497711658477783The modified gen p mean: 0.4500649571418762, gen p mean: -0.04335838556289673, mean p set: 0.45054522156715393
loss_pred:0.016010969877243042, decouple_loss:0.0013499782653525472
loss_pred:0.015634402632713318, decouple_loss:0.0013853125274181366
Iteration: 3556, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505389928817749, gen p mean: -0.042027994990348816, mean p set: 0.451019287109375
loss_pred:0.014988888055086136, decouple_loss:0.0013720886781811714
The modified gen p mean: 0.4502882957458496, gen p mean: -0.04725461080670357, mean p set: 0.4507685601711273The modified gen p mean: 0.45122846961021423, gen p mean: -0.048277243971824646, mean p set: 0.4517087936401367
loss_pred:0.01507426705211401, decouple_loss:0.0013219021493569016
loss_pred:0.015569380484521389, decouple_loss:0.0015029541682451963
Iteration: 3557, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44992679357528687, gen p mean: -0.04561622813344002, mean p set: 0.4504070580005646
loss_pred:0.015220198780298233, decouple_loss:0.0015520137967541814
The modified gen p mean: 0.45052456855773926, gen p mean: -0.04565654322504997, mean p set: 0.45100489258766174The modified gen p mean: 0.44751736521720886, gen p mean: -0.049180611968040466, mean p set: 0.44799768924713135
loss_pred:0.015041778795421124, decouple_loss:0.0015605479711666703
loss_pred:0.015092945657670498, decouple_loss:0.0017596733523532748
Iteration: 3558, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45034468173980713, gen p mean: -0.04495331272482872, mean p set: 0.4508250057697296
loss_pred:0.015767961740493774, decouple_loss:0.001191884046420455
The modified gen p mean: 0.4502367079257965, gen p mean: -0.04755260422825813, mean p set: 0.4507170021533966The modified gen p mean: 0.44882693886756897, gen p mean: -0.041208621114492416, mean p set: 0.44930723309516907
loss_pred:0.01515058521181345, decouple_loss:0.0012161596678197384
loss_pred:0.015053249895572662, decouple_loss:0.0011518272804096341
Iteration: 3559, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482101798057556, gen p mean: -0.0439947247505188, mean p set: 0.4486904740333557
loss_pred:0.014805484563112259, decouple_loss:0.001096107647754252
The modified gen p mean: 0.44973939657211304, gen p mean: -0.037758052349090576, mean p set: 0.4502197206020355The modified gen p mean: 0.4510071277618408, gen p mean: -0.04383300244808197, mean p set: 0.45148739218711853
loss_pred:0.015562228858470917, decouple_loss:0.0011918642558157444
loss_pred:0.015154222026467323, decouple_loss:0.0012390397023409605
Iteration: 3560, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44732335209846497, gen p mean: -0.045958876609802246, mean p set: 0.44780364632606506
loss_pred:0.015295898541808128, decouple_loss:0.0011581587605178356
The modified gen p mean: 0.45021921396255493, gen p mean: -0.04206012561917305, mean p set: 0.45069950819015503The modified gen p mean: 0.45038384199142456, gen p mean: -0.04227093979716301, mean p set: 0.45086413621902466
loss_pred:0.014692836441099644, decouple_loss:0.0011847765417769551
loss_pred:0.014821235090494156, decouple_loss:0.0011393718887120485
2023-05-02 16:04:36 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.051190827041864395, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04751678556203842, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04784609377384186, mean p set: 0.4500633478164673
loss_pred:0.018575729802250862, decouple_loss:0.0012509513180702925
loss_pred:0.017500240355730057, decouple_loss:0.0012171814450994134
loss_pred:0.017545295879244804, decouple_loss:0.0011638144496828318
WV_0_PC_1_EH_0_PS_40, loss: 0.017934288829565048, avg_mse: 0.02592581696808338
current test mse: 0.025926
Iteration: 3561, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474199712276459, gen p mean: -0.04540220648050308, mean p set: 0.44790026545524597
The modified gen p mean: 0.4500119984149933, gen p mean: -0.044732872396707535, mean p set: 0.45049232244491577
The modified gen p mean: 0.4479018747806549, gen p mean: -0.04178672656416893, mean p set: 0.448382169008255
loss_pred:0.015590481460094452, decouple_loss:0.0011014618212357163
loss_pred:0.014905329793691635, decouple_loss:0.0012453062226995826
loss_pred:0.014966717921197414, decouple_loss:0.001031264546327293
Iteration: 3562, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44767817854881287, gen p mean: -0.045323655009269714, mean p set: 0.44815847277641296
loss_pred:0.015029226429760456, decouple_loss:0.001244672224856913
The modified gen p mean: 0.44963374733924866, gen p mean: -0.04418839514255524, mean p set: 0.45011407136917114The modified gen p mean: 0.4509035348892212, gen p mean: -0.04445604979991913, mean p set: 0.4513837993144989
loss_pred:0.01562514714896679, decouple_loss:0.0011828254209831357
loss_pred:0.015017163008451462, decouple_loss:0.0011358569609001279
Iteration: 3563, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44960716366767883, gen p mean: -0.04398505762219429, mean p set: 0.45008742809295654
loss_pred:0.014996740967035294, decouple_loss:0.0010775302071124315
The modified gen p mean: 0.4486362040042877, gen p mean: -0.04187019541859627, mean p set: 0.44911646842956543
The modified gen p mean: 0.4503384828567505, gen p mean: -0.04790151119232178, mean p set: 0.450818806886673
loss_pred:0.015551800839602947, decouple_loss:0.0011409414000809193
loss_pred:0.014871872030198574, decouple_loss:0.0011165031464770436
Iteration: 3564, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44969457387924194, gen p mean: -0.04603899270296097, mean p set: 0.45017489790916443
loss_pred:0.015312083065509796, decouple_loss:0.0013942490331828594
The modified gen p mean: 0.4478349983692169, gen p mean: -0.04661835730075836, mean p set: 0.44831526279449463The modified gen p mean: 0.44836822152137756, gen p mean: -0.04391409456729889, mean p set: 0.44884851574897766
loss_pred:0.01572554185986519, decouple_loss:0.0011720602633431554
loss_pred:0.015594499185681343, decouple_loss:0.0013176172506064177
Iteration: 3565, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493815004825592, gen p mean: -0.039317622780799866, mean p set: 0.4498618245124817
loss_pred:0.015051779337227345, decouple_loss:0.001213915180414915
The modified gen p mean: 0.44820454716682434, gen p mean: -0.04280034825205803, mean p set: 0.44868484139442444The modified gen p mean: 0.4480643570423126, gen p mean: -0.0425226129591465, mean p set: 0.4485446512699127
loss_pred:0.014626413583755493, decouple_loss:0.0011546394089236856
loss_pred:0.014827124774456024, decouple_loss:0.0010812118416652083
Iteration: 3566, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502338469028473, gen p mean: -0.03571834787726402, mean p set: 0.450714111328125
loss_pred:0.014403658919036388, decouple_loss:0.0012448442867025733
The modified gen p mean: 0.4475920796394348, gen p mean: -0.04458789899945259, mean p set: 0.4480723738670349The modified gen p mean: 0.44779157638549805, gen p mean: -0.04056103155016899, mean p set: 0.44827190041542053
loss_pred:0.01496911235153675, decouple_loss:0.0011012695031240582
loss_pred:0.014899695292115211, decouple_loss:0.0010101539082825184
Iteration: 3567, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45032650232315063, gen p mean: -0.03586071729660034, mean p set: 0.45080679655075073
loss_pred:0.01498014573007822, decouple_loss:0.0011236085556447506
The modified gen p mean: 0.45021116733551025, gen p mean: -0.037209901958703995, mean p set: 0.45069149136543274The modified gen p mean: 0.4480181932449341, gen p mean: -0.038079697638750076, mean p set: 0.4484984576702118
loss_pred:0.015694813802838326, decouple_loss:0.0011083364952355623
loss_pred:0.01505910512059927, decouple_loss:0.0010296859545633197
Iteration: 3568, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44973328709602356, gen p mean: -0.033479753881692886, mean p set: 0.45021358132362366
loss_pred:0.014300092123448849, decouple_loss:0.0011208835057914257
The modified gen p mean: 0.4488028287887573, gen p mean: -0.031931810081005096, mean p set: 0.4492831230163574The modified gen p mean: 0.4505366384983063, gen p mean: -0.032390397042036057, mean p set: 0.45101693272590637
loss_pred:0.01455431804060936, decouple_loss:0.0011995388194918633
loss_pred:0.014436332508921623, decouple_loss:0.0011622103629633784
Iteration: 3569, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44751405715942383, gen p mean: -0.03448096290230751, mean p set: 0.44799432158470154
loss_pred:0.015056636184453964, decouple_loss:0.0011217216961085796
The modified gen p mean: 0.4497472047805786, gen p mean: -0.0357651486992836, mean p set: 0.4502274990081787The modified gen p mean: 0.4501817226409912, gen p mean: -0.03641997650265694, mean p set: 0.4506619870662689
loss_pred:0.01481297891587019, decouple_loss:0.0011584939202293754
loss_pred:0.015111062675714493, decouple_loss:0.0013675582595169544
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012015_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012015_3_24hr.npz
NaN value num: 0
Iteration: 3570, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44873663783073425, gen p mean: -0.042604830116033554, mean p set: 0.44921690225601196
loss_pred:0.016550762578845024, decouple_loss:0.0011839603539556265
The modified gen p mean: 0.4463479816913605, gen p mean: -0.047161929309368134, mean p set: 0.44682827591896057The modified gen p mean: 0.4470862150192261, gen p mean: -0.04590412601828575, mean p set: 0.44756653904914856
loss_pred:0.016875822097063065, decouple_loss:0.001356863183900714
loss_pred:0.016791271045804024, decouple_loss:0.0012743098195642233
2023-05-02 16:07:27 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.05262580141425133, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.048740558326244354, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04889928922057152, mean p set: 0.4500633478164673
loss_pred:0.018512824550271034, decouple_loss:0.0012587301898747683
loss_pred:0.01742732524871826, decouple_loss:0.0012664523674175143
loss_pred:0.0174721572548151, decouple_loss:0.001313490909524262
WV_0_PC_1_EH_0_PS_40, loss: 0.017868081107735634, avg_mse: 0.02578558214008808
current test mse: 0.025786
Iteration: 3571, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44757893681526184, gen p mean: -0.0517236702144146, mean p set: 0.44805923104286194
The modified gen p mean: 0.44625091552734375, gen p mean: -0.05672542378306389, mean p set: 0.44673120975494385
The modified gen p mean: 0.44587939977645874, gen p mean: -0.05055058002471924, mean p set: 0.44635969400405884
loss_pred:0.01653922162950039, decouple_loss:0.001460460713133216
loss_pred:0.016730982810258865, decouple_loss:0.0012671848526224494
loss_pred:0.0163282323628664, decouple_loss:0.0011791192227974534
Iteration: 3572, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474359154701233, gen p mean: -0.05376048758625984, mean p set: 0.4479162395000458
loss_pred:0.016384124755859375, decouple_loss:0.0014292324194684625
The modified gen p mean: 0.44537967443466187, gen p mean: -0.0550108328461647, mean p set: 0.4458599388599396The modified gen p mean: 0.4471026360988617, gen p mean: -0.05083221569657326, mean p set: 0.4475829601287842
loss_pred:0.016324780881404877, decouple_loss:0.0013629974564537406
loss_pred:0.01577729359269142, decouple_loss:0.0013204406714066863
Iteration: 3573, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479116201400757, gen p mean: -0.05448782071471214, mean p set: 0.4483919143676758
loss_pred:0.016090359538793564, decouple_loss:0.0010875262087211013
The modified gen p mean: 0.4458296597003937, gen p mean: -0.052601706236600876, mean p set: 0.4463099241256714The modified gen p mean: 0.4474209249019623, gen p mean: -0.05798371136188507, mean p set: 0.4479012191295624
loss_pred:0.016818521544337273, decouple_loss:0.0010401930194348097
loss_pred:0.016744371503591537, decouple_loss:0.0010789924999698997
Iteration: 3574, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479689598083496, gen p mean: -0.062275584787130356, mean p set: 0.4484492540359497
loss_pred:0.016092028468847275, decouple_loss:0.0011597416596487164
The modified gen p mean: 0.4479663074016571, gen p mean: -0.06089390441775322, mean p set: 0.4484466016292572The modified gen p mean: 0.4452609717845917, gen p mean: -0.06692075729370117, mean p set: 0.4457412362098694
loss_pred:0.016574613749980927, decouple_loss:0.00118619529530406
loss_pred:0.016360225155949593, decouple_loss:0.0013104267418384552
Iteration: 3575, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464341998100281, gen p mean: -0.06021730601787567, mean p set: 0.44691455364227295
loss_pred:0.015958789736032486, decouple_loss:0.0011073579080402851
The modified gen p mean: 0.44745326042175293, gen p mean: -0.05984355881810188, mean p set: 0.44793352484703064The modified gen p mean: 0.44770193099975586, gen p mean: -0.06595104187726974, mean p set: 0.44818219542503357
loss_pred:0.01629396341741085, decouple_loss:0.0011601848527789116
loss_pred:0.016414644196629524, decouple_loss:0.0010920485947281122
Iteration: 3576, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478360414505005, gen p mean: -0.058016177266836166, mean p set: 0.4483163356781006
loss_pred:0.01619867980480194, decouple_loss:0.001140414155088365
The modified gen p mean: 0.4478738307952881, gen p mean: -0.060832563787698746, mean p set: 0.4483541250228882The modified gen p mean: 0.44656720757484436, gen p mean: -0.05903077498078346, mean p set: 0.44704747200012207
loss_pred:0.01633390039205551, decouple_loss:0.0010335451224818826
loss_pred:0.01621452160179615, decouple_loss:0.0011560257989913225
Iteration: 3577, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44685637950897217, gen p mean: -0.05844000354409218, mean p set: 0.44733667373657227
loss_pred:0.0170703437179327, decouple_loss:0.0011342029320076108
The modified gen p mean: 0.4457213878631592, gen p mean: -0.055458854883909225, mean p set: 0.44620171189308167The modified gen p mean: 0.4470093846321106, gen p mean: -0.05624585226178169, mean p set: 0.4474896788597107
loss_pred:0.016761980950832367, decouple_loss:0.0010772719979286194
loss_pred:0.01612161658704281, decouple_loss:0.0010716223623603582
Iteration: 3578, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475785195827484, gen p mean: -0.06261187046766281, mean p set: 0.4480588138103485
loss_pred:0.016693037003278732, decouple_loss:0.001094984938390553
The modified gen p mean: 0.44683387875556946, gen p mean: -0.05939698591828346, mean p set: 0.44731420278549194The modified gen p mean: 0.44541826844215393, gen p mean: -0.05757812038064003, mean p set: 0.44589856266975403
loss_pred:0.016492094844579697, decouple_loss:0.0010740722063928843
loss_pred:0.0166579931974411, decouple_loss:0.0013650772161781788
Iteration: 3579, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44697073101997375, gen p mean: -0.05520129203796387, mean p set: 0.44745099544525146
loss_pred:0.016612974926829338, decouple_loss:0.0011005715932697058
The modified gen p mean: 0.44716978073120117, gen p mean: -0.05585753545165062, mean p set: 0.4476500451564789The modified gen p mean: 0.4461279511451721, gen p mean: -0.062381431460380554, mean p set: 0.4466082453727722
loss_pred:0.01643354818224907, decouple_loss:0.0010496653849259019
loss_pred:0.015847401693463326, decouple_loss:0.0010925494134426117
Iteration: 3580, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44684791564941406, gen p mean: -0.05098765343427658, mean p set: 0.44732820987701416
loss_pred:0.017038118094205856, decouple_loss:0.0011354698799550533
The modified gen p mean: 0.4462960660457611, gen p mean: -0.06147005036473274, mean p set: 0.4467763900756836The modified gen p mean: 0.4481044113636017, gen p mean: -0.05285619571805, mean p set: 0.4485847055912018
loss_pred:0.016271058470010757, decouple_loss:0.0013100119540467858
loss_pred:0.01649693213403225, decouple_loss:0.0010905283270403743
2023-05-02 16:09:21 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.055806826800107956, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.05192074552178383, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.0521220900118351, mean p set: 0.4500633478164673
loss_pred:0.018435418605804443, decouple_loss:0.001089485245756805
loss_pred:0.01737944409251213, decouple_loss:0.0010556427296251059
loss_pred:0.017405537888407707, decouple_loss:0.0010341521119698882
WV_0_PC_1_EH_0_PS_40, loss: 0.017793122678995132, avg_mse: 0.025663107633590698
current test mse: 0.025663
Iteration: 3581, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4461621940135956, gen p mean: -0.054437920451164246, mean p set: 0.4466424882411957
The modified gen p mean: 0.44811344146728516, gen p mean: -0.05456359684467316, mean p set: 0.44859373569488525
The modified gen p mean: 0.4463559091091156, gen p mean: -0.05602254718542099, mean p set: 0.4468361735343933
loss_pred:0.016359563916921616, decouple_loss:0.0010758662829175591
loss_pred:0.016609061509370804, decouple_loss:0.0011216524289920926
loss_pred:0.016361117362976074, decouple_loss:0.0010564191034063697
Iteration: 3582, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44766369462013245, gen p mean: -0.05405325070023537, mean p set: 0.44814398884773254
loss_pred:0.01601773500442505, decouple_loss:0.0010845749638974667
The modified gen p mean: 0.44784942269325256, gen p mean: -0.05815120413899422, mean p set: 0.44832971692085266The modified gen p mean: 0.44676896929740906, gen p mean: -0.04877808690071106, mean p set: 0.44724923372268677
loss_pred:0.01671687886118889, decouple_loss:0.0011719524627551436
loss_pred:0.016524743288755417, decouple_loss:0.0010759099386632442
Iteration: 3583, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44740989804267883, gen p mean: -0.052808117121458054, mean p set: 0.44789019227027893
loss_pred:0.016163643449544907, decouple_loss:0.0012086430797353387
The modified gen p mean: 0.44561466574668884, gen p mean: -0.05142230913043022, mean p set: 0.44609498977661133The modified gen p mean: 0.445504754781723, gen p mean: -0.05799535661935806, mean p set: 0.4459850490093231
loss_pred:0.01645367220044136, decouple_loss:0.0011852484894916415
loss_pred:0.015923740342259407, decouple_loss:0.0012393160723149776
Iteration: 3584, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477715492248535, gen p mean: -0.0536993034183979, mean p set: 0.4482518434524536
loss_pred:0.016148800030350685, decouple_loss:0.0010198192903771996
The modified gen p mean: 0.44539394974708557, gen p mean: -0.053756218403577805, mean p set: 0.44587424397468567The modified gen p mean: 0.4469396471977234, gen p mean: -0.05441874638199806, mean p set: 0.4474199414253235
loss_pred:0.01670406013727188, decouple_loss:0.0013173609040677547
loss_pred:0.016941789537668228, decouple_loss:0.0010684452718123794
Iteration: 3585, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44735226035118103, gen p mean: -0.0566750168800354, mean p set: 0.4478325843811035
loss_pred:0.016621259972453117, decouple_loss:0.0013641479890793562
The modified gen p mean: 0.44713306427001953, gen p mean: -0.05298400670289993, mean p set: 0.44761335849761963The modified gen p mean: 0.4461262822151184, gen p mean: -0.05348761007189751, mean p set: 0.4466065764427185
loss_pred:0.01705032028257847, decouple_loss:0.001380769768729806
loss_pred:0.01612803526222706, decouple_loss:0.0013589027803391218
Iteration: 3586, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44816336035728455, gen p mean: -0.055000633001327515, mean p set: 0.44864365458488464
loss_pred:0.015974394977092743, decouple_loss:0.0009806775487959385
The modified gen p mean: 0.4458533823490143, gen p mean: -0.05322811380028725, mean p set: 0.4463336765766144The modified gen p mean: 0.4464193284511566, gen p mean: -0.05240827426314354, mean p set: 0.4468995928764343
loss_pred:0.01640775240957737, decouple_loss:0.001137463259510696
loss_pred:0.016358954831957817, decouple_loss:0.0011101344134658575
Iteration: 3587, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489671587944031, gen p mean: -0.049656208604574203, mean p set: 0.4494474530220032
loss_pred:0.01658737286925316, decouple_loss:0.0010764250764623284
The modified gen p mean: 0.4460795521736145, gen p mean: -0.05229941010475159, mean p set: 0.4465598464012146The modified gen p mean: 0.4478876292705536, gen p mean: -0.052681174129247665, mean p set: 0.4483678936958313
loss_pred:0.015918901190161705, decouple_loss:0.0012648359406739473
loss_pred:0.01605180837213993, decouple_loss:0.0012181620113551617
Iteration: 3588, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.445453941822052, gen p mean: -0.056903231889009476, mean p set: 0.4459342360496521
loss_pred:0.0159576628357172, decouple_loss:0.0011651329696178436
The modified gen p mean: 0.44663065671920776, gen p mean: -0.05716276168823242, mean p set: 0.4471109211444855The modified gen p mean: 0.44718998670578003, gen p mean: -0.05348075553774834, mean p set: 0.4476702809333801
loss_pred:0.016490675508975983, decouple_loss:0.0011206453200429678
loss_pred:0.015892120078206062, decouple_loss:0.0011073449859395623
Iteration: 3589, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446615993976593, gen p mean: -0.04723597317934036, mean p set: 0.4470962882041931
loss_pred:0.01695956289768219, decouple_loss:0.0011406650301069021
The modified gen p mean: 0.4480862617492676, gen p mean: -0.052363473922014236, mean p set: 0.4485665559768677The modified gen p mean: 0.4466838240623474, gen p mean: -0.052877236157655716, mean p set: 0.4471641182899475
loss_pred:0.016404712572693825, decouple_loss:0.0011125822784379125
loss_pred:0.01657094806432724, decouple_loss:0.001081698341295123
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012006_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012006_3_24hr.npz
NaN value num: 0
Iteration: 3590, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483039975166321, gen p mean: -0.052231207489967346, mean p set: 0.4487842917442322
loss_pred:0.0170250553637743, decouple_loss:0.0011163196759298444
The modified gen p mean: 0.4470460116863251, gen p mean: -0.05248481407761574, mean p set: 0.4475262761116028The modified gen p mean: 0.4485129117965698, gen p mean: -0.050759825855493546, mean p set: 0.44899317622184753
loss_pred:0.01690954901278019, decouple_loss:0.0013441562186926603
loss_pred:0.015914276242256165, decouple_loss:0.0011110296472907066
2023-05-02 16:11:49 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.05227673053741455, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04838266223669052, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.048340994864702225, mean p set: 0.4500633478164673
loss_pred:0.018352432176470757, decouple_loss:0.0012876190012320876
loss_pred:0.017327647656202316, decouple_loss:0.001296314294449985
loss_pred:0.01738671399652958, decouple_loss:0.0012903449824079871
WV_0_PC_1_EH_0_PS_40, loss: 0.01775350421667099, avg_mse: 0.025573140010237694
current test mse: 0.025573
Iteration: 3591, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44811561703681946, gen p mean: -0.05242475867271423, mean p set: 0.44859588146209717
The modified gen p mean: 0.44832828640937805, gen p mean: -0.04561646655201912, mean p set: 0.44880858063697815
The modified gen p mean: 0.44967159628868103, gen p mean: -0.05109528452157974, mean p set: 0.45015189051628113
loss_pred:0.01671580970287323, decouple_loss:0.0013245511800050735
loss_pred:0.01670221984386444, decouple_loss:0.001060308306477964
loss_pred:0.0159849151968956, decouple_loss:0.0011990118073299527
Iteration: 3592, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447347491979599, gen p mean: -0.052863556891679764, mean p set: 0.4478277862071991
loss_pred:0.01730760559439659, decouple_loss:0.0011216450948268175
The modified gen p mean: 0.4489961862564087, gen p mean: -0.05281733348965645, mean p set: 0.4494765102863312The modified gen p mean: 0.44731876254081726, gen p mean: -0.04818835109472275, mean p set: 0.44779905676841736
loss_pred:0.01528107188642025, decouple_loss:0.0011776365572586656
loss_pred:0.01695583388209343, decouple_loss:0.0011636997805908322
Iteration: 3593, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477471709251404, gen p mean: -0.054233137518167496, mean p set: 0.4482274651527405
loss_pred:0.017294159159064293, decouple_loss:0.001029314356856048
The modified gen p mean: 0.44690850377082825, gen p mean: -0.053832072764635086, mean p set: 0.44738876819610596The modified gen p mean: 0.44909271597862244, gen p mean: -0.05279029533267021, mean p set: 0.44957301020622253
loss_pred:0.01656165160238743, decouple_loss:0.0009650392457842827
loss_pred:0.01730876788496971, decouple_loss:0.001182683277875185
Iteration: 3594, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44750961661338806, gen p mean: -0.05249635502696037, mean p set: 0.44798994064331055
loss_pred:0.016600580886006355, decouple_loss:0.001105471863411367
The modified gen p mean: 0.44778746366500854, gen p mean: -0.0564907044172287, mean p set: 0.44826775789260864The modified gen p mean: 0.4474138915538788, gen p mean: -0.05610562860965729, mean p set: 0.44789421558380127
loss_pred:0.017188474535942078, decouple_loss:0.0009718216606415808
loss_pred:0.016337202861905098, decouple_loss:0.0011418471112847328
Iteration: 3595, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44717171788215637, gen p mean: -0.05778699368238449, mean p set: 0.4476519823074341
loss_pred:0.015675926581025124, decouple_loss:0.0009297719807364047
The modified gen p mean: 0.4486241340637207, gen p mean: -0.05189085751771927, mean p set: 0.4491044282913208The modified gen p mean: 0.4465521275997162, gen p mean: -0.06151270493865013, mean p set: 0.4470324218273163
loss_pred:0.015950452536344528, decouple_loss:0.0008963571162894368
loss_pred:0.016512274742126465, decouple_loss:0.0009451023070141673
Iteration: 3596, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485624432563782, gen p mean: -0.055982399731874466, mean p set: 0.44904273748397827
loss_pred:0.015870653092861176, decouple_loss:0.001154925674200058
The modified gen p mean: 0.4497276246547699, gen p mean: -0.059560853987932205, mean p set: 0.45020791888237The modified gen p mean: 0.44914892315864563, gen p mean: -0.05856615677475929, mean p set: 0.4496292173862457
loss_pred:0.0160316564142704, decouple_loss:0.001010384177789092
loss_pred:0.01626703329384327, decouple_loss:0.001094959443435073
Iteration: 3597, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44698935747146606, gen p mean: -0.05602128431200981, mean p set: 0.44746968150138855
loss_pred:0.01612069457769394, decouple_loss:0.0009515868732705712
The modified gen p mean: 0.44717299938201904, gen p mean: -0.05547168105840683, mean p set: 0.44765329360961914The modified gen p mean: 0.4469222128391266, gen p mean: -0.05649194121360779, mean p set: 0.4474024772644043
loss_pred:0.01666671596467495, decouple_loss:0.0009627192630432546
loss_pred:0.016389494761824608, decouple_loss:0.0010660842526704073
Iteration: 3598, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44813400506973267, gen p mean: -0.057108618319034576, mean p set: 0.44861429929733276
loss_pred:0.01582586020231247, decouple_loss:0.0010324587346985936
The modified gen p mean: 0.44772812724113464, gen p mean: -0.05673500522971153, mean p set: 0.44820842146873474The modified gen p mean: 0.44807925820350647, gen p mean: -0.05278699845075607, mean p set: 0.44855955243110657
loss_pred:0.016714854165911674, decouple_loss:0.0011716820299625397
loss_pred:0.016128582879900932, decouple_loss:0.0009789313189685345
Iteration: 3599, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44772279262542725, gen p mean: -0.05214935541152954, mean p set: 0.44820311665534973
loss_pred:0.0162416473031044, decouple_loss:0.001160327112302184
The modified gen p mean: 0.447131872177124, gen p mean: -0.0515054427087307, mean p set: 0.44761213660240173The modified gen p mean: 0.44786950945854187, gen p mean: -0.0516953207552433, mean p set: 0.44834980368614197
loss_pred:0.016873151063919067, decouple_loss:0.0010845862561836839
loss_pred:0.017429253086447716, decouple_loss:0.0010993574978783727
Iteration: 3600, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44918811321258545, gen p mean: -0.048126257956027985, mean p set: 0.44966837763786316
loss_pred:0.016350533813238144, decouple_loss:0.0010398010490462184
The modified gen p mean: 0.4474939703941345, gen p mean: -0.05157848820090294, mean p set: 0.447974294424057The modified gen p mean: 0.4498458504676819, gen p mean: -0.050690896809101105, mean p set: 0.45032617449760437
loss_pred:0.015632882714271545, decouple_loss:0.0010221151169389486
loss_pred:0.016348781064152718, decouple_loss:0.0010199083480983973
2023-05-02 16:13:44 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.05313368886709213, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04936586320400238, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04940957576036453, mean p set: 0.4500633478164673
loss_pred:0.018250735476613045, decouple_loss:0.0012190184788778424
loss_pred:0.017212698236107826, decouple_loss:0.001024036668241024
loss_pred:0.01730073243379593, decouple_loss:0.0010971645824611187
WV_0_PC_1_EH_0_PS_40, loss: 0.017643727362155914, avg_mse: 0.025374168530106544
current test mse: 0.025374
Iteration: 3601, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493913948535919, gen p mean: -0.05354529246687889, mean p set: 0.4498717188835144
The modified gen p mean: 0.4474185109138489, gen p mean: -0.05068398267030716, mean p set: 0.44789883494377136
The modified gen p mean: 0.44835197925567627, gen p mean: -0.05090866982936859, mean p set: 0.448832243680954
loss_pred:0.017546823248267174, decouple_loss:0.0010896255262196064
loss_pred:0.016420157626271248, decouple_loss:0.001031483057886362
loss_pred:0.01729700341820717, decouple_loss:0.0009794594952836633
Iteration: 3602, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487006664276123, gen p mean: -0.04601103439927101, mean p set: 0.4491809606552124
loss_pred:0.01587977446615696, decouple_loss:0.0010095316683873534
The modified gen p mean: 0.4469853341579437, gen p mean: -0.052280135452747345, mean p set: 0.4474656283855438The modified gen p mean: 0.44697391986846924, gen p mean: -0.050127919763326645, mean p set: 0.44745421409606934
loss_pred:0.01576612889766693, decouple_loss:0.0010107632260769606
loss_pred:0.015927443280816078, decouple_loss:0.0010575614869594574
Iteration: 3603, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447256863117218, gen p mean: -0.05114835873246193, mean p set: 0.4477371573448181
loss_pred:0.01568814553320408, decouple_loss:0.0010428036330267787
The modified gen p mean: 0.4469103217124939, gen p mean: -0.04953857883810997, mean p set: 0.447390615940094The modified gen p mean: 0.4479990005493164, gen p mean: -0.05212879553437233, mean p set: 0.4484792649745941
loss_pred:0.017013538628816605, decouple_loss:0.0010327222989872098
loss_pred:0.016460206359624863, decouple_loss:0.0009948642691597342
Iteration: 3604, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447129487991333, gen p mean: -0.05215425416827202, mean p set: 0.4476097822189331
loss_pred:0.01683804579079151, decouple_loss:0.0012324656127020717
The modified gen p mean: 0.44647037982940674, gen p mean: -0.05047718435525894, mean p set: 0.44695067405700684The modified gen p mean: 0.4487018585205078, gen p mean: -0.051575228571891785, mean p set: 0.4491821527481079
loss_pred:0.01658570021390915, decouple_loss:0.000964603153988719
loss_pred:0.015303474850952625, decouple_loss:0.0010669294279068708
Iteration: 3605, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44787687063217163, gen p mean: -0.050107792019844055, mean p set: 0.44835713505744934
loss_pred:0.016376174986362457, decouple_loss:0.0010173179907724261
The modified gen p mean: 0.44660404324531555, gen p mean: -0.05713013559579849, mean p set: 0.44708430767059326The modified gen p mean: 0.4501868486404419, gen p mean: -0.05009396746754646, mean p set: 0.450667142868042
loss_pred:0.016371486708521843, decouple_loss:0.0010274670785292983
loss_pred:0.016406742855906487, decouple_loss:0.0010829034727066755
Iteration: 3606, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491839110851288, gen p mean: -0.052013371139764786, mean p set: 0.4496642053127289
The modified gen p mean: 0.44930100440979004, gen p mean: -0.05068023502826691, mean p set: 0.4497813284397125
loss_pred:0.015974359586834908, decouple_loss:0.0009570536785759032
loss_pred:0.01624075323343277, decouple_loss:0.001026924466714263
The modified gen p mean: 0.44879695773124695, gen p mean: -0.04641813784837723, mean p set: 0.44927728176116943
loss_pred:0.015623917803168297, decouple_loss:0.0010989522561430931
Iteration: 3607, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44830429553985596, gen p mean: -0.054748985916376114, mean p set: 0.44878458976745605
loss_pred:0.015457501634955406, decouple_loss:0.0011177337728440762
The modified gen p mean: 0.4475036561489105, gen p mean: -0.04954883083701134, mean p set: 0.4479839503765106The modified gen p mean: 0.44814759492874146, gen p mean: -0.04672059044241905, mean p set: 0.44862788915634155
loss_pred:0.017070814967155457, decouple_loss:0.0010526289697736502
loss_pred:0.0154613321647048, decouple_loss:0.0012126563815400004
Iteration: 3608, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44690951704978943, gen p mean: -0.05517497658729553, mean p set: 0.4473898112773895
loss_pred:0.015652665868401527, decouple_loss:0.0010121628874912858
The modified gen p mean: 0.4483188986778259, gen p mean: -0.05620777606964111, mean p set: 0.44879916310310364The modified gen p mean: 0.44916045665740967, gen p mean: -0.04944063723087311, mean p set: 0.44964075088500977
loss_pred:0.01603909395635128, decouple_loss:0.0010630851611495018
loss_pred:0.016725879162549973, decouple_loss:0.001087829703465104
Iteration: 3609, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474733769893646, gen p mean: -0.054802536964416504, mean p set: 0.4479536712169647
The modified gen p mean: 0.447294145822525, gen p mean: -0.054726406931877136, mean p set: 0.4477744400501251
loss_pred:0.016766205430030823, decouple_loss:0.001155984471552074
loss_pred:0.016274673864245415, decouple_loss:0.0010606470750644803
The modified gen p mean: 0.44792258739471436, gen p mean: -0.05397345870733261, mean p set: 0.44840285181999207
loss_pred:0.016749929636716843, decouple_loss:0.0010178330121561885
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012018_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012018_3_24hr.npz
NaN value num: 0
Iteration: 3610, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495515525341034, gen p mean: -0.04875834658741951, mean p set: 0.4500318169593811
loss_pred:0.015611769631505013, decouple_loss:0.001043533207848668
The modified gen p mean: 0.44887346029281616, gen p mean: -0.048922013491392136, mean p set: 0.44935378432273865The modified gen p mean: 0.44721996784210205, gen p mean: -0.053134407848119736, mean p set: 0.44770026206970215
loss_pred:0.016419565305113792, decouple_loss:0.0010420860489830375
loss_pred:0.016857923939824104, decouple_loss:0.0010783409234136343
2023-05-02 16:16:18 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.054595429450273514, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.05077693238854408, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.0509587898850441, mean p set: 0.4500633478164673
loss_pred:0.01726183108985424, decouple_loss:0.001009992090985179
loss_pred:0.01828891783952713, decouple_loss:0.0010410809190943837
loss_pred:0.01735614240169525, decouple_loss:0.0009505631751380861
WV_0_PC_1_EH_0_PS_40, loss: 0.017685657367110252, avg_mse: 0.0254520270973444
current test mse: 0.025452
Iteration: 3611, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476563334465027, gen p mean: -0.04973773658275604, mean p set: 0.4481366276741028
The modified gen p mean: 0.4503830373287201, gen p mean: -0.05080113932490349, mean p set: 0.4508633017539978
The modified gen p mean: 0.4490949511528015, gen p mean: -0.04920447990298271, mean p set: 0.449575275182724
loss_pred:0.016170332208275795, decouple_loss:0.0009355596848763525
loss_pred:0.015894941985607147, decouple_loss:0.0009414116502739489
loss_pred:0.015522624365985394, decouple_loss:0.0009720829548314214
Iteration: 3612, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473567008972168, gen p mean: -0.049660488963127136, mean p set: 0.4478370249271393
loss_pred:0.01635848730802536, decouple_loss:0.0009584657964296639
The modified gen p mean: 0.44830670952796936, gen p mean: -0.051788121461868286, mean p set: 0.44878700375556946The modified gen p mean: 0.44672706723213196, gen p mean: -0.04698145389556885, mean p set: 0.44720733165740967
loss_pred:0.01623476855456829, decouple_loss:0.0009363691788166761
loss_pred:0.016340970993041992, decouple_loss:0.0009645595564506948
Iteration: 3613, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448026180267334, gen p mean: -0.052410323172807693, mean p set: 0.4485064744949341
loss_pred:0.016077524051070213, decouple_loss:0.0010889485711231828
The modified gen p mean: 0.44801101088523865, gen p mean: -0.04855906590819359, mean p set: 0.44849130511283875The modified gen p mean: 0.44825199246406555, gen p mean: -0.05153556540608406, mean p set: 0.44873231649398804
loss_pred:0.015831060707569122, decouple_loss:0.0009600413031876087
loss_pred:0.015428525395691395, decouple_loss:0.000913273252081126
Iteration: 3614, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44918984174728394, gen p mean: -0.04961632564663887, mean p set: 0.44967013597488403
loss_pred:0.01550222747027874, decouple_loss:0.0009749969467520714
The modified gen p mean: 0.44624578952789307, gen p mean: -0.0547453947365284, mean p set: 0.44672608375549316The modified gen p mean: 0.44797590374946594, gen p mean: -0.04828780144453049, mean p set: 0.44845619797706604
loss_pred:0.016469161957502365, decouple_loss:0.0010929300915449858
loss_pred:0.01490667276084423, decouple_loss:0.0009505648631602526
Iteration: 3615, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44652047753334045, gen p mean: -0.05000367388129234, mean p set: 0.44700080156326294
loss_pred:0.016993390396237373, decouple_loss:0.0009955965215340257
The modified gen p mean: 0.4480954706668854, gen p mean: -0.048590898513793945, mean p set: 0.4485757648944855The modified gen p mean: 0.44796857237815857, gen p mean: -0.055728744715452194, mean p set: 0.4484488368034363
loss_pred:0.01565110683441162, decouple_loss:0.001111568883061409
loss_pred:0.01597844809293747, decouple_loss:0.0010456254240125418
Iteration: 3616, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44906744360923767, gen p mean: -0.051108673214912415, mean p set: 0.4495477080345154
loss_pred:0.015731044113636017, decouple_loss:0.0010426049120724201
The modified gen p mean: 0.4483500123023987, gen p mean: -0.04901249334216118, mean p set: 0.4488303065299988The modified gen p mean: 0.44850054383277893, gen p mean: -0.05303725227713585, mean p set: 0.44898083806037903
loss_pred:0.01554819568991661, decouple_loss:0.0010131606832146645
loss_pred:0.016213789582252502, decouple_loss:0.0009940853342413902
Iteration: 3617, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472379982471466, gen p mean: -0.04786613583564758, mean p set: 0.4477182924747467
loss_pred:0.0168134905397892, decouple_loss:0.0012505685444921255
The modified gen p mean: 0.44797283411026, gen p mean: -0.04847508668899536, mean p set: 0.4484530985355377The modified gen p mean: 0.44753506779670715, gen p mean: -0.04846637696027756, mean p set: 0.44801533222198486
loss_pred:0.015414278022944927, decouple_loss:0.0010767737403512
loss_pred:0.015482500195503235, decouple_loss:0.0009921106975525618
Iteration: 3618, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44826894998550415, gen p mean: -0.04802122712135315, mean p set: 0.44874924421310425
loss_pred:0.015673931688070297, decouple_loss:0.0010485195089131594
The modified gen p mean: 0.44676050543785095, gen p mean: -0.05220380052924156, mean p set: 0.44724079966545105The modified gen p mean: 0.45025891065597534, gen p mean: -0.05021665617823601, mean p set: 0.4507392346858978
loss_pred:0.01672370359301567, decouple_loss:0.00102903600782156
loss_pred:0.015394529327750206, decouple_loss:0.0009969092207029462
Iteration: 3619, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470476806163788, gen p mean: -0.05180175229907036, mean p set: 0.4475279748439789
loss_pred:0.016481684520840645, decouple_loss:0.001095155137591064
The modified gen p mean: 0.4461364150047302, gen p mean: -0.05094779655337334, mean p set: 0.4466167390346527The modified gen p mean: 0.4475128948688507, gen p mean: -0.04681997001171112, mean p set: 0.4479931592941284
loss_pred:0.01652599312365055, decouple_loss:0.0010822941549122334
loss_pred:0.015518102794885635, decouple_loss:0.0012171645648777485
Iteration: 3620, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480680525302887, gen p mean: -0.056305233389139175, mean p set: 0.4485483467578888
loss_pred:0.016047416254878044, decouple_loss:0.0010830349056050181
The modified gen p mean: 0.4465082287788391, gen p mean: -0.04827595129609108, mean p set: 0.4469884932041168The modified gen p mean: 0.44760385155677795, gen p mean: -0.049025487154722214, mean p set: 0.44808417558670044
loss_pred:0.01594965159893036, decouple_loss:0.0009738131775520742
loss_pred:0.016416611149907112, decouple_loss:0.0010461232159286737
2023-05-02 16:18:12 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.05104479566216469, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.047458257526159286, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04782357066869736, mean p set: 0.4500633478164673
loss_pred:0.018534138798713684, decouple_loss:0.0010721052531152964
loss_pred:0.01739487610757351, decouple_loss:0.0011152438819408417
loss_pred:0.0175105482339859, decouple_loss:0.0010692584328353405
WV_0_PC_1_EH_0_PS_40, loss: 0.017867466434836388, avg_mse: 0.025794072076678276
current test mse: 0.025794
Iteration: 3621, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44806063175201416, gen p mean: -0.05323953554034233, mean p set: 0.44854092597961426
The modified gen p mean: 0.44757699966430664, gen p mean: -0.050053659826517105, mean p set: 0.44805729389190674
The modified gen p mean: 0.4492214322090149, gen p mean: -0.046146415174007416, mean p set: 0.4497016966342926
loss_pred:0.01595498062670231, decouple_loss:0.0009914662223309278
loss_pred:0.0160105861723423, decouple_loss:0.0010379571467638016
loss_pred:0.015913423150777817, decouple_loss:0.0010390282841399312
Iteration: 3622, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44762122631073, gen p mean: -0.04811305180191994, mean p set: 0.4481014907360077
loss_pred:0.01632443256676197, decouple_loss:0.001096883905120194
The modified gen p mean: 0.447700172662735, gen p mean: -0.04530300945043564, mean p set: 0.4481804668903351
The modified gen p mean: 0.44772714376449585, gen p mean: -0.04913056641817093, mean p set: 0.44820740818977356
loss_pred:0.015924571081995964, decouple_loss:0.001202610321342945
loss_pred:0.015867847949266434, decouple_loss:0.0010352232493460178
Iteration: 3623, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44899240136146545, gen p mean: -0.04435648024082184, mean p set: 0.44947269558906555
loss_pred:0.01600288413465023, decouple_loss:0.0010258955880999565
The modified gen p mean: 0.4482826292514801, gen p mean: -0.05513225495815277, mean p set: 0.4487628936767578The modified gen p mean: 0.4478619396686554, gen p mean: -0.04945516958832741, mean p set: 0.4483422338962555
loss_pred:0.015962088480591774, decouple_loss:0.0010080778738483787
loss_pred:0.015978064388036728, decouple_loss:0.0010775021510198712
Iteration: 3624, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44938093423843384, gen p mean: -0.05244011431932449, mean p set: 0.44986119866371155
loss_pred:0.01579127088189125, decouple_loss:0.0012321027461439371
The modified gen p mean: 0.4483039677143097, gen p mean: -0.05083339288830757, mean p set: 0.4487842321395874The modified gen p mean: 0.4461628794670105, gen p mean: -0.04625830054283142, mean p set: 0.4466431736946106
loss_pred:0.0156555138528347, decouple_loss:0.0010118454229086637
loss_pred:0.016691116616129875, decouple_loss:0.001030587125569582
Iteration: 3625, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485817849636078, gen p mean: -0.053545158356428146, mean p set: 0.4490620791912079
loss_pred:0.016548609361052513, decouple_loss:0.0010092027951031923
The modified gen p mean: 0.44710925221443176, gen p mean: -0.054826702922582626, mean p set: 0.44758954644203186The modified gen p mean: 0.44777607917785645, gen p mean: -0.05221656709909439, mean p set: 0.44825637340545654
loss_pred:0.016195345669984818, decouple_loss:0.001050876802764833
loss_pred:0.01565733179450035, decouple_loss:0.0009817805839702487
Iteration: 3626, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44812726974487305, gen p mean: -0.04851201921701431, mean p set: 0.44860756397247314
loss_pred:0.01515841856598854, decouple_loss:0.0010007632663473487
The modified gen p mean: 0.44820618629455566, gen p mean: -0.05010729655623436, mean p set: 0.44868648052215576The modified gen p mean: 0.44722893834114075, gen p mean: -0.05357002466917038, mean p set: 0.44770923256874084
loss_pred:0.01640442945063114, decouple_loss:0.000982489320449531
loss_pred:0.015458870679140091, decouple_loss:0.0010106819681823254
Iteration: 3627, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467930793762207, gen p mean: -0.0526682510972023, mean p set: 0.4472734034061432
loss_pred:0.016831807792186737, decouple_loss:0.0011706793447956443
The modified gen p mean: 0.4488983452320099, gen p mean: -0.052254874259233475, mean p set: 0.4493786096572876The modified gen p mean: 0.4474814534187317, gen p mean: -0.04964444413781166, mean p set: 0.4479617476463318
loss_pred:0.015427403151988983, decouple_loss:0.0010774325346574187
loss_pred:0.0153024448081851, decouple_loss:0.0009659544448368251
Iteration: 3628, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467003345489502, gen p mean: -0.05415859818458557, mean p set: 0.4471806287765503
loss_pred:0.01609625481069088, decouple_loss:0.0010331491939723492
The modified gen p mean: 0.44810646772384644, gen p mean: -0.05419354513287544, mean p set: 0.4485867917537689The modified gen p mean: 0.4481285512447357, gen p mean: -0.05095820501446724, mean p set: 0.4486088454723358
loss_pred:0.01583295501768589, decouple_loss:0.0010684620356187224
loss_pred:0.015503458678722382, decouple_loss:0.001065417192876339
Iteration: 3629, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488906264305115, gen p mean: -0.04610011726617813, mean p set: 0.44937095046043396
loss_pred:0.01594606414437294, decouple_loss:0.0010089694987982512
The modified gen p mean: 0.4473099708557129, gen p mean: -0.05337575078010559, mean p set: 0.447790265083313The modified gen p mean: 0.44583308696746826, gen p mean: -0.054060619324445724, mean p set: 0.44631341099739075
loss_pred:0.015731913968920708, decouple_loss:0.0010730979265645146
loss_pred:0.016414258629083633, decouple_loss:0.0010648159077391028
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012019_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012019_3_24hr.npz
NaN value num: 0
Iteration: 3630, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44836917519569397, gen p mean: -0.04974677041172981, mean p set: 0.44884949922561646
loss_pred:0.014735438860952854, decouple_loss:0.001011617947369814
The modified gen p mean: 0.4480297267436981, gen p mean: -0.05250827968120575, mean p set: 0.44850999116897583The modified gen p mean: 0.4492380619049072, gen p mean: -0.04794104024767876, mean p set: 0.4497183561325073
loss_pred:0.01436545979231596, decouple_loss:0.0010911350836977363
loss_pred:0.01477082073688507, decouple_loss:0.0010835137218236923
2023-05-02 16:20:41 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.0516190268099308, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04794730991125107, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04836753383278847, mean p set: 0.4500633478164673
loss_pred:0.01849367842078209, decouple_loss:0.0010787441860884428
loss_pred:0.017439711838960648, decouple_loss:0.0011294996365904808
loss_pred:0.017549920827150345, decouple_loss:0.0010881581110879779
WV_0_PC_1_EH_0_PS_40, loss: 0.017882710322737694, avg_mse: 0.025851640850305557
current test mse: 0.025852
Iteration: 3631, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492708444595337, gen p mean: -0.04817770794034004, mean p set: 0.4497511684894562
The modified gen p mean: 0.4501386880874634, gen p mean: -0.04431738704442978, mean p set: 0.4506189823150635
The modified gen p mean: 0.45080986618995667, gen p mean: -0.04471157491207123, mean p set: 0.45129016041755676
loss_pred:0.014206682331860065, decouple_loss:0.0010691153584048152
loss_pred:0.01447354443371296, decouple_loss:0.0010288081830367446
loss_pred:0.014136028476059437, decouple_loss:0.0011900230310857296
Iteration: 3632, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44837290048599243, gen p mean: -0.04495486989617348, mean p set: 0.44885316491127014
loss_pred:0.014428455382585526, decouple_loss:0.00100810918956995
The modified gen p mean: 0.4485131502151489, gen p mean: -0.049131352454423904, mean p set: 0.448993444442749The modified gen p mean: 0.44893956184387207, gen p mean: -0.048036158084869385, mean p set: 0.4494198262691498
loss_pred:0.014470551162958145, decouple_loss:0.0011064549908041954
loss_pred:0.014184083789587021, decouple_loss:0.0010431234259158373
Iteration: 3633, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488268494606018, gen p mean: -0.04636510834097862, mean p set: 0.4493071436882019
loss_pred:0.014425469562411308, decouple_loss:0.0011086281156167388
The modified gen p mean: 0.45058590173721313, gen p mean: -0.04116901755332947, mean p set: 0.45106619596481323The modified gen p mean: 0.4497874081134796, gen p mean: -0.04553855583071709, mean p set: 0.4502677023410797
loss_pred:0.013701236806809902, decouple_loss:0.001072522485628724
loss_pred:0.014081036671996117, decouple_loss:0.001156495651230216
Iteration: 3634, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44886115193367004, gen p mean: -0.03836178779602051, mean p set: 0.44934147596359253
loss_pred:0.014409814961254597, decouple_loss:0.001019780756905675
The modified gen p mean: 0.4501242935657501, gen p mean: -0.03719562664628029, mean p set: 0.4506046175956726The modified gen p mean: 0.44911807775497437, gen p mean: -0.03921855241060257, mean p set: 0.44959837198257446
loss_pred:0.014526817947626114, decouple_loss:0.0010391687974333763
loss_pred:0.014101198874413967, decouple_loss:0.0009900046279653907
Iteration: 3635, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44858768582344055, gen p mean: -0.03952069953083992, mean p set: 0.44906798005104065
loss_pred:0.0139341214671731, decouple_loss:0.0014201352605596185
The modified gen p mean: 0.4489181935787201, gen p mean: -0.041455432772636414, mean p set: 0.4493984878063202The modified gen p mean: 0.449287086725235, gen p mean: -0.04165099561214447, mean p set: 0.4497673809528351
loss_pred:0.014179438352584839, decouple_loss:0.001266847481019795
loss_pred:0.014015504159033298, decouple_loss:0.0011953163193538785
Iteration: 3636, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44803234934806824, gen p mean: -0.03582872077822685, mean p set: 0.44851261377334595
loss_pred:0.013253672979772091, decouple_loss:0.0011232212418690324
The modified gen p mean: 0.4497798681259155, gen p mean: -0.037707794457674026, mean p set: 0.45026013255119324The modified gen p mean: 0.4496731460094452, gen p mean: -0.035894833505153656, mean p set: 0.4501534700393677
loss_pred:0.014033226296305656, decouple_loss:0.0011182466987520456
loss_pred:0.014139785431325436, decouple_loss:0.0011343075893819332
Iteration: 3637, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480578303337097, gen p mean: -0.04095008596777916, mean p set: 0.4485381245613098
loss_pred:0.014460613951086998, decouple_loss:0.0011377045884728432
The modified gen p mean: 0.44797298312187195, gen p mean: -0.03859522566199303, mean p set: 0.44845327734947205The modified gen p mean: 0.4492749869823456, gen p mean: -0.03324218839406967, mean p set: 0.4497552812099457
loss_pred:0.013306853361427784, decouple_loss:0.0011408639838919044
loss_pred:0.013656837865710258, decouple_loss:0.0011805847752839327
Iteration: 3638, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44874081015586853, gen p mean: -0.0510762482881546, mean p set: 0.449221134185791
loss_pred:0.013447463512420654, decouple_loss:0.0013426546938717365
The modified gen p mean: 0.4490286111831665, gen p mean: -0.04307590425014496, mean p set: 0.4495089054107666The modified gen p mean: 0.4508246183395386, gen p mean: -0.03880952298641205, mean p set: 0.45130491256713867
loss_pred:0.013800994493067265, decouple_loss:0.001207637251354754
loss_pred:0.013735316693782806, decouple_loss:0.0012538356240838766
Iteration: 3639, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501873850822449, gen p mean: -0.04256046935915947, mean p set: 0.45066767930984497
loss_pred:0.014053026214241982, decouple_loss:0.0010372998658567667
The modified gen p mean: 0.4494338631629944, gen p mean: -0.04690517112612724, mean p set: 0.44991418719291687The modified gen p mean: 0.4491962790489197, gen p mean: -0.046491287648677826, mean p set: 0.4496765732765198
loss_pred:0.013770373538136482, decouple_loss:0.0011163658928126097
loss_pred:0.014039586298167706, decouple_loss:0.0011568332556635141
Iteration: 3640, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44948598742485046, gen p mean: -0.051987241953611374, mean p set: 0.44996631145477295
loss_pred:0.01366628147661686, decouple_loss:0.0010508857667446136
The modified gen p mean: 0.4483937621116638, gen p mean: -0.04431232437491417, mean p set: 0.4488740861415863The modified gen p mean: 0.4491842985153198, gen p mean: -0.0447133332490921, mean p set: 0.4496645927429199
loss_pred:0.014028391800820827, decouple_loss:0.0010844626231119037
loss_pred:0.013732057996094227, decouple_loss:0.0010959886712953448
2023-05-02 16:22:36 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.05057746171951294, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04719281569123268, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.0473339781165123, mean p set: 0.4500633478164673
loss_pred:0.01913989894092083, decouple_loss:0.0012221996439620852
loss_pred:0.017895303666591644, decouple_loss:0.0011904430575668812
loss_pred:0.0180277768522501, decouple_loss:0.0012441709404811263
WV_0_PC_1_EH_0_PS_40, loss: 0.01841527596116066, avg_mse: 0.026866689324378967
current test mse: 0.026867
Iteration: 3641, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484655559062958, gen p mean: -0.052304383367300034, mean p set: 0.4489458501338959
The modified gen p mean: 0.4486316740512848, gen p mean: -0.04876923933625221, mean p set: 0.4491119980812073
The modified gen p mean: 0.45090633630752563, gen p mean: -0.04302564263343811, mean p set: 0.45138660073280334
loss_pred:0.013701853342354298, decouple_loss:0.0010978290811181068
loss_pred:0.013507637195289135, decouple_loss:0.0012418446131050587
loss_pred:0.014012332074344158, decouple_loss:0.0011785135138779879
Iteration: 3642, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44860759377479553, gen p mean: -0.048549290746450424, mean p set: 0.44908788800239563
loss_pred:0.014332888647913933, decouple_loss:0.0011860982049256563
The modified gen p mean: 0.4503858983516693, gen p mean: -0.04197290539741516, mean p set: 0.4508661925792694The modified gen p mean: 0.4496931731700897, gen p mean: -0.04670628905296326, mean p set: 0.4501734673976898
loss_pred:0.013645540922880173, decouple_loss:0.0010560734663158655
loss_pred:0.013648821040987968, decouple_loss:0.0010815818095579743
Iteration: 3643, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44822654128074646, gen p mean: -0.0459936298429966, mean p set: 0.44870686531066895
loss_pred:0.014713508076965809, decouple_loss:0.001106539275497198
The modified gen p mean: 0.44903796911239624, gen p mean: -0.04951060935854912, mean p set: 0.4495182931423187The modified gen p mean: 0.4502295255661011, gen p mean: -0.04256634786725044, mean p set: 0.45070981979370117
loss_pred:0.01370416022837162, decouple_loss:0.001071376958861947
loss_pred:0.013448869809508324, decouple_loss:0.0012264003744348884
Iteration: 3644, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500034749507904, gen p mean: -0.0442599356174469, mean p set: 0.4504837691783905
loss_pred:0.013821356929838657, decouple_loss:0.001140429638326168
The modified gen p mean: 0.4488588273525238, gen p mean: -0.04435041546821594, mean p set: 0.4493391215801239The modified gen p mean: 0.449203222990036, gen p mean: -0.04996533319354057, mean p set: 0.4496835172176361
loss_pred:0.013955464586615562, decouple_loss:0.0011222960893064737
loss_pred:0.01341237872838974, decouple_loss:0.0010809414088726044
Iteration: 3645, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44919705390930176, gen p mean: -0.05067772418260574, mean p set: 0.44967731833457947
The modified gen p mean: 0.4506630599498749, gen p mean: -0.043962638825178146, mean p set: 0.451143354177475
loss_pred:0.013392731547355652, decouple_loss:0.0010883425129577518
loss_pred:0.013750500045716763, decouple_loss:0.0010421948973089457
The modified gen p mean: 0.44901034235954285, gen p mean: -0.045773185789585114, mean p set: 0.44949063658714294
loss_pred:0.01351732388138771, decouple_loss:0.001053813612088561
Iteration: 3646, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44926688075065613, gen p mean: -0.04579675942659378, mean p set: 0.4497471749782562
loss_pred:0.012869286350905895, decouple_loss:0.001100838533602655
The modified gen p mean: 0.449836790561676, gen p mean: -0.05351859703660011, mean p set: 0.4503171145915985The modified gen p mean: 0.44936221837997437, gen p mean: -0.05218525603413582, mean p set: 0.4498424530029297
loss_pred:0.013364249840378761, decouple_loss:0.0011474170023575425
loss_pred:0.013762987218797207, decouple_loss:0.0010526953265070915
Iteration: 3647, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494743347167969, gen p mean: -0.046193528920412064, mean p set: 0.44995465874671936
loss_pred:0.013562202453613281, decouple_loss:0.0010433681309223175
The modified gen p mean: 0.4492861032485962, gen p mean: -0.04706962779164314, mean p set: 0.4497663974761963The modified gen p mean: 0.44969239830970764, gen p mean: -0.052726998925209045, mean p set: 0.45017269253730774
loss_pred:0.013515252619981766, decouple_loss:0.0010928342817351222
loss_pred:0.01345561072230339, decouple_loss:0.0009654228924773633
Iteration: 3648, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500710964202881, gen p mean: -0.0478074885904789, mean p set: 0.4505513906478882
loss_pred:0.01344029325991869, decouple_loss:0.0010103699751198292
The modified gen p mean: 0.44965627789497375, gen p mean: -0.05106566101312637, mean p set: 0.45013657212257385The modified gen p mean: 0.4502960443496704, gen p mean: -0.04376838356256485, mean p set: 0.4507763385772705
loss_pred:0.013584221713244915, decouple_loss:0.0010971479350700974
loss_pred:0.01342326682060957, decouple_loss:0.001074702013283968
Iteration: 3649, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45011022686958313, gen p mean: -0.04372286796569824, mean p set: 0.4505905210971832
loss_pred:0.013704824261367321, decouple_loss:0.001082933391444385
The modified gen p mean: 0.44965097308158875, gen p mean: -0.04641272872686386, mean p set: 0.45013123750686646The modified gen p mean: 0.4476586580276489, gen p mean: -0.04984966665506363, mean p set: 0.44813892245292664
loss_pred:0.013778593391180038, decouple_loss:0.0010230997577309608
loss_pred:0.014429385773837566, decouple_loss:0.001146277179941535
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012011_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012011_3_24hr.npz
NaN value num: 0
Iteration: 3650, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44739651679992676, gen p mean: -0.047876641154289246, mean p set: 0.44787678122520447
loss_pred:0.014287800528109074, decouple_loss:0.0010685476008802652
The modified gen p mean: 0.4463250935077667, gen p mean: -0.0470697395503521, mean p set: 0.44680535793304443The modified gen p mean: 0.4479667842388153, gen p mean: -0.05269055441021919, mean p set: 0.4484470784664154
loss_pred:0.01394183561205864, decouple_loss:0.0010359396692365408
loss_pred:0.013739380985498428, decouple_loss:0.0010567291174083948
2023-05-02 16:25:11 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.047723449766635895, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.044392507523298264, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.044649090617895126, mean p set: 0.4500633478164673
loss_pred:0.019038842990994453, decouple_loss:0.0010909284465014935
loss_pred:0.017825467512011528, decouple_loss:0.001137545215897262
loss_pred:0.017919423058629036, decouple_loss:0.0011412989115342498
WV_0_PC_1_EH_0_PS_40, loss: 0.018317408859729767, avg_mse: 0.02672438882291317
current test mse: 0.026724
Iteration: 3651, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4462599456310272, gen p mean: -0.04541858658194542, mean p set: 0.4467402696609497
The modified gen p mean: 0.44609495997428894, gen p mean: -0.04612476006150246, mean p set: 0.4465752840042114
The modified gen p mean: 0.4466908872127533, gen p mean: -0.049575742334127426, mean p set: 0.4471711814403534
loss_pred:0.013859249651432037, decouple_loss:0.0010803575860336423
loss_pred:0.014194058254361153, decouple_loss:0.001008890918456018
loss_pred:0.014007266610860825, decouple_loss:0.0010677655227482319
Iteration: 3652, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44751569628715515, gen p mean: -0.04644422605633736, mean p set: 0.44799599051475525
loss_pred:0.01343509554862976, decouple_loss:0.0011296682059764862
The modified gen p mean: 0.4483022391796112, gen p mean: -0.04177100956439972, mean p set: 0.4487825632095337The modified gen p mean: 0.44859594106674194, gen p mean: -0.04580869898200035, mean p set: 0.44907623529434204
loss_pred:0.013712085783481598, decouple_loss:0.0011405999539420009
loss_pred:0.014476806856691837, decouple_loss:0.0011342224897816777
Iteration: 3653, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44625362753868103, gen p mean: -0.0431031659245491, mean p set: 0.44673389196395874
The modified gen p mean: 0.44885820150375366, gen p mean: -0.04587288573384285, mean p set: 0.44933852553367615
loss_pred:0.013731568120419979, decouple_loss:0.0009672235464677215
loss_pred:0.013979102484881878, decouple_loss:0.0011016082717105746
The modified gen p mean: 0.44582533836364746, gen p mean: -0.040549375116825104, mean p set: 0.44630563259124756
loss_pred:0.013482334092259407, decouple_loss:0.0011051358887925744
Iteration: 3654, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44879671931266785, gen p mean: -0.04298379272222519, mean p set: 0.44927704334259033The modified gen p mean: 0.4452894926071167, gen p mean: -0.04567546769976616, mean p set: 0.4457697868347168
loss_pred:0.013746591284871101, decouple_loss:0.0010517939226701856loss_pred:0.013943945057690144, decouple_loss:0.001179704093374312
The modified gen p mean: 0.44883668422698975, gen p mean: -0.04240340366959572, mean p set: 0.44931700825691223
loss_pred:0.013602741993963718, decouple_loss:0.0010830367682501674
Iteration: 3655, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468764066696167, gen p mean: -0.04422188177704811, mean p set: 0.4473566710948944
loss_pred:0.013610967434942722, decouple_loss:0.0009817873360589147
The modified gen p mean: 0.4456796944141388, gen p mean: -0.049883969128131866, mean p set: 0.4461599588394165The modified gen p mean: 0.44646894931793213, gen p mean: -0.0437137745320797, mean p set: 0.44694921374320984
loss_pred:0.013653249479830265, decouple_loss:0.0010618098312988877
loss_pred:0.013715582899749279, decouple_loss:0.0009941889438778162
Iteration: 3656, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44817230105400085, gen p mean: -0.0444217175245285, mean p set: 0.44865259528160095
loss_pred:0.013541948981583118, decouple_loss:0.0010796479182317853
The modified gen p mean: 0.44904762506484985, gen p mean: -0.04611813649535179, mean p set: 0.44952791929244995The modified gen p mean: 0.4472138285636902, gen p mean: -0.043531157076358795, mean p set: 0.4476941227912903
loss_pred:0.013534719124436378, decouple_loss:0.0011244318448007107
loss_pred:0.014023816213011742, decouple_loss:0.0010433174902573228
Iteration: 3657, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473477900028229, gen p mean: -0.04653344675898552, mean p set: 0.4478280544281006
loss_pred:0.013585379347205162, decouple_loss:0.001090089906938374
The modified gen p mean: 0.44647493958473206, gen p mean: -0.04575540870428085, mean p set: 0.44695523381233215The modified gen p mean: 0.4473292827606201, gen p mean: -0.050092730671167374, mean p set: 0.4478095471858978
loss_pred:0.013312339782714844, decouple_loss:0.0011288040550425649
loss_pred:0.013459201902151108, decouple_loss:0.0011048804735764861
Iteration: 3658, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467124044895172, gen p mean: -0.04944318160414696, mean p set: 0.4471926689147949
loss_pred:0.01405866164714098, decouple_loss:0.0011382244993001223
The modified gen p mean: 0.4474707841873169, gen p mean: -0.05068286880850792, mean p set: 0.447951078414917The modified gen p mean: 0.4464486241340637, gen p mean: -0.04876481741666794, mean p set: 0.4469289183616638
loss_pred:0.013475623913109303, decouple_loss:0.000987611711025238
loss_pred:0.013651074841618538, decouple_loss:0.0010709906928241253
Iteration: 3659, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44734594225883484, gen p mean: -0.04932239651679993, mean p set: 0.44782623648643494
loss_pred:0.013551727868616581, decouple_loss:0.001098796958103776
The modified gen p mean: 0.44627127051353455, gen p mean: -0.05039171874523163, mean p set: 0.44675159454345703The modified gen p mean: 0.4481782019138336, gen p mean: -0.05173806846141815, mean p set: 0.4486584961414337
loss_pred:0.013636832125484943, decouple_loss:0.0011453315382823348
loss_pred:0.013530189171433449, decouple_loss:0.0011598498094826937
Iteration: 3660, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468235969543457, gen p mean: -0.05179890617728233, mean p set: 0.4473038911819458
The modified gen p mean: 0.44568493962287903, gen p mean: -0.05349630489945412, mean p set: 0.4461652636528015
loss_pred:0.013614745810627937, decouple_loss:0.0012575109722092748
loss_pred:0.013740083202719688, decouple_loss:0.001154837547801435
The modified gen p mean: 0.44810670614242554, gen p mean: -0.050191983580589294, mean p set: 0.44858697056770325
loss_pred:0.013705536723136902, decouple_loss:0.001206868444569409
2023-05-02 16:27:08 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.04778638109564781, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04445049539208412, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.04470973089337349, mean p set: 0.4500633478164673
loss_pred:0.018948569893836975, decouple_loss:0.0011832733871415257
loss_pred:0.017767662182450294, decouple_loss:0.001179232494905591
loss_pred:0.01786860264837742, decouple_loss:0.0012101581087335944
WV_0_PC_1_EH_0_PS_40, loss: 0.018254490569233894, avg_mse: 0.026612821966409683
current test mse: 0.026613
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 3661, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467659592628479, gen p mean: -0.044550973922014236, mean p set: 0.447246253490448
The modified gen p mean: 0.4469195306301117, gen p mean: -0.047485414892435074, mean p set: 0.4473998546600342
The modified gen p mean: 0.44577547907829285, gen p mean: -0.04375201463699341, mean p set: 0.44625577330589294
loss_pred:0.013925640843808651, decouple_loss:0.00114469975233078
loss_pred:0.013483512215316296, decouple_loss:0.0010817560832947493
loss_pred:0.013366399332880974, decouple_loss:0.0011447174474596977
Iteration: 3662, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4459937512874603, gen p mean: -0.042185090482234955, mean p set: 0.44647401571273804
loss_pred:0.013775059022009373, decouple_loss:0.0012364026624709368
The modified gen p mean: 0.44746023416519165, gen p mean: -0.04802386090159416, mean p set: 0.44794052839279175
The modified gen p mean: 0.4466208219528198, gen p mean: -0.04805479943752289, mean p set: 0.4471011161804199
loss_pred:0.013434883207082748, decouple_loss:0.001122204470448196
loss_pred:0.013647450134158134, decouple_loss:0.0011816186597570777
Iteration: 3663, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4463035762310028, gen p mean: -0.042308345437049866, mean p set: 0.4467838406562805
loss_pred:0.01319556962698698, decouple_loss:0.0011069414904341102
The modified gen p mean: 0.44710493087768555, gen p mean: -0.04056191444396973, mean p set: 0.44758522510528564The modified gen p mean: 0.4459315538406372, gen p mean: -0.043382931500673294, mean p set: 0.4464118480682373
loss_pred:0.014204825274646282, decouple_loss:0.001127903931774199
loss_pred:0.013558860868215561, decouple_loss:0.0010425576474517584
Iteration: 3664, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475928544998169, gen p mean: -0.043468404561281204, mean p set: 0.448073148727417
loss_pred:0.0135757215321064, decouple_loss:0.0012878497363999486
The modified gen p mean: 0.44820311665534973, gen p mean: -0.04253958910703659, mean p set: 0.44868341088294983The modified gen p mean: 0.44641295075416565, gen p mean: -0.04632119834423065, mean p set: 0.44689324498176575
loss_pred:0.013610007241368294, decouple_loss:0.0014559391420334578
loss_pred:0.014139811508357525, decouple_loss:0.0011345082893967628
Iteration: 3665, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448574036359787, gen p mean: -0.049069300293922424, mean p set: 0.4490543007850647
loss_pred:0.013822300359606743, decouple_loss:0.0015003836015239358
The modified gen p mean: 0.44704756140708923, gen p mean: -0.05074319615960121, mean p set: 0.44752782583236694The modified gen p mean: 0.4474453032016754, gen p mean: -0.05038009583950043, mean p set: 0.4479255974292755
loss_pred:0.014079253189265728, decouple_loss:0.0009802335407584906
loss_pred:0.014688892289996147, decouple_loss:0.0009949392406269908
Iteration: 3666, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44677528738975525, gen p mean: -0.049511294811964035, mean p set: 0.44725558161735535
loss_pred:0.013558917678892612, decouple_loss:0.0010635375510901213
The modified gen p mean: 0.4472636580467224, gen p mean: -0.049889516085386276, mean p set: 0.4477439522743225The modified gen p mean: 0.44760069251060486, gen p mean: -0.0478740893304348, mean p set: 0.44808098673820496
loss_pred:0.013678271323442459, decouple_loss:0.0012980438768863678
loss_pred:0.013271570205688477, decouple_loss:0.001148780225776136
Iteration: 3667, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44603100419044495, gen p mean: -0.04778667166829109, mean p set: 0.44651132822036743
loss_pred:0.014057387597858906, decouple_loss:0.001045849290676415
The modified gen p mean: 0.4480065703392029, gen p mean: -0.054460104554891586, mean p set: 0.448486864566803The modified gen p mean: 0.44664016366004944, gen p mean: -0.04995931312441826, mean p set: 0.44712045788764954
loss_pred:0.014085219241678715, decouple_loss:0.001254442729987204
loss_pred:0.01343183871358633, decouple_loss:0.0011126281460747123
Iteration: 3668, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44525769352912903, gen p mean: -0.05234838277101517, mean p set: 0.44573795795440674
loss_pred:0.013317207805812359, decouple_loss:0.0010430209804326296
The modified gen p mean: 0.4468863010406494, gen p mean: -0.049153391271829605, mean p set: 0.4473665952682495The modified gen p mean: 0.4478110373020172, gen p mean: -0.04734481871128082, mean p set: 0.4482913017272949
loss_pred:0.013675512745976448, decouple_loss:0.0010107523994520307
loss_pred:0.013489495031535625, decouple_loss:0.0010735896648839116
Iteration: 3669, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4462074935436249, gen p mean: -0.04362607002258301, mean p set: 0.44668781757354736
loss_pred:0.014131919480860233, decouple_loss:0.0010996826458722353
The modified gen p mean: 0.44582653045654297, gen p mean: -0.04380024969577789, mean p set: 0.44630685448646545The modified gen p mean: 0.44667911529541016, gen p mean: -0.04665781557559967, mean p set: 0.44715940952301025
loss_pred:0.013783511705696583, decouple_loss:0.0011611779918894172
loss_pred:0.013757889159023762, decouple_loss:0.0011433417676016688
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012002_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012002_3_24hr.npz
NaN value num: 0
Iteration: 3670, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488300383090973, gen p mean: -0.04081229493021965, mean p set: 0.4493103623390198
loss_pred:0.015971997752785683, decouple_loss:0.0010749377543106675
The modified gen p mean: 0.44690144062042236, gen p mean: -0.040089067071676254, mean p set: 0.44738173484802246The modified gen p mean: 0.4473472535610199, gen p mean: -0.043451759964227676, mean p set: 0.4478275179862976
loss_pred:0.01674855500459671, decouple_loss:0.0010745221516117454
loss_pred:0.015446837060153484, decouple_loss:0.0010348029900342226
2023-05-02 16:29:42 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.039901431649923325, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.03667355328798294, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.03679785877466202, mean p set: 0.4500633478164673
loss_pred:0.018794825300574303, decouple_loss:0.0009776316583156586
loss_pred:0.017657846212387085, decouple_loss:0.0009720574016682804
loss_pred:0.017726745456457138, decouple_loss:0.0009757443331182003
WV_0_PC_1_EH_0_PS_40, loss: 0.018108563497662544, avg_mse: 0.026326624676585197
current test mse: 0.026327
Iteration: 3671, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44780677556991577, gen p mean: -0.041177209466695786, mean p set: 0.4482870399951935
The modified gen p mean: 0.4477980136871338, gen p mean: -0.03819694370031357, mean p set: 0.4482783079147339
The modified gen p mean: 0.4462195932865143, gen p mean: -0.03714684769511223, mean p set: 0.4466998875141144
loss_pred:0.016293790191411972, decouple_loss:0.0009895444381982088
loss_pred:0.015450411476194859, decouple_loss:0.0010756989941000938
loss_pred:0.015450973995029926, decouple_loss:0.0010623227572068572
Iteration: 3672, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44631367921829224, gen p mean: -0.036962930113077164, mean p set: 0.44679397344589233
loss_pred:0.016297519207000732, decouple_loss:0.0010854231659322977
The modified gen p mean: 0.44681331515312195, gen p mean: -0.03759249299764633, mean p set: 0.44729360938072205The modified gen p mean: 0.4469470977783203, gen p mean: -0.03751111403107643, mean p set: 0.44742733240127563
loss_pred:0.01555684208869934, decouple_loss:0.0010572836035862565
loss_pred:0.016047142446041107, decouple_loss:0.001058140303939581
Iteration: 3673, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44631490111351013, gen p mean: -0.039173465222120285, mean p set: 0.44679519534111023
loss_pred:0.015883080661296844, decouple_loss:0.0010005248477682471
The modified gen p mean: 0.44767042994499207, gen p mean: -0.04157112538814545, mean p set: 0.44815075397491455The modified gen p mean: 0.44585978984832764, gen p mean: -0.037448130548000336, mean p set: 0.44634005427360535
loss_pred:0.016433333978056908, decouple_loss:0.0009911145316436887
loss_pred:0.015655474737286568, decouple_loss:0.0010252794018015265
Iteration: 3674, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44711971282958984, gen p mean: -0.044142771512269974, mean p set: 0.44760003685951233
loss_pred:0.015541921369731426, decouple_loss:0.0010527302511036396
The modified gen p mean: 0.44721418619155884, gen p mean: -0.04371379315853119, mean p set: 0.44769448041915894The modified gen p mean: 0.44630497694015503, gen p mean: -0.04625491797924042, mean p set: 0.44678524136543274
loss_pred:0.016146905720233917, decouple_loss:0.001398722524754703
loss_pred:0.01583217643201351, decouple_loss:0.0010431212140247226
Iteration: 3675, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44572699069976807, gen p mean: -0.043688613921403885, mean p set: 0.44620731472969055
loss_pred:0.01664281263947487, decouple_loss:0.0010066325776278973
The modified gen p mean: 0.44953835010528564, gen p mean: -0.04446261003613472, mean p set: 0.45001867413520813The modified gen p mean: 0.44848331809043884, gen p mean: -0.04699074476957321, mean p set: 0.44896358251571655
loss_pred:0.015841200947761536, decouple_loss:0.0010775774717330933
loss_pred:0.015704821795225143, decouple_loss:0.0010953471064567566
Iteration: 3676, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467082917690277, gen p mean: -0.04531078413128853, mean p set: 0.4471885859966278
loss_pred:0.015873929485678673, decouple_loss:0.0010427013039588928
The modified gen p mean: 0.44687435030937195, gen p mean: -0.048290181905031204, mean p set: 0.44735464453697205The modified gen p mean: 0.44606515765190125, gen p mean: -0.04623718187212944, mean p set: 0.44654545187950134
loss_pred:0.01576448790729046, decouple_loss:0.0009422298171557486
loss_pred:0.016529519110918045, decouple_loss:0.001023415825329721
Iteration: 3677, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4463766813278198, gen p mean: -0.04910034313797951, mean p set: 0.4468569755554199
loss_pred:0.015814995393157005, decouple_loss:0.001066130236722529
The modified gen p mean: 0.4460824728012085, gen p mean: -0.04835635423660278, mean p set: 0.446562796831131The modified gen p mean: 0.4469471573829651, gen p mean: -0.05281225964426994, mean p set: 0.4474274814128876
loss_pred:0.015542220324277878, decouple_loss:0.0010742157464846969
loss_pred:0.015541653148829937, decouple_loss:0.000967370520811528
Iteration: 3678, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4459373950958252, gen p mean: -0.05223926901817322, mean p set: 0.4464176893234253
loss_pred:0.015271132811903954, decouple_loss:0.0009244155371561646
The modified gen p mean: 0.44659224152565, gen p mean: -0.05287957191467285, mean p set: 0.4470725357532501The modified gen p mean: 0.4487651586532593, gen p mean: -0.054777976125478745, mean p set: 0.4492454528808594
loss_pred:0.016329506412148476, decouple_loss:0.0009877554839476943
loss_pred:0.015800297260284424, decouple_loss:0.0009104211931116879
Iteration: 3679, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496762752532959, gen p mean: -0.05634069815278053, mean p set: 0.4501565396785736
loss_pred:0.015579632483422756, decouple_loss:0.0010048507247120142
The modified gen p mean: 0.44691088795661926, gen p mean: -0.05834678187966347, mean p set: 0.44739121198654175The modified gen p mean: 0.44563645124435425, gen p mean: -0.05537014827132225, mean p set: 0.44611674547195435
loss_pred:0.0164056196808815, decouple_loss:0.0010375395650044084
loss_pred:0.01568428985774517, decouple_loss:0.0010300773428753018
Iteration: 3680, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447517454624176, gen p mean: -0.06284667551517487, mean p set: 0.4479977488517761
loss_pred:0.015857946127653122, decouple_loss:0.0010858402820304036
The modified gen p mean: 0.4476546347141266, gen p mean: -0.06110623478889465, mean p set: 0.4481349289417267
The modified gen p mean: 0.44906169176101685, gen p mean: -0.06215153634548187, mean p set: 0.44954198598861694
loss_pred:0.01616581529378891, decouple_loss:0.0011073899222537875
loss_pred:0.015733709558844566, decouple_loss:0.0011910016182810068
2023-05-02 16:31:37 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.06403880566358566, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.06008325144648552, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.060570284724235535, mean p set: 0.4500633478164673
loss_pred:0.017295299097895622, decouple_loss:0.0009768758900463581
loss_pred:0.018385158851742744, decouple_loss:0.0009973979322239757
loss_pred:0.01732068881392479, decouple_loss:0.0010118731297552586
WV_0_PC_1_EH_0_PS_40, loss: 0.017716817557811737, avg_mse: 0.02553669735789299
current test mse: 0.025537
Iteration: 3681, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471961259841919, gen p mean: -0.06578653305768967, mean p set: 0.447676420211792
The modified gen p mean: 0.44587406516075134, gen p mean: -0.06044077128171921, mean p set: 0.44635435938835144
The modified gen p mean: 0.44654712080955505, gen p mean: -0.06442242115736008, mean p set: 0.44702741503715515
loss_pred:0.015386957675218582, decouple_loss:0.0009445025934837759
loss_pred:0.016417279839515686, decouple_loss:0.0010939240455627441
loss_pred:0.01475125178694725, decouple_loss:0.0009947980288416147
Iteration: 3682, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482938349246979, gen p mean: -0.06344255059957504, mean p set: 0.448774129152298
loss_pred:0.016035111621022224, decouple_loss:0.0010843070922419429
The modified gen p mean: 0.44877082109451294, gen p mean: -0.0616641640663147, mean p set: 0.44925111532211304The modified gen p mean: 0.4479316174983978, gen p mean: -0.061759158968925476, mean p set: 0.44841188192367554
loss_pred:0.015351446345448494, decouple_loss:0.0010473268339410424
loss_pred:0.015419642440974712, decouple_loss:0.0010584722040221095
Iteration: 3683, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478932023048401, gen p mean: -0.05859578400850296, mean p set: 0.4483734667301178
loss_pred:0.015575981698930264, decouple_loss:0.0010015565203502774
The modified gen p mean: 0.4463620185852051, gen p mean: -0.057228848338127136, mean p set: 0.4468423128128052The modified gen p mean: 0.4461632966995239, gen p mean: -0.05816110596060753, mean p set: 0.446643590927124
loss_pred:0.01601025089621544, decouple_loss:0.0009525430505163968
loss_pred:0.015539303421974182, decouple_loss:0.0009795288788154721
Iteration: 3684, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4461938142776489, gen p mean: -0.052709441632032394, mean p set: 0.446674108505249
loss_pred:0.015227886848151684, decouple_loss:0.0010500940261408687
The modified gen p mean: 0.446042537689209, gen p mean: -0.05497555807232857, mean p set: 0.44652286171913147The modified gen p mean: 0.4486159682273865, gen p mean: -0.05811252444982529, mean p set: 0.44909629225730896
loss_pred:0.01572241820394993, decouple_loss:0.0009380741976201534
loss_pred:0.01608225516974926, decouple_loss:0.0010347880888730288
Iteration: 3685, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44695520401000977, gen p mean: -0.04992227628827095, mean p set: 0.44743549823760986
loss_pred:0.01615431345999241, decouple_loss:0.000980234588496387
The modified gen p mean: 0.4457029104232788, gen p mean: -0.05112675577402115, mean p set: 0.4461832046508789The modified gen p mean: 0.4470807611942291, gen p mean: -0.05071535333991051, mean p set: 0.4475610554218292
loss_pred:0.01551120262593031, decouple_loss:0.000951234542299062
loss_pred:0.015577650628983974, decouple_loss:0.000977007090114057
Iteration: 3686, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44572100043296814, gen p mean: -0.048996224999427795, mean p set: 0.44620129466056824
loss_pred:0.015227675437927246, decouple_loss:0.0010413030395284295
The modified gen p mean: 0.44580018520355225, gen p mean: -0.053107403218746185, mean p set: 0.44628050923347473The modified gen p mean: 0.4457554519176483, gen p mean: -0.05312207341194153, mean p set: 0.4462357461452484
loss_pred:0.016011210158467293, decouple_loss:0.001112446771003306
loss_pred:0.015618639066815376, decouple_loss:0.0010407189838588238
Iteration: 3687, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467291831970215, gen p mean: -0.0543905645608902, mean p set: 0.4472094774246216
loss_pred:0.014614548534154892, decouple_loss:0.001008093124255538
The modified gen p mean: 0.4464660584926605, gen p mean: -0.05324985459446907, mean p set: 0.446946382522583The modified gen p mean: 0.44660159945487976, gen p mean: -0.046592842787504196, mean p set: 0.44708189368247986
loss_pred:0.015993917360901833, decouple_loss:0.0009699397487565875
loss_pred:0.016210295259952545, decouple_loss:0.0009708860889077187
Iteration: 3688, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44663169980049133, gen p mean: -0.05072183534502983, mean p set: 0.44711199402809143
loss_pred:0.016038713976740837, decouple_loss:0.0009660901268944144
The modified gen p mean: 0.44649532437324524, gen p mean: -0.052370037883520126, mean p set: 0.44697561860084534The modified gen p mean: 0.4467898905277252, gen p mean: -0.052251286804676056, mean p set: 0.44727015495300293
loss_pred:0.01533427368849516, decouple_loss:0.0009684657561592758
loss_pred:0.01579025574028492, decouple_loss:0.0010101795196533203
Iteration: 3689, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44721871614456177, gen p mean: -0.056544940918684006, mean p set: 0.4476989805698395
loss_pred:0.01589028909802437, decouple_loss:0.0009382148273289204
The modified gen p mean: 0.447207510471344, gen p mean: -0.05505712330341339, mean p set: 0.4476877748966217The modified gen p mean: 0.44560834765434265, gen p mean: -0.05666763707995415, mean p set: 0.44608867168426514
loss_pred:0.016072111204266548, decouple_loss:0.000951998052187264
loss_pred:0.015491030178964138, decouple_loss:0.0009783892892301083
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012015_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012015_3_24hr.npz
NaN value num: 0
Iteration: 3690, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4506174921989441, gen p mean: -0.05206185206770897, mean p set: 0.4510977864265442
loss_pred:0.015415960922837257, decouple_loss:0.0010556526249274611
The modified gen p mean: 0.4482330083847046, gen p mean: -0.04552692919969559, mean p set: 0.4487132728099823The modified gen p mean: 0.4508325159549713, gen p mean: -0.048444610089063644, mean p set: 0.4513128101825714
loss_pred:0.016094345599412918, decouple_loss:0.0010440154001116753
loss_pred:0.01572626270353794, decouple_loss:0.0010879278415814042
2023-05-02 16:34:06 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.056372448801994324, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830535888672, gen p mean: -0.053158193826675415, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.05283205956220627, mean p set: 0.45035696029663086
loss_pred:0.01837853714823723, decouple_loss:0.0014183600433170795
loss_pred:0.01731761358678341, decouple_loss:0.001287363120354712
loss_pred:0.01726522110402584, decouple_loss:0.0012183545622974634
WV_0_PC_1_EH_0_PS_40, loss: 0.017719192430377007, avg_mse: 0.02550661377608776
current test mse: 0.025507
Iteration: 3691, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505400061607361, gen p mean: -0.04887615889310837, mean p set: 0.45102033019065857
The modified gen p mean: 0.4506491422653198, gen p mean: -0.04858388751745224, mean p set: 0.4511294364929199
The modified gen p mean: 0.4490700364112854, gen p mean: -0.04636291414499283, mean p set: 0.4495503306388855
loss_pred:0.015358425676822662, decouple_loss:0.0010523085948079824
loss_pred:0.01562489103525877, decouple_loss:0.0010040794732049108
loss_pred:0.016151849180459976, decouple_loss:0.0010433560237288475
Iteration: 3692, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45032623410224915, gen p mean: -0.050176601856946945, mean p set: 0.45080649852752686
loss_pred:0.015505856834352016, decouple_loss:0.0010387549409642816
The modified gen p mean: 0.4508225619792938, gen p mean: -0.050040390342473984, mean p set: 0.4513028562068939The modified gen p mean: 0.44986680150032043, gen p mean: -0.04476235806941986, mean p set: 0.45034709572792053
loss_pred:0.01614362560212612, decouple_loss:0.0010539444629102945
loss_pred:0.015515508130192757, decouple_loss:0.0009637944749556482
Iteration: 3693, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507591128349304, gen p mean: -0.04588591307401657, mean p set: 0.4512394070625305
loss_pred:0.016424108296632767, decouple_loss:0.0009950255043804646
The modified gen p mean: 0.4505615532398224, gen p mean: -0.046689048409461975, mean p set: 0.4510418474674225The modified gen p mean: 0.44932088255882263, gen p mean: -0.044306423515081406, mean p set: 0.44980117678642273
loss_pred:0.015474054962396622, decouple_loss:0.000939972058404237
loss_pred:0.015674198046326637, decouple_loss:0.0009452058584429324
Iteration: 3694, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44991549849510193, gen p mean: -0.044864997267723083, mean p set: 0.450395792722702
The modified gen p mean: 0.4490688443183899, gen p mean: -0.04617200791835785, mean p set: 0.4495491087436676
loss_pred:0.015995681285858154, decouple_loss:0.0010647776070982218
loss_pred:0.015699610114097595, decouple_loss:0.000980449141934514
The modified gen p mean: 0.45124098658561707, gen p mean: -0.047938451170921326, mean p set: 0.4517212510108948
loss_pred:0.015559989959001541, decouple_loss:0.0010749399662017822
Iteration: 3695, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508623778820038, gen p mean: -0.04204558581113815, mean p set: 0.4513426423072815
The modified gen p mean: 0.45013561844825745, gen p mean: -0.04400729387998581, mean p set: 0.45061591267585754
loss_pred:0.01626894250512123, decouple_loss:0.0009897088166326284
loss_pred:0.015502151101827621, decouple_loss:0.0010046917013823986
The modified gen p mean: 0.4493100941181183, gen p mean: -0.041644152253866196, mean p set: 0.4497903883457184
loss_pred:0.016233429312705994, decouple_loss:0.0010137404315173626
Iteration: 3696, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44912439584732056, gen p mean: -0.04633832722902298, mean p set: 0.44960469007492065
loss_pred:0.015941550955176353, decouple_loss:0.0010881577618420124
The modified gen p mean: 0.45097872614860535, gen p mean: -0.04477968439459801, mean p set: 0.45145899057388306The modified gen p mean: 0.45072463154792786, gen p mean: -0.04235780984163284, mean p set: 0.45120492577552795
loss_pred:0.016365626826882362, decouple_loss:0.0010815694695338607
loss_pred:0.016436610370874405, decouple_loss:0.0010467077372595668
Iteration: 3697, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502016603946686, gen p mean: -0.0488024465739727, mean p set: 0.4506819546222687
loss_pred:0.01498922798782587, decouple_loss:0.001080388785339892
The modified gen p mean: 0.4500775933265686, gen p mean: -0.049031201750040054, mean p set: 0.4505578577518463The modified gen p mean: 0.44982007145881653, gen p mean: -0.04668024554848671, mean p set: 0.4503003656864166
loss_pred:0.015423472970724106, decouple_loss:0.001057815970852971
loss_pred:0.01565627008676529, decouple_loss:0.0011392226442694664
Iteration: 3698, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45079559087753296, gen p mean: -0.05031228065490723, mean p set: 0.45127591490745544
loss_pred:0.016031237319111824, decouple_loss:0.001073866500519216
The modified gen p mean: 0.44989699125289917, gen p mean: -0.04421801492571831, mean p set: 0.45037728548049927The modified gen p mean: 0.4488142728805542, gen p mean: -0.048217594623565674, mean p set: 0.4492945969104767
loss_pred:0.015763824805617332, decouple_loss:0.0010549360886216164
loss_pred:0.016433674842119217, decouple_loss:0.0011185406474396586
Iteration: 3699, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507042169570923, gen p mean: -0.054416198283433914, mean p set: 0.4511845111846924
loss_pred:0.014958316460251808, decouple_loss:0.001100922585465014
The modified gen p mean: 0.450418084859848, gen p mean: -0.04973747581243515, mean p set: 0.4508983790874481The modified gen p mean: 0.4498754143714905, gen p mean: -0.052490949630737305, mean p set: 0.4503557085990906
loss_pred:0.015516052022576332, decouple_loss:0.0012514309491962194
loss_pred:0.015506807714700699, decouple_loss:0.0010335003025829792
Iteration: 3700, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500060975551605, gen p mean: -0.054505228996276855, mean p set: 0.4504863917827606
loss_pred:0.01603398658335209, decouple_loss:0.0010526928817853332
The modified gen p mean: 0.4497341513633728, gen p mean: -0.04929928854107857, mean p set: 0.4502144455909729The modified gen p mean: 0.4488238990306854, gen p mean: -0.04878135398030281, mean p set: 0.44930416345596313
loss_pred:0.015593416057527065, decouple_loss:0.000991223263554275
loss_pred:0.015408383682370186, decouple_loss:0.0009715083870105445
2023-05-02 16:36:03 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.06184730306267738, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.05829797685146332, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.058767255395650864, mean p set: 0.4500633478164673
loss_pred:0.018563922494649887, decouple_loss:0.0014733030693605542
loss_pred:0.017500879243016243, decouple_loss:0.0011881464160978794
loss_pred:0.01742463931441307, decouple_loss:0.0010818720329552889
WV_0_PC_1_EH_0_PS_40, loss: 0.017892202362418175, avg_mse: 0.025837834924459457
current test mse: 0.025838
Iteration: 3701, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45065775513648987, gen p mean: -0.053190331906080246, mean p set: 0.45113804936408997
The modified gen p mean: 0.45088908076286316, gen p mean: -0.05591171234846115, mean p set: 0.45136934518814087
The modified gen p mean: 0.45042797923088074, gen p mean: -0.0486411526799202, mean p set: 0.45090827345848083
loss_pred:0.015937572345137596, decouple_loss:0.0010398294543847442
loss_pred:0.015368973836302757, decouple_loss:0.0011296470183879137
loss_pred:0.0158767718821764, decouple_loss:0.0009593508439138532
Iteration: 3702, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491664469242096, gen p mean: -0.051958467811346054, mean p set: 0.4496467411518097
loss_pred:0.016216380521655083, decouple_loss:0.0010519159259274602
The modified gen p mean: 0.45081639289855957, gen p mean: -0.05274583771824837, mean p set: 0.45129671692848206The modified gen p mean: 0.4493275582790375, gen p mean: -0.04795380309224129, mean p set: 0.44980788230895996
loss_pred:0.015283750370144844, decouple_loss:0.0010885281953960657
loss_pred:0.015960590913891792, decouple_loss:0.001137611805461347
Iteration: 3703, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497908055782318, gen p mean: -0.05301802605390549, mean p set: 0.4502711296081543
loss_pred:0.014942686073482037, decouple_loss:0.0011568727204576135
The modified gen p mean: 0.44957202672958374, gen p mean: -0.05342789366841316, mean p set: 0.45005232095718384The modified gen p mean: 0.4505142271518707, gen p mean: -0.05210781469941139, mean p set: 0.4509945213794708
loss_pred:0.015814363956451416, decouple_loss:0.0010843820637091994
loss_pred:0.01527365855872631, decouple_loss:0.0010704264277592301
Iteration: 3704, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505537748336792, gen p mean: -0.0487690195441246, mean p set: 0.4510340988636017
loss_pred:0.015519561246037483, decouple_loss:0.0011808559065684676
The modified gen p mean: 0.4500710070133209, gen p mean: -0.05458209291100502, mean p set: 0.4505513310432434The modified gen p mean: 0.45033180713653564, gen p mean: -0.05113307386636734, mean p set: 0.45081210136413574
loss_pred:0.014969482086598873, decouple_loss:0.0010294747771695256
loss_pred:0.01606244221329689, decouple_loss:0.0010283933952450752
Iteration: 3705, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498096704483032, gen p mean: -0.04701625555753708, mean p set: 0.45028993487358093
loss_pred:0.015452275052666664, decouple_loss:0.0010487434919923544
The modified gen p mean: 0.44938963651657104, gen p mean: -0.048283662647008896, mean p set: 0.44986993074417114The modified gen p mean: 0.4499472379684448, gen p mean: -0.04936664178967476, mean p set: 0.45042750239372253
loss_pred:0.015981512144207954, decouple_loss:0.0011072392808273435
loss_pred:0.01578700728714466, decouple_loss:0.0010790158994495869
Iteration: 3706, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507622718811035, gen p mean: -0.05220678448677063, mean p set: 0.4512425363063812
loss_pred:0.014956921339035034, decouple_loss:0.0012644981034100056
The modified gen p mean: 0.4497520625591278, gen p mean: -0.04702591896057129, mean p set: 0.4502323865890503The modified gen p mean: 0.4491346776485443, gen p mean: -0.04619022086262703, mean p set: 0.4496149718761444
loss_pred:0.015743762254714966, decouple_loss:0.0010405357461422682
loss_pred:0.015617277473211288, decouple_loss:0.0010413378477096558
Iteration: 3707, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498710632324219, gen p mean: -0.04527578875422478, mean p set: 0.450351357460022
loss_pred:0.015569803304970264, decouple_loss:0.000931520713493228
The modified gen p mean: 0.45042118430137634, gen p mean: -0.044041890650987625, mean p set: 0.45090147852897644The modified gen p mean: 0.45001962780952454, gen p mean: -0.04859822615981102, mean p set: 0.45049992203712463
loss_pred:0.0162208154797554, decouple_loss:0.0009504132904112339
loss_pred:0.015363294631242752, decouple_loss:0.000980067066848278
Iteration: 3708, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45182010531425476, gen p mean: -0.04587649181485176, mean p set: 0.45230039954185486
loss_pred:0.015948103740811348, decouple_loss:0.000983873032964766
The modified gen p mean: 0.45057016611099243, gen p mean: -0.05140436813235283, mean p set: 0.45105046033859253The modified gen p mean: 0.4509621262550354, gen p mean: -0.050201546400785446, mean p set: 0.4514424204826355
loss_pred:0.01624266430735588, decouple_loss:0.0009602743084542453
loss_pred:0.014678300358355045, decouple_loss:0.0010475082090124488
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012016_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012016_3_24hr.npz
NaN value num: 0
Iteration: 3709, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480169117450714, gen p mean: -0.05899767577648163, mean p set: 0.4484971761703491
loss_pred:0.014121022075414658, decouple_loss:0.0012676138430833817
The modified gen p mean: 0.4474845826625824, gen p mean: -0.052678897976875305, mean p set: 0.4479648470878601The modified gen p mean: 0.44705286622047424, gen p mean: -0.05691163241863251, mean p set: 0.44753316044807434
loss_pred:0.014605562202632427, decouple_loss:0.0010932954028248787
loss_pred:0.015351435169577599, decouple_loss:0.0012632588623091578
Iteration: 3710, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477772116661072, gen p mean: -0.06218684837222099, mean p set: 0.4482575058937073
loss_pred:0.014660824090242386, decouple_loss:0.0011813383316621184
The modified gen p mean: 0.44703516364097595, gen p mean: -0.05447734519839287, mean p set: 0.44751542806625366The modified gen p mean: 0.4496080279350281, gen p mean: -0.060070253908634186, mean p set: 0.4500883221626282
loss_pred:0.013853522017598152, decouple_loss:0.0013499384513124824
loss_pred:0.014358742162585258, decouple_loss:0.001202259212732315
2023-05-02 16:38:36 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.0653158500790596, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.061174701899290085, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.06158272176980972, mean p set: 0.4500633478164673
loss_pred:0.018732279539108276, decouple_loss:0.0011994076194241643
loss_pred:0.017556073144078255, decouple_loss:0.0010270627681165934
loss_pred:0.017626889050006866, decouple_loss:0.0010127805871888995
WV_0_PC_1_EH_0_PS_40, loss: 0.01802573725581169, avg_mse: 0.02610372006893158
current test mse: 0.026104
Iteration: 3711, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481349587440491, gen p mean: -0.06012912467122078, mean p set: 0.44861525297164917
The modified gen p mean: 0.44696342945098877, gen p mean: -0.06343307346105576, mean p set: 0.44744372367858887
The modified gen p mean: 0.4468691349029541, gen p mean: -0.06811974197626114, mean p set: 0.4473494589328766
loss_pred:0.01528488751500845, decouple_loss:0.001154285972006619
loss_pred:0.01489903312176466, decouple_loss:0.001022348296828568
loss_pred:0.01445894967764616, decouple_loss:0.0011283261701464653
Iteration: 3712, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44723808765411377, gen p mean: -0.06126801297068596, mean p set: 0.4477183520793915
loss_pred:0.01531244721263647, decouple_loss:0.0010803119512274861
The modified gen p mean: 0.44772204756736755, gen p mean: -0.05638318508863449, mean p set: 0.44820234179496765The modified gen p mean: 0.44941359758377075, gen p mean: -0.06150941923260689, mean p set: 0.44989389181137085
loss_pred:0.014258828945457935, decouple_loss:0.0010770950466394424
loss_pred:0.013656453229486942, decouple_loss:0.0011815546313300729
Iteration: 3713, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486178457736969, gen p mean: -0.05571923777461052, mean p set: 0.449098140001297
loss_pred:0.014168502762913704, decouple_loss:0.001125302049331367
The modified gen p mean: 0.44754254817962646, gen p mean: -0.051602981984615326, mean p set: 0.44802284240722656The modified gen p mean: 0.4477654695510864, gen p mean: -0.061633989214897156, mean p set: 0.4482457637786865
loss_pred:0.01402695756405592, decouple_loss:0.0010788850486278534
loss_pred:0.014436543919146061, decouple_loss:0.0010562670649960637
Iteration: 3714, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480094909667969, gen p mean: -0.050728533416986465, mean p set: 0.4484897553920746
loss_pred:0.013975033536553383, decouple_loss:0.0010645956499502063
The modified gen p mean: 0.44629180431365967, gen p mean: -0.05684654042124748, mean p set: 0.44677209854125977The modified gen p mean: 0.4469491243362427, gen p mean: -0.052785277366638184, mean p set: 0.4474294185638428
loss_pred:0.014139923267066479, decouple_loss:0.0013034801231697202
loss_pred:0.01366821676492691, decouple_loss:0.0011738382745534182
Iteration: 3715, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44655951857566833, gen p mean: -0.05525674670934677, mean p set: 0.44703981280326843
loss_pred:0.014479119330644608, decouple_loss:0.0012674778699874878
The modified gen p mean: 0.4476301968097687, gen p mean: -0.05162985250353813, mean p set: 0.4481104910373688The modified gen p mean: 0.4475826323032379, gen p mean: -0.05301458761096001, mean p set: 0.4480628967285156
loss_pred:0.013560731895267963, decouple_loss:0.0012686041882261634
loss_pred:0.013871920295059681, decouple_loss:0.0012516533024609089
Iteration: 3716, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476337432861328, gen p mean: -0.049711160361766815, mean p set: 0.4481140077114105
loss_pred:0.013779640197753906, decouple_loss:0.0011444188421592116
The modified gen p mean: 0.4484513998031616, gen p mean: -0.043702591210603714, mean p set: 0.4489316940307617The modified gen p mean: 0.44690874218940735, gen p mean: -0.04415428265929222, mean p set: 0.44738900661468506
loss_pred:0.013637769967317581, decouple_loss:0.0010973247699439526
loss_pred:0.013767538592219353, decouple_loss:0.0010838441085070372
Iteration: 3717, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44687673449516296, gen p mean: -0.04585786536335945, mean p set: 0.4473569989204407
loss_pred:0.013680539093911648, decouple_loss:0.0012832810170948505
The modified gen p mean: 0.44798144698143005, gen p mean: -0.046720270067453384, mean p set: 0.44846174120903015The modified gen p mean: 0.4483056962490082, gen p mean: -0.051367342472076416, mean p set: 0.4487859904766083
loss_pred:0.013732073828577995, decouple_loss:0.0011462050024420023
loss_pred:0.013868087902665138, decouple_loss:0.0011318715987727046
Iteration: 3718, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44762569665908813, gen p mean: -0.05120804160833359, mean p set: 0.4481060206890106
The modified gen p mean: 0.44688501954078674, gen p mean: -0.054371487349271774, mean p set: 0.44736534357070923
loss_pred:0.014356235042214394, decouple_loss:0.0010464332299306989
loss_pred:0.014286731369793415, decouple_loss:0.0012534904526546597
The modified gen p mean: 0.44765305519104004, gen p mean: -0.052790503948926926, mean p set: 0.44813334941864014
loss_pred:0.013725776225328445, decouple_loss:0.0011609656503424048
Iteration: 3719, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44759416580200195, gen p mean: -0.05326879769563675, mean p set: 0.44807443022727966
The modified gen p mean: 0.4475051462650299, gen p mean: -0.04909743368625641, mean p set: 0.44798544049263
loss_pred:0.013319037854671478, decouple_loss:0.0011831606971099973
loss_pred:0.01443659421056509, decouple_loss:0.0012756038922816515
The modified gen p mean: 0.4466017484664917, gen p mean: -0.05342544615268707, mean p set: 0.4470820426940918
loss_pred:0.013838604092597961, decouple_loss:0.0012531953398138285
Iteration: 3720, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44685888290405273, gen p mean: -0.053536225110292435, mean p set: 0.44733917713165283
The modified gen p mean: 0.44689783453941345, gen p mean: -0.04835253581404686, mean p set: 0.44737815856933594
loss_pred:0.013779057189822197, decouple_loss:0.001259343116544187
loss_pred:0.014035799540579319, decouple_loss:0.0011075811926275492
The modified gen p mean: 0.4466681480407715, gen p mean: -0.04635424166917801, mean p set: 0.4471484422683716
loss_pred:0.01403289195150137, decouple_loss:0.0012443703599274158
2023-05-02 16:40:33 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.052517157047986984, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04890049621462822, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04895634576678276, mean p set: 0.4500633478164673
loss_pred:0.019051749259233475, decouple_loss:0.0012343148700892925
loss_pred:0.017891956493258476, decouple_loss:0.0010869776597246528
loss_pred:0.018023546785116196, decouple_loss:0.0011117749381810427
WV_0_PC_1_EH_0_PS_40, loss: 0.018379636108875275, avg_mse: 0.02680026926100254
current test mse: 0.0268
Iteration: 3721, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492480754852295, gen p mean: -0.0496981181204319, mean p set: 0.4497283697128296
The modified gen p mean: 0.448493629693985, gen p mean: -0.05254019424319267, mean p set: 0.44897395372390747
The modified gen p mean: 0.4472801983356476, gen p mean: -0.0443282276391983, mean p set: 0.4477604627609253
loss_pred:0.013964889571070671, decouple_loss:0.0011851865565404296
loss_pred:0.013446727767586708, decouple_loss:0.0011246763169765472
loss_pred:0.013823146000504494, decouple_loss:0.001089364755898714
Iteration: 3722, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44755110144615173, gen p mean: -0.04830165579915047, mean p set: 0.44803139567375183The modified gen p mean: 0.4469186067581177, gen p mean: -0.05209238454699516, mean p set: 0.4473989009857178
loss_pred:0.014146964997053146, decouple_loss:0.0011525412555783987
loss_pred:0.014523031190037727, decouple_loss:0.0012409361079335213
The modified gen p mean: 0.4473802149295807, gen p mean: -0.04805891960859299, mean p set: 0.4478605389595032
loss_pred:0.014464525505900383, decouple_loss:0.0011500203981995583
Iteration: 3723, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44634178280830383, gen p mean: -0.052899010479450226, mean p set: 0.4468221068382263
loss_pred:0.01384490542113781, decouple_loss:0.0013812429970130324
The modified gen p mean: 0.4469279646873474, gen p mean: -0.051679577678442, mean p set: 0.4474082589149475
The modified gen p mean: 0.44666460156440735, gen p mean: -0.04683396592736244, mean p set: 0.44714486598968506
loss_pred:0.014750296249985695, decouple_loss:0.0010954694589599967
loss_pred:0.013605915941298008, decouple_loss:0.0011676058638840914
Iteration: 3724, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464806616306305, gen p mean: -0.046776704490184784, mean p set: 0.4469609558582306
loss_pred:0.013461428694427013, decouple_loss:0.0011983804870396852
The modified gen p mean: 0.44842371344566345, gen p mean: -0.04965176433324814, mean p set: 0.44890403747558594The modified gen p mean: 0.446621298789978, gen p mean: -0.04977312684059143, mean p set: 0.4471015930175781
loss_pred:0.013774346560239792, decouple_loss:0.0011463898699730635
loss_pred:0.014745579101145267, decouple_loss:0.0011415549088269472
Iteration: 3725, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44651761651039124, gen p mean: -0.04946330562233925, mean p set: 0.44699788093566895
loss_pred:0.014004656113684177, decouple_loss:0.0011039793025702238
The modified gen p mean: 0.4464671313762665, gen p mean: -0.05103788152337074, mean p set: 0.4469473958015442The modified gen p mean: 0.4490155279636383, gen p mean: -0.047285474836826324, mean p set: 0.4494958221912384
loss_pred:0.013532721437513828, decouple_loss:0.0011924956925213337
loss_pred:0.013977709226310253, decouple_loss:0.0010701532009989023
Iteration: 3726, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4463586211204529, gen p mean: -0.04999089241027832, mean p set: 0.4468388855457306
loss_pred:0.014020423404872417, decouple_loss:0.0011730988044291735
The modified gen p mean: 0.4471610486507416, gen p mean: -0.039815790951251984, mean p set: 0.4476413428783417The modified gen p mean: 0.44851794838905334, gen p mean: -0.04493784159421921, mean p set: 0.44899824261665344
loss_pred:0.013776274397969246, decouple_loss:0.0010958878556266427
loss_pred:0.013917637057602406, decouple_loss:0.0011306580854579806
Iteration: 3727, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470483064651489, gen p mean: -0.04515598714351654, mean p set: 0.44752857089042664
loss_pred:0.01372117642313242, decouple_loss:0.0010538978967815638
The modified gen p mean: 0.4473516047000885, gen p mean: -0.04445071145892143, mean p set: 0.4478318989276886The modified gen p mean: 0.446679025888443, gen p mean: -0.047109454870224, mean p set: 0.4471592903137207
loss_pred:0.014391208998858929, decouple_loss:0.001047922414727509
loss_pred:0.013401076197624207, decouple_loss:0.0011321789352223277
Iteration: 3728, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483170509338379, gen p mean: -0.04802786558866501, mean p set: 0.448797345161438
loss_pred:0.014139685779809952, decouple_loss:0.0010841282783076167
The modified gen p mean: 0.44680145382881165, gen p mean: -0.05047287046909332, mean p set: 0.44728177785873413The modified gen p mean: 0.44824644923210144, gen p mean: -0.051365312188863754, mean p set: 0.4487267732620239
loss_pred:0.013936597853899002, decouple_loss:0.0011220125015825033
loss_pred:0.013938133604824543, decouple_loss:0.0011691238032653928
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012011_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012011_3_24hr.npz
NaN value num: 0
Iteration: 3729, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475606679916382, gen p mean: -0.04792328551411629, mean p set: 0.44804099202156067
loss_pred:0.015807244926691055, decouple_loss:0.001154797151684761
The modified gen p mean: 0.44746488332748413, gen p mean: -0.048966746777296066, mean p set: 0.4479452073574066The modified gen p mean: 0.4475497901439667, gen p mean: -0.04623309522867203, mean p set: 0.4480300843715668
loss_pred:0.01510579138994217, decouple_loss:0.0012007422046735883
loss_pred:0.014991357922554016, decouple_loss:0.0012089730007573962
Iteration: 3730, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484071135520935, gen p mean: -0.0472223274409771, mean p set: 0.4488873779773712
loss_pred:0.01615181565284729, decouple_loss:0.0010586902499198914
The modified gen p mean: 0.44699928164482117, gen p mean: -0.046382781118154526, mean p set: 0.44747960567474365The modified gen p mean: 0.4455285668373108, gen p mean: -0.04352059215307236, mean p set: 0.4460088610649109
loss_pred:0.015381855890154839, decouple_loss:0.0012718082871288061
loss_pred:0.014611953869462013, decouple_loss:0.0010111320298165083
2023-05-02 16:43:05 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.044405579566955566, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.0409812368452549, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04091903194785118, mean p set: 0.4500633478164673
loss_pred:0.018743392080068588, decouple_loss:0.001212802599184215
loss_pred:0.017573243007063866, decouple_loss:0.00115401076618582
loss_pred:0.017674645408988, decouple_loss:0.0011235971469432116
WV_0_PC_1_EH_0_PS_40, loss: 0.0180552676320076, avg_mse: 0.02619507722556591
current test mse: 0.026195
Iteration: 3731, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44791361689567566, gen p mean: -0.04245300218462944, mean p set: 0.44839391112327576
The modified gen p mean: 0.44946858286857605, gen p mean: -0.04374218359589577, mean p set: 0.44994887709617615
The modified gen p mean: 0.4479265809059143, gen p mean: -0.03948895260691643, mean p set: 0.4484068751335144
loss_pred:0.015816964209079742, decouple_loss:0.0010939661879092455
loss_pred:0.015229785814881325, decouple_loss:0.0012352127814665437
loss_pred:0.015594249591231346, decouple_loss:0.001190589857287705
Iteration: 3732, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44788849353790283, gen p mean: -0.039811939001083374, mean p set: 0.44836878776550293
The modified gen p mean: 0.44728729128837585, gen p mean: -0.040849510580301285, mean p set: 0.44776758551597595
loss_pred:0.01588776707649231, decouple_loss:0.001115045160986483
loss_pred:0.016182344406843185, decouple_loss:0.0010260632261633873
The modified gen p mean: 0.4469090700149536, gen p mean: -0.040931977331638336, mean p set: 0.4473893940448761
loss_pred:0.015844441950321198, decouple_loss:0.0010381097672507167
Iteration: 3733, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44846656918525696, gen p mean: -0.03439167141914368, mean p set: 0.44894686341285706
loss_pred:0.015543133951723576, decouple_loss:0.001099317567422986
The modified gen p mean: 0.4482854902744293, gen p mean: -0.03730883076786995, mean p set: 0.44876575469970703The modified gen p mean: 0.4470180869102478, gen p mean: -0.03856278210878372, mean p set: 0.4474983811378479
loss_pred:0.01588597521185875, decouple_loss:0.0010431328555569053
loss_pred:0.01583598181605339, decouple_loss:0.00112610450014472
Iteration: 3734, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44651171565055847, gen p mean: -0.03603111580014229, mean p set: 0.4469919800758362
loss_pred:0.016606340184807777, decouple_loss:0.0011167720658704638
The modified gen p mean: 0.4477536976337433, gen p mean: -0.033324986696243286, mean p set: 0.4482339918613434The modified gen p mean: 0.44960349798202515, gen p mean: -0.037186432629823685, mean p set: 0.45008379220962524
loss_pred:0.015523686073720455, decouple_loss:0.0010597194777801633
loss_pred:0.014970637857913971, decouple_loss:0.0012080607702955604
Iteration: 3735, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475327730178833, gen p mean: -0.04079930856823921, mean p set: 0.4480130672454834
loss_pred:0.015652284026145935, decouple_loss:0.0011649803491309285
The modified gen p mean: 0.44696494936943054, gen p mean: -0.03984862193465233, mean p set: 0.44744521379470825The modified gen p mean: 0.4488181471824646, gen p mean: -0.036104410886764526, mean p set: 0.4492984712123871
loss_pred:0.015868376940488815, decouple_loss:0.0011373901506885886
loss_pred:0.014792600646615028, decouple_loss:0.001135730417445302
Iteration: 3736, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475783109664917, gen p mean: -0.04495210573077202, mean p set: 0.4480586349964142
loss_pred:0.01569814793765545, decouple_loss:0.0011228197254240513
The modified gen p mean: 0.4478951692581177, gen p mean: -0.03920309618115425, mean p set: 0.4483754336833954The modified gen p mean: 0.44710034132003784, gen p mean: -0.040745120495557785, mean p set: 0.4475806653499603
loss_pred:0.01566062495112419, decouple_loss:0.0010410076938569546
loss_pred:0.015882154926657677, decouple_loss:0.0011151325888931751
Iteration: 3737, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476017653942108, gen p mean: -0.04990528151392937, mean p set: 0.4480820298194885
loss_pred:0.01547403633594513, decouple_loss:0.0011676810681819916
The modified gen p mean: 0.44752398133277893, gen p mean: -0.04851391911506653, mean p set: 0.44800424575805664The modified gen p mean: 0.4481637179851532, gen p mean: -0.0454147644340992, mean p set: 0.4486440122127533
loss_pred:0.015932906419038773, decouple_loss:0.0011424327967688441
loss_pred:0.014870062470436096, decouple_loss:0.0011713533895090222
Iteration: 3738, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44763243198394775, gen p mean: -0.050526466220617294, mean p set: 0.44811269640922546
loss_pred:0.015714239329099655, decouple_loss:0.0010882405331358314
The modified gen p mean: 0.4481664299964905, gen p mean: -0.046998392790555954, mean p set: 0.4486467242240906The modified gen p mean: 0.44798776507377625, gen p mean: -0.0513412207365036, mean p set: 0.44846805930137634
loss_pred:0.015547377988696098, decouple_loss:0.0010697059333324432
loss_pred:0.015769964084029198, decouple_loss:0.0011249999515712261
Iteration: 3739, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44839927554130554, gen p mean: -0.051015455275774, mean p set: 0.448879599571228
loss_pred:0.015238958410918713, decouple_loss:0.0010738582350313663
The modified gen p mean: 0.4458010792732239, gen p mean: -0.0491320975124836, mean p set: 0.44628140330314636The modified gen p mean: 0.4490186870098114, gen p mean: -0.047816094011068344, mean p set: 0.4494989514350891
loss_pred:0.015399455092847347, decouple_loss:0.0011747762328013778
loss_pred:0.01539736706763506, decouple_loss:0.0011589815840125084
Iteration: 3740, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478825628757477, gen p mean: -0.05337004363536835, mean p set: 0.4483628571033478
loss_pred:0.016472559422254562, decouple_loss:0.0010398274753242731
The modified gen p mean: 0.4468432366847992, gen p mean: -0.05473172664642334, mean p set: 0.4473235011100769The modified gen p mean: 0.4476946294307709, gen p mean: -0.05173884332180023, mean p set: 0.44817492365837097
loss_pred:0.01691911369562149, decouple_loss:0.0010409917449578643
loss_pred:0.014664885587990284, decouple_loss:0.0010951500153169036
2023-05-02 16:45:02 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.05374646931886673, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04957418516278267, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.05014490336179733, mean p set: 0.4500633478164673
loss_pred:0.01851402223110199, decouple_loss:0.0012059700675308704
loss_pred:0.01743686944246292, decouple_loss:0.0013417318696156144
loss_pred:0.01744035817682743, decouple_loss:0.0012980917235836387
WV_0_PC_1_EH_0_PS_40, loss: 0.017861180007457733, avg_mse: 0.025803618133068085
current test mse: 0.025804
Iteration: 3741, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44843438267707825, gen p mean: -0.054286424070596695, mean p set: 0.44891470670700073
The modified gen p mean: 0.4475827217102051, gen p mean: -0.05499592423439026, mean p set: 0.4480629861354828
The modified gen p mean: 0.4475351572036743, gen p mean: -0.0516250878572464, mean p set: 0.448015421628952
loss_pred:0.014723087660968304, decouple_loss:0.0012609846889972687
loss_pred:0.015016051940619946, decouple_loss:0.0012312610633671284
loss_pred:0.015738895162940025, decouple_loss:0.0011738375760614872
Iteration: 3742, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44786781072616577, gen p mean: -0.052866365760564804, mean p set: 0.44834810495376587
loss_pred:0.015445513650774956, decouple_loss:0.0010852327104657888
The modified gen p mean: 0.4476255774497986, gen p mean: -0.04868084564805031, mean p set: 0.4481058716773987The modified gen p mean: 0.44687747955322266, gen p mean: -0.05199790373444557, mean p set: 0.44735774397850037
loss_pred:0.015317853540182114, decouple_loss:0.0010888251708820462
loss_pred:0.0151243656873703, decouple_loss:0.0010899580083787441
Iteration: 3743, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44749295711517334, gen p mean: -0.05206194519996643, mean p set: 0.44797322154045105
loss_pred:0.015708286315202713, decouple_loss:0.0012140326434746385
The modified gen p mean: 0.44905123114585876, gen p mean: -0.04750939458608627, mean p set: 0.4495314955711365The modified gen p mean: 0.44775670766830444, gen p mean: -0.05142205208539963, mean p set: 0.44823703169822693
loss_pred:0.016972681507468224, decouple_loss:0.0012249290011823177
loss_pred:0.015838980674743652, decouple_loss:0.0010451774578541517
Iteration: 3744, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44786715507507324, gen p mean: -0.048082441091537476, mean p set: 0.44834744930267334
loss_pred:0.01559032779186964, decouple_loss:0.0010411592666059732
The modified gen p mean: 0.44700631499290466, gen p mean: -0.046735431998968124, mean p set: 0.44748660922050476The modified gen p mean: 0.4461074769496918, gen p mean: -0.04932093620300293, mean p set: 0.4465877413749695
loss_pred:0.015003829263150692, decouple_loss:0.0011115582892671227
loss_pred:0.015402291901409626, decouple_loss:0.0011128548067063093
Iteration: 3745, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484109878540039, gen p mean: -0.04931196570396423, mean p set: 0.4488913118839264
loss_pred:0.015463905408978462, decouple_loss:0.0010112953605130315
The modified gen p mean: 0.44710806012153625, gen p mean: -0.04915732517838478, mean p set: 0.44758832454681396The modified gen p mean: 0.4468827247619629, gen p mean: -0.048812564462423325, mean p set: 0.4473629891872406
loss_pred:0.016918106004595757, decouple_loss:0.0010241155978292227
loss_pred:0.015162646770477295, decouple_loss:0.0010101187508553267
Iteration: 3746, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464336335659027, gen p mean: -0.04646826535463333, mean p set: 0.4469138979911804
loss_pred:0.016882464289665222, decouple_loss:0.0010479832999408245
The modified gen p mean: 0.447560578584671, gen p mean: -0.0478176549077034, mean p set: 0.4480408728122711The modified gen p mean: 0.4484841525554657, gen p mean: -0.04975580424070358, mean p set: 0.4489644169807434
loss_pred:0.01619350165128708, decouple_loss:0.0011060811812058091
loss_pred:0.015004170127213001, decouple_loss:0.0010390145471319556
Iteration: 3747, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472470283508301, gen p mean: -0.0482538603246212, mean p set: 0.4477272629737854
loss_pred:0.015486320480704308, decouple_loss:0.0010467220563441515
The modified gen p mean: 0.44835206866264343, gen p mean: -0.04575455188751221, mean p set: 0.44883236289024353The modified gen p mean: 0.44747117161750793, gen p mean: -0.04852220043540001, mean p set: 0.44795146584510803
loss_pred:0.015624281950294971, decouple_loss:0.0011312301503494382
loss_pred:0.01571718603372574, decouple_loss:0.001081550377421081
Iteration: 3748, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480271637439728, gen p mean: -0.044622913002967834, mean p set: 0.4485074579715729
loss_pred:0.015454990789294243, decouple_loss:0.0010859546018764377
The modified gen p mean: 0.44796356558799744, gen p mean: -0.046898771077394485, mean p set: 0.44844383001327515The modified gen p mean: 0.4482695758342743, gen p mean: -0.04921911284327507, mean p set: 0.4487498700618744
loss_pred:0.014961596578359604, decouple_loss:0.0010295504471287131
loss_pred:0.014847837388515472, decouple_loss:0.0010034722508862615
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012006_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012006_3_24hr.npz
NaN value num: 0
Iteration: 3749, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44794484972953796, gen p mean: -0.04664623364806175, mean p set: 0.44842514395713806
loss_pred:0.014621628448367119, decouple_loss:0.0009830788476392627
The modified gen p mean: 0.4473554193973541, gen p mean: -0.04845771566033363, mean p set: 0.4478357136249542The modified gen p mean: 0.44688400626182556, gen p mean: -0.04473230615258217, mean p set: 0.44736430048942566
loss_pred:0.014032231643795967, decouple_loss:0.0009424126474186778
loss_pred:0.014081675559282303, decouple_loss:0.0010747828055173159
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 3750, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44814372062683105, gen p mean: -0.051612019538879395, mean p set: 0.44862401485443115
The modified gen p mean: 0.44747069478034973, gen p mean: -0.044120024889707565, mean p set: 0.4479510188102722
loss_pred:0.014442967250943184, decouple_loss:0.00101886794436723
loss_pred:0.01440179068595171, decouple_loss:0.0009728077566251159
The modified gen p mean: 0.4472769796848297, gen p mean: -0.05127517133951187, mean p set: 0.4477572739124298
loss_pred:0.014726595021784306, decouple_loss:0.0011069858446717262
2023-05-02 16:48:01 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.05419463664293289, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.049834832549095154, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.05064395070075989, mean p set: 0.4500633478164673
loss_pred:0.01869247481226921, decouple_loss:0.0011605828767642379
loss_pred:0.01753278635442257, decouple_loss:0.0010469431290403008
loss_pred:0.017582647502422333, decouple_loss:0.0010333299869671464
WV_0_PC_1_EH_0_PS_40, loss: 0.017989985644817352, avg_mse: 0.026069238781929016
current test mse: 0.026069
Iteration: 3751, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44681665301322937, gen p mean: -0.054857175797224045, mean p set: 0.4472969174385071
The modified gen p mean: 0.44773998856544495, gen p mean: -0.05288708955049515, mean p set: 0.44822028279304504
The modified gen p mean: 0.44734081625938416, gen p mean: -0.05053015798330307, mean p set: 0.44782111048698425
loss_pred:0.013990194536745548, decouple_loss:0.0010784778278321028
loss_pred:0.01366465538740158, decouple_loss:0.001059727743268013
loss_pred:0.013930683955550194, decouple_loss:0.0011005387641489506
Iteration: 3752, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44832292199134827, gen p mean: -0.05318494886159897, mean p set: 0.44880321621894836
loss_pred:0.013738841749727726, decouple_loss:0.0011195127153769135
The modified gen p mean: 0.4472196400165558, gen p mean: -0.05488802492618561, mean p set: 0.4476999342441559The modified gen p mean: 0.4493085741996765, gen p mean: -0.05727972835302353, mean p set: 0.4497888684272766
loss_pred:0.013831744901835918, decouple_loss:0.001051457249559462
loss_pred:0.013148603960871696, decouple_loss:0.0011645415797829628
Iteration: 3753, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44680526852607727, gen p mean: -0.05765010789036751, mean p set: 0.44728556275367737
loss_pred:0.014304298907518387, decouple_loss:0.0011115901870653033
The modified gen p mean: 0.4472962021827698, gen p mean: -0.04880967736244202, mean p set: 0.4477764964103699The modified gen p mean: 0.44688132405281067, gen p mean: -0.05269799008965492, mean p set: 0.44736161828041077
loss_pred:0.013717718422412872, decouple_loss:0.0010771724628284574
loss_pred:0.01341446302831173, decouple_loss:0.0010626333532854915
Iteration: 3754, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471854567527771, gen p mean: -0.05049988254904747, mean p set: 0.4476657211780548
loss_pred:0.013435563072562218, decouple_loss:0.0012998105958104134
The modified gen p mean: 0.4480040967464447, gen p mean: -0.05053146556019783, mean p set: 0.4484843611717224The modified gen p mean: 0.44653046131134033, gen p mean: -0.05610038340091705, mean p set: 0.44701075553894043
loss_pred:0.01410034392029047, decouple_loss:0.0011313229333609343
loss_pred:0.013628259301185608, decouple_loss:0.00111288926564157
Iteration: 3755, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44622570276260376, gen p mean: -0.05088126286864281, mean p set: 0.44670602679252625
loss_pred:0.014363573864102364, decouple_loss:0.0011269240640103817
The modified gen p mean: 0.4466507136821747, gen p mean: -0.05437946692109108, mean p set: 0.4471310079097748The modified gen p mean: 0.4481634795665741, gen p mean: -0.05135373771190643, mean p set: 0.4486437737941742
loss_pred:0.013446256518363953, decouple_loss:0.0011533336946740746
loss_pred:0.013281401246786118, decouple_loss:0.0011030262103304267
Iteration: 3756, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467688500881195, gen p mean: -0.05612518638372421, mean p set: 0.4472491443157196
loss_pred:0.014028879813849926, decouple_loss:0.001115136779844761
The modified gen p mean: 0.4471207857131958, gen p mean: -0.04847276210784912, mean p set: 0.4476010799407959The modified gen p mean: 0.4470902979373932, gen p mean: -0.05027298629283905, mean p set: 0.4475705623626709
loss_pred:0.01360281277447939, decouple_loss:0.0011421639937907457
loss_pred:0.013222510926425457, decouple_loss:0.0011291325790807605
Iteration: 3757, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44693994522094727, gen p mean: -0.05174548551440239, mean p set: 0.44742023944854736
loss_pred:0.013525296002626419, decouple_loss:0.0011159807909280062
The modified gen p mean: 0.44689297676086426, gen p mean: -0.04878665506839752, mean p set: 0.44737330079078674The modified gen p mean: 0.4474565386772156, gen p mean: -0.04924195259809494, mean p set: 0.44793686270713806
loss_pred:0.013678666204214096, decouple_loss:0.0012598310131579638
loss_pred:0.013643947429955006, decouple_loss:0.0011399607174098492
Iteration: 3758, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472901225090027, gen p mean: -0.05380736291408539, mean p set: 0.4477703869342804
loss_pred:0.013759065419435501, decouple_loss:0.0011048907181248069
The modified gen p mean: 0.44795045256614685, gen p mean: -0.051924820989370346, mean p set: 0.44843074679374695The modified gen p mean: 0.4484044313430786, gen p mean: -0.045470088720321655, mean p set: 0.4488847255706787
loss_pred:0.013639292679727077, decouple_loss:0.0010717329569160938
loss_pred:0.013386320322751999, decouple_loss:0.0011026512365788221
Iteration: 3759, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44682765007019043, gen p mean: -0.04035919904708862, mean p set: 0.4473079442977905
loss_pred:0.013554870150983334, decouple_loss:0.0011408125283196568
The modified gen p mean: 0.4472491145133972, gen p mean: -0.046250950545072556, mean p set: 0.4477294087409973The modified gen p mean: 0.44882383942604065, gen p mean: -0.04736838862299919, mean p set: 0.44930416345596313
loss_pred:0.013308770954608917, decouple_loss:0.0012469727080315351
loss_pred:0.013736969791352749, decouple_loss:0.001231881440617144
Iteration: 3760, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44815999269485474, gen p mean: -0.04313494637608528, mean p set: 0.44864028692245483
loss_pred:0.013755014166235924, decouple_loss:0.001128299511037767
The modified gen p mean: 0.44823771715164185, gen p mean: -0.043857377022504807, mean p set: 0.44871804118156433
The modified gen p mean: 0.4478028416633606, gen p mean: -0.043037544935941696, mean p set: 0.4482831358909607
loss_pred:0.01370386965572834, decouple_loss:0.0011878627119585872
loss_pred:0.013329674489796162, decouple_loss:0.001148780109360814
2023-05-02 16:49:57 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.045636825263500214, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.0414995513856411, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.04200856760144234, mean p set: 0.4500633478164673
loss_pred:0.019114239141345024, decouple_loss:0.0010887077078223228
loss_pred:0.017903566360473633, decouple_loss:0.0012153869029134512
loss_pred:0.01803095079958439, decouple_loss:0.0011699782917276025
WV_0_PC_1_EH_0_PS_40, loss: 0.018407486379146576, avg_mse: 0.026884788647294044
current test mse: 0.026885
Iteration: 3761, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468085765838623, gen p mean: -0.04875899851322174, mean p set: 0.4472888708114624
The modified gen p mean: 0.447664350271225, gen p mean: -0.04027692601084709, mean p set: 0.4481446444988251
The modified gen p mean: 0.44754332304000854, gen p mean: -0.04387582838535309, mean p set: 0.44802361726760864
loss_pred:0.013276099227368832, decouple_loss:0.0011318516917526722
loss_pred:0.013611484318971634, decouple_loss:0.0011395772453397512
loss_pred:0.014305499382317066, decouple_loss:0.0010115017648786306
Iteration: 3762, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44660720229148865, gen p mean: -0.05020853504538536, mean p set: 0.44708749651908875
loss_pred:0.01410587690770626, decouple_loss:0.0010824099881574512
The modified gen p mean: 0.4474269449710846, gen p mean: -0.04570683836936951, mean p set: 0.4479072690010071The modified gen p mean: 0.447611540555954, gen p mean: -0.04320283606648445, mean p set: 0.4480918347835541
loss_pred:0.01309480331838131, decouple_loss:0.0011621236335486174
loss_pred:0.01411806046962738, decouple_loss:0.0011044162092730403
Iteration: 3763, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473671317100525, gen p mean: -0.04740389063954353, mean p set: 0.4478473961353302
loss_pred:0.014007548801600933, decouple_loss:0.0010561970993876457
The modified gen p mean: 0.44732606410980225, gen p mean: -0.04832213744521141, mean p set: 0.44780635833740234The modified gen p mean: 0.4473111629486084, gen p mean: -0.0453672893345356, mean p set: 0.4477914571762085
loss_pred:0.01323546003550291, decouple_loss:0.001210036687552929
loss_pred:0.014163150452077389, decouple_loss:0.0011279190657660365
Iteration: 3764, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482698142528534, gen p mean: -0.05251224711537361, mean p set: 0.4487501382827759
loss_pred:0.01315956562757492, decouple_loss:0.0011230527888983488
The modified gen p mean: 0.446754515171051, gen p mean: -0.05055620148777962, mean p set: 0.44723477959632874The modified gen p mean: 0.447663813829422, gen p mean: -0.04481898248195648, mean p set: 0.4481441080570221
loss_pred:0.013997106812894344, decouple_loss:0.0011230673408135772
loss_pred:0.013227355666458607, decouple_loss:0.001038137124851346
Iteration: 3765, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44862890243530273, gen p mean: -0.047613248229026794, mean p set: 0.44910916686058044
loss_pred:0.01372483465820551, decouple_loss:0.0010306817712262273
The modified gen p mean: 0.4481145441532135, gen p mean: -0.04828054830431938, mean p set: 0.4485948383808136
The modified gen p mean: 0.44660675525665283, gen p mean: -0.04834809526801109, mean p set: 0.4470870792865753
loss_pred:0.01358485221862793, decouple_loss:0.0010839366586878896
loss_pred:0.014134605415165424, decouple_loss:0.0012070512166246772
Iteration: 3766, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474378228187561, gen p mean: -0.046395331621170044, mean p set: 0.4479181170463562
loss_pred:0.01336765382438898, decouple_loss:0.0011533660581335425
The modified gen p mean: 0.4478319585323334, gen p mean: -0.05195388197898865, mean p set: 0.4483122229576111The modified gen p mean: 0.44699323177337646, gen p mean: -0.050498154014348984, mean p set: 0.44747352600097656
loss_pred:0.013173026964068413, decouple_loss:0.0011244778288528323
loss_pred:0.013439458794891834, decouple_loss:0.0012068510986864567
Iteration: 3767, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473397433757782, gen p mean: -0.04612156003713608, mean p set: 0.4478200376033783
loss_pred:0.01394384354352951, decouple_loss:0.000998849980533123
The modified gen p mean: 0.4479466378688812, gen p mean: -0.04694337770342827, mean p set: 0.4484269320964813The modified gen p mean: 0.4476940333843231, gen p mean: -0.05139593780040741, mean p set: 0.44817429780960083
loss_pred:0.013353961519896984, decouple_loss:0.0010685247834771872
loss_pred:0.013102760538458824, decouple_loss:0.0011449499288573861
Iteration: 3768, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44820713996887207, gen p mean: -0.04551469534635544, mean p set: 0.44868743419647217
loss_pred:0.013157297857105732, decouple_loss:0.0010043559595942497
The modified gen p mean: 0.44723570346832275, gen p mean: -0.04708590731024742, mean p set: 0.44771599769592285The modified gen p mean: 0.4477618634700775, gen p mean: -0.04912843927741051, mean p set: 0.4482421875
loss_pred:0.013352266512811184, decouple_loss:0.0010567851131781936
loss_pred:0.01338882278650999, decouple_loss:0.0010404250351712108
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012008_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012008_3_24hr.npz
NaN value num: 0
Iteration: 3769, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44758808612823486, gen p mean: -0.042321473360061646, mean p set: 0.44806838035583496
loss_pred:0.01305675320327282, decouple_loss:0.0010646077571436763
The modified gen p mean: 0.4477647542953491, gen p mean: -0.043823711574077606, mean p set: 0.4482450783252716The modified gen p mean: 0.4453771114349365, gen p mean: -0.04669336974620819, mean p set: 0.445857435464859
loss_pred:0.013304546475410461, decouple_loss:0.0010829599341377616
loss_pred:0.013701467774808407, decouple_loss:0.001076526241376996
Iteration: 3770, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44610628485679626, gen p mean: -0.04409097507596016, mean p set: 0.44658660888671875
loss_pred:0.013698996044695377, decouple_loss:0.0011647726641967893
The modified gen p mean: 0.44740480184555054, gen p mean: -0.04343114420771599, mean p set: 0.44788506627082825The modified gen p mean: 0.4461234509944916, gen p mean: -0.040894582867622375, mean p set: 0.4466037154197693
loss_pred:0.013438870199024677, decouple_loss:0.0010498325573280454
loss_pred:0.01369837298989296, decouple_loss:0.0011086282320320606
2023-05-02 16:52:33 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.04338879510760307, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.03950793668627739, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.04006199166178703, mean p set: 0.4500633478164673
loss_pred:0.017815684899687767, decouple_loss:0.0011320554185658693
loss_pred:0.019007312133908272, decouple_loss:0.0010979751823469996
loss_pred:0.01789722591638565, decouple_loss:0.0011137832188978791
WV_0_PC_1_EH_0_PS_40, loss: 0.018295805901288986, avg_mse: 0.02669849619269371
current test mse: 0.026698
Iteration: 3771, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44634103775024414, gen p mean: -0.045808449387550354, mean p set: 0.44682133197784424
The modified gen p mean: 0.4466697573661804, gen p mean: -0.042346034198999405, mean p set: 0.4471500515937805
The modified gen p mean: 0.44517549872398376, gen p mean: -0.04312797263264656, mean p set: 0.44565579295158386
loss_pred:0.013401728123426437, decouple_loss:0.0010643732966855168
loss_pred:0.013381880708038807, decouple_loss:0.0010732427472248673loss_pred:0.01367725245654583, decouple_loss:0.0010839422466233373
Iteration: 3772, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472448229789734, gen p mean: -0.03875364363193512, mean p set: 0.4477251172065735
loss_pred:0.013558799400925636, decouple_loss:0.0010401483159512281
The modified gen p mean: 0.44705235958099365, gen p mean: -0.03936855122447014, mean p set: 0.44753265380859375The modified gen p mean: 0.4465196132659912, gen p mean: -0.039177559316158295, mean p set: 0.4469999372959137
loss_pred:0.013551650568842888, decouple_loss:0.0009891614317893982
loss_pred:0.013331539928913116, decouple_loss:0.0010177458170801401
Iteration: 3773, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44530776143074036, gen p mean: -0.04261326789855957, mean p set: 0.44578808546066284
loss_pred:0.013224986381828785, decouple_loss:0.001125674694776535
The modified gen p mean: 0.44632676243782043, gen p mean: -0.04262576252222061, mean p set: 0.44680705666542053The modified gen p mean: 0.44605761766433716, gen p mean: -0.038058146834373474, mean p set: 0.44653791189193726
loss_pred:0.013517135754227638, decouple_loss:0.0010970410658046603
loss_pred:0.013583761639893055, decouple_loss:0.001077853376045823
Iteration: 3774, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44701677560806274, gen p mean: -0.03820192813873291, mean p set: 0.44749704003334045
loss_pred:0.014126182533800602, decouple_loss:0.001115822815336287
The modified gen p mean: 0.44679540395736694, gen p mean: -0.039904601871967316, mean p set: 0.44727569818496704
The modified gen p mean: 0.44671717286109924, gen p mean: -0.04249380901455879, mean p set: 0.44719746708869934
loss_pred:0.013431007042527199, decouple_loss:0.0010335802799090743
loss_pred:0.014305672608315945, decouple_loss:0.001045155804604292
Iteration: 3775, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446666419506073, gen p mean: -0.039923928678035736, mean p set: 0.4471467435359955
loss_pred:0.01340505201369524, decouple_loss:0.0010586418211460114
The modified gen p mean: 0.4469769299030304, gen p mean: -0.04154438152909279, mean p set: 0.4474572241306305The modified gen p mean: 0.44700536131858826, gen p mean: -0.0416337251663208, mean p set: 0.44748565554618835
loss_pred:0.013288752175867558, decouple_loss:0.0010990080190822482
loss_pred:0.01317425537854433, decouple_loss:0.001093552098609507
Iteration: 3776, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44698432087898254, gen p mean: -0.044658906757831573, mean p set: 0.44746461510658264
loss_pred:0.013258562423288822, decouple_loss:0.0010881460038945079
The modified gen p mean: 0.4466151297092438, gen p mean: -0.04657057300209999, mean p set: 0.44709545373916626The modified gen p mean: 0.44681304693222046, gen p mean: -0.04346572607755661, mean p set: 0.44729331135749817
loss_pred:0.013173208571970463, decouple_loss:0.0009714540792629123
loss_pred:0.013502424582839012, decouple_loss:0.0010737610282376409
Iteration: 3777, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4460991322994232, gen p mean: -0.0482746884226799, mean p set: 0.4465794563293457
loss_pred:0.013643778860569, decouple_loss:0.0010989862494170666
The modified gen p mean: 0.4477007985115051, gen p mean: -0.04397546499967575, mean p set: 0.44818106293678284The modified gen p mean: 0.44694983959198, gen p mean: -0.04747667536139488, mean p set: 0.4474301338195801
loss_pred:0.013451777398586273, decouple_loss:0.0011308679822832346
loss_pred:0.013387591578066349, decouple_loss:0.00107685592956841
Iteration: 3778, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465217888355255, gen p mean: -0.04963427409529686, mean p set: 0.4470020830631256
loss_pred:0.013261568732559681, decouple_loss:0.0009710220620036125
The modified gen p mean: 0.4461154639720917, gen p mean: -0.05151696130633354, mean p set: 0.44659578800201416The modified gen p mean: 0.44678202271461487, gen p mean: -0.04934578761458397, mean p set: 0.44726231694221497
loss_pred:0.013225586153566837, decouple_loss:0.0010986874112859368
loss_pred:0.01310170441865921, decouple_loss:0.0010321451118215919
Iteration: 3779, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4463392496109009, gen p mean: -0.0510619692504406, mean p set: 0.446819543838501
loss_pred:0.013609289191663265, decouple_loss:0.0010018064640462399
The modified gen p mean: 0.44657984375953674, gen p mean: -0.04875916615128517, mean p set: 0.44706007838249207The modified gen p mean: 0.4468380808830261, gen p mean: -0.04913044348359108, mean p set: 0.4473183751106262
loss_pred:0.013155586086213589, decouple_loss:0.0009877451229840517
loss_pred:0.013388171792030334, decouple_loss:0.0009231274016201496
Iteration: 3780, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44734692573547363, gen p mean: -0.053483545780181885, mean p set: 0.44782721996307373
loss_pred:0.013084977865219116, decouple_loss:0.0011263969354331493
The modified gen p mean: 0.4459965229034424, gen p mean: -0.05010649189352989, mean p set: 0.44647684693336487The modified gen p mean: 0.44712936878204346, gen p mean: -0.04635554924607277, mean p set: 0.44760966300964355
loss_pred:0.01409547682851553, decouple_loss:0.0010563671821728349
loss_pred:0.013789666816592216, decouple_loss:0.0010455762967467308
2023-05-02 16:54:28 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.04954084753990173, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04560139775276184, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.0461885966360569, mean p set: 0.4500633478164673
loss_pred:0.018971912562847137, decouple_loss:0.0010620197281241417
loss_pred:0.017823971807956696, decouple_loss:0.0010159971425309777
loss_pred:0.01792658120393753, decouple_loss:0.001012516557238996
WV_0_PC_1_EH_0_PS_40, loss: 0.01829233020544052, avg_mse: 0.026708390563726425
current test mse: 0.026708
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 3781, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44794607162475586, gen p mean: -0.04947139695286751, mean p set: 0.44842633605003357
The modified gen p mean: 0.446067214012146, gen p mean: -0.04793880879878998, mean p set: 0.4465474784374237
The modified gen p mean: 0.4456709921360016, gen p mean: -0.04972424730658531, mean p set: 0.4461512565612793
loss_pred:0.013431544415652752, decouple_loss:0.0009271287126466632
loss_pred:0.013027341105043888, decouple_loss:0.0010637629311531782
loss_pred:0.013297569006681442, decouple_loss:0.0009647739352658391
Iteration: 3782, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44680145382881165, gen p mean: -0.049164388328790665, mean p set: 0.44728177785873413
loss_pred:0.013242660090327263, decouple_loss:0.000912107527256012
The modified gen p mean: 0.4466235041618347, gen p mean: -0.04279039800167084, mean p set: 0.4471038281917572The modified gen p mean: 0.4463663399219513, gen p mean: -0.04715865105390549, mean p set: 0.446846604347229
loss_pred:0.013414251618087292, decouple_loss:0.000931639107875526
loss_pred:0.01329902932047844, decouple_loss:0.0009192123543471098
Iteration: 3783, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471513628959656, gen p mean: -0.042087871581315994, mean p set: 0.4476316571235657
loss_pred:0.01363141555339098, decouple_loss:0.0010410381946712732
The modified gen p mean: 0.44759318232536316, gen p mean: -0.04283129796385765, mean p set: 0.44807347655296326The modified gen p mean: 0.44643330574035645, gen p mean: -0.047041211277246475, mean p set: 0.44691362977027893
loss_pred:0.013234267942607403, decouple_loss:0.0010911624412983656
loss_pred:0.013333179987967014, decouple_loss:0.0011234345147386193
Iteration: 3784, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44651535153388977, gen p mean: -0.04554856941103935, mean p set: 0.44699564576148987
loss_pred:0.013282779604196548, decouple_loss:0.0010572562459856272
The modified gen p mean: 0.44643449783325195, gen p mean: -0.043210119009017944, mean p set: 0.44691479206085205The modified gen p mean: 0.44674137234687805, gen p mean: -0.04472509026527405, mean p set: 0.44722166657447815
loss_pred:0.013654980808496475, decouple_loss:0.0009755526552908123
loss_pred:0.013177402317523956, decouple_loss:0.0009974665008485317
Iteration: 3785, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4452042877674103, gen p mean: -0.04406353086233139, mean p set: 0.4456845819950104
loss_pred:0.013206363655626774, decouple_loss:0.0012181566562503576
The modified gen p mean: 0.4467034637928009, gen p mean: -0.04268849641084671, mean p set: 0.447183758020401
The modified gen p mean: 0.44656580686569214, gen p mean: -0.0398603118956089, mean p set: 0.44704607129096985
loss_pred:0.013379105366766453, decouple_loss:0.0010997055796906352
loss_pred:0.013377835974097252, decouple_loss:0.0011805390240624547
Iteration: 3786, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466868042945862, gen p mean: -0.0379503108561039, mean p set: 0.4471670687198639
loss_pred:0.013429375365376472, decouple_loss:0.0009910709923133254
The modified gen p mean: 0.44682130217552185, gen p mean: -0.04330585151910782, mean p set: 0.44730156660079956The modified gen p mean: 0.4467865228652954, gen p mean: -0.0482746846973896, mean p set: 0.4472668468952179
loss_pred:0.013328122906386852, decouple_loss:0.0009992712875828147
loss_pred:0.013095383532345295, decouple_loss:0.0009863588493317366
Iteration: 3787, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472530484199524, gen p mean: -0.0443560928106308, mean p set: 0.4477333426475525
loss_pred:0.013965794816613197, decouple_loss:0.0010765389306470752
The modified gen p mean: 0.4484494626522064, gen p mean: -0.04504096508026123, mean p set: 0.4489297568798065The modified gen p mean: 0.4470561742782593, gen p mean: -0.04361080378293991, mean p set: 0.4475364685058594
loss_pred:0.013000156730413437, decouple_loss:0.0010604560375213623
loss_pred:0.013196165673434734, decouple_loss:0.001106534618884325
Iteration: 3788, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44756370782852173, gen p mean: -0.045294586569070816, mean p set: 0.4480440020561218
loss_pred:0.013018572703003883, decouple_loss:0.000962284451816231
The modified gen p mean: 0.4468805491924286, gen p mean: -0.04879845678806305, mean p set: 0.4473608434200287The modified gen p mean: 0.44680383801460266, gen p mean: -0.04673100262880325, mean p set: 0.44728413224220276
loss_pred:0.013236231170594692, decouple_loss:0.001002407050691545
loss_pred:0.013087115250527859, decouple_loss:0.000999122392386198
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012001_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012001_3_24hr.npz
NaN value num: 0
Iteration: 3789, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44823578000068665, gen p mean: -0.04358293116092682, mean p set: 0.44871607422828674
loss_pred:0.015801049768924713, decouple_loss:0.0009258111822418869
The modified gen p mean: 0.4477458596229553, gen p mean: -0.050013940781354904, mean p set: 0.4482261538505554
The modified gen p mean: 0.44807305932044983, gen p mean: -0.047882214188575745, mean p set: 0.4485533535480499
loss_pred:0.015020187012851238, decouple_loss:0.0010701412102207541
loss_pred:0.015568768605589867, decouple_loss:0.0011473867343738675
Iteration: 3790, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482898414134979, gen p mean: -0.04602605104446411, mean p set: 0.4487701654434204
loss_pred:0.015446209348738194, decouple_loss:0.0011349330889061093
The modified gen p mean: 0.44939735531806946, gen p mean: -0.04741812124848366, mean p set: 0.44987761974334717The modified gen p mean: 0.4473434090614319, gen p mean: -0.04336778447031975, mean p set: 0.4478236734867096
loss_pred:0.016140582039952278, decouple_loss:0.0011624919716268778
loss_pred:0.015311992727220058, decouple_loss:0.0010992403840646148
2023-05-02 16:57:07 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.04587998986244202, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04220348969101906, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.04257325828075409, mean p set: 0.4500633478164673
loss_pred:0.01867835782468319, decouple_loss:0.0009699715301394463
loss_pred:0.017535965889692307, decouple_loss:0.0010347752831876278
loss_pred:0.017666377127170563, decouple_loss:0.000982726807706058
WV_0_PC_1_EH_0_PS_40, loss: 0.018010025843977928, avg_mse: 0.026157235726714134
current test mse: 0.026157
Iteration: 3791, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475814700126648, gen p mean: -0.0442567802965641, mean p set: 0.4480617940425873
The modified gen p mean: 0.44616612792015076, gen p mean: -0.04520897939801216, mean p set: 0.44664642214775085
The modified gen p mean: 0.44588375091552734, gen p mean: -0.04272693768143654, mean p set: 0.44636404514312744
loss_pred:0.014815406873822212, decouple_loss:0.0011011274764314294
loss_pred:0.015751658007502556, decouple_loss:0.0010012872517108917loss_pred:0.01556786522269249, decouple_loss:0.0009945561178028584
Iteration: 3792, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44722530245780945, gen p mean: -0.04381462186574936, mean p set: 0.44770559668540955
loss_pred:0.015189611352980137, decouple_loss:0.0010742030572146177
The modified gen p mean: 0.4466603100299835, gen p mean: -0.045078787952661514, mean p set: 0.44714057445526123The modified gen p mean: 0.44915899634361267, gen p mean: -0.04687405005097389, mean p set: 0.44963929057121277
loss_pred:0.015531850047409534, decouple_loss:0.0011011090828105807
loss_pred:0.01547173596918583, decouple_loss:0.0010048747062683105
Iteration: 3793, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471195936203003, gen p mean: -0.04145125672221184, mean p set: 0.4475998878479004
loss_pred:0.01592998020350933, decouple_loss:0.0010759473079815507
The modified gen p mean: 0.44540107250213623, gen p mean: -0.0432218573987484, mean p set: 0.44588136672973633The modified gen p mean: 0.4456835389137268, gen p mean: -0.0438750684261322, mean p set: 0.4461638331413269
loss_pred:0.015504076145589352, decouple_loss:0.0010388052323833108
loss_pred:0.015258433297276497, decouple_loss:0.0010384584311395884
Iteration: 3794, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4458862543106079, gen p mean: -0.04665769636631012, mean p set: 0.446366548538208
loss_pred:0.01516084372997284, decouple_loss:0.0010174793424084783
The modified gen p mean: 0.44679054617881775, gen p mean: -0.04490287974476814, mean p set: 0.44727084040641785
The modified gen p mean: 0.4464940130710602, gen p mean: -0.043047528713941574, mean p set: 0.4469743072986603
loss_pred:0.015095784328877926, decouple_loss:0.0010138865327462554
loss_pred:0.015637047588825226, decouple_loss:0.001011317246593535
Iteration: 3795, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4463096559047699, gen p mean: -0.045188628137111664, mean p set: 0.44678995013237
loss_pred:0.015534217469394207, decouple_loss:0.0010079644853249192
The modified gen p mean: 0.44680359959602356, gen p mean: -0.04440793767571449, mean p set: 0.44728389382362366The modified gen p mean: 0.4464878439903259, gen p mean: -0.044715266674757004, mean p set: 0.446968138217926
loss_pred:0.015426808036863804, decouple_loss:0.0010148363653570414
loss_pred:0.015546745620667934, decouple_loss:0.0009729485609568655
Iteration: 3796, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44636714458465576, gen p mean: -0.0455278642475605, mean p set: 0.44684743881225586
loss_pred:0.015559496358036995, decouple_loss:0.0010390295647084713
The modified gen p mean: 0.44633185863494873, gen p mean: -0.04907972738146782, mean p set: 0.44681212306022644The modified gen p mean: 0.44729194045066833, gen p mean: -0.04592866450548172, mean p set: 0.44777223467826843
loss_pred:0.015514155849814415, decouple_loss:0.0010386701906099916
loss_pred:0.015518812462687492, decouple_loss:0.0011854623444378376
Iteration: 3797, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44904500246047974, gen p mean: -0.04893612116575241, mean p set: 0.44952526688575745
loss_pred:0.014959027990698814, decouple_loss:0.0009600659250281751
The modified gen p mean: 0.44538137316703796, gen p mean: -0.050783805549144745, mean p set: 0.44586169719696045The modified gen p mean: 0.4475783109664917, gen p mean: -0.051329080015420914, mean p set: 0.4480586051940918
loss_pred:0.014994052238762379, decouple_loss:0.0009519255254417658
loss_pred:0.015471669845283031, decouple_loss:0.0009342030389234424
Iteration: 3798, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464988112449646, gen p mean: -0.04776071012020111, mean p set: 0.4469790756702423
loss_pred:0.014944130554795265, decouple_loss:0.0009734890190884471
The modified gen p mean: 0.4459381699562073, gen p mean: -0.051941849291324615, mean p set: 0.446418434381485The modified gen p mean: 0.4471910297870636, gen p mean: -0.0528678372502327, mean p set: 0.4476713538169861
loss_pred:0.015563282184302807, decouple_loss:0.001020627561956644
loss_pred:0.015137090347707272, decouple_loss:0.0010762877063825727
Iteration: 3799, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44733691215515137, gen p mean: -0.055018626153469086, mean p set: 0.44781720638275146
loss_pred:0.015086542814970016, decouple_loss:0.0010454781586304307
The modified gen p mean: 0.44561290740966797, gen p mean: -0.05233863741159439, mean p set: 0.44609320163726807The modified gen p mean: 0.44593241810798645, gen p mean: -0.054701291024684906, mean p set: 0.44641271233558655
loss_pred:0.014350651763379574, decouple_loss:0.001011210959404707
loss_pred:0.014951604418456554, decouple_loss:0.0010577937355265021
Iteration: 3800, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4453831911087036, gen p mean: -0.057622507214546204, mean p set: 0.4458634853363037
loss_pred:0.014526828192174435, decouple_loss:0.0010484179947525263
The modified gen p mean: 0.44793540239334106, gen p mean: -0.0594092421233654, mean p set: 0.4484156668186188The modified gen p mean: 0.4475260078907013, gen p mean: -0.057713862508535385, mean p set: 0.4480063021183014
loss_pred:0.014714263379573822, decouple_loss:0.0010982461972162127
loss_pred:0.014672894030809402, decouple_loss:0.0010321798035874963
2023-05-02 16:59:01 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.05508539453148842, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.05085495114326477, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.051610104739665985, mean p set: 0.4500633478164673
loss_pred:0.01853581704199314, decouple_loss:0.0010442635975778103
loss_pred:0.017358122393488884, decouple_loss:0.0011453446932137012
loss_pred:0.01745961233973503, decouple_loss:0.0010649196337908506
WV_0_PC_1_EH_0_PS_40, loss: 0.01783875934779644, avg_mse: 0.025785835459828377
current test mse: 0.025786
Iteration: 3801, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483083188533783, gen p mean: -0.04976348578929901, mean p set: 0.4487886130809784
The modified gen p mean: 0.44712579250335693, gen p mean: -0.05159307271242142, mean p set: 0.44760608673095703
The modified gen p mean: 0.4481053948402405, gen p mean: -0.05437557399272919, mean p set: 0.44858571887016296
loss_pred:0.015398888848721981, decouple_loss:0.0010737585835158825
loss_pred:0.015607430599629879, decouple_loss:0.0010089294519275427
loss_pred:0.015510757453739643, decouple_loss:0.001067797071300447
Iteration: 3802, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473308026790619, gen p mean: -0.05057405307888985, mean p set: 0.447811096906662
loss_pred:0.014905844815075397, decouple_loss:0.001201801118440926
The modified gen p mean: 0.4482974410057068, gen p mean: -0.04599159210920334, mean p set: 0.4487777352333069The modified gen p mean: 0.4472513496875763, gen p mean: -0.05020155757665634, mean p set: 0.4477316439151764
loss_pred:0.015143794007599354, decouple_loss:0.0012739717494696379
loss_pred:0.01569266989827156, decouple_loss:0.001128820120356977
Iteration: 3803, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44707542657852173, gen p mean: -0.04956812039017677, mean p set: 0.4475557208061218
The modified gen p mean: 0.4462381899356842, gen p mean: -0.046575818210840225, mean p set: 0.4467185139656067
loss_pred:0.015581642277538776, decouple_loss:0.0010643787682056427
loss_pred:0.01550650130957365, decouple_loss:0.0010154350893571973
The modified gen p mean: 0.44609618186950684, gen p mean: -0.04903283715248108, mean p set: 0.44657647609710693
loss_pred:0.014541986398398876, decouple_loss:0.0010774373076856136
Iteration: 3804, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471464157104492, gen p mean: -0.04673391953110695, mean p set: 0.4476267099380493
The modified gen p mean: 0.446638286113739, gen p mean: -0.049086857587099075, mean p set: 0.4471185803413391
loss_pred:0.015609254129230976, decouple_loss:0.0010912405559793115
loss_pred:0.014717667363584042, decouple_loss:0.0011388902785256505
The modified gen p mean: 0.4470728039741516, gen p mean: -0.047736603766679764, mean p set: 0.4475530982017517
loss_pred:0.015555907040834427, decouple_loss:0.001181927276775241
Iteration: 3805, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4460093677043915, gen p mean: -0.0490422323346138, mean p set: 0.4464896619319916
loss_pred:0.015095207840204239, decouple_loss:0.0010012791026383638
The modified gen p mean: 0.4464147090911865, gen p mean: -0.052066292613744736, mean p set: 0.4468950033187866The modified gen p mean: 0.446050226688385, gen p mean: -0.04287221282720566, mean p set: 0.4465305209159851
loss_pred:0.014747997745871544, decouple_loss:0.0010967300040647388
loss_pred:0.015101003460586071, decouple_loss:0.0010546782286837697
Iteration: 3806, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4456712305545807, gen p mean: -0.04485361650586128, mean p set: 0.4461515247821808
loss_pred:0.01473577506840229, decouple_loss:0.0010379818268120289
The modified gen p mean: 0.44632381200790405, gen p mean: -0.04417197033762932, mean p set: 0.44680410623550415The modified gen p mean: 0.44680696725845337, gen p mean: -0.05122746154665947, mean p set: 0.44728726148605347
loss_pred:0.014497999101877213, decouple_loss:0.0011179418070241809
loss_pred:0.01485309936106205, decouple_loss:0.0010630417382344604
Iteration: 3807, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4459201991558075, gen p mean: -0.052760567516088486, mean p set: 0.44640052318573
loss_pred:0.014759540557861328, decouple_loss:0.0009711061720736325
The modified gen p mean: 0.44870543479919434, gen p mean: -0.04599694907665253, mean p set: 0.44918572902679443The modified gen p mean: 0.4488806128501892, gen p mean: -0.045781929045915604, mean p set: 0.4493609070777893
loss_pred:0.01572924293577671, decouple_loss:0.0009921407327055931
loss_pred:0.01541131641715765, decouple_loss:0.0010580644011497498
Iteration: 3808, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465714693069458, gen p mean: -0.045959144830703735, mean p set: 0.4470517337322235
loss_pred:0.015313170850276947, decouple_loss:0.0009950008243322372
The modified gen p mean: 0.44568878412246704, gen p mean: -0.05202306807041168, mean p set: 0.4461691081523895The modified gen p mean: 0.4487845301628113, gen p mean: -0.052072539925575256, mean p set: 0.44926485419273376
loss_pred:0.01515961904078722, decouple_loss:0.0010178223019465804
loss_pred:0.015648385509848595, decouple_loss:0.0010480965720489621
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012007_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012007_3_24hr.npz
NaN value num: 0
Iteration: 3809, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468289613723755, gen p mean: -0.051379699259996414, mean p set: 0.447309285402298
loss_pred:0.012913024984300137, decouple_loss:0.0009956335416063666
The modified gen p mean: 0.44812509417533875, gen p mean: -0.044965337961912155, mean p set: 0.44860541820526123The modified gen p mean: 0.4483628273010254, gen p mean: -0.04814279079437256, mean p set: 0.4488431215286255
loss_pred:0.013698306865990162, decouple_loss:0.0010245065204799175
loss_pred:0.013195861130952835, decouple_loss:0.0009744668495841324
Iteration: 3810, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44771867990493774, gen p mean: -0.04688398912549019, mean p set: 0.44819900393486023
loss_pred:0.013324444182217121, decouple_loss:0.0010827273363247514
The modified gen p mean: 0.4468880295753479, gen p mean: -0.04704945906996727, mean p set: 0.447368323802948The modified gen p mean: 0.44823968410491943, gen p mean: -0.04475148394703865, mean p set: 0.44871997833251953
loss_pred:0.013133931905031204, decouple_loss:0.0011750663397833705
loss_pred:0.013413076288998127, decouple_loss:0.0010340394219383597
2023-05-02 17:01:35 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.04874901473522186, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04513891413807869, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830237865448, gen p mean: -0.04531148076057434, mean p set: 0.4500633478164673
loss_pred:0.01879715733230114, decouple_loss:0.001080875052139163
loss_pred:0.017605818808078766, decouple_loss:0.0011208087671548128
loss_pred:0.0176763404160738, decouple_loss:0.0010532595915719867
WV_0_PC_1_EH_0_PS_40, loss: 0.018080689013004303, avg_mse: 0.02625596895813942
current test mse: 0.026256
Iteration: 3811, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478377103805542, gen p mean: -0.04996148869395256, mean p set: 0.4483180344104767
The modified gen p mean: 0.4494439363479614, gen p mean: -0.047160759568214417, mean p set: 0.4499242305755615
The modified gen p mean: 0.447710245847702, gen p mean: -0.044900886714458466, mean p set: 0.4481905400753021
loss_pred:0.013597400858998299, decouple_loss:0.0011150952195748687
loss_pred:0.014335026033222675, decouple_loss:0.0010417914018034935
loss_pred:0.013092284090816975, decouple_loss:0.0011025344720110297
Iteration: 3812, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483294188976288, gen p mean: -0.04532251134514809, mean p set: 0.4488097131252289
loss_pred:0.013511803932487965, decouple_loss:0.0010871690465137362
The modified gen p mean: 0.4469155967235565, gen p mean: -0.048948656767606735, mean p set: 0.4473958909511566The modified gen p mean: 0.44970178604125977, gen p mean: -0.046646349132061005, mean p set: 0.45018208026885986
loss_pred:0.013291015289723873, decouple_loss:0.0010311040095984936
loss_pred:0.012441135942935944, decouple_loss:0.00110603345092386
Iteration: 3813, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474042057991028, gen p mean: -0.04936515539884567, mean p set: 0.4478845000267029
loss_pred:0.012919719330966473, decouple_loss:0.0010131887393072248
The modified gen p mean: 0.4477677047252655, gen p mean: -0.04981258511543274, mean p set: 0.4482479691505432The modified gen p mean: 0.4470553696155548, gen p mean: -0.04998099058866501, mean p set: 0.4475356340408325
loss_pred:0.013423129916191101, decouple_loss:0.0009753378690220416
loss_pred:0.013086236082017422, decouple_loss:0.0010333722457289696
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 3814, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475904405117035, gen p mean: -0.05196189135313034, mean p set: 0.4480707347393036
loss_pred:0.014022917486727238, decouple_loss:0.0011335109593346715
The modified gen p mean: 0.44702863693237305, gen p mean: -0.050711676478385925, mean p set: 0.44750893115997314The modified gen p mean: 0.44852301478385925, gen p mean: -0.04526810348033905, mean p set: 0.44900330901145935
loss_pred:0.012895707972347736, decouple_loss:0.001006693230010569
loss_pred:0.012941754423081875, decouple_loss:0.0010152009781450033
Iteration: 3815, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474222660064697, gen p mean: -0.052072711288928986, mean p set: 0.4479025602340698
loss_pred:0.012847896665334702, decouple_loss:0.00098175008315593
The modified gen p mean: 0.44904133677482605, gen p mean: -0.0485924556851387, mean p set: 0.44952166080474854The modified gen p mean: 0.4480031430721283, gen p mean: -0.04376311972737312, mean p set: 0.4484834671020508
loss_pred:0.013027584180235863, decouple_loss:0.0010572111932560802
loss_pred:0.013206761330366135, decouple_loss:0.0010495270835235715
Iteration: 3816, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492430090904236, gen p mean: -0.046983037143945694, mean p set: 0.4497232735157013
loss_pred:0.012803771533071995, decouple_loss:0.0010247324826195836
The modified gen p mean: 0.44881513714790344, gen p mean: -0.04772517830133438, mean p set: 0.44929543137550354The modified gen p mean: 0.4464145600795746, gen p mean: -0.05102991312742233, mean p set: 0.4468948543071747
loss_pred:0.0131505336612463, decouple_loss:0.0010326063493266702
loss_pred:0.012566717341542244, decouple_loss:0.00108110043220222
Iteration: 3817, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475768804550171, gen p mean: -0.0498833954334259, mean p set: 0.4480571746826172
loss_pred:0.013148951344192028, decouple_loss:0.0011441927636042237
The modified gen p mean: 0.4480352997779846, gen p mean: -0.04444976896047592, mean p set: 0.4485156238079071The modified gen p mean: 0.44784078001976013, gen p mean: -0.04607921466231346, mean p set: 0.44832107424736023
loss_pred:0.013755366206169128, decouple_loss:0.0010808721417561173
loss_pred:0.012615682557225227, decouple_loss:0.001146255643106997
Iteration: 3818, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491855502128601, gen p mean: -0.04258250072598457, mean p set: 0.449665904045105
loss_pred:0.012522181496024132, decouple_loss:0.001061798189766705
The modified gen p mean: 0.4475352168083191, gen p mean: -0.042392484843730927, mean p set: 0.4480155408382416The modified gen p mean: 0.4485395848751068, gen p mean: -0.04319121688604355, mean p set: 0.4490198791027069
loss_pred:0.014128572307527065, decouple_loss:0.0011056793155148625
loss_pred:0.013530951924622059, decouple_loss:0.0010207858867943287
Iteration: 3819, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466298222541809, gen p mean: -0.041021935641765594, mean p set: 0.447110116481781
loss_pred:0.013512196019291878, decouple_loss:0.001137667102739215
The modified gen p mean: 0.4468555450439453, gen p mean: -0.04165363684296608, mean p set: 0.4473358392715454The modified gen p mean: 0.448089063167572, gen p mean: -0.039069127291440964, mean p set: 0.4485693573951721
loss_pred:0.012871785089373589, decouple_loss:0.0010672929929569364
loss_pred:0.012702845968306065, decouple_loss:0.0011373473098501563
Iteration: 3820, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485644996166229, gen p mean: -0.044599972665309906, mean p set: 0.44904476404190063
loss_pred:0.013243417255580425, decouple_loss:0.0010800660820677876
The modified gen p mean: 0.44716453552246094, gen p mean: -0.04170044884085655, mean p set: 0.4476448595523834The modified gen p mean: 0.4482411742210388, gen p mean: -0.04367426037788391, mean p set: 0.4487214982509613
loss_pred:0.013048054650425911, decouple_loss:0.0010384147753939033
loss_pred:0.01312070619314909, decouple_loss:0.0010574751067906618
2023-05-02 17:03:30 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.043471913784742355, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.03993712365627289, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04010822996497154, mean p set: 0.4500633478164673
loss_pred:0.018980776891112328, decouple_loss:0.0011145395692437887
loss_pred:0.017852338030934334, decouple_loss:0.0010385224595665932
loss_pred:0.01786584034562111, decouple_loss:0.0010682762367650867
WV_0_PC_1_EH_0_PS_40, loss: 0.018286675214767456, avg_mse: 0.02666481025516987
current test mse: 0.026665
Iteration: 3821, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44707077741622925, gen p mean: -0.041833505034446716, mean p set: 0.44755110144615173
The modified gen p mean: 0.44617778062820435, gen p mean: -0.04039788991212845, mean p set: 0.44665804505348206
The modified gen p mean: 0.447005033493042, gen p mean: -0.04465191811323166, mean p set: 0.4474853575229645
loss_pred:0.012617688626050949, decouple_loss:0.0010206096339970827
loss_pred:0.013238302432000637, decouple_loss:0.0009893139358609915
loss_pred:0.012951971963047981, decouple_loss:0.0011194141115993261
Iteration: 3822, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44795140624046326, gen p mean: -0.04059083014726639, mean p set: 0.44843170046806335
loss_pred:0.012810510583221912, decouple_loss:0.001145112793892622
The modified gen p mean: 0.45016229152679443, gen p mean: -0.04492276534438133, mean p set: 0.4506426155567169The modified gen p mean: 0.44821542501449585, gen p mean: -0.04184410348534584, mean p set: 0.44869574904441833
loss_pred:0.013170436955988407, decouple_loss:0.0013467154931277037
loss_pred:0.012573911808431149, decouple_loss:0.001501999911852181
Iteration: 3823, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44891947507858276, gen p mean: -0.0442950613796711, mean p set: 0.44939976930618286
loss_pred:0.0129467798396945, decouple_loss:0.0011401334777474403
The modified gen p mean: 0.4461434781551361, gen p mean: -0.04655075818300247, mean p set: 0.4466237425804138The modified gen p mean: 0.44713225960731506, gen p mean: -0.045439206063747406, mean p set: 0.4476125240325928
loss_pred:0.01289557944983244, decouple_loss:0.0012114113196730614
loss_pred:0.01264938898384571, decouple_loss:0.0012209099950268865
Iteration: 3824, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44821897149086, gen p mean: -0.042874157428741455, mean p set: 0.4486992359161377
loss_pred:0.013158872723579407, decouple_loss:0.0011014682240784168
The modified gen p mean: 0.44793441891670227, gen p mean: -0.04362064599990845, mean p set: 0.44841471314430237The modified gen p mean: 0.4483945965766907, gen p mean: -0.04215724766254425, mean p set: 0.4488748610019684
loss_pred:0.01325285155326128, decouple_loss:0.0010758544085547328
loss_pred:0.013262448832392693, decouple_loss:0.001159309409558773
Iteration: 3825, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477846920490265, gen p mean: -0.04555757716298103, mean p set: 0.4482649564743042
loss_pred:0.012998891994357109, decouple_loss:0.0011963698780164123
The modified gen p mean: 0.4458834230899811, gen p mean: -0.04335193336009979, mean p set: 0.44636374711990356The modified gen p mean: 0.44678202271461487, gen p mean: -0.04267394170165062, mean p set: 0.44726231694221497
loss_pred:0.013733789324760437, decouple_loss:0.0011834414908662438
loss_pred:0.012713770382106304, decouple_loss:0.001180628314614296
Iteration: 3826, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479919672012329, gen p mean: -0.043153706938028336, mean p set: 0.448472261428833
loss_pred:0.012561238370835781, decouple_loss:0.0010754336835816503
The modified gen p mean: 0.4476761221885681, gen p mean: -0.04325258359313011, mean p set: 0.4481564164161682The modified gen p mean: 0.4500880539417267, gen p mean: -0.043698158115148544, mean p set: 0.4505683481693268
loss_pred:0.01283945795148611, decouple_loss:0.0010355031117796898
loss_pred:0.012481058947741985, decouple_loss:0.0011018532095476985
Iteration: 3827, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495560824871063, gen p mean: -0.04099379852414131, mean p set: 0.4500364065170288
loss_pred:0.012675413861870766, decouple_loss:0.0011189900105819106
The modified gen p mean: 0.44725272059440613, gen p mean: -0.043482717126607895, mean p set: 0.4477330446243286The modified gen p mean: 0.4480733871459961, gen p mean: -0.0418890006840229, mean p set: 0.4485537111759186
loss_pred:0.013849989511072636, decouple_loss:0.0011739456094801426
loss_pred:0.012895841151475906, decouple_loss:0.0010828912490978837
Iteration: 3828, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482479691505432, gen p mean: -0.04132886230945587, mean p set: 0.4487282633781433
loss_pred:0.013222316280007362, decouple_loss:0.0012074921978637576
The modified gen p mean: 0.4484303593635559, gen p mean: -0.04008488729596138, mean p set: 0.4489106833934784The modified gen p mean: 0.44762858748435974, gen p mean: -0.04086180403828621, mean p set: 0.4481089115142822
loss_pred:0.013239849358797073, decouple_loss:0.0010685045272111893
loss_pred:0.013781942427158356, decouple_loss:0.0010513338493183255
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012005_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012005_3_24hr.npz
NaN value num: 0
Iteration: 3829, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45174407958984375, gen p mean: -0.03787776827812195, mean p set: 0.45222437381744385
loss_pred:0.01575673744082451, decouple_loss:0.0012053758837282658
The modified gen p mean: 0.45038139820098877, gen p mean: -0.03002307191491127, mean p set: 0.45086169242858887The modified gen p mean: 0.45024573802948, gen p mean: -0.0344870425760746, mean p set: 0.4507260322570801
loss_pred:0.016221890226006508, decouple_loss:0.0011238229926675558
loss_pred:0.01590084284543991, decouple_loss:0.0011000327067449689
Iteration: 3830, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45290035009384155, gen p mean: -0.02729753404855728, mean p set: 0.45338064432144165
loss_pred:0.01584053225815296, decouple_loss:0.0011203141184523702
The modified gen p mean: 0.4513079524040222, gen p mean: -0.02974378690123558, mean p set: 0.4517882466316223The modified gen p mean: 0.452301561832428, gen p mean: -0.03096531517803669, mean p set: 0.4527818560600281
loss_pred:0.015524035319685936, decouple_loss:0.0011526495218276978
loss_pred:0.014743544161319733, decouple_loss:0.001093312632292509
2023-05-02 17:06:07 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.03834214061498642, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.035049788653850555, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.03498825058341026, mean p set: 0.4500633478164673
loss_pred:0.01875731348991394, decouple_loss:0.0012661442160606384
loss_pred:0.017631910741329193, decouple_loss:0.0013693628134205937
loss_pred:0.017701363191008568, decouple_loss:0.0012757779331877828
WV_0_PC_1_EH_0_PS_40, loss: 0.018095385283231735, avg_mse: 0.02626313455402851
current test mse: 0.026263
Iteration: 3831, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4512365460395813, gen p mean: -0.026870569214224815, mean p set: 0.451716810464859
The modified gen p mean: 0.4519379734992981, gen p mean: -0.031072529032826424, mean p set: 0.4524182975292206
The modified gen p mean: 0.4523387849330902, gen p mean: -0.029023390263319016, mean p set: 0.4528190791606903
loss_pred:0.015471138060092926, decouple_loss:0.0011316349264234304
loss_pred:0.015232323668897152, decouple_loss:0.00112165289465338
loss_pred:0.01547421608120203, decouple_loss:0.001037442241795361
Iteration: 3832, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4518640637397766, gen p mean: -0.024535266682505608, mean p set: 0.4523443579673767
loss_pred:0.01498685497790575, decouple_loss:0.0010982633102685213
The modified gen p mean: 0.45383355021476746, gen p mean: -0.027734898030757904, mean p set: 0.45431381464004517The modified gen p mean: 0.45240917801856995, gen p mean: -0.029135726392269135, mean p set: 0.45288947224617004
loss_pred:0.015289961360394955, decouple_loss:0.0011426714481785893
loss_pred:0.015070573426783085, decouple_loss:0.0012294234475120902
Iteration: 3833, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45060399174690247, gen p mean: -0.023377643898129463, mean p set: 0.45108428597450256
loss_pred:0.0152572738006711, decouple_loss:0.001111245946958661
The modified gen p mean: 0.4505912661552429, gen p mean: -0.025685733184218407, mean p set: 0.451071560382843The modified gen p mean: 0.45201167464256287, gen p mean: -0.026074383407831192, mean p set: 0.45249199867248535
loss_pred:0.015366172417998314, decouple_loss:0.0011275728465989232
loss_pred:0.015513679012656212, decouple_loss:0.0011809254065155983
Iteration: 3834, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4540459215641022, gen p mean: -0.028381790965795517, mean p set: 0.45452621579170227
loss_pred:0.014153708703815937, decouple_loss:0.0013585938140749931
The modified gen p mean: 0.4494636654853821, gen p mean: -0.025282954797148705, mean p set: 0.4499439597129822The modified gen p mean: 0.45404502749443054, gen p mean: -0.02960294485092163, mean p set: 0.45452532172203064
loss_pred:0.014809741638600826, decouple_loss:0.0012322569964453578
loss_pred:0.015261664055287838, decouple_loss:0.0012632448924705386
Iteration: 3835, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507405161857605, gen p mean: -0.027998920530080795, mean p set: 0.4512208104133606
loss_pred:0.015514745377004147, decouple_loss:0.0012362927664071321
The modified gen p mean: 0.450423002243042, gen p mean: -0.029242180287837982, mean p set: 0.4509033262729645The modified gen p mean: 0.45204100012779236, gen p mean: -0.02378859370946884, mean p set: 0.45252126455307007
loss_pred:0.015266576781868935, decouple_loss:0.0012218967312946916
loss_pred:0.014551826752722263, decouple_loss:0.001195786870084703
Iteration: 3836, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4528244137763977, gen p mean: -0.028968462720513344, mean p set: 0.4533047676086426
loss_pred:0.015502006746828556, decouple_loss:0.0011444848496466875
The modified gen p mean: 0.4514361023902893, gen p mean: -0.02615370787680149, mean p set: 0.4519164264202118The modified gen p mean: 0.4519462585449219, gen p mean: -0.029890896752476692, mean p set: 0.45242658257484436
loss_pred:0.015275985933840275, decouple_loss:0.0012719014193862677
loss_pred:0.015524172224104404, decouple_loss:0.0011048185406252742
Iteration: 3837, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4525851309299469, gen p mean: -0.02817753702402115, mean p set: 0.453065425157547
loss_pred:0.01564374566078186, decouple_loss:0.0011363981757313013
The modified gen p mean: 0.4493984580039978, gen p mean: -0.031605299562215805, mean p set: 0.4498787522315979The modified gen p mean: 0.45183470845222473, gen p mean: -0.02513555996119976, mean p set: 0.45231500267982483
loss_pred:0.014597767032682896, decouple_loss:0.0011620388831943274
loss_pred:0.014512644149363041, decouple_loss:0.001238859025761485
Iteration: 3838, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511702358722687, gen p mean: -0.02910194918513298, mean p set: 0.4516505002975464
loss_pred:0.01481919176876545, decouple_loss:0.0010180803947150707
The modified gen p mean: 0.45040592551231384, gen p mean: -0.03091742843389511, mean p set: 0.45088624954223633The modified gen p mean: 0.4501189887523651, gen p mean: -0.0325903445482254, mean p set: 0.4505993127822876
loss_pred:0.015078590251505375, decouple_loss:0.0010466388193890452
loss_pred:0.015017956495285034, decouple_loss:0.0010011428967118263
Iteration: 3839, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4510310888290405, gen p mean: -0.034710273146629333, mean p set: 0.4515113830566406
loss_pred:0.01481639500707388, decouple_loss:0.0011871462920680642
The modified gen p mean: 0.4534416198730469, gen p mean: -0.03353250026702881, mean p set: 0.453921914100647The modified gen p mean: 0.4519652724266052, gen p mean: -0.03525625541806221, mean p set: 0.4524455666542053
loss_pred:0.01519086305052042, decouple_loss:0.0012883496237918735
loss_pred:0.01499119121581316, decouple_loss:0.0012361474800854921
Iteration: 3840, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4527290463447571, gen p mean: -0.03650372847914696, mean p set: 0.4532093107700348
loss_pred:0.015057251788675785, decouple_loss:0.0011554911034181714
The modified gen p mean: 0.45042428374290466, gen p mean: -0.03970937058329582, mean p set: 0.45090457797050476The modified gen p mean: 0.4499375820159912, gen p mean: -0.03472048416733742, mean p set: 0.4504178762435913
loss_pred:0.015015359036624432, decouple_loss:0.0011724941432476044
loss_pred:0.015202023088932037, decouple_loss:0.001010761596262455
2023-05-02 17:08:01 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.045902568846940994, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04238523542881012, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.042518094182014465, mean p set: 0.4500633478164673
loss_pred:0.01851915381848812, decouple_loss:0.001239007106050849
loss_pred:0.017410289496183395, decouple_loss:0.0012080444721505046
loss_pred:0.017484210431575775, decouple_loss:0.0011185214389115572
WV_0_PC_1_EH_0_PS_40, loss: 0.017863977700471878, avg_mse: 0.02581496722996235
current test mse: 0.025815
Iteration: 3841, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.454100102186203, gen p mean: -0.0395686998963356, mean p set: 0.4545804262161255
The modified gen p mean: 0.4503896236419678, gen p mean: -0.03702499344944954, mean p set: 0.45086991786956787
The modified gen p mean: 0.4531160593032837, gen p mean: -0.04459339752793312, mean p set: 0.4535963535308838
loss_pred:0.01508447714149952, decouple_loss:0.0010902265785261989
loss_pred:0.01511035393923521, decouple_loss:0.001187651650980115
loss_pred:0.015183390118181705, decouple_loss:0.00108437892049551
Iteration: 3842, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45159250497817993, gen p mean: -0.035081539303064346, mean p set: 0.4520728290081024
loss_pred:0.014834931120276451, decouple_loss:0.0011095423251390457
The modified gen p mean: 0.44958359003067017, gen p mean: -0.039963096380233765, mean p set: 0.45006391406059265The modified gen p mean: 0.45161470770835876, gen p mean: -0.035913050174713135, mean p set: 0.45209503173828125
loss_pred:0.014774802140891552, decouple_loss:0.0011812738375738263
loss_pred:0.014592626132071018, decouple_loss:0.0012296114582568407
Iteration: 3843, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507555365562439, gen p mean: -0.04011734947562218, mean p set: 0.451235830783844
loss_pred:0.014267662540078163, decouple_loss:0.001062518684193492
The modified gen p mean: 0.4505560100078583, gen p mean: -0.04230039194226265, mean p set: 0.4510363042354584The modified gen p mean: 0.4497024118900299, gen p mean: -0.043164778500795364, mean p set: 0.45018270611763
loss_pred:0.015148794278502464, decouple_loss:0.001061597024090588
loss_pred:0.014371778815984726, decouple_loss:0.001012981403619051
Iteration: 3844, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450573205947876, gen p mean: -0.030978810042142868, mean p set: 0.45105352997779846
loss_pred:0.01595195382833481, decouple_loss:0.0012882637092843652
The modified gen p mean: 0.45198854804039, gen p mean: -0.042355336248874664, mean p set: 0.4524688422679901The modified gen p mean: 0.4505847990512848, gen p mean: -0.03823408484458923, mean p set: 0.4510650634765625
loss_pred:0.015194891020655632, decouple_loss:0.0012386722955852747
loss_pred:0.014838936738669872, decouple_loss:0.0010614763014018536
Iteration: 3845, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45117464661598206, gen p mean: -0.030827630311250687, mean p set: 0.45165497064590454
loss_pred:0.016090042889118195, decouple_loss:0.0010930963326245546
The modified gen p mean: 0.45228126645088196, gen p mean: -0.037600137293338776, mean p set: 0.45276156067848206The modified gen p mean: 0.45334434509277344, gen p mean: -0.03320714831352234, mean p set: 0.45382463932037354
loss_pred:0.014808627776801586, decouple_loss:0.001116209663450718
loss_pred:0.015301285311579704, decouple_loss:0.0010686521418392658
Iteration: 3846, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45258834958076477, gen p mean: -0.0330895334482193, mean p set: 0.45306864380836487
loss_pred:0.01519404724240303, decouple_loss:0.0011898248922079802
The modified gen p mean: 0.4512014091014862, gen p mean: -0.03185132518410683, mean p set: 0.4516817331314087The modified gen p mean: 0.45310527086257935, gen p mean: -0.03948381915688515, mean p set: 0.45358556509017944
loss_pred:0.015287998132407665, decouple_loss:0.0011844771215692163
loss_pred:0.015120098367333412, decouple_loss:0.0011300906771793962
Iteration: 3847, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4532493054866791, gen p mean: -0.03271405026316643, mean p set: 0.4537295699119568
loss_pred:0.015075614675879478, decouple_loss:0.0011394654866307974
The modified gen p mean: 0.4548640251159668, gen p mean: -0.036168422549963, mean p set: 0.4553443193435669The modified gen p mean: 0.45217081904411316, gen p mean: -0.030623706057667732, mean p set: 0.45265111327171326
loss_pred:0.015351206995546818, decouple_loss:0.0012050309451296926
loss_pred:0.014645949937403202, decouple_loss:0.0011072364868596196
Iteration: 3848, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4530910849571228, gen p mean: -0.03252902626991272, mean p set: 0.4535713791847229
loss_pred:0.015020542778074741, decouple_loss:0.0010207697050645947
The modified gen p mean: 0.45273321866989136, gen p mean: -0.033123407512903214, mean p set: 0.45321348309516907The modified gen p mean: 0.44977107644081116, gen p mean: -0.037694301456213, mean p set: 0.45025137066841125
loss_pred:0.015211707912385464, decouple_loss:0.0010528372367843986
loss_pred:0.015009135939180851, decouple_loss:0.0011065463768318295
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012001_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012001_3_24hr.npz
NaN value num: 0
Iteration: 3849, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4516104459762573, gen p mean: -0.03008235991001129, mean p set: 0.4520907402038574
loss_pred:0.015364877879619598, decouple_loss:0.0009782236302271485
The modified gen p mean: 0.45164602994918823, gen p mean: -0.030847908928990364, mean p set: 0.45212632417678833The modified gen p mean: 0.45130500197410583, gen p mean: -0.03702733665704727, mean p set: 0.45178526639938354
loss_pred:0.014822096563875675, decouple_loss:0.0010605150600895286
loss_pred:0.01576637662947178, decouple_loss:0.0012174976291134953
Iteration: 3850, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45123812556266785, gen p mean: -0.030130535364151, mean p set: 0.45171838998794556
The modified gen p mean: 0.45068320631980896, gen p mean: -0.029230548068881035, mean p set: 0.45116350054740906
loss_pred:0.015473336912691593, decouple_loss:0.0009296821663156152
loss_pred:0.015635961666703224, decouple_loss:0.000980528537184
The modified gen p mean: 0.4528735876083374, gen p mean: -0.028784949332475662, mean p set: 0.4533538818359375
loss_pred:0.014978460036218166, decouple_loss:0.001048101345077157
2023-05-02 17:10:33 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.04199191927909851, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.03883834555745125, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.03871607035398483, mean p set: 0.4500633478164673
loss_pred:0.018336573615670204, decouple_loss:0.001190568902529776
loss_pred:0.017272070050239563, decouple_loss:0.001149168238043785
loss_pred:0.017339322715997696, decouple_loss:0.001153177348896861
WV_0_PC_1_EH_0_PS_40, loss: 0.01770753785967827, avg_mse: 0.025516094639897346
current test mse: 0.025516
Iteration: 3851, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508376121520996, gen p mean: -0.03102884069085121, mean p set: 0.4513179063796997
The modified gen p mean: 0.45145854353904724, gen p mean: -0.0289155263453722, mean p set: 0.45193883776664734
The modified gen p mean: 0.45128321647644043, gen p mean: -0.03214608505368233, mean p set: 0.4517635107040405
loss_pred:0.014957182109355927, decouple_loss:0.0009755495120771229
loss_pred:0.016088945791125298, decouple_loss:0.0009819011902436614
loss_pred:0.01577121578156948, decouple_loss:0.0009528068476356566
Iteration: 3852, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4532676339149475, gen p mean: -0.028813358396291733, mean p set: 0.45374795794487
loss_pred:0.014774873852729797, decouple_loss:0.0010574867483228445
The modified gen p mean: 0.45202162861824036, gen p mean: -0.03391721472144127, mean p set: 0.45250189304351807The modified gen p mean: 0.4519748389720917, gen p mean: -0.033546559512615204, mean p set: 0.4524551033973694
loss_pred:0.015220150351524353, decouple_loss:0.0010274696396663785
loss_pred:0.015007542446255684, decouple_loss:0.0010173203190788627
Iteration: 3853, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4521545469760895, gen p mean: -0.039993081241846085, mean p set: 0.4526348412036896
loss_pred:0.015511889941990376, decouple_loss:0.0010193785419687629
The modified gen p mean: 0.4523485600948334, gen p mean: -0.02980494312942028, mean p set: 0.45282885432243347
The modified gen p mean: 0.4513355493545532, gen p mean: -0.03170633316040039, mean p set: 0.4518158733844757
loss_pred:0.014513294212520123, decouple_loss:0.001025836681947112
loss_pred:0.015820292755961418, decouple_loss:0.0010055904276669025
Iteration: 3854, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4516487717628479, gen p mean: -0.0350247398018837, mean p set: 0.4521290957927704
loss_pred:0.014892918057739735, decouple_loss:0.0010110038565471768
The modified gen p mean: 0.45170262455940247, gen p mean: -0.033366087824106216, mean p set: 0.45218291878700256The modified gen p mean: 0.4518086612224579, gen p mean: -0.03767935559153557, mean p set: 0.452288955450058
loss_pred:0.014871625229716301, decouple_loss:0.0011153760133311152
loss_pred:0.015769224613904953, decouple_loss:0.0010918865446001291
Iteration: 3855, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4527490735054016, gen p mean: -0.04031930863857269, mean p set: 0.4532293677330017
loss_pred:0.014999272301793098, decouple_loss:0.0010213506175205112
The modified gen p mean: 0.4521564841270447, gen p mean: -0.04354317486286163, mean p set: 0.4526367783546448The modified gen p mean: 0.4513283371925354, gen p mean: -0.04214991629123688, mean p set: 0.4518086314201355
loss_pred:0.015187738463282585, decouple_loss:0.0009546342771500349
loss_pred:0.015762561932206154, decouple_loss:0.000992080196738243
Iteration: 3856, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4534478485584259, gen p mean: -0.038810525089502335, mean p set: 0.4539281725883484
loss_pred:0.014799381606280804, decouple_loss:0.0010695703094825149
The modified gen p mean: 0.45120954513549805, gen p mean: -0.042384855449199677, mean p set: 0.45168986916542053The modified gen p mean: 0.45133915543556213, gen p mean: -0.041068948805332184, mean p set: 0.45181941986083984
loss_pred:0.015539000742137432, decouple_loss:0.0009810624178498983
loss_pred:0.015335183590650558, decouple_loss:0.001023894059471786
Iteration: 3857, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4515265226364136, gen p mean: -0.0434407964348793, mean p set: 0.45200681686401367
loss_pred:0.014876854605972767, decouple_loss:0.0010378910228610039
The modified gen p mean: 0.45055311918258667, gen p mean: -0.04929535463452339, mean p set: 0.45103341341018677The modified gen p mean: 0.45107680559158325, gen p mean: -0.04368485137820244, mean p set: 0.45155712962150574
loss_pred:0.014925908297300339, decouple_loss:0.0009106163633987308
loss_pred:0.015400860458612442, decouple_loss:0.0010898900218307972
Iteration: 3858, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505007266998291, gen p mean: -0.04377979785203934, mean p set: 0.4509810209274292
loss_pred:0.01585034281015396, decouple_loss:0.0010403449414297938
The modified gen p mean: 0.4533770978450775, gen p mean: -0.04270579665899277, mean p set: 0.453857421875The modified gen p mean: 0.45091116428375244, gen p mean: -0.044124554842710495, mean p set: 0.4513914883136749
loss_pred:0.01516876369714737, decouple_loss:0.0009734400664456189
loss_pred:0.01479750033468008, decouple_loss:0.0010645210277289152
Iteration: 3859, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45009109377861023, gen p mean: -0.041532840579748154, mean p set: 0.4505713880062103
loss_pred:0.01533081941306591, decouple_loss:0.0009946009377017617
The modified gen p mean: 0.45083943009376526, gen p mean: -0.04324936866760254, mean p set: 0.45131972432136536The modified gen p mean: 0.4511992931365967, gen p mean: -0.04248158261179924, mean p set: 0.4516795575618744
loss_pred:0.015302845276892185, decouple_loss:0.0009040022268891335
loss_pred:0.015316690318286419, decouple_loss:0.000895870674867183
Iteration: 3860, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45168137550354004, gen p mean: -0.040970634669065475, mean p set: 0.4521616995334625
loss_pred:0.015289939008653164, decouple_loss:0.000925596512388438
The modified gen p mean: 0.45144495368003845, gen p mean: -0.048365529626607895, mean p set: 0.45192527770996094The modified gen p mean: 0.4503172039985657, gen p mean: -0.04167165979743004, mean p set: 0.45079749822616577
loss_pred:0.015561862848699093, decouple_loss:0.0010772459208965302
loss_pred:0.015635009855031967, decouple_loss:0.0010021644411608577
2023-05-02 17:12:27 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.05085279792547226, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.047301966696977615, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04745051637291908, mean p set: 0.4500633478164673
loss_pred:0.01839534007012844, decouple_loss:0.00119962717872113
loss_pred:0.017253991216421127, decouple_loss:0.001174739794805646
loss_pred:0.017381763085722923, decouple_loss:0.0012601625639945269
WV_0_PC_1_EH_0_PS_40, loss: 0.017737606540322304, avg_mse: 0.025545530021190643
current test mse: 0.025546
Iteration: 3861, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4526425898075104, gen p mean: -0.048182714730501175, mean p set: 0.4531228840351105
The modified gen p mean: 0.45352527499198914, gen p mean: -0.03909938037395477, mean p set: 0.45400553941726685
The modified gen p mean: 0.45036497712135315, gen p mean: -0.03977792337536812, mean p set: 0.45084527134895325
loss_pred:0.01579541712999344, decouple_loss:0.0010408140951767564
loss_pred:0.01534379180520773, decouple_loss:0.0010600201785564423
loss_pred:0.014678392559289932, decouple_loss:0.0010176434880122542
Iteration: 3862, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4529801309108734, gen p mean: -0.039507534354925156, mean p set: 0.4534603953361511
loss_pred:0.01493274699896574, decouple_loss:0.0009393685613758862
The modified gen p mean: 0.45081254839897156, gen p mean: -0.04055817797780037, mean p set: 0.45129284262657166The modified gen p mean: 0.4515432119369507, gen p mean: -0.039210304617881775, mean p set: 0.4520235061645508
loss_pred:0.01482751127332449, decouple_loss:0.000910943781491369
loss_pred:0.015246083028614521, decouple_loss:0.0009701651288196445
Iteration: 3863, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45159712433815, gen p mean: -0.049284353852272034, mean p set: 0.4520774185657501
loss_pred:0.015157864429056644, decouple_loss:0.0011688752565532923
The modified gen p mean: 0.4514845609664917, gen p mean: -0.04353492334485054, mean p set: 0.4519648849964142The modified gen p mean: 0.45086491107940674, gen p mean: -0.038338273763656616, mean p set: 0.45134520530700684
loss_pred:0.01554837729781866, decouple_loss:0.001062548253685236
loss_pred:0.016275709494948387, decouple_loss:0.0009178688051179051
Iteration: 3864, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4521265923976898, gen p mean: -0.041539859026670456, mean p set: 0.4526068866252899
loss_pred:0.015415754169225693, decouple_loss:0.0009976801229640841
The modified gen p mean: 0.45115646719932556, gen p mean: -0.03996073082089424, mean p set: 0.45163676142692566The modified gen p mean: 0.45398658514022827, gen p mean: -0.04042565077543259, mean p set: 0.45446687936782837
loss_pred:0.015185128897428513, decouple_loss:0.0009542489424347878
loss_pred:0.014882993884384632, decouple_loss:0.0009900921722874045
Iteration: 3865, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45079857110977173, gen p mean: -0.04067979380488396, mean p set: 0.4512788653373718
loss_pred:0.01564290188252926, decouple_loss:0.001031008898280561
The modified gen p mean: 0.45076414942741394, gen p mean: -0.040525857359170914, mean p set: 0.45124444365501404The modified gen p mean: 0.45175886154174805, gen p mean: -0.04136377200484276, mean p set: 0.45223915576934814
loss_pred:0.015328890644013882, decouple_loss:0.00103248271625489
loss_pred:0.01584635116159916, decouple_loss:0.0010230193147435784
Iteration: 3866, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4512366056442261, gen p mean: -0.039541129022836685, mean p set: 0.45171689987182617
loss_pred:0.01586434245109558, decouple_loss:0.001030737184919417
The modified gen p mean: 0.45261451601982117, gen p mean: -0.03890791907906532, mean p set: 0.45309484004974365The modified gen p mean: 0.45364895462989807, gen p mean: -0.03957337141036987, mean p set: 0.45412924885749817
loss_pred:0.0148491645231843, decouple_loss:0.000918801873922348
loss_pred:0.0147240050137043, decouple_loss:0.0009448767523281276
Iteration: 3867, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45068272948265076, gen p mean: -0.040932852774858475, mean p set: 0.45116302371025085
loss_pred:0.015828929841518402, decouple_loss:0.0009431362268514931
The modified gen p mean: 0.45204201340675354, gen p mean: -0.04981169477105141, mean p set: 0.45252230763435364The modified gen p mean: 0.45112499594688416, gen p mean: -0.038309261202812195, mean p set: 0.45160529017448425
loss_pred:0.015368571504950523, decouple_loss:0.0009981347247958183
loss_pred:0.015280871652066708, decouple_loss:0.0011503505520522594
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012013_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012013_3_24hr.npz
NaN value num: 0
Iteration: 3868, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466501772403717, gen p mean: -0.05189145356416702, mean p set: 0.4471304714679718
loss_pred:0.014572587795555592, decouple_loss:0.0012397569371387362
The modified gen p mean: 0.44725653529167175, gen p mean: -0.0490494929254055, mean p set: 0.44773682951927185The modified gen p mean: 0.44654765725135803, gen p mean: -0.048714105039834976, mean p set: 0.44702792167663574
loss_pred:0.014264429919421673, decouple_loss:0.0011663215700536966
loss_pred:0.014378965832293034, decouple_loss:0.0012109905946999788
Iteration: 3869, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44630759954452515, gen p mean: -0.05326446518301964, mean p set: 0.44678789377212524
loss_pred:0.013789934106171131, decouple_loss:0.001008134218864143
The modified gen p mean: 0.4474700093269348, gen p mean: -0.05532483756542206, mean p set: 0.4479503035545349The modified gen p mean: 0.44658491015434265, gen p mean: -0.05746762081980705, mean p set: 0.44706523418426514
loss_pred:0.014333355240523815, decouple_loss:0.0010955019388347864
loss_pred:0.013425384648144245, decouple_loss:0.0009845485910773277
Iteration: 3870, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44661709666252136, gen p mean: -0.055916156619787216, mean p set: 0.44709739089012146
loss_pred:0.014610343612730503, decouple_loss:0.0011241394095122814
The modified gen p mean: 0.4467817544937134, gen p mean: -0.05701464042067528, mean p set: 0.44726207852363586The modified gen p mean: 0.44611862301826477, gen p mean: -0.057796064764261246, mean p set: 0.44659891724586487
loss_pred:0.014444885775446892, decouple_loss:0.0010360055603086948
loss_pred:0.014177156612277031, decouple_loss:0.001225166255608201
2023-05-02 17:14:56 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.059802621603012085, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.056064948439598083, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.05635055899620056, mean p set: 0.4500633478164673
loss_pred:0.01870943233370781, decouple_loss:0.001189372967928648
loss_pred:0.017546216025948524, decouple_loss:0.0011472605401650071
loss_pred:0.017605839297175407, decouple_loss:0.001168910413980484
WV_0_PC_1_EH_0_PS_40, loss: 0.018012255430221558, avg_mse: 0.0260859876871109
current test mse: 0.026086
Iteration: 3871, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472186267375946, gen p mean: -0.05835677683353424, mean p set: 0.4476989209651947
The modified gen p mean: 0.4465055763721466, gen p mean: -0.05853578820824623, mean p set: 0.4469858705997467
The modified gen p mean: 0.4474562704563141, gen p mean: -0.05685523524880409, mean p set: 0.4479365348815918
loss_pred:0.014364597387611866, decouple_loss:0.0011194278486073017
loss_pred:0.014203933998942375, decouple_loss:0.0011595499236136675
loss_pred:0.014165646396577358, decouple_loss:0.0011272645788267255
Iteration: 3872, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44668835401535034, gen p mean: -0.05568468198180199, mean p set: 0.44716861844062805
loss_pred:0.013764286413788795, decouple_loss:0.001067178905941546
The modified gen p mean: 0.4476163685321808, gen p mean: -0.054017044603824615, mean p set: 0.4480966627597809The modified gen p mean: 0.4465186297893524, gen p mean: -0.05568525940179825, mean p set: 0.4469989240169525
loss_pred:0.013961032032966614, decouple_loss:0.0011648033978417516
loss_pred:0.014146676287055016, decouple_loss:0.001075132517144084
Iteration: 3873, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44773462414741516, gen p mean: -0.05152096599340439, mean p set: 0.44821488857269287
loss_pred:0.013920868746936321, decouple_loss:0.0010979999788105488
The modified gen p mean: 0.4463469684123993, gen p mean: -0.05593220517039299, mean p set: 0.4468272626399994The modified gen p mean: 0.4469921588897705, gen p mean: -0.059706319123506546, mean p set: 0.4474724233150482
loss_pred:0.013939703814685345, decouple_loss:0.0012880474096164107
loss_pred:0.013678010553121567, decouple_loss:0.0015741785755380988
Iteration: 3874, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44697436690330505, gen p mean: -0.05953557416796684, mean p set: 0.44745466113090515
loss_pred:0.013631809502840042, decouple_loss:0.0012927214847877622
The modified gen p mean: 0.44666650891304016, gen p mean: -0.05762079358100891, mean p set: 0.44714680314064026The modified gen p mean: 0.4465397000312805, gen p mean: -0.05406782403588295, mean p set: 0.4470199644565582
loss_pred:0.014132303185760975, decouple_loss:0.0011764810187742114
loss_pred:0.014302697032690048, decouple_loss:0.0012414602097123861
Iteration: 3875, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44590476155281067, gen p mean: -0.05278642103075981, mean p set: 0.44638508558273315
loss_pred:0.013682074844837189, decouple_loss:0.0012189445551484823
The modified gen p mean: 0.44697141647338867, gen p mean: -0.054058514535427094, mean p set: 0.44745174050331116The modified gen p mean: 0.44574326276779175, gen p mean: -0.05629543215036392, mean p set: 0.44622352719306946
loss_pred:0.013859403319656849, decouple_loss:0.0013469831319525838
loss_pred:0.014165572822093964, decouple_loss:0.001348277903161943
Iteration: 3876, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470585584640503, gen p mean: -0.05335024371743202, mean p set: 0.4475388824939728
loss_pred:0.013219541870057583, decouple_loss:0.001289451727643609
The modified gen p mean: 0.44674399495124817, gen p mean: -0.05712994560599327, mean p set: 0.44722431898117065The modified gen p mean: 0.4455907940864563, gen p mean: -0.05187109485268593, mean p set: 0.4460710883140564
loss_pred:0.013400765135884285, decouple_loss:0.0011674806009978056
loss_pred:0.01380778569728136, decouple_loss:0.001155772595666349
Iteration: 3877, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466029703617096, gen p mean: -0.05239202827215195, mean p set: 0.4470832645893097
loss_pred:0.013359894044697285, decouple_loss:0.0012628607219085097
The modified gen p mean: 0.44677552580833435, gen p mean: -0.05814909189939499, mean p set: 0.44725584983825684The modified gen p mean: 0.44695645570755005, gen p mean: -0.0586431510746479, mean p set: 0.44743674993515015
loss_pred:0.013539273291826248, decouple_loss:0.0012378605315461755
loss_pred:0.013712444342672825, decouple_loss:0.0013051597634330392
Iteration: 3878, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44701576232910156, gen p mean: -0.052892059087753296, mean p set: 0.44749605655670166
loss_pred:0.013376405462622643, decouple_loss:0.001325925113633275
The modified gen p mean: 0.447532594203949, gen p mean: -0.05405952408909798, mean p set: 0.4480128884315491The modified gen p mean: 0.4478497803211212, gen p mean: -0.05610968545079231, mean p set: 0.4483300447463989
loss_pred:0.014432424679398537, decouple_loss:0.0011482482077553868
loss_pred:0.013859241269528866, decouple_loss:0.0011730951955541968
Iteration: 3879, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44724833965301514, gen p mean: -0.04975438490509987, mean p set: 0.44772863388061523
loss_pred:0.013675529509782791, decouple_loss:0.001117186271585524
The modified gen p mean: 0.446501761674881, gen p mean: -0.051296282559633255, mean p set: 0.44698208570480347The modified gen p mean: 0.44626617431640625, gen p mean: -0.051022306084632874, mean p set: 0.44674646854400635
loss_pred:0.014059831388294697, decouple_loss:0.0012168181128799915
loss_pred:0.013182689435780048, decouple_loss:0.0011205918854102492
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 3880, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467221796512604, gen p mean: -0.04961922764778137, mean p set: 0.4472024440765381
loss_pred:0.014483404345810413, decouple_loss:0.0012492535170167685
The modified gen p mean: 0.44648703932762146, gen p mean: -0.05120060220360756, mean p set: 0.44696730375289917The modified gen p mean: 0.44795098900794983, gen p mean: -0.053515199571847916, mean p set: 0.4484312832355499
loss_pred:0.013268260285258293, decouple_loss:0.0012148251989856362
loss_pred:0.01368069276213646, decouple_loss:0.0012937939027324319
2023-05-02 17:16:50 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.05229218304157257, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04868046194314957, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.04866011440753937, mean p set: 0.4500633478164673
loss_pred:0.018961627036333084, decouple_loss:0.001142138266004622
loss_pred:0.017809202894568443, decouple_loss:0.0012064836919307709
loss_pred:0.017858799546957016, decouple_loss:0.0011417012428864837
WV_0_PC_1_EH_0_PS_40, loss: 0.018268048763275146, avg_mse: 0.026589879766106606
current test mse: 0.02659
Iteration: 3881, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44720005989074707, gen p mean: -0.04943089187145233, mean p set: 0.44768035411834717
The modified gen p mean: 0.4475097954273224, gen p mean: -0.04937971383333206, mean p set: 0.4479900598526001
The modified gen p mean: 0.4477161765098572, gen p mean: -0.047981590032577515, mean p set: 0.44819650053977966
loss_pred:0.013095451518893242, decouple_loss:0.001016883528791368
loss_pred:0.014157379046082497, decouple_loss:0.0011114217340946198
loss_pred:0.013184198178350925, decouple_loss:0.0011595559772104025
Iteration: 3882, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446255624294281, gen p mean: -0.053198426961898804, mean p set: 0.4467359483242035
loss_pred:0.013646950013935566, decouple_loss:0.0011929223546758294
The modified gen p mean: 0.44624581933021545, gen p mean: -0.05218611657619476, mean p set: 0.44672611355781555The modified gen p mean: 0.44622835516929626, gen p mean: -0.047658950090408325, mean p set: 0.446708619594574
loss_pred:0.013833878561854362, decouple_loss:0.0011687480146065354
loss_pred:0.01376438234001398, decouple_loss:0.0011800485663115978
Iteration: 3883, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446078360080719, gen p mean: -0.052125293761491776, mean p set: 0.4465586841106415
loss_pred:0.013867119327187538, decouple_loss:0.0010532427113503218
The modified gen p mean: 0.4475697875022888, gen p mean: -0.056246355175971985, mean p set: 0.4480500817298889The modified gen p mean: 0.4472411274909973, gen p mean: -0.05846982076764107, mean p set: 0.4477214217185974
loss_pred:0.013511632569134235, decouple_loss:0.0010455464944243431
loss_pred:0.012794140726327896, decouple_loss:0.0010292001534253359
Iteration: 3884, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4459882080554962, gen p mean: -0.05492393299937248, mean p set: 0.4464685022830963
loss_pred:0.013832501135766506, decouple_loss:0.0010460104094818234
The modified gen p mean: 0.4474034011363983, gen p mean: -0.05429629981517792, mean p set: 0.447883665561676The modified gen p mean: 0.44708752632141113, gen p mean: -0.05451060086488724, mean p set: 0.44756782054901123
loss_pred:0.013719742186367512, decouple_loss:0.0010046698153018951
loss_pred:0.013175073079764843, decouple_loss:0.0010085806716233492
Iteration: 3885, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473629593849182, gen p mean: -0.05928545072674751, mean p set: 0.4478432536125183
loss_pred:0.013708624057471752, decouple_loss:0.0010699030244722962
The modified gen p mean: 0.4465286433696747, gen p mean: -0.055814359337091446, mean p set: 0.44700896739959717The modified gen p mean: 0.4476061463356018, gen p mean: -0.05676970258355141, mean p set: 0.4480864405632019
loss_pred:0.013516156934201717, decouple_loss:0.001046062563546002
loss_pred:0.013630765490233898, decouple_loss:0.0011346993269398808
Iteration: 3886, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475902318954468, gen p mean: -0.05356885865330696, mean p set: 0.4480704963207245
loss_pred:0.013487771153450012, decouple_loss:0.0010827170917764306
The modified gen p mean: 0.4458150565624237, gen p mean: -0.05183962732553482, mean p set: 0.4462953209877014The modified gen p mean: 0.44710981845855713, gen p mean: -0.0546070896089077, mean p set: 0.4475901126861572
loss_pred:0.013269337825477123, decouple_loss:0.0010882485657930374
loss_pred:0.013833099976181984, decouple_loss:0.0010869894176721573
Iteration: 3887, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44697561860084534, gen p mean: -0.04836259409785271, mean p set: 0.44745591282844543
loss_pred:0.013648055493831635, decouple_loss:0.0010891994461417198
The modified gen p mean: 0.44704368710517883, gen p mean: -0.052034661173820496, mean p set: 0.44752398133277893The modified gen p mean: 0.4463847279548645, gen p mean: -0.04941053315997124, mean p set: 0.4468649923801422
loss_pred:0.01335466280579567, decouple_loss:0.0010841243201866746
loss_pred:0.01379804965108633, decouple_loss:0.00112636829726398
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012018_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012018_3_24hr.npz
NaN value num: 0
Iteration: 3888, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45085054636001587, gen p mean: -0.04460432007908821, mean p set: 0.45133084058761597
loss_pred:0.01626630499958992, decouple_loss:0.00125134049449116
The modified gen p mean: 0.4522593319416046, gen p mean: -0.04382076859474182, mean p set: 0.4527396559715271The modified gen p mean: 0.4505715072154999, gen p mean: -0.04727848246693611, mean p set: 0.45105183124542236
loss_pred:0.015930958092212677, decouple_loss:0.0011813342571258545
loss_pred:0.01743849739432335, decouple_loss:0.001267118495889008
Iteration: 3889, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500759541988373, gen p mean: -0.04106573760509491, mean p set: 0.45055627822875977
loss_pred:0.01656423509120941, decouple_loss:0.001041811192408204
The modified gen p mean: 0.4497382342815399, gen p mean: -0.04326682165265083, mean p set: 0.4502184987068176The modified gen p mean: 0.4499722421169281, gen p mean: -0.041257258504629135, mean p set: 0.4504525363445282
loss_pred:0.015857161954045296, decouple_loss:0.0010331985540688038
loss_pred:0.016632527112960815, decouple_loss:0.0010029770201072097
Iteration: 3890, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4510114789009094, gen p mean: -0.035503316670656204, mean p set: 0.45149174332618713
loss_pred:0.01595202460885048, decouple_loss:0.0011035107308998704
The modified gen p mean: 0.4502720534801483, gen p mean: -0.042412616312503815, mean p set: 0.450752317905426The modified gen p mean: 0.4499695599079132, gen p mean: -0.04203066974878311, mean p set: 0.4504498541355133
loss_pred:0.015811307355761528, decouple_loss:0.0011749587720260024
loss_pred:0.01659891940653324, decouple_loss:0.0011304753134027123
2023-05-02 17:19:27 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.05031133070588112, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.046378590166568756, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.046667709946632385, mean p set: 0.4500633478164673
loss_pred:0.018544761463999748, decouple_loss:0.0013037242460995913
loss_pred:0.017410166561603546, decouple_loss:0.0012398019898682833
loss_pred:0.017495010048151016, decouple_loss:0.0012399242259562016
WV_0_PC_1_EH_0_PS_40, loss: 0.017879704013466835, avg_mse: 0.025830553844571114
current test mse: 0.025831
Iteration: 3891, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45108628273010254, gen p mean: -0.04189047962427139, mean p set: 0.451566606760025
The modified gen p mean: 0.4522046148777008, gen p mean: -0.03630909323692322, mean p set: 0.4526849389076233
The modified gen p mean: 0.4502183198928833, gen p mean: -0.03857274726033211, mean p set: 0.4506986141204834
loss_pred:0.0163597259670496, decouple_loss:0.0011322289938107133
loss_pred:0.017258042469620705, decouple_loss:0.0011233777040615678
loss_pred:0.016013391315937042, decouple_loss:0.0011880795937031507
Iteration: 3892, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4520878493785858, gen p mean: -0.04124876484274864, mean p set: 0.4525681734085083
loss_pred:0.015831517055630684, decouple_loss:0.0010883612558245659
The modified gen p mean: 0.4511641561985016, gen p mean: -0.0417986698448658, mean p set: 0.4516444504261017The modified gen p mean: 0.45066073536872864, gen p mean: -0.04347192496061325, mean p set: 0.45114099979400635
loss_pred:0.01632857322692871, decouple_loss:0.0010384870693087578
loss_pred:0.01668553240597248, decouple_loss:0.0010263200383633375
Iteration: 3893, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4523758292198181, gen p mean: -0.04288210719823837, mean p set: 0.4528560936450958
loss_pred:0.015845905989408493, decouple_loss:0.0012585375225171447
The modified gen p mean: 0.45372727513313293, gen p mean: -0.04024091735482216, mean p set: 0.45420756936073303The modified gen p mean: 0.4495902359485626, gen p mean: -0.04149177670478821, mean p set: 0.4500705301761627
loss_pred:0.015845656394958496, decouple_loss:0.0012820509728044271
loss_pred:0.015777142718434334, decouple_loss:0.001381262787617743
Iteration: 3894, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45096904039382935, gen p mean: -0.04380325973033905, mean p set: 0.45144933462142944
loss_pred:0.015075070783495903, decouple_loss:0.001090781413950026
The modified gen p mean: 0.4508111774921417, gen p mean: -0.04375831410288811, mean p set: 0.4512914717197418The modified gen p mean: 0.4490162134170532, gen p mean: -0.05068417266011238, mean p set: 0.4494965374469757
loss_pred:0.015784066170454025, decouple_loss:0.0011840539518743753
loss_pred:0.016650257632136345, decouple_loss:0.0011655898997560143
Iteration: 3895, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4519071877002716, gen p mean: -0.04354675114154816, mean p set: 0.4523874819278717
loss_pred:0.01541206520050764, decouple_loss:0.0010757687268778682
The modified gen p mean: 0.45059311389923096, gen p mean: -0.05196090787649155, mean p set: 0.45107343792915344The modified gen p mean: 0.4521706998348236, gen p mean: -0.05209161341190338, mean p set: 0.4526509940624237
loss_pred:0.016685981303453445, decouple_loss:0.0012336178915575147
loss_pred:0.01598910614848137, decouple_loss:0.0011656505521386862
Iteration: 3896, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501114785671234, gen p mean: -0.05210291966795921, mean p set: 0.4505917727947235
loss_pred:0.015737464651465416, decouple_loss:0.0012098036240786314
The modified gen p mean: 0.45089730620384216, gen p mean: -0.0510949045419693, mean p set: 0.4513775408267975The modified gen p mean: 0.45219239592552185, gen p mean: -0.05021608620882034, mean p set: 0.45267269015312195
loss_pred:0.01522925402969122, decouple_loss:0.0012381298001855612
loss_pred:0.01575593091547489, decouple_loss:0.0011227913200855255
Iteration: 3897, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45092833042144775, gen p mean: -0.05235017463564873, mean p set: 0.45140859484672546
loss_pred:0.016480593010783195, decouple_loss:0.0010951784206554294
The modified gen p mean: 0.45031100511550903, gen p mean: -0.05272417142987251, mean p set: 0.45079126954078674The modified gen p mean: 0.4515414535999298, gen p mean: -0.04705634340643883, mean p set: 0.4520217776298523
loss_pred:0.015855398029088974, decouple_loss:0.001040361006744206
loss_pred:0.015382170677185059, decouple_loss:0.0011084445286542177
Iteration: 3898, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45009374618530273, gen p mean: -0.049403782933950424, mean p set: 0.4505741000175476
loss_pred:0.016644150018692017, decouple_loss:0.0011799288913607597
The modified gen p mean: 0.4502878189086914, gen p mean: -0.05220377445220947, mean p set: 0.4507681429386139The modified gen p mean: 0.4522205889225006, gen p mean: -0.04854033887386322, mean p set: 0.4527009129524231
loss_pred:0.015833327546715736, decouple_loss:0.0011214051628485322
loss_pred:0.015417429618537426, decouple_loss:0.001145833171904087
Iteration: 3899, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44997653365135193, gen p mean: -0.04995835945010185, mean p set: 0.450456827878952
loss_pred:0.016919808462262154, decouple_loss:0.001035026041790843
The modified gen p mean: 0.4505867660045624, gen p mean: -0.04910721629858017, mean p set: 0.4510670304298401
The modified gen p mean: 0.4526808559894562, gen p mean: -0.0463949516415596, mean p set: 0.4531611502170563
loss_pred:0.015606310218572617, decouple_loss:0.0010083310771733522
loss_pred:0.016073765233159065, decouple_loss:0.0009728755685500801
Iteration: 3900, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45085394382476807, gen p mean: -0.04678712785243988, mean p set: 0.45133426785469055
loss_pred:0.016337059438228607, decouple_loss:0.0009508701623417437
The modified gen p mean: 0.44996288418769836, gen p mean: -0.0473778173327446, mean p set: 0.45044317841529846The modified gen p mean: 0.4506599009037018, gen p mean: -0.04791363701224327, mean p set: 0.4511401653289795
loss_pred:0.01595097966492176, decouple_loss:0.0010002709459513426
loss_pred:0.01620800979435444, decouple_loss:0.0010662672575563192
2023-05-02 17:21:21 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.05494557321071625, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.05119311064481735, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.05141293257474899, mean p set: 0.4500633478164673
loss_pred:0.018432384356856346, decouple_loss:0.0012635308085009456
loss_pred:0.01731906458735466, decouple_loss:0.0011590470094233751
loss_pred:0.017413539811968803, decouple_loss:0.0012259224895387888
WV_0_PC_1_EH_0_PS_40, loss: 0.01778247207403183, avg_mse: 0.025644470006227493
current test mse: 0.025644
Iteration: 3901, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4521578848361969, gen p mean: -0.044219791889190674, mean p set: 0.452638179063797
The modified gen p mean: 0.4500679075717926, gen p mean: -0.04708419740200043, mean p set: 0.4505482017993927
The modified gen p mean: 0.4504055976867676, gen p mean: -0.047158751636743546, mean p set: 0.4508858919143677
loss_pred:0.01601538434624672, decouple_loss:0.000997772323898971
loss_pred:0.01638875901699066, decouple_loss:0.0009811192285269499
loss_pred:0.015979118645191193, decouple_loss:0.0009749233140610158
Iteration: 3902, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4535161852836609, gen p mean: -0.0458686500787735, mean p set: 0.453996479511261
loss_pred:0.015407627448439598, decouple_loss:0.0010972487507387996
The modified gen p mean: 0.45389434695243835, gen p mean: -0.043973103165626526, mean p set: 0.45437467098236084The modified gen p mean: 0.4518769085407257, gen p mean: -0.0433211624622345, mean p set: 0.4523571729660034
loss_pred:0.0153912752866745, decouple_loss:0.0010689834598451853
loss_pred:0.015341958962380886, decouple_loss:0.001097931177355349
Iteration: 3903, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45123782753944397, gen p mean: -0.04730931669473648, mean p set: 0.45171812176704407
loss_pred:0.016537433490157127, decouple_loss:0.0010470121633261442
The modified gen p mean: 0.45030415058135986, gen p mean: -0.050979968160390854, mean p set: 0.45078444480895996The modified gen p mean: 0.4501606822013855, gen p mean: -0.0464857742190361, mean p set: 0.4506409764289856
loss_pred:0.015949569642543793, decouple_loss:0.001110304961912334
loss_pred:0.01601550541818142, decouple_loss:0.001152578741312027
Iteration: 3904, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45147356390953064, gen p mean: -0.04457848146557808, mean p set: 0.45195385813713074
loss_pred:0.0149766830727458, decouple_loss:0.0011620233999565244
The modified gen p mean: 0.45017921924591064, gen p mean: -0.04955693334341049, mean p set: 0.45065951347351074The modified gen p mean: 0.4505920112133026, gen p mean: -0.04758094996213913, mean p set: 0.4510722756385803
loss_pred:0.01567084528505802, decouple_loss:0.0011110121849924326
loss_pred:0.01653093844652176, decouple_loss:0.0010513365268707275
Iteration: 3905, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45250585675239563, gen p mean: -0.04669838771224022, mean p set: 0.4529861509799957
loss_pred:0.015381859615445137, decouple_loss:0.0009909243090078235
The modified gen p mean: 0.45068255066871643, gen p mean: -0.0490332692861557, mean p set: 0.45116284489631653The modified gen p mean: 0.4523325562477112, gen p mean: -0.05004033073782921, mean p set: 0.45281288027763367
loss_pred:0.016013357788324356, decouple_loss:0.0009790525073185563
loss_pred:0.016942523419857025, decouple_loss:0.0009733358747325838
Iteration: 3906, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45253220200538635, gen p mean: -0.04822024703025818, mean p set: 0.45301249623298645
loss_pred:0.015588556416332722, decouple_loss:0.0010241770651191473
The modified gen p mean: 0.45093464851379395, gen p mean: -0.04588882997632027, mean p set: 0.45141491293907166The modified gen p mean: 0.4499717652797699, gen p mean: -0.04830117151141167, mean p set: 0.45045205950737
loss_pred:0.01628684811294079, decouple_loss:0.0011914116330444813
loss_pred:0.01625967212021351, decouple_loss:0.0011448540026322007
Iteration: 3907, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45037972927093506, gen p mean: -0.049610503017902374, mean p set: 0.45086002349853516
loss_pred:0.016182495281100273, decouple_loss:0.0012988168746232986
The modified gen p mean: 0.45046618580818176, gen p mean: -0.04259100183844566, mean p set: 0.4509464502334595The modified gen p mean: 0.45075225830078125, gen p mean: -0.046772733330726624, mean p set: 0.45123252272605896
loss_pred:0.01634758710861206, decouple_loss:0.0012526711216196418
loss_pred:0.015584525652229786, decouple_loss:0.0012530473759397864
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012018_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012018_3_24hr.npz
NaN value num: 0
Iteration: 3908, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.452873170375824, gen p mean: -0.049476075917482376, mean p set: 0.4533534646034241
loss_pred:0.01612001471221447, decouple_loss:0.0010354886762797832
The modified gen p mean: 0.4521256983280182, gen p mean: -0.04880523681640625, mean p set: 0.4526059925556183The modified gen p mean: 0.4534457325935364, gen p mean: -0.05121014639735222, mean p set: 0.4539260268211365
loss_pred:0.016797587275505066, decouple_loss:0.0011971669737249613
loss_pred:0.015917789191007614, decouple_loss:0.0012360195396468043
Iteration: 3909, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45120471715927124, gen p mean: -0.04093872755765915, mean p set: 0.45168498158454895
The modified gen p mean: 0.45190173387527466, gen p mean: -0.04351234808564186, mean p set: 0.45238202810287476loss_pred:0.016523731872439384, decouple_loss:0.0013325299369171262
The modified gen p mean: 0.4537471532821655, gen p mean: -0.04518485069274902, mean p set: 0.45422741770744324
loss_pred:0.015057810582220554, decouple_loss:0.001276137656532228
loss_pred:0.015788307413458824, decouple_loss:0.0012387182796373963
Iteration: 3910, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.451791375875473, gen p mean: -0.03744616359472275, mean p set: 0.45227164030075073
The modified gen p mean: 0.45206931233406067, gen p mean: -0.040425028651952744, mean p set: 0.45254963636398315
loss_pred:0.017151441425085068, decouple_loss:0.0010118552017956972
loss_pred:0.016448887065052986, decouple_loss:0.00106607296038419
The modified gen p mean: 0.4541676640510559, gen p mean: -0.040869276970624924, mean p set: 0.454647958278656
loss_pred:0.015694625675678253, decouple_loss:0.001036370638757944
2023-05-02 17:23:52 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.0513346903026104, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830833911896, gen p mean: -0.04779035970568657, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04794032871723175, mean p set: 0.45035696029663086
loss_pred:0.01838364079594612, decouple_loss:0.0012903147144243121
loss_pred:0.01735895499587059, decouple_loss:0.0012807002058252692
loss_pred:0.017308948561549187, decouple_loss:0.0012594173895195127
WV_0_PC_1_EH_0_PS_40, loss: 0.01774768903851509, avg_mse: 0.025541525334119797
current test mse: 0.025542
Iteration: 3911, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45060786604881287, gen p mean: -0.04000755771994591, mean p set: 0.4510881304740906
The modified gen p mean: 0.4507194459438324, gen p mean: -0.039047855883836746, mean p set: 0.4511997699737549
The modified gen p mean: 0.45329105854034424, gen p mean: -0.04332977533340454, mean p set: 0.4537713825702667
loss_pred:0.016183674335479736, decouple_loss:0.0012413231888785958
loss_pred:0.015631044283509254, decouple_loss:0.0012288354337215424
loss_pred:0.015294838696718216, decouple_loss:0.00119230174459517
Iteration: 3912, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502507746219635, gen p mean: -0.045034848153591156, mean p set: 0.4507310390472412
loss_pred:0.01566084660589695, decouple_loss:0.0011574500240385532
The modified gen p mean: 0.4504154622554779, gen p mean: -0.040073148906230927, mean p set: 0.4508957266807556
The modified gen p mean: 0.45088133215904236, gen p mean: -0.042879343032836914, mean p set: 0.45136159658432007
loss_pred:0.015502629801630974, decouple_loss:0.0010609239106997848
loss_pred:0.01525608915835619, decouple_loss:0.0010476415045559406
Iteration: 3913, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.454966276884079, gen p mean: -0.04192805290222168, mean p set: 0.45544660091400146
loss_pred:0.01549526210874319, decouple_loss:0.001034288085065782
The modified gen p mean: 0.4527311623096466, gen p mean: -0.041064418852329254, mean p set: 0.4532114863395691The modified gen p mean: 0.4529379904270172, gen p mean: -0.039695095270872116, mean p set: 0.4534182846546173
loss_pred:0.01595650240778923, decouple_loss:0.0009437929838895798
loss_pred:0.017190702259540558, decouple_loss:0.0009200243512168527
Iteration: 3914, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4519538879394531, gen p mean: -0.04554305598139763, mean p set: 0.4524341821670532
loss_pred:0.015468589961528778, decouple_loss:0.0009940447052940726
The modified gen p mean: 0.45315924286842346, gen p mean: -0.04700017720460892, mean p set: 0.45363950729370117The modified gen p mean: 0.45238861441612244, gen p mean: -0.04173431545495987, mean p set: 0.45286890864372253
loss_pred:0.016097264364361763, decouple_loss:0.0010282183066010475
loss_pred:0.0176678616553545, decouple_loss:0.000984408427029848
Iteration: 3915, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4533970057964325, gen p mean: -0.04395822063088417, mean p set: 0.4538773000240326
loss_pred:0.01707945205271244, decouple_loss:0.0009650551364757121
The modified gen p mean: 0.45153677463531494, gen p mean: -0.04337408021092415, mean p set: 0.4520170986652374The modified gen p mean: 0.45308905839920044, gen p mean: -0.04805833101272583, mean p set: 0.4535693824291229
loss_pred:0.016500860452651978, decouple_loss:0.0009918203577399254
loss_pred:0.015711136162281036, decouple_loss:0.0008997907279990613
Iteration: 3916, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45320290327072144, gen p mean: -0.04873150959610939, mean p set: 0.4536832273006439
loss_pred:0.015319602563977242, decouple_loss:0.0012170980917289853
The modified gen p mean: 0.4529207944869995, gen p mean: -0.044498562812805176, mean p set: 0.4534010887145996The modified gen p mean: 0.4525775909423828, gen p mean: -0.04297080263495445, mean p set: 0.4530578553676605
loss_pred:0.015769552439451218, decouple_loss:0.0010606652358546853
loss_pred:0.016844013705849648, decouple_loss:0.001157049904577434
Iteration: 3917, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4531858265399933, gen p mean: -0.03849786892533302, mean p set: 0.45366615056991577
loss_pred:0.017153795808553696, decouple_loss:0.0010121227242052555
The modified gen p mean: 0.45042166113853455, gen p mean: -0.043569400906562805, mean p set: 0.45090195536613464The modified gen p mean: 0.4518018662929535, gen p mean: -0.03580727428197861, mean p set: 0.452282190322876
loss_pred:0.015689687803387642, decouple_loss:0.0009953959379345179
loss_pred:0.015851804986596107, decouple_loss:0.0009451565565541387
Iteration: 3918, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514514207839966, gen p mean: -0.04202426224946976, mean p set: 0.4519317150115967
The modified gen p mean: 0.4498823881149292, gen p mean: -0.041349928826093674, mean p set: 0.4503626525402069
loss_pred:0.017090605571866035, decouple_loss:0.0010530392173677683
loss_pred:0.015149863436818123, decouple_loss:0.001068014302290976
The modified gen p mean: 0.45349958539009094, gen p mean: -0.03807580843567848, mean p set: 0.45397984981536865
loss_pred:0.014859553426504135, decouple_loss:0.0009732164326123893
Iteration: 3919, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45099908113479614, gen p mean: -0.04218784719705582, mean p set: 0.45147937536239624
The modified gen p mean: 0.4530723989009857, gen p mean: -0.042129937559366226, mean p set: 0.4535527229309082loss_pred:0.015305076725780964, decouple_loss:0.0011140292044728994
The modified gen p mean: 0.4514559805393219, gen p mean: -0.04165831208229065, mean p set: 0.451936274766922
loss_pred:0.016757460311055183, decouple_loss:0.0011561268474906683
loss_pred:0.016083985567092896, decouple_loss:0.0010548860300332308
Iteration: 3920, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504041075706482, gen p mean: -0.044545989483594894, mean p set: 0.4508844316005707
loss_pred:0.015177840366959572, decouple_loss:0.0010702303843572736
The modified gen p mean: 0.4502141773700714, gen p mean: -0.04446505755186081, mean p set: 0.4506944417953491The modified gen p mean: 0.44963768124580383, gen p mean: -0.04488241672515869, mean p set: 0.45011797547340393
loss_pred:0.015710871666669846, decouple_loss:0.0010838209418579936
loss_pred:0.014827175997197628, decouple_loss:0.001093943021260202
2023-05-02 17:25:48 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.054017841815948486, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.050160136073827744, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.05025041103363037, mean p set: 0.4500633478164673
loss_pred:0.018378911539912224, decouple_loss:0.0012289794394746423
loss_pred:0.017418397590517998, decouple_loss:0.0013272810028865933
loss_pred:0.01730036549270153, decouple_loss:0.0013827946968376637
WV_0_PC_1_EH_0_PS_40, loss: 0.017764877527952194, avg_mse: 0.025569582358002663
current test mse: 0.02557
Iteration: 3921, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45375755429267883, gen p mean: -0.04307442530989647, mean p set: 0.4542378783226013
The modified gen p mean: 0.45300745964050293, gen p mean: -0.042571622878313065, mean p set: 0.453487753868103
The modified gen p mean: 0.45113587379455566, gen p mean: -0.04303135722875595, mean p set: 0.45161619782447815
loss_pred:0.016377616673707962, decouple_loss:0.0011361152864992619
loss_pred:0.015899254009127617, decouple_loss:0.0010570409940555692loss_pred:0.01583785191178322, decouple_loss:0.0010366241913288832
Iteration: 3922, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4521729052066803, gen p mean: -0.0502634271979332, mean p set: 0.452653169631958
loss_pred:0.016515543684363365, decouple_loss:0.0013493485748767853
The modified gen p mean: 0.4523985683917999, gen p mean: -0.04793812334537506, mean p set: 0.45287883281707764The modified gen p mean: 0.4533480405807495, gen p mean: -0.04655793309211731, mean p set: 0.4538283348083496
loss_pred:0.01640648953616619, decouple_loss:0.0012783593265339732
loss_pred:0.014907562173902988, decouple_loss:0.0010805289493873715
Iteration: 3923, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4519626796245575, gen p mean: -0.05068773776292801, mean p set: 0.4524429440498352
loss_pred:0.0155256362631917, decouple_loss:0.0009859539568424225
The modified gen p mean: 0.4495961666107178, gen p mean: -0.05293554440140724, mean p set: 0.4500764310359955The modified gen p mean: 0.4499393105506897, gen p mean: -0.05744905397295952, mean p set: 0.4504196047782898
loss_pred:0.015693245455622673, decouple_loss:0.0010996657656505704
loss_pred:0.014572606422007084, decouple_loss:0.0011385028483346105
Iteration: 3924, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45307889580726624, gen p mean: -0.0549880713224411, mean p set: 0.45355919003486633
The modified gen p mean: 0.4521179795265198, gen p mean: -0.04952141270041466, mean p set: 0.45259830355644226
loss_pred:0.016469793394207954, decouple_loss:0.0013023476349189878
The modified gen p mean: 0.4496065676212311, gen p mean: -0.061135873198509216, mean p set: 0.4500868618488312
loss_pred:0.0160638727247715, decouple_loss:0.0014190025394782424
loss_pred:0.014454401098191738, decouple_loss:0.0012635041493922472
Iteration: 3925, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4540480971336365, gen p mean: -0.052398502826690674, mean p set: 0.4545283913612366
The modified gen p mean: 0.45055142045021057, gen p mean: -0.05785193666815758, mean p set: 0.4510316848754883
loss_pred:0.014944056048989296, decouple_loss:0.0011205674381926656
loss_pred:0.01512723695486784, decouple_loss:0.0010556869674474
The modified gen p mean: 0.4508505165576935, gen p mean: -0.053366634994745255, mean p set: 0.4513308107852936
loss_pred:0.015511108562350273, decouple_loss:0.0010691896313801408
Iteration: 3926, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45127904415130615, gen p mean: -0.056109387427568436, mean p set: 0.45175933837890625
loss_pred:0.015107040293514729, decouple_loss:0.0010446831583976746
The modified gen p mean: 0.451896607875824, gen p mean: -0.05450696870684624, mean p set: 0.4523768723011017The modified gen p mean: 0.4501403272151947, gen p mean: -0.055242449045181274, mean p set: 0.4506206214427948
loss_pred:0.015004775486886501, decouple_loss:0.0010346643393859267
loss_pred:0.014511180110275745, decouple_loss:0.0012528126826509833
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012011_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012011_3_24hr.npz
NaN value num: 0
Iteration: 3927, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4535418450832367, gen p mean: -0.043750859797000885, mean p set: 0.4540221691131592
loss_pred:0.015267729759216309, decouple_loss:0.001119888387620449
The modified gen p mean: 0.4521658420562744, gen p mean: -0.04800622910261154, mean p set: 0.4526461064815521The modified gen p mean: 0.4506920278072357, gen p mean: -0.047207847237586975, mean p set: 0.4511723518371582
loss_pred:0.016335776075720787, decouple_loss:0.0010415842989459634
loss_pred:0.016107605770230293, decouple_loss:0.0011021032696589828
Iteration: 3928, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45192667841911316, gen p mean: -0.03868156298995018, mean p set: 0.45240697264671326
loss_pred:0.015303518623113632, decouple_loss:0.0009809808107092977
The modified gen p mean: 0.4520944654941559, gen p mean: -0.04282093048095703, mean p set: 0.452574759721756The modified gen p mean: 0.4515134394168854, gen p mean: -0.04072060436010361, mean p set: 0.4519937038421631
loss_pred:0.01586931198835373, decouple_loss:0.0011044536950066686
loss_pred:0.015475590713322163, decouple_loss:0.0009746701107360423
Iteration: 3929, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45241695642471313, gen p mean: -0.03435755521059036, mean p set: 0.45289722084999084
loss_pred:0.015605874359607697, decouple_loss:0.0009481962188147008
The modified gen p mean: 0.4517366290092468, gen p mean: -0.03469272330403328, mean p set: 0.4522169232368469The modified gen p mean: 0.4507414400577545, gen p mean: -0.03711669519543648, mean p set: 0.4512217342853546
loss_pred:0.01551346480846405, decouple_loss:0.0009423790615983307
loss_pred:0.01594502665102482, decouple_loss:0.0009511070093140006
Iteration: 3930, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4509170353412628, gen p mean: -0.038036927580833435, mean p set: 0.4513972997665405
The modified gen p mean: 0.4514908194541931, gen p mean: -0.03907392546534538, mean p set: 0.4519711136817932
loss_pred:0.015770336613059044, decouple_loss:0.0010268391342833638
loss_pred:0.01641731895506382, decouple_loss:0.0010324404574930668
The modified gen p mean: 0.452045738697052, gen p mean: -0.03710898756980896, mean p set: 0.4525260329246521
loss_pred:0.016252096742391586, decouple_loss:0.0009780956897884607
2023-05-02 17:28:17 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.046908650547266006, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.0432315319776535, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.04315026104450226, mean p set: 0.4500633478164673
loss_pred:0.018420929089188576, decouple_loss:0.0011466708965599537
loss_pred:0.017463289201259613, decouple_loss:0.0011869301088154316
loss_pred:0.017347777262330055, decouple_loss:0.0011979832779616117
WV_0_PC_1_EH_0_PS_40, loss: 0.017802856862545013, avg_mse: 0.025681855157017708
current test mse: 0.025682
Iteration: 3931, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508679509162903, gen p mean: -0.036615900695323944, mean p set: 0.4513482451438904
The modified gen p mean: 0.45193371176719666, gen p mean: -0.03267711400985718, mean p set: 0.45241400599479675
The modified gen p mean: 0.4522055387496948, gen p mean: -0.03345830366015434, mean p set: 0.4526858329772949
loss_pred:0.01586752012372017, decouple_loss:0.0009224771056324244
loss_pred:0.015584898181259632, decouple_loss:0.0010292289080098271
loss_pred:0.015802141278982162, decouple_loss:0.0010903577785938978
Iteration: 3932, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45345133543014526, gen p mean: -0.04363482445478439, mean p set: 0.45393162965774536
loss_pred:0.01592126116156578, decouple_loss:0.0010655272053554654
The modified gen p mean: 0.45242398977279663, gen p mean: -0.03705619275569916, mean p set: 0.4529043138027191
The modified gen p mean: 0.45147210359573364, gen p mean: -0.040370989590883255, mean p set: 0.45195239782333374
loss_pred:0.015968451276421547, decouple_loss:0.001045869430527091
loss_pred:0.015453080646693707, decouple_loss:0.0011202871100977063
Iteration: 3933, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4512758255004883, gen p mean: -0.04118701443076134, mean p set: 0.4517561197280884
loss_pred:0.01605365425348282, decouple_loss:0.0011424686526879668
The modified gen p mean: 0.45261839032173157, gen p mean: -0.039690036326646805, mean p set: 0.4530986547470093The modified gen p mean: 0.45180779695510864, gen p mean: -0.037046901881694794, mean p set: 0.45228806138038635
loss_pred:0.015078426338732243, decouple_loss:0.001065446762368083
loss_pred:0.015641871839761734, decouple_loss:0.0010756877018138766
Iteration: 3934, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45066335797309875, gen p mean: -0.03396884724497795, mean p set: 0.45114362239837646
loss_pred:0.01583053357899189, decouple_loss:0.0010337835410609841
The modified gen p mean: 0.4521664083003998, gen p mean: -0.034432992339134216, mean p set: 0.4526466727256775The modified gen p mean: 0.4524117708206177, gen p mean: -0.03466763347387314, mean p set: 0.4528920352458954
loss_pred:0.015989787876605988, decouple_loss:0.0009835477685555816
loss_pred:0.015987547114491463, decouple_loss:0.001015699584968388
Iteration: 3935, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4527018666267395, gen p mean: -0.04404633864760399, mean p set: 0.4531821608543396
loss_pred:0.01525108516216278, decouple_loss:0.0012664601672440767
The modified gen p mean: 0.4518676698207855, gen p mean: -0.040134064853191376, mean p set: 0.4523479640483856The modified gen p mean: 0.4526793360710144, gen p mean: -0.04312203824520111, mean p set: 0.4531596302986145
loss_pred:0.015418098308146, decouple_loss:0.0012836107052862644
loss_pred:0.015380213037133217, decouple_loss:0.0013181569520384073
Iteration: 3936, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45239338278770447, gen p mean: -0.03959278017282486, mean p set: 0.45287367701530457
loss_pred:0.01537614967674017, decouple_loss:0.000993227236904204
The modified gen p mean: 0.45208415389060974, gen p mean: -0.032224927097558975, mean p set: 0.45256444811820984The modified gen p mean: 0.45180609822273254, gen p mean: -0.03440415859222412, mean p set: 0.45228642225265503
loss_pred:0.015511082485318184, decouple_loss:0.0010900507913902402
loss_pred:0.015780383720993996, decouple_loss:0.0011367370607331395
Iteration: 3937, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513395428657532, gen p mean: -0.0370216928422451, mean p set: 0.45181983709335327
loss_pred:0.01610690914094448, decouple_loss:0.001278598327189684
The modified gen p mean: 0.45258286595344543, gen p mean: -0.03361976891756058, mean p set: 0.45306316018104553The modified gen p mean: 0.4523658752441406, gen p mean: -0.03369733318686485, mean p set: 0.4528461992740631
loss_pred:0.01579258218407631, decouple_loss:0.0012482104357331991
loss_pred:0.015474600717425346, decouple_loss:0.0012138641905039549
Iteration: 3938, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450969934463501, gen p mean: -0.035626865923404694, mean p set: 0.45145025849342346
loss_pred:0.01598816178739071, decouple_loss:0.0010834216373041272
The modified gen p mean: 0.4532966911792755, gen p mean: -0.044395461678504944, mean p set: 0.453777015209198The modified gen p mean: 0.45150279998779297, gen p mean: -0.035609159618616104, mean p set: 0.45198309421539307
loss_pred:0.015180923976004124, decouple_loss:0.0013290781062096357
loss_pred:0.015768636018037796, decouple_loss:0.0011226736241951585
Iteration: 3939, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4526510536670685, gen p mean: -0.03441349416971207, mean p set: 0.4531313478946686
loss_pred:0.015529418364167213, decouple_loss:0.0012364904396235943
The modified gen p mean: 0.4520377218723297, gen p mean: -0.03298267349600792, mean p set: 0.4525179862976074The modified gen p mean: 0.45123928785324097, gen p mean: -0.036346446722745895, mean p set: 0.45171958208084106
loss_pred:0.015292037278413773, decouple_loss:0.0014992706710472703
loss_pred:0.015307078137993813, decouple_loss:0.001241462305188179
Iteration: 3940, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4532608985900879, gen p mean: -0.03753697872161865, mean p set: 0.453741192817688
loss_pred:0.01569342613220215, decouple_loss:0.0012456232216209173
The modified gen p mean: 0.45155200362205505, gen p mean: -0.03695644438266754, mean p set: 0.45203232765197754The modified gen p mean: 0.4510209262371063, gen p mean: -0.03652999922633171, mean p set: 0.45150119066238403
loss_pred:0.01592704840004444, decouple_loss:0.0012680735671892762
loss_pred:0.016229012981057167, decouple_loss:0.0011826317058876157
2023-05-02 17:30:10 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.04868040978908539, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.0450998954474926, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.0454055555164814, mean p set: 0.4500633478164673
loss_pred:0.018502837046980858, decouple_loss:0.0014153883093968034
loss_pred:0.01738378219306469, decouple_loss:0.0012730509042739868
loss_pred:0.017439668998122215, decouple_loss:0.0013867993839085102
WV_0_PC_1_EH_0_PS_40, loss: 0.017843350768089294, avg_mse: 0.02573847584426403
current test mse: 0.025738
Iteration: 3941, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45310261845588684, gen p mean: -0.03830057755112648, mean p set: 0.45358291268348694
The modified gen p mean: 0.45355185866355896, gen p mean: -0.037504892796278, mean p set: 0.45403215289115906
The modified gen p mean: 0.4527105987071991, gen p mean: -0.03586295247077942, mean p set: 0.4531908929347992
loss_pred:0.015074123628437519, decouple_loss:0.0013025420485064387
loss_pred:0.014865592122077942, decouple_loss:0.0013555643381550908loss_pred:0.0151144377887249, decouple_loss:0.0011113057844340801
Iteration: 3942, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4533820152282715, gen p mean: -0.04033224284648895, mean p set: 0.4538623094558716
loss_pred:0.016127988696098328, decouple_loss:0.0012727908324450254
The modified gen p mean: 0.4532409608364105, gen p mean: -0.04628065228462219, mean p set: 0.4537212550640106The modified gen p mean: 0.45035693049430847, gen p mean: -0.037863850593566895, mean p set: 0.4508371949195862
loss_pred:0.015509464778006077, decouple_loss:0.0016658534295856953
loss_pred:0.015836495906114578, decouple_loss:0.0012595260050147772
Iteration: 3943, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4512045383453369, gen p mean: -0.0436662957072258, mean p set: 0.4516848623752594
loss_pred:0.015878209844231606, decouple_loss:0.0013612571638077497
The modified gen p mean: 0.45124924182891846, gen p mean: -0.031002545729279518, mean p set: 0.45172953605651855The modified gen p mean: 0.4518750011920929, gen p mean: -0.03350432962179184, mean p set: 0.452355295419693
loss_pred:0.01547281350940466, decouple_loss:0.0011556975077837706
loss_pred:0.015225010924041271, decouple_loss:0.0011365670943632722
Iteration: 3944, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45338529348373413, gen p mean: -0.0377124659717083, mean p set: 0.45386558771133423
loss_pred:0.015058695338666439, decouple_loss:0.001478780061006546
The modified gen p mean: 0.45314139127731323, gen p mean: -0.03806346654891968, mean p set: 0.45362168550491333The modified gen p mean: 0.4506340026855469, gen p mean: -0.03660914674401283, mean p set: 0.451114296913147
loss_pred:0.014937635511159897, decouple_loss:0.0014411706943064928
loss_pred:0.015767596662044525, decouple_loss:0.0011658929288387299
Iteration: 3945, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4521476924419403, gen p mean: -0.03786515071988106, mean p set: 0.4526279866695404
loss_pred:0.01629728637635708, decouple_loss:0.001181235653348267
The modified gen p mean: 0.4513983130455017, gen p mean: -0.03846749663352966, mean p set: 0.4518786072731018The modified gen p mean: 0.45173466205596924, gen p mean: -0.038454968482255936, mean p set: 0.45221495628356934
loss_pred:0.01593737304210663, decouple_loss:0.0012294858461245894
loss_pred:0.015763984993100166, decouple_loss:0.0013078843476250768
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012004_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012004_3_24hr.npz
NaN value num: 0
Iteration: 3946, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44872066378593445, gen p mean: -0.03705405071377754, mean p set: 0.44920095801353455
loss_pred:0.014065868221223354, decouple_loss:0.0012904256582260132
The modified gen p mean: 0.44871821999549866, gen p mean: -0.03515949845314026, mean p set: 0.44919851422309875The modified gen p mean: 0.45018258690834045, gen p mean: -0.043565019965171814, mean p set: 0.45066288113594055
loss_pred:0.014329752884805202, decouple_loss:0.0013758460991084576
loss_pred:0.013732957653701305, decouple_loss:0.0012446371838450432
Iteration: 3947, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473828077316284, gen p mean: -0.050665322691202164, mean p set: 0.4478631317615509
The modified gen p mean: 0.4481760263442993, gen p mean: -0.054128386080265045, mean p set: 0.4486563205718994
loss_pred:0.013348164036870003, decouple_loss:0.0014688733499497175
loss_pred:0.013429137878119946, decouple_loss:0.0012809311738237739
The modified gen p mean: 0.4479285478591919, gen p mean: -0.05152595788240433, mean p set: 0.448408842086792
loss_pred:0.013831743970513344, decouple_loss:0.0013115537585690618
Iteration: 3948, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482608735561371, gen p mean: -0.060720574110746384, mean p set: 0.4487411379814148
The modified gen p mean: 0.4487585425376892, gen p mean: -0.055501312017440796, mean p set: 0.4492388665676117loss_pred:0.013192975893616676, decouple_loss:0.0012938363943248987
The modified gen p mean: 0.4463944733142853, gen p mean: -0.06183041259646416, mean p set: 0.4468747675418854
loss_pred:0.013486368581652641, decouple_loss:0.001212056027725339
loss_pred:0.014220461249351501, decouple_loss:0.0012863195734098554
Iteration: 3949, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44806262850761414, gen p mean: -0.056296322494745255, mean p set: 0.44854292273521423
loss_pred:0.013544939458370209, decouple_loss:0.0012680554063990712
The modified gen p mean: 0.44863656163215637, gen p mean: -0.06399396806955338, mean p set: 0.4491168260574341The modified gen p mean: 0.44831424951553345, gen p mean: -0.06350304186344147, mean p set: 0.44879457354545593
loss_pred:0.014206313528120518, decouple_loss:0.001299094408750534
loss_pred:0.013995744287967682, decouple_loss:0.0012147818924859166
Iteration: 3950, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477931559085846, gen p mean: -0.06480025500059128, mean p set: 0.4482734203338623
loss_pred:0.013055243529379368, decouple_loss:0.001382244867272675
The modified gen p mean: 0.4490843415260315, gen p mean: -0.06641428172588348, mean p set: 0.4495646357536316The modified gen p mean: 0.4467921555042267, gen p mean: -0.06430893391370773, mean p set: 0.4472724497318268
loss_pred:0.01352362334728241, decouple_loss:0.0013646857114508748
loss_pred:0.013767695054411888, decouple_loss:0.0014052457408979535
2023-05-02 17:32:46 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.06687286496162415, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.06298476457595825, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.06347600370645523, mean p set: 0.4500633478164673
loss_pred:0.018754050135612488, decouple_loss:0.001360319321975112
loss_pred:0.017710627987980843, decouple_loss:0.001467460417188704
loss_pred:0.01772623136639595, decouple_loss:0.001424572546966374
WV_0_PC_1_EH_0_PS_40, loss: 0.01813451014459133, avg_mse: 0.026270121335983276
current test mse: 0.02627
Iteration: 3951, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482864737510681, gen p mean: -0.06715961545705795, mean p set: 0.4487667679786682
The modified gen p mean: 0.44788697361946106, gen p mean: -0.06783097237348557, mean p set: 0.44836726784706116
The modified gen p mean: 0.44828712940216064, gen p mean: -0.06481528282165527, mean p set: 0.44876742362976074
loss_pred:0.014151865616440773, decouple_loss:0.001338787144050002
loss_pred:0.013230670243501663, decouple_loss:0.001362664857879281
loss_pred:0.013073763810098171, decouple_loss:0.0013711141655221581
Iteration: 3952, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502047300338745, gen p mean: -0.06243680790066719, mean p set: 0.450685054063797
The modified gen p mean: 0.44810235500335693, gen p mean: -0.06259863078594208, mean p set: 0.4485826790332794
loss_pred:0.013730618171393871, decouple_loss:0.0013902600621804595
loss_pred:0.013716703280806541, decouple_loss:0.0012602303177118301
The modified gen p mean: 0.4475422203540802, gen p mean: -0.06308162212371826, mean p set: 0.4480225145816803
loss_pred:0.013769767247140408, decouple_loss:0.0013060941128060222
Iteration: 3953, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484059512615204, gen p mean: -0.05856615677475929, mean p set: 0.4488862454891205
loss_pred:0.013839554972946644, decouple_loss:0.0012949315132573247
The modified gen p mean: 0.44865861535072327, gen p mean: -0.05455474555492401, mean p set: 0.44913890957832336The modified gen p mean: 0.4483461380004883, gen p mean: -0.06792353093624115, mean p set: 0.4488264322280884
loss_pred:0.013038257136940956, decouple_loss:0.0013856625882908702
loss_pred:0.013544553890824318, decouple_loss:0.0013423992786556482
Iteration: 3954, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44615504145622253, gen p mean: -0.06212674453854561, mean p set: 0.44663533568382263
loss_pred:0.0132297333329916, decouple_loss:0.0012414276134222746
The modified gen p mean: 0.4482540488243103, gen p mean: -0.062213506549596786, mean p set: 0.4487343728542328The modified gen p mean: 0.44935524463653564, gen p mean: -0.055728729814291, mean p set: 0.44983553886413574
loss_pred:0.013961095362901688, decouple_loss:0.0012795570073649287
loss_pred:0.01388363167643547, decouple_loss:0.0012188754044473171
Iteration: 3955, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508858025074005, gen p mean: -0.0555754192173481, mean p set: 0.4513660967350006
loss_pred:0.01365030836313963, decouple_loss:0.0012745519634336233
The modified gen p mean: 0.4487471878528595, gen p mean: -0.0520625114440918, mean p set: 0.4492274820804596The modified gen p mean: 0.44782358407974243, gen p mean: -0.05574728548526764, mean p set: 0.44830387830734253
loss_pred:0.013294047676026821, decouple_loss:0.0013053329894319177
loss_pred:0.014520591124892235, decouple_loss:0.0012934065889567137
Iteration: 3956, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44707104563713074, gen p mean: -0.05815165862441063, mean p set: 0.44755133986473083
loss_pred:0.012712501920759678, decouple_loss:0.001290910062380135
The modified gen p mean: 0.4487621486186981, gen p mean: -0.046867866069078445, mean p set: 0.4492424428462982The modified gen p mean: 0.4484752416610718, gen p mean: -0.05321529880166054, mean p set: 0.44895556569099426
loss_pred:0.013731664977967739, decouple_loss:0.0013803024776279926
loss_pred:0.013499259948730469, decouple_loss:0.001345861703157425
Iteration: 3957, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44748514890670776, gen p mean: -0.055170681327581406, mean p set: 0.44796544313430786
loss_pred:0.013607311993837357, decouple_loss:0.001354458276182413
The modified gen p mean: 0.4476674199104309, gen p mean: -0.05447134003043175, mean p set: 0.4481477439403534
The modified gen p mean: 0.44850486516952515, gen p mean: -0.04751597344875336, mean p set: 0.44898515939712524
loss_pred:0.013433828949928284, decouple_loss:0.0012255298206582665
loss_pred:0.013298401609063148, decouple_loss:0.0011869951849803329
Iteration: 3958, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481866657733917, gen p mean: -0.055447544902563095, mean p set: 0.44866693019866943
loss_pred:0.013481508009135723, decouple_loss:0.0010819410672411323
The modified gen p mean: 0.44727641344070435, gen p mean: -0.06001276895403862, mean p set: 0.44775673747062683The modified gen p mean: 0.44656041264533997, gen p mean: -0.056569311767816544, mean p set: 0.44704070687294006
loss_pred:0.013047636486589909, decouple_loss:0.0012878713896498084
loss_pred:0.01287547592073679, decouple_loss:0.0012034332612529397
Iteration: 3959, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487915635108948, gen p mean: -0.06345228105783463, mean p set: 0.4492718279361725
The modified gen p mean: 0.44835537672042847, gen p mean: -0.055598631501197815, mean p set: 0.44883567094802856
loss_pred:0.014124477282166481, decouple_loss:0.0012574585853144526
loss_pred:0.013709571212530136, decouple_loss:0.001169392024166882
The modified gen p mean: 0.4483340084552765, gen p mean: -0.05403425544500351, mean p set: 0.4488143026828766
loss_pred:0.013421924784779549, decouple_loss:0.0011788654373958707
Iteration: 3960, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44756534695625305, gen p mean: -0.06345366686582565, mean p set: 0.44804564118385315
The modified gen p mean: 0.44796425104141235, gen p mean: -0.06138003617525101, mean p set: 0.44844454526901245
loss_pred:0.01325717568397522, decouple_loss:0.001156136393547058
loss_pred:0.012874404899775982, decouple_loss:0.001106404117308557
The modified gen p mean: 0.44962185621261597, gen p mean: -0.06286347657442093, mean p set: 0.4501021206378937
loss_pred:0.012997538782656193, decouple_loss:0.0012020739959552884
2023-05-02 17:34:40 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.06192117929458618, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.057570409029722214, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.058086298406124115, mean p set: 0.4500633478164673
loss_pred:0.019066112115979195, decouple_loss:0.0013118418864905834
loss_pred:0.01796608418226242, decouple_loss:0.001269382773898542
loss_pred:0.01796780526638031, decouple_loss:0.0012351730838418007
WV_0_PC_1_EH_0_PS_40, loss: 0.01839694008231163, avg_mse: 0.026830824092030525
current test mse: 0.026831
Iteration: 3961, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475911557674408, gen p mean: -0.05910025164484978, mean p set: 0.4480714499950409
The modified gen p mean: 0.4481052756309509, gen p mean: -0.06187313795089722, mean p set: 0.4485855996608734
The modified gen p mean: 0.4465106725692749, gen p mean: -0.06280166655778885, mean p set: 0.446990966796875
loss_pred:0.01380532793700695, decouple_loss:0.0012484128819778562
loss_pred:0.012710684910416603, decouple_loss:0.0011911318870261312
loss_pred:0.013514886610209942, decouple_loss:0.0011621249141171575
Iteration: 3962, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44923385977745056, gen p mean: -0.055293675512075424, mean p set: 0.44971415400505066
loss_pred:0.01360935065895319, decouple_loss:0.0011039675446227193
The modified gen p mean: 0.447750449180603, gen p mean: -0.054919105023145676, mean p set: 0.4482307732105255The modified gen p mean: 0.4480462074279785, gen p mean: -0.05463545024394989, mean p set: 0.4485265016555786
loss_pred:0.01288548856973648, decouple_loss:0.0011035810457542539
loss_pred:0.012922657653689384, decouple_loss:0.0010413618292659521
Iteration: 3963, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44837528467178345, gen p mean: -0.04725240543484688, mean p set: 0.44885557889938354
loss_pred:0.013219743967056274, decouple_loss:0.0011656404240056872
The modified gen p mean: 0.4494085907936096, gen p mean: -0.048449207097291946, mean p set: 0.44988885521888733The modified gen p mean: 0.4478696584701538, gen p mean: -0.05230691283941269, mean p set: 0.4483499228954315
loss_pred:0.013491329737007618, decouple_loss:0.0010949461720883846
loss_pred:0.01321143377572298, decouple_loss:0.0011786731192842126
Iteration: 3964, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44648703932762146, gen p mean: -0.05208379030227661, mean p set: 0.44696733355522156
loss_pred:0.012787790969014168, decouple_loss:0.0011734120780602098
The modified gen p mean: 0.44761234521865845, gen p mean: -0.05087421461939812, mean p set: 0.44809263944625854The modified gen p mean: 0.4486162066459656, gen p mean: -0.05478881672024727, mean p set: 0.4490965008735657
loss_pred:0.013411538675427437, decouple_loss:0.0010915928287431598
loss_pred:0.013867687433958054, decouple_loss:0.00120048807002604
Iteration: 3965, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488388001918793, gen p mean: -0.0470026470720768, mean p set: 0.449319064617157
loss_pred:0.013671930879354477, decouple_loss:0.0010610823519527912
The modified gen p mean: 0.447777658700943, gen p mean: -0.05162109434604645, mean p set: 0.4482579529285431The modified gen p mean: 0.44732069969177246, gen p mean: -0.05073774978518486, mean p set: 0.44780102372169495
loss_pred:0.013637770898640156, decouple_loss:0.0011509961914271116
loss_pred:0.013406465761363506, decouple_loss:0.0010239729890599847
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012011_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012011_3_24hr.npz
NaN value num: 0
Iteration: 3966, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491910934448242, gen p mean: -0.048702169209718704, mean p set: 0.4496713876724243
loss_pred:0.015955843031406403, decouple_loss:0.001339595764875412
The modified gen p mean: 0.44911232590675354, gen p mean: -0.056970350444316864, mean p set: 0.449592649936676The modified gen p mean: 0.45021852850914, gen p mean: -0.04774712026119232, mean p set: 0.4506988525390625
loss_pred:0.015561703592538834, decouple_loss:0.0013406634097918868
loss_pred:0.015253367833793163, decouple_loss:0.0012577131856232882
Iteration: 3967, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490172564983368, gen p mean: -0.052022892981767654, mean p set: 0.4494975507259369
loss_pred:0.01563636213541031, decouple_loss:0.001197540550492704
The modified gen p mean: 0.45027074217796326, gen p mean: -0.050437428057193756, mean p set: 0.45075103640556335The modified gen p mean: 0.4494132697582245, gen p mean: -0.05564321205019951, mean p set: 0.4498935639858246
loss_pred:0.015639815479516983, decouple_loss:0.00114132568705827
loss_pred:0.015434062108397484, decouple_loss:0.001167248236015439
Iteration: 3968, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44895100593566895, gen p mean: -0.04809845983982086, mean p set: 0.44943130016326904
loss_pred:0.015535409562289715, decouple_loss:0.0012479873839765787
The modified gen p mean: 0.45214927196502686, gen p mean: -0.05215301364660263, mean p set: 0.45262953639030457The modified gen p mean: 0.4499325454235077, gen p mean: -0.0477469265460968, mean p set: 0.4504128098487854
loss_pred:0.015786930918693542, decouple_loss:0.0012637388426810503
loss_pred:0.01574697718024254, decouple_loss:0.0012935134582221508
Iteration: 3969, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498765468597412, gen p mean: -0.04901905730366707, mean p set: 0.4503568708896637
loss_pred:0.01569651998579502, decouple_loss:0.0011216605780646205
The modified gen p mean: 0.45050114393234253, gen p mean: -0.04836754500865936, mean p set: 0.45098140835762024The modified gen p mean: 0.45003727078437805, gen p mean: -0.04813370481133461, mean p set: 0.45051753520965576
loss_pred:0.015415777452290058, decouple_loss:0.0010690958006307483
loss_pred:0.015874452888965607, decouple_loss:0.0011124955490231514
Iteration: 3970, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4509523808956146, gen p mean: -0.04445580020546913, mean p set: 0.4514326751232147
loss_pred:0.01525519136339426, decouple_loss:0.001260936027392745
The modified gen p mean: 0.4501641094684601, gen p mean: -0.04428046569228172, mean p set: 0.4506444036960602The modified gen p mean: 0.451831579208374, gen p mean: -0.04362189769744873, mean p set: 0.4523118734359741
loss_pred:0.015268883667886257, decouple_loss:0.001224374515004456
loss_pred:0.015748098492622375, decouple_loss:0.0012080925516784191
2023-05-02 17:37:12 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.04845749959349632, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04473213478922844, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.04628659784793854, mean p set: 0.4500633478164673
loss_pred:0.01904325559735298, decouple_loss:0.0014448403380811214
loss_pred:0.01783043146133423, decouple_loss:0.0013005067594349384
loss_pred:0.017952263355255127, decouple_loss:0.0012818787945434451
WV_0_PC_1_EH_0_PS_40, loss: 0.018342437222599983, avg_mse: 0.026605170220136642
current test mse: 0.026605
Iteration: 3971, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495488703250885, gen p mean: -0.03691165894269943, mean p set: 0.4500291645526886
The modified gen p mean: 0.4501987099647522, gen p mean: -0.03815267235040665, mean p set: 0.4506790041923523
The modified gen p mean: 0.45067375898361206, gen p mean: -0.04380681365728378, mean p set: 0.45115405321121216
loss_pred:0.015347272157669067, decouple_loss:0.001321270945481956
loss_pred:0.015374687500298023, decouple_loss:0.0011521917767822742
loss_pred:0.015575570985674858, decouple_loss:0.0012550137471407652
Iteration: 3972, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499249756336212, gen p mean: -0.023186488077044487, mean p set: 0.4504052996635437
loss_pred:0.01586245745420456, decouple_loss:0.0011587187182158232
The modified gen p mean: 0.44979918003082275, gen p mean: -0.03479199856519699, mean p set: 0.45027947425842285
The modified gen p mean: 0.45075684785842896, gen p mean: -0.030870875343680382, mean p set: 0.45123711228370667
loss_pred:0.01631859689950943, decouple_loss:0.0012892063241451979
loss_pred:0.015479524619877338, decouple_loss:0.0012558628804981709
Iteration: 3973, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511227011680603, gen p mean: -0.027986029163002968, mean p set: 0.4516029953956604
loss_pred:0.015539232641458511, decouple_loss:0.0013140534283593297
The modified gen p mean: 0.45193347334861755, gen p mean: -0.023792970925569534, mean p set: 0.45241379737854004The modified gen p mean: 0.4490228295326233, gen p mean: -0.02906998060643673, mean p set: 0.4495031237602234
loss_pred:0.015775857493281364, decouple_loss:0.001329940278083086
loss_pred:0.015386172570288181, decouple_loss:0.001268708729185164
Iteration: 3974, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44838088750839233, gen p mean: -0.02548230066895485, mean p set: 0.44886115193367004
loss_pred:0.015802651643753052, decouple_loss:0.001161781488917768
The modified gen p mean: 0.44908955693244934, gen p mean: -0.03603625297546387, mean p set: 0.44956985116004944The modified gen p mean: 0.450730562210083, gen p mean: -0.028129784390330315, mean p set: 0.4512108564376831
loss_pred:0.015443219803273678, decouple_loss:0.001229094690643251
loss_pred:0.015333151444792747, decouple_loss:0.0011754287406802177
Iteration: 3975, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44930392503738403, gen p mean: -0.0369095578789711, mean p set: 0.4497842490673065
loss_pred:0.015411297790706158, decouple_loss:0.0011728913523256779
The modified gen p mean: 0.450371652841568, gen p mean: -0.032421812415122986, mean p set: 0.4508519768714905The modified gen p mean: 0.45020654797554016, gen p mean: -0.03888658806681633, mean p set: 0.45068684220314026
loss_pred:0.014924352057278156, decouple_loss:0.001311871805228293
loss_pred:0.015122191980481148, decouple_loss:0.0012679502833634615
Iteration: 3976, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44988730549812317, gen p mean: -0.044258177280426025, mean p set: 0.45036759972572327
loss_pred:0.015657348558306694, decouple_loss:0.0011551986681297421
The modified gen p mean: 0.45159170031547546, gen p mean: -0.043509095907211304, mean p set: 0.45207199454307556The modified gen p mean: 0.45103469491004944, gen p mean: -0.044889215379953384, mean p set: 0.45151498913764954
loss_pred:0.015902401879429817, decouple_loss:0.0012688485439866781
loss_pred:0.015489921905100346, decouple_loss:0.001201658509671688
Iteration: 3977, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45185530185699463, gen p mean: -0.04725557938218117, mean p set: 0.4523356258869171
loss_pred:0.015389976091682911, decouple_loss:0.001216551405377686
The modified gen p mean: 0.4510660469532013, gen p mean: -0.046148572117090225, mean p set: 0.4515463411808014The modified gen p mean: 0.4504880905151367, gen p mean: -0.047522056847810745, mean p set: 0.4509684145450592
loss_pred:0.01551420520991087, decouple_loss:0.0011771514546126127
loss_pred:0.015812652185559273, decouple_loss:0.001495862496085465
Iteration: 3978, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505167007446289, gen p mean: -0.04928738251328468, mean p set: 0.450996994972229
loss_pred:0.015651211142539978, decouple_loss:0.0011345114326104522
The modified gen p mean: 0.4500146210193634, gen p mean: -0.049911241978406906, mean p set: 0.4504949152469635The modified gen p mean: 0.45033106207847595, gen p mean: -0.057409293949604034, mean p set: 0.45081138610839844
loss_pred:0.015484610572457314, decouple_loss:0.0011820923537015915
loss_pred:0.015586147084832191, decouple_loss:0.0011946934973821044
Iteration: 3979, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44981467723846436, gen p mean: -0.0493115596473217, mean p set: 0.45029497146606445
loss_pred:0.015311352908611298, decouple_loss:0.0010811256943270564
The modified gen p mean: 0.4513145387172699, gen p mean: -0.047280944883823395, mean p set: 0.45179483294487The modified gen p mean: 0.45135098695755005, gen p mean: -0.055292293429374695, mean p set: 0.45183131098747253
loss_pred:0.015657389536499977, decouple_loss:0.0010609750170260668
loss_pred:0.014436314813792706, decouple_loss:0.0010812513064593077
Iteration: 3980, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497401714324951, gen p mean: -0.048359259963035583, mean p set: 0.4502204656600952
loss_pred:0.015124762430787086, decouple_loss:0.0010560585651546717
The modified gen p mean: 0.4491015374660492, gen p mean: -0.049469783902168274, mean p set: 0.4495818316936493The modified gen p mean: 0.4483855068683624, gen p mean: -0.04403064399957657, mean p set: 0.4488658010959625
loss_pred:0.015633942559361458, decouple_loss:0.0010940649081021547
loss_pred:0.015506797470152378, decouple_loss:0.0010882962960749865
2023-05-02 17:39:06 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.05266154929995537, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04804670810699463, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.04835221543908119, mean p set: 0.4500633478164673
loss_pred:0.018534168601036072, decouple_loss:0.001320418668910861
loss_pred:0.017454152926802635, decouple_loss:0.0012235825415700674
loss_pred:0.017603734508156776, decouple_loss:0.0012287585996091366
WV_0_PC_1_EH_0_PS_40, loss: 0.0179268978536129, avg_mse: 0.02583659626543522
current test mse: 0.025837
Iteration: 3981, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4506820738315582, gen p mean: -0.0416153185069561, mean p set: 0.45116233825683594
The modified gen p mean: 0.44896262884140015, gen p mean: -0.043076395988464355, mean p set: 0.44944292306900024
The modified gen p mean: 0.45062196254730225, gen p mean: -0.04284316301345825, mean p set: 0.45110228657722473
loss_pred:0.016277054324746132, decouple_loss:0.0012040374567732215
loss_pred:0.015490424819290638, decouple_loss:0.0012334120692685246
loss_pred:0.014934588223695755, decouple_loss:0.0010635433718562126
Iteration: 3982, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500887095928192, gen p mean: -0.03970909118652344, mean p set: 0.4505689740180969
loss_pred:0.015628520399332047, decouple_loss:0.0011439794907346368
The modified gen p mean: 0.44981926679611206, gen p mean: -0.045086827129125595, mean p set: 0.45029953122138977The modified gen p mean: 0.4500882923603058, gen p mean: -0.03879751265048981, mean p set: 0.4505685865879059
loss_pred:0.015272967517375946, decouple_loss:0.001125571085140109
loss_pred:0.016090095043182373, decouple_loss:0.0012543328339233994
Iteration: 3983, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492666721343994, gen p mean: -0.03997937962412834, mean p set: 0.4497469365596771
The modified gen p mean: 0.449672669172287, gen p mean: -0.0362841859459877, mean p set: 0.4501529335975647
loss_pred:0.015332115814089775, decouple_loss:0.0010715904645621777
loss_pred:0.015051396563649178, decouple_loss:0.001026445534080267
The modified gen p mean: 0.45033037662506104, gen p mean: -0.03714260458946228, mean p set: 0.45081067085266113
loss_pred:0.015242297202348709, decouple_loss:0.001164893968962133
Iteration: 3984, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502076208591461, gen p mean: -0.037379369139671326, mean p set: 0.4506879150867462
The modified gen p mean: 0.44990256428718567, gen p mean: -0.03153274580836296, mean p set: 0.45038288831710815
loss_pred:0.015302561223506927, decouple_loss:0.0011383122764527798
loss_pred:0.015903763473033905, decouple_loss:0.0011611642548814416
The modified gen p mean: 0.4495244026184082, gen p mean: -0.03299427032470703, mean p set: 0.4500047266483307
loss_pred:0.015421167947351933, decouple_loss:0.0011545715387910604
Iteration: 3985, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45027145743370056, gen p mean: -0.039425015449523926, mean p set: 0.45075175166130066
loss_pred:0.01636725291609764, decouple_loss:0.0011878273217007518
The modified gen p mean: 0.4499701261520386, gen p mean: -0.03764850273728371, mean p set: 0.45045042037963867
The modified gen p mean: 0.4492405652999878, gen p mean: -0.04196680337190628, mean p set: 0.4497208595275879
loss_pred:0.015608362853527069, decouple_loss:0.0010845242068171501
loss_pred:0.015866359695792198, decouple_loss:0.0010776035487651825
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012001_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012001_3_24hr.npz
NaN value num: 0
Iteration: 3986, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473174512386322, gen p mean: -0.041377726942300797, mean p set: 0.4477977156639099
loss_pred:0.014501533471047878, decouple_loss:0.0012358040548861027
The modified gen p mean: 0.44769904017448425, gen p mean: -0.042996518313884735, mean p set: 0.44817930459976196The modified gen p mean: 0.44717469811439514, gen p mean: -0.046385105699300766, mean p set: 0.44765499234199524
loss_pred:0.014769705943763256, decouple_loss:0.0012124195927754045
loss_pred:0.014910070225596428, decouple_loss:0.0012578925816342235
Iteration: 3987, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469364583492279, gen p mean: -0.043723125010728836, mean p set: 0.447416752576828
loss_pred:0.014635618776082993, decouple_loss:0.0010590007295832038
The modified gen p mean: 0.4487560987472534, gen p mean: -0.04740923270583153, mean p set: 0.44923636317253113The modified gen p mean: 0.4478078782558441, gen p mean: -0.04847508668899536, mean p set: 0.4482881724834442
loss_pred:0.014512876980006695, decouple_loss:0.0011953391367569566
loss_pred:0.014323648996651173, decouple_loss:0.0012241287622600794
Iteration: 3988, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44784802198410034, gen p mean: -0.04836781322956085, mean p set: 0.44832831621170044
The modified gen p mean: 0.44614535570144653, gen p mean: -0.05578209459781647, mean p set: 0.44662564992904663
loss_pred:0.014718513004481792, decouple_loss:0.0011300822952762246
loss_pred:0.014640913344919682, decouple_loss:0.0011568249901756644
The modified gen p mean: 0.4473952651023865, gen p mean: -0.05002330616116524, mean p set: 0.4478755593299866
loss_pred:0.014686758629977703, decouple_loss:0.0012695644982159138
Iteration: 3989, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44840213656425476, gen p mean: -0.048275962471961975, mean p set: 0.44888240098953247
The modified gen p mean: 0.44753625988960266, gen p mean: -0.04905137047171593, mean p set: 0.44801655411720276
loss_pred:0.014437067322432995, decouple_loss:0.001176048070192337
loss_pred:0.013810788281261921, decouple_loss:0.0012055212864652276
The modified gen p mean: 0.44665172696113586, gen p mean: -0.054828643798828125, mean p set: 0.44713205099105835
loss_pred:0.014377114363014698, decouple_loss:0.0012453217059373856
Iteration: 3990, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44640475511550903, gen p mean: -0.04896353930234909, mean p set: 0.44688504934310913
The modified gen p mean: 0.4467913806438446, gen p mean: -0.054608192294836044, mean p set: 0.4472716748714447loss_pred:0.014355318620800972, decouple_loss:0.001134843216277659
The modified gen p mean: 0.44812071323394775, gen p mean: -0.04928337037563324, mean p set: 0.44860100746154785
loss_pred:0.014660355634987354, decouple_loss:0.0012665746035054326
loss_pred:0.014594955369830132, decouple_loss:0.0011880152160301805
2023-05-02 17:41:46 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.05710793286561966, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.053374744951725006, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.05343067646026611, mean p set: 0.4500633478164673
loss_pred:0.018833793699741364, decouple_loss:0.0012617491884157062
loss_pred:0.0176905058324337, decouple_loss:0.0012627833057194948
loss_pred:0.01775580272078514, decouple_loss:0.0012803849531337619
WV_0_PC_1_EH_0_PS_40, loss: 0.018156783655285835, avg_mse: 0.026302292943000793
current test mse: 0.026302
Iteration: 3991, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470263123512268, gen p mean: -0.0512227788567543, mean p set: 0.4475066065788269
The modified gen p mean: 0.4480387568473816, gen p mean: -0.05599167197942734, mean p set: 0.4485190510749817
The modified gen p mean: 0.4473073184490204, gen p mean: -0.0543186254799366, mean p set: 0.4477875828742981
loss_pred:0.01457725279033184, decouple_loss:0.001210989779792726
loss_pred:0.013792311772704124, decouple_loss:0.001163000357337296
loss_pred:0.014618726447224617, decouple_loss:0.0011577541008591652
Iteration: 3992, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471668004989624, gen p mean: -0.048642173409461975, mean p set: 0.4476470947265625
loss_pred:0.014335166662931442, decouple_loss:0.001177918747998774
The modified gen p mean: 0.44755247235298157, gen p mean: -0.05499721318483353, mean p set: 0.4480327367782593
The modified gen p mean: 0.446856826543808, gen p mean: -0.05212712660431862, mean p set: 0.4473371207714081
loss_pred:0.013785861432552338, decouple_loss:0.00130610098131001
loss_pred:0.014149969443678856, decouple_loss:0.0011267741210758686
Iteration: 3993, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44689351320266724, gen p mean: -0.0586746446788311, mean p set: 0.4473738372325897
The modified gen p mean: 0.4466308057308197, gen p mean: -0.0603426992893219, mean p set: 0.4471111297607422
loss_pred:0.01344866119325161, decouple_loss:0.0011122069554403424
loss_pred:0.013913465663790703, decouple_loss:0.0011470820754766464
The modified gen p mean: 0.4469571113586426, gen p mean: -0.05794825404882431, mean p set: 0.44743743538856506
loss_pred:0.0144827701151371, decouple_loss:0.0013778043212369084
Iteration: 3994, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482475817203522, gen p mean: -0.0501868799328804, mean p set: 0.44872787594795227
The modified gen p mean: 0.4466235339641571, gen p mean: -0.05514337494969368, mean p set: 0.4471038579940796
loss_pred:0.013742144219577312, decouple_loss:0.0013075913302600384
loss_pred:0.015063994564116001, decouple_loss:0.0012894077226519585
The modified gen p mean: 0.4471936821937561, gen p mean: -0.04965510964393616, mean p set: 0.4476739168167114
loss_pred:0.014571672305464745, decouple_loss:0.0012788526946678758
Iteration: 3995, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44667771458625793, gen p mean: -0.053672317415475845, mean p set: 0.44715800881385803
loss_pred:0.013674485497176647, decouple_loss:0.0012699323706328869
The modified gen p mean: 0.44684135913848877, gen p mean: -0.049583032727241516, mean p set: 0.44732168316841125The modified gen p mean: 0.4465222954750061, gen p mean: -0.05502215027809143, mean p set: 0.4470026195049286
loss_pred:0.013868793845176697, decouple_loss:0.0012773595517501235
loss_pred:0.014246401377022266, decouple_loss:0.001264391466975212
Iteration: 3996, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465309977531433, gen p mean: -0.049401916563510895, mean p set: 0.4470112919807434
loss_pred:0.013636253774166107, decouple_loss:0.0011641052551567554
The modified gen p mean: 0.4460698366165161, gen p mean: -0.05691424012184143, mean p set: 0.4465501010417938The modified gen p mean: 0.4481477439403534, gen p mean: -0.05047226697206497, mean p set: 0.4486280083656311
loss_pred:0.0142531618475914, decouple_loss:0.001439814455807209
loss_pred:0.014221392571926117, decouple_loss:0.001214388757944107
Iteration: 3997, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466247856616974, gen p mean: -0.043158069252967834, mean p set: 0.4471050798892975
loss_pred:0.0140375392511487, decouple_loss:0.0012418176047503948
The modified gen p mean: 0.44737738370895386, gen p mean: -0.0511542372405529, mean p set: 0.44785767793655396The modified gen p mean: 0.44766607880592346, gen p mean: -0.04570508748292923, mean p set: 0.44814640283584595
loss_pred:0.014484136365354061, decouple_loss:0.00121407734695822
loss_pred:0.014609578996896744, decouple_loss:0.0011647873325273395
Iteration: 3998, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44738903641700745, gen p mean: -0.044946614652872086, mean p set: 0.44786933064460754
loss_pred:0.01450794842094183, decouple_loss:0.0011265923967584968
The modified gen p mean: 0.44715988636016846, gen p mean: -0.04719564691185951, mean p set: 0.44764021039009094The modified gen p mean: 0.44609716534614563, gen p mean: -0.04865545406937599, mean p set: 0.4465774595737457
loss_pred:0.014618425630033016, decouple_loss:0.0011279338505119085
loss_pred:0.014590946957468987, decouple_loss:0.001301342505030334
Iteration: 3999, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447295606136322, gen p mean: -0.04631366580724716, mean p set: 0.4477759003639221
loss_pred:0.014316560700535774, decouple_loss:0.0011093782959505916
The modified gen p mean: 0.446953147649765, gen p mean: -0.05004563927650452, mean p set: 0.4474334716796875The modified gen p mean: 0.4467073678970337, gen p mean: -0.05126607045531273, mean p set: 0.4471876323223114
loss_pred:0.014222381636500359, decouple_loss:0.0010651616612449288
loss_pred:0.014423277229070663, decouple_loss:0.0010644939029589295
Iteration: 4000, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4463751018047333, gen p mean: -0.057165659964084625, mean p set: 0.4468553960323334
loss_pred:0.01391422376036644, decouple_loss:0.0011907840380445123
The modified gen p mean: 0.44660329818725586, gen p mean: -0.04944641515612602, mean p set: 0.44708362221717834The modified gen p mean: 0.44691500067710876, gen p mean: -0.0516224205493927, mean p set: 0.44739529490470886
loss_pred:0.014105807058513165, decouple_loss:0.0011112926295027137
loss_pred:0.01353237684816122, decouple_loss:0.0011887922883033752
2023-05-02 17:43:42 itr: 4000
training loss: [0.01359182 0.01397376 0.01416137]
save model to /work/09012/haoli1/ls6/ERA5_PredRNN/checkpoints/WV_0_PC_1_EH_0_PS_40/model_4000.ckpt
2023-05-02 17:43:47 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.055584412068128586, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.05146043002605438, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.05175493285059929, mean p set: 0.4500633478164673
loss_pred:0.018971679732203484, decouple_loss:0.001190820592455566
loss_pred:0.017880283296108246, decouple_loss:0.0011395139154046774
loss_pred:0.017891526222229004, decouple_loss:0.0012232481967657804
WV_0_PC_1_EH_0_PS_40, loss: 0.01830705627799034, avg_mse: 0.02665199339389801
current test mse: 0.026652
Iteration: 4001, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474543631076813, gen p mean: -0.05405783653259277, mean p set: 0.447934627532959
The modified gen p mean: 0.447276771068573, gen p mean: -0.04785385727882385, mean p set: 0.4477570950984955
The modified gen p mean: 0.44669532775878906, gen p mean: -0.05416124686598778, mean p set: 0.44717565178871155
loss_pred:0.014387499541044235, decouple_loss:0.0011304925428703427
loss_pred:0.014295150525867939, decouple_loss:0.0011787184048444033
loss_pred:0.014142134226858616, decouple_loss:0.0010699244448915124
Iteration: 4002, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44818082451820374, gen p mean: -0.05332668125629425, mean p set: 0.4486611485481262
loss_pred:0.014193271286785603, decouple_loss:0.0010365791385993361
The modified gen p mean: 0.44703614711761475, gen p mean: -0.05433472618460655, mean p set: 0.44751641154289246The modified gen p mean: 0.4472956657409668, gen p mean: -0.050920214504003525, mean p set: 0.4477759599685669
loss_pred:0.014357302337884903, decouple_loss:0.0010185468709096313
loss_pred:0.01363307423889637, decouple_loss:0.0010835666907951236
Iteration: 4003, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471932053565979, gen p mean: -0.04883773252367973, mean p set: 0.4476735293865204
loss_pred:0.0142121072858572, decouple_loss:0.0010788562940433621
The modified gen p mean: 0.44814741611480713, gen p mean: -0.04619656503200531, mean p set: 0.44862768054008484The modified gen p mean: 0.4482123553752899, gen p mean: -0.046738360077142715, mean p set: 0.44869264960289
loss_pred:0.014266344718635082, decouple_loss:0.0011855523334816098
loss_pred:0.013934215530753136, decouple_loss:0.0011768883559852839
Iteration: 4004, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44720712304115295, gen p mean: -0.04377947747707367, mean p set: 0.44768741726875305
loss_pred:0.01403992623090744, decouple_loss:0.0010264994343742728
The modified gen p mean: 0.44716647267341614, gen p mean: -0.04640163108706474, mean p set: 0.44764676690101624The modified gen p mean: 0.4472036063671112, gen p mean: -0.047901686280965805, mean p set: 0.4476839005947113
loss_pred:0.014257857576012611, decouple_loss:0.0010693406220525503
loss_pred:0.01342814415693283, decouple_loss:0.0012111447285860777
Iteration: 4005, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44794782996177673, gen p mean: -0.043063461780548096, mean p set: 0.44842812418937683
loss_pred:0.013975617475807667, decouple_loss:0.0010380370076745749
The modified gen p mean: 0.4482124447822571, gen p mean: -0.04202670231461525, mean p set: 0.4486927390098572The modified gen p mean: 0.4474721848964691, gen p mean: -0.048271968960762024, mean p set: 0.4479525089263916
loss_pred:0.01385677419602871, decouple_loss:0.001105057424865663
loss_pred:0.014010353945195675, decouple_loss:0.001054421067237854
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012007_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012007_3_24hr.npz
NaN value num: 0
Iteration: 4006, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498565196990967, gen p mean: -0.042760927230119705, mean p set: 0.4503368139266968
loss_pred:0.016762934625148773, decouple_loss:0.0013365776976570487
The modified gen p mean: 0.45131009817123413, gen p mean: -0.04098398983478546, mean p set: 0.4517904222011566The modified gen p mean: 0.4522090256214142, gen p mean: -0.041597917675971985, mean p set: 0.4526892900466919
loss_pred:0.016336658969521523, decouple_loss:0.001264610211364925
loss_pred:0.017017517238855362, decouple_loss:0.0013471035053953528
Iteration: 4007, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.453058660030365, gen p mean: -0.040640443563461304, mean p set: 0.4535389542579651
The modified gen p mean: 0.4513746201992035, gen p mean: -0.04065846651792526, mean p set: 0.4518548846244812
loss_pred:0.016209986060857773, decouple_loss:0.001297194859944284
loss_pred:0.016462383791804314, decouple_loss:0.0012785325525328517
The modified gen p mean: 0.4515138268470764, gen p mean: -0.03404998406767845, mean p set: 0.4519941210746765
loss_pred:0.016178516671061516, decouple_loss:0.0011104936711490154
Iteration: 4008, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4529423713684082, gen p mean: -0.03718353062868118, mean p set: 0.4534226953983307
loss_pred:0.01574045978486538, decouple_loss:0.0012832210632041097
The modified gen p mean: 0.4527140259742737, gen p mean: -0.03653613477945328, mean p set: 0.4531942903995514The modified gen p mean: 0.4508700668811798, gen p mean: -0.03554115444421768, mean p set: 0.4513503611087799
loss_pred:0.01608649268746376, decouple_loss:0.0012265064287930727
loss_pred:0.016640037298202515, decouple_loss:0.0013051109854131937
Iteration: 4009, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45271334052085876, gen p mean: -0.03451210632920265, mean p set: 0.45319366455078125
The modified gen p mean: 0.4528239965438843, gen p mean: -0.033818747848272324, mean p set: 0.4533042907714844
loss_pred:0.01470274105668068, decouple_loss:0.0012046468909829855
loss_pred:0.015610230155289173, decouple_loss:0.0011967170285061002
The modified gen p mean: 0.4513487219810486, gen p mean: -0.030267072841525078, mean p set: 0.45182904601097107
loss_pred:0.017064169049263, decouple_loss:0.0012250128202140331
Iteration: 4010, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45270636677742004, gen p mean: -0.03665175661444664, mean p set: 0.45318663120269775
The modified gen p mean: 0.4521506130695343, gen p mean: -0.036015965044498444, mean p set: 0.4526309072971344
loss_pred:0.015597855672240257, decouple_loss:0.0015726507408544421
loss_pred:0.01600666157901287, decouple_loss:0.001510170055553317
The modified gen p mean: 0.45276227593421936, gen p mean: -0.0361432284116745, mean p set: 0.45324259996414185
loss_pred:0.015132809989154339, decouple_loss:0.00136739166919142
2023-05-02 17:46:17 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.04474887624382973, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.040757592767477036, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.04095270112156868, mean p set: 0.4500633478164673
loss_pred:0.018649177625775337, decouple_loss:0.0013454596046358347
loss_pred:0.01754325069487095, decouple_loss:0.0012234305031597614
loss_pred:0.017635403200984, decouple_loss:0.0013418418820947409
WV_0_PC_1_EH_0_PS_40, loss: 0.01800779066979885, avg_mse: 0.026034941896796227
current test mse: 0.026035
Iteration: 4011, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45097970962524414, gen p mean: -0.033011000603437424, mean p set: 0.45146000385284424
The modified gen p mean: 0.4521689713001251, gen p mean: -0.03538418933749199, mean p set: 0.45264923572540283
The modified gen p mean: 0.4522453546524048, gen p mean: -0.035786375403404236, mean p set: 0.4527256488800049
loss_pred:0.015881340950727463, decouple_loss:0.0013004918582737446
loss_pred:0.01563377119600773, decouple_loss:0.0013276785612106323
loss_pred:0.01580444537103176, decouple_loss:0.0013377447612583637
Iteration: 4012, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4520118534564972, gen p mean: -0.03724372386932373, mean p set: 0.4524921178817749
loss_pred:0.015662014484405518, decouple_loss:0.0012307217111811042
The modified gen p mean: 0.45104166865348816, gen p mean: -0.04071332514286041, mean p set: 0.45152196288108826The modified gen p mean: 0.4513583779335022, gen p mean: -0.03836776688694954, mean p set: 0.4518386423587799
loss_pred:0.01625669002532959, decouple_loss:0.001312185893766582
loss_pred:0.01651366613805294, decouple_loss:0.0014096241211518645
Iteration: 4013, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45233041048049927, gen p mean: -0.03576546907424927, mean p set: 0.45281070470809937
loss_pred:0.016114557161927223, decouple_loss:0.0013165202690288424
The modified gen p mean: 0.45227065682411194, gen p mean: -0.03172675147652626, mean p set: 0.45275095105171204The modified gen p mean: 0.45096468925476074, gen p mean: -0.03853873535990715, mean p set: 0.4514450132846832
loss_pred:0.016609152778983116, decouple_loss:0.001291430089622736
loss_pred:0.015088663436472416, decouple_loss:0.0013417932204902172
Iteration: 4014, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4524080753326416, gen p mean: -0.03519904986023903, mean p set: 0.4528883397579193
loss_pred:0.015707189217209816, decouple_loss:0.001333056134171784
The modified gen p mean: 0.4514199197292328, gen p mean: -0.030943667516112328, mean p set: 0.4519002437591553The modified gen p mean: 0.45220547914505005, gen p mean: -0.03620285913348198, mean p set: 0.45268580317497253
loss_pred:0.015078864060342312, decouple_loss:0.001317816087976098
loss_pred:0.016646554693579674, decouple_loss:0.0013869067188352346
Iteration: 4015, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45180991291999817, gen p mean: -0.03625939041376114, mean p set: 0.45229020714759827
loss_pred:0.016475876793265343, decouple_loss:0.0011996676912531257
The modified gen p mean: 0.4513258635997772, gen p mean: -0.041985947638750076, mean p set: 0.45180612802505493The modified gen p mean: 0.45249706506729126, gen p mean: -0.03400586545467377, mean p set: 0.45297735929489136
loss_pred:0.016314011067152023, decouple_loss:0.001222953898832202
loss_pred:0.015119646675884724, decouple_loss:0.0012704868568107486
Iteration: 4016, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4528367221355438, gen p mean: -0.0413057841360569, mean p set: 0.4533170461654663
loss_pred:0.015372765250504017, decouple_loss:0.0013923939550295472
The modified gen p mean: 0.4505383372306824, gen p mean: -0.04093189910054207, mean p set: 0.4510186016559601The modified gen p mean: 0.4522641897201538, gen p mean: -0.03863426297903061, mean p set: 0.4527444541454315
loss_pred:0.016073422506451607, decouple_loss:0.0012832045322284102
loss_pred:0.015749700367450714, decouple_loss:0.0012111762771382928
Iteration: 4017, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45169582962989807, gen p mean: -0.0375167615711689, mean p set: 0.4521760940551758
loss_pred:0.016057396307587624, decouple_loss:0.0013042432256042957
The modified gen p mean: 0.45246726274490356, gen p mean: -0.04490381479263306, mean p set: 0.45294755697250366The modified gen p mean: 0.4510240852832794, gen p mean: -0.04727410525083542, mean p set: 0.4515043795108795
loss_pred:0.016485892236232758, decouple_loss:0.001405140501447022
loss_pred:0.015557625330984592, decouple_loss:0.0013763194438070059
Iteration: 4018, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4536548852920532, gen p mean: -0.04142337664961815, mean p set: 0.4541351795196533
loss_pred:0.015230849385261536, decouple_loss:0.0013029335532337427
The modified gen p mean: 0.4543343782424927, gen p mean: -0.0410047248005867, mean p set: 0.4548146724700928The modified gen p mean: 0.45347917079925537, gen p mean: -0.045668285340070724, mean p set: 0.45395946502685547
loss_pred:0.015302831307053566, decouple_loss:0.0012790873879566789
loss_pred:0.01521046832203865, decouple_loss:0.0012270343722775578
Iteration: 4019, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45082202553749084, gen p mean: -0.04664337635040283, mean p set: 0.45130228996276855
loss_pred:0.01523223053663969, decouple_loss:0.0013556209160014987
The modified gen p mean: 0.4506838619709015, gen p mean: -0.04489043727517128, mean p set: 0.4511641561985016The modified gen p mean: 0.45398029685020447, gen p mean: -0.044123776257038116, mean p set: 0.45446059107780457
loss_pred:0.015251715667545795, decouple_loss:0.001334012602455914
loss_pred:0.014932435005903244, decouple_loss:0.001170465024188161
Iteration: 4020, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45108267664909363, gen p mean: -0.04845396801829338, mean p set: 0.4515630006790161
loss_pred:0.016798246651887894, decouple_loss:0.0014595790999010205
The modified gen p mean: 0.45048317313194275, gen p mean: -0.05021653696894646, mean p set: 0.45096346735954285The modified gen p mean: 0.4509720802307129, gen p mean: -0.04598396643996239, mean p set: 0.451452374458313
loss_pred:0.016461990773677826, decouple_loss:0.0014184823958203197
loss_pred:0.016021184623241425, decouple_loss:0.001332240761257708
2023-05-02 17:48:12 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.055065859109163284, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.05098842456936836, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.0516202487051487, mean p set: 0.4500633478164673
loss_pred:0.018545158207416534, decouple_loss:0.0013572556199505925
loss_pred:0.01745283044874668, decouple_loss:0.0012645367532968521
loss_pred:0.017546378076076508, decouple_loss:0.0013106395490467548
WV_0_PC_1_EH_0_PS_40, loss: 0.017913663759827614, avg_mse: 0.025826480239629745
current test mse: 0.025826
Iteration: 4021, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45056912302970886, gen p mean: -0.041371408849954605, mean p set: 0.4510493874549866
The modified gen p mean: 0.4527190923690796, gen p mean: -0.047403644770383835, mean p set: 0.4531993865966797
The modified gen p mean: 0.450749009847641, gen p mean: -0.043854013085365295, mean p set: 0.4512292742729187
loss_pred:0.017266754060983658, decouple_loss:0.0011622206075116992
loss_pred:0.017036287114024162, decouple_loss:0.001130191725678742
loss_pred:0.015427143312990665, decouple_loss:0.0012081426102668047
Iteration: 4022, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45272040367126465, gen p mean: -0.04419073089957237, mean p set: 0.45320072770118713
loss_pred:0.015490725636482239, decouple_loss:0.0012492079986259341
The modified gen p mean: 0.4516972601413727, gen p mean: -0.04227504879236221, mean p set: 0.4521775543689728The modified gen p mean: 0.4539129436016083, gen p mean: -0.04012294486165047, mean p set: 0.45439326763153076
loss_pred:0.01551139261573553, decouple_loss:0.0013540976215153933
loss_pred:0.01652945950627327, decouple_loss:0.0012876277323812246
Iteration: 4023, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508156180381775, gen p mean: -0.04078586772084236, mean p set: 0.4512959122657776
loss_pred:0.015311256982386112, decouple_loss:0.0013454293366521597
The modified gen p mean: 0.4522281885147095, gen p mean: -0.04340382292866707, mean p set: 0.45270848274230957The modified gen p mean: 0.45211371779441833, gen p mean: -0.042092353105545044, mean p set: 0.4525940418243408
loss_pred:0.015683483332395554, decouple_loss:0.0012394038494676352
loss_pred:0.016126153990626335, decouple_loss:0.0011807098053395748
Iteration: 4024, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508441388607025, gen p mean: -0.04921203851699829, mean p set: 0.4513244330883026
loss_pred:0.01637055166065693, decouple_loss:0.0012542635668069124
The modified gen p mean: 0.4511546194553375, gen p mean: -0.04821499064564705, mean p set: 0.4516349136829376The modified gen p mean: 0.4511820375919342, gen p mean: -0.04581092670559883, mean p set: 0.4516623318195343
loss_pred:0.016416456550359726, decouple_loss:0.0013101629447191954
loss_pred:0.01610255055129528, decouple_loss:0.0012113968841731548
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012016_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012016_3_24hr.npz
NaN value num: 0
Iteration: 4025, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45160356163978577, gen p mean: -0.047836001962423325, mean p set: 0.4520838260650635
loss_pred:0.01655605621635914, decouple_loss:0.001174410805106163
The modified gen p mean: 0.45270445942878723, gen p mean: -0.04904697462916374, mean p set: 0.45318475365638733The modified gen p mean: 0.45160067081451416, gen p mean: -0.04502342641353607, mean p set: 0.45208099484443665
loss_pred:0.015484466217458248, decouple_loss:0.0011533752549439669
loss_pred:0.016411932185292244, decouple_loss:0.0012019885471090674
Iteration: 4026, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4532153904438019, gen p mean: -0.04448183253407478, mean p set: 0.453695684671402
loss_pred:0.015988269820809364, decouple_loss:0.0012653761077672243
The modified gen p mean: 0.4511440396308899, gen p mean: -0.05050100386142731, mean p set: 0.45162433385849The modified gen p mean: 0.45178744196891785, gen p mean: -0.04937439784407616, mean p set: 0.45226770639419556
loss_pred:0.015895921736955643, decouple_loss:0.0013281450374051929
loss_pred:0.01691465638577938, decouple_loss:0.0014107907190918922
Iteration: 4027, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45201635360717773, gen p mean: -0.044341493397951126, mean p set: 0.4524966776371002
The modified gen p mean: 0.45021769404411316, gen p mean: -0.05184612795710564, mean p set: 0.45069798827171326
loss_pred:0.01705501601099968, decouple_loss:0.001175378798507154
loss_pred:0.015782849863171577, decouple_loss:0.0010198052041232586
The modified gen p mean: 0.4513148069381714, gen p mean: -0.04553164169192314, mean p set: 0.4517951011657715
loss_pred:0.01671461947262287, decouple_loss:0.0012337156804278493
Iteration: 4028, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4510784447193146, gen p mean: -0.05031410604715347, mean p set: 0.4515587389469147
loss_pred:0.01640946976840496, decouple_loss:0.001108887605369091
The modified gen p mean: 0.45174500346183777, gen p mean: -0.047623150050640106, mean p set: 0.45222529768943787
The modified gen p mean: 0.45206692814826965, gen p mean: -0.05059584602713585, mean p set: 0.45254722237586975
loss_pred:0.016897741705179214, decouple_loss:0.0012603859649971128
loss_pred:0.015604113228619099, decouple_loss:0.001314555061981082
Iteration: 4029, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507941007614136, gen p mean: -0.05429421365261078, mean p set: 0.45127442479133606
loss_pred:0.016519373282790184, decouple_loss:0.0012017781846225262
The modified gen p mean: 0.45226433873176575, gen p mean: -0.04854380339384079, mean p set: 0.45274466276168823The modified gen p mean: 0.4514394998550415, gen p mean: -0.047340139746665955, mean p set: 0.4519197940826416
loss_pred:0.016504013910889626, decouple_loss:0.001195309218019247
loss_pred:0.01671954058110714, decouple_loss:0.001258362433873117
Iteration: 4030, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45154109597206116, gen p mean: -0.04941365495324135, mean p set: 0.45202142000198364
loss_pred:0.016959765926003456, decouple_loss:0.0010007490636780858
The modified gen p mean: 0.45244091749191284, gen p mean: -0.044459082186222076, mean p set: 0.45292118191719055The modified gen p mean: 0.4512234926223755, gen p mean: -0.052853528410196304, mean p set: 0.4517037868499756
loss_pred:0.016764003783464432, decouple_loss:0.0010604379931464791
loss_pred:0.016842806711792946, decouple_loss:0.0011120353592559695
2023-05-02 17:50:42 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.06066907197237015, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.0562962144613266, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.05694393068552017, mean p set: 0.4500633478164673
loss_pred:0.018645763397216797, decouple_loss:0.00117769418284297
loss_pred:0.017473779618740082, decouple_loss:0.0012300823582336307
loss_pred:0.017596539109945297, decouple_loss:0.0011936144437640905
WV_0_PC_1_EH_0_PS_40, loss: 0.01796538382768631, avg_mse: 0.02595875784754753
current test mse: 0.025959
Iteration: 4031, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4519716203212738, gen p mean: -0.0489819273352623, mean p set: 0.4524519443511963
The modified gen p mean: 0.4516028165817261, gen p mean: -0.048324257135391235, mean p set: 0.4520830810070038
The modified gen p mean: 0.45178964734077454, gen p mean: -0.05468771979212761, mean p set: 0.45226994156837463
loss_pred:0.015205936506390572, decouple_loss:0.0010595028288662434
loss_pred:0.01668846420943737, decouple_loss:0.001073784427717328
loss_pred:0.016410566866397858, decouple_loss:0.0010537211783230305
Iteration: 4032, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4532906711101532, gen p mean: -0.05162891745567322, mean p set: 0.4537709653377533
loss_pred:0.016243990510702133, decouple_loss:0.001035780180245638
The modified gen p mean: 0.4502146244049072, gen p mean: -0.05365251749753952, mean p set: 0.4506949186325073The modified gen p mean: 0.4534396529197693, gen p mean: -0.05559707432985306, mean p set: 0.4539199471473694
loss_pred:0.01530338916927576, decouple_loss:0.0010562398238107562
loss_pred:0.016865430399775505, decouple_loss:0.0011343841906636953
Iteration: 4033, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45156583189964294, gen p mean: -0.05486791580915451, mean p set: 0.45204612612724304
loss_pred:0.015732064843177795, decouple_loss:0.0010556918568909168
The modified gen p mean: 0.4514700770378113, gen p mean: -0.05349856615066528, mean p set: 0.45195040106773376
The modified gen p mean: 0.45226386189460754, gen p mean: -0.05228234827518463, mean p set: 0.45274418592453003
loss_pred:0.01545588206499815, decouple_loss:0.0011908961459994316
loss_pred:0.01560833677649498, decouple_loss:0.0013441689079627395
Iteration: 4034, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45161208510398865, gen p mean: -0.050290547311306, mean p set: 0.45209240913391113
loss_pred:0.01592850498855114, decouple_loss:0.0011503805872052908
The modified gen p mean: 0.45070746541023254, gen p mean: -0.05268801376223564, mean p set: 0.45118778944015503The modified gen p mean: 0.4512425363063812, gen p mean: -0.05401879549026489, mean p set: 0.4517228305339813
loss_pred:0.016063127666711807, decouple_loss:0.0010937429033219814
loss_pred:0.01664542779326439, decouple_loss:0.001113662961870432
Iteration: 4035, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4522682726383209, gen p mean: -0.049096621572971344, mean p set: 0.4527485966682434
loss_pred:0.016321098431944847, decouple_loss:0.0011940402910113335
The modified gen p mean: 0.4522474706172943, gen p mean: -0.047215089201927185, mean p set: 0.4527277946472168The modified gen p mean: 0.45117104053497314, gen p mean: -0.04969608411192894, mean p set: 0.45165136456489563
loss_pred:0.01672934740781784, decouple_loss:0.0010465874802321196
loss_pred:0.01600077748298645, decouple_loss:0.0011288896203041077
Iteration: 4036, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45112621784210205, gen p mean: -0.048887357115745544, mean p set: 0.45160651206970215
loss_pred:0.01664922758936882, decouple_loss:0.0011391433654353023
The modified gen p mean: 0.4505658447742462, gen p mean: -0.04988165944814682, mean p set: 0.4510461390018463The modified gen p mean: 0.4506503641605377, gen p mean: -0.049964841455221176, mean p set: 0.4511306881904602
loss_pred:0.01567697525024414, decouple_loss:0.0012383912689983845
loss_pred:0.017019962891936302, decouple_loss:0.001281599747017026
Iteration: 4037, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4538593888282776, gen p mean: -0.051226139068603516, mean p set: 0.4543396830558777
loss_pred:0.016135435551404953, decouple_loss:0.0011736036976799369
The modified gen p mean: 0.45016083121299744, gen p mean: -0.05109589174389839, mean p set: 0.45064112544059753The modified gen p mean: 0.45079344511032104, gen p mean: -0.04852855205535889, mean p set: 0.45127376914024353
loss_pred:0.01698843576014042, decouple_loss:0.0011546699097380042
loss_pred:0.017029045149683952, decouple_loss:0.0011498701060190797
Iteration: 4038, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45253682136535645, gen p mean: -0.051970068365335464, mean p set: 0.45301714539527893
loss_pred:0.01633480191230774, decouple_loss:0.0011311802081763744
The modified gen p mean: 0.452044278383255, gen p mean: -0.05192152410745621, mean p set: 0.4525245428085327The modified gen p mean: 0.4514380693435669, gen p mean: -0.05724692717194557, mean p set: 0.451918363571167
loss_pred:0.015194762498140335, decouple_loss:0.0012238683411851525
loss_pred:0.015415338799357414, decouple_loss:0.0011422858806326985
Iteration: 4039, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514194428920746, gen p mean: -0.047461070120334625, mean p set: 0.4518997073173523
loss_pred:0.017058057710528374, decouple_loss:0.0014331649290397763
The modified gen p mean: 0.45145925879478455, gen p mean: -0.0508926697075367, mean p set: 0.45193958282470703The modified gen p mean: 0.4506746232509613, gen p mean: -0.04971873387694359, mean p set: 0.4511549472808838
loss_pred:0.015614122152328491, decouple_loss:0.0011781139764934778
loss_pred:0.01690727472305298, decouple_loss:0.0013090831926092505
Iteration: 4040, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507308602333069, gen p mean: -0.044296566396951675, mean p set: 0.45121118426322937
loss_pred:0.01656675897538662, decouple_loss:0.001354498090222478
The modified gen p mean: 0.44989460706710815, gen p mean: -0.05550269037485123, mean p set: 0.45037490129470825The modified gen p mean: 0.4511788487434387, gen p mean: -0.05489581078290939, mean p set: 0.4516591429710388
loss_pred:0.016510752961039543, decouple_loss:0.0012033892562612891
loss_pred:0.015769772231578827, decouple_loss:0.0011579564306885004
2023-05-02 17:52:37 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.05645788833498955, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.05219872668385506, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.05251054838299751, mean p set: 0.4500633478164673
loss_pred:0.018667438998818398, decouple_loss:0.0012643317459151149
loss_pred:0.017472781240940094, decouple_loss:0.0012250590370967984
loss_pred:0.017658524215221405, decouple_loss:0.0013251557247713208
WV_0_PC_1_EH_0_PS_40, loss: 0.017996490001678467, avg_mse: 0.026005888357758522
current test mse: 0.026006
Iteration: 4041, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.452554315328598, gen p mean: -0.0542837530374527, mean p set: 0.4530346095561981
The modified gen p mean: 0.4513789713382721, gen p mean: -0.04433317109942436, mean p set: 0.4518592655658722
The modified gen p mean: 0.4511578381061554, gen p mean: -0.04474197328090668, mean p set: 0.4516381621360779
loss_pred:0.01646854355931282, decouple_loss:0.001093718921765685
loss_pred:0.0154300881549716, decouple_loss:0.001103403395973146loss_pred:0.016932258382439613, decouple_loss:0.001041896641254425
Iteration: 4042, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450717568397522, gen p mean: -0.03786292299628258, mean p set: 0.45119786262512207
The modified gen p mean: 0.4539720416069031, gen p mean: -0.0471748486161232, mean p set: 0.45445236563682556
loss_pred:0.016388092190027237, decouple_loss:0.001220425241626799
loss_pred:0.016220171004533768, decouple_loss:0.0011405706172809005The modified gen p mean: 0.4532765746116638, gen p mean: -0.048336416482925415, mean p set: 0.4537568688392639
loss_pred:0.01552526280283928, decouple_loss:0.0012827059254050255
Iteration: 4043, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45111456513404846, gen p mean: -0.04588371142745018, mean p set: 0.45159485936164856
The modified gen p mean: 0.4506472051143646, gen p mean: -0.040095262229442596, mean p set: 0.4511275291442871
loss_pred:0.015274050645530224, decouple_loss:0.001047876081429422
loss_pred:0.016873568296432495, decouple_loss:0.0011389111168682575
The modified gen p mean: 0.4505062401294708, gen p mean: -0.045708972960710526, mean p set: 0.45098650455474854
loss_pred:0.01523162517696619, decouple_loss:0.0011163456365466118
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012012_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012012_3_24hr.npz
NaN value num: 0
Iteration: 4044, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484855830669403, gen p mean: -0.05503376945853233, mean p set: 0.4489658772945404
loss_pred:0.01776648871600628, decouple_loss:0.0013597480719909072
The modified gen p mean: 0.44721081852912903, gen p mean: -0.05288785323500633, mean p set: 0.4476911425590515The modified gen p mean: 0.447120726108551, gen p mean: -0.05287231132388115, mean p set: 0.4476010203361511
loss_pred:0.016849087551236153, decouple_loss:0.0011327601969242096
loss_pred:0.016889603808522224, decouple_loss:0.0011527050519362092
Iteration: 4045, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476079046726227, gen p mean: -0.05250270292162895, mean p set: 0.4480881989002228
loss_pred:0.01647934690117836, decouple_loss:0.0011717488523572683
The modified gen p mean: 0.44835320115089417, gen p mean: -0.05717192590236664, mean p set: 0.44883349537849426The modified gen p mean: 0.4484882354736328, gen p mean: -0.04984685033559799, mean p set: 0.4489684998989105
loss_pred:0.016625165939331055, decouple_loss:0.0013387111248448491
loss_pred:0.01650778017938137, decouple_loss:0.0011548881884664297
Iteration: 4046, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471440017223358, gen p mean: -0.05097140371799469, mean p set: 0.4476243257522583
The modified gen p mean: 0.4466514587402344, gen p mean: -0.05080477520823479, mean p set: 0.4471317529678345
loss_pred:0.017683474346995354, decouple_loss:0.0010339249856770039
loss_pred:0.017759200185537338, decouple_loss:0.0011182234156876802
The modified gen p mean: 0.4466222822666168, gen p mean: -0.054053034633398056, mean p set: 0.44710254669189453
loss_pred:0.01758747175335884, decouple_loss:0.0010697096586227417
Iteration: 4047, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446817010641098, gen p mean: -0.0533340759575367, mean p set: 0.4472973346710205
loss_pred:0.016741212457418442, decouple_loss:0.001153933466412127
The modified gen p mean: 0.44798991084098816, gen p mean: -0.0497153103351593, mean p set: 0.44847017526626587The modified gen p mean: 0.4445064067840576, gen p mean: -0.048973120748996735, mean p set: 0.4449867010116577
loss_pred:0.01675466261804104, decouple_loss:0.0011724884388968349
loss_pred:0.017623187974095345, decouple_loss:0.0011475752107799053
Iteration: 4048, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44673940539360046, gen p mean: -0.05305499583482742, mean p set: 0.4472196698188782
loss_pred:0.01662324368953705, decouple_loss:0.0011025238782167435
The modified gen p mean: 0.4468125104904175, gen p mean: -0.053602758795022964, mean p set: 0.4472928047180176The modified gen p mean: 0.4472980797290802, gen p mean: -0.05790869891643524, mean p set: 0.4477783739566803
loss_pred:0.01753445528447628, decouple_loss:0.0011200059670954943
loss_pred:0.017753832042217255, decouple_loss:0.0013004083884879947
Iteration: 4049, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4461824595928192, gen p mean: -0.05422379821538925, mean p set: 0.4466627538204193
loss_pred:0.01756221428513527, decouple_loss:0.001156455953605473
The modified gen p mean: 0.44812196493148804, gen p mean: -0.05193198844790459, mean p set: 0.44860225915908813The modified gen p mean: 0.4473952651023865, gen p mean: -0.05206262692809105, mean p set: 0.4478755593299866
loss_pred:0.01719905622303486, decouple_loss:0.00114895636215806
loss_pred:0.016727479174733162, decouple_loss:0.0011947903549298644
Iteration: 4050, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44757911562919617, gen p mean: -0.055785249918699265, mean p set: 0.44805940985679626
loss_pred:0.016851892694830894, decouple_loss:0.0010806708596646786
The modified gen p mean: 0.4469181001186371, gen p mean: -0.05479789152741432, mean p set: 0.4473983943462372The modified gen p mean: 0.4475243091583252, gen p mean: -0.05207635462284088, mean p set: 0.4480046033859253
loss_pred:0.016734911128878593, decouple_loss:0.0011641534510999918
loss_pred:0.016318559646606445, decouple_loss:0.0012072119861841202
2023-05-02 17:55:15 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.05696113780140877, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.05249784141778946, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.05269091948866844, mean p set: 0.4500633478164673
loss_pred:0.01839110255241394, decouple_loss:0.001206871122121811
loss_pred:0.017309019342064857, decouple_loss:0.00121625408064574
loss_pred:0.01740937866270542, decouple_loss:0.001139652682468295
WV_0_PC_1_EH_0_PS_40, loss: 0.017762547358870506, avg_mse: 0.025563573464751244
current test mse: 0.025564
Iteration: 4051, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472615420818329, gen p mean: -0.05843784287571907, mean p set: 0.447741836309433
The modified gen p mean: 0.44788414239883423, gen p mean: -0.055620238184928894, mean p set: 0.4483644366264343
The modified gen p mean: 0.44724640250205994, gen p mean: -0.05269470810890198, mean p set: 0.44772669672966003
loss_pred:0.016539450734853745, decouple_loss:0.0011220887536183
loss_pred:0.016720769926905632, decouple_loss:0.0011369346175342798
loss_pred:0.016287697479128838, decouple_loss:0.0012182464124634862
Iteration: 4052, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44686490297317505, gen p mean: -0.05497444421052933, mean p set: 0.44734519720077515
loss_pred:0.017184266820549965, decouple_loss:0.0010862242197617888
The modified gen p mean: 0.44602862000465393, gen p mean: -0.055787093937397, mean p set: 0.44650891423225403The modified gen p mean: 0.447712779045105, gen p mean: -0.054002393037080765, mean p set: 0.4481930732727051
loss_pred:0.016244135797023773, decouple_loss:0.0011940384283661842
loss_pred:0.017197804525494576, decouple_loss:0.0011025679996237159
Iteration: 4053, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44696682691574097, gen p mean: -0.05170580372214317, mean p set: 0.44744715094566345
loss_pred:0.017387473955750465, decouple_loss:0.0010713257361203432
The modified gen p mean: 0.4448032081127167, gen p mean: -0.05288871005177498, mean p set: 0.4452835023403168The modified gen p mean: 0.446502685546875, gen p mean: -0.050768088549375534, mean p set: 0.4469830095767975
loss_pred:0.01716269925236702, decouple_loss:0.0010929686250165105
loss_pred:0.01714044250547886, decouple_loss:0.0011044886196032166
Iteration: 4054, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480557441711426, gen p mean: -0.05336039513349533, mean p set: 0.44853606820106506
loss_pred:0.016805374994874, decouple_loss:0.0012724208645522594
The modified gen p mean: 0.44837939739227295, gen p mean: -0.052629850804805756, mean p set: 0.44885969161987305The modified gen p mean: 0.44801080226898193, gen p mean: -0.05373266339302063, mean p set: 0.44849109649658203
loss_pred:0.016721254214644432, decouple_loss:0.00112829334102571
loss_pred:0.01671803928911686, decouple_loss:0.0012018672423437238
Iteration: 4055, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479951858520508, gen p mean: -0.05446058139204979, mean p set: 0.44847550988197327
loss_pred:0.01663711667060852, decouple_loss:0.001195619348436594
The modified gen p mean: 0.4468635320663452, gen p mean: -0.058558933436870575, mean p set: 0.4473438560962677
The modified gen p mean: 0.44717904925346375, gen p mean: -0.052610985934734344, mean p set: 0.44765937328338623
loss_pred:0.016887225210666656, decouple_loss:0.0012755077332258224
loss_pred:0.016168052330613136, decouple_loss:0.0011835324112325907
Iteration: 4056, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473279118537903, gen p mean: -0.053781233727931976, mean p set: 0.44780823588371277
loss_pred:0.016325125470757484, decouple_loss:0.0010822584154084325
The modified gen p mean: 0.4481102526187897, gen p mean: -0.06056971475481987, mean p set: 0.44859054684638977The modified gen p mean: 0.4471152424812317, gen p mean: -0.05878979340195656, mean p set: 0.4475955367088318
loss_pred:0.01696011982858181, decouple_loss:0.0010795393027365208
loss_pred:0.015952885150909424, decouple_loss:0.0010912666330114007
Iteration: 4057, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448246568441391, gen p mean: -0.05766376852989197, mean p set: 0.4487268626689911
loss_pred:0.016597088426351547, decouple_loss:0.001189747010357678
The modified gen p mean: 0.44822704792022705, gen p mean: -0.05553576722741127, mean p set: 0.44870737195014954The modified gen p mean: 0.4474489986896515, gen p mean: -0.05910568684339523, mean p set: 0.4479292929172516
loss_pred:0.016178982332348824, decouple_loss:0.0010871024569496512
loss_pred:0.016450634226202965, decouple_loss:0.001286134123802185
Iteration: 4058, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483972191810608, gen p mean: -0.0638432651758194, mean p set: 0.4488775134086609
loss_pred:0.016709350049495697, decouple_loss:0.0010648738825693727
The modified gen p mean: 0.44804710149765015, gen p mean: -0.059018369764089584, mean p set: 0.44852742552757263The modified gen p mean: 0.44697442650794983, gen p mean: -0.05951031669974327, mean p set: 0.4474547207355499
loss_pred:0.017516816034913063, decouple_loss:0.0011442413087934256
loss_pred:0.016441714018583298, decouple_loss:0.0011523361317813396
Iteration: 4059, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468848705291748, gen p mean: -0.057837530970573425, mean p set: 0.4473651349544525
loss_pred:0.01647014729678631, decouple_loss:0.0012696445919573307
The modified gen p mean: 0.44496357440948486, gen p mean: -0.05516861006617546, mean p set: 0.4454438388347626The modified gen p mean: 0.4477062523365021, gen p mean: -0.05520442873239517, mean p set: 0.4481865465641022
loss_pred:0.016981439664959908, decouple_loss:0.0012870857026427984
loss_pred:0.016213849186897278, decouple_loss:0.0012086452916264534
Iteration: 4060, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44743895530700684, gen p mean: -0.06072421744465828, mean p set: 0.44791924953460693
loss_pred:0.016584528610110283, decouple_loss:0.0011240647872909904
The modified gen p mean: 0.4474976360797882, gen p mean: -0.055836427956819534, mean p set: 0.4479779005050659
The modified gen p mean: 0.44672471284866333, gen p mean: -0.058420173823833466, mean p set: 0.4472050368785858
loss_pred:0.01762501895427704, decouple_loss:0.0010857445886358619
loss_pred:0.01726674474775791, decouple_loss:0.0010862164199352264
2023-05-02 17:57:13 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.06001098081469536, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.05562303215265274, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.05607389286160469, mean p set: 0.4500633478164673
loss_pred:0.018257753923535347, decouple_loss:0.001138018793426454
loss_pred:0.017209947109222412, decouple_loss:0.0010876802261918783
loss_pred:0.01729506254196167, decouple_loss:0.0010784678161144257
WV_0_PC_1_EH_0_PS_40, loss: 0.017642658203840256, avg_mse: 0.025361187756061554
current test mse: 0.025361
Iteration: 4061, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44820907711982727, gen p mean: -0.05423859506845474, mean p set: 0.448689341545105
The modified gen p mean: 0.44729793071746826, gen p mean: -0.05974216386675835, mean p set: 0.44777825474739075
The modified gen p mean: 0.44446447491645813, gen p mean: -0.054830025881528854, mean p set: 0.4449447691440582
loss_pred:0.01734309457242489, decouple_loss:0.0011849642032757401
loss_pred:0.016157910227775574, decouple_loss:0.0011191591620445251
loss_pred:0.017085984349250793, decouple_loss:0.0012236975599080324
Iteration: 4062, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471989572048187, gen p mean: -0.06741607934236526, mean p set: 0.4476792514324188
loss_pred:0.01712730899453163, decouple_loss:0.0010209521278738976
The modified gen p mean: 0.4476768970489502, gen p mean: -0.06082534417510033, mean p set: 0.4481572210788727The modified gen p mean: 0.44742703437805176, gen p mean: -0.0570487417280674, mean p set: 0.44790738821029663
loss_pred:0.016260849311947823, decouple_loss:0.0010121751111000776
loss_pred:0.017416300252079964, decouple_loss:0.0010828266385942698
Iteration: 4063, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44743624329566956, gen p mean: -0.06156930327415466, mean p set: 0.44791650772094727
loss_pred:0.016553614288568497, decouple_loss:0.0011348082916811109
The modified gen p mean: 0.44690123200416565, gen p mean: -0.059732116758823395, mean p set: 0.44738152623176575The modified gen p mean: 0.44554173946380615, gen p mean: -0.06214631721377373, mean p set: 0.44602203369140625
loss_pred:0.017166776582598686, decouple_loss:0.0012033131206408143
loss_pred:0.01692402921617031, decouple_loss:0.0011894726194441319
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012020_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012020_3_24hr.npz
NaN value num: 0
Iteration: 4064, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4526561498641968, gen p mean: -0.047259021550416946, mean p set: 0.4531364440917969
loss_pred:0.017226355150341988, decouple_loss:0.0013510450953617692
The modified gen p mean: 0.4509071409702301, gen p mean: -0.04875321313738823, mean p set: 0.4513874351978302The modified gen p mean: 0.45269808173179626, gen p mean: -0.05344763025641441, mean p set: 0.45317837595939636
loss_pred:0.01667349971830845, decouple_loss:0.0011794501915574074
loss_pred:0.01678602397441864, decouple_loss:0.0013367643114179373
Iteration: 4065, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45261460542678833, gen p mean: -0.058973733335733414, mean p set: 0.4530949294567108
loss_pred:0.016417885199189186, decouple_loss:0.0010160625679418445
The modified gen p mean: 0.45215287804603577, gen p mean: -0.050182245671749115, mean p set: 0.45263317227363586The modified gen p mean: 0.4539163112640381, gen p mean: -0.054856076836586, mean p set: 0.45439663529396057
loss_pred:0.01644975133240223, decouple_loss:0.0010935856262221932
loss_pred:0.01608765311539173, decouple_loss:0.00102019845508039
Iteration: 4066, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45326533913612366, gen p mean: -0.05540240556001663, mean p set: 0.45374566316604614
loss_pred:0.016655711457133293, decouple_loss:0.001238024327903986
The modified gen p mean: 0.4533783793449402, gen p mean: -0.058488182723522186, mean p set: 0.4538586437702179The modified gen p mean: 0.4510023295879364, gen p mean: -0.05380803346633911, mean p set: 0.4514826238155365
loss_pred:0.016292309388518333, decouple_loss:0.0011538233375176787
loss_pred:0.016642913222312927, decouple_loss:0.0012698406353592873
Iteration: 4067, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45294082164764404, gen p mean: -0.056459154933691025, mean p set: 0.45342111587524414
loss_pred:0.015868082642555237, decouple_loss:0.0011782963993027806
The modified gen p mean: 0.4524718225002289, gen p mean: -0.05370159074664116, mean p set: 0.452952116727829The modified gen p mean: 0.4524206519126892, gen p mean: -0.05075014382600784, mean p set: 0.45290088653564453
loss_pred:0.016968075186014175, decouple_loss:0.0011102386051788926
loss_pred:0.01692080684006214, decouple_loss:0.0010921922512352467
Iteration: 4068, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4530980587005615, gen p mean: -0.051111165434122086, mean p set: 0.4535783529281616
loss_pred:0.01609738916158676, decouple_loss:0.0011539002880454063
The modified gen p mean: 0.45306912064552307, gen p mean: -0.05163666233420372, mean p set: 0.4535493850708008The modified gen p mean: 0.45162105560302734, gen p mean: -0.053786229342222214, mean p set: 0.45210132002830505
loss_pred:0.016471074894070625, decouple_loss:0.0011339342454448342
loss_pred:0.016452111303806305, decouple_loss:0.0011420102091506124
Iteration: 4069, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4521391689777374, gen p mean: -0.054158590734004974, mean p set: 0.45261943340301514
loss_pred:0.016657941043376923, decouple_loss:0.0012304141419008374
The modified gen p mean: 0.45152682065963745, gen p mean: -0.048238880932331085, mean p set: 0.45200714468955994The modified gen p mean: 0.45424720644950867, gen p mean: -0.05317790433764458, mean p set: 0.45472750067710876
loss_pred:0.016993489116430283, decouple_loss:0.0011548225302249193
loss_pred:0.01591065526008606, decouple_loss:0.0012044092873111367
Iteration: 4070, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4529957175254822, gen p mean: -0.050269581377506256, mean p set: 0.4534760117530823
loss_pred:0.0162307471036911, decouple_loss:0.0010984116233885288
The modified gen p mean: 0.4520069360733032, gen p mean: -0.04735132306814194, mean p set: 0.4524872601032257The modified gen p mean: 0.45428934693336487, gen p mean: -0.04855804517865181, mean p set: 0.45476964116096497
loss_pred:0.016223305836319923, decouple_loss:0.0010829229140654206
loss_pred:0.016222897917032242, decouple_loss:0.001082127564586699
2023-05-02 17:59:58 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.061577197164297104, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.05692364275455475, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.05742330104112625, mean p set: 0.4500633478164673
loss_pred:0.01834859326481819, decouple_loss:0.001389350974932313
loss_pred:0.01727544330060482, decouple_loss:0.0012372247874736786
loss_pred:0.017402291297912598, decouple_loss:0.0012620777124539018
WV_0_PC_1_EH_0_PS_40, loss: 0.01774025522172451, avg_mse: 0.025515368208289146
current test mse: 0.025515
Iteration: 4071, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4528195261955261, gen p mean: -0.04421494901180267, mean p set: 0.4532998204231262
The modified gen p mean: 0.4522591829299927, gen p mean: -0.0474446676671505, mean p set: 0.4527394771575928
The modified gen p mean: 0.45258280634880066, gen p mean: -0.046072982251644135, mean p set: 0.45306307077407837
loss_pred:0.01632075384259224, decouple_loss:0.0011819526553153992
loss_pred:0.01648375205695629, decouple_loss:0.0011287564411759377
loss_pred:0.016795631498098373, decouple_loss:0.0011174420360475779
Iteration: 4072, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45379146933555603, gen p mean: -0.04949488490819931, mean p set: 0.45427173376083374
loss_pred:0.016236957162618637, decouple_loss:0.0009815440280362964
The modified gen p mean: 0.45358502864837646, gen p mean: -0.0507512167096138, mean p set: 0.45406532287597656The modified gen p mean: 0.4521203637123108, gen p mean: -0.048260919749736786, mean p set: 0.4526006579399109
loss_pred:0.016702186316251755, decouple_loss:0.000970328226685524
loss_pred:0.01605796627700329, decouple_loss:0.0010402568150311708
Iteration: 4073, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4537197947502136, gen p mean: -0.05103018879890442, mean p set: 0.45420005917549133
loss_pred:0.01573561690747738, decouple_loss:0.0010544105898588896
The modified gen p mean: 0.4511502683162689, gen p mean: -0.047450292855501175, mean p set: 0.4516305923461914The modified gen p mean: 0.452735036611557, gen p mean: -0.049991678446531296, mean p set: 0.4532153010368347
loss_pred:0.016978861764073372, decouple_loss:0.0010158836375921965
loss_pred:0.016689561307430267, decouple_loss:0.0010440557962283492
Iteration: 4074, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45212578773498535, gen p mean: -0.048705339431762695, mean p set: 0.45260608196258545
loss_pred:0.01679668016731739, decouple_loss:0.0010513472370803356
The modified gen p mean: 0.45216551423072815, gen p mean: -0.04884253069758415, mean p set: 0.45264583826065063The modified gen p mean: 0.4533141255378723, gen p mean: -0.050590451806783676, mean p set: 0.4537944197654724
loss_pred:0.016158608719706535, decouple_loss:0.001054263673722744
loss_pred:0.016366124153137207, decouple_loss:0.0010248450562357903
Iteration: 4075, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45457717776298523, gen p mean: -0.047997504472732544, mean p set: 0.4550575017929077
loss_pred:0.016382750123739243, decouple_loss:0.0010876960586756468
The modified gen p mean: 0.4526360332965851, gen p mean: -0.050387054681777954, mean p set: 0.4531163275241852
The modified gen p mean: 0.4531184434890747, gen p mean: -0.05289852246642113, mean p set: 0.4535987377166748
loss_pred:0.016227662563323975, decouple_loss:0.001067000674083829
loss_pred:0.015603750944137573, decouple_loss:0.0009806102607399225
Iteration: 4076, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.452199250459671, gen p mean: -0.051980771124362946, mean p set: 0.4526795446872711
loss_pred:0.016551697626709938, decouple_loss:0.001031686319038272
The modified gen p mean: 0.4514142572879791, gen p mean: -0.045537400990724564, mean p set: 0.4518945813179016The modified gen p mean: 0.45377692580223083, gen p mean: -0.048677194863557816, mean p set: 0.45425722002983093
loss_pred:0.016815342009067535, decouple_loss:0.0010601530084386468
loss_pred:0.016132211312651634, decouple_loss:0.0010108033893629909
Iteration: 4077, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.453517884016037, gen p mean: -0.045356038957834244, mean p set: 0.4539981782436371
loss_pred:0.015942227095365524, decouple_loss:0.0010880740592256188
The modified gen p mean: 0.45327383279800415, gen p mean: -0.04969456046819687, mean p set: 0.45375412702560425The modified gen p mean: 0.4537821114063263, gen p mean: -0.046111587435007095, mean p set: 0.4542624056339264
loss_pred:0.015864908695220947, decouple_loss:0.0011585877509787679
loss_pred:0.016822194680571556, decouple_loss:0.0010686126770451665
Iteration: 4078, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45208877325057983, gen p mean: -0.04772122576832771, mean p set: 0.45256906747817993
loss_pred:0.01673012226819992, decouple_loss:0.00097651343094185
The modified gen p mean: 0.45172128081321716, gen p mean: -0.04273243993520737, mean p set: 0.4522015452384949The modified gen p mean: 0.4533019959926605, gen p mean: -0.04275951534509659, mean p set: 0.45378226041793823
loss_pred:0.016648514196276665, decouple_loss:0.0010648119496181607
loss_pred:0.01606639102101326, decouple_loss:0.001041377312503755
Iteration: 4079, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45453307032585144, gen p mean: -0.04066171124577522, mean p set: 0.45501336455345154
loss_pred:0.016040893271565437, decouple_loss:0.0010031608399003744
The modified gen p mean: 0.45392748713493347, gen p mean: -0.0405009426176548, mean p set: 0.45440778136253357The modified gen p mean: 0.452231228351593, gen p mean: -0.04737117886543274, mean p set: 0.4527115225791931
loss_pred:0.01615309901535511, decouple_loss:0.0010792185785248876
loss_pred:0.016040531918406487, decouple_loss:0.0009894734248518944
Iteration: 4080, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45335814356803894, gen p mean: -0.041428789496421814, mean p set: 0.45383843779563904
loss_pred:0.01620040088891983, decouple_loss:0.000977696618065238
The modified gen p mean: 0.4526059329509735, gen p mean: -0.04217756539583206, mean p set: 0.453086256980896The modified gen p mean: 0.45180827379226685, gen p mean: -0.04225381091237068, mean p set: 0.45228859782218933
loss_pred:0.0167576652020216, decouple_loss:0.0010234955698251724
loss_pred:0.016561876982450485, decouple_loss:0.00091562356101349
2023-05-02 18:01:52 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.0528714582324028, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.048743199557065964, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.04904288798570633, mean p set: 0.4500633478164673
loss_pred:0.01834435760974884, decouple_loss:0.0013278282713145018
loss_pred:0.017278414219617844, decouple_loss:0.001146507216617465
loss_pred:0.0174113716930151, decouple_loss:0.0011973398504778743
WV_0_PC_1_EH_0_PS_40, loss: 0.017739243805408478, avg_mse: 0.025524500757455826
current test mse: 0.025524
Iteration: 4081, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4542848467826843, gen p mean: -0.041465844959020615, mean p set: 0.4547651410102844
The modified gen p mean: 0.4537462890148163, gen p mean: -0.0413166843354702, mean p set: 0.4542265832424164
The modified gen p mean: 0.4529549181461334, gen p mean: -0.03846139833331108, mean p set: 0.4534352123737335
loss_pred:0.016680052503943443, decouple_loss:0.0010608843294903636
loss_pred:0.01597573608160019, decouple_loss:0.0010347532806918025
loss_pred:0.016170552000403404, decouple_loss:0.0010342601453885436
Iteration: 4082, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4539887309074402, gen p mean: -0.03944395110011101, mean p set: 0.4544689953327179
loss_pred:0.01598023995757103, decouple_loss:0.001075045089237392
The modified gen p mean: 0.45416200160980225, gen p mean: -0.04307570308446884, mean p set: 0.45464229583740234The modified gen p mean: 0.45353007316589355, gen p mean: -0.041262466460466385, mean p set: 0.45401036739349365
loss_pred:0.015921009704470634, decouple_loss:0.0009984287898987532
loss_pred:0.016055956482887268, decouple_loss:0.0010832945117726922
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012009_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012009_3_24hr.npz
NaN value num: 0
Iteration: 4083, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504079520702362, gen p mean: -0.0475635826587677, mean p set: 0.4508882462978363
loss_pred:0.014612029306590557, decouple_loss:0.0011013778857886791
The modified gen p mean: 0.44910913705825806, gen p mean: -0.049950968474149704, mean p set: 0.44958946108818054The modified gen p mean: 0.44884318113327026, gen p mean: -0.05321107804775238, mean p set: 0.44932347536087036
loss_pred:0.014615802094340324, decouple_loss:0.001104256371036172
loss_pred:0.015151778236031532, decouple_loss:0.0012457899283617735
Iteration: 4084, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44856056571006775, gen p mean: -0.058751799166202545, mean p set: 0.44904085993766785
loss_pred:0.01485526654869318, decouple_loss:0.0009851523209363222
The modified gen p mean: 0.4476395547389984, gen p mean: -0.05600186809897423, mean p set: 0.4481198489665985The modified gen p mean: 0.44850537180900574, gen p mean: -0.05555608123540878, mean p set: 0.44898566603660583
loss_pred:0.014583689160645008, decouple_loss:0.0010441107442602515
loss_pred:0.014641833491623402, decouple_loss:0.0010557154892012477
Iteration: 4085, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480966031551361, gen p mean: -0.052957359701395035, mean p set: 0.4485769271850586
loss_pred:0.014829006046056747, decouple_loss:0.0010384457418695092
The modified gen p mean: 0.4481106400489807, gen p mean: -0.052342530339956284, mean p set: 0.4485909342765808The modified gen p mean: 0.4486571252346039, gen p mean: -0.05830790847539902, mean p set: 0.449137419462204
loss_pred:0.015409963205456734, decouple_loss:0.0012836328241974115
loss_pred:0.01511065848171711, decouple_loss:0.00112420495133847
Iteration: 4086, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477268159389496, gen p mean: -0.05795298516750336, mean p set: 0.44820713996887207
loss_pred:0.01483051385730505, decouple_loss:0.0011934879003092647
The modified gen p mean: 0.44998177886009216, gen p mean: -0.05085740610957146, mean p set: 0.45046207308769226The modified gen p mean: 0.4481092393398285, gen p mean: -0.04689791053533554, mean p set: 0.4485895335674286
loss_pred:0.014322541654109955, decouple_loss:0.0012829340994358063
loss_pred:0.014434105716645718, decouple_loss:0.0011083590798079967
Iteration: 4087, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45015114545822144, gen p mean: -0.051418837159872055, mean p set: 0.45063140988349915
loss_pred:0.014978253282606602, decouple_loss:0.0012580954935401678
The modified gen p mean: 0.44772836565971375, gen p mean: -0.054212916642427444, mean p set: 0.44820865988731384The modified gen p mean: 0.44897758960723877, gen p mean: -0.05545257404446602, mean p set: 0.44945788383483887
loss_pred:0.014057946391403675, decouple_loss:0.0011968215694651008
loss_pred:0.01499185711145401, decouple_loss:0.0013694388326257467
Iteration: 4088, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44952392578125, gen p mean: -0.05623484402894974, mean p set: 0.4500042200088501
loss_pred:0.014299937523901463, decouple_loss:0.0012673522578552365
The modified gen p mean: 0.44854825735092163, gen p mean: -0.05431836098432541, mean p set: 0.44902855157852173The modified gen p mean: 0.4483877718448639, gen p mean: -0.058921024203300476, mean p set: 0.4488680362701416
loss_pred:0.014565788209438324, decouple_loss:0.001225337153300643
loss_pred:0.014386222697794437, decouple_loss:0.0012252472806721926
Iteration: 4089, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44813576340675354, gen p mean: -0.05189858004450798, mean p set: 0.44861605763435364
loss_pred:0.014698483049869537, decouple_loss:0.001122252899222076
The modified gen p mean: 0.4472452998161316, gen p mean: -0.05091734975576401, mean p set: 0.4477255642414093The modified gen p mean: 0.44738608598709106, gen p mean: -0.0558774396777153, mean p set: 0.4478663504123688
loss_pred:0.01446411944925785, decouple_loss:0.0010792730608955026
loss_pred:0.014059367589652538, decouple_loss:0.0013073993613943458
Iteration: 4090, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490791857242584, gen p mean: -0.05123778432607651, mean p set: 0.4495595097541809
loss_pred:0.014136004261672497, decouple_loss:0.00125487195327878
The modified gen p mean: 0.4484004080295563, gen p mean: -0.043486643582582474, mean p set: 0.44888070225715637
The modified gen p mean: 0.4499039351940155, gen p mean: -0.04963790625333786, mean p set: 0.4503842294216156
loss_pred:0.014144598506391048, decouple_loss:0.0011231855023652315
loss_pred:0.014758401550352573, decouple_loss:0.001180725870653987
2023-05-02 18:04:24 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.0506422258913517, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04668673500418663, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.047164034098386765, mean p set: 0.4500633478164673
loss_pred:0.0190286748111248, decouple_loss:0.0012475112453103065
loss_pred:0.01788279600441456, decouple_loss:0.001180384075269103
loss_pred:0.01794941909611225, decouple_loss:0.0011980689596384764
WV_0_PC_1_EH_0_PS_40, loss: 0.018347395583987236, avg_mse: 0.026678988710045815
current test mse: 0.026679
Iteration: 4091, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497900903224945, gen p mean: -0.048428043723106384, mean p set: 0.4502703547477722
The modified gen p mean: 0.4494730234146118, gen p mean: -0.04460037872195244, mean p set: 0.4499533474445343
The modified gen p mean: 0.4464895725250244, gen p mean: -0.05126350745558739, mean p set: 0.4469698667526245
loss_pred:0.014436827972531319, decouple_loss:0.001209863694384694
loss_pred:0.01461736485362053, decouple_loss:0.0011729683028534055
loss_pred:0.014170085079967976, decouple_loss:0.001179669052362442
Iteration: 4092, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44935810565948486, gen p mean: -0.05080157145857811, mean p set: 0.44983842968940735
loss_pred:0.014827582985162735, decouple_loss:0.001108116121031344
The modified gen p mean: 0.44796690344810486, gen p mean: -0.043472710996866226, mean p set: 0.44844722747802734The modified gen p mean: 0.4491191506385803, gen p mean: -0.05108653008937836, mean p set: 0.4495994448661804
loss_pred:0.014479994773864746, decouple_loss:0.001097200089134276
loss_pred:0.014377451501786709, decouple_loss:0.0011640348238870502
Iteration: 4093, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478866457939148, gen p mean: -0.043207425624132156, mean p set: 0.4483669102191925
loss_pred:0.014194592833518982, decouple_loss:0.0010965591063722968
The modified gen p mean: 0.4493604004383087, gen p mean: -0.04444054886698723, mean p set: 0.4498407244682312The modified gen p mean: 0.44662219285964966, gen p mean: -0.049290385097265244, mean p set: 0.44710251688957214
loss_pred:0.014102715998888016, decouple_loss:0.0011108515318483114
loss_pred:0.014092263765633106, decouple_loss:0.001202612416818738
Iteration: 4094, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501529335975647, gen p mean: -0.042397525161504745, mean p set: 0.4506332576274872
loss_pred:0.013831039890646935, decouple_loss:0.0013250047340989113
The modified gen p mean: 0.4491627514362335, gen p mean: -0.04607127979397774, mean p set: 0.44964301586151123
The modified gen p mean: 0.4491323232650757, gen p mean: -0.045898258686065674, mean p set: 0.4496126174926758
loss_pred:0.014612219296395779, decouple_loss:0.0012629705015569925
loss_pred:0.013786598108708858, decouple_loss:0.0012641077628359199
Iteration: 4095, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44880861043930054, gen p mean: -0.04859376326203346, mean p set: 0.449288934469223
loss_pred:0.014449949376285076, decouple_loss:0.0012706418056041002
The modified gen p mean: 0.44981876015663147, gen p mean: -0.04524798318743706, mean p set: 0.45029905438423157The modified gen p mean: 0.4487565755844116, gen p mean: -0.04095115885138512, mean p set: 0.4492368996143341
loss_pred:0.014052662998437881, decouple_loss:0.0011825626716017723
loss_pred:0.014311020262539387, decouple_loss:0.0012317554792389274
Iteration: 4096, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448865681886673, gen p mean: -0.04962854087352753, mean p set: 0.4493459463119507
loss_pred:0.01414516568183899, decouple_loss:0.001222460763528943
The modified gen p mean: 0.4478687345981598, gen p mean: -0.04611677676439285, mean p set: 0.4483490288257599The modified gen p mean: 0.44974711537361145, gen p mean: -0.04535755142569542, mean p set: 0.45022737979888916
loss_pred:0.014504917897284031, decouple_loss:0.0012264717370271683
loss_pred:0.014488277025520802, decouple_loss:0.0013559618964791298
Iteration: 4097, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44852960109710693, gen p mean: -0.04430820420384407, mean p set: 0.44900989532470703
loss_pred:0.014462806284427643, decouple_loss:0.0011811215663328767
The modified gen p mean: 0.44882893562316895, gen p mean: -0.04992184415459633, mean p set: 0.44930922985076904The modified gen p mean: 0.4495813846588135, gen p mean: -0.0492468923330307, mean p set: 0.4500616788864136
loss_pred:0.014435562305152416, decouple_loss:0.0011711103143170476
loss_pred:0.014204108156263828, decouple_loss:0.0011743063805624843
Iteration: 4098, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494432210922241, gen p mean: -0.04128537327051163, mean p set: 0.4499235153198242
loss_pred:0.014338238164782524, decouple_loss:0.0012616204330697656
The modified gen p mean: 0.4493992328643799, gen p mean: -0.047127362340688705, mean p set: 0.44987955689430237The modified gen p mean: 0.4481542408466339, gen p mean: -0.04541359841823578, mean p set: 0.448634535074234
loss_pred:0.014114420861005783, decouple_loss:0.0013897411990910769
loss_pred:0.014255593530833721, decouple_loss:0.001247867476195097
Iteration: 4099, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44888004660606384, gen p mean: -0.04843867942690849, mean p set: 0.44936034083366394
loss_pred:0.013553584925830364, decouple_loss:0.0012891683727502823
The modified gen p mean: 0.44901955127716064, gen p mean: -0.04691169410943985, mean p set: 0.44949984550476074The modified gen p mean: 0.44789427518844604, gen p mean: -0.04198070988059044, mean p set: 0.44837456941604614
loss_pred:0.013813278637826443, decouple_loss:0.0012553646229207516
loss_pred:0.014338348060846329, decouple_loss:0.0012343056732788682
Iteration: 4100, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487477242946625, gen p mean: -0.049051444977521896, mean p set: 0.4492279887199402
The modified gen p mean: 0.4475764036178589, gen p mean: -0.04499267041683197, mean p set: 0.448056697845459loss_pred:0.01393277570605278, decouple_loss:0.0012735843192785978
The modified gen p mean: 0.44927430152893066, gen p mean: -0.046693019568920135, mean p set: 0.44975459575653076
loss_pred:0.014135544188320637, decouple_loss:0.0011499091051518917
loss_pred:0.013856406323611736, decouple_loss:0.0011781433131545782
2023-05-02 18:06:18 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.051844656467437744, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04752803221344948, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.04800425097346306, mean p set: 0.4500633478164673
loss_pred:0.018989911302924156, decouple_loss:0.001263329992070794
loss_pred:0.017878999933600426, decouple_loss:0.0012911148369312286
loss_pred:0.017954785376787186, decouple_loss:0.001342219882644713
WV_0_PC_1_EH_0_PS_40, loss: 0.01833951100707054, avg_mse: 0.026726452633738518
current test mse: 0.026726
Iteration: 4101, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493882358074188, gen p mean: -0.04741543158888817, mean p set: 0.4498685300350189
The modified gen p mean: 0.4492068290710449, gen p mean: -0.04965456947684288, mean p set: 0.449687123298645
The modified gen p mean: 0.4502018690109253, gen p mean: -0.046069901436567307, mean p set: 0.450682133436203
loss_pred:0.014515791088342667, decouple_loss:0.0012479880824685097
loss_pred:0.014100516214966774, decouple_loss:0.0011838732752949
loss_pred:0.014464057981967926, decouple_loss:0.0012346605071797967
Iteration: 4102, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44869935512542725, gen p mean: -0.051934316754341125, mean p set: 0.44917967915534973
loss_pred:0.013909824192523956, decouple_loss:0.0010688083712011576
The modified gen p mean: 0.4484628736972809, gen p mean: -0.04881482943892479, mean p set: 0.448943167924881The modified gen p mean: 0.4484816789627075, gen p mean: -0.05476368963718414, mean p set: 0.44896194338798523
loss_pred:0.014174574054777622, decouple_loss:0.0011652603279799223
loss_pred:0.014086040668189526, decouple_loss:0.0011312345741316676
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012020_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012020_3_24hr.npz
NaN value num: 0
Iteration: 4103, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45273181796073914, gen p mean: -0.04445435106754303, mean p set: 0.453212171792984
loss_pred:0.016629116609692574, decouple_loss:0.0013125950936228037
The modified gen p mean: 0.4497220814228058, gen p mean: -0.049946267157793045, mean p set: 0.4502023756504059The modified gen p mean: 0.45179077982902527, gen p mean: -0.04682803153991699, mean p set: 0.45227110385894775
loss_pred:0.01643313653767109, decouple_loss:0.0011732496786862612
loss_pred:0.0158435869961977, decouple_loss:0.0011223993496969342
Iteration: 4104, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4525221884250641, gen p mean: -0.041845113039016724, mean p set: 0.4530024528503418
loss_pred:0.01629781164228916, decouple_loss:0.001143643050454557
The modified gen p mean: 0.4513130187988281, gen p mean: -0.043699730187654495, mean p set: 0.4517933130264282The modified gen p mean: 0.45273301005363464, gen p mean: -0.045733023434877396, mean p set: 0.45321333408355713
loss_pred:0.016069486737251282, decouple_loss:0.0012809981126338243
loss_pred:0.01621670462191105, decouple_loss:0.0012267644051462412
Iteration: 4105, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45212918519973755, gen p mean: -0.04080532491207123, mean p set: 0.45260950922966003
loss_pred:0.016894947737455368, decouple_loss:0.0010963651584461331
The modified gen p mean: 0.45109426975250244, gen p mean: -0.042349059134721756, mean p set: 0.45157456398010254The modified gen p mean: 0.45016443729400635, gen p mean: -0.04064043611288071, mean p set: 0.45064473152160645
loss_pred:0.01617855578660965, decouple_loss:0.0012407340109348297
loss_pred:0.016885658726096153, decouple_loss:0.001266026054508984
Iteration: 4106, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4530668556690216, gen p mean: -0.0446825735270977, mean p set: 0.4535471498966217
loss_pred:0.015720371156930923, decouple_loss:0.0011215812992304564
The modified gen p mean: 0.4519554674625397, gen p mean: -0.03681140020489693, mean p set: 0.45243576169013977The modified gen p mean: 0.453113853931427, gen p mean: -0.034672196954488754, mean p set: 0.4535941779613495
loss_pred:0.01648484356701374, decouple_loss:0.0011708089150488377
loss_pred:0.01653408445417881, decouple_loss:0.0010805604979395866
Iteration: 4107, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44984734058380127, gen p mean: -0.03660554811358452, mean p set: 0.45032763481140137
loss_pred:0.01641126535832882, decouple_loss:0.0012882031733170152
The modified gen p mean: 0.45259809494018555, gen p mean: -0.0445755310356617, mean p set: 0.45307838916778564
The modified gen p mean: 0.45107221603393555, gen p mean: -0.04095876216888428, mean p set: 0.45155251026153564
loss_pred:0.015510405413806438, decouple_loss:0.0010946955299004912
loss_pred:0.016325153410434723, decouple_loss:0.0012290962040424347
Iteration: 4108, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45110756158828735, gen p mean: -0.035895977169275284, mean p set: 0.45158782601356506
loss_pred:0.01630420796573162, decouple_loss:0.0011139645939692855
The modified gen p mean: 0.4507010579109192, gen p mean: -0.03446236997842789, mean p set: 0.4511813521385193The modified gen p mean: 0.45236918330192566, gen p mean: -0.03777192533016205, mean p set: 0.45284944772720337
loss_pred:0.016218997538089752, decouple_loss:0.001132461242377758
loss_pred:0.015897423028945923, decouple_loss:0.0012433452066034079
Iteration: 4109, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45204871892929077, gen p mean: -0.029186518862843513, mean p set: 0.4525289833545685
loss_pred:0.016106514260172844, decouple_loss:0.0013354364782571793
The modified gen p mean: 0.45221346616744995, gen p mean: -0.028602294623851776, mean p set: 0.45269373059272766The modified gen p mean: 0.45223894715309143, gen p mean: -0.02953437902033329, mean p set: 0.45271924138069153
loss_pred:0.016051212325692177, decouple_loss:0.0011848738649860024
loss_pred:0.01576194167137146, decouple_loss:0.0012339368695393205
Iteration: 4110, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45063936710357666, gen p mean: -0.03354385867714882, mean p set: 0.45111966133117676
loss_pred:0.016520798206329346, decouple_loss:0.0013466737000271678
The modified gen p mean: 0.4498354196548462, gen p mean: -0.034100405871868134, mean p set: 0.4503157436847687The modified gen p mean: 0.45123711228370667, gen p mean: -0.030884360894560814, mean p set: 0.45171743631362915
loss_pred:0.015995299443602562, decouple_loss:0.0013672101777046919
loss_pred:0.016185594722628593, decouple_loss:0.001209030277095735
2023-05-02 18:08:54 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.041690435260534286, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.0380651131272316, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.03821902349591255, mean p set: 0.4500633478164673
loss_pred:0.01879851333796978, decouple_loss:0.0013316621771082282
loss_pred:0.01770252175629139, decouple_loss:0.0012082953471690416
loss_pred:0.01779695600271225, decouple_loss:0.0011870256857946515
WV_0_PC_1_EH_0_PS_40, loss: 0.01816144771873951, avg_mse: 0.026373157277703285
current test mse: 0.026373
Iteration: 4111, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.451688677072525, gen p mean: -0.029914934188127518, mean p set: 0.4521689713001251
The modified gen p mean: 0.4515971541404724, gen p mean: -0.03747297823429108, mean p set: 0.4520774781703949
The modified gen p mean: 0.44985446333885193, gen p mean: -0.035438623279333115, mean p set: 0.450334757566452
loss_pred:0.016637885943055153, decouple_loss:0.0011729735415428877
loss_pred:0.01601513661444187, decouple_loss:0.0011298704193904996
loss_pred:0.01584341749548912, decouple_loss:0.001144408481195569
Iteration: 4112, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4523659944534302, gen p mean: -0.03538160026073456, mean p set: 0.45284631848335266
loss_pred:0.01581236906349659, decouple_loss:0.001184389810077846
The modified gen p mean: 0.45337700843811035, gen p mean: -0.035291966050863266, mean p set: 0.45385733246803284The modified gen p mean: 0.45037195086479187, gen p mean: -0.04030466452240944, mean p set: 0.4508522152900696
loss_pred:0.01634780690073967, decouple_loss:0.001170364790596068
loss_pred:0.01636221818625927, decouple_loss:0.001094209379516542
Iteration: 4113, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4525023102760315, gen p mean: -0.037366073578596115, mean p set: 0.4529826045036316
loss_pred:0.01594364270567894, decouple_loss:0.0012835572706535459
The modified gen p mean: 0.45230579376220703, gen p mean: -0.034732166677713394, mean p set: 0.45278608798980713The modified gen p mean: 0.45134252309799194, gen p mean: -0.039611440151929855, mean p set: 0.45182281732559204
loss_pred:0.01699492149055004, decouple_loss:0.0013942723162472248
loss_pred:0.01622399315237999, decouple_loss:0.0012086336500942707
Iteration: 4114, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498312473297119, gen p mean: -0.04761673882603645, mean p set: 0.4503115713596344
loss_pred:0.015829332172870636, decouple_loss:0.0011640621814876795
The modified gen p mean: 0.4526446461677551, gen p mean: -0.040943827480077744, mean p set: 0.4531249403953552The modified gen p mean: 0.4519249200820923, gen p mean: -0.04858195781707764, mean p set: 0.45240524411201477
loss_pred:0.016077816486358643, decouple_loss:0.001294902991503477
loss_pred:0.015506149269640446, decouple_loss:0.0012393182842060924
Iteration: 4115, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502890110015869, gen p mean: -0.04537578672170639, mean p set: 0.450769305229187
loss_pred:0.015592744573950768, decouple_loss:0.0012069456279277802
The modified gen p mean: 0.4519454538822174, gen p mean: -0.03877362608909607, mean p set: 0.4524257183074951
The modified gen p mean: 0.4518081247806549, gen p mean: -0.045414410531520844, mean p set: 0.4522883892059326
loss_pred:0.01572270318865776, decouple_loss:0.0011328085092827678
loss_pred:0.016613775864243507, decouple_loss:0.0011392809683457017
Iteration: 4116, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45018839836120605, gen p mean: -0.045612189918756485, mean p set: 0.45066869258880615
loss_pred:0.016705356538295746, decouple_loss:0.0011115109082311392
The modified gen p mean: 0.4503428041934967, gen p mean: -0.04411132261157036, mean p set: 0.4508230984210968The modified gen p mean: 0.44991931319236755, gen p mean: -0.043781183660030365, mean p set: 0.45039960741996765
loss_pred:0.016556616872549057, decouple_loss:0.0012334310449659824
loss_pred:0.016402557492256165, decouple_loss:0.0012852340005338192
Iteration: 4117, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513815939426422, gen p mean: -0.037992242723703384, mean p set: 0.4518618583679199
loss_pred:0.01603047549724579, decouple_loss:0.0011876330245286226
The modified gen p mean: 0.45281991362571716, gen p mean: -0.0431697815656662, mean p set: 0.4533001780509949The modified gen p mean: 0.4506247639656067, gen p mean: -0.04545435309410095, mean p set: 0.4511050879955292
loss_pred:0.016134927049279213, decouple_loss:0.0011273573618382215
loss_pred:0.016462236642837524, decouple_loss:0.0010108496062457561
Iteration: 4118, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4516649544239044, gen p mean: -0.038667917251586914, mean p set: 0.4521452486515045
loss_pred:0.01589231565594673, decouple_loss:0.0011027352884411812
The modified gen p mean: 0.4511301815509796, gen p mean: -0.04664262756705284, mean p set: 0.4516104459762573The modified gen p mean: 0.4530556797981262, gen p mean: -0.041581034660339355, mean p set: 0.4535359740257263
loss_pred:0.01606995426118374, decouple_loss:0.0011546898167580366
loss_pred:0.016145361587405205, decouple_loss:0.0013264634180814028
Iteration: 4119, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4515398442745209, gen p mean: -0.036579929292201996, mean p set: 0.4520201086997986
loss_pred:0.01565084233880043, decouple_loss:0.001052333740517497
The modified gen p mean: 0.45097616314888, gen p mean: -0.037101663649082184, mean p set: 0.4514564573764801The modified gen p mean: 0.45186764001846313, gen p mean: -0.041709136217832565, mean p set: 0.45234790444374084
loss_pred:0.015846101567149162, decouple_loss:0.0009749101591296494
loss_pred:0.01602088287472725, decouple_loss:0.0010041773784905672
Iteration: 4120, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4516293406486511, gen p mean: -0.03655141964554787, mean p set: 0.45210960507392883
loss_pred:0.015311653725802898, decouple_loss:0.0011835194891318679
The modified gen p mean: 0.4530324935913086, gen p mean: -0.03574031963944435, mean p set: 0.4535127878189087The modified gen p mean: 0.45154711604118347, gen p mean: -0.03529278561472893, mean p set: 0.45202744007110596
loss_pred:0.01654300093650818, decouple_loss:0.0012014241656288505
loss_pred:0.01589827984571457, decouple_loss:0.0012519562151283026
2023-05-02 18:10:48 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.04759613424539566, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.043947380036115646, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04390344023704529, mean p set: 0.4500633478164673
loss_pred:0.018759386613965034, decouple_loss:0.0015280122170224786
loss_pred:0.017646271735429764, decouple_loss:0.001287740422412753
loss_pred:0.017809884622693062, decouple_loss:0.0013306461041793227
WV_0_PC_1_EH_0_PS_40, loss: 0.01814095489680767, avg_mse: 0.02633856236934662
current test mse: 0.026339
Iteration: 4121, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45213136076927185, gen p mean: -0.036458346992731094, mean p set: 0.45261165499687195
The modified gen p mean: 0.4491223692893982, gen p mean: -0.03905424848198891, mean p set: 0.4496026933193207
The modified gen p mean: 0.45240479707717896, gen p mean: -0.033630259335041046, mean p set: 0.45288509130477905
loss_pred:0.015382031910121441, decouple_loss:0.0011641167802736163
loss_pred:0.01514949556440115, decouple_loss:0.0011823365930467844
loss_pred:0.016627829521894455, decouple_loss:0.0013863464118912816
Iteration: 4122, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4524232745170593, gen p mean: -0.03613346442580223, mean p set: 0.4529035687446594
loss_pred:0.016438215970993042, decouple_loss:0.0010309565113857388
The modified gen p mean: 0.4520719647407532, gen p mean: -0.03463069722056389, mean p set: 0.45255225896835327The modified gen p mean: 0.45225995779037476, gen p mean: -0.0432543121278286, mean p set: 0.45274025201797485
loss_pred:0.016167039051651955, decouple_loss:0.0012695721816271544
loss_pred:0.015264193527400494, decouple_loss:0.0010028667747974396
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012010_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012010_3_24hr.npz
NaN value num: 0
Iteration: 4123, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482315480709076, gen p mean: -0.04389432072639465, mean p set: 0.4487118422985077
loss_pred:0.01388296578079462, decouple_loss:0.0013498367043212056
The modified gen p mean: 0.44724777340888977, gen p mean: -0.04513823613524437, mean p set: 0.4477280378341675The modified gen p mean: 0.44643402099609375, gen p mean: -0.04690491780638695, mean p set: 0.44691428542137146
loss_pred:0.014288870617747307, decouple_loss:0.0014882110990583897
loss_pred:0.014254086650907993, decouple_loss:0.0012819026596844196
Iteration: 4124, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44768717885017395, gen p mean: -0.04679952561855316, mean p set: 0.44816744327545166
loss_pred:0.014393969438970089, decouple_loss:0.0011606683256104589
The modified gen p mean: 0.4477333128452301, gen p mean: -0.04868375509977341, mean p set: 0.4482135772705078The modified gen p mean: 0.4473015367984772, gen p mean: -0.053091391921043396, mean p set: 0.4477818012237549
loss_pred:0.013962417840957642, decouple_loss:0.0011296423617750406
loss_pred:0.013885091990232468, decouple_loss:0.0011061022523790598
Iteration: 4125, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44836685061454773, gen p mean: -0.05059639364480972, mean p set: 0.44884711503982544
loss_pred:0.014259560965001583, decouple_loss:0.0009866164764389396
The modified gen p mean: 0.44760996103286743, gen p mean: -0.04923995956778526, mean p set: 0.44809025526046753The modified gen p mean: 0.4465268850326538, gen p mean: -0.05391266196966171, mean p set: 0.4470071494579315
loss_pred:0.0138901611790061, decouple_loss:0.0010269113117828965
loss_pred:0.01402344275265932, decouple_loss:0.0012311132159084082
Iteration: 4126, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44736284017562866, gen p mean: -0.051726024597883224, mean p set: 0.44784313440322876
loss_pred:0.014384765177965164, decouple_loss:0.0010483991354703903
The modified gen p mean: 0.4483829140663147, gen p mean: -0.057471226900815964, mean p set: 0.4488631784915924The modified gen p mean: 0.44779470562934875, gen p mean: -0.05475509911775589, mean p set: 0.44827502965927124
loss_pred:0.013954590074717999, decouple_loss:0.001164702815003693
loss_pred:0.014070408418774605, decouple_loss:0.0011337497271597385
Iteration: 4127, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44816112518310547, gen p mean: -0.05202941969037056, mean p set: 0.4486413896083832
loss_pred:0.01336674764752388, decouple_loss:0.0010872920975089073
The modified gen p mean: 0.4480712115764618, gen p mean: -0.058526910841464996, mean p set: 0.4485515058040619The modified gen p mean: 0.4480936527252197, gen p mean: -0.0514257438480854, mean p set: 0.4485739767551422
loss_pred:0.01460258662700653, decouple_loss:0.0010981158120557666
loss_pred:0.013827817514538765, decouple_loss:0.001122901332564652
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 4128, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44840723276138306, gen p mean: -0.052458763122558594, mean p set: 0.44888749718666077
loss_pred:0.013354957103729248, decouple_loss:0.0010298746638000011
The modified gen p mean: 0.4477154016494751, gen p mean: -0.0518680065870285, mean p set: 0.4481956660747528The modified gen p mean: 0.44717881083488464, gen p mean: -0.05219940096139908, mean p set: 0.44765913486480713
loss_pred:0.013930057175457478, decouple_loss:0.0011047475272789598
loss_pred:0.0140504390001297, decouple_loss:0.0010790539672598243
Iteration: 4129, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44761788845062256, gen p mean: -0.04853527992963791, mean p set: 0.44809815287590027
loss_pred:0.013492362573742867, decouple_loss:0.0010382187319919467
The modified gen p mean: 0.44754183292388916, gen p mean: -0.05349009856581688, mean p set: 0.44802215695381165The modified gen p mean: 0.44604799151420593, gen p mean: -0.055508874356746674, mean p set: 0.4465283155441284
loss_pred:0.013599799014627934, decouple_loss:0.0010448381071910262
loss_pred:0.014114520512521267, decouple_loss:0.0013637796510010958
Iteration: 4130, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44749799370765686, gen p mean: -0.05089787021279335, mean p set: 0.44797828793525696
loss_pred:0.014265645295381546, decouple_loss:0.001038735848851502
The modified gen p mean: 0.4462707042694092, gen p mean: -0.05471164360642433, mean p set: 0.4467509686946869The modified gen p mean: 0.4484720230102539, gen p mean: -0.046242307871580124, mean p set: 0.448952317237854
loss_pred:0.013830463401973248, decouple_loss:0.0011060588294640183
loss_pred:0.01384791824966669, decouple_loss:0.0012105358764529228
2023-05-02 18:13:28 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.05378780886530876, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.050161294639110565, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.050111666321754456, mean p set: 0.4500633478164673
loss_pred:0.018857169896364212, decouple_loss:0.001359209418296814
loss_pred:0.01787189207971096, decouple_loss:0.0012585491640493274
loss_pred:0.017751483246684074, decouple_loss:0.001327323610894382
WV_0_PC_1_EH_0_PS_40, loss: 0.018225934356451035, avg_mse: 0.02652338519692421
current test mse: 0.026523
Iteration: 4131, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44764435291290283, gen p mean: -0.054634299129247665, mean p set: 0.44812464714050293
The modified gen p mean: 0.44676148891448975, gen p mean: -0.05085398629307747, mean p set: 0.44724181294441223
The modified gen p mean: 0.4474668502807617, gen p mean: -0.05359891802072525, mean p set: 0.4479471743106842
loss_pred:0.014057505875825882, decouple_loss:0.001323560019955039
loss_pred:0.01402725838124752, decouple_loss:0.001433111377991736
loss_pred:0.013486912474036217, decouple_loss:0.0012538866139948368
Iteration: 4132, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479878842830658, gen p mean: -0.054071322083473206, mean p set: 0.4484681785106659
loss_pred:0.014045193791389465, decouple_loss:0.0011518433457240462
The modified gen p mean: 0.44661808013916016, gen p mean: -0.055396292358636856, mean p set: 0.44709837436676025The modified gen p mean: 0.44793903827667236, gen p mean: -0.05232346057891846, mean p set: 0.44841933250427246
loss_pred:0.014057265594601631, decouple_loss:0.0011938477400690317
loss_pred:0.014572792686522007, decouple_loss:0.0009995143627747893
Iteration: 4133, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466010630130768, gen p mean: -0.05442085117101669, mean p set: 0.4470813572406769
loss_pred:0.013701819814741611, decouple_loss:0.0012085895286872983
The modified gen p mean: 0.44788992404937744, gen p mean: -0.05290632322430611, mean p set: 0.44837021827697754The modified gen p mean: 0.4463503658771515, gen p mean: -0.05455519258975983, mean p set: 0.4468306601047516
loss_pred:0.013044911436736584, decouple_loss:0.0013175904750823975
loss_pred:0.013838907703757286, decouple_loss:0.0011419671354815364
Iteration: 4134, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476853609085083, gen p mean: -0.05491548776626587, mean p set: 0.4481656849384308
loss_pred:0.013984081335365772, decouple_loss:0.0012508383952081203
The modified gen p mean: 0.4461391866207123, gen p mean: -0.057282499969005585, mean p set: 0.44661951065063477
The modified gen p mean: 0.4479029178619385, gen p mean: -0.05544845014810562, mean p set: 0.44838324189186096
loss_pred:0.0137061458081007, decouple_loss:0.001225976855494082
loss_pred:0.013889927417039871, decouple_loss:0.0010856344597414136
Iteration: 4135, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447325736284256, gen p mean: -0.06009509414434433, mean p set: 0.4478060305118561
loss_pred:0.013816284947097301, decouple_loss:0.0011188117787241936
The modified gen p mean: 0.44711536169052124, gen p mean: -0.05408591404557228, mean p set: 0.44759562611579895The modified gen p mean: 0.4473322331905365, gen p mean: -0.057260967791080475, mean p set: 0.4478125274181366
loss_pred:0.013494995422661304, decouple_loss:0.0010865663643926382
loss_pred:0.013438391499221325, decouple_loss:0.0010754266986623406
Iteration: 4136, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468335211277008, gen p mean: -0.05683378875255585, mean p set: 0.4473138451576233
loss_pred:0.013971631415188313, decouple_loss:0.0011638058349490166
The modified gen p mean: 0.44755229353904724, gen p mean: -0.051348451524972916, mean p set: 0.44803258776664734The modified gen p mean: 0.4473102390766144, gen p mean: -0.05283233895897865, mean p set: 0.44779056310653687
loss_pred:0.013616641983389854, decouple_loss:0.0011628026841208339
loss_pred:0.013523522764444351, decouple_loss:0.001260322635062039
Iteration: 4137, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478013515472412, gen p mean: -0.04914814233779907, mean p set: 0.4482816159725189
loss_pred:0.013938644900918007, decouple_loss:0.0010003303177654743
The modified gen p mean: 0.4461376368999481, gen p mean: -0.05460463836789131, mean p set: 0.4466179311275482The modified gen p mean: 0.44708606600761414, gen p mean: -0.05586298182606697, mean p set: 0.44756636023521423
loss_pred:0.014397413469851017, decouple_loss:0.0010643461719155312
loss_pred:0.013522863388061523, decouple_loss:0.0011131989303976297
Iteration: 4138, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475243091583252, gen p mean: -0.05828386917710304, mean p set: 0.4480046033859253
loss_pred:0.013404319994151592, decouple_loss:0.0010011385893449187
The modified gen p mean: 0.44749343395233154, gen p mean: -0.05710595101118088, mean p set: 0.44797375798225403The modified gen p mean: 0.44725489616394043, gen p mean: -0.05286301672458649, mean p set: 0.4477352201938629
loss_pred:0.014587527140974998, decouple_loss:0.0010803345357999206
loss_pred:0.014011537656188011, decouple_loss:0.00097808672580868
Iteration: 4139, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44671371579170227, gen p mean: -0.05461015924811363, mean p set: 0.44719401001930237
loss_pred:0.014190617017447948, decouple_loss:0.0011994728120043874
The modified gen p mean: 0.44772443175315857, gen p mean: -0.05882345512509346, mean p set: 0.44820475578308105The modified gen p mean: 0.44809257984161377, gen p mean: -0.05332641303539276, mean p set: 0.4485728442668915
loss_pred:0.014078493230044842, decouple_loss:0.0010694969678297639
loss_pred:0.013730785809457302, decouple_loss:0.0010019575711339712
Iteration: 4140, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44677478075027466, gen p mean: -0.056337811052799225, mean p set: 0.44725507497787476
loss_pred:0.013435025699436665, decouple_loss:0.001066123484633863
The modified gen p mean: 0.44698426127433777, gen p mean: -0.05811634659767151, mean p set: 0.44746458530426025The modified gen p mean: 0.4479389190673828, gen p mean: -0.053519073873758316, mean p set: 0.4484192430973053
loss_pred:0.013620670884847641, decouple_loss:0.0009675396722741425
loss_pred:0.014296026900410652, decouple_loss:0.0009989980608224869
2023-05-02 18:15:23 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.05722770094871521, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.053613316267728806, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.05365557223558426, mean p set: 0.4500633478164673
loss_pred:0.01881992258131504, decouple_loss:0.0012052991660311818
loss_pred:0.01779812015593052, decouple_loss:0.0011295209405943751
loss_pred:0.017871150746941566, decouple_loss:0.0010547665879130363
WV_0_PC_1_EH_0_PS_40, loss: 0.018219558522105217, avg_mse: 0.0265519917011261
current test mse: 0.026552
Iteration: 4141, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44819462299346924, gen p mean: -0.06027429923415184, mean p set: 0.4486749470233917
The modified gen p mean: 0.4472237229347229, gen p mean: -0.05540497601032257, mean p set: 0.4477040469646454
The modified gen p mean: 0.44594743847846985, gen p mean: -0.05871442332863808, mean p set: 0.44642776250839233
loss_pred:0.013386635109782219, decouple_loss:0.0012013745727017522
loss_pred:0.01411302387714386, decouple_loss:0.001252116751857102
loss_pred:0.013597993180155754, decouple_loss:0.0010727813933044672
Iteration: 4142, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44590359926223755, gen p mean: -0.058221910148859024, mean p set: 0.44638389348983765
loss_pred:0.01290981750935316, decouple_loss:0.0010129599831998348
The modified gen p mean: 0.4485853612422943, gen p mean: -0.0522574819624424, mean p set: 0.4490656852722168The modified gen p mean: 0.4472489058971405, gen p mean: -0.056857630610466, mean p set: 0.447729229927063
loss_pred:0.013780797831714153, decouple_loss:0.0010836295550689101
loss_pred:0.013614737428724766, decouple_loss:0.0011829338036477566
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012000_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012000_3_24hr.npz
NaN value num: 0
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 4143, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44644027948379517, gen p mean: -0.05289492383599281, mean p set: 0.44692057371139526
loss_pred:0.013496946543455124, decouple_loss:0.001097202650271356
The modified gen p mean: 0.44670215249061584, gen p mean: -0.058140914887189865, mean p set: 0.44718244671821594The modified gen p mean: 0.4472388029098511, gen p mean: -0.05259238928556442, mean p set: 0.44771912693977356
loss_pred:0.013458692468702793, decouple_loss:0.001087556011043489
loss_pred:0.013195470906794071, decouple_loss:0.001007300685159862
Iteration: 4144, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44546037912368774, gen p mean: -0.050750769674777985, mean p set: 0.44594070315361023
loss_pred:0.013268275186419487, decouple_loss:0.0010880108457058668
The modified gen p mean: 0.44738295674324036, gen p mean: -0.054697345942258835, mean p set: 0.44786328077316284The modified gen p mean: 0.44839704036712646, gen p mean: -0.050698962062597275, mean p set: 0.44887736439704895
loss_pred:0.01351730152964592, decouple_loss:0.0010268272599205375
loss_pred:0.01380909327417612, decouple_loss:0.001016114605590701
Iteration: 4145, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466509521007538, gen p mean: -0.0508745051920414, mean p set: 0.4471312463283539
loss_pred:0.013500325381755829, decouple_loss:0.0010789165971800685
The modified gen p mean: 0.44735249876976013, gen p mean: -0.048685550689697266, mean p set: 0.44783279299736023The modified gen p mean: 0.44916796684265137, gen p mean: -0.04708053544163704, mean p set: 0.44964826107025146
loss_pred:0.013579203747212887, decouple_loss:0.0010436627781018615
loss_pred:0.013519145548343658, decouple_loss:0.0010230191983282566
Iteration: 4146, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469240605831146, gen p mean: -0.05103990063071251, mean p set: 0.44740432500839233
loss_pred:0.013176489621400833, decouple_loss:0.0010670447954908013
The modified gen p mean: 0.4476753771305084, gen p mean: -0.051196400076150894, mean p set: 0.4481556713581085
The modified gen p mean: 0.4466874897480011, gen p mean: -0.04619409143924713, mean p set: 0.4471677839756012
loss_pred:0.013472137972712517, decouple_loss:0.0010466559324413538
loss_pred:0.013336231000721455, decouple_loss:0.0010852445848286152
Iteration: 4147, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465046525001526, gen p mean: -0.047709520906209946, mean p set: 0.4469849467277527
loss_pred:0.013225984759628773, decouple_loss:0.0010155829368159175
The modified gen p mean: 0.4487743079662323, gen p mean: -0.04669737070798874, mean p set: 0.4492546021938324The modified gen p mean: 0.44786253571510315, gen p mean: -0.04648612439632416, mean p set: 0.44834285974502563
loss_pred:0.013221492059528828, decouple_loss:0.0011255430290475488
loss_pred:0.013687850907444954, decouple_loss:0.0011270096292719245
Iteration: 4148, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468916654586792, gen p mean: -0.04854647070169449, mean p set: 0.4473719894886017
loss_pred:0.013855734840035439, decouple_loss:0.0009622328798286617
The modified gen p mean: 0.4470362365245819, gen p mean: -0.04773928225040436, mean p set: 0.447516530752182The modified gen p mean: 0.446512371301651, gen p mean: -0.04851080849766731, mean p set: 0.4469926357269287
loss_pred:0.013757116161286831, decouple_loss:0.0009596296586096287
loss_pred:0.013905146159231663, decouple_loss:0.0009537640726193786
Iteration: 4149, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447671502828598, gen p mean: -0.04766279458999634, mean p set: 0.44815176725387573
loss_pred:0.013010759837925434, decouple_loss:0.0010549614671617746
The modified gen p mean: 0.44701990485191345, gen p mean: -0.04659251868724823, mean p set: 0.44750016927719116The modified gen p mean: 0.44697317481040955, gen p mean: -0.04609354957938194, mean p set: 0.44745346903800964
loss_pred:0.01378306932747364, decouple_loss:0.0010155059862881899
loss_pred:0.014027419500052929, decouple_loss:0.0010837098816409707
Iteration: 4150, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44753342866897583, gen p mean: -0.04440769925713539, mean p set: 0.4480137526988983
loss_pred:0.013416161760687828, decouple_loss:0.0009723476832732558
The modified gen p mean: 0.44844359159469604, gen p mean: -0.042998917400836945, mean p set: 0.44892388582229614The modified gen p mean: 0.44786641001701355, gen p mean: -0.04478458687663078, mean p set: 0.44834670424461365
loss_pred:0.014013061299920082, decouple_loss:0.0009622058132663369
loss_pred:0.013641184195876122, decouple_loss:0.0009976064320653677
2023-05-02 18:17:54 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.04655062407255173, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.042850736528635025, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.04290001839399338, mean p set: 0.4500633478164673
loss_pred:0.018829867243766785, decouple_loss:0.0010146732674911618
loss_pred:0.017692135646939278, decouple_loss:0.0009344556019641459
loss_pred:0.01777014695107937, decouple_loss:0.0008955127559602261
WV_0_PC_1_EH_0_PS_40, loss: 0.018144793808460236, avg_mse: 0.02643042802810669
current test mse: 0.02643
Iteration: 4151, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446135550737381, gen p mean: -0.04450086131691933, mean p set: 0.4466158449649811
The modified gen p mean: 0.4455258548259735, gen p mean: -0.04322940483689308, mean p set: 0.4460061490535736
The modified gen p mean: 0.4473675787448883, gen p mean: -0.04444895684719086, mean p set: 0.4478478729724884
loss_pred:0.013086480088531971, decouple_loss:0.0009430852951481938
loss_pred:0.013033187948167324, decouple_loss:0.000954710238147527
loss_pred:0.01334418822079897, decouple_loss:0.0009426159085705876
Iteration: 4152, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44925034046173096, gen p mean: -0.04404047131538391, mean p set: 0.44973060488700867
loss_pred:0.013228101655840874, decouple_loss:0.001153218443505466
The modified gen p mean: 0.44768601655960083, gen p mean: -0.04839754477143288, mean p set: 0.4481663107872009The modified gen p mean: 0.4458523094654083, gen p mean: -0.047421686351299286, mean p set: 0.4463326036930084
loss_pred:0.01303095929324627, decouple_loss:0.0010381003376096487
loss_pred:0.013737812638282776, decouple_loss:0.001021638629026711
Iteration: 4153, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466387629508972, gen p mean: -0.05234731733798981, mean p set: 0.4471190571784973
loss_pred:0.012876322492957115, decouple_loss:0.0009277088684029877
The modified gen p mean: 0.44717806577682495, gen p mean: -0.047510694712400436, mean p set: 0.44765836000442505The modified gen p mean: 0.4467404782772064, gen p mean: -0.048604074865579605, mean p set: 0.4472208023071289
loss_pred:0.01371950376778841, decouple_loss:0.001049434649758041
loss_pred:0.013213726691901684, decouple_loss:0.001041624927893281
Iteration: 4154, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475764036178589, gen p mean: -0.058343976736068726, mean p set: 0.448056697845459
loss_pred:0.01320518460124731, decouple_loss:0.0012195758754387498
The modified gen p mean: 0.4470798075199127, gen p mean: -0.054229993373155594, mean p set: 0.4475601017475128The modified gen p mean: 0.4468054175376892, gen p mean: -0.056739289313554764, mean p set: 0.4472857117652893
loss_pred:0.013928576372563839, decouple_loss:0.0012617853935807943
loss_pred:0.013178670778870583, decouple_loss:0.001287031453102827
Iteration: 4155, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44641056656837463, gen p mean: -0.05433301627635956, mean p set: 0.4468908905982971
loss_pred:0.013165644370019436, decouple_loss:0.0009857680415734649
The modified gen p mean: 0.44645529985427856, gen p mean: -0.054270483553409576, mean p set: 0.44693562388420105The modified gen p mean: 0.4471035897731781, gen p mean: -0.05866972357034683, mean p set: 0.4475838840007782
loss_pred:0.013198104687035084, decouple_loss:0.0010219970718026161
loss_pred:0.013318807817995548, decouple_loss:0.001001007854938507
Iteration: 4156, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44714266061782837, gen p mean: -0.055097613483667374, mean p set: 0.44762295484542847
loss_pred:0.013187182135879993, decouple_loss:0.0013031308772042394
The modified gen p mean: 0.44633227586746216, gen p mean: -0.05518314614892006, mean p set: 0.44681257009506226The modified gen p mean: 0.44827789068222046, gen p mean: -0.05156441777944565, mean p set: 0.44875821471214294
loss_pred:0.013095950707793236, decouple_loss:0.0011560212587937713
loss_pred:0.013859891332685947, decouple_loss:0.0012039124267175794
Iteration: 4157, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44729194045066833, gen p mean: -0.0549316443502903, mean p set: 0.44777220487594604
loss_pred:0.01313783973455429, decouple_loss:0.0010502053191885352
The modified gen p mean: 0.44739699363708496, gen p mean: -0.05151095986366272, mean p set: 0.44787725806236267The modified gen p mean: 0.4461483657360077, gen p mean: -0.04881000518798828, mean p set: 0.4466286599636078
loss_pred:0.013176488690078259, decouple_loss:0.0010322419693693519
loss_pred:0.013708810321986675, decouple_loss:0.0010437645250931382
Iteration: 4158, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44827088713645935, gen p mean: -0.04862987995147705, mean p set: 0.44875115156173706
loss_pred:0.01387790683656931, decouple_loss:0.0010720767313614488
The modified gen p mean: 0.44737598299980164, gen p mean: -0.04906291887164116, mean p set: 0.44785624742507935The modified gen p mean: 0.44691750407218933, gen p mean: -0.05191676318645477, mean p set: 0.44739779829978943
loss_pred:0.012940256856381893, decouple_loss:0.000959926750510931
loss_pred:0.013130572624504566, decouple_loss:0.000998354284092784
Iteration: 4159, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469894468784332, gen p mean: -0.05130612105131149, mean p set: 0.4474697411060333
loss_pred:0.01306188851594925, decouple_loss:0.000902649771887809
The modified gen p mean: 0.4474863111972809, gen p mean: -0.04825153574347496, mean p set: 0.447966605424881The modified gen p mean: 0.4470297396183014, gen p mean: -0.04606134817004204, mean p set: 0.4475100040435791
loss_pred:0.013183780945837498, decouple_loss:0.0009998652385547757
loss_pred:0.012935806065797806, decouple_loss:0.0009239220526069403
Iteration: 4160, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44655048847198486, gen p mean: -0.05019740015268326, mean p set: 0.44703078269958496
loss_pred:0.013344223611056805, decouple_loss:0.0010856142034754157
The modified gen p mean: 0.44630926847457886, gen p mean: -0.046872589737176895, mean p set: 0.44678959250450134The modified gen p mean: 0.4465515613555908, gen p mean: -0.046704329550266266, mean p set: 0.4470318555831909
loss_pred:0.013067163527011871, decouple_loss:0.0010324749164283276
loss_pred:0.013104822486639023, decouple_loss:0.0009712226456031203
2023-05-02 18:19:48 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.0527079701423645, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04874444752931595, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.048988740891218185, mean p set: 0.4500633478164673
loss_pred:0.018888404592871666, decouple_loss:0.001058100489899516
loss_pred:0.01775483414530754, decouple_loss:0.0009638586780056357
loss_pred:0.017820149660110474, decouple_loss:0.0009258532081730664
WV_0_PC_1_EH_0_PS_40, loss: 0.01820359192788601, avg_mse: 0.02655087597668171
current test mse: 0.026551
Iteration: 4161, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44876816868782043, gen p mean: -0.049359578639268875, mean p set: 0.44924843311309814
The modified gen p mean: 0.44661250710487366, gen p mean: -0.05365569889545441, mean p set: 0.44709280133247375
The modified gen p mean: 0.4480457603931427, gen p mean: -0.050668735057115555, mean p set: 0.4485260546207428
loss_pred:0.01375076174736023, decouple_loss:0.0010093473829329014
loss_pred:0.013394160196185112, decouple_loss:0.0009045852930285037
loss_pred:0.013168818317353725, decouple_loss:0.0008880113600753248
Iteration: 4162, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44815972447395325, gen p mean: -0.04846959188580513, mean p set: 0.44864004850387573
loss_pred:0.013745632953941822, decouple_loss:0.0010000969050452113
The modified gen p mean: 0.44781818985939026, gen p mean: -0.05377533286809921, mean p set: 0.44829845428466797The modified gen p mean: 0.4455268383026123, gen p mean: -0.0523516871035099, mean p set: 0.44600710272789
loss_pred:0.013626093044877052, decouple_loss:0.0009765136637724936
loss_pred:0.012890622019767761, decouple_loss:0.0010147292632609606
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012016_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012016_3_24hr.npz
NaN value num: 0
Iteration: 4163, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502740204334259, gen p mean: -0.04203471168875694, mean p set: 0.450754314661026
loss_pred:0.017111031338572502, decouple_loss:0.0011081867851316929
The modified gen p mean: 0.44944414496421814, gen p mean: -0.04936593398451805, mean p set: 0.44992440938949585
The modified gen p mean: 0.44862550497055054, gen p mean: -0.04527829959988594, mean p set: 0.44910579919815063
loss_pred:0.016845665872097015, decouple_loss:0.0010642483830451965
loss_pred:0.017429230734705925, decouple_loss:0.0010401519248262048
Iteration: 4164, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492329955101013, gen p mean: -0.05221826210618019, mean p set: 0.4497132897377014
The modified gen p mean: 0.4489953815937042, gen p mean: -0.05105104669928551, mean p set: 0.4494756758213043
loss_pred:0.016743119806051254, decouple_loss:0.0011358228512108326
loss_pred:0.016327643766999245, decouple_loss:0.0011343429796397686
The modified gen p mean: 0.4502841830253601, gen p mean: -0.04722796007990837, mean p set: 0.4507644772529602
loss_pred:0.017545344308018684, decouple_loss:0.0010290389182046056
Iteration: 4165, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495059847831726, gen p mean: -0.045897725969552994, mean p set: 0.4499862790107727
loss_pred:0.016957243904471397, decouple_loss:0.0010622547706589103
The modified gen p mean: 0.44985246658325195, gen p mean: -0.048979297280311584, mean p set: 0.45033276081085205The modified gen p mean: 0.4490356743335724, gen p mean: -0.0483463816344738, mean p set: 0.4495159983634949
loss_pred:0.017044739797711372, decouple_loss:0.0010977104539051652
loss_pred:0.01704477332532406, decouple_loss:0.0010147244902327657
Iteration: 4166, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450111985206604, gen p mean: -0.03941156715154648, mean p set: 0.4505922794342041
loss_pred:0.01667047291994095, decouple_loss:0.0010572468163445592
The modified gen p mean: 0.4502299427986145, gen p mean: -0.040803298354148865, mean p set: 0.4507102370262146
The modified gen p mean: 0.4492623209953308, gen p mean: -0.04359804093837738, mean p set: 0.4497425854206085
loss_pred:0.016455193981528282, decouple_loss:0.0011254855198785663
loss_pred:0.016746366396546364, decouple_loss:0.0011291727423667908
Iteration: 4167, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481066167354584, gen p mean: -0.042184293270111084, mean p set: 0.44858694076538086
loss_pred:0.017924023792147636, decouple_loss:0.0010620835237205029
The modified gen p mean: 0.4503733515739441, gen p mean: -0.04360542446374893, mean p set: 0.4508536458015442The modified gen p mean: 0.44984233379364014, gen p mean: -0.038417041301727295, mean p set: 0.45032259821891785
loss_pred:0.016812540590763092, decouple_loss:0.0010138214565813541
loss_pred:0.0169209111481905, decouple_loss:0.0010925953974947333
Iteration: 4168, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44919729232788086, gen p mean: -0.041922494769096375, mean p set: 0.44967761635780334
loss_pred:0.01737249456346035, decouple_loss:0.0011120870476588607
The modified gen p mean: 0.4490235149860382, gen p mean: -0.04624956101179123, mean p set: 0.4495038390159607The modified gen p mean: 0.44992655515670776, gen p mean: -0.039766956120729446, mean p set: 0.45040687918663025
loss_pred:0.01664591021835804, decouple_loss:0.00103272614069283
loss_pred:0.016898933798074722, decouple_loss:0.0010221111588180065
Iteration: 4169, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44958510994911194, gen p mean: -0.04523750767111778, mean p set: 0.4500654339790344
loss_pred:0.016567565500736237, decouple_loss:0.0010191935580223799
The modified gen p mean: 0.4496327340602875, gen p mean: -0.04364260658621788, mean p set: 0.4501130282878876The modified gen p mean: 0.45207497477531433, gen p mean: -0.03906668722629547, mean p set: 0.45255526900291443
loss_pred:0.016701802611351013, decouple_loss:0.0011954851215705276
loss_pred:0.01743515580892563, decouple_loss:0.0010220566764473915
Iteration: 4170, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44864264130592346, gen p mean: -0.045966535806655884, mean p set: 0.44912293553352356
loss_pred:0.017853952944278717, decouple_loss:0.00098100071772933
The modified gen p mean: 0.44964757561683655, gen p mean: -0.046023622155189514, mean p set: 0.45012786984443665The modified gen p mean: 0.4496156871318817, gen p mean: -0.03588661178946495, mean p set: 0.4500959813594818
loss_pred:0.01647121272981167, decouple_loss:0.0010075486497953534
loss_pred:0.017414692789316177, decouple_loss:0.0010600278619676828
2023-05-02 18:22:23 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.049117907881736755, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04537239298224449, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04535515233874321, mean p set: 0.4500633478164673
loss_pred:0.018493223935365677, decouple_loss:0.0011081929551437497
loss_pred:0.01744426228106022, decouple_loss:0.0010115244658663869
loss_pred:0.01754959672689438, decouple_loss:0.001064350246451795
WV_0_PC_1_EH_0_PS_40, loss: 0.017882097512483597, avg_mse: 0.025873595848679543
current test mse: 0.025874
Iteration: 4171, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44959181547164917, gen p mean: -0.03940663859248161, mean p set: 0.45007210969924927
The modified gen p mean: 0.4489772617816925, gen p mean: -0.04030400887131691, mean p set: 0.449457585811615
The modified gen p mean: 0.4502265155315399, gen p mean: -0.04128800705075264, mean p set: 0.45070680975914
loss_pred:0.017155656591057777, decouple_loss:0.0009280932717956603
loss_pred:0.016350068151950836, decouple_loss:0.0009956975700333714
loss_pred:0.017514396458864212, decouple_loss:0.001014875597320497
Iteration: 4172, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498112201690674, gen p mean: -0.043226663023233414, mean p set: 0.4502915143966675
loss_pred:0.01680145598948002, decouple_loss:0.0009537605219520628
The modified gen p mean: 0.4498051404953003, gen p mean: -0.049633633345365524, mean p set: 0.450285404920578The modified gen p mean: 0.44977572560310364, gen p mean: -0.04136907681822777, mean p set: 0.45025599002838135
loss_pred:0.016905495896935463, decouple_loss:0.0010261132847517729
loss_pred:0.01663450337946415, decouple_loss:0.0011862806277349591
Iteration: 4173, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448740154504776, gen p mean: -0.049600616097450256, mean p set: 0.4492204785346985
loss_pred:0.016894493252038956, decouple_loss:0.0009511035750620067
The modified gen p mean: 0.45142218470573425, gen p mean: -0.04622393473982811, mean p set: 0.45190247893333435The modified gen p mean: 0.4493388235569, gen p mean: -0.048103898763656616, mean p set: 0.44981908798217773
loss_pred:0.016605067998170853, decouple_loss:0.000998245901428163
loss_pred:0.01755686104297638, decouple_loss:0.000903826265130192
Iteration: 4174, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44942376017570496, gen p mean: -0.05019177123904228, mean p set: 0.44990405440330505
loss_pred:0.01664411462843418, decouple_loss:0.001010087551549077
The modified gen p mean: 0.44877001643180847, gen p mean: -0.05307784676551819, mean p set: 0.4492502808570862The modified gen p mean: 0.45003122091293335, gen p mean: -0.046258118003606796, mean p set: 0.45051151514053345
loss_pred:0.016608649864792824, decouple_loss:0.0009959695162251592
loss_pred:0.016957538202404976, decouple_loss:0.001131185912527144
Iteration: 4175, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495774507522583, gen p mean: -0.0468159094452858, mean p set: 0.4500577449798584
loss_pred:0.016237927600741386, decouple_loss:0.0010461382335051894
The modified gen p mean: 0.45063337683677673, gen p mean: -0.04604343697428703, mean p set: 0.4511137008666992The modified gen p mean: 0.44940534234046936, gen p mean: -0.041753146797418594, mean p set: 0.44988563656806946
loss_pred:0.016578329727053642, decouple_loss:0.0012243881355971098
loss_pred:0.01640241965651512, decouple_loss:0.001134925871156156
Iteration: 4176, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45172709226608276, gen p mean: -0.04279601573944092, mean p set: 0.45220738649368286
loss_pred:0.016989639028906822, decouple_loss:0.0009322090190835297
The modified gen p mean: 0.44938376545906067, gen p mean: -0.043218184262514114, mean p set: 0.44986405968666077The modified gen p mean: 0.4480375647544861, gen p mean: -0.04718608409166336, mean p set: 0.4485178589820862
loss_pred:0.016959620639681816, decouple_loss:0.000952676055021584
loss_pred:0.0166157316416502, decouple_loss:0.0010099875507876277
Iteration: 4177, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501861035823822, gen p mean: -0.041092801839113235, mean p set: 0.4506663978099823
loss_pred:0.017029624432325363, decouple_loss:0.001023679506033659
The modified gen p mean: 0.44978150725364685, gen p mean: -0.04155812785029411, mean p set: 0.45026183128356934The modified gen p mean: 0.44921568036079407, gen p mean: -0.039667319506406784, mean p set: 0.4496959447860718
loss_pred:0.017263296991586685, decouple_loss:0.0009799094405025244
loss_pred:0.01705607958137989, decouple_loss:0.0010293396189808846
Iteration: 4178, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503208100795746, gen p mean: -0.03965294361114502, mean p set: 0.4508011043071747
loss_pred:0.016764558851718903, decouple_loss:0.0009888497879728675
The modified gen p mean: 0.44968050718307495, gen p mean: -0.04633576050400734, mean p set: 0.45016080141067505The modified gen p mean: 0.44938400387763977, gen p mean: -0.04650503024458885, mean p set: 0.44986429810523987
loss_pred:0.016580872237682343, decouple_loss:0.0010242137359455228
loss_pred:0.01682729460299015, decouple_loss:0.0012015113607048988
Iteration: 4179, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44998836517333984, gen p mean: -0.042390480637550354, mean p set: 0.45046865940093994
loss_pred:0.01686452142894268, decouple_loss:0.0008870175806805491
The modified gen p mean: 0.4490238428115845, gen p mean: -0.04898465797305107, mean p set: 0.44950413703918457
The modified gen p mean: 0.44956380128860474, gen p mean: -0.04610192030668259, mean p set: 0.4500441253185272
loss_pred:0.017662199214100838, decouple_loss:0.0009511862881481647
loss_pred:0.01695011742413044, decouple_loss:0.0009600518387742341
Iteration: 4180, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486215114593506, gen p mean: -0.044398099184036255, mean p set: 0.4491018056869507
loss_pred:0.016957471147179604, decouple_loss:0.0010406790534034371
The modified gen p mean: 0.4505566358566284, gen p mean: -0.039991337805986404, mean p set: 0.4510369300842285The modified gen p mean: 0.4497458040714264, gen p mean: -0.044962480664253235, mean p set: 0.4502260982990265
loss_pred:0.01727624237537384, decouple_loss:0.001146951224654913
loss_pred:0.01707465760409832, decouple_loss:0.0009665252873674035
2023-05-02 18:24:19 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.051066476851701736, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.047386787831783295, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.047298774123191833, mean p set: 0.4500633478164673
loss_pred:0.01845472678542137, decouple_loss:0.0010998124489560723
loss_pred:0.017459258437156677, decouple_loss:0.0012107177171856165
loss_pred:0.017514638602733612, decouple_loss:0.0011712881969287992
WV_0_PC_1_EH_0_PS_40, loss: 0.017867572605609894, avg_mse: 0.02584097906947136
current test mse: 0.025841
Iteration: 4181, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45060786604881287, gen p mean: -0.04599989578127861, mean p set: 0.45108816027641296
The modified gen p mean: 0.4497734308242798, gen p mean: -0.04473022744059563, mean p set: 0.4502537250518799
The modified gen p mean: 0.45044082403182983, gen p mean: -0.04683852940797806, mean p set: 0.45092108845710754
loss_pred:0.017771581187844276, decouple_loss:0.0010685644811019301
loss_pred:0.01628381386399269, decouple_loss:0.0009047985658980906
loss_pred:0.016648847609758377, decouple_loss:0.0009039319702424109
Iteration: 4182, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44960206747055054, gen p mean: -0.040083106607198715, mean p set: 0.45008236169815063
loss_pred:0.017326973378658295, decouple_loss:0.0011224516201764345
The modified gen p mean: 0.4489370584487915, gen p mean: -0.04852903634309769, mean p set: 0.4494173526763916The modified gen p mean: 0.45045432448387146, gen p mean: -0.04326493665575981, mean p set: 0.45093461871147156
loss_pred:0.016861258074641228, decouple_loss:0.0010399348102509975
loss_pred:0.017399374395608902, decouple_loss:0.0010449029505252838
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012010_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012010_3_24hr.npz
NaN value num: 0
Iteration: 4183, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484303593635559, gen p mean: -0.04916916787624359, mean p set: 0.448910653591156
loss_pred:0.013732636347413063, decouple_loss:0.001138154650107026
The modified gen p mean: 0.44775867462158203, gen p mean: -0.051644109189510345, mean p set: 0.4482389986515045The modified gen p mean: 0.44715961813926697, gen p mean: -0.049890246242284775, mean p set: 0.4476398825645447
loss_pred:0.01464746706187725, decouple_loss:0.0011718483874574304
loss_pred:0.01388388592749834, decouple_loss:0.0012692851014435291
Iteration: 4184, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44848939776420593, gen p mean: -0.051148030906915665, mean p set: 0.44896969199180603
loss_pred:0.014415798708796501, decouple_loss:0.0011520655825734138
The modified gen p mean: 0.44746914505958557, gen p mean: -0.05151849612593651, mean p set: 0.44794946908950806The modified gen p mean: 0.4479629397392273, gen p mean: -0.05242194980382919, mean p set: 0.448443204164505
loss_pred:0.014670409262180328, decouple_loss:0.0015911317896097898
loss_pred:0.01410083007067442, decouple_loss:0.0011509417090564966
Iteration: 4185, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480065703392029, gen p mean: -0.048675667494535446, mean p set: 0.448486864566803
loss_pred:0.013892837800085545, decouple_loss:0.0010504546808078885
The modified gen p mean: 0.447181761264801, gen p mean: -0.04860944300889969, mean p set: 0.4476620554924011The modified gen p mean: 0.4467315375804901, gen p mean: -0.05152338370680809, mean p set: 0.4472118318080902
loss_pred:0.01453581266105175, decouple_loss:0.001039068098179996
loss_pred:0.01423189602792263, decouple_loss:0.0011870700400322676
Iteration: 4186, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471721351146698, gen p mean: -0.05534188449382782, mean p set: 0.4476523995399475
loss_pred:0.014331072568893433, decouple_loss:0.0011441173264756799
The modified gen p mean: 0.4465717077255249, gen p mean: -0.0502728633582592, mean p set: 0.4470519721508026The modified gen p mean: 0.4480859935283661, gen p mean: -0.05226002633571625, mean p set: 0.4485662877559662
loss_pred:0.013873006217181683, decouple_loss:0.0012996508739888668
loss_pred:0.01414747815579176, decouple_loss:0.0010636546649038792
Iteration: 4187, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485773742198944, gen p mean: -0.052504852414131165, mean p set: 0.4490576982498169
loss_pred:0.013521000742912292, decouple_loss:0.001054422464221716
The modified gen p mean: 0.4480511248111725, gen p mean: -0.054847609251737595, mean p set: 0.44853144884109497The modified gen p mean: 0.4466698467731476, gen p mean: -0.04591720923781395, mean p set: 0.4471501410007477
loss_pred:0.014139387756586075, decouple_loss:0.001079998561181128
loss_pred:0.013600883074104786, decouple_loss:0.0011140820570290089
Iteration: 4188, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472235441207886, gen p mean: -0.04573451727628708, mean p set: 0.44770386815071106
loss_pred:0.013822467997670174, decouple_loss:0.0011489199241623282
The modified gen p mean: 0.4488455653190613, gen p mean: -0.04537748172879219, mean p set: 0.449325829744339The modified gen p mean: 0.446898490190506, gen p mean: -0.04528895765542984, mean p set: 0.4473787844181061
loss_pred:0.013356375508010387, decouple_loss:0.0011059143580496311
loss_pred:0.014342940412461758, decouple_loss:0.00128315226174891
Iteration: 4189, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481261670589447, gen p mean: -0.04628961533308029, mean p set: 0.4486064314842224
loss_pred:0.013732325285673141, decouple_loss:0.001019342802464962
The modified gen p mean: 0.44812914729118347, gen p mean: -0.045725129544734955, mean p set: 0.44860947132110596The modified gen p mean: 0.4480394124984741, gen p mean: -0.046918757259845734, mean p set: 0.4485197067260742
loss_pred:0.013777324929833412, decouple_loss:0.0010130904847756028
loss_pred:0.013589495792984962, decouple_loss:0.0010687151225283742
Iteration: 4190, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44821107387542725, gen p mean: -0.04338008537888527, mean p set: 0.44869139790534973
loss_pred:0.01364635769277811, decouple_loss:0.0010714291129261255
The modified gen p mean: 0.4473575949668884, gen p mean: -0.0430084690451622, mean p set: 0.4478378891944885The modified gen p mean: 0.446647047996521, gen p mean: -0.04786130040884018, mean p set: 0.4471273422241211
loss_pred:0.014338456094264984, decouple_loss:0.0011194911785423756
loss_pred:0.013456129468977451, decouple_loss:0.0010917517356574535
2023-05-02 18:26:50 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.044483888894319534, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04090406000614166, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04105167090892792, mean p set: 0.4500633478164673
loss_pred:0.018965329974889755, decouple_loss:0.0011188986245542765
loss_pred:0.017845435068011284, decouple_loss:0.0010790737578645349
loss_pred:0.017928069457411766, decouple_loss:0.0011400774819776416
WV_0_PC_1_EH_0_PS_40, loss: 0.018301911652088165, avg_mse: 0.026664860546588898
current test mse: 0.026665
Iteration: 4191, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469960927963257, gen p mean: -0.03948511555790901, mean p set: 0.4474763870239258
The modified gen p mean: 0.44917982816696167, gen p mean: -0.038203079253435135, mean p set: 0.44966015219688416
The modified gen p mean: 0.4478238523006439, gen p mean: -0.04406338557600975, mean p set: 0.448304146528244
loss_pred:0.013899097219109535, decouple_loss:0.0011102829594165087
loss_pred:0.01416478119790554, decouple_loss:0.0010168221779167652
loss_pred:0.013681014068424702, decouple_loss:0.001278379582799971
Iteration: 4192, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479084014892578, gen p mean: -0.04717903211712837, mean p set: 0.4483886957168579
The modified gen p mean: 0.4472236633300781, gen p mean: -0.04324808716773987, mean p set: 0.4477039873600006
loss_pred:0.013879033736884594, decouple_loss:0.0010773891117423773
loss_pred:0.013455985113978386, decouple_loss:0.0012161502381786704
The modified gen p mean: 0.447144091129303, gen p mean: -0.04248606413602829, mean p set: 0.44762441515922546
loss_pred:0.014067833311855793, decouple_loss:0.001155149657279253
Iteration: 4193, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447517991065979, gen p mean: -0.04201006144285202, mean p set: 0.4479982852935791
loss_pred:0.013443438336253166, decouple_loss:0.0012449793284758925
The modified gen p mean: 0.4469422698020935, gen p mean: -0.040679965168237686, mean p set: 0.447422593832016The modified gen p mean: 0.44840559363365173, gen p mean: -0.04099573567509651, mean p set: 0.44888588786125183
loss_pred:0.013715198263525963, decouple_loss:0.0012336095096543431
loss_pred:0.01382414810359478, decouple_loss:0.0010308397468179464
Iteration: 4194, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489342272281647, gen p mean: -0.04375560209155083, mean p set: 0.44941452145576477
loss_pred:0.01394734252244234, decouple_loss:0.0011995409149676561
The modified gen p mean: 0.4477115571498871, gen p mean: -0.044227294623851776, mean p set: 0.4481918513774872The modified gen p mean: 0.44832539558410645, gen p mean: -0.04955001920461655, mean p set: 0.44880568981170654
loss_pred:0.013603690080344677, decouple_loss:0.0012036715634167194
loss_pred:0.013675857335329056, decouple_loss:0.0010550838196650147
Iteration: 4195, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44741079211235046, gen p mean: -0.05043743923306465, mean p set: 0.44789108633995056
loss_pred:0.014189344830811024, decouple_loss:0.0013054398586973548
The modified gen p mean: 0.4476369321346283, gen p mean: -0.050608936697244644, mean p set: 0.4481172263622284The modified gen p mean: 0.4486684501171112, gen p mean: -0.04844018444418907, mean p set: 0.4491487443447113
loss_pred:0.013463424518704414, decouple_loss:0.0010164526756852865
loss_pred:0.013839833438396454, decouple_loss:0.0010703447042033076
Iteration: 4196, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44849157333374023, gen p mean: -0.04754633828997612, mean p set: 0.44897186756134033
loss_pred:0.013917941600084305, decouple_loss:0.0011649318039417267
The modified gen p mean: 0.4464516043663025, gen p mean: -0.05058379843831062, mean p set: 0.4469318985939026The modified gen p mean: 0.4472044110298157, gen p mean: -0.0490126758813858, mean p set: 0.44768473505973816
loss_pred:0.014366631396114826, decouple_loss:0.0012599577894434333
loss_pred:0.01424616388976574, decouple_loss:0.001288635772652924
Iteration: 4197, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44711408019065857, gen p mean: -0.049617279320955276, mean p set: 0.44759440422058105
loss_pred:0.013747647404670715, decouple_loss:0.0012614423176273704
The modified gen p mean: 0.4472287595272064, gen p mean: -0.04581790044903755, mean p set: 0.4477090537548065The modified gen p mean: 0.44782301783561707, gen p mean: -0.04821150749921799, mean p set: 0.44830334186553955
loss_pred:0.013559327460825443, decouple_loss:0.001255482668057084
loss_pred:0.014030049555003643, decouple_loss:0.0013321982696652412
Iteration: 4198, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44735005497932434, gen p mean: -0.05118981748819351, mean p set: 0.44783034920692444
loss_pred:0.0139244943857193, decouple_loss:0.0012937041465193033
The modified gen p mean: 0.44689860939979553, gen p mean: -0.05010725557804108, mean p set: 0.44737890362739563The modified gen p mean: 0.44782400131225586, gen p mean: -0.046781137585639954, mean p set: 0.44830429553985596
loss_pred:0.013349591754376888, decouple_loss:0.0012205620296299458
loss_pred:0.014005642384290695, decouple_loss:0.0012423665029928088
Iteration: 4199, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482623338699341, gen p mean: -0.05265780910849571, mean p set: 0.4487426280975342
loss_pred:0.013627400621771812, decouple_loss:0.0011268521193414927
The modified gen p mean: 0.4472768306732178, gen p mean: -0.045322950929403305, mean p set: 0.4477570950984955The modified gen p mean: 0.4477773904800415, gen p mean: -0.04596232250332832, mean p set: 0.4482576549053192
loss_pred:0.01419232040643692, decouple_loss:0.001342865638434887
loss_pred:0.014026528224349022, decouple_loss:0.00119006575550884
Iteration: 4200, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476015865802765, gen p mean: -0.04804063215851784, mean p set: 0.448081910610199
loss_pred:0.01413758285343647, decouple_loss:0.0011915141949430108
The modified gen p mean: 0.4487683176994324, gen p mean: -0.04600776731967926, mean p set: 0.44924864172935486The modified gen p mean: 0.44710665941238403, gen p mean: -0.05337798222899437, mean p set: 0.44758692383766174
loss_pred:0.013230265118181705, decouple_loss:0.0011507614981383085
loss_pred:0.014058738015592098, decouple_loss:0.0012588826939463615
2023-05-02 18:28:43 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.048022009432315826, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04426809772849083, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.0443696454167366, mean p set: 0.4500633478164673
loss_pred:0.01892039366066456, decouple_loss:0.0011616068659350276
loss_pred:0.017952928319573402, decouple_loss:0.0011174954706802964
loss_pred:0.017856920138001442, decouple_loss:0.0011054652277380228
WV_0_PC_1_EH_0_PS_40, loss: 0.018299825489521027, avg_mse: 0.026698118075728416
current test mse: 0.026698
Iteration: 4201, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468585252761841, gen p mean: -0.049377698451280594, mean p set: 0.4473388195037842
The modified gen p mean: 0.44812214374542236, gen p mean: -0.04736223444342613, mean p set: 0.4486024081707001
The modified gen p mean: 0.44752365350723267, gen p mean: -0.04980191960930824, mean p set: 0.44800394773483276
loss_pred:0.013890547677874565, decouple_loss:0.0011213156394660473
loss_pred:0.013451269827783108, decouple_loss:0.001149446819908917
loss_pred:0.013638997450470924, decouple_loss:0.0011013400508090854
Iteration: 4202, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44818034768104553, gen p mean: -0.042733654379844666, mean p set: 0.44866064190864563
loss_pred:0.014017751440405846, decouple_loss:0.001214928925037384
The modified gen p mean: 0.4472211003303528, gen p mean: -0.051409244537353516, mean p set: 0.4477013349533081The modified gen p mean: 0.4475215673446655, gen p mean: -0.04468652233481407, mean p set: 0.44800183176994324
loss_pred:0.013807018287479877, decouple_loss:0.001082892995327711
loss_pred:0.013957088813185692, decouple_loss:0.001071274746209383
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012009_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012009_3_24hr.npz
NaN value num: 0
Iteration: 4203, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44982996582984924, gen p mean: -0.04340004175901413, mean p set: 0.45031026005744934
loss_pred:0.013975230976939201, decouple_loss:0.0011422174284234643
The modified gen p mean: 0.4478175938129425, gen p mean: -0.0431332029402256, mean p set: 0.4482978880405426The modified gen p mean: 0.44688746333122253, gen p mean: -0.04173025116324425, mean p set: 0.44736772775650024
loss_pred:0.01409957930445671, decouple_loss:0.001281023258343339
loss_pred:0.013736537657678127, decouple_loss:0.0011390259023755789
Iteration: 4204, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44697925448417664, gen p mean: -0.04802975431084633, mean p set: 0.44745954871177673
loss_pred:0.013875192031264305, decouple_loss:0.0011214240221306682
The modified gen p mean: 0.44930770993232727, gen p mean: -0.04560809209942818, mean p set: 0.449787974357605The modified gen p mean: 0.4468348026275635, gen p mean: -0.04449164494872093, mean p set: 0.4473150670528412
loss_pred:0.013772044330835342, decouple_loss:0.0010824700584635139
loss_pred:0.014033501967787743, decouple_loss:0.0011168398195877671
Iteration: 4205, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4461551308631897, gen p mean: -0.0515332855284214, mean p set: 0.4466353952884674
loss_pred:0.014145348221063614, decouple_loss:0.0012592304265126586
The modified gen p mean: 0.4487951695919037, gen p mean: -0.04335181042551994, mean p set: 0.4492754638195038The modified gen p mean: 0.4478420615196228, gen p mean: -0.045448269695043564, mean p set: 0.4483223557472229
loss_pred:0.013879242353141308, decouple_loss:0.0011462634429335594
loss_pred:0.013911579735577106, decouple_loss:0.0012219944037497044
Iteration: 4206, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44854751229286194, gen p mean: -0.048208195716142654, mean p set: 0.44902777671813965
loss_pred:0.014023030176758766, decouple_loss:0.0011392154265195131
The modified gen p mean: 0.4471665024757385, gen p mean: -0.0507621094584465, mean p set: 0.447646826505661The modified gen p mean: 0.44753408432006836, gen p mean: -0.0456690713763237, mean p set: 0.44801437854766846
loss_pred:0.013775169849395752, decouple_loss:0.0012009168276563287
loss_pred:0.013773204758763313, decouple_loss:0.0012544933706521988
Iteration: 4207, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44608765840530396, gen p mean: -0.055087413638830185, mean p set: 0.44656795263290405
loss_pred:0.014153615571558475, decouple_loss:0.001080764690414071
The modified gen p mean: 0.4464246928691864, gen p mean: -0.05541940778493881, mean p set: 0.4469049572944641The modified gen p mean: 0.4469814896583557, gen p mean: -0.052019163966178894, mean p set: 0.4474617540836334
loss_pred:0.014024095609784126, decouple_loss:0.0010672007920220494
loss_pred:0.014054645784199238, decouple_loss:0.0014080939581617713
Iteration: 4208, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483203887939453, gen p mean: -0.05149673670530319, mean p set: 0.4488007128238678
loss_pred:0.013886606320738792, decouple_loss:0.001115880673751235
The modified gen p mean: 0.4483940899372101, gen p mean: -0.04945603758096695, mean p set: 0.44887441396713257The modified gen p mean: 0.4473932683467865, gen p mean: -0.052188690751791, mean p set: 0.4478735327720642
loss_pred:0.013946352526545525, decouple_loss:0.0011187049094587564
loss_pred:0.013654332607984543, decouple_loss:0.00114982679951936
Iteration: 4209, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44773584604263306, gen p mean: -0.04453122243285179, mean p set: 0.44821611046791077
loss_pred:0.014016677625477314, decouple_loss:0.0011359758209437132
The modified gen p mean: 0.4474327862262726, gen p mean: -0.045268360525369644, mean p set: 0.4479130506515503The modified gen p mean: 0.4476727545261383, gen p mean: -0.047548916190862656, mean p set: 0.4481530487537384
loss_pred:0.013657752424478531, decouple_loss:0.001166151836514473
loss_pred:0.013450583443045616, decouple_loss:0.0011136987013742328
Iteration: 4210, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4461553990840912, gen p mean: -0.04571941867470741, mean p set: 0.4466356933116913
loss_pred:0.013756414875388145, decouple_loss:0.0010771768866106868
The modified gen p mean: 0.44749554991722107, gen p mean: -0.043621908873319626, mean p set: 0.4479758143424988The modified gen p mean: 0.44719719886779785, gen p mean: -0.047286175191402435, mean p set: 0.44767752289772034
loss_pred:0.013484051451086998, decouple_loss:0.001154517405666411
loss_pred:0.013559979386627674, decouple_loss:0.0010379682062193751
2023-05-02 18:31:24 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.04463525488972664, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.041123732924461365, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.040897540748119354, mean p set: 0.4500633478164673
loss_pred:0.019002413377165794, decouple_loss:0.0012601835187524557
loss_pred:0.01790795847773552, decouple_loss:0.0011282627237960696
loss_pred:0.01799439638853073, decouple_loss:0.0011224295012652874
WV_0_PC_1_EH_0_PS_40, loss: 0.01836010441184044, avg_mse: 0.026809608563780785
current test mse: 0.02681
Iteration: 4211, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476069211959839, gen p mean: -0.041186731308698654, mean p set: 0.448087215423584
The modified gen p mean: 0.4454862177371979, gen p mean: -0.046348996460437775, mean p set: 0.445966511964798
The modified gen p mean: 0.44727861881256104, gen p mean: -0.04571359232068062, mean p set: 0.44775891304016113
loss_pred:0.013905592262744904, decouple_loss:0.001394236576743424
loss_pred:0.01348135806620121, decouple_loss:0.0012414839584380388
loss_pred:0.014147425070405006, decouple_loss:0.0010304900351911783
Iteration: 4212, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44661805033683777, gen p mean: -0.051447633653879166, mean p set: 0.44709834456443787
loss_pred:0.013502927497029305, decouple_loss:0.0010059494525194168
The modified gen p mean: 0.44741398096084595, gen p mean: -0.04382005333900452, mean p set: 0.44789430499076843The modified gen p mean: 0.4493890106678009, gen p mean: -0.043097950518131256, mean p set: 0.449869304895401
loss_pred:0.0141250379383564, decouple_loss:0.0010267238831147552
loss_pred:0.013708087615668774, decouple_loss:0.0010247916216030717
Iteration: 4213, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44727686047554016, gen p mean: -0.0486084520816803, mean p set: 0.44775715470314026
loss_pred:0.013723873533308506, decouple_loss:0.0010712211951613426
The modified gen p mean: 0.44852012395858765, gen p mean: -0.04836496710777283, mean p set: 0.44900041818618774The modified gen p mean: 0.4468082785606384, gen p mean: -0.05040449649095535, mean p set: 0.4472885727882385
loss_pred:0.013473756611347198, decouple_loss:0.0010328283533453941
loss_pred:0.013861280865967274, decouple_loss:0.0011501709232106805
Iteration: 4214, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476143717765808, gen p mean: -0.051573559641838074, mean p set: 0.4480946362018585
loss_pred:0.01368738617748022, decouple_loss:0.0010063102236017585
The modified gen p mean: 0.449433296918869, gen p mean: -0.049360841512680054, mean p set: 0.4499136209487915The modified gen p mean: 0.4471273124217987, gen p mean: -0.05078192427754402, mean p set: 0.4476076066493988
loss_pred:0.0136388149112463, decouple_loss:0.001026151585392654
loss_pred:0.013648665510118008, decouple_loss:0.000980778830125928
Iteration: 4215, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44784677028656006, gen p mean: -0.04808685928583145, mean p set: 0.44832706451416016
loss_pred:0.013606897555291653, decouple_loss:0.0010355489794164896
The modified gen p mean: 0.44821038842201233, gen p mean: -0.051228117197752, mean p set: 0.44869065284729004The modified gen p mean: 0.44760459661483765, gen p mean: -0.0508546456694603, mean p set: 0.44808489084243774
loss_pred:0.013657337985932827, decouple_loss:0.0010020975023508072
loss_pred:0.013386069796979427, decouple_loss:0.0009866169421002269
Iteration: 4216, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4461471736431122, gen p mean: -0.05356606841087341, mean p set: 0.4466274678707123
loss_pred:0.01399717666208744, decouple_loss:0.0009752718033269048
The modified gen p mean: 0.44713956117630005, gen p mean: -0.055376894772052765, mean p set: 0.44761988520622253The modified gen p mean: 0.447794646024704, gen p mean: -0.043234046548604965, mean p set: 0.44827497005462646
loss_pred:0.013700052164494991, decouple_loss:0.0009445742471143603
loss_pred:0.01346218679100275, decouple_loss:0.0009987083030864596
Iteration: 4217, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480317533016205, gen p mean: -0.044432979077100754, mean p set: 0.4485120475292206
loss_pred:0.014119264669716358, decouple_loss:0.0009860486024990678
The modified gen p mean: 0.44778165221214294, gen p mean: -0.04717215523123741, mean p set: 0.44826194643974304The modified gen p mean: 0.4472886323928833, gen p mean: -0.044207215309143066, mean p set: 0.4477689266204834
loss_pred:0.013655859977006912, decouple_loss:0.0009654018213041127
loss_pred:0.014073395170271397, decouple_loss:0.0009691990562714636
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 4218, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44679686427116394, gen p mean: -0.0474761538207531, mean p set: 0.44727712869644165
loss_pred:0.013387118466198444, decouple_loss:0.0009364592260681093
The modified gen p mean: 0.4470822811126709, gen p mean: -0.04433861002326012, mean p set: 0.447562575340271The modified gen p mean: 0.44861432909965515, gen p mean: -0.04174317419528961, mean p set: 0.44909462332725525
loss_pred:0.013685693964362144, decouple_loss:0.0009451755322515965
loss_pred:0.013553883880376816, decouple_loss:0.0009727579308673739
Iteration: 4219, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483659267425537, gen p mean: -0.045425381511449814, mean p set: 0.4488462209701538
loss_pred:0.013626722618937492, decouple_loss:0.0009236772893927991
The modified gen p mean: 0.4483109414577484, gen p mean: -0.039360951632261276, mean p set: 0.4487912356853485The modified gen p mean: 0.448018342256546, gen p mean: -0.04613075777888298, mean p set: 0.4484986364841461
loss_pred:0.01395874097943306, decouple_loss:0.0009678077767603099
loss_pred:0.013448669575154781, decouple_loss:0.0010300584835931659
Iteration: 4220, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485139846801758, gen p mean: -0.0451187938451767, mean p set: 0.4489942789077759
loss_pred:0.01370762288570404, decouple_loss:0.0009201866923831403
The modified gen p mean: 0.44623613357543945, gen p mean: -0.05209356173872948, mean p set: 0.44671642780303955The modified gen p mean: 0.44732388854026794, gen p mean: -0.04232969135046005, mean p set: 0.44780421257019043
loss_pred:0.013571316376328468, decouple_loss:0.0010262742871418595
loss_pred:0.013495666906237602, decouple_loss:0.0009791689226403832
2023-05-02 18:33:18 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.049714017659425735, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04583807662129402, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.045799970626831055, mean p set: 0.4500633478164673
loss_pred:0.018962236121296883, decouple_loss:0.0011846964480355382
loss_pred:0.017870167270302773, decouple_loss:0.0011304276995360851
loss_pred:0.017955392599105835, decouple_loss:0.0010844398057088256
WV_0_PC_1_EH_0_PS_40, loss: 0.018319258466362953, avg_mse: 0.026748668402433395
current test mse: 0.026749
Iteration: 4221, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44558775424957275, gen p mean: -0.053365375846624374, mean p set: 0.44606801867485046
The modified gen p mean: 0.4475298225879669, gen p mean: -0.05061991885304451, mean p set: 0.44801008701324463
The modified gen p mean: 0.4487040936946869, gen p mean: -0.05007804185152054, mean p set: 0.449184387922287
loss_pred:0.013552852906286716, decouple_loss:0.0013890330446884036
loss_pred:0.01374039612710476, decouple_loss:0.0010564933763816953
loss_pred:0.013688459992408752, decouple_loss:0.001042010961100459
Iteration: 4222, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44736161828041077, gen p mean: -0.04843617230653763, mean p set: 0.44784191250801086
loss_pred:0.013530584052205086, decouple_loss:0.0010203307028859854
The modified gen p mean: 0.44803324341773987, gen p mean: -0.045632634311914444, mean p set: 0.44851356744766235The modified gen p mean: 0.44909846782684326, gen p mean: -0.05106114223599434, mean p set: 0.44957879185676575
loss_pred:0.013399134390056133, decouple_loss:0.001100660883821547
loss_pred:0.013947416096925735, decouple_loss:0.0010294662788510323
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012011_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012011_3_24hr.npz
NaN value num: 0
Iteration: 4223, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44732335209846497, gen p mean: -0.05089396983385086, mean p set: 0.44780364632606506
loss_pred:0.013414738699793816, decouple_loss:0.00101369374897331
The modified gen p mean: 0.4494800865650177, gen p mean: -0.036277953535318375, mean p set: 0.4499603509902954The modified gen p mean: 0.4470593333244324, gen p mean: -0.050804439932107925, mean p set: 0.44753962755203247
loss_pred:0.013423848897218704, decouple_loss:0.001186654670163989
loss_pred:0.013315618969500065, decouple_loss:0.0009786251466721296
Iteration: 4224, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44808363914489746, gen p mean: -0.042972221970558167, mean p set: 0.44856393337249756
loss_pred:0.01399325579404831, decouple_loss:0.001156431157141924
The modified gen p mean: 0.4478502869606018, gen p mean: -0.046188510954380035, mean p set: 0.4483305513858795The modified gen p mean: 0.44757816195487976, gen p mean: -0.04802854359149933, mean p set: 0.44805845618247986
loss_pred:0.01382738258689642, decouple_loss:0.0012143043568357825
loss_pred:0.013117542490363121, decouple_loss:0.001108454423956573
Iteration: 4225, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44774556159973145, gen p mean: -0.04358760267496109, mean p set: 0.44822585582733154
loss_pred:0.014016511850059032, decouple_loss:0.0009698332287371159
The modified gen p mean: 0.4488285779953003, gen p mean: -0.0479009747505188, mean p set: 0.449308842420578The modified gen p mean: 0.446834534406662, gen p mean: -0.050918690860271454, mean p set: 0.4473148286342621
loss_pred:0.012815555557608604, decouple_loss:0.0012191330315545201
loss_pred:0.0130847143009305, decouple_loss:0.0010603589471429586
Iteration: 4226, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44715616106987, gen p mean: -0.04545506834983826, mean p set: 0.4476364552974701
loss_pred:0.013980950228869915, decouple_loss:0.001136419246904552
The modified gen p mean: 0.44797438383102417, gen p mean: -0.0446271188557148, mean p set: 0.44845467805862427The modified gen p mean: 0.44750165939331055, gen p mean: -0.04804297536611557, mean p set: 0.44798195362091064
loss_pred:0.013500841334462166, decouple_loss:0.0010565697448328137
loss_pred:0.013132519088685513, decouple_loss:0.001132818404585123
Iteration: 4227, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490791857242584, gen p mean: -0.04182431101799011, mean p set: 0.4495594799518585
loss_pred:0.013208631426095963, decouple_loss:0.0011062284465879202
The modified gen p mean: 0.44766753911972046, gen p mean: -0.04749026149511337, mean p set: 0.44814783334732056The modified gen p mean: 0.4467989206314087, gen p mean: -0.05106401443481445, mean p set: 0.4472792148590088
loss_pred:0.01365024782717228, decouple_loss:0.0010636490769684315
loss_pred:0.01306837797164917, decouple_loss:0.001023680903017521
Iteration: 4228, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476890563964844, gen p mean: -0.05110064893960953, mean p set: 0.4481693506240845
loss_pred:0.012957965023815632, decouple_loss:0.001160120707936585
The modified gen p mean: 0.4481147527694702, gen p mean: -0.05258967727422714, mean p set: 0.4485950767993927The modified gen p mean: 0.44788751006126404, gen p mean: -0.05057671666145325, mean p set: 0.44836780428886414
loss_pred:0.013058957643806934, decouple_loss:0.0010247675236314535
loss_pred:0.014053749851882458, decouple_loss:0.001164466142654419
Iteration: 4229, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44794023036956787, gen p mean: -0.048010386526584625, mean p set: 0.44842052459716797
loss_pred:0.013584512285888195, decouple_loss:0.001048480742610991
The modified gen p mean: 0.44780397415161133, gen p mean: -0.048140332102775574, mean p set: 0.4482842683792114The modified gen p mean: 0.44764891266822815, gen p mean: -0.04967489093542099, mean p set: 0.44812917709350586
loss_pred:0.013939175754785538, decouple_loss:0.00110658910125494
loss_pred:0.013498611748218536, decouple_loss:0.0010742448503151536
Iteration: 4230, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475812315940857, gen p mean: -0.04510907828807831, mean p set: 0.4480615258216858
loss_pred:0.013347138650715351, decouple_loss:0.0009363822755403817
The modified gen p mean: 0.44870510697364807, gen p mean: -0.04613753408193588, mean p set: 0.44918543100357056The modified gen p mean: 0.44776228070259094, gen p mean: -0.04419499635696411, mean p set: 0.44824254512786865
loss_pred:0.01290484145283699, decouple_loss:0.0010647374438121915
loss_pred:0.013922267593443394, decouple_loss:0.001031762920320034
2023-05-02 18:36:03 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.04868262633681297, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04517746344208717, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.045156076550483704, mean p set: 0.4500633478164673
loss_pred:0.019014671444892883, decouple_loss:0.0012648620177060366
loss_pred:0.01785016991198063, decouple_loss:0.0010513628367334604
loss_pred:0.0179129708558321, decouple_loss:0.0010838081361725926
WV_0_PC_1_EH_0_PS_40, loss: 0.018315937370061874, avg_mse: 0.02674902230501175
current test mse: 0.026749
Iteration: 4231, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44863414764404297, gen p mean: -0.041354622691869736, mean p set: 0.4491144120693207
The modified gen p mean: 0.44857919216156006, gen p mean: -0.04515722393989563, mean p set: 0.44905948638916016
The modified gen p mean: 0.4481104910373688, gen p mean: -0.047359246760606766, mean p set: 0.44859078526496887
loss_pred:0.012678010389208794, decouple_loss:0.0011510991025716066
loss_pred:0.01328447088599205, decouple_loss:0.0010075417812913656
loss_pred:0.013536172918975353, decouple_loss:0.0010240105912089348
Iteration: 4232, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447274774312973, gen p mean: -0.047042299062013626, mean p set: 0.44775503873825073
loss_pred:0.01297035813331604, decouple_loss:0.0010677481768652797
The modified gen p mean: 0.44735175371170044, gen p mean: -0.04483596608042717, mean p set: 0.44783204793930054The modified gen p mean: 0.44797784090042114, gen p mean: -0.045378394424915314, mean p set: 0.44845813512802124
loss_pred:0.013697248883545399, decouple_loss:0.0011040911776944995
loss_pred:0.012710707262158394, decouple_loss:0.001062024850398302
Iteration: 4233, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470285177230835, gen p mean: -0.04333014413714409, mean p set: 0.4475088119506836
loss_pred:0.013553693890571594, decouple_loss:0.0010409028036519885
The modified gen p mean: 0.4473905563354492, gen p mean: -0.042434804141521454, mean p set: 0.4478708505630493The modified gen p mean: 0.44769522547721863, gen p mean: -0.04773353040218353, mean p set: 0.4481755197048187
loss_pred:0.012933533638715744, decouple_loss:0.0009888712083920836
loss_pred:0.013228952884674072, decouple_loss:0.001190376584418118
Iteration: 4234, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478897452354431, gen p mean: -0.04364032670855522, mean p set: 0.4483700692653656
loss_pred:0.012885740026831627, decouple_loss:0.001071223639883101
The modified gen p mean: 0.44653698801994324, gen p mean: -0.040704429149627686, mean p set: 0.44701725244522095The modified gen p mean: 0.44765564799308777, gen p mean: -0.04334263876080513, mean p set: 0.44813597202301025
loss_pred:0.01386171393096447, decouple_loss:0.0011025224812328815
loss_pred:0.013927595689892769, decouple_loss:0.0010784136829897761
Iteration: 4235, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475351870059967, gen p mean: -0.04701688885688782, mean p set: 0.4480154812335968
loss_pred:0.012797171249985695, decouple_loss:0.0010044537484645844
The modified gen p mean: 0.44815149903297424, gen p mean: -0.04758838564157486, mean p set: 0.44863179326057434The modified gen p mean: 0.4482946991920471, gen p mean: -0.044503722339868546, mean p set: 0.4487749934196472
loss_pred:0.01295340247452259, decouple_loss:0.0009396773530170321
loss_pred:0.013604451902210712, decouple_loss:0.0009659745846875012
Iteration: 4236, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471130669116974, gen p mean: -0.0482899509370327, mean p set: 0.4475933611392975
loss_pred:0.014000210911035538, decouple_loss:0.0010466156527400017
The modified gen p mean: 0.4473133087158203, gen p mean: -0.05084516853094101, mean p set: 0.4477936327457428The modified gen p mean: 0.44741091132164, gen p mean: -0.045533187687397, mean p set: 0.4478912055492401
loss_pred:0.012731625698506832, decouple_loss:0.0010301928268745542
loss_pred:0.014103177934885025, decouple_loss:0.0009400147828273475
Iteration: 4237, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468989074230194, gen p mean: -0.05279481038451195, mean p set: 0.4473792016506195
loss_pred:0.013082041405141354, decouple_loss:0.0010030071716755629
The modified gen p mean: 0.4480414092540741, gen p mean: -0.045805659145116806, mean p set: 0.4485217034816742The modified gen p mean: 0.4481607973575592, gen p mean: -0.05198335647583008, mean p set: 0.4486410617828369
loss_pred:0.012912251986563206, decouple_loss:0.0010530103463679552
loss_pred:0.013138380832970142, decouple_loss:0.0009960008319467306
Iteration: 4238, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44812625646591187, gen p mean: -0.0467517152428627, mean p set: 0.44860655069351196
loss_pred:0.013094393536448479, decouple_loss:0.0009975808206945658
The modified gen p mean: 0.44720175862312317, gen p mean: -0.05005419999361038, mean p set: 0.44768205285072327The modified gen p mean: 0.44720330834388733, gen p mean: -0.046145107597112656, mean p set: 0.4476836025714874
loss_pred:0.01410625595599413, decouple_loss:0.0012705492554232478
loss_pred:0.012967681512236595, decouple_loss:0.0009942431934177876
Iteration: 4239, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486345052719116, gen p mean: -0.045755814760923386, mean p set: 0.4491148293018341
loss_pred:0.013280550949275494, decouple_loss:0.000918584642931819
The modified gen p mean: 0.4471811056137085, gen p mean: -0.050441909581422806, mean p set: 0.4476613700389862The modified gen p mean: 0.44704321026802063, gen p mean: -0.04984813928604126, mean p set: 0.4475235044956207
loss_pred:0.013533787801861763, decouple_loss:0.0010540211806073785
loss_pred:0.013065912760794163, decouple_loss:0.0009494729456491768
Iteration: 4240, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449092298746109, gen p mean: -0.0416213758289814, mean p set: 0.4495725929737091
loss_pred:0.01313511747866869, decouple_loss:0.0009452091762796044
The modified gen p mean: 0.44668814539909363, gen p mean: -0.04897329583764076, mean p set: 0.4471684396266937The modified gen p mean: 0.44773584604263306, gen p mean: -0.05038968846201897, mean p set: 0.44821614027023315
loss_pred:0.013598117046058178, decouple_loss:0.0010858664754778147
loss_pred:0.013783291913568974, decouple_loss:0.0010402918560430408
2023-05-02 18:37:59 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.05052776262164116, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.047190140932798386, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.04713708534836769, mean p set: 0.4500633478164673
loss_pred:0.019028032198548317, decouple_loss:0.0011086500016972423
loss_pred:0.017908507958054543, decouple_loss:0.0009324102429673076
loss_pred:0.01794004812836647, decouple_loss:0.0009327797451987863
WV_0_PC_1_EH_0_PS_40, loss: 0.018341761082410812, avg_mse: 0.02683163620531559
current test mse: 0.026832
Iteration: 4241, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44768840074539185, gen p mean: -0.05232233926653862, mean p set: 0.44816869497299194
The modified gen p mean: 0.44962745904922485, gen p mean: -0.04503288120031357, mean p set: 0.45010778307914734
The modified gen p mean: 0.4471355974674225, gen p mean: -0.044804394245147705, mean p set: 0.4476158618927002
loss_pred:0.013865686021745205, decouple_loss:0.0009634283487685025
loss_pred:0.01324199978262186, decouple_loss:0.0009769368916749954
loss_pred:0.01288528461009264, decouple_loss:0.0009333088528364897
Iteration: 4242, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474719762802124, gen p mean: -0.04297193884849548, mean p set: 0.4479523003101349
The modified gen p mean: 0.44778740406036377, gen p mean: -0.04563906043767929, mean p set: 0.4482676684856415
loss_pred:0.013789460994303226, decouple_loss:0.0010645994916558266
loss_pred:0.013506780378520489, decouple_loss:0.0012837516842409968
The modified gen p mean: 0.4485373795032501, gen p mean: -0.04240363463759422, mean p set: 0.4490176737308502
loss_pred:0.013454348780214787, decouple_loss:0.0012311795726418495
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012010_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012010_3_24hr.npz
NaN value num: 0
Iteration: 4243, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45009303092956543, gen p mean: -0.03736575320363045, mean p set: 0.45057329535484314
loss_pred:0.01699841022491455, decouple_loss:0.0009622679790481925
The modified gen p mean: 0.4500812888145447, gen p mean: -0.03824895620346069, mean p set: 0.4505615830421448The modified gen p mean: 0.4506557881832123, gen p mean: -0.03692728653550148, mean p set: 0.45113611221313477
loss_pred:0.015438074246048927, decouple_loss:0.001030503772199154
loss_pred:0.016062069684267044, decouple_loss:0.0010161581449210644
Iteration: 4244, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44821226596832275, gen p mean: -0.03473125025629997, mean p set: 0.44869256019592285
loss_pred:0.015783026814460754, decouple_loss:0.0010020345216616988
The modified gen p mean: 0.4475676119327545, gen p mean: -0.034623581916093826, mean p set: 0.4480479061603546The modified gen p mean: 0.4510563313961029, gen p mean: -0.033527620136737823, mean p set: 0.451536625623703
loss_pred:0.016576677560806274, decouple_loss:0.0009916673880070448
loss_pred:0.01665676198899746, decouple_loss:0.0010282829171046615
Iteration: 4245, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45136386156082153, gen p mean: -0.033874496817588806, mean p set: 0.45184415578842163
loss_pred:0.015476271510124207, decouple_loss:0.0012468441855162382
The modified gen p mean: 0.44916102290153503, gen p mean: -0.02782752923667431, mean p set: 0.4496413469314575The modified gen p mean: 0.4478659927845001, gen p mean: -0.03073091059923172, mean p set: 0.4483462870121002
loss_pred:0.01676214672625065, decouple_loss:0.0011841724626719952
loss_pred:0.01619821973145008, decouple_loss:0.001089426688849926
Iteration: 4246, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44841107726097107, gen p mean: -0.027378244325518608, mean p set: 0.44889137148857117
loss_pred:0.01635480299592018, decouple_loss:0.0010705678723752499
The modified gen p mean: 0.45021942257881165, gen p mean: -0.032122086733579636, mean p set: 0.45069968700408936The modified gen p mean: 0.44757890701293945, gen p mean: -0.030051523819565773, mean p set: 0.44805923104286194
loss_pred:0.015707185491919518, decouple_loss:0.0011281276820227504
loss_pred:0.015404907986521721, decouple_loss:0.0010707448236644268
Iteration: 4247, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4522785544395447, gen p mean: -0.03022519312798977, mean p set: 0.4527588486671448
loss_pred:0.015111913904547691, decouple_loss:0.0013296407414600253
The modified gen p mean: 0.4498325288295746, gen p mean: -0.025375569239258766, mean p set: 0.4503127932548523The modified gen p mean: 0.4513677656650543, gen p mean: -0.028662489727139473, mean p set: 0.4518480598926544
loss_pred:0.015129517763853073, decouple_loss:0.0010125834960490465
loss_pred:0.015413178130984306, decouple_loss:0.001223249128088355
Iteration: 4248, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44778576493263245, gen p mean: -0.025533437728881836, mean p set: 0.44826605916023254
loss_pred:0.016412289813160896, decouple_loss:0.0010723794111981988
The modified gen p mean: 0.4487013816833496, gen p mean: -0.024874528869986534, mean p set: 0.4491817057132721The modified gen p mean: 0.4471801221370697, gen p mean: -0.02769879810512066, mean p set: 0.4476604163646698
loss_pred:0.01669740490615368, decouple_loss:0.0011287381639704108
loss_pred:0.015045973472297192, decouple_loss:0.0010698467958718538
Iteration: 4249, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497199058532715, gen p mean: -0.031579405069351196, mean p set: 0.4502002000808716
loss_pred:0.015444726683199406, decouple_loss:0.001151663833297789
The modified gen p mean: 0.44956454634666443, gen p mean: -0.032860662788152695, mean p set: 0.4500448405742645The modified gen p mean: 0.45162808895111084, gen p mean: -0.034189652651548386, mean p set: 0.4521084129810333
loss_pred:0.015884477645158768, decouple_loss:0.0011429974110797048
loss_pred:0.01599808968603611, decouple_loss:0.0011664412450045347
Iteration: 4250, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492855370044708, gen p mean: -0.030639853328466415, mean p set: 0.44976580142974854
loss_pred:0.01596834510564804, decouple_loss:0.0010533696040511131
The modified gen p mean: 0.4508529603481293, gen p mean: -0.031337887048721313, mean p set: 0.45133325457572937The modified gen p mean: 0.44807863235473633, gen p mean: -0.031444333493709564, mean p set: 0.44855889678001404
loss_pred:0.015819843858480453, decouple_loss:0.0010554972104728222
loss_pred:0.016065960749983788, decouple_loss:0.0010157566284760833
2023-05-02 18:40:34 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.03919464349746704, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.03647832199931145, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.0362095981836319, mean p set: 0.4500633478164673
loss_pred:0.01842762716114521, decouple_loss:0.001165336580015719
loss_pred:0.017370982095599174, decouple_loss:0.0012362997513264418
loss_pred:0.01746608503162861, decouple_loss:0.0012457644334062934
WV_0_PC_1_EH_0_PS_40, loss: 0.017815688624978065, avg_mse: 0.02571316994726658
current test mse: 0.025713
Iteration: 4251, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44755303859710693, gen p mean: -0.031732648611068726, mean p set: 0.44803333282470703
The modified gen p mean: 0.44835230708122253, gen p mean: -0.02929316833615303, mean p set: 0.44883257150650024
The modified gen p mean: 0.4491461515426636, gen p mean: -0.030934272333979607, mean p set: 0.44962644577026367
loss_pred:0.015864282846450806, decouple_loss:0.0009956846479326487
loss_pred:0.015591646544635296, decouple_loss:0.0011246753856539726
loss_pred:0.015459714457392693, decouple_loss:0.0010800170712172985
Iteration: 4252, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44929370284080505, gen p mean: -0.03536289930343628, mean p set: 0.44977399706840515
loss_pred:0.0159405916929245, decouple_loss:0.0010703586740419269
The modified gen p mean: 0.45128291845321655, gen p mean: -0.037703633308410645, mean p set: 0.45176324248313904The modified gen p mean: 0.448749303817749, gen p mean: -0.03271840140223503, mean p set: 0.4492295980453491
loss_pred:0.015075004659593105, decouple_loss:0.001070120488293469
loss_pred:0.016331255435943604, decouple_loss:0.0010644998401403427
Iteration: 4253, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44725048542022705, gen p mean: -0.03706859052181244, mean p set: 0.44773074984550476
loss_pred:0.01588539034128189, decouple_loss:0.0010248415637761354
The modified gen p mean: 0.4499646723270416, gen p mean: -0.03703758865594864, mean p set: 0.4504449665546417The modified gen p mean: 0.4515502154827118, gen p mean: -0.0390392541885376, mean p set: 0.4520305097103119
loss_pred:0.016216782853007317, decouple_loss:0.0010672290809452534
loss_pred:0.015133196488022804, decouple_loss:0.0010426671942695975
Iteration: 4254, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44943326711654663, gen p mean: -0.03986096382141113, mean p set: 0.44991356134414673
loss_pred:0.015840662643313408, decouple_loss:0.001037829089909792
The modified gen p mean: 0.44727790355682373, gen p mean: -0.03627418726682663, mean p set: 0.44775813817977905The modified gen p mean: 0.4502079486846924, gen p mean: -0.03898770362138748, mean p set: 0.4506881833076477
loss_pred:0.01566128619015217, decouple_loss:0.0010552849853411317
loss_pred:0.015870649367570877, decouple_loss:0.0010531656444072723
Iteration: 4255, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492734372615814, gen p mean: -0.04108032211661339, mean p set: 0.4497537314891815
loss_pred:0.015741081908345222, decouple_loss:0.0012353317579254508
The modified gen p mean: 0.4481247365474701, gen p mean: -0.03470803052186966, mean p set: 0.4486050307750702The modified gen p mean: 0.4521802067756653, gen p mean: -0.04227526858448982, mean p set: 0.4526605010032654
loss_pred:0.016294343397021294, decouple_loss:0.001177675905637443
loss_pred:0.015273873694241047, decouple_loss:0.0013776348205283284
Iteration: 4256, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499530494213104, gen p mean: -0.030670562759041786, mean p set: 0.4504333436489105
loss_pred:0.01529276929795742, decouple_loss:0.0009953425033017993
The modified gen p mean: 0.45054158568382263, gen p mean: -0.03340677171945572, mean p set: 0.45102187991142273The modified gen p mean: 0.4501053988933563, gen p mean: -0.033115021884441376, mean p set: 0.4505856931209564
loss_pred:0.015903834253549576, decouple_loss:0.001057203859090805
loss_pred:0.015921812504529953, decouple_loss:0.0010576737113296986
Iteration: 4257, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4515320658683777, gen p mean: -0.03086414374411106, mean p set: 0.4520123302936554
loss_pred:0.015545827336609364, decouple_loss:0.0010955845937132835
The modified gen p mean: 0.4491357207298279, gen p mean: -0.03118283860385418, mean p set: 0.44961604475975037The modified gen p mean: 0.44873663783073425, gen p mean: -0.027856122702360153, mean p set: 0.44921693205833435
loss_pred:0.016350867226719856, decouple_loss:0.0011026039719581604
loss_pred:0.015572739765048027, decouple_loss:0.0011021781247109175
Iteration: 4258, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44977709650993347, gen p mean: -0.03600092604756355, mean p set: 0.45025739073753357
loss_pred:0.016619518399238586, decouple_loss:0.0012153356801718473
The modified gen p mean: 0.45025694370269775, gen p mean: -0.029170753434300423, mean p set: 0.45073726773262024The modified gen p mean: 0.44747841358184814, gen p mean: -0.03361358866095543, mean p set: 0.44795873761177063
loss_pred:0.015905801206827164, decouple_loss:0.000990570173598826
loss_pred:0.016776015982031822, decouple_loss:0.0010287996847182512
Iteration: 4259, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486565887928009, gen p mean: -0.02766992338001728, mean p set: 0.449136883020401
loss_pred:0.01651417650282383, decouple_loss:0.0010692533105611801
The modified gen p mean: 0.45168885588645935, gen p mean: -0.035789672285318375, mean p set: 0.45216912031173706The modified gen p mean: 0.45008373260498047, gen p mean: -0.035325195640325546, mean p set: 0.45056405663490295
loss_pred:0.01578613370656967, decouple_loss:0.0012043524766340852
loss_pred:0.016407962888479233, decouple_loss:0.0011625756742432714
Iteration: 4260, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496040344238281, gen p mean: -0.0281103253364563, mean p set: 0.4500843286514282
loss_pred:0.016292281448841095, decouple_loss:0.0010580167872831225
The modified gen p mean: 0.4486111104488373, gen p mean: -0.029966112226247787, mean p set: 0.44909143447875977The modified gen p mean: 0.4473363757133484, gen p mean: -0.03698558732867241, mean p set: 0.4478166699409485
loss_pred:0.015857042744755745, decouple_loss:0.0010232238564640284
loss_pred:0.0165121927857399, decouple_loss:0.0011698430171236396
2023-05-02 18:42:29 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.038620203733444214, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.0354028157889843, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.03544199466705322, mean p set: 0.4500633478164673
loss_pred:0.018244517967104912, decouple_loss:0.0012047836789861321
loss_pred:0.017169175669550896, decouple_loss:0.0011466287542134523
loss_pred:0.01731417514383793, decouple_loss:0.0011290026595816016
WV_0_PC_1_EH_0_PS_40, loss: 0.017633965238928795, avg_mse: 0.025368385016918182
current test mse: 0.025368
Iteration: 4261, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450407475233078, gen p mean: -0.03994828835129738, mean p set: 0.4508877694606781
The modified gen p mean: 0.44999948143959045, gen p mean: -0.031706489622592926, mean p set: 0.45047977566719055
The modified gen p mean: 0.44837361574172974, gen p mean: -0.03376082703471184, mean p set: 0.44885390996932983
loss_pred:0.015260093845427036, decouple_loss:0.001124167931266129
loss_pred:0.015849582850933075, decouple_loss:0.0011515988735482097
loss_pred:0.015384338796138763, decouple_loss:0.0010732593946158886
Iteration: 4262, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44730284810066223, gen p mean: -0.03664790093898773, mean p set: 0.44778314232826233
The modified gen p mean: 0.44969040155410767, gen p mean: -0.03105984814465046, mean p set: 0.45017069578170776
loss_pred:0.016486624255776405, decouple_loss:0.001029661507345736
loss_pred:0.0158381387591362, decouple_loss:0.0010920228669419885
The modified gen p mean: 0.45137128233909607, gen p mean: -0.03322310000658035, mean p set: 0.45185160636901855
loss_pred:0.016542775556445122, decouple_loss:0.0011864419793710113
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012007_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012007_3_24hr.npz
NaN value num: 0
Iteration: 4263, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44811156392097473, gen p mean: -0.041705913841724396, mean p set: 0.44859179854393005
loss_pred:0.016205767169594765, decouple_loss:0.0010555790504440665
The modified gen p mean: 0.4468475878238678, gen p mean: -0.04225233569741249, mean p set: 0.4473278820514679The modified gen p mean: 0.44653043150901794, gen p mean: -0.04095100983977318, mean p set: 0.44701069593429565
loss_pred:0.01622620038688183, decouple_loss:0.0012335070641711354
loss_pred:0.016768470406532288, decouple_loss:0.0010362336179241538
Iteration: 4264, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44702014327049255, gen p mean: -0.04130333289504051, mean p set: 0.44750040769577026
loss_pred:0.016698108986020088, decouple_loss:0.0011073207715526223
The modified gen p mean: 0.4475628137588501, gen p mean: -0.04565298184752464, mean p set: 0.4480431377887726The modified gen p mean: 0.4478079080581665, gen p mean: -0.043650783598423004, mean p set: 0.448288232088089
loss_pred:0.01638849638402462, decouple_loss:0.0011374658206477761
loss_pred:0.01611468195915222, decouple_loss:0.0011893300106748939
Iteration: 4265, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468745291233063, gen p mean: -0.04710979014635086, mean p set: 0.447354793548584
loss_pred:0.01694842055439949, decouple_loss:0.0010862667113542557
The modified gen p mean: 0.4470949172973633, gen p mean: -0.048621028661727905, mean p set: 0.4475752115249634The modified gen p mean: 0.44680461287498474, gen p mean: -0.050303392112255096, mean p set: 0.44728490710258484
loss_pred:0.015705564990639687, decouple_loss:0.0011234882986173034
loss_pred:0.015792004764080048, decouple_loss:0.0011182460002601147
Iteration: 4266, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477410912513733, gen p mean: -0.05344708263874054, mean p set: 0.4482213854789734
loss_pred:0.015441043302416801, decouple_loss:0.0012868508929386735
The modified gen p mean: 0.44716039299964905, gen p mean: -0.05713401362299919, mean p set: 0.44764068722724915The modified gen p mean: 0.44636884331703186, gen p mean: -0.05211867019534111, mean p set: 0.44684910774230957
loss_pred:0.01644502952694893, decouple_loss:0.0011637501884251833
loss_pred:0.01614200323820114, decouple_loss:0.0012538639130070806
Iteration: 4267, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482136368751526, gen p mean: -0.05356162413954735, mean p set: 0.4486939311027527
loss_pred:0.016493599861860275, decouple_loss:0.0010432798881083727
The modified gen p mean: 0.44788864254951477, gen p mean: -0.05809672176837921, mean p set: 0.44836893677711487The modified gen p mean: 0.44781041145324707, gen p mean: -0.058051109313964844, mean p set: 0.44829070568084717
loss_pred:0.015967831015586853, decouple_loss:0.0010112504241988063
loss_pred:0.016716258600354195, decouple_loss:0.0010165488347411156
Iteration: 4268, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4462895691394806, gen p mean: -0.05679117143154144, mean p set: 0.4467698633670807
loss_pred:0.016696935519576073, decouple_loss:0.0012151077389717102
The modified gen p mean: 0.4471132159233093, gen p mean: -0.05988578498363495, mean p set: 0.4475935399532318The modified gen p mean: 0.4484260678291321, gen p mean: -0.0582149513065815, mean p set: 0.4489063620567322
loss_pred:0.015981681644916534, decouple_loss:0.0011835532495751977
loss_pred:0.016093242913484573, decouple_loss:0.0011936778901144862
Iteration: 4269, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473426640033722, gen p mean: -0.05798626318573952, mean p set: 0.4478229880332947
loss_pred:0.01564827188849449, decouple_loss:0.0010874514700844884
The modified gen p mean: 0.4477159380912781, gen p mean: -0.05769472196698189, mean p set: 0.4481962025165558The modified gen p mean: 0.44776391983032227, gen p mean: -0.05228831619024277, mean p set: 0.44824421405792236
loss_pred:0.016700994223356247, decouple_loss:0.0009982867632061243
loss_pred:0.016843589022755623, decouple_loss:0.000994757516309619
Iteration: 4270, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468744397163391, gen p mean: -0.05325575917959213, mean p set: 0.4473547041416168
loss_pred:0.01628177799284458, decouple_loss:0.0010166738647967577
The modified gen p mean: 0.44892945885658264, gen p mean: -0.05780930444598198, mean p set: 0.44940972328186035The modified gen p mean: 0.4490271210670471, gen p mean: -0.05401855707168579, mean p set: 0.4495074450969696
loss_pred:0.015710977837443352, decouple_loss:0.0011027551954612136
loss_pred:0.016075793653726578, decouple_loss:0.0010665832087397575
2023-05-02 18:45:00 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.05612426996231079, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830535888672, gen p mean: -0.05252416804432869, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.05234010890126228, mean p set: 0.45035696029663086
loss_pred:0.018263572826981544, decouple_loss:0.0011825034162029624
loss_pred:0.01722186617553234, decouple_loss:0.00131503539159894loss_pred:0.01729886420071125, decouple_loss:0.001246930449269712
WV_0_PC_1_EH_0_PS_40, loss: 0.017657175660133362, avg_mse: 0.02538626827299595
current test mse: 0.025386
Iteration: 4271, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479723274707794, gen p mean: -0.054115649312734604, mean p set: 0.4484526515007019
The modified gen p mean: 0.44797948002815247, gen p mean: -0.05181240290403366, mean p set: 0.4484597444534302
The modified gen p mean: 0.44772493839263916, gen p mean: -0.0515386164188385, mean p set: 0.44820523262023926
loss_pred:0.016554513946175575, decouple_loss:0.0012104928027838469
loss_pred:0.0160078052431345, decouple_loss:0.0011611394584178925
loss_pred:0.016270343214273453, decouple_loss:0.0012439886340871453
Iteration: 4272, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468402862548828, gen p mean: -0.05643410235643387, mean p set: 0.4473206102848053
loss_pred:0.016822954639792442, decouple_loss:0.0011176170082762837
The modified gen p mean: 0.44810450077056885, gen p mean: -0.05378168448805809, mean p set: 0.44858479499816895The modified gen p mean: 0.44762206077575684, gen p mean: -0.05090409517288208, mean p set: 0.4481023848056793
loss_pred:0.016327185556292534, decouple_loss:0.001084321760572493
loss_pred:0.015751617029309273, decouple_loss:0.0010312168160453439
Iteration: 4273, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44801634550094604, gen p mean: -0.054075706750154495, mean p set: 0.44849663972854614
loss_pred:0.015986813232302666, decouple_loss:0.0010506329126656055
The modified gen p mean: 0.44612574577331543, gen p mean: -0.05102104693651199, mean p set: 0.44660601019859314The modified gen p mean: 0.44891101121902466, gen p mean: -0.05544298514723778, mean p set: 0.44939130544662476
loss_pred:0.01606823317706585, decouple_loss:0.0010996320052072406
loss_pred:0.015796195715665817, decouple_loss:0.0010399228194728494
Iteration: 4274, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470505118370056, gen p mean: -0.05618889257311821, mean p set: 0.4475308060646057
loss_pred:0.01632346212863922, decouple_loss:0.0012680954532697797
The modified gen p mean: 0.4471675753593445, gen p mean: -0.052610207349061966, mean p set: 0.4476478397846222The modified gen p mean: 0.4465724527835846, gen p mean: -0.05518146976828575, mean p set: 0.4470527172088623
loss_pred:0.01619008183479309, decouple_loss:0.0011832937598228455
loss_pred:0.017143061384558678, decouple_loss:0.0012379554100334644
Iteration: 4275, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44634732604026794, gen p mean: -0.056186456233263016, mean p set: 0.44682762026786804
loss_pred:0.015679307281970978, decouple_loss:0.0011075884103775024
The modified gen p mean: 0.44815143942832947, gen p mean: -0.0551278181374073, mean p set: 0.44863173365592957The modified gen p mean: 0.4486711323261261, gen p mean: -0.055684756487607956, mean p set: 0.4491514265537262
loss_pred:0.01601351797580719, decouple_loss:0.000992043293081224
loss_pred:0.01545057911425829, decouple_loss:0.0010668078903108835
Iteration: 4276, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466511309146881, gen p mean: -0.05354470759630203, mean p set: 0.4471314251422882
loss_pred:0.01598171330988407, decouple_loss:0.001109747332520783
The modified gen p mean: 0.4478556215763092, gen p mean: -0.055413421243429184, mean p set: 0.4483358860015869The modified gen p mean: 0.44755280017852783, gen p mean: -0.0529482401907444, mean p set: 0.4480331242084503
loss_pred:0.016597861424088478, decouple_loss:0.0010666769230738282
loss_pred:0.0156647190451622, decouple_loss:0.001191988354548812
Iteration: 4277, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44741570949554443, gen p mean: -0.05483528599143028, mean p set: 0.44789600372314453
loss_pred:0.01634947955608368, decouple_loss:0.001191951334476471
The modified gen p mean: 0.4458577334880829, gen p mean: -0.05109976604580879, mean p set: 0.4463379681110382The modified gen p mean: 0.4477768838405609, gen p mean: -0.054107435047626495, mean p set: 0.4482572078704834
loss_pred:0.016331741586327553, decouple_loss:0.0010254201479256153
loss_pred:0.016495009884238243, decouple_loss:0.0010929505806416273
Iteration: 4278, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484494924545288, gen p mean: -0.05123541131615639, mean p set: 0.4489297568798065
loss_pred:0.01579231582581997, decouple_loss:0.0009928721701726317
The modified gen p mean: 0.4457228481769562, gen p mean: -0.049575358629226685, mean p set: 0.44620317220687866The modified gen p mean: 0.44645819067955017, gen p mean: -0.05088813602924347, mean p set: 0.44693848490715027
loss_pred:0.016175279393792152, decouple_loss:0.0009066865895874798
loss_pred:0.016502516344189644, decouple_loss:0.0009663936798460782
Iteration: 4279, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44702789187431335, gen p mean: -0.05054909363389015, mean p set: 0.44750818610191345
loss_pred:0.015944750979542732, decouple_loss:0.0010214278008788824
The modified gen p mean: 0.44705930352211, gen p mean: -0.05036093667149544, mean p set: 0.44753962755203247The modified gen p mean: 0.4469485282897949, gen p mean: -0.0537407211959362, mean p set: 0.44742879271507263
loss_pred:0.01590423844754696, decouple_loss:0.001099565764889121
loss_pred:0.01697455160319805, decouple_loss:0.0010259045520797372
Iteration: 4280, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44786643981933594, gen p mean: -0.05148895084857941, mean p set: 0.44834673404693604
loss_pred:0.01644953340291977, decouple_loss:0.0009797611273825169
The modified gen p mean: 0.44663500785827637, gen p mean: -0.048240162432193756, mean p set: 0.4471152722835541The modified gen p mean: 0.4471752941608429, gen p mean: -0.050866030156612396, mean p set: 0.447655588388443
loss_pred:0.01604151912033558, decouple_loss:0.0009909411892294884
loss_pred:0.016565721482038498, decouple_loss:0.001073773019015789
2023-05-02 18:46:55 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.05239496007561684, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.048857029527425766, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.048783447593450546, mean p set: 0.4500633478164673
loss_pred:0.018298447132110596, decouple_loss:0.0011390664149075747
loss_pred:0.017180796712636948, decouple_loss:0.0009980753529816866
loss_pred:0.017294133082032204, decouple_loss:0.0009489580406807363
WV_0_PC_1_EH_0_PS_40, loss: 0.017642561346292496, avg_mse: 0.025386489927768707
current test mse: 0.025386
Iteration: 4281, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447847843170166, gen p mean: -0.05304575338959694, mean p set: 0.4483281373977661
The modified gen p mean: 0.44669944047927856, gen p mean: -0.04804485663771629, mean p set: 0.44717973470687866
The modified gen p mean: 0.44728296995162964, gen p mean: -0.04986422881484032, mean p set: 0.4477632939815521
loss_pred:0.016371900215744972, decouple_loss:0.0010035572340711951
loss_pred:0.01641072705388069, decouple_loss:0.001111226505599916
loss_pred:0.016908932477235794, decouple_loss:0.0010432039853185415
Iteration: 4282, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482361078262329, gen p mean: -0.052119750529527664, mean p set: 0.448716402053833
loss_pred:0.015549558214843273, decouple_loss:0.0010577536886557937
The modified gen p mean: 0.4468744695186615, gen p mean: -0.04986068978905678, mean p set: 0.4473547637462616The modified gen p mean: 0.44723790884017944, gen p mean: -0.04804756119847298, mean p set: 0.44771823287010193
loss_pred:0.0168169979006052, decouple_loss:0.0009542381740175188
loss_pred:0.015570247545838356, decouple_loss:0.0010468316031619906
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012016_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012016_3_24hr.npz
NaN value num: 0
Iteration: 4283, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44957196712493896, gen p mean: -0.03941424563527107, mean p set: 0.45005226135253906
loss_pred:0.01724185235798359, decouple_loss:0.0012458377750590444
The modified gen p mean: 0.44792619347572327, gen p mean: -0.04532420635223389, mean p set: 0.44840651750564575The modified gen p mean: 0.44855108857154846, gen p mean: -0.049378711730241776, mean p set: 0.44903138279914856
loss_pred:0.016895083710551262, decouple_loss:0.0012807799503207207
loss_pred:0.016151370480656624, decouple_loss:0.001171623240225017
Iteration: 4284, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501352906227112, gen p mean: -0.04205949231982231, mean p set: 0.45061561465263367
loss_pred:0.0162129495292902, decouple_loss:0.0010348021751269698
The modified gen p mean: 0.4488801956176758, gen p mean: -0.041117507964372635, mean p set: 0.44936051964759827The modified gen p mean: 0.4503643810749054, gen p mean: -0.03658003360033035, mean p set: 0.4508446753025055
loss_pred:0.0164888147264719, decouple_loss:0.0009737180080264807
loss_pred:0.016218295320868492, decouple_loss:0.0012087003560736775
Iteration: 4285, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45015621185302734, gen p mean: -0.04249095916748047, mean p set: 0.45063650608062744
loss_pred:0.016809852793812752, decouple_loss:0.0009867873741313815
The modified gen p mean: 0.45017972588539124, gen p mean: -0.043459631502628326, mean p set: 0.4506600499153137The modified gen p mean: 0.44793641567230225, gen p mean: -0.04529782384634018, mean p set: 0.44841670989990234
loss_pred:0.016685545444488525, decouple_loss:0.0009946678765118122
loss_pred:0.015982085838913918, decouple_loss:0.0010807013604789972
Iteration: 4286, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496050179004669, gen p mean: -0.04433045908808708, mean p set: 0.450085312128067
loss_pred:0.016250664368271828, decouple_loss:0.0010079905623570085
The modified gen p mean: 0.45044204592704773, gen p mean: -0.0395766943693161, mean p set: 0.4509223401546478The modified gen p mean: 0.45028096437454224, gen p mean: -0.04548247531056404, mean p set: 0.45076125860214233
loss_pred:0.016156628727912903, decouple_loss:0.001067486358806491
loss_pred:0.01632743887603283, decouple_loss:0.0010319930734112859
Iteration: 4287, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44812336564064026, gen p mean: -0.04673677682876587, mean p set: 0.44860365986824036
loss_pred:0.016162564978003502, decouple_loss:0.0009484488400630653
The modified gen p mean: 0.4481627643108368, gen p mean: -0.048138219863176346, mean p set: 0.4486430585384369The modified gen p mean: 0.44906988739967346, gen p mean: -0.048060573637485504, mean p set: 0.44955018162727356
loss_pred:0.016526997089385986, decouple_loss:0.0009270725422538817
loss_pred:0.016037432476878166, decouple_loss:0.0010547242127358913
Iteration: 4288, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4506303369998932, gen p mean: -0.04542720317840576, mean p set: 0.4511106312274933
loss_pred:0.016557633876800537, decouple_loss:0.0009685849654488266
The modified gen p mean: 0.44886693358421326, gen p mean: -0.04758494719862938, mean p set: 0.44934722781181335The modified gen p mean: 0.4481503665447235, gen p mean: -0.0471249483525753, mean p set: 0.448630690574646
loss_pred:0.01598283462226391, decouple_loss:0.001007954473607242
loss_pred:0.016601914539933205, decouple_loss:0.0010052704019472003
Iteration: 4289, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479113817214966, gen p mean: -0.049292199313640594, mean p set: 0.4483916759490967
loss_pred:0.01671716757118702, decouple_loss:0.0010161964455619454
The modified gen p mean: 0.45012331008911133, gen p mean: -0.049272336065769196, mean p set: 0.4506036043167114The modified gen p mean: 0.4494689106941223, gen p mean: -0.05669384449720383, mean p set: 0.4499492049217224
loss_pred:0.016480829566717148, decouple_loss:0.0010186139261350036
loss_pred:0.015843601897358894, decouple_loss:0.00113002210855484
Iteration: 4290, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44996973872184753, gen p mean: -0.04887278005480766, mean p set: 0.45045000314712524
loss_pred:0.016595754772424698, decouple_loss:0.0010123092215508223
The modified gen p mean: 0.449876070022583, gen p mean: -0.05533423274755478, mean p set: 0.4503563344478607The modified gen p mean: 0.4477386474609375, gen p mean: -0.054221268743276596, mean p set: 0.4482189118862152
loss_pred:0.01706826314330101, decouple_loss:0.0011065098224207759
loss_pred:0.015886299312114716, decouple_loss:0.0010022999485954642
2023-05-02 18:49:26 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.0570453405380249, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.05346613749861717, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.05339188501238823, mean p set: 0.4500633478164673
loss_pred:0.018279816955327988, decouple_loss:0.0010746397310867906
loss_pred:0.017150210216641426, decouple_loss:0.0010654585203155875
loss_pred:0.017261911183595657, decouple_loss:0.0010959954233840108
WV_0_PC_1_EH_0_PS_40, loss: 0.01761791482567787, avg_mse: 0.025337625294923782
current test mse: 0.025338
Iteration: 4291, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45041823387145996, gen p mean: -0.04336586594581604, mean p set: 0.45089852809906006
The modified gen p mean: 0.4481624960899353, gen p mean: -0.04765518009662628, mean p set: 0.448642760515213
The modified gen p mean: 0.44871675968170166, gen p mean: -0.04276152327656746, mean p set: 0.44919705390930176
loss_pred:0.01624526083469391, decouple_loss:0.0010263617150485516
loss_pred:0.016699261963367462, decouple_loss:0.0012005205499008298
loss_pred:0.016901424154639244, decouple_loss:0.0010454007424414158
Iteration: 4292, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44882020354270935, gen p mean: -0.05315406620502472, mean p set: 0.44930049777030945
loss_pred:0.015951409935951233, decouple_loss:0.001118095126003027
The modified gen p mean: 0.44997620582580566, gen p mean: -0.04963928088545799, mean p set: 0.45045650005340576The modified gen p mean: 0.44883424043655396, gen p mean: -0.046598829329013824, mean p set: 0.44931453466415405
loss_pred:0.01675577275454998, decouple_loss:0.0009557546582072973
loss_pred:0.016048699617385864, decouple_loss:0.000979723292402923
Iteration: 4293, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45065709948539734, gen p mean: -0.044444046914577484, mean p set: 0.45113739371299744
loss_pred:0.01621176116168499, decouple_loss:0.0010644502472132444
The modified gen p mean: 0.449848473072052, gen p mean: -0.04441172257065773, mean p set: 0.4503287672996521The modified gen p mean: 0.44817909598350525, gen p mean: -0.042550310492515564, mean p set: 0.44865939021110535
loss_pred:0.01686796173453331, decouple_loss:0.0010131992166861892
loss_pred:0.016295937821269035, decouple_loss:0.0010278195841237903
Iteration: 4294, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492427706718445, gen p mean: -0.04163501411676407, mean p set: 0.4497230648994446
loss_pred:0.01673150435090065, decouple_loss:0.0009617180330678821
The modified gen p mean: 0.450557142496109, gen p mean: -0.0444784089922905, mean p set: 0.4510374367237091The modified gen p mean: 0.4502688944339752, gen p mean: -0.04029642045497894, mean p set: 0.4507491886615753
loss_pred:0.015978936105966568, decouple_loss:0.0010185460560023785
loss_pred:0.016383977606892586, decouple_loss:0.0010578240035101771
Iteration: 4295, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449825257062912, gen p mean: -0.04515248164534569, mean p set: 0.4503055810928345
loss_pred:0.016626449301838875, decouple_loss:0.0010943157831206918
The modified gen p mean: 0.44891878962516785, gen p mean: -0.04888578876852989, mean p set: 0.44939908385276794The modified gen p mean: 0.4509778916835785, gen p mean: -0.044721055775880814, mean p set: 0.451458215713501
loss_pred:0.016227535903453827, decouple_loss:0.0011544486042112112
loss_pred:0.015452367253601551, decouple_loss:0.0010071764700114727
Iteration: 4296, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496047794818878, gen p mean: -0.046021703630685806, mean p set: 0.4500850439071655
loss_pred:0.01606678031384945, decouple_loss:0.0011380108771845698
The modified gen p mean: 0.4484577775001526, gen p mean: -0.054016754031181335, mean p set: 0.4489381015300751The modified gen p mean: 0.45057058334350586, gen p mean: -0.040400970727205276, mean p set: 0.45105084776878357
loss_pred:0.016239462420344353, decouple_loss:0.0011111627100035548
loss_pred:0.016384242102503777, decouple_loss:0.001177836675196886
Iteration: 4297, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44977957010269165, gen p mean: -0.04458390921354294, mean p set: 0.45025986433029175
loss_pred:0.016361884772777557, decouple_loss:0.0009740197565406561
The modified gen p mean: 0.44959649443626404, gen p mean: -0.04589599743485451, mean p set: 0.45007678866386414
The modified gen p mean: 0.4504495859146118, gen p mean: -0.042534925043582916, mean p set: 0.4509299099445343
loss_pred:0.016943704336881638, decouple_loss:0.001169000519439578
loss_pred:0.016038639470934868, decouple_loss:0.0010798238217830658
Iteration: 4298, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44952043890953064, gen p mean: -0.042826078832149506, mean p set: 0.45000073313713074
loss_pred:0.015905223786830902, decouple_loss:0.0010337730636820197
The modified gen p mean: 0.45000165700912476, gen p mean: -0.04448413848876953, mean p set: 0.45048198103904724The modified gen p mean: 0.4476385712623596, gen p mean: -0.05131734907627106, mean p set: 0.44811883568763733
loss_pred:0.01620841585099697, decouple_loss:0.0010720478603616357
loss_pred:0.01633349619805813, decouple_loss:0.0011437403736636043
Iteration: 4299, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44779255986213684, gen p mean: -0.049357231706380844, mean p set: 0.44827285408973694
loss_pred:0.016732139512896538, decouple_loss:0.0009137241286225617
The modified gen p mean: 0.45036041736602783, gen p mean: -0.048570387065410614, mean p set: 0.45084071159362793The modified gen p mean: 0.4495847821235657, gen p mean: -0.044419560581445694, mean p set: 0.45006507635116577
loss_pred:0.01576933264732361, decouple_loss:0.0009744866983965039
loss_pred:0.017243219539523125, decouple_loss:0.0008911771001294255
Iteration: 4300, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497251510620117, gen p mean: -0.04423816129565239, mean p set: 0.4502054452896118
loss_pred:0.016409344971179962, decouple_loss:0.0010309142526239157
The modified gen p mean: 0.4485178291797638, gen p mean: -0.04520554468035698, mean p set: 0.4489981234073639The modified gen p mean: 0.4512498378753662, gen p mean: -0.04339894279837608, mean p set: 0.4517301619052887
loss_pred:0.015951212495565414, decouple_loss:0.0009964540367946029
loss_pred:0.01639336347579956, decouple_loss:0.0010167023865506053
2023-05-02 18:51:21 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.056003324687480927, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.05216075852513313, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.05226704105734825, mean p set: 0.4500633478164673
loss_pred:0.018244776874780655, decouple_loss:0.0011449111625552177
loss_pred:0.017112888395786285, decouple_loss:0.001247114734724164
loss_pred:0.017236659303307533, decouple_loss:0.0012753487098962069
WV_0_PC_1_EH_0_PS_40, loss: 0.01759256422519684, avg_mse: 0.025261318311095238
current test mse: 0.025261
Iteration: 4301, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44713103771209717, gen p mean: -0.05243314802646637, mean p set: 0.4476113021373749
The modified gen p mean: 0.4493057429790497, gen p mean: -0.04573027417063713, mean p set: 0.4497860372066498
The modified gen p mean: 0.4523296058177948, gen p mean: -0.04492773860692978, mean p set: 0.4528099000453949
loss_pred:0.01600082963705063, decouple_loss:0.0010053274454548955
loss_pred:0.01702324114739895, decouple_loss:0.0011877078795805573
loss_pred:0.016775324940681458, decouple_loss:0.0012749398592859507
Iteration: 4302, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488838016986847, gen p mean: -0.048374153673648834, mean p set: 0.4493641257286072
loss_pred:0.01567116379737854, decouple_loss:0.0011996307875961065
The modified gen p mean: 0.4519200921058655, gen p mean: -0.04872828349471092, mean p set: 0.4524003565311432The modified gen p mean: 0.44890162348747253, gen p mean: -0.045076195150613785, mean p set: 0.44938188791275024
loss_pred:0.015863880515098572, decouple_loss:0.0009951174724847078
loss_pred:0.016290146857500076, decouple_loss:0.0010009927209466696
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012012_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012012_3_24hr.npz
NaN value num: 0
Iteration: 4303, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44838908314704895, gen p mean: -0.0603446438908577, mean p set: 0.44886934757232666
loss_pred:0.014712733216583729, decouple_loss:0.0009717032080516219
The modified gen p mean: 0.446382999420166, gen p mean: -0.057513147592544556, mean p set: 0.4468632936477661The modified gen p mean: 0.44743579626083374, gen p mean: -0.05648672208189964, mean p set: 0.44791606068611145
loss_pred:0.01519303023815155, decouple_loss:0.0011681487085297704
loss_pred:0.014348825439810753, decouple_loss:0.00107210548594594
Iteration: 4304, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44732311367988586, gen p mean: -0.06016552448272705, mean p set: 0.44780340790748596
loss_pred:0.014439918100833893, decouple_loss:0.0010253078071400523
The modified gen p mean: 0.44812092185020447, gen p mean: -0.05939241126179695, mean p set: 0.44860121607780457The modified gen p mean: 0.4469078481197357, gen p mean: -0.06463725119829178, mean p set: 0.4473881721496582
loss_pred:0.013774695806205273, decouple_loss:0.001146922237239778
loss_pred:0.014530354179441929, decouple_loss:0.0010754317045211792
Iteration: 4305, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448669970035553, gen p mean: -0.06339143216609955, mean p set: 0.4491502642631531
loss_pred:0.015175855718553066, decouple_loss:0.0013877111487090588
The modified gen p mean: 0.44773608446121216, gen p mean: -0.0628422275185585, mean p set: 0.44821637868881226The modified gen p mean: 0.4478985369205475, gen p mean: -0.06254728883504868, mean p set: 0.4483788311481476
loss_pred:0.014726829715073109, decouple_loss:0.0012321079848334193
loss_pred:0.014756686985492706, decouple_loss:0.0012268966529518366
Iteration: 4306, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477331042289734, gen p mean: -0.06113734468817711, mean p set: 0.4482133686542511
loss_pred:0.0142725370824337, decouple_loss:0.001141068642027676
The modified gen p mean: 0.4472866356372833, gen p mean: -0.06751319766044617, mean p set: 0.4477669298648834The modified gen p mean: 0.4456293284893036, gen p mean: -0.06001202017068863, mean p set: 0.4461096227169037
loss_pred:0.014285441488027573, decouple_loss:0.001101352390833199
loss_pred:0.014229152351617813, decouple_loss:0.0011635459959506989
Iteration: 4307, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44790810346603394, gen p mean: -0.06004450097680092, mean p set: 0.44838836789131165
loss_pred:0.013738814741373062, decouple_loss:0.001140109496191144
The modified gen p mean: 0.4484599530696869, gen p mean: -0.0637868270277977, mean p set: 0.448940247297287The modified gen p mean: 0.4475523829460144, gen p mean: -0.05921574681997299, mean p set: 0.4480327069759369
loss_pred:0.014716236852109432, decouple_loss:0.0010665085865184665
loss_pred:0.01387767307460308, decouple_loss:0.001089473138563335
Iteration: 4308, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467793107032776, gen p mean: -0.057430148124694824, mean p set: 0.4472596049308777
loss_pred:0.01392754353582859, decouple_loss:0.001071881502866745
The modified gen p mean: 0.4477849304676056, gen p mean: -0.0567290224134922, mean p set: 0.4482652246952057The modified gen p mean: 0.4486526548862457, gen p mean: -0.05443603917956352, mean p set: 0.44913291931152344
loss_pred:0.014420226216316223, decouple_loss:0.0010787638602778316
loss_pred:0.014665333554148674, decouple_loss:0.0011012370232492685
Iteration: 4309, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474908113479614, gen p mean: -0.058927468955516815, mean p set: 0.4479711353778839
loss_pred:0.013955584727227688, decouple_loss:0.0011382217053323984
The modified gen p mean: 0.4480159282684326, gen p mean: -0.05070263147354126, mean p set: 0.4484962224960327The modified gen p mean: 0.44769424200057983, gen p mean: -0.05926213040947914, mean p set: 0.44817450642585754
loss_pred:0.01415823120623827, decouple_loss:0.0010676317615434527
loss_pred:0.013975716196000576, decouple_loss:0.0013185336720198393
Iteration: 4310, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468739330768585, gen p mean: -0.051658060401678085, mean p set: 0.4473542869091034
loss_pred:0.01372013334184885, decouple_loss:0.0011424896074458957
The modified gen p mean: 0.44628408551216125, gen p mean: -0.050548005849123, mean p set: 0.44676437973976135The modified gen p mean: 0.4478202760219574, gen p mean: -0.05549084022641182, mean p set: 0.4483005702495575
loss_pred:0.013841584324836731, decouple_loss:0.001309781102463603
loss_pred:0.014268948696553707, decouple_loss:0.001224448555149138
2023-05-02 18:53:58 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.054051097482442856, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.05036185309290886, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.05044073611497879, mean p set: 0.4500633478164673
loss_pred:0.019195158034563065, decouple_loss:0.0012928294017910957loss_pred:0.01797626167535782, decouple_loss:0.0012307724682614207
loss_pred:0.01806340552866459, decouple_loss:0.001215762342326343
WV_0_PC_1_EH_0_PS_40, loss: 0.018473930656909943, avg_mse: 0.02694539539515972
current test mse: 0.026945
Iteration: 4311, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44730570912361145, gen p mean: -0.0552242137491703, mean p set: 0.44778600335121155
The modified gen p mean: 0.4472869336605072, gen p mean: -0.05453358590602875, mean p set: 0.4477671980857849
The modified gen p mean: 0.44869038462638855, gen p mean: -0.04885350912809372, mean p set: 0.44917070865631104
loss_pred:0.01418280228972435, decouple_loss:0.001138806575909257
loss_pred:0.01383078284561634, decouple_loss:0.001138487714342773
loss_pred:0.013621857389807701, decouple_loss:0.0011493556667119265
Iteration: 4312, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474269449710846, gen p mean: -0.046024106442928314, mean p set: 0.4479072690010071
loss_pred:0.014490358531475067, decouple_loss:0.0013141899835318327
The modified gen p mean: 0.44803979992866516, gen p mean: -0.051404163241386414, mean p set: 0.44852009415626526The modified gen p mean: 0.4474409818649292, gen p mean: -0.049588318914175034, mean p set: 0.4479212760925293
loss_pred:0.013751141726970673, decouple_loss:0.0012204207014292479
loss_pred:0.013638965785503387, decouple_loss:0.0012284157564863563
Iteration: 4313, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467921853065491, gen p mean: -0.047498058527708054, mean p set: 0.44727250933647156
loss_pred:0.01377839408814907, decouple_loss:0.001273614470846951
The modified gen p mean: 0.4477180242538452, gen p mean: -0.045982543379068375, mean p set: 0.4481982886791229The modified gen p mean: 0.447234183549881, gen p mean: -0.04736169055104256, mean p set: 0.4477144777774811
loss_pred:0.013768852688372135, decouple_loss:0.0011803689412772655
loss_pred:0.013399231247603893, decouple_loss:0.0012830140767619014
Iteration: 4314, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470370411872864, gen p mean: -0.047271475195884705, mean p set: 0.4475173056125641
loss_pred:0.013831239193677902, decouple_loss:0.00132722535636276
The modified gen p mean: 0.4474744498729706, gen p mean: -0.0463937446475029, mean p set: 0.4479547441005707The modified gen p mean: 0.44597822427749634, gen p mean: -0.04708370938897133, mean p set: 0.44645851850509644
loss_pred:0.013393176719546318, decouple_loss:0.0012180013582110405
loss_pred:0.0135529525578022, decouple_loss:0.0011325443629175425
Iteration: 4315, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44752028584480286, gen p mean: -0.04958377778530121, mean p set: 0.44800058007240295
loss_pred:0.012957202270627022, decouple_loss:0.001288385596126318
The modified gen p mean: 0.44876790046691895, gen p mean: -0.04861786216497421, mean p set: 0.44924822449684143The modified gen p mean: 0.44720256328582764, gen p mean: -0.052186518907547, mean p set: 0.4476828873157501
loss_pred:0.013504617847502232, decouple_loss:0.0014692078111693263
loss_pred:0.013405187986791134, decouple_loss:0.0014517833478748798
Iteration: 4316, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44765475392341614, gen p mean: -0.05634043365716934, mean p set: 0.44813501834869385
loss_pred:0.013929994776844978, decouple_loss:0.0011926826555281878
The modified gen p mean: 0.4469403624534607, gen p mean: -0.05643517151474953, mean p set: 0.4474206268787384The modified gen p mean: 0.44647809863090515, gen p mean: -0.05577744543552399, mean p set: 0.44695839285850525
loss_pred:0.013289283961057663, decouple_loss:0.001158095896244049
loss_pred:0.013918246142566204, decouple_loss:0.0012910946970805526
Iteration: 4317, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476092755794525, gen p mean: -0.05216582119464874, mean p set: 0.4480895698070526
loss_pred:0.013476153835654259, decouple_loss:0.0011518093524500728
The modified gen p mean: 0.44889017939567566, gen p mean: -0.05534214526414871, mean p set: 0.44937047362327576The modified gen p mean: 0.44814231991767883, gen p mean: -0.056020338088274, mean p set: 0.44862261414527893
loss_pred:0.01456522848457098, decouple_loss:0.001181303639896214
loss_pred:0.013187791220843792, decouple_loss:0.0012125979410484433
Iteration: 4318, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44741907715797424, gen p mean: -0.05591680854558945, mean p set: 0.44789940118789673
loss_pred:0.014132536947727203, decouple_loss:0.0012847821926698089
The modified gen p mean: 0.4477033019065857, gen p mean: -0.0551699697971344, mean p set: 0.4481835961341858The modified gen p mean: 0.4476260542869568, gen p mean: -0.05721600353717804, mean p set: 0.4481063485145569
loss_pred:0.013918965123593807, decouple_loss:0.0012462600134313107
loss_pred:0.014025955460965633, decouple_loss:0.0012936037965118885
Iteration: 4319, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469599425792694, gen p mean: -0.06028961017727852, mean p set: 0.4474402070045471
loss_pred:0.013681011274456978, decouple_loss:0.0012734036426991224
The modified gen p mean: 0.4477022588253021, gen p mean: -0.052521150559186935, mean p set: 0.4481825828552246The modified gen p mean: 0.4471847116947174, gen p mean: -0.05832677334547043, mean p set: 0.4476650059223175
loss_pred:0.013300294987857342, decouple_loss:0.0011447512079030275
loss_pred:0.013395880348980427, decouple_loss:0.0011714947177097201
Iteration: 4320, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44864141941070557, gen p mean: -0.04812835901975632, mean p set: 0.4491216838359833
loss_pred:0.013381010852754116, decouple_loss:0.001138526713475585
The modified gen p mean: 0.44789817929267883, gen p mean: -0.052508819848299026, mean p set: 0.44837847352027893The modified gen p mean: 0.4470200538635254, gen p mean: -0.05539591610431671, mean p set: 0.4475003480911255
loss_pred:0.013135877437889576, decouple_loss:0.0010986564448103309
loss_pred:0.013437559828162193, decouple_loss:0.001057909452356398
2023-05-02 18:55:52 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.05368604511022568, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.049990031868219376, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04987330362200737, mean p set: 0.4500633478164673
loss_pred:0.01903347671031952, decouple_loss:0.0012253595050424337
loss_pred:0.01783261075615883, decouple_loss:0.0011187404161319137
loss_pred:0.017915595322847366, decouple_loss:0.001135988743044436
WV_0_PC_1_EH_0_PS_40, loss: 0.01831856369972229, avg_mse: 0.026713499799370766
current test mse: 0.026714
Iteration: 4321, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44812050461769104, gen p mean: -0.04790076985955238, mean p set: 0.44860079884529114
The modified gen p mean: 0.44654789566993713, gen p mean: -0.053331464529037476, mean p set: 0.4470282196998596
The modified gen p mean: 0.446853905916214, gen p mean: -0.05474493280053139, mean p set: 0.4473342299461365
loss_pred:0.013729225844144821, decouple_loss:0.0011211840901523829
loss_pred:0.01404996681958437, decouple_loss:0.0011975517263635993
loss_pred:0.013487188145518303, decouple_loss:0.001070657977834344
Iteration: 4322, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44849735498428345, gen p mean: -0.04952836036682129, mean p set: 0.44897761940956116
loss_pred:0.013120955787599087, decouple_loss:0.0010983594693243504
The modified gen p mean: 0.4481739103794098, gen p mean: -0.04843193665146828, mean p set: 0.4486541748046875The modified gen p mean: 0.4478236734867096, gen p mean: -0.04921634867787361, mean p set: 0.4483039677143097
loss_pred:0.014065450057387352, decouple_loss:0.0010877030435949564
loss_pred:0.012748182751238346, decouple_loss:0.0011303938226774335
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012005_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012005_3_24hr.npz
NaN value num: 0
Iteration: 4323, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4518020749092102, gen p mean: -0.03964746743440628, mean p set: 0.4522823691368103
loss_pred:0.01530927512794733, decouple_loss:0.0012246659025549889
The modified gen p mean: 0.452146053314209, gen p mean: -0.04101823642849922, mean p set: 0.45262637734413147The modified gen p mean: 0.4513419568538666, gen p mean: -0.03801574930548668, mean p set: 0.4518222510814667
loss_pred:0.015280310995876789, decouple_loss:0.0011738113826140761
loss_pred:0.015333357267081738, decouple_loss:0.0011041389079764485
Iteration: 4324, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4524059295654297, gen p mean: -0.04241310805082321, mean p set: 0.4528862237930298
loss_pred:0.01447097584605217, decouple_loss:0.0011849970323964953
The modified gen p mean: 0.4520016610622406, gen p mean: -0.040883198380470276, mean p set: 0.4524819552898407
The modified gen p mean: 0.45363762974739075, gen p mean: -0.046010639518499374, mean p set: 0.45411795377731323
loss_pred:0.01572459004819393, decouple_loss:0.0012756094802170992
loss_pred:0.01454222947359085, decouple_loss:0.0011358322808519006
Iteration: 4325, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.452714741230011, gen p mean: -0.04025685787200928, mean p set: 0.4531950354576111
loss_pred:0.015720266848802567, decouple_loss:0.001169345690868795
The modified gen p mean: 0.45134809613227844, gen p mean: -0.039307158440351486, mean p set: 0.4518284201622009The modified gen p mean: 0.45305269956588745, gen p mean: -0.03939776122570038, mean p set: 0.45353299379348755
loss_pred:0.015043392777442932, decouple_loss:0.0010409917449578643
loss_pred:0.015502581372857094, decouple_loss:0.0010540366638451815
Iteration: 4326, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45258545875549316, gen p mean: -0.0341985784471035, mean p set: 0.4530657231807709
loss_pred:0.014721821062266827, decouple_loss:0.0009814957156777382
The modified gen p mean: 0.45311427116394043, gen p mean: -0.04310428351163864, mean p set: 0.4535945653915405The modified gen p mean: 0.45253878831863403, gen p mean: -0.037245288491249084, mean p set: 0.4530191123485565
loss_pred:0.01397203654050827, decouple_loss:0.001002174918539822
loss_pred:0.0157511867582798, decouple_loss:0.001044287346303463
Iteration: 4327, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45301079750061035, gen p mean: -0.03550658002495766, mean p set: 0.45349109172821045
loss_pred:0.014767925255000591, decouple_loss:0.0010708123445510864
The modified gen p mean: 0.45231375098228455, gen p mean: -0.03511122986674309, mean p set: 0.45279404520988464The modified gen p mean: 0.4518902897834778, gen p mean: -0.03361263498663902, mean p set: 0.4523705840110779
loss_pred:0.01481072511523962, decouple_loss:0.0010804791236296296
loss_pred:0.01561746932566166, decouple_loss:0.0011494836071506143
Iteration: 4328, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4527427554130554, gen p mean: -0.03100629523396492, mean p set: 0.45322301983833313
loss_pred:0.014084472320973873, decouple_loss:0.0010960933286696672
The modified gen p mean: 0.453250527381897, gen p mean: -0.03233365714550018, mean p set: 0.45373082160949707The modified gen p mean: 0.45416387915611267, gen p mean: -0.025395823642611504, mean p set: 0.45464417338371277
loss_pred:0.013752354308962822, decouple_loss:0.001110980985686183
loss_pred:0.015687214210629463, decouple_loss:0.0011530476622283459
Iteration: 4329, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.452559232711792, gen p mean: -0.027482619509100914, mean p set: 0.4530394971370697
loss_pred:0.015044656582176685, decouple_loss:0.0010573024628683925
The modified gen p mean: 0.45179283618927, gen p mean: -0.03135017305612564, mean p set: 0.45227310061454773The modified gen p mean: 0.4541069567203522, gen p mean: -0.03135305270552635, mean p set: 0.45458728075027466
loss_pred:0.015168696641921997, decouple_loss:0.0010652159107849002
loss_pred:0.015909146517515182, decouple_loss:0.001207471126690507
Iteration: 4330, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4529833197593689, gen p mean: -0.030426176264882088, mean p set: 0.4534636437892914
loss_pred:0.015815725550055504, decouple_loss:0.0013921314384788275
The modified gen p mean: 0.452231764793396, gen p mean: -0.027352355420589447, mean p set: 0.4527120590209961The modified gen p mean: 0.45190414786338806, gen p mean: -0.026449695229530334, mean p set: 0.45238441228866577
loss_pred:0.015312664210796356, decouple_loss:0.0010801497846841812
loss_pred:0.014317980036139488, decouple_loss:0.0011754761217162013
2023-05-02 18:58:37 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.03649396076798439, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.03303827345371246, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.03276227414608002, mean p set: 0.4500633478164673
loss_pred:0.01874975860118866, decouple_loss:0.001465815817937255
loss_pred:0.017586439847946167, decouple_loss:0.00130641704890877
loss_pred:0.017721550539135933, decouple_loss:0.0013703611912205815
WV_0_PC_1_EH_0_PS_40, loss: 0.018088292330503464, avg_mse: 0.02624262124300003
current test mse: 0.026243
Iteration: 4331, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4533199667930603, gen p mean: -0.028313878923654556, mean p set: 0.4538002610206604
The modified gen p mean: 0.4520866572856903, gen p mean: -0.03111634962260723, mean p set: 0.4525669813156128
The modified gen p mean: 0.4529091417789459, gen p mean: -0.028133779764175415, mean p set: 0.45338940620422363
loss_pred:0.014867800287902355, decouple_loss:0.001223226310685277
loss_pred:0.014819957315921783, decouple_loss:0.0012522282777354121
loss_pred:0.015513367019593716, decouple_loss:0.001188957248814404
Iteration: 4332, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45121005177497864, gen p mean: -0.02705538459122181, mean p set: 0.45169031620025635
loss_pred:0.015007833018898964, decouple_loss:0.0010923752561211586
The modified gen p mean: 0.45258501172065735, gen p mean: -0.024593565613031387, mean p set: 0.45306530594825745The modified gen p mean: 0.4524298310279846, gen p mean: -0.01999458484351635, mean p set: 0.4529101252555847
loss_pred:0.014513778500258923, decouple_loss:0.0010557458736002445
loss_pred:0.014084025286138058, decouple_loss:0.0010449136607348919
Iteration: 4333, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513065814971924, gen p mean: -0.02281309850513935, mean p set: 0.4517868459224701
loss_pred:0.014680047519505024, decouple_loss:0.0010455023730173707
The modified gen p mean: 0.4519331455230713, gen p mean: -0.027911994606256485, mean p set: 0.4524134397506714The modified gen p mean: 0.45320364832878113, gen p mean: -0.030631445348262787, mean p set: 0.4536839425563812
loss_pred:0.014100084081292152, decouple_loss:0.0011132858926430345
loss_pred:0.016173014417290688, decouple_loss:0.001155979000031948
Iteration: 4334, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45199087262153625, gen p mean: -0.031597089022397995, mean p set: 0.45247119665145874
loss_pred:0.015476490370929241, decouple_loss:0.0010511312866583467
The modified gen p mean: 0.4525059163570404, gen p mean: -0.031506508588790894, mean p set: 0.4529862403869629The modified gen p mean: 0.45313456654548645, gen p mean: -0.035649411380290985, mean p set: 0.45361486077308655
loss_pred:0.013934602029621601, decouple_loss:0.0010452353162690997
loss_pred:0.014150893315672874, decouple_loss:0.0009970898972824216
Iteration: 4335, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45320218801498413, gen p mean: -0.039515238255262375, mean p set: 0.45368245244026184
loss_pred:0.014936978928744793, decouple_loss:0.001054024207405746
The modified gen p mean: 0.45272383093833923, gen p mean: -0.03824120759963989, mean p set: 0.45320409536361694The modified gen p mean: 0.45484495162963867, gen p mean: -0.03375224769115448, mean p set: 0.4553252160549164
loss_pred:0.015295843593776226, decouple_loss:0.0011069360189139843
loss_pred:0.01535019837319851, decouple_loss:0.0010706019820645452
Iteration: 4336, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4527265727519989, gen p mean: -0.043474942445755005, mean p set: 0.453206866979599
loss_pred:0.013837498612701893, decouple_loss:0.0010268008336424828
The modified gen p mean: 0.4519527554512024, gen p mean: -0.037831760942935944, mean p set: 0.4524330198764801The modified gen p mean: 0.4525115489959717, gen p mean: -0.03831592947244644, mean p set: 0.4529918134212494
loss_pred:0.014813856221735477, decouple_loss:0.0010206016013398767
loss_pred:0.015947548672556877, decouple_loss:0.0010938557097688317
Iteration: 4337, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4516180157661438, gen p mean: -0.048215266317129135, mean p set: 0.4520983099937439
loss_pred:0.01533640455454588, decouple_loss:0.001164609449915588
The modified gen p mean: 0.45210444927215576, gen p mean: -0.040840212255716324, mean p set: 0.45258474349975586
The modified gen p mean: 0.45377808809280396, gen p mean: -0.03743163123726845, mean p set: 0.45425835251808167
loss_pred:0.015961220487952232, decouple_loss:0.001012203167192638
loss_pred:0.015377288684248924, decouple_loss:0.0011365897953510284
Iteration: 4338, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4526849389076233, gen p mean: -0.03662833571434021, mean p set: 0.4531652331352234
loss_pred:0.0153012340888381, decouple_loss:0.0013092556037008762
The modified gen p mean: 0.4531157910823822, gen p mean: -0.043502338230609894, mean p set: 0.4535960853099823The modified gen p mean: 0.4516844153404236, gen p mean: -0.044359851628541946, mean p set: 0.4521646797657013
loss_pred:0.014776098541915417, decouple_loss:0.00106800626963377
loss_pred:0.01701314002275467, decouple_loss:0.0011274568969383836
Iteration: 4339, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4515909254550934, gen p mean: -0.03722170367836952, mean p set: 0.4520712196826935
loss_pred:0.014723672531545162, decouple_loss:0.0009684960241429508
The modified gen p mean: 0.4535497725009918, gen p mean: -0.041567325592041016, mean p set: 0.4540300667285919The modified gen p mean: 0.4527815580368042, gen p mean: -0.04028775542974472, mean p set: 0.4532618522644043
loss_pred:0.014883398078382015, decouple_loss:0.000944551604334265
loss_pred:0.01618393510580063, decouple_loss:0.001002478413283825
Iteration: 4340, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4542931020259857, gen p mean: -0.035101260989904404, mean p set: 0.4547733962535858
loss_pred:0.015441161580383778, decouple_loss:0.001126301009207964
The modified gen p mean: 0.4525229036808014, gen p mean: -0.039374951273202896, mean p set: 0.4530031979084015The modified gen p mean: 0.4527721405029297, gen p mean: -0.04293234273791313, mean p set: 0.4532524347305298
loss_pred:0.015318119898438454, decouple_loss:0.0011921487748622894
loss_pred:0.014619107358157635, decouple_loss:0.0010887840762734413
2023-05-02 19:00:32 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.04950180649757385, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.0458335317671299, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.045772165060043335, mean p set: 0.4500633478164673
loss_pred:0.018726719543337822, decouple_loss:0.0014442522078752518
loss_pred:0.01757567934691906, decouple_loss:0.001321193529292941
loss_pred:0.01768825575709343, decouple_loss:0.0013168163131922483
WV_0_PC_1_EH_0_PS_40, loss: 0.018064923584461212, avg_mse: 0.026184218004345894
current test mse: 0.026184
Iteration: 4341, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.452451229095459, gen p mean: -0.03271451219916344, mean p set: 0.4529314935207367
The modified gen p mean: 0.4522419273853302, gen p mean: -0.04002082347869873, mean p set: 0.4527222514152527
The modified gen p mean: 0.45237550139427185, gen p mean: -0.038930632174015045, mean p set: 0.45285579562187195
loss_pred:0.015515065751969814, decouple_loss:0.0011830945732071996
loss_pred:0.01437088567763567, decouple_loss:0.0011963191209360957
loss_pred:0.014523020945489407, decouple_loss:0.001187517773360014
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012007_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012007_3_24hr.npz
NaN value num: 0
Iteration: 4342, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449989914894104, gen p mean: -0.039750922471284866, mean p set: 0.4504702091217041
loss_pred:0.015480844303965569, decouple_loss:0.001113825710490346
The modified gen p mean: 0.44951069355010986, gen p mean: -0.04361267760396004, mean p set: 0.44999101758003235The modified gen p mean: 0.44851192831993103, gen p mean: -0.04045085981488228, mean p set: 0.44899222254753113
loss_pred:0.01508372463285923, decouple_loss:0.0011876588687300682
loss_pred:0.014238462783396244, decouple_loss:0.0012148721143603325
Iteration: 4343, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504282474517822, gen p mean: -0.03590197116136551, mean p set: 0.4509085714817047
loss_pred:0.01525984238833189, decouple_loss:0.0010494517628103495
The modified gen p mean: 0.4485502243041992, gen p mean: -0.04401114955544472, mean p set: 0.44903048872947693The modified gen p mean: 0.4476590156555176, gen p mean: -0.04065356031060219, mean p set: 0.4481392800807953
loss_pred:0.014992209151387215, decouple_loss:0.0010332876117900014
loss_pred:0.014769886620342731, decouple_loss:0.001107922405935824
Iteration: 4344, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494897723197937, gen p mean: -0.0373108945786953, mean p set: 0.4499700367450714
loss_pred:0.015188862569630146, decouple_loss:0.0011499333195388317
The modified gen p mean: 0.44813019037246704, gen p mean: -0.04051578789949417, mean p set: 0.44861045479774475The modified gen p mean: 0.4492669999599457, gen p mean: -0.0396006740629673, mean p set: 0.4497472941875458
loss_pred:0.01489859726279974, decouple_loss:0.0009624994709156454
loss_pred:0.014721766114234924, decouple_loss:0.0010880150366574526
Iteration: 4345, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45045509934425354, gen p mean: -0.037112489342689514, mean p set: 0.45093539357185364
loss_pred:0.015447110868990421, decouple_loss:0.0010618550004437566
The modified gen p mean: 0.4487535357475281, gen p mean: -0.04086291790008545, mean p set: 0.4492338001728058The modified gen p mean: 0.4501855969429016, gen p mean: -0.03362814337015152, mean p set: 0.4506658911705017
loss_pred:0.01475036796182394, decouple_loss:0.0010521027725189924
loss_pred:0.01482597179710865, decouple_loss:0.0010507723782211542
Iteration: 4346, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44839417934417725, gen p mean: -0.03745434433221817, mean p set: 0.44887450337409973
loss_pred:0.014444633387029171, decouple_loss:0.0010436057345941663
The modified gen p mean: 0.4488302171230316, gen p mean: -0.0397091880440712, mean p set: 0.4493105113506317The modified gen p mean: 0.449098140001297, gen p mean: -0.03887474164366722, mean p set: 0.4495784640312195
loss_pred:0.01536084059625864, decouple_loss:0.001023453427478671
loss_pred:0.015127875842154026, decouple_loss:0.0009999144822359085
Iteration: 4347, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448742538690567, gen p mean: -0.03793647885322571, mean p set: 0.4492228329181671
The modified gen p mean: 0.4483434557914734, gen p mean: -0.03913118690252304, mean p set: 0.4488237500190735loss_pred:0.015052798204123974, decouple_loss:0.0012444669846445322
The modified gen p mean: 0.44936704635620117, gen p mean: -0.04276908189058304, mean p set: 0.44984734058380127
loss_pred:0.015049781650304794, decouple_loss:0.0010640533873811364
loss_pred:0.015336171723902225, decouple_loss:0.0012115960707888007
Iteration: 4348, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497455358505249, gen p mean: -0.04173799231648445, mean p set: 0.450225830078125
The modified gen p mean: 0.44907498359680176, gen p mean: -0.03599332273006439, mean p set: 0.44955530762672424
loss_pred:0.015773223713040352, decouple_loss:0.0011018597288057208
loss_pred:0.014613363891839981, decouple_loss:0.0012306614080443978
The modified gen p mean: 0.4479636251926422, gen p mean: -0.04269328713417053, mean p set: 0.4484439492225647
loss_pred:0.014567101374268532, decouple_loss:0.0011166975600644946
Iteration: 4349, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448365181684494, gen p mean: -0.04316040128469467, mean p set: 0.4488454759120941
loss_pred:0.015110954642295837, decouple_loss:0.0012556007131934166
The modified gen p mean: 0.44779276847839355, gen p mean: -0.0380631648004055, mean p set: 0.44827306270599365The modified gen p mean: 0.4486050605773926, gen p mean: -0.04380665719509125, mean p set: 0.4490853548049927
loss_pred:0.014714041724801064, decouple_loss:0.0012112396070733666
loss_pred:0.014454010874032974, decouple_loss:0.0012067225761711597
Iteration: 4350, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44841963052749634, gen p mean: -0.04193779453635216, mean p set: 0.44889989495277405
loss_pred:0.01488815899938345, decouple_loss:0.001110545708797872
The modified gen p mean: 0.4502352774143219, gen p mean: -0.03885443136096001, mean p set: 0.4507155418395996The modified gen p mean: 0.45073336362838745, gen p mean: -0.03822745010256767, mean p set: 0.45121368765830994
loss_pred:0.01432802714407444, decouple_loss:0.001216031494550407
loss_pred:0.013962909579277039, decouple_loss:0.001214197021909058
2023-05-02 19:03:05 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.052072834223508835, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04873151704668999, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.048517655581235886, mean p set: 0.4500633478164673
loss_pred:0.018742799758911133, decouple_loss:0.001175841549411416
loss_pred:0.017628498375415802, decouple_loss:0.0012971436372026801
loss_pred:0.017690561711788177, decouple_loss:0.0012192216236144304
WV_0_PC_1_EH_0_PS_40, loss: 0.018082156777381897, avg_mse: 0.026230668649077415
current test mse: 0.026231
Iteration: 4351, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45030298829078674, gen p mean: -0.042968712747097015, mean p set: 0.45078325271606445
The modified gen p mean: 0.450958251953125, gen p mean: -0.043675582855939865, mean p set: 0.4514385461807251
The modified gen p mean: 0.45005929470062256, gen p mean: -0.046390313655138016, mean p set: 0.4505395293235779
loss_pred:0.015616490505635738, decouple_loss:0.0012890549842268229
loss_pred:0.015162170864641666, decouple_loss:0.001238219439983368
loss_pred:0.015315407887101173, decouple_loss:0.0011914476053789258
Iteration: 4352, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44856709241867065, gen p mean: -0.042152244597673416, mean p set: 0.44904738664627075
loss_pred:0.015316257253289223, decouple_loss:0.0010107957059517503
The modified gen p mean: 0.4489796757698059, gen p mean: -0.042969442903995514, mean p set: 0.4494599997997284The modified gen p mean: 0.4501005709171295, gen p mean: -0.042240649461746216, mean p set: 0.4505808651447296
loss_pred:0.01506914384663105, decouple_loss:0.0010925510432571173
loss_pred:0.014801965095102787, decouple_loss:0.0010210368782281876
Iteration: 4353, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44930654764175415, gen p mean: -0.046222127974033356, mean p set: 0.44978684186935425
loss_pred:0.014606417156755924, decouple_loss:0.0011808550916612148
The modified gen p mean: 0.4493542015552521, gen p mean: -0.04234321042895317, mean p set: 0.44983452558517456The modified gen p mean: 0.44812923669815063, gen p mean: -0.04118843749165535, mean p set: 0.44860953092575073
loss_pred:0.015105926431715488, decouple_loss:0.0011229541851207614
loss_pred:0.014582183212041855, decouple_loss:0.001166925416328013
Iteration: 4354, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44732367992401123, gen p mean: -0.037248093634843826, mean p set: 0.44780394434928894
loss_pred:0.014588355086743832, decouple_loss:0.001190990093164146
The modified gen p mean: 0.44888585805892944, gen p mean: -0.04461004585027695, mean p set: 0.44936615228652954The modified gen p mean: 0.45088982582092285, gen p mean: -0.03927132487297058, mean p set: 0.45137009024620056
loss_pred:0.014656543731689453, decouple_loss:0.0013394561829045415
loss_pred:0.0135920699685812, decouple_loss:0.0012753509217873216
Iteration: 4355, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504678249359131, gen p mean: -0.03663335368037224, mean p set: 0.4509481191635132
loss_pred:0.015183349139988422, decouple_loss:0.0011841913219541311
The modified gen p mean: 0.44918200373649597, gen p mean: -0.04367225244641304, mean p set: 0.4496622681617737The modified gen p mean: 0.45016512274742126, gen p mean: -0.03695656731724739, mean p set: 0.45064541697502136
loss_pred:0.014884735457599163, decouple_loss:0.0011642734752967954
loss_pred:0.014529627747833729, decouple_loss:0.0011095007648691535
Iteration: 4356, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501960277557373, gen p mean: -0.03992182016372681, mean p set: 0.4506763517856598
loss_pred:0.01491833571344614, decouple_loss:0.001259413082152605
The modified gen p mean: 0.44873547554016113, gen p mean: -0.03980477154254913, mean p set: 0.44921573996543884The modified gen p mean: 0.4492523670196533, gen p mean: -0.04272052273154259, mean p set: 0.4497326612472534
loss_pred:0.014204919338226318, decouple_loss:0.0012755519710481167
loss_pred:0.015428531914949417, decouple_loss:0.001314594061113894
Iteration: 4357, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44946929812431335, gen p mean: -0.03730929270386696, mean p set: 0.44994959235191345
loss_pred:0.014982513152062893, decouple_loss:0.0012274078326299787
The modified gen p mean: 0.45119160413742065, gen p mean: -0.03783034905791283, mean p set: 0.45167189836502075The modified gen p mean: 0.448661208152771, gen p mean: -0.036036714911460876, mean p set: 0.4491414725780487
loss_pred:0.01497167069464922, decouple_loss:0.0011550851631909609
loss_pred:0.014217589981853962, decouple_loss:0.0012046488700434566
Iteration: 4358, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45000436902046204, gen p mean: -0.040427010506391525, mean p set: 0.45048466324806213
loss_pred:0.01477799005806446, decouple_loss:0.0012680463260039687
The modified gen p mean: 0.4483919143676758, gen p mean: -0.03829089179635048, mean p set: 0.4488722085952759The modified gen p mean: 0.4487841725349426, gen p mean: -0.04027938470244408, mean p set: 0.4492644667625427
loss_pred:0.014852591790258884, decouple_loss:0.0012781716650351882
loss_pred:0.014687638729810715, decouple_loss:0.0012069225776940584
Iteration: 4359, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482846260070801, gen p mean: -0.042758964002132416, mean p set: 0.44876495003700256
loss_pred:0.01480038184672594, decouple_loss:0.0011934827780351043
The modified gen p mean: 0.4500577747821808, gen p mean: -0.040037814527750015, mean p set: 0.4505380690097809The modified gen p mean: 0.45050185918807983, gen p mean: -0.037929967045784, mean p set: 0.45098215341567993
loss_pred:0.014626364223659039, decouple_loss:0.0012165945954620838
loss_pred:0.015516002662479877, decouple_loss:0.0011390995932742953
Iteration: 4360, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494553804397583, gen p mean: -0.03972439840435982, mean p set: 0.4499356150627136
loss_pred:0.01471533440053463, decouple_loss:0.00115519342944026
The modified gen p mean: 0.4500219225883484, gen p mean: -0.03917109593749046, mean p set: 0.4505022168159485The modified gen p mean: 0.44951292872428894, gen p mean: -0.04309488832950592, mean p set: 0.44999319314956665
loss_pred:0.01506185345351696, decouple_loss:0.0011589491041377187
loss_pred:0.014654629863798618, decouple_loss:0.0010937507031485438
2023-05-02 19:05:00 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.052858032286167145, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04964420571923256, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04963421821594238, mean p set: 0.4500633478164673
loss_pred:0.018721703439950943, decouple_loss:0.0013602727558463812
loss_pred:0.017625916749238968, decouple_loss:0.0014689367963001132
loss_pred:0.017680227756500244, decouple_loss:0.0014344148803502321
WV_0_PC_1_EH_0_PS_40, loss: 0.018080344423651695, avg_mse: 0.026226840913295746
current test mse: 0.026227
Iteration: 4361, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45038244128227234, gen p mean: -0.045201823115348816, mean p set: 0.45086273550987244
The modified gen p mean: 0.4498671889305115, gen p mean: -0.04053550586104393, mean p set: 0.45034751296043396
The modified gen p mean: 0.4493371844291687, gen p mean: -0.046759847551584244, mean p set: 0.4498175084590912
loss_pred:0.014979282394051552, decouple_loss:0.0015289242146536708
loss_pred:0.015180513262748718, decouple_loss:0.0013560459483414888loss_pred:0.015546498820185661, decouple_loss:0.0012347393203526735
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012000_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012000_3_24hr.npz
NaN value num: 0
Iteration: 4362, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45096805691719055, gen p mean: -0.04335210099816322, mean p set: 0.45144835114479065
loss_pred:0.016140133142471313, decouple_loss:0.001370512880384922
The modified gen p mean: 0.45056185126304626, gen p mean: -0.04152974486351013, mean p set: 0.45104217529296875The modified gen p mean: 0.45097026228904724, gen p mean: -0.04327293485403061, mean p set: 0.4514505863189697
loss_pred:0.015739601105451584, decouple_loss:0.0014396595070138574
loss_pred:0.016167493537068367, decouple_loss:0.0012584681389853358
Iteration: 4363, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4512881934642792, gen p mean: -0.04037022590637207, mean p set: 0.4517684876918793
loss_pred:0.015427581034600735, decouple_loss:0.0010900370543822646
The modified gen p mean: 0.4513819217681885, gen p mean: -0.038802891969680786, mean p set: 0.4518622159957886The modified gen p mean: 0.4499458074569702, gen p mean: -0.03963471204042435, mean p set: 0.4504260718822479
loss_pred:0.016865486279129982, decouple_loss:0.0010552590247243643
loss_pred:0.01610626094043255, decouple_loss:0.0009471147786825895
Iteration: 4364, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4521511495113373, gen p mean: -0.04037611186504364, mean p set: 0.4526314437389374
loss_pred:0.015264259651303291, decouple_loss:0.0013007320230826735
The modified gen p mean: 0.45169538259506226, gen p mean: -0.03517540171742439, mean p set: 0.45217567682266235The modified gen p mean: 0.45051661133766174, gen p mean: -0.03679581359028816, mean p set: 0.45099693536758423
loss_pred:0.015896953642368317, decouple_loss:0.0012754907365888357
loss_pred:0.01583654247224331, decouple_loss:0.0012591409031301737
Iteration: 4365, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483369290828705, gen p mean: -0.037396758794784546, mean p set: 0.4488172233104706
loss_pred:0.016276024281978607, decouple_loss:0.001029707258567214
The modified gen p mean: 0.4518599510192871, gen p mean: -0.03779170662164688, mean p set: 0.4523402452468872The modified gen p mean: 0.4505423605442047, gen p mean: -0.035640206187963486, mean p set: 0.4510226845741272
loss_pred:0.016135267913341522, decouple_loss:0.001194473821669817
loss_pred:0.015326865017414093, decouple_loss:0.001055984408594668
Iteration: 4366, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45077645778656006, gen p mean: -0.03616160526871681, mean p set: 0.45125675201416016
loss_pred:0.01591545343399048, decouple_loss:0.001134368241764605
The modified gen p mean: 0.4503093957901001, gen p mean: -0.03491642698645592, mean p set: 0.4507897198200226The modified gen p mean: 0.45119035243988037, gen p mean: -0.03911951556801796, mean p set: 0.45167064666748047
loss_pred:0.01565534435212612, decouple_loss:0.0010246961610391736
loss_pred:0.015435834415256977, decouple_loss:0.0011520679108798504
Iteration: 4367, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.452678382396698, gen p mean: -0.0371360220015049, mean p set: 0.4531586468219757
loss_pred:0.01577657088637352, decouple_loss:0.0011628022184595466
The modified gen p mean: 0.4501146972179413, gen p mean: -0.03884049504995346, mean p set: 0.4505949914455414The modified gen p mean: 0.45126044750213623, gen p mean: -0.03533542528748512, mean p set: 0.45174074172973633
loss_pred:0.015500346198678017, decouple_loss:0.0010382516775280237
loss_pred:0.01601514406502247, decouple_loss:0.0012125861831009388
Iteration: 4368, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503439962863922, gen p mean: -0.03792579472064972, mean p set: 0.4508242905139923
loss_pred:0.015932120382785797, decouple_loss:0.001040013856254518
The modified gen p mean: 0.45099037885665894, gen p mean: -0.038599126040935516, mean p set: 0.45147067308425903
The modified gen p mean: 0.4518822729587555, gen p mean: -0.03819631412625313, mean p set: 0.4523625671863556
loss_pred:0.015739083290100098, decouple_loss:0.0011246850481256843
loss_pred:0.01672370731830597, decouple_loss:0.0010872689308598638
Iteration: 4369, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45200175046920776, gen p mean: -0.039538461714982986, mean p set: 0.45248204469680786
loss_pred:0.015149745158851147, decouple_loss:0.0010384435299783945
The modified gen p mean: 0.4517207741737366, gen p mean: -0.043592460453510284, mean p set: 0.45220106840133667The modified gen p mean: 0.4508303999900818, gen p mean: -0.0400896780192852, mean p set: 0.4513106644153595
loss_pred:0.015896977856755257, decouple_loss:0.0012007246259599924
loss_pred:0.015781564638018608, decouple_loss:0.0010547337587922812
Iteration: 4370, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45087841153144836, gen p mean: -0.04188748076558113, mean p set: 0.4513586759567261
loss_pred:0.01573985628783703, decouple_loss:0.0010389720555394888
The modified gen p mean: 0.45157966017723083, gen p mean: -0.044141560792922974, mean p set: 0.45205995440483093The modified gen p mean: 0.4500932991504669, gen p mean: -0.04244226589798927, mean p set: 0.45057356357574463
loss_pred:0.015909409150481224, decouple_loss:0.0011535749072209
loss_pred:0.016856366768479347, decouple_loss:0.0010647414019331336
2023-05-02 19:07:34 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.04981107637286186, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04678710177540779, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.04664730280637741, mean p set: 0.4500633478164673
loss_pred:0.01845485344529152, decouple_loss:0.0011015519266948104
loss_pred:0.017365535721182823, decouple_loss:0.0011148237390443683
loss_pred:0.017430594190955162, decouple_loss:0.0010774689726531506
WV_0_PC_1_EH_0_PS_40, loss: 0.017805226147174835, avg_mse: 0.02568848617374897
current test mse: 0.025688
Iteration: 4371, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45081281661987305, gen p mean: -0.04391603171825409, mean p set: 0.45129311084747314
The modified gen p mean: 0.45169195532798767, gen p mean: -0.044364362955093384, mean p set: 0.45217224955558777
The modified gen p mean: 0.4509517252445221, gen p mean: -0.04522113874554634, mean p set: 0.4514320194721222
loss_pred:0.016323573887348175, decouple_loss:0.0011844998225569725
loss_pred:0.015129996463656425, decouple_loss:0.0010315035469830036
loss_pred:0.01570751704275608, decouple_loss:0.00116702017839998
Iteration: 4372, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496900141239166, gen p mean: -0.03895353153347969, mean p set: 0.4501703083515167
loss_pred:0.01522299274802208, decouple_loss:0.0010092017473652959
The modified gen p mean: 0.4506039321422577, gen p mean: -0.04129847139120102, mean p set: 0.4510842561721802The modified gen p mean: 0.4503180980682373, gen p mean: -0.039718255400657654, mean p set: 0.4507984220981598
loss_pred:0.016403423622250557, decouple_loss:0.0010764703620225191
loss_pred:0.015317268669605255, decouple_loss:0.0009228133712895215
Iteration: 4373, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45176172256469727, gen p mean: -0.041257597506046295, mean p set: 0.45224204659461975
loss_pred:0.015349815599620342, decouple_loss:0.0011568323243409395
The modified gen p mean: 0.4504566490650177, gen p mean: -0.04014643281698227, mean p set: 0.4509369432926178The modified gen p mean: 0.4492076337337494, gen p mean: -0.042575906962156296, mean p set: 0.4496879279613495
loss_pred:0.015428774990141392, decouple_loss:0.0011808612616732717
loss_pred:0.016602182760834694, decouple_loss:0.001145289628766477
Iteration: 4374, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45327427983283997, gen p mean: -0.04192690923810005, mean p set: 0.45375457406044006
loss_pred:0.01604359969496727, decouple_loss:0.0013524119276553392
The modified gen p mean: 0.45023053884506226, gen p mean: -0.03814476355910301, mean p set: 0.45071083307266235The modified gen p mean: 0.44912153482437134, gen p mean: -0.0392555333673954, mean p set: 0.44960182905197144
loss_pred:0.01548092346638441, decouple_loss:0.0010796738788485527
loss_pred:0.016649018973112106, decouple_loss:0.001049356535077095
Iteration: 4375, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45087891817092896, gen p mean: -0.042076438665390015, mean p set: 0.45135921239852905
loss_pred:0.01587080955505371, decouple_loss:0.0010718842968344688
The modified gen p mean: 0.4514085352420807, gen p mean: -0.04064835608005524, mean p set: 0.4518887996673584The modified gen p mean: 0.4510155916213989, gen p mean: -0.039293788373470306, mean p set: 0.45149585604667664
loss_pred:0.015805499628186226, decouple_loss:0.0011861081002280116
loss_pred:0.01511587668210268, decouple_loss:0.001081587397493422
Iteration: 4376, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45196449756622314, gen p mean: -0.0446326918900013, mean p set: 0.45244479179382324
loss_pred:0.01608584076166153, decouple_loss:0.000990375061519444
The modified gen p mean: 0.44941446185112, gen p mean: -0.04259396344423294, mean p set: 0.4498947560787201The modified gen p mean: 0.4494269788265228, gen p mean: -0.03860582411289215, mean p set: 0.4499072730541229
loss_pred:0.014997133985161781, decouple_loss:0.0008847088320180774
loss_pred:0.016249975189566612, decouple_loss:0.0009396270615980029
Iteration: 4377, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514044225215912, gen p mean: -0.04184878617525101, mean p set: 0.4518847167491913
loss_pred:0.015302348881959915, decouple_loss:0.0010834683198481798
The modified gen p mean: 0.4490741789340973, gen p mean: -0.04425676539540291, mean p set: 0.449554443359375The modified gen p mean: 0.4494740962982178, gen p mean: -0.039434995502233505, mean p set: 0.4499543607234955
loss_pred:0.016427842900156975, decouple_loss:0.0010693517979234457
loss_pred:0.015233393758535385, decouple_loss:0.0009120868635363877
Iteration: 4378, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45236876606941223, gen p mean: -0.04434674605727196, mean p set: 0.45284903049468994
loss_pred:0.01622798852622509, decouple_loss:0.0009909778600558639
The modified gen p mean: 0.45204994082450867, gen p mean: -0.0461500808596611, mean p set: 0.45253023505210876The modified gen p mean: 0.45314088463783264, gen p mean: -0.04597734287381172, mean p set: 0.45362117886543274
loss_pred:0.015874160453677177, decouple_loss:0.0010165359126403928
loss_pred:0.01636691577732563, decouple_loss:0.0010540368966758251
Iteration: 4379, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505453109741211, gen p mean: -0.044365353882312775, mean p set: 0.4510255753993988
loss_pred:0.015549684874713421, decouple_loss:0.0011503818677738309
The modified gen p mean: 0.4500580132007599, gen p mean: -0.044647667557001114, mean p set: 0.45053830742836The modified gen p mean: 0.45180249214172363, gen p mean: -0.04388285428285599, mean p set: 0.45228278636932373
loss_pred:0.01572953723371029, decouple_loss:0.0010366685455664992
loss_pred:0.014880846254527569, decouple_loss:0.0009847714100033045
Iteration: 4380, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450955867767334, gen p mean: -0.050035372376441956, mean p set: 0.4514361619949341
loss_pred:0.015161295421421528, decouple_loss:0.0009783422574400902
The modified gen p mean: 0.4509979784488678, gen p mean: -0.04651876538991928, mean p set: 0.4514783024787903The modified gen p mean: 0.45139259099960327, gen p mean: -0.04982008785009384, mean p set: 0.45187288522720337
loss_pred:0.0165561456233263, decouple_loss:0.0011033122427761555
loss_pred:0.01579933613538742, decouple_loss:0.0010538491187617183
2023-05-02 19:09:28 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.05574153736233711, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.05250340700149536, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.05241340771317482, mean p set: 0.4500633478164673
loss_pred:0.01843452639877796, decouple_loss:0.001101662521250546
loss_pred:0.017325151711702347, decouple_loss:0.0010441606864333153
loss_pred:0.017406590282917023, decouple_loss:0.0010633039055392146
WV_0_PC_1_EH_0_PS_40, loss: 0.017775576561689377, avg_mse: 0.025576507672667503
current test mse: 0.025577
Iteration: 4381, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45067211985588074, gen p mean: -0.04773314669728279, mean p set: 0.4511524438858032
The modified gen p mean: 0.4504815340042114, gen p mean: -0.048374880105257034, mean p set: 0.45096179842948914
The modified gen p mean: 0.4497229754924774, gen p mean: -0.047181639820337296, mean p set: 0.4502032399177551
loss_pred:0.016378583386540413, decouple_loss:0.0010152056347578764
loss_pred:0.01608978770673275, decouple_loss:0.0009643742814660072
loss_pred:0.016364259645342827, decouple_loss:0.0009401179268024862
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012002_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012002_3_24hr.npz
NaN value num: 0
Iteration: 4382, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478619396686554, gen p mean: -0.05575936287641525, mean p set: 0.4483422338962555
loss_pred:0.014436811208724976, decouple_loss:0.001159998937509954
The modified gen p mean: 0.44723257422447205, gen p mean: -0.05558452382683754, mean p set: 0.44771286845207214The modified gen p mean: 0.44786348938941956, gen p mean: -0.05338678136467934, mean p set: 0.44834378361701965
loss_pred:0.014305932447314262, decouple_loss:0.001089974888600409
loss_pred:0.014153707772493362, decouple_loss:0.0011876887874677777
Iteration: 4383, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44681262969970703, gen p mean: -0.055898163467645645, mean p set: 0.44729292392730713
loss_pred:0.015022173523902893, decouple_loss:0.0009774102363735437
The modified gen p mean: 0.44497737288475037, gen p mean: -0.06419894844293594, mean p set: 0.4454576373100281The modified gen p mean: 0.4459763467311859, gen p mean: -0.061163220554590225, mean p set: 0.446456640958786
loss_pred:0.014401732943952084, decouple_loss:0.0010528593556955457
loss_pred:0.013855223543941975, decouple_loss:0.0009786655427888036
Iteration: 4384, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4463235139846802, gen p mean: -0.06249678134918213, mean p set: 0.44680383801460266
loss_pred:0.014273690059781075, decouple_loss:0.001162476371973753
The modified gen p mean: 0.44754672050476074, gen p mean: -0.0664781853556633, mean p set: 0.44802701473236084The modified gen p mean: 0.44668105244636536, gen p mean: -0.06247895956039429, mean p set: 0.44716131687164307
loss_pred:0.013095913454890251, decouple_loss:0.001095103332772851
loss_pred:0.014598996378481388, decouple_loss:0.0010629587341099977
Iteration: 4385, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474099576473236, gen p mean: -0.06068304181098938, mean p set: 0.4478902518749237
loss_pred:0.014406622387468815, decouple_loss:0.0011669147061184049
The modified gen p mean: 0.44713258743286133, gen p mean: -0.06352376937866211, mean p set: 0.4476129114627838The modified gen p mean: 0.4466274380683899, gen p mean: -0.061063043773174286, mean p set: 0.44710773229599
loss_pred:0.014549254439771175, decouple_loss:0.0012214879970997572
loss_pred:0.014210803434252739, decouple_loss:0.0011140544665977359
Iteration: 4386, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470152258872986, gen p mean: -0.06183035671710968, mean p set: 0.4474954903125763
loss_pred:0.01421551126986742, decouple_loss:0.0011400232324376702
The modified gen p mean: 0.44720014929771423, gen p mean: -0.06307411193847656, mean p set: 0.4476804733276367The modified gen p mean: 0.44790756702423096, gen p mean: -0.06351187080144882, mean p set: 0.44838783144950867
loss_pred:0.014044418931007385, decouple_loss:0.001100962283089757
loss_pred:0.014746020548045635, decouple_loss:0.0010481467470526695
Iteration: 4387, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4455007314682007, gen p mean: -0.06743491441011429, mean p set: 0.44598105549812317
loss_pred:0.013727185316383839, decouple_loss:0.001088462769985199
The modified gen p mean: 0.4466102421283722, gen p mean: -0.06106578931212425, mean p set: 0.4470905363559723The modified gen p mean: 0.4481351971626282, gen p mean: -0.058362927287817, mean p set: 0.44861549139022827
loss_pred:0.013562035746872425, decouple_loss:0.0010634365025907755
loss_pred:0.014207645319402218, decouple_loss:0.0010390592506155372
Iteration: 4388, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474528133869171, gen p mean: -0.06107741966843605, mean p set: 0.4479331374168396
loss_pred:0.013855848461389542, decouple_loss:0.001116732251830399
The modified gen p mean: 0.4477178752422333, gen p mean: -0.06295976787805557, mean p set: 0.4481981694698334The modified gen p mean: 0.4484007954597473, gen p mean: -0.05905262380838394, mean p set: 0.448881059885025
loss_pred:0.014278394170105457, decouple_loss:0.0012258125934749842
loss_pred:0.014282909221947193, decouple_loss:0.00117741827853024
Iteration: 4389, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44693711400032043, gen p mean: -0.056639913469552994, mean p set: 0.44741740822792053
loss_pred:0.014578297734260559, decouple_loss:0.0011143065057694912
The modified gen p mean: 0.445803701877594, gen p mean: -0.057972464710474014, mean p set: 0.4462839961051941The modified gen p mean: 0.44646063446998596, gen p mean: -0.054370615631341934, mean p set: 0.44694095849990845
loss_pred:0.013822624459862709, decouple_loss:0.001232135109603405
loss_pred:0.014499455690383911, decouple_loss:0.0011732648126780987
Iteration: 4390, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44642338156700134, gen p mean: -0.05065618082880974, mean p set: 0.44690370559692383
loss_pred:0.014078250154852867, decouple_loss:0.0011338862823322415
The modified gen p mean: 0.44727280735969543, gen p mean: -0.05353786051273346, mean p set: 0.44775307178497314The modified gen p mean: 0.44696521759033203, gen p mean: -0.0524214431643486, mean p set: 0.44744551181793213
loss_pred:0.012883762829005718, decouple_loss:0.0011453409679234028
loss_pred:0.013699421659111977, decouple_loss:0.0011384329991415143
2023-05-02 19:12:07 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.05651180446147919, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.05284508690237999, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.05288729444146156, mean p set: 0.4500633478164673
loss_pred:0.018978117033839226, decouple_loss:0.001124709378927946
loss_pred:0.01785952039062977, decouple_loss:0.0011385155376046896
loss_pred:0.01790812611579895, decouple_loss:0.0011307134991511703
WV_0_PC_1_EH_0_PS_40, loss: 0.018305152654647827, avg_mse: 0.02663731575012207
current test mse: 0.026637
Iteration: 4391, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44691750407218933, gen p mean: -0.05456443876028061, mean p set: 0.44739776849746704
The modified gen p mean: 0.44587817788124084, gen p mean: -0.056655775755643845, mean p set: 0.44635844230651855
The modified gen p mean: 0.44783398509025574, gen p mean: -0.05217687413096428, mean p set: 0.44831427931785583
loss_pred:0.013855003751814365, decouple_loss:0.0010650893673300743
loss_pred:0.01388540118932724, decouple_loss:0.0011066822335124016
loss_pred:0.014097086153924465, decouple_loss:0.0012191871646791697
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 4392, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490334987640381, gen p mean: -0.051877330988645554, mean p set: 0.4495137631893158
The modified gen p mean: 0.44722050428390503, gen p mean: -0.053482696413993835, mean p set: 0.4477007985115051
loss_pred:0.013908889144659042, decouple_loss:0.0011488700984045863
loss_pred:0.013993965461850166, decouple_loss:0.001179655664600432
The modified gen p mean: 0.44622603058815, gen p mean: -0.05343832075595856, mean p set: 0.4467063546180725
loss_pred:0.013957741670310497, decouple_loss:0.0011876391945406795
Iteration: 4393, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478778541088104, gen p mean: -0.051600318402051926, mean p set: 0.4483581483364105
loss_pred:0.01315818727016449, decouple_loss:0.0010939702624455094
The modified gen p mean: 0.44501036405563354, gen p mean: -0.057261571288108826, mean p set: 0.44549062848091125The modified gen p mean: 0.44721493124961853, gen p mean: -0.05494118109345436, mean p set: 0.44769522547721863
loss_pred:0.013519310392439365, decouple_loss:0.0011285297805443406
loss_pred:0.01371651329100132, decouple_loss:0.0011425473494455218
Iteration: 4394, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44710928201675415, gen p mean: -0.052715156227350235, mean p set: 0.44758957624435425
loss_pred:0.013660219497978687, decouple_loss:0.0010784737532958388
The modified gen p mean: 0.4464516043663025, gen p mean: -0.04887815937399864, mean p set: 0.4469318985939026The modified gen p mean: 0.44810187816619873, gen p mean: -0.05166274309158325, mean p set: 0.44858217239379883
loss_pred:0.01397661678493023, decouple_loss:0.001225111773237586
loss_pred:0.013707957230508327, decouple_loss:0.00114363559987396
Iteration: 4395, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44669926166534424, gen p mean: -0.051644694060087204, mean p set: 0.44717955589294434
loss_pred:0.0135910389944911, decouple_loss:0.0012462995946407318
The modified gen p mean: 0.44828417897224426, gen p mean: -0.04981335625052452, mean p set: 0.44876447319984436The modified gen p mean: 0.4485483765602112, gen p mean: -0.04630736634135246, mean p set: 0.4490286707878113
loss_pred:0.013868928886950016, decouple_loss:0.0014769536210224032
loss_pred:0.014249998144805431, decouple_loss:0.0012390040792524815
Iteration: 4396, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475288689136505, gen p mean: -0.046623434871435165, mean p set: 0.448009192943573
loss_pred:0.014476665295660496, decouple_loss:0.0010336724808439612
The modified gen p mean: 0.44610586762428284, gen p mean: -0.05381430685520172, mean p set: 0.4465861916542053The modified gen p mean: 0.44673678278923035, gen p mean: -0.04954838007688522, mean p set: 0.44721704721450806
loss_pred:0.013323034159839153, decouple_loss:0.001094776438549161
loss_pred:0.013669178821146488, decouple_loss:0.001015218673273921
Iteration: 4397, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485968351364136, gen p mean: -0.055295683443546295, mean p set: 0.44907715916633606
loss_pred:0.013444848358631134, decouple_loss:0.0011805446119979024
The modified gen p mean: 0.44668179750442505, gen p mean: -0.05440041050314903, mean p set: 0.44716206192970276The modified gen p mean: 0.4455787241458893, gen p mean: -0.05322868004441261, mean p set: 0.4460590183734894
loss_pred:0.013767954893410206, decouple_loss:0.0012234015157446265
loss_pred:0.013474357314407825, decouple_loss:0.0012251142179593444
Iteration: 4398, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44745752215385437, gen p mean: -0.05866261571645737, mean p set: 0.44793781638145447
loss_pred:0.014398988336324692, decouple_loss:0.0011253792326897383
The modified gen p mean: 0.4462679922580719, gen p mean: -0.0553446039557457, mean p set: 0.446748286485672The modified gen p mean: 0.44796085357666016, gen p mean: -0.05508258193731308, mean p set: 0.44844114780426025
loss_pred:0.013647976331412792, decouple_loss:0.001071230974048376
loss_pred:0.013545403257012367, decouple_loss:0.0010719408746808767
Iteration: 4399, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464872479438782, gen p mean: -0.05631622299551964, mean p set: 0.44696754217147827
loss_pred:0.012688984163105488, decouple_loss:0.0011555398814380169
The modified gen p mean: 0.4477289915084839, gen p mean: -0.05435340851545334, mean p set: 0.448209285736084The modified gen p mean: 0.44644805788993835, gen p mean: -0.058114491403102875, mean p set: 0.44692835211753845
loss_pred:0.013544411398470402, decouple_loss:0.0013143561081960797
loss_pred:0.013356487266719341, decouple_loss:0.0011357420589774847
Iteration: 4400, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4462986886501312, gen p mean: -0.053008489310741425, mean p set: 0.4467789828777313
loss_pred:0.013634764589369297, decouple_loss:0.0011250880779698491
The modified gen p mean: 0.44585034251213074, gen p mean: -0.05451132729649544, mean p set: 0.4463306665420532The modified gen p mean: 0.4469771385192871, gen p mean: -0.05484951287508011, mean p set: 0.4474574029445648
loss_pred:0.013382446952164173, decouple_loss:0.0011173792881891131
loss_pred:0.013667160645127296, decouple_loss:0.0011769208358600736
2023-05-02 19:14:02 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.0574168935418129, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.053843989968299866, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.0537043958902359, mean p set: 0.4500633478164673
loss_pred:0.018832212314009666, decouple_loss:0.0011546681635081768
loss_pred:0.017721718177199364, decouple_loss:0.001161855412647128
loss_pred:0.017741810530424118, decouple_loss:0.001172565622255206
WV_0_PC_1_EH_0_PS_40, loss: 0.018156731501221657, avg_mse: 0.026405146345496178
current test mse: 0.026405
Iteration: 4401, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44660380482673645, gen p mean: -0.05696386471390724, mean p set: 0.44708412885665894
The modified gen p mean: 0.4465464651584625, gen p mean: -0.054778922349214554, mean p set: 0.4470267593860626
The modified gen p mean: 0.44760170578956604, gen p mean: -0.05806621536612511, mean p set: 0.44808200001716614
loss_pred:0.012636417523026466, decouple_loss:0.0011341959470883012
loss_pred:0.013249574229121208, decouple_loss:0.0010586982825770974loss_pred:0.013906142674386501, decouple_loss:0.0010547953424975276
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012017_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012017_3_24hr.npz
NaN value num: 0
Iteration: 4402, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4521124064922333, gen p mean: -0.051700614392757416, mean p set: 0.4525927007198334
loss_pred:0.016551228240132332, decouple_loss:0.0011943208519369364
The modified gen p mean: 0.44941064715385437, gen p mean: -0.0511976033449173, mean p set: 0.44989094138145447The modified gen p mean: 0.4489927887916565, gen p mean: -0.05178195610642433, mean p set: 0.4494730830192566
loss_pred:0.017398912459611893, decouple_loss:0.0011232543038204312
loss_pred:0.01613442413508892, decouple_loss:0.0011270968243479729
Iteration: 4403, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44881126284599304, gen p mean: -0.049943238496780396, mean p set: 0.44929152727127075
loss_pred:0.01661565527319908, decouple_loss:0.0011415666667744517
The modified gen p mean: 0.4498410224914551, gen p mean: -0.046801526099443436, mean p set: 0.4503213167190552The modified gen p mean: 0.4491058588027954, gen p mean: -0.05092325061559677, mean p set: 0.4495861530303955
loss_pred:0.017060060054063797, decouple_loss:0.001093166647478938
loss_pred:0.01624542847275734, decouple_loss:0.0011832048185169697
Iteration: 4404, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45123687386512756, gen p mean: -0.04098895564675331, mean p set: 0.45171716809272766
loss_pred:0.017486482858657837, decouple_loss:0.0011262703919783235
The modified gen p mean: 0.45147886872291565, gen p mean: -0.04384855553507805, mean p set: 0.45195919275283813The modified gen p mean: 0.450868159532547, gen p mean: -0.04405926540493965, mean p set: 0.4513484537601471
loss_pred:0.016913004219532013, decouple_loss:0.0010685547022148967
loss_pred:0.016476675868034363, decouple_loss:0.0010417744051665068
Iteration: 4405, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503031075000763, gen p mean: -0.04062311351299286, mean p set: 0.4507834315299988
loss_pred:0.015702875331044197, decouple_loss:0.0009882953017950058
The modified gen p mean: 0.44949042797088623, gen p mean: -0.04893045127391815, mean p set: 0.44997072219848633The modified gen p mean: 0.4514298737049103, gen p mean: -0.040092602372169495, mean p set: 0.45191019773483276
loss_pred:0.016721230000257492, decouple_loss:0.0011000146623700857
loss_pred:0.01693134941160679, decouple_loss:0.001096680760383606
Iteration: 4406, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45169979333877563, gen p mean: -0.041741322726011276, mean p set: 0.45218008756637573
loss_pred:0.016640059649944305, decouple_loss:0.0012339756358414888
The modified gen p mean: 0.4497663080692291, gen p mean: -0.04556757211685181, mean p set: 0.4502466022968292
The modified gen p mean: 0.4522644281387329, gen p mean: -0.03915468975901604, mean p set: 0.452744722366333
loss_pred:0.017139095813035965, decouple_loss:0.001133888028562069
loss_pred:0.015983739867806435, decouple_loss:0.001057424466125667
Iteration: 4407, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488823413848877, gen p mean: -0.04611607640981674, mean p set: 0.4493626356124878
loss_pred:0.015976112335920334, decouple_loss:0.0010208922903984785
The modified gen p mean: 0.4500156044960022, gen p mean: -0.04667680710554123, mean p set: 0.4504959285259247The modified gen p mean: 0.44993525743484497, gen p mean: -0.04784739762544632, mean p set: 0.4504155218601227
loss_pred:0.018169762566685677, decouple_loss:0.001028280472382903
loss_pred:0.01668987050652504, decouple_loss:0.0010856807930395007
Iteration: 4408, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502771496772766, gen p mean: -0.0490901917219162, mean p set: 0.4507574439048767
loss_pred:0.017512217164039612, decouple_loss:0.001154174911789596
The modified gen p mean: 0.44944971799850464, gen p mean: -0.04647568613290787, mean p set: 0.44993001222610474The modified gen p mean: 0.45226559042930603, gen p mean: -0.03762732073664665, mean p set: 0.45274588465690613
loss_pred:0.016057142987847328, decouple_loss:0.001095695304684341
loss_pred:0.016089506447315216, decouple_loss:0.0011235239217057824
Iteration: 4409, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44988295435905457, gen p mean: -0.04125908389687538, mean p set: 0.45036324858665466
loss_pred:0.015791580080986023, decouple_loss:0.001026420621201396
The modified gen p mean: 0.45140278339385986, gen p mean: -0.04093935340642929, mean p set: 0.45188307762145996The modified gen p mean: 0.4523078501224518, gen p mean: -0.04515945911407471, mean p set: 0.4527881443500519
loss_pred:0.017211569473147392, decouple_loss:0.0011062667472288013
loss_pred:0.016996197402477264, decouple_loss:0.0011757112806662917
Iteration: 4410, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497336149215698, gen p mean: -0.04810124263167381, mean p set: 0.45021387934684753
loss_pred:0.016266142949461937, decouple_loss:0.0011069559259340167
The modified gen p mean: 0.4514210522174835, gen p mean: -0.04861568287014961, mean p set: 0.4519013464450836The modified gen p mean: 0.4519214630126953, gen p mean: -0.040926408022642136, mean p set: 0.4524017870426178
loss_pred:0.01672871597111225, decouple_loss:0.0010577976936474442
loss_pred:0.01609911024570465, decouple_loss:0.0010335373226553202
2023-05-02 19:16:33 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.05520286411046982, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.05154304578900337, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.051537029445171356, mean p set: 0.4500633478164673
loss_pred:0.018445704132318497, decouple_loss:0.001344354823231697
loss_pred:0.017279040068387985, decouple_loss:0.0012011808576062322
loss_pred:0.017427515238523483, decouple_loss:0.0012388642644509673
WV_0_PC_1_EH_0_PS_40, loss: 0.017780493944883347, avg_mse: 0.025642558932304382
current test mse: 0.025643
Iteration: 4411, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4519834518432617, gen p mean: -0.0432453453540802, mean p set: 0.4524637460708618
The modified gen p mean: 0.45222026109695435, gen p mean: -0.0447036512196064, mean p set: 0.45270055532455444
The modified gen p mean: 0.4501321017742157, gen p mean: -0.05237814411520958, mean p set: 0.4506123960018158
loss_pred:0.01636642962694168, decouple_loss:0.0012179597979411483
loss_pred:0.017087403684854507, decouple_loss:0.0010123340180143714
loss_pred:0.016489822417497635, decouple_loss:0.0012707929126918316
Iteration: 4412, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489936828613281, gen p mean: -0.05241110920906067, mean p set: 0.4494739770889282
loss_pred:0.016528427600860596, decouple_loss:0.001038331538438797
The modified gen p mean: 0.4494694173336029, gen p mean: -0.0500028058886528, mean p set: 0.449949711561203The modified gen p mean: 0.4492368698120117, gen p mean: -0.049391601234674454, mean p set: 0.4497171640396118
loss_pred:0.015859311446547508, decouple_loss:0.0010824130149558187
loss_pred:0.015805348753929138, decouple_loss:0.0010782437166199088
Iteration: 4413, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4516439437866211, gen p mean: -0.04234340414404869, mean p set: 0.4521242678165436
loss_pred:0.01725224032998085, decouple_loss:0.0011460011592134833
The modified gen p mean: 0.4520311951637268, gen p mean: -0.044495876878499985, mean p set: 0.4525114893913269The modified gen p mean: 0.45227017998695374, gen p mean: -0.0421542227268219, mean p set: 0.45275044441223145
loss_pred:0.016704944893717766, decouple_loss:0.0012245249236002564
loss_pred:0.016543371602892876, decouple_loss:0.0010699592530727386
Iteration: 4414, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499744772911072, gen p mean: -0.04904673621058464, mean p set: 0.4504547715187073
loss_pred:0.017864122986793518, decouple_loss:0.0010633807396516204
The modified gen p mean: 0.4486709535121918, gen p mean: -0.04737307131290436, mean p set: 0.44915124773979187The modified gen p mean: 0.449844092130661, gen p mean: -0.04725729674100876, mean p set: 0.4503243863582611
loss_pred:0.016098463907837868, decouple_loss:0.0010373354889452457
loss_pred:0.016106877475976944, decouple_loss:0.0010509369894862175
Iteration: 4415, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4516894519329071, gen p mean: -0.04284610599279404, mean p set: 0.4521697759628296
loss_pred:0.016078321263194084, decouple_loss:0.0011774880113080144
The modified gen p mean: 0.451952189207077, gen p mean: -0.03994659706950188, mean p set: 0.4524324834346771The modified gen p mean: 0.4499061107635498, gen p mean: -0.04493088647723198, mean p set: 0.4503864049911499
loss_pred:0.016224423423409462, decouple_loss:0.0012216741451993585
loss_pred:0.017591197043657303, decouple_loss:0.0010183113627135754
Iteration: 4416, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494214653968811, gen p mean: -0.04597856476902962, mean p set: 0.4499017596244812
loss_pred:0.01695261150598526, decouple_loss:0.000992409884929657
The modified gen p mean: 0.4504345655441284, gen p mean: -0.03957248851656914, mean p set: 0.4509148597717285The modified gen p mean: 0.45233818888664246, gen p mean: -0.038878440856933594, mean p set: 0.45281848311424255
loss_pred:0.01602199114859104, decouple_loss:0.0009328865562565625
loss_pred:0.016278419643640518, decouple_loss:0.00104845582973212
Iteration: 4417, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4522947072982788, gen p mean: -0.038643546402454376, mean p set: 0.4527750313282013
loss_pred:0.016029246151447296, decouple_loss:0.0010070494608953595
The modified gen p mean: 0.4502570331096649, gen p mean: -0.04739970341324806, mean p set: 0.450737327337265The modified gen p mean: 0.45204418897628784, gen p mean: -0.04195839911699295, mean p set: 0.4525245130062103
loss_pred:0.016842767596244812, decouple_loss:0.0010637526866048574
loss_pred:0.016335690394043922, decouple_loss:0.0010230623884126544
Iteration: 4418, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4518701732158661, gen p mean: -0.04196043685078621, mean p set: 0.4523504674434662
loss_pred:0.01652560941874981, decouple_loss:0.0009943553013727069
The modified gen p mean: 0.45021700859069824, gen p mean: -0.045707397162914276, mean p set: 0.4506973326206207The modified gen p mean: 0.4528787434101105, gen p mean: -0.0399155467748642, mean p set: 0.45335903763771057
loss_pred:0.016082005575299263, decouple_loss:0.0009702096576802433
loss_pred:0.01593070477247238, decouple_loss:0.0009033067035488784
Iteration: 4419, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498606324195862, gen p mean: -0.04794122651219368, mean p set: 0.45034095644950867
loss_pred:0.017003348097205162, decouple_loss:0.0009937360882759094
The modified gen p mean: 0.4524064362049103, gen p mean: -0.042781636118888855, mean p set: 0.45288676023483276The modified gen p mean: 0.45171207189559937, gen p mean: -0.04468866437673569, mean p set: 0.4521923363208771
loss_pred:0.016742756590247154, decouple_loss:0.0010669040493667126
loss_pred:0.016590742394328117, decouple_loss:0.0010071760043501854
Iteration: 4420, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45170989632606506, gen p mean: -0.049168769270181656, mean p set: 0.45219019055366516
loss_pred:0.016524706035852432, decouple_loss:0.0008812730084173381
The modified gen p mean: 0.4493335485458374, gen p mean: -0.04775756970047951, mean p set: 0.4498138427734375The modified gen p mean: 0.4487507939338684, gen p mean: -0.0491906963288784, mean p set: 0.4492310881614685
loss_pred:0.01569305919110775, decouple_loss:0.0010103195672854781
loss_pred:0.016400352120399475, decouple_loss:0.0009523790795356035
2023-05-02 19:18:28 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.053845975548028946, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.050507448613643646, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.05038163810968399, mean p set: 0.4500633478164673
loss_pred:0.018419967964291573, decouple_loss:0.0011887239525094628
loss_pred:0.01729041524231434, decouple_loss:0.0010560001246631145
loss_pred:0.017381273210048676, decouple_loss:0.0011225719936192036
WV_0_PC_1_EH_0_PS_40, loss: 0.017753342166543007, avg_mse: 0.02559736557304859
current test mse: 0.025597
Iteration: 4421, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45026251673698425, gen p mean: -0.0518421046435833, mean p set: 0.45074281096458435
The modified gen p mean: 0.4517619013786316, gen p mean: -0.04524001106619835, mean p set: 0.4522422254085541
The modified gen p mean: 0.45203524827957153, gen p mean: -0.04527941346168518, mean p set: 0.452515572309494
loss_pred:0.01673571765422821, decouple_loss:0.0009627245017327368
loss_pred:0.01703413762152195, decouple_loss:0.0009812242351472378
loss_pred:0.016159823164343834, decouple_loss:0.0009144323994405568
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012003_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012003_3_24hr.npz
NaN value num: 0
Iteration: 4422, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483537971973419, gen p mean: -0.05681444704532623, mean p set: 0.44883406162261963
loss_pred:0.016197459772229195, decouple_loss:0.0010168894659727812
The modified gen p mean: 0.4485088884830475, gen p mean: -0.050574660301208496, mean p set: 0.4489891827106476The modified gen p mean: 0.447353333234787, gen p mean: -0.04735865443944931, mean p set: 0.4478336274623871
loss_pred:0.017166374251246452, decouple_loss:0.0010614285711199045
loss_pred:0.016554588451981544, decouple_loss:0.0010521881049498916
Iteration: 4423, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44775399565696716, gen p mean: -0.04886682331562042, mean p set: 0.4482342600822449
loss_pred:0.01603478193283081, decouple_loss:0.0011434195330366492
The modified gen p mean: 0.4483935832977295, gen p mean: -0.051956236362457275, mean p set: 0.4488738775253296The modified gen p mean: 0.44844934344291687, gen p mean: -0.05437440425157547, mean p set: 0.44892963767051697
loss_pred:0.016468219459056854, decouple_loss:0.0010734492680057883
loss_pred:0.015673663467168808, decouple_loss:0.0010166886495426297
Iteration: 4424, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477604329586029, gen p mean: -0.05495241656899452, mean p set: 0.448240727186203
loss_pred:0.015823164954781532, decouple_loss:0.0010839374735951424
The modified gen p mean: 0.44783344864845276, gen p mean: -0.05236687511205673, mean p set: 0.44831374287605286The modified gen p mean: 0.44859200716018677, gen p mean: -0.052997566759586334, mean p set: 0.4490722715854645
loss_pred:0.01586478389799595, decouple_loss:0.0010244837030768394
loss_pred:0.016216034069657326, decouple_loss:0.0010102660162374377
Iteration: 4425, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448635458946228, gen p mean: -0.06120245158672333, mean p set: 0.4491157829761505
loss_pred:0.01543495710939169, decouple_loss:0.0010575789492577314
The modified gen p mean: 0.44791704416275024, gen p mean: -0.05301393195986748, mean p set: 0.44839733839035034The modified gen p mean: 0.4477972388267517, gen p mean: -0.05732811987400055, mean p set: 0.4482775628566742
loss_pred:0.016104312613606453, decouple_loss:0.0009827581234276295
loss_pred:0.01629370078444481, decouple_loss:0.0011159246787428856
Iteration: 4426, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483061730861664, gen p mean: -0.06117090955376625, mean p set: 0.4487864673137665
loss_pred:0.01598169468343258, decouple_loss:0.0009964555501937866
The modified gen p mean: 0.4490705728530884, gen p mean: -0.06337039172649384, mean p set: 0.4495508372783661The modified gen p mean: 0.44758620858192444, gen p mean: -0.060947634279727936, mean p set: 0.44806647300720215
loss_pred:0.015898447483778, decouple_loss:0.0010514287278056145
loss_pred:0.015445178374648094, decouple_loss:0.0010571052553132176
Iteration: 4427, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44820448756217957, gen p mean: -0.06120932102203369, mean p set: 0.44868478178977966
loss_pred:0.016409093514084816, decouple_loss:0.000953535723965615
The modified gen p mean: 0.449398010969162, gen p mean: -0.05937252938747406, mean p set: 0.4498783349990845The modified gen p mean: 0.44823142886161804, gen p mean: -0.06030896678566933, mean p set: 0.44871172308921814
loss_pred:0.01673128828406334, decouple_loss:0.0010471520945429802
loss_pred:0.015506337396800518, decouple_loss:0.0009180025081150234
Iteration: 4428, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480516016483307, gen p mean: -0.061160650104284286, mean p set: 0.4485318660736084
loss_pred:0.015848400071263313, decouple_loss:0.001127356314100325
The modified gen p mean: 0.4487382471561432, gen p mean: -0.06259355694055557, mean p set: 0.4492185115814209The modified gen p mean: 0.44792941212654114, gen p mean: -0.061667460948228836, mean p set: 0.44840967655181885
loss_pred:0.015624825842678547, decouple_loss:0.0012202896177768707
loss_pred:0.015480905771255493, decouple_loss:0.001076388405635953
Iteration: 4429, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44782301783561707, gen p mean: -0.05921703949570656, mean p set: 0.44830331206321716
loss_pred:0.016663366928696632, decouple_loss:0.0010627886513248086
The modified gen p mean: 0.44961830973625183, gen p mean: -0.06103552132844925, mean p set: 0.4500986337661743The modified gen p mean: 0.44711536169052124, gen p mean: -0.0591321736574173, mean p set: 0.44759565591812134
loss_pred:0.0156747717410326, decouple_loss:0.0010670004412531853
loss_pred:0.01609337516129017, decouple_loss:0.001024103257805109
Iteration: 4430, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44783735275268555, gen p mean: -0.05652476102113724, mean p set: 0.44831764698028564
loss_pred:0.015705646947026253, decouple_loss:0.001054955180734396
The modified gen p mean: 0.44949501752853394, gen p mean: -0.0639994814991951, mean p set: 0.4499753415584564The modified gen p mean: 0.4480580687522888, gen p mean: -0.05327899754047394, mean p set: 0.4485383629798889
loss_pred:0.015424844808876514, decouple_loss:0.001203649677336216
loss_pred:0.01545318029820919, decouple_loss:0.0010646589798852801
2023-05-02 19:21:02 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.05731964111328125, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.05378981679677963, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.05381670221686363, mean p set: 0.4500633478164673
loss_pred:0.01847364567220211, decouple_loss:0.001054865657351911
loss_pred:0.01739996112883091, decouple_loss:0.001028744736686349
loss_pred:0.01741417497396469, decouple_loss:0.0010244178120046854
WV_0_PC_1_EH_0_PS_40, loss: 0.0178143959492445, avg_mse: 0.025727925822138786
current test mse: 0.025728
Iteration: 4431, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44803908467292786, gen p mean: -0.05082985386252403, mean p set: 0.44851937890052795
The modified gen p mean: 0.4483759105205536, gen p mean: -0.053309954702854156, mean p set: 0.4488562047481537
The modified gen p mean: 0.4481610357761383, gen p mean: -0.057368308305740356, mean p set: 0.448641300201416
loss_pred:0.015383733436465263, decouple_loss:0.0009023264865390956
loss_pred:0.016388336196541786, decouple_loss:0.0009354511857964098
loss_pred:0.016269434243440628, decouple_loss:0.0009128982201218605
Iteration: 4432, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478627145290375, gen p mean: -0.05408896133303642, mean p set: 0.44834303855895996
loss_pred:0.01548528391867876, decouple_loss:0.0009977431036531925
The modified gen p mean: 0.44754356145858765, gen p mean: -0.053217146545648575, mean p set: 0.44802385568618774The modified gen p mean: 0.44992712140083313, gen p mean: -0.05598009377717972, mean p set: 0.4504074156284332
loss_pred:0.016301026567816734, decouple_loss:0.0010226614540442824
loss_pred:0.015502272173762321, decouple_loss:0.0010441243648529053
Iteration: 4433, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44731342792510986, gen p mean: -0.0504777766764164, mean p set: 0.44779375195503235
loss_pred:0.01632600463926792, decouple_loss:0.0008749092230573297
The modified gen p mean: 0.4482074975967407, gen p mean: -0.05000796541571617, mean p set: 0.4486878216266632The modified gen p mean: 0.4468842148780823, gen p mean: -0.050294429063797, mean p set: 0.44736447930336
loss_pred:0.016210202127695084, decouple_loss:0.0009335022186860442
loss_pred:0.015941090881824493, decouple_loss:0.0010389521485194564
Iteration: 4434, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478890895843506, gen p mean: -0.049831684678792953, mean p set: 0.4483693838119507
loss_pred:0.015921998769044876, decouple_loss:0.0010737801203504205
The modified gen p mean: 0.4495101273059845, gen p mean: -0.055847298353910446, mean p set: 0.4499904215335846The modified gen p mean: 0.4497392177581787, gen p mean: -0.0580606646835804, mean p set: 0.4502195119857788
loss_pred:0.015077992342412472, decouple_loss:0.0010433100396767259
loss_pred:0.015009385533630848, decouple_loss:0.001187648857012391
Iteration: 4435, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44883784651756287, gen p mean: -0.05651599168777466, mean p set: 0.44931817054748535
loss_pred:0.016103360801935196, decouple_loss:0.0011257720179855824
The modified gen p mean: 0.4481784403324127, gen p mean: -0.052022963762283325, mean p set: 0.4486587643623352The modified gen p mean: 0.44861719012260437, gen p mean: -0.05400568246841431, mean p set: 0.44909751415252686
loss_pred:0.016311168670654297, decouple_loss:0.001064242678694427
loss_pred:0.015825185924768448, decouple_loss:0.0011293336283415556
Iteration: 4436, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467676877975464, gen p mean: -0.05297907069325447, mean p set: 0.4472479820251465
loss_pred:0.016189897432923317, decouple_loss:0.0009748130105435848
The modified gen p mean: 0.44802823662757874, gen p mean: -0.05065527185797691, mean p set: 0.44850850105285645The modified gen p mean: 0.44794660806655884, gen p mean: -0.053709372878074646, mean p set: 0.44842690229415894
loss_pred:0.016230221837759018, decouple_loss:0.0010376391001045704
loss_pred:0.015248731710016727, decouple_loss:0.0010163582628592849
Iteration: 4437, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44801104068756104, gen p mean: -0.055681902915239334, mean p set: 0.44849133491516113
loss_pred:0.015744011849164963, decouple_loss:0.0009663082309998572
The modified gen p mean: 0.4494318962097168, gen p mean: -0.05669334903359413, mean p set: 0.4499121904373169The modified gen p mean: 0.448249876499176, gen p mean: -0.05694444105029106, mean p set: 0.4487301707267761
loss_pred:0.016221169382333755, decouple_loss:0.0009639583877287805
loss_pred:0.015615788288414478, decouple_loss:0.0009927190840244293
Iteration: 4438, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449124813079834, gen p mean: -0.059500597417354584, mean p set: 0.4496051073074341
loss_pred:0.015377866104245186, decouple_loss:0.0009546351502649486
The modified gen p mean: 0.44802042841911316, gen p mean: -0.05571949481964111, mean p set: 0.44850072264671326The modified gen p mean: 0.4486146867275238, gen p mean: -0.05719812586903572, mean p set: 0.4490949809551239
loss_pred:0.016376802697777748, decouple_loss:0.0009418748086318374
loss_pred:0.015394086949527264, decouple_loss:0.0009351113112643361
Iteration: 4439, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449266254901886, gen p mean: -0.05699405074119568, mean p set: 0.44974657893180847
loss_pred:0.015729274600744247, decouple_loss:0.0010615786304697394
The modified gen p mean: 0.44936156272888184, gen p mean: -0.057453133165836334, mean p set: 0.44984182715415955
The modified gen p mean: 0.4480273425579071, gen p mean: -0.05138261988759041, mean p set: 0.4485076069831848
loss_pred:0.015598781406879425, decouple_loss:0.0010609448654577136
loss_pred:0.016418514773249626, decouple_loss:0.000941519858315587
Iteration: 4440, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501098394393921, gen p mean: -0.056872863322496414, mean p set: 0.4505901634693146
loss_pred:0.015045465901494026, decouple_loss:0.0010216452647000551
The modified gen p mean: 0.4488072991371155, gen p mean: -0.056517381221055984, mean p set: 0.4492875933647156The modified gen p mean: 0.4479117691516876, gen p mean: -0.05289639160037041, mean p set: 0.44839203357696533
loss_pred:0.01559092104434967, decouple_loss:0.001044645207002759
loss_pred:0.015868663787841797, decouple_loss:0.0010217615636065602
2023-05-02 19:22:56 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.05558601766824722, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.05197111517190933, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.05210292339324951, mean p set: 0.4500633478164673
loss_pred:0.018457254394888878, decouple_loss:0.0010676145320758224
loss_pred:0.01738577149808407, decouple_loss:0.0010428251698613167
loss_pred:0.017434127628803253, decouple_loss:0.001011896412819624
WV_0_PC_1_EH_0_PS_40, loss: 0.017811089754104614, avg_mse: 0.02572377398610115
current test mse: 0.025724
Iteration: 4441, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476093649864197, gen p mean: -0.0512872040271759, mean p set: 0.4480896592140198
The modified gen p mean: 0.44767633080482483, gen p mean: -0.04984434321522713, mean p set: 0.44815659523010254
The modified gen p mean: 0.44805678725242615, gen p mean: -0.05020785704255104, mean p set: 0.44853708148002625
loss_pred:0.016202466562390327, decouple_loss:0.0008957924437709153
loss_pred:0.016195159405469894, decouple_loss:0.0009304232662543654
loss_pred:0.016570236533880234, decouple_loss:0.0009498094441369176
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012005_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012005_3_24hr.npz
NaN value num: 0
Iteration: 4442, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494415521621704, gen p mean: -0.05632620304822922, mean p set: 0.4499218463897705
loss_pred:0.013917112722992897, decouple_loss:0.0009712923783808947
The modified gen p mean: 0.4472036361694336, gen p mean: -0.053766265511512756, mean p set: 0.4476839303970337
The modified gen p mean: 0.4493323266506195, gen p mean: -0.05370939522981644, mean p set: 0.4498126208782196
loss_pred:0.014001314528286457, decouple_loss:0.0009969881502911448
loss_pred:0.013572784140706062, decouple_loss:0.0010401003528386354
Iteration: 4443, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493190050125122, gen p mean: -0.05346253514289856, mean p set: 0.4497992694377899
loss_pred:0.01349275466054678, decouple_loss:0.001029969658702612
The modified gen p mean: 0.44951102137565613, gen p mean: -0.05044151842594147, mean p set: 0.4499913156032562The modified gen p mean: 0.45016369223594666, gen p mean: -0.05066881701350212, mean p set: 0.45064398646354675
loss_pred:0.012953212484717369, decouple_loss:0.0010382893960922956
loss_pred:0.013537060469388962, decouple_loss:0.0009000440477393568
Iteration: 4444, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501170814037323, gen p mean: -0.05480256304144859, mean p set: 0.4505973160266876
loss_pred:0.013843769207596779, decouple_loss:0.0010986842680722475
The modified gen p mean: 0.4483683109283447, gen p mean: -0.05807768926024437, mean p set: 0.44884857535362244The modified gen p mean: 0.4494202733039856, gen p mean: -0.049939028918743134, mean p set: 0.4499005675315857
loss_pred:0.01380655262619257, decouple_loss:0.0011085962178185582
loss_pred:0.013472968712449074, decouple_loss:0.001120212022215128
Iteration: 4445, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487708508968353, gen p mean: -0.05329065024852753, mean p set: 0.4492511451244354
loss_pred:0.014072656631469727, decouple_loss:0.00116635300219059
The modified gen p mean: 0.4494166374206543, gen p mean: -0.05613268166780472, mean p set: 0.4498968720436096The modified gen p mean: 0.4486224949359894, gen p mean: -0.0531882606446743, mean p set: 0.4491027593612671
loss_pred:0.01316866371780634, decouple_loss:0.001051132450811565
loss_pred:0.01409972459077835, decouple_loss:0.0009769494645297527
Iteration: 4446, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450418621301651, gen p mean: -0.053651753813028336, mean p set: 0.4508989155292511
loss_pred:0.013305987231433392, decouple_loss:0.0011349741835147142
The modified gen p mean: 0.4487534165382385, gen p mean: -0.05200036242604256, mean p set: 0.4492337107658386The modified gen p mean: 0.4475174844264984, gen p mean: -0.05311024188995361, mean p set: 0.4479977786540985
loss_pred:0.013364714570343494, decouple_loss:0.00123937230091542
loss_pred:0.01331275887787342, decouple_loss:0.0012157465098425746
Iteration: 4447, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504387676715851, gen p mean: -0.04927606135606766, mean p set: 0.4509190618991852
loss_pred:0.013568759895861149, decouple_loss:0.001068403129465878
The modified gen p mean: 0.44905537366867065, gen p mean: -0.047847166657447815, mean p set: 0.44953563809394836The modified gen p mean: 0.4489338994026184, gen p mean: -0.053182441741228104, mean p set: 0.4494141638278961
loss_pred:0.014156762510538101, decouple_loss:0.0009958292357623577
loss_pred:0.013333487324416637, decouple_loss:0.0010418187594041228
Iteration: 4448, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496974050998688, gen p mean: -0.049643099308013916, mean p set: 0.45017769932746887
loss_pred:0.013089515268802643, decouple_loss:0.0010852640261873603
The modified gen p mean: 0.44795694947242737, gen p mean: -0.053711168467998505, mean p set: 0.44843724370002747The modified gen p mean: 0.449152410030365, gen p mean: -0.05443723499774933, mean p set: 0.4496326744556427
loss_pred:0.0135252196341753, decouple_loss:0.0011780763743445277
loss_pred:0.013386969454586506, decouple_loss:0.0011261329054832458
Iteration: 4449, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498547613620758, gen p mean: -0.04521238058805466, mean p set: 0.4503350555896759
loss_pred:0.013419603928923607, decouple_loss:0.0011521249543875456
The modified gen p mean: 0.45044639706611633, gen p mean: -0.04682520031929016, mean p set: 0.45092666149139404The modified gen p mean: 0.4483104348182678, gen p mean: -0.04639836773276329, mean p set: 0.4487907588481903
loss_pred:0.013866224326193333, decouple_loss:0.0010600556852295995
loss_pred:0.013446340337395668, decouple_loss:0.0011040052631869912
Iteration: 4450, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490041136741638, gen p mean: -0.05537984147667885, mean p set: 0.4494844079017639
loss_pred:0.013635190203785896, decouple_loss:0.0010802001925185323
The modified gen p mean: 0.45058080554008484, gen p mean: -0.04595581814646721, mean p set: 0.45106109976768494The modified gen p mean: 0.447736918926239, gen p mean: -0.04727820307016373, mean p set: 0.4482172131538391
loss_pred:0.012941565364599228, decouple_loss:0.0010302870068699121
loss_pred:0.013421178795397282, decouple_loss:0.0010092449374496937
2023-05-02 19:25:33 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.05408116802573204, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.05009559169411659, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.050390586256980896, mean p set: 0.4500633478164673
loss_pred:0.01894501782953739, decouple_loss:0.0012465424370020628
loss_pred:0.017917517572641373, decouple_loss:0.001139600994065404
loss_pred:0.017963092774152756, decouple_loss:0.001187417539767921
WV_0_PC_1_EH_0_PS_40, loss: 0.0183347687125206, avg_mse: 0.02673952654004097
current test mse: 0.02674
Iteration: 4451, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502202570438385, gen p mean: -0.05114656314253807, mean p set: 0.4507005214691162
The modified gen p mean: 0.45020556449890137, gen p mean: -0.05013715848326683, mean p set: 0.4506858289241791
The modified gen p mean: 0.45034259557724, gen p mean: -0.048305757343769073, mean p set: 0.4508228898048401
loss_pred:0.012889294885098934, decouple_loss:0.001068069483153522
loss_pred:0.013000721111893654, decouple_loss:0.0010908163385465741
loss_pred:0.013281633146107197, decouple_loss:0.0012276637135073543
Iteration: 4452, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44841185212135315, gen p mean: -0.05039658769965172, mean p set: 0.44889214634895325
loss_pred:0.01358113158494234, decouple_loss:0.0010350189404562116
The modified gen p mean: 0.4475288987159729, gen p mean: -0.05013606697320938, mean p set: 0.448009192943573The modified gen p mean: 0.4499109387397766, gen p mean: -0.04936842992901802, mean p set: 0.4503912329673767
loss_pred:0.012728752568364143, decouple_loss:0.0009557324810884893
loss_pred:0.013383342884480953, decouple_loss:0.0011731690028682351
Iteration: 4453, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45028233528137207, gen p mean: -0.053499672561883926, mean p set: 0.45076262950897217
loss_pred:0.012838699854910374, decouple_loss:0.0011614812538027763
The modified gen p mean: 0.4496532380580902, gen p mean: -0.052100200206041336, mean p set: 0.4501335322856903The modified gen p mean: 0.4492276608943939, gen p mean: -0.05220199376344681, mean p set: 0.449707955121994
loss_pred:0.013012208975851536, decouple_loss:0.0011795005993917584
loss_pred:0.013283217325806618, decouple_loss:0.001153207616880536
Iteration: 4454, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44891074299812317, gen p mean: -0.05595258250832558, mean p set: 0.44939103722572327
loss_pred:0.013439786620438099, decouple_loss:0.0012145184446126223
The modified gen p mean: 0.44959110021591187, gen p mean: -0.05388672649860382, mean p set: 0.45007139444351196The modified gen p mean: 0.4494057595729828, gen p mean: -0.05766943097114563, mean p set: 0.4498860538005829
loss_pred:0.013353043235838413, decouple_loss:0.0012883995659649372
loss_pred:0.013481676578521729, decouple_loss:0.0012290498707443476
Iteration: 4455, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505947232246399, gen p mean: -0.05737719312310219, mean p set: 0.4510750472545624
loss_pred:0.01342329103499651, decouple_loss:0.0011326440144330263
The modified gen p mean: 0.44887134432792664, gen p mean: -0.0574130043387413, mean p set: 0.4493516683578491The modified gen p mean: 0.449002742767334, gen p mean: -0.05680554732680321, mean p set: 0.4494830369949341
loss_pred:0.013479838147759438, decouple_loss:0.0011955325026065111
loss_pred:0.013120895251631737, decouple_loss:0.0011420396622270346
Iteration: 4456, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496975243091583, gen p mean: -0.05076811835169792, mean p set: 0.4501778185367584
loss_pred:0.013124978169798851, decouple_loss:0.001148908631876111
The modified gen p mean: 0.4500133991241455, gen p mean: -0.05054564028978348, mean p set: 0.4504936933517456The modified gen p mean: 0.4494454860687256, gen p mean: -0.05647517740726471, mean p set: 0.4499257802963257
loss_pred:0.01250224094837904, decouple_loss:0.0009808024624362588
loss_pred:0.013534867204725742, decouple_loss:0.001020769472233951
Iteration: 4457, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490104019641876, gen p mean: -0.04894460365176201, mean p set: 0.44949066638946533
loss_pred:0.013529140502214432, decouple_loss:0.0011555668897926807
The modified gen p mean: 0.4500689208507538, gen p mean: -0.04761013388633728, mean p set: 0.4505492150783539The modified gen p mean: 0.4490760564804077, gen p mean: -0.05620028078556061, mean p set: 0.4495563805103302
loss_pred:0.012821209616959095, decouple_loss:0.0011060836259275675
loss_pred:0.013464702293276787, decouple_loss:0.0011571805225685239
Iteration: 4458, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478796720504761, gen p mean: -0.04850025102496147, mean p set: 0.44835996627807617
loss_pred:0.013479075394570827, decouple_loss:0.0010264506563544273
The modified gen p mean: 0.450771301984787, gen p mean: -0.04539375379681587, mean p set: 0.4512515664100647The modified gen p mean: 0.4495620131492615, gen p mean: -0.04970802366733551, mean p set: 0.4500423073768616
loss_pred:0.013376726768910885, decouple_loss:0.001011002343147993
loss_pred:0.013413148932158947, decouple_loss:0.001058999914675951
Iteration: 4459, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502430558204651, gen p mean: -0.04617369920015335, mean p set: 0.4507233798503876
loss_pred:0.013342902995646, decouple_loss:0.0011701984331011772
The modified gen p mean: 0.4484518766403198, gen p mean: -0.046983443200588226, mean p set: 0.4489321708679199The modified gen p mean: 0.4502853751182556, gen p mean: -0.047649286687374115, mean p set: 0.4507656991481781
loss_pred:0.013254831545054913, decouple_loss:0.0012393371434882283
loss_pred:0.012979799881577492, decouple_loss:0.0013031389098614454
Iteration: 4460, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450539231300354, gen p mean: -0.04838663339614868, mean p set: 0.4510194957256317
loss_pred:0.012800040654838085, decouple_loss:0.0010267706820741296
The modified gen p mean: 0.44724041223526, gen p mean: -0.05286325141787529, mean p set: 0.4477207064628601The modified gen p mean: 0.44892197847366333, gen p mean: -0.05123645439743996, mean p set: 0.4494022727012634
loss_pred:0.012960421852767467, decouple_loss:0.0010632965713739395
loss_pred:0.014057982712984085, decouple_loss:0.0010338255669921637
2023-05-02 19:27:27 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.055939674377441406, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.05205132067203522, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.05214769020676613, mean p set: 0.4500633478164673
loss_pred:0.019004201516509056, decouple_loss:0.0012479169527068734
loss_pred:0.01793445646762848, decouple_loss:0.001174139673821628
loss_pred:0.017993565648794174, decouple_loss:0.0012543052434921265
WV_0_PC_1_EH_0_PS_40, loss: 0.01837201416492462, avg_mse: 0.02683749422430992
current test mse: 0.026837
Iteration: 4461, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44825124740600586, gen p mean: -0.05440056324005127, mean p set: 0.44873154163360596
The modified gen p mean: 0.44910553097724915, gen p mean: -0.05319365859031677, mean p set: 0.44958579540252686
The modified gen p mean: 0.4499286711215973, gen p mean: -0.052639979869127274, mean p set: 0.450408935546875
loss_pred:0.012824722565710545, decouple_loss:0.001299744937568903
loss_pred:0.012941663153469563, decouple_loss:0.001100966357626021
loss_pred:0.013580748811364174, decouple_loss:0.0011868916917592287
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012010_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012010_3_24hr.npz
NaN value num: 0
Iteration: 4462, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45270365476608276, gen p mean: -0.05172519385814667, mean p set: 0.45318397879600525
loss_pred:0.016413932666182518, decouple_loss:0.001114862971007824
The modified gen p mean: 0.4489378333091736, gen p mean: -0.04484972730278969, mean p set: 0.4494180977344513The modified gen p mean: 0.44998785853385925, gen p mean: -0.049733810126781464, mean p set: 0.45046815276145935
loss_pred:0.015705427154898643, decouple_loss:0.0011855096090584993
loss_pred:0.015619832091033459, decouple_loss:0.0011368639534339309
Iteration: 4463, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45253291726112366, gen p mean: -0.04825150594115257, mean p set: 0.45301321148872375
loss_pred:0.01632414199411869, decouple_loss:0.0009671926381997764
The modified gen p mean: 0.4517357051372528, gen p mean: -0.05011025071144104, mean p set: 0.4522160291671753The modified gen p mean: 0.45015931129455566, gen p mean: -0.04640071839094162, mean p set: 0.4506395757198334
loss_pred:0.01615877076983452, decouple_loss:0.0010202194098383188
loss_pred:0.015848666429519653, decouple_loss:0.0010726061882451177
Iteration: 4464, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511801600456238, gen p mean: -0.04540548101067543, mean p set: 0.4516604542732239
loss_pred:0.015820583328604698, decouple_loss:0.0010292284423485398
The modified gen p mean: 0.45147353410720825, gen p mean: -0.04370827600359917, mean p set: 0.45195385813713074The modified gen p mean: 0.4507720172405243, gen p mean: -0.04075751453638077, mean p set: 0.4512523412704468
loss_pred:0.01667974144220352, decouple_loss:0.0009719958761706948
loss_pred:0.016264533624053, decouple_loss:0.0010996697237715125
Iteration: 4465, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45095574855804443, gen p mean: -0.04104667901992798, mean p set: 0.45143604278564453
loss_pred:0.015357055701315403, decouple_loss:0.0011839020298793912
The modified gen p mean: 0.4513400197029114, gen p mean: -0.04021131247282028, mean p set: 0.4518203139305115The modified gen p mean: 0.45202934741973877, gen p mean: -0.04405490309000015, mean p set: 0.4525096118450165
loss_pred:0.016388412564992905, decouple_loss:0.0011934079229831696
loss_pred:0.015529599972069263, decouple_loss:0.0011473111808300018
Iteration: 4466, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514986574649811, gen p mean: -0.042874451726675034, mean p set: 0.4519789516925812
loss_pred:0.01659221574664116, decouple_loss:0.0011480896500870585
The modified gen p mean: 0.45183253288269043, gen p mean: -0.0407516174018383, mean p set: 0.4523128271102905The modified gen p mean: 0.45169636607170105, gen p mean: -0.04261281341314316, mean p set: 0.45217666029930115
loss_pred:0.015491897240281105, decouple_loss:0.001288449508138001
loss_pred:0.01588582992553711, decouple_loss:0.0011662882752716541
Iteration: 4467, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45082801580429077, gen p mean: -0.042537666857242584, mean p set: 0.45130833983421326
loss_pred:0.016170062124729156, decouple_loss:0.0010918386979028583
The modified gen p mean: 0.451960027217865, gen p mean: -0.041021060198545456, mean p set: 0.4524403214454651The modified gen p mean: 0.4516639709472656, gen p mean: -0.03657176345586777, mean p set: 0.4521442651748657
loss_pred:0.015523115172982216, decouple_loss:0.001184409367851913
loss_pred:0.015981551259756088, decouple_loss:0.0010000013280659914
Iteration: 4468, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511350989341736, gen p mean: -0.04289993271231651, mean p set: 0.4516153931617737
loss_pred:0.016506925225257874, decouple_loss:0.0011074368376284838
The modified gen p mean: 0.4520858824253082, gen p mean: -0.03816476836800575, mean p set: 0.4525661766529083The modified gen p mean: 0.45040854811668396, gen p mean: -0.04143916815519333, mean p set: 0.45088884234428406
loss_pred:0.01563955657184124, decouple_loss:0.00131617218721658
loss_pred:0.01674809679389, decouple_loss:0.0010647278977558017
Iteration: 4469, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513707756996155, gen p mean: -0.04702332615852356, mean p set: 0.4518510699272156
loss_pred:0.01625514030456543, decouple_loss:0.0010711213108152151
The modified gen p mean: 0.4518691301345825, gen p mean: -0.044343166053295135, mean p set: 0.452349454164505The modified gen p mean: 0.452846497297287, gen p mean: -0.04340646043419838, mean p set: 0.4533267617225647
loss_pred:0.015481384471058846, decouple_loss:0.0011827769922092557
loss_pred:0.0159673523157835, decouple_loss:0.0010790688684210181
Iteration: 4470, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44897574186325073, gen p mean: -0.03543705493211746, mean p set: 0.44945603609085083
loss_pred:0.015137569047510624, decouple_loss:0.0010631624609231949
The modified gen p mean: 0.45124655961990356, gen p mean: -0.043017905205488205, mean p set: 0.45172688364982605The modified gen p mean: 0.4496695399284363, gen p mean: -0.03650384768843651, mean p set: 0.4501498341560364
loss_pred:0.016539596021175385, decouple_loss:0.0010652787750586867
loss_pred:0.015395252965390682, decouple_loss:0.0010341259185224771
2023-05-02 19:30:00 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.048776447772979736, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830535888672, gen p mean: -0.045520927757024765, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987669587135315, gen p mean: -0.04551677778363228, mean p set: 0.45035696029663086
loss_pred:0.018611308187246323, decouple_loss:0.0012396953534334898
loss_pred:0.017596332356333733, decouple_loss:0.0012064236216247082
loss_pred:0.01751566492021084, decouple_loss:0.0013696127571165562
WV_0_PC_1_EH_0_PS_40, loss: 0.01797136478126049, avg_mse: 0.026024814695119858
current test mse: 0.026025
Iteration: 4471, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505375027656555, gen p mean: -0.037708647549152374, mean p set: 0.451017826795578
The modified gen p mean: 0.4519064426422119, gen p mean: -0.04377390444278717, mean p set: 0.452386736869812
The modified gen p mean: 0.4513089954853058, gen p mean: -0.04209831357002258, mean p set: 0.4517892897129059
loss_pred:0.01529232319444418, decouple_loss:0.0010105711407959461
loss_pred:0.01618352346122265, decouple_loss:0.0009569655521772802
loss_pred:0.01587483659386635, decouple_loss:0.000981292687356472
Iteration: 4472, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4527859091758728, gen p mean: -0.046679988503456116, mean p set: 0.4532662332057953
loss_pred:0.015808772295713425, decouple_loss:0.0010206560837104917
The modified gen p mean: 0.4501783549785614, gen p mean: -0.040361467748880386, mean p set: 0.4506586492061615The modified gen p mean: 0.45122531056404114, gen p mean: -0.04792643338441849, mean p set: 0.45170560479164124
loss_pred:0.015199827961623669, decouple_loss:0.0010185737628489733
loss_pred:0.015554249286651611, decouple_loss:0.001058588968589902
Iteration: 4473, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45302069187164307, gen p mean: -0.044734708964824677, mean p set: 0.45350101590156555
loss_pred:0.01594274677336216, decouple_loss:0.0010399972088634968
The modified gen p mean: 0.4539630711078644, gen p mean: -0.043791987001895905, mean p set: 0.4544433653354645The modified gen p mean: 0.4516013264656067, gen p mean: -0.0469101183116436, mean p set: 0.4520816504955292
loss_pred:0.0159069262444973, decouple_loss:0.0010822881013154984
loss_pred:0.016069382429122925, decouple_loss:0.0010639172978699207
Iteration: 4474, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4510897696018219, gen p mean: -0.04736732318997383, mean p set: 0.4515700936317444
loss_pred:0.015426842495799065, decouple_loss:0.0009708400466479361
The modified gen p mean: 0.44999122619628906, gen p mean: -0.04667067527770996, mean p set: 0.45047152042388916The modified gen p mean: 0.4520367980003357, gen p mean: -0.04918355867266655, mean p set: 0.4525170624256134
loss_pred:0.015179852023720741, decouple_loss:0.0010394530836492777
loss_pred:0.015895690768957138, decouple_loss:0.0010466461535543203
Iteration: 4475, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45329049229621887, gen p mean: -0.04615229740738869, mean p set: 0.45377078652381897
loss_pred:0.015536684542894363, decouple_loss:0.0010648759780451655
The modified gen p mean: 0.453398197889328, gen p mean: -0.04434070363640785, mean p set: 0.4538784623146057The modified gen p mean: 0.451240211725235, gen p mean: -0.04950299113988876, mean p set: 0.4517205059528351
loss_pred:0.015617342665791512, decouple_loss:0.0010189476888626814
loss_pred:0.01589948497712612, decouple_loss:0.0009832312352955341
Iteration: 4476, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505755603313446, gen p mean: -0.05163123458623886, mean p set: 0.4510558545589447
loss_pred:0.016172315925359726, decouple_loss:0.0010031808633357286
The modified gen p mean: 0.4508105218410492, gen p mean: -0.04628610983490944, mean p set: 0.4512908160686493The modified gen p mean: 0.4518813490867615, gen p mean: -0.04731951281428337, mean p set: 0.4523616135120392
loss_pred:0.016031449660658836, decouple_loss:0.0012003849260509014
loss_pred:0.015227945521473885, decouple_loss:0.0010809937957674265
Iteration: 4477, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496181607246399, gen p mean: -0.04314117133617401, mean p set: 0.4500984251499176
loss_pred:0.015399249270558357, decouple_loss:0.001248518587090075
The modified gen p mean: 0.4525480270385742, gen p mean: -0.047848254442214966, mean p set: 0.4530283212661743The modified gen p mean: 0.4537601172924042, gen p mean: -0.04721918702125549, mean p set: 0.4542403817176819
loss_pred:0.0159157644957304, decouple_loss:0.0009818475227802992
loss_pred:0.015603885985910892, decouple_loss:0.001199365477077663
Iteration: 4478, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514321982860565, gen p mean: -0.04935930296778679, mean p set: 0.4519124925136566
loss_pred:0.01679844968020916, decouple_loss:0.001137295737862587
The modified gen p mean: 0.4506036043167114, gen p mean: -0.04713686183094978, mean p set: 0.4510838985443115The modified gen p mean: 0.450985848903656, gen p mean: -0.048107024282217026, mean p set: 0.4514661431312561
loss_pred:0.015616056509315968, decouple_loss:0.00107569748070091
loss_pred:0.015544011257588863, decouple_loss:0.00110706000123173
Iteration: 4479, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4516017436981201, gen p mean: -0.04924651235342026, mean p set: 0.4520820379257202
loss_pred:0.016344483941793442, decouple_loss:0.001039201277308166
The modified gen p mean: 0.451686829328537, gen p mean: -0.05114647373557091, mean p set: 0.4521671235561371The modified gen p mean: 0.4518463611602783, gen p mean: -0.04330012574791908, mean p set: 0.4523266553878784
loss_pred:0.015573376789689064, decouple_loss:0.0010153070325031877
loss_pred:0.015989843755960464, decouple_loss:0.0009579987963661551
Iteration: 4480, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4525426924228668, gen p mean: -0.04316325858235359, mean p set: 0.4530230164527893
loss_pred:0.015514838509261608, decouple_loss:0.0012203947408124804
The modified gen p mean: 0.451517254114151, gen p mean: -0.04053449630737305, mean p set: 0.4519975483417511The modified gen p mean: 0.4517925977706909, gen p mean: -0.04846759885549545, mean p set: 0.45227286219596863
loss_pred:0.015119558200240135, decouple_loss:0.0010369729716330767
loss_pred:0.01555110327899456, decouple_loss:0.0011184609029442072
2023-05-02 19:31:55 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.048163026571273804, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04481847211718559, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.044903770089149475, mean p set: 0.4500633478164673
loss_pred:0.018651125952601433, decouple_loss:0.00152286933735013
loss_pred:0.01757468469440937, decouple_loss:0.0014254421694204211
loss_pred:0.01763002946972847, decouple_loss:0.001386883552186191
WV_0_PC_1_EH_0_PS_40, loss: 0.018024202436208725, avg_mse: 0.02610696852207184
current test mse: 0.026107
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012003_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012003_3_24hr.npz
NaN value num: 0
Iteration: 4481, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45107409358024597, gen p mean: -0.03940585255622864, mean p set: 0.45155444741249084
loss_pred:0.014877449721097946, decouple_loss:0.001211291877552867
The modified gen p mean: 0.44986605644226074, gen p mean: -0.03803981840610504, mean p set: 0.45034632086753845The modified gen p mean: 0.45076966285705566, gen p mean: -0.03583554923534393, mean p set: 0.45124995708465576
loss_pred:0.015190529637038708, decouple_loss:0.0011434686603024602loss_pred:0.015012199990451336, decouple_loss:0.0014077265514060855
Iteration: 4482, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497283101081848, gen p mean: -0.038799867033958435, mean p set: 0.4502086043357849
loss_pred:0.015157170593738556, decouple_loss:0.001124227070249617
The modified gen p mean: 0.4525086283683777, gen p mean: -0.038215264678001404, mean p set: 0.4529889225959778The modified gen p mean: 0.45181411504745483, gen p mean: -0.035639144480228424, mean p set: 0.45229440927505493
loss_pred:0.016087548807263374, decouple_loss:0.0010924955131486058
loss_pred:0.015104727819561958, decouple_loss:0.001148607931099832
Iteration: 4483, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511014521121979, gen p mean: -0.04146834835410118, mean p set: 0.4515817165374756
loss_pred:0.01578916423022747, decouple_loss:0.0011490413453429937
The modified gen p mean: 0.4518912732601166, gen p mean: -0.04035382717847824, mean p set: 0.4523715376853943The modified gen p mean: 0.45121800899505615, gen p mean: -0.037289101630449295, mean p set: 0.45169830322265625
loss_pred:0.014794888906180859, decouple_loss:0.0010282342555001378
loss_pred:0.014732087962329388, decouple_loss:0.0011351968860253692
Iteration: 4484, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44996029138565063, gen p mean: -0.0433967262506485, mean p set: 0.45044055581092834
The modified gen p mean: 0.4515930414199829, gen p mean: -0.04425779730081558, mean p set: 0.4520733654499054
loss_pred:0.015856102108955383, decouple_loss:0.001002871198579669
loss_pred:0.015323606319725513, decouple_loss:0.0010442142374813557
The modified gen p mean: 0.4512656629085541, gen p mean: -0.0444747619330883, mean p set: 0.4517459571361542
loss_pred:0.01475517451763153, decouple_loss:0.0010277165565639734
Iteration: 4485, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45129311084747314, gen p mean: -0.0486966110765934, mean p set: 0.45177337527275085
loss_pred:0.015435785986483097, decouple_loss:0.0009399988921359181
The modified gen p mean: 0.45086032152175903, gen p mean: -0.04929690062999725, mean p set: 0.45134058594703674
The modified gen p mean: 0.4503079950809479, gen p mean: -0.0508052259683609, mean p set: 0.450788289308548
loss_pred:0.014902409166097641, decouple_loss:0.000996731803752482
loss_pred:0.01535880845040083, decouple_loss:0.0010268408805131912
Iteration: 4486, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45187821984291077, gen p mean: -0.049511298537254333, mean p set: 0.45235851407051086
loss_pred:0.015630684792995453, decouple_loss:0.0010661393171176314
The modified gen p mean: 0.4520137310028076, gen p mean: -0.04637695848941803, mean p set: 0.4524940252304077The modified gen p mean: 0.45061710476875305, gen p mean: -0.05039496347308159, mean p set: 0.45109736919403076
loss_pred:0.01480295043438673, decouple_loss:0.0010820729658007622
loss_pred:0.015102164819836617, decouple_loss:0.0010348502546548843
Iteration: 4487, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45045846700668335, gen p mean: -0.05285769701004028, mean p set: 0.45093876123428345
loss_pred:0.015218844637274742, decouple_loss:0.0010406329529359937
The modified gen p mean: 0.451941579580307, gen p mean: -0.05194387212395668, mean p set: 0.4524218738079071The modified gen p mean: 0.45170214772224426, gen p mean: -0.05169815570116043, mean p set: 0.45218244194984436
loss_pred:0.01482737623155117, decouple_loss:0.0010525009129196405
loss_pred:0.015491423197090626, decouple_loss:0.0010961074149236083
Iteration: 4488, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4518289268016815, gen p mean: -0.04997563362121582, mean p set: 0.4523092210292816
loss_pred:0.015169565565884113, decouple_loss:0.0009855550015345216
The modified gen p mean: 0.44994911551475525, gen p mean: -0.05141526833176613, mean p set: 0.45042940974235535The modified gen p mean: 0.45287275314331055, gen p mean: -0.05062039569020271, mean p set: 0.45335304737091064
loss_pred:0.01577070541679859, decouple_loss:0.0010012591956183314
loss_pred:0.015688102692365646, decouple_loss:0.0010023131035268307
Iteration: 4489, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4521043300628662, gen p mean: -0.05113101750612259, mean p set: 0.4525846242904663
loss_pred:0.015046840533614159, decouple_loss:0.0011151408543810248
The modified gen p mean: 0.4513220489025116, gen p mean: -0.047199320048093796, mean p set: 0.4518023431301117The modified gen p mean: 0.4514588415622711, gen p mean: -0.04648488387465477, mean p set: 0.4519391357898712
loss_pred:0.015002080239355564, decouple_loss:0.0010773084359243512
loss_pred:0.014504334889352322, decouple_loss:0.0011741479393094778
Iteration: 4490, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45191967487335205, gen p mean: -0.04963916912674904, mean p set: 0.45239993929862976
loss_pred:0.015174126252532005, decouple_loss:0.001028935075737536
The modified gen p mean: 0.45172634720802307, gen p mean: -0.05312186852097511, mean p set: 0.45220664143562317The modified gen p mean: 0.45082539319992065, gen p mean: -0.049138568341732025, mean p set: 0.45130568742752075
loss_pred:0.014710338786244392, decouple_loss:0.0010395441204309464
loss_pred:0.014809681102633476, decouple_loss:0.0009972461266443133
2023-05-02 19:34:27 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.056783437728881836, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.05302172899246216, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.05326501652598381, mean p set: 0.4500633478164673
loss_pred:0.01849423721432686, decouple_loss:0.00113523134496063
loss_pred:0.01743634045124054, decouple_loss:0.0011101518757641315
loss_pred:0.01746096834540367, decouple_loss:0.00113201467320323
WV_0_PC_1_EH_0_PS_40, loss: 0.017853472381830215, avg_mse: 0.025797884911298752
current test mse: 0.025798
Iteration: 4491, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4518243372440338, gen p mean: -0.050740763545036316, mean p set: 0.4523046314716339
The modified gen p mean: 0.4512845575809479, gen p mean: -0.04761664941906929, mean p set: 0.45176488161087036
The modified gen p mean: 0.4522086977958679, gen p mean: -0.04845177382230759, mean p set: 0.45268896222114563
loss_pred:0.01467151753604412, decouple_loss:0.0010824191849678755
loss_pred:0.015034018084406853, decouple_loss:0.0009376177913509309loss_pred:0.015032040886580944, decouple_loss:0.0009251221781596541
Iteration: 4492, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45102256536483765, gen p mean: -0.04388200864195824, mean p set: 0.45150282979011536
loss_pred:0.014923031441867352, decouple_loss:0.0009319133823737502
The modified gen p mean: 0.4506872892379761, gen p mean: -0.04558560997247696, mean p set: 0.45116758346557617The modified gen p mean: 0.44978272914886475, gen p mean: -0.04294738918542862, mean p set: 0.45026299357414246
loss_pred:0.015541549772024155, decouple_loss:0.0010638678213581443
loss_pred:0.01495868619531393, decouple_loss:0.0010620257817208767
Iteration: 4493, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4510365128517151, gen p mean: -0.04505887255072594, mean p set: 0.4515168070793152
The modified gen p mean: 0.45116060972213745, gen p mean: -0.04517955332994461, mean p set: 0.45164093375205994
loss_pred:0.014895932748913765, decouple_loss:0.0010616739746183157
loss_pred:0.014612135477364063, decouple_loss:0.0010743919992819428
The modified gen p mean: 0.45056816935539246, gen p mean: -0.04600004479289055, mean p set: 0.45104846358299255
loss_pred:0.014981486834585667, decouple_loss:0.001123795984312892
Iteration: 4494, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45319584012031555, gen p mean: -0.04063655436038971, mean p set: 0.45367616415023804
loss_pred:0.015699559822678566, decouple_loss:0.0009840431157499552
The modified gen p mean: 0.4518909454345703, gen p mean: -0.04154222086071968, mean p set: 0.4523712396621704The modified gen p mean: 0.4522443115711212, gen p mean: -0.0472397655248642, mean p set: 0.4527246057987213
loss_pred:0.014669934287667274, decouple_loss:0.0009144473006017506
loss_pred:0.015828538686037064, decouple_loss:0.001066403230652213
Iteration: 4495, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496269226074219, gen p mean: -0.04721982777118683, mean p set: 0.45010724663734436
loss_pred:0.015042091719806194, decouple_loss:0.0009784131543710828
The modified gen p mean: 0.4502285420894623, gen p mean: -0.04475690424442291, mean p set: 0.4507088363170624The modified gen p mean: 0.4518422484397888, gen p mean: -0.0440526008605957, mean p set: 0.4523225724697113
loss_pred:0.014959735795855522, decouple_loss:0.0010283425217494369
loss_pred:0.014462389051914215, decouple_loss:0.0009805302834138274
Iteration: 4496, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514724612236023, gen p mean: -0.04553169757127762, mean p set: 0.4519527554512024
loss_pred:0.014647240750491619, decouple_loss:0.00103334232699126
The modified gen p mean: 0.45046862959861755, gen p mean: -0.04566594585776329, mean p set: 0.45094895362854004The modified gen p mean: 0.45255526900291443, gen p mean: -0.04430726543068886, mean p set: 0.45303553342819214
loss_pred:0.015109570696949959, decouple_loss:0.0009285553824156523
loss_pred:0.01500261016190052, decouple_loss:0.0010512638837099075
Iteration: 4497, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45262861251831055, gen p mean: -0.046863771975040436, mean p set: 0.45310890674591064
loss_pred:0.014761045575141907, decouple_loss:0.0009789678733795881
The modified gen p mean: 0.4511999487876892, gen p mean: -0.04575056955218315, mean p set: 0.4516802132129669The modified gen p mean: 0.45068761706352234, gen p mean: -0.04633459076285362, mean p set: 0.45116788148880005
loss_pred:0.014462948776781559, decouple_loss:0.001130316173657775
loss_pred:0.015425075776875019, decouple_loss:0.00103932770434767
Iteration: 4498, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4533810317516327, gen p mean: -0.04775365814566612, mean p set: 0.4538613259792328
loss_pred:0.015158755704760551, decouple_loss:0.001099587301723659
The modified gen p mean: 0.45203185081481934, gen p mean: -0.04558660089969635, mean p set: 0.45251214504241943
The modified gen p mean: 0.45282426476478577, gen p mean: -0.04611571133136749, mean p set: 0.4533045291900635
loss_pred:0.015340522862970829, decouple_loss:0.0009982121409848332
loss_pred:0.014622929506003857, decouple_loss:0.0010936598991975188
Iteration: 4499, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45080623030662537, gen p mean: -0.05180896818637848, mean p set: 0.45128652453422546
loss_pred:0.014892146922647953, decouple_loss:0.0010543728712946177
The modified gen p mean: 0.4504478871822357, gen p mean: -0.05530192330479622, mean p set: 0.4509281814098358The modified gen p mean: 0.45057961344718933, gen p mean: -0.048571351915597916, mean p set: 0.4510599374771118
loss_pred:0.015375792048871517, decouple_loss:0.0010476020397618413
loss_pred:0.015101444907486439, decouple_loss:0.0009845391614362597
Iteration: 4500, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500848054885864, gen p mean: -0.051186710596084595, mean p set: 0.4505651295185089
loss_pred:0.015218098647892475, decouple_loss:0.0010537662310525775
The modified gen p mean: 0.4492797553539276, gen p mean: -0.04628260061144829, mean p set: 0.4497600495815277The modified gen p mean: 0.4504152536392212, gen p mean: -0.04805115610361099, mean p set: 0.4508955478668213
loss_pred:0.015298347920179367, decouple_loss:0.00096957414643839
loss_pred:0.014838900417089462, decouple_loss:0.0009434515959583223
2023-05-02 19:36:21 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.05521085113286972, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.05169900879263878, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.05187908932566643, mean p set: 0.4500633478164673
loss_pred:0.018487442284822464, decouple_loss:0.0012075112899765372
loss_pred:0.0173687394708395, decouple_loss:0.001215640688315034
loss_pred:0.017476428300142288, decouple_loss:0.0012292898027226329
WV_0_PC_1_EH_0_PS_40, loss: 0.017838411033153534, avg_mse: 0.02574724517762661
current test mse: 0.025747
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012015_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012015_3_24hr.npz
NaN value num: 0
Iteration: 4501, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465615153312683, gen p mean: -0.05626463145017624, mean p set: 0.4470418095588684
loss_pred:0.014766528271138668, decouple_loss:0.0011208028299733996
The modified gen p mean: 0.4463682174682617, gen p mean: -0.05660315603017807, mean p set: 0.4468485414981842The modified gen p mean: 0.44583046436309814, gen p mean: -0.055483024567365646, mean p set: 0.44631072878837585
loss_pred:0.014531116932630539, decouple_loss:0.001257644616998732
loss_pred:0.01440572738647461, decouple_loss:0.001087757758796215
Iteration: 4502, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44665974378585815, gen p mean: -0.055773258209228516, mean p set: 0.44714006781578064
loss_pred:0.014904134906828403, decouple_loss:0.0010519588831812143
The modified gen p mean: 0.4463280439376831, gen p mean: -0.053554486483335495, mean p set: 0.4468083381652832The modified gen p mean: 0.4465227425098419, gen p mean: -0.05246876925230026, mean p set: 0.447003036737442
loss_pred:0.014366132207214832, decouple_loss:0.0010589919984340668
loss_pred:0.014783659018576145, decouple_loss:0.0010176774812862277
Iteration: 4503, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470646381378174, gen p mean: -0.05424414575099945, mean p set: 0.4475449025630951
The modified gen p mean: 0.4456939995288849, gen p mean: -0.05756083130836487, mean p set: 0.446174293756485
loss_pred:0.014807827770709991, decouple_loss:0.0010500650387257338
loss_pred:0.01465337723493576, decouple_loss:0.001141213346272707The modified gen p mean: 0.445913702249527, gen p mean: -0.05472991243004799, mean p set: 0.44639402627944946
loss_pred:0.0144356619566679, decouple_loss:0.0010410562390461564
Iteration: 4504, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44563719630241394, gen p mean: -0.054785411804914474, mean p set: 0.44611749053001404
loss_pred:0.01426204014569521, decouple_loss:0.0010568259749561548
The modified gen p mean: 0.44701582193374634, gen p mean: -0.06375397741794586, mean p set: 0.44749611616134644The modified gen p mean: 0.4471549987792969, gen p mean: -0.05347856879234314, mean p set: 0.44763532280921936
loss_pred:0.014423821121454239, decouple_loss:0.0010259648552164435
loss_pred:0.014780337922275066, decouple_loss:0.0011026859283447266
Iteration: 4505, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471542239189148, gen p mean: -0.059020478278398514, mean p set: 0.4476345181465149
loss_pred:0.014385141432285309, decouple_loss:0.0010952033335343003
The modified gen p mean: 0.4451724886894226, gen p mean: -0.0592542327940464, mean p set: 0.4456527829170227The modified gen p mean: 0.4457946717739105, gen p mean: -0.05758159980177879, mean p set: 0.446274995803833
loss_pred:0.014446606859564781, decouple_loss:0.0011455522617325187
loss_pred:0.014901231043040752, decouple_loss:0.0011187837226316333
Iteration: 4506, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44558167457580566, gen p mean: -0.05882341042160988, mean p set: 0.44606199860572815
loss_pred:0.014205379411578178, decouple_loss:0.0010184121783822775
The modified gen p mean: 0.4458606541156769, gen p mean: -0.05927377939224243, mean p set: 0.4463409185409546The modified gen p mean: 0.44660240411758423, gen p mean: -0.059931013733148575, mean p set: 0.4470827281475067
loss_pred:0.014355954714119434, decouple_loss:0.001102351932786405
loss_pred:0.014010689221322536, decouple_loss:0.0010525721590965986
Iteration: 4507, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471440613269806, gen p mean: -0.05549129843711853, mean p set: 0.4476243555545807
loss_pred:0.014442218467593193, decouple_loss:0.0011066586012020707
The modified gen p mean: 0.44547611474990845, gen p mean: -0.05797860398888588, mean p set: 0.44595643877983093The modified gen p mean: 0.44659748673439026, gen p mean: -0.057458002120256424, mean p set: 0.44707778096199036
loss_pred:0.013978227972984314, decouple_loss:0.0010526200057938695
loss_pred:0.014311319217085838, decouple_loss:0.0011487106094136834
Iteration: 4508, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44681504368782043, gen p mean: -0.054201673716306686, mean p set: 0.44729533791542053
loss_pred:0.01413229014724493, decouple_loss:0.0010158579098060727
The modified gen p mean: 0.44587963819503784, gen p mean: -0.05531001091003418, mean p set: 0.4463599622249603The modified gen p mean: 0.44618162512779236, gen p mean: -0.05041726306080818, mean p set: 0.44666188955307007
loss_pred:0.014698496088385582, decouple_loss:0.0011212511453777552
loss_pred:0.01448017917573452, decouple_loss:0.0010021632770076394
Iteration: 4509, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44675591588020325, gen p mean: -0.049708444625139236, mean p set: 0.44723621010780334
loss_pred:0.014181475155055523, decouple_loss:0.0010388389928266406
The modified gen p mean: 0.44671282172203064, gen p mean: -0.05514640361070633, mean p set: 0.44719311594963074The modified gen p mean: 0.4465557038784027, gen p mean: -0.05521220713853836, mean p set: 0.4470359981060028
loss_pred:0.01387939602136612, decouple_loss:0.0010439860634505749
loss_pred:0.014127177186310291, decouple_loss:0.0009532147087156773
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 4510, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44696277379989624, gen p mean: -0.053317561745643616, mean p set: 0.44744303822517395
loss_pred:0.014606689102947712, decouple_loss:0.0011933716014027596
The modified gen p mean: 0.44717806577682495, gen p mean: -0.05223800987005234, mean p set: 0.44765836000442505The modified gen p mean: 0.446176677942276, gen p mean: -0.051117803901433945, mean p set: 0.4466569721698761
loss_pred:0.013926370069384575, decouple_loss:0.0010795973939821124
loss_pred:0.014646271243691444, decouple_loss:0.0011123708682134748
2023-05-02 19:39:00 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.05050947144627571, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04713361710309982, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.04724505543708801, mean p set: 0.4500633478164673
loss_pred:0.018876492977142334, decouple_loss:0.0011079630348831415
loss_pred:0.017805637791752815, decouple_loss:0.0011134841479361057
loss_pred:0.01785847172141075, decouple_loss:0.0011345244711264968
WV_0_PC_1_EH_0_PS_40, loss: 0.018236134201288223, avg_mse: 0.02653847075998783
current test mse: 0.026538
Iteration: 4511, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4449183940887451, gen p mean: -0.05225062370300293, mean p set: 0.4453986883163452
The modified gen p mean: 0.44665905833244324, gen p mean: -0.05428271368145943, mean p set: 0.44713932275772095
The modified gen p mean: 0.44647127389907837, gen p mean: -0.05012569949030876, mean p set: 0.44695156812667847
loss_pred:0.014659916050732136, decouple_loss:0.0010666274465620518
loss_pred:0.014829580672085285, decouple_loss:0.0011069757165387273loss_pred:0.014204698614776134, decouple_loss:0.0010712376097217202
Iteration: 4512, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465024173259735, gen p mean: -0.052098583430051804, mean p set: 0.446982741355896
loss_pred:0.014432020485401154, decouple_loss:0.0010708774207159877
The modified gen p mean: 0.44705435633659363, gen p mean: -0.05194456875324249, mean p set: 0.4475346803665161The modified gen p mean: 0.44546782970428467, gen p mean: -0.049811091274023056, mean p set: 0.4459480941295624
loss_pred:0.015116002410650253, decouple_loss:0.0010656306985765696
loss_pred:0.013885815627872944, decouple_loss:0.0010500564239919186
Iteration: 4513, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4460996687412262, gen p mean: -0.053154755383729935, mean p set: 0.4465799629688263
loss_pred:0.01382608525454998, decouple_loss:0.001021429430693388
The modified gen p mean: 0.4476238787174225, gen p mean: -0.05491235852241516, mean p set: 0.4481041729450226The modified gen p mean: 0.4471602141857147, gen p mean: -0.05721274018287659, mean p set: 0.4476405084133148
loss_pred:0.014864731580018997, decouple_loss:0.001019271439872682
loss_pred:0.014133524149656296, decouple_loss:0.0010162558173760772
Iteration: 4514, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476493299007416, gen p mean: -0.05286697298288345, mean p set: 0.44812965393066406
loss_pred:0.014537177979946136, decouple_loss:0.001071901642717421
The modified gen p mean: 0.4470517337322235, gen p mean: -0.05786260589957237, mean p set: 0.4475320279598236The modified gen p mean: 0.4459589421749115, gen p mean: -0.056246567517519, mean p set: 0.4464392364025116
loss_pred:0.01380819920450449, decouple_loss:0.000989441992715001
loss_pred:0.014204329811036587, decouple_loss:0.0011293798452243209
Iteration: 4515, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44722798466682434, gen p mean: -0.055824048817157745, mean p set: 0.44770827889442444
loss_pred:0.014543467201292515, decouple_loss:0.0010213555069640279
The modified gen p mean: 0.44706955552101135, gen p mean: -0.05474625527858734, mean p set: 0.44754984974861145The modified gen p mean: 0.44556576013565063, gen p mean: -0.05785369873046875, mean p set: 0.44604605436325073
loss_pred:0.014146493747830391, decouple_loss:0.0010874733561649919
loss_pred:0.014060605317354202, decouple_loss:0.0011384676909074187
Iteration: 4516, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44592511653900146, gen p mean: -0.053056541830301285, mean p set: 0.44640541076660156
loss_pred:0.014211121946573257, decouple_loss:0.0010885357623919845
The modified gen p mean: 0.44599515199661255, gen p mean: -0.05453963205218315, mean p set: 0.44647544622421265The modified gen p mean: 0.44647565484046936, gen p mean: -0.05412794649600983, mean p set: 0.44695594906806946
loss_pred:0.013641445897519588, decouple_loss:0.0011131752980872989
loss_pred:0.014878992922604084, decouple_loss:0.0011185412295162678
Iteration: 4517, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464186131954193, gen p mean: -0.04913388937711716, mean p set: 0.4468989372253418
loss_pred:0.01435925718396902, decouple_loss:0.001049370039254427
The modified gen p mean: 0.4467942416667938, gen p mean: -0.05085228756070137, mean p set: 0.4472745358943939
The modified gen p mean: 0.4473857581615448, gen p mean: -0.051783330738544464, mean p set: 0.4478660225868225
loss_pred:0.013832220807671547, decouple_loss:0.0010446641827002168
loss_pred:0.015167545527219772, decouple_loss:0.001051317434757948
Iteration: 4518, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465303421020508, gen p mean: -0.04915285483002663, mean p set: 0.4470106363296509
loss_pred:0.014283854514360428, decouple_loss:0.0010036007734015584
The modified gen p mean: 0.44630181789398193, gen p mean: -0.04732212424278259, mean p set: 0.44678211212158203The modified gen p mean: 0.44418954849243164, gen p mean: -0.0494130402803421, mean p set: 0.44466984272003174
loss_pred:0.014185772277414799, decouple_loss:0.0010829137172549963
loss_pred:0.014501271769404411, decouple_loss:0.0011828767601400614
Iteration: 4519, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479641318321228, gen p mean: -0.0488886833190918, mean p set: 0.4484444558620453
loss_pred:0.01476795133203268, decouple_loss:0.0010178182274103165
The modified gen p mean: 0.4464435279369354, gen p mean: -0.051136162132024765, mean p set: 0.4469238221645355
The modified gen p mean: 0.44704344868659973, gen p mean: -0.05139411613345146, mean p set: 0.44752374291419983
loss_pred:0.015022645704448223, decouple_loss:0.001018028357066214
loss_pred:0.014852119609713554, decouple_loss:0.0009926663478836417
Iteration: 4520, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44683513045310974, gen p mean: -0.05322277173399925, mean p set: 0.44731536507606506
loss_pred:0.01462547667324543, decouple_loss:0.0009742320398800075
The modified gen p mean: 0.44725629687309265, gen p mean: -0.05392765998840332, mean p set: 0.44773659110069275
The modified gen p mean: 0.44692474603652954, gen p mean: -0.052977077662944794, mean p set: 0.447405070066452
loss_pred:0.013841208070516586, decouple_loss:0.0010218212846666574
loss_pred:0.013791642151772976, decouple_loss:0.0010002617491409183
2023-05-02 19:40:55 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.05296437069773674, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.049215178936719894, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04949108883738518, mean p set: 0.4500633478164673
loss_pred:0.01881711557507515, decouple_loss:0.001058713998645544
loss_pred:0.01766972988843918, decouple_loss:0.001099815359339118
loss_pred:0.017792977392673492, decouple_loss:0.0011244536144658923
WV_0_PC_1_EH_0_PS_40, loss: 0.018147990107536316, avg_mse: 0.026418009772896767
current test mse: 0.026418
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012016_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012016_3_24hr.npz
NaN value num: 0
Iteration: 4521, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478148818016052, gen p mean: -0.05712074413895607, mean p set: 0.4482952058315277
loss_pred:0.01385105587542057, decouple_loss:0.0010216748341917992
The modified gen p mean: 0.4474899172782898, gen p mean: -0.050212882459163666, mean p set: 0.4479702413082123The modified gen p mean: 0.4471185505390167, gen p mean: -0.05041787773370743, mean p set: 0.4475988745689392
loss_pred:0.013743182644248009, decouple_loss:0.001248798449523747
loss_pred:0.014094628393650055, decouple_loss:0.0010577418142929673
Iteration: 4522, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471803605556488, gen p mean: -0.0525604784488678, mean p set: 0.4476606547832489
loss_pred:0.014026663266122341, decouple_loss:0.0009931670501828194
The modified gen p mean: 0.44654354453086853, gen p mean: -0.053101420402526855, mean p set: 0.44702383875846863The modified gen p mean: 0.44744566082954407, gen p mean: -0.055085260421037674, mean p set: 0.44792598485946655
loss_pred:0.014077299274504185, decouple_loss:0.00101902533788234
loss_pred:0.014001665636897087, decouple_loss:0.0010261114221066236
Iteration: 4523, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480352997779846, gen p mean: -0.05423617362976074, mean p set: 0.4485156238079071
loss_pred:0.013390694744884968, decouple_loss:0.0010690914932638407
The modified gen p mean: 0.44710057973861694, gen p mean: -0.06084837764501572, mean p set: 0.44758090376853943The modified gen p mean: 0.44720011949539185, gen p mean: -0.0570121593773365, mean p set: 0.44768041372299194
loss_pred:0.013455123640596867, decouple_loss:0.0011289261747151613
loss_pred:0.013933016918599606, decouple_loss:0.0011268012458458543
Iteration: 4524, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4462769329547882, gen p mean: -0.0532865971326828, mean p set: 0.4467572569847107
loss_pred:0.01352438423782587, decouple_loss:0.0009516174322925508
The modified gen p mean: 0.44723114371299744, gen p mean: -0.05691392719745636, mean p set: 0.44771143794059753The modified gen p mean: 0.4476642608642578, gen p mean: -0.05265780910849571, mean p set: 0.4481445848941803
loss_pred:0.013789232820272446, decouple_loss:0.001126002287492156
loss_pred:0.014478483237326145, decouple_loss:0.0012154331197962165
Iteration: 4525, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4463063180446625, gen p mean: -0.05515156686306, mean p set: 0.44678664207458496
loss_pred:0.013778259046375751, decouple_loss:0.001022191601805389
The modified gen p mean: 0.44800665974617004, gen p mean: -0.05735881254076958, mean p set: 0.44848695397377014
The modified gen p mean: 0.447537362575531, gen p mean: -0.05620617792010307, mean p set: 0.4480176270008087
loss_pred:0.013804739341139793, decouple_loss:0.0010865549556910992
loss_pred:0.01392284408211708, decouple_loss:0.0011289993999525905
Iteration: 4526, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475558400154114, gen p mean: -0.05168331414461136, mean p set: 0.4480361342430115
loss_pred:0.014094356447458267, decouple_loss:0.0011384107638150454
The modified gen p mean: 0.44715288281440735, gen p mean: -0.054010216146707535, mean p set: 0.44763314723968506The modified gen p mean: 0.4476320445537567, gen p mean: -0.05112752690911293, mean p set: 0.4481123387813568
loss_pred:0.014342185109853745, decouple_loss:0.0012628162512555718
loss_pred:0.013276677578687668, decouple_loss:0.0009993592975661159
Iteration: 4527, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473235309123993, gen p mean: -0.05342361703515053, mean p set: 0.4478038251399994
loss_pred:0.013775202445685863, decouple_loss:0.0010423825588077307
The modified gen p mean: 0.44772136211395264, gen p mean: -0.056456539779901505, mean p set: 0.44820162653923035The modified gen p mean: 0.4485894441604614, gen p mean: -0.05410172417759895, mean p set: 0.4490697383880615
loss_pred:0.014116779901087284, decouple_loss:0.0010825679637491703
loss_pred:0.013448178768157959, decouple_loss:0.0010882095666602254
Iteration: 4528, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475240707397461, gen p mean: -0.05896797776222229, mean p set: 0.4480043649673462
loss_pred:0.014189941808581352, decouple_loss:0.0010000905022025108
The modified gen p mean: 0.44707900285720825, gen p mean: -0.051467545330524445, mean p set: 0.44755926728248596The modified gen p mean: 0.4472975432872772, gen p mean: -0.055264562368392944, mean p set: 0.4477778375148773
loss_pred:0.01338249258697033, decouple_loss:0.0010369860101491213
loss_pred:0.014523380436003208, decouple_loss:0.001144219422712922
Iteration: 4529, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44729742407798767, gen p mean: -0.05475897714495659, mean p set: 0.44777771830558777
loss_pred:0.013766627758741379, decouple_loss:0.0010541422525420785
The modified gen p mean: 0.44785478711128235, gen p mean: -0.054518114775419235, mean p set: 0.44833505153656006The modified gen p mean: 0.44701892137527466, gen p mean: -0.05492372065782547, mean p set: 0.44749921560287476
loss_pred:0.013958211056888103, decouple_loss:0.0011773976730182767
loss_pred:0.014246409758925438, decouple_loss:0.0010671387426555157
Iteration: 4530, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479086697101593, gen p mean: -0.05185353010892868, mean p set: 0.4483889639377594
loss_pred:0.013665114529430866, decouple_loss:0.001035436987876892
The modified gen p mean: 0.4477413594722748, gen p mean: -0.054826755076646805, mean p set: 0.4482216238975525The modified gen p mean: 0.44719043374061584, gen p mean: -0.057421423494815826, mean p set: 0.44767072796821594
loss_pred:0.014226331375539303, decouple_loss:0.001034631859511137
loss_pred:0.014063339680433273, decouple_loss:0.001023239572532475
2023-05-02 19:43:27 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.0537068173289299, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04979695379734039, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.05003349110484123, mean p set: 0.4500633478164673
loss_pred:0.01894308812916279, decouple_loss:0.0011531710624694824
loss_pred:0.017850086092948914, decouple_loss:0.0011359511408954859
loss_pred:0.017918098717927933, decouple_loss:0.0011279031168669462
WV_0_PC_1_EH_0_PS_40, loss: 0.018294041976332664, avg_mse: 0.02670731022953987
current test mse: 0.026707
Iteration: 4531, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469631314277649, gen p mean: -0.051682885736227036, mean p set: 0.447443425655365
The modified gen p mean: 0.44759687781333923, gen p mean: -0.05085962638258934, mean p set: 0.44807714223861694
The modified gen p mean: 0.44758734107017517, gen p mean: -0.053292885422706604, mean p set: 0.44806763529777527
loss_pred:0.013552768155932426, decouple_loss:0.0011520420666784048
loss_pred:0.01380865927785635, decouple_loss:0.0008951599011197686
loss_pred:0.013731293380260468, decouple_loss:0.0010633515194058418
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 4532, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44698387384414673, gen p mean: -0.051199525594711304, mean p set: 0.4474641680717468
loss_pred:0.014118188060820103, decouple_loss:0.0009863022714853287
The modified gen p mean: 0.4475800395011902, gen p mean: -0.054532017558813095, mean p set: 0.4480603337287903The modified gen p mean: 0.44665274024009705, gen p mean: -0.04892631992697716, mean p set: 0.44713303446769714
loss_pred:0.013380257412791252, decouple_loss:0.0009277691133320332
loss_pred:0.013563189655542374, decouple_loss:0.0010283129522576928
Iteration: 4533, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476645588874817, gen p mean: -0.054551735520362854, mean p set: 0.4481448233127594
loss_pred:0.014173315837979317, decouple_loss:0.0010863286443054676
The modified gen p mean: 0.4476197361946106, gen p mean: -0.049844902008771896, mean p set: 0.4481000304222107
The modified gen p mean: 0.44760948419570923, gen p mean: -0.04961635172367096, mean p set: 0.4480897784233093
loss_pred:0.013771215453743935, decouple_loss:0.0011541928397491574
loss_pred:0.013839544728398323, decouple_loss:0.0010873671853914857
Iteration: 4534, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469161927700043, gen p mean: -0.058217499405145645, mean p set: 0.44739648699760437
loss_pred:0.014376161620020866, decouple_loss:0.000939335091970861
The modified gen p mean: 0.4477905035018921, gen p mean: -0.05501499027013779, mean p set: 0.4482708275318146The modified gen p mean: 0.4471842646598816, gen p mean: -0.05081825330853462, mean p set: 0.4476645588874817
loss_pred:0.014303184114396572, decouple_loss:0.0010441055055707693
loss_pred:0.013892334885895252, decouple_loss:0.0010185583960264921
Iteration: 4535, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44735559821128845, gen p mean: -0.051912274211645126, mean p set: 0.44783589243888855
loss_pred:0.013442846946418285, decouple_loss:0.0009954961715266109
The modified gen p mean: 0.4481312930583954, gen p mean: -0.05298278480768204, mean p set: 0.4486115872859955The modified gen p mean: 0.44776326417922974, gen p mean: -0.05683303624391556, mean p set: 0.44824355840682983
loss_pred:0.01398355234414339, decouple_loss:0.0011346867540851235
loss_pred:0.013958817347884178, decouple_loss:0.0009421781869605184
Iteration: 4536, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483295977115631, gen p mean: -0.05767654627561569, mean p set: 0.4488099217414856
loss_pred:0.014269853010773659, decouple_loss:0.0010960877407342196
The modified gen p mean: 0.44858667254447937, gen p mean: -0.055726345628499985, mean p set: 0.4490669369697571
The modified gen p mean: 0.4475264549255371, gen p mean: -0.05687890946865082, mean p set: 0.4480067491531372
loss_pred:0.013858259655535221, decouple_loss:0.0010774313705042005
loss_pred:0.013474876061081886, decouple_loss:0.0010953479213640094
Iteration: 4537, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473910927772522, gen p mean: -0.04878981411457062, mean p set: 0.4478713572025299
loss_pred:0.01429271511733532, decouple_loss:0.0010238578543066978
The modified gen p mean: 0.44814151525497437, gen p mean: -0.05728529766201973, mean p set: 0.4486217796802521The modified gen p mean: 0.44681569933891296, gen p mean: -0.05245112627744675, mean p set: 0.44729599356651306
loss_pred:0.01355578750371933, decouple_loss:0.0010013222927227616
loss_pred:0.013144993223249912, decouple_loss:0.0009992904961109161
Iteration: 4538, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477626085281372, gen p mean: -0.053885363042354584, mean p set: 0.4482428729534149
loss_pred:0.013428433798253536, decouple_loss:0.0009682918316684663
The modified gen p mean: 0.44733744859695435, gen p mean: -0.0492856502532959, mean p set: 0.44781771302223206The modified gen p mean: 0.44726693630218506, gen p mean: -0.052236951887607574, mean p set: 0.44774720072746277
loss_pred:0.01417701318860054, decouple_loss:0.000986910774372518
loss_pred:0.013274394907057285, decouple_loss:0.0009504610206931829
Iteration: 4539, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44719043374061584, gen p mean: -0.049536146223545074, mean p set: 0.44767072796821594
loss_pred:0.013924632221460342, decouple_loss:0.0009695410262793303
The modified gen p mean: 0.44745901226997375, gen p mean: -0.05040457844734192, mean p set: 0.44793930649757385The modified gen p mean: 0.4477926790714264, gen p mean: -0.046729668974876404, mean p set: 0.4482730031013489
loss_pred:0.01383611187338829, decouple_loss:0.0009781797416508198
loss_pred:0.013511614874005318, decouple_loss:0.0009510258678346872
Iteration: 4540, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44752684235572815, gen p mean: -0.052671391516923904, mean p set: 0.44800713658332825
loss_pred:0.01346292719244957, decouple_loss:0.0009782587876543403
The modified gen p mean: 0.44748654961586, gen p mean: -0.04913569241762161, mean p set: 0.4479668438434601The modified gen p mean: 0.44677072763442993, gen p mean: -0.049070872366428375, mean p set: 0.44725102186203003
loss_pred:0.014270293526351452, decouple_loss:0.0009684149408712983
loss_pred:0.013551199808716774, decouple_loss:0.0009319327073171735
2023-05-02 19:45:21 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.05380193516612053, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.05028551444411278, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.05042706057429314, mean p set: 0.4500633478164673
loss_pred:0.018987387418746948, decouple_loss:0.0010882711503654718
loss_pred:0.017870033159852028, decouple_loss:0.0010830857791006565
loss_pred:0.017913419753313065, decouple_loss:0.0010492976289242506
WV_0_PC_1_EH_0_PS_40, loss: 0.018310625106096268, avg_mse: 0.02676142193377018
current test mse: 0.026761
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012017_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012017_3_24hr.npz
NaN value num: 0
Iteration: 4541, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479690194129944, gen p mean: -0.04840516299009323, mean p set: 0.4484493136405945
loss_pred:0.013121717609465122, decouple_loss:0.001004221965558827
The modified gen p mean: 0.44811657071113586, gen p mean: -0.05428957939147949, mean p set: 0.4485968351364136The modified gen p mean: 0.44800901412963867, gen p mean: -0.05059509351849556, mean p set: 0.44848933815956116
loss_pred:0.012994011864066124, decouple_loss:0.0011536873644217849
loss_pred:0.013211557641625404, decouple_loss:0.0010592939797788858
Iteration: 4542, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44888073205947876, gen p mean: -0.05591835081577301, mean p set: 0.44936102628707886
loss_pred:0.012933358550071716, decouple_loss:0.000935869466047734
The modified gen p mean: 0.4480619728565216, gen p mean: -0.05056384578347206, mean p set: 0.4485422670841217The modified gen p mean: 0.4482780694961548, gen p mean: -0.05122353509068489, mean p set: 0.4487583637237549
loss_pred:0.013228443451225758, decouple_loss:0.0009653862798586488
loss_pred:0.013816113583743572, decouple_loss:0.0009539149468764663
Iteration: 4543, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477509558200836, gen p mean: -0.04960295930504799, mean p set: 0.44823122024536133
loss_pred:0.013685230165719986, decouple_loss:0.0009394510998390615
The modified gen p mean: 0.44853079319000244, gen p mean: -0.0508713535964489, mean p set: 0.4490111172199249The modified gen p mean: 0.44752660393714905, gen p mean: -0.05221289023756981, mean p set: 0.44800689816474915
loss_pred:0.012910348363220692, decouple_loss:0.0009659361094236374
loss_pred:0.013484190218150616, decouple_loss:0.0009163949289359152
Iteration: 4544, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473021924495697, gen p mean: -0.055500999093055725, mean p set: 0.4477825164794922
loss_pred:0.013547508977353573, decouple_loss:0.0009918456198647618
The modified gen p mean: 0.44781357049942017, gen p mean: -0.0545482411980629, mean p set: 0.4482938349246979The modified gen p mean: 0.4477875232696533, gen p mean: -0.05233922228217125, mean p set: 0.4482678174972534
loss_pred:0.013305533677339554, decouple_loss:0.0009944436606019735
loss_pred:0.013272827491164207, decouple_loss:0.0010300078429281712
Iteration: 4545, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44802403450012207, gen p mean: -0.051920827478170395, mean p set: 0.44850432872772217
loss_pred:0.01287392433732748, decouple_loss:0.0008961781859397888
The modified gen p mean: 0.44692251086235046, gen p mean: -0.05383099243044853, mean p set: 0.44740280508995056The modified gen p mean: 0.4484468400478363, gen p mean: -0.0464300736784935, mean p set: 0.4489271342754364
loss_pred:0.01308301743119955, decouple_loss:0.0009763098787516356
loss_pred:0.013442624360322952, decouple_loss:0.0009805022273212671
Iteration: 4546, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44700315594673157, gen p mean: -0.05345606058835983, mean p set: 0.44748347997665405
loss_pred:0.01334418635815382, decouple_loss:0.0009341786499135196
The modified gen p mean: 0.44816285371780396, gen p mean: -0.05058419704437256, mean p set: 0.44864311814308167The modified gen p mean: 0.44733431935310364, gen p mean: -0.04963217303156853, mean p set: 0.44781461358070374
loss_pred:0.013081534765660763, decouple_loss:0.0009686733246780932
loss_pred:0.014090008102357388, decouple_loss:0.0009448680211789906
Iteration: 4547, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44879162311553955, gen p mean: -0.051411423832178116, mean p set: 0.44927188754081726
loss_pred:0.013014103285968304, decouple_loss:0.0009527502697892487
The modified gen p mean: 0.44745364785194397, gen p mean: -0.05338708311319351, mean p set: 0.4479339122772217The modified gen p mean: 0.44676506519317627, gen p mean: -0.05003243684768677, mean p set: 0.44724538922309875
loss_pred:0.013477452099323273, decouple_loss:0.001046848250553012
loss_pred:0.014048338867723942, decouple_loss:0.000968357955571264
Iteration: 4548, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478570818901062, gen p mean: -0.0519096665084362, mean p set: 0.4483374059200287
loss_pred:0.012890567071735859, decouple_loss:0.0009576186421327293
The modified gen p mean: 0.4476214051246643, gen p mean: -0.050471071153879166, mean p set: 0.4481017291545868The modified gen p mean: 0.4472324848175049, gen p mean: -0.05664266645908356, mean p set: 0.447712779045105
loss_pred:0.013078923337161541, decouple_loss:0.0010017697932198644
loss_pred:0.013430402614176273, decouple_loss:0.0009939689189195633
Iteration: 4549, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44863346219062805, gen p mean: -0.05315966531634331, mean p set: 0.44911372661590576
loss_pred:0.013110996223986149, decouple_loss:0.0008714116993360221
The modified gen p mean: 0.44783005118370056, gen p mean: -0.050119124352931976, mean p set: 0.44831034541130066The modified gen p mean: 0.4482143223285675, gen p mean: -0.05102748051285744, mean p set: 0.44869464635849
loss_pred:0.013672922737896442, decouple_loss:0.0009093734552152455
loss_pred:0.013187293894588947, decouple_loss:0.0010113989701494575
Iteration: 4550, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478228688240051, gen p mean: -0.050877492874860764, mean p set: 0.4483031630516052
loss_pred:0.013589822687208652, decouple_loss:0.0008760831551626325
The modified gen p mean: 0.44791844487190247, gen p mean: -0.05312381312251091, mean p set: 0.44839873909950256The modified gen p mean: 0.44824522733688354, gen p mean: -0.051640063524246216, mean p set: 0.44872552156448364
loss_pred:0.01397807989269495, decouple_loss:0.0009689345606602728
loss_pred:0.013760833069682121, decouple_loss:0.0009586805826984346
2023-05-02 19:47:55 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.05545015260577202, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.05203649774193764, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.05217477306723595, mean p set: 0.4500633478164673
loss_pred:0.018940391018986702, decouple_loss:0.0010893704602494836
loss_pred:0.017796577885746956, decouple_loss:0.0009300372330471873
loss_pred:0.01787681318819523, decouple_loss:0.0009702804964035749
WV_0_PC_1_EH_0_PS_40, loss: 0.018254421651363373, avg_mse: 0.026650942862033844
current test mse: 0.026651
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 4551, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44762372970581055, gen p mean: -0.054262738674879074, mean p set: 0.44810402393341064
The modified gen p mean: 0.44823944568634033, gen p mean: -0.05575615167617798, mean p set: 0.44871973991394043
The modified gen p mean: 0.44616711139678955, gen p mean: -0.05627036094665527, mean p set: 0.44664737582206726
loss_pred:0.013523784466087818, decouple_loss:0.0009453887469135225
loss_pred:0.012784233316779137, decouple_loss:0.000979974283836782
loss_pred:0.01336645521223545, decouple_loss:0.0010020191548392177
Iteration: 4552, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482062757015228, gen p mean: -0.051567163318395615, mean p set: 0.4486865699291229
loss_pred:0.012981061823666096, decouple_loss:0.000928361201658845
The modified gen p mean: 0.447913259267807, gen p mean: -0.05119677633047104, mean p set: 0.4483935534954071The modified gen p mean: 0.4480210840702057, gen p mean: -0.05056243762373924, mean p set: 0.4485013484954834
loss_pred:0.012868243269622326, decouple_loss:0.0009540474275127053
loss_pred:0.013307711109519005, decouple_loss:0.0010649255709722638
Iteration: 4553, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447463721036911, gen p mean: -0.049023427069187164, mean p set: 0.4479440450668335
loss_pred:0.013346763327717781, decouple_loss:0.0011571142822504044
The modified gen p mean: 0.4470321238040924, gen p mean: -0.05322236940264702, mean p set: 0.4475124180316925The modified gen p mean: 0.44830819964408875, gen p mean: -0.051550645381212234, mean p set: 0.44878846406936646
loss_pred:0.013566454872488976, decouple_loss:0.0009897587588056922
loss_pred:0.013020429760217667, decouple_loss:0.0009926343336701393
Iteration: 4554, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44781047105789185, gen p mean: -0.05231023579835892, mean p set: 0.44829073548316956
loss_pred:0.013701140880584717, decouple_loss:0.0009745756397023797
The modified gen p mean: 0.44875863194465637, gen p mean: -0.052499547600746155, mean p set: 0.4492388963699341The modified gen p mean: 0.44810548424720764, gen p mean: -0.04968149960041046, mean p set: 0.44858577847480774
loss_pred:0.013591960072517395, decouple_loss:0.0009327919105999172
loss_pred:0.013156586326658726, decouple_loss:0.0010276988614350557
Iteration: 4555, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44735920429229736, gen p mean: -0.053040869534015656, mean p set: 0.4478394687175751
loss_pred:0.013270480558276176, decouple_loss:0.0009089996456168592
The modified gen p mean: 0.4465709626674652, gen p mean: -0.054125383496284485, mean p set: 0.4470512866973877The modified gen p mean: 0.4478556215763092, gen p mean: -0.04721716418862343, mean p set: 0.4483359158039093
loss_pred:0.013154612854123116, decouple_loss:0.0008934529614634812
loss_pred:0.013080354779958725, decouple_loss:0.0009955662535503507
Iteration: 4556, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448091596364975, gen p mean: -0.04803397133946419, mean p set: 0.44857192039489746
loss_pred:0.013678020797669888, decouple_loss:0.0009434362291358411
The modified gen p mean: 0.44872283935546875, gen p mean: -0.05185633897781372, mean p set: 0.44920313358306885The modified gen p mean: 0.4489078223705292, gen p mean: -0.04782922938466072, mean p set: 0.44938814640045166
loss_pred:0.013732139952480793, decouple_loss:0.0010554632171988487
loss_pred:0.01308437529951334, decouple_loss:0.0010005548829212785
Iteration: 4557, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44822442531585693, gen p mean: -0.04612955078482628, mean p set: 0.44870471954345703
loss_pred:0.0132248904556036, decouple_loss:0.0009848972549661994
The modified gen p mean: 0.44816482067108154, gen p mean: -0.04779776558279991, mean p set: 0.44864511489868164The modified gen p mean: 0.4478549063205719, gen p mean: -0.04867738112807274, mean p set: 0.448335200548172
loss_pred:0.01278049685060978, decouple_loss:0.0010337556013837457
loss_pred:0.013142963871359825, decouple_loss:0.0009652523440308869
Iteration: 4558, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478384852409363, gen p mean: -0.049327485263347626, mean p set: 0.44831880927085876
loss_pred:0.013188144192099571, decouple_loss:0.0009352032793685794
The modified gen p mean: 0.44832268357276917, gen p mean: -0.04749079793691635, mean p set: 0.4488029479980469The modified gen p mean: 0.44795534014701843, gen p mean: -0.049489885568618774, mean p set: 0.4484356641769409
loss_pred:0.012924371287226677, decouple_loss:0.0009742912952788174
loss_pred:0.01365616824477911, decouple_loss:0.0011242603650316596
Iteration: 4559, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487875998020172, gen p mean: -0.05048299580812454, mean p set: 0.4492678940296173
loss_pred:0.012776360847055912, decouple_loss:0.0010131194721907377
The modified gen p mean: 0.44797730445861816, gen p mean: -0.04459584504365921, mean p set: 0.44845762848854065The modified gen p mean: 0.44637301564216614, gen p mean: -0.05247827619314194, mean p set: 0.44685330986976624
loss_pred:0.012930065393447876, decouple_loss:0.0009523930493742228
loss_pred:0.013229208067059517, decouple_loss:0.0009806506568565965
Iteration: 4560, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481227993965149, gen p mean: -0.05040039122104645, mean p set: 0.448603093624115
loss_pred:0.013118389062583447, decouple_loss:0.0010213777422904968
The modified gen p mean: 0.4474068880081177, gen p mean: -0.04767488315701485, mean p set: 0.4478871822357178The modified gen p mean: 0.4471516013145447, gen p mean: -0.045776426792144775, mean p set: 0.4476318955421448
loss_pred:0.013526828028261662, decouple_loss:0.0009564953506924212
loss_pred:0.013722737319767475, decouple_loss:0.0009432745282538235
2023-05-02 19:49:49 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.05330695956945419, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04979121312499046, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04991663619875908, mean p set: 0.4500633478164673
loss_pred:0.018870340660214424, decouple_loss:0.0011462087277323008
loss_pred:0.01776047609746456, decouple_loss:0.001062029623426497
loss_pred:0.017850834876298904, decouple_loss:0.0010113209718838334
WV_0_PC_1_EH_0_PS_40, loss: 0.018214209005236626, avg_mse: 0.026594020426273346
current test mse: 0.026594
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012004_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012004_3_24hr.npz
NaN value num: 0
Iteration: 4561, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44909387826919556, gen p mean: -0.05688740685582161, mean p set: 0.44957417249679565
loss_pred:0.014538111165165901, decouple_loss:0.0010527883423492312
The modified gen p mean: 0.4480064809322357, gen p mean: -0.04967469722032547, mean p set: 0.4484868049621582The modified gen p mean: 0.4451453387737274, gen p mean: -0.05692565441131592, mean p set: 0.4456256330013275
loss_pred:0.01727568916976452, decouple_loss:0.001196861732751131
loss_pred:0.016707012429833412, decouple_loss:0.0010270270286127925
Iteration: 4562, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475797116756439, gen p mean: -0.05289804935455322, mean p set: 0.4480600357055664
loss_pred:0.01687127910554409, decouple_loss:0.0010335055412724614
The modified gen p mean: 0.4495728015899658, gen p mean: -0.05746995285153389, mean p set: 0.4500530958175659The modified gen p mean: 0.44793251156806946, gen p mean: -0.0487649105489254, mean p set: 0.44841283559799194
loss_pred:0.015005508437752724, decouple_loss:0.0010058018378913403
loss_pred:0.016659190878272057, decouple_loss:0.0009579159668646753
Iteration: 4563, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475308656692505, gen p mean: -0.05196654424071312, mean p set: 0.4480111598968506
loss_pred:0.016866395249962807, decouple_loss:0.0008961190469563007
The modified gen p mean: 0.4465605318546295, gen p mean: -0.04901520162820816, mean p set: 0.4470408260822296The modified gen p mean: 0.44853475689888, gen p mean: -0.0480976477265358, mean p set: 0.4490150213241577
loss_pred:0.015908848494291306, decouple_loss:0.001028305385261774
loss_pred:0.017419198527932167, decouple_loss:0.0010388395749032497
Iteration: 4564, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473022222518921, gen p mean: -0.04777637869119644, mean p set: 0.4477825164794922
loss_pred:0.016228431835770607, decouple_loss:0.0009323997073806822
The modified gen p mean: 0.44767454266548157, gen p mean: -0.05290956050157547, mean p set: 0.44815483689308167The modified gen p mean: 0.44679969549179077, gen p mean: -0.0528542660176754, mean p set: 0.44727998971939087
loss_pred:0.016176734119653702, decouple_loss:0.0009697413770481944
loss_pred:0.016525764018297195, decouple_loss:0.0009445257601328194
Iteration: 4565, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44836103916168213, gen p mean: -0.05691590532660484, mean p set: 0.4488413631916046
loss_pred:0.01622113212943077, decouple_loss:0.0009780714754015207
The modified gen p mean: 0.4476396441459656, gen p mean: -0.05170563608407974, mean p set: 0.4481199383735657The modified gen p mean: 0.448302686214447, gen p mean: -0.053165093064308167, mean p set: 0.4487829804420471
loss_pred:0.01603049226105213, decouple_loss:0.0009407504112459719
loss_pred:0.015633076429367065, decouple_loss:0.0009432436199858785
Iteration: 4566, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492435157299042, gen p mean: -0.05039629712700844, mean p set: 0.4497237801551819
loss_pred:0.01605002023279667, decouple_loss:0.0009118660818785429
The modified gen p mean: 0.44580167531967163, gen p mean: -0.0458826906979084, mean p set: 0.44628193974494934The modified gen p mean: 0.44626855850219727, gen p mean: -0.05184684321284294, mean p set: 0.44674885272979736
loss_pred:0.01550984475761652, decouple_loss:0.0010557947680354118
loss_pred:0.01564839296042919, decouple_loss:0.0009900055592879653
Iteration: 4567, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44449174404144287, gen p mean: -0.05260811373591423, mean p set: 0.4449720084667206
loss_pred:0.016164066269993782, decouple_loss:0.0009901467710733414
The modified gen p mean: 0.44638708233833313, gen p mean: -0.05134333297610283, mean p set: 0.4468673765659332The modified gen p mean: 0.4474874436855316, gen p mean: -0.04884687066078186, mean p set: 0.4479677379131317
loss_pred:0.01609884388744831, decouple_loss:0.0009354254580102861
loss_pred:0.016743503510951996, decouple_loss:0.0010566654382273555
Iteration: 4568, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44722214341163635, gen p mean: -0.05255594104528427, mean p set: 0.44770243763923645
loss_pred:0.01642645336687565, decouple_loss:0.0009645235259085894
The modified gen p mean: 0.44583219289779663, gen p mean: -0.05196624621748924, mean p set: 0.4463125169277191The modified gen p mean: 0.4461188316345215, gen p mean: -0.053885914385318756, mean p set: 0.44659915566444397
loss_pred:0.016121894121170044, decouple_loss:0.0009816878009587526
loss_pred:0.015700286254286766, decouple_loss:0.0009418068802915514
Iteration: 4569, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44610947370529175, gen p mean: -0.052208371460437775, mean p set: 0.44658976793289185
loss_pred:0.01550212875008583, decouple_loss:0.0009956922149285674
The modified gen p mean: 0.444752037525177, gen p mean: -0.05413632094860077, mean p set: 0.4452323615550995The modified gen p mean: 0.4476347863674164, gen p mean: -0.05229790136218071, mean p set: 0.44811511039733887
loss_pred:0.015546837821602821, decouple_loss:0.0009681214578449726
loss_pred:0.016831856220960617, decouple_loss:0.0009964769706130028
Iteration: 4570, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44864144921302795, gen p mean: -0.0567946583032608, mean p set: 0.44912174344062805
loss_pred:0.01607704907655716, decouple_loss:0.000995959504507482
The modified gen p mean: 0.4470677375793457, gen p mean: -0.05524488911032677, mean p set: 0.4475480318069458The modified gen p mean: 0.4465527832508087, gen p mean: -0.0537167526781559, mean p set: 0.4470330774784088
loss_pred:0.015288086608052254, decouple_loss:0.0008797069313004613
loss_pred:0.016176464036107063, decouple_loss:0.0009753720951266587
2023-05-02 19:52:19 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.056501392275094986, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.05292486399412155, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.05317104980349541, mean p set: 0.4500633478164673
loss_pred:0.018200280144810677, decouple_loss:0.001094506704248488
loss_pred:0.017173513770103455, decouple_loss:0.0010908046970143914
loss_pred:0.017297906801104546, decouple_loss:0.0009692621533758938
WV_0_PC_1_EH_0_PS_40, loss: 0.017609810456633568, avg_mse: 0.025356795638799667
current test mse: 0.025357
Iteration: 4571, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481680393218994, gen p mean: -0.05652688816189766, mean p set: 0.4486483037471771
The modified gen p mean: 0.448622465133667, gen p mean: -0.05413427576422691, mean p set: 0.4491027295589447
The modified gen p mean: 0.4479103982448578, gen p mean: -0.0547037199139595, mean p set: 0.4483906924724579
loss_pred:0.016376568004488945, decouple_loss:0.0009006526088342071
loss_pred:0.016792582347989082, decouple_loss:0.0009181006462313235loss_pred:0.01599893905222416, decouple_loss:0.0008966033346951008
Iteration: 4572, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44540050625801086, gen p mean: -0.06042670086026192, mean p set: 0.44588083028793335
loss_pred:0.015867263078689575, decouple_loss:0.0009820759296417236
The modified gen p mean: 0.4481663703918457, gen p mean: -0.06303806602954865, mean p set: 0.4486467242240906The modified gen p mean: 0.44587594270706177, gen p mean: -0.054569948464632034, mean p set: 0.44635626673698425
loss_pred:0.016022570431232452, decouple_loss:0.0010586314601823688
loss_pred:0.015566959045827389, decouple_loss:0.0010614041239023209
Iteration: 4573, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4452667832374573, gen p mean: -0.0634552389383316, mean p set: 0.4457470774650574
loss_pred:0.015636084601283073, decouple_loss:0.000965273124165833
The modified gen p mean: 0.44529518485069275, gen p mean: -0.06043876335024834, mean p set: 0.44577544927597046The modified gen p mean: 0.449760377407074, gen p mean: -0.05707787349820137, mean p set: 0.4502406716346741
loss_pred:0.015313416719436646, decouple_loss:0.0008893671911209822
loss_pred:0.01550055481493473, decouple_loss:0.0009239118080586195
Iteration: 4574, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448137491941452, gen p mean: -0.053468894213438034, mean p set: 0.4486178159713745
loss_pred:0.01672441139817238, decouple_loss:0.001017123693600297
The modified gen p mean: 0.44679737091064453, gen p mean: -0.05855788290500641, mean p set: 0.447277694940567
The modified gen p mean: 0.445483535528183, gen p mean: -0.06107374653220177, mean p set: 0.4459638297557831
loss_pred:0.01637839898467064, decouple_loss:0.0009424016461707652
loss_pred:0.015801750123500824, decouple_loss:0.0009314145427197218
Iteration: 4575, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44594669342041016, gen p mean: -0.06398565322160721, mean p set: 0.44642698764801025
loss_pred:0.01569214276969433, decouple_loss:0.0008923661662265658
The modified gen p mean: 0.44670698046684265, gen p mean: -0.0653751865029335, mean p set: 0.44718730449676514The modified gen p mean: 0.44663774967193604, gen p mean: -0.06191333755850792, mean p set: 0.44711804389953613
loss_pred:0.015648305416107178, decouple_loss:0.0009774314239621162
loss_pred:0.015756838023662567, decouple_loss:0.0009683676762506366
Iteration: 4576, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503893554210663, gen p mean: -0.05947060137987137, mean p set: 0.450869619846344
loss_pred:0.014955811202526093, decouple_loss:0.0010002759518101811
The modified gen p mean: 0.44702309370040894, gen p mean: -0.05549085885286331, mean p set: 0.44750338792800903The modified gen p mean: 0.4468501806259155, gen p mean: -0.05638152360916138, mean p set: 0.4473304748535156
loss_pred:0.01573191024363041, decouple_loss:0.0010727926855906844
loss_pred:0.01585264690220356, decouple_loss:0.0009837649995461106
Iteration: 4577, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467149078845978, gen p mean: -0.05354788899421692, mean p set: 0.4471952021121979
loss_pred:0.015589573420584202, decouple_loss:0.0009171429555863142
The modified gen p mean: 0.4499937891960144, gen p mean: -0.05692312866449356, mean p set: 0.4504740536212921The modified gen p mean: 0.4483136534690857, gen p mean: -0.059407349675893784, mean p set: 0.4487939476966858
loss_pred:0.015147234313189983, decouple_loss:0.0008792877197265625
loss_pred:0.016355495899915695, decouple_loss:0.001085196970961988
Iteration: 4578, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4441987872123718, gen p mean: -0.05817834287881851, mean p set: 0.44467902183532715
loss_pred:0.01626160554587841, decouple_loss:0.0009625097154639661
The modified gen p mean: 0.4492722451686859, gen p mean: -0.05773584172129631, mean p set: 0.449752539396286The modified gen p mean: 0.447672039270401, gen p mean: -0.052501823753118515, mean p set: 0.4481523334980011
loss_pred:0.015305031090974808, decouple_loss:0.0008826403063721955
loss_pred:0.016216203570365906, decouple_loss:0.0008734162547625601
Iteration: 4579, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464915096759796, gen p mean: -0.05255280062556267, mean p set: 0.4469718039035797
loss_pred:0.015382112935185432, decouple_loss:0.001011568121612072
The modified gen p mean: 0.4471828043460846, gen p mean: -0.05358964204788208, mean p set: 0.4476630687713623The modified gen p mean: 0.4480220079421997, gen p mean: -0.05407872051000595, mean p set: 0.4485023021697998
loss_pred:0.01577974110841751, decouple_loss:0.0009994837455451488
loss_pred:0.01628497615456581, decouple_loss:0.000963072176091373
Iteration: 4580, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447294682264328, gen p mean: -0.05305720865726471, mean p set: 0.4477749764919281
loss_pred:0.016615360975265503, decouple_loss:0.0009028378408402205
The modified gen p mean: 0.44696497917175293, gen p mean: -0.05410970002412796, mean p set: 0.4474453032016754
The modified gen p mean: 0.4457978904247284, gen p mean: -0.050700727850198746, mean p set: 0.4462781846523285
loss_pred:0.015656964853405952, decouple_loss:0.0009257945930585265
loss_pred:0.016204146668314934, decouple_loss:0.000993060995824635
2023-05-02 19:54:13 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.050872817635536194, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.047300782054662704, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.047492604702711105, mean p set: 0.4500633478164673
loss_pred:0.0182464849203825, decouple_loss:0.00112601846922189
loss_pred:0.01715446636080742, decouple_loss:0.0009929063962772489
loss_pred:0.01730187237262726, decouple_loss:0.0009234591852873564
WV_0_PC_1_EH_0_PS_40, loss: 0.017618313431739807, avg_mse: 0.025373395532369614
current test mse: 0.025373
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012001_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012001_3_24hr.npz
NaN value num: 0
Iteration: 4581, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465906322002411, gen p mean: -0.050745416432619095, mean p set: 0.4470709264278412
loss_pred:0.01427332405000925, decouple_loss:0.0011807585833594203
The modified gen p mean: 0.4476628601551056, gen p mean: -0.04888806864619255, mean p set: 0.4481431543827057The modified gen p mean: 0.44653376936912537, gen p mean: -0.049237899482250214, mean p set: 0.44701406359672546
loss_pred:0.013740841299295425, decouple_loss:0.0009893840178847313
loss_pred:0.014165148138999939, decouple_loss:0.0011119217379018664
Iteration: 4582, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470917880535126, gen p mean: -0.04829460382461548, mean p set: 0.44757208228111267
loss_pred:0.01327238604426384, decouple_loss:0.0009161373018287122
The modified gen p mean: 0.44603413343429565, gen p mean: -0.05183203145861626, mean p set: 0.44651445746421814The modified gen p mean: 0.44669008255004883, gen p mean: -0.050445832312107086, mean p set: 0.44717034697532654
loss_pred:0.01419585570693016, decouple_loss:0.0010194384958595037
loss_pred:0.013079920783638954, decouple_loss:0.0009697451605461538
Iteration: 4583, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44767576456069946, gen p mean: -0.043388258665800095, mean p set: 0.44815605878829956
loss_pred:0.013327754102647305, decouple_loss:0.0009645635727792978
The modified gen p mean: 0.44639313220977783, gen p mean: -0.0482986681163311, mean p set: 0.44687342643737793The modified gen p mean: 0.44644472002983093, gen p mean: -0.04569901525974274, mean p set: 0.4469250440597534
loss_pred:0.014236689545214176, decouple_loss:0.0010447845561429858
loss_pred:0.014268811792135239, decouple_loss:0.0010094059398397803
Iteration: 4584, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44865885376930237, gen p mean: -0.049089252948760986, mean p set: 0.44913914799690247
loss_pred:0.013658855110406876, decouple_loss:0.0010032088030129671
The modified gen p mean: 0.44835183024406433, gen p mean: -0.042132556438446045, mean p set: 0.4488321542739868The modified gen p mean: 0.446228951215744, gen p mean: -0.045179788023233414, mean p set: 0.4467092752456665
loss_pred:0.01343799103051424, decouple_loss:0.0009326652507297695
loss_pred:0.014054588973522186, decouple_loss:0.0009852317161858082
Iteration: 4585, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479070007801056, gen p mean: -0.04497519135475159, mean p set: 0.4483872950077057
loss_pred:0.013445207849144936, decouple_loss:0.00123604666441679
The modified gen p mean: 0.44648075103759766, gen p mean: -0.041413504630327225, mean p set: 0.44696107506752014The modified gen p mean: 0.44730597734451294, gen p mean: -0.04163069278001785, mean p set: 0.44778627157211304
loss_pred:0.013853510841727257, decouple_loss:0.001110132085159421
loss_pred:0.01358382124453783, decouple_loss:0.0010086448164656758
Iteration: 4586, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44901183247566223, gen p mean: -0.04688577726483345, mean p set: 0.44949212670326233
loss_pred:0.013358024880290031, decouple_loss:0.001100522349588573
The modified gen p mean: 0.44729161262512207, gen p mean: -0.040112875401973724, mean p set: 0.44777190685272217The modified gen p mean: 0.4468749761581421, gen p mean: -0.040418922901153564, mean p set: 0.4473552703857422
loss_pred:0.013502122834324837, decouple_loss:0.001092442311346531
loss_pred:0.013142028823494911, decouple_loss:0.0010635931976139545
Iteration: 4587, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44694462418556213, gen p mean: -0.05044599622488022, mean p set: 0.44742488861083984
loss_pred:0.014009715989232063, decouple_loss:0.0011261512991040945
The modified gen p mean: 0.4481518566608429, gen p mean: -0.047431692481040955, mean p set: 0.4486321210861206
The modified gen p mean: 0.4474365711212158, gen p mean: -0.04411444067955017, mean p set: 0.4479168951511383
loss_pred:0.013088075444102287, decouple_loss:0.0010416324948891997
loss_pred:0.013314252719283104, decouple_loss:0.0010999117512255907
Iteration: 4588, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44523462653160095, gen p mean: -0.05369242653250694, mean p set: 0.44571492075920105
loss_pred:0.01268717646598816, decouple_loss:0.0012209588894620538
The modified gen p mean: 0.4467603862285614, gen p mean: -0.047639429569244385, mean p set: 0.4472406804561615The modified gen p mean: 0.4459710121154785, gen p mean: -0.05177893489599228, mean p set: 0.4464513063430786
loss_pred:0.013518184423446655, decouple_loss:0.0011989774648100138
loss_pred:0.013832000084221363, decouple_loss:0.0011402493109926581
Iteration: 4589, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44699421525001526, gen p mean: -0.05173331871628761, mean p set: 0.44747447967529297
loss_pred:0.013390402309596539, decouple_loss:0.0011270756367594004
The modified gen p mean: 0.44601139426231384, gen p mean: -0.049534618854522705, mean p set: 0.44649171829223633The modified gen p mean: 0.4472421705722809, gen p mean: -0.049643903970718384, mean p set: 0.44772249460220337
loss_pred:0.013745923526585102, decouple_loss:0.000999150681309402
loss_pred:0.013599286787211895, decouple_loss:0.0010285922326147556
Iteration: 4590, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447226345539093, gen p mean: -0.049947332590818405, mean p set: 0.4477066397666931
loss_pred:0.013602950610220432, decouple_loss:0.001173035241663456
The modified gen p mean: 0.4472917318344116, gen p mean: -0.0462457649409771, mean p set: 0.4477720260620117The modified gen p mean: 0.44881632924079895, gen p mean: -0.05219512805342674, mean p set: 0.44929662346839905
loss_pred:0.01337374746799469, decouple_loss:0.0010694223456084728
loss_pred:0.013075876981019974, decouple_loss:0.0011647639330476522
2023-05-02 19:56:49 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.04691348597407341, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04296848922967911, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.043250225484371185, mean p set: 0.4500633478164673
loss_pred:0.019078895449638367, decouple_loss:0.0012589219259098172
loss_pred:0.017889009788632393, decouple_loss:0.00123706110753119
loss_pred:0.018016725778579712, decouple_loss:0.0011454136110842228
WV_0_PC_1_EH_0_PS_40, loss: 0.01838890090584755, avg_mse: 0.02684662491083145
current test mse: 0.026847
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 4591, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486105442047119, gen p mean: -0.04904918745160103, mean p set: 0.449090838432312
The modified gen p mean: 0.4478265047073364, gen p mean: -0.045231375843286514, mean p set: 0.4483067989349365
The modified gen p mean: 0.44880780577659607, gen p mean: -0.04902315512299538, mean p set: 0.44928810000419617
loss_pred:0.013446373865008354, decouple_loss:0.0012107995571568608
loss_pred:0.012929927557706833, decouple_loss:0.0012841152492910624
loss_pred:0.014207284897565842, decouple_loss:0.001017468050122261
Iteration: 4592, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475573003292084, gen p mean: -0.04167962074279785, mean p set: 0.44803762435913086
loss_pred:0.013504862785339355, decouple_loss:0.0010908662807196379
The modified gen p mean: 0.448044091463089, gen p mean: -0.040784627199172974, mean p set: 0.4485243558883667The modified gen p mean: 0.44799819588661194, gen p mean: -0.042933326214551926, mean p set: 0.44847849011421204
loss_pred:0.013156073167920113, decouple_loss:0.0010702228173613548
loss_pred:0.012829713523387909, decouple_loss:0.0010606847936287522
Iteration: 4593, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44879624247550964, gen p mean: -0.046107202768325806, mean p set: 0.44927650690078735
loss_pred:0.013152558356523514, decouple_loss:0.0011691427789628506
The modified gen p mean: 0.44811418652534485, gen p mean: -0.04447926580905914, mean p set: 0.44859448075294495The modified gen p mean: 0.4475002884864807, gen p mean: -0.04427855834364891, mean p set: 0.4479806125164032
loss_pred:0.014223574660718441, decouple_loss:0.001123087597079575
loss_pred:0.013276967220008373, decouple_loss:0.0010858883615583181
Iteration: 4594, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478665292263031, gen p mean: -0.046982910484075546, mean p set: 0.4483468234539032
The modified gen p mean: 0.4477525055408478, gen p mean: -0.04818228259682655, mean p set: 0.44823282957077026
loss_pred:0.013047311455011368, decouple_loss:0.0010343125322833657
loss_pred:0.01365266740322113, decouple_loss:0.001041150069795549
The modified gen p mean: 0.44720178842544556, gen p mean: -0.04339670389890671, mean p set: 0.44768208265304565
loss_pred:0.013209102675318718, decouple_loss:0.0010120401857420802
Iteration: 4595, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44795510172843933, gen p mean: -0.04650160297751427, mean p set: 0.44843539595603943
The modified gen p mean: 0.4470670819282532, gen p mean: -0.047462888062000275, mean p set: 0.44754740595817566
loss_pred:0.01293907780200243, decouple_loss:0.0011883208062499762
loss_pred:0.01358796376734972, decouple_loss:0.0011661899043247104The modified gen p mean: 0.4470854103565216, gen p mean: -0.04616113379597664, mean p set: 0.4475656747817993
loss_pred:0.01332804560661316, decouple_loss:0.0011078333482146263
Iteration: 4596, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44817274808883667, gen p mean: -0.05180498585104942, mean p set: 0.4486530125141144
loss_pred:0.014348072931170464, decouple_loss:0.0010290180798619986
The modified gen p mean: 0.4481533467769623, gen p mean: -0.05337715893983841, mean p set: 0.4486336410045624The modified gen p mean: 0.4484339952468872, gen p mean: -0.055309049785137177, mean p set: 0.4489142596721649
loss_pred:0.013114523142576218, decouple_loss:0.0010828718077391386
loss_pred:0.013082404620945454, decouple_loss:0.00104575976729393
Iteration: 4597, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4455767571926117, gen p mean: -0.053399380296468735, mean p set: 0.4460570514202118
loss_pred:0.012569400481879711, decouple_loss:0.0012341063702479005
The modified gen p mean: 0.4466207027435303, gen p mean: -0.050924696028232574, mean p set: 0.44710099697113037The modified gen p mean: 0.4482642412185669, gen p mean: -0.05150643736124039, mean p set: 0.4487445652484894
loss_pred:0.013389087282121181, decouple_loss:0.001139531028456986
loss_pred:0.012853954918682575, decouple_loss:0.0011484705610200763
Iteration: 4598, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44723355770111084, gen p mean: -0.04607784003019333, mean p set: 0.4477138817310333
loss_pred:0.013177461922168732, decouple_loss:0.0010661875130608678
The modified gen p mean: 0.44770726561546326, gen p mean: -0.0515696220099926, mean p set: 0.44818755984306335The modified gen p mean: 0.44639071822166443, gen p mean: -0.0493767149746418, mean p set: 0.44687098264694214
loss_pred:0.01293122861534357, decouple_loss:0.0010894101578742266
loss_pred:0.012998386286199093, decouple_loss:0.001140126376412809
Iteration: 4599, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470219612121582, gen p mean: -0.04934709891676903, mean p set: 0.4475022256374359
loss_pred:0.013026355765759945, decouple_loss:0.0009730837773531675
The modified gen p mean: 0.44825175404548645, gen p mean: -0.04650423675775528, mean p set: 0.44873204827308655The modified gen p mean: 0.44574248790740967, gen p mean: -0.04884086176753044, mean p set: 0.4462227523326874
loss_pred:0.012884652242064476, decouple_loss:0.0010420674225315452
loss_pred:0.012735427357256413, decouple_loss:0.0010024025104939938
Iteration: 4600, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480348825454712, gen p mean: -0.04633152112364769, mean p set: 0.4485151767730713
loss_pred:0.013303452171385288, decouple_loss:0.0010834642453119159
The modified gen p mean: 0.4466317892074585, gen p mean: -0.04699787124991417, mean p set: 0.4471120834350586The modified gen p mean: 0.4466645419597626, gen p mean: -0.04746721684932709, mean p set: 0.44714486598968506
loss_pred:0.013326871208846569, decouple_loss:0.0011560015846043825
loss_pred:0.013305365107953548, decouple_loss:0.0010902464855462313
2023-05-02 19:58:43 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.047722287476062775, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04366341978311539, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04420853033661842, mean p set: 0.4500633478164673
loss_pred:0.01886398158967495, decouple_loss:0.0009957313304767013
loss_pred:0.017699386924505234, decouple_loss:0.0009874278912320733
loss_pred:0.01781371608376503, decouple_loss:0.0009246320696547627
WV_0_PC_1_EH_0_PS_40, loss: 0.01817415840923786, avg_mse: 0.026490239426493645
current test mse: 0.02649
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012010_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012010_3_24hr.npz
NaN value num: 0
Iteration: 4601, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44763433933258057, gen p mean: -0.045701369643211365, mean p set: 0.44811463356018066
loss_pred:0.017314927652478218, decouple_loss:0.0010035671293735504
The modified gen p mean: 0.44806918501853943, gen p mean: -0.05010632425546646, mean p set: 0.4485495090484619The modified gen p mean: 0.4465983808040619, gen p mean: -0.04835444688796997, mean p set: 0.4470786452293396
loss_pred:0.017411431297659874, decouple_loss:0.0009947041980922222loss_pred:0.016774600371718407, decouple_loss:0.0010042790090665221
Iteration: 4602, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44795945286750793, gen p mean: -0.04290589690208435, mean p set: 0.44843971729278564
loss_pred:0.016750477254390717, decouple_loss:0.0010290101636201143
The modified gen p mean: 0.44722703099250793, gen p mean: -0.04611828923225403, mean p set: 0.44770732522010803The modified gen p mean: 0.4470629394054413, gen p mean: -0.044407472014427185, mean p set: 0.44754326343536377
loss_pred:0.016048839315772057, decouple_loss:0.001094199251383543
loss_pred:0.015833625569939613, decouple_loss:0.0010181673569604754
Iteration: 4603, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44730207324028015, gen p mean: -0.0486675426363945, mean p set: 0.44778236746788025
loss_pred:0.016659729182720184, decouple_loss:0.0009442366426810622
The modified gen p mean: 0.4472706615924835, gen p mean: -0.04980098828673363, mean p set: 0.4477509558200836The modified gen p mean: 0.44634953141212463, gen p mean: -0.04818824306130409, mean p set: 0.44682982563972473
loss_pred:0.014990420080721378, decouple_loss:0.0009216382750310004
loss_pred:0.017456702888011932, decouple_loss:0.0009569599642418325
Iteration: 4604, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485021233558655, gen p mean: -0.05112526938319206, mean p set: 0.4489823877811432
loss_pred:0.016323672607541084, decouple_loss:0.0011134688975289464
The modified gen p mean: 0.4468751847743988, gen p mean: -0.04903803765773773, mean p set: 0.4473554790019989The modified gen p mean: 0.4474947154521942, gen p mean: -0.047352135181427, mean p set: 0.4479750096797943
loss_pred:0.015490482561290264, decouple_loss:0.0010285032913088799
loss_pred:0.016539212316274643, decouple_loss:0.0011096539674326777
Iteration: 4605, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44684475660324097, gen p mean: -0.05037279799580574, mean p set: 0.44732505083084106
loss_pred:0.016645707190036774, decouple_loss:0.0010722249280661345
The modified gen p mean: 0.4469698369503021, gen p mean: -0.05040876194834709, mean p set: 0.44745010137557983The modified gen p mean: 0.44926369190216064, gen p mean: -0.05352004989981651, mean p set: 0.44974398612976074
loss_pred:0.017215311527252197, decouple_loss:0.0009820143459364772
loss_pred:0.016026504337787628, decouple_loss:0.0010213475907221437
Iteration: 4606, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4463266134262085, gen p mean: -0.04937427490949631, mean p set: 0.4468069076538086
loss_pred:0.0155180087313056, decouple_loss:0.0011472026817500591
The modified gen p mean: 0.4478081166744232, gen p mean: -0.04760178551077843, mean p set: 0.4482884109020233The modified gen p mean: 0.4479468762874603, gen p mean: -0.05233132094144821, mean p set: 0.4484272003173828
loss_pred:0.01591663621366024, decouple_loss:0.0011512540513649583
loss_pred:0.016874942928552628, decouple_loss:0.0012108479859307408
Iteration: 4607, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44862696528434753, gen p mean: -0.04632854461669922, mean p set: 0.44910722970962524
loss_pred:0.016060495749115944, decouple_loss:0.0011830474250018597
The modified gen p mean: 0.44698894023895264, gen p mean: -0.04244667664170265, mean p set: 0.4474692642688751The modified gen p mean: 0.4478977918624878, gen p mean: -0.04523862525820732, mean p set: 0.4483780562877655
loss_pred:0.017043326050043106, decouple_loss:0.000982637400738895
loss_pred:0.016080155968666077, decouple_loss:0.001097631873562932
Iteration: 4608, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44669774174690247, gen p mean: -0.045584458857774734, mean p set: 0.44717806577682495
loss_pred:0.01665385067462921, decouple_loss:0.0010753358947113156
The modified gen p mean: 0.44746389985084534, gen p mean: -0.04408477619290352, mean p set: 0.4479442238807678The modified gen p mean: 0.4468501806259155, gen p mean: -0.04264283552765846, mean p set: 0.4473304748535156
loss_pred:0.015712914988398552, decouple_loss:0.001101712347008288
loss_pred:0.016541393473744392, decouple_loss:0.0011284803040325642
Iteration: 4609, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44661226868629456, gen p mean: -0.043489351868629456, mean p set: 0.44709256291389465
loss_pred:0.016179876402020454, decouple_loss:0.001129636657424271
The modified gen p mean: 0.44695374369621277, gen p mean: -0.048380229622125626, mean p set: 0.44743403792381287The modified gen p mean: 0.4479251205921173, gen p mean: -0.04441654309630394, mean p set: 0.4484054148197174
loss_pred:0.016868142411112785, decouple_loss:0.001171736279502511
loss_pred:0.017038291320204735, decouple_loss:0.001279058982618153
Iteration: 4610, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478965699672699, gen p mean: -0.04740998521447182, mean p set: 0.44837686419487
loss_pred:0.016584841534495354, decouple_loss:0.0010223358403891325
The modified gen p mean: 0.446316123008728, gen p mean: -0.05015778914093971, mean p set: 0.4467964172363281The modified gen p mean: 0.44677734375, gen p mean: -0.04936128854751587, mean p set: 0.4472576081752777
loss_pred:0.01579219289124012, decouple_loss:0.0011029678862541914
loss_pred:0.015722664073109627, decouple_loss:0.0009807012975215912
2023-05-02 20:01:17 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.04960045590996742, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.045126479119062424, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.045802272856235504, mean p set: 0.4500633478164673
loss_pred:0.018339218571782112, decouple_loss:0.0013092184672132134
loss_pred:0.017299706116318703, decouple_loss:0.0012401927961036563
loss_pred:0.017374936491250992, decouple_loss:0.0011911210604012012
WV_0_PC_1_EH_0_PS_40, loss: 0.017733629792928696, avg_mse: 0.02556702308356762
current test mse: 0.025567
Iteration: 4611, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469059705734253, gen p mean: -0.04644836112856865, mean p set: 0.447386234998703
The modified gen p mean: 0.44650721549987793, gen p mean: -0.048736605793237686, mean p set: 0.4469875395298004
The modified gen p mean: 0.44860216975212097, gen p mean: -0.0482495054602623, mean p set: 0.44908249378204346
loss_pred:0.016105404123663902, decouple_loss:0.0010638032108545303
loss_pred:0.01585356332361698, decouple_loss:0.0010307638440281153
loss_pred:0.016070222482085228, decouple_loss:0.0011700124014168978
Iteration: 4612, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499262869358063, gen p mean: -0.0525737963616848, mean p set: 0.45040658116340637
loss_pred:0.015913603827357292, decouple_loss:0.0010802133474498987
The modified gen p mean: 0.4490973949432373, gen p mean: -0.046793363988399506, mean p set: 0.4495777189731598The modified gen p mean: 0.44859179854393005, gen p mean: -0.04986576735973358, mean p set: 0.44907209277153015
loss_pred:0.016809821128845215, decouple_loss:0.0009951931424438953
loss_pred:0.01632598042488098, decouple_loss:0.0010620045941323042
Iteration: 4613, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477812349796295, gen p mean: -0.047819506376981735, mean p set: 0.4482615292072296
loss_pred:0.016395561397075653, decouple_loss:0.0009320365497842431
The modified gen p mean: 0.44797375798225403, gen p mean: -0.04944732040166855, mean p set: 0.4484540522098541The modified gen p mean: 0.4479115903377533, gen p mean: -0.048461928963661194, mean p set: 0.448391854763031
loss_pred:0.015740033239126205, decouple_loss:0.0010047685354948044
loss_pred:0.01680016703903675, decouple_loss:0.0009814987424761057
Iteration: 4614, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44793370366096497, gen p mean: -0.04667407646775246, mean p set: 0.44841399788856506
loss_pred:0.01658673956990242, decouple_loss:0.0009853035444393754
The modified gen p mean: 0.4475911259651184, gen p mean: -0.04627155140042305, mean p set: 0.4480714499950409The modified gen p mean: 0.4476429224014282, gen p mean: -0.05001550912857056, mean p set: 0.4481232166290283
loss_pred:0.016122769564390182, decouple_loss:0.0010357737774029374
loss_pred:0.015490366145968437, decouple_loss:0.001035342807881534
Iteration: 4615, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44866013526916504, gen p mean: -0.05044979974627495, mean p set: 0.44914042949676514
loss_pred:0.016793709248304367, decouple_loss:0.001040906528942287
The modified gen p mean: 0.4474125802516937, gen p mean: -0.04711287096142769, mean p set: 0.4478928744792938The modified gen p mean: 0.44757428765296936, gen p mean: -0.05025998502969742, mean p set: 0.44805458188056946
loss_pred:0.01689658872783184, decouple_loss:0.0010693940566852689
loss_pred:0.015141427516937256, decouple_loss:0.0009568586829118431
Iteration: 4616, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44953829050064087, gen p mean: -0.051008183509111404, mean p set: 0.4500185549259186
loss_pred:0.01600850187242031, decouple_loss:0.0010095889447256923
The modified gen p mean: 0.4466244876384735, gen p mean: -0.0533348023891449, mean p set: 0.447104811668396The modified gen p mean: 0.44738319516181946, gen p mean: -0.04838308319449425, mean p set: 0.44786348938941956
loss_pred:0.015485701151192188, decouple_loss:0.000981382792815566
loss_pred:0.015989970415830612, decouple_loss:0.000961977057158947
Iteration: 4617, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44771096110343933, gen p mean: -0.04881498962640762, mean p set: 0.44819125533103943
loss_pred:0.015355509705841541, decouple_loss:0.0012225211830809712
The modified gen p mean: 0.4480290412902832, gen p mean: -0.04947396367788315, mean p set: 0.4485093653202057The modified gen p mean: 0.44697925448417664, gen p mean: -0.048298392444849014, mean p set: 0.4474595785140991
loss_pred:0.01656750775873661, decouple_loss:0.001194463693536818
loss_pred:0.015475806780159473, decouple_loss:0.0011744771618396044
Iteration: 4618, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44763636589050293, gen p mean: -0.048165228217840195, mean p set: 0.448116660118103
loss_pred:0.017138337716460228, decouple_loss:0.0011110989144071937
The modified gen p mean: 0.4462946653366089, gen p mean: -0.04800434783101082, mean p set: 0.446774959564209The modified gen p mean: 0.4477614462375641, gen p mean: -0.04687628522515297, mean p set: 0.4482417702674866
loss_pred:0.016157757490873337, decouple_loss:0.001070049125701189
loss_pred:0.016332993283867836, decouple_loss:0.0012039089342579246
Iteration: 4619, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44886574149131775, gen p mean: -0.04816138744354248, mean p set: 0.44934606552124023
loss_pred:0.01655524969100952, decouple_loss:0.0013533736346289515
The modified gen p mean: 0.4465520977973938, gen p mean: -0.047367773950099945, mean p set: 0.4470323920249939The modified gen p mean: 0.4469502866268158, gen p mean: -0.04999854043126106, mean p set: 0.4474305510520935
loss_pred:0.01621047593653202, decouple_loss:0.001025437144562602
loss_pred:0.016043176874518394, decouple_loss:0.001110575976781547
Iteration: 4620, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468787908554077, gen p mean: -0.05243159085512161, mean p set: 0.4473590552806854
loss_pred:0.01567324623465538, decouple_loss:0.001092944759875536
The modified gen p mean: 0.4475124180316925, gen p mean: -0.05118529871106148, mean p set: 0.447992742061615The modified gen p mean: 0.44768568873405457, gen p mean: -0.04975588619709015, mean p set: 0.44816598296165466
loss_pred:0.01668773964047432, decouple_loss:0.0010056695900857449
loss_pred:0.01677609048783779, decouple_loss:0.0010432058479636908
2023-05-02 20:03:13 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.04973508417606354, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.045691512525081635, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04634308069944382, mean p set: 0.4500633478164673
loss_pred:0.018342716619372368, decouple_loss:0.0012545071076601744
loss_pred:0.01731635443866253, decouple_loss:0.0010798603761941195
loss_pred:0.01737738586962223, decouple_loss:0.0010594893246889114
WV_0_PC_1_EH_0_PS_40, loss: 0.017735382542014122, avg_mse: 0.025566093623638153
current test mse: 0.025566
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012002_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012002_3_24hr.npz
NaN value num: 0
Iteration: 4621, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44837766885757446, gen p mean: -0.04600171744823456, mean p set: 0.44885799288749695
loss_pred:0.013407044112682343, decouple_loss:0.0011022381950169802
The modified gen p mean: 0.44819745421409607, gen p mean: -0.04784523695707321, mean p set: 0.44867774844169617The modified gen p mean: 0.4474162757396698, gen p mean: -0.04645296558737755, mean p set: 0.4478965699672699
loss_pred:0.013687442988157272, decouple_loss:0.0012260075891390443loss_pred:0.013558986596763134, decouple_loss:0.001139016472734511
Iteration: 4622, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44738543033599854, gen p mean: -0.0461241640150547, mean p set: 0.44786569476127625
loss_pred:0.013268550857901573, decouple_loss:0.00118070503231138
The modified gen p mean: 0.44915971159935, gen p mean: -0.05263245105743408, mean p set: 0.4496400058269501The modified gen p mean: 0.44840124249458313, gen p mean: -0.04759290814399719, mean p set: 0.4488815367221832
loss_pred:0.01362698245793581, decouple_loss:0.0011464327108114958
loss_pred:0.014314250089228153, decouple_loss:0.0011983112199231982
Iteration: 4623, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500373899936676, gen p mean: -0.04257547855377197, mean p set: 0.4505176842212677
loss_pred:0.013288499787449837, decouple_loss:0.0011022560065612197
The modified gen p mean: 0.4516567587852478, gen p mean: -0.046597208827733994, mean p set: 0.4521370232105255The modified gen p mean: 0.4476599097251892, gen p mean: -0.049839988350868225, mean p set: 0.4481402039527893
loss_pred:0.01354381162673235, decouple_loss:0.001147467060945928
loss_pred:0.013432840816676617, decouple_loss:0.0011788932606577873
Iteration: 4624, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44975507259368896, gen p mean: -0.04142628610134125, mean p set: 0.4502353370189667
loss_pred:0.013256055302917957, decouple_loss:0.0011309271212667227
The modified gen p mean: 0.4488057792186737, gen p mean: -0.04472818970680237, mean p set: 0.4492860734462738The modified gen p mean: 0.44839346408843994, gen p mean: -0.04897573962807655, mean p set: 0.44887375831604004
loss_pred:0.013410665094852448, decouple_loss:0.001094253035262227
loss_pred:0.014007184654474258, decouple_loss:0.001257163705304265
Iteration: 4625, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472696781158447, gen p mean: -0.0513954795897007, mean p set: 0.4477499723434448
loss_pred:0.01325532142072916, decouple_loss:0.0012465504696592689
The modified gen p mean: 0.44785284996032715, gen p mean: -0.04527633264660835, mean p set: 0.44833314418792725The modified gen p mean: 0.44669434428215027, gen p mean: -0.05369578301906586, mean p set: 0.447174608707428
loss_pred:0.013815377838909626, decouple_loss:0.0011259466409683228
loss_pred:0.013613969087600708, decouple_loss:0.001064774813130498
Iteration: 4626, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499562680721283, gen p mean: -0.039932720363140106, mean p set: 0.4504365622997284
loss_pred:0.013022826053202152, decouple_loss:0.001155054778791964
The modified gen p mean: 0.44856274127960205, gen p mean: -0.04887174814939499, mean p set: 0.44904303550720215The modified gen p mean: 0.44811615347862244, gen p mean: -0.04925520718097687, mean p set: 0.44859644770622253
loss_pred:0.013651887886226177, decouple_loss:0.0011736253509297967
loss_pred:0.013038227334618568, decouple_loss:0.0011060194810852408
Iteration: 4627, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44972044229507446, gen p mean: -0.052869342267513275, mean p set: 0.45020073652267456
loss_pred:0.012505686841905117, decouple_loss:0.0013004093198105693
The modified gen p mean: 0.4490741789340973, gen p mean: -0.04191022366285324, mean p set: 0.449554443359375The modified gen p mean: 0.44872623682022095, gen p mean: -0.05005435645580292, mean p set: 0.44920656085014343
loss_pred:0.01318320631980896, decouple_loss:0.001273749745450914
loss_pred:0.013087340630590916, decouple_loss:0.0011668395018205047
Iteration: 4628, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467901289463043, gen p mean: -0.049708765000104904, mean p set: 0.4472704529762268
loss_pred:0.013112546876072884, decouple_loss:0.0012218072079122066
The modified gen p mean: 0.4488906264305115, gen p mean: -0.04893837496638298, mean p set: 0.4493709206581116The modified gen p mean: 0.4471130073070526, gen p mean: -0.05324045568704605, mean p set: 0.4475933015346527
loss_pred:0.013045858591794968, decouple_loss:0.0011059088865295053
loss_pred:0.013421629555523396, decouple_loss:0.0013029768597334623
Iteration: 4629, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474971890449524, gen p mean: -0.04626627638936043, mean p set: 0.4479774832725525
loss_pred:0.013025734573602676, decouple_loss:0.001233849790878594
The modified gen p mean: 0.45019304752349854, gen p mean: -0.040117621421813965, mean p set: 0.45067334175109863The modified gen p mean: 0.4473476707935333, gen p mean: -0.04275151342153549, mean p set: 0.44782793521881104
loss_pred:0.012953173369169235, decouple_loss:0.0012643447844311595
loss_pred:0.013604511506855488, decouple_loss:0.0011623621685430408
Iteration: 4630, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490068554878235, gen p mean: -0.05410075560212135, mean p set: 0.4494871497154236
loss_pred:0.012112893164157867, decouple_loss:0.0014230174710974097
The modified gen p mean: 0.44862765073776245, gen p mean: -0.05152468755841255, mean p set: 0.44910797476768494The modified gen p mean: 0.4476976692676544, gen p mean: -0.04514642432332039, mean p set: 0.4481779932975769
loss_pred:0.012826219201087952, decouple_loss:0.0012117987498641014
loss_pred:0.013750990852713585, decouple_loss:0.0011013720650225878
2023-05-02 20:05:46 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.05359252914786339, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04943200573325157, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.049935080111026764, mean p set: 0.4500633478164673
loss_pred:0.019154053181409836, decouple_loss:0.0014884443953633308
loss_pred:0.017969563603401184, decouple_loss:0.0018140675965696573
loss_pred:0.017974499613046646, decouple_loss:0.0016573121538385749
WV_0_PC_1_EH_0_PS_40, loss: 0.01844870299100876, avg_mse: 0.026892971247434616
current test mse: 0.026893
Iteration: 4631, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44819360971450806, gen p mean: -0.05235771834850311, mean p set: 0.44867387413978577
The modified gen p mean: 0.4469147324562073, gen p mean: -0.046274907886981964, mean p set: 0.447394996881485
The modified gen p mean: 0.4478560984134674, gen p mean: -0.051510464400053024, mean p set: 0.4483363628387451
loss_pred:0.013309654779732227, decouple_loss:0.0014438406797125936
loss_pred:0.012940998189151287, decouple_loss:0.0015749456360936165
loss_pred:0.012830434367060661, decouple_loss:0.0014117567334324121
Iteration: 4632, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489038288593292, gen p mean: -0.04629264771938324, mean p set: 0.4493841528892517
loss_pred:0.01303797960281372, decouple_loss:0.0012852729996666312
The modified gen p mean: 0.4486962556838989, gen p mean: -0.04597095027565956, mean p set: 0.449176549911499The modified gen p mean: 0.44755735993385315, gen p mean: -0.04801269248127937, mean p set: 0.44803765416145325
loss_pred:0.013256723992526531, decouple_loss:0.0011242077453061938
loss_pred:0.013151491060853004, decouple_loss:0.0011791978031396866
Iteration: 4633, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479535222053528, gen p mean: -0.04962560161948204, mean p set: 0.44843384623527527
loss_pred:0.013144764117896557, decouple_loss:0.0010887866374105215
The modified gen p mean: 0.44766315817832947, gen p mean: -0.044500816613435745, mean p set: 0.44814345240592957The modified gen p mean: 0.448076993227005, gen p mean: -0.04608272761106491, mean p set: 0.4485572874546051
loss_pred:0.013171539641916752, decouple_loss:0.0011813081800937653
loss_pred:0.013617297634482384, decouple_loss:0.0011617345735430717
Iteration: 4634, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44836610555648804, gen p mean: -0.051120974123477936, mean p set: 0.44884639978408813
loss_pred:0.012941405177116394, decouple_loss:0.0011902878759428859
The modified gen p mean: 0.4490821361541748, gen p mean: -0.049855418503284454, mean p set: 0.4495624303817749The modified gen p mean: 0.4474261701107025, gen p mean: -0.05061318352818489, mean p set: 0.4479064643383026
loss_pred:0.012991401366889477, decouple_loss:0.001196273136883974
loss_pred:0.012945775873959064, decouple_loss:0.0011384440585970879
Iteration: 4635, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474325478076935, gen p mean: -0.047028981149196625, mean p set: 0.4479128420352936
loss_pred:0.012920733541250229, decouple_loss:0.0010638637468218803
The modified gen p mean: 0.4507500231266022, gen p mean: -0.04578534513711929, mean p set: 0.45123034715652466The modified gen p mean: 0.44754844903945923, gen p mean: -0.04774036630988121, mean p set: 0.4480287730693817
loss_pred:0.012895511463284492, decouple_loss:0.0010943296365439892
loss_pred:0.01412535086274147, decouple_loss:0.0010792379034683108
Iteration: 4636, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486274719238281, gen p mean: -0.04862513765692711, mean p set: 0.44910773634910583
loss_pred:0.012487288564443588, decouple_loss:0.0010816259309649467
The modified gen p mean: 0.449799120426178, gen p mean: -0.04881005361676216, mean p set: 0.4502794146537781The modified gen p mean: 0.44975852966308594, gen p mean: -0.051115766167640686, mean p set: 0.45023879408836365
loss_pred:0.013073967769742012, decouple_loss:0.0010633869096636772
loss_pred:0.013016466051340103, decouple_loss:0.0011200637090951204
Iteration: 4637, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472678005695343, gen p mean: -0.043929386883974075, mean p set: 0.447748064994812
loss_pred:0.013039007782936096, decouple_loss:0.001395441242493689
The modified gen p mean: 0.4488476812839508, gen p mean: -0.05227850005030632, mean p set: 0.4493279755115509The modified gen p mean: 0.44841739535331726, gen p mean: -0.045937392860651016, mean p set: 0.44889771938323975
loss_pred:0.012099024839699268, decouple_loss:0.001275113201700151
loss_pred:0.013522356748580933, decouple_loss:0.0012736690696328878
Iteration: 4638, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448194295167923, gen p mean: -0.0465434193611145, mean p set: 0.44867458939552307
loss_pred:0.013472638092935085, decouple_loss:0.0011661290191113949
The modified gen p mean: 0.4489346742630005, gen p mean: -0.04908699542284012, mean p set: 0.4494149386882782The modified gen p mean: 0.447256863117218, gen p mean: -0.0442245751619339, mean p set: 0.4477371871471405
loss_pred:0.012904929928481579, decouple_loss:0.0010648268507793546
loss_pred:0.013230299577116966, decouple_loss:0.0010557941859588027
Iteration: 4639, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44798243045806885, gen p mean: -0.05114220455288887, mean p set: 0.44846272468566895
loss_pred:0.012168061919510365, decouple_loss:0.0014081544941291213
The modified gen p mean: 0.44961124658584595, gen p mean: -0.052306633442640305, mean p set: 0.45009157061576843The modified gen p mean: 0.4493548274040222, gen p mean: -0.05005510523915291, mean p set: 0.4498351216316223
loss_pred:0.012594614177942276, decouple_loss:0.001180963939987123
loss_pred:0.012838655151426792, decouple_loss:0.0012745209969580173
Iteration: 4640, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44875746965408325, gen p mean: -0.04914407432079315, mean p set: 0.44923779368400574
loss_pred:0.0131459292024374, decouple_loss:0.0010281667346134782
The modified gen p mean: 0.4489430785179138, gen p mean: -0.05014658346772194, mean p set: 0.4494233727455139The modified gen p mean: 0.4491240084171295, gen p mean: -0.05329958349466324, mean p set: 0.4496042728424072
loss_pred:0.013073603622615337, decouple_loss:0.0010287455515936017
loss_pred:0.011894674971699715, decouple_loss:0.001066244556568563
2023-05-02 20:07:41 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.051787614822387695, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.0478929840028286, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04829208925366402, mean p set: 0.4500633478164673
loss_pred:0.01788247562944889, decouple_loss:0.001308863633312285
loss_pred:0.018997453153133392, decouple_loss:0.0011820326326414943
loss_pred:0.0178621057420969, decouple_loss:0.0011961942072957754
WV_0_PC_1_EH_0_PS_40, loss: 0.018308795988559723, avg_mse: 0.026727164164185524
current test mse: 0.026727
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012013_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012013_3_24hr.npz
NaN value num: 0
Iteration: 4641, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45092812180519104, gen p mean: -0.05150170996785164, mean p set: 0.45140841603279114
loss_pred:0.01608726568520069, decouple_loss:0.0013221977278590202
The modified gen p mean: 0.4491533041000366, gen p mean: -0.0475587472319603, mean p set: 0.4496335983276367The modified gen p mean: 0.45121094584465027, gen p mean: -0.047997113317251205, mean p set: 0.451691210269928
loss_pred:0.015186580829322338, decouple_loss:0.0012649695854634047loss_pred:0.015610395930707455, decouple_loss:0.0013229579199105501
Iteration: 4642, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490281939506531, gen p mean: -0.04851420596241951, mean p set: 0.4495084881782532
loss_pred:0.015764707699418068, decouple_loss:0.0011863748077303171
The modified gen p mean: 0.4487893283367157, gen p mean: -0.04963993281126022, mean p set: 0.4492696523666382The modified gen p mean: 0.45012181997299194, gen p mean: -0.05166366696357727, mean p set: 0.45060214400291443
loss_pred:0.01618312858045101, decouple_loss:0.0011494101490825415
loss_pred:0.015622565522789955, decouple_loss:0.0012374073266983032
Iteration: 4643, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502500593662262, gen p mean: -0.049483004957437515, mean p set: 0.4507302939891815
loss_pred:0.01585756056010723, decouple_loss:0.0011106565361842513
The modified gen p mean: 0.4509749114513397, gen p mean: -0.05108906701207161, mean p set: 0.4514552056789398The modified gen p mean: 0.4503313899040222, gen p mean: -0.046991392970085144, mean p set: 0.4508116841316223
loss_pred:0.01594756543636322, decouple_loss:0.001142111956141889
loss_pred:0.015965351834893227, decouple_loss:0.0011922343401238322
Iteration: 4644, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44910648465156555, gen p mean: -0.046222105622291565, mean p set: 0.44958674907684326
loss_pred:0.016109565272927284, decouple_loss:0.001362395822070539
The modified gen p mean: 0.4508408308029175, gen p mean: -0.049712058156728745, mean p set: 0.4513210952281952The modified gen p mean: 0.4492305815219879, gen p mean: -0.04259685054421425, mean p set: 0.449710875749588
loss_pred:0.015530307777225971, decouple_loss:0.001147069619037211
loss_pred:0.016186175867915154, decouple_loss:0.0012751728063449264
Iteration: 4645, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497581124305725, gen p mean: -0.04177755489945412, mean p set: 0.450238436460495
loss_pred:0.015553083270788193, decouple_loss:0.0011586251202970743
The modified gen p mean: 0.45033878087997437, gen p mean: -0.04728846624493599, mean p set: 0.45081907510757446The modified gen p mean: 0.44914960861206055, gen p mean: -0.04214708134531975, mean p set: 0.44962990283966064
loss_pred:0.015447818674147129, decouple_loss:0.0012159277684986591
loss_pred:0.016315221786499023, decouple_loss:0.0010543507523834705
Iteration: 4646, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475767910480499, gen p mean: -0.04106687754392624, mean p set: 0.4480571150779724
loss_pred:0.015417073853313923, decouple_loss:0.0011701901676133275
The modified gen p mean: 0.4498402774333954, gen p mean: -0.04718703404068947, mean p set: 0.4503205716609955The modified gen p mean: 0.45089563727378845, gen p mean: -0.04464903101325035, mean p set: 0.45137593150138855
loss_pred:0.015710126608610153, decouple_loss:0.0011446289718151093
loss_pred:0.0163921769708395, decouple_loss:0.001071130856871605
Iteration: 4647, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486198127269745, gen p mean: -0.041749823838472366, mean p set: 0.4491001069545746
loss_pred:0.01572350412607193, decouple_loss:0.0010990930022671819
The modified gen p mean: 0.4506102502346039, gen p mean: -0.046282391995191574, mean p set: 0.451090544462204
The modified gen p mean: 0.4509217143058777, gen p mean: -0.04275985434651375, mean p set: 0.4514020085334778
loss_pred:0.015140604227781296, decouple_loss:0.0011041483376175165
loss_pred:0.015924593433737755, decouple_loss:0.00108130753505975
Iteration: 4648, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44977468252182007, gen p mean: -0.04302377253770828, mean p set: 0.45025497674942017
loss_pred:0.015725094825029373, decouple_loss:0.0011079676914960146
The modified gen p mean: 0.4507297873497009, gen p mean: -0.04453620687127113, mean p set: 0.451210081577301The modified gen p mean: 0.4493718147277832, gen p mean: -0.043232258409261703, mean p set: 0.4498521387577057
loss_pred:0.015392995439469814, decouple_loss:0.0011143216397613287
loss_pred:0.015882862731814384, decouple_loss:0.0011926505248993635
Iteration: 4649, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45064082741737366, gen p mean: -0.047961827367544174, mean p set: 0.45112112164497375
loss_pred:0.015168852172791958, decouple_loss:0.0011650088708847761
The modified gen p mean: 0.45052289962768555, gen p mean: -0.04222334176301956, mean p set: 0.45100319385528564The modified gen p mean: 0.4497682750225067, gen p mean: -0.03961135447025299, mean p set: 0.4502485692501068
loss_pred:0.01534537598490715, decouple_loss:0.0010736235417425632
loss_pred:0.015709316357970238, decouple_loss:0.0010919022606685758
Iteration: 4650, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486290216445923, gen p mean: -0.046153392642736435, mean p set: 0.4491093158721924
loss_pred:0.01595498062670231, decouple_loss:0.0010475564049556851
The modified gen p mean: 0.44861987233161926, gen p mean: -0.043534841388463974, mean p set: 0.44910016655921936The modified gen p mean: 0.4493255913257599, gen p mean: -0.042687129229307175, mean p set: 0.4498059153556824
loss_pred:0.01543340738862753, decouple_loss:0.0010932842269539833
loss_pred:0.015880519524216652, decouple_loss:0.0009986667428165674
2023-05-02 20:10:15 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.04546685144305229, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04176963120698929, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.04200056195259094, mean p set: 0.4500633478164673
loss_pred:0.018661264330148697, decouple_loss:0.0011580981081351638
loss_pred:0.017490264028310776, decouple_loss:0.0011402731761336327
loss_pred:0.017534581944346428, decouple_loss:0.0011339957127347589
WV_0_PC_1_EH_0_PS_40, loss: 0.017952576279640198, avg_mse: 0.02601245790719986
current test mse: 0.026012
Iteration: 4651, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450836181640625, gen p mean: -0.03926025331020355, mean p set: 0.4513164758682251
The modified gen p mean: 0.4498802423477173, gen p mean: -0.038542360067367554, mean p set: 0.4503605365753174
The modified gen p mean: 0.4506642520427704, gen p mean: -0.04356711730360985, mean p set: 0.4511445164680481
loss_pred:0.015947110950946808, decouple_loss:0.0012167339446023107
loss_pred:0.015777908265590668, decouple_loss:0.0009549951064400375
loss_pred:0.015219155699014664, decouple_loss:0.0010453599970787764
Iteration: 4652, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44876593351364136, gen p mean: -0.04341093450784683, mean p set: 0.44924622774124146
loss_pred:0.015335142612457275, decouple_loss:0.001070706290192902
The modified gen p mean: 0.45019635558128357, gen p mean: -0.04664624482393265, mean p set: 0.4506766200065613The modified gen p mean: 0.44862794876098633, gen p mean: -0.045060623437166214, mean p set: 0.44910821318626404
loss_pred:0.01547527126967907, decouple_loss:0.001115000108256936
loss_pred:0.015461512841284275, decouple_loss:0.0011081928387284279
Iteration: 4653, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498560428619385, gen p mean: -0.04552527517080307, mean p set: 0.4503363370895386
loss_pred:0.01590052992105484, decouple_loss:0.0010702249128371477
The modified gen p mean: 0.4488906264305115, gen p mean: -0.04708908498287201, mean p set: 0.4493708908557892The modified gen p mean: 0.45071253180503845, gen p mean: -0.049925826489925385, mean p set: 0.45119279623031616
loss_pred:0.015154143795371056, decouple_loss:0.0010524769313633442
loss_pred:0.01613284833729267, decouple_loss:0.0010406810324639082
Iteration: 4654, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44930562376976013, gen p mean: -0.05096689984202385, mean p set: 0.44978588819503784
loss_pred:0.016233963891863823, decouple_loss:0.0009822242427617311
The modified gen p mean: 0.44987475872039795, gen p mean: -0.05568556487560272, mean p set: 0.45035505294799805The modified gen p mean: 0.45036378502845764, gen p mean: -0.04732256010174751, mean p set: 0.45084407925605774
loss_pred:0.015559437684714794, decouple_loss:0.0010468863183632493
loss_pred:0.01617242582142353, decouple_loss:0.00101951090618968
Iteration: 4655, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44924396276474, gen p mean: -0.052333541214466095, mean p set: 0.4497242569923401
loss_pred:0.01600269041955471, decouple_loss:0.0010054107988253236
The modified gen p mean: 0.4507967233657837, gen p mean: -0.0549696683883667, mean p set: 0.4512770175933838The modified gen p mean: 0.45106902718544006, gen p mean: -0.05354566499590874, mean p set: 0.45154935121536255
loss_pred:0.015572605654597282, decouple_loss:0.00100984750315547
loss_pred:0.016272390261292458, decouple_loss:0.001037455047480762
Iteration: 4656, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502270221710205, gen p mean: -0.052616387605667114, mean p set: 0.4507073163986206
loss_pred:0.015991337597370148, decouple_loss:0.00102625519502908
The modified gen p mean: 0.45054301619529724, gen p mean: -0.05291762948036194, mean p set: 0.4510233402252197The modified gen p mean: 0.45018118619918823, gen p mean: -0.05139331892132759, mean p set: 0.45066148042678833
loss_pred:0.015712996944785118, decouple_loss:0.0009701254894025624
loss_pred:0.015220178291201591, decouple_loss:0.0009611118584871292
Iteration: 4657, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504498839378357, gen p mean: -0.05192161351442337, mean p set: 0.4509302079677582
loss_pred:0.015427172183990479, decouple_loss:0.0010045641101896763
The modified gen p mean: 0.4498160481452942, gen p mean: -0.04561547562479973, mean p set: 0.4502963423728943The modified gen p mean: 0.4503541588783264, gen p mean: -0.044302791357040405, mean p set: 0.4508344829082489
loss_pred:0.015644267201423645, decouple_loss:0.000964377773925662
loss_pred:0.014818454161286354, decouple_loss:0.0010222109267488122
Iteration: 4658, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45012757182121277, gen p mean: -0.043377555906772614, mean p set: 0.45060789585113525
loss_pred:0.015873264521360397, decouple_loss:0.0010479306802153587
The modified gen p mean: 0.4474261403083801, gen p mean: -0.0439225509762764, mean p set: 0.4479064345359802The modified gen p mean: 0.45062705874443054, gen p mean: -0.04685066640377045, mean p set: 0.451107382774353
loss_pred:0.015293569304049015, decouple_loss:0.0010755109833553433
loss_pred:0.015421801246702671, decouple_loss:0.0009232857264578342
Iteration: 4659, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45021581649780273, gen p mean: -0.05047059431672096, mean p set: 0.45069611072540283
loss_pred:0.014925179071724415, decouple_loss:0.0009588958928361535
The modified gen p mean: 0.45072245597839355, gen p mean: -0.04559803009033203, mean p set: 0.45120275020599365The modified gen p mean: 0.4502987563610077, gen p mean: -0.04286589473485947, mean p set: 0.4507790505886078
loss_pred:0.015087233856320381, decouple_loss:0.0009442821028642356
loss_pred:0.015775414183735847, decouple_loss:0.00101411622017622
Iteration: 4660, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504632353782654, gen p mean: -0.04556921124458313, mean p set: 0.4509435296058655
loss_pred:0.015713250264525414, decouple_loss:0.000991971348412335
The modified gen p mean: 0.45086774230003357, gen p mean: -0.046058814972639084, mean p set: 0.45134806632995605
The modified gen p mean: 0.45143359899520874, gen p mean: -0.045802511274814606, mean p set: 0.45191389322280884
loss_pred:0.015625787898898125, decouple_loss:0.0010170285822823644
loss_pred:0.015597925521433353, decouple_loss:0.0010427460074424744
2023-05-02 20:12:10 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.051532816141843796, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.047878775745630264, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.04804611578583717, mean p set: 0.4500633478164673
loss_pred:0.018724003806710243, decouple_loss:0.0012758082011714578
loss_pred:0.017518319189548492, decouple_loss:0.0012396815000101924
loss_pred:0.017613505944609642, decouple_loss:0.001292361062951386
WV_0_PC_1_EH_0_PS_40, loss: 0.018015407025814056, avg_mse: 0.026136597618460655
current test mse: 0.026137
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012006_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012006_3_24hr.npz
NaN value num: 0
Iteration: 4661, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44951412081718445, gen p mean: -0.047125738114118576, mean p set: 0.44999441504478455
loss_pred:0.01590646617114544, decouple_loss:0.0013037273893132806
The modified gen p mean: 0.44807472825050354, gen p mean: -0.04425915703177452, mean p set: 0.44855502247810364The modified gen p mean: 0.4490896165370941, gen p mean: -0.04339348524808884, mean p set: 0.4495699107646942
loss_pred:0.014995639212429523, decouple_loss:0.0012045573676005006
loss_pred:0.016168786212801933, decouple_loss:0.0011178083950653672
Iteration: 4662, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492376148700714, gen p mean: -0.04882006719708443, mean p set: 0.4497178792953491
loss_pred:0.015421582385897636, decouple_loss:0.0011239476734772325
The modified gen p mean: 0.45043498277664185, gen p mean: -0.04217146337032318, mean p set: 0.45091530680656433The modified gen p mean: 0.44925737380981445, gen p mean: -0.04614199697971344, mean p set: 0.4497377276420593
loss_pred:0.015247074887156487, decouple_loss:0.0012067422503605485
loss_pred:0.015344404615461826, decouple_loss:0.0012880872236564755
Iteration: 4663, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514516294002533, gen p mean: -0.043947067111730576, mean p set: 0.4519319236278534
The modified gen p mean: 0.4486517608165741, gen p mean: -0.04858572781085968, mean p set: 0.4491320550441742
loss_pred:0.015317360870540142, decouple_loss:0.0013082781806588173
loss_pred:0.015625575557351112, decouple_loss:0.0010693048825487494
The modified gen p mean: 0.45099201798439026, gen p mean: -0.04435093700885773, mean p set: 0.45147234201431274
loss_pred:0.015071572735905647, decouple_loss:0.001150562078692019
Iteration: 4664, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482744038105011, gen p mean: -0.04843456670641899, mean p set: 0.4487546980381012
loss_pred:0.015325288288295269, decouple_loss:0.0012122419429942966
The modified gen p mean: 0.45030251145362854, gen p mean: -0.03789367526769638, mean p set: 0.45078280568122864The modified gen p mean: 0.45063233375549316, gen p mean: -0.03983346000313759, mean p set: 0.45111262798309326
loss_pred:0.01493743434548378, decouple_loss:0.0012035000836476684
loss_pred:0.015618537552654743, decouple_loss:0.0012950078817084432
Iteration: 4665, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45136773586273193, gen p mean: -0.04227110370993614, mean p set: 0.45184803009033203
loss_pred:0.015077099204063416, decouple_loss:0.0010888471733778715
The modified gen p mean: 0.4489649832248688, gen p mean: -0.04575107991695404, mean p set: 0.44944530725479126The modified gen p mean: 0.4517773389816284, gen p mean: -0.04037979990243912, mean p set: 0.4522576630115509
loss_pred:0.014905683696269989, decouple_loss:0.0010357238352298737
loss_pred:0.014938215725123882, decouple_loss:0.0010083913803100586
Iteration: 4666, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508605897426605, gen p mean: -0.04432661831378937, mean p set: 0.4513408839702606
loss_pred:0.01488843560218811, decouple_loss:0.001174221746623516
The modified gen p mean: 0.45097821950912476, gen p mean: -0.04084210842847824, mean p set: 0.45145851373672485The modified gen p mean: 0.4522525370121002, gen p mean: -0.04156177118420601, mean p set: 0.4527328312397003
loss_pred:0.015413635410368443, decouple_loss:0.0013769174693152308
loss_pred:0.014700990170240402, decouple_loss:0.0011745346710085869
Iteration: 4667, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45128822326660156, gen p mean: -0.03543787822127342, mean p set: 0.4517684876918793
loss_pred:0.01572539657354355, decouple_loss:0.0012199872871860862
The modified gen p mean: 0.451703816652298, gen p mean: -0.0416087731719017, mean p set: 0.45218411087989807The modified gen p mean: 0.4518709182739258, gen p mean: -0.04335452988743782, mean p set: 0.45235124230384827
loss_pred:0.014910658821463585, decouple_loss:0.0010430705733597279
loss_pred:0.015068006701767445, decouple_loss:0.0010486140381544828
Iteration: 4668, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4509750008583069, gen p mean: -0.03728581964969635, mean p set: 0.451455295085907
loss_pred:0.015368274413049221, decouple_loss:0.0014194658724591136
The modified gen p mean: 0.4516501724720001, gen p mean: -0.0386350154876709, mean p set: 0.4521304666996002The modified gen p mean: 0.4516366422176361, gen p mean: -0.041913073509931564, mean p set: 0.4521169364452362
loss_pred:0.01553271058946848, decouple_loss:0.00120688253082335
loss_pred:0.01491531915962696, decouple_loss:0.0013356811832636595
Iteration: 4669, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4515303373336792, gen p mean: -0.04361752048134804, mean p set: 0.4520106315612793
loss_pred:0.014944140799343586, decouple_loss:0.0011208833893761039
The modified gen p mean: 0.45170459151268005, gen p mean: -0.04167294502258301, mean p set: 0.45218491554260254The modified gen p mean: 0.45150136947631836, gen p mean: -0.045293401926755905, mean p set: 0.45198163390159607
loss_pred:0.015479016117751598, decouple_loss:0.0010333615355193615
loss_pred:0.015413282439112663, decouple_loss:0.0011223451001569629
Iteration: 4670, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44996964931488037, gen p mean: -0.049038082361221313, mean p set: 0.45044994354248047
loss_pred:0.01476703304797411, decouple_loss:0.0011158130364492536
The modified gen p mean: 0.4493594169616699, gen p mean: -0.048687878996133804, mean p set: 0.44983968138694763The modified gen p mean: 0.4494708776473999, gen p mean: -0.04897325858473778, mean p set: 0.449951171875
loss_pred:0.014868772588670254, decouple_loss:0.0010397975565865636
loss_pred:0.01597410999238491, decouple_loss:0.0012142278719693422
2023-05-02 20:14:48 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.05881626904010773, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.05500166863203049, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.055436406284570694, mean p set: 0.4500633478164673
loss_pred:0.018511351197957993, decouple_loss:0.0012556606670841575
loss_pred:0.017298854887485504, decouple_loss:0.001195851480588317
loss_pred:0.017454618588089943, decouple_loss:0.0011931409826502204
WV_0_PC_1_EH_0_PS_40, loss: 0.017815684899687767, avg_mse: 0.02570747211575508
current test mse: 0.025707
Iteration: 4671, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45100700855255127, gen p mean: -0.04649234190583229, mean p set: 0.45148730278015137
The modified gen p mean: 0.4509863257408142, gen p mean: -0.04383289813995361, mean p set: 0.4514666199684143
The modified gen p mean: 0.4501020908355713, gen p mean: -0.049746718257665634, mean p set: 0.4505823850631714
loss_pred:0.015515877865254879, decouple_loss:0.0012490588705986738
loss_pred:0.015269501134753227, decouple_loss:0.001169848837889731
loss_pred:0.015578505583107471, decouple_loss:0.0014998560072854161
Iteration: 4672, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487965703010559, gen p mean: -0.05191901698708534, mean p set: 0.44927680492401123
loss_pred:0.016237281262874603, decouple_loss:0.0012054385151714087
The modified gen p mean: 0.45159855484962463, gen p mean: -0.04003407806158066, mean p set: 0.45207884907722473
The modified gen p mean: 0.44980135560035706, gen p mean: -0.047468844801187515, mean p set: 0.45028162002563477
loss_pred:0.015022369101643562, decouple_loss:0.0011875557247549295
loss_pred:0.016077080741524696, decouple_loss:0.0012577010784298182
Iteration: 4673, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45163416862487793, gen p mean: -0.041705187410116196, mean p set: 0.452114462852478
The modified gen p mean: 0.4500167667865753, gen p mean: -0.05152345076203346, mean p set: 0.4504970610141754
loss_pred:0.015467696823179722, decouple_loss:0.0010786412749439478
loss_pred:0.015508312731981277, decouple_loss:0.0010813678381964564
The modified gen p mean: 0.44932821393013, gen p mean: -0.047602731734514236, mean p set: 0.4498084783554077
loss_pred:0.015631407499313354, decouple_loss:0.0010416260920464993
Iteration: 4674, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44799908995628357, gen p mean: -0.048756565898656845, mean p set: 0.44847941398620605
loss_pred:0.015027381479740143, decouple_loss:0.0011895798379555345
The modified gen p mean: 0.4507134258747101, gen p mean: -0.03796853497624397, mean p set: 0.45119374990463257The modified gen p mean: 0.4517100155353546, gen p mean: -0.03982147201895714, mean p set: 0.4521903395652771
loss_pred:0.015184152871370316, decouple_loss:0.0009984646458178759
loss_pred:0.01568562537431717, decouple_loss:0.0010670563206076622
Iteration: 4675, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513588547706604, gen p mean: -0.03634663298726082, mean p set: 0.4518391489982605
loss_pred:0.01531793549656868, decouple_loss:0.0009757357183843851
The modified gen p mean: 0.4517109990119934, gen p mean: -0.03800947219133377, mean p set: 0.4521912932395935The modified gen p mean: 0.451058030128479, gen p mean: -0.03784571588039398, mean p set: 0.4515382945537567
loss_pred:0.015219634398818016, decouple_loss:0.0010519318748265505
loss_pred:0.01462299469858408, decouple_loss:0.0009060009033419192
Iteration: 4676, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490474462509155, gen p mean: -0.040489476174116135, mean p set: 0.4495277404785156
loss_pred:0.015214933082461357, decouple_loss:0.0010107799898833036
The modified gen p mean: 0.44951415061950684, gen p mean: -0.04194089025259018, mean p set: 0.4499944746494293The modified gen p mean: 0.4518933594226837, gen p mean: -0.032401468604803085, mean p set: 0.4523736536502838
loss_pred:0.015341673046350479, decouple_loss:0.0009144499781541526
loss_pred:0.01502776239067316, decouple_loss:0.0010340294102206826
Iteration: 4677, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508572220802307, gen p mean: -0.0325421541929245, mean p set: 0.4513375163078308
loss_pred:0.015237935818731785, decouple_loss:0.001002811943180859
The modified gen p mean: 0.44800442457199097, gen p mean: -0.04375527799129486, mean p set: 0.44848471879959106The modified gen p mean: 0.45113927125930786, gen p mean: -0.03272544592618942, mean p set: 0.45161959528923035
loss_pred:0.015148869715631008, decouple_loss:0.0010136672062799335
loss_pred:0.015724385157227516, decouple_loss:0.0011946079321205616
Iteration: 4678, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511788487434387, gen p mean: -0.0379902683198452, mean p set: 0.45165911316871643
loss_pred:0.015297051519155502, decouple_loss:0.0010006375377997756
The modified gen p mean: 0.4511168301105499, gen p mean: -0.03802501782774925, mean p set: 0.4515971541404724The modified gen p mean: 0.4493485689163208, gen p mean: -0.04450333118438721, mean p set: 0.4498288631439209
loss_pred:0.01484830304980278, decouple_loss:0.001162783824838698
loss_pred:0.015239289030432701, decouple_loss:0.0010223743738606572
Iteration: 4679, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4519844055175781, gen p mean: -0.04041075333952904, mean p set: 0.45246466994285583
loss_pred:0.014550198800861835, decouple_loss:0.0012956898426637053
The modified gen p mean: 0.44990164041519165, gen p mean: -0.04461658000946045, mean p set: 0.45038190484046936The modified gen p mean: 0.4515560567378998, gen p mean: -0.041085101664066315, mean p set: 0.45203638076782227
loss_pred:0.015127697959542274, decouple_loss:0.0011211322853341699
loss_pred:0.01440279372036457, decouple_loss:0.001119046937674284
Iteration: 4680, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449980765581131, gen p mean: -0.049827296286821365, mean p set: 0.4504610598087311
loss_pred:0.015202932991087437, decouple_loss:0.0010177982039749622
The modified gen p mean: 0.4504876732826233, gen p mean: -0.03975765034556389, mean p set: 0.4509679973125458The modified gen p mean: 0.4514239430427551, gen p mean: -0.04183683171868324, mean p set: 0.4519042372703552
loss_pred:0.015697412192821503, decouple_loss:0.0010656859958544374
loss_pred:0.01514739915728569, decouple_loss:0.001048962352797389
2023-05-02 20:16:43 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.05257067456841469, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.048744332045316696, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.04916395992040634, mean p set: 0.4500633478164673
loss_pred:0.018491897732019424, decouple_loss:0.0012426654575392604
loss_pred:0.017296545207500458, decouple_loss:0.001269125728867948
loss_pred:0.017420731484889984, decouple_loss:0.001188940368592739
WV_0_PC_1_EH_0_PS_40, loss: 0.01779807172715664, avg_mse: 0.025693435221910477
current test mse: 0.025693
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012014_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012014_3_24hr.npz
NaN value num: 0
Iteration: 4681, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44623321294784546, gen p mean: -0.049718547612428665, mean p set: 0.44671353697776794
loss_pred:0.014933875761926174, decouple_loss:0.0013136690249666572
The modified gen p mean: 0.4466998875141144, gen p mean: -0.054646607488393784, mean p set: 0.4471801817417145The modified gen p mean: 0.4457560181617737, gen p mean: -0.05167439952492714, mean p set: 0.4462362825870514
loss_pred:0.014960785396397114, decouple_loss:0.0012151524424552917
loss_pred:0.014243834652006626, decouple_loss:0.0013705393066629767
Iteration: 4682, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44677507877349854, gen p mean: -0.049356698989868164, mean p set: 0.44725537300109863
loss_pred:0.014025427401065826, decouple_loss:0.0010747353080660105
The modified gen p mean: 0.4480176568031311, gen p mean: -0.049290914088487625, mean p set: 0.4484979510307312The modified gen p mean: 0.44621577858924866, gen p mean: -0.045579057186841965, mean p set: 0.44669607281684875
loss_pred:0.01458937767893076, decouple_loss:0.0011929137399420142
loss_pred:0.014032416045665741, decouple_loss:0.0011439677327871323
Iteration: 4683, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4458337724208832, gen p mean: -0.04802734777331352, mean p set: 0.4463140368461609
loss_pred:0.014439769089221954, decouple_loss:0.0010491322027519345
The modified gen p mean: 0.44622841477394104, gen p mean: -0.05137773975729942, mean p set: 0.4467087388038635The modified gen p mean: 0.44619378447532654, gen p mean: -0.04896465688943863, mean p set: 0.44667407870292664
loss_pred:0.014464329928159714, decouple_loss:0.0011385278776288033
loss_pred:0.014755497686564922, decouple_loss:0.0011597888078540564
Iteration: 4684, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472518563270569, gen p mean: -0.04893302917480469, mean p set: 0.447732150554657
loss_pred:0.013996613211929798, decouple_loss:0.0011289202375337481
The modified gen p mean: 0.4469756484031677, gen p mean: -0.04853149130940437, mean p set: 0.4474559724330902The modified gen p mean: 0.44765180349349976, gen p mean: -0.051228079944849014, mean p set: 0.44813206791877747
loss_pred:0.01377449743449688, decouple_loss:0.001129868091084063
loss_pred:0.014269967563450336, decouple_loss:0.0011333939619362354
Iteration: 4685, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479432702064514, gen p mean: -0.05104180797934532, mean p set: 0.4484235644340515
loss_pred:0.013668355531990528, decouple_loss:0.0012830108171328902
The modified gen p mean: 0.4464482367038727, gen p mean: -0.04985418915748596, mean p set: 0.44692856073379517The modified gen p mean: 0.4462399184703827, gen p mean: -0.05002671107649803, mean p set: 0.4467202425003052
loss_pred:0.014036215841770172, decouple_loss:0.001241818768903613
loss_pred:0.014334315434098244, decouple_loss:0.0012882729060947895
Iteration: 4686, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44696757197380066, gen p mean: -0.050943031907081604, mean p set: 0.44744786620140076
loss_pred:0.014334275387227535, decouple_loss:0.0010763833997771144
The modified gen p mean: 0.4465339481830597, gen p mean: -0.048622120171785355, mean p set: 0.4470142424106598The modified gen p mean: 0.44743824005126953, gen p mean: -0.05021965131163597, mean p set: 0.447918564081192
loss_pred:0.013444199226796627, decouple_loss:0.0011403822572901845
loss_pred:0.014049293473362923, decouple_loss:0.0010210351319983602
Iteration: 4687, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44631731510162354, gen p mean: -0.05507471412420273, mean p set: 0.44679760932922363
loss_pred:0.0143971536308527, decouple_loss:0.0010916051687672734
The modified gen p mean: 0.44592297077178955, gen p mean: -0.053202901035547256, mean p set: 0.44640329480171204The modified gen p mean: 0.4464503824710846, gen p mean: -0.055520787835121155, mean p set: 0.4469307065010071
loss_pred:0.01461803913116455, decouple_loss:0.0010781032033264637
loss_pred:0.014024652540683746, decouple_loss:0.0011151155922561884
Iteration: 4688, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484091103076935, gen p mean: -0.05654706060886383, mean p set: 0.44888943433761597
loss_pred:0.014084326103329659, decouple_loss:0.0012781405821442604
The modified gen p mean: 0.4480520486831665, gen p mean: -0.05538545176386833, mean p set: 0.448532372713089The modified gen p mean: 0.44607147574424744, gen p mean: -0.057212404906749725, mean p set: 0.44655176997184753
loss_pred:0.013785039074718952, decouple_loss:0.0012253778986632824
loss_pred:0.014140794984996319, decouple_loss:0.0011310356203466654
Iteration: 4689, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44595468044281006, gen p mean: -0.0568125955760479, mean p set: 0.44643494486808777
loss_pred:0.013596943579614162, decouple_loss:0.001097294152714312
The modified gen p mean: 0.4480317533016205, gen p mean: -0.05724945664405823, mean p set: 0.44851207733154297The modified gen p mean: 0.4475047290325165, gen p mean: -0.05741078034043312, mean p set: 0.4479850232601166
loss_pred:0.013516922481358051, decouple_loss:0.0011654638219624758
loss_pred:0.01413760706782341, decouple_loss:0.0010760858422145247
Iteration: 4690, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464920163154602, gen p mean: -0.056888822466135025, mean p set: 0.4469722807407379
loss_pred:0.013896575197577477, decouple_loss:0.0012141501065343618
The modified gen p mean: 0.4467129409313202, gen p mean: -0.0576968640089035, mean p set: 0.4471932351589203The modified gen p mean: 0.4464617967605591, gen p mean: -0.05402034893631935, mean p set: 0.4469420909881592
loss_pred:0.01414499431848526, decouple_loss:0.0011056526564061642
loss_pred:0.014542287215590477, decouple_loss:0.0011599732097238302
2023-05-02 20:19:17 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.05432040989398956, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.05049632117152214, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.050805699080228806, mean p set: 0.4500633478164673
loss_pred:0.01900448091328144, decouple_loss:0.0012790100881829858
loss_pred:0.01788632571697235, decouple_loss:0.001204109052196145
loss_pred:0.01790386624634266, decouple_loss:0.0012287041172385216
WV_0_PC_1_EH_0_PS_40, loss: 0.018326755613088608, avg_mse: 0.02670329436659813
current test mse: 0.026703
Iteration: 4691, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44654616713523865, gen p mean: -0.049893949180841446, mean p set: 0.44702646136283875
The modified gen p mean: 0.44761812686920166, gen p mean: -0.05303625762462616, mean p set: 0.44809842109680176
The modified gen p mean: 0.44750991463661194, gen p mean: -0.05278540030121803, mean p set: 0.44799020886421204
loss_pred:0.013835310004651546, decouple_loss:0.0011976428795605898
loss_pred:0.013671002350747585, decouple_loss:0.0012998753227293491
loss_pred:0.013841529376804829, decouple_loss:0.0012224031379446387
Iteration: 4692, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477819800376892, gen p mean: -0.05293170362710953, mean p set: 0.4482622444629669
loss_pred:0.014328117482364178, decouple_loss:0.0011724835494533181
The modified gen p mean: 0.4465043246746063, gen p mean: -0.05345996096730232, mean p set: 0.4469846189022064The modified gen p mean: 0.44665440917015076, gen p mean: -0.05004957318305969, mean p set: 0.44713470339775085
loss_pred:0.014131799340248108, decouple_loss:0.0011689416132867336
loss_pred:0.01417506393045187, decouple_loss:0.0011442081304267049
Iteration: 4693, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478432238101959, gen p mean: -0.050879497081041336, mean p set: 0.448323518037796
loss_pred:0.014004835858941078, decouple_loss:0.0010379229206591845
The modified gen p mean: 0.44548192620277405, gen p mean: -0.0533609613776207, mean p set: 0.44596222043037415The modified gen p mean: 0.44583749771118164, gen p mean: -0.05390488728880882, mean p set: 0.44631776213645935
loss_pred:0.013537202961742878, decouple_loss:0.001118748914450407
loss_pred:0.013731480576097965, decouple_loss:0.0011352022411301732
Iteration: 4694, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44656628370285034, gen p mean: -0.05421749874949455, mean p set: 0.44704657793045044
loss_pred:0.013992959633469582, decouple_loss:0.0010822892654687166
The modified gen p mean: 0.44601970911026, gen p mean: -0.05306757986545563, mean p set: 0.4465000033378601The modified gen p mean: 0.44689759612083435, gen p mean: -0.048915233463048935, mean p set: 0.44737792015075684
loss_pred:0.013836981728672981, decouple_loss:0.0011654049158096313
loss_pred:0.013542206026613712, decouple_loss:0.0010403183987364173
Iteration: 4695, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468311667442322, gen p mean: -0.054049424827098846, mean p set: 0.4473114311695099
loss_pred:0.013425465673208237, decouple_loss:0.0009887486230581999
The modified gen p mean: 0.44718873500823975, gen p mean: -0.05320529639720917, mean p set: 0.44766902923583984The modified gen p mean: 0.4476187825202942, gen p mean: -0.05446542799472809, mean p set: 0.4480991065502167
loss_pred:0.01379734743386507, decouple_loss:0.0010755591792985797
loss_pred:0.013866749592125416, decouple_loss:0.0011278773890808225
Iteration: 4696, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44653698801994324, gen p mean: -0.05511842295527458, mean p set: 0.4470173120498657
loss_pred:0.013741333968937397, decouple_loss:0.001041338429786265
The modified gen p mean: 0.4459228217601776, gen p mean: -0.0529463104903698, mean p set: 0.4464031159877777The modified gen p mean: 0.4452938735485077, gen p mean: -0.05431193485856056, mean p set: 0.4457741975784302
loss_pred:0.014256659895181656, decouple_loss:0.0010732156224548817
loss_pred:0.013851006515324116, decouple_loss:0.0010925194947049022
Iteration: 4697, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44740718603134155, gen p mean: -0.05083989351987839, mean p set: 0.44788745045661926
loss_pred:0.01398414932191372, decouple_loss:0.0009872163645923138
The modified gen p mean: 0.4465695321559906, gen p mean: -0.05162535607814789, mean p set: 0.4470498263835907The modified gen p mean: 0.4460561275482178, gen p mean: -0.05210375040769577, mean p set: 0.44653645157814026
loss_pred:0.01336874533444643, decouple_loss:0.00101718760561198
loss_pred:0.013120446354150772, decouple_loss:0.0009658602066338062
Iteration: 4698, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4459006190299988, gen p mean: -0.04969536513090134, mean p set: 0.4463808834552765
loss_pred:0.013612276874482632, decouple_loss:0.001031869906000793
The modified gen p mean: 0.44647157192230225, gen p mean: -0.05334332585334778, mean p set: 0.44695183634757996The modified gen p mean: 0.4456821382045746, gen p mean: -0.047385964542627335, mean p set: 0.44616246223449707
loss_pred:0.013780762441456318, decouple_loss:0.0011252473341301084
loss_pred:0.01423190999776125, decouple_loss:0.0010707802139222622
Iteration: 4699, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472788870334625, gen p mean: -0.049389101564884186, mean p set: 0.44775912165641785
loss_pred:0.014258863404393196, decouple_loss:0.0010042336070910096
The modified gen p mean: 0.4466250538825989, gen p mean: -0.047229938209056854, mean p set: 0.447105348110199The modified gen p mean: 0.4473945200443268, gen p mean: -0.046311959624290466, mean p set: 0.44787484407424927
loss_pred:0.013925421051681042, decouple_loss:0.0009590900735929608
loss_pred:0.013748747296631336, decouple_loss:0.0010506403632462025
Iteration: 4700, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44703683257102966, gen p mean: -0.04998026415705681, mean p set: 0.44751712679862976
loss_pred:0.013790532946586609, decouple_loss:0.001099045155569911
The modified gen p mean: 0.44759777188301086, gen p mean: -0.04629545286297798, mean p set: 0.44807806611061096The modified gen p mean: 0.445599764585495, gen p mean: -0.050075434148311615, mean p set: 0.4460800588130951
loss_pred:0.01391942985355854, decouple_loss:0.001016703201457858
loss_pred:0.013533251360058784, decouple_loss:0.0012110986281186342
2023-05-02 20:21:12 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.04991455748677254, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04617573320865631, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.046451568603515625, mean p set: 0.4500633478164673
loss_pred:0.01892697997391224, decouple_loss:0.0011768954573199153
loss_pred:0.017857201397418976, decouple_loss:0.0011268140515312552
loss_pred:0.01788007840514183, decouple_loss:0.0011260992614552379
WV_0_PC_1_EH_0_PS_40, loss: 0.018278583884239197, avg_mse: 0.026671353727579117
current test mse: 0.026671
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012003_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012003_3_24hr.npz
NaN value num: 0
Iteration: 4701, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44785627722740173, gen p mean: -0.04770664870738983, mean p set: 0.44833654165267944
loss_pred:0.01364657562226057, decouple_loss:0.0011155250249430537
The modified gen p mean: 0.4483295679092407, gen p mean: -0.04794915392994881, mean p set: 0.44880983233451843The modified gen p mean: 0.44741371273994446, gen p mean: -0.049149490892887115, mean p set: 0.44789400696754456
loss_pred:0.014290884137153625, decouple_loss:0.0012039633002132177
loss_pred:0.013710918836295605, decouple_loss:0.0011155272368341684
Iteration: 4702, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44851943850517273, gen p mean: -0.05309024080634117, mean p set: 0.4489997327327728
loss_pred:0.013242998160421848, decouple_loss:0.0010817884467542171
The modified gen p mean: 0.4497060179710388, gen p mean: -0.052514590322971344, mean p set: 0.4501863420009613The modified gen p mean: 0.44741255044937134, gen p mean: -0.04894913733005524, mean p set: 0.44789284467697144
loss_pred:0.013133428990840912, decouple_loss:0.0010835255961865187
loss_pred:0.013321648351848125, decouple_loss:0.0011349631240591407
Iteration: 4703, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44809481501579285, gen p mean: -0.05315522849559784, mean p set: 0.44857507944107056
loss_pred:0.012802732177078724, decouple_loss:0.0012836697278544307
The modified gen p mean: 0.4486619234085083, gen p mean: -0.05352339148521423, mean p set: 0.4491422176361084The modified gen p mean: 0.4478241801261902, gen p mean: -0.051869045943021774, mean p set: 0.4483044445514679
loss_pred:0.013505041599273682, decouple_loss:0.001217472366988659
loss_pred:0.013684081844985485, decouple_loss:0.001291214139200747
Iteration: 4704, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483591914176941, gen p mean: -0.05403584986925125, mean p set: 0.4488394856452942
loss_pred:0.013328827917575836, decouple_loss:0.0010653490899130702
The modified gen p mean: 0.44714847207069397, gen p mean: -0.05365881696343422, mean p set: 0.44762876629829407The modified gen p mean: 0.4495103657245636, gen p mean: -0.05264805629849434, mean p set: 0.4499906599521637
loss_pred:0.015093682333827019, decouple_loss:0.0011677802540361881loss_pred:0.013453111983835697, decouple_loss:0.0009932223474606872
Iteration: 4705, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473389685153961, gen p mean: -0.05651666224002838, mean p set: 0.4478192627429962
loss_pred:0.01240507047623396, decouple_loss:0.0012393315555527806
The modified gen p mean: 0.4475441873073578, gen p mean: -0.05304255336523056, mean p set: 0.4480244815349579The modified gen p mean: 0.4473778009414673, gen p mean: -0.052285924553871155, mean p set: 0.4478580951690674
loss_pred:0.013150512240827084, decouple_loss:0.0012816133676096797
loss_pred:0.013197299093008041, decouple_loss:0.0011721159098669887
Iteration: 4706, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44813817739486694, gen p mean: -0.05170867219567299, mean p set: 0.44861847162246704
loss_pred:0.013112761080265045, decouple_loss:0.0011340517085045576
The modified gen p mean: 0.4481275677680969, gen p mean: -0.051700178533792496, mean p set: 0.44860783219337463The modified gen p mean: 0.44847288727760315, gen p mean: -0.04950079321861267, mean p set: 0.44895321130752563
loss_pred:0.013007156550884247, decouple_loss:0.0011427400168031454
loss_pred:0.013098598457872868, decouple_loss:0.0011393468594178557
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 4707, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44756534695625305, gen p mean: -0.04781842231750488, mean p set: 0.44804567098617554
loss_pred:0.013211879879236221, decouple_loss:0.0011520830448716879
The modified gen p mean: 0.44772952795028687, gen p mean: -0.0486731119453907, mean p set: 0.44820985198020935The modified gen p mean: 0.44995635747909546, gen p mean: -0.05255407467484474, mean p set: 0.45043665170669556
loss_pred:0.013351360335946083, decouple_loss:0.0011310759000480175
loss_pred:0.013449512422084808, decouple_loss:0.001238295459188521
Iteration: 4708, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44750773906707764, gen p mean: -0.05284150317311287, mean p set: 0.44798803329467773
loss_pred:0.012920158915221691, decouple_loss:0.0012362981215119362
The modified gen p mean: 0.4472081959247589, gen p mean: -0.04880452901124954, mean p set: 0.447688490152359The modified gen p mean: 0.44824665784835815, gen p mean: -0.046857498586177826, mean p set: 0.44872695207595825
loss_pred:0.013529917225241661, decouple_loss:0.001145241898484528
loss_pred:0.013563611544668674, decouple_loss:0.0012496490962803364
Iteration: 4709, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44828882813453674, gen p mean: -0.049964044243097305, mean p set: 0.44876912236213684
loss_pred:0.01377788931131363, decouple_loss:0.000916822929866612
The modified gen p mean: 0.4486084282398224, gen p mean: -0.05018388479948044, mean p set: 0.4490887224674225The modified gen p mean: 0.4494568407535553, gen p mean: -0.05231809988617897, mean p set: 0.4499371349811554
loss_pred:0.012805747799575329, decouple_loss:0.0011883723782375455
loss_pred:0.013057278469204903, decouple_loss:0.0012737244833260775
Iteration: 4710, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482789933681488, gen p mean: -0.05624706670641899, mean p set: 0.4487592875957489
loss_pred:0.013897105120122433, decouple_loss:0.001215797383338213
The modified gen p mean: 0.447377473115921, gen p mean: -0.05378425866365433, mean p set: 0.44785773754119873The modified gen p mean: 0.44860878586769104, gen p mean: -0.05552090331912041, mean p set: 0.44908908009529114
loss_pred:0.012950382195413113, decouple_loss:0.001217733952216804
loss_pred:0.013542024418711662, decouple_loss:0.0012204344384372234
2023-05-02 20:23:46 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.05924082547426224, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.055236026644706726, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.05555787310004234, mean p set: 0.4500633478164673
loss_pred:0.018982581794261932, decouple_loss:0.001113786594942212
loss_pred:0.01785648614168167, decouple_loss:0.001210625167004764
loss_pred:0.01786651462316513, decouple_loss:0.0011172330705448985
WV_0_PC_1_EH_0_PS_40, loss: 0.018292555585503578, avg_mse: 0.026696227490901947
current test mse: 0.026696
Iteration: 4711, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44823116064071655, gen p mean: -0.05731654912233353, mean p set: 0.44871145486831665
The modified gen p mean: 0.4473952651023865, gen p mean: -0.05986190214753151, mean p set: 0.4478755593299866
The modified gen p mean: 0.44771498441696167, gen p mean: -0.05802398920059204, mean p set: 0.44819530844688416
loss_pred:0.013411588035523891, decouple_loss:0.0011669769883155823
loss_pred:0.013974319212138653, decouple_loss:0.0010368035873398185
loss_pred:0.012486395426094532, decouple_loss:0.0011400197399780154
Iteration: 4712, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480414390563965, gen p mean: -0.05892607942223549, mean p set: 0.44852176308631897
The modified gen p mean: 0.44751808047294617, gen p mean: -0.05657471716403961, mean p set: 0.44799840450286865
loss_pred:0.013459978625178337, decouple_loss:0.0011847720015794039
loss_pred:0.013782775960862637, decouple_loss:0.0010845570359379053
The modified gen p mean: 0.447279691696167, gen p mean: -0.059681326150894165, mean p set: 0.4477599561214447
loss_pred:0.012632915750145912, decouple_loss:0.0011012350441887975
Iteration: 4713, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491927921772003, gen p mean: -0.05564183369278908, mean p set: 0.4496730864048004
loss_pred:0.01327456347644329, decouple_loss:0.0010968645801767707
The modified gen p mean: 0.4484139084815979, gen p mean: -0.05494077131152153, mean p set: 0.448894202709198The modified gen p mean: 0.4476041793823242, gen p mean: -0.05337182804942131, mean p set: 0.4480845034122467
loss_pred:0.0140084782615304, decouple_loss:0.000942638551350683
loss_pred:0.013750088401138783, decouple_loss:0.0009835213422775269
Iteration: 4714, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44844356179237366, gen p mean: -0.0498448871076107, mean p set: 0.44892382621765137
loss_pred:0.01316622644662857, decouple_loss:0.0011884584091603756
The modified gen p mean: 0.44784730672836304, gen p mean: -0.050331443548202515, mean p set: 0.44832760095596313The modified gen p mean: 0.44841238856315613, gen p mean: -0.04933469370007515, mean p set: 0.4488926827907562
loss_pred:0.013155639171600342, decouple_loss:0.0011218518484383821
loss_pred:0.013367987237870693, decouple_loss:0.001061648945324123
Iteration: 4715, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481653571128845, gen p mean: -0.04814647510647774, mean p set: 0.4486456513404846
loss_pred:0.013521293178200722, decouple_loss:0.0010341804008930922
The modified gen p mean: 0.44710773229599, gen p mean: -0.04801074415445328, mean p set: 0.4475880563259125The modified gen p mean: 0.44918733835220337, gen p mean: -0.05104222148656845, mean p set: 0.4496676027774811
loss_pred:0.013233170844614506, decouple_loss:0.0010578181827440858
loss_pred:0.013423114083707333, decouple_loss:0.0011082994751632214
Iteration: 4716, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482533037662506, gen p mean: -0.04635422304272652, mean p set: 0.4487335979938507
loss_pred:0.013213747180998325, decouple_loss:0.0010979768121615052
The modified gen p mean: 0.44710564613342285, gen p mean: -0.04941810667514801, mean p set: 0.44758591055870056The modified gen p mean: 0.4480276107788086, gen p mean: -0.04825132340192795, mean p set: 0.4485079050064087
loss_pred:0.012838102877140045, decouple_loss:0.0009221496875397861
loss_pred:0.012960543856024742, decouple_loss:0.0009298516088165343
Iteration: 4717, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485880732536316, gen p mean: -0.04853592813014984, mean p set: 0.4490683674812317
loss_pred:0.012999803759157658, decouple_loss:0.0009630045387893915
The modified gen p mean: 0.4471968710422516, gen p mean: -0.048362847417593, mean p set: 0.4476771950721741
The modified gen p mean: 0.4477750062942505, gen p mean: -0.04870844632387161, mean p set: 0.4482552707195282
loss_pred:0.014249403029680252, decouple_loss:0.0010697663528844714
loss_pred:0.013748923316597939, decouple_loss:0.0010231423657387495
Iteration: 4718, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503796696662903, gen p mean: -0.05299708992242813, mean p set: 0.4508599638938904
loss_pred:0.01293807104229927, decouple_loss:0.0012477532727643847
The modified gen p mean: 0.44768255949020386, gen p mean: -0.05128877982497215, mean p set: 0.44816285371780396The modified gen p mean: 0.44805198907852173, gen p mean: -0.05018967017531395, mean p set: 0.4485322833061218
loss_pred:0.012733438983559608, decouple_loss:0.0009311079047620296
loss_pred:0.01264948956668377, decouple_loss:0.0009108972735702991
Iteration: 4719, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44821539521217346, gen p mean: -0.049746401607990265, mean p set: 0.44869568943977356
loss_pred:0.013271886855363846, decouple_loss:0.0010638738749548793
The modified gen p mean: 0.44870465993881226, gen p mean: -0.05037442967295647, mean p set: 0.44918495416641235The modified gen p mean: 0.4479374587535858, gen p mean: -0.052012503147125244, mean p set: 0.4484177529811859
loss_pred:0.012982508167624474, decouple_loss:0.0010678718099370599
loss_pred:0.01346223708242178, decouple_loss:0.0009795012883841991
Iteration: 4720, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44874122738838196, gen p mean: -0.05109027028083801, mean p set: 0.44922152161598206
loss_pred:0.013421702198684216, decouple_loss:0.0011550039052963257
The modified gen p mean: 0.44777509570121765, gen p mean: -0.05267386510968208, mean p set: 0.44825538992881775
The modified gen p mean: 0.4476287364959717, gen p mean: -0.05352259427309036, mean p set: 0.4481090009212494
loss_pred:0.01285906508564949, decouple_loss:0.0009618483600206673
loss_pred:0.013035327196121216, decouple_loss:0.000921671511605382
2023-05-02 20:25:42 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.05581064894795418, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.05198635905981064, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.05223012715578079, mean p set: 0.4500633478164673
loss_pred:0.01898285374045372, decouple_loss:0.0010160685051232576
loss_pred:0.01779453456401825, decouple_loss:0.0010136434575542808
loss_pred:0.01782182976603508, decouple_loss:0.0010325942421332002
WV_0_PC_1_EH_0_PS_40, loss: 0.018250778317451477, avg_mse: 0.02665347419679165
current test mse: 0.026653
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012020_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012020_3_24hr.npz
NaN value num: 0
Iteration: 4721, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44988805055618286, gen p mean: -0.05347863957285881, mean p set: 0.45036831498146057
loss_pred:0.014275651425123215, decouple_loss:0.001007867744192481
The modified gen p mean: 0.4507772922515869, gen p mean: -0.05120719224214554, mean p set: 0.4512575566768646The modified gen p mean: 0.45123490691185, gen p mean: -0.05000321939587593, mean p set: 0.4517151713371277
loss_pred:0.014240612275898457, decouple_loss:0.0010838242014870048loss_pred:0.01433366909623146, decouple_loss:0.0010037233587354422
Iteration: 4722, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44925618171691895, gen p mean: -0.05209566652774811, mean p set: 0.44973650574684143
loss_pred:0.014284351840615273, decouple_loss:0.0009399557602591813
The modified gen p mean: 0.44958534836769104, gen p mean: -0.05002719163894653, mean p set: 0.45006564259529114The modified gen p mean: 0.4489690959453583, gen p mean: -0.05146152898669243, mean p set: 0.44944941997528076
loss_pred:0.014513121917843819, decouple_loss:0.000917593133635819
loss_pred:0.014484225772321224, decouple_loss:0.0009444422321394086
Iteration: 4723, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45008423924446106, gen p mean: -0.05152076855301857, mean p set: 0.45056453347206116
loss_pred:0.014845016412436962, decouple_loss:0.0011437591165304184
The modified gen p mean: 0.45019662380218506, gen p mean: -0.042775217443704605, mean p set: 0.45067691802978516The modified gen p mean: 0.4481290280818939, gen p mean: -0.04662454128265381, mean p set: 0.448609322309494
loss_pred:0.014877918176352978, decouple_loss:0.001032363623380661
loss_pred:0.014522220939397812, decouple_loss:0.0010259338887408376
Iteration: 4724, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45068734884262085, gen p mean: -0.04334050044417381, mean p set: 0.45116761326789856
loss_pred:0.014726553112268448, decouple_loss:0.0009332723566330969
The modified gen p mean: 0.4498622715473175, gen p mean: -0.04380696266889572, mean p set: 0.4503425657749176The modified gen p mean: 0.4501456022262573, gen p mean: -0.0404755175113678, mean p set: 0.45062586665153503
loss_pred:0.014048893004655838, decouple_loss:0.0008947030291892588
loss_pred:0.014103859663009644, decouple_loss:0.0009262031526304781
Iteration: 4725, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44966647028923035, gen p mean: -0.04138912260532379, mean p set: 0.45014673471450806
loss_pred:0.013943645171821117, decouple_loss:0.0009405396995134652
The modified gen p mean: 0.44947320222854614, gen p mean: -0.04249092563986778, mean p set: 0.44995349645614624The modified gen p mean: 0.4496612548828125, gen p mean: -0.04704832285642624, mean p set: 0.4501415491104126
loss_pred:0.014502410776913166, decouple_loss:0.0009733346523717046
loss_pred:0.014120610430836678, decouple_loss:0.0009213643497787416
Iteration: 4726, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499345123767853, gen p mean: -0.040208205580711365, mean p set: 0.4504148066043854
loss_pred:0.014755260199308395, decouple_loss:0.0010414754506200552
The modified gen p mean: 0.4506217837333679, gen p mean: -0.0421680212020874, mean p set: 0.451102077960968The modified gen p mean: 0.4504680335521698, gen p mean: -0.044801075011491776, mean p set: 0.4509483277797699
loss_pred:0.01346151065081358, decouple_loss:0.001094576669856906
loss_pred:0.014809228479862213, decouple_loss:0.0010301992297172546
Iteration: 4727, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508281350135803, gen p mean: -0.04991048201918602, mean p set: 0.4513084292411804
loss_pred:0.01402642484754324, decouple_loss:0.0010274872183799744
The modified gen p mean: 0.4495578706264496, gen p mean: -0.04563729837536812, mean p set: 0.4500381648540497The modified gen p mean: 0.4496549367904663, gen p mean: -0.04395047575235367, mean p set: 0.450135201215744
loss_pred:0.013894707895815372, decouple_loss:0.0011245351051911712
loss_pred:0.014114465564489365, decouple_loss:0.0011229197261855006
Iteration: 4728, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507172703742981, gen p mean: -0.0461113378405571, mean p set: 0.4511975646018982
loss_pred:0.01364403311163187, decouple_loss:0.0010359957814216614
The modified gen p mean: 0.450135201215744, gen p mean: -0.052517667412757874, mean p set: 0.4506154954433441The modified gen p mean: 0.4497264325618744, gen p mean: -0.05085368826985359, mean p set: 0.4502067267894745
loss_pred:0.01411563903093338, decouple_loss:0.0010589811718091369
loss_pred:0.01405647024512291, decouple_loss:0.0010177813237532973
Iteration: 4729, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487125277519226, gen p mean: -0.050836894661188126, mean p set: 0.4491928219795227
loss_pred:0.013806796632707119, decouple_loss:0.0009467416093684733
The modified gen p mean: 0.44904807209968567, gen p mean: -0.04955308511853218, mean p set: 0.44952836632728577The modified gen p mean: 0.4489012658596039, gen p mean: -0.04954799637198448, mean p set: 0.4493815302848816
loss_pred:0.013906081207096577, decouple_loss:0.0008954949444159865
loss_pred:0.014597834087908268, decouple_loss:0.0008734500734135509
Iteration: 4730, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503808617591858, gen p mean: -0.049333587288856506, mean p set: 0.4508611261844635
loss_pred:0.014312317594885826, decouple_loss:0.0009731577010825276
The modified gen p mean: 0.4503428041934967, gen p mean: -0.0536971390247345, mean p set: 0.4508230984210968The modified gen p mean: 0.45025718212127686, gen p mean: -0.04930434003472328, mean p set: 0.45073747634887695
loss_pred:0.01399951707571745, decouple_loss:0.0010732583468779922
loss_pred:0.014505697414278984, decouple_loss:0.0010558293433859944
2023-05-02 20:28:16 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.053054407238960266, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04931220784783363, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04957786947488785, mean p set: 0.4500633478164673
loss_pred:0.018743086606264114, decouple_loss:0.00099263247102499
loss_pred:0.017597487196326256, decouple_loss:0.001010692329145968
loss_pred:0.017602913081645966, decouple_loss:0.0009984660428017378
WV_0_PC_1_EH_0_PS_40, loss: 0.01803119294345379, avg_mse: 0.02624114789068699
current test mse: 0.026241
Iteration: 4731, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491356611251831, gen p mean: -0.052724502980709076, mean p set: 0.4496159553527832
The modified gen p mean: 0.44924840331077576, gen p mean: -0.047460466623306274, mean p set: 0.44972866773605347
The modified gen p mean: 0.45010724663734436, gen p mean: -0.049957551062107086, mean p set: 0.45058757066726685
loss_pred:0.013909080997109413, decouple_loss:0.0010074153542518616
loss_pred:0.01430538110435009, decouple_loss:0.001027507707476616
loss_pred:0.014271142892539501, decouple_loss:0.0009185198578052223
Iteration: 4732, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45044729113578796, gen p mean: -0.045825231820344925, mean p set: 0.45092761516571045
loss_pred:0.013770481571555138, decouple_loss:0.0009987103985622525
The modified gen p mean: 0.4498020112514496, gen p mean: -0.04900820553302765, mean p set: 0.4502823054790497The modified gen p mean: 0.4501695930957794, gen p mean: -0.04895533621311188, mean p set: 0.4506498873233795
loss_pred:0.014436314813792706, decouple_loss:0.000988575629889965
loss_pred:0.014028210192918777, decouple_loss:0.0009201795910485089
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 4733, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44861218333244324, gen p mean: -0.04643552377820015, mean p set: 0.4490925073623657
loss_pred:0.014328907243907452, decouple_loss:0.0010065337410196662
The modified gen p mean: 0.4507904052734375, gen p mean: -0.052542660385370255, mean p set: 0.45127072930336
The modified gen p mean: 0.44821521639823914, gen p mean: -0.04851417616009712, mean p set: 0.4486955404281616
loss_pred:0.014197757467627525, decouple_loss:0.0009546388755552471
loss_pred:0.014314197935163975, decouple_loss:0.0010802480392158031
Iteration: 4734, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502379894256592, gen p mean: -0.04846594110131264, mean p set: 0.4507182538509369
loss_pred:0.013973298482596874, decouple_loss:0.0009408030309714377
The modified gen p mean: 0.4487245976924896, gen p mean: -0.04887951537966728, mean p set: 0.4492048919200897The modified gen p mean: 0.449324369430542, gen p mean: -0.047986436635255814, mean p set: 0.4498046338558197
loss_pred:0.01378557924181223, decouple_loss:0.0009524434572085738
loss_pred:0.014259840361773968, decouple_loss:0.001002657227218151
Iteration: 4735, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487113654613495, gen p mean: -0.048686664551496506, mean p set: 0.4491916298866272
loss_pred:0.01461071241647005, decouple_loss:0.0009629885316826403
The modified gen p mean: 0.4494396448135376, gen p mean: -0.04876537248492241, mean p set: 0.4499199688434601The modified gen p mean: 0.4493539035320282, gen p mean: -0.04829424247145653, mean p set: 0.4498342275619507
loss_pred:0.01415345910936594, decouple_loss:0.0009504202171228826
loss_pred:0.01431098859757185, decouple_loss:0.0009383748401887715
Iteration: 4736, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44940632581710815, gen p mean: -0.05062742903828621, mean p set: 0.44988662004470825
loss_pred:0.013681545853614807, decouple_loss:0.0009509969968348742
The modified gen p mean: 0.4502818286418915, gen p mean: -0.046429261565208435, mean p set: 0.4507621228694916The modified gen p mean: 0.4497753381729126, gen p mean: -0.04827156662940979, mean p set: 0.4502556622028351
loss_pred:0.014413430355489254, decouple_loss:0.0011400532675907016
loss_pred:0.014346144162118435, decouple_loss:0.0010585583513602614
Iteration: 4737, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493504762649536, gen p mean: -0.04527277499437332, mean p set: 0.4498307704925537
loss_pred:0.014070423319935799, decouple_loss:0.0009826603345572948
The modified gen p mean: 0.44935041666030884, gen p mean: -0.05043172091245651, mean p set: 0.4498307406902313The modified gen p mean: 0.44969967007637024, gen p mean: -0.050138648599386215, mean p set: 0.45017993450164795
loss_pred:0.014098811894655228, decouple_loss:0.0009622789220884442
loss_pred:0.013624617829918861, decouple_loss:0.0010051334975287318
Iteration: 4738, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449334055185318, gen p mean: -0.05006496235728264, mean p set: 0.4498143792152405
loss_pred:0.01425313949584961, decouple_loss:0.0009394785738550127
The modified gen p mean: 0.45015162229537964, gen p mean: -0.046104446053504944, mean p set: 0.4506319463253021The modified gen p mean: 0.4491085708141327, gen p mean: -0.04624219983816147, mean p set: 0.4495888352394104
loss_pred:0.014090479351580143, decouple_loss:0.0009374805958941579
loss_pred:0.014009185135364532, decouple_loss:0.0009153409046120942
Iteration: 4739, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505214989185333, gen p mean: -0.05488154664635658, mean p set: 0.4510018229484558
loss_pred:0.014881287701427937, decouple_loss:0.001011593034490943
The modified gen p mean: 0.4486853778362274, gen p mean: -0.048160482197999954, mean p set: 0.4491656422615051The modified gen p mean: 0.4492187201976776, gen p mean: -0.050192736089229584, mean p set: 0.4496990144252777
loss_pred:0.014155873097479343, decouple_loss:0.0009588546818122268
loss_pred:0.014753717929124832, decouple_loss:0.0009394208318553865
Iteration: 4740, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505953788757324, gen p mean: -0.05006861686706543, mean p set: 0.4510757029056549
loss_pred:0.014292312785983086, decouple_loss:0.0009559227619320154
The modified gen p mean: 0.4501035213470459, gen p mean: -0.05645442381501198, mean p set: 0.450583815574646The modified gen p mean: 0.44990208745002747, gen p mean: -0.05163271725177765, mean p set: 0.45038241147994995
loss_pred:0.014329817146062851, decouple_loss:0.0009005001047626138
loss_pred:0.013882898725569248, decouple_loss:0.0009472848614677787
2023-05-02 20:30:11 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.05403641611337662, mean p set: 0.4502691626548767
The modified gen p mean: 0.4498766362667084, gen p mean: -0.05004236474633217, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830237865448, gen p mean: -0.05031319335103035, mean p set: 0.4500633478164673
loss_pred:0.018728068098425865, decouple_loss:0.0009249905124306679
loss_pred:0.017628202214837074, decouple_loss:0.0009418910485692322
loss_pred:0.01762823387980461, decouple_loss:0.0009106941288337111
WV_0_PC_1_EH_0_PS_40, loss: 0.018041128292679787, avg_mse: 0.026280364021658897
current test mse: 0.02628
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012006_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012006_3_24hr.npz
NaN value num: 0
Iteration: 4741, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4524969458580017, gen p mean: -0.04623894393444061, mean p set: 0.4529772400856018
loss_pred:0.01577460765838623, decouple_loss:0.0010954393073916435
The modified gen p mean: 0.4521520137786865, gen p mean: -0.04334509000182152, mean p set: 0.4526323080062866The modified gen p mean: 0.45085933804512024, gen p mean: -0.048330020159482956, mean p set: 0.45133963227272034
loss_pred:0.01563739962875843, decouple_loss:0.0010510432766750455
loss_pred:0.01571047492325306, decouple_loss:0.0011282196501269937
Iteration: 4742, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45280522108078003, gen p mean: -0.049122560769319534, mean p set: 0.45328548550605774
loss_pred:0.01547783799469471, decouple_loss:0.0012347662122920156
The modified gen p mean: 0.44968923926353455, gen p mean: -0.04884970188140869, mean p set: 0.45016953349113464The modified gen p mean: 0.451323926448822, gen p mean: -0.04382935166358948, mean p set: 0.4518042206764221
loss_pred:0.01586209423840046, decouple_loss:0.0011264317436143756
loss_pred:0.0154897915199399, decouple_loss:0.0011192697566002607
Iteration: 4743, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45129314064979553, gen p mean: -0.050853047519922256, mean p set: 0.451773464679718
loss_pred:0.015906164422631264, decouple_loss:0.0010619761887937784
The modified gen p mean: 0.45141032338142395, gen p mean: -0.046974409371614456, mean p set: 0.45189061760902405The modified gen p mean: 0.4525904357433319, gen p mean: -0.050890978425741196, mean p set: 0.453070729970932
loss_pred:0.015401064418256283, decouple_loss:0.0010296216933056712
loss_pred:0.015418315306305885, decouple_loss:0.001075954525731504
Iteration: 4744, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45025011897087097, gen p mean: -0.04538203775882721, mean p set: 0.45073044300079346
loss_pred:0.015691528096795082, decouple_loss:0.0010798117145895958
The modified gen p mean: 0.45286643505096436, gen p mean: -0.04496116191148758, mean p set: 0.45334672927856445The modified gen p mean: 0.4527682662010193, gen p mean: -0.04353593662381172, mean p set: 0.4532485604286194
loss_pred:0.015862200409173965, decouple_loss:0.0010876504238694906
loss_pred:0.01613340899348259, decouple_loss:0.0010691884672269225
Iteration: 4745, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45203450322151184, gen p mean: -0.046043913811445236, mean p set: 0.45251479744911194
loss_pred:0.015620201826095581, decouple_loss:0.0009681092342361808
The modified gen p mean: 0.45303037762641907, gen p mean: -0.03825182467699051, mean p set: 0.45351067185401917The modified gen p mean: 0.45221635699272156, gen p mean: -0.04533084109425545, mean p set: 0.45269668102264404
loss_pred:0.01572479121387005, decouple_loss:0.0009982053888961673
loss_pred:0.015463420189917088, decouple_loss:0.0009346350561827421
Iteration: 4746, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45203670859336853, gen p mean: -0.03544585779309273, mean p set: 0.452517032623291
loss_pred:0.015743011608719826, decouple_loss:0.0010558725334703922
The modified gen p mean: 0.4527053236961365, gen p mean: -0.04603174328804016, mean p set: 0.4531856179237366The modified gen p mean: 0.451790988445282, gen p mean: -0.042216911911964417, mean p set: 0.45227131247520447
loss_pred:0.015660671517252922, decouple_loss:0.0011906783329322934
loss_pred:0.015340073965489864, decouple_loss:0.0011908538872376084
Iteration: 4747, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507061541080475, gen p mean: -0.04611625522375107, mean p set: 0.4511864483356476
loss_pred:0.01617339998483658, decouple_loss:0.001059307367540896
The modified gen p mean: 0.45154979825019836, gen p mean: -0.04336750507354736, mean p set: 0.45203009247779846The modified gen p mean: 0.4523903429508209, gen p mean: -0.043401338160037994, mean p set: 0.452870637178421
loss_pred:0.01634565182030201, decouple_loss:0.0011127833276987076
loss_pred:0.015445523895323277, decouple_loss:0.0010604726849123836
Iteration: 4748, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4518226385116577, gen p mean: -0.042777903378009796, mean p set: 0.4523029327392578
loss_pred:0.01562725193798542, decouple_loss:0.0010405502980574965
The modified gen p mean: 0.45100727677345276, gen p mean: -0.04672623053193092, mean p set: 0.45148760080337524The modified gen p mean: 0.45300841331481934, gen p mean: -0.041279084980487823, mean p set: 0.45348870754241943
loss_pred:0.01573983021080494, decouple_loss:0.00112418201752007
loss_pred:0.015549610368907452, decouple_loss:0.0009737754589878023
Iteration: 4749, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.451680064201355, gen p mean: -0.04178912565112114, mean p set: 0.4521603584289551
loss_pred:0.015707705169916153, decouple_loss:0.0010187847074121237
The modified gen p mean: 0.45238539576530457, gen p mean: -0.034010402858257294, mean p set: 0.4528656601905823The modified gen p mean: 0.45311006903648376, gen p mean: -0.0408724844455719, mean p set: 0.45359036326408386
loss_pred:0.015760868787765503, decouple_loss:0.0009830116759985685
loss_pred:0.016145626083016396, decouple_loss:0.0009767739102244377
Iteration: 4750, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4538275897502899, gen p mean: -0.03783774375915527, mean p set: 0.4543078541755676
loss_pred:0.015676328912377357, decouple_loss:0.0010670482879504561
The modified gen p mean: 0.44957488775253296, gen p mean: -0.04458124563097954, mean p set: 0.45005518198013306The modified gen p mean: 0.4530589282512665, gen p mean: -0.04439408704638481, mean p set: 0.45353925228118896
loss_pred:0.015683861449360847, decouple_loss:0.0010317270644009113
loss_pred:0.015495356172323227, decouple_loss:0.001298651797696948
2023-05-02 20:32:45 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.04873724654316902, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.045100342482328415, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04527300223708153, mean p set: 0.4500633478164673
loss_pred:0.018400872126221657, decouple_loss:0.001094179693609476
loss_pred:0.01737554930150509, decouple_loss:0.0010369803057983518
loss_pred:0.017373573035001755, decouple_loss:0.0010344833135604858
WV_0_PC_1_EH_0_PS_40, loss: 0.017769426107406616, avg_mse: 0.02566906437277794
current test mse: 0.025669
Iteration: 4751, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4509139657020569, gen p mean: -0.040741875767707825, mean p set: 0.451394259929657
The modified gen p mean: 0.4524695873260498, gen p mean: -0.051870618015527725, mean p set: 0.4529498815536499
The modified gen p mean: 0.45390570163726807, gen p mean: -0.04566255211830139, mean p set: 0.4543859660625458
loss_pred:0.01527534518390894, decouple_loss:0.0009512198739685118
loss_pred:0.01550571620464325, decouple_loss:0.000927862012758851
loss_pred:0.01503871101886034, decouple_loss:0.0012105803471058607
Iteration: 4752, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45258426666259766, gen p mean: -0.045551951974630356, mean p set: 0.45306456089019775
loss_pred:0.01568729244172573, decouple_loss:0.00112587446346879
The modified gen p mean: 0.4509826600551605, gen p mean: -0.04208676889538765, mean p set: 0.4514629542827606The modified gen p mean: 0.4493550956249237, gen p mean: -0.046576324850320816, mean p set: 0.4498353600502014
loss_pred:0.015576241537928581, decouple_loss:0.0011036503128707409
loss_pred:0.01605215109884739, decouple_loss:0.0010757974814623594
Iteration: 4753, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45566442608833313, gen p mean: -0.04338594153523445, mean p set: 0.45614469051361084
loss_pred:0.015072898007929325, decouple_loss:0.0010141250677406788
The modified gen p mean: 0.45167723298072815, gen p mean: -0.045350559055805206, mean p set: 0.45215752720832825The modified gen p mean: 0.4516352713108063, gen p mean: -0.04339645802974701, mean p set: 0.45211559534072876
loss_pred:0.015742653980851173, decouple_loss:0.0009883445454761386
loss_pred:0.01577448472380638, decouple_loss:0.0009409636841155589
Iteration: 4754, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.452595055103302, gen p mean: -0.041124265640974045, mean p set: 0.4530753493309021
loss_pred:0.015710022300481796, decouple_loss:0.0010113060707226396
The modified gen p mean: 0.45283243060112, gen p mean: -0.037782683968544006, mean p set: 0.4533127248287201The modified gen p mean: 0.4500974416732788, gen p mean: -0.04705645889043808, mean p set: 0.4505777657032013
loss_pred:0.015448875725269318, decouple_loss:0.0010821981122717261
loss_pred:0.01578550785779953, decouple_loss:0.0009840490529313684
Iteration: 4755, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4529622495174408, gen p mean: -0.03965236246585846, mean p set: 0.4534425735473633
loss_pred:0.015805060043931007, decouple_loss:0.0009931103559210896
The modified gen p mean: 0.45246604084968567, gen p mean: -0.03418492525815964, mean p set: 0.45294633507728577The modified gen p mean: 0.4524964988231659, gen p mean: -0.037580616772174835, mean p set: 0.452976793050766
loss_pred:0.015851866453886032, decouple_loss:0.0009323513368144631
loss_pred:0.01562548242509365, decouple_loss:0.000983414356596768
Iteration: 4756, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4525321125984192, gen p mean: -0.04890994727611542, mean p set: 0.4530124366283417
loss_pred:0.015211810357868671, decouple_loss:0.0012646812247112393
The modified gen p mean: 0.45029470324516296, gen p mean: -0.04631819948554039, mean p set: 0.45077502727508545The modified gen p mean: 0.45206886529922485, gen p mean: -0.04063603654503822, mean p set: 0.45254912972450256
loss_pred:0.01591106876730919, decouple_loss:0.0010303894523531199
loss_pred:0.01537852268666029, decouple_loss:0.001132600475102663
Iteration: 4757, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4548882842063904, gen p mean: -0.04503416270017624, mean p set: 0.45536860823631287
loss_pred:0.015035940334200859, decouple_loss:0.00111779710277915
The modified gen p mean: 0.45077621936798096, gen p mean: -0.043976638466119766, mean p set: 0.45125651359558105The modified gen p mean: 0.4523267447948456, gen p mean: -0.04564859718084335, mean p set: 0.4528070092201233
loss_pred:0.01542761828750372, decouple_loss:0.0009821822168305516
loss_pred:0.01512764673680067, decouple_loss:0.001169218448922038
Iteration: 4758, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4547361135482788, gen p mean: -0.043251220136880875, mean p set: 0.4552163779735565
loss_pred:0.015462171286344528, decouple_loss:0.001046818564645946
The modified gen p mean: 0.45142704248428345, gen p mean: -0.0460163913667202, mean p set: 0.45190730690956116The modified gen p mean: 0.45109182596206665, gen p mean: -0.045445576310157776, mean p set: 0.45157214999198914
loss_pred:0.015624617226421833, decouple_loss:0.0010340301087126136
loss_pred:0.015750380232930183, decouple_loss:0.0010785480262711644
Iteration: 4759, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508713483810425, gen p mean: -0.048072513192892075, mean p set: 0.4513516426086426
loss_pred:0.015617972239851952, decouple_loss:0.0011261681793257594
The modified gen p mean: 0.45037293434143066, gen p mean: -0.05137075111269951, mean p set: 0.45085322856903076The modified gen p mean: 0.4513205289840698, gen p mean: -0.050070516765117645, mean p set: 0.4518008232116699
loss_pred:0.016242627054452896, decouple_loss:0.0011377506889402866
loss_pred:0.0151523994281888, decouple_loss:0.0011377200717106462
Iteration: 4760, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45132339000701904, gen p mean: -0.04780944809317589, mean p set: 0.45180368423461914
loss_pred:0.015427421778440475, decouple_loss:0.001357742235995829
The modified gen p mean: 0.4534645974636078, gen p mean: -0.04618048667907715, mean p set: 0.4539449214935303
The modified gen p mean: 0.4521898925304413, gen p mean: -0.03892209008336067, mean p set: 0.45267021656036377
loss_pred:0.015559502877295017, decouple_loss:0.0012514091795310378
loss_pred:0.015738042071461678, decouple_loss:0.001000432064756751

2023-05-02 20:34:39 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.05007185786962509, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.046425711363554, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04678797721862793, mean p set: 0.4500633478164673
loss_pred:0.01842082478106022, decouple_loss:0.00131304282695055
loss_pred:0.017392534762620926, decouple_loss:0.0013138472568243742
loss_pred:0.017385879531502724, decouple_loss:0.0012757455697283149
WV_0_PC_1_EH_0_PS_40, loss: 0.017798123881220818, avg_mse: 0.025706302374601364
current test mse: 0.025706
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012004_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012004_3_24hr.npz
NaN value num: 0
Iteration: 4761, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44763290882110596, gen p mean: -0.05136875808238983, mean p set: 0.44811320304870605
loss_pred:0.013976702466607094, decouple_loss:0.0012069244403392076
The modified gen p mean: 0.4474705457687378, gen p mean: -0.043853286653757095, mean p set: 0.4479508101940155The modified gen p mean: 0.4466976225376129, gen p mean: -0.04465807229280472, mean p set: 0.447177916765213
loss_pred:0.014377642422914505, decouple_loss:0.0013563089305534959loss_pred:0.013950170017778873, decouple_loss:0.001232735812664032
Iteration: 4762, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4458562433719635, gen p mean: -0.05230487883090973, mean p set: 0.446336567401886
loss_pred:0.013779997825622559, decouple_loss:0.0010833429405465722
The modified gen p mean: 0.44606471061706543, gen p mean: -0.05149112269282341, mean p set: 0.4465450048446655The modified gen p mean: 0.44809916615486145, gen p mean: -0.04796670377254486, mean p set: 0.44857946038246155
loss_pred:0.013593175448477268, decouple_loss:0.001048382604494691
loss_pred:0.014086175709962845, decouple_loss:0.0010624458082020283
Iteration: 4763, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473423361778259, gen p mean: -0.053548429161310196, mean p set: 0.447822630405426
loss_pred:0.013515254482626915, decouple_loss:0.0012396237580105662
The modified gen p mean: 0.44716641306877136, gen p mean: -0.046546682715415955, mean p set: 0.44764673709869385The modified gen p mean: 0.4481734335422516, gen p mean: -0.050325408577919006, mean p set: 0.4486536979675293
loss_pred:0.013491928577423096, decouple_loss:0.0012096079299226403
loss_pred:0.013897813856601715, decouple_loss:0.0012193461880087852
Iteration: 4764, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478653371334076, gen p mean: -0.05482420325279236, mean p set: 0.4483456313610077
loss_pred:0.013857806101441383, decouple_loss:0.0011291052214801311
The modified gen p mean: 0.4468432366847992, gen p mean: -0.057256069034338, mean p set: 0.4473235309123993The modified gen p mean: 0.44751396775245667, gen p mean: -0.0520896390080452, mean p set: 0.44799429178237915
loss_pred:0.01384870707988739, decouple_loss:0.001091104932129383
loss_pred:0.013370515778660774, decouple_loss:0.0011608923086896539
Iteration: 4765, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4460369944572449, gen p mean: -0.05609162524342537, mean p set: 0.44651728868484497
loss_pred:0.013500514440238476, decouple_loss:0.0013619925593957305
The modified gen p mean: 0.44772395491600037, gen p mean: -0.05326465517282486, mean p set: 0.44820424914360046The modified gen p mean: 0.44733962416648865, gen p mean: -0.057472895830869675, mean p set: 0.44781988859176636
loss_pred:0.013911840505897999, decouple_loss:0.0012862191069871187
loss_pred:0.01411394588649273, decouple_loss:0.001170998439192772
Iteration: 4766, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447536826133728, gen p mean: -0.051298838108778, mean p set: 0.4480171501636505
loss_pred:0.014240795746445656, decouple_loss:0.0011922859121114016
The modified gen p mean: 0.44744789600372314, gen p mean: -0.05086945369839668, mean p set: 0.44792816042900085The modified gen p mean: 0.447194367647171, gen p mean: -0.05040786787867546, mean p set: 0.4476746618747711
loss_pred:0.013296205550432205, decouple_loss:0.0011505635920912027
loss_pred:0.014067549258470535, decouple_loss:0.001161344232968986
Iteration: 4767, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473298192024231, gen p mean: -0.051101017743349075, mean p set: 0.4478101134300232
loss_pred:0.013653852045536041, decouple_loss:0.0013364602345973253
The modified gen p mean: 0.44827932119369507, gen p mean: -0.05380110442638397, mean p set: 0.44875964522361755The modified gen p mean: 0.44665244221687317, gen p mean: -0.04959331452846527, mean p set: 0.44713273644447327
loss_pred:0.013574544340372086, decouple_loss:0.0013512007426470518
loss_pred:0.013424322009086609, decouple_loss:0.0011642193421721458
Iteration: 4768, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4463234543800354, gen p mean: -0.05061262473464012, mean p set: 0.4468037486076355
loss_pred:0.013939587399363518, decouple_loss:0.0011964099248871207
The modified gen p mean: 0.4486333727836609, gen p mean: -0.0509025976061821, mean p set: 0.449113667011261The modified gen p mean: 0.44784218072891235, gen p mean: -0.043360620737075806, mean p set: 0.44832247495651245
loss_pred:0.013864746317267418, decouple_loss:0.00122983253095299
loss_pred:0.014193389564752579, decouple_loss:0.0011590674985200167
Iteration: 4769, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476921856403351, gen p mean: -0.04657531529664993, mean p set: 0.44817250967025757
loss_pred:0.013681827113032341, decouple_loss:0.0011514632496982813
The modified gen p mean: 0.44795337319374084, gen p mean: -0.04775664582848549, mean p set: 0.44843369722366333The modified gen p mean: 0.44727715849876404, gen p mean: -0.05055121332406998, mean p set: 0.44775745272636414
loss_pred:0.013563294894993305, decouple_loss:0.001318398048169911
loss_pred:0.013611783273518085, decouple_loss:0.001248084707185626
Iteration: 4770, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44804468750953674, gen p mean: -0.04662524163722992, mean p set: 0.44852498173713684
loss_pred:0.013839482329785824, decouple_loss:0.001133179641328752
The modified gen p mean: 0.4479922950267792, gen p mean: -0.04815349355340004, mean p set: 0.4484725892543793The modified gen p mean: 0.44725465774536133, gen p mean: -0.04845793917775154, mean p set: 0.44773492217063904
loss_pred:0.013179859146475792, decouple_loss:0.0011377084301784635
loss_pred:0.01345843356102705, decouple_loss:0.0011430848389863968
2023-05-02 20:37:12 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.05156997591257095, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987669587135315, gen p mean: -0.04802729934453964, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.04800906032323837, mean p set: 0.4500633478164673
loss_pred:0.018977466970682144, decouple_loss:0.0011330083943903446
loss_pred:0.01795429177582264, decouple_loss:0.0011700819013640285
loss_pred:0.017915310338139534, decouple_loss:0.0010874245781451464
WV_0_PC_1_EH_0_PS_40, loss: 0.018338864669203758, avg_mse: 0.02676372230052948
current test mse: 0.026764
Iteration: 4771, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44642502069473267, gen p mean: -0.04747164994478226, mean p set: 0.4469052851200104
The modified gen p mean: 0.44786497950553894, gen p mean: -0.045437898486852646, mean p set: 0.44834527373313904
The modified gen p mean: 0.4476579427719116, gen p mean: -0.05068469047546387, mean p set: 0.4481382668018341
loss_pred:0.012972832657396793, decouple_loss:0.0011490860488265753
loss_pred:0.013399574905633926, decouple_loss:0.0011188738280907273
loss_pred:0.013829158619046211, decouple_loss:0.0010435751173645258
Iteration: 4772, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483192265033722, gen p mean: -0.04654664546251297, mean p set: 0.4487995207309723
loss_pred:0.013722222298383713, decouple_loss:0.0011013495968654752
The modified gen p mean: 0.44784584641456604, gen p mean: -0.04773831367492676, mean p set: 0.44832614064216614The modified gen p mean: 0.448651522397995, gen p mean: -0.047665081918239594, mean p set: 0.4491317868232727
loss_pred:0.012930154800415039, decouple_loss:0.001123678288422525
loss_pred:0.013153629377484322, decouple_loss:0.0011172319063916802
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 4773, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4455784261226654, gen p mean: -0.04606442153453827, mean p set: 0.4460587203502655
loss_pred:0.013304663822054863, decouple_loss:0.0011018395889550447
The modified gen p mean: 0.44667744636535645, gen p mean: -0.052681516855955124, mean p set: 0.44715774059295654The modified gen p mean: 0.4470152258872986, gen p mean: -0.053125277161598206, mean p set: 0.4474954903125763
loss_pred:0.013588001020252705, decouple_loss:0.0011909460881724954
loss_pred:0.013992412015795708, decouple_loss:0.0011384212411940098
Iteration: 4774, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472847878932953, gen p mean: -0.04735704883933067, mean p set: 0.4477651119232178
loss_pred:0.013509768061339855, decouple_loss:0.001057044486515224
The modified gen p mean: 0.4462664723396301, gen p mean: -0.051401957869529724, mean p set: 0.4467467665672302The modified gen p mean: 0.44732123613357544, gen p mean: -0.05607294291257858, mean p set: 0.44780153036117554
loss_pred:0.013312975876033306, decouple_loss:0.0010920579079538584
loss_pred:0.013992421329021454, decouple_loss:0.0011121630668640137
Iteration: 4775, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44792696833610535, gen p mean: -0.0543430894613266, mean p set: 0.44840726256370544
loss_pred:0.013428750447928905, decouple_loss:0.0011273911222815514
The modified gen p mean: 0.447773814201355, gen p mean: -0.056612227112054825, mean p set: 0.4482541084289551The modified gen p mean: 0.44812795519828796, gen p mean: -0.05258525162935257, mean p set: 0.44860827922821045
loss_pred:0.013564626686275005, decouple_loss:0.001405607908964157
loss_pred:0.01347341202199459, decouple_loss:0.0013293620431795716
Iteration: 4776, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483369290828705, gen p mean: -0.05086851865053177, mean p set: 0.4488171935081482
loss_pred:0.013057193718850613, decouple_loss:0.0011259844759479165
The modified gen p mean: 0.4473123550415039, gen p mean: -0.05648646131157875, mean p set: 0.4477926790714264The modified gen p mean: 0.44619259238243103, gen p mean: -0.05738380551338196, mean p set: 0.44667288661003113
loss_pred:0.013399804010987282, decouple_loss:0.0011715356959030032
loss_pred:0.013183720409870148, decouple_loss:0.001110164332203567
Iteration: 4777, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466927945613861, gen p mean: -0.05452003329992294, mean p set: 0.4471730887889862
loss_pred:0.013859124854207039, decouple_loss:0.0011651344830170274
The modified gen p mean: 0.4481970965862274, gen p mean: -0.04906448721885681, mean p set: 0.4486773908138275The modified gen p mean: 0.44809389114379883, gen p mean: -0.05179757624864578, mean p set: 0.4485742151737213
loss_pred:0.013236244209110737, decouple_loss:0.001151733216829598
loss_pred:0.013152465224266052, decouple_loss:0.0011421400122344494
Iteration: 4778, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44811680912971497, gen p mean: -0.049679867923259735, mean p set: 0.4485970735549927
loss_pred:0.012955045327544212, decouple_loss:0.001122193061746657
The modified gen p mean: 0.44733601808547974, gen p mean: -0.05511511489748955, mean p set: 0.44781628251075745The modified gen p mean: 0.4466818571090698, gen p mean: -0.05125115066766739, mean p set: 0.4471621811389923
loss_pred:0.013677962124347687, decouple_loss:0.001112437224946916
loss_pred:0.013464277610182762, decouple_loss:0.0011527998140081763
Iteration: 4779, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467615783214569, gen p mean: -0.05283336341381073, mean p set: 0.447241872549057
loss_pred:0.0134302182123065, decouple_loss:0.0011280395556241274
The modified gen p mean: 0.4466300308704376, gen p mean: -0.05296416953206062, mean p set: 0.4471103250980377The modified gen p mean: 0.4480590224266052, gen p mean: -0.04839957505464554, mean p set: 0.4485393166542053
loss_pred:0.013933954760432243, decouple_loss:0.001031731255352497
loss_pred:0.01319668535143137, decouple_loss:0.0010151283349841833
Iteration: 4780, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476127028465271, gen p mean: -0.043424610048532486, mean p set: 0.4480930268764496
loss_pred:0.014195995405316353, decouple_loss:0.0010749844368547201
The modified gen p mean: 0.44762372970581055, gen p mean: -0.051037415862083435, mean p set: 0.44810402393341064
The modified gen p mean: 0.4481574296951294, gen p mean: -0.05249442905187607, mean p set: 0.4486377537250519
loss_pred:0.013084840029478073, decouple_loss:0.0010984736727550626
loss_pred:0.013331836089491844, decouple_loss:0.0009579762700013816
2023-05-02 20:39:07 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.051548611372709274, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04759155213832855, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.04776942729949951, mean p set: 0.4500633478164673
loss_pred:0.018846821039915085, decouple_loss:0.0010286511387676
loss_pred:0.017825016751885414, decouple_loss:0.0010115872137248516
loss_pred:0.017815303057432175, decouple_loss:0.0010025863302871585
WV_0_PC_1_EH_0_PS_40, loss: 0.018213097006082535, avg_mse: 0.026568971574306488
current test mse: 0.026569
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012007_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012007_3_24hr.npz
NaN value num: 0
Iteration: 4781, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45065465569496155, gen p mean: -0.046630073338747025, mean p set: 0.45113492012023926
loss_pred:0.016310665756464005, decouple_loss:0.001126496703363955
The modified gen p mean: 0.4504697918891907, gen p mean: -0.037893954664468765, mean p set: 0.45095011591911316The modified gen p mean: 0.44957560300827026, gen p mean: -0.04688457027077675, mean p set: 0.45005589723587036
loss_pred:0.015958359465003014, decouple_loss:0.0010835392167791724
loss_pred:0.016276424750685692, decouple_loss:0.00114518275950104
Iteration: 4782, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45149409770965576, gen p mean: -0.04665156453847885, mean p set: 0.45197439193725586
The modified gen p mean: 0.4512324929237366, gen p mean: -0.047294728457927704, mean p set: 0.45171278715133667loss_pred:0.0162846390157938, decouple_loss:0.0010264337761327624
The modified gen p mean: 0.4534813463687897, gen p mean: -0.04173928499221802, mean p set: 0.4539616107940674
loss_pred:0.01668400689959526, decouple_loss:0.001105485251173377
loss_pred:0.016705477610230446, decouple_loss:0.0010664616711437702
Iteration: 4783, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45001882314682007, gen p mean: -0.047424979507923126, mean p set: 0.45049911737442017
The modified gen p mean: 0.4517361521720886, gen p mean: -0.04597216844558716, mean p set: 0.45221641659736633
loss_pred:0.015680979937314987, decouple_loss:0.0010895606828853488
loss_pred:0.016051048412919044, decouple_loss:0.0010540754301473498
The modified gen p mean: 0.4545752704143524, gen p mean: -0.044328849762678146, mean p set: 0.4550555646419525
loss_pred:0.01554708369076252, decouple_loss:0.0010330828372389078
Iteration: 4784, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45053309202194214, gen p mean: -0.04054833576083183, mean p set: 0.45101335644721985
The modified gen p mean: 0.4516301155090332, gen p mean: -0.03558630123734474, mean p set: 0.4521104097366333
loss_pred:0.016505060717463493, decouple_loss:0.001291140215471387
loss_pred:0.0158530343323946, decouple_loss:0.0011948136379942298
The modified gen p mean: 0.451885849237442, gen p mean: -0.04145520180463791, mean p set: 0.4523661732673645
loss_pred:0.016207393258810043, decouple_loss:0.001252099173143506
Iteration: 4785, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45036688446998596, gen p mean: -0.030401142314076424, mean p set: 0.45084720849990845
The modified gen p mean: 0.4499392807483673, gen p mean: -0.03259306028485298, mean p set: 0.450419545173645
loss_pred:0.016164105385541916, decouple_loss:0.0011604962637647986
loss_pred:0.016978871077299118, decouple_loss:0.0011000675149261951
The modified gen p mean: 0.45448148250579834, gen p mean: -0.04168756306171417, mean p set: 0.45496177673339844
loss_pred:0.015458195470273495, decouple_loss:0.0011183380847796798
Iteration: 4786, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4531993865966797, gen p mean: -0.038913872092962265, mean p set: 0.4536796808242798
loss_pred:0.015516460873186588, decouple_loss:0.0012891468359157443
The modified gen p mean: 0.4517209529876709, gen p mean: -0.03417392447590828, mean p set: 0.452201247215271
The modified gen p mean: 0.4501040279865265, gen p mean: -0.030358800664544106, mean p set: 0.4505843222141266
loss_pred:0.016587546095252037, decouple_loss:0.001143394852988422
loss_pred:0.01689770817756653, decouple_loss:0.0010431259870529175
Iteration: 4787, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45251888036727905, gen p mean: -0.03794032707810402, mean p set: 0.45299920439720154
loss_pred:0.01585829071700573, decouple_loss:0.0011120411800220609
The modified gen p mean: 0.449608713388443, gen p mean: -0.03862009197473526, mean p set: 0.4500890374183655The modified gen p mean: 0.4514771103858948, gen p mean: -0.03841963782906532, mean p set: 0.4519573748111725
loss_pred:0.015912320464849472, decouple_loss:0.0010952717857435346
loss_pred:0.016556929796934128, decouple_loss:0.0011732226703315973
Iteration: 4788, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450214147567749, gen p mean: -0.04059605672955513, mean p set: 0.4506944417953491
loss_pred:0.015751780942082405, decouple_loss:0.0011408962309360504
The modified gen p mean: 0.4528534412384033, gen p mean: -0.03657826781272888, mean p set: 0.45333370566368103The modified gen p mean: 0.4518057405948639, gen p mean: -0.03567036613821983, mean p set: 0.4522860050201416
loss_pred:0.015968890860676765, decouple_loss:0.0011822718661278486
loss_pred:0.015833193436264992, decouple_loss:0.0011202350724488497
Iteration: 4789, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45048457384109497, gen p mean: -0.03736209124326706, mean p set: 0.45096486806869507
loss_pred:0.016586273908615112, decouple_loss:0.0011794341262429953
The modified gen p mean: 0.4523911774158478, gen p mean: -0.0417165532708168, mean p set: 0.4528714418411255The modified gen p mean: 0.4509778320789337, gen p mean: -0.037045542150735855, mean p set: 0.4514580965042114
loss_pred:0.015466166660189629, decouple_loss:0.0011084976140409708
loss_pred:0.015897948294878006, decouple_loss:0.0010432241251692176
Iteration: 4790, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500962197780609, gen p mean: -0.04179021716117859, mean p set: 0.450576514005661
loss_pred:0.01541475486010313, decouple_loss:0.0011242307955399156
The modified gen p mean: 0.45031237602233887, gen p mean: -0.04152780398726463, mean p set: 0.45079267024993896The modified gen p mean: 0.4500791132450104, gen p mean: -0.04515789449214935, mean p set: 0.4505594074726105
loss_pred:0.01539965532720089, decouple_loss:0.0011517377570271492
loss_pred:0.015563519671559334, decouple_loss:0.0012008039047941566
2023-05-02 20:41:41 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.04570735991001129, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.041935041546821594, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.042064864188432693, mean p set: 0.4500633478164673
loss_pred:0.01848546601831913, decouple_loss:0.0010326647898182273
loss_pred:0.017423439770936966, decouple_loss:0.0011315869633108377
loss_pred:0.017486754804849625, decouple_loss:0.0010631000623106956
WV_0_PC_1_EH_0_PS_40, loss: 0.01785234361886978, avg_mse: 0.02580500952899456
current test mse: 0.025805
Iteration: 4791, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4517064392566681, gen p mean: -0.034814052283763885, mean p set: 0.4521867632865906
The modified gen p mean: 0.4516116976737976, gen p mean: -0.04369615763425827, mean p set: 0.4520919919013977
The modified gen p mean: 0.45176786184310913, gen p mean: -0.04427912086248398, mean p set: 0.45224812626838684
loss_pred:0.01538901124149561, decouple_loss:0.0010743492748588324
loss_pred:0.015789695084095, decouple_loss:0.0010298386914655566
loss_pred:0.015755511820316315, decouple_loss:0.0009515314595773816
Iteration: 4792, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511910676956177, gen p mean: -0.042107805609703064, mean p set: 0.4516713619232178
The modified gen p mean: 0.44842660427093506, gen p mean: -0.043162330985069275, mean p set: 0.44890692830085754loss_pred:0.01576681062579155, decouple_loss:0.001324220560491085
The modified gen p mean: 0.4494204819202423, gen p mean: -0.044556569308042526, mean p set: 0.44990074634552
loss_pred:0.01630316860973835, decouple_loss:0.0011503539280965924
loss_pred:0.016891004517674446, decouple_loss:0.0012673857854679227
Iteration: 4793, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.451246976852417, gen p mean: -0.041605304926633835, mean p set: 0.4517273008823395
loss_pred:0.015858903527259827, decouple_loss:0.0011379116913303733
The modified gen p mean: 0.45197051763534546, gen p mean: -0.04293089732527733, mean p set: 0.45245081186294556The modified gen p mean: 0.45008569955825806, gen p mean: -0.04305129125714302, mean p set: 0.45056599378585815
loss_pred:0.015812842175364494, decouple_loss:0.0010953901801258326
loss_pred:0.016901545226573944, decouple_loss:0.0011091894702985883
Iteration: 4794, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45218247175216675, gen p mean: -0.050399843603372574, mean p set: 0.45266276597976685
loss_pred:0.015820862725377083, decouple_loss:0.0011060904944315553
The modified gen p mean: 0.4503884017467499, gen p mean: -0.047376688569784164, mean p set: 0.45086869597435The modified gen p mean: 0.4508230984210968, gen p mean: -0.04687800630927086, mean p set: 0.4513033628463745
loss_pred:0.016415558755397797, decouple_loss:0.0010802160250023007
loss_pred:0.015927044674754143, decouple_loss:0.0010566666023805737
Iteration: 4795, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4534832239151001, gen p mean: -0.0464458242058754, mean p set: 0.4539635181427002
loss_pred:0.015667295083403587, decouple_loss:0.0011733253486454487
The modified gen p mean: 0.45146384835243225, gen p mean: -0.04636169224977493, mean p set: 0.45194417238235474The modified gen p mean: 0.45125308632850647, gen p mean: -0.04552437365055084, mean p set: 0.45173338055610657
loss_pred:0.01615889184176922, decouple_loss:0.0012634118320420384
loss_pred:0.016002537682652473, decouple_loss:0.0011065115686506033
Iteration: 4796, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44939470291137695, gen p mean: -0.04965787008404732, mean p set: 0.44987502694129944
loss_pred:0.016090890392661095, decouple_loss:0.0011096837697550654
The modified gen p mean: 0.4497041702270508, gen p mean: -0.04587488994002342, mean p set: 0.4501844644546509The modified gen p mean: 0.45081081986427307, gen p mean: -0.04548269882798195, mean p set: 0.45129111409187317
loss_pred:0.016598070040345192, decouple_loss:0.0011008293367922306
loss_pred:0.016351288184523582, decouple_loss:0.0011658371658995748
Iteration: 4797, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448466032743454, gen p mean: -0.0476284921169281, mean p set: 0.4489463269710541
loss_pred:0.0161611195653677, decouple_loss:0.0010892846621572971
The modified gen p mean: 0.4513185918331146, gen p mean: -0.04560088366270065, mean p set: 0.4517989158630371The modified gen p mean: 0.4517892897129059, gen p mean: -0.04588963836431503, mean p set: 0.452269583940506
loss_pred:0.0161773469299078, decouple_loss:0.0011551270727068186
loss_pred:0.01576521247625351, decouple_loss:0.0011685601202771068
Iteration: 4798, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45131629705429077, gen p mean: -0.041037820279598236, mean p set: 0.45179659128189087
loss_pred:0.016113242134451866, decouple_loss:0.0012427072506397963
The modified gen p mean: 0.4515712857246399, gen p mean: -0.03897653520107269, mean p set: 0.4520516097545624The modified gen p mean: 0.451825886964798, gen p mean: -0.04698650911450386, mean p set: 0.45230618119239807
loss_pred:0.01672268472611904, decouple_loss:0.0011046752333641052
loss_pred:0.015409453772008419, decouple_loss:0.0012650605058297515
Iteration: 4799, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44948071241378784, gen p mean: -0.04137127846479416, mean p set: 0.44996097683906555
loss_pred:0.015929270535707474, decouple_loss:0.001102303504012525
The modified gen p mean: 0.45516249537467957, gen p mean: -0.04267018288373947, mean p set: 0.45564278960227966The modified gen p mean: 0.44988036155700684, gen p mean: -0.040268998593091965, mean p set: 0.4503606855869293
loss_pred:0.015440386720001698, decouple_loss:0.0012097469298169017
loss_pred:0.01679063029587269, decouple_loss:0.001123960129916668
Iteration: 4800, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45101696252822876, gen p mean: -0.03753374516963959, mean p set: 0.45149728655815125
loss_pred:0.0168924480676651, decouple_loss:0.0010777455754578114
The modified gen p mean: 0.45196688175201416, gen p mean: -0.0440533384680748, mean p set: 0.45244714617729187The modified gen p mean: 0.4530189633369446, gen p mean: -0.036969445645809174, mean p set: 0.4534992575645447
loss_pred:0.01578790508210659, decouple_loss:0.0011996951652690768
loss_pred:0.016344528645277023, decouple_loss:0.0011174073442816734
2023-05-02 20:43:35 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.046269968152046204, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04261109605431557, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.04281405732035637, mean p set: 0.4500633478164673
loss_pred:0.018448304384946823, decouple_loss:0.0012210177956148982
loss_pred:0.01743590086698532, decouple_loss:0.0012886691838502884
loss_pred:0.017416412010788918, decouple_loss:0.0012563462369143963
WV_0_PC_1_EH_0_PS_40, loss: 0.017829639837145805, avg_mse: 0.025741934776306152
current test mse: 0.025742
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012008_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012008_3_24hr.npz
NaN value num: 0
Iteration: 4801, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502198398113251, gen p mean: -0.04026992991566658, mean p set: 0.45070016384124756
loss_pred:0.015362661331892014, decouple_loss:0.0011513977078720927
The modified gen p mean: 0.44890129566192627, gen p mean: -0.04027779400348663, mean p set: 0.44938161969184875The modified gen p mean: 0.44768422842025757, gen p mean: -0.044298358261585236, mean p set: 0.44816452264785767
loss_pred:0.015184488147497177, decouple_loss:0.0011751468991860747loss_pred:0.015982938930392265, decouple_loss:0.0011061414843425155
Iteration: 4802, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44863200187683105, gen p mean: -0.03654240444302559, mean p set: 0.44911229610443115
The modified gen p mean: 0.4493008852005005, gen p mean: -0.03974175453186035, mean p set: 0.4497811496257782
loss_pred:0.015384561382234097, decouple_loss:0.0011390319559723139
loss_pred:0.016305219382047653, decouple_loss:0.0010479431366547942
The modified gen p mean: 0.4480888843536377, gen p mean: -0.042693041265010834, mean p set: 0.4485691785812378
loss_pred:0.015109087340533733, decouple_loss:0.001090262783691287
Iteration: 4803, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45010000467300415, gen p mean: -0.03733055293560028, mean p set: 0.45058029890060425
loss_pred:0.016307778656482697, decouple_loss:0.001161125022917986
The modified gen p mean: 0.4485498070716858, gen p mean: -0.03791416808962822, mean p set: 0.4490301311016083The modified gen p mean: 0.4495903253555298, gen p mean: -0.04851674288511276, mean p set: 0.4500705897808075
loss_pred:0.015249964781105518, decouple_loss:0.001104838796891272
loss_pred:0.014884754084050655, decouple_loss:0.0012482720194384456
Iteration: 4804, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44868695735931396, gen p mean: -0.04603604972362518, mean p set: 0.44916728138923645
loss_pred:0.014735342934727669, decouple_loss:0.0009765682043507695
The modified gen p mean: 0.44886040687561035, gen p mean: -0.043546661734580994, mean p set: 0.4493407607078552The modified gen p mean: 0.44773149490356445, gen p mean: -0.04141530394554138, mean p set: 0.44821181893348694
loss_pred:0.01584235206246376, decouple_loss:0.0010133427567780018
loss_pred:0.014920076355338097, decouple_loss:0.000981388846412301
Iteration: 4805, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496370851993561, gen p mean: -0.041407786309719086, mean p set: 0.4501173794269562
loss_pred:0.01602626033127308, decouple_loss:0.0010415742872282863
The modified gen p mean: 0.44797059893608093, gen p mean: -0.04645312577486038, mean p set: 0.44845086336135864The modified gen p mean: 0.45034605264663696, gen p mean: -0.044546157121658325, mean p set: 0.45082634687423706
loss_pred:0.015668854117393494, decouple_loss:0.0009574597934260964
loss_pred:0.015186512842774391, decouple_loss:0.000985609833151102
Iteration: 4806, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44783833622932434, gen p mean: -0.04834743216633797, mean p set: 0.44831863045692444
loss_pred:0.015875432640314102, decouple_loss:0.0009952496038749814
The modified gen p mean: 0.4507077634334564, gen p mean: -0.04129331558942795, mean p set: 0.4511880874633789The modified gen p mean: 0.44924744963645935, gen p mean: -0.04132164269685745, mean p set: 0.44972777366638184
loss_pred:0.015975352376699448, decouple_loss:0.0009478788706474006
loss_pred:0.015160201117396355, decouple_loss:0.0009746910072863102
Iteration: 4807, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45019569993019104, gen p mean: -0.048073697835206985, mean p set: 0.45067599415779114
loss_pred:0.015003806911408901, decouple_loss:0.0009309838060289621
The modified gen p mean: 0.4510635435581207, gen p mean: -0.04749501496553421, mean p set: 0.4515438675880432The modified gen p mean: 0.44914504885673523, gen p mean: -0.04225593060255051, mean p set: 0.4496253430843353
loss_pred:0.016144737601280212, decouple_loss:0.001006507663987577
loss_pred:0.015126313082873821, decouple_loss:0.0009528464288450778
Iteration: 4808, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44915708899497986, gen p mean: -0.043046604841947556, mean p set: 0.44963738322257996
loss_pred:0.015288743190467358, decouple_loss:0.0010581950191408396
The modified gen p mean: 0.4504193961620331, gen p mean: -0.04246634617447853, mean p set: 0.45089972019195557The modified gen p mean: 0.44940653443336487, gen p mean: -0.045069389045238495, mean p set: 0.44988682866096497
loss_pred:0.015626957640051842, decouple_loss:0.001058019232004881
loss_pred:0.01500412542372942, decouple_loss:0.0011001466773450375
Iteration: 4809, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44935885071754456, gen p mean: -0.039877764880657196, mean p set: 0.44983911514282227
loss_pred:0.015381679870188236, decouple_loss:0.001046585151925683
The modified gen p mean: 0.4508301913738251, gen p mean: -0.04045220464468002, mean p set: 0.45131051540374756The modified gen p mean: 0.45033302903175354, gen p mean: -0.04465319588780403, mean p set: 0.450813353061676
loss_pred:0.01592465303838253, decouple_loss:0.0010155249619856477
loss_pred:0.014748048968613148, decouple_loss:0.0009776034858077765
Iteration: 4810, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44999992847442627, gen p mean: -0.043560177087783813, mean p set: 0.450480192899704
loss_pred:0.015565363690257072, decouple_loss:0.001042994437739253
The modified gen p mean: 0.4482998847961426, gen p mean: -0.04103250801563263, mean p set: 0.4487801790237427The modified gen p mean: 0.4498796761035919, gen p mean: -0.036902304738759995, mean p set: 0.450359970331192
loss_pred:0.014580975286662579, decouple_loss:0.0010489389533177018
loss_pred:0.014829626306891441, decouple_loss:0.0010985019616782665
2023-05-02 20:46:09 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.048139773309230804, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04427272453904152, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.044511642307043076, mean p set: 0.4500633478164673
loss_pred:0.018599743023514748, decouple_loss:0.0011176011757925153
loss_pred:0.01749850995838642, decouple_loss:0.0010494358139112592
loss_pred:0.017544977366924286, decouple_loss:0.0011260940227657557
WV_0_PC_1_EH_0_PS_40, loss: 0.017935961484909058, avg_mse: 0.025957368314266205
current test mse: 0.025957
Iteration: 4811, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488687515258789, gen p mean: -0.04608868062496185, mean p set: 0.449349045753479
The modified gen p mean: 0.4496261477470398, gen p mean: -0.04935062676668167, mean p set: 0.4501064419746399
The modified gen p mean: 0.44904953241348267, gen p mean: -0.04173513874411583, mean p set: 0.44952985644340515
loss_pred:0.015269190073013306, decouple_loss:0.0009383514407090843
loss_pred:0.015650900080800056, decouple_loss:0.0010845322394743562
loss_pred:0.015189026482403278, decouple_loss:0.0011395963374525309
Iteration: 4812, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490783214569092, gen p mean: -0.04177593067288399, mean p set: 0.4495586156845093
loss_pred:0.016085293143987656, decouple_loss:0.0010352960089221597
The modified gen p mean: 0.4491945803165436, gen p mean: -0.05239317566156387, mean p set: 0.44967490434646606The modified gen p mean: 0.4499788284301758, gen p mean: -0.05410758778452873, mean p set: 0.4504591226577759
loss_pred:0.014848005026578903, decouple_loss:0.0011114388471469283
loss_pred:0.015220900066196918, decouple_loss:0.0011548687471076846
Iteration: 4813, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44900333881378174, gen p mean: -0.043131351470947266, mean p set: 0.44948363304138184
loss_pred:0.015394811518490314, decouple_loss:0.0011669910745695233
The modified gen p mean: 0.4479730725288391, gen p mean: -0.04693251848220825, mean p set: 0.4484533667564392The modified gen p mean: 0.44993531703948975, gen p mean: -0.04228326305747032, mean p set: 0.45041564106941223
loss_pred:0.015335118398070335, decouple_loss:0.0010767470812425017
loss_pred:0.015660133212804794, decouple_loss:0.0011008295696228743
Iteration: 4814, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485494792461395, gen p mean: -0.048401251435279846, mean p set: 0.44902974367141724
loss_pred:0.015394093468785286, decouple_loss:0.0011374446330592036
The modified gen p mean: 0.4500763416290283, gen p mean: -0.04745267331600189, mean p set: 0.4505566358566284The modified gen p mean: 0.4500833749771118, gen p mean: -0.04711834713816643, mean p set: 0.4505636692047119
loss_pred:0.015034492127597332, decouple_loss:0.0009138345485553145
loss_pred:0.015070250257849693, decouple_loss:0.0009320944081991911
Iteration: 4815, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44962725043296814, gen p mean: -0.04960693418979645, mean p set: 0.45010754466056824
loss_pred:0.015390919521450996, decouple_loss:0.0011029139859601855
The modified gen p mean: 0.45030972361564636, gen p mean: -0.04931981861591339, mean p set: 0.45079004764556885The modified gen p mean: 0.4493899643421173, gen p mean: -0.04766587167978287, mean p set: 0.4498702585697174
loss_pred:0.015163751319050789, decouple_loss:0.0010243634460493922
loss_pred:0.015435789711773396, decouple_loss:0.0010465679224580526
Iteration: 4816, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44960448145866394, gen p mean: -0.047807976603507996, mean p set: 0.4500848054885864
loss_pred:0.01632596366107464, decouple_loss:0.0009784557623788714
The modified gen p mean: 0.44802236557006836, gen p mean: -0.047958530485630035, mean p set: 0.44850265979766846The modified gen p mean: 0.4482400119304657, gen p mean: -0.05063799023628235, mean p set: 0.4487202763557434
loss_pred:0.01459132693707943, decouple_loss:0.0010154227493330836
loss_pred:0.014976930804550648, decouple_loss:0.0010275394888594747
Iteration: 4817, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476298689842224, gen p mean: -0.04882665351033211, mean p set: 0.4481101632118225
loss_pred:0.014659942127764225, decouple_loss:0.0009252604795619845
The modified gen p mean: 0.4502919018268585, gen p mean: -0.05901466682553291, mean p set: 0.4507721960544586The modified gen p mean: 0.4499967396259308, gen p mean: -0.05042501538991928, mean p set: 0.4504770338535309
loss_pred:0.014812014065682888, decouple_loss:0.001061985152773559
loss_pred:0.015056828036904335, decouple_loss:0.0009835029486566782
Iteration: 4818, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483415484428406, gen p mean: -0.04909846931695938, mean p set: 0.4488218426704407
loss_pred:0.015861142426729202, decouple_loss:0.0010217406088486314
The modified gen p mean: 0.4492671489715576, gen p mean: -0.04284975305199623, mean p set: 0.4497474730014801The modified gen p mean: 0.4496113359928131, gen p mean: -0.04625120013952255, mean p set: 0.4500916600227356
loss_pred:0.015579331666231155, decouple_loss:0.0009582380298525095
loss_pred:0.015214374288916588, decouple_loss:0.001001020078547299
Iteration: 4819, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490787386894226, gen p mean: -0.04608611389994621, mean p set: 0.4495590031147003
loss_pred:0.015242163091897964, decouple_loss:0.0010858627501875162
The modified gen p mean: 0.4490615725517273, gen p mean: -0.04583026468753815, mean p set: 0.4495418667793274The modified gen p mean: 0.4495692253112793, gen p mean: -0.04544265568256378, mean p set: 0.4500495493412018
loss_pred:0.015343005768954754, decouple_loss:0.001075816573575139
loss_pred:0.0156797394156456, decouple_loss:0.0010079463245347142
Iteration: 4820, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449398398399353, gen p mean: -0.040115293115377426, mean p set: 0.4498787224292755
loss_pred:0.014783335849642754, decouple_loss:0.0009753202903084457
The modified gen p mean: 0.44967159628868103, gen p mean: -0.04602494835853577, mean p set: 0.45015186071395874The modified gen p mean: 0.4498811662197113, gen p mean: -0.04545824974775314, mean p set: 0.4503614604473114
loss_pred:0.01591830886900425, decouple_loss:0.0009403846925124526
loss_pred:0.014767669141292572, decouple_loss:0.0010839251335710287
2023-05-02 20:48:04 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.04728749394416809, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04345580190420151, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.043599147349596024, mean p set: 0.4500633478164673
loss_pred:0.018600743263959885, decouple_loss:0.0010812176624312997
loss_pred:0.017449799925088882, decouple_loss:0.0010671137133613229
loss_pred:0.01750662736594677, decouple_loss:0.001062071998603642
WV_0_PC_1_EH_0_PS_40, loss: 0.01790589652955532, avg_mse: 0.02589670941233635
current test mse: 0.025897
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012019_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012019_3_24hr.npz
NaN value num: 0
Iteration: 4821, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45006638765335083, gen p mean: -0.043271757662296295, mean p set: 0.4505466818809509
loss_pred:0.016861552372574806, decouple_loss:0.0009887685300782323
The modified gen p mean: 0.45078355073928833, gen p mean: -0.04230768233537674, mean p set: 0.4512638449668884The modified gen p mean: 0.45121505856513977, gen p mean: -0.0376540832221508, mean p set: 0.4516952931880951
loss_pred:0.016420423984527588, decouple_loss:0.001026372890919447loss_pred:0.015953360125422478, decouple_loss:0.0010613685008138418
Iteration: 4822, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45255059003829956, gen p mean: -0.04047393053770065, mean p set: 0.45303085446357727
loss_pred:0.016563232988119125, decouple_loss:0.0009262331877835095
The modified gen p mean: 0.4507615566253662, gen p mean: -0.03656035661697388, mean p set: 0.4512418508529663The modified gen p mean: 0.45096397399902344, gen p mean: -0.037981074303388596, mean p set: 0.4514442980289459
loss_pred:0.016626229509711266, decouple_loss:0.0010632872581481934
loss_pred:0.01654559001326561, decouple_loss:0.0009700566879473627
Iteration: 4823, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45153141021728516, gen p mean: -0.041519664227962494, mean p set: 0.45201170444488525
loss_pred:0.015941444784402847, decouple_loss:0.0009556399891152978
The modified gen p mean: 0.451535165309906, gen p mean: -0.044093500822782516, mean p set: 0.4520154595375061The modified gen p mean: 0.4509578347206116, gen p mean: -0.044288258999586105, mean p set: 0.45143812894821167
loss_pred:0.016870886087417603, decouple_loss:0.0009769703028723598
loss_pred:0.016952360048890114, decouple_loss:0.0010406955843791366
Iteration: 4824, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45233818888664246, gen p mean: -0.04626859351992607, mean p set: 0.45281848311424255
loss_pred:0.015858793631196022, decouple_loss:0.0008666254580020905
The modified gen p mean: 0.4508208632469177, gen p mean: -0.04383827745914459, mean p set: 0.45130112767219543The modified gen p mean: 0.44986769556999207, gen p mean: -0.05361203849315643, mean p set: 0.45034801959991455
loss_pred:0.016563694924116135, decouple_loss:0.000927657587453723
loss_pred:0.01672855205833912, decouple_loss:0.0010857380693778396
Iteration: 4825, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45130670070648193, gen p mean: -0.04960407316684723, mean p set: 0.45178699493408203
loss_pred:0.016864048317074776, decouple_loss:0.00098509865347296
The modified gen p mean: 0.4514906108379364, gen p mean: -0.048298534005880356, mean p set: 0.4519709050655365The modified gen p mean: 0.45012742280960083, gen p mean: -0.053220219910144806, mean p set: 0.45060768723487854
loss_pred:0.016468876972794533, decouple_loss:0.001011960208415985
loss_pred:0.01685284450650215, decouple_loss:0.0010167047148570418
Iteration: 4826, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497205913066864, gen p mean: -0.05340681970119476, mean p set: 0.4502009153366089
loss_pred:0.016613459214568138, decouple_loss:0.0009873370872810483
The modified gen p mean: 0.45004430413246155, gen p mean: -0.051902737468481064, mean p set: 0.45052459836006165
The modified gen p mean: 0.4517497420310974, gen p mean: -0.048019830137491226, mean p set: 0.4522300362586975
loss_pred:0.016471704468131065, decouple_loss:0.000996604561805725
loss_pred:0.017194228246808052, decouple_loss:0.0010713589144870639
Iteration: 4827, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45183250308036804, gen p mean: -0.04938194528222084, mean p set: 0.45231279730796814
loss_pred:0.017200248315930367, decouple_loss:0.0010309484787285328
The modified gen p mean: 0.4497329890727997, gen p mean: -0.05152904987335205, mean p set: 0.4502132534980774The modified gen p mean: 0.4518773853778839, gen p mean: -0.043829623609781265, mean p set: 0.452357679605484
loss_pred:0.01679340749979019, decouple_loss:0.0009795586811378598
loss_pred:0.015972496941685677, decouple_loss:0.0009998679161071777
Iteration: 4828, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45038220286369324, gen p mean: -0.04791736602783203, mean p set: 0.45086249709129333
loss_pred:0.01625649817287922, decouple_loss:0.0010586654534563422
The modified gen p mean: 0.45210567116737366, gen p mean: -0.05062638223171234, mean p set: 0.45258599519729614The modified gen p mean: 0.45269033312797546, gen p mean: -0.04686552286148071, mean p set: 0.45317062735557556
loss_pred:0.016873108223080635, decouple_loss:0.0010523587698116899
loss_pred:0.01675465889275074, decouple_loss:0.0010567173594608903
Iteration: 4829, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44943222403526306, gen p mean: -0.045740772038698196, mean p set: 0.44991254806518555
loss_pred:0.01639474742114544, decouple_loss:0.001118177198804915
The modified gen p mean: 0.45085176825523376, gen p mean: -0.04210668057203293, mean p set: 0.45133206248283386The modified gen p mean: 0.45026731491088867, gen p mean: -0.04741789773106575, mean p set: 0.45074760913848877
loss_pred:0.01668761856853962, decouple_loss:0.0011072087800130248
loss_pred:0.016733704134821892, decouple_loss:0.0010515807662159204
Iteration: 4830, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508074223995209, gen p mean: -0.04605141282081604, mean p set: 0.4512876868247986
loss_pred:0.017171425744891167, decouple_loss:0.0010837464360520244
The modified gen p mean: 0.44982582330703735, gen p mean: -0.044820427894592285, mean p set: 0.45030614733695984The modified gen p mean: 0.45010125637054443, gen p mean: -0.04071524739265442, mean p set: 0.45058155059814453
loss_pred:0.016645917668938637, decouple_loss:0.0010512098670005798
loss_pred:0.016925739124417305, decouple_loss:0.0010746086481958628
2023-05-02 20:50:36 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.04907715320587158, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.0452573336660862, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04559636488556862, mean p set: 0.4500633478164673
loss_pred:0.018544994294643402, decouple_loss:0.0011197139974683523
loss_pred:0.017366508021950722, decouple_loss:0.0011242248583585024
loss_pred:0.017504172399640083, decouple_loss:0.0010911058634519577
WV_0_PC_1_EH_0_PS_40, loss: 0.017860809341073036, avg_mse: 0.025820134207606316
current test mse: 0.02582
Iteration: 4831, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4519239366054535, gen p mean: -0.038464102894067764, mean p set: 0.4524042010307312
The modified gen p mean: 0.45141705870628357, gen p mean: -0.03907334432005882, mean p set: 0.45189735293388367
The modified gen p mean: 0.4508119225502014, gen p mean: -0.04387865588068962, mean p set: 0.4512922167778015
loss_pred:0.017204539850354195, decouple_loss:0.0009911906672641635
loss_pred:0.01554956380277872, decouple_loss:0.00106619403231889
loss_pred:0.01735011301934719, decouple_loss:0.0010649508330971003
Iteration: 4832, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4512347877025604, gen p mean: -0.03943553566932678, mean p set: 0.4517151117324829
loss_pred:0.016319504007697105, decouple_loss:0.0010581548558548093
The modified gen p mean: 0.4520964026451111, gen p mean: -0.04031243920326233, mean p set: 0.45257672667503357The modified gen p mean: 0.4512808918952942, gen p mean: -0.03994058072566986, mean p set: 0.4517611861228943
loss_pred:0.016577517613768578, decouple_loss:0.001085601281374693
loss_pred:0.015868209302425385, decouple_loss:0.001005066791549325
Iteration: 4833, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45010024309158325, gen p mean: -0.05047595500946045, mean p set: 0.45058050751686096
loss_pred:0.0168574508279562, decouple_loss:0.0010882572969421744
The modified gen p mean: 0.4518752694129944, gen p mean: -0.04266395419836044, mean p set: 0.4523555636405945The modified gen p mean: 0.45096656680107117, gen p mean: -0.04636883735656738, mean p set: 0.45144689083099365
loss_pred:0.015827806666493416, decouple_loss:0.001052441424690187
loss_pred:0.01688954420387745, decouple_loss:0.0011645560152828693
Iteration: 4834, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45115041732788086, gen p mean: -0.04365510120987892, mean p set: 0.45163068175315857
loss_pred:0.016268428415060043, decouple_loss:0.0009332674671895802
The modified gen p mean: 0.45083531737327576, gen p mean: -0.04215151071548462, mean p set: 0.45131561160087585The modified gen p mean: 0.44983214139938354, gen p mean: -0.04838724806904793, mean p set: 0.45031243562698364
loss_pred:0.01620042696595192, decouple_loss:0.0009927210630849004
loss_pred:0.016443664208054543, decouple_loss:0.0010471540736034513
Iteration: 4835, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496927559375763, gen p mean: -0.0488029383122921, mean p set: 0.450173020362854
loss_pred:0.016439037397503853, decouple_loss:0.001011569518595934
The modified gen p mean: 0.4508418142795563, gen p mean: -0.04559008404612541, mean p set: 0.45132210850715637The modified gen p mean: 0.4517273008823395, gen p mean: -0.04403497278690338, mean p set: 0.4522075653076172
loss_pred:0.016042033210396767, decouple_loss:0.0009594245348125696
loss_pred:0.017097534611821175, decouple_loss:0.000981013523414731
Iteration: 4836, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45084068179130554, gen p mean: -0.04326700419187546, mean p set: 0.451321005821228
loss_pred:0.016332248225808144, decouple_loss:0.0010313933016732335
The modified gen p mean: 0.449715793132782, gen p mean: -0.05267122760415077, mean p set: 0.4501960873603821The modified gen p mean: 0.4503616392612457, gen p mean: -0.054737575352191925, mean p set: 0.4508419334888458
loss_pred:0.016486814245581627, decouple_loss:0.000987551175057888
loss_pred:0.016460753977298737, decouple_loss:0.0009955726563930511
Iteration: 4837, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4519759714603424, gen p mean: -0.04687923938035965, mean p set: 0.4524562954902649
loss_pred:0.015963628888130188, decouple_loss:0.0010487574618309736
The modified gen p mean: 0.4494195580482483, gen p mean: -0.05296100303530693, mean p set: 0.449899822473526The modified gen p mean: 0.4503265619277954, gen p mean: -0.052151963114738464, mean p set: 0.4508068561553955
loss_pred:0.01610439084470272, decouple_loss:0.000997971510514617
loss_pred:0.016763657331466675, decouple_loss:0.0009916801936924458
Iteration: 4838, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507334530353546, gen p mean: -0.05505362153053284, mean p set: 0.4512137174606323
loss_pred:0.01707521080970764, decouple_loss:0.0009709716541692615
The modified gen p mean: 0.449611634016037, gen p mean: -0.05414772406220436, mean p set: 0.4500918984413147The modified gen p mean: 0.44965270161628723, gen p mean: -0.04889582470059395, mean p set: 0.45013299584388733
loss_pred:0.016607770696282387, decouple_loss:0.0009487192728556693
loss_pred:0.016484977677464485, decouple_loss:0.000902479630894959
Iteration: 4839, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505957067012787, gen p mean: -0.057048045098781586, mean p set: 0.4510760009288788
loss_pred:0.01602495089173317, decouple_loss:0.0009113211999647319
The modified gen p mean: 0.4523179829120636, gen p mean: -0.05162419378757477, mean p set: 0.4527982771396637The modified gen p mean: 0.4493287205696106, gen p mean: -0.052190326154232025, mean p set: 0.4498090147972107
loss_pred:0.01684708148241043, decouple_loss:0.0009093653061427176
loss_pred:0.017087731510400772, decouple_loss:0.0009568880195729434
Iteration: 4840, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44944486021995544, gen p mean: -0.046525079756975174, mean p set: 0.44992515444755554
loss_pred:0.016556762158870697, decouple_loss:0.0010434032883495092
The modified gen p mean: 0.4514372944831848, gen p mean: -0.045805513858795166, mean p set: 0.4519175887107849The modified gen p mean: 0.45063990354537964, gen p mean: -0.05236823856830597, mean p set: 0.4511202275753021
loss_pred:0.016032390296459198, decouple_loss:0.00103094766382128
loss_pred:0.016078688204288483, decouple_loss:0.0010731321526691318
2023-05-02 20:52:30 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.055301375687122345, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830535888672, gen p mean: -0.05148820951581001, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.05126801133155823, mean p set: 0.45035696029663086
loss_pred:0.018570590764284134, decouple_loss:0.0011093493085354567
loss_pred:0.017541006207466125, decouple_loss:0.0010055958991870284
loss_pred:0.017452523112297058, decouple_loss:0.0010385834611952305
WV_0_PC_1_EH_0_PS_40, loss: 0.017907265573740005, avg_mse: 0.025928819552063942
current test mse: 0.025929
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012003_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012003_3_24hr.npz
NaN value num: 0
Iteration: 4841, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481697380542755, gen p mean: -0.04910534247756004, mean p set: 0.448650062084198
loss_pred:0.014167891815304756, decouple_loss:0.0010072303703054786
The modified gen p mean: 0.4477507472038269, gen p mean: -0.0491405725479126, mean p set: 0.448231041431427The modified gen p mean: 0.447750449180603, gen p mean: -0.0475555919110775, mean p set: 0.44823071360588074
loss_pred:0.013969728723168373, decouple_loss:0.0010683962609618902
loss_pred:0.014000674709677696, decouple_loss:0.0010371009120717645
Iteration: 4842, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497413635253906, gen p mean: -0.050216879695653915, mean p set: 0.4502216577529907
loss_pred:0.014129111543297768, decouple_loss:0.0010310637298971415
The modified gen p mean: 0.44841331243515015, gen p mean: -0.05442368984222412, mean p set: 0.44889357686042786The modified gen p mean: 0.4476039409637451, gen p mean: -0.05260656401515007, mean p set: 0.4480842351913452
loss_pred:0.013351456262171268, decouple_loss:0.0010194591013714671
loss_pred:0.013196268118917942, decouple_loss:0.0010063814697787166
Iteration: 4843, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449165403842926, gen p mean: -0.05114264041185379, mean p set: 0.4496456980705261
loss_pred:0.013614791445434093, decouple_loss:0.0010365014895796776
The modified gen p mean: 0.4489864110946655, gen p mean: -0.04771099612116814, mean p set: 0.4494667053222656The modified gen p mean: 0.4488052427768707, gen p mean: -0.05477750301361084, mean p set: 0.4492855668067932
loss_pred:0.013417796231806278, decouple_loss:0.001042768475599587
loss_pred:0.013310789130628109, decouple_loss:0.0010190432658419013
Iteration: 4844, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484531879425049, gen p mean: -0.05719954892992973, mean p set: 0.4489334523677826
loss_pred:0.013425779528915882, decouple_loss:0.001025467412546277
The modified gen p mean: 0.44893309473991394, gen p mean: -0.05439489334821701, mean p set: 0.4494134187698364The modified gen p mean: 0.44846776127815247, gen p mean: -0.045442335307598114, mean p set: 0.44894805550575256
loss_pred:0.012870652601122856, decouple_loss:0.0009920068550854921
loss_pred:0.013762161135673523, decouple_loss:0.0010200130054727197
Iteration: 4845, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44844579696655273, gen p mean: -0.051275793462991714, mean p set: 0.44892609119415283
loss_pred:0.013187551870942116, decouple_loss:0.0011295872973278165
The modified gen p mean: 0.44823935627937317, gen p mean: -0.055203162133693695, mean p set: 0.44871968030929565The modified gen p mean: 0.4488731920719147, gen p mean: -0.053907155990600586, mean p set: 0.44935348629951477
loss_pred:0.01324333157390356, decouple_loss:0.0010337351122871041
loss_pred:0.013719012960791588, decouple_loss:0.0010964003158733249
Iteration: 4846, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44853872060775757, gen p mean: -0.05186260864138603, mean p set: 0.44901901483535767
loss_pred:0.013750310055911541, decouple_loss:0.0010407371446490288
The modified gen p mean: 0.4505738615989685, gen p mean: -0.056619398295879364, mean p set: 0.4510541558265686The modified gen p mean: 0.4477349817752838, gen p mean: -0.05208703130483627, mean p set: 0.4482152760028839
loss_pred:0.013679326511919498, decouple_loss:0.001034919754602015
loss_pred:0.013556912541389465, decouple_loss:0.001091393525712192
Iteration: 4847, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481416344642639, gen p mean: -0.053788889199495316, mean p set: 0.448621928691864
The modified gen p mean: 0.4493597447872162, gen p mean: -0.0543651357293129, mean p set: 0.44984006881713867
loss_pred:0.013926194049417973, decouple_loss:0.0010887840762734413
loss_pred:0.013992070220410824, decouple_loss:0.0010556908091530204
The modified gen p mean: 0.44824087619781494, gen p mean: -0.058101072907447815, mean p set: 0.44872117042541504
loss_pred:0.0137488367035985, decouple_loss:0.0010476252064108849
Iteration: 4848, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481634199619293, gen p mean: -0.059724111109972, mean p set: 0.4486437141895294
loss_pred:0.01337763573974371, decouple_loss:0.001127906027249992
The modified gen p mean: 0.44861480593681335, gen p mean: -0.05357200279831886, mean p set: 0.44909510016441345The modified gen p mean: 0.4482167959213257, gen p mean: -0.05984542891383171, mean p set: 0.4486970603466034
loss_pred:0.013371645472943783, decouple_loss:0.0011492852354422212
loss_pred:0.013717715628445148, decouple_loss:0.0010545450495555997
Iteration: 4849, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44815999269485474, gen p mean: -0.04994503781199455, mean p set: 0.44864022731781006
The modified gen p mean: 0.4474274516105652, gen p mean: -0.05115640163421631, mean p set: 0.4479077458381653
loss_pred:0.013828299939632416, decouple_loss:0.0011013312032446265
loss_pred:0.013263107277452946, decouple_loss:0.0010628581512719393
The modified gen p mean: 0.44884786009788513, gen p mean: -0.060823965817689896, mean p set: 0.44932815432548523
loss_pred:0.012877147644758224, decouple_loss:0.0010145779233425856
Iteration: 4850, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44889312982559204, gen p mean: -0.060710083693265915, mean p set: 0.44937342405319214
The modified gen p mean: 0.4490232765674591, gen p mean: -0.05323334410786629, mean p set: 0.4495035707950592
loss_pred:0.012733614072203636, decouple_loss:0.0010224675061181188
loss_pred:0.013197820633649826, decouple_loss:0.000984576647169888
The modified gen p mean: 0.44682058691978455, gen p mean: -0.05370759963989258, mean p set: 0.44730088114738464
loss_pred:0.013112331740558147, decouple_loss:0.0010873650899156928
2023-05-02 20:55:22 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.05643504485487938, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.05275804176926613, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.052600666880607605, mean p set: 0.4500633478164673
loss_pred:0.019181981682777405, decouple_loss:0.001097461674362421
loss_pred:0.017919186502695084, decouple_loss:0.0010434688301756978
loss_pred:0.01808321475982666, decouple_loss:0.001111837918870151
WV_0_PC_1_EH_0_PS_40, loss: 0.018449008464813232, avg_mse: 0.026979342103004456
current test mse: 0.026979
Iteration: 4851, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44679588079452515, gen p mean: -0.049427859485149384, mean p set: 0.44727620482444763
The modified gen p mean: 0.447664350271225, gen p mean: -0.0537412203848362, mean p set: 0.4481446146965027
The modified gen p mean: 0.44821345806121826, gen p mean: -0.05278398469090462, mean p set: 0.44869375228881836
loss_pred:0.01312086172401905, decouple_loss:0.0010862426133826375
loss_pred:0.013669346459209919, decouple_loss:0.0010464966762810946
loss_pred:0.013872870244085789, decouple_loss:0.001145281596109271
Iteration: 4852, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483393728733063, gen p mean: -0.05085611343383789, mean p set: 0.44881969690322876
loss_pred:0.013617102988064289, decouple_loss:0.0009933325927704573
The modified gen p mean: 0.4472561478614807, gen p mean: -0.05280308425426483, mean p set: 0.4477364122867584The modified gen p mean: 0.4480161666870117, gen p mean: -0.05487131327390671, mean p set: 0.4484964609146118
loss_pred:0.013580162078142166, decouple_loss:0.0010000442853197455
loss_pred:0.01272695604711771, decouple_loss:0.0009719857480376959
Iteration: 4853, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493885636329651, gen p mean: -0.05602717772126198, mean p set: 0.4498688280582428
loss_pred:0.013134769164025784, decouple_loss:0.001124841975979507
The modified gen p mean: 0.4480254054069519, gen p mean: -0.05348072573542595, mean p set: 0.448505699634552The modified gen p mean: 0.4470297396183014, gen p mean: -0.0524747297167778, mean p set: 0.4475100636482239
loss_pred:0.013181367889046669, decouple_loss:0.0010366019560024142
loss_pred:0.012919639237225056, decouple_loss:0.0010089504066854715
Iteration: 4854, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44843608140945435, gen p mean: -0.054151274263858795, mean p set: 0.44891637563705444
loss_pred:0.012996763922274113, decouple_loss:0.0010003721108660102
The modified gen p mean: 0.4469038248062134, gen p mean: -0.04906909540295601, mean p set: 0.44738414883613586The modified gen p mean: 0.4481566250324249, gen p mean: -0.0517975389957428, mean p set: 0.44863688945770264
loss_pred:0.013463357463479042, decouple_loss:0.0009734377963468432
loss_pred:0.012770279310643673, decouple_loss:0.0010246469173580408
Iteration: 4855, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44854143261909485, gen p mean: -0.0493587888777256, mean p set: 0.44902175664901733
loss_pred:0.013662545941770077, decouple_loss:0.0011084057623520494
The modified gen p mean: 0.4474150538444519, gen p mean: -0.052624888718128204, mean p set: 0.4478953182697296The modified gen p mean: 0.4478701651096344, gen p mean: -0.054137278348207474, mean p set: 0.4483504593372345
loss_pred:0.013081920333206654, decouple_loss:0.001121015870012343
loss_pred:0.013540704734623432, decouple_loss:0.00110794382635504
Iteration: 4856, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448375940322876, gen p mean: -0.05449945107102394, mean p set: 0.4488562345504761
The modified gen p mean: 0.44872400164604187, gen p mean: -0.05640490725636482, mean p set: 0.4492042660713196
loss_pred:0.013226214796304703, decouple_loss:0.0010675126686692238
loss_pred:0.012628247030079365, decouple_loss:0.00117687217425555
The modified gen p mean: 0.4489436149597168, gen p mean: -0.04703160747885704, mean p set: 0.4494239091873169
loss_pred:0.012797921895980835, decouple_loss:0.0011133658699691296
Iteration: 4857, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490513205528259, gen p mean: -0.05119601637125015, mean p set: 0.449531614780426
loss_pred:0.013394909910857677, decouple_loss:0.0010709509951993823
The modified gen p mean: 0.4480617344379425, gen p mean: -0.04672142118215561, mean p set: 0.4485420286655426The modified gen p mean: 0.4472508132457733, gen p mean: -0.04891638830304146, mean p set: 0.4477311074733734
loss_pred:0.013563957065343857, decouple_loss:0.0010233159409835935
loss_pred:0.01328729186207056, decouple_loss:0.001023591379635036
