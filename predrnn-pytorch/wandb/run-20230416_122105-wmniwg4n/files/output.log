After initialize model, args.img_channel:3
load model: /work/09012/haoli1/ls6/ERA5_PredRNN/checkpoints/WV_0_PC_1_EH_1_PS_40/model_2000.ckpt
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012000_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012001_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012002_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012003_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012004_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012005_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012006_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012007_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012008_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012009_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012010_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012011_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012012_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012013_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012014_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012015_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012016_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012017_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012018_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012019_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012020_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012000_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012001_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012002_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012003_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012004_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012005_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012006_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012007_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012008_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012009_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012010_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012011_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012012_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012013_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012014_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012015_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012016_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012017_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012018_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012019_3_24hr.npz
train_data_files nums: 41
mnist test iterator, Loading data from /scratch/09012/haoli1/ERA5/val_dataset/era5_train_09012020_3_24hr.npz
NaN value num: 0
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012018_3_24hr.npz
NaN value num: 0
Iteration: 1, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4478335976600647
loss_pred:0.021129922941327095, decouple_loss:0.009792095981538296
The generated pressure mean: 0.4474197030067444
loss_pred:0.0222172848880291, decouple_loss:0.009787053801119328
The generated pressure mean: 0.44842737913131714
loss_pred:0.020784838125109673, decouple_loss:0.010066278278827667
/work/09012/haoli1/ls6/Pyt/lib/python3.9/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '
Iteration: 2, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.448190301656723The generated pressure mean: 0.44822627305984497
The generated pressure mean: 0.44751855731010437
loss_pred:0.23083558678627014, decouple_loss:0.43629422783851624
loss_pred:0.22213289141654968, decouple_loss:0.434977263212204
loss_pred:0.2184699922800064, decouple_loss:0.4375949203968048
Iteration: 3, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4482947587966919
The generated pressure mean: 0.44835081696510315
loss_pred:0.15440937876701355, decouple_loss:0.5458149313926697
loss_pred:0.15646101534366608, decouple_loss:0.5443277955055237
The generated pressure mean: 0.44806885719299316
loss_pred:0.14971919357776642, decouple_loss:0.5416688323020935
Iteration: 4, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44811734557151794
The generated pressure mean: 0.44719934463500977
The generated pressure mean: 0.44771313667297363
loss_pred:0.07478164881467819, decouple_loss:0.401626318693161
loss_pred:0.08100761473178864, decouple_loss:0.40462687611579895
loss_pred:0.07945813983678818, decouple_loss:0.40033265948295593
Iteration: 5, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44799932837486267
The generated pressure mean: 0.4480653405189514
loss_pred:0.07082073390483856, decouple_loss:0.3141859173774719
loss_pred:0.06971187889575958, decouple_loss:0.3151259422302246
The generated pressure mean: 0.4478616416454315
loss_pred:0.07437371462583542, decouple_loss:0.3132668733596802
Iteration: 6, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4476363956928253
The generated pressure mean: 0.4478023052215576
The generated pressure mean: 0.44794991612434387loss_pred:0.06845834851264954, decouple_loss:0.24266284704208374
loss_pred:0.06863187253475189, decouple_loss:0.24102960526943207
loss_pred:0.06398461759090424, decouple_loss:0.24260950088500977
Iteration: 7, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.448560506105423
The generated pressure mean: 0.44798144698143005
loss_pred:0.057943277060985565, decouple_loss:0.1840086579322815
The generated pressure mean: 0.4480019807815552
loss_pred:0.05946754664182663, decouple_loss:0.1831330955028534
loss_pred:0.059222131967544556, decouple_loss:0.1817537546157837
Iteration: 8, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4476269483566284
loss_pred:0.05258249118924141, decouple_loss:0.1767236590385437
The generated pressure mean: 0.44806352257728577
The generated pressure mean: 0.44795525074005127
loss_pred:0.05588286742568016, decouple_loss:0.1760205626487732
loss_pred:0.05605922266840935, decouple_loss:0.17664769291877747
Iteration: 9, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4479179382324219
The generated pressure mean: 0.4475034475326538
loss_pred:0.045195192098617554, decouple_loss:0.1697767823934555
loss_pred:0.046377021819353104, decouple_loss:0.17146332561969757
The generated pressure mean: 0.44868525862693787
loss_pred:0.04285250976681709, decouple_loss:0.16946245729923248
Iteration: 10, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4481147527694702
loss_pred:0.04513449966907501, decouple_loss:0.14201237261295319
The generated pressure mean: 0.44771623611450195
loss_pred:0.04792754724621773, decouple_loss:0.14203323423862457
The generated pressure mean: 0.4487811326980591
loss_pred:0.04029248654842377, decouple_loss:0.14569091796875
2023-04-16 12:24:19 testing...
The generated pressure mean: 0.4497888684272766
The generated pressure mean: 0.4495830535888672
loss_pred:0.10842760652303696, decouple_loss:0.13842958211898804
The generated pressure mean: 0.44987666606903076
loss_pred:0.10772532969713211, decouple_loss:0.14002934098243713
loss_pred:0.10751154273748398, decouple_loss:0.14008918404579163
WV_0_PC_1_EH_1_PS_40, loss: 0.11486396193504333, avg_mse: 0.17439004778862
current test mse: 0.17439
Iteration: 11, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4472784996032715
loss_pred:0.03984449803829193, decouple_loss:0.13071289658546448
The generated pressure mean: 0.44728922843933105
The generated pressure mean: 0.4475158154964447
loss_pred:0.044776469469070435, decouple_loss:0.12959206104278564
loss_pred:0.041974734514951706, decouple_loss:0.12897905707359314
Iteration: 12, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44741693139076233
loss_pred:0.042941343039274216, decouple_loss:0.1130201444029808
The generated pressure mean: 0.44744616746902466
The generated pressure mean: 0.44788506627082825
loss_pred:0.03955034166574478, decouple_loss:0.11173027753829956
loss_pred:0.04130902886390686, decouple_loss:0.11264748126268387
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 13, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4483286142349243
loss_pred:0.03621445223689079, decouple_loss:0.11187149584293365
The generated pressure mean: 0.4477713108062744The generated pressure mean: 0.44880369305610657
loss_pred:0.039661016315221786, decouple_loss:0.11101634800434113
loss_pred:0.04244910553097725, decouple_loss:0.11183576285839081
Iteration: 14, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4478529095649719
The generated pressure mean: 0.44844841957092285
The generated pressure mean: 0.44811341166496277
loss_pred:0.03473688289523125, decouple_loss:0.1066555455327034
loss_pred:0.0367269404232502, decouple_loss:0.10608057677745819
loss_pred:0.03521410748362541, decouple_loss:0.10649023205041885
Iteration: 15, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4487624168395996
The generated pressure mean: 0.4481336772441864
The generated pressure mean: 0.44712573289871216
loss_pred:0.033061180263757706, decouple_loss:0.09320025146007538
loss_pred:0.03541041910648346, decouple_loss:0.09164533019065857
loss_pred:0.036969900131225586, decouple_loss:0.09106697887182236
Iteration: 16, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44754910469055176
The generated pressure mean: 0.44780275225639343
The generated pressure mean: 0.44761526584625244
loss_pred:0.03532606363296509, decouple_loss:0.08671790361404419
loss_pred:0.03472692146897316, decouple_loss:0.08739744126796722
loss_pred:0.033211637288331985, decouple_loss:0.08607414364814758
Iteration: 17, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44787734746932983
The generated pressure mean: 0.447795033454895
loss_pred:0.03594192862510681, decouple_loss:0.07933135330677032
The generated pressure mean: 0.44778379797935486loss_pred:0.03407733887434006, decouple_loss:0.07900345325469971
loss_pred:0.03455178067088127, decouple_loss:0.07867559790611267
Iteration: 18, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4481160640716553
loss_pred:0.032416753470897675, decouple_loss:0.07008174061775208
The generated pressure mean: 0.4479043781757355
The generated pressure mean: 0.44773542881011963
loss_pred:0.031521398574113846, decouple_loss:0.06945163756608963
loss_pred:0.03204559534788132, decouple_loss:0.069562166929245
Iteration: 19, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4491629898548126
The generated pressure mean: 0.44790562987327576
loss_pred:0.03071562945842743, decouple_loss:0.06891873478889465
loss_pred:0.03188110142946243, decouple_loss:0.070364810526371
The generated pressure mean: 0.447498619556427
loss_pred:0.03204355016350746, decouple_loss:0.0698222815990448
Iteration: 20, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4477217197418213The generated pressure mean: 0.44753897190093994
loss_pred:0.031730733811855316, decouple_loss:0.06480958312749863
loss_pred:0.03167719393968582, decouple_loss:0.06455928087234497
The generated pressure mean: 0.44799742102622986
loss_pred:0.03011336550116539, decouple_loss:0.0643095076084137
2023-04-16 12:26:13 testing...
The generated pressure mean: 0.449788898229599
The generated pressure mean: 0.4495830535888672
The generated pressure mean: 0.44987666606903076
loss_pred:0.1185629665851593, decouple_loss:0.07158398628234863
loss_pred:0.11723417043685913, decouple_loss:0.07165608555078506
loss_pred:0.11603611707687378, decouple_loss:0.07255296409130096
WV_0_PC_1_EH_1_PS_40, loss: 0.1208743080496788, avg_mse: 0.21241265535354614
current test mse: 0.212413
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012014_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012014_3_24hr.npz
NaN value num: 0
Iteration: 21, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4477446377277374
loss_pred:0.031225569546222687, decouple_loss:0.05836611986160278
The generated pressure mean: 0.44783878326416016
loss_pred:0.03037930838763714, decouple_loss:0.05921301245689392
The generated pressure mean: 0.4482654333114624
loss_pred:0.029792502522468567, decouple_loss:0.05860599875450134
Iteration: 22, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44828757643699646
The generated pressure mean: 0.4475400745868683
loss_pred:0.030498800799250603, decouple_loss:0.05713912099599838
loss_pred:0.028724869713187218, decouple_loss:0.05815277621150017
The generated pressure mean: 0.4478026330471039
loss_pred:0.030408822000026703, decouple_loss:0.05680777132511139
Iteration: 23, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44771134853363037
loss_pred:0.028263524174690247, decouple_loss:0.054831214249134064
The generated pressure mean: 0.4478815793991089
The generated pressure mean: 0.44742661714553833
loss_pred:0.028975216671824455, decouple_loss:0.053705472499132156
loss_pred:0.02980833128094673, decouple_loss:0.053516935557127
Iteration: 24, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4472653269767761
loss_pred:0.029832594096660614, decouple_loss:0.05179324001073837
The generated pressure mean: 0.44775912165641785
The generated pressure mean: 0.447527676820755
loss_pred:0.03046778030693531, decouple_loss:0.05082735791802406
loss_pred:0.0303475521504879, decouple_loss:0.050720080733299255
Iteration: 25, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.446699857711792
loss_pred:0.02890779636800289, decouple_loss:0.04851015284657478
The generated pressure mean: 0.447806179523468
The generated pressure mean: 0.44737327098846436
loss_pred:0.029294652864336967, decouple_loss:0.04899758845567703
loss_pred:0.03186263516545296, decouple_loss:0.04940315708518028
Iteration: 26, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44838187098503113
The generated pressure mean: 0.447759747505188
loss_pred:0.029641874134540558, decouple_loss:0.044906582683324814
loss_pred:0.030710868537425995, decouple_loss:0.044652096927165985
The generated pressure mean: 0.4472610652446747
loss_pred:0.032133858650922775, decouple_loss:0.04463427886366844
Iteration: 27, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4472673833370209
loss_pred:0.0291117075830698, decouple_loss:0.04408358410000801
The generated pressure mean: 0.44696977734565735
The generated pressure mean: 0.4461236000061035
loss_pred:0.029145551845431328, decouple_loss:0.04552030935883522
loss_pred:0.03156471252441406, decouple_loss:0.0434529110789299
Iteration: 28, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4468141794204712
The generated pressure mean: 0.4477505385875702The generated pressure mean: 0.4481663703918457
loss_pred:0.028677871450781822, decouple_loss:0.03897947072982788
loss_pred:0.028893357142806053, decouple_loss:0.03907698392868042
loss_pred:0.026796555146574974, decouple_loss:0.038252346217632294
Iteration: 29, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4476584792137146
The generated pressure mean: 0.44617268443107605
The generated pressure mean: 0.4471328556537628
loss_pred:0.026109816506505013, decouple_loss:0.039865463972091675
loss_pred:0.029226286336779594, decouple_loss:0.03862651064991951
loss_pred:0.028728395700454712, decouple_loss:0.04160374775528908
Iteration: 30, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4478709101676941
The generated pressure mean: 0.44772869348526
The generated pressure mean: 0.44900867342948914
loss_pred:0.026130924001336098, decouple_loss:0.03748045116662979
loss_pred:0.027803858742117882, decouple_loss:0.03710406273603439
loss_pred:0.031558696180582047, decouple_loss:0.03704458847641945
2023-04-16 12:28:43 testing...
The generated pressure mean: 0.449788898229599
The generated pressure mean: 0.4495830833911896
loss_pred:0.1444263607263565, decouple_loss:0.0747748538851738
The generated pressure mean: 0.4498766362667084
loss_pred:0.14206956326961517, decouple_loss:0.0750194787979126
loss_pred:0.14127352833747864, decouple_loss:0.07674522697925568
WV_0_PC_1_EH_1_PS_40, loss: 0.14636549353599548, avg_mse: 0.2741478681564331
current test mse: 0.274148
Iteration: 31, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44766923785209656
loss_pred:0.027552608400583267, decouple_loss:0.03523737192153931
The generated pressure mean: 0.4475446343421936
The generated pressure mean: 0.4488472044467926loss_pred:0.026823198422789574, decouple_loss:0.03473934158682823
loss_pred:0.02799619548022747, decouple_loss:0.03521791473031044
Iteration: 32, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44694727659225464
loss_pred:0.027389992028474808, decouple_loss:0.03282319754362106
The generated pressure mean: 0.44712865352630615
The generated pressure mean: 0.44683802127838135
loss_pred:0.02713744528591633, decouple_loss:0.032227229326963425
loss_pred:0.027394767850637436, decouple_loss:0.03218288719654083
Iteration: 33, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44658082723617554
The generated pressure mean: 0.44758838415145874
loss_pred:0.02726612612605095, decouple_loss:0.03267703950405121
The generated pressure mean: 0.4473441243171692loss_pred:0.027302639558911324, decouple_loss:0.032242972403764725
loss_pred:0.02738424763083458, decouple_loss:0.03271286562085152
Iteration: 34, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4487305283546448
The generated pressure mean: 0.44890880584716797
loss_pred:0.027601338922977448, decouple_loss:0.03311093896627426
loss_pred:0.02799016237258911, decouple_loss:0.03245839849114418
The generated pressure mean: 0.447611540555954
loss_pred:0.025870051234960556, decouple_loss:0.03100544773042202
Iteration: 35, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4471362233161926
The generated pressure mean: 0.4473842680454254
The generated pressure mean: 0.4474487006664276
loss_pred:0.02804430201649666, decouple_loss:0.028798749670386314
loss_pred:0.027130570262670517, decouple_loss:0.02866978757083416
loss_pred:0.026027096435427666, decouple_loss:0.02891290932893753
Iteration: 36, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4480758309364319
The generated pressure mean: 0.44756293296813965
loss_pred:0.02621537446975708, decouple_loss:0.029085736721754074
loss_pred:0.02652609907090664, decouple_loss:0.02930731140077114
The generated pressure mean: 0.447736531496048
loss_pred:0.02788117527961731, decouple_loss:0.02898206189274788
Iteration: 37, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4485616981983185
loss_pred:0.02608700655400753, decouple_loss:0.02720809355378151
The generated pressure mean: 0.44829726219177246
loss_pred:0.02760377526283264, decouple_loss:0.026992380619049072
The generated pressure mean: 0.4483104348182678
loss_pred:0.025567447766661644, decouple_loss:0.028103234246373177
Iteration: 38, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44798049330711365
loss_pred:0.02704087272286415, decouple_loss:0.028322432190179825
The generated pressure mean: 0.4473407566547394
The generated pressure mean: 0.4483383595943451
loss_pred:0.026080157607793808, decouple_loss:0.0279115941375494
loss_pred:0.026869377121329308, decouple_loss:0.028752539306879044
Iteration: 39, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4472222328186035
The generated pressure mean: 0.44822147488594055
The generated pressure mean: 0.44723832607269287
loss_pred:0.025225117802619934, decouple_loss:0.02684677392244339
loss_pred:0.02531997486948967, decouple_loss:0.02823270857334137
loss_pred:0.02472924068570137, decouple_loss:0.027498750016093254
Iteration: 40, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4470638036727905
loss_pred:0.027016783133149147, decouple_loss:0.028517670929431915
The generated pressure mean: 0.4473603069782257
loss_pred:0.0271926149725914, decouple_loss:0.02855100855231285
The generated pressure mean: 0.44744864106178284
loss_pred:0.026121122762560844, decouple_loss:0.028946835547685623
2023-04-16 12:30:37 testing...
The generated pressure mean: 0.4497888684272766
The generated pressure mean: 0.4495830833911896
The generated pressure mean: 0.449876606464386
loss_pred:0.16150957345962524, decouple_loss:0.0995507538318634
loss_pred:0.15915383398532867, decouple_loss:0.09906262904405594
loss_pred:0.15817518532276154, decouple_loss:0.10077816992998123
WV_0_PC_1_EH_1_PS_40, loss: 0.16460272669792175, avg_mse: 0.31106454133987427
current test mse: 0.311065
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012004_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012004_3_24hr.npz
NaN value num: 0
Iteration: 41, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4483340382575989
loss_pred:0.026004457846283913, decouple_loss:0.03042694739997387
The generated pressure mean: 0.448758602142334
loss_pred:0.02518858201801777, decouple_loss:0.030641812831163406
The generated pressure mean: 0.44883882999420166
loss_pred:0.02732531540095806, decouple_loss:0.03004848025739193
Iteration: 42, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44782358407974243
The generated pressure mean: 0.4465106725692749
loss_pred:0.025278901681303978, decouple_loss:0.02657558023929596
The generated pressure mean: 0.4490843415260315
loss_pred:0.02404148131608963, decouple_loss:0.028020797297358513
loss_pred:0.025407034903764725, decouple_loss:0.025984428822994232
Iteration: 43, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44825413823127747
loss_pred:0.025335533544421196, decouple_loss:0.02284189499914646
The generated pressure mean: 0.4477776288986206
The generated pressure mean: 0.44796425104141235
loss_pred:0.02561930939555168, decouple_loss:0.024660717695951462
loss_pred:0.027340896427631378, decouple_loss:0.023377863690257072
Iteration: 44, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44935524463653564
loss_pred:0.024090327322483063, decouple_loss:0.027667399495840073
The generated pressure mean: 0.4502048194408417The generated pressure mean: 0.4487207233905792
loss_pred:0.025815773755311966, decouple_loss:0.02554420381784439
loss_pred:0.02470031939446926, decouple_loss:0.027750873938202858
Iteration: 45, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4476124346256256
loss_pred:0.025233194231987, decouple_loss:0.029206782579421997
The generated pressure mean: 0.44828638434410095
loss_pred:0.02480882965028286, decouple_loss:0.029861221089959145
The generated pressure mean: 0.4494085907936096
loss_pred:0.02574438415467739, decouple_loss:0.03193645551800728
Iteration: 46, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4483753740787506
loss_pred:0.023811254650354385, decouple_loss:0.027380749583244324
The generated pressure mean: 0.4474850296974182
loss_pred:0.024394463747739792, decouple_loss:0.028095416724681854
The generated pressure mean: 0.4508858323097229
loss_pred:0.025240778923034668, decouple_loss:0.02759341336786747
Iteration: 47, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44863665103912354The generated pressure mean: 0.44847527146339417
loss_pred:0.026279538869857788, decouple_loss:0.02405851148068905
loss_pred:0.024099422618746758, decouple_loss:0.02517819032073021
The generated pressure mean: 0.4476673901081085
loss_pred:0.025561535730957985, decouple_loss:0.024243418127298355
Iteration: 48, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44775041937828064
loss_pred:0.02254652976989746, decouple_loss:0.024208806455135345
The generated pressure mean: 0.4467920958995819
loss_pred:0.023292243480682373, decouple_loss:0.02467009611427784
The generated pressure mean: 0.4482608139514923
loss_pred:0.02291872166097164, decouple_loss:0.02449565753340721
Iteration: 49, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4473828673362732
loss_pred:0.023977065458893776, decouple_loss:0.02540631964802742
The generated pressure mean: 0.4482871890068054
The generated pressure mean: 0.44804617762565613
loss_pred:0.024986829608678818, decouple_loss:0.0244829673320055
loss_pred:0.023738080635666847, decouple_loss:0.02546066790819168
Iteration: 50, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44732072949409485
The generated pressure mean: 0.44923391938209534
loss_pred:0.02339082770049572, decouple_loss:0.029001260176301003
The generated pressure mean: 0.4477930963039398
loss_pred:0.02446305938065052, decouple_loss:0.02910614013671875
loss_pred:0.023708339780569077, decouple_loss:0.027946610003709793
2023-04-16 12:33:08 testing...
The generated pressure mean: 0.4497888386249542
The generated pressure mean: 0.4495830833911896
loss_pred:0.1694626659154892, decouple_loss:0.09091047942638397
The generated pressure mean: 0.4498766362667084
loss_pred:0.16716301441192627, decouple_loss:0.09130629897117615
loss_pred:0.1660868376493454, decouple_loss:0.09249909222126007
WV_0_PC_1_EH_1_PS_40, loss: 0.1721494495868683, avg_mse: 0.33079880475997925
current test mse: 0.330799
Iteration: 51, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44831424951553345
The generated pressure mean: 0.4478868842124939
loss_pred:0.023717449977993965, decouple_loss:0.02259528823196888
loss_pred:0.022525887936353683, decouple_loss:0.02320501022040844
The generated pressure mean: 0.4481053054332733
loss_pred:0.024037741124629974, decouple_loss:0.022580020129680634
Iteration: 52, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4483461081981659
loss_pred:0.024096373468637466, decouple_loss:0.02275697886943817
The generated pressure mean: 0.4486162066459656
The generated pressure mean: 0.4481866657733917
loss_pred:0.023935602977871895, decouple_loss:0.02238495647907257
loss_pred:0.02264421060681343, decouple_loss:0.023596560582518578
Iteration: 53, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44879159331321716
The generated pressure mean: 0.44850486516952515
loss_pred:0.02573717013001442, decouple_loss:0.023203786462545395
loss_pred:0.02181161940097809, decouple_loss:0.02257671393454075
The generated pressure mean: 0.4463944733142853
loss_pred:0.023370305076241493, decouple_loss:0.022586166858673096
Iteration: 54, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4470710754394531
The generated pressure mean: 0.4478696584701538
The generated pressure mean: 0.4472765028476715loss_pred:0.02220888063311577, decouple_loss:0.01908675581216812
loss_pred:0.02329247258603573, decouple_loss:0.018711121752858162
loss_pred:0.023933369666337967, decouple_loss:0.019275793805718422
Iteration: 55, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44656041264533997
loss_pred:0.02260059304535389, decouple_loss:0.023740552365779877
The generated pressure mean: 0.44810235500335693
The generated pressure mean: 0.4484059810638428
loss_pred:0.0231194905936718, decouple_loss:0.022968560457229614
loss_pred:0.025475243106484413, decouple_loss:0.022808313369750977
Iteration: 56, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44962185621261597
The generated pressure mean: 0.44835537672042847
loss_pred:0.023049714043736458, decouple_loss:0.020588142797350883
The generated pressure mean: 0.45018258690834045
loss_pred:0.023595212027430534, decouple_loss:0.020716996863484383
loss_pred:0.023705266416072845, decouple_loss:0.020074855536222458
Iteration: 57, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44806262850761414
loss_pred:0.024160945788025856, decouple_loss:0.026914916932582855
The generated pressure mean: 0.4475911259651184
The generated pressure mean: 0.4481760859489441
loss_pred:0.02313205413520336, decouple_loss:0.02515576221048832
loss_pred:0.023461801931262016, decouple_loss:0.02516941912472248
Iteration: 58, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4487621486186981
loss_pred:0.02292751520872116, decouple_loss:0.028051165863871574
The generated pressure mean: 0.44871824979782104
The generated pressure mean: 0.44648706912994385
loss_pred:0.023401718586683273, decouple_loss:0.02592778205871582
loss_pred:0.02388708107173443, decouple_loss:0.02487795799970627
Iteration: 59, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4487472176551819
loss_pred:0.02406172640621662, decouple_loss:0.019450265914201736
The generated pressure mean: 0.44756534695625305
loss_pred:0.022794406861066818, decouple_loss:0.021825825795531273
The generated pressure mean: 0.44865864515304565
loss_pred:0.02280043438076973, decouple_loss:0.019753560423851013
Iteration: 60, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.447542279958725
loss_pred:0.023044204339385033, decouple_loss:0.02096692845225334
The generated pressure mean: 0.4461551308631897
The generated pressure mean: 0.4479285478591919
loss_pred:0.022856757044792175, decouple_loss:0.02126193419098854
loss_pred:0.024978334084153175, decouple_loss:0.019681118428707123
2023-04-16 12:35:01 testing...
The generated pressure mean: 0.4497888684272766
The generated pressure mean: 0.4495830833911896
loss_pred:0.17383693158626556, decouple_loss:0.09314350038766861
The generated pressure mean: 0.44987666606903076
loss_pred:0.1716366857290268, decouple_loss:0.09357689321041107
loss_pred:0.17048239707946777, decouple_loss:0.09476588666439056
WV_0_PC_1_EH_1_PS_40, loss: 0.17667679488658905, avg_mse: 0.3417980968952179
current test mse: 0.341798
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012002_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012002_3_24hr.npz
NaN value num: 0
Iteration: 61, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4488906264305115
loss_pred:0.02277890406548977, decouple_loss:0.02620149776339531
The generated pressure mean: 0.4476599097251892
loss_pred:0.023463111370801926, decouple_loss:0.025355445221066475
The generated pressure mean: 0.4473476707935333
loss_pred:0.02331056259572506, decouple_loss:0.025216687470674515
Iteration: 62, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4489430785179138The generated pressure mean: 0.44862738251686096
loss_pred:0.023776313289999962, decouple_loss:0.022777369245886803
loss_pred:0.021762581542134285, decouple_loss:0.023811593651771545The generated pressure mean: 0.4500373899936676
loss_pred:0.02257545106112957, decouple_loss:0.02478272281587124
Iteration: 63, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4486277103424072
The generated pressure mean: 0.4497584402561188
The generated pressure mean: 0.4474325478076935
loss_pred:0.022495480254292488, decouple_loss:0.018245181068778038
loss_pred:0.023711765184998512, decouple_loss:0.018543250858783722
loss_pred:0.022815674543380737, decouple_loss:0.01791887730360031
Iteration: 64, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44669443368911743
The generated pressure mean: 0.44819748401641846
The generated pressure mean: 0.4490821659564972
loss_pred:0.0237901471555233, decouple_loss:0.021770361810922623
loss_pred:0.024775519967079163, decouple_loss:0.02170434035360813
loss_pred:0.023903803899884224, decouple_loss:0.021969707682728767
Iteration: 65, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4497550427913666
The generated pressure mean: 0.44807690382003784
The generated pressure mean: 0.44884777069091797
loss_pred:0.024202674627304077, decouple_loss:0.02234777994453907
loss_pred:0.022908082231879234, decouple_loss:0.020455749705433846
loss_pred:0.022017063573002815, decouple_loss:0.021964119747281075
Iteration: 66, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44798246026039124
The generated pressure mean: 0.44836610555648804
loss_pred:0.02298702485859394, decouple_loss:0.027277139946818352
loss_pred:0.023814905434846878, decouple_loss:0.02749500796198845
The generated pressure mean: 0.4474262297153473
loss_pred:0.023863285779953003, decouple_loss:0.026875078678131104
Iteration: 67, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4487262964248657
The generated pressure mean: 0.4476977586746216
The generated pressure mean: 0.44679009914398193
loss_pred:0.024469587951898575, decouple_loss:0.018659062683582306
loss_pred:0.025197362527251244, decouple_loss:0.01905657909810543
loss_pred:0.023309975862503052, decouple_loss:0.020243322476744652
Iteration: 68, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44839343428611755
The generated pressure mean: 0.447856068611145
loss_pred:0.025959044694900513, decouple_loss:0.020262805745005608
loss_pred:0.024349965155124664, decouple_loss:0.019948014989495277The generated pressure mean: 0.44755738973617554
loss_pred:0.0247321967035532, decouple_loss:0.0199492909014225
Iteration: 69, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4499562978744507The generated pressure mean: 0.4488057792186737
The generated pressure mean: 0.45165666937828064
loss_pred:0.023434491828083992, decouple_loss:0.02996588684618473loss_pred:0.023843346163630486, decouple_loss:0.028673090040683746
loss_pred:0.023051107302308083, decouple_loss:0.027796965092420578
Iteration: 70, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44869619607925415
The generated pressure mean: 0.44811615347862244
loss_pred:0.024044973775744438, decouple_loss:0.016294775530695915
loss_pred:0.022623512893915176, decouple_loss:0.017133165150880814
The generated pressure mean: 0.44856277108192444
loss_pred:0.02266329899430275, decouple_loss:0.016251804307103157
2023-04-16 12:37:32 testing...
The generated pressure mean: 0.4497888684272766
The generated pressure mean: 0.4495830535888672
The generated pressure mean: 0.44987666606903076
loss_pred:0.177224263548851, decouple_loss:0.0772472620010376
loss_pred:0.1749480664730072, decouple_loss:0.07796794921159744
loss_pred:0.17396733164787292, decouple_loss:0.07855812460184097
WV_0_PC_1_EH_1_PS_40, loss: 0.17927610874176025, avg_mse: 0.3485656678676605
current test mse: 0.348566
Iteration: 71, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4484174847602844
loss_pred:0.02329530380666256, decouple_loss:0.02459886483848095
The generated pressure mean: 0.4475485384464264
loss_pred:0.02409193105995655, decouple_loss:0.025289714336395264
The generated pressure mean: 0.4489039182662964
loss_pred:0.022803323343396187, decouple_loss:0.026043938472867012
Iteration: 72, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44795361161231995
The generated pressure mean: 0.4474162459373474
loss_pred:0.024414299055933952, decouple_loss:0.024373997002840042
loss_pred:0.02217523567378521, decouple_loss:0.02456314116716385
The generated pressure mean: 0.4497203826904297
loss_pred:0.021876169368624687, decouple_loss:0.02403668314218521
Iteration: 73, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4496113657951355
The generated pressure mean: 0.44837772846221924
loss_pred:0.021997172385454178, decouple_loss:0.016120191663503647
The generated pressure mean: 0.44840124249458313loss_pred:0.022693127393722534, decouple_loss:0.01585633121430874
loss_pred:0.0250997357070446, decouple_loss:0.015565818175673485
Iteration: 74, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4472696781158447
The generated pressure mean: 0.4491240084171295
loss_pred:0.024013269692659378, decouple_loss:0.02810245007276535
The generated pressure mean: 0.4493549168109894
loss_pred:0.021565599367022514, decouple_loss:0.02794576622545719
loss_pred:0.022099295631051064, decouple_loss:0.026915358379483223
Iteration: 75, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4490068256855011
The generated pressure mean: 0.44819432497024536
loss_pred:0.022148629650473595, decouple_loss:0.017608897760510445The generated pressure mean: 0.4489346146583557
loss_pred:0.024014774709939957, decouple_loss:0.01746532879769802
loss_pred:0.02318573370575905, decouple_loss:0.017688456922769547
Iteration: 76, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4490740895271301
The generated pressure mean: 0.4472569525241852
loss_pred:0.023053236305713654, decouple_loss:0.025569427758455276
The generated pressure mean: 0.44766318798065186loss_pred:0.02338354103267193, decouple_loss:0.02555341273546219
loss_pred:0.023000558838248253, decouple_loss:0.025502339005470276
Iteration: 77, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44915971159935
The generated pressure mean: 0.44738534092903137
The generated pressure mean: 0.4497990608215332
loss_pred:0.022183725610375404, decouple_loss:0.022693460807204247
loss_pred:0.022225424647331238, decouple_loss:0.022543124854564667
loss_pred:0.02257884480059147, decouple_loss:0.02226121723651886
Iteration: 78, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4474972188472748
loss_pred:0.022884227335453033, decouple_loss:0.022669849917292595
The generated pressure mean: 0.4469147324562073
loss_pred:0.021503543481230736, decouple_loss:0.022652149200439453
The generated pressure mean: 0.4478529095649719
loss_pred:0.02357015199959278, decouple_loss:0.02262779138982296
Iteration: 79, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45019304752349854
loss_pred:0.023014863952994347, decouple_loss:0.021657384932041168
The generated pressure mean: 0.4507500231266022
loss_pred:0.02404727227985859, decouple_loss:0.021648462861776352
The generated pressure mean: 0.448757529258728
loss_pred:0.02254701778292656, decouple_loss:0.021017424762248993
Iteration: 80, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4472678303718567
The generated pressure mean: 0.4481937289237976
The generated pressure mean: 0.4471130073070526
loss_pred:0.022631952539086342, decouple_loss:0.024750348180532455
loss_pred:0.02250228263437748, decouple_loss:0.02357260137796402
loss_pred:0.02405233308672905, decouple_loss:0.024102795869112015
2023-04-16 12:39:26 testing...
The generated pressure mean: 0.449788898229599
The generated pressure mean: 0.4495830237865448
loss_pred:0.17669564485549927, decouple_loss:0.07645955681800842
The generated pressure mean: 0.44987666606903076
loss_pred:0.17425882816314697, decouple_loss:0.07688639312982559
loss_pred:0.1735447496175766, decouple_loss:0.07781235873699188
WV_0_PC_1_EH_1_PS_40, loss: 0.17868570983409882, avg_mse: 0.3483622372150421
current test mse: 0.348362
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012002_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012002_3_24hr.npz
NaN value num: 0
Iteration: 81, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44745758175849915
loss_pred:0.02387564815580845, decouple_loss:0.019392067566514015
The generated pressure mean: 0.4462987780570984
loss_pred:0.023047098889946938, decouple_loss:0.018075747415423393
The generated pressure mean: 0.4477178156375885
loss_pred:0.024609724059700966, decouple_loss:0.019496669992804527
Iteration: 82, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.447200208902359
The generated pressure mean: 0.44673678278923035
loss_pred:0.024439051747322083, decouple_loss:0.023904012516140938
The generated pressure mean: 0.4475288391113281
loss_pred:0.022878015413880348, decouple_loss:0.023082971572875977
loss_pred:0.025320101529359818, decouple_loss:0.023339934647083282
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 83, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4490334987640381
The generated pressure mean: 0.4482840895652771loss_pred:0.024433210492134094, decouple_loss:0.021499378606677055
The generated pressure mean: 0.4477290213108063
loss_pred:0.022255582734942436, decouple_loss:0.021316474303603172
loss_pred:0.025172414258122444, decouple_loss:0.02158357761800289
Iteration: 84, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4479074776172638
The generated pressure mean: 0.4458503723144531
The generated pressure mean: 0.4478618800640106
loss_pred:0.02397700771689415, decouple_loss:0.02517729066312313
loss_pred:0.021947741508483887, decouple_loss:0.025227626785635948
loss_pred:0.023587509989738464, decouple_loss:0.025413984432816505
Iteration: 85, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4478778839111328
The generated pressure mean: 0.4469371438026428
The generated pressure mean: 0.44722050428390503
loss_pred:0.02158389799296856, decouple_loss:0.022111069411039352
loss_pred:0.023254454135894775, decouple_loss:0.02227560430765152
loss_pred:0.022461112588644028, decouple_loss:0.02226841077208519
Iteration: 86, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44597628712654114The generated pressure mean: 0.4462680220603943
loss_pred:0.0216275192797184, decouple_loss:0.026318516582250595
loss_pred:0.0222538523375988, decouple_loss:0.026732446625828743
The generated pressure mean: 0.44642341136932373
loss_pred:0.023645726963877678, decouple_loss:0.026907194405794144
Iteration: 87, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44760170578956604
The generated pressure mean: 0.44622603058815
loss_pred:0.021571652963757515, decouple_loss:0.022750552743673325
loss_pred:0.02259918488562107, decouple_loss:0.02168296091258526
The generated pressure mean: 0.4449773132801056
loss_pred:0.023051640018820763, decouple_loss:0.022870291024446487
Iteration: 88, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44646063446998596
loss_pred:0.023638712242245674, decouple_loss:0.025891348719596863
The generated pressure mean: 0.44810187816619873
The generated pressure mean: 0.4465464651584625
loss_pred:0.022108636796474457, decouple_loss:0.025812676176428795
loss_pred:0.02323872782289982, decouple_loss:0.026296889409422874
Iteration: 89, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44783398509025574
The generated pressure mean: 0.44696518778800964
loss_pred:0.022264298051595688, decouple_loss:0.024104265496134758
loss_pred:0.02242896892130375, decouple_loss:0.023668373003602028
The generated pressure mean: 0.44754672050476074
loss_pred:0.022110579535365105, decouple_loss:0.023622747510671616
Iteration: 90, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44661030173301697
loss_pred:0.02261265553534031, decouple_loss:0.02228713035583496
The generated pressure mean: 0.4469771385192871
The generated pressure mean: 0.44580376148223877
loss_pred:0.022665124386548996, decouple_loss:0.022824227809906006
loss_pred:0.021898094564676285, decouple_loss:0.02195707894861698
2023-04-16 12:41:58 testing...
The generated pressure mean: 0.4497888684272766
The generated pressure mean: 0.4495830535888672
loss_pred:0.1787245273590088, decouple_loss:0.06720827519893646
The generated pressure mean: 0.44987666606903076
loss_pred:0.17632198333740234, decouple_loss:0.06735675781965256
loss_pred:0.17559178173542023, decouple_loss:0.06822387129068375
WV_0_PC_1_EH_1_PS_40, loss: 0.18025925755500793, avg_mse: 0.35447487235069275
current test mse: 0.354475
Iteration: 91, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44662752747535706
loss_pred:0.023258212953805923, decouple_loss:0.021716419607400894
The generated pressure mean: 0.44557875394821167
loss_pred:0.02207373082637787, decouple_loss:0.022511009126901627
The generated pressure mean: 0.447109192609787
loss_pred:0.023502785712480545, decouple_loss:0.02150953933596611
Iteration: 92, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4472738802433014
The generated pressure mean: 0.4466038942337036
The generated pressure mean: 0.44668105244636536
loss_pred:0.02575800009071827, decouple_loss:0.019191544502973557
loss_pred:0.022544492036104202, decouple_loss:0.01940855011343956
loss_pred:0.022599026560783386, decouple_loss:0.01935679093003273
Iteration: 93, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44632357358932495
loss_pred:0.023330073803663254, decouple_loss:0.01929778978228569
The generated pressure mean: 0.4472726881504059
The generated pressure mean: 0.44501036405563354
loss_pred:0.021710367873311043, decouple_loss:0.01915166713297367
loss_pred:0.022489631548523903, decouple_loss:0.019198887050151825
Iteration: 94, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4471326768398285
The generated pressure mean: 0.4470151662826538
loss_pred:0.02383364923298359, decouple_loss:0.01831590011715889
The generated pressure mean: 0.44681262969970703
loss_pred:0.022104665637016296, decouple_loss:0.018214445561170578
loss_pred:0.023042945191264153, decouple_loss:0.0183230210095644
Iteration: 95, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44669926166534424
The generated pressure mean: 0.4464516043663025
loss_pred:0.021360324695706367, decouple_loss:0.01731005683541298
The generated pressure mean: 0.4472149610519409
loss_pred:0.024001186713576317, decouple_loss:0.017108594998717308
loss_pred:0.021858949214220047, decouple_loss:0.017275173217058182
Iteration: 96, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44723254442214966
The generated pressure mean: 0.44813522696495056
The generated pressure mean: 0.44691750407218933
loss_pred:0.022206267341971397, decouple_loss:0.019710225984454155
loss_pred:0.02251437120139599, decouple_loss:0.019470350816845894
loss_pred:0.02224099263548851, decouple_loss:0.019702039659023285
Iteration: 97, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44644808769226074
The generated pressure mean: 0.44587817788124084
loss_pred:0.022491084411740303, decouple_loss:0.015025406144559383
loss_pred:0.022041309624910355, decouple_loss:0.015156414359807968
The generated pressure mean: 0.44854840636253357
loss_pred:0.02281199023127556, decouple_loss:0.015175235457718372
Iteration: 98, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44859689474105835
The generated pressure mean: 0.44796088337898254
loss_pred:0.022318676114082336, decouple_loss:0.018780771642923355
loss_pred:0.021645562723279, decouple_loss:0.01835932955145836
The generated pressure mean: 0.44550079107284546
loss_pred:0.02331794612109661, decouple_loss:0.018353434279561043
Iteration: 99, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4478633999824524
loss_pred:0.02248862199485302, decouple_loss:0.01721891015768051
The generated pressure mean: 0.4466817378997803
loss_pred:0.023462485522031784, decouple_loss:0.016956813633441925
The generated pressure mean: 0.44840073585510254
loss_pred:0.022793244570493698, decouple_loss:0.01753106340765953
Iteration: 100, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4461059868335724
The generated pressure mean: 0.4474099576473236
loss_pred:0.02210092544555664, decouple_loss:0.017175737768411636
loss_pred:0.023121261969208717, decouple_loss:0.016702329739928246
The generated pressure mean: 0.4474528133869171
loss_pred:0.022089622914791107, decouple_loss:0.01684596575796604
2023-04-16 12:43:53 testing...
The generated pressure mean: 0.449788898229599
The generated pressure mean: 0.4495830833911896
loss_pred:0.17739805579185486, decouple_loss:0.06516772508621216
The generated pressure mean: 0.44987666606903076
loss_pred:0.1749276965856552, decouple_loss:0.0657898560166359
loss_pred:0.17445380985736847, decouple_loss:0.06682717055082321
WV_0_PC_1_EH_1_PS_40, loss: 0.17888960242271423, avg_mse: 0.3523937463760376
current test mse: 0.352394
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012017_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012017_3_24hr.npz
NaN value num: 0
Iteration: 101, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44752657413482666
loss_pred:0.02269996516406536, decouple_loss:0.01594390720129013
The generated pressure mean: 0.4479132294654846
The generated pressure mean: 0.4478135108947754
loss_pred:0.022771451622247696, decouple_loss:0.015792476013302803
loss_pred:0.02394876256585121, decouple_loss:0.016055122017860413
Iteration: 102, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44879159331321716
The generated pressure mean: 0.44888070225715637
loss_pred:0.02331676334142685, decouple_loss:0.01728888228535652
The generated pressure mean: 0.44797733426094055
loss_pred:0.021844133734703064, decouple_loss:0.017065124586224556
loss_pred:0.021685253828763962, decouple_loss:0.016484852880239487
Iteration: 103, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4479690194129944
The generated pressure mean: 0.4484468698501587
loss_pred:0.021541746333241463, decouple_loss:0.017083216458559036
The generated pressure mean: 0.44781047105789185
loss_pred:0.02206539362668991, decouple_loss:0.0164630264043808
loss_pred:0.023051926866173744, decouple_loss:0.016986705362796783
Iteration: 104, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4487875998020172
The generated pressure mean: 0.4461670517921448
The generated pressure mean: 0.44700315594673157
loss_pred:0.021956168115139008, decouple_loss:0.014968199655413628
loss_pred:0.022838296368718147, decouple_loss:0.015415754169225693
loss_pred:0.02237008698284626, decouple_loss:0.015313958749175072
Iteration: 105, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.448091596364975
The generated pressure mean: 0.4470321238040924
The generated pressure mean: 0.4489078223705292
loss_pred:0.022216131910681725, decouple_loss:0.017048658803105354
loss_pred:0.023216884583234787, decouple_loss:0.017458772286772728
loss_pred:0.0251252930611372, decouple_loss:0.016885146498680115
Iteration: 106, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4482062757015228
The generated pressure mean: 0.44692254066467285
The generated pressure mean: 0.44783854484558105
loss_pred:0.021582087501883507, decouple_loss:0.014094981364905834
loss_pred:0.022377604618668556, decouple_loss:0.013867933303117752
loss_pred:0.022480454295873642, decouple_loss:0.014617254957556725
Iteration: 107, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4482780992984772
The generated pressure mean: 0.4480619728565216
loss_pred:0.02382144331932068, decouple_loss:0.017523856833577156
loss_pred:0.023448295891284943, decouple_loss:0.01737147569656372
The generated pressure mean: 0.44782280921936035
loss_pred:0.022113416343927383, decouple_loss:0.017598647624254227
Iteration: 108, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4463731050491333
loss_pred:0.02352575957775116, decouple_loss:0.015273109078407288
The generated pressure mean: 0.44810551404953003
The generated pressure mean: 0.4465709626674652
loss_pred:0.022010810673236847, decouple_loss:0.015600072219967842
loss_pred:0.02353518083691597, decouple_loss:0.01617114618420601
Iteration: 109, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44824519753456116
loss_pred:0.02296650968492031, decouple_loss:0.013441945426166058
The generated pressure mean: 0.4471516013145447
The generated pressure mean: 0.44762372970581055
loss_pred:0.02328132651746273, decouple_loss:0.014167584478855133
loss_pred:0.021420851349830627, decouple_loss:0.013324879109859467
Iteration: 110, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44816285371780396
The generated pressure mean: 0.44875863194465637
loss_pred:0.02177240140736103, decouple_loss:0.016024570912122726
The generated pressure mean: 0.4472324848175049
loss_pred:0.0218253955245018, decouple_loss:0.016163023188710213
loss_pred:0.02184816636145115, decouple_loss:0.015794409438967705
2023-04-16 12:46:20 testing...
The generated pressure mean: 0.4497888684272766
The generated pressure mean: 0.4495830535888672
loss_pred:0.1783326268196106, decouple_loss:0.06605380028486252
The generated pressure mean: 0.44987666606903076
loss_pred:0.17573224008083344, decouple_loss:0.0665464922785759
loss_pred:0.1752167046070099, decouple_loss:0.06761500984430313
WV_0_PC_1_EH_1_PS_40, loss: 0.17976412177085876, avg_mse: 0.3534451127052307
current test mse: 0.353445
Iteration: 111, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44816482067108154
loss_pred:0.02239723689854145, decouple_loss:0.01768677681684494
The generated pressure mean: 0.44800907373428345
The generated pressure mean: 0.44853079319000244
loss_pred:0.021522076800465584, decouple_loss:0.017722293734550476
loss_pred:0.021472260355949402, decouple_loss:0.01769343577325344
Iteration: 112, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44745364785194397
The generated pressure mean: 0.4477875232696533
loss_pred:0.022704722359776497, decouple_loss:0.015360899269580841
The generated pressure mean: 0.44791847467422485
loss_pred:0.02289775386452675, decouple_loss:0.015186598524451256
loss_pred:0.023470137268304825, decouple_loss:0.015576398000121117
Iteration: 113, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4478549659252167
The generated pressure mean: 0.44775089621543884
loss_pred:0.02148481272161007, decouple_loss:0.01929660513997078
The generated pressure mean: 0.44785717129707336
loss_pred:0.023450011387467384, decouple_loss:0.019074562937021255
loss_pred:0.024541178718209267, decouple_loss:0.019261520355939865
Iteration: 114, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4487229287624359
The generated pressure mean: 0.4473021924495697
loss_pred:0.022913256660103798, decouple_loss:0.013803770765662193
The generated pressure mean: 0.44795534014701843
loss_pred:0.024375738576054573, decouple_loss:0.01410093903541565
loss_pred:0.023341471329331398, decouple_loss:0.013658075593411922
Iteration: 115, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4478556513786316
The generated pressure mean: 0.4474637806415558
loss_pred:0.022274017333984375, decouple_loss:0.023475229740142822
loss_pred:0.02287098579108715, decouple_loss:0.022960543632507324
The generated pressure mean: 0.4482244551181793
loss_pred:0.021760601550340652, decouple_loss:0.023524116724729538
Iteration: 116, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4474121034145355
The generated pressure mean: 0.44676506519317627
loss_pred:0.02331935428082943, decouple_loss:0.015718994662165642
loss_pred:0.022818565368652344, decouple_loss:0.01557912677526474
The generated pressure mean: 0.4480210840702057
loss_pred:0.02175714820623398, decouple_loss:0.01596485637128353
Iteration: 117, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44863346219062805
loss_pred:0.022034887224435806, decouple_loss:0.019762925803661346
The generated pressure mean: 0.44762149453163147
The generated pressure mean: 0.4473591446876526loss_pred:0.021988479420542717, decouple_loss:0.020016441121697426
loss_pred:0.021908916532993317, decouple_loss:0.019887495785951614
Iteration: 118, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4482143223285675
loss_pred:0.023035192862153053, decouple_loss:0.019417941570281982
The generated pressure mean: 0.44811657071113586
loss_pred:0.022609366104006767, decouple_loss:0.01910504326224327
The generated pressure mean: 0.44733428955078125
loss_pred:0.022669833153486252, decouple_loss:0.018853049725294113
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 119, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44812288880348206
loss_pred:0.024548929184675217, decouple_loss:0.01871633529663086
The generated pressure mean: 0.44740691781044006
The generated pressure mean: 0.44823944568634033
loss_pred:0.02370489574968815, decouple_loss:0.01922365464270115
loss_pred:0.022959386929869652, decouple_loss:0.019391873851418495
Iteration: 120, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44830822944641113
loss_pred:0.02339731901884079, decouple_loss:0.01685936190187931
The generated pressure mean: 0.44802403450012207
The generated pressure mean: 0.4478299915790558
loss_pred:0.02122650109231472, decouple_loss:0.01714000478386879
loss_pred:0.02264999784529209, decouple_loss:0.016670679673552513
2023-04-16 12:48:14 testing...
The generated pressure mean: 0.449788898229599
The generated pressure mean: 0.4495830535888672
loss_pred:0.17796774208545685, decouple_loss:0.05613076686859131
The generated pressure mean: 0.44987666606903076
loss_pred:0.1755046844482422, decouple_loss:0.05678499862551689
loss_pred:0.17484094202518463, decouple_loss:0.05713489651679993
WV_0_PC_1_EH_1_PS_40, loss: 0.17893865704536438, avg_mse: 0.35311275720596313
current test mse: 0.353113
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012003_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012003_3_24hr.npz
NaN value num: 0
Iteration: 121, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.447870135307312
loss_pred:0.023496393114328384, decouple_loss:0.02066536247730255
The generated pressure mean: 0.44916537404060364
loss_pred:0.02153581567108631, decouple_loss:0.02085382677614689
The generated pressure mean: 0.44833943247795105
loss_pred:0.022266041487455368, decouple_loss:0.02090398781001568
Iteration: 122, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4493597447872162
The generated pressure mean: 0.44887325167655945
loss_pred:0.02327074110507965, decouple_loss:0.01842503435909748
The generated pressure mean: 0.4483759105205536
loss_pred:0.023641075938940048, decouple_loss:0.017511067911982536
loss_pred:0.023014811798930168, decouple_loss:0.017272714525461197
Iteration: 123, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44846633076667786
The generated pressure mean: 0.44702985882759094
The generated pressure mean: 0.44682058691978455
loss_pred:0.021627426147460938, decouple_loss:0.017418567091226578
loss_pred:0.02166788838803768, decouple_loss:0.017395813018083572
loss_pred:0.023314068093895912, decouple_loss:0.0174087081104517
Iteration: 124, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4481600224971771
The generated pressure mean: 0.44679588079452515
loss_pred:0.022979507222771645, decouple_loss:0.0188028272241354
loss_pred:0.02156638726592064, decouple_loss:0.019253667443990707
The generated pressure mean: 0.44898635149002075
loss_pred:0.022975662723183632, decouple_loss:0.019811345264315605
Iteration: 125, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4477507770061493
The generated pressure mean: 0.4476642608642578
loss_pred:0.02439023181796074, decouple_loss:0.016718503087759018
loss_pred:0.02245515026152134, decouple_loss:0.015572461299598217
The generated pressure mean: 0.4481566548347473
loss_pred:0.02185627445578575, decouple_loss:0.016160011291503906
Iteration: 126, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4482409656047821
The generated pressure mean: 0.44745132327079773
loss_pred:0.022594232112169266, decouple_loss:0.01895836554467678
loss_pred:0.02251521311700344, decouple_loss:0.018658284097909927
The generated pressure mean: 0.4481697380542755
loss_pred:0.022822583094239235, decouple_loss:0.019318807870149612
Iteration: 127, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4486349821090698
loss_pred:0.022895459085702896, decouple_loss:0.019628826528787613
The generated pressure mean: 0.4477349519729614
The generated pressure mean: 0.44853881001472473
loss_pred:0.02337675355374813, decouple_loss:0.019868846982717514
loss_pred:0.023394552990794182, decouple_loss:0.02032836712896824
Iteration: 128, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4484458863735199
The generated pressure mean: 0.4476153552532196
The generated pressure mean: 0.44905126094818115loss_pred:0.023078223690390587, decouple_loss:0.016032686457037926
loss_pred:0.0231071338057518, decouple_loss:0.016027426347136497
loss_pred:0.022856833413243294, decouple_loss:0.01664193905889988
Iteration: 129, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4481634199619293
loss_pred:0.02249516360461712, decouple_loss:0.023708099499344826
The generated pressure mean: 0.4490233063697815The generated pressure mean: 0.44690385460853577
loss_pred:0.021370751783251762, decouple_loss:0.02462906762957573loss_pred:0.023394638672471046, decouple_loss:0.023710083216428757
Iteration: 130, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44764280319213867
The generated pressure mean: 0.449741393327713
loss_pred:0.02357371896505356, decouple_loss:0.01866050809621811
The generated pressure mean: 0.44846776127815247
loss_pred:0.02344045788049698, decouple_loss:0.0178747046738863
loss_pred:0.023671554401516914, decouple_loss:0.017685966566205025
2023-04-16 12:50:42 testing...
The generated pressure mean: 0.449788898229599
The generated pressure mean: 0.4495830535888672
loss_pred:0.17995144426822662, decouple_loss:0.05896318703889847
Traceback (most recent call last):
  File "/work/09012/haoli1/ls6/ERA5_PredRNN/predrnn-pytorch/run1.py", line 335, in <module>
    train_wrapper(model)
  File "/work/09012/haoli1/ls6/ERA5_PredRNN/predrnn-pytorch/run1.py", line 280, in train_wrapper
    test_err = trainer.test(model, test_input_handle, args, 'test_result')
  File "/work/09012/haoli1/ls6/ERA5_PredRNN/predrnn-pytorch/core/trainer.py", line 62, in test
    avg_mse = torch.mean((img_out[:,-output_length:]-test_ims[:,-output_length:])**2*configs.area_weight).cpu().numpy()
KeyboardInterrupt
The generated pressure mean: 0.44987666606903076
loss_pred:0.17723284661769867, decouple_loss:0.05988083407282829
loss_pred:0.17675375938415527, decouple_loss:0.06027087941765785