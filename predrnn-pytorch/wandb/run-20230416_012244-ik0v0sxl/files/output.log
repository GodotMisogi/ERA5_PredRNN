After initialize model, args.img_channel:30
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012000_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012001_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012002_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012003_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012004_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012005_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012006_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012007_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012008_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012009_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012010_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012011_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012012_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012013_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012014_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012015_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012016_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012017_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012018_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012019_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012020_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012000_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012001_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012002_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012003_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012004_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012005_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012006_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012007_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012008_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012009_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012010_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012011_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012012_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012013_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012014_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012015_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012016_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012017_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012018_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012019_3_24hr.npz
train_data_files nums: 41
mnist test iterator, Loading data from /scratch/09012/haoli1/ERA5/val_dataset/era5_train_09012020_3_24hr.npz
NaN value num: 0
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012012_3_24hr.npz
NaN value num: 0
Iteration: 1, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4478202164173126
loss_pred:0.1642955243587494, decouple_loss:0.0864809900522232
The generated pressure mean: 0.44762659072875977
loss_pred:0.16316024959087372, decouple_loss:0.09123121947050095
The generated pressure mean: 0.4479117691516876
loss_pred:0.15984250605106354, decouple_loss:0.08375494927167892
/work/09012/haoli1/ls6/Pyt/lib/python3.9/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '
Iteration: 2, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44792431592941284
loss_pred:0.16660945117473602, decouple_loss:0.41853541135787964
The generated pressure mean: 0.4479307234287262
loss_pred:0.16284999251365662, decouple_loss:0.4186350107192993
The generated pressure mean: 0.44711175560951233
loss_pred:0.1665397733449936, decouple_loss:0.41932255029678345
Iteration: 3, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4486628472805023
loss_pred:0.16482175886631012, decouple_loss:0.6199325919151306
The generated pressure mean: 0.44727623462677
loss_pred:0.16223500669002533, decouple_loss:0.6135079264640808
The generated pressure mean: 0.4476650357246399
loss_pred:0.1600288450717926, decouple_loss:0.6260293126106262
Iteration: 4, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44754451513290405
loss_pred:0.14559155702590942, decouple_loss:0.657162606716156
The generated pressure mean: 0.4472798705101013
loss_pred:0.1428856998682022, decouple_loss:0.6549541354179382
The generated pressure mean: 0.4477511942386627
loss_pred:0.14644788205623627, decouple_loss:0.6475340723991394
Iteration: 5, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4477987289428711
loss_pred:0.18051347136497498, decouple_loss:0.6792311668395996
The generated pressure mean: 0.44752874970436096
loss_pred:0.17427487671375275, decouple_loss:0.6756249070167542
The generated pressure mean: 0.4471581280231476
loss_pred:0.18050841987133026, decouple_loss:0.679980456829071
Iteration: 6, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4474438726902008
The generated pressure mean: 0.44655725359916687
loss_pred:0.13563260436058044, decouple_loss:0.7119258642196655
loss_pred:0.1342170685529709, decouple_loss:0.7123909592628479
The generated pressure mean: 0.4485950469970703
loss_pred:0.13475577533245087, decouple_loss:0.7078371644020081
Iteration: 7, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4493989050388336
loss_pred:0.12640094757080078, decouple_loss:0.5203319787979126
The generated pressure mean: 0.44765132665634155
loss_pred:0.12491849064826965, decouple_loss:0.5133412480354309
The generated pressure mean: 0.4475346803665161
loss_pred:0.1244414672255516, decouple_loss:0.5417329668998718
Iteration: 8, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4482206404209137
loss_pred:0.11991967260837555, decouple_loss:0.6747993230819702
The generated pressure mean: 0.4489957094192505
loss_pred:0.12680649757385254, decouple_loss:0.6752306222915649
The generated pressure mean: 0.4480845332145691
loss_pred:0.11809471249580383, decouple_loss:0.6753368377685547
Iteration: 9, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44661563634872437
loss_pred:0.11168766021728516, decouple_loss:0.6786137819290161
The generated pressure mean: 0.44748803973197937
loss_pred:0.11146970838308334, decouple_loss:0.6840260028839111
The generated pressure mean: 0.4482909142971039
loss_pred:0.11325587332248688, decouple_loss:0.6725685000419617
Iteration: 10, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4476790130138397
loss_pred:0.1064329594373703, decouple_loss:0.6626343727111816
The generated pressure mean: 0.44743645191192627
loss_pred:0.10816674679517746, decouple_loss:0.679478645324707
The generated pressure mean: 0.44865882396698
loss_pred:0.10202304273843765, decouple_loss:0.672296941280365
2023-04-16 01:25:58 testing...
The generated pressure mean: 0.4502533972263336
loss_pred:0.14927208423614502, decouple_loss:0.6472680568695068
The generated pressure mean: 0.45032480359077454
loss_pred:0.1446627676486969, decouple_loss:0.6477562189102173
The generated pressure mean: 0.45003196597099304
loss_pred:0.14568233489990234, decouple_loss:0.6504240036010742
Loss: 0.17896321415901184, avg_mse: 0.16249093413352966
current test mse: 0.162491
Iteration: 11, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44733569025993347
loss_pred:0.09820865839719772, decouple_loss:0.6515061259269714
The generated pressure mean: 0.44758981466293335
loss_pred:0.09793220460414886, decouple_loss:0.6487870812416077
The generated pressure mean: 0.4485557973384857
loss_pred:0.09446009248495102, decouple_loss:0.6512191891670227
Iteration: 12, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4471164345741272
loss_pred:0.09474998712539673, decouple_loss:0.6057071685791016
The generated pressure mean: 0.4475604295730591
loss_pred:0.0936831682920456, decouple_loss:0.609149158000946
The generated pressure mean: 0.4464261829853058
loss_pred:0.09444833546876907, decouple_loss:0.6147887110710144
Iteration: 13, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4465976357460022
loss_pred:0.09177755564451218, decouple_loss:0.5817050933837891
The generated pressure mean: 0.44746237993240356
loss_pred:0.0878027081489563, decouple_loss:0.5685651302337646
The generated pressure mean: 0.44663769006729126
loss_pred:0.08794473111629486, decouple_loss:0.5847371220588684
Iteration: 14, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4481631815433502
The generated pressure mean: 0.4467446506023407
loss_pred:0.084688201546669, decouple_loss:0.5471417903900146
loss_pred:0.08531563729047775, decouple_loss:0.5467819571495056
The generated pressure mean: 0.4474130868911743
loss_pred:0.08855502307415009, decouple_loss:0.5447489619255066
Iteration: 15, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4468247890472412
loss_pred:0.08350533246994019, decouple_loss:0.5189314484596252
The generated pressure mean: 0.4476870000362396
loss_pred:0.08524947613477707, decouple_loss:0.5180929899215698
The generated pressure mean: 0.4483969509601593
loss_pred:0.08119811117649078, decouple_loss:0.5232539772987366
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 16, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4483845829963684
loss_pred:0.08317120373249054, decouple_loss:0.4950582981109619
The generated pressure mean: 0.4477695822715759
loss_pred:0.08267109841108322, decouple_loss:0.5048328638076782
The generated pressure mean: 0.44842642545700073
loss_pred:0.08204001188278198, decouple_loss:0.49987101554870605
Iteration: 17, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4478969871997833
The generated pressure mean: 0.447483092546463
loss_pred:0.08576839417219162, decouple_loss:0.4839663803577423
loss_pred:0.0825468972325325, decouple_loss:0.4798988699913025
The generated pressure mean: 0.44701728224754333
loss_pred:0.08156666159629822, decouple_loss:0.48578929901123047
Iteration: 18, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44765621423721313
loss_pred:0.0783296599984169, decouple_loss:0.4552837014198303
The generated pressure mean: 0.4466734826564789
loss_pred:0.08219821751117706, decouple_loss:0.45781847834587097
The generated pressure mean: 0.44687309861183167
loss_pred:0.08274753391742706, decouple_loss:0.4603264033794403
Iteration: 19, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44776850938796997
loss_pred:0.07870204746723175, decouple_loss:0.44029441475868225The generated pressure mean: 0.4470946192741394
loss_pred:0.08260168880224228, decouple_loss:0.4421021640300751
The generated pressure mean: 0.4473743140697479
loss_pred:0.08206798136234283, decouple_loss:0.44172316789627075
Iteration: 20, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4467145502567291
loss_pred:0.0769701898097992, decouple_loss:0.41937240958213806
The generated pressure mean: 0.4474393427371979
loss_pred:0.07802339643239975, decouple_loss:0.42480704188346863
The generated pressure mean: 0.44660988450050354
loss_pred:0.0796651691198349, decouple_loss:0.4265650808811188
2023-04-16 01:28:04 testing...
The generated pressure mean: 0.4502691328525543
loss_pred:0.12503162026405334, decouple_loss:0.4113973081111908
The generated pressure mean: 0.45032480359077454
loss_pred:0.12207280844449997, decouple_loss:0.41239386796951294
The generated pressure mean: 0.4500313103199005
loss_pred:0.12266044318675995, decouple_loss:0.4158574342727661
Loss: 0.14391577243804932, avg_mse: 0.13873431086540222
current test mse: 0.138734
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012015_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012015_3_24hr.npz
NaN value num: 0
Iteration: 21, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4480340778827667
loss_pred:0.08240342140197754, decouple_loss:0.4113883078098297
The generated pressure mean: 0.4491499066352844
loss_pred:0.08202538639307022, decouple_loss:0.4129781424999237
The generated pressure mean: 0.4486047327518463
loss_pred:0.07805612683296204, decouple_loss:0.41245236992836
Iteration: 22, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44856250286102295
The generated pressure mean: 0.44804176688194275
loss_pred:0.08366944640874863, decouple_loss:0.3974211513996124
loss_pred:0.07928445190191269, decouple_loss:0.3952609896659851
The generated pressure mean: 0.44875821471214294
loss_pred:0.08023615926504135, decouple_loss:0.4035429358482361
Iteration: 23, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4487621486186981
loss_pred:0.08632589876651764, decouple_loss:0.3707461953163147
The generated pressure mean: 0.44687989354133606
loss_pred:0.08285684138536453, decouple_loss:0.3719637989997864
The generated pressure mean: 0.44798627495765686
loss_pred:0.08036798238754272, decouple_loss:0.37368935346603394
Iteration: 24, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4495289623737335
The generated pressure mean: 0.4477716386318207loss_pred:0.07853788882493973, decouple_loss:0.3630271852016449
loss_pred:0.08055149018764496, decouple_loss:0.36153146624565125
The generated pressure mean: 0.4497697651386261
loss_pred:0.07466283440589905, decouple_loss:0.36428317427635193
Iteration: 25, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44836506247520447
loss_pred:0.08049655705690384, decouple_loss:0.33575478196144104
The generated pressure mean: 0.4490441381931305
loss_pred:0.08352985233068466, decouple_loss:0.3489691913127899
The generated pressure mean: 0.44903549551963806
loss_pred:0.07844888418912888, decouple_loss:0.3390282988548279
Iteration: 26, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44821587204933167
loss_pred:0.0819639340043068, decouple_loss:0.33408960700035095
The generated pressure mean: 0.44593536853790283
loss_pred:0.08117472380399704, decouple_loss:0.3346155881881714
The generated pressure mean: 0.4499448537826538
loss_pred:0.07661979645490646, decouple_loss:0.3385888338088989
Iteration: 27, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4489627480506897
loss_pred:0.07630862295627594, decouple_loss:0.3253454566001892
The generated pressure mean: 0.4476751387119293
loss_pred:0.07656511664390564, decouple_loss:0.3095124363899231
The generated pressure mean: 0.44893038272857666
loss_pred:0.07794129848480225, decouple_loss:0.3171451687812805
Iteration: 28, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44860222935676575
loss_pred:0.0751332938671112, decouple_loss:0.29907065629959106
The generated pressure mean: 0.44853675365448
loss_pred:0.08536936342716217, decouple_loss:0.3065941631793976
The generated pressure mean: 0.448324978351593
loss_pred:0.07961966097354889, decouple_loss:0.3169359266757965
Iteration: 29, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44931015372276306
The generated pressure mean: 0.4483625590801239
loss_pred:0.07629397511482239, decouple_loss:0.2896631360054016
loss_pred:0.07913624495267868, decouple_loss:0.2892952263355255
The generated pressure mean: 0.4469326436519623
loss_pred:0.07446667551994324, decouple_loss:0.28174594044685364
Iteration: 30, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44624078273773193
loss_pred:0.08044375479221344, decouple_loss:0.2711345851421356
The generated pressure mean: 0.4488533139228821
loss_pred:0.07619582116603851, decouple_loss:0.27542245388031006
The generated pressure mean: 0.44856351613998413
loss_pred:0.07517826557159424, decouple_loss:0.273080974817276
2023-04-16 01:30:46 testing...
The generated pressure mean: 0.4502691626548767
loss_pred:0.12122999131679535, decouple_loss:0.28021273016929626
The generated pressure mean: 0.4503249526023865
loss_pred:0.1182878240942955, decouple_loss:0.2845925986766815
The generated pressure mean: 0.45003190636634827
loss_pred:0.11907947808504105, decouple_loss:0.2905190587043762
Loss: 0.1337878406047821, avg_mse: 0.1354820281267166
current test mse: 0.135482
Iteration: 31, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4478187561035156
loss_pred:0.07615058124065399, decouple_loss:0.2608743906021118
The generated pressure mean: 0.4494003355503082
loss_pred:0.07555918395519257, decouple_loss:0.28226420283317566
The generated pressure mean: 0.4481334686279297
loss_pred:0.0751185342669487, decouple_loss:0.28560230135917664
Iteration: 32, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44917988777160645
loss_pred:0.08318041265010834, decouple_loss:0.24876047670841217The generated pressure mean: 0.4478646516799927
loss_pred:0.07717447727918625, decouple_loss:0.24797721207141876
The generated pressure mean: 0.44747111201286316
loss_pred:0.07854221761226654, decouple_loss:0.25243163108825684
Iteration: 33, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44804129004478455
loss_pred:0.08037231862545013, decouple_loss:0.2402673214673996
The generated pressure mean: 0.4480949640274048
loss_pred:0.07416532933712006, decouple_loss:0.23764948546886444
The generated pressure mean: 0.4495970904827118
loss_pred:0.07634291797876358, decouple_loss:0.24931976199150085
Iteration: 34, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44883233308792114
loss_pred:0.0741056352853775, decouple_loss:0.2369907945394516
The generated pressure mean: 0.44772613048553467
loss_pred:0.07614406198263168, decouple_loss:0.23575016856193542
The generated pressure mean: 0.44698795676231384
loss_pred:0.07840541005134583, decouple_loss:0.22899802029132843
Iteration: 35, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4477590024471283The generated pressure mean: 0.4481362998485565
loss_pred:0.07363896816968918, decouple_loss:0.22996090352535248
loss_pred:0.07580066472291946, decouple_loss:0.2269180715084076
The generated pressure mean: 0.44879254698753357
loss_pred:0.08224169909954071, decouple_loss:0.2289084494113922
Iteration: 36, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44773805141448975
The generated pressure mean: 0.44898921251296997
loss_pred:0.07362911105155945, decouple_loss:0.21615086495876312
loss_pred:0.08265288174152374, decouple_loss:0.21988922357559204
The generated pressure mean: 0.448780357837677
loss_pred:0.07374189794063568, decouple_loss:0.21504680812358856
Iteration: 37, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44654563069343567
loss_pred:0.0754983052611351, decouple_loss:0.20130427181720734
The generated pressure mean: 0.44773635268211365
loss_pred:0.07191033661365509, decouple_loss:0.202339768409729
The generated pressure mean: 0.4465475380420685
loss_pred:0.07466299831867218, decouple_loss:0.20117174088954926
Iteration: 38, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4478972256183624
loss_pred:0.07174631953239441, decouple_loss:0.19423161447048187
The generated pressure mean: 0.44653305411338806
loss_pred:0.07596554607152939, decouple_loss:0.1975107342004776
The generated pressure mean: 0.4491286873817444
loss_pred:0.07421943545341492, decouple_loss:0.2159879058599472
Iteration: 39, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44851207733154297
loss_pred:0.07279977202415466, decouple_loss:0.24087201058864594
The generated pressure mean: 0.44819483160972595
loss_pred:0.07785121351480484, decouple_loss:0.23596632480621338
The generated pressure mean: 0.4490128457546234
loss_pred:0.07340838015079498, decouple_loss:0.24099373817443848
Iteration: 40, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44827747344970703
loss_pred:0.0811215490102768, decouple_loss:0.27602314949035645
The generated pressure mean: 0.4496093988418579
loss_pred:0.07504206150770187, decouple_loss:0.3056809902191162
The generated pressure mean: 0.44953516125679016
loss_pred:0.07185094803571701, decouple_loss:0.3084072172641754
2023-04-16 01:32:52 testing...
The generated pressure mean: 0.4502691328525543
loss_pred:0.119112029671669, decouple_loss:0.26171475648880005
The generated pressure mean: 0.4503255784511566
loss_pred:0.11629883199930191, decouple_loss:0.2597510814666748
The generated pressure mean: 0.4500320255756378
loss_pred:0.11707545816898346, decouple_loss:0.2682340741157532
Loss: 0.1306571066379547, avg_mse: 0.13333985209465027
current test mse: 0.13334
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012019_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012019_3_24hr.npz
NaN value num: 0
Iteration: 41, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4499359130859375
loss_pred:0.07648762315511703, decouple_loss:0.2630820572376251
The generated pressure mean: 0.449584037065506
loss_pred:0.07547885179519653, decouple_loss:0.27188175916671753
The generated pressure mean: 0.44943493604660034
loss_pred:0.07490371912717819, decouple_loss:0.28561338782310486
Iteration: 42, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4490392804145813
loss_pred:0.07609637826681137, decouple_loss:0.2151193618774414
The generated pressure mean: 0.4498608112335205
loss_pred:0.07339391112327576, decouple_loss:0.22687992453575134
The generated pressure mean: 0.44931456446647644
loss_pred:0.07556366175413132, decouple_loss:0.2198365181684494
Iteration: 43, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45004814863204956
loss_pred:0.07447852939367294, decouple_loss:0.22917066514492035
The generated pressure mean: 0.45080330967903137
loss_pred:0.07340387254953384, decouple_loss:0.23179695010185242
The generated pressure mean: 0.44860607385635376
loss_pred:0.07357601076364517, decouple_loss:0.22335566580295563
Iteration: 44, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44880032539367676
loss_pred:0.07380358129739761, decouple_loss:0.22669734060764313
The generated pressure mean: 0.4502469301223755
loss_pred:0.07420771569013596, decouple_loss:0.22661946713924408
The generated pressure mean: 0.4494326412677765
loss_pred:0.07343066483736038, decouple_loss:0.21914899349212646
Iteration: 45, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4505773186683655
loss_pred:0.07497771084308624, decouple_loss:0.19964911043643951
The generated pressure mean: 0.45123687386512756
loss_pred:0.07518467307090759, decouple_loss:0.20089203119277954
The generated pressure mean: 0.44894668459892273
loss_pred:0.07322470843791962, decouple_loss:0.20391054451465607
Iteration: 46, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4492054283618927
loss_pred:0.07553640007972717, decouple_loss:0.1846216470003128
The generated pressure mean: 0.4494006335735321
loss_pred:0.0753411278128624, decouple_loss:0.18558721244335175
The generated pressure mean: 0.4507611095905304
loss_pred:0.07535281777381897, decouple_loss:0.18402598798274994
Iteration: 47, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4504106044769287
The generated pressure mean: 0.44984880089759827loss_pred:0.07475408911705017, decouple_loss:0.17841485142707825
loss_pred:0.07314532995223999, decouple_loss:0.18090489506721497
The generated pressure mean: 0.4506980776786804
loss_pred:0.07417426258325577, decouple_loss:0.18094849586486816
Iteration: 48, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4502670466899872
loss_pred:0.07417980581521988, decouple_loss:0.17860963940620422
The generated pressure mean: 0.44823241233825684
loss_pred:0.0741945132613182, decouple_loss:0.17842154204845428
The generated pressure mean: 0.45023003220558167
loss_pred:0.07234276831150055, decouple_loss:0.17353390157222748
Iteration: 49, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4503536522388458
loss_pred:0.07532484084367752, decouple_loss:0.17146062850952148
The generated pressure mean: 0.45138368010520935
loss_pred:0.07469872385263443, decouple_loss:0.17350147664546967
The generated pressure mean: 0.44863155484199524
loss_pred:0.07504800707101822, decouple_loss:0.16453734040260315
Iteration: 50, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44860348105430603
loss_pred:0.07573144137859344, decouple_loss:0.15889647603034973
The generated pressure mean: 0.45086970925331116
loss_pred:0.07254979759454727, decouple_loss:0.16309677064418793
The generated pressure mean: 0.44984471797943115
loss_pred:0.07445083558559418, decouple_loss:0.16641798615455627
2023-04-16 01:35:34 testing...
The generated pressure mean: 0.4502691328525543
loss_pred:0.11819618940353394, decouple_loss:0.18499654531478882
The generated pressure mean: 0.4503248929977417
loss_pred:0.11520449072122574, decouple_loss:0.17764894664287567
The generated pressure mean: 0.45003101229667664
loss_pred:0.11611074954271317, decouple_loss:0.18332241475582123
Loss: 0.12560327351093292, avg_mse: 0.13236039876937866
current test mse: 0.13236
Iteration: 51, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4513985216617584
loss_pred:0.07314497232437134, decouple_loss:0.16208359599113464
The generated pressure mean: 0.45026612281799316
The generated pressure mean: 0.44975802302360535loss_pred:0.07249154895544052, decouple_loss:0.15714043378829956
loss_pred:0.07266958057880402, decouple_loss:0.15913055837154388
Iteration: 52, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4498406946659088
loss_pred:0.07148197293281555, decouple_loss:0.15873751044273376
The generated pressure mean: 0.44969186186790466
loss_pred:0.0738368108868599, decouple_loss:0.15558801591396332
The generated pressure mean: 0.4500598609447479
loss_pred:0.07338792830705643, decouple_loss:0.15177150070667267
Iteration: 53, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4498598873615265
loss_pred:0.07283322513103485, decouple_loss:0.1538214087486267
The generated pressure mean: 0.44951316714286804
The generated pressure mean: 0.4494919180870056
loss_pred:0.0743851587176323, decouple_loss:0.1547843962907791
loss_pred:0.07422787696123123, decouple_loss:0.15059921145439148
Iteration: 54, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4497770369052887
The generated pressure mean: 0.44916149973869324
loss_pred:0.07334867864847183, decouple_loss:0.14104239642620087
loss_pred:0.07430031895637512, decouple_loss:0.1406271606683731
The generated pressure mean: 0.45022475719451904
loss_pred:0.07286036014556885, decouple_loss:0.14180730283260345
Iteration: 55, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44961169362068176
loss_pred:0.07380665838718414, decouple_loss:0.1380130797624588
The generated pressure mean: 0.4507124722003937
loss_pred:0.07363005727529526, decouple_loss:0.149403914809227
The generated pressure mean: 0.4506840705871582
loss_pred:0.07170096784830093, decouple_loss:0.14981187880039215
Iteration: 56, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4489428400993347
The generated pressure mean: 0.44896748661994934
loss_pred:0.07339944690465927, decouple_loss:0.12904368340969086
loss_pred:0.07054212689399719, decouple_loss:0.12943924963474274
The generated pressure mean: 0.4498118460178375
loss_pred:0.0718654915690422, decouple_loss:0.13353347778320312
Iteration: 57, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4497709274291992
The generated pressure mean: 0.4503611922264099loss_pred:0.07398667931556702, decouple_loss:0.13163815438747406
loss_pred:0.07228567451238632, decouple_loss:0.12613430619239807
The generated pressure mean: 0.45064476132392883
loss_pred:0.07164934277534485, decouple_loss:0.12858711183071136
Iteration: 58, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4490869343280792
The generated pressure mean: 0.4514801502227783loss_pred:0.07320506125688553, decouple_loss:0.1284172683954239
loss_pred:0.07138561457395554, decouple_loss:0.12377908825874329
The generated pressure mean: 0.4509597718715668
loss_pred:0.07043497264385223, decouple_loss:0.1232871264219284
Iteration: 59, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45115968585014343The generated pressure mean: 0.4500076472759247
loss_pred:0.07087276130914688, decouple_loss:0.12066047638654709
loss_pred:0.06973867863416672, decouple_loss:0.11546166986227036
The generated pressure mean: 0.4485468566417694
loss_pred:0.07206816226243973, decouple_loss:0.119222491979599
Iteration: 60, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.449602335691452
loss_pred:0.0712338462471962, decouple_loss:0.11474385857582092
The generated pressure mean: 0.44976985454559326
loss_pred:0.07326436042785645, decouple_loss:0.11929280310869217
The generated pressure mean: 0.4491811990737915
loss_pred:0.07222973555326462, decouple_loss:0.12809184193611145
2023-04-16 01:37:39 testing...
The generated pressure mean: 0.4502691328525543
loss_pred:0.11767616122961044, decouple_loss:0.1499740034341812
The generated pressure mean: 0.4503248929977417
loss_pred:0.11469210684299469, decouple_loss:0.14579936861991882
The generated pressure mean: 0.45003122091293335
loss_pred:0.11573144048452377, decouple_loss:0.1557670384645462
Loss: 0.12355892360210419, avg_mse: 0.13188597559928894
current test mse: 0.131886
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012013_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012013_3_24hr.npz
NaN value num: 0
Iteration: 61, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4493536651134491
loss_pred:0.07271197438240051, decouple_loss:0.12293117493391037
The generated pressure mean: 0.4479830861091614
loss_pred:0.07164409011602402, decouple_loss:0.1278458684682846
The generated pressure mean: 0.4494664669036865
loss_pred:0.06949703395366669, decouple_loss:0.13640505075454712
Iteration: 62, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4485692083835602
loss_pred:0.07116159796714783, decouple_loss:0.11496558785438538
The generated pressure mean: 0.4485663175582886
loss_pred:0.0700984001159668, decouple_loss:0.11555086821317673
The generated pressure mean: 0.44845524430274963
loss_pred:0.07338644564151764, decouple_loss:0.12491718679666519
Iteration: 63, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.448471337556839
loss_pred:0.06872042268514633, decouple_loss:0.11176050454378128
The generated pressure mean: 0.44834229350090027
loss_pred:0.0720532163977623, decouple_loss:0.1135052815079689
The generated pressure mean: 0.4483647048473358
loss_pred:0.07311772555112839, decouple_loss:0.12028908729553223
Iteration: 64, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44857245683670044
loss_pred:0.07139721512794495, decouple_loss:0.11522579193115234
The generated pressure mean: 0.447274774312973
loss_pred:0.0698719322681427, decouple_loss:0.10990925878286362
The generated pressure mean: 0.44847372174263
loss_pred:0.06832687556743622, decouple_loss:0.1124369204044342
Iteration: 65, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44865882396698
loss_pred:0.07007195800542831, decouple_loss:0.12398902326822281
The generated pressure mean: 0.4470958113670349
loss_pred:0.07270190119743347, decouple_loss:0.11583295464515686
The generated pressure mean: 0.44820454716682434
loss_pred:0.07146044075489044, decouple_loss:0.10707146674394608
Iteration: 66, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4486209750175476
loss_pred:0.07468676567077637, decouple_loss:0.10582014173269272
The generated pressure mean: 0.4494900703430176
loss_pred:0.06912483274936676, decouple_loss:0.10514092445373535
The generated pressure mean: 0.44871044158935547
loss_pred:0.07116178423166275, decouple_loss:0.10547824203968048
Iteration: 67, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4477456212043762
loss_pred:0.07169164717197418, decouple_loss:0.10488495230674744
The generated pressure mean: 0.44804513454437256
loss_pred:0.07280367612838745, decouple_loss:0.10568394511938095
The generated pressure mean: 0.4487643837928772
loss_pred:0.0677688866853714, decouple_loss:0.10834021866321564
Iteration: 68, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4474984407424927
loss_pred:0.07058606296777725, decouple_loss:0.09754534810781479
The generated pressure mean: 0.44708868861198425
loss_pred:0.07110458612442017, decouple_loss:0.10563001781702042
The generated pressure mean: 0.44686973094940186
loss_pred:0.07186084240674973, decouple_loss:0.0991077870130539
Iteration: 69, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.447687566280365
loss_pred:0.07159050554037094, decouple_loss:0.09992920607328415
The generated pressure mean: 0.44784489274024963
loss_pred:0.06991478055715561, decouple_loss:0.1043623611330986
The generated pressure mean: 0.44933658838272095
loss_pred:0.0681823119521141, decouple_loss:0.10389203578233719
Iteration: 70, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4487364590167999
loss_pred:0.0679822564125061, decouple_loss:0.09421957284212112
The generated pressure mean: 0.44896307587623596
loss_pred:0.06958748400211334, decouple_loss:0.09454862773418427
The generated pressure mean: 0.4476200342178345
loss_pred:0.07082930207252502, decouple_loss:0.0965764969587326
2023-04-16 01:40:28 testing...
The generated pressure mean: 0.4502691626548767
loss_pred:0.11656464636325836, decouple_loss:0.11817200481891632
The generated pressure mean: 0.45032477378845215
loss_pred:0.11375206708908081, decouple_loss:0.11578015983104706
The generated pressure mean: 0.4500310719013214
loss_pred:0.1150675117969513, decouple_loss:0.11968470364809036
Loss: 0.12102203071117401, avg_mse: 0.1311996579170227
current test mse: 0.1312
Iteration: 71, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44911110401153564
loss_pred:0.07072224467992783, decouple_loss:0.09169318526983261
The generated pressure mean: 0.4471234977245331
loss_pred:0.07019183784723282, decouple_loss:0.09633318334817886
The generated pressure mean: 0.44800081849098206
loss_pred:0.07081147283315659, decouple_loss:0.09570366889238358
Iteration: 72, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44808170199394226
The generated pressure mean: 0.4473528265953064
loss_pred:0.06723351031541824, decouple_loss:0.09208111464977264
loss_pred:0.07035215198993683, decouple_loss:0.09247550368309021
The generated pressure mean: 0.44842034578323364
loss_pred:0.06954874843358994, decouple_loss:0.08964639902114868
Iteration: 73, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4480317234992981
loss_pred:0.07128193229436874, decouple_loss:0.09657212346792221
The generated pressure mean: 0.44789591431617737
loss_pred:0.06981721520423889, decouple_loss:0.09285742044448853
The generated pressure mean: 0.44783204793930054
loss_pred:0.0708388239145279, decouple_loss:0.09001123905181885
Iteration: 74, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4474875330924988
loss_pred:0.06984568387269974, decouple_loss:0.09124627709388733
The generated pressure mean: 0.4480403959751129
loss_pred:0.07135958969593048, decouple_loss:0.09109766781330109
The generated pressure mean: 0.44729286432266235
loss_pred:0.06995315849781036, decouple_loss:0.09069918096065521
Iteration: 75, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44766008853912354
loss_pred:0.0710846334695816, decouple_loss:0.08667314797639847
The generated pressure mean: 0.44766780734062195
loss_pred:0.07170865684747696, decouple_loss:0.08381745219230652
The generated pressure mean: 0.44685810804367065
loss_pred:0.06808266788721085, decouple_loss:0.0880279541015625
Iteration: 76, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4472021758556366
loss_pred:0.06639214605093002, decouple_loss:0.08917422592639923
The generated pressure mean: 0.44788482785224915
loss_pred:0.0726853683590889, decouple_loss:0.08360506594181061
The generated pressure mean: 0.44781407713890076
loss_pred:0.0705779418349266, decouple_loss:0.08803031593561172
Iteration: 77, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4490562677383423
loss_pred:0.06868357211351395, decouple_loss:0.08465925604104996
The generated pressure mean: 0.44684505462646484
loss_pred:0.06870661675930023, decouple_loss:0.08356187492609024
The generated pressure mean: 0.4480205178260803
loss_pred:0.06957238912582397, decouple_loss:0.0833938866853714
Iteration: 78, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44927793741226196
loss_pred:0.06833188235759735, decouple_loss:0.0855521485209465
The generated pressure mean: 0.4488729238510132
loss_pred:0.06670980155467987, decouple_loss:0.09703246504068375
The generated pressure mean: 0.4476626217365265
loss_pred:0.07119998335838318, decouple_loss:0.08275126665830612
Iteration: 79, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4473901689052582
loss_pred:0.06968395411968231, decouple_loss:0.07767976075410843
The generated pressure mean: 0.44810205698013306
loss_pred:0.06993360817432404, decouple_loss:0.07798600196838379
The generated pressure mean: 0.4477848410606384
loss_pred:0.06875715404748917, decouple_loss:0.07890422642230988
Iteration: 80, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4483296573162079
loss_pred:0.06929449737071991, decouple_loss:0.07534263283014297
The generated pressure mean: 0.44749587774276733
loss_pred:0.0692976638674736, decouple_loss:0.07609090954065323
The generated pressure mean: 0.44741493463516235
loss_pred:0.06860743463039398, decouple_loss:0.07622809708118439
2023-04-16 01:42:34 testing...
The generated pressure mean: 0.4502691924571991
loss_pred:0.1150168851017952, decouple_loss:0.1099713146686554
The generated pressure mean: 0.4503248333930969
loss_pred:0.11271648108959198, decouple_loss:0.1088278517127037
The generated pressure mean: 0.450031578540802
loss_pred:0.11414843052625656, decouple_loss:0.11280226707458496
Loss: 0.11948728561401367, avg_mse: 0.13003309071063995
current test mse: 0.130033
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012017_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012017_3_24hr.npz
NaN value num: 0
Iteration: 81, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44858285784721375
loss_pred:0.06523677706718445, decouple_loss:0.07868658751249313
The generated pressure mean: 0.4484122693538666
loss_pred:0.06816021353006363, decouple_loss:0.07968058437108994
The generated pressure mean: 0.448492169380188
loss_pred:0.06560739129781723, decouple_loss:0.07794330269098282
Iteration: 82, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44843077659606934
loss_pred:0.0679367259144783, decouple_loss:0.07503604888916016
The generated pressure mean: 0.44910457730293274
loss_pred:0.06559616327285767, decouple_loss:0.07552320510149002
The generated pressure mean: 0.44840380549430847
loss_pred:0.06773959845304489, decouple_loss:0.07490597665309906
Iteration: 83, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4478759765625
The generated pressure mean: 0.44877997040748596
loss_pred:0.06874821335077286, decouple_loss:0.0780595913529396
loss_pred:0.06858561187982559, decouple_loss:0.07535567879676819
The generated pressure mean: 0.44929662346839905
loss_pred:0.06686197966337204, decouple_loss:0.07678001374006271
Iteration: 84, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44878801703453064
loss_pred:0.0663197711110115, decouple_loss:0.07127930223941803
The generated pressure mean: 0.4486965835094452
loss_pred:0.06813506036996841, decouple_loss:0.0755843073129654
The generated pressure mean: 0.4487365484237671
loss_pred:0.06815356761217117, decouple_loss:0.07516416162252426
Iteration: 85, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4486357569694519
The generated pressure mean: 0.4485947787761688
loss_pred:0.06707088649272919, decouple_loss:0.07648072391748428
loss_pred:0.06648460030555725, decouple_loss:0.07687044888734818
The generated pressure mean: 0.44790810346603394
loss_pred:0.06419620662927628, decouple_loss:0.07786428928375244
Iteration: 86, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44836124777793884
loss_pred:0.06913851201534271, decouple_loss:0.07259313017129898
The generated pressure mean: 0.44842860102653503
loss_pred:0.06728894263505936, decouple_loss:0.0735388919711113
The generated pressure mean: 0.4480375051498413
loss_pred:0.06471586227416992, decouple_loss:0.0707327201962471
Iteration: 87, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4483840763568878
loss_pred:0.06583569943904877, decouple_loss:0.07004305720329285
The generated pressure mean: 0.44855108857154846
loss_pred:0.06234392896294594, decouple_loss:0.0692049041390419
The generated pressure mean: 0.4473387897014618
loss_pred:0.06341397017240524, decouple_loss:0.06926087290048599
Iteration: 88, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44902074337005615
loss_pred:0.06165337935090065, decouple_loss:0.06626007705926895
The generated pressure mean: 0.44848692417144775
loss_pred:0.0650537982583046, decouple_loss:0.06446292996406555
The generated pressure mean: 0.44859766960144043
loss_pred:0.06764516979455948, decouple_loss:0.06628548353910446
Iteration: 89, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44873860478401184
loss_pred:0.06446892023086548, decouple_loss:0.06614038348197937
The generated pressure mean: 0.448665589094162
loss_pred:0.0671192854642868, decouple_loss:0.06647524982690811
The generated pressure mean: 0.44879820942878723
loss_pred:0.0643782764673233, decouple_loss:0.06648032367229462
Iteration: 90, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44798609614372253
loss_pred:0.061530791223049164, decouple_loss:0.06529399752616882
The generated pressure mean: 0.44757694005966187
loss_pred:0.06443460285663605, decouple_loss:0.06599735468626022
The generated pressure mean: 0.44714483618736267
loss_pred:0.06762032955884933, decouple_loss:0.06679702550172806
2023-04-16 01:45:18 testing...
The generated pressure mean: 0.4502691626548767
loss_pred:0.11406762897968292, decouple_loss:0.09766193479299545
The generated pressure mean: 0.45032501220703125
loss_pred:0.11231925338506699, decouple_loss:0.0973389744758606
The generated pressure mean: 0.45003119111061096
loss_pred:0.11430105566978455, decouple_loss:0.10334007441997528
Loss: 0.11853500455617905, avg_mse: 0.13052575290203094
current test mse: 0.130526
Iteration: 91, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44945454597473145
The generated pressure mean: 0.44832465052604675
loss_pred:0.06540084630250931, decouple_loss:0.06572386622428894
loss_pred:0.06578799337148666, decouple_loss:0.06839322298765182
The generated pressure mean: 0.449481725692749
loss_pred:0.06532503664493561, decouple_loss:0.0658005103468895
Iteration: 92, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4492071568965912
loss_pred:0.06357231736183167, decouple_loss:0.06749051809310913
The generated pressure mean: 0.44674089550971985
loss_pred:0.06644444912672043, decouple_loss:0.06865371018648148
The generated pressure mean: 0.447496235370636
loss_pred:0.06216577813029289, decouple_loss:0.07113633304834366
Iteration: 93, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44889628887176514
loss_pred:0.06385912001132965, decouple_loss:0.06416940689086914
The generated pressure mean: 0.44772541522979736
loss_pred:0.06395874172449112, decouple_loss:0.06292438507080078
The generated pressure mean: 0.44760581851005554
loss_pred:0.06132757291197777, decouple_loss:0.06471940875053406
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 94, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44881904125213623
loss_pred:0.06458590924739838, decouple_loss:0.06087251752614975
The generated pressure mean: 0.4479328393936157
loss_pred:0.06549719721078873, decouple_loss:0.06281239539384842
The generated pressure mean: 0.448813259601593
loss_pred:0.06230373680591583, decouple_loss:0.06000872701406479
Iteration: 95, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4485292434692383
loss_pred:0.062095578759908676, decouple_loss:0.05936282500624657
The generated pressure mean: 0.4479807913303375
loss_pred:0.06325337290763855, decouple_loss:0.06130170449614525
The generated pressure mean: 0.4484293758869171
loss_pred:0.06388943642377853, decouple_loss:0.05921570584177971
Iteration: 96, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44819507002830505
loss_pred:0.06286365538835526, decouple_loss:0.05990491434931755
The generated pressure mean: 0.4493652582168579
loss_pred:0.06384328752756119, decouple_loss:0.061104804277420044
The generated pressure mean: 0.44810035824775696
loss_pred:0.062013864517211914, decouple_loss:0.058635059744119644
Iteration: 97, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4469468295574188
loss_pred:0.06235704943537712, decouple_loss:0.06253200024366379
The generated pressure mean: 0.4486903250217438
loss_pred:0.06352967023849487, decouple_loss:0.062308430671691895
The generated pressure mean: 0.44885188341140747
loss_pred:0.06428777426481247, decouple_loss:0.06552349776029587
Iteration: 98, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44839659333229065
loss_pred:0.061162225902080536, decouple_loss:0.06063669174909592
The generated pressure mean: 0.44888201355934143
loss_pred:0.0593738816678524, decouple_loss:0.06189420074224472
The generated pressure mean: 0.4481974244117737
loss_pred:0.06234468147158623, decouple_loss:0.05877595394849777
Iteration: 99, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44867926836013794
loss_pred:0.06383052468299866, decouple_loss:0.06073116511106491
The generated pressure mean: 0.4480273425579071
loss_pred:0.06366781890392303, decouple_loss:0.06115654483437538
The generated pressure mean: 0.4493323564529419
loss_pred:0.06258096545934677, decouple_loss:0.06158307194709778
Iteration: 100, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4483872652053833
loss_pred:0.06428376585245132, decouple_loss:0.06775053590536118
The generated pressure mean: 0.44780611991882324
loss_pred:0.06491929292678833, decouple_loss:0.0674685463309288
The generated pressure mean: 0.4493613839149475
loss_pred:0.0642760768532753, decouple_loss:0.06727977097034454
2023-04-16 01:47:24 testing...
The generated pressure mean: 0.4502691328525543
loss_pred:0.11277392506599426, decouple_loss:0.08512279391288757
The generated pressure mean: 0.4503248631954193
loss_pred:0.11122198402881622, decouple_loss:0.08651749044656754
The generated pressure mean: 0.4500313103199005
loss_pred:0.1135842353105545, decouple_loss:0.08998142182826996
Loss: 0.11688707768917084, avg_mse: 0.1291102021932602
current test mse: 0.12911
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012015_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012015_3_24hr.npz
NaN value num: 0
Iteration: 101, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44749853014945984
loss_pred:0.06286335736513138, decouple_loss:0.05942424759268761
The generated pressure mean: 0.446227103471756
loss_pred:0.05938698723912239, decouple_loss:0.05731014162302017
The generated pressure mean: 0.4477177858352661
loss_pred:0.061897724866867065, decouple_loss:0.05748579278588295
Iteration: 102, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44762811064720154
loss_pred:0.0671139508485794, decouple_loss:0.07091247290372849
The generated pressure mean: 0.4464041590690613
loss_pred:0.06389486789703369, decouple_loss:0.0692567229270935
The generated pressure mean: 0.4454922080039978
loss_pred:0.06428886950016022, decouple_loss:0.07172133028507233
Iteration: 103, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44819754362106323
The generated pressure mean: 0.4470965266227722
loss_pred:0.06535416096448898, decouple_loss:0.06614847481250763
loss_pred:0.060341641306877136, decouple_loss:0.07151766866445541
The generated pressure mean: 0.44636839628219604
loss_pred:0.06250938028097153, decouple_loss:0.06956692039966583
Iteration: 104, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4478299915790558
loss_pred:0.063511922955513, decouple_loss:0.06006840616464615
The generated pressure mean: 0.446453332901001
loss_pred:0.060398686677217484, decouple_loss:0.061715997755527496
The generated pressure mean: 0.44613951444625854
loss_pred:0.06051025167107582, decouple_loss:0.06314562261104584
Iteration: 105, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.446992427110672
loss_pred:0.06204996630549431, decouple_loss:0.06699147820472717
The generated pressure mean: 0.44712960720062256
loss_pred:0.06125776469707489, decouple_loss:0.06469251960515976
The generated pressure mean: 0.4471711814403534
loss_pred:0.06124483793973923, decouple_loss:0.06815589219331741
Iteration: 106, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4485379159450531
loss_pred:0.0641326978802681, decouple_loss:0.06726261973381042
The generated pressure mean: 0.44704943895339966
loss_pred:0.06542637199163437, decouple_loss:0.06856115162372589
The generated pressure mean: 0.44761714339256287
loss_pred:0.06427962332963943, decouple_loss:0.06677039712667465
Iteration: 107, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4474088251590729
loss_pred:0.0608537457883358, decouple_loss:0.05937284603714943
The generated pressure mean: 0.44476318359375
loss_pred:0.060940444469451904, decouple_loss:0.059099387377500534
The generated pressure mean: 0.44604989886283875
loss_pred:0.06194524094462395, decouple_loss:0.06155950948596001
Iteration: 108, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4482231140136719
The generated pressure mean: 0.44795945286750793loss_pred:0.06215234100818634, decouple_loss:0.05862037092447281
loss_pred:0.06474652886390686, decouple_loss:0.06290232390165329
The generated pressure mean: 0.4467504918575287
loss_pred:0.06077354773879051, decouple_loss:0.05939008668065071
Iteration: 109, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44728660583496094
loss_pred:0.060277000069618225, decouple_loss:0.05636944994330406
The generated pressure mean: 0.44780170917510986
loss_pred:0.06236827000975609, decouple_loss:0.05827798694372177
The generated pressure mean: 0.4466732442378998
loss_pred:0.06193351373076439, decouple_loss:0.05644799768924713
Iteration: 110, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4462677538394928
The generated pressure mean: 0.44615545868873596
loss_pred:0.06031998619437218, decouple_loss:0.05609207972884178
loss_pred:0.060139574110507965, decouple_loss:0.05942979082465172
The generated pressure mean: 0.4469018578529358
loss_pred:0.05982634797692299, decouple_loss:0.059036727994680405
2023-04-16 01:50:04 testing...
The generated pressure mean: 0.4502691924571991
loss_pred:0.11199495196342468, decouple_loss:0.08078915625810623
The generated pressure mean: 0.4503248631954193
loss_pred:0.11037034541368484, decouple_loss:0.08399073034524918
The generated pressure mean: 0.45003125071525574
loss_pred:0.11280491203069687, decouple_loss:0.08474070578813553
Loss: 0.11588208377361298, avg_mse: 0.1279393583536148
current test mse: 0.127939
Iteration: 111, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4477279782295227
The generated pressure mean: 0.4464344084262848
loss_pred:0.059991493821144104, decouple_loss:0.053234949707984924
The generated pressure mean: 0.4467552602291107
loss_pred:0.05746334418654442, decouple_loss:0.055158715695142746
loss_pred:0.058413054794073105, decouple_loss:0.05387795716524124
Iteration: 112, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44738873839378357
loss_pred:0.05874757468700409, decouple_loss:0.055741846561431885
The generated pressure mean: 0.446942001581192
loss_pred:0.06203318014740944, decouple_loss:0.05454963818192482
The generated pressure mean: 0.447233647108078
loss_pred:0.0604398250579834, decouple_loss:0.05671212822198868
Iteration: 113, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4465327262878418
loss_pred:0.05687124654650688, decouple_loss:0.055252838879823685
The generated pressure mean: 0.4471761882305145
loss_pred:0.06020544841885567, decouple_loss:0.054496508091688156
The generated pressure mean: 0.44701728224754333
loss_pred:0.05985844507813454, decouple_loss:0.05587449669837952
Iteration: 114, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4464988708496094
loss_pred:0.05735870823264122, decouple_loss:0.05078789219260216
The generated pressure mean: 0.44710415601730347
loss_pred:0.05996428057551384, decouple_loss:0.051819946616888046
The generated pressure mean: 0.4470762014389038
loss_pred:0.05848505720496178, decouple_loss:0.051896221935749054
Iteration: 115, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44723278284072876
loss_pred:0.05951506644487381, decouple_loss:0.05355539545416832
The generated pressure mean: 0.44656890630722046
loss_pred:0.06335040926933289, decouple_loss:0.05310041829943657
The generated pressure mean: 0.4460415244102478
loss_pred:0.05845978856086731, decouple_loss:0.052999868988990784
Iteration: 116, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4464873671531677
The generated pressure mean: 0.44574621319770813
loss_pred:0.058291856199502945, decouple_loss:0.05174349620938301
loss_pred:0.05688021704554558, decouple_loss:0.054068781435489655
The generated pressure mean: 0.44763845205307007
loss_pred:0.05845339968800545, decouple_loss:0.05370419844985008
Iteration: 117, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44713515043258667
The generated pressure mean: 0.44773390889167786
loss_pred:0.05888941138982773, decouple_loss:0.05174560099840164
loss_pred:0.061099469661712646, decouple_loss:0.05171346664428711
The generated pressure mean: 0.44762542843818665
loss_pred:0.058541957288980484, decouple_loss:0.04995635151863098
Iteration: 118, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44758957624435425
loss_pred:0.06005334481596947, decouple_loss:0.04921574145555496
The generated pressure mean: 0.44736793637275696
loss_pred:0.05861547216773033, decouple_loss:0.052085988223552704
The generated pressure mean: 0.4462108612060547
loss_pred:0.056486181914806366, decouple_loss:0.05136289820075035
Iteration: 119, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44732969999313354
loss_pred:0.059911731630563736, decouple_loss:0.053752269595861435
The generated pressure mean: 0.4476431608200073
loss_pred:0.05994835123419762, decouple_loss:0.051997121423482895
The generated pressure mean: 0.44687575101852417
loss_pred:0.05989392101764679, decouple_loss:0.053306739777326584
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 120, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4477517604827881
loss_pred:0.060684334486722946, decouple_loss:0.04788410663604736
The generated pressure mean: 0.4475364685058594
loss_pred:0.06127049773931503, decouple_loss:0.05048533156514168
The generated pressure mean: 0.44772869348526
loss_pred:0.05731358379125595, decouple_loss:0.05024927482008934
2023-04-16 01:52:10 testing...
The generated pressure mean: 0.4502691924571991
loss_pred:0.11014123260974884, decouple_loss:0.07425563037395477
The generated pressure mean: 0.4503248929977417
loss_pred:0.10910636186599731, decouple_loss:0.0785752385854721
The generated pressure mean: 0.45003142952919006
loss_pred:0.1114393100142479, decouple_loss:0.07952996343374252
Loss: 0.11410164833068848, avg_mse: 0.1263025552034378
current test mse: 0.126303
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012016_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012016_3_24hr.npz
NaN value num: 0
Iteration: 121, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44753706455230713
loss_pred:0.05872514471411705, decouple_loss:0.05426103249192238
The generated pressure mean: 0.44889092445373535
loss_pred:0.06401827186346054, decouple_loss:0.05675353854894638
The generated pressure mean: 0.448116272687912
loss_pred:0.06006595119833946, decouple_loss:0.05653975531458855
Iteration: 122, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4481247663497925
loss_pred:0.061590131372213364, decouple_loss:0.05282247066497803
The generated pressure mean: 0.4488201141357422
loss_pred:0.06204356625676155, decouple_loss:0.054039366543293
The generated pressure mean: 0.4478538930416107
loss_pred:0.05896405503153801, decouple_loss:0.05573534220457077
Iteration: 123, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4483509063720703
loss_pred:0.06412624567747116, decouple_loss:0.0519380085170269
The generated pressure mean: 0.44724178314208984
loss_pred:0.05911145359277725, decouple_loss:0.051819831132888794
The generated pressure mean: 0.4474587142467499
loss_pred:0.061872806400060654, decouple_loss:0.051882367581129074
Iteration: 124, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4476088881492615The generated pressure mean: 0.44902509450912476
loss_pred:0.05874117091298103, decouple_loss:0.05554958060383797
loss_pred:0.0613461509346962, decouple_loss:0.057389672845602036
The generated pressure mean: 0.4472382366657257
loss_pred:0.05954356491565704, decouple_loss:0.05661162734031677
Iteration: 125, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.447492390871048
loss_pred:0.060523323714733124, decouple_loss:0.05187024176120758
The generated pressure mean: 0.448708713054657
loss_pred:0.06079740822315216, decouple_loss:0.05145201459527016
The generated pressure mean: 0.44858309626579285
loss_pred:0.06213441863656044, decouple_loss:0.04979263246059418
Iteration: 126, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44998738169670105
The generated pressure mean: 0.4482267200946808
loss_pred:0.06069210171699524, decouple_loss:0.05662169307470322
loss_pred:0.06341636180877686, decouple_loss:0.04918641224503517
The generated pressure mean: 0.44792529940605164
loss_pred:0.06075866520404816, decouple_loss:0.048815496265888214
Iteration: 127, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4491916298866272The generated pressure mean: 0.44909173250198364
loss_pred:0.0607667900621891, decouple_loss:0.04799283668398857
loss_pred:0.059072379022836685, decouple_loss:0.05021170526742935
The generated pressure mean: 0.44781187176704407
loss_pred:0.06012652441859245, decouple_loss:0.048427764326334
Iteration: 128, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44693222641944885
loss_pred:0.06016344949603081, decouple_loss:0.04620542749762535
The generated pressure mean: 0.44820737838745117
loss_pred:0.06292363256216049, decouple_loss:0.04863381385803223
The generated pressure mean: 0.44982171058654785
loss_pred:0.06045234203338623, decouple_loss:0.05069420859217644
Iteration: 129, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44725269079208374
loss_pred:0.05944279953837395, decouple_loss:0.04977724328637123
The generated pressure mean: 0.44719499349594116
loss_pred:0.06532448530197144, decouple_loss:0.04753423482179642
The generated pressure mean: 0.4488794505596161
loss_pred:0.06096263229846954, decouple_loss:0.048475027084350586
Iteration: 130, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4482957422733307
loss_pred:0.06001807376742363, decouple_loss:0.04862305894494057
The generated pressure mean: 0.44795387983322144
loss_pred:0.05912036448717117, decouple_loss:0.0471947081387043
The generated pressure mean: 0.44717544317245483
loss_pred:0.059043921530246735, decouple_loss:0.04529259353876114
2023-04-16 01:54:54 testing...
The generated pressure mean: 0.4502691626548767
loss_pred:0.10891012847423553, decouple_loss:0.06933807581663132
The generated pressure mean: 0.45032480359077454
loss_pred:0.10777976363897324, decouple_loss:0.07296532392501831
The generated pressure mean: 0.4500315487384796
loss_pred:0.10951899737119675, decouple_loss:0.07372236251831055
Loss: 0.11233672499656677, avg_mse: 0.1250257045030594
current test mse: 0.125026
Iteration: 131, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4485553205013275
loss_pred:0.05939667299389839, decouple_loss:0.045452482998371124
The generated pressure mean: 0.4475228190422058
loss_pred:0.05785910040140152, decouple_loss:0.04744536057114601
The generated pressure mean: 0.4474503993988037
loss_pred:0.057639505714178085, decouple_loss:0.0479363352060318
Iteration: 132, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4470408260822296
loss_pred:0.058790676295757294, decouple_loss:0.049504395574331284
The generated pressure mean: 0.4477348327636719
The generated pressure mean: 0.4471331834793091
loss_pred:0.058084603399038315, decouple_loss:0.05115700140595436
loss_pred:0.06124149262905121, decouple_loss:0.0485658161342144
Iteration: 133, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4481678605079651
The generated pressure mean: 0.44750165939331055
loss_pred:0.06009066477417946, decouple_loss:0.04468797892332077
loss_pred:0.05926666408777237, decouple_loss:0.044482894241809845
The generated pressure mean: 0.44820377230644226
loss_pred:0.059857077896595, decouple_loss:0.04525897279381752
Iteration: 134, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44686564803123474
The generated pressure mean: 0.44709131121635437
loss_pred:0.05795377120375633, decouple_loss:0.04856736585497856
loss_pred:0.058213915675878525, decouple_loss:0.047366850078105927
The generated pressure mean: 0.44819939136505127
loss_pred:0.06158957630395889, decouple_loss:0.05102512985467911
Iteration: 135, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4469155967235565
loss_pred:0.05663258954882622, decouple_loss:0.04569868743419647
The generated pressure mean: 0.44762659072875977
loss_pred:0.060005687177181244, decouple_loss:0.04356764256954193
The generated pressure mean: 0.44737520813941956
loss_pred:0.060274988412857056, decouple_loss:0.04481104016304016
Iteration: 136, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.449589341878891
The generated pressure mean: 0.4490673542022705
loss_pred:0.06084711104631424, decouple_loss:0.052420105785131454
loss_pred:0.060552507638931274, decouple_loss:0.04304191842675209
The generated pressure mean: 0.44833922386169434
loss_pred:0.06260338425636292, decouple_loss:0.04594491794705391
Iteration: 137, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.447442889213562
The generated pressure mean: 0.44815629720687866
loss_pred:0.06386592239141464, decouple_loss:0.050882723182439804
loss_pred:0.060967229306697845, decouple_loss:0.04629713296890259
The generated pressure mean: 0.44859063625335693
loss_pred:0.06049080565571785, decouple_loss:0.047189872711896896
Iteration: 138, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44762206077575684
loss_pred:0.059550199657678604, decouple_loss:0.047547124326229095
The generated pressure mean: 0.44743260741233826
loss_pred:0.057326432317495346, decouple_loss:0.04885152727365494
The generated pressure mean: 0.4474824368953705
loss_pred:0.057344574481248856, decouple_loss:0.046978432685136795
Iteration: 139, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44705429673194885
loss_pred:0.05966466665267944, decouple_loss:0.05098685622215271
The generated pressure mean: 0.44805827736854553
loss_pred:0.05979425460100174, decouple_loss:0.04953216388821602
The generated pressure mean: 0.44807887077331543
loss_pred:0.05802961066365242, decouple_loss:0.047651004046201706
Iteration: 140, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4501817524433136
loss_pred:0.05977630987763405, decouple_loss:0.04799672216176987
The generated pressure mean: 0.44747161865234375
loss_pred:0.06002824008464813, decouple_loss:0.047960780560970306
The generated pressure mean: 0.44899749755859375
loss_pred:0.06083843857049942, decouple_loss:0.047606587409973145
2023-04-16 01:56:59 testing...
The generated pressure mean: 0.4502691924571991
loss_pred:0.10834892094135284, decouple_loss:0.07256747037172318
The generated pressure mean: 0.4503246247768402
loss_pred:0.10600748658180237, decouple_loss:0.07603371888399124
The generated pressure mean: 0.45003142952919006
loss_pred:0.10731827467679977, decouple_loss:0.07607685774564743
Loss: 0.11096952855587006, avg_mse: 0.12273568660020828
current test mse: 0.122736
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012006_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012006_3_24hr.npz
NaN value num: 0
Iteration: 141, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4473281800746918
loss_pred:0.058293092995882034, decouple_loss:0.04599016532301903
The generated pressure mean: 0.44912588596343994
loss_pred:0.059527721256017685, decouple_loss:0.046013735234737396
The generated pressure mean: 0.4474667012691498
loss_pred:0.05798070877790451, decouple_loss:0.05051024630665779
Iteration: 142, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44785076379776
loss_pred:0.0590677410364151, decouple_loss:0.04771355539560318
The generated pressure mean: 0.44881150126457214
loss_pred:0.05888758972287178, decouple_loss:0.050304267555475235
The generated pressure mean: 0.4486882984638214
loss_pred:0.0573708601295948, decouple_loss:0.04746711999177933
Iteration: 143, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4478636682033539
loss_pred:0.05953095853328705, decouple_loss:0.04467730224132538
The generated pressure mean: 0.4487372040748596
loss_pred:0.05645596608519554, decouple_loss:0.04762295261025429
The generated pressure mean: 0.4475136399269104
loss_pred:0.05729671195149422, decouple_loss:0.0460759662091732
Iteration: 144, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44782277941703796
loss_pred:0.060421209782361984, decouple_loss:0.05358331650495529
The generated pressure mean: 0.44769448041915894
loss_pred:0.061987392604351044, decouple_loss:0.051599256694316864
The generated pressure mean: 0.4479408264160156
loss_pred:0.059099290519952774, decouple_loss:0.05475444346666336
Iteration: 145, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44852039217948914
loss_pred:0.05644499883055687, decouple_loss:0.046034302562475204
The generated pressure mean: 0.4483356773853302
loss_pred:0.058227069675922394, decouple_loss:0.04813554137945175
The generated pressure mean: 0.4480302929878235
loss_pred:0.058579783886671066, decouple_loss:0.04884748533368111
Iteration: 146, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44722437858581543
loss_pred:0.05696937069296837, decouple_loss:0.05288493633270264
The generated pressure mean: 0.4480445384979248
loss_pred:0.05590933933854103, decouple_loss:0.05416981503367424
The generated pressure mean: 0.4485186040401459
loss_pred:0.05746558681130409, decouple_loss:0.053235918283462524
Iteration: 147, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4488436281681061
loss_pred:0.05880216881632805, decouple_loss:0.05154760181903839
The generated pressure mean: 0.4478849172592163
loss_pred:0.05744841694831848, decouple_loss:0.052968788892030716
The generated pressure mean: 0.4483136534690857
loss_pred:0.057245466858148575, decouple_loss:0.054234087467193604
Iteration: 148, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4473903477191925
loss_pred:0.05767310783267021, decouple_loss:0.04913228377699852
The generated pressure mean: 0.44775915145874023
loss_pred:0.06123870238661766, decouple_loss:0.04920801892876625
The generated pressure mean: 0.4478997588157654
loss_pred:0.06010754778981209, decouple_loss:0.05198797211050987
Iteration: 149, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44988229870796204
loss_pred:0.05702509358525276, decouple_loss:0.04934442788362503
The generated pressure mean: 0.44837653636932373
loss_pred:0.057057589292526245, decouple_loss:0.049933791160583496
The generated pressure mean: 0.4479134678840637
loss_pred:0.05637045204639435, decouple_loss:0.049993131309747696
Iteration: 150, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44878095388412476
loss_pred:0.05545349791646004, decouple_loss:0.04970647767186165
The generated pressure mean: 0.44889670610427856
loss_pred:0.05707186087965965, decouple_loss:0.048621755093336105
The generated pressure mean: 0.44873368740081787
loss_pred:0.05731320381164551, decouple_loss:0.04891442134976387
2023-04-16 01:59:53 testing...
The generated pressure mean: 0.4502691328525543
loss_pred:0.1080109253525734, decouple_loss:0.07020033895969391
The generated pressure mean: 0.45003125071525574
loss_pred:0.10897749662399292, decouple_loss:0.07426675409078598
The generated pressure mean: 0.4503249526023865
loss_pred:0.10690367966890335, decouple_loss:0.0733853355050087
Loss: 0.11159491539001465, avg_mse: 0.12365508824586868
current test mse: 0.123655
Iteration: 151, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44791463017463684
loss_pred:0.058683689683675766, decouple_loss:0.04598182067275047
The generated pressure mean: 0.44823816418647766
loss_pred:0.05593683943152428, decouple_loss:0.04587310925126076
The generated pressure mean: 0.4489781856536865
loss_pred:0.0557980015873909, decouple_loss:0.04672473296523094
Iteration: 152, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4482676684856415
loss_pred:0.0570487342774868, decouple_loss:0.04933960735797882
The generated pressure mean: 0.4471808671951294
loss_pred:0.057217542082071304, decouple_loss:0.04736500605940819
The generated pressure mean: 0.4492027163505554
loss_pred:0.05769670009613037, decouple_loss:0.048241034150123596
Iteration: 153, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4481852948665619
The generated pressure mean: 0.4474576711654663
loss_pred:0.056649692356586456, decouple_loss:0.046448007225990295
loss_pred:0.054693225771188736, decouple_loss:0.04430165886878967
The generated pressure mean: 0.4476640224456787
loss_pred:0.05729503557085991, decouple_loss:0.04522659257054329
Iteration: 154, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4484057128429413
loss_pred:0.05534860119223595, decouple_loss:0.04821036756038666
The generated pressure mean: 0.4477933943271637
loss_pred:0.057687606662511826, decouple_loss:0.049416277557611465
The generated pressure mean: 0.4482375979423523
loss_pred:0.053728729486465454, decouple_loss:0.04741531237959862
Iteration: 155, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44792914390563965
loss_pred:0.0561521090567112, decouple_loss:0.04325452446937561
The generated pressure mean: 0.4478699266910553
loss_pred:0.05411303788423538, decouple_loss:0.04351142421364784
The generated pressure mean: 0.4467994272708893
loss_pred:0.05436326190829277, decouple_loss:0.043513473123311996
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 156, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.448011577129364
loss_pred:0.05325987562537193, decouple_loss:0.04432808607816696
The generated pressure mean: 0.44852414727211
loss_pred:0.05839240923523903, decouple_loss:0.04375399276614189
The generated pressure mean: 0.44871750473976135
loss_pred:0.05807693302631378, decouple_loss:0.0461861677467823
Iteration: 157, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44800081849098206
The generated pressure mean: 0.44780948758125305loss_pred:0.05642815679311752, decouple_loss:0.048279400914907455
loss_pred:0.05538352206349373, decouple_loss:0.04966514930129051
The generated pressure mean: 0.4475669860839844
loss_pred:0.05662224441766739, decouple_loss:0.04530884698033333
Iteration: 158, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44737905263900757
loss_pred:0.05787552893161774, decouple_loss:0.046550851315259933
The generated pressure mean: 0.44745489954948425
loss_pred:0.0555000901222229, decouple_loss:0.04552917182445526
The generated pressure mean: 0.44939759373664856
loss_pred:0.05549280345439911, decouple_loss:0.04600214958190918
Iteration: 159, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4473823308944702
loss_pred:0.053858786821365356, decouple_loss:0.04269954934716225
The generated pressure mean: 0.44734248518943787
loss_pred:0.05528314411640167, decouple_loss:0.04268335551023483
The generated pressure mean: 0.4485776722431183
loss_pred:0.054809585213661194, decouple_loss:0.04208550602197647
Iteration: 160, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44718044996261597
loss_pred:0.05400514602661133, decouple_loss:0.04753989353775978
The generated pressure mean: 0.44710415601730347
loss_pred:0.054100725799798965, decouple_loss:0.045761868357658386
The generated pressure mean: 0.447401225566864
loss_pred:0.05320463702082634, decouple_loss:0.04679212346673012
2023-04-16 02:01:59 testing...
The generated pressure mean: 0.4502691924571991
loss_pred:0.10903867334127426, decouple_loss:0.06779883056879044
The generated pressure mean: 0.45032480359077454
loss_pred:0.1076371967792511, decouple_loss:0.07051634788513184
The generated pressure mean: 0.4500313103199005
loss_pred:0.10944986343383789, decouple_loss:0.07102299481630325
Loss: 0.11219754815101624, avg_mse: 0.12551558017730713
current test mse: 0.125516
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012011_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012011_3_24hr.npz
NaN value num: 0
Iteration: 161, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4481666386127472
loss_pred:0.0581723228096962, decouple_loss:0.041832488030195236
The generated pressure mean: 0.446827232837677
loss_pred:0.05585702508687973, decouple_loss:0.04048547148704529
The generated pressure mean: 0.44874608516693115
loss_pred:0.05618443712592125, decouple_loss:0.041144441813230515
Iteration: 162, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44725289940834045
loss_pred:0.05589047446846962, decouple_loss:0.043947167694568634
The generated pressure mean: 0.44586315751075745
loss_pred:0.05809605121612549, decouple_loss:0.042498212307691574
The generated pressure mean: 0.4480338990688324
loss_pred:0.05597667768597603, decouple_loss:0.0456962063908577
Iteration: 163, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44778740406036377
loss_pred:0.05873861908912659, decouple_loss:0.042571742087602615
The generated pressure mean: 0.44639909267425537
loss_pred:0.0537995845079422, decouple_loss:0.0452607236802578
The generated pressure mean: 0.44804444909095764
loss_pred:0.05912273749709129, decouple_loss:0.04088837653398514
Iteration: 164, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44941043853759766
loss_pred:0.054815951734781265, decouple_loss:0.04225507378578186
The generated pressure mean: 0.4487519860267639
loss_pred:0.055955905467271805, decouple_loss:0.041012316942214966
The generated pressure mean: 0.445831298828125
loss_pred:0.057736847549676895, decouple_loss:0.041825003921985626
Iteration: 165, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44666874408721924
loss_pred:0.05763580650091171, decouple_loss:0.040584903210401535
The generated pressure mean: 0.4468989074230194
loss_pred:0.053910087794065475, decouple_loss:0.03976618871092796
The generated pressure mean: 0.44937050342559814
loss_pred:0.055517490953207016, decouple_loss:0.04015999659895897
Iteration: 166, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44838470220565796
loss_pred:0.05874301865696907, decouple_loss:0.0405275896191597
The generated pressure mean: 0.44745996594429016
loss_pred:0.058141447603702545, decouple_loss:0.04090749844908714
The generated pressure mean: 0.44684505462646484
loss_pred:0.05377626046538353, decouple_loss:0.04352474957704544
Iteration: 167, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44868040084838867
loss_pred:0.054451294243335724, decouple_loss:0.04218629002571106
The generated pressure mean: 0.446781188249588
loss_pred:0.05503155663609505, decouple_loss:0.04036813601851463
The generated pressure mean: 0.44625332951545715
loss_pred:0.058375924825668335, decouple_loss:0.04036521166563034
Iteration: 168, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4485405385494232
The generated pressure mean: 0.44687724113464355
loss_pred:0.056083060801029205, decouple_loss:0.04025387763977051
loss_pred:0.05353141576051712, decouple_loss:0.04148978739976883
The generated pressure mean: 0.447022408246994
loss_pred:0.05299559235572815, decouple_loss:0.04207552224397659
Iteration: 169, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4481744170188904
loss_pred:0.055893830955028534, decouple_loss:0.037382252514362335
The generated pressure mean: 0.4494320750236511
loss_pred:0.057215895503759384, decouple_loss:0.037659190595149994
The generated pressure mean: 0.44762125611305237
loss_pred:0.05676734074950218, decouple_loss:0.039788734167814255
Iteration: 170, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44719454646110535
loss_pred:0.056630004197359085, decouple_loss:0.04027893394231796
The generated pressure mean: 0.44914788007736206
loss_pred:0.05559401214122772, decouple_loss:0.0389130674302578
The generated pressure mean: 0.44656747579574585
loss_pred:0.05593935027718544, decouple_loss:0.03892045095562935
2023-04-16 02:04:39 testing...
The generated pressure mean: 0.4502691626548767
loss_pred:0.10994876176118851, decouple_loss:0.06874915957450867
The generated pressure mean: 0.4503248929977417
loss_pred:0.10866816341876984, decouple_loss:0.07086512446403503
The generated pressure mean: 0.4500312805175781
loss_pred:0.11059726029634476, decouple_loss:0.07099427282810211
Loss: 0.11324821412563324, avg_mse: 0.12782298028469086
current test mse: 0.127823
Iteration: 171, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4468337297439575
loss_pred:0.05582559108734131, decouple_loss:0.03880228102207184
The generated pressure mean: 0.4479702115058899
loss_pred:0.05568356812000275, decouple_loss:0.04317229241132736
The generated pressure mean: 0.44877684116363525
loss_pred:0.05764813721179962, decouple_loss:0.042433444410562515
Iteration: 172, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4476786255836487
loss_pred:0.05415017157793045, decouple_loss:0.039146050810813904
The generated pressure mean: 0.4473973214626312
loss_pred:0.053049564361572266, decouple_loss:0.03917510807514191
The generated pressure mean: 0.4474932551383972
loss_pred:0.05737985298037529, decouple_loss:0.03840479254722595
Iteration: 173, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4470486342906952
The generated pressure mean: 0.44640031456947327
loss_pred:0.05328962579369545, decouple_loss:0.04254473000764847
loss_pred:0.05651864409446716, decouple_loss:0.041004739701747894
The generated pressure mean: 0.4473489224910736
loss_pred:0.054310642182826996, decouple_loss:0.03980180621147156
Iteration: 174, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44783729314804077
The generated pressure mean: 0.4465053677558899loss_pred:0.05786760896444321, decouple_loss:0.042329978197813034
loss_pred:0.05389616638422012, decouple_loss:0.04185745492577553
The generated pressure mean: 0.44698673486709595
loss_pred:0.05651448294520378, decouple_loss:0.04229990392923355
Iteration: 175, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44916972517967224
loss_pred:0.05510687828063965, decouple_loss:0.04382261633872986
The generated pressure mean: 0.4470425546169281
loss_pred:0.054429419338703156, decouple_loss:0.043205562978982925
The generated pressure mean: 0.44672060012817383
loss_pred:0.0530732162296772, decouple_loss:0.04162658005952835
Iteration: 176, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44791966676712036
The generated pressure mean: 0.44625866413116455loss_pred:0.055574681609869, decouple_loss:0.037694886326789856
loss_pred:0.05657236650586128, decouple_loss:0.040075693279504776
The generated pressure mean: 0.4466046988964081
loss_pred:0.05331426486372948, decouple_loss:0.038053710013628006
Iteration: 177, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44745007157325745
loss_pred:0.054515205323696136, decouple_loss:0.0419081412255764
The generated pressure mean: 0.4480190873146057
loss_pred:0.05623709410429001, decouple_loss:0.04101601615548134
The generated pressure mean: 0.4472646415233612
loss_pred:0.054945338517427444, decouple_loss:0.041854046285152435
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 178, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4472861886024475
The generated pressure mean: 0.4473397731781006
loss_pred:0.053736984729766846, decouple_loss:0.03760228306055069
loss_pred:0.05214773863554001, decouple_loss:0.03882870823144913
The generated pressure mean: 0.4479215145111084
loss_pred:0.051809318363666534, decouple_loss:0.0415758416056633
Iteration: 179, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.448580265045166
loss_pred:0.0568227656185627, decouple_loss:0.03813028335571289
The generated pressure mean: 0.44634929299354553
loss_pred:0.052632320672273636, decouple_loss:0.0394960418343544
The generated pressure mean: 0.4480893909931183
loss_pred:0.05592995882034302, decouple_loss:0.040573082864284515
Iteration: 180, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44790297746658325
loss_pred:0.05549466609954834, decouple_loss:0.03817522153258324
The generated pressure mean: 0.4496213495731354
loss_pred:0.052482347935438156, decouple_loss:0.0373678132891655
The generated pressure mean: 0.4472138583660126
loss_pred:0.0528021901845932, decouple_loss:0.03746519237756729
2023-04-16 02:06:45 testing...
The generated pressure mean: 0.4502691626548767
loss_pred:0.10890490561723709, decouple_loss:0.06489583849906921
The generated pressure mean: 0.45032477378845215
loss_pred:0.10780500620603561, decouple_loss:0.06743049621582031
The generated pressure mean: 0.45003125071525574
loss_pred:0.10970894247293472, decouple_loss:0.0678340494632721
Loss: 0.11214229464530945, avg_mse: 0.12804798781871796
current test mse: 0.128048
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012014_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012014_3_24hr.npz
NaN value num: 0
Iteration: 181, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4467675983905792
loss_pred:0.054188765585422516, decouple_loss:0.04088142514228821
The generated pressure mean: 0.4464741349220276
loss_pred:0.05289686098694801, decouple_loss:0.03890354558825493
The generated pressure mean: 0.44702208042144775
loss_pred:0.05094218626618385, decouple_loss:0.03982442244887352
Iteration: 182, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4471198618412018
loss_pred:0.053898874670267105, decouple_loss:0.04729108884930611
The generated pressure mean: 0.44617345929145813
loss_pred:0.05627064034342766, decouple_loss:0.04006704315543175
The generated pressure mean: 0.4479808807373047
loss_pred:0.05406865105032921, decouple_loss:0.044782474637031555
Iteration: 183, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44835567474365234
loss_pred:0.05478150397539139, decouple_loss:0.041810955852270126
The generated pressure mean: 0.4471399784088135
The generated pressure mean: 0.44862574338912964
loss_pred:0.05480138212442398, decouple_loss:0.03892126306891441
loss_pred:0.056080300360918045, decouple_loss:0.04085204750299454
Iteration: 184, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44689100980758667The generated pressure mean: 0.4479683041572571
loss_pred:0.05464639142155647, decouple_loss:0.04230474680662155
loss_pred:0.05291517823934555, decouple_loss:0.0411580465734005
The generated pressure mean: 0.4464110732078552
loss_pred:0.05456741526722908, decouple_loss:0.044241346418857574
Iteration: 185, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4470657706260681
The generated pressure mean: 0.4464968144893646
loss_pred:0.053206346929073334, decouple_loss:0.04325907304883003
loss_pred:0.050615157932043076, decouple_loss:0.04144130274653435
The generated pressure mean: 0.4470452666282654
loss_pred:0.05404979735612869, decouple_loss:0.047310519963502884
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 186, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4470354914665222The generated pressure mean: 0.4473334550857544
loss_pred:0.05397954210639, decouple_loss:0.039640530943870544
loss_pred:0.05402433127164841, decouple_loss:0.04293207451701164
The generated pressure mean: 0.44680696725845337
loss_pred:0.05301114544272423, decouple_loss:0.03811302036046982
Iteration: 187, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44785258173942566
loss_pred:0.05390320345759392, decouple_loss:0.05438094213604927
The generated pressure mean: 0.44680219888687134
loss_pred:0.05447893589735031, decouple_loss:0.053408317267894745
The generated pressure mean: 0.44817158579826355
loss_pred:0.05366211384534836, decouple_loss:0.05417555943131447
Iteration: 188, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4472736120223999
loss_pred:0.05327124521136284, decouple_loss:0.039654690772295
The generated pressure mean: 0.4471076726913452
loss_pred:0.05092354118824005, decouple_loss:0.04025612026453018
The generated pressure mean: 0.4481924772262573
loss_pred:0.053529977798461914, decouple_loss:0.04067153111100197
Iteration: 189, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44702407717704773
loss_pred:0.054708331823349, decouple_loss:0.04770692065358162
The generated pressure mean: 0.44722819328308105
loss_pred:0.05247502028942108, decouple_loss:0.05052293464541435
The generated pressure mean: 0.44734880328178406
loss_pred:0.053238093852996826, decouple_loss:0.04936132952570915
Iteration: 190, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4465283751487732
loss_pred:0.052055925130844116, decouple_loss:0.039286717772483826
The generated pressure mean: 0.4464966058731079
loss_pred:0.0527135394513607, decouple_loss:0.04188968613743782
The generated pressure mean: 0.44664525985717773
loss_pred:0.05294578894972801, decouple_loss:0.04005837440490723
2023-04-16 02:09:29 testing...
The generated pressure mean: 0.4502691626548767
loss_pred:0.11048231273889542, decouple_loss:0.07517102360725403
The generated pressure mean: 0.4503248333930969
loss_pred:0.1093609407544136, decouple_loss:0.07800186425447464
The generated pressure mean: 0.4500315487384796
loss_pred:0.1106119230389595, decouple_loss:0.07812999188899994
Loss: 0.11400678008794785, avg_mse: 0.13165625929832458
current test mse: 0.131656
Iteration: 191, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4489828944206238
loss_pred:0.05558711290359497, decouple_loss:0.04486560821533203
The generated pressure mean: 0.44632962346076965
loss_pred:0.05212126672267914, decouple_loss:0.04687952995300293
The generated pressure mean: 0.44808363914489746
loss_pred:0.052049051970243454, decouple_loss:0.04685095325112343
Iteration: 192, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44761067628860474
The generated pressure mean: 0.447198748588562
loss_pred:0.0540911890566349, decouple_loss:0.04124540463089943
loss_pred:0.054927293211221695, decouple_loss:0.044014304876327515
The generated pressure mean: 0.4474049508571625
loss_pred:0.05291862413287163, decouple_loss:0.0434391014277935
Iteration: 193, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4475412964820862
loss_pred:0.053477898240089417, decouple_loss:0.0501205138862133
The generated pressure mean: 0.4460555613040924
loss_pred:0.05425006523728371, decouple_loss:0.048422448337078094
The generated pressure mean: 0.44707807898521423
loss_pred:0.05381488427519798, decouple_loss:0.05345146358013153
Iteration: 194, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44807854294776917
loss_pred:0.055170610547065735, decouple_loss:0.04662463814020157
The generated pressure mean: 0.4471432566642761
loss_pred:0.052521899342536926, decouple_loss:0.04267789423465729
The generated pressure mean: 0.44659337401390076
loss_pred:0.05194589123129845, decouple_loss:0.04326252266764641
Iteration: 195, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4481918215751648
loss_pred:0.055910781025886536, decouple_loss:0.04371752589941025
The generated pressure mean: 0.44782552123069763
loss_pred:0.054042622447013855, decouple_loss:0.043729107826948166
The generated pressure mean: 0.44851696491241455
loss_pred:0.05211066082119942, decouple_loss:0.04647458344697952
Iteration: 196, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44841697812080383
loss_pred:0.05243414267897606, decouple_loss:0.04759154096245766
The generated pressure mean: 0.44747141003608704
loss_pred:0.052300505340099335, decouple_loss:0.0476054772734642
The generated pressure mean: 0.4480119049549103
loss_pred:0.056351158767938614, decouple_loss:0.04675116762518883
Iteration: 197, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4462561011314392
loss_pred:0.051529619842767715, decouple_loss:0.04437204822897911
The generated pressure mean: 0.44754934310913086
loss_pred:0.05205957591533661, decouple_loss:0.0450684130191803
The generated pressure mean: 0.44662991166114807
loss_pred:0.05038192868232727, decouple_loss:0.04265652596950531
Iteration: 198, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4485915005207062
The generated pressure mean: 0.44711077213287354loss_pred:0.05234061926603317, decouple_loss:0.042940180748701096
loss_pred:0.05125213414430618, decouple_loss:0.042138148099184036
The generated pressure mean: 0.4464074671268463
loss_pred:0.0509975329041481, decouple_loss:0.042208973318338394
Iteration: 199, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4458675682544708
loss_pred:0.050167717039585114, decouple_loss:0.04153118655085564
The generated pressure mean: 0.4477623701095581
loss_pred:0.0538492277264595, decouple_loss:0.041104186326265335
The generated pressure mean: 0.4486055374145508
loss_pred:0.054024022072553635, decouple_loss:0.04089069366455078
Iteration: 200, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44728660583496094
loss_pred:0.05182017385959625, decouple_loss:0.04407434165477753
The generated pressure mean: 0.4482254981994629
loss_pred:0.05288359522819519, decouple_loss:0.041528455913066864
The generated pressure mean: 0.4467894434928894
loss_pred:0.0495217926800251, decouple_loss:0.042246460914611816
2023-04-16 02:11:36 testing...
The generated pressure mean: 0.4502691328525543
loss_pred:0.10933254659175873, decouple_loss:0.07069212943315506
The generated pressure mean: 0.450324684381485
loss_pred:0.10747700184583664, decouple_loss:0.07368753105401993
The generated pressure mean: 0.45003098249435425
loss_pred:0.10849139839410782, decouple_loss:0.07437913864850998
Loss: 0.11207963526248932, avg_mse: 0.1309816986322403
current test mse: 0.130982
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012004_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012004_3_24hr.npz
NaN value num: 0
Iteration: 201, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4486905038356781
loss_pred:0.04939456656575203, decouple_loss:0.041302379220724106
The generated pressure mean: 0.4482318162918091
loss_pred:0.050533585250377655, decouple_loss:0.04004484787583351
The generated pressure mean: 0.447916179895401
loss_pred:0.05059599131345749, decouple_loss:0.038819171488285065
Iteration: 202, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44758883118629456
loss_pred:0.051489509642124176, decouple_loss:0.0393483005464077
The generated pressure mean: 0.44841963052749634
loss_pred:0.049168605357408524, decouple_loss:0.03833918645977974
The generated pressure mean: 0.44782835245132446
loss_pred:0.04870053008198738, decouple_loss:0.039599236100912094
Iteration: 203, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44863274693489075
loss_pred:0.04987451434135437, decouple_loss:0.03908282518386841
The generated pressure mean: 0.44861844182014465
The generated pressure mean: 0.4482066035270691
loss_pred:0.04948713630437851, decouple_loss:0.03782910481095314
loss_pred:0.05111510679125786, decouple_loss:0.03664463385939598
Iteration: 204, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44829779863357544
loss_pred:0.05107346922159195, decouple_loss:0.037509046494960785
The generated pressure mean: 0.44841599464416504
loss_pred:0.04989640787243843, decouple_loss:0.036699533462524414
The generated pressure mean: 0.4489106833934784
loss_pred:0.04927418753504753, decouple_loss:0.03750516101717949
Iteration: 205, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4487018585205078
loss_pred:0.04906332492828369, decouple_loss:0.03748125582933426
The generated pressure mean: 0.44819745421409607
loss_pred:0.049232158809900284, decouple_loss:0.03685387969017029
The generated pressure mean: 0.4478508532047272
loss_pred:0.04982807859778404, decouple_loss:0.03630330413579941
Iteration: 206, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44663843512535095
The generated pressure mean: 0.4468972980976105
loss_pred:0.05014492943882942, decouple_loss:0.03612053021788597
loss_pred:0.049748074263334274, decouple_loss:0.03527543693780899
The generated pressure mean: 0.44733527302742004
loss_pred:0.051370251923799515, decouple_loss:0.03853572905063629
Iteration: 207, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4478585720062256
loss_pred:0.04765903577208519, decouple_loss:0.0390554815530777
The generated pressure mean: 0.448186457157135
loss_pred:0.05041302368044853, decouple_loss:0.037530701607465744
The generated pressure mean: 0.4472714066505432
loss_pred:0.047424040734767914, decouple_loss:0.036412063986063004
Iteration: 208, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.448527067899704
The generated pressure mean: 0.4492252469062805loss_pred:0.047631729394197464, decouple_loss:0.03844938054680824
loss_pred:0.04747283086180687, decouple_loss:0.035798706114292145
The generated pressure mean: 0.44726651906967163
loss_pred:0.04869675636291504, decouple_loss:0.03612503409385681
Iteration: 209, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44790345430374146
loss_pred:0.04794081300497055, decouple_loss:0.0365748293697834
The generated pressure mean: 0.4480876922607422
loss_pred:0.04614820331335068, decouple_loss:0.034729648381471634
The generated pressure mean: 0.44776803255081177
loss_pred:0.04815095290541649, decouple_loss:0.035561125725507736
Iteration: 210, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44720375537872314The generated pressure mean: 0.448853075504303
loss_pred:0.0495101734995842, decouple_loss:0.034584030508995056
loss_pred:0.04777488112449646, decouple_loss:0.03528980165719986
The generated pressure mean: 0.4485006034374237
loss_pred:0.04737852141261101, decouple_loss:0.03488263860344887
2023-04-16 02:14:19 testing...
The generated pressure mean: 0.4502691328525543
loss_pred:0.11069922894239426, decouple_loss:0.06409327685832977
The generated pressure mean: 0.4503248631954193
loss_pred:0.10896841436624527, decouple_loss:0.06641217321157455
The generated pressure mean: 0.4500313699245453
loss_pred:0.11025878041982651, decouple_loss:0.06774891912937164
Loss: 0.11327972263097763, avg_mse: 0.13506507873535156
current test mse: 0.135065
Iteration: 211, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4480217397212982
loss_pred:0.0475991815328598, decouple_loss:0.034236885607242584
The generated pressure mean: 0.4468401372432709
loss_pred:0.047977741807699203, decouple_loss:0.03437349572777748
The generated pressure mean: 0.4485660493373871
loss_pred:0.04708413779735565, decouple_loss:0.034424010664224625
Iteration: 212, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4487709105014801
loss_pred:0.04827139154076576, decouple_loss:0.032270338386297226
The generated pressure mean: 0.4466107487678528
loss_pred:0.04902785271406174, decouple_loss:0.033338628709316254
The generated pressure mean: 0.4486676752567291
loss_pred:0.046741049736738205, decouple_loss:0.03367464616894722
Iteration: 213, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4483475387096405
loss_pred:0.04850079119205475, decouple_loss:0.03212866187095642
The generated pressure mean: 0.44867298007011414
loss_pred:0.04943906143307686, decouple_loss:0.031258925795555115
The generated pressure mean: 0.4469987452030182
loss_pred:0.0472077876329422, decouple_loss:0.03398137912154198
Iteration: 214, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.449207067489624
loss_pred:0.05043420568108559, decouple_loss:0.0326218418776989
The generated pressure mean: 0.44788604974746704
loss_pred:0.04823663458228111, decouple_loss:0.032469335943460464
The generated pressure mean: 0.44843873381614685
loss_pred:0.0480184331536293, decouple_loss:0.03211568295955658
Iteration: 215, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4487471282482147
loss_pred:0.046233829110860825, decouple_loss:0.03105185739696026
The generated pressure mean: 0.4464300274848938
loss_pred:0.049164507538080215, decouple_loss:0.030877655372023582
The generated pressure mean: 0.4474170207977295
loss_pred:0.04642212763428688, decouple_loss:0.03205195814371109
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 216, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44873112440109253
loss_pred:0.04821023344993591, decouple_loss:0.032120540738105774
The generated pressure mean: 0.44839680194854736
loss_pred:0.04869871959090233, decouple_loss:0.03141248598694801
The generated pressure mean: 0.4461521804332733
loss_pred:0.04675450921058655, decouple_loss:0.03398691117763519
Iteration: 217, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44791340827941895
The generated pressure mean: 0.4472511410713196
loss_pred:0.04768327623605728, decouple_loss:0.034697484225034714
loss_pred:0.04670581594109535, decouple_loss:0.03479484096169472
The generated pressure mean: 0.44676634669303894
loss_pred:0.04853198304772377, decouple_loss:0.0327572263777256
Iteration: 218, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44722622632980347
loss_pred:0.046697527170181274, decouple_loss:0.032404400408267975
The generated pressure mean: 0.4484391510486603
loss_pred:0.0478399395942688, decouple_loss:0.03304051607847214
The generated pressure mean: 0.4477401077747345
loss_pred:0.046805523335933685, decouple_loss:0.03121899627149105
Iteration: 219, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4488929212093353
loss_pred:0.04828983172774315, decouple_loss:0.03150774911046028
The generated pressure mean: 0.4480442702770233
loss_pred:0.046031855046749115, decouple_loss:0.03176240995526314
The generated pressure mean: 0.4478949308395386
loss_pred:0.050456028431653976, decouple_loss:0.03271598368883133
Iteration: 220, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44790974259376526
loss_pred:0.04753563180565834, decouple_loss:0.03183881565928459
The generated pressure mean: 0.4481106102466583
loss_pred:0.04533052071928978, decouple_loss:0.0326317623257637
The generated pressure mean: 0.44725555181503296
loss_pred:0.04872724786400795, decouple_loss:0.03428376838564873
2023-04-16 02:16:25 testing...
The generated pressure mean: 0.4502691626548767
loss_pred:0.11098145693540573, decouple_loss:0.0641532838344574
The generated pressure mean: 0.4503248631954193
loss_pred:0.10845055431127548, decouple_loss:0.06684084236621857
The generated pressure mean: 0.4500308632850647
loss_pred:0.11011610925197601, decouple_loss:0.06815171986818314
Loss: 0.11316847056150436, avg_mse: 0.13572175800800323
current test mse: 0.135722
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012008_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012008_3_24hr.npz
NaN value num: 0
Iteration: 221, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44956114888191223
loss_pred:0.051415178924798965, decouple_loss:0.03900470584630966
The generated pressure mean: 0.4485997259616852
loss_pred:0.04740266874432564, decouple_loss:0.03614886850118637
The generated pressure mean: 0.44701263308525085
loss_pred:0.05063524842262268, decouple_loss:0.036496542394161224
Iteration: 222, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4477047622203827
loss_pred:0.04556077718734741, decouple_loss:0.034493472427129745
The generated pressure mean: 0.4481487274169922
loss_pred:0.04742616042494774, decouple_loss:0.03975095972418785
The generated pressure mean: 0.4467480182647705
loss_pred:0.048527199774980545, decouple_loss:0.036665137857198715
Iteration: 223, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44717922806739807
loss_pred:0.04819416627287865, decouple_loss:0.0335434265434742
The generated pressure mean: 0.4491487741470337
loss_pred:0.05030309036374092, decouple_loss:0.034065112471580505
The generated pressure mean: 0.44800952076911926
loss_pred:0.047973137348890305, decouple_loss:0.03541450574994087
Iteration: 224, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44852158427238464
loss_pred:0.048988863825798035, decouple_loss:0.03678365796804428
The generated pressure mean: 0.44868770241737366
loss_pred:0.04801547899842262, decouple_loss:0.03980495035648346
The generated pressure mean: 0.4489688575267792
loss_pred:0.04964163526892662, decouple_loss:0.04018624126911163
Iteration: 225, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44867855310440063
loss_pred:0.04545464739203453, decouple_loss:0.03627655655145645
The generated pressure mean: 0.4486183524131775
loss_pred:0.04566486179828644, decouple_loss:0.03725183755159378
The generated pressure mean: 0.4483237564563751
loss_pred:0.04599178582429886, decouple_loss:0.03708215057849884
Iteration: 226, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44795939326286316
loss_pred:0.04736216366291046, decouple_loss:0.03267376497387886
The generated pressure mean: 0.4470272362232208
loss_pred:0.04609779268503189, decouple_loss:0.03331500291824341
The generated pressure mean: 0.44886258244514465
loss_pred:0.046345748007297516, decouple_loss:0.034673504531383514
Iteration: 227, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44744735956192017
loss_pred:0.04931873083114624, decouple_loss:0.03440285474061966
The generated pressure mean: 0.4484765827655792
loss_pred:0.04616478458046913, decouple_loss:0.037263233214616776
The generated pressure mean: 0.4485536515712738
loss_pred:0.043570760637521744, decouple_loss:0.0396699421107769
Iteration: 228, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4497528672218323
loss_pred:0.04980170354247093, decouple_loss:0.03471529856324196
The generated pressure mean: 0.44736072421073914
loss_pred:0.04658813774585724, decouple_loss:0.0354391485452652
The generated pressure mean: 0.44889745116233826
loss_pred:0.04544011130928993, decouple_loss:0.03410590440034866
Iteration: 229, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4487331807613373
loss_pred:0.04941292479634285, decouple_loss:0.03926802799105644
The generated pressure mean: 0.4482320547103882
loss_pred:0.04706506431102753, decouple_loss:0.038959257304668427
The generated pressure mean: 0.4489280581474304
loss_pred:0.05007485672831535, decouple_loss:0.041659481823444366
Iteration: 230, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44784343242645264
The generated pressure mean: 0.44992274045944214
loss_pred:0.04647291079163551, decouple_loss:0.032254546880722046
loss_pred:0.04734673351049423, decouple_loss:0.03229844197630882
The generated pressure mean: 0.44957759976387024
loss_pred:0.046132706105709076, decouple_loss:0.03251645341515541
2023-04-16 02:19:09 testing...
The generated pressure mean: 0.4502691626548767
loss_pred:0.11453147977590561, decouple_loss:0.06803292036056519
The generated pressure mean: 0.4503249228000641
loss_pred:0.1114645004272461, decouple_loss:0.07074852287769318
The generated pressure mean: 0.45003098249435425
loss_pred:0.11283329129219055, decouple_loss:0.07253485172986984
Loss: 0.1164650246500969, avg_mse: 0.14235112071037292
current test mse: 0.142351
Iteration: 231, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4488348960876465
loss_pred:0.04482181370258331, decouple_loss:0.038007427006959915
The generated pressure mean: 0.4481935501098633
loss_pred:0.04943198338150978, decouple_loss:0.03658861666917801
The generated pressure mean: 0.44904816150665283
loss_pred:0.04706514626741409, decouple_loss:0.03784364089369774
Iteration: 232, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44900891184806824
loss_pred:0.047103151679039, decouple_loss:0.035587433725595474
The generated pressure mean: 0.4477325975894928
loss_pred:0.046949923038482666, decouple_loss:0.03491643816232681
The generated pressure mean: 0.44748902320861816
loss_pred:0.04954247176647186, decouple_loss:0.03300376981496811
Iteration: 233, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44820189476013184
loss_pred:0.04487316682934761, decouple_loss:0.03861859813332558
The generated pressure mean: 0.4485044479370117
The generated pressure mean: 0.4485609829425812
loss_pred:0.0486517995595932, decouple_loss:0.036121636629104614
loss_pred:0.04517984390258789, decouple_loss:0.034744590520858765
Iteration: 234, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44793811440467834
loss_pred:0.04568859189748764, decouple_loss:0.0367036797106266
The generated pressure mean: 0.4487832188606262
loss_pred:0.0476066917181015, decouple_loss:0.03592347726225853
The generated pressure mean: 0.4483301341533661
loss_pred:0.04474710300564766, decouple_loss:0.03579017519950867
Iteration: 235, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44919589161872864
loss_pred:0.04401898756623268, decouple_loss:0.03916774317622185
The generated pressure mean: 0.44725748896598816
loss_pred:0.04505923390388489, decouple_loss:0.035203717648983
The generated pressure mean: 0.44784051179885864
loss_pred:0.04367130994796753, decouple_loss:0.03850090503692627
Iteration: 236, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4490877091884613
loss_pred:0.05012082681059837, decouple_loss:0.03821569308638573
The generated pressure mean: 0.4485458731651306
loss_pred:0.04536264389753342, decouple_loss:0.037581443786621094
The generated pressure mean: 0.4474761188030243
loss_pred:0.045677535235881805, decouple_loss:0.03710015118122101
Iteration: 237, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4475507140159607
loss_pred:0.045458436012268066, decouple_loss:0.03846254199743271
The generated pressure mean: 0.44848987460136414
loss_pred:0.04499256983399391, decouple_loss:0.03693646937608719
The generated pressure mean: 0.4482504427433014
loss_pred:0.046448443084955215, decouple_loss:0.03829353302717209
Iteration: 238, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45035138726234436
loss_pred:0.04684581235051155, decouple_loss:0.04510993883013725
The generated pressure mean: 0.4474422335624695
loss_pred:0.04786405712366104, decouple_loss:0.038117583841085434
The generated pressure mean: 0.45005476474761963
loss_pred:0.05069824308156967, decouple_loss:0.04277176409959793
Iteration: 239, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4474983811378479
loss_pred:0.04318529739975929, decouple_loss:0.04065172001719475
The generated pressure mean: 0.44836872816085815
loss_pred:0.04587514325976372, decouple_loss:0.03787583112716675
The generated pressure mean: 0.44835570454597473
loss_pred:0.04644675925374031, decouple_loss:0.0418335385620594
Iteration: 240, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44839340448379517
loss_pred:0.046790920197963715, decouple_loss:0.04375941678881645
The generated pressure mean: 0.4480874538421631
loss_pred:0.04663710296154022, decouple_loss:0.04350883886218071
The generated pressure mean: 0.4477761387825012
loss_pred:0.044452156871557236, decouple_loss:0.040998902171850204
2023-04-16 02:21:16 testing...
The generated pressure mean: 0.4502691328525543
loss_pred:0.1147320568561554, decouple_loss:0.07181866466999054
The generated pressure mean: 0.4503248929977417
loss_pred:0.11191431432962418, decouple_loss:0.07338149100542068
The generated pressure mean: 0.4500311613082886
loss_pred:0.11315678805112839, decouple_loss:0.07422833144664764
Loss: 0.11692486703395844, avg_mse: 0.14527787268161774
current test mse: 0.145278
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012003_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012003_3_24hr.npz
NaN value num: 0
Iteration: 241, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44778189063072205
loss_pred:0.043352920562028885, decouple_loss:0.04460038244724274
The generated pressure mean: 0.45095357298851013
loss_pred:0.04798419773578644, decouple_loss:0.04650420323014259
The generated pressure mean: 0.44923555850982666
loss_pred:0.04720079526305199, decouple_loss:0.04498463496565819
Iteration: 242, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44976648688316345
loss_pred:0.04680081829428673, decouple_loss:0.03925485908985138
The generated pressure mean: 0.4489031732082367
loss_pred:0.047323811799287796, decouple_loss:0.03899715840816498
The generated pressure mean: 0.4482024908065796
loss_pred:0.04527447000145912, decouple_loss:0.04019575193524361
Iteration: 243, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4483978748321533
The generated pressure mean: 0.448348730802536loss_pred:0.045937586575746536, decouple_loss:0.0412493497133255
loss_pred:0.04635898023843765, decouple_loss:0.03995031118392944
The generated pressure mean: 0.4486686587333679
loss_pred:0.04268580302596092, decouple_loss:0.0402451753616333
Iteration: 244, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44882041215896606
loss_pred:0.044849421828985214, decouple_loss:0.03976033627986908
The generated pressure mean: 0.44828876852989197
loss_pred:0.045984696596860886, decouple_loss:0.03746990114450455
The generated pressure mean: 0.44882699847221375
loss_pred:0.044778287410736084, decouple_loss:0.041179295629262924
Iteration: 245, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4485110938549042
loss_pred:0.045235831290483475, decouple_loss:0.03637305647134781
The generated pressure mean: 0.44870129227638245
loss_pred:0.04369161278009415, decouple_loss:0.034642647951841354
The generated pressure mean: 0.4486013650894165
loss_pred:0.04539205878973007, decouple_loss:0.03689826279878616
Iteration: 246, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.448984831571579
loss_pred:0.04430573433637619, decouple_loss:0.035410862416028976
The generated pressure mean: 0.44931501150131226
loss_pred:0.0449051633477211, decouple_loss:0.033792536705732346
The generated pressure mean: 0.44808146357536316
loss_pred:0.04411519318819046, decouple_loss:0.03647104278206825
Iteration: 247, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4477705657482147
loss_pred:0.04630044475197792, decouple_loss:0.03328479081392288
The generated pressure mean: 0.4479690492153168
loss_pred:0.04256473109126091, decouple_loss:0.03240721672773361
The generated pressure mean: 0.44909313321113586
loss_pred:0.0440884493291378, decouple_loss:0.03400304540991783
Iteration: 248, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44825631380081177
loss_pred:0.042994171380996704, decouple_loss:0.0343523733317852
The generated pressure mean: 0.4478534460067749
loss_pred:0.041879892349243164, decouple_loss:0.03386526182293892
The generated pressure mean: 0.44772225618362427
loss_pred:0.04531962051987648, decouple_loss:0.03540751338005066
Iteration: 249, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44809186458587646
loss_pred:0.04430003836750984, decouple_loss:0.034865327179431915
The generated pressure mean: 0.4487890899181366
loss_pred:0.04483882710337639, decouple_loss:0.03457793593406677
The generated pressure mean: 0.44795143604278564
loss_pred:0.04292956739664078, decouple_loss:0.033904917538166046
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 250, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4500841796398163
loss_pred:0.043575458228588104, decouple_loss:0.03217197209596634
The generated pressure mean: 0.4481390416622162
loss_pred:0.043613068759441376, decouple_loss:0.033235035836696625
The generated pressure mean: 0.44871193170547485
loss_pred:0.04340542107820511, decouple_loss:0.032397594302892685
2023-04-16 02:24:01 testing...
The generated pressure mean: 0.4502691924571991
loss_pred:0.11673805117607117, decouple_loss:0.0665803998708725
The generated pressure mean: 0.4503246545791626
loss_pred:0.11328937858343124, decouple_loss:0.06932811439037323
The generated pressure mean: 0.4500316381454468
loss_pred:0.1149032860994339, decouple_loss:0.07024621218442917
Loss: 0.1184128150343895, avg_mse: 0.1481553316116333
current test mse: 0.148155
Iteration: 251, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44791266322135925
loss_pred:0.0432068407535553, decouple_loss:0.033192120492458344
The generated pressure mean: 0.44976097345352173
loss_pred:0.04541885107755661, decouple_loss:0.03132307529449463
The generated pressure mean: 0.4500306248664856
loss_pred:0.04414839670062065, decouple_loss:0.032041892409324646
Iteration: 252, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44795116782188416
loss_pred:0.04416591674089432, decouple_loss:0.03205510228872299
The generated pressure mean: 0.4489861726760864
loss_pred:0.04431019350886345, decouple_loss:0.03111974149942398
The generated pressure mean: 0.4486256539821625
loss_pred:0.041407518088817596, decouple_loss:0.03200172632932663
Iteration: 253, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4492783546447754
loss_pred:0.043268561363220215, decouple_loss:0.02980268932878971
The generated pressure mean: 0.4479861259460449
loss_pred:0.04437686502933502, decouple_loss:0.030685007572174072
The generated pressure mean: 0.4491824805736542
loss_pred:0.04528455063700676, decouple_loss:0.030461564660072327
Iteration: 254, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4489328861236572
loss_pred:0.04484594613313675, decouple_loss:0.03290178254246712
The generated pressure mean: 0.4486152231693268
loss_pred:0.04490385949611664, decouple_loss:0.03017314523458481
The generated pressure mean: 0.44886255264282227
loss_pred:0.044336289167404175, decouple_loss:0.03148091211915016
Iteration: 255, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4479873478412628
loss_pred:0.044685181230306625, decouple_loss:0.031322915107011795
The generated pressure mean: 0.4476792812347412
loss_pred:0.04278532788157463, decouple_loss:0.03141287341713905
The generated pressure mean: 0.4491821229457855
loss_pred:0.043650731444358826, decouple_loss:0.031848225742578506
Iteration: 256, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44885262846946716
The generated pressure mean: 0.4484209418296814loss_pred:0.04487665370106697, decouple_loss:0.03192852437496185
loss_pred:0.044215306639671326, decouple_loss:0.03256696090102196
The generated pressure mean: 0.4484298825263977
loss_pred:0.043988049030303955, decouple_loss:0.032825637608766556
Iteration: 257, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4476815164089203
loss_pred:0.04199594631791115, decouple_loss:0.031731169670820236
The generated pressure mean: 0.4481178820133209
loss_pred:0.04350518435239792, decouple_loss:0.03181944042444229
The generated pressure mean: 0.4487391412258148
loss_pred:0.04392983019351959, decouple_loss:0.03275822103023529
Iteration: 258, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.450530081987381
loss_pred:0.044176191091537476, decouple_loss:0.031205642968416214
The generated pressure mean: 0.44904664158821106
loss_pred:0.04314790293574333, decouple_loss:0.033479150384664536
The generated pressure mean: 0.45027977228164673
loss_pred:0.04459592327475548, decouple_loss:0.031528737396001816
Iteration: 259, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4491617679595947
The generated pressure mean: 0.44830322265625
loss_pred:0.04300157353281975, decouple_loss:0.03034215234220028
loss_pred:0.04335891455411911, decouple_loss:0.031065160408616066
The generated pressure mean: 0.4489876627922058
loss_pred:0.04315763711929321, decouple_loss:0.03141624853014946
Iteration: 260, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4488048851490021
loss_pred:0.04339420050382614, decouple_loss:0.03209425136446953
The generated pressure mean: 0.449017196893692
loss_pred:0.04377659037709236, decouple_loss:0.031316690146923065
The generated pressure mean: 0.44817787408828735
loss_pred:0.043328624218702316, decouple_loss:0.03087238408625126
2023-04-16 02:26:06 testing...
The generated pressure mean: 0.4502691626548767
loss_pred:0.12331923097372055, decouple_loss:0.07940557599067688
The generated pressure mean: 0.4503246247768402
loss_pred:0.12006742507219315, decouple_loss:0.08220825344324112
The generated pressure mean: 0.450031042098999
loss_pred:0.12133520841598511, decouple_loss:0.08324097096920013
Loss: 0.12565487623214722, avg_mse: 0.15812037885189056
current test mse: 0.15812
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012001_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012001_3_24hr.npz
NaN value num: 0
Iteration: 261, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44751814007759094
loss_pred:0.04500337690114975, decouple_loss:0.03507047891616821
The generated pressure mean: 0.4480739235877991
loss_pred:0.043015941977500916, decouple_loss:0.035934608429670334
The generated pressure mean: 0.4466078281402588
loss_pred:0.04200240597128868, decouple_loss:0.03468362241983414
Iteration: 262, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4493900239467621
loss_pred:0.04399852082133293, decouple_loss:0.031777892261743546
The generated pressure mean: 0.44872555136680603
loss_pred:0.04099868983030319, decouple_loss:0.0319940559566021
The generated pressure mean: 0.4482365548610687
loss_pred:0.04001232981681824, decouple_loss:0.031520623713731766
Iteration: 263, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44723814725875854
loss_pred:0.044141173362731934, decouple_loss:0.03111083433032036
The generated pressure mean: 0.44733405113220215
loss_pred:0.0426078625023365, decouple_loss:0.03178436681628227
The generated pressure mean: 0.4471943974494934
loss_pred:0.041920147836208344, decouple_loss:0.03151656687259674
Iteration: 264, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44848060607910156
loss_pred:0.04293939098715782, decouple_loss:0.03170780837535858
The generated pressure mean: 0.4486177861690521
loss_pred:0.04035422205924988, decouple_loss:0.03279871121048927
The generated pressure mean: 0.44938158988952637
loss_pred:0.045397739857435226, decouple_loss:0.03270631656050682
Iteration: 265, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4471074938774109The generated pressure mean: 0.4493699371814728
loss_pred:0.04447266459465027, decouple_loss:0.030762407928705215
loss_pred:0.04210711270570755, decouple_loss:0.03125423938035965
The generated pressure mean: 0.44883784651756287
loss_pred:0.04221918433904648, decouple_loss:0.030205078423023224
Iteration: 266, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4472055733203888
loss_pred:0.04316793382167816, decouple_loss:0.028215844184160233
The generated pressure mean: 0.44874632358551025
loss_pred:0.04355453699827194, decouple_loss:0.029703862965106964
The generated pressure mean: 0.44705435633659363
loss_pred:0.04209061712026596, decouple_loss:0.02957010455429554
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 267, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4474485516548157The generated pressure mean: 0.4484003186225891
loss_pred:0.04233217611908913, decouple_loss:0.03278272971510887
loss_pred:0.0427543967962265, decouple_loss:0.031026121228933334
The generated pressure mean: 0.44852882623672485
loss_pred:0.04037933424115181, decouple_loss:0.03253035247325897
Iteration: 268, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44918423891067505
loss_pred:0.04273834452033043, decouple_loss:0.02977779507637024
The generated pressure mean: 0.4484401345252991
loss_pred:0.04184948280453682, decouple_loss:0.02963627316057682
The generated pressure mean: 0.4478071928024292
loss_pred:0.04091133549809456, decouple_loss:0.03004099801182747
Iteration: 269, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44615045189857483
The generated pressure mean: 0.44872698187828064
loss_pred:0.0401722714304924, decouple_loss:0.032886575907468796
loss_pred:0.04451797902584076, decouple_loss:0.031310033053159714
The generated pressure mean: 0.4478159546852112
loss_pred:0.04159530997276306, decouple_loss:0.030835013836622238
Iteration: 270, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44868770241737366
loss_pred:0.043524567037820816, decouple_loss:0.03364391252398491
The generated pressure mean: 0.4483261704444885
loss_pred:0.04367901012301445, decouple_loss:0.03127039223909378
The generated pressure mean: 0.446727991104126
loss_pred:0.04342605546116829, decouple_loss:0.033335551619529724
2023-04-16 02:28:49 testing...
The generated pressure mean: 0.4502691328525543
loss_pred:0.11672227084636688, decouple_loss:0.07135814428329468
The generated pressure mean: 0.450031042098999
loss_pred:0.11561550199985504, decouple_loss:0.07575541734695435
The generated pressure mean: 0.4503248333930969
loss_pred:0.1142835021018982, decouple_loss:0.0750359520316124
Loss: 0.11924292147159576, avg_mse: 0.15209507942199707
current test mse: 0.152095
Iteration: 271, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.448280930519104
The generated pressure mean: 0.447595477104187
loss_pred:0.042221054434776306, decouple_loss:0.03272732347249985
loss_pred:0.043037109076976776, decouple_loss:0.032827988266944885
The generated pressure mean: 0.4469643235206604
loss_pred:0.040772609412670135, decouple_loss:0.03500242903828621
Iteration: 272, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4485718011856079
loss_pred:0.040982648730278015, decouple_loss:0.0326729454100132
The generated pressure mean: 0.44824934005737305
loss_pred:0.039482805877923965, decouple_loss:0.03453484922647476
The generated pressure mean: 0.44923242926597595
loss_pred:0.04677411913871765, decouple_loss:0.03354409709572792
Iteration: 273, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44777554273605347
The generated pressure mean: 0.4472636878490448
loss_pred:0.041175972670316696, decouple_loss:0.03121332824230194
loss_pred:0.044617604464292526, decouple_loss:0.032769039273262024
The generated pressure mean: 0.44780004024505615
loss_pred:0.04300466552376747, decouple_loss:0.033238474279642105
Iteration: 274, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44756773114204407
loss_pred:0.04262913018465042, decouple_loss:0.03776542469859123
The generated pressure mean: 0.44701826572418213
loss_pred:0.04404539242386818, decouple_loss:0.03879976272583008
The generated pressure mean: 0.4490075707435608
loss_pred:0.04388115182518959, decouple_loss:0.03805413097143173
Iteration: 275, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4478653073310852
loss_pred:0.03861432150006294, decouple_loss:0.03066070005297661
The generated pressure mean: 0.44801029562950134
loss_pred:0.04000265523791313, decouple_loss:0.03150290623307228
The generated pressure mean: 0.44882553815841675
loss_pred:0.0414968840777874, decouple_loss:0.031974855810403824
Iteration: 276, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44958531856536865
loss_pred:0.04279019311070442, decouple_loss:0.041051704436540604
The generated pressure mean: 0.4476589262485504
loss_pred:0.04264051467180252, decouple_loss:0.03654614835977554
The generated pressure mean: 0.44680261611938477
loss_pred:0.04332192242145538, decouple_loss:0.038345664739608765
Iteration: 277, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44786545634269714
loss_pred:0.04207256808876991, decouple_loss:0.03102291375398636
The generated pressure mean: 0.44766542315483093
loss_pred:0.03970357030630112, decouple_loss:0.030725371092557907
The generated pressure mean: 0.4458083212375641
loss_pred:0.04185635596513748, decouple_loss:0.03167825937271118
Iteration: 278, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4489256739616394
loss_pred:0.04122087359428406, decouple_loss:0.035205140709877014
The generated pressure mean: 0.4481309950351715
loss_pred:0.041707854717969894, decouple_loss:0.03530627861618996
The generated pressure mean: 0.44860854744911194
loss_pred:0.04147924482822418, decouple_loss:0.0343727208673954
Iteration: 279, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.446316123008728
loss_pred:0.040481239557266235, decouple_loss:0.02918284945189953
The generated pressure mean: 0.4465446174144745
loss_pred:0.04240544140338898, decouple_loss:0.029781069606542587
The generated pressure mean: 0.4476407766342163
loss_pred:0.04255814477801323, decouple_loss:0.03063480742275715
Iteration: 280, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4465849995613098
loss_pred:0.04365331307053566, decouple_loss:0.03542018309235573
The generated pressure mean: 0.4478796124458313
loss_pred:0.040483176708221436, decouple_loss:0.035837773233652115
The generated pressure mean: 0.4471642076969147
loss_pred:0.044013235718011856, decouple_loss:0.03867967426776886
2023-04-16 02:30:55 testing...
The generated pressure mean: 0.4502691626548767
loss_pred:0.1189691424369812, decouple_loss:0.06993333995342255
The generated pressure mean: 0.45032447576522827
loss_pred:0.11687196046113968, decouple_loss:0.07369344681501389
The generated pressure mean: 0.45003077387809753
loss_pred:0.11830423027276993, decouple_loss:0.0746162161231041
Loss: 0.12168582528829575, avg_mse: 0.1591068059206009
current test mse: 0.159107
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012013_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012013_3_24hr.npz
NaN value num: 0
Iteration: 281, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44802987575531006
loss_pred:0.042411915957927704, decouple_loss:0.031033048406243324
The generated pressure mean: 0.4471907913684845
loss_pred:0.0422135628759861, decouple_loss:0.03038652054965496
The generated pressure mean: 0.44781482219696045
loss_pred:0.04039933905005455, decouple_loss:0.031563885509967804
Iteration: 282, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44715848565101624
loss_pred:0.04178248345851898, decouple_loss:0.035719480365514755
The generated pressure mean: 0.4475450813770294
loss_pred:0.04294653981924057, decouple_loss:0.03537282720208168
The generated pressure mean: 0.44810613989830017
loss_pred:0.04296506568789482, decouple_loss:0.032468657940626144
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 283, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4475492537021637
loss_pred:0.041484374552965164, decouple_loss:0.032525867223739624
The generated pressure mean: 0.4470607042312622
loss_pred:0.040524620562791824, decouple_loss:0.033365242183208466
The generated pressure mean: 0.44729578495025635
loss_pred:0.04295841231942177, decouple_loss:0.03478403016924858
Iteration: 284, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44777384400367737
loss_pred:0.04121915251016617, decouple_loss:0.030589574947953224
The generated pressure mean: 0.4472619593143463
loss_pred:0.04145243018865585, decouple_loss:0.029282376170158386
The generated pressure mean: 0.4475480318069458
loss_pred:0.04145873337984085, decouple_loss:0.031485725194215775
Iteration: 285, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4463169276714325
loss_pred:0.04394625127315521, decouple_loss:0.03012041747570038
The generated pressure mean: 0.44680196046829224
loss_pred:0.04245951771736145, decouple_loss:0.03061085008084774
The generated pressure mean: 0.44816383719444275
loss_pred:0.04208222031593323, decouple_loss:0.029627621173858643
Iteration: 286, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4471133053302765The generated pressure mean: 0.4473491311073303
loss_pred:0.0420859195291996, decouple_loss:0.03060956671833992
loss_pred:0.041204217821359634, decouple_loss:0.03153239190578461
The generated pressure mean: 0.44709232449531555
loss_pred:0.042492013424634933, decouple_loss:0.029648402705788612
Iteration: 287, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4464784562587738
loss_pred:0.04102439060807228, decouple_loss:0.03194795176386833
The generated pressure mean: 0.44731757044792175
loss_pred:0.042955733835697174, decouple_loss:0.032471977174282074
The generated pressure mean: 0.4469206631183624
loss_pred:0.041200052946805954, decouple_loss:0.03207150474190712
Iteration: 288, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44797709584236145
loss_pred:0.043749041855335236, decouple_loss:0.030448123812675476
The generated pressure mean: 0.4471213221549988
loss_pred:0.040731918066740036, decouple_loss:0.030348865315318108
The generated pressure mean: 0.4478301703929901
loss_pred:0.03990377485752106, decouple_loss:0.030082082375884056
Iteration: 289, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4468194544315338The generated pressure mean: 0.4479365944862366
loss_pred:0.041785575449466705, decouple_loss:0.031481899321079254
loss_pred:0.0411091186106205, decouple_loss:0.03091510385274887
The generated pressure mean: 0.4475893974304199
loss_pred:0.043283455073833466, decouple_loss:0.03073718398809433
Iteration: 290, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4476172626018524
loss_pred:0.039846330881118774, decouple_loss:0.028691532090306282
The generated pressure mean: 0.4472237825393677
loss_pred:0.04083297774195671, decouple_loss:0.028359845280647278
The generated pressure mean: 0.4482899606227875
loss_pred:0.03851635009050369, decouple_loss:0.030475853011012077
2023-04-16 02:33:45 testing...
The generated pressure mean: 0.4502691626548767
loss_pred:0.12670543789863586, decouple_loss:0.08055596053600311
The generated pressure mean: 0.4503245949745178
loss_pred:0.12396600842475891, decouple_loss:0.08361777663230896
The generated pressure mean: 0.4500308334827423
loss_pred:0.12466302514076233, decouple_loss:0.08326265215873718
Loss: 0.1292354315519333, avg_mse: 0.1700783669948578
current test mse: 0.170078
Iteration: 291, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44616439938545227
loss_pred:0.041165098547935486, decouple_loss:0.03123367764055729
The generated pressure mean: 0.44830837845802307
loss_pred:0.039720647037029266, decouple_loss:0.030777819454669952
The generated pressure mean: 0.4472401440143585
loss_pred:0.04140337184071541, decouple_loss:0.03399483114480972
Iteration: 292, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4481900930404663
loss_pred:0.039970409125089645, decouple_loss:0.030584704130887985
The generated pressure mean: 0.4466922879219055
loss_pred:0.04142189770936966, decouple_loss:0.02921963669359684
The generated pressure mean: 0.4468398094177246
loss_pred:0.039021190255880356, decouple_loss:0.029708256945014
Iteration: 293, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44768354296684265
loss_pred:0.04150919243693352, decouple_loss:0.031710945069789886
The generated pressure mean: 0.4484233558177948
loss_pred:0.041235145181417465, decouple_loss:0.030426492914557457
The generated pressure mean: 0.44695842266082764
loss_pred:0.03935138136148453, decouple_loss:0.032534293830394745
Iteration: 294, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4475657641887665
loss_pred:0.04100025072693825, decouple_loss:0.028575971722602844
The generated pressure mean: 0.44623640179634094
loss_pred:0.043056122958660126, decouple_loss:0.028759470209479332
The generated pressure mean: 0.4477924108505249
loss_pred:0.04109939560294151, decouple_loss:0.028465883806347847
Iteration: 295, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44682931900024414
loss_pred:0.04279800131917, decouple_loss:0.030931204557418823
The generated pressure mean: 0.44814348220825195
loss_pred:0.039026930928230286, decouple_loss:0.030790768563747406
The generated pressure mean: 0.44688132405281067
loss_pred:0.03969413787126541, decouple_loss:0.03065640479326248
Iteration: 296, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4481799006462097
loss_pred:0.04151450842618942, decouple_loss:0.031203657388687134
The generated pressure mean: 0.4471765458583832
loss_pred:0.04181179031729698, decouple_loss:0.030785387381911278
The generated pressure mean: 0.4475301504135132
loss_pred:0.039864011108875275, decouple_loss:0.029156407341361046
Iteration: 297, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44766122102737427
loss_pred:0.03873784467577934, decouple_loss:0.030191274359822273
The generated pressure mean: 0.4473554193973541
loss_pred:0.039594341069459915, decouple_loss:0.03213372826576233
The generated pressure mean: 0.44710230827331543
loss_pred:0.03839441016316414, decouple_loss:0.03030243143439293
Iteration: 298, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4480436146259308
loss_pred:0.038239993155002594, decouple_loss:0.028251996263861656
The generated pressure mean: 0.44782203435897827
loss_pred:0.04113110527396202, decouple_loss:0.029924221336841583
The generated pressure mean: 0.4485245943069458
loss_pred:0.04598989710211754, decouple_loss:0.028921468183398247
Iteration: 299, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4465617835521698
loss_pred:0.04384857788681984, decouple_loss:0.0326932929456234
The generated pressure mean: 0.44707542657852173
loss_pred:0.04591624066233635, decouple_loss:0.03355050086975098
The generated pressure mean: 0.44763216376304626
loss_pred:0.04227731376886368, decouple_loss:0.03243991732597351
Iteration: 300, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44665205478668213
loss_pred:0.04277476295828819, decouple_loss:0.037112221121788025
The generated pressure mean: 0.4470793306827545
loss_pred:0.043780744075775146, decouple_loss:0.03378673642873764
The generated pressure mean: 0.4463886618614197
loss_pred:0.042098697274923325, decouple_loss:0.03627116605639458
2023-04-16 02:35:52 testing...
The generated pressure mean: 0.4502691328525543
loss_pred:0.12178386747837067, decouple_loss:0.081206776201725
The generated pressure mean: 0.45003125071525574
loss_pred:0.11898595094680786, decouple_loss:0.08414991945028305
The generated pressure mean: 0.45032456517219543
loss_pred:0.11924447119235992, decouple_loss:0.08536770939826965
Loss: 0.12418350577354431, avg_mse: 0.16585712134838104
current test mse: 0.165857
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012002_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012002_3_24hr.npz
NaN value num: 0
Iteration: 301, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44965583086013794
loss_pred:0.042355503886938095, decouple_loss:0.03962261974811554
The generated pressure mean: 0.44726791977882385
The generated pressure mean: 0.45018500089645386
loss_pred:0.044503480195999146, decouple_loss:0.031697556376457214
loss_pred:0.04247293248772621, decouple_loss:0.0384887233376503
Iteration: 302, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4494214355945587
loss_pred:0.03983776643872261, decouple_loss:0.03583265468478203
The generated pressure mean: 0.44813108444213867The generated pressure mean: 0.448939710855484
loss_pred:0.0427032932639122, decouple_loss:0.0353095568716526loss_pred:0.042430028319358826, decouple_loss:0.03277064859867096
Iteration: 303, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44929996132850647
loss_pred:0.04133125767111778, decouple_loss:0.03257984668016434
The generated pressure mean: 0.44827142357826233
loss_pred:0.04258211702108383, decouple_loss:0.0320836640894413
The generated pressure mean: 0.4494643211364746
loss_pred:0.04158155247569084, decouple_loss:0.032960738986730576
Iteration: 304, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4485272765159607
loss_pred:0.04306202009320259, decouple_loss:0.03300691023468971
The generated pressure mean: 0.44768667221069336
loss_pred:0.04699272662401199, decouple_loss:0.034334342926740646
The generated pressure mean: 0.4478306472301483
loss_pred:0.04132092371582985, decouple_loss:0.03270529583096504
Iteration: 305, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4505300521850586
loss_pred:0.039917632937431335, decouple_loss:0.03600142151117325
The generated pressure mean: 0.4503728449344635
loss_pred:0.04236307367682457, decouple_loss:0.03628281503915787
The generated pressure mean: 0.4492013156414032
loss_pred:0.04053010046482086, decouple_loss:0.03546798974275589
Iteration: 306, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44896721839904785
loss_pred:0.04378907009959221, decouple_loss:0.031113578006625175
The generated pressure mean: 0.44877102971076965
loss_pred:0.042510755360126495, decouple_loss:0.031164688989520073
The generated pressure mean: 0.45033228397369385
loss_pred:0.04211163520812988, decouple_loss:0.03258360177278519
Iteration: 307, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44792136549949646
The generated pressure mean: 0.45076677203178406loss_pred:0.041090644896030426, decouple_loss:0.03174072876572609
loss_pred:0.03973293676972389, decouple_loss:0.0345454141497612
The generated pressure mean: 0.4487679898738861
loss_pred:0.04160170257091522, decouple_loss:0.0329107940196991
Iteration: 308, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4482336640357971
loss_pred:0.04036855325102806, decouple_loss:0.03286624699831009
The generated pressure mean: 0.44807079434394836
loss_pred:0.03932679072022438, decouple_loss:0.03324713557958603
The generated pressure mean: 0.4487672448158264
loss_pred:0.04090240225195885, decouple_loss:0.032510966062545776
Iteration: 309, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44926995038986206
loss_pred:0.041933078318834305, decouple_loss:0.03905639797449112
The generated pressure mean: 0.4480063319206238
loss_pred:0.03978462889790535, decouple_loss:0.0340447872877121
The generated pressure mean: 0.44920119643211365
loss_pred:0.038278862833976746, decouple_loss:0.035205431282520294
Iteration: 310, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4522305130958557
loss_pred:0.041007108986377716, decouple_loss:0.036965567618608475
The generated pressure mean: 0.44784149527549744
loss_pred:0.03809059411287308, decouple_loss:0.03421148657798767
The generated pressure mean: 0.4513237178325653
loss_pred:0.03975810110569, decouple_loss:0.03630691394209862
2023-04-16 02:38:35 testing...
The generated pressure mean: 0.4502691328525543
loss_pred:0.12282727658748627, decouple_loss:0.07488548755645752
The generated pressure mean: 0.45032426714897156
loss_pred:0.12079329043626785, decouple_loss:0.07480211555957794
The generated pressure mean: 0.4500313699245453
loss_pred:0.12125501781702042, decouple_loss:0.07524849474430084
Loss: 0.12537413835525513, avg_mse: 0.17056548595428467
current test mse: 0.170565
Iteration: 311, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44933125376701355
loss_pred:0.04302532970905304, decouple_loss:0.032550327479839325
The generated pressure mean: 0.44736382365226746
loss_pred:0.042350154370069504, decouple_loss:0.034347210079431534
The generated pressure mean: 0.44899114966392517
loss_pred:0.04060927405953407, decouple_loss:0.03372352197766304
Iteration: 312, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4484265148639679
loss_pred:0.0413113608956337, decouple_loss:0.032777491956949234
The generated pressure mean: 0.44784337282180786
loss_pred:0.04215911775827408, decouple_loss:0.03377328813076019
The generated pressure mean: 0.44951677322387695
loss_pred:0.04098619148135185, decouple_loss:0.03675789013504982
Iteration: 313, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44795921444892883
loss_pred:0.03967221453785896, decouple_loss:0.0333261638879776
The generated pressure mean: 0.448556125164032
loss_pred:0.03782385587692261, decouple_loss:0.03482361137866974
The generated pressure mean: 0.44799983501434326
loss_pred:0.04135696589946747, decouple_loss:0.03280963748693466
Iteration: 314, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44897499680519104
loss_pred:0.0404701828956604, decouple_loss:0.030968591570854187
The generated pressure mean: 0.44992855191230774
loss_pred:0.040252212435007095, decouple_loss:0.0346304327249527
The generated pressure mean: 0.44969770312309265
loss_pred:0.039737217128276825, decouple_loss:0.03437430039048195
Iteration: 315, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4497334957122803
loss_pred:0.03795022889971733, decouple_loss:0.03190802037715912
The generated pressure mean: 0.44865086674690247
loss_pred:0.042735327035188675, decouple_loss:0.033615827560424805
The generated pressure mean: 0.44958066940307617
loss_pred:0.03764818608760834, decouple_loss:0.03392408788204193
Iteration: 316, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44823694229125977
loss_pred:0.041896771639585495, decouple_loss:0.034502387046813965
The generated pressure mean: 0.44798991084098816
loss_pred:0.040165647864341736, decouple_loss:0.03479452058672905
The generated pressure mean: 0.4491364359855652
loss_pred:0.03979342803359032, decouple_loss:0.03446414694190025
Iteration: 317, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45029416680336
loss_pred:0.0388772152364254, decouple_loss:0.03288305923342705
The generated pressure mean: 0.44895145297050476
loss_pred:0.04008039832115173, decouple_loss:0.032633233815431595
The generated pressure mean: 0.4495083689689636
loss_pred:0.04149977117776871, decouple_loss:0.034151360392570496
Iteration: 318, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4506111443042755
loss_pred:0.03839420899748802, decouple_loss:0.03172476217150688
The generated pressure mean: 0.44937941431999207
loss_pred:0.040070537477731705, decouple_loss:0.03186318278312683
The generated pressure mean: 0.4474885165691376
loss_pred:0.03907205909490585, decouple_loss:0.029069017618894577
Iteration: 319, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44812214374542236
The generated pressure mean: 0.4503287971019745loss_pred:0.0399693138897419, decouple_loss:0.03164195269346237
loss_pred:0.038551218807697296, decouple_loss:0.033442385494709015
The generated pressure mean: 0.44964778423309326
loss_pred:0.038738057017326355, decouple_loss:0.033542100340127945
Iteration: 320, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44947755336761475
loss_pred:0.03915845975279808, decouple_loss:0.03069554828107357
The generated pressure mean: 0.44868984818458557
loss_pred:0.038961268961429596, decouple_loss:0.030446814373135567
The generated pressure mean: 0.44842979311943054
loss_pred:0.040067244321107864, decouple_loss:0.030461858958005905
2023-04-16 02:40:41 testing...
The generated pressure mean: 0.4502691626548767
loss_pred:0.12859635055065155, decouple_loss:0.08474456518888474
The generated pressure mean: 0.4503244161605835
loss_pred:0.1256476789712906, decouple_loss:0.08566254377365112
The generated pressure mean: 0.45003175735473633
loss_pred:0.12603497505187988, decouple_loss:0.0840262919664383
Loss: 0.13100022077560425, avg_mse: 0.18255668878555298
current test mse: 0.182557
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012016_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012016_3_24hr.npz
NaN value num: 0
Iteration: 321, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44775405526161194
loss_pred:0.04100801423192024, decouple_loss:0.03499685972929001
The generated pressure mean: 0.4477737843990326
loss_pred:0.039506275206804276, decouple_loss:0.03704901412129402
The generated pressure mean: 0.4481610059738159
loss_pred:0.04215395450592041, decouple_loss:0.034110672771930695
Iteration: 322, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44796472787857056
The generated pressure mean: 0.4483642578125loss_pred:0.04336085915565491, decouple_loss:0.036432016640901566
loss_pred:0.042648617178201675, decouple_loss:0.03551951423287392
The generated pressure mean: 0.4465872347354889
loss_pred:0.04028024524450302, decouple_loss:0.03595486283302307
Iteration: 323, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4475368559360504
loss_pred:0.039075497537851334, decouple_loss:0.03292958810925484
The generated pressure mean: 0.4481295347213745
The generated pressure mean: 0.44842833280563354
loss_pred:0.042300451546907425, decouple_loss:0.03281983360648155
loss_pred:0.04194888845086098, decouple_loss:0.03314261510968208
Iteration: 324, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4481000602245331
loss_pred:0.041606511920690536, decouple_loss:0.034826841205358505
The generated pressure mean: 0.4480193257331848
loss_pred:0.04194807633757591, decouple_loss:0.03548125550150871
The generated pressure mean: 0.44787129759788513
loss_pred:0.04038391262292862, decouple_loss:0.03563760966062546
Iteration: 325, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44685059785842896
loss_pred:0.03802432119846344, decouple_loss:0.034156300127506256
The generated pressure mean: 0.4491631090641022
loss_pred:0.03903679549694061, decouple_loss:0.03333762660622597
The generated pressure mean: 0.4486089050769806
loss_pred:0.038491539657115936, decouple_loss:0.03411681577563286
Iteration: 326, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44870495796203613
loss_pred:0.04271066188812256, decouple_loss:0.03369314968585968
The generated pressure mean: 0.4476526081562042
loss_pred:0.04264456406235695, decouple_loss:0.034675758332014084
The generated pressure mean: 0.44916027784347534
loss_pred:0.041593387722969055, decouple_loss:0.033646389842033386
Iteration: 327, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44772639870643616
loss_pred:0.041344042867422104, decouple_loss:0.03401389345526695
The generated pressure mean: 0.4482378363609314
loss_pred:0.03885883092880249, decouple_loss:0.03242707997560501
The generated pressure mean: 0.44759252667427063
loss_pred:0.04155058041214943, decouple_loss:0.03269447386264801
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 328, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44833695888519287
loss_pred:0.04059125855565071, decouple_loss:0.030061081051826477
The generated pressure mean: 0.4481534957885742
loss_pred:0.04241875186562538, decouple_loss:0.03218507021665573
The generated pressure mean: 0.4478710889816284
loss_pred:0.04149754345417023, decouple_loss:0.030413741245865822
Iteration: 329, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44738927483558655
loss_pred:0.03983362019062042, decouple_loss:0.032291922718286514
The generated pressure mean: 0.44734445214271545
loss_pred:0.038327090442180634, decouple_loss:0.031760431826114655
The generated pressure mean: 0.44858017563819885
loss_pred:0.04067794978618622, decouple_loss:0.03333446756005287
Iteration: 330, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44803279638290405
loss_pred:0.04151599854230881, decouple_loss:0.03338349238038063
The generated pressure mean: 0.4472264349460602
loss_pred:0.03848165646195412, decouple_loss:0.0326010026037693
The generated pressure mean: 0.4479292929172516
loss_pred:0.0390605665743351, decouple_loss:0.03238258510828018
2023-04-16 02:43:34 testing...
The generated pressure mean: 0.4502691328525543
loss_pred:0.12760725617408752, decouple_loss:0.07383054494857788
The generated pressure mean: 0.45032551884651184
loss_pred:0.12502072751522064, decouple_loss:0.07653886824846268
The generated pressure mean: 0.4500311315059662
loss_pred:0.12527181208133698, decouple_loss:0.07589346915483475
Loss: 0.12973764538764954, avg_mse: 0.18372218310832977
current test mse: 0.183722
Iteration: 331, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44890326261520386
loss_pred:0.04083075746893883, decouple_loss:0.029669951647520065
The generated pressure mean: 0.44836634397506714
loss_pred:0.0384146086871624, decouple_loss:0.028757160529494286
The generated pressure mean: 0.44818320870399475
loss_pred:0.040016643702983856, decouple_loss:0.0311087965965271
Iteration: 332, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44817054271698
The generated pressure mean: 0.44838854670524597loss_pred:0.04038062319159508, decouple_loss:0.029689939692616463
loss_pred:0.041831523180007935, decouple_loss:0.0313686765730381
The generated pressure mean: 0.4480600953102112
loss_pred:0.043476175516843796, decouple_loss:0.031764548271894455
Iteration: 333, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4482381343841553
loss_pred:0.04117793217301369, decouple_loss:0.02990078367292881
The generated pressure mean: 0.44748973846435547
loss_pred:0.04096096754074097, decouple_loss:0.02928038313984871
The generated pressure mean: 0.4479111135005951
loss_pred:0.04256579279899597, decouple_loss:0.029647981747984886
Iteration: 334, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4478406608104706
loss_pred:0.03986832872033119, decouple_loss:0.030412795022130013
The generated pressure mean: 0.4483362138271332
loss_pred:0.041422367095947266, decouple_loss:0.0314609631896019
The generated pressure mean: 0.44755756855010986
loss_pred:0.04476846382021904, decouple_loss:0.033075157552957535
Iteration: 335, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4482056498527527The generated pressure mean: 0.44775789976119995
loss_pred:0.0373324491083622, decouple_loss:0.03157421201467514
loss_pred:0.040174636989831924, decouple_loss:0.0301812794059515
The generated pressure mean: 0.44687989354133606
loss_pred:0.038261618465185165, decouple_loss:0.03127628192305565
Iteration: 336, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4471170902252197
The generated pressure mean: 0.44810038805007935
loss_pred:0.04015175625681877, decouple_loss:0.03305894508957863
loss_pred:0.03825865685939789, decouple_loss:0.03142811357975006
The generated pressure mean: 0.44811105728149414
loss_pred:0.040338851511478424, decouple_loss:0.0345238521695137
Iteration: 337, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44831496477127075
loss_pred:0.04109989479184151, decouple_loss:0.03147877752780914
The generated pressure mean: 0.44806361198425293
loss_pred:0.040730852633714676, decouple_loss:0.031270284205675125
The generated pressure mean: 0.4476741850376129
loss_pred:0.0405522957444191, decouple_loss:0.030259760096669197
Iteration: 338, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44871512055397034
The generated pressure mean: 0.44848233461380005loss_pred:0.04005429521203041, decouple_loss:0.03470488265156746
loss_pred:0.04055166617035866, decouple_loss:0.034584127366542816
The generated pressure mean: 0.4478972256183624
loss_pred:0.040536925196647644, decouple_loss:0.035048987716436386
Iteration: 339, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4477640688419342
loss_pred:0.04026113450527191, decouple_loss:0.02731761895120144
The generated pressure mean: 0.44776421785354614
loss_pred:0.04216466471552849, decouple_loss:0.02921760082244873
The generated pressure mean: 0.44780486822128296
loss_pred:0.04165884479880333, decouple_loss:0.02945481427013874
Iteration: 340, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44819343090057373
loss_pred:0.0402204655110836, decouple_loss:0.03457748144865036
The generated pressure mean: 0.44809776544570923
loss_pred:0.039945319294929504, decouple_loss:0.03440253436565399
The generated pressure mean: 0.44829508662223816
loss_pred:0.039909448474645615, decouple_loss:0.03501811996102333
2023-04-16 02:45:40 testing...
The generated pressure mean: 0.4502691626548767
loss_pred:0.127104714512825, decouple_loss:0.08168783783912659
The generated pressure mean: 0.4503246247768402
loss_pred:0.12478314340114594, decouple_loss:0.0850801169872284
The generated pressure mean: 0.45003122091293335
loss_pred:0.12526766955852509, decouple_loss:0.08427320420742035
Loss: 0.12990252673625946, avg_mse: 0.1846514344215393
current test mse: 0.184651
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012006_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012006_3_24hr.npz
NaN value num: 0
Iteration: 341, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44925788044929504
loss_pred:0.03805415704846382, decouple_loss:0.02914615534245968
The generated pressure mean: 0.44851920008659363
loss_pred:0.04022717848420143, decouple_loss:0.02970460057258606
The generated pressure mean: 0.44873541593551636
loss_pred:0.04163825139403343, decouple_loss:0.028318842872977257
Iteration: 342, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45030078291893005
loss_pred:0.04247484728693962, decouple_loss:0.03469323739409447
The generated pressure mean: 0.44892436265945435
loss_pred:0.040555406361818314, decouple_loss:0.03308180347084999
The generated pressure mean: 0.449523389339447
loss_pred:0.03997831791639328, decouple_loss:0.03307315707206726
Iteration: 343, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44939562678337097
loss_pred:0.04017812758684158, decouple_loss:0.031541284173727036
The generated pressure mean: 0.44937920570373535
loss_pred:0.03873418644070625, decouple_loss:0.033159900456666946
The generated pressure mean: 0.44911596179008484
loss_pred:0.03903576359152794, decouple_loss:0.03218388557434082
Iteration: 344, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.449162095785141
loss_pred:0.040297746658325195, decouple_loss:0.03441212326288223
The generated pressure mean: 0.44897615909576416
loss_pred:0.03912648931145668, decouple_loss:0.034805912524461746
The generated pressure mean: 0.4492243528366089
loss_pred:0.03722989186644554, decouple_loss:0.03307323902845383
Iteration: 345, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44942304491996765
loss_pred:0.03987482190132141, decouple_loss:0.028900403529405594
The generated pressure mean: 0.4495528042316437
loss_pred:0.0380166620016098, decouple_loss:0.029479343444108963
The generated pressure mean: 0.449715256690979
loss_pred:0.03775918483734131, decouple_loss:0.03073379024863243
Iteration: 346, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4485816955566406
loss_pred:0.03733142465353012, decouple_loss:0.029185611754655838
The generated pressure mean: 0.4482605457305908
loss_pred:0.03790830075740814, decouple_loss:0.03199165686964989
The generated pressure mean: 0.4497528672218323
loss_pred:0.03831970691680908, decouple_loss:0.031066861003637314
Iteration: 347, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4487563669681549
The generated pressure mean: 0.44953033328056335
loss_pred:0.03983165696263313, decouple_loss:0.028467880561947823
loss_pred:0.03860628977417946, decouple_loss:0.029937859624624252
The generated pressure mean: 0.4498045742511749
loss_pred:0.03844841942191124, decouple_loss:0.030796648934483528
Iteration: 348, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.449333518743515
loss_pred:0.03916488215327263, decouple_loss:0.02751377411186695
The generated pressure mean: 0.44874879717826843
loss_pred:0.038714513182640076, decouple_loss:0.028561662882566452
The generated pressure mean: 0.4486593008041382
loss_pred:0.03922758996486664, decouple_loss:0.027485793456435204
Iteration: 349, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44898635149002075
loss_pred:0.0405668281018734, decouple_loss:0.030698679387569427
The generated pressure mean: 0.44914862513542175
loss_pred:0.038184717297554016, decouple_loss:0.03132489696145058
The generated pressure mean: 0.44893208146095276
loss_pred:0.03798095881938934, decouple_loss:0.031271759420633316
Iteration: 350, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4484058618545532
The generated pressure mean: 0.44974449276924133
loss_pred:0.035945020616054535, decouple_loss:0.028216222301125526
loss_pred:0.04098506271839142, decouple_loss:0.02933804877102375
The generated pressure mean: 0.4485626220703125
loss_pred:0.040594957768917084, decouple_loss:0.028917362913489342
2023-04-16 02:48:20 testing...
The generated pressure mean: 0.4502691924571991
loss_pred:0.13026615977287292, decouple_loss:0.08854161947965622
The generated pressure mean: 0.450324147939682
loss_pred:0.12720586359500885, decouple_loss:0.09088228642940521
The generated pressure mean: 0.4500311613082886
loss_pred:0.12763550877571106, decouple_loss:0.08933081477880478
Loss: 0.13284841179847717, avg_mse: 0.1931060403585434
current test mse: 0.193106
Iteration: 351, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45076873898506165
loss_pred:0.03839792311191559, decouple_loss:0.03148985654115677
The generated pressure mean: 0.44805121421813965
loss_pred:0.0394129641354084, decouple_loss:0.030337590724229813
The generated pressure mean: 0.4483972489833832
loss_pred:0.03620210289955139, decouple_loss:0.029708970338106155
Iteration: 352, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44841888546943665
loss_pred:0.039761561900377274, decouple_loss:0.028707467019557953
The generated pressure mean: 0.44801896810531616
loss_pred:0.03875773027539253, decouple_loss:0.029333097860217094
The generated pressure mean: 0.44909387826919556
loss_pred:0.036906398832798004, decouple_loss:0.03105134330689907
Iteration: 353, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4500141739845276
loss_pred:0.04147906228899956, decouple_loss:0.027076715603470802
The generated pressure mean: 0.4489968419075012
loss_pred:0.03713744878768921, decouple_loss:0.02596454881131649
The generated pressure mean: 0.44865700602531433
loss_pred:0.03704826533794403, decouple_loss:0.026868565008044243
Iteration: 354, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44844305515289307
The generated pressure mean: 0.44928890466690063
loss_pred:0.038664933294057846, decouple_loss:0.02866767719388008
loss_pred:0.037191763520240784, decouple_loss:0.028760194778442383
The generated pressure mean: 0.4493497312068939
loss_pred:0.037706680595874786, decouple_loss:0.02801114320755005
Iteration: 355, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44935014843940735
loss_pred:0.03644079715013504, decouple_loss:0.025841815397143364
The generated pressure mean: 0.45028555393218994
loss_pred:0.03948565945029259, decouple_loss:0.026362352073192596
The generated pressure mean: 0.44818320870399475
loss_pred:0.03767590597271919, decouple_loss:0.02643601782619953
Iteration: 356, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45002537965774536
loss_pred:0.038696546107530594, decouple_loss:0.026774942874908447
The generated pressure mean: 0.45001816749572754
loss_pred:0.03598376736044884, decouple_loss:0.027598606422543526
The generated pressure mean: 0.44915971159935
loss_pred:0.03707455098628998, decouple_loss:0.026757001876831055
Iteration: 357, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4479113817214966
loss_pred:0.03830421715974808, decouple_loss:0.026837170124053955
The generated pressure mean: 0.44772952795028687
loss_pred:0.03887229040265083, decouple_loss:0.027523942291736603
The generated pressure mean: 0.4490707218647003
loss_pred:0.035877469927072525, decouple_loss:0.02743000164628029
Iteration: 358, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44819048047065735
loss_pred:0.0359160415828228, decouple_loss:0.026385588571429253
The generated pressure mean: 0.4485102891921997
loss_pred:0.035572316497564316, decouple_loss:0.0275250393897295
The generated pressure mean: 0.4505431652069092
loss_pred:0.03850869834423065, decouple_loss:0.027493922039866447
Iteration: 359, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4498012065887451
loss_pred:0.03766334429383278, decouple_loss:0.024241872131824493
The generated pressure mean: 0.4493936598300934
loss_pred:0.03804401680827141, decouple_loss:0.024235932156443596
The generated pressure mean: 0.44828203320503235
loss_pred:0.03571706265211105, decouple_loss:0.025090768933296204
Iteration: 360, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44849497079849243
loss_pred:0.037799540907144547, decouple_loss:0.027347741648554802
The generated pressure mean: 0.449243426322937
loss_pred:0.03728267922997475, decouple_loss:0.029025908559560776
The generated pressure mean: 0.44898051023483276
loss_pred:0.038818515837192535, decouple_loss:0.02740579843521118
2023-04-16 02:50:26 testing...
The generated pressure mean: 0.4502691626548767
loss_pred:0.12816770374774933, decouple_loss:0.08118007332086563
The generated pressure mean: 0.45032432675361633
loss_pred:0.12451210618019104, decouple_loss:0.0847783088684082
The generated pressure mean: 0.45003074407577515
loss_pred:0.12487731128931046, decouple_loss:0.0834275484085083
Loss: 0.13000881671905518, avg_mse: 0.1866215169429779
current test mse: 0.186622
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012000_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012000_3_24hr.npz
NaN value num: 0
Iteration: 361, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44947007298469543
loss_pred:0.03923778608441353, decouple_loss:0.029042556881904602
The generated pressure mean: 0.44791918992996216
loss_pred:0.037339042872190475, decouple_loss:0.025617701932787895
The generated pressure mean: 0.44945117831230164
loss_pred:0.037080131471157074, decouple_loss:0.024658020585775375
Iteration: 362, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44917210936546326
loss_pred:0.03799748048186302, decouple_loss:0.02842259407043457
The generated pressure mean: 0.44785410165786743
loss_pred:0.037487614899873734, decouple_loss:0.02541424334049225
The generated pressure mean: 0.4485175907611847
loss_pred:0.03700292110443115, decouple_loss:0.026854021474719048
Iteration: 363, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44957658648490906
loss_pred:0.03774610906839371, decouple_loss:0.026312122121453285
The generated pressure mean: 0.4478338956832886
loss_pred:0.03803098201751709, decouple_loss:0.025415733456611633
The generated pressure mean: 0.44967442750930786
loss_pred:0.03868228569626808, decouple_loss:0.02548716776072979
Iteration: 364, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4493422210216522
loss_pred:0.03832142427563667, decouple_loss:0.030968135222792625
The generated pressure mean: 0.44761964678764343
loss_pred:0.03599381074309349, decouple_loss:0.03071741573512554
The generated pressure mean: 0.44940319657325745
loss_pred:0.03706943616271019, decouple_loss:0.029391678050160408
Iteration: 365, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4488934874534607
The generated pressure mean: 0.44840455055236816loss_pred:0.03657729923725128, decouple_loss:0.02597544528543949
loss_pred:0.03796609863638878, decouple_loss:0.02621634304523468
The generated pressure mean: 0.4477691054344177
loss_pred:0.037735968828201294, decouple_loss:0.026502689346671104
Iteration: 366, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44881317019462585
loss_pred:0.03692882880568504, decouple_loss:0.026488402858376503
The generated pressure mean: 0.44846808910369873
loss_pred:0.03843584656715393, decouple_loss:0.02590370923280716
The generated pressure mean: 0.4469749927520752
loss_pred:0.03808388113975525, decouple_loss:0.027257045730948448
Iteration: 367, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44659262895584106
loss_pred:0.038227226585149765, decouple_loss:0.026327280327677727
The generated pressure mean: 0.44942548871040344
loss_pred:0.03887809440493584, decouple_loss:0.02959245815873146
The generated pressure mean: 0.44795912504196167
loss_pred:0.03733772784471512, decouple_loss:0.026739150285720825
Iteration: 368, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44887855648994446
loss_pred:0.036519136279821396, decouple_loss:0.025625383481383324
The generated pressure mean: 0.44718489050865173
loss_pred:0.03613365441560745, decouple_loss:0.02601453848183155
The generated pressure mean: 0.44758760929107666
loss_pred:0.03708711639046669, decouple_loss:0.025569867342710495
Iteration: 369, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45029380917549133
loss_pred:0.03759073466062546, decouple_loss:0.026682071387767792
The generated pressure mean: 0.44798240065574646
loss_pred:0.036936067044734955, decouple_loss:0.02673649787902832
The generated pressure mean: 0.4475046396255493
loss_pred:0.03830830007791519, decouple_loss:0.027031702920794487
Iteration: 370, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44847872853279114
loss_pred:0.036440663039684296, decouple_loss:0.025603795424103737
The generated pressure mean: 0.44675615429878235
loss_pred:0.03693118318915367, decouple_loss:0.024488022550940514
The generated pressure mean: 0.4497915208339691
loss_pred:0.03764571249485016, decouple_loss:0.024827683344483376
2023-04-16 02:53:10 testing...
The generated pressure mean: 0.4502691626548767
loss_pred:0.12454032152891159, decouple_loss:0.08256840705871582
The generated pressure mean: 0.4503253996372223
loss_pred:0.12173990905284882, decouple_loss:0.08522640913724899
The generated pressure mean: 0.45003119111061096
loss_pred:0.12191262096166611, decouple_loss:0.0831919014453888
Loss: 0.12691406905651093, avg_mse: 0.19027957320213318
current test mse: 0.19028
Iteration: 371, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4493396282196045
loss_pred:0.035583384335041046, decouple_loss:0.02583075314760208
The generated pressure mean: 0.44928979873657227
loss_pred:0.037718407809734344, decouple_loss:0.0265919528901577
The generated pressure mean: 0.4479431211948395
loss_pred:0.036090172827243805, decouple_loss:0.024862052872776985
Iteration: 372, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4474427103996277
The generated pressure mean: 0.4498039186000824loss_pred:0.03799847885966301, decouple_loss:0.02498595602810383The generated pressure mean: 0.4476318359375
loss_pred:0.037758976221084595, decouple_loss:0.025407884269952774
loss_pred:0.03705253452062607, decouple_loss:0.02430092729628086
Iteration: 373, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4475051760673523
loss_pred:0.03622571751475334, decouple_loss:0.024276580661535263
The generated pressure mean: 0.4488513767719269
loss_pred:0.03656585142016411, decouple_loss:0.02630487270653248
The generated pressure mean: 0.4497723877429962
loss_pred:0.03719152510166168, decouple_loss:0.025709278881549835
Iteration: 374, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44823184609413147
loss_pred:0.0352952815592289, decouple_loss:0.024608220905065536
The generated pressure mean: 0.44872742891311646
loss_pred:0.03618520125746727, decouple_loss:0.02623601071536541
The generated pressure mean: 0.4507656693458557
loss_pred:0.03737027943134308, decouple_loss:0.026916634291410446
Iteration: 375, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4483300745487213
loss_pred:0.03587908670306206, decouple_loss:0.024588152766227722
The generated pressure mean: 0.4480832815170288
loss_pred:0.03497793525457382, decouple_loss:0.02600821666419506
The generated pressure mean: 0.4478854537010193
loss_pred:0.036751292645931244, decouple_loss:0.026570085436105728
Iteration: 376, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4499039053916931
The generated pressure mean: 0.44703105092048645
loss_pred:0.03569107875227928, decouple_loss:0.02555312216281891
loss_pred:0.0378887839615345, decouple_loss:0.025025624781847
The generated pressure mean: 0.4487587511539459
loss_pred:0.03674177825450897, decouple_loss:0.02362830936908722
Iteration: 377, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44851070642471313
loss_pred:0.03556167334318161, decouple_loss:0.025262117385864258
The generated pressure mean: 0.44773685932159424
loss_pred:0.0368744321167469, decouple_loss:0.023378249257802963
The generated pressure mean: 0.4495985209941864
loss_pred:0.03773081302642822, decouple_loss:0.025334108620882034
Iteration: 378, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4506101608276367The generated pressure mean: 0.4489898681640625
loss_pred:0.03706170246005058, decouple_loss:0.026949547231197357
loss_pred:0.03858267515897751, decouple_loss:0.027992263436317444
The generated pressure mean: 0.44823402166366577
loss_pred:0.03774981573224068, decouple_loss:0.027257919311523438
Iteration: 379, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44915395975112915
loss_pred:0.034303929656744, decouple_loss:0.025343701243400574
The generated pressure mean: 0.4486028850078583
loss_pred:0.037333812564611435, decouple_loss:0.02556273527443409
The generated pressure mean: 0.44806107878685
loss_pred:0.03459516912698746, decouple_loss:0.025631949305534363
Iteration: 380, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4499482214450836
loss_pred:0.0369192436337471, decouple_loss:0.02594425156712532
The generated pressure mean: 0.44880640506744385
loss_pred:0.03618166595697403, decouple_loss:0.027246223762631416
The generated pressure mean: 0.44986310601234436
loss_pred:0.035336002707481384, decouple_loss:0.02588704787194729
2023-04-16 02:55:16 testing...
The generated pressure mean: 0.4502691626548767
loss_pred:0.1300191879272461, decouple_loss:0.08914630860090256
The generated pressure mean: 0.450324147939682
loss_pred:0.12680289149284363, decouple_loss:0.09224893152713776
The generated pressure mean: 0.45003101229667664
loss_pred:0.12707191705703735, decouple_loss:0.09067340195178986
Loss: 0.13249914348125458, avg_mse: 0.1995077282190323
current test mse: 0.199508
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012010_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012010_3_24hr.npz
NaN value num: 0
Iteration: 381, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44740724563598633
loss_pred:0.03574726730585098, decouple_loss:0.027063388377428055
The generated pressure mean: 0.44765976071357727
loss_pred:0.03603725507855415, decouple_loss:0.026815682649612427
The generated pressure mean: 0.4481836259365082
loss_pred:0.0369969941675663, decouple_loss:0.027406219393014908
Iteration: 382, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4480670988559723
The generated pressure mean: 0.4479365050792694The generated pressure mean: 0.4483069181442261
loss_pred:0.03662984445691109, decouple_loss:0.02364174835383892
loss_pred:0.03790588676929474, decouple_loss:0.02529752440750599
loss_pred:0.0367133691906929, decouple_loss:0.02493085153400898
Iteration: 383, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44880518317222595
loss_pred:0.03688902035355568, decouple_loss:0.027267809957265854
The generated pressure mean: 0.446712851524353
loss_pred:0.03779318556189537, decouple_loss:0.02651125192642212
The generated pressure mean: 0.44866734743118286
loss_pred:0.036599982529878616, decouple_loss:0.026425769552588463
Iteration: 384, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4475579559803009
loss_pred:0.036883216351270676, decouple_loss:0.02355390414595604
The generated pressure mean: 0.4490457773208618
loss_pred:0.03652611002326012, decouple_loss:0.025935426354408264
The generated pressure mean: 0.4471917450428009
loss_pred:0.03882680460810661, decouple_loss:0.025350350886583328
Iteration: 385, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44684427976608276
loss_pred:0.03752962499856949, decouple_loss:0.024777038022875786
The generated pressure mean: 0.4481154978275299
loss_pred:0.0359664149582386, decouple_loss:0.024344466626644135
The generated pressure mean: 0.44768890738487244
loss_pred:0.0357007160782814, decouple_loss:0.024104340001940727
Iteration: 386, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4487348794937134
The generated pressure mean: 0.4467112421989441
loss_pred:0.03530409559607506, decouple_loss:0.02296638861298561
loss_pred:0.03721664473414421, decouple_loss:0.023654982447624207
The generated pressure mean: 0.4478995203971863
loss_pred:0.03575966879725456, decouple_loss:0.02555883675813675
Iteration: 387, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44782140851020813
The generated pressure mean: 0.4470076262950897
loss_pred:0.03569250926375389, decouple_loss:0.024837549775838852
loss_pred:0.038172051310539246, decouple_loss:0.023828143253922462
The generated pressure mean: 0.4471747875213623
loss_pred:0.034789226949214935, decouple_loss:0.024835625663399696
Iteration: 388, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4482589662075043
loss_pred:0.037334851920604706, decouple_loss:0.026578426361083984
The generated pressure mean: 0.4489404559135437
loss_pred:0.037169866263866425, decouple_loss:0.026101544499397278
The generated pressure mean: 0.44662153720855713
loss_pred:0.03688078746199608, decouple_loss:0.026825740933418274
Iteration: 389, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44821810722351074
The generated pressure mean: 0.4483684003353119
loss_pred:0.034849461168050766, decouple_loss:0.022589286789298058
loss_pred:0.036465536803007126, decouple_loss:0.02218189649283886
The generated pressure mean: 0.4478752613067627
loss_pred:0.03532327339053154, decouple_loss:0.022766776382923126
Iteration: 390, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44710057973861694
loss_pred:0.034418608993291855, decouple_loss:0.024950651451945305
The generated pressure mean: 0.44779741764068604
loss_pred:0.03571367636322975, decouple_loss:0.024961724877357483
The generated pressure mean: 0.44647714495658875
loss_pred:0.035058800131082535, decouple_loss:0.02432711236178875
2023-04-16 02:57:57 testing...
The generated pressure mean: 0.4502691626548767
loss_pred:0.13439811766147614, decouple_loss:0.08283315598964691
The generated pressure mean: 0.4500309228897095
loss_pred:0.1308901607990265, decouple_loss:0.0848013386130333
The generated pressure mean: 0.4503245949745178
loss_pred:0.1309746354818344, decouple_loss:0.08576662838459015
Loss: 0.13631099462509155, avg_mse: 0.20885777473449707
current test mse: 0.208858
Iteration: 391, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44807153940200806
loss_pred:0.03667031228542328, decouple_loss:0.022122904658317566The generated pressure mean: 0.44828906655311584
loss_pred:0.03650255873799324, decouple_loss:0.022949092090129852
The generated pressure mean: 0.4483749568462372
loss_pred:0.035087503492832184, decouple_loss:0.02280433475971222
Iteration: 392, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4478284418582916
loss_pred:0.03645940124988556, decouple_loss:0.024969056248664856
The generated pressure mean: 0.4489809274673462
loss_pred:0.03505982086062431, decouple_loss:0.024239761754870415
The generated pressure mean: 0.44795742630958557
loss_pred:0.03490663319826126, decouple_loss:0.02526780590415001
Iteration: 393, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44804054498672485
loss_pred:0.03688487783074379, decouple_loss:0.02379818633198738
The generated pressure mean: 0.4473484456539154
loss_pred:0.03522816672921181, decouple_loss:0.022344617173075676
The generated pressure mean: 0.44895660877227783
loss_pred:0.035630322992801666, decouple_loss:0.023486649617552757
Iteration: 394, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4485127925872803
loss_pred:0.03668148070573807, decouple_loss:0.024233169853687286
The generated pressure mean: 0.44819146394729614
loss_pred:0.03396507352590561, decouple_loss:0.0268186517059803
The generated pressure mean: 0.4469239413738251
loss_pred:0.03371790796518326, decouple_loss:0.024944273754954338
Iteration: 395, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44915905594825745
loss_pred:0.03559517115354538, decouple_loss:0.02243908867239952
The generated pressure mean: 0.4487683176994324
loss_pred:0.037092242389917374, decouple_loss:0.02276759408414364
The generated pressure mean: 0.4485616385936737
loss_pred:0.035536471754312515, decouple_loss:0.022761186584830284
Iteration: 396, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44782260060310364
loss_pred:0.03620650991797447, decouple_loss:0.022975929081439972
The generated pressure mean: 0.44790592789649963
loss_pred:0.033835023641586304, decouple_loss:0.023465272039175034
The generated pressure mean: 0.4484636187553406
loss_pred:0.03508910536766052, decouple_loss:0.022986384108662605
Iteration: 397, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4473351836204529
loss_pred:0.034551847726106644, decouple_loss:0.022044027224183083
The generated pressure mean: 0.44652101397514343
loss_pred:0.03812221437692642, decouple_loss:0.022031906992197037
The generated pressure mean: 0.44851261377334595
loss_pred:0.03821387141942978, decouple_loss:0.021738313138484955
Iteration: 398, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4481258690357208
loss_pred:0.034644965082407, decouple_loss:0.02278381958603859
The generated pressure mean: 0.4486662745475769
loss_pred:0.03426702320575714, decouple_loss:0.021611018106341362
The generated pressure mean: 0.4480980932712555
loss_pred:0.03488149493932724, decouple_loss:0.022809386253356934
Iteration: 399, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4482981264591217
loss_pred:0.03528260067105293, decouple_loss:0.022812359035015106
The generated pressure mean: 0.4478839635848999
loss_pred:0.03346467763185501, decouple_loss:0.022897997871041298
The generated pressure mean: 0.44864487648010254
loss_pred:0.036664340645074844, decouple_loss:0.023128144443035126
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 400, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4477525055408478
loss_pred:0.035263340920209885, decouple_loss:0.022517802193760872
The generated pressure mean: 0.4482608139514923
loss_pred:0.03558814898133278, decouple_loss:0.022311627864837646
The generated pressure mean: 0.4484765827655792
loss_pred:0.03508273512125015, decouple_loss:0.02287028543651104
2023-04-16 03:00:02 testing...
The generated pressure mean: 0.4502691924571991
loss_pred:0.13149023056030273, decouple_loss:0.08394543081521988
The generated pressure mean: 0.45032617449760437
loss_pred:0.12828429043293, decouple_loss:0.08670297265052795
The generated pressure mean: 0.4500309228897095
loss_pred:0.12868154048919678, decouple_loss:0.08617587387561798
Loss: 0.13376575708389282, avg_mse: 0.21061116456985474
current test mse: 0.210611
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012007_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012007_3_24hr.npz
NaN value num: 0
Iteration: 401, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4486803710460663
loss_pred:0.035420287400484085, decouple_loss:0.024179572239518166
The generated pressure mean: 0.44813042879104614
loss_pred:0.03562838211655617, decouple_loss:0.023960605263710022
The generated pressure mean: 0.448897123336792
loss_pred:0.03591052442789078, decouple_loss:0.024432862177491188
Iteration: 402, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4478740692138672
loss_pred:0.03632088378071785, decouple_loss:0.02245786227285862
The generated pressure mean: 0.44900333881378174
The generated pressure mean: 0.4475059509277344
loss_pred:0.033765681087970734, decouple_loss:0.02386651001870632
loss_pred:0.034406330436468124, decouple_loss:0.022295678034424782
Iteration: 403, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.448222279548645
loss_pred:0.03699948266148567, decouple_loss:0.025265395641326904
The generated pressure mean: 0.44907325506210327
loss_pred:0.03511666879057884, decouple_loss:0.023546569049358368
The generated pressure mean: 0.44995930790901184
loss_pred:0.03543580695986748, decouple_loss:0.025135105475783348
Iteration: 404, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4487197697162628
loss_pred:0.0354916974902153, decouple_loss:0.022842248901724815
The generated pressure mean: 0.44834622740745544
loss_pred:0.0341024287045002, decouple_loss:0.025041405111551285
The generated pressure mean: 0.4478285312652588
loss_pred:0.03785298019647598, decouple_loss:0.02260628156363964
Iteration: 405, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44802629947662354
loss_pred:0.034463994204998016, decouple_loss:0.024159053340554237
The generated pressure mean: 0.4486537277698517
loss_pred:0.035723235458135605, decouple_loss:0.02837732993066311
The generated pressure mean: 0.44914713501930237
loss_pred:0.03646320477128029, decouple_loss:0.025045620277523994
Iteration: 406, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4478631615638733
loss_pred:0.03345375880599022, decouple_loss:0.02318299561738968
The generated pressure mean: 0.44809237122535706
loss_pred:0.033765338361263275, decouple_loss:0.023646891117095947
The generated pressure mean: 0.4487503468990326
loss_pred:0.03602347522974014, decouple_loss:0.024118930101394653
Iteration: 407, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44788795709609985
loss_pred:0.03578845039010048, decouple_loss:0.025308212265372276
The generated pressure mean: 0.44963538646698
loss_pred:0.03274678438901901, decouple_loss:0.024538107216358185
The generated pressure mean: 0.4485319256782532
loss_pred:0.033867787569761276, decouple_loss:0.025058027356863022
Iteration: 408, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4479359984397888
loss_pred:0.03594527021050453, decouple_loss:0.0225253663957119
The generated pressure mean: 0.44804322719573975
loss_pred:0.033414650708436966, decouple_loss:0.023797977715730667
The generated pressure mean: 0.44853493571281433
loss_pred:0.035455841571092606, decouple_loss:0.023054178804159164
Iteration: 409, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4483048617839813
loss_pred:0.03402804210782051, decouple_loss:0.021766213700175285
The generated pressure mean: 0.4478447735309601
loss_pred:0.03479568660259247, decouple_loss:0.021909281611442566
The generated pressure mean: 0.44896262884140015
loss_pred:0.03476950153708458, decouple_loss:0.022394271567463875
Iteration: 410, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44988879561424255
loss_pred:0.034323204308748245, decouple_loss:0.024142706766724586
The generated pressure mean: 0.44766443967819214
loss_pred:0.035844601690769196, decouple_loss:0.022877048701047897
The generated pressure mean: 0.44802939891815186
loss_pred:0.03500775992870331, decouple_loss:0.02382631227374077
2023-04-16 03:02:50 testing...
The generated pressure mean: 0.4502691924571991
loss_pred:0.13503995537757874, decouple_loss:0.08972997218370438
The generated pressure mean: 0.45032426714897156
loss_pred:0.1317206770181656, decouple_loss:0.09327679127454758
The generated pressure mean: 0.45003098249435425
loss_pred:0.1320546418428421, decouple_loss:0.09198204427957535
Loss: 0.13752157986164093, avg_mse: 0.21799492835998535
current test mse: 0.217995
Iteration: 411, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44780996441841125
loss_pred:0.035944417119026184, decouple_loss:0.024394681677222252
The generated pressure mean: 0.448600709438324
loss_pred:0.034219641238451004, decouple_loss:0.02289045974612236
The generated pressure mean: 0.44909000396728516
loss_pred:0.03513086959719658, decouple_loss:0.0234967228025198
Iteration: 412, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4486963748931885
loss_pred:0.03209494426846504, decouple_loss:0.023001793771982193
The generated pressure mean: 0.4489521384239197
loss_pred:0.03444037213921547, decouple_loss:0.023888111114501953
The generated pressure mean: 0.4482552707195282
loss_pred:0.0340808629989624, decouple_loss:0.026127900928258896
Iteration: 413, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44852542877197266
The generated pressure mean: 0.4481947422027588
loss_pred:0.03371478244662285, decouple_loss:0.023692917078733444
loss_pred:0.035570818930864334, decouple_loss:0.02231667749583721
The generated pressure mean: 0.44872841238975525
loss_pred:0.032572802156209946, decouple_loss:0.021996695548295975
Iteration: 414, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4489213824272156The generated pressure mean: 0.4482121765613556
loss_pred:0.03292969986796379, decouple_loss:0.023513976484537125
loss_pred:0.03434281423687935, decouple_loss:0.023889921605587006
The generated pressure mean: 0.44772836565971375
loss_pred:0.036209702491760254, decouple_loss:0.024491913616657257
Iteration: 415, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.447186678647995
loss_pred:0.03365827351808548, decouple_loss:0.02208874560892582
The generated pressure mean: 0.4478703737258911
loss_pred:0.03539249300956726, decouple_loss:0.023176725953817368
The generated pressure mean: 0.4480772018432617
loss_pred:0.03585042804479599, decouple_loss:0.02366483397781849
Iteration: 416, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4496000409126282
loss_pred:0.03406871482729912, decouple_loss:0.02585039846599102
The generated pressure mean: 0.44879788160324097
loss_pred:0.034546464681625366, decouple_loss:0.024432329460978508
The generated pressure mean: 0.449072927236557
loss_pred:0.034377697855234146, decouple_loss:0.02404715120792389
Iteration: 417, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4491713047027588
loss_pred:0.034405775368213654, decouple_loss:0.02501140721142292
The generated pressure mean: 0.44935062527656555
loss_pred:0.035459425300359726, decouple_loss:0.02639264240860939
The generated pressure mean: 0.44930362701416016
loss_pred:0.032083217054605484, decouple_loss:0.025020083412528038
Iteration: 418, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4489516019821167
loss_pred:0.03434702754020691, decouple_loss:0.029652941972017288
The generated pressure mean: 0.44835174083709717
loss_pred:0.03706038370728493, decouple_loss:0.03084632381796837
The generated pressure mean: 0.4489491581916809
loss_pred:0.0369124673306942, decouple_loss:0.029026567935943604
Iteration: 419, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.447935551404953
loss_pred:0.03375416621565819, decouple_loss:0.025037460029125214
The generated pressure mean: 0.44922634959220886
loss_pred:0.03441273048520088, decouple_loss:0.02121347188949585
The generated pressure mean: 0.44869789481163025
loss_pred:0.032812364399433136, decouple_loss:0.022554708644747734
Iteration: 420, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4476882219314575
loss_pred:0.035277027636766434, decouple_loss:0.026280824095010757
The generated pressure mean: 0.4486014246940613
loss_pred:0.034229032695293427, decouple_loss:0.027831993997097015
The generated pressure mean: 0.4490341544151306
loss_pred:0.03479104861617088, decouple_loss:0.026690227910876274
2023-04-16 03:04:56 testing...
The generated pressure mean: 0.4502691328525543
loss_pred:0.13706380128860474, decouple_loss:0.08191933482885361
The generated pressure mean: 0.450324684381485
loss_pred:0.13288260996341705, decouple_loss:0.08444372564554214
The generated pressure mean: 0.45003077387809753
loss_pred:0.1332464963197708, decouple_loss:0.08304843306541443
Loss: 0.13855449855327606, avg_mse: 0.22211796045303345
current test mse: 0.222118
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012012_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012012_3_24hr.npz
NaN value num: 0
Iteration: 421, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.448093980550766
loss_pred:0.03308127075433731, decouple_loss:0.02169085666537285
The generated pressure mean: 0.44751396775245667
loss_pred:0.03447294607758522, decouple_loss:0.020916834473609924
The generated pressure mean: 0.44801461696624756
loss_pred:0.03406686708331108, decouple_loss:0.021759124472737312
Iteration: 422, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4490710496902466
loss_pred:0.03375856578350067, decouple_loss:0.023687321692705154
The generated pressure mean: 0.4471214711666107
The generated pressure mean: 0.4492436349391937loss_pred:0.034393779933452606, decouple_loss:0.024040203541517258
loss_pred:0.03450759872794151, decouple_loss:0.02520221844315529
Iteration: 423, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4481998383998871
loss_pred:0.03534045070409775, decouple_loss:0.022697826847434044
The generated pressure mean: 0.44775837659835815
loss_pred:0.03462093323469162, decouple_loss:0.02172294445335865
The generated pressure mean: 0.4493415653705597
loss_pred:0.03496307507157326, decouple_loss:0.023882558569312096
Iteration: 424, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4486134946346283
loss_pred:0.03510545194149017, decouple_loss:0.02602425031363964
The generated pressure mean: 0.4483974277973175
loss_pred:0.03261580318212509, decouple_loss:0.024208784103393555
The generated pressure mean: 0.44799280166625977
loss_pred:0.03551279008388519, decouple_loss:0.025514977052807808
Iteration: 425, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4482283294200897
loss_pred:0.03651803731918335, decouple_loss:0.022025298327207565
The generated pressure mean: 0.44826775789260864
loss_pred:0.03508947417140007, decouple_loss:0.021662840619683266
The generated pressure mean: 0.44921520352363586
loss_pred:0.03424997255206108, decouple_loss:0.024946194142103195
Iteration: 426, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4494639039039612
loss_pred:0.03657492622733116, decouple_loss:0.023195357993245125
The generated pressure mean: 0.446956604719162
loss_pred:0.033184703439474106, decouple_loss:0.02181292325258255
The generated pressure mean: 0.4490337073802948
loss_pred:0.03569965437054634, decouple_loss:0.022538013756275177
Iteration: 427, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4489626884460449
loss_pred:0.03570385277271271, decouple_loss:0.02262875624001026
The generated pressure mean: 0.44761067628860474
loss_pred:0.03445646911859512, decouple_loss:0.024438535794615746
The generated pressure mean: 0.4492262601852417
loss_pred:0.03463020548224449, decouple_loss:0.024248182773590088
Iteration: 428, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44874754548072815
loss_pred:0.03406402841210365, decouple_loss:0.02784789353609085
The generated pressure mean: 0.44818297028541565
loss_pred:0.03343070298433304, decouple_loss:0.027336783707141876
The generated pressure mean: 0.4478794038295746
loss_pred:0.03460237756371498, decouple_loss:0.026450248435139656
Iteration: 429, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44847190380096436
loss_pred:0.034294553101062775, decouple_loss:0.02439088001847267
The generated pressure mean: 0.44804826378822327
loss_pred:0.034425582736730576, decouple_loss:0.02381271682679653
The generated pressure mean: 0.4468576908111572
loss_pred:0.0330662839114666, decouple_loss:0.02483215183019638
Iteration: 430, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4474814534187317
loss_pred:0.03382090851664543, decouple_loss:0.025432825088500977
The generated pressure mean: 0.4475937485694885
loss_pred:0.03395290672779083, decouple_loss:0.02336377277970314
The generated pressure mean: 0.4483097195625305
loss_pred:0.03358842805027962, decouple_loss:0.024890556931495667
2023-04-16 03:07:37 testing...
The generated pressure mean: 0.4502691328525543
loss_pred:0.13535228371620178, decouple_loss:0.0805344507098198
The generated pressure mean: 0.450324147939682
loss_pred:0.1321558803319931, decouple_loss:0.08348905295133591
The generated pressure mean: 0.45003142952919006
loss_pred:0.13268135488033295, decouple_loss:0.08304430544376373
Loss: 0.13751429319381714, avg_mse: 0.21936631202697754
current test mse: 0.219366
Iteration: 431, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44829168915748596
loss_pred:0.034083105623722076, decouple_loss:0.02888789400458336
The generated pressure mean: 0.4473530054092407
loss_pred:0.03489187732338905, decouple_loss:0.02940739318728447
The generated pressure mean: 0.4473658800125122
loss_pred:0.03518473356962204, decouple_loss:0.028532134369015694
Iteration: 432, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44800060987472534
loss_pred:0.03330910578370094, decouple_loss:0.02424142323434353
The generated pressure mean: 0.44839397072792053
loss_pred:0.03662634640932083, decouple_loss:0.024770893156528473
The generated pressure mean: 0.44789689779281616
loss_pred:0.03559418395161629, decouple_loss:0.02532333880662918
Iteration: 433, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44753366708755493
The generated pressure mean: 0.4462030231952667
loss_pred:0.03598838299512863, decouple_loss:0.023951362818479538
loss_pred:0.03381728008389473, decouple_loss:0.023355606943368912
The generated pressure mean: 0.44744759798049927
loss_pred:0.034229375422000885, decouple_loss:0.023499609902501106
Iteration: 434, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4484817683696747
loss_pred:0.03339868038892746, decouple_loss:0.0211263969540596
The generated pressure mean: 0.44800934195518494
loss_pred:0.03483886644244194, decouple_loss:0.02297939360141754
The generated pressure mean: 0.44858962297439575
loss_pred:0.03427928313612938, decouple_loss:0.022914813831448555
Iteration: 435, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4492640793323517
loss_pred:0.03378383815288544, decouple_loss:0.025969401001930237
The generated pressure mean: 0.44786033034324646
loss_pred:0.03444216400384903, decouple_loss:0.02316851168870926
The generated pressure mean: 0.44871604442596436
loss_pred:0.03317970782518387, decouple_loss:0.02294488623738289
Iteration: 436, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44777631759643555
loss_pred:0.03319473937153816, decouple_loss:0.024174802005290985
The generated pressure mean: 0.4482770264148712
loss_pred:0.03355322778224945, decouple_loss:0.02238459140062332
The generated pressure mean: 0.44705185294151306
loss_pred:0.032835666090250015, decouple_loss:0.02205568179488182
Iteration: 437, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44786062836647034
loss_pred:0.03284531459212303, decouple_loss:0.021744925528764725
The generated pressure mean: 0.4486941993236542
loss_pred:0.03446357324719429, decouple_loss:0.02247336506843567
The generated pressure mean: 0.4474276602268219
loss_pred:0.033903054893016815, decouple_loss:0.023005342110991478
Iteration: 438, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4480644464492798
loss_pred:0.03358488902449608, decouple_loss:0.02140246517956257
The generated pressure mean: 0.4483586251735687
loss_pred:0.03377195820212364, decouple_loss:0.02325737662613392
The generated pressure mean: 0.4478079080581665
loss_pred:0.032506685703992844, decouple_loss:0.023660732433199883
Iteration: 439, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4465518891811371
loss_pred:0.03495357930660248, decouple_loss:0.021456662565469742
The generated pressure mean: 0.4481259882450104
loss_pred:0.03256862610578537, decouple_loss:0.022800978273153305
The generated pressure mean: 0.44869476556777954
loss_pred:0.031186431646347046, decouple_loss:0.021702749654650688
Iteration: 440, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4482760429382324
loss_pred:0.03277445212006569, decouple_loss:0.020723527297377586
The generated pressure mean: 0.44847220182418823
loss_pred:0.03363170847296715, decouple_loss:0.021955175325274467
The generated pressure mean: 0.44830673933029175
loss_pred:0.033389002084732056, decouple_loss:0.0202851053327322
2023-04-16 03:09:43 testing...
The generated pressure mean: 0.4502691924571991
loss_pred:0.1375337392091751, decouple_loss:0.08097026497125626
The generated pressure mean: 0.45032426714897156
loss_pred:0.13407398760318756, decouple_loss:0.08318597078323364
The generated pressure mean: 0.4500300884246826
loss_pred:0.1344265192747116, decouple_loss:0.082864910364151
Loss: 0.13946178555488586, avg_mse: 0.22785352170467377
current test mse: 0.227854
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012001_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012001_3_24hr.npz
NaN value num: 0
Iteration: 441, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44776687026023865
loss_pred:0.033180441707372665, decouple_loss:0.02146768942475319
The generated pressure mean: 0.4488212764263153
loss_pred:0.03298523649573326, decouple_loss:0.02177756279706955
The generated pressure mean: 0.44861236214637756
loss_pred:0.03361677750945091, decouple_loss:0.021882975473999977
Iteration: 442, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4472513794898987
loss_pred:0.03317059203982353, decouple_loss:0.022779453545808792
The generated pressure mean: 0.4486944377422333
loss_pred:0.03372764587402344, decouple_loss:0.023364964872598648
The generated pressure mean: 0.44667086005210876
loss_pred:0.03526076301932335, decouple_loss:0.021464169025421143
Iteration: 443, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44743040204048157
loss_pred:0.032308366149663925, decouple_loss:0.0215454138815403
The generated pressure mean: 0.44697844982147217
loss_pred:0.03310525789856911, decouple_loss:0.022013990208506584
The generated pressure mean: 0.44720450043678284
loss_pred:0.03607106953859329, decouple_loss:0.021128645166754723
Iteration: 444, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44741496443748474
loss_pred:0.03353453055024147, decouple_loss:0.02233234792947769
The generated pressure mean: 0.44760969281196594
loss_pred:0.033769577741622925, decouple_loss:0.022007906809449196
The generated pressure mean: 0.4477672874927521
loss_pred:0.033213380724191666, decouple_loss:0.02144019864499569
Iteration: 445, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44786933064460754
loss_pred:0.03390982002019882, decouple_loss:0.0203532837331295
The generated pressure mean: 0.4477335512638092
loss_pred:0.0344361811876297, decouple_loss:0.020054377615451813
The generated pressure mean: 0.44778087735176086
loss_pred:0.032854728400707245, decouple_loss:0.021042196080088615
Iteration: 446, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4477400779724121
loss_pred:0.03200969845056534, decouple_loss:0.02195488102734089
The generated pressure mean: 0.4466433823108673
loss_pred:0.03338181972503662, decouple_loss:0.022950978949666023
The generated pressure mean: 0.44812607765197754
loss_pred:0.0325445719063282, decouple_loss:0.024284139275550842
Iteration: 447, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4469486474990845
loss_pred:0.032461050897836685, decouple_loss:0.021334601566195488
The generated pressure mean: 0.44719842076301575
loss_pred:0.03283201530575752, decouple_loss:0.023209206759929657
The generated pressure mean: 0.4478505253791809
loss_pred:0.03210072219371796, decouple_loss:0.022629207000136375
Iteration: 448, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4472253620624542
loss_pred:0.035412851721048355, decouple_loss:0.023409055545926094
The generated pressure mean: 0.4485214948654175
loss_pred:0.0354221872985363, decouple_loss:0.02436784654855728
The generated pressure mean: 0.4487544000148773
loss_pred:0.03270130604505539, decouple_loss:0.02122989110648632
Iteration: 449, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44878607988357544
loss_pred:0.03303707391023636, decouple_loss:0.029422609135508537
The generated pressure mean: 0.447467178106308
loss_pred:0.03231315687298775, decouple_loss:0.026496319100260735
The generated pressure mean: 0.44897574186325073
loss_pred:0.03389491140842438, decouple_loss:0.02885015867650509
Iteration: 450, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.448239803314209
loss_pred:0.03435756266117096, decouple_loss:0.024648485705256462
The generated pressure mean: 0.4480457901954651
loss_pred:0.03309887275099754, decouple_loss:0.023518221452832222
The generated pressure mean: 0.44752684235572815
loss_pred:0.0386776477098465, decouple_loss:0.024232376366853714
2023-04-16 03:12:26 testing...
The generated pressure mean: 0.4502691626548767
loss_pred:0.1401010900735855, decouple_loss:0.08049912750720978
The generated pressure mean: 0.4503228962421417
loss_pred:0.13721530139446259, decouple_loss:0.0817122608423233
The generated pressure mean: 0.4500289261341095
loss_pred:0.1376386135816574, decouple_loss:0.08182129263877869
Loss: 0.1423855572938919, avg_mse: 0.23228317499160767
current test mse: 0.232283
Iteration: 451, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4479626417160034
loss_pred:0.03332943469285965, decouple_loss:0.026073772460222244
The generated pressure mean: 0.4471973776817322
loss_pred:0.037119049578905106, decouple_loss:0.025161275640130043
The generated pressure mean: 0.4475306272506714
loss_pred:0.036926258355379105, decouple_loss:0.02868763916194439
Iteration: 452, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44709596037864685
loss_pred:0.03387339785695076, decouple_loss:0.024824881926178932
The generated pressure mean: 0.44932979345321655
loss_pred:0.03211371973156929, decouple_loss:0.025161758065223694
The generated pressure mean: 0.4476000666618347
loss_pred:0.03350355103611946, decouple_loss:0.027122771367430687
Iteration: 453, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44788098335266113
loss_pred:0.036214835941791534, decouple_loss:0.03041806071996689
The generated pressure mean: 0.4478692412376404
loss_pred:0.03529844805598259, decouple_loss:0.030510414391756058
The generated pressure mean: 0.4467189610004425
loss_pred:0.03601445257663727, decouple_loss:0.03368789702653885
Iteration: 454, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44710472226142883
loss_pred:0.03450565040111542, decouple_loss:0.027776656672358513
The generated pressure mean: 0.447176992893219
loss_pred:0.034260962158441544, decouple_loss:0.02719602920114994
The generated pressure mean: 0.4474887549877167
loss_pred:0.03411060571670532, decouple_loss:0.02806287445127964
Iteration: 455, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44872137904167175
loss_pred:0.033588018268346786, decouple_loss:0.03345830738544464
The generated pressure mean: 0.44789111614227295
loss_pred:0.03336329013109207, decouple_loss:0.03350537642836571
The generated pressure mean: 0.4473648965358734
loss_pred:0.03770223632454872, decouple_loss:0.03232578933238983
Iteration: 456, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44796884059906006
loss_pred:0.03438044339418411, decouple_loss:0.028574354946613312
The generated pressure mean: 0.44802799820899963
loss_pred:0.03520915284752846, decouple_loss:0.02738887630403042
The generated pressure mean: 0.44774848222732544
loss_pred:0.035587336868047714, decouple_loss:0.027642779052257538
Iteration: 457, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44878605008125305
loss_pred:0.03321300446987152, decouple_loss:0.032655730843544006
The generated pressure mean: 0.44872111082077026
loss_pred:0.03279329463839531, decouple_loss:0.032997872680425644
The generated pressure mean: 0.4472808539867401
loss_pred:0.034917838871479034, decouple_loss:0.031171219423413277
Iteration: 458, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4475101828575134
The generated pressure mean: 0.4472689926624298
loss_pred:0.03334733843803406, decouple_loss:0.029639042913913727
loss_pred:0.034414201974868774, decouple_loss:0.02997663803398609
The generated pressure mean: 0.44777730107307434
loss_pred:0.03303200379014015, decouple_loss:0.02944585308432579
Iteration: 459, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4483816623687744
loss_pred:0.03386739641427994, decouple_loss:0.028047416359186172
The generated pressure mean: 0.4481099843978882
loss_pred:0.031210346147418022, decouple_loss:0.030314652249217033
The generated pressure mean: 0.44795098900794983
loss_pred:0.03545184060931206, decouple_loss:0.027598481625318527
Iteration: 460, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4482726752758026
loss_pred:0.034061577171087265, decouple_loss:0.02715889923274517
The generated pressure mean: 0.44774043560028076
loss_pred:0.032827310264110565, decouple_loss:0.028860298916697502
The generated pressure mean: 0.44842174649238586
loss_pred:0.03421998396515846, decouple_loss:0.02587658166885376
2023-04-16 03:14:32 testing...
The generated pressure mean: 0.4502691626548767
loss_pred:0.12783457338809967, decouple_loss:0.08046134561300278
The generated pressure mean: 0.4503249228000641
loss_pred:0.12533842027187347, decouple_loss:0.0833139717578888
The generated pressure mean: 0.45003148913383484
loss_pred:0.12587903439998627, decouple_loss:0.08270864188671112
Loss: 0.1304587423801422, avg_mse: 0.20819465816020966
current test mse: 0.208195
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012020_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012020_3_24hr.npz
NaN value num: 0
Iteration: 461, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4507703185081482
loss_pred:0.034925878047943115, decouple_loss:0.02822539582848549
The generated pressure mean: 0.450508177280426
loss_pred:0.033998627215623856, decouple_loss:0.029211563989520073
The generated pressure mean: 0.44992417097091675
loss_pred:0.03305856138467789, decouple_loss:0.027705760672688484
Iteration: 462, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44968217611312866
loss_pred:0.03370086848735809, decouple_loss:0.027016809210181236
The generated pressure mean: 0.45140182971954346
loss_pred:0.0344182550907135, decouple_loss:0.028693897649645805
The generated pressure mean: 0.45081162452697754
loss_pred:0.03220926225185394, decouple_loss:0.02817300707101822
Iteration: 463, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45072540640830994
loss_pred:0.035335179418325424, decouple_loss:0.028101656585931778
The generated pressure mean: 0.4507192373275757
loss_pred:0.034104958176612854, decouple_loss:0.028207067400217056
The generated pressure mean: 0.45067721605300903
loss_pred:0.0348350815474987, decouple_loss:0.027777690440416336
Iteration: 464, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44982975721359253
The generated pressure mean: 0.4500468969345093
loss_pred:0.03267234191298485, decouple_loss:0.025717996060848236
loss_pred:0.03422141447663307, decouple_loss:0.02731182985007763
The generated pressure mean: 0.45091649889945984
loss_pred:0.03351200744509697, decouple_loss:0.02529168501496315
Iteration: 465, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44998010993003845
loss_pred:0.03356500715017319, decouple_loss:0.025269266217947006
The generated pressure mean: 0.45015910267829895
loss_pred:0.03333715721964836, decouple_loss:0.0246377345174551
The generated pressure mean: 0.45001330971717834
loss_pred:0.0349581241607666, decouple_loss:0.025634832680225372
Iteration: 466, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4495428800582886
loss_pred:0.033988676965236664, decouple_loss:0.024204131215810776
The generated pressure mean: 0.450475811958313
loss_pred:0.03284801170229912, decouple_loss:0.026013819500803947
The generated pressure mean: 0.44962167739868164
loss_pred:0.0334489606320858, decouple_loss:0.023944932967424393
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 467, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4492850601673126
loss_pred:0.03405192121863365, decouple_loss:0.02602747641503811
The generated pressure mean: 0.4503757059574127
loss_pred:0.03318565711379051, decouple_loss:0.025162329897284508
The generated pressure mean: 0.4513641595840454
loss_pred:0.03491854667663574, decouple_loss:0.02613617666065693
Iteration: 468, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45023995637893677
loss_pred:0.03196801245212555, decouple_loss:0.024060267955064774
The generated pressure mean: 0.4487888813018799
loss_pred:0.035432368516922, decouple_loss:0.0237111859023571
The generated pressure mean: 0.4510209858417511
loss_pred:0.034104328602552414, decouple_loss:0.023332485929131508
Iteration: 469, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4511954188346863
loss_pred:0.03320920467376709, decouple_loss:0.02572873793542385
The generated pressure mean: 0.44918593764305115
loss_pred:0.032650746405124664, decouple_loss:0.024520505219697952
The generated pressure mean: 0.45023488998413086
loss_pred:0.033598944544792175, decouple_loss:0.025979431346058846
Iteration: 470, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4510951638221741
The generated pressure mean: 0.4492589831352234loss_pred:0.03488955646753311, decouple_loss:0.024336712434887886
loss_pred:0.032617200165987015, decouple_loss:0.02270486019551754
The generated pressure mean: 0.4492861032485962
loss_pred:0.03312266990542412, decouple_loss:0.022986378520727158
2023-04-16 03:17:15 testing...
The generated pressure mean: 0.4502691626548767
loss_pred:0.13684426248073578, decouple_loss:0.08052819222211838
The generated pressure mean: 0.45032426714897156
loss_pred:0.13393932580947876, decouple_loss:0.08325693011283875
The generated pressure mean: 0.4500310719013214
loss_pred:0.13423705101013184, decouple_loss:0.08311521261930466
Loss: 0.1391218900680542, avg_mse: 0.22617141902446747
current test mse: 0.226171
Iteration: 471, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4501316249370575
loss_pred:0.03152179718017578, decouple_loss:0.02582637034356594
The generated pressure mean: 0.4499276280403137
loss_pred:0.03195597603917122, decouple_loss:0.024617213755846024
The generated pressure mean: 0.45034903287887573
loss_pred:0.03350725397467613, decouple_loss:0.026137685403227806
Iteration: 472, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44979241490364075
The generated pressure mean: 0.44947490096092224
loss_pred:0.034502383321523666, decouple_loss:0.02183554880321026
loss_pred:0.03218179941177368, decouple_loss:0.02184292860329151
The generated pressure mean: 0.4506579637527466
loss_pred:0.03499571233987808, decouple_loss:0.02281136065721512
Iteration: 473, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4502286911010742
The generated pressure mean: 0.4499239921569824
loss_pred:0.03210141137242317, decouple_loss:0.026711586862802505
loss_pred:0.032467350363731384, decouple_loss:0.023803699761629105
The generated pressure mean: 0.45104166865348816
loss_pred:0.03481215983629227, decouple_loss:0.024034583941102028
Iteration: 474, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4497092664241791
loss_pred:0.033252932131290436, decouple_loss:0.021050404757261276
The generated pressure mean: 0.4502733051776886
loss_pred:0.03295108303427696, decouple_loss:0.02315566875040531
The generated pressure mean: 0.44990772008895874
loss_pred:0.03317638114094734, decouple_loss:0.0213477723300457
Iteration: 475, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4506808817386627
loss_pred:0.03307833522558212, decouple_loss:0.022238198667764664
The generated pressure mean: 0.45135098695755005
loss_pred:0.03156762570142746, decouple_loss:0.022401362657546997
The generated pressure mean: 0.45043593645095825
loss_pred:0.031623125076293945, decouple_loss:0.0226307213306427
Iteration: 476, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4507088363170624
loss_pred:0.032596636563539505, decouple_loss:0.021207263693213463
The generated pressure mean: 0.4512610137462616
loss_pred:0.03379683196544647, decouple_loss:0.022256873548030853
The generated pressure mean: 0.4509544372558594
loss_pred:0.03385088965296745, decouple_loss:0.021940305829048157
Iteration: 477, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44870272278785706
loss_pred:0.03217785432934761, decouple_loss:0.02331584505736828
The generated pressure mean: 0.4499768614768982
loss_pred:0.03253694996237755, decouple_loss:0.02231050282716751
The generated pressure mean: 0.450461745262146
loss_pred:0.03153003752231598, decouple_loss:0.023100994527339935
Iteration: 478, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.451291024684906
The generated pressure mean: 0.44982200860977173
loss_pred:0.03183393180370331, decouple_loss:0.022606564685702324
loss_pred:0.034074679017066956, decouple_loss:0.022580038756132126
The generated pressure mean: 0.4511692523956299
loss_pred:0.0325385257601738, decouple_loss:0.022535013034939766
Iteration: 479, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4492981433868408
loss_pred:0.03280433639883995, decouple_loss:0.022534307092428207
The generated pressure mean: 0.45085546374320984
loss_pred:0.03310567885637283, decouple_loss:0.026328280568122864
The generated pressure mean: 0.4507432281970978
loss_pred:0.03301295265555382, decouple_loss:0.02285873517394066
Iteration: 480, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4503001272678375
loss_pred:0.03112076036632061, decouple_loss:0.02123577892780304
The generated pressure mean: 0.45083087682724
loss_pred:0.03402905538678169, decouple_loss:0.02142932079732418
The generated pressure mean: 0.45180851221084595
loss_pred:0.03420785814523697, decouple_loss:0.01997372694313526
2023-04-16 03:19:20 testing...
The generated pressure mean: 0.4502691328525543
loss_pred:0.13806909322738647, decouple_loss:0.07597679644823074
The generated pressure mean: 0.4503243863582611
loss_pred:0.13567304611206055, decouple_loss:0.07878178358078003
The generated pressure mean: 0.4500308334827423
loss_pred:0.13558176159858704, decouple_loss:0.07843572646379471
Loss: 0.14032787084579468, avg_mse: 0.23103347420692444
current test mse: 0.231033
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012014_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012014_3_24hr.npz
NaN value num: 0
Iteration: 481, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4477064907550812
loss_pred:0.03416725993156433, decouple_loss:0.02659643068909645
The generated pressure mean: 0.4489121735095978
loss_pred:0.03276946023106575, decouple_loss:0.02659856155514717
The generated pressure mean: 0.44795772433280945
loss_pred:0.03164596110582352, decouple_loss:0.024324599653482437
Iteration: 482, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4476374685764313
The generated pressure mean: 0.4483763575553894
The generated pressure mean: 0.44830238819122314
loss_pred:0.03298848494887352, decouple_loss:0.0220496729016304
loss_pred:0.035021159797906876, decouple_loss:0.022546004503965378
loss_pred:0.032783154398202896, decouple_loss:0.02116790972650051
Iteration: 483, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44958236813545227
The generated pressure mean: 0.4491353929042816
loss_pred:0.03173260763287544, decouple_loss:0.02359658107161522
loss_pred:0.03308151662349701, decouple_loss:0.021718109026551247
The generated pressure mean: 0.44895556569099426
loss_pred:0.0333552360534668, decouple_loss:0.02216179482638836
Iteration: 484, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44770973920822144
The generated pressure mean: 0.4488840699195862
loss_pred:0.03309756889939308, decouple_loss:0.021848434582352638
loss_pred:0.03382027894258499, decouple_loss:0.023555977270007133
The generated pressure mean: 0.44823208451271057
loss_pred:0.032639279961586, decouple_loss:0.022048503160476685
Iteration: 485, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44831037521362305
loss_pred:0.03458665311336517, decouple_loss:0.025586290284991264
The generated pressure mean: 0.44800031185150146
loss_pred:0.03402775898575783, decouple_loss:0.023372966796159744
The generated pressure mean: 0.447934091091156
loss_pred:0.033155787736177444, decouple_loss:0.021305037662386894
Iteration: 486, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4482429325580597
loss_pred:0.03203945234417915, decouple_loss:0.02160835638642311
The generated pressure mean: 0.44783899188041687
loss_pred:0.03242554888129234, decouple_loss:0.022635335102677345
The generated pressure mean: 0.44791439175605774
loss_pred:0.03423943370580673, decouple_loss:0.02228141576051712
Iteration: 487, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44741159677505493
loss_pred:0.03246684744954109, decouple_loss:0.022847997024655342
The generated pressure mean: 0.4481850862503052
loss_pred:0.03409473970532417, decouple_loss:0.02232668176293373
The generated pressure mean: 0.44738781452178955
loss_pred:0.031243762001395226, decouple_loss:0.023759838193655014
Iteration: 488, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44864940643310547
loss_pred:0.03222900629043579, decouple_loss:0.024847466498613358
The generated pressure mean: 0.44811832904815674
loss_pred:0.03162026032805443, decouple_loss:0.025166546925902367
The generated pressure mean: 0.4488612711429596
loss_pred:0.031551968306303024, decouple_loss:0.024218730628490448
Iteration: 489, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4472733736038208
loss_pred:0.033531125634908676, decouple_loss:0.022564075887203217
The generated pressure mean: 0.44784092903137207
loss_pred:0.03128909319639206, decouple_loss:0.021529516205191612
The generated pressure mean: 0.44855424761772156
loss_pred:0.03275243192911148, decouple_loss:0.022044403478503227
Iteration: 490, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4466971457004547
loss_pred:0.03205656632781029, decouple_loss:0.024316081777215004
The generated pressure mean: 0.44802233576774597
loss_pred:0.03404364734888077, decouple_loss:0.025302354246377945
The generated pressure mean: 0.44674625992774963
loss_pred:0.033765774220228195, decouple_loss:0.024490725249052048
2023-04-16 03:22:00 testing...
The generated pressure mean: 0.4502691328525543
loss_pred:0.13973607122898102, decouple_loss:0.07827523350715637
The generated pressure mean: 0.4503249228000641
loss_pred:0.13656757771968842, decouple_loss:0.08090346306562424
The generated pressure mean: 0.4500303268432617
loss_pred:0.13702835142612457, decouple_loss:0.08056500554084778
Loss: 0.1417730748653412, avg_mse: 0.23348404467105865
current test mse: 0.233484
Iteration: 491, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4488709270954132
The generated pressure mean: 0.4483182430267334
loss_pred:0.0326826386153698, decouple_loss:0.02100668102502823
loss_pred:0.0328197106719017, decouple_loss:0.02023931033909321
The generated pressure mean: 0.4483243227005005
loss_pred:0.03315199911594391, decouple_loss:0.021803809329867363
Iteration: 492, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4477957785129547
The generated pressure mean: 0.44770222902297974
loss_pred:0.031668007373809814, decouple_loss:0.023100635036826134
loss_pred:0.032508693635463715, decouple_loss:0.022909358143806458
The generated pressure mean: 0.4493042528629303
loss_pred:0.03354629874229431, decouple_loss:0.026463743299245834
Iteration: 493, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4479179084300995
loss_pred:0.03369768708944321, decouple_loss:0.023099346086382866
The generated pressure mean: 0.44942089915275574
loss_pred:0.03271915763616562, decouple_loss:0.022688984870910645
The generated pressure mean: 0.44715452194213867
loss_pred:0.031678102910518646, decouple_loss:0.02210072986781597
Iteration: 494, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4487951993942261
The generated pressure mean: 0.44828495383262634
loss_pred:0.03141569718718529, decouple_loss:0.021067660301923752
loss_pred:0.03107631765305996, decouple_loss:0.020163970068097115
The generated pressure mean: 0.44752079248428345
loss_pred:0.03451768681406975, decouple_loss:0.021403545513749123
Iteration: 495, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44816210865974426
loss_pred:0.03212824463844299, decouple_loss:0.02084893360733986
The generated pressure mean: 0.4475434422492981
loss_pred:0.031333498656749725, decouple_loss:0.021410418674349785
The generated pressure mean: 0.4478347599506378
loss_pred:0.03367406502366066, decouple_loss:0.021492620930075645
Iteration: 496, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44883912801742554
loss_pred:0.03327449411153793, decouple_loss:0.02013993449509144
The generated pressure mean: 0.44813665747642517
loss_pred:0.03170051425695419, decouple_loss:0.020353274419903755
The generated pressure mean: 0.4483334422111511
loss_pred:0.03257940337061882, decouple_loss:0.01994532160460949
Iteration: 497, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44802233576774597
The generated pressure mean: 0.44845524430274963
loss_pred:0.0322469137609005, decouple_loss:0.0211990624666214
loss_pred:0.030642906203866005, decouple_loss:0.022341296076774597
The generated pressure mean: 0.44844457507133484
loss_pred:0.031019121408462524, decouple_loss:0.022160930559039116
Iteration: 498, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4483327865600586
The generated pressure mean: 0.4487401247024536
loss_pred:0.03146745264530182, decouple_loss:0.02179877832531929
loss_pred:0.031778689473867416, decouple_loss:0.020861420780420303
The generated pressure mean: 0.44781187176704407
loss_pred:0.0312669575214386, decouple_loss:0.022653933614492416
Iteration: 499, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4481137692928314
loss_pred:0.030385296791791916, decouple_loss:0.021102193742990494
The generated pressure mean: 0.44948241114616394
loss_pred:0.030721578747034073, decouple_loss:0.021830054000020027
The generated pressure mean: 0.4479468762874603
loss_pred:0.03069813922047615, decouple_loss:0.019902877509593964
Iteration: 500, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.448101282119751
The generated pressure mean: 0.44841235876083374loss_pred:0.0327099934220314, decouple_loss:0.022799933329224586
loss_pred:0.0327056460082531, decouple_loss:0.023476742208003998
The generated pressure mean: 0.4483798146247864
loss_pred:0.0314493402838707, decouple_loss:0.0210183784365654
2023-04-16 03:24:05 testing...
The generated pressure mean: 0.4502691626548767
loss_pred:0.1382010281085968, decouple_loss:0.07321294397115707
The generated pressure mean: 0.4503237009048462
loss_pred:0.13527444005012512, decouple_loss:0.0758143961429596
The generated pressure mean: 0.4500308930873871
loss_pred:0.13582511246204376, decouple_loss:0.07497997581958771
Loss: 0.1401669830083847, avg_mse: 0.23442596197128296
current test mse: 0.234426
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012002_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012002_3_24hr.npz
NaN value num: 0
Iteration: 501, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4473103880882263
loss_pred:0.030781561508774757, decouple_loss:0.02120850794017315
The generated pressure mean: 0.44738632440567017
loss_pred:0.0319514200091362, decouple_loss:0.02115676924586296
The generated pressure mean: 0.44843703508377075
loss_pred:0.03211641684174538, decouple_loss:0.021601133048534393
Iteration: 502, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4477885365486145
loss_pred:0.032315924763679504, decouple_loss:0.021017419174313545
The generated pressure mean: 0.4491705000400543
The generated pressure mean: 0.4472729563713074
loss_pred:0.031435608863830566, decouple_loss:0.020528046414256096
loss_pred:0.030545836314558983, decouple_loss:0.020587297156453133
Iteration: 503, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44810253381729126
loss_pred:0.03174838796257973, decouple_loss:0.020356766879558563
The generated pressure mean: 0.44702163338661194
The generated pressure mean: 0.44843563437461853
loss_pred:0.03233316168189049, decouple_loss:0.020760981366038322
loss_pred:0.032241541892290115, decouple_loss:0.01989348791539669
Iteration: 504, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44817546010017395
loss_pred:0.029876448214054108, decouple_loss:0.019087372347712517
The generated pressure mean: 0.447510689496994
loss_pred:0.033367857336997986, decouple_loss:0.018735762685537338
The generated pressure mean: 0.447201132774353
loss_pred:0.032188400626182556, decouple_loss:0.019284654408693314
Iteration: 505, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4480310380458832
The generated pressure mean: 0.44717732071876526
loss_pred:0.03514360263943672, decouple_loss:0.021092725917696953
loss_pred:0.03257075697183609, decouple_loss:0.020035376772284508
The generated pressure mean: 0.44679975509643555
loss_pred:0.03227218985557556, decouple_loss:0.01967313140630722
Iteration: 506, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44784650206565857The generated pressure mean: 0.4469970762729645
loss_pred:0.029497750103473663, decouple_loss:0.020803047344088554loss_pred:0.030279865488409996, decouple_loss:0.021131843328475952
The generated pressure mean: 0.4477941393852234
loss_pred:0.03292771428823471, decouple_loss:0.021072493866086006
Iteration: 507, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4485343396663666
loss_pred:0.031184757128357887, decouple_loss:0.019751111045479774
The generated pressure mean: 0.44830256700515747
loss_pred:0.03061142936348915, decouple_loss:0.01931755244731903
The generated pressure mean: 0.4486755132675171
loss_pred:0.03089360147714615, decouple_loss:0.019123002886772156
Iteration: 508, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4471838176250458
loss_pred:0.032883066684007645, decouple_loss:0.021025314927101135
The generated pressure mean: 0.44840776920318604
loss_pred:0.03181587532162666, decouple_loss:0.019624803215265274
The generated pressure mean: 0.4465499222278595
loss_pred:0.031531788408756256, decouple_loss:0.020898357033729553
Iteration: 509, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4468722343444824
The generated pressure mean: 0.4472554922103882
loss_pred:0.032261431217193604, decouple_loss:0.021807735785841942
loss_pred:0.03318491205573082, decouple_loss:0.02076157182455063
The generated pressure mean: 0.4476828873157501
loss_pred:0.03226351737976074, decouple_loss:0.020433658733963966
Iteration: 510, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44780632853507996
loss_pred:0.030168790370225906, decouple_loss:0.01944241300225258
The generated pressure mean: 0.44753891229629517
loss_pred:0.030596237629652023, decouple_loss:0.020083585754036903
The generated pressure mean: 0.4470251798629761
loss_pred:0.032578807324171066, decouple_loss:0.021013271063566208
2023-04-16 03:26:45 testing...
The generated pressure mean: 0.4502691626548767
loss_pred:0.13949483633041382, decouple_loss:0.07397839426994324
The generated pressure mean: 0.4503249228000641
loss_pred:0.13666634261608124, decouple_loss:0.07587563991546631
The generated pressure mean: 0.45003005862236023
loss_pred:0.1367340087890625, decouple_loss:0.07619217038154602
Loss: 0.14139916002750397, avg_mse: 0.23955950140953064
current test mse: 0.23956
Iteration: 511, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4484514594078064
The generated pressure mean: 0.4487089216709137
loss_pred:0.03000980243086815, decouple_loss:0.01983775943517685
loss_pred:0.031063057482242584, decouple_loss:0.020096661522984505
The generated pressure mean: 0.44812026619911194
loss_pred:0.02939574047923088, decouple_loss:0.019893063232302666
Iteration: 512, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4460742771625519
The generated pressure mean: 0.44777369499206543
loss_pred:0.03270351141691208, decouple_loss:0.019896335899829865
loss_pred:0.032671280205249786, decouple_loss:0.021506380289793015
The generated pressure mean: 0.44689714908599854
loss_pred:0.030579382553696632, decouple_loss:0.020503941923379898
Iteration: 513, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44784748554229736
loss_pred:0.0315546952188015, decouple_loss:0.020748846232891083
The generated pressure mean: 0.4470342695713043
loss_pred:0.03228611871600151, decouple_loss:0.01959552802145481
The generated pressure mean: 0.4477061629295349
loss_pred:0.032950423657894135, decouple_loss:0.02004038728773594
Iteration: 514, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4475507438182831
The generated pressure mean: 0.4463772475719452
loss_pred:0.031167641282081604, decouple_loss:0.019873933866620064
loss_pred:0.03144494444131851, decouple_loss:0.020754588767886162
The generated pressure mean: 0.44848117232322693
loss_pred:0.031678687781095505, decouple_loss:0.01976758986711502
Iteration: 515, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44645175337791443
loss_pred:0.0333729088306427, decouple_loss:0.02083483338356018
The generated pressure mean: 0.44802626967430115
loss_pred:0.03294563665986061, decouple_loss:0.020992983132600784
The generated pressure mean: 0.4461522400379181
loss_pred:0.031604137271642685, decouple_loss:0.020796122029423714
Iteration: 516, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44758883118629456
loss_pred:0.032217755913734436, decouple_loss:0.021323639899492264
The generated pressure mean: 0.4472547471523285
loss_pred:0.03272252529859543, decouple_loss:0.021017959341406822
The generated pressure mean: 0.44684144854545593
loss_pred:0.033766020089387894, decouple_loss:0.020936056971549988
Iteration: 517, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4488578736782074
loss_pred:0.030848512426018715, decouple_loss:0.02204943634569645
The generated pressure mean: 0.4491220712661743
loss_pred:0.03189796209335327, decouple_loss:0.02372218668460846
The generated pressure mean: 0.4464240074157715
loss_pred:0.03207038715481758, decouple_loss:0.02222103253006935
Iteration: 518, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44829148054122925
loss_pred:0.033668577671051025, decouple_loss:0.024151375517249107
The generated pressure mean: 0.447060763835907
loss_pred:0.03031831793487072, decouple_loss:0.02320699580013752
The generated pressure mean: 0.44555097818374634
loss_pred:0.03259932994842529, decouple_loss:0.02391483262181282
Iteration: 519, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4489743411540985
loss_pred:0.03289451822638512, decouple_loss:0.022861553356051445
The generated pressure mean: 0.44749122858047485
loss_pred:0.033944353461265564, decouple_loss:0.02218818850815296
The generated pressure mean: 0.44798359274864197
loss_pred:0.0346485935151577, decouple_loss:0.02390105649828911
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 520, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44712013006210327
loss_pred:0.033236101269721985, decouple_loss:0.027166061103343964
The generated pressure mean: 0.4455838203430176
loss_pred:0.03186526894569397, decouple_loss:0.02792179584503174
The generated pressure mean: 0.44960710406303406
loss_pred:0.03421827778220177, decouple_loss:0.030331090092658997
2023-04-16 03:28:52 testing...
The generated pressure mean: 0.4502691924571991
loss_pred:0.13947227597236633, decouple_loss:0.07745622843503952
The generated pressure mean: 0.4503231644630432
loss_pred:0.13677988946437836, decouple_loss:0.07947148382663727
The generated pressure mean: 0.4500308930873871
loss_pred:0.13703182339668274, decouple_loss:0.07889875024557114
Loss: 0.14169177412986755, avg_mse: 0.24254395067691803
current test mse: 0.242544
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012004_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012004_3_24hr.npz
NaN value num: 0
Iteration: 521, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4494124948978424
loss_pred:0.03070805035531521, decouple_loss:0.024226289242506027
The generated pressure mean: 0.4498074948787689
loss_pred:0.03185852989554405, decouple_loss:0.023319287225604057
The generated pressure mean: 0.44891977310180664
loss_pred:0.030428839847445488, decouple_loss:0.02420974150300026
Iteration: 522, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4490785300731659
loss_pred:0.03053457662463188, decouple_loss:0.029472703114151955
The generated pressure mean: 0.44818592071533203
loss_pred:0.03186903893947601, decouple_loss:0.029352659359574318
The generated pressure mean: 0.4485379755496979
loss_pred:0.03178897500038147, decouple_loss:0.029088294133543968
Iteration: 523, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44876018166542053
loss_pred:0.030482644215226173, decouple_loss:0.024599658325314522
The generated pressure mean: 0.44672876596450806
loss_pred:0.03016151860356331, decouple_loss:0.02270231954753399
The generated pressure mean: 0.44736576080322266
loss_pred:0.031383078545331955, decouple_loss:0.024627435952425003
Iteration: 524, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44764456152915955
loss_pred:0.03018106147646904, decouple_loss:0.026812389492988586
The generated pressure mean: 0.44998231530189514
loss_pred:0.031619515269994736, decouple_loss:0.027836007997393608
The generated pressure mean: 0.44811591506004333
loss_pred:0.032008569687604904, decouple_loss:0.02804761566221714
Iteration: 525, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44921019673347473
loss_pred:0.031080108135938644, decouple_loss:0.024805892258882523
The generated pressure mean: 0.44888800382614136
loss_pred:0.02955663949251175, decouple_loss:0.025343379005789757
The generated pressure mean: 0.44936510920524597
loss_pred:0.03091498278081417, decouple_loss:0.024486156180500984
Iteration: 526, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44836685061454773The generated pressure mean: 0.44835132360458374
loss_pred:0.030537893995642662, decouple_loss:0.022900953888893127
loss_pred:0.03146333247423172, decouple_loss:0.02451246790587902
The generated pressure mean: 0.4499289393424988
loss_pred:0.03075583465397358, decouple_loss:0.02451453171670437
Iteration: 527, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44708433747291565
loss_pred:0.030347004532814026, decouple_loss:0.023745238780975342
The generated pressure mean: 0.4486364424228668
loss_pred:0.03063974156975746, decouple_loss:0.023458348587155342
The generated pressure mean: 0.44933587312698364
loss_pred:0.030148573219776154, decouple_loss:0.025670083239674568
Iteration: 528, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44918984174728394
loss_pred:0.0306983795017004, decouple_loss:0.023758558556437492
The generated pressure mean: 0.4478501081466675
loss_pred:0.02997022494673729, decouple_loss:0.022670038044452667
The generated pressure mean: 0.44904887676239014
loss_pred:0.03176051750779152, decouple_loss:0.021817585453391075
Iteration: 529, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44897985458374023The generated pressure mean: 0.45077842473983765
loss_pred:0.03072310984134674, decouple_loss:0.02163315750658512loss_pred:0.030795099213719368, decouple_loss:0.023008188232779503
The generated pressure mean: 0.44844335317611694
loss_pred:0.031341616064310074, decouple_loss:0.021248960867524147
Iteration: 530, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44882792234420776
loss_pred:0.031664907932281494, decouple_loss:0.02213585563004017
The generated pressure mean: 0.448164701461792
loss_pred:0.03038903884589672, decouple_loss:0.01905819959938526
The generated pressure mean: 0.44850218296051025
loss_pred:0.03157180920243263, decouple_loss:0.019452858716249466
2023-04-16 03:31:34 testing...
The generated pressure mean: 0.4502691924571991
loss_pred:0.1418529897928238, decouple_loss:0.08306720852851868
The generated pressure mean: 0.4503248631954193
loss_pred:0.1391686201095581, decouple_loss:0.08492017537355423
The generated pressure mean: 0.45002996921539307
loss_pred:0.13970154523849487, decouple_loss:0.08445995301008224
Loss: 0.14444850385189056, avg_mse: 0.2475908398628235
current test mse: 0.247591
Iteration: 531, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44883447885513306
loss_pred:0.029575249180197716, decouple_loss:0.022621039301156998
The generated pressure mean: 0.4471340775489807
loss_pred:0.03032444417476654, decouple_loss:0.020814331248402596
The generated pressure mean: 0.4514595866203308
loss_pred:0.03159482032060623, decouple_loss:0.02098531648516655
Iteration: 532, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44933223724365234
loss_pred:0.029841376468539238, decouple_loss:0.021212683990597725
The generated pressure mean: 0.4488607943058014
loss_pred:0.030434200540184975, decouple_loss:0.01934376358985901
The generated pressure mean: 0.4496579170227051
loss_pred:0.031313516199588776, decouple_loss:0.019987912848591805
Iteration: 533, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44789421558380127
loss_pred:0.03083486668765545, decouple_loss:0.020391905680298805
The generated pressure mean: 0.44886016845703125
loss_pred:0.02987055853009224, decouple_loss:0.020448947325348854
The generated pressure mean: 0.44932082295417786
loss_pred:0.029375199228525162, decouple_loss:0.02171335555613041
Iteration: 534, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4480588138103485
The generated pressure mean: 0.4501953721046448
loss_pred:0.030877461656928062, decouple_loss:0.01966935396194458
loss_pred:0.030507229268550873, decouple_loss:0.019927263259887695
The generated pressure mean: 0.4492919147014618
loss_pred:0.029462318867444992, decouple_loss:0.021640870720148087
Iteration: 535, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4483972489833832
The generated pressure mean: 0.44824108481407166
loss_pred:0.03159429505467415, decouple_loss:0.018801545724272728
loss_pred:0.0311666838824749, decouple_loss:0.019370906054973602
The generated pressure mean: 0.44861987233161926
loss_pred:0.029475679621100426, decouple_loss:0.019047904759645462
Iteration: 536, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44846054911613464
loss_pred:0.029313446953892708, decouple_loss:0.01878467947244644
The generated pressure mean: 0.44874969124794006
loss_pred:0.03178337216377258, decouple_loss:0.01916189305484295
The generated pressure mean: 0.4483239948749542
loss_pred:0.02993312105536461, decouple_loss:0.018571745604276657
Iteration: 537, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44696810841560364
loss_pred:0.0312686562538147, decouple_loss:0.020281020551919937
The generated pressure mean: 0.4489077031612396
loss_pred:0.02973506972193718, decouple_loss:0.019677404314279556
The generated pressure mean: 0.44929441809654236
loss_pred:0.031053945422172546, decouple_loss:0.020291896536946297
Iteration: 538, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4470607340335846
loss_pred:0.03088468313217163, decouple_loss:0.018660401925444603
The generated pressure mean: 0.449232280254364
loss_pred:0.029577674344182014, decouple_loss:0.0199006088078022
The generated pressure mean: 0.4489290714263916
loss_pred:0.030468929558992386, decouple_loss:0.018442928791046143
Iteration: 539, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44867604970932007
loss_pred:0.030347511172294617, decouple_loss:0.019652601331472397
The generated pressure mean: 0.4486789405345917
loss_pred:0.031791843473911285, decouple_loss:0.019471822306513786
The generated pressure mean: 0.4481390416622162
loss_pred:0.03268851712346077, decouple_loss:0.021698646247386932
Iteration: 540, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4507561922073364
loss_pred:0.030860356986522675, decouple_loss:0.01784583553671837
The generated pressure mean: 0.44795650243759155
loss_pred:0.030257411301136017, decouple_loss:0.018067093566060066
The generated pressure mean: 0.44894903898239136
loss_pred:0.030023792758584023, decouple_loss:0.017615007236599922
2023-04-16 03:33:41 testing...
The generated pressure mean: 0.4502691328525543
loss_pred:0.14330092072486877, decouple_loss:0.08158715814352036
The generated pressure mean: 0.4503253400325775
loss_pred:0.140109583735466, decouple_loss:0.0830879881978035
The generated pressure mean: 0.4500305950641632
loss_pred:0.14052137732505798, decouple_loss:0.08261758834123611
Loss: 0.14543217420578003, avg_mse: 0.25316286087036133
current test mse: 0.253163
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012005_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012005_3_24hr.npz
NaN value num: 0
Iteration: 541, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44887009263038635
loss_pred:0.03344542160630226, decouple_loss:0.02007295750081539
The generated pressure mean: 0.4485247731208801
loss_pred:0.03318383917212486, decouple_loss:0.021609092131257057
The generated pressure mean: 0.4484538435935974
loss_pred:0.0312890000641346, decouple_loss:0.018926898017525673
Iteration: 542, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4493192732334137
loss_pred:0.030472492799162865, decouple_loss:0.018387604504823685
The generated pressure mean: 0.4493444859981537
loss_pred:0.03278703987598419, decouple_loss:0.018785031512379646
The generated pressure mean: 0.4492631256580353
loss_pred:0.03121268004179001, decouple_loss:0.018214207142591476
Iteration: 543, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4486519992351532
loss_pred:0.031468652188777924, decouple_loss:0.01837346889078617
The generated pressure mean: 0.44842880964279175
loss_pred:0.03214719146490097, decouple_loss:0.018602419644594193
The generated pressure mean: 0.45004379749298096
loss_pred:0.03125910088419914, decouple_loss:0.020399248227477074
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 544, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4492933750152588
loss_pred:0.029923243448138237, decouple_loss:0.018971292302012444
The generated pressure mean: 0.44833770394325256
loss_pred:0.032279882580041885, decouple_loss:0.019020603969693184
The generated pressure mean: 0.44940003752708435
loss_pred:0.031107889488339424, decouple_loss:0.01994107849895954
Iteration: 545, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.449718177318573
loss_pred:0.031759172677993774, decouple_loss:0.01884792000055313
The generated pressure mean: 0.4491330683231354
loss_pred:0.03188268095254898, decouple_loss:0.01904282160103321
The generated pressure mean: 0.4493591785430908
loss_pred:0.032219164073467255, decouple_loss:0.02002805843949318
Iteration: 546, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4479463994503021
loss_pred:0.031514350324869156, decouple_loss:0.019846616312861443
The generated pressure mean: 0.4492109715938568
loss_pred:0.03206868842244148, decouple_loss:0.0191138107329607
The generated pressure mean: 0.4478297829627991
loss_pred:0.031665023416280746, decouple_loss:0.021521568298339844
Iteration: 547, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4495578706264496
loss_pred:0.032600000500679016, decouple_loss:0.020056698471307755
The generated pressure mean: 0.44796639680862427
loss_pred:0.03128599375486374, decouple_loss:0.020010629668831825
The generated pressure mean: 0.448976993560791
loss_pred:0.030737951397895813, decouple_loss:0.019683443009853363
Iteration: 548, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.448090523481369
loss_pred:0.03281055763363838, decouple_loss:0.019924914464354515
The generated pressure mean: 0.4491628110408783
loss_pred:0.03232264518737793, decouple_loss:0.0204900074750185
The generated pressure mean: 0.44919753074645996
loss_pred:0.03229965642094612, decouple_loss:0.019701171666383743
Iteration: 549, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4485856890678406
loss_pred:0.030903711915016174, decouple_loss:0.019181448966264725
The generated pressure mean: 0.4483224153518677
loss_pred:0.03190404549241066, decouple_loss:0.018983077257871628
The generated pressure mean: 0.44878149032592773
loss_pred:0.03170673921704292, decouple_loss:0.019428078085184097
Iteration: 550, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4486314058303833
loss_pred:0.03095816634595394, decouple_loss:0.01979018747806549
The generated pressure mean: 0.4492025077342987
loss_pred:0.030696839094161987, decouple_loss:0.020743783563375473
The generated pressure mean: 0.4477687478065491
loss_pred:0.03059753030538559, decouple_loss:0.019954320043325424
2023-04-16 03:36:25 testing...
The generated pressure mean: 0.4502691626548767
loss_pred:0.14246727526187897, decouple_loss:0.07848510891199112
The generated pressure mean: 0.4503227770328522
loss_pred:0.13969795405864716, decouple_loss:0.07970411330461502
The generated pressure mean: 0.4500313103199005
loss_pred:0.140284463763237, decouple_loss:0.07953625172376633
Loss: 0.14477866888046265, avg_mse: 0.25212302803993225
current test mse: 0.252123
Iteration: 551, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44866034388542175
loss_pred:0.03124448098242283, decouple_loss:0.020877880975604057
The generated pressure mean: 0.4472350478172302
loss_pred:0.03110346384346485, decouple_loss:0.020041095092892647
The generated pressure mean: 0.4481360912322998
loss_pred:0.03155369684100151, decouple_loss:0.019526846706867218
Iteration: 552, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44927921891212463
loss_pred:0.0318622849881649, decouple_loss:0.02012738212943077
The generated pressure mean: 0.4485698342323303
loss_pred:0.031618695706129074, decouple_loss:0.02068185806274414
The generated pressure mean: 0.44876980781555176
loss_pred:0.03054673597216606, decouple_loss:0.02049819380044937
Iteration: 553, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44880467653274536
The generated pressure mean: 0.4496057629585266
loss_pred:0.03060268796980381, decouple_loss:0.0196427833288908
loss_pred:0.029209047555923462, decouple_loss:0.01989416964352131
The generated pressure mean: 0.4492676854133606
loss_pred:0.03004787676036358, decouple_loss:0.0192572008818388
Iteration: 554, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4489654004573822
The generated pressure mean: 0.4499069154262543
loss_pred:0.03054634854197502, decouple_loss:0.020338598638772964
loss_pred:0.030893784016370773, decouple_loss:0.019257530570030212
The generated pressure mean: 0.45012256503105164
loss_pred:0.03025824949145317, decouple_loss:0.01918245106935501
Iteration: 555, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44861844182014465
loss_pred:0.031121721491217613, decouple_loss:0.02144298329949379
The generated pressure mean: 0.44934865832328796
loss_pred:0.030788345262408257, decouple_loss:0.021513374522328377
The generated pressure mean: 0.44908255338668823
loss_pred:0.02985178865492344, decouple_loss:0.020667487755417824
Iteration: 556, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44890713691711426
loss_pred:0.031390782445669174, decouple_loss:0.021169962361454964
The generated pressure mean: 0.4469268023967743
loss_pred:0.03027750551700592, decouple_loss:0.022034788504242897
The generated pressure mean: 0.4493410587310791
loss_pred:0.030801858752965927, decouple_loss:0.020370924845337868
Iteration: 557, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4492088854312897
loss_pred:0.03067430667579174, decouple_loss:0.019581539556384087
The generated pressure mean: 0.4482972025871277
loss_pred:0.03101961314678192, decouple_loss:0.02062351070344448
The generated pressure mean: 0.44951969385147095
loss_pred:0.030242256820201874, decouple_loss:0.020148586481809616
Iteration: 558, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4501315951347351
loss_pred:0.030170230194926262, decouple_loss:0.022557877004146576
The generated pressure mean: 0.44977855682373047
loss_pred:0.03029191866517067, decouple_loss:0.022244300693273544
The generated pressure mean: 0.44800499081611633
loss_pred:0.030853725969791412, decouple_loss:0.02159157209098339
Iteration: 559, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4493006467819214
loss_pred:0.02861173078417778, decouple_loss:0.01976080611348152
The generated pressure mean: 0.4481583535671234
loss_pred:0.029891880229115486, decouple_loss:0.01893768645823002
The generated pressure mean: 0.4490477442741394
loss_pred:0.02967786230146885, decouple_loss:0.019348420202732086
Iteration: 560, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4487856328487396
loss_pred:0.03049330785870552, decouple_loss:0.01810378208756447
The generated pressure mean: 0.4494639039039612
loss_pred:0.031504254788160324, decouple_loss:0.017891796305775642
The generated pressure mean: 0.44914817810058594
loss_pred:0.02918158657848835, decouple_loss:0.018464691936969757
2023-04-16 03:38:31 testing...
The generated pressure mean: 0.4502691626548767
loss_pred:0.13873863220214844, decouple_loss:0.0761171281337738
The generated pressure mean: 0.45032450556755066
loss_pred:0.13568058609962463, decouple_loss:0.0777457058429718
The generated pressure mean: 0.4500303268432617
loss_pred:0.13619057834148407, decouple_loss:0.07779663801193237
Loss: 0.14073091745376587, avg_mse: 0.2429920732975006
current test mse: 0.242992
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012000_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012000_3_24hr.npz
NaN value num: 0
Iteration: 561, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4475935101509094
loss_pred:0.03480871766805649, decouple_loss:0.019504934549331665
The generated pressure mean: 0.44749754667282104
loss_pred:0.031068164855241776, decouple_loss:0.01921665295958519
The generated pressure mean: 0.4479496479034424
loss_pred:0.02965215966105461, decouple_loss:0.019307175651192665
Iteration: 562, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.446709007024765
loss_pred:0.030908579006791115, decouple_loss:0.018623938784003258
The generated pressure mean: 0.4484401047229767
loss_pred:0.030962878838181496, decouple_loss:0.01863142102956772
The generated pressure mean: 0.4487334191799164
loss_pred:0.032099951058626175, decouple_loss:0.01927184872329235
Iteration: 563, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4471251368522644
loss_pred:0.0311578419059515, decouple_loss:0.019004475325345993
The generated pressure mean: 0.44794130325317383
loss_pred:0.030053822323679924, decouple_loss:0.01843841001391411
The generated pressure mean: 0.44754672050476074
loss_pred:0.03057316690683365, decouple_loss:0.017375333234667778
Iteration: 564, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44737911224365234
loss_pred:0.030062180012464523, decouple_loss:0.017902648076415062
The generated pressure mean: 0.4464258849620819
loss_pred:0.02877611108124256, decouple_loss:0.017764117568731308
The generated pressure mean: 0.4480600953102112
loss_pred:0.029281986877322197, decouple_loss:0.017749931663274765
Iteration: 565, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4473140835762024
loss_pred:0.029464028775691986, decouple_loss:0.017897650599479675
The generated pressure mean: 0.44786548614501953
loss_pred:0.031007103621959686, decouple_loss:0.018802551552653313
The generated pressure mean: 0.4472610652446747
loss_pred:0.0297286044806242, decouple_loss:0.017331888899207115
Iteration: 566, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4489707052707672
The generated pressure mean: 0.44712406396865845loss_pred:0.030859431251883507, decouple_loss:0.01831899769604206
loss_pred:0.03066921792924404, decouple_loss:0.019408270716667175
The generated pressure mean: 0.44746533036231995
loss_pred:0.03191331773996353, decouple_loss:0.019278479740023613
Iteration: 567, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4472123980522156
loss_pred:0.031095409765839577, decouple_loss:0.01827569305896759
The generated pressure mean: 0.4468829035758972
loss_pred:0.02985380031168461, decouple_loss:0.017870748415589333
The generated pressure mean: 0.44795656204223633
loss_pred:0.028981175273656845, decouple_loss:0.017426716163754463
Iteration: 568, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4490172863006592
loss_pred:0.030683042481541634, decouple_loss:0.021495092660188675
The generated pressure mean: 0.44756293296813965
loss_pred:0.029191847890615463, decouple_loss:0.02127249166369438
The generated pressure mean: 0.44797053933143616
loss_pred:0.03256244584918022, decouple_loss:0.0209213737398386
Iteration: 569, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4482490122318268
loss_pred:0.030993271619081497, decouple_loss:0.01771475374698639
The generated pressure mean: 0.44722461700439453
loss_pred:0.029838459566235542, decouple_loss:0.017431801185011864
The generated pressure mean: 0.44610050320625305
loss_pred:0.030274773016572, decouple_loss:0.016651196405291557
Iteration: 570, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4470287561416626
loss_pred:0.02956339158117771, decouple_loss:0.02042568288743496
The generated pressure mean: 0.4481070637702942
loss_pred:0.03086736984550953, decouple_loss:0.020853344351053238
The generated pressure mean: 0.447490930557251
loss_pred:0.029371676966547966, decouple_loss:0.021044854074716568
2023-04-16 03:41:27 testing...
The generated pressure mean: 0.4502691328525543
loss_pred:0.14384843409061432, decouple_loss:0.07947590947151184
The generated pressure mean: 0.450324147939682
loss_pred:0.14078781008720398, decouple_loss:0.08105778694152832
The generated pressure mean: 0.45003122091293335
loss_pred:0.14126574993133545, decouple_loss:0.08124354481697083
Loss: 0.14599695801734924, avg_mse: 0.25432541966438293
current test mse: 0.254325
Iteration: 571, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44839179515838623
loss_pred:0.030549468472599983, decouple_loss:0.01710364781320095
The generated pressure mean: 0.44718602299690247
loss_pred:0.03136288374662399, decouple_loss:0.017276613041758537
The generated pressure mean: 0.44974178075790405
loss_pred:0.029374323785305023, decouple_loss:0.0167786106467247
Iteration: 572, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4488445818424225
The generated pressure mean: 0.4482596218585968
loss_pred:0.03187108784914017, decouple_loss:0.018935896456241608
loss_pred:0.033045969903469086, decouple_loss:0.020047077909111977
The generated pressure mean: 0.4477517604827881
loss_pred:0.03160490468144417, decouple_loss:0.01916244439780712
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 573, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4470139145851135
loss_pred:0.031704243272542953, decouple_loss:0.0188502948731184
The generated pressure mean: 0.44609931111335754
loss_pred:0.031138552352786064, decouple_loss:0.018425388261675835
The generated pressure mean: 0.4485503137111664
loss_pred:0.030519507825374603, decouple_loss:0.01741286739706993
Iteration: 574, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44814980030059814
loss_pred:0.02961229346692562, decouple_loss:0.019020291045308113
The generated pressure mean: 0.44885164499282837
loss_pred:0.031374700367450714, decouple_loss:0.019457191228866577
The generated pressure mean: 0.44708600640296936
loss_pred:0.03131183981895447, decouple_loss:0.01815008372068405
Iteration: 575, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44824519753456116
loss_pred:0.030367225408554077, decouple_loss:0.01812746189534664
The generated pressure mean: 0.4479261338710785
loss_pred:0.029837636277079582, decouple_loss:0.01991097629070282
The generated pressure mean: 0.44707825779914856
loss_pred:0.03080684132874012, decouple_loss:0.01936524733901024
Iteration: 576, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4472757577896118
loss_pred:0.029540030285716057, decouple_loss:0.01704166829586029
The generated pressure mean: 0.44843602180480957
loss_pred:0.029302624985575676, decouple_loss:0.01715286821126938
The generated pressure mean: 0.4476098418235779
loss_pred:0.0310114324092865, decouple_loss:0.0176431592553854
Iteration: 577, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4467219114303589
loss_pred:0.028917044401168823, decouple_loss:0.020174790173768997
The generated pressure mean: 0.4478125274181366
loss_pred:0.029428226873278618, decouple_loss:0.01871369779109955
The generated pressure mean: 0.44934186339378357
loss_pred:0.030120400711894035, decouple_loss:0.01855149120092392
Iteration: 578, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44690588116645813
loss_pred:0.028847699984908104, decouple_loss:0.017920169979333878
The generated pressure mean: 0.44861936569213867
loss_pred:0.03013749048113823, decouple_loss:0.01680191420018673
The generated pressure mean: 0.446984201669693
loss_pred:0.02865177020430565, decouple_loss:0.017058543860912323
Iteration: 579, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44765350222587585
loss_pred:0.03085199184715748, decouple_loss:0.016574792563915253
The generated pressure mean: 0.4498240351676941
loss_pred:0.029700251296162605, decouple_loss:0.016487451270222664
The generated pressure mean: 0.4476770758628845
loss_pred:0.029963821172714233, decouple_loss:0.01720193400979042
Iteration: 580, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44934797286987305
loss_pred:0.030534416437149048, decouple_loss:0.01699245162308216
The generated pressure mean: 0.4476032257080078
loss_pred:0.028642818331718445, decouple_loss:0.017435479909181595
The generated pressure mean: 0.44603395462036133
loss_pred:0.031793851405382156, decouple_loss:0.017297158017754555
2023-04-16 03:43:34 testing...
The generated pressure mean: 0.4502691924571991
loss_pred:0.14781856536865234, decouple_loss:0.08156213164329529
The generated pressure mean: 0.45032399892807007
loss_pred:0.144988551735878, decouple_loss:0.08296164125204086
The generated pressure mean: 0.4500291645526886
loss_pred:0.14549089968204498, decouple_loss:0.08273688703775406
Loss: 0.1502203643321991, avg_mse: 0.26626890897750854
current test mse: 0.266269
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012019_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012019_3_24hr.npz
NaN value num: 0
Iteration: 581, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4493449032306671
loss_pred:0.03003629297018051, decouple_loss:0.016901591792702675
The generated pressure mean: 0.44956693053245544
loss_pred:0.030005501583218575, decouple_loss:0.01766628585755825
The generated pressure mean: 0.44961217045783997
loss_pred:0.03037433512508869, decouple_loss:0.018089953809976578
Iteration: 582, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4494604766368866
loss_pred:0.028888845816254616, decouple_loss:0.016683904454112053
The generated pressure mean: 0.4487718939781189
loss_pred:0.03128345310688019, decouple_loss:0.017589224502444267
The generated pressure mean: 0.4480932950973511
loss_pred:0.03151966631412506, decouple_loss:0.016843322664499283
Iteration: 583, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45014870166778564
loss_pred:0.02951628342270851, decouple_loss:0.01806182786822319
The generated pressure mean: 0.4493943154811859
loss_pred:0.03045881912112236, decouple_loss:0.019656097516417503
The generated pressure mean: 0.44952327013015747
loss_pred:0.03005356155335903, decouple_loss:0.020383454859256744
Iteration: 584, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4485516846179962
loss_pred:0.02936999686062336, decouple_loss:0.01717408373951912
The generated pressure mean: 0.4497334063053131
loss_pred:0.030492257326841354, decouple_loss:0.017795611172914505
The generated pressure mean: 0.4498685896396637
loss_pred:0.030184242874383926, decouple_loss:0.017432034015655518
Iteration: 585, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4496588706970215
loss_pred:0.029853779822587967, decouple_loss:0.020393982529640198
The generated pressure mean: 0.4500995874404907
loss_pred:0.030564134940505028, decouple_loss:0.019261717796325684
The generated pressure mean: 0.4495023190975189
loss_pred:0.03046233206987381, decouple_loss:0.021348800510168076
Iteration: 586, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44935813546180725
loss_pred:0.029916055500507355, decouple_loss:0.01974477805197239
The generated pressure mean: 0.4487694799900055
loss_pred:0.030461886897683144, decouple_loss:0.019896170124411583
The generated pressure mean: 0.44867071509361267
loss_pred:0.03078419156372547, decouple_loss:0.02020145207643509
Iteration: 587, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4498189687728882
loss_pred:0.0300158504396677, decouple_loss:0.019081778824329376
The generated pressure mean: 0.44921237230300903
loss_pred:0.03112078085541725, decouple_loss:0.018646275624632835
The generated pressure mean: 0.4495663046836853
loss_pred:0.030199844390153885, decouple_loss:0.01931372843682766
Iteration: 588, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44962939620018005
loss_pred:0.030855342745780945, decouple_loss:0.01936229132115841
The generated pressure mean: 0.4484623968601227
loss_pred:0.033754862844944, decouple_loss:0.018231714144349098
The generated pressure mean: 0.44997236132621765
loss_pred:0.029350437223911285, decouple_loss:0.01813574694097042
Iteration: 589, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44836685061454773
loss_pred:0.0309718307107687, decouple_loss:0.01860545203089714
The generated pressure mean: 0.4499600827693939
loss_pred:0.02970713935792446, decouple_loss:0.01936417631804943
The generated pressure mean: 0.4489665925502777
loss_pred:0.0297981146723032, decouple_loss:0.018812544643878937
Iteration: 590, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44919636845588684
loss_pred:0.0330503024160862, decouple_loss:0.018136784434318542
The generated pressure mean: 0.44870442152023315
loss_pred:0.029766179621219635, decouple_loss:0.017550520598888397
The generated pressure mean: 0.4489586651325226
loss_pred:0.030170796439051628, decouple_loss:0.018122075125575066
2023-04-16 03:46:27 testing...
The generated pressure mean: 0.4502691328525543
loss_pred:0.1484035700559616, decouple_loss:0.081363745033741
The generated pressure mean: 0.4503255784511566
loss_pred:0.1455465853214264, decouple_loss:0.08253785967826843
The generated pressure mean: 0.45003071427345276
loss_pred:0.14625418186187744, decouple_loss:0.0821109488606453
Loss: 0.15083500742912292, avg_mse: 0.2675553858280182
current test mse: 0.267555
Iteration: 591, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4499531388282776
loss_pred:0.030372457578778267, decouple_loss:0.01813346892595291
The generated pressure mean: 0.4485468566417694
loss_pred:0.030692605301737785, decouple_loss:0.017976030707359314
The generated pressure mean: 0.4500569701194763
loss_pred:0.029220091179013252, decouple_loss:0.018404578790068626
Iteration: 592, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44999194145202637
loss_pred:0.03202321380376816, decouple_loss:0.017674604430794716
The generated pressure mean: 0.44953179359436035
loss_pred:0.028963429853320122, decouple_loss:0.018745414912700653
The generated pressure mean: 0.4494352340698242
loss_pred:0.031230587512254715, decouple_loss:0.01781279593706131
Iteration: 593, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4489870071411133
loss_pred:0.0312618613243103, decouple_loss:0.020483480766415596
The generated pressure mean: 0.44812366366386414
The generated pressure mean: 0.44873395562171936
loss_pred:0.030446581542491913, decouple_loss:0.01886831596493721
loss_pred:0.031913042068481445, decouple_loss:0.02079147659242153
Iteration: 594, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4485856890678406
The generated pressure mean: 0.4490329921245575loss_pred:0.030597036704421043, decouple_loss:0.019773589447140694
loss_pred:0.030247291550040245, decouple_loss:0.022177081555128098
The generated pressure mean: 0.44926026463508606
loss_pred:0.0293405894190073, decouple_loss:0.02049046754837036
Iteration: 595, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4483998417854309
loss_pred:0.030994806438684464, decouple_loss:0.018080973997712135
The generated pressure mean: 0.44870486855506897
loss_pred:0.029966605827212334, decouple_loss:0.017929682508111
The generated pressure mean: 0.4479031264781952
loss_pred:0.031202282756567, decouple_loss:0.018613921478390694
Iteration: 596, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4496869444847107
The generated pressure mean: 0.44954678416252136
loss_pred:0.030276233330368996, decouple_loss:0.021212084218859673
loss_pred:0.02940181829035282, decouple_loss:0.020363014191389084
The generated pressure mean: 0.4490983784198761
loss_pred:0.03003254160284996, decouple_loss:0.020667707547545433
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 597, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4488532245159149
loss_pred:0.02947087399661541, decouple_loss:0.018052419647574425
The generated pressure mean: 0.4497300684452057
loss_pred:0.029995787888765335, decouple_loss:0.018597351387143135
The generated pressure mean: 0.45004722476005554
loss_pred:0.031128069385886192, decouple_loss:0.017521942034363747
Iteration: 598, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4481174349784851The generated pressure mean: 0.4496130645275116
loss_pred:0.030585285276174545, decouple_loss:0.019415389746427536loss_pred:0.030477438122034073, decouple_loss:0.019353080540895462
The generated pressure mean: 0.44972917437553406
loss_pred:0.030126426368951797, decouple_loss:0.019569557160139084
Iteration: 599, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44927114248275757
loss_pred:0.031431857496500015, decouple_loss:0.01871313713490963
The generated pressure mean: 0.4491121768951416
loss_pred:0.02829556353390217, decouple_loss:0.01906200312077999
The generated pressure mean: 0.4491369128227234
loss_pred:0.028650790452957153, decouple_loss:0.019152311608195305
Iteration: 600, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4500221312046051
The generated pressure mean: 0.44953057169914246
loss_pred:0.029927479103207588, decouple_loss:0.017692090943455696
loss_pred:0.030031584203243256, decouple_loss:0.01825856976211071
The generated pressure mean: 0.44839346408843994
loss_pred:0.031153414398431778, decouple_loss:0.0194147527217865
2023-04-16 03:48:32 testing...
The generated pressure mean: 0.4502691328525543
loss_pred:0.14692920446395874, decouple_loss:0.07802104204893112
The generated pressure mean: 0.4503228962421417
loss_pred:0.14404352009296417, decouple_loss:0.07875896245241165
The generated pressure mean: 0.450029194355011
loss_pred:0.14478060603141785, decouple_loss:0.07846081256866455
Loss: 0.14917179942131042, avg_mse: 0.2653559446334839
current test mse: 0.265356
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012003_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012003_3_24hr.npz
NaN value num: 0
Iteration: 601, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44800105690956116
loss_pred:0.031404368579387665, decouple_loss:0.020842822268605232
The generated pressure mean: 0.4482380151748657
loss_pred:0.030712785199284554, decouple_loss:0.01892015151679516
The generated pressure mean: 0.4487369656562805
loss_pred:0.029541922733187675, decouple_loss:0.019284535199403763
Iteration: 602, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4482164978981018
loss_pred:0.029598014429211617, decouple_loss:0.021426601335406303
The generated pressure mean: 0.44894951581954956
loss_pred:0.029482020065188408, decouple_loss:0.019550485536456108
The generated pressure mean: 0.44747743010520935
loss_pred:0.030759841203689575, decouple_loss:0.01885117217898369
Iteration: 603, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4499390125274658
loss_pred:0.029758237302303314, decouple_loss:0.018579918891191483
The generated pressure mean: 0.44996213912963867
loss_pred:0.03122723288834095, decouple_loss:0.020038286224007607
The generated pressure mean: 0.4499334394931793
loss_pred:0.03033716045320034, decouple_loss:0.019300373271107674
Iteration: 604, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4494469165802002
loss_pred:0.030185548588633537, decouple_loss:0.01965457946062088
The generated pressure mean: 0.4485988914966583
loss_pred:0.02929607592523098, decouple_loss:0.02049211971461773
The generated pressure mean: 0.44739416241645813
loss_pred:0.03064202331006527, decouple_loss:0.01973251812160015
Iteration: 605, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44937896728515625
loss_pred:0.029268980026245117, decouple_loss:0.01949881762266159
The generated pressure mean: 0.44871535897254944
loss_pred:0.030145792290568352, decouple_loss:0.01957194320857525
The generated pressure mean: 0.44950684905052185
loss_pred:0.03038676828145981, decouple_loss:0.019374972209334373
Iteration: 606, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4483085572719574
loss_pred:0.03041681833565235, decouple_loss:0.021367032080888748
The generated pressure mean: 0.4476034343242645
loss_pred:0.028894197195768356, decouple_loss:0.019717779010534286
The generated pressure mean: 0.4495600759983063
loss_pred:0.028961241245269775, decouple_loss:0.02173757180571556
Iteration: 607, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4485897719860077
The generated pressure mean: 0.4481889307498932
loss_pred:0.029320280998945236, decouple_loss:0.019138110801577568
loss_pred:0.029949305579066277, decouple_loss:0.020314261317253113
The generated pressure mean: 0.4483243525028229
loss_pred:0.030766215175390244, decouple_loss:0.020998705178499222
Iteration: 608, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4485328197479248
loss_pred:0.03083830326795578, decouple_loss:0.01924457959830761
The generated pressure mean: 0.4478297531604767
loss_pred:0.030049337074160576, decouple_loss:0.021390406414866447
The generated pressure mean: 0.44902676343917847
loss_pred:0.029076311737298965, decouple_loss:0.02130810171365738
Iteration: 609, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4494214355945587
loss_pred:0.031177248805761337, decouple_loss:0.02007991634309292
The generated pressure mean: 0.44873014092445374
loss_pred:0.028503788635134697, decouple_loss:0.020384909585118294
The generated pressure mean: 0.44929763674736023
loss_pred:0.028176425024867058, decouple_loss:0.019418127834796906
Iteration: 610, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44946667551994324
loss_pred:0.029055379331111908, decouple_loss:0.020525863394141197
The generated pressure mean: 0.44911250472068787
loss_pred:0.03056659735739231, decouple_loss:0.021408166736364365
The generated pressure mean: 0.4511474072933197
loss_pred:0.029201636090874672, decouple_loss:0.020961783826351166
2023-04-16 03:51:13 testing...
The generated pressure mean: 0.4502691924571991
loss_pred:0.14652211964130402, decouple_loss:0.08042395114898682
The generated pressure mean: 0.4500318467617035
loss_pred:0.14427165687084198, decouple_loss:0.08070117980241776
The generated pressure mean: 0.45032307505607605
loss_pred:0.14355427026748657, decouple_loss:0.08062952756881714
Loss: 0.148811936378479, avg_mse: 0.26554256677627563
current test mse: 0.265543
Iteration: 611, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44817763566970825
loss_pred:0.02850797399878502, decouple_loss:0.018831627443432808
The generated pressure mean: 0.44918859004974365
loss_pred:0.03010709583759308, decouple_loss:0.018170762807130814
The generated pressure mean: 0.44898685812950134
loss_pred:0.028858887031674385, decouple_loss:0.01754443533718586
Iteration: 612, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4495968520641327
loss_pred:0.028999116271734238, decouple_loss:0.020372070372104645
The generated pressure mean: 0.4510739743709564
loss_pred:0.029325926676392555, decouple_loss:0.02096160314977169
The generated pressure mean: 0.4503149688243866
loss_pred:0.029501577839255333, decouple_loss:0.020001092925667763
Iteration: 613, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44904130697250366
The generated pressure mean: 0.44911500811576843
loss_pred:0.029797762632369995, decouple_loss:0.02007843367755413
loss_pred:0.030707592144608498, decouple_loss:0.020170696079730988
The generated pressure mean: 0.4483240842819214
loss_pred:0.028668640181422234, decouple_loss:0.02074962481856346
Iteration: 614, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4488145709037781
loss_pred:0.029942698776721954, decouple_loss:0.01781453937292099
The generated pressure mean: 0.44900965690612793
loss_pred:0.029381096363067627, decouple_loss:0.019344862550497055
The generated pressure mean: 0.4489130675792694
loss_pred:0.030828429386019707, decouple_loss:0.01814856380224228
Iteration: 615, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44863542914390564
loss_pred:0.030429722741246223, decouple_loss:0.01968914270401001
The generated pressure mean: 0.4487869441509247
loss_pred:0.0300688985735178, decouple_loss:0.020206507295370102
The generated pressure mean: 0.4480249881744385
loss_pred:0.029342317953705788, decouple_loss:0.01839173585176468
Iteration: 616, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44901949167251587
The generated pressure mean: 0.4473695755004883
loss_pred:0.02892492152750492, decouple_loss:0.01793545112013817
loss_pred:0.028921853750944138, decouple_loss:0.01727956160902977
The generated pressure mean: 0.4479886293411255
loss_pred:0.02840459533035755, decouple_loss:0.017336098477244377
Iteration: 617, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44903984665870667
loss_pred:0.029155422002077103, decouple_loss:0.019136464223265648
The generated pressure mean: 0.4496249556541443
loss_pred:0.030226629227399826, decouple_loss:0.018148887902498245
The generated pressure mean: 0.44782450795173645
loss_pred:0.027966076508164406, decouple_loss:0.01849103532731533
Iteration: 618, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44890260696411133
The generated pressure mean: 0.4487903118133545
loss_pred:0.029079623520374298, decouple_loss:0.016963940113782883
loss_pred:0.028684822842478752, decouple_loss:0.01785961166024208
The generated pressure mean: 0.4492085576057434
loss_pred:0.02882922813296318, decouple_loss:0.01697564125061035
Iteration: 619, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4484439194202423
loss_pred:0.02894066460430622, decouple_loss:0.020140040665864944
The generated pressure mean: 0.44874337315559387
loss_pred:0.029247412458062172, decouple_loss:0.01915869116783142
The generated pressure mean: 0.449739009141922
loss_pred:0.028690040111541748, decouple_loss:0.018811408430337906
Iteration: 620, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44881314039230347
loss_pred:0.029982995241880417, decouple_loss:0.01692478358745575
The generated pressure mean: 0.4487335979938507
loss_pred:0.029297662898898125, decouple_loss:0.016871346160769463
The generated pressure mean: 0.44951727986335754
loss_pred:0.029443981125950813, decouple_loss:0.018146980553865433
2023-04-16 03:53:19 testing...
The generated pressure mean: 0.4502691328525543
loss_pred:0.14754924178123474, decouple_loss:0.0816640630364418
The generated pressure mean: 0.4503224492073059
loss_pred:0.14454741775989532, decouple_loss:0.08191437274217606
The generated pressure mean: 0.4500313401222229
loss_pred:0.14522546529769897, decouple_loss:0.0816415399312973
Loss: 0.14986103773117065, avg_mse: 0.26751992106437683
current test mse: 0.26752
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012017_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012017_3_24hr.npz
NaN value num: 0
Iteration: 621, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44998639822006226
loss_pred:0.02864244394004345, decouple_loss:0.020691437646746635
The generated pressure mean: 0.4484025537967682
loss_pred:0.02888023667037487, decouple_loss:0.018817611038684845
The generated pressure mean: 0.44880226254463196
loss_pred:0.029759855940937996, decouple_loss:0.020017540082335472
Iteration: 622, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44934719800949097
loss_pred:0.030755620449781418, decouple_loss:0.017553433775901794
The generated pressure mean: 0.4497857987880707
loss_pred:0.028479794040322304, decouple_loss:0.018963748589158058
The generated pressure mean: 0.44777509570121765
loss_pred:0.02972612902522087, decouple_loss:0.016804341226816177
Iteration: 623, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4473997950553894
loss_pred:0.028716493397951126, decouple_loss:0.01781260408461094
The generated pressure mean: 0.4491903483867645
loss_pred:0.027486562728881836, decouple_loss:0.017680007964372635
The generated pressure mean: 0.4492236077785492
loss_pred:0.030098408460617065, decouple_loss:0.017525529488921165
Iteration: 624, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4489535391330719
loss_pred:0.028358396142721176, decouple_loss:0.017931373789906502
The generated pressure mean: 0.44771450757980347
loss_pred:0.029659003019332886, decouple_loss:0.01680854521691799
The generated pressure mean: 0.45017391443252563
loss_pred:0.029077179729938507, decouple_loss:0.016394319012761116
Iteration: 625, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4488009214401245
loss_pred:0.028200460597872734, decouple_loss:0.018544264137744904
The generated pressure mean: 0.4492504894733429
loss_pred:0.02909514307975769, decouple_loss:0.01900848187506199
The generated pressure mean: 0.44943147897720337
loss_pred:0.027998527511954308, decouple_loss:0.018399382010102272
Iteration: 626, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44929686188697815
loss_pred:0.03266795724630356, decouple_loss:0.018397564068436623
The generated pressure mean: 0.44932952523231506
loss_pred:0.029242098331451416, decouple_loss:0.018903963267803192
The generated pressure mean: 0.4499869644641876
loss_pred:0.030111296102404594, decouple_loss:0.019055331125855446
Iteration: 627, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4500746428966522
loss_pred:0.03141745552420616, decouple_loss:0.019577499479055405
The generated pressure mean: 0.4478321373462677
loss_pred:0.031153222545981407, decouple_loss:0.01882781647145748
The generated pressure mean: 0.44871118664741516
loss_pred:0.03137201443314552, decouple_loss:0.01892683282494545
Iteration: 628, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44858238101005554The generated pressure mean: 0.45037129521369934
loss_pred:0.02983691729605198, decouple_loss:0.01948181726038456
loss_pred:0.03051680140197277, decouple_loss:0.019569138064980507
The generated pressure mean: 0.45002275705337524
loss_pred:0.029639974236488342, decouple_loss:0.019406765699386597
Iteration: 629, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44865545630455017
loss_pred:0.028700605034828186, decouple_loss:0.021674297749996185
The generated pressure mean: 0.4492688775062561
loss_pred:0.030089745298027992, decouple_loss:0.02010960690677166
The generated pressure mean: 0.4495125412940979
loss_pred:0.03195134922862053, decouple_loss:0.019950687885284424
Iteration: 630, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44869235157966614
The generated pressure mean: 0.4481043219566345
loss_pred:0.03225289285182953, decouple_loss:0.019143570214509964
loss_pred:0.0295749232172966, decouple_loss:0.01908535696566105
The generated pressure mean: 0.44911274313926697
loss_pred:0.03038659691810608, decouple_loss:0.02110295370221138
2023-04-16 03:56:00 testing...
The generated pressure mean: 0.4502691626548767
loss_pred:0.15278595685958862, decouple_loss:0.08753417432308197
The generated pressure mean: 0.450327605009079
loss_pred:0.14962594211101532, decouple_loss:0.08844460546970367
The generated pressure mean: 0.4500329792499542
loss_pred:0.1504487246274948, decouple_loss:0.08845429122447968
Loss: 0.15536075830459595, avg_mse: 0.28350380063056946
current test mse: 0.283504
Iteration: 631, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4489686191082001
loss_pred:0.030035078525543213, decouple_loss:0.020284930244088173
The generated pressure mean: 0.4485357999801636
loss_pred:0.0289422869682312, decouple_loss:0.020404044538736343
The generated pressure mean: 0.4482247531414032
loss_pred:0.03102385438978672, decouple_loss:0.020859843119978905
Iteration: 632, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4481360912322998
loss_pred:0.028120188042521477, decouple_loss:0.019426977261900902
The generated pressure mean: 0.44986414909362793
loss_pred:0.029974425211548805, decouple_loss:0.02072392776608467
The generated pressure mean: 0.4492168426513672
loss_pred:0.027758868411183357, decouple_loss:0.019521517679095268
Iteration: 633, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4498917758464813
loss_pred:0.03196975588798523, decouple_loss:0.02011890336871147
The generated pressure mean: 0.4481717348098755
loss_pred:0.03148242086172104, decouple_loss:0.01926417089998722
The generated pressure mean: 0.44904181361198425
loss_pred:0.031760383397340775, decouple_loss:0.01953672617673874
Iteration: 634, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4489537179470062
loss_pred:0.029275044798851013, decouple_loss:0.024344591423869133
The generated pressure mean: 0.4495771825313568
loss_pred:0.02988245151937008, decouple_loss:0.020824436098337173
The generated pressure mean: 0.44910675287246704
loss_pred:0.028984513133764267, decouple_loss:0.02109353616833687
Iteration: 635, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4484560787677765
loss_pred:0.029146570712327957, decouple_loss:0.019502608105540276
The generated pressure mean: 0.4481949806213379
loss_pred:0.0286969356238842, decouple_loss:0.019788332283496857
The generated pressure mean: 0.4484076201915741
loss_pred:0.02923000417649746, decouple_loss:0.0190582312643528
Iteration: 636, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4477630853652954
loss_pred:0.029982687905430794, decouple_loss:0.021669823676347733
The generated pressure mean: 0.44827449321746826
loss_pred:0.03036973811686039, decouple_loss:0.02032504789531231
The generated pressure mean: 0.4484556019306183
loss_pred:0.030806276947259903, decouple_loss:0.022279446944594383
Iteration: 637, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44957610964775085
loss_pred:0.028632784262299538, decouple_loss:0.019228173419833183
The generated pressure mean: 0.4494103789329529
loss_pred:0.029685359448194504, decouple_loss:0.018422558903694153
The generated pressure mean: 0.4489348828792572
loss_pred:0.028804505243897438, decouple_loss:0.019307490438222885
Iteration: 638, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4495071768760681
The generated pressure mean: 0.4485710561275482loss_pred:0.028647873550653458, decouple_loss:0.018704000860452652
loss_pred:0.031162483617663383, decouple_loss:0.017663288861513138
The generated pressure mean: 0.4483952522277832
loss_pred:0.02925216592848301, decouple_loss:0.018172405660152435
Iteration: 639, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4478486180305481
loss_pred:0.028356675058603287, decouple_loss:0.01808120310306549
The generated pressure mean: 0.44946083426475525
loss_pred:0.029089808464050293, decouple_loss:0.01693708822131157
The generated pressure mean: 0.4481053054332733
loss_pred:0.029222561046481133, decouple_loss:0.01794067770242691
Iteration: 640, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45041996240615845
loss_pred:0.02835806831717491, decouple_loss:0.017840610817074776
The generated pressure mean: 0.4494308829307556
loss_pred:0.028212280943989754, decouple_loss:0.0189274363219738
The generated pressure mean: 0.4479864835739136
loss_pred:0.029277335852384567, decouple_loss:0.017231788486242294
2023-04-16 03:58:06 testing...
The generated pressure mean: 0.4502691626548767
loss_pred:0.1500651091337204, decouple_loss:0.079610176384449
The generated pressure mean: 0.45032480359077454
loss_pred:0.1471615880727768, decouple_loss:0.08063982427120209
The generated pressure mean: 0.4500308632850647
loss_pred:0.14815133810043335, decouple_loss:0.08057165145874023
Loss: 0.15247304737567902, avg_mse: 0.2765819728374481
current test mse: 0.276582
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012011_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012011_3_24hr.npz
NaN value num: 0
Iteration: 641, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4483192265033722
loss_pred:0.02926274947822094, decouple_loss:0.018236100673675537
The generated pressure mean: 0.4486841857433319
loss_pred:0.028185877948999405, decouple_loss:0.01888452097773552
The generated pressure mean: 0.44826194643974304
loss_pred:0.031159987673163414, decouple_loss:0.019277391955256462
Iteration: 642, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4477091133594513
loss_pred:0.028977543115615845, decouple_loss:0.01825960911810398
The generated pressure mean: 0.4482225775718689
loss_pred:0.02922917529940605, decouple_loss:0.017644742503762245
The generated pressure mean: 0.44873443245887756
loss_pred:0.029255980625748634, decouple_loss:0.017663033679127693
Iteration: 643, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44737252593040466
loss_pred:0.028553880751132965, decouple_loss:0.01702873222529888
The generated pressure mean: 0.44711068272590637
The generated pressure mean: 0.4476168155670166loss_pred:0.029793623834848404, decouple_loss:0.01966852694749832
loss_pred:0.029187900945544243, decouple_loss:0.01822369173169136
Iteration: 644, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44920817017555237
loss_pred:0.028307078406214714, decouple_loss:0.018190238624811172
The generated pressure mean: 0.44789692759513855
loss_pred:0.0288064144551754, decouple_loss:0.017473258078098297
The generated pressure mean: 0.44851380586624146
loss_pred:0.0286317840218544, decouple_loss:0.0172739140689373
Iteration: 645, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4472618103027344
loss_pred:0.029672356322407722, decouple_loss:0.01959097385406494
The generated pressure mean: 0.44763293862342834
loss_pred:0.028706686571240425, decouple_loss:0.01901121251285076
The generated pressure mean: 0.4481087327003479
loss_pred:0.027981700375676155, decouple_loss:0.019593048840761185
Iteration: 646, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44826266169548035
loss_pred:0.02930312417447567, decouple_loss:0.01839030161499977
The generated pressure mean: 0.4492788016796112
loss_pred:0.02804202027618885, decouple_loss:0.018364541232585907
The generated pressure mean: 0.44965288043022156
loss_pred:0.029752574861049652, decouple_loss:0.020300794392824173
Iteration: 647, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.448268860578537
The generated pressure mean: 0.44798457622528076
loss_pred:0.02865498885512352, decouple_loss:0.01758037507534027
loss_pred:0.03131721541285515, decouple_loss:0.01818881370127201
The generated pressure mean: 0.44966593384742737
loss_pred:0.03016125224530697, decouple_loss:0.01912049949169159
Iteration: 648, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44796428084373474
loss_pred:0.02803373895585537, decouple_loss:0.017849382013082504
The generated pressure mean: 0.44804564118385315
loss_pred:0.029565354809165, decouple_loss:0.021032344549894333
The generated pressure mean: 0.4476020336151123
loss_pred:0.028979450464248657, decouple_loss:0.019763559103012085
Iteration: 649, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4482293426990509
loss_pred:0.03015531413257122, decouple_loss:0.018965749070048332
The generated pressure mean: 0.44777700304985046
loss_pred:0.0277459267526865, decouple_loss:0.02032429538667202
The generated pressure mean: 0.4477546513080597
loss_pred:0.030536388978362083, decouple_loss:0.020019689574837685
Iteration: 650, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4485514760017395
loss_pred:0.026383036747574806, decouple_loss:0.01805245317518711
The generated pressure mean: 0.4485480785369873
loss_pred:0.0275276992470026, decouple_loss:0.017357872799038887
The generated pressure mean: 0.4483775794506073
loss_pred:0.029472485184669495, decouple_loss:0.017867421731352806
2023-04-16 04:00:48 testing...
The generated pressure mean: 0.4502691626548767
loss_pred:0.14618363976478577, decouple_loss:0.07558707892894745
The generated pressure mean: 0.4503229260444641
loss_pred:0.14423273503780365, decouple_loss:0.07582000643014908
The generated pressure mean: 0.4500308930873871
loss_pred:0.1446610987186432, decouple_loss:0.07596035301685333
Loss: 0.1488153040409088, avg_mse: 0.26973146200180054
current test mse: 0.269731
Iteration: 651, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44768667221069336
loss_pred:0.03049503266811371, decouple_loss:0.01703161559998989
The generated pressure mean: 0.4486151337623596
loss_pred:0.0273854099214077, decouple_loss:0.01742781512439251
The generated pressure mean: 0.44815492630004883
loss_pred:0.027686424553394318, decouple_loss:0.01756109856069088
Iteration: 652, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45020124316215515
loss_pred:0.02801351062953472, decouple_loss:0.01738986186683178
The generated pressure mean: 0.4487251341342926
loss_pred:0.02789553813636303, decouple_loss:0.018065229058265686
The generated pressure mean: 0.4484240412712097
loss_pred:0.03016452118754387, decouple_loss:0.018033256754279137
Iteration: 653, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44777536392211914
loss_pred:0.030204469338059425, decouple_loss:0.01739400252699852
The generated pressure mean: 0.447848379611969
loss_pred:0.03020513989031315, decouple_loss:0.01654234528541565
The generated pressure mean: 0.4492078125476837
loss_pred:0.02912319265305996, decouple_loss:0.017273306846618652
Iteration: 654, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4482412040233612
loss_pred:0.02873038314282894, decouple_loss:0.01866927742958069
The generated pressure mean: 0.44830939173698425
loss_pred:0.02893783338367939, decouple_loss:0.01780748926103115
The generated pressure mean: 0.4488682150840759
loss_pred:0.029221901670098305, decouple_loss:0.01697673834860325
Iteration: 655, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4479253888130188
The generated pressure mean: 0.4480752646923065
loss_pred:0.028733663260936737, decouple_loss:0.01793365553021431
loss_pred:0.029493659734725952, decouple_loss:0.01876872219145298
The generated pressure mean: 0.4491528868675232
loss_pred:0.03012869320809841, decouple_loss:0.019058262929320335
Iteration: 656, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4491110146045685
loss_pred:0.027854790911078453, decouple_loss:0.01824946701526642
The generated pressure mean: 0.4483609199523926
loss_pred:0.029280031099915504, decouple_loss:0.018979065120220184
The generated pressure mean: 0.44846123456954956
loss_pred:0.030536551028490067, decouple_loss:0.019747301936149597
Iteration: 657, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4481518268585205The generated pressure mean: 0.4486883580684662
loss_pred:0.028156522661447525, decouple_loss:0.019126566126942635
loss_pred:0.028455352410674095, decouple_loss:0.018783695995807648
The generated pressure mean: 0.44846343994140625
loss_pred:0.026851855218410492, decouple_loss:0.018116608262062073
Iteration: 658, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45005375146865845
loss_pred:0.029092656448483467, decouple_loss:0.022199198603630066
The generated pressure mean: 0.4486573040485382
loss_pred:0.028384221717715263, decouple_loss:0.020932678133249283
The generated pressure mean: 0.4494022727012634
loss_pred:0.025912217795848846, decouple_loss:0.019392458721995354
Iteration: 659, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4474080801010132
loss_pred:0.028339248150587082, decouple_loss:0.018907487392425537
The generated pressure mean: 0.44772985577583313
loss_pred:0.028078919276595116, decouple_loss:0.01872524805366993
The generated pressure mean: 0.448699951171875
loss_pred:0.027713190764188766, decouple_loss:0.018017301335930824
Iteration: 660, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44747230410575867
loss_pred:0.02954847551882267, decouple_loss:0.01837722398340702
The generated pressure mean: 0.4483358860015869
loss_pred:0.02953820675611496, decouple_loss:0.017877141013741493
The generated pressure mean: 0.44788697361946106
loss_pred:0.02657369337975979, decouple_loss:0.01890684850513935
2023-04-16 04:02:55 testing...
The generated pressure mean: 0.4502691924571991
loss_pred:0.14721927046775818, decouple_loss:0.07793258875608444
The generated pressure mean: 0.450324684381485
loss_pred:0.1446901559829712, decouple_loss:0.07880858331918716
The generated pressure mean: 0.45002952218055725
loss_pred:0.14543817937374115, decouple_loss:0.07886133342981339
Loss: 0.14970925450325012, avg_mse: 0.2718401253223419
current test mse: 0.27184
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012008_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012008_3_24hr.npz
NaN value num: 0
Iteration: 661, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44827449321746826
loss_pred:0.028080247342586517, decouple_loss:0.01856108009815216
The generated pressure mean: 0.4466727674007416
loss_pred:0.02982819639146328, decouple_loss:0.018410108983516693
The generated pressure mean: 0.44816169142723083
loss_pred:0.028194595128297806, decouple_loss:0.019592387601733208
Iteration: 662, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44690021872520447
loss_pred:0.029885409399867058, decouple_loss:0.019945353269577026
The generated pressure mean: 0.44577789306640625
loss_pred:0.029567183926701546, decouple_loss:0.02001388929784298
The generated pressure mean: 0.4481668770313263
loss_pred:0.02823025919497013, decouple_loss:0.01951325684785843
Iteration: 663, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4470953345298767
loss_pred:0.027984654530882835, decouple_loss:0.017356375232338905
The generated pressure mean: 0.4481372833251953
loss_pred:0.027263490483164787, decouple_loss:0.017039749771356583
The generated pressure mean: 0.447243332862854
loss_pred:0.029017364606261253, decouple_loss:0.01715676486492157
Iteration: 664, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.446244478225708
loss_pred:0.02901338040828705, decouple_loss:0.01788930594921112
The generated pressure mean: 0.44724005460739136
loss_pred:0.02870626002550125, decouple_loss:0.018124355003237724
The generated pressure mean: 0.44663113355636597
loss_pred:0.029753156006336212, decouple_loss:0.018017293885350227
Iteration: 665, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4473147988319397
loss_pred:0.029952432960271835, decouple_loss:0.017581002786755562
The generated pressure mean: 0.4466969668865204
loss_pred:0.029762228950858116, decouple_loss:0.01667795702815056
The generated pressure mean: 0.44833844900131226
loss_pred:0.0283373836427927, decouple_loss:0.01775333844125271
Iteration: 666, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4477030634880066
loss_pred:0.029589597135782242, decouple_loss:0.017166737467050552
The generated pressure mean: 0.44737738370895386
loss_pred:0.028533678501844406, decouple_loss:0.01667170599102974
The generated pressure mean: 0.4473690092563629
loss_pred:0.02910645119845867, decouple_loss:0.01620187796652317
Iteration: 667, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44792065024375916
loss_pred:0.028446635231375694, decouple_loss:0.017358994111418724
The generated pressure mean: 0.4478185176849365
loss_pred:0.02875400334596634, decouple_loss:0.01731828600168228
The generated pressure mean: 0.44902318716049194
loss_pred:0.02768702805042267, decouple_loss:0.017243091017007828
Iteration: 668, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4465702176094055
loss_pred:0.03103865124285221, decouple_loss:0.017767712473869324
The generated pressure mean: 0.4473950266838074
loss_pred:0.029199056327342987, decouple_loss:0.01645771600306034
The generated pressure mean: 0.447454035282135
loss_pred:0.029504045844078064, decouple_loss:0.016134481877088547
Iteration: 669, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44741159677505493
loss_pred:0.02823685295879841, decouple_loss:0.016185445711016655
The generated pressure mean: 0.4466798007488251
loss_pred:0.03028017282485962, decouple_loss:0.016505857929587364
The generated pressure mean: 0.44574904441833496
loss_pred:0.028319349512457848, decouple_loss:0.016460426151752472
Iteration: 670, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4474439024925232
loss_pred:0.02986590750515461, decouple_loss:0.015608695335686207
The generated pressure mean: 0.44718873500823975
loss_pred:0.028838790953159332, decouple_loss:0.015992460772395134
The generated pressure mean: 0.4459506571292877
loss_pred:0.030114954337477684, decouple_loss:0.015732426196336746
2023-04-16 04:05:37 testing...
The generated pressure mean: 0.4502691626548767
loss_pred:0.14715111255645752, decouple_loss:0.07322940975427628
The generated pressure mean: 0.4503231942653656
loss_pred:0.14511896669864655, decouple_loss:0.07410591840744019
The generated pressure mean: 0.4500296711921692
loss_pred:0.14590655267238617, decouple_loss:0.074324831366539
Loss: 0.14975321292877197, avg_mse: 0.27434206008911133
current test mse: 0.274342
Iteration: 671, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44759035110473633
loss_pred:0.02986118756234646, decouple_loss:0.01588197983801365
The generated pressure mean: 0.4476260542869568
loss_pred:0.027079880237579346, decouple_loss:0.015156116336584091
The generated pressure mean: 0.4471970796585083
loss_pred:0.02811252512037754, decouple_loss:0.016049480065703392
Iteration: 672, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44755804538726807
loss_pred:0.028894416987895966, decouple_loss:0.015424484387040138
The generated pressure mean: 0.4469144940376282
loss_pred:0.02894437313079834, decouple_loss:0.015581195242702961
The generated pressure mean: 0.4472907781600952
loss_pred:0.029792388901114464, decouple_loss:0.016105689108371735
Iteration: 673, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4476298689842224
loss_pred:0.02776240184903145, decouple_loss:0.016966072842478752
The generated pressure mean: 0.4472604990005493
loss_pred:0.02788200043141842, decouple_loss:0.016891706734895706
The generated pressure mean: 0.4477250576019287
loss_pred:0.02865530177950859, decouple_loss:0.017932992428541183
Iteration: 674, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4469127655029297
loss_pred:0.029660794883966446, decouple_loss:0.01638207584619522
The generated pressure mean: 0.4472769796848297
loss_pred:0.02938191592693329, decouple_loss:0.016553279012441635
The generated pressure mean: 0.4475235342979431
loss_pred:0.029552169144153595, decouple_loss:0.016181377694010735
Iteration: 675, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.447550505399704
loss_pred:0.027612172067165375, decouple_loss:0.01676654815673828
The generated pressure mean: 0.4471394121646881
loss_pred:0.027103405445814133, decouple_loss:0.01902017742395401
The generated pressure mean: 0.4470888376235962
loss_pred:0.029529493302106857, decouple_loss:0.017954442650079727
Iteration: 676, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44700679183006287
loss_pred:0.02830168418586254, decouple_loss:0.017083700746297836
The generated pressure mean: 0.44757896661758423
loss_pred:0.028109589591622353, decouple_loss:0.017467273399233818
The generated pressure mean: 0.4469399154186249
loss_pred:0.030586140230298042, decouple_loss:0.017494095489382744
Iteration: 677, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44709327816963196
loss_pred:0.02779950015246868, decouple_loss:0.015867603942751884
The generated pressure mean: 0.44668900966644287
loss_pred:0.028790488839149475, decouple_loss:0.01600807160139084
The generated pressure mean: 0.4473555386066437
loss_pred:0.02718786709010601, decouple_loss:0.016388969495892525
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 678, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44851958751678467
The generated pressure mean: 0.4479784071445465
loss_pred:0.028096340596675873, decouple_loss:0.015556146390736103
loss_pred:0.02738182060420513, decouple_loss:0.01522469986230135
The generated pressure mean: 0.4458814561367035
loss_pred:0.028432052582502365, decouple_loss:0.015253078192472458
Iteration: 679, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4473600685596466
loss_pred:0.02894902043044567, decouple_loss:0.016094554215669632
The generated pressure mean: 0.44738665223121643
loss_pred:0.029237858951091766, decouple_loss:0.016079863533377647
The generated pressure mean: 0.44664067029953003
loss_pred:0.027771957218647003, decouple_loss:0.01568521372973919
Iteration: 680, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4470079839229584
loss_pred:0.029375068843364716, decouple_loss:0.016666660085320473
The generated pressure mean: 0.44715335965156555
loss_pred:0.02823450230062008, decouple_loss:0.016458233818411827
The generated pressure mean: 0.44737499952316284
loss_pred:0.028761520981788635, decouple_loss:0.015475286170840263
2023-04-16 04:07:44 testing...
The generated pressure mean: 0.4502691626548767
loss_pred:0.14968611299991608, decouple_loss:0.07231525331735611
The generated pressure mean: 0.45032447576522827
loss_pred:0.1474456787109375, decouple_loss:0.07346192747354507
The generated pressure mean: 0.45003044605255127
loss_pred:0.14771142601966858, decouple_loss:0.0734725072979927
Loss: 0.15193524956703186, avg_mse: 0.27822408080101013
current test mse: 0.278224
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012018_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012018_3_24hr.npz
NaN value num: 0
Iteration: 681, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44935470819473267
loss_pred:0.027645239606499672, decouple_loss:0.0171359870582819
The generated pressure mean: 0.44864240288734436
loss_pred:0.028590267524123192, decouple_loss:0.015217747539281845
The generated pressure mean: 0.44869092106819153
loss_pred:0.029351551085710526, decouple_loss:0.01532366406172514
Iteration: 682, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44886842370033264
loss_pred:0.029060618951916695, decouple_loss:0.01529111247509718
The generated pressure mean: 0.4486882984638214
loss_pred:0.028206100687384605, decouple_loss:0.015596164390444756
The generated pressure mean: 0.44785192608833313
loss_pred:0.027765782549977303, decouple_loss:0.01573823019862175
Iteration: 683, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44852879643440247
loss_pred:0.02829303964972496, decouple_loss:0.015599325299263
The generated pressure mean: 0.4482004642486572
loss_pred:0.028579438105225563, decouple_loss:0.015468264929950237
The generated pressure mean: 0.44834497570991516
loss_pred:0.029184548184275627, decouple_loss:0.015192054212093353
Iteration: 684, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44830891489982605
The generated pressure mean: 0.4486871361732483loss_pred:0.028269348666071892, decouple_loss:0.015180760063230991
loss_pred:0.02824709191918373, decouple_loss:0.016310494393110275
The generated pressure mean: 0.44876399636268616
loss_pred:0.026976721361279488, decouple_loss:0.014931658282876015
Iteration: 685, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4481225609779358
The generated pressure mean: 0.44843509793281555
loss_pred:0.029050782322883606, decouple_loss:0.016309114173054695
loss_pred:0.029101526364684105, decouple_loss:0.015781348571181297
The generated pressure mean: 0.4487071633338928
loss_pred:0.028504429385066032, decouple_loss:0.017765134572982788
Iteration: 686, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4483758211135864
loss_pred:0.028358880430459976, decouple_loss:0.021379880607128143
The generated pressure mean: 0.447772741317749
loss_pred:0.02909569814801216, decouple_loss:0.021100986748933792
The generated pressure mean: 0.4492588937282562
loss_pred:0.02785068191587925, decouple_loss:0.019876202568411827
Iteration: 687, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4479905664920807
loss_pred:0.028450045734643936, decouple_loss:0.017308248206973076
The generated pressure mean: 0.44786280393600464
loss_pred:0.02794424630701542, decouple_loss:0.016787732020020485
The generated pressure mean: 0.44818854331970215
loss_pred:0.02625008299946785, decouple_loss:0.01639370620250702
Iteration: 688, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44863882660865784
loss_pred:0.02835153043270111, decouple_loss:0.02110988274216652
The generated pressure mean: 0.44809213280677795
loss_pred:0.02778945304453373, decouple_loss:0.020174719393253326
The generated pressure mean: 0.44892457127571106
loss_pred:0.02723170816898346, decouple_loss:0.018462246283888817
Iteration: 689, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44857287406921387
loss_pred:0.028792651370167732, decouple_loss:0.01677694171667099
The generated pressure mean: 0.44840747117996216
loss_pred:0.028277719393372536, decouple_loss:0.017282767221331596
The generated pressure mean: 0.449022114276886
loss_pred:0.027359655126929283, decouple_loss:0.01732614077627659
Iteration: 690, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44890227913856506The generated pressure mean: 0.44899043440818787
loss_pred:0.0290046576410532, decouple_loss:0.017571942880749702loss_pred:0.027192117646336555, decouple_loss:0.017468402162194252
The generated pressure mean: 0.44807231426239014
loss_pred:0.028618047013878822, decouple_loss:0.019203897565603256
2023-04-16 04:10:27 testing...
The generated pressure mean: 0.4502691328525543
loss_pred:0.14662975072860718, decouple_loss:0.07468380033969879
The generated pressure mean: 0.45032358169555664
loss_pred:0.14416107535362244, decouple_loss:0.07489713281393051
The generated pressure mean: 0.4500320851802826
loss_pred:0.1446949690580368, decouple_loss:0.07506366074085236
Loss: 0.14890602231025696, avg_mse: 0.2711600661277771
current test mse: 0.27116
Iteration: 691, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44799327850341797
loss_pred:0.028197521343827248, decouple_loss:0.018727466464042664
The generated pressure mean: 0.4484778940677643
loss_pred:0.026992402970790863, decouple_loss:0.019885560497641563
The generated pressure mean: 0.4487997889518738
loss_pred:0.026246391236782074, decouple_loss:0.01837107166647911
Iteration: 692, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44913405179977417
loss_pred:0.02705543488264084, decouple_loss:0.01710708998143673
The generated pressure mean: 0.44973668456077576
loss_pred:0.02802979201078415, decouple_loss:0.01672741211950779
The generated pressure mean: 0.4480894207954407
loss_pred:0.02833544835448265, decouple_loss:0.01602831669151783
Iteration: 693, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44855499267578125
loss_pred:0.02783971279859543, decouple_loss:0.01979900524020195
The generated pressure mean: 0.44811269640922546
The generated pressure mean: 0.44857558608055115
loss_pred:0.028510820120573044, decouple_loss:0.022167706862092018
loss_pred:0.02746186964213848, decouple_loss:0.019601929932832718
Iteration: 694, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.448368638753891
loss_pred:0.02894488535821438, decouple_loss:0.01647919788956642
The generated pressure mean: 0.44837620854377747
loss_pred:0.028139038011431694, decouple_loss:0.017266063019633293
The generated pressure mean: 0.4482868015766144
loss_pred:0.027682753279805183, decouple_loss:0.016533609479665756
Iteration: 695, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44845107197761536
loss_pred:0.02891935035586357, decouple_loss:0.01905566267669201
The generated pressure mean: 0.44769930839538574
loss_pred:0.027988459914922714, decouple_loss:0.01974591426551342
The generated pressure mean: 0.4486371874809265
loss_pred:0.02813015691936016, decouple_loss:0.018819885328412056
Iteration: 696, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44842660427093506
loss_pred:0.028178822249174118, decouple_loss:0.01712666265666485
The generated pressure mean: 0.44807708263397217
loss_pred:0.028008751571178436, decouple_loss:0.01699027046561241
The generated pressure mean: 0.44847917556762695
loss_pred:0.02727407030761242, decouple_loss:0.016836442053318024
Iteration: 697, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44868966937065125
loss_pred:0.028593115508556366, decouple_loss:0.016931911930441856
The generated pressure mean: 0.4482952654361725
loss_pred:0.027374768629670143, decouple_loss:0.018323877826333046
The generated pressure mean: 0.4484916627407074
loss_pred:0.026657721027731895, decouple_loss:0.01858246512711048
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 698, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4490010440349579
loss_pred:0.02632945217192173, decouple_loss:0.020224057137966156
The generated pressure mean: 0.4485235810279846
loss_pred:0.028112240135669708, decouple_loss:0.018567200750112534
The generated pressure mean: 0.44937729835510254
loss_pred:0.02919970080256462, decouple_loss:0.020192822441458702
Iteration: 699, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4482099711894989
loss_pred:0.02843802236020565, decouple_loss:0.01600636914372444
The generated pressure mean: 0.44801977276802063
loss_pred:0.028836047276854515, decouple_loss:0.016381459310650826
The generated pressure mean: 0.44857099652290344
loss_pred:0.027946988120675087, decouple_loss:0.01649276167154312
Iteration: 700, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44828981161117554
loss_pred:0.02687789686024189, decouple_loss:0.01852964237332344
The generated pressure mean: 0.4483574330806732
loss_pred:0.027296816930174828, decouple_loss:0.01936929300427437
The generated pressure mean: 0.44845858216285706
loss_pred:0.027745317667722702, decouple_loss:0.01870931126177311
2023-04-16 04:12:33 testing...
The generated pressure mean: 0.4502691328525543
loss_pred:0.14524467289447784, decouple_loss:0.06820980459451675
The generated pressure mean: 0.4503234326839447
loss_pred:0.14242315292358398, decouple_loss:0.06917950510978699
The generated pressure mean: 0.4500308334827423
loss_pred:0.1431220918893814, decouple_loss:0.06899122148752213
Loss: 0.14703631401062012, avg_mse: 0.2669534981250763
current test mse: 0.266954
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012005_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012005_3_24hr.npz
NaN value num: 0
Iteration: 701, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4480912685394287
loss_pred:0.026936253532767296, decouple_loss:0.017350614070892334
The generated pressure mean: 0.4501647651195526
loss_pred:0.02813740074634552, decouple_loss:0.016306990757584572
The generated pressure mean: 0.45008471608161926
loss_pred:0.026658952236175537, decouple_loss:0.018542040139436722
Iteration: 702, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4506905972957611
loss_pred:0.0278367530554533, decouple_loss:0.02220257744193077
The generated pressure mean: 0.45101994276046753
loss_pred:0.026821373030543327, decouple_loss:0.021257195621728897
The generated pressure mean: 0.4509921967983246
loss_pred:0.026544863358139992, decouple_loss:0.020476726815104485
Iteration: 703, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4505870044231415
loss_pred:0.027212020009756088, decouple_loss:0.018636565655469894
The generated pressure mean: 0.4500150680541992
loss_pred:0.0271113570779562, decouple_loss:0.01761263608932495
The generated pressure mean: 0.4504283666610718
loss_pred:0.029151683673262596, decouple_loss:0.017755944281816483
Iteration: 704, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4499059319496155
loss_pred:0.027494706213474274, decouple_loss:0.02191670797765255
The generated pressure mean: 0.4496496617794037
loss_pred:0.028032323345541954, decouple_loss:0.02099735662341118
The generated pressure mean: 0.4488249123096466
loss_pred:0.028013965114951134, decouple_loss:0.022743256762623787
Iteration: 705, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45085904002189636
loss_pred:0.028252825140953064, decouple_loss:0.0187241118401289
The generated pressure mean: 0.45077916979789734
loss_pred:0.027455205097794533, decouple_loss:0.018079455941915512
The generated pressure mean: 0.4498926103115082
loss_pred:0.027331246063113213, decouple_loss:0.017253685742616653
Iteration: 706, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4502710700035095
The generated pressure mean: 0.44777730107307434
loss_pred:0.0270103607326746, decouple_loss:0.022541265934705734
loss_pred:0.026655584573745728, decouple_loss:0.02172713540494442
The generated pressure mean: 0.44888412952423096
loss_pred:0.027349194511771202, decouple_loss:0.021930288523435593
Iteration: 707, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.449444979429245
loss_pred:0.02945628948509693, decouple_loss:0.019118698313832283
The generated pressure mean: 0.44999390840530396
loss_pred:0.026299355551600456, decouple_loss:0.0191972479224205
The generated pressure mean: 0.4507937729358673
loss_pred:0.027189498767256737, decouple_loss:0.018540795892477036
Iteration: 708, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4493269920349121
loss_pred:0.02643963322043419, decouple_loss:0.02075481042265892
The generated pressure mean: 0.4497261047363281
loss_pred:0.02753082662820816, decouple_loss:0.019989127293229103
The generated pressure mean: 0.4485305845737457
loss_pred:0.02741844579577446, decouple_loss:0.020708255469799042
Iteration: 709, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4507372975349426
loss_pred:0.024353936314582825, decouple_loss:0.021196357905864716
The generated pressure mean: 0.4511128067970276
loss_pred:0.027344249188899994, decouple_loss:0.019464366137981415
The generated pressure mean: 0.4505022466182709
loss_pred:0.02610815316438675, decouple_loss:0.01909816637635231
Iteration: 710, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44781407713890076
loss_pred:0.027375662699341774, decouple_loss:0.020588306710124016
The generated pressure mean: 0.4495762884616852
loss_pred:0.02648225612938404, decouple_loss:0.02025996521115303
The generated pressure mean: 0.44949576258659363
loss_pred:0.028566358610987663, decouple_loss:0.021075407043099403
2023-04-16 04:15:16 testing...
The generated pressure mean: 0.4502691626548767
loss_pred:0.1501859575510025, decouple_loss:0.07634500414133072
The generated pressure mean: 0.45032253861427307
loss_pred:0.14785999059677124, decouple_loss:0.07625163346529007
The generated pressure mean: 0.4500318765640259
loss_pred:0.14850345253944397, decouple_loss:0.07626009732484818
Loss: 0.15266408026218414, avg_mse: 0.27886366844177246
current test mse: 0.278864
Iteration: 711, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4508167803287506
loss_pred:0.02682519517838955, decouple_loss:0.018312739208340645
The generated pressure mean: 0.449484258890152
loss_pred:0.028675436973571777, decouple_loss:0.018230045214295387
The generated pressure mean: 0.4491961896419525
loss_pred:0.028026709333062172, decouple_loss:0.018993550911545753
Iteration: 712, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45134490728378296
loss_pred:0.027139488607645035, decouple_loss:0.026262300089001656
The generated pressure mean: 0.45048457384109497
loss_pred:0.02545919641852379, decouple_loss:0.02502947673201561
The generated pressure mean: 0.45116832852363586
loss_pred:0.02702336758375168, decouple_loss:0.023895131424069405
Iteration: 713, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4489419162273407
loss_pred:0.027401505038142204, decouple_loss:0.02250473015010357
The generated pressure mean: 0.4502711296081543
loss_pred:0.027749747037887573, decouple_loss:0.022708095610141754
The generated pressure mean: 0.44831061363220215
loss_pred:0.03008330799639225, decouple_loss:0.022805677726864815
Iteration: 714, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45085608959198
loss_pred:0.02793097123503685, decouple_loss:0.022111032158136368
The generated pressure mean: 0.45022690296173096
loss_pred:0.02821001224219799, decouple_loss:0.02238456904888153
The generated pressure mean: 0.4490254819393158
loss_pred:0.02621365897357464, decouple_loss:0.021448293700814247
Iteration: 715, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4506426751613617
loss_pred:0.028371989727020264, decouple_loss:0.02131752483546734
The generated pressure mean: 0.45001915097236633
loss_pred:0.02843087911605835, decouple_loss:0.02020900510251522
The generated pressure mean: 0.44898560643196106
loss_pred:0.028462547808885574, decouple_loss:0.020821813493967056
Iteration: 716, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4493444859981537
loss_pred:0.029821649193763733, decouple_loss:0.019130777567625046
The generated pressure mean: 0.4511543810367584
loss_pred:0.025589728727936745, decouple_loss:0.01935392990708351
The generated pressure mean: 0.44810259342193604
loss_pred:0.02736309915781021, decouple_loss:0.019063254818320274
Iteration: 717, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4495777189731598
loss_pred:0.028452862054109573, decouple_loss:0.020088762044906616
The generated pressure mean: 0.4509161710739136
loss_pred:0.02605527639389038, decouple_loss:0.021401938050985336
The generated pressure mean: 0.4496290385723114
loss_pred:0.02684987522661686, decouple_loss:0.023076340556144714
Iteration: 718, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4498012363910675
loss_pred:0.027427170425653458, decouple_loss:0.01889514923095703
The generated pressure mean: 0.44950762391090393
loss_pred:0.028473740443587303, decouple_loss:0.01913612335920334
The generated pressure mean: 0.4510124623775482
loss_pred:0.028558136895298958, decouple_loss:0.01964772865176201
Iteration: 719, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44958409667015076
loss_pred:0.027687693014740944, decouple_loss:0.02025209553539753
The generated pressure mean: 0.44997936487197876
loss_pred:0.0301677156239748, decouple_loss:0.021570928394794464
The generated pressure mean: 0.44999027252197266
loss_pred:0.027154218405485153, decouple_loss:0.02079889178276062
Iteration: 720, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44845327734947205
The generated pressure mean: 0.45013561844825745
loss_pred:0.02868400327861309, decouple_loss:0.019337976351380348
loss_pred:0.028137944638729095, decouple_loss:0.018908614292740822
The generated pressure mean: 0.4496792256832123
loss_pred:0.028464743867516518, decouple_loss:0.018126551061868668
2023-04-16 04:17:21 testing...
The generated pressure mean: 0.4502691626548767
loss_pred:0.13919803500175476, decouple_loss:0.06828716397285461
The generated pressure mean: 0.4503243565559387
loss_pred:0.13683021068572998, decouple_loss:0.06902521103620529
The generated pressure mean: 0.4500292241573334
loss_pred:0.13742978870868683, decouple_loss:0.069098562002182
Loss: 0.14125953614711761, avg_mse: 0.2547256052494049
current test mse: 0.254726
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012009_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012009_3_24hr.npz
NaN value num: 0
Iteration: 721, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4467286467552185
loss_pred:0.027899326756596565, decouple_loss:0.021948879584670067
The generated pressure mean: 0.44672897458076477
loss_pred:0.028147093951702118, decouple_loss:0.021172966808080673
The generated pressure mean: 0.450006902217865
loss_pred:0.02845068648457527, decouple_loss:0.021791569888591766
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 722, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44893956184387207
The generated pressure mean: 0.44918784499168396
The generated pressure mean: 0.4489677846431732
loss_pred:0.028453035280108452, decouple_loss:0.020088834688067436
loss_pred:0.027622472494840622, decouple_loss:0.022209113463759422
loss_pred:0.02867591381072998, decouple_loss:0.021066788583993912
Iteration: 723, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44800639152526855
loss_pred:0.028895555064082146, decouple_loss:0.0218153428286314
The generated pressure mean: 0.4484158158302307
loss_pred:0.027146121487021446, decouple_loss:0.022133849561214447
The generated pressure mean: 0.4468095898628235
loss_pred:0.02879839390516281, decouple_loss:0.0220984797924757
Iteration: 724, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44771289825439453
loss_pred:0.027312790974974632, decouple_loss:0.02176888845860958
The generated pressure mean: 0.4469982981681824
loss_pred:0.028280900791287422, decouple_loss:0.02108907513320446
The generated pressure mean: 0.44765588641166687
loss_pred:0.029004322364926338, decouple_loss:0.022233303636312485
Iteration: 725, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4473818242549896
loss_pred:0.02983989007771015, decouple_loss:0.02032729610800743
The generated pressure mean: 0.4475550055503845
loss_pred:0.028265513479709625, decouple_loss:0.021787505596876144
The generated pressure mean: 0.4481034278869629
loss_pred:0.027531741186976433, decouple_loss:0.020814169198274612
Iteration: 726, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44889402389526367
loss_pred:0.028005758300423622, decouple_loss:0.02195475809276104
The generated pressure mean: 0.44746100902557373
loss_pred:0.027851255610585213, decouple_loss:0.02159665711224079
The generated pressure mean: 0.4488844573497772
loss_pred:0.028629841282963753, decouple_loss:0.021812990307807922
Iteration: 727, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44818058609962463
loss_pred:0.029111741110682487, decouple_loss:0.01956368237733841
The generated pressure mean: 0.4504036009311676
loss_pred:0.028310474008321762, decouple_loss:0.01991175301373005
The generated pressure mean: 0.44737040996551514
loss_pred:0.02817544899880886, decouple_loss:0.01869386062026024
Iteration: 728, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4471915662288666
loss_pred:0.027780529111623764, decouple_loss:0.018751027062535286
The generated pressure mean: 0.4483911395072937
loss_pred:0.028445696458220482, decouple_loss:0.018433380872011185
The generated pressure mean: 0.44789740443229675
loss_pred:0.027609040960669518, decouple_loss:0.018635708838701248
Iteration: 729, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.449093759059906
loss_pred:0.028485825285315514, decouple_loss:0.01846071518957615
The generated pressure mean: 0.44770094752311707
loss_pred:0.029051464051008224, decouple_loss:0.018254177644848824
The generated pressure mean: 0.4475528299808502
loss_pred:0.028403127565979958, decouple_loss:0.018233133479952812
Iteration: 730, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44616132974624634
loss_pred:0.030009912326931953, decouple_loss:0.017517972737550735
The generated pressure mean: 0.4479876160621643
loss_pred:0.028133317828178406, decouple_loss:0.016537444666028023
The generated pressure mean: 0.4481077790260315
loss_pred:0.02879687212407589, decouple_loss:0.016753384843468666
2023-04-16 04:20:07 testing...
The generated pressure mean: 0.4502691924571991
loss_pred:0.14630238711833954, decouple_loss:0.0698627308011055
The generated pressure mean: 0.45032331347465515
loss_pred:0.1434721052646637, decouple_loss:0.07108958065509796
The generated pressure mean: 0.45003122091293335
loss_pred:0.14407236874103546, decouple_loss:0.07062969356775284
Loss: 0.1481419801712036, avg_mse: 0.26864469051361084
current test mse: 0.268645
Iteration: 731, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.448606938123703
loss_pred:0.030416589230298996, decouple_loss:0.017638012766838074
The generated pressure mean: 0.44786226749420166
loss_pred:0.028023002669215202, decouple_loss:0.017351917922496796
The generated pressure mean: 0.4486052989959717
loss_pred:0.029711997136473656, decouple_loss:0.01706322468817234
Iteration: 732, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44750240445137024
loss_pred:0.027334406971931458, decouple_loss:0.016216492280364037
The generated pressure mean: 0.448355108499527
The generated pressure mean: 0.4499625563621521
loss_pred:0.02843037061393261, decouple_loss:0.016042562201619148
loss_pred:0.028110256418585777, decouple_loss:0.0162897277623415
Iteration: 733, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4477400779724121
loss_pred:0.02973219007253647, decouple_loss:0.01643504947423935
The generated pressure mean: 0.44777074456214905
loss_pred:0.028194425627589226, decouple_loss:0.01686090975999832
The generated pressure mean: 0.44793516397476196
loss_pred:0.029138443991541862, decouple_loss:0.016041409224271774
Iteration: 734, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44666117429733276
loss_pred:0.029643189162015915, decouple_loss:0.01704404316842556
The generated pressure mean: 0.44842034578323364
loss_pred:0.0273726899176836, decouple_loss:0.016309844329953194
The generated pressure mean: 0.44830942153930664
loss_pred:0.02870570868253708, decouple_loss:0.016714967787265778
Iteration: 735, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44936874508857727
loss_pred:0.028483498841524124, decouple_loss:0.017329389229416847
The generated pressure mean: 0.44908756017684937
loss_pred:0.027786869555711746, decouple_loss:0.016966264694929123
The generated pressure mean: 0.4481879770755768
loss_pred:0.028733516111969948, decouple_loss:0.01658746786415577
Iteration: 736, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.446720689535141
loss_pred:0.029941419139504433, decouple_loss:0.016449851915240288
The generated pressure mean: 0.44927769899368286
loss_pred:0.028243275359272957, decouple_loss:0.017303921282291412
The generated pressure mean: 0.4483684003353119
loss_pred:0.026624014601111412, decouple_loss:0.01675456017255783
Iteration: 737, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44796690344810486
loss_pred:0.02773447521030903, decouple_loss:0.017152896150946617
The generated pressure mean: 0.4460597336292267
loss_pred:0.028741423040628433, decouple_loss:0.01756305806338787
The generated pressure mean: 0.4481782913208008
loss_pred:0.026905149221420288, decouple_loss:0.016805142164230347
Iteration: 738, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4474083185195923
loss_pred:0.029517199844121933, decouple_loss:0.01698629930615425
The generated pressure mean: 0.4491211771965027
loss_pred:0.02840987965464592, decouple_loss:0.018613450229167938
The generated pressure mean: 0.44967207312583923
loss_pred:0.02702631801366806, decouple_loss:0.016776060685515404
Iteration: 739, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44785043597221375
loss_pred:0.02688787877559662, decouple_loss:0.01696876436471939
The generated pressure mean: 0.44806912541389465
loss_pred:0.026373237371444702, decouple_loss:0.01759479008615017
The generated pressure mean: 0.4487839937210083
loss_pred:0.026195837184786797, decouple_loss:0.01635991781949997
Iteration: 740, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44988128542900085
loss_pred:0.028263794258236885, decouple_loss:0.01663317158818245
The generated pressure mean: 0.4482463300228119
loss_pred:0.02818041853606701, decouple_loss:0.016498859971761703
The generated pressure mean: 0.448591947555542
loss_pred:0.027873193845152855, decouple_loss:0.016780944541096687
2023-04-16 04:22:13 testing...
The generated pressure mean: 0.4502691626548767
loss_pred:0.14876069128513336, decouple_loss:0.07307305932044983
The generated pressure mean: 0.45032358169555664
loss_pred:0.1463756561279297, decouple_loss:0.0739193931221962
The generated pressure mean: 0.4500297009944916
loss_pred:0.14738085865974426, decouple_loss:0.0734221488237381
Loss: 0.15117931365966797, avg_mse: 0.2794830799102783
current test mse: 0.279483
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012018_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012018_3_24hr.npz
NaN value num: 0
Iteration: 741, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4489687383174896
loss_pred:0.027953047305345535, decouple_loss:0.018586305901408195
The generated pressure mean: 0.4484189748764038
loss_pred:0.028000928461551666, decouple_loss:0.01728258654475212
The generated pressure mean: 0.4493662714958191
loss_pred:0.029860148206353188, decouple_loss:0.01863996684551239
Iteration: 742, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4512658417224884
loss_pred:0.029589667916297913, decouple_loss:0.01886364258825779
The generated pressure mean: 0.4504023492336273
loss_pred:0.028398629277944565, decouple_loss:0.016954155638813972
The generated pressure mean: 0.4501371681690216
loss_pred:0.02671351470053196, decouple_loss:0.018254362046718597
Iteration: 743, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4493294954299927
loss_pred:0.02758343517780304, decouple_loss:0.016978085041046143
The generated pressure mean: 0.4495818316936493
The generated pressure mean: 0.44967398047447205
loss_pred:0.029452232643961906, decouple_loss:0.017500678077340126
loss_pred:0.028134508058428764, decouple_loss:0.017110124230384827
Iteration: 744, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4498130679130554
loss_pred:0.02711346372961998, decouple_loss:0.016484731808304787
The generated pressure mean: 0.4485822319984436
loss_pred:0.031047534197568893, decouple_loss:0.01705816201865673
The generated pressure mean: 0.4506400227546692
loss_pred:0.02887778729200363, decouple_loss:0.017494212836027145
Iteration: 745, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4488057494163513
The generated pressure mean: 0.4486687481403351loss_pred:0.030651835724711418, decouple_loss:0.016704373061656952
loss_pred:0.02988365851342678, decouple_loss:0.016806622967123985
The generated pressure mean: 0.4494484066963196
loss_pred:0.028370868414640427, decouple_loss:0.017253044992685318
Iteration: 746, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44985583424568176
The generated pressure mean: 0.44973617792129517
loss_pred:0.0289306677877903, decouple_loss:0.01736181601881981
loss_pred:0.03031344525516033, decouple_loss:0.018085399642586708
The generated pressure mean: 0.45163264870643616
loss_pred:0.028180385008454323, decouple_loss:0.017554350197315216
Iteration: 747, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44910165667533875
loss_pred:0.027539193630218506, decouple_loss:0.01864977739751339
The generated pressure mean: 0.4493672549724579
loss_pred:0.02861754223704338, decouple_loss:0.017871487885713577
The generated pressure mean: 0.4495862126350403
loss_pred:0.028222065418958664, decouple_loss:0.017012231051921844
Iteration: 748, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45005881786346436
The generated pressure mean: 0.45000776648521423
loss_pred:0.02768954634666443, decouple_loss:0.018445365130901337
loss_pred:0.027907146140933037, decouple_loss:0.017065074294805527
The generated pressure mean: 0.4485172927379608
loss_pred:0.028201216831803322, decouple_loss:0.016921471804380417
Iteration: 749, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44986990094184875
loss_pred:0.028578780591487885, decouple_loss:0.019423943012952805
The generated pressure mean: 0.4504033923149109
loss_pred:0.028599588200449944, decouple_loss:0.01813396066427231
The generated pressure mean: 0.44979166984558105
loss_pred:0.02859746478497982, decouple_loss:0.01853613369166851
Iteration: 750, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44853922724723816
loss_pred:0.027318870648741722, decouple_loss:0.017434727400541306
The generated pressure mean: 0.4489183723926544
loss_pred:0.027740320190787315, decouple_loss:0.018080128356814384
The generated pressure mean: 0.44919344782829285
loss_pred:0.028487244620919228, decouple_loss:0.017883213236927986
2023-04-16 04:25:00 testing...
The generated pressure mean: 0.4502691328525543
loss_pred:0.14953871071338654, decouple_loss:0.07475175708532333
The generated pressure mean: 0.4503207504749298
loss_pred:0.1461992859840393, decouple_loss:0.07517290860414505
The generated pressure mean: 0.4500318765640259
loss_pred:0.14736756682395935, decouple_loss:0.07464151084423065
Loss: 0.15144461393356323, avg_mse: 0.2770061194896698
current test mse: 0.277006
Iteration: 751, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44960880279541016
loss_pred:0.02720579318702221, decouple_loss:0.018409566953778267
The generated pressure mean: 0.44957712292671204
The generated pressure mean: 0.44906556606292725
loss_pred:0.027667079120874405, decouple_loss:0.018766675144433975
loss_pred:0.028886903077363968, decouple_loss:0.018515553325414658
Iteration: 752, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44884803891181946
loss_pred:0.029016006737947464, decouple_loss:0.01706676185131073
The generated pressure mean: 0.45002374053001404
loss_pred:0.02808164618909359, decouple_loss:0.019468314945697784
The generated pressure mean: 0.45068493485450745
loss_pred:0.028578437864780426, decouple_loss:0.016601817682385445
Iteration: 753, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4495057761669159The generated pressure mean: 0.4490891993045807
loss_pred:0.028128350153565407, decouple_loss:0.017208551988005638
loss_pred:0.02886323072016239, decouple_loss:0.016767116263508797
The generated pressure mean: 0.44844070076942444
loss_pred:0.027984503656625748, decouple_loss:0.01760260947048664
Iteration: 754, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4481346309185028
The generated pressure mean: 0.4504972994327545loss_pred:0.02876892127096653, decouple_loss:0.016365187242627144
loss_pred:0.028635621070861816, decouple_loss:0.016891557723283768
The generated pressure mean: 0.44926461577415466
loss_pred:0.028086436912417412, decouple_loss:0.016827473416924477
Iteration: 755, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45019078254699707
loss_pred:0.028262000530958176, decouple_loss:0.016519349068403244
The generated pressure mean: 0.4498828649520874
loss_pred:0.027550991624593735, decouple_loss:0.015360052697360516
The generated pressure mean: 0.4494318962097168
loss_pred:0.028069674968719482, decouple_loss:0.016047418117523193
Iteration: 756, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45010870695114136
The generated pressure mean: 0.4494739770889282
loss_pred:0.02630942314863205, decouple_loss:0.016986699774861336
loss_pred:0.027150053530931473, decouple_loss:0.01773824729025364
The generated pressure mean: 0.449194997549057
loss_pred:0.029742199927568436, decouple_loss:0.0159029271453619
Iteration: 757, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.450023889541626
The generated pressure mean: 0.44838398694992065
loss_pred:0.027672188356518745, decouple_loss:0.01593014784157276
loss_pred:0.02665688656270504, decouple_loss:0.016230802983045578
The generated pressure mean: 0.4496449828147888
loss_pred:0.027057243511080742, decouple_loss:0.015928376466035843
Iteration: 758, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44880691170692444The generated pressure mean: 0.4484512209892273
loss_pred:0.028484832495450974, decouple_loss:0.016518505290150642loss_pred:0.02737748995423317, decouple_loss:0.014898006804287434
The generated pressure mean: 0.4501277506351471
loss_pred:0.02640298567712307, decouple_loss:0.015728216618299484
Iteration: 759, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44910693168640137
loss_pred:0.02933703549206257, decouple_loss:0.016436487436294556
The generated pressure mean: 0.44995343685150146
loss_pred:0.027408381924033165, decouple_loss:0.017675751820206642
The generated pressure mean: 0.44908827543258667
loss_pred:0.0276922769844532, decouple_loss:0.016801901161670685
Iteration: 760, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44849851727485657
loss_pred:0.026867907494306564, decouple_loss:0.01649247109889984
The generated pressure mean: 0.45061373710632324
loss_pred:0.030115850269794464, decouple_loss:0.01637267880141735
The generated pressure mean: 0.4486018419265747
loss_pred:0.028031837195158005, decouple_loss:0.015211200341582298
2023-04-16 04:27:05 testing...
The generated pressure mean: 0.4502691626548767
loss_pred:0.14744654297828674, decouple_loss:0.0749514177441597
The generated pressure mean: 0.4500296711921692
loss_pred:0.1454627513885498, decouple_loss:0.07567440718412399
The generated pressure mean: 0.45032668113708496
loss_pred:0.14468643069267273, decouple_loss:0.07559678703546524
Loss: 0.14963561296463013, avg_mse: 0.2750913202762604
current test mse: 0.275091
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012007_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012007_3_24hr.npz
NaN value num: 0
Iteration: 761, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4476288855075836
loss_pred:0.02750333957374096, decouple_loss:0.019141187891364098
The generated pressure mean: 0.4472196102142334
loss_pred:0.026082033291459084, decouple_loss:0.01822218857705593
The generated pressure mean: 0.44860899448394775
loss_pred:0.02611784264445305, decouple_loss:0.01861712522804737
Iteration: 762, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4464570879936218
The generated pressure mean: 0.44879254698753357
loss_pred:0.026605691760778427, decouple_loss:0.015902826562523842
loss_pred:0.02649269439280033, decouple_loss:0.017381882295012474
The generated pressure mean: 0.44850805401802063
loss_pred:0.02816128544509411, decouple_loss:0.01587367057800293
Iteration: 763, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4474615156650543
The generated pressure mean: 0.4491131603717804
loss_pred:0.027613798156380653, decouple_loss:0.016552520915865898
loss_pred:0.02741297148168087, decouple_loss:0.017239678651094437
The generated pressure mean: 0.44900399446487427
loss_pred:0.02725202962756157, decouple_loss:0.01641284115612507
Iteration: 764, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4478263854980469
loss_pred:0.027823925018310547, decouple_loss:0.01670011691749096
The generated pressure mean: 0.44671696424484253
loss_pred:0.02694605104625225, decouple_loss:0.01631593331694603
The generated pressure mean: 0.45073604583740234
loss_pred:0.02566404640674591, decouple_loss:0.015751168131828308
Iteration: 765, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44757863879203796
loss_pred:0.02588200382888317, decouple_loss:0.01624949648976326
The generated pressure mean: 0.44815054535865784
loss_pred:0.02646157331764698, decouple_loss:0.015725234523415565
The generated pressure mean: 0.449614942073822
loss_pred:0.026308797299861908, decouple_loss:0.015366110019385815
Iteration: 766, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4476444125175476
loss_pred:0.027172653004527092, decouple_loss:0.01461595669388771
The generated pressure mean: 0.44698813557624817
loss_pred:0.02605537325143814, decouple_loss:0.015145978890359402
The generated pressure mean: 0.4483582079410553
loss_pred:0.027202587574720383, decouple_loss:0.015057366341352463
Iteration: 767, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4493887722492218
loss_pred:0.026252351701259613, decouple_loss:0.016332048922777176
The generated pressure mean: 0.4491381049156189
loss_pred:0.026844406500458717, decouple_loss:0.015682486817240715
The generated pressure mean: 0.44797784090042114
loss_pred:0.026247277855873108, decouple_loss:0.016110174357891083
Iteration: 768, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44981658458709717
loss_pred:0.025531193241477013, decouple_loss:0.016771074384450912
The generated pressure mean: 0.44896820187568665
loss_pred:0.0284446831792593, decouple_loss:0.01682274229824543
The generated pressure mean: 0.4485766589641571
loss_pred:0.026363391429185867, decouple_loss:0.017154861241579056
Iteration: 769, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44810885190963745
loss_pred:0.030839962884783745, decouple_loss:0.01657073199748993
The generated pressure mean: 0.4488149583339691
loss_pred:0.027529766783118248, decouple_loss:0.016666850075125694
The generated pressure mean: 0.4486986994743347
loss_pred:0.027518155053257942, decouple_loss:0.015674004331231117
Iteration: 770, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4472033679485321
The generated pressure mean: 0.4477058947086334loss_pred:0.028446123003959656, decouple_loss:0.016728200018405914
loss_pred:0.026780692860484123, decouple_loss:0.017072973772883415
The generated pressure mean: 0.44893643260002136
loss_pred:0.026934368535876274, decouple_loss:0.016577251255512238
2023-04-16 04:29:44 testing...
The generated pressure mean: 0.4502691626548767
loss_pred:0.1470394879579544, decouple_loss:0.07068494707345963
The generated pressure mean: 0.4503251910209656
loss_pred:0.14428718388080597, decouple_loss:0.071964330971241
The generated pressure mean: 0.450030654668808
loss_pred:0.1450066864490509, decouple_loss:0.07147113233804703
Loss: 0.14901313185691833, avg_mse: 0.2768760919570923
current test mse: 0.276876
Iteration: 771, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4485655725002289
The generated pressure mean: 0.448662668466568
loss_pred:0.026064926758408546, decouple_loss:0.014929898083209991
loss_pred:0.026944877579808235, decouple_loss:0.01511145569384098
The generated pressure mean: 0.4494931399822235
loss_pred:0.02595445141196251, decouple_loss:0.01596875675022602
Iteration: 772, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44748908281326294
loss_pred:0.027319839224219322, decouple_loss:0.01540100947022438
The generated pressure mean: 0.4481640160083771
loss_pred:0.027608860284090042, decouple_loss:0.014543682336807251
The generated pressure mean: 0.44890302419662476
loss_pred:0.025817302986979485, decouple_loss:0.014656520448625088
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 773, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4490967392921448The generated pressure mean: 0.45066165924072266
loss_pred:0.026602668687701225, decouple_loss:0.01441399846225977
loss_pred:0.02581930160522461, decouple_loss:0.01525033451616764
The generated pressure mean: 0.4483413100242615
loss_pred:0.026759270578622818, decouple_loss:0.01565878465771675
Iteration: 774, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44829225540161133
loss_pred:0.02653665840625763, decouple_loss:0.01433993224054575
The generated pressure mean: 0.450017511844635
loss_pred:0.02582704834640026, decouple_loss:0.01406070590019226
The generated pressure mean: 0.44742920994758606
loss_pred:0.026690704748034477, decouple_loss:0.014332636259496212
Iteration: 775, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4484112858772278
loss_pred:0.027768610045313835, decouple_loss:0.014628431759774685
The generated pressure mean: 0.45012977719306946
loss_pred:0.026149021461606026, decouple_loss:0.013948891311883926
The generated pressure mean: 0.44882166385650635
loss_pred:0.026309866458177567, decouple_loss:0.014361835084855556
Iteration: 776, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44878917932510376
loss_pred:0.026289429515600204, decouple_loss:0.013943711295723915
The generated pressure mean: 0.44852501153945923
loss_pred:0.024765074253082275, decouple_loss:0.013942762278020382
The generated pressure mean: 0.44735562801361084
loss_pred:0.029224367812275887, decouple_loss:0.01487110648304224
Iteration: 777, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44760221242904663
The generated pressure mean: 0.44881337881088257
loss_pred:0.02592260204255581, decouple_loss:0.013629595749080181
loss_pred:0.02633359469473362, decouple_loss:0.014211106114089489
The generated pressure mean: 0.44828394055366516
loss_pred:0.027378203347325325, decouple_loss:0.014012026600539684
Iteration: 778, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4482496976852417
loss_pred:0.026925893500447273, decouple_loss:0.013126526027917862
The generated pressure mean: 0.4467513859272003
loss_pred:0.026113446801900864, decouple_loss:0.01349026057869196
The generated pressure mean: 0.44864705204963684
loss_pred:0.027123043313622475, decouple_loss:0.015089474618434906
Iteration: 779, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4482021629810333
loss_pred:0.02658567950129509, decouple_loss:0.014987330883741379
The generated pressure mean: 0.4502754807472229
loss_pred:0.025332460179924965, decouple_loss:0.013836520723998547
The generated pressure mean: 0.44740262627601624
loss_pred:0.025648800656199455, decouple_loss:0.014269975014030933
Iteration: 780, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4497593343257904
loss_pred:0.02479770965874195, decouple_loss:0.013083511032164097
The generated pressure mean: 0.4477382302284241
loss_pred:0.026728559285402298, decouple_loss:0.013489111326634884
The generated pressure mean: 0.4479959011077881
loss_pred:0.025991328060626984, decouple_loss:0.013311612419784069
2023-04-16 04:31:49 testing...
The generated pressure mean: 0.4502691626548767
loss_pred:0.1465645432472229, decouple_loss:0.06858919560909271
The generated pressure mean: 0.45032235980033875
loss_pred:0.1439371109008789, decouple_loss:0.06950073689222336
The generated pressure mean: 0.45002979040145874
loss_pred:0.1446063369512558, decouple_loss:0.06918465346097946
Loss: 0.14849057793617249, avg_mse: 0.27578040957450867
current test mse: 0.27578
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012009_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012009_3_24hr.npz
NaN value num: 0
Iteration: 781, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44896137714385986
loss_pred:0.02798496000468731, decouple_loss:0.015850530937314034
The generated pressure mean: 0.44923070073127747
loss_pred:0.026631049811840057, decouple_loss:0.01624228246510029
The generated pressure mean: 0.448682963848114
loss_pred:0.02684842236340046, decouple_loss:0.01580989733338356
Iteration: 782, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4483020007610321
loss_pred:0.025815078988671303, decouple_loss:0.01555428933352232
The generated pressure mean: 0.4494169056415558
loss_pred:0.025352733209729195, decouple_loss:0.014027846045792103
The generated pressure mean: 0.4494026005268097
loss_pred:0.02698262594640255, decouple_loss:0.015661444514989853
Iteration: 783, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45009753108024597The generated pressure mean: 0.4493301808834076
loss_pred:0.02684899978339672, decouple_loss:0.014886345714330673
loss_pred:0.02953685075044632, decouple_loss:0.01474012155085802
The generated pressure mean: 0.45001667737960815
loss_pred:0.027831288054585457, decouple_loss:0.01490881945937872
Iteration: 784, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45004671812057495
loss_pred:0.02648310363292694, decouple_loss:0.014471585862338543
The generated pressure mean: 0.45036372542381287
loss_pred:0.026800544932484627, decouple_loss:0.014237307012081146
The generated pressure mean: 0.4494536519050598
loss_pred:0.027013247832655907, decouple_loss:0.014372209087014198
Iteration: 785, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.450726717710495
loss_pred:0.027347363531589508, decouple_loss:0.015613044612109661
The generated pressure mean: 0.44830042123794556
loss_pred:0.027217069640755653, decouple_loss:0.015387995168566704
The generated pressure mean: 0.4489738941192627
loss_pred:0.026246408000588417, decouple_loss:0.015054505318403244
Iteration: 786, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44795966148376465
loss_pred:0.028818786144256592, decouple_loss:0.016713019460439682
The generated pressure mean: 0.4486842751502991
loss_pred:0.02627449296414852, decouple_loss:0.014354254119098186
The generated pressure mean: 0.44970598816871643
loss_pred:0.027562007308006287, decouple_loss:0.015920789912343025
Iteration: 787, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44719576835632324
loss_pred:0.02715926617383957, decouple_loss:0.014260836876928806
The generated pressure mean: 0.44867023825645447
loss_pred:0.02600868232548237, decouple_loss:0.01473915483802557
The generated pressure mean: 0.4470632076263428
loss_pred:0.027362575754523277, decouple_loss:0.0145042035728693
Iteration: 788, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4485406279563904
loss_pred:0.02683594636619091, decouple_loss:0.017729612067341805
The generated pressure mean: 0.4487278163433075
loss_pred:0.025816209614276886, decouple_loss:0.016509421169757843
The generated pressure mean: 0.4507753849029541
loss_pred:0.02719077095389366, decouple_loss:0.01620422676205635
Iteration: 789, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45055556297302246
The generated pressure mean: 0.45098158717155457
loss_pred:0.025820400565862656, decouple_loss:0.016242658719420433
loss_pred:0.026236237958073616, decouple_loss:0.014889081008732319
The generated pressure mean: 0.4484424293041229
loss_pred:0.02633604407310486, decouple_loss:0.01593712344765663
Iteration: 790, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44973623752593994
loss_pred:0.027095749974250793, decouple_loss:0.01507666427642107
The generated pressure mean: 0.4504775106906891
loss_pred:0.027267809957265854, decouple_loss:0.014937308616936207
The generated pressure mean: 0.4499729573726654
loss_pred:0.026330918073654175, decouple_loss:0.01442741509526968
2023-04-16 04:34:37 testing...
The generated pressure mean: 0.4502691924571991
loss_pred:0.1463121771812439, decouple_loss:0.06883739680051804
The generated pressure mean: 0.45003220438957214
loss_pred:0.14478753507137299, decouple_loss:0.06933464109897614
The generated pressure mean: 0.4503205418586731
loss_pred:0.14398124814033508, decouple_loss:0.06976605206727982
Loss: 0.14849261939525604, avg_mse: 0.2737692594528198
current test mse: 0.273769
Iteration: 791, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44821321964263916
loss_pred:0.02516232244670391, decouple_loss:0.0144383879378438
The generated pressure mean: 0.44984790682792664
loss_pred:0.02585793286561966, decouple_loss:0.015224087052047253
The generated pressure mean: 0.44905519485473633
loss_pred:0.027015946805477142, decouple_loss:0.015231032855808735
Iteration: 792, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44846805930137634The generated pressure mean: 0.4499618411064148
The generated pressure mean: 0.44903653860092163
loss_pred:0.029194025322794914, decouple_loss:0.01599702425301075
loss_pred:0.027148736640810966, decouple_loss:0.01447375863790512
loss_pred:0.026669632643461227, decouple_loss:0.015490437857806683
Iteration: 793, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4492729902267456
loss_pred:0.026187868788838387, decouple_loss:0.014995363540947437
The generated pressure mean: 0.4496529698371887
loss_pred:0.027214564383029938, decouple_loss:0.015577448531985283
The generated pressure mean: 0.44846034049987793
loss_pred:0.026143833994865417, decouple_loss:0.014787942171096802
Iteration: 794, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44912195205688477
The generated pressure mean: 0.45032063126564026
loss_pred:0.027126576751470566, decouple_loss:0.01624201610684395
loss_pred:0.02736731246113777, decouple_loss:0.015982361510396004
The generated pressure mean: 0.44932135939598083
loss_pred:0.026913218200206757, decouple_loss:0.0159932691603899
Iteration: 795, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4478188455104828
loss_pred:0.026760827749967575, decouple_loss:0.015495889820158482
The generated pressure mean: 0.44959312677383423
loss_pred:0.027285171672701836, decouple_loss:0.016485033556818962
The generated pressure mean: 0.44815003871917725
loss_pred:0.026770861819386482, decouple_loss:0.01642812415957451
Iteration: 796, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4493822455406189
loss_pred:0.028232064098119736, decouple_loss:0.016400905326008797
The generated pressure mean: 0.4495513439178467
loss_pred:0.02792890928685665, decouple_loss:0.016088340431451797
The generated pressure mean: 0.4496927559375763
loss_pred:0.02800173871219158, decouple_loss:0.01701158843934536
Iteration: 797, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45072484016418457The generated pressure mean: 0.4499340057373047
loss_pred:0.028160881251096725, decouple_loss:0.016010086983442307
loss_pred:0.02780730649828911, decouple_loss:0.015646280720829964
The generated pressure mean: 0.44913408160209656
loss_pred:0.0280314888805151, decouple_loss:0.015713028609752655
Iteration: 798, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.449931800365448
The generated pressure mean: 0.4501548707485199
loss_pred:0.026807518675923347, decouple_loss:0.017374416813254356
loss_pred:0.02762819454073906, decouple_loss:0.01667044684290886
The generated pressure mean: 0.44870954751968384
loss_pred:0.02744021825492382, decouple_loss:0.0168087687343359
Iteration: 799, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44968274235725403
loss_pred:0.0277858916670084, decouple_loss:0.01734672673046589
The generated pressure mean: 0.4503924548625946
loss_pred:0.026549164205789566, decouple_loss:0.01629347912967205
The generated pressure mean: 0.4491032361984253
loss_pred:0.02722110040485859, decouple_loss:0.016577811911702156
Iteration: 800, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44907888770103455
The generated pressure mean: 0.4497804045677185loss_pred:0.02783343568444252, decouple_loss:0.016556398943066597
loss_pred:0.027404693886637688, decouple_loss:0.015777790918946266
The generated pressure mean: 0.4494391083717346
loss_pred:0.02737056463956833, decouple_loss:0.01621742732822895
2023-04-16 04:36:42 testing...
The generated pressure mean: 0.4502691328525543
loss_pred:0.14497064054012299, decouple_loss:0.06841569393873215
The generated pressure mean: 0.45032304525375366
loss_pred:0.1424454301595688, decouple_loss:0.0688822790980339
The generated pressure mean: 0.4500305950641632
loss_pred:0.14366233348846436, decouple_loss:0.06891650706529617
Loss: 0.14712971448898315, avg_mse: 0.2727314829826355
current test mse: 0.272731
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012010_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012010_3_24hr.npz
NaN value num: 0
Iteration: 801, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4476877450942993
loss_pred:0.028057372197508812, decouple_loss:0.01588558405637741
The generated pressure mean: 0.4477331340312958
loss_pred:0.026464464142918587, decouple_loss:0.015871254727244377
The generated pressure mean: 0.44878482818603516
loss_pred:0.025957683101296425, decouple_loss:0.01524172630161047
Iteration: 802, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4486595690250397
loss_pred:0.026247519999742508, decouple_loss:0.015297366306185722
The generated pressure mean: 0.4483967125415802
loss_pred:0.02645823359489441, decouple_loss:0.015257676132023335
The generated pressure mean: 0.4490651488304138
loss_pred:0.026119040325284004, decouple_loss:0.015554891899228096
Iteration: 803, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4488990008831024
loss_pred:0.02718840353190899, decouple_loss:0.01523965410888195
The generated pressure mean: 0.4486997425556183
loss_pred:0.02663997747004032, decouple_loss:0.015491425059735775
The generated pressure mean: 0.4479312598705292
loss_pred:0.027730673551559448, decouple_loss:0.015645932406187057
Iteration: 804, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4487029016017914
The generated pressure mean: 0.44835108518600464
loss_pred:0.027111681178212166, decouple_loss:0.015349004417657852
loss_pred:0.027774672955274582, decouple_loss:0.01534977089613676
The generated pressure mean: 0.4482104778289795
loss_pred:0.029011785984039307, decouple_loss:0.015301180072128773
Iteration: 805, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44775545597076416
loss_pred:0.030486419796943665, decouple_loss:0.0152690215036273
The generated pressure mean: 0.4485365152359009
loss_pred:0.02566036581993103, decouple_loss:0.01591235212981701
The generated pressure mean: 0.44809505343437195
loss_pred:0.028655312955379486, decouple_loss:0.015865536406636238
Iteration: 806, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.449419230222702
loss_pred:0.02669445052742958, decouple_loss:0.018824229016900063
The generated pressure mean: 0.44768011569976807
loss_pred:0.028779223561286926, decouple_loss:0.0176133643835783
The generated pressure mean: 0.4486958384513855
loss_pred:0.02727620303630829, decouple_loss:0.01715788058936596
Iteration: 807, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4484822154045105
The generated pressure mean: 0.4473051428794861
loss_pred:0.02601596899330616, decouple_loss:0.015444230288267136
loss_pred:0.028779927641153336, decouple_loss:0.016262784600257874
The generated pressure mean: 0.4491509199142456
loss_pred:0.025389263406395912, decouple_loss:0.01664404571056366
Iteration: 808, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.447794646024704
The generated pressure mean: 0.4474722743034363loss_pred:0.02811778523027897, decouple_loss:0.01693759672343731
loss_pred:0.02800130844116211, decouple_loss:0.0176481232047081
The generated pressure mean: 0.4471453130245209
loss_pred:0.028633788228034973, decouple_loss:0.016366273164749146
Iteration: 809, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4477972388267517
loss_pred:0.024514881893992424, decouple_loss:0.01596604660153389
The generated pressure mean: 0.44839760661125183
loss_pred:0.024949049577116966, decouple_loss:0.016733210533857346
The generated pressure mean: 0.4475158452987671
loss_pred:0.02580174431204796, decouple_loss:0.01690288819372654
Iteration: 810, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4479842782020569
loss_pred:0.029387861490249634, decouple_loss:0.01744481362402439
The generated pressure mean: 0.44724348187446594
loss_pred:0.028757227584719658, decouple_loss:0.016688447445631027
The generated pressure mean: 0.44975367188453674
loss_pred:0.02652132883667946, decouple_loss:0.017306102439761162
2023-04-16 04:39:37 testing...
The generated pressure mean: 0.4502691626548767
loss_pred:0.14542362093925476, decouple_loss:0.06969937682151794
The generated pressure mean: 0.4503239393234253
loss_pred:0.1425485461950302, decouple_loss:0.07016608119010925
The generated pressure mean: 0.4500323235988617
loss_pred:0.14376415312290192, decouple_loss:0.07015330344438553
Loss: 0.14741241931915283, avg_mse: 0.2693316638469696
current test mse: 0.269332
Iteration: 811, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44833245873451233
loss_pred:0.02646518312394619, decouple_loss:0.01673920638859272
The generated pressure mean: 0.44702523946762085The generated pressure mean: 0.4480428993701935
loss_pred:0.027650456875562668, decouple_loss:0.016887426376342773loss_pred:0.026417141780257225, decouple_loss:0.017291035503149033
Iteration: 812, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44828519225120544
The generated pressure mean: 0.44785043597221375loss_pred:0.026267455890774727, decouple_loss:0.01562239695340395
loss_pred:0.02744789607822895, decouple_loss:0.015621699392795563
The generated pressure mean: 0.44897928833961487
loss_pred:0.027727369219064713, decouple_loss:0.016343621537089348
Iteration: 813, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4477457106113434
The generated pressure mean: 0.4472206234931946
The generated pressure mean: 0.4483974575996399
loss_pred:0.0273874681442976, decouple_loss:0.01596297137439251
loss_pred:0.02646535448729992, decouple_loss:0.01594921387732029
loss_pred:0.027119847014546394, decouple_loss:0.015259340405464172
Iteration: 814, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44779714941978455The generated pressure mean: 0.44756966829299927
loss_pred:0.026581792160868645, decouple_loss:0.015487244352698326loss_pred:0.027129141613841057, decouple_loss:0.014981158077716827
The generated pressure mean: 0.4477176368236542
loss_pred:0.026301197707653046, decouple_loss:0.017072901129722595
Iteration: 815, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44747206568717957
loss_pred:0.026805132627487183, decouple_loss:0.01588311977684498
The generated pressure mean: 0.4493420124053955
loss_pred:0.025221053510904312, decouple_loss:0.015328376553952694
The generated pressure mean: 0.4487539231777191
loss_pred:0.026121115311980247, decouple_loss:0.016257595270872116
Iteration: 816, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4485802948474884
loss_pred:0.02592957578599453, decouple_loss:0.01625782437622547
The generated pressure mean: 0.4478023648262024
loss_pred:0.02561245858669281, decouple_loss:0.015403129160404205
The generated pressure mean: 0.4477780759334564
loss_pred:0.026778114959597588, decouple_loss:0.01721176691353321
Iteration: 817, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44883590936660767
loss_pred:0.028107967227697372, decouple_loss:0.015428565442562103
The generated pressure mean: 0.4474320411682129
loss_pred:0.02711084671318531, decouple_loss:0.014946934767067432
The generated pressure mean: 0.4492419958114624
loss_pred:0.025388766080141068, decouple_loss:0.015711724758148193
Iteration: 818, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4480915665626526
loss_pred:0.0257257092744112, decouple_loss:0.01543784886598587
The generated pressure mean: 0.44817522168159485
loss_pred:0.02683473937213421, decouple_loss:0.0163580272346735
The generated pressure mean: 0.44906309247016907
loss_pred:0.025513755157589912, decouple_loss:0.015317350625991821
Iteration: 819, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44809725880622864The generated pressure mean: 0.4486130475997925
loss_pred:0.02626151591539383, decouple_loss:0.015557066537439823
loss_pred:0.02462700381875038, decouple_loss:0.015337781049311161
The generated pressure mean: 0.44900408387184143
loss_pred:0.02661016397178173, decouple_loss:0.01586252637207508
Iteration: 820, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44950783252716064
The generated pressure mean: 0.44792357087135315
loss_pred:0.024793939664959908, decouple_loss:0.014401370659470558
loss_pred:0.025895612314343452, decouple_loss:0.01514509879052639
The generated pressure mean: 0.44862475991249084
loss_pred:0.02576700784265995, decouple_loss:0.013924187049269676
2023-04-16 04:41:42 testing...
The generated pressure mean: 0.4502691924571991
loss_pred:0.14688074588775635, decouple_loss:0.07295619696378708
The generated pressure mean: 0.4503224492073059
loss_pred:0.14412926137447357, decouple_loss:0.07352504134178162
The generated pressure mean: 0.45003020763397217
loss_pred:0.14534005522727966, decouple_loss:0.07350582629442215
Loss: 0.14911648631095886, avg_mse: 0.2799329161643982
current test mse: 0.279933
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012012_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012012_3_24hr.npz
NaN value num: 0
Iteration: 821, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.447094589471817
loss_pred:0.025949731469154358, decouple_loss:0.015345949679613113
The generated pressure mean: 0.44775184988975525
loss_pred:0.028933534398674965, decouple_loss:0.015844963490962982
The generated pressure mean: 0.4480848014354706
loss_pred:0.02717621810734272, decouple_loss:0.016128022223711014
Iteration: 822, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44744423031806946
The generated pressure mean: 0.4475603997707367
loss_pred:0.026810422539711, decouple_loss:0.015687936916947365
loss_pred:0.025146450847387314, decouple_loss:0.015632787719368935
The generated pressure mean: 0.4474366307258606
loss_pred:0.027205700054764748, decouple_loss:0.015441840514540672
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 823, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4467445909976959
loss_pred:0.0327373631298542, decouple_loss:0.013867166824638844
The generated pressure mean: 0.4475451707839966
loss_pred:0.026357218623161316, decouple_loss:0.014819429256021976
The generated pressure mean: 0.4477695822715759
loss_pred:0.025712596252560616, decouple_loss:0.014795107766985893
Iteration: 824, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4466734528541565The generated pressure mean: 0.44765153527259827
loss_pred:0.026991259306669235, decouple_loss:0.015655366703867912
loss_pred:0.025676293298602104, decouple_loss:0.01605355180799961
The generated pressure mean: 0.4477684199810028
loss_pred:0.024699892848730087, decouple_loss:0.015904363244771957
Iteration: 825, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4474884271621704
The generated pressure mean: 0.44765615463256836
loss_pred:0.027178430929780006, decouple_loss:0.015087668783962727
loss_pred:0.024410540238022804, decouple_loss:0.015590529888868332
The generated pressure mean: 0.44741305708885193
loss_pred:0.026193341240286827, decouple_loss:0.01602241024374962
Iteration: 826, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44711634516716003
The generated pressure mean: 0.44829103350639343
loss_pred:0.027323942631483078, decouple_loss:0.01650182530283928
loss_pred:0.028358595445752144, decouple_loss:0.015336058102548122
The generated pressure mean: 0.4485558867454529
loss_pred:0.028019817546010017, decouple_loss:0.015641454607248306
Iteration: 827, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44838443398475647The generated pressure mean: 0.4486589729785919
loss_pred:0.02635643444955349, decouple_loss:0.017401043325662613loss_pred:0.027304405346512794, decouple_loss:0.01658099889755249
The generated pressure mean: 0.44762736558914185
loss_pred:0.027238162234425545, decouple_loss:0.016903989017009735
Iteration: 828, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44793152809143066
The generated pressure mean: 0.4464260935783386loss_pred:0.026411162689328194, decouple_loss:0.015293136239051819
loss_pred:0.026077620685100555, decouple_loss:0.016040010377764702
The generated pressure mean: 0.4471125304698944
loss_pred:0.0292879156768322, decouple_loss:0.015424882993102074
Iteration: 829, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44899603724479675The generated pressure mean: 0.4473356306552887
loss_pred:0.025626590475440025, decouple_loss:0.01646481640636921
loss_pred:0.02625300921499729, decouple_loss:0.015539136715233326
The generated pressure mean: 0.44737422466278076
loss_pred:0.028186427429318428, decouple_loss:0.01606014370918274
Iteration: 830, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44661590456962585
The generated pressure mean: 0.4472770690917969
loss_pred:0.02630857191979885, decouple_loss:0.01561551820486784
loss_pred:0.027395231649279594, decouple_loss:0.01589461974799633
The generated pressure mean: 0.44866350293159485
loss_pred:0.026564711704850197, decouple_loss:0.0158520620316267
2023-04-16 04:44:32 testing...
The generated pressure mean: 0.4502691328525543
loss_pred:0.14459240436553955, decouple_loss:0.06930436939001083
The generated pressure mean: 0.45032399892807007
loss_pred:0.14163124561309814, decouple_loss:0.07049066573381424
The generated pressure mean: 0.45003095269203186
loss_pred:0.14263102412223816, decouple_loss:0.07037527114152908
Loss: 0.14645439386367798, avg_mse: 0.2712551951408386
current test mse: 0.271255
Iteration: 831, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4474829435348511
The generated pressure mean: 0.44859549403190613The generated pressure mean: 0.4466097950935364
loss_pred:0.026369420811533928, decouple_loss:0.014869610778987408
loss_pred:0.025346823036670685, decouple_loss:0.014370367862284184
loss_pred:0.025828780606389046, decouple_loss:0.01442169863730669
Iteration: 832, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44682469964027405
loss_pred:0.02798439934849739, decouple_loss:0.014549804851412773
The generated pressure mean: 0.44767916202545166
loss_pred:0.027103649452328682, decouple_loss:0.0142724784091115
The generated pressure mean: 0.44758984446525574
loss_pred:0.025566425174474716, decouple_loss:0.014819971285760403
Iteration: 833, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44789689779281616
loss_pred:0.027159366756677628, decouple_loss:0.015143847092986107
The generated pressure mean: 0.44939905405044556
The generated pressure mean: 0.4479251205921173
loss_pred:0.02822241559624672, decouple_loss:0.01453139167279005
loss_pred:0.026251282542943954, decouple_loss:0.014476749114692211
Iteration: 834, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4467145502567291
loss_pred:0.02671915292739868, decouple_loss:0.01462860032916069
The generated pressure mean: 0.4472805857658386
loss_pred:0.027776669710874557, decouple_loss:0.01462056115269661
The generated pressure mean: 0.44746217131614685
loss_pred:0.026935582980513573, decouple_loss:0.014498461969196796
Iteration: 835, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.447529673576355
The generated pressure mean: 0.44715920090675354loss_pred:0.02627265825867653, decouple_loss:0.014108377508819103
loss_pred:0.025652844458818436, decouple_loss:0.014260909520089626
The generated pressure mean: 0.4470173120498657
loss_pred:0.025908350944519043, decouple_loss:0.014170682057738304
Iteration: 836, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4478209614753723The generated pressure mean: 0.4481630325317383
loss_pred:0.025442024692893028, decouple_loss:0.014034861698746681loss_pred:0.025111176073551178, decouple_loss:0.014011679217219353
The generated pressure mean: 0.4483970105648041
loss_pred:0.02616175450384617, decouple_loss:0.013742045499384403
Iteration: 837, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4474392831325531
loss_pred:0.026398062705993652, decouple_loss:0.014270368963479996
The generated pressure mean: 0.44779980182647705
loss_pred:0.025100912898778915, decouple_loss:0.014534665271639824
The generated pressure mean: 0.4476657807826996
loss_pred:0.02439882606267929, decouple_loss:0.014589859172701836
Iteration: 838, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4479125440120697
The generated pressure mean: 0.44753506779670715
loss_pred:0.026015153154730797, decouple_loss:0.014311712235212326
loss_pred:0.026519011706113815, decouple_loss:0.014646847732365131
The generated pressure mean: 0.4482208788394928
loss_pred:0.02573629841208458, decouple_loss:0.014772247523069382
Iteration: 839, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44733574986457825
The generated pressure mean: 0.44687309861183167
loss_pred:0.025627877563238144, decouple_loss:0.013790099881589413
loss_pred:0.02607721835374832, decouple_loss:0.014547443017363548
The generated pressure mean: 0.44655758142471313
loss_pred:0.027337389066815376, decouple_loss:0.014447077177464962
Iteration: 840, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4484263062477112
The generated pressure mean: 0.4476868808269501
loss_pred:0.025674551725387573, decouple_loss:0.014050512574613094
loss_pred:0.025700431317090988, decouple_loss:0.01405489444732666
The generated pressure mean: 0.4466376304626465
loss_pred:0.025934234261512756, decouple_loss:0.014250213280320168
2023-04-16 04:46:36 testing...
The generated pressure mean: 0.4502691626548767
loss_pred:0.14499305188655853, decouple_loss:0.06686154007911682
The generated pressure mean: 0.45032206177711487
loss_pred:0.1428995281457901, decouple_loss:0.06808723509311676
The generated pressure mean: 0.45002731680870056
loss_pred:0.1440962553024292, decouple_loss:0.06743843108415604
Loss: 0.1473693996667862, avg_mse: 0.2751132845878601
current test mse: 0.275113
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012015_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012015_3_24hr.npz
NaN value num: 0
Iteration: 841, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44976967573165894
loss_pred:0.025558874011039734, decouple_loss:0.01892508752644062
The generated pressure mean: 0.44593510031700134
loss_pred:0.02684764750301838, decouple_loss:0.014824566431343555
The generated pressure mean: 0.4483247399330139
loss_pred:0.02662225067615509, decouple_loss:0.014886600896716118
Iteration: 842, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4477361738681793
loss_pred:0.02707618661224842, decouple_loss:0.015174895524978638
The generated pressure mean: 0.44851186871528625
loss_pred:0.025983354076743126, decouple_loss:0.014760470949113369
The generated pressure mean: 0.4495350122451782
loss_pred:0.02772589959204197, decouple_loss:0.01737331598997116
Iteration: 843, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4486021101474762
loss_pred:0.02644430473446846, decouple_loss:0.015675967559218407
The generated pressure mean: 0.44767504930496216
loss_pred:0.027257636189460754, decouple_loss:0.016323748975992203
The generated pressure mean: 0.4495970606803894
loss_pred:0.02858809381723404, decouple_loss:0.017127733677625656
Iteration: 844, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4462406635284424
loss_pred:0.027910735458135605, decouple_loss:0.015538793057203293
The generated pressure mean: 0.4477715492248535
loss_pred:0.025337588042020798, decouple_loss:0.015238646417856216
The generated pressure mean: 0.44952884316444397
loss_pred:0.02718213200569153, decouple_loss:0.015290356241166592
Iteration: 845, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44819459319114685
loss_pred:0.027457211166620255, decouple_loss:0.015013257041573524
The generated pressure mean: 0.44654741883277893
loss_pred:0.028132736682891846, decouple_loss:0.015534525737166405
The generated pressure mean: 0.4487619996070862
loss_pred:0.027267122641205788, decouple_loss:0.015284077264368534
Iteration: 846, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44883233308792114
loss_pred:0.02814692258834839, decouple_loss:0.016374636441469193
The generated pressure mean: 0.4477587342262268
loss_pred:0.024524368345737457, decouple_loss:0.014163415879011154
The generated pressure mean: 0.44781866669654846
loss_pred:0.026835424825549126, decouple_loss:0.016494886949658394
Iteration: 847, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4493100941181183
loss_pred:0.02809029258787632, decouple_loss:0.016793612390756607
The generated pressure mean: 0.4478969871997833
loss_pred:0.027286257594823837, decouple_loss:0.01471913792192936
The generated pressure mean: 0.44698795676231384
loss_pred:0.02763628214597702, decouple_loss:0.014923937618732452
Iteration: 848, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.448562353849411
loss_pred:0.02710655704140663, decouple_loss:0.015298127196729183
The generated pressure mean: 0.4485633373260498
loss_pred:0.02623654156923294, decouple_loss:0.014988203532993793
The generated pressure mean: 0.44914981722831726
loss_pred:0.02579653635621071, decouple_loss:0.014784484170377254
Iteration: 849, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4481333792209625
loss_pred:0.02604800835251808, decouple_loss:0.015032690018415451
The generated pressure mean: 0.44653311371803284
loss_pred:0.027574362233281136, decouple_loss:0.016614621505141258
The generated pressure mean: 0.4480340778827667
loss_pred:0.026882102712988853, decouple_loss:0.015504333190619946
Iteration: 850, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44901275634765625
loss_pred:0.02724214270710945, decouple_loss:0.01621367409825325
The generated pressure mean: 0.44875797629356384
loss_pred:0.026309262961149216, decouple_loss:0.01553314458578825
The generated pressure mean: 0.44879239797592163
loss_pred:0.026475287973880768, decouple_loss:0.01641899347305298
2023-04-16 04:49:18 testing...
The generated pressure mean: 0.4502691924571991
loss_pred:0.15027333796024323, decouple_loss:0.07545507699251175
The generated pressure mean: 0.45032262802124023
loss_pred:0.1467934548854828, decouple_loss:0.07589517533779144
The generated pressure mean: 0.45002830028533936
loss_pred:0.14804606139659882, decouple_loss:0.07535827904939651
Loss: 0.15214942395687103, avg_mse: 0.2840306758880615
current test mse: 0.284031
Iteration: 851, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4483650326728821
loss_pred:0.027229202911257744, decouple_loss:0.01522095873951912
The generated pressure mean: 0.4489302635192871
loss_pred:0.026330502703785896, decouple_loss:0.015621941536664963
The generated pressure mean: 0.4487802982330322
loss_pred:0.025539187714457512, decouple_loss:0.014468608424067497
Iteration: 852, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44747111201286316
The generated pressure mean: 0.44853660464286804
loss_pred:0.027302335947752, decouple_loss:0.014855870977044106
loss_pred:0.028871238231658936, decouple_loss:0.016477609053254128
The generated pressure mean: 0.4483624994754791
loss_pred:0.026023322716355324, decouple_loss:0.014610693790018559
Iteration: 853, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44860461354255676
loss_pred:0.026085564866662025, decouple_loss:0.014373096637427807
The generated pressure mean: 0.4480418264865875
loss_pred:0.025275368243455887, decouple_loss:0.014604947529733181
The generated pressure mean: 0.44687986373901367
loss_pred:0.02965974248945713, decouple_loss:0.015443258918821812
Iteration: 854, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4489890933036804
loss_pred:0.026975633576512337, decouple_loss:0.01390738133341074
The generated pressure mean: 0.44912853837013245
loss_pred:0.025173868983983994, decouple_loss:0.013819086365401745
The generated pressure mean: 0.4482157230377197
loss_pred:0.025857437402009964, decouple_loss:0.01425282470881939
Iteration: 855, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44654545187950134
loss_pred:0.02608475834131241, decouple_loss:0.014109492301940918
The generated pressure mean: 0.44917982816696167
loss_pred:0.027357643470168114, decouple_loss:0.014361164532601833
The generated pressure mean: 0.44809484481811523
loss_pred:0.02693782187998295, decouple_loss:0.014876426197588444
Iteration: 856, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44693252444267273
loss_pred:0.026729978621006012, decouple_loss:0.014654293656349182
The generated pressure mean: 0.44903549551963806
loss_pred:0.025836696848273277, decouple_loss:0.01425761915743351
The generated pressure mean: 0.4494002163410187
loss_pred:0.027472561225295067, decouple_loss:0.015824157744646072
Iteration: 857, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44772598147392273
loss_pred:0.027102982625365257, decouple_loss:0.015485743060708046
The generated pressure mean: 0.4479862153530121
loss_pred:0.0257096029818058, decouple_loss:0.015108934603631496
The generated pressure mean: 0.4496093988418579
loss_pred:0.025280069559812546, decouple_loss:0.01484782062470913
Iteration: 858, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44773802161216736
loss_pred:0.026657484471797943, decouple_loss:0.018084099516272545
The generated pressure mean: 0.4482772946357727
loss_pred:0.026252660900354385, decouple_loss:0.017707185819745064
The generated pressure mean: 0.44896256923675537
loss_pred:0.026708776131272316, decouple_loss:0.017293676733970642
Iteration: 859, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44885319471359253The generated pressure mean: 0.44813627004623413
loss_pred:0.0268793273717165, decouple_loss:0.015530966222286224
loss_pred:0.024617057293653488, decouple_loss:0.0146848289296031
The generated pressure mean: 0.4499446749687195
loss_pred:0.025874167680740356, decouple_loss:0.017372116446495056
Iteration: 860, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44786447286605835
loss_pred:0.025121355429291725, decouple_loss:0.015492125414311886
The generated pressure mean: 0.44904395937919617
loss_pred:0.025418076664209366, decouple_loss:0.015600556507706642
The generated pressure mean: 0.4480411112308502
loss_pred:0.027838902547955513, decouple_loss:0.015237819403409958
2023-04-16 04:51:24 testing...
The generated pressure mean: 0.4502691924571991
loss_pred:0.1457812637090683, decouple_loss:0.06975739449262619
The generated pressure mean: 0.450325071811676
loss_pred:0.14287695288658142, decouple_loss:0.07001358270645142
The generated pressure mean: 0.450031042098999
loss_pred:0.14405305683612823, decouple_loss:0.0696214810013771
Loss: 0.14772698283195496, avg_mse: 0.27589619159698486
current test mse: 0.275896
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012019_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012019_3_24hr.npz
NaN value num: 0
Iteration: 861, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44903919100761414
loss_pred:0.025074556469917297, decouple_loss:0.014704608358442783
The generated pressure mean: 0.4496917724609375
The generated pressure mean: 0.44984856247901917
loss_pred:0.02532762661576271, decouple_loss:0.015166860073804855
loss_pred:0.025560740381479263, decouple_loss:0.016284044831991196
Iteration: 862, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4502659738063812
The generated pressure mean: 0.4499359428882599
loss_pred:0.026088567450642586, decouple_loss:0.01541919820010662
loss_pred:0.025769459083676338, decouple_loss:0.014912338927388191
The generated pressure mean: 0.4497707486152649
loss_pred:0.026071351021528244, decouple_loss:0.014814188703894615
Iteration: 863, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44981178641319275
The generated pressure mean: 0.44984057545661926
loss_pred:0.02631685696542263, decouple_loss:0.015103142708539963
loss_pred:0.023883990943431854, decouple_loss:0.01523894164711237
The generated pressure mean: 0.4494325518608093
loss_pred:0.025219617411494255, decouple_loss:0.015019337646663189
Iteration: 864, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44916144013404846
The generated pressure mean: 0.4500076472759247
loss_pred:0.025456180796027184, decouple_loss:0.015877267345786095
loss_pred:0.026586025953292847, decouple_loss:0.015248230658471584
The generated pressure mean: 0.4489428400993347
loss_pred:0.027422798797488213, decouple_loss:0.01557223778218031
Iteration: 865, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44860604405403137
The generated pressure mean: 0.4494348466396332loss_pred:0.024280324578285217, decouple_loss:0.01578870601952076
loss_pred:0.025672944262623787, decouple_loss:0.01540099736303091
The generated pressure mean: 0.45064470171928406
loss_pred:0.02419743873178959, decouple_loss:0.016069257631897926
Iteration: 866, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4506978988647461
loss_pred:0.026284709572792053, decouple_loss:0.01724192313849926The generated pressure mean: 0.44975802302360535
loss_pred:0.026709962636232376, decouple_loss:0.01691870577633381
The generated pressure mean: 0.45004802942276
loss_pred:0.027529411017894745, decouple_loss:0.018212296068668365
Iteration: 867, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4490868151187897
The generated pressure mean: 0.4486033320426941loss_pred:0.0267157144844532, decouple_loss:0.014842413365840912
loss_pred:0.026609165593981743, decouple_loss:0.01504491176456213
The generated pressure mean: 0.44985976815223694
loss_pred:0.02610653266310692, decouple_loss:0.014644433744251728
Iteration: 868, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4497697651386261
loss_pred:0.027175264433026314, decouple_loss:0.01684166118502617
The generated pressure mean: 0.44920530915260315
loss_pred:0.027036400511860847, decouple_loss:0.0169365257024765
The generated pressure mean: 0.44984444975852966
loss_pred:0.026448067277669907, decouple_loss:0.016635537147521973
Iteration: 869, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44951313734054565
The generated pressure mean: 0.45071226358413696loss_pred:0.02623169496655464, decouple_loss:0.015549234114587307
loss_pred:0.025599626824259758, decouple_loss:0.017521563917398453
The generated pressure mean: 0.4486313462257385
loss_pred:0.02809424139559269, decouple_loss:0.01519655343145132
Iteration: 870, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4511594772338867
loss_pred:0.023879481479525566, decouple_loss:0.016244221478700638
The generated pressure mean: 0.4494919776916504
loss_pred:0.028672348707914352, decouple_loss:0.017592938616871834
The generated pressure mean: 0.45086973905563354
loss_pred:0.025057300925254822, decouple_loss:0.0170303825289011
2023-04-16 04:54:05 testing...
The generated pressure mean: 0.4502691626548767
loss_pred:0.14742745459079742, decouple_loss:0.07452748715877533
The generated pressure mean: 0.45032191276550293
loss_pred:0.1445654183626175, decouple_loss:0.07507673650979996
The generated pressure mean: 0.4500293433666229
loss_pred:0.14568886160850525, decouple_loss:0.07480815798044205
Loss: 0.14963412284851074, avg_mse: 0.27817487716674805
current test mse: 0.278175
Iteration: 871, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44986066222190857
The generated pressure mean: 0.45068392157554626
loss_pred:0.02810727432370186, decouple_loss:0.016055885702371597
loss_pred:0.026435144245624542, decouple_loss:0.01591477543115616
The generated pressure mean: 0.45023003220558167
loss_pred:0.025621050968766212, decouple_loss:0.015171501785516739
Iteration: 872, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45035356283187866
The generated pressure mean: 0.451479971408844
loss_pred:0.027816999703645706, decouple_loss:0.016071775928139687
loss_pred:0.02433980256319046, decouple_loss:0.016412151977419853
The generated pressure mean: 0.45139825344085693
loss_pred:0.025229601189494133, decouple_loss:0.01668360084295273
Iteration: 873, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45036107301712036
The generated pressure mean: 0.44977691769599915
loss_pred:0.027070682495832443, decouple_loss:0.015704821795225143
loss_pred:0.025444533675909042, decouple_loss:0.016004115343093872
The generated pressure mean: 0.45026683807373047
loss_pred:0.027353066951036453, decouple_loss:0.01580796390771866
Iteration: 874, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4482322931289673
The generated pressure mean: 0.45095959305763245loss_pred:0.027179064229130745, decouple_loss:0.016000600531697273
loss_pred:0.0270242840051651, decouple_loss:0.0165060143917799
The generated pressure mean: 0.4504104554653168
loss_pred:0.025387318804860115, decouple_loss:0.016474319621920586
Iteration: 875, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44960227608680725
The generated pressure mean: 0.4496115744113922
loss_pred:0.026687392964959145, decouple_loss:0.01600693166255951
loss_pred:0.026467446237802505, decouple_loss:0.016323570162057877
The generated pressure mean: 0.44896742701530457
loss_pred:0.025291217491030693, decouple_loss:0.015261228196322918
Iteration: 876, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4489465355873108
loss_pred:0.02683226764202118, decouple_loss:0.016199400648474693
The generated pressure mean: 0.45057716965675354
loss_pred:0.026538344100117683, decouple_loss:0.01671944186091423
The generated pressure mean: 0.4513835608959198
loss_pred:0.026127135381102562, decouple_loss:0.016081608831882477
Iteration: 877, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45076102018356323
The generated pressure mean: 0.44958391785621643
loss_pred:0.025405948981642723, decouple_loss:0.016668332740664482
loss_pred:0.02528444118797779, decouple_loss:0.015828939154744148
The generated pressure mean: 0.4485466778278351
loss_pred:0.024971557781100273, decouple_loss:0.016613192856311798
Iteration: 878, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4512367844581604
loss_pred:0.026213260367512703, decouple_loss:0.015229504555463791
The generated pressure mean: 0.4488002061843872
loss_pred:0.027235761284828186, decouple_loss:0.01583937369287014
The generated pressure mean: 0.45005977153778076
loss_pred:0.02463056705892086, decouple_loss:0.015011107549071312
Iteration: 879, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4508032202720642
loss_pred:0.025758860632777214, decouple_loss:0.016776999458670616
The generated pressure mean: 0.44931456446647644
loss_pred:0.025502467527985573, decouple_loss:0.016287129372358322
The generated pressure mean: 0.44918128848075867
loss_pred:0.026671145111322403, decouple_loss:0.015717200934886932
Iteration: 880, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4502246379852295
loss_pred:0.026075616478919983, decouple_loss:0.01603112369775772
The generated pressure mean: 0.4502468407154083
loss_pred:0.026442067697644234, decouple_loss:0.015766771510243416
The generated pressure mean: 0.4494004547595978
loss_pred:0.028118105605244637, decouple_loss:0.015041492879390717
2023-04-16 04:56:11 testing...
The generated pressure mean: 0.4502691626548767
loss_pred:0.14840371906757355, decouple_loss:0.07373685389757156
The generated pressure mean: 0.4503245949745178
loss_pred:0.1452733278274536, decouple_loss:0.07435616105794907
The generated pressure mean: 0.4500303566455841
loss_pred:0.14664605259895325, decouple_loss:0.07398165017366409
Loss: 0.1504756212234497, avg_mse: 0.2811393141746521
current test mse: 0.281139
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012013_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012013_3_24hr.npz
NaN value num: 0
Iteration: 881, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44832947850227356
loss_pred:0.02502276934683323, decouple_loss:0.015006828121840954
The generated pressure mean: 0.44845500588417053
loss_pred:0.026477564126253128, decouple_loss:0.015261553227901459
The generated pressure mean: 0.44865861535072327
loss_pred:0.024539059028029442, decouple_loss:0.016552122309803963
Iteration: 882, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44935357570648193
loss_pred:0.024752087891101837, decouple_loss:0.015063617378473282
The generated pressure mean: 0.44871029257774353
The generated pressure mean: 0.44781383872032166
loss_pred:0.025656547397375107, decouple_loss:0.014365723356604576
loss_pred:0.025342300534248352, decouple_loss:0.01450302917510271
Iteration: 883, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4487643241882324
loss_pred:0.025392092764377594, decouple_loss:0.01505608856678009
The generated pressure mean: 0.4472019076347351
loss_pred:0.0248939897865057, decouple_loss:0.01480934303253889
The generated pressure mean: 0.44834205508232117
loss_pred:0.025168532505631447, decouple_loss:0.014987614937126637
Iteration: 884, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4485691785812378
loss_pred:0.024237414821982384, decouple_loss:0.016034483909606934
The generated pressure mean: 0.44896310567855835
loss_pred:0.024889666587114334, decouple_loss:0.016230862587690353
The generated pressure mean: 0.4484734535217285
loss_pred:0.025325754657387733, decouple_loss:0.016816210001707077
Iteration: 885, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4474148154258728
The generated pressure mean: 0.4494662880897522
loss_pred:0.02578728273510933, decouple_loss:0.015395965427160263
loss_pred:0.024891439825296402, decouple_loss:0.014904932118952274
The generated pressure mean: 0.4480205178260803
loss_pred:0.0239864531904459, decouple_loss:0.015102948993444443
Iteration: 886, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44709575176239014
The generated pressure mean: 0.44735267758369446loss_pred:0.025320356711745262, decouple_loss:0.01572081260383129
loss_pred:0.025536848232150078, decouple_loss:0.01481181476265192
The generated pressure mean: 0.4488728642463684
loss_pred:0.023733973503112793, decouple_loss:0.017074258998036385
Iteration: 887, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44836461544036865
loss_pred:0.025233104825019836, decouple_loss:0.01601593568921089
The generated pressure mean: 0.44727468490600586
loss_pred:0.024990756064653397, decouple_loss:0.01572873443365097
The generated pressure mean: 0.4480402171611786
loss_pred:0.02661431021988392, decouple_loss:0.015820851549506187
Iteration: 888, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4476875364780426
loss_pred:0.02472023479640484, decouple_loss:0.016036322340369225
The generated pressure mean: 0.447884738445282
loss_pred:0.026044119149446487, decouple_loss:0.01561554241925478
The generated pressure mean: 0.44766250252723694
loss_pred:0.027306320145726204, decouple_loss:0.0148076843470335
Iteration: 889, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4484201967716217
The generated pressure mean: 0.4484712481498718
loss_pred:0.02619984559714794, decouple_loss:0.01418892852962017
loss_pred:0.024716388434171677, decouple_loss:0.015090467408299446
The generated pressure mean: 0.4491109549999237
loss_pred:0.024767227470874786, decouple_loss:0.015144454315304756
Iteration: 890, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4478447735309601
loss_pred:0.023960372433066368, decouple_loss:0.015897028148174286
The generated pressure mean: 0.4477848410606384
loss_pred:0.026126926764845848, decouple_loss:0.015193764120340347
The generated pressure mean: 0.44766008853912354
loss_pred:0.024597035720944405, decouple_loss:0.015141783282160759
2023-04-16 04:59:00 testing...
The generated pressure mean: 0.4502691328525543
loss_pred:0.1456460803747177, decouple_loss:0.06950309872627258
The generated pressure mean: 0.45032331347465515
loss_pred:0.1426621675491333, decouple_loss:0.06980391591787338
The generated pressure mean: 0.45003148913383484
loss_pred:0.1436576545238495, decouple_loss:0.06979266554117203
Loss: 0.14747363328933716, avg_mse: 0.2744519114494324
current test mse: 0.274452
Iteration: 891, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4476677179336548
loss_pred:0.026004474610090256, decouple_loss:0.01562776230275631
The generated pressure mean: 0.4476199746131897
loss_pred:0.026036184281110764, decouple_loss:0.013900392688810825
The generated pressure mean: 0.4474957585334778
loss_pred:0.024926913902163506, decouple_loss:0.014723308384418488
Iteration: 892, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44810178875923157
The generated pressure mean: 0.4486207664012909
loss_pred:0.02567075379192829, decouple_loss:0.015280083753168583
loss_pred:0.025222258642315865, decouple_loss:0.016032889485359192
The generated pressure mean: 0.44712337851524353
loss_pred:0.02662494033575058, decouple_loss:0.015346597880125046
Iteration: 893, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4478318989276886
loss_pred:0.025639642030000687, decouple_loss:0.015939442440867424
The generated pressure mean: 0.4480816721916199The generated pressure mean: 0.4494900107383728
loss_pred:0.02491641417145729, decouple_loss:0.015396702103316784
loss_pred:0.02442847192287445, decouple_loss:0.015791980549693108
Iteration: 894, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44804489612579346
loss_pred:0.02454213611781597, decouple_loss:0.014800436794757843
The generated pressure mean: 0.4468695819377899
loss_pred:0.02722790464758873, decouple_loss:0.015393083915114403
The generated pressure mean: 0.4480007290840149
loss_pred:0.0245608389377594, decouple_loss:0.014751944690942764
Iteration: 895, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4485662281513214
loss_pred:0.024461735039949417, decouple_loss:0.014909157529473305
The generated pressure mean: 0.44748741388320923
loss_pred:0.02676532417535782, decouple_loss:0.01520316582173109
The generated pressure mean: 0.44873639941215515
loss_pred:0.027361882850527763, decouple_loss:0.015470053069293499
Iteration: 896, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44803163409233093
The generated pressure mean: 0.4479829967021942
loss_pred:0.024947263300418854, decouple_loss:0.014317425899207592
loss_pred:0.024062668904662132, decouple_loss:0.014797836542129517
The generated pressure mean: 0.4470885992050171
loss_pred:0.025312473997473717, decouple_loss:0.01475309394299984
Iteration: 897, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4492778182029724
loss_pred:0.024379082024097443, decouple_loss:0.016527310013771057
The generated pressure mean: 0.44905614852905273
loss_pred:0.025560427457094193, decouple_loss:0.01676703803241253
The generated pressure mean: 0.44774553179740906
loss_pred:0.026419583708047867, decouple_loss:0.017058221623301506
Iteration: 898, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4474982023239136
The generated pressure mean: 0.44820451736450195
loss_pred:0.025169681757688522, decouple_loss:0.01640353538095951
loss_pred:0.02826027199625969, decouple_loss:0.015422157011926174
The generated pressure mean: 0.44739001989364624
loss_pred:0.026640858501195908, decouple_loss:0.017282208427786827
Iteration: 899, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44789591431617737
The generated pressure mean: 0.4468580186367035
loss_pred:0.02400321140885353, decouple_loss:0.015827715396881104
loss_pred:0.02471180073916912, decouple_loss:0.015203340910375118
The generated pressure mean: 0.4468448758125305
loss_pred:0.02597360499203205, decouple_loss:0.014488965272903442
Iteration: 900, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4485723674297333
loss_pred:0.024273399263620377, decouple_loss:0.015891676768660545
The generated pressure mean: 0.44933652877807617
loss_pred:0.026552289724349976, decouple_loss:0.016754649579524994
The generated pressure mean: 0.44729283452033997
loss_pred:0.027053438127040863, decouple_loss:0.0164931807667017
2023-04-16 05:01:05 testing...
The generated pressure mean: 0.4502691626548767
loss_pred:0.14949437975883484, decouple_loss:0.07267222553491592
The generated pressure mean: 0.4503229856491089
loss_pred:0.14707565307617188, decouple_loss:0.07332202792167664
The generated pressure mean: 0.4500311017036438
loss_pred:0.14859579503536224, decouple_loss:0.07317759096622467
Loss: 0.1520414799451828, avg_mse: 0.28523293137550354
current test mse: 0.285233
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012017_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012017_3_24hr.npz
NaN value num: 0
Iteration: 901, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4476057291030884
loss_pred:0.025311140343546867, decouple_loss:0.01528928242623806
The generated pressure mean: 0.44839656352996826
The generated pressure mean: 0.448896199464798loss_pred:0.027485644444823265, decouple_loss:0.015746522694826126
loss_pred:0.02602420747280121, decouple_loss:0.015072683803737164
Iteration: 902, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44838398694992065
loss_pred:0.027841584756970406, decouple_loss:0.016376370564103127
The generated pressure mean: 0.4481973350048065
loss_pred:0.02623540349304676, decouple_loss:0.016567854210734367
The generated pressure mean: 0.44772517681121826
loss_pred:0.02652730792760849, decouple_loss:0.016350947320461273
Iteration: 903, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4475767910480499
loss_pred:0.026815423741936684, decouple_loss:0.015355928801000118
The generated pressure mean: 0.44802725315093994
loss_pred:0.027242017909884453, decouple_loss:0.015531648881733418
The generated pressure mean: 0.44933223724365234
loss_pred:0.02532253973186016, decouple_loss:0.015132099390029907
Iteration: 904, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4493652582168579
loss_pred:0.02575742080807686, decouple_loss:0.016231900081038475
The generated pressure mean: 0.4479079842567444
loss_pred:0.026005076244473457, decouple_loss:0.015736639499664307
The generated pressure mean: 0.44873642921447754
loss_pred:0.024823695421218872, decouple_loss:0.01579715870320797
Iteration: 905, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4486357569694519
loss_pred:0.025944115594029427, decouple_loss:0.014347690157592297
The generated pressure mean: 0.44841212034225464
loss_pred:0.02701394073665142, decouple_loss:0.01449086144566536
The generated pressure mean: 0.4487879276275635
loss_pred:0.02728910744190216, decouple_loss:0.014484478160738945
Iteration: 906, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4484306871891022
loss_pred:0.025526680052280426, decouple_loss:0.01604461669921875
The generated pressure mean: 0.4488517642021179
loss_pred:0.0261195320636034, decouple_loss:0.015684664249420166
The generated pressure mean: 0.4493611454963684
loss_pred:0.024478305131196976, decouple_loss:0.015720326453447342
Iteration: 907, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4492965042591095
loss_pred:0.025775207206606865, decouple_loss:0.014875644817948341
The generated pressure mean: 0.44838714599609375
loss_pred:0.025539269670844078, decouple_loss:0.015267204493284225
The generated pressure mean: 0.4486900866031647
loss_pred:0.0258472990244627, decouple_loss:0.014820032753050327
Iteration: 908, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4487980306148529
The generated pressure mean: 0.4483245611190796loss_pred:0.02608235366642475, decouple_loss:0.016042103990912437
loss_pred:0.026842275634407997, decouple_loss:0.015109214931726456
The generated pressure mean: 0.44793277978897095
loss_pred:0.025683553889393806, decouple_loss:0.015027299523353577
Iteration: 909, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4467407763004303
loss_pred:0.025400668382644653, decouple_loss:0.01465129666030407
The generated pressure mean: 0.4494544267654419
loss_pred:0.025886094197630882, decouple_loss:0.014254798181355
The generated pressure mean: 0.44749611616134644
loss_pred:0.02484259381890297, decouple_loss:0.014954949729144573
Iteration: 910, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44840380549430847
loss_pred:0.02640857733786106, decouple_loss:0.01415095292031765
The generated pressure mean: 0.44787585735321045
loss_pred:0.0295883659273386, decouple_loss:0.014409175142645836
The generated pressure mean: 0.4473387897014618
loss_pred:0.0267243143171072, decouple_loss:0.01415099948644638
2023-04-16 05:03:57 testing...
The generated pressure mean: 0.4502691626548767
loss_pred:0.1472739577293396, decouple_loss:0.06730681657791138
The generated pressure mean: 0.4503200650215149
loss_pred:0.1450628936290741, decouple_loss:0.06895211338996887
The generated pressure mean: 0.4500288665294647
loss_pred:0.14651674032211304, decouple_loss:0.06858021765947342
Loss: 0.14969852566719055, avg_mse: 0.2806442975997925
current test mse: 0.280644
Iteration: 911, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4494814872741699
The generated pressure mean: 0.44810014963150024
loss_pred:0.027650494128465652, decouple_loss:0.01584024913609028
loss_pred:0.02577142044901848, decouple_loss:0.015553995035588741
The generated pressure mean: 0.4485946595668793
loss_pred:0.02615424245595932, decouple_loss:0.015525459311902523
Iteration: 912, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44920697808265686
loss_pred:0.025112934410572052, decouple_loss:0.01546425186097622
The generated pressure mean: 0.4479803740978241
loss_pred:0.027081726118922234, decouple_loss:0.014935401268303394
The generated pressure mean: 0.44842857122421265
loss_pred:0.024996573105454445, decouple_loss:0.01574717089533806
Iteration: 913, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44714462757110596
The generated pressure mean: 0.44803738594055176loss_pred:0.02616734243929386, decouple_loss:0.016380764544010162
The generated pressure mean: 0.44910454750061035
loss_pred:0.02622166834771633, decouple_loss:0.016398074105381966
loss_pred:0.02407166361808777, decouple_loss:0.01626678742468357
Iteration: 914, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4486963152885437The generated pressure mean: 0.44836103916168213
loss_pred:0.025892997160553932, decouple_loss:0.015221275389194489
loss_pred:0.02654598094522953, decouple_loss:0.01565004512667656
The generated pressure mean: 0.44902074337005615
loss_pred:0.023919541388750076, decouple_loss:0.016435865312814713
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 915, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44881314039230347The generated pressure mean: 0.44694656133651733
loss_pred:0.02417568676173687, decouple_loss:0.015365077182650566loss_pred:0.025554101914167404, decouple_loss:0.015536454506218433
The generated pressure mean: 0.44888195395469666
loss_pred:0.024346331134438515, decouple_loss:0.01519695483148098
Iteration: 916, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4487384259700775
loss_pred:0.025969969108700752, decouple_loss:0.015960734337568283
The generated pressure mean: 0.44842931628227234
loss_pred:0.02784019522368908, decouple_loss:0.015754416584968567
The generated pressure mean: 0.44854265451431274
loss_pred:0.025357156991958618, decouple_loss:0.015988584607839584
Iteration: 917, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44798576831817627
loss_pred:0.025620045140385628, decouple_loss:0.015693191438913345
The generated pressure mean: 0.4488189220428467
loss_pred:0.02579747885465622, decouple_loss:0.015613305382430553
The generated pressure mean: 0.4484921097755432
loss_pred:0.02758653461933136, decouple_loss:0.015651460736989975
Iteration: 918, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44855111837387085
loss_pred:0.024860858917236328, decouple_loss:0.016590233892202377
The generated pressure mean: 0.4481949508190155
loss_pred:0.02583378180861473, decouple_loss:0.016652749851346016
The generated pressure mean: 0.4487798511981964
loss_pred:0.02614053711295128, decouple_loss:0.016725651919841766
Iteration: 919, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44859758019447327
The generated pressure mean: 0.44852903485298157loss_pred:0.02654685638844967, decouple_loss:0.017680969089269638
loss_pred:0.02548806741833687, decouple_loss:0.016814593225717545
The generated pressure mean: 0.44858279824256897
loss_pred:0.02498009242117405, decouple_loss:0.01720714569091797
Iteration: 920, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4486652910709381
loss_pred:0.026958489790558815, decouple_loss:0.015105086378753185
The generated pressure mean: 0.4484868347644806
loss_pred:0.026423951610922813, decouple_loss:0.01530360896140337
The generated pressure mean: 0.448679119348526
loss_pred:0.024451715871691704, decouple_loss:0.01526094414293766
2023-04-16 05:06:03 testing...
The generated pressure mean: 0.4502691626548767
loss_pred:0.13606847822666168, decouple_loss:0.06374292075634003
The generated pressure mean: 0.45032358169555664
loss_pred:0.1345888078212738, decouple_loss:0.06481602787971497
The generated pressure mean: 0.4500311613082886
loss_pred:0.13537085056304932, decouple_loss:0.06442079693078995
Loss: 0.13855904340744019, avg_mse: 0.256649374961853
current test mse: 0.256649
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012015_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012015_3_24hr.npz
NaN value num: 0
Iteration: 921, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.447286456823349
loss_pred:0.02678705006837845, decouple_loss:0.015859225764870644
The generated pressure mean: 0.44772869348526
loss_pred:0.027562763541936874, decouple_loss:0.016127124428749084
The generated pressure mean: 0.4463684558868408
loss_pred:0.02863168902695179, decouple_loss:0.016197992488741875
Iteration: 922, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44853782653808594The generated pressure mean: 0.44707605242729187
loss_pred:0.027281025424599648, decouple_loss:0.016609348356723785
loss_pred:0.026212552562355995, decouple_loss:0.01600991189479828
The generated pressure mean: 0.44643428921699524
loss_pred:0.026020530611276627, decouple_loss:0.016081595793366432
Iteration: 923, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4475893974304199
loss_pred:0.027811331674456596, decouple_loss:0.015777600929141045
The generated pressure mean: 0.4476252794265747
loss_pred:0.027856985107064247, decouple_loss:0.01595361717045307
The generated pressure mean: 0.446532666683197
loss_pred:0.02622014470398426, decouple_loss:0.015413506887853146
Iteration: 924, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4482230544090271The generated pressure mean: 0.4464534521102905
loss_pred:0.030437791720032692, decouple_loss:0.016276363283395767
loss_pred:0.02852005884051323, decouple_loss:0.017443200573325157
The generated pressure mean: 0.44549208879470825
loss_pred:0.02790899947285652, decouple_loss:0.0170182716101408
Iteration: 925, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4471760094165802
loss_pred:0.025269269943237305, decouple_loss:0.015480997040867805
The generated pressure mean: 0.4474984109401703
loss_pred:0.02557671070098877, decouple_loss:0.014677791856229305
The generated pressure mean: 0.4461551904678345
loss_pred:0.02550538070499897, decouple_loss:0.01577945239841938
Iteration: 926, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44704481959342957
loss_pred:0.0263515654951334, decouple_loss:0.015267379581928253
The generated pressure mean: 0.4471292197704315
loss_pred:0.026240238919854164, decouple_loss:0.01474128570407629
The generated pressure mean: 0.4469418227672577
loss_pred:0.028926372528076172, decouple_loss:0.015316872857511044
Iteration: 927, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4461393356323242
loss_pred:0.025124523788690567, decouple_loss:0.014317565597593784
The generated pressure mean: 0.44709640741348267
loss_pred:0.025437630712985992, decouple_loss:0.014935414306819439
The generated pressure mean: 0.44675037264823914
loss_pred:0.02621827833354473, decouple_loss:0.014409647323191166
Iteration: 928, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4476170539855957
loss_pred:0.02729511260986328, decouple_loss:0.014938232488930225
The generated pressure mean: 0.4460498094558716
loss_pred:0.026586251333355904, decouple_loss:0.014681843109428883
The generated pressure mean: 0.4465687870979309
loss_pred:0.028782548382878304, decouple_loss:0.014770705252885818
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 929, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4478015601634979
loss_pred:0.026917722076177597, decouple_loss:0.013906721025705338
The generated pressure mean: 0.44476318359375
loss_pred:0.027666375041007996, decouple_loss:0.014804041013121605
The generated pressure mean: 0.4475363790988922
loss_pred:0.02645082399249077, decouple_loss:0.014117448590695858
Iteration: 930, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44626763463020325
loss_pred:0.027003981173038483, decouple_loss:0.01586209423840046
The generated pressure mean: 0.44717109203338623
loss_pred:0.025940466672182083, decouple_loss:0.015865055844187737
The generated pressure mean: 0.447388619184494
loss_pred:0.027194630354642868, decouple_loss:0.015622196719050407
2023-04-16 05:08:48 testing...
The generated pressure mean: 0.4502691328525543
loss_pred:0.14111565053462982, decouple_loss:0.06444921344518661
The generated pressure mean: 0.4503248929977417
loss_pred:0.13882677257061005, decouple_loss:0.06588959693908691
The generated pressure mean: 0.4500305950641632
loss_pred:0.13983525335788727, decouple_loss:0.06521797925233841
Loss: 0.14318518340587616, avg_mse: 0.26422542333602905
current test mse: 0.264225
Iteration: 931, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44675517082214355
loss_pred:0.02600366249680519, decouple_loss:0.014665166847407818
The generated pressure mean: 0.4476383328437805
The generated pressure mean: 0.4477178156375885
loss_pred:0.026630302891135216, decouple_loss:0.014753073453903198
loss_pred:0.024948954582214355, decouple_loss:0.01462870929390192
Iteration: 932, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4471040368080139
loss_pred:0.027247589081525803, decouple_loss:0.014836639165878296
The generated pressure mean: 0.4460413455963135
loss_pred:0.02568131685256958, decouple_loss:0.015025706961750984
The generated pressure mean: 0.44640403985977173
loss_pred:0.02512703277170658, decouple_loss:0.015630178153514862
Iteration: 933, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44772788882255554
The generated pressure mean: 0.44701719284057617
loss_pred:0.026365354657173157, decouple_loss:0.01581393927335739
loss_pred:0.025913864374160767, decouple_loss:0.015399578958749771
The generated pressure mean: 0.4477337896823883
loss_pred:0.025662332773208618, decouple_loss:0.016169240698218346
Iteration: 934, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4462107717990875
The generated pressure mean: 0.44775161147117615loss_pred:0.025147395208477974, decouple_loss:0.013655955903232098
loss_pred:0.025731917470693588, decouple_loss:0.014178006909787655
The generated pressure mean: 0.4470492899417877
loss_pred:0.025029899552464485, decouple_loss:0.014220881275832653
Iteration: 935, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4472332298755646
loss_pred:0.02595103159546852, decouple_loss:0.015426772646605968
The generated pressure mean: 0.44622698426246643
loss_pred:0.026479830965399742, decouple_loss:0.015401160344481468
The generated pressure mean: 0.4473295211791992
loss_pred:0.025694774463772774, decouple_loss:0.01484436634927988
Iteration: 936, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4464873671531677
The generated pressure mean: 0.4471350610256195
loss_pred:0.025023458525538445, decouple_loss:0.013494285754859447
loss_pred:0.025534195825457573, decouple_loss:0.014206982217729092
The generated pressure mean: 0.4464988112449646
loss_pred:0.02516019344329834, decouple_loss:0.013646278530359268
Iteration: 937, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44795939326286316
The generated pressure mean: 0.4476280212402344
loss_pred:0.026234576478600502, decouple_loss:0.014377480372786522
loss_pred:0.027109412476420403, decouple_loss:0.015117396600544453
The generated pressure mean: 0.44667333364486694
loss_pred:0.02570333331823349, decouple_loss:0.01424790732562542
Iteration: 938, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44574612379074097
loss_pred:0.024738486856222153, decouple_loss:0.01409834437072277
The generated pressure mean: 0.44687560200691223
loss_pred:0.025978079065680504, decouple_loss:0.014128291048109531
The generated pressure mean: 0.44764313101768494
loss_pred:0.02588929608464241, decouple_loss:0.01386283803731203
Iteration: 939, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4469016194343567The generated pressure mean: 0.4472326338291168
loss_pred:0.02624344825744629, decouple_loss:0.01377779059112072
loss_pred:0.025899771600961685, decouple_loss:0.014667446725070477
The generated pressure mean: 0.44819748401641846
loss_pred:0.026503153145313263, decouple_loss:0.013391174376010895
Iteration: 940, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44782984256744385
loss_pred:0.02477177232503891, decouple_loss:0.013489868491888046
The generated pressure mean: 0.4473678469657898
loss_pred:0.0262144822627306, decouple_loss:0.01375608704984188
The generated pressure mean: 0.4474088251590729
loss_pred:0.02567487210035324, decouple_loss:0.013902820646762848
2023-04-16 05:10:53 testing...
The generated pressure mean: 0.4502691924571991
loss_pred:0.146128848195076, decouple_loss:0.06874550879001617
The generated pressure mean: 0.4503239393234253
loss_pred:0.14378508925437927, decouple_loss:0.07007624953985214
The generated pressure mean: 0.4500294625759125
loss_pred:0.14515110850334167, decouple_loss:0.06976575404405594
Loss: 0.14849814772605896, avg_mse: 0.27525055408477783
current test mse: 0.275251
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012016_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012016_3_24hr.npz
NaN value num: 0
Iteration: 941, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44785380363464355
loss_pred:0.025181137025356293, decouple_loss:0.014986018650233746
The generated pressure mean: 0.44725269079208374
loss_pred:0.02428852766752243, decouple_loss:0.014032996259629726
The generated pressure mean: 0.4498216509819031
loss_pred:0.02537849359214306, decouple_loss:0.015865080058574677
Iteration: 942, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44833904504776
The generated pressure mean: 0.4476219117641449
loss_pred:0.026281237602233887, decouple_loss:0.01494809240102768
loss_pred:0.02485799975693226, decouple_loss:0.014938391745090485The generated pressure mean: 0.4470542371273041
loss_pred:0.024283170700073242, decouple_loss:0.014627940952777863
Iteration: 943, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44906723499298096
loss_pred:0.02504533901810646, decouple_loss:0.015427211299538612
The generated pressure mean: 0.4488201141357422The generated pressure mean: 0.4479251205921173
loss_pred:0.025772999972105026, decouple_loss:0.014879084192216396
loss_pred:0.026430994272232056, decouple_loss:0.01556846871972084
Iteration: 944, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44760870933532715The generated pressure mean: 0.44737508893013
loss_pred:0.024790558964014053, decouple_loss:0.014742673374712467loss_pred:0.02585405483841896, decouple_loss:0.01457713171839714
The generated pressure mean: 0.44870856404304504
loss_pred:0.026290588080883026, decouple_loss:0.014102200977504253
Iteration: 945, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4471331834793091
The generated pressure mean: 0.44919151067733765
loss_pred:0.02735230140388012, decouple_loss:0.015726692974567413
loss_pred:0.025456175208091736, decouple_loss:0.015148588456213474
The generated pressure mean: 0.4495891034603119
loss_pred:0.02418793924152851, decouple_loss:0.015796182677149773
Iteration: 946, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4472382068634033
loss_pred:0.024004410952329636, decouple_loss:0.01428673043847084
The generated pressure mean: 0.44748228788375854
loss_pred:0.023658335208892822, decouple_loss:0.014392551966011524
The generated pressure mean: 0.44719478487968445
loss_pred:0.02650393731892109, decouple_loss:0.014946768060326576
Iteration: 947, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44820737838745117The generated pressure mean: 0.448590487241745
loss_pred:0.023650450631976128, decouple_loss:0.013114075176417828
loss_pred:0.024966871365904808, decouple_loss:0.013399390503764153
The generated pressure mean: 0.4483506977558136
loss_pred:0.027006439864635468, decouple_loss:0.014104219153523445
Iteration: 948, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4474923014640808
loss_pred:0.02704371139407158, decouple_loss:0.01354061160236597
The generated pressure mean: 0.4482266306877136
loss_pred:0.024780308827757835, decouple_loss:0.014359674416482449
The generated pressure mean: 0.447471559047699
loss_pred:0.024700351059436798, decouple_loss:0.014576654881238937
Iteration: 949, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44902491569519043
The generated pressure mean: 0.447501540184021
loss_pred:0.024410469457507133, decouple_loss:0.016047710552811623
loss_pred:0.025529414415359497, decouple_loss:0.01470522116869688
The generated pressure mean: 0.44805824756622314
loss_pred:0.02496962994337082, decouple_loss:0.014408813789486885
Iteration: 950, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4482037425041199
loss_pred:0.024925658479332924, decouple_loss:0.014325199648737907
The generated pressure mean: 0.44811615347862244
loss_pred:0.024183280766010284, decouple_loss:0.01420364435762167
The generated pressure mean: 0.4485829770565033
loss_pred:0.024902286008000374, decouple_loss:0.014227639883756638
2023-04-16 05:13:35 testing...
The generated pressure mean: 0.4502691626548767
loss_pred:0.14533616602420807, decouple_loss:0.06933456659317017
The generated pressure mean: 0.45032578706741333
loss_pred:0.142605721950531, decouple_loss:0.07052848488092422
The generated pressure mean: 0.4500316381454468
loss_pred:0.14372745156288147, decouple_loss:0.06995517015457153
Loss: 0.14738675951957703, avg_mse: 0.2744527757167816
current test mse: 0.274453
Iteration: 951, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44807881116867065
loss_pred:0.0253994632512331, decouple_loss:0.014215514995157719
The generated pressure mean: 0.44744277000427246
The generated pressure mean: 0.4481247663497925loss_pred:0.02690938487648964, decouple_loss:0.015002269297838211
loss_pred:0.026149021461606026, decouple_loss:0.014634235762059689
Iteration: 952, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4501815736293793
The generated pressure mean: 0.4488905370235443
loss_pred:0.02590581588447094, decouple_loss:0.015831291675567627
loss_pred:0.027400827035307884, decouple_loss:0.01481235958635807
The generated pressure mean: 0.44829559326171875
loss_pred:0.026378177106380463, decouple_loss:0.01391306146979332
Iteration: 953, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4474324882030487
loss_pred:0.025867663323879242, decouple_loss:0.014248210936784744
The generated pressure mean: 0.44704073667526245
loss_pred:0.026617389172315598, decouple_loss:0.014732743613421917
The generated pressure mean: 0.44691547751426697
loss_pred:0.025255827233195305, decouple_loss:0.01435445062816143
Iteration: 954, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44709131121635437
loss_pred:0.028521081432700157, decouple_loss:0.014469271525740623
The generated pressure mean: 0.4489973485469818
loss_pred:0.027050016447901726, decouple_loss:0.015461687929928303
The generated pressure mean: 0.44717535376548767
loss_pred:0.026779629290103912, decouple_loss:0.014328953810036182
Iteration: 955, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44887930154800415
loss_pred:0.026561517268419266, decouple_loss:0.015933120623230934
The generated pressure mean: 0.4475371241569519
loss_pred:0.025686169043183327, decouple_loss:0.01589621603488922
The generated pressure mean: 0.44909149408340454
loss_pred:0.02516649290919304, decouple_loss:0.016801636666059494
Iteration: 956, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44781169295310974
The generated pressure mean: 0.448555052280426
loss_pred:0.027902234345674515, decouple_loss:0.01565486192703247
loss_pred:0.02567644789814949, decouple_loss:0.01618235372006893
The generated pressure mean: 0.4481993019580841
loss_pred:0.02700236067175865, decouple_loss:0.016403019428253174
Iteration: 957, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44762641191482544
loss_pred:0.02681429497897625, decouple_loss:0.015602589584887028
The generated pressure mean: 0.4479539394378662
loss_pred:0.026935892179608345, decouple_loss:0.014883581548929214
The generated pressure mean: 0.44745028018951416
loss_pred:0.0248004999011755, decouple_loss:0.015280528925359249
Iteration: 958, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4472418427467346
loss_pred:0.025096694007515907, decouple_loss:0.01652713678777218
The generated pressure mean: 0.4481560289859772
loss_pred:0.026606863364577293, decouple_loss:0.016866499558091164
The generated pressure mean: 0.44752267003059387
loss_pred:0.025546995922923088, decouple_loss:0.016817621886730194
Iteration: 959, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44816774129867554
The generated pressure mean: 0.4468655288219452loss_pred:0.02379857376217842, decouple_loss:0.015215118415653706
loss_pred:0.02473641373217106, decouple_loss:0.014973144978284836
The generated pressure mean: 0.4474586546421051
loss_pred:0.02541477605700493, decouple_loss:0.015452775172889233
Iteration: 960, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4469321370124817
The generated pressure mean: 0.4499872922897339
loss_pred:0.024510223418474197, decouple_loss:0.015569898299872875
loss_pred:0.025217870250344276, decouple_loss:0.01638505980372429
The generated pressure mean: 0.4477347433567047
loss_pred:0.025176512077450752, decouple_loss:0.016392532736063004
2023-04-16 05:15:39 testing...
The generated pressure mean: 0.4502691924571991
loss_pred:0.13560430705547333, decouple_loss:0.06521940231323242
The generated pressure mean: 0.4503251314163208
loss_pred:0.1330500841140747, decouple_loss:0.06562977284193039
The generated pressure mean: 0.45003044605255127
loss_pred:0.13421708345413208, decouple_loss:0.06578346341848373
Loss: 0.1375676989555359, avg_mse: 0.25498658418655396
current test mse: 0.254987
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012006_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012006_3_24hr.npz
NaN value num: 0
Iteration: 961, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4476943016052246
loss_pred:0.025818487629294395, decouple_loss:0.015816472470760345
The generated pressure mean: 0.44873711466789246
loss_pred:0.025163201615214348, decouple_loss:0.015493334271013737
The generated pressure mean: 0.44897812604904175
loss_pred:0.02615438774228096, decouple_loss:0.015388699248433113
Iteration: 962, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44788485765457153The generated pressure mean: 0.44745486974716187
The generated pressure mean: 0.44718044996261597
loss_pred:0.025252046063542366, decouple_loss:0.01569349877536297loss_pred:0.024523206055164337, decouple_loss:0.015468638390302658
loss_pred:0.02585565485060215, decouple_loss:0.015472209081053734
Iteration: 963, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44873371720314026
loss_pred:0.02548559568822384, decouple_loss:0.015498247928917408
The generated pressure mean: 0.44889652729034424
The generated pressure mean: 0.44786369800567627
loss_pred:0.02562435157597065, decouple_loss:0.01590585894882679
loss_pred:0.02674923464655876, decouple_loss:0.016071351245045662
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 964, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4487173855304718
loss_pred:0.025434959679841995, decouple_loss:0.014635617844760418The generated pressure mean: 0.44789960980415344
loss_pred:0.026035519316792488, decouple_loss:0.015641862526535988
The generated pressure mean: 0.4467993378639221
loss_pred:0.02631445601582527, decouple_loss:0.014735467731952667
Iteration: 965, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4474012553691864
The generated pressure mean: 0.4482676088809967
loss_pred:0.02543628215789795, decouple_loss:0.015914686024188995
loss_pred:0.024729682132601738, decouple_loss:0.015166722238063812
The generated pressure mean: 0.44751355051994324
loss_pred:0.024706782773137093, decouple_loss:0.014635179191827774
Iteration: 966, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44837623834609985
The generated pressure mean: 0.4493975043296814loss_pred:0.024633601307868958, decouple_loss:0.013980662450194359
loss_pred:0.02670009434223175, decouple_loss:0.014271123334765434
The generated pressure mean: 0.44786980748176575
loss_pred:0.02644420601427555, decouple_loss:0.014933905564248562
Iteration: 967, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4482381343841553
The generated pressure mean: 0.4480007290840149
loss_pred:0.026498960331082344, decouple_loss:0.014838822185993195
loss_pred:0.02523820474743843, decouple_loss:0.014898655004799366
The generated pressure mean: 0.44732803106307983
loss_pred:0.027335679158568382, decouple_loss:0.014845183119177818
Iteration: 968, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4478505551815033
The generated pressure mean: 0.44782257080078125
loss_pred:0.026299970224499702, decouple_loss:0.014430012553930283
loss_pred:0.027000267058610916, decouple_loss:0.014774096198379993
The generated pressure mean: 0.44804447889328003
loss_pred:0.028780851513147354, decouple_loss:0.015181735157966614
Iteration: 969, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44803011417388916
loss_pred:0.026199260726571083, decouple_loss:0.014918318949639797
The generated pressure mean: 0.44831374287605286
loss_pred:0.02540442906320095, decouple_loss:0.01583712548017502
The generated pressure mean: 0.44884341955184937
loss_pred:0.02510213851928711, decouple_loss:0.01535467617213726
Iteration: 970, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44766393303871155
loss_pred:0.024540357291698456, decouple_loss:0.014915256761014462
The generated pressure mean: 0.44746673107147217
loss_pred:0.024860652163624763, decouple_loss:0.015474026091396809
The generated pressure mean: 0.4487808048725128
loss_pred:0.027425995096564293, decouple_loss:0.015313693322241306
2023-04-16 05:18:21 testing...
The generated pressure mean: 0.4502691924571991
loss_pred:0.1433209478855133, decouple_loss:0.06872856616973877
The generated pressure mean: 0.45032429695129395
loss_pred:0.14123840630054474, decouple_loss:0.06916472315788269
The generated pressure mean: 0.45002883672714233
loss_pred:0.14235040545463562, decouple_loss:0.06926638633012772
Loss: 0.14575591683387756, avg_mse: 0.2724188566207886
current test mse: 0.272419
Iteration: 971, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44823747873306274
loss_pred:0.02474786713719368, decouple_loss:0.01386327389627695
The generated pressure mean: 0.4479143023490906
The generated pressure mean: 0.4481169581413269loss_pred:0.025441119447350502, decouple_loss:0.014017376117408276
loss_pred:0.024418190121650696, decouple_loss:0.014135575853288174
Iteration: 972, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4479289948940277
loss_pred:0.026177916675806046, decouple_loss:0.014647116884589195
The generated pressure mean: 0.4473820626735687
The generated pressure mean: 0.4475667476654053
loss_pred:0.025951221585273743, decouple_loss:0.01438557542860508
loss_pred:0.027305057272315025, decouple_loss:0.014863632619380951
Iteration: 973, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4473901391029358
loss_pred:0.024872981011867523, decouple_loss:0.014442121610045433
The generated pressure mean: 0.4483354091644287
loss_pred:0.02532680705189705, decouple_loss:0.014428663067519665
The generated pressure mean: 0.44737884402275085
loss_pred:0.026339493691921234, decouple_loss:0.014852101914584637
Iteration: 974, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4492025375366211
loss_pred:0.02666771039366722, decouple_loss:0.014448787085711956
The generated pressure mean: 0.44801148772239685
loss_pred:0.02616330049932003, decouple_loss:0.013941819779574871
The generated pressure mean: 0.4498822093009949
loss_pred:0.023796446621418, decouple_loss:0.0137763237580657
Iteration: 975, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44745761156082153
loss_pred:0.02579830028116703, decouple_loss:0.016373079270124435
The generated pressure mean: 0.4481852650642395
loss_pred:0.025680309161543846, decouple_loss:0.015720626339316368
The generated pressure mean: 0.44840559363365173
loss_pred:0.025421934202313423, decouple_loss:0.015966543927788734
Iteration: 976, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4491257965564728
loss_pred:0.023784305900335312, decouple_loss:0.014590203762054443
The generated pressure mean: 0.4478093683719635
loss_pred:0.02416115440428257, decouple_loss:0.014352414757013321
The generated pressure mean: 0.4472241699695587
loss_pred:0.02601788379251957, decouple_loss:0.01486554741859436
Iteration: 977, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44791340827941895
loss_pred:0.027684718370437622, decouple_loss:0.01533991564065218
The generated pressure mean: 0.4485204219818115
loss_pred:0.026114165782928467, decouple_loss:0.015734924003481865
The generated pressure mean: 0.44718074798583984
loss_pred:0.02738230675458908, decouple_loss:0.01577918604016304
Iteration: 978, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4485774636268616
loss_pred:0.026235518977046013, decouple_loss:0.01577715575695038
The generated pressure mean: 0.44775906205177307
loss_pred:0.024576181545853615, decouple_loss:0.015941642224788666
The generated pressure mean: 0.4479406774044037
loss_pred:0.02563938871026039, decouple_loss:0.015256128273904324
Iteration: 979, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.448811411857605
loss_pred:0.025260264053940773, decouple_loss:0.014103027060627937
The generated pressure mean: 0.4473423361778259
loss_pred:0.02444079890847206, decouple_loss:0.01419650949537754
The generated pressure mean: 0.4485184848308563
loss_pred:0.02501222863793373, decouple_loss:0.013772014528512955
Iteration: 980, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44868820905685425
loss_pred:0.02627120539546013, decouple_loss:0.014517068862915039
The generated pressure mean: 0.4471040368080139
loss_pred:0.02552352473139763, decouple_loss:0.01449105329811573
The generated pressure mean: 0.44779330492019653
loss_pred:0.025875646620988846, decouple_loss:0.014726510271430016
2023-04-16 05:20:26 testing...
The generated pressure mean: 0.4502691626548767
loss_pred:0.1377926766872406, decouple_loss:0.0636160597205162
The generated pressure mean: 0.4503239393234253
loss_pred:0.1354241967201233, decouple_loss:0.06423365324735641
The generated pressure mean: 0.4500286281108856
loss_pred:0.13649407029151917, decouple_loss:0.06393864750862122
Loss: 0.13976678252220154, avg_mse: 0.2603219151496887
current test mse: 0.260322
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012011_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012011_3_24hr.npz
NaN value num: 0
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 981, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44733962416648865
loss_pred:0.02476709708571434, decouple_loss:0.013367000967264175
The generated pressure mean: 0.44868040084838867
loss_pred:0.02513420768082142, decouple_loss:0.012958544306457043
The generated pressure mean: 0.447048544883728
loss_pred:0.02609163522720337, decouple_loss:0.013596882112324238
Iteration: 982, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44875186681747437
loss_pred:0.024587562307715416, decouple_loss:0.014715992845594883
The generated pressure mean: 0.446668416261673
loss_pred:0.02616613358259201, decouple_loss:0.015209745615720749
The generated pressure mean: 0.4462532699108124
loss_pred:0.02663567289710045, decouple_loss:0.015291186049580574
Iteration: 983, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44790297746658325
loss_pred:0.024792050942778587, decouple_loss:0.014691385440528393
The generated pressure mean: 0.4470221996307373
loss_pred:0.02556188404560089, decouple_loss:0.014943134039640427
The generated pressure mean: 0.4485800564289093
loss_pred:0.024507805705070496, decouple_loss:0.01440182514488697
Iteration: 984, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44745978713035583
loss_pred:0.024453207850456238, decouple_loss:0.01425461657345295
The generated pressure mean: 0.449621319770813
loss_pred:0.02554718591272831, decouple_loss:0.014207947067916393
The generated pressure mean: 0.448018878698349
loss_pred:0.025269094854593277, decouple_loss:0.013949938118457794
Iteration: 985, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44767850637435913
loss_pred:0.025995999574661255, decouple_loss:0.013972321525216103
The generated pressure mean: 0.44734880328178406
loss_pred:0.02477816864848137, decouple_loss:0.013689999468624592
The generated pressure mean: 0.446349173784256
loss_pred:0.02490006759762764, decouple_loss:0.01453670859336853
Iteration: 986, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.446827232837677
loss_pred:0.02466006763279438, decouple_loss:0.014810722321271896
The generated pressure mean: 0.44797003269195557
loss_pred:0.025924980640411377, decouple_loss:0.01551747228950262
The generated pressure mean: 0.44808927178382874
loss_pred:0.02574145421385765, decouple_loss:0.015704752877354622
Iteration: 987, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44728606939315796
loss_pred:0.02745867520570755, decouple_loss:0.014094680547714233
The generated pressure mean: 0.4470423758029938
loss_pred:0.025278113782405853, decouple_loss:0.014335472136735916
The generated pressure mean: 0.44698649644851685
loss_pred:0.02615162543952465, decouple_loss:0.014302564784884453
Iteration: 988, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4479195177555084
loss_pred:0.02427833341062069, decouple_loss:0.015294683165848255
The generated pressure mean: 0.44719424843788147
loss_pred:0.024992113932967186, decouple_loss:0.015424220822751522
The generated pressure mean: 0.4487459063529968
loss_pred:0.024949265643954277, decouple_loss:0.015959398820996284
Iteration: 989, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44817429780960083
loss_pred:0.025408146902918816, decouple_loss:0.01398015208542347
The generated pressure mean: 0.44914767146110535
loss_pred:0.024625299498438835, decouple_loss:0.013767554424703121
The generated pressure mean: 0.4487767219543457
loss_pred:0.025573231279850006, decouple_loss:0.014100497588515282
Iteration: 990, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44650521874427795
loss_pred:0.025965595617890358, decouple_loss:0.014872206375002861
The generated pressure mean: 0.44687706232070923
loss_pred:0.024479879066348076, decouple_loss:0.013996514491736889
The generated pressure mean: 0.4472528100013733
loss_pred:0.025247789919376373, decouple_loss:0.014051094651222229
2023-04-16 05:23:09 testing...
The generated pressure mean: 0.4502691328525543
loss_pred:0.13951723277568817, decouple_loss:0.06723422557115555
The generated pressure mean: 0.45032185316085815
loss_pred:0.13742148876190186, decouple_loss:0.0683164894580841
The generated pressure mean: 0.4500316381454468
loss_pred:0.13855969905853271, decouple_loss:0.06811075657606125
Loss: 0.14189383387565613, avg_mse: 0.2646653652191162
current test mse: 0.264665
Iteration: 991, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44854027032852173
loss_pred:0.025027582421898842, decouple_loss:0.015237564221024513
The generated pressure mean: 0.44721370935440063
loss_pred:0.023791590705513954, decouple_loss:0.016940167173743248
The generated pressure mean: 0.449370414018631
loss_pred:0.024520589038729668, decouple_loss:0.015861814841628075
Iteration: 992, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4491695463657379
loss_pred:0.024908963590860367, decouple_loss:0.013363971374928951
The generated pressure mean: 0.4472644329071045
loss_pred:0.025169968605041504, decouple_loss:0.014243217185139656
The generated pressure mean: 0.4480339288711548
loss_pred:0.025240261107683182, decouple_loss:0.013530464842915535
Iteration: 993, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44625839591026306
loss_pred:0.026138100773096085, decouple_loss:0.015124964527785778
The generated pressure mean: 0.44672060012817383
loss_pred:0.024822263047099113, decouple_loss:0.013769020326435566
The generated pressure mean: 0.4494103491306305
loss_pred:0.02424568682909012, decouple_loss:0.014600254595279694
Iteration: 994, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4474930763244629
The generated pressure mean: 0.4483846426010132
loss_pred:0.02527111954987049, decouple_loss:0.014606424607336521
loss_pred:0.023517196998000145, decouple_loss:0.01475033350288868
The generated pressure mean: 0.4468986690044403
loss_pred:0.023874914273619652, decouple_loss:0.0152458306401968
Iteration: 995, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44762107729911804
loss_pred:0.02499241568148136, decouple_loss:0.013425618410110474
The generated pressure mean: 0.44583117961883545
loss_pred:0.024240601807832718, decouple_loss:0.013136002235114574
The generated pressure mean: 0.44683364033699036
loss_pred:0.026721462607383728, decouple_loss:0.014005858451128006
Iteration: 996, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44639891386032104
loss_pred:0.025229433551430702, decouple_loss:0.014477850869297981
The generated pressure mean: 0.44739729166030884
loss_pred:0.023787425830960274, decouple_loss:0.01509764976799488
The generated pressure mean: 0.44792136549949646
loss_pred:0.024670297279953957, decouple_loss:0.01572401449084282
Iteration: 997, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4478371739387512
loss_pred:0.023996790871024132, decouple_loss:0.013705378398299217
The generated pressure mean: 0.4477873146533966
loss_pred:0.02591785043478012, decouple_loss:0.013377209194004536
The generated pressure mean: 0.4494319260120392
loss_pred:0.025981569662690163, decouple_loss:0.013449209742248058
Iteration: 998, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4466046094894409
The generated pressure mean: 0.4480442702770233
loss_pred:0.026110658422112465, decouple_loss:0.01515791192650795
loss_pred:0.024250542744994164, decouple_loss:0.014188665896654129
The generated pressure mean: 0.44656726717948914
loss_pred:0.02477334253489971, decouple_loss:0.015795564278960228
Iteration: 999, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44586294889450073
loss_pred:0.02665223740041256, decouple_loss:0.01444954238831997
The generated pressure mean: 0.4467812776565552
loss_pred:0.025204986333847046, decouple_loss:0.013674273155629635
The generated pressure mean: 0.4468448758125305
loss_pred:0.024380898103117943, decouple_loss:0.013608632609248161
Iteration: 1000, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4488758146762848
loss_pred:0.024358034133911133, decouple_loss:0.016415519639849663
The generated pressure mean: 0.4481664299964905
loss_pred:0.024475255981087685, decouple_loss:0.015365011990070343
The generated pressure mean: 0.44640007615089417
loss_pred:0.026462772861123085, decouple_loss:0.01494760811328888
2023-04-16 05:25:15 itr: 1000
training loss: [0.02721015 0.02524351 0.02517881]
2023-04-16 05:25:15 testing...
The generated pressure mean: 0.4502691626548767
loss_pred:0.13840068876743317, decouple_loss:0.06447413563728333
The generated pressure mean: 0.4503237009048462
loss_pred:0.13623955845832825, decouple_loss:0.06428851187229156
The generated pressure mean: 0.45002949237823486
loss_pred:0.13711285591125488, decouple_loss:0.06427115201950073
Loss: 0.1404682695865631, avg_mse: 0.2616521120071411
current test mse: 0.261652
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012014_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012014_3_24hr.npz
NaN value num: 0
Iteration: 1001, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4468020498752594
loss_pred:0.02639084868133068, decouple_loss:0.014557365328073502
The generated pressure mean: 0.44711068272590637
loss_pred:0.024500759318470955, decouple_loss:0.014425969682633877
The generated pressure mean: 0.4480834901332855
loss_pred:0.024876706302165985, decouple_loss:0.014258463867008686
Iteration: 1002, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.448355495929718
loss_pred:0.025517662987113, decouple_loss:0.01570604182779789
The generated pressure mean: 0.4472281038761139
loss_pred:0.025587035343050957, decouple_loss:0.014335683546960354
The generated pressure mean: 0.44641098380088806
loss_pred:0.024699421599507332, decouple_loss:0.015378342941403389
Iteration: 1003, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44734856486320496
loss_pred:0.025807395577430725, decouple_loss:0.01564449444413185
The generated pressure mean: 0.4480783939361572
The generated pressure mean: 0.4481714069843292
loss_pred:0.026245184242725372, decouple_loss:0.016048263758420944
loss_pred:0.025009676814079285, decouple_loss:0.015853632241487503
Iteration: 1004, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.447119802236557
loss_pred:0.024715272709727287, decouple_loss:0.015163307078182697
The generated pressure mean: 0.44785237312316895
loss_pred:0.02713024988770485, decouple_loss:0.014639128930866718
The generated pressure mean: 0.4478254020214081
loss_pred:0.025220626965165138, decouple_loss:0.015177047811448574
Iteration: 1005, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44898271560668945
The generated pressure mean: 0.44647419452667236loss_pred:0.026779279112815857, decouple_loss:0.015081970952451229
loss_pred:0.02500182017683983, decouple_loss:0.015513832680881023
The generated pressure mean: 0.44702187180519104
loss_pred:0.024378057569265366, decouple_loss:0.015932846814393997
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1006, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44860538840293884
The generated pressure mean: 0.4471984803676605
loss_pred:0.02471116930246353, decouple_loss:0.015529272146522999
loss_pred:0.025831321254372597, decouple_loss:0.015543363988399506
The generated pressure mean: 0.44733330607414246
loss_pred:0.025149144232273102, decouple_loss:0.016216134652495384
Iteration: 1007, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4468136131763458
loss_pred:0.02546609565615654, decouple_loss:0.01390409842133522
The generated pressure mean: 0.4470655620098114
loss_pred:0.02441560849547386, decouple_loss:0.013648566789925098
The generated pressure mean: 0.4471399486064911
loss_pred:0.02864746004343033, decouple_loss:0.014145870693027973
Iteration: 1008, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44703540205955505
loss_pred:0.02506919950246811, decouple_loss:0.013250568881630898
The generated pressure mean: 0.4465283155441284
loss_pred:0.024824975058436394, decouple_loss:0.013990451581776142
The generated pressure mean: 0.44740474224090576
loss_pred:0.0234385896474123, decouple_loss:0.013661280274391174
Iteration: 1009, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4470451772212982
loss_pred:0.02535390667617321, decouple_loss:0.015724092721939087
The generated pressure mean: 0.44776231050491333
loss_pred:0.025878068059682846, decouple_loss:0.015422506257891655
The generated pressure mean: 0.44819244742393494
loss_pred:0.024471629410982132, decouple_loss:0.015154889784753323
Iteration: 1010, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4485912322998047
loss_pred:0.026064712554216385, decouple_loss:0.014181235805153847
The generated pressure mean: 0.4482254087924957
loss_pred:0.02477901242673397, decouple_loss:0.013343618251383305
The generated pressure mean: 0.4479807913303375
loss_pred:0.02575005404651165, decouple_loss:0.013596665114164352
2023-04-16 05:27:59 testing...
The generated pressure mean: 0.4502691626548767
loss_pred:0.14065194129943848, decouple_loss:0.06445268541574478
The generated pressure mean: 0.45002955198287964
loss_pred:0.13947026431560516, decouple_loss:0.06482337415218353
The generated pressure mean: 0.4503231644630432
loss_pred:0.13846126198768616, decouple_loss:0.0651714950799942
Loss: 0.14276862144470215, avg_mse: 0.26735150814056396
current test mse: 0.267352
Iteration: 1011, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4461732506752014
loss_pred:0.024468710646033287, decouple_loss:0.013973199762403965
The generated pressure mean: 0.4463294744491577
loss_pred:0.02600463293492794, decouple_loss:0.013672588393092155
The generated pressure mean: 0.44707801938056946
loss_pred:0.02608077973127365, decouple_loss:0.013090022839605808
Iteration: 1012, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44728660583496094
loss_pred:0.026299254968762398, decouple_loss:0.015843404456973076
The generated pressure mean: 0.4475492537021637
loss_pred:0.024307360872626305, decouple_loss:0.01503146905452013
The generated pressure mean: 0.4474712014198303
loss_pred:0.024515634402632713, decouple_loss:0.015232507139444351
Iteration: 1013, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44649651646614075
loss_pred:0.02384321577847004, decouple_loss:0.013466507196426392
The generated pressure mean: 0.4475412964820862
The generated pressure mean: 0.4472735524177551
loss_pred:0.02575094811618328, decouple_loss:0.013369319960474968
loss_pred:0.02586488611996174, decouple_loss:0.013419989496469498
Iteration: 1014, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4465932846069336
loss_pred:0.02427995577454567, decouple_loss:0.013143034651875496
The generated pressure mean: 0.446645051240921
loss_pred:0.024644926190376282, decouple_loss:0.013282602652907372
The generated pressure mean: 0.4484168291091919
loss_pred:0.025328343734145164, decouple_loss:0.01419371459633112
Iteration: 1015, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4471074938774109
The generated pressure mean: 0.4479682445526123
loss_pred:0.024907860904932022, decouple_loss:0.014350038021802902
loss_pred:0.023387044668197632, decouple_loss:0.014435556717216969
The generated pressure mean: 0.4480119049549103
loss_pred:0.025835908949375153, decouple_loss:0.014072153717279434
Iteration: 1016, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.448516845703125
loss_pred:0.02495366707444191, decouple_loss:0.013607176952064037
The generated pressure mean: 0.4466298222541809
loss_pred:0.024501163512468338, decouple_loss:0.013732760213315487
The generated pressure mean: 0.446806937456131
loss_pred:0.02493450418114662, decouple_loss:0.013153006322681904
Iteration: 1017, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4462558329105377
loss_pred:0.025678640231490135, decouple_loss:0.01277637854218483
The generated pressure mean: 0.4467673599720001
loss_pred:0.02564643882215023, decouple_loss:0.012605086900293827
The generated pressure mean: 0.44605547189712524
loss_pred:0.025862667709589005, decouple_loss:0.013027939945459366
Iteration: 1018, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44761040806770325
The generated pressure mean: 0.4470239579677582
loss_pred:0.026693478226661682, decouple_loss:0.01390214916318655
loss_pred:0.024478936567902565, decouple_loss:0.013719657436013222
The generated pressure mean: 0.4468909800052643
loss_pred:0.026112638413906097, decouple_loss:0.013986541889607906
Iteration: 1019, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44714322686195374
loss_pred:0.024915311485528946, decouple_loss:0.013171697966754436
The generated pressure mean: 0.4486255347728729
loss_pred:0.024816034361720085, decouple_loss:0.014433587901294231
The generated pressure mean: 0.44586750864982605
loss_pred:0.02439947798848152, decouple_loss:0.014105756767094135
Iteration: 1020, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44649654626846313
loss_pred:0.026603199541568756, decouple_loss:0.013103079050779343
The generated pressure mean: 0.44819167256355286
loss_pred:0.025304144248366356, decouple_loss:0.013276357203722
The generated pressure mean: 0.44678938388824463
loss_pred:0.024211551994085312, decouple_loss:0.01264319010078907
2023-04-16 05:30:05 testing...
The generated pressure mean: 0.4502691626548767
loss_pred:0.1435055136680603, decouple_loss:0.06556019932031631
The generated pressure mean: 0.4503244161605835
loss_pred:0.14159883558750153, decouple_loss:0.06644380837678909
The generated pressure mean: 0.45003074407577515
loss_pred:0.14274437725543976, decouple_loss:0.06636878848075867
Loss: 0.14592245221138, avg_mse: 0.27316969633102417
current test mse: 0.27317
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012004_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012004_3_24hr.npz
NaN value num: 0
Iteration: 1021, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44720369577407837
loss_pred:0.026214126497507095, decouple_loss:0.013409079052507877
The generated pressure mean: 0.44922512769699097
loss_pred:0.02358953095972538, decouple_loss:0.013014563359320164
The generated pressure mean: 0.4482317268848419
loss_pred:0.02433117665350437, decouple_loss:0.013044431805610657
Iteration: 1022, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4487015902996063
loss_pred:0.02423347905278206, decouple_loss:0.013535666279494762
The generated pressure mean: 0.4484158456325531
loss_pred:0.025131046772003174, decouple_loss:0.013916938565671444
The generated pressure mean: 0.4480215311050415
loss_pred:0.02363010309636593, decouple_loss:0.013509992510080338
Iteration: 1023, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44889289140701294
loss_pred:0.025881962850689888, decouple_loss:0.013287351466715336
The generated pressure mean: 0.44785839319229126
loss_pred:0.026100974529981613, decouple_loss:0.013254890218377113
The generated pressure mean: 0.44839662313461304
loss_pred:0.024595173075795174, decouple_loss:0.01343494188040495
Iteration: 1024, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4482657015323639The generated pressure mean: 0.4472663998603821
loss_pred:0.02568138763308525, decouple_loss:0.014064558781683445
loss_pred:0.02715282514691353, decouple_loss:0.014645373448729515
The generated pressure mean: 0.446610689163208
loss_pred:0.026364697143435478, decouple_loss:0.013901644386351109
Iteration: 1025, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4478282034397125The generated pressure mean: 0.44785076379776
loss_pred:0.025064587593078613, decouple_loss:0.01259218342602253
loss_pred:0.02570336125791073, decouple_loss:0.013122324831783772
The generated pressure mean: 0.448419451713562
loss_pred:0.024148544296622276, decouple_loss:0.01276362407952547
Iteration: 1026, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4481973350048065
loss_pred:0.024125097319483757, decouple_loss:0.012262767180800438
The generated pressure mean: 0.44863271713256836
loss_pred:0.024511123076081276, decouple_loss:0.01253112405538559
The generated pressure mean: 0.44776803255081177
loss_pred:0.024956725537776947, decouple_loss:0.013031005859375
Iteration: 1027, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4487707316875458
loss_pred:0.02274385653436184, decouple_loss:0.013407150283455849
The generated pressure mean: 0.4472714066505432
loss_pred:0.024452170357108116, decouple_loss:0.013603533618152142
The generated pressure mean: 0.4472261667251587
loss_pred:0.024024080485105515, decouple_loss:0.013301036320626736
Iteration: 1028, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44791314005851746
loss_pred:0.02537781558930874, decouple_loss:0.01302553154528141
The generated pressure mean: 0.4481864273548126
loss_pred:0.02516579069197178, decouple_loss:0.012898862361907959
The generated pressure mean: 0.448110431432724
loss_pred:0.02492288127541542, decouple_loss:0.013247943483293056
Iteration: 1029, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.448044091463089The generated pressure mean: 0.4467661678791046
loss_pred:0.02479928731918335, decouple_loss:0.012515564449131489
loss_pred:0.024511955678462982, decouple_loss:0.013143695890903473
The generated pressure mean: 0.4468970000743866
loss_pred:0.025119168683886528, decouple_loss:0.013130968436598778
Iteration: 1030, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44820648431777954
loss_pred:0.024846497923135757, decouple_loss:0.013810441829264164
The generated pressure mean: 0.4464298486709595
loss_pred:0.024720970541238785, decouple_loss:0.013116245158016682
The generated pressure mean: 0.4485269784927368
loss_pred:0.024616841226816177, decouple_loss:0.013281887397170067
2023-04-16 05:32:54 testing...
The generated pressure mean: 0.4502691626548767
loss_pred:0.1355236917734146, decouple_loss:0.05946430191397667
The generated pressure mean: 0.4503245949745178
loss_pred:0.13316340744495392, decouple_loss:0.060246068984270096
The generated pressure mean: 0.45003077387809753
loss_pred:0.13431157171726227, decouple_loss:0.06015162542462349
Loss: 0.13733059167861938, avg_mse: 0.25267520546913147
current test mse: 0.252675
Iteration: 1031, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4478948414325714The generated pressure mean: 0.44741690158843994
loss_pred:0.025228226557374, decouple_loss:0.012870967388153076
loss_pred:0.024282749742269516, decouple_loss:0.012919829227030277
The generated pressure mean: 0.4480876624584198
loss_pred:0.023811496794223785, decouple_loss:0.012602346949279308
Iteration: 1032, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44874706864356995
loss_pred:0.025801174342632294, decouple_loss:0.013189208693802357
The generated pressure mean: 0.4487311840057373
loss_pred:0.023906229063868523, decouple_loss:0.013042769394814968
The generated pressure mean: 0.44788601994514465
loss_pred:0.024209747090935707, decouple_loss:0.012631027027964592
Iteration: 1033, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4484390318393707
The generated pressure mean: 0.4486182928085327loss_pred:0.023584293201565742, decouple_loss:0.013026751577854156
loss_pred:0.023854553699493408, decouple_loss:0.013053457252681255
The generated pressure mean: 0.44733527302742004
loss_pred:0.025678565725684166, decouple_loss:0.013548726215958595
Iteration: 1034, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44843852519989014
loss_pred:0.025164103135466576, decouple_loss:0.013345425948500633
The generated pressure mean: 0.4485006332397461
loss_pred:0.02512856386601925, decouple_loss:0.013421347364783287
The generated pressure mean: 0.44869038462638855
loss_pred:0.025211218744516373, decouple_loss:0.013162104412913322
Iteration: 1035, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4468400478363037
loss_pred:0.0235682912170887, decouple_loss:0.01398029550909996
The generated pressure mean: 0.44834741950035095
loss_pred:0.024026308208703995, decouple_loss:0.014026584103703499
The generated pressure mean: 0.4482976496219635
loss_pred:0.024454645812511444, decouple_loss:0.013934627175331116
Iteration: 1036, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4479096233844757
loss_pred:0.025472279638051987, decouple_loss:0.013578836806118488
The generated pressure mean: 0.44699862599372864
loss_pred:0.02391909807920456, decouple_loss:0.01455081719905138
The generated pressure mean: 0.44790342450141907
loss_pred:0.024584723636507988, decouple_loss:0.014102866873145103
Iteration: 1037, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4486675262451172
loss_pred:0.024786030873656273, decouple_loss:0.013820599764585495
The generated pressure mean: 0.44885286688804626
loss_pred:0.024228423833847046, decouple_loss:0.013594898395240307
The generated pressure mean: 0.4472554922103882
loss_pred:0.023921286687254906, decouple_loss:0.012792984023690224
Iteration: 1038, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4486727714538574
loss_pred:0.02345796301960945, decouple_loss:0.014408855699002743
The generated pressure mean: 0.44758883118629456
loss_pred:0.026702217757701874, decouple_loss:0.01441572792828083
The generated pressure mean: 0.44774019718170166
loss_pred:0.024566007778048515, decouple_loss:0.015490632504224777
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1039, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44615209102630615
loss_pred:0.02478664554655552, decouple_loss:0.015263529494404793
The generated pressure mean: 0.446638286113739
loss_pred:0.025217346847057343, decouple_loss:0.014436052180826664
The generated pressure mean: 0.44920697808265686
loss_pred:0.024326926097273827, decouple_loss:0.014390642754733562
Iteration: 1040, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44856584072113037
loss_pred:0.023635195568203926, decouple_loss:0.012831556610763073
The generated pressure mean: 0.44891056418418884
loss_pred:0.023532062768936157, decouple_loss:0.013508802279829979
The generated pressure mean: 0.4472510516643524
loss_pred:0.02351239323616028, decouple_loss:0.013466321863234043
2023-04-16 05:35:01 testing...
The generated pressure mean: 0.4502691924571991
loss_pred:0.13802292943000793, decouple_loss:0.06382878869771957
The generated pressure mean: 0.45032182335853577
loss_pred:0.13597138226032257, decouple_loss:0.06492231786251068
The generated pressure mean: 0.4500299394130707
loss_pred:0.13715030252933502, decouple_loss:0.06439413130283356
Loss: 0.1402672976255417, avg_mse: 0.2611407935619354
current test mse: 0.261141
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012008_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012008_3_24hr.npz
NaN value num: 0
Iteration: 1041, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4497527778148651
loss_pred:0.02260257676243782, decouple_loss:0.01650601252913475
The generated pressure mean: 0.44836869835853577
loss_pred:0.025010311976075172, decouple_loss:0.014980975538492203
The generated pressure mean: 0.44755056500434875
loss_pred:0.023448191583156586, decouple_loss:0.0161567535251379
Iteration: 1042, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44904786348342896
loss_pred:0.024408219382166862, decouple_loss:0.013797761872410774
The generated pressure mean: 0.44835564494132996
loss_pred:0.024049190804362297, decouple_loss:0.014025083743035793
The generated pressure mean: 0.44861823320388794
loss_pred:0.023051690310239792, decouple_loss:0.013948839157819748
Iteration: 1043, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4474759101867676
loss_pred:0.024988720193505287, decouple_loss:0.013448400422930717
The generated pressure mean: 0.44919583201408386
loss_pred:0.02315044403076172, decouple_loss:0.013547136448323727
The generated pressure mean: 0.4474419057369232
loss_pred:0.024974554777145386, decouple_loss:0.014970564283430576
Iteration: 1044, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4486876428127289
loss_pred:0.02418758161365986, decouple_loss:0.013055193237960339
The generated pressure mean: 0.4488624334335327
loss_pred:0.023161306977272034, decouple_loss:0.013886294327676296
The generated pressure mean: 0.448393315076828
loss_pred:0.02432892844080925, decouple_loss:0.013769501820206642
Iteration: 1045, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44878309965133667
The generated pressure mean: 0.4485044479370117
loss_pred:0.022803906351327896, decouple_loss:0.013569514267146587
loss_pred:0.026840027421712875, decouple_loss:0.014239511452615261
The generated pressure mean: 0.4479593336582184
loss_pred:0.023744063451886177, decouple_loss:0.014100422151386738
Iteration: 1046, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4489688575267792
loss_pred:0.023632969707250595, decouple_loss:0.013929666951298714
The generated pressure mean: 0.4485994577407837
loss_pred:0.02252429723739624, decouple_loss:0.013186710886657238
The generated pressure mean: 0.44889727234840393
loss_pred:0.024186469614505768, decouple_loss:0.013222422450780869
Iteration: 1047, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4490088224411011
loss_pred:0.02315814048051834, decouple_loss:0.01338927261531353
The generated pressure mean: 0.4485214948654175
loss_pred:0.024213867262005806, decouple_loss:0.012788654305040836
The generated pressure mean: 0.4474983811378479
loss_pred:0.024255650117993355, decouple_loss:0.014299537986516953
Iteration: 1048, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44992268085479736
The generated pressure mean: 0.44867855310440063
loss_pred:0.02375826984643936, decouple_loss:0.012854219414293766
loss_pred:0.02187519520521164, decouple_loss:0.013476260006427765
The generated pressure mean: 0.4487330913543701
loss_pred:0.02365175075829029, decouple_loss:0.013349696062505245
Iteration: 1049, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44701242446899414
The generated pressure mean: 0.44855383038520813
loss_pred:0.023739315569400787, decouple_loss:0.013998284935951233
loss_pred:0.022729050368070602, decouple_loss:0.013912401162087917
The generated pressure mean: 0.44957759976387024
loss_pred:0.022485682740807533, decouple_loss:0.014005880802869797
Iteration: 1050, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4481935501098633
loss_pred:0.025361020117998123, decouple_loss:0.014857587404549122
The generated pressure mean: 0.4479380249977112
loss_pred:0.02325129695236683, decouple_loss:0.013093002140522003
The generated pressure mean: 0.4503513276576996
loss_pred:0.02310761995613575, decouple_loss:0.0141732944175601
2023-04-16 05:37:44 testing...
The generated pressure mean: 0.4502691328525543
loss_pred:0.14104630053043365, decouple_loss:0.0647323876619339
The generated pressure mean: 0.4503233730792999
loss_pred:0.13872112333774567, decouple_loss:0.06518616527318954
The generated pressure mean: 0.45002982020378113
loss_pred:0.13974736630916595, decouple_loss:0.06500562280416489
Loss: 0.1430869996547699, avg_mse: 0.2683402895927429
current test mse: 0.26834
Iteration: 1051, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44956105947494507
loss_pred:0.024258291348814964, decouple_loss:0.014182741753757
The generated pressure mean: 0.4477326571941376
loss_pred:0.023457450792193413, decouple_loss:0.012838596478104591
The generated pressure mean: 0.44674795866012573
loss_pred:0.02553003653883934, decouple_loss:0.012924843467772007
Iteration: 1052, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.447360634803772
loss_pred:0.02517099678516388, decouple_loss:0.013457993045449257
The generated pressure mean: 0.44832995533943176
The generated pressure mean: 0.44814857840538025
loss_pred:0.023417064920067787, decouple_loss:0.012142232619225979
loss_pred:0.02342851832509041, decouple_loss:0.013109544292092323
Iteration: 1053, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44825026392936707
The generated pressure mean: 0.44883501529693604
loss_pred:0.024073753505945206, decouple_loss:0.012456568889319897
loss_pred:0.02301766909658909, decouple_loss:0.01204821839928627
The generated pressure mean: 0.448231965303421
loss_pred:0.023771941661834717, decouple_loss:0.012882906943559647
Iteration: 1054, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44808724522590637
loss_pred:0.02420160360634327, decouple_loss:0.012761670164763927
The generated pressure mean: 0.45005467534065247
loss_pred:0.022442638874053955, decouple_loss:0.014235328882932663
The generated pressure mean: 0.448560893535614
loss_pred:0.022809896618127823, decouple_loss:0.012714247219264507
Iteration: 1055, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.447257399559021
The generated pressure mean: 0.4477047622203827
loss_pred:0.023169418796896935, decouple_loss:0.012139473110437393
loss_pred:0.02454894594848156, decouple_loss:0.012595215812325478
The generated pressure mean: 0.44784337282180786
loss_pred:0.02352246642112732, decouple_loss:0.012578885070979595
Iteration: 1056, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4474886953830719
The generated pressure mean: 0.4474472403526306loss_pred:0.024484962224960327, decouple_loss:0.011799672618508339
loss_pred:0.02449336089193821, decouple_loss:0.011830154806375504
The generated pressure mean: 0.44832366704940796
loss_pred:0.023659251630306244, decouple_loss:0.011366473510861397
Iteration: 1057, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44914862513542175
The generated pressure mean: 0.4470272958278656loss_pred:0.023626331239938736, decouple_loss:0.012509722262620926
loss_pred:0.023395545780658722, decouple_loss:0.012625863775610924
The generated pressure mean: 0.4477759301662445
loss_pred:0.023953452706336975, decouple_loss:0.012230313383042812
Iteration: 1058, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44892796874046326The generated pressure mean: 0.4482021629810333
loss_pred:0.024041060358285904, decouple_loss:0.012503810226917267
loss_pred:0.02280365861952305, decouple_loss:0.0119257727637887
The generated pressure mean: 0.44800934195518494
loss_pred:0.022711724042892456, decouple_loss:0.011665812693536282
Iteration: 1059, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4490877091884613
The generated pressure mean: 0.44847655296325684loss_pred:0.02335190214216709, decouple_loss:0.014673668891191483
loss_pred:0.022511819377541542, decouple_loss:0.013248252682387829
The generated pressure mean: 0.44848981499671936
loss_pred:0.024733934551477432, decouple_loss:0.013967924751341343
Iteration: 1060, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44854578375816345
loss_pred:0.02365182340145111, decouple_loss:0.013906094245612621
The generated pressure mean: 0.44717898964881897
loss_pred:0.024404706433415413, decouple_loss:0.015235473401844501
The generated pressure mean: 0.4478406608104706
loss_pred:0.02370830811560154, decouple_loss:0.014462986961007118
2023-04-16 05:39:49 testing...
The generated pressure mean: 0.4502691924571991
loss_pred:0.14133256673812866, decouple_loss:0.06565093994140625
The generated pressure mean: 0.45032238960266113
loss_pred:0.1388547271490097, decouple_loss:0.06622055172920227
The generated pressure mean: 0.45003142952919006
loss_pred:0.14014960825443268, decouple_loss:0.06607624143362045
Loss: 0.14341142773628235, avg_mse: 0.26890718936920166
current test mse: 0.268907
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012003_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012003_3_24hr.npz
NaN value num: 0
Iteration: 1061, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4477705657482147
loss_pred:0.025781918317079544, decouple_loss:0.012947616167366505
The generated pressure mean: 0.4477221667766571
loss_pred:0.02674800716340542, decouple_loss:0.013300794176757336
The generated pressure mean: 0.4487011730670929
loss_pred:0.024540580809116364, decouple_loss:0.013209049589931965
Iteration: 1062, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44901716709136963
The generated pressure mean: 0.44898468255996704
loss_pred:0.024336472153663635, decouple_loss:0.012862235307693481
loss_pred:0.025494908913969994, decouple_loss:0.013095025904476643
The generated pressure mean: 0.4483485221862793
loss_pred:0.024157244712114334, decouple_loss:0.013135461136698723
Iteration: 1063, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4492354691028595
loss_pred:0.024196863174438477, decouple_loss:0.013912499882280827
The generated pressure mean: 0.4489874839782715
loss_pred:0.02523689530789852, decouple_loss:0.014606159180402756
The generated pressure mean: 0.44931483268737793
loss_pred:0.024002986028790474, decouple_loss:0.014368457719683647
Iteration: 1064, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4488268494606018
loss_pred:0.024348611012101173, decouple_loss:0.013330252841114998
The generated pressure mean: 0.44898614287376404
loss_pred:0.024523237720131874, decouple_loss:0.012845102697610855
The generated pressure mean: 0.4486256539821625
loss_pred:0.02387985587120056, decouple_loss:0.013463204726576805
Iteration: 1065, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4479125738143921
The generated pressure mean: 0.448932945728302
loss_pred:0.022873083129525185, decouple_loss:0.013203894719481468
loss_pred:0.024050330743193626, decouple_loss:0.01238260604441166
The generated pressure mean: 0.44878900051116943
loss_pred:0.025073586031794548, decouple_loss:0.012722248211503029
Iteration: 1066, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4480917155742645
loss_pred:0.02412724681198597, decouple_loss:0.012726959772408009
The generated pressure mean: 0.4486011564731598
loss_pred:0.023534953594207764, decouple_loss:0.012871311977505684
The generated pressure mean: 0.4488048851490021
loss_pred:0.024847129359841347, decouple_loss:0.012626705691218376
Iteration: 1067, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44882020354270935
loss_pred:0.0267535001039505, decouple_loss:0.012757410295307636
The generated pressure mean: 0.44916167855262756
loss_pred:0.023602435365319252, decouple_loss:0.013959469273686409
The generated pressure mean: 0.4486151337623596
loss_pred:0.02410348504781723, decouple_loss:0.01357810664921999
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1068, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4481390416622162
loss_pred:0.023725416511297226, decouple_loss:0.0119951656088233
The generated pressure mean: 0.45027968287467957
loss_pred:0.02528950572013855, decouple_loss:0.01240018755197525
The generated pressure mean: 0.45003050565719604
loss_pred:0.025838064029812813, decouple_loss:0.012445082888007164
Iteration: 1069, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44927823543548584
loss_pred:0.025286318734288216, decouple_loss:0.01443872507661581
The generated pressure mean: 0.44796881079673767
loss_pred:0.022572096437215805, decouple_loss:0.013571732677519321
The generated pressure mean: 0.44795140624046326
loss_pred:0.02418224699795246, decouple_loss:0.014008394442498684
Iteration: 1070, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44830310344696045
loss_pred:0.024835893884301186, decouple_loss:0.01441320963203907
The generated pressure mean: 0.45008406043052673
loss_pred:0.023601245135068893, decouple_loss:0.014361529611051083
The generated pressure mean: 0.44798728823661804
loss_pred:0.025409003719687462, decouple_loss:0.014314613305032253
2023-04-16 05:42:32 testing...
The generated pressure mean: 0.4502691924571991
loss_pred:0.1378287971019745, decouple_loss:0.061767566949129105
The generated pressure mean: 0.4503237009048462
loss_pred:0.13491711020469666, decouple_loss:0.0627344623208046
The generated pressure mean: 0.45003244280815125
loss_pred:0.13623493909835815, decouple_loss:0.0625334084033966
Loss: 0.13944421708583832, avg_mse: 0.25964635610580444
current test mse: 0.259646
Iteration: 1071, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4487118124961853
The generated pressure mean: 0.44817784428596497
loss_pred:0.023472784087061882, decouple_loss:0.013678369112312794
loss_pred:0.026227522641420364, decouple_loss:0.014269518665969372
The generated pressure mean: 0.44885265827178955
loss_pred:0.024924755096435547, decouple_loss:0.014169382862746716
Iteration: 1072, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4479510188102722
The generated pressure mean: 0.4497663676738739
The generated pressure mean: 0.44834861159324646
loss_pred:0.022839829325675964, decouple_loss:0.01728561520576477
loss_pred:0.02377869375050068, decouple_loss:0.015998657792806625
loss_pred:0.023239068686962128, decouple_loss:0.016924254596233368
Iteration: 1073, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4484209716320038
loss_pred:0.02357626147568226, decouple_loss:0.015264799818396568
The generated pressure mean: 0.44904643297195435
loss_pred:0.02329757809638977, decouple_loss:0.015408171340823174The generated pressure mean: 0.44820237159729004
loss_pred:0.023741085082292557, decouple_loss:0.015418477356433868
Iteration: 1074, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4497607350349426
loss_pred:0.023981863632798195, decouple_loss:0.016586197540163994
The generated pressure mean: 0.4486684203147888
loss_pred:0.02287776581943035, decouple_loss:0.016439054161310196
The generated pressure mean: 0.44785329699516296
loss_pred:0.02345232293009758, decouple_loss:0.016588406637310982
Iteration: 1075, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44918203353881836
loss_pred:0.02398953028023243, decouple_loss:0.016475040465593338
The generated pressure mean: 0.4491823613643646
loss_pred:0.025169793516397476, decouple_loss:0.016032453626394272
The generated pressure mean: 0.4505299925804138
loss_pred:0.024493249133229256, decouple_loss:0.01536815706640482
Iteration: 1076, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44778186082839966
loss_pred:0.02284076251089573, decouple_loss:0.015403306111693382
The generated pressure mean: 0.4509533941745758
loss_pred:0.024289099499583244, decouple_loss:0.014873329550027847
The generated pressure mean: 0.4476814270019531
loss_pred:0.024429142475128174, decouple_loss:0.015301860868930817
Iteration: 1077, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4488624036312103The generated pressure mean: 0.44828855991363525
loss_pred:0.02567736804485321, decouple_loss:0.015442918986082077loss_pred:0.02499995008111, decouple_loss:0.014915278181433678
The generated pressure mean: 0.44808143377304077
loss_pred:0.02486669272184372, decouple_loss:0.015355512499809265
Iteration: 1078, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4490931034088135
loss_pred:0.024562690407037735, decouple_loss:0.014041509479284286
The generated pressure mean: 0.4489031136035919
loss_pred:0.02480243518948555, decouple_loss:0.013596189208328724
The generated pressure mean: 0.44842997193336487
loss_pred:0.025589751079678535, decouple_loss:0.01375076174736023
Iteration: 1079, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4482561945915222
loss_pred:0.022466370835900307, decouple_loss:0.015338975936174393
The generated pressure mean: 0.44873902201652527
loss_pred:0.025560857728123665, decouple_loss:0.015748152509331703
The generated pressure mean: 0.4476792514324188
loss_pred:0.023535890504717827, decouple_loss:0.015873031690716743
Iteration: 1080, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4479861259460449
The generated pressure mean: 0.4485109746456146
loss_pred:0.023530032485723495, decouple_loss:0.014007116667926311
loss_pred:0.0248685535043478, decouple_loss:0.013546527363359928
The generated pressure mean: 0.44839778542518616
loss_pred:0.02485167235136032, decouple_loss:0.01362012978643179
2023-04-16 05:44:38 testing...
The generated pressure mean: 0.4502691924571991
loss_pred:0.1393793374300003, decouple_loss:0.06276988983154297
The generated pressure mean: 0.45032304525375366
loss_pred:0.13747119903564453, decouple_loss:0.06314273178577423
The generated pressure mean: 0.4500311017036438
loss_pred:0.13833868503570557, decouple_loss:0.062449291348457336
Loss: 0.14153578877449036, avg_mse: 0.2644835412502289
current test mse: 0.264484
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012001_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012001_3_24hr.npz
NaN value num: 0
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1081, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44883793592453003
loss_pred:0.023450901731848717, decouple_loss:0.01456449180841446
The generated pressure mean: 0.4476655125617981
loss_pred:0.023565685376524925, decouple_loss:0.01489939447492361
The generated pressure mean: 0.44840019941329956
loss_pred:0.02417423389852047, decouple_loss:0.014733116142451763
Iteration: 1082, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4465446472167969
loss_pred:0.024513766169548035, decouple_loss:0.014571304433047771
The generated pressure mean: 0.4495854079723358The generated pressure mean: 0.4485287070274353
loss_pred:0.024800917133688927, decouple_loss:0.014359679073095322
loss_pred:0.022333797067403793, decouple_loss:0.01476194430142641
Iteration: 1083, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44723814725875854
The generated pressure mean: 0.44923239946365356
The generated pressure mean: 0.44872546195983887
loss_pred:0.02452397532761097, decouple_loss:0.014563269913196564
loss_pred:0.02496936172246933, decouple_loss:0.014672445133328438
loss_pred:0.024134062230587006, decouple_loss:0.01391043234616518
Iteration: 1084, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4476589262485504
loss_pred:0.02441864088177681, decouple_loss:0.01305430568754673
The generated pressure mean: 0.449007511138916
loss_pred:0.024166828021407127, decouple_loss:0.013420100323855877
The generated pressure mean: 0.44705435633659363
loss_pred:0.02479615807533264, decouple_loss:0.013855659402906895
Iteration: 1085, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4482494294643402
loss_pred:0.022344384342432022, decouple_loss:0.01416541263461113
The generated pressure mean: 0.447807252407074
loss_pred:0.023373855277895927, decouple_loss:0.014436098746955395
The generated pressure mean: 0.4488254189491272
loss_pred:0.022509248927235603, decouple_loss:0.013726335018873215
Iteration: 1086, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4471642076969147
loss_pred:0.02440614253282547, decouple_loss:0.014659185893833637
The generated pressure mean: 0.4484401047229767
loss_pred:0.023442097008228302, decouple_loss:0.014321405440568924
The generated pressure mean: 0.44807395339012146
loss_pred:0.023445671424269676, decouple_loss:0.013963735662400723
Iteration: 1087, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4487464129924774
loss_pred:0.02599431574344635, decouple_loss:0.014961675740778446
The generated pressure mean: 0.4475677013397217
loss_pred:0.02379031851887703, decouple_loss:0.015210321173071861
The generated pressure mean: 0.4469643235206604
loss_pred:0.02456383965909481, decouple_loss:0.014562880620360374
Iteration: 1088, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4491841197013855
loss_pred:0.023312585428357124, decouple_loss:0.013865967281162739
The generated pressure mean: 0.4484805762767792
loss_pred:0.02308649942278862, decouple_loss:0.014761582016944885
The generated pressure mean: 0.4469665288925171
loss_pred:0.025717640295624733, decouple_loss:0.013958970084786415
Iteration: 1089, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4473339915275574
loss_pred:0.02454749122262001, decouple_loss:0.0139772305265069
The generated pressure mean: 0.4463160037994385
loss_pred:0.02372322417795658, decouple_loss:0.014551249332726002
The generated pressure mean: 0.4493698477745056
loss_pred:0.022957423701882362, decouple_loss:0.014502309262752533
Iteration: 1090, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4477754235267639The generated pressure mean: 0.44759565591812134
loss_pred:0.023268194869160652, decouple_loss:0.014125899411737919loss_pred:0.023184796795248985, decouple_loss:0.014259690418839455
The generated pressure mean: 0.44938138127326965
loss_pred:0.02622651495039463, decouple_loss:0.014612040482461452
2023-04-16 05:47:28 testing...
The generated pressure mean: 0.4502691328525543
loss_pred:0.13389579951763153, decouple_loss:0.058977555483579636
The generated pressure mean: 0.4503243863582611
loss_pred:0.1321105659008026, decouple_loss:0.059188149869441986
The generated pressure mean: 0.45003020763397217
loss_pred:0.1331440657377243, decouple_loss:0.05886514112353325
Loss: 0.13600066304206848, avg_mse: 0.2530876398086548
current test mse: 0.253088
Iteration: 1091, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44786536693573
loss_pred:0.024917712435126305, decouple_loss:0.012970649637281895
The generated pressure mean: 0.44720545411109924
loss_pred:0.02363002486526966, decouple_loss:0.01244381070137024
The generated pressure mean: 0.4489254355430603
loss_pred:0.023550281301140785, decouple_loss:0.012510739266872406
Iteration: 1092, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44710734486579895
The generated pressure mean: 0.4461502432823181
loss_pred:0.026332415640354156, decouple_loss:0.014068511314690113
The generated pressure mean: 0.44672808051109314
loss_pred:0.023307351395487785, decouple_loss:0.01290574949234724
loss_pred:0.02774444967508316, decouple_loss:0.013988819904625416
Iteration: 1093, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4487268924713135
loss_pred:0.024439923465251923, decouple_loss:0.014064623974263668
The generated pressure mean: 0.44781580567359924
The generated pressure mean: 0.44701826572418213
loss_pred:0.024346068501472473, decouple_loss:0.013453413732349873
loss_pred:0.025582293048501015, decouple_loss:0.013791061006486416
Iteration: 1094, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4482365548610687
loss_pred:0.024629391729831696, decouple_loss:0.012996338307857513
The generated pressure mean: 0.44726356863975525
loss_pred:0.025622079148888588, decouple_loss:0.012422881089150906
The generated pressure mean: 0.44813084602355957
loss_pred:0.023646149784326553, decouple_loss:0.012717269361019135
Iteration: 1095, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44828084111213684
loss_pred:0.024218058213591576, decouple_loss:0.013384317979216576
The generated pressure mean: 0.4478795826435089
loss_pred:0.022912614047527313, decouple_loss:0.014077285304665565
The generated pressure mean: 0.44861769676208496
loss_pred:0.02216171659529209, decouple_loss:0.014525888487696648
Iteration: 1096, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44938987493515015
The generated pressure mean: 0.44801029562950134
loss_pred:0.024296456947922707, decouple_loss:0.013765774667263031
loss_pred:0.023323694244027138, decouple_loss:0.01274644024670124
The generated pressure mean: 0.4466077983379364
loss_pred:0.023359389975667, decouple_loss:0.012851311825215816
Iteration: 1097, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4485718905925751
The generated pressure mean: 0.44780001044273376loss_pred:0.023500338196754456, decouple_loss:0.013526340015232563
loss_pred:0.024724004790186882, decouple_loss:0.01394294761121273
The generated pressure mean: 0.44832611083984375
loss_pred:0.024279940873384476, decouple_loss:0.01382481213659048
Iteration: 1098, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4458083510398865The generated pressure mean: 0.44751808047294617
loss_pred:0.02335410937666893, decouple_loss:0.012505359947681427
loss_pred:0.024588819593191147, decouple_loss:0.012598179280757904
The generated pressure mean: 0.4471943974494934
loss_pred:0.02297329530119896, decouple_loss:0.01243080198764801
Iteration: 1099, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4468025863170624The generated pressure mean: 0.4478653073310852
loss_pred:0.025210535153746605, decouple_loss:0.012511970475316048loss_pred:0.024380240589380264, decouple_loss:0.011860771104693413
The generated pressure mean: 0.4486877918243408
loss_pred:0.024236805737018585, decouple_loss:0.01307172141969204
Iteration: 1100, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44764071702957153
The generated pressure mean: 0.4474485516548157
loss_pred:0.02572767622768879, decouple_loss:0.013314266689121723
loss_pred:0.02363789640367031, decouple_loss:0.013313241302967072
The generated pressure mean: 0.44860848784446716
loss_pred:0.023437127470970154, decouple_loss:0.013113145716488361
2023-04-16 05:49:33 testing...
The generated pressure mean: 0.4502691626548767
loss_pred:0.13679082691669464, decouple_loss:0.061555732041597366
The generated pressure mean: 0.4503248333930969
loss_pred:0.13450691103935242, decouple_loss:0.06194348260760307
The generated pressure mean: 0.4500297009944916
loss_pred:0.13536246120929718, decouple_loss:0.06154617667198181
Loss: 0.1386374980211258, avg_mse: 0.2568662762641907
current test mse: 0.256866
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012013_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012013_3_24hr.npz
NaN value num: 0
Iteration: 1101, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4468812048435211
loss_pred:0.02325441874563694, decouple_loss:0.012800085358321667
The generated pressure mean: 0.4479365050792694
loss_pred:0.024499520659446716, decouple_loss:0.012658325955271721
The generated pressure mean: 0.44669225811958313
loss_pred:0.024964991956949234, decouple_loss:0.0127285560593009
Iteration: 1102, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44830822944641113
loss_pred:0.023621128872036934, decouple_loss:0.014995243400335312
The generated pressure mean: 0.44709211587905884
loss_pred:0.024028558284044266, decouple_loss:0.014527775347232819
The generated pressure mean: 0.4477921426296234
loss_pred:0.023671584203839302, decouple_loss:0.014995606616139412
Iteration: 1103, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4484233856201172
loss_pred:0.023557135835289955, decouple_loss:0.013132842257618904
The generated pressure mean: 0.44707921147346497
The generated pressure mean: 0.447158545255661
loss_pred:0.02456868439912796, decouple_loss:0.01300358958542347
loss_pred:0.023435693234205246, decouple_loss:0.01243639923632145
Iteration: 1104, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4481637477874756
The generated pressure mean: 0.4482898414134979
loss_pred:0.024499038234353065, decouple_loss:0.013019489124417305
loss_pred:0.023033123463392258, decouple_loss:0.012655687518417835
The generated pressure mean: 0.44647836685180664
loss_pred:0.02476821281015873, decouple_loss:0.013327006250619888
Iteration: 1105, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44777369499206543
loss_pred:0.02336876094341278, decouple_loss:0.014865581877529621
The generated pressure mean: 0.4481060802936554
loss_pred:0.024416379630565643, decouple_loss:0.01443769782781601
The generated pressure mean: 0.4485245943069458
loss_pred:0.026567064225673676, decouple_loss:0.014105877839028835
Iteration: 1106, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4468018710613251
loss_pred:0.024079550057649612, decouple_loss:0.014192050322890282
The generated pressure mean: 0.4472237229347229
loss_pred:0.022976860404014587, decouple_loss:0.01261694822460413
The generated pressure mean: 0.4481797516345978
loss_pred:0.023698242381215096, decouple_loss:0.013412733562290668
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1107, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44729575514793396
The generated pressure mean: 0.4475480318069458
loss_pred:0.02421003393828869, decouple_loss:0.013147368095815182
loss_pred:0.023472728207707405, decouple_loss:0.012524896301329136
The generated pressure mean: 0.4463885724544525
loss_pred:0.023329198360443115, decouple_loss:0.012457547709345818
Iteration: 1108, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44692057371139526
loss_pred:0.025111479684710503, decouple_loss:0.013634366914629936
The generated pressure mean: 0.4476833939552307
loss_pred:0.02488321252167225, decouple_loss:0.013992346823215485
The generated pressure mean: 0.44681936502456665
loss_pred:0.023806998506188393, decouple_loss:0.013971411623060703
Iteration: 1109, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4475656747817993
loss_pred:0.0238448865711689, decouple_loss:0.01246016938239336
The generated pressure mean: 0.44766122102737427
loss_pred:0.022653212770819664, decouple_loss:0.012617425061762333
The generated pressure mean: 0.4468398094177246
loss_pred:0.02322014793753624, decouple_loss:0.013306695967912674
Iteration: 1110, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4480834901332855
loss_pred:0.02485046721994877, decouple_loss:0.012291624210774899
The generated pressure mean: 0.44623640179634094
loss_pred:0.025039879605174065, decouple_loss:0.011970994994044304
The generated pressure mean: 0.44712120294570923
loss_pred:0.02398543991148472, decouple_loss:0.012413366697728634
2023-04-16 05:52:13 testing...
The generated pressure mean: 0.4502691328525543
loss_pred:0.13841275870800018, decouple_loss:0.06341256201267242
The generated pressure mean: 0.4503239393234253
loss_pred:0.13628262281417847, decouple_loss:0.06369801610708237
The generated pressure mean: 0.45002830028533936
loss_pred:0.1373555213212967, decouple_loss:0.06342363357543945
Loss: 0.14052587747573853, avg_mse: 0.2631469666957855
current test mse: 0.263147
Iteration: 1111, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4475895166397095The generated pressure mean: 0.4473554491996765
The generated pressure mean: 0.4469582438468933loss_pred:0.02361210435628891, decouple_loss:0.012271774001419544
loss_pred:0.023871731013059616, decouple_loss:0.012384835630655289
loss_pred:0.024285560473799706, decouple_loss:0.012559608556330204
Iteration: 1112, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4478302299976349
The generated pressure mean: 0.4465617835521698
loss_pred:0.0226445309817791, decouple_loss:0.014414270408451557
loss_pred:0.02468222565948963, decouple_loss:0.01327830646187067
The generated pressure mean: 0.44753000140190125
loss_pred:0.022998344153165817, decouple_loss:0.013703515753149986
Iteration: 1113, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44731754064559937
loss_pred:0.02292867936193943, decouple_loss:0.012762629427015781
The generated pressure mean: 0.4475451111793518
loss_pred:0.023972129449248314, decouple_loss:0.01321080606430769
The generated pressure mean: 0.4479770064353943
loss_pred:0.024480747058987617, decouple_loss:0.012782390229403973
Iteration: 1114, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44761723279953003
loss_pred:0.0223524272441864, decouple_loss:0.011934266425669193
The generated pressure mean: 0.4478219449520111
loss_pred:0.023930955678224564, decouple_loss:0.012399452738463879
The generated pressure mean: 0.44707533717155457
loss_pred:0.026318814605474472, decouple_loss:0.012246119789779186
Iteration: 1115, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44818994402885437
loss_pred:0.024289187043905258, decouple_loss:0.014165857806801796
The generated pressure mean: 0.4472619593143463
loss_pred:0.023079095408320427, decouple_loss:0.012187955901026726
The generated pressure mean: 0.44804367423057556
loss_pred:0.022709324955940247, decouple_loss:0.012455693446099758
Iteration: 1116, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4468291997909546
The generated pressure mean: 0.44763222336769104
loss_pred:0.025020813569426537, decouple_loss:0.013959166593849659
loss_pred:0.022516656666994095, decouple_loss:0.014574031345546246
The generated pressure mean: 0.4461643099784851
loss_pred:0.023091105744242668, decouple_loss:0.01354976836591959
Iteration: 1117, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4473491311073303
The generated pressure mean: 0.44724005460739136
loss_pred:0.022497231140732765, decouple_loss:0.01213049329817295
loss_pred:0.024095291271805763, decouple_loss:0.011911178939044476
The generated pressure mean: 0.4471765160560608
loss_pred:0.02422880195081234, decouple_loss:0.012132849544286728
Iteration: 1118, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4481433928012848
loss_pred:0.022217828780412674, decouple_loss:0.01277699414640665
The generated pressure mean: 0.4471132755279541
loss_pred:0.022879380732774734, decouple_loss:0.014559516683220863
The generated pressure mean: 0.4470607042312622
loss_pred:0.023548949509859085, decouple_loss:0.013492749072611332
Iteration: 1119, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44719070196151733
loss_pred:0.024734465405344963, decouple_loss:0.012911209836602211
The generated pressure mean: 0.44665205478668213
loss_pred:0.02372916042804718, decouple_loss:0.013444320298731327
The generated pressure mean: 0.44754913449287415
loss_pred:0.02310662344098091, decouple_loss:0.013353951275348663
Iteration: 1120, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44802987575531006
loss_pred:0.025010310113430023, decouple_loss:0.012789766304194927
The generated pressure mean: 0.44710227847099304
loss_pred:0.023524004966020584, decouple_loss:0.012596345506608486
The generated pressure mean: 0.4463167190551758
loss_pred:0.025256216526031494, decouple_loss:0.012477577663958073
2023-04-16 05:54:19 testing...
The generated pressure mean: 0.4502691626548767
loss_pred:0.14017121493816376, decouple_loss:0.06135433912277222
The generated pressure mean: 0.4503231346607208
loss_pred:0.13825228810310364, decouple_loss:0.06177542358636856
The generated pressure mean: 0.45003077387809753
loss_pred:0.13938008248806, decouple_loss:0.06107761710882187
Loss: 0.14233797788619995, avg_mse: 0.26804909110069275
current test mse: 0.268049
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012002_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012002_3_24hr.npz
NaN value num: 0
Iteration: 1121, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4522303640842438
loss_pred:0.022572143003344536, decouple_loss:0.015202603302896023
The generated pressure mean: 0.44768646359443665
loss_pred:0.024794481694698334, decouple_loss:0.012959330342710018
The generated pressure mean: 0.44929999113082886
loss_pred:0.023110270500183105, decouple_loss:0.012933342717587948
Iteration: 1122, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4478306472301483
The generated pressure mean: 0.44865068793296814
loss_pred:0.022576207295060158, decouple_loss:0.013481193222105503
loss_pred:0.023721205070614815, decouple_loss:0.014247307553887367
The generated pressure mean: 0.44807079434394836
loss_pred:0.022545328363776207, decouple_loss:0.013899460434913635
Iteration: 1123, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4489396810531616
loss_pred:0.023115459829568863, decouple_loss:0.012967504560947418
The generated pressure mean: 0.45061105489730835
The generated pressure mean: 0.45037275552749634
loss_pred:0.022422822192311287, decouple_loss:0.013721576891839504
loss_pred:0.022583255544304848, decouple_loss:0.012959957122802734
Iteration: 1124, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4485560953617096
loss_pred:0.02082543447613716, decouple_loss:0.013178572990000248
The generated pressure mean: 0.4479898512363434
loss_pred:0.02325575239956379, decouple_loss:0.012418224476277828
The generated pressure mean: 0.44973331689834595
loss_pred:0.022538751363754272, decouple_loss:0.012884066440165043
Iteration: 1125, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4494214355945587
The generated pressure mean: 0.44842976331710815
loss_pred:0.021708223968744278, decouple_loss:0.013578087091445923
loss_pred:0.023004906252026558, decouple_loss:0.012036599218845367
The generated pressure mean: 0.4473637640476227
loss_pred:0.023284802213311195, decouple_loss:0.014947046525776386
Iteration: 1126, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4489910900592804
The generated pressure mean: 0.4481221139431
loss_pred:0.024117644876241684, decouple_loss:0.01338549330830574
loss_pred:0.02403641864657402, decouple_loss:0.013696225360035896
The generated pressure mean: 0.4494774639606476
loss_pred:0.02326009050011635, decouple_loss:0.014085543341934681
Iteration: 1127, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44946423172950745
The generated pressure mean: 0.4474885165691376loss_pred:0.023717068135738373, decouple_loss:0.012689489871263504
loss_pred:0.02195086143910885, decouple_loss:0.012535545974969864
The generated pressure mean: 0.44876715540885925
loss_pred:0.023947933688759804, decouple_loss:0.012439684011042118
Iteration: 1128, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44958046078681946
loss_pred:0.020946230739355087, decouple_loss:0.015702150762081146
The generated pressure mean: 0.45018479228019714
loss_pred:0.02243618294596672, decouple_loss:0.015985827893018723
The generated pressure mean: 0.44913652539253235
loss_pred:0.02270296774804592, decouple_loss:0.013882678002119064
Iteration: 1129, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45052996277809143
loss_pred:0.02181948348879814, decouple_loss:0.01593642309308052
The generated pressure mean: 0.4478432536125183
loss_pred:0.023140762001276016, decouple_loss:0.013750467449426651
The generated pressure mean: 0.44799965620040894
loss_pred:0.024176405742764473, decouple_loss:0.01475298311561346
Iteration: 1130, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44726794958114624
loss_pred:0.024289390072226524, decouple_loss:0.01203556451946497
The generated pressure mean: 0.44920122623443604
loss_pred:0.021733347326517105, decouple_loss:0.012394137680530548
The generated pressure mean: 0.4493311047554016
loss_pred:0.022714046761393547, decouple_loss:0.011731155216693878
2023-04-16 05:56:58 testing...
The generated pressure mean: 0.4502691626548767
loss_pred:0.14337174594402313, decouple_loss:0.06623487919569016
The generated pressure mean: 0.45032158493995667
loss_pred:0.14073917269706726, decouple_loss:0.06580031663179398
The generated pressure mean: 0.4500299394130707
loss_pred:0.1420944333076477, decouple_loss:0.06551366299390793
Loss: 0.14536093175411224, avg_mse: 0.2758924067020416
current test mse: 0.275892
Iteration: 1131, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44926995038986206The generated pressure mean: 0.4496976435184479
The generated pressure mean: 0.44823360443115234
loss_pred:0.02238888293504715, decouple_loss:0.01354661863297224
loss_pred:0.021355224773287773, decouple_loss:0.01398186944425106
loss_pred:0.02248278446495533, decouple_loss:0.01204682607203722
Iteration: 1132, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4487679898738861
The generated pressure mean: 0.4486897587776184loss_pred:0.0237941462546587, decouple_loss:0.014413540251553059
loss_pred:0.022287465631961823, decouple_loss:0.013972700573503971
The generated pressure mean: 0.4503285884857178
loss_pred:0.022953247651457787, decouple_loss:0.014432411640882492
Iteration: 1133, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44895121455192566
loss_pred:0.02443845570087433, decouple_loss:0.012534121982753277
The generated pressure mean: 0.4489670991897583
The generated pressure mean: 0.4481309950351715
loss_pred:0.025556836277246475, decouple_loss:0.012120735831558704
loss_pred:0.023436229676008224, decouple_loss:0.011640219017863274
Iteration: 1134, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45132365822792053
The generated pressure mean: 0.4479214549064636
loss_pred:0.02251587249338627, decouple_loss:0.01340482197701931
loss_pred:0.023079363629221916, decouple_loss:0.012991384603083134
The generated pressure mean: 0.4479590356349945
loss_pred:0.02326788753271103, decouple_loss:0.013127471320331097
Iteration: 1135, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4502941370010376
The generated pressure mean: 0.4484264850616455
loss_pred:0.022290045395493507, decouple_loss:0.012005726806819439
loss_pred:0.02321234717965126, decouple_loss:0.013759280554950237
The generated pressure mean: 0.44951677322387695
loss_pred:0.024217957630753517, decouple_loss:0.013091884553432465
Iteration: 1136, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4492010772228241
The generated pressure mean: 0.44823673367500305loss_pred:0.022237274795770645, decouple_loss:0.0122073944658041
loss_pred:0.024754419922828674, decouple_loss:0.011589988134801388
The generated pressure mean: 0.4493793547153473
loss_pred:0.023778682574629784, decouple_loss:0.011992033571004868
Iteration: 1137, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45076674222946167
The generated pressure mean: 0.44992852210998535
loss_pred:0.021925916895270348, decouple_loss:0.012261263094842434
loss_pred:0.02231694757938385, decouple_loss:0.013097240589559078
The generated pressure mean: 0.44897496700286865
loss_pred:0.024822130799293518, decouple_loss:0.011843359097838402
Iteration: 1138, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44784149527549744
loss_pred:0.02337317168712616, decouple_loss:0.012017883360385895
The generated pressure mean: 0.4480062425136566
loss_pred:0.02396497130393982, decouple_loss:0.012197824195027351
The generated pressure mean: 0.44852715730667114
loss_pred:0.024314729496836662, decouple_loss:0.012197486124932766
Iteration: 1139, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44827136397361755
loss_pred:0.024904292076826096, decouple_loss:0.01288700569421053
The generated pressure mean: 0.4496476948261261
loss_pred:0.02607407420873642, decouple_loss:0.01340781431645155
The generated pressure mean: 0.4503321349620819
loss_pred:0.02350134588778019, decouple_loss:0.01369177084416151
Iteration: 1140, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44877099990844727
loss_pred:0.02393927052617073, decouple_loss:0.013443326577544212
The generated pressure mean: 0.4496558606624603
loss_pred:0.023364471271634102, decouple_loss:0.01347414031624794
The generated pressure mean: 0.44950827956199646
loss_pred:0.024067439138889313, decouple_loss:0.013116991147398949
2023-04-16 05:59:04 testing...
The generated pressure mean: 0.4502691328525543
loss_pred:0.13815711438655853, decouple_loss:0.060541942715644836
The generated pressure mean: 0.4500303268432617
loss_pred:0.13732588291168213, decouple_loss:0.06099025160074234
The generated pressure mean: 0.4503245949745178
loss_pred:0.13619522750377655, decouple_loss:0.061016734689474106
Loss: 0.14026854932308197, avg_mse: 0.26386672258377075
current test mse: 0.263867
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012016_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012016_3_24hr.npz
NaN value num: 0
Iteration: 1141, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4482378363609314
loss_pred:0.024494124576449394, decouple_loss:0.014021549373865128
The generated pressure mean: 0.4473891854286194
loss_pred:0.022661548107862473, decouple_loss:0.014593610540032387
The generated pressure mean: 0.44789719581604004
loss_pred:0.024641921743750572, decouple_loss:0.013845224864780903
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1142, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44818317890167236
loss_pred:0.024349207058548927, decouple_loss:0.013420766219496727
The generated pressure mean: 0.4483884572982788
loss_pred:0.026040004566311836, decouple_loss:0.013353247195482254
The generated pressure mean: 0.44815367460250854
loss_pred:0.023452620953321457, decouple_loss:0.01296479906886816
Iteration: 1143, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44722625613212585
The generated pressure mean: 0.448193222284317
loss_pred:0.023559870198369026, decouple_loss:0.012677785940468311
loss_pred:0.025507604703307152, decouple_loss:0.013594269752502441
The generated pressure mean: 0.4478404223918915
loss_pred:0.02447216957807541, decouple_loss:0.013635649345815182
Iteration: 1144, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4484822452068329
loss_pred:0.024224838241934776, decouple_loss:0.011972637847065926
The generated pressure mean: 0.4491630792617798
loss_pred:0.02327009290456772, decouple_loss:0.012123447842895985
The generated pressure mean: 0.44767412543296814
loss_pred:0.024149101227521896, decouple_loss:0.012409449554979801
Iteration: 1145, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44775792956352234
loss_pred:0.024994241073727608, decouple_loss:0.011934011243283749
The generated pressure mean: 0.44833606481552124
loss_pred:0.023938195779919624, decouple_loss:0.012360508553683758
The generated pressure mean: 0.4482055902481079
loss_pred:0.024135660380125046, decouple_loss:0.012354828417301178
Iteration: 1146, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4480193257331848
loss_pred:0.02493857406079769, decouple_loss:0.013126222416758537
The generated pressure mean: 0.4487149715423584
loss_pred:0.02459975704550743, decouple_loss:0.013330670073628426
The generated pressure mean: 0.44776415824890137
loss_pred:0.028026128187775612, decouple_loss:0.012390281073749065
Iteration: 1147, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44809988141059875
The generated pressure mean: 0.4480976462364197loss_pred:0.02655835449695587, decouple_loss:0.013208583928644657
loss_pred:0.025404956191778183, decouple_loss:0.013172253035008907
The generated pressure mean: 0.4482949674129486
loss_pred:0.026069317013025284, decouple_loss:0.013719248585402966
Iteration: 1148, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4482381343841553
loss_pred:0.0247249286621809, decouple_loss:0.013341023586690426
The generated pressure mean: 0.44836631417274475
loss_pred:0.024512141942977905, decouple_loss:0.012860756367444992
The generated pressure mean: 0.44831496477127075
loss_pred:0.02503892220556736, decouple_loss:0.013349166139960289
Iteration: 1149, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4480326175689697
loss_pred:0.02406890317797661, decouple_loss:0.012648429721593857
The generated pressure mean: 0.4478048086166382
loss_pred:0.02437644824385643, decouple_loss:0.012965655885636806
The generated pressure mean: 0.4478711187839508
loss_pred:0.02397814765572548, decouple_loss:0.012304502539336681
Iteration: 1150, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4481002986431122
loss_pred:0.024168550968170166, decouple_loss:0.014249351806938648
The generated pressure mean: 0.44796469807624817
loss_pred:0.025090165436267853, decouple_loss:0.013073332607746124
The generated pressure mean: 0.44772645831108093
loss_pred:0.024495452642440796, decouple_loss:0.013351946137845516
2023-04-16 06:01:46 testing...
The generated pressure mean: 0.4502691626548767
loss_pred:0.14278177917003632, decouple_loss:0.06333313137292862
The generated pressure mean: 0.4503251314163208
loss_pred:0.1410471647977829, decouple_loss:0.06412866711616516
The generated pressure mean: 0.4500303268432617
loss_pred:0.1424376666545868, decouple_loss:0.06330830603837967
Loss: 0.14526836574077606, avg_mse: 0.2781484127044678
current test mse: 0.278148
Iteration: 1151, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4476526081562042
loss_pred:0.027137277647852898, decouple_loss:0.014062405563890934
The generated pressure mean: 0.44711703062057495
loss_pred:0.023396754637360573, decouple_loss:0.013134760782122612
The generated pressure mean: 0.44687995314598083
loss_pred:0.02515266276896, decouple_loss:0.013162678107619286
Iteration: 1152, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4481610059738159
The generated pressure mean: 0.44755756855010986
The generated pressure mean: 0.4478711187839508
loss_pred:0.024193091318011284, decouple_loss:0.013127211481332779
loss_pred:0.02701169066131115, decouple_loss:0.013354044407606125
loss_pred:0.02400818094611168, decouple_loss:0.012928823009133339
Iteration: 1153, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4481295347213745
loss_pred:0.024577470496296883, decouple_loss:0.014211691915988922
The generated pressure mean: 0.44811102747917175
loss_pred:0.023934153839945793, decouple_loss:0.014214208349585533
The generated pressure mean: 0.4481704831123352
loss_pred:0.023893965408205986, decouple_loss:0.013607898727059364
Iteration: 1154, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4477735161781311
The generated pressure mean: 0.44776400923728943
loss_pred:0.023730186745524406, decouple_loss:0.012974642217159271
loss_pred:0.024550670757889748, decouple_loss:0.01303787436336279
The generated pressure mean: 0.44769224524497986
loss_pred:0.023796511813998222, decouple_loss:0.012642763555049896
Iteration: 1155, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44806015491485596
loss_pred:0.026203516870737076, decouple_loss:0.013399150222539902The generated pressure mean: 0.4479110538959503
loss_pred:0.024468619376420975, decouple_loss:0.013687401078641415
The generated pressure mean: 0.4480637013912201
loss_pred:0.024357831105589867, decouple_loss:0.012774534523487091
Iteration: 1156, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4485800862312317
loss_pred:0.024332113564014435, decouple_loss:0.014074474573135376
The generated pressure mean: 0.4468504786491394
loss_pred:0.023082789033651352, decouple_loss:0.013477853499352932
The generated pressure mean: 0.44792914390563965
loss_pred:0.02454589679837227, decouple_loss:0.014314462430775166
Iteration: 1157, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4475368559360504
loss_pred:0.02382330596446991, decouple_loss:0.012007196433842182
The generated pressure mean: 0.4483640491962433
loss_pred:0.025000303983688354, decouple_loss:0.01236787997186184
The generated pressure mean: 0.4484283924102783
loss_pred:0.0239974744617939, decouple_loss:0.01220934558659792
Iteration: 1158, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4486091136932373
loss_pred:0.022796398028731346, decouple_loss:0.012530647218227386
The generated pressure mean: 0.4489031732082367
loss_pred:0.02573694847524166, decouple_loss:0.011898963712155819
The generated pressure mean: 0.44759252667427063
loss_pred:0.024779852479696274, decouple_loss:0.011589250527322292
Iteration: 1159, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4491601884365082
loss_pred:0.02322496473789215, decouple_loss:0.012977993115782738
The generated pressure mean: 0.44775399565696716
loss_pred:0.02453618310391903, decouple_loss:0.013718497939407825
The generated pressure mean: 0.4474896788597107
loss_pred:0.02490166388452053, decouple_loss:0.01346606109291315
Iteration: 1160, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44833695888519287
loss_pred:0.02469124272465706, decouple_loss:0.013091705739498138
The generated pressure mean: 0.44658714532852173
loss_pred:0.02352660894393921, decouple_loss:0.01329449936747551
The generated pressure mean: 0.44870495796203613
loss_pred:0.023352334275841713, decouple_loss:0.013302759267389774
2023-04-16 06:03:52 testing...
The generated pressure mean: 0.4502691328525543
loss_pred:0.1428183764219284, decouple_loss:0.0625595897436142
The generated pressure mean: 0.45032334327697754
loss_pred:0.14049173891544342, decouple_loss:0.06339353322982788
The generated pressure mean: 0.450030118227005
loss_pred:0.14169003069400787, decouple_loss:0.06261010468006134
Loss: 0.14480943977832794, avg_mse: 0.27381935715675354
current test mse: 0.273819
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012006_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012006_3_24hr.npz
NaN value num: 0
Iteration: 1161, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44893184304237366
loss_pred:0.02212395705282688, decouple_loss:0.012521583586931229
The generated pressure mean: 0.44801902770996094
loss_pred:0.02745535410940647, decouple_loss:0.01347113586962223
The generated pressure mean: 0.4493936598300934
loss_pred:0.022802725434303284, decouple_loss:0.012290284968912601
Iteration: 1162, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44952329993247986
The generated pressure mean: 0.4481831192970276
loss_pred:0.024624841287732124, decouple_loss:0.015255957841873169
loss_pred:0.02390027977526188, decouple_loss:0.014892534352838993
The generated pressure mean: 0.4491596519947052
loss_pred:0.02279837802052498, decouple_loss:0.014700155705213547
Iteration: 1163, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4493792951107025
loss_pred:0.022879889234900475, decouple_loss:0.013394464738667011
The generated pressure mean: 0.4489968717098236
loss_pred:0.02256299927830696, decouple_loss:0.012713313102722168
The generated pressure mean: 0.4497442841529846
loss_pred:0.02815975435078144, decouple_loss:0.013295318000018597
Iteration: 1164, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4494229257106781
The generated pressure mean: 0.4485626220703125
loss_pred:0.024290507659316063, decouple_loss:0.014856316149234772
loss_pred:0.02594602108001709, decouple_loss:0.01345822587609291
The generated pressure mean: 0.4490937888622284
loss_pred:0.02448013797402382, decouple_loss:0.014118186198174953
Iteration: 1165, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44772955775260925
loss_pred:0.02451738901436329, decouple_loss:0.015978660434484482
The generated pressure mean: 0.4486592710018158
loss_pred:0.023882631212472916, decouple_loss:0.015234803780913353
The generated pressure mean: 0.4481903612613678
loss_pred:0.024752486497163773, decouple_loss:0.014935921877622604
Iteration: 1166, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4484950006008148
The generated pressure mean: 0.4497528672218323
loss_pred:0.022424133494496346, decouple_loss:0.01296815276145935
loss_pred:0.02312670834362507, decouple_loss:0.013500137254595757
The generated pressure mean: 0.448976069688797
loss_pred:0.025184357538819313, decouple_loss:0.012858293950557709
Iteration: 1167, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4491158723831177
loss_pred:0.024904675781726837, decouple_loss:0.015426399186253548
The generated pressure mean: 0.4493333101272583
loss_pred:0.024281492456793785, decouple_loss:0.013991575688123703
The generated pressure mean: 0.44840583205223083
loss_pred:0.021693704649806023, decouple_loss:0.014403793029487133
Iteration: 1168, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45076873898506165
loss_pred:0.024057384580373764, decouple_loss:0.013198526576161385
The generated pressure mean: 0.4493500590324402
loss_pred:0.023103443905711174, decouple_loss:0.013585589826107025
The generated pressure mean: 0.44873541593551636
loss_pred:0.025233924388885498, decouple_loss:0.012951518408954144
Iteration: 1169, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4492432773113251
loss_pred:0.023542355746030807, decouple_loss:0.01410332228988409
The generated pressure mean: 0.44971516728401184
loss_pred:0.023725204169750214, decouple_loss:0.013208449818193913
The generated pressure mean: 0.4484429359436035
loss_pred:0.02428700588643551, decouple_loss:0.013566420413553715
Iteration: 1170, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4480512738227844The generated pressure mean: 0.45001816749572754
loss_pred:0.022731484845280647, decouple_loss:0.013899233192205429loss_pred:0.022525068372488022, decouple_loss:0.01440044492483139
The generated pressure mean: 0.4492577910423279
loss_pred:0.022326260805130005, decouple_loss:0.013428068719804287
2023-04-16 06:06:34 testing...
The generated pressure mean: 0.4502691626548767
loss_pred:0.13631023466587067, decouple_loss:0.06374375522136688
The generated pressure mean: 0.45003044605255127
loss_pred:0.13561677932739258, decouple_loss:0.06317363679409027
The generated pressure mean: 0.4503247141838074
loss_pred:0.13466951251029968, decouple_loss:0.06363759189844131
Loss: 0.13870809972286224, avg_mse: 0.25954052805900574
current test mse: 0.259541
Iteration: 1171, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44916200637817383
The generated pressure mean: 0.45002520084381104
loss_pred:0.024315031245350838, decouple_loss:0.014132310636341572
loss_pred:0.02700834348797798, decouple_loss:0.014451038092374802
The generated pressure mean: 0.45001420378685
loss_pred:0.023896120488643646, decouple_loss:0.013916448689997196
Iteration: 1172, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4498043656349182
The generated pressure mean: 0.4482818841934204
loss_pred:0.023649804294109344, decouple_loss:0.01457181852310896
loss_pred:0.023360826075077057, decouple_loss:0.013928448781371117
The generated pressure mean: 0.44898051023483276
loss_pred:0.023069623857736588, decouple_loss:0.013768656179308891
Iteration: 1173, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4505431354045868
loss_pred:0.023389432579278946, decouple_loss:0.013228329829871655
The generated pressure mean: 0.4484187662601471
The generated pressure mean: 0.4492243826389313
loss_pred:0.026362497359514236, decouple_loss:0.014474701136350632
loss_pred:0.0246321652084589, decouple_loss:0.013849625363945961
Iteration: 1174, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4485103189945221
The generated pressure mean: 0.44980114698410034loss_pred:0.023058196529746056, decouple_loss:0.013392231427133083
loss_pred:0.022562803700566292, decouple_loss:0.014008470810949802
The generated pressure mean: 0.44907084107398987
loss_pred:0.023031285032629967, decouple_loss:0.012776017189025879
Iteration: 1175, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44934991002082825
loss_pred:0.0239198449999094, decouple_loss:0.012866361066699028
The generated pressure mean: 0.44851914048194885
loss_pred:0.025264406576752663, decouple_loss:0.01327237393707037
The generated pressure mean: 0.44791126251220703
loss_pred:0.023684144020080566, decouple_loss:0.01280105859041214
Iteration: 1176, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4503007233142853The generated pressure mean: 0.4495527744293213
loss_pred:0.022234398871660233, decouple_loss:0.013814917765557766
loss_pred:0.02266639471054077, decouple_loss:0.013523253612220287
The generated pressure mean: 0.4491485357284546
loss_pred:0.02393498085439205, decouple_loss:0.013140302151441574
Iteration: 1177, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4485815763473511
loss_pred:0.022667407989501953, decouple_loss:0.012572559528052807
The generated pressure mean: 0.44928890466690063
loss_pred:0.025045238435268402, decouple_loss:0.012824210338294506
The generated pressure mean: 0.4487563371658325
loss_pred:0.02296833135187626, decouple_loss:0.012338228523731232
Iteration: 1178, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.448986291885376
loss_pred:0.02432263456285, decouple_loss:0.013658360578119755
The generated pressure mean: 0.4489244520664215
loss_pred:0.024788832291960716, decouple_loss:0.012481343001127243
The generated pressure mean: 0.44839727878570557
loss_pred:0.02187359519302845, decouple_loss:0.013170723803341389
Iteration: 1179, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44953033328056335
The generated pressure mean: 0.44874879717826843
loss_pred:0.02395419031381607, decouple_loss:0.012978492304682732
loss_pred:0.02217203378677368, decouple_loss:0.012760541401803493
The generated pressure mean: 0.4493955373764038
loss_pred:0.02205638587474823, decouple_loss:0.013700406067073345
Iteration: 1180, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4502853751182556
loss_pred:0.02648909017443657, decouple_loss:0.013245278038084507
The generated pressure mean: 0.44865700602531433
loss_pred:0.023888148367404938, decouple_loss:0.01270412839949131
The generated pressure mean: 0.44826042652130127
loss_pred:0.024438314139842987, decouple_loss:0.01342523843050003
2023-04-16 06:08:39 testing...
The generated pressure mean: 0.4502691626548767
loss_pred:0.13529746234416962, decouple_loss:0.0643969401717186
The generated pressure mean: 0.4503231644630432
loss_pred:0.13233999907970428, decouple_loss:0.06447757035493851
The generated pressure mean: 0.45002928376197815
loss_pred:0.1335412561893463, decouple_loss:0.06427914649248123
Loss: 0.1369454711675644, avg_mse: 0.2555486559867859
current test mse: 0.255549
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012000_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012000_3_24hr.npz
NaN value num: 0
Iteration: 1181, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44942548871040344
loss_pred:0.023904312402009964, decouple_loss:0.014591184444725513
The generated pressure mean: 0.44881314039230347
loss_pred:0.023978950455784798, decouple_loss:0.013856549747288227
The generated pressure mean: 0.4485108256340027
loss_pred:0.02218468487262726, decouple_loss:0.014020419679582119
Iteration: 1182, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44776901602745056
loss_pred:0.02455669641494751, decouple_loss:0.013107872568070889
The generated pressure mean: 0.44917216897010803
loss_pred:0.02529679425060749, decouple_loss:0.013023590669035912
The generated pressure mean: 0.4488934874534607
loss_pred:0.022737640887498856, decouple_loss:0.012999315746128559
Iteration: 1183, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4487275779247284
loss_pred:0.02283708192408085, decouple_loss:0.014364618808031082
The generated pressure mean: 0.4484045207500458
loss_pred:0.023535029962658882, decouple_loss:0.01565571501851082
The generated pressure mean: 0.4489896297454834
loss_pred:0.02370663918554783, decouple_loss:0.014903130009770393
Iteration: 1184, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4494510591030121
loss_pred:0.022450482472777367, decouple_loss:0.013495680876076221
The generated pressure mean: 0.44750452041625977
loss_pred:0.024593817070126534, decouple_loss:0.014489449560642242
The generated pressure mean: 0.4475875198841095
loss_pred:0.023847555741667747, decouple_loss:0.014512414112687111
Iteration: 1185, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4484679400920868
The generated pressure mean: 0.4478853940963745
loss_pred:0.02369687333703041, decouple_loss:0.014283189550042152
loss_pred:0.022343633696436882, decouple_loss:0.014739862643182278
The generated pressure mean: 0.4488784670829773
loss_pred:0.023307090625166893, decouple_loss:0.014744079671800137
Iteration: 1186, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44979146122932434
loss_pred:0.0230319332331419, decouple_loss:0.013433892279863358
The generated pressure mean: 0.4479823410511017
loss_pred:0.024482369422912598, decouple_loss:0.013773634098470211
The generated pressure mean: 0.4479431211948395
loss_pred:0.02272794581949711, decouple_loss:0.013783645816147327
Iteration: 1187, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44933947920799255
loss_pred:0.022907856851816177, decouple_loss:0.01399900484830141
The generated pressure mean: 0.44783368706703186
loss_pred:0.02263040654361248, decouple_loss:0.013830464333295822
The generated pressure mean: 0.4507656991481781
loss_pred:0.022003542631864548, decouple_loss:0.013351785950362682
Iteration: 1188, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4480832815170288
loss_pred:0.021863309666514397, decouple_loss:0.013965551741421223
The generated pressure mean: 0.4476318359375
loss_pred:0.023196585476398468, decouple_loss:0.01344325765967369
The generated pressure mean: 0.4494030475616455
loss_pred:0.023120775818824768, decouple_loss:0.013623501174151897
Iteration: 1189, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44761964678764343
loss_pred:0.022483542561531067, decouple_loss:0.014333800412714481
The generated pressure mean: 0.45029380917549133
loss_pred:0.022521143779158592, decouple_loss:0.014147044159471989
The generated pressure mean: 0.44860291481018066
loss_pred:0.022639647126197815, decouple_loss:0.014009890146553516
Iteration: 1190, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4469749629497528
loss_pred:0.023550089448690414, decouple_loss:0.014650150202214718
The generated pressure mean: 0.44659262895584106
loss_pred:0.023379504680633545, decouple_loss:0.013617713935673237
The generated pressure mean: 0.4488063156604767
loss_pred:0.022498900070786476, decouple_loss:0.013351378962397575
2023-04-16 06:11:18 testing...
The generated pressure mean: 0.4502691328525543
loss_pred:0.1347651481628418, decouple_loss:0.07019232213497162
The generated pressure mean: 0.45032450556755066
loss_pred:0.13242509961128235, decouple_loss:0.06988745927810669
The generated pressure mean: 0.4500303864479065
loss_pred:0.13361473381519318, decouple_loss:0.06997653841972351
Loss: 0.13710260391235352, avg_mse: 0.2574771046638489
current test mse: 0.257477
Iteration: 1191, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44703105092048645
loss_pred:0.02384920045733452, decouple_loss:0.013946278020739555
The generated pressure mean: 0.4492897391319275
loss_pred:0.022915620356798172, decouple_loss:0.015877919271588326
The generated pressure mean: 0.4498039186000824
loss_pred:0.02362961508333683, decouple_loss:0.016627611592411995
Iteration: 1192, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44823184609413147
loss_pred:0.021586444228887558, decouple_loss:0.013728531077504158
The generated pressure mean: 0.4483300745487213
loss_pred:0.02310371585190296, decouple_loss:0.014228975400328636
The generated pressure mean: 0.4479590058326721
loss_pred:0.024731118232011795, decouple_loss:0.014322650618851185
Iteration: 1193, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4496743381023407
loss_pred:0.02300141379237175, decouple_loss:0.014211036264896393
The generated pressure mean: 0.44990384578704834
loss_pred:0.02269650623202324, decouple_loss:0.013233437202870846
The generated pressure mean: 0.44718480110168457
loss_pred:0.023915970697999, decouple_loss:0.013844144530594349
Iteration: 1194, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44847872853279114
loss_pred:0.02379816398024559, decouple_loss:0.015191706828773022
The generated pressure mean: 0.44773685932159424
loss_pred:0.022303439676761627, decouple_loss:0.014949232339859009
The generated pressure mean: 0.4478541314601898
loss_pred:0.02419913187623024, decouple_loss:0.014402229338884354
Iteration: 1195, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44977250695228577
loss_pred:0.022588394582271576, decouple_loss:0.013576725497841835
The generated pressure mean: 0.4479193091392517
loss_pred:0.02283181995153427, decouple_loss:0.012967991642653942
The generated pressure mean: 0.44823411107063293
loss_pred:0.02413465827703476, decouple_loss:0.013077547773718834
Iteration: 1196, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45061010122299194
loss_pred:0.022374209016561508, decouple_loss:0.014086071401834488
The generated pressure mean: 0.4488513469696045
loss_pred:0.022496266290545464, decouple_loss:0.014289186336100101
The generated pressure mean: 0.4495765268802643
loss_pred:0.022107332944869995, decouple_loss:0.01345410943031311
Iteration: 1197, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44986316561698914
loss_pred:0.0220154020935297, decouple_loss:0.014199398458003998
The generated pressure mean: 0.44915392994880676
loss_pred:0.022938881069421768, decouple_loss:0.01419729832559824
The generated pressure mean: 0.4467560350894928
loss_pred:0.02379780448973179, decouple_loss:0.014989800751209259
Iteration: 1198, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4495984613895416
loss_pred:0.022091282531619072, decouple_loss:0.013858923688530922
The generated pressure mean: 0.4493422508239746
loss_pred:0.02226654440164566, decouple_loss:0.013373766094446182
The generated pressure mean: 0.4487588107585907
loss_pred:0.022131795063614845, decouple_loss:0.013731897808611393
Iteration: 1199, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4475049674510956
loss_pred:0.022910285741090775, decouple_loss:0.01358008198440075
The generated pressure mean: 0.4494698941707611
loss_pred:0.022959435358643532, decouple_loss:0.014454042539000511
The generated pressure mean: 0.4480610191822052
loss_pred:0.02166539430618286, decouple_loss:0.014473113231360912
Iteration: 1200, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4474426805973053
loss_pred:0.021398071199655533, decouple_loss:0.013838077895343304
The generated pressure mean: 0.4485175609588623
loss_pred:0.02122076041996479, decouple_loss:0.01300113182514906
The generated pressure mean: 0.4499483108520508
loss_pred:0.02278081886470318, decouple_loss:0.013976316899061203
2023-04-16 06:13:25 testing...
The generated pressure mean: 0.4502691626548767
loss_pred:0.13429801166057587, decouple_loss:0.06423881649971008
The generated pressure mean: 0.4503260552883148
loss_pred:0.1313229352235794, decouple_loss:0.06440499424934387
The generated pressure mean: 0.45002856850624084
loss_pred:0.13240112364292145, decouple_loss:0.06418316066265106
Loss: 0.13588780164718628, avg_mse: 0.2535346746444702
current test mse: 0.253535
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012010_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012010_3_24hr.npz
NaN value num: 0
Iteration: 1201, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44789937138557434
loss_pred:0.025374773889780045, decouple_loss:0.014441628009080887
The generated pressure mean: 0.44904568791389465
loss_pred:0.024052606895565987, decouple_loss:0.014461718499660492
The generated pressure mean: 0.44851255416870117
loss_pred:0.024068960919976234, decouple_loss:0.014744988642632961
Iteration: 1202, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.447100430727005
loss_pred:0.02331862412393093, decouple_loss:0.013959145173430443
The generated pressure mean: 0.4481154978275299
loss_pred:0.02337595447897911, decouple_loss:0.013627841137349606
The generated pressure mean: 0.4481836259365082
loss_pred:0.023306889459490776, decouple_loss:0.013896786607801914
Iteration: 1203, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4482180178165436
loss_pred:0.022363413125276566, decouple_loss:0.014329945668578148
The generated pressure mean: 0.4478224515914917
loss_pred:0.02299399860203266, decouple_loss:0.014489000663161278
The generated pressure mean: 0.44782140851020813
loss_pred:0.02272363379597664, decouple_loss:0.013444232754409313
Iteration: 1204, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44733506441116333
loss_pred:0.022855335846543312, decouple_loss:0.014428645372390747
The generated pressure mean: 0.44768890738487244
loss_pred:0.023693803697824478, decouple_loss:0.0148163428530097
The generated pressure mean: 0.44755789637565613
loss_pred:0.023415561765432358, decouple_loss:0.013290924951434135
Iteration: 1205, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44717466831207275
loss_pred:0.02292458526790142, decouple_loss:0.013681347481906414
The generated pressure mean: 0.44806715846061707
loss_pred:0.02423735335469246, decouple_loss:0.012827624566853046
The generated pressure mean: 0.44880521297454834
loss_pred:0.022149495780467987, decouple_loss:0.01318361610174179
Iteration: 1206, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4483683705329895
loss_pred:0.023554019629955292, decouple_loss:0.014177962206304073
The generated pressure mean: 0.44864487648010254
loss_pred:0.023700488731265068, decouple_loss:0.01404562871903181
The generated pressure mean: 0.447348415851593
loss_pred:0.02255125157535076, decouple_loss:0.01437651552259922
Iteration: 1207, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4484765827655792
loss_pred:0.022377246990799904, decouple_loss:0.012803696095943451
The generated pressure mean: 0.4483748972415924
loss_pred:0.022189248353242874, decouple_loss:0.012272821739315987
The generated pressure mean: 0.44851261377334595
loss_pred:0.023921826854348183, decouple_loss:0.012737846933305264
Iteration: 1208, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44894033670425415
loss_pred:0.027524391189217567, decouple_loss:0.012522769160568714
The generated pressure mean: 0.44819149374961853
loss_pred:0.021849455311894417, decouple_loss:0.01258519571274519
The generated pressure mean: 0.4483070373535156
loss_pred:0.022390849888324738, decouple_loss:0.012190538458526134
Iteration: 1209, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44829803705215454
loss_pred:0.023607853800058365, decouple_loss:0.013063267804682255
The generated pressure mean: 0.4482589662075043
loss_pred:0.025203533470630646, decouple_loss:0.013636377640068531
The generated pressure mean: 0.4482889771461487
loss_pred:0.024830449372529984, decouple_loss:0.013125153258442879
Iteration: 1210, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44647717475891113
loss_pred:0.021963026374578476, decouple_loss:0.012397459708154202
The generated pressure mean: 0.4479573667049408
loss_pred:0.023629464209079742, decouple_loss:0.012648576870560646
The generated pressure mean: 0.44740718603134155
loss_pred:0.022469190880656242, decouple_loss:0.012885111384093761
2023-04-16 06:16:10 testing...
The generated pressure mean: 0.4502691626548767
loss_pred:0.1397562175989151, decouple_loss:0.0637141689658165
The generated pressure mean: 0.4500311017036438
loss_pred:0.13875000178813934, decouple_loss:0.06399515271186829
The generated pressure mean: 0.45032307505607605
loss_pred:0.13759881258010864, decouple_loss:0.06433145701885223
Loss: 0.1419023722410202, avg_mse: 0.26861217617988586
current test mse: 0.268612
Iteration: 1211, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4486672580242157
loss_pred:0.02329515479505062, decouple_loss:0.01181779708713293
The generated pressure mean: 0.4468441903591156
loss_pred:0.02316758967936039, decouple_loss:0.011942222714424133
The generated pressure mean: 0.44788384437561035
loss_pred:0.023966815322637558, decouple_loss:0.012257682159543037
Iteration: 1212, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44662153720855713
loss_pred:0.02403029054403305, decouple_loss:0.012124084867537022
The generated pressure mean: 0.44807168841362
loss_pred:0.023218289017677307, decouple_loss:0.012400375679135323
The generated pressure mean: 0.4469238519668579
loss_pred:0.02230774238705635, decouple_loss:0.011729196645319462
Iteration: 1213, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44793641567230225
loss_pred:0.023852301761507988, decouple_loss:0.01190559659153223
The generated pressure mean: 0.44804051518440247
loss_pred:0.022938624024391174, decouple_loss:0.01175888255238533
The generated pressure mean: 0.44779741764068604
loss_pred:0.02288561314344406, decouple_loss:0.011824999004602432
Iteration: 1214, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.446712851524353
loss_pred:0.023484056815505028, decouple_loss:0.012394700199365616
The generated pressure mean: 0.4478285610675812
loss_pred:0.023210471495985985, decouple_loss:0.012009382247924805
The generated pressure mean: 0.44826069474220276
loss_pred:0.024177998304367065, decouple_loss:0.012064337730407715
Iteration: 1215, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4465208649635315
loss_pred:0.023778608068823814, decouple_loss:0.012873545289039612
The generated pressure mean: 0.44873476028442383
loss_pred:0.022028516978025436, decouple_loss:0.012650894932448864
The generated pressure mean: 0.4481259882450104
loss_pred:0.022665182128548622, decouple_loss:0.012898124754428864
Iteration: 1216, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44895654916763306
loss_pred:0.023614568635821342, decouple_loss:0.01213410310447216
The generated pressure mean: 0.44719168543815613
loss_pred:0.02360439859330654, decouple_loss:0.012439372017979622
The generated pressure mean: 0.44728726148605347
loss_pred:0.023891547694802284, decouple_loss:0.012565115466713905
Iteration: 1217, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4478752315044403
loss_pred:0.023444050922989845, decouple_loss:0.012496945448219776
The generated pressure mean: 0.4467112421989441
loss_pred:0.02379998378455639, decouple_loss:0.01241801492869854
The generated pressure mean: 0.44876840710639954
loss_pred:0.022637611255049706, decouple_loss:0.012004292570054531
Iteration: 1218, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44856154918670654
loss_pred:0.023310281336307526, decouple_loss:0.013100555166602135
The generated pressure mean: 0.4480978548526764
loss_pred:0.02180219441652298, decouple_loss:0.013527311384677887
The generated pressure mean: 0.44700753688812256
loss_pred:0.022826315835118294, decouple_loss:0.013381224125623703
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1219, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44790592789649963
loss_pred:0.022055257111787796, decouple_loss:0.011721290647983551
The generated pressure mean: 0.4477524161338806
loss_pred:0.024290159344673157, decouple_loss:0.012016666121780872
The generated pressure mean: 0.44866621494293213
loss_pred:0.022074660286307335, decouple_loss:0.012309262529015541
Iteration: 1220, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44915905594825745
loss_pred:0.02252671867609024, decouple_loss:0.01191827841103077
The generated pressure mean: 0.44765976071357727
loss_pred:0.021854883059859276, decouple_loss:0.012062370777130127
The generated pressure mean: 0.44846364855766296
loss_pred:0.022824781015515327, decouple_loss:0.012207228690385818
2023-04-16 06:18:17 testing...
The generated pressure mean: 0.4502691626548767
loss_pred:0.1395019292831421, decouple_loss:0.06334415823221207
The generated pressure mean: 0.4500313103199005
loss_pred:0.13838697969913483, decouple_loss:0.06359519809484482
The generated pressure mean: 0.4503241181373596
loss_pred:0.13708144426345825, decouple_loss:0.06378021091222763
Loss: 0.14150212705135345, avg_mse: 0.2670462727546692
current test mse: 0.267046
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012007_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012007_3_24hr.npz
NaN value num: 0
Iteration: 1221, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4487503468990326
loss_pred:0.023250505328178406, decouple_loss:0.013675150461494923
The generated pressure mean: 0.44787415862083435
loss_pred:0.023062027990818024, decouple_loss:0.013108600862324238
The generated pressure mean: 0.44830477237701416
loss_pred:0.022071324288845062, decouple_loss:0.013166138902306557
Iteration: 1222, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4485253393650055
loss_pred:0.0219955425709486, decouple_loss:0.012702186591923237
The generated pressure mean: 0.4480922520160675
The generated pressure mean: 0.44988879561424255
loss_pred:0.02119697630405426, decouple_loss:0.01274060271680355
loss_pred:0.022277532145380974, decouple_loss:0.01358305849134922
Iteration: 1223, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4486803114414215
The generated pressure mean: 0.4482121467590332
loss_pred:0.022238198667764664, decouple_loss:0.011936352588236332
loss_pred:0.02178342454135418, decouple_loss:0.012560027651488781
The generated pressure mean: 0.4486537277698517
loss_pred:0.022712305188179016, decouple_loss:0.013540378771722317
Iteration: 1224, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4489213824272156
loss_pred:0.02246202901005745, decouple_loss:0.012256010435521603
The generated pressure mean: 0.448130339384079
loss_pred:0.023086851462721825, decouple_loss:0.012615205720067024
The generated pressure mean: 0.4483461380004883
loss_pred:0.021357746794819832, decouple_loss:0.012694142758846283
Iteration: 1225, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4493037760257721
loss_pred:0.021893706172704697, decouple_loss:0.011562873609364033
The generated pressure mean: 0.448026180267334
loss_pred:0.02150673419237137, decouple_loss:0.01126943714916706
The generated pressure mean: 0.44922640919685364
loss_pred:0.02284947969019413, decouple_loss:0.01153966598212719
Iteration: 1226, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44768810272216797The generated pressure mean: 0.44914713501930237
loss_pred:0.022739382460713387, decouple_loss:0.012395551428198814loss_pred:0.022977475076913834, decouple_loss:0.01186556089669466
The generated pressure mean: 0.447186678647995
loss_pred:0.022517863661050797, decouple_loss:0.012329312972724438
Iteration: 1227, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44869789481163025
loss_pred:0.021804850548505783, decouple_loss:0.011871223337948322
The generated pressure mean: 0.44822219014167786
loss_pred:0.02272379770874977, decouple_loss:0.012152262963354588
The generated pressure mean: 0.44879788160324097
loss_pred:0.023121237754821777, decouple_loss:0.011822091415524483
Iteration: 1228, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4479355216026306
The generated pressure mean: 0.449072927236557loss_pred:0.02160613052546978, decouple_loss:0.01217113621532917
loss_pred:0.02457551099359989, decouple_loss:0.011619562283158302
The generated pressure mean: 0.4489516019821167
loss_pred:0.023305997252464294, decouple_loss:0.011968393810093403
Iteration: 1229, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44872841238975525
loss_pred:0.02330770716071129, decouple_loss:0.011803144589066505
The generated pressure mean: 0.4478447735309601
loss_pred:0.023652708157896996, decouple_loss:0.011754421517252922
The generated pressure mean: 0.44963541626930237
loss_pred:0.02182617597281933, decouple_loss:0.01183347124606371
Iteration: 1230, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4481949508190155
The generated pressure mean: 0.44853487610816956
loss_pred:0.022547701373696327, decouple_loss:0.012998471036553383
loss_pred:0.02283583953976631, decouple_loss:0.012716786004602909
The generated pressure mean: 0.44807711243629456
loss_pred:0.02363285794854164, decouple_loss:0.011990775354206562
2023-04-16 06:21:03 testing...
The generated pressure mean: 0.4502691626548767
loss_pred:0.14213456213474274, decouple_loss:0.06430774182081223
The generated pressure mean: 0.45032358169555664
loss_pred:0.13954414427280426, decouple_loss:0.06485997885465622
The generated pressure mean: 0.45003044605255127
loss_pred:0.14077453315258026, decouple_loss:0.06439441442489624
Loss: 0.14404378831386566, avg_mse: 0.2734002470970154
current test mse: 0.2734
Iteration: 1231, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44889718294143677
The generated pressure mean: 0.4478877782821655loss_pred:0.021416086703538895, decouple_loss:0.01262898650020361
loss_pred:0.022915709763765335, decouple_loss:0.012818429619073868
The generated pressure mean: 0.448962539434433
loss_pred:0.02436598762869835, decouple_loss:0.012981036677956581
Iteration: 1232, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.447936087846756
loss_pred:0.02449500560760498, decouple_loss:0.012024438939988613
The generated pressure mean: 0.4490032494068146The generated pressure mean: 0.4493504762649536
loss_pred:0.022351277992129326, decouple_loss:0.011941496282815933
loss_pred:0.022409478202462196, decouple_loss:0.012870161794126034
Iteration: 1233, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44894906878471375
loss_pred:0.021939637139439583, decouple_loss:0.011854495853185654
The generated pressure mean: 0.4482552409172058
loss_pred:0.022699862718582153, decouple_loss:0.011952067725360394
The generated pressure mean: 0.44835165143013
loss_pred:0.022232191637158394, decouple_loss:0.011916565708816051
Iteration: 1234, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4489519000053406
loss_pred:0.02629747986793518, decouple_loss:0.012158320285379887
The generated pressure mean: 0.4478704631328583
loss_pred:0.0236078891903162, decouple_loss:0.012894616462290287
The generated pressure mean: 0.4476643204689026
loss_pred:0.02298097312450409, decouple_loss:0.0119323106482625
Iteration: 1235, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44804322719573975
loss_pred:0.021846413612365723, decouple_loss:0.012228526175022125
The generated pressure mean: 0.4478285312652588
loss_pred:0.02459643967449665, decouple_loss:0.012837089598178864
The generated pressure mean: 0.4486014246940613
loss_pred:0.023465126752853394, decouple_loss:0.012718627229332924
Iteration: 1236, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4478100836277008
loss_pred:0.023195868358016014, decouple_loss:0.011714072898030281
The generated pressure mean: 0.4491714537143707
loss_pred:0.023647284135222435, decouple_loss:0.011630968190729618
The generated pressure mean: 0.4475058317184448
loss_pred:0.023157760500907898, decouple_loss:0.011636141687631607
Iteration: 1237, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44995930790901184
loss_pred:0.022355256602168083, decouple_loss:0.012429202906787395
The generated pressure mean: 0.44907325506210327
loss_pred:0.02314140647649765, decouple_loss:0.012555996887385845
The generated pressure mean: 0.4480293095111847
loss_pred:0.02180892415344715, decouple_loss:0.01160526741296053
Iteration: 1238, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4485319256782532
The generated pressure mean: 0.4495999813079834
loss_pred:0.022517334669828415, decouple_loss:0.011368745006620884
loss_pred:0.02103569358587265, decouple_loss:0.01138952374458313
The generated pressure mean: 0.44772833585739136
loss_pred:0.022257519885897636, decouple_loss:0.011414514854550362
Iteration: 1239, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4490899443626404
loss_pred:0.021879345178604126, decouple_loss:0.01277596689760685
The generated pressure mean: 0.44869619607925415
loss_pred:0.020913289859890938, decouple_loss:0.012480288743972778
The generated pressure mean: 0.44903406500816345
loss_pred:0.022924136370420456, decouple_loss:0.01375980768352747
Iteration: 1240, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44786307215690613
The generated pressure mean: 0.448600709438324
loss_pred:0.024155355989933014, decouple_loss:0.012195173650979996
loss_pred:0.0220420490950346, decouple_loss:0.012806164100766182
The generated pressure mean: 0.44871965050697327
loss_pred:0.024292629212141037, decouple_loss:0.012052358128130436
2023-04-16 06:23:09 testing...
The generated pressure mean: 0.4502691924571991
loss_pred:0.14105792343616486, decouple_loss:0.06336120516061783
The generated pressure mean: 0.45032310485839844
loss_pred:0.1386648416519165, decouple_loss:0.06331900507211685
The generated pressure mean: 0.45002874732017517
loss_pred:0.1397550255060196, decouple_loss:0.06283309310674667
Loss: 0.14298447966575623, avg_mse: 0.2701217532157898
current test mse: 0.270122
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012012_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012012_3_24hr.npz
NaN value num: 0
Iteration: 1241, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4492262601852417
loss_pred:0.023604242131114006, decouple_loss:0.012912962585687637
The generated pressure mean: 0.44761061668395996
loss_pred:0.024998558685183525, decouple_loss:0.012047173455357552
The generated pressure mean: 0.4474813938140869
loss_pred:0.02261391654610634, decouple_loss:0.012370660901069641
Iteration: 1242, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44827598333358765
loss_pred:0.023199938237667084, decouple_loss:0.011650913394987583
The generated pressure mean: 0.4478794038295746
loss_pred:0.022660085931420326, decouple_loss:0.011837347410619259
The generated pressure mean: 0.4482916593551636
loss_pred:0.022934412583708763, decouple_loss:0.011870916932821274
Iteration: 1243, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4470517337322235
loss_pred:0.02245105430483818, decouple_loss:0.011838166043162346
The generated pressure mean: 0.44847220182418823
loss_pred:0.023388857021927834, decouple_loss:0.012247790582478046
The generated pressure mean: 0.44786056876182556
loss_pred:0.022664304822683334, decouple_loss:0.011921529658138752
Iteration: 1244, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4468576908111572
loss_pred:0.02428358420729637, decouple_loss:0.012002762407064438
The generated pressure mean: 0.4486946165561676
loss_pred:0.02286241576075554, decouple_loss:0.01205264963209629
The generated pressure mean: 0.448694109916687
loss_pred:0.02255197800695896, decouple_loss:0.01218091044574976
Iteration: 1245, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.447896808385849
loss_pred:0.023136962205171585, decouple_loss:0.012433262541890144
The generated pressure mean: 0.44804808497428894
loss_pred:0.0225357823073864, decouple_loss:0.013148619793355465
The generated pressure mean: 0.4490710496902466
loss_pred:0.02299005351960659, decouple_loss:0.012237697839736938
Iteration: 1246, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44712159037590027
loss_pred:0.022096386179327965, decouple_loss:0.012746503576636314
The generated pressure mean: 0.44822826981544495
loss_pred:0.024740470573306084, decouple_loss:0.012869450263679028
The generated pressure mean: 0.4484718143939972
loss_pred:0.02207196317613125, decouple_loss:0.012096664868295193
Iteration: 1247, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4475335478782654
loss_pred:0.022649863734841347, decouple_loss:0.01283077709376812
The generated pressure mean: 0.44799286127090454
loss_pred:0.023572709411382675, decouple_loss:0.012874587439000607
The generated pressure mean: 0.4465519189834595
loss_pred:0.022354381158947945, decouple_loss:0.012475387193262577
Iteration: 1248, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44861337542533875The generated pressure mean: 0.4489627778530121
loss_pred:0.025005698204040527, decouple_loss:0.011601396836340427loss_pred:0.02326618880033493, decouple_loss:0.011183353140950203
The generated pressure mean: 0.44775834679603577
loss_pred:0.02307608351111412, decouple_loss:0.010888735763728619
Iteration: 1249, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44921502470970154
loss_pred:0.023513810709118843, decouple_loss:0.012614820152521133
The generated pressure mean: 0.44835853576660156
loss_pred:0.023651309311389923, decouple_loss:0.012607134878635406
The generated pressure mean: 0.44736573100090027
loss_pred:0.023083291947841644, decouple_loss:0.01146857999265194
Iteration: 1250, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.448093980550766
The generated pressure mean: 0.44800063967704773
loss_pred:0.022585969418287277, decouple_loss:0.011841269209980965
loss_pred:0.022264916449785233, decouple_loss:0.012065121904015541
The generated pressure mean: 0.4484817683696747
loss_pred:0.022409498691558838, decouple_loss:0.01172041054815054
2023-04-16 06:25:48 testing...
The generated pressure mean: 0.4502691328525543
loss_pred:0.13658322393894196, decouple_loss:0.06167610362172127
The generated pressure mean: 0.4503225088119507
loss_pred:0.13435228168964386, decouple_loss:0.06131085753440857
The generated pressure mean: 0.4500306248664856
loss_pred:0.13539771735668182, decouple_loss:0.06105929985642433
Loss: 0.13851185142993927, avg_mse: 0.2598371207714081
current test mse: 0.259837
Iteration: 1251, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44744765758514404
The generated pressure mean: 0.4483097791671753
loss_pred:0.02285158820450306, decouple_loss:0.012026049196720123
loss_pred:0.02312225103378296, decouple_loss:0.012341749854385853
The generated pressure mean: 0.4478603005409241
loss_pred:0.021792957559227943, decouple_loss:0.012149257585406303
Iteration: 1252, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44759371876716614
loss_pred:0.02184250019490719, decouple_loss:0.011391929350793362
The generated pressure mean: 0.44858962297439575
loss_pred:0.022203650325536728, decouple_loss:0.011404463090002537
The generated pressure mean: 0.4480644464492798
loss_pred:0.02244189754128456, decouple_loss:0.01107726152986288
Iteration: 1253, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4483940005302429
loss_pred:0.023885587230324745, decouple_loss:0.012257339432835579The generated pressure mean: 0.4473530054092407
loss_pred:0.023382991552352905, decouple_loss:0.011505251750349998
The generated pressure mean: 0.4482678472995758
loss_pred:0.023110102862119675, decouple_loss:0.011689337901771069
Iteration: 1254, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44780784845352173
loss_pred:0.022191034629940987, decouple_loss:0.011571965180337429
The generated pressure mean: 0.4481261074542999
loss_pred:0.022439561784267426, decouple_loss:0.011666947044432163
The generated pressure mean: 0.4477761387825012
loss_pred:0.022480936720967293, decouple_loss:0.012387475930154324
Iteration: 1255, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44871604442596436
loss_pred:0.022517915815114975, decouple_loss:0.012387736700475216
The generated pressure mean: 0.44827696681022644
loss_pred:0.022388067096471786, decouple_loss:0.012129874899983406
The generated pressure mean: 0.4490335285663605
loss_pred:0.022361047565937042, decouple_loss:0.012331094592809677
Iteration: 1256, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44946378469467163
loss_pred:0.02268277481198311, decouple_loss:0.01206828374415636
The generated pressure mean: 0.44751396775245667
loss_pred:0.024009723216295242, decouple_loss:0.01152854971587658
The generated pressure mean: 0.4492641091346741
loss_pred:0.02292293682694435, decouple_loss:0.011950859799981117
Iteration: 1257, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4481998085975647
loss_pred:0.023614026606082916, decouple_loss:0.012381150387227535
The generated pressure mean: 0.44620299339294434
loss_pred:0.022125231102108955, decouple_loss:0.01178169995546341
The generated pressure mean: 0.4480145573616028
loss_pred:0.021375257521867752, decouple_loss:0.012093530967831612
Iteration: 1258, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44800952076911926
loss_pred:0.022651271894574165, decouple_loss:0.01196025125682354
The generated pressure mean: 0.4483974575996399
loss_pred:0.020682066679000854, decouple_loss:0.012315573170781136
The generated pressure mean: 0.4492435157299042
loss_pred:0.02279018796980381, decouple_loss:0.012496665120124817
Iteration: 1259, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4493415951728821
loss_pred:0.022526828572154045, decouple_loss:0.012091683223843575
The generated pressure mean: 0.44830673933029175
loss_pred:0.02190244011580944, decouple_loss:0.011775759980082512
The generated pressure mean: 0.4481829106807709
loss_pred:0.023704582825303078, decouple_loss:0.011908692307770252
Iteration: 1260, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44742757081985474
loss_pred:0.023440713062882423, decouple_loss:0.01217093225568533
The generated pressure mean: 0.44874754548072815
loss_pred:0.02351299114525318, decouple_loss:0.01247760932892561
The generated pressure mean: 0.4469566345214844
loss_pred:0.022240590304136276, decouple_loss:0.011834850534796715
2023-04-16 06:27:54 testing...
The generated pressure mean: 0.4502691328525543
loss_pred:0.1412261426448822, decouple_loss:0.06266900151968002
The generated pressure mean: 0.4503234624862671
loss_pred:0.13871155679225922, decouple_loss:0.0628850981593132
The generated pressure mean: 0.4500316381454468
loss_pred:0.1397262066602707, decouple_loss:0.062022510915994644
Loss: 0.14301425218582153, avg_mse: 0.2692206799983978
current test mse: 0.269221
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012001_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012001_3_24hr.npz
NaN value num: 0
Iteration: 1261, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4477669298648834
loss_pred:0.022491993382573128, decouple_loss:0.013043715618550777
The generated pressure mean: 0.4483814835548401
loss_pred:0.024134596809744835, decouple_loss:0.013044022023677826
The generated pressure mean: 0.44776737689971924
loss_pred:0.022251924499869347, decouple_loss:0.012807118706405163
Iteration: 1262, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44812607765197754
loss_pred:0.0224025659263134, decouple_loss:0.013587644323706627
The generated pressure mean: 0.44932958483695984
loss_pred:0.02190641313791275, decouple_loss:0.014241239987313747
The generated pressure mean: 0.4471985101699829
loss_pred:0.02265307307243347, decouple_loss:0.013920046389102936
Iteration: 1263, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44852158427238464The generated pressure mean: 0.44882118701934814
loss_pred:0.022181950509548187, decouple_loss:0.012848409824073315loss_pred:0.02145247533917427, decouple_loss:0.013414201326668262
The generated pressure mean: 0.4484216272830963
loss_pred:0.022305067628622055, decouple_loss:0.012662195600569248
Iteration: 1264, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4479627311229706
loss_pred:0.023688625544309616, decouple_loss:0.012350761331617832
The generated pressure mean: 0.44823968410491943
loss_pred:0.023403018712997437, decouple_loss:0.012028226628899574
The generated pressure mean: 0.4471973776817322
loss_pred:0.024327164515852928, decouple_loss:0.011707649566233158
Iteration: 1265, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44748860597610474
loss_pred:0.02405191771686077, decouple_loss:0.013587701134383678
The generated pressure mean: 0.44774043560028076
loss_pred:0.02204841375350952, decouple_loss:0.01486020628362894
The generated pressure mean: 0.44760000705718994
loss_pred:0.021747715771198273, decouple_loss:0.014395914040505886
Iteration: 1266, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44878605008125305
loss_pred:0.02195362187922001, decouple_loss:0.01388006005436182
The generated pressure mean: 0.4473649859428406
loss_pred:0.023744696751236916, decouple_loss:0.013056399300694466
The generated pressure mean: 0.44697827100753784
loss_pred:0.021961728110909462, decouple_loss:0.013437415473163128
Iteration: 1267, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44741496443748474
loss_pred:0.0231974795460701, decouple_loss:0.012874388135969639
The generated pressure mean: 0.4487544596195221
loss_pred:0.024186039343476295, decouple_loss:0.012419725768268108
The generated pressure mean: 0.4481099545955658
loss_pred:0.020984439179301262, decouple_loss:0.012456214986741543
Iteration: 1268, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44897574186325073The generated pressure mean: 0.4478691816329956
loss_pred:0.023284856230020523, decouple_loss:0.01477466057986021
loss_pred:0.024048522114753723, decouple_loss:0.014732715673744678
The generated pressure mean: 0.4476097524166107
loss_pred:0.022458728402853012, decouple_loss:0.014914846047759056
Iteration: 1269, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.447951078414917
loss_pred:0.024362735450267792, decouple_loss:0.01280187163501978
The generated pressure mean: 0.44753071665763855
loss_pred:0.02257796749472618, decouple_loss:0.013775830157101154
The generated pressure mean: 0.44778087735176086
loss_pred:0.022001298144459724, decouple_loss:0.013136968947947025
Iteration: 1270, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44804587960243225
loss_pred:0.022141853347420692, decouple_loss:0.011537504382431507
The generated pressure mean: 0.44786933064460754
loss_pred:0.022986864671111107, decouple_loss:0.011904150247573853
The generated pressure mean: 0.4475267827510834
loss_pred:0.02259722165763378, decouple_loss:0.01127858180552721
2023-04-16 06:30:33 testing...
The generated pressure mean: 0.4502691328525543
loss_pred:0.13510842621326447, decouple_loss:0.05905701965093613
The generated pressure mean: 0.45032593607902527
loss_pred:0.13276754319667816, decouple_loss:0.058745477348566055
The generated pressure mean: 0.4500308632850647
loss_pred:0.1336754560470581, decouple_loss:0.05847267806529999
Loss: 0.13678839802742004, avg_mse: 0.2570314109325409
current test mse: 0.257031
Iteration: 1271, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44869428873062134
loss_pred:0.022248463705182076, decouple_loss:0.013445980846881866
The generated pressure mean: 0.44777730107307434
loss_pred:0.02122972533106804, decouple_loss:0.013161617331206799
The generated pressure mean: 0.44788092374801636
loss_pred:0.022327855229377747, decouple_loss:0.011850709095597267
Iteration: 1272, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44802799820899963
loss_pred:0.024566875770688057, decouple_loss:0.011943129822611809
The generated pressure mean: 0.44743043184280396
loss_pred:0.021922742947936058, decouple_loss:0.012219808995723724
The generated pressure mean: 0.4470959007740021
loss_pred:0.022864116355776787, decouple_loss:0.012906139716506004
Iteration: 1273, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4486124515533447
loss_pred:0.022373270243406296, decouple_loss:0.012836596928536892
The generated pressure mean: 0.44728100299835205
The generated pressure mean: 0.4478503465652466loss_pred:0.02443879470229149, decouple_loss:0.01323440857231617
loss_pred:0.02204844355583191, decouple_loss:0.01275782473385334
Iteration: 1274, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4472513496875763
loss_pred:0.02124890685081482, decouple_loss:0.012423309497535229
The generated pressure mean: 0.44694873690605164
loss_pred:0.023082446306943893, decouple_loss:0.012034697458148003
The generated pressure mean: 0.4466434419155121
loss_pred:0.023213479667901993, decouple_loss:0.012629689648747444
Iteration: 1275, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44878605008125305
loss_pred:0.02285926043987274, decouple_loss:0.012789521366357803
The generated pressure mean: 0.4478910565376282
loss_pred:0.022966332733631134, decouple_loss:0.012771940790116787
The generated pressure mean: 0.4466708302497864
loss_pred:0.024130402132868767, decouple_loss:0.012357842177152634
Iteration: 1276, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4472690522670746
loss_pred:0.022669592872262, decouple_loss:0.012093228287994862
The generated pressure mean: 0.44827261567115784
loss_pred:0.023159699514508247, decouple_loss:0.013111183419823647
The generated pressure mean: 0.4474671483039856
loss_pred:0.0207272507250309, decouple_loss:0.012074402533471584
Iteration: 1277, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4467190206050873
loss_pred:0.022502031177282333, decouple_loss:0.012517880648374557
The generated pressure mean: 0.4472045600414276
loss_pred:0.02253623865544796, decouple_loss:0.012040462344884872
The generated pressure mean: 0.44717684388160706
loss_pred:0.022600457072257996, decouple_loss:0.011600133962929249
Iteration: 1278, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44722527265548706
loss_pred:0.021520907059311867, decouple_loss:0.012235011905431747
The generated pressure mean: 0.44710469245910645
loss_pred:0.02233225107192993, decouple_loss:0.012366211973130703
The generated pressure mean: 0.4477335512638092
loss_pred:0.02236265502870083, decouple_loss:0.011408372782170773
Iteration: 1279, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44872111082077026
loss_pred:0.022537516430020332, decouple_loss:0.011943289078772068
The generated pressure mean: 0.4479687511920929
loss_pred:0.023095978423953056, decouple_loss:0.011727225966751575
The generated pressure mean: 0.4475102424621582
loss_pred:0.022233933210372925, decouple_loss:0.011548878625035286
Iteration: 1280, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44774824380874634
loss_pred:0.022556347772479057, decouple_loss:0.011097382754087448
The generated pressure mean: 0.44774019718170166
loss_pred:0.0222625695168972, decouple_loss:0.01136009581387043
The generated pressure mean: 0.44872137904167175
loss_pred:0.02120830863714218, decouple_loss:0.011127556674182415
2023-04-16 06:32:38 testing...
The generated pressure mean: 0.4502691924571991
loss_pred:0.13890330493450165, decouple_loss:0.06174534559249878
The generated pressure mean: 0.45032310485839844
loss_pred:0.136649951338768, decouple_loss:0.0617809034883976
The generated pressure mean: 0.45003053545951843
loss_pred:0.13795097172260284, decouple_loss:0.06118253618478775
Loss: 0.1409132331609726, avg_mse: 0.26604846119880676
current test mse: 0.266048
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012020_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012020_3_24hr.npz
NaN value num: 0
Iteration: 1281, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44878876209259033
loss_pred:0.022867394611239433, decouple_loss:0.011315058916807175
The generated pressure mean: 0.4509544372558594
loss_pred:0.023529887199401855, decouple_loss:0.011166886426508427
The generated pressure mean: 0.45091649889945984
loss_pred:0.024290677160024643, decouple_loss:0.011169279925525188
Iteration: 1282, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4495426416397095
loss_pred:0.02354685589671135, decouple_loss:0.011338719166815281
The generated pressure mean: 0.45030006766319275
loss_pred:0.02199426107108593, decouple_loss:0.011475696228444576
The generated pressure mean: 0.45047566294670105
loss_pred:0.02216280624270439, decouple_loss:0.01113914605230093
Iteration: 1283, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45068079233169556
loss_pred:0.023027906194329262, decouple_loss:0.011585983447730541
The generated pressure mean: 0.4506579041481018
loss_pred:0.022654099389910698, decouple_loss:0.01152726635336876
The generated pressure mean: 0.449285089969635
loss_pred:0.022146740928292274, decouple_loss:0.011204739101231098
Iteration: 1284, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4496217668056488
loss_pred:0.022696124389767647, decouple_loss:0.01134367287158966
The generated pressure mean: 0.4499239921569824
loss_pred:0.0239569041877985, decouple_loss:0.01160997524857521
The generated pressure mean: 0.4487026035785675
loss_pred:0.023634344339370728, decouple_loss:0.011317423544824123
Iteration: 1285, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45034897327423096
loss_pred:0.023417077958583832, decouple_loss:0.011524002067744732
The generated pressure mean: 0.44918593764305115
loss_pred:0.023503202944993973, decouple_loss:0.01090359315276146
The generated pressure mean: 0.45077022910118103
loss_pred:0.02287106402218342, decouple_loss:0.012237037532031536
Iteration: 1286, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4492860734462738
loss_pred:0.025763481855392456, decouple_loss:0.011262982152402401
The generated pressure mean: 0.45081162452697754
loss_pred:0.02283976785838604, decouple_loss:0.011625193059444427
The generated pressure mean: 0.45180845260620117
loss_pred:0.02431732788681984, decouple_loss:0.011487876996397972
Iteration: 1287, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4507431387901306
loss_pred:0.022983592003583908, decouple_loss:0.01181838195770979
The generated pressure mean: 0.44989797472953796
loss_pred:0.02422998659312725, decouple_loss:0.012748225592076778
The generated pressure mean: 0.4513508677482605
loss_pred:0.022707827389240265, decouple_loss:0.012716238386929035
Iteration: 1288, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4507192373275757
The generated pressure mean: 0.45027318596839905loss_pred:0.023123905062675476, decouple_loss:0.011404327116906643
loss_pred:0.02205555886030197, decouple_loss:0.010957441292703152
The generated pressure mean: 0.45043596625328064
loss_pred:0.022449947893619537, decouple_loss:0.011067735031247139
Iteration: 1289, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4499276578426361
loss_pred:0.023105747997760773, decouple_loss:0.011027765460312366
The generated pressure mean: 0.44968217611312866
loss_pred:0.022346176207065582, decouple_loss:0.01122362818568945
The generated pressure mean: 0.44947487115859985
loss_pred:0.02291852794587612, decouple_loss:0.011002050712704659
Iteration: 1290, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4498220384120941
loss_pred:0.026077598333358765, decouple_loss:0.010820738039910793
The generated pressure mean: 0.44929811358451843
loss_pred:0.023565996438264847, decouple_loss:0.011491513811051846
The generated pressure mean: 0.4499799311161041
loss_pred:0.02213180996477604, decouple_loss:0.01097829919308424
2023-04-16 06:35:23 testing...
The generated pressure mean: 0.4502691626548767
loss_pred:0.13591553270816803, decouple_loss:0.058891888707876205
The generated pressure mean: 0.450323224067688
loss_pred:0.13316760957241058, decouple_loss:0.05900238826870918
The generated pressure mean: 0.4500318765640259
loss_pred:0.13447163999080658, decouple_loss:0.05882839858531952
Loss: 0.13746364414691925, avg_mse: 0.25696438550949097
current test mse: 0.256964
Iteration: 1291, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45085543394088745
loss_pred:0.023457515984773636, decouple_loss:0.012094452045857906
The generated pressure mean: 0.4501590132713318
loss_pred:0.023410074412822723, decouple_loss:0.011454141698777676
The generated pressure mean: 0.4499239921569824
loss_pred:0.0230651143938303, decouple_loss:0.011588575318455696
Iteration: 1292, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45129096508026123
loss_pred:0.02214939519762993, decouple_loss:0.011754653416574001
The generated pressure mean: 0.4499768614768982
loss_pred:0.0220992099493742, decouple_loss:0.01137740258127451
The generated pressure mean: 0.4499075710773468
loss_pred:0.023066053166985512, decouple_loss:0.011073487810790539
Iteration: 1293, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45023488998413086
The generated pressure mean: 0.45140185952186584loss_pred:0.023019222542643547, decouple_loss:0.011756441555917263
loss_pred:0.023455942049622536, decouple_loss:0.011821792460978031
The generated pressure mean: 0.4510951042175293
loss_pred:0.02461843565106392, decouple_loss:0.011703366413712502
Iteration: 1294, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4505082368850708
loss_pred:0.023337341845035553, decouple_loss:0.012517312541604042
The generated pressure mean: 0.45046165585517883
loss_pred:0.023961052298545837, decouple_loss:0.011614012531936169
The generated pressure mean: 0.4501315653324127
loss_pred:0.02274738810956478, decouple_loss:0.011770203709602356
Iteration: 1295, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4503755569458008
loss_pred:0.02226295694708824, decouple_loss:0.010868893936276436
The generated pressure mean: 0.4497924745082855
loss_pred:0.025745496153831482, decouple_loss:0.011317574419081211
The generated pressure mean: 0.4498298466205597
loss_pred:0.023542053997516632, decouple_loss:0.01100523117929697
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1296, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4492590129375458
loss_pred:0.02288917638361454, decouple_loss:0.011113329790532589
The generated pressure mean: 0.45136407017707825
loss_pred:0.022377241402864456, decouple_loss:0.011086268350481987
The generated pressure mean: 0.4497092664241791
loss_pred:0.022101636976003647, decouple_loss:0.010690455324947834
Iteration: 1297, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4507087469100952
loss_pred:0.02305597998201847, decouple_loss:0.011426159180700779
The generated pressure mean: 0.45001333951950073
loss_pred:0.022288214415311813, decouple_loss:0.011359822005033493
The generated pressure mean: 0.45083075761795044
loss_pred:0.024857603013515472, decouple_loss:0.011649981141090393
Iteration: 1298, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4511689841747284
loss_pred:0.02606530487537384, decouple_loss:0.012659058906137943
The generated pressure mean: 0.45126089453697205
loss_pred:0.023195022717118263, decouple_loss:0.012202674522995949
The generated pressure mean: 0.4500468969345093
loss_pred:0.02250485308468342, decouple_loss:0.011909328401088715
Iteration: 1299, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4506770670413971
loss_pred:0.022556524723768234, decouple_loss:0.010622818022966385
The generated pressure mean: 0.45024004578590393
loss_pred:0.022509071975946426, decouple_loss:0.011120057664811611
The generated pressure mean: 0.4502285420894623
loss_pred:0.022691916674375534, decouple_loss:0.011155540123581886
Iteration: 1300, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4507252275943756
loss_pred:0.022057177498936653, decouple_loss:0.010259093716740608
The generated pressure mean: 0.45102107524871826
loss_pred:0.022544095292687416, decouple_loss:0.010546932928264141
The generated pressure mean: 0.45119553804397583
loss_pred:0.02287047728896141, decouple_loss:0.010751320980489254
2023-04-16 06:37:29 testing...
The generated pressure mean: 0.4502691328525543
loss_pred:0.13810300827026367, decouple_loss:0.061339281499385834
The generated pressure mean: 0.45032331347465515
loss_pred:0.13603250682353973, decouple_loss:0.06171853467822075
The generated pressure mean: 0.45003145933151245
loss_pred:0.1369837373495102, decouple_loss:0.06094624474644661
Loss: 0.14010648429393768, avg_mse: 0.26588335633277893
current test mse: 0.265883
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012014_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012014_3_24hr.npz
NaN value num: 0
Iteration: 1301, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4479339122772217
loss_pred:0.022476566955447197, decouple_loss:0.013168958947062492
The generated pressure mean: 0.4489120543003082
The generated pressure mean: 0.4472733438014984
loss_pred:0.0229488518089056, decouple_loss:0.012911349534988403
loss_pred:0.025481736287474632, decouple_loss:0.01256071962416172
Iteration: 1302, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44784098863601685
loss_pred:0.021231073886156082, decouple_loss:0.013484150171279907
The generated pressure mean: 0.4481619596481323
loss_pred:0.021661067381501198, decouple_loss:0.013833527453243732
The generated pressure mean: 0.4483332633972168
loss_pred:0.02299967035651207, decouple_loss:0.013760809786617756
Iteration: 1303, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4481850266456604
loss_pred:0.022007985040545464, decouple_loss:0.011792215518653393
The generated pressure mean: 0.4483327269554138
loss_pred:0.0228875782340765, decouple_loss:0.011697686277329922
The generated pressure mean: 0.44813650846481323
loss_pred:0.022899597883224487, decouple_loss:0.012664679437875748
Iteration: 1304, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4471544325351715
loss_pred:0.023775869980454445, decouple_loss:0.011582701466977596
The generated pressure mean: 0.4481181502342224
loss_pred:0.02209390327334404, decouple_loss:0.011065490543842316
The generated pressure mean: 0.4487951993942261
loss_pred:0.02178254723548889, decouple_loss:0.011365203186869621
Iteration: 1305, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44837984442710876
loss_pred:0.02355896309018135, decouple_loss:0.012194761075079441
The generated pressure mean: 0.4466971457004547
loss_pred:0.02274850755929947, decouple_loss:0.011758224107325077
The generated pressure mean: 0.4478389322757721
loss_pred:0.022308044135570526, decouple_loss:0.011649258434772491
Iteration: 1306, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4481012225151062
The generated pressure mean: 0.44781187176704407
loss_pred:0.023661382496356964, decouple_loss:0.011688188649713993
loss_pred:0.021180180832743645, decouple_loss:0.01160005759447813
The generated pressure mean: 0.44844457507133484
loss_pred:0.023362919688224792, decouple_loss:0.011897265911102295
Iteration: 1307, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4474116861820221
loss_pred:0.02287193387746811, decouple_loss:0.012195805087685585
The generated pressure mean: 0.44779571890830994
loss_pred:0.022196944802999496, decouple_loss:0.011647316627204418
The generated pressure mean: 0.44831815361976624
loss_pred:0.022417226806282997, decouple_loss:0.011817492544651031
Iteration: 1308, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44828495383262634
loss_pred:0.021355174481868744, decouple_loss:0.011060353368520737
The generated pressure mean: 0.4479578137397766
loss_pred:0.021978063508868217, decouple_loss:0.011599967256188393
The generated pressure mean: 0.4491353929042816
loss_pred:0.022535055875778198, decouple_loss:0.011403806507587433
Iteration: 1309, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44824305176734924
loss_pred:0.02266298048198223, decouple_loss:0.011149818077683449
The generated pressure mean: 0.4476374387741089
loss_pred:0.02163146436214447, decouple_loss:0.010724521242082119
The generated pressure mean: 0.44770973920822144
loss_pred:0.02252841554582119, decouple_loss:0.011298109777271748
Iteration: 1310, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4477064609527588
loss_pred:0.021837778389453888, decouple_loss:0.011255851946771145
The generated pressure mean: 0.44958239793777466
loss_pred:0.021560175344347954, decouple_loss:0.01142857875674963
The generated pressure mean: 0.4488390386104584
loss_pred:0.02319328486919403, decouple_loss:0.010997072793543339
2023-04-16 06:40:08 testing...
The generated pressure mean: 0.4502691626548767
loss_pred:0.13807407021522522, decouple_loss:0.0602414645254612
The generated pressure mean: 0.4503251314163208
loss_pred:0.1360885202884674, decouple_loss:0.06032254546880722
The generated pressure mean: 0.4500303864479065
loss_pred:0.13726551830768585, decouple_loss:0.05981970205903053
Loss: 0.1401491016149521, avg_mse: 0.2648382782936096
current test mse: 0.264838
Iteration: 1311, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44791775941848755
loss_pred:0.02239140123128891, decouple_loss:0.010496332310140133
The generated pressure mean: 0.4494208097457886
loss_pred:0.022944064810872078, decouple_loss:0.010733931325376034
The generated pressure mean: 0.4482320547103882
loss_pred:0.02249983698129654, decouple_loss:0.011228200979530811
Iteration: 1312, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4479468762874603
loss_pred:0.02208864875137806, decouple_loss:0.01104272436350584
The generated pressure mean: 0.4481137692928314
loss_pred:0.022730901837348938, decouple_loss:0.011327611282467842
The generated pressure mean: 0.4483242332935333
loss_pred:0.02243409864604473, decouple_loss:0.010877992026507854
Iteration: 1313, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44738781452178955
loss_pred:0.021876586601138115, decouple_loss:0.012608473189175129
The generated pressure mean: 0.44791439175605774
loss_pred:0.022945338860154152, decouple_loss:0.012251781299710274
The generated pressure mean: 0.44874000549316406
loss_pred:0.021816138178110123, decouple_loss:0.013383413664996624
Iteration: 1314, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44855403900146484
loss_pred:0.02185749262571335, decouple_loss:0.011363662779331207
The generated pressure mean: 0.44845524430274963
loss_pred:0.022406993433833122, decouple_loss:0.011208828538656235
The generated pressure mean: 0.44830232858657837
loss_pred:0.02215130627155304, decouple_loss:0.011219209060072899
Iteration: 1315, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44886112213134766
loss_pred:0.022358037531375885, decouple_loss:0.011230465956032276
The generated pressure mean: 0.44841238856315613
loss_pred:0.023007091134786606, decouple_loss:0.011737102642655373
The generated pressure mean: 0.4477020800113678
loss_pred:0.02256625145673752, decouple_loss:0.010714570060372353
Iteration: 1316, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44837626814842224
loss_pred:0.02301374264061451, decouple_loss:0.011884697712957859
The generated pressure mean: 0.4486496150493622
loss_pred:0.022637443616986275, decouple_loss:0.011952254921197891
The generated pressure mean: 0.44754335284233093
loss_pred:0.021157091483473778, decouple_loss:0.01209092978388071
Iteration: 1317, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4480222463607788
loss_pred:0.023431461304426193, decouple_loss:0.011494643986225128
The generated pressure mean: 0.44831010699272156
loss_pred:0.022668413817882538, decouple_loss:0.013722916133701801
The generated pressure mean: 0.44895556569099426
loss_pred:0.022221583873033524, decouple_loss:0.011778072454035282
Iteration: 1318, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4480002522468567
loss_pred:0.02334274724125862, decouple_loss:0.011162861250340939
The generated pressure mean: 0.4488709270954132
loss_pred:0.023444853723049164, decouple_loss:0.011161507107317448
The generated pressure mean: 0.4467463493347168
loss_pred:0.022158639505505562, decouple_loss:0.01137965265661478
Iteration: 1319, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44752079248428345
loss_pred:0.021504860371351242, decouple_loss:0.01077478751540184
The generated pressure mean: 0.4488840103149414
loss_pred:0.021699372678995132, decouple_loss:0.011573396623134613
The generated pressure mean: 0.4480222463607788
loss_pred:0.022124841809272766, decouple_loss:0.010303204879164696
Iteration: 1320, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44783467054367065
loss_pred:0.022968096658587456, decouple_loss:0.01116442121565342
The generated pressure mean: 0.44930416345596313
loss_pred:0.023130442947149277, decouple_loss:0.01166440173983574
The generated pressure mean: 0.44948241114616394
loss_pred:0.021649939939379692, decouple_loss:0.011639040894806385
2023-04-16 06:42:14 testing...
The generated pressure mean: 0.4502691626548767
loss_pred:0.1388377696275711, decouple_loss:0.06164674460887909
The generated pressure mean: 0.4503217935562134
loss_pred:0.1369016021490097, decouple_loss:0.061792898923158646
The generated pressure mean: 0.4500289857387543
loss_pred:0.1379448026418686, decouple_loss:0.061223551630973816
Loss: 0.14097246527671814, avg_mse: 0.26843389868736267
current test mse: 0.268434
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012002_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012002_3_24hr.npz
NaN value num: 0
Iteration: 1321, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44770628213882446
loss_pred:0.024075061082839966, decouple_loss:0.013337251730263233
The generated pressure mean: 0.4466795325279236
loss_pred:0.02235511690378189, decouple_loss:0.012200665660202503
The generated pressure mean: 0.4475889205932617
loss_pred:0.021966757252812386, decouple_loss:0.012366898357868195
Iteration: 1322, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4463772177696228
loss_pred:0.02222861535847187, decouple_loss:0.010878527536988258
The generated pressure mean: 0.4468722641468048
loss_pred:0.02383803017437458, decouple_loss:0.010863407514989376
The generated pressure mean: 0.448435515165329
loss_pred:0.02235562354326248, decouple_loss:0.01083849836140871
Iteration: 1323, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44706082344055176
loss_pred:0.02189619280397892, decouple_loss:0.01277877390384674
The generated pressure mean: 0.4484514594078064
loss_pred:0.021815229207277298, decouple_loss:0.01232362911105156
The generated pressure mean: 0.44642385840415955
loss_pred:0.023070216178894043, decouple_loss:0.01251866202801466
Iteration: 1324, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44712013006210327
loss_pred:0.02371472865343094, decouple_loss:0.011917760595679283
The generated pressure mean: 0.4472010135650635
loss_pred:0.02207796461880207, decouple_loss:0.012108303606510162
The generated pressure mean: 0.44615232944488525
loss_pred:0.022369330748915672, decouple_loss:0.012657898478209972
Iteration: 1325, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4481753408908844
loss_pred:0.02061524987220764, decouple_loss:0.011431463994085789
The generated pressure mean: 0.44655004143714905
loss_pred:0.023372832685709, decouple_loss:0.011675555258989334
The generated pressure mean: 0.4478473961353302
loss_pred:0.023798013105988503, decouple_loss:0.01144108735024929
Iteration: 1326, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4484370946884155
loss_pred:0.022396700456738472, decouple_loss:0.01096290908753872
The generated pressure mean: 0.4455837309360504
loss_pred:0.022952955216169357, decouple_loss:0.011410360224545002
The generated pressure mean: 0.44803106784820557
loss_pred:0.024420233443379402, decouple_loss:0.011223935522139072
Iteration: 1327, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4460741877555847
loss_pred:0.021784583106637, decouple_loss:0.010619335807859898
The generated pressure mean: 0.44848114252090454
loss_pred:0.023495491594076157, decouple_loss:0.010712772607803345
The generated pressure mean: 0.4467996656894684
loss_pred:0.023401441052556038, decouple_loss:0.010592392645776272
Iteration: 1328, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4477884769439697
loss_pred:0.021605920046567917, decouple_loss:0.010546445846557617
The generated pressure mean: 0.44912201166152954
loss_pred:0.02216450870037079, decouple_loss:0.010576206259429455
The generated pressure mean: 0.44689708948135376
loss_pred:0.02192115969955921, decouple_loss:0.01049330085515976
Iteration: 1329, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44768276810646057
The generated pressure mean: 0.44917047023773193
loss_pred:0.021960245445370674, decouple_loss:0.010623227804899216
loss_pred:0.021993832662701607, decouple_loss:0.010569415986537933
The generated pressure mean: 0.4472547769546509
loss_pred:0.023031147196888924, decouple_loss:0.010913794860243797
Iteration: 1330, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4482913911342621
loss_pred:0.024481380358338356, decouple_loss:0.011568904854357243
The generated pressure mean: 0.4481203854084015
loss_pred:0.020201006904244423, decouple_loss:0.01113116554915905
The generated pressure mean: 0.44779399037361145
loss_pred:0.02279498241841793, decouple_loss:0.01127366628497839
2023-04-16 06:44:54 testing...
The generated pressure mean: 0.4502691924571991
loss_pred:0.13997410237789154, decouple_loss:0.05906904861330986
The generated pressure mean: 0.450325608253479
loss_pred:0.1380990892648697, decouple_loss:0.0589320994913578
The generated pressure mean: 0.45003464818000793
loss_pred:0.1393800526857376, decouple_loss:0.05861785262823105
Loss: 0.14209473133087158, avg_mse: 0.2729107737541199
current test mse: 0.272911
Iteration: 1331, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4484076201915741
loss_pred:0.022136114537715912, decouple_loss:0.011182807385921478
The generated pressure mean: 0.44802629947662354
loss_pred:0.022814778611063957, decouple_loss:0.011747143231332302
The generated pressure mean: 0.4468415081501007
loss_pred:0.02536690980195999, decouple_loss:0.01201669778674841
Iteration: 1332, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4472729563713074
loss_pred:0.021428225561976433, decouple_loss:0.011036901734769344
The generated pressure mean: 0.44867557287216187
The generated pressure mean: 0.4475507140159607
loss_pred:0.022335179150104523, decouple_loss:0.010917633771896362
loss_pred:0.021648483350872993, decouple_loss:0.011136708781123161
Iteration: 1333, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44810253381729126
loss_pred:0.02243785560131073, decouple_loss:0.01052250899374485
The generated pressure mean: 0.4472552239894867
The generated pressure mean: 0.4473104476928711
loss_pred:0.023920822888612747, decouple_loss:0.010619782842695713
loss_pred:0.022035200148820877, decouple_loss:0.010390507988631725
Iteration: 1334, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44777369499206543
The generated pressure mean: 0.4475107789039612
loss_pred:0.02385815978050232, decouple_loss:0.011442883871495724
loss_pred:0.022910213097929955, decouple_loss:0.010403689928352833
The generated pressure mean: 0.44702523946762085
loss_pred:0.022131210193037987, decouple_loss:0.011365405283868313
Iteration: 1335, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4487088620662689
loss_pred:0.022033141925930977, decouple_loss:0.010935105383396149
The generated pressure mean: 0.44702157378196716
loss_pred:0.02327909506857395, decouple_loss:0.011456994339823723
The generated pressure mean: 0.4489743411540985
loss_pred:0.022758152335882187, decouple_loss:0.01167604885995388
Iteration: 1336, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44853442907333374
loss_pred:0.02360585704445839, decouple_loss:0.011848898604512215
The generated pressure mean: 0.4455508589744568
loss_pred:0.023940598592162132, decouple_loss:0.013083536177873611
The generated pressure mean: 0.44703418016433716
loss_pred:0.025615375488996506, decouple_loss:0.011831732466816902
Iteration: 1337, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44784632325172424
loss_pred:0.020225252956151962, decouple_loss:0.011959154158830643
The generated pressure mean: 0.4471774697303772
loss_pred:0.022411152720451355, decouple_loss:0.0128785977140069
The generated pressure mean: 0.44798359274864197
loss_pred:0.023877175524830818, decouple_loss:0.012623101472854614
Iteration: 1338, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.447806179523468The generated pressure mean: 0.4471837878227234
loss_pred:0.024742241948843002, decouple_loss:0.011133434250950813
loss_pred:0.02266608364880085, decouple_loss:0.011359602212905884
The generated pressure mean: 0.44753891229629517
loss_pred:0.021996986120939255, decouple_loss:0.011075079441070557
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1339, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4473862946033478
loss_pred:0.0233328714966774, decouple_loss:0.012032208032906055
The generated pressure mean: 0.4469969570636749
loss_pred:0.021477293223142624, decouple_loss:0.011997914873063564
The generated pressure mean: 0.4496070146560669
loss_pred:0.02195007912814617, decouple_loss:0.011419864371418953
Iteration: 1340, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4474911391735077
The generated pressure mean: 0.44645169377326965
loss_pred:0.023011978715658188, decouple_loss:0.010293831117451191
loss_pred:0.02225305698812008, decouple_loss:0.010455087758600712
The generated pressure mean: 0.4488578736782074
loss_pred:0.022016260772943497, decouple_loss:0.010658172890543938
2023-04-16 06:47:00 testing...
The generated pressure mean: 0.4502691328525543
loss_pred:0.142816424369812, decouple_loss:0.0606754869222641
The generated pressure mean: 0.4503246545791626
loss_pred:0.14079710841178894, decouple_loss:0.06033690273761749
The generated pressure mean: 0.4500308334827423
loss_pred:0.14188385009765625, decouple_loss:0.06010114774107933
Loss: 0.14485102891921997, avg_mse: 0.277779757976532
current test mse: 0.27778
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012004_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012004_3_24hr.npz
NaN value num: 0
Iteration: 1341, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4488276541233063
loss_pred:0.022500745952129364, decouple_loss:0.011852266266942024
The generated pressure mean: 0.44867900013923645
loss_pred:0.021660806611180305, decouple_loss:0.012464486993849277
The generated pressure mean: 0.44672873616218567
loss_pred:0.020630240440368652, decouple_loss:0.011452303268015385
Iteration: 1342, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44805872440338135
loss_pred:0.02228144370019436, decouple_loss:0.011657234281301498
The generated pressure mean: 0.44933223724365234The generated pressure mean: 0.4483514130115509
loss_pred:0.022252902388572693, decouple_loss:0.012528925202786922loss_pred:0.021994715556502342, decouple_loss:0.011671989224851131
Iteration: 1343, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4491899013519287
The generated pressure mean: 0.44867610931396484
loss_pred:0.021653734147548676, decouple_loss:0.012428782880306244
loss_pred:0.02173902839422226, decouple_loss:0.01223093643784523
The generated pressure mean: 0.449320912361145
loss_pred:0.022994669154286385, decouple_loss:0.012246121652424335
Iteration: 1344, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44836685061454773
The generated pressure mean: 0.4499289393424988loss_pred:0.021769793704152107, decouple_loss:0.011405129916965961
loss_pred:0.021899975836277008, decouple_loss:0.011732950806617737
The generated pressure mean: 0.44876036047935486
loss_pred:0.022792363539338112, decouple_loss:0.011941441334784031
Iteration: 1345, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4484606683254242
loss_pred:0.020734328776597977, decouple_loss:0.01142653077840805
The generated pressure mean: 0.44883450865745544
loss_pred:0.020640557631850243, decouple_loss:0.011753629893064499
The generated pressure mean: 0.4485378563404083
loss_pred:0.021013252437114716, decouple_loss:0.012590339407324791
Iteration: 1346, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4488607943058014
loss_pred:0.02267325296998024, decouple_loss:0.012085304595530033
The generated pressure mean: 0.4485021233558655
loss_pred:0.022301172837615013, decouple_loss:0.012091741897165775
The generated pressure mean: 0.449291855096817
loss_pred:0.022203223779797554, decouple_loss:0.011772038415074348
Iteration: 1347, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44936510920524597
The generated pressure mean: 0.4486362338066101
loss_pred:0.022348331287503242, decouple_loss:0.012165951542556286
loss_pred:0.02112828567624092, decouple_loss:0.011875055730342865
The generated pressure mean: 0.4492943584918976
loss_pred:0.0215363297611475, decouple_loss:0.012036682106554508
Iteration: 1348, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4487496018409729
The generated pressure mean: 0.44886016845703125
loss_pred:0.02204081043601036, decouple_loss:0.010879455134272575
loss_pred:0.022223303094506264, decouple_loss:0.010947654955089092
The generated pressure mean: 0.44894903898239136
loss_pred:0.02239902876317501, decouple_loss:0.011025783605873585
Iteration: 1349, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4490489661693573
The generated pressure mean: 0.447060763835907
loss_pred:0.02342827245593071, decouple_loss:0.013568838126957417
loss_pred:0.02172514982521534, decouple_loss:0.012828856706619263
The generated pressure mean: 0.44818592071533203
loss_pred:0.02115091308951378, decouple_loss:0.01232951320707798
Iteration: 1350, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44764456152915955
loss_pred:0.02216808684170246, decouple_loss:0.011501042172312737
The generated pressure mean: 0.4489290416240692
loss_pred:0.0221378356218338, decouple_loss:0.012320865876972675
The generated pressure mean: 0.4501954913139343
loss_pred:0.02323155477643013, decouple_loss:0.012141975574195385
2023-04-16 06:49:41 testing...
The generated pressure mean: 0.4502691328525543
loss_pred:0.14339517056941986, decouple_loss:0.059308405965566635
The generated pressure mean: 0.45032501220703125
loss_pred:0.14121150970458984, decouple_loss:0.05971834436058998
The generated pressure mean: 0.4500308930873871
loss_pred:0.14243105053901672, decouple_loss:0.05925413593649864
Loss: 0.14531727135181427, avg_mse: 0.27860167622566223
current test mse: 0.278602
Iteration: 1351, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44736573100090027
loss_pred:0.02171449549496174, decouple_loss:0.01128445751965046
The generated pressure mean: 0.4492323100566864
loss_pred:0.02163660153746605, decouple_loss:0.011873341165482998
The generated pressure mean: 0.44816482067108154
loss_pred:0.021096883341670036, decouple_loss:0.010666342452168465
Iteration: 1352, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4493357837200165
loss_pred:0.020281238481402397, decouple_loss:0.0121184466406703
The generated pressure mean: 0.44921019673347473
The generated pressure mean: 0.4478500187397003
loss_pred:0.02151007577776909, decouple_loss:0.012736091390252113
loss_pred:0.0201483853161335, decouple_loss:0.013179879635572433
Iteration: 1353, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44811591506004333
loss_pred:0.022328287363052368, decouple_loss:0.012240459211170673
The generated pressure mean: 0.4478943645954132
loss_pred:0.022146714851260185, decouple_loss:0.012120181694626808
The generated pressure mean: 0.44980740547180176
loss_pred:0.0225288737565279, decouple_loss:0.011972786858677864
Iteration: 1354, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4483241140842438
loss_pred:0.021828366443514824, decouple_loss:0.011062993668019772
The generated pressure mean: 0.450778603553772
loss_pred:0.02198161743581295, decouple_loss:0.011444693431258202
The generated pressure mean: 0.44795650243759155
loss_pred:0.02176603488624096, decouple_loss:0.011463028378784657
Iteration: 1355, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4486198127269745
loss_pred:0.02156481333076954, decouple_loss:0.011907004751265049
The generated pressure mean: 0.44708436727523804
loss_pred:0.021780438721179962, decouple_loss:0.011390859261155128
The generated pressure mean: 0.44891977310180664
loss_pred:0.0214654803276062, decouple_loss:0.011366480961441994
Iteration: 1356, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44897961616516113
loss_pred:0.021526601165533066, decouple_loss:0.013006540015339851
The generated pressure mean: 0.4514594078063965
loss_pred:0.02139855921268463, decouple_loss:0.01285033393651247
The generated pressure mean: 0.4494125247001648
loss_pred:0.021297356113791466, decouple_loss:0.01291359681636095
Iteration: 1357, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44998231530189514
loss_pred:0.021367967128753662, decouple_loss:0.011494266800582409
The generated pressure mean: 0.44696810841560364
loss_pred:0.021830841898918152, decouple_loss:0.01173726748675108
The generated pressure mean: 0.4496579170227051
loss_pred:0.021178176626563072, decouple_loss:0.011894593015313148
Iteration: 1358, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.448443204164505
loss_pred:0.022646762430667877, decouple_loss:0.012648764997720718
The generated pressure mean: 0.44713398814201355
loss_pred:0.02109842374920845, decouple_loss:0.011627105996012688
The generated pressure mean: 0.4482411742210388
loss_pred:0.02170991152524948, decouple_loss:0.01268154475837946
Iteration: 1359, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4488879144191742
loss_pred:0.02145693637430668, decouple_loss:0.013725262135267258
The generated pressure mean: 0.4490785300731659
loss_pred:0.023815618827939034, decouple_loss:0.014357917942106724
The generated pressure mean: 0.44813892245292664
loss_pred:0.02187410742044449, decouple_loss:0.012712016701698303
Iteration: 1360, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.448907732963562
loss_pred:0.022245343774557114, decouple_loss:0.012257935479283333
The generated pressure mean: 0.4507562816143036
loss_pred:0.021587945520877838, decouple_loss:0.012349957600235939
The generated pressure mean: 0.4483972191810608
loss_pred:0.02406555414199829, decouple_loss:0.012549047358334064
2023-04-16 06:51:48 testing...
The generated pressure mean: 0.4502691924571991
loss_pred:0.13909588754177094, decouple_loss:0.06015919893980026
The generated pressure mean: 0.45032474398612976
loss_pred:0.13770395517349243, decouple_loss:0.05999429523944855
The generated pressure mean: 0.4500329792499542
loss_pred:0.13860242068767548, decouple_loss:0.0594748817384243
Loss: 0.14146123826503754, avg_mse: 0.27123165130615234
current test mse: 0.271232
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012005_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012005_3_24hr.npz
NaN value num: 0
Iteration: 1361, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4484538435935974
loss_pred:0.023135673254728317, decouple_loss:0.011467558331787586
The generated pressure mean: 0.4477686882019043
loss_pred:0.022489400580525398, decouple_loss:0.01133404579013586
The generated pressure mean: 0.4487854242324829
loss_pred:0.023884059861302376, decouple_loss:0.011636709794402122
Iteration: 1362, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.448965460062027
loss_pred:0.022420812398195267, decouple_loss:0.013073598966002464
The generated pressure mean: 0.4493487477302551
loss_pred:0.02201359160244465, decouple_loss:0.013192174956202507
The generated pressure mean: 0.4469267725944519
loss_pred:0.022857705131173134, decouple_loss:0.012802524492144585
Iteration: 1363, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44920891523361206
loss_pred:0.023950627073645592, decouple_loss:0.012452834285795689
The generated pressure mean: 0.4492110013961792
loss_pred:0.02352227084338665, decouple_loss:0.01288947369903326
The generated pressure mean: 0.4491480886936188
loss_pred:0.022040441632270813, decouple_loss:0.012649603188037872
Iteration: 1364, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4483224153518677
loss_pred:0.022786740213632584, decouple_loss:0.011173351667821407
The generated pressure mean: 0.44935911893844604
loss_pred:0.02217152528464794, decouple_loss:0.011409087106585503
The generated pressure mean: 0.4485698342323303
loss_pred:0.022692659869790077, decouple_loss:0.010969738475978374
Iteration: 1365, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44852468371391296
loss_pred:0.021686984226107597, decouple_loss:0.013050351291894913
The generated pressure mean: 0.44926756620407104
loss_pred:0.022879483178257942, decouple_loss:0.012244628742337227
The generated pressure mean: 0.4491974711418152
loss_pred:0.022059114649891853, decouple_loss:0.01209087111055851
Iteration: 1366, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44927892088890076
loss_pred:0.021279720589518547, decouple_loss:0.012015956453979015
The generated pressure mean: 0.44800493121147156
loss_pred:0.022409135475754738, decouple_loss:0.01158425584435463
The generated pressure mean: 0.4497181177139282
loss_pred:0.02212669886648655, decouple_loss:0.01145598478615284
Iteration: 1367, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4487815201282501
loss_pred:0.022390849888324738, decouple_loss:0.013100075535476208
The generated pressure mean: 0.44934430718421936
loss_pred:0.021416228264570236, decouple_loss:0.012864169664680958
The generated pressure mean: 0.44930073618888855
loss_pred:0.021199757233262062, decouple_loss:0.012800767086446285
Iteration: 1368, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44880467653274536
loss_pred:0.021531736478209496, decouple_loss:0.012778244912624359
The generated pressure mean: 0.4486314058303833
loss_pred:0.020532889291644096, decouple_loss:0.012764949351549149
The generated pressure mean: 0.449907124042511
loss_pred:0.02269926853477955, decouple_loss:0.012426378205418587
Iteration: 1369, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4495578706264496
loss_pred:0.023068305104970932, decouple_loss:0.01133042760193348
The generated pressure mean: 0.4491627514362335
loss_pred:0.02148282341659069, decouple_loss:0.012173415161669254
The generated pressure mean: 0.4494639039039612
loss_pred:0.022269951179623604, decouple_loss:0.011514188721776009
Iteration: 1370, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4492631256580353
loss_pred:0.02195712737739086, decouple_loss:0.012178907170891762
The generated pressure mean: 0.44723498821258545
loss_pred:0.022063566371798515, decouple_loss:0.012456190772354603
The generated pressure mean: 0.4485856294631958
loss_pred:0.02265242300927639, decouple_loss:0.012205993756651878
2023-04-16 06:54:29 testing...
The generated pressure mean: 0.4502691924571991
loss_pred:0.14114201068878174, decouple_loss:0.05903555825352669
The generated pressure mean: 0.45003142952919006
loss_pred:0.14005360007286072, decouple_loss:0.058385249227285385
The generated pressure mean: 0.4503239095211029
loss_pred:0.13901710510253906, decouple_loss:0.05935017019510269
Loss: 0.14301708340644836, avg_mse: 0.27357664704322815
current test mse: 0.273577
Iteration: 1371, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45012256503105164
loss_pred:0.023669153451919556, decouple_loss:0.01152946799993515
The generated pressure mean: 0.4495195746421814
loss_pred:0.022959591820836067, decouple_loss:0.012646034359931946
The generated pressure mean: 0.4501315951347351
loss_pred:0.02160026691854, decouple_loss:0.011436865665018559
Iteration: 1372, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44861847162246704
loss_pred:0.02255546674132347, decouple_loss:0.011781455017626286
The generated pressure mean: 0.44809049367904663
loss_pred:0.021550077944993973, decouple_loss:0.011777889914810658
The generated pressure mean: 0.4490477740764618
loss_pred:0.022450506687164307, decouple_loss:0.012039444409310818
Iteration: 1373, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44865190982818604
loss_pred:0.022616203874349594, decouple_loss:0.010892827063798904
The generated pressure mean: 0.4479663372039795
loss_pred:0.0223279669880867, decouple_loss:0.011709228157997131
The generated pressure mean: 0.44833770394325256
loss_pred:0.021991824731230736, decouple_loss:0.011471542529761791
Iteration: 1374, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4481360614299774
loss_pred:0.021648738533258438, decouple_loss:0.013388972729444504
The generated pressure mean: 0.4488700330257416
loss_pred:0.021751483902335167, decouple_loss:0.013693231157958508
The generated pressure mean: 0.44931912422180176
loss_pred:0.02055703103542328, decouple_loss:0.012946372851729393
Iteration: 1375, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44866034388542175
loss_pred:0.02200411632657051, decouple_loss:0.01234711054712534
The generated pressure mean: 0.4481582045555115
loss_pred:0.021890340372920036, decouple_loss:0.01154019683599472
The generated pressure mean: 0.4496057629585266
loss_pred:0.02216724120080471, decouple_loss:0.012161077000200748
Iteration: 1376, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4487124979496002
loss_pred:0.02198474109172821, decouple_loss:0.012959563173353672
The generated pressure mean: 0.448769748210907
loss_pred:0.022208213806152344, decouple_loss:0.011931950226426125
The generated pressure mean: 0.44908246397972107
loss_pred:0.02205413579940796, decouple_loss:0.01282799243927002
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1377, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4489070475101471The generated pressure mean: 0.45004376769065857
loss_pred:0.021709265187382698, decouple_loss:0.012624098919332027
loss_pred:0.022384487092494965, decouple_loss:0.012182976119220257
The generated pressure mean: 0.44929349422454834
loss_pred:0.020994411781430244, decouple_loss:0.01216124091297388
Iteration: 1378, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44977855682373047The generated pressure mean: 0.44934093952178955
loss_pred:0.022783514112234116, decouple_loss:0.011320444755256176
loss_pred:0.02120959758758545, decouple_loss:0.011265921406447887
The generated pressure mean: 0.448976993560791
loss_pred:0.020846659317612648, decouple_loss:0.011044222861528397
Iteration: 1379, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4482971429824829
The generated pressure mean: 0.4492025077342987
loss_pred:0.021413180977106094, decouple_loss:0.011454445309937
loss_pred:0.02242591232061386, decouple_loss:0.01190309040248394
The generated pressure mean: 0.4493999779224396
loss_pred:0.02085139974951744, decouple_loss:0.011734191328287125
Iteration: 1380, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44842883944511414
The generated pressure mean: 0.4491329491138458loss_pred:0.022748108953237534, decouple_loss:0.01149255596101284
loss_pred:0.021705394610762596, decouple_loss:0.011244253255426884
The generated pressure mean: 0.4479464292526245
loss_pred:0.022954950109124184, decouple_loss:0.011111568659543991
2023-04-16 06:56:35 testing...
The generated pressure mean: 0.4502691328525543
loss_pred:0.14062392711639404, decouple_loss:0.05915464088320732
The generated pressure mean: 0.45003288984298706
loss_pred:0.1400710940361023, decouple_loss:0.05863764137029648
The generated pressure mean: 0.4503219723701477
loss_pred:0.13889539241790771, decouple_loss:0.05927521362900734
Loss: 0.14281460642814636, avg_mse: 0.2730848789215088
current test mse: 0.273085
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012000_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012000_3_24hr.npz
NaN value num: 0
Iteration: 1381, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4482490122318268
loss_pred:0.02079867757856846, decouple_loss:0.011194264516234398
The generated pressure mean: 0.4484362304210663
loss_pred:0.021470071747899055, decouple_loss:0.011662561446428299
The generated pressure mean: 0.4467219114303589
loss_pred:0.021689925342798233, decouple_loss:0.011401966214179993
Iteration: 1382, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4473790228366852
The generated pressure mean: 0.44756290316581726
loss_pred:0.0216405987739563, decouple_loss:0.010424204170703888
loss_pred:0.02177511900663376, decouple_loss:0.01079063955694437
The generated pressure mean: 0.44934791326522827
loss_pred:0.021386191248893738, decouple_loss:0.010323002003133297
Iteration: 1383, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44609925150871277The generated pressure mean: 0.44722452759742737
loss_pred:0.021803375333547592, decouple_loss:0.011543575674295425
loss_pred:0.020309336483478546, decouple_loss:0.01196259818971157
The generated pressure mean: 0.44603389501571655
loss_pred:0.02085651084780693, decouple_loss:0.011925932951271534
Iteration: 1384, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44795656204223633
loss_pred:0.0209474116563797, decouple_loss:0.01090522576123476
The generated pressure mean: 0.4493417739868164
loss_pred:0.02173430845141411, decouple_loss:0.011089821346104145
The generated pressure mean: 0.448245108127594
loss_pred:0.02234559692442417, decouple_loss:0.01118481159210205
Iteration: 1385, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4498240649700165
loss_pred:0.021069331094622612, decouple_loss:0.01152109820395708
The generated pressure mean: 0.44712406396865845
loss_pred:0.021009383723139763, decouple_loss:0.011875560507178307
The generated pressure mean: 0.44688281416893005
loss_pred:0.023080026730895042, decouple_loss:0.011731710284948349
Iteration: 1386, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44759348034858704
loss_pred:0.02379770204424858, decouple_loss:0.011408998630940914
The generated pressure mean: 0.44786536693573
loss_pred:0.020965339615941048, decouple_loss:0.011569368652999401
The generated pressure mean: 0.4487334191799164
loss_pred:0.023357104510068893, decouple_loss:0.01181098073720932
Iteration: 1387, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44901710748672485
loss_pred:0.022219941020011902, decouple_loss:0.01134825125336647
The generated pressure mean: 0.44810712337493896
loss_pred:0.02246680110692978, decouple_loss:0.011569560505449772
The generated pressure mean: 0.44855037331581116
loss_pred:0.02213212288916111, decouple_loss:0.012261679396033287
Iteration: 1388, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44726118445396423
The generated pressure mean: 0.4478125274181366
loss_pred:0.02128663845360279, decouple_loss:0.012175492011010647
loss_pred:0.021584030240774155, decouple_loss:0.011591825634241104
The generated pressure mean: 0.4482596218585968
loss_pred:0.022210577502846718, decouple_loss:0.011744608171284199
Iteration: 1389, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4479704797267914
The generated pressure mean: 0.44814997911453247
loss_pred:0.022484667599201202, decouple_loss:0.01084989495575428
loss_pred:0.021423857659101486, decouple_loss:0.010979610495269299
The generated pressure mean: 0.44731414318084717
loss_pred:0.021393194794654846, decouple_loss:0.010865790769457817
Iteration: 1390, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4479261636734009
The generated pressure mean: 0.4472123980522156
loss_pred:0.02339453436434269, decouple_loss:0.012752130627632141
loss_pred:0.021110888570547104, decouple_loss:0.012124327942728996
The generated pressure mean: 0.44885143637657166
loss_pred:0.021858038380742073, decouple_loss:0.012718482874333858
2023-04-16 06:59:18 testing...
The generated pressure mean: 0.4502691328525543
loss_pred:0.1402209997177124, decouple_loss:0.059679243713617325
The generated pressure mean: 0.45032501220703125
loss_pred:0.1384994238615036, decouple_loss:0.059382468461990356
The generated pressure mean: 0.4500311017036438
loss_pred:0.13960103690624237, decouple_loss:0.059039559215307236
Loss: 0.1424088478088379, avg_mse: 0.2728533148765564
current test mse: 0.272853
Iteration: 1391, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4484400451183319
The generated pressure mean: 0.4486194849014282
loss_pred:0.022457750514149666, decouple_loss:0.010685606859624386
loss_pred:0.021189814433455467, decouple_loss:0.010828894563019276
The generated pressure mean: 0.4470783472061157
loss_pred:0.021963048726320267, decouple_loss:0.0116522666066885
Iteration: 1392, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4477161765098572
The generated pressure mean: 0.44727572798728943
The generated pressure mean: 0.4483918249607086
loss_pred:0.02134077064692974, decouple_loss:0.011213993653655052
loss_pred:0.021138176321983337, decouple_loss:0.010979441925883293
loss_pred:0.021473845466971397, decouple_loss:0.011004526168107986
Iteration: 1393, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4467090368270874
loss_pred:0.02105696313083172, decouple_loss:0.011464635841548443
The generated pressure mean: 0.4474908709526062
loss_pred:0.020615756511688232, decouple_loss:0.011280016042292118
The generated pressure mean: 0.4470858871936798
loss_pred:0.021305853500962257, decouple_loss:0.011121277697384357
Iteration: 1394, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44690585136413574
loss_pred:0.021017182618379593, decouple_loss:0.011420169845223427
The generated pressure mean: 0.4479411542415619
loss_pred:0.020672548562288284, decouple_loss:0.010833390057086945
The generated pressure mean: 0.44702884554862976
loss_pred:0.020940061658620834, decouple_loss:0.011382289230823517
Iteration: 1395, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44754669070243835
loss_pred:0.021909408271312714, decouple_loss:0.010669603012502193
The generated pressure mean: 0.4471859633922577
loss_pred:0.020849235355854034, decouple_loss:0.010854206047952175
The generated pressure mean: 0.44610050320625305
loss_pred:0.02281840145587921, decouple_loss:0.010935143567621708
Iteration: 1396, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4476032853126526
loss_pred:0.020734325051307678, decouple_loss:0.010533957742154598
The generated pressure mean: 0.44765347242355347
loss_pred:0.020847780629992485, decouple_loss:0.010366324335336685
The generated pressure mean: 0.4469842314720154
loss_pred:0.021449383348226547, decouple_loss:0.010724647901952267
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1397, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4477517604827881
loss_pred:0.02192678302526474, decouple_loss:0.011036470532417297
The generated pressure mean: 0.44701382517814636
loss_pred:0.02157072350382805, decouple_loss:0.0100764911621809
The generated pressure mean: 0.44794952869415283
loss_pred:0.021388158202171326, decouple_loss:0.01012816559523344
Iteration: 1398, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4474976062774658
The generated pressure mean: 0.4489707946777344
loss_pred:0.021479744464159012, decouple_loss:0.011008222587406635
loss_pred:0.020895516499876976, decouple_loss:0.011095249094069004
The generated pressure mean: 0.4476771950721741
loss_pred:0.02154623717069626, decouple_loss:0.011629690416157246
Iteration: 1399, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44805991649627686
loss_pred:0.021752553060650826, decouple_loss:0.010668996721506119
The generated pressure mean: 0.4474652111530304
loss_pred:0.02293449081480503, decouple_loss:0.010474832728505135
The generated pressure mean: 0.4476097524166107
loss_pred:0.022999467328190804, decouple_loss:0.010644412599503994
Iteration: 1400, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4464258849620819
loss_pred:0.023257657885551453, decouple_loss:0.010872574523091316
The generated pressure mean: 0.44974178075790405
loss_pred:0.022452829405665398, decouple_loss:0.010858076624572277
The generated pressure mean: 0.4471251964569092
loss_pred:0.023200208321213722, decouple_loss:0.01129129808396101
2023-04-16 07:01:23 testing...
The generated pressure mean: 0.4502691626548767
loss_pred:0.13670440018177032, decouple_loss:0.05304541811347008
The generated pressure mean: 0.45002973079681396
loss_pred:0.13469426333904266, decouple_loss:0.052518051117658615
The generated pressure mean: 0.45032480359077454
loss_pred:0.13444706797599792, decouple_loss:0.05330485478043556
Loss: 0.13792972266674042, avg_mse: 0.25590354204177856
current test mse: 0.255904
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012019_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012019_3_24hr.npz
NaN value num: 0
Iteration: 1401, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4492603540420532
loss_pred:0.027881043031811714, decouple_loss:0.012413391843438148
The generated pressure mean: 0.4497300386428833
loss_pred:0.02691105380654335, decouple_loss:0.01215604692697525
The generated pressure mean: 0.4497334957122803
loss_pred:0.03132999315857887, decouple_loss:0.012349988333880901
Iteration: 1402, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44811755418777466
loss_pred:0.024291232228279114, decouple_loss:0.013354457914829254
The generated pressure mean: 0.4485855996608734
loss_pred:0.02454771287739277, decouple_loss:0.01337779313325882
The generated pressure mean: 0.44790300726890564
loss_pred:0.026684941723942757, decouple_loss:0.01405579224228859
Iteration: 1403, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45009955763816833
loss_pred:0.02476406656205654, decouple_loss:0.013224738650023937
The generated pressure mean: 0.44939425587654114
The generated pressure mean: 0.44836676120758057loss_pred:0.02644491009414196, decouple_loss:0.01343292836099863
loss_pred:0.029202381148934364, decouple_loss:0.013023225590586662
Iteration: 1404, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4493580758571625
loss_pred:0.02443716488778591, decouple_loss:0.012360683642327785
The generated pressure mean: 0.45014870166778564
loss_pred:0.026711445301771164, decouple_loss:0.01276020985096693
The generated pressure mean: 0.44995996356010437
loss_pred:0.024735378101468086, decouple_loss:0.012426909990608692
Iteration: 1405, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4495668411254883
loss_pred:0.026256902143359184, decouple_loss:0.012984841130673885
The generated pressure mean: 0.44952327013015747
loss_pred:0.025042740628123283, decouple_loss:0.013072459027171135
The generated pressure mean: 0.45002225041389465
loss_pred:0.02420961670577526, decouple_loss:0.012607671320438385
Iteration: 1406, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4494352638721466
loss_pred:0.024850718677043915, decouple_loss:0.013067344203591347
The generated pressure mean: 0.44839343428611755
loss_pred:0.023620400577783585, decouple_loss:0.013171309605240822
The generated pressure mean: 0.44968706369400024
loss_pred:0.024222886189818382, decouple_loss:0.013464394956827164
Iteration: 1407, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4495305120944977The generated pressure mean: 0.4496293067932129
loss_pred:0.02344888634979725, decouple_loss:0.015084629878401756
loss_pred:0.025167999789118767, decouple_loss:0.016942400485277176
The generated pressure mean: 0.44839975237846375
loss_pred:0.025164898484945297, decouple_loss:0.017042309045791626
Iteration: 1408, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44812366366386414
The generated pressure mean: 0.44986864924430847
loss_pred:0.023724107071757317, decouple_loss:0.013700636103749275
loss_pred:0.025084733963012695, decouple_loss:0.013243192806839943
The generated pressure mean: 0.44903305172920227
loss_pred:0.024297241121530533, decouple_loss:0.013140332885086536
Iteration: 1409, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4499723017215729
loss_pred:0.02373357117176056, decouple_loss:0.013867284171283245
The generated pressure mean: 0.4489665627479553
loss_pred:0.02404538169503212, decouple_loss:0.013585382141172886
The generated pressure mean: 0.449502170085907
loss_pred:0.02366494946181774, decouple_loss:0.013944997452199459
Iteration: 1410, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44972914457321167The generated pressure mean: 0.44911208748817444
loss_pred:0.024989178404211998, decouple_loss:0.013199843466281891
loss_pred:0.023321617394685745, decouple_loss:0.013183373026549816
The generated pressure mean: 0.4493449032306671
loss_pred:0.024244118481874466, decouple_loss:0.012945589609444141
2023-04-16 07:04:05 testing...
The generated pressure mean: 0.4502691924571991
loss_pred:0.13996632397174835, decouple_loss:0.057932719588279724
The generated pressure mean: 0.4503251016139984
loss_pred:0.13784921169281006, decouple_loss:0.05807231739163399
The generated pressure mean: 0.4500323235988617
loss_pred:0.13866747915744781, decouple_loss:0.057097453624010086
Loss: 0.1417127102613449, avg_mse: 0.2642260789871216
current test mse: 0.264226
Iteration: 1411, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4491962194442749
loss_pred:0.023420782759785652, decouple_loss:0.013494092971086502
The generated pressure mean: 0.4492710828781128
The generated pressure mean: 0.4496588110923767
loss_pred:0.023872435092926025, decouple_loss:0.013232491910457611
loss_pred:0.023895716294646263, decouple_loss:0.013334776274859905
Iteration: 1412, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4489869475364685
loss_pred:0.02397286519408226, decouple_loss:0.014168246649205685
The generated pressure mean: 0.4496120810508728
The generated pressure mean: 0.448733925819397
loss_pred:0.02405380643904209, decouple_loss:0.014341582544147968
loss_pred:0.024115804582834244, decouple_loss:0.014243064448237419
Iteration: 1413, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4495662748813629
loss_pred:0.02344030886888504, decouple_loss:0.012613379396498203
The generated pressure mean: 0.44876953959465027
loss_pred:0.02411659061908722, decouple_loss:0.013042675331234932
The generated pressure mean: 0.4495467245578766
loss_pred:0.023369591683149338, decouple_loss:0.01305558905005455
Iteration: 1414, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4484623074531555
loss_pred:0.024279186502099037, decouple_loss:0.012268014252185822
The generated pressure mean: 0.44999197125434875
loss_pred:0.02684386447072029, decouple_loss:0.012630593962967396
The generated pressure mean: 0.44913697242736816
loss_pred:0.022279998287558556, decouple_loss:0.012551086954772472
Iteration: 1415, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.449818879365921
loss_pred:0.024624794721603394, decouple_loss:0.011934272013604641
The generated pressure mean: 0.44870486855506897
loss_pred:0.02322479709982872, decouple_loss:0.01185548771172762
The generated pressure mean: 0.4487718939781189
loss_pred:0.02459798939526081, decouple_loss:0.012877619825303555
Iteration: 1416, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44885319471359253
loss_pred:0.02346525341272354, decouple_loss:0.012181855738162994
The generated pressure mean: 0.4496130645275116
loss_pred:0.022604385390877724, decouple_loss:0.011858821846544743
The generated pressure mean: 0.4500570595264435
loss_pred:0.023105617612600327, decouple_loss:0.011652929708361626
Iteration: 1417, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4487045705318451The generated pressure mean: 0.44895851612091064
loss_pred:0.023253124207258224, decouple_loss:0.011655916459858418
loss_pred:0.022784272208809853, decouple_loss:0.012519726529717445
The generated pressure mean: 0.4499531388282776
loss_pred:0.023555291816592216, decouple_loss:0.011881532147526741
Iteration: 1418, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4494604766368866
loss_pred:0.024094749242067337, decouple_loss:0.010981904342770576
The generated pressure mean: 0.44854697585105896
loss_pred:0.02570045366883278, decouple_loss:0.011292320676147938
The generated pressure mean: 0.4480934143066406
loss_pred:0.02368091605603695, decouple_loss:0.01091804075986147
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1419, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4485515356063843
loss_pred:0.02476992830634117, decouple_loss:0.012000015005469322
The generated pressure mean: 0.4500471353530884
loss_pred:0.02250394970178604, decouple_loss:0.012122904881834984
The generated pressure mean: 0.44867080450057983
loss_pred:0.02378421276807785, decouple_loss:0.011996136978268623
Iteration: 1420, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4490983784198761
loss_pred:0.023520449176430702, decouple_loss:0.011026022024452686
The generated pressure mean: 0.4495317041873932
loss_pred:0.022035734727978706, decouple_loss:0.01083338726311922
The generated pressure mean: 0.4485154151916504
loss_pred:0.023518141359090805, decouple_loss:0.010583787225186825
2023-04-16 07:06:11 testing...
The generated pressure mean: 0.4502691924571991
loss_pred:0.14396394789218903, decouple_loss:0.061448801308870316
The generated pressure mean: 0.4503248631954193
loss_pred:0.141752690076828, decouple_loss:0.06175197288393974
The generated pressure mean: 0.4500288963317871
loss_pred:0.14282521605491638, decouple_loss:0.06100933253765106
Loss: 0.14591746032238007, avg_mse: 0.2757841944694519
current test mse: 0.275784
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012003_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012003_3_24hr.npz
NaN value num: 0
Iteration: 1421, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4487369656562805
loss_pred:0.023398078978061676, decouple_loss:0.011464123614132404
The generated pressure mean: 0.44937899708747864
The generated pressure mean: 0.45031502842903137
loss_pred:0.0215180404484272, decouple_loss:0.01206352561712265
loss_pred:0.023484323173761368, decouple_loss:0.011716467328369617
Iteration: 1422, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44817763566970825
loss_pred:0.022546853870153427, decouple_loss:0.01172324363142252
The generated pressure mean: 0.44918838143348694
loss_pred:0.022804664447903633, decouple_loss:0.011967489495873451
The generated pressure mean: 0.4490267336368561
loss_pred:0.022324901074171066, decouple_loss:0.012537306174635887
Iteration: 1423, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4488144516944885
loss_pred:0.022780170664191246, decouple_loss:0.011567039415240288
The generated pressure mean: 0.4485328197479248
The generated pressure mean: 0.44962501525878906
loss_pred:0.022125549614429474, decouple_loss:0.011611197143793106
loss_pred:0.024041377007961273, decouple_loss:0.01162932999432087
Iteration: 1424, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4492086172103882
loss_pred:0.024436896666884422, decouple_loss:0.011433073319494724
The generated pressure mean: 0.449466735124588
loss_pred:0.021572625264525414, decouple_loss:0.011146094650030136
The generated pressure mean: 0.44898679852485657
loss_pred:0.022287381812930107, decouple_loss:0.01076623797416687
Iteration: 1425, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4490398168563843
loss_pred:0.021260341629385948, decouple_loss:0.010778495110571384
The generated pressure mean: 0.44878703355789185
loss_pred:0.022244051098823547, decouple_loss:0.011512305587530136
The generated pressure mean: 0.44973886013031006
loss_pred:0.02099638432264328, decouple_loss:0.011286672204732895
Iteration: 1426, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.449506938457489
loss_pred:0.02223782241344452, decouple_loss:0.01240570843219757
The generated pressure mean: 0.44871529936790466
loss_pred:0.023188920691609383, decouple_loss:0.01193495187908411
The generated pressure mean: 0.4478297531604767
loss_pred:0.021547773852944374, decouple_loss:0.013142136856913567
Iteration: 1427, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44993898272514343
loss_pred:0.02277611941099167, decouple_loss:0.011734251864254475
The generated pressure mean: 0.44832390546798706
loss_pred:0.023560525849461555, decouple_loss:0.012322468683123589
The generated pressure mean: 0.44890257716178894
loss_pred:0.021479453891515732, decouple_loss:0.012174414470791817
Iteration: 1428, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44747743010520935
loss_pred:0.02247321605682373, decouple_loss:0.010855461470782757
The generated pressure mean: 0.4487338364124298
loss_pred:0.02192016877233982, decouple_loss:0.010813522152602673
The generated pressure mean: 0.44901934266090393
loss_pred:0.022624418139457703, decouple_loss:0.010811404325067997
Iteration: 1429, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44874337315559387
loss_pred:0.02130027860403061, decouple_loss:0.012052498757839203
The generated pressure mean: 0.44823789596557617
loss_pred:0.022191112861037254, decouple_loss:0.01170014776289463
The generated pressure mean: 0.4495968222618103
loss_pred:0.021350903436541557, decouple_loss:0.012153943069279194
Iteration: 1430, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44800105690956116
loss_pred:0.02203124761581421, decouple_loss:0.010776524432003498
The generated pressure mean: 0.44951727986335754
loss_pred:0.02079484798014164, decouple_loss:0.011170990765094757
The generated pressure mean: 0.4481889307498932
loss_pred:0.022700395435094833, decouple_loss:0.011285499669611454
2023-04-16 07:08:52 testing...
The generated pressure mean: 0.4502691626548767
loss_pred:0.14248746633529663, decouple_loss:0.0629422664642334
The generated pressure mean: 0.4503244161605835
loss_pred:0.140110045671463, decouple_loss:0.06291817128658295
The generated pressure mean: 0.45002999901771545
loss_pred:0.1410040706396103, decouple_loss:0.062148988246917725
Loss: 0.14433401823043823, avg_mse: 0.2743759751319885
current test mse: 0.274376
Iteration: 1431, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4487902820110321
loss_pred:0.02268734760582447, decouple_loss:0.011779670603573322
The generated pressure mean: 0.44736966490745544
loss_pred:0.021899359300732613, decouple_loss:0.01147556770592928
The generated pressure mean: 0.4489131271839142
loss_pred:0.022644659504294395, decouple_loss:0.011092773638665676
Iteration: 1432, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4485989212989807
loss_pred:0.02160095050930977, decouple_loss:0.01043713092803955
The generated pressure mean: 0.44873014092445374
loss_pred:0.02159741334617138, decouple_loss:0.010959471575915813
The generated pressure mean: 0.44798871874809265
loss_pred:0.021023733541369438, decouple_loss:0.010465853847563267
Iteration: 1433, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4495599567890167
loss_pred:0.020067205652594566, decouple_loss:0.01139539573341608
The generated pressure mean: 0.4499620497226715
loss_pred:0.02163647674024105, decouple_loss:0.01170712523162365
The generated pressure mean: 0.4486353099346161
loss_pred:0.021706392988562584, decouple_loss:0.01064648199826479
Iteration: 1434, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44900956749916077
The generated pressure mean: 0.45114749670028687
loss_pred:0.02125409245491028, decouple_loss:0.01034468226134777
loss_pred:0.022239474579691887, decouple_loss:0.010985719971358776
The generated pressure mean: 0.4483243227005005
loss_pred:0.022641988471150398, decouple_loss:0.010810562409460545
Iteration: 1435, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44821637868881226
loss_pred:0.02297455072402954, decouple_loss:0.010618041269481182
The generated pressure mean: 0.4494214653968811
loss_pred:0.021109050139784813, decouple_loss:0.009743424132466316
The generated pressure mean: 0.4480248987674713
loss_pred:0.022183356806635857, decouple_loss:0.010258485563099384
Iteration: 1436, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4489494860172272
loss_pred:0.02200057916343212, decouple_loss:0.010675438679754734
The generated pressure mean: 0.44881296157836914
loss_pred:0.020413456484675407, decouple_loss:0.010501095093786716
The generated pressure mean: 0.4484439194202423
loss_pred:0.021314851939678192, decouple_loss:0.010696022771298885
Iteration: 1437, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4478243887424469The generated pressure mean: 0.449115127325058
loss_pred:0.0220753513276577, decouple_loss:0.009782801382243633
loss_pred:0.02241043746471405, decouple_loss:0.00984263140708208
The generated pressure mean: 0.44830864667892456
loss_pred:0.022151298820972443, decouple_loss:0.010061110369861126
Iteration: 1438, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45107385516166687
loss_pred:0.021770255640149117, decouple_loss:0.010918506421148777
The generated pressure mean: 0.4491124749183655
loss_pred:0.021570149809122086, decouple_loss:0.01015036553144455
The generated pressure mean: 0.4473942816257477
loss_pred:0.021578766405582428, decouple_loss:0.009944490157067776
Iteration: 1439, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4490414261817932
The generated pressure mean: 0.4485897123813629loss_pred:0.02204584889113903, decouple_loss:0.011001819744706154
loss_pred:0.020832931622862816, decouple_loss:0.011627625674009323
The generated pressure mean: 0.4476032257080078
loss_pred:0.021071525290608406, decouple_loss:0.010884798131883144
Iteration: 1440, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44993335008621216
loss_pred:0.021788084879517555, decouple_loss:0.010736767202615738
The generated pressure mean: 0.4492977261543274
loss_pred:0.021025998517870903, decouple_loss:0.010875554755330086
The generated pressure mean: 0.4494468867778778
loss_pred:0.023680705577135086, decouple_loss:0.010212964378297329
2023-04-16 07:10:58 testing...
The generated pressure mean: 0.4502691328525543
loss_pred:0.14355163276195526, decouple_loss:0.06303741782903671
The generated pressure mean: 0.45002955198287964
loss_pred:0.14262886345386505, decouple_loss:0.06267153471708298
The generated pressure mean: 0.4503255784511566
loss_pred:0.1415158212184906, decouple_loss:0.06304357945919037
Loss: 0.14571131765842438, avg_mse: 0.2789321541786194
current test mse: 0.278932
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012017_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012017_3_24hr.npz
NaN value num: 0
Iteration: 1441, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44957610964775085
loss_pred:0.021761449053883553, decouple_loss:0.009753712452948093
The generated pressure mean: 0.44998642802238464
loss_pred:0.022151490673422813, decouple_loss:0.010390302166342735
The generated pressure mean: 0.4482247531414032
loss_pred:0.023118823766708374, decouple_loss:0.010332152247428894
Iteration: 1442, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4492236375808716
loss_pred:0.02136641927063465, decouple_loss:0.009771199896931648
The generated pressure mean: 0.448692262172699
loss_pred:0.021995551884174347, decouple_loss:0.009807601571083069
The generated pressure mean: 0.44771453738212585
loss_pred:0.02246851660311222, decouple_loss:0.009463697671890259
Iteration: 1443, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4479864239692688
loss_pred:0.024088837206363678, decouple_loss:0.00906808115541935
The generated pressure mean: 0.4499870538711548
loss_pred:0.021208394318819046, decouple_loss:0.009606231935322285
The generated pressure mean: 0.4489535987377167
loss_pred:0.02034910023212433, decouple_loss:0.010240941308438778
Iteration: 1444, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44776302576065063
loss_pred:0.021953409537672997, decouple_loss:0.009736732579767704
The generated pressure mean: 0.44853585958480835
loss_pred:0.022419949993491173, decouple_loss:0.01053835079073906
The generated pressure mean: 0.45041993260383606
loss_pred:0.021102409809827805, decouple_loss:0.00988495722413063
Iteration: 1445, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.449506938457489
The generated pressure mean: 0.4481043219566345loss_pred:0.020108336582779884, decouple_loss:0.010222150944173336
loss_pred:0.021692518144845963, decouple_loss:0.010499244555830956
The generated pressure mean: 0.4492969214916229
loss_pred:0.022153938189148903, decouple_loss:0.010458705015480518
Iteration: 1446, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.448655366897583
loss_pred:0.021103981882333755, decouple_loss:0.012346278876066208
The generated pressure mean: 0.4477749168872833
loss_pred:0.022638345137238503, decouple_loss:0.010419894941151142
The generated pressure mean: 0.4494103491306305
loss_pred:0.022726714611053467, decouple_loss:0.011060151271522045
Iteration: 1447, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45037129521369934
loss_pred:0.022012969478964806, decouple_loss:0.010345217771828175
The generated pressure mean: 0.4494607150554657
loss_pred:0.020879976451396942, decouple_loss:0.010619845241308212
The generated pressure mean: 0.44827449321746826
loss_pred:0.022174445912241936, decouple_loss:0.010403378866612911
Iteration: 1448, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44813600182533264
loss_pred:0.020926382392644882, decouple_loss:0.009601248428225517
The generated pressure mean: 0.45002275705337524
loss_pred:0.021923283115029335, decouple_loss:0.009250764735043049
The generated pressure mean: 0.44783204793930054
loss_pred:0.02221178077161312, decouple_loss:0.009640723466873169
Iteration: 1449, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44978585839271545
loss_pred:0.02083977684378624, decouple_loss:0.01011789683252573
The generated pressure mean: 0.449430912733078
loss_pred:0.021196413785219193, decouple_loss:0.010031579993665218
The generated pressure mean: 0.4498642086982727
loss_pred:0.02179371379315853, decouple_loss:0.00994151458144188
Iteration: 1450, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4483952522277832
loss_pred:0.021845974028110504, decouple_loss:0.011380228213965893
The generated pressure mean: 0.4493294954299927
loss_pred:0.02267073467373848, decouple_loss:0.012567800469696522
The generated pressure mean: 0.4484025835990906
loss_pred:0.021816620603203773, decouple_loss:0.01115840021520853
2023-04-16 07:13:52 testing...
The generated pressure mean: 0.4502691328525543
loss_pred:0.14288848638534546, decouple_loss:0.05987640842795372
The generated pressure mean: 0.4503239691257477
loss_pred:0.14084728062152863, decouple_loss:0.06014469265937805
The generated pressure mean: 0.4500279724597931
loss_pred:0.1417880356311798, decouple_loss:0.0594269260764122
Loss: 0.1448320746421814, avg_mse: 0.2761462330818176
current test mse: 0.276146
Iteration: 1451, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4489538371562958
loss_pred:0.02043951116502285, decouple_loss:0.012742026709020138
The generated pressure mean: 0.448571115732193
loss_pred:0.02159453183412552, decouple_loss:0.010805786587297916
The generated pressure mean: 0.4495125114917755
loss_pred:0.021100256592035294, decouple_loss:0.01101129874587059
Iteration: 1452, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4491068422794342
loss_pred:0.02132701501250267, decouple_loss:0.010489799082279205
The generated pressure mean: 0.44739970564842224
loss_pred:0.02177775278687477, decouple_loss:0.011228038929402828
The generated pressure mean: 0.44957712292671204
loss_pred:0.02265416458249092, decouple_loss:0.010560042224824429
Iteration: 1453, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44784846901893616
loss_pred:0.021081987768411636, decouple_loss:0.010120328515768051
The generated pressure mean: 0.4491903483867645
loss_pred:0.021638207137584686, decouple_loss:0.01060420460999012
The generated pressure mean: 0.4487111568450928
loss_pred:0.021703651174902916, decouple_loss:0.010451330803334713
Iteration: 1454, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4489685595035553
loss_pred:0.021204236894845963, decouple_loss:0.01412565354257822
The generated pressure mean: 0.4485822319984436
loss_pred:0.023073047399520874, decouple_loss:0.013927643187344074
The generated pressure mean: 0.44810524582862854
loss_pred:0.021381501108407974, decouple_loss:0.014235470443964005
Iteration: 1455, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4481717348098755
loss_pred:0.023805344477295876, decouple_loss:0.011273153126239777
The generated pressure mean: 0.45017391443252563
loss_pred:0.021110817790031433, decouple_loss:0.010968486778438091
The generated pressure mean: 0.4500746428966522
loss_pred:0.02159564010798931, decouple_loss:0.010643570683896542
Iteration: 1456, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44989174604415894
loss_pred:0.021530861034989357, decouple_loss:0.013101428747177124
The generated pressure mean: 0.44840747117996216
loss_pred:0.024592380970716476, decouple_loss:0.013152249157428741
The generated pressure mean: 0.4492688775062561
loss_pred:0.021487031131982803, decouple_loss:0.012896851636469364
Iteration: 1457, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4484555721282959
loss_pred:0.022822389379143715, decouple_loss:0.013391843996942043
The generated pressure mean: 0.4488007426261902
loss_pred:0.021599333733320236, decouple_loss:0.014717910438776016
The generated pressure mean: 0.4484559893608093
loss_pred:0.021797871217131615, decouple_loss:0.013972426764667034
Iteration: 1458, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44880223274230957
loss_pred:0.02018321491777897, decouple_loss:0.011831334792077541
The generated pressure mean: 0.44819486141204834
loss_pred:0.02101442590355873, decouple_loss:0.01143257413059473
The generated pressure mean: 0.4490417540073395
loss_pred:0.023417867720127106, decouple_loss:0.011056119576096535
Iteration: 1459, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4491126239299774
loss_pred:0.02076835185289383, decouple_loss:0.014834458008408546
The generated pressure mean: 0.4493471086025238
loss_pred:0.023001044988632202, decouple_loss:0.013992157764732838
The generated pressure mean: 0.4489348828792572
loss_pred:0.02120736613869667, decouple_loss:0.01443412434309721
Iteration: 1460, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4492504596710205
loss_pred:0.021158481016755104, decouple_loss:0.01255655288696289
The generated pressure mean: 0.4494313597679138
loss_pred:0.020791996270418167, decouple_loss:0.01149726938456297
The generated pressure mean: 0.4492167532444
loss_pred:0.020168039947748184, decouple_loss:0.011487376876175404
2023-04-16 07:15:58 testing...
The generated pressure mean: 0.4502691924571991
loss_pred:0.14038310945034027, decouple_loss:0.058436907827854156
The generated pressure mean: 0.45002901554107666
loss_pred:0.13966266810894012, decouple_loss:0.05814844369888306
The generated pressure mean: 0.4503210484981537
loss_pred:0.13858383893966675, decouple_loss:0.058905988931655884
Loss: 0.14246806502342224, avg_mse: 0.2711252272129059
current test mse: 0.271125
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012011_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012011_3_24hr.npz
NaN value num: 0
Iteration: 1461, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4483775794506073
loss_pred:0.021518075838685036, decouple_loss:0.01306720357388258
The generated pressure mean: 0.44824111461639404
loss_pred:0.021116871386766434, decouple_loss:0.012622044421732426
The generated pressure mean: 0.4479641318321228
loss_pred:0.02085096947848797, decouple_loss:0.013434121385216713
Iteration: 1462, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44726184010505676
loss_pred:0.021269045770168304, decouple_loss:0.01286512054502964
The generated pressure mean: 0.44911110401153564
loss_pred:0.022279204800724983, decouple_loss:0.012658661231398582
The generated pressure mean: 0.44836097955703735
loss_pred:0.0223903376609087, decouple_loss:0.012948286719620228
Iteration: 1463, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4483358860015869
loss_pred:0.02430860325694084, decouple_loss:0.010686075314879417
The generated pressure mean: 0.44822925329208374
loss_pred:0.022672154009342194, decouple_loss:0.010975169017910957
The generated pressure mean: 0.4485138952732086
loss_pred:0.02088770642876625, decouple_loss:0.010802834294736385
Iteration: 1464, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4476167857646942
The generated pressure mean: 0.4481087923049927
loss_pred:0.021136511117219925, decouple_loss:0.010937537997961044
loss_pred:0.020937439054250717, decouple_loss:0.011356025002896786
The generated pressure mean: 0.447925329208374
loss_pred:0.022031212225556374, decouple_loss:0.011012964881956577
Iteration: 1465, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.447775274515152
loss_pred:0.02252296544611454, decouple_loss:0.011566907167434692
The generated pressure mean: 0.4477092921733856
loss_pred:0.022579820826649666, decouple_loss:0.010898597538471222
The generated pressure mean: 0.4487000107765198
loss_pred:0.020604267716407776, decouple_loss:0.01067417673766613
Iteration: 1466, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4480753242969513
loss_pred:0.020952902734279633, decouple_loss:0.010362325236201286
The generated pressure mean: 0.4486573338508606
loss_pred:0.022298580035567284, decouple_loss:0.0108525725081563
The generated pressure mean: 0.45005369186401367
loss_pred:0.02178727090358734, decouple_loss:0.01098297256976366
Iteration: 1467, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44927868247032166
loss_pred:0.021072804927825928, decouple_loss:0.009677334688603878
The generated pressure mean: 0.4482625424861908
loss_pred:0.020536178722977638, decouple_loss:0.009634333662688732
The generated pressure mean: 0.4487343430519104
loss_pred:0.02753964252769947, decouple_loss:0.010062023065984249
Iteration: 1468, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44804564118385315
The generated pressure mean: 0.44830945134162903loss_pred:0.022911416366696358, decouple_loss:0.011915693059563637
loss_pred:0.02465295046567917, decouple_loss:0.011532362550497055
The generated pressure mean: 0.44940221309661865
loss_pred:0.022140290588140488, decouple_loss:0.011187176220119
Iteration: 1469, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44920822978019714
The generated pressure mean: 0.4486885368824005loss_pred:0.02208629623055458, decouple_loss:0.01137272734194994
loss_pred:0.021554438397288322, decouple_loss:0.010617930442094803
The generated pressure mean: 0.4483191967010498
loss_pred:0.023095853626728058, decouple_loss:0.011076780036091805
Iteration: 1470, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44966593384742737
loss_pred:0.021952809765934944, decouple_loss:0.010818041861057281
The generated pressure mean: 0.4491528868675232
loss_pred:0.024191437289118767, decouple_loss:0.010749256238341331
The generated pressure mean: 0.44772982597351074
loss_pred:0.024629894644021988, decouple_loss:0.01085660234093666
2023-04-16 07:18:40 testing...
The generated pressure mean: 0.4502691626548767
loss_pred:0.1340818703174591, decouple_loss:0.05361519753932953
The generated pressure mean: 0.4503244161605835
loss_pred:0.1321757286787033, decouple_loss:0.053981125354766846
The generated pressure mean: 0.45002979040145874
loss_pred:0.13293832540512085, decouple_loss:0.05372893065214157
Loss: 0.1357540786266327, avg_mse: 0.2529740035533905
current test mse: 0.252974
Iteration: 1471, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44861501455307007
loss_pred:0.02242785505950451, decouple_loss:0.0112107889726758
The generated pressure mean: 0.4478969871997833
loss_pred:0.022438030689954758, decouple_loss:0.011779414489865303
The generated pressure mean: 0.4492078125476837
loss_pred:0.021496329456567764, decouple_loss:0.010996714234352112
Iteration: 1472, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4474080502986908
loss_pred:0.023476621136069298, decouple_loss:0.011602568440139294
The generated pressure mean: 0.44826197624206543
loss_pred:0.02337760478258133, decouple_loss:0.011026372201740742
The generated pressure mean: 0.44854798913002014
loss_pred:0.019893703982234, decouple_loss:0.011654357425868511
Iteration: 1473, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44784829020500183
loss_pred:0.02192992903292179, decouple_loss:0.010067841969430447
The generated pressure mean: 0.4482226073741913
loss_pred:0.021753346547484398, decouple_loss:0.010007779113948345
The generated pressure mean: 0.447110652923584
loss_pred:0.021135548129677773, decouple_loss:0.01060368213802576
Iteration: 1474, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44768667221069336
loss_pred:0.02226165495812893, decouple_loss:0.01030297577381134
The generated pressure mean: 0.4479846954345703
loss_pred:0.022355424240231514, decouple_loss:0.010364022105932236
The generated pressure mean: 0.44815489649772644
loss_pred:0.021691661328077316, decouple_loss:0.010458238422870636
Iteration: 1475, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45020121335983276
loss_pred:0.021166516467928886, decouple_loss:0.010596329346299171
The generated pressure mean: 0.44842401146888733
loss_pred:0.022099565714597702, decouple_loss:0.01037195511162281
The generated pressure mean: 0.4473724663257599
loss_pred:0.022155866026878357, decouple_loss:0.010608676820993423
Iteration: 1476, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44855156540870667
loss_pred:0.020629439502954483, decouple_loss:0.010928741656243801
The generated pressure mean: 0.44868409633636475
loss_pred:0.020183032378554344, decouple_loss:0.010951475240290165
The generated pressure mean: 0.4487251341342926
loss_pred:0.022023852914571762, decouple_loss:0.011475608684122562
Iteration: 1477, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44815176725387573
loss_pred:0.02051222324371338, decouple_loss:0.01044341828674078
The generated pressure mean: 0.44763290882110596
loss_pred:0.022626303136348724, decouple_loss:0.010481530800461769
The generated pressure mean: 0.4484633803367615
loss_pred:0.019523559138178825, decouple_loss:0.010741795413196087
Iteration: 1478, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44777706265449524
loss_pred:0.02029452659189701, decouple_loss:0.012279501184821129
The generated pressure mean: 0.44965288043022156
loss_pred:0.02269117347896099, decouple_loss:0.01197169441729784
The generated pressure mean: 0.4474724233150482
loss_pred:0.021363765001296997, decouple_loss:0.011485260911285877
Iteration: 1479, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44826894998550415
loss_pred:0.021836817264556885, decouple_loss:0.011057194322347641
The generated pressure mean: 0.4477546811103821
loss_pred:0.02108011394739151, decouple_loss:0.011900990270078182
The generated pressure mean: 0.4484610855579376
loss_pred:0.02353629656136036, decouple_loss:0.01201434712857008
Iteration: 1480, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4476020038127899
loss_pred:0.02126382850110531, decouple_loss:0.010851061902940273
The generated pressure mean: 0.44788703322410583
loss_pred:0.0211806558072567, decouple_loss:0.010935191996395588
The generated pressure mean: 0.44886845350265503
loss_pred:0.021444443613290787, decouple_loss:0.011045457795262337
2023-04-16 07:20:46 testing...
The generated pressure mean: 0.4502691626548767
loss_pred:0.1343822479248047, decouple_loss:0.05418281629681587
The generated pressure mean: 0.45002976059913635
loss_pred:0.1336551457643509, decouple_loss:0.05352945253252983
The generated pressure mean: 0.4503280222415924
loss_pred:0.1328182816505432, decouple_loss:0.0542587973177433
Loss: 0.13631807267665863, avg_mse: 0.2575955092906952
current test mse: 0.257596
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012008_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012008_3_24hr.npz
NaN value num: 0
Iteration: 1481, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44668909907341003
loss_pred:0.022072015330195427, decouple_loss:0.012321037240326405
The generated pressure mean: 0.4478185176849365
loss_pred:0.02145431563258171, decouple_loss:0.011393380351364613
The generated pressure mean: 0.4466969966888428
loss_pred:0.02249576337635517, decouple_loss:0.01183527521789074
Iteration: 1482, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4473601281642914
loss_pred:0.02079026959836483, decouple_loss:0.010942457243800163
The generated pressure mean: 0.4470933675765991
loss_pred:0.023745665326714516, decouple_loss:0.010782025754451752
The generated pressure mean: 0.446900337934494
loss_pred:0.02316216193139553, decouple_loss:0.011006309650838375
Iteration: 1483, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4476260244846344
loss_pred:0.021101845428347588, decouple_loss:0.011198536492884159
The generated pressure mean: 0.4490230679512024
loss_pred:0.02269660122692585, decouple_loss:0.011319495737552643
The generated pressure mean: 0.4462445080280304
loss_pred:0.02266583777964115, decouple_loss:0.011202489957213402
Iteration: 1484, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4466310441493988
loss_pred:0.021269243210554123, decouple_loss:0.011485026217997074
The generated pressure mean: 0.447394996881485
loss_pred:0.02156350016593933, decouple_loss:0.010933620855212212
The generated pressure mean: 0.44737738370895386
loss_pred:0.021803343668580055, decouple_loss:0.010999047197401524
Iteration: 1485, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4475580155849457
loss_pred:0.02202603779733181, decouple_loss:0.010439647361636162
The generated pressure mean: 0.44667258858680725
loss_pred:0.021472593769431114, decouple_loss:0.010424910113215446
The generated pressure mean: 0.4470888376235962
loss_pred:0.021424008533358574, decouple_loss:0.010394809767603874
Iteration: 1486, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4481668770313263
loss_pred:0.02160865068435669, decouple_loss:0.010536160320043564
The generated pressure mean: 0.4472908079624176
loss_pred:0.022512046620249748, decouple_loss:0.011549060232937336
The generated pressure mean: 0.44759035110473633
loss_pred:0.022513212636113167, decouple_loss:0.0106650460511446
Iteration: 1487, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44693997502326965
loss_pred:0.023469917476177216, decouple_loss:0.010670585557818413
The generated pressure mean: 0.4481617510318756
loss_pred:0.020163387060165405, decouple_loss:0.010175087489187717
The generated pressure mean: 0.4471888244152069
loss_pred:0.022431129589676857, decouple_loss:0.010103008709847927
Iteration: 1488, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4483383595943451
loss_pred:0.021256446838378906, decouple_loss:0.011049874126911163
The generated pressure mean: 0.4466798007488251
loss_pred:0.023006489500403404, decouple_loss:0.010851573199033737
The generated pressure mean: 0.44735562801361084
loss_pred:0.02176951803267002, decouple_loss:0.010952350683510303
Iteration: 1489, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.447007954120636
loss_pred:0.021009650081396103, decouple_loss:0.010503783822059631
The generated pressure mean: 0.4476296603679657
loss_pred:0.02147357538342476, decouple_loss:0.010933688841760159
The generated pressure mean: 0.44737499952316284
loss_pred:0.021614326164126396, decouple_loss:0.010370587930083275
Iteration: 1490, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4478265643119812
The generated pressure mean: 0.44745421409606934loss_pred:0.023434804752469063, decouple_loss:0.010630405507981777
loss_pred:0.02141198329627514, decouple_loss:0.009725209325551987
The generated pressure mean: 0.44588136672973633
loss_pred:0.021666835993528366, decouple_loss:0.010335919447243214
2023-04-16 07:23:43 testing...
The generated pressure mean: 0.4502691626548767
loss_pred:0.1416042596101761, decouple_loss:0.057560957968235016
The generated pressure mean: 0.4503220319747925
loss_pred:0.1395242065191269, decouple_loss:0.05838305875658989
The generated pressure mean: 0.4500294327735901
loss_pred:0.14101584255695343, decouple_loss:0.057401783764362335
Loss: 0.1436038613319397, avg_mse: 0.2728267014026642
current test mse: 0.272827
Iteration: 1491, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44738656282424927
loss_pred:0.022329874336719513, decouple_loss:0.01096022967249155
The generated pressure mean: 0.44727692008018494
loss_pred:0.02321932651102543, decouple_loss:0.010769965127110481
The generated pressure mean: 0.4479783773422241
loss_pred:0.021468786522746086, decouple_loss:0.010121261700987816
Iteration: 1492, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44813740253448486
loss_pred:0.021346602588891983, decouple_loss:0.010230669751763344
The generated pressure mean: 0.44664081931114197
loss_pred:0.021001270040869713, decouple_loss:0.00999671220779419
The generated pressure mean: 0.44574907422065735
loss_pred:0.021833866834640503, decouple_loss:0.010284511372447014
Iteration: 1493, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4471971094608307
loss_pred:0.021972669288516045, decouple_loss:0.010764596052467823
The generated pressure mean: 0.44744375348091125
The generated pressure mean: 0.447550505399704
loss_pred:0.022432979196310043, decouple_loss:0.010987051762640476
loss_pred:0.021680474281311035, decouple_loss:0.011215428821742535
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1494, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4485195279121399
loss_pred:0.020363885909318924, decouple_loss:0.011288977228105068
The generated pressure mean: 0.447243332862854
loss_pred:0.022313077002763748, decouple_loss:0.011755031533539295
The generated pressure mean: 0.4470067322254181
loss_pred:0.0213839840143919, decouple_loss:0.011375206522643566
Iteration: 1495, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4473147988319397
loss_pred:0.021085884422063828, decouple_loss:0.011177771724760532
The generated pressure mean: 0.44713932275772095
loss_pred:0.02081478387117386, decouple_loss:0.011001711711287498
The generated pressure mean: 0.4477250874042511
loss_pred:0.021269291639328003, decouple_loss:0.010944392532110214
Iteration: 1496, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4459507167339325
loss_pred:0.022280244156718254, decouple_loss:0.011952322907745838
The generated pressure mean: 0.44757896661758423
loss_pred:0.020804230123758316, decouple_loss:0.012032097205519676
The generated pressure mean: 0.4477030038833618
loss_pred:0.02219546213746071, decouple_loss:0.011457031592726707
Iteration: 1497, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4469127655029297
loss_pred:0.02184852585196495, decouple_loss:0.012235919944941998
The generated pressure mean: 0.44657018780708313
loss_pred:0.022740155458450317, decouple_loss:0.013136744499206543
The generated pressure mean: 0.44726043939590454
loss_pred:0.022753458470106125, decouple_loss:0.012714951299130917
Iteration: 1498, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4475235044956207
loss_pred:0.022806363180279732, decouple_loss:0.010038028471171856
The generated pressure mean: 0.4471534490585327
loss_pred:0.020893212407827377, decouple_loss:0.010231507010757923
The generated pressure mean: 0.4482744634151459
loss_pred:0.0215022973716259, decouple_loss:0.01013171300292015
Iteration: 1499, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4469144940376282
loss_pred:0.02160477824509144, decouple_loss:0.01241171546280384
The generated pressure mean: 0.4474116861820221
loss_pred:0.021428320556879044, decouple_loss:0.011421903036534786
The generated pressure mean: 0.445777952671051
loss_pred:0.02268207259476185, decouple_loss:0.012474763207137585
Iteration: 1500, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44792047142982483
loss_pred:0.021767791360616684, decouple_loss:0.01057202834635973
The generated pressure mean: 0.44709542393684387
loss_pred:0.022752000018954277, decouple_loss:0.01030263863503933
The generated pressure mean: 0.4472399652004242
loss_pred:0.020654777064919472, decouple_loss:0.011265737004578114
2023-04-16 07:25:48 testing...
The generated pressure mean: 0.4502691924571991
loss_pred:0.13931474089622498, decouple_loss:0.0565936453640461
The generated pressure mean: 0.45032551884651184
loss_pred:0.1374528557062149, decouple_loss:0.05682307854294777
The generated pressure mean: 0.4500318765640259
loss_pred:0.13867376744747162, decouple_loss:0.05627578869462013
Loss: 0.14130866527557373, avg_mse: 0.27159151434898376
current test mse: 0.271592
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012018_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012018_3_24hr.npz
NaN value num: 0
Iteration: 1501, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4486871361732483
loss_pred:0.02152620255947113, decouple_loss:0.010402445681393147
The generated pressure mean: 0.4493362009525299
loss_pred:0.02110336720943451, decouple_loss:0.010157180018723011
The generated pressure mean: 0.44849151372909546
loss_pred:0.02097916044294834, decouple_loss:0.010539493523538113
Iteration: 1502, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44857290387153625
loss_pred:0.022388959303498268, decouple_loss:0.011974968016147614
The generated pressure mean: 0.448368638753891
loss_pred:0.021365605294704437, decouple_loss:0.011278205551207066
The generated pressure mean: 0.44799330830574036
loss_pred:0.021151242777705193, decouple_loss:0.01105701643973589
Iteration: 1503, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4481225907802582
loss_pred:0.022413143888115883, decouple_loss:0.011480094864964485
The generated pressure mean: 0.4489906132221222
loss_pred:0.021321814507246017, decouple_loss:0.0117255924269557
The generated pressure mean: 0.44857558608055115
loss_pred:0.021204886958003044, decouple_loss:0.011827221140265465
Iteration: 1504, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.448689728975296
The generated pressure mean: 0.4481886625289917loss_pred:0.022144457325339317, decouple_loss:0.010679759085178375
loss_pred:0.020368393510580063, decouple_loss:0.010559199377894402
The generated pressure mean: 0.44840723276138306
loss_pred:0.020983003079891205, decouple_loss:0.01028513628989458
Iteration: 1505, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4484509825706482
The generated pressure mean: 0.4483763575553894
loss_pred:0.022458497434854507, decouple_loss:0.010632330551743507
loss_pred:0.020465772598981857, decouple_loss:0.010552852414548397
The generated pressure mean: 0.4480723440647125
loss_pred:0.021736953407526016, decouple_loss:0.010819694958627224
Iteration: 1506, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4485710561275482
loss_pred:0.02146480418741703, decouple_loss:0.01008224580436945
The generated pressure mean: 0.44828975200653076
loss_pred:0.020580800250172615, decouple_loss:0.010100023820996284
The generated pressure mean: 0.44828683137893677
loss_pred:0.02139979414641857, decouple_loss:0.010330263525247574
Iteration: 1507, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44869092106819153
loss_pred:0.02238091267645359, decouple_loss:0.009575380012392998
The generated pressure mean: 0.44837573170661926
loss_pred:0.022982502356171608, decouple_loss:0.01021608430892229
The generated pressure mean: 0.448642373085022
loss_pred:0.02182134799659252, decouple_loss:0.009637091308832169
Iteration: 1508, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4478627145290375
loss_pred:0.020881373435258865, decouple_loss:0.00989288929849863
The generated pressure mean: 0.44845858216285706
loss_pred:0.02154681272804737, decouple_loss:0.010274982079863548
The generated pressure mean: 0.44879984855651855
loss_pred:0.020989930257201195, decouple_loss:0.010438789613544941
Iteration: 1509, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.448357492685318
loss_pred:0.021866610273718834, decouple_loss:0.010136215947568417
The generated pressure mean: 0.44801968336105347
loss_pred:0.022770991548895836, decouple_loss:0.010249590501189232
The generated pressure mean: 0.44834500551223755
loss_pred:0.023097354918718338, decouple_loss:0.010127668268978596
Iteration: 1510, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44902217388153076
The generated pressure mean: 0.44890227913856506
loss_pred:0.021377043798565865, decouple_loss:0.010196192190051079
loss_pred:0.024538615718483925, decouple_loss:0.010672233998775482
The generated pressure mean: 0.44847798347473145
loss_pred:0.020454155281186104, decouple_loss:0.01021256297826767
2023-04-16 07:28:32 testing...
The generated pressure mean: 0.4502691328525543
loss_pred:0.14021630585193634, decouple_loss:0.05598912015557289
The generated pressure mean: 0.4503224492073059
loss_pred:0.1384338140487671, decouple_loss:0.05618748068809509
The generated pressure mean: 0.4500308632850647
loss_pred:0.13932816684246063, decouple_loss:0.05576696619391441
Loss: 0.14212515950202942, avg_mse: 0.2712794542312622
current test mse: 0.271279
Iteration: 1511, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4482952952384949
loss_pred:0.020116742700338364, decouple_loss:0.010844480246305466
The generated pressure mean: 0.44855502247810364
loss_pred:0.02152487076818943, decouple_loss:0.01095725130289793
The generated pressure mean: 0.4487638771533966
loss_pred:0.0225775595754385, decouple_loss:0.010824237018823624
Iteration: 1512, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4483089745044708
loss_pred:0.021189069375395775, decouple_loss:0.011623208411037922
The generated pressure mean: 0.44863730669021606
loss_pred:0.022787583991885185, decouple_loss:0.012264372780919075
The generated pressure mean: 0.4493548274040222
loss_pred:0.021435890346765518, decouple_loss:0.011252298951148987
Iteration: 1513, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44868820905685425
loss_pred:0.023587454110383987, decouple_loss:0.010103135369718075
The generated pressure mean: 0.4490009844303131
loss_pred:0.021487237885594368, decouple_loss:0.010204600170254707
The generated pressure mean: 0.44913408160209656
loss_pred:0.02116995118558407, decouple_loss:0.010718013159930706
Iteration: 1514, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4482100009918213
loss_pred:0.022484008222818375, decouple_loss:0.010137375444173813
The generated pressure mean: 0.44925886392593384
loss_pred:0.021499229595065117, decouple_loss:0.010491658933460712
The generated pressure mean: 0.4480893015861511
loss_pred:0.022345034405589104, decouple_loss:0.010014376603066921
Iteration: 1515, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4480922520160675
loss_pred:0.020889433100819588, decouple_loss:0.011087991297245026
The generated pressure mean: 0.4485287070274353
loss_pred:0.021989284083247185, decouple_loss:0.010526508092880249
The generated pressure mean: 0.44769927859306335
loss_pred:0.02201811969280243, decouple_loss:0.010962816886603832
Iteration: 1516, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4477727711200714
loss_pred:0.021894922479987144, decouple_loss:0.010399208404123783
The generated pressure mean: 0.4479905664920807
loss_pred:0.02121785841882229, decouple_loss:0.010537805035710335
The generated pressure mean: 0.44843512773513794
loss_pred:0.021501872688531876, decouple_loss:0.010790707543492317
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1517, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4482004642486572
loss_pred:0.021706225350499153, decouple_loss:0.009681719355285168
The generated pressure mean: 0.4493773579597473
loss_pred:0.022956596687436104, decouple_loss:0.010233316570520401
The generated pressure mean: 0.4488682448863983
loss_pred:0.02151142805814743, decouple_loss:0.009895690716803074
Iteration: 1518, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4478519558906555
loss_pred:0.021748866885900497, decouple_loss:0.010903492569923401
The generated pressure mean: 0.4480769634246826
loss_pred:0.02183639071881771, decouple_loss:0.010778946802020073
The generated pressure mean: 0.44892457127571106
loss_pred:0.019825894385576248, decouple_loss:0.010985467582941055
Iteration: 1519, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4484792649745941
loss_pred:0.022553974762558937, decouple_loss:0.01059927698224783
The generated pressure mean: 0.4485235810279846
loss_pred:0.020955637097358704, decouple_loss:0.010360474698245525
The generated pressure mean: 0.4484265446662903
loss_pred:0.02210472710430622, decouple_loss:0.010549030266702175
Iteration: 1520, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4497367739677429
loss_pred:0.022631404921412468, decouple_loss:0.011226952075958252The generated pressure mean: 0.44811275601387024
loss_pred:0.021017905324697495, decouple_loss:0.010720016434788704
The generated pressure mean: 0.44870713353157043
loss_pred:0.022463440895080566, decouple_loss:0.011194958351552486
2023-04-16 07:30:40 testing...
The generated pressure mean: 0.4502691328525543
loss_pred:0.14068232476711273, decouple_loss:0.056147582828998566
The generated pressure mean: 0.4500305950641632
loss_pred:0.14072197675704956, decouple_loss:0.05583123862743378
The generated pressure mean: 0.45032379031181335
loss_pred:0.1393936425447464, decouple_loss:0.056532490998506546
Loss: 0.14307451248168945, avg_mse: 0.273607462644577
current test mse: 0.273607
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012005_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012005_3_24hr.npz
NaN value num: 0
Iteration: 1521, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45027121901512146
loss_pred:0.023758571594953537, decouple_loss:0.011594348587095737
The generated pressure mean: 0.44964972138404846
loss_pred:0.020636271685361862, decouple_loss:0.010943710803985596
The generated pressure mean: 0.4485305845737457
loss_pred:0.021392231807112694, decouple_loss:0.011719451285898685
Iteration: 1522, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4506905674934387
loss_pred:0.02188345417380333, decouple_loss:0.012264221906661987
The generated pressure mean: 0.44944486021995544
loss_pred:0.023895569145679474, decouple_loss:0.012074503116309643
The generated pressure mean: 0.4509160816669464
loss_pred:0.019386233761906624, decouple_loss:0.011480496264994144
Iteration: 1523, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4490254521369934
loss_pred:0.02118651010096073, decouple_loss:0.011277887970209122
The generated pressure mean: 0.44997933506965637
loss_pred:0.022227343171834946, decouple_loss:0.011041694320738316
The generated pressure mean: 0.4508589506149292
loss_pred:0.02197340689599514, decouple_loss:0.011513217352330685
Iteration: 1524, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4491962194442749
loss_pred:0.020748918876051903, decouple_loss:0.011202136985957623
The generated pressure mean: 0.4496791362762451
loss_pred:0.021267443895339966, decouple_loss:0.011468593031167984
The generated pressure mean: 0.45134487748146057
loss_pred:0.02203187346458435, decouple_loss:0.011441116221249104
Iteration: 1525, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4488249719142914
loss_pred:0.020729294046759605, decouple_loss:0.011720329523086548
The generated pressure mean: 0.44999393820762634
loss_pred:0.020919281989336014, decouple_loss:0.012072831392288208
The generated pressure mean: 0.4493269920349121
loss_pred:0.019546426832675934, decouple_loss:0.012294850312173367
Iteration: 1526, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4493443965911865
The generated pressure mean: 0.4495076537132263loss_pred:0.021923692896962166, decouple_loss:0.011154972948133945
loss_pred:0.022266153246164322, decouple_loss:0.010766156017780304
The generated pressure mean: 0.4500192701816559
loss_pred:0.021294016391038895, decouple_loss:0.010865254327654839
Iteration: 1527, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4502710700035095
The generated pressure mean: 0.4501357078552246
loss_pred:0.01943379081785679, decouple_loss:0.010851665399968624
loss_pred:0.02194789983332157, decouple_loss:0.010938283987343311
The generated pressure mean: 0.4502268433570862
loss_pred:0.020339570939540863, decouple_loss:0.011034798808395863
Iteration: 1528, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44949567317962646
The generated pressure mean: 0.4497261047363281loss_pred:0.022177590057253838, decouple_loss:0.010591201484203339
loss_pred:0.021632038056850433, decouple_loss:0.01116480678319931
The generated pressure mean: 0.4489419162273407
loss_pred:0.02175101451575756, decouple_loss:0.011258590035140514
Iteration: 1529, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4501647651195526
The generated pressure mean: 0.4499059319496155
loss_pred:0.021069156005978584, decouple_loss:0.010255408473312855
loss_pred:0.021453063935041428, decouple_loss:0.011114506050944328
The generated pressure mean: 0.4507373571395874
loss_pred:0.020008403807878494, decouple_loss:0.01080241333693266
Iteration: 1530, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45085597038269043
The generated pressure mean: 0.451168417930603
loss_pred:0.019504176452755928, decouple_loss:0.010420246049761772
loss_pred:0.021183056756854057, decouple_loss:0.011044801212847233
The generated pressure mean: 0.45048457384109497
loss_pred:0.01953013241291046, decouple_loss:0.010858491994440556
2023-04-16 07:33:28 testing...
The generated pressure mean: 0.4502691328525543
loss_pred:0.14089587330818176, decouple_loss:0.06002258509397507
The generated pressure mean: 0.4500332176685333
The generated pressure mean: 0.4503248631954193
loss_pred:0.14021825790405273, decouple_loss:0.05969703942537308
loss_pred:0.1392693668603897, decouple_loss:0.06019909679889679
Loss: 0.1431264877319336, avg_mse: 0.275022953748703
current test mse: 0.275023
Iteration: 1531, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45008471608161926
loss_pred:0.02052498236298561, decouple_loss:0.01149715855717659
The generated pressure mean: 0.449892520904541
The generated pressure mean: 0.44898560643196106
loss_pred:0.019926274195313454, decouple_loss:0.010769128799438477
loss_pred:0.02203252911567688, decouple_loss:0.011131691746413708
Iteration: 1532, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44777730107307434
loss_pred:0.021400734782218933, decouple_loss:0.009438177570700645
The generated pressure mean: 0.44948434829711914
The generated pressure mean: 0.4507938325405121
loss_pred:0.021836912259459496, decouple_loss:0.009414960630238056
loss_pred:0.020555363968014717, decouple_loss:0.009577924385666847
Iteration: 1533, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45058709383010864
loss_pred:0.01924218237400055, decouple_loss:0.010468624532222748
The generated pressure mean: 0.4511127769947052
loss_pred:0.020037800073623657, decouple_loss:0.010324839502573013
The generated pressure mean: 0.4499901533126831
loss_pred:0.020451785996556282, decouple_loss:0.01108143012970686
Iteration: 1534, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4495840072631836
loss_pred:0.020614180713891983, decouple_loss:0.010937941260635853
The generated pressure mean: 0.450015127658844
loss_pred:0.02023286744952202, decouple_loss:0.010704238899052143
The generated pressure mean: 0.4504283368587494
loss_pred:0.020159052684903145, decouple_loss:0.01140601560473442
Iteration: 1535, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45101988315582275
loss_pred:0.0199983362108469, decouple_loss:0.010216346010565758
The generated pressure mean: 0.4511544704437256
loss_pred:0.02118263579905033, decouple_loss:0.010613178834319115
The generated pressure mean: 0.44957631826400757
loss_pred:0.020788326859474182, decouple_loss:0.010238242335617542
Iteration: 1536, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44809114933013916
loss_pred:0.023448877036571503, decouple_loss:0.011124691925942898
The generated pressure mean: 0.4509921967983246
loss_pred:0.020442195236682892, decouple_loss:0.009909623302519321
The generated pressure mean: 0.4496289789676666
loss_pred:0.020714083686470985, decouple_loss:0.010532889515161514
Iteration: 1537, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45101240277290344
loss_pred:0.02131929062306881, decouple_loss:0.011160578578710556
The generated pressure mean: 0.4495777189731598
loss_pred:0.023031750693917274, decouple_loss:0.010930822230875492
The generated pressure mean: 0.4481026828289032
loss_pred:0.021060964092612267, decouple_loss:0.010736735537648201
Iteration: 1538, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4483107030391693
loss_pred:0.021988216787576675, decouple_loss:0.010602491907775402
The generated pressure mean: 0.4508168399333954
loss_pred:0.02048398181796074, decouple_loss:0.011181548237800598
The generated pressure mean: 0.4506426155567169
loss_pred:0.022001992911100388, decouple_loss:0.010868784971535206
Iteration: 1539, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45050230622291565
loss_pred:0.021454762667417526, decouple_loss:0.010347002185881138
The generated pressure mean: 0.4507790207862854
loss_pred:0.021191686391830444, decouple_loss:0.010402041487395763
The generated pressure mean: 0.4488842189311981
loss_pred:0.021884093061089516, decouple_loss:0.010060055181384087
Iteration: 1540, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4484531879425049
The generated pressure mean: 0.4498012959957123
loss_pred:0.024188455194234848, decouple_loss:0.011185072362422943
loss_pred:0.020794006064534187, decouple_loss:0.010470891371369362
The generated pressure mean: 0.44781404733657837
loss_pred:0.02170259691774845, decouple_loss:0.011253394186496735
2023-04-16 07:35:34 testing...
The generated pressure mean: 0.4502691924571991
loss_pred:0.14316408336162567, decouple_loss:0.05871519818902016
The generated pressure mean: 0.4503256678581238
loss_pred:0.14173564314842224, decouple_loss:0.058936331421136856
The generated pressure mean: 0.45002973079681396
loss_pred:0.1426544487476349, decouple_loss:0.05822296068072319
Loss: 0.14544931054115295, avg_mse: 0.2792435586452484
current test mse: 0.279244
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012009_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012009_3_24hr.npz
NaN value num: 0
Iteration: 1541, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4474082887172699
loss_pred:0.0238674134016037, decouple_loss:0.010740891098976135
The generated pressure mean: 0.44680967926979065
loss_pred:0.02294895052909851, decouple_loss:0.010958192870020866
The generated pressure mean: 0.4492776691913605
loss_pred:0.022785307839512825, decouple_loss:0.011034837923943996
Iteration: 1542, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44765588641166687
loss_pred:0.02160416916012764, decouple_loss:0.011411387473344803
The generated pressure mean: 0.44810760021209717
loss_pred:0.020944884046912193, decouple_loss:0.011280396953225136
The generated pressure mean: 0.4484156668186188
loss_pred:0.0217614583671093, decouple_loss:0.01126536913216114
Iteration: 1543, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4466610848903656
loss_pred:0.024427248165011406, decouple_loss:0.011329788714647293
The generated pressure mean: 0.44893959164619446
loss_pred:0.02152116596698761, decouple_loss:0.011294877156615257
The generated pressure mean: 0.4483095407485962
loss_pred:0.021721260622143745, decouple_loss:0.011360295116901398
Iteration: 1544, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4461611211299896
loss_pred:0.02247137762606144, decouple_loss:0.010609901510179043
The generated pressure mean: 0.44770094752311707
loss_pred:0.02170643024146557, decouple_loss:0.010585710406303406
The generated pressure mean: 0.44824641942977905
loss_pred:0.02255731076002121, decouple_loss:0.010618039406836033
Iteration: 1545, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44737040996551514
loss_pred:0.02195977419614792, decouple_loss:0.011222251690924168
The generated pressure mean: 0.4477129876613617
loss_pred:0.021934207528829575, decouple_loss:0.011527708731591702
The generated pressure mean: 0.44605985283851624
loss_pred:0.02215457335114479, decouple_loss:0.011381399817764759
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1546, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4491879343986511
The generated pressure mean: 0.44755280017852783loss_pred:0.021533120423555374, decouple_loss:0.011688990518450737
loss_pred:0.023176496848464012, decouple_loss:0.010358691215515137
The generated pressure mean: 0.4484204351902008
loss_pred:0.021224403753876686, decouple_loss:0.010570036247372627
Iteration: 1547, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44699814915657043
loss_pred:0.02244463749229908, decouple_loss:0.010681089013814926
The generated pressure mean: 0.44773998856544495
loss_pred:0.022795118391513824, decouple_loss:0.011197985149919987
The generated pressure mean: 0.44818049669265747
loss_pred:0.020198330283164978, decouple_loss:0.0108496630564332
Iteration: 1548, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4491211175918579
loss_pred:0.02212318405508995, decouple_loss:0.010461312718689442
The generated pressure mean: 0.44806912541389465
loss_pred:0.020424501970410347, decouple_loss:0.010901859030127525
The generated pressure mean: 0.4499625563621521
loss_pred:0.022881070151925087, decouple_loss:0.010695437900722027
Iteration: 1549, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44796696305274963
The generated pressure mean: 0.4504035413265228loss_pred:0.02135862223803997, decouple_loss:0.010317892767488956
loss_pred:0.02094811387360096, decouple_loss:0.010119090788066387
The generated pressure mean: 0.4475551247596741
loss_pred:0.021772898733615875, decouple_loss:0.01023022085428238
Iteration: 1550, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44967207312583923The generated pressure mean: 0.4488844573497772
loss_pred:0.02213527448475361, decouple_loss:0.010917361825704575loss_pred:0.02270769700407982, decouple_loss:0.01041306834667921
The generated pressure mean: 0.44878390431404114
loss_pred:0.022281236946582794, decouple_loss:0.01063262764364481
2023-04-16 07:38:15 testing...
The generated pressure mean: 0.4502691328525543
loss_pred:0.13846664130687714, decouple_loss:0.05592137947678566
The generated pressure mean: 0.45032399892807007
loss_pred:0.13678810000419617, decouple_loss:0.05631513521075249
The generated pressure mean: 0.45003220438957214
loss_pred:0.13797199726104736, decouple_loss:0.055848121643066406
Loss: 0.14054366946220398, avg_mse: 0.2686123549938202
current test mse: 0.268612
Iteration: 1551, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44908761978149414
The generated pressure mean: 0.44896775484085083
loss_pred:0.021845486015081406, decouple_loss:0.009873882867395878
loss_pred:0.0222447719424963, decouple_loss:0.010329492390155792
The generated pressure mean: 0.4478975236415863
loss_pred:0.020925482735037804, decouple_loss:0.00994941033422947
Iteration: 1552, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44786229729652405
loss_pred:0.021008286625146866, decouple_loss:0.01003029104322195
The generated pressure mean: 0.448178231716156
The generated pressure mean: 0.45000696182250977
loss_pred:0.021656960248947144, decouple_loss:0.010105988942086697
loss_pred:0.022178426384925842, decouple_loss:0.010409153997898102
Iteration: 1553, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4467287063598633
loss_pred:0.02182939276099205, decouple_loss:0.011410925537347794
The generated pressure mean: 0.4478521943092346The generated pressure mean: 0.44860538840293884
loss_pred:0.02119956538081169, decouple_loss:0.010807118378579617
loss_pred:0.02141360007226467, decouple_loss:0.010466796346008778
Iteration: 1554, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4473818242549896
The generated pressure mean: 0.44719168543815613loss_pred:0.022035986185073853, decouple_loss:0.010268672369420528
loss_pred:0.02066936530172825, decouple_loss:0.010315420106053352
The generated pressure mean: 0.44785043597221375
loss_pred:0.020880823954939842, decouple_loss:0.009948541410267353
Iteration: 1555, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.447502464056015
The generated pressure mean: 0.4483911395072937
loss_pred:0.023285605013370514, decouple_loss:0.011457232758402824
loss_pred:0.021661512553691864, decouple_loss:0.011121638119220734
The generated pressure mean: 0.4485919177532196
loss_pred:0.021384183317422867, decouple_loss:0.011140873655676842
Iteration: 1556, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4483552575111389
loss_pred:0.022753123193979263, decouple_loss:0.01009373553097248
The generated pressure mean: 0.448006272315979
loss_pred:0.02150081656873226, decouple_loss:0.010740060359239578
The generated pressure mean: 0.446720689535141
loss_pred:0.021372290328145027, decouple_loss:0.010640733875334263
Iteration: 1557, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.449093759059906
The generated pressure mean: 0.44860678911209106loss_pred:0.021103357896208763, decouple_loss:0.010935657657682896
loss_pred:0.021104203537106514, decouple_loss:0.010379083454608917
The generated pressure mean: 0.4479876756668091
loss_pred:0.020958833396434784, decouple_loss:0.009863902814686298
Iteration: 1558, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44746100902557373
loss_pred:0.02199852652847767, decouple_loss:0.012371880933642387
The generated pressure mean: 0.4481034278869629
loss_pred:0.021535838022828102, decouple_loss:0.012185217812657356
The generated pressure mean: 0.44672897458076477
loss_pred:0.021257271990180016, decouple_loss:0.012700594030320644
Iteration: 1559, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44793522357940674
The generated pressure mean: 0.4488939940929413loss_pred:0.021715054288506508, decouple_loss:0.010553298518061638
loss_pred:0.020456736907362938, decouple_loss:0.010624861344695091
The generated pressure mean: 0.4481879770755768
loss_pred:0.02089451253414154, decouple_loss:0.010690927505493164
Iteration: 1560, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4483681917190552
loss_pred:0.02077656239271164, decouple_loss:0.010943356901407242
The generated pressure mean: 0.4477708041667938
loss_pred:0.021368708461523056, decouple_loss:0.010441075079143047
The generated pressure mean: 0.44936874508857727
loss_pred:0.02257208153605461, decouple_loss:0.010664555244147778
2023-04-16 07:40:21 testing...
The generated pressure mean: 0.4502691626548767
loss_pred:0.14330588281154633, decouple_loss:0.059482648968696594
The generated pressure mean: 0.4500288665294647
loss_pred:0.14270555973052979, decouple_loss:0.059153515845537186
The generated pressure mean: 0.45032697916030884
loss_pred:0.14165985584259033, decouple_loss:0.059349313378334045
Loss: 0.14552351832389832, avg_mse: 0.28017207980155945
current test mse: 0.280172
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012018_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012018_3_24hr.npz
NaN value num: 0
Iteration: 1561, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4494740962982178
loss_pred:0.022239185869693756, decouple_loss:0.011237915605306625
The generated pressure mean: 0.4490882456302643
loss_pred:0.02178867906332016, decouple_loss:0.011603489518165588
The generated pressure mean: 0.4493294656276703
loss_pred:0.020797472447156906, decouple_loss:0.011833824217319489
Iteration: 1562, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44967392086982727
loss_pred:0.02126355469226837, decouple_loss:0.010971006006002426
The generated pressure mean: 0.44841891527175903
loss_pred:0.021023157984018326, decouple_loss:0.00970050785690546
The generated pressure mean: 0.44880685210227966
loss_pred:0.023298582062125206, decouple_loss:0.010078764520585537
Iteration: 1563, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4497917592525482
loss_pred:0.022344021126627922, decouple_loss:0.010743909515440464
The generated pressure mean: 0.4501909017562866
loss_pred:0.02242451347410679, decouple_loss:0.01028334442526102
The generated pressure mean: 0.44849857687950134
loss_pred:0.022049473598599434, decouple_loss:0.011091639287769794
Iteration: 1564, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4492645561695099
loss_pred:0.022178152576088905, decouple_loss:0.01152460090816021
The generated pressure mean: 0.4504033029079437
loss_pred:0.023623604327440262, decouple_loss:0.0119227459654212
The generated pressure mean: 0.4486018419265747
loss_pred:0.02039583958685398, decouple_loss:0.01061585545539856
Iteration: 1565, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44960880279541016
loss_pred:0.021251730620861053, decouple_loss:0.00989572610706091
The generated pressure mean: 0.4488058388233185
loss_pred:0.021067189052700996, decouple_loss:0.009694945998489857
The generated pressure mean: 0.4493672847747803
loss_pred:0.021414196118712425, decouple_loss:0.010036943480372429
Iteration: 1566, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4495769441127777
The generated pressure mean: 0.44844070076942444loss_pred:0.022071240469813347, decouple_loss:0.00998907070606947
loss_pred:0.022561680525541306, decouple_loss:0.009946509264409542
The generated pressure mean: 0.45068493485450745
loss_pred:0.021784676238894463, decouple_loss:0.009463762864470482
Iteration: 1567, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44858238101005554
loss_pred:0.022401602938771248, decouple_loss:0.011057206429541111
The generated pressure mean: 0.4491066634654999
loss_pred:0.023279592394828796, decouple_loss:0.011319786310195923
The generated pressure mean: 0.44845113158226013
loss_pred:0.02214033156633377, decouple_loss:0.010136633180081844
Iteration: 1568, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4491935968399048
loss_pred:0.02219102345407009, decouple_loss:0.011280911974608898
The generated pressure mean: 0.4483838975429535
loss_pred:0.021782157942652702, decouple_loss:0.011620523408055305
The generated pressure mean: 0.44973626732826233
loss_pred:0.023232243955135345, decouple_loss:0.011636199429631233
Iteration: 1569, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44944843649864197
loss_pred:0.021930763497948647, decouple_loss:0.011630999855697155
The generated pressure mean: 0.4498130679130554
loss_pred:0.022176533937454224, decouple_loss:0.011834082193672657
The generated pressure mean: 0.4501277506351471
loss_pred:0.02196122147142887, decouple_loss:0.011691613122820854
Iteration: 1570, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44866886734962463
The generated pressure mean: 0.449194997549057loss_pred:0.022518962621688843, decouple_loss:0.010697162710130215
loss_pred:0.02261681854724884, decouple_loss:0.010679028928279877
The generated pressure mean: 0.450023889541626
loss_pred:0.021141165867447853, decouple_loss:0.010093603283166885
2023-04-16 07:43:09 testing...
The generated pressure mean: 0.4502691626548767
loss_pred:0.14172451198101044, decouple_loss:0.05826588720083237
The generated pressure mean: 0.45032212138175964
loss_pred:0.1400008201599121, decouple_loss:0.05836784467101097
The generated pressure mean: 0.4500327408313751
loss_pred:0.14115004241466522, decouple_loss:0.05800529941916466
Loss: 0.14386910200119019, avg_mse: 0.27426785230636597
current test mse: 0.274268
Iteration: 1571, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44943180680274963
loss_pred:0.021197112277150154, decouple_loss:0.010285848751664162
The generated pressure mean: 0.44988271594047546
loss_pred:0.021819040179252625, decouple_loss:0.010221532545983791
The generated pressure mean: 0.4495057761669159
loss_pred:0.022521596401929855, decouple_loss:0.010328692384064198
Iteration: 1572, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4490891993045807
loss_pred:0.023384010419249535, decouple_loss:0.010514974594116211
The generated pressure mean: 0.44896867871284485
loss_pred:0.02121644653379917, decouple_loss:0.01057849358767271
The generated pressure mean: 0.4501088261604309
loss_pred:0.022318491712212563, decouple_loss:0.010407599620521069
Iteration: 1573, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4499533772468567
loss_pred:0.022200215607881546, decouple_loss:0.010242234915494919
The generated pressure mean: 0.4495818018913269
loss_pred:0.02262626588344574, decouple_loss:0.010099941864609718
The generated pressure mean: 0.4490654170513153
loss_pred:0.023134831339120865, decouple_loss:0.010441404767334461
Iteration: 1574, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4512656033039093
The generated pressure mean: 0.45002368092536926
loss_pred:0.021795162931084633, decouple_loss:0.010276690125465393
loss_pred:0.021783826872706413, decouple_loss:0.011093957349658012
The generated pressure mean: 0.4485172927379608
loss_pred:0.020187415182590485, decouple_loss:0.010819792747497559
Iteration: 1575, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4501371383666992
loss_pred:0.01956731639802456, decouple_loss:0.010038797743618488
The generated pressure mean: 0.4489181935787201
loss_pred:0.022400615736842155, decouple_loss:0.010084173642098904
The generated pressure mean: 0.44985586404800415
loss_pred:0.0212930366396904, decouple_loss:0.01006435789167881
Iteration: 1576, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4496449828147888
loss_pred:0.021506132557988167, decouple_loss:0.010357039049267769
The generated pressure mean: 0.4504023492336273
loss_pred:0.020135393366217613, decouple_loss:0.010201998986303806
The generated pressure mean: 0.44936618208885193
loss_pred:0.02225988171994686, decouple_loss:0.00983064342290163
Iteration: 1577, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45000773668289185
loss_pred:0.02149377390742302, decouple_loss:0.010244863107800484
The generated pressure mean: 0.45163261890411377
loss_pred:0.021974267438054085, decouple_loss:0.010715083219110966
The generated pressure mean: 0.4506399929523468
loss_pred:0.021595560014247894, decouple_loss:0.01079118624329567
Iteration: 1578, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4488479495048523
loss_pred:0.022793404757976532, decouple_loss:0.010698842816054821
The generated pressure mean: 0.44813454151153564
loss_pred:0.02227235585451126, decouple_loss:0.010545141063630581
The generated pressure mean: 0.4495863914489746
loss_pred:0.02141067385673523, decouple_loss:0.010889808647334576
Iteration: 1579, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.448539137840271
loss_pred:0.020838670432567596, decouple_loss:0.010205724276602268
The generated pressure mean: 0.44910159707069397
loss_pred:0.020677844062447548, decouple_loss:0.010218522511422634
The generated pressure mean: 0.450613796710968
loss_pred:0.02228480391204357, decouple_loss:0.01038889680057764
Iteration: 1580, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45049721002578735
loss_pred:0.020817093551158905, decouple_loss:0.01021008100360632
The generated pressure mean: 0.4498697519302368
loss_pred:0.02154153399169445, decouple_loss:0.010183895006775856
The generated pressure mean: 0.45005881786346436
loss_pred:0.021862175315618515, decouple_loss:0.010395292192697525
2023-04-16 07:45:16 testing...
The generated pressure mean: 0.4502691626548767
loss_pred:0.14538055658340454, decouple_loss:0.05837872996926308
The generated pressure mean: 0.4503210186958313
loss_pred:0.14315839111804962, decouple_loss:0.058515191078186035
The generated pressure mean: 0.450030654668808
loss_pred:0.14473021030426025, decouple_loss:0.058029282838106155
Loss: 0.14733844995498657, avg_mse: 0.2827088236808777
current test mse: 0.282709
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012007_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012007_3_24hr.npz
NaN value num: 0
Iteration: 1581, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4488216042518616
loss_pred:0.021558653563261032, decouple_loss:0.010661717504262924
The generated pressure mean: 0.4497593939304352
The generated pressure mean: 0.4486986994743347
loss_pred:0.02028581313788891, decouple_loss:0.010862946510314941
loss_pred:0.021980490535497665, decouple_loss:0.010167109780013561
Iteration: 1582, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4507359266281128
loss_pred:0.02268967404961586, decouple_loss:0.011833682656288147
The generated pressure mean: 0.4477058947086334
loss_pred:0.02216203510761261, decouple_loss:0.011593552306294441
The generated pressure mean: 0.44856566190719604
loss_pred:0.020564885810017586, decouple_loss:0.011009637266397476
Iteration: 1583, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4467513859272003
loss_pred:0.02122376672923565, decouple_loss:0.010854410007596016
The generated pressure mean: 0.4479958117008209
loss_pred:0.02202863059937954, decouple_loss:0.011134065687656403
The generated pressure mean: 0.44762900471687317
loss_pred:0.022634733468294144, decouple_loss:0.011136853136122227
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1584, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4489363431930542
loss_pred:0.021416375413537025, decouple_loss:0.010361372493207455
The generated pressure mean: 0.44878900051116943
loss_pred:0.025156110525131226, decouple_loss:0.010498462244868279
The generated pressure mean: 0.4490967392921448
loss_pred:0.02195407636463642, decouple_loss:0.010502200573682785
Iteration: 1585, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44879260659217834
loss_pred:0.022762920707464218, decouple_loss:0.01082114689052105
The generated pressure mean: 0.44797778129577637
loss_pred:0.021966682747006416, decouple_loss:0.01059070322662592
The generated pressure mean: 0.4486089050769806
loss_pred:0.020935876294970512, decouple_loss:0.010488688945770264
Iteration: 1586, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4477381706237793
loss_pred:0.023987948894500732, decouple_loss:0.011127620004117489
The generated pressure mean: 0.4488147795200348
loss_pred:0.021015416830778122, decouple_loss:0.01128008496016264
The generated pressure mean: 0.450017511844635
loss_pred:0.02177528105676174, decouple_loss:0.010452893562614918
Iteration: 1587, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4469880759716034
loss_pred:0.020490135997533798, decouple_loss:0.010723661631345749
The generated pressure mean: 0.44742918014526367
loss_pred:0.020781995728611946, decouple_loss:0.010508136823773384
The generated pressure mean: 0.44949305057525635
loss_pred:0.020936520770192146, decouple_loss:0.010150403715670109
Iteration: 1588, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4475785791873932
loss_pred:0.021230043843388557, decouple_loss:0.010235365480184555
The generated pressure mean: 0.4490039348602295
loss_pred:0.023324955254793167, decouple_loss:0.010199402458965778
The generated pressure mean: 0.44835829734802246
loss_pred:0.024150775745511055, decouple_loss:0.01030749548226595
Iteration: 1589, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4473554491996765
loss_pred:0.024817001074552536, decouple_loss:0.009928440675139427
The generated pressure mean: 0.44852501153945923
loss_pred:0.021787036210298538, decouple_loss:0.009932667948305607
The generated pressure mean: 0.4481087923049927
loss_pred:0.022564971819519997, decouple_loss:0.009918906725943089
Iteration: 1590, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44824978709220886
loss_pred:0.020682360976934433, decouple_loss:0.009938259609043598
The generated pressure mean: 0.44760221242904663
loss_pred:0.02234722301363945, decouple_loss:0.010059448890388012
The generated pressure mean: 0.4482838213443756
loss_pred:0.0227520689368248, decouple_loss:0.01004029531031847
2023-04-16 07:48:03 testing...
The generated pressure mean: 0.4502691924571991
loss_pred:0.14133979380130768, decouple_loss:0.055054206401109695
The generated pressure mean: 0.45032232999801636
loss_pred:0.1398865133523941, decouple_loss:0.05550161749124527
The generated pressure mean: 0.4500328600406647
loss_pred:0.14109915494918823, decouple_loss:0.05484037473797798
Loss: 0.14353176951408386, avg_mse: 0.27549898624420166
current test mse: 0.275499
Iteration: 1591, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.449388712644577
loss_pred:0.022569581866264343, decouple_loss:0.009981997311115265
The generated pressure mean: 0.44834133982658386
loss_pred:0.021343296393752098, decouple_loss:0.010188422165811062
The generated pressure mean: 0.44764432311058044
loss_pred:0.021925708279013634, decouple_loss:0.009710720740258694
Iteration: 1592, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4474615156650543
loss_pred:0.02242645062506199, decouple_loss:0.010103144682943821
The generated pressure mean: 0.44748908281326294
loss_pred:0.02325257658958435, decouple_loss:0.010280970484018326
The generated pressure mean: 0.44740256667137146
loss_pred:0.02146046794950962, decouple_loss:0.009849113412201405
Iteration: 1593, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44841131567955017
loss_pred:0.023361114785075188, decouple_loss:0.010837881825864315
The generated pressure mean: 0.44896820187568665
The generated pressure mean: 0.44961491227149963loss_pred:0.022518254816532135, decouple_loss:0.010365849360823631
loss_pred:0.0211995430290699, decouple_loss:0.010831426829099655
Iteration: 1594, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4502754807472229
The generated pressure mean: 0.4482923150062561loss_pred:0.01924118399620056, decouple_loss:0.010225928388535976
loss_pred:0.021600332111120224, decouple_loss:0.009789243340492249
The generated pressure mean: 0.44864699244499207
loss_pred:0.02248046174645424, decouple_loss:0.01015458069741726
Iteration: 1595, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4467169940471649
loss_pred:0.021759826689958572, decouple_loss:0.010075647383928299
The generated pressure mean: 0.4491381049156189
loss_pred:0.021687660366296768, decouple_loss:0.0103610809892416
The generated pressure mean: 0.44815054535865784
loss_pred:0.025204738602042198, decouple_loss:0.010684196837246418
Iteration: 1596, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.448662668466568
loss_pred:0.02094961516559124, decouple_loss:0.010421107523143291
The generated pressure mean: 0.4478263854980469
loss_pred:0.022598883137106895, decouple_loss:0.01082486379891634
The generated pressure mean: 0.45012977719306946
loss_pred:0.020486634224653244, decouple_loss:0.010429449379444122
Iteration: 1597, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4489029347896576
loss_pred:0.021258661523461342, decouple_loss:0.00953699741512537
The generated pressure mean: 0.44820210337638855
loss_pred:0.02115510031580925, decouple_loss:0.010753737762570381
The generated pressure mean: 0.44850802421569824
loss_pred:0.024812649935483932, decouple_loss:0.010165851563215256
Iteration: 1598, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44645702838897705
loss_pred:0.022614698857069016, decouple_loss:0.010348503477871418
The generated pressure mean: 0.4472033679485321
loss_pred:0.022682368755340576, decouple_loss:0.010334783233702183
The generated pressure mean: 0.44911324977874756
loss_pred:0.022667760029435158, decouple_loss:0.010333853773772717
Iteration: 1599, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44816404581069946
loss_pred:0.023566322401165962, decouple_loss:0.010558277368545532
The generated pressure mean: 0.44841432571411133
loss_pred:0.02328726090490818, decouple_loss:0.010236961767077446
The generated pressure mean: 0.4498165547847748
loss_pred:0.021433500573039055, decouple_loss:0.010077730752527714
Iteration: 1600, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45066162943840027
loss_pred:0.020455900579690933, decouple_loss:0.010723729617893696
The generated pressure mean: 0.4485768675804138
loss_pred:0.020183291286230087, decouple_loss:0.010502910241484642
The generated pressure mean: 0.44881337881088257
loss_pred:0.021864747628569603, decouple_loss:0.010624672286212444
2023-04-16 07:50:09 testing...
The generated pressure mean: 0.4502691328525543
loss_pred:0.13737082481384277, decouple_loss:0.05486936494708061
The generated pressure mean: 0.45032569766044617
loss_pred:0.13643105328083038, decouple_loss:0.05478738993406296
The generated pressure mean: 0.45003050565719604
loss_pred:0.13728182017803192, decouple_loss:0.05436510220170021
Loss: 0.13976159691810608, avg_mse: 0.26869529485702515
current test mse: 0.268695
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012009_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012009_3_24hr.npz
NaN value num: 0
Iteration: 1601, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4500167667865753
loss_pred:0.024037441238760948, decouple_loss:0.010845637880265713
The generated pressure mean: 0.4487278461456299
loss_pred:0.021199623122811317, decouple_loss:0.011427059769630432
The generated pressure mean: 0.4494169056415558
loss_pred:0.020308339968323708, decouple_loss:0.010501007549464703
Iteration: 1602, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4496926963329315
loss_pred:0.023345746099948883, decouple_loss:0.01018590945750475
The generated pressure mean: 0.45009753108024597
loss_pred:0.02104450948536396, decouple_loss:0.010135487653315067
The generated pressure mean: 0.4492730498313904
loss_pred:0.020323162898421288, decouple_loss:0.01022558193653822
Iteration: 1603, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4503636658191681
The generated pressure mean: 0.44996193051338196
loss_pred:0.02289678528904915, decouple_loss:0.010989801026880741
The generated pressure mean: 0.44978034496307373
loss_pred:0.022403966635465622, decouple_loss:0.010650133714079857
loss_pred:0.021721884608268738, decouple_loss:0.010551126673817635
Iteration: 1604, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4501548409461975
The generated pressure mean: 0.44940251111984253
loss_pred:0.021348169073462486, decouple_loss:0.009880692698061466
loss_pred:0.021285677328705788, decouple_loss:0.00979860220104456
The generated pressure mean: 0.45098164677619934
loss_pred:0.0210748091340065, decouple_loss:0.009697097353637218
Iteration: 1605, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44830042123794556
loss_pred:0.021678747609257698, decouple_loss:0.010343758389353752
The generated pressure mean: 0.45039239525794983
loss_pred:0.022238649427890778, decouple_loss:0.010116017423570156
The generated pressure mean: 0.44846805930137634
loss_pred:0.02254357375204563, decouple_loss:0.010511611588299274
Iteration: 1606, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45032063126564026
loss_pred:0.020877517759799957, decouple_loss:0.00990185048431158
The generated pressure mean: 0.44821324944496155
loss_pred:0.021306907758116722, decouple_loss:0.009749381802976131
The generated pressure mean: 0.44897401332855225
loss_pred:0.0217666607350111, decouple_loss:0.009810698218643665
Iteration: 1607, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4479596018791199
The generated pressure mean: 0.44997283816337585
loss_pred:0.021758750081062317, decouple_loss:0.010642260313034058
loss_pred:0.02345551736652851, decouple_loss:0.010053778067231178
The generated pressure mean: 0.4485406279563904
loss_pred:0.021248122677206993, decouple_loss:0.010183798149228096
Iteration: 1608, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45072466135025024
loss_pred:0.02175999991595745, decouple_loss:0.0098415557295084
The generated pressure mean: 0.44868433475494385
loss_pred:0.021339531987905502, decouple_loss:0.0093688378110528
The generated pressure mean: 0.448442280292511
loss_pred:0.021534575149416924, decouple_loss:0.009729230776429176
Iteration: 1609, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44923076033592224
The generated pressure mean: 0.44706323742866516
loss_pred:0.02160138078033924, decouple_loss:0.010031620971858501
loss_pred:0.02190385013818741, decouple_loss:0.010115009732544422
The generated pressure mean: 0.4493301808834076
loss_pred:0.021439624950289726, decouple_loss:0.009903309866786003
Iteration: 1610, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44959312677383423
loss_pred:0.020653359591960907, decouple_loss:0.009868092834949493
The generated pressure mean: 0.45004671812057495
loss_pred:0.022355617955327034, decouple_loss:0.010124667547643185
The generated pressure mean: 0.44993409514427185
loss_pred:0.021714920178055763, decouple_loss:0.010274507105350494
2023-04-16 07:52:51 testing...
The generated pressure mean: 0.4502691626548767
loss_pred:0.13400931656360626, decouple_loss:0.0569026954472065
The generated pressure mean: 0.45032528042793274
loss_pred:0.13256441056728363, decouple_loss:0.05645419657230377
The generated pressure mean: 0.4500284790992737
loss_pred:0.1331852376461029, decouple_loss:0.056172724813222885
Loss: 0.13607849180698395, avg_mse: 0.25885117053985596
current test mse: 0.258851
Iteration: 1611, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44938230514526367
loss_pred:0.02126026153564453, decouple_loss:0.009891122579574585
The generated pressure mean: 0.4505554735660553
loss_pred:0.020672114565968513, decouple_loss:0.010074075311422348
The generated pressure mean: 0.449453741312027
loss_pred:0.0219652708619833, decouple_loss:0.010055970400571823
Iteration: 1612, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44815003871917725
loss_pred:0.020450377836823463, decouple_loss:0.01113711204379797
The generated pressure mean: 0.44984790682792664
loss_pred:0.0204016100615263, decouple_loss:0.009776914492249489
The generated pressure mean: 0.4478190541267395
loss_pred:0.023038724437355995, decouple_loss:0.010688334703445435
Iteration: 1613, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4490789771080017
loss_pred:0.021115463227033615, decouple_loss:0.010206975974142551
The generated pressure mean: 0.4483020007610321
loss_pred:0.02147434465587139, decouple_loss:0.009713971987366676
The generated pressure mean: 0.4504774212837219
loss_pred:0.023821715265512466, decouple_loss:0.009972570464015007
Iteration: 1614, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44905519485473633
loss_pred:0.023226305842399597, decouple_loss:0.009947015903890133
The generated pressure mean: 0.45072662830352783
loss_pred:0.02160073257982731, decouple_loss:0.009974748827517033
The generated pressure mean: 0.44719579815864563
loss_pred:0.02093265764415264, decouple_loss:0.01001216471195221
Iteration: 1615, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4489613473415375
loss_pred:0.020685041323304176, decouple_loss:0.009290952235460281
The generated pressure mean: 0.44965288043022156
loss_pred:0.021429600194096565, decouple_loss:0.009481807239353657
The generated pressure mean: 0.44912195205688477
loss_pred:0.02157662995159626, decouple_loss:0.009245420806109905
Iteration: 1616, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44846034049987793
loss_pred:0.020910000428557396, decouple_loss:0.00992225669324398
The generated pressure mean: 0.449931800365448
loss_pred:0.020723894238471985, decouple_loss:0.009919790551066399
The generated pressure mean: 0.4497363567352295
loss_pred:0.021474750712513924, decouple_loss:0.00992998480796814
Iteration: 1617, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.448682963848114
loss_pred:0.021331116557121277, decouple_loss:0.009485877119004726
The generated pressure mean: 0.4487093687057495
loss_pred:0.02208922617137432, decouple_loss:0.010094639845192432
The generated pressure mean: 0.44867023825645447
loss_pred:0.019966518506407738, decouple_loss:0.009449200704693794
Iteration: 1618, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4491032361984253
loss_pred:0.022898269817233086, decouple_loss:0.009450795128941536
The generated pressure mean: 0.4490366578102112
loss_pred:0.020672813057899475, decouple_loss:0.009889021515846252
The generated pressure mean: 0.4497060179710388
loss_pred:0.02088697999715805, decouple_loss:0.009833954274654388
Iteration: 1619, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4493214190006256
The generated pressure mean: 0.44913405179977417
loss_pred:0.02122417651116848, decouple_loss:0.009122872725129128loss_pred:0.02063625678420067, decouple_loss:0.009590397588908672
The generated pressure mean: 0.4507755637168884
loss_pred:0.02238457091152668, decouple_loss:0.00977648701518774
Iteration: 1620, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4495513439178467
loss_pred:0.02106555737555027, decouple_loss:0.009854968637228012
The generated pressure mean: 0.4494391977787018
loss_pred:0.02212335728108883, decouple_loss:0.010513014160096645
The generated pressure mean: 0.44968274235725403
loss_pred:0.022476479411125183, decouple_loss:0.009824260137975216
2023-04-16 07:54:57 testing...
The generated pressure mean: 0.4502691328525543
loss_pred:0.1333812177181244, decouple_loss:0.05534197762608528
The generated pressure mean: 0.45002686977386475
loss_pred:0.1330549269914627, decouple_loss:0.05483598634600639
The generated pressure mean: 0.45032593607902527
loss_pred:0.1320401281118393, decouple_loss:0.05521940439939499
Loss: 0.1355820596218109, avg_mse: 0.2589193880558014
current test mse: 0.258919
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012010_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012010_3_24hr.npz
NaN value num: 0
Iteration: 1621, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.449150949716568
loss_pred:0.0197711493819952, decouple_loss:0.01005591731518507
The generated pressure mean: 0.44730517268180847
loss_pred:0.0205613411962986, decouple_loss:0.01008912455290556
The generated pressure mean: 0.44809529185295105
loss_pred:0.021101316437125206, decouple_loss:0.01046523917466402
Iteration: 1622, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4470251500606537
loss_pred:0.021863341331481934, decouple_loss:0.009857493452727795
The generated pressure mean: 0.44777795672416687
loss_pred:0.023242808878421783, decouple_loss:0.00964458379894495
The generated pressure mean: 0.4479236602783203
loss_pred:0.020337939262390137, decouple_loss:0.009501797147095203
Iteration: 1623, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44897931814193726
loss_pred:0.020390095189213753, decouple_loss:0.009880632162094116
The generated pressure mean: 0.44724342226982117
loss_pred:0.021057380363345146, decouple_loss:0.010466309264302254
The generated pressure mean: 0.44821059703826904
loss_pred:0.021832343190908432, decouple_loss:0.009807491675019264
Iteration: 1624, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4475158154964447
loss_pred:0.021174583584070206, decouple_loss:0.009756249375641346
The generated pressure mean: 0.44747209548950195
loss_pred:0.021416952833533287, decouple_loss:0.009725891053676605
The generated pressure mean: 0.4471452534198761
loss_pred:0.021005194634199142, decouple_loss:0.009181804955005646
Iteration: 1625, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4486956000328064
The generated pressure mean: 0.4482852816581726loss_pred:0.02244279347360134, decouple_loss:0.011010433547198772
loss_pred:0.022189220413565636, decouple_loss:0.010467232204973698
The generated pressure mean: 0.4488990306854248
loss_pred:0.01938920095562935, decouple_loss:0.010371208190917969
Iteration: 1626, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44865962862968445
loss_pred:0.020837079733610153, decouple_loss:0.010274313390254974
The generated pressure mean: 0.4477946162223816
loss_pred:0.021294821053743362, decouple_loss:0.009915811009705067
The generated pressure mean: 0.44779735803604126
loss_pred:0.020394569262862206, decouple_loss:0.010280583053827286
Iteration: 1627, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44768014550209045
loss_pred:0.020906779915094376, decouple_loss:0.01065750326961279
The generated pressure mean: 0.44773316383361816
loss_pred:0.024085795506834984, decouple_loss:0.011165596544742584
The generated pressure mean: 0.44900399446487427
loss_pred:0.020528625696897507, decouple_loss:0.01040224451571703
Iteration: 1628, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4477177560329437
loss_pred:0.020609619095921516, decouple_loss:0.01109368447214365
The generated pressure mean: 0.448784738779068
loss_pred:0.02263217233121395, decouple_loss:0.010022263042628765
The generated pressure mean: 0.44861292839050293
loss_pred:0.021579694002866745, decouple_loss:0.010479982942342758
Iteration: 1629, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4487539231777191
loss_pred:0.020661497488617897, decouple_loss:0.011409806087613106
The generated pressure mean: 0.4492419958114624
loss_pred:0.020166130736470222, decouple_loss:0.011414275504648685
The generated pressure mean: 0.44768765568733215
loss_pred:0.01953832060098648, decouple_loss:0.010839063674211502
Iteration: 1630, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44934192299842834
loss_pred:0.020065950229763985, decouple_loss:0.010182274505496025
The generated pressure mean: 0.44848209619522095
loss_pred:0.02032313495874405, decouple_loss:0.010024093091487885
The generated pressure mean: 0.44798436760902405
loss_pred:0.022640323266386986, decouple_loss:0.010785178281366825
2023-04-16 07:57:56 testing...
The generated pressure mean: 0.4502691924571991
loss_pred:0.1335439682006836, decouple_loss:0.053138360381126404
The generated pressure mean: 0.4503258764743805
loss_pred:0.13185380399227142, decouple_loss:0.05293486639857292
The generated pressure mean: 0.45002952218055725
loss_pred:0.13253231346607208, decouple_loss:0.05275412276387215
Loss: 0.1352904886007309, avg_mse: 0.2560243308544159
current test mse: 0.256024
Iteration: 1631, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4477972090244293
loss_pred:0.02076134830713272, decouple_loss:0.010012851096689701
The generated pressure mean: 0.4481751322746277
loss_pred:0.02158215083181858, decouple_loss:0.010165484622120857
The generated pressure mean: 0.4497535526752472
loss_pred:0.021411525085568428, decouple_loss:0.010298166424036026
Iteration: 1632, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4486996829509735
loss_pred:0.02051139436662197, decouple_loss:0.010474685579538345
The generated pressure mean: 0.44862478971481323
loss_pred:0.020603016018867493, decouple_loss:0.010495317168533802
The generated pressure mean: 0.44950786232948303
loss_pred:0.02066565677523613, decouple_loss:0.010435682721436024
Iteration: 1633, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44839662313461304
loss_pred:0.021036271005868912, decouple_loss:0.009723045863211155
The generated pressure mean: 0.44804272055625916
loss_pred:0.02182910032570362, decouple_loss:0.010385368019342422
The generated pressure mean: 0.4485364258289337
loss_pred:0.019631292670965195, decouple_loss:0.009569652378559113
Iteration: 1634, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44809719920158386
The generated pressure mean: 0.4477553069591522
loss_pred:0.02300497516989708, decouple_loss:0.010092126205563545
loss_pred:0.021394621580839157, decouple_loss:0.009795105084776878
The generated pressure mean: 0.44858020544052124
loss_pred:0.02035411261022091, decouple_loss:0.009510181844234467
Iteration: 1635, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44906505942344666
loss_pred:0.019458109512925148, decouple_loss:0.009534976445138454
The generated pressure mean: 0.4490630030632019
loss_pred:0.022039908915758133, decouple_loss:0.00951955746859312
The generated pressure mean: 0.4488358795642853
loss_pred:0.020619569346308708, decouple_loss:0.009412058629095554
Iteration: 1636, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4483509957790375
loss_pred:0.020639032125473022, decouple_loss:0.009425482712686062
The generated pressure mean: 0.44780242443084717
loss_pred:0.020392723381519318, decouple_loss:0.00944175012409687
The generated pressure mean: 0.448091596364975
loss_pred:0.020058725029230118, decouple_loss:0.009089801460504532
Iteration: 1637, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44941917061805725
loss_pred:0.019748391583561897, decouple_loss:0.010095416568219662
The generated pressure mean: 0.44722071290016174
loss_pred:0.02134537138044834, decouple_loss:0.00964565109461546
The generated pressure mean: 0.4477456510066986
loss_pred:0.022397225722670555, decouple_loss:0.009651266038417816
Iteration: 1638, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4474721848964691
loss_pred:0.02062973752617836, decouple_loss:0.010113461874425411
The generated pressure mean: 0.44793128967285156
loss_pred:0.02162255346775055, decouple_loss:0.010248232632875443
The generated pressure mean: 0.448397696018219
loss_pred:0.020454730838537216, decouple_loss:0.009557416662573814
Iteration: 1639, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44743210077285767
loss_pred:0.021444328129291534, decouple_loss:0.009931597858667374
The generated pressure mean: 0.44756975769996643
loss_pred:0.022440334782004356, decouple_loss:0.009836825542151928
The generated pressure mean: 0.44870272278785706
loss_pred:0.019744599238038063, decouple_loss:0.010090542025864124
Iteration: 1640, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44839754700660706
loss_pred:0.02098245359957218, decouple_loss:0.010083954781293869
The generated pressure mean: 0.44833236932754517
loss_pred:0.02053476870059967, decouple_loss:0.009665986523032188
The generated pressure mean: 0.44785046577453613
loss_pred:0.02165430597960949, decouple_loss:0.009680052287876606
2023-04-16 08:00:02 testing...
The generated pressure mean: 0.4502691328525543
loss_pred:0.13377787172794342, decouple_loss:0.05317767336964607
The generated pressure mean: 0.45032426714897156
loss_pred:0.13182076811790466, decouple_loss:0.053008634597063065
The generated pressure mean: 0.4500311613082886
loss_pred:0.13270333409309387, decouple_loss:0.05252287909388542
Loss: 0.13541248440742493, avg_mse: 0.2571335732936859
current test mse: 0.257134
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012012_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012012_3_24hr.npz
NaN value num: 0
Iteration: 1641, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.447444349527359
loss_pred:0.02273723855614662, decouple_loss:0.009534085169434547
The generated pressure mean: 0.4465975761413574
loss_pred:0.02247491106390953, decouple_loss:0.009358013980090618
The generated pressure mean: 0.44939905405044556
loss_pred:0.02050284668803215, decouple_loss:0.009455395862460136
Iteration: 1642, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44768691062927246
loss_pred:0.020701002329587936, decouple_loss:0.009384004399180412
The generated pressure mean: 0.44748836755752563
The generated pressure mean: 0.44793152809143066
loss_pred:0.020935026928782463, decouple_loss:0.009111088700592518
loss_pred:0.021525900810956955, decouple_loss:0.009296935051679611
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1643, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44727715849876404
loss_pred:0.020868992432951927, decouple_loss:0.009810207411646843
The generated pressure mean: 0.4474392831325531
loss_pred:0.021788684651255608, decouple_loss:0.009826496243476868
The generated pressure mean: 0.44776955246925354
loss_pred:0.020550426095724106, decouple_loss:0.009692770428955555
Iteration: 1644, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44855597615242004
loss_pred:0.021175658330321312, decouple_loss:0.010636371560394764
The generated pressure mean: 0.4477998614311218
loss_pred:0.020116597414016724, decouple_loss:0.010173632763326168
The generated pressure mean: 0.4479251801967621
loss_pred:0.02177605591714382, decouple_loss:0.01054018922150135
Iteration: 1645, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4476274251937866
loss_pred:0.021155206486582756, decouple_loss:0.0098954439163208
The generated pressure mean: 0.447094589471817
loss_pred:0.021075528115034103, decouple_loss:0.009940331801772118
The generated pressure mean: 0.4474830627441406
loss_pred:0.02129918709397316, decouple_loss:0.009498496539890766
Iteration: 1646, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44765153527259827
loss_pred:0.020899835973978043, decouple_loss:0.009128973819315434
The generated pressure mean: 0.447112500667572
loss_pred:0.02112550660967827, decouple_loss:0.009462296962738037
The generated pressure mean: 0.4474130868911743
loss_pred:0.021542703732848167, decouple_loss:0.009615007787942886
Iteration: 1647, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4480847418308258
loss_pred:0.020314957946538925, decouple_loss:0.00909766461700201
The generated pressure mean: 0.4483968913555145
loss_pred:0.02151128649711609, decouple_loss:0.009228739887475967
The generated pressure mean: 0.4467446506023407
loss_pred:0.021945053711533546, decouple_loss:0.009112524800002575
Iteration: 1648, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44859549403190613
loss_pred:0.020643096417188644, decouple_loss:0.00966433621942997
The generated pressure mean: 0.4476560950279236
loss_pred:0.019906753674149513, decouple_loss:0.009438336826860905
The generated pressure mean: 0.4473743438720703
loss_pred:0.021790923550724983, decouple_loss:0.00987589918076992
Iteration: 1649, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44822096824645996
loss_pred:0.022273879498243332, decouple_loss:0.010999174788594246
The generated pressure mean: 0.4481629431247711
loss_pred:0.021706195548176765, decouple_loss:0.010558565147221088
The generated pressure mean: 0.44753509759902954
loss_pred:0.020337846130132675, decouple_loss:0.01048365980386734
Iteration: 1650, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.447462260723114
loss_pred:0.023029761388897896, decouple_loss:0.00974203273653984
The generated pressure mean: 0.4465577006340027
loss_pred:0.023983726277947426, decouple_loss:0.010113422758877277
The generated pressure mean: 0.4483845829963684
loss_pred:0.020962947979569435, decouple_loss:0.009786637499928474
2023-04-16 08:02:42 testing...
The generated pressure mean: 0.4502691328525543
loss_pred:0.13409684598445892, decouple_loss:0.05111352726817131
The generated pressure mean: 0.45032545924186707
loss_pred:0.13197863101959229, decouple_loss:0.0517122782766819
The generated pressure mean: 0.45003005862236023
loss_pred:0.13286133110523224, decouple_loss:0.05109863355755806
Loss: 0.13554435968399048, avg_mse: 0.25781330466270447
current test mse: 0.257813
Iteration: 1651, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44715920090675354
loss_pred:0.021417729556560516, decouple_loss:0.010035592131316662
The generated pressure mean: 0.4466160237789154
loss_pred:0.019829070195555687, decouple_loss:0.009823206812143326
The generated pressure mean: 0.4475603401660919
loss_pred:0.021141810342669487, decouple_loss:0.00985708273947239
Iteration: 1652, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4482909142971039
loss_pred:0.02097971737384796, decouple_loss:0.010832966305315495
The generated pressure mean: 0.4466734230518341
loss_pred:0.021613651886582375, decouple_loss:0.01021081767976284
The generated pressure mean: 0.4468730390071869
loss_pred:0.020546194165945053, decouple_loss:0.010294533334672451
Iteration: 1653, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44775184988975525
loss_pred:0.021189849823713303, decouple_loss:0.009739972651004791
The generated pressure mean: 0.44766584038734436
loss_pred:0.020394841209053993, decouple_loss:0.010007943026721478
The generated pressure mean: 0.447335809469223
loss_pred:0.020182179287075996, decouple_loss:0.00952083058655262
Iteration: 1654, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44701728224754333
loss_pred:0.022774891927838326, decouple_loss:0.0094328373670578
The generated pressure mean: 0.4476791322231293
loss_pred:0.020528877153992653, decouple_loss:0.009593795984983444
The generated pressure mean: 0.4486589729785919
loss_pred:0.02140783704817295, decouple_loss:0.00957114715129137
Iteration: 1655, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44782087206840515
loss_pred:0.01944117620587349, decouple_loss:0.010018819943070412
The generated pressure mean: 0.4464260935783386
loss_pred:0.02103954553604126, decouple_loss:0.009873651899397373
The generated pressure mean: 0.4474366307258606
loss_pred:0.022639382630586624, decouple_loss:0.009785603731870651
Iteration: 1656, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4468247890472412
loss_pred:0.021414732560515404, decouple_loss:0.010699398815631866
The generated pressure mean: 0.4475296437740326
loss_pred:0.02061218023300171, decouple_loss:0.01095517072826624
The generated pressure mean: 0.4467145502567291
loss_pred:0.021110346540808678, decouple_loss:0.010154721327126026
Iteration: 1657, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44866353273391724
loss_pred:0.021919678896665573, decouple_loss:0.010500507429242134
The generated pressure mean: 0.4475450813770294
loss_pred:0.021098125725984573, decouple_loss:0.009994766674935818
The generated pressure mean: 0.44660958647727966
loss_pred:0.020649828016757965, decouple_loss:0.010092252865433693
Iteration: 1658, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4466375708580017
loss_pred:0.021565580740571022, decouple_loss:0.009409460239112377
The generated pressure mean: 0.4479125440120697
loss_pred:0.019892727956175804, decouple_loss:0.009162702597677708
The generated pressure mean: 0.44758981466293335
loss_pred:0.01979818195104599, decouple_loss:0.009177795611321926
Iteration: 1659, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44899603724479675
loss_pred:0.02000889927148819, decouple_loss:0.009103726595640182
The generated pressure mean: 0.44842633605003357
loss_pred:0.021367499604821205, decouple_loss:0.009271170012652874
The generated pressure mean: 0.4471164345741272
loss_pred:0.019962303340435028, decouple_loss:0.009365511126816273
Iteration: 1660, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44733551144599915
loss_pred:0.022303955629467964, decouple_loss:0.009361803531646729
The generated pressure mean: 0.44789689779281616
loss_pred:0.021525230258703232, decouple_loss:0.00934106856584549
The generated pressure mean: 0.44728052616119385
loss_pred:0.021382756531238556, decouple_loss:0.009621014818549156
2023-04-16 08:04:48 testing...
The generated pressure mean: 0.4502691626548767
loss_pred:0.13445203006267548, decouple_loss:0.05299118533730507
The generated pressure mean: 0.45032721757888794
loss_pred:0.13246487081050873, decouple_loss:0.053644951432943344
The generated pressure mean: 0.45003071427345276
loss_pred:0.13357363641262054, decouple_loss:0.052664078772068024
Loss: 0.13615185022354126, avg_mse: 0.2597372829914093
current test mse: 0.259737
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012015_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012015_3_24hr.npz
NaN value num: 0
Iteration: 1661, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44856223464012146
loss_pred:0.021557042375206947, decouple_loss:0.010216782800853252
The generated pressure mean: 0.4477379322052002
loss_pred:0.020518502220511436, decouple_loss:0.009968101046979427
The generated pressure mean: 0.4479861259460449
loss_pred:0.020507337525486946, decouple_loss:0.010699518024921417
Iteration: 1662, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4499446153640747
loss_pred:0.021052023395895958, decouple_loss:0.010837958194315434
The generated pressure mean: 0.44821563363075256
The generated pressure mean: 0.4482773542404175
loss_pred:0.021685922518372536, decouple_loss:0.010141493752598763
loss_pred:0.023116663098335266, decouple_loss:0.010622531175613403
Iteration: 1663, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44773614406585693
loss_pred:0.024600770324468613, decouple_loss:0.010111432522535324
The generated pressure mean: 0.448761910200119
loss_pred:0.02121558040380478, decouple_loss:0.010079880245029926
The generated pressure mean: 0.4483649432659149
loss_pred:0.021819183602929115, decouple_loss:0.010880811139941216
Iteration: 1664, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4486047327518463
The generated pressure mean: 0.44832485914230347
loss_pred:0.02017846144735813, decouple_loss:0.01086325291544199
loss_pred:0.02088926173746586, decouple_loss:0.010896114632487297
The generated pressure mean: 0.4469325542449951
loss_pred:0.02115352638065815, decouple_loss:0.010138467885553837
Iteration: 1665, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44959697127342224
The generated pressure mean: 0.44912853837013245
loss_pred:0.02191624790430069, decouple_loss:0.01099052932113409
loss_pred:0.020753391087055206, decouple_loss:0.009977427311241627
The generated pressure mean: 0.44931015372276306
loss_pred:0.021887313574552536, decouple_loss:0.010853143408894539
Iteration: 1666, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44853654503822327
loss_pred:0.021261485293507576, decouple_loss:0.010227343998849392
The generated pressure mean: 0.44952887296676636
loss_pred:0.02212660014629364, decouple_loss:0.009395407512784004
The generated pressure mean: 0.4478970766067505
loss_pred:0.023396847769618034, decouple_loss:0.009348762221634388
Iteration: 1667, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4494002163410187
loss_pred:0.022169239819049835, decouple_loss:0.011595032177865505
The generated pressure mean: 0.4478186368942261
loss_pred:0.021631253883242607, decouple_loss:0.011609046719968319
The generated pressure mean: 0.4496093988418579
loss_pred:0.022608429193496704, decouple_loss:0.011344452388584614
Iteration: 1668, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4480411112308502
loss_pred:0.022914670407772064, decouple_loss:0.00916524138301611
The generated pressure mean: 0.44883233308792114
loss_pred:0.02328619174659252, decouple_loss:0.00940277986228466
The generated pressure mean: 0.4483625590801239
loss_pred:0.02044050022959709, decouple_loss:0.009230853989720345
Iteration: 1669, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44653311371803284
loss_pred:0.021336056292057037, decouple_loss:0.010213957168161869
The generated pressure mean: 0.4488533139228821
loss_pred:0.02136162295937538, decouple_loss:0.009884563274681568
The generated pressure mean: 0.44896256923675537
loss_pred:0.02140725404024124, decouple_loss:0.009568603709340096
Iteration: 1670, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44809481501579285
loss_pred:0.020999323576688766, decouple_loss:0.011150403879582882
The generated pressure mean: 0.44917982816696167
loss_pred:0.02282458357512951, decouple_loss:0.011264486238360405
The generated pressure mean: 0.44856327772140503
loss_pred:0.021044515073299408, decouple_loss:0.0116892633959651
2023-04-16 08:07:37 testing...
The generated pressure mean: 0.4502691924571991
loss_pred:0.13978233933448792, decouple_loss:0.05736512318253517
The generated pressure mean: 0.450323224067688
loss_pred:0.13747309148311615, decouple_loss:0.05726117640733719
The generated pressure mean: 0.45003020763397217
loss_pred:0.13854366540908813, decouple_loss:0.056940264999866486
Loss: 0.1414591521024704, avg_mse: 0.26912057399749756
current test mse: 0.269121
Iteration: 1671, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44772598147392273
loss_pred:0.019956247881054878, decouple_loss:0.01005738414824009
The generated pressure mean: 0.44775882363319397
loss_pred:0.019703349098563194, decouple_loss:0.010104110464453697
The generated pressure mean: 0.44901275634765625
loss_pred:0.020856214687228203, decouple_loss:0.010086587630212307
Iteration: 1672, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4491497278213501
loss_pred:0.020604349672794342, decouple_loss:0.01013723574578762
The generated pressure mean: 0.449043869972229
loss_pred:0.022233624011278152, decouple_loss:0.009832514449954033
The generated pressure mean: 0.44898903369903564
loss_pred:0.023159688338637352, decouple_loss:0.009795895777642727
Iteration: 1673, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44803401827812195
loss_pred:0.021317096427083015, decouple_loss:0.010931309312582016
The generated pressure mean: 0.4476751387119293
loss_pred:0.02162330225110054, decouple_loss:0.010683635249733925
The generated pressure mean: 0.4480416178703308
loss_pred:0.020529048517346382, decouple_loss:0.01107645221054554
Iteration: 1674, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4489303231239319
loss_pred:0.020707687363028526, decouple_loss:0.01004709955304861
The generated pressure mean: 0.44624054431915283
loss_pred:0.021818436682224274, decouple_loss:0.01014152355492115
The generated pressure mean: 0.44813618063926697
loss_pred:0.020076802000403404, decouple_loss:0.009724480099976063
Iteration: 1675, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4477715492248535
loss_pred:0.020869702100753784, decouple_loss:0.009546998888254166
The generated pressure mean: 0.4487802982330322
loss_pred:0.019824989140033722, decouple_loss:0.009358799085021019
The generated pressure mean: 0.4490354359149933
loss_pred:0.021000664681196213, decouple_loss:0.009320669807493687
Iteration: 1676, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4481946527957916
loss_pred:0.022241326048970222, decouple_loss:0.010166632011532784
The generated pressure mean: 0.448133260011673
loss_pred:0.02117099054157734, decouple_loss:0.010176791809499264
The generated pressure mean: 0.4459352195262909
loss_pred:0.022502684965729713, decouple_loss:0.010470741428434849
Iteration: 1677, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44851183891296387
The generated pressure mean: 0.4474709928035736
loss_pred:0.020698942244052887, decouple_loss:0.011246451176702976
loss_pred:0.022649919614195824, decouple_loss:0.011253242380917072
The generated pressure mean: 0.44654732942581177
loss_pred:0.020579935982823372, decouple_loss:0.010799658484756947
Iteration: 1678, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44786447286605835
loss_pred:0.021218517795205116, decouple_loss:0.00978550873696804
The generated pressure mean: 0.4469878673553467
loss_pred:0.021233782172203064, decouple_loss:0.009901437908411026
The generated pressure mean: 0.4495350420475006
loss_pred:0.02107534557580948, decouple_loss:0.0110505735501647
Iteration: 1679, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44875797629356384
loss_pred:0.020511476323008537, decouple_loss:0.010754909366369247
The generated pressure mean: 0.4497697353363037
loss_pred:0.021414516493678093, decouple_loss:0.011393827386200428
The generated pressure mean: 0.44879236817359924
loss_pred:0.0216529481112957, decouple_loss:0.010910939425230026
Iteration: 1680, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44654548168182373
loss_pred:0.021879570558667183, decouple_loss:0.011377234011888504
The generated pressure mean: 0.44860216975212097
loss_pred:0.02123459056019783, decouple_loss:0.011226070113480091
The generated pressure mean: 0.44687986373901367
loss_pred:0.021757042035460472, decouple_loss:0.01164205465465784
2023-04-16 08:09:42 testing...
The generated pressure mean: 0.4502691924571991
loss_pred:0.1419813483953476, decouple_loss:0.0565127395093441
The generated pressure mean: 0.4500265419483185
loss_pred:0.1410760134458542, decouple_loss:0.05617523193359375
The generated pressure mean: 0.45032259821891785
loss_pred:0.1402192860841751, decouple_loss:0.056930337101221085
Loss: 0.1439191997051239, avg_mse: 0.27576956152915955
current test mse: 0.27577
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012019_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012019_3_24hr.npz
NaN value num: 0
Iteration: 1681, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4502469301223755
loss_pred:0.021691426634788513, decouple_loss:0.010020092129707336
The generated pressure mean: 0.4493144750595093
loss_pred:0.01957467570900917, decouple_loss:0.010398452170193195
The generated pressure mean: 0.4486033320426941
loss_pred:0.020267413929104805, decouple_loss:0.010380572639405727
Iteration: 1682, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4508032202720642
loss_pred:0.021129118278622627, decouple_loss:0.010713553056120872
The generated pressure mean: 0.4500076174736023
loss_pred:0.021359462291002274, decouple_loss:0.009882025420665741
The generated pressure mean: 0.45005977153778076
loss_pred:0.020492762327194214, decouple_loss:0.009831344708800316
Iteration: 1683, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44984859228134155
loss_pred:0.02088874764740467, decouple_loss:0.010714489966630936
The generated pressure mean: 0.4494919180870056
loss_pred:0.022213442251086235, decouple_loss:0.011015285737812519
The generated pressure mean: 0.4489465355873108
loss_pred:0.021458720788359642, decouple_loss:0.010102112777531147
Iteration: 1684, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4485466182231903
loss_pred:0.020720750093460083, decouple_loss:0.010138383135199547
The generated pressure mean: 0.4507611393928528
loss_pred:0.02167476899921894, decouple_loss:0.010102341882884502
The generated pressure mean: 0.4512367248535156
loss_pred:0.020538028329610825, decouple_loss:0.009728270582854748
Iteration: 1685, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44896748661994934
loss_pred:0.02071084827184677, decouple_loss:0.010096064768731594
The generated pressure mean: 0.4506447911262512
loss_pred:0.019704898819327354, decouple_loss:0.00988217443227768
The generated pressure mean: 0.4496917426586151
loss_pred:0.021836327388882637, decouple_loss:0.009954131208360195
Iteration: 1686, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4494347870349884
loss_pred:0.02183232270181179, decouple_loss:0.011396573856472969
The generated pressure mean: 0.4496116638183594
loss_pred:0.01945641078054905, decouple_loss:0.011329231783747673
The generated pressure mean: 0.4496022164821625
loss_pred:0.020289670675992966, decouple_loss:0.011428761295974255
Iteration: 1687, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45069801807403564
loss_pred:0.022564666345715523, decouple_loss:0.009231549687683582
The generated pressure mean: 0.44993579387664795
loss_pred:0.020935332402586937, decouple_loss:0.009393078275024891
The generated pressure mean: 0.4498608112335205
loss_pred:0.021937813609838486, decouple_loss:0.009244468063116074
Iteration: 1688, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4509596824645996
loss_pred:0.02135971188545227, decouple_loss:0.010427462868392467
The generated pressure mean: 0.45086970925331116
loss_pred:0.0201090257614851, decouple_loss:0.01104310154914856
The generated pressure mean: 0.45035359263420105
loss_pred:0.020830748602747917, decouple_loss:0.01072598248720169
Iteration: 1689, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4491613805294037
The generated pressure mean: 0.44975799322128296
loss_pred:0.02085069939494133, decouple_loss:0.011554060503840446
loss_pred:0.02130191959440708, decouple_loss:0.011133394204080105
The generated pressure mean: 0.4502298831939697
loss_pred:0.01995173469185829, decouple_loss:0.011109612882137299
Iteration: 1690, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4498116970062256
loss_pred:0.02088243141770363, decouple_loss:0.010150867514312267
The generated pressure mean: 0.4498405158519745
loss_pred:0.019307022914290428, decouple_loss:0.010128085501492023
The generated pressure mean: 0.44984444975852966
loss_pred:0.021392833441495895, decouple_loss:0.010748331435024738
2023-04-16 08:12:25 testing...
The generated pressure mean: 0.4502691626548767
loss_pred:0.1388102024793625, decouple_loss:0.05723030865192413
The generated pressure mean: 0.45032161474227905
loss_pred:0.137192964553833, decouple_loss:0.05727222561836243
The generated pressure mean: 0.4500294327735901
loss_pred:0.13801251351833344, decouple_loss:0.0566229410469532
Loss: 0.14085732400417328, avg_mse: 0.2700788378715515
current test mse: 0.270079
Iteration: 1691, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45115959644317627
loss_pred:0.02090548537671566, decouple_loss:0.010502963326871395
The generated pressure mean: 0.44943252205848694
loss_pred:0.020686469972133636, decouple_loss:0.011024808511137962
The generated pressure mean: 0.4502246379852295
loss_pred:0.022165246307849884, decouple_loss:0.010842310264706612
Iteration: 1692, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4494004547595978
loss_pred:0.022872231900691986, decouple_loss:0.010503008961677551
The generated pressure mean: 0.4503611922264099
loss_pred:0.020832423120737076, decouple_loss:0.010984917171299458
The generated pressure mean: 0.4502659738063812
loss_pred:0.021462950855493546, decouple_loss:0.010765885934233665
Iteration: 1693, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44951319694519043
loss_pred:0.021826932206749916, decouple_loss:0.010215727612376213
The generated pressure mean: 0.4513983428478241
loss_pred:0.02041434869170189, decouple_loss:0.01113291084766388
The generated pressure mean: 0.4488001763820648
loss_pred:0.022428791970014572, decouple_loss:0.010450049303472042
Iteration: 1694, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4486059546470642
The generated pressure mean: 0.44977062940597534
loss_pred:0.019737357273697853, decouple_loss:0.010749748907983303
loss_pred:0.020091019570827484, decouple_loss:0.010624818503856659
The generated pressure mean: 0.44863152503967285
loss_pred:0.02143067680299282, decouple_loss:0.010458026081323624
Iteration: 1695, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44985973834991455
The generated pressure mean: 0.44976985454559326
loss_pred:0.02126036398112774, decouple_loss:0.01091847475618124
loss_pred:0.022197827696800232, decouple_loss:0.011318706907331944
The generated pressure mean: 0.4513835608959198
loss_pred:0.020289773121476173, decouple_loss:0.011496865190565586
Iteration: 1696, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45068392157554626
loss_pred:0.019970284774899483, decouple_loss:0.010007711127400398
The generated pressure mean: 0.4507124423980713
loss_pred:0.02106146514415741, decouple_loss:0.01015718374401331
The generated pressure mean: 0.4504104554653168
loss_pred:0.02041299268603325, decouple_loss:0.01003484521061182
Iteration: 1697, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45148006081581116
loss_pred:0.020071284845471382, decouple_loss:0.0101108867675066
The generated pressure mean: 0.4489428400993347
loss_pred:0.020946824923157692, decouple_loss:0.010517247952520847
The generated pressure mean: 0.4492053985595703
loss_pred:0.020854303613305092, decouple_loss:0.010267790406942368
Iteration: 1698, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4500479996204376
loss_pred:0.019940348342061043, decouple_loss:0.010476996190845966
The generated pressure mean: 0.44977691769599915
loss_pred:0.021058009937405586, decouple_loss:0.010172240436077118
The generated pressure mean: 0.44903919100761414
loss_pred:0.020352724939584732, decouple_loss:0.010071828961372375
Iteration: 1699, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4482322037220001
loss_pred:0.021229451522231102, decouple_loss:0.010072953067719936
The generated pressure mean: 0.45026695728302
loss_pred:0.020919719710946083, decouple_loss:0.010526427067816257
The generated pressure mean: 0.4495840072631836
loss_pred:0.02021710015833378, decouple_loss:0.010398450307548046
Iteration: 1700, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45057716965675354
loss_pred:0.020863626152276993, decouple_loss:0.010637400671839714
The generated pressure mean: 0.4491812586784363
loss_pred:0.021732160821557045, decouple_loss:0.01035917829722166
The generated pressure mean: 0.4490867257118225
loss_pred:0.020862748846411705, decouple_loss:0.01010326761752367
2023-04-16 08:14:31 testing...
The generated pressure mean: 0.4502691626548767
loss_pred:0.14317356050014496, decouple_loss:0.05727747827768326
The generated pressure mean: 0.45032578706741333
loss_pred:0.14195643365383148, decouple_loss:0.05755492299795151
The generated pressure mean: 0.45002827048301697
loss_pred:0.1429901123046875, decouple_loss:0.05685994401574135
Loss: 0.14556825160980225, avg_mse: 0.28019532561302185
current test mse: 0.280195
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012013_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012013_3_24hr.npz
NaN value num: 0
Iteration: 1701, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4491109549999237
loss_pred:0.020781250670552254, decouple_loss:0.009588420391082764
The generated pressure mean: 0.4484735429286957
loss_pred:0.020044634118676186, decouple_loss:0.009490245953202248
The generated pressure mean: 0.4480007290840149
loss_pred:0.020578542724251747, decouple_loss:0.009352416731417179
Iteration: 1702, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44808170199394226
loss_pred:0.019206076860427856, decouple_loss:0.009879213757812977
The generated pressure mean: 0.44741472601890564
The generated pressure mean: 0.4484201967716217
loss_pred:0.0221721138805151, decouple_loss:0.01063316036015749
loss_pred:0.020485002547502518, decouple_loss:0.009648757055401802
Iteration: 1703, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4476623833179474
loss_pred:0.022157343104481697, decouple_loss:0.009885787963867188
The generated pressure mean: 0.44684481620788574
loss_pred:0.021889809519052505, decouple_loss:0.010083900764584541
The generated pressure mean: 0.4492776691913605
loss_pred:0.019588248804211617, decouple_loss:0.009406326338648796
Iteration: 1704, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4479829668998718
loss_pred:0.018533913418650627, decouple_loss:0.009653894230723381
The generated pressure mean: 0.447895884513855
loss_pred:0.02033432014286518, decouple_loss:0.009500072337687016
The generated pressure mean: 0.4468580186367035
loss_pred:0.020255276933312416, decouple_loss:0.009296010248363018
Iteration: 1705, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44781383872032166
loss_pred:0.02110994979739189, decouple_loss:0.009511010721325874
The generated pressure mean: 0.44856616854667664
loss_pred:0.020816883072257042, decouple_loss:0.009876509197056293
The generated pressure mean: 0.4470886290073395
loss_pred:0.019741756841540337, decouple_loss:0.009279439225792885
Iteration: 1706, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44709575176239014
loss_pred:0.020941508933901787, decouple_loss:0.009456525556743145
The generated pressure mean: 0.4468696415424347
loss_pred:0.02046826481819153, decouple_loss:0.009315491653978825
The generated pressure mean: 0.44856908917427063
loss_pred:0.019683800637722015, decouple_loss:0.009040473029017448
Iteration: 1707, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4472745358943939
loss_pred:0.020950952544808388, decouple_loss:0.009323624894022942
The generated pressure mean: 0.44804492592811584
loss_pred:0.021394895389676094, decouple_loss:0.009482544846832752
The generated pressure mean: 0.44735249876976013
loss_pred:0.021286381408572197, decouple_loss:0.00982012040913105
Iteration: 1708, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44834208488464355
The generated pressure mean: 0.44778478145599365
loss_pred:0.02067006379365921, decouple_loss:0.010538751259446144
loss_pred:0.021163007244467735, decouple_loss:0.009206165559589863
The generated pressure mean: 0.44865870475769043
loss_pred:0.019544174894690514, decouple_loss:0.010109652765095234
Iteration: 1709, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44802042841911316
loss_pred:0.019507739692926407, decouple_loss:0.009226336143910885
The generated pressure mean: 0.44862082600593567
loss_pred:0.0217276718467474, decouple_loss:0.00968903861939907
The generated pressure mean: 0.4482043981552124
loss_pred:0.021487129852175713, decouple_loss:0.009541611187160015
Iteration: 1710, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44905614852905273
loss_pred:0.02022804692387581, decouple_loss:0.00879322923719883
The generated pressure mean: 0.4485723078250885
loss_pred:0.019831739366054535, decouple_loss:0.00883312989026308
The generated pressure mean: 0.44749826192855835
loss_pred:0.020856106653809547, decouple_loss:0.008778266608715057
2023-04-16 08:17:22 testing...
The generated pressure mean: 0.4502691328525543
loss_pred:0.14016802608966827, decouple_loss:0.05470455437898636
The generated pressure mean: 0.450327068567276
loss_pred:0.13829874992370605, decouple_loss:0.05486027151346207
The generated pressure mean: 0.45002877712249756
loss_pred:0.13985879719257355, decouple_loss:0.05448724702000618
Loss: 0.1421760618686676, avg_mse: 0.2728676497936249
current test mse: 0.272868
Iteration: 1711, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4484712481498718
loss_pred:0.020720284432172775, decouple_loss:0.009174859151244164
The generated pressure mean: 0.4487644135951996
loss_pred:0.019552532583475113, decouple_loss:0.00993257388472557
The generated pressure mean: 0.44935354590415955
loss_pred:0.020793111994862556, decouple_loss:0.008916410617530346
Iteration: 1712, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4480402171611786
loss_pred:0.020493153482675552, decouple_loss:0.009483317844569683
The generated pressure mean: 0.44768744707107544
loss_pred:0.02113807387650013, decouple_loss:0.009573258459568024
The generated pressure mean: 0.44845500588417053
loss_pred:0.020578788593411446, decouple_loss:0.009440694004297256
Iteration: 1713, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4472927153110504
loss_pred:0.021810028702020645, decouple_loss:0.009554373100399971
The generated pressure mean: 0.44803160429000854
loss_pred:0.021726049482822418, decouple_loss:0.009517436847090721
The generated pressure mean: 0.44836458563804626
loss_pred:0.021070409566164017, decouple_loss:0.009649835526943207
Iteration: 1714, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44788479804992676The generated pressure mean: 0.4478446841239929
loss_pred:0.021978730335831642, decouple_loss:0.009169584140181541loss_pred:0.020202718675136566, decouple_loss:0.008923687972128391
The generated pressure mean: 0.44810187816619873
loss_pred:0.020053694024682045, decouple_loss:0.008888063952326775
Iteration: 1715, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4471232295036316
loss_pred:0.021375030279159546, decouple_loss:0.008417111821472645
The generated pressure mean: 0.4472019076347351
loss_pred:0.02113247849047184, decouple_loss:0.00850586500018835
The generated pressure mean: 0.44766008853912354
loss_pred:0.02091457135975361, decouple_loss:0.00860248040407896
Iteration: 1716, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44933655858039856
loss_pred:0.02154403179883957, decouple_loss:0.00942949391901493
The generated pressure mean: 0.4494900107383728
loss_pred:0.020695466548204422, decouple_loss:0.009526426903903484
The generated pressure mean: 0.4483294188976288
loss_pred:0.020316220819950104, decouple_loss:0.009301568381488323
Iteration: 1717, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4474957585334778
loss_pred:0.02056169882416725, decouple_loss:0.00928534660488367
The generated pressure mean: 0.448710173368454
loss_pred:0.02178194373846054, decouple_loss:0.009564338251948357
The generated pressure mean: 0.44748738408088684
loss_pred:0.0207335464656353, decouple_loss:0.010047262534499168
Iteration: 1718, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4489630162715912
loss_pred:0.020002156496047974, decouple_loss:0.008782470598816872
The generated pressure mean: 0.4476677179336548
loss_pred:0.02143198437988758, decouple_loss:0.008592505939304829
The generated pressure mean: 0.44887280464172363
loss_pred:0.018609169870615005, decouple_loss:0.00929679349064827
Iteration: 1719, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4477456212043762
The generated pressure mean: 0.4476199448108673loss_pred:0.0205122958868742, decouple_loss:0.008591175079345703
loss_pred:0.02060503326356411, decouple_loss:0.008283381350338459
The generated pressure mean: 0.4494662880897522
loss_pred:0.020391354337334633, decouple_loss:0.008317334577441216
Iteration: 1720, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44739001989364624
loss_pred:0.02101365476846695, decouple_loss:0.008286706171929836
The generated pressure mean: 0.4487363398075104
loss_pred:0.020582865923643112, decouple_loss:0.008432500064373016
The generated pressure mean: 0.44783180952072144
loss_pred:0.019433144479990005, decouple_loss:0.008134210482239723
2023-04-16 08:19:28 testing...
The generated pressure mean: 0.4502691328525543
loss_pred:0.14011000096797943, decouple_loss:0.054677605628967285
The generated pressure mean: 0.45032358169555664
loss_pred:0.13860253989696503, decouple_loss:0.054701779037714005
The generated pressure mean: 0.45003318786621094
loss_pred:0.13934023678302765, decouple_loss:0.054082248359918594
Loss: 0.1420753002166748, avg_mse: 0.2742704153060913
current test mse: 0.27427
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012017_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012017_3_24hr.npz
NaN value num: 0
Iteration: 1721, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4484306871891022
loss_pred:0.01945406012237072, decouple_loss:0.009712368249893188
The generated pressure mean: 0.4471445083618164
loss_pred:0.021488448604941368, decouple_loss:0.009973645210266113
The generated pressure mean: 0.44902047514915466
loss_pred:0.02073146216571331, decouple_loss:0.009181752800941467
Iteration: 1722, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44840365648269653
loss_pred:0.020962566137313843, decouple_loss:0.00888644065707922
The generated pressure mean: 0.4467407763004303
loss_pred:0.02116311714053154, decouple_loss:0.008902844972908497
The generated pressure mean: 0.4487798810005188
loss_pred:0.02086162567138672, decouple_loss:0.00895948801189661
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1723, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44803741574287415
loss_pred:0.022818632423877716, decouple_loss:0.008965588174760342
The generated pressure mean: 0.44881322979927063
loss_pred:0.020142676308751106, decouple_loss:0.00897971447557211
The generated pressure mean: 0.4485827088356018
loss_pred:0.019248386844992638, decouple_loss:0.009197394363582134
Iteration: 1724, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4485510289669037
loss_pred:0.01950409822165966, decouple_loss:0.008316747844219208
The generated pressure mean: 0.44920697808265686
loss_pred:0.02104506641626358, decouple_loss:0.00862086284905672
The generated pressure mean: 0.44832444190979004
loss_pred:0.0206855908036232, decouple_loss:0.008611207827925682
Iteration: 1725, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4481949508190155
loss_pred:0.02106364257633686, decouple_loss:0.008925646543502808
The generated pressure mean: 0.4484867751598358
loss_pred:0.01990172266960144, decouple_loss:0.008992107585072517
The generated pressure mean: 0.44842931628227234
loss_pred:0.021577054634690285, decouple_loss:0.008553405292332172
Iteration: 1726, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4480271339416504
The generated pressure mean: 0.4475766122341156loss_pred:0.02072407677769661, decouple_loss:0.008452348411083221
loss_pred:0.021325722336769104, decouple_loss:0.008800252340734005
The generated pressure mean: 0.44838404655456543
loss_pred:0.022229375317692757, decouple_loss:0.008420384488999844
Iteration: 1727, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44810014963150024
loss_pred:0.021161993965506554, decouple_loss:0.008947440423071384
The generated pressure mean: 0.4469465911388397
loss_pred:0.022277556359767914, decouple_loss:0.009267058223485947
The generated pressure mean: 0.4486790597438812
loss_pred:0.020650826394557953, decouple_loss:0.009022722952067852
Iteration: 1728, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44760581851005554
The generated pressure mean: 0.44854265451431274
loss_pred:0.021623661741614342, decouple_loss:0.008490081876516342
loss_pred:0.019730811938643456, decouple_loss:0.008334246464073658
The generated pressure mean: 0.4487980306148529
loss_pred:0.0209687240421772, decouple_loss:0.008521690033376217
Iteration: 1729, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4488963782787323
loss_pred:0.019926302134990692, decouple_loss:0.00892617553472519
The generated pressure mean: 0.447496235370636
loss_pred:0.020618826150894165, decouple_loss:0.008307578973472118
The generated pressure mean: 0.4486355185508728
loss_pred:0.020556781440973282, decouple_loss:0.008545615710318089
Iteration: 1730, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4486963152885437
loss_pred:0.02057148702442646, decouple_loss:0.008480282500386238
The generated pressure mean: 0.4487879276275635
loss_pred:0.02100352756679058, decouple_loss:0.008786767721176147
The generated pressure mean: 0.44859758019447327
loss_pred:0.02080409601330757, decouple_loss:0.008358826860785484
2023-04-16 08:22:11 testing...
The generated pressure mean: 0.4502691328525543
loss_pred:0.1403486281633377, decouple_loss:0.0534512996673584
The generated pressure mean: 0.4503272473812103
loss_pred:0.1385321170091629, decouple_loss:0.05336861312389374
The generated pressure mean: 0.45003026723861694
loss_pred:0.13968384265899658, decouple_loss:0.05314438045024872
Loss: 0.14218759536743164, avg_mse: 0.27632761001586914
current test mse: 0.276328
Iteration: 1731, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44948142766952515
loss_pred:0.021915115416049957, decouple_loss:0.008602998219430447
The generated pressure mean: 0.44933217763900757
loss_pred:0.02049914374947548, decouple_loss:0.0082859480753541
The generated pressure mean: 0.44787564873695374
loss_pred:0.020013390108942986, decouple_loss:0.0086032310500741
Iteration: 1732, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44888192415237427
The generated pressure mean: 0.44936123490333557
loss_pred:0.020093848928809166, decouple_loss:0.008901038207113743
loss_pred:0.019536975771188736, decouple_loss:0.008500488474965096
The generated pressure mean: 0.44849202036857605
loss_pred:0.02090071700513363, decouple_loss:0.008374880068004131
Iteration: 1733, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4487384259700775
loss_pred:0.020009845495224, decouple_loss:0.008272343315184116
The generated pressure mean: 0.4492965340614319
loss_pred:0.020764531567692757, decouple_loss:0.00820349995046854
The generated pressure mean: 0.44836118817329407
loss_pred:0.021228861063718796, decouple_loss:0.00819915346801281
Iteration: 1734, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4494543969631195
loss_pred:0.023027824237942696, decouple_loss:0.008042554371058941
The generated pressure mean: 0.4491044878959656
loss_pred:0.020191412419080734, decouple_loss:0.007948188111186028
The generated pressure mean: 0.44780606031417847
loss_pred:0.020730722695589066, decouple_loss:0.00858552660793066
Iteration: 1735, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44839656352996826
loss_pred:0.020979586988687515, decouple_loss:0.007997342385351658
The generated pressure mean: 0.4479078948497772
loss_pred:0.02153337560594082, decouple_loss:0.007992589846253395
The generated pressure mean: 0.4481973648071289
loss_pred:0.020800452679395676, decouple_loss:0.008142991922795773
Iteration: 1736, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44852903485298157
loss_pred:0.02114208973944187, decouple_loss:0.007958159781992435
The generated pressure mean: 0.44793272018432617
loss_pred:0.020837876945734024, decouple_loss:0.008216481655836105
The generated pressure mean: 0.4484284818172455
loss_pred:0.021396394819021225, decouple_loss:0.008877508342266083
Iteration: 1737, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4479805529117584
loss_pred:0.02057272009551525, decouple_loss:0.008272345177829266
The generated pressure mean: 0.4488517940044403
loss_pred:0.021275833249092102, decouple_loss:0.00848296657204628
The generated pressure mean: 0.4479858875274658
loss_pred:0.02050207369029522, decouple_loss:0.008383264765143394
Iteration: 1738, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4486652910709381
loss_pred:0.020759839564561844, decouple_loss:0.008290478028357029
The generated pressure mean: 0.4473387897014618
loss_pred:0.02184572070837021, decouple_loss:0.007994190789759159
The generated pressure mean: 0.44772517681121826
loss_pred:0.02120598405599594, decouple_loss:0.00812949612736702
Iteration: 1739, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.448412150144577
loss_pred:0.020533950999379158, decouple_loss:0.008872904814779758
The generated pressure mean: 0.4486899971961975
loss_pred:0.020543845370411873, decouple_loss:0.00912467297166586
The generated pressure mean: 0.4488188922405243
loss_pred:0.02095194347202778, decouple_loss:0.008990242145955563
Iteration: 1740, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4493652582168579
loss_pred:0.02255830354988575, decouple_loss:0.009171640500426292
The generated pressure mean: 0.44859471917152405
loss_pred:0.02148427441716194, decouple_loss:0.009524676017463207
The generated pressure mean: 0.448736310005188
loss_pred:0.020528672263026237, decouple_loss:0.009012040682137012
2023-04-16 08:24:17 testing...
The generated pressure mean: 0.4502691626548767
loss_pred:0.14075997471809387, decouple_loss:0.055053915828466415
The generated pressure mean: 0.45032477378845215
loss_pred:0.13957972824573517, decouple_loss:0.05506047606468201
The generated pressure mean: 0.45003047585487366
loss_pred:0.1404455453157425, decouple_loss:0.05459125339984894
Loss: 0.1430068463087082, avg_mse: 0.2776651382446289
current test mse: 0.277665
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012015_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012015_3_24hr.npz
NaN value num: 0
Iteration: 1741, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.446532666683197
loss_pred:0.020406469702720642, decouple_loss:0.00900877732783556
The generated pressure mean: 0.4470449388027191
loss_pred:0.02206052467226982, decouple_loss:0.009042618796229362
The generated pressure mean: 0.4477287828922272
loss_pred:0.02093840204179287, decouple_loss:0.00931700412184
Iteration: 1742, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44717100262641907
loss_pred:0.02147824689745903, decouple_loss:0.009493662044405937
The generated pressure mean: 0.44728633761405945
loss_pred:0.021865783259272575, decouple_loss:0.009258459322154522
The generated pressure mean: 0.4465688467025757
loss_pred:0.02310292050242424, decouple_loss:0.009453901089727879
Iteration: 1743, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4477177858352661
loss_pred:0.02261962555348873, decouple_loss:0.01034227479249239
The generated pressure mean: 0.4471760094165802
loss_pred:0.020437953993678093, decouple_loss:0.009743505157530308
The generated pressure mean: 0.44549211859703064
loss_pred:0.02158614993095398, decouple_loss:0.010365182533860207
Iteration: 1744, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4471292197704315
loss_pred:0.019817568361759186, decouple_loss:0.009136414155364037
The generated pressure mean: 0.4478299021720886
loss_pred:0.020206039771437645, decouple_loss:0.009123319759964943
The generated pressure mean: 0.4462107717990875
loss_pred:0.02166977897286415, decouple_loss:0.009198401123285294
Iteration: 1745, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44704923033714294
loss_pred:0.02071780152618885, decouple_loss:0.009298467077314854
The generated pressure mean: 0.4460497200489044
loss_pred:0.023963378742337227, decouple_loss:0.009541082195937634
The generated pressure mean: 0.4477517008781433
loss_pred:0.020525353029370308, decouple_loss:0.00922034215182066
Iteration: 1746, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4463682472705841
The generated pressure mean: 0.4469418227672577
loss_pred:0.023841848596930504, decouple_loss:0.010965170338749886
loss_pred:0.02210911177098751, decouple_loss:0.01014156173914671
The generated pressure mean: 0.44740864634513855
loss_pred:0.021940015256404877, decouple_loss:0.010673299431800842
Iteration: 1747, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4473886787891388
loss_pred:0.021389631554484367, decouple_loss:0.009737730026245117
The generated pressure mean: 0.44613927602767944
loss_pred:0.021498506888747215, decouple_loss:0.009934497997164726
The generated pressure mean: 0.44763824343681335
loss_pred:0.021672436967492104, decouple_loss:0.009664312936365604
Iteration: 1748, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44723331928253174
loss_pred:0.02192695625126362, decouple_loss:0.008801759220659733
The generated pressure mean: 0.4476430118083954
loss_pred:0.020467817783355713, decouple_loss:0.008889504708349705
The generated pressure mean: 0.4468753933906555
loss_pred:0.020809464156627655, decouple_loss:0.00907694362103939
Iteration: 1749, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4462270736694336
The generated pressure mean: 0.4464341998100281
loss_pred:0.020916210487484932, decouple_loss:0.010382715612649918
loss_pred:0.022009706124663353, decouple_loss:0.009828362613916397
The generated pressure mean: 0.4474983215332031
loss_pred:0.020222079008817673, decouple_loss:0.010456900112330914
Iteration: 1750, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4475894868373871
loss_pred:0.02111390233039856, decouple_loss:0.010890964418649673
The generated pressure mean: 0.44626757502555847
loss_pred:0.02293456345796585, decouple_loss:0.011193476617336273
The generated pressure mean: 0.4470171332359314
loss_pred:0.021558210253715515, decouple_loss:0.010817734524607658
2023-04-16 08:27:04 testing...
The generated pressure mean: 0.4502691626548767
loss_pred:0.14410316944122314, decouple_loss:0.05472889170050621
The generated pressure mean: 0.45032426714897156
loss_pred:0.14243578910827637, decouple_loss:0.05516902729868889
The generated pressure mean: 0.4500288963317871
loss_pred:0.14343109726905823, decouple_loss:0.05445587635040283
Loss: 0.14606258273124695, avg_mse: 0.28163912892341614
current test mse: 0.281639
Iteration: 1751, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4472326636314392
loss_pred:0.0201282799243927, decouple_loss:0.009766610339283943
The generated pressure mean: 0.4479593336582184
loss_pred:0.021414151415228844, decouple_loss:0.00971366185694933
The generated pressure mean: 0.4473296105861664
loss_pred:0.0203477181494236, decouple_loss:0.009559070691466331
Iteration: 1752, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4482229948043823
loss_pred:0.022376341745257378, decouple_loss:0.00985070038586855
The generated pressure mean: 0.4466732442378998
loss_pred:0.020395543426275253, decouple_loss:0.009836787357926369
The generated pressure mean: 0.44675031304359436
loss_pred:0.02067132107913494, decouple_loss:0.009758388623595238
Iteration: 1753, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44819748401641846
loss_pred:0.021144917234778404, decouple_loss:0.010185955092310905
The generated pressure mean: 0.4467552900314331
loss_pred:0.020848723128437996, decouple_loss:0.010468593798577785
The generated pressure mean: 0.44772782921791077
loss_pred:0.022161776199936867, decouple_loss:0.010189000517129898
Iteration: 1754, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44761693477630615
loss_pred:0.023643940687179565, decouple_loss:0.009977027773857117
The generated pressure mean: 0.4471350908279419
loss_pred:0.021130453795194626, decouple_loss:0.010402761399745941
The generated pressure mean: 0.4457460939884186
loss_pred:0.020176855847239494, decouple_loss:0.009943886660039425
Iteration: 1755, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44615527987480164
loss_pred:0.02141932025551796, decouple_loss:0.009850198403000832
The generated pressure mean: 0.4485378563404083
loss_pred:0.022411543875932693, decouple_loss:0.00991537980735302
The generated pressure mean: 0.44707611203193665
loss_pred:0.02044389583170414, decouple_loss:0.009445155039429665
Iteration: 1756, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4460413455963135
loss_pred:0.020768167451024055, decouple_loss:0.00971519760787487
The generated pressure mean: 0.4470963478088379
loss_pred:0.022243760526180267, decouple_loss:0.010092136450111866
The generated pressure mean: 0.4477338492870331
loss_pred:0.020150426775217056, decouple_loss:0.009753026999533176
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1757, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4475363790988922
loss_pred:0.023025019094347954, decouple_loss:0.010216842405498028
The generated pressure mean: 0.4476252496242523
loss_pred:0.01971697248518467, decouple_loss:0.00943430420011282
The generated pressure mean: 0.4478016495704651
loss_pred:0.02149089053273201, decouple_loss:0.009590854868292809
Iteration: 1758, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44648727774620056
loss_pred:0.02122584357857704, decouple_loss:0.01126550231128931
The generated pressure mean: 0.447367787361145
loss_pred:0.019975507631897926, decouple_loss:0.01145599503070116
The generated pressure mean: 0.44476333260536194
loss_pred:0.02173030562698841, decouple_loss:0.011699696071445942
Iteration: 1759, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4469016492366791
loss_pred:0.020966747775673866, decouple_loss:0.00954657793045044
The generated pressure mean: 0.44762811064720154
loss_pred:0.022829607129096985, decouple_loss:0.01000075414776802
The generated pressure mean: 0.4464532434940338
loss_pred:0.021075021475553513, decouple_loss:0.009723509661853313
Iteration: 1760, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44710394740104675
loss_pred:0.020567674189805984, decouple_loss:0.009709653444588184
The generated pressure mean: 0.44640401005744934
loss_pred:0.02126937545835972, decouple_loss:0.009862300008535385
The generated pressure mean: 0.44649872183799744
loss_pred:0.02082800678908825, decouple_loss:0.00967914704233408
2023-04-16 08:29:11 testing...
The generated pressure mean: 0.4502691626548767
loss_pred:0.13762660324573517, decouple_loss:0.05475098267197609
The generated pressure mean: 0.4503227472305298
loss_pred:0.13639330863952637, decouple_loss:0.054554976522922516
The generated pressure mean: 0.4500311613082886
loss_pred:0.13710017502307892, decouple_loss:0.054254744201898575
Loss: 0.13976605236530304, avg_mse: 0.26991578936576843
current test mse: 0.269916
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012016_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012016_3_24hr.npz
NaN value num: 0
Iteration: 1761, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4490250051021576
loss_pred:0.02011657878756523, decouple_loss:0.011643378995358944
The generated pressure mean: 0.44745856523513794
loss_pred:0.021769728511571884, decouple_loss:0.010289927013218403
The generated pressure mean: 0.4481560289859772
loss_pred:0.023932093754410744, decouple_loss:0.011202432215213776
Iteration: 1762, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44822654128074646
loss_pred:0.01949315145611763, decouple_loss:0.010948838666081429
The generated pressure mean: 0.4481993019580841
loss_pred:0.020895639434456825, decouple_loss:0.010814209468662739
The generated pressure mean: 0.44725266098976135
loss_pred:0.020750489085912704, decouple_loss:0.010433037765324116
Iteration: 1763, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4470911920070648
loss_pred:0.02093106135725975, decouple_loss:0.009002002887427807
The generated pressure mean: 0.44859057664871216
loss_pred:0.019994616508483887, decouple_loss:0.009463711641728878
The generated pressure mean: 0.44737508893013
loss_pred:0.022246476262807846, decouple_loss:0.00905571598559618
Iteration: 1764, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4474821984767914
loss_pred:0.020643537864089012, decouple_loss:0.010148050263524055
The generated pressure mean: 0.44724178314208984
loss_pred:0.019511360675096512, decouple_loss:0.010080375708639622
The generated pressure mean: 0.4474715292453766
loss_pred:0.02108488790690899, decouple_loss:0.009819316677749157
Iteration: 1765, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44745028018951416
loss_pred:0.019164400175213814, decouple_loss:0.009862109087407589
The generated pressure mean: 0.447442889213562
loss_pred:0.023495400324463844, decouple_loss:0.010354176163673401
The generated pressure mean: 0.4501815736293793
loss_pred:0.020204244181513786, decouple_loss:0.01005249097943306
Iteration: 1766, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4470542073249817
loss_pred:0.019899917766451836, decouple_loss:0.009044522419571877
The generated pressure mean: 0.44723814725875854
loss_pred:0.019625481218099594, decouple_loss:0.009150291793048382
The generated pressure mean: 0.4479251801967621
loss_pred:0.021278949454426765, decouple_loss:0.009143654257059097
Iteration: 1767, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.448820024728775
loss_pred:0.020229099318385124, decouple_loss:0.009078674018383026
The generated pressure mean: 0.4471949338912964
loss_pred:0.021617209538817406, decouple_loss:0.009984596632421017
The generated pressure mean: 0.44749221205711365
loss_pred:0.020968656986951828, decouple_loss:0.00965652521699667
Iteration: 1768, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4474325478076935
loss_pred:0.021145518869161606, decouple_loss:0.009122036397457123
The generated pressure mean: 0.4482956826686859
loss_pred:0.021084971725940704, decouple_loss:0.009261110797524452
The generated pressure mean: 0.44858288764953613
loss_pred:0.02052721008658409, decouple_loss:0.00941547006368637
Iteration: 1769, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44816774129867554
loss_pred:0.020769504830241203, decouple_loss:0.009265397675335407
The generated pressure mean: 0.4499872922897339
loss_pred:0.020032277330756187, decouple_loss:0.009535035118460655
The generated pressure mean: 0.4481161832809448
loss_pred:0.021193528547883034, decouple_loss:0.008838752284646034
Iteration: 1770, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4480787515640259
The generated pressure mean: 0.4478539526462555
loss_pred:0.021535029634833336, decouple_loss:0.00878448411822319
loss_pred:0.021982822567224503, decouple_loss:0.009011775255203247
The generated pressure mean: 0.4468655288219452
loss_pred:0.020787829533219337, decouple_loss:0.009043470956385136
2023-04-16 08:31:55 testing...
The generated pressure mean: 0.4502691328525543
loss_pred:0.13966135680675507, decouple_loss:0.05477389320731163
The generated pressure mean: 0.45032790303230286
loss_pred:0.13819552958011627, decouple_loss:0.05452442169189453
The generated pressure mean: 0.45003190636634827
loss_pred:0.1388949155807495, decouple_loss:0.054203007370233536
Loss: 0.14164230227470398, avg_mse: 0.27256467938423157
current test mse: 0.272565
Iteration: 1771, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4476219117641449
loss_pred:0.02072296105325222, decouple_loss:0.009651094675064087
The generated pressure mean: 0.44909170269966125
loss_pred:0.020059458911418915, decouple_loss:0.008869837038218975
The generated pressure mean: 0.4481246769428253
loss_pred:0.020760428160429, decouple_loss:0.008867568336427212
Iteration: 1772, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4469156563282013
loss_pred:0.02105274796485901, decouple_loss:0.008690145798027515
The generated pressure mean: 0.44760861992836
The generated pressure mean: 0.44773462414741516loss_pred:0.02013280987739563, decouple_loss:0.008778572082519531
loss_pred:0.020591897889971733, decouple_loss:0.008617310784757137
Iteration: 1773, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44717535376548767
loss_pred:0.02102583460509777, decouple_loss:0.008827978745102882
The generated pressure mean: 0.4483506679534912
loss_pred:0.020520448684692383, decouple_loss:0.008558866567909718
The generated pressure mean: 0.44855502247810364
loss_pred:0.020317474380135536, decouple_loss:0.008865603245794773
Iteration: 1774, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4482037425041199
loss_pred:0.018996747210621834, decouple_loss:0.010242420248687267
The generated pressure mean: 0.44906723499298096
loss_pred:0.021022284403443336, decouple_loss:0.009650168940424919
The generated pressure mean: 0.4495890438556671
loss_pred:0.020065970718860626, decouple_loss:0.010918733663856983
Iteration: 1775, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4498216509819031
loss_pred:0.02049277350306511, decouple_loss:0.009685314260423183
The generated pressure mean: 0.44887930154800415
loss_pred:0.02014302834868431, decouple_loss:0.010036341845989227
The generated pressure mean: 0.44919148087501526
loss_pred:0.019779810681939125, decouple_loss:0.0098219383507967
Iteration: 1776, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4476265013217926
loss_pred:0.021572498604655266, decouple_loss:0.009157862514257431
The generated pressure mean: 0.4471330940723419
loss_pred:0.021120460703969002, decouple_loss:0.009116916917264462
The generated pressure mean: 0.4479537904262543
loss_pred:0.022377528250217438, decouple_loss:0.008544341661036015
Iteration: 1777, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4470408260822296
loss_pred:0.021046750247478485, decouple_loss:0.010038720443844795
The generated pressure mean: 0.44899728894233704
loss_pred:0.02008446305990219, decouple_loss:0.010458758100867271
The generated pressure mean: 0.44870853424072266
loss_pred:0.021769633516669273, decouple_loss:0.009536259807646275
Iteration: 1778, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4469321072101593
The generated pressure mean: 0.4482073485851288
loss_pred:0.021579399704933167, decouple_loss:0.011283980682492256
loss_pred:0.01980230025947094, decouple_loss:0.011945374310016632
The generated pressure mean: 0.4483390152454376
loss_pred:0.021431228145956993, decouple_loss:0.011367110535502434
Iteration: 1779, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4488906264305115
loss_pred:0.023359624668955803, decouple_loss:0.010031498968601227
The generated pressure mean: 0.4475371241569519
loss_pred:0.02239855006337166, decouple_loss:0.009916789829730988
The generated pressure mean: 0.44752275943756104
loss_pred:0.020272517576813698, decouple_loss:0.009801123291254044
Iteration: 1780, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44781166315078735
loss_pred:0.024524159729480743, decouple_loss:0.01230536587536335
The generated pressure mean: 0.44805827736854553
loss_pred:0.02080763503909111, decouple_loss:0.011938557960093021
The generated pressure mean: 0.4475015699863434
loss_pred:0.026559296995401382, decouple_loss:0.012784604914486408
2023-04-16 08:34:01 testing...
The generated pressure mean: 0.4502691328525543
loss_pred:0.14062988758087158, decouple_loss:0.05628533288836479
The generated pressure mean: 0.45032355189323425
loss_pred:0.1388660967350006, decouple_loss:0.056128714233636856
The generated pressure mean: 0.4500286281108856
loss_pred:0.13985948264598846, decouple_loss:0.05574556440114975
Loss: 0.142587810754776, avg_mse: 0.27627572417259216
current test mse: 0.276276
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012006_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012006_3_24hr.npz
NaN value num: 0
Iteration: 1781, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4476638436317444
loss_pred:0.02212650328874588, decouple_loss:0.011413059197366238
The generated pressure mean: 0.44786372780799866
loss_pred:0.021488644182682037, decouple_loss:0.010998235084116459
The generated pressure mean: 0.44791439175605774
loss_pred:0.021948162466287613, decouple_loss:0.011094002053141594
Iteration: 1782, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4489780366420746
loss_pred:0.021591873839497566, decouple_loss:0.01077229157090187
The generated pressure mean: 0.4487808346748352
loss_pred:0.020298127084970474, decouple_loss:0.0107180280610919
The generated pressure mean: 0.44988229870796204
loss_pred:0.019691521301865578, decouple_loss:0.010470474138855934
Iteration: 1783, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4485239088535309
loss_pred:0.02031431719660759, decouple_loss:0.010733903385698795
The generated pressure mean: 0.44823795557022095
loss_pred:0.022616282105445862, decouple_loss:0.010553812608122826
The generated pressure mean: 0.4479406476020813
loss_pred:0.02134878933429718, decouple_loss:0.011011425405740738
Iteration: 1784, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44823747873306274
loss_pred:0.02137097530066967, decouple_loss:0.009550526738166809
The generated pressure mean: 0.44939762353897095
loss_pred:0.020873859524726868, decouple_loss:0.009841524064540863
The generated pressure mean: 0.4488966166973114
loss_pred:0.02251836471259594, decouple_loss:0.010015489533543587
Iteration: 1785, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44789958000183105
loss_pred:0.02356676012277603, decouple_loss:0.011086490005254745
The generated pressure mean: 0.4485776424407959
loss_pred:0.020343350246548653, decouple_loss:0.011838271282613277
The generated pressure mean: 0.4478093087673187
loss_pred:0.020307360216975212, decouple_loss:0.011511501856148243
Iteration: 1786, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.447378933429718
loss_pred:0.02206188254058361, decouple_loss:0.010468490421772003
The generated pressure mean: 0.44852033257484436
loss_pred:0.020967328920960426, decouple_loss:0.010620292276144028
The generated pressure mean: 0.4485184848308563
loss_pred:0.020368143916130066, decouple_loss:0.01035267487168312
Iteration: 1787, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4480300545692444
loss_pred:0.023519378155469894, decouple_loss:0.010194079019129276
The generated pressure mean: 0.44792890548706055
loss_pred:0.021380126476287842, decouple_loss:0.010297589935362339
The generated pressure mean: 0.44679927825927734
loss_pred:0.021014761179685593, decouple_loss:0.00997098721563816
Iteration: 1788, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44804447889328003
loss_pred:0.020883431658148766, decouple_loss:0.010220392607152462
The generated pressure mean: 0.44881150126457214
loss_pred:0.02309323288500309, decouple_loss:0.010327635332942009
The generated pressure mean: 0.4473423659801483
loss_pred:0.021665189415216446, decouple_loss:0.010090389288961887
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1789, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44791340827941895
loss_pred:0.02227308601140976, decouple_loss:0.010290349833667278
The generated pressure mean: 0.4487174153327942
loss_pred:0.020456677302718163, decouple_loss:0.010707358829677105
The generated pressure mean: 0.4478226602077484
loss_pred:0.021652333438396454, decouple_loss:0.010395888239145279
Iteration: 1790, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4474012553691864
loss_pred:0.022632109001278877, decouple_loss:0.009787890128791332
The generated pressure mean: 0.4483763575553894
loss_pred:0.02109890803694725, decouple_loss:0.00981706939637661
The generated pressure mean: 0.4472241997718811
loss_pred:0.020940620452165604, decouple_loss:0.009967484511435032
2023-04-16 08:36:42 testing...
The generated pressure mean: 0.4502691626548767
loss_pred:0.13679690659046173, decouple_loss:0.052542898803949356
The generated pressure mean: 0.4500313699245453
loss_pred:0.13585546612739563, decouple_loss:0.052462443709373474
The generated pressure mean: 0.45032480359077454
loss_pred:0.13464811444282532, decouple_loss:0.052880898118019104
Loss: 0.13839827477931976, avg_mse: 0.2657106816768646
current test mse: 0.265711
Iteration: 1791, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44785061478614807
The generated pressure mean: 0.4481169581413269
The generated pressure mean: 0.44840553402900696
loss_pred:0.021293386816978455, decouple_loss:0.009708390571177006
loss_pred:0.021736035123467445, decouple_loss:0.009872800670564175
loss_pred:0.02198851853609085, decouple_loss:0.01003988180309534
Iteration: 1792, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4476943016052246
The generated pressure mean: 0.44801145792007446
loss_pred:0.022095585241913795, decouple_loss:0.010608702898025513
loss_pred:0.021273702383041382, decouple_loss:0.010468756780028343
The generated pressure mean: 0.4475669264793396
loss_pred:0.022790374234318733, decouple_loss:0.010555794462561607
Iteration: 1793, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44745761156082153
loss_pred:0.021549111232161522, decouple_loss:0.01061871089041233
The generated pressure mean: 0.44884350895881653
loss_pred:0.019853737205266953, decouple_loss:0.010728808119893074
The generated pressure mean: 0.447328120470047
loss_pred:0.021791426464915276, decouple_loss:0.010181779973208904
Iteration: 1794, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44779321551322937
loss_pred:0.022346798330545425, decouple_loss:0.010174398310482502
The generated pressure mean: 0.44751352071762085
loss_pred:0.020277272909879684, decouple_loss:0.009758380241692066
The generated pressure mean: 0.4486881196498871
loss_pred:0.022486964240670204, decouple_loss:0.0103541174903512
Iteration: 1795, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4473901689052582
loss_pred:0.019840635359287262, decouple_loss:0.010531795211136341
The generated pressure mean: 0.4471803605556488
loss_pred:0.022374780848622322, decouple_loss:0.011474933475255966
The generated pressure mean: 0.447466641664505
loss_pred:0.019856713712215424, decouple_loss:0.011445894837379456
Iteration: 1796, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44800063967704773
loss_pred:0.02068987861275673, decouple_loss:0.009691980667412281
The generated pressure mean: 0.44873371720314026
loss_pred:0.020800210535526276, decouple_loss:0.009787031449377537
The generated pressure mean: 0.4481852650642395
loss_pred:0.02367236837744713, decouple_loss:0.010077168233692646
Iteration: 1797, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44788482785224915
loss_pred:0.020207535475492477, decouple_loss:0.009898378513753414
The generated pressure mean: 0.4492025375366211
loss_pred:0.021740565076470375, decouple_loss:0.009770234115421772
The generated pressure mean: 0.44786980748176575
loss_pred:0.0215044766664505, decouple_loss:0.01007017120718956
Iteration: 1798, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4482676088809967
The generated pressure mean: 0.44738221168518066
loss_pred:0.020168354734778404, decouple_loss:0.009720251895487309
loss_pred:0.021067000925540924, decouple_loss:0.009394091553986073
The generated pressure mean: 0.4471040368080139
loss_pred:0.02089869976043701, decouple_loss:0.009353332221508026
Iteration: 1799, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44718068838119507
loss_pred:0.02148442715406418, decouple_loss:0.010157223790884018
The generated pressure mean: 0.44831374287605286
loss_pred:0.021025599911808968, decouple_loss:0.010392267256975174
The generated pressure mean: 0.4474547803401947
loss_pred:0.019608143717050552, decouple_loss:0.010001909919083118
Iteration: 1800, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4491257965564728
loss_pred:0.02073495462536812, decouple_loss:0.009372778236865997
The generated pressure mean: 0.4487370550632477
loss_pred:0.02021150104701519, decouple_loss:0.009446263313293457
The generated pressure mean: 0.4477590024471283
loss_pred:0.02059546858072281, decouple_loss:0.009800068102777004
2023-04-16 08:38:49 testing...
The generated pressure mean: 0.4502691924571991
loss_pred:0.1338769942522049, decouple_loss:0.04991351068019867
The generated pressure mean: 0.45032086968421936
loss_pred:0.13249137997627258, decouple_loss:0.050121013075113297
The generated pressure mean: 0.45002833008766174
loss_pred:0.13332130014896393, decouple_loss:0.04965324327349663
Loss: 0.13572469353675842, avg_mse: 0.26047754287719727
current test mse: 0.260478
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012011_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012011_3_24hr.npz
NaN value num: 0
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1801, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44656723737716675
loss_pred:0.021141285076737404, decouple_loss:0.009592747315764427
The generated pressure mean: 0.44875189661979675
loss_pred:0.020218132063746452, decouple_loss:0.009466411545872688
The generated pressure mean: 0.4473395347595215
loss_pred:0.020880412310361862, decouple_loss:0.009486310184001923
Iteration: 1802, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44914764165878296
loss_pred:0.021768983453512192, decouple_loss:0.010167185217142105
The generated pressure mean: 0.4474499523639679
loss_pred:0.02089475840330124, decouple_loss:0.009534225799143314
The generated pressure mean: 0.4468771815299988
loss_pred:0.020841406658291817, decouple_loss:0.010411715134978294
Iteration: 1803, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.446349173784256
loss_pred:0.020929867401719093, decouple_loss:0.009680709801614285
The generated pressure mean: 0.44762107729911804
loss_pred:0.022228974848985672, decouple_loss:0.00968969613313675
The generated pressure mean: 0.4472138285636902
loss_pred:0.020099200308322906, decouple_loss:0.009960312396287918
Iteration: 1804, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44650521874427795
loss_pred:0.02143525704741478, decouple_loss:0.009513378143310547
The generated pressure mean: 0.4470423758029938
loss_pred:0.019507400691509247, decouple_loss:0.009916635230183601
The generated pressure mean: 0.449370414018631
loss_pred:0.020611805841326714, decouple_loss:0.009469056501984596
Iteration: 1805, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4487459361553192
loss_pred:0.020844867452979088, decouple_loss:0.011198566295206547
The generated pressure mean: 0.4479028582572937
loss_pred:0.019836662337183952, decouple_loss:0.011663067154586315
The generated pressure mean: 0.44962120056152344
loss_pred:0.02220386080443859, decouple_loss:0.01071916427463293
Iteration: 1806, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44767850637435913
loss_pred:0.020661694929003716, decouple_loss:0.01019566971808672
The generated pressure mean: 0.44801896810531616
loss_pred:0.020474238321185112, decouple_loss:0.010714061558246613
The generated pressure mean: 0.4466685950756073
loss_pred:0.020564664155244827, decouple_loss:0.0102186044678092
Iteration: 1807, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44808921217918396
loss_pred:0.020905518904328346, decouple_loss:0.009894953109323978
The generated pressure mean: 0.44639891386032104
loss_pred:0.020211704075336456, decouple_loss:0.00963975302875042
The generated pressure mean: 0.44625309109687805
loss_pred:0.021677492186427116, decouple_loss:0.009757410734891891
Iteration: 1808, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44803380966186523
loss_pred:0.020876720547676086, decouple_loss:0.009868639521300793
The generated pressure mean: 0.4468987286090851
loss_pred:0.020425351336598396, decouple_loss:0.009902684949338436
The generated pressure mean: 0.44745975732803345
loss_pred:0.02068333700299263, decouple_loss:0.009965498931705952
Iteration: 1809, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4479214549064636
loss_pred:0.02195887081325054, decouple_loss:0.010513463988900185
The generated pressure mean: 0.4480443596839905
loss_pred:0.020915724337100983, decouple_loss:0.00946755614131689
The generated pressure mean: 0.4487766921520233
loss_pred:0.021351780742406845, decouple_loss:0.009947959333658218
Iteration: 1810, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4474930763244629
The generated pressure mean: 0.44682711362838745loss_pred:0.0199961569160223, decouple_loss:0.009483132511377335
loss_pred:0.020543880760669708, decouple_loss:0.00966939702630043
The generated pressure mean: 0.44778722524642944
loss_pred:0.021362468600273132, decouple_loss:0.00922185368835926
2023-04-16 08:41:31 testing...
The generated pressure mean: 0.4502691626548767
loss_pred:0.13733363151550293, decouple_loss:0.050835203379392624
The generated pressure mean: 0.4503244161605835
loss_pred:0.13607969880104065, decouple_loss:0.05101127550005913
The generated pressure mean: 0.4500308632850647
loss_pred:0.13620489835739136, decouple_loss:0.050462182611227036
Loss: 0.13907788693904877, avg_mse: 0.26778745651245117
current test mse: 0.267787
Iteration: 1811, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44838452339172363
loss_pred:0.019993314519524574, decouple_loss:0.009618783369660378
The generated pressure mean: 0.44943174719810486
loss_pred:0.02165244333446026, decouple_loss:0.009509294293820858
The generated pressure mean: 0.44698649644851685
loss_pred:0.022047141566872597, decouple_loss:0.00999891385436058
Iteration: 1812, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44683361053466797
loss_pred:0.022398553788661957, decouple_loss:0.00915581826120615
The generated pressure mean: 0.44725272059440613
loss_pred:0.02153385616838932, decouple_loss:0.008802838623523712
The generated pressure mean: 0.4472644329071045
loss_pred:0.021630171686410904, decouple_loss:0.00910957157611847
Iteration: 1813, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4468448758125305
loss_pred:0.020258624106645584, decouple_loss:0.009718316607177258
The generated pressure mean: 0.447837233543396
loss_pred:0.020978176966309547, decouple_loss:0.009871010668575764
The generated pressure mean: 0.4472861886024475
loss_pred:0.021063314750790596, decouple_loss:0.009175526909530163
Iteration: 1814, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.447048544883728
loss_pred:0.01993793435394764, decouple_loss:0.009586549364030361
The generated pressure mean: 0.44583120942115784
loss_pred:0.02182922326028347, decouple_loss:0.009324228391051292
The generated pressure mean: 0.4481663703918457
loss_pred:0.020842131227254868, decouple_loss:0.008954246528446674
Iteration: 1815, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.447194367647171
loss_pred:0.02163592539727688, decouple_loss:0.009449762292206287
The generated pressure mean: 0.44586294889450073
loss_pred:0.020534979179501534, decouple_loss:0.009511436335742474
The generated pressure mean: 0.44734880328178406
loss_pred:0.021240629255771637, decouple_loss:0.009386290796101093
Iteration: 1816, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4467204511165619
loss_pred:0.02218095399439335, decouple_loss:0.008961362764239311
The generated pressure mean: 0.4486802816390991
loss_pred:0.021734682843089104, decouple_loss:0.00916373822838068
The generated pressure mean: 0.44797006249427795
loss_pred:0.020611051470041275, decouple_loss:0.009035722352564335
Iteration: 1817, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4470222294330597
loss_pred:0.020408034324645996, decouple_loss:0.009310463443398476
The generated pressure mean: 0.4491696357727051
loss_pred:0.021139392629265785, decouple_loss:0.009432321414351463
The generated pressure mean: 0.4485800862312317
loss_pred:0.022637570276856422, decouple_loss:0.009325755760073662
Iteration: 1818, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44887575507164
loss_pred:0.021965082734823227, decouple_loss:0.009193924255669117
The generated pressure mean: 0.4485403597354889
loss_pred:0.02093401923775673, decouple_loss:0.009649881161749363
The generated pressure mean: 0.4464000165462494
loss_pred:0.02137855254113674, decouple_loss:0.009279477410018444
Iteration: 1819, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4479195475578308
loss_pred:0.01983312889933586, decouple_loss:0.009299371391534805
The generated pressure mean: 0.4466046690940857
loss_pred:0.022153809666633606, decouple_loss:0.00958290509879589
The generated pressure mean: 0.44625839591026306
loss_pred:0.01979031227529049, decouple_loss:0.009339269250631332
Iteration: 1820, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4494103193283081
loss_pred:0.019782373681664467, decouple_loss:0.008895108476281166
The generated pressure mean: 0.446781188249588
loss_pred:0.021995916962623596, decouple_loss:0.00903022475540638
The generated pressure mean: 0.44817426800727844
loss_pred:0.021655067801475525, decouple_loss:0.00897184293717146
2023-04-16 08:43:38 testing...
The generated pressure mean: 0.4502691626548767
loss_pred:0.1331814080476761, decouple_loss:0.04980195313692093
The generated pressure mean: 0.45032408833503723
loss_pred:0.1318129599094391, decouple_loss:0.04984813928604126
The generated pressure mean: 0.45003241300582886
loss_pred:0.13210205733776093, decouple_loss:0.04964381083846092
Loss: 0.13485372066497803, avg_mse: 0.2589193880558014
current test mse: 0.258919
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012014_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012014_3_24hr.npz
NaN value num: 0
Iteration: 1821, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4464964270591736
loss_pred:0.021957455202937126, decouple_loss:0.009176364168524742
The generated pressure mean: 0.44785240292549133
loss_pred:0.020915543660521507, decouple_loss:0.00948287546634674
The generated pressure mean: 0.44647419452667236
loss_pred:0.019709348678588867, decouple_loss:0.009581346996128559
Iteration: 1822, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4478253126144409
loss_pred:0.023083165287971497, decouple_loss:0.009712770581245422
The generated pressure mean: 0.44659313559532166
loss_pred:0.019806545227766037, decouple_loss:0.009610223583877087
The generated pressure mean: 0.448516845703125
loss_pred:0.0203817430883646, decouple_loss:0.009784016758203506
Iteration: 1823, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4472280740737915
loss_pred:0.021702097728848457, decouple_loss:0.008709062822163105
The generated pressure mean: 0.44605547189712524
loss_pred:0.023243781179189682, decouple_loss:0.008916491642594337
The generated pressure mean: 0.4472736120223999
loss_pred:0.021701566874980927, decouple_loss:0.008656454272568226
Iteration: 1824, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44707801938056946
loss_pred:0.0215543694794178, decouple_loss:0.009626898914575577
The generated pressure mean: 0.44703537225723267
loss_pred:0.020953603088855743, decouple_loss:0.009297234937548637
The generated pressure mean: 0.446806937456131
loss_pred:0.022817110642790794, decouple_loss:0.009626943618059158
Iteration: 1825, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44641098380088806
loss_pred:0.020295647904276848, decouple_loss:0.010030013509094715
The generated pressure mean: 0.44719862937927246
loss_pred:0.023234553635120392, decouple_loss:0.010395742952823639
The generated pressure mean: 0.4470655024051666
loss_pred:0.020730698481202126, decouple_loss:0.010190190747380257
Iteration: 1826, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4471398591995239
loss_pred:0.021058131009340286, decouple_loss:0.009489615447819233
The generated pressure mean: 0.44678932428359985
loss_pred:0.021004585549235344, decouple_loss:0.009471679106354713
The generated pressure mean: 0.44898271560668945
loss_pred:0.021848851814866066, decouple_loss:0.010144839994609356
Iteration: 1827, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44662973284721375
loss_pred:0.020172668620944023, decouple_loss:0.009332307614386082
The generated pressure mean: 0.4479807913303375
loss_pred:0.02170802280306816, decouple_loss:0.009419884532690048
The generated pressure mean: 0.44808340072631836
loss_pred:0.019428987056016922, decouple_loss:0.009648655541241169
Iteration: 1828, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4471196234226227
loss_pred:0.020690541714429855, decouple_loss:0.00928098801523447
The generated pressure mean: 0.4467673897743225
loss_pred:0.02165745012462139, decouple_loss:0.010032222606241703
The generated pressure mean: 0.4481714069843292
loss_pred:0.021160461008548737, decouple_loss:0.010101471096277237
Iteration: 1829, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4480783939361572
loss_pred:0.021462086588144302, decouple_loss:0.009223655797541142
The generated pressure mean: 0.44740480184555054
loss_pred:0.020010069012641907, decouple_loss:0.009772690013051033
The generated pressure mean: 0.4474712312221527
loss_pred:0.020629413425922394, decouple_loss:0.010242004878818989
Iteration: 1830, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4470451772212982
loss_pred:0.02107461355626583, decouple_loss:0.009494529105722904
The generated pressure mean: 0.4472865164279938
loss_pred:0.02296488545835018, decouple_loss:0.00938791036605835
The generated pressure mean: 0.44819167256355286
loss_pred:0.020616723224520683, decouple_loss:0.009545080363750458
2023-04-16 08:46:25 testing...
The generated pressure mean: 0.4502691626548767
loss_pred:0.13298599421977997, decouple_loss:0.04938550665974617
The generated pressure mean: 0.45032599568367004
loss_pred:0.13174815475940704, decouple_loss:0.04941520094871521
The generated pressure mean: 0.4500310719013214
loss_pred:0.132285475730896, decouple_loss:0.049428850412368774
Loss: 0.13481037318706512, avg_mse: 0.25887531042099
current test mse: 0.258875
Iteration: 1831, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44632962346076965
loss_pred:0.02070031315088272, decouple_loss:0.009894907474517822
The generated pressure mean: 0.4473486542701721
loss_pred:0.021949348971247673, decouple_loss:0.010085809044539928
The generated pressure mean: 0.44754931330680847
loss_pred:0.022024644538760185, decouple_loss:0.010246939025819302
Iteration: 1832, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4481922388076782
loss_pred:0.020188231021165848, decouple_loss:0.010218441486358643
The generated pressure mean: 0.4468020498752594
loss_pred:0.02386636473238468, decouple_loss:0.011730482801795006
The generated pressure mean: 0.44841673970222473
loss_pred:0.02036881446838379, decouple_loss:0.010739277116954327
Iteration: 1833, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44711050391197205
loss_pred:0.022680766880512238, decouple_loss:0.010887752287089825
The generated pressure mean: 0.4466450810432434
The generated pressure mean: 0.4486052989959717
loss_pred:0.02102830447256565, decouple_loss:0.01088568102568388
loss_pred:0.019789397716522217, decouple_loss:0.010802564211189747
Iteration: 1834, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4486256241798401
loss_pred:0.01991927996277809, decouple_loss:0.00946350209414959
The generated pressure mean: 0.4480118155479431
loss_pred:0.022761264815926552, decouple_loss:0.009318871423602104
The generated pressure mean: 0.44714319705963135
loss_pred:0.020707855001091957, decouple_loss:0.008997724391520023
Iteration: 1835, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4476105570793152
loss_pred:0.022571349516510963, decouple_loss:0.010156623087823391
The generated pressure mean: 0.44652819633483887
loss_pred:0.0201039407402277, decouple_loss:0.00939334649592638
The generated pressure mean: 0.4468134641647339
loss_pred:0.02214822545647621, decouple_loss:0.010045475326478481
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1836, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4473332166671753
loss_pred:0.02154923975467682, decouple_loss:0.010957719758152962
The generated pressure mean: 0.4482254087924957
loss_pred:0.02261805534362793, decouple_loss:0.010541786439716816
The generated pressure mean: 0.44640737771987915
loss_pred:0.021036697551608086, decouple_loss:0.010860683396458626
Iteration: 1837, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44702398777008057
loss_pred:0.02245638705790043, decouple_loss:0.009237357415258884
The generated pressure mean: 0.44776231050491333
loss_pred:0.02065690979361534, decouple_loss:0.009333906695246696
The generated pressure mean: 0.448355495929718
loss_pred:0.020555298775434494, decouple_loss:0.009443629533052444
Iteration: 1838, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4461733400821686
loss_pred:0.02032126486301422, decouple_loss:0.009857472963631153
The generated pressure mean: 0.4462559223175049
loss_pred:0.02070947177708149, decouple_loss:0.009761452674865723
The generated pressure mean: 0.4479682445526123
loss_pred:0.020802931860089302, decouple_loss:0.01003771647810936
Iteration: 1839, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4468908905982971
loss_pred:0.021274033933877945, decouple_loss:0.011574539355933666
The generated pressure mean: 0.4464966058731079
loss_pred:0.02063649334013462, decouple_loss:0.011678313836455345
The generated pressure mean: 0.44859135150909424
loss_pred:0.021626301109790802, decouple_loss:0.01126114558428526
Iteration: 1840, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4470219016075134
loss_pred:0.020637167617678642, decouple_loss:0.010106070898473263
The generated pressure mean: 0.4471075236797333
loss_pred:0.019786275923252106, decouple_loss:0.010883010923862457
The generated pressure mean: 0.4458674490451813
loss_pred:0.02109851874411106, decouple_loss:0.010526353493332863
2023-04-16 08:48:31 testing...
The generated pressure mean: 0.4502691328525543
loss_pred:0.13899585604667664, decouple_loss:0.05142712965607643
The generated pressure mean: 0.45032429695129395
loss_pred:0.13757850229740143, decouple_loss:0.05176721513271332
The generated pressure mean: 0.4500323235988617
loss_pred:0.13825654983520508, decouple_loss:0.05138067156076431
Loss: 0.14085322618484497, avg_mse: 0.272704541683197
current test mse: 0.272705
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012004_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012004_3_24hr.npz
NaN value num: 0
Iteration: 1841, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44820651412010193
loss_pred:0.02085276134312153, decouple_loss:0.009894194081425667
The generated pressure mean: 0.44776803255081177
loss_pred:0.019947784021496773, decouple_loss:0.009823816828429699
The generated pressure mean: 0.4479095935821533
loss_pred:0.020684147253632545, decouple_loss:0.010427162051200867
Iteration: 1842, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44850054383277893
The generated pressure mean: 0.4484385848045349
loss_pred:0.021317386999726295, decouple_loss:0.01243309210985899
loss_pred:0.020284952595829964, decouple_loss:0.012224327772855759
The generated pressure mean: 0.4488529562950134
loss_pred:0.02033865824341774, decouple_loss:0.012568582780659199
Iteration: 1843, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44873106479644775
loss_pred:0.0197200495749712, decouple_loss:0.010134891606867313
The generated pressure mean: 0.44891050457954407
loss_pred:0.020489022135734558, decouple_loss:0.01001806277781725
The generated pressure mean: 0.4479132294654846
loss_pred:0.02117258310317993, decouple_loss:0.010020078159868717
Iteration: 1844, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4464297890663147
loss_pred:0.019239628687500954, decouple_loss:0.012251962907612324
The generated pressure mean: 0.4492069482803345
loss_pred:0.021163787692785263, decouple_loss:0.012589325197041035
The generated pressure mean: 0.4472554922103882
loss_pred:0.02112206630408764, decouple_loss:0.012980815954506397
Iteration: 1845, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4479159712791443
loss_pred:0.01970125362277031, decouple_loss:0.009998578578233719
The generated pressure mean: 0.4466107487678528
loss_pred:0.020899437367916107, decouple_loss:0.010052286088466644
The generated pressure mean: 0.44727131724357605
loss_pred:0.01924200728535652, decouple_loss:0.010049358941614628
Iteration: 1846, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.448527067899704
loss_pred:0.019780797883868217, decouple_loss:0.011724591255187988
The generated pressure mean: 0.44663822650909424
loss_pred:0.019697772338986397, decouple_loss:0.012671244330704212
The generated pressure mean: 0.4479033052921295
loss_pred:0.02021775022149086, decouple_loss:0.011916469782590866
Iteration: 1847, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44826576113700867
The generated pressure mean: 0.4488929212093353
loss_pred:0.021715743467211723, decouple_loss:0.00994851253926754
loss_pred:0.020070796832442284, decouple_loss:0.010517420247197151
The generated pressure mean: 0.4487016797065735
loss_pred:0.020108168944716454, decouple_loss:0.009891388937830925
Iteration: 1848, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4468401372432709
loss_pred:0.021776048466563225, decouple_loss:0.0094376839697361
The generated pressure mean: 0.4467661380767822
loss_pred:0.019536877050995827, decouple_loss:0.00960424356162548
The generated pressure mean: 0.4472663998603821
loss_pred:0.019796697422862053, decouple_loss:0.009894073009490967
Iteration: 1849, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4475887417793274
loss_pred:0.021030541509389877, decouple_loss:0.010469778440892696
The generated pressure mean: 0.44829756021499634
loss_pred:0.021064622327685356, decouple_loss:0.010110669769346714
The generated pressure mean: 0.448419451713562
loss_pred:0.019028441980481148, decouple_loss:0.011121686547994614
Iteration: 1850, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.448110431432724
loss_pred:0.01971830055117607, decouple_loss:0.009219533763825893
The generated pressure mean: 0.4481973350048065
loss_pred:0.019060757011175156, decouple_loss:0.009494835510849953
The generated pressure mean: 0.44839662313461304
loss_pred:0.019977184012532234, decouple_loss:0.009279499761760235
2023-04-16 08:51:15 testing...
The generated pressure mean: 0.4502691328525543
loss_pred:0.13815833628177643, decouple_loss:0.049078430980443954
The generated pressure mean: 0.45032426714897156
loss_pred:0.13634610176086426, decouple_loss:0.04953247681260109
The generated pressure mean: 0.4500298798084259
loss_pred:0.13713015615940094, decouple_loss:0.04919707402586937
Loss: 0.13967500627040863, avg_mse: 0.26864612102508545
current test mse: 0.268646
Iteration: 1851, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4478859305381775
loss_pred:0.02083686552941799, decouple_loss:0.008808975107967854
The generated pressure mean: 0.4486903250217438
loss_pred:0.019422266632318497, decouple_loss:0.008911128155887127
The generated pressure mean: 0.4481864273548126
loss_pred:0.01999223604798317, decouple_loss:0.008869796991348267
Iteration: 1852, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4484158456325531
loss_pred:0.020270491018891335, decouple_loss:0.010700329206883907
The generated pressure mean: 0.4483473002910614
loss_pred:0.019958091899752617, decouple_loss:0.010434643365442753
The generated pressure mean: 0.4477401673793793
loss_pred:0.019859271124005318, decouple_loss:0.010296146385371685
Iteration: 1853, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44823169708251953
loss_pred:0.019061611965298653, decouple_loss:0.008769655600190163
The generated pressure mean: 0.44843900203704834
loss_pred:0.020477717742323875, decouple_loss:0.009015118703246117
The generated pressure mean: 0.4472035765647888
loss_pred:0.02133622206747532, decouple_loss:0.008678062818944454
Iteration: 1854, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4480215907096863
loss_pred:0.019933804869651794, decouple_loss:0.00928605068475008
The generated pressure mean: 0.448044091463089
loss_pred:0.02006245031952858, decouple_loss:0.009443876333534718
The generated pressure mean: 0.44922512769699097
loss_pred:0.018842848017811775, decouple_loss:0.008996004238724709
Iteration: 1855, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44785836338996887
loss_pred:0.021242858842015266, decouple_loss:0.00895204022526741
The generated pressure mean: 0.4486326277256012
loss_pred:0.019336681813001633, decouple_loss:0.0086118895560503
The generated pressure mean: 0.4478282630443573
loss_pred:0.020262667909264565, decouple_loss:0.008623996749520302
Iteration: 1856, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44874706864356995
loss_pred:0.019711265340447426, decouple_loss:0.008716259151697159
The generated pressure mean: 0.44699856638908386
loss_pred:0.02017938159406185, decouple_loss:0.009472177363932133
The generated pressure mean: 0.4468970000743866
loss_pred:0.020311769098043442, decouple_loss:0.008510611951351166
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1857, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4472261071205139
loss_pred:0.01980258896946907, decouple_loss:0.00837153010070324
The generated pressure mean: 0.4461520314216614
loss_pred:0.020275648683309555, decouple_loss:0.008814436383545399
The generated pressure mean: 0.44856590032577515
loss_pred:0.01995752565562725, decouple_loss:0.008489060215651989
Iteration: 1858, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44741687178611755
loss_pred:0.01994037628173828, decouple_loss:0.008486898615956306
The generated pressure mean: 0.44867268204689026
loss_pred:0.01879560761153698, decouple_loss:0.008073114790022373
The generated pressure mean: 0.4487707018852234
loss_pred:0.0190946813672781, decouple_loss:0.008398541249334812
Iteration: 1859, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4486674666404724
loss_pred:0.019296901300549507, decouple_loss:0.008328915573656559
The generated pressure mean: 0.4473351836204529
loss_pred:0.02096572518348694, decouple_loss:0.008800606243312359
The generated pressure mean: 0.4486182928085327
loss_pred:0.020241739228367805, decouple_loss:0.008462448604404926
Iteration: 1860, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44785076379776
loss_pred:0.01915804110467434, decouple_loss:0.008404630236327648
The generated pressure mean: 0.447894811630249
loss_pred:0.020863261073827744, decouple_loss:0.00825775507837534
The generated pressure mean: 0.44725102186203003
loss_pred:0.02034478448331356, decouple_loss:0.008248194120824337
2023-04-16 08:53:22 testing...
The generated pressure mean: 0.4502691924571991
loss_pred:0.14025089144706726, decouple_loss:0.05011097714304924
The generated pressure mean: 0.4503248333930969
loss_pred:0.1391569972038269, decouple_loss:0.05006510019302368
The generated pressure mean: 0.45003244280815125
loss_pred:0.1398364007472992, decouple_loss:0.04995094984769821
Loss: 0.14225022494792938, avg_mse: 0.2764511704444885
current test mse: 0.276451
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012008_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012008_3_24hr.npz
NaN value num: 0
Iteration: 1861, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44919583201408386
loss_pred:0.019384687766432762, decouple_loss:0.009305526502430439
The generated pressure mean: 0.4488348960876465
loss_pred:0.018177559599280357, decouple_loss:0.008665905334055424
The generated pressure mean: 0.4483933448791504
loss_pred:0.020612461492419243, decouple_loss:0.00874927919358015
Iteration: 1862, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44808733463287354
loss_pred:0.020176835358142853, decouple_loss:0.008106937631964684
The generated pressure mean: 0.44755062460899353The generated pressure mean: 0.4474886953830719
loss_pred:0.02052685059607029, decouple_loss:0.008455601520836353loss_pred:0.022646605968475342, decouple_loss:0.008571351878345013
Iteration: 1863, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.448968768119812
loss_pred:0.01962278038263321, decouple_loss:0.009078418835997581
The generated pressure mean: 0.44956108927726746
loss_pred:0.020425649359822273, decouple_loss:0.00891348160803318
The generated pressure mean: 0.44702720642089844
loss_pred:0.01957189477980137, decouple_loss:0.008783203549683094
Iteration: 1864, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4497527778148651
loss_pred:0.018776925280690193, decouple_loss:0.008856963366270065
The generated pressure mean: 0.44773247838020325
loss_pred:0.01883709616959095, decouple_loss:0.008479585871100426
The generated pressure mean: 0.4474982023239136
loss_pred:0.021077385172247887, decouple_loss:0.009350650943815708
Iteration: 1865, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4487330913543701
loss_pred:0.020368123427033424, decouple_loss:0.00911830086261034
The generated pressure mean: 0.4487832188606262
loss_pred:0.01992466300725937, decouple_loss:0.008754275739192963
The generated pressure mean: 0.44674795866012573
loss_pred:0.020500339567661285, decouple_loss:0.008734820410609245
Iteration: 1866, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44825032353401184
loss_pred:0.019556710496544838, decouple_loss:0.009445787407457829
The generated pressure mean: 0.44744205474853516
loss_pred:0.019867703318595886, decouple_loss:0.009554016403853893
The generated pressure mean: 0.4500546455383301
loss_pred:0.01924314722418785, decouple_loss:0.009513817727565765
Iteration: 1867, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44908758997917175
loss_pred:0.01920929178595543, decouple_loss:0.008587680757045746
The generated pressure mean: 0.447360634803772
loss_pred:0.02000526525080204, decouple_loss:0.00825384259223938
The generated pressure mean: 0.44770461320877075
loss_pred:0.019500695168972015, decouple_loss:0.007589845918118954
Iteration: 1868, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44914862513542175
loss_pred:0.01952328160405159, decouple_loss:0.008563210256397724
The generated pressure mean: 0.44852158427238464
loss_pred:0.02051369845867157, decouple_loss:0.007700528018176556
The generated pressure mean: 0.44814860820770264
loss_pred:0.0192246176302433, decouple_loss:0.008288616314530373
Iteration: 1869, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44855374097824097
loss_pred:0.01959625817835331, decouple_loss:0.008481083437800407
The generated pressure mean: 0.44795945286750793
loss_pred:0.020236801356077194, decouple_loss:0.008726555854082108
The generated pressure mean: 0.44835543632507324
loss_pred:0.019589241594076157, decouple_loss:0.00852086953818798
Iteration: 1870, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4478404223918915
loss_pred:0.019000008702278137, decouple_loss:0.008526979014277458
The generated pressure mean: 0.44850432872772217
loss_pred:0.02037494070827961, decouple_loss:0.008294995874166489
The generated pressure mean: 0.44777607917785645
loss_pred:0.019745659083127975, decouple_loss:0.008740691468119621
2023-04-16 08:56:23 testing...
The generated pressure mean: 0.4502691328525543
loss_pred:0.1424073874950409, decouple_loss:0.05020299553871155
The generated pressure mean: 0.45032548904418945
loss_pred:0.140986368060112, decouple_loss:0.050419099628925323
The generated pressure mean: 0.4500318169593811
loss_pred:0.141431987285614, decouple_loss:0.05018208548426628
Loss: 0.14412198960781097, avg_mse: 0.2790091633796692
current test mse: 0.279009
Iteration: 1871, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44717904925346375
The generated pressure mean: 0.4474760591983795
The generated pressure mean: 0.4488973617553711loss_pred:0.021439580246806145, decouple_loss:0.008340536616742611
loss_pred:0.01958141289651394, decouple_loss:0.00843442976474762
loss_pred:0.01833365112543106, decouple_loss:0.008550346828997135
Iteration: 1872, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4486876428127289
The generated pressure mean: 0.4489280581474304
loss_pred:0.019465245306491852, decouple_loss:0.008412367664277554
loss_pred:0.019640140235424042, decouple_loss:0.008391006849706173
The generated pressure mean: 0.4483300745487213
loss_pred:0.019080650061368942, decouple_loss:0.008683624677360058
Iteration: 1873, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44793811440467834
loss_pred:0.01997189037501812, decouple_loss:0.007900533266365528
The generated pressure mean: 0.44848987460136414
The generated pressure mean: 0.44867855310440063
loss_pred:0.018835177645087242, decouple_loss:0.007920629344880581
loss_pred:0.01805814914405346, decouple_loss:0.00811333954334259
Iteration: 1874, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44992268085479736
loss_pred:0.01887914165854454, decouple_loss:0.007935771718621254
The generated pressure mean: 0.44701242446899414
loss_pred:0.019850242882966995, decouple_loss:0.008555208332836628
The generated pressure mean: 0.44800934195518494
loss_pred:0.019673658534884453, decouple_loss:0.007787784095853567
Iteration: 1875, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4478435516357422
The generated pressure mean: 0.448231965303421loss_pred:0.01994793489575386, decouple_loss:0.00859794206917286
loss_pred:0.019856978207826614, decouple_loss:0.007964895106852055
The generated pressure mean: 0.44725745916366577
loss_pred:0.019778138026595116, decouple_loss:0.007934186607599258
Iteration: 1876, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44886255264282227
The generated pressure mean: 0.4486183524131775
loss_pred:0.018480123952031136, decouple_loss:0.008274605497717857
loss_pred:0.02040766552090645, decouple_loss:0.007999427616596222
The generated pressure mean: 0.44832369685173035
loss_pred:0.019509416073560715, decouple_loss:0.008013246580958366
Iteration: 1877, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4490479528903961
loss_pred:0.019175924360752106, decouple_loss:0.008666946552693844
The generated pressure mean: 0.44744715094566345
loss_pred:0.020797599107027054, decouple_loss:0.008548733778297901
The generated pressure mean: 0.4503512680530548
loss_pred:0.019563233479857445, decouple_loss:0.009777551516890526
Iteration: 1878, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4495776295661926
loss_pred:0.019292186945676804, decouple_loss:0.008708961308002472
The generated pressure mean: 0.4484765827655792
loss_pred:0.02127131260931492, decouple_loss:0.008750705048441887
The generated pressure mean: 0.4482019245624542
loss_pred:0.021230652928352356, decouple_loss:0.009210643358528614
Iteration: 1879, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4485994577407837
loss_pred:0.019843073561787605, decouple_loss:0.008169383741915226
The generated pressure mean: 0.44854578375816345
loss_pred:0.0206155963242054, decouple_loss:0.008225249126553535
The generated pressure mean: 0.4485609233379364
loss_pred:0.019010130316019058, decouple_loss:0.007993992418050766
Iteration: 1880, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44836854934692383
loss_pred:0.02124140039086342, decouple_loss:0.00876978226006031
The generated pressure mean: 0.44900888204574585
loss_pred:0.019822807982563972, decouple_loss:0.009510528296232224
The generated pressure mean: 0.4481934607028961
loss_pred:0.02132251299917698, decouple_loss:0.009466311894357204
2023-04-16 08:58:29 testing...
The generated pressure mean: 0.4502691626548767
loss_pred:0.14011099934577942, decouple_loss:0.05021904781460762
The generated pressure mean: 0.45032191276550293
loss_pred:0.13876135647296906, decouple_loss:0.050091467797756195
The generated pressure mean: 0.4500294625759125
loss_pred:0.13921229541301727, decouple_loss:0.04984169825911522
Loss: 0.1418640911579132, avg_mse: 0.27468711137771606
current test mse: 0.274687
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012003_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012003_3_24hr.npz
NaN value num: 0
Iteration: 1881, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45052996277809143
loss_pred:0.021871717646718025, decouple_loss:0.0085664177313447
The generated pressure mean: 0.44898757338523865
loss_pred:0.02197316102683544, decouple_loss:0.008536663837730885
The generated pressure mean: 0.44820234179496765
loss_pred:0.020130475983023643, decouple_loss:0.008609691634774208
Iteration: 1882, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.448256254196167
loss_pred:0.019210275262594223, decouple_loss:0.009063443168997765
The generated pressure mean: 0.44862568378448486
loss_pred:0.01934386044740677, decouple_loss:0.009059864096343517
The generated pressure mean: 0.44795137643814087
loss_pred:0.02031336911022663, decouple_loss:0.008795665577054024
Iteration: 1883, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4492354393005371The generated pressure mean: 0.4497608244419098
loss_pred:0.020330477505922318, decouple_loss:0.009066450409591198loss_pred:0.02171454392373562, decouple_loss:0.009186536073684692
The generated pressure mean: 0.448081374168396
loss_pred:0.019728777930140495, decouple_loss:0.00919165275990963
Iteration: 1884, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4479873478412628
loss_pred:0.020657075569033623, decouple_loss:0.008909150026738644
The generated pressure mean: 0.44976648688316345
loss_pred:0.022999325767159462, decouple_loss:0.008963561616837978
The generated pressure mean: 0.44885262846946716
loss_pred:0.021059716120362282, decouple_loss:0.008911103010177612
Iteration: 1885, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44880491495132446
loss_pred:0.02036377415060997, decouple_loss:0.008669374510645866
The generated pressure mean: 0.44830313324928284
loss_pred:0.020152823999524117, decouple_loss:0.009252454154193401
The generated pressure mean: 0.4509533941745758
loss_pred:0.02001042291522026, decouple_loss:0.009084601886570454
Iteration: 1886, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4476814270019531
loss_pred:0.019732121378183365, decouple_loss:0.008743380196392536
The generated pressure mean: 0.44918200373649597
loss_pred:0.02011023461818695, decouple_loss:0.008781594224274158
The generated pressure mean: 0.4479861259460449
loss_pred:0.02325359173119068, decouple_loss:0.008715762756764889
Iteration: 1887, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4486011862754822
loss_pred:0.019966108724474907, decouple_loss:0.009431780315935612
The generated pressure mean: 0.44901707768440247
loss_pred:0.020536381751298904, decouple_loss:0.009302661754190922
The generated pressure mean: 0.4479124844074249
loss_pred:0.01937025412917137, decouple_loss:0.009615538641810417
Iteration: 1888, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44785335659980774
loss_pred:0.020222842693328857, decouple_loss:0.008817750960588455
The generated pressure mean: 0.4489031732082367
loss_pred:0.02199537120759487, decouple_loss:0.008833526633679867
The generated pressure mean: 0.4477221369743347
loss_pred:0.022510765120387077, decouple_loss:0.008773907087743282
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1889, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4481389820575714
loss_pred:0.01978033222258091, decouple_loss:0.00918114185333252
The generated pressure mean: 0.4476791322231293
loss_pred:0.0195417869836092, decouple_loss:0.008867002092301846
The generated pressure mean: 0.44839778542518616
loss_pred:0.020567171275615692, decouple_loss:0.008898217231035233
Iteration: 1890, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45027977228164673
loss_pred:0.02016306109726429, decouple_loss:0.009851892478764057
The generated pressure mean: 0.4493148922920227
loss_pred:0.020964475348591805, decouple_loss:0.009320839308202267
The generated pressure mean: 0.4491617679595947
loss_pred:0.01936962455511093, decouple_loss:0.00934910960495472
2023-04-16 09:01:21 testing...
The generated pressure mean: 0.4502691328525543
loss_pred:0.1374751627445221, decouple_loss:0.04943837970495224
The generated pressure mean: 0.4500279426574707
loss_pred:0.13733544945716858, decouple_loss:0.049054864794015884
The generated pressure mean: 0.4503251612186432
loss_pred:0.1368999183177948, decouple_loss:0.049211978912353516
Loss: 0.13969860970973969, avg_mse: 0.26955655217170715
current test mse: 0.269557
Iteration: 1891, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4483485221862793
The generated pressure mean: 0.44904667139053345
loss_pred:0.023576734587550163, decouple_loss:0.009347980841994286
loss_pred:0.020732497796416283, decouple_loss:0.008983997628092766
The generated pressure mean: 0.4483487904071808
loss_pred:0.020233916118741035, decouple_loss:0.008769964799284935
Iteration: 1892, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4484298527240753
The generated pressure mean: 0.44898468255996704The generated pressure mean: 0.4488625228404999
loss_pred:0.021150054410099983, decouple_loss:0.009530206210911274
loss_pred:0.02140234224498272, decouple_loss:0.009372095577418804
loss_pred:0.020806632936000824, decouple_loss:0.010011697188019753
Iteration: 1893, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4479689598083496
loss_pred:0.019052986055612564, decouple_loss:0.009458180516958237
The generated pressure mean: 0.4477818012237549
loss_pred:0.021323228254914284, decouple_loss:0.009198171086609364The generated pressure mean: 0.4492783546447754
loss_pred:0.02003226801753044, decouple_loss:0.009096530266106129
Iteration: 1894, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44882696866989136
loss_pred:0.02031928300857544, decouple_loss:0.009145531803369522
The generated pressure mean: 0.44918233156204224
loss_pred:0.020417019724845886, decouple_loss:0.009171897545456886
The generated pressure mean: 0.44842085242271423
loss_pred:0.02006300538778305, decouple_loss:0.00891441572457552
Iteration: 1895, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4486684203147888
The generated pressure mean: 0.448932945728302loss_pred:0.01941494643688202, decouple_loss:0.009254474192857742
loss_pred:0.022816326469182968, decouple_loss:0.009828313253819942
The generated pressure mean: 0.4485110640525818
loss_pred:0.02044568583369255, decouple_loss:0.009327970445156097
Iteration: 1896, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4481777846813202
The generated pressure mean: 0.4488203227519989loss_pred:0.020529842004179955, decouple_loss:0.008640873245894909
loss_pred:0.020134318619966507, decouple_loss:0.008903523907065392
The generated pressure mean: 0.44878900051116943
loss_pred:0.022096851840615273, decouple_loss:0.008959377184510231
Iteration: 1897, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45008403062820435
loss_pred:0.020438119769096375, decouple_loss:0.008966363035142422
The generated pressure mean: 0.44809168577194214
loss_pred:0.020062632858753204, decouple_loss:0.009282748214900494
The generated pressure mean: 0.44811776280403137
loss_pred:0.019164403900504112, decouple_loss:0.009145817719399929
Iteration: 1898, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.447770357131958
The generated pressure mean: 0.44898587465286255
loss_pred:0.02158387564122677, decouple_loss:0.009029926732182503
loss_pred:0.02063208818435669, decouple_loss:0.008776620961725712
The generated pressure mean: 0.44909313321113586
loss_pred:0.019935032352805138, decouple_loss:0.008718294091522694
Iteration: 1899, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4487118422985077
loss_pred:0.019720006734132767, decouple_loss:0.009070239961147308
The generated pressure mean: 0.44795095920562744
loss_pred:0.020294375717639923, decouple_loss:0.00909404270350933
The generated pressure mean: 0.4500303864479065
loss_pred:0.020432503893971443, decouple_loss:0.009051107801496983
Iteration: 1900, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4487389624118805The generated pressure mean: 0.4486149847507477
loss_pred:0.02125008963048458, decouple_loss:0.009321504272520542loss_pred:0.020702887326478958, decouple_loss:0.008844355121254921
The generated pressure mean: 0.44828855991363525
loss_pred:0.021183792501688004, decouple_loss:0.008750778622925282
2023-04-16 09:03:27 testing...
The generated pressure mean: 0.4502691626548767
loss_pred:0.13926883041858673, decouple_loss:0.049768127501010895
The generated pressure mean: 0.450324684381485
loss_pred:0.13852886855602264, decouple_loss:0.05003528669476509
The generated pressure mean: 0.45003020763397217
loss_pred:0.13897821307182312, decouple_loss:0.049626678228378296
Loss: 0.1414158046245575, avg_mse: 0.2731453478336334
current test mse: 0.273145
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012001_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012001_3_24hr.npz
NaN value num: 0
Iteration: 1901, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44824936985969543
loss_pred:0.020054150372743607, decouple_loss:0.008667693473398685
The generated pressure mean: 0.4486878216266632
loss_pred:0.020713506266474724, decouple_loss:0.008877995423972607
The generated pressure mean: 0.4476655125617981
loss_pred:0.01997216045856476, decouple_loss:0.008735558949410915
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1902, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44840019941329956
loss_pred:0.02069682627916336, decouple_loss:0.00863080658018589
The generated pressure mean: 0.44852879643440247
loss_pred:0.018369577825069427, decouple_loss:0.008786131627857685
The generated pressure mean: 0.4476589858531952
loss_pred:0.018825065344572067, decouple_loss:0.00869869627058506
Iteration: 1903, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44696661829948425
loss_pred:0.021190611645579338, decouple_loss:0.008626419119536877
The generated pressure mean: 0.44872552156448364
loss_pred:0.019237764179706573, decouple_loss:0.008424888364970684
The generated pressure mean: 0.446585088968277
loss_pred:0.02027101069688797, decouple_loss:0.008355810306966305
Iteration: 1904, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4468025267124176
loss_pred:0.021366527304053307, decouple_loss:0.007940886542201042
The generated pressure mean: 0.44923242926597595
loss_pred:0.020339608192443848, decouple_loss:0.008470810018479824
The generated pressure mean: 0.44874635338783264
loss_pred:0.020815344527363777, decouple_loss:0.008131233975291252
Iteration: 1905, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4484401345252991
The generated pressure mean: 0.4470182955265045
loss_pred:0.019460545852780342, decouple_loss:0.008732035756111145
loss_pred:0.021160881966352463, decouple_loss:0.009146403521299362
The generated pressure mean: 0.447333961725235
loss_pred:0.020547861233353615, decouple_loss:0.008927018381655216
Iteration: 1906, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44631609320640564
The generated pressure mean: 0.4486176073551178loss_pred:0.020197762176394463, decouple_loss:0.008565690368413925
loss_pred:0.02086818963289261, decouple_loss:0.008596867322921753
The generated pressure mean: 0.447815865278244
loss_pred:0.01928151585161686, decouple_loss:0.008419781923294067
Iteration: 1907, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4475954473018646
The generated pressure mean: 0.4487268626689911
loss_pred:0.020225849002599716, decouple_loss:0.010230240412056446
loss_pred:0.019139761105179787, decouple_loss:0.010570359416306019
The generated pressure mean: 0.44813084602355957
loss_pred:0.021579330787062645, decouple_loss:0.010642136447131634
Iteration: 1908, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.447194367647171
loss_pred:0.01963750645518303, decouple_loss:0.008774652145802975
The generated pressure mean: 0.4491841793060303
loss_pred:0.019614238291978836, decouple_loss:0.008745850995182991
The generated pressure mean: 0.4484805166721344
loss_pred:0.018535569310188293, decouple_loss:0.00966267753392458
Iteration: 1909, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.449389785528183
loss_pred:0.019790463149547577, decouple_loss:0.00848094467073679
The generated pressure mean: 0.4478071331977844
loss_pred:0.019023781642317772, decouple_loss:0.008237512782216072
The generated pressure mean: 0.449007511138916
loss_pred:0.018906187266111374, decouple_loss:0.008729377761483192
Iteration: 1910, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44787952303886414
loss_pred:0.019305700436234474, decouple_loss:0.008390789851546288
The generated pressure mean: 0.44751808047294617
loss_pred:0.021597808226943016, decouple_loss:0.008432072587311268
The generated pressure mean: 0.44958531856536865
loss_pred:0.019286591559648514, decouple_loss:0.008515477180480957
2023-04-16 09:06:14 testing...
The generated pressure mean: 0.4502691328525543
loss_pred:0.13818958401679993, decouple_loss:0.049784187227487564
The generated pressure mean: 0.4503229856491089
loss_pred:0.1372045874595642, decouple_loss:0.05033876374363899
The generated pressure mean: 0.4500318467617035
loss_pred:0.13744831085205078, decouple_loss:0.049447137862443924
Loss: 0.14010700583457947, avg_mse: 0.27111053466796875
current test mse: 0.271111
Iteration: 1911, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44823649525642395
The generated pressure mean: 0.4474484622478485
loss_pred:0.01865948736667633, decouple_loss:0.008756754919886589
loss_pred:0.020324425771832466, decouple_loss:0.008495127782225609
The generated pressure mean: 0.44832611083984375
loss_pred:0.02098792977631092, decouple_loss:0.008389038033783436
Iteration: 1912, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44801029562950134
The generated pressure mean: 0.44726359844207764loss_pred:0.019346708431839943, decouple_loss:0.00948137603700161
The generated pressure mean: 0.44936975836753845
loss_pred:0.020676396787166595, decouple_loss:0.009277354925870895
loss_pred:0.019637135788798332, decouple_loss:0.009448474273085594
Iteration: 1913, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4471641182899475
loss_pred:0.020992450416088104, decouple_loss:0.008938870392739773
The generated pressure mean: 0.44705435633659363
The generated pressure mean: 0.4466077983379364
loss_pred:0.0218141321092844, decouple_loss:0.008796900510787964
loss_pred:0.01955987885594368, decouple_loss:0.008746263571083546
Iteration: 1914, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4475676417350769
The generated pressure mean: 0.4480739235877991
loss_pred:0.019123723730444908, decouple_loss:0.009166122414171696
loss_pred:0.01950650103390217, decouple_loss:0.008578749373555183
The generated pressure mean: 0.44723808765411377
loss_pred:0.021762235090136528, decouple_loss:0.008745596744120121
Iteration: 1915, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44764065742492676
The generated pressure mean: 0.44780001044273376
loss_pred:0.02090376429259777, decouple_loss:0.009400911629199982
loss_pred:0.02018817700445652, decouple_loss:0.008496475405991077
The generated pressure mean: 0.4469641447067261
loss_pred:0.022388046607375145, decouple_loss:0.009578455239534378
Iteration: 1916, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4465446174144745
loss_pred:0.021533094346523285, decouple_loss:0.009393560700118542
The generated pressure mean: 0.4485718011856079
loss_pred:0.022131724283099174, decouple_loss:0.009342390112578869
The generated pressure mean: 0.4488254189491272
loss_pred:0.019911909475922585, decouple_loss:0.009654110297560692
Iteration: 1917, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44938138127326965
The generated pressure mean: 0.4461503326892853loss_pred:0.02141483500599861, decouple_loss:0.009285349398851395
loss_pred:0.021905608475208282, decouple_loss:0.009447705931961536
The generated pressure mean: 0.4486084282398224
loss_pred:0.021951353177428246, decouple_loss:0.009485139511525631
Iteration: 1918, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44828084111213684
loss_pred:0.020041916519403458, decouple_loss:0.00853756908327341
The generated pressure mean: 0.44883784651756287
loss_pred:0.02024547941982746, decouple_loss:0.008877109736204147
The generated pressure mean: 0.44672805070877075
loss_pred:0.02105124481022358, decouple_loss:0.008525504730641842
Iteration: 1919, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44892555475234985
loss_pred:0.021377773955464363, decouple_loss:0.009400081820786
The generated pressure mean: 0.4478653073310852
loss_pred:0.021737322211265564, decouple_loss:0.009454461745917797
The generated pressure mean: 0.4458082616329193
loss_pred:0.019634054973721504, decouple_loss:0.009917404502630234
Iteration: 1920, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44710731506347656
loss_pred:0.02051859349012375, decouple_loss:0.008507544174790382
The generated pressure mean: 0.4478653371334076
loss_pred:0.020293060690164566, decouple_loss:0.00889577716588974
The generated pressure mean: 0.4477754235267639
loss_pred:0.021436529234051704, decouple_loss:0.008793709799647331
2023-04-16 09:08:19 testing...
The generated pressure mean: 0.4502691626548767
loss_pred:0.1367095559835434, decouple_loss:0.04851216450333595
The generated pressure mean: 0.4503280818462372
loss_pred:0.13529908657073975, decouple_loss:0.04910911247134209
The generated pressure mean: 0.4500315189361572
loss_pred:0.13595212996006012, decouple_loss:0.04873795062303543
Loss: 0.13842624425888062, avg_mse: 0.26494842767715454
current test mse: 0.264948
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012013_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012013_3_24hr.npz
NaN value num: 0
Iteration: 1921, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.448106050491333
loss_pred:0.0209159217774868, decouple_loss:0.009024075232446194
The generated pressure mean: 0.44735538959503174
loss_pred:0.020242005586624146, decouple_loss:0.008992578834295273
The generated pressure mean: 0.4478146433830261
loss_pred:0.019915880635380745, decouple_loss:0.008790076710283756
Iteration: 1922, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4468192756175995
loss_pred:0.021325403824448586, decouple_loss:0.008479374460875988
The generated pressure mean: 0.447530061006546
The generated pressure mean: 0.4485245645046234
loss_pred:0.020197046920657158, decouple_loss:0.008685783483088017
loss_pred:0.022471735253930092, decouple_loss:0.009021085686981678
Iteration: 1923, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.447158545255661
loss_pred:0.021951911970973015, decouple_loss:0.009545320644974709
The generated pressure mean: 0.44808343052864075
loss_pred:0.02108343504369259, decouple_loss:0.009015071205794811
The generated pressure mean: 0.44616439938545227
loss_pred:0.019627301022410393, decouple_loss:0.009109921753406525
Iteration: 1924, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4476611614227295
loss_pred:0.02003263123333454, decouple_loss:0.00861270260065794
The generated pressure mean: 0.4471907913684845
loss_pred:0.022134525701403618, decouple_loss:0.009068604558706284
The generated pressure mean: 0.4475894868373871
loss_pred:0.02108498103916645, decouple_loss:0.00863124430179596
Iteration: 1925, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4463886618614197
loss_pred:0.020588386803865433, decouple_loss:0.009135584346950054
The generated pressure mean: 0.4475655257701874
loss_pred:0.021260658279061317, decouple_loss:0.00900051835924387
The generated pressure mean: 0.44717660546302795
loss_pred:0.021733151748776436, decouple_loss:0.008942095562815666
Iteration: 1926, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4462363123893738
loss_pred:0.020454389974474907, decouple_loss:0.008891573175787926
The generated pressure mean: 0.44665199518203735
loss_pred:0.021851245313882828, decouple_loss:0.008614197373390198
The generated pressure mean: 0.44688117504119873
loss_pred:0.01941496692597866, decouple_loss:0.00898374617099762
Iteration: 1927, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4472620189189911
loss_pred:0.020854320377111435, decouple_loss:0.008683828637003899
The generated pressure mean: 0.44710221886634827
loss_pred:0.01981321908533573, decouple_loss:0.008553688414394855
The generated pressure mean: 0.44802987575531006
loss_pred:0.02134423516690731, decouple_loss:0.008739602752029896
Iteration: 1928, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44754794239997864
loss_pred:0.019976550713181496, decouple_loss:0.008097737096250057
The generated pressure mean: 0.44669219851493835
loss_pred:0.02156575582921505, decouple_loss:0.008204727433621883
The generated pressure mean: 0.4477737247943878
loss_pred:0.019772954285144806, decouple_loss:0.008343477733433247
Iteration: 1929, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44712120294570923
The generated pressure mean: 0.4483082592487335loss_pred:0.020151201635599136, decouple_loss:0.008402308449149132
loss_pred:0.020860956981778145, decouple_loss:0.008459816686809063
The generated pressure mean: 0.4471132159233093
loss_pred:0.020423900336027145, decouple_loss:0.008771365508437157
Iteration: 1930, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4470791518688202The generated pressure mean: 0.44818997383117676
loss_pred:0.02146134153008461, decouple_loss:0.00825759768486023loss_pred:0.020361196249723434, decouple_loss:0.008227366954088211
The generated pressure mean: 0.44816383719444275
loss_pred:0.021609095856547356, decouple_loss:0.008209073916077614
2023-04-16 09:11:00 testing...
The generated pressure mean: 0.4502691626548767
loss_pred:0.1372780203819275, decouple_loss:0.04974288120865822
The generated pressure mean: 0.4503251016139984
loss_pred:0.13635693490505219, decouple_loss:0.050186678767204285
The generated pressure mean: 0.45003005862236023
loss_pred:0.13674236834049225, decouple_loss:0.04978006333112717
Loss: 0.13928762078285217, avg_mse: 0.26801756024360657
current test mse: 0.268018
Iteration: 1931, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.447792112827301
loss_pred:0.021767321974039078, decouple_loss:0.008971995674073696
The generated pressure mean: 0.44706064462661743
loss_pred:0.019875457510352135, decouple_loss:0.008876742795109749
The generated pressure mean: 0.44631683826446533
loss_pred:0.021636418998241425, decouple_loss:0.008664002642035484
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1932, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4478301703929901
loss_pred:0.0210628230124712, decouple_loss:0.009410914964973927
The generated pressure mean: 0.447295606136322
loss_pred:0.024148233234882355, decouple_loss:0.010343815200030804
The generated pressure mean: 0.4478220045566559
loss_pred:0.01947653293609619, decouple_loss:0.008949785493314266
Iteration: 1933, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44731754064559937
loss_pred:0.022573843598365784, decouple_loss:0.010007323697209358
The generated pressure mean: 0.4475491940975189
The generated pressure mean: 0.44817984104156494loss_pred:0.019999822601675987, decouple_loss:0.009453942999243736
loss_pred:0.021233221516013145, decouple_loss:0.009209545329213142
Iteration: 1934, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44709229469299316
loss_pred:0.02124345861375332, decouple_loss:0.008060003630816936
The generated pressure mean: 0.44682925939559937
loss_pred:0.02274622768163681, decouple_loss:0.007900268770754337
The generated pressure mean: 0.44804370403289795
loss_pred:0.01853240095078945, decouple_loss:0.007885054685175419
Iteration: 1935, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4479770064353943
loss_pred:0.022995050996541977, decouple_loss:0.00842583179473877
The generated pressure mean: 0.4476834833621979
loss_pred:0.021562794223427773, decouple_loss:0.008884181268513203
The generated pressure mean: 0.44680196046829224
loss_pred:0.0194949172437191, decouple_loss:0.009287316352128983
Iteration: 1936, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4475450813770294
loss_pred:0.021268853917717934, decouple_loss:0.008282775059342384
The generated pressure mean: 0.4472237229347229
loss_pred:0.020055124536156654, decouple_loss:0.008435342460870743
The generated pressure mean: 0.4484233558177948
loss_pred:0.020630059763789177, decouple_loss:0.008176218718290329
Iteration: 1937, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4473491311073303
loss_pred:0.021072156727313995, decouple_loss:0.008625100366771221
The generated pressure mean: 0.447936475276947
loss_pred:0.02087532728910446, decouple_loss:0.008582227863371372
The generated pressure mean: 0.4469206631183624
loss_pred:0.01969902031123638, decouple_loss:0.008709458634257317
Iteration: 1938, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44683972001075745
The generated pressure mean: 0.4476322531700134
loss_pred:0.019178438931703568, decouple_loss:0.008640753105282784
loss_pred:0.019773853942751884, decouple_loss:0.008699407801032066
The generated pressure mean: 0.44724005460739136
loss_pred:0.020162558183073997, decouple_loss:0.008849570527672768
Iteration: 1939, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44761723279953003
loss_pred:0.020038530230522156, decouple_loss:0.008200449869036674
The generated pressure mean: 0.4482899606227875
loss_pred:0.02028547041118145, decouple_loss:0.00815905537456274
The generated pressure mean: 0.4481433629989624
loss_pred:0.019113322719931602, decouple_loss:0.008199800737202168
Iteration: 1940, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44656169414520264
loss_pred:0.019991539418697357, decouple_loss:0.008457367308437824
The generated pressure mean: 0.44647836685180664
loss_pred:0.020990118384361267, decouple_loss:0.008826060220599174
The generated pressure mean: 0.4469583034515381
loss_pred:0.02057279460132122, decouple_loss:0.008347105234861374
2023-04-16 09:13:06 testing...
The generated pressure mean: 0.4502691626548767
loss_pred:0.1361192762851715, decouple_loss:0.049245066940784454
The generated pressure mean: 0.4500311017036438
loss_pred:0.13513650000095367, decouple_loss:0.048916079103946686
The generated pressure mean: 0.4503239095211029
loss_pred:0.13475219905376434, decouple_loss:0.04924729838967323
Loss: 0.13779281079769135, avg_mse: 0.2635594308376312
current test mse: 0.263559
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012002_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012002_3_24hr.npz
NaN value num: 0
Iteration: 1941, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44913631677627563
loss_pred:0.02005109190940857, decouple_loss:0.008431179448962212
The generated pressure mean: 0.44784149527549744
loss_pred:0.018522731959819794, decouple_loss:0.009071273729205132
The generated pressure mean: 0.4492011070251465
loss_pred:0.01807168498635292, decouple_loss:0.009807662107050419
Iteration: 1942, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4484297037124634
loss_pred:0.021062737330794334, decouple_loss:0.009143814444541931
The generated pressure mean: 0.4496476948261261
loss_pred:0.019282570108771324, decouple_loss:0.009716954082250595
The generated pressure mean: 0.4492700397968292
loss_pred:0.01974155195057392, decouple_loss:0.009867115877568722
Iteration: 1943, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44827136397361755
loss_pred:0.020713556557893753, decouple_loss:0.008921601809561253
The generated pressure mean: 0.44895127415657043
loss_pred:0.019532296806573868, decouple_loss:0.008850504644215107
The generated pressure mean: 0.44868966937065125
loss_pred:0.01957845315337181, decouple_loss:0.009177122265100479
Iteration: 1944, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4474884867668152
loss_pred:0.019535187631845474, decouple_loss:0.008895077742636204
The generated pressure mean: 0.4481222629547119
loss_pred:0.019974086433649063, decouple_loss:0.008688743226230145
The generated pressure mean: 0.45052996277809143
loss_pred:0.020487798377871513, decouple_loss:0.009132119826972485
Iteration: 1945, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4492013156414032
loss_pred:0.01895914413034916, decouple_loss:0.009682119823992252
The generated pressure mean: 0.448556125164032
loss_pred:0.01809270679950714, decouple_loss:0.009367533028125763
The generated pressure mean: 0.4478432834148407
loss_pred:0.020184703171253204, decouple_loss:0.01013130135834217
Iteration: 1946, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4495082497596741
loss_pred:0.01991199143230915, decouple_loss:0.009596762247383595
The generated pressure mean: 0.4495804011821747
loss_pred:0.017263758927583694, decouple_loss:0.009473763406276703
The generated pressure mean: 0.44951674342155457
loss_pred:0.020744314417243004, decouple_loss:0.00946967862546444
Iteration: 1947, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44942131638526917
loss_pred:0.018051253631711006, decouple_loss:0.008835401386022568
The generated pressure mean: 0.4478306472301483
loss_pred:0.02018686942756176, decouple_loss:0.008823626674711704
The generated pressure mean: 0.45029395818710327
loss_pred:0.019299810752272606, decouple_loss:0.008898827247321606
Iteration: 1948, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44929999113082886
loss_pred:0.019399138167500496, decouple_loss:0.00827206950634718
The generated pressure mean: 0.44726794958114624
loss_pred:0.019931050017476082, decouple_loss:0.008585824631154537
The generated pressure mean: 0.45061105489730835
loss_pred:0.01882173679769039, decouple_loss:0.00835178792476654
Iteration: 1949, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4489397406578064
loss_pred:0.0186189953237772, decouple_loss:0.008175949566066265
The generated pressure mean: 0.44823694229125977
loss_pred:0.020719749853014946, decouple_loss:0.007974539883434772
The generated pressure mean: 0.4513237178325653
loss_pred:0.01909959316253662, decouple_loss:0.00877660233527422
Iteration: 1950, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4473637640476227
loss_pred:0.019699472934007645, decouple_loss:0.009595604613423347
The generated pressure mean: 0.4480063319206238
loss_pred:0.019679835066199303, decouple_loss:0.008468784391880035
The generated pressure mean: 0.4479590356349945
loss_pred:0.01893153227865696, decouple_loss:0.008557875640690327
2023-04-16 09:15:48 testing...
The generated pressure mean: 0.4502691328525543
loss_pred:0.13666197657585144, decouple_loss:0.0510314404964447
The generated pressure mean: 0.45032596588134766
loss_pred:0.13510319590568542, decouple_loss:0.05095604807138443
The generated pressure mean: 0.4500322937965393
loss_pred:0.13556228578090668, decouple_loss:0.050506316125392914
Loss: 0.13831737637519836, avg_mse: 0.2673714756965637
current test mse: 0.267371
Iteration: 1951, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44946423172950745
loss_pred:0.019056683406233788, decouple_loss:0.00825028121471405
The generated pressure mean: 0.45037275552749634
loss_pred:0.019807595759630203, decouple_loss:0.008299815468490124
The generated pressure mean: 0.44876790046691895
loss_pred:0.020873375236988068, decouple_loss:0.00816323421895504
Iteration: 1952, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4487670958042145
loss_pred:0.019254880025982857, decouple_loss:0.00803722720593214
The generated pressure mean: 0.44965583086013794
loss_pred:0.01885392516851425, decouple_loss:0.008857767097651958
The generated pressure mean: 0.4489671289920807
loss_pred:0.020395712926983833, decouple_loss:0.008137404918670654
Iteration: 1953, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44813093543052673
loss_pred:0.020573221147060394, decouple_loss:0.008500312454998493
The generated pressure mean: 0.44937944412231445
loss_pred:0.0196437519043684, decouple_loss:0.009211353957653046
The generated pressure mean: 0.44823357462882996
loss_pred:0.018836382776498795, decouple_loss:0.008848106488585472
Iteration: 1954, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44897496700286865
loss_pred:0.020503584295511246, decouple_loss:0.00797265861183405
The generated pressure mean: 0.44877099990844727
loss_pred:0.020715588703751564, decouple_loss:0.008573810569941998
The generated pressure mean: 0.44865065813064575
loss_pred:0.020030809566378593, decouple_loss:0.00884094275534153
Iteration: 1955, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.448991060256958
loss_pred:0.02202233299612999, decouple_loss:0.008212802931666374
The generated pressure mean: 0.4494774639606476
loss_pred:0.019372260197997093, decouple_loss:0.008776315487921238
The generated pressure mean: 0.44798994064331055
loss_pred:0.019991803914308548, decouple_loss:0.008511459454894066
Iteration: 1956, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45076677203178406
loss_pred:0.017588689923286438, decouple_loss:0.00872893538326025
The generated pressure mean: 0.4480706453323364
loss_pred:0.01915314793586731, decouple_loss:0.00865471363067627
The generated pressure mean: 0.44992855191230774
loss_pred:0.01901502162218094, decouple_loss:0.009628619998693466
Iteration: 1957, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44852709770202637
loss_pred:0.02064620703458786, decouple_loss:0.008741605095565319
The generated pressure mean: 0.4484265148639679
loss_pred:0.02079276740550995, decouple_loss:0.008688895031809807
The generated pressure mean: 0.4522303640842438
loss_pred:0.019023219123482704, decouple_loss:0.009141018614172935
Iteration: 1958, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44799962639808655
loss_pred:0.01996070146560669, decouple_loss:0.007991692051291466
The generated pressure mean: 0.4496976137161255
loss_pred:0.01805889420211315, decouple_loss:0.0077859386801719666
The generated pressure mean: 0.45032864809036255
loss_pred:0.01828455738723278, decouple_loss:0.007765436079353094
Iteration: 1959, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44973331689834595
loss_pred:0.018528304994106293, decouple_loss:0.007900322787463665
The generated pressure mean: 0.4476865828037262
loss_pred:0.02031104452908039, decouple_loss:0.00844648014754057
The generated pressure mean: 0.4479213058948517
loss_pred:0.01921377331018448, decouple_loss:0.00773844588547945
Iteration: 1960, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45033204555511475
loss_pred:0.019823703914880753, decouple_loss:0.008129499852657318
The generated pressure mean: 0.4493311047554016
loss_pred:0.0200270414352417, decouple_loss:0.008145108819007874
The generated pressure mean: 0.4501849114894867
loss_pred:0.019350795075297356, decouple_loss:0.008040538989007473
2023-04-16 09:17:55 testing...
The generated pressure mean: 0.4502691626548767
loss_pred:0.1394820660352707, decouple_loss:0.050267934799194336
The generated pressure mean: 0.4503248929977417
loss_pred:0.1377324014902115, decouple_loss:0.05027344822883606
The generated pressure mean: 0.450030654668808
loss_pred:0.13824723660945892, decouple_loss:0.050246383994817734
Loss: 0.14100036025047302, avg_mse: 0.2731785476207733
current test mse: 0.273179
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012016_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012016_3_24hr.npz
NaN value num: 0
Iteration: 1961, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44734442234039307
loss_pred:0.019671572372317314, decouple_loss:0.008265617303550243
The generated pressure mean: 0.44916024804115295
loss_pred:0.020898696035146713, decouple_loss:0.008623710833489895
The generated pressure mean: 0.4476741552352905
loss_pred:0.02075996622443199, decouple_loss:0.008372117765247822
Iteration: 1962, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4486088156700134
loss_pred:0.02016454190015793, decouple_loss:0.008319711312651634
The generated pressure mean: 0.44777360558509827
The generated pressure mean: 0.4477640688419342
loss_pred:0.02043198235332966, decouple_loss:0.008299105800688267
loss_pred:0.021465972065925598, decouple_loss:0.008088493719696999
Iteration: 1963, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44755738973617554
loss_pred:0.022812528535723686, decouple_loss:0.0085188252851367
The generated pressure mean: 0.447592556476593
loss_pred:0.02127126418054104, decouple_loss:0.007903605699539185
The generated pressure mean: 0.44711703062057495
loss_pred:0.019971413537859917, decouple_loss:0.008070024661719799
Iteration: 1964, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44772636890411377
loss_pred:0.021744925528764725, decouple_loss:0.009851764887571335
The generated pressure mean: 0.4479111135005951
loss_pred:0.02097035013139248, decouple_loss:0.00912398286163807
The generated pressure mean: 0.44823822379112244
loss_pred:0.020305434241890907, decouple_loss:0.009319240227341652
Iteration: 1965, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4478711783885956
loss_pred:0.020356979221105576, decouple_loss:0.009507139213383198
The generated pressure mean: 0.447536826133728
loss_pred:0.020983099937438965, decouple_loss:0.009690733626484871
The generated pressure mean: 0.449163019657135
loss_pred:0.021052245050668716, decouple_loss:0.010020260699093342
Iteration: 1966, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44775405526161194
loss_pred:0.021243639290332794, decouple_loss:0.008627627976238728
The generated pressure mean: 0.4483662545681
loss_pred:0.02033133991062641, decouple_loss:0.008205793797969818
The generated pressure mean: 0.4478048086166382
loss_pred:0.021930767223238945, decouple_loss:0.008592125959694386
Iteration: 1967, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4477578401565552
loss_pred:0.023401718586683273, decouple_loss:0.008858698420226574
The generated pressure mean: 0.44809770584106445
loss_pred:0.021667081862688065, decouple_loss:0.008698380552232265
The generated pressure mean: 0.4483368694782257
loss_pred:0.022128112614154816, decouple_loss:0.008778948336839676
Iteration: 1968, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44817054271698
loss_pred:0.022978371009230614, decouple_loss:0.0093968091532588
The generated pressure mean: 0.44789713621139526
loss_pred:0.022057903930544853, decouple_loss:0.0089297816157341
The generated pressure mean: 0.44776394963264465
loss_pred:0.025008659809827805, decouple_loss:0.0089644193649292
Iteration: 1969, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44823795557022095
loss_pred:0.025400152429938316, decouple_loss:0.009648633189499378
The generated pressure mean: 0.44858017563819885
loss_pred:0.024375062435865402, decouple_loss:0.009713389910757542
The generated pressure mean: 0.4476526081562042
loss_pred:0.024399006739258766, decouple_loss:0.009940573014318943
Iteration: 1970, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44806352257728577
loss_pred:0.021773312240839005, decouple_loss:0.012505875900387764
The generated pressure mean: 0.4482056498527527
loss_pred:0.020190924406051636, decouple_loss:0.012154201045632362
The generated pressure mean: 0.44722646474838257
loss_pred:0.021891796961426735, decouple_loss:0.012155845761299133
2023-04-16 09:20:37 testing...
The generated pressure mean: 0.4502691328525543
loss_pred:0.13619865477085114, decouple_loss:0.04828015714883804
The generated pressure mean: 0.45032113790512085
loss_pred:0.13477103412151337, decouple_loss:0.04888560622930527
The generated pressure mean: 0.45003095269203186
loss_pred:0.13504943251609802, decouple_loss:0.04833856225013733
Loss: 0.13776478171348572, avg_mse: 0.2628656029701233
current test mse: 0.262866
Iteration: 1971, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44803258776664734
loss_pred:0.021491767838597298, decouple_loss:0.010493704117834568
The generated pressure mean: 0.44792914390563965
loss_pred:0.020823942497372627, decouple_loss:0.010725878179073334
The generated pressure mean: 0.44784051179885864
loss_pred:0.021515406668186188, decouple_loss:0.010412094183266163
Iteration: 1972, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44842836260795593
loss_pred:0.0208453182131052, decouple_loss:0.012007043696939945
The generated pressure mean: 0.4468505382537842
loss_pred:0.02030026726424694, decouple_loss:0.012142118997871876
The generated pressure mean: 0.4487150311470032
loss_pred:0.020713692530989647, decouple_loss:0.012317233718931675
Iteration: 1973, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44787099957466125
loss_pred:0.0220956951379776, decouple_loss:0.010927783325314522
The generated pressure mean: 0.44838857650756836
loss_pred:0.02086099423468113, decouple_loss:0.010660338215529919
The generated pressure mean: 0.4474897086620331
loss_pred:0.022266199812293053, decouple_loss:0.01061378512531519
Iteration: 1974, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4483640491962433
loss_pred:0.022210342809557915, decouple_loss:0.011004777625203133
The generated pressure mean: 0.44796478748321533
loss_pred:0.022516660392284393, decouple_loss:0.01113896630704403
The generated pressure mean: 0.4480602443218231
loss_pred:0.022344643250107765, decouple_loss:0.011321681551635265
Iteration: 1975, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44801923632621765
loss_pred:0.021345948800444603, decouple_loss:0.011528654024004936
The generated pressure mean: 0.4481002986431122
loss_pred:0.020935799926519394, decouple_loss:0.011664914898574352
The generated pressure mean: 0.44833606481552124
loss_pred:0.020632082596421242, decouple_loss:0.012017738074064255
Iteration: 1976, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44818297028541565
loss_pred:0.02213851362466812, decouple_loss:0.0105740986764431
The generated pressure mean: 0.4480999708175659
loss_pred:0.020783592015504837, decouple_loss:0.010406902059912682
The generated pressure mean: 0.4468798041343689
loss_pred:0.0203869491815567, decouple_loss:0.010533243417739868
Iteration: 1977, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44848230481147766
loss_pred:0.020680444315075874, decouple_loss:0.012349249795079231
The generated pressure mean: 0.4481610059738159
loss_pred:0.02017749659717083, decouple_loss:0.012262393720448017
The generated pressure mean: 0.44658714532852173
loss_pred:0.019512582570314407, decouple_loss:0.012180059216916561
Iteration: 1978, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4476921856403351
loss_pred:0.02007623016834259, decouple_loss:0.01025321800261736
The generated pressure mean: 0.44812947511672974
loss_pred:0.021872367709875107, decouple_loss:0.010535919107496738
The generated pressure mean: 0.448314905166626
loss_pred:0.021706126630306244, decouple_loss:0.010536618530750275
Iteration: 1979, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44819340109825134
loss_pred:0.021633582189679146, decouple_loss:0.010703700594604015
The generated pressure mean: 0.44870486855506897
loss_pred:0.021004924550652504, decouple_loss:0.01110118068754673
The generated pressure mean: 0.4489031732082367
loss_pred:0.02151859924197197, decouple_loss:0.010809872299432755
Iteration: 1980, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4473891258239746
loss_pred:0.019830018281936646, decouple_loss:0.010906627401709557
The generated pressure mean: 0.4481108486652374
loss_pred:0.021883772686123848, decouple_loss:0.010634440928697586
The generated pressure mean: 0.4482950270175934
loss_pred:0.022706009447574615, decouple_loss:0.010839724913239479
2023-04-16 09:22:43 testing...
The generated pressure mean: 0.4502691328525543
loss_pred:0.13934502005577087, decouple_loss:0.05297999456524849
The generated pressure mean: 0.450320303440094
loss_pred:0.1382458657026291, decouple_loss:0.052993472665548325
The generated pressure mean: 0.4500313103199005
loss_pred:0.13916616141796112, decouple_loss:0.052743565291166306
Loss: 0.1415642946958542, avg_mse: 0.2742059826850891
current test mse: 0.274206
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012006_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012006_3_24hr.npz
NaN value num: 0
Iteration: 1981, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44897615909576416
loss_pred:0.020249582827091217, decouple_loss:0.009534441865980625
The generated pressure mean: 0.45076873898506165
loss_pred:0.020203525200486183, decouple_loss:0.01049385778605938
The generated pressure mean: 0.4484187960624695
loss_pred:0.019735729321837425, decouple_loss:0.009495304897427559
Iteration: 1982, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44980114698410034
loss_pred:0.020586438477039337, decouple_loss:0.009300211444497108
The generated pressure mean: 0.44952327013015747
loss_pred:0.021114112809300423, decouple_loss:0.009653433226048946
The generated pressure mean: 0.45001420378685
loss_pred:0.020990237593650818, decouple_loss:0.009720662608742714
Iteration: 1983, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44939368963241577
loss_pred:0.020075684413313866, decouple_loss:0.00947650894522667
The generated pressure mean: 0.4489242732524872
loss_pred:0.02139778807759285, decouple_loss:0.009393993765115738
The generated pressure mean: 0.44916194677352905
loss_pred:0.020276082679629326, decouple_loss:0.009741292335093021
Iteration: 1984, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44801899790763855
loss_pred:0.019980181008577347, decouple_loss:0.009638208895921707
The generated pressure mean: 0.45002520084381104
loss_pred:0.020228130742907524, decouple_loss:0.009545614011585712
The generated pressure mean: 0.4497443437576294
loss_pred:0.020192153751850128, decouple_loss:0.010018750093877316
Iteration: 1985, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44856253266334534
loss_pred:0.021191101521253586, decouple_loss:0.010095628909766674
The generated pressure mean: 0.4498043656349182
loss_pred:0.019382141530513763, decouple_loss:0.011310724541544914
The generated pressure mean: 0.4487486481666565
loss_pred:0.020595630630850792, decouple_loss:0.010138527490198612
Iteration: 1986, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44873541593551636
loss_pred:0.020909523591399193, decouple_loss:0.009723637253046036
The generated pressure mean: 0.4502854347229004
loss_pred:0.02175546996295452, decouple_loss:0.010363442823290825
The generated pressure mean: 0.4482819139957428
loss_pred:0.019371507689356804, decouple_loss:0.010065373964607716
Iteration: 1987, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44893190264701843
loss_pred:0.018830431625247, decouple_loss:0.00954617839306593
The generated pressure mean: 0.4484429657459259
loss_pred:0.021122096106410027, decouple_loss:0.009439853951334953
The generated pressure mean: 0.44899675250053406
loss_pred:0.019892102107405663, decouple_loss:0.009294434450566769
Iteration: 1988, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4490707218647003
loss_pred:0.0187360942363739, decouple_loss:0.010332968086004257
The generated pressure mean: 0.44898051023483276
loss_pred:0.019017059355974197, decouple_loss:0.010016038082540035
The generated pressure mean: 0.4493497312068939
loss_pred:0.020855620503425598, decouple_loss:0.00941154733300209
Iteration: 1989, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44791144132614136
loss_pred:0.022187992930412292, decouple_loss:0.010139618068933487
The generated pressure mean: 0.44805121421813965
loss_pred:0.019458789378404617, decouple_loss:0.009869745932519436
The generated pressure mean: 0.44858160614967346
loss_pred:0.019391722977161407, decouple_loss:0.01003893744200468
Iteration: 1990, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44849488139152527
loss_pred:0.019273074343800545, decouple_loss:0.010231970809400082
The generated pressure mean: 0.44914841651916504
loss_pred:0.019319215789437294, decouple_loss:0.009761085733771324
The generated pressure mean: 0.4490937888622284
loss_pred:0.018510080873966217, decouple_loss:0.00985859613865614
2023-04-16 09:25:32 testing...
The generated pressure mean: 0.4502691924571991
loss_pred:0.1383873075246811, decouple_loss:0.054331935942173004
The generated pressure mean: 0.4503220021724701
loss_pred:0.1369325965642929, decouple_loss:0.054251011461019516
The generated pressure mean: 0.45003125071525574
loss_pred:0.13757742941379547, decouple_loss:0.05388335883617401
Loss: 0.14034022390842438, avg_mse: 0.2713710069656372
current test mse: 0.271371
Iteration: 1991, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4485103189945221
loss_pred:0.018587935715913773, decouple_loss:0.008673048578202724
The generated pressure mean: 0.4497527778148651
loss_pred:0.01839180663228035, decouple_loss:0.00892716832458973
The generated pressure mean: 0.4489862620830536
loss_pred:0.02144245244562626, decouple_loss:0.009004294872283936
Iteration: 1992, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4492432773113251
loss_pred:0.01927112229168415, decouple_loss:0.00991237536072731
The generated pressure mean: 0.44818317890167236
loss_pred:0.02101116068661213, decouple_loss:0.009740344248712063
The generated pressure mean: 0.44865697622299194
loss_pred:0.02042732574045658, decouple_loss:0.009596061892807484
Iteration: 1993, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44937920570373535
loss_pred:0.021623490378260612, decouple_loss:0.00945582240819931
The generated pressure mean: 0.4494228661060333
loss_pred:0.020020226016640663, decouple_loss:0.00959276594221592
The generated pressure mean: 0.4483972489833832
loss_pred:0.020835142582654953, decouple_loss:0.008858554065227509
Iteration: 1994, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4503007233142853
loss_pred:0.020022306591272354, decouple_loss:0.009136046282947063
The generated pressure mean: 0.4495302438735962
loss_pred:0.020861513912677765, decouple_loss:0.00955225434154272
The generated pressure mean: 0.4477294981479645
loss_pred:0.01989552192389965, decouple_loss:0.009236181154847145
Iteration: 1995, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4485190808773041
loss_pred:0.020045801997184753, decouple_loss:0.008758999407291412
The generated pressure mean: 0.44971510767936707
loss_pred:0.018673554062843323, decouple_loss:0.008231536485254765
The generated pressure mean: 0.4493500590324402
loss_pred:0.020605864003300667, decouple_loss:0.00837591104209423
Iteration: 1996, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4495527744293213
loss_pred:0.017993243411183357, decouple_loss:0.008238635957241058
The generated pressure mean: 0.44819045066833496
loss_pred:0.019987424835562706, decouple_loss:0.008627268485724926
The generated pressure mean: 0.44915977120399475
loss_pred:0.018444299697875977, decouple_loss:0.008729725144803524
Iteration: 1997, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44933339953422546
loss_pred:0.020242417231202126, decouple_loss:0.008469090797007084
The generated pressure mean: 0.4491158723831177
loss_pred:0.019614405930042267, decouple_loss:0.009004661813378334
The generated pressure mean: 0.44865936040878296
loss_pred:0.02329968474805355, decouple_loss:0.008926237933337688
Iteration: 1998, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44939568638801575
loss_pred:0.018819544464349747, decouple_loss:0.00889689102768898
The generated pressure mean: 0.44875624775886536
loss_pred:0.02004869468510151, decouple_loss:0.007964741438627243
The generated pressure mean: 0.4492889940738678
loss_pred:0.021584482863545418, decouple_loss:0.008797229267656803
Iteration: 1999, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.448405921459198
loss_pred:0.019942278042435646, decouple_loss:0.00846643652766943
The generated pressure mean: 0.44922423362731934
loss_pred:0.019415399059653282, decouple_loss:0.008488144725561142
The generated pressure mean: 0.45001816749572754
loss_pred:0.021821368485689163, decouple_loss:0.008424104191362858
Iteration: 2000, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45054322481155396
loss_pred:0.02124413102865219, decouple_loss:0.008658560924232006
The generated pressure mean: 0.44925785064697266
loss_pred:0.019527314230799675, decouple_loss:0.00832987017929554
The generated pressure mean: 0.44826045632362366
loss_pred:0.019822565838694572, decouple_loss:0.008481772616505623
2023-04-16 09:27:39 itr: 2000
training loss: [0.02024665 0.01994381 0.02167706]
save model to /work/09012/haoli1/ls6/ERA5_PredRNN/checkpoints/WV_1_PC_1_EH_1_PS_40/model_2000.ckpt
2023-04-16 09:27:44 testing...
The generated pressure mean: 0.4502691626548767
loss_pred:0.13918474316596985, decouple_loss:0.052782319486141205
The generated pressure mean: 0.4503227770328522
loss_pred:0.13716861605644226, decouple_loss:0.05275154858827591
The generated pressure mean: 0.4500315487384796
loss_pred:0.13808180391788483, decouple_loss:0.0525662824511528
Loss: 0.14078006148338318, avg_mse: 0.27329713106155396
current test mse: 0.273297
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012000_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012000_3_24hr.npz
NaN value num: 0
Iteration: 2001, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4495765268802643
loss_pred:0.022494973614811897, decouple_loss:0.008431236259639263
The generated pressure mean: 0.4494510293006897
loss_pred:0.018483906984329224, decouple_loss:0.008355936966836452
The generated pressure mean: 0.4499483108520508
loss_pred:0.019793203100562096, decouple_loss:0.008423538878560066
Iteration: 2002, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4469749629497528
loss_pred:0.02277516946196556, decouple_loss:0.0095901470631361
The generated pressure mean: 0.4502938687801361
loss_pred:0.01875528134405613, decouple_loss:0.00893506407737732
The generated pressure mean: 0.4476197063922882
loss_pred:0.018465762957930565, decouple_loss:0.008611911907792091
Iteration: 2003, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4475051760673523
loss_pred:0.02115030027925968, decouple_loss:0.008948505856096745
The generated pressure mean: 0.44763171672821045
loss_pred:0.02006453461945057, decouple_loss:0.008617853745818138
The generated pressure mean: 0.44942548871040344
loss_pred:0.02009076252579689, decouple_loss:0.009189584292471409
Iteration: 2004, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44703102111816406
loss_pred:0.021561382338404655, decouple_loss:0.008965070359408855
The generated pressure mean: 0.4477689266204834
loss_pred:0.020970072597265244, decouple_loss:0.008879647590219975
The generated pressure mean: 0.4486030042171478
loss_pred:0.01992063783109188, decouple_loss:0.009037120267748833
Iteration: 2005, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4479590356349945
The generated pressure mean: 0.44947007298469543
loss_pred:0.019765125587582588, decouple_loss:0.008636116981506348
loss_pred:0.020397109910845757, decouple_loss:0.008352255448698997
The generated pressure mean: 0.4471849799156189
loss_pred:0.020078156143426895, decouple_loss:0.008147628977894783
Iteration: 2006, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44840434193611145
The generated pressure mean: 0.4482339024543762
loss_pred:0.019401120021939278, decouple_loss:0.008757177740335464
loss_pred:0.018838433548808098, decouple_loss:0.00823884829878807
The generated pressure mean: 0.44744277000427246
loss_pred:0.019263384863734245, decouple_loss:0.008378091268241405
Iteration: 2007, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4491538405418396
loss_pred:0.01935557834804058, decouple_loss:0.009052020497620106
The generated pressure mean: 0.4498038589954376
loss_pred:0.019928764551877975, decouple_loss:0.008581987582147121
The generated pressure mean: 0.4479193091392517
loss_pred:0.01986643485724926, decouple_loss:0.0086553655564785
Iteration: 2008, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4484679698944092
The generated pressure mean: 0.44773682951927185
loss_pred:0.019689226523041725, decouple_loss:0.008485097438097
loss_pred:0.019919775426387787, decouple_loss:0.008159316144883633
The generated pressure mean: 0.4495985805988312
loss_pred:0.018430441617965698, decouple_loss:0.008197490125894547
Iteration: 2009, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4493422508239746
The generated pressure mean: 0.4487588405609131loss_pred:0.02026253566145897, decouple_loss:0.008412830531597137
loss_pred:0.020406605675816536, decouple_loss:0.008468801155686378
The generated pressure mean: 0.44758743047714233
loss_pred:0.02017880603671074, decouple_loss:0.008352137170732021
Iteration: 2010, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4494030773639679
loss_pred:0.018616950139403343, decouple_loss:0.008952843025326729
The generated pressure mean: 0.44881314039230347
loss_pred:0.019612781703472137, decouple_loss:0.008960024453699589
The generated pressure mean: 0.4479431211948395
loss_pred:0.020840037614107132, decouple_loss:0.008678174577653408
2023-04-16 09:30:25 testing...
The generated pressure mean: 0.4502691626548767
loss_pred:0.1344718635082245, decouple_loss:0.04976098611950874
The generated pressure mean: 0.4503243565559387
loss_pred:0.13292312622070312, decouple_loss:0.05009448155760765
The generated pressure mean: 0.4500315487384796
loss_pred:0.13379360735416412, decouple_loss:0.04961523786187172
Loss: 0.13622070848941803, avg_mse: 0.26488953828811646
current test mse: 0.26489
Iteration: 2011, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44851747155189514
The generated pressure mean: 0.4506101608276367
loss_pred:0.018639393150806427, decouple_loss:0.009545464999973774
loss_pred:0.019609367474913597, decouple_loss:0.009821810759603977
The generated pressure mean: 0.4499039649963379
loss_pred:0.01937410980463028, decouple_loss:0.009348329156637192
Iteration: 2012, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4478338658809662
The generated pressure mean: 0.4483300745487213loss_pred:0.018276803195476532, decouple_loss:0.009531339630484581
loss_pred:0.0189027301967144, decouple_loss:0.009367462247610092
The generated pressure mean: 0.4507656395435333
loss_pred:0.019171874970197678, decouple_loss:0.009181827306747437
Iteration: 2013, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44788533449172974
The generated pressure mean: 0.447504460811615
loss_pred:0.01997406780719757, decouple_loss:0.008685676380991936
loss_pred:0.019836127758026123, decouple_loss:0.008645696565508842
The generated pressure mean: 0.44808319211006165
loss_pred:0.018832677975296974, decouple_loss:0.008607693016529083
Iteration: 2014, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4488784670829773
The generated pressure mean: 0.4479823410511017
loss_pred:0.020209316164255142, decouple_loss:0.009033871814608574
loss_pred:0.01967807672917843, decouple_loss:0.00915443990379572
The generated pressure mean: 0.4487275183200836
loss_pred:0.018217680975794792, decouple_loss:0.009494571015238762
Iteration: 2015, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44885143637657166
loss_pred:0.018152855336666107, decouple_loss:0.009802073240280151
The generated pressure mean: 0.4492897391319275
loss_pred:0.01891833171248436, decouple_loss:0.010447011329233646
The generated pressure mean: 0.4493396282196045
loss_pred:0.018827147781848907, decouple_loss:0.009511412121355534
Iteration: 2016, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4488934874534607
loss_pred:0.01837630569934845, decouple_loss:0.009401293471455574
The generated pressure mean: 0.44785401225090027
loss_pred:0.020464695990085602, decouple_loss:0.009796430356800556
The generated pressure mean: 0.4496743381023407
loss_pred:0.01870887167751789, decouple_loss:0.009664347395300865
Iteration: 2017, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44851088523864746
loss_pred:0.017693350091576576, decouple_loss:0.009260267950594425
The generated pressure mean: 0.44977229833602905
loss_pred:0.019390234723687172, decouple_loss:0.009041283279657364
The generated pressure mean: 0.4482317566871643
loss_pred:0.021220730617642403, decouple_loss:0.008920366875827312
Iteration: 2018, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4465925693511963
loss_pred:0.01973283290863037, decouple_loss:0.00851775798946619
The generated pressure mean: 0.44917216897010803
loss_pred:0.019212739542126656, decouple_loss:0.008126107975840569
The generated pressure mean: 0.4489896893501282
loss_pred:0.022241761907935143, decouple_loss:0.008614814840257168
Iteration: 2019, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4497916102409363
loss_pred:0.018221359699964523, decouple_loss:0.008165553212165833
The generated pressure mean: 0.44986313581466675
loss_pred:0.01836794801056385, decouple_loss:0.00806300900876522
The generated pressure mean: 0.4467560648918152
loss_pred:0.01953296735882759, decouple_loss:0.008262921124696732
Iteration: 2020, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4484785497188568
loss_pred:0.018767816945910454, decouple_loss:0.009075990878045559
The generated pressure mean: 0.4488062560558319
loss_pred:0.018493449315428734, decouple_loss:0.008901524357497692
The generated pressure mean: 0.4480609893798828
loss_pred:0.018146265298128128, decouple_loss:0.009069014340639114
2023-04-16 09:32:31 testing...
The generated pressure mean: 0.4502691626548767
loss_pred:0.1362464278936386, decouple_loss:0.04984394460916519
The generated pressure mean: 0.45032331347465515
loss_pred:0.13456006348133087, decouple_loss:0.04996288940310478
The generated pressure mean: 0.4500284194946289
loss_pred:0.13559255003929138, decouple_loss:0.050211429595947266
Loss: 0.13796666264533997, avg_mse: 0.2684353291988373
current test mse: 0.268435
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012010_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012010_3_24hr.npz
NaN value num: 0
Iteration: 2021, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44847649335861206
loss_pred:0.020688403397798538, decouple_loss:0.008253543637692928
The generated pressure mean: 0.44647714495658875
loss_pred:0.01982802525162697, decouple_loss:0.008591689169406891
The generated pressure mean: 0.44830700755119324
loss_pred:0.02011176012456417, decouple_loss:0.008571336977183819
Iteration: 2022, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44734835624694824
The generated pressure mean: 0.44876828789711
loss_pred:0.019468119367957115, decouple_loss:0.008914594538509846
loss_pred:0.020469656214118004, decouple_loss:0.008942510932683945
The generated pressure mean: 0.4483683705329895
loss_pred:0.020586349070072174, decouple_loss:0.008546332828700542
Iteration: 2023, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44809797406196594
The generated pressure mean: 0.4481915533542633loss_pred:0.02051866240799427, decouple_loss:0.008512577973306179
loss_pred:0.019679900258779526, decouple_loss:0.008297117426991463
The generated pressure mean: 0.44812583923339844
loss_pred:0.0191936157643795, decouple_loss:0.008414024487137794
Iteration: 2024, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4478839337825775
The generated pressure mean: 0.4478224813938141loss_pred:0.019428612664341927, decouple_loss:0.008423381485044956
loss_pred:0.020088031888008118, decouple_loss:0.008718188852071762
The generated pressure mean: 0.4482980966567993
loss_pred:0.02012106217443943, decouple_loss:0.008466697297990322
Iteration: 2025, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4489564895629883
loss_pred:0.02023565210402012, decouple_loss:0.007674181368201971
The generated pressure mean: 0.44793641567230225
loss_pred:0.020774511620402336, decouple_loss:0.00803016871213913
The generated pressure mean: 0.4467112421989441
loss_pred:0.0211181640625, decouple_loss:0.007987475022673607
Iteration: 2026, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44790592789649963
loss_pred:0.018997276201844215, decouple_loss:0.00815209187567234
The generated pressure mean: 0.44826066493988037
loss_pred:0.020320802927017212, decouple_loss:0.008181393146514893
The generated pressure mean: 0.4477975070476532
loss_pred:0.019424809142947197, decouple_loss:0.008278310298919678
Iteration: 2027, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4486449062824249
The generated pressure mean: 0.4481836259365082
loss_pred:0.020744141191244125, decouple_loss:0.007787690497934818
loss_pred:0.01908683590590954, decouple_loss:0.007761786226183176
The generated pressure mean: 0.447875052690506
loss_pred:0.019159767776727676, decouple_loss:0.007980606518685818
Iteration: 2028, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4483749568462372The generated pressure mean: 0.448289155960083
loss_pred:0.019098490476608276, decouple_loss:0.008445849642157555
loss_pred:0.019086945801973343, decouple_loss:0.00865675788372755
The generated pressure mean: 0.4478284418582916
loss_pred:0.02074805088341236, decouple_loss:0.008674300275743008
Iteration: 2029, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4473351836204529
The generated pressure mean: 0.4482589662075043
loss_pred:0.019688256084918976, decouple_loss:0.00914937537163496
loss_pred:0.020531214773654938, decouple_loss:0.008751027286052704
The generated pressure mean: 0.4480716288089752
loss_pred:0.02110353671014309, decouple_loss:0.008588248863816261
Iteration: 2030, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44719168543815613
loss_pred:0.02053462713956833, decouple_loss:0.008514404296875
The generated pressure mean: 0.4491589665412903
loss_pred:0.019390050321817398, decouple_loss:0.008333288133144379
The generated pressure mean: 0.44710054993629456
loss_pred:0.020175587385892868, decouple_loss:0.008616216480731964
2023-04-16 09:35:15 testing...
The generated pressure mean: 0.4502691328525543
loss_pred:0.13811518251895905, decouple_loss:0.04775485023856163
The generated pressure mean: 0.45003294944763184
loss_pred:0.1373499184846878, decouple_loss:0.04809154197573662
The generated pressure mean: 0.45032331347465515
loss_pred:0.13657750189304352, decouple_loss:0.048668645322322845
Loss: 0.13975612819194794, avg_mse: 0.2727341949939728
current test mse: 0.272734
Iteration: 2031, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4476888179779053The generated pressure mean: 0.4480404555797577
loss_pred:0.0199896190315485, decouple_loss:0.00781275425106287
loss_pred:0.01998097077012062, decouple_loss:0.00835672952234745The generated pressure mean: 0.4482179880142212
loss_pred:0.019342521205544472, decouple_loss:0.008336503058671951
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 2032, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4478214681148529
loss_pred:0.019771603867411613, decouple_loss:0.009332814253866673
The generated pressure mean: 0.44700759649276733
loss_pred:0.02001725323498249, decouple_loss:0.009355733171105385
The generated pressure mean: 0.4477524757385254
loss_pred:0.020380020141601562, decouple_loss:0.00909618940204382
Iteration: 2033, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4468441605567932
loss_pred:0.020178664475679398, decouple_loss:0.010144609026610851
The generated pressure mean: 0.4485127031803131
The generated pressure mean: 0.44851255416870117loss_pred:0.021446693688631058, decouple_loss:0.00994128454476595
loss_pred:0.020220376551151276, decouple_loss:0.00963970459997654
Iteration: 2034, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44811540842056274
loss_pred:0.01893799751996994, decouple_loss:0.008880690671503544
The generated pressure mean: 0.44873467087745667
loss_pred:0.018683647736907005, decouple_loss:0.009077021852135658
The generated pressure mean: 0.44806715846061707
loss_pred:0.021328764036297798, decouple_loss:0.009092138148844242
Iteration: 2035, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44717466831207275
The generated pressure mean: 0.446712851524353
loss_pred:0.019660329446196556, decouple_loss:0.008726644329726696
loss_pred:0.021390646696090698, decouple_loss:0.00849042646586895
The generated pressure mean: 0.44728726148605347
loss_pred:0.019970517605543137, decouple_loss:0.008884117007255554
Iteration: 2036, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4466215670108795
loss_pred:0.021296437829732895, decouple_loss:0.009812911041080952
The generated pressure mean: 0.4484636187553406
loss_pred:0.0195376705378294, decouple_loss:0.009548209607601166
The generated pressure mean: 0.44894036650657654
loss_pred:0.019988451153039932, decouple_loss:0.00937948003411293
Iteration: 2037, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44856157898902893
loss_pred:0.01938341185450554, decouple_loss:0.009316639974713326
The generated pressure mean: 0.4465210735797882
loss_pred:0.019871896132826805, decouple_loss:0.009526894427835941
The generated pressure mean: 0.4478994309902191
loss_pred:0.02008133754134178, decouple_loss:0.008971506729722023
Iteration: 2038, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4489809274673462
loss_pred:0.019209399819374084, decouple_loss:0.008267569355666637
The generated pressure mean: 0.4475579559803009
loss_pred:0.019581671804189682, decouple_loss:0.008084048517048359
The generated pressure mean: 0.4486662745475769
loss_pred:0.018924761563539505, decouple_loss:0.008213904686272144
Iteration: 2039, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44880518317222595
loss_pred:0.020850080996751785, decouple_loss:0.008878961205482483
The generated pressure mean: 0.44740721583366394
loss_pred:0.019988156855106354, decouple_loss:0.008890640921890736
The generated pressure mean: 0.44692397117614746
loss_pred:0.018708862364292145, decouple_loss:0.008714153431355953
Iteration: 2040, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44866734743118286
The generated pressure mean: 0.44795751571655273
loss_pred:0.019657539203763008, decouple_loss:0.008781016804277897
loss_pred:0.01903107576072216, decouple_loss:0.009067586623132229
The generated pressure mean: 0.44765976071357727
loss_pred:0.019912563264369965, decouple_loss:0.009007853455841541
2023-04-16 09:37:20 testing...
The generated pressure mean: 0.4502691328525543
loss_pred:0.1363462656736374, decouple_loss:0.0470682755112648
The generated pressure mean: 0.4503249526023865
loss_pred:0.13458934426307678, decouple_loss:0.04734935984015465
The generated pressure mean: 0.4500332474708557
loss_pred:0.1350056380033493, decouple_loss:0.047046806663274765
Loss: 0.13767150044441223, avg_mse: 0.266846239566803
current test mse: 0.266846
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012007_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012007_3_24hr.npz
NaN value num: 0
Iteration: 2041, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.448897123336792
loss_pred:0.018200812861323357, decouple_loss:0.007914683781564236
The generated pressure mean: 0.44879788160324097
loss_pred:0.019239600747823715, decouple_loss:0.008361599408090115
The generated pressure mean: 0.44787049293518066
loss_pred:0.0208120159804821, decouple_loss:0.008098797872662544
Iteration: 2042, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4479359984397888
loss_pred:0.020531313493847847, decouple_loss:0.008542700670659542
The generated pressure mean: 0.4489516019821167
loss_pred:0.020048927515745163, decouple_loss:0.008553916588425636
The generated pressure mean: 0.4486537277698517
loss_pred:0.019122684374451637, decouple_loss:0.009236359968781471
Iteration: 2043, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4482121765613556
loss_pred:0.01906214840710163, decouple_loss:0.00840172078460455
The generated pressure mean: 0.447505921125412
loss_pred:0.0191118735820055, decouple_loss:0.008173597976565361
The generated pressure mean: 0.44895192980766296
loss_pred:0.019087597727775574, decouple_loss:0.008487478829920292
Iteration: 2044, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44875025749206543
loss_pred:0.019432881847023964, decouple_loss:0.00879188533872366
The generated pressure mean: 0.4478878676891327
loss_pred:0.01956356316804886, decouple_loss:0.0086533073335886
The generated pressure mean: 0.4489491581916809
loss_pred:0.018936680629849434, decouple_loss:0.008746331557631493
Iteration: 2045, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.448222279548645
loss_pred:0.01992551051080227, decouple_loss:0.008292303420603275
The generated pressure mean: 0.4499592185020447
loss_pred:0.019896645098924637, decouple_loss:0.009495344012975693
The generated pressure mean: 0.4478740692138672
loss_pred:0.021477509289979935, decouple_loss:0.008431010879576206
Iteration: 2046, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4486963748931885
loss_pred:0.019726281985640526, decouple_loss:0.009089608676731586
The generated pressure mean: 0.44963547587394714
loss_pred:0.01923510991036892, decouple_loss:0.008617778308689594
The generated pressure mean: 0.4486803114414215
loss_pred:0.018263544887304306, decouple_loss:0.008401854895055294
Iteration: 2047, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44784489274024963
loss_pred:0.01931130141019821, decouple_loss:0.007852759212255478
The generated pressure mean: 0.4495999217033386
loss_pred:0.0190527755767107, decouple_loss:0.00795021653175354
The generated pressure mean: 0.4487285017967224
loss_pred:0.018623292446136475, decouple_loss:0.007710929028689861
Iteration: 2048, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44804325699806213
loss_pred:0.01875062845647335, decouple_loss:0.0084296939894557
The generated pressure mean: 0.44907325506210327
loss_pred:0.01919989101588726, decouple_loss:0.008430657908320427
The generated pressure mean: 0.44909000396728516
loss_pred:0.02023344486951828, decouple_loss:0.008826866745948792
Iteration: 2049, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4486006200313568
The generated pressure mean: 0.44930359721183777
loss_pred:0.018808575347065926, decouple_loss:0.008561188355088234
loss_pred:0.01993168331682682, decouple_loss:0.00826756190508604
The generated pressure mean: 0.44786307215690613
loss_pred:0.020337078720331192, decouple_loss:0.008449568413197994
Iteration: 2050, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4486014246940613
loss_pred:0.019317559897899628, decouple_loss:0.008049576543271542
The generated pressure mean: 0.44896256923675537
loss_pred:0.019756216555833817, decouple_loss:0.007794144097715616
The generated pressure mean: 0.4483047127723694
loss_pred:0.019670143723487854, decouple_loss:0.007765484508126974
2023-04-16 09:40:12 testing...
The generated pressure mean: 0.4502691328525543
loss_pred:0.13448043167591095, decouple_loss:0.046120814979076385
The generated pressure mean: 0.45032286643981934
loss_pred:0.1334892362356186, decouple_loss:0.04659702628850937
The generated pressure mean: 0.4500311613082886
loss_pred:0.1343076080083847, decouple_loss:0.0463847778737545
Loss: 0.13641080260276794, avg_mse: 0.2646925449371338
current test mse: 0.264693
Iteration: 2051, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4485253393650055
loss_pred:0.01864614523947239, decouple_loss:0.007800062652677298
The generated pressure mean: 0.44892141222953796
loss_pred:0.019225796684622765, decouple_loss:0.007927509024739265
The generated pressure mean: 0.4487197697162628
loss_pred:0.019588114693760872, decouple_loss:0.007957195863127708
Iteration: 2052, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4476642608642578
loss_pred:0.02089487947523594, decouple_loss:0.0076438672840595245
The generated pressure mean: 0.448531836271286
loss_pred:0.01810304820537567, decouple_loss:0.007965805009007454
The generated pressure mean: 0.44793543219566345
loss_pred:0.01849413476884365, decouple_loss:0.008489207364618778
Iteration: 2053, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4480923116207123
loss_pred:0.018828922882676125, decouple_loss:0.00831903051584959
The generated pressure mean: 0.4486978054046631
loss_pred:0.01857711374759674, decouple_loss:0.008386204019188881
The generated pressure mean: 0.4493504762649536
loss_pred:0.021121179684996605, decouple_loss:0.008686942048370838
Iteration: 2054, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4490341544151306
loss_pred:0.019780302420258522, decouple_loss:0.008121849037706852
The generated pressure mean: 0.4491714835166931
loss_pred:0.019414331763982773, decouple_loss:0.0076665813103318214
The generated pressure mean: 0.4483516812324524
loss_pred:0.01993625797331333, decouple_loss:0.00777213042601943
Iteration: 2055, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4478284418582916
loss_pred:0.01856573484838009, decouple_loss:0.008131824433803558
The generated pressure mean: 0.44834622740745544
loss_pred:0.01857442781329155, decouple_loss:0.008101261220872402
The generated pressure mean: 0.44988879561424255
loss_pred:0.017919547855854034, decouple_loss:0.007930867373943329
Iteration: 2056, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4481947422027588
loss_pred:0.01844104938209057, decouple_loss:0.007678708992898464
The generated pressure mean: 0.44853487610816956
loss_pred:0.018715038895606995, decouple_loss:0.007819142192602158
The generated pressure mean: 0.4482552409172058
loss_pred:0.02033141441643238, decouple_loss:0.007947015576064587
Iteration: 2057, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4490032494068146
loss_pred:0.018320709466934204, decouple_loss:0.008074742741882801
The generated pressure mean: 0.44781002402305603
loss_pred:0.02004428207874298, decouple_loss:0.008321708999574184
The generated pressure mean: 0.4476880729198456
loss_pred:0.020143814384937286, decouple_loss:0.008848452009260654
Iteration: 2058, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44802626967430115
loss_pred:0.01924446038901806, decouple_loss:0.008027918636798859
The generated pressure mean: 0.44907286763191223
loss_pred:0.020667677745223045, decouple_loss:0.008628630079329014
The generated pressure mean: 0.4491470754146576
loss_pred:0.018905043601989746, decouple_loss:0.008483965881168842
Iteration: 2059, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44922634959220886
loss_pred:0.02058451622724533, decouple_loss:0.008123351261019707
The generated pressure mean: 0.44772836565971375
loss_pred:0.01900353841483593, decouple_loss:0.008513464592397213
The generated pressure mean: 0.4471866190433502
loss_pred:0.019982725381851196, decouple_loss:0.00764872133731842
Iteration: 2060, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.448076993227005
The generated pressure mean: 0.44802913069725037
loss_pred:0.021070918068289757, decouple_loss:0.008631732314825058
loss_pred:0.018682308495044708, decouple_loss:0.00846580509096384
The generated pressure mean: 0.44813042879104614
loss_pred:0.0194030050188303, decouple_loss:0.008409070782363415
2023-04-16 09:42:18 testing...
The generated pressure mean: 0.4502691626548767
loss_pred:0.13647732138633728, decouple_loss:0.046484217047691345
The generated pressure mean: 0.4503231644630432
loss_pred:0.1350860595703125, decouple_loss:0.04668000712990761
The generated pressure mean: 0.4500279724597931
loss_pred:0.13575062155723572, decouple_loss:0.04643525183200836
Loss: 0.13809798657894135, avg_mse: 0.2673896551132202
current test mse: 0.26739
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012012_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012012_3_24hr.npz
NaN value num: 0
Iteration: 2061, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4480481445789337
loss_pred:0.01859014481306076, decouple_loss:0.007921908050775528
The generated pressure mean: 0.44921502470970154
loss_pred:0.020176056772470474, decouple_loss:0.008294468745589256
The generated pressure mean: 0.44786056876182556
loss_pred:0.01918845809996128, decouple_loss:0.008011513389647007
Iteration: 2062, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4492640197277069
loss_pred:0.020538758486509323, decouple_loss:0.008589250035583973
The generated pressure mean: 0.44829171895980835
loss_pred:0.01937120221555233, decouple_loss:0.008448231033980846
The generated pressure mean: 0.44753366708755493
loss_pred:0.02029954083263874, decouple_loss:0.008553850464522839
Iteration: 2063, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44839736819267273
loss_pred:0.018217140808701515, decouple_loss:0.008430556394159794
The generated pressure mean: 0.44839394092559814
loss_pred:0.02114378847181797, decouple_loss:0.00901896320283413
The generated pressure mean: 0.44695672392845154
loss_pred:0.018242347985506058, decouple_loss:0.008003787137567997
Iteration: 2064, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4475138783454895
loss_pred:0.01867413893342018, decouple_loss:0.007637143600732088
The generated pressure mean: 0.4493415951728821
loss_pred:0.01916617713868618, decouple_loss:0.008012304082512856
The generated pressure mean: 0.44742754101753235
loss_pred:0.01966629922389984, decouple_loss:0.00813281536102295
Iteration: 2065, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44812604784965515
loss_pred:0.018949581310153008, decouple_loss:0.00794428400695324
The generated pressure mean: 0.44871604442596436
loss_pred:0.018963128328323364, decouple_loss:0.008031501434743404
The generated pressure mean: 0.44775834679603577
loss_pred:0.020239796489477158, decouple_loss:0.007871312089264393
Iteration: 2066, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44748154282569885
loss_pred:0.020394736900925636, decouple_loss:0.008096498437225819
The generated pressure mean: 0.448306679725647
loss_pred:0.01925278827548027, decouple_loss:0.00842948816716671
The generated pressure mean: 0.4477761387825012
loss_pred:0.018519941717386246, decouple_loss:0.008444162085652351
Iteration: 2067, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44827598333358765
loss_pred:0.019623516127467155, decouple_loss:0.008650491945445538
The generated pressure mean: 0.4492436647415161
loss_pred:0.020028142258524895, decouple_loss:0.009289240464568138
The generated pressure mean: 0.4478793442249298
loss_pred:0.01906060054898262, decouple_loss:0.008779274299740791
Iteration: 2068, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4462029039859772
The generated pressure mean: 0.4489627778530121loss_pred:0.018879137933254242, decouple_loss:0.007808659225702286
loss_pred:0.01914532482624054, decouple_loss:0.008231534622609615
The generated pressure mean: 0.4471215307712555
loss_pred:0.018398871645331383, decouple_loss:0.00782383605837822
Iteration: 2069, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4482283592224121
loss_pred:0.01944117248058319, decouple_loss:0.007466437295079231
The generated pressure mean: 0.44799286127090454
loss_pred:0.019851205870509148, decouple_loss:0.008343702182173729
The generated pressure mean: 0.447807639837265
loss_pred:0.020172756165266037, decouple_loss:0.008045273832976818
Iteration: 2070, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4470517039299011
loss_pred:0.02005676180124283, decouple_loss:0.007842157036066055
The generated pressure mean: 0.4481828808784485
loss_pred:0.018349172547459602, decouple_loss:0.007895559072494507
The generated pressure mean: 0.4486134648323059
loss_pred:0.018824677914381027, decouple_loss:0.008331352844834328
2023-04-16 09:44:58 testing...
The generated pressure mean: 0.4502691328525543
loss_pred:0.13613933324813843, decouple_loss:0.045596759766340256
The generated pressure mean: 0.45032453536987305
loss_pred:0.13475105166435242, decouple_loss:0.0459735281765461
The generated pressure mean: 0.4500275254249573
loss_pred:0.1353600174188614, decouple_loss:0.04563368111848831
Loss: 0.137703537940979, avg_mse: 0.2661309540271759
current test mse: 0.266131
Iteration: 2071, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4480644762516022
loss_pred:0.021033499389886856, decouple_loss:0.008269517682492733
The generated pressure mean: 0.44826775789260864
loss_pred:0.019385498017072678, decouple_loss:0.008120570331811905
The generated pressure mean: 0.44903361797332764
loss_pred:0.02015245333313942, decouple_loss:0.00818635430186987
Iteration: 2072, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44800058007240295
loss_pred:0.01956622675061226, decouple_loss:0.008210338652133942
The generated pressure mean: 0.4478967785835266
loss_pred:0.01916145160794258, decouple_loss:0.008485591970384121
The generated pressure mean: 0.4490709602832794
loss_pred:0.02014104463160038, decouple_loss:0.008658048696815968
Iteration: 2073, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44801461696624756
loss_pred:0.019938578829169273, decouple_loss:0.008587206713855267
The generated pressure mean: 0.44830965995788574
loss_pred:0.01981440931558609, decouple_loss:0.008719216100871563
The generated pressure mean: 0.4486945569515228
loss_pred:0.01855345256626606, decouple_loss:0.008496924303472042
Iteration: 2074, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44761061668395996
loss_pred:0.020256387069821358, decouple_loss:0.007662691175937653
The generated pressure mean: 0.4492262601852417
loss_pred:0.01954636350274086, decouple_loss:0.008158224634826183
The generated pressure mean: 0.4482768177986145
loss_pred:0.02078341133892536, decouple_loss:0.0075408415868878365
Iteration: 2075, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4485895335674286
loss_pred:0.019610939547419548, decouple_loss:0.008928511291742325
The generated pressure mean: 0.44847190380096436
loss_pred:0.019399214535951614, decouple_loss:0.00948556512594223
The generated pressure mean: 0.4475938081741333
loss_pred:0.018629934638738632, decouple_loss:0.009446392767131329
Iteration: 2076, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4484722316265106
loss_pred:0.02021201141178608, decouple_loss:0.008848339319229126
The generated pressure mean: 0.4483584761619568
loss_pred:0.019512873142957687, decouple_loss:0.008761861361563206
The generated pressure mean: 0.44809406995773315
loss_pred:0.02023307979106903, decouple_loss:0.008435867726802826
Iteration: 2077, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4468575417995453
The generated pressure mean: 0.4480094909667969
loss_pred:0.01947013847529888, decouple_loss:0.008396144956350327
loss_pred:0.02030240371823311, decouple_loss:0.008398360572755337
The generated pressure mean: 0.44744765758514404
loss_pred:0.019683705642819405, decouple_loss:0.008180166594684124
Iteration: 2078, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4478603005409241
The generated pressure mean: 0.448747456073761
loss_pred:0.019778911024332047, decouple_loss:0.008081585168838501
loss_pred:0.020184969529509544, decouple_loss:0.00828430987894535
The generated pressure mean: 0.447365939617157
loss_pred:0.01930302381515503, decouple_loss:0.007810290437191725
Iteration: 2079, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4486941993236542
loss_pred:0.01911317929625511, decouple_loss:0.007767134346067905
The generated pressure mean: 0.44819971919059753
loss_pred:0.02045075036585331, decouple_loss:0.008226911537349224
The generated pressure mean: 0.44655197858810425
loss_pred:0.01975107565522194, decouple_loss:0.007923162542283535
Iteration: 2080, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44735291600227356
loss_pred:0.01981286332011223, decouple_loss:0.008023169822990894
The generated pressure mean: 0.4484817683696747
loss_pred:0.020337043330073357, decouple_loss:0.007893357425928116
The generated pressure mean: 0.4494638442993164
loss_pred:0.019399764016270638, decouple_loss:0.007993235252797604
2023-04-16 09:47:04 testing...
The generated pressure mean: 0.4502691626548767
loss_pred:0.13539853692054749, decouple_loss:0.04666387289762497
The generated pressure mean: 0.4503262937068939
loss_pred:0.13401012122631073, decouple_loss:0.04702165722846985
The generated pressure mean: 0.4500308930873871
loss_pred:0.13456517457962036, decouple_loss:0.04670467972755432
Loss: 0.136997789144516, avg_mse: 0.2638562023639679
current test mse: 0.263856
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012001_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012001_3_24hr.npz
NaN value num: 0
Iteration: 2081, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44694873690605164
loss_pred:0.020343780517578125, decouple_loss:0.008344237692654133
The generated pressure mean: 0.448125958442688
loss_pred:0.019280027598142624, decouple_loss:0.008680651895701885
The generated pressure mean: 0.4477771818637848
loss_pred:0.018300075083971024, decouple_loss:0.008180534467101097
Iteration: 2082, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4478691816329956
loss_pred:0.01943798176944256, decouple_loss:0.008303304202854633
The generated pressure mean: 0.4478808045387268
loss_pred:0.019545752555131912, decouple_loss:0.008043285459280014
The generated pressure mean: 0.44882121682167053
loss_pred:0.019160356372594833, decouple_loss:0.00841267965734005
Iteration: 2083, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4478692412376404
The generated pressure mean: 0.4474150538444519
loss_pred:0.019674178212881088, decouple_loss:0.007825605571269989
loss_pred:0.01895533874630928, decouple_loss:0.008102760650217533
The generated pressure mean: 0.4475306272506714
loss_pred:0.020889298990368843, decouple_loss:0.008063492365181446
Iteration: 2084, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44872117042541504
loss_pred:0.018544113263487816, decouple_loss:0.009338141418993473
The generated pressure mean: 0.4489756226539612
loss_pred:0.0194255281239748, decouple_loss:0.009572383016347885
The generated pressure mean: 0.44778090715408325
loss_pred:0.01906139962375164, decouple_loss:0.009091438725590706
Iteration: 2085, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4472513794898987
loss_pred:0.018678808584809303, decouple_loss:0.008362988941371441
The generated pressure mean: 0.4486944377422333
loss_pred:0.020020321011543274, decouple_loss:0.008478241972625256
The generated pressure mean: 0.44796890020370483
loss_pred:0.019328240305185318, decouple_loss:0.00788035336881876
Iteration: 2086, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44752684235572815
The generated pressure mean: 0.44774824380874634loss_pred:0.01964372582733631, decouple_loss:0.008263105526566505
loss_pred:0.018471073359251022, decouple_loss:0.008151313289999962
The generated pressure mean: 0.44743049144744873
loss_pred:0.018087904900312424, decouple_loss:0.007894736714661121
Iteration: 2087, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44796276092529297The generated pressure mean: 0.4471769332885742
loss_pred:0.01969892345368862, decouple_loss:0.00788015965372324loss_pred:0.021832836791872978, decouple_loss:0.007723856717348099
The generated pressure mean: 0.44802790880203247
loss_pred:0.02013145387172699, decouple_loss:0.0077227340079844
Iteration: 2088, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4476098418235779
The generated pressure mean: 0.44789111614227295
loss_pred:0.022020483389496803, decouple_loss:0.00857834704220295
loss_pred:0.01860816776752472, decouple_loss:0.00865275040268898
The generated pressure mean: 0.4482726752758026
loss_pred:0.019497407600283623, decouple_loss:0.00865889247506857
Iteration: 2089, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44852158427238464
The generated pressure mean: 0.4467189610004425
loss_pred:0.019799450412392616, decouple_loss:0.008857172913849354
loss_pred:0.019975004717707634, decouple_loss:0.009141492657363415
The generated pressure mean: 0.4470959007740021
loss_pred:0.020105721428990364, decouple_loss:0.008881952613592148
Iteration: 2090, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44842150807380676
loss_pred:0.020731445401906967, decouple_loss:0.008543291129171848The generated pressure mean: 0.44759994745254517
loss_pred:0.019367294386029243, decouple_loss:0.008383291773498058
The generated pressure mean: 0.446978360414505
loss_pred:0.019031930714845657, decouple_loss:0.008765721693634987
2023-04-16 09:49:46 testing...
The generated pressure mean: 0.4502691328525543
loss_pred:0.13189902901649475, decouple_loss:0.04481269419193268
The generated pressure mean: 0.45003119111061096
loss_pred:0.13147816061973572, decouple_loss:0.04484441876411438
The generated pressure mean: 0.4503238797187805
loss_pred:0.1307157576084137, decouple_loss:0.04535834118723869
Loss: 0.13361458480358124, avg_mse: 0.2564470171928406
current test mse: 0.256447
Iteration: 2091, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4475101828575134
loss_pred:0.01892790012061596, decouple_loss:0.00842616893351078
The generated pressure mean: 0.4466708302497864
The generated pressure mean: 0.44664332270622253loss_pred:0.021393343806266785, decouple_loss:0.008139722980558872
loss_pred:0.019684113562107086, decouple_loss:0.008329445496201515
Iteration: 2092, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44722527265548706
The generated pressure mean: 0.44795098900794983The generated pressure mean: 0.4472810626029968
loss_pred:0.019589638337492943, decouple_loss:0.008468659594655037
loss_pred:0.02056076005101204, decouple_loss:0.008779162541031837
loss_pred:0.019533388316631317, decouple_loss:0.008643774315714836
Iteration: 2093, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4477669298648834
loss_pred:0.021078677847981453, decouple_loss:0.009284703060984612
The generated pressure mean: 0.44878602027893066
The generated pressure mean: 0.44823986291885376
loss_pred:0.019403154030442238, decouple_loss:0.009463504888117313
loss_pred:0.02002795785665512, decouple_loss:0.008902918547391891
Iteration: 2094, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4474886357784271
loss_pred:0.020041601732373238, decouple_loss:0.00890430249273777
The generated pressure mean: 0.4477672874927521
loss_pred:0.019884184002876282, decouple_loss:0.009152312763035297
The generated pressure mean: 0.44774043560028076
loss_pred:0.019032582640647888, decouple_loss:0.009363599121570587
Iteration: 2095, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44746729731559753
The generated pressure mean: 0.44932979345321655
loss_pred:0.019404606893658638, decouple_loss:0.008566753007471561
loss_pred:0.018896689638495445, decouple_loss:0.008594829589128494
The generated pressure mean: 0.4478505253791809
loss_pred:0.0201601292937994, decouple_loss:0.008460089564323425
Iteration: 2096, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44710469245910645
The generated pressure mean: 0.44719716906547546
loss_pred:0.018679853528738022, decouple_loss:0.010327553376555443
loss_pred:0.02278297394514084, decouple_loss:0.009434642270207405
The generated pressure mean: 0.4472690224647522
loss_pred:0.0199230145663023, decouple_loss:0.009462866932153702
Iteration: 2097, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4473648965358734
loss_pred:0.020337222144007683, decouple_loss:0.008615941740572453
The generated pressure mean: 0.44774019718170166
loss_pred:0.01976194605231285, decouple_loss:0.008350333198904991
The generated pressure mean: 0.44872140884399414
loss_pred:0.01893053948879242, decouple_loss:0.008441200479865074
Iteration: 2098, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44804587960243225
The generated pressure mean: 0.4481099247932434loss_pred:0.019151054322719574, decouple_loss:0.008691173978149891
loss_pred:0.0186277125030756, decouple_loss:0.008550389669835567
The generated pressure mean: 0.44773364067077637
loss_pred:0.020245078951120377, decouple_loss:0.008831069804728031
Iteration: 2099, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4471985399723053
loss_pred:0.018552400171756744, decouple_loss:0.009713550098240376
The generated pressure mean: 0.4483814835548401
loss_pred:0.021176794543862343, decouple_loss:0.009625324048101902
The generated pressure mean: 0.4487859606742859
loss_pred:0.021073108538985252, decouple_loss:0.009377856738865376
Iteration: 2100, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4487544000148773
loss_pred:0.019998328760266304, decouple_loss:0.010073031298816204
The generated pressure mean: 0.44861236214637756
loss_pred:0.019650762900710106, decouple_loss:0.010091501288115978
The generated pressure mean: 0.4472044110298157
loss_pred:0.019237225875258446, decouple_loss:0.010102417320013046
2023-04-16 09:51:51 testing...
The generated pressure mean: 0.4502691626548767
loss_pred:0.1381080150604248, decouple_loss:0.04852353781461716
The generated pressure mean: 0.4503224492073059
loss_pred:0.13667534291744232, decouple_loss:0.04872043803334236
The generated pressure mean: 0.45003175735473633
loss_pred:0.1376357525587082, decouple_loss:0.048259757459163666
Loss: 0.13989810645580292, avg_mse: 0.2706325054168701
current test mse: 0.270632
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012020_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012020_3_24hr.npz
NaN value num: 0
Iteration: 2101, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4502732753753662
loss_pred:0.021224265918135643, decouple_loss:0.008275745436549187
The generated pressure mean: 0.45022863149642944
loss_pred:0.019388223066926003, decouple_loss:0.008360137231647968
The generated pressure mean: 0.4499240815639496
loss_pred:0.021808821707963943, decouple_loss:0.008581671863794327
Iteration: 2102, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4487888514995575
loss_pred:0.020911360159516335, decouple_loss:0.009543153457343578
The generated pressure mean: 0.4507087469100952
loss_pred:0.019527241587638855, decouple_loss:0.009403356350958347
The generated pressure mean: 0.44990766048431396
loss_pred:0.0200282484292984, decouple_loss:0.009639489464461803
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 2103, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4507252275943756
loss_pred:0.02306242100894451, decouple_loss:0.00953584909439087
The generated pressure mean: 0.4511689841747284
loss_pred:0.0206756591796875, decouple_loss:0.009447627700865269
The generated pressure mean: 0.45136407017707825
loss_pred:0.020734168589115143, decouple_loss:0.009421436116099358
Iteration: 2104, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44982197880744934
loss_pred:0.021127816289663315, decouple_loss:0.008785988204181194
The generated pressure mean: 0.4503755569458008
loss_pred:0.01932983659207821, decouple_loss:0.008634159341454506
The generated pressure mean: 0.4502347707748413
loss_pred:0.021237852051854134, decouple_loss:0.008769950829446316
Iteration: 2105, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4498298168182373
loss_pred:0.020473016425967216, decouple_loss:0.009612423367798328The generated pressure mean: 0.4510950744152069
loss_pred:0.02129962481558323, decouple_loss:0.009964910335838795
The generated pressure mean: 0.44989803433418274
loss_pred:0.019605742767453194, decouple_loss:0.009405509568750858
Iteration: 2106, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44979241490364075
loss_pred:0.019928952679038048, decouple_loss:0.00980551540851593
The generated pressure mean: 0.4499276876449585
loss_pred:0.01994880475103855, decouple_loss:0.009956778958439827
The generated pressure mean: 0.4509544372558594
loss_pred:0.02028839848935604, decouple_loss:0.009883836843073368
Iteration: 2107, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45065784454345703
The generated pressure mean: 0.45067721605300903
loss_pred:0.021051252260804176, decouple_loss:0.008513962849974632
loss_pred:0.02182348258793354, decouple_loss:0.009037514217197895
The generated pressure mean: 0.4500134289264679
loss_pred:0.01986822858452797, decouple_loss:0.008723574690520763
Iteration: 2108, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4497091770172119
The generated pressure mean: 0.45047569274902344
loss_pred:0.020697465166449547, decouple_loss:0.00902435090392828
loss_pred:0.01883072406053543, decouple_loss:0.009193634614348412
The generated pressure mean: 0.450743168592453
loss_pred:0.021639559417963028, decouple_loss:0.009217560291290283
Iteration: 2109, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4492860436439514
loss_pred:0.021676838397979736, decouple_loss:0.009678427129983902
The generated pressure mean: 0.4513509273529053
loss_pred:0.019783660769462585, decouple_loss:0.00935881957411766
The generated pressure mean: 0.4512910544872284
loss_pred:0.01986323855817318, decouple_loss:0.009785771369934082
Iteration: 2110, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4508555233478546
loss_pred:0.019973382353782654, decouple_loss:0.008786004967987537
The generated pressure mean: 0.44870272278785706
loss_pred:0.019423143938183784, decouple_loss:0.009102321229875088
The generated pressure mean: 0.45015889406204224
loss_pred:0.020938526839017868, decouple_loss:0.008535872213542461
2023-04-16 09:54:35 testing...
The generated pressure mean: 0.4502691328525543
loss_pred:0.132484570145607, decouple_loss:0.046598710119724274
The generated pressure mean: 0.4500291049480438
loss_pred:0.1318414956331253, decouple_loss:0.046152759343385696
The generated pressure mean: 0.45032402873039246
loss_pred:0.13140173256397247, decouple_loss:0.046529002487659454
Loss: 0.1342306137084961, avg_mse: 0.2572973966598511
current test mse: 0.257297
Iteration: 2111, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.449474960565567
The generated pressure mean: 0.4510209262371063
loss_pred:0.02000308968126774, decouple_loss:0.00854418147355318
loss_pred:0.02115575596690178, decouple_loss:0.00852955412119627
The generated pressure mean: 0.45180851221084595
loss_pred:0.02050226368010044, decouple_loss:0.008372264914214611
Iteration: 2112, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44918572902679443
loss_pred:0.0201643705368042, decouple_loss:0.008232612162828445
The generated pressure mean: 0.4504358768463135
loss_pred:0.019292572513222694, decouple_loss:0.008469613268971443
The generated pressure mean: 0.45083087682724
loss_pred:0.02220502868294716, decouple_loss:0.009158283472061157
Iteration: 2113, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44997671246528625
loss_pred:0.019255004823207855, decouple_loss:0.007956079207360744
The generated pressure mean: 0.4496217370033264
loss_pred:0.01868818886578083, decouple_loss:0.007986322045326233
The generated pressure mean: 0.44997990131378174
loss_pred:0.01964903250336647, decouple_loss:0.008040106855332851
Iteration: 2114, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45091649889945984
loss_pred:0.01950019598007202, decouple_loss:0.008943254128098488
The generated pressure mean: 0.4502400755882263
loss_pred:0.019487904384732246, decouple_loss:0.008435074239969254
The generated pressure mean: 0.44928497076034546
loss_pred:0.024050522595643997, decouple_loss:0.008543036878108978
Iteration: 2115, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4505082070827484
loss_pred:0.02114294096827507, decouple_loss:0.008201825432479382
The generated pressure mean: 0.449258953332901
loss_pred:0.019678736105561256, decouple_loss:0.00847192108631134
The generated pressure mean: 0.4496822655200958
loss_pred:0.019584449008107185, decouple_loss:0.008363805711269379
Iteration: 2116, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44929811358451843
The generated pressure mean: 0.44992417097091675
loss_pred:0.0206144992262125, decouple_loss:0.007987769320607185
loss_pred:0.01971394196152687, decouple_loss:0.007882830686867237
The generated pressure mean: 0.4500468075275421
loss_pred:0.021296488121151924, decouple_loss:0.007987276650965214
Iteration: 2117, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45126083493232727
The generated pressure mean: 0.45081162452697754loss_pred:0.019748395308852196, decouple_loss:0.008401388302445412
loss_pred:0.02146945893764496, decouple_loss:0.008131267502903938
The generated pressure mean: 0.44954270124435425
loss_pred:0.02041660249233246, decouple_loss:0.008130131289362907
Iteration: 2118, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4511953592300415
loss_pred:0.02038791961967945, decouple_loss:0.007750730495899916
The generated pressure mean: 0.4514017403125763
loss_pred:0.019536051899194717, decouple_loss:0.00804302841424942
The generated pressure mean: 0.45077013969421387
loss_pred:0.020187921822071075, decouple_loss:0.008189788088202477
Iteration: 2119, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45068076252937317The generated pressure mean: 0.4507192373275757
loss_pred:0.0202629417181015, decouple_loss:0.008242242969572544
loss_pred:0.02072099968791008, decouple_loss:0.008477699011564255
The generated pressure mean: 0.4504615068435669
loss_pred:0.020850151777267456, decouple_loss:0.008916129358112812
Iteration: 2120, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45030003786087036
loss_pred:0.01952774077653885, decouple_loss:0.008292173966765404
The generated pressure mean: 0.45013150572776794
loss_pred:0.019328080117702484, decouple_loss:0.008084666915237904
The generated pressure mean: 0.45034897327423096
loss_pred:0.019552014768123627, decouple_loss:0.008470587432384491
2023-04-16 09:56:40 testing...
The generated pressure mean: 0.4502691328525543
loss_pred:0.12645962834358215, decouple_loss:0.04557046666741371
The generated pressure mean: 0.4503233730792999
loss_pred:0.12524861097335815, decouple_loss:0.0453825481235981
The generated pressure mean: 0.4500332772731781
loss_pred:0.1255854219198227, decouple_loss:0.04480176791548729
Loss: 0.12802714109420776, avg_mse: 0.2444097250699997
current test mse: 0.24441
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012014_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012014_3_24hr.npz
NaN value num: 0
Iteration: 2121, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44811373949050903
loss_pred:0.019492553547024727, decouple_loss:0.008775131776928902
The generated pressure mean: 0.44783467054367065
loss_pred:0.020569493994116783, decouple_loss:0.008658832870423794
The generated pressure mean: 0.4489120543003082
loss_pred:0.02091326005756855, decouple_loss:0.0086137056350708
Iteration: 2122, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44795772433280945
loss_pred:0.01902095414698124, decouple_loss:0.008554311469197273
The generated pressure mean: 0.44810137152671814
loss_pred:0.019732484593987465, decouple_loss:0.008576689288020134
The generated pressure mean: 0.44837984442710876
loss_pred:0.02144472301006317, decouple_loss:0.008653674274682999
Iteration: 2123, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4487951695919037
loss_pred:0.0215767752379179, decouple_loss:0.008706824854016304
The generated pressure mean: 0.4483242332935333
loss_pred:0.02010052092373371, decouple_loss:0.008967449888586998
The generated pressure mean: 0.44837626814842224
loss_pred:0.020947018638253212, decouple_loss:0.008636686950922012
Iteration: 2124, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4480222463607788
loss_pred:0.020047606900334358, decouple_loss:0.00841483287513256
The generated pressure mean: 0.44831010699272156
loss_pred:0.019775714725255966, decouple_loss:0.008443867787718773
The generated pressure mean: 0.44833269715309143
loss_pred:0.021118775010108948, decouple_loss:0.008540606126189232
Iteration: 2125, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44913533329963684
loss_pred:0.019606303423643112, decouple_loss:0.009554533287882805
The generated pressure mean: 0.4481182098388672
loss_pred:0.021888989955186844, decouple_loss:0.009346632286906242
The generated pressure mean: 0.4494208097457886
loss_pred:0.02143792435526848, decouple_loss:0.009385321289300919
Iteration: 2126, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4477064609527588
loss_pred:0.02117818221449852, decouple_loss:0.010524244047701359
The generated pressure mean: 0.4479468762874603
loss_pred:0.01992221735417843, decouple_loss:0.010061923414468765
The generated pressure mean: 0.44841238856315613
loss_pred:0.01963959075510502, decouple_loss:0.010050544515252113
Iteration: 2127, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4479178190231323
loss_pred:0.018611833453178406, decouple_loss:0.008921844884753227
The generated pressure mean: 0.44845524430274963
loss_pred:0.01921597681939602, decouple_loss:0.009130217134952545
The generated pressure mean: 0.44930410385131836
loss_pred:0.021031146869063377, decouple_loss:0.009021795354783535
Iteration: 2128, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4480222761631012
loss_pred:0.022764144465327263, decouple_loss:0.010263490490615368
The generated pressure mean: 0.4483022689819336
loss_pred:0.019472548738121986, decouple_loss:0.010046877898275852
The generated pressure mean: 0.4478410482406616
loss_pred:0.019387032836675644, decouple_loss:0.009318429045379162
Iteration: 2129, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44781193137168884
loss_pred:0.018405627459287643, decouple_loss:0.009791085496544838
The generated pressure mean: 0.44738781452178955
loss_pred:0.019276510924100876, decouple_loss:0.009342976845800877
The generated pressure mean: 0.446746289730072
loss_pred:0.020321479067206383, decouple_loss:0.00979112833738327
Iteration: 2130, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44874003529548645
loss_pred:0.0195804163813591, decouple_loss:0.009151634760200977
The generated pressure mean: 0.4477022588253021
loss_pred:0.020244315266609192, decouple_loss:0.008915319107472897
The generated pressure mean: 0.44727346301078796
loss_pred:0.020693346858024597, decouple_loss:0.009169328026473522
2023-04-16 09:59:20 testing...
The generated pressure mean: 0.4502691924571991
loss_pred:0.1278640627861023, decouple_loss:0.04653521627187729
The generated pressure mean: 0.4500311613082886
loss_pred:0.12711545825004578, decouple_loss:0.046726737171411514
The generated pressure mean: 0.45032256841659546
loss_pred:0.12693440914154053, decouple_loss:0.04702456295490265
Loss: 0.12964275479316711, avg_mse: 0.2453629970550537
current test mse: 0.245363
Iteration: 2131, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44844454526901245
loss_pred:0.01880701258778572, decouple_loss:0.010294027626514435
The generated pressure mean: 0.44948238134384155
loss_pred:0.021251525729894638, decouple_loss:0.010804969817399979
The generated pressure mean: 0.44791439175605774
loss_pred:0.020269589498639107, decouple_loss:0.010757788084447384
Iteration: 2132, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4481619596481323
loss_pred:0.021551143378019333, decouple_loss:0.009365118108689785
The generated pressure mean: 0.44958236813545227
loss_pred:0.019307684153318405, decouple_loss:0.009642076678574085
The generated pressure mean: 0.4471544325351715
loss_pred:0.019362671300768852, decouple_loss:0.009432812221348286
Iteration: 2133, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.448318213224411
loss_pred:0.018457792699337006, decouple_loss:0.009395220316946507
The generated pressure mean: 0.448883980512619
loss_pred:0.01861904188990593, decouple_loss:0.009427839890122414
The generated pressure mean: 0.4477096498012543
loss_pred:0.020027946680784225, decouple_loss:0.0096183056011796
Iteration: 2134, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4476373791694641
loss_pred:0.021855730563402176, decouple_loss:0.008573915809392929
The generated pressure mean: 0.44864940643310547
loss_pred:0.018623650074005127, decouple_loss:0.008712450042366982
The generated pressure mean: 0.4488709270954132
loss_pred:0.02028362825512886, decouple_loss:0.008497461676597595
Iteration: 2135, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44793400168418884
loss_pred:0.02073165960609913, decouple_loss:0.009691895917057991
The generated pressure mean: 0.44752082228660583
loss_pred:0.018381712958216667, decouple_loss:0.00927007757127285
The generated pressure mean: 0.4481365978717804
loss_pred:0.02154376544058323, decouple_loss:0.009507033042609692
Iteration: 2136, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44779571890830994
loss_pred:0.01972213387489319, decouple_loss:0.00945036206394434
The generated pressure mean: 0.4478389024734497
loss_pred:0.019956283271312714, decouple_loss:0.009637434966862202
The generated pressure mean: 0.4475433826446533
loss_pred:0.01937449350953102, decouple_loss:0.00917324610054493
Iteration: 2137, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44886115193367004
loss_pred:0.018612004816532135, decouple_loss:0.009617561474442482
The generated pressure mean: 0.448839008808136
loss_pred:0.020662400871515274, decouple_loss:0.00970794539898634
The generated pressure mean: 0.4466971457004547
loss_pred:0.01979469135403633, decouple_loss:0.009635892696678638
Iteration: 2138, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4485541582107544
loss_pred:0.02013799361884594, decouple_loss:0.008537662215530872
The generated pressure mean: 0.44818514585494995
loss_pred:0.019378066062927246, decouple_loss:0.008237253874540329
The generated pressure mean: 0.4482320249080658
loss_pred:0.01913902722299099, decouple_loss:0.008782216347754002
Iteration: 2139, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4482850134372711
The generated pressure mean: 0.4480002522468567
loss_pred:0.019106881693005562, decouple_loss:0.010587893426418304
loss_pred:0.020128348842263222, decouple_loss:0.010134460404515266
The generated pressure mean: 0.44895556569099426
loss_pred:0.020276783034205437, decouple_loss:0.010077015496790409
Iteration: 2140, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4483332931995392The generated pressure mean: 0.4482429623603821
loss_pred:0.01981222629547119, decouple_loss:0.010278100147843361
loss_pred:0.020690232515335083, decouple_loss:0.010243288241326809
The generated pressure mean: 0.4474117159843445
loss_pred:0.01949034072458744, decouple_loss:0.010660347528755665
2023-04-16 10:01:25 testing...
The generated pressure mean: 0.4502691626548767
loss_pred:0.13150851428508759, decouple_loss:0.04744882136583328
The generated pressure mean: 0.45032355189323425
loss_pred:0.13042768836021423, decouple_loss:0.04742308333516121
The generated pressure mean: 0.4500282406806946
loss_pred:0.1309250295162201, decouple_loss:0.0468478687107563
Loss: 0.13331574201583862, avg_mse: 0.2542777359485626
current test mse: 0.254278
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012002_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012002_3_24hr.npz
NaN value num: 0
Iteration: 2141, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4465499222278595
loss_pred:0.019520292058587074, decouple_loss:0.009711840189993382
The generated pressure mean: 0.44803115725517273
loss_pred:0.021706294268369675, decouple_loss:0.009222633205354214
The generated pressure mean: 0.4467996060848236
loss_pred:0.02058272995054722, decouple_loss:0.009532551281154156
Iteration: 2142, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4468971788883209
loss_pred:0.02037687972187996, decouple_loss:0.01058531366288662
The generated pressure mean: 0.4476828873157501
loss_pred:0.019718145951628685, decouple_loss:0.011018154211342335
The generated pressure mean: 0.4484369456768036
loss_pred:0.019484028220176697, decouple_loss:0.010757255367934704
Iteration: 2143, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4469969570636749
loss_pred:0.019472479820251465, decouple_loss:0.008641203865408897
The generated pressure mean: 0.448481023311615
loss_pred:0.02045064978301525, decouple_loss:0.008800302632153034
The generated pressure mean: 0.44615232944488525
loss_pred:0.020368415862321854, decouple_loss:0.00895716343075037
Iteration: 2144, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44607433676719666
loss_pred:0.019403966143727303, decouple_loss:0.00924487691372633
The generated pressure mean: 0.4477884769439697
loss_pred:0.019745096564292908, decouple_loss:0.009176618419587612
The generated pressure mean: 0.44870880246162415
loss_pred:0.01960913836956024, decouple_loss:0.00938965380191803
Iteration: 2145, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4470251500606537
loss_pred:0.020240291953086853, decouple_loss:0.009846169501543045
The generated pressure mean: 0.4477062225341797
loss_pred:0.020424585789442062, decouple_loss:0.009926478378474712
The generated pressure mean: 0.44798359274864197
loss_pred:0.01988985575735569, decouple_loss:0.009739925153553486
Iteration: 2146, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44810253381729126
loss_pred:0.020547688007354736, decouple_loss:0.008400104939937592
The generated pressure mean: 0.44845151901245117
loss_pred:0.018323397263884544, decouple_loss:0.00820560846477747
The generated pressure mean: 0.44712013006210327
loss_pred:0.021851258352398872, decouple_loss:0.008119121193885803
Iteration: 2147, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44885775446891785
loss_pred:0.018866868689656258, decouple_loss:0.00821042899042368
The generated pressure mean: 0.44802629947662354
loss_pred:0.02079124189913273, decouple_loss:0.008442149497568607
The generated pressure mean: 0.4468414783477783
loss_pred:0.020312445238232613, decouple_loss:0.008455428294837475
Iteration: 2148, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44843554496765137
loss_pred:0.02103329449892044, decouple_loss:0.008694595657289028
The generated pressure mean: 0.4486754834651947
loss_pred:0.01939486153423786, decouple_loss:0.008569208905100822
The generated pressure mean: 0.4475387632846832
loss_pred:0.020578959956765175, decouple_loss:0.008497893810272217
Iteration: 2149, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.447021484375
The generated pressure mean: 0.44738632440567017loss_pred:0.02005094103515148, decouple_loss:0.008722661063075066
loss_pred:0.020156271755695343, decouple_loss:0.008325963281095028
The generated pressure mean: 0.44725531339645386
loss_pred:0.02045469731092453, decouple_loss:0.008429066278040409
Iteration: 2150, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4471774101257324
loss_pred:0.02012096904218197, decouple_loss:0.00835786946117878
The generated pressure mean: 0.44667941331863403
loss_pred:0.019389858469367027, decouple_loss:0.008240853436291218
The generated pressure mean: 0.4481753408908844
loss_pred:0.01772007904946804, decouple_loss:0.008010069839656353
2023-04-16 10:04:05 testing...
The generated pressure mean: 0.4502691924571991
loss_pred:0.1296876072883606, decouple_loss:0.04542749747633934
The generated pressure mean: 0.45032113790512085
loss_pred:0.12851156294345856, decouple_loss:0.0453832782804966
The generated pressure mean: 0.4500308334827423
loss_pred:0.1291235387325287, decouple_loss:0.045362647622823715
Loss: 0.13137713074684143, avg_mse: 0.2524240016937256
current test mse: 0.252424
Iteration: 2151, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.447846382856369
loss_pred:0.01801924780011177, decouple_loss:0.00892700906842947
The generated pressure mean: 0.4478475749492645
loss_pred:0.01994144171476364, decouple_loss:0.009079551324248314
The generated pressure mean: 0.44840767979621887
loss_pred:0.018574213609099388, decouple_loss:0.009371845051646233
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 2152, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4455508887767792
loss_pred:0.019045408815145493, decouple_loss:0.00937151350080967
The generated pressure mean: 0.447060763835907
loss_pred:0.018152881413698196, decouple_loss:0.009371461346745491
The generated pressure mean: 0.44960707426071167
loss_pred:0.019852332770824432, decouple_loss:0.009729058481752872
Iteration: 2153, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44779396057128906
loss_pred:0.01922157034277916, decouple_loss:0.008812576532363892
The generated pressure mean: 0.44777360558509827
loss_pred:0.02206757664680481, decouple_loss:0.008866634219884872
The generated pressure mean: 0.4471838176250458
loss_pred:0.019076181575655937, decouple_loss:0.00853637419641018
Iteration: 2154, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44642385840415955
loss_pred:0.020435389131307602, decouple_loss:0.008099532686173916
The generated pressure mean: 0.4481204152107239
loss_pred:0.018588056787848473, decouple_loss:0.007671277970075607
The generated pressure mean: 0.4472546875476837
loss_pred:0.021426843479275703, decouple_loss:0.007898954674601555
Iteration: 2155, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4473103880882263
loss_pred:0.019827648997306824, decouple_loss:0.007874695584177971
The generated pressure mean: 0.447510689496994
loss_pred:0.01975814625620842, decouple_loss:0.007905988022685051
The generated pressure mean: 0.4475506544113159
loss_pred:0.019075797870755196, decouple_loss:0.007782295346260071
Iteration: 2156, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4472008943557739
The generated pressure mean: 0.44853445887565613
loss_pred:0.01904376409947872, decouple_loss:0.007813767530024052
loss_pred:0.020061872899532318, decouple_loss:0.007622043136507273
The generated pressure mean: 0.447272926568985
loss_pred:0.019212529063224792, decouple_loss:0.0076669203117489815
Iteration: 2157, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4474911391735077
The generated pressure mean: 0.44912198185920715loss_pred:0.020527120679616928, decouple_loss:0.007579963654279709
loss_pred:0.02128581330180168, decouple_loss:0.00748119642958045
The generated pressure mean: 0.44780632853507996
loss_pred:0.018812477588653564, decouple_loss:0.007472014054656029
Iteration: 2158, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44758880138397217The generated pressure mean: 0.4489744007587433
loss_pred:0.019335128366947174, decouple_loss:0.007766212336719036
loss_pred:0.020343327894806862, decouple_loss:0.00778337474912405
The generated pressure mean: 0.44645166397094727
loss_pred:0.020122960209846497, decouple_loss:0.0076522608287632465
Iteration: 2159, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4482913911342621
loss_pred:0.020695310086011887, decouple_loss:0.007872402667999268
The generated pressure mean: 0.44703420996665955
loss_pred:0.02032885141670704, decouple_loss:0.007590091321617365
The generated pressure mean: 0.44637733697891235
loss_pred:0.019459234550595284, decouple_loss:0.007461166940629482
Iteration: 2160, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44558387994766235
The generated pressure mean: 0.44830256700515747
loss_pred:0.019447946920990944, decouple_loss:0.007670860271900892
loss_pred:0.01854882203042507, decouple_loss:0.007293487899005413
The generated pressure mean: 0.4468722939491272
loss_pred:0.020401809364557266, decouple_loss:0.007504976354539394
2023-04-16 10:06:10 testing...
The generated pressure mean: 0.4502691328525543
loss_pred:0.1310218721628189, decouple_loss:0.04594975337386131
The generated pressure mean: 0.45032599568367004
loss_pred:0.1298871636390686, decouple_loss:0.04630257934331894
The generated pressure mean: 0.4500303566455841
loss_pred:0.13050499558448792, decouple_loss:0.045887287706136703
Loss: 0.13277366757392883, avg_mse: 0.25611549615859985
current test mse: 0.256116
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012004_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012004_3_24hr.npz
NaN value num: 0
Iteration: 2161, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4476446509361267
loss_pred:0.01826569065451622, decouple_loss:0.0077725620940327644
The generated pressure mean: 0.45145949721336365
loss_pred:0.021307608112692833, decouple_loss:0.007820076309144497
The generated pressure mean: 0.44795653223991394
loss_pred:0.01985243707895279, decouple_loss:0.007537218276411295
Iteration: 2162, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4489796757698059
loss_pred:0.021468324586749077, decouple_loss:0.007925745099782944
The generated pressure mean: 0.4478943943977356
loss_pred:0.01908746175467968, decouple_loss:0.007717218715697527
The generated pressure mean: 0.4486790597438812
loss_pred:0.021424425765872, decouple_loss:0.008204365149140358
Iteration: 2163, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44672876596450806The generated pressure mean: 0.4507785439491272
loss_pred:0.018990760669112206, decouple_loss:0.009979872964322567
loss_pred:0.019529173150658607, decouple_loss:0.009919075295329094
The generated pressure mean: 0.44965797662734985
loss_pred:0.019792912527918816, decouple_loss:0.009792759083211422
Iteration: 2164, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44886016845703125
loss_pred:0.01975144073367119, decouple_loss:0.00854102149605751
The generated pressure mean: 0.4493323266506195
loss_pred:0.017929844558238983, decouple_loss:0.008640903048217297
The generated pressure mean: 0.4490489363670349
loss_pred:0.020887341350317, decouple_loss:0.008848316967487335
Iteration: 2165, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44932082295417786
The generated pressure mean: 0.4478500187397003
loss_pred:0.019403714686632156, decouple_loss:0.009017975069582462
loss_pred:0.018425362184643745, decouple_loss:0.009845048189163208
The generated pressure mean: 0.4482409954071045
loss_pred:0.020484939217567444, decouple_loss:0.009852632880210876
Iteration: 2166, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44835132360458374
loss_pred:0.019083576276898384, decouple_loss:0.010628951713442802
The generated pressure mean: 0.44876036047935486
loss_pred:0.019426090642809868, decouple_loss:0.010105768218636513
The generated pressure mean: 0.44853782653808594
loss_pred:0.019212139770388603, decouple_loss:0.010816890746355057
Iteration: 2167, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4485020339488983
The generated pressure mean: 0.4493650794029236loss_pred:0.019929246976971626, decouple_loss:0.008510973304510117
loss_pred:0.018966631963849068, decouple_loss:0.009006554260849953
The generated pressure mean: 0.4490785300731659
loss_pred:0.018284659832715988, decouple_loss:0.008690204471349716
Iteration: 2168, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44861987233161926
loss_pred:0.020532311871647835, decouple_loss:0.010907381772994995
The generated pressure mean: 0.44736576080322266
loss_pred:0.018763072788715363, decouple_loss:0.0113454544916749
The generated pressure mean: 0.4488345682621002
loss_pred:0.018157636746764183, decouple_loss:0.010898093692958355
Iteration: 2169, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.449232280254364The generated pressure mean: 0.44846048951148987
loss_pred:0.018596693873405457, decouple_loss:0.00958309881389141
loss_pred:0.018290912732481956, decouple_loss:0.008864183910191059
The generated pressure mean: 0.4486760199069977
loss_pred:0.01870417594909668, decouple_loss:0.008770911023020744
Iteration: 2170, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4501955509185791
The generated pressure mean: 0.4488879144191742loss_pred:0.018224911764264107, decouple_loss:0.009058303199708462
loss_pred:0.01775316894054413, decouple_loss:0.008895006962120533
The generated pressure mean: 0.44929197430610657
loss_pred:0.018480421975255013, decouple_loss:0.009626401588320732
2023-04-16 10:08:53 testing...
The generated pressure mean: 0.4502691626548767
loss_pred:0.1284409463405609, decouple_loss:0.045870788395404816
The generated pressure mean: 0.45032599568367004
loss_pred:0.12759743630886078, decouple_loss:0.04576694965362549
The generated pressure mean: 0.4500344395637512
loss_pred:0.12801885604858398, decouple_loss:0.0458686500787735
Loss: 0.13031086325645447, avg_mse: 0.2478770911693573
current test mse: 0.247877
Iteration: 2171, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44921010732650757
The generated pressure mean: 0.44918984174728394loss_pred:0.019464949145913124, decouple_loss:0.009930289350450039
loss_pred:0.0201474130153656, decouple_loss:0.01008292194455862
The generated pressure mean: 0.44706064462661743
loss_pred:0.018159525468945503, decouple_loss:0.010341609828174114
Iteration: 2172, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44844329357147217
loss_pred:0.01846839301288128, decouple_loss:0.009486809372901917
The generated pressure mean: 0.44992896914482117
loss_pred:0.01869485341012478, decouple_loss:0.010252201929688454
The generated pressure mean: 0.4487496018409729
loss_pred:0.018966680392622948, decouple_loss:0.009221045300364494
Iteration: 2173, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44891971349716187
loss_pred:0.01987985521554947, decouple_loss:0.008676963858306408
The generated pressure mean: 0.44998231530189514
The generated pressure mean: 0.4492943286895752
loss_pred:0.019311195239424706, decouple_loss:0.00887221097946167
loss_pred:0.019533339887857437, decouple_loss:0.009010364301502705
Iteration: 2174, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44811582565307617
loss_pred:0.018525313585996628, decouple_loss:0.008223804645240307
The generated pressure mean: 0.4489077031612396
loss_pred:0.01928979903459549, decouple_loss:0.008396043442189693
The generated pressure mean: 0.4493357241153717
loss_pred:0.01886681094765663, decouple_loss:0.008412961848080158
Iteration: 2175, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44839727878570557
loss_pred:0.018889490514993668, decouple_loss:0.008027687668800354
The generated pressure mean: 0.44696804881095886
loss_pred:0.020365513861179352, decouple_loss:0.0084760133177042
The generated pressure mean: 0.44863632321357727
loss_pred:0.018587183207273483, decouple_loss:0.008316189050674438
Iteration: 2176, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44941243529319763
The generated pressure mean: 0.44832414388656616loss_pred:0.018755780532956123, decouple_loss:0.0074794357642531395
loss_pred:0.018615514039993286, decouple_loss:0.0076176500879228115
The generated pressure mean: 0.44892895221710205
loss_pred:0.019208719953894615, decouple_loss:0.00787885021418333
Iteration: 2177, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4489489793777466
loss_pred:0.018599683418869972, decouple_loss:0.008013042621314526
The generated pressure mean: 0.448164701461792
loss_pred:0.020343877375125885, decouple_loss:0.008047212846577168
The generated pressure mean: 0.44708436727523804
loss_pred:0.01864771731197834, decouple_loss:0.008268296718597412
Iteration: 2178, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.449807345867157
loss_pred:0.02041257731616497, decouple_loss:0.007946997880935669
The generated pressure mean: 0.4480586051940918
loss_pred:0.018233275040984154, decouple_loss:0.007981561124324799
The generated pressure mean: 0.44818592071533203
loss_pred:0.019794946536421776, decouple_loss:0.007872277870774269
Iteration: 2179, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4471341669559479
loss_pred:0.018233075737953186, decouple_loss:0.008242799900472164
The generated pressure mean: 0.4481389820575714
loss_pred:0.01962275616824627, decouple_loss:0.0081299664452672
The generated pressure mean: 0.4488608241081238
loss_pred:0.019943051040172577, decouple_loss:0.00813358649611473
Iteration: 2180, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44836676120758057
loss_pred:0.02065935730934143, decouple_loss:0.007577480748295784
The generated pressure mean: 0.45075634121894836
loss_pred:0.01888817735016346, decouple_loss:0.007811101619154215
The generated pressure mean: 0.44882774353027344
loss_pred:0.019261693581938744, decouple_loss:0.00784214772284031
2023-04-16 10:10:58 testing...
The generated pressure mean: 0.4502691626548767
loss_pred:0.13076059520244598, decouple_loss:0.045002494007349014
The generated pressure mean: 0.4503260552883148
loss_pred:0.12961091101169586, decouple_loss:0.04536782205104828
The generated pressure mean: 0.45003417134284973
loss_pred:0.13038799166679382, decouple_loss:0.044953662902116776
Loss: 0.1325085610151291, avg_mse: 0.2546728253364563
current test mse: 0.254673
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012005_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012005_3_24hr.npz
NaN value num: 0
Iteration: 2181, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.449718177318573
loss_pred:0.01939740590751171, decouple_loss:0.00803802628070116
The generated pressure mean: 0.44935908913612366
loss_pred:0.01873546838760376, decouple_loss:0.007596001960337162
The generated pressure mean: 0.4479464888572693
loss_pred:0.020115261897444725, decouple_loss:0.007295381277799606
Iteration: 2182, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44813597202301025
loss_pred:0.020014628767967224, decouple_loss:0.007425569463521242
The generated pressure mean: 0.44920238852500916
loss_pred:0.01901119388639927, decouple_loss:0.007283670827746391
The generated pressure mean: 0.4472350478172302
loss_pred:0.021464496850967407, decouple_loss:0.00739361671730876
Iteration: 2183, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4491974115371704
loss_pred:0.018805742263793945, decouple_loss:0.007044991012662649
The generated pressure mean: 0.4494639039039612
The generated pressure mean: 0.4487816095352173loss_pred:0.01942131295800209, decouple_loss:0.0069115343503654
loss_pred:0.020637480542063713, decouple_loss:0.0072548361495137215
Iteration: 2184, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4486519992351532
The generated pressure mean: 0.4492790699005127
loss_pred:0.019331974908709526, decouple_loss:0.0076143452897667885
loss_pred:0.019198905676603317, decouple_loss:0.007840937934815884
The generated pressure mean: 0.44878554344177246
loss_pred:0.018694927915930748, decouple_loss:0.008041828870773315
Iteration: 2185, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44921091198921204
loss_pred:0.019106755033135414, decouple_loss:0.009202624671161175
The generated pressure mean: 0.44908246397972107
loss_pred:0.018460465595126152, decouple_loss:0.00914325937628746
The generated pressure mean: 0.4501224458217621
loss_pred:0.019783712923526764, decouple_loss:0.009238732978701591
Iteration: 2186, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44914811849594116
loss_pred:0.021223032847046852, decouple_loss:0.008262827061116695
The generated pressure mean: 0.44955769181251526
loss_pred:0.018846599385142326, decouple_loss:0.007865027524530888
The generated pressure mean: 0.44858574867248535
loss_pred:0.019645722582936287, decouple_loss:0.008156497962772846
Iteration: 2187, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4489653706550598
loss_pred:0.01917499490082264, decouple_loss:0.007683992851525545
The generated pressure mean: 0.4493443965911865
loss_pred:0.019649755209684372, decouple_loss:0.007565288804471493
The generated pressure mean: 0.4493408799171448
loss_pred:0.020611552521586418, decouple_loss:0.007730703800916672
Iteration: 2188, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4485699534416199
The generated pressure mean: 0.44897693395614624
loss_pred:0.018659144639968872, decouple_loss:0.007332899142056704
loss_pred:0.01901041343808174, decouple_loss:0.007379181683063507
The generated pressure mean: 0.44876980781555176
loss_pred:0.018319478258490562, decouple_loss:0.007734797429293394
Iteration: 2189, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44829726219177246
loss_pred:0.01911705732345581, decouple_loss:0.008141374215483665
The generated pressure mean: 0.4486602246761322
loss_pred:0.019743813201785088, decouple_loss:0.008497347123920918
The generated pressure mean: 0.4492630958557129
loss_pred:0.020328113809227943, decouple_loss:0.008056522347033024
Iteration: 2190, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44796639680862427
loss_pred:0.01971774362027645, decouple_loss:0.008133603259921074
The generated pressure mean: 0.44931918382644653
loss_pred:0.02010652795433998, decouple_loss:0.00803762674331665
The generated pressure mean: 0.4493006467819214
loss_pred:0.018387725576758385, decouple_loss:0.00807090476155281
2023-04-16 10:13:41 testing...
The generated pressure mean: 0.4502691924571991
loss_pred:0.13272026181221008, decouple_loss:0.044708505272865295
The generated pressure mean: 0.4503222107887268
loss_pred:0.13131128251552582, decouple_loss:0.044876255095005035
The generated pressure mean: 0.4500325620174408
loss_pred:0.13183623552322388, decouple_loss:0.04434137046337128
Loss: 0.13418804109096527, avg_mse: 0.25848472118377686
current test mse: 0.258485
Iteration: 2191, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44852468371391296
The generated pressure mean: 0.44809046387672424
The generated pressure mean: 0.44887009263038635
loss_pred:0.01956464909017086, decouple_loss:0.007991461083292961
loss_pred:0.01971142739057541, decouple_loss:0.00788181647658348
loss_pred:0.018376585096120834, decouple_loss:0.008072885684669018
Iteration: 2192, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4483223557472229
The generated pressure mean: 0.4496057629585266
loss_pred:0.019183149561285973, decouple_loss:0.008368194103240967
loss_pred:0.018488725647330284, decouple_loss:0.008247309364378452
The generated pressure mean: 0.4501316249370575
loss_pred:0.01875361241400242, decouple_loss:0.00855201669037342
Iteration: 2193, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44951963424682617
The generated pressure mean: 0.4493485689163208
loss_pred:0.019952695816755295, decouple_loss:0.008328679017722607
loss_pred:0.01870865374803543, decouple_loss:0.008432365022599697
The generated pressure mean: 0.4486314058303833
loss_pred:0.018296876922249794, decouple_loss:0.007925440557301044
Iteration: 2194, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45004376769065857
The generated pressure mean: 0.44890713691711426
loss_pred:0.018258851021528244, decouple_loss:0.008515230379998684
loss_pred:0.020583482459187508, decouple_loss:0.008744833059608936
The generated pressure mean: 0.448453813791275
loss_pred:0.019072705879807472, decouple_loss:0.008691038005053997
Iteration: 2195, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44782984256744385
loss_pred:0.020042290911078453, decouple_loss:0.007804039865732193
The generated pressure mean: 0.4477687478065491
loss_pred:0.019223112612962723, decouple_loss:0.00781770795583725
The generated pressure mean: 0.4491627514362335
loss_pred:0.01918206736445427, decouple_loss:0.008181256242096424
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 2196, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4486183524131775
loss_pred:0.019215736538171768, decouple_loss:0.008415586315095425
The generated pressure mean: 0.44929349422454834
loss_pred:0.018673153594136238, decouple_loss:0.00801966805011034
The generated pressure mean: 0.4481584131717682
loss_pred:0.018774056807160378, decouple_loss:0.00813823938369751
Iteration: 2197, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.449133038520813
loss_pred:0.018741736188530922, decouple_loss:0.008401419967412949
The generated pressure mean: 0.44977855682373047
loss_pred:0.01951875165104866, decouple_loss:0.00827905535697937
The generated pressure mean: 0.44833770394325256
loss_pred:0.021315736696124077, decouple_loss:0.008542846888303757
Iteration: 2198, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4490477442741394
The generated pressure mean: 0.44800493121147156loss_pred:0.018921134993433952, decouple_loss:0.009240723215043545
loss_pred:0.018005603924393654, decouple_loss:0.009185167029500008
The generated pressure mean: 0.44692671298980713
loss_pred:0.019544240087270737, decouple_loss:0.009948085062205791
Iteration: 2199, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4484287202358246The generated pressure mean: 0.44940000772476196
loss_pred:0.01910277083516121, decouple_loss:0.00910041481256485
loss_pred:0.019270891323685646, decouple_loss:0.0086931511759758
The generated pressure mean: 0.44920891523361206
loss_pred:0.01956142857670784, decouple_loss:0.009008415043354034
Iteration: 2200, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44926759600639343
loss_pred:0.019208410754799843, decouple_loss:0.008041050285100937
The generated pressure mean: 0.44990700483322144
loss_pred:0.01861659809947014, decouple_loss:0.008231580257415771
The generated pressure mean: 0.4488045871257782
loss_pred:0.021060755476355553, decouple_loss:0.008294304832816124
2023-04-16 10:15:47 testing...
The generated pressure mean: 0.4502691626548767
loss_pred:0.1357283592224121, decouple_loss:0.045712683349847794
The generated pressure mean: 0.45032280683517456
loss_pred:0.13446374237537384, decouple_loss:0.04650833085179329
The generated pressure mean: 0.4500298500061035
loss_pred:0.13491728901863098, decouple_loss:0.04609168320894241
Loss: 0.1373416781425476, avg_mse: 0.26530715823173523
current test mse: 0.265307
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012000_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012000_3_24hr.npz
NaN value num: 0
Iteration: 2201, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4479411840438843
loss_pred:0.0184515081346035, decouple_loss:0.009523224085569382
The generated pressure mean: 0.44718602299690247
loss_pred:0.018897170200943947, decouple_loss:0.009960099123418331
The generated pressure mean: 0.4477517604827881
loss_pred:0.021021906286478043, decouple_loss:0.010018838569521904
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 2202, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4464258849620819
The generated pressure mean: 0.44759342074394226
loss_pred:0.018554722890257835, decouple_loss:0.00875003170222044
The generated pressure mean: 0.4470137655735016loss_pred:0.020099135115742683, decouple_loss:0.00871563982218504
loss_pred:0.0184603463858366, decouple_loss:0.008516799658536911
Iteration: 2203, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4481070339679718
loss_pred:0.019468266516923904, decouple_loss:0.008746789768338203
The generated pressure mean: 0.44814980030059814
loss_pred:0.018772883340716362, decouple_loss:0.008913419209420681
The generated pressure mean: 0.4487333595752716
loss_pred:0.02019874006509781, decouple_loss:0.008652308024466038
Iteration: 2204, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4473790228366852
loss_pred:0.018662668764591217, decouple_loss:0.009151480160653591
The generated pressure mean: 0.4460992217063904
loss_pred:0.02017093077301979, decouple_loss:0.009424055926501751
The generated pressure mean: 0.44824519753456116
loss_pred:0.019417118281126022, decouple_loss:0.009089134633541107
Iteration: 2205, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44726115465164185
loss_pred:0.019095880910754204, decouple_loss:0.008527467958629131
The generated pressure mean: 0.44749099016189575
loss_pred:0.018387824296951294, decouple_loss:0.008504724130034447
The generated pressure mean: 0.44707825779914856
loss_pred:0.018398527055978775, decouple_loss:0.008594337850809097
Iteration: 2206, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4493478536605835
loss_pred:0.01859438233077526, decouple_loss:0.008435193449258804
The generated pressure mean: 0.449017196893692
loss_pred:0.020154403522610664, decouple_loss:0.008851791732013226
The generated pressure mean: 0.4471251368522644
loss_pred:0.019863644614815712, decouple_loss:0.008286138996481895
Iteration: 2207, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44781234860420227
loss_pred:0.019539134576916695, decouple_loss:0.009403189644217491
The generated pressure mean: 0.4472123980522156
loss_pred:0.017485234886407852, decouple_loss:0.00938565842807293
The generated pressure mean: 0.44843611121177673
loss_pred:0.018647324293851852, decouple_loss:0.008985267952084541
Iteration: 2208, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44731405377388
loss_pred:0.01906512677669525, decouple_loss:0.00893155112862587
The generated pressure mean: 0.44603389501571655
loss_pred:0.019353846088051796, decouple_loss:0.009130782447755337
The generated pressure mean: 0.44824904203414917
loss_pred:0.018518002703785896, decouple_loss:0.0089785261079669
Iteration: 2209, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44727566838264465
The generated pressure mean: 0.4471239447593689
loss_pred:0.01917007565498352, decouple_loss:0.00800035148859024
loss_pred:0.01890896074473858, decouple_loss:0.007917373441159725
The generated pressure mean: 0.44861942529678345
loss_pred:0.01878715679049492, decouple_loss:0.007910899817943573
Iteration: 2210, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4479704797267914
loss_pred:0.019579637795686722, decouple_loss:0.008311404846608639
The generated pressure mean: 0.4493418037891388
loss_pred:0.01867641508579254, decouple_loss:0.008313711732625961
The generated pressure mean: 0.4497416019439697
loss_pred:0.018201764672994614, decouple_loss:0.008413862437009811
2023-04-16 10:18:31 testing...
The generated pressure mean: 0.4502691924571991
loss_pred:0.13694386184215546, decouple_loss:0.04621118679642677
The generated pressure mean: 0.4503245949745178
loss_pred:0.13557551801204681, decouple_loss:0.0464143343269825
The generated pressure mean: 0.45003384351730347
loss_pred:0.13605694472789764, decouple_loss:0.046258218586444855
Loss: 0.13850684463977814, avg_mse: 0.2689679265022278
current test mse: 0.268968
Iteration: 2211, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4476032853126526
loss_pred:0.018539663404226303, decouple_loss:0.007921671494841576
The generated pressure mean: 0.447085976600647
loss_pred:0.018589163199067116, decouple_loss:0.007665825542062521
The generated pressure mean: 0.4479261338710785
loss_pred:0.02001010626554489, decouple_loss:0.007814191281795502
Iteration: 2212, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44794952869415283
loss_pred:0.018679901957511902, decouple_loss:0.007708778604865074
The generated pressure mean: 0.44843998551368713
loss_pred:0.018991051241755486, decouple_loss:0.0077559854835271835
The generated pressure mean: 0.4488515257835388
loss_pred:0.019219454377889633, decouple_loss:0.007843155413866043
Iteration: 2213, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4472247064113617
The generated pressure mean: 0.44855034351348877
loss_pred:0.017982883378863335, decouple_loss:0.007313327863812447
loss_pred:0.01901336759328842, decouple_loss:0.0069524324499070644
The generated pressure mean: 0.44702884554862976
loss_pred:0.019523555412888527, decouple_loss:0.0075456793420016766
Iteration: 2214, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4475468099117279
loss_pred:0.018739791586995125, decouple_loss:0.007586832623928785
The generated pressure mean: 0.44746530055999756
loss_pred:0.019663793966174126, decouple_loss:0.007689736317843199
The generated pressure mean: 0.4469057619571686
loss_pred:0.018614444881677628, decouple_loss:0.007600432727485895
Iteration: 2215, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4476771652698517The generated pressure mean: 0.44884446263313293
loss_pred:0.0184943750500679, decouple_loss:0.007296443451195955
loss_pred:0.01904984563589096, decouple_loss:0.007712892722338438
The generated pressure mean: 0.44795656204223633
loss_pred:0.018266774713993073, decouple_loss:0.007226294372230768
Iteration: 2216, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44688284397125244
loss_pred:0.01890621893107891, decouple_loss:0.007824291475117207
The generated pressure mean: 0.44897082448005676
loss_pred:0.020813630893826485, decouple_loss:0.008009567856788635
The generated pressure mean: 0.446709007024765
loss_pred:0.01823166385293007, decouple_loss:0.007530832197517157
Iteration: 2217, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44756290316581726
loss_pred:0.018567552790045738, decouple_loss:0.008777742274105549
The generated pressure mean: 0.446984201669693
loss_pred:0.018133502453565598, decouple_loss:0.008905775845050812
The generated pressure mean: 0.4498240351676941
loss_pred:0.0199427492916584, decouple_loss:0.008673538453876972
Iteration: 2218, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4482596218585968
The generated pressure mean: 0.44839176535606384
loss_pred:0.018985630944371223, decouple_loss:0.00891280360519886
loss_pred:0.018130188807845116, decouple_loss:0.00882925745099783
The generated pressure mean: 0.44805991649627686
loss_pred:0.01830510050058365, decouple_loss:0.009005175903439522
Iteration: 2219, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44749772548675537
The generated pressure mean: 0.4467219114303589
loss_pred:0.01929815113544464, decouple_loss:0.008259791880846024
loss_pred:0.018233701586723328, decouple_loss:0.008546204306185246
The generated pressure mean: 0.4461004436016083
loss_pred:0.018019288778305054, decouple_loss:0.008485297672450542
Iteration: 2220, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4476098418235779
The generated pressure mean: 0.4477161467075348
loss_pred:0.02008727565407753, decouple_loss:0.007894439622759819
loss_pred:0.01822708733379841, decouple_loss:0.007889831438660622
The generated pressure mean: 0.44786545634269714
loss_pred:0.02081356756389141, decouple_loss:0.008171163499355316
2023-04-16 10:20:37 testing...
The generated pressure mean: 0.4502691328525543
loss_pred:0.1375746876001358, decouple_loss:0.04626540467143059
The generated pressure mean: 0.4503253698348999
loss_pred:0.1363629847764969, decouple_loss:0.0469052717089653
The generated pressure mean: 0.45003044605255127
loss_pred:0.13702774047851562, decouple_loss:0.046449240297079086
Loss: 0.13931548595428467, avg_mse: 0.2714020311832428
current test mse: 0.271402
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012019_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012019_3_24hr.npz
NaN value num: 0
Iteration: 2221, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4492710828781128
loss_pred:0.0195326991379261, decouple_loss:0.009724962525069714
The generated pressure mean: 0.44903305172920227
loss_pred:0.019647127017378807, decouple_loss:0.009088115766644478
The generated pressure mean: 0.44968685507774353
loss_pred:0.019839322194457054, decouple_loss:0.009000930935144424
Iteration: 2222, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44954678416252136The generated pressure mean: 0.4487045109272003
loss_pred:0.018575651571154594, decouple_loss:0.007845673710107803loss_pred:0.019429033622145653, decouple_loss:0.007765782997012138
The generated pressure mean: 0.44909846782684326
loss_pred:0.019978268072009087, decouple_loss:0.008267981931567192
Iteration: 2223, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4485151767730713
loss_pred:0.01992460899055004, decouple_loss:0.009078462608158588
The generated pressure mean: 0.4480934143066406
loss_pred:0.021715164184570312, decouple_loss:0.009177355095744133
The generated pressure mean: 0.4499531090259552
loss_pred:0.0185268335044384, decouple_loss:0.009754491969943047
Iteration: 2224, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44995999336242676
loss_pred:0.021467965096235275, decouple_loss:0.008858333341777325
The generated pressure mean: 0.44911205768585205
loss_pred:0.01996639557182789, decouple_loss:0.00897096935659647
The generated pressure mean: 0.4499918818473816
loss_pred:0.01930307224392891, decouple_loss:0.008566413074731827
Iteration: 2225, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4495023190975189
The generated pressure mean: 0.4485855996608734
loss_pred:0.019347280263900757, decouple_loss:0.00964525155723095
loss_pred:0.020100226625800133, decouple_loss:0.009657294489443302
The generated pressure mean: 0.4496293067932129
loss_pred:0.02122226543724537, decouple_loss:0.009689967148005962
Iteration: 2226, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4479030668735504
loss_pred:0.021490521728992462, decouple_loss:0.010482802987098694
The generated pressure mean: 0.44921231269836426
loss_pred:0.01926548220217228, decouple_loss:0.01017740834504366
The generated pressure mean: 0.44956618547439575
loss_pred:0.01970449648797512, decouple_loss:0.009920159354805946
Iteration: 2227, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4498685896396637
loss_pred:0.01943516917526722, decouple_loss:0.010838130488991737
The generated pressure mean: 0.44935810565948486
loss_pred:0.02028512954711914, decouple_loss:0.010282677598297596
The generated pressure mean: 0.4488532841205597
loss_pred:0.018795892596244812, decouple_loss:0.010408739559352398
Iteration: 2228, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4484623074531555
loss_pred:0.019512128084897995, decouple_loss:0.009200101718306541
The generated pressure mean: 0.4500221014022827
loss_pred:0.020128335803747177, decouple_loss:0.009560306556522846
The generated pressure mean: 0.4493449628353119
loss_pred:0.019049454480409622, decouple_loss:0.009109989739954472
Iteration: 2229, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4481174647808075The generated pressure mean: 0.44952309131622314
loss_pred:0.02024764195084572, decouple_loss:0.011018635705113411
loss_pred:0.020040327683091164, decouple_loss:0.011319768615067005
The generated pressure mean: 0.4497300386428833
loss_pred:0.019557273015379906, decouple_loss:0.01146771665662527
Iteration: 2230, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4496130645275116
loss_pred:0.019747037440538406, decouple_loss:0.009379234164953232
The generated pressure mean: 0.4497334063053131
loss_pred:0.01988535374403, decouple_loss:0.00941332709044218
The generated pressure mean: 0.44981884956359863
loss_pred:0.020758824422955513, decouple_loss:0.009306225925683975
2023-04-16 10:23:19 testing...
The generated pressure mean: 0.4502691626548767
loss_pred:0.13927821815013885, decouple_loss:0.04710035398602486
The generated pressure mean: 0.4503242075443268
loss_pred:0.13865576684474945, decouple_loss:0.0476650632917881
The generated pressure mean: 0.4500272870063782
loss_pred:0.13896749913692474, decouple_loss:0.04707207530736923
Loss: 0.14133112132549286, avg_mse: 0.27544525265693665
current test mse: 0.275445
Iteration: 2231, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44877198338508606
loss_pred:0.020596055313944817, decouple_loss:0.011417018249630928
The generated pressure mean: 0.44870486855506897
loss_pred:0.01991550624370575, decouple_loss:0.010274169966578484
The generated pressure mean: 0.4493943750858307
loss_pred:0.01984420232474804, decouple_loss:0.010323966853320599
Iteration: 2232, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4489665627479553
loss_pred:0.020168477669358253, decouple_loss:0.010147463530302048
The generated pressure mean: 0.4489586651325226
loss_pred:0.018471240997314453, decouple_loss:0.010042579844594002
The generated pressure mean: 0.44867071509361267
loss_pred:0.01904008910059929, decouple_loss:0.010153742507100105
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 2233, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4489869177341461
loss_pred:0.02013399265706539, decouple_loss:0.00829296000301838
The generated pressure mean: 0.4496121108531952
loss_pred:0.01988053135573864, decouple_loss:0.008290261961519718
The generated pressure mean: 0.4500470459461212
loss_pred:0.019323615357279778, decouple_loss:0.008379241451621056
Iteration: 2234, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45009949803352356
The generated pressure mean: 0.4483666718006134
loss_pred:0.01870136335492134, decouple_loss:0.009528862312436104
loss_pred:0.020350806415081024, decouple_loss:0.009514139033854008
The generated pressure mean: 0.4487338960170746
loss_pred:0.02004787139594555, decouple_loss:0.010665279813110828
Iteration: 2235, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45005714893341064
The generated pressure mean: 0.4499722421169281loss_pred:0.019018081948161125, decouple_loss:0.008083952590823174
loss_pred:0.019923558458685875, decouple_loss:0.00811037328094244
The generated pressure mean: 0.44854697585105896
loss_pred:0.020564407110214233, decouple_loss:0.00872543640434742
Iteration: 2236, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44812360405921936
The generated pressure mean: 0.4483998417854309
loss_pred:0.022134680300951004, decouple_loss:0.008486405946314335
loss_pred:0.01960291527211666, decouple_loss:0.00838591530919075
The generated pressure mean: 0.44946038722991943
loss_pred:0.018886765465140343, decouple_loss:0.00869026780128479
Iteration: 2237, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4492603540420532
loss_pred:0.018954109400510788, decouple_loss:0.00852483231574297
The generated pressure mean: 0.44876959919929504
loss_pred:0.02056359313428402, decouple_loss:0.008408366702497005
The generated pressure mean: 0.4495670795440674
loss_pred:0.019908837974071503, decouple_loss:0.008582877926528454
Iteration: 2238, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45014870166778564
The generated pressure mean: 0.44965898990631104
loss_pred:0.01895560882985592, decouple_loss:0.008238653652369976
loss_pred:0.01922908052802086, decouple_loss:0.008163274265825748
The generated pressure mean: 0.4491369128227234
loss_pred:0.019770968705415726, decouple_loss:0.008421484380960464
Iteration: 2239, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4495317041873932
loss_pred:0.01806691288948059, decouple_loss:0.008244363591074944
The generated pressure mean: 0.44855162501335144
loss_pred:0.018729431554675102, decouple_loss:0.008345353417098522
The generated pressure mean: 0.4494352638721466
loss_pred:0.019459227100014687, decouple_loss:0.008256803266704082
Iteration: 2240, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4495304822921753
loss_pred:0.019140318036079407, decouple_loss:0.008132443763315678
The generated pressure mean: 0.44972920417785645
loss_pred:0.020794443786144257, decouple_loss:0.008572310209274292
The generated pressure mean: 0.4483933448791504
loss_pred:0.020008664578199387, decouple_loss:0.007905877195298672
2023-04-16 10:25:25 testing...
The generated pressure mean: 0.4502691924571991
loss_pred:0.14255359768867493, decouple_loss:0.04748563840985298
The generated pressure mean: 0.45003071427345276
loss_pred:0.14198695123195648, decouple_loss:0.04776716232299805
The generated pressure mean: 0.45032504200935364
loss_pred:0.14166589081287384, decouple_loss:0.047859031707048416
Loss: 0.1444540023803711, avg_mse: 0.28244224190711975
current test mse: 0.282442
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012003_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012003_3_24hr.npz
NaN value num: 0
Iteration: 2241, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4482164680957794
loss_pred:0.019146261736750603, decouple_loss:0.00836979877203703
The generated pressure mean: 0.4489494860172272
loss_pred:0.01843895949423313, decouple_loss:0.008113296702504158
The generated pressure mean: 0.44898679852485657
loss_pred:0.018213294446468353, decouple_loss:0.008214730769395828
Iteration: 2242, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4495067596435547
loss_pred:0.018132725730538368, decouple_loss:0.008089534938335419
The generated pressure mean: 0.4474774897098541
loss_pred:0.01933976821601391, decouple_loss:0.008057459257543087
The generated pressure mean: 0.4496249556541443
loss_pred:0.019017647951841354, decouple_loss:0.008108135312795639
Iteration: 2243, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44956010580062866
loss_pred:0.017324453219771385, decouple_loss:0.008545228280127048
The generated pressure mean: 0.4487335979938507
The generated pressure mean: 0.44903990626335144loss_pred:0.02062133327126503, decouple_loss:0.008105350658297539
loss_pred:0.018968898802995682, decouple_loss:0.00775645487010479
Iteration: 2244, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45114755630493164
loss_pred:0.018897155299782753, decouple_loss:0.008917960338294506
The generated pressure mean: 0.4490096867084503
loss_pred:0.01870913617312908, decouple_loss:0.008407432585954666
The generated pressure mean: 0.4495968818664551
loss_pred:0.017729297280311584, decouple_loss:0.008719587698578835
Iteration: 2245, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4494667947292328
The generated pressure mean: 0.4503149688243866
loss_pred:0.01848539151251316, decouple_loss:0.007633978966623545
loss_pred:0.020285997539758682, decouple_loss:0.008115177974104881
The generated pressure mean: 0.4491124153137207
loss_pred:0.019182834774255753, decouple_loss:0.008042387664318085
Iteration: 2246, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44736945629119873
loss_pred:0.01954103633761406, decouple_loss:0.007702875882387161
The generated pressure mean: 0.4479886293411255
loss_pred:0.01876218430697918, decouple_loss:0.007908158004283905
The generated pressure mean: 0.4483240842819214
loss_pred:0.01826450414955616, decouple_loss:0.007844744250178337
Iteration: 2247, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44873008131980896
loss_pred:0.018459204584360123, decouple_loss:0.007805726956576109
The generated pressure mean: 0.4473942816257477
loss_pred:0.018609846010804176, decouple_loss:0.0075660524889826775
The generated pressure mean: 0.4480249881744385
loss_pred:0.020973648875951767, decouple_loss:0.007563237100839615
Iteration: 2248, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4510740339756012
The generated pressure mean: 0.4490267336368561
loss_pred:0.018774012103676796, decouple_loss:0.008546500466763973
loss_pred:0.0181471798568964, decouple_loss:0.00867344532161951
The generated pressure mean: 0.4481774568557739
loss_pred:0.01830649934709072, decouple_loss:0.008211781270802021
Iteration: 2249, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.449297696352005
loss_pred:0.016998564824461937, decouple_loss:0.008188732899725437
The generated pressure mean: 0.4478297531604767
loss_pred:0.018336759880185127, decouple_loss:0.008418738842010498
The generated pressure mean: 0.448787122964859
loss_pred:0.018712781369686127, decouple_loss:0.007725331000983715
Iteration: 2250, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4488144516944885
loss_pred:0.020324669778347015, decouple_loss:0.0076332432217895985
The generated pressure mean: 0.4487369656562805
loss_pred:0.018435655161738396, decouple_loss:0.0076157767325639725
The generated pressure mean: 0.4478243887424469
loss_pred:0.018350394442677498, decouple_loss:0.007323849480599165
2023-04-16 10:28:10 testing...
The generated pressure mean: 0.4502691626548767
loss_pred:0.14082565903663635, decouple_loss:0.04684675484895706
The generated pressure mean: 0.4503234624862671
loss_pred:0.1389797329902649, decouple_loss:0.047037411481142044
The generated pressure mean: 0.45002803206443787
loss_pred:0.13973253965377808, decouple_loss:0.046873755753040314
Loss: 0.14219194650650024, avg_mse: 0.27773311734199524
current test mse: 0.277733
Iteration: 2251, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44830864667892456
The generated pressure mean: 0.4485988914966583
The generated pressure mean: 0.4487903118133545
loss_pred:0.02063123509287834, decouple_loss:0.007992355152964592
loss_pred:0.019882140681147575, decouple_loss:0.007629961706697941
loss_pred:0.018537098541855812, decouple_loss:0.007643768098205328
Iteration: 2252, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4497389793395996
The generated pressure mean: 0.44891300797462463loss_pred:0.017899228259921074, decouple_loss:0.0078047094866633415
loss_pred:0.018938647583127022, decouple_loss:0.007760809734463692
The generated pressure mean: 0.4490194320678711
loss_pred:0.02020377852022648, decouple_loss:0.007850097492337227
Iteration: 2253, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44863542914390564
loss_pred:0.019654827192425728, decouple_loss:0.007880179211497307
The generated pressure mean: 0.4487152397632599
The generated pressure mean: 0.44937896728515625
loss_pred:0.020020825788378716, decouple_loss:0.007451752200722694
loss_pred:0.025015655905008316, decouple_loss:0.00780357513576746
Iteration: 2254, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4499334692955017
loss_pred:0.025119703263044357, decouple_loss:0.008726618252694607
The generated pressure mean: 0.4494214653968811
loss_pred:0.022776557132601738, decouple_loss:0.008656885474920273
The generated pressure mean: 0.44951730966567993
loss_pred:0.020927472040057182, decouple_loss:0.008661113679409027
Iteration: 2255, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44993919134140015
loss_pred:0.025931086391210556, decouple_loss:0.009019160643219948
The generated pressure mean: 0.44996219873428345
loss_pred:0.021670246496796608, decouple_loss:0.008922204375267029
The generated pressure mean: 0.4476032853126526
loss_pred:0.019708726555109024, decouple_loss:0.008528351783752441
Iteration: 2256, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4492085576057434
The generated pressure mean: 0.44800102710723877
loss_pred:0.02038072980940342, decouple_loss:0.010007813572883606
loss_pred:0.022095199674367905, decouple_loss:0.010948723182082176
The generated pressure mean: 0.4494469165802002
loss_pred:0.023155245929956436, decouple_loss:0.010023784823715687
Iteration: 2257, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4489026963710785
loss_pred:0.022145431488752365, decouple_loss:0.010100995190441608
The generated pressure mean: 0.449115127325058
loss_pred:0.023172002285718918, decouple_loss:0.009968487545847893
The generated pressure mean: 0.4483243227005005
loss_pred:0.0230341125279665, decouple_loss:0.010192395187914371
Iteration: 2258, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44844383001327515
loss_pred:0.02241078019142151, decouple_loss:0.01017474103718996
The generated pressure mean: 0.4485897719860077
loss_pred:0.02397332713007927, decouple_loss:0.010267375968396664
The generated pressure mean: 0.4487433135509491
loss_pred:0.022313851863145828, decouple_loss:0.009882939048111439
Iteration: 2259, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4481889605522156
loss_pred:0.021463561803102493, decouple_loss:0.010569198988378048
The generated pressure mean: 0.4491884410381317
loss_pred:0.01998402737081051, decouple_loss:0.010593133978545666
The generated pressure mean: 0.449041485786438
loss_pred:0.021195659413933754, decouple_loss:0.010203669779002666
Iteration: 2260, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44823792576789856
loss_pred:0.02067304402589798, decouple_loss:0.010770590975880623
The generated pressure mean: 0.44853290915489197
loss_pred:0.021543754264712334, decouple_loss:0.010513266548514366
The generated pressure mean: 0.4488131105899811
loss_pred:0.020531633868813515, decouple_loss:0.010555718094110489
2023-04-16 10:30:16 testing...
The generated pressure mean: 0.4502691328525543
loss_pred:0.13529185950756073, decouple_loss:0.04511492699384689
The generated pressure mean: 0.45032402873039246
loss_pred:0.13450032472610474, decouple_loss:0.04493110999464989
The generated pressure mean: 0.4500274062156677
loss_pred:0.134262815117836, decouple_loss:0.04501574859023094
Loss: 0.1369360387325287, avg_mse: 0.2620880901813507
current test mse: 0.262088
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012017_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012017_3_24hr.npz
NaN value num: 0
Iteration: 2261, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4477750062942505
loss_pred:0.021055439487099648, decouple_loss:0.010319246910512447
The generated pressure mean: 0.4481949210166931
loss_pred:0.020319119095802307, decouple_loss:0.010566259734332561
The generated pressure mean: 0.4500746726989746
loss_pred:0.021848764270544052, decouple_loss:0.010473944246768951
Iteration: 2262, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.448934942483902
loss_pred:0.019001668319106102, decouple_loss:0.01067234855145216
The generated pressure mean: 0.44784843921661377
loss_pred:0.02166459523141384, decouple_loss:0.010175436735153198
The generated pressure mean: 0.44810423254966736
loss_pred:0.020867984741926193, decouple_loss:0.010488077066838741
Iteration: 2263, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4489538371562958
loss_pred:0.01952950842678547, decouple_loss:0.011155631393194199
The generated pressure mean: 0.4491126537322998
loss_pred:0.02027018554508686, decouple_loss:0.010920202359557152
The generated pressure mean: 0.4473998248577118
loss_pred:0.01959371007978916, decouple_loss:0.010504026897251606
Iteration: 2264, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44989174604415894
loss_pred:0.020744793117046356, decouple_loss:0.010119516402482986The generated pressure mean: 0.4485357999801636
loss_pred:0.019685130566358566, decouple_loss:0.010057211853563786
The generated pressure mean: 0.4477144479751587
loss_pred:0.022026346996426582, decouple_loss:0.00970500148832798
Iteration: 2265, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44998645782470703
The generated pressure mean: 0.449296772480011
loss_pred:0.01936992071568966, decouple_loss:0.010491243563592434
loss_pred:0.02044227346777916, decouple_loss:0.010225871577858925
The generated pressure mean: 0.44998699426651
loss_pred:0.020863333716988564, decouple_loss:0.010949378833174706
Iteration: 2266, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4492504894733429
loss_pred:0.020239850506186485, decouple_loss:0.010571560822427273
The generated pressure mean: 0.44840750098228455
loss_pred:0.01974019780755043, decouple_loss:0.010012052953243256
The generated pressure mean: 0.44919031858444214
loss_pred:0.019428996369242668, decouple_loss:0.010226601734757423
Iteration: 2267, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45002278685569763
loss_pred:0.021667463704943657, decouple_loss:0.01090939063578844
The generated pressure mean: 0.4485710561275482
loss_pred:0.020393433049321175, decouple_loss:0.010403644293546677
The generated pressure mean: 0.44946080446243286
loss_pred:0.02076929435133934, decouple_loss:0.010305979289114475
Iteration: 2268, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44896864891052246The generated pressure mean: 0.449576199054718
loss_pred:0.019081268459558487, decouple_loss:0.010525831021368504
loss_pred:0.022189371287822723, decouple_loss:0.009848550893366337
The generated pressure mean: 0.4481717646121979
loss_pred:0.020425809547305107, decouple_loss:0.010411016643047333
Iteration: 2269, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4484555721282959
loss_pred:0.019539035856723785, decouple_loss:0.01005092915147543
The generated pressure mean: 0.44871118664741516
loss_pred:0.02141130156815052, decouple_loss:0.010237816721200943
The generated pressure mean: 0.44986408948898315
loss_pred:0.019740693271160126, decouple_loss:0.01045873574912548
Iteration: 2270, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44880223274230957
The generated pressure mean: 0.4478321373462677
loss_pred:0.01888149417936802, decouple_loss:0.009988564997911453
loss_pred:0.020329365506768227, decouple_loss:0.009902636520564556
The generated pressure mean: 0.4497857689857483
loss_pred:0.018110409379005432, decouple_loss:0.009851020760834217
2023-04-16 10:33:01 testing...
The generated pressure mean: 0.4502691626548767
loss_pred:0.13835608959197998, decouple_loss:0.050076406449079514
The generated pressure mean: 0.4503242075443268
loss_pred:0.1369384527206421, decouple_loss:0.05029357969760895
The generated pressure mean: 0.45003172755241394
loss_pred:0.137555792927742, decouple_loss:0.05017349496483803
Loss: 0.1401258409023285, avg_mse: 0.2717856466770172
current test mse: 0.271786
Iteration: 2271, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4493294656276703
loss_pred:0.01959005743265152, decouple_loss:0.01076960563659668
The generated pressure mean: 0.449431449174881
loss_pred:0.02125166915357113, decouple_loss:0.010122816078364849
The generated pressure mean: 0.44904178380966187
loss_pred:0.01990320347249508, decouple_loss:0.010032492689788342
Iteration: 2272, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4484025537967682
The generated pressure mean: 0.44865554571151733
loss_pred:0.019474025815725327, decouple_loss:0.00920619536191225
The generated pressure mean: 0.4477631449699402
loss_pred:0.019379889592528343, decouple_loss:0.009994546882808208
loss_pred:0.021679017692804337, decouple_loss:0.009929402731359005
Iteration: 2273, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4492236375808716
loss_pred:0.02110862359404564, decouple_loss:0.009355287067592144
The generated pressure mean: 0.448582261800766
loss_pred:0.021154385060071945, decouple_loss:0.009556366130709648
The generated pressure mean: 0.4501740038394928
loss_pred:0.01863711141049862, decouple_loss:0.009379145689308643
Iteration: 2274, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44941046833992004
loss_pred:0.021257027983665466, decouple_loss:0.00871168915182352
The generated pressure mean: 0.4482247531414032
loss_pred:0.020999975502490997, decouple_loss:0.008934593759477139
The generated pressure mean: 0.44827449321746826
loss_pred:0.02055596560239792, decouple_loss:0.008606193587183952
Iteration: 2275, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4492688775062561
loss_pred:0.020443053916096687, decouple_loss:0.009080491028726101
The generated pressure mean: 0.44943082332611084
loss_pred:0.01969859190285206, decouple_loss:0.009390435181558132
The generated pressure mean: 0.44957712292671204
loss_pred:0.020031655207276344, decouple_loss:0.009274076670408249
Iteration: 2276, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44813600182533264The generated pressure mean: 0.4481050968170166
loss_pred:0.020999763160943985, decouple_loss:0.008810272440314293
loss_pred:0.0184010099619627, decouple_loss:0.008923342451453209
The generated pressure mean: 0.4491066634654999
loss_pred:0.019382644444704056, decouple_loss:0.008870250545442104
Iteration: 2277, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4504198729991913
The generated pressure mean: 0.4486921429634094
loss_pred:0.01952292211353779, decouple_loss:0.008868832141160965
loss_pred:0.021338995546102524, decouple_loss:0.009073871187865734
The generated pressure mean: 0.447986364364624
loss_pred:0.019879434257745743, decouple_loss:0.00860645342618227
Iteration: 2278, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4492168426513672
The generated pressure mean: 0.4489535391330719
loss_pred:0.01787758059799671, decouple_loss:0.008867768570780754
loss_pred:0.019425222650170326, decouple_loss:0.008794999681413174
The generated pressure mean: 0.44934719800949097
loss_pred:0.01882987655699253, decouple_loss:0.008418260142207146
Iteration: 2279, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.448395311832428The generated pressure mean: 0.4488009214401245
loss_pred:0.019439974799752235, decouple_loss:0.009601152502000332
loss_pred:0.02119770273566246, decouple_loss:0.009510394185781479
The generated pressure mean: 0.44951242208480835
loss_pred:0.019299129024147987, decouple_loss:0.009301413781940937
Iteration: 2280, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.449506938457489The generated pressure mean: 0.4484560787677765
loss_pred:0.017522361129522324, decouple_loss:0.008500579744577408
loss_pred:0.019334379583597183, decouple_loss:0.008329491131007671
The generated pressure mean: 0.4503712058067322
loss_pred:0.020183579996228218, decouple_loss:0.008218657225370407
2023-04-16 10:35:06 testing...
The generated pressure mean: 0.4502691626548767
loss_pred:0.13882964849472046, decouple_loss:0.048814162611961365
The generated pressure mean: 0.4503249526023865
loss_pred:0.13740073144435883, decouple_loss:0.048997074365615845
The generated pressure mean: 0.45002859830856323
loss_pred:0.1381094753742218, decouple_loss:0.048708174377679825
Loss: 0.14055529236793518, avg_mse: 0.27268368005752563
current test mse: 0.272684
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012011_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012011_3_24hr.npz
NaN value num: 0
Iteration: 2281, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4494023025035858
loss_pred:0.01815364882349968, decouple_loss:0.008696830831468105
The generated pressure mean: 0.4486841857433319
loss_pred:0.019269725307822227, decouple_loss:0.008977770805358887
The generated pressure mean: 0.44886839389801025
loss_pred:0.019426682963967323, decouple_loss:0.008471573702991009
Iteration: 2282, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4486573338508606
loss_pred:0.01949450559914112, decouple_loss:0.008255954831838608
The generated pressure mean: 0.45005369186401367
loss_pred:0.0185070913285017, decouple_loss:0.008241783827543259
The generated pressure mean: 0.4485514461994171
loss_pred:0.017822574824094772, decouple_loss:0.008061776868999004
Iteration: 2283, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4478483498096466
loss_pred:0.01923697628080845, decouple_loss:0.009320625104010105
The generated pressure mean: 0.44789692759513855
loss_pred:0.020542819052934647, decouple_loss:0.009314076043665409
The generated pressure mean: 0.44792529940605164
loss_pred:0.019562603905797005, decouple_loss:0.00878236535936594
Iteration: 2284, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4484633803367615
loss_pred:0.017442211508750916, decouple_loss:0.008032134734094143
The generated pressure mean: 0.4491528868675232
loss_pred:0.018684037029743195, decouple_loss:0.00810989085584879
The generated pressure mean: 0.4477546811103821
loss_pred:0.018414057791233063, decouple_loss:0.00798659399151802
Iteration: 2285, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44872522354125977
loss_pred:0.01835024170577526, decouple_loss:0.00789038185030222
The generated pressure mean: 0.4486883580684662
loss_pred:0.0191271360963583, decouple_loss:0.00834069773554802
The generated pressure mean: 0.44965288043022156
loss_pred:0.01876542717218399, decouple_loss:0.0082137705758214
Iteration: 2286, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44831913709640503
loss_pred:0.01958264224231243, decouple_loss:0.008308231830596924
The generated pressure mean: 0.44842392206192017
loss_pred:0.019083797931671143, decouple_loss:0.008718326687812805
The generated pressure mean: 0.44798460602760315
loss_pred:0.02099631354212761, decouple_loss:0.007788089103996754
Iteration: 2287, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4491111636161804
loss_pred:0.019483039155602455, decouple_loss:0.007625936530530453
The generated pressure mean: 0.4486998915672302
loss_pred:0.018556825816631317, decouple_loss:0.007439479231834412
The generated pressure mean: 0.44807523488998413
loss_pred:0.018202057108283043, decouple_loss:0.007464004214853048
Iteration: 2288, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44763290882110596
loss_pred:0.01935589127242565, decouple_loss:0.008170352317392826
The generated pressure mean: 0.4474080801010132
loss_pred:0.018566744402050972, decouple_loss:0.008501979522407055
The generated pressure mean: 0.44760212302207947
loss_pred:0.01939193159341812, decouple_loss:0.007903143763542175
Iteration: 2289, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4483609199523926
loss_pred:0.01857588067650795, decouple_loss:0.00841604731976986
The generated pressure mean: 0.44920772314071655
loss_pred:0.019104313105344772, decouple_loss:0.00868354830890894
The generated pressure mean: 0.4482688307762146
loss_pred:0.018137510865926743, decouple_loss:0.007775179110467434
Iteration: 2290, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44711050391197205
loss_pred:0.018848560750484467, decouple_loss:0.008752480149269104
The generated pressure mean: 0.45020121335983276
loss_pred:0.018374595791101456, decouple_loss:0.00915909931063652
The generated pressure mean: 0.44815176725387573
loss_pred:0.020372778177261353, decouple_loss:0.009515149518847466
2023-04-16 10:38:15 testing...
The generated pressure mean: 0.4502691924571991
loss_pred:0.1382855623960495, decouple_loss:0.04736023023724556
The generated pressure mean: 0.45032256841659546
loss_pred:0.13638995587825775, decouple_loss:0.04717808589339256
The generated pressure mean: 0.45003366470336914
loss_pred:0.13713426887989044, decouple_loss:0.04719109088182449
Loss: 0.13963209092617035, avg_mse: 0.2708498537540436
current test mse: 0.27085
Iteration: 2291, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44837772846221924
loss_pred:0.02052241936326027, decouple_loss:0.008203919045627117
The generated pressure mean: 0.44761690497398376
loss_pred:0.018727971240878105, decouple_loss:0.008022706024348736
The generated pressure mean: 0.4472618103027344
loss_pred:0.021219627931714058, decouple_loss:0.008124629966914654
Iteration: 2292, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4476867616176605
The generated pressure mean: 0.4477769732475281loss_pred:0.020728204399347305, decouple_loss:0.007762831170111895
loss_pred:0.01841958612203598, decouple_loss:0.007965294644236565
The generated pressure mean: 0.44824108481407166
loss_pred:0.018429096788167953, decouple_loss:0.007792048156261444
Iteration: 2293, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4473724067211151
loss_pred:0.01807706244289875, decouple_loss:0.00883831549435854
The generated pressure mean: 0.4477090835571289
loss_pred:0.020870894193649292, decouple_loss:0.008531431667506695
The generated pressure mean: 0.44796428084373474
loss_pred:0.018346987664699554, decouple_loss:0.007714857347309589
Iteration: 2294, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.447775274515152
The generated pressure mean: 0.44854795932769775
loss_pred:0.022014163434505463, decouple_loss:0.008269350044429302
loss_pred:0.018275978043675423, decouple_loss:0.00830095075070858
The generated pressure mean: 0.4492082893848419
loss_pred:0.017946787178516388, decouple_loss:0.008434892632067204
Iteration: 2295, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4496658444404602
loss_pred:0.02038949728012085, decouple_loss:0.008181548677384853
The generated pressure mean: 0.44772976636886597
loss_pred:0.019084962084889412, decouple_loss:0.008312600664794445
The generated pressure mean: 0.4486149847507477
loss_pred:0.020182987675070763, decouple_loss:0.008276013657450676
Iteration: 2296, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44826263189315796
The generated pressure mean: 0.44788700342178345
loss_pred:0.01824948564171791, decouple_loss:0.007500066887587309
loss_pred:0.018480045720934868, decouple_loss:0.007610442582517862
The generated pressure mean: 0.4485138952732086
loss_pred:0.018617799505591393, decouple_loss:0.007152964361011982
Iteration: 2297, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44822266697883606
loss_pred:0.019297249615192413, decouple_loss:0.007482536137104034
The generated pressure mean: 0.44826194643974304
loss_pred:0.019806884229183197, decouple_loss:0.008173644542694092
The generated pressure mean: 0.447472482919693
loss_pred:0.019085826352238655, decouple_loss:0.008149826899170876
Iteration: 2298, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44804564118385315
The generated pressure mean: 0.44873443245887756loss_pred:0.01965097151696682, decouple_loss:0.009392273612320423
loss_pred:0.01872524805366993, decouple_loss:0.009194277226924896
The generated pressure mean: 0.44833576679229736
loss_pred:0.019678980112075806, decouple_loss:0.008698221296072006
Iteration: 2299, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4481086730957031
loss_pred:0.018604520708322525, decouple_loss:0.00812548864632845
The generated pressure mean: 0.4484611451625824
loss_pred:0.020040756091475487, decouple_loss:0.008467363193631172
The generated pressure mean: 0.44822925329208374
loss_pred:0.019463608041405678, decouple_loss:0.008189370855689049
Iteration: 2300, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4492788016796112
loss_pred:0.019164036959409714, decouple_loss:0.007648108061403036
The generated pressure mean: 0.4481549859046936
loss_pred:0.01787862740457058, decouple_loss:0.007787537295371294
The generated pressure mean: 0.44830945134162903
loss_pred:0.018870368599891663, decouple_loss:0.007284353021532297
2023-04-16 10:40:21 testing...
The generated pressure mean: 0.4502691626548767
loss_pred:0.13699787855148315, decouple_loss:0.049024518579244614
The generated pressure mean: 0.450325608253479
loss_pred:0.1355399340391159, decouple_loss:0.048737891018390656
The generated pressure mean: 0.4500299394130707
loss_pred:0.1361485868692398, decouple_loss:0.04899260029196739
Loss: 0.13867472112178802, avg_mse: 0.2701929807662964
current test mse: 0.270193
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012008_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012008_3_24hr.npz
NaN value num: 0
Iteration: 2301, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44735562801361084
loss_pred:0.020974690094590187, decouple_loss:0.009867934510111809
The generated pressure mean: 0.4470067620277405
loss_pred:0.02065950445830822, decouple_loss:0.010142248123884201
The generated pressure mean: 0.4457491338253021
loss_pred:0.019305923953652382, decouple_loss:0.009745470248162746
Iteration: 2302, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44709327816963196
loss_pred:0.01834110915660858, decouple_loss:0.008067245595157146
The generated pressure mean: 0.4482744038105011
loss_pred:0.02071225829422474, decouple_loss:0.008292699232697487
The generated pressure mean: 0.4473148584365845
loss_pred:0.01912667416036129, decouple_loss:0.008039655163884163
Iteration: 2303, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4466798007488251
The generated pressure mean: 0.44595056772232056loss_pred:0.020685259252786636, decouple_loss:0.007861183024942875
The generated pressure mean: 0.4470079839229584
loss_pred:0.019711285829544067, decouple_loss:0.00775603111833334
loss_pred:0.018782442435622215, decouple_loss:0.008026031777262688
Iteration: 2304, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.446912944316864
loss_pred:0.01982114277780056, decouple_loss:0.009416383691132069
The generated pressure mean: 0.44690021872520447
loss_pred:0.019088139757514, decouple_loss:0.008765792474150658
The generated pressure mean: 0.44813740253448486
loss_pred:0.018063951283693314, decouple_loss:0.008206392638385296
Iteration: 2305, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4478183686733246
loss_pred:0.019433574751019478, decouple_loss:0.008498824201524258
The generated pressure mean: 0.44737508893013
loss_pred:0.01966993138194084, decouple_loss:0.008324679918587208
The generated pressure mean: 0.44724005460739136
loss_pred:0.01876242458820343, decouple_loss:0.008990893140435219
Iteration: 2306, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44741159677505493
loss_pred:0.019276276230812073, decouple_loss:0.00764122512191534
The generated pressure mean: 0.4476298391819
loss_pred:0.018506454303860664, decouple_loss:0.007650993298739195
The generated pressure mean: 0.4466969966888428
loss_pred:0.01938026025891304, decouple_loss:0.007811641786247492
Iteration: 2307, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44719719886779785
The generated pressure mean: 0.4471394121646881
loss_pred:0.018633250147104263, decouple_loss:0.00755188288167119
loss_pred:0.018138587474822998, decouple_loss:0.0076574599370360374
The generated pressure mean: 0.4475235342979431
loss_pred:0.02140374295413494, decouple_loss:0.00862620584666729
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 2308, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4485195279121399The generated pressure mean: 0.4466726779937744
loss_pred:0.01830216497182846, decouple_loss:0.008545626886188984
loss_pred:0.018820779398083687, decouple_loss:0.00821464229375124
The generated pressure mean: 0.44577789306640625
loss_pred:0.021375417709350586, decouple_loss:0.00835478026419878
Iteration: 2309, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4478265941143036
loss_pred:0.019621774554252625, decouple_loss:0.008069408126175404
The generated pressure mean: 0.44663113355636597
loss_pred:0.019352467730641365, decouple_loss:0.007848413661122322
The generated pressure mean: 0.4471534192562103
loss_pred:0.018075693398714066, decouple_loss:0.00794758927077055
Iteration: 2310, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4469147026538849
The generated pressure mean: 0.4479784369468689loss_pred:0.018260154873132706, decouple_loss:0.007782012689858675
loss_pred:0.019269555807113647, decouple_loss:0.007853168994188309
The generated pressure mean: 0.4465700387954712
loss_pred:0.02026468887925148, decouple_loss:0.008302629925310612
2023-04-16 10:43:09 testing...
The generated pressure mean: 0.4502691328525543
loss_pred:0.13998645544052124, decouple_loss:0.04426611587405205
The generated pressure mean: 0.4503207504749298
loss_pred:0.13836205005645752, decouple_loss:0.04499168321490288
The generated pressure mean: 0.45003074407577515
loss_pred:0.13915112614631653, decouple_loss:0.04459597170352936
Loss: 0.14139744639396667, avg_mse: 0.273378849029541
current test mse: 0.273379
Iteration: 2311, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4466889202594757
loss_pred:0.018986646085977554, decouple_loss:0.007707034237682819
The generated pressure mean: 0.4472770690917969
loss_pred:0.02091832645237446, decouple_loss:0.007567345164716244The generated pressure mean: 0.44770318269729614
loss_pred:0.0198220107704401, decouple_loss:0.007810815703123808
Iteration: 2312, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4470953643321991The generated pressure mean: 0.44693994522094727
loss_pred:0.019069626927375793, decouple_loss:0.00923486053943634
loss_pred:0.019198961555957794, decouple_loss:0.009245311841368675
The generated pressure mean: 0.4472907483577728
loss_pred:0.01890767179429531, decouple_loss:0.009312448091804981
Iteration: 2313, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44744378328323364
loss_pred:0.02356460690498352, decouple_loss:0.008754556067287922
The generated pressure mean: 0.4483383595943451
loss_pred:0.018737517297267914, decouple_loss:0.008627617731690407
The generated pressure mean: 0.44816169142723083
loss_pred:0.017965169623494148, decouple_loss:0.008620740845799446
Iteration: 2314, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4473775327205658
loss_pred:0.020316410809755325, decouple_loss:0.008073566481471062
The generated pressure mean: 0.44738656282424927
loss_pred:0.020856454968452454, decouple_loss:0.007944333367049694
The generated pressure mean: 0.4473949074745178
loss_pred:0.019774191081523895, decouple_loss:0.008215460926294327
Iteration: 2315, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44736912846565247
loss_pred:0.02002338133752346, decouple_loss:0.008425973355770111
The generated pressure mean: 0.44718873500823975
loss_pred:0.01800660975277424, decouple_loss:0.009212438017129898
The generated pressure mean: 0.4462445080280304
loss_pred:0.019695494323968887, decouple_loss:0.00885382667183876
Iteration: 2316, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44755056500434875
The generated pressure mean: 0.4474540054798126
loss_pred:0.019582998007535934, decouple_loss:0.00795406848192215
loss_pred:0.018752075731754303, decouple_loss:0.00812603160738945
The generated pressure mean: 0.44772493839263916
loss_pred:0.019012443721294403, decouple_loss:0.008274099789559841
Iteration: 2317, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44792047142982483
loss_pred:0.01918286271393299, decouple_loss:0.007567358668893576
The generated pressure mean: 0.4470888078212738
loss_pred:0.01968802884221077, decouple_loss:0.007569820154458284
The generated pressure mean: 0.447243332862854
loss_pred:0.018884887918829918, decouple_loss:0.007843183353543282
Iteration: 2318, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44816678762435913
loss_pred:0.018766233697533607, decouple_loss:0.008132086135447025
The generated pressure mean: 0.44755789637565613
loss_pred:0.01966160535812378, decouple_loss:0.007958232425153255
The generated pressure mean: 0.44757896661758423
loss_pred:0.01839681901037693, decouple_loss:0.008020490407943726
Iteration: 2319, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44902312755584717
loss_pred:0.017679018899798393, decouple_loss:0.008600641041994095
The generated pressure mean: 0.4458814561367035
loss_pred:0.01900836080312729, decouple_loss:0.008478734642267227
The generated pressure mean: 0.447260320186615
loss_pred:0.019930675625801086, decouple_loss:0.008911216631531715
Iteration: 2320, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44664061069488525
loss_pred:0.018274175003170967, decouple_loss:0.007726150564849377
The generated pressure mean: 0.4476260244846344
loss_pred:0.02045496366918087, decouple_loss:0.007768714334815741
The generated pressure mean: 0.4473600685596466
loss_pred:0.01826525293290615, decouple_loss:0.007945127785205841
2023-04-16 10:45:15 testing...
The generated pressure mean: 0.4502691924571991
loss_pred:0.1369314193725586, decouple_loss:0.04442008212208748
The generated pressure mean: 0.45032238960266113
loss_pred:0.13581222295761108, decouple_loss:0.04490683972835541
The generated pressure mean: 0.4500305652618408
loss_pred:0.13679161667823792, decouple_loss:0.04460680112242699
Loss: 0.13874399662017822, avg_mse: 0.26951679587364197
current test mse: 0.269517
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012018_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012018_3_24hr.npz
NaN value num: 0
Iteration: 2321, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44845107197761536
loss_pred:0.020307114347815514, decouple_loss:0.0075986250303685665
The generated pressure mean: 0.4481126070022583
loss_pred:0.018969688564538956, decouple_loss:0.0074617452919483185
The generated pressure mean: 0.448076993227005
loss_pred:0.018604736775159836, decouple_loss:0.007839782163500786
Iteration: 2322, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4489903748035431The generated pressure mean: 0.44837579131126404
loss_pred:0.01839691400527954, decouple_loss:0.008096323348581791loss_pred:0.01827690750360489, decouple_loss:0.007570073939859867
The generated pressure mean: 0.44840729236602783
loss_pred:0.019534753635525703, decouple_loss:0.007798656355589628
Iteration: 2323, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.449022114276886
The generated pressure mean: 0.4487071931362152
loss_pred:0.0184156596660614, decouple_loss:0.008739030919969082
loss_pred:0.01795213110744953, decouple_loss:0.00900727417320013
The generated pressure mean: 0.44900089502334595
loss_pred:0.01817825436592102, decouple_loss:0.008940879255533218
Iteration: 2324, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4482099711894989
The generated pressure mean: 0.44852349162101746
loss_pred:0.02146243490278721, decouple_loss:0.008067856542766094
loss_pred:0.01990855298936367, decouple_loss:0.008321269415318966
The generated pressure mean: 0.44925886392593384
loss_pred:0.018495425581932068, decouple_loss:0.007418778259307146
Iteration: 2325, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4487639367580414
loss_pred:0.02000332996249199, decouple_loss:0.007924338802695274
The generated pressure mean: 0.4482004642486572
loss_pred:0.01987454667687416, decouple_loss:0.007718102540820837
The generated pressure mean: 0.4478519558906555
loss_pred:0.018203869462013245, decouple_loss:0.007667722646147013
Iteration: 2326, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4483448266983032
The generated pressure mean: 0.4479904770851135loss_pred:0.018959542736411095, decouple_loss:0.00840315967798233
loss_pred:0.019695617258548737, decouple_loss:0.007913624867796898
The generated pressure mean: 0.44835755228996277
loss_pred:0.01848476380109787, decouple_loss:0.008322369307279587
Iteration: 2327, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44852879643440247
loss_pred:0.01904328167438507, decouple_loss:0.00803365372121334
The generated pressure mean: 0.4486424922943115
loss_pred:0.018882688134908676, decouple_loss:0.007991434074938297
The generated pressure mean: 0.4483763575553894
loss_pred:0.01958342269062996, decouple_loss:0.008703717030584812
Iteration: 2328, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44847917556762695
The generated pressure mean: 0.44769930839538574loss_pred:0.018798815086483955, decouple_loss:0.007585981395095587
loss_pred:0.019499482586979866, decouple_loss:0.007594713941216469
The generated pressure mean: 0.44777271151542664
loss_pred:0.019879570230841637, decouple_loss:0.007675539702177048
Iteration: 2329, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4486372172832489
loss_pred:0.019103465601801872, decouple_loss:0.007520085200667381
The generated pressure mean: 0.4486388564109802
loss_pred:0.018166789785027504, decouple_loss:0.007466363720595837
The generated pressure mean: 0.44892454147338867
loss_pred:0.019886456429958344, decouple_loss:0.007338341791182756
Iteration: 2330, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4486895203590393
The generated pressure mean: 0.44809210300445557loss_pred:0.019990356639027596, decouple_loss:0.007479913532733917
loss_pred:0.018560584634542465, decouple_loss:0.0077047389931976795
The generated pressure mean: 0.4484916031360626
loss_pred:0.01835884526371956, decouple_loss:0.007447185460478067
2023-04-16 10:48:00 testing...
The generated pressure mean: 0.4502691924571991
loss_pred:0.13599179685115814, decouple_loss:0.04416712000966072
The generated pressure mean: 0.4503263831138611
loss_pred:0.13480667769908905, decouple_loss:0.04451366513967514
The generated pressure mean: 0.4500327706336975
loss_pred:0.13527509570121765, decouple_loss:0.04449697211384773
Loss: 0.13757747411727905, avg_mse: 0.26771309971809387
current test mse: 0.267713
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 2331, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4493773877620697
loss_pred:0.019138919189572334, decouple_loss:0.007812129333615303The generated pressure mean: 0.448072224855423
The generated pressure mean: 0.44935473799705505
loss_pred:0.019760923460125923, decouple_loss:0.007488231640309095
loss_pred:0.019805239513516426, decouple_loss:0.007931571453809738
Iteration: 2332, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44857099652290344
loss_pred:0.018212003633379936, decouple_loss:0.00738445483148098
The generated pressure mean: 0.44857290387153625
The generated pressure mean: 0.4482952058315277
loss_pred:0.020227771252393723, decouple_loss:0.007752003613859415
loss_pred:0.017795279622077942, decouple_loss:0.0075364247895777225
Iteration: 2333, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44913408160209656
loss_pred:0.01888391561806202, decouple_loss:0.007261650171130896
The generated pressure mean: 0.4493362009525299
The generated pressure mean: 0.44836854934692383
loss_pred:0.01852293871343136, decouple_loss:0.006915851961821318
loss_pred:0.019493641331791878, decouple_loss:0.006914408877491951
Iteration: 2334, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44868695735931396
The generated pressure mean: 0.4479931890964508
loss_pred:0.020640220493078232, decouple_loss:0.007505330257117748
loss_pred:0.019084079191088676, decouple_loss:0.007818744517862797
The generated pressure mean: 0.4484585225582123
loss_pred:0.01939178630709648, decouple_loss:0.00796682108193636
Iteration: 2335, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44801977276802063
loss_pred:0.01955706998705864, decouple_loss:0.008016384206712246
The generated pressure mean: 0.44869092106819153
loss_pred:0.020209796726703644, decouple_loss:0.007557806558907032
The generated pressure mean: 0.4482865631580353
loss_pred:0.01923537626862526, decouple_loss:0.007924197241663933
Iteration: 2336, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4481886327266693
loss_pred:0.01785185933113098, decouple_loss:0.007736856583505869
The generated pressure mean: 0.44890227913856506
loss_pred:0.019235486164689064, decouple_loss:0.007890530861914158
The generated pressure mean: 0.44842666387557983
loss_pred:0.01852073334157467, decouple_loss:0.007627394981682301
Iteration: 2337, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4481225907802582The generated pressure mean: 0.44847798347473145
loss_pred:0.019162079319357872, decouple_loss:0.0073029459454119205
loss_pred:0.017763430252671242, decouple_loss:0.00715982262045145
The generated pressure mean: 0.44828981161117554
loss_pred:0.018297459930181503, decouple_loss:0.007204638794064522
Iteration: 2338, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44857558608055115
The generated pressure mean: 0.4497367739677429loss_pred:0.018913619220256805, decouple_loss:0.007316861301660538
loss_pred:0.019079657271504402, decouple_loss:0.007128417491912842
The generated pressure mean: 0.44879990816116333
loss_pred:0.019232267513871193, decouple_loss:0.007822983898222446
Iteration: 2339, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44886845350265503
loss_pred:0.02008776366710663, decouple_loss:0.007835312746465206
The generated pressure mean: 0.44830891489982605
loss_pred:0.02010788768529892, decouple_loss:0.007848951034247875
The generated pressure mean: 0.44843512773513794
loss_pred:0.020098675042390823, decouple_loss:0.008055536076426506
Iteration: 2340, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4478627145290375
loss_pred:0.019074009731411934, decouple_loss:0.007916539907455444
The generated pressure mean: 0.4480894207954407
loss_pred:0.01909071020781994, decouple_loss:0.008131732232868671
The generated pressure mean: 0.4486883580684662
loss_pred:0.021433493122458458, decouple_loss:0.007927333936095238
2023-04-16 10:50:05 testing...
The generated pressure mean: 0.4502691328525543
loss_pred:0.139051616191864, decouple_loss:0.044884465634822845
The generated pressure mean: 0.450324684381485
loss_pred:0.13789889216423035, decouple_loss:0.04534251615405083
The generated pressure mean: 0.4500320553779602
loss_pred:0.1381634771823883, decouple_loss:0.045225486159324646
Loss: 0.1406288743019104, avg_mse: 0.2755807936191559
current test mse: 0.275581
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012005_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012005_3_24hr.npz
NaN value num: 0
Iteration: 2341, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4485305845737457
loss_pred:0.018803853541612625, decouple_loss:0.007893252186477184
The generated pressure mean: 0.45077916979789734
loss_pred:0.01807226426899433, decouple_loss:0.008149414323270321
The generated pressure mean: 0.44990599155426025
loss_pred:0.018224479630589485, decouple_loss:0.008166871033608913
Iteration: 2342, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45101237297058105
The generated pressure mean: 0.44781407713890076
loss_pred:0.01816392131149769, decouple_loss:0.007991469465196133
The generated pressure mean: 0.4502710700035095
loss_pred:0.018132111057639122, decouple_loss:0.007856709882616997
loss_pred:0.018027523532509804, decouple_loss:0.008109738118946552
Iteration: 2343, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.450816810131073
loss_pred:0.01782580465078354, decouple_loss:0.008556767366826534
The generated pressure mean: 0.44957640767097473The generated pressure mean: 0.4493270218372345
loss_pred:0.01839800737798214, decouple_loss:0.008599287830293179
loss_pred:0.017658039927482605, decouple_loss:0.008070479147136211
Iteration: 2344, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45058706402778625
loss_pred:0.016164392232894897, decouple_loss:0.008004673756659031
The generated pressure mean: 0.4480912387371063
loss_pred:0.019256317988038063, decouple_loss:0.008344723843038082
The generated pressure mean: 0.45101994276046753
loss_pred:0.017706364393234253, decouple_loss:0.008269759826362133
Iteration: 2345, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44997933506965637
loss_pred:0.01958908699452877, decouple_loss:0.0075969998724758625
The generated pressure mean: 0.4500846564769745
loss_pred:0.017666419968008995, decouple_loss:0.007914600893855095
The generated pressure mean: 0.4495776891708374
loss_pred:0.019096309319138527, decouple_loss:0.00746280699968338
Iteration: 2346, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44972604513168335
loss_pred:0.01884648948907852, decouple_loss:0.00744275888428092
The generated pressure mean: 0.44950759410858154
loss_pred:0.018579941242933273, decouple_loss:0.007473345380276442
The generated pressure mean: 0.4493444859981537
loss_pred:0.019648121669888496, decouple_loss:0.0073400442488491535
Iteration: 2347, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4496289789676666
loss_pred:0.018772760406136513, decouple_loss:0.008305046707391739
The generated pressure mean: 0.44777730107307434
loss_pred:0.01774660497903824, decouple_loss:0.00805365014821291
The generated pressure mean: 0.44948434829711914
loss_pred:0.01843862421810627, decouple_loss:0.007957245223224163
Iteration: 2348, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4501357078552246
loss_pred:0.018458768725395203, decouple_loss:0.007790121249854565
The generated pressure mean: 0.45064252614974976
loss_pred:0.016904132440686226, decouple_loss:0.007580379024147987
The generated pressure mean: 0.44898560643196106
loss_pred:0.017968719825148582, decouple_loss:0.007330478169023991
Iteration: 2349, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44949567317962646
The generated pressure mean: 0.4495840072631836
loss_pred:0.019393645226955414, decouple_loss:0.006760122254490852
loss_pred:0.017969775944948196, decouple_loss:0.006879149470478296
The generated pressure mean: 0.44980135560035706
loss_pred:0.01865246705710888, decouple_loss:0.006954032927751541
Iteration: 2350, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44888412952423096
loss_pred:0.018540553748607635, decouple_loss:0.007008557207882404
The generated pressure mean: 0.4502711892127991
loss_pred:0.019465260207653046, decouple_loss:0.007206030189990997
The generated pressure mean: 0.4483107030391693
loss_pred:0.018487224355340004, decouple_loss:0.007115480024367571
2023-04-16 10:52:55 testing...
The generated pressure mean: 0.4502691328525543
loss_pred:0.1382760852575302, decouple_loss:0.04465711861848831
The generated pressure mean: 0.4503237307071686
loss_pred:0.13706710934638977, decouple_loss:0.044536542147397995
The generated pressure mean: 0.4500296413898468
loss_pred:0.13753248751163483, decouple_loss:0.044454287737607956
Loss: 0.13985268771648407, avg_mse: 0.274355411529541
current test mse: 0.274355
Iteration: 2351, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44810253381729126
The generated pressure mean: 0.45001518726348877
The generated pressure mean: 0.45085904002189636
loss_pred:0.017582647502422333, decouple_loss:0.007585000246763229
loss_pred:0.01907399669289589, decouple_loss:0.00805896520614624
loss_pred:0.017744923010468483, decouple_loss:0.008307979442179203
Iteration: 2352, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45048457384109497
loss_pred:0.017235346138477325, decouple_loss:0.008397573605179787
The generated pressure mean: 0.45085597038269043
loss_pred:0.017962004989385605, decouple_loss:0.007704684045165777
The generated pressure mean: 0.45134490728378296
loss_pred:0.018218141049146652, decouple_loss:0.008261004462838173
Iteration: 2353, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4496496319770813
loss_pred:0.01822989247739315, decouple_loss:0.00776502164080739
The generated pressure mean: 0.45050230622291565
loss_pred:0.018294112756848335, decouple_loss:0.007853767834603786
The generated pressure mean: 0.4509921073913574
loss_pred:0.017380496487021446, decouple_loss:0.0074722664430737495
Iteration: 2354, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4499901533126831
loss_pred:0.017412791028618813, decouple_loss:0.007311275228857994
The generated pressure mean: 0.4511127769947052
loss_pred:0.01738758385181427, decouple_loss:0.007142552640289068
The generated pressure mean: 0.4506906270980835
loss_pred:0.02052224799990654, decouple_loss:0.00748098362237215
Iteration: 2355, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4499938488006592
loss_pred:0.017340239137411118, decouple_loss:0.009240656159818172
The generated pressure mean: 0.4488249123096466
loss_pred:0.017263615503907204, decouple_loss:0.009117284789681435
The generated pressure mean: 0.45001915097236633
loss_pred:0.01902490109205246, decouple_loss:0.009379472583532333
Iteration: 2356, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4507373869419098
loss_pred:0.01679166965186596, decouple_loss:0.007717393338680267
The generated pressure mean: 0.449025422334671
loss_pred:0.017700141295790672, decouple_loss:0.007973269559442997
The generated pressure mean: 0.450164794921875
loss_pred:0.019233454018831253, decouple_loss:0.00809429120272398
Iteration: 2357, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4502268135547638
loss_pred:0.01802065595984459, decouple_loss:0.007372124586254358
The generated pressure mean: 0.44845330715179443
loss_pred:0.019995957612991333, decouple_loss:0.007389130536466837
The generated pressure mean: 0.44967910647392273
loss_pred:0.018523724749684334, decouple_loss:0.007595129311084747
Iteration: 2358, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4504283368587494
loss_pred:0.019708301872015, decouple_loss:0.0080611202865839
The generated pressure mean: 0.44944486021995544
loss_pred:0.02025246061384678, decouple_loss:0.007886258885264397
The generated pressure mean: 0.4511544704437256
loss_pred:0.017092283815145493, decouple_loss:0.007998540997505188
Iteration: 2359, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4509161710739136
loss_pred:0.0165795236825943, decouple_loss:0.00956326350569725
The generated pressure mean: 0.4491961896419525
loss_pred:0.018967248499393463, decouple_loss:0.009577789343893528
The generated pressure mean: 0.4489419162273407
loss_pred:0.018113715574145317, decouple_loss:0.009718261659145355
Iteration: 2360, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4507937729358673
loss_pred:0.017733842134475708, decouple_loss:0.007965018972754478
The generated pressure mean: 0.4498925507068634
loss_pred:0.017603131011128426, decouple_loss:0.007389337755739689
The generated pressure mean: 0.4511685073375702
loss_pred:0.01761539839208126, decouple_loss:0.0075293416157364845
2023-04-16 10:55:01 testing...
The generated pressure mean: 0.4502691328525543
loss_pred:0.14038987457752228, decouple_loss:0.044479575008153915
The generated pressure mean: 0.45032328367233276
loss_pred:0.13950245082378387, decouple_loss:0.044979028403759
The generated pressure mean: 0.4500320553779602
loss_pred:0.13979826867580414, decouple_loss:0.04481104016304016
Loss: 0.14213469624519348, avg_mse: 0.2795792520046234
current test mse: 0.279579
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012009_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012009_3_24hr.npz
NaN value num: 0
Iteration: 2361, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4478975236415863
loss_pred:0.02028517983853817, decouple_loss:0.0083366259932518
The generated pressure mean: 0.4485918879508972
loss_pred:0.018774917349219322, decouple_loss:0.0083220936357975
The generated pressure mean: 0.44967201352119446
loss_pred:0.018876397982239723, decouple_loss:0.008481290191411972
Iteration: 2362, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4481034278869629
loss_pred:0.018484007567167282, decouple_loss:0.008960193954408169
The generated pressure mean: 0.4481806755065918
loss_pred:0.018964428454637527, decouple_loss:0.008918078616261482
The generated pressure mean: 0.4469982981681824
loss_pred:0.018445195630192757, decouple_loss:0.008566819131374359
Iteration: 2363, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4484156668186188
loss_pred:0.019394250586628914, decouple_loss:0.007537854369729757
The generated pressure mean: 0.4500068724155426
loss_pred:0.01973765902221203, decouple_loss:0.007618498057126999
The generated pressure mean: 0.44771313667297363
loss_pred:0.019063735380768776, decouple_loss:0.007905016653239727
Iteration: 2364, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4486052095890045
loss_pred:0.02153932861983776, decouple_loss:0.007785219699144363
The generated pressure mean: 0.4460597336292267
loss_pred:0.020074618980288506, decouple_loss:0.007806837093085051
The generated pressure mean: 0.44755518436431885
loss_pred:0.02049841918051243, decouple_loss:0.008496664464473724
Iteration: 2365, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4504036009311676
loss_pred:0.019609803333878517, decouple_loss:0.00815119594335556
The generated pressure mean: 0.4466612637042999
loss_pred:0.020310280844569206, decouple_loss:0.0082996916025877
The generated pressure mean: 0.447552889585495
loss_pred:0.021270744502544403, decouple_loss:0.008097031153738499
Iteration: 2366, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44860684871673584
loss_pred:0.020724980160593987, decouple_loss:0.007932985201478004
The generated pressure mean: 0.4471915662288666
loss_pred:0.019211290404200554, decouple_loss:0.007565394043922424
The generated pressure mean: 0.4489677846431732
loss_pred:0.019695347175002098, decouple_loss:0.007916580885648727
Iteration: 2367, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4476558268070221
loss_pred:0.020019780844449997, decouple_loss:0.00893987063318491
The generated pressure mean: 0.4479350745677948
loss_pred:0.019422927871346474, decouple_loss:0.008879784494638443
The generated pressure mean: 0.44737035036087036
loss_pred:0.018732592463493347, decouple_loss:0.00861464161425829
Iteration: 2368, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44927769899368286
loss_pred:0.020090196281671524, decouple_loss:0.007513348013162613
The generated pressure mean: 0.44835522770881653
loss_pred:0.020041590556502342, decouple_loss:0.007622428238391876
The generated pressure mean: 0.4481782019138336
loss_pred:0.019313767552375793, decouple_loss:0.007470665965229273
Iteration: 2369, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4467287063598633
loss_pred:0.01916583441197872, decouple_loss:0.007686604745686054
The generated pressure mean: 0.44746100902557373
loss_pred:0.01912444457411766, decouple_loss:0.007812696509063244
The generated pressure mean: 0.4475025236606598
loss_pred:0.01896086521446705, decouple_loss:0.007943626493215561
Iteration: 2370, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4483911395072937
loss_pred:0.018604503944516182, decouple_loss:0.009279833175241947
The generated pressure mean: 0.44616127014160156
loss_pred:0.019940506666898727, decouple_loss:0.008574297651648521
The generated pressure mean: 0.4481077790260315
loss_pred:0.019564952701330185, decouple_loss:0.008322754874825478
2023-04-16 10:57:44 testing...
The generated pressure mean: 0.4502691626548767
loss_pred:0.1374986618757248, decouple_loss:0.04256686568260193
The generated pressure mean: 0.4503229260444641
loss_pred:0.1365891546010971, decouple_loss:0.04297585040330887
The generated pressure mean: 0.45003294944763184
loss_pred:0.13678120076656342, decouple_loss:0.042738303542137146
Loss: 0.13909435272216797, avg_mse: 0.2695029079914093
current test mse: 0.269503
Iteration: 2371, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4477009177207947
loss_pred:0.019339056685566902, decouple_loss:0.007672521285712719
The generated pressure mean: 0.44672891497612
loss_pred:0.018013691529631615, decouple_loss:0.00735946511849761
The generated pressure mean: 0.44908761978149414
loss_pred:0.01926995813846588, decouple_loss:0.007824775762856007
Iteration: 2372, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4479876458644867
loss_pred:0.018133530393242836, decouple_loss:0.008231139741837978
The generated pressure mean: 0.4487839937210083
loss_pred:0.017937330529093742, decouple_loss:0.008457263931632042
The generated pressure mean: 0.44936880469322205
loss_pred:0.018854010850191116, decouple_loss:0.008732526563107967
Iteration: 2373, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4478522539138794
loss_pred:0.01982267200946808, decouple_loss:0.007730637211352587
The generated pressure mean: 0.44796690344810486
The generated pressure mean: 0.44824644923210144
loss_pred:0.019300781190395355, decouple_loss:0.0073676565662026405
loss_pred:0.018984975293278694, decouple_loss:0.0074842837639153
Iteration: 2374, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4491211175918579
loss_pred:0.020790383219718933, decouple_loss:0.008325661532580853
The generated pressure mean: 0.44830945134162903
loss_pred:0.019820941612124443, decouple_loss:0.007764361333101988
The generated pressure mean: 0.4488939940929413
loss_pred:0.019273655489087105, decouple_loss:0.007804764900356531
Iteration: 2375, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44785043597221375
loss_pred:0.019252179190516472, decouple_loss:0.007910551503300667
The generated pressure mean: 0.4488844573497772
loss_pred:0.01988346315920353, decouple_loss:0.007941953837871552
The generated pressure mean: 0.44988131523132324
loss_pred:0.020031467080116272, decouple_loss:0.007771007250994444
Iteration: 2376, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4477706849575043
loss_pred:0.018596775829792023, decouple_loss:0.007710873614996672
The generated pressure mean: 0.4477401673793793
loss_pred:0.01857585273683071, decouple_loss:0.007843855768442154
The generated pressure mean: 0.44672060012817383
loss_pred:0.018621306866407394, decouple_loss:0.0077765462920069695
Iteration: 2377, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44786229729652405
loss_pred:0.018508732318878174, decouple_loss:0.007654567714780569
The generated pressure mean: 0.4480063319206238
loss_pred:0.018583698198199272, decouple_loss:0.007779620587825775
The generated pressure mean: 0.44806912541389465
loss_pred:0.018621409311890602, decouple_loss:0.007926534861326218
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 2378, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44909369945526123
loss_pred:0.018280059099197388, decouple_loss:0.007578314282000065
The generated pressure mean: 0.4483681917190552
loss_pred:0.02136322483420372, decouple_loss:0.007633304223418236
The generated pressure mean: 0.4491880238056183
loss_pred:0.01855684071779251, decouple_loss:0.007570261601358652
Iteration: 2379, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44680967926979065
The generated pressure mean: 0.44740843772888184
loss_pred:0.01929796300828457, decouple_loss:0.007682046853005886
loss_pred:0.019600151106715202, decouple_loss:0.007775400299578905
The generated pressure mean: 0.44893956184387207
loss_pred:0.019173089414834976, decouple_loss:0.007522981613874435
Iteration: 2380, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.447381854057312
loss_pred:0.019861118867993355, decouple_loss:0.008345566689968109
The generated pressure mean: 0.44818806648254395
loss_pred:0.019622918218374252, decouple_loss:0.008479665033519268
The generated pressure mean: 0.4499625563621521
loss_pred:0.019588738679885864, decouple_loss:0.008557154797017574
2023-04-16 10:59:49 testing...
The generated pressure mean: 0.4502691626548767
loss_pred:0.13885588943958282, decouple_loss:0.044136159121990204
The generated pressure mean: 0.4503232538700104
loss_pred:0.13766635954380035, decouple_loss:0.04427153244614601
The generated pressure mean: 0.4500340521335602
loss_pred:0.13825704157352448, decouple_loss:0.044000353664159775
Loss: 0.140466570854187, avg_mse: 0.2749537527561188
current test mse: 0.274954
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012018_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012018_3_24hr.npz
NaN value num: 0
Iteration: 2381, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4490882158279419
loss_pred:0.01926104538142681, decouple_loss:0.008834188804030418
The generated pressure mean: 0.4484407901763916
loss_pred:0.01922677829861641, decouple_loss:0.008398562669754028
The generated pressure mean: 0.44849857687950134
loss_pred:0.020492475479841232, decouple_loss:0.009041046723723412
Iteration: 2382, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4486019015312195The generated pressure mean: 0.4497360587120056
loss_pred:0.018780246376991272, decouple_loss:0.00725008687004447
loss_pred:0.020558087155222893, decouple_loss:0.007794968318194151
The generated pressure mean: 0.44960880279541016
loss_pred:0.018637007102370262, decouple_loss:0.007628444582223892
Iteration: 2383, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44851717352867126
loss_pred:0.018498381599783897, decouple_loss:0.0077173542231321335
The generated pressure mean: 0.44910165667533875
loss_pred:0.01873445324599743, decouple_loss:0.008878585882484913
The generated pressure mean: 0.45049721002578735
loss_pred:0.01992744766175747, decouple_loss:0.008692816831171513
Iteration: 2384, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45005887746810913
loss_pred:0.019276758655905724, decouple_loss:0.00895095057785511
The generated pressure mean: 0.4498828053474426
loss_pred:0.019573811441659927, decouple_loss:0.008571802638471127
The generated pressure mean: 0.4496449828147888
loss_pred:0.019229045137763023, decouple_loss:0.008124306797981262
Iteration: 2385, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4488070607185364
loss_pred:0.020083609968423843, decouple_loss:0.00802442617714405
The generated pressure mean: 0.4491068124771118
loss_pred:0.019454671069979668, decouple_loss:0.007878217846155167
The generated pressure mean: 0.4504034221172333
loss_pred:0.01936979591846466, decouple_loss:0.00767139159142971
Iteration: 2386, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.448582261800766
loss_pred:0.019250307232141495, decouple_loss:0.007161118555814028
The generated pressure mean: 0.4516327381134033
loss_pred:0.020026419311761856, decouple_loss:0.007464176509529352
The generated pressure mean: 0.4493663012981415
loss_pred:0.018987445160746574, decouple_loss:0.007315418682992458
Iteration: 2387, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44932952523231506
loss_pred:0.018952803686261177, decouple_loss:0.007456259336322546
The generated pressure mean: 0.44981327652931213
loss_pred:0.01885231025516987, decouple_loss:0.0074959928169846535
The generated pressure mean: 0.45013701915740967
loss_pred:0.019527176395058632, decouple_loss:0.007567082531750202
Iteration: 2388, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45012781023979187
The generated pressure mean: 0.4490891993045807
loss_pred:0.018771352246403694, decouple_loss:0.007325291633605957
loss_pred:0.019183645024895668, decouple_loss:0.007349819410592318
The generated pressure mean: 0.4494740068912506
loss_pred:0.01879427209496498, decouple_loss:0.007568582892417908
Iteration: 2389, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4488057494163513
The generated pressure mean: 0.45002374053001404loss_pred:0.020675668492913246, decouple_loss:0.007621703203767538
loss_pred:0.020562315359711647, decouple_loss:0.007593544665724039
The generated pressure mean: 0.4485391676425934
loss_pred:0.019425177946686745, decouple_loss:0.007411320693790913
Iteration: 2390, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.450007826089859
The generated pressure mean: 0.45068493485450745
loss_pred:0.019477026537060738, decouple_loss:0.007000361103564501
loss_pred:0.01884186826646328, decouple_loss:0.006938142701983452
The generated pressure mean: 0.4488479495048523
loss_pred:0.01977585069835186, decouple_loss:0.007206277921795845
2023-04-16 11:02:33 testing...
The generated pressure mean: 0.4502691626548767
loss_pred:0.13952040672302246, decouple_loss:0.044497717171907425
The generated pressure mean: 0.4503224790096283
loss_pred:0.13810083270072937, decouple_loss:0.04454401507973671
The generated pressure mean: 0.45003190636634827
loss_pred:0.13897694647312164, decouple_loss:0.0444377064704895
Loss: 0.14109072089195251, avg_mse: 0.27536505460739136
current test mse: 0.275365
Iteration: 2391, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45040231943130493
The generated pressure mean: 0.44985586404800415
loss_pred:0.01933925971388817, decouple_loss:0.007267151027917862
loss_pred:0.019896123558282852, decouple_loss:0.007570055779069662
The generated pressure mean: 0.44891825318336487
loss_pred:0.019211405888199806, decouple_loss:0.007243181578814983
Iteration: 2392, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4493672549724579
loss_pred:0.018947694450616837, decouple_loss:0.007547229994088411
The generated pressure mean: 0.4495058059692383
loss_pred:0.018905308097600937, decouple_loss:0.007519228849560022
The generated pressure mean: 0.44958627223968506
loss_pred:0.02030155062675476, decouple_loss:0.007604612503200769
Iteration: 2393, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45019087195396423
loss_pred:0.019771935418248177, decouple_loss:0.007677048910409212
The generated pressure mean: 0.4489687383174896
loss_pred:0.0209669079631567, decouple_loss:0.007546920329332352
The generated pressure mean: 0.450613796710968
loss_pred:0.01957787200808525, decouple_loss:0.007868808694183826
Iteration: 2394, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4506399631500244
The generated pressure mean: 0.4494484066963196
loss_pred:0.01919613406062126, decouple_loss:0.007866174913942814
loss_pred:0.018671885132789612, decouple_loss:0.008070115931332111
The generated pressure mean: 0.4499533772468567
loss_pred:0.02019719034433365, decouple_loss:0.007911136373877525
Iteration: 2395, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4501088559627533
loss_pred:0.018976330757141113, decouple_loss:0.007874097675085068
The generated pressure mean: 0.44979166984558105
loss_pred:0.022028042003512383, decouple_loss:0.007857488468289375
The generated pressure mean: 0.4490653872489929
loss_pred:0.018887069076299667, decouple_loss:0.007547563407570124
Iteration: 2396, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4498698115348816
loss_pred:0.018177000805735588, decouple_loss:0.007976645603775978
The generated pressure mean: 0.4491935968399048
loss_pred:0.019345883280038834, decouple_loss:0.007828044705092907
The generated pressure mean: 0.44926461577415466
loss_pred:0.018524039536714554, decouple_loss:0.008270069025456905
Iteration: 2397, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44967398047447205
loss_pred:0.01778928004205227, decouple_loss:0.007650814019143581
The generated pressure mean: 0.44866886734962463
loss_pred:0.01968414895236492, decouple_loss:0.00801913719624281
The generated pressure mean: 0.4512658417224884
loss_pred:0.020667869597673416, decouple_loss:0.007834982126951218
Iteration: 2398, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4481344223022461
loss_pred:0.01899564266204834, decouple_loss:0.008350968360900879
The generated pressure mean: 0.4491949677467346
loss_pred:0.02132454514503479, decouple_loss:0.00830942764878273
The generated pressure mean: 0.4495770335197449
loss_pred:0.018652131780982018, decouple_loss:0.008474690839648247
Iteration: 2399, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.450023889541626
loss_pred:0.019496005028486252, decouple_loss:0.009142579510807991
The generated pressure mean: 0.4484512209892273
loss_pred:0.018002239987254143, decouple_loss:0.009525342844426632
The generated pressure mean: 0.4495818614959717
loss_pred:0.019936097785830498, decouple_loss:0.009585590101778507
Iteration: 2400, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44838398694992065
loss_pred:0.01881534419953823, decouple_loss:0.007891830056905746
The generated pressure mean: 0.4484190344810486
loss_pred:0.019230062142014503, decouple_loss:0.008575270883738995
The generated pressure mean: 0.4494318962097168
loss_pred:0.019286882132291794, decouple_loss:0.008285429328680038
2023-04-16 11:04:38 testing...
The generated pressure mean: 0.4502691328525543
loss_pred:0.14227266609668732, decouple_loss:0.04564607888460159
The generated pressure mean: 0.4503237307071686
loss_pred:0.14081990718841553, decouple_loss:0.04565104842185974
The generated pressure mean: 0.45002835988998413
loss_pred:0.1415039747953415, decouple_loss:0.04554587975144386
Loss: 0.14381290972232819, avg_mse: 0.2820206582546234
current test mse: 0.282021
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012007_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012007_3_24hr.npz
NaN value num: 0
Iteration: 2401, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4486088156700134
loss_pred:0.01746062934398651, decouple_loss:0.008896950632333755
The generated pressure mean: 0.4483413100242615
loss_pred:0.020134059712290764, decouple_loss:0.008860612288117409
The generated pressure mean: 0.4502754211425781
loss_pred:0.0176799725741148, decouple_loss:0.008814956061542034
Iteration: 2402, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44740262627601624
loss_pred:0.019484328106045723, decouple_loss:0.00822056271135807
The generated pressure mean: 0.44742926955223083
loss_pred:0.01815451681613922, decouple_loss:0.008104377426207066
The generated pressure mean: 0.44748908281326294
loss_pred:0.021770890802145004, decouple_loss:0.008666927926242352
Iteration: 2403, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4489031136035919
loss_pred:0.019216585904359818, decouple_loss:0.00811225175857544
The generated pressure mean: 0.44893643260002136
loss_pred:0.020686591044068336, decouple_loss:0.00839749351143837
The generated pressure mean: 0.4501297175884247
loss_pred:0.018636921420693398, decouple_loss:0.008258011192083359
Iteration: 2404, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.450735867023468
loss_pred:0.018518665805459023, decouple_loss:0.008863436058163643
The generated pressure mean: 0.4488148093223572
loss_pred:0.018851062282919884, decouple_loss:0.008745387196540833
The generated pressure mean: 0.44841131567955017
loss_pred:0.019058246165513992, decouple_loss:0.00904910359531641
Iteration: 2405, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.449388712644577
loss_pred:0.01916693150997162, decouple_loss:0.008635587058961391
The generated pressure mean: 0.4472194314002991
loss_pred:0.01795242168009281, decouple_loss:0.008774078451097012
The generated pressure mean: 0.4506617486476898
loss_pred:0.019266288727521896, decouple_loss:0.008667047135531902
Iteration: 2406, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4481640160083771
loss_pred:0.019078604876995087, decouple_loss:0.010049764066934586
The generated pressure mean: 0.4481504261493683
loss_pred:0.018846167251467705, decouple_loss:0.009537206031382084
The generated pressure mean: 0.44856560230255127
loss_pred:0.01840529963374138, decouple_loss:0.009130674414336681
Iteration: 2407, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4479777216911316
loss_pred:0.018470285460352898, decouple_loss:0.008020258508622646
The generated pressure mean: 0.4484142065048218
loss_pred:0.020109539851546288, decouple_loss:0.007953849621117115
The generated pressure mean: 0.44879254698753357
loss_pred:0.01893078163266182, decouple_loss:0.007952102459967136
Iteration: 2408, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44975942373275757
loss_pred:0.01779557205736637, decouple_loss:0.008688225410878658
The generated pressure mean: 0.4482022225856781
loss_pred:0.018540821969509125, decouple_loss:0.008557513356208801
The generated pressure mean: 0.44850820302963257
loss_pred:0.019246352836489677, decouple_loss:0.008759927935898304
Iteration: 2409, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4479958117008209The generated pressure mean: 0.4467513859272003
loss_pred:0.01996264047920704, decouple_loss:0.008937415666878223
loss_pred:0.019622238352894783, decouple_loss:0.00864674337208271
The generated pressure mean: 0.4488216042518616
loss_pred:0.019148316234350204, decouple_loss:0.008491957560181618
Iteration: 2410, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44866275787353516
loss_pred:0.017895430326461792, decouple_loss:0.008924977853894234
The generated pressure mean: 0.4483582079410553
loss_pred:0.019710306078195572, decouple_loss:0.008748994208872318
The generated pressure mean: 0.4498165249824524
loss_pred:0.017526304349303246, decouple_loss:0.008936896920204163
2023-04-16 11:07:23 testing...
The generated pressure mean: 0.4502691328525543
loss_pred:0.13600869476795197, decouple_loss:0.04191495105624199
The generated pressure mean: 0.4503244161605835
loss_pred:0.13460257649421692, decouple_loss:0.042205046862363815
The generated pressure mean: 0.4500313103199005
loss_pred:0.1355343461036682, decouple_loss:0.041808854788541794
Loss: 0.1374807059764862, avg_mse: 0.2687346637248993
current test mse: 0.268735
Iteration: 2411, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4487890899181366
loss_pred:0.019122499972581863, decouple_loss:0.007986652664840221
The generated pressure mean: 0.44770580530166626
loss_pred:0.02058291807770729, decouple_loss:0.008091432973742485
The generated pressure mean: 0.44746142625808716
loss_pred:0.021342700347304344, decouple_loss:0.008536973968148232
Iteration: 2412, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4478263854980469
loss_pred:0.01927136816084385, decouple_loss:0.008732670918107033
The generated pressure mean: 0.449113130569458
loss_pred:0.018512792885303497, decouple_loss:0.008363527245819569
The generated pressure mean: 0.4477381706237793
loss_pred:0.0198596753180027, decouple_loss:0.008786937221884727
Iteration: 2413, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44760218262672424
loss_pred:0.020652512088418007, decouple_loss:0.009040937758982182
The generated pressure mean: 0.447628915309906
loss_pred:0.01824990287423134, decouple_loss:0.008806506171822548
The generated pressure mean: 0.4482923150062561
loss_pred:0.019050758332014084, decouple_loss:0.008775744587182999
Iteration: 2414, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44961488246917725
loss_pred:0.018204715102910995, decouple_loss:0.00864030234515667
The generated pressure mean: 0.4467170536518097
loss_pred:0.01922987774014473, decouple_loss:0.008939624764025211
The generated pressure mean: 0.4475787281990051
loss_pred:0.017855748534202576, decouple_loss:0.00847344845533371
Iteration: 2415, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4473555088043213
loss_pred:0.020201271399855614, decouple_loss:0.008364996872842312
The generated pressure mean: 0.4472033679485321
loss_pred:0.019998865202069283, decouple_loss:0.008492790162563324
The generated pressure mean: 0.4481087327003479
loss_pred:0.020550787448883057, decouple_loss:0.008503824472427368
Iteration: 2416, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44864699244499207
loss_pred:0.019474830478429794, decouple_loss:0.008356832899153233
The generated pressure mean: 0.4482496976852417
loss_pred:0.01987623982131481, decouple_loss:0.008684075437486172
The generated pressure mean: 0.44900402426719666
loss_pred:0.019144298508763313, decouple_loss:0.008636295795440674
Iteration: 2417, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4464570879936218
loss_pred:0.018539754673838615, decouple_loss:0.008735708892345428
The generated pressure mean: 0.4489681124687195
loss_pred:0.0202169232070446, decouple_loss:0.00878061167895794
The generated pressure mean: 0.4485251009464264
loss_pred:0.01830597221851349, decouple_loss:0.008871287107467651
Iteration: 2418, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44881337881088257
loss_pred:0.01897706277668476, decouple_loss:0.008604025468230247
The generated pressure mean: 0.44913816452026367
loss_pred:0.019209817051887512, decouple_loss:0.008463737554848194
The generated pressure mean: 0.44949305057525635
loss_pred:0.017725413665175438, decouple_loss:0.00869046151638031
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 2419, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.448283851146698
loss_pred:0.020251445472240448, decouple_loss:0.00863097794353962
The generated pressure mean: 0.4490967392921448
loss_pred:0.018813056871294975, decouple_loss:0.008456042036414146
The generated pressure mean: 0.45001742243766785
loss_pred:0.01927514560520649, decouple_loss:0.00885345321148634
Iteration: 2420, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4485767185688019
loss_pred:0.018938884139060974, decouple_loss:0.009970974177122116
The generated pressure mean: 0.4486987888813019
loss_pred:0.018577709794044495, decouple_loss:0.009937193244695663
The generated pressure mean: 0.4469882547855377
loss_pred:0.017677733674645424, decouple_loss:0.009986571036279202
2023-04-16 11:09:29 testing...
The generated pressure mean: 0.4502691328525543
loss_pred:0.12823903560638428, decouple_loss:0.03858887404203415
The generated pressure mean: 0.4503255784511566
loss_pred:0.12719881534576416, decouple_loss:0.03918778896331787
The generated pressure mean: 0.4500320255756378
loss_pred:0.12798061966896057, decouple_loss:0.038801245391368866
Loss: 0.1297491192817688, avg_mse: 0.2484767585992813
current test mse: 0.248477
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012009_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012009_3_24hr.npz
NaN value num: 0
Iteration: 2421, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4494025409221649
loss_pred:0.018816903233528137, decouple_loss:0.009195811115205288
The generated pressure mean: 0.44932129979133606
loss_pred:0.017675571143627167, decouple_loss:0.009016647934913635
The generated pressure mean: 0.44815003871917725
loss_pred:0.017450492829084396, decouple_loss:0.00944237969815731
Iteration: 2422, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4500974416732788
The generated pressure mean: 0.4487094283103943
loss_pred:0.018458902835845947, decouple_loss:0.011199717409908772
The generated pressure mean: 0.44868433475494385
loss_pred:0.019555609673261642, decouple_loss:0.01110862847417593
loss_pred:0.019576940685510635, decouple_loss:0.010634872131049633
Iteration: 2423, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4491032361984253
loss_pred:0.01823011040687561, decouple_loss:0.009941887110471725
The generated pressure mean: 0.4489612281322479
The generated pressure mean: 0.4489741921424866
loss_pred:0.019012998789548874, decouple_loss:0.009755579754710197
loss_pred:0.01933644339442253, decouple_loss:0.009584975428879261
Iteration: 2424, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4485406279563904
loss_pred:0.018535993993282318, decouple_loss:0.010662986896932125
The generated pressure mean: 0.4500466287136078
loss_pred:0.017792750149965286, decouple_loss:0.00997110828757286
The generated pressure mean: 0.44830039143562317
loss_pred:0.019409796223044395, decouple_loss:0.011060736142098904
Iteration: 2425, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44993165135383606The generated pressure mean: 0.45015498995780945
loss_pred:0.018682559952139854, decouple_loss:0.009844401851296425loss_pred:0.020156938582658768, decouple_loss:0.009587913751602173
The generated pressure mean: 0.4493301212787628
loss_pred:0.019032519310712814, decouple_loss:0.009984777309000492
Iteration: 2426, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44903647899627686
The generated pressure mean: 0.44978034496307373
loss_pred:0.01945999264717102, decouple_loss:0.009569010697305202loss_pred:0.019008498638868332, decouple_loss:0.00997291412204504
The generated pressure mean: 0.4491218626499176
loss_pred:0.0197041854262352, decouple_loss:0.010347188450396061
Iteration: 2427, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4470632076263428
loss_pred:0.018606580793857574, decouple_loss:0.009046765975654125
The generated pressure mean: 0.44938239455223083
loss_pred:0.018745185807347298, decouple_loss:0.00916129071265459
The generated pressure mean: 0.4491341710090637
loss_pred:0.01927349530160427, decouple_loss:0.009326408617198467
Iteration: 2428, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4494536221027374
loss_pred:0.017503181472420692, decouple_loss:0.00879441387951374
The generated pressure mean: 0.4482131600379944
loss_pred:0.018097762018442154, decouple_loss:0.00879361480474472
The generated pressure mean: 0.44872793555259705
loss_pred:0.018595967441797256, decouple_loss:0.008673490956425667
Iteration: 2429, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44941672682762146
loss_pred:0.018315419554710388, decouple_loss:0.008276441134512424
The generated pressure mean: 0.45077547430992126
loss_pred:0.01824181340634823, decouple_loss:0.008716206066310406
The generated pressure mean: 0.44959303736686707
loss_pred:0.01937255449593067, decouple_loss:0.00877557322382927
Iteration: 2430, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4499620199203491
loss_pred:0.019210414960980415, decouple_loss:0.008680442348122597
The generated pressure mean: 0.44970592856407166
loss_pred:0.017902325838804245, decouple_loss:0.009123393334448338
The generated pressure mean: 0.44965288043022156
loss_pred:0.01782950572669506, decouple_loss:0.008800171315670013
2023-04-16 11:12:11 testing...
The generated pressure mean: 0.4502691626548767
loss_pred:0.13453321158885956, decouple_loss:0.041631750762462616
The generated pressure mean: 0.45032331347465515
loss_pred:0.13355296850204468, decouple_loss:0.04115622863173485
The generated pressure mean: 0.4500337243080139
loss_pred:0.13408146798610687, decouple_loss:0.04128071293234825
Loss: 0.1361236870288849, avg_mse: 0.262866735458374
current test mse: 0.262867
Iteration: 2431, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4494391679763794
loss_pred:0.018999585881829262, decouple_loss:0.009183075278997421
The generated pressure mean: 0.449273020029068
loss_pred:0.018311304971575737, decouple_loss:0.008376114070415497
The generated pressure mean: 0.448442280292511
loss_pred:0.018283460289239883, decouple_loss:0.008427586406469345
Iteration: 2432, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44973623752593994
loss_pred:0.01870534010231495, decouple_loss:0.008183545432984829
The generated pressure mean: 0.450724720954895
loss_pred:0.019450165331363678, decouple_loss:0.008132688701152802
The generated pressure mean: 0.4479595422744751
loss_pred:0.01869925856590271, decouple_loss:0.00818797666579485
Iteration: 2433, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44846025109291077
The generated pressure mean: 0.44968274235725403
loss_pred:0.019137706607580185, decouple_loss:0.008507970720529556
loss_pred:0.018292104825377464, decouple_loss:0.008658886887133121
The generated pressure mean: 0.4483020305633545
loss_pred:0.018041260540485382, decouple_loss:0.008686363697052002
Iteration: 2434, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44867026805877686
loss_pred:0.01859002560377121, decouple_loss:0.008810566738247871
The generated pressure mean: 0.4503636956214905
loss_pred:0.01868167705833912, decouple_loss:0.009188748896121979
The generated pressure mean: 0.4505554735660553
loss_pred:0.017781374976038933, decouple_loss:0.009212744422256947
Iteration: 2435, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44984790682792664
loss_pred:0.019117532297968864, decouple_loss:0.007984720170497894
The generated pressure mean: 0.45032063126564026
loss_pred:0.019860755652189255, decouple_loss:0.008403519168496132
The generated pressure mean: 0.4490552544593811
loss_pred:0.01900162361562252, decouple_loss:0.008085918612778187
Iteration: 2436, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44997280836105347
loss_pred:0.017542261630296707, decouple_loss:0.008095812052488327
The generated pressure mean: 0.4503925144672394
loss_pred:0.019536476582288742, decouple_loss:0.0088425911962986
The generated pressure mean: 0.4484679400920868
loss_pred:0.01807311363518238, decouple_loss:0.00884409248828888
Iteration: 2437, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4500167667865753
The generated pressure mean: 0.4495512545108795loss_pred:0.01939408853650093, decouple_loss:0.008172420784831047
loss_pred:0.01900669001042843, decouple_loss:0.008401092141866684
The generated pressure mean: 0.4504774510860443
loss_pred:0.01931649073958397, decouple_loss:0.008134043775498867
Iteration: 2438, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44868287444114685
The generated pressure mean: 0.44923070073127747
loss_pred:0.018655383959412575, decouple_loss:0.007991773076355457
loss_pred:0.019204048439860344, decouple_loss:0.008048955351114273
The generated pressure mean: 0.44719570875167847
loss_pred:0.01808108389377594, decouple_loss:0.008178002201020718
Iteration: 2439, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4478189945220947
loss_pred:0.01783105917274952, decouple_loss:0.007554873824119568
The generated pressure mean: 0.4496927559375763
loss_pred:0.0205724835395813, decouple_loss:0.007752075791358948
The generated pressure mean: 0.4509815573692322
loss_pred:0.0179461520165205, decouple_loss:0.007842891849577427
Iteration: 2440, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44993409514427185
The generated pressure mean: 0.45072656869888306
loss_pred:0.017635393887758255, decouple_loss:0.008784128352999687
loss_pred:0.018445316702127457, decouple_loss:0.00873900018632412
The generated pressure mean: 0.44907891750335693
loss_pred:0.01786048524081707, decouple_loss:0.009985578246414661
2023-04-16 11:14:16 testing...
The generated pressure mean: 0.4502691328525543
loss_pred:0.1348508596420288, decouple_loss:0.040116410702466965
The generated pressure mean: 0.45032331347465515
loss_pred:0.13328832387924194, decouple_loss:0.04004814475774765
The generated pressure mean: 0.45002973079681396
loss_pred:0.13408923149108887, decouple_loss:0.03997147083282471
Loss: 0.13607841730117798, avg_mse: 0.26426199078559875
current test mse: 0.264262
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012010_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012010_3_24hr.npz
NaN value num: 0
Iteration: 2441, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4486246705055237
loss_pred:0.018369855359196663, decouple_loss:0.007840112783014774
The generated pressure mean: 0.44779741764068604
loss_pred:0.0188261941075325, decouple_loss:0.00814831256866455
The generated pressure mean: 0.44785040616989136
loss_pred:0.018712805584073067, decouple_loss:0.007909553125500679
Iteration: 2442, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44804275035858154
The generated pressure mean: 0.44906291365623474
loss_pred:0.018122712150216103, decouple_loss:0.00874925497919321
loss_pred:0.018931899219751358, decouple_loss:0.008307239040732384
The generated pressure mean: 0.4474722743034363
loss_pred:0.01838833838701248, decouple_loss:0.008775386959314346
Iteration: 2443, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44724342226982117
loss_pred:0.018992776051163673, decouple_loss:0.009047702886164188
The generated pressure mean: 0.44771769642829895
loss_pred:0.01846216805279255, decouple_loss:0.008753043599426746
The generated pressure mean: 0.4486996829509735
loss_pred:0.0167517252266407, decouple_loss:0.008661645464599133
Iteration: 2444, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4472205936908722
loss_pred:0.01828448474407196, decouple_loss:0.007941141724586487
The generated pressure mean: 0.4482852518558502
loss_pred:0.018743284046649933, decouple_loss:0.007782244123518467
The generated pressure mean: 0.4474320411682129
loss_pred:0.018058618530631065, decouple_loss:0.007633717730641365
Iteration: 2445, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44848203659057617
loss_pred:0.018500881269574165, decouple_loss:0.008510557934641838
The generated pressure mean: 0.4486595690250397
loss_pred:0.018600715324282646, decouple_loss:0.009249716065824032
The generated pressure mean: 0.44730523228645325
loss_pred:0.01929192990064621, decouple_loss:0.008457398042082787
Iteration: 2446, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4483966827392578
loss_pred:0.018673449754714966, decouple_loss:0.007703918963670731
The generated pressure mean: 0.44883590936660767
loss_pred:0.018671905621886253, decouple_loss:0.00739370658993721
The generated pressure mean: 0.4478023648262024
loss_pred:0.01850481517612934, decouple_loss:0.007403162308037281
Iteration: 2447, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4487028419971466
loss_pred:0.01799919456243515, decouple_loss:0.009028295986354351
The generated pressure mean: 0.4483509957790375
loss_pred:0.020294077694416046, decouple_loss:0.00911326240748167
The generated pressure mean: 0.4475158452987671
loss_pred:0.018575750291347504, decouple_loss:0.008878768421709538
Iteration: 2448, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4483322501182556
loss_pred:0.0170875433832407, decouple_loss:0.007540496997535229
The generated pressure mean: 0.448397696018219
loss_pred:0.017913011834025383, decouple_loss:0.007511378265917301
The generated pressure mean: 0.4480951726436615
loss_pred:0.01804519258439541, decouple_loss:0.00773565424606204
Iteration: 2449, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4477945864200592
loss_pred:0.01838502660393715, decouple_loss:0.00818018801510334
The generated pressure mean: 0.4487539231777191
loss_pred:0.018212394788861275, decouple_loss:0.009518131613731384
The generated pressure mean: 0.44702526926994324
loss_pred:0.019249556586146355, decouple_loss:0.008821805007755756
Iteration: 2450, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4495079219341278
loss_pred:0.017552100121974945, decouple_loss:0.00778570119291544
The generated pressure mean: 0.4479236900806427
loss_pred:0.019056033343076706, decouple_loss:0.007831484079360962
The generated pressure mean: 0.4485364556312561
loss_pred:0.01687517575919628, decouple_loss:0.008024869486689568
2023-04-16 11:16:56 testing...
The generated pressure mean: 0.4502691626548767
loss_pred:0.13607707619667053, decouple_loss:0.03996414318680763
The generated pressure mean: 0.45003119111061096
loss_pred:0.13553188741207123, decouple_loss:0.03997110575437546
The generated pressure mean: 0.4503249228000641
loss_pred:0.13484273850917816, decouple_loss:0.03974507004022598
Loss: 0.13747857511043549, avg_mse: 0.26935482025146484
current test mse: 0.269355
Iteration: 2451, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4489791989326477
The generated pressure mean: 0.4471453130245209loss_pred:0.018595559522509575, decouple_loss:0.008048854768276215
loss_pred:0.018359079957008362, decouple_loss:0.007842060178518295
The generated pressure mean: 0.4479312002658844
loss_pred:0.017577264457941055, decouple_loss:0.007989251986145973
Iteration: 2452, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44821062684059143
loss_pred:0.018024761229753494, decouple_loss:0.008451033383607864The generated pressure mean: 0.4474722146987915
loss_pred:0.018129214644432068, decouple_loss:0.008879766799509525
The generated pressure mean: 0.44878488779067993
loss_pred:0.01815204694867134, decouple_loss:0.008554085157811642
Iteration: 2453, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4497535526752472
The generated pressure mean: 0.4481751620769501loss_pred:0.01780414581298828, decouple_loss:0.0078051732853055
loss_pred:0.018484868109226227, decouple_loss:0.007676294073462486
The generated pressure mean: 0.4480971097946167
loss_pred:0.019467739388346672, decouple_loss:0.007662360090762377
Iteration: 2454, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44858020544052124
loss_pred:0.018376024439930916, decouple_loss:0.008715768344700336
The generated pressure mean: 0.4477778375148773
loss_pred:0.02001863159239292, decouple_loss:0.008317366242408752
The generated pressure mean: 0.4479843080043793
loss_pred:0.01860594004392624, decouple_loss:0.009201969020068645
Iteration: 2455, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44889912009239197The generated pressure mean: 0.44779708981513977
loss_pred:0.01900334842503071, decouple_loss:0.008035500533878803loss_pred:0.01893971674144268, decouple_loss:0.007771722041070461
The generated pressure mean: 0.44768026471138
loss_pred:0.02165980078279972, decouple_loss:0.00781641062349081
Iteration: 2456, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44934210181236267
loss_pred:0.016809191554784775, decouple_loss:0.007832301780581474
The generated pressure mean: 0.449419230222702
loss_pred:0.01752452738583088, decouple_loss:0.007956246845424175
The generated pressure mean: 0.44773316383361816
loss_pred:0.017727363854646683, decouple_loss:0.007897553965449333
Iteration: 2457, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44924196600914
loss_pred:0.018504101783037186, decouple_loss:0.008800541050732136
The generated pressure mean: 0.44809168577194214
loss_pred:0.017811398953199387, decouple_loss:0.008529618382453918
The generated pressure mean: 0.44900399446487427
loss_pred:0.018072618171572685, decouple_loss:0.008854194544255733
Iteration: 2458, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4483974874019623
loss_pred:0.018086927011609077, decouple_loss:0.007532163988798857
The generated pressure mean: 0.44861310720443726
loss_pred:0.016698146238923073, decouple_loss:0.007750756107270718
The generated pressure mean: 0.44756969809532166
loss_pred:0.01728469505906105, decouple_loss:0.007775983773171902
Iteration: 2459, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4477456212043762
The generated pressure mean: 0.4477553069591522loss_pred:0.01920892298221588, decouple_loss:0.008320434018969536
loss_pred:0.018791114911437035, decouple_loss:0.008369424380362034
The generated pressure mean: 0.44768765568733215
loss_pred:0.018141232430934906, decouple_loss:0.008298300206661224
Iteration: 2460, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44915100932121277
loss_pred:0.017214376479387283, decouple_loss:0.008141878992319107
The generated pressure mean: 0.44869571924209595
loss_pred:0.01757683791220188, decouple_loss:0.008108909241855145
The generated pressure mean: 0.4490651786327362
loss_pred:0.017556611448526382, decouple_loss:0.008174090646207333
2023-04-16 11:19:01 testing...
The generated pressure mean: 0.4502691924571991
loss_pred:0.13286583125591278, decouple_loss:0.038918085396289825
The generated pressure mean: 0.4503246247768402
loss_pred:0.13200081884860992, decouple_loss:0.0392313152551651
The generated pressure mean: 0.45003050565719604
loss_pred:0.1324903517961502, decouple_loss:0.038940612226724625
Loss: 0.13440382480621338, avg_mse: 0.2616714835166931
current test mse: 0.261671
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012012_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012012_3_24hr.npz
NaN value num: 0
Iteration: 2461, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44744420051574707
loss_pred:0.019028594717383385, decouple_loss:0.00809664186090231
The generated pressure mean: 0.4486634135246277
loss_pred:0.01926971971988678, decouple_loss:0.007754561025649309
The generated pressure mean: 0.4485955238342285
loss_pred:0.020912237465381622, decouple_loss:0.007635485380887985
Iteration: 2462, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44659748673439026
loss_pred:0.01895948126912117, decouple_loss:0.00692421430721879
The generated pressure mean: 0.44728052616119385
The generated pressure mean: 0.44748303294181824
loss_pred:0.01896575279533863, decouple_loss:0.00695488415658474
loss_pred:0.019163008779287338, decouple_loss:0.00722365640103817
Iteration: 2463, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44746217131614685
loss_pred:0.01955668069422245, decouple_loss:0.0071118115447461605
The generated pressure mean: 0.44822096824645996
loss_pred:0.019442591816186905, decouple_loss:0.007293689530342817
The generated pressure mean: 0.44775184988975525
loss_pred:0.0192083939909935, decouple_loss:0.007189515046775341
Iteration: 2464, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44762733578681946
The generated pressure mean: 0.4479314684867859
loss_pred:0.0203495342284441, decouple_loss:0.007370778825134039
loss_pred:0.017911141738295555, decouple_loss:0.007142700720578432
The generated pressure mean: 0.4475453197956085
loss_pred:0.018838874995708466, decouple_loss:0.007343471050262451
Iteration: 2465, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44733554124832153
loss_pred:0.01915271393954754, decouple_loss:0.007011480629444122
The generated pressure mean: 0.4474393427371979
loss_pred:0.019495027139782906, decouple_loss:0.007130147889256477
The generated pressure mean: 0.4465578496456146
loss_pred:0.01901579089462757, decouple_loss:0.007150360848754644
Iteration: 2466, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4485558867454529
The generated pressure mean: 0.4475603401660919
loss_pred:0.018492409959435463, decouple_loss:0.0069220843724906445
loss_pred:0.018985074013471603, decouple_loss:0.007254983764141798
The generated pressure mean: 0.4486589729785919
loss_pred:0.018725281581282616, decouple_loss:0.007049546577036381
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 2467, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44711244106292725The generated pressure mean: 0.44779983162879944
loss_pred:0.019386988133192062, decouple_loss:0.007073311600834131loss_pred:0.019144752994179726, decouple_loss:0.007172977551817894
The generated pressure mean: 0.44776949286460876
loss_pred:0.018659427762031555, decouple_loss:0.007080042269080877
Iteration: 2468, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44765162467956543
The generated pressure mean: 0.4473743736743927
loss_pred:0.018917592242360115, decouple_loss:0.007205017376691103
loss_pred:0.019216058775782585, decouple_loss:0.0073219179175794125
The generated pressure mean: 0.446426123380661
loss_pred:0.01793934963643551, decouple_loss:0.00740824593231082
Iteration: 2469, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44758981466293335The generated pressure mean: 0.44829100370407104
loss_pred:0.01921108365058899, decouple_loss:0.00764057831838727
loss_pred:0.020915843546390533, decouple_loss:0.007511455565690994
The generated pressure mean: 0.4466734826564789
loss_pred:0.019293848425149918, decouple_loss:0.007867694832384586
Iteration: 2470, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4468729496002197
loss_pred:0.019201479852199554, decouple_loss:0.008008062839508057
The generated pressure mean: 0.4478969871997833
loss_pred:0.019249290227890015, decouple_loss:0.008534856140613556
The generated pressure mean: 0.44660961627960205
loss_pred:0.01974531263113022, decouple_loss:0.008062493987381458
2023-04-16 11:21:43 testing...
The generated pressure mean: 0.4502691328525543
loss_pred:0.13331986963748932, decouple_loss:0.03893369436264038
The generated pressure mean: 0.45032355189323425
loss_pred:0.1320198029279709, decouple_loss:0.03927616775035858
The generated pressure mean: 0.45003193616867065
loss_pred:0.13266178965568542, decouple_loss:0.039181455969810486
Loss: 0.1346236765384674, avg_mse: 0.26253584027290344
current test mse: 0.262536
Iteration: 2471, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44753503799438477
loss_pred:0.01905183121562004, decouple_loss:0.0068626077845692635
The generated pressure mean: 0.4476560652256012
The generated pressure mean: 0.44776836037635803
loss_pred:0.01789647713303566, decouple_loss:0.00707797659561038
loss_pred:0.01815791428089142, decouple_loss:0.007055735215544701
Iteration: 2472, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4483844041824341
loss_pred:0.018571114167571068, decouple_loss:0.007865652441978455
The generated pressure mean: 0.4483970105648041
The generated pressure mean: 0.44671449065208435
loss_pred:0.01777803711593151, decouple_loss:0.007920503616333008
loss_pred:0.018609877675771713, decouple_loss:0.008124938234686852
Iteration: 2473, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44748827815055847
loss_pred:0.019280755892395973, decouple_loss:0.007646005600690842
The generated pressure mean: 0.4470944404602051
loss_pred:0.019187387079000473, decouple_loss:0.007673708256334066
The generated pressure mean: 0.44661596417427063
loss_pred:0.018191175535321236, decouple_loss:0.007749530021101236
Iteration: 2474, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4484263062477112The generated pressure mean: 0.4471163749694824
loss_pred:0.01981438510119915, decouple_loss:0.0071984268724918365
loss_pred:0.020480036735534668, decouple_loss:0.006928484421223402
The generated pressure mean: 0.44816309213638306
loss_pred:0.01827957108616829, decouple_loss:0.007063048891723156
Iteration: 2475, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4466375708580017
loss_pred:0.01792958565056324, decouple_loss:0.007397707086056471
The generated pressure mean: 0.4474130868911743
loss_pred:0.01828562095761299, decouple_loss:0.007524976972490549
The generated pressure mean: 0.4467445909976959
loss_pred:0.019121112301945686, decouple_loss:0.007190905977040529
Iteration: 2476, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44939911365509033
The generated pressure mean: 0.447529673576355
loss_pred:0.01827147975564003, decouple_loss:0.007065154612064362
loss_pred:0.0184717308729887, decouple_loss:0.007094838190823793
The generated pressure mean: 0.4476868808269501
loss_pred:0.01773788407444954, decouple_loss:0.006876986939460039
Iteration: 2477, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4471591114997864
The generated pressure mean: 0.4474366307258606
loss_pred:0.019381212070584297, decouple_loss:0.007288074120879173
loss_pred:0.018317293375730515, decouple_loss:0.007150646764785051
The generated pressure mean: 0.44733574986457825
loss_pred:0.017997633665800095, decouple_loss:0.007060448173433542
Iteration: 2478, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44808486104011536
The generated pressure mean: 0.4476657509803772loss_pred:0.018419558182358742, decouple_loss:0.007400101516395807
loss_pred:0.017903609201312065, decouple_loss:0.00712059810757637
The generated pressure mean: 0.4479124844074249
loss_pred:0.01834234409034252, decouple_loss:0.007205444388091564
Iteration: 2479, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4489959478378296
The generated pressure mean: 0.44782084226608276loss_pred:0.017897015437483788, decouple_loss:0.006709123961627483
loss_pred:0.01736622489988804, decouple_loss:0.0067188371904194355
The generated pressure mean: 0.4468247890472412
loss_pred:0.01907854899764061, decouple_loss:0.0068402644246816635
Iteration: 2480, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4472770690917969
The generated pressure mean: 0.44792506098747253loss_pred:0.02021927945315838, decouple_loss:0.006821385584771633
loss_pred:0.019283587113022804, decouple_loss:0.006798028014600277
The generated pressure mean: 0.44701722264289856
loss_pred:0.018704211339354515, decouple_loss:0.006849268451333046
2023-04-16 11:23:48 testing...
The generated pressure mean: 0.4502691626548767
loss_pred:0.14089283347129822, decouple_loss:0.040555961430072784
The generated pressure mean: 0.45032626390457153
loss_pred:0.13993200659751892, decouple_loss:0.040988337248563766
The generated pressure mean: 0.4500289857387543
loss_pred:0.1404309868812561, decouple_loss:0.04062095656991005
Loss: 0.14245468378067017, avg_mse: 0.2802604138851166
current test mse: 0.28026
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012015_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012015_3_24hr.npz
NaN value num: 0
Iteration: 2481, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44904398918151855
loss_pred:0.01898159645497799, decouple_loss:0.0070544821210205555
The generated pressure mean: 0.4481333792209625
loss_pred:0.019799256697297096, decouple_loss:0.007099287584424019
The generated pressure mean: 0.44654735922813416
loss_pred:0.018128719180822372, decouple_loss:0.007099816109985113
Iteration: 2482, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4497697651386261
loss_pred:0.018566282466053963, decouple_loss:0.007455526385456324
The generated pressure mean: 0.44856327772140503
loss_pred:0.018450474366545677, decouple_loss:0.007019901182502508
The generated pressure mean: 0.44821566343307495
loss_pred:0.01870786026120186, decouple_loss:0.006914037279784679
Iteration: 2483, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4462405741214752
loss_pred:0.019388411194086075, decouple_loss:0.007797182071954012
The generated pressure mean: 0.4495350122451782
loss_pred:0.01877930760383606, decouple_loss:0.006979517173022032
The generated pressure mean: 0.4486021101474762
loss_pred:0.01994587667286396, decouple_loss:0.007160800509154797
Iteration: 2484, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4474710524082184
loss_pred:0.019442658871412277, decouple_loss:0.006729543209075928
The generated pressure mean: 0.448962539434433
loss_pred:0.019818920642137527, decouple_loss:0.006581827998161316
The generated pressure mean: 0.44851192831993103
loss_pred:0.019825544208288193, decouple_loss:0.006797469686716795
Iteration: 2485, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4488533139228821
loss_pred:0.018696974962949753, decouple_loss:0.006997710559517145
The generated pressure mean: 0.4478645622730255
loss_pred:0.01841563545167446, decouple_loss:0.006606324575841427
The generated pressure mean: 0.4465455710887909
loss_pred:0.017688564956188202, decouple_loss:0.0067252516746521
Iteration: 2486, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44803398847579956
loss_pred:0.018733574077486992, decouple_loss:0.006785204634070396
The generated pressure mean: 0.44767504930496216
loss_pred:0.01923290267586708, decouple_loss:0.006826166063547134
The generated pressure mean: 0.4487922787666321
loss_pred:0.018366627395153046, decouple_loss:0.0070489211939275265
Iteration: 2487, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4487802982330322
The generated pressure mean: 0.4499446749687195
loss_pred:0.018705666065216064, decouple_loss:0.006565280724316835
loss_pred:0.01785651035606861, decouple_loss:0.007354101166129112
The generated pressure mean: 0.44952884316444397
loss_pred:0.01857145130634308, decouple_loss:0.0066132694482803345
Iteration: 2488, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4489302635192871
loss_pred:0.01811371184885502, decouple_loss:0.00759505107998848
The generated pressure mean: 0.44693246483802795
loss_pred:0.018949970602989197, decouple_loss:0.007588257547467947
The generated pressure mean: 0.44698792695999146
loss_pred:0.018426574766635895, decouple_loss:0.007878289557993412
Iteration: 2489, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44804176688194275
The generated pressure mean: 0.44593513011932373
loss_pred:0.018471024930477142, decouple_loss:0.0074351015500724316
loss_pred:0.019482139497995377, decouple_loss:0.006815139204263687
The generated pressure mean: 0.44687989354133606
loss_pred:0.0186608973890543, decouple_loss:0.00714607210829854
Iteration: 2490, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44773784279823303
The generated pressure mean: 0.4480946362018585
loss_pred:0.017725910991430283, decouple_loss:0.006804382894188166
loss_pred:0.018496304750442505, decouple_loss:0.006895093712955713
The generated pressure mean: 0.44917982816696167
loss_pred:0.018615346401929855, decouple_loss:0.007163133006542921
2023-04-16 11:26:34 testing...
The generated pressure mean: 0.4502691328525543
loss_pred:0.13833647966384888, decouple_loss:0.04001856595277786
The generated pressure mean: 0.4503282308578491
loss_pred:0.1365569680929184, decouple_loss:0.04048343375325203
The generated pressure mean: 0.45003455877304077
loss_pred:0.1373550295829773, decouple_loss:0.04008445143699646
Loss: 0.13942593336105347, avg_mse: 0.27215924859046936
current test mse: 0.272159
Iteration: 2491, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44901275634765625The generated pressure mean: 0.44772598147392273
The generated pressure mean: 0.4485622048377991
loss_pred:0.019218141213059425, decouple_loss:0.006886542774736881
loss_pred:0.018543962389230728, decouple_loss:0.006828745827078819
loss_pred:0.019997475668787956, decouple_loss:0.0066056097857654095
Iteration: 2492, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44875797629356384
The generated pressure mean: 0.44836506247520447
loss_pred:0.019409658387303352, decouple_loss:0.007391957100480795
loss_pred:0.02116583287715912, decouple_loss:0.008167626336216927
The generated pressure mean: 0.44813618063926697
loss_pred:0.01779308170080185, decouple_loss:0.007148256059736013
Iteration: 2493, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4479861259460449
loss_pred:0.01827346906065941, decouple_loss:0.007264904212206602
The generated pressure mean: 0.44860464334487915
The generated pressure mean: 0.4480411112308502
loss_pred:0.018999803811311722, decouple_loss:0.007039940450340509
loss_pred:0.020219901576638222, decouple_loss:0.007371592801064253
Iteration: 2494, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44775891304016113
The generated pressure mean: 0.44883233308792114
loss_pred:0.017617372795939445, decouple_loss:0.006681598257273436
loss_pred:0.019607970491051674, decouple_loss:0.007188154384493828
The generated pressure mean: 0.4478970766067505
loss_pred:0.018843401223421097, decouple_loss:0.006608272437006235
Iteration: 2495, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44959697127342224
The generated pressure mean: 0.44832491874694824
loss_pred:0.018704554066061974, decouple_loss:0.0074086966924369335
loss_pred:0.01866341382265091, decouple_loss:0.007917004637420177
The generated pressure mean: 0.4482773244380951
loss_pred:0.0190680343657732, decouple_loss:0.008099228143692017
Iteration: 2496, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44914984703063965The generated pressure mean: 0.44781866669654846
loss_pred:0.01742001622915268, decouple_loss:0.007296325638890266loss_pred:0.019276507198810577, decouple_loss:0.00786644872277975
The generated pressure mean: 0.4489889144897461
loss_pred:0.020502297207713127, decouple_loss:0.00749262934550643
Iteration: 2497, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.448761910200119
The generated pressure mean: 0.44819459319114685
loss_pred:0.019345832988619804, decouple_loss:0.0078622717410326
loss_pred:0.01968957856297493, decouple_loss:0.008315936662256718
The generated pressure mean: 0.44653305411338806
loss_pred:0.019315628334879875, decouple_loss:0.007410026155412197
Iteration: 2498, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4485364556312561
loss_pred:0.01858494058251381, decouple_loss:0.009071733802556992
The generated pressure mean: 0.4483625590801239
loss_pred:0.018224289640784264, decouple_loss:0.008211244828999043
The generated pressure mean: 0.44773608446121216
loss_pred:0.01943235471844673, decouple_loss:0.008243906311690807
Iteration: 2499, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4496094584465027
The generated pressure mean: 0.4491285979747772
loss_pred:0.017317818477749825, decouple_loss:0.007272155024111271
loss_pred:0.019070563837885857, decouple_loss:0.007355915382504463
The generated pressure mean: 0.44931015372276306
loss_pred:0.01898183301091194, decouple_loss:0.00745747797191143
Iteration: 2500, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44903549551963806
The generated pressure mean: 0.4494002163410187
loss_pred:0.018448814749717712, decouple_loss:0.00786549225449562
loss_pred:0.018894696608185768, decouple_loss:0.007993726059794426
The generated pressure mean: 0.44777145981788635
loss_pred:0.018382195383310318, decouple_loss:0.007498080376535654
2023-04-16 11:28:39 testing...
The generated pressure mean: 0.4502691328525543
loss_pred:0.14362548291683197, decouple_loss:0.04301770031452179
The generated pressure mean: 0.4500320851802826
loss_pred:0.14253263175487518, decouple_loss:0.04307498782873154
The generated pressure mean: 0.450325608253479
loss_pred:0.14217127859592438, decouple_loss:0.04317696392536163
Loss: 0.14493095874786377, avg_mse: 0.28359055519104004
current test mse: 0.283591
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012019_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012019_3_24hr.npz
NaN value num: 0
Iteration: 2501, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4502246379852295
loss_pred:0.019158216193318367, decouple_loss:0.007096116431057453
The generated pressure mean: 0.45086970925331116
loss_pred:0.01912175677716732, decouple_loss:0.007138568442314863
The generated pressure mean: 0.45005977153778076
loss_pred:0.01856100931763649, decouple_loss:0.006894010119140148
Iteration: 2502, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4488002359867096
loss_pred:0.02073245868086815, decouple_loss:0.007480403408408165
The generated pressure mean: 0.4490867257118225
loss_pred:0.019126910716295242, decouple_loss:0.007385734468698502
The generated pressure mean: 0.45080330967903137
loss_pred:0.019566280767321587, decouple_loss:0.007260526064783335
Iteration: 2503, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45069801807403564
loss_pred:0.020562246441841125, decouple_loss:0.007098096422851086
The generated pressure mean: 0.4497697949409485
loss_pred:0.0207773856818676, decouple_loss:0.007275538053363562
The generated pressure mean: 0.4494325518608093
loss_pred:0.02228652685880661, decouple_loss:0.007236562203615904
Iteration: 2504, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4489428400993347
loss_pred:0.02261904813349247, decouple_loss:0.007750890217721462
The generated pressure mean: 0.4497579336166382
loss_pred:0.021753886714577675, decouple_loss:0.00783483311533928
The generated pressure mean: 0.44986072182655334
loss_pred:0.01987616904079914, decouple_loss:0.007521768566220999
Iteration: 2505, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4496918320655823
loss_pred:0.01886036805808544, decouple_loss:0.0076943328604102135
The generated pressure mean: 0.45057711005210876
loss_pred:0.019772641360759735, decouple_loss:0.0071821934543550014
The generated pressure mean: 0.4511597156524658
loss_pred:0.018782876431941986, decouple_loss:0.007395478431135416
Iteration: 2506, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44993579387664795
loss_pred:0.02008160762488842, decouple_loss:0.008323084563016891
The generated pressure mean: 0.4503609538078308
loss_pred:0.01987297274172306, decouple_loss:0.008039779029786587
The generated pressure mean: 0.4495840072631836
loss_pred:0.018406763672828674, decouple_loss:0.008022034540772438
Iteration: 2507, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.449776828289032
loss_pred:0.020165253430604935, decouple_loss:0.008706032298505306
The generated pressure mean: 0.44903919100761414
loss_pred:0.020459212362766266, decouple_loss:0.008673673495650291
The generated pressure mean: 0.4494004249572754
loss_pred:0.019928691908717155, decouple_loss:0.008674663491547108
Iteration: 2508, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4498445391654968
loss_pred:0.019585266709327698, decouple_loss:0.008091583847999573
The generated pressure mean: 0.45148006081581116
loss_pred:0.017640171572566032, decouple_loss:0.008177326060831547
The generated pressure mean: 0.4502660632133484
loss_pred:0.019810356199741364, decouple_loss:0.008410136215388775
Iteration: 2509, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4513983428478241
loss_pred:0.020113728940486908, decouple_loss:0.00845364946871996
The generated pressure mean: 0.44985976815223694
loss_pred:0.021355515345931053, decouple_loss:0.008289108984172344
The generated pressure mean: 0.44894659519195557
loss_pred:0.02102731727063656, decouple_loss:0.00832636933773756
Iteration: 2510, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44931450486183167
The generated pressure mean: 0.4482322037220001
loss_pred:0.019182872027158737, decouple_loss:0.008820716291666031
loss_pred:0.02061464451253414, decouple_loss:0.008827293291687965
The generated pressure mean: 0.4496115446090698
loss_pred:0.019126780331134796, decouple_loss:0.008906887844204903
2023-04-16 11:31:26 testing...
The generated pressure mean: 0.4502691626548767
loss_pred:0.1385517567396164, decouple_loss:0.04081031307578087
The generated pressure mean: 0.4503256678581238
loss_pred:0.13721519708633423, decouple_loss:0.0414152629673481
The generated pressure mean: 0.4500293433666229
loss_pred:0.13824304938316345, decouple_loss:0.04112766683101654
Loss: 0.140059232711792, avg_mse: 0.27124375104904175
current test mse: 0.271244
Iteration: 2511, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45068392157554626
loss_pred:0.019315946847200394, decouple_loss:0.008450974710285664
The generated pressure mean: 0.4507123529911041
loss_pred:0.018472516909241676, decouple_loss:0.008829188533127308
The generated pressure mean: 0.45064470171928406
loss_pred:0.017809994518756866, decouple_loss:0.008439159952104092
Iteration: 2512, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4513835608959198
The generated pressure mean: 0.45004794001579285
loss_pred:0.019311605021357536, decouple_loss:0.008923894725739956
loss_pred:0.017970142886042595, decouple_loss:0.008692792616784573
The generated pressure mean: 0.44977062940597534
loss_pred:0.01823188178241253, decouple_loss:0.00847495999187231
Iteration: 2513, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44863149523735046
loss_pred:0.01961747743189335, decouple_loss:0.008699841797351837
The generated pressure mean: 0.45076096057891846
loss_pred:0.018635952845215797, decouple_loss:0.008847013115882874
The generated pressure mean: 0.4512367844581604
loss_pred:0.0189634058624506, decouple_loss:0.008568936958909035
Iteration: 2514, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45026695728302
The generated pressure mean: 0.4491612911224365loss_pred:0.01869288645684719, decouple_loss:0.007897481322288513
loss_pred:0.020025087520480156, decouple_loss:0.0080205537378788
The generated pressure mean: 0.4498405158519745
loss_pred:0.01755487732589245, decouple_loss:0.00776936300098896
Iteration: 2515, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45095962285995483
loss_pred:0.02067759446799755, decouple_loss:0.008781567215919495
The generated pressure mean: 0.4500076472759247
loss_pred:0.018595725297927856, decouple_loss:0.008683844469487667
The generated pressure mean: 0.45023009181022644
loss_pred:0.01918240450322628, decouple_loss:0.008502284996211529
Iteration: 2516, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.450410395860672
loss_pred:0.019401589408516884, decouple_loss:0.007995913736522198
The generated pressure mean: 0.4486033618450165
loss_pred:0.02053433284163475, decouple_loss:0.008163278922438622
The generated pressure mean: 0.4498116970062256
loss_pred:0.01942535862326622, decouple_loss:0.008133855648338795
Iteration: 2517, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45035356283187866The generated pressure mean: 0.4494347870349884
loss_pred:0.01902483031153679, decouple_loss:0.007910998538136482
loss_pred:0.018564285710453987, decouple_loss:0.008001824840903282
The generated pressure mean: 0.44949182868003845
loss_pred:0.020327933132648468, decouple_loss:0.007963281124830246
Iteration: 2518, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.449848473072052
The generated pressure mean: 0.4496022164821625
loss_pred:0.01876719668507576, decouple_loss:0.007846979424357414
loss_pred:0.01797155849635601, decouple_loss:0.007899822667241096
The generated pressure mean: 0.44918128848075867
loss_pred:0.020599614828824997, decouple_loss:0.008043779991567135
Iteration: 2519, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44920533895492554
The generated pressure mean: 0.4502469301223755
loss_pred:0.019994931295514107, decouple_loss:0.007695198990404606
loss_pred:0.021098604425787926, decouple_loss:0.007641051430255175
The generated pressure mean: 0.4485466182231903
loss_pred:0.018094882369041443, decouple_loss:0.007887843996286392
Iteration: 2520, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44951316714286804
loss_pred:0.020124053582549095, decouple_loss:0.007607753854244947
The generated pressure mean: 0.4489675462245941
loss_pred:0.01951879821717739, decouple_loss:0.007775803562253714
The generated pressure mean: 0.4486059546470642
loss_pred:0.017727108672261238, decouple_loss:0.007465536240488291
2023-04-16 11:33:32 testing...
The generated pressure mean: 0.4502691626548767
loss_pred:0.14100544154644012, decouple_loss:0.04210139065980911
The generated pressure mean: 0.4503242075443268
loss_pred:0.1395631581544876, decouple_loss:0.04239468649029732
The generated pressure mean: 0.45002904534339905
loss_pred:0.14021025598049164, decouple_loss:0.04230755940079689
Loss: 0.14237302541732788, avg_mse: 0.2771632671356201
current test mse: 0.277163
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012013_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012013_3_24hr.npz
NaN value num: 0
Iteration: 2521, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44804489612579346
loss_pred:0.017978990450501442, decouple_loss:0.007740671746432781
The generated pressure mean: 0.44887277483940125
loss_pred:0.01809554547071457, decouple_loss:0.007726561278104782
The generated pressure mean: 0.44788482785224915
loss_pred:0.02021476812660694, decouple_loss:0.007991613820195198
Iteration: 2522, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.447095662355423
loss_pred:0.020722268149256706, decouple_loss:0.008358282968401909
The generated pressure mean: 0.4483296573162079
loss_pred:0.018434645608067513, decouple_loss:0.007504190318286419
The generated pressure mean: 0.44802042841911316
loss_pred:0.01871110498905182, decouple_loss:0.007445283699780703
Iteration: 2523, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4480816423892975
The generated pressure mean: 0.4473901093006134
loss_pred:0.016880426555871964, decouple_loss:0.008682620711624622
loss_pred:0.01937716268002987, decouple_loss:0.008170995861291885
The generated pressure mean: 0.44820448756217957
loss_pred:0.01939721219241619, decouple_loss:0.0080571249127388
Iteration: 2524, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4471234083175659
loss_pred:0.01840539462864399, decouple_loss:0.008298798464238644
The generated pressure mean: 0.44857245683670044
loss_pred:0.017950445413589478, decouple_loss:0.008519131690263748
The generated pressure mean: 0.44871020317077637
loss_pred:0.018814511597156525, decouple_loss:0.008076854981482029
Iteration: 2525, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4481019377708435
The generated pressure mean: 0.44766250252723694loss_pred:0.018208635970950127, decouple_loss:0.007192292716354132
loss_pred:0.019169744104146957, decouple_loss:0.0071825929917395115
The generated pressure mean: 0.44862088561058044
loss_pred:0.019908621907234192, decouple_loss:0.00733228400349617
Iteration: 2526, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4478958249092102
The generated pressure mean: 0.44845515489578247
loss_pred:0.018087584525346756, decouple_loss:0.00883072055876255
loss_pred:0.017847368493676186, decouple_loss:0.008247172459959984
The generated pressure mean: 0.44876447319984436
loss_pred:0.01765936054289341, decouple_loss:0.00924295000731945
Iteration: 2527, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44935357570648193
loss_pred:0.01839653216302395, decouple_loss:0.008254865184426308
The generated pressure mean: 0.4476199746131897
loss_pred:0.018801506608724594, decouple_loss:0.008037684485316277
The generated pressure mean: 0.4472927451133728
loss_pred:0.018677573651075363, decouple_loss:0.009132268838584423
Iteration: 2528, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44856613874435425
The generated pressure mean: 0.4474957585334778loss_pred:0.018492503091692924, decouple_loss:0.007768566254526377
loss_pred:0.019292758777737617, decouple_loss:0.007929780520498753
The generated pressure mean: 0.4483645260334015
loss_pred:0.018184170126914978, decouple_loss:0.007917261682450771
Iteration: 2529, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4489630162715912
loss_pred:0.01810876466333866, decouple_loss:0.007313411217182875
The generated pressure mean: 0.4494900107383728
loss_pred:0.018058575689792633, decouple_loss:0.007396381348371506
The generated pressure mean: 0.4468579888343811
