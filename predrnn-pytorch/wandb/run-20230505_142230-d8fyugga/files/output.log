
load model: /work/09012/haoli1/ls6/PredRNN_checkpoints/WV_0_PC_1_EH_0_PS_40_6/model_2000.ckpt
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012001_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012002_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012003_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012004_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012005_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012006_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012007_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012008_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012009_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012010_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012011_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012012_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012013_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012014_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012015_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012016_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012017_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012018_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012019_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012020_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012000_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012001_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012002_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012003_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012004_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012005_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012006_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012007_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012008_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012009_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012010_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012011_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012012_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012013_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012014_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012015_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012016_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012017_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012018_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012019_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012020_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012000_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012001_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012002_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012003_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012004_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012005_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012006_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012007_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012008_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012009_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012010_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012011_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012012_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012013_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012014_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012015_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012016_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012017_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012018_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012019_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012020_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012000_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012001_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012002_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012003_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012004_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012005_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012006_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012007_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012008_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012009_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012010_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012011_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012012_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012013_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012014_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012015_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012016_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012017_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012018_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012019_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012020_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012000_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012001_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012002_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012003_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012004_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012005_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012006_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012007_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012008_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012009_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012010_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012011_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012012_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012013_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012014_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012015_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012016_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012017_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012018_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012019_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012000_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012001_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012002_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012003_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012004_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012005_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012006_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012007_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012008_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012009_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012010_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012011_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012012_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012013_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012014_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012015_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012016_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012017_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012018_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012019_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012020_3_24hr.npz
train_data_files nums: 124
mnist test iterator, Loading data from /scratch/09012/haoli1/ERA5/val_dataset/era5_train_09012020_3_24hr.npz
NaN value num: 0
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012008_3_24hr.npz
NaN value num: 0
Iteration: 1, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467865526676178, gen p mean: -0.7241132855415344, mean p set: 0.4472668468952179
loss_pred:0.025794897228479385, decouple_loss:0.011412589810788631
The modified gen p mean: 0.44680145382881165, gen p mean: -0.7246542572975159, mean p set: 0.44728177785873413
loss_pred:0.026129698380827904, decouple_loss:0.011594223789870739
The modified gen p mean: 0.44611552357673645, gen p mean: -0.715758204460144, mean p set: 0.44659578800201416
loss_pred:0.026766572147607803, decouple_loss:0.011864274740219116
/work/09012/haoli1/ls6/Pyt/lib/python3.9/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '
Iteration: 2, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44634103775024414, gen p mean: -0.5757395625114441, mean p set: 0.44682133197784424
The modified gen p mean: 0.446666419506073, gen p mean: -0.5741305351257324, mean p set: 0.4471467435359955
The modified gen p mean: 0.4471513628959656, gen p mean: -0.5684082508087158, mean p set: 0.4476316571235657
loss_pred:0.12638424336910248, decouple_loss:0.18352150917053223
loss_pred:0.12844222784042358, decouple_loss:0.18654808402061462
loss_pred:0.12840144336223602, decouple_loss:0.18407045304775238
Iteration: 3, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44643449783325195, gen p mean: -0.5549284815788269, mean p set: 0.44691479206085205
The modified gen p mean: 0.44656580686569214, gen p mean: -0.5493753552436829, mean p set: 0.44704607129096985
The modified gen p mean: 0.44701677560806274, gen p mean: -0.5538482666015625, mean p set: 0.44749704003334045
loss_pred:0.05606217682361603, decouple_loss:0.18388815224170685
loss_pred:0.05529828742146492, decouple_loss:0.17582082748413086
loss_pred:0.05768673121929169, decouple_loss:0.18812866508960724
Iteration: 4, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468805491924286, gen p mean: -0.4757164418697357, mean p set: 0.4473608434200287
The modified gen p mean: 0.44700536131858826, gen p mean: -0.47740739583969116, mean p set: 0.44748565554618835
The modified gen p mean: 0.44680383801460266, gen p mean: -0.4811486005783081, mean p set: 0.44728413224220276
loss_pred:0.05765517055988312, decouple_loss:0.12128803879022598
loss_pred:0.05814303830265999, decouple_loss:0.12397710233926773
loss_pred:0.05640510097146034, decouple_loss:0.12132799625396729
Iteration: 5, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472530484199524, gen p mean: -0.43351420760154724, mean p set: 0.4477333426475525
The modified gen p mean: 0.44517549872398376, gen p mean: -0.4299975633621216, mean p set: 0.44565579295158386
loss_pred:0.04757632687687874, decouple_loss:0.11430247873067856
loss_pred:0.047669876366853714, decouple_loss:0.1103501170873642
The modified gen p mean: 0.4464333653450012, gen p mean: -0.4358927309513092, mean p set: 0.44691362977027893
loss_pred:0.04773985967040062, decouple_loss:0.11147214472293854
Iteration: 6, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484494626522064, gen p mean: -0.46303147077560425, mean p set: 0.4489297568798065
The modified gen p mean: 0.4460991322994232, gen p mean: -0.46297985315322876, mean p set: 0.4465794563293457
The modified gen p mean: 0.4467034637928009, gen p mean: -0.46442538499832153, mean p set: 0.447183758020401
loss_pred:0.044743943959474564, decouple_loss:0.1128375306725502
loss_pred:0.046636343002319336, decouple_loss:0.11042038351297379
loss_pred:0.04593206197023392, decouple_loss:0.11415613442659378
Iteration: 7, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4456709921360016, gen p mean: -0.40040308237075806, mean p set: 0.4461512565612793
The modified gen p mean: 0.44530779123306274, gen p mean: -0.39800557494163513, mean p set: 0.44578808546066284
The modified gen p mean: 0.44661515951156616, gen p mean: -0.3989841341972351, mean p set: 0.44709545373916626
loss_pred:0.04409624636173248, decouple_loss:0.09519720822572708
loss_pred:0.043620988726615906, decouple_loss:0.09552493691444397
loss_pred:0.043203771114349365, decouple_loss:0.09759492427110672
Iteration: 8, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472448229789734, gen p mean: -0.4629889726638794, mean p set: 0.4477251172065735
The modified gen p mean: 0.4469769299030304, gen p mean: -0.4652913510799408, mean p set: 0.4474572241306305
The modified gen p mean: 0.4466868042945862, gen p mean: -0.4628700613975525, mean p set: 0.4471670687198639
loss_pred:0.045336756855249405, decouple_loss:0.09387621283531189
loss_pred:0.04346853867173195, decouple_loss:0.09418423473834991
loss_pred:0.04280991107225418, decouple_loss:0.09681912511587143
Iteration: 9, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4460671544075012, gen p mean: -0.4666306674480438, mean p set: 0.4465474784374237
The modified gen p mean: 0.44678202271461487, gen p mean: -0.4689319431781769, mean p set: 0.44726231694221497
The modified gen p mean: 0.44681304693222046, gen p mean: -0.46953460574150085, mean p set: 0.44729331135749817
loss_pred:0.042192015796899796, decouple_loss:0.09795466810464859
loss_pred:0.043074753135442734, decouple_loss:0.09642456471920013
loss_pred:0.0432865172624588, decouple_loss:0.09732870012521744
Iteration: 10, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469497799873352, gen p mean: -0.4867878258228302, mean p set: 0.4474301338195801
The modified gen p mean: 0.44671717286109924, gen p mean: -0.48923298716545105, mean p set: 0.44719746708869934
loss_pred:0.04178253188729286, decouple_loss:0.08656764775514603
loss_pred:0.04278356209397316, decouple_loss:0.0859098881483078
The modified gen p mean: 0.4463663399219513, gen p mean: -0.48756641149520874, mean p set: 0.446846604347229
loss_pred:0.04285978153347969, decouple_loss:0.08517922461032867
2023-05-05 14:27:31 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.4930840730667114, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.4907068610191345, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.49281665682792664, mean p set: 0.4500633478164673
loss_pred:0.04285728931427002, decouple_loss:0.07829225808382034
loss_pred:0.04123065620660782, decouple_loss:0.07724156975746155
loss_pred:0.041794318705797195, decouple_loss:0.07673496007919312
WV_0_PC_1_EH_0_PS_40_6, loss: 0.04583190008997917, avg_mse: 0.04722750559449196
current test mse: 0.047228
Iteration: 11, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44759318232536316, gen p mean: -0.49160128831863403, mean p set: 0.44807347655296326
The modified gen p mean: 0.44698435068130493, gen p mean: -0.4937947690486908, mean p set: 0.44746461510658264
loss_pred:0.040288109332323074, decouple_loss:0.07571414858102798
loss_pred:0.03983576223254204, decouple_loss:0.07892084866762161
The modified gen p mean: 0.4461234509944916, gen p mean: -0.49387097358703613, mean p set: 0.4466037154197693
loss_pred:0.04033656418323517, decouple_loss:0.07749380171298981
Iteration: 12, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44712939858436584, gen p mean: -0.5040037035942078, mean p set: 0.44760966300964355
The modified gen p mean: 0.44651535153388977, gen p mean: -0.5020573139190674, mean p set: 0.44699564576148987
The modified gen p mean: 0.4465217888355255, gen p mean: -0.5062492489814758, mean p set: 0.4470020830631256
loss_pred:0.04018969461321831, decouple_loss:0.06751281023025513
loss_pred:0.0408986397087574, decouple_loss:0.06907481700181961
loss_pred:0.037791378796100616, decouple_loss:0.06938795000314713
Iteration: 13, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44705235958099365, gen p mean: -0.5183573961257935, mean p set: 0.44753265380859375
The modified gen p mean: 0.44657984375953674, gen p mean: -0.5174328684806824, mean p set: 0.44706007838249207
loss_pred:0.037993550300598145, decouple_loss:0.061767034232616425
loss_pred:0.03811819851398468, decouple_loss:0.06298382580280304
The modified gen p mean: 0.44610631465911865, gen p mean: -0.521315336227417, mean p set: 0.44658660888671875
loss_pred:0.039488960057497025, decouple_loss:0.062344297766685486
Iteration: 14, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446519672870636, gen p mean: -0.5346583127975464, mean p set: 0.4469999372959137
The modified gen p mean: 0.4468380808830261, gen p mean: -0.538951575756073, mean p set: 0.4473183751106262
The modified gen p mean: 0.44682130217552185, gen p mean: -0.5342893600463867, mean p set: 0.44730156660079956
loss_pred:0.038061436265707016, decouple_loss:0.05711466073989868
loss_pred:0.038233231753110886, decouple_loss:0.05643784627318382
loss_pred:0.03788048028945923, decouple_loss:0.057091642171144485
Iteration: 15, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44632676243782043, gen p mean: -0.5449802875518799, mean p set: 0.44680705666542053
The modified gen p mean: 0.4452042877674103, gen p mean: -0.5418501496315002, mean p set: 0.4456845819950104
The modified gen p mean: 0.4459965229034424, gen p mean: -0.5422955751419067, mean p set: 0.44647684693336487
loss_pred:0.037164755165576935, decouple_loss:0.05264110490679741
loss_pred:0.03777797892689705, decouple_loss:0.052767131477594376
loss_pred:0.03906232491135597, decouple_loss:0.05141829699277878
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 16, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4453771114349365, gen p mean: -0.5483999848365784, mean p set: 0.445857435464859
The modified gen p mean: 0.44794607162475586, gen p mean: -0.5533623099327087, mean p set: 0.44842633605003357
The modified gen p mean: 0.44674137234687805, gen p mean: -0.5495936870574951, mean p set: 0.44722166657447815
loss_pred:0.036616500467061996, decouple_loss:0.05004320666193962loss_pred:0.03746004402637482, decouple_loss:0.04957837983965874
loss_pred:0.036955513060092926, decouple_loss:0.05061369761824608
Iteration: 17, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466697573661804, gen p mean: -0.5518683195114136, mean p set: 0.4471500515937805
The modified gen p mean: 0.44679543375968933, gen p mean: -0.5444144010543823, mean p set: 0.44727569818496704
loss_pred:0.036030467599630356, decouple_loss:0.048424337059259415
loss_pred:0.03579038381576538, decouple_loss:0.04755954444408417
The modified gen p mean: 0.4466235339641571, gen p mean: -0.551159143447876, mean p set: 0.4471038281917572
loss_pred:0.03558490797877312, decouple_loss:0.048534903675317764
Iteration: 18, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44734692573547363, gen p mean: -0.5528643131256104, mean p set: 0.44782721996307373
The modified gen p mean: 0.4463392496109009, gen p mean: -0.5476828813552856, mean p set: 0.446819543838501
The modified gen p mean: 0.4470561742782593, gen p mean: -0.5503507256507874, mean p set: 0.4475364685058594
loss_pred:0.03391246497631073, decouple_loss:0.04704950749874115
loss_pred:0.03640308231115341, decouple_loss:0.04663718119263649
loss_pred:0.03436959162354469, decouple_loss:0.04775851592421532
Iteration: 19, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44740480184555054, gen p mean: -0.5435589551925659, mean p set: 0.44788506627082825
The modified gen p mean: 0.4477007985115051, gen p mean: -0.5495728850364685, mean p set: 0.44818106293678284
The modified gen p mean: 0.4477647840976715, gen p mean: -0.5521526336669922, mean p set: 0.4482450783252716
loss_pred:0.03485717996954918, decouple_loss:0.04303393140435219
loss_pred:0.03432067856192589, decouple_loss:0.044811006635427475
loss_pred:0.03390335291624069, decouple_loss:0.04399580880999565
Iteration: 20, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44605761766433716, gen p mean: -0.5633311867713928, mean p set: 0.44653791189193726
The modified gen p mean: 0.4468703269958496, gen p mean: -0.5599759221076965, mean p set: 0.4473506212234497
The modified gen p mean: 0.4475880563259125, gen p mean: -0.5674641132354736, mean p set: 0.44806838035583496
loss_pred:0.033458221703767776, decouple_loss:0.04358392953872681
loss_pred:0.03423739969730377, decouple_loss:0.042253248393535614
loss_pred:0.032949622720479965, decouple_loss:0.04283593222498894
2023-05-05 14:31:09 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.5727187991142273, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.5677701830863953, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.5698867440223694, mean p set: 0.4500633478164673
loss_pred:0.03571012243628502, decouple_loss:0.043388038873672485
loss_pred:0.0336158312857151, decouple_loss:0.04336050525307655
loss_pred:0.034446898847818375, decouple_loss:0.04248007386922836
WV_0_PC_1_EH_0_PS_40_6, loss: 0.03674476593732834, avg_mse: 0.040042582899332047
current test mse: 0.040043
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012020_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012020_3_24hr.npz
NaN value num: 0
Iteration: 21, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492141306400299, gen p mean: -0.5671396255493164, mean p set: 0.44969442486763
The modified gen p mean: 0.4479087293148041, gen p mean: -0.5687100887298584, mean p set: 0.4483890235424042
loss_pred:0.037543315440416336, decouple_loss:0.04300130531191826
loss_pred:0.03470849618315697, decouple_loss:0.04270865395665169
The modified gen p mean: 0.4487052857875824, gen p mean: -0.5719772577285767, mean p set: 0.4491855800151825
loss_pred:0.03454659506678581, decouple_loss:0.042971961200237274
Iteration: 22, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44969406723976135, gen p mean: -0.5503559112548828, mean p set: 0.45017439126968384
The modified gen p mean: 0.449593186378479, gen p mean: -0.5636616349220276, mean p set: 0.4500735104084015
The modified gen p mean: 0.4492981731891632, gen p mean: -0.5469464659690857, mean p set: 0.4497784972190857
loss_pred:0.03409001603722572, decouple_loss:0.04323164373636246
loss_pred:0.03619778901338577, decouple_loss:0.040799640119075775
loss_pred:0.03834691271185875, decouple_loss:0.04078587144613266
Iteration: 23, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44845089316368103, gen p mean: -0.5711314082145691, mean p set: 0.4489312171936035The modified gen p mean: 0.45037803053855896, gen p mean: -0.5703800320625305, mean p set: 0.45085832476615906
loss_pred:0.035215988755226135, decouple_loss:0.040974125266075134
loss_pred:0.034672949463129044, decouple_loss:0.03973120078444481
The modified gen p mean: 0.44872575998306274, gen p mean: -0.5778554081916809, mean p set: 0.44920605421066284
loss_pred:0.03420218452811241, decouple_loss:0.04104893282055855
Iteration: 24, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494662880897522, gen p mean: -0.5785493850708008, mean p set: 0.4499465525150299
The modified gen p mean: 0.4486444890499115, gen p mean: -0.5866173505783081, mean p set: 0.4491247832775116
The modified gen p mean: 0.44919368624687195, gen p mean: -0.5787078738212585, mean p set: 0.44967401027679443
loss_pred:0.03355187177658081, decouple_loss:0.03857247158885002
loss_pred:0.03348380699753761, decouple_loss:0.04024547338485718
loss_pred:0.03471396863460541, decouple_loss:0.039573270827531815
Iteration: 25, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494567811489105, gen p mean: -0.5792593955993652, mean p set: 0.4499370753765106
The modified gen p mean: 0.44895660877227783, gen p mean: -0.5785044431686401, mean p set: 0.44943687319755554
loss_pred:0.03386898338794708, decouple_loss:0.03617387264966965
loss_pred:0.033690132200717926, decouple_loss:0.03700583428144455
The modified gen p mean: 0.4496626853942871, gen p mean: -0.5820538997650146, mean p set: 0.4501429796218872
loss_pred:0.03299330174922943, decouple_loss:0.03667864575982094
Iteration: 26, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44881120324134827, gen p mean: -0.5738301873207092, mean p set: 0.44929149746894836
The modified gen p mean: 0.4486953020095825, gen p mean: -0.581669270992279, mean p set: 0.449175626039505
The modified gen p mean: 0.4502822160720825, gen p mean: -0.5771057605743408, mean p set: 0.4507625102996826
loss_pred:0.032887376844882965, decouple_loss:0.03588399291038513
loss_pred:0.03500404953956604, decouple_loss:0.03556908294558525
loss_pred:0.03425261005759239, decouple_loss:0.03652624785900116
Iteration: 27, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44825479388237, gen p mean: -0.5912318229675293, mean p set: 0.4487350583076477
The modified gen p mean: 0.4499053955078125, gen p mean: -0.5956497192382812, mean p set: 0.450385719537735
The modified gen p mean: 0.4495718479156494, gen p mean: -0.5867295265197754, mean p set: 0.4500521421432495
loss_pred:0.03255528584122658, decouple_loss:0.033691562712192535
loss_pred:0.03325582295656204, decouple_loss:0.03503560647368431
loss_pred:0.031812380999326706, decouple_loss:0.033771857619285583
Iteration: 28, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44877201318740845, gen p mean: -0.5917640924453735, mean p set: 0.44925227761268616
The modified gen p mean: 0.44963371753692627, gen p mean: -0.5944311618804932, mean p set: 0.450113981962204
The modified gen p mean: 0.4497492015361786, gen p mean: -0.5912863612174988, mean p set: 0.4502294957637787
loss_pred:0.03283381462097168, decouple_loss:0.03254886344075203
loss_pred:0.03354655206203461, decouple_loss:0.03428301587700844
loss_pred:0.03378443419933319, decouple_loss:0.03324473276734352
Iteration: 29, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44972893595695496, gen p mean: -0.5881878137588501, mean p set: 0.45020923018455505
The modified gen p mean: 0.44827064871788025, gen p mean: -0.5873770117759705, mean p set: 0.44875091314315796
The modified gen p mean: 0.4501723051071167, gen p mean: -0.5869515538215637, mean p set: 0.4506526291370392
loss_pred:0.033299438655376434, decouple_loss:0.03113837167620659
loss_pred:0.033098362386226654, decouple_loss:0.03263078257441521
loss_pred:0.033744119107723236, decouple_loss:0.03248663619160652
Iteration: 30, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489961862564087, gen p mean: -0.5946267247200012, mean p set: 0.4494764804840088
The modified gen p mean: 0.4497010111808777, gen p mean: -0.6038249731063843, mean p set: 0.4501812756061554
The modified gen p mean: 0.44922593235969543, gen p mean: -0.5979240536689758, mean p set: 0.4497062563896179
loss_pred:0.03204147145152092, decouple_loss:0.03308408707380295
loss_pred:0.0330660380423069, decouple_loss:0.03433847054839134
loss_pred:0.03181295096874237, decouple_loss:0.03203601762652397
2023-05-05 14:35:36 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.6106078028678894, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.6035612225532532, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.6057046055793762, mean p set: 0.4500633478164673
loss_pred:0.033404961228370667, decouple_loss:0.03435974195599556
loss_pred:0.03166363015770912, decouple_loss:0.03381066024303436
loss_pred:0.032129958271980286, decouple_loss:0.03342466056346893
WV_0_PC_1_EH_0_PS_40_6, loss: 0.03409276902675629, avg_mse: 0.03819362819194794
current test mse: 0.038194
Iteration: 31, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44854292273521423, gen p mean: -0.6069417595863342, mean p set: 0.44902318716049194
The modified gen p mean: 0.44935736060142517, gen p mean: -0.5992001891136169, mean p set: 0.44983765482902527
loss_pred:0.032235875725746155, decouple_loss:0.03434883430600166
loss_pred:0.03134865313768387, decouple_loss:0.03215746954083443
The modified gen p mean: 0.4497392773628235, gen p mean: -0.6030780076980591, mean p set: 0.4502195417881012
loss_pred:0.03352760896086693, decouple_loss:0.032015807926654816
Iteration: 32, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44947925209999084, gen p mean: -0.5970045328140259, mean p set: 0.44995957612991333
The modified gen p mean: 0.44961872696876526, gen p mean: -0.5993714332580566, mean p set: 0.45009905099868774
The modified gen p mean: 0.4492073953151703, gen p mean: -0.5935784578323364, mean p set: 0.4496876895427704
loss_pred:0.032029204070568085, decouple_loss:0.03103473223745823
loss_pred:0.032145753502845764, decouple_loss:0.029833471402525902
loss_pred:0.03231621906161308, decouple_loss:0.02976374886929989
Iteration: 33, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481431245803833, gen p mean: -0.5801246762275696, mean p set: 0.4486234188079834
The modified gen p mean: 0.4490707218647003, gen p mean: -0.5786857604980469, mean p set: 0.4495510160923004
The modified gen p mean: 0.44819748401641846, gen p mean: -0.5847856998443604, mean p set: 0.44867777824401855
loss_pred:0.03401944041252136, decouple_loss:0.03052169643342495
loss_pred:0.03221931308507919, decouple_loss:0.031137164682149887
loss_pred:0.03196755796670914, decouple_loss:0.03183582052588463
Iteration: 34, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448944091796875, gen p mean: -0.6017858982086182, mean p set: 0.4494244158267975
The modified gen p mean: 0.4484911859035492, gen p mean: -0.6036953926086426, mean p set: 0.44897153973579407
The modified gen p mean: 0.4485275149345398, gen p mean: -0.6041733622550964, mean p set: 0.4490078091621399
loss_pred:0.030335839837789536, decouple_loss:0.02749529294669628
loss_pred:0.03111833520233631, decouple_loss:0.027262277901172638
loss_pred:0.031154457479715347, decouple_loss:0.0273401141166687
Iteration: 35, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498935341835022, gen p mean: -0.6168149709701538, mean p set: 0.4503738284111023
The modified gen p mean: 0.44995805621147156, gen p mean: -0.6233325600624084, mean p set: 0.45043838024139404
The modified gen p mean: 0.44985097646713257, gen p mean: -0.6250253915786743, mean p set: 0.45033130049705505
loss_pred:0.031248686835169792, decouple_loss:0.027762209996581078
loss_pred:0.03161242604255676, decouple_loss:0.028157228603959084
loss_pred:0.031765416264534, decouple_loss:0.02903660573065281
Iteration: 36, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44877660274505615, gen p mean: -0.6075190901756287, mean p set: 0.44925686717033386
The modified gen p mean: 0.4497183859348297, gen p mean: -0.6084556579589844, mean p set: 0.4501986801624298
The modified gen p mean: 0.44904962182044983, gen p mean: -0.6162000298500061, mean p set: 0.4495299160480499
loss_pred:0.03158885985612869, decouple_loss:0.027398865669965744
loss_pred:0.03112747147679329, decouple_loss:0.027841996401548386
loss_pred:0.03118292987346649, decouple_loss:0.029377449303865433
Iteration: 37, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489401578903198, gen p mean: -0.5884386897087097, mean p set: 0.4494204819202423
The modified gen p mean: 0.45013242959976196, gen p mean: -0.592715322971344, mean p set: 0.45061272382736206
The modified gen p mean: 0.4486680030822754, gen p mean: -0.5983540415763855, mean p set: 0.4491483271121979
loss_pred:0.03262990713119507, decouple_loss:0.027867209166288376
loss_pred:0.03246138617396355, decouple_loss:0.029058847576379776
loss_pred:0.03138764575123787, decouple_loss:0.028515543788671494
Iteration: 38, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44948074221611023, gen p mean: -0.6182942986488342, mean p set: 0.4499610364437103
The modified gen p mean: 0.4497185945510864, gen p mean: -0.6165363192558289, mean p set: 0.45019885897636414
The modified gen p mean: 0.4496510326862335, gen p mean: -0.6195493340492249, mean p set: 0.4501313269138336
loss_pred:0.03125077113509178, decouple_loss:0.026210321113467216
loss_pred:0.0321127213537693, decouple_loss:0.028293009847402573
loss_pred:0.03089548647403717, decouple_loss:0.02678809128701687
Iteration: 39, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44917985796928406, gen p mean: -0.6117520928382874, mean p set: 0.44966015219688416
The modified gen p mean: 0.44987934827804565, gen p mean: -0.61087965965271, mean p set: 0.45035961270332336
The modified gen p mean: 0.4499937891960144, gen p mean: -0.6107785105705261, mean p set: 0.4504740536212921
loss_pred:0.03069748915731907, decouple_loss:0.02665616199374199
loss_pred:0.03274752199649811, decouple_loss:0.025186151266098022
loss_pred:0.03094378672540188, decouple_loss:0.025424569845199585
Iteration: 40, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44816696643829346, gen p mean: -0.6201885342597961, mean p set: 0.44864723086357117
The modified gen p mean: 0.4488782286643982, gen p mean: -0.6120270490646362, mean p set: 0.4493584930896759
loss_pred:0.03127071633934975, decouple_loss:0.026149742305278778
loss_pred:0.03235156461596489, decouple_loss:0.024891026318073273
The modified gen p mean: 0.44877374172210693, gen p mean: -0.6136671900749207, mean p set: 0.44925400614738464
loss_pred:0.03008079342544079, decouple_loss:0.025364598259329796
2023-05-05 14:39:14 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.6344082951545715, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.6260967254638672, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.6290856003761292, mean p set: 0.4500633478164673
loss_pred:0.03134424611926079, decouple_loss:0.027769334614276886
loss_pred:0.029765520244836807, decouple_loss:0.02708383835852146
loss_pred:0.030294043943285942, decouple_loss:0.026868119835853577
WV_0_PC_1_EH_0_PS_40_6, loss: 0.03182996064424515, avg_mse: 0.03653600066900253
current test mse: 0.036536
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012006_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012006_3_24hr.npz
NaN value num: 0
Iteration: 41, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45167723298072815, gen p mean: -0.6369845271110535, mean p set: 0.45215752720832825
The modified gen p mean: 0.45258432626724243, gen p mean: -0.6414182782173157, mean p set: 0.45306456089019775
loss_pred:0.030586013570427895, decouple_loss:0.028014766052365303
loss_pred:0.030688172206282616, decouple_loss:0.028918035328388214
The modified gen p mean: 0.4493550658226013, gen p mean: -0.6313382387161255, mean p set: 0.4498353600502014
loss_pred:0.030497798696160316, decouple_loss:0.027217669412493706
Iteration: 42, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45311006903648376, gen p mean: -0.6190378665924072, mean p set: 0.45359036326408386
The modified gen p mean: 0.451680064201355, gen p mean: -0.6212405562400818, mean p set: 0.4521603584289551
loss_pred:0.030461065471172333, decouple_loss:0.02615806832909584
loss_pred:0.02981783263385296, decouple_loss:0.026101194322109222
The modified gen p mean: 0.4508713483810425, gen p mean: -0.6143196225166321, mean p set: 0.4513516426086426
loss_pred:0.029093878343701363, decouple_loss:0.024867143481969833
Iteration: 43, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45100733637809753, gen p mean: -0.6182079315185547, mean p set: 0.45148760080337524
The modified gen p mean: 0.45203450322151184, gen p mean: -0.6183920502662659, mean p set: 0.45251479744911194
The modified gen p mean: 0.45025017857551575, gen p mean: -0.6104390025138855, mean p set: 0.45073044300079346
loss_pred:0.029677432030439377, decouple_loss:0.02494247630238533
loss_pred:0.02977880835533142, decouple_loss:0.02488890290260315
loss_pred:0.029863616451621056, decouple_loss:0.023995982483029366
Iteration: 44, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45346465706825256, gen p mean: -0.6218737363815308, mean p set: 0.4539449214935303
The modified gen p mean: 0.4529622495174408, gen p mean: -0.6225382685661316, mean p set: 0.4534425735473633
loss_pred:0.029300056397914886, decouple_loss:0.024801431223750114
loss_pred:0.029792990535497665, decouple_loss:0.0245146993547678
The modified gen p mean: 0.4513205289840698, gen p mean: -0.6233157515525818, mean p set: 0.4518008232116699
loss_pred:0.028875598683953285, decouple_loss:0.023580355569720268
Iteration: 45, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4547361135482788, gen p mean: -0.6312547326087952, mean p set: 0.4552163779735565
The modified gen p mean: 0.45154979825019836, gen p mean: -0.6336822509765625, mean p set: 0.45203009247779846
The modified gen p mean: 0.45141032338142395, gen p mean: -0.6308394074440002, mean p set: 0.45189061760902405
loss_pred:0.028122497722506523, decouple_loss:0.023557011038064957loss_pred:0.029680831357836723, decouple_loss:0.024472573772072792
loss_pred:0.02896411530673504, decouple_loss:0.024980301037430763
Iteration: 46, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4527053236961365, gen p mean: -0.6294670104980469, mean p set: 0.4531856179237366
The modified gen p mean: 0.45203670859336853, gen p mean: -0.6254412531852722, mean p set: 0.452517032623291
The modified gen p mean: 0.45163533091545105, gen p mean: -0.6270294189453125, mean p set: 0.45211559534072876
loss_pred:0.028264453634619713, decouple_loss:0.024644043296575546
loss_pred:0.028598634526133537, decouple_loss:0.024863505735993385
loss_pred:0.029007798060774803, decouple_loss:0.023228369653224945
Iteration: 47, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4524964988231659, gen p mean: -0.633563756942749, mean p set: 0.452976793050766
The modified gen p mean: 0.45221641659736633, gen p mean: -0.6357327699661255, mean p set: 0.45269668102264404
The modified gen p mean: 0.45286643505096436, gen p mean: -0.6398934721946716, mean p set: 0.45334672927856445
loss_pred:0.029103105887770653, decouple_loss:0.022852716967463493
loss_pred:0.028841177001595497, decouple_loss:0.023736484348773956
loss_pred:0.029241465032100677, decouple_loss:0.02245131880044937
Iteration: 48, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45077621936798096, gen p mean: -0.6469919085502625, mean p set: 0.45125651359558105
The modified gen p mean: 0.4525904655456543, gen p mean: -0.6557614803314209, mean p set: 0.453070729970932
The modified gen p mean: 0.4509826600551605, gen p mean: -0.6554945707321167, mean p set: 0.4514629542827606
loss_pred:0.027749519795179367, decouple_loss:0.022417031228542328
loss_pred:0.02790094166994095, decouple_loss:0.023552317172288895
loss_pred:0.028491878882050514, decouple_loss:0.022884059697389603
Iteration: 49, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45129314064979553, gen p mean: -0.6675058007240295, mean p set: 0.451773464679718
The modified gen p mean: 0.4500975012779236, gen p mean: -0.6538183093070984, mean p set: 0.4505777657032013
The modified gen p mean: 0.45283243060112, gen p mean: -0.6592873930931091, mean p set: 0.4533127248287201
loss_pred:0.029104221612215042, decouple_loss:0.023444920778274536
loss_pred:0.0287606380879879, decouple_loss:0.0229677502065897
loss_pred:0.028536483645439148, decouple_loss:0.024414751678705215
Iteration: 50, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4509139657020569, gen p mean: -0.6461824774742126, mean p set: 0.451394259929657
The modified gen p mean: 0.45029473304748535, gen p mean: -0.6471014022827148, mean p set: 0.45077502727508545
The modified gen p mean: 0.4507061243057251, gen p mean: -0.6481779217720032, mean p set: 0.4511864483356476
loss_pred:0.028786364942789078, decouple_loss:0.022601621225476265
loss_pred:0.029404619708657265, decouple_loss:0.0219052042812109
loss_pred:0.029161550104618073, decouple_loss:0.021854765713214874
2023-05-05 14:43:41 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.6470218896865845, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.636901319026947, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830237865448, gen p mean: -0.6404553651809692, mean p set: 0.4500633478164673
loss_pred:0.03061223402619362, decouple_loss:0.025337260216474533
loss_pred:0.029012031853199005, decouple_loss:0.025302883237600327
loss_pred:0.029513070359826088, decouple_loss:0.02484213560819626
WV_0_PC_1_EH_0_PS_40_6, loss: 0.030970484018325806, avg_mse: 0.03596387431025505
current test mse: 0.035964
Iteration: 51, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45179104804992676, gen p mean: -0.6410837173461914, mean p set: 0.45227131247520447
loss_pred:0.028213003650307655, decouple_loss:0.02316255308687687
The modified gen p mean: 0.4530084431171417, gen p mean: -0.6455730199813843, mean p set: 0.45348870754241943
loss_pred:0.028435103595256805, decouple_loss:0.02281968668103218
The modified gen p mean: 0.45238539576530457, gen p mean: -0.6494510173797607, mean p set: 0.4528656601905823
loss_pred:0.0290062315762043, decouple_loss:0.02405625768005848
Iteration: 52, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44968923926353455, gen p mean: -0.6583569049835205, mean p set: 0.45016953349113464
The modified gen p mean: 0.44957488775253296, gen p mean: -0.6553611755371094, mean p set: 0.45005518198013306
The modified gen p mean: 0.45132339000701904, gen p mean: -0.6566618084907532, mean p set: 0.45180368423461914
loss_pred:0.02802504040300846, decouple_loss:0.021263886243104935
loss_pred:0.02854500152170658, decouple_loss:0.021785316988825798
loss_pred:0.027541043236851692, decouple_loss:0.021175600588321686
Iteration: 53, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45246604084968567, gen p mean: -0.6729491949081421, mean p set: 0.45294633507728577
The modified gen p mean: 0.45109182596206665, gen p mean: -0.6739016175270081, mean p set: 0.45157214999198914
The modified gen p mean: 0.45280522108078003, gen p mean: -0.6787775754928589, mean p set: 0.45328548550605774
loss_pred:0.028260203078389168, decouple_loss:0.021544553339481354
loss_pred:0.028950467705726624, decouple_loss:0.021101728081703186
loss_pred:0.027939777821302414, decouple_loss:0.020430101081728935
Iteration: 54, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45303037762641907, gen p mean: -0.6839757561683655, mean p set: 0.45351067185401917
The modified gen p mean: 0.45382753014564514, gen p mean: -0.6812991499900818, mean p set: 0.4543078541755676
The modified gen p mean: 0.4523267447948456, gen p mean: -0.6812027096748352, mean p set: 0.4528070092201233
loss_pred:0.028755027800798416, decouple_loss:0.02312116138637066
loss_pred:0.028513997793197632, decouple_loss:0.022069105878472328
loss_pred:0.02820548228919506, decouple_loss:0.02112853154540062
Iteration: 55, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45566442608833313, gen p mean: -0.646609365940094, mean p set: 0.45614469051361084
The modified gen p mean: 0.45390570163726807, gen p mean: -0.6479644179344177, mean p set: 0.4543859660625458
The modified gen p mean: 0.4530589282512665, gen p mean: -0.6500567197799683, mean p set: 0.45353925228118896
loss_pred:0.028781967237591743, decouple_loss:0.022329555824398994
loss_pred:0.02881786599755287, decouple_loss:0.021605273708701134
loss_pred:0.02867969125509262, decouple_loss:0.02259780280292034
Iteration: 56, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508593678474426, gen p mean: -0.6435731649398804, mean p set: 0.45133963227272034
The modified gen p mean: 0.45142704248428345, gen p mean: -0.6393057703971863, mean p set: 0.45190730690956116
The modified gen p mean: 0.451323926448822, gen p mean: -0.6428177952766418, mean p set: 0.4518042206764221
loss_pred:0.028684761375188828, decouple_loss:0.0208938866853714
loss_pred:0.028588885441422462, decouple_loss:0.02117844671010971
loss_pred:0.027729451656341553, decouple_loss:0.021298790350556374
Iteration: 57, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4521520137786865, gen p mean: -0.6551910638809204, mean p set: 0.4526323080062866
The modified gen p mean: 0.4518226385116577, gen p mean: -0.6566944122314453, mean p set: 0.4523029327392578
The modified gen p mean: 0.4524695575237274, gen p mean: -0.6598222255706787, mean p set: 0.4529498815536499
loss_pred:0.028524260967969894, decouple_loss:0.022407565265893936
loss_pred:0.02845747023820877, decouple_loss:0.02128760889172554
loss_pred:0.02756056934595108, decouple_loss:0.021337546408176422
Iteration: 58, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4521898925304413, gen p mean: -0.6716468334197998, mean p set: 0.45267021656036377
The modified gen p mean: 0.4524969458580017, gen p mean: -0.6745832562446594, mean p set: 0.4529772400856018
loss_pred:0.028415920212864876, decouple_loss:0.02302081510424614
The modified gen p mean: 0.4523903429508209, gen p mean: -0.6717004179954529, mean p set: 0.452870637178421
loss_pred:0.02799844928085804, decouple_loss:0.023128671571612358
loss_pred:0.028858011588454247, decouple_loss:0.0220168586820364
Iteration: 59, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4548882842063904, gen p mean: -0.6780797243118286, mean p set: 0.45536860823631287
The modified gen p mean: 0.452595055103302, gen p mean: -0.6781171560287476, mean p set: 0.4530753493309021
The modified gen p mean: 0.4525321424007416, gen p mean: -0.6826647520065308, mean p set: 0.4530124366283417
loss_pred:0.028155190870165825, decouple_loss:0.02040841057896614loss_pred:0.02775377221405506, decouple_loss:0.01981157250702381
loss_pred:0.02821160852909088, decouple_loss:0.02119898982346058
Iteration: 60, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45037293434143066, gen p mean: -0.6704890727996826, mean p set: 0.45085322856903076
The modified gen p mean: 0.45206886529922485, gen p mean: -0.6720731258392334, mean p set: 0.45254912972450256
The modified gen p mean: 0.4527682662010193, gen p mean: -0.6720832586288452, mean p set: 0.4532485604286194
loss_pred:0.029079755768179893, decouple_loss:0.02025965414941311
loss_pred:0.027501970529556274, decouple_loss:0.01934773102402687
loss_pred:0.02852814644575119, decouple_loss:0.020167343318462372
2023-05-05 14:47:18 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.6686793565750122, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.6568207144737244, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.6610578894615173, mean p set: 0.4500633478164673
loss_pred:0.03044326789677143, decouple_loss:0.022786276414990425
loss_pred:0.028755784034729004, decouple_loss:0.022744331508874893
loss_pred:0.02912311628460884, decouple_loss:0.022420933470129967
WV_0_PC_1_EH_0_PS_40_6, loss: 0.030573248863220215, avg_mse: 0.03584767505526543
current test mse: 0.035848
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012009_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012009_3_24hr.npz
NaN value num: 0
Iteration: 61, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44623613357543945, gen p mean: -0.6551772356033325, mean p set: 0.44671642780303955
The modified gen p mean: 0.44697925448417664, gen p mean: -0.6667472720146179, mean p set: 0.44745954871177673
loss_pred:0.02991294302046299, decouple_loss:0.022507192566990852
loss_pred:0.02928212843835354, decouple_loss:0.022493870928883553
The modified gen p mean: 0.4472886323928833, gen p mean: -0.6655706763267517, mean p set: 0.4477689266204834
loss_pred:0.02992553636431694, decouple_loss:0.022061925381422043
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 62, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44784677028656006, gen p mean: -0.6675887703895569, mean p set: 0.44832706451416016
The modified gen p mean: 0.44861432909965515, gen p mean: -0.6565770506858826, mean p set: 0.44909462332725525
The modified gen p mean: 0.44753408432006836, gen p mean: -0.6543213725090027, mean p set: 0.44801437854766846
loss_pred:0.028574002906680107, decouple_loss:0.022133152931928635
loss_pred:0.029060736298561096, decouple_loss:0.02211836166679859
loss_pred:0.029052184894680977, decouple_loss:0.021753938868641853
Iteration: 63, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44821038842201233, gen p mean: -0.6777875423431396, mean p set: 0.44869065284729004
The modified gen p mean: 0.4493890404701233, gen p mean: -0.6745312809944153, mean p set: 0.449869304895401
loss_pred:0.028371751308441162, decouple_loss:0.020819691941142082
loss_pred:0.03012564405798912, decouple_loss:0.019956625998020172
The modified gen p mean: 0.44736161828041077, gen p mean: -0.6783846020698547, mean p set: 0.44784191250801086
loss_pred:0.02907409518957138, decouple_loss:0.02110869809985161
Iteration: 64, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470822811126709, gen p mean: -0.6959944367408752, mean p set: 0.447562575340271
The modified gen p mean: 0.4469814896583557, gen p mean: -0.6980454921722412, mean p set: 0.4474617540836334
The modified gen p mean: 0.44713956117630005, gen p mean: -0.6823758482933044, mean p set: 0.44761988520622253
loss_pred:0.028628015890717506, decouple_loss:0.021303566172719002
loss_pred:0.028420139104127884, decouple_loss:0.021510403603315353
loss_pred:0.02908382937312126, decouple_loss:0.020598193630576134
Iteration: 65, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471273422241211, gen p mean: -0.7019748687744141, mean p set: 0.4476076066493988
The modified gen p mean: 0.44727861881256104, gen p mean: -0.7147249579429626, mean p set: 0.44775891304016113
The modified gen p mean: 0.44852012395858765, gen p mean: -0.7039422392845154, mean p set: 0.44900041818618774
loss_pred:0.02856895886361599, decouple_loss:0.02254621684551239
loss_pred:0.0288358423858881, decouple_loss:0.023577703163027763
loss_pred:0.028079751878976822, decouple_loss:0.022402307018637657
Iteration: 66, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44558775424957275, gen p mean: -0.6841748356819153, mean p set: 0.44606801867485046
The modified gen p mean: 0.4494333267211914, gen p mean: -0.6891996264457703, mean p set: 0.4499136209487915
The modified gen p mean: 0.4476143717765808, gen p mean: -0.6949750185012817, mean p set: 0.4480946362018585
loss_pred:0.02922319434583187, decouple_loss:0.020809976384043694
loss_pred:0.02886839583516121, decouple_loss:0.021592913195490837
loss_pred:0.028312627226114273, decouple_loss:0.02037319913506508
Iteration: 67, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478420615196228, gen p mean: -0.6836270689964294, mean p set: 0.4483223557472229
The modified gen p mean: 0.44778165221214294, gen p mean: -0.6797530055046082, mean p set: 0.44826194643974304
The modified gen p mean: 0.4468348026275635, gen p mean: -0.6920144557952881, mean p set: 0.4473150670528412
loss_pred:0.027843520045280457, decouple_loss:0.020745931193232536
loss_pred:0.029116451740264893, decouple_loss:0.020608264952898026
loss_pred:0.028258977457880974, decouple_loss:0.02148202806711197
Iteration: 68, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44930770993232727, gen p mean: -0.6821695566177368, mean p set: 0.449787974357605
The modified gen p mean: 0.4478175640106201, gen p mean: -0.6916128993034363, mean p set: 0.4482978880405426
loss_pred:0.028635120019316673, decouple_loss:0.02201857417821884
loss_pred:0.028437351807951927, decouple_loss:0.021871032193303108
The modified gen p mean: 0.44732388854026794, gen p mean: -0.6808651685714722, mean p set: 0.44780421257019043
loss_pred:0.02844380959868431, decouple_loss:0.021422281861305237
Iteration: 69, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483109414577484, gen p mean: -0.6796936988830566, mean p set: 0.4487912356853485
The modified gen p mean: 0.4483659267425537, gen p mean: -0.6847507953643799, mean p set: 0.4488462209701538
The modified gen p mean: 0.44679686427116394, gen p mean: -0.682723879814148, mean p set: 0.44727712869644165
loss_pred:0.027989841997623444, decouple_loss:0.020462695509195328loss_pred:0.0292651429772377, decouple_loss:0.020348679274320602
loss_pred:0.02809104137122631, decouple_loss:0.020033420994877815
Iteration: 70, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4461551308631897, gen p mean: -0.6817917823791504, mean p set: 0.4466353952884674
The modified gen p mean: 0.44909846782684326, gen p mean: -0.6860690712928772, mean p set: 0.44957879185676575
The modified gen p mean: 0.4487951993942261, gen p mean: -0.6757147908210754, mean p set: 0.4492754638195038
loss_pred:0.02826954424381256, decouple_loss:0.0203059371560812
loss_pred:0.02772601693868637, decouple_loss:0.020019615069031715
loss_pred:0.02845282293856144, decouple_loss:0.019476214423775673
2023-05-05 14:51:48 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.6832823157310486, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.6704079508781433, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.6747028231620789, mean p set: 0.4500633478164673
loss_pred:0.029219653457403183, decouple_loss:0.01984150893986225
loss_pred:0.027749719098210335, decouple_loss:0.02006242796778679
loss_pred:0.02820144221186638, decouple_loss:0.019344700500369072
WV_0_PC_1_EH_0_PS_40_6, loss: 0.02937774918973446, avg_mse: 0.03413742780685425
current test mse: 0.034137
Iteration: 71, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44719719886779785, gen p mean: -0.6756466031074524, mean p set: 0.44767752289772034
The modified gen p mean: 0.44741398096084595, gen p mean: -0.6808269619941711, mean p set: 0.44789430499076843
loss_pred:0.02776196412742138, decouple_loss:0.01904744654893875
loss_pred:0.02812410518527031, decouple_loss:0.018740534782409668
The modified gen p mean: 0.4461553990840912, gen p mean: -0.6841157078742981, mean p set: 0.4466356933116913
loss_pred:0.028271537274122238, decouple_loss:0.018815260380506516
Iteration: 72, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44608765840530396, gen p mean: -0.6759008765220642, mean p set: 0.44656795263290405
The modified gen p mean: 0.44692885875701904, gen p mean: -0.6778967380523682, mean p set: 0.44740915298461914
The modified gen p mean: 0.4454862177371979, gen p mean: -0.6744661927223206, mean p set: 0.445966511964798
loss_pred:0.02819249965250492, decouple_loss:0.01885831728577614
loss_pred:0.02798588201403618, decouple_loss:0.01832706667482853
loss_pred:0.028504643589258194, decouple_loss:0.018784765154123306
Iteration: 73, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476727247238159, gen p mean: -0.6726881861686707, mean p set: 0.4481530487537384
The modified gen p mean: 0.4472768306732178, gen p mean: -0.6776275634765625, mean p set: 0.44775715470314026
loss_pred:0.027459843084216118, decouple_loss:0.01887902244925499
loss_pred:0.02796391397714615, decouple_loss:0.01891179010272026
The modified gen p mean: 0.44773581624031067, gen p mean: -0.6792855262756348, mean p set: 0.44821611046791077
loss_pred:0.027914661914110184, decouple_loss:0.01914079673588276
Iteration: 74, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483204483985901, gen p mean: -0.6680532693862915, mean p set: 0.4488007128238678
The modified gen p mean: 0.44803327322006226, gen p mean: -0.6631594300270081, mean p set: 0.44851356744766235
loss_pred:0.028287172317504883, decouple_loss:0.018083352595567703
loss_pred:0.02872375026345253, decouple_loss:0.018153460696339607
The modified gen p mean: 0.44760459661483765, gen p mean: -0.6748197078704834, mean p set: 0.44808489084243774
loss_pred:0.02744605951011181, decouple_loss:0.01841045543551445
Iteration: 75, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44982993602752686, gen p mean: -0.6740742921829224, mean p set: 0.45031026005744934
The modified gen p mean: 0.448513925075531, gen p mean: -0.6754958629608154, mean p set: 0.4489942789077759
loss_pred:0.028329329565167427, decouple_loss:0.018727511167526245
loss_pred:0.028494317084550858, decouple_loss:0.01802314631640911
The modified gen p mean: 0.4487041234970093, gen p mean: -0.6772872805595398, mean p set: 0.449184387922287
loss_pred:0.027878716588020325, decouple_loss:0.01932099089026451
Iteration: 76, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44779470562934875, gen p mean: -0.6782159209251404, mean p set: 0.44827497005462646
The modified gen p mean: 0.4476069211959839, gen p mean: -0.6851515769958496, mean p set: 0.448087215423584
The modified gen p mean: 0.4471665322780609, gen p mean: -0.6875286102294922, mean p set: 0.447646826505661
loss_pred:0.027654195204377174, decouple_loss:0.0177812110632658loss_pred:0.02757130190730095, decouple_loss:0.018469057977199554
loss_pred:0.02790084294974804, decouple_loss:0.019088048487901688
Iteration: 77, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44854751229286194, gen p mean: -0.6701890230178833, mean p set: 0.44902777671813965
The modified gen p mean: 0.44680824875831604, gen p mean: -0.6880350708961487, mean p set: 0.4472885727882385
The modified gen p mean: 0.44661808013916016, gen p mean: -0.6801905035972595, mean p set: 0.44709834456443787
loss_pred:0.028194541111588478, decouple_loss:0.0175740048289299
loss_pred:0.028331756591796875, decouple_loss:0.018481003120541573
loss_pred:0.02774938754737377, decouple_loss:0.01758630760014057
Iteration: 78, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44688740372657776, gen p mean: -0.6753930449485779, mean p set: 0.44736772775650024
The modified gen p mean: 0.4464246928691864, gen p mean: -0.681377649307251, mean p set: 0.4469049572944641
The modified gen p mean: 0.4473932683467865, gen p mean: -0.6870647668838501, mean p set: 0.4478735327720642
loss_pred:0.027913905680179596, decouple_loss:0.016882216557860374
loss_pred:0.027701104059815407, decouple_loss:0.01700604520738125
loss_pred:0.02752574533224106, decouple_loss:0.01638365350663662
Iteration: 79, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475298225879669, gen p mean: -0.6841732263565063, mean p set: 0.44801008701324463
The modified gen p mean: 0.4480317533016205, gen p mean: -0.6799086332321167, mean p set: 0.4485120475292206
The modified gen p mean: 0.44614720344543457, gen p mean: -0.6794953346252441, mean p set: 0.4466274678707123
loss_pred:0.02892964519560337, decouple_loss:0.016365230083465576
loss_pred:0.027228407561779022, decouple_loss:0.016804354265332222
loss_pred:0.0281706303358078, decouple_loss:0.01694728247821331
Iteration: 80, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474327862262726, gen p mean: -0.6770352125167847, mean p set: 0.4479130506515503
The modified gen p mean: 0.4483940899372101, gen p mean: -0.6772817969322205, mean p set: 0.44887441396713257
The modified gen p mean: 0.4480183720588684, gen p mean: -0.6823570132255554, mean p set: 0.4484986364841461
loss_pred:0.02782459184527397, decouple_loss:0.016581490635871887
loss_pred:0.028380611911416054, decouple_loss:0.01629098877310753
loss_pred:0.027475086972117424, decouple_loss:0.016727264970541
2023-05-05 14:55:28 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.6908348202705383, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.6785293221473694, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.6828333139419556, mean p set: 0.4500633478164673
loss_pred:0.028673525899648666, decouple_loss:0.016460878774523735
loss_pred:0.027257952839136124, decouple_loss:0.01658458448946476
loss_pred:0.027624551206827164, decouple_loss:0.016292434185743332
WV_0_PC_1_EH_0_PS_40_6, loss: 0.028674308210611343, avg_mse: 0.03353814408183098
current test mse: 0.033538
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012012_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012012_3_24hr.npz
NaN value num: 0
Iteration: 81, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472615420818329, gen p mean: -0.6915169954299927, mean p set: 0.447741836309433
The modified gen p mean: 0.4471440017223358, gen p mean: -0.6825577616691589, mean p set: 0.4476243257522583
loss_pred:0.028616689145565033, decouple_loss:0.016797123476862907
loss_pred:0.028784524649381638, decouple_loss:0.016790831461548805
The modified gen p mean: 0.44672471284866333, gen p mean: -0.6890233159065247, mean p set: 0.4472050368785858
loss_pred:0.028756970539689064, decouple_loss:0.01661238819360733
Iteration: 82, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44717904925346375, gen p mean: -0.6808508634567261, mean p set: 0.44765937328338623
The modified gen p mean: 0.44681254029273987, gen p mean: -0.683687686920166, mean p set: 0.4472928047180176
The modified gen p mean: 0.4469744563102722, gen p mean: -0.6949142217636108, mean p set: 0.4474547207355499
loss_pred:0.027197012677788734, decouple_loss:0.016434716060757637
loss_pred:0.02893960475921631, decouple_loss:0.016565067693591118
loss_pred:0.028004541993141174, decouple_loss:0.016506627202033997
Iteration: 83, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466222822666168, gen p mean: -0.6876928806304932, mean p set: 0.44710254669189453
The modified gen p mean: 0.4468635618686676, gen p mean: -0.6880607604980469, mean p set: 0.4473438560962677
The modified gen p mean: 0.44496357440948486, gen p mean: -0.6839373111724854, mean p set: 0.4454438388347626
loss_pred:0.029245497658848763, decouple_loss:0.016036540269851685
loss_pred:0.02821088582277298, decouple_loss:0.015934981405735016
loss_pred:0.02825603447854519, decouple_loss:0.01663115993142128
Iteration: 84, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448246568441391, gen p mean: -0.6899179816246033, mean p set: 0.4487268626689911
The modified gen p mean: 0.4461824595928192, gen p mean: -0.6866625547409058, mean p set: 0.4466627538204193
The modified gen p mean: 0.4484856128692627, gen p mean: -0.693453848361969, mean p set: 0.4489658772945404
loss_pred:0.0290385652333498, decouple_loss:0.015327798202633858loss_pred:0.02792627178132534, decouple_loss:0.016900917515158653
loss_pred:0.028524190187454224, decouple_loss:0.016498498618602753
Iteration: 85, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44480326771736145, gen p mean: -0.6823940277099609, mean p set: 0.4452835023403168
The modified gen p mean: 0.44820907711982727, gen p mean: -0.6935317516326904, mean p set: 0.448689341545105
The modified gen p mean: 0.4473952651023865, gen p mean: -0.6946232914924622, mean p set: 0.4478755593299866
loss_pred:0.02840808779001236, decouple_loss:0.016118444502353668
loss_pred:0.02695733681321144, decouple_loss:0.015696290880441666
loss_pred:0.027595989406108856, decouple_loss:0.01599658839404583
Iteration: 86, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44837939739227295, gen p mean: -0.6970223784446716, mean p set: 0.44885969161987305
The modified gen p mean: 0.44835320115089417, gen p mean: -0.6920543909072876, mean p set: 0.44883349537849426
The modified gen p mean: 0.4472464621067047, gen p mean: -0.7021364569664001, mean p set: 0.44772669672966003
loss_pred:0.027954313904047012, decouple_loss:0.015506614930927753
loss_pred:0.02736087515950203, decouple_loss:0.015844786539673805
loss_pred:0.027106765657663345, decouple_loss:0.015576166100800037
Iteration: 87, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44450643658638, gen p mean: -0.677771270275116, mean p set: 0.4449867010116577
The modified gen p mean: 0.4483972191810608, gen p mean: -0.6849640011787415, mean p set: 0.4488775134086609
The modified gen p mean: 0.44799524545669556, gen p mean: -0.6923752427101135, mean p set: 0.44847550988197327
loss_pred:0.028559517115354538, decouple_loss:0.015618621371686459
loss_pred:0.027249565348029137, decouple_loss:0.015616077929735184
loss_pred:0.02765776589512825, decouple_loss:0.015563619323074818
Iteration: 88, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474361836910248, gen p mean: -0.6839405298233032, mean p set: 0.44791650772094727
The modified gen p mean: 0.44602862000465393, gen p mean: -0.6832618713378906, mean p set: 0.44650891423225403
The modified gen p mean: 0.447712779045105, gen p mean: -0.6937698125839233, mean p set: 0.4481930732727051
loss_pred:0.02796323411166668, decouple_loss:0.01532887015491724
loss_pred:0.027490505948662758, decouple_loss:0.01570172607898712
loss_pred:0.028497647494077682, decouple_loss:0.015485541895031929
Iteration: 89, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44719892740249634, gen p mean: -0.6874226331710815, mean p set: 0.4476792514324188
The modified gen p mean: 0.44729799032211304, gen p mean: -0.6913655400276184, mean p set: 0.44777825474739075
The modified gen p mean: 0.4465027153491974, gen p mean: -0.6780365109443665, mean p set: 0.4469830095767975
loss_pred:0.028370913118124008, decouple_loss:0.015422627329826355
loss_pred:0.028492124751210213, decouple_loss:0.01644221320748329
loss_pred:0.027753299102187157, decouple_loss:0.015508238226175308
Iteration: 90, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44673940539360046, gen p mean: -0.6940497159957886, mean p set: 0.4472196698188782
The modified gen p mean: 0.44743895530700684, gen p mean: -0.6851860284805298, mean p set: 0.44791924953460693
The modified gen p mean: 0.44801080226898193, gen p mean: -0.6938934922218323, mean p set: 0.44849109649658203
loss_pred:0.027397776022553444, decouple_loss:0.015456043183803558
loss_pred:0.02759477123618126, decouple_loss:0.015555041842162609
loss_pred:0.02755669876933098, decouple_loss:0.015552094206213951
2023-05-05 14:59:47 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.7108376622200012, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.6978084444999695, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7024893164634705, mean p set: 0.4500633478164673
loss_pred:0.028662240132689476, decouple_loss:0.017062373459339142
loss_pred:0.027189115062355995, decouple_loss:0.01650882698595524
loss_pred:0.02773555926978588, decouple_loss:0.016440358012914658
WV_0_PC_1_EH_0_PS_40_6, loss: 0.028695832937955856, avg_mse: 0.03363742306828499
current test mse: 0.033637
Iteration: 91, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482271373271942, gen p mean: -0.7028860449790955, mean p set: 0.44870737195014954
loss_pred:0.02709050662815571, decouple_loss:0.015293697826564312
The modified gen p mean: 0.44757911562919617, gen p mean: -0.7032594680786133, mean p set: 0.44805940985679626
loss_pred:0.02729533053934574, decouple_loss:0.015214518643915653
The modified gen p mean: 0.4484882354736328, gen p mean: -0.7087591886520386, mean p set: 0.4489684998989105
loss_pred:0.026815805584192276, decouple_loss:0.015408082865178585
Iteration: 92, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44812196493148804, gen p mean: -0.7082069516181946, mean p set: 0.44860225915908813
The modified gen p mean: 0.44721081852912903, gen p mean: -0.703820526599884, mean p set: 0.4476911425590515
The modified gen p mean: 0.44686490297317505, gen p mean: -0.6994573473930359, mean p set: 0.44734519720077515
loss_pred:0.028187379240989685, decouple_loss:0.01446229126304388
loss_pred:0.027224261313676834, decouple_loss:0.014295684173703194
loss_pred:0.027745475992560387, decouple_loss:0.013769933022558689
Iteration: 93, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468170702457428, gen p mean: -0.696614682674408, mean p set: 0.4472973346710205
The modified gen p mean: 0.44554176926612854, gen p mean: -0.6877579092979431, mean p set: 0.44602203369140625
The modified gen p mean: 0.4474271237850189, gen p mean: -0.6955404877662659, mean p set: 0.44790738821029663
loss_pred:0.027626385912299156, decouple_loss:0.015050741843879223loss_pred:0.02745990641415119, decouple_loss:0.01454846654087305
loss_pred:0.026760291308164597, decouple_loss:0.014389741234481335
Iteration: 94, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466514587402344, gen p mean: -0.6932045221328735, mean p set: 0.4471317529678345
The modified gen p mean: 0.44805580377578735, gen p mean: -0.6984224319458008, mean p set: 0.44853606820106506
The modified gen p mean: 0.4474489986896515, gen p mean: -0.7058953642845154, mean p set: 0.4479292929172516
loss_pred:0.02837776392698288, decouple_loss:0.014540479518473148
loss_pred:0.02747439034283161, decouple_loss:0.0149986008182168
loss_pred:0.02734694816172123, decouple_loss:0.015676815062761307
Iteration: 95, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472980797290802, gen p mean: -0.6966087222099304, mean p set: 0.4477783739566803
The modified gen p mean: 0.44788414239883423, gen p mean: -0.7045120596885681, mean p set: 0.4483644366264343
loss_pred:0.028750356286764145, decouple_loss:0.014379754662513733
The modified gen p mean: 0.44690120220184326, gen p mean: -0.6931868195533752, mean p set: 0.44738152623176575
loss_pred:0.027362801134586334, decouple_loss:0.01451003085821867
loss_pred:0.02782544307410717, decouple_loss:0.014627846889197826
Iteration: 96, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476768970489502, gen p mean: -0.6993163824081421, mean p set: 0.4481572210788727
The modified gen p mean: 0.4480471611022949, gen p mean: -0.7004354596138, mean p set: 0.44852742552757263
The modified gen p mean: 0.4468848705291748, gen p mean: -0.6973316669464111, mean p set: 0.4473651349544525
loss_pred:0.028150029480457306, decouple_loss:0.013928407803177834
loss_pred:0.02851601503789425, decouple_loss:0.014481165446341038
loss_pred:0.027354922145605087, decouple_loss:0.014174696989357471
Iteration: 97, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474976360797882, gen p mean: -0.6957520842552185, mean p set: 0.4479779005050659
The modified gen p mean: 0.4471152722835541, gen p mean: -0.7005853652954102, mean p set: 0.4475955367088318
The modified gen p mean: 0.4476078748703003, gen p mean: -0.6988146901130676, mean p set: 0.4480881989002228
loss_pred:0.02869872748851776, decouple_loss:0.01394900307059288
loss_pred:0.026500293985009193, decouple_loss:0.014501047320663929
loss_pred:0.026555966585874557, decouple_loss:0.014482994563877583
Iteration: 98, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469181001186371, gen p mean: -0.7037937641143799, mean p set: 0.4473983943462372
The modified gen p mean: 0.44770628213882446, gen p mean: -0.6981437802314758, mean p set: 0.4481865465641022
The modified gen p mean: 0.44446447491645813, gen p mean: -0.6895093321800232, mean p set: 0.4449447691440582
loss_pred:0.026860283687710762, decouple_loss:0.013627780601382256
loss_pred:0.02656889334321022, decouple_loss:0.013967578299343586
loss_pred:0.02864781767129898, decouple_loss:0.01454764511436224
Iteration: 99, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44732797145843506, gen p mean: -0.6845628023147583, mean p set: 0.44780823588371277
The modified gen p mean: 0.447120726108551, gen p mean: -0.6851717233657837, mean p set: 0.4476010203361511
The modified gen p mean: 0.4475243091583252, gen p mean: -0.6897026896476746, mean p set: 0.4480046033859253
loss_pred:0.026649916544556618, decouple_loss:0.014884204603731632
loss_pred:0.027202434837818146, decouple_loss:0.01467536948621273
loss_pred:0.026953162625432014, decouple_loss:0.01458875834941864
Iteration: 100, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44798991084098816, gen p mean: -0.6947274208068848, mean p set: 0.44847017526626587
The modified gen p mean: 0.44696685671806335, gen p mean: -0.6935771107673645, mean p set: 0.44744715094566345
The modified gen p mean: 0.4481102526187897, gen p mean: -0.6874043941497803, mean p set: 0.44859054684638977
loss_pred:0.02720891870558262, decouple_loss:0.013857247307896614
loss_pred:0.028292426839470863, decouple_loss:0.013761162757873535
loss_pred:0.026960890740156174, decouple_loss:0.01433253102004528
2023-05-05 15:03:25 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.7003515958786011, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.6881463527679443, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.6926887631416321, mean p set: 0.4500633478164673
loss_pred:0.02844478376209736, decouple_loss:0.015338464640080929
loss_pred:0.027057206258177757, decouple_loss:0.01443734485656023
loss_pred:0.027428947389125824, decouple_loss:0.01450920570641756
WV_0_PC_1_EH_0_PS_40_6, loss: 0.02838173136115074, avg_mse: 0.03343376889824867
current test mse: 0.033434
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012010_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012010_3_24hr.npz
NaN value num: 0
Iteration: 101, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514986574649811, gen p mean: -0.705291211605072, mean p set: 0.4519789516925812
The modified gen p mean: 0.45124661922454834, gen p mean: -0.701989471912384, mean p set: 0.45172688364982605
loss_pred:0.028090588748455048, decouple_loss:0.016691774129867554
loss_pred:0.029610423371195793, decouple_loss:0.01818849705159664
The modified gen p mean: 0.4517357647418976, gen p mean: -0.7010135650634766, mean p set: 0.4522160291671753
loss_pred:0.02748408541083336, decouple_loss:0.01911073923110962
Iteration: 102, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4518325626850128, gen p mean: -0.7071518301963806, mean p set: 0.4523128271102905
The modified gen p mean: 0.4516868591308594, gen p mean: -0.7133653163909912, mean p set: 0.4521671235561371
loss_pred:0.028100166469812393, decouple_loss:0.01782861351966858
loss_pred:0.027219904586672783, decouple_loss:0.017987528815865517
The modified gen p mean: 0.4506036043167114, gen p mean: -0.6916477084159851, mean p set: 0.4510838985443115
loss_pred:0.02822767198085785, decouple_loss:0.017934778705239296
Iteration: 103, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45137080550193787, gen p mean: -0.712643027305603, mean p set: 0.4518510699272156
The modified gen p mean: 0.45253291726112366, gen p mean: -0.7122834324836731, mean p set: 0.45301321148872375
The modified gen p mean: 0.4489378333091736, gen p mean: -0.690359354019165, mean p set: 0.4494180977344513
loss_pred:0.02813730575144291, decouple_loss:0.017347149550914764
loss_pred:0.028471043333411217, decouple_loss:0.017602184787392616
loss_pred:0.02680760622024536, decouple_loss:0.017424488440155983
Iteration: 104, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45122531056404114, gen p mean: -0.7042748928070068, mean p set: 0.45170560479164124
The modified gen p mean: 0.4501783847808838, gen p mean: -0.6939330101013184, mean p set: 0.4506586492061615
The modified gen p mean: 0.45302069187164307, gen p mean: -0.7095651030540466, mean p set: 0.45350101590156555
loss_pred:0.027475425973534584, decouple_loss:0.015799343585968018
loss_pred:0.02761268988251686, decouple_loss:0.015416108071804047
loss_pred:0.02822534367442131, decouple_loss:0.015908803790807724
Iteration: 105, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513400197029114, gen p mean: -0.7010751962661743, mean p set: 0.4518203139305115
The modified gen p mean: 0.44897574186325073, gen p mean: -0.6866344213485718, mean p set: 0.44945603609085083
The modified gen p mean: 0.4518813490867615, gen p mean: -0.7061738967895508, mean p set: 0.4523616135120392
loss_pred:0.028499368578195572, decouple_loss:0.016484132036566734
loss_pred:0.026463668793439865, decouple_loss:0.016611017286777496
loss_pred:0.028110111132264137, decouple_loss:0.01657966338098049
Iteration: 106, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45147356390953064, gen p mean: -0.700085461139679, mean p set: 0.45195385813713074
The modified gen p mean: 0.451517254114151, gen p mean: -0.6947969198226929, mean p set: 0.4519975483417511
The modified gen p mean: 0.4519064426422119, gen p mean: -0.7015109658241272, mean p set: 0.452386736869812
loss_pred:0.028657028451561928, decouple_loss:0.015712734311819077
loss_pred:0.02716955542564392, decouple_loss:0.015741920098662376
loss_pred:0.028342634439468384, decouple_loss:0.015837429091334343
Iteration: 107, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4519600570201874, gen p mean: -0.7024206519126892, mean p set: 0.4524403214454651
The modified gen p mean: 0.4513089954853058, gen p mean: -0.6929265856742859, mean p set: 0.4517892897129059
The modified gen p mean: 0.4539630711078644, gen p mean: -0.7028874754905701, mean p set: 0.4544433653354645
loss_pred:0.027132099494338036, decouple_loss:0.015538600273430347
loss_pred:0.026979105547070503, decouple_loss:0.01583421230316162
loss_pred:0.028305869549512863, decouple_loss:0.015436625108122826
Iteration: 108, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4520858824253082, gen p mean: -0.7029455304145813, mean p set: 0.4525661766529083
The modified gen p mean: 0.44998785853385925, gen p mean: -0.6953168511390686, mean p set: 0.45046815276145935
The modified gen p mean: 0.4518463611602783, gen p mean: -0.7124881744384766, mean p set: 0.4523266553878784
loss_pred:0.027462614700198174, decouple_loss:0.016318412497639656
loss_pred:0.026790676638484, decouple_loss:0.01636560820043087
loss_pred:0.027682175859808922, decouple_loss:0.015122700482606888
Iteration: 109, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4516639709472656, gen p mean: -0.6999343633651733, mean p set: 0.4521442651748657
The modified gen p mean: 0.4520367980003357, gen p mean: -0.7139760851860046, mean p set: 0.4525170624256134
The modified gen p mean: 0.453398197889328, gen p mean: -0.7175676822662354, mean p set: 0.4538784623146057
loss_pred:0.02717679738998413, decouple_loss:0.015583514235913754
loss_pred:0.027249714359641075, decouple_loss:0.01582755334675312
loss_pred:0.026506515219807625, decouple_loss:0.015254560858011246
Iteration: 110, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45040854811668396, gen p mean: -0.7066134214401245, mean p set: 0.45088884234428406
The modified gen p mean: 0.4517925977706909, gen p mean: -0.7127849459648132, mean p set: 0.45227286219596863
The modified gen p mean: 0.45329049229621887, gen p mean: -0.7151525020599365, mean p set: 0.45377078652381897
loss_pred:0.02858165092766285, decouple_loss:0.01575276255607605
loss_pred:0.02708018571138382, decouple_loss:0.015616417862474918
loss_pred:0.026651348918676376, decouple_loss:0.014733905903995037
2023-05-05 15:07:40 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.7124014496803284, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.6992043852806091, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.7038503289222717, mean p set: 0.4500633478164673
loss_pred:0.02886260114610195, decouple_loss:0.017385337501764297
loss_pred:0.027395665645599365, decouple_loss:0.016936613246798515
loss_pred:0.027696112170815468, decouple_loss:0.01659368723630905
WV_0_PC_1_EH_0_PS_40_6, loss: 0.028833387419581413, avg_mse: 0.03407062590122223
current test mse: 0.034071
Iteration: 111, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4527859091758728, gen p mean: -0.7178907990455627, mean p set: 0.4532662332057953
The modified gen p mean: 0.44999122619628906, gen p mean: -0.7045823335647583, mean p set: 0.45047152042388916
loss_pred:0.0269369687885046, decouple_loss:0.01481997687369585
loss_pred:0.026340002194046974, decouple_loss:0.015008421614766121
The modified gen p mean: 0.452846497297287, gen p mean: -0.7206169962882996, mean p set: 0.4533267617225647
loss_pred:0.02694210223853588, decouple_loss:0.014550327323377132
Iteration: 112, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45169636607170105, gen p mean: -0.7302707433700562, mean p set: 0.45217666029930115
The modified gen p mean: 0.4496181607246399, gen p mean: -0.6999174952507019, mean p set: 0.4500984251499176
The modified gen p mean: 0.45113512873649597, gen p mean: -0.7281755805015564, mean p set: 0.4516153931617737
loss_pred:0.026810672134160995, decouple_loss:0.016252432018518448
loss_pred:0.026973837986588478, decouple_loss:0.015778910368680954
loss_pred:0.02765231393277645, decouple_loss:0.015747588127851486
Iteration: 113, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45202934741973877, gen p mean: -0.7232054471969604, mean p set: 0.4525096118450165
The modified gen p mean: 0.4505375027656555, gen p mean: -0.7095800042152405, mean p set: 0.451017826795578
The modified gen p mean: 0.45077207684516907, gen p mean: -0.701641857624054, mean p set: 0.4512523412704468
loss_pred:0.027031438425183296, decouple_loss:0.015059932135045528
loss_pred:0.026344234123826027, decouple_loss:0.015983641147613525
loss_pred:0.027628475800156593, decouple_loss:0.014826188795268536
Iteration: 114, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4518691897392273, gen p mean: -0.7314944863319397, mean p set: 0.452349454164505
The modified gen p mean: 0.4496695399284363, gen p mean: -0.7138912677764893, mean p set: 0.4501498341560364
loss_pred:0.026822352781891823, decouple_loss:0.014703245833516121
loss_pred:0.02725876308977604, decouple_loss:0.014375513419508934
The modified gen p mean: 0.4525480270385742, gen p mean: -0.713225245475769, mean p set: 0.4530283212661743
loss_pred:0.02732340805232525, decouple_loss:0.015217594802379608
Iteration: 115, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4510897696018219, gen p mean: -0.7285078763961792, mean p set: 0.4515700936317444
The modified gen p mean: 0.451240211725235, gen p mean: -0.7315218448638916, mean p set: 0.4517205059528351
The modified gen p mean: 0.4525426924228668, gen p mean: -0.7197551727294922, mean p set: 0.4530230164527893
loss_pred:0.02674473263323307, decouple_loss:0.01470689196139574
loss_pred:0.02842659130692482, decouple_loss:0.01523496676236391
loss_pred:0.02698323503136635, decouple_loss:0.014903103932738304
Iteration: 116, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508105218410492, gen p mean: -0.7125995755195618, mean p set: 0.4512908160686493
The modified gen p mean: 0.4514321982860565, gen p mean: -0.7240172624588013, mean p set: 0.4519124925136566
The modified gen p mean: 0.45082804560661316, gen p mean: -0.728107213973999, mean p set: 0.45130833983421326
loss_pred:0.02622363716363907, decouple_loss:0.014775116927921772
loss_pred:0.028301915153861046, decouple_loss:0.014824244193732738
loss_pred:0.02715454436838627, decouple_loss:0.014826398342847824
Iteration: 117, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4537600576877594, gen p mean: -0.7155569195747375, mean p set: 0.4542403817176819
The modified gen p mean: 0.4516017436981201, gen p mean: -0.7168819308280945, mean p set: 0.4520820379257202
The modified gen p mean: 0.45095574855804443, gen p mean: -0.7135170102119446, mean p set: 0.45143604278564453
loss_pred:0.027432577684521675, decouple_loss:0.01461410615593195
loss_pred:0.02764769271016121, decouple_loss:0.014551547355949879
loss_pred:0.026712791994214058, decouple_loss:0.01385271642357111
Iteration: 118, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4517442584037781, gen p mean: -0.7239423394203186, mean p set: 0.4522245526313782
The modified gen p mean: 0.4511801600456238, gen p mean: -0.7134523391723633, mean p set: 0.4516604542732239
The modified gen p mean: 0.45270365476608276, gen p mean: -0.7256309390068054, mean p set: 0.45318397879600525
loss_pred:0.026406092569231987, decouple_loss:0.015266682021319866
loss_pred:0.026957856491208076, decouple_loss:0.014819792471826077
loss_pred:0.027116931974887848, decouple_loss:0.014842083677649498
Iteration: 119, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450575590133667, gen p mean: -0.7176556587219238, mean p set: 0.4510558545589447
The modified gen p mean: 0.45015931129455566, gen p mean: -0.7162767648696899, mean p set: 0.4506395757198334
The modified gen p mean: 0.450985848903656, gen p mean: -0.7152754664421082, mean p set: 0.4514661431312561
loss_pred:0.027793901041150093, decouple_loss:0.014579501934349537
loss_pred:0.027302652597427368, decouple_loss:0.014381651766598225
loss_pred:0.026908762753009796, decouple_loss:0.014299208298325539
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012005_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012005_3_24hr.npz
NaN value num: 0
Iteration: 120, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45221850275993347, gen p mean: -0.7050168514251709, mean p set: 0.45269879698753357
The modified gen p mean: 0.45191532373428345, gen p mean: -0.7062276005744934, mean p set: 0.45239561796188354
The modified gen p mean: 0.45093539357185364, gen p mean: -0.7080754637718201, mean p set: 0.45141565799713135
loss_pred:0.02771815098822117, decouple_loss:0.015566348098218441
loss_pred:0.02896171435713768, decouple_loss:0.01549892034381628
loss_pred:0.026979396119713783, decouple_loss:0.015575766563415527
2023-05-05 15:12:07 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.7111007571220398, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987669587135315, gen p mean: -0.6965972781181335, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7021248936653137, mean p set: 0.4500633478164673
loss_pred:0.02901136688888073, decouple_loss:0.01653154008090496
loss_pred:0.02755775861442089, decouple_loss:0.016319094225764275
loss_pred:0.02790112793445587, decouple_loss:0.015932632610201836
WV_0_PC_1_EH_0_PS_40_6, loss: 0.02896980568766594, avg_mse: 0.03429330885410309
current test mse: 0.034293
Iteration: 121, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45124709606170654, gen p mean: -0.7120739221572876, mean p set: 0.45172742009162903
The modified gen p mean: 0.45100584626197815, gen p mean: -0.7072052955627441, mean p set: 0.45148617029190063
loss_pred:0.0288971196860075, decouple_loss:0.015606787987053394
loss_pred:0.028039099648594856, decouple_loss:0.014171244576573372
The modified gen p mean: 0.45191705226898193, gen p mean: -0.6994444727897644, mean p set: 0.45239734649658203
loss_pred:0.02646557055413723, decouple_loss:0.01468480471521616
Iteration: 122, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4523831307888031, gen p mean: -0.7004139423370361, mean p set: 0.4528633952140808
The modified gen p mean: 0.4503636956214905, gen p mean: -0.6967529058456421, mean p set: 0.4508439898490906
The modified gen p mean: 0.4506296217441559, gen p mean: -0.7081698179244995, mean p set: 0.4511098861694336
loss_pred:0.027511674910783768, decouple_loss:0.014371093362569809
loss_pred:0.025922618806362152, decouple_loss:0.014625373296439648
loss_pred:0.02929368056356907, decouple_loss:0.014048551209270954
Iteration: 123, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450927734375, gen p mean: -0.7011249661445618, mean p set: 0.4514080286026001
The modified gen p mean: 0.4518134593963623, gen p mean: -0.7016469240188599, mean p set: 0.4522937834262848
loss_pred:0.029526401311159134, decouple_loss:0.014284605160355568
loss_pred:0.02589515410363674, decouple_loss:0.013912638649344444
The modified gen p mean: 0.45097115635871887, gen p mean: -0.7022864818572998, mean p set: 0.45145145058631897
loss_pred:0.027433382347226143, decouple_loss:0.014182420447468758
Iteration: 124, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45149075984954834, gen p mean: -0.7110484838485718, mean p set: 0.45197105407714844
The modified gen p mean: 0.45116761326789856, gen p mean: -0.7048216462135315, mean p set: 0.45164790749549866
The modified gen p mean: 0.45133718848228455, gen p mean: -0.7056054472923279, mean p set: 0.45181748270988464
loss_pred:0.02749871462583542, decouple_loss:0.013964587822556496
loss_pred:0.027755985036492348, decouple_loss:0.013428494334220886
loss_pred:0.028810439631342888, decouple_loss:0.013730686157941818
Iteration: 125, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45126789808273315, gen p mean: -0.7238165736198425, mean p set: 0.45174819231033325
The modified gen p mean: 0.45118051767349243, gen p mean: -0.7154808044433594, mean p set: 0.45166081190109253
The modified gen p mean: 0.4507334530353546, gen p mean: -0.722561240196228, mean p set: 0.4512137174606323
loss_pred:0.028598232194781303, decouple_loss:0.015171704813838005
loss_pred:0.027629336342215538, decouple_loss:0.01403801329433918
loss_pred:0.026095407083630562, decouple_loss:0.014889172278344631
Iteration: 126, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4509257674217224, gen p mean: -0.713860809803009, mean p set: 0.4514060616493225
The modified gen p mean: 0.4523986279964447, gen p mean: -0.7145736217498779, mean p set: 0.4528789222240448
The modified gen p mean: 0.4523017406463623, gen p mean: -0.717068076133728, mean p set: 0.45278200507164
loss_pred:0.029436366632580757, decouple_loss:0.014805205166339874
loss_pred:0.02656935155391693, decouple_loss:0.013584545813500881
loss_pred:0.027244100347161293, decouple_loss:0.013622398488223553
Iteration: 127, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45133134722709656, gen p mean: -0.7076777219772339, mean p set: 0.45181164145469666
The modified gen p mean: 0.45060813426971436, gen p mean: -0.7100357413291931, mean p set: 0.45108845829963684
The modified gen p mean: 0.4510226845741272, gen p mean: -0.7084999680519104, mean p set: 0.4515029489994049
loss_pred:0.028998449444770813, decouple_loss:0.014229745604097843
loss_pred:0.027639523148536682, decouple_loss:0.014007236808538437
loss_pred:0.026298947632312775, decouple_loss:0.01399578433483839
Iteration: 128, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45110514760017395, gen p mean: -0.7015004754066467, mean p set: 0.45158541202545166
The modified gen p mean: 0.4502906799316406, gen p mean: -0.7092663049697876, mean p set: 0.4507710039615631
The modified gen p mean: 0.4494110643863678, gen p mean: -0.6904541254043579, mean p set: 0.4498913586139679
loss_pred:0.028528746217489243, decouple_loss:0.013704539276659489
loss_pred:0.0284422654658556, decouple_loss:0.013660090044140816
loss_pred:0.026121089234948158, decouple_loss:0.013705722987651825
Iteration: 129, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4510725438594818, gen p mean: -0.697137176990509, mean p set: 0.4515528082847595
The modified gen p mean: 0.4500422775745392, gen p mean: -0.6880752444267273, mean p set: 0.45052260160446167
The modified gen p mean: 0.4506426751613617, gen p mean: -0.6962531805038452, mean p set: 0.4511229395866394
loss_pred:0.029383130371570587, decouple_loss:0.01436067558825016
loss_pred:0.02677132748067379, decouple_loss:0.013517962768673897
loss_pred:0.027999084442853928, decouple_loss:0.014391039498150349
Iteration: 130, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4515528380870819, gen p mean: -0.6997513175010681, mean p set: 0.4520331025123596
The modified gen p mean: 0.4509027898311615, gen p mean: -0.7131372690200806, mean p set: 0.4513830542564392
The modified gen p mean: 0.4510252773761749, gen p mean: -0.6921547055244446, mean p set: 0.451505571603775
loss_pred:0.028343865647912025, decouple_loss:0.013957674615085125
loss_pred:0.028585337102413177, decouple_loss:0.014259185642004013
loss_pred:0.027616294100880623, decouple_loss:0.013242029584944248
2023-05-05 15:15:45 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.705234169960022, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.6928884387016296, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.6977364420890808, mean p set: 0.4500633478164673
loss_pred:0.02876019850373268, decouple_loss:0.015743734315037727
loss_pred:0.027263376861810684, decouple_loss:0.015184720046818256
loss_pred:0.027664389461278915, decouple_loss:0.0151817100122571
WV_0_PC_1_EH_0_PS_40_6, loss: 0.028664492070674896, avg_mse: 0.0339050367474556
current test mse: 0.033905
Iteration: 131, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4520998001098633, gen p mean: -0.7029929161071777, mean p set: 0.45258012413978577
The modified gen p mean: 0.45028239488601685, gen p mean: -0.6977179050445557, mean p set: 0.45076268911361694
loss_pred:0.027982665225863457, decouple_loss:0.013525392860174179
loss_pred:0.02860180474817753, decouple_loss:0.013156072236597538
The modified gen p mean: 0.4511990249156952, gen p mean: -0.6933553218841553, mean p set: 0.4516793489456177
loss_pred:0.028301142156124115, decouple_loss:0.013554860837757587
Iteration: 132, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4515439569950104, gen p mean: -0.6942459344863892, mean p set: 0.4520242512226105
The modified gen p mean: 0.4512057602405548, gen p mean: -0.6961266398429871, mean p set: 0.4516860842704773
The modified gen p mean: 0.45163244009017944, gen p mean: -0.6991322040557861, mean p set: 0.45211273431777954
loss_pred:0.026493120938539505, decouple_loss:0.013479150831699371
loss_pred:0.02776148170232773, decouple_loss:0.013312814757227898
loss_pred:0.0287539754062891, decouple_loss:0.013817429542541504
Iteration: 133, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45039990544319153, gen p mean: -0.6940382719039917, mean p set: 0.45088016986846924
The modified gen p mean: 0.4513143002986908, gen p mean: -0.696264922618866, mean p set: 0.4517945945262909
The modified gen p mean: 0.4527598023414612, gen p mean: -0.696790337562561, mean p set: 0.4532400667667389
loss_pred:0.02758735977113247, decouple_loss:0.013195977546274662
loss_pred:0.025818325579166412, decouple_loss:0.013036004267632961
loss_pred:0.029376156628131866, decouple_loss:0.013780041597783566
Iteration: 134, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513819217681885, gen p mean: -0.7087692022323608, mean p set: 0.4518622159957886
The modified gen p mean: 0.4524074196815491, gen p mean: -0.7021329998970032, mean p set: 0.45288771390914917
The modified gen p mean: 0.45106038451194763, gen p mean: -0.7236867547035217, mean p set: 0.45154067873954773
loss_pred:0.027092380449175835, decouple_loss:0.013017089106142521
loss_pred:0.029373249039053917, decouple_loss:0.013239418156445026
loss_pred:0.028607062995433807, decouple_loss:0.013414938002824783
Iteration: 135, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45155468583106995, gen p mean: -0.7158847451210022, mean p set: 0.45203498005867004
The modified gen p mean: 0.4517457187175751, gen p mean: -0.7059510946273804, mean p set: 0.45222604274749756
The modified gen p mean: 0.45289456844329834, gen p mean: -0.7113887667655945, mean p set: 0.45337486267089844
loss_pred:0.029221665114164352, decouple_loss:0.013550471514463425loss_pred:0.02864648960530758, decouple_loss:0.01359272189438343
loss_pred:0.02659301832318306, decouple_loss:0.012771128676831722
Iteration: 136, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4509143531322479, gen p mean: -0.7040214538574219, mean p set: 0.4513946771621704
The modified gen p mean: 0.45057252049446106, gen p mean: -0.6986094117164612, mean p set: 0.45105281472206116
The modified gen p mean: 0.45290446281433105, gen p mean: -0.705396831035614, mean p set: 0.45338475704193115
loss_pred:0.02696688286960125, decouple_loss:0.012991962023079395
loss_pred:0.025376394391059875, decouple_loss:0.013048047199845314
loss_pred:0.0278073288500309, decouple_loss:0.012726275250315666
Iteration: 137, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45149368047714233, gen p mean: -0.6924115419387817, mean p set: 0.45197397470474243
The modified gen p mean: 0.4508022367954254, gen p mean: -0.699039101600647, mean p set: 0.4512825310230255
The modified gen p mean: 0.45139771699905396, gen p mean: -0.6968859434127808, mean p set: 0.45187801122665405
loss_pred:0.025097835808992386, decouple_loss:0.012743743136525154
loss_pred:0.026435818523168564, decouple_loss:0.013449235819280148
loss_pred:0.028294166550040245, decouple_loss:0.013292255811393261
Iteration: 138, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.451057106256485, gen p mean: -0.7031147480010986, mean p set: 0.4515374004840851
The modified gen p mean: 0.45060625672340393, gen p mean: -0.6984168887138367, mean p set: 0.45108652114868164
The modified gen p mean: 0.4524425268173218, gen p mean: -0.7075324058532715, mean p set: 0.4529227614402771
loss_pred:0.029162514954805374, decouple_loss:0.013569769449532032loss_pred:0.02824234589934349, decouple_loss:0.013056645169854164
loss_pred:0.027680547907948494, decouple_loss:0.013043083250522614
Iteration: 139, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45053577423095703, gen p mean: -0.7112838625907898, mean p set: 0.4510160982608795
The modified gen p mean: 0.4514378607273102, gen p mean: -0.7029045224189758, mean p set: 0.4519181549549103
loss_pred:0.02791745215654373, decouple_loss:0.01254862081259489
The modified gen p mean: 0.4510195255279541, gen p mean: -0.7072206735610962, mean p set: 0.4514998197555542
loss_pred:0.025375626981258392, decouple_loss:0.012757434509694576
loss_pred:0.028845997527241707, decouple_loss:0.012965088710188866
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012008_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012008_3_24hr.npz
NaN value num: 0
Iteration: 140, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493008553981781, gen p mean: -0.7075476050376892, mean p set: 0.4497811496257782
The modified gen p mean: 0.4476298689842224, gen p mean: -0.7038492560386658, mean p set: 0.4481101632118225
The modified gen p mean: 0.4480888843536377, gen p mean: -0.7042138576507568, mean p set: 0.4485691785812378
loss_pred:0.02559763938188553, decouple_loss:0.01320988591760397
loss_pred:0.026073109358549118, decouple_loss:0.013180277310311794
loss_pred:0.027672961354255676, decouple_loss:0.013005011714994907
2023-05-05 15:20:04 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.7091338634490967, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.6963369250297546, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7011300325393677, mean p set: 0.4500633478164673
loss_pred:0.028557533398270607, decouple_loss:0.014494318515062332
loss_pred:0.02704736962914467, decouple_loss:0.014224326238036156
loss_pred:0.027471249923110008, decouple_loss:0.014025678858160973
WV_0_PC_1_EH_0_PS_40_6, loss: 0.02840445563197136, avg_mse: 0.03369227796792984
current test mse: 0.033692
Iteration: 141, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44914501905441284, gen p mean: -0.699647843837738, mean p set: 0.4496253430843353
The modified gen p mean: 0.4482998847961426, gen p mean: -0.7063127756118774, mean p set: 0.4487801790237427
loss_pred:0.02572520263493061, decouple_loss:0.012642775662243366
loss_pred:0.02556527964770794, decouple_loss:0.012737792916595936
The modified gen p mean: 0.44924744963645935, gen p mean: -0.6962852478027344, mean p set: 0.44972777366638184
loss_pred:0.02629418671131134, decouple_loss:0.012532657943665981
Iteration: 142, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498811662197113, gen p mean: -0.7168826460838318, mean p set: 0.4503614604473114
The modified gen p mean: 0.44904959201812744, gen p mean: -0.7004528045654297, mean p set: 0.44952985644340515
The modified gen p mean: 0.4488687813282013, gen p mean: -0.7230439186096191, mean p set: 0.449349045753479
loss_pred:0.02645815908908844, decouple_loss:0.013756992295384407
loss_pred:0.026459837332367897, decouple_loss:0.012077994644641876
loss_pred:0.02693246118724346, decouple_loss:0.012817136943340302
Iteration: 143, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44773152470588684, gen p mean: -0.7003098726272583, mean p set: 0.44821181893348694
The modified gen p mean: 0.4500833749771118, gen p mean: -0.6998652219772339, mean p set: 0.4505636692047119
The modified gen p mean: 0.4498796761035919, gen p mean: -0.6945388913154602, mean p set: 0.450359970331192
loss_pred:0.025570040568709373, decouple_loss:0.011911410838365555
loss_pred:0.02635161392390728, decouple_loss:0.011910234577953815
loss_pred:0.025653336197137833, decouple_loss:0.012261314317584038
Iteration: 144, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483415484428406, gen p mean: -0.6912768483161926, mean p set: 0.4488218426704407
The modified gen p mean: 0.44967159628868103, gen p mean: -0.6923165321350098, mean p set: 0.45015186071395874
The modified gen p mean: 0.4502919018268585, gen p mean: -0.692279577255249, mean p set: 0.4507721960544586
loss_pred:0.02797209471464157, decouple_loss:0.013025050051510334
loss_pred:0.02776806615293026, decouple_loss:0.012549463659524918
loss_pred:0.026851793751120567, decouple_loss:0.012799620628356934
Iteration: 145, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507078528404236, gen p mean: -0.6966237425804138, mean p set: 0.4511880874633789
The modified gen p mean: 0.4485498368740082, gen p mean: -0.6915247440338135, mean p set: 0.4490301311016083
The modified gen p mean: 0.44863197207450867, gen p mean: -0.6878613233566284, mean p set: 0.44911229610443115
loss_pred:0.027640052139759064, decouple_loss:0.013377849943935871
loss_pred:0.02603573352098465, decouple_loss:0.012475891970098019
loss_pred:0.026247089728713036, decouple_loss:0.012361637316644192
Iteration: 146, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479730725288391, gen p mean: -0.7080094814300537, mean p set: 0.4484533667564392
The modified gen p mean: 0.44900333881378174, gen p mean: -0.718464195728302, mean p set: 0.44948363304138184
The modified gen p mean: 0.44935885071754456, gen p mean: -0.697820782661438, mean p set: 0.44983911514282227
loss_pred:0.027120493352413177, decouple_loss:0.012608158402144909
loss_pred:0.026653006672859192, decouple_loss:0.013356163166463375
loss_pred:0.02664067968726158, decouple_loss:0.011841942556202412
Iteration: 147, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496261477470398, gen p mean: -0.7239893674850464, mean p set: 0.4501064419746399
The modified gen p mean: 0.4493899643421173, gen p mean: -0.7276908755302429, mean p set: 0.4498702585697174
The modified gen p mean: 0.4495903253555298, gen p mean: -0.719129741191864, mean p set: 0.4500705897808075
loss_pred:0.026183072477579117, decouple_loss:0.0132187120616436
loss_pred:0.026608576998114586, decouple_loss:0.012512562796473503
loss_pred:0.02588052861392498, decouple_loss:0.012605356052517891
Iteration: 148, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496370851993561, gen p mean: -0.7140934467315674, mean p set: 0.4501173794269562
The modified gen p mean: 0.4490615725517273, gen p mean: -0.719536304473877, mean p set: 0.4495418667793274
The modified gen p mean: 0.4490783214569092, gen p mean: -0.7153691053390503, mean p set: 0.4495586156845093
loss_pred:0.027233900502324104, decouple_loss:0.012916372157633305
loss_pred:0.025702007114887238, decouple_loss:0.012556941248476505
loss_pred:0.027579257264733315, decouple_loss:0.012427686713635921
Iteration: 149, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44768422842025757, gen p mean: -0.721774697303772, mean p set: 0.44816452264785767
The modified gen p mean: 0.45030972361564636, gen p mean: -0.719316840171814, mean p set: 0.45079004764556885
The modified gen p mean: 0.44962725043296814, gen p mean: -0.7136350274085999, mean p set: 0.45010754466056824
loss_pred:0.027063053101301193, decouple_loss:0.012766469269990921
loss_pred:0.02614026889204979, decouple_loss:0.01250842958688736
loss_pred:0.026604605838656425, decouple_loss:0.012303506024181843
Iteration: 150, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45083022117614746, gen p mean: -0.7137148380279541, mean p set: 0.45131051540374756
The modified gen p mean: 0.449398398399353, gen p mean: -0.6997983455657959, mean p set: 0.4498787224292755
The modified gen p mean: 0.44960451126098633, gen p mean: -0.7095855474472046, mean p set: 0.4500848054885864
loss_pred:0.027639111503958702, decouple_loss:0.012473668903112411
loss_pred:0.02574935369193554, decouple_loss:0.013075130060315132
loss_pred:0.027278957888484, decouple_loss:0.012092646211385727
2023-05-05 15:23:42 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.7052332758903503, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.6922748684883118, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.6972436308860779, mean p set: 0.4500633478164673
loss_pred:0.02851574681699276, decouple_loss:0.014028706587851048
loss_pred:0.026934318244457245, decouple_loss:0.013975019566714764
loss_pred:0.027370700612664223, decouple_loss:0.013777704909443855
WV_0_PC_1_EH_0_PS_40_6, loss: 0.028303278610110283, avg_mse: 0.03357847407460213
current test mse: 0.033578
Iteration: 151, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44802236557006836, gen p mean: -0.7040053606033325, mean p set: 0.44850265979766846
The modified gen p mean: 0.4496113359928131, gen p mean: -0.7105440497398376, mean p set: 0.4500916600227356
loss_pred:0.025735514238476753, decouple_loss:0.012665590271353722
loss_pred:0.025704409927129745, decouple_loss:0.012584338895976543
The modified gen p mean: 0.44999992847442627, gen p mean: -0.7078460454940796, mean p set: 0.450480192899704
loss_pred:0.026308223605155945, decouple_loss:0.012074456550180912
Iteration: 152, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485494792461395, gen p mean: -0.7093546390533447, mean p set: 0.44902974367141724
The modified gen p mean: 0.44915708899497986, gen p mean: -0.7153922915458679, mean p set: 0.44963738322257996
loss_pred:0.026652934029698372, decouple_loss:0.01223484892398119
loss_pred:0.02572326362133026, decouple_loss:0.011964921839535236
The modified gen p mean: 0.44940653443336487, gen p mean: -0.712917149066925, mean p set: 0.44988682866096497
loss_pred:0.025771543383598328, decouple_loss:0.011721099726855755
Iteration: 153, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44868695735931396, gen p mean: -0.7012655735015869, mean p set: 0.44916728138923645
The modified gen p mean: 0.45034605264663696, gen p mean: -0.6980441212654114, mean p set: 0.45082634687423706
The modified gen p mean: 0.4490787386894226, gen p mean: -0.7111893892288208, mean p set: 0.4495590031147003
loss_pred:0.02562178671360016, decouple_loss:0.012362237088382244
loss_pred:0.02609383687376976, decouple_loss:0.012104650028049946
loss_pred:0.02638891339302063, decouple_loss:0.012327377684414387
Iteration: 154, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499788284301758, gen p mean: -0.7078507542610168, mean p set: 0.4504591226577759
The modified gen p mean: 0.4502198398113251, gen p mean: -0.7131683230400085, mean p set: 0.45070016384124756
loss_pred:0.026423882693052292, decouple_loss:0.012211115099489689
loss_pred:0.026136403903365135, decouple_loss:0.012086092494428158
The modified gen p mean: 0.4488604664802551, gen p mean: -0.7205077409744263, mean p set: 0.4493407607078552
loss_pred:0.026505788788199425, decouple_loss:0.011984985321760178
Iteration: 155, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503330886363983, gen p mean: -0.7146777510643005, mean p set: 0.450813353061676
The modified gen p mean: 0.4492671489715576, gen p mean: -0.7046917080879211, mean p set: 0.4497474730014801
loss_pred:0.025680474936962128, decouple_loss:0.011961255222558975
loss_pred:0.025962013751268387, decouple_loss:0.011892403475940228
The modified gen p mean: 0.45019569993019104, gen p mean: -0.7170219421386719, mean p set: 0.45067599415779114
loss_pred:0.025521069765090942, decouple_loss:0.011895831674337387
Iteration: 156, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4510636031627655, gen p mean: -0.7001599669456482, mean p set: 0.4515438675880432
The modified gen p mean: 0.4482400119304657, gen p mean: -0.7035138607025146, mean p set: 0.4487202763557434
The modified gen p mean: 0.45010000467300415, gen p mean: -0.7041678428649902, mean p set: 0.45058029890060425
loss_pred:0.027544809505343437, decouple_loss:0.01184467226266861
loss_pred:0.025596875697374344, decouple_loss:0.011477893218398094
loss_pred:0.02734638750553131, decouple_loss:0.012500130571424961
Iteration: 157, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504193961620331, gen p mean: -0.7118575572967529, mean p set: 0.45089972019195557
The modified gen p mean: 0.44890132546424866, gen p mean: -0.7124304175376892, mean p set: 0.44938161969184875
The modified gen p mean: 0.4499967396259308, gen p mean: -0.7078917026519775, mean p set: 0.4504770338535309
loss_pred:0.026098959147930145, decouple_loss:0.011151731014251709loss_pred:0.02556079998612404, decouple_loss:0.011735791340470314
loss_pred:0.025504998862743378, decouple_loss:0.011352927424013615
Iteration: 158, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44797053933143616, gen p mean: -0.7215102910995483, mean p set: 0.44845086336135864
The modified gen p mean: 0.44919463992118835, gen p mean: -0.7075956463813782, mean p set: 0.44967490434646606
The modified gen p mean: 0.44783833622932434, gen p mean: -0.7118616700172424, mean p set: 0.44831863045692444
loss_pred:0.026944203302264214, decouple_loss:0.011726003140211105
loss_pred:0.025651736184954643, decouple_loss:0.011968058533966541
loss_pred:0.027292607352137566, decouple_loss:0.012046383693814278
Iteration: 159, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500763416290283, gen p mean: -0.7231487035751343, mean p set: 0.4505566358566284
The modified gen p mean: 0.4495692551136017, gen p mean: -0.720430314540863, mean p set: 0.4500495493412018
The modified gen p mean: 0.44993531703948975, gen p mean: -0.7160357236862183, mean p set: 0.45041564106941223
loss_pred:0.02547416090965271, decouple_loss:0.011807002127170563
loss_pred:0.02674684301018715, decouple_loss:0.01225306373089552
loss_pred:0.026080265641212463, decouple_loss:0.011919056996703148
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012012_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012012_3_24hr.npz
NaN value num: 0
Iteration: 160, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44931164383888245, gen p mean: -0.7171916961669922, mean p set: 0.44979190826416016
The modified gen p mean: 0.4508315324783325, gen p mean: -0.7124351859092712, mean p set: 0.4513118267059326
The modified gen p mean: 0.45020464062690735, gen p mean: -0.7197798490524292, mean p set: 0.45068490505218506
loss_pred:0.026528721675276756, decouple_loss:0.01330022606998682
loss_pred:0.027638066560029984, decouple_loss:0.014181556180119514
loss_pred:0.027937188744544983, decouple_loss:0.013908922672271729
2023-05-05 15:28:05 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.7197051644325256, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7115306854248047, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7071703672409058, mean p set: 0.45035696029663086
loss_pred:0.02847290225327015, decouple_loss:0.013567770831286907
loss_pred:0.02740570902824402, decouple_loss:0.013047048822045326
loss_pred:0.027000263333320618, decouple_loss:0.013146135956048965
WV_0_PC_1_EH_0_PS_40_6, loss: 0.02828897349536419, avg_mse: 0.03368154913187027
current test mse: 0.033682
Iteration: 161, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44853904843330383, gen p mean: -0.7117618322372437, mean p set: 0.4490193724632263
The modified gen p mean: 0.4496683180332184, gen p mean: -0.7184815406799316, mean p set: 0.4501486122608185
loss_pred:0.02634410560131073, decouple_loss:0.012193729169666767
loss_pred:0.02712668478488922, decouple_loss:0.013956614769995213
The modified gen p mean: 0.4519721567630768, gen p mean: -0.7135322093963623, mean p set: 0.4524524509906769
loss_pred:0.02581682801246643, decouple_loss:0.013330964371562004
Iteration: 162, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45037809014320374, gen p mean: -0.7221105098724365, mean p set: 0.45085835456848145
The modified gen p mean: 0.4500272572040558, gen p mean: -0.7175886631011963, mean p set: 0.4505075514316559
loss_pred:0.026840940117836, decouple_loss:0.01408329512923956
loss_pred:0.028226587921380997, decouple_loss:0.013057194650173187
The modified gen p mean: 0.45172998309135437, gen p mean: -0.7103198766708374, mean p set: 0.45221027731895447
loss_pred:0.02696549892425537, decouple_loss:0.013541736640036106
Iteration: 163, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44925764203071594, gen p mean: -0.711266815662384, mean p set: 0.44973790645599365
The modified gen p mean: 0.4491751790046692, gen p mean: -0.7120025157928467, mean p set: 0.4496554732322693
loss_pred:0.026237333193421364, decouple_loss:0.012105786241590977
loss_pred:0.02710266411304474, decouple_loss:0.011904831975698471
The modified gen p mean: 0.45089876651763916, gen p mean: -0.7208764553070068, mean p set: 0.45137903094291687
loss_pred:0.027366135269403458, decouple_loss:0.01288506668061018
Iteration: 164, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44869571924209595, gen p mean: -0.7167708873748779, mean p set: 0.44917601346969604
The modified gen p mean: 0.4502831995487213, gen p mean: -0.7286099791526794, mean p set: 0.4507634937763214
loss_pred:0.02692238986492157, decouple_loss:0.011728609912097454
loss_pred:0.02691841311752796, decouple_loss:0.012625955045223236
The modified gen p mean: 0.4522729516029358, gen p mean: -0.7235323786735535, mean p set: 0.4527532756328583
loss_pred:0.026846129447221756, decouple_loss:0.012739868834614754
Iteration: 165, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45002520084381104, gen p mean: -0.7368519306182861, mean p set: 0.4505055248737335
The modified gen p mean: 0.45145395398139954, gen p mean: -0.73357754945755, mean p set: 0.45193424820899963
loss_pred:0.02663154900074005, decouple_loss:0.01291962806135416
loss_pred:0.02733295038342476, decouple_loss:0.012652894482016563
The modified gen p mean: 0.452571302652359, gen p mean: -0.7317047715187073, mean p set: 0.4530515968799591
loss_pred:0.02657908946275711, decouple_loss:0.012357445433735847
Iteration: 166, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503800570964813, gen p mean: -0.7261104583740234, mean p set: 0.4508603513240814
The modified gen p mean: 0.4497844874858856, gen p mean: -0.7220020294189453, mean p set: 0.4502647817134857
The modified gen p mean: 0.45165199041366577, gen p mean: -0.7344673275947571, mean p set: 0.45213228464126587
loss_pred:0.027540147304534912, decouple_loss:0.013296163640916348
loss_pred:0.02709667570888996, decouple_loss:0.012518317438662052
loss_pred:0.02633901685476303, decouple_loss:0.01341209840029478
Iteration: 167, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44999271631240845, gen p mean: -0.7207916378974915, mean p set: 0.45047301054000854
The modified gen p mean: 0.4533083140850067, gen p mean: -0.7166546583175659, mean p set: 0.4537885785102844
The modified gen p mean: 0.45121529698371887, gen p mean: -0.7207229733467102, mean p set: 0.45169559121131897
loss_pred:0.027686331421136856, decouple_loss:0.013014375232160091
loss_pred:0.02511523850262165, decouple_loss:0.012236546725034714
loss_pred:0.02729673683643341, decouple_loss:0.012230481952428818
Iteration: 168, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.452502965927124, gen p mean: -0.7201642394065857, mean p set: 0.4529832601547241
The modified gen p mean: 0.452386736869812, gen p mean: -0.7184669375419617, mean p set: 0.4528670310974121
The modified gen p mean: 0.45013538002967834, gen p mean: -0.7071724534034729, mean p set: 0.45061564445495605
loss_pred:0.026258695870637894, decouple_loss:0.012441462837159634
loss_pred:0.02535390853881836, decouple_loss:0.012046012096107006
loss_pred:0.02658899500966072, decouple_loss:0.012338802218437195
Iteration: 169, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486158788204193, gen p mean: -0.7155067324638367, mean p set: 0.4490962028503418
The modified gen p mean: 0.45096728205680847, gen p mean: -0.7235354781150818, mean p set: 0.4514475464820862
The modified gen p mean: 0.4495808780193329, gen p mean: -0.7212206125259399, mean p set: 0.450061172246933
loss_pred:0.02675400674343109, decouple_loss:0.011746203526854515
loss_pred:0.02695438079535961, decouple_loss:0.011843061074614525
loss_pred:0.02787231095135212, decouple_loss:0.012348129414021969
Iteration: 170, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499151408672333, gen p mean: -0.7217252254486084, mean p set: 0.450395405292511
The modified gen p mean: 0.45056042075157166, gen p mean: -0.7306991219520569, mean p set: 0.45104068517684937
The modified gen p mean: 0.44950199127197266, gen p mean: -0.7287954688072205, mean p set: 0.44998228549957275
loss_pred:0.026806581765413284, decouple_loss:0.012369208037853241loss_pred:0.026193058118224144, decouple_loss:0.012257819063961506
loss_pred:0.02701161615550518, decouple_loss:0.012694093398749828
2023-05-05 15:31:46 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.7201919555664062, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7072436213493347, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.7115065455436707, mean p set: 0.4500633478164673
loss_pred:0.028680283576250076, decouple_loss:0.014146754518151283
loss_pred:0.027526279911398888, decouple_loss:0.013315564021468163
loss_pred:0.027154048904776573, decouple_loss:0.013722733594477177
WV_0_PC_1_EH_0_PS_40_6, loss: 0.02847328782081604, avg_mse: 0.03394089639186859
current test mse: 0.033941
Iteration: 171, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44951504468917847, gen p mean: -0.7171226143836975, mean p set: 0.44999533891677856
The modified gen p mean: 0.45040810108184814, gen p mean: -0.710362434387207, mean p set: 0.45088836550712585
loss_pred:0.027107512578368187, decouple_loss:0.012350666336715221
loss_pred:0.026718294247984886, decouple_loss:0.012053189799189568
The modified gen p mean: 0.44974303245544434, gen p mean: -0.7196841835975647, mean p set: 0.4502233564853668
loss_pred:0.026834122836589813, decouple_loss:0.012203291989862919
Iteration: 172, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45019587874412537, gen p mean: -0.7136277556419373, mean p set: 0.45067617297172546
The modified gen p mean: 0.4493556320667267, gen p mean: -0.7268815040588379, mean p set: 0.4498359262943268
The modified gen p mean: 0.4502578377723694, gen p mean: -0.7084463238716125, mean p set: 0.4507381319999695
loss_pred:0.025710394605994225, decouple_loss:0.011560961604118347
loss_pred:0.02661113440990448, decouple_loss:0.01203357707709074
loss_pred:0.026316717267036438, decouple_loss:0.01156032457947731
Iteration: 173, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493119716644287, gen p mean: -0.726940393447876, mean p set: 0.4497922658920288
The modified gen p mean: 0.4498869776725769, gen p mean: -0.7202813625335693, mean p set: 0.4503673017024994
The modified gen p mean: 0.4498305916786194, gen p mean: -0.7223143577575684, mean p set: 0.4503108859062195
loss_pred:0.02702450193464756, decouple_loss:0.012066859751939774
loss_pred:0.02585969679057598, decouple_loss:0.011695114895701408
loss_pred:0.02682770974934101, decouple_loss:0.011586550623178482
Iteration: 174, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488760232925415, gen p mean: -0.7187992334365845, mean p set: 0.4493563175201416
The modified gen p mean: 0.4503837525844574, gen p mean: -0.7212109565734863, mean p set: 0.4508640468120575
The modified gen p mean: 0.44954437017440796, gen p mean: -0.7138488292694092, mean p set: 0.45002463459968567
loss_pred:0.027335695922374725, decouple_loss:0.01230787392705679
loss_pred:0.026730626821517944, decouple_loss:0.0111537491902709
loss_pred:0.02606642059981823, decouple_loss:0.011524226516485214
Iteration: 175, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498424828052521, gen p mean: -0.7237539887428284, mean p set: 0.4503227472305298
The modified gen p mean: 0.45147770643234253, gen p mean: -0.7218580842018127, mean p set: 0.4519580006599426
The modified gen p mean: 0.45023179054260254, gen p mean: -0.7247176170349121, mean p set: 0.45071205496788025
loss_pred:0.026811696588993073, decouple_loss:0.011230137199163437
loss_pred:0.02699849009513855, decouple_loss:0.012461106292903423
loss_pred:0.026577873155474663, decouple_loss:0.01200789213180542
Iteration: 176, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4521687924861908, gen p mean: -0.7251818180084229, mean p set: 0.4526490569114685
The modified gen p mean: 0.4501749873161316, gen p mean: -0.7256201505661011, mean p set: 0.4506552517414093
The modified gen p mean: 0.4494835436344147, gen p mean: -0.7285688519477844, mean p set: 0.44996383786201477
loss_pred:0.025878800079226494, decouple_loss:0.011950301937758923
loss_pred:0.027561040595173836, decouple_loss:0.012089284136891365
loss_pred:0.02725226804614067, decouple_loss:0.01189783588051796
Iteration: 177, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503077566623688, gen p mean: -0.7208278775215149, mean p set: 0.45078805088996887
The modified gen p mean: 0.4494195878505707, gen p mean: -0.7179314494132996, mean p set: 0.44989991188049316
The modified gen p mean: 0.449049711227417, gen p mean: -0.7241952419281006, mean p set: 0.4495299756526947
loss_pred:0.02694799192249775, decouple_loss:0.012250456027686596
loss_pred:0.026920272037386894, decouple_loss:0.01166938804090023
loss_pred:0.02731572650372982, decouple_loss:0.011906478554010391
Iteration: 178, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44909605383872986, gen p mean: -0.7043417692184448, mean p set: 0.44957631826400757
The modified gen p mean: 0.4500104486942291, gen p mean: -0.7164177894592285, mean p set: 0.4504907429218292
The modified gen p mean: 0.4481469690799713, gen p mean: -0.7218672633171082, mean p set: 0.4486272633075714
loss_pred:0.026832537725567818, decouple_loss:0.011935099959373474
loss_pred:0.027680495753884315, decouple_loss:0.011570872738957405
loss_pred:0.026727505028247833, decouple_loss:0.012189214117825031
Iteration: 179, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44874173402786255, gen p mean: -0.7095332741737366, mean p set: 0.44922199845314026
The modified gen p mean: 0.4525343179702759, gen p mean: -0.7202371954917908, mean p set: 0.45301464200019836
loss_pred:0.02663487382233143, decouple_loss:0.011522656306624413
loss_pred:0.0262090303003788, decouple_loss:0.012204592116177082
The modified gen p mean: 0.4494783282279968, gen p mean: -0.7163679599761963, mean p set: 0.4499586224555969
loss_pred:0.026538047939538956, decouple_loss:0.011446598917245865
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012010_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012010_3_24hr.npz
NaN value num: 0
Iteration: 180, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468787908554077, gen p mean: -0.7246021032333374, mean p set: 0.4473590552806854
The modified gen p mean: 0.44697925448417664, gen p mean: -0.7245635986328125, mean p set: 0.4474595785140991
The modified gen p mean: 0.44926369190216064, gen p mean: -0.72822505235672, mean p set: 0.44974398612976074
loss_pred:0.027122091501951218, decouple_loss:0.01443606149405241
loss_pred:0.028161555528640747, decouple_loss:0.013457813300192356
loss_pred:0.027840279042720795, decouple_loss:0.013926791027188301
2023-05-05 15:35:58 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.7218489050865173, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.708371639251709, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.7132329344749451, mean p set: 0.4500633478164673
loss_pred:0.02830629236996174, decouple_loss:0.013935117982327938
loss_pred:0.026834696531295776, decouple_loss:0.013298881240189075
loss_pred:0.02714117243885994, decouple_loss:0.013006438501179218
WV_0_PC_1_EH_0_PS_40_6, loss: 0.028098061680793762, avg_mse: 0.03325681760907173
current test mse: 0.033257
Iteration: 181, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44669780135154724, gen p mean: -0.7124703526496887, mean p set: 0.44717806577682495
The modified gen p mean: 0.4480290412902832, gen p mean: -0.71352618932724, mean p set: 0.4485093653202057
loss_pred:0.028821518644690514, decouple_loss:0.012980013154447079
loss_pred:0.029622551053762436, decouple_loss:0.013321952894330025
The modified gen p mean: 0.4465520977973938, gen p mean: -0.7117754220962524, mean p set: 0.4470323920249939
loss_pred:0.02863038145005703, decouple_loss:0.013652085326611996
Iteration: 182, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44866013526916504, gen p mean: -0.7172165513038635, mean p set: 0.44914042949676514
The modified gen p mean: 0.44771096110343933, gen p mean: -0.7207635045051575, mean p set: 0.44819125533103943
The modified gen p mean: 0.44730207324028015, gen p mean: -0.7139388918876648, mean p set: 0.44778236746788025
loss_pred:0.029025251045823097, decouple_loss:0.012476085685193539
loss_pred:0.02637026086449623, decouple_loss:0.013234133832156658
loss_pred:0.02855377271771431, decouple_loss:0.012523249723017216
Iteration: 183, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44797375798225403, gen p mean: -0.7196452021598816, mean p set: 0.4484540522098541
The modified gen p mean: 0.44661226868629456, gen p mean: -0.7155095934867859, mean p set: 0.44709256291389465
The modified gen p mean: 0.4485021233558655, gen p mean: -0.7204011678695679, mean p set: 0.4489823877811432
loss_pred:0.02765321172773838, decouple_loss:0.012971300631761551
loss_pred:0.027842819690704346, decouple_loss:0.012338796630501747
loss_pred:0.027889080345630646, decouple_loss:0.012742100283503532
Iteration: 184, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476429224014282, gen p mean: -0.7289990782737732, mean p set: 0.4481232166290283
The modified gen p mean: 0.4466244876384735, gen p mean: -0.7292748093605042, mean p set: 0.447104811668396
The modified gen p mean: 0.44859179854393005, gen p mean: -0.7285279631614685, mean p set: 0.44907209277153015
loss_pred:0.026937216520309448, decouple_loss:0.012699104845523834
loss_pred:0.027208983898162842, decouple_loss:0.01263031829148531
loss_pred:0.028193747624754906, decouple_loss:0.012249057181179523
Iteration: 185, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474125802516937, gen p mean: -0.7194901704788208, mean p set: 0.4478928744792938
The modified gen p mean: 0.44738319516181946, gen p mean: -0.7333021759986877, mean p set: 0.44786348938941956
The modified gen p mean: 0.44860216975212097, gen p mean: -0.7309445738792419, mean p set: 0.44908249378204346
loss_pred:0.028933681547641754, decouple_loss:0.012501519173383713
loss_pred:0.0276679415255785, decouple_loss:0.012607373297214508
loss_pred:0.027774358168244362, decouple_loss:0.013570090755820274
Iteration: 186, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44698894023895264, gen p mean: -0.7261000275611877, mean p set: 0.4474692642688751
The modified gen p mean: 0.4476343095302582, gen p mean: -0.7203580141067505, mean p set: 0.44811463356018066
The modified gen p mean: 0.4472706615924835, gen p mean: -0.732926607131958, mean p set: 0.4477509558200836
loss_pred:0.029327066615223885, decouple_loss:0.012589790858328342
loss_pred:0.029221665114164352, decouple_loss:0.012089491821825504
loss_pred:0.03006359003484249, decouple_loss:0.012287815101444721
Iteration: 187, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44631609320640564, gen p mean: -0.7169894576072693, mean p set: 0.4467964172363281
The modified gen p mean: 0.4465983808040619, gen p mean: -0.7208322882652283, mean p set: 0.4470786452293396
The modified gen p mean: 0.4477812349796295, gen p mean: -0.7194778323173523, mean p set: 0.4482615292072296
loss_pred:0.02837151475250721, decouple_loss:0.011582285165786743loss_pred:0.027632562443614006, decouple_loss:0.012475564144551754
loss_pred:0.028292322531342506, decouple_loss:0.01175159402191639
Iteration: 188, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44634953141212463, gen p mean: -0.7112151384353638, mean p set: 0.44682982563972473
The modified gen p mean: 0.4462946653366089, gen p mean: -0.706820547580719, mean p set: 0.446774959564209
The modified gen p mean: 0.44793370366096497, gen p mean: -0.7110869288444519, mean p set: 0.44841399788856506
loss_pred:0.026527296751737595, decouple_loss:0.011933519504964352
loss_pred:0.027602555230259895, decouple_loss:0.011809214949607849
loss_pred:0.028556203469634056, decouple_loss:0.011802541092038155
Iteration: 189, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44795945286750793, gen p mean: -0.7035562992095947, mean p set: 0.44843971729278564
The modified gen p mean: 0.4478081166744232, gen p mean: -0.7104654312133789, mean p set: 0.4482884109020233
The modified gen p mean: 0.44757428765296936, gen p mean: -0.7083572149276733, mean p set: 0.44805458188056946
loss_pred:0.027990393340587616, decouple_loss:0.011915143579244614
loss_pred:0.0270700566470623, decouple_loss:0.012316040694713593
loss_pred:0.026471221819519997, decouple_loss:0.01191133726388216
Iteration: 190, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469059705734253, gen p mean: -0.7088764905929565, mean p set: 0.447386234998703
The modified gen p mean: 0.44953829050064087, gen p mean: -0.7197611331939697, mean p set: 0.4500185549259186
The modified gen p mean: 0.44862696528434753, gen p mean: -0.7204651832580566, mean p set: 0.44910722970962524
loss_pred:0.027370009571313858, decouple_loss:0.012326054275035858
loss_pred:0.027664486318826675, decouple_loss:0.012356551364064217
loss_pred:0.027416296303272247, decouple_loss:0.011957826092839241
2023-05-05 15:39:36 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.7160773873329163, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830535888672, gen p mean: -0.7081453800201416, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7039538025856018, mean p set: 0.45035696029663086
loss_pred:0.027977408841252327, decouple_loss:0.012673793360590935
loss_pred:0.027001870796084404, decouple_loss:0.012441124767065048
loss_pred:0.026598786935210228, decouple_loss:0.012698210775852203
WV_0_PC_1_EH_0_PS_40_6, loss: 0.027822909876704216, avg_mse: 0.032984182238578796
current test mse: 0.032984
Iteration: 191, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470629394054413, gen p mean: -0.7049906849861145, mean p set: 0.44754326343536377
The modified gen p mean: 0.44684475660324097, gen p mean: -0.7131361365318298, mean p set: 0.44732505083084106
loss_pred:0.027824297547340393, decouple_loss:0.011645730584859848
loss_pred:0.027904324233531952, decouple_loss:0.012323059141635895
The modified gen p mean: 0.4490973949432373, gen p mean: -0.7144120931625366, mean p set: 0.4495777189731598
loss_pred:0.028414905071258545, decouple_loss:0.012138805352151394
Iteration: 192, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44722703099250793, gen p mean: -0.7048601508140564, mean p set: 0.44770732522010803
The modified gen p mean: 0.44650721549987793, gen p mean: -0.6974613070487976, mean p set: 0.4469875395298004
The modified gen p mean: 0.4469502866268158, gen p mean: -0.6978346705436707, mean p set: 0.4474305510520935
loss_pred:0.026614004746079445, decouple_loss:0.011766847223043442
loss_pred:0.027630120515823364, decouple_loss:0.012023918330669403
loss_pred:0.027678372338414192, decouple_loss:0.011819661594927311
Iteration: 193, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44695377349853516, gen p mean: -0.7077598571777344, mean p set: 0.44743403792381287
The modified gen p mean: 0.4469698369503021, gen p mean: -0.7061286568641663, mean p set: 0.44745010137557983
The modified gen p mean: 0.4479115605354309, gen p mean: -0.7064456343650818, mean p set: 0.448391854763031
loss_pred:0.029321016743779182, decouple_loss:0.011378508992493153
loss_pred:0.029745029285550117, decouple_loss:0.011274004355072975
loss_pred:0.02848607860505581, decouple_loss:0.011563525535166264
Iteration: 194, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44886574149131775, gen p mean: -0.720090389251709, mean p set: 0.44934606552124023
The modified gen p mean: 0.44759121537208557, gen p mean: -0.7150585055351257, mean p set: 0.4480714499950409
The modified gen p mean: 0.4478965699672699, gen p mean: -0.7180530428886414, mean p set: 0.44837686419487
loss_pred:0.028673287481069565, decouple_loss:0.012187314219772816
loss_pred:0.02764728106558323, decouple_loss:0.011568504385650158
loss_pred:0.02860650233924389, decouple_loss:0.011622966267168522
Iteration: 195, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479468762874603, gen p mean: -0.7275868654251099, mean p set: 0.4484272003173828
The modified gen p mean: 0.4499262869358063, gen p mean: -0.7397344708442688, mean p set: 0.45040658116340637
The modified gen p mean: 0.4479251205921173, gen p mean: -0.7288901209831238, mean p set: 0.4484054148197174
loss_pred:0.029203517362475395, decouple_loss:0.012001262046396732
loss_pred:0.02741958759725094, decouple_loss:0.012964924797415733
loss_pred:0.028560705482959747, decouple_loss:0.011685728095471859
Iteration: 196, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477614462375641, gen p mean: -0.7249667048454285, mean p set: 0.4482417702674866
The modified gen p mean: 0.4478977620601654, gen p mean: -0.7255142331123352, mean p set: 0.4483780562877655
The modified gen p mean: 0.44806918501853943, gen p mean: -0.7224418520927429, mean p set: 0.4485495090484619
loss_pred:0.0269775390625, decouple_loss:0.011968343518674374
loss_pred:0.02781500108540058, decouple_loss:0.011461125686764717
loss_pred:0.029345238581299782, decouple_loss:0.011386713944375515
Iteration: 197, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44677734375, gen p mean: -0.7084102034568787, mean p set: 0.4472576081752777
The modified gen p mean: 0.4474639296531677, gen p mean: -0.7137672305107117, mean p set: 0.4479442238807678
The modified gen p mean: 0.4468751847743988, gen p mean: -0.7122997045516968, mean p set: 0.4473554790019989
loss_pred:0.026897534728050232, decouple_loss:0.012160498648881912loss_pred:0.026855099946260452, decouple_loss:0.011679058894515038
loss_pred:0.026375072076916695, decouple_loss:0.011889108456671238
Iteration: 198, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475124478340149, gen p mean: -0.7051944732666016, mean p set: 0.447992742061615
The modified gen p mean: 0.447494775056839, gen p mean: -0.7012847661972046, mean p set: 0.4479750096797943
The modified gen p mean: 0.4468501806259155, gen p mean: -0.7018443942070007, mean p set: 0.4473304748535156
loss_pred:0.028726274147629738, decouple_loss:0.011282071471214294
loss_pred:0.028746040537953377, decouple_loss:0.011297645978629589
loss_pred:0.027805056422948837, decouple_loss:0.011221428401768208
Iteration: 199, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44763636589050293, gen p mean: -0.70640629529953, mean p set: 0.448116660118103
The modified gen p mean: 0.4463266134262085, gen p mean: -0.7121008634567261, mean p set: 0.4468069076538086
loss_pred:0.028879676014184952, decouple_loss:0.010670788586139679
loss_pred:0.026741033419966698, decouple_loss:0.010877980850636959
The modified gen p mean: 0.44768568873405457, gen p mean: -0.7082353830337524, mean p set: 0.44816598296165466
loss_pred:0.028943518176674843, decouple_loss:0.010638163425028324
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012017_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012017_3_24hr.npz
NaN value num: 0
Iteration: 200, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4524064362049103, gen p mean: -0.7138144373893738, mean p set: 0.45288676023483276
The modified gen p mean: 0.4528787434101105, gen p mean: -0.7242464423179626, mean p set: 0.45335903763771057
The modified gen p mean: 0.451952189207077, gen p mean: -0.7135781645774841, mean p set: 0.4524324834346771
loss_pred:0.027015842497348785, decouple_loss:0.013539837673306465
loss_pred:0.02684013359248638, decouple_loss:0.013252864591777325
loss_pred:0.027978448197245598, decouple_loss:0.012706116773188114
2023-05-05 15:43:56 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.7284038662910461, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7156410813331604, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.7202902436256409, mean p set: 0.4500633478164673
loss_pred:0.028165122494101524, decouple_loss:0.013192552141845226
loss_pred:0.026661699637770653, decouple_loss:0.012217482551932335
loss_pred:0.027119096368551254, decouple_loss:0.012372459284961224
WV_0_PC_1_EH_0_PS_40_6, loss: 0.02794501557946205, avg_mse: 0.03323667123913765
current test mse: 0.033237
Iteration: 201, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45140278339385986, gen p mean: -0.7158316373825073, mean p set: 0.45188307762145996
The modified gen p mean: 0.4487507939338684, gen p mean: -0.7211971282958984, mean p set: 0.4492310881614685
loss_pred:0.02838726155459881, decouple_loss:0.012418010272085667
loss_pred:0.027256928384304047, decouple_loss:0.011795342899858952
The modified gen p mean: 0.4489927887916565, gen p mean: -0.7240778803825378, mean p set: 0.4494730830192566
loss_pred:0.027645103633403778, decouple_loss:0.012029841542243958
Iteration: 202, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4520352780818939, gen p mean: -0.7155607342720032, mean p set: 0.452515572309494
The modified gen p mean: 0.4522644281387329, gen p mean: -0.718974232673645, mean p set: 0.452744722366333
The modified gen p mean: 0.45171207189559937, gen p mean: -0.7190567851066589, mean p set: 0.4521923363208771
loss_pred:0.02720993012189865, decouple_loss:0.012105338275432587
loss_pred:0.026184551417827606, decouple_loss:0.01207107026129961
loss_pred:0.027416806668043137, decouple_loss:0.01148488000035286
Iteration: 203, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44881126284599304, gen p mean: -0.7212111353874207, mean p set: 0.44929152727127075
The modified gen p mean: 0.4514298737049103, gen p mean: -0.7224901914596558, mean p set: 0.45191019773483276
loss_pred:0.027170762419700623, decouple_loss:0.011478140018880367
loss_pred:0.026857266202569008, decouple_loss:0.011850157752633095
The modified gen p mean: 0.4522947072982788, gen p mean: -0.7269247174263, mean p set: 0.4527750313282013
loss_pred:0.026614099740982056, decouple_loss:0.012216965667903423
Iteration: 204, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497663080692291, gen p mean: -0.7133931517601013, mean p set: 0.4502466022968292
The modified gen p mean: 0.45026251673698425, gen p mean: -0.7194555401802063, mean p set: 0.45074281096458435
loss_pred:0.028237054124474525, decouple_loss:0.011604664847254753
loss_pred:0.028125198557972908, decouple_loss:0.011321346275508404
The modified gen p mean: 0.4498441219329834, gen p mean: -0.7129634618759155, mean p set: 0.4503243863582611
loss_pred:0.026720017194747925, decouple_loss:0.011602750979363918
Iteration: 205, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514210820198059, gen p mean: -0.7084006071090698, mean p set: 0.4519013464450836
The modified gen p mean: 0.44993525743484497, gen p mean: -0.7198632955551147, mean p set: 0.4504155218601227
The modified gen p mean: 0.45021703839302063, gen p mean: -0.7112987637519836, mean p set: 0.4506973326206207
loss_pred:0.026950571686029434, decouple_loss:0.011321233585476875
loss_pred:0.02939615771174431, decouple_loss:0.011342472396790981
loss_pred:0.026649771258234978, decouple_loss:0.011412269435822964
Iteration: 206, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4523078501224518, gen p mean: -0.7128927111625671, mean p set: 0.4527881443500519
The modified gen p mean: 0.45227017998695374, gen p mean: -0.7280253767967224, mean p set: 0.45275044441223145
The modified gen p mean: 0.45123687386512756, gen p mean: -0.7148491740226746, mean p set: 0.45171716809272766
loss_pred:0.027577433735132217, decouple_loss:0.011515278369188309
loss_pred:0.027023985981941223, decouple_loss:0.011985549703240395
loss_pred:0.028131190687417984, decouple_loss:0.011771580204367638
Iteration: 207, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497336149215698, gen p mean: -0.7247371077537537, mean p set: 0.45021387934684753
The modified gen p mean: 0.44949042797088623, gen p mean: -0.7317814826965332, mean p set: 0.44997072219848633
The modified gen p mean: 0.4493335485458374, gen p mean: -0.7203704118728638, mean p set: 0.4498138427734375
loss_pred:0.027385566383600235, decouple_loss:0.011092719621956348
loss_pred:0.027620596811175346, decouple_loss:0.0116700055077672
loss_pred:0.025841932743787766, decouple_loss:0.011907163076102734
Iteration: 208, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494214653968811, gen p mean: -0.7292453646659851, mean p set: 0.4499017596244812
The modified gen p mean: 0.4499061107635498, gen p mean: -0.7286421656608582, mean p set: 0.4503864049911499
The modified gen p mean: 0.4499744772911072, gen p mean: -0.729619562625885, mean p set: 0.4504547715187073
loss_pred:0.027645230293273926, decouple_loss:0.011011268943548203
loss_pred:0.0288290623575449, decouple_loss:0.010785611346364021
loss_pred:0.028984371572732925, decouple_loss:0.010841472074389458
Iteration: 209, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4521124064922333, gen p mean: -0.7195924520492554, mean p set: 0.4525927007198334
The modified gen p mean: 0.45233821868896484, gen p mean: -0.7393673062324524, mean p set: 0.45281848311424255
The modified gen p mean: 0.45226559042930603, gen p mean: -0.7222376465797424, mean p set: 0.45274588465690613
loss_pred:0.026372281834483147, decouple_loss:0.011637651361525059
loss_pred:0.026577025651931763, decouple_loss:0.01190973725169897
loss_pred:0.025825947523117065, decouple_loss:0.011642763391137123
Iteration: 210, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.451761931180954, gen p mean: -0.723913311958313, mean p set: 0.4522422254085541
The modified gen p mean: 0.4519214630126953, gen p mean: -0.7199981212615967, mean p set: 0.4524017870426178
The modified gen p mean: 0.4518701732158661, gen p mean: -0.7394954562187195, mean p set: 0.4523504674434662
loss_pred:0.02604924514889717, decouple_loss:0.011728428304195404loss_pred:0.026304341852664948, decouple_loss:0.01156242098659277
loss_pred:0.02723553031682968, decouple_loss:0.012166731990873814
2023-05-05 15:47:32 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.7311094999313354, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7190036177635193, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7235152721405029, mean p set: 0.4500633478164673
loss_pred:0.02816872112452984, decouple_loss:0.012663343921303749
loss_pred:0.026667388156056404, decouple_loss:0.012236030772328377
loss_pred:0.02713499590754509, decouple_loss:0.012479345314204693
WV_0_PC_1_EH_0_PS_40_6, loss: 0.027946680784225464, avg_mse: 0.03322077542543411
current test mse: 0.033221
Iteration: 211, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45147886872291565, gen p mean: -0.7223861217498779, mean p set: 0.45195919275283813
The modified gen p mean: 0.4520311951637268, gen p mean: -0.7294173836708069, mean p set: 0.4525114893913269
loss_pred:0.026680994778871536, decouple_loss:0.011726688593626022
loss_pred:0.027187800034880638, decouple_loss:0.01132463663816452
The modified gen p mean: 0.4502570331096649, gen p mean: -0.7271662354469299, mean p set: 0.450737327337265
loss_pred:0.027723439037799835, decouple_loss:0.011082904413342476
Iteration: 212, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44988295435905457, gen p mean: -0.7107434868812561, mean p set: 0.45036324858665466
The modified gen p mean: 0.4498410224914551, gen p mean: -0.7139727473258972, mean p set: 0.4503213167190552
The modified gen p mean: 0.45204421877861023, gen p mean: -0.7086097598075867, mean p set: 0.4525245130062103
loss_pred:0.02588532492518425, decouple_loss:0.011176321655511856
loss_pred:0.025935230776667595, decouple_loss:0.010946429334580898
loss_pred:0.026305727660655975, decouple_loss:0.011199806816875935
Iteration: 213, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44941064715385437, gen p mean: -0.713283121585846, mean p set: 0.44989094138145447
The modified gen p mean: 0.45164403319358826, gen p mean: -0.7101935148239136, mean p set: 0.4521242678165436
loss_pred:0.026157379150390625, decouple_loss:0.011347245424985886
loss_pred:0.02783793956041336, decouple_loss:0.01109759695827961
The modified gen p mean: 0.4502771496772766, gen p mean: -0.722734808921814, mean p set: 0.4507574439048767
loss_pred:0.028147775679826736, decouple_loss:0.011465960182249546
Iteration: 214, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492368698120117, gen p mean: -0.7123180031776428, mean p set: 0.4497171640396118
The modified gen p mean: 0.4501321017742157, gen p mean: -0.7114402651786804, mean p set: 0.4506123960018158
The modified gen p mean: 0.45030316710472107, gen p mean: -0.7094040513038635, mean p set: 0.4507834315299988
loss_pred:0.025810115039348602, decouple_loss:0.010962092317640781
loss_pred:0.026854421943426132, decouple_loss:0.010969218797981739
loss_pred:0.025778574869036674, decouple_loss:0.01064261794090271
Iteration: 215, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44944971799850464, gen p mean: -0.7125263214111328, mean p set: 0.44993001222610474
The modified gen p mean: 0.45170992612838745, gen p mean: -0.7099614143371582, mean p set: 0.45219019055366516
The modified gen p mean: 0.4491058588027954, gen p mean: -0.7181407809257507, mean p set: 0.4495861530303955
loss_pred:0.026019107550382614, decouple_loss:0.010416598059237003loss_pred:0.026711437851190567, decouple_loss:0.010640102438628674
loss_pred:0.027286347001791, decouple_loss:0.010935473255813122
Iteration: 216, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500156044960022, gen p mean: -0.7178053259849548, mean p set: 0.4504959285259247
The modified gen p mean: 0.4494694173336029, gen p mean: -0.7114570140838623, mean p set: 0.449949711561203
loss_pred:0.02766154520213604, decouple_loss:0.010709415189921856
loss_pred:0.025677192956209183, decouple_loss:0.010624929331243038
The modified gen p mean: 0.45043453574180603, gen p mean: -0.7088310122489929, mean p set: 0.4509148597717285
loss_pred:0.02583935111761093, decouple_loss:0.010291839949786663
Iteration: 217, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45169979333877563, gen p mean: -0.7273032665252686, mean p set: 0.45218008756637573
The modified gen p mean: 0.4516895115375519, gen p mean: -0.7141475081443787, mean p set: 0.4521697759628296
The modified gen p mean: 0.45222026109695435, gen p mean: -0.7275756597518921, mean p set: 0.45270055532455444
loss_pred:0.02751295082271099, decouple_loss:0.0118152080103755
loss_pred:0.02634771354496479, decouple_loss:0.010705471970140934
loss_pred:0.026880942285060883, decouple_loss:0.01184177491813898
Iteration: 218, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450868159532547, gen p mean: -0.7175426483154297, mean p set: 0.4513484537601471
The modified gen p mean: 0.4486709535121918, gen p mean: -0.7179467082023621, mean p set: 0.44915124773979187
The modified gen p mean: 0.4519834518432617, gen p mean: -0.716370165348053, mean p set: 0.4524637460708618
loss_pred:0.026118123903870583, decouple_loss:0.01094602607190609loss_pred:0.026359522715210915, decouple_loss:0.01068822667002678
loss_pred:0.02770250104367733, decouple_loss:0.010907735675573349
Iteration: 219, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488823413848877, gen p mean: -0.7149600386619568, mean p set: 0.4493626356124878
The modified gen p mean: 0.44986066222190857, gen p mean: -0.721820592880249, mean p set: 0.45034095644950867
The modified gen p mean: 0.4489936828613281, gen p mean: -0.7246049046516418, mean p set: 0.4494739770889282
loss_pred:0.026108786463737488, decouple_loss:0.010320877656340599
loss_pred:0.027776015922427177, decouple_loss:0.010849248617887497
loss_pred:0.027244670316576958, decouple_loss:0.010795659385621548
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012005_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012005_3_24hr.npz
NaN value num: 0
Iteration: 220, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45258834958076477, gen p mean: -0.7223838567733765, mean p set: 0.45306864380836487
The modified gen p mean: 0.450423002243042, gen p mean: -0.7221060395240784, mean p set: 0.4509033262729645
The modified gen p mean: 0.4527331292629242, gen p mean: -0.7381986975669861, mean p set: 0.45321348309516907
loss_pred:0.026580870151519775, decouple_loss:0.011693017557263374
loss_pred:0.026283008977770805, decouple_loss:0.013642732985317707
loss_pred:0.02659700997173786, decouple_loss:0.012853976339101791
2023-05-05 15:51:49 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.7327940464019775, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.720315158367157, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7256147861480713, mean p set: 0.4500633478164673
loss_pred:0.028356099501252174, decouple_loss:0.012658536434173584
loss_pred:0.026875311508774757, decouple_loss:0.011990404687821865
loss_pred:0.02722420170903206, decouple_loss:0.01200617104768753
WV_0_PC_1_EH_0_PS_40_6, loss: 0.028096124529838562, avg_mse: 0.033608898520469666
current test mse: 0.033609
Iteration: 221, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44977107644081116, gen p mean: -0.7186228632926941, mean p set: 0.45025137066841125
The modified gen p mean: 0.4514361321926117, gen p mean: -0.7328826785087585, mean p set: 0.4519164264202118
loss_pred:0.02621546760201454, decouple_loss:0.011847204528748989
loss_pred:0.027108272537589073, decouple_loss:0.012619305402040482
The modified gen p mean: 0.4531160593032837, gen p mean: -0.7473215460777283, mean p set: 0.4535963535308838
loss_pred:0.026398591697216034, decouple_loss:0.01267452072352171
Iteration: 222, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494636654853821, gen p mean: -0.7258983850479126, mean p set: 0.4499439597129822
The modified gen p mean: 0.45117464661598206, gen p mean: -0.7280074954032898, mean p set: 0.45165497064590454
loss_pred:0.026119327172636986, decouple_loss:0.011892979964613914
loss_pred:0.027431147173047066, decouple_loss:0.011816694401204586
The modified gen p mean: 0.4523387849330902, gen p mean: -0.734667181968689, mean p set: 0.4528190791606903
loss_pred:0.026036804541945457, decouple_loss:0.01195566076785326
Iteration: 223, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505559802055359, gen p mean: -0.7204315066337585, mean p set: 0.4510363042354584
The modified gen p mean: 0.45174407958984375, gen p mean: -0.7367028594017029, mean p set: 0.45222437381744385
The modified gen p mean: 0.45161476731300354, gen p mean: -0.7321704626083374, mean p set: 0.45209503173828125
loss_pred:0.025866448879241943, decouple_loss:0.011388071812689304
loss_pred:0.0261826328933239, decouple_loss:0.011830508708953857
loss_pred:0.0256966445595026, decouple_loss:0.012464908882975578
Iteration: 224, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4512365162372589, gen p mean: -0.7275789976119995, mean p set: 0.451716810464859
The modified gen p mean: 0.4501190483570099, gen p mean: -0.7223820686340332, mean p set: 0.4505993127822876
The modified gen p mean: 0.45040595531463623, gen p mean: -0.732302188873291, mean p set: 0.45088624954223633
loss_pred:0.02617245353758335, decouple_loss:0.012376384809613228
loss_pred:0.02655409649014473, decouple_loss:0.011484391056001186
loss_pred:0.026524456217885017, decouple_loss:0.011812500655651093
Iteration: 225, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499375820159912, gen p mean: -0.7118602395057678, mean p set: 0.4504178762435913
The modified gen p mean: 0.4540459215641022, gen p mean: -0.7290181517601013, mean p set: 0.45452621579170227
The modified gen p mean: 0.45038139820098877, gen p mean: -0.7123731970787048, mean p set: 0.45086169242858887
loss_pred:0.026308171451091766, decouple_loss:0.011111807078123093
loss_pred:0.024977581575512886, decouple_loss:0.012226590886712074
loss_pred:0.02743072807788849, decouple_loss:0.011364047415554523
Iteration: 226, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4523015320301056, gen p mean: -0.7292783260345459, mean p set: 0.4527818560600281
The modified gen p mean: 0.4534416198730469, gen p mean: -0.7125775814056396, mean p set: 0.453921914100647
The modified gen p mean: 0.45310524106025696, gen p mean: -0.7364992499351501, mean p set: 0.45358556509017944
loss_pred:0.0259694866836071, decouple_loss:0.011834959499537945loss_pred:0.02641809545457363, decouple_loss:0.011957102455198765
loss_pred:0.026260023936629295, decouple_loss:0.011576402001082897
Iteration: 227, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4548639953136444, gen p mean: -0.7402849197387695, mean p set: 0.4553443193435669
The modified gen p mean: 0.4527290463447571, gen p mean: -0.7317236065864563, mean p set: 0.4532093107700348
The modified gen p mean: 0.45240917801856995, gen p mean: -0.7284760475158691, mean p set: 0.45288947224617004
loss_pred:0.025522058829665184, decouple_loss:0.012026694603264332
loss_pred:0.025679949671030045, decouple_loss:0.01224931888282299
loss_pred:0.025925163179636, decouple_loss:0.010927082970738411
Iteration: 228, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513079524040222, gen p mean: -0.7387914061546326, mean p set: 0.4517882466316223
The modified gen p mean: 0.4519653022289276, gen p mean: -0.7398337125778198, mean p set: 0.4524455666542053
The modified gen p mean: 0.4515925645828247, gen p mean: -0.7329428195953369, mean p set: 0.4520728290081024
loss_pred:0.026335470378398895, decouple_loss:0.011477159336209297
loss_pred:0.025739671662449837, decouple_loss:0.011432427912950516
loss_pred:0.025033947080373764, decouple_loss:0.01158736553043127
Iteration: 229, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.451201468706131, gen p mean: -0.726687490940094, mean p set: 0.4516817331314087
The modified gen p mean: 0.45290035009384155, gen p mean: -0.722214937210083, mean p set: 0.45338064432144165
The modified gen p mean: 0.4518640637397766, gen p mean: -0.7270036935806274, mean p set: 0.4523443579673767
loss_pred:0.025648683309555054, decouple_loss:0.011751720681786537
loss_pred:0.026518596336245537, decouple_loss:0.011469181627035141
loss_pred:0.02582024224102497, decouple_loss:0.011603115126490593
Iteration: 230, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4530911147594452, gen p mean: -0.7291231751441956, mean p set: 0.4535713791847229
The modified gen p mean: 0.4519462585449219, gen p mean: -0.7285134792327881, mean p set: 0.45242658257484436
The modified gen p mean: 0.4505847990512848, gen p mean: -0.7165703177452087, mean p set: 0.4510650634765625
loss_pred:0.025648197159171104, decouple_loss:0.011242587119340897
loss_pred:0.026283670216798782, decouple_loss:0.011257309466600418
loss_pred:0.02592487819492817, decouple_loss:0.011252745985984802
2023-05-05 15:55:27 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.7307026982307434, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7181375026702881, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7229942679405212, mean p set: 0.4500633478164673
loss_pred:0.02680535987019539, decouple_loss:0.012167076580226421
loss_pred:0.028473304584622383, decouple_loss:0.0122818723320961
loss_pred:0.02716551162302494, decouple_loss:0.011828099377453327
WV_0_PC_1_EH_0_PS_40_6, loss: 0.028086010366678238, avg_mse: 0.03357287123799324
current test mse: 0.033573
Iteration: 231, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45198854804039, gen p mean: -0.7410492897033691, mean p set: 0.4524688422679901
The modified gen p mean: 0.4510310888290405, gen p mean: -0.7231639623641968, mean p set: 0.4515113830566406
loss_pred:0.02589300274848938, decouple_loss:0.01103108748793602
loss_pred:0.026095597073435783, decouple_loss:0.010901483707129955
The modified gen p mean: 0.45057326555252075, gen p mean: -0.7223915457725525, mean p set: 0.45105352997779846
loss_pred:0.027177030220627785, decouple_loss:0.011041861958801746
Iteration: 232, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493984878063202, gen p mean: -0.7201496362686157, mean p set: 0.4498787522315979
The modified gen p mean: 0.4525851309299469, gen p mean: -0.7307206392288208, mean p set: 0.453065425157547
The modified gen p mean: 0.45201167464256287, gen p mean: -0.7326211333274841, mean p set: 0.45249199867248535
loss_pred:0.024817297235131264, decouple_loss:0.011660147458314896
loss_pred:0.026422038674354553, decouple_loss:0.011159052141010761
loss_pred:0.026399003341794014, decouple_loss:0.010907098650932312
Iteration: 233, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45042431354522705, gen p mean: -0.7208299040794373, mean p set: 0.45090457797050476
The modified gen p mean: 0.4528244435787201, gen p mean: -0.7302824854850769, mean p set: 0.4533047676086426
loss_pred:0.025617608800530434, decouple_loss:0.010807288810610771
loss_pred:0.02634274587035179, decouple_loss:0.010893646627664566
The modified gen p mean: 0.4503895938396454, gen p mean: -0.730040967464447, mean p set: 0.45086991786956787
loss_pred:0.025772571563720703, decouple_loss:0.01123641524463892
Iteration: 234, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507405161857605, gen p mean: -0.7300155758857727, mean p set: 0.4512208104133606
The modified gen p mean: 0.4505912661552429, gen p mean: -0.7241043448448181, mean p set: 0.451071560382843
The modified gen p mean: 0.45228126645088196, gen p mean: -0.7359347939491272, mean p set: 0.45276156067848206
loss_pred:0.026080945506691933, decouple_loss:0.011387376114726067
loss_pred:0.025980692356824875, decouple_loss:0.011112788692116737
loss_pred:0.025424903258681297, decouple_loss:0.011200951412320137
Iteration: 235, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4519379734992981, gen p mean: -0.7354369759559631, mean p set: 0.4524182975292206
The modified gen p mean: 0.45404502749443054, gen p mean: -0.745245635509491, mean p set: 0.45452532172203064
loss_pred:0.025955447927117348, decouple_loss:0.011076170951128006
loss_pred:0.026758205145597458, decouple_loss:0.011740732938051224
The modified gen p mean: 0.44958361983299255, gen p mean: -0.7192594408988953, mean p set: 0.45006391406059265
loss_pred:0.02497909963130951, decouple_loss:0.010695445351302624
Iteration: 236, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45060399174690247, gen p mean: -0.7216013669967651, mean p set: 0.45108428597450256
The modified gen p mean: 0.4507555365562439, gen p mean: -0.719438910484314, mean p set: 0.451235830783844
The modified gen p mean: 0.45217081904411316, gen p mean: -0.7264794707298279, mean p set: 0.45265111327171326
loss_pred:0.024878736585378647, decouple_loss:0.010534189641475677
loss_pred:0.026596907526254654, decouple_loss:0.010457806289196014
loss_pred:0.02608177624642849, decouple_loss:0.011179952882230282
Iteration: 237, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.454100102186203, gen p mean: -0.7481334805488586, mean p set: 0.4545804262161255
The modified gen p mean: 0.45024573802948, gen p mean: -0.7351881861686707, mean p set: 0.4507260322570801
loss_pred:0.026465430855751038, decouple_loss:0.011716336011886597
loss_pred:0.026217326521873474, decouple_loss:0.010624920949339867
The modified gen p mean: 0.45204100012779236, gen p mean: -0.7363111972808838, mean p set: 0.45252126455307007
loss_pred:0.025238793343305588, decouple_loss:0.011465687304735184
Iteration: 238, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45334434509277344, gen p mean: -0.741759717464447, mean p set: 0.45382463932037354
The modified gen p mean: 0.45183470845222473, gen p mean: -0.7495328187942505, mean p set: 0.45231500267982483
The modified gen p mean: 0.45383355021476746, gen p mean: -0.7436879277229309, mean p set: 0.45431381464004517
loss_pred:0.02503035217523575, decouple_loss:0.010927285999059677loss_pred:0.02628803439438343, decouple_loss:0.010712970048189163
loss_pred:0.025649217888712883, decouple_loss:0.011373840272426605
Iteration: 239, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511702358722687, gen p mean: -0.7509598135948181, mean p set: 0.4516505002975464
The modified gen p mean: 0.4497024118900299, gen p mean: -0.7363532781600952, mean p set: 0.45018270611763
The modified gen p mean: 0.4532493054866791, gen p mean: -0.7482088804244995, mean p set: 0.4537295699119568
loss_pred:0.025216542184352875, decouple_loss:0.010800101794302464
loss_pred:0.025116322562098503, decouple_loss:0.011031354777514935
loss_pred:0.025165444239974022, decouple_loss:0.011244075372815132
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012002_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012002_3_24hr.npz
NaN value num: 0
Iteration: 240, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44649532437324524, gen p mean: -0.7477822303771973, mean p set: 0.44697561860084534
The modified gen p mean: 0.44767042994499207, gen p mean: -0.7475719451904297, mean p set: 0.44815075397491455
The modified gen p mean: 0.44619378447532654, gen p mean: -0.7355827689170837, mean p set: 0.446674108505249
loss_pred:0.02664184384047985, decouple_loss:0.012442100793123245
loss_pred:0.026798835024237633, decouple_loss:0.012236373499035835
loss_pred:0.02674373798072338, decouple_loss:0.012536107562482357
2023-05-05 15:59:46 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.725921630859375, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7131795287132263, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.717944324016571, mean p set: 0.4500633478164673
loss_pred:0.028110234066843987, decouple_loss:0.012067211791872978
loss_pred:0.026581160724163055, decouple_loss:0.01213864516466856
loss_pred:0.027074072510004044, decouple_loss:0.011696240864694118
WV_0_PC_1_EH_0_PS_40_6, loss: 0.027853524312376976, avg_mse: 0.03320317342877388
current test mse: 0.033203
Iteration: 241, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44580021500587463, gen p mean: -0.7151337265968323, mean p set: 0.44628050923347473
The modified gen p mean: 0.4477980136871338, gen p mean: -0.7208895087242126, mean p set: 0.4482783079147339
loss_pred:0.026900464668869972, decouple_loss:0.012263800017535686
loss_pred:0.026191415265202522, decouple_loss:0.01177300326526165
The modified gen p mean: 0.4459373950958252, gen p mean: -0.728334903717041, mean p set: 0.4464176893234253
loss_pred:0.02615075744688511, decouple_loss:0.011947421357035637
Iteration: 242, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467082917690277, gen p mean: -0.7197179198265076, mean p set: 0.4471885859966278
The modified gen p mean: 0.4478931725025177, gen p mean: -0.7120752334594727, mean p set: 0.4483734667301178
loss_pred:0.027175555005669594, decouple_loss:0.01175349485129118
loss_pred:0.026502229273319244, decouple_loss:0.011492263525724411
The modified gen p mean: 0.4465922713279724, gen p mean: -0.7139617800712585, mean p set: 0.4470725357532501
loss_pred:0.02807912975549698, decouple_loss:0.011753949336707592
Iteration: 243, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44953835010528564, gen p mean: -0.7270526885986328, mean p set: 0.45001867413520813
The modified gen p mean: 0.4462195634841919, gen p mean: -0.7266820073127747, mean p set: 0.4466998875141144
The modified gen p mean: 0.44678986072540283, gen p mean: -0.7317714095115662, mean p set: 0.44727015495300293
loss_pred:0.027059439569711685, decouple_loss:0.01151992380619049
loss_pred:0.02722080424427986, decouple_loss:0.011468264274299145
loss_pred:0.026714613661170006, decouple_loss:0.011729533784091473
Iteration: 244, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487651586532593, gen p mean: -0.7444153428077698, mean p set: 0.4492454528808594
The modified gen p mean: 0.4460824728012085, gen p mean: -0.7455940246582031, mean p set: 0.446562796831131
The modified gen p mean: 0.44572097063064575, gen p mean: -0.7325261235237122, mean p set: 0.44620129466056824
loss_pred:0.02702052891254425, decouple_loss:0.010990726761519909
loss_pred:0.02704818733036518, decouple_loss:0.010849252343177795
loss_pred:0.026290643960237503, decouple_loss:0.011601688340306282
Iteration: 245, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44587406516075134, gen p mean: -0.751661479473114, mean p set: 0.44635435938835144
The modified gen p mean: 0.4469471573829651, gen p mean: -0.7594881653785706, mean p set: 0.4474274814128876
The modified gen p mean: 0.4461632966995239, gen p mean: -0.7384047508239746, mean p set: 0.446643590927124
loss_pred:0.025669945403933525, decouple_loss:0.010529322549700737
loss_pred:0.026202740147709846, decouple_loss:0.01152685098350048
loss_pred:0.0265666414052248, decouple_loss:0.010865000076591969
Iteration: 246, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44654712080955505, gen p mean: -0.7416119575500488, mean p set: 0.44702741503715515
The modified gen p mean: 0.4463620185852051, gen p mean: -0.7308157086372375, mean p set: 0.4468423128128052
loss_pred:0.025766920298337936, decouple_loss:0.010873069055378437
loss_pred:0.02691987343132496, decouple_loss:0.01113377045840025
The modified gen p mean: 0.4467291533946991, gen p mean: -0.7375304698944092, mean p set: 0.4472094774246216
loss_pred:0.025574130937457085, decouple_loss:0.010799119248986244
Iteration: 247, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44690144062042236, gen p mean: -0.7369523048400879, mean p set: 0.44738173484802246
The modified gen p mean: 0.44711974263191223, gen p mean: -0.7383951544761658, mean p set: 0.44760003685951233
The modified gen p mean: 0.44691091775894165, gen p mean: -0.7352800369262695, mean p set: 0.44739121198654175
loss_pred:0.02703861892223358, decouple_loss:0.011040754616260529
loss_pred:0.02638726867735386, decouple_loss:0.010872898623347282
loss_pred:0.027649465948343277, decouple_loss:0.010862414725124836
Iteration: 248, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473472237586975, gen p mean: -0.7378217577934265, mean p set: 0.4478275179862976
The modified gen p mean: 0.44695520401000977, gen p mean: -0.731733500957489, mean p set: 0.44743549823760986
The modified gen p mean: 0.44660159945487976, gen p mean: -0.7403325438499451, mean p set: 0.44708189368247986
loss_pred:0.026792127639055252, decouple_loss:0.01026475615799427
loss_pred:0.027466289699077606, decouple_loss:0.010928848758339882
loss_pred:0.02701418660581112, decouple_loss:0.010448900051414967
Iteration: 249, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44585978984832764, gen p mean: -0.7438114881515503, mean p set: 0.44634005427360535
The modified gen p mean: 0.44681331515312195, gen p mean: -0.7431893348693848, mean p set: 0.44729360938072205
The modified gen p mean: 0.44780677556991577, gen p mean: -0.7481311559677124, mean p set: 0.4482870399951935
loss_pred:0.02715468592941761, decouple_loss:0.010745975188910961
loss_pred:0.026739148423075676, decouple_loss:0.01109238713979721
loss_pred:0.025926979258656502, decouple_loss:0.01077207364141941
Iteration: 250, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44604259729385376, gen p mean: -0.7348049879074097, mean p set: 0.44652286171913147
The modified gen p mean: 0.4496762752532959, gen p mean: -0.7355412840843201, mean p set: 0.4501565396785736
The modified gen p mean: 0.44663169980049133, gen p mean: -0.7390698790550232, mean p set: 0.44711199402809143
loss_pred:0.026641884818673134, decouple_loss:0.010907002724707127
loss_pred:0.02710970677435398, decouple_loss:0.01098687294870615
loss_pred:0.027332285419106483, decouple_loss:0.010548715479671955
2023-05-05 16:03:24 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.732314944267273, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7198240160942078, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.7247954607009888, mean p set: 0.4500633478164673
loss_pred:0.027915295213460922, decouple_loss:0.011951588094234467
loss_pred:0.026578368619084358, decouple_loss:0.011978077702224255
loss_pred:0.026875795796513557, decouple_loss:0.011528614908456802
WV_0_PC_1_EH_0_PS_40_6, loss: 0.02771412394940853, avg_mse: 0.03292756900191307
current test mse: 0.032928
Iteration: 251, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44606515765190125, gen p mean: -0.7244338989257812, mean p set: 0.44654545187950134
The modified gen p mean: 0.4475174844264984, gen p mean: -0.7357097268104553, mean p set: 0.4479977488517761
loss_pred:0.02762402780354023, decouple_loss:0.010926008224487305
loss_pred:0.026341915130615234, decouple_loss:0.01052478700876236
The modified gen p mean: 0.44877082109451294, gen p mean: -0.7238444089889526, mean p set: 0.44925111532211304
loss_pred:0.026544062420725822, decouple_loss:0.011142199859023094
Iteration: 252, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44721871614456177, gen p mean: -0.7346966862678528, mean p set: 0.4476989805698395
The modified gen p mean: 0.4457029104232788, gen p mean: -0.721025824546814, mean p set: 0.4461832046508789
The modified gen p mean: 0.44694703817367554, gen p mean: -0.7313873171806335, mean p set: 0.44742733240127563
loss_pred:0.027176525443792343, decouple_loss:0.010863195173442364
loss_pred:0.026477815583348274, decouple_loss:0.011297032237052917
loss_pred:0.027161860838532448, decouple_loss:0.010443727485835552
Iteration: 253, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488300383090973, gen p mean: -0.7417466044425964, mean p set: 0.4493103623390198
The modified gen p mean: 0.44906169176101685, gen p mean: -0.7419337630271912, mean p set: 0.44954198598861694
The modified gen p mean: 0.44829386472702026, gen p mean: -0.7465186715126038, mean p set: 0.448774129152298
loss_pred:0.02599489502608776, decouple_loss:0.011033172719180584
loss_pred:0.026733823120594025, decouple_loss:0.011298864148557186
loss_pred:0.027185676619410515, decouple_loss:0.01153048500418663
Iteration: 254, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44793158769607544, gen p mean: -0.7350435853004456, mean p set: 0.44841188192367554
The modified gen p mean: 0.4463766813278198, gen p mean: -0.7251971960067749, mean p set: 0.4468569755554199
The modified gen p mean: 0.4470807611942291, gen p mean: -0.7451013326644897, mean p set: 0.4475610554218292
loss_pred:0.026334481313824654, decouple_loss:0.010613581165671349
loss_pred:0.02649150788784027, decouple_loss:0.011025385931134224
loss_pred:0.02609064243733883, decouple_loss:0.010889513418078423
Iteration: 255, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44631367921829224, gen p mean: -0.7172444462776184, mean p set: 0.44679397344589233
The modified gen p mean: 0.44721418619155884, gen p mean: -0.7407100796699524, mean p set: 0.44769448041915894
The modified gen p mean: 0.44563642144203186, gen p mean: -0.7127171754837036, mean p set: 0.44611674547195435
loss_pred:0.02668704092502594, decouple_loss:0.011345900595188141
loss_pred:0.028165945783257484, decouple_loss:0.010458815842866898
loss_pred:0.026214933022856712, decouple_loss:0.010937558487057686
Iteration: 256, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44630497694015503, gen p mean: -0.7205986380577087, mean p set: 0.44678524136543274
The modified gen p mean: 0.44560834765434265, gen p mean: -0.7267990112304688, mean p set: 0.44608867168426514
loss_pred:0.025834379717707634, decouple_loss:0.010553569532930851
loss_pred:0.027269240468740463, decouple_loss:0.010670422576367855
The modified gen p mean: 0.4471961259841919, gen p mean: -0.7288951873779297, mean p set: 0.447676420211792
loss_pred:0.02756466530263424, decouple_loss:0.010811500251293182
Iteration: 257, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464660584926605, gen p mean: -0.7182806134223938, mean p set: 0.446946382522583
The modified gen p mean: 0.4472074508666992, gen p mean: -0.7299125790596008, mean p set: 0.4476877748966217
The modified gen p mean: 0.4463149309158325, gen p mean: -0.7390891313552856, mean p set: 0.44679519534111023
loss_pred:0.02699371986091137, decouple_loss:0.010879665613174438
loss_pred:0.026614731177687645, decouple_loss:0.01034939382225275
loss_pred:0.025903308764100075, decouple_loss:0.010418212041258812
Iteration: 258, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44848331809043884, gen p mean: -0.736796498298645, mean p set: 0.44896358251571655
The modified gen p mean: 0.44572705030441284, gen p mean: -0.7372919917106628, mean p set: 0.44620731472969055
The modified gen p mean: 0.447654664516449, gen p mean: -0.74763423204422, mean p set: 0.4481349289417267
loss_pred:0.026149043813347816, decouple_loss:0.010892516002058983
loss_pred:0.02722240425646305, decouple_loss:0.010541577823460102
loss_pred:0.026957500725984573, decouple_loss:0.010877671651542187
Iteration: 259, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4457554519176483, gen p mean: -0.723130464553833, mean p set: 0.4462357461452484
The modified gen p mean: 0.44687435030937195, gen p mean: -0.7470310926437378, mean p set: 0.44735464453697205
The modified gen p mean: 0.44861599802970886, gen p mean: -0.7417641282081604, mean p set: 0.44909629225730896
loss_pred:0.026540687307715416, decouple_loss:0.009982770308852196
loss_pred:0.025739924982190132, decouple_loss:0.01054569985717535
loss_pred:0.027491232380270958, decouple_loss:0.010275796055793762
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012011_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012011_3_24hr.npz
NaN value num: 0
Iteration: 260, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4459937512874603, gen p mean: -0.7361322641372681, mean p set: 0.44647401571273804
The modified gen p mean: 0.4475928544998169, gen p mean: -0.7519450783729553, mean p set: 0.448073148727417
The modified gen p mean: 0.44677528738975525, gen p mean: -0.7441082000732422, mean p set: 0.44725558161735535
loss_pred:0.027029534801840782, decouple_loss:0.01145029067993164
loss_pred:0.027031676843762398, decouple_loss:0.01098719984292984
loss_pred:0.027658862993121147, decouple_loss:0.01143779419362545
2023-05-05 16:07:44 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.7447242736816406, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7335313558578491, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.7382886409759521, mean p set: 0.4500633478164673
loss_pred:0.027957353740930557, decouple_loss:0.011081285774707794
loss_pred:0.026400497183203697, decouple_loss:0.010924259200692177
loss_pred:0.02675323560833931, decouple_loss:0.01073199138045311
WV_0_PC_1_EH_0_PS_40_6, loss: 0.02758265659213066, avg_mse: 0.032914452254772186
current test mse: 0.032914
Iteration: 261, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44603100419044495, gen p mean: -0.7440440058708191, mean p set: 0.44651132822036743
The modified gen p mean: 0.4473292827606201, gen p mean: -0.7406192421913147, mean p set: 0.4478095471858978
loss_pred:0.027622561901807785, decouple_loss:0.010852904058992863
loss_pred:0.026274774223566055, decouple_loss:0.01136092934757471
The modified gen p mean: 0.4468863010406494, gen p mean: -0.7412567734718323, mean p set: 0.4473665952682495
loss_pred:0.026897111907601357, decouple_loss:0.011180927976965904
Iteration: 262, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44667911529541016, gen p mean: -0.7261115312576294, mean p set: 0.44715940952301025
The modified gen p mean: 0.44904765486717224, gen p mean: -0.7436262369155884, mean p set: 0.44952791929244995
The modified gen p mean: 0.44609498977661133, gen p mean: -0.7331978678703308, mean p set: 0.4465752840042114
loss_pred:0.027501696720719337, decouple_loss:0.011069049127399921
loss_pred:0.02650574967265129, decouple_loss:0.011478173546493053
loss_pred:0.027181683108210564, decouple_loss:0.010591980069875717
Iteration: 263, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44734594225883484, gen p mean: -0.7241305112838745, mean p set: 0.44782623648643494
The modified gen p mean: 0.44751569628715515, gen p mean: -0.7218316793441772, mean p set: 0.44799599051475525
loss_pred:0.026549968868494034, decouple_loss:0.010911054909229279
loss_pred:0.025922970846295357, decouple_loss:0.010929493233561516
The modified gen p mean: 0.4488367438316345, gen p mean: -0.7381404042243958, mean p set: 0.44931700825691223
loss_pred:0.026370609179139137, decouple_loss:0.011469829827547073
Iteration: 264, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472138583660126, gen p mean: -0.7235779762268066, mean p set: 0.4476941227912903
The modified gen p mean: 0.44646894931793213, gen p mean: -0.7305278778076172, mean p set: 0.44694921374320984
The modified gen p mean: 0.44817230105400085, gen p mean: -0.7334447503089905, mean p set: 0.44865259528160095
loss_pred:0.026964131742715836, decouple_loss:0.010692873038351536
loss_pred:0.026815567165613174, decouple_loss:0.010398619808256626
loss_pred:0.025944970548152924, decouple_loss:0.01072336919605732
Iteration: 265, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44810667634010315, gen p mean: -0.7356594800949097, mean p set: 0.44858697056770325
The modified gen p mean: 0.4481782019138336, gen p mean: -0.7320746183395386, mean p set: 0.4486584961414337
loss_pred:0.026556100696325302, decouple_loss:0.01062160823494196
loss_pred:0.026180662214756012, decouple_loss:0.01043692883104086
The modified gen p mean: 0.4464486539363861, gen p mean: -0.7361593842506409, mean p set: 0.4469289183616638
loss_pred:0.025898786261677742, decouple_loss:0.010776706971228123
Iteration: 266, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4458253085613251, gen p mean: -0.724287211894989, mean p set: 0.44630563259124756
The modified gen p mean: 0.4466908872127533, gen p mean: -0.7294127345085144, mean p set: 0.4471711814403534
The modified gen p mean: 0.44739651679992676, gen p mean: -0.7202903628349304, mean p set: 0.44787678122520447
loss_pred:0.02642057090997696, decouple_loss:0.01049056090414524loss_pred:0.026033170521259308, decouple_loss:0.01071217842400074
loss_pred:0.026894599199295044, decouple_loss:0.010738632641732693
Iteration: 267, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472636580467224, gen p mean: -0.7181087136268616, mean p set: 0.4477439522743225
The modified gen p mean: 0.44885823130607605, gen p mean: -0.733337938785553, mean p set: 0.44933852553367615
The modified gen p mean: 0.44710493087768555, gen p mean: -0.7212542295455933, mean p set: 0.44758522510528564
loss_pred:0.026219023391604424, decouple_loss:0.01049130130559206
loss_pred:0.027355436235666275, decouple_loss:0.0112367058172822
loss_pred:0.026406479999423027, decouple_loss:0.0100662587210536
Iteration: 268, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468235969543457, gen p mean: -0.7179903388023376, mean p set: 0.4473038911819458
The modified gen p mean: 0.44704753160476685, gen p mean: -0.722988486289978, mean p set: 0.44752782583236694
The modified gen p mean: 0.44632503390312195, gen p mean: -0.7202732563018799, mean p set: 0.44680535793304443
loss_pred:0.02617737650871277, decouple_loss:0.010621622204780579
loss_pred:0.027421770617365837, decouple_loss:0.010175375267863274
loss_pred:0.026215430349111557, decouple_loss:0.010108144022524357
Iteration: 269, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44582659006118774, gen p mean: -0.7256603240966797, mean p set: 0.44630685448646545
The modified gen p mean: 0.4456849694252014, gen p mean: -0.7243388295173645, mean p set: 0.4461652636528015
The modified gen p mean: 0.44820311665534973, gen p mean: -0.734790027141571, mean p set: 0.44868341088294983
loss_pred:0.02702604979276657, decouple_loss:0.010856256820261478
loss_pred:0.026804428547620773, decouple_loss:0.010537211783230305
loss_pred:0.026383861899375916, decouple_loss:0.010856461711227894
Iteration: 270, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44746023416519165, gen p mean: -0.7252678275108337, mean p set: 0.44794052839279175
The modified gen p mean: 0.4479667842388153, gen p mean: -0.7360712289810181, mean p set: 0.4484470784664154
The modified gen p mean: 0.44625359773635864, gen p mean: -0.7313724160194397, mean p set: 0.44673389196395874
loss_pred:0.025849802419543266, decouple_loss:0.010022045113146305
loss_pred:0.026189668104052544, decouple_loss:0.009599252603948116
loss_pred:0.026656312867999077, decouple_loss:0.010148401372134686
2023-05-05 16:11:23 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.7290621399879456, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.716280996799469, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.7216355800628662, mean p set: 0.4500633478164673
loss_pred:0.027630705386400223, decouple_loss:0.010146323591470718
loss_pred:0.0262728501111269, decouple_loss:0.010527134872972965
loss_pred:0.02652527205646038, decouple_loss:0.010088727809488773
WV_0_PC_1_EH_0_PS_40_6, loss: 0.0273223128169775, avg_mse: 0.03249707818031311
current test mse: 0.032497
Iteration: 271, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44525769352912903, gen p mean: -0.7295917272567749, mean p set: 0.44573795795440674
The modified gen p mean: 0.4474707841873169, gen p mean: -0.7228497862815857, mean p set: 0.447951078414917
loss_pred:0.02608775533735752, decouple_loss:0.010139214806258678
loss_pred:0.02644357644021511, decouple_loss:0.009755365550518036
The modified gen p mean: 0.44627127051353455, gen p mean: -0.7302583456039429, mean p set: 0.44675159454345703
loss_pred:0.026202967390418053, decouple_loss:0.009857895784080029
Iteration: 272, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44647493958473206, gen p mean: -0.7293022274971008, mean p set: 0.44695523381233215
The modified gen p mean: 0.4456796944141388, gen p mean: -0.7173442244529724, mean p set: 0.4461599588394165
The modified gen p mean: 0.4467123746871948, gen p mean: -0.7148986458778381, mean p set: 0.4471926689147949
loss_pred:0.02575715258717537, decouple_loss:0.009912928566336632
loss_pred:0.02623087167739868, decouple_loss:0.009915055707097054
loss_pred:0.02713189460337162, decouple_loss:0.009855840355157852
Iteration: 273, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4462599754333496, gen p mean: -0.7272644639015198, mean p set: 0.4467402696609497
The modified gen p mean: 0.4466208219528198, gen p mean: -0.7317164540290833, mean p set: 0.4471011161804199
The modified gen p mean: 0.44760069251060486, gen p mean: -0.725262463092804, mean p set: 0.44808098673820496
loss_pred:0.0271809920668602, decouple_loss:0.009720015339553356
loss_pred:0.026255637407302856, decouple_loss:0.009672372601926327
loss_pred:0.026498686522245407, decouple_loss:0.009795408695936203
Iteration: 274, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474453330039978, gen p mean: -0.7254711389541626, mean p set: 0.4479255974292755
The modified gen p mean: 0.44691959023475647, gen p mean: -0.7234387993812561, mean p set: 0.4473998546600342
The modified gen p mean: 0.4463035762310028, gen p mean: -0.7214242219924927, mean p set: 0.4467838406562805
loss_pred:0.027170708402991295, decouple_loss:0.009480471722781658
loss_pred:0.02650466375052929, decouple_loss:0.009311920963227749
loss_pred:0.026085862889885902, decouple_loss:0.009425004944205284
Iteration: 275, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44641295075416565, gen p mean: -0.721286416053772, mean p set: 0.44689324498176575
The modified gen p mean: 0.44620752334594727, gen p mean: -0.721560001373291, mean p set: 0.44668781757354736
The modified gen p mean: 0.448574036359787, gen p mean: -0.7376164197921753, mean p set: 0.4490543007850647
loss_pred:0.027804667130112648, decouple_loss:0.009244264103472233
loss_pred:0.027142014354467392, decouple_loss:0.00944147352129221
loss_pred:0.027346236631274223, decouple_loss:0.011200309731066227
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 276, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467659294605255, gen p mean: -0.7198989391326904, mean p set: 0.447246253490448
The modified gen p mean: 0.4459315538406372, gen p mean: -0.719323992729187, mean p set: 0.4464118480682373
The modified gen p mean: 0.4478110373020172, gen p mean: -0.7248462438583374, mean p set: 0.4482913017272949
loss_pred:0.026324301958084106, decouple_loss:0.00915701687335968
loss_pred:0.02710202895104885, decouple_loss:0.00917647872120142
loss_pred:0.02633398026227951, decouple_loss:0.00989292748272419
Iteration: 277, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4461469054222107, gen p mean: -0.7225924134254456, mean p set: 0.4466271698474884
The modified gen p mean: 0.4473477303981781, gen p mean: -0.7415409088134766, mean p set: 0.4478280544281006
The modified gen p mean: 0.44859594106674194, gen p mean: -0.7448363900184631, mean p set: 0.44907623529434204
loss_pred:0.026767844334244728, decouple_loss:0.009072542190551758
loss_pred:0.025830330327153206, decouple_loss:0.009453916922211647
loss_pred:0.02735469490289688, decouple_loss:0.01029916014522314
Iteration: 278, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483022689819336, gen p mean: -0.7453694939613342, mean p set: 0.4487825632095337
The modified gen p mean: 0.4468763768672943, gen p mean: -0.7370193004608154, mean p set: 0.4473566710948944
The modified gen p mean: 0.44664016366004944, gen p mean: -0.736591100692749, mean p set: 0.44712045788764954
loss_pred:0.026276685297489166, decouple_loss:0.010165832936763763
loss_pred:0.026097163558006287, decouple_loss:0.009384497068822384
loss_pred:0.026034686714410782, decouple_loss:0.009713719598948956
Iteration: 279, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4452895224094391, gen p mean: -0.7330679297447205, mean p set: 0.4457697868347168
The modified gen p mean: 0.44577547907829285, gen p mean: -0.7300896048545837, mean p set: 0.44625577330589294
The modified gen p mean: 0.44879674911499023, gen p mean: -0.7504408359527588, mean p set: 0.44927704334259033
loss_pred:0.025653716176748276, decouple_loss:0.009890273213386536
loss_pred:0.027178112417459488, decouple_loss:0.009040407836437225
loss_pred:0.02622484229505062, decouple_loss:0.009891043417155743
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012000_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012000_3_24hr.npz
NaN value num: 0
Iteration: 280, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469894468784332, gen p mean: -0.7323569059371948, mean p set: 0.4474697411060333
The modified gen p mean: 0.4470798075199127, gen p mean: -0.7338054776191711, mean p set: 0.4475601017475128
The modified gen p mean: 0.4454604387283325, gen p mean: -0.7299288511276245, mean p set: 0.44594070315361023
loss_pred:0.026658136397600174, decouple_loss:0.0096818245947361
loss_pred:0.025461403653025627, decouple_loss:0.009597198106348515
loss_pred:0.02590552158653736, decouple_loss:0.009333501569926739
2023-05-05 16:15:44 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.7344266176223755, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7270578742027283, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7220455408096313, mean p set: 0.45035696029663086
loss_pred:0.027534235268831253, decouple_loss:0.009701380506157875
loss_pred:0.026516199111938477, decouple_loss:0.009539168328046799
loss_pred:0.026297274976968765, decouple_loss:0.009951801039278507
WV_0_PC_1_EH_0_PS_40_6, loss: 0.027269108220934868, avg_mse: 0.03250976651906967
current test mse: 0.03251
Iteration: 281, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468916654586792, gen p mean: -0.7289745807647705, mean p set: 0.4473719894886017
The modified gen p mean: 0.4475764036178589, gen p mean: -0.7348127961158752, mean p set: 0.448056697845459
loss_pred:0.026637164875864983, decouple_loss:0.00923841167241335
loss_pred:0.02604147605597973, decouple_loss:0.009941890835762024
The modified gen p mean: 0.44655048847198486, gen p mean: -0.7290013432502747, mean p set: 0.44703078269958496
loss_pred:0.026653878390789032, decouple_loss:0.009494929574429989
Iteration: 282, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475334584712982, gen p mean: -0.7246643900871277, mean p set: 0.4480137526988983
The modified gen p mean: 0.44670218229293823, gen p mean: -0.7262555956840515, mean p set: 0.44718244671821594
The modified gen p mean: 0.4466875195503235, gen p mean: -0.7217957377433777, mean p set: 0.4471677839756012
loss_pred:0.026134593412280083, decouple_loss:0.009331846609711647
loss_pred:0.025711167603731155, decouple_loss:0.009283432736992836
loss_pred:0.026055147871375084, decouple_loss:0.009483846835792065
Iteration: 283, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446512371301651, gen p mean: -0.7245047092437744, mean p set: 0.4469926357269287
The modified gen p mean: 0.44827795028686523, gen p mean: -0.7257447242736816, mean p set: 0.44875821471214294
The modified gen p mean: 0.44797658920288086, gen p mean: -0.7275005578994751, mean p set: 0.44845691323280334
loss_pred:0.027037475258111954, decouple_loss:0.00885907281190157
loss_pred:0.027577564120292664, decouple_loss:0.009218345396220684
loss_pred:0.026882139965891838, decouple_loss:0.009299361146986485
Iteration: 284, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467405676841736, gen p mean: -0.7276674509048462, mean p set: 0.4472208023071289
The modified gen p mean: 0.44735249876976013, gen p mean: -0.7323344349861145, mean p set: 0.44783279299736023
The modified gen p mean: 0.44768601655960083, gen p mean: -0.7233849763870239, mean p set: 0.4481663107872009
loss_pred:0.025511575862765312, decouple_loss:0.009336239658296108
loss_pred:0.02593480609357357, decouple_loss:0.009493021294474602
loss_pred:0.026753336191177368, decouple_loss:0.00938302744179964
Iteration: 285, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44786643981933594, gen p mean: -0.7271877527236938, mean p set: 0.44834670424461365
The modified gen p mean: 0.4473969638347626, gen p mean: -0.7248793840408325, mean p set: 0.44787725806236267
The modified gen p mean: 0.44645535945892334, gen p mean: -0.7333915829658508, mean p set: 0.44693562388420105
loss_pred:0.026679102331399918, decouple_loss:0.008997423574328423
loss_pred:0.02666964754462242, decouple_loss:0.008908276446163654
loss_pred:0.025631748139858246, decouple_loss:0.009489893913269043
Iteration: 286, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44701990485191345, gen p mean: -0.7221561670303345, mean p set: 0.44750016927719116
The modified gen p mean: 0.44781818985939026, gen p mean: -0.7315661311149597, mean p set: 0.44829845428466797
The modified gen p mean: 0.4473675787448883, gen p mean: -0.7308662533760071, mean p set: 0.4478478729724884
loss_pred:0.025473248213529587, decouple_loss:0.008981510996818542
loss_pred:0.027077939361333847, decouple_loss:0.009147753939032555
loss_pred:0.025622138753533363, decouple_loss:0.008932523429393768
Iteration: 287, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446504682302475, gen p mean: -0.727551281452179, mean p set: 0.4469849467277527
The modified gen p mean: 0.44714266061782837, gen p mean: -0.7295427918434143, mean p set: 0.44762295484542847
The modified gen p mean: 0.4465515613555908, gen p mean: -0.7263638973236084, mean p set: 0.4470318555831909
loss_pred:0.025554761290550232, decouple_loss:0.009461486712098122
loss_pred:0.026101572439074516, decouple_loss:0.009491835720837116
loss_pred:0.025796957314014435, decouple_loss:0.00950996670871973
Iteration: 288, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44661250710487366, gen p mean: -0.7201352715492249, mean p set: 0.44709280133247375
The modified gen p mean: 0.44737595319747925, gen p mean: -0.7244787812232971, mean p set: 0.44785624742507935
The modified gen p mean: 0.44692403078079224, gen p mean: -0.7269377708435059, mean p set: 0.44740432500839233
loss_pred:0.026109883561730385, decouple_loss:0.008969374932348728
loss_pred:0.02536451816558838, decouple_loss:0.008905258029699326
loss_pred:0.02556668594479561, decouple_loss:0.009107653051614761
Iteration: 289, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44738298654556274, gen p mean: -0.7248846888542175, mean p set: 0.44786328077316284
The modified gen p mean: 0.4474863111972809, gen p mean: -0.7237061858177185, mean p set: 0.447966605424881
loss_pred:0.025303462520241737, decouple_loss:0.008782885037362576
loss_pred:0.025258341804146767, decouple_loss:0.009369243867695332
The modified gen p mean: 0.44697317481040955, gen p mean: -0.7156170606613159, mean p set: 0.44745346903800964
loss_pred:0.02670406363904476, decouple_loss:0.009210222400724888
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 290, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44644027948379517, gen p mean: -0.7356274127960205, mean p set: 0.44692057371139526
The modified gen p mean: 0.4458523094654083, gen p mean: -0.7343548536300659, mean p set: 0.4463326036930084
The modified gen p mean: 0.4470297396183014, gen p mean: -0.7335553765296936, mean p set: 0.4475100040435791
loss_pred:0.026454433798789978, decouple_loss:0.009718376211822033
loss_pred:0.025240182876586914, decouple_loss:0.009093382395803928
loss_pred:0.025491666048765182, decouple_loss:0.009151042439043522
2023-05-05 16:19:23 testing...
The modified gen p mean: 0.44987666606903076, gen p mean: -0.719113290309906, mean p set: 0.45035696029663086
The modified gen p mean: 0.449788898229599, gen p mean: -0.7308263182640076, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830535888672, gen p mean: -0.7238476276397705, mean p set: 0.4500633478164673
loss_pred:0.02614322490990162, decouple_loss:0.009593111462891102
loss_pred:0.027512650936841965, decouple_loss:0.009839008562266827
loss_pred:0.026449380442500114, decouple_loss:0.00949799083173275
WV_0_PC_1_EH_0_PS_40_6, loss: 0.02718392014503479, avg_mse: 0.0323653407394886
current test mse: 0.032365
Iteration: 291, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466387629508972, gen p mean: -0.7286492586135864, mean p set: 0.4471190571784973
The modified gen p mean: 0.44633227586746216, gen p mean: -0.7271426916122437, mean p set: 0.44681257009506226
loss_pred:0.025430869311094284, decouple_loss:0.008987759239971638
loss_pred:0.025456050410866737, decouple_loss:0.009295137599110603
The modified gen p mean: 0.44717806577682495, gen p mean: -0.72861647605896, mean p set: 0.44765836000442505
loss_pred:0.02628430165350437, decouple_loss:0.00947345420718193
Iteration: 292, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466509521007538, gen p mean: -0.7254729866981506, mean p set: 0.4471312463283539
The modified gen p mean: 0.4472388029098511, gen p mean: -0.7219216227531433, mean p set: 0.44771912693977356
The modified gen p mean: 0.4470362365245819, gen p mean: -0.7116864323616028, mean p set: 0.447516530752182
loss_pred:0.02621498703956604, decouple_loss:0.009397247806191444
loss_pred:0.02549063228070736, decouple_loss:0.009046200662851334
loss_pred:0.026860423386096954, decouple_loss:0.009273218922317028
Iteration: 293, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44641056656837463, gen p mean: -0.722762942314148, mean p set: 0.4468908905982971
The modified gen p mean: 0.4461483955383301, gen p mean: -0.7165722846984863, mean p set: 0.4466286599636078
The modified gen p mean: 0.44925034046173096, gen p mean: -0.7225779891014099, mean p set: 0.44973060488700867
loss_pred:0.02551795355975628, decouple_loss:0.008708029985427856
loss_pred:0.025204529985785484, decouple_loss:0.009621442295610905
loss_pred:0.02544606477022171, decouple_loss:0.009596605785191059
Iteration: 294, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471035897731781, gen p mean: -0.7212910652160645, mean p set: 0.4475838840007782
The modified gen p mean: 0.44876816868782043, gen p mean: -0.7230832576751709, mean p set: 0.44924843311309814
The modified gen p mean: 0.44630932807922363, gen p mean: -0.7210059762001038, mean p set: 0.44678959250450134
loss_pred:0.02577407844364643, decouple_loss:0.008938855491578579
loss_pred:0.025944724678993225, decouple_loss:0.009008358232676983
loss_pred:0.02537902072072029, decouple_loss:0.00915804598480463
Iteration: 295, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478625953197479, gen p mean: -0.7262740135192871, mean p set: 0.44834285974502563
The modified gen p mean: 0.44815972447395325, gen p mean: -0.7203056216239929, mean p set: 0.44864004850387573
The modified gen p mean: 0.44827088713645935, gen p mean: -0.7196882367134094, mean p set: 0.44875115156173706
loss_pred:0.026289833709597588, decouple_loss:0.009380736388266087
loss_pred:0.026638520881533623, decouple_loss:0.009350859560072422
loss_pred:0.02675596810877323, decouple_loss:0.009376417845487595
Iteration: 296, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469175338745117, gen p mean: -0.7294031381607056, mean p set: 0.44739779829978943
The modified gen p mean: 0.4480457603931427, gen p mean: -0.7259778380393982, mean p set: 0.4485260546207428
The modified gen p mean: 0.447671502828598, gen p mean: -0.7259751558303833, mean p set: 0.44815176725387573
loss_pred:0.025854861363768578, decouple_loss:0.009495768696069717
loss_pred:0.026754453778266907, decouple_loss:0.009378323331475258
loss_pred:0.02562100440263748, decouple_loss:0.00883993599563837
Iteration: 297, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446135550737381, gen p mean: -0.7199934124946594, mean p set: 0.4466158449649811
The modified gen p mean: 0.44916799664497375, gen p mean: -0.7311601638793945, mean p set: 0.44964826107025146
The modified gen p mean: 0.44767534732818604, gen p mean: -0.7269373536109924, mean p set: 0.4481556713581085
loss_pred:0.02547639235854149, decouple_loss:0.009056760929524899
loss_pred:0.025510624051094055, decouple_loss:0.008639082312583923
loss_pred:0.026040080934762955, decouple_loss:0.009164378978312016
Iteration: 298, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44839704036712646, gen p mean: -0.7282280921936035, mean p set: 0.44887736439704895
The modified gen p mean: 0.4455268383026123, gen p mean: -0.7214792966842651, mean p set: 0.44600710272789
The modified gen p mean: 0.4468054175376892, gen p mean: -0.7278712391853333, mean p set: 0.4472857117652893
loss_pred:0.02632095292210579, decouple_loss:0.009255791082978249
loss_pred:0.026666760444641113, decouple_loss:0.009203017689287663
loss_pred:0.025278879329562187, decouple_loss:0.009317081421613693
Iteration: 299, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44729188084602356, gen p mean: -0.7248625755310059, mean p set: 0.44777220487594604
The modified gen p mean: 0.4487743079662323, gen p mean: -0.7284954190254211, mean p set: 0.4492546021938324
The modified gen p mean: 0.44844359159469604, gen p mean: -0.7295207977294922, mean p set: 0.44892388582229614
loss_pred:0.02581586316227913, decouple_loss:0.009219978004693985
loss_pred:0.025378962978720665, decouple_loss:0.008983137086033821
loss_pred:0.027427488937973976, decouple_loss:0.009297654964029789
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012012_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012012_3_24hr.npz
NaN value num: 0
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 300, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471133053302765, gen p mean: -0.7279912829399109, mean p set: 0.447593629360199
The modified gen p mean: 0.4471959173679352, gen p mean: -0.7272047996520996, mean p set: 0.4476762115955353
The modified gen p mean: 0.4460238218307495, gen p mean: -0.7215682864189148, mean p set: 0.446504145860672
loss_pred:0.025507858023047447, decouple_loss:0.009353043511509895
loss_pred:0.026474785059690475, decouple_loss:0.009123180992901325
loss_pred:0.02584598958492279, decouple_loss:0.008572272956371307
2023-05-05 16:23:50 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.7341049313545227, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7222489714622498, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.7268625497817993, mean p set: 0.4500633478164673
loss_pred:0.027440672740340233, decouple_loss:0.009306374937295914
loss_pred:0.026124833151698112, decouple_loss:0.009328767657279968
loss_pred:0.02628985419869423, decouple_loss:0.00937119871377945
WV_0_PC_1_EH_0_PS_40_6, loss: 0.02708522602915764, avg_mse: 0.03223637863993645
current test mse: 0.032236
Iteration: 301, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476472735404968, gen p mean: -0.7230281829833984, mean p set: 0.4481275677680969
loss_pred:0.02652854472398758, decouple_loss:0.009160651825368404
The modified gen p mean: 0.44653892517089844, gen p mean: -0.7274630665779114, mean p set: 0.44701918959617615
loss_pred:0.026622677221894264, decouple_loss:0.009613219648599625
The modified gen p mean: 0.44617095589637756, gen p mean: -0.725019633769989, mean p set: 0.4466512203216553
loss_pred:0.02738484926521778, decouple_loss:0.008906936272978783
Iteration: 302, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44808536767959595, gen p mean: -0.7391172051429749, mean p set: 0.44856566190719604
The modified gen p mean: 0.44882553815841675, gen p mean: -0.7359955906867981, mean p set: 0.44930580258369446
loss_pred:0.02571788989007473, decouple_loss:0.009211509488523006
loss_pred:0.026043768972158432, decouple_loss:0.009266511537134647
The modified gen p mean: 0.4478234350681305, gen p mean: -0.7418907284736633, mean p set: 0.4483036994934082
loss_pred:0.025435438379645348, decouple_loss:0.009410920552909374
Iteration: 303, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465855062007904, gen p mean: -0.7170373201370239, mean p set: 0.4470658302307129
The modified gen p mean: 0.4460639953613281, gen p mean: -0.7152297496795654, mean p set: 0.4465442895889282
The modified gen p mean: 0.4469561278820038, gen p mean: -0.732570230960846, mean p set: 0.4474363923072815
loss_pred:0.027273006737232208, decouple_loss:0.009023378603160381
loss_pred:0.026210399344563484, decouple_loss:0.009032291360199451
loss_pred:0.02600184641778469, decouple_loss:0.009231538511812687
Iteration: 304, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484224021434784, gen p mean: -0.7275418639183044, mean p set: 0.4489026963710785
The modified gen p mean: 0.446443647146225, gen p mean: -0.7173511385917664, mean p set: 0.44692397117614746
The modified gen p mean: 0.4469093978404999, gen p mean: -0.7190538644790649, mean p set: 0.44738972187042236
loss_pred:0.02564443089067936, decouple_loss:0.00924282893538475
loss_pred:0.026286708191037178, decouple_loss:0.008937072940170765
loss_pred:0.02692454122006893, decouple_loss:0.008962308056652546
Iteration: 305, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4459840953350067, gen p mean: -0.7200607657432556, mean p set: 0.4464643895626068
The modified gen p mean: 0.4473232924938202, gen p mean: -0.7312487959861755, mean p set: 0.4478035867214203
loss_pred:0.02690000645816326, decouple_loss:0.00856196228414774
loss_pred:0.026215076446533203, decouple_loss:0.008798773400485516
The modified gen p mean: 0.4469868242740631, gen p mean: -0.7278823852539062, mean p set: 0.4474670886993408
loss_pred:0.025562960654497147, decouple_loss:0.009224480018019676
Iteration: 306, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468006491661072, gen p mean: -0.723110020160675, mean p set: 0.4472809433937073
The modified gen p mean: 0.44771745800971985, gen p mean: -0.7329195737838745, mean p set: 0.44819772243499756
The modified gen p mean: 0.4468657076358795, gen p mean: -0.7394167184829712, mean p set: 0.4473459720611572
loss_pred:0.026524946093559265, decouple_loss:0.00867545511573553
loss_pred:0.02743990533053875, decouple_loss:0.008795501664280891
loss_pred:0.02613316848874092, decouple_loss:0.0089933006092906
Iteration: 307, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470537006855011, gen p mean: -0.729877233505249, mean p set: 0.4475339949131012The modified gen p mean: 0.4469716250896454, gen p mean: -0.723304808139801, mean p set: 0.4474518895149231
The modified gen p mean: 0.4473579227924347, gen p mean: -0.7355449795722961, mean p set: 0.4478381872177124
loss_pred:0.026130592450499535, decouple_loss:0.008676135912537575loss_pred:0.026538578793406487, decouple_loss:0.009090310893952847
loss_pred:0.025825945660471916, decouple_loss:0.008918441832065582
Iteration: 308, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44652092456817627, gen p mean: -0.7201441526412964, mean p set: 0.44700121879577637
The modified gen p mean: 0.44683942198753357, gen p mean: -0.7206690907478333, mean p set: 0.44731974601745605
The modified gen p mean: 0.44603610038757324, gen p mean: -0.7172807455062866, mean p set: 0.44651639461517334
loss_pred:0.02594028413295746, decouple_loss:0.009312487207353115
loss_pred:0.025588318705558777, decouple_loss:0.008927037008106709
loss_pred:0.02652193047106266, decouple_loss:0.00911166425794363
Iteration: 309, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4462994337081909, gen p mean: -0.7127791047096252, mean p set: 0.4467797577381134
The modified gen p mean: 0.44785264134407043, gen p mean: -0.7199563384056091, mean p set: 0.44833290576934814
The modified gen p mean: 0.44708251953125, gen p mean: -0.7187820076942444, mean p set: 0.4475627839565277
loss_pred:0.026057710871100426, decouple_loss:0.008840723894536495
loss_pred:0.026070205494761467, decouple_loss:0.008698412217199802
loss_pred:0.02467452734708786, decouple_loss:0.00855141319334507
Iteration: 310, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478108584880829, gen p mean: -0.7204916477203369, mean p set: 0.44829118251800537
The modified gen p mean: 0.4458525478839874, gen p mean: -0.7209814786911011, mean p set: 0.4463328719139099
The modified gen p mean: 0.4471782445907593, gen p mean: -0.7246648669242859, mean p set: 0.4476585388183594
loss_pred:0.02633598819375038, decouple_loss:0.008677606470882893loss_pred:0.02659887820482254, decouple_loss:0.008573771454393864
loss_pred:0.026042599231004715, decouple_loss:0.00878897961229086
2023-05-05 16:27:33 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.7415370345115662, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7296136021614075, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.7339543700218201, mean p set: 0.4500633478164673
loss_pred:0.02727048471570015, decouple_loss:0.009490089491009712
loss_pred:0.026022592559456825, decouple_loss:0.009135999716818333
loss_pred:0.026250530034303665, decouple_loss:0.009271392598748207
WV_0_PC_1_EH_0_PS_40_6, loss: 0.026979494839906693, avg_mse: 0.03210059553384781
current test mse: 0.032101
Iteration: 311, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470162093639374, gen p mean: -0.7284587621688843, mean p set: 0.4474965035915375
The modified gen p mean: 0.4468630850315094, gen p mean: -0.7305284738540649, mean p set: 0.4473433792591095
loss_pred:0.025683091953396797, decouple_loss:0.008550934493541718
loss_pred:0.02607233077287674, decouple_loss:0.008587947115302086
The modified gen p mean: 0.44625112414360046, gen p mean: -0.7289012670516968, mean p set: 0.44673141837120056
loss_pred:0.026894940063357353, decouple_loss:0.008665534667670727
Iteration: 312, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44733890891075134, gen p mean: -0.7501030564308167, mean p set: 0.44781920313835144
The modified gen p mean: 0.44735151529312134, gen p mean: -0.7389799952507019, mean p set: 0.44783177971839905
The modified gen p mean: 0.4468706548213959, gen p mean: -0.7348339557647705, mean p set: 0.44735097885131836
loss_pred:0.026314102113246918, decouple_loss:0.008859730325639248
loss_pred:0.026972083374857903, decouple_loss:0.008418666198849678
loss_pred:0.025840481743216515, decouple_loss:0.008538560010492802
Iteration: 313, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469614624977112, gen p mean: -0.7336145639419556, mean p set: 0.4474417567253113
The modified gen p mean: 0.44798222184181213, gen p mean: -0.7460373044013977, mean p set: 0.44846251606941223
The modified gen p mean: 0.4469147026538849, gen p mean: -0.7367399334907532, mean p set: 0.447394996881485
loss_pred:0.025894954800605774, decouple_loss:0.008573793806135654
loss_pred:0.02526197023689747, decouple_loss:0.008773144334554672
loss_pred:0.026033589616417885, decouple_loss:0.008474249392747879
Iteration: 314, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44724735617637634, gen p mean: -0.7300429344177246, mean p set: 0.44772762060165405
The modified gen p mean: 0.4468885660171509, gen p mean: -0.7248080372810364, mean p set: 0.447368860244751
The modified gen p mean: 0.44719478487968445, gen p mean: -0.727411687374115, mean p set: 0.44767507910728455
loss_pred:0.024862734600901604, decouple_loss:0.008722946047782898
loss_pred:0.02638915367424488, decouple_loss:0.008315417915582657
loss_pred:0.024972273036837578, decouple_loss:0.008937039412558079
Iteration: 315, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470779597759247, gen p mean: -0.7202416658401489, mean p set: 0.4475582242012024
The modified gen p mean: 0.44802191853523254, gen p mean: -0.7349948883056641, mean p set: 0.44850221276283264
The modified gen p mean: 0.4480898678302765, gen p mean: -0.7260662317276001, mean p set: 0.448570191860199
loss_pred:0.024999871850013733, decouple_loss:0.008751300163567066
loss_pred:0.025818563997745514, decouple_loss:0.009265881031751633
loss_pred:0.026469632983207703, decouple_loss:0.008250044658780098
Iteration: 316, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471054971218109, gen p mean: -0.7246765494346619, mean p set: 0.447585791349411The modified gen p mean: 0.4467621445655823, gen p mean: -0.726946234703064, mean p set: 0.44724246859550476
The modified gen p mean: 0.44709211587905884, gen p mean: -0.7378135323524475, mean p set: 0.4475724399089813
loss_pred:0.025553356856107712, decouple_loss:0.008380161598324776
loss_pred:0.026047075167298317, decouple_loss:0.008661738596856594
loss_pred:0.024998212233185768, decouple_loss:0.008680736646056175
Iteration: 317, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472261667251587, gen p mean: -0.7292144298553467, mean p set: 0.4477064609527588
The modified gen p mean: 0.44670340418815613, gen p mean: -0.7274081110954285, mean p set: 0.4471836984157562
The modified gen p mean: 0.4460422694683075, gen p mean: -0.7305076122283936, mean p set: 0.4465225338935852
loss_pred:0.02574918046593666, decouple_loss:0.008504193276166916
loss_pred:0.026188312098383904, decouple_loss:0.008521823212504387
loss_pred:0.02616707794368267, decouple_loss:0.008902224712073803
Iteration: 318, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44609978795051575, gen p mean: -0.7335798740386963, mean p set: 0.44658011198043823
The modified gen p mean: 0.4475112557411194, gen p mean: -0.7521349191665649, mean p set: 0.4479915201663971
The modified gen p mean: 0.4461408257484436, gen p mean: -0.7365709543228149, mean p set: 0.4466211497783661
loss_pred:0.02678038738667965, decouple_loss:0.008762038312852383
loss_pred:0.025528443977236748, decouple_loss:0.009141189977526665
loss_pred:0.026259498670697212, decouple_loss:0.0086496127769351
Iteration: 319, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44654273986816406, gen p mean: -0.7328171730041504, mean p set: 0.44702303409576416
The modified gen p mean: 0.44758936762809753, gen p mean: -0.7356514930725098, mean p set: 0.44806966185569763
The modified gen p mean: 0.44676193594932556, gen p mean: -0.7339083552360535, mean p set: 0.44724223017692566
loss_pred:0.02622845396399498, decouple_loss:0.008454905822873116
loss_pred:0.025710852816700935, decouple_loss:0.0084190359339118
loss_pred:0.026174508035182953, decouple_loss:0.008745701983571053
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012010_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012010_3_24hr.npz
NaN value num: 0
Iteration: 320, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492855370044708, gen p mean: -0.7318363189697266, mean p set: 0.44976580142974854
The modified gen p mean: 0.4506557881832123, gen p mean: -0.7329339981079102, mean p set: 0.45113611221313477
The modified gen p mean: 0.4481247663497925, gen p mean: -0.7249967455863953, mean p set: 0.4486050307750702
loss_pred:0.027286682277917862, decouple_loss:0.01201604399830103
loss_pred:0.026971615850925446, decouple_loss:0.010417954996228218
loss_pred:0.026796000078320503, decouple_loss:0.010798010975122452
2023-05-05 16:32:08 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.7336210608482361, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7264680862426758, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7217668890953064, mean p set: 0.45035696029663086
loss_pred:0.027378728613257408, decouple_loss:0.009709451347589493
loss_pred:0.026311242952942848, decouple_loss:0.009458757936954498
loss_pred:0.025991467759013176, decouple_loss:0.009426036849617958
WV_0_PC_1_EH_0_PS_40_6, loss: 0.02703705057501793, avg_mse: 0.032205190509557724
current test mse: 0.032205
Iteration: 321, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44929370284080505, gen p mean: -0.732742428779602, mean p set: 0.44977399706840515
The modified gen p mean: 0.44977709650993347, gen p mean: -0.7518109679222107, mean p set: 0.45025739073753357
loss_pred:0.026560356840491295, decouple_loss:0.010733178816735744
loss_pred:0.027598176151514053, decouple_loss:0.011440378613770008
The modified gen p mean: 0.4475676119327545, gen p mean: -0.7206820845603943, mean p set: 0.4480479061603546
loss_pred:0.026665957644581795, decouple_loss:0.01034656260162592
Iteration: 322, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496040344238281, gen p mean: -0.7382476329803467, mean p set: 0.4500843286514282
The modified gen p mean: 0.4521802067756653, gen p mean: -0.7492793202400208, mean p set: 0.4526605010032654
loss_pred:0.02728998102247715, decouple_loss:0.011398064903914928
loss_pred:0.026040012016892433, decouple_loss:0.011379237286746502
The modified gen p mean: 0.44807863235473633, gen p mean: -0.7174615859985352, mean p set: 0.44855889678001404
loss_pred:0.026643143966794014, decouple_loss:0.01098125334829092
Iteration: 323, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44999951124191284, gen p mean: -0.7309637665748596, mean p set: 0.45047977566719055
The modified gen p mean: 0.45168885588645935, gen p mean: -0.7399799823760986, mean p set: 0.45216912031173706
The modified gen p mean: 0.44956454634666443, gen p mean: -0.7397493720054626, mean p set: 0.4500448405742645
loss_pred:0.025367464870214462, decouple_loss:0.010520632378757
loss_pred:0.026124529540538788, decouple_loss:0.010976667515933514
loss_pred:0.02623753435909748, decouple_loss:0.010783535428345203
Iteration: 324, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4515502154827118, gen p mean: -0.7470476627349854, mean p set: 0.4520305097103119
The modified gen p mean: 0.44861117005348206, gen p mean: -0.739745020866394, mean p set: 0.44909143447875977
The modified gen p mean: 0.45008373260498047, gen p mean: -0.7508165836334229, mean p set: 0.45056405663490295
loss_pred:0.02485208958387375, decouple_loss:0.010585038922727108
loss_pred:0.026196828112006187, decouple_loss:0.01028208713978529
loss_pred:0.02692754566669464, decouple_loss:0.010725433938205242
Iteration: 325, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447336345911026, gen p mean: -0.725601851940155, mean p set: 0.4478166699409485
The modified gen p mean: 0.4491611123085022, gen p mean: -0.7416151762008667, mean p set: 0.4496413469314575
The modified gen p mean: 0.4513677656650543, gen p mean: -0.7495660185813904, mean p set: 0.4518480598926544
loss_pred:0.027420377358794212, decouple_loss:0.01095957774668932
loss_pred:0.027020888403058052, decouple_loss:0.01030366588383913
loss_pred:0.024695197120308876, decouple_loss:0.010331113822758198
Iteration: 326, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44873663783073425, gen p mean: -0.7215926647186279, mean p set: 0.44921693205833435
The modified gen p mean: 0.4508529603481293, gen p mean: -0.7335219979286194, mean p set: 0.45133325457572937
The modified gen p mean: 0.450407475233078, gen p mean: -0.7445744872093201, mean p set: 0.4508877694606781
loss_pred:0.026492122560739517, decouple_loss:0.010413630865514278
loss_pred:0.026409544050693512, decouple_loss:0.010888340882956982
loss_pred:0.02599300816655159, decouple_loss:0.011224624700844288
Iteration: 327, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499646723270416, gen p mean: -0.7233050465583801, mean p set: 0.4504449665546417
The modified gen p mean: 0.44971993565559387, gen p mean: -0.723255455493927, mean p set: 0.4502002000808716
The modified gen p mean: 0.4491357207298279, gen p mean: -0.7184749841690063, mean p set: 0.44961604475975037
loss_pred:0.026542704552412033, decouple_loss:0.010864227078855038loss_pred:0.026076413691043854, decouple_loss:0.010458013974130154
loss_pred:0.02580888941884041, decouple_loss:0.01036227960139513
Iteration: 328, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44835227727890015, gen p mean: -0.7139688730239868, mean p set: 0.44883257150650024
The modified gen p mean: 0.4471801221370697, gen p mean: -0.7054628729820251, mean p set: 0.4476604163646698
The modified gen p mean: 0.4491461515426636, gen p mean: -0.7175951600074768, mean p set: 0.44962644577026367
loss_pred:0.02556491829454899, decouple_loss:0.010894164443016052
loss_pred:0.027270633727312088, decouple_loss:0.010754430666565895
loss_pred:0.026535632088780403, decouple_loss:0.010202165693044662
Iteration: 329, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478659927845001, gen p mean: -0.7234803438186646, mean p set: 0.4483462870121002
The modified gen p mean: 0.45136386156082153, gen p mean: -0.7461733222007751, mean p set: 0.45184415578842163
The modified gen p mean: 0.4501053988933563, gen p mean: -0.7386547327041626, mean p set: 0.4505856931209564
loss_pred:0.026093309745192528, decouple_loss:0.01091354712843895
loss_pred:0.02514827251434326, decouple_loss:0.010665053501725197
loss_pred:0.025671599432826042, decouple_loss:0.010689583607017994
Iteration: 330, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44727784395217896, gen p mean: -0.7217605710029602, mean p set: 0.44775813817977905
The modified gen p mean: 0.4522785544395447, gen p mean: -0.7410332560539246, mean p set: 0.4527588486671448
The modified gen p mean: 0.4515320658683777, gen p mean: -0.7367897629737854, mean p set: 0.4520123302936554
loss_pred:0.025486139580607414, decouple_loss:0.010238908231258392
loss_pred:0.025301968678832054, decouple_loss:0.01050696149468422
loss_pred:0.025200774893164635, decouple_loss:0.010280926711857319
2023-05-05 16:35:45 testing...
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7131929397583008, mean p set: 0.45035696029663086
The modified gen p mean: 0.449788898229599, gen p mean: -0.7254016995429993, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830833911896, gen p mean: -0.71840900182724, mean p set: 0.4500633478164673
loss_pred:0.02653229795396328, decouple_loss:0.01097649335861206
loss_pred:0.027911126613616943, decouple_loss:0.01119223888963461
loss_pred:0.026823047548532486, decouple_loss:0.010887065902352333
WV_0_PC_1_EH_0_PS_40_6, loss: 0.027639754116535187, avg_mse: 0.03309878706932068
current test mse: 0.033099
Iteration: 331, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44730284810066223, gen p mean: -0.7081807255744934, mean p set: 0.44778314232826233
The modified gen p mean: 0.44969040155410767, gen p mean: -0.7156175971031189, mean p set: 0.45017069578170776
loss_pred:0.027361569926142693, decouple_loss:0.010623214766383171
loss_pred:0.026261743158102036, decouple_loss:0.010456141084432602
The modified gen p mean: 0.4500812888145447, gen p mean: -0.7182925939559937, mean p set: 0.4505615830421448
loss_pred:0.025637170299887657, decouple_loss:0.010782689787447453
Iteration: 332, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4510563313961029, gen p mean: -0.726509153842926, mean p set: 0.451536625623703
The modified gen p mean: 0.4483736455440521, gen p mean: -0.7077555060386658, mean p set: 0.44885390996932983
The modified gen p mean: 0.448701411485672, gen p mean: -0.7113235592842102, mean p set: 0.4491817057132721
loss_pred:0.02637244202196598, decouple_loss:0.01067895907908678
loss_pred:0.025203140452504158, decouple_loss:0.010931525379419327
loss_pred:0.025618072599172592, decouple_loss:0.010972782038152218
Iteration: 333, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45128297805786133, gen p mean: -0.7402820587158203, mean p set: 0.45176324248313904
The modified gen p mean: 0.4492734670639038, gen p mean: -0.7394680976867676, mean p set: 0.4497537314891815
The modified gen p mean: 0.44757890701293945, gen p mean: -0.7109631896018982, mean p set: 0.44805923104286194
loss_pred:0.02463468909263611, decouple_loss:0.010500662960112095
loss_pred:0.025982733815908432, decouple_loss:0.010640648193657398
loss_pred:0.02579723484814167, decouple_loss:0.010402273386716843
Iteration: 334, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486565887928009, gen p mean: -0.7268295884132385, mean p set: 0.449136883020401
The modified gen p mean: 0.44943326711654663, gen p mean: -0.7314061522483826, mean p set: 0.44991356134414673
The modified gen p mean: 0.44778576493263245, gen p mean: -0.7207596898078918, mean p set: 0.44826605916023254
loss_pred:0.02715003490447998, decouple_loss:0.010001584887504578
loss_pred:0.02622956782579422, decouple_loss:0.010014460422098637
loss_pred:0.02703205682337284, decouple_loss:0.009871439076960087
Iteration: 335, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44747841358184814, gen p mean: -0.7147484421730042, mean p set: 0.44795873761177063
The modified gen p mean: 0.448749303817749, gen p mean: -0.7167176604270935, mean p set: 0.4492295980453491
The modified gen p mean: 0.45009303092956543, gen p mean: -0.7303234338760376, mean p set: 0.45057329535484314
loss_pred:0.026889687404036522, decouple_loss:0.010230573825538158
loss_pred:0.026272054761648178, decouple_loss:0.009765774942934513
loss_pred:0.026797747239470482, decouple_loss:0.010322005487978458
Iteration: 336, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450541615486145, gen p mean: -0.7374966144561768, mean p set: 0.45102187991142273
The modified gen p mean: 0.45162808895111084, gen p mean: -0.7386452555656433, mean p set: 0.4521084129810333
The modified gen p mean: 0.44725048542022705, gen p mean: -0.7158864140510559, mean p set: 0.44773074984550476
loss_pred:0.02543807215988636, decouple_loss:0.009867679327726364
loss_pred:0.02599598653614521, decouple_loss:0.010235349647700787
loss_pred:0.02595028653740883, decouple_loss:0.00958714447915554
Iteration: 337, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44821226596832275, gen p mean: -0.7207379341125488, mean p set: 0.44869256019592285
The modified gen p mean: 0.4499530494213104, gen p mean: -0.7299123406410217, mean p set: 0.4504333436489105
The modified gen p mean: 0.44755303859710693, gen p mean: -0.7241666316986084, mean p set: 0.44803333282470703
loss_pred:0.02581738494336605, decouple_loss:0.01014808751642704
loss_pred:0.02481941320002079, decouple_loss:0.009933264926075935
loss_pred:0.025167910382151604, decouple_loss:0.009870906360447407
Iteration: 338, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45025697350502014, gen p mean: -0.7446398138999939, mean p set: 0.45073726773262024
The modified gen p mean: 0.45137128233909607, gen p mean: -0.7440834045410156, mean p set: 0.45185160636901855
loss_pred:0.025770502164959908, decouple_loss:0.010225431993603706
The modified gen p mean: 0.4498324692249298, gen p mean: -0.7418724894523621, mean p set: 0.4503127932548523
loss_pred:0.02662675641477108, decouple_loss:0.009862273000180721
loss_pred:0.024724891409277916, decouple_loss:0.009895479306578636
Iteration: 339, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502078592777252, gen p mean: -0.743765652179718, mean p set: 0.4506881833076477
The modified gen p mean: 0.45021939277648926, gen p mean: -0.7516565918922424, mean p set: 0.45069968700408936
The modified gen p mean: 0.44841107726097107, gen p mean: -0.7354119420051575, mean p set: 0.44889137148857117
loss_pred:0.02601424790918827, decouple_loss:0.009538378566503525
loss_pred:0.025082185864448547, decouple_loss:0.009883195161819458
loss_pred:0.026564747095108032, decouple_loss:0.009554583579301834
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012004_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012004_3_24hr.npz
NaN value num: 0
Iteration: 340, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44733601808547974, gen p mean: -0.736302375793457, mean p set: 0.44781628251075745
The modified gen p mean: 0.44812795519828796, gen p mean: -0.7392560243606567, mean p set: 0.44860827922821045
The modified gen p mean: 0.4476580023765564, gen p mean: -0.7279138565063477, mean p set: 0.4481382668018341
loss_pred:0.026605458930134773, decouple_loss:0.011195912025868893
loss_pred:0.02658764086663723, decouple_loss:0.011346131563186646
loss_pred:0.027701325714588165, decouple_loss:0.011388116516172886
2023-05-05 16:40:04 testing...
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7232567667961121, mean p set: 0.45035696029663086
The modified gen p mean: 0.449788898229599, gen p mean: -0.7352876663208008, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830535888672, gen p mean: -0.7283514142036438, mean p set: 0.4500633478164673
loss_pred:0.02620367519557476, decouple_loss:0.010463229380548
loss_pred:0.027725161984562874, decouple_loss:0.010518201626837254
loss_pred:0.02666076272726059, decouple_loss:0.010375918820500374
WV_0_PC_1_EH_0_PS_40_6, loss: 0.02738582156598568, avg_mse: 0.03278914839029312
current test mse: 0.032789
Iteration: 341, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44642502069473267, gen p mean: -0.7234847545623779, mean p set: 0.4469052851200104
The modified gen p mean: 0.44804468750953674, gen p mean: -0.7323985695838928, mean p set: 0.44852498173713684
loss_pred:0.026516400277614594, decouple_loss:0.010665546171367168
loss_pred:0.027252444997429848, decouple_loss:0.010787101462483406
The modified gen p mean: 0.4473423361778259, gen p mean: -0.7268826961517334, mean p set: 0.447822630405426
loss_pred:0.02616562321782112, decouple_loss:0.010585999116301537
Iteration: 342, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483368694782257, gen p mean: -0.7281990647315979, mean p set: 0.4488171935081482
The modified gen p mean: 0.4481574296951294, gen p mean: -0.734136164188385, mean p set: 0.4486377537250519
The modified gen p mean: 0.44772395491600037, gen p mean: -0.7278994917869568, mean p set: 0.44820424914360046
loss_pred:0.026232225820422173, decouple_loss:0.010033021681010723loss_pred:0.026781940832734108, decouple_loss:0.00995882973074913
loss_pred:0.02702898345887661, decouple_loss:0.010205063968896866
Iteration: 343, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44786497950553894, gen p mean: -0.7332794070243835, mean p set: 0.44834527373313904
The modified gen p mean: 0.4467615783214569, gen p mean: -0.7301704287528992, mean p set: 0.447241872549057
The modified gen p mean: 0.4466818571090698, gen p mean: -0.730589747428894, mean p set: 0.4471621811389923
loss_pred:0.027058931067585945, decouple_loss:0.010342277586460114
loss_pred:0.02684772200882435, decouple_loss:0.010095743462443352
loss_pred:0.026880670338869095, decouple_loss:0.010307254269719124
Iteration: 344, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470152258872986, gen p mean: -0.7302095890045166, mean p set: 0.4474954903125763
The modified gen p mean: 0.4486333727836609, gen p mean: -0.7344406247138977, mean p set: 0.449113667011261
The modified gen p mean: 0.44811680912971497, gen p mean: -0.7293733954429626, mean p set: 0.4485970735549927
loss_pred:0.027657639235258102, decouple_loss:0.010245999321341515
loss_pred:0.026807034388184547, decouple_loss:0.009837373159825802
loss_pred:0.025784336030483246, decouple_loss:0.00967369507998228
Iteration: 345, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4463234841823578, gen p mean: -0.7379357814788818, mean p set: 0.4468037486076355
The modified gen p mean: 0.44744789600372314, gen p mean: -0.7450674176216125, mean p set: 0.44792816042900085
The modified gen p mean: 0.4460369944572449, gen p mean: -0.7377859950065613, mean p set: 0.44651728868484497
loss_pred:0.026809800416231155, decouple_loss:0.009653196670114994
loss_pred:0.02587011642754078, decouple_loss:0.009975047782063484
loss_pred:0.025904618203639984, decouple_loss:0.010041150264441967
Iteration: 346, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44725462794303894, gen p mean: -0.7455283403396606, mean p set: 0.44773492217063904
The modified gen p mean: 0.4468432366847992, gen p mean: -0.7445297837257385, mean p set: 0.4473235309123993
loss_pred:0.026315392926335335, decouple_loss:0.009452865459024906
loss_pred:0.026854800060391426, decouple_loss:0.009559550322592258
The modified gen p mean: 0.4474705457687378, gen p mean: -0.7480199337005615, mean p set: 0.4479508101940155
loss_pred:0.026518026366829872, decouple_loss:0.009749775752425194
Iteration: 347, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44784218072891235, gen p mean: -0.7383798360824585, mean p set: 0.44832247495651245
The modified gen p mean: 0.4481970965862274, gen p mean: -0.7324952483177185, mean p set: 0.4486773908138275
The modified gen p mean: 0.44792696833610535, gen p mean: -0.7368692755699158, mean p set: 0.44840726256370544
loss_pred:0.02719929814338684, decouple_loss:0.009360703639686108
loss_pred:0.025928810238838196, decouple_loss:0.009341158904135227
loss_pred:0.02648327872157097, decouple_loss:0.009202501736581326
Iteration: 348, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44762372970581055, gen p mean: -0.7292236089706421, mean p set: 0.44810402393341064
The modified gen p mean: 0.44606471061706543, gen p mean: -0.7225003838539124, mean p set: 0.4465450048446655
The modified gen p mean: 0.44733962416648865, gen p mean: -0.7319129705429077, mean p set: 0.44781988859176636
loss_pred:0.025662783533334732, decouple_loss:0.009498734958469868loss_pred:0.026545077562332153, decouple_loss:0.009283526800572872
loss_pred:0.026896316558122635, decouple_loss:0.00935876090079546
Iteration: 349, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466300308704376, gen p mean: -0.717656135559082, mean p set: 0.4471103250980377
The modified gen p mean: 0.44784584641456604, gen p mean: -0.7207432985305786, mean p set: 0.44832614064216614
The modified gen p mean: 0.4458563029766083, gen p mean: -0.7166768908500671, mean p set: 0.446336567401886
loss_pred:0.027683570981025696, decouple_loss:0.009369563311338425
loss_pred:0.025650599971413612, decouple_loss:0.009071496315300465
loss_pred:0.025889316573739052, decouple_loss:0.009239560924470425
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 350, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483192265033722, gen p mean: -0.7156908512115479, mean p set: 0.4487995207309723
The modified gen p mean: 0.44751396775245667, gen p mean: -0.7242299914360046, mean p set: 0.44799429178237915
The modified gen p mean: 0.4455784261226654, gen p mean: -0.7210097908973694, mean p set: 0.4460587203502655
loss_pred:0.02698204480111599, decouple_loss:0.00947808288037777
loss_pred:0.025738216936588287, decouple_loss:0.009161903522908688
loss_pred:0.02592511475086212, decouple_loss:0.009772525168955326
2023-05-05 16:43:43 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.7430781722068787, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7313057780265808, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.736068069934845, mean p set: 0.4500633478164673
loss_pred:0.02746746689081192, decouple_loss:0.009763316251337528
loss_pred:0.026010137051343918, decouple_loss:0.009511303156614304
loss_pred:0.026432668790221214, decouple_loss:0.009448016062378883
WV_0_PC_1_EH_0_PS_40_6, loss: 0.027115467935800552, avg_mse: 0.032323792576789856
current test mse: 0.032324
Iteration: 351, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44732123613357544, gen p mean: -0.7391048073768616, mean p set: 0.44780153036117554
loss_pred:0.027584336698055267, decouple_loss:0.008971351198852062
The modified gen p mean: 0.44799232482910156, gen p mean: -0.7344993948936462, mean p set: 0.4484725892543793
loss_pred:0.025575926527380943, decouple_loss:0.008942670188844204
The modified gen p mean: 0.44619259238243103, gen p mean: -0.7375065088272095, mean p set: 0.44667288661003113
loss_pred:0.025946371257305145, decouple_loss:0.008691692724823952
Iteration: 352, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44763290882110596, gen p mean: -0.7405266761779785, mean p set: 0.44811320304870605
The modified gen p mean: 0.44667744636535645, gen p mean: -0.7411782145500183, mean p set: 0.44715774059295654
The modified gen p mean: 0.4466976225376129, gen p mean: -0.7365153431892395, mean p set: 0.447177916765213
loss_pred:0.02592437155544758, decouple_loss:0.00911568570882082
loss_pred:0.02630092203617096, decouple_loss:0.008791261352598667
loss_pred:0.025632774457335472, decouple_loss:0.009021804668009281
Iteration: 353, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473124146461487, gen p mean: -0.7376202940940857, mean p set: 0.4477926790714264
The modified gen p mean: 0.4480590224266052, gen p mean: -0.739732027053833, mean p set: 0.4485393166542053
The modified gen p mean: 0.4462664723396301, gen p mean: -0.7291383147239685, mean p set: 0.4467467665672302
loss_pred:0.02618333324790001, decouple_loss:0.009080103598535061loss_pred:0.026014700531959534, decouple_loss:0.009332365356385708
loss_pred:0.026159919798374176, decouple_loss:0.009328779764473438
Iteration: 354, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472847878932953, gen p mean: -0.7412332892417908, mean p set: 0.4477651119232178
The modified gen p mean: 0.44809916615486145, gen p mean: -0.7325307726860046, mean p set: 0.44857946038246155
loss_pred:0.02651377208530903, decouple_loss:0.009204542264342308
loss_pred:0.02590029127895832, decouple_loss:0.00864652544260025
The modified gen p mean: 0.44795340299606323, gen p mean: -0.7341231107711792, mean p set: 0.44843369722366333
loss_pred:0.02583918906748295, decouple_loss:0.009000740945339203
Iteration: 355, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44727715849876404, gen p mean: -0.7328799366950989, mean p set: 0.44775745272636414
The modified gen p mean: 0.44809389114379883, gen p mean: -0.7255144715309143, mean p set: 0.4485742151737213
The modified gen p mean: 0.4475368559360504, gen p mean: -0.7328395247459412, mean p set: 0.4480171501636505
loss_pred:0.02593853510916233, decouple_loss:0.008813749998807907
loss_pred:0.02548966556787491, decouple_loss:0.008418363519012928
loss_pred:0.026541048660874367, decouple_loss:0.0087544284760952
Iteration: 356, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466927945613861, gen p mean: -0.724571943283081, mean p set: 0.4471730887889862The modified gen p mean: 0.4476127624511719, gen p mean: -0.7217206358909607, mean p set: 0.4480930268764496
The modified gen p mean: 0.44782301783561707, gen p mean: -0.7283552885055542, mean p set: 0.44830334186553955
loss_pred:0.026979081332683563, decouple_loss:0.008827604353427887loss_pred:0.026827048510313034, decouple_loss:0.009189306758344173
loss_pred:0.026074130088090897, decouple_loss:0.008946606889367104
Iteration: 357, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44827932119369507, gen p mean: -0.7229583859443665, mean p set: 0.44875964522361755
The modified gen p mean: 0.4473298490047455, gen p mean: -0.7201185822486877, mean p set: 0.4478101134300232
The modified gen p mean: 0.4478653371334076, gen p mean: -0.7191939353942871, mean p set: 0.4483456313610077
loss_pred:0.025440974161028862, decouple_loss:0.008493419736623764
loss_pred:0.02640651725232601, decouple_loss:0.008554824627935886
loss_pred:0.026432231068611145, decouple_loss:0.008704259991645813
Iteration: 358, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44716641306877136, gen p mean: -0.7250956892967224, mean p set: 0.44764673709869385
The modified gen p mean: 0.4476921856403351, gen p mean: -0.7252621650695801, mean p set: 0.44817250967025757
The modified gen p mean: 0.44665247201919556, gen p mean: -0.7201845645904541, mean p set: 0.44713273644447327
loss_pred:0.026468461379408836, decouple_loss:0.008547603152692318
loss_pred:0.026691757142543793, decouple_loss:0.008809609338641167
loss_pred:0.026260534301400185, decouple_loss:0.008451500907540321
Iteration: 359, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448651522397995, gen p mean: -0.7304424047470093, mean p set: 0.4491317868232727
The modified gen p mean: 0.4481734335422516, gen p mean: -0.7257366180419922, mean p set: 0.4486536979675293
The modified gen p mean: 0.447194367647171, gen p mean: -0.7319070100784302, mean p set: 0.4476746618747711
loss_pred:0.02578319050371647, decouple_loss:0.008358084596693516
loss_pred:0.02522103488445282, decouple_loss:0.00850438792258501
loss_pred:0.026253748685121536, decouple_loss:0.00867568701505661
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012018_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012018_3_24hr.npz
NaN value num: 0
Iteration: 360, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478776156902313, gen p mean: -0.7306895852088928, mean p set: 0.4483579099178314
The modified gen p mean: 0.44885823130607605, gen p mean: -0.7278426885604858, mean p set: 0.44933852553367615
The modified gen p mean: 0.4492394030094147, gen p mean: -0.7302340269088745, mean p set: 0.44971972703933716
loss_pred:0.025837460532784462, decouple_loss:0.008861630223691463
loss_pred:0.0272268857806921, decouple_loss:0.009026767686009407
loss_pred:0.02652614191174507, decouple_loss:0.00870907586067915
2023-05-05 16:48:19 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.7388585209846497, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7316712737083435, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7271509766578674, mean p set: 0.45035696029663086
loss_pred:0.027273161336779594, decouple_loss:0.009303358383476734
loss_pred:0.02621830627322197, decouple_loss:0.008795718662440777
loss_pred:0.02588982693850994, decouple_loss:0.008899319916963577
WV_0_PC_1_EH_0_PS_40_6, loss: 0.026910405606031418, avg_mse: 0.032153937965631485
current test mse: 0.032154
Iteration: 361, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496171176433563, gen p mean: -0.7290191650390625, mean p set: 0.4500974118709564
The modified gen p mean: 0.44875583052635193, gen p mean: -0.7313068509101868, mean p set: 0.449236124753952
loss_pred:0.027574852108955383, decouple_loss:0.009297441691160202
loss_pred:0.026301005855202675, decouple_loss:0.008775323629379272
The modified gen p mean: 0.4506920874118805, gen p mean: -0.7208716869354248, mean p set: 0.451172411441803
loss_pred:0.028014816343784332, decouple_loss:0.0094682015478611
Iteration: 362, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4510590434074402, gen p mean: -0.7174298763275146, mean p set: 0.4515393376350403The modified gen p mean: 0.4483445882797241, gen p mean: -0.715054452419281, mean p set: 0.4488248825073242
The modified gen p mean: 0.449282169342041, gen p mean: -0.7119064927101135, mean p set: 0.4497624933719635
loss_pred:0.028123177587985992, decouple_loss:0.009543606080114841
loss_pred:0.02761845476925373, decouple_loss:0.009630040265619755
loss_pred:0.027820486575365067, decouple_loss:0.009623310528695583
Iteration: 363, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44929617643356323, gen p mean: -0.724025547504425, mean p set: 0.44977647066116333
The modified gen p mean: 0.448874831199646, gen p mean: -0.7443296313285828, mean p set: 0.4493550956249237
The modified gen p mean: 0.4490712583065033, gen p mean: -0.7381361126899719, mean p set: 0.4495515525341034
loss_pred:0.027482638135552406, decouple_loss:0.008921763859689236
loss_pred:0.027573509141802788, decouple_loss:0.009446005336940289
loss_pred:0.026328450068831444, decouple_loss:0.008478485979139805
Iteration: 364, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44849178194999695, gen p mean: -0.7405380010604858, mean p set: 0.44897210597991943
The modified gen p mean: 0.4486909806728363, gen p mean: -0.7397019267082214, mean p set: 0.4491713047027588
The modified gen p mean: 0.4480951428413391, gen p mean: -0.7317657470703125, mean p set: 0.4485754370689392
loss_pred:0.027825675904750824, decouple_loss:0.009446402080357075
loss_pred:0.028104323893785477, decouple_loss:0.00952877476811409
loss_pred:0.02831052429974079, decouple_loss:0.009031318128108978
Iteration: 365, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490082561969757, gen p mean: -0.7421426773071289, mean p set: 0.4494885504245758The modified gen p mean: 0.44945028424263, gen p mean: -0.7417759895324707, mean p set: 0.4499305486679077
loss_pred:0.028884338214993477, decouple_loss:0.009415838867425919
loss_pred:0.026258010417222977, decouple_loss:0.008854326792061329
The modified gen p mean: 0.4479435980319977, gen p mean: -0.7424927353858948, mean p set: 0.44842392206192017
loss_pred:0.02677389793097973, decouple_loss:0.009205739013850689
Iteration: 366, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499236047267914, gen p mean: -0.7332848906517029, mean p set: 0.4504038989543915
The modified gen p mean: 0.4483950436115265, gen p mean: -0.72226881980896, mean p set: 0.4488753378391266
The modified gen p mean: 0.44893208146095276, gen p mean: -0.7195004820823669, mean p set: 0.44941237568855286
loss_pred:0.02709849923849106, decouple_loss:0.008501596748828888
loss_pred:0.02804713323712349, decouple_loss:0.009178170002996922
loss_pred:0.027759812772274017, decouple_loss:0.008708031848073006
Iteration: 367, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44861987233161926, gen p mean: -0.7272759079933167, mean p set: 0.44910016655921936
The modified gen p mean: 0.45011135935783386, gen p mean: -0.7361717820167542, mean p set: 0.45059165358543396
The modified gen p mean: 0.44823217391967773, gen p mean: -0.7275044918060303, mean p set: 0.44871246814727783
loss_pred:0.027940649539232254, decouple_loss:0.00890264194458723
loss_pred:0.026998357847332954, decouple_loss:0.008763419464230537
loss_pred:0.027399074286222458, decouple_loss:0.009278940968215466
Iteration: 368, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478102922439575, gen p mean: -0.7311063408851624, mean p set: 0.44829061627388
The modified gen p mean: 0.44982975721359253, gen p mean: -0.7304229736328125, mean p set: 0.450310081243515
The modified gen p mean: 0.4478670656681061, gen p mean: -0.7267463803291321, mean p set: 0.44834738969802856
loss_pred:0.027099519968032837, decouple_loss:0.008849150501191616
loss_pred:0.0278500784188509, decouple_loss:0.00909695215523243
loss_pred:0.026554018259048462, decouple_loss:0.008828445337712765
Iteration: 369, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479655623435974, gen p mean: -0.7190843820571899, mean p set: 0.4484458863735199The modified gen p mean: 0.44784530997276306, gen p mean: -0.7159392237663269, mean p set: 0.44832560420036316
The modified gen p mean: 0.44862130284309387, gen p mean: -0.7253571152687073, mean p set: 0.44910159707069397
loss_pred:0.026817897334694862, decouple_loss:0.00880883913487196loss_pred:0.026178793981671333, decouple_loss:0.009651301428675652
loss_pred:0.02767879329621792, decouple_loss:0.009175811894237995
Iteration: 370, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44853314757347107, gen p mean: -0.7165734767913818, mean p set: 0.44901344180107117
The modified gen p mean: 0.4492180645465851, gen p mean: -0.7083644866943359, mean p set: 0.4496983587741852
The modified gen p mean: 0.4498286545276642, gen p mean: -0.7238067984580994, mean p set: 0.4503089487552643
loss_pred:0.02758203260600567, decouple_loss:0.009389317594468594
loss_pred:0.02837950550019741, decouple_loss:0.008990668691694736
loss_pred:0.025869226083159447, decouple_loss:0.008982466533780098
2023-05-05 16:51:56 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.7356285452842712, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830535888672, gen p mean: -0.7285381555557251, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7243321537971497, mean p set: 0.45035696029663086
loss_pred:0.027346698567271233, decouple_loss:0.0095551498234272
loss_pred:0.026334507390856743, decouple_loss:0.009127967059612274
loss_pred:0.02600138448178768, decouple_loss:0.00898590125143528
WV_0_PC_1_EH_0_PS_40_6, loss: 0.027022015303373337, avg_mse: 0.0322197750210762
current test mse: 0.03222
Iteration: 371, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500401020050049, gen p mean: -0.7209385633468628, mean p set: 0.450520396232605
The modified gen p mean: 0.44851556420326233, gen p mean: -0.7231208682060242, mean p set: 0.4489958584308624
loss_pred:0.027617333456873894, decouple_loss:0.009146304801106453
loss_pred:0.02794070541858673, decouple_loss:0.009529725648462772
The modified gen p mean: 0.448900431394577, gen p mean: -0.720398485660553, mean p set: 0.4493807256221771
loss_pred:0.027096299454569817, decouple_loss:0.009540348313748837
Iteration: 372, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491003453731537, gen p mean: -0.7385076880455017, mean p set: 0.4495806396007538
The modified gen p mean: 0.44827431440353394, gen p mean: -0.7224532961845398, mean p set: 0.4487546384334564
The modified gen p mean: 0.4494500756263733, gen p mean: -0.7359678745269775, mean p set: 0.4499303698539734
loss_pred:0.026236427947878838, decouple_loss:0.009302186779677868
loss_pred:0.028409099206328392, decouple_loss:0.009253572672605515
loss_pred:0.0285378098487854, decouple_loss:0.009286588057875633
Iteration: 373, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449035108089447, gen p mean: -0.7328689694404602, mean p set: 0.4495154023170471
The modified gen p mean: 0.44851455092430115, gen p mean: -0.7347102761268616, mean p set: 0.44899484515190125
loss_pred:0.026714324951171875, decouple_loss:0.009051265195012093
loss_pred:0.0282035693526268, decouple_loss:0.008716859854757786
The modified gen p mean: 0.44879260659217834, gen p mean: -0.7210422158241272, mean p set: 0.44927287101745605
loss_pred:0.028005637228488922, decouple_loss:0.009128406643867493
Iteration: 374, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45006632804870605, gen p mean: -0.7327625751495361, mean p set: 0.45054665207862854
The modified gen p mean: 0.44800862669944763, gen p mean: -0.7311181426048279, mean p set: 0.44848892092704773
loss_pred:0.027177246287465096, decouple_loss:0.008819441311061382
loss_pred:0.028221899643540382, decouple_loss:0.008929395116865635
The modified gen p mean: 0.44956347346305847, gen p mean: -0.7434349656105042, mean p set: 0.45004376769065857
loss_pred:0.025700729340314865, decouple_loss:0.008780292235314846
Iteration: 375, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475609362125397, gen p mean: -0.7315139770507812, mean p set: 0.4480412006378174
The modified gen p mean: 0.4490033984184265, gen p mean: -0.7354189157485962, mean p set: 0.4494836926460266
loss_pred:0.02684181183576584, decouple_loss:0.009179056622087955
loss_pred:0.02610766515135765, decouple_loss:0.009092407301068306
The modified gen p mean: 0.44802823662757874, gen p mean: -0.7425475120544434, mean p set: 0.44850850105285645
loss_pred:0.026674995198845863, decouple_loss:0.008701728656888008
Iteration: 376, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44916248321533203, gen p mean: -0.7217017412185669, mean p set: 0.44964277744293213
The modified gen p mean: 0.4479248821735382, gen p mean: -0.7226919531822205, mean p set: 0.4484051764011383
The modified gen p mean: 0.4495351314544678, gen p mean: -0.7289928197860718, mean p set: 0.4500153958797455
loss_pred:0.028157278895378113, decouple_loss:0.008945527486503124
loss_pred:0.02764967642724514, decouple_loss:0.008782148361206055
loss_pred:0.02611313946545124, decouple_loss:0.008480623364448547
Iteration: 377, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44823339581489563, gen p mean: -0.7157180309295654, mean p set: 0.4487136900424957
The modified gen p mean: 0.4485279619693756, gen p mean: -0.719742476940155, mean p set: 0.4490082263946533
The modified gen p mean: 0.44937968254089355, gen p mean: -0.7196261286735535, mean p set: 0.44986000657081604
loss_pred:0.0284561924636364, decouple_loss:0.008920194581151009
loss_pred:0.026093581691384315, decouple_loss:0.00889131985604763
loss_pred:0.027443837374448776, decouple_loss:0.008531424216926098
Iteration: 378, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44943416118621826, gen p mean: -0.7310813665390015, mean p set: 0.44991445541381836
The modified gen p mean: 0.4490126073360443, gen p mean: -0.7260305285453796, mean p set: 0.4494929015636444
The modified gen p mean: 0.44948530197143555, gen p mean: -0.7256212830543518, mean p set: 0.44996556639671326
loss_pred:0.02688021957874298, decouple_loss:0.008857420645654202
loss_pred:0.02720579318702221, decouple_loss:0.008808926679193974
loss_pred:0.027600284665822983, decouple_loss:0.009562628343701363
Iteration: 379, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44955405592918396, gen p mean: -0.7307429909706116, mean p set: 0.45003435015678406
The modified gen p mean: 0.4487936794757843, gen p mean: -0.7262445688247681, mean p set: 0.4492739737033844
The modified gen p mean: 0.4493091404438019, gen p mean: -0.731772243976593, mean p set: 0.4497894048690796
loss_pred:0.02641841396689415, decouple_loss:0.00860193558037281
loss_pred:0.027588529512286186, decouple_loss:0.008970490656793118
loss_pred:0.02660132572054863, decouple_loss:0.008718072436749935
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012017_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012017_3_24hr.npz
NaN value num: 0
Iteration: 380, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44957005977630615, gen p mean: -0.7315822243690491, mean p set: 0.45005032420158386
The modified gen p mean: 0.45019644498825073, gen p mean: -0.7361324429512024, mean p set: 0.45067667961120605
The modified gen p mean: 0.44997748732566833, gen p mean: -0.732956051826477, mean p set: 0.45045775175094604
loss_pred:0.025548340752720833, decouple_loss:0.010346239432692528
loss_pred:0.0254935622215271, decouple_loss:0.010235980153083801
loss_pred:0.02563176117837429, decouple_loss:0.01027028076350689
2023-05-05 16:56:37 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.7360670566558838, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7241770029067993, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.7284111380577087, mean p set: 0.4500633478164673
loss_pred:0.027234340086579323, decouple_loss:0.009432550519704819
loss_pred:0.025930149480700493, decouple_loss:0.008917110040783882
loss_pred:0.026333069428801537, decouple_loss:0.009023580700159073
WV_0_PC_1_EH_0_PS_40_6, loss: 0.026955407112836838, avg_mse: 0.03217920660972595
current test mse: 0.032179
Iteration: 381, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44897350668907166, gen p mean: -0.7242338061332703, mean p set: 0.44945380091667175The modified gen p mean: 0.4490130841732025, gen p mean: -0.7283018231391907, mean p set: 0.449493408203125
loss_pred:0.026143407449126244, decouple_loss:0.00928463228046894
loss_pred:0.026459388434886932, decouple_loss:0.009298078715801239
The modified gen p mean: 0.45127686858177185, gen p mean: -0.7338024377822876, mean p set: 0.45175716280937195
loss_pred:0.026597807183861732, decouple_loss:0.009886503219604492
Iteration: 382, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44860315322875977, gen p mean: -0.7394181489944458, mean p set: 0.44908347725868225
The modified gen p mean: 0.4507595896720886, gen p mean: -0.7423503994941711, mean p set: 0.4512398838996887
The modified gen p mean: 0.44883400201797485, gen p mean: -0.7295350432395935, mean p set: 0.44931429624557495
loss_pred:0.02569081261754036, decouple_loss:0.009389576502144337
loss_pred:0.02706574648618698, decouple_loss:0.009734439663589
loss_pred:0.027463247999548912, decouple_loss:0.009062433615326881
Iteration: 383, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504992961883545, gen p mean: -0.7405636310577393, mean p set: 0.4509795904159546
The modified gen p mean: 0.4495130479335785, gen p mean: -0.7361721992492676, mean p set: 0.4499933123588562
The modified gen p mean: 0.45036405324935913, gen p mean: -0.7361744046211243, mean p set: 0.4508443772792816
loss_pred:0.026127493008971214, decouple_loss:0.009680793620646loss_pred:0.026002062484622, decouple_loss:0.009505495429039001
loss_pred:0.025920402258634567, decouple_loss:0.009242551401257515
Iteration: 384, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44822803139686584, gen p mean: -0.7198892831802368, mean p set: 0.44870832562446594
The modified gen p mean: 0.4501136541366577, gen p mean: -0.7187303304672241, mean p set: 0.4505939483642578
The modified gen p mean: 0.45056432485580444, gen p mean: -0.7380746603012085, mean p set: 0.45104461908340454
loss_pred:0.026277678087353706, decouple_loss:0.01000327616930008
loss_pred:0.02741149254143238, decouple_loss:0.009364001452922821
loss_pred:0.026105714961886406, decouple_loss:0.00945198442786932
Iteration: 385, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450148344039917, gen p mean: -0.7323595881462097, mean p set: 0.4506286382675171
The modified gen p mean: 0.4502236843109131, gen p mean: -0.739011287689209, mean p set: 0.4507039785385132
The modified gen p mean: 0.4509466290473938, gen p mean: -0.7301739454269409, mean p set: 0.4514269232749939
loss_pred:0.025280965492129326, decouple_loss:0.009410402737557888
loss_pred:0.025887129828333855, decouple_loss:0.00918655376881361
loss_pred:0.02644776552915573, decouple_loss:0.009476935490965843
Iteration: 386, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44882988929748535, gen p mean: -0.7308361530303955, mean p set: 0.44931018352508545
The modified gen p mean: 0.44824227690696716, gen p mean: -0.7399656176567078, mean p set: 0.4487225413322449
The modified gen p mean: 0.44940176606178284, gen p mean: -0.7383383512496948, mean p set: 0.4498820900917053
loss_pred:0.026598861441016197, decouple_loss:0.009114452637732029
loss_pred:0.025419067591428757, decouple_loss:0.008918478153645992
loss_pred:0.025565315037965775, decouple_loss:0.008713836781680584
Iteration: 387, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485202431678772, gen p mean: -0.7354820370674133, mean p set: 0.4490005075931549
The modified gen p mean: 0.45019397139549255, gen p mean: -0.7284479737281799, mean p set: 0.45067429542541504
The modified gen p mean: 0.4499850869178772, gen p mean: -0.7375202178955078, mean p set: 0.4504653811454773
loss_pred:0.025907766073942184, decouple_loss:0.008955985307693481
loss_pred:0.026095975190401077, decouple_loss:0.009372011758387089
loss_pred:0.025296537205576897, decouple_loss:0.008843157440423965
Iteration: 388, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495947062969208, gen p mean: -0.7339727282524109, mean p set: 0.4500750005245209
The modified gen p mean: 0.44987753033638, gen p mean: -0.737480878829956, mean p set: 0.4503578245639801
The modified gen p mean: 0.4511813223361969, gen p mean: -0.7338695526123047, mean p set: 0.451661616563797
loss_pred:0.025879783555865288, decouple_loss:0.008300719782710075
loss_pred:0.026614321395754814, decouple_loss:0.009264305233955383
loss_pred:0.02651768922805786, decouple_loss:0.00882529467344284
Iteration: 389, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45013922452926636, gen p mean: -0.732478678226471, mean p set: 0.45061951875686646
The modified gen p mean: 0.4502759873867035, gen p mean: -0.7278034687042236, mean p set: 0.4507562518119812
The modified gen p mean: 0.4509267508983612, gen p mean: -0.7386916875839233, mean p set: 0.4514070451259613
loss_pred:0.02598811872303486, decouple_loss:0.009110855869948864
loss_pred:0.02576948143541813, decouple_loss:0.00890581775456667
loss_pred:0.026592109352350235, decouple_loss:0.009151731617748737
Iteration: 390, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483577609062195, gen p mean: -0.7387904524803162, mean p set: 0.4488380551338196
The modified gen p mean: 0.45103394985198975, gen p mean: -0.7440828084945679, mean p set: 0.45151427388191223
The modified gen p mean: 0.4488946199417114, gen p mean: -0.7455421090126038, mean p set: 0.44937488436698914
loss_pred:0.02621215395629406, decouple_loss:0.009208807721734047
loss_pred:0.027033204212784767, decouple_loss:0.008936992846429348
loss_pred:0.025811880826950073, decouple_loss:0.008797327056527138
2023-05-05 17:00:16 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.7521452307701111, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7399013638496399, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7444521188735962, mean p set: 0.4500633478164673
loss_pred:0.027444995939731598, decouple_loss:0.010001483373343945
loss_pred:0.026059672236442566, decouple_loss:0.009487622417509556
loss_pred:0.026412541046738625, decouple_loss:0.009639594703912735
WV_0_PC_1_EH_0_PS_40_6, loss: 0.027124550193548203, avg_mse: 0.03243798017501831
current test mse: 0.032438
Iteration: 391, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44985517859458923, gen p mean: -0.7550567984580994, mean p set: 0.45033547282218933
The modified gen p mean: 0.44889262318611145, gen p mean: -0.7448464035987854, mean p set: 0.44937294721603394
loss_pred:0.026178620755672455, decouple_loss:0.008982982486486435
loss_pred:0.024871589615941048, decouple_loss:0.00868879072368145
The modified gen p mean: 0.4488689601421356, gen p mean: -0.7454007267951965, mean p set: 0.4493492543697357
loss_pred:0.026415366679430008, decouple_loss:0.008940353989601135
Iteration: 392, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508385956287384, gen p mean: -0.7366259098052979, mean p set: 0.4513188898563385
The modified gen p mean: 0.44860729575157166, gen p mean: -0.73104327917099, mean p set: 0.44908758997917175
loss_pred:0.026266910135746002, decouple_loss:0.008889032527804375
loss_pred:0.02697978913784027, decouple_loss:0.008773760870099068
The modified gen p mean: 0.44945964217185974, gen p mean: -0.734411895275116, mean p set: 0.44993993639945984
loss_pred:0.02620081789791584, decouple_loss:0.008652734570205212
Iteration: 393, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485991299152374, gen p mean: -0.7278962135314941, mean p set: 0.4490794241428375
The modified gen p mean: 0.4482896029949188, gen p mean: -0.7222165465354919, mean p set: 0.4487698972225189
The modified gen p mean: 0.4508129358291626, gen p mean: -0.7292208075523376, mean p set: 0.4512932300567627
loss_pred:0.02595345862209797, decouple_loss:0.00869131088256836loss_pred:0.026819728314876556, decouple_loss:0.009396351873874664
loss_pred:0.025392457842826843, decouple_loss:0.008944976143538952
Iteration: 394, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.451181560754776, gen p mean: -0.7350674867630005, mean p set: 0.4516618549823761
The modified gen p mean: 0.4493566155433655, gen p mean: -0.7305768132209778, mean p set: 0.44983693957328796
The modified gen p mean: 0.4501436650753021, gen p mean: -0.7343425154685974, mean p set: 0.4506239891052246
loss_pred:0.026029936969280243, decouple_loss:0.008857236243784428
loss_pred:0.02642584778368473, decouple_loss:0.009245544672012329
loss_pred:0.0255584716796875, decouple_loss:0.008763830177485943
Iteration: 395, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503362476825714, gen p mean: -0.7261977195739746, mean p set: 0.4508165121078491
The modified gen p mean: 0.45004984736442566, gen p mean: -0.7399085760116577, mean p set: 0.45053014159202576
The modified gen p mean: 0.45033565163612366, gen p mean: -0.7342842221260071, mean p set: 0.45081597566604614
loss_pred:0.025399483740329742, decouple_loss:0.009031031280755997
loss_pred:0.02531360276043415, decouple_loss:0.008909179829061031
loss_pred:0.02551298774778843, decouple_loss:0.008923690766096115
Iteration: 396, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45016369223594666, gen p mean: -0.7425315380096436, mean p set: 0.45064401626586914The modified gen p mean: 0.44986429810523987, gen p mean: -0.7390480041503906, mean p set: 0.4503445625305176
The modified gen p mean: 0.44992145895957947, gen p mean: -0.7399020791053772, mean p set: 0.45040175318717957
loss_pred:0.02612939476966858, decouple_loss:0.008516919799149036
loss_pred:0.025645019486546516, decouple_loss:0.00942300446331501
loss_pred:0.02564644254744053, decouple_loss:0.00892610289156437
Iteration: 397, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450810045003891, gen p mean: -0.7251700162887573, mean p set: 0.4512903094291687
The modified gen p mean: 0.4501018822193146, gen p mean: -0.742106556892395, mean p set: 0.45058220624923706
loss_pred:0.026671500876545906, decouple_loss:0.008993499912321568
loss_pred:0.026109876111149788, decouple_loss:0.008580386638641357
The modified gen p mean: 0.45051079988479614, gen p mean: -0.7400421500205994, mean p set: 0.45099109411239624
loss_pred:0.02561277523636818, decouple_loss:0.008478461764752865
Iteration: 398, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498046040534973, gen p mean: -0.724331796169281, mean p set: 0.4502848982810974
The modified gen p mean: 0.44861555099487305, gen p mean: -0.7264804840087891, mean p set: 0.44909584522247314
The modified gen p mean: 0.4501728415489197, gen p mean: -0.7327782511711121, mean p set: 0.4506531357765198
loss_pred:0.02556627057492733, decouple_loss:0.008448785170912743loss_pred:0.025836819782853127, decouple_loss:0.009057695977389812
loss_pred:0.02563432790338993, decouple_loss:0.008432472124695778
Iteration: 399, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44998276233673096, gen p mean: -0.7391418218612671, mean p set: 0.45046308636665344
The modified gen p mean: 0.44983842968940735, gen p mean: -0.7360239028930664, mean p set: 0.45031872391700745
The modified gen p mean: 0.4503107964992523, gen p mean: -0.742834210395813, mean p set: 0.45079106092453003
loss_pred:0.02535923197865486, decouple_loss:0.008566110394895077
loss_pred:0.02601892687380314, decouple_loss:0.008451582863926888
loss_pred:0.02518978714942932, decouple_loss:0.00855182483792305
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012002_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012002_3_24hr.npz
NaN value num: 0
Iteration: 400, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503400921821594, gen p mean: -0.7343449592590332, mean p set: 0.4508203864097595
The modified gen p mean: 0.44897031784057617, gen p mean: -0.7275791168212891, mean p set: 0.44945064187049866
The modified gen p mean: 0.4506933093070984, gen p mean: -0.7361695766448975, mean p set: 0.4511736333370209
loss_pred:0.025946423411369324, decouple_loss:0.009856331162154675loss_pred:0.02465098537504673, decouple_loss:0.008892436511814594
loss_pred:0.0249929241836071, decouple_loss:0.008601232431828976
2023-05-05 17:04:40 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.7509611248970032, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7433913946151733, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7383878827095032, mean p set: 0.45035696029663086
loss_pred:0.027480829507112503, decouple_loss:0.009774057194590569
loss_pred:0.026401685550808907, decouple_loss:0.009303058497607708
loss_pred:0.026055607944726944, decouple_loss:0.009378672577440739
WV_0_PC_1_EH_0_PS_40_6, loss: 0.027120305225253105, avg_mse: 0.03255051374435425
current test mse: 0.032551
Iteration: 401, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498558044433594, gen p mean: -0.7424420118331909, mean p set: 0.4503360688686371
The modified gen p mean: 0.4484885632991791, gen p mean: -0.7365896701812744, mean p set: 0.4489688575267792
loss_pred:0.025746682658791542, decouple_loss:0.009615175426006317
loss_pred:0.026744207367300987, decouple_loss:0.009449181146919727
The modified gen p mean: 0.45115718245506287, gen p mean: -0.746745228767395, mean p set: 0.45163747668266296
loss_pred:0.024268055334687233, decouple_loss:0.008513186126947403
Iteration: 402, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.451149046421051, gen p mean: -0.7426130175590515, mean p set: 0.4516293406486511
The modified gen p mean: 0.4504604637622833, gen p mean: -0.7486662268638611, mean p set: 0.4509407579898834
The modified gen p mean: 0.4506647288799286, gen p mean: -0.750432550907135, mean p set: 0.4511450529098511
loss_pred:0.02464500069618225, decouple_loss:0.008516047149896622
loss_pred:0.024218084290623665, decouple_loss:0.00860818661749363
loss_pred:0.02410414069890976, decouple_loss:0.008744906634092331
Iteration: 403, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511899948120117, gen p mean: -0.7554331421852112, mean p set: 0.4516703188419342
The modified gen p mean: 0.45046088099479675, gen p mean: -0.7552425265312195, mean p set: 0.45094114542007446
The modified gen p mean: 0.4517821669578552, gen p mean: -0.7548215389251709, mean p set: 0.4522624611854553
loss_pred:0.02648625709116459, decouple_loss:0.00901897344738245
loss_pred:0.02424868382513523, decouple_loss:0.008430629037320614
loss_pred:0.0251583494246006, decouple_loss:0.00855463556945324
Iteration: 404, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502314031124115, gen p mean: -0.7461913824081421, mean p set: 0.4507116973400116
The modified gen p mean: 0.45049548149108887, gen p mean: -0.7369825839996338, mean p set: 0.45097577571868896
loss_pred:0.026390209794044495, decouple_loss:0.008666826412081718
loss_pred:0.025528015568852425, decouple_loss:0.008492892608046532
The modified gen p mean: 0.45188194513320923, gen p mean: -0.7442443370819092, mean p set: 0.4523622393608093
loss_pred:0.02505207248032093, decouple_loss:0.008323014713823795
Iteration: 405, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514671266078949, gen p mean: -0.746221661567688, mean p set: 0.4519474506378174
The modified gen p mean: 0.450633704662323, gen p mean: -0.7396489381790161, mean p set: 0.4511139988899231
The modified gen p mean: 0.4508954882621765, gen p mean: -0.7395875453948975, mean p set: 0.4513757526874542
loss_pred:0.023753389716148376, decouple_loss:0.008266267366707325
loss_pred:0.025975016877055168, decouple_loss:0.008612449280917645
loss_pred:0.02405639924108982, decouple_loss:0.00843778159469366
Iteration: 406, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45018303394317627, gen p mean: -0.7330610156059265, mean p set: 0.450663298368454
The modified gen p mean: 0.45038190484046936, gen p mean: -0.731268048286438, mean p set: 0.45086219906806946
loss_pred:0.025871602818369865, decouple_loss:0.008677521720528603
The modified gen p mean: 0.448119193315506, gen p mean: -0.7260969281196594, mean p set: 0.4485994875431061
loss_pred:0.025560012087225914, decouple_loss:0.008728147484362125
loss_pred:0.025454437360167503, decouple_loss:0.009484391659498215
Iteration: 407, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45125365257263184, gen p mean: -0.7408347129821777, mean p set: 0.45173394680023193
The modified gen p mean: 0.4493979215621948, gen p mean: -0.7370392680168152, mean p set: 0.44987818598747253
The modified gen p mean: 0.44925785064697266, gen p mean: -0.7309978604316711, mean p set: 0.44973814487457275
loss_pred:0.024730224162340164, decouple_loss:0.008420296013355255
loss_pred:0.026018528267741203, decouple_loss:0.009293804876506329
loss_pred:0.026502924039959908, decouple_loss:0.009889816865324974
Iteration: 408, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450458288192749, gen p mean: -0.7597304582595825, mean p set: 0.4509385824203491The modified gen p mean: 0.45023903250694275, gen p mean: -0.7560293078422546, mean p set: 0.45071932673454285
The modified gen p mean: 0.4513459801673889, gen p mean: -0.7602923512458801, mean p set: 0.451826274394989
loss_pred:0.02504110522568226, decouple_loss:0.008520652540028095loss_pred:0.02488662861287594, decouple_loss:0.00864796619862318
loss_pred:0.02518601529300213, decouple_loss:0.008395723067224026
Iteration: 409, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508376121520996, gen p mean: -0.7731181979179382, mean p set: 0.4513179361820221
The modified gen p mean: 0.45099693536758423, gen p mean: -0.7722135186195374, mean p set: 0.4514772295951843
The modified gen p mean: 0.448184609413147, gen p mean: -0.7666817903518677, mean p set: 0.4486648738384247
loss_pred:0.023599915206432343, decouple_loss:0.008508093655109406
loss_pred:0.024308932945132256, decouple_loss:0.008572167716920376
loss_pred:0.026025237515568733, decouple_loss:0.009162680245935917
Iteration: 410, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4520038366317749, gen p mean: -0.7667346596717834, mean p set: 0.4524841606616974
The modified gen p mean: 0.4518227279186249, gen p mean: -0.7617056369781494, mean p set: 0.45230305194854736
The modified gen p mean: 0.44984209537506104, gen p mean: -0.7641505002975464, mean p set: 0.45032238960266113
loss_pred:0.025024235248565674, decouple_loss:0.00837752502411604
loss_pred:0.024709539487957954, decouple_loss:0.00828806683421135
loss_pred:0.02565886825323105, decouple_loss:0.008198979310691357
2023-05-05 17:08:20 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.7640830874443054, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7557275295257568, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7506000399589539, mean p set: 0.45035696029663086
loss_pred:0.027531804516911507, decouple_loss:0.010171188972890377
loss_pred:0.026520103216171265, decouple_loss:0.009697264060378075
loss_pred:0.026093129068613052, decouple_loss:0.009749416261911392
WV_0_PC_1_EH_0_PS_40_6, loss: 0.027208644896745682, avg_mse: 0.03267306834459305
current test mse: 0.032673
Iteration: 411, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45114797353744507, gen p mean: -0.7623319029808044, mean p set: 0.45162826776504517
The modified gen p mean: 0.44946759939193726, gen p mean: -0.7428537607192993, mean p set: 0.44994789361953735
loss_pred:0.023448316380381584, decouple_loss:0.008547757752239704
loss_pred:0.026444245129823685, decouple_loss:0.009499981999397278
The modified gen p mean: 0.4499131739139557, gen p mean: -0.7536208629608154, mean p set: 0.4503934979438782
loss_pred:0.025067878887057304, decouple_loss:0.00835318025201559
Iteration: 412, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498581290245056, gen p mean: -0.749299943447113, mean p set: 0.4503384232521057
The modified gen p mean: 0.45038580894470215, gen p mean: -0.7446760535240173, mean p set: 0.45086607336997986
The modified gen p mean: 0.45059841871261597, gen p mean: -0.7501109838485718, mean p set: 0.4510786831378937
loss_pred:0.024473274126648903, decouple_loss:0.008505779318511486
loss_pred:0.02605133317410946, decouple_loss:0.008471540175378323
loss_pred:0.02399509586393833, decouple_loss:0.00830559991300106
Iteration: 413, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45053476095199585, gen p mean: -0.7417857050895691, mean p set: 0.45101502537727356
The modified gen p mean: 0.45063918828964233, gen p mean: -0.7427867650985718, mean p set: 0.45111945271492004
The modified gen p mean: 0.4513176381587982, gen p mean: -0.7503799796104431, mean p set: 0.4517979323863983
loss_pred:0.025229549035429955, decouple_loss:0.008643725886940956
loss_pred:0.024848274886608124, decouple_loss:0.008536179549992085
loss_pred:0.02338571473956108, decouple_loss:0.008006498217582703
Iteration: 414, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507354199886322, gen p mean: -0.7425593137741089, mean p set: 0.4512156844139099
The modified gen p mean: 0.4511793255805969, gen p mean: -0.7431203126907349, mean p set: 0.451659619808197
The modified gen p mean: 0.449162095785141, gen p mean: -0.7322192788124084, mean p set: 0.4496423602104187
loss_pred:0.024372616782784462, decouple_loss:0.008251658640801907
loss_pred:0.024264078587293625, decouple_loss:0.008491025306284428
loss_pred:0.025994563475251198, decouple_loss:0.00940016284584999
Iteration: 415, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44900110363960266, gen p mean: -0.7297930121421814, mean p set: 0.44948139786720276
The modified gen p mean: 0.44920992851257324, gen p mean: -0.7424975037574768, mean p set: 0.44969022274017334
loss_pred:0.02521413378417492, decouple_loss:0.00887374673038721
loss_pred:0.02504589408636093, decouple_loss:0.00838467013090849
The modified gen p mean: 0.45224758982658386, gen p mean: -0.7437627911567688, mean p set: 0.45272788405418396
loss_pred:0.02609816938638687, decouple_loss:0.008529623039066792
Iteration: 416, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4519505202770233, gen p mean: -0.7359057068824768, mean p set: 0.4524308443069458
The modified gen p mean: 0.45141905546188354, gen p mean: -0.7458997964859009, mean p set: 0.45189934968948364
The modified gen p mean: 0.45126938819885254, gen p mean: -0.7386777997016907, mean p set: 0.45174965262413025
loss_pred:0.02479618601500988, decouple_loss:0.008117702789604664
loss_pred:0.02376393973827362, decouple_loss:0.007972177118062973
loss_pred:0.023823583498597145, decouple_loss:0.008028675802052021
Iteration: 417, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4510021209716797, gen p mean: -0.7364935278892517, mean p set: 0.4514824450016022
The modified gen p mean: 0.448144793510437, gen p mean: -0.7270832061767578, mean p set: 0.4486250877380371
The modified gen p mean: 0.45023593306541443, gen p mean: -0.7406500577926636, mean p set: 0.4507162272930145
loss_pred:0.024982109665870667, decouple_loss:0.008415630087256432
loss_pred:0.02585008554160595, decouple_loss:0.008535360917448997
loss_pred:0.024754183366894722, decouple_loss:0.008315231651067734
Iteration: 418, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483523368835449, gen p mean: -0.7309964299201965, mean p set: 0.448832631111145
The modified gen p mean: 0.4506831169128418, gen p mean: -0.7305058836936951, mean p set: 0.4511634409427643
The modified gen p mean: 0.4519405961036682, gen p mean: -0.7447088956832886, mean p set: 0.4524208605289459
loss_pred:0.025188660249114037, decouple_loss:0.008464209735393524
loss_pred:0.024826655164361, decouple_loss:0.00784006342291832
loss_pred:0.026152970269322395, decouple_loss:0.008105463348329067
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012016_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012016_3_24hr.npz
NaN value num: 0
Iteration: 419, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505658447742462, gen p mean: -0.7482998967170715, mean p set: 0.4510461390018463
The modified gen p mean: 0.4510784447193146, gen p mean: -0.7460832595825195, mean p set: 0.4515587389469147
The modified gen p mean: 0.4516121447086334, gen p mean: -0.7400450110435486, mean p set: 0.45209240913391113
loss_pred:0.026689911261200905, decouple_loss:0.008378990925848484
loss_pred:0.025858325883746147, decouple_loss:0.00783741194754839
loss_pred:0.027737846598029137, decouple_loss:0.008584304712712765
Iteration: 420, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513148069381714, gen p mean: -0.749619722366333, mean p set: 0.4517951011657715
The modified gen p mean: 0.45226389169692993, gen p mean: -0.7437762022018433, mean p set: 0.45274418592453003
The modified gen p mean: 0.45156583189964294, gen p mean: -0.7532964944839478, mean p set: 0.45204612612724304
loss_pred:0.02512160688638687, decouple_loss:0.008783397264778614loss_pred:0.027039863169193268, decouple_loss:0.00908250268548727
loss_pred:0.02547530084848404, decouple_loss:0.008507569320499897
2023-05-05 17:12:57 testing...
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7476811408996582, mean p set: 0.45035696029663086
The modified gen p mean: 0.4497888684272766, gen p mean: -0.7608100175857544, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830535888672, gen p mean: -0.7527724504470825, mean p set: 0.4500633478164673
loss_pred:0.026223449036478996, decouple_loss:0.009299350902438164
loss_pred:0.027659064158797264, decouple_loss:0.009766838513314724
loss_pred:0.026619140058755875, decouple_loss:0.009309119544923306
WV_0_PC_1_EH_0_PS_40_6, loss: 0.027306808158755302, avg_mse: 0.032917190343141556
current test mse: 0.032917
Iteration: 421, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45111456513404846, gen p mean: -0.7518174648284912, mean p set: 0.45159485936164856
The modified gen p mean: 0.4522475302219391, gen p mean: -0.7450423240661621, mean p set: 0.4527277946472168
loss_pred:0.025372572243213654, decouple_loss:0.008144612424075603
loss_pred:0.027729477733373642, decouple_loss:0.008687535300850868
The modified gen p mean: 0.4532153904438019, gen p mean: -0.7594079971313477, mean p set: 0.453695684671402
loss_pred:0.025830665603280067, decouple_loss:0.008623436093330383
Iteration: 422, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45160073041915894, gen p mean: -0.7413826584815979, mean p set: 0.45208099484443665
The modified gen p mean: 0.4506472647190094, gen p mean: -0.7467333078384399, mean p set: 0.4511275291442871
The modified gen p mean: 0.4512234926223755, gen p mean: -0.7588304281234741, mean p set: 0.4517037868499756
loss_pred:0.02673737332224846, decouple_loss:0.008590767160058022
loss_pred:0.026898816227912903, decouple_loss:0.008864353410899639
loss_pred:0.026961550116539, decouple_loss:0.008447211235761642
Iteration: 423, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45178744196891785, gen p mean: -0.7608674764633179, mean p set: 0.45226770639419556
The modified gen p mean: 0.4516027867794037, gen p mean: -0.7524799108505249, mean p set: 0.4520830810070038
The modified gen p mean: 0.4522643983364105, gen p mean: -0.7639078497886658, mean p set: 0.45274466276168823
loss_pred:0.025638369843363762, decouple_loss:0.008776327595114708
loss_pred:0.027205290272831917, decouple_loss:0.008593508042395115
loss_pred:0.027347618713974953, decouple_loss:0.00858759880065918
Iteration: 424, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511711001396179, gen p mean: -0.7522927522659302, mean p set: 0.45165136456489563
The modified gen p mean: 0.4525543451309204, gen p mean: -0.7498916387557983, mean p set: 0.4530346095561981
The modified gen p mean: 0.4514194428920746, gen p mean: -0.7469061017036438, mean p set: 0.4518997073173523
loss_pred:0.02702813409268856, decouple_loss:0.00869349017739296
loss_pred:0.02628495916724205, decouple_loss:0.009011310525238514
loss_pred:0.028080517426133156, decouple_loss:0.008826669305562973
Iteration: 425, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45270445942878723, gen p mean: -0.742424726486206, mean p set: 0.45318475365638733
The modified gen p mean: 0.4525368809700012, gen p mean: -0.7502586245536804, mean p set: 0.45301714539527893
The modified gen p mean: 0.45145925879478455, gen p mean: -0.7364903688430786, mean p set: 0.45193958282470703
loss_pred:0.024917831644415855, decouple_loss:0.009177019819617271loss_pred:0.027197709307074547, decouple_loss:0.0091019868850708
loss_pred:0.026089144870638847, decouple_loss:0.00910473894327879
Iteration: 426, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4538593888282776, gen p mean: -0.7457293272018433, mean p set: 0.4543396830558777
The modified gen p mean: 0.45021766424179077, gen p mean: -0.7365589141845703, mean p set: 0.45069798827171326
The modified gen p mean: 0.4506503641605377, gen p mean: -0.7363343238830566, mean p set: 0.4511306881904602
loss_pred:0.026427246630191803, decouple_loss:0.009754730388522148
loss_pred:0.02538924291729927, decouple_loss:0.009475871920585632
loss_pred:0.025839677080512047, decouple_loss:0.00922396406531334
Iteration: 427, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507941007614136, gen p mean: -0.7398735880851746, mean p set: 0.45127442479133606
The modified gen p mean: 0.45327654480934143, gen p mean: -0.750832736492157, mean p set: 0.4537568688392639
The modified gen p mean: 0.45070749521255493, gen p mean: -0.7405586838722229, mean p set: 0.45118778944015503
loss_pred:0.02683120034635067, decouple_loss:0.009880628436803818
loss_pred:0.02574939839541912, decouple_loss:0.009280565194785595
loss_pred:0.02668789029121399, decouple_loss:0.0098917530849576
Iteration: 428, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45244091749191284, gen p mean: -0.7332280278205872, mean p set: 0.45292118191719055
The modified gen p mean: 0.45239225029945374, gen p mean: -0.7475788593292236, mean p set: 0.45287254452705383
The modified gen p mean: 0.4507308900356293, gen p mean: -0.7279295325279236, mean p set: 0.45121118426322937
loss_pred:0.027861012145876884, decouple_loss:0.00975677091628313
loss_pred:0.027180058881640434, decouple_loss:0.009933073073625565
loss_pred:0.02695516124367714, decouple_loss:0.010104677639901638
Iteration: 429, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4519716799259186, gen p mean: -0.731441855430603, mean p set: 0.4524519443511963
The modified gen p mean: 0.45071759819984436, gen p mean: -0.7340710759162903, mean p set: 0.45119786262512207
The modified gen p mean: 0.45206692814826965, gen p mean: -0.7361522912979126, mean p set: 0.45254722237586975
loss_pred:0.02774178795516491, decouple_loss:0.009226557798683643
loss_pred:0.027072783559560776, decouple_loss:0.009351864457130432
loss_pred:0.02561619132757187, decouple_loss:0.009144607000052929
Iteration: 430, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45154112577438354, gen p mean: -0.7500501275062561, mean p set: 0.45202142000198364
The modified gen p mean: 0.4511788487434387, gen p mean: -0.7467367053031921, mean p set: 0.4516591429710388
The modified gen p mean: 0.452044278383255, gen p mean: -0.7552406191825867, mean p set: 0.4525245428085327
loss_pred:0.02727898396551609, decouple_loss:0.00961377751082182
loss_pred:0.025955673307180405, decouple_loss:0.00949860643595457
loss_pred:0.02533223293721676, decouple_loss:0.009543182328343391
2023-05-05 17:16:35 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.7681705951690674, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7551251649856567, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7605797648429871, mean p set: 0.4500633478164673
loss_pred:0.02830718457698822, decouple_loss:0.01068144291639328
loss_pred:0.02668139524757862, decouple_loss:0.010425406508147717
loss_pred:0.02726529724895954, decouple_loss:0.010371080599725246
WV_0_PC_1_EH_0_PS_40_6, loss: 0.02794259414076805, avg_mse: 0.03383973240852356
current test mse: 0.03384
Iteration: 431, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4532906711101532, gen p mean: -0.7623751759529114, mean p set: 0.4537709653377533
The modified gen p mean: 0.4534396827220917, gen p mean: -0.7634693384170532, mean p set: 0.4539199471473694
loss_pred:0.026778720319271088, decouple_loss:0.009562975727021694
loss_pred:0.025242440402507782, decouple_loss:0.009314807131886482
The modified gen p mean: 0.45160356163978577, gen p mean: -0.7654594779014587, mean p set: 0.4520838260650635
loss_pred:0.027187729254364967, decouple_loss:0.009760159067809582
Iteration: 432, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511578679084778, gen p mean: -0.757236123085022, mean p set: 0.4516381621360779
The modified gen p mean: 0.44989460706710815, gen p mean: -0.7485264539718628, mean p set: 0.45037490129470825
The modified gen p mean: 0.4539720416069031, gen p mean: -0.7574219703674316, mean p set: 0.45445236563682556
loss_pred:0.027847591787576675, decouple_loss:0.009414746426045895
loss_pred:0.028075870126485825, decouple_loss:0.00935391616076231
loss_pred:0.027049459517002106, decouple_loss:0.009522349573671818
Iteration: 433, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4506746828556061, gen p mean: -0.7608623504638672, mean p set: 0.4511549472808838
The modified gen p mean: 0.45201635360717773, gen p mean: -0.7478482723236084, mean p set: 0.4524966776371002
loss_pred:0.027304356917738914, decouple_loss:0.008880600333213806
loss_pred:0.027570394799113274, decouple_loss:0.009380846284329891
The modified gen p mean: 0.45174503326416016, gen p mean: -0.7511521577835083, mean p set: 0.45222529768943787
loss_pred:0.027855807915329933, decouple_loss:0.009158024564385414
Iteration: 434, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45178964734077454, gen p mean: -0.7647223472595215, mean p set: 0.45226994156837463
The modified gen p mean: 0.4512425363063812, gen p mean: -0.7732780575752258, mean p set: 0.4517228305339813
The modified gen p mean: 0.4513789713382721, gen p mean: -0.7564402222633362, mean p set: 0.4518592655658722
loss_pred:0.026021061465144157, decouple_loss:0.009566052816808224
loss_pred:0.027609894052147865, decouple_loss:0.009901884943246841
loss_pred:0.02844369225203991, decouple_loss:0.009778694249689579
Iteration: 435, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45079344511032104, gen p mean: -0.741399347782135, mean p set: 0.45127376914024353
The modified gen p mean: 0.4502146244049072, gen p mean: -0.741726279258728, mean p set: 0.4506949186325073
The modified gen p mean: 0.4522682726383209, gen p mean: -0.7458319067955017, mean p set: 0.4527485966682434
loss_pred:0.02763405442237854, decouple_loss:0.009441514499485493
loss_pred:0.027800146490335464, decouple_loss:0.009444091469049454
loss_pred:0.02657424844801426, decouple_loss:0.009621098637580872
Iteration: 436, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45147013664245605, gen p mean: -0.7411119937896729, mean p set: 0.45195040106773376
The modified gen p mean: 0.4505062401294708, gen p mean: -0.739843487739563, mean p set: 0.45098650455474854
loss_pred:0.02647513337433338, decouple_loss:0.009797941893339157
loss_pred:0.026054197922348976, decouple_loss:0.009559784084558487
The modified gen p mean: 0.4514380693435669, gen p mean: -0.7360981702804565, mean p set: 0.451918363571167
loss_pred:0.026633284986019135, decouple_loss:0.009980397298932076
Iteration: 437, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514394700527191, gen p mean: -0.733643114566803, mean p set: 0.4519197940826416
The modified gen p mean: 0.45112621784210205, gen p mean: -0.7458391785621643, mean p set: 0.45160651206970215
loss_pred:0.02691001631319523, decouple_loss:0.009423044510185719
loss_pred:0.02760571986436844, decouple_loss:0.009320501238107681
The modified gen p mean: 0.45016083121299744, gen p mean: -0.7420205473899841, mean p set: 0.45064112544059753
loss_pred:0.02740427479147911, decouple_loss:0.009114000014960766
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012007_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012007_3_24hr.npz
NaN value num: 0
Iteration: 438, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475768804550171, gen p mean: -0.7525022029876709, mean p set: 0.4480571746826172
The modified gen p mean: 0.4474042057991028, gen p mean: -0.7478674650192261, mean p set: 0.4478845000267029
The modified gen p mean: 0.4482411742210388, gen p mean: -0.7583706974983215, mean p set: 0.4487214982509613
loss_pred:0.026843445375561714, decouple_loss:0.011293689720332623loss_pred:0.027620691806077957, decouple_loss:0.011543527245521545
loss_pred:0.02797464095056057, decouple_loss:0.011219383217394352
Iteration: 439, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44702863693237305, gen p mean: -0.7480320930480957, mean p set: 0.44750893115997314
The modified gen p mean: 0.44771867990493774, gen p mean: -0.7509205937385559, mean p set: 0.44819900393486023
The modified gen p mean: 0.4494439363479614, gen p mean: -0.7609172463417053, mean p set: 0.4499242305755615
loss_pred:0.026448745280504227, decouple_loss:0.01062154769897461
loss_pred:0.02626945450901985, decouple_loss:0.010804635472595692
loss_pred:0.025507597252726555, decouple_loss:0.012067234143614769
Iteration: 440, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472527801990509, gen p mean: -0.7392217516899109, mean p set: 0.4477330446243286
The modified gen p mean: 0.4477846920490265, gen p mean: -0.7418919801712036, mean p set: 0.4482649564743042
loss_pred:0.026692470535635948, decouple_loss:0.010695768520236015
loss_pred:0.027048330754041672, decouple_loss:0.010694301687180996
The modified gen p mean: 0.448089063167572, gen p mean: -0.7355275750160217, mean p set: 0.4485693573951721
loss_pred:0.026000453159213066, decouple_loss:0.010655481368303299
2023-05-05 17:21:14 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.7394489049911499, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7262477278709412, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.7314092516899109, mean p set: 0.4500633478164673
loss_pred:0.027853146195411682, decouple_loss:0.010589981451630592
loss_pred:0.026591554284095764, decouple_loss:0.01066040899604559
loss_pred:0.027039509266614914, decouple_loss:0.010191450826823711
WV_0_PC_1_EH_0_PS_40_6, loss: 0.027685433626174927, avg_mse: 0.03324272483587265
current test mse: 0.033243
Iteration: 441, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44832944869995117, gen p mean: -0.73117995262146, mean p set: 0.4488097131252289
The modified gen p mean: 0.44678202271461487, gen p mean: -0.7360414266586304, mean p set: 0.44726231694221497
loss_pred:0.026925373822450638, decouple_loss:0.010404309257864952
loss_pred:0.028155872598290443, decouple_loss:0.010660012252628803
The modified gen p mean: 0.44762858748435974, gen p mean: -0.7472085356712341, mean p set: 0.4481089115142822
loss_pred:0.02721128799021244, decouple_loss:0.011144107207655907
Iteration: 442, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4458834230899811, gen p mean: -0.7290624976158142, mean p set: 0.44636374711990356
The modified gen p mean: 0.4468289613723755, gen p mean: -0.7334697842597961, mean p set: 0.447309285402298
The modified gen p mean: 0.44700509309768677, gen p mean: -0.7374382019042969, mean p set: 0.4474853575229645
loss_pred:0.026279065757989883, decouple_loss:0.010914986953139305
loss_pred:0.02582404389977455, decouple_loss:0.010272051207721233
loss_pred:0.025597358122467995, decouple_loss:0.010140513069927692
Iteration: 443, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471322298049927, gen p mean: -0.7282499670982361, mean p set: 0.4476125240325928
The modified gen p mean: 0.44795140624046326, gen p mean: -0.732780933380127, mean p set: 0.44843170046806335
loss_pred:0.026437709107995033, decouple_loss:0.010256672278046608
loss_pred:0.025497477501630783, decouple_loss:0.010260960087180138
The modified gen p mean: 0.4485644996166229, gen p mean: -0.7271251082420349, mean p set: 0.44904476404190063
loss_pred:0.026634933426976204, decouple_loss:0.010280899703502655
Iteration: 444, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45016229152679443, gen p mean: -0.7505857944488525, mean p set: 0.4506426155567169
The modified gen p mean: 0.4485395550727844, gen p mean: -0.7294538617134094, mean p set: 0.4490198791027069
The modified gen p mean: 0.448035329580307, gen p mean: -0.7420136332511902, mean p set: 0.4485156238079071
loss_pred:0.02532179094851017, decouple_loss:0.012451792135834694
loss_pred:0.026607394218444824, decouple_loss:0.01034166943281889
loss_pred:0.02598305605351925, decouple_loss:0.010916958563029766
Iteration: 445, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44823968410491943, gen p mean: -0.7429861426353455, mean p set: 0.44871997833251953
The modified gen p mean: 0.4470553696155548, gen p mean: -0.7446280121803284, mean p set: 0.4475356340408325
The modified gen p mean: 0.44784075021743774, gen p mean: -0.7530789375305176, mean p set: 0.44832107424736023
loss_pred:0.025657109916210175, decouple_loss:0.010670820251107216
loss_pred:0.02579832449555397, decouple_loss:0.010239528492093086
loss_pred:0.027359021827578545, decouple_loss:0.01114495936781168
Iteration: 446, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44716453552246094, gen p mean: -0.7545324563980103, mean p set: 0.4476448595523834
The modified gen p mean: 0.44707077741622925, gen p mean: -0.7575280666351318, mean p set: 0.44755110144615173
loss_pred:0.026712888851761818, decouple_loss:0.010551822371780872
loss_pred:0.026738325133919716, decouple_loss:0.010636773891746998
The modified gen p mean: 0.4482189118862152, gen p mean: -0.7573328614234924, mean p set: 0.4486992359161377
loss_pred:0.026607505977153778, decouple_loss:0.011565016582608223
Iteration: 447, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483628571033478, gen p mean: -0.7558795809745789, mean p set: 0.4488431215286255
The modified gen p mean: 0.4476761221885681, gen p mean: -0.7487767338752747, mean p set: 0.4481564164161682
The modified gen p mean: 0.4468555450439453, gen p mean: -0.7457134127616882, mean p set: 0.4473358392715454
loss_pred:0.025565387681126595, decouple_loss:0.010297183878719807
loss_pred:0.02618156187236309, decouple_loss:0.009984145872294903
loss_pred:0.025570735335350037, decouple_loss:0.009987928904592991
Iteration: 448, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447710245847702, gen p mean: -0.7447119355201721, mean p set: 0.4481905400753021
The modified gen p mean: 0.4466460645198822, gen p mean: -0.7382517457008362, mean p set: 0.4471263289451599
The modified gen p mean: 0.4475352168083191, gen p mean: -0.7436996102333069, mean p set: 0.4480155408382416
loss_pred:0.02540764771401882, decouple_loss:0.010178410448133945loss_pred:0.026301119476556778, decouple_loss:0.01005026325583458
loss_pred:0.027713753283023834, decouple_loss:0.010572103783488274
Iteration: 449, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44812509417533875, gen p mean: -0.7400705814361572, mean p set: 0.44860541820526123
The modified gen p mean: 0.4483945965766907, gen p mean: -0.754054844379425, mean p set: 0.4488748610019684
The modified gen p mean: 0.4480734169483185, gen p mean: -0.7512421011924744, mean p set: 0.4485537111759186
loss_pred:0.02663997747004032, decouple_loss:0.010214715264737606
loss_pred:0.02631964161992073, decouple_loss:0.01075585838407278
loss_pred:0.027270855382084846, decouple_loss:0.010500738397240639
Iteration: 450, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44904136657714844, gen p mean: -0.7569279670715332, mean p set: 0.44952166080474854
The modified gen p mean: 0.4475904405117035, gen p mean: -0.7513915300369263, mean p set: 0.4480707347393036
The modified gen p mean: 0.4482479691505432, gen p mean: -0.7434430122375488, mean p set: 0.4487282633781433
loss_pred:0.025752168148756027, decouple_loss:0.010267547331750393
loss_pred:0.026914607733488083, decouple_loss:0.010152018629014492
loss_pred:0.026425722986459732, decouple_loss:0.010019749402999878
2023-05-05 17:24:56 testing...
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7371106743812561, mean p set: 0.45035696029663086
The modified gen p mean: 0.4497888684272766, gen p mean: -0.7494810819625854, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7419713139533997, mean p set: 0.4500633478164673
loss_pred:0.02583828754723072, decouple_loss:0.010028336197137833
loss_pred:0.027206184342503548, decouple_loss:0.010059511289000511
loss_pred:0.02623107098042965, decouple_loss:0.009659511037170887
WV_0_PC_1_EH_0_PS_40_6, loss: 0.026920972391963005, avg_mse: 0.03214515000581741
current test mse: 0.032145
Iteration: 451, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482154846191406, gen p mean: -0.7590860724449158, mean p set: 0.44869574904441833
The modified gen p mean: 0.4461434781551361, gen p mean: -0.7360660433769226, mean p set: 0.4466237425804138
loss_pred:0.026373373344540596, decouple_loss:0.01053163968026638
loss_pred:0.02543233521282673, decouple_loss:0.00996557530015707
The modified gen p mean: 0.4477676451206207, gen p mean: -0.74997878074646, mean p set: 0.4482479691505432
loss_pred:0.026048462837934494, decouple_loss:0.009527225978672504
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 452, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44617775082588196, gen p mean: -0.7381738424301147, mean p set: 0.44665804505348206
The modified gen p mean: 0.44691556692123413, gen p mean: -0.7489796876907349, mean p set: 0.4473958909511566
loss_pred:0.025637108832597733, decouple_loss:0.009680788964033127
loss_pred:0.025904564186930656, decouple_loss:0.009537526406347752
The modified gen p mean: 0.44852304458618164, gen p mean: -0.7495652437210083, mean p set: 0.44900330901145935
loss_pred:0.025416500866413116, decouple_loss:0.009299710392951965
Iteration: 453, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489194452762604, gen p mean: -0.7659794092178345, mean p set: 0.44939976930618286
The modified gen p mean: 0.44800320267677307, gen p mean: -0.7466346621513367, mean p set: 0.4484834671020508
The modified gen p mean: 0.4464145600795746, gen p mean: -0.7414892911911011, mean p set: 0.4468948543071747
loss_pred:0.02514852024614811, decouple_loss:0.010630395263433456
loss_pred:0.025749601423740387, decouple_loss:0.008982782252132893
loss_pred:0.025045378133654594, decouple_loss:0.009046956896781921
Iteration: 454, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44793441891670227, gen p mean: -0.7581479549407959, mean p set: 0.44841471314430237
The modified gen p mean: 0.4479919970035553, gen p mean: -0.7634693384170532, mean p set: 0.448472261428833
The modified gen p mean: 0.4492429792881012, gen p mean: -0.7649735808372498, mean p set: 0.4497232735157013
loss_pred:0.025086017325520515, decouple_loss:0.009448538534343243loss_pred:0.026488730683922768, decouple_loss:0.009209307841956615
loss_pred:0.02486651949584484, decouple_loss:0.009837300516664982
Iteration: 455, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44881513714790344, gen p mean: -0.7598698735237122, mean p set: 0.44929543137550354
The modified gen p mean: 0.4495560824871063, gen p mean: -0.7484232783317566, mean p set: 0.4500364065170288
The modified gen p mean: 0.4500880539417267, gen p mean: -0.7504475116729736, mean p set: 0.4505683481693268
loss_pred:0.025677114725112915, decouple_loss:0.009660388343036175loss_pred:0.024912115186452866, decouple_loss:0.009112977422773838
loss_pred:0.02472803369164467, decouple_loss:0.009035046212375164
Iteration: 456, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478377103805542, gen p mean: -0.7460917830467224, mean p set: 0.4483180344104767
The modified gen p mean: 0.4468880593776703, gen p mean: -0.7342814207077026, mean p set: 0.447368323802948
The modified gen p mean: 0.44970178604125977, gen p mean: -0.7431670427322388, mean p set: 0.45018208026885986
loss_pred:0.02662331983447075, decouple_loss:0.009414652362465858loss_pred:0.026060601696372032, decouple_loss:0.009098830632865429
loss_pred:0.024207081645727158, decouple_loss:0.008540414273738861
Iteration: 457, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466298222541809, gen p mean: -0.7298285365104675, mean p set: 0.447110116481781
The modified gen p mean: 0.4484304189682007, gen p mean: -0.7472962737083435, mean p set: 0.4489106833934784
The modified gen p mean: 0.4474222660064697, gen p mean: -0.7349403500556946, mean p set: 0.4479025602340698
loss_pred:0.026778824627399445, decouple_loss:0.00886456947773695
loss_pred:0.026058748364448547, decouple_loss:0.009370897896587849
loss_pred:0.025213511660695076, decouple_loss:0.008680655620992184
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012002_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012002_3_24hr.npz
NaN value num: 0
Iteration: 458, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44840124249458313, gen p mean: -0.7368893623352051, mean p set: 0.4488815367221832
The modified gen p mean: 0.4476977586746216, gen p mean: -0.7374770045280457, mean p set: 0.4481779932975769
The modified gen p mean: 0.4474162757396698, gen p mean: -0.7367026209831238, mean p set: 0.4478965699672699
loss_pred:0.027422768995165825, decouple_loss:0.009315868839621544
loss_pred:0.026187242940068245, decouple_loss:0.009363330900669098
loss_pred:0.02766331471502781, decouple_loss:0.009278330951929092
Iteration: 459, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500373899936676, gen p mean: -0.7570526003837585, mean p set: 0.4505176842212677
The modified gen p mean: 0.4516567587852478, gen p mean: -0.7603903412818909, mean p set: 0.4521370232105255
The modified gen p mean: 0.44889065623283386, gen p mean: -0.7563356161117554, mean p set: 0.4493709206581116
loss_pred:0.025549963116645813, decouple_loss:0.009370623156428337
loss_pred:0.026099149137735367, decouple_loss:0.009607866406440735
loss_pred:0.026469754055142403, decouple_loss:0.009202509187161922
Iteration: 460, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44972044229507446, gen p mean: -0.777388870716095, mean p set: 0.45020073652267456
The modified gen p mean: 0.45075008273124695, gen p mean: -0.7658454179763794, mean p set: 0.45123034715652466
The modified gen p mean: 0.44961124658584595, gen p mean: -0.768688976764679, mean p set: 0.45009157061576843
loss_pred:0.02495664171874523, decouple_loss:0.009277299046516418
loss_pred:0.025388766080141068, decouple_loss:0.008820229209959507
loss_pred:0.025428015738725662, decouple_loss:0.009189343079924583
2023-05-05 17:29:18 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.761252760887146, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7479320168495178, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7532321810722351, mean p set: 0.4500633478164673
loss_pred:0.02726232260465622, decouple_loss:0.009585368447005749
loss_pred:0.026007015258073807, decouple_loss:0.00920791830867529
loss_pred:0.026251045987010002, decouple_loss:0.009003515355288982
WV_0_PC_1_EH_0_PS_40_6, loss: 0.026970073580741882, avg_mse: 0.03235059231519699
current test mse: 0.032351
Iteration: 461, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487262964248657, gen p mean: -0.7591477632522583, mean p set: 0.44920656085014343
loss_pred:0.025872064754366875, decouple_loss:0.009417081251740456
The modified gen p mean: 0.4474261701107025, gen p mean: -0.7456348538398743, mean p set: 0.4479064643383026
loss_pred:0.02652513049542904, decouple_loss:0.00961917731910944
The modified gen p mean: 0.44836610555648804, gen p mean: -0.7609551548957825, mean p set: 0.44884639978408813
loss_pred:0.025283344089984894, decouple_loss:0.009402761235833168
Iteration: 462, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486277103424072, gen p mean: -0.7535858154296875, mean p set: 0.44910797476768494
The modified gen p mean: 0.4493548274040222, gen p mean: -0.7549964189529419, mean p set: 0.4498351216316223
The modified gen p mean: 0.44915971159935, gen p mean: -0.7583768367767334, mean p set: 0.4496400058269501
loss_pred:0.025146106258034706, decouple_loss:0.009442056529223919
loss_pred:0.02549797296524048, decouple_loss:0.009643224999308586
loss_pred:0.025818970054388046, decouple_loss:0.009690129198133945
Iteration: 463, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472678005695343, gen p mean: -0.741916298866272, mean p set: 0.447748064994812
The modified gen p mean: 0.4474972188472748, gen p mean: -0.7403109669685364, mean p set: 0.4479774832725525
loss_pred:0.02550482004880905, decouple_loss:0.009105720557272434
loss_pred:0.02602938376367092, decouple_loss:0.009433816187083721
The modified gen p mean: 0.448757529258728, gen p mean: -0.7448527216911316, mean p set: 0.44923779368400574
loss_pred:0.02718585915863514, decouple_loss:0.009387063793838024
Iteration: 464, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44738543033599854, gen p mean: -0.747485339641571, mean p set: 0.44786569476127625
The modified gen p mean: 0.448076993227005, gen p mean: -0.7480707168579102, mean p set: 0.4485572874546051
loss_pred:0.02562597207725048, decouple_loss:0.009142019785940647
loss_pred:0.026527266949415207, decouple_loss:0.009076523594558239
The modified gen p mean: 0.44669434428215027, gen p mean: -0.7350879311561584, mean p set: 0.447174608707428
loss_pred:0.027299167588353157, decouple_loss:0.009489513002336025
Iteration: 465, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44841739535331726, gen p mean: -0.7436111569404602, mean p set: 0.44889771938323975
The modified gen p mean: 0.4476599097251892, gen p mean: -0.74619060754776, mean p set: 0.4481402039527893
The modified gen p mean: 0.4489346146583557, gen p mean: -0.7448679208755493, mean p set: 0.4494149386882782
loss_pred:0.026611467823386192, decouple_loss:0.008836304768919945
loss_pred:0.02595525234937668, decouple_loss:0.008939804509282112
loss_pred:0.02571883425116539, decouple_loss:0.00895676203072071
Iteration: 466, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44975507259368896, gen p mean: -0.743596613407135, mean p set: 0.4502353370189667
The modified gen p mean: 0.4473476707935333, gen p mean: -0.7408138513565063, mean p set: 0.44782793521881104
The modified gen p mean: 0.44975852966308594, gen p mean: -0.7432781457901001, mean p set: 0.45023879408836365
loss_pred:0.025546448305249214, decouple_loss:0.009170829318463802
loss_pred:0.02617700956761837, decouple_loss:0.008353216573596
loss_pred:0.026259170845150948, decouple_loss:0.009095621295273304
Iteration: 467, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44785284996032715, gen p mean: -0.7473849654197693, mean p set: 0.44833314418792725
The modified gen p mean: 0.4467901289463043, gen p mean: -0.7412621378898621, mean p set: 0.4472704529762268
The modified gen p mean: 0.448194295167923, gen p mean: -0.7478916645050049, mean p set: 0.44867458939552307
loss_pred:0.02661828137934208, decouple_loss:0.008725532330572605
loss_pred:0.02655193954706192, decouple_loss:0.008832905441522598
loss_pred:0.026924921199679375, decouple_loss:0.008758372627198696
Iteration: 468, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44819745421409607, gen p mean: -0.7415913939476013, mean p set: 0.44867774844169617
The modified gen p mean: 0.4472569227218628, gen p mean: -0.7455635666847229, mean p set: 0.4477371871471405
The modified gen p mean: 0.4489038288593292, gen p mean: -0.7444601655006409, mean p set: 0.4493841528892517
loss_pred:0.026075296103954315, decouple_loss:0.008683462627232075
loss_pred:0.025766119360923767, decouple_loss:0.008350850082933903
loss_pred:0.025957658886909485, decouple_loss:0.009203026071190834
Iteration: 469, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501930773258209, gen p mean: -0.7471771836280823, mean p set: 0.45067334175109863
The modified gen p mean: 0.44766315817832947, gen p mean: -0.7503629326820374, mean p set: 0.44814345240592957
The modified gen p mean: 0.4490068554878235, gen p mean: -0.7694578766822815, mean p set: 0.4494871497154236
loss_pred:0.025321077555418015, decouple_loss:0.008620786480605602
loss_pred:0.026546016335487366, decouple_loss:0.008139549754559994
loss_pred:0.02377667836844921, decouple_loss:0.008997594006359577
Iteration: 470, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491240084171295, gen p mean: -0.7695395946502686, mean p set: 0.4496042728424072
The modified gen p mean: 0.4490741789340973, gen p mean: -0.750500500202179, mean p set: 0.449554443359375
loss_pred:0.02375722862780094, decouple_loss:0.008794574066996574
loss_pred:0.02593398094177246, decouple_loss:0.00877340603619814
The modified gen p mean: 0.4479535222053528, gen p mean: -0.7511547803878784, mean p set: 0.44843384623527527
loss_pred:0.02654286101460457, decouple_loss:0.008297113701701164
2023-05-05 17:32:58 testing...
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7377191781997681, mean p set: 0.45035696029663086
The modified gen p mean: 0.449788898229599, gen p mean: -0.750160813331604, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830535888672, gen p mean: -0.7422113418579102, mean p set: 0.4500633478164673
loss_pred:0.02576281875371933, decouple_loss:0.008618339896202087
loss_pred:0.027199435979127884, decouple_loss:0.009005586616694927
loss_pred:0.026158593595027924, decouple_loss:0.008698639459908009
WV_0_PC_1_EH_0_PS_40_6, loss: 0.026812326163053513, avg_mse: 0.03211584687232971
current test mse: 0.032116
Iteration: 471, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478560984134674, gen p mean: -0.7421036958694458, mean p set: 0.4483363628387451
The modified gen p mean: 0.4486274719238281, gen p mean: -0.7512510418891907, mean p set: 0.44910773634910583
loss_pred:0.026405632495880127, decouple_loss:0.008395866490900517
loss_pred:0.02487737126648426, decouple_loss:0.008797094225883484
The modified gen p mean: 0.44819360971450806, gen p mean: -0.7426577210426331, mean p set: 0.44867387413978577
loss_pred:0.02548769861459732, decouple_loss:0.008553341962397099
Iteration: 472, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499562680721283, gen p mean: -0.7391718626022339, mean p set: 0.4504365622997284
The modified gen p mean: 0.4475484788417816, gen p mean: -0.7375186085700989, mean p set: 0.4480287730693817
The modified gen p mean: 0.4488057792186737, gen p mean: -0.7388685345649719, mean p set: 0.4492860734462738
loss_pred:0.024610485881567, decouple_loss:0.008791336789727211
loss_pred:0.026933178305625916, decouple_loss:0.007977781817317009
loss_pred:0.02574038878083229, decouple_loss:0.008713265880942345
Iteration: 473, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488476812839508, gen p mean: -0.7614215016365051, mean p set: 0.4493279755115509
The modified gen p mean: 0.4490821361541748, gen p mean: -0.7462531924247742, mean p set: 0.4495624303817749
loss_pred:0.023761678487062454, decouple_loss:0.00849943794310093
The modified gen p mean: 0.4489430785179138, gen p mean: -0.7423592209815979, mean p set: 0.4494233727455139
loss_pred:0.025349972769618034, decouple_loss:0.00838735606521368
loss_pred:0.02622772566974163, decouple_loss:0.008664079010486603
Iteration: 474, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471130073070526, gen p mean: -0.7376985549926758, mean p set: 0.4475933015346527
The modified gen p mean: 0.4486962556838989, gen p mean: -0.7469204068183899, mean p set: 0.449176549911499
The modified gen p mean: 0.44798243045806885, gen p mean: -0.7575585842132568, mean p set: 0.44846272468566895
loss_pred:0.02659939043223858, decouple_loss:0.008699473924934864
loss_pred:0.02629084326326847, decouple_loss:0.008670596405863762
loss_pred:0.024079885333776474, decouple_loss:0.008368419483304024
Iteration: 475, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472696781158447, gen p mean: -0.7411944270133972, mean p set: 0.4477499723434448
The modified gen p mean: 0.4474325478076935, gen p mean: -0.7428562045097351, mean p set: 0.4479128420352936
The modified gen p mean: 0.44755735993385315, gen p mean: -0.7405536770820618, mean p set: 0.44803765416145325
loss_pred:0.026483701542019844, decouple_loss:0.00888542365282774
loss_pred:0.02526787668466568, decouple_loss:0.008536359295248985
loss_pred:0.02599979378283024, decouple_loss:0.00846145860850811
Iteration: 476, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44837766885757446, gen p mean: -0.7503347992897034, mean p set: 0.44885799288749695
The modified gen p mean: 0.44839343428611755, gen p mean: -0.7468583583831787, mean p set: 0.44887375831604004
The modified gen p mean: 0.44856277108192444, gen p mean: -0.7484992742538452, mean p set: 0.44904303550720215
loss_pred:0.027452053502202034, decouple_loss:0.008258390240371227loss_pred:0.02614620514214039, decouple_loss:0.008192300796508789
loss_pred:0.025842752307653427, decouple_loss:0.008265236392617226
Iteration: 477, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469147026538849, gen p mean: -0.7572790384292603, mean p set: 0.447394996881485
The modified gen p mean: 0.44811615347862244, gen p mean: -0.7504841089248657, mean p set: 0.44859644770622253
loss_pred:0.024783359840512276, decouple_loss:0.008284138515591621
loss_pred:0.02540096640586853, decouple_loss:0.008261655457317829
The modified gen p mean: 0.44979915022850037, gen p mean: -0.7544412612915039, mean p set: 0.4502794146537781
loss_pred:0.025951527059078217, decouple_loss:0.008402363397181034
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012010_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012010_3_24hr.npz
NaN value num: 0
Iteration: 478, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446433961391449, gen p mean: -0.7413838505744934, mean p set: 0.44691428542137146
The modified gen p mean: 0.44749343395233154, gen p mean: -0.7491613626480103, mean p set: 0.44797375798225403
The modified gen p mean: 0.4477154016494751, gen p mean: -0.7504708766937256, mean p set: 0.4481956660747528
loss_pred:0.027916936203837395, decouple_loss:0.008706974796950817
loss_pred:0.025836866348981857, decouple_loss:0.00863125454634428
loss_pred:0.026527950540184975, decouple_loss:0.00973460078239441
Iteration: 479, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468335509300232, gen p mean: -0.7337732315063477, mean p set: 0.4473138451576233The modified gen p mean: 0.44677478075027466, gen p mean: -0.7328377962112427, mean p set: 0.44725507497787476
The modified gen p mean: 0.4465268850326538, gen p mean: -0.7382755279541016, mean p set: 0.4470071494579315
loss_pred:0.02631259709596634, decouple_loss:0.009134352207183838
loss_pred:0.025886477902531624, decouple_loss:0.009113764390349388
loss_pred:0.02619650959968567, decouple_loss:0.009318534284830093
Iteration: 480, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4461376368999481, gen p mean: -0.7246440649032593, mean p set: 0.4466179311275482
The modified gen p mean: 0.44793900847435, gen p mean: -0.7298349738121033, mean p set: 0.44841933250427246
The modified gen p mean: 0.4475243091583252, gen p mean: -0.7334158420562744, mean p set: 0.4480046033859253
loss_pred:0.027410879731178284, decouple_loss:0.008468973450362682loss_pred:0.02621099352836609, decouple_loss:0.008664538152515888
loss_pred:0.025346539914608, decouple_loss:0.008227956481277943
2023-05-05 17:37:20 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.7422468066215515, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7295530438423157, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830237865448, gen p mean: -0.734108030796051, mean p set: 0.4500633478164673
loss_pred:0.026964830234646797, decouple_loss:0.008707313798367977
loss_pred:0.025959240272641182, decouple_loss:0.008477398194372654
loss_pred:0.025702379643917084, decouple_loss:0.00855314265936613
WV_0_PC_1_EH_0_PS_40_6, loss: 0.026637781411409378, avg_mse: 0.03185935318470001
current test mse: 0.031859
Iteration: 481, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44594743847846985, gen p mean: -0.7313773036003113, mean p set: 0.44642776250839233
The modified gen p mean: 0.4476871192455292, gen p mean: -0.7351507544517517, mean p set: 0.44816744327545166
loss_pred:0.02627846784889698, decouple_loss:0.009236234240233898
loss_pred:0.02661852166056633, decouple_loss:0.008730360306799412
The modified gen p mean: 0.4482315480709076, gen p mean: -0.7291838526725769, mean p set: 0.4487118422985077
loss_pred:0.02583988569676876, decouple_loss:0.008580649271607399
Iteration: 482, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44761788845062256, gen p mean: -0.7369697690010071, mean p set: 0.44809815287590027
The modified gen p mean: 0.44840723276138306, gen p mean: -0.7294211983680725, mean p set: 0.44888749718666077
The modified gen p mean: 0.4479389786720276, gen p mean: -0.7339720726013184, mean p set: 0.4484192430973053
loss_pred:0.025343315675854683, decouple_loss:0.00879665557295084
loss_pred:0.025404872372746468, decouple_loss:0.008500638417899609
loss_pred:0.027049686759710312, decouple_loss:0.008260903880000114
Iteration: 483, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44760996103286743, gen p mean: -0.7380433082580566, mean p set: 0.44809025526046753
The modified gen p mean: 0.44725489616394043, gen p mean: -0.7367967367172241, mean p set: 0.4477352201938629
The modified gen p mean: 0.4480937123298645, gen p mean: -0.730406641960144, mean p set: 0.4485739767551422
loss_pred:0.02585040032863617, decouple_loss:0.008346645161509514
loss_pred:0.025484628975391388, decouple_loss:0.008406620472669601
loss_pred:0.026256291195750237, decouple_loss:0.008226485922932625
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 484, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44809257984161377, gen p mean: -0.7352052927017212, mean p set: 0.4485728442668915
The modified gen p mean: 0.4480712413787842, gen p mean: -0.7331169247627258, mean p set: 0.4485515058040619
loss_pred:0.025520596653223038, decouple_loss:0.008255120366811752
loss_pred:0.027287572622299194, decouple_loss:0.00832650437951088
The modified gen p mean: 0.44717881083488464, gen p mean: -0.7308303713798523, mean p set: 0.44765913486480713
loss_pred:0.026389138773083687, decouple_loss:0.008159928023815155
Iteration: 485, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44819462299346924, gen p mean: -0.7360365390777588, mean p set: 0.4486749470233917
The modified gen p mean: 0.4473837912082672, gen p mean: -0.7340905070304871, mean p set: 0.4478640854358673
loss_pred:0.026719868183135986, decouple_loss:0.008389701135456562
loss_pred:0.025318598374724388, decouple_loss:0.00803146418184042
The modified gen p mean: 0.4476853907108307, gen p mean: -0.7327874302864075, mean p set: 0.4481656849384308
loss_pred:0.026173215359449387, decouple_loss:0.007960622198879719
Iteration: 486, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44711536169052124, gen p mean: -0.7439032196998596, mean p set: 0.44759562611579895
The modified gen p mean: 0.44754186272621155, gen p mean: -0.7313617467880249, mean p set: 0.44802215695381165
The modified gen p mean: 0.4484720230102539, gen p mean: -0.7343652248382568, mean p set: 0.448952317237854
loss_pred:0.025535479187965393, decouple_loss:0.00878166500478983loss_pred:0.02546604909002781, decouple_loss:0.008245045319199562
loss_pred:0.025809485465288162, decouple_loss:0.008304108865559101
Iteration: 487, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44698426127433777, gen p mean: -0.739656925201416, mean p set: 0.44746458530426025
The modified gen p mean: 0.4466010630130768, gen p mean: -0.7450124621391296, mean p set: 0.4470813572406769
The modified gen p mean: 0.4473322331905365, gen p mean: -0.7400870323181152, mean p set: 0.4478125274181366
loss_pred:0.02551816962659359, decouple_loss:0.008120979182422161
loss_pred:0.025816109031438828, decouple_loss:0.00828502420336008
loss_pred:0.025310270488262177, decouple_loss:0.00791096594184637
Iteration: 488, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481610953807831, gen p mean: -0.7334901094436646, mean p set: 0.4486413896083832
The modified gen p mean: 0.44772443175315857, gen p mean: -0.7351384162902832, mean p set: 0.44820475578308105
The modified gen p mean: 0.4483829140663147, gen p mean: -0.7366676926612854, mean p set: 0.4488631784915924
loss_pred:0.025106731802225113, decouple_loss:0.007861314341425896
loss_pred:0.026661325246095657, decouple_loss:0.008247489109635353
loss_pred:0.02640141174197197, decouple_loss:0.007976381108164787
Iteration: 489, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44764432311058044, gen p mean: -0.7429482936859131, mean p set: 0.44812464714050293
The modified gen p mean: 0.4472489655017853, gen p mean: -0.7332925200462341, mean p set: 0.447729229927063
The modified gen p mean: 0.44671371579170227, gen p mean: -0.7388443946838379, mean p set: 0.44719401001930237
loss_pred:0.026021679863333702, decouple_loss:0.007951604202389717loss_pred:0.02568056620657444, decouple_loss:0.007593337446451187
loss_pred:0.02665567398071289, decouple_loss:0.008002681657671928
Iteration: 490, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44604799151420593, gen p mean: -0.7390248775482178, mean p set: 0.4465283155441284
The modified gen p mean: 0.44590359926223755, gen p mean: -0.7439683079719543, mean p set: 0.44638389348983765
The modified gen p mean: 0.4472237527370453, gen p mean: -0.7480953931808472, mean p set: 0.4477040469646454
loss_pred:0.026519298553466797, decouple_loss:0.007821430452167988
loss_pred:0.024774642661213875, decouple_loss:0.008077447302639484
loss_pred:0.02523564174771309, decouple_loss:0.007820590399205685
2023-05-05 17:41:03 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.7507544755935669, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7386021614074707, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7430785894393921, mean p set: 0.4500633478164673
loss_pred:0.025572698563337326, decouple_loss:0.007882477715611458
loss_pred:0.026954418048262596, decouple_loss:0.00813030730932951
loss_pred:0.025851691141724586, decouple_loss:0.008020199835300446
WV_0_PC_1_EH_0_PS_40_6, loss: 0.02652681991457939, avg_mse: 0.03181202709674835
current test mse: 0.031812
Iteration: 491, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44708606600761414, gen p mean: -0.7417435646057129, mean p set: 0.44756636023521423
The modified gen p mean: 0.447325736284256, gen p mean: -0.737457811832428, mean p set: 0.4478060305118561
loss_pred:0.025882666930556297, decouple_loss:0.007850611582398415
loss_pred:0.025966720655560493, decouple_loss:0.007673368789255619
The modified gen p mean: 0.44836685061454773, gen p mean: -0.7424080967903137, mean p set: 0.44884711503982544
loss_pred:0.02568916790187359, decouple_loss:0.007565809413790703
Iteration: 492, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44724777340888977, gen p mean: -0.7349398136138916, mean p set: 0.4477280378341675
The modified gen p mean: 0.4463503658771515, gen p mean: -0.7410496473312378, mean p set: 0.4468306601047516
The modified gen p mean: 0.4477333128452301, gen p mean: -0.736929178237915, mean p set: 0.4482135772705078
loss_pred:0.026141129434108734, decouple_loss:0.007740159053355455
loss_pred:0.024641143158078194, decouple_loss:0.007478819228708744
loss_pred:0.02587101235985756, decouple_loss:0.007345918100327253
Iteration: 493, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479878544807434, gen p mean: -0.732567310333252, mean p set: 0.4484681785106659
The modified gen p mean: 0.44788992404937744, gen p mean: -0.7381042838096619, mean p set: 0.44837021827697754
The modified gen p mean: 0.44779473543167114, gen p mean: -0.7351818084716797, mean p set: 0.44827502965927124
loss_pred:0.026091208681464195, decouple_loss:0.007682862691581249
loss_pred:0.026127606630325317, decouple_loss:0.007380691822618246
loss_pred:0.025710329413414, decouple_loss:0.007631107233464718
Iteration: 494, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44749799370765686, gen p mean: -0.744860053062439, mean p set: 0.44797828793525696
The modified gen p mean: 0.4485854208469391, gen p mean: -0.7420975565910339, mean p set: 0.4490656852722168
The modified gen p mean: 0.44613924622535706, gen p mean: -0.7368144989013672, mean p set: 0.44661951065063477
loss_pred:0.025329194962978363, decouple_loss:0.007892044261097908
loss_pred:0.0262503270059824, decouple_loss:0.007474218495190144
loss_pred:0.025686483830213547, decouple_loss:0.007706788368523121
Iteration: 495, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44661808013916016, gen p mean: -0.7386857271194458, mean p set: 0.44709837436676025
The modified gen p mean: 0.4473015367984772, gen p mean: -0.7469752430915833, mean p set: 0.4477818012237549
The modified gen p mean: 0.44736284017562866, gen p mean: -0.7457396984100342, mean p set: 0.44784313440322876
loss_pred:0.026037029922008514, decouple_loss:0.007346293423324823
loss_pred:0.02511414885520935, decouple_loss:0.0074577946215868
loss_pred:0.02632930316030979, decouple_loss:0.007562075741589069
Iteration: 496, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44755229353904724, gen p mean: -0.7502717971801758, mean p set: 0.44803258776664734
The modified gen p mean: 0.4462706446647644, gen p mean: -0.742459237575531, mean p set: 0.4467509686946869
The modified gen p mean: 0.44676148891448975, gen p mean: -0.7533090114593506, mean p set: 0.44724181294441223
loss_pred:0.02558199129998684, decouple_loss:0.007890722714364529
loss_pred:0.026174837723374367, decouple_loss:0.007675510365515947
loss_pred:0.025108275935053825, decouple_loss:0.007743682246655226
Iteration: 497, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473102390766144, gen p mean: -0.7582433819770813, mean p set: 0.44779056310653687
The modified gen p mean: 0.4479029178619385, gen p mean: -0.752591073513031, mean p set: 0.44838324189186096
The modified gen p mean: 0.4478013515472412, gen p mean: -0.7496277689933777, mean p set: 0.4482816159725189
loss_pred:0.024940280243754387, decouple_loss:0.007739444728940725
loss_pred:0.026141254231333733, decouple_loss:0.00778026832267642
loss_pred:0.025999313220381737, decouple_loss:0.007402445189654827
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012016_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012016_3_24hr.npz
NaN value num: 0
Iteration: 498, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484577775001526, gen p mean: -0.7563416361808777, mean p set: 0.4489381015300751
The modified gen p mean: 0.44883424043655396, gen p mean: -0.7494908571243286, mean p set: 0.44931453466415405
The modified gen p mean: 0.45044204592704773, gen p mean: -0.7474468350410461, mean p set: 0.4509223401546478
loss_pred:0.026814185082912445, decouple_loss:0.008881768211722374
loss_pred:0.025863029062747955, decouple_loss:0.009768403135240078
loss_pred:0.02609509415924549, decouple_loss:0.008872227743268013
Iteration: 499, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44855111837387085, gen p mean: -0.7571537494659424, mean p set: 0.44903138279914856
The modified gen p mean: 0.44996967911720276, gen p mean: -0.7594558000564575, mean p set: 0.45045000314712524
The modified gen p mean: 0.4504496455192566, gen p mean: -0.7518215179443359, mean p set: 0.4509299099445343
loss_pred:0.026045288890600204, decouple_loss:0.00856353621929884
loss_pred:0.026380078867077827, decouple_loss:0.008683270774781704
loss_pred:0.025896910578012466, decouple_loss:0.009146654978394508
Iteration: 500, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45028096437454224, gen p mean: -0.7670295834541321, mean p set: 0.45076125860214233
The modified gen p mean: 0.44891878962516785, gen p mean: -0.7599690556526184, mean p set: 0.44939908385276794
The modified gen p mean: 0.44886690378189087, gen p mean: -0.7628410458564758, mean p set: 0.44934722781181335
loss_pred:0.025646310299634933, decouple_loss:0.008527289144694805
loss_pred:0.025064729154109955, decouple_loss:0.008814177475869656
loss_pred:0.025891801342368126, decouple_loss:0.008166158571839333
2023-05-05 17:45:24 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.7698073983192444, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7620226740837097, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7576985955238342, mean p set: 0.45035696029663086
loss_pred:0.02709662728011608, decouple_loss:0.008824927732348442
loss_pred:0.02614704705774784, decouple_loss:0.008465959690511227
loss_pred:0.025900615379214287, decouple_loss:0.008702374063432217
WV_0_PC_1_EH_0_PS_40_6, loss: 0.026814650744199753, avg_mse: 0.032312605530023575
current test mse: 0.032313
Iteration: 501, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495847821235657, gen p mean: -0.7650318145751953, mean p set: 0.45006507635116577
The modified gen p mean: 0.4485177993774414, gen p mean: -0.7582717537879944, mean p set: 0.4489981234073639
loss_pred:0.0269260685890913, decouple_loss:0.008581500500440598
loss_pred:0.025311559438705444, decouple_loss:0.008609865792095661
The modified gen p mean: 0.44888386130332947, gen p mean: -0.7557032108306885, mean p set: 0.4493641257286072
loss_pred:0.025205790996551514, decouple_loss:0.008709344081580639
Iteration: 502, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501352906227112, gen p mean: -0.7626623511314392, mean p set: 0.45061561465263367
The modified gen p mean: 0.44779255986213684, gen p mean: -0.756249189376831, mean p set: 0.44827285408973694
loss_pred:0.025225527584552765, decouple_loss:0.008254144340753555
loss_pred:0.02625887468457222, decouple_loss:0.008682087063789368
The modified gen p mean: 0.44972512125968933, gen p mean: -0.76058030128479, mean p set: 0.4502054452896118
loss_pred:0.02592257410287857, decouple_loss:0.007978780195116997
Iteration: 503, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44817909598350525, gen p mean: -0.7587038278579712, mean p set: 0.44865939021110535
The modified gen p mean: 0.44959649443626404, gen p mean: -0.7537004947662354, mean p set: 0.45007678866386414
The modified gen p mean: 0.449825257062912, gen p mean: -0.7495546340942383, mean p set: 0.4503055810928345
loss_pred:0.025945229455828667, decouple_loss:0.008520660921931267
loss_pred:0.026860836893320084, decouple_loss:0.00811974797397852
loss_pred:0.026248497888445854, decouple_loss:0.008332905359566212
Iteration: 504, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45015621185302734, gen p mean: -0.752792239189148, mean p set: 0.45063650608062744
The modified gen p mean: 0.44793638586997986, gen p mean: -0.7506330609321594, mean p set: 0.44841670989990234
loss_pred:0.026193300262093544, decouple_loss:0.007989062927663326
loss_pred:0.02588372305035591, decouple_loss:0.008305461145937443
The modified gen p mean: 0.4506303369998932, gen p mean: -0.7444095611572266, mean p set: 0.4511106312274933
loss_pred:0.02624507248401642, decouple_loss:0.008874326013028622
Iteration: 505, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495719373226166, gen p mean: -0.7511745095252991, mean p set: 0.45005226135253906
The modified gen p mean: 0.4492427706718445, gen p mean: -0.7509508728981018, mean p set: 0.4497230648994446
The modified gen p mean: 0.45041823387145996, gen p mean: -0.7412846684455872, mean p set: 0.45089852809906006
loss_pred:0.026128198951482773, decouple_loss:0.007893405854701996
loss_pred:0.02619803324341774, decouple_loss:0.008111505769193172
loss_pred:0.026122042909264565, decouple_loss:0.008779804222285748
Iteration: 506, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44792619347572327, gen p mean: -0.7461386919021606, mean p set: 0.44840651750564575
The modified gen p mean: 0.4479113817214966, gen p mean: -0.7486186623573303, mean p set: 0.4483916759490967
The modified gen p mean: 0.44713103771209717, gen p mean: -0.7541968822479248, mean p set: 0.4476113021373749
loss_pred:0.0262914951890707, decouple_loss:0.008376829326152802loss_pred:0.026444556191563606, decouple_loss:0.008312312886118889
loss_pred:0.026565074920654297, decouple_loss:0.00823073647916317
Iteration: 507, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45097795128822327, gen p mean: -0.7627201080322266, mean p set: 0.451458215713501
The modified gen p mean: 0.4502688944339752, gen p mean: -0.755527138710022, mean p set: 0.4507491886615753
The modified gen p mean: 0.4519200921058655, gen p mean: -0.7656686305999756, mean p set: 0.4524003565311432
loss_pred:0.025745274499058723, decouple_loss:0.008557620458304882
loss_pred:0.025578809902071953, decouple_loss:0.008419572375714779
loss_pred:0.025413325056433678, decouple_loss:0.008539569564163685
Iteration: 508, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4523296058177948, gen p mean: -0.7657723426818848, mean p set: 0.4528099000453949
The modified gen p mean: 0.4503604471683502, gen p mean: -0.7663014531135559, mean p set: 0.45084071159362793
The modified gen p mean: 0.4493057429790497, gen p mean: -0.7699717879295349, mean p set: 0.4497860372066498
loss_pred:0.025129975751042366, decouple_loss:0.00821451935917139
loss_pred:0.02473236434161663, decouple_loss:0.008151387795805931
loss_pred:0.02631274238228798, decouple_loss:0.00790201872587204
Iteration: 509, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44960471987724304, gen p mean: -0.7604231238365173, mean p set: 0.4500850439071655
The modified gen p mean: 0.44997620582580566, gen p mean: -0.7616587281227112, mean p set: 0.45045650005340576
The modified gen p mean: 0.44882020354270935, gen p mean: -0.7679450511932373, mean p set: 0.44930049777030945
loss_pred:0.025830034166574478, decouple_loss:0.00793907418847084
loss_pred:0.025112947449088097, decouple_loss:0.00820154044777155
loss_pred:0.025242531672120094, decouple_loss:0.008006631396710873
Iteration: 510, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4512498378753662, gen p mean: -0.7573983669281006, mean p set: 0.4517301619052887
The modified gen p mean: 0.45017972588539124, gen p mean: -0.7560789585113525, mean p set: 0.4506600499153137
The modified gen p mean: 0.4494689106941223, gen p mean: -0.7583376169204712, mean p set: 0.4499492049217224
loss_pred:0.025437133386731148, decouple_loss:0.008002140559256077
loss_pred:0.026014521718025208, decouple_loss:0.007629191502928734
loss_pred:0.024758977815508842, decouple_loss:0.007910886779427528
2023-05-05 17:49:02 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.7636030912399292, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7508726716041565, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.7557153105735779, mean p set: 0.4500633478164673
loss_pred:0.027159305289387703, decouple_loss:0.008631724864244461
loss_pred:0.02574843540787697, decouple_loss:0.008577145636081696
loss_pred:0.026068637147545815, decouple_loss:0.008442090824246407
WV_0_PC_1_EH_0_PS_40_6, loss: 0.026752976700663567, avg_mse: 0.03228466212749481
current test mse: 0.032285
Iteration: 511, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449876070022583, gen p mean: -0.7585869431495667, mean p set: 0.4503563344478607
The modified gen p mean: 0.44812336564064026, gen p mean: -0.7546176910400391, mean p set: 0.44860365986824036
loss_pred:0.02471420168876648, decouple_loss:0.007475703954696655
loss_pred:0.0254780575633049, decouple_loss:0.008055753074586391
The modified gen p mean: 0.44977957010269165, gen p mean: -0.7623521089553833, mean p set: 0.45025986433029175
loss_pred:0.025409450754523277, decouple_loss:0.007627901155501604
Iteration: 512, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45012331008911133, gen p mean: -0.7615568041801453, mean p set: 0.4506036043167114
The modified gen p mean: 0.4496050179004669, gen p mean: -0.7630168795585632, mean p set: 0.450085312128067
The modified gen p mean: 0.450557142496109, gen p mean: -0.7642643451690674, mean p set: 0.4510374367237091
loss_pred:0.025884315371513367, decouple_loss:0.007783616427332163
loss_pred:0.025253860279917717, decouple_loss:0.007938530296087265
loss_pred:0.025148997083306313, decouple_loss:0.008019831031560898
Iteration: 513, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503643810749054, gen p mean: -0.7581068277359009, mean p set: 0.4508446753025055
The modified gen p mean: 0.449848473072052, gen p mean: -0.7732347846031189, mean p set: 0.4503287672996521
The modified gen p mean: 0.4488801956176758, gen p mean: -0.7717476487159729, mean p set: 0.44936051964759827
loss_pred:0.02520289085805416, decouple_loss:0.008350584656000137
loss_pred:0.026231342926621437, decouple_loss:0.007471304386854172
loss_pred:0.02523818612098694, decouple_loss:0.007779086474329233
Iteration: 514, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45057058334350586, gen p mean: -0.759575366973877, mean p set: 0.45105084776878357
The modified gen p mean: 0.4481627643108368, gen p mean: -0.7613584399223328, mean p set: 0.4486430585384369
The modified gen p mean: 0.45000168681144714, gen p mean: -0.7707152962684631, mean p set: 0.45048198103904724
loss_pred:0.025775915011763573, decouple_loss:0.008208227343857288
loss_pred:0.025022953748703003, decouple_loss:0.008110075257718563
loss_pred:0.025262171402573586, decouple_loss:0.007640642113983631
Iteration: 515, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44890159368515015, gen p mean: -0.7665352821350098, mean p set: 0.44938188791275024
The modified gen p mean: 0.4481503665447235, gen p mean: -0.7727392911911011, mean p set: 0.448630690574646
The modified gen p mean: 0.44906988739967346, gen p mean: -0.7665279507637024, mean p set: 0.44955018162727356
loss_pred:0.024973023682832718, decouple_loss:0.007510867435485125
loss_pred:0.025019749999046326, decouple_loss:0.007463306188583374
loss_pred:0.02577483467757702, decouple_loss:0.0073204562067985535
Iteration: 516, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477386474609375, gen p mean: -0.7614867687225342, mean p set: 0.4482189118862152
The modified gen p mean: 0.449520468711853, gen p mean: -0.7653017044067383, mean p set: 0.45000073313713074
The modified gen p mean: 0.45065709948539734, gen p mean: -0.7688540816307068, mean p set: 0.45113739371299744
loss_pred:0.026289351284503937, decouple_loss:0.007686702534556389
loss_pred:0.02527756243944168, decouple_loss:0.00744224339723587
loss_pred:0.025113048031926155, decouple_loss:0.008010228164494038
Iteration: 517, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44763854146003723, gen p mean: -0.7684520483016968, mean p set: 0.44811883568763733
The modified gen p mean: 0.4481624960899353, gen p mean: -0.7662556171417236, mean p set: 0.448642760515213
The modified gen p mean: 0.44871675968170166, gen p mean: -0.7690266966819763, mean p set: 0.44919705390930176
loss_pred:0.025543220341205597, decouple_loss:0.00790357869118452
loss_pred:0.026378413662314415, decouple_loss:0.007767208851873875
loss_pred:0.025238700211048126, decouple_loss:0.007352001965045929
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012007_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012007_3_24hr.npz
NaN value num: 0
Iteration: 518, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45398035645484924, gen p mean: -0.7729116678237915, mean p set: 0.45446059107780457
The modified gen p mean: 0.4529424011707306, gen p mean: -0.7758359313011169, mean p set: 0.4534226953983307
The modified gen p mean: 0.45227062702178955, gen p mean: -0.7638466954231262, mean p set: 0.45275095105171204
loss_pred:0.024665847420692444, decouple_loss:0.008272608742117882
loss_pred:0.024073198437690735, decouple_loss:0.00796473678201437
loss_pred:0.024273034185171127, decouple_loss:0.008163130842149258
Iteration: 519, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4506838619709015, gen p mean: -0.7574793696403503, mean p set: 0.4511641561985016
The modified gen p mean: 0.4508441686630249, gen p mean: -0.7722119688987732, mean p set: 0.4513244330883026
The modified gen p mean: 0.45276230573654175, gen p mean: -0.7685570120811462, mean p set: 0.45324259996414185
loss_pred:0.024381784722208977, decouple_loss:0.008625601418316364
loss_pred:0.02629489079117775, decouple_loss:0.008528267964720726
loss_pred:0.023782137781381607, decouple_loss:0.007960107177495956
Iteration: 520, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4522453844547272, gen p mean: -0.7667990326881409, mean p set: 0.4527256488800049
The modified gen p mean: 0.45270630717277527, gen p mean: -0.7682467103004456, mean p set: 0.45318663120269775
loss_pred:0.02523312345147133, decouple_loss:0.008450215682387352
loss_pred:0.02463853359222412, decouple_loss:0.008129321038722992
The modified gen p mean: 0.4521689713001251, gen p mean: -0.7685156464576721, mean p set: 0.45264923572540283
loss_pred:0.024985773488879204, decouple_loss:0.008452794514596462
2023-05-05 17:53:23 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.7698867321014404, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7571002840995789, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.7621821761131287, mean p set: 0.4500633478164673
loss_pred:0.027113979682326317, decouple_loss:0.008868340402841568
loss_pred:0.025747671723365784, decouple_loss:0.008704517036676407
loss_pred:0.026046399027109146, decouple_loss:0.008614475838840008
WV_0_PC_1_EH_0_PS_40_6, loss: 0.02673913910984993, avg_mse: 0.03221071511507034
current test mse: 0.032211
Iteration: 521, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4527190923690796, gen p mean: -0.7681218981742859, mean p set: 0.4531993865966797
The modified gen p mean: 0.4522090256214142, gen p mean: -0.7650073766708374, mean p set: 0.4526892900466919
loss_pred:0.024389931932091713, decouple_loss:0.00792664010077715
loss_pred:0.025606069713830948, decouple_loss:0.007872011512517929
The modified gen p mean: 0.45233041048049927, gen p mean: -0.7603535652160645, mean p set: 0.45281070470809937
loss_pred:0.025455337017774582, decouple_loss:0.008173108100891113
Iteration: 522, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45048317313194275, gen p mean: -0.7684568762779236, mean p set: 0.45096346735954285
The modified gen p mean: 0.4520118534564972, gen p mean: -0.767586350440979, mean p set: 0.4524921178817749
The modified gen p mean: 0.45096471905708313, gen p mean: -0.763656735420227, mean p set: 0.4514450132846832
loss_pred:0.02651149034500122, decouple_loss:0.007990236394107342
loss_pred:0.0251790639013052, decouple_loss:0.00777645455673337
loss_pred:0.026196107268333435, decouple_loss:0.00809026975184679
Iteration: 523, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508700370788574, gen p mean: -0.762874186038971, mean p set: 0.4513503611087799
The modified gen p mean: 0.4508156180381775, gen p mean: -0.7571580410003662, mean p set: 0.4512959122657776
loss_pred:0.02632242441177368, decouple_loss:0.007807114161550999
loss_pred:0.024652861058712006, decouple_loss:0.00819325353950262
The modified gen p mean: 0.4505383372306824, gen p mean: -0.7641104459762573, mean p set: 0.4510186016559601
loss_pred:0.02584867738187313, decouple_loss:0.008023101836442947
Iteration: 524, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513258635997772, gen p mean: -0.7704030871391296, mean p set: 0.45180612802505493
The modified gen p mean: 0.45246726274490356, gen p mean: -0.7731722593307495, mean p set: 0.45294755697250366
loss_pred:0.026214994490146637, decouple_loss:0.00819622352719307
The modified gen p mean: 0.45180991291999817, gen p mean: -0.7657148241996765, mean p set: 0.45229020714759827
loss_pred:0.024727607145905495, decouple_loss:0.0074938819743692875
loss_pred:0.026298625394701958, decouple_loss:0.0077095334418118
Iteration: 525, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511820375919342, gen p mean: -0.767966628074646, mean p set: 0.4516623318195343
The modified gen p mean: 0.4498565196990967, gen p mean: -0.7734193205833435, mean p set: 0.4503368139266968
loss_pred:0.02613348327577114, decouple_loss:0.008032347075641155
loss_pred:0.02580040879547596, decouple_loss:0.007724650204181671
The modified gen p mean: 0.4513583779335022, gen p mean: -0.7720007300376892, mean p set: 0.4518386423587799
loss_pred:0.025806868448853493, decouple_loss:0.007858016528189182
Iteration: 526, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4536548852920532, gen p mean: -0.773666262626648, mean p set: 0.4541351795196533
The modified gen p mean: 0.4521505832672119, gen p mean: -0.7746344208717346, mean p set: 0.4526309072971344
The modified gen p mean: 0.45391300320625305, gen p mean: -0.7732120752334595, mean p set: 0.45439326763153076
loss_pred:0.02434726245701313, decouple_loss:0.00847497396171093
loss_pred:0.025327198207378387, decouple_loss:0.008237226866185665
loss_pred:0.024846354499459267, decouple_loss:0.008164096623659134
Iteration: 527, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4522281885147095, gen p mean: -0.7634110450744629, mean p set: 0.45270848274230957
The modified gen p mean: 0.453058660030365, gen p mean: -0.7682865858078003, mean p set: 0.4535389542579651
The modified gen p mean: 0.4507489502429962, gen p mean: -0.7568486332893372, mean p set: 0.4512292742729187
loss_pred:0.024905355647206306, decouple_loss:0.00840990711003542loss_pred:0.025732936337590218, decouple_loss:0.007876330986618996
loss_pred:0.02733289636671543, decouple_loss:0.008121310733258724
Iteration: 528, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4528367817401886, gen p mean: -0.7547253370285034, mean p set: 0.4533170461654663
The modified gen p mean: 0.45131009817123413, gen p mean: -0.7463218569755554, mean p set: 0.4517904222011566
The modified gen p mean: 0.45272040367126465, gen p mean: -0.756102979183197, mean p set: 0.45320072770118713
loss_pred:0.02452275902032852, decouple_loss:0.007975545711815357
loss_pred:0.02708260342478752, decouple_loss:0.00803835503757
loss_pred:0.02473466843366623, decouple_loss:0.008022104389965534
Iteration: 529, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511546194553375, gen p mean: -0.7528742551803589, mean p set: 0.4516349136829376
The modified gen p mean: 0.4513745903968811, gen p mean: -0.7512037754058838, mean p set: 0.4518548846244812
The modified gen p mean: 0.4510827362537384, gen p mean: -0.7521837949752808, mean p set: 0.4515630006790161
loss_pred:0.025890041142702103, decouple_loss:0.007970783859491348
loss_pred:0.02576836384832859, decouple_loss:0.0077337524853646755
loss_pred:0.026379115879535675, decouple_loss:0.007877030409872532
Iteration: 530, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45220547914505005, gen p mean: -0.7538651823997498, mean p set: 0.45268580317497253
The modified gen p mean: 0.4509720802307129, gen p mean: -0.7573853135108948, mean p set: 0.451452374458313
The modified gen p mean: 0.45082202553749084, gen p mean: -0.7400214672088623, mean p set: 0.45130228996276855
loss_pred:0.02620508335530758, decouple_loss:0.007617943454533815
loss_pred:0.025731220841407776, decouple_loss:0.007679420989006758
loss_pred:0.02430383674800396, decouple_loss:0.008086866699159145
2023-05-05 17:57:01 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.7666373252868652, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7539016008377075, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7589805126190186, mean p set: 0.4500633478164673
loss_pred:0.027345381677150726, decouple_loss:0.008662957698106766
loss_pred:0.025856437161564827, decouple_loss:0.008505593985319138
loss_pred:0.026042848825454712, decouple_loss:0.008456673473119736
WV_0_PC_1_EH_0_PS_40_6, loss: 0.02684197574853897, avg_mse: 0.03247561305761337
current test mse: 0.032476
Iteration: 531, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45141997933387756, gen p mean: -0.7493858933448792, mean p set: 0.4519002437591553
The modified gen p mean: 0.4510240852832794, gen p mean: -0.76050865650177, mean p set: 0.4515043795108795
loss_pred:0.023920733481645584, decouple_loss:0.007872193120419979
loss_pred:0.0257156603038311, decouple_loss:0.00776467053219676
The modified gen p mean: 0.4543343782424927, gen p mean: -0.7589784860610962, mean p set: 0.4548146724700928
loss_pred:0.024484604597091675, decouple_loss:0.007708316668868065
Iteration: 532, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45169582962989807, gen p mean: -0.7675963044166565, mean p set: 0.4521760940551758
The modified gen p mean: 0.4521137475967407, gen p mean: -0.76613450050354, mean p set: 0.4525940418243408
The modified gen p mean: 0.4527140259742737, gen p mean: -0.7647295594215393, mean p set: 0.4531942903995514
loss_pred:0.02579362317919731, decouple_loss:0.007879331707954407
loss_pred:0.025266820564866066, decouple_loss:0.0077016307041049
loss_pred:0.025069713592529297, decouple_loss:0.007813365198671818
Iteration: 533, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4528239965438843, gen p mean: -0.7671248912811279, mean p set: 0.4533042907714844
The modified gen p mean: 0.4524080455303192, gen p mean: -0.77785325050354, mean p set: 0.4528883397579193
The modified gen p mean: 0.45104166865348816, gen p mean: -0.7708208560943604, mean p set: 0.45152196288108826
loss_pred:0.02461262419819832, decouple_loss:0.00790153257548809
loss_pred:0.025184163823723793, decouple_loss:0.007507688365876675
loss_pred:0.025711264461278915, decouple_loss:0.0077776676043868065
Iteration: 534, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4522641897201538, gen p mean: -0.7676421403884888, mean p set: 0.4527444541454315
The modified gen p mean: 0.45347920060157776, gen p mean: -0.7663976550102234, mean p set: 0.45395946502685547
The modified gen p mean: 0.45271334052085876, gen p mean: -0.7579456567764282, mean p set: 0.45319366455078125
loss_pred:0.025475788861513138, decouple_loss:0.007377271074801683
loss_pred:0.024688562378287315, decouple_loss:0.007378961890935898
loss_pred:0.023669380694627762, decouple_loss:0.007366558071225882
Iteration: 535, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4516972601413727, gen p mean: -0.7533512115478516, mean p set: 0.4521775543689728
The modified gen p mean: 0.45221829414367676, gen p mean: -0.756402313709259, mean p set: 0.45269855856895447
The modified gen p mean: 0.45097970962524414, gen p mean: -0.7367803454399109, mean p set: 0.45146000385284424
loss_pred:0.02602289244532585, decouple_loss:0.007561189588159323
loss_pred:0.02433950826525688, decouple_loss:0.007575941272079945
loss_pred:0.024552933871746063, decouple_loss:0.007789790630340576
Iteration: 536, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45056912302970886, gen p mean: -0.7361904382705688, mean p set: 0.4510493874549866
The modified gen p mean: 0.4513487219810486, gen p mean: -0.7413055300712585, mean p set: 0.45182904601097107
The modified gen p mean: 0.4515138268470764, gen p mean: -0.7488793730735779, mean p set: 0.4519941210746765
loss_pred:0.027692807838320732, decouple_loss:0.0076769450679421425
loss_pred:0.02706974931061268, decouple_loss:0.007573812268674374
loss_pred:0.025554940104484558, decouple_loss:0.007445326540619135
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012014_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012014_3_24hr.npz
NaN value num: 0
Iteration: 537, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4509003162384033, gen p mean: -0.7568892240524292, mean p set: 0.4513806104660034
The modified gen p mean: 0.45149093866348267, gen p mean: -0.7521776556968689, mean p set: 0.45197123289108276
The modified gen p mean: 0.4522462785243988, gen p mean: -0.755348265171051, mean p set: 0.4527266025543213
loss_pred:0.027654455974698067, decouple_loss:0.007691213395446539
loss_pred:0.02731185033917427, decouple_loss:0.007866169326007366
loss_pred:0.0260071512311697, decouple_loss:0.007856301963329315
Iteration: 538, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44814273715019226, gen p mean: -0.7594512701034546, mean p set: 0.44862303137779236
The modified gen p mean: 0.44812560081481934, gen p mean: -0.7600650191307068, mean p set: 0.44860586524009705
The modified gen p mean: 0.4495542049407959, gen p mean: -0.7529544830322266, mean p set: 0.4500344693660736
loss_pred:0.026934608817100525, decouple_loss:0.008109882473945618
loss_pred:0.02783741056919098, decouple_loss:0.008210788480937481
loss_pred:0.027684299275279045, decouple_loss:0.007868072018027306
Iteration: 539, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484437108039856, gen p mean: -0.7375726103782654, mean p set: 0.4489240050315857
The modified gen p mean: 0.4500284194946289, gen p mean: -0.7469668984413147, mean p set: 0.450508713722229
The modified gen p mean: 0.45019152760505676, gen p mean: -0.7469516396522522, mean p set: 0.45067182183265686
loss_pred:0.02656254544854164, decouple_loss:0.008404524996876717
loss_pred:0.024907846003770828, decouple_loss:0.007807783782482147
loss_pred:0.025749176740646362, decouple_loss:0.008034749887883663
Iteration: 540, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4523509442806244, gen p mean: -0.7462766170501709, mean p set: 0.4528312385082245
The modified gen p mean: 0.4490867555141449, gen p mean: -0.745089054107666, mean p set: 0.449567049741745
The modified gen p mean: 0.452470064163208, gen p mean: -0.7515169978141785, mean p set: 0.4529503583908081
loss_pred:0.025285186246037483, decouple_loss:0.008325593546032906
loss_pred:0.027163200080394745, decouple_loss:0.00803713034838438
loss_pred:0.026460956782102585, decouple_loss:0.007737276144325733
2023-05-05 18:01:24 testing...
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7480477690696716, mean p set: 0.45035696029663086
The modified gen p mean: 0.449788898229599, gen p mean: -0.7611858248710632, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830535888672, gen p mean: -0.7530419826507568, mean p set: 0.4500633478164673
loss_pred:0.02611042745411396, decouple_loss:0.008396501652896404
loss_pred:0.02757854573428631, decouple_loss:0.00863639172166586loss_pred:0.026347335427999496, decouple_loss:0.008535029366612434
WV_0_PC_1_EH_0_PS_40_6, loss: 0.027104903012514114, avg_mse: 0.032791003584861755
current test mse: 0.032791
Iteration: 541, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494289457798004, gen p mean: -0.749678909778595, mean p set: 0.4499092102050781
The modified gen p mean: 0.44933462142944336, gen p mean: -0.7505888342857361, mean p set: 0.44981491565704346
loss_pred:0.025287827476859093, decouple_loss:0.007679378613829613
loss_pred:0.027741724625229836, decouple_loss:0.007677146699279547
The modified gen p mean: 0.4489746391773224, gen p mean: -0.7547693252563477, mean p set: 0.4494549334049225
loss_pred:0.027220191434025764, decouple_loss:0.00789871159940958
Iteration: 542, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4506986737251282, gen p mean: -0.7563311457633972, mean p set: 0.45117899775505066
The modified gen p mean: 0.44789406657218933, gen p mean: -0.7625774145126343, mean p set: 0.44837433099746704
The modified gen p mean: 0.4493236839771271, gen p mean: -0.754460871219635, mean p set: 0.4498039484024048
loss_pred:0.02565852180123329, decouple_loss:0.008105282671749592
loss_pred:0.02682861126959324, decouple_loss:0.007835693657398224
loss_pred:0.02680031582713127, decouple_loss:0.007769673131406307
Iteration: 543, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483394920825958, gen p mean: -0.7523343563079834, mean p set: 0.4488198161125183
The modified gen p mean: 0.4494033455848694, gen p mean: -0.7475349307060242, mean p set: 0.4498836100101471
The modified gen p mean: 0.44969624280929565, gen p mean: -0.7455613613128662, mean p set: 0.45017653703689575
loss_pred:0.027171391993761063, decouple_loss:0.007688087411224842loss_pred:0.027920862659811974, decouple_loss:0.007775457110255957
loss_pred:0.027133608236908913, decouple_loss:0.007873893715441227
Iteration: 544, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44875380396842957, gen p mean: -0.7577596306800842, mean p set: 0.4492340683937073
The modified gen p mean: 0.44838157296180725, gen p mean: -0.7590148448944092, mean p set: 0.44886186718940735
The modified gen p mean: 0.4518488645553589, gen p mean: -0.7629731893539429, mean p set: 0.4523291289806366
loss_pred:0.026455190032720566, decouple_loss:0.008216513320803642
loss_pred:0.02737499214708805, decouple_loss:0.007730220910161734
loss_pred:0.02576565369963646, decouple_loss:0.007894791662693024
Iteration: 545, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44990232586860657, gen p mean: -0.7559753060340881, mean p set: 0.45038262009620667
The modified gen p mean: 0.4510181248188019, gen p mean: -0.7644930481910706, mean p set: 0.45149844884872437
The modified gen p mean: 0.4508685767650604, gen p mean: -0.7642533183097839, mean p set: 0.4513488709926605
loss_pred:0.026326043531298637, decouple_loss:0.007742335554212332
loss_pred:0.025836242362856865, decouple_loss:0.008099101483821869
loss_pred:0.02611481212079525, decouple_loss:0.007885734550654888
Iteration: 546, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484897255897522, gen p mean: -0.7665657997131348, mean p set: 0.4489700198173523
The modified gen p mean: 0.44875484704971313, gen p mean: -0.7620639204978943, mean p set: 0.44923514127731323
The modified gen p mean: 0.4486936330795288, gen p mean: -0.7716540098190308, mean p set: 0.4491738975048065
loss_pred:0.026466798037290573, decouple_loss:0.0077633485198020935
loss_pred:0.02743416465818882, decouple_loss:0.00812399759888649
loss_pred:0.02777608297765255, decouple_loss:0.007524505257606506
Iteration: 547, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482707977294922, gen p mean: -0.7742869257926941, mean p set: 0.4487510621547699
The modified gen p mean: 0.450116902589798, gen p mean: -0.771629810333252, mean p set: 0.45059719681739807
The modified gen p mean: 0.4489068388938904, gen p mean: -0.7752717733383179, mean p set: 0.4493871033191681
loss_pred:0.02675330638885498, decouple_loss:0.007808983325958252
loss_pred:0.025237074121832848, decouple_loss:0.008016816340386868
loss_pred:0.02595232054591179, decouple_loss:0.00790509581565857
Iteration: 548, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44900038838386536, gen p mean: -0.7692396640777588, mean p set: 0.44948065280914307
The modified gen p mean: 0.4476169943809509, gen p mean: -0.7696520686149597, mean p set: 0.44809725880622864
The modified gen p mean: 0.44902458786964417, gen p mean: -0.7562950253486633, mean p set: 0.4495048522949219
loss_pred:0.026656510308384895, decouple_loss:0.007631543558090925
loss_pred:0.026408186182379723, decouple_loss:0.007643719669431448
loss_pred:0.026994824409484863, decouple_loss:0.007509209215641022
Iteration: 549, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44963744282722473, gen p mean: -0.7610892057418823, mean p set: 0.45011773705482483
The modified gen p mean: 0.4489809572696686, gen p mean: -0.7618898749351501, mean p set: 0.4494612514972687
The modified gen p mean: 0.45023342967033386, gen p mean: -0.7565595507621765, mean p set: 0.45071372389793396
loss_pred:0.026921214535832405, decouple_loss:0.007912871427834034
loss_pred:0.02673615701496601, decouple_loss:0.007828877307474613
loss_pred:0.025471080094575882, decouple_loss:0.0077735260128974915
Iteration: 550, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44825178384780884, gen p mean: -0.7529140114784241, mean p set: 0.44873207807540894
The modified gen p mean: 0.4513009190559387, gen p mean: -0.7595242857933044, mean p set: 0.4517812132835388
The modified gen p mean: 0.45051509141921997, gen p mean: -0.7623558044433594, mean p set: 0.45099538564682007
loss_pred:0.026081334799528122, decouple_loss:0.007759315427392721
loss_pred:0.025813821703195572, decouple_loss:0.007985481061041355
loss_pred:0.025182614102959633, decouple_loss:0.007823987863957882
2023-05-05 18:05:03 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.7727329730987549, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7604559659957886, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.7650872468948364, mean p set: 0.4500633478164673
loss_pred:0.027258049696683884, decouple_loss:0.008897014893591404
loss_pred:0.025882810354232788, decouple_loss:0.008617441169917583
loss_pred:0.02620064839720726, decouple_loss:0.00867454707622528
WV_0_PC_1_EH_0_PS_40_6, loss: 0.026883652433753014, avg_mse: 0.032467231154441833
current test mse: 0.032467
Iteration: 551, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490131437778473, gen p mean: -0.7642850279808044, mean p set: 0.4494934380054474
loss_pred:0.02580627240240574, decouple_loss:0.007782312575727701
The modified gen p mean: 0.4490962624549866, gen p mean: -0.7579990029335022, mean p set: 0.4495765268802643
loss_pred:0.02639385499060154, decouple_loss:0.007721626665443182
The modified gen p mean: 0.4497763216495514, gen p mean: -0.7575280666351318, mean p set: 0.4502566158771515
loss_pred:0.026638751849532127, decouple_loss:0.007771826349198818
Iteration: 552, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45081618428230286, gen p mean: -0.7550085186958313, mean p set: 0.45129647850990295
The modified gen p mean: 0.449812114238739, gen p mean: -0.7554056644439697, mean p set: 0.4502924084663391
The modified gen p mean: 0.44906073808670044, gen p mean: -0.7606192827224731, mean p set: 0.44954103231430054
loss_pred:0.02535094879567623, decouple_loss:0.007418422494083643loss_pred:0.026050178334116936, decouple_loss:0.007772944401949644
loss_pred:0.026143580675125122, decouple_loss:0.007932865992188454
Iteration: 553, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44966378808021545, gen p mean: -0.7458038926124573, mean p set: 0.45014408230781555
The modified gen p mean: 0.4501833915710449, gen p mean: -0.7593669891357422, mean p set: 0.450663685798645
The modified gen p mean: 0.4502731263637543, gen p mean: -0.7551776766777039, mean p set: 0.4507533609867096
loss_pred:0.026827652007341385, decouple_loss:0.007843892090022564loss_pred:0.024826113134622574, decouple_loss:0.0073695131577551365
loss_pred:0.0251197200268507, decouple_loss:0.007554820738732815
Iteration: 554, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4506288766860962, gen p mean: -0.7637673020362854, mean p set: 0.4511091411113739
The modified gen p mean: 0.45175960659980774, gen p mean: -0.7627490162849426, mean p set: 0.45223987102508545
The modified gen p mean: 0.45186713337898254, gen p mean: -0.7635264992713928, mean p set: 0.45234742760658264
loss_pred:0.025446392595767975, decouple_loss:0.007476437836885452
loss_pred:0.0249565988779068, decouple_loss:0.007412155158817768
loss_pred:0.0249999538064003, decouple_loss:0.007080201990902424
Iteration: 555, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44946563243865967, gen p mean: -0.7596738338470459, mean p set: 0.4499458968639374
The modified gen p mean: 0.4494486451148987, gen p mean: -0.7606602907180786, mean p set: 0.4499289393424988
The modified gen p mean: 0.44897106289863586, gen p mean: -0.7591522336006165, mean p set: 0.4494513273239136
loss_pred:0.026610780507326126, decouple_loss:0.007224177476018667
loss_pred:0.02594895474612713, decouple_loss:0.0071959407068789005
loss_pred:0.026703210547566414, decouple_loss:0.007359555922448635
Iteration: 556, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449733167886734, gen p mean: -0.7624742984771729, mean p set: 0.4502134323120117
The modified gen p mean: 0.4490300416946411, gen p mean: -0.74825519323349, mean p set: 0.4495103359222412
The modified gen p mean: 0.4487544894218445, gen p mean: -0.7626581192016602, mean p set: 0.4492347836494446
loss_pred:0.025434136390686035, decouple_loss:0.007222130428999662
loss_pred:0.027182845398783684, decouple_loss:0.0075932880863547325
loss_pred:0.0256384015083313, decouple_loss:0.0075738984160125256
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012009_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012009_3_24hr.npz
NaN value num: 0
Iteration: 557, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508478045463562, gen p mean: -0.7669318914413452, mean p set: 0.4513280689716339
The modified gen p mean: 0.44962507486343384, gen p mean: -0.770382285118103, mean p set: 0.45010536909103394
The modified gen p mean: 0.4497740864753723, gen p mean: -0.7635617852210999, mean p set: 0.4502543807029724
loss_pred:0.025137821212410927, decouple_loss:0.007323058322072029
loss_pred:0.026737138628959656, decouple_loss:0.007701992057263851
loss_pred:0.025077475234866142, decouple_loss:0.007644566707313061
Iteration: 558, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4527937173843384, gen p mean: -0.7669943571090698, mean p set: 0.4532740116119385
The modified gen p mean: 0.45086970925331116, gen p mean: -0.7719551920890808, mean p set: 0.45135000348091125
The modified gen p mean: 0.45034050941467285, gen p mean: -0.7632298469543457, mean p set: 0.45082080364227295
loss_pred:0.025249682366847992, decouple_loss:0.007842175662517548loss_pred:0.02518620900809765, decouple_loss:0.007529702968895435
loss_pred:0.02482394501566887, decouple_loss:0.00752151757478714
Iteration: 559, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511820375919342, gen p mean: -0.7658039331436157, mean p set: 0.4516623318195343
The modified gen p mean: 0.4513101875782013, gen p mean: -0.7704933285713196, mean p set: 0.4517904818058014
The modified gen p mean: 0.45142197608947754, gen p mean: -0.7673394680023193, mean p set: 0.45190224051475525
loss_pred:0.024931544438004494, decouple_loss:0.007257904391735792
loss_pred:0.02639959193766117, decouple_loss:0.007673459593206644
loss_pred:0.026268230751156807, decouple_loss:0.007890996523201466
Iteration: 560, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45043936371803284, gen p mean: -0.7525472044944763, mean p set: 0.4509196877479553
The modified gen p mean: 0.45053043961524963, gen p mean: -0.7578311562538147, mean p set: 0.45101073384284973
The modified gen p mean: 0.4510711431503296, gen p mean: -0.7535187602043152, mean p set: 0.4515514075756073
loss_pred:0.0266173854470253, decouple_loss:0.007828428409993649loss_pred:0.026154106482863426, decouple_loss:0.0075137317180633545
loss_pred:0.02641550451517105, decouple_loss:0.007762540131807327
2023-05-05 18:09:27 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.759864866733551, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7474601864814758, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7523542642593384, mean p set: 0.4500633478164673
loss_pred:0.027190083637833595, decouple_loss:0.008340049535036087
loss_pred:0.025807572528719902, decouple_loss:0.008160856552422047
loss_pred:0.026067620143294334, decouple_loss:0.008198670111596584
WV_0_PC_1_EH_0_PS_40_6, loss: 0.02676675282418728, avg_mse: 0.032390762120485306
current test mse: 0.032391
Iteration: 561, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4517834484577179, gen p mean: -0.7525191903114319, mean p set: 0.452263742685318
loss_pred:0.02502121962606907, decouple_loss:0.007416980341076851
The modified gen p mean: 0.4493976831436157, gen p mean: -0.7452249526977539, mean p set: 0.44987794756889343
loss_pred:0.02605961635708809, decouple_loss:0.007675555534660816
The modified gen p mean: 0.450502872467041, gen p mean: -0.750527024269104, mean p set: 0.4509831368923187
loss_pred:0.02627752348780632, decouple_loss:0.007317656185477972
Iteration: 562, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4517621397972107, gen p mean: -0.7690932750701904, mean p set: 0.4522424042224884
The modified gen p mean: 0.44928792119026184, gen p mean: -0.7542547583580017, mean p set: 0.4497682452201843
The modified gen p mean: 0.4516680836677551, gen p mean: -0.7597141265869141, mean p set: 0.4521483778953552
loss_pred:0.025250570848584175, decouple_loss:0.007443313021212816
loss_pred:0.02574964240193367, decouple_loss:0.007577237207442522
loss_pred:0.026199882850050926, decouple_loss:0.007281991187483072
Iteration: 563, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44959643483161926, gen p mean: -0.7629179954528809, mean p set: 0.45007672905921936
The modified gen p mean: 0.4498800039291382, gen p mean: -0.7593111395835876, mean p set: 0.4503602981567383
The modified gen p mean: 0.4517233669757843, gen p mean: -0.7706192135810852, mean p set: 0.452203631401062
loss_pred:0.025575287640094757, decouple_loss:0.007322930730879307
loss_pred:0.025480201467871666, decouple_loss:0.0071349055506289005
loss_pred:0.026013758033514023, decouple_loss:0.007170254364609718
Iteration: 564, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45124033093452454, gen p mean: -0.7699257731437683, mean p set: 0.45172062516212463
The modified gen p mean: 0.44981104135513306, gen p mean: -0.7594844698905945, mean p set: 0.45029133558273315
The modified gen p mean: 0.45179039239883423, gen p mean: -0.7751337289810181, mean p set: 0.4522706866264343
loss_pred:0.026595033705234528, decouple_loss:0.006904314737766981
loss_pred:0.02632163092494011, decouple_loss:0.007204555906355381
loss_pred:0.02629721909761429, decouple_loss:0.007102103903889656
Iteration: 565, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4510924518108368, gen p mean: -0.7723926305770874, mean p set: 0.4515727162361145
The modified gen p mean: 0.4525103271007538, gen p mean: -0.7686381936073303, mean p set: 0.4529906213283539
loss_pred:0.025140032172203064, decouple_loss:0.007262546569108963
loss_pred:0.0253014974296093, decouple_loss:0.00743676396086812
The modified gen p mean: 0.45099058747291565, gen p mean: -0.7668622136116028, mean p set: 0.45147088170051575
loss_pred:0.02486565336585045, decouple_loss:0.007615117821842432
Iteration: 566, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499562978744507, gen p mean: -0.7643924951553345, mean p set: 0.4504365921020508
The modified gen p mean: 0.45370423793792725, gen p mean: -0.7528318762779236, mean p set: 0.45418456196784973
The modified gen p mean: 0.4516625702381134, gen p mean: -0.7590054273605347, mean p set: 0.4521428644657135
loss_pred:0.02546573244035244, decouple_loss:0.007351875305175781
loss_pred:0.02472366765141487, decouple_loss:0.007080732844769955
loss_pred:0.02455093152821064, decouple_loss:0.006958856713026762
Iteration: 567, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44968274235725403, gen p mean: -0.755727231502533, mean p set: 0.4501630365848541
The modified gen p mean: 0.4494931399822235, gen p mean: -0.7475991249084473, mean p set: 0.449973464012146
The modified gen p mean: 0.4500633776187897, gen p mean: -0.7516921758651733, mean p set: 0.45054367184638977
loss_pred:0.02475774846971035, decouple_loss:0.007641233038157225
loss_pred:0.025797739624977112, decouple_loss:0.007034776732325554
loss_pred:0.02462785877287388, decouple_loss:0.0069562033750116825
Iteration: 568, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493584632873535, gen p mean: -0.745498538017273, mean p set: 0.4498387575149536
The modified gen p mean: 0.45031842589378357, gen p mean: -0.7538745999336243, mean p set: 0.45079872012138367
The modified gen p mean: 0.4499293267726898, gen p mean: -0.7413098812103271, mean p set: 0.4504096210002899
loss_pred:0.02621711604297161, decouple_loss:0.007530266419053078
loss_pred:0.026650620624423027, decouple_loss:0.007293315604329109
loss_pred:0.025813311338424683, decouple_loss:0.007095810957252979
Iteration: 569, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4518151879310608, gen p mean: -0.7551211714744568, mean p set: 0.4522954225540161
The modified gen p mean: 0.45151448249816895, gen p mean: -0.759057343006134, mean p set: 0.45199474692344666
The modified gen p mean: 0.45172128081321716, gen p mean: -0.7591714859008789, mean p set: 0.45220157504081726
loss_pred:0.025191258639097214, decouple_loss:0.007191414944827557
loss_pred:0.024900734424591064, decouple_loss:0.007350461557507515
loss_pred:0.025042075663805008, decouple_loss:0.007057394366711378
Iteration: 570, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45118770003318787, gen p mean: -0.7640389800071716, mean p set: 0.45166799426078796
The modified gen p mean: 0.4515420198440552, gen p mean: -0.7624248266220093, mean p set: 0.4520223140716553
The modified gen p mean: 0.4494588375091553, gen p mean: -0.7592648267745972, mean p set: 0.44993916153907776
loss_pred:0.025871098041534424, decouple_loss:0.007177579216659069loss_pred:0.02587779425084591, decouple_loss:0.007373122964054346
loss_pred:0.025043021887540817, decouple_loss:0.007544978987425566
2023-05-05 18:13:07 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.7732957005500793, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7612868547439575, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7658680081367493, mean p set: 0.4500633478164673
loss_pred:0.0272299163043499, decouple_loss:0.008110799826681614
loss_pred:0.025716161355376244, decouple_loss:0.007866430096328259
loss_pred:0.02603798359632492, decouple_loss:0.007838346995413303
WV_0_PC_1_EH_0_PS_40_6, loss: 0.02672494761645794, avg_mse: 0.032376084476709366
current test mse: 0.032376
Iteration: 571, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508407711982727, gen p mean: -0.7745569944381714, mean p set: 0.4513210654258728
The modified gen p mean: 0.4502943754196167, gen p mean: -0.7685269117355347, mean p set: 0.4507746696472168
loss_pred:0.025884689763188362, decouple_loss:0.007058402057737112
loss_pred:0.026611365377902985, decouple_loss:0.0072784447111189365
The modified gen p mean: 0.45117947459220886, gen p mean: -0.7705323100090027, mean p set: 0.4516597390174866
loss_pred:0.024876989424228668, decouple_loss:0.0071264104917645454
Iteration: 572, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45203572511672974, gen p mean: -0.7727051377296448, mean p set: 0.45251601934432983
The modified gen p mean: 0.4498148560523987, gen p mean: -0.7744356989860535, mean p set: 0.4502951502799988
The modified gen p mean: 0.4533882737159729, gen p mean: -0.7710212469100952, mean p set: 0.453868567943573
loss_pred:0.02515467442572117, decouple_loss:0.007096664980053902
loss_pred:0.025055674836039543, decouple_loss:0.0070390114560723305
loss_pred:0.025466766208410263, decouple_loss:0.0076260799542069435
Iteration: 573, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508695900440216, gen p mean: -0.7747462391853333, mean p set: 0.4513498842716217
The modified gen p mean: 0.452109694480896, gen p mean: -0.7720674872398376, mean p set: 0.4525899887084961
loss_pred:0.024813639000058174, decouple_loss:0.007087064441293478
loss_pred:0.024934373795986176, decouple_loss:0.006803504657000303
The modified gen p mean: 0.4514255225658417, gen p mean: -0.7746130228042603, mean p set: 0.451905757188797
loss_pred:0.025493906810879707, decouple_loss:0.006979023106396198
Iteration: 574, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4520491063594818, gen p mean: -0.7662734985351562, mean p set: 0.4525294005870819
The modified gen p mean: 0.4510827362537384, gen p mean: -0.7632760405540466, mean p set: 0.4515630006790161
The modified gen p mean: 0.45246824622154236, gen p mean: -0.760741114616394, mean p set: 0.45294854044914246
loss_pred:0.02526787482202053, decouple_loss:0.007075869012624025loss_pred:0.02482726238667965, decouple_loss:0.006864948198199272
loss_pred:0.024873914197087288, decouple_loss:0.006991918198764324
Iteration: 575, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45313552021980286, gen p mean: -0.7634661197662354, mean p set: 0.45361581444740295
The modified gen p mean: 0.4505032002925873, gen p mean: -0.756960391998291, mean p set: 0.4509834945201874
The modified gen p mean: 0.45180270075798035, gen p mean: -0.7687477469444275, mean p set: 0.45228299498558044
loss_pred:0.02526727132499218, decouple_loss:0.007122881710529327
loss_pred:0.025354165583848953, decouple_loss:0.007380571682006121
loss_pred:0.02539854682981968, decouple_loss:0.007072883658111095
Iteration: 576, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494033753871918, gen p mean: -0.7573436498641968, mean p set: 0.4498836398124695
The modified gen p mean: 0.4502983093261719, gen p mean: -0.7575756311416626, mean p set: 0.450778603553772
The modified gen p mean: 0.45193731784820557, gen p mean: -0.7684407830238342, mean p set: 0.45241761207580566
loss_pred:0.025655081495642662, decouple_loss:0.007051487453281879
loss_pred:0.025606056675314903, decouple_loss:0.006991379428654909
loss_pred:0.02525855228304863, decouple_loss:0.006694117095321417
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012013_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012013_3_24hr.npz
NaN value num: 0
Iteration: 577, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498560428619385, gen p mean: -0.7686471343040466, mean p set: 0.4503363370895386
The modified gen p mean: 0.45092812180519104, gen p mean: -0.773864209651947, mean p set: 0.45140841603279114
The modified gen p mean: 0.45071253180503845, gen p mean: -0.7710161805152893, mean p set: 0.45119279623031616
loss_pred:0.026347145438194275, decouple_loss:0.007283139508217573
loss_pred:0.025348249822854996, decouple_loss:0.0071989018470048904
loss_pred:0.026652425527572632, decouple_loss:0.007044798694550991
Iteration: 578, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45021581649780273, gen p mean: -0.7765218019485474, mean p set: 0.45069611072540283
The modified gen p mean: 0.4503313899040222, gen p mean: -0.7605723142623901, mean p set: 0.4508116841316223
loss_pred:0.025579700246453285, decouple_loss:0.007160463836044073
loss_pred:0.026614541187882423, decouple_loss:0.006892160512506962
The modified gen p mean: 0.45072245597839355, gen p mean: -0.77032071352005, mean p set: 0.45120275020599365
loss_pred:0.024850614368915558, decouple_loss:0.0070894076488912106
Iteration: 579, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502270221710205, gen p mean: -0.7707929015159607, mean p set: 0.4507073163986206
The modified gen p mean: 0.45062705874443054, gen p mean: -0.76650470495224, mean p set: 0.451107382774353
The modified gen p mean: 0.45018118619918823, gen p mean: -0.7690505981445312, mean p set: 0.45066148042678833
loss_pred:0.026331739500164986, decouple_loss:0.007235104218125343
loss_pred:0.025319375097751617, decouple_loss:0.007255403324961662
loss_pred:0.025434011593461037, decouple_loss:0.007432643324136734
Iteration: 580, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4506642520427704, gen p mean: -0.767963171005249, mean p set: 0.4511445164680481
The modified gen p mean: 0.44930556416511536, gen p mean: -0.762736439704895, mean p set: 0.44978588819503784
The modified gen p mean: 0.4504632353782654, gen p mean: -0.7713321447372437, mean p set: 0.4509435296058655
loss_pred:0.026518721133470535, decouple_loss:0.00697393249720335
loss_pred:0.027286753058433533, decouple_loss:0.00682110944762826
loss_pred:0.026194654405117035, decouple_loss:0.006861542817205191
2023-05-05 18:17:31 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.7743930816650391, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7626349925994873, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.7666889429092407, mean p set: 0.4500633478164673
loss_pred:0.027360109612345695, decouple_loss:0.008229774422943592
loss_pred:0.02591380476951599, decouple_loss:0.007843982428312302
loss_pred:0.026158161461353302, decouple_loss:0.00783038791269064
WV_0_PC_1_EH_0_PS_40_6, loss: 0.02687576226890087, avg_mse: 0.03270985186100006
current test mse: 0.03271
Iteration: 581, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45064085721969604, gen p mean: -0.7741381525993347, mean p set: 0.45112112164497375
The modified gen p mean: 0.4508408308029175, gen p mean: -0.7712475061416626, mean p set: 0.4513210952281952
loss_pred:0.025310369208455086, decouple_loss:0.0072080232203006744
loss_pred:0.025372611358761787, decouple_loss:0.007018120493739843
The modified gen p mean: 0.450836181640625, gen p mean: -0.7605447173118591, mean p set: 0.4513164758682251
loss_pred:0.025988835841417313, decouple_loss:0.006862287875264883
Iteration: 582, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44977468252182007, gen p mean: -0.7638251781463623, mean p set: 0.45025497674942017
The modified gen p mean: 0.4509217143058777, gen p mean: -0.7699449062347412, mean p set: 0.4514020085334778
loss_pred:0.02613576501607895, decouple_loss:0.006855332292616367
loss_pred:0.02622128836810589, decouple_loss:0.007157041225582361
The modified gen p mean: 0.45012181997299194, gen p mean: -0.7674909234046936, mean p set: 0.45060214400291443
loss_pred:0.026025842875242233, decouple_loss:0.006942677777260542
Iteration: 583, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497581422328949, gen p mean: -0.7562969923019409, mean p set: 0.450238436460495The modified gen p mean: 0.4474261403083801, gen p mean: -0.7586796879768372, mean p set: 0.4479064345359802
loss_pred:0.0262538343667984, decouple_loss:0.007470211945474148
loss_pred:0.026086922734975815, decouple_loss:0.007163062691688538
The modified gen p mean: 0.4486198127269745, gen p mean: -0.7649881839752197, mean p set: 0.4491001069545746
loss_pred:0.025995315983891487, decouple_loss:0.00719843665137887
Iteration: 584, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502499997615814, gen p mean: -0.7701443433761597, mean p set: 0.4507302939891815
The modified gen p mean: 0.4488906264305115, gen p mean: -0.7604811191558838, mean p set: 0.4493708908557892
The modified gen p mean: 0.45012766122817993, gen p mean: -0.7641849517822266, mean p set: 0.45060789585113525
loss_pred:0.02633765898644924, decouple_loss:0.007523142267018557loss_pred:0.026830989867448807, decouple_loss:0.007095312234014273
loss_pred:0.026311684399843216, decouple_loss:0.007400763686746359
Iteration: 585, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44987475872039795, gen p mean: -0.7681840658187866, mean p set: 0.45035505294799805
The modified gen p mean: 0.4491064250469208, gen p mean: -0.7646491527557373, mean p set: 0.44958674907684326
The modified gen p mean: 0.45033878087997437, gen p mean: -0.7640253305435181, mean p set: 0.45081907510757446
loss_pred:0.026161106303334236, decouple_loss:0.0069238427095115185
loss_pred:0.02641492523252964, decouple_loss:0.006679662968963385
loss_pred:0.02612723596394062, decouple_loss:0.007081883493810892
Iteration: 586, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490281939506531, gen p mean: -0.7545528411865234, mean p set: 0.4495084881782532The modified gen p mean: 0.45106902718544006, gen p mean: -0.7684628963470459, mean p set: 0.45154935121536255
The modified gen p mean: 0.4509749412536621, gen p mean: -0.7574988007545471, mean p set: 0.4514552056789398
loss_pred:0.026088770478963852, decouple_loss:0.007248918060213327
loss_pred:0.02671215310692787, decouple_loss:0.006809909362345934
loss_pred:0.026378415524959564, decouple_loss:0.006974050309509039
Iteration: 587, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503542184829712, gen p mean: -0.7628346681594849, mean p set: 0.4508344829082489
The modified gen p mean: 0.4493718445301056, gen p mean: -0.7596650123596191, mean p set: 0.4498521387577057
The modified gen p mean: 0.4493255913257599, gen p mean: -0.7494488954544067, mean p set: 0.4498059153556824
loss_pred:0.025479309260845184, decouple_loss:0.00710226921364665
loss_pred:0.026994090527296066, decouple_loss:0.007481403183192015
loss_pred:0.026551825925707817, decouple_loss:0.007166403811424971
Iteration: 588, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504499137401581, gen p mean: -0.7727022767066956, mean p set: 0.4509302079677582
The modified gen p mean: 0.44914960861206055, gen p mean: -0.761136531829834, mean p set: 0.44962990283966064
The modified gen p mean: 0.44861987233161926, gen p mean: -0.765844464302063, mean p set: 0.44910016655921936
loss_pred:0.025469297543168068, decouple_loss:0.007206835318356752
loss_pred:0.027016276493668556, decouple_loss:0.0071823266334831715
loss_pred:0.025900211185216904, decouple_loss:0.006924943998456001
Iteration: 589, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4506102502346039, gen p mean: -0.7661737203598022, mean p set: 0.451090544462204
The modified gen p mean: 0.4498402774333954, gen p mean: -0.7652227878570557, mean p set: 0.4503205716609955
The modified gen p mean: 0.45019635558128357, gen p mean: -0.7783560156822205, mean p set: 0.4506766200065613
loss_pred:0.024843405932188034, decouple_loss:0.007170780096203089
loss_pred:0.025968043133616447, decouple_loss:0.00702821696177125
loss_pred:0.025889024138450623, decouple_loss:0.006945039611309767
Iteration: 590, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492439329624176, gen p mean: -0.7565330266952515, mean p set: 0.4497242569923401
The modified gen p mean: 0.44862791895866394, gen p mean: -0.7577211856842041, mean p set: 0.44910821318626404
The modified gen p mean: 0.45036381483078003, gen p mean: -0.7588593363761902, mean p set: 0.45084407925605774
loss_pred:0.026489384472370148, decouple_loss:0.006786359939724207
loss_pred:0.02644590474665165, decouple_loss:0.007341239135712385
loss_pred:0.026362203061580658, decouple_loss:0.007052876520901918
2023-05-05 18:21:10 testing...
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7495880722999573, mean p set: 0.45035696029663086
The modified gen p mean: 0.4497888684272766, gen p mean: -0.7620024681091309, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7537444829940796, mean p set: 0.4500633478164673
loss_pred:0.025813855230808258, decouple_loss:0.007905114442110062
loss_pred:0.027023032307624817, decouple_loss:0.008238591253757477
loss_pred:0.025949863716959953, decouple_loss:0.007909318432211876
WV_0_PC_1_EH_0_PS_40_6, loss: 0.02666313573718071, avg_mse: 0.0323212556540966
current test mse: 0.032321
Iteration: 591, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502987563610077, gen p mean: -0.7589393258094788, mean p set: 0.4507790505886078
The modified gen p mean: 0.44876593351364136, gen p mean: -0.7549468874931335, mean p set: 0.44924622774124146
loss_pred:0.026214614510536194, decouple_loss:0.007141756359487772
loss_pred:0.02569963037967682, decouple_loss:0.007115404587239027
The modified gen p mean: 0.4492305815219879, gen p mean: -0.7462944984436035, mean p set: 0.449710875749588
loss_pred:0.026510611176490784, decouple_loss:0.006893071811646223
Iteration: 592, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45143356919288635, gen p mean: -0.7578496336936951, mean p set: 0.45191389322280884
The modified gen p mean: 0.4497682750225067, gen p mean: -0.7443262934684753, mean p set: 0.4502485692501068
The modified gen p mean: 0.45086777210235596, gen p mean: -0.7547709345817566, mean p set: 0.45134806632995605
loss_pred:0.02542894519865513, decouple_loss:0.007132137659937143
loss_pred:0.026293862611055374, decouple_loss:0.006878944113850594
loss_pred:0.02563955821096897, decouple_loss:0.007193163502961397
Iteration: 593, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498160183429718, gen p mean: -0.7585810422897339, mean p set: 0.4502963423728943
The modified gen p mean: 0.45089563727378845, gen p mean: -0.773154079914093, mean p set: 0.45137593150138855
The modified gen p mean: 0.4498802423477173, gen p mean: -0.7636845707893372, mean p set: 0.4503605365753174
loss_pred:0.02528657391667366, decouple_loss:0.007039730902761221
loss_pred:0.026313021779060364, decouple_loss:0.007121809758245945
loss_pred:0.025519434362649918, decouple_loss:0.007088335696607828
Iteration: 594, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45072975754737854, gen p mean: -0.7723463177680969, mean p set: 0.451210081577301
The modified gen p mean: 0.4487893283367157, gen p mean: -0.7690732479095459, mean p set: 0.4492696523666382
The modified gen p mean: 0.4475768506526947, gen p mean: -0.7677834630012512, mean p set: 0.4480571150779724
loss_pred:0.025890273973345757, decouple_loss:0.006848576478660107
loss_pred:0.025781694799661636, decouple_loss:0.006862672511488199
loss_pred:0.02590148337185383, decouple_loss:0.006850657984614372
Iteration: 595, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486290216445923, gen p mean: -0.7675763964653015, mean p set: 0.4491093158721924The modified gen p mean: 0.45052289962768555, gen p mean: -0.7707437872886658, mean p set: 0.45100319385528564
The modified gen p mean: 0.4491533041000366, gen p mean: -0.7692843079566956, mean p set: 0.4496335983276367
loss_pred:0.025513337925076485, decouple_loss:0.0066169388592243195
loss_pred:0.02643819898366928, decouple_loss:0.006868288852274418
loss_pred:0.02507021464407444, decouple_loss:0.0066986605525016785
Iteration: 596, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45121094584465027, gen p mean: -0.7662715315818787, mean p set: 0.451691210269928
The modified gen p mean: 0.4507967233657837, gen p mean: -0.7741764783859253, mean p set: 0.4512770175933838
The modified gen p mean: 0.45054304599761963, gen p mean: -0.7757492065429688, mean p set: 0.4510233402252197
loss_pred:0.02561575174331665, decouple_loss:0.00692068412899971
loss_pred:0.025739027187228203, decouple_loss:0.0071363565512001514
loss_pred:0.02587183564901352, decouple_loss:0.0070001352578401566
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012017_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012017_3_24hr.npz
NaN value num: 0
Iteration: 597, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474121332168579, gen p mean: -0.7644035220146179, mean p set: 0.447892427444458
The modified gen p mean: 0.44735920429229736, gen p mean: -0.761604905128479, mean p set: 0.4478394687175751
The modified gen p mean: 0.44781357049942017, gen p mean: -0.7618021368980408, mean p set: 0.4482938349246979
loss_pred:0.02671545371413231, decouple_loss:0.008034697733819485
loss_pred:0.02617376670241356, decouple_loss:0.008225155994296074
loss_pred:0.027022317051887512, decouple_loss:0.007899496704339981
Iteration: 598, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485308527946472, gen p mean: -0.7549441456794739, mean p set: 0.4490111172199249
The modified gen p mean: 0.44830814003944397, gen p mean: -0.7524392008781433, mean p set: 0.44878846406936646
The modified gen p mean: 0.4470321238040924, gen p mean: -0.7550978660583496, mean p set: 0.4475124180316925
loss_pred:0.025301549583673477, decouple_loss:0.007796706631779671loss_pred:0.025396183133125305, decouple_loss:0.007892953231930733
loss_pred:0.026128655299544334, decouple_loss:0.007887119427323341
Iteration: 599, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476214051246643, gen p mean: -0.7567799091339111, mean p set: 0.4481017291545868
The modified gen p mean: 0.4478228986263275, gen p mean: -0.7513847351074219, mean p set: 0.4483031630516052
The modified gen p mean: 0.448758602142334, gen p mean: -0.7545539140701294, mean p set: 0.4492388963699341
loss_pred:0.02641391195356846, decouple_loss:0.00751123670488596loss_pred:0.02558262087404728, decouple_loss:0.007718990556895733
loss_pred:0.025780750438570976, decouple_loss:0.007428106386214495
Iteration: 600, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482143223285675, gen p mean: -0.7574797868728638, mean p set: 0.44869464635849
The modified gen p mean: 0.44822442531585693, gen p mean: -0.7511004209518433, mean p set: 0.44870471954345703
loss_pred:0.0258580781519413, decouple_loss:0.007254775147885084
The modified gen p mean: 0.4482062757015228, gen p mean: -0.7558295726776123, mean p set: 0.4486865699291229
loss_pred:0.02601342648267746, decouple_loss:0.007344242185354233
loss_pred:0.02569720149040222, decouple_loss:0.007362176198512316
2023-05-05 18:25:30 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.77190762758255, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7595208883285522, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.7640650868415833, mean p set: 0.4500633478164673
loss_pred:0.02687113545835018, decouple_loss:0.00792913418263197
loss_pred:0.02543075941503048, decouple_loss:0.007551443297415972
loss_pred:0.025722801685333252, decouple_loss:0.007872476242482662
WV_0_PC_1_EH_0_PS_40_6, loss: 0.026397449895739555, avg_mse: 0.031889770179986954
current test mse: 0.03189
Iteration: 601, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44872283935546875, gen p mean: -0.7710163593292236, mean p set: 0.44920313358306885
The modified gen p mean: 0.44816282391548157, gen p mean: -0.7614309191703796, mean p set: 0.44864311814308167
loss_pred:0.025259938091039658, decouple_loss:0.007626463193446398
loss_pred:0.025486638769507408, decouple_loss:0.007112984545528889
The modified gen p mean: 0.44700318574905396, gen p mean: -0.7652971744537354, mean p set: 0.44748347997665405
loss_pred:0.025776011869311333, decouple_loss:0.007656723726540804
Iteration: 602, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487875699996948, gen p mean: -0.7657944560050964, mean p set: 0.4492678940296173
The modified gen p mean: 0.4481227993965149, gen p mean: -0.7659640908241272, mean p set: 0.448603093624115
loss_pred:0.02523980289697647, decouple_loss:0.007369017694145441
loss_pred:0.025566602125763893, decouple_loss:0.0072893197648227215
The modified gen p mean: 0.4479132294654846, gen p mean: -0.7667396068572998, mean p set: 0.4483935534954071
loss_pred:0.024789324030280113, decouple_loss:0.007403260096907616
Iteration: 603, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44616711139678955, gen p mean: -0.7543620467185974, mean p set: 0.44664737582206726
The modified gen p mean: 0.4479690492153168, gen p mean: -0.7600205540657043, mean p set: 0.4484493136405945
The modified gen p mean: 0.4478556215763092, gen p mean: -0.7600699067115784, mean p set: 0.4483359158039093
loss_pred:0.026369204744696617, decouple_loss:0.007261788472533226
loss_pred:0.025133516639471054, decouple_loss:0.007293930742889643
loss_pred:0.025507517158985138, decouple_loss:0.007499014027416706
Iteration: 604, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44888073205947876, gen p mean: -0.7653363347053528, mean p set: 0.44936102628707886
The modified gen p mean: 0.4477509558200836, gen p mean: -0.7567716836929321, mean p set: 0.44823122024536133
The modified gen p mean: 0.44781047105789185, gen p mean: -0.756938099861145, mean p set: 0.44829073548316956
loss_pred:0.024889331310987473, decouple_loss:0.007967766374349594
loss_pred:0.026083748787641525, decouple_loss:0.007269924972206354
loss_pred:0.026343021541833878, decouple_loss:0.007213289849460125
Iteration: 605, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482780694961548, gen p mean: -0.7496808171272278, mean p set: 0.4487583637237549
The modified gen p mean: 0.44657102227211, gen p mean: -0.7500897645950317, mean p set: 0.4470512866973877
The modified gen p mean: 0.4478549063205719, gen p mean: -0.7528188228607178, mean p set: 0.448335200548172
loss_pred:0.02640083059668541, decouple_loss:0.006926878355443478
loss_pred:0.026404742151498795, decouple_loss:0.006798379588872194
loss_pred:0.02460089698433876, decouple_loss:0.007211738266050816
Iteration: 606, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478570818901062, gen p mean: -0.7588602304458618, mean p set: 0.4483374059200287
The modified gen p mean: 0.4473343789577484, gen p mean: -0.7533565163612366, mean p set: 0.44781461358070374
The modified gen p mean: 0.44809165596961975, gen p mean: -0.7500090599060059, mean p set: 0.44857192039489746
loss_pred:0.026698362082242966, decouple_loss:0.007009001448750496
loss_pred:0.02482854761183262, decouple_loss:0.006799142807722092
loss_pred:0.02646457590162754, decouple_loss:0.0067354729399085045
Iteration: 607, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477875232696533, gen p mean: -0.759876012802124, mean p set: 0.4482678174972534
The modified gen p mean: 0.44863346219062805, gen p mean: -0.7650635838508606, mean p set: 0.44911372661590576
The modified gen p mean: 0.4463730454444885, gen p mean: -0.7539491653442383, mean p set: 0.44685330986976624
loss_pred:0.025714637711644173, decouple_loss:0.007018759846687317
loss_pred:0.02528824470937252, decouple_loss:0.006764148827642202
loss_pred:0.026054643094539642, decouple_loss:0.007185283116996288
Iteration: 608, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479553699493408, gen p mean: -0.7545630931854248, mean p set: 0.4484356641769409
The modified gen p mean: 0.44832268357276917, gen p mean: -0.7549263834953308, mean p set: 0.4488029479980469
The modified gen p mean: 0.44740691781044006, gen p mean: -0.7515589594841003, mean p set: 0.4478871822357178
loss_pred:0.026549596339464188, decouple_loss:0.0069538503885269165
loss_pred:0.024796398356556892, decouple_loss:0.007024332415312529
loss_pred:0.02648419886827469, decouple_loss:0.006718893069773912
Iteration: 609, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480619728565216, gen p mean: -0.7531896233558655, mean p set: 0.4485422670841217
The modified gen p mean: 0.44800907373428345, gen p mean: -0.750819981098175, mean p set: 0.44848933815956116
The modified gen p mean: 0.44791844487190247, gen p mean: -0.7585288286209106, mean p set: 0.44839873909950256
loss_pred:0.025319410488009453, decouple_loss:0.007106019649654627
loss_pred:0.02506948448717594, decouple_loss:0.007111996412277222
loss_pred:0.026522880420088768, decouple_loss:0.006809782702475786
Iteration: 610, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44810548424720764, gen p mean: -0.7617630958557129, mean p set: 0.44858577847480774
The modified gen p mean: 0.4480210840702057, gen p mean: -0.7616286277770996, mean p set: 0.4485013484954834
The modified gen p mean: 0.44824522733688354, gen p mean: -0.7624921202659607, mean p set: 0.44872552156448364
loss_pred:0.025593621656298637, decouple_loss:0.007149276789277792loss_pred:0.02528291754424572, decouple_loss:0.007176633924245834
loss_pred:0.026520060375332832, decouple_loss:0.007438368629664183
2023-05-05 18:29:08 testing...
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7553901672363281, mean p set: 0.45035696029663086
The modified gen p mean: 0.4497888684272766, gen p mean: -0.7679235935211182, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830833911896, gen p mean: -0.760242760181427, mean p set: 0.4500633478164673
loss_pred:0.025333642959594727, decouple_loss:0.00695676589384675
loss_pred:0.026721131056547165, decouple_loss:0.0072993128560483456
loss_pred:0.0256495401263237, decouple_loss:0.007030627224594355
WV_0_PC_1_EH_0_PS_40_6, loss: 0.026256216689944267, avg_mse: 0.03174092248082161
current test mse: 0.031741
Iteration: 611, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44745364785194397, gen p mean: -0.7585320472717285, mean p set: 0.4479339122772217
The modified gen p mean: 0.44811657071113586, gen p mean: -0.7642200589179993, mean p set: 0.4485968351364136
loss_pred:0.026015393435955048, decouple_loss:0.0069525837898254395
loss_pred:0.02472824603319168, decouple_loss:0.007087155245244503
The modified gen p mean: 0.44762372970581055, gen p mean: -0.7621433734893799, mean p set: 0.44810402393341064
loss_pred:0.02473355270922184, decouple_loss:0.006804597098380327
Iteration: 612, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44692251086235046, gen p mean: -0.7525940537452698, mean p set: 0.44740280508995056
The modified gen p mean: 0.44816482067108154, gen p mean: -0.7591972351074219, mean p set: 0.44864511489868164
The modified gen p mean: 0.44752660393714905, gen p mean: -0.7595441341400146, mean p set: 0.44800689816474915
loss_pred:0.025579309090971947, decouple_loss:0.007193919271230698
loss_pred:0.02534531056880951, decouple_loss:0.006773701403290033
loss_pred:0.02539658360183239, decouple_loss:0.006966331508010626
Iteration: 613, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44797733426094055, gen p mean: -0.750526487827301, mean p set: 0.44845762848854065The modified gen p mean: 0.44890785217285156, gen p mean: -0.7573205232620239, mean p set: 0.44938814640045166
The modified gen p mean: 0.44676509499549866, gen p mean: -0.7571147084236145, mean p set: 0.44724538922309875
loss_pred:0.026385260745882988, decouple_loss:0.00698455423116684loss_pred:0.02465548925101757, decouple_loss:0.007326594088226557
loss_pred:0.026539819315075874, decouple_loss:0.007156044710427523
Iteration: 614, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44783005118370056, gen p mean: -0.7725306153297424, mean p set: 0.44831034541130066
The modified gen p mean: 0.44730228185653687, gen p mean: -0.7672916650772095, mean p set: 0.4477825164794922
loss_pred:0.02652369812130928, decouple_loss:0.006869902368634939
loss_pred:0.026094336062669754, decouple_loss:0.006981816608458757
The modified gen p mean: 0.4472324848175049, gen p mean: -0.7696849703788757, mean p set: 0.447712779045105
loss_pred:0.025668514892458916, decouple_loss:0.007191057316958904
Iteration: 615, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44783854484558105, gen p mean: -0.7656233310699463, mean p set: 0.44831880927085876
The modified gen p mean: 0.4474637806415558, gen p mean: -0.75630784034729, mean p set: 0.4479440450668335
The modified gen p mean: 0.4471516013145447, gen p mean: -0.7596083283424377, mean p set: 0.4476318955421448
loss_pred:0.025636114180088043, decouple_loss:0.007004834711551666
loss_pred:0.02568698860704899, decouple_loss:0.006749055813997984
loss_pred:0.02636229433119297, decouple_loss:0.0069423820823431015
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 616, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44879162311553955, gen p mean: -0.7582746148109436, mean p set: 0.44927188754081726
The modified gen p mean: 0.44823944568634033, gen p mean: -0.7532634139060974, mean p set: 0.44871973991394043
The modified gen p mean: 0.4484468698501587, gen p mean: -0.7551766037940979, mean p set: 0.4489271342754364
loss_pred:0.025205301120877266, decouple_loss:0.007066237740218639
loss_pred:0.02539246156811714, decouple_loss:0.00708696898072958
loss_pred:0.024745939299464226, decouple_loss:0.007071796339005232
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012004_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012004_3_24hr.npz
NaN value num: 0
Iteration: 617, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4520755112171173, gen p mean: -0.7584940195083618, mean p set: 0.4525558054447174
The modified gen p mean: 0.4507658779621124, gen p mean: -0.7614031434059143, mean p set: 0.45124614238739014
The modified gen p mean: 0.45272067189216614, gen p mean: -0.7524117827415466, mean p set: 0.45320096611976624
loss_pred:0.026451069861650467, decouple_loss:0.00851296354085207
loss_pred:0.02670632116496563, decouple_loss:0.00865265540778637
loss_pred:0.025413114577531815, decouple_loss:0.008768659085035324
Iteration: 618, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44923752546310425, gen p mean: -0.7553840279579163, mean p set: 0.44971778988838196
The modified gen p mean: 0.45085665583610535, gen p mean: -0.7529610991477966, mean p set: 0.45133697986602783
The modified gen p mean: 0.4513476490974426, gen p mean: -0.7651563882827759, mean p set: 0.45182791352272034
loss_pred:0.026220081374049187, decouple_loss:0.007933828979730606loss_pred:0.02563324384391308, decouple_loss:0.007843504659831524
loss_pred:0.026044731959700584, decouple_loss:0.008288058452308178
Iteration: 619, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4515461027622223, gen p mean: -0.775697648525238, mean p set: 0.4520263373851776
The modified gen p mean: 0.4491153657436371, gen p mean: -0.7644530534744263, mean p set: 0.44959568977355957
The modified gen p mean: 0.44974738359451294, gen p mean: -0.7638623714447021, mean p set: 0.45022767782211304
loss_pred:0.02527952939271927, decouple_loss:0.007890359498560429
loss_pred:0.025456281378865242, decouple_loss:0.007801748812198639
loss_pred:0.02664470300078392, decouple_loss:0.008062035776674747
Iteration: 620, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496020972728729, gen p mean: -0.7540553212165833, mean p set: 0.450082391500473
The modified gen p mean: 0.45142248272895813, gen p mean: -0.7676060199737549, mean p set: 0.4519027769565582
The modified gen p mean: 0.45270460844039917, gen p mean: -0.7619149088859558, mean p set: 0.45318490266799927
loss_pred:0.024555472657084465, decouple_loss:0.007749509997665882loss_pred:0.025828851386904716, decouple_loss:0.00783915352076292
loss_pred:0.02616308629512787, decouple_loss:0.007735003717243671
2023-05-05 18:33:32 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.7636483907699585, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7564278244972229, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7515543699264526, mean p set: 0.45035696029663086
loss_pred:0.026675712317228317, decouple_loss:0.008380772545933723
loss_pred:0.025691337883472443, decouple_loss:0.008172623813152313
loss_pred:0.02540147863328457, decouple_loss:0.00827239453792572
WV_0_PC_1_EH_0_PS_40_6, loss: 0.026336606591939926, avg_mse: 0.03177895024418831
current test mse: 0.031779
Iteration: 621, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45043185353279114, gen p mean: -0.7549673318862915, mean p set: 0.45091211795806885
The modified gen p mean: 0.4487006664276123, gen p mean: -0.7470288872718811, mean p set: 0.44918093085289
loss_pred:0.026186322793364525, decouple_loss:0.00804635975509882
loss_pred:0.0255128126591444, decouple_loss:0.008052037097513676
The modified gen p mean: 0.45134004950523376, gen p mean: -0.7521656155586243, mean p set: 0.4518203139305115
loss_pred:0.02562522701919079, decouple_loss:0.007879767566919327
Iteration: 622, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488845467567444, gen p mean: -0.7410719394683838, mean p set: 0.4493648409843445
The modified gen p mean: 0.4499387741088867, gen p mean: -0.7428006529808044, mean p set: 0.4504190683364868
The modified gen p mean: 0.4521658420562744, gen p mean: -0.7500877380371094, mean p set: 0.4526461362838745
loss_pred:0.025562461465597153, decouple_loss:0.007784889545291662
loss_pred:0.026474453508853912, decouple_loss:0.008010901510715485
loss_pred:0.024591822177171707, decouple_loss:0.008449026383459568
Iteration: 623, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45371267199516296, gen p mean: -0.753730833530426, mean p set: 0.4541929364204407
The modified gen p mean: 0.45080551505088806, gen p mean: -0.7514377236366272, mean p set: 0.45128580927848816
The modified gen p mean: 0.4512578845024109, gen p mean: -0.7563140392303467, mean p set: 0.451738178730011
loss_pred:0.02596122771501541, decouple_loss:0.008601000532507896
loss_pred:0.025473207235336304, decouple_loss:0.008150259032845497
loss_pred:0.025456899777054787, decouple_loss:0.008310367353260517
Iteration: 624, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45213818550109863, gen p mean: -0.7413116097450256, mean p set: 0.45261847972869873
The modified gen p mean: 0.4516095221042633, gen p mean: -0.744961678981781, mean p set: 0.452089786529541
The modified gen p mean: 0.4491100013256073, gen p mean: -0.7398366332054138, mean p set: 0.4495902955532074
loss_pred:0.02575852908194065, decouple_loss:0.007794467732310295
loss_pred:0.02422516979277134, decouple_loss:0.00784844346344471
loss_pred:0.02530096285045147, decouple_loss:0.007876669988036156
Iteration: 625, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494071900844574, gen p mean: -0.7374763488769531, mean p set: 0.4498874545097351
The modified gen p mean: 0.4496880769729614, gen p mean: -0.740175724029541, mean p set: 0.4501683712005615
The modified gen p mean: 0.45052701234817505, gen p mean: -0.7368592619895935, mean p set: 0.45100730657577515
loss_pred:0.02485029771924019, decouple_loss:0.007887180894613266
loss_pred:0.0260237455368042, decouple_loss:0.007553595118224621
loss_pred:0.0263445395976305, decouple_loss:0.007984952069818974
Iteration: 626, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497973322868347, gen p mean: -0.7396526336669922, mean p set: 0.4502776563167572
The modified gen p mean: 0.45077332854270935, gen p mean: -0.748417854309082, mean p set: 0.45125362277030945
The modified gen p mean: 0.4531627595424652, gen p mean: -0.7523195743560791, mean p set: 0.4536430835723877
loss_pred:0.025273935869336128, decouple_loss:0.007884996011853218
loss_pred:0.025275366380810738, decouple_loss:0.007563143502920866
loss_pred:0.02636536955833435, decouple_loss:0.008061847649514675
Iteration: 627, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505396783351898, gen p mean: -0.7490639686584473, mean p set: 0.4510199725627899
The modified gen p mean: 0.4489477574825287, gen p mean: -0.745940625667572, mean p set: 0.4494280517101288
The modified gen p mean: 0.4515613913536072, gen p mean: -0.7533352971076965, mean p set: 0.4520416855812073
loss_pred:0.024714769795536995, decouple_loss:0.007609380874782801loss_pred:0.026177220046520233, decouple_loss:0.007409026380628347
loss_pred:0.02522660419344902, decouple_loss:0.007527871057391167
Iteration: 628, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44925418496131897, gen p mean: -0.751141369342804, mean p set: 0.4497344493865967
The modified gen p mean: 0.4512547254562378, gen p mean: -0.7597931027412415, mean p set: 0.4517350196838379
The modified gen p mean: 0.4526613652706146, gen p mean: -0.7572006583213806, mean p set: 0.45314162969589233
loss_pred:0.02538827247917652, decouple_loss:0.007627006620168686
loss_pred:0.025155453011393547, decouple_loss:0.00795118696987629
loss_pred:0.026098880916833878, decouple_loss:0.007803649641573429
Iteration: 629, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44855543971061707, gen p mean: -0.7478066682815552, mean p set: 0.4490357041358948
The modified gen p mean: 0.45236364006996155, gen p mean: -0.7508357763290405, mean p set: 0.45284390449523926
The modified gen p mean: 0.4532161355018616, gen p mean: -0.758621096611023, mean p set: 0.4536963999271393
loss_pred:0.02515908144414425, decouple_loss:0.007800695486366749
loss_pred:0.02611463889479637, decouple_loss:0.00795122142881155
loss_pred:0.025813836604356766, decouple_loss:0.007928923703730106
Iteration: 630, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504566490650177, gen p mean: -0.7495654821395874, mean p set: 0.4509369134902954
The modified gen p mean: 0.45225515961647034, gen p mean: -0.7588688135147095, mean p set: 0.45273545384407043
The modified gen p mean: 0.45084866881370544, gen p mean: -0.7484506368637085, mean p set: 0.45132896304130554
loss_pred:0.02636704035103321, decouple_loss:0.007787045557051897
loss_pred:0.02563830465078354, decouple_loss:0.008182735182344913
loss_pred:0.026083245873451233, decouple_loss:0.007636680267751217
2023-05-05 18:37:15 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.7588573098182678, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.746212363243103, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.7510814666748047, mean p set: 0.4500633478164673
loss_pred:0.027049660682678223, decouple_loss:0.008837712928652763
loss_pred:0.025650138035416603, decouple_loss:0.008403929881751537
loss_pred:0.02596779353916645, decouple_loss:0.008653846569359303
WV_0_PC_1_EH_0_PS_40_6, loss: 0.02665412239730358, avg_mse: 0.03233310952782631
current test mse: 0.032333
Iteration: 631, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45051953196525574, gen p mean: -0.7454045414924622, mean p set: 0.45099982619285583
The modified gen p mean: 0.45129385590553284, gen p mean: -0.7576707005500793, mean p set: 0.45177412033081055
loss_pred:0.025683864951133728, decouple_loss:0.007861040532588959
loss_pred:0.024816114455461502, decouple_loss:0.008288541808724403
The modified gen p mean: 0.45221543312072754, gen p mean: -0.7552502155303955, mean p set: 0.45269572734832764
loss_pred:0.02403486892580986, decouple_loss:0.008095523342490196
Iteration: 632, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45059874653816223, gen p mean: -0.7520193457603455, mean p set: 0.45107904076576233
The modified gen p mean: 0.45004647970199585, gen p mean: -0.7503505945205688, mean p set: 0.45052674412727356
The modified gen p mean: 0.45130518078804016, gen p mean: -0.7588081955909729, mean p set: 0.45178547501564026
loss_pred:0.025044512003660202, decouple_loss:0.007295204326510429
loss_pred:0.02542681060731411, decouple_loss:0.007904772646725178
loss_pred:0.024663234129548073, decouple_loss:0.007463451474905014
Iteration: 633, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514947235584259, gen p mean: -0.7650744318962097, mean p set: 0.451975017786026
The modified gen p mean: 0.4514922499656677, gen p mean: -0.7598769664764404, mean p set: 0.4519725739955902
loss_pred:0.025122065097093582, decouple_loss:0.007607319392263889
The modified gen p mean: 0.4509755074977875, gen p mean: -0.7521064281463623, mean p set: 0.4514558017253876
loss_pred:0.025937333703041077, decouple_loss:0.007476123049855232
loss_pred:0.02573472075164318, decouple_loss:0.007396858185529709
Iteration: 634, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496833384037018, gen p mean: -0.7578915357589722, mean p set: 0.4501636028289795
The modified gen p mean: 0.45158591866493225, gen p mean: -0.7650228142738342, mean p set: 0.45206621289253235
loss_pred:0.026186229661107063, decouple_loss:0.0077558779157698154
loss_pred:0.025684332475066185, decouple_loss:0.00736114289611578
The modified gen p mean: 0.4497767388820648, gen p mean: -0.7646386027336121, mean p set: 0.4502570331096649
loss_pred:0.026315614581108093, decouple_loss:0.007684606127440929
Iteration: 635, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4518240690231323, gen p mean: -0.7740468382835388, mean p set: 0.4523043632507324
The modified gen p mean: 0.45051440596580505, gen p mean: -0.7680861949920654, mean p set: 0.45099470019340515
The modified gen p mean: 0.4512452483177185, gen p mean: -0.7741134166717529, mean p set: 0.4517255127429962
loss_pred:0.024749325588345528, decouple_loss:0.007663974072784185
loss_pred:0.026330575346946716, decouple_loss:0.00737835792824626
loss_pred:0.025286173447966576, decouple_loss:0.007518394384533167
Iteration: 636, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493904411792755, gen p mean: -0.7653948068618774, mean p set: 0.4498707354068756
The modified gen p mean: 0.44854339957237244, gen p mean: -0.7616750597953796, mean p set: 0.44902369379997253
The modified gen p mean: 0.45173248648643494, gen p mean: -0.7703450322151184, mean p set: 0.45221275091171265
loss_pred:0.025677405297756195, decouple_loss:0.007455945480614901loss_pred:0.02523357979953289, decouple_loss:0.007369266822934151
loss_pred:0.025655576959252357, decouple_loss:0.007431665901094675
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012004_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012004_3_24hr.npz
NaN value num: 0
Traceback (most recent call last):
  File "/work/09012/haoli1/ls6/ERA5_PredRNN/predrnn-pytorch/run1.py", line 350, in <module>
    train_wrapper(model)
  File "/work/09012/haoli1/ls6/ERA5_PredRNN/predrnn-pytorch/run1.py", line 271, in train_wrapper
    ims = train_input_handle.get_batch()
  File "/work/09012/haoli1/ls6/ERA5_PredRNN/predrnn-pytorch/core/data_provider/mnist_new.py", line 133, in get_batch
    input_seq = self.input_batch()
  File "/work/09012/haoli1/ls6/ERA5_PredRNN/predrnn-pytorch/core/data_provider/mnist_new.py", line 128, in input_batch
    input_batch[i, :self.current_input_length, :, :, :] = data_slice
ValueError: could not broadcast input array from shape (56,3,720,1440) into shape (48,3,720,1440)