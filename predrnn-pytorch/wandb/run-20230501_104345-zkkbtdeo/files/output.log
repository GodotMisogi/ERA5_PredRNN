After initialize model, args.img_channel:3
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012000_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012001_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012002_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012003_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012004_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012005_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012006_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012007_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012008_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012009_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012010_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012011_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012012_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012013_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012014_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012015_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012016_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012017_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012018_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012019_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012020_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012000_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012001_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012002_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012003_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012004_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012005_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012006_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012007_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012008_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012009_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012010_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012011_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012012_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012013_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012014_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012015_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012016_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012017_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012018_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012019_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012020_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012000_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012001_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012002_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012003_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012004_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012005_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012006_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012007_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012008_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012009_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012010_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012011_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012012_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012013_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012014_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012015_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012016_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012017_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012018_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012019_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012020_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012000_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012001_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012002_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012003_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012004_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012005_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012006_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012007_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012008_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012009_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012010_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012011_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012012_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012013_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012014_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012015_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012016_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012017_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012018_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012019_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012020_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012000_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012001_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012002_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012003_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012004_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012005_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012006_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012007_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012008_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012009_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012010_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012011_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012012_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012013_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012014_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012015_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012016_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012017_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012018_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012019_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012000_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012001_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012002_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012003_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012004_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012005_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012006_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012007_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012008_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012009_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012010_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012011_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012012_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012013_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012014_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012015_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012016_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012017_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012018_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012019_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012020_3_24hr.npz
train_data_files nums: 125
mnist test iterator, Loading data from /scratch/09012/haoli1/ERA5/val_dataset/era5_train_09012020_3_24hr.npz
NaN value num: 0
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012017_3_24hr.npz
NaN value num: 0
Iteration: 1, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44998282194137573, gen p mean: -0.0009644899982959032, mean p set: 0.45046308636665344
loss_pred:0.1634722799062729, decouple_loss:0.08245613425970078
The modified gen p mean: 0.4501136541366577, gen p mean: -0.0012263136450201273, mean p set: 0.4505939483642578
loss_pred:0.1659516543149948, decouple_loss:0.08139219880104065
/work/09012/haoli1/ls6/Pyt/lib/python3.9/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '
The modified gen p mean: 0.4485202133655548, gen p mean: -0.0010656947270035744, mean p set: 0.4490005075931549
loss_pred:0.1611776500940323, decouple_loss:0.08408580720424652
Iteration: 2, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45036405324935913, gen p mean: -0.0010207401355728507, mean p set: 0.4508443772792816
loss_pred:0.16847345232963562, decouple_loss:0.25651127099990845
The modified gen p mean: 0.44882991909980774, gen p mean: -0.0009398119291290641, mean p set: 0.44931018352508545The modified gen p mean: 0.45019397139549255, gen p mean: -0.001142216962762177, mean p set: 0.45067429542541504
loss_pred:0.16582255065441132, decouple_loss:0.2599623501300812
loss_pred:0.17199066281318665, decouple_loss:0.2557995021343231
Iteration: 3, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45127686858177185, gen p mean: -0.0007968935533426702, mean p set: 0.45175716280937195
loss_pred:0.1554555594921112, decouple_loss:0.4757274389266968
The modified gen p mean: 0.45019635558128357, gen p mean: -0.0009864529129117727, mean p set: 0.45067667961120605The modified gen p mean: 0.451181560754776, gen p mean: -0.000924021762330085, mean p set: 0.4516618549823761
loss_pred:0.1616746336221695, decouple_loss:0.47323283553123474
loss_pred:0.16197733581066132, decouple_loss:0.4684631824493408
Iteration: 4, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482422471046448, gen p mean: 0.0006470828666351736, mean p set: 0.4487225413322449
loss_pred:0.14066383242607117, decouple_loss:0.5422742962837219
The modified gen p mean: 0.44985517859458923, gen p mean: 0.0007079895585775375, mean p set: 0.45033547282218933The modified gen p mean: 0.4504992961883545, gen p mean: 0.0006129257380962372, mean p set: 0.4509795904159546
loss_pred:0.14479851722717285, decouple_loss:0.544084370136261
loss_pred:0.14630436897277832, decouple_loss:0.5422304272651672
Iteration: 5, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495129883289337, gen p mean: -0.0033500923309475183, mean p set: 0.4499933123588562
loss_pred:0.14311693608760834, decouple_loss:0.46021848917007446
The modified gen p mean: 0.45031073689460754, gen p mean: -0.0033225498627871275, mean p set: 0.45079106092453003The modified gen p mean: 0.4493566155433655, gen p mean: -0.0033522015437483788, mean p set: 0.44983693957328796
loss_pred:0.14311793446540833, decouple_loss:0.45410147309303284
loss_pred:0.14116016030311584, decouple_loss:0.4570509195327759
Iteration: 6, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44992145895957947, gen p mean: -0.0053797620348632336, mean p set: 0.45040175318717957
loss_pred:0.13487276434898376, decouple_loss:0.49807998538017273
The modified gen p mean: 0.4482896029949188, gen p mean: -0.005384179763495922, mean p set: 0.4487698972225189The modified gen p mean: 0.4509267508983612, gen p mean: -0.005416469182819128, mean p set: 0.4514070451259613
loss_pred:0.1347721666097641, decouple_loss:0.4985972046852112
loss_pred:0.13179807364940643, decouple_loss:0.499212384223938
Iteration: 7, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490130841732025, gen p mean: -0.002044924069195986, mean p set: 0.449493408203125
loss_pred:0.13977958261966705, decouple_loss:0.4619164764881134
The modified gen p mean: 0.4498775005340576, gen p mean: -0.0021759672090411186, mean p set: 0.4503578245639801The modified gen p mean: 0.4494018256664276, gen p mean: -0.0021853367798030376, mean p set: 0.4498820900917053
loss_pred:0.13886024057865143, decouple_loss:0.46763333678245544
loss_pred:0.13583208620548248, decouple_loss:0.4697243273258209
Iteration: 8, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44997742772102356, gen p mean: -0.0003532328992150724, mean p set: 0.45045775175094604
loss_pred:0.1299152821302414, decouple_loss:0.537827730178833
The modified gen p mean: 0.45051079988479614, gen p mean: -0.00036988637293688953, mean p set: 0.45099109411239624The modified gen p mean: 0.4503362476825714, gen p mean: -0.0003492222458589822, mean p set: 0.4508165121078491
loss_pred:0.13150036334991455, decouple_loss:0.542582094669342
loss_pred:0.1316600739955902, decouple_loss:0.54166579246521
Iteration: 9, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44889456033706665, gen p mean: -0.0022578726056963205, mean p set: 0.44937488436698914
loss_pred:0.1262461394071579, decouple_loss:0.44314339756965637
The modified gen p mean: 0.4507595896720886, gen p mean: -0.0022453307174146175, mean p set: 0.4512398838996887The modified gen p mean: 0.4488689601421356, gen p mean: -0.002282598987221718, mean p set: 0.4493492543697357
loss_pred:0.12769801914691925, decouple_loss:0.4476989507675171
loss_pred:0.12865231931209564, decouple_loss:0.4434095621109009
Iteration: 10, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4509466290473938, gen p mean: -0.00166694528888911, mean p set: 0.4514269232749939
loss_pred:0.12285085022449493, decouple_loss:0.40262463688850403
The modified gen p mean: 0.44889262318611145, gen p mean: -0.0017293802229687572, mean p set: 0.44937294721603394The modified gen p mean: 0.44883400201797485, gen p mean: -0.0016847825609147549, mean p set: 0.44931429624557495
loss_pred:0.12299033999443054, decouple_loss:0.4053064286708832
loss_pred:0.12904685735702515, decouple_loss:0.39691898226737976
2023-05-01 10:46:47 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.00163179577793926, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.0016802975442260504, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.0016569339204579592, mean p set: 0.4500633478164673
loss_pred:0.12844806909561157, decouple_loss:0.3592177629470825
loss_pred:0.1281329244375229, decouple_loss:0.35818415880203247
loss_pred:0.12734732031822205, decouple_loss:0.3580951690673828
WV_0_PC_1_EH_0_PS_40_15, loss: 0.14590105414390564, avg_mse: 0.128780797123909
current test mse: 0.128781
Iteration: 11, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44983839988708496, gen p mean: -0.00179425033275038, mean p set: 0.45031872391700745
The modified gen p mean: 0.44860729575157166, gen p mean: -0.001774896401911974, mean p set: 0.44908758997917175
The modified gen p mean: 0.44897353649139404, gen p mean: -0.001719847903586924, mean p set: 0.44945380091667175
loss_pred:0.12975293397903442, decouple_loss:0.35016342997550964
loss_pred:0.12733276188373566, decouple_loss:0.35428136587142944
loss_pred:0.12450546771287918, decouple_loss:0.3558788597583771
Iteration: 12, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44822803139686584, gen p mean: -0.001796625554561615, mean p set: 0.44870832562446594
loss_pred:0.12028735876083374, decouple_loss:0.3756747543811798
The modified gen p mean: 0.4508385956287384, gen p mean: -0.0017989117186516523, mean p set: 0.4513188898563385The modified gen p mean: 0.450148344039917, gen p mean: -0.0017987012397497892, mean p set: 0.4506286382675171
loss_pred:0.12384287267923355, decouple_loss:0.37231504917144775
loss_pred:0.12183524668216705, decouple_loss:0.37494149804115295
Iteration: 13, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45103394985198975, gen p mean: -0.0018996141152456403, mean p set: 0.45151427388191223
loss_pred:0.1248495802283287, decouple_loss:0.37671685218811035
The modified gen p mean: 0.4501728415489197, gen p mean: -0.0018962628673762083, mean p set: 0.4506531357765198The modified gen p mean: 0.45013922452926636, gen p mean: -0.00189166737254709, mean p set: 0.45061951875686646
loss_pred:0.12347903847694397, decouple_loss:0.38503021001815796
loss_pred:0.12332542985677719, decouple_loss:0.384469211101532
Iteration: 14, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498642385005951, gen p mean: -0.0024728612042963505, mean p set: 0.4503445625305176
loss_pred:0.12413260340690613, decouple_loss:0.33202245831489563
The modified gen p mean: 0.45033571124076843, gen p mean: -0.0024888282641768456, mean p set: 0.45081597566604614The modified gen p mean: 0.4502759873867035, gen p mean: -0.0024991407990455627, mean p set: 0.4507562518119812
loss_pred:0.12098880857229233, decouple_loss:0.3258377015590668
loss_pred:0.12076189368963242, decouple_loss:0.3262784779071808
Iteration: 15, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499850869178772, gen p mean: -0.002929826034232974, mean p set: 0.4504653811454773
loss_pred:0.12094635516405106, decouple_loss:0.30703550577163696
The modified gen p mean: 0.45016372203826904, gen p mean: -0.002885573310777545, mean p set: 0.45064401626586914The modified gen p mean: 0.44957005977630615, gen p mean: -0.002937639132142067, mean p set: 0.45005032420158386
loss_pred:0.11889518797397614, decouple_loss:0.3110346496105194
loss_pred:0.11619878560304642, decouple_loss:0.3100588321685791
Iteration: 16, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511813223361969, gen p mean: -0.003818519413471222, mean p set: 0.451661616563797
loss_pred:0.11414207518100739, decouple_loss:0.2585885524749756
The modified gen p mean: 0.45004984736442566, gen p mean: -0.003831374691799283, mean p set: 0.45053014159202576The modified gen p mean: 0.44860315322875977, gen p mean: -0.003778785699978471, mean p set: 0.44908347725868225
loss_pred:0.11533061414957047, decouple_loss:0.2550177276134491
loss_pred:0.11211059242486954, decouple_loss:0.2584083676338196
Iteration: 17, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501436948776245, gen p mean: -0.006151642184704542, mean p set: 0.4506239891052246
loss_pred:0.11711984872817993, decouple_loss:0.2370447963476181
The modified gen p mean: 0.4501018822193146, gen p mean: -0.005700763780623674, mean p set: 0.45058220624923706The modified gen p mean: 0.4508129060268402, gen p mean: -0.005919700488448143, mean p set: 0.4512932300567627
loss_pred:0.11661774665117264, decouple_loss:0.2345740646123886
loss_pred:0.1159713938832283, decouple_loss:0.2331286072731018
Iteration: 18, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502236843109131, gen p mean: -0.003606880782172084, mean p set: 0.4507039785385132
loss_pred:0.11449185013771057, decouple_loss:0.26504644751548767
The modified gen p mean: 0.450810045003891, gen p mean: -0.003606186481192708, mean p set: 0.4512903094291687The modified gen p mean: 0.4485991299152374, gen p mean: -0.0035979433450847864, mean p set: 0.4490794241428375
loss_pred:0.11813411861658096, decouple_loss:0.2677474319934845
loss_pred:0.11043569445610046, decouple_loss:0.26775890588760376
Iteration: 19, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45056432485580444, gen p mean: -0.004003801383078098, mean p set: 0.45104461908340454
loss_pred:0.11225585639476776, decouple_loss:0.24481984972953796
The modified gen p mean: 0.44861555099487305, gen p mean: -0.004033949226140976, mean p set: 0.44909584522247314The modified gen p mean: 0.4498045742511749, gen p mean: -0.0040507023222744465, mean p set: 0.4502848982810974
loss_pred:0.11586853861808777, decouple_loss:0.24353386461734772
loss_pred:0.11373015493154526, decouple_loss:0.24576184153556824
Iteration: 20, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483577311038971, gen p mean: -0.0049982452765107155, mean p set: 0.4488380551338196
loss_pred:0.10830587148666382, decouple_loss:0.24214830994606018
The modified gen p mean: 0.44945964217185974, gen p mean: -0.004979082848876715, mean p set: 0.44993993639945984The modified gen p mean: 0.4495947062969208, gen p mean: -0.005037372466176748, mean p set: 0.4500750005245209
loss_pred:0.11081050336360931, decouple_loss:0.24029049277305603
loss_pred:0.11389332264661789, decouple_loss:0.24032287299633026
2023-05-01 10:48:43 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.0062176804058253765, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.006298753432929516, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.006258181296288967, mean p set: 0.4500633478164673
loss_pred:0.10983636230230331, decouple_loss:0.20921817421913147
loss_pred:0.10974561423063278, decouple_loss:0.20812200009822845
loss_pred:0.10928932577371597, decouple_loss:0.20724506676197052
WV_0_PC_1_EH_0_PS_40_15, loss: 0.12003352493047714, avg_mse: 0.10865578055381775
current test mse: 0.108656
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012000_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012000_3_24hr.npz
NaN value num: 0
Iteration: 21, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44793713092803955, gen p mean: -0.006216404028236866, mean p set: 0.44841745495796204
loss_pred:0.10626343637704849, decouple_loss:0.20567722618579865
The modified gen p mean: 0.44736945629119873, gen p mean: -0.006236935965716839, mean p set: 0.44784975051879883The modified gen p mean: 0.44790494441986084, gen p mean: -0.00620288634672761, mean p set: 0.44838523864746094
loss_pred:0.10781968384981155, decouple_loss:0.2070416361093521
loss_pred:0.10528881847858429, decouple_loss:0.2078767716884613
Iteration: 22, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44794389605522156, gen p mean: -0.007778688799589872, mean p set: 0.44842419028282166
loss_pred:0.10511388629674911, decouple_loss:0.188465878367424
The modified gen p mean: 0.4472803473472595, gen p mean: -0.007711954414844513, mean p set: 0.447760671377182The modified gen p mean: 0.4464573562145233, gen p mean: -0.007756828796118498, mean p set: 0.4469376802444458
loss_pred:0.1034105122089386, decouple_loss:0.18685555458068848
loss_pred:0.10372083634138107, decouple_loss:0.18581975996494293
Iteration: 23, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492303431034088, gen p mean: -0.009796780534088612, mean p set: 0.4497106075286865
loss_pred:0.10686647146940231, decouple_loss:0.17303946614265442
The modified gen p mean: 0.4476581811904907, gen p mean: -0.00975895393639803, mean p set: 0.4481384754180908The modified gen p mean: 0.44705814123153687, gen p mean: -0.00968246255069971, mean p set: 0.44753846526145935
loss_pred:0.10514748096466064, decouple_loss:0.17319966852664948
loss_pred:0.10370548814535141, decouple_loss:0.17476020753383636
Iteration: 24, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482777416706085, gen p mean: -0.011551033705472946, mean p set: 0.4487580358982086
loss_pred:0.1043512150645256, decouple_loss:0.15657958388328552
The modified gen p mean: 0.44900283217430115, gen p mean: -0.01127676386386156, mean p set: 0.44948315620422363The modified gen p mean: 0.44704604148864746, gen p mean: -0.011265816166996956, mean p set: 0.44752633571624756
loss_pred:0.09963887929916382, decouple_loss:0.15250155329704285
loss_pred:0.10372942686080933, decouple_loss:0.15191048383712769
Iteration: 25, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44661128520965576, gen p mean: -0.0121055468916893, mean p set: 0.44709157943725586
loss_pred:0.10144210606813431, decouple_loss:0.13797330856323242
The modified gen p mean: 0.4460190236568451, gen p mean: -0.012166591361165047, mean p set: 0.4464992880821228The modified gen p mean: 0.4484160542488098, gen p mean: -0.012101899832487106, mean p set: 0.4488963484764099
loss_pred:0.09925954788923264, decouple_loss:0.13775508105754852
loss_pred:0.10086264461278915, decouple_loss:0.14142096042633057
Iteration: 26, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488963186740875, gen p mean: -0.014827526174485683, mean p set: 0.4493766129016876
loss_pred:0.09880924224853516, decouple_loss:0.147458016872406
The modified gen p mean: 0.44831985235214233, gen p mean: -0.014389077201485634, mean p set: 0.44880014657974243The modified gen p mean: 0.44858017563819885, gen p mean: -0.014869767241179943, mean p set: 0.44906049966812134
loss_pred:0.09965640306472778, decouple_loss:0.1386347860097885
loss_pred:0.09580177068710327, decouple_loss:0.1434621959924698
Iteration: 27, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482327103614807, gen p mean: -0.013539550825953484, mean p set: 0.4487130343914032
loss_pred:0.09673897176980972, decouple_loss:0.14533543586730957
The modified gen p mean: 0.44693103432655334, gen p mean: -0.01353768166154623, mean p set: 0.44741132855415344The modified gen p mean: 0.44815385341644287, gen p mean: -0.01364248525351286, mean p set: 0.44863414764404297
loss_pred:0.09230425953865051, decouple_loss:0.14357984066009521
loss_pred:0.09686920791864395, decouple_loss:0.13497313857078552
Iteration: 28, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44921785593032837, gen p mean: -0.015924952924251556, mean p set: 0.44969815015792847
loss_pred:0.09118327498435974, decouple_loss:0.12019243091344833
The modified gen p mean: 0.4491006135940552, gen p mean: -0.015995671972632408, mean p set: 0.4495809078216553The modified gen p mean: 0.4500364661216736, gen p mean: -0.01592974364757538, mean p set: 0.4505167305469513
loss_pred:0.09091443568468094, decouple_loss:0.12056000530719757
loss_pred:0.09264730662107468, decouple_loss:0.12268199771642685
Iteration: 29, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476604163646698, gen p mean: -0.018861552700400352, mean p set: 0.4481406807899475
loss_pred:0.08974931389093399, decouple_loss:0.11723015457391739
The modified gen p mean: 0.4474087059497833, gen p mean: -0.018413525074720383, mean p set: 0.4478890001773834The modified gen p mean: 0.447195440530777, gen p mean: -0.018540002405643463, mean p set: 0.4476757347583771
loss_pred:0.09094713628292084, decouple_loss:0.1167352944612503
loss_pred:0.09392491728067398, decouple_loss:0.11591474711894989
Iteration: 30, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480293095111847, gen p mean: -0.021068742498755455, mean p set: 0.4485096037387848
loss_pred:0.08602242916822433, decouple_loss:0.11432085186243057
The modified gen p mean: 0.44775640964508057, gen p mean: -0.020717564970254898, mean p set: 0.44823670387268066The modified gen p mean: 0.4485984742641449, gen p mean: -0.020881598815321922, mean p set: 0.449078768491745
loss_pred:0.08802024275064468, decouple_loss:0.10984767228364944
loss_pred:0.08753195405006409, decouple_loss:0.10582006722688675
2023-05-01 10:51:13 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.022022787481546402, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.02258339338004589, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.022311393171548843, mean p set: 0.4500633478164673
loss_pred:0.08841411024332047, decouple_loss:0.10039182007312775
loss_pred:0.08891423791646957, decouple_loss:0.1018647700548172
loss_pred:0.08899145573377609, decouple_loss:0.09992140531539917
WV_0_PC_1_EH_0_PS_40_15, loss: 0.0938095673918724, avg_mse: 0.08801551163196564
current test mse: 0.088016
Iteration: 31, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449720174074173, gen p mean: -0.02199488878250122, mean p set: 0.45020049810409546
The modified gen p mean: 0.4481850862503052, gen p mean: -0.02172979898750782, mean p set: 0.44866541028022766
The modified gen p mean: 0.44937461614608765, gen p mean: -0.022119056433439255, mean p set: 0.44985491037368774
loss_pred:0.08679602295160294, decouple_loss:0.09964562952518463
loss_pred:0.08802324533462524, decouple_loss:0.09947912395000458
loss_pred:0.08762495219707489, decouple_loss:0.10048903524875641
Iteration: 32, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473119080066681, gen p mean: -0.02625412307679653, mean p set: 0.4477921724319458
loss_pred:0.08768202364444733, decouple_loss:0.0943908765912056
The modified gen p mean: 0.4488517940044403, gen p mean: -0.025605756789445877, mean p set: 0.4493320882320404The modified gen p mean: 0.44738543033599854, gen p mean: -0.026264457032084465, mean p set: 0.44786572456359863
loss_pred:0.08935478329658508, decouple_loss:0.09854493290185928
loss_pred:0.08736798167228699, decouple_loss:0.09248161315917969
Iteration: 33, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473456144332886, gen p mean: -0.026948342099785805, mean p set: 0.44782590866088867
loss_pred:0.08286750316619873, decouple_loss:0.09037580341100693
The modified gen p mean: 0.4488774240016937, gen p mean: -0.026936475187540054, mean p set: 0.4493577182292938The modified gen p mean: 0.4472600817680359, gen p mean: -0.026595281437039375, mean p set: 0.4477404057979584
loss_pred:0.08047673851251602, decouple_loss:0.09520576149225235
loss_pred:0.0840805172920227, decouple_loss:0.09395921975374222
Iteration: 34, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471632242202759, gen p mean: -0.02798299677670002, mean p set: 0.4476434886455536
loss_pred:0.08333592116832733, decouple_loss:0.08597710728645325
The modified gen p mean: 0.4469315707683563, gen p mean: -0.028325876221060753, mean p set: 0.44741183519363403The modified gen p mean: 0.4478943645954132, gen p mean: -0.028335094451904297, mean p set: 0.4483746588230133
loss_pred:0.08352098613977432, decouple_loss:0.08523891121149063
loss_pred:0.08107584714889526, decouple_loss:0.08912946283817291
Iteration: 35, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44783085584640503, gen p mean: -0.03132728859782219, mean p set: 0.4483111500740051
loss_pred:0.08291130512952805, decouple_loss:0.08482871204614639
The modified gen p mean: 0.4488295614719391, gen p mean: -0.0320403091609478, mean p set: 0.4493098258972168The modified gen p mean: 0.44750961661338806, gen p mean: -0.03164573013782501, mean p set: 0.44798991084098816
loss_pred:0.08093073219060898, decouple_loss:0.08403658866882324
loss_pred:0.08250648528337479, decouple_loss:0.08214227855205536
Iteration: 36, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474874436855316, gen p mean: -0.03370208665728569, mean p set: 0.4479677379131317
loss_pred:0.08144950121641159, decouple_loss:0.07729393988847733
The modified gen p mean: 0.44902482628822327, gen p mean: -0.032612547278404236, mean p set: 0.44950512051582336The modified gen p mean: 0.4487161636352539, gen p mean: -0.032900404185056686, mean p set: 0.4491964280605316
loss_pred:0.08263173699378967, decouple_loss:0.08004675060510635
loss_pred:0.0803743377327919, decouple_loss:0.07762616127729416
Iteration: 37, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44876590371131897, gen p mean: -0.03670605644583702, mean p set: 0.44924619793891907
loss_pred:0.07905604690313339, decouple_loss:0.07578306645154953
The modified gen p mean: 0.44701385498046875, gen p mean: -0.03649154305458069, mean p set: 0.44749414920806885The modified gen p mean: 0.44830483198165894, gen p mean: -0.035977818071842194, mean p set: 0.44878509640693665
loss_pred:0.07550007104873657, decouple_loss:0.07902278751134872
loss_pred:0.07698739320039749, decouple_loss:0.07968975603580475
Iteration: 38, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492894113063812, gen p mean: -0.03843439370393753, mean p set: 0.44976967573165894
loss_pred:0.07714397460222244, decouple_loss:0.0740746557712555
The modified gen p mean: 0.4487685561180115, gen p mean: -0.038102682679891586, mean p set: 0.44924888014793396The modified gen p mean: 0.4461824893951416, gen p mean: -0.03888937458395958, mean p set: 0.4466628134250641
loss_pred:0.08224782347679138, decouple_loss:0.07972901314496994
loss_pred:0.0800946056842804, decouple_loss:0.07732322067022324
Iteration: 39, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468690752983093, gen p mean: -0.039006996899843216, mean p set: 0.4473493695259094
loss_pred:0.07900582253932953, decouple_loss:0.07160160690546036
The modified gen p mean: 0.4493301808834076, gen p mean: -0.038962528109550476, mean p set: 0.4498105049133301The modified gen p mean: 0.4482394754886627, gen p mean: -0.038269106298685074, mean p set: 0.4487197697162628
loss_pred:0.07607804983854294, decouple_loss:0.07151538878679276
loss_pred:0.07467877119779587, decouple_loss:0.07605589181184769
Iteration: 40, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501919448375702, gen p mean: -0.04081829637289047, mean p set: 0.4506722390651703
loss_pred:0.07567540556192398, decouple_loss:0.06888669729232788
The modified gen p mean: 0.4464013874530792, gen p mean: -0.040669649839401245, mean p set: 0.4468816816806793The modified gen p mean: 0.4491988718509674, gen p mean: -0.040960922837257385, mean p set: 0.4496791362762451
loss_pred:0.07537992298603058, decouple_loss:0.07199735939502716
loss_pred:0.07660073786973953, decouple_loss:0.06929663568735123
2023-05-01 10:53:08 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.0458252876996994, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04626668617129326, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.04623608663678169, mean p set: 0.4500633478164673
loss_pred:0.07699097692966461, decouple_loss:0.06919340044260025
loss_pred:0.07753664255142212, decouple_loss:0.07216186821460724
loss_pred:0.07777595520019531, decouple_loss:0.0699792355298996
WV_0_PC_1_EH_0_PS_40_15, loss: 0.08095677196979523, avg_mse: 0.07688339054584503
current test mse: 0.076883
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012007_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012007_3_24hr.npz
NaN value num: 0
Iteration: 41, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44784075021743774, gen p mean: -0.046288393437862396, mean p set: 0.44832107424736023
loss_pred:0.07566819339990616, decouple_loss:0.07437571883201599
The modified gen p mean: 0.44702860713005066, gen p mean: -0.046744562685489655, mean p set: 0.44750893115997314The modified gen p mean: 0.4474042057991028, gen p mean: -0.047038573771715164, mean p set: 0.4478845000267029
loss_pred:0.07780519872903824, decouple_loss:0.0728120505809784
loss_pred:0.07953980565071106, decouple_loss:0.07437052577733994
Iteration: 42, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44793441891670227, gen p mean: -0.048914242535829544, mean p set: 0.44841471314430237
loss_pred:0.07389228045940399, decouple_loss:0.06892283260822296
The modified gen p mean: 0.4474222660064697, gen p mean: -0.048725999891757965, mean p set: 0.4479025602340698The modified gen p mean: 0.4480031430721283, gen p mean: -0.04838541895151138, mean p set: 0.4484834671020508
loss_pred:0.0744120329618454, decouple_loss:0.06603801250457764
loss_pred:0.07659279555082321, decouple_loss:0.06695692241191864
Iteration: 43, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480733871459961, gen p mean: -0.04823678359389305, mean p set: 0.4485537111759186
loss_pred:0.07488603889942169, decouple_loss:0.06439728289842606
The modified gen p mean: 0.4461434781551361, gen p mean: -0.048724498599767685, mean p set: 0.4466237425804138The modified gen p mean: 0.44812509417533875, gen p mean: -0.048337239772081375, mean p set: 0.44860541820526123
loss_pred:0.07599526643753052, decouple_loss:0.06432986259460449
loss_pred:0.07344236969947815, decouple_loss:0.06327623128890991
Iteration: 44, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482412040233612, gen p mean: -0.04972954839468002, mean p set: 0.4487214982509613
loss_pred:0.07318092882633209, decouple_loss:0.06515366584062576
The modified gen p mean: 0.4477846324443817, gen p mean: -0.04998379945755005, mean p set: 0.4482649564743042The modified gen p mean: 0.4482479691505432, gen p mean: -0.05008075758814812, mean p set: 0.4487282633781433
loss_pred:0.07312219589948654, decouple_loss:0.06222541257739067
loss_pred:0.07380162924528122, decouple_loss:0.06340301781892776
Iteration: 45, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483628273010254, gen p mean: -0.05411654710769653, mean p set: 0.4488431215286255
loss_pred:0.07310263067483902, decouple_loss:0.06389732658863068
The modified gen p mean: 0.4500880539417267, gen p mean: -0.0542960949242115, mean p set: 0.4505683481693268The modified gen p mean: 0.44771867990493774, gen p mean: -0.05395369604229927, mean p set: 0.44819900393486023
loss_pred:0.07231713086366653, decouple_loss:0.0628248006105423
loss_pred:0.0728859156370163, decouple_loss:0.060981277376413345
Iteration: 46, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448089063167572, gen p mean: -0.056900810450315475, mean p set: 0.4485693573951721
loss_pred:0.0732271820306778, decouple_loss:0.060117024928331375
The modified gen p mean: 0.44617778062820435, gen p mean: -0.057638611644506454, mean p set: 0.44665804505348206The modified gen p mean: 0.4476761221885681, gen p mean: -0.05733685567975044, mean p set: 0.4481564164161682
loss_pred:0.07251942902803421, decouple_loss:0.06405853480100632
loss_pred:0.07387185096740723, decouple_loss:0.0667417049407959
Iteration: 47, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478377103805542, gen p mean: -0.05642223730683327, mean p set: 0.4483180344104767
loss_pred:0.07269048690795898, decouple_loss:0.05914030969142914
The modified gen p mean: 0.44823968410491943, gen p mean: -0.05659131705760956, mean p set: 0.44871997833251953The modified gen p mean: 0.4495560824871063, gen p mean: -0.05660350248217583, mean p set: 0.4500364065170288
loss_pred:0.0725310817360878, decouple_loss:0.05606253445148468
loss_pred:0.07177136838436127, decouple_loss:0.05665775015950203
Iteration: 48, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466298222541809, gen p mean: -0.05820872262120247, mean p set: 0.447110116481781
loss_pred:0.07343127578496933, decouple_loss:0.05527999997138977
The modified gen p mean: 0.4470553696155548, gen p mean: -0.05912976711988449, mean p set: 0.4475356340408325The modified gen p mean: 0.4494439661502838, gen p mean: -0.057938944548368454, mean p set: 0.4499242305755615
loss_pred:0.0750890001654625, decouple_loss:0.05380306765437126
loss_pred:0.07094383239746094, decouple_loss:0.0574507899582386
Iteration: 49, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44725272059440613, gen p mean: -0.061352845281362534, mean p set: 0.4477330446243286
loss_pred:0.07157783955335617, decouple_loss:0.05642092227935791
The modified gen p mean: 0.4469155967235565, gen p mean: -0.06147901713848114, mean p set: 0.4473958909511566The modified gen p mean: 0.4475352168083191, gen p mean: -0.06102314218878746, mean p set: 0.4480155408382416
loss_pred:0.07165699452161789, decouple_loss:0.05754626914858818
loss_pred:0.0725809782743454, decouple_loss:0.05380166321992874
Iteration: 50, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475768804550171, gen p mean: -0.06304583698511124, mean p set: 0.4480571746826172
loss_pred:0.07395665347576141, decouple_loss:0.05177215486764908
The modified gen p mean: 0.447710245847702, gen p mean: -0.06317275762557983, mean p set: 0.4481905400753021The modified gen p mean: 0.4483945369720459, gen p mean: -0.06294158101081848, mean p set: 0.4488748610019684
loss_pred:0.0706004723906517, decouple_loss:0.05467962473630905
loss_pred:0.07103191316127777, decouple_loss:0.05638430267572403
2023-05-01 10:55:40 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.06252797693014145, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.06279481202363968, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.06262058019638062, mean p set: 0.4500633478164673
loss_pred:0.07301296293735504, decouple_loss:0.05249551683664322
loss_pred:0.07308879494667053, decouple_loss:0.05406695231795311
loss_pred:0.07370585948228836, decouple_loss:0.05267098546028137
WV_0_PC_1_EH_0_PS_40_15, loss: 0.07592310011386871, avg_mse: 0.07286319136619568
current test mse: 0.072863
Iteration: 51, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44881513714790344, gen p mean: -0.06302475929260254, mean p set: 0.44929543137550354
The modified gen p mean: 0.44795140624046326, gen p mean: -0.06286641210317612, mean p set: 0.44843170046806335
The modified gen p mean: 0.44678202271461487, gen p mean: -0.062386687844991684, mean p set: 0.44726231694221497
loss_pred:0.07173754274845123, decouple_loss:0.05219956859946251
loss_pred:0.0710538774728775, decouple_loss:0.055331047624349594
loss_pred:0.0706196203827858, decouple_loss:0.051588330417871475
Iteration: 52, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476286470890045, gen p mean: -0.06293786317110062, mean p set: 0.4481089115142822
loss_pred:0.07181911915540695, decouple_loss:0.05042406544089317
The modified gen p mean: 0.44970178604125977, gen p mean: -0.06294180452823639, mean p set: 0.45018208026885986The modified gen p mean: 0.448035329580307, gen p mean: -0.06335654109716415, mean p set: 0.4485156238079071
loss_pred:0.06980188935995102, decouple_loss:0.04935436323285103
loss_pred:0.07003214210271835, decouple_loss:0.04923957958817482
Iteration: 53, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482154846191406, gen p mean: -0.0644962415099144, mean p set: 0.44869574904441833
loss_pred:0.0705529972910881, decouple_loss:0.04866155982017517
The modified gen p mean: 0.4485396146774292, gen p mean: -0.06438574939966202, mean p set: 0.4490198791027069The modified gen p mean: 0.4471322000026703, gen p mean: -0.06455834209918976, mean p set: 0.4476125240325928
loss_pred:0.07063748687505722, decouple_loss:0.048898376524448395
loss_pred:0.0719408243894577, decouple_loss:0.050432704389095306
Iteration: 54, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44904136657714844, gen p mean: -0.06577003747224808, mean p set: 0.44952166080474854
loss_pred:0.06909170746803284, decouple_loss:0.04589597508311272
The modified gen p mean: 0.4484303593635559, gen p mean: -0.06566643714904785, mean p set: 0.4489106833934784The modified gen p mean: 0.4468289613723755, gen p mean: -0.0660393089056015, mean p set: 0.447309285402298
loss_pred:0.0694844126701355, decouple_loss:0.04776056483387947
loss_pred:0.07246086001396179, decouple_loss:0.04753300920128822
Iteration: 55, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44891947507858276, gen p mean: -0.06715172529220581, mean p set: 0.44939976930618286
loss_pred:0.0697036013007164, decouple_loss:0.04985317960381508
The modified gen p mean: 0.4468880295753479, gen p mean: -0.06758786737918854, mean p set: 0.447368323802948The modified gen p mean: 0.4477676451206207, gen p mean: -0.0669759213924408, mean p set: 0.4482479691505432
loss_pred:0.0710560753941536, decouple_loss:0.04627932235598564
loss_pred:0.06891991198062897, decouple_loss:0.045252036303281784
Iteration: 56, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464145600795746, gen p mean: -0.06748804450035095, mean p set: 0.4468948543071747
loss_pred:0.07237079739570618, decouple_loss:0.04426193982362747
The modified gen p mean: 0.4471645653247833, gen p mean: -0.06730732321739197, mean p set: 0.4476448595523834The modified gen p mean: 0.4492429792881012, gen p mean: -0.06702864915132523, mean p set: 0.4497232735157013
loss_pred:0.06805472820997238, decouple_loss:0.04331289231777191
loss_pred:0.06797660142183304, decouple_loss:0.042636457830667496
Iteration: 57, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475904703140259, gen p mean: -0.06806091219186783, mean p set: 0.4480707347393036
loss_pred:0.07137768715620041, decouple_loss:0.04270905628800392
The modified gen p mean: 0.45016229152679443, gen p mean: -0.06783673167228699, mean p set: 0.4506426155567169The modified gen p mean: 0.44856446981430054, gen p mean: -0.06856347620487213, mean p set: 0.44904476404190063
loss_pred:0.0690120980143547, decouple_loss:0.04286962375044823
loss_pred:0.07082127034664154, decouple_loss:0.04311099648475647
Iteration: 58, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44707077741622925, gen p mean: -0.06953746825456619, mean p set: 0.44755110144615173
loss_pred:0.06785288453102112, decouple_loss:0.0410916693508625
The modified gen p mean: 0.44588345289230347, gen p mean: -0.0689772218465805, mean p set: 0.44636374711990356The modified gen p mean: 0.447005033493042, gen p mean: -0.06978698074817657, mean p set: 0.4474853575229645
loss_pred:0.07034016400575638, decouple_loss:0.04409315064549446
loss_pred:0.07170021533966064, decouple_loss:0.04207707196474075
Iteration: 59, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482189118862152, gen p mean: -0.06931643933057785, mean p set: 0.4486992359161377
loss_pred:0.06825321912765503, decouple_loss:0.044167086482048035
The modified gen p mean: 0.4466460049152374, gen p mean: -0.06986826658248901, mean p set: 0.4471263289451599The modified gen p mean: 0.4491856098175049, gen p mean: -0.06924846768379211, mean p set: 0.449665904045105
loss_pred:0.07188725471496582, decouple_loss:0.04131099954247475
loss_pred:0.06927023082971573, decouple_loss:0.04043589159846306
Iteration: 60, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44832944869995117, gen p mean: -0.06964530050754547, mean p set: 0.4488097131252289
loss_pred:0.06903352588415146, decouple_loss:0.041761476546525955
The modified gen p mean: 0.4479919672012329, gen p mean: -0.07015026360750198, mean p set: 0.448472261428833The modified gen p mean: 0.4468555450439453, gen p mean: -0.0703524649143219, mean p set: 0.4473358392715454
loss_pred:0.06954845041036606, decouple_loss:0.041018929332494736
loss_pred:0.06807418167591095, decouple_loss:0.0411154180765152
2023-05-01 10:57:35 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.06945019215345383, mean p set: 0.4502691626548767
The modified gen p mean: 0.4498766362667084, gen p mean: -0.06974607706069946, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.06952571123838425, mean p set: 0.4500633478164673
loss_pred:0.07135628163814545, decouple_loss:0.04076046124100685
loss_pred:0.07108138501644135, decouple_loss:0.040604136884212494
loss_pred:0.07185976952314377, decouple_loss:0.040759552270174026
WV_0_PC_1_EH_0_PS_40_15, loss: 0.07346788048744202, avg_mse: 0.07109127193689346
current test mse: 0.071091
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012019_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012019_3_24hr.npz
NaN value num: 0
Iteration: 61, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4509577751159668, gen p mean: -0.06785260140895844, mean p set: 0.45143812894821167
loss_pred:0.07653500139713287, decouple_loss:0.05380179360508919
The modified gen p mean: 0.45010125637054443, gen p mean: -0.0684451088309288, mean p set: 0.45058155059814453The modified gen p mean: 0.4503616392612457, gen p mean: -0.06808724254369736, mean p set: 0.4508419334888458
loss_pred:0.07314459979534149, decouple_loss:0.049620047211647034loss_pred:0.07588161528110504, decouple_loss:0.05103036016225815
Iteration: 62, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4519239366054535, gen p mean: -0.06648529320955276, mean p set: 0.4524042010307312
loss_pred:0.07321332395076752, decouple_loss:0.05154849961400032
The modified gen p mean: 0.4508418142795563, gen p mean: -0.06543920934200287, mean p set: 0.45132210850715637The modified gen p mean: 0.45130670070648193, gen p mean: -0.06574037671089172, mean p set: 0.45178699493408203
loss_pred:0.07283661514520645, decouple_loss:0.05282241478562355
loss_pred:0.0763850212097168, decouple_loss:0.05425959452986717
Iteration: 63, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4517272710800171, gen p mean: -0.06588876992464066, mean p set: 0.4522075653076172
loss_pred:0.0717928484082222, decouple_loss:0.0534500852227211
The modified gen p mean: 0.45255059003829956, gen p mean: -0.06494255363941193, mean p set: 0.45303085446357727
The modified gen p mean: 0.4508074223995209, gen p mean: -0.06497761607170105, mean p set: 0.4512876868247986
loss_pred:0.07254163920879364, decouple_loss:0.054795440286397934
loss_pred:0.07159315049648285, decouple_loss:0.05237177014350891
Iteration: 64, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4518773853778839, gen p mean: -0.06790097057819366, mean p set: 0.452357679605484
loss_pred:0.06984143704175949, decouple_loss:0.05322938784956932
The modified gen p mean: 0.45082083344459534, gen p mean: -0.06640597432851791, mean p set: 0.45130112767219543The modified gen p mean: 0.4506399631500244, gen p mean: -0.06681924313306808, mean p set: 0.4511202275753021
loss_pred:0.07341072708368301, decouple_loss:0.0542692095041275
loss_pred:0.07056130468845367, decouple_loss:0.05089213326573372
Iteration: 65, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45026731491088867, gen p mean: -0.070781409740448, mean p set: 0.45074760913848877
loss_pred:0.07182182371616364, decouple_loss:0.05318562686443329
The modified gen p mean: 0.4518752694129944, gen p mean: -0.07181195914745331, mean p set: 0.4523555636405945The modified gen p mean: 0.45038220286369324, gen p mean: -0.07086998224258423, mean p set: 0.45086249709129333
loss_pred:0.07097100466489792, decouple_loss:0.05560829117894173
loss_pred:0.07063905894756317, decouple_loss:0.05254524201154709
Iteration: 66, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45141705870628357, gen p mean: -0.07375095784664154, mean p set: 0.45189735293388367
loss_pred:0.07179316878318787, decouple_loss:0.054888758808374405
The modified gen p mean: 0.45210570096969604, gen p mean: -0.07360251992940903, mean p set: 0.45258599519729614The modified gen p mean: 0.449715793132782, gen p mean: -0.07292971760034561, mean p set: 0.4501960873603821
loss_pred:0.07490966469049454, decouple_loss:0.05472362041473389
loss_pred:0.07356760650873184, decouple_loss:0.0557776540517807
Iteration: 67, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4523179829120636, gen p mean: -0.0740036815404892, mean p set: 0.4527982771396637
loss_pred:0.07509642094373703, decouple_loss:0.05100546404719353
The modified gen p mean: 0.4494195580482483, gen p mean: -0.07413304597139359, mean p set: 0.449899822473526The modified gen p mean: 0.4512808918952942, gen p mean: -0.07367374002933502, mean p set: 0.4517611861228943
loss_pred:0.07178955525159836, decouple_loss:0.05284402519464493
loss_pred:0.07128722965717316, decouple_loss:0.05195183306932449
Iteration: 68, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44943225383758545, gen p mean: -0.07581023871898651, mean p set: 0.44991254806518555
loss_pred:0.06972642987966537, decouple_loss:0.049945637583732605
The modified gen p mean: 0.45084068179130554, gen p mean: -0.07436917722225189, mean p set: 0.451321005821228The modified gen p mean: 0.4512348175048828, gen p mean: -0.07492376863956451, mean p set: 0.4517151117324829
loss_pred:0.06912661343812943, decouple_loss:0.051528122276067734
loss_pred:0.06952884793281555, decouple_loss:0.05002807453274727
Iteration: 69, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44944486021995544, gen p mean: -0.0750226229429245, mean p set: 0.44992515444755554
loss_pred:0.06885291635990143, decouple_loss:0.04863429069519043
The modified gen p mean: 0.45012742280960083, gen p mean: -0.07485969364643097, mean p set: 0.45060768723487854The modified gen p mean: 0.4508119225502014, gen p mean: -0.07566575706005096, mean p set: 0.4512922167778015
loss_pred:0.07122169435024261, decouple_loss:0.048852503299713135
loss_pred:0.07200319319963455, decouple_loss:0.05002925917506218
Iteration: 70, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.451214998960495, gen p mean: -0.0752367451786995, mean p set: 0.4516952931880951
loss_pred:0.06988938897848129, decouple_loss:0.04960270971059799
The modified gen p mean: 0.45233818888664246, gen p mean: -0.07604872435331345, mean p set: 0.45281848311424255The modified gen p mean: 0.45010024309158325, gen p mean: -0.07482870668172836, mean p set: 0.45058050751686096
loss_pred:0.06824475526809692, decouple_loss:0.04809786379337311
loss_pred:0.0721200704574585, decouple_loss:0.047390397638082504
2023-05-01 11:00:07 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.07925795763731003, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.07980518043041229, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.07938378304243088, mean p set: 0.4500633478164673
loss_pred:0.07113660871982574, decouple_loss:0.050357636064291
loss_pred:0.0706377774477005, decouple_loss:0.05273962765932083
loss_pred:0.07137517631053925, decouple_loss:0.050903335213661194
WV_0_PC_1_EH_0_PS_40_15, loss: 0.07361653447151184, avg_mse: 0.07112840563058853
current test mse: 0.071128
Iteration: 71, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493287205696106, gen p mean: -0.0786626935005188, mean p set: 0.4498090147972107
The modified gen p mean: 0.4500442445278168, gen p mean: -0.07869698852300644, mean p set: 0.45052459836006165
The modified gen p mean: 0.451535165309906, gen p mean: -0.0784810408949852, mean p set: 0.4520154595375061
loss_pred:0.07087558507919312, decouple_loss:0.04554448649287224
loss_pred:0.06968583911657333, decouple_loss:0.044403303414583206
loss_pred:0.0696198120713234, decouple_loss:0.04462309926748276
Iteration: 72, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45085176825523376, gen p mean: -0.07927840203046799, mean p set: 0.45133206248283386
loss_pred:0.07092439383268356, decouple_loss:0.046045444905757904
The modified gen p mean: 0.4519760310649872, gen p mean: -0.08072898536920547, mean p set: 0.4524562954902649The modified gen p mean: 0.4497329890727997, gen p mean: -0.08075615018606186, mean p set: 0.4502132534980774
loss_pred:0.07010680437088013, decouple_loss:0.04722358658909798
loss_pred:0.06826774030923843, decouple_loss:0.04359337314963341
Iteration: 73, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44986769556999207, gen p mean: -0.08000833541154861, mean p set: 0.45034801959991455
loss_pred:0.07091435045003891, decouple_loss:0.047070059925317764
The modified gen p mean: 0.45096662640571594, gen p mean: -0.08067198097705841, mean p set: 0.45144689083099365
The modified gen p mean: 0.4511503577232361, gen p mean: -0.08035381883382797, mean p set: 0.45163068175315857
loss_pred:0.06909885257482529, decouple_loss:0.043277252465486526
loss_pred:0.06857821345329285, decouple_loss:0.04546213895082474
Iteration: 74, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505957067012787, gen p mean: -0.07994408905506134, mean p set: 0.4510760009288788
loss_pred:0.0708775520324707, decouple_loss:0.04182210564613342
The modified gen p mean: 0.4520964026451111, gen p mean: -0.0801606997847557, mean p set: 0.45257672667503357The modified gen p mean: 0.45006638765335083, gen p mean: -0.08055691421031952, mean p set: 0.4505466818809509
loss_pred:0.0686250552535057, decouple_loss:0.042288638651371
loss_pred:0.0717092752456665, decouple_loss:0.04233148694038391
Iteration: 75, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44983214139938354, gen p mean: -0.08081074804067612, mean p set: 0.45031243562698364
loss_pred:0.06859979778528214, decouple_loss:0.04079616069793701
The modified gen p mean: 0.44965270161628723, gen p mean: -0.08023842424154282, mean p set: 0.45013299584388733The modified gen p mean: 0.45083531737327576, gen p mean: -0.08020112663507462, mean p set: 0.45131561160087585
loss_pred:0.06824690103530884, decouple_loss:0.04172138497233391
loss_pred:0.06794976443052292, decouple_loss:0.04077872261404991
Iteration: 76, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497206211090088, gen p mean: -0.08155743032693863, mean p set: 0.4502009153366089
loss_pred:0.07039400935173035, decouple_loss:0.04033804312348366
The modified gen p mean: 0.45096397399902344, gen p mean: -0.08184814453125, mean p set: 0.4514442980289459The modified gen p mean: 0.451749712228775, gen p mean: -0.08164447546005249, mean p set: 0.4522300362586975
loss_pred:0.0711631178855896, decouple_loss:0.03898106515407562
loss_pred:0.06750375032424927, decouple_loss:0.04176522046327591
Iteration: 77, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514372944831848, gen p mean: -0.08098650723695755, mean p set: 0.4519175887107849
loss_pred:0.06708744168281555, decouple_loss:0.04108411446213722
The modified gen p mean: 0.45078352093696594, gen p mean: -0.08202109485864639, mean p set: 0.4512638449668884The modified gen p mean: 0.45153141021728516, gen p mean: -0.08270634710788727, mean p set: 0.45201170444488525
loss_pred:0.06825489550828934, decouple_loss:0.0425570048391819
loss_pred:0.06895032525062561, decouple_loss:0.04116780683398247
Iteration: 78, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496927261352539, gen p mean: -0.08356854319572449, mean p set: 0.450173020362854
loss_pred:0.06942993402481079, decouple_loss:0.040700435638427734
The modified gen p mean: 0.4514906108379364, gen p mean: -0.08261802047491074, mean p set: 0.4519709050655365
The modified gen p mean: 0.45073339343070984, gen p mean: -0.08396231383085251, mean p set: 0.4512137174606323
loss_pred:0.06918002665042877, decouple_loss:0.040643300861120224
loss_pred:0.07061491906642914, decouple_loss:0.03855122625827789
Iteration: 79, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45183250308036804, gen p mean: -0.0828317180275917, mean p set: 0.45231279730796814
loss_pred:0.07058288902044296, decouple_loss:0.03834611549973488
The modified gen p mean: 0.4496115744113922, gen p mean: -0.08457464724779129, mean p set: 0.4500918984413147The modified gen p mean: 0.4503265619277954, gen p mean: -0.08373959362506866, mean p set: 0.4508068561553955
loss_pred:0.06766511499881744, decouple_loss:0.03973349556326866
loss_pred:0.06840093433856964, decouple_loss:0.03859101980924606
Iteration: 80, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507615566253662, gen p mean: -0.08339164406061172, mean p set: 0.4512418508529663
loss_pred:0.0675976499915123, decouple_loss:0.03570269048213959
The modified gen p mean: 0.45269033312797546, gen p mean: -0.08266094326972961, mean p set: 0.45317062735557556The modified gen p mean: 0.44982588291168213, gen p mean: -0.08326800912618637, mean p set: 0.45030614733695984
loss_pred:0.06905166059732437, decouple_loss:0.03564297407865524
loss_pred:0.06941299140453339, decouple_loss:0.036099355667829514
2023-05-01 11:02:03 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.08384543657302856, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.08467131853103638, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.0842398926615715, mean p set: 0.4500633478164673
loss_pred:0.07026996463537216, decouple_loss:0.041659753769636154
loss_pred:0.06924454867839813, decouple_loss:0.04484602436423302
loss_pred:0.07017061859369278, decouple_loss:0.042360804975032806
WV_0_PC_1_EH_0_PS_40_15, loss: 0.07204282283782959, avg_mse: 0.07022379338741302
current test mse: 0.070224
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012001_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012001_3_24hr.npz
NaN value num: 0
Iteration: 81, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464988112449646, gen p mean: -0.08356332778930664, mean p set: 0.4469790756702423
loss_pred:0.069406658411026, decouple_loss:0.043449029326438904
The modified gen p mean: 0.4483083188533783, gen p mean: -0.08327008783817291, mean p set: 0.4487886130809784The modified gen p mean: 0.44712579250335693, gen p mean: -0.08286837488412857, mean p set: 0.44760608673095703
loss_pred:0.06719270348548889, decouple_loss:0.037882644683122635loss_pred:0.06859175115823746, decouple_loss:0.0461016409099102
Iteration: 82, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4456712305545807, gen p mean: -0.08514151722192764, mean p set: 0.4461515247821808
loss_pred:0.06984059512615204, decouple_loss:0.04217761009931564
The modified gen p mean: 0.446638286113739, gen p mean: -0.08443229645490646, mean p set: 0.4471185803413391The modified gen p mean: 0.4477458596229553, gen p mean: -0.08447611331939697, mean p set: 0.4482261538505554
loss_pred:0.06961579620838165, decouple_loss:0.04277821630239487
loss_pred:0.06800495833158493, decouple_loss:0.043432436883449554
Iteration: 83, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44588375091552734, gen p mean: -0.0895439088344574, mean p set: 0.44636404514312744
loss_pred:0.06704184412956238, decouple_loss:0.04702746868133545
The modified gen p mean: 0.4482898712158203, gen p mean: -0.08227231353521347, mean p set: 0.4487701654434204The modified gen p mean: 0.4472513794898987, gen p mean: -0.08574380725622177, mean p set: 0.4477316439151764
loss_pred:0.06860817223787308, decouple_loss:0.044161491096019745
loss_pred:0.06846186518669128, decouple_loss:0.04392756521701813
Iteration: 84, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470728039741516, gen p mean: -0.08070468157529831, mean p set: 0.4475530982017517
loss_pred:0.06792998313903809, decouple_loss:0.04804975166916847
The modified gen p mean: 0.4488806128501892, gen p mean: -0.08087272942066193, mean p set: 0.4493609070777893The modified gen p mean: 0.4453831911087036, gen p mean: -0.08280017971992493, mean p set: 0.4458634853363037
loss_pred:0.06649128347635269, decouple_loss:0.0427839532494545
loss_pred:0.06727281957864761, decouple_loss:0.04852692410349846
Iteration: 85, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464940130710602, gen p mean: -0.08260541409254074, mean p set: 0.4469743072986603
loss_pred:0.06805197149515152, decouple_loss:0.04337186738848686
The modified gen p mean: 0.44609618186950684, gen p mean: -0.08349767327308655, mean p set: 0.44657647609710693The modified gen p mean: 0.4475260376930237, gen p mean: -0.08208166807889938, mean p set: 0.4480063021183014
loss_pred:0.06814733147621155, decouple_loss:0.04672745242714882
loss_pred:0.06815450638532639, decouple_loss:0.04328760504722595
Iteration: 86, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44904500246047974, gen p mean: -0.0861208587884903, mean p set: 0.44952526688575745
loss_pred:0.06804010272026062, decouple_loss:0.04640193656086922
The modified gen p mean: 0.44807305932044983, gen p mean: -0.08685040473937988, mean p set: 0.4485533535480499The modified gen p mean: 0.4471195936203003, gen p mean: -0.08667508512735367, mean p set: 0.4475998878479004
loss_pred:0.07031939923763275, decouple_loss:0.046287089586257935
loss_pred:0.06926803290843964, decouple_loss:0.04663284122943878
Iteration: 87, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44680359959602356, gen p mean: -0.07942906767129898, mean p set: 0.44728389382362366
loss_pred:0.06692628562450409, decouple_loss:0.041420239955186844
The modified gen p mean: 0.44939735531806946, gen p mean: -0.07910173386335373, mean p set: 0.44987761974334717
The modified gen p mean: 0.44733691215515137, gen p mean: -0.07903531193733215, mean p set: 0.44781720638275146
loss_pred:0.06790786981582642, decouple_loss:0.044203829020261765
loss_pred:0.06622844189405441, decouple_loss:0.043912678956985474
Iteration: 88, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44641467928886414, gen p mean: -0.08225329965353012, mean p set: 0.4468950033187866
loss_pred:0.06737222522497177, decouple_loss:0.040548693388700485
The modified gen p mean: 0.4462382197380066, gen p mean: -0.07785911858081818, mean p set: 0.4467185139656067The modified gen p mean: 0.44632381200790405, gen p mean: -0.07853884249925613, mean p set: 0.44680410623550415
loss_pred:0.06585834175348282, decouple_loss:0.04302170127630234
loss_pred:0.06804410368204117, decouple_loss:0.04488719254732132
Iteration: 89, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44636714458465576, gen p mean: -0.08406499028205872, mean p set: 0.44684743881225586
loss_pred:0.06717124581336975, decouple_loss:0.040329303592443466
The modified gen p mean: 0.4460093677043915, gen p mean: -0.08722569793462753, mean p set: 0.4464896619319916The modified gen p mean: 0.44679054617881775, gen p mean: -0.0817847028374672, mean p set: 0.44727084040641785
loss_pred:0.0672476664185524, decouple_loss:0.04336675629019737
loss_pred:0.06623511016368866, decouple_loss:0.03993922472000122
Iteration: 90, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446050226688385, gen p mean: -0.08434285968542099, mean p set: 0.4465305209159851
loss_pred:0.06732576340436935, decouple_loss:0.04025119170546532
The modified gen p mean: 0.44648781418800354, gen p mean: -0.08388613164424896, mean p set: 0.446968138217926The modified gen p mean: 0.44593241810798645, gen p mean: -0.08662939071655273, mean p set: 0.44641271233558655
loss_pred:0.06706111878156662, decouple_loss:0.03954539820551872
loss_pred:0.06578966975212097, decouple_loss:0.04088854789733887
2023-05-01 11:04:36 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.08132541924715042, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.08169138431549072, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.08169558644294739, mean p set: 0.4500633478164673
loss_pred:0.06716454774141312, decouple_loss:0.03855616971850395
loss_pred:0.06631502509117126, decouple_loss:0.039160195738077164
loss_pred:0.06714560836553574, decouple_loss:0.03862430155277252
WV_0_PC_1_EH_0_PS_40_15, loss: 0.06881407648324966, avg_mse: 0.06701871007680893
current test mse: 0.067019
Iteration: 91, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44810542464256287, gen p mean: -0.08068283647298813, mean p set: 0.44858571887016296
The modified gen p mean: 0.44538137316703796, gen p mean: -0.08196305483579636, mean p set: 0.44586169719696045
The modified gen p mean: 0.44714638590812683, gen p mean: -0.0797015056014061, mean p set: 0.4476267099380493
loss_pred:0.06640016287565231, decouple_loss:0.04093310236930847
loss_pred:0.06668301671743393, decouple_loss:0.039828747510910034loss_pred:0.06640736013650894, decouple_loss:0.038137197494506836
Iteration: 92, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44870543479919434, gen p mean: -0.07826431840658188, mean p set: 0.44918572902679443
loss_pred:0.06510519981384277, decouple_loss:0.04115552082657814
The modified gen p mean: 0.44707539677619934, gen p mean: -0.0791313499212265, mean p set: 0.4475557208061218The modified gen p mean: 0.44878455996513367, gen p mean: -0.07658115029335022, mean p set: 0.44926485419273376
loss_pred:0.06620033830404282, decouple_loss:0.039322998374700546
loss_pred:0.06743568927049637, decouple_loss:0.04445691034197807
Iteration: 93, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479353427886963, gen p mean: -0.08261138200759888, mean p set: 0.4484156668186188
loss_pred:0.06615456938743591, decouple_loss:0.03607310354709625
The modified gen p mean: 0.4491589665412903, gen p mean: -0.08340821415185928, mean p set: 0.44963929057121277The modified gen p mean: 0.4459202289581299, gen p mean: -0.08558829128742218, mean p set: 0.44640052318573
loss_pred:0.06681673973798752, decouple_loss:0.03734242171049118
loss_pred:0.06498280167579651, decouple_loss:0.03589406982064247
Iteration: 94, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482974410057068, gen p mean: -0.08543481677770615, mean p set: 0.4487777352333069
loss_pred:0.0644678995013237, decouple_loss:0.03824114426970482
The modified gen p mean: 0.4475783109664917, gen p mean: -0.08424582332372665, mean p set: 0.4480586051940918The modified gen p mean: 0.4459381401538849, gen p mean: -0.0834258422255516, mean p set: 0.446418434381485
loss_pred:0.06773493438959122, decouple_loss:0.03931507095694542
loss_pred:0.06839323043823242, decouple_loss:0.040547698736190796
Iteration: 95, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473434090614319, gen p mean: -0.08219718933105469, mean p set: 0.4478236734867096
loss_pred:0.0648437961935997, decouple_loss:0.03723575174808502
The modified gen p mean: 0.44722527265548706, gen p mean: -0.0811927542090416, mean p set: 0.44770559668540955The modified gen p mean: 0.44616612792015076, gen p mean: -0.08437104523181915, mean p set: 0.44664642214775085
loss_pred:0.06349731236696243, decouple_loss:0.03518502786755562
loss_pred:0.06663572043180466, decouple_loss:0.03692208230495453
Iteration: 96, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44540107250213623, gen p mean: -0.07836520671844482, mean p set: 0.44588136672973633
loss_pred:0.0669713020324707, decouple_loss:0.03546017408370972
The modified gen p mean: 0.44633185863494873, gen p mean: -0.07881402969360352, mean p set: 0.44681212306022644The modified gen p mean: 0.446571409702301, gen p mean: -0.0783107653260231, mean p set: 0.4470517337322235
loss_pred:0.0644308477640152, decouple_loss:0.03512302041053772
loss_pred:0.0669771060347557, decouple_loss:0.03596280515193939
Iteration: 97, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475814700126648, gen p mean: -0.07927178591489792, mean p set: 0.4480617940425873
loss_pred:0.06594537943601608, decouple_loss:0.03722190856933594
The modified gen p mean: 0.4456835389137268, gen p mean: -0.08118189126253128, mean p set: 0.4461638331413269The modified gen p mean: 0.4472919702529907, gen p mean: -0.07897769659757614, mean p set: 0.44777223467826843
loss_pred:0.06571793556213379, decouple_loss:0.03442861884832382
loss_pred:0.06595175713300705, decouple_loss:0.03865557536482811
Iteration: 98, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44823578000068665, gen p mean: -0.08049852401018143, mean p set: 0.44871607422828674
loss_pred:0.06356548517942429, decouple_loss:0.03447779640555382
The modified gen p mean: 0.4471910893917084, gen p mean: -0.07931342720985413, mean p set: 0.4476713538169861The modified gen p mean: 0.4473308026790619, gen p mean: -0.07677485048770905, mean p set: 0.447811096906662
loss_pred:0.06283960491418839, decouple_loss:0.03595113009214401
loss_pred:0.06433872133493423, decouple_loss:0.03807977959513664
Iteration: 99, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44561290740966797, gen p mean: -0.07986558228731155, mean p set: 0.44609320163726807
loss_pred:0.06362929940223694, decouple_loss:0.03633728250861168
The modified gen p mean: 0.44568878412246704, gen p mean: -0.08191606402397156, mean p set: 0.4461691081523895The modified gen p mean: 0.4463096857070923, gen p mean: -0.07771995663642883, mean p set: 0.44678995013237
loss_pred:0.06523812562227249, decouple_loss:0.03465735539793968
loss_pred:0.06463029980659485, decouple_loss:0.035894252359867096
Iteration: 100, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44666028022766113, gen p mean: -0.08026755601167679, mean p set: 0.44714057445526123
loss_pred:0.06349312514066696, decouple_loss:0.03529905155301094
The modified gen p mean: 0.44680696725845337, gen p mean: -0.08207370340824127, mean p set: 0.44728726148605347The modified gen p mean: 0.4458862543106079, gen p mean: -0.08387438207864761, mean p set: 0.446366548538208
loss_pred:0.0635063424706459, decouple_loss:0.03401654586195946
loss_pred:0.06296022981405258, decouple_loss:0.034090492874383926
2023-05-01 11:06:29 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.08561309427022934, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.08599943667650223, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.08555642515420914, mean p set: 0.4500633478164673
loss_pred:0.06481010466814041, decouple_loss:0.03331838548183441
loss_pred:0.06335912644863129, decouple_loss:0.03523721545934677
loss_pred:0.06449015438556671, decouple_loss:0.03321670740842819
WV_0_PC_1_EH_0_PS_40_15, loss: 0.06591600179672241, avg_mse: 0.06450122594833374
current test mse: 0.064501
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012011_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012011_3_24hr.npz
NaN value num: 0
Iteration: 101, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44904762506484985, gen p mean: -0.08398984372615814, mean p set: 0.44952791929244995
loss_pred:0.06292708218097687, decouple_loss:0.03694872930645943
The modified gen p mean: 0.44577547907829285, gen p mean: -0.08694639056921005, mean p set: 0.44625577330589294The modified gen p mean: 0.4467123746871948, gen p mean: -0.08750896900892258, mean p set: 0.4471926689147949
loss_pred:0.0628996342420578, decouple_loss:0.035215944051742554loss_pred:0.06401899456977844, decouple_loss:0.03452711179852486
Iteration: 102, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468763768672943, gen p mean: -0.0812479630112648, mean p set: 0.4473566710948944
loss_pred:0.06211436912417412, decouple_loss:0.03637375682592392
The modified gen p mean: 0.44525769352912903, gen p mean: -0.08375299721956253, mean p set: 0.44573795795440674The modified gen p mean: 0.4466908872127533, gen p mean: -0.08159572631120682, mean p set: 0.4471711814403534
loss_pred:0.062208391726017, decouple_loss:0.03710608184337616
loss_pred:0.0632878839969635, decouple_loss:0.03536565974354744
Iteration: 103, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473477303981781, gen p mean: -0.07987618446350098, mean p set: 0.4478280544281006
loss_pred:0.0605575293302536, decouple_loss:0.0360724963247776
The modified gen p mean: 0.44641295075416565, gen p mean: -0.0810745358467102, mean p set: 0.44689324498176575The modified gen p mean: 0.4468235969543457, gen p mean: -0.08541125059127808, mean p set: 0.4473038911819458
loss_pred:0.060334693640470505, decouple_loss:0.0347994863986969
loss_pred:0.06389743834733963, decouple_loss:0.0341845341026783
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 104, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480065703392029, gen p mean: -0.08145757764577866, mean p set: 0.448486864566803
loss_pred:0.06399092078208923, decouple_loss:0.032614801079034805
The modified gen p mean: 0.4467659592628479, gen p mean: -0.08143781125545502, mean p set: 0.447246253490448The modified gen p mean: 0.4481782019138336, gen p mean: -0.08112680912017822, mean p set: 0.4486584961414337
loss_pred:0.060760319232940674, decouple_loss:0.03472452610731125
loss_pred:0.060318220406770706, decouple_loss:0.03349069133400917
Iteration: 105, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44667911529541016, gen p mean: -0.08212210237979889, mean p set: 0.44715940952301025
loss_pred:0.061054110527038574, decouple_loss:0.03406714275479317
The modified gen p mean: 0.44710493087768555, gen p mean: -0.07766546308994293, mean p set: 0.44758522510528564The modified gen p mean: 0.4474707841873169, gen p mean: -0.07846534997224808, mean p set: 0.447951078414917
loss_pred:0.05925789475440979, decouple_loss:0.03519435599446297
loss_pred:0.06369747221469879, decouple_loss:0.034041743725538254
Iteration: 106, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44734594225883484, gen p mean: -0.07618146389722824, mean p set: 0.44782623648643494
loss_pred:0.06170958653092384, decouple_loss:0.03583995997905731
The modified gen p mean: 0.4462599456310272, gen p mean: -0.07694543898105621, mean p set: 0.4467402696609497The modified gen p mean: 0.44691959023475647, gen p mean: -0.0794757530093193, mean p set: 0.4473998546600342
loss_pred:0.06244365870952606, decouple_loss:0.03362451121211052
loss_pred:0.06312879920005798, decouple_loss:0.034970689564943314
Iteration: 107, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44599369168281555, gen p mean: -0.06652457267045975, mean p set: 0.44647401571273804
loss_pred:0.06221576780080795, decouple_loss:0.03952864557504654
The modified gen p mean: 0.44568493962287903, gen p mean: -0.0712600126862526, mean p set: 0.4461652636528015The modified gen p mean: 0.44879674911499023, gen p mean: -0.06940238177776337, mean p set: 0.44927704334259033
loss_pred:0.061481647193431854, decouple_loss:0.03781510144472122
loss_pred:0.06338169425725937, decouple_loss:0.037470970302820206
Iteration: 108, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4461469054222107, gen p mean: -0.07755737006664276, mean p set: 0.4466271698474884
loss_pred:0.05961800366640091, decouple_loss:0.03402262553572655
The modified gen p mean: 0.4483022689819336, gen p mean: -0.0701274499297142, mean p set: 0.4487825632095337The modified gen p mean: 0.44677528738975525, gen p mean: -0.07415010035037994, mean p set: 0.44725558161735535
loss_pred:0.059536807239055634, decouple_loss:0.03815968334674835
loss_pred:0.060872118920087814, decouple_loss:0.03367400914430618
Iteration: 109, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4462074935436249, gen p mean: -0.08454969525337219, mean p set: 0.44668781757354736
loss_pred:0.06051679328083992, decouple_loss:0.03674718737602234
The modified gen p mean: 0.44664016366004944, gen p mean: -0.0806172713637352, mean p set: 0.44712045788764954The modified gen p mean: 0.4473292827606201, gen p mean: -0.08796624839305878, mean p set: 0.4478095471858978
loss_pred:0.06063876673579216, decouple_loss:0.03599177300930023
loss_pred:0.059795718640089035, decouple_loss:0.03774550184607506
Iteration: 110, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448574036359787, gen p mean: -0.06739139556884766, mean p set: 0.4490543007850647
loss_pred:0.06114589050412178, decouple_loss:0.037566401064395905
The modified gen p mean: 0.4475928544998169, gen p mean: -0.06899266690015793, mean p set: 0.448073148727417The modified gen p mean: 0.4488367438316345, gen p mean: -0.06932813674211502, mean p set: 0.44931700825691223
loss_pred:0.06046312302350998, decouple_loss:0.03645002096891403
loss_pred:0.05896031856536865, decouple_loss:0.03741626814007759
2023-05-01 11:09:02 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.08025631308555603, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.08014104515314102, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.07890342175960541, mean p set: 0.4500633478164673
loss_pred:0.061479777097702026, decouple_loss:0.0343283973634243
loss_pred:0.060323700308799744, decouple_loss:0.03634163364768028
loss_pred:0.06116482615470886, decouple_loss:0.033659227192401886
WV_0_PC_1_EH_0_PS_40_15, loss: 0.06272825598716736, avg_mse: 0.06124027445912361
current test mse: 0.06124
Iteration: 111, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472138285636902, gen p mean: -0.07595614343881607, mean p set: 0.4476941227912903
The modified gen p mean: 0.44704756140708923, gen p mean: -0.07713764905929565, mean p set: 0.44752782583236694
The modified gen p mean: 0.4474453032016754, gen p mean: -0.07618459314107895, mean p set: 0.4479255974292755
loss_pred:0.06145128980278969, decouple_loss:0.03342611715197563
loss_pred:0.06196746975183487, decouple_loss:0.03495613485574722
loss_pred:0.060878168791532516, decouple_loss:0.03275248408317566
Iteration: 112, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44751569628715515, gen p mean: -0.08495333045721054, mean p set: 0.44799599051475525
loss_pred:0.059921275824308395, decouple_loss:0.03474172577261925
The modified gen p mean: 0.4464486539363861, gen p mean: -0.0787002444267273, mean p set: 0.4469289183616638The modified gen p mean: 0.44647493958473206, gen p mean: -0.07796014100313187, mean p set: 0.44695523381233215
loss_pred:0.05903622880578041, decouple_loss:0.03256708011031151
loss_pred:0.05866624042391777, decouple_loss:0.03234304487705231
Iteration: 113, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44760069251060486, gen p mean: -0.08169207721948624, mean p set: 0.44808098673820496
loss_pred:0.05775285139679909, decouple_loss:0.032809045165777206
The modified gen p mean: 0.44746020436286926, gen p mean: -0.08562447875738144, mean p set: 0.44794052839279175The modified gen p mean: 0.44820311665534973, gen p mean: -0.08072681725025177, mean p set: 0.44868341088294983
loss_pred:0.057437945157289505, decouple_loss:0.03433568775653839
loss_pred:0.058465808629989624, decouple_loss:0.03472749516367912
Iteration: 114, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44662079215049744, gen p mean: -0.0794217437505722, mean p set: 0.4471011161804199
loss_pred:0.05911487340927124, decouple_loss:0.03435481712222099
The modified gen p mean: 0.4478110074996948, gen p mean: -0.08083081245422363, mean p set: 0.4482913017272949The modified gen p mean: 0.4459315538406372, gen p mean: -0.07783781737089157, mean p set: 0.4464118480682373
loss_pred:0.05802933871746063, decouple_loss:0.03419318050146103
loss_pred:0.058779243379831314, decouple_loss:0.03278575465083122
Iteration: 115, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44885820150375366, gen p mean: -0.07516828924417496, mean p set: 0.44933852553367615
loss_pred:0.06015079468488693, decouple_loss:0.034653011709451675
The modified gen p mean: 0.44810670614242554, gen p mean: -0.0746864452958107, mean p set: 0.44858697056770325The modified gen p mean: 0.44632503390312195, gen p mean: -0.07535133510828018, mean p set: 0.44680535793304443
loss_pred:0.0579226128757, decouple_loss:0.034170668572187424
loss_pred:0.05708480253815651, decouple_loss:0.034319180995225906
Iteration: 116, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468863010406494, gen p mean: -0.07288800925016403, mean p set: 0.4473665952682495
loss_pred:0.06024833023548126, decouple_loss:0.034434977918863297
The modified gen p mean: 0.4456796944141388, gen p mean: -0.07208555936813354, mean p set: 0.4461599588394165The modified gen p mean: 0.44582533836364746, gen p mean: -0.07338852435350418, mean p set: 0.44630563259124756
loss_pred:0.06003580614924431, decouple_loss:0.03625864163041115
loss_pred:0.056686367839574814, decouple_loss:0.03356795012950897
Iteration: 117, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44646894931793213, gen p mean: -0.08094123005867004, mean p set: 0.44694921374320984
loss_pred:0.05744689330458641, decouple_loss:0.03294963017106056
The modified gen p mean: 0.4460310637950897, gen p mean: -0.08341383188962936, mean p set: 0.44651132822036743The modified gen p mean: 0.44859594106674194, gen p mean: -0.08687668293714523, mean p set: 0.44907623529434204
loss_pred:0.05812689661979675, decouple_loss:0.030891386792063713
loss_pred:0.059852685779333115, decouple_loss:0.03483589366078377
Iteration: 118, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44625359773635864, gen p mean: -0.07735918462276459, mean p set: 0.44673389196395874
loss_pred:0.05776764079928398, decouple_loss:0.032682593911886215
The modified gen p mean: 0.44582653045654297, gen p mean: -0.07132507115602493, mean p set: 0.44630685448646545The modified gen p mean: 0.4479667842388153, gen p mean: -0.07373505085706711, mean p set: 0.4484470784664154
loss_pred:0.058925431221723557, decouple_loss:0.03308882564306259
loss_pred:0.05817928910255432, decouple_loss:0.03283960372209549
Iteration: 119, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44609498977661133, gen p mean: -0.06342370063066483, mean p set: 0.4465752840042114
loss_pred:0.0593232735991478, decouple_loss:0.03228677064180374
The modified gen p mean: 0.4452895224094391, gen p mean: -0.07075567543506622, mean p set: 0.4457697868347168The modified gen p mean: 0.4472636580467224, gen p mean: -0.07311517745256424, mean p set: 0.4477439522743225
loss_pred:0.057589393109083176, decouple_loss:0.03292861953377724
loss_pred:0.05926576629281044, decouple_loss:0.031733181327581406
Iteration: 120, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4463035762310028, gen p mean: -0.07388554513454437, mean p set: 0.4467838406562805
loss_pred:0.056245479732751846, decouple_loss:0.032240595668554306
The modified gen p mean: 0.44739651679992676, gen p mean: -0.07066445052623749, mean p set: 0.44787678122520447The modified gen p mean: 0.44817230105400085, gen p mean: -0.07601340115070343, mean p set: 0.44865259528160095
loss_pred:0.05652317404747009, decouple_loss:0.03243749961256981
loss_pred:0.05833813548088074, decouple_loss:0.030925171449780464
2023-05-01 11:10:58 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.08231449127197266, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.08462285995483398, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.08214215934276581, mean p set: 0.4500633478164673
loss_pred:0.05968288332223892, decouple_loss:0.03551259636878967
loss_pred:0.05803276598453522, decouple_loss:0.03623959422111511
loss_pred:0.05911152437329292, decouple_loss:0.03402480110526085
WV_0_PC_1_EH_0_PS_40_15, loss: 0.06070534512400627, avg_mse: 0.05935903266072273
current test mse: 0.059359
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012002_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012002_3_24hr.npz
NaN value num: 0
Iteration: 121, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450796902179718, gen p mean: -0.07665359228849411, mean p set: 0.4512771964073181
loss_pred:0.06320317834615707, decouple_loss:0.04552321135997772
The modified gen p mean: 0.4493029713630676, gen p mean: -0.07923849672079086, mean p set: 0.4497832953929901The modified gen p mean: 0.4491126239299774, gen p mean: -0.0795830488204956, mean p set: 0.4495929181575775
loss_pred:0.06415751576423645, decouple_loss:0.046354059129953384
loss_pred:0.06378183513879776, decouple_loss:0.051847949624061584
Iteration: 122, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45152056217193604, gen p mean: -0.0802592784166336, mean p set: 0.45200085639953613
loss_pred:0.06174704432487488, decouple_loss:0.056133441627025604
The modified gen p mean: 0.4504595994949341, gen p mean: -0.07868204265832901, mean p set: 0.45093992352485657The modified gen p mean: 0.45159289240837097, gen p mean: -0.07695548981428146, mean p set: 0.45207321643829346
loss_pred:0.06350824981927872, decouple_loss:0.054011717438697815
loss_pred:0.06456658244132996, decouple_loss:0.05417609587311745
Iteration: 123, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45023706555366516, gen p mean: -0.07923924177885056, mean p set: 0.45071735978126526
loss_pred:0.05922368913888931, decouple_loss:0.04878309741616249
The modified gen p mean: 0.452171266078949, gen p mean: -0.07929504662752151, mean p set: 0.45265159010887146The modified gen p mean: 0.4498801827430725, gen p mean: -0.07952465862035751, mean p set: 0.4503604471683502
loss_pred:0.06485692411661148, decouple_loss:0.051124971359968185
loss_pred:0.06040991097688675, decouple_loss:0.04941682890057564
Iteration: 124, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495282769203186, gen p mean: -0.09479246288537979, mean p set: 0.4500085711479187
loss_pred:0.06143520027399063, decouple_loss:0.04942836984992027
The modified gen p mean: 0.44964835047721863, gen p mean: -0.09762759506702423, mean p set: 0.4501286447048187The modified gen p mean: 0.4495278596878052, gen p mean: -0.09414894878864288, mean p set: 0.4500081539154053
loss_pred:0.05981326475739479, decouple_loss:0.04836370050907135
loss_pred:0.06162354722619057, decouple_loss:0.049352049827575684
Iteration: 125, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45185157656669617, gen p mean: -0.09542028605937958, mean p set: 0.45233187079429626
loss_pred:0.060477349907159805, decouple_loss:0.049848977476358414
The modified gen p mean: 0.44972214102745056, gen p mean: -0.09473633766174316, mean p set: 0.45020246505737305The modified gen p mean: 0.4491424560546875, gen p mean: -0.09286125004291534, mean p set: 0.4496227502822876
loss_pred:0.060645196586847305, decouple_loss:0.050090242177248
loss_pred:0.05804547294974327, decouple_loss:0.04786403849720955
Iteration: 126, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44922783970832825, gen p mean: -0.09497925639152527, mean p set: 0.44970813393592834
loss_pred:0.05811074748635292, decouple_loss:0.04855992645025253
The modified gen p mean: 0.4525979459285736, gen p mean: -0.09488869458436966, mean p set: 0.4530782699584961The modified gen p mean: 0.44900307059288025, gen p mean: -0.09597858041524887, mean p set: 0.44948339462280273
loss_pred:0.061850521713495255, decouple_loss:0.05135544016957283
loss_pred:0.059338439255952835, decouple_loss:0.049606803804636
Iteration: 127, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44909462332725525, gen p mean: -0.10111214965581894, mean p set: 0.44957494735717773
loss_pred:0.05483168363571167, decouple_loss:0.049464717507362366
The modified gen p mean: 0.4500953257083893, gen p mean: -0.1013849601149559, mean p set: 0.4505756199359894The modified gen p mean: 0.4497600495815277, gen p mean: -0.09880121052265167, mean p set: 0.4502403438091278
loss_pred:0.060378819704055786, decouple_loss:0.04817698895931244
loss_pred:0.05851827934384346, decouple_loss:0.04731664061546326
Iteration: 128, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504971206188202, gen p mean: -0.10193483531475067, mean p set: 0.4509774148464203
loss_pred:0.06085697561502457, decouple_loss:0.04509631544351578
The modified gen p mean: 0.44943132996559143, gen p mean: -0.10162170231342316, mean p set: 0.44991159439086914The modified gen p mean: 0.44990983605384827, gen p mean: -0.10339342802762985, mean p set: 0.45039013028144836
loss_pred:0.0564950667321682, decouple_loss:0.04582524672150612
loss_pred:0.06065065413713455, decouple_loss:0.04491715505719185
Iteration: 129, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511413872241974, gen p mean: -0.09349295496940613, mean p set: 0.4516216814517975
loss_pred:0.06076832488179207, decouple_loss:0.04653844237327576
The modified gen p mean: 0.44934192299842834, gen p mean: -0.09817410260438919, mean p set: 0.44982221722602844
The modified gen p mean: 0.4497954249382019, gen p mean: -0.09975150972604752, mean p set: 0.450275719165802
loss_pred:0.05875774472951889, decouple_loss:0.04520951956510544
loss_pred:0.05685633420944214, decouple_loss:0.04436662048101425
Iteration: 130, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44913122057914734, gen p mean: -0.09135197103023529, mean p set: 0.44961148500442505
loss_pred:0.05662575736641884, decouple_loss:0.042281899601221085
The modified gen p mean: 0.44958746433258057, gen p mean: -0.09253493696451187, mean p set: 0.45006775856018066The modified gen p mean: 0.4512721002101898, gen p mean: -0.09488368034362793, mean p set: 0.45175236463546753
loss_pred:0.06053808704018593, decouple_loss:0.0431753508746624
loss_pred:0.05748157203197479, decouple_loss:0.04345746710896492
2023-05-01 11:13:44 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.09408186376094818, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.09480590373277664, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.09521942585706711, mean p set: 0.4500633478164673
loss_pred:0.06283028423786163, decouple_loss:0.04852182790637016
loss_pred:0.06058000400662422, decouple_loss:0.05189315229654312
loss_pred:0.06147347018122673, decouple_loss:0.04856105521321297
WV_0_PC_1_EH_0_PS_40_15, loss: 0.06411086022853851, avg_mse: 0.06308876723051071
current test mse: 0.063089
Iteration: 131, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45032089948654175, gen p mean: -0.09628167003393173, mean p set: 0.45080122351646423
The modified gen p mean: 0.4498962461948395, gen p mean: -0.09676187485456467, mean p set: 0.4503765404224396
The modified gen p mean: 0.4511229395866394, gen p mean: -0.093601293861866, mean p set: 0.4516032636165619
loss_pred:0.058497924357652664, decouple_loss:0.04240698367357254
loss_pred:0.058647722005844116, decouple_loss:0.04353059083223343
loss_pred:0.0574931763112545, decouple_loss:0.04245344176888466
Iteration: 132, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44909989833831787, gen p mean: -0.0984077900648117, mean p set: 0.44958019256591797
loss_pred:0.0562712624669075, decouple_loss:0.04453857243061066
The modified gen p mean: 0.45121848583221436, gen p mean: -0.0978352352976799, mean p set: 0.45169880986213684The modified gen p mean: 0.4493807256221771, gen p mean: -0.09816381335258484, mean p set: 0.4498610198497772
loss_pred:0.05887649580836296, decouple_loss:0.04136274755001068
loss_pred:0.05827615037560463, decouple_loss:0.04314210265874863
Iteration: 133, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44978171586990356, gen p mean: -0.09806510806083679, mean p set: 0.4502619802951813
loss_pred:0.05667976289987564, decouple_loss:0.04151487350463867
The modified gen p mean: 0.4496801793575287, gen p mean: -0.09840431064367294, mean p set: 0.4501604735851288The modified gen p mean: 0.44933202862739563, gen p mean: -0.09857285022735596, mean p set: 0.4498123526573181
loss_pred:0.05614869296550751, decouple_loss:0.04213903844356537
loss_pred:0.05661262571811676, decouple_loss:0.04126323014497757
Iteration: 134, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511968493461609, gen p mean: -0.10345428436994553, mean p set: 0.451677143573761
loss_pred:0.060507893562316895, decouple_loss:0.04064694419503212
The modified gen p mean: 0.4492533504962921, gen p mean: -0.10371815413236618, mean p set: 0.4497336745262146The modified gen p mean: 0.4499051570892334, gen p mean: -0.09626069664955139, mean p set: 0.4503854513168335
loss_pred:0.05673585459589958, decouple_loss:0.040216509252786636
loss_pred:0.05307146906852722, decouple_loss:0.0405181422829628
Iteration: 135, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44988110661506653, gen p mean: -0.10167961567640305, mean p set: 0.4503614008426666
loss_pred:0.05592544749379158, decouple_loss:0.03849273547530174
The modified gen p mean: 0.44972312450408936, gen p mean: -0.1030130535364151, mean p set: 0.45020341873168945The modified gen p mean: 0.4518599212169647, gen p mean: -0.10253589600324631, mean p set: 0.4523402154445648
loss_pred:0.05936744436621666, decouple_loss:0.03926612809300423
loss_pred:0.05976023152470589, decouple_loss:0.04228004068136215
Iteration: 136, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45017534494400024, gen p mean: -0.11410069465637207, mean p set: 0.45065566897392273
loss_pred:0.05948542058467865, decouple_loss:0.03808262199163437
The modified gen p mean: 0.44948163628578186, gen p mean: -0.11740213632583618, mean p set: 0.44996196031570435The modified gen p mean: 0.4489581882953644, gen p mean: -0.10919637233018875, mean p set: 0.4494384825229645
loss_pred:0.05378727614879608, decouple_loss:0.03945472836494446
loss_pred:0.05691932141780853, decouple_loss:0.04028448089957237
Iteration: 137, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44930359721183777, gen p mean: -0.11475499719381332, mean p set: 0.44978389143943787
loss_pred:0.05436792969703674, decouple_loss:0.03718478977680206
The modified gen p mean: 0.45003464818000793, gen p mean: -0.11625242978334427, mean p set: 0.45051491260528564The modified gen p mean: 0.45126527547836304, gen p mean: -0.11930687725543976, mean p set: 0.45174553990364075
loss_pred:0.05515127629041672, decouple_loss:0.03598196431994438
loss_pred:0.060104016214609146, decouple_loss:0.03863470256328583
Iteration: 138, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449188768863678, gen p mean: -0.11486410349607468, mean p set: 0.4496690630912781
loss_pred:0.05449763312935829, decouple_loss:0.038237910717725754
The modified gen p mean: 0.4501973092556, gen p mean: -0.11432631313800812, mean p set: 0.45067763328552246The modified gen p mean: 0.4514003098011017, gen p mean: -0.11117904633283615, mean p set: 0.4518806040287018
loss_pred:0.05701818689703941, decouple_loss:0.03840556740760803
loss_pred:0.05716416612267494, decouple_loss:0.03922885283827782
Iteration: 139, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45158398151397705, gen p mean: -0.11278843879699707, mean p set: 0.45206427574157715
loss_pred:0.05713694915175438, decouple_loss:0.04133376106619835
The modified gen p mean: 0.4506269693374634, gen p mean: -0.10917762666940689, mean p set: 0.4511072635650635The modified gen p mean: 0.4490774869918823, gen p mean: -0.11400747299194336, mean p set: 0.4495577812194824
loss_pred:0.05821461230516434, decouple_loss:0.038193631917238235
loss_pred:0.055478040128946304, decouple_loss:0.036740273237228394
Iteration: 140, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44946157932281494, gen p mean: -0.11628608405590057, mean p set: 0.44994187355041504
loss_pred:0.05472441390156746, decouple_loss:0.03610766679048538
The modified gen p mean: 0.44902917742729187, gen p mean: -0.12229610979557037, mean p set: 0.44950950145721436The modified gen p mean: 0.45139554142951965, gen p mean: -0.11680249869823456, mean p set: 0.45187583565711975
loss_pred:0.055698491632938385, decouple_loss:0.03784341365098953
loss_pred:0.05877094715833664, decouple_loss:0.03692550212144852
2023-05-01 11:15:39 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.11914647370576859, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.11984281986951828, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.12052250653505325, mean p set: 0.4500633478164673
loss_pred:0.06105142831802368, decouple_loss:0.045724064111709595
loss_pred:0.05885737016797066, decouple_loss:0.049232643097639084
loss_pred:0.05986038222908974, decouple_loss:0.04523945227265358
WV_0_PC_1_EH_0_PS_40_15, loss: 0.06225966662168503, avg_mse: 0.06125541403889656
current test mse: 0.061255
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012013_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012013_3_24hr.npz
NaN value num: 0
Iteration: 141, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45143362879753113, gen p mean: -0.11885855346918106, mean p set: 0.45191389322280884
loss_pred:0.060525842010974884, decouple_loss:0.04288649931550026
The modified gen p mean: 0.44914960861206055, gen p mean: -0.11406809836626053, mean p set: 0.44962990283966064The modified gen p mean: 0.4502499997615814, gen p mean: -0.11841510981321335, mean p set: 0.4507302939891815
loss_pred:0.061522915959358215, decouple_loss:0.0442255400121212
loss_pred:0.06038299947977066, decouple_loss:0.040619928389787674
Iteration: 142, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44930562376976013, gen p mean: -0.11955823749303818, mean p set: 0.44978588819503784
loss_pred:0.060735419392585754, decouple_loss:0.039941273629665375
The modified gen p mean: 0.4497581422328949, gen p mean: -0.10777625441551208, mean p set: 0.450238436460495The modified gen p mean: 0.4498560428619385, gen p mean: -0.12208939343690872, mean p set: 0.4503363370895386
loss_pred:0.05818697810173035, decouple_loss:0.04141232743859291
loss_pred:0.06052625924348831, decouple_loss:0.0466122105717659
Iteration: 143, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497682750225067, gen p mean: -0.1095021590590477, mean p set: 0.4502485692501068
loss_pred:0.058414276689291, decouple_loss:0.04228109121322632
The modified gen p mean: 0.4491064250469208, gen p mean: -0.11707007139921188, mean p set: 0.44958674907684326The modified gen p mean: 0.45054301619529724, gen p mean: -0.11433716863393784, mean p set: 0.4510233402252197
loss_pred:0.05888551101088524, decouple_loss:0.04297199472784996
loss_pred:0.05869389697909355, decouple_loss:0.039187636226415634
Iteration: 144, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487893879413605, gen p mean: -0.11003345996141434, mean p set: 0.4492696523666382
loss_pred:0.05769629031419754, decouple_loss:0.04062457010149956
The modified gen p mean: 0.4504499137401581, gen p mean: -0.10953757911920547, mean p set: 0.4509302079677582The modified gen p mean: 0.45072245597839355, gen p mean: -0.1111878976225853, mean p set: 0.45120275020599365
loss_pred:0.05823741853237152, decouple_loss:0.04295039549469948
loss_pred:0.058092810213565826, decouple_loss:0.04011653736233711
Iteration: 145, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45036378502845764, gen p mean: -0.09911206364631653, mean p set: 0.45084407925605774
loss_pred:0.058944135904312134, decouple_loss:0.03934507817029953
The modified gen p mean: 0.45064085721969604, gen p mean: -0.10888117551803589, mean p set: 0.45112112164497375The modified gen p mean: 0.4503313899040222, gen p mean: -0.09888012707233429, mean p set: 0.4508116841316223
loss_pred:0.05765040963888168, decouple_loss:0.040455132722854614
loss_pred:0.059250395745038986, decouple_loss:0.040180549025535583
Iteration: 146, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486290216445923, gen p mean: -0.10337137430906296, mean p set: 0.4491093158721924
loss_pred:0.05946619063615799, decouple_loss:0.04453783854842186
The modified gen p mean: 0.45106902718544006, gen p mean: -0.11028728634119034, mean p set: 0.45154935121536255The modified gen p mean: 0.45092812180519104, gen p mean: -0.1105157732963562, mean p set: 0.45140841603279114
loss_pred:0.05784099921584129, decouple_loss:0.043063122779130936
loss_pred:0.05615830793976784, decouple_loss:0.04130300506949425
Iteration: 147, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44861987233161926, gen p mean: -0.10755740851163864, mean p set: 0.44910016655921936
loss_pred:0.05622904375195503, decouple_loss:0.04157117381691933
The modified gen p mean: 0.4491533041000366, gen p mean: -0.1046292632818222, mean p set: 0.4496335983276367The modified gen p mean: 0.4475768506526947, gen p mean: -0.10855311155319214, mean p set: 0.4480571150779724
loss_pred:0.05621543526649475, decouple_loss:0.042274270206689835
loss_pred:0.057285889983177185, decouple_loss:0.045418839901685715
Iteration: 148, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44876593351364136, gen p mean: -0.10725036263465881, mean p set: 0.44924622774124146
loss_pred:0.05716706067323685, decouple_loss:0.041042428463697433
The modified gen p mean: 0.45086777210235596, gen p mean: -0.10565115511417389, mean p set: 0.45134806632995605The modified gen p mean: 0.44862791895866394, gen p mean: -0.10557776689529419, mean p set: 0.44910821318626404
loss_pred:0.05875790864229202, decouple_loss:0.04139672964811325
loss_pred:0.05824921280145645, decouple_loss:0.041888006031513214
Iteration: 149, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45052289962768555, gen p mean: -0.09992468357086182, mean p set: 0.45100319385528564
loss_pred:0.05660529434680939, decouple_loss:0.04201175644993782
The modified gen p mean: 0.4490281939506531, gen p mean: -0.10125266760587692, mean p set: 0.4495084881782532The modified gen p mean: 0.45072975754737854, gen p mean: -0.10046283155679703, mean p set: 0.451210081577301
loss_pred:0.05769020691514015, decouple_loss:0.03968202695250511
loss_pred:0.058432187885046005, decouple_loss:0.04073434695601463
Iteration: 150, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44977468252182007, gen p mean: -0.10737336426973343, mean p set: 0.45025497674942017
loss_pred:0.058033861219882965, decouple_loss:0.04121486470103264
The modified gen p mean: 0.4488905966281891, gen p mean: -0.11033622920513153, mean p set: 0.4493708908557892The modified gen p mean: 0.4492305815219879, gen p mean: -0.10170185565948486, mean p set: 0.449710875749588
loss_pred:0.05932484567165375, decouple_loss:0.03928636386990547
loss_pred:0.05775570496916771, decouple_loss:0.04169990122318268
2023-05-01 11:18:17 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.10536376386880875, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.10476783663034439, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.10423638671636581, mean p set: 0.4500633478164673
loss_pred:0.06039851903915405, decouple_loss:0.04206845909357071
loss_pred:0.0582415908575058, decouple_loss:0.04298711568117142
loss_pred:0.05989838019013405, decouple_loss:0.04097285494208336
WV_0_PC_1_EH_0_PS_40_15, loss: 0.0616133026778698, avg_mse: 0.06086767464876175
current test mse: 0.060868
Iteration: 151, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4509217441082001, gen p mean: -0.10737796127796173, mean p set: 0.4514020085334778
The modified gen p mean: 0.4503542184829712, gen p mean: -0.1028943657875061, mean p set: 0.4508344829082489
The modified gen p mean: 0.45012757182121277, gen p mean: -0.10395324975252151, mean p set: 0.45060789585113525
loss_pred:0.05654502660036087, decouple_loss:0.042976509779691696
loss_pred:0.05700504779815674, decouple_loss:0.04425673186779022
loss_pred:0.0571708120405674, decouple_loss:0.04354634881019592
Iteration: 152, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44987475872039795, gen p mean: -0.10365082323551178, mean p set: 0.45035505294799805
loss_pred:0.05806536599993706, decouple_loss:0.04290052875876427
The modified gen p mean: 0.4498160481452942, gen p mean: -0.10034719109535217, mean p set: 0.4502963423728943The modified gen p mean: 0.4512108862400055, gen p mean: -0.09698061645030975, mean p set: 0.451691210269928
loss_pred:0.05619852617383003, decouple_loss:0.039788007736206055
loss_pred:0.055863987654447556, decouple_loss:0.03880767151713371
Iteration: 153, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45018118619918823, gen p mean: -0.1070513054728508, mean p set: 0.45066148042678833
loss_pred:0.05649857595562935, decouple_loss:0.04170374572277069
The modified gen p mean: 0.45021581649780273, gen p mean: -0.10616682469844818, mean p set: 0.45069611072540283The modified gen p mean: 0.4474261403083801, gen p mean: -0.10689220577478409, mean p set: 0.4479064345359802
loss_pred:0.05469642952084541, decouple_loss:0.04227651283144951
loss_pred:0.05680694058537483, decouple_loss:0.0417696051299572
Iteration: 154, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44924396276474, gen p mean: -0.10267522186040878, mean p set: 0.4497242569923401
loss_pred:0.05690215155482292, decouple_loss:0.03944374993443489
The modified gen p mean: 0.45012181997299194, gen p mean: -0.11009623855352402, mean p set: 0.45060214400291443
The modified gen p mean: 0.4504632353782654, gen p mean: -0.11673671007156372, mean p set: 0.4509435296058655
loss_pred:0.05691169202327728, decouple_loss:0.039327509701251984
loss_pred:0.05516999959945679, decouple_loss:0.03842407092452049
Iteration: 155, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4509749114513397, gen p mean: -0.11541923880577087, mean p set: 0.4514552056789398
loss_pred:0.05867113918066025, decouple_loss:0.0406767837703228
The modified gen p mean: 0.4501963257789612, gen p mean: -0.11216636747121811, mean p set: 0.4506766200065613The modified gen p mean: 0.45089563727378845, gen p mean: -0.11749237030744553, mean p set: 0.45137593150138855
loss_pred:0.05712636187672615, decouple_loss:0.041802745312452316
loss_pred:0.05664431303739548, decouple_loss:0.04059330374002457
Iteration: 156, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45071253180503845, gen p mean: -0.1262851357460022, mean p set: 0.45119279623031616
loss_pred:0.056561313569545746, decouple_loss:0.0409604012966156
The modified gen p mean: 0.450836181640625, gen p mean: -0.11515216529369354, mean p set: 0.4513164758682251The modified gen p mean: 0.4506642520427704, gen p mean: -0.12555837631225586, mean p set: 0.4511445164680481
loss_pred:0.05540861189365387, decouple_loss:0.039031703025102615
loss_pred:0.05896804854273796, decouple_loss:0.039166662842035294
Iteration: 157, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498402774333954, gen p mean: -0.12638895213603973, mean p set: 0.4503205716609955
loss_pred:0.05706341192126274, decouple_loss:0.03918170928955078
The modified gen p mean: 0.4507967233657837, gen p mean: -0.12446868419647217, mean p set: 0.4512770175933838The modified gen p mean: 0.4486198127269745, gen p mean: -0.123042032122612, mean p set: 0.4491001069545746
loss_pred:0.05558347329497337, decouple_loss:0.039713673293590546
loss_pred:0.05596271529793739, decouple_loss:0.03649860993027687
Iteration: 158, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502987265586853, gen p mean: -0.11925720423460007, mean p set: 0.4507790505886078
loss_pred:0.054957304149866104, decouple_loss:0.03943723812699318
The modified gen p mean: 0.4508408308029175, gen p mean: -0.11826778948307037, mean p set: 0.4513210952281952The modified gen p mean: 0.44932565093040466, gen p mean: -0.11344960331916809, mean p set: 0.4498059153556824
loss_pred:0.0555754080414772, decouple_loss:0.03979985788464546
loss_pred:0.05649727210402489, decouple_loss:0.03941194340586662
Iteration: 159, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45033878087997437, gen p mean: -0.1117740273475647, mean p set: 0.45081907510757446
loss_pred:0.05629977956414223, decouple_loss:0.038485653698444366
The modified gen p mean: 0.4506102502346039, gen p mean: -0.11776120960712433, mean p set: 0.451090544462204The modified gen p mean: 0.4493718445301056, gen p mean: -0.10305469483137131, mean p set: 0.4498521387577057
loss_pred:0.056544750928878784, decouple_loss:0.03908896446228027
loss_pred:0.058539096266031265, decouple_loss:0.041249699890613556
Iteration: 160, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502270221710205, gen p mean: -0.12286147475242615, mean p set: 0.4507073163986206
loss_pred:0.05535067617893219, decouple_loss:0.03759140148758888
The modified gen p mean: 0.4498802423477173, gen p mean: -0.11053404211997986, mean p set: 0.4503605365753174
The modified gen p mean: 0.45062705874443054, gen p mean: -0.12326207756996155, mean p set: 0.451107382774353
loss_pred:0.05650520697236061, decouple_loss:0.03750884532928467
loss_pred:0.0553429014980793, decouple_loss:0.04133808612823486
2023-05-01 11:20:12 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.12940846383571625, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.13014565408229828, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.12800255417823792, mean p set: 0.4500633478164673
loss_pred:0.05997072532773018, decouple_loss:0.04507574066519737
loss_pred:0.05772000923752785, decouple_loss:0.04845590516924858
loss_pred:0.05890955030918121, decouple_loss:0.044384509325027466
WV_0_PC_1_EH_0_PS_40_15, loss: 0.06116536259651184, avg_mse: 0.060521017760038376
current test mse: 0.060521
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012020_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012020_3_24hr.npz
NaN value num: 0
Iteration: 161, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513704478740692, gen p mean: -0.13545942306518555, mean p set: 0.4518507122993469
loss_pred:0.05817480757832527, decouple_loss:0.04179709032177925
The modified gen p mean: 0.45031094551086426, gen p mean: -0.13026733696460724, mean p set: 0.45079126954078674The modified gen p mean: 0.4517481029033661, gen p mean: -0.1341511756181717, mean p set: 0.4522283971309662
loss_pred:0.05665316432714462, decouple_loss:0.04567420110106468
loss_pred:0.05358603969216347, decouple_loss:0.04106931760907173
Iteration: 162, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4523312449455261, gen p mean: -0.13761873543262482, mean p set: 0.4528115391731262
loss_pred:0.058442216366529465, decouple_loss:0.04288593679666519
The modified gen p mean: 0.4532828629016876, gen p mean: -0.13929392397403717, mean p set: 0.45376312732696533The modified gen p mean: 0.4532754719257355, gen p mean: -0.142814040184021, mean p set: 0.45375579595565796
loss_pred:0.05775441229343414, decouple_loss:0.040362756699323654
loss_pred:0.05621843412518501, decouple_loss:0.04268818721175194
Iteration: 163, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4534585177898407, gen p mean: -0.13784542679786682, mean p set: 0.4539388418197632
loss_pred:0.05666333809494972, decouple_loss:0.03916117176413536
The modified gen p mean: 0.45068544149398804, gen p mean: -0.13872995972633362, mean p set: 0.45116573572158813The modified gen p mean: 0.45171672105789185, gen p mean: -0.13946394622325897, mean p set: 0.45219701528549194
loss_pred:0.05221196264028549, decouple_loss:0.04023127630352974
loss_pred:0.05839100107550621, decouple_loss:0.04395944997668266
Iteration: 164, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45291364192962646, gen p mean: -0.14031827449798584, mean p set: 0.45339396595954895
loss_pred:0.05455031991004944, decouple_loss:0.03826916217803955
The modified gen p mean: 0.45361801981925964, gen p mean: -0.1394214928150177, mean p set: 0.45409834384918213The modified gen p mean: 0.45033156871795654, gen p mean: -0.13879437744617462, mean p set: 0.45081186294555664
loss_pred:0.054027486592531204, decouple_loss:0.03665401041507721
loss_pred:0.05694369226694107, decouple_loss:0.04031592607498169
Iteration: 165, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4515725374221802, gen p mean: -0.13147112727165222, mean p set: 0.4520528018474579
loss_pred:0.054979559034109116, decouple_loss:0.03809155896306038
The modified gen p mean: 0.4520209729671478, gen p mean: -0.1342329978942871, mean p set: 0.45250123739242554The modified gen p mean: 0.45275965332984924, gen p mean: -0.1378355622291565, mean p set: 0.45323994755744934
loss_pred:0.05328923463821411, decouple_loss:0.0367884486913681
loss_pred:0.05652496963739395, decouple_loss:0.03752628713846207
Iteration: 166, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44847601652145386, gen p mean: -0.14419496059417725, mean p set: 0.44895628094673157
loss_pred:0.058078307658433914, decouple_loss:0.04286608844995499
The modified gen p mean: 0.45066696405410767, gen p mean: -0.13882765173912048, mean p set: 0.45114725828170776The modified gen p mean: 0.45069485902786255, gen p mean: -0.14226780831813812, mean p set: 0.45117518305778503
loss_pred:0.05489606782793999, decouple_loss:0.03732410818338394
loss_pred:0.0565471388399601, decouple_loss:0.04174816608428955
Iteration: 167, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45054683089256287, gen p mean: -0.15153491497039795, mean p set: 0.45102712512016296
loss_pred:0.05520861968398094, decouple_loss:0.04046114161610603
The modified gen p mean: 0.4513097405433655, gen p mean: -0.1476377695798874, mean p set: 0.4517900347709656The modified gen p mean: 0.4508422911167145, gen p mean: -0.15116095542907715, mean p set: 0.4513225853443146
loss_pred:0.05515781044960022, decouple_loss:0.03742365166544914
loss_pred:0.055187832564115524, decouple_loss:0.038760170340538025
Iteration: 168, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45059725642204285, gen p mean: -0.14182798564434052, mean p set: 0.45107758045196533
loss_pred:0.05492473766207695, decouple_loss:0.03689100965857506
The modified gen p mean: 0.45199593901634216, gen p mean: -0.1545875072479248, mean p set: 0.45247623324394226The modified gen p mean: 0.452411949634552, gen p mean: -0.14973074197769165, mean p set: 0.4528922438621521
loss_pred:0.05591871589422226, decouple_loss:0.038224466145038605
loss_pred:0.055650580674409866, decouple_loss:0.03633251041173935
Iteration: 169, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45201101899147034, gen p mean: -0.13216063380241394, mean p set: 0.4524913430213928
loss_pred:0.05618995428085327, decouple_loss:0.043912749737501144
The modified gen p mean: 0.4520135819911957, gen p mean: -0.12907728552818298, mean p set: 0.4524938464164734The modified gen p mean: 0.4533700942993164, gen p mean: -0.14041931927204132, mean p set: 0.4538503587245941
loss_pred:0.05475466698408127, decouple_loss:0.038515206426382065
loss_pred:0.05037078261375427, decouple_loss:0.04476035758852959
Iteration: 170, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45178914070129395, gen p mean: -0.13629859685897827, mean p set: 0.45226943492889404
loss_pred:0.056224774569272995, decouple_loss:0.04082164913415909
The modified gen p mean: 0.4521675705909729, gen p mean: -0.1385909467935562, mean p set: 0.452647864818573The modified gen p mean: 0.45126327872276306, gen p mean: -0.13900913298130035, mean p set: 0.45174357295036316
loss_pred:0.05538422241806984, decouple_loss:0.0449250191450119
loss_pred:0.05196956545114517, decouple_loss:0.04506884142756462
2023-05-01 11:22:57 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.14405906200408936, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.14578743278980255, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.1434488296508789, mean p set: 0.4500633478164673
loss_pred:0.05987776815891266, decouple_loss:0.04346651956439018
loss_pred:0.05665142834186554, decouple_loss:0.04570308327674866
loss_pred:0.05800989642739296, decouple_loss:0.04392396658658981
WV_0_PC_1_EH_0_PS_40_15, loss: 0.0603979229927063, avg_mse: 0.0599311888217926
current test mse: 0.059931
Iteration: 171, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44940948486328125, gen p mean: -0.15107113122940063, mean p set: 0.44988977909088135
The modified gen p mean: 0.4529750347137451, gen p mean: -0.15154214203357697, mean p set: 0.4534553289413452
The modified gen p mean: 0.4500223398208618, gen p mean: -0.14830556511878967, mean p set: 0.4505026042461395
loss_pred:0.05464453250169754, decouple_loss:0.038237713277339935
loss_pred:0.056632231920957565, decouple_loss:0.03986137732863426
loss_pred:0.053944457322359085, decouple_loss:0.040519773960113525
Iteration: 172, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491191804409027, gen p mean: -0.15355274081230164, mean p set: 0.4495995044708252
loss_pred:0.055815890431404114, decouple_loss:0.03952500596642494
The modified gen p mean: 0.4517292380332947, gen p mean: -0.15413057804107666, mean p set: 0.4522095024585724The modified gen p mean: 0.4503833055496216, gen p mean: -0.15644092857837677, mean p set: 0.4508635997772217
loss_pred:0.05487307161092758, decouple_loss:0.03684265539050102
loss_pred:0.05439624935388565, decouple_loss:0.03845561668276787
Iteration: 173, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508916139602661, gen p mean: -0.14593300223350525, mean p set: 0.4513719379901886
loss_pred:0.054388195276260376, decouple_loss:0.03900090232491493
The modified gen p mean: 0.45025834441185, gen p mean: -0.1468321532011032, mean p set: 0.4507386088371277The modified gen p mean: 0.45040634274482727, gen p mean: -0.1462445706129074, mean p set: 0.450886607170105
loss_pred:0.05716395005583763, decouple_loss:0.0382300429046154
loss_pred:0.05461985617876053, decouple_loss:0.03946874290704727
Iteration: 174, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4518355429172516, gen p mean: -0.14337803423404694, mean p set: 0.4523157775402069
loss_pred:0.054616641253232956, decouple_loss:0.03579569235444069
The modified gen p mean: 0.4527318775653839, gen p mean: -0.1386818289756775, mean p set: 0.453212171792984The modified gen p mean: 0.4521905481815338, gen p mean: -0.13430601358413696, mean p set: 0.4526708722114563
loss_pred:0.054556965827941895, decouple_loss:0.03760247305035591
loss_pred:0.05405697599053383, decouple_loss:0.038071222603321075
Iteration: 175, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45081716775894165, gen p mean: -0.1410173624753952, mean p set: 0.45129746198654175
loss_pred:0.05514214560389519, decouple_loss:0.037938039749860764
The modified gen p mean: 0.45024070143699646, gen p mean: -0.13761208951473236, mean p set: 0.45072096586227417The modified gen p mean: 0.4520168602466583, gen p mean: -0.14355774223804474, mean p set: 0.45249712467193604
loss_pred:0.055396679788827896, decouple_loss:0.036227624863386154
loss_pred:0.05456074699759483, decouple_loss:0.03540860116481781
Iteration: 176, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4520556330680847, gen p mean: -0.15180285274982452, mean p set: 0.4525359272956848
loss_pred:0.051494300365448, decouple_loss:0.03727803751826286
The modified gen p mean: 0.4535071551799774, gen p mean: -0.15948492288589478, mean p set: 0.4539874494075775The modified gen p mean: 0.4500981867313385, gen p mean: -0.14881646633148193, mean p set: 0.4505784809589386
loss_pred:0.05152063071727753, decouple_loss:0.038043003529310226
loss_pred:0.053664643317461014, decouple_loss:0.03636351600289345
Iteration: 177, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495322108268738, gen p mean: -0.15273596346378326, mean p set: 0.4500125050544739
loss_pred:0.05351725220680237, decouple_loss:0.03636622428894043
The modified gen p mean: 0.45292168855667114, gen p mean: -0.15888789296150208, mean p set: 0.45340198278427124The modified gen p mean: 0.4516531229019165, gen p mean: -0.15211907029151917, mean p set: 0.4521334171295166
loss_pred:0.05038981884717941, decouple_loss:0.03603334352374077
loss_pred:0.05538114532828331, decouple_loss:0.035497650504112244
Iteration: 178, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45062869787216187, gen p mean: -0.15295028686523438, mean p set: 0.45110899209976196
loss_pred:0.05433594435453415, decouple_loss:0.03385040536522865
The modified gen p mean: 0.450623482465744, gen p mean: -0.1477425992488861, mean p set: 0.4511038064956665The modified gen p mean: 0.4494536519050598, gen p mean: -0.14906667172908783, mean p set: 0.4499339163303375
loss_pred:0.05268612876534462, decouple_loss:0.03974970802664757
loss_pred:0.05359933152794838, decouple_loss:0.036130696535110474
Iteration: 179, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4522361159324646, gen p mean: -0.1517448127269745, mean p set: 0.4527163803577423
loss_pred:0.05535154044628143, decouple_loss:0.03510713204741478
The modified gen p mean: 0.44965657591819763, gen p mean: -0.15029603242874146, mean p set: 0.45013684034347534The modified gen p mean: 0.4505334794521332, gen p mean: -0.14728635549545288, mean p set: 0.45101380348205566
loss_pred:0.05478696897625923, decouple_loss:0.035977475345134735
loss_pred:0.05272730812430382, decouple_loss:0.037210434675216675
Iteration: 180, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4521346390247345, gen p mean: -0.16021470725536346, mean p set: 0.452614963054657
loss_pred:0.054248884320259094, decouple_loss:0.035072650760412216
The modified gen p mean: 0.4503253102302551, gen p mean: -0.16169486939907074, mean p set: 0.4508056044578552The modified gen p mean: 0.4515621066093445, gen p mean: -0.15815387666225433, mean p set: 0.4520423710346222
loss_pred:0.05425569787621498, decouple_loss:0.0340176522731781
loss_pred:0.052631061524152756, decouple_loss:0.0350191667675972
2023-05-01 11:24:52 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.16139236092567444, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.16056235134601593, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.15901511907577515, mean p set: 0.4500633478164673
loss_pred:0.05825725942850113, decouple_loss:0.038584575057029724
loss_pred:0.05533531680703163, decouple_loss:0.040934968739748
loss_pred:0.05622396245598793, decouple_loss:0.03974323347210884
WV_0_PC_1_EH_0_PS_40_15, loss: 0.05859322473406792, avg_mse: 0.05824533849954605
current test mse: 0.058245
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012010_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012010_3_24hr.npz
NaN value num: 0
Iteration: 181, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465716779232025, gen p mean: -0.15814299881458282, mean p set: 0.4470519721508026
loss_pred:0.05731905996799469, decouple_loss:0.04121960327029228
The modified gen p mean: 0.4468585252761841, gen p mean: -0.15962570905685425, mean p set: 0.4473388195037842The modified gen p mean: 0.44715961813926697, gen p mean: -0.1599120795726776, mean p set: 0.4476398825645447
loss_pred:0.058681268244981766, decouple_loss:0.04130931198596954
loss_pred:0.05658675730228424, decouple_loss:0.0407569482922554
Iteration: 182, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472287595272064, gen p mean: -0.15674512088298798, mean p set: 0.4477090537548065
loss_pred:0.05476652458310127, decouple_loss:0.042410194873809814
The modified gen p mean: 0.44818034768104553, gen p mean: -0.16935263574123383, mean p set: 0.44866064190864563
The modified gen p mean: 0.4472768306732178, gen p mean: -0.1636618971824646, mean p set: 0.4477570950984955
loss_pred:0.05538185313344002, decouple_loss:0.039015039801597595
loss_pred:0.054039664566516876, decouple_loss:0.04031820967793465
Iteration: 183, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479084014892578, gen p mean: -0.15625502169132233, mean p set: 0.4483886957168579
loss_pred:0.05679989978671074, decouple_loss:0.04120814800262451
The modified gen p mean: 0.448211133480072, gen p mean: -0.1498737782239914, mean p set: 0.44869139790534973The modified gen p mean: 0.44722360372543335, gen p mean: -0.1485317349433899, mean p set: 0.44770386815071106
loss_pred:0.05478167161345482, decouple_loss:0.0438004732131958
loss_pred:0.05277204513549805, decouple_loss:0.04297971725463867
Iteration: 184, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484303593635559, gen p mean: -0.1395685374736786, mean p set: 0.448910653591156
loss_pred:0.053369082510471344, decouple_loss:0.03953004628419876
The modified gen p mean: 0.44760164618492126, gen p mean: -0.13956372439861298, mean p set: 0.448081910610199The modified gen p mean: 0.44812214374542236, gen p mean: -0.1415441334247589, mean p set: 0.4486024081707001
loss_pred:0.05677910894155502, decouple_loss:0.04127589985728264
loss_pred:0.05529196932911873, decouple_loss:0.039687808603048325
Iteration: 185, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44840559363365173, gen p mean: -0.14664940536022186, mean p set: 0.44888588786125183
loss_pred:0.05316517874598503, decouple_loss:0.04297522082924843
The modified gen p mean: 0.44710665941238403, gen p mean: -0.14632228016853333, mean p set: 0.44758692383766174The modified gen p mean: 0.447517991065979, gen p mean: -0.14002658426761627, mean p set: 0.4479982852935791
loss_pred:0.057114869356155396, decouple_loss:0.04052511975169182
loss_pred:0.05154840275645256, decouple_loss:0.038670726120471954
Iteration: 186, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485773742198944, gen p mean: -0.14899270236492157, mean p set: 0.4490576982498169
loss_pred:0.05363460257649422, decouple_loss:0.03844724968075752
The modified gen p mean: 0.44832539558410645, gen p mean: -0.15396560728549957, mean p set: 0.44880568981170654The modified gen p mean: 0.4477587044239044, gen p mean: -0.1511421948671341, mean p set: 0.4482389986515045
loss_pred:0.053473372012376785, decouple_loss:0.03890801966190338
loss_pred:0.05407896265387535, decouple_loss:0.03867325931787491
Iteration: 187, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469423294067383, gen p mean: -0.15234963595867157, mean p set: 0.447422593832016
loss_pred:0.054012544453144073, decouple_loss:0.0382576622068882
The modified gen p mean: 0.44752150774002075, gen p mean: -0.15519557893276215, mean p set: 0.44800183176994324
The modified gen p mean: 0.4472237229347229, gen p mean: -0.15646308660507202, mean p set: 0.4477039873600006
loss_pred:0.05154174193739891, decouple_loss:0.0388030931353569
loss_pred:0.054579779505729675, decouple_loss:0.04073203355073929
Iteration: 188, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480511248111725, gen p mean: -0.1534806340932846, mean p set: 0.44853144884109497
loss_pred:0.05466918274760246, decouple_loss:0.03888843581080437
The modified gen p mean: 0.446898490190506, gen p mean: -0.15391702950000763, mean p set: 0.4473787844181061The modified gen p mean: 0.4467315375804901, gen p mean: -0.14681962132453918, mean p set: 0.4472118318080902
loss_pred:0.054519716650247574, decouple_loss:0.036914292722940445
loss_pred:0.05494292452931404, decouple_loss:0.03786533698439598
Iteration: 189, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44746914505958557, gen p mean: -0.14606139063835144, mean p set: 0.44794946908950806
loss_pred:0.05300273001194, decouple_loss:0.03940538689494133
The modified gen p mean: 0.44917988777160645, gen p mean: -0.1431323140859604, mean p set: 0.44966015219688416The modified gen p mean: 0.4488455653190613, gen p mean: -0.14362287521362305, mean p set: 0.449325829744339
loss_pred:0.0525406152009964, decouple_loss:0.04043047875165939
loss_pred:0.05393434688448906, decouple_loss:0.03906109929084778
Iteration: 190, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473575949668884, gen p mean: -0.1413975954055786, mean p set: 0.4478378891944885
loss_pred:0.05310698226094246, decouple_loss:0.04084618017077446
The modified gen p mean: 0.4480859935283661, gen p mean: -0.1418338418006897, mean p set: 0.4485662877559662The modified gen p mean: 0.4482623338699341, gen p mean: -0.14679422974586487, mean p set: 0.4487426280975342
loss_pred:0.053138554096221924, decouple_loss:0.04031405225396156
loss_pred:0.05513974279165268, decouple_loss:0.040792349725961685
2023-05-01 11:27:23 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.152071014046669, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.15160509943962097, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.149857297539711, mean p set: 0.4500633478164673
loss_pred:0.05506516993045807, decouple_loss:0.03855696693062782
loss_pred:0.052513740956783295, decouple_loss:0.03733791410923004
loss_pred:0.053567394614219666, decouple_loss:0.037419818341732025
WV_0_PC_1_EH_0_PS_40_15, loss: 0.055604010820388794, avg_mse: 0.055309493094682693
current test mse: 0.055309
Iteration: 191, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476369321346283, gen p mean: -0.15018707513809204, mean p set: 0.4481172263622284
The modified gen p mean: 0.447172075510025, gen p mean: -0.15139468014240265, mean p set: 0.4476523995399475
The modified gen p mean: 0.447181761264801, gen p mean: -0.14876194298267365, mean p set: 0.4476620554924011
loss_pred:0.05444864556193352, decouple_loss:0.03671031817793846
loss_pred:0.0547451451420784, decouple_loss:0.03970049321651459
loss_pred:0.05616817623376846, decouple_loss:0.041456110775470734
Iteration: 192, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469960927963257, gen p mean: -0.1514061987400055, mean p set: 0.4474763870239258
loss_pred:0.053915835916996, decouple_loss:0.036179907619953156
The modified gen p mean: 0.4468986690044403, gen p mean: -0.15658368170261383, mean p set: 0.44737890362739563The modified gen p mean: 0.4472044110298157, gen p mean: -0.1579873114824295, mean p set: 0.44768473505973816
loss_pred:0.054048310965299606, decouple_loss:0.03811601176857948
loss_pred:0.05287380516529083, decouple_loss:0.03821158781647682
Iteration: 193, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44849151372909546, gen p mean: -0.1562533974647522, mean p set: 0.44897186756134033
loss_pred:0.056727826595306396, decouple_loss:0.036025628447532654
The modified gen p mean: 0.4464516043663025, gen p mean: -0.1548774540424347, mean p set: 0.4469318985939026The modified gen p mean: 0.44735005497932434, gen p mean: -0.15526717901229858, mean p set: 0.44783034920692444
loss_pred:0.053264472633600235, decouple_loss:0.03620411083102226
loss_pred:0.056524429470300674, decouple_loss:0.037960682064294815
Iteration: 194, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44893425703048706, gen p mean: -0.1439591944217682, mean p set: 0.44941452145576477
loss_pred:0.05383383855223656, decouple_loss:0.036287982016801834
The modified gen p mean: 0.4481261670589447, gen p mean: -0.14366160333156586, mean p set: 0.4486064314842224The modified gen p mean: 0.44812920689582825, gen p mean: -0.14081484079360962, mean p set: 0.44860947132110596
loss_pred:0.05057990178465843, decouple_loss:0.037198733538389206
loss_pred:0.052616704255342484, decouple_loss:0.039046015590429306
Iteration: 195, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44782304763793945, gen p mean: -0.14058303833007812, mean p set: 0.44830334186553955
loss_pred:0.05397595837712288, decouple_loss:0.03974735736846924
The modified gen p mean: 0.44741079211235046, gen p mean: -0.14659345149993896, mean p set: 0.44789108633995056The modified gen p mean: 0.4479629397392273, gen p mean: -0.14533235132694244, mean p set: 0.448443204164505
loss_pred:0.051167842000722885, decouple_loss:0.03477104380726814
loss_pred:0.05627550184726715, decouple_loss:0.03444170951843262
Iteration: 196, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447221040725708, gen p mean: -0.14971867203712463, mean p set: 0.4477013349533081
loss_pred:0.05249231308698654, decouple_loss:0.0367724746465683
The modified gen p mean: 0.4477115571498871, gen p mean: -0.14618030190467834, mean p set: 0.4481918513774872The modified gen p mean: 0.4480065703392029, gen p mean: -0.14674007892608643, mean p set: 0.448486864566803
loss_pred:0.0532924123108387, decouple_loss:0.03704015165567398
loss_pred:0.051424626260995865, decouple_loss:0.03669289872050285
Iteration: 197, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477773904800415, gen p mean: -0.15053771436214447, mean p set: 0.4482576549053192
loss_pred:0.05294844135642052, decouple_loss:0.03419828787446022
The modified gen p mean: 0.446647047996521, gen p mean: -0.1530177742242813, mean p set: 0.4471273422241211The modified gen p mean: 0.4466698467731476, gen p mean: -0.14784841239452362, mean p set: 0.4471501410007477
loss_pred:0.05446619912981987, decouple_loss:0.038482025265693665
loss_pred:0.05261675640940666, decouple_loss:0.03751964494585991
Iteration: 198, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44711413979530334, gen p mean: -0.14888858795166016, mean p set: 0.44759440422058105
loss_pred:0.0519191175699234, decouple_loss:0.03545064106583595
The modified gen p mean: 0.4480394124984741, gen p mean: -0.15318183600902557, mean p set: 0.4485197067260742The modified gen p mean: 0.44848939776420593, gen p mean: -0.15248185396194458, mean p set: 0.44896969199180603
loss_pred:0.04980945959687233, decouple_loss:0.03487865999341011
loss_pred:0.05343078449368477, decouple_loss:0.03711344301700592
Iteration: 199, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486684203147888, gen p mean: -0.14312264323234558, mean p set: 0.4491487443447113
loss_pred:0.05300235375761986, decouple_loss:0.03608395531773567
The modified gen p mean: 0.447144091129303, gen p mean: -0.14612668752670288, mean p set: 0.44762441515922546The modified gen p mean: 0.4478238523006439, gen p mean: -0.14451228082180023, mean p set: 0.448304146528244
loss_pred:0.052481573075056076, decouple_loss:0.03523297980427742
loss_pred:0.05301586911082268, decouple_loss:0.03417591378092766
Iteration: 200, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44782400131225586, gen p mean: -0.1393032670021057, mean p set: 0.44830429553985596
loss_pred:0.05068988353013992, decouple_loss:0.032890137284994125
The modified gen p mean: 0.44752365350723267, gen p mean: -0.14483582973480225, mean p set: 0.44800394773483276The modified gen p mean: 0.4487683176994324, gen p mean: -0.14382515847682953, mean p set: 0.44924864172935486
loss_pred:0.05276043340563774, decouple_loss:0.035483218729496
loss_pred:0.05311271548271179, decouple_loss:0.036020684987306595
2023-05-01 11:29:18 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.1495928317308426, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.14824625849723816, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.1455855816602707, mean p set: 0.4500633478164673
loss_pred:0.0539967343211174, decouple_loss:0.03566288203001022
loss_pred:0.0514199398458004, decouple_loss:0.034948188811540604
loss_pred:0.052603885531425476, decouple_loss:0.03499596565961838
WV_0_PC_1_EH_0_PS_40_15, loss: 0.05443364009261131, avg_mse: 0.05451347306370735
current test mse: 0.054513
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012001_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012001_3_24hr.npz
NaN value num: 0
Iteration: 201, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44973331689834595, gen p mean: -0.15330052375793457, mean p set: 0.45021358132362366
loss_pred:0.05254996940493584, decouple_loss:0.04177791252732277
The modified gen p mean: 0.4509035348892212, gen p mean: -0.15169447660446167, mean p set: 0.4513837993144989The modified gen p mean: 0.44751405715942383, gen p mean: -0.15389612317085266, mean p set: 0.44799432158470154
loss_pred:0.054994434118270874, decouple_loss:0.03884625807404518loss_pred:0.05272046476602554, decouple_loss:0.040396273136138916
Iteration: 202, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44922035932540894, gen p mean: -0.15738430619239807, mean p set: 0.4497006833553314
loss_pred:0.0544339157640934, decouple_loss:0.040122296661138535
The modified gen p mean: 0.45021122694015503, gen p mean: -0.15741485357284546, mean p set: 0.45069149136543274The modified gen p mean: 0.4500119984149933, gen p mean: -0.1652979552745819, mean p set: 0.45049232244491577
loss_pred:0.055356014519929886, decouple_loss:0.040631525218486786
loss_pred:0.05176393315196037, decouple_loss:0.04234020784497261
Iteration: 203, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502367079257965, gen p mean: -0.16020822525024414, mean p set: 0.4507170021533966
loss_pred:0.054398179054260254, decouple_loss:0.038694411516189575
The modified gen p mean: 0.4475921094417572, gen p mean: -0.16614678502082825, mean p set: 0.4480723738670349The modified gen p mean: 0.44863617420196533, gen p mean: -0.16141942143440247, mean p set: 0.44911646842956543
loss_pred:0.05341260880231857, decouple_loss:0.040193185210227966
loss_pred:0.053126171231269836, decouple_loss:0.03547588363289833
Iteration: 204, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505389928817749, gen p mean: -0.16097863018512726, mean p set: 0.451019287109375
loss_pred:0.05157887563109398, decouple_loss:0.037809133529663086
The modified gen p mean: 0.4502882957458496, gen p mean: -0.16689689457416534, mean p set: 0.4507685601711273The modified gen p mean: 0.4495708644390106, gen p mean: -0.16424109041690826, mean p set: 0.4500511884689331
loss_pred:0.05357265844941139, decouple_loss:0.04239374399185181
loss_pred:0.05094646289944649, decouple_loss:0.041715629398822784
Iteration: 205, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449690580368042, gen p mean: -0.1593950092792511, mean p set: 0.4501708745956421
loss_pred:0.05235427990555763, decouple_loss:0.03822886571288109
The modified gen p mean: 0.44969460368156433, gen p mean: -0.1600765883922577, mean p set: 0.45017489790916443The modified gen p mean: 0.4479660987854004, gen p mean: -0.15907417237758636, mean p set: 0.4484463632106781
loss_pred:0.05266355723142624, decouple_loss:0.03749041631817818
loss_pred:0.051841236650943756, decouple_loss:0.037192653864622116
Iteration: 206, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480643570423126, gen p mean: -0.1701703667640686, mean p set: 0.4485446512699127
loss_pred:0.052024055272340775, decouple_loss:0.03637247905135155
The modified gen p mean: 0.44992679357528687, gen p mean: -0.1705436110496521, mean p set: 0.4504070580005646The modified gen p mean: 0.4479018747806549, gen p mean: -0.16862791776657104, mean p set: 0.448382169008255
loss_pred:0.052787911146879196, decouple_loss:0.03681733459234238
loss_pred:0.052604250609874725, decouple_loss:0.03723312169313431
Iteration: 207, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45032647252082825, gen p mean: -0.17870448529720306, mean p set: 0.45080679655075073
loss_pred:0.05234124884009361, decouple_loss:0.03845604881644249
The modified gen p mean: 0.4505366086959839, gen p mean: -0.17864932119846344, mean p set: 0.45101693272590637The modified gen p mean: 0.4502337872982025, gen p mean: -0.17677058279514313, mean p set: 0.450714111328125
loss_pred:0.05103631690144539, decouple_loss:0.03719502314925194
loss_pred:0.050472456961870193, decouple_loss:0.03696194663643837
Iteration: 208, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4512284994125366, gen p mean: -0.17776775360107422, mean p set: 0.4517087936401367
loss_pred:0.05492465943098068, decouple_loss:0.03906388580799103
The modified gen p mean: 0.4474199712276459, gen p mean: -0.17369277775287628, mean p set: 0.44790026545524597The modified gen p mean: 0.45034468173980713, gen p mean: -0.17468106746673584, mean p set: 0.4508250057697296
loss_pred:0.05221592262387276, decouple_loss:0.04144199565052986
loss_pred:0.05290025472640991, decouple_loss:0.038013994693756104
Iteration: 209, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497394263744354, gen p mean: -0.1739976555109024, mean p set: 0.4502197206020355
loss_pred:0.05441516265273094, decouple_loss:0.03891753405332565
The modified gen p mean: 0.4483681917190552, gen p mean: -0.17560018599033356, mean p set: 0.44884851574897766The modified gen p mean: 0.45052462816238403, gen p mean: -0.17411021888256073, mean p set: 0.45100489258766174
loss_pred:0.05152715742588043, decouple_loss:0.03885669261217117
loss_pred:0.0530228316783905, decouple_loss:0.037869181483983994
Iteration: 210, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45018360018730164, gen p mean: -0.17435815930366516, mean p set: 0.45066389441490173
loss_pred:0.052415698766708374, decouple_loss:0.03689946234226227
The modified gen p mean: 0.44768667221069336, gen p mean: -0.16998501121997833, mean p set: 0.44816699624061584The modified gen p mean: 0.4500649571418762, gen p mean: -0.16953472793102264, mean p set: 0.45054522156715393
loss_pred:0.052372947335243225, decouple_loss:0.0356716513633728
loss_pred:0.05403315648436546, decouple_loss:0.037755969911813736
2023-05-01 11:31:50 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.1723293960094452, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.17135345935821533, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.17003591358661652, mean p set: 0.4500633478164673
loss_pred:0.05595475435256958, decouple_loss:0.041486963629722595
loss_pred:0.05287514254450798, decouple_loss:0.041502945125103
loss_pred:0.05376105010509491, decouple_loss:0.04037121310830116
WV_0_PC_1_EH_0_PS_40_15, loss: 0.05625300109386444, avg_mse: 0.05638548359274864
current test mse: 0.056385
Iteration: 211, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503384828567505, gen p mean: -0.17328545451164246, mean p set: 0.450818806886673
The modified gen p mean: 0.45038384199142456, gen p mean: -0.17950065433979034, mean p set: 0.45086413621902466
The modified gen p mean: 0.44732335209846497, gen p mean: -0.17892248928546906, mean p set: 0.44780364632606506
loss_pred:0.05450066924095154, decouple_loss:0.03610307723283768
loss_pred:0.05317814648151398, decouple_loss:0.038042496889829636loss_pred:0.050263676792383194, decouple_loss:0.035339489579200745
Iteration: 212, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447935551404953, gen p mean: -0.18132150173187256, mean p set: 0.4484158456325531
loss_pred:0.05053034424781799, decouple_loss:0.03511597588658333
The modified gen p mean: 0.4492908716201782, gen p mean: -0.17853650450706482, mean p set: 0.4497711658477783The modified gen p mean: 0.44823694229125977, gen p mean: -0.1793774515390396, mean p set: 0.44871723651885986
loss_pred:0.05214817076921463, decouple_loss:0.035529185086488724
loss_pred:0.05401407927274704, decouple_loss:0.03426426276564598
Iteration: 213, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478349983692169, gen p mean: -0.17761586606502533, mean p set: 0.44831526279449463
loss_pred:0.05304931104183197, decouple_loss:0.03313055261969566
The modified gen p mean: 0.45021921396255493, gen p mean: -0.1872701644897461, mean p set: 0.45069950819015503The modified gen p mean: 0.4501817226409912, gen p mean: -0.1822350025177002, mean p set: 0.4506619870662689
loss_pred:0.050811950117349625, decouple_loss:0.044110819697380066
loss_pred:0.04999740794301033, decouple_loss:0.03649290278553963
Iteration: 214, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449747234582901, gen p mean: -0.1947518140077591, mean p set: 0.4502274990081787
loss_pred:0.04906664043664932, decouple_loss:0.03674657642841339
The modified gen p mean: 0.44756880402565, gen p mean: -0.18504111468791962, mean p set: 0.4480490982532501The modified gen p mean: 0.44733551144599915, gen p mean: -0.18848763406276703, mean p set: 0.44781580567359924
loss_pred:0.05109122022986412, decouple_loss:0.034997548907995224
loss_pred:0.05239008739590645, decouple_loss:0.034489620476961136
Iteration: 215, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44820454716682434, gen p mean: -0.18906421959400177, mean p set: 0.44868484139442444
loss_pred:0.05031471699476242, decouple_loss:0.0358462929725647
The modified gen p mean: 0.44882693886756897, gen p mean: -0.1878584325313568, mean p set: 0.44930723309516907The modified gen p mean: 0.4488028287887573, gen p mean: -0.188970148563385, mean p set: 0.4492831230163574
loss_pred:0.05173254758119583, decouple_loss:0.0354718379676342
loss_pred:0.05125272274017334, decouple_loss:0.03544585034251213
Iteration: 216, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475097954273224, gen p mean: -0.18182188272476196, mean p set: 0.4479900598526001
loss_pred:0.052499085664749146, decouple_loss:0.033064715564250946
The modified gen p mean: 0.4476509690284729, gen p mean: -0.18615438044071198, mean p set: 0.4481312930583954The modified gen p mean: 0.44767817854881287, gen p mean: -0.18105573952198029, mean p set: 0.44815847277641296
loss_pred:0.05238102376461029, decouple_loss:0.03223809227347374
loss_pred:0.050466276705265045, decouple_loss:0.03116551600396633
Iteration: 217, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482101500034332, gen p mean: -0.17457900941371918, mean p set: 0.4486904740333557
loss_pred:0.04964428395032883, decouple_loss:0.03176521509885788
The modified gen p mean: 0.44960716366767883, gen p mean: -0.16710306704044342, mean p set: 0.45008742809295654The modified gen p mean: 0.44751742482185364, gen p mean: -0.17681719362735748, mean p set: 0.44799768924713135
loss_pred:0.05098689720034599, decouple_loss:0.03390832617878914
loss_pred:0.0508563406765461, decouple_loss:0.030931565910577774
Iteration: 218, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44963374733924866, gen p mean: -0.17292684316635132, mean p set: 0.45011407136917114
loss_pred:0.05393508821725845, decouple_loss:0.03477831557393074
The modified gen p mean: 0.449078768491745, gen p mean: -0.17193801701068878, mean p set: 0.4495590925216675The modified gen p mean: 0.4493815004825592, gen p mean: -0.17201128602027893, mean p set: 0.4498618245124817
loss_pred:0.050874967128038406, decouple_loss:0.034278158098459244
loss_pred:0.05027103051543236, decouple_loss:0.03486860543489456
Iteration: 219, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491611123085022, gen p mean: -0.1789756715297699, mean p set: 0.4496413767337799
loss_pred:0.05053655430674553, decouple_loss:0.03377422317862511
The modified gen p mean: 0.4510071277618408, gen p mean: -0.17728689312934875, mean p set: 0.45148739218711853The modified gen p mean: 0.4477916359901428, gen p mean: -0.17976754903793335, mean p set: 0.44827190041542053
loss_pred:0.05271955206990242, decouple_loss:0.03667781129479408
loss_pred:0.04959701746702194, decouple_loss:0.03285478800535202
Iteration: 220, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480859339237213, gen p mean: -0.19430766999721527, mean p set: 0.4485662281513214
loss_pred:0.05102008953690529, decouple_loss:0.03427254408597946
The modified gen p mean: 0.4501236379146576, gen p mean: -0.19171693921089172, mean p set: 0.4506039321422577The modified gen p mean: 0.4480181932449341, gen p mean: -0.18913424015045166, mean p set: 0.4484984576702118
loss_pred:0.050036150962114334, decouple_loss:0.03312751278281212
loss_pred:0.05076316371560097, decouple_loss:0.0399673692882061
2023-05-01 11:33:45 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.1939898431301117, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.1912519931793213, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.1918162703514099, mean p set: 0.4500633478164673
loss_pred:0.055196963250637054, decouple_loss:0.03817259892821312
loss_pred:0.052334703505039215, decouple_loss:0.03916707634925842
loss_pred:0.05324167385697365, decouple_loss:0.03817695006728172
WV_0_PC_1_EH_0_PS_40_15, loss: 0.05551639199256897, avg_mse: 0.056122709065675735
current test mse: 0.056123
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012012_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012012_3_24hr.npz
NaN value num: 0
Iteration: 221, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474271237850189, gen p mean: -0.18963085114955902, mean p set: 0.44790738821029663
loss_pred:0.05249346047639847, decouple_loss:0.039162278175354004
The modified gen p mean: 0.44712069630622864, gen p mean: -0.19065696001052856, mean p set: 0.4476010203361511The modified gen p mean: 0.4474489986896515, gen p mean: -0.18983349204063416, mean p set: 0.4479292929172516
loss_pred:0.0535455197095871, decouple_loss:0.03803441673517227loss_pred:0.055113889276981354, decouple_loss:0.0439988374710083
Iteration: 222, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473279118537903, gen p mean: -0.18289658427238464, mean p set: 0.44780823588371277
loss_pred:0.051930006593465805, decouple_loss:0.039161570370197296
The modified gen p mean: 0.4474361836910248, gen p mean: -0.18579691648483276, mean p set: 0.44791650772094727The modified gen p mean: 0.44717904925346375, gen p mean: -0.18069283664226532, mean p set: 0.44765937328338623
loss_pred:0.05275813862681389, decouple_loss:0.0449606291949749
loss_pred:0.05203846096992493, decouple_loss:0.041059039533138275
Iteration: 223, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476078748703003, gen p mean: -0.16812241077423096, mean p set: 0.4480881989002228
loss_pred:0.051068954169750214, decouple_loss:0.04160543158650398
The modified gen p mean: 0.4471440017223358, gen p mean: -0.17000332474708557, mean p set: 0.4476243257522583The modified gen p mean: 0.4448032081127167, gen p mean: -0.17016007006168365, mean p set: 0.4452835023403168
loss_pred:0.05481516569852829, decouple_loss:0.04380319267511368
loss_pred:0.052984919399023056, decouple_loss:0.045215148478746414
Iteration: 224, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484882354736328, gen p mean: -0.15990430116653442, mean p set: 0.4489684998989105
loss_pred:0.050557877868413925, decouple_loss:0.040691256523132324
The modified gen p mean: 0.44805577397346497, gen p mean: -0.16573366522789001, mean p set: 0.44853606820106506The modified gen p mean: 0.44724637269973755, gen p mean: -0.15977558493614197, mean p set: 0.44772669672966003
loss_pred:0.05087908357381821, decouple_loss:0.04184480383992195
loss_pred:0.05066528543829918, decouple_loss:0.03909355774521828
Iteration: 225, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44799524545669556, gen p mean: -0.17047052085399628, mean p set: 0.44847550988197327
loss_pred:0.052187565714120865, decouple_loss:0.0370219387114048
The modified gen p mean: 0.4474976360797882, gen p mean: -0.16289782524108887, mean p set: 0.4479779005050659The modified gen p mean: 0.44696685671806335, gen p mean: -0.1626877784729004, mean p set: 0.44744715094566345
loss_pred:0.054308418184518814, decouple_loss:0.04167978838086128
loss_pred:0.053590815514326096, decouple_loss:0.03994416818022728
Iteration: 226, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484855830669403, gen p mean: -0.1713097244501114, mean p set: 0.4489658772945404
loss_pred:0.0534033477306366, decouple_loss:0.039930351078510284
The modified gen p mean: 0.44688481092453003, gen p mean: -0.1786085069179535, mean p set: 0.4473651349544525The modified gen p mean: 0.4478841722011566, gen p mean: -0.17995786666870117, mean p set: 0.4483644366264343
loss_pred:0.0506153330206871, decouple_loss:0.03873266652226448
loss_pred:0.05052204430103302, decouple_loss:0.04134933277964592
Iteration: 227, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44697442650794983, gen p mean: -0.17846809327602386, mean p set: 0.4474547207355499
loss_pred:0.05168389156460762, decouple_loss:0.04117634519934654
The modified gen p mean: 0.4475243091583252, gen p mean: -0.18266764283180237, mean p set: 0.4480046033859253The modified gen p mean: 0.4467393755912781, gen p mean: -0.18082155287265778, mean p set: 0.4472196698188782
loss_pred:0.049745894968509674, decouple_loss:0.03938636928796768
loss_pred:0.05103297531604767, decouple_loss:0.040392953902482986
Iteration: 228, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473952651023865, gen p mean: -0.17808684706687927, mean p set: 0.4478755593299866
loss_pred:0.04926900938153267, decouple_loss:0.04019885137677193
The modified gen p mean: 0.44812196493148804, gen p mean: -0.17196156084537506, mean p set: 0.44860225915908813
The modified gen p mean: 0.44811028242111206, gen p mean: -0.1814868301153183, mean p set: 0.44859054684638977
loss_pred:0.05246385186910629, decouple_loss:0.038457904011011124
loss_pred:0.05031811445951462, decouple_loss:0.039875373244285583
Iteration: 229, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44554170966148376, gen p mean: -0.17035868763923645, mean p set: 0.44602203369140625
loss_pred:0.05221213400363922, decouple_loss:0.04203808307647705
The modified gen p mean: 0.4466222822666168, gen p mean: -0.17118513584136963, mean p set: 0.44710254669189453The modified gen p mean: 0.44729796051979065, gen p mean: -0.1651931256055832, mean p set: 0.44777825474739075
loss_pred:0.05432584509253502, decouple_loss:0.03950623422861099
loss_pred:0.053003229200839996, decouple_loss:0.04207964986562729
Iteration: 230, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44835320115089417, gen p mean: -0.16506139934062958, mean p set: 0.44883349537849426
loss_pred:0.05112447962164879, decouple_loss:0.03935577720403671
The modified gen p mean: 0.44837939739227295, gen p mean: -0.16548611223697662, mean p set: 0.44885969161987305The modified gen p mean: 0.448246568441391, gen p mean: -0.16616703569889069, mean p set: 0.4487268626689911
loss_pred:0.05084751546382904, decouple_loss:0.03751574456691742
loss_pred:0.04873030260205269, decouple_loss:0.038533229380846024
2023-05-01 11:36:16 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.16493189334869385, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.16357353329658508, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.1625104546546936, mean p set: 0.4500633478164673
loss_pred:0.052541494369506836, decouple_loss:0.03969753533601761
loss_pred:0.050004538148641586, decouple_loss:0.040159765630960464
loss_pred:0.05117493122816086, decouple_loss:0.03786313533782959
WV_0_PC_1_EH_0_PS_40_15, loss: 0.05320232734084129, avg_mse: 0.05351186916232109
current test mse: 0.053512
Iteration: 231, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44665148854255676, gen p mean: -0.16394126415252686, mean p set: 0.4471317529678345
The modified gen p mean: 0.4468125104904175, gen p mean: -0.16266438364982605, mean p set: 0.4472928047180176
The modified gen p mean: 0.4477062523365021, gen p mean: -0.1600675731897354, mean p set: 0.4481865465641022
loss_pred:0.049039170145988464, decouple_loss:0.0379527322947979
loss_pred:0.05162768065929413, decouple_loss:0.03792987018823624
loss_pred:0.05220374837517738, decouple_loss:0.03870897740125656
Iteration: 232, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44496357440948486, gen p mean: -0.1680615395307541, mean p set: 0.4454438388347626
loss_pred:0.05101267993450165, decouple_loss:0.037737276405096054
The modified gen p mean: 0.44686359167099, gen p mean: -0.16989612579345703, mean p set: 0.4473438560962677The modified gen p mean: 0.4471152722835541, gen p mean: -0.16820475459098816, mean p set: 0.4475955367088318
loss_pred:0.053644049912691116, decouple_loss:0.036809537559747696
loss_pred:0.0486653633415699, decouple_loss:0.036405183374881744
Iteration: 233, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44798991084098816, gen p mean: -0.17484015226364136, mean p set: 0.44847017526626587
loss_pred:0.05005273595452309, decouple_loss:0.03686603158712387
The modified gen p mean: 0.4467247426509857, gen p mean: -0.17022353410720825, mean p set: 0.4472050368785858The modified gen p mean: 0.4480471611022949, gen p mean: -0.16911490261554718, mean p set: 0.44852742552757263
loss_pred:0.05183742195367813, decouple_loss:0.03695075586438179
loss_pred:0.05239437147974968, decouple_loss:0.03736184537410736
Iteration: 234, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44743895530700684, gen p mean: -0.16911037266254425, mean p set: 0.44791924953460693
loss_pred:0.050005462020635605, decouple_loss:0.036121536046266556
The modified gen p mean: 0.4476768970489502, gen p mean: -0.16923891007900238, mean p set: 0.4481572210788727The modified gen p mean: 0.44686490297317505, gen p mean: -0.17092789709568024, mean p set: 0.44734519720077515
loss_pred:0.05197923630475998, decouple_loss:0.03667087480425835
loss_pred:0.05168568342924118, decouple_loss:0.03504111245274544
Iteration: 235, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44446447491645813, gen p mean: -0.16100390255451202, mean p set: 0.4449447691440582
loss_pred:0.051868803799152374, decouple_loss:0.03757154941558838
The modified gen p mean: 0.4472615420818329, gen p mean: -0.16106016933918, mean p set: 0.447741836309433The modified gen p mean: 0.44450643658638, gen p mean: -0.16003376245498657, mean p set: 0.4449867010116577
loss_pred:0.051041264086961746, decouple_loss:0.03528478369116783
loss_pred:0.05256257206201553, decouple_loss:0.038166120648384094
Iteration: 236, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44602862000465393, gen p mean: -0.16014167666435242, mean p set: 0.44650891423225403
loss_pred:0.050644248723983765, decouple_loss:0.03729225695133209
The modified gen p mean: 0.4465027153491974, gen p mean: -0.15451368689537048, mean p set: 0.4469830095767975The modified gen p mean: 0.4468170702457428, gen p mean: -0.16155554354190826, mean p set: 0.4472973346710205
loss_pred:0.0505409799516201, decouple_loss:0.03702208772301674
loss_pred:0.04976649582386017, decouple_loss:0.03472978249192238
Iteration: 237, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44801080226898193, gen p mean: -0.168382927775383, mean p set: 0.44849109649658203
loss_pred:0.04899875447154045, decouple_loss:0.038458649069070816
The modified gen p mean: 0.4483972191810608, gen p mean: -0.1698068231344223, mean p set: 0.4488775134086609The modified gen p mean: 0.44690120220184326, gen p mean: -0.1638810932636261, mean p set: 0.44738152623176575
loss_pred:0.05037778988480568, decouple_loss:0.034329067915678024
loss_pred:0.04972575604915619, decouple_loss:0.034151848405599594
Iteration: 238, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472980797290802, gen p mean: -0.18195271492004395, mean p set: 0.4477783739566803
loss_pred:0.0529838502407074, decouple_loss:0.034878239035606384
The modified gen p mean: 0.4461824595928192, gen p mean: -0.17860567569732666, mean p set: 0.4466627538204193The modified gen p mean: 0.44822707772254944, gen p mean: -0.1772196739912033, mean p set: 0.44870737195014954
loss_pred:0.05213103070855141, decouple_loss:0.03583298251032829
loss_pred:0.04848380386829376, decouple_loss:0.03454529494047165
Iteration: 239, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472108781337738, gen p mean: -0.17883093655109406, mean p set: 0.4476911425590515
loss_pred:0.048687372356653214, decouple_loss:0.03337094560265541
The modified gen p mean: 0.4469181001186371, gen p mean: -0.18519094586372375, mean p set: 0.4473983943462372The modified gen p mean: 0.4471989572048187, gen p mean: -0.18510505557060242, mean p set: 0.4476792514324188
loss_pred:0.047737061977386475, decouple_loss:0.03382835537195206
loss_pred:0.052268415689468384, decouple_loss:0.03311630338430405
Iteration: 240, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44820907711982727, gen p mean: -0.17484477162361145, mean p set: 0.448689341545105
loss_pred:0.048345886170864105, decouple_loss:0.03478057309985161
The modified gen p mean: 0.447712779045105, gen p mean: -0.17560313642024994, mean p set: 0.4481930732727051The modified gen p mean: 0.44757914543151855, gen p mean: -0.18067669868469238, mean p set: 0.44805940985679626
loss_pred:0.05060018599033356, decouple_loss:0.034183766692876816
loss_pred:0.04795727878808975, decouple_loss:0.03196905553340912
2023-05-01 11:38:10 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.17014610767364502, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.16942209005355835, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.1686324179172516, mean p set: 0.4500633478164673
loss_pred:0.05194108188152313, decouple_loss:0.036570969969034195
loss_pred:0.04941699653863907, decouple_loss:0.03765736147761345
loss_pred:0.05045166239142418, decouple_loss:0.03538180887699127
WV_0_PC_1_EH_0_PS_40_15, loss: 0.052430085837841034, avg_mse: 0.05313378944993019
current test mse: 0.053134
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012019_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012019_3_24hr.npz
NaN value num: 0
Iteration: 241, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45166417956352234, gen p mean: -0.16304345428943634, mean p set: 0.45214447379112244
loss_pred:0.054469700902700424, decouple_loss:0.04293501004576683
The modified gen p mean: 0.45184892416000366, gen p mean: -0.1670425683259964, mean p set: 0.45232921838760376The modified gen p mean: 0.45110735297203064, gen p mean: -0.16649633646011353, mean p set: 0.45158764719963074
loss_pred:0.05264630168676376, decouple_loss:0.04531761631369591
loss_pred:0.05322287604212761, decouple_loss:0.04403027892112732
Iteration: 242, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4519190490245819, gen p mean: -0.16590596735477448, mean p set: 0.452399343252182
loss_pred:0.05110689997673035, decouple_loss:0.04403375834226608
The modified gen p mean: 0.4519207775592804, gen p mean: -0.16872048377990723, mean p set: 0.4524010717868805The modified gen p mean: 0.45303651690483093, gen p mean: -0.1654425859451294, mean p set: 0.45351678133010864
loss_pred:0.05039792135357857, decouple_loss:0.04750588536262512
loss_pred:0.05296477675437927, decouple_loss:0.041303496807813644
Iteration: 243, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4536791443824768, gen p mean: -0.18315063416957855, mean p set: 0.4541594386100769
loss_pred:0.05163209140300751, decouple_loss:0.04400504752993584
The modified gen p mean: 0.4531635046005249, gen p mean: -0.187984436750412, mean p set: 0.4536438286304474The modified gen p mean: 0.45267507433891296, gen p mean: -0.18652771413326263, mean p set: 0.4531553387641907
loss_pred:0.0513433963060379, decouple_loss:0.04546744003891945
loss_pred:0.05046660080552101, decouple_loss:0.04093363136053085
Iteration: 244, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4525024890899658, gen p mean: -0.19611972570419312, mean p set: 0.45298275351524353
loss_pred:0.05268692597746849, decouple_loss:0.042363885790109634
The modified gen p mean: 0.4538276791572571, gen p mean: -0.2007320672273636, mean p set: 0.4543079137802124The modified gen p mean: 0.45178577303886414, gen p mean: -0.19343720376491547, mean p set: 0.4522660970687866
loss_pred:0.05195598304271698, decouple_loss:0.03925285488367081
loss_pred:0.052534058690071106, decouple_loss:0.04161682724952698
Iteration: 245, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4519352316856384, gen p mean: -0.21400094032287598, mean p set: 0.4524155259132385
loss_pred:0.049880389124155045, decouple_loss:0.04025750979781151
The modified gen p mean: 0.45173004269599915, gen p mean: -0.21366098523139954, mean p set: 0.45221033692359924The modified gen p mean: 0.4539492726325989, gen p mean: -0.21787108480930328, mean p set: 0.454429566860199
loss_pred:0.0484883189201355, decouple_loss:0.03969396650791168
loss_pred:0.0499088391661644, decouple_loss:0.043314799666404724
Iteration: 246, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4527120292186737, gen p mean: -0.1963331252336502, mean p set: 0.4531923532485962
loss_pred:0.05020061135292053, decouple_loss:0.040762003511190414
The modified gen p mean: 0.45336228609085083, gen p mean: -0.19979113340377808, mean p set: 0.4538425803184509The modified gen p mean: 0.45458200573921204, gen p mean: -0.19846336543560028, mean p set: 0.45506227016448975
loss_pred:0.0512692928314209, decouple_loss:0.040556564927101135
loss_pred:0.05132247507572174, decouple_loss:0.04077081009745598
Iteration: 247, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45232123136520386, gen p mean: -0.1750962883234024, mean p set: 0.45280152559280396
loss_pred:0.051463983952999115, decouple_loss:0.04146809130907059
The modified gen p mean: 0.45290395617485046, gen p mean: -0.1788444221019745, mean p set: 0.4533842206001282The modified gen p mean: 0.4518929421901703, gen p mean: -0.18615709245204926, mean p set: 0.4523732364177704
loss_pred:0.05187422037124634, decouple_loss:0.03927600383758545
loss_pred:0.05105484277009964, decouple_loss:0.04091092571616173
Iteration: 248, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4527387320995331, gen p mean: -0.18403252959251404, mean p set: 0.4532190263271332
loss_pred:0.04825243726372719, decouple_loss:0.03807753697037697
The modified gen p mean: 0.45225897431373596, gen p mean: -0.18495117127895355, mean p set: 0.45273926854133606The modified gen p mean: 0.45436644554138184, gen p mean: -0.18439477682113647, mean p set: 0.45484670996665955
loss_pred:0.04995442181825638, decouple_loss:0.0388394258916378
loss_pred:0.05031333863735199, decouple_loss:0.038131412118673325
Iteration: 249, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45224201679229736, gen p mean: -0.1994805634021759, mean p set: 0.45272231101989746
loss_pred:0.04758821427822113, decouple_loss:0.0395720973610878
The modified gen p mean: 0.45200395584106445, gen p mean: -0.20017248392105103, mean p set: 0.45248425006866455The modified gen p mean: 0.4525826871395111, gen p mean: -0.19711509346961975, mean p set: 0.45306292176246643
loss_pred:0.0485352985560894, decouple_loss:0.03837497532367706
loss_pred:0.05129286274313927, decouple_loss:0.039862584322690964
Iteration: 250, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4518159031867981, gen p mean: -0.21218235790729523, mean p set: 0.4522961974143982
loss_pred:0.049971602857112885, decouple_loss:0.03687380254268646
The modified gen p mean: 0.45035040378570557, gen p mean: -0.21156710386276245, mean p set: 0.4508306682109833The modified gen p mean: 0.45108649134635925, gen p mean: -0.20715045928955078, mean p set: 0.45156678557395935
loss_pred:0.04984425753355026, decouple_loss:0.03778117522597313
loss_pred:0.04952571541070938, decouple_loss:0.03847917914390564
2023-05-01 11:40:41 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.21079526841640472, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.20821350812911987, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.2068546563386917, mean p set: 0.4500633478164673
loss_pred:0.0529177263379097, decouple_loss:0.04343152791261673
loss_pred:0.0501677468419075, decouple_loss:0.044939588755369186
loss_pred:0.05110657215118408, decouple_loss:0.04254644736647606
WV_0_PC_1_EH_0_PS_40_15, loss: 0.05357930809259415, avg_mse: 0.054179511964321136
current test mse: 0.05418
Iteration: 251, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45329636335372925, gen p mean: -0.21357056498527527, mean p set: 0.45377665758132935
The modified gen p mean: 0.4535723030567169, gen p mean: -0.2104227989912033, mean p set: 0.45405256748199463
The modified gen p mean: 0.45364445447921753, gen p mean: -0.20828738808631897, mean p set: 0.45412477850914
loss_pred:0.049311067909002304, decouple_loss:0.03694311901926994
loss_pred:0.04713841527700424, decouple_loss:0.03539202734827995
loss_pred:0.05031440779566765, decouple_loss:0.036561135202646255
Iteration: 252, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4543944001197815, gen p mean: -0.2086668312549591, mean p set: 0.4548746943473816
loss_pred:0.04956601560115814, decouple_loss:0.03650042787194252
The modified gen p mean: 0.4525858461856842, gen p mean: -0.20966631174087524, mean p set: 0.4530661106109619The modified gen p mean: 0.4530549943447113, gen p mean: -0.2089274376630783, mean p set: 0.4535352885723114
loss_pred:0.050066687166690826, decouple_loss:0.038260817527770996
loss_pred:0.048007842153310776, decouple_loss:0.03485714644193649
Iteration: 253, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4523218870162964, gen p mean: -0.1989608108997345, mean p set: 0.4528021812438965
loss_pred:0.05077877640724182, decouple_loss:0.0394265279173851
The modified gen p mean: 0.4532589018344879, gen p mean: -0.19983653724193573, mean p set: 0.4537392258644104The modified gen p mean: 0.4515621066093445, gen p mean: -0.19491423666477203, mean p set: 0.4520424008369446
loss_pred:0.04966054484248161, decouple_loss:0.03642994537949562
loss_pred:0.050911158323287964, decouple_loss:0.036681193858385086
Iteration: 254, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45369771122932434, gen p mean: -0.2028450220823288, mean p set: 0.45417800545692444
loss_pred:0.04888245835900307, decouple_loss:0.03421906754374504
The modified gen p mean: 0.45171183347702026, gen p mean: -0.20722255110740662, mean p set: 0.45219212770462036The modified gen p mean: 0.45128047466278076, gen p mean: -0.2079060673713684, mean p set: 0.45176076889038086
loss_pred:0.047837160527706146, decouple_loss:0.03398299589753151
loss_pred:0.046482283622026443, decouple_loss:0.03455841541290283
Iteration: 255, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4526388645172119, gen p mean: -0.20235416293144226, mean p set: 0.453119158744812
loss_pred:0.04970534145832062, decouple_loss:0.035843346267938614
The modified gen p mean: 0.45230743288993835, gen p mean: -0.20112065970897675, mean p set: 0.45278772711753845The modified gen p mean: 0.45353955030441284, gen p mean: -0.20292450487613678, mean p set: 0.4540198743343353
loss_pred:0.05073481798171997, decouple_loss:0.03550473600625992
loss_pred:0.047865428030490875, decouple_loss:0.035841744393110275
Iteration: 256, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45094922184944153, gen p mean: -0.20375670492649078, mean p set: 0.4514295160770416
loss_pred:0.04895495995879173, decouple_loss:0.035328611731529236
The modified gen p mean: 0.45190316438674927, gen p mean: -0.19704294204711914, mean p set: 0.452383428812027The modified gen p mean: 0.4545176923274994, gen p mean: -0.20598749816417694, mean p set: 0.4549979567527771
loss_pred:0.050139691680669785, decouple_loss:0.034574829041957855
loss_pred:0.05019637942314148, decouple_loss:0.03494719788432121
Iteration: 257, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4528390169143677, gen p mean: -0.19890768826007843, mean p set: 0.45331934094429016
loss_pred:0.04838382452726364, decouple_loss:0.03373003005981445
The modified gen p mean: 0.453336626291275, gen p mean: -0.20190104842185974, mean p set: 0.4538169205188751The modified gen p mean: 0.45155638456344604, gen p mean: -0.2032502442598343, mean p set: 0.45203670859336853
loss_pred:0.04614337161183357, decouple_loss:0.03507746756076813
loss_pred:0.04991379752755165, decouple_loss:0.0354497991502285
Iteration: 258, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45314475893974304, gen p mean: -0.20448949933052063, mean p set: 0.45362505316734314
loss_pred:0.049546629190444946, decouple_loss:0.03231938183307648
The modified gen p mean: 0.45203307271003723, gen p mean: -0.19928641617298126, mean p set: 0.45251336693763733The modified gen p mean: 0.45176437497138977, gen p mean: -0.19756032526493073, mean p set: 0.4522446393966675
loss_pred:0.04987209662795067, decouple_loss:0.03472071513533592
loss_pred:0.05020590499043465, decouple_loss:0.03271885961294174
Iteration: 259, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4525487422943115, gen p mean: -0.21347512304782867, mean p set: 0.4530290365219116
loss_pred:0.048373669385910034, decouple_loss:0.030938122421503067
The modified gen p mean: 0.4524392783641815, gen p mean: -0.21239057183265686, mean p set: 0.4529195725917816The modified gen p mean: 0.45474690198898315, gen p mean: -0.2096913903951645, mean p set: 0.45522719621658325
loss_pred:0.047963567078113556, decouple_loss:0.030207229778170586
loss_pred:0.04991430789232254, decouple_loss:0.030969828367233276
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012006_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012006_3_24hr.npz
NaN value num: 0
Iteration: 260, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44698935747146606, gen p mean: -0.21005219221115112, mean p set: 0.44746968150138855
loss_pred:0.0498298704624176, decouple_loss:0.04360794275999069
The modified gen p mean: 0.44787687063217163, gen p mean: -0.20292116701602936, mean p set: 0.44835713505744934The modified gen p mean: 0.4487006664276123, gen p mean: -0.20485934615135193, mean p set: 0.4491809606552124
loss_pred:0.05089693143963814, decouple_loss:0.040925994515419006
loss_pred:0.04909146577119827, decouple_loss:0.03970171883702278
2023-05-01 11:43:14 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.21761132776737213, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.21390889585018158, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.21335507929325104, mean p set: 0.4500633478164673
loss_pred:0.05079178512096405, decouple_loss:0.04043671488761902
loss_pred:0.04796185716986656, decouple_loss:0.040959201753139496
loss_pred:0.049069635570049286, decouple_loss:0.03921278193593025
WV_0_PC_1_EH_0_PS_40_15, loss: 0.05128457397222519, avg_mse: 0.051788296550512314
current test mse: 0.051788
Iteration: 261, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447998970746994, gen p mean: -0.2133888155221939, mean p set: 0.4484792649745941
The modified gen p mean: 0.4470460116863251, gen p mean: -0.21899232268333435, mean p set: 0.4475262761116028
The modified gen p mean: 0.44851288199424744, gen p mean: -0.21260496973991394, mean p set: 0.44899317622184753
loss_pred:0.04789222031831741, decouple_loss:0.04256613180041313
loss_pred:0.05026518180966377, decouple_loss:0.04168595373630524
loss_pred:0.0513756200671196, decouple_loss:0.04436877369880676
Iteration: 262, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44697391986846924, gen p mean: -0.20706532895565033, mean p set: 0.44745421409606934
loss_pred:0.04824557900428772, decouple_loss:0.04223579168319702
The modified gen p mean: 0.447347491979599, gen p mean: -0.20557855069637299, mean p set: 0.4478277862071991The modified gen p mean: 0.4489962160587311, gen p mean: -0.20592187345027924, mean p set: 0.4494765102863312
loss_pred:0.045709751546382904, decouple_loss:0.041958145797252655
loss_pred:0.05033876746892929, decouple_loss:0.039238814264535904
Iteration: 263, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44879695773124695, gen p mean: -0.1964145004749298, mean p set: 0.44927728176116943
loss_pred:0.04707492142915726, decouple_loss:0.03918454796075821
The modified gen p mean: 0.4475036561489105, gen p mean: -0.193849116563797, mean p set: 0.4479839503765106The modified gen p mean: 0.44750961661338806, gen p mean: -0.20066680014133453, mean p set: 0.44798994064331055
loss_pred:0.048348765820264816, decouple_loss:0.03989584743976593
loss_pred:0.04992247745394707, decouple_loss:0.038782037794589996
Iteration: 264, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44647037982940674, gen p mean: -0.1906362771987915, mean p set: 0.44695067405700684
loss_pred:0.04938613995909691, decouple_loss:0.03683192655444145
The modified gen p mean: 0.4486241340637207, gen p mean: -0.1935344636440277, mean p set: 0.4491044282913208The modified gen p mean: 0.4487018287181854, gen p mean: -0.18869996070861816, mean p set: 0.4491821527481079
loss_pred:0.04784971475601196, decouple_loss:0.03938857838511467
loss_pred:0.04510650038719177, decouple_loss:0.0353391095995903
Iteration: 265, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493914246559143, gen p mean: -0.18459412455558777, mean p set: 0.4498717188835144
loss_pred:0.049875885248184204, decouple_loss:0.04061778262257576
The modified gen p mean: 0.4469103217124939, gen p mean: -0.18758033215999603, mean p set: 0.447390615940094The modified gen p mean: 0.44690847396850586, gen p mean: -0.1902233064174652, mean p set: 0.44738876819610596
loss_pred:0.050294846296310425, decouple_loss:0.03750424459576607
loss_pred:0.05039540305733681, decouple_loss:0.03828544169664383
Iteration: 266, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44792258739471436, gen p mean: -0.18616724014282227, mean p set: 0.44840285181999207
loss_pred:0.04896758869290352, decouple_loss:0.04043953865766525
The modified gen p mean: 0.44813400506973267, gen p mean: -0.18923527002334595, mean p set: 0.44861429929733276The modified gen p mean: 0.44811558723449707, gen p mean: -0.18595574796199799, mean p set: 0.44859588146209717
loss_pred:0.04893416911363602, decouple_loss:0.039785418659448624
loss_pred:0.04629829525947571, decouple_loss:0.03830065578222275
Iteration: 267, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44786950945854187, gen p mean: -0.1934283822774887, mean p set: 0.44834980368614197
loss_pred:0.05113722011446953, decouple_loss:0.03885694220662117
The modified gen p mean: 0.4469853341579437, gen p mean: -0.19775168597698212, mean p set: 0.4474656283855438The modified gen p mean: 0.4469222128391266, gen p mean: -0.19212663173675537, mean p set: 0.4474024772644043
loss_pred:0.045952208340168, decouple_loss:0.04049746319651604
loss_pred:0.04988584667444229, decouple_loss:0.03906703740358353
Iteration: 268, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501868486404419, gen p mean: -0.1899896115064621, mean p set: 0.450667142868042
loss_pred:0.04873799532651901, decouple_loss:0.0391671322286129
The modified gen p mean: 0.44916048645973206, gen p mean: -0.1951473504304886, mean p set: 0.44964075088500977The modified gen p mean: 0.44832825660705566, gen p mean: -0.19175222516059875, mean p set: 0.44880858063697815
loss_pred:0.04779995605349541, decouple_loss:0.03850686177611351
loss_pred:0.04542278125882149, decouple_loss:0.03875754401087761
Iteration: 269, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483188986778259, gen p mean: -0.19049011170864105, mean p set: 0.44879916310310364
loss_pred:0.04890136048197746, decouple_loss:0.038643717765808105
The modified gen p mean: 0.44835197925567627, gen p mean: -0.19168773293495178, mean p set: 0.448832243680954The modified gen p mean: 0.44660401344299316, gen p mean: -0.19317635893821716, mean p set: 0.44708430767059326
loss_pred:0.04997486621141434, decouple_loss:0.037418659776449203
loss_pred:0.047780562192201614, decouple_loss:0.03638359159231186
Iteration: 270, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491839110851288, gen p mean: -0.18831928074359894, mean p set: 0.4496642053127289
loss_pred:0.04716037958860397, decouple_loss:0.03566484525799751
The modified gen p mean: 0.4477471709251404, gen p mean: -0.19293291866779327, mean p set: 0.4482274651527405The modified gen p mean: 0.4471716582775116, gen p mean: -0.19550441205501556, mean p set: 0.4476519823074341
loss_pred:0.04707666486501694, decouple_loss:0.03481670841574669
loss_pred:0.04924115911126137, decouple_loss:0.03510721027851105
2023-05-01 11:45:09 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.19668704271316528, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.19220975041389465, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.19189304113388062, mean p set: 0.4500633478164673
loss_pred:0.04950295016169548, decouple_loss:0.0364556759595871
loss_pred:0.04689989984035492, decouple_loss:0.03552841395139694
loss_pred:0.047996919602155685, decouple_loss:0.035221561789512634
WV_0_PC_1_EH_0_PS_40_15, loss: 0.04992001876235008, avg_mse: 0.05063648149371147
current test mse: 0.050636
Iteration: 271, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447131872177124, gen p mean: -0.19223418831825256, mean p set: 0.44761213660240173
The modified gen p mean: 0.44914892315864563, gen p mean: -0.1936185210943222, mean p set: 0.4496292173862457
The modified gen p mean: 0.44731876254081726, gen p mean: -0.1938801407814026, mean p set: 0.44779905676841736
loss_pred:0.04888302460312843, decouple_loss:0.03487617149949074
loss_pred:0.049689196050167084, decouple_loss:0.03414831683039665loss_pred:0.04837018623948097, decouple_loss:0.03394775465130806
Iteration: 272, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44830429553985596, gen p mean: -0.19855651259422302, mean p set: 0.44878458976745605
loss_pred:0.04478659853339195, decouple_loss:0.034469958394765854
The modified gen p mean: 0.447473406791687, gen p mean: -0.1987829953432083, mean p set: 0.4479536712169647The modified gen p mean: 0.44741854071617126, gen p mean: -0.19406965374946594, mean p set: 0.44789883494377136
loss_pred:0.048398252576589584, decouple_loss:0.03512832522392273
loss_pred:0.049186140298843384, decouple_loss:0.03451189026236534
Iteration: 273, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44717299938201904, gen p mean: -0.19543614983558655, mean p set: 0.44765329360961914
loss_pred:0.04938124492764473, decouple_loss:0.03441418707370758
The modified gen p mean: 0.44772279262542725, gen p mean: -0.19720487296581268, mean p set: 0.44820311665534973The modified gen p mean: 0.4474940299987793, gen p mean: -0.20044204592704773, mean p set: 0.447974294424057
loss_pred:0.046814002096652985, decouple_loss:0.032538410276174545
loss_pred:0.04833235591650009, decouple_loss:0.03551256284117699
Iteration: 274, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44967159628868103, gen p mean: -0.19930556416511536, mean p set: 0.45015189051628113
loss_pred:0.04819757491350174, decouple_loss:0.03518636152148247
The modified gen p mean: 0.447256863117218, gen p mean: -0.20002999901771545, mean p set: 0.4477371573448181The modified gen p mean: 0.4493010640144348, gen p mean: -0.19487863779067993, mean p set: 0.4497813284397125
loss_pred:0.045681312680244446, decouple_loss:0.03365417569875717
loss_pred:0.04850263148546219, decouple_loss:0.0339595265686512
Iteration: 275, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44909271597862244, gen p mean: -0.1922774612903595, mean p set: 0.44957301020622253
loss_pred:0.04674205556511879, decouple_loss:0.03449458256363869
The modified gen p mean: 0.44814759492874146, gen p mean: -0.19531089067459106, mean p set: 0.44862788915634155The modified gen p mean: 0.44918811321258545, gen p mean: -0.19391223788261414, mean p set: 0.44966837763786316
loss_pred:0.04619767144322395, decouple_loss:0.03638416901230812
loss_pred:0.04731912538409233, decouple_loss:0.03345116227865219
Iteration: 276, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485624432563782, gen p mean: -0.19804640114307404, mean p set: 0.44904273748397827
loss_pred:0.044730912894010544, decouple_loss:0.03506641089916229
The modified gen p mean: 0.4474138915538788, gen p mean: -0.19966226816177368, mean p set: 0.44789421558380127The modified gen p mean: 0.44778746366500854, gen p mean: -0.2010982185602188, mean p set: 0.44826775789260864
loss_pred:0.04702456668019295, decouple_loss:0.03376969322562218
loss_pred:0.04798927530646324, decouple_loss:0.03242325410246849
Iteration: 277, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483039975166321, gen p mean: -0.19981053471565247, mean p set: 0.4487842917442322
loss_pred:0.047718439251184464, decouple_loss:0.03521978482604027
The modified gen p mean: 0.4497276246547699, gen p mean: -0.20262260735034943, mean p set: 0.45020791888237The modified gen p mean: 0.447129487991333, gen p mean: -0.2015516608953476, mean p set: 0.4476097822189331
loss_pred:0.04855607822537422, decouple_loss:0.031880587339401245
loss_pred:0.04722831770777702, decouple_loss:0.03131413459777832
Iteration: 278, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44772812724113464, gen p mean: -0.20331540703773499, mean p set: 0.44820842146873474
loss_pred:0.04687519371509552, decouple_loss:0.03271479532122612
The modified gen p mean: 0.4465521275997162, gen p mean: -0.20118503272533417, mean p set: 0.4470324218273163The modified gen p mean: 0.44690951704978943, gen p mean: -0.20376691222190857, mean p set: 0.4473898112773895
loss_pred:0.04592029005289078, decouple_loss:0.03335409611463547
loss_pred:0.04572947695851326, decouple_loss:0.03152293339371681
Iteration: 279, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44984591007232666, gen p mean: -0.1932726800441742, mean p set: 0.45032617449760437
loss_pred:0.0458952933549881, decouple_loss:0.03163952752947807
The modified gen p mean: 0.447294145822525, gen p mean: -0.19956810772418976, mean p set: 0.4477744400501251The modified gen p mean: 0.44807925820350647, gen p mean: -0.1995585560798645, mean p set: 0.44855955243110657
loss_pred:0.04507045820355415, decouple_loss:0.03305347263813019
loss_pred:0.04603392630815506, decouple_loss:0.03273097425699234
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012004_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012004_3_24hr.npz
NaN value num: 0
Iteration: 280, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500828683376312, gen p mean: -0.19523943960666656, mean p set: 0.4505631625652313
loss_pred:0.04675285890698433, decouple_loss:0.03780399262905121
The modified gen p mean: 0.4493047595024109, gen p mean: -0.19918769598007202, mean p set: 0.449785053730011The modified gen p mean: 0.45189952850341797, gen p mean: -0.1891440451145172, mean p set: 0.4523797929286957
loss_pred:0.0484294518828392, decouple_loss:0.03631671890616417
loss_pred:0.047472033649683, decouple_loss:0.03751707449555397
2023-05-01 11:47:40 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.1978847086429596, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830833911896, gen p mean: -0.19329248368740082, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.19222643971443176, mean p set: 0.45035696029663086
loss_pred:0.04909176006913185, decouple_loss:0.03496916592121124
loss_pred:0.047328852117061615, decouple_loss:0.03465399518609047loss_pred:0.046256229281425476, decouple_loss:0.03538885340094566
WV_0_PC_1_EH_0_PS_40_15, loss: 0.0493091456592083, avg_mse: 0.05021628737449646
current test mse: 0.050216
Iteration: 281, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502315819263458, gen p mean: -0.19743894040584564, mean p set: 0.4507118761539459
The modified gen p mean: 0.44841814041137695, gen p mean: -0.19188973307609558, mean p set: 0.44889846444129944
The modified gen p mean: 0.4498940706253052, gen p mean: -0.19253650307655334, mean p set: 0.45037439465522766
loss_pred:0.046535514295101166, decouple_loss:0.0348699651658535
loss_pred:0.04703189432621002, decouple_loss:0.03670570254325867
loss_pred:0.0502467155456543, decouple_loss:0.03957389295101166
Iteration: 282, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.451698362827301, gen p mean: -0.1936890184879303, mean p set: 0.4521786570549011
loss_pred:0.045442722737789154, decouple_loss:0.035026226192712784
The modified gen p mean: 0.45046737790107727, gen p mean: -0.19030652940273285, mean p set: 0.45094767212867737The modified gen p mean: 0.44915157556533813, gen p mean: -0.19099697470664978, mean p set: 0.44963186979293823
loss_pred:0.049831144511699677, decouple_loss:0.035102080553770065
loss_pred:0.05170140415430069, decouple_loss:0.03685205802321434
Iteration: 283, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45012643933296204, gen p mean: -0.19873981177806854, mean p set: 0.45060670375823975
loss_pred:0.04754561185836792, decouple_loss:0.033447425812482834
The modified gen p mean: 0.4519050717353821, gen p mean: -0.19875764846801758, mean p set: 0.4523853361606598The modified gen p mean: 0.45132601261138916, gen p mean: -0.20008312165737152, mean p set: 0.45180633664131165
loss_pred:0.04875006154179573, decouple_loss:0.035499367862939835
loss_pred:0.0494033545255661, decouple_loss:0.035044584423303604
Iteration: 284, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44896626472473145, gen p mean: -0.2038794457912445, mean p set: 0.44944655895233154
loss_pred:0.04654817655682564, decouple_loss:0.034841131418943405
The modified gen p mean: 0.4513068199157715, gen p mean: -0.20452705025672913, mean p set: 0.4517871141433716The modified gen p mean: 0.44856712222099304, gen p mean: -0.20302514731884003, mean p set: 0.44904741644859314
loss_pred:0.04839906468987465, decouple_loss:0.03303438797593117
loss_pred:0.04955541342496872, decouple_loss:0.032478466629981995
Iteration: 285, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44933953881263733, gen p mean: -0.20123647153377533, mean p set: 0.4498198330402374
loss_pred:0.047671083360910416, decouple_loss:0.03428056463599205
The modified gen p mean: 0.45160409808158875, gen p mean: -0.1981843113899231, mean p set: 0.45208439230918884The modified gen p mean: 0.4514380693435669, gen p mean: -0.19842717051506042, mean p set: 0.4519183933734894
loss_pred:0.047596968710422516, decouple_loss:0.036266133189201355
loss_pred:0.04519404470920563, decouple_loss:0.03437091410160065
Iteration: 286, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4519311189651489, gen p mean: -0.20143988728523254, mean p set: 0.452411413192749The modified gen p mean: 0.4513264298439026, gen p mean: -0.20784308016300201, mean p set: 0.4518067240715027The modified gen p mean: 0.4511454701423645, gen p mean: -0.20335374772548676, mean p set: 0.451625794172287
loss_pred:0.04805352911353111, decouple_loss:0.03380141779780388loss_pred:0.04533106088638306, decouple_loss:0.035634446889162064
loss_pred:0.04603106528520584, decouple_loss:0.035185884684324265
Iteration: 287, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45040568709373474, gen p mean: -0.20572984218597412, mean p set: 0.4508860111236572
The modified gen p mean: 0.4504013657569885, gen p mean: -0.20717254281044006, mean p set: 0.4508816599845886
loss_pred:0.04698929190635681, decouple_loss:0.03472304344177246
loss_pred:0.046033840626478195, decouple_loss:0.03656598553061485
The modified gen p mean: 0.4512999355792999, gen p mean: -0.2081236094236374, mean p set: 0.4517802298069
loss_pred:0.046102479100227356, decouple_loss:0.033813539892435074
Iteration: 288, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495391845703125, gen p mean: -0.20713166892528534, mean p set: 0.4500194787979126
loss_pred:0.046472735702991486, decouple_loss:0.033872392028570175
The modified gen p mean: 0.4497142732143402, gen p mean: -0.21194185316562653, mean p set: 0.4501945972442627The modified gen p mean: 0.45228272676467896, gen p mean: -0.21074414253234863, mean p set: 0.45276302099227905
loss_pred:0.049273502081632614, decouple_loss:0.03362584114074707
loss_pred:0.047625862061977386, decouple_loss:0.03160960599780083
Iteration: 289, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499926269054413, gen p mean: -0.2151695340871811, mean p set: 0.4504729211330414
loss_pred:0.04679103568196297, decouple_loss:0.03144130855798721
The modified gen p mean: 0.44930869340896606, gen p mean: -0.21004682779312134, mean p set: 0.44978898763656616The modified gen p mean: 0.4512999951839447, gen p mean: -0.21378859877586365, mean p set: 0.4517803192138672
loss_pred:0.04858546704053879, decouple_loss:0.0330333337187767
loss_pred:0.04488423839211464, decouple_loss:0.032659776508808136
Iteration: 290, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4510286748409271, gen p mean: -0.22125017642974854, mean p set: 0.4515089690685272
The modified gen p mean: 0.44880664348602295, gen p mean: -0.2152053266763687, mean p set: 0.44928696751594543
loss_pred:0.04779784753918648, decouple_loss:0.030281173065304756
loss_pred:0.04472343996167183, decouple_loss:0.030337246134877205
The modified gen p mean: 0.44884514808654785, gen p mean: -0.21722698211669922, mean p set: 0.44932547211647034
loss_pred:0.04677494615316391, decouple_loss:0.030214011669158936
2023-05-01 11:49:35 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.2221841961145401, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.21778792142868042, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.2189474105834961, mean p set: 0.4500633478164673
loss_pred:0.048761118203401566, decouple_loss:0.03531647473573685
loss_pred:0.046011485159397125, decouple_loss:0.03629874438047409
loss_pred:0.047146011143922806, decouple_loss:0.0345497764647007
WV_0_PC_1_EH_0_PS_40_15, loss: 0.04907562583684921, avg_mse: 0.050217002630233765
current test mse: 0.050217
Iteration: 291, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45094335079193115, gen p mean: -0.2205437868833542, mean p set: 0.45142364501953125
The modified gen p mean: 0.4523484706878662, gen p mean: -0.21799610555171967, mean p set: 0.4528287649154663
The modified gen p mean: 0.45013299584388733, gen p mean: -0.21764421463012695, mean p set: 0.4506132900714874
loss_pred:0.04821595177054405, decouple_loss:0.03125279024243355
loss_pred:0.04656754434108734, decouple_loss:0.0315864160656929
loss_pred:0.04666014388203621, decouple_loss:0.03217945992946625
Iteration: 292, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497565031051636, gen p mean: -0.20961865782737732, mean p set: 0.45023679733276367
loss_pred:0.04607631266117096, decouple_loss:0.030167046934366226
The modified gen p mean: 0.450145959854126, gen p mean: -0.20718443393707275, mean p set: 0.4506262540817261The modified gen p mean: 0.4513561427593231, gen p mean: -0.20367249846458435, mean p set: 0.4518364667892456
loss_pred:0.04609174653887749, decouple_loss:0.032696232199668884
loss_pred:0.04475373774766922, decouple_loss:0.03213327005505562
Iteration: 293, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4523080885410309, gen p mean: -0.21799494326114655, mean p set: 0.452788382768631
loss_pred:0.04784006252884865, decouple_loss:0.032562147825956345
The modified gen p mean: 0.4489753842353821, gen p mean: -0.21369554102420807, mean p set: 0.4494556486606598The modified gen p mean: 0.4496285617351532, gen p mean: -0.2143440544605255, mean p set: 0.45010891556739807
loss_pred:0.045256685465574265, decouple_loss:0.02999194525182247
loss_pred:0.04624025896191597, decouple_loss:0.029940592125058174
Iteration: 294, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498899281024933, gen p mean: -0.21318794786930084, mean p set: 0.45037025213241577
loss_pred:0.04693266749382019, decouple_loss:0.03310488164424896
The modified gen p mean: 0.4502876102924347, gen p mean: -0.21474812924861908, mean p set: 0.4507678747177124The modified gen p mean: 0.4487839937210083, gen p mean: -0.2102266401052475, mean p set: 0.4492642879486084
loss_pred:0.04510803893208504, decouple_loss:0.033247798681259155
loss_pred:0.044628169387578964, decouple_loss:0.03243555873632431
Iteration: 295, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4519163966178894, gen p mean: -0.2090844064950943, mean p set: 0.4523966908454895
loss_pred:0.04517699033021927, decouple_loss:0.03411494195461273
The modified gen p mean: 0.45001593232154846, gen p mean: -0.21451671421527863, mean p set: 0.45049622654914856The modified gen p mean: 0.45169180631637573, gen p mean: -0.21652822196483612, mean p set: 0.45217210054397583
loss_pred:0.046789154410362244, decouple_loss:0.03176550939679146
loss_pred:0.0473305806517601, decouple_loss:0.03522529825568199
Iteration: 296, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4510978162288666, gen p mean: -0.2143048346042633, mean p set: 0.4515781104564667
loss_pred:0.044450677931308746, decouple_loss:0.03399258479475975
The modified gen p mean: 0.4499218165874481, gen p mean: -0.21288593113422394, mean p set: 0.4504021108150482The modified gen p mean: 0.4495828449726105, gen p mean: -0.21580839157104492, mean p set: 0.45006316900253296
loss_pred:0.048785265535116196, decouple_loss:0.03123381733894348
loss_pred:0.04544655606150627, decouple_loss:0.031642016023397446
Iteration: 297, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4515686333179474, gen p mean: -0.2157016396522522, mean p set: 0.4520488977432251
loss_pred:0.04493974521756172, decouple_loss:0.029787331819534302
The modified gen p mean: 0.4501567482948303, gen p mean: -0.2211800515651703, mean p set: 0.4506370425224304The modified gen p mean: 0.450753778219223, gen p mean: -0.220492422580719, mean p set: 0.4512340724468231
loss_pred:0.04902518168091774, decouple_loss:0.03262760117650032
loss_pred:0.047352537512779236, decouple_loss:0.033424992114305496
Iteration: 298, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4512156546115875, gen p mean: -0.2205274999141693, mean p set: 0.4516959488391876
loss_pred:0.04456409811973572, decouple_loss:0.030404435470700264
The modified gen p mean: 0.4504311978816986, gen p mean: -0.21966469287872314, mean p set: 0.4509114921092987The modified gen p mean: 0.4505697786808014, gen p mean: -0.22599531710147858, mean p set: 0.4510500431060791
loss_pred:0.04400431737303734, decouple_loss:0.030439065769314766
loss_pred:0.045557018369436264, decouple_loss:0.031113334000110626
Iteration: 299, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45015203952789307, gen p mean: -0.23468486964702606, mean p set: 0.4506323039531708
loss_pred:0.0468498095870018, decouple_loss:0.030265171080827713
The modified gen p mean: 0.4498480260372162, gen p mean: -0.2288968861103058, mean p set: 0.4503283202648163The modified gen p mean: 0.4499150514602661, gen p mean: -0.23817867040634155, mean p set: 0.4503953158855438
loss_pred:0.04491930827498436, decouple_loss:0.03332175314426422
loss_pred:0.04648330807685852, decouple_loss:0.0335896760225296
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012002_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012002_3_24hr.npz
NaN value num: 0
Iteration: 300, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44721871614456177, gen p mean: -0.22609837353229523, mean p set: 0.4476989805698395
loss_pred:0.04730544984340668, decouple_loss:0.036299098283052444
The modified gen p mean: 0.44659224152565, gen p mean: -0.22373908758163452, mean p set: 0.4470725357532501The modified gen p mean: 0.44691091775894165, gen p mean: -0.22364909946918488, mean p set: 0.44739121198654175
loss_pred:0.048739489167928696, decouple_loss:0.03590761870145798
loss_pred:0.047600191086530685, decouple_loss:0.03677130863070488
2023-05-01 11:52:07 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.2250315397977829, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.21962352097034454, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.22224904596805573, mean p set: 0.4500633478164673
loss_pred:0.048796944320201874, decouple_loss:0.03557481989264488
loss_pred:0.04618041217327118, decouple_loss:0.03773678094148636
loss_pred:0.047251105308532715, decouple_loss:0.035905756056308746
WV_0_PC_1_EH_0_PS_40_15, loss: 0.04922977834939957, avg_mse: 0.050631873309612274
current test mse: 0.050632
Iteration: 301, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44829386472702026, gen p mean: -0.22599627077579498, mean p set: 0.448774129152298
The modified gen p mean: 0.4470807909965515, gen p mean: -0.23059163987636566, mean p set: 0.4475610554218292
The modified gen p mean: 0.44767051935195923, gen p mean: -0.23283131420612335, mean p set: 0.44815075397491455
loss_pred:0.045922111719846725, decouple_loss:0.03677767887711525
loss_pred:0.04760442301630974, decouple_loss:0.03735501691699028
loss_pred:0.045805878937244415, decouple_loss:0.037027567625045776
Iteration: 302, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44560834765434265, gen p mean: -0.22049912810325623, mean p set: 0.44608867168426514
loss_pred:0.04761228710412979, decouple_loss:0.03570397570729256
The modified gen p mean: 0.44654712080955505, gen p mean: -0.22209987044334412, mean p set: 0.44702741503715515The modified gen p mean: 0.44606515765190125, gen p mean: -0.21216051280498505, mean p set: 0.44654545187950134
loss_pred:0.048386987298727036, decouple_loss:0.035225044935941696
loss_pred:0.044247422367334366, decouple_loss:0.03820739686489105
Iteration: 303, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44608253240585327, gen p mean: -0.2173938900232315, mean p set: 0.446562796831131
loss_pred:0.04618293046951294, decouple_loss:0.033210139721632004
The modified gen p mean: 0.44663169980049133, gen p mean: -0.22064177691936493, mean p set: 0.44711199402809143The modified gen p mean: 0.4471961259841919, gen p mean: -0.21686184406280518, mean p set: 0.447676420211792
loss_pred:0.04818342626094818, decouple_loss:0.03304678946733475
loss_pred:0.04699721559882164, decouple_loss:0.03485589101910591
Iteration: 304, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447517454624176, gen p mean: -0.23015007376670837, mean p set: 0.4479977488517761
loss_pred:0.04445411637425423, decouple_loss:0.03246384486556053
The modified gen p mean: 0.44877082109451294, gen p mean: -0.2208637148141861, mean p set: 0.44925111532211304The modified gen p mean: 0.4463620185852051, gen p mean: -0.22232627868652344, mean p set: 0.4468423128128052
loss_pred:0.046051014214754105, decouple_loss:0.03434557095170021
loss_pred:0.045168276876211166, decouple_loss:0.03380162641406059
Iteration: 305, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44793158769607544, gen p mean: -0.2247953712940216, mean p set: 0.44841188192367554
loss_pred:0.04495551064610481, decouple_loss:0.03486568108201027
The modified gen p mean: 0.4461632966995239, gen p mean: -0.22807927429676056, mean p set: 0.446643590927124The modified gen p mean: 0.44572699069976807, gen p mean: -0.22675834596157074, mean p set: 0.44620731472969055
loss_pred:0.044842932373285294, decouple_loss:0.034871023148298264
loss_pred:0.04647127911448479, decouple_loss:0.03231733664870262
Iteration: 306, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44690144062042236, gen p mean: -0.2257402241230011, mean p set: 0.44738173484802246
loss_pred:0.0471123568713665, decouple_loss:0.033269044011831284
The modified gen p mean: 0.4464660584926605, gen p mean: -0.22391702234745026, mean p set: 0.446946382522583The modified gen p mean: 0.44587406516075134, gen p mean: -0.22206752002239227, mean p set: 0.44635435938835144
loss_pred:0.045449838042259216, decouple_loss:0.03352708742022514
loss_pred:0.045394398272037506, decouple_loss:0.033367618918418884
Iteration: 307, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44953835010528564, gen p mean: -0.2129288613796234, mean p set: 0.45001867413520813
loss_pred:0.045260582119226456, decouple_loss:0.0341259241104126
The modified gen p mean: 0.4463766813278198, gen p mean: -0.21194307506084442, mean p set: 0.4468569755554199The modified gen p mean: 0.44695520401000977, gen p mean: -0.20686101913452148, mean p set: 0.44743549823760986
loss_pred:0.04414181038737297, decouple_loss:0.03110296092927456
loss_pred:0.04670979082584381, decouple_loss:0.033980999141931534
Iteration: 308, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467291831970215, gen p mean: -0.21237608790397644, mean p set: 0.4472094774246216
loss_pred:0.044120900332927704, decouple_loss:0.03168248385190964
The modified gen p mean: 0.44694721698760986, gen p mean: -0.21296857297420502, mean p set: 0.4474274814128876The modified gen p mean: 0.4473472535610199, gen p mean: -0.21057859063148499, mean p set: 0.4478275179862976
loss_pred:0.04492657259106636, decouple_loss:0.037220653146505356
loss_pred:0.04548003152012825, decouple_loss:0.033485639840364456
Iteration: 309, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44681331515312195, gen p mean: -0.21410949528217316, mean p set: 0.44729360938072205
loss_pred:0.046302419155836105, decouple_loss:0.03296102583408356
The modified gen p mean: 0.44780677556991577, gen p mean: -0.2254641205072403, mean p set: 0.4482870399951935The modified gen p mean: 0.4461938142776489, gen p mean: -0.22043831646442413, mean p set: 0.446674108505249
loss_pred:0.043391622602939606, decouple_loss:0.032683324068784714
loss_pred:0.0455956757068634, decouple_loss:0.03173452988266945
Iteration: 310, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44721418619155884, gen p mean: -0.2192433476448059, mean p set: 0.44769448041915894
loss_pred:0.04487118124961853, decouple_loss:0.03472241386771202
The modified gen p mean: 0.44711974263191223, gen p mean: -0.22137200832366943, mean p set: 0.44760003685951233The modified gen p mean: 0.44630497694015503, gen p mean: -0.2201027125120163, mean p set: 0.44678524136543274
loss_pred:0.04389122128486633, decouple_loss:0.031275972723960876
loss_pred:0.043791837990283966, decouple_loss:0.03041132539510727
2023-05-01 11:54:02 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.21296469867229462, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.2067556083202362, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.2080678641796112, mean p set: 0.4500633478164673
loss_pred:0.046753980219364166, decouple_loss:0.03193197399377823
loss_pred:0.04440927505493164, decouple_loss:0.03408839926123619
loss_pred:0.04545268416404724, decouple_loss:0.031941648572683334
WV_0_PC_1_EH_0_PS_40_15, loss: 0.047171346843242645, avg_mse: 0.04846792295575142
current test mse: 0.048468
Iteration: 311, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487651586532593, gen p mean: -0.21388384699821472, mean p set: 0.4492454528808594
The modified gen p mean: 0.4472074508666992, gen p mean: -0.20674574375152588, mean p set: 0.4476877748966217
The modified gen p mean: 0.44848331809043884, gen p mean: -0.21091918647289276, mean p set: 0.44896358251571655
loss_pred:0.04447527229785919, decouple_loss:0.032607581466436386
loss_pred:0.04534380882978439, decouple_loss:0.03157036751508713
loss_pred:0.04561087116599083, decouple_loss:0.03016509860754013
Iteration: 312, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44694703817367554, gen p mean: -0.21522438526153564, mean p set: 0.44742733240127563
loss_pred:0.0457366406917572, decouple_loss:0.030421366915106773
The modified gen p mean: 0.44861599802970886, gen p mean: -0.2162872850894928, mean p set: 0.44909629225730896The modified gen p mean: 0.4457029104232788, gen p mean: -0.216576486825943, mean p set: 0.4461832046508789
loss_pred:0.04700470715761185, decouple_loss:0.03136714920401573
loss_pred:0.044793177396059036, decouple_loss:0.03186255320906639
Iteration: 313, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476546347141266, gen p mean: -0.22549748420715332, mean p set: 0.4481349289417267
loss_pred:0.04489581286907196, decouple_loss:0.031336743384599686
The modified gen p mean: 0.4459373950958252, gen p mean: -0.2235081046819687, mean p set: 0.4464176893234253The modified gen p mean: 0.4462195932865143, gen p mean: -0.2193848192691803, mean p set: 0.4466998875141144
loss_pred:0.045261021703481674, decouple_loss:0.02990889735519886
loss_pred:0.04376387223601341, decouple_loss:0.031689707189798355
Iteration: 314, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44585973024368286, gen p mean: -0.2284822165966034, mean p set: 0.44634005427360535
loss_pred:0.045440226793289185, decouple_loss:0.030407128855586052
The modified gen p mean: 0.44572100043296814, gen p mean: -0.22872085869312286, mean p set: 0.44620129466056824The modified gen p mean: 0.4463137090206146, gen p mean: -0.22263029217720032, mean p set: 0.44679397344589233
loss_pred:0.04352499172091484, decouple_loss:0.03329068794846535
loss_pred:0.04762432724237442, decouple_loss:0.030230404809117317
Iteration: 315, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488300383090973, gen p mean: -0.22902913391590118, mean p set: 0.4493103623390198
loss_pred:0.0441649928689003, decouple_loss:0.029889391735196114
The modified gen p mean: 0.44604259729385376, gen p mean: -0.2279888093471527, mean p set: 0.44652286171913147
The modified gen p mean: 0.44678986072540283, gen p mean: -0.2297859787940979, mean p set: 0.44727015495300293
loss_pred:0.04549219459295273, decouple_loss:0.028235698118805885
loss_pred:0.04402324929833412, decouple_loss:0.027513522654771805
Iteration: 316, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44563642144203186, gen p mean: -0.22432217001914978, mean p set: 0.44611674547195435
loss_pred:0.043599933385849, decouple_loss:0.030175883322954178
The modified gen p mean: 0.44687435030937195, gen p mean: -0.23024074733257294, mean p set: 0.44735464453697205The modified gen p mean: 0.4464953541755676, gen p mean: -0.2275964319705963, mean p set: 0.44697561860084534
loss_pred:0.04297875612974167, decouple_loss:0.02829897031188011
loss_pred:0.04370664432644844, decouple_loss:0.028777258470654488
Iteration: 317, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496762156486511, gen p mean: -0.22218823432922363, mean p set: 0.4501565396785736
loss_pred:0.044530004262924194, decouple_loss:0.02959214709699154
The modified gen p mean: 0.44906169176101685, gen p mean: -0.22479915618896484, mean p set: 0.44954198598861694The modified gen p mean: 0.4478931725025177, gen p mean: -0.22048524022102356, mean p set: 0.4483734667301178
loss_pred:0.04417099058628082, decouple_loss:0.03076738677918911
loss_pred:0.044841740280389786, decouple_loss:0.03003385104238987
Iteration: 318, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44660159945487976, gen p mean: -0.22225548326969147, mean p set: 0.44708189368247986
loss_pred:0.0446903221309185, decouple_loss:0.027128254994750023
The modified gen p mean: 0.4477980136871338, gen p mean: -0.22153964638710022, mean p set: 0.4482783079147339The modified gen p mean: 0.44631490111351013, gen p mean: -0.22472849488258362, mean p set: 0.44679519534111023
loss_pred:0.0432264618575573, decouple_loss:0.0286373570561409
loss_pred:0.0430629663169384, decouple_loss:0.028243668377399445
Iteration: 319, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44580021500587463, gen p mean: -0.22890131175518036, mean p set: 0.44628050923347473
loss_pred:0.043379828333854675, decouple_loss:0.029268402606248856
The modified gen p mean: 0.4457554519176483, gen p mean: -0.22629301249980927, mean p set: 0.4462357461452484The modified gen p mean: 0.4467082917690277, gen p mean: -0.22746005654335022, mean p set: 0.4471885859966278
loss_pred:0.04398534819483757, decouple_loss:0.030053988099098206
loss_pred:0.04466499015688896, decouple_loss:0.027781708166003227
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012000_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012000_3_24hr.npz
NaN value num: 0
Iteration: 320, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44661176204681396, gen p mean: -0.2302108258008957, mean p set: 0.44709208607673645
loss_pred:0.04466516152024269, decouple_loss:0.027717480435967445
The modified gen p mean: 0.44698771834373474, gen p mean: -0.23189763724803925, mean p set: 0.44746798276901245The modified gen p mean: 0.44671183824539185, gen p mean: -0.2331218719482422, mean p set: 0.44719216227531433
loss_pred:0.04331396147608757, decouple_loss:0.025850573554635048
loss_pred:0.04358059912919998, decouple_loss:0.02732015587389469
2023-05-01 11:56:32 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.2264469712972641, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.21934708952903748, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.22020688652992249, mean p set: 0.4500633478164673
loss_pred:0.046076901257038116, decouple_loss:0.02869049645960331
loss_pred:0.043648719787597656, decouple_loss:0.03071831353008747
loss_pred:0.0445588044822216, decouple_loss:0.028954973444342613
WV_0_PC_1_EH_0_PS_40_15, loss: 0.04623420163989067, avg_mse: 0.04787415638566017
current test mse: 0.047874
Iteration: 321, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44694966077804565, gen p mean: -0.21629604697227478, mean p set: 0.44742998480796814
The modified gen p mean: 0.4469406008720398, gen p mean: -0.2313612550497055, mean p set: 0.4474208950996399
The modified gen p mean: 0.4478931128978729, gen p mean: -0.22109712660312653, mean p set: 0.448373407125473
loss_pred:0.04531791806221008, decouple_loss:0.032244786620140076
loss_pred:0.04697403684258461, decouple_loss:0.028873024508357048
loss_pred:0.04379798099398613, decouple_loss:0.02684517577290535
Iteration: 322, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44717586040496826, gen p mean: -0.22502686083316803, mean p set: 0.44765612483024597
loss_pred:0.04321511834859848, decouple_loss:0.029347296804189682
The modified gen p mean: 0.44735077023506165, gen p mean: -0.22121113538742065, mean p set: 0.44783106446266174The modified gen p mean: 0.4470891058444977, gen p mean: -0.23126862943172455, mean p set: 0.447569340467453
loss_pred:0.04404669255018234, decouple_loss:0.028068363666534424
loss_pred:0.04383639246225357, decouple_loss:0.03102438896894455
Iteration: 323, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475298523902893, gen p mean: -0.22348140180110931, mean p set: 0.4480101466178894
loss_pred:0.04233253002166748, decouple_loss:0.029200837016105652
The modified gen p mean: 0.4484092891216278, gen p mean: -0.2302335947751999, mean p set: 0.4488895833492279The modified gen p mean: 0.44732069969177246, gen p mean: -0.23327656090259552, mean p set: 0.44780099391937256
loss_pred:0.044673144817352295, decouple_loss:0.031342342495918274
loss_pred:0.04241481423377991, decouple_loss:0.029653385281562805
Iteration: 324, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473946988582611, gen p mean: -0.2250957190990448, mean p set: 0.4478749930858612
loss_pred:0.04403932765126228, decouple_loss:0.02843227982521057
The modified gen p mean: 0.44681087136268616, gen p mean: -0.2329285740852356, mean p set: 0.44729119539260864The modified gen p mean: 0.4465195834636688, gen p mean: -0.22894738614559174, mean p set: 0.44699984788894653
loss_pred:0.04358968511223793, decouple_loss:0.028438329696655273
loss_pred:0.04389074444770813, decouple_loss:0.028374340385198593
Iteration: 325, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473946690559387, gen p mean: -0.21926908195018768, mean p set: 0.4478749632835388
loss_pred:0.042939573526382446, decouple_loss:0.026387764140963554
The modified gen p mean: 0.4477144181728363, gen p mean: -0.2157573699951172, mean p set: 0.4481947124004364The modified gen p mean: 0.4494279623031616, gen p mean: -0.22339452803134918, mean p set: 0.44990822672843933
loss_pred:0.04451780393719673, decouple_loss:0.026892192661762238
loss_pred:0.04488006606698036, decouple_loss:0.03189856931567192
Iteration: 326, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470345973968506, gen p mean: -0.22179590165615082, mean p set: 0.4475148916244507
loss_pred:0.044068820774555206, decouple_loss:0.029342280700802803
The modified gen p mean: 0.44760647416114807, gen p mean: -0.2239837795495987, mean p set: 0.44808676838874817The modified gen p mean: 0.44615963101387024, gen p mean: -0.21618489921092987, mean p set: 0.4466399550437927
loss_pred:0.04236734285950661, decouple_loss:0.02652174048125744
loss_pred:0.042690783739089966, decouple_loss:0.026637820526957512
Iteration: 327, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44905394315719604, gen p mean: -0.22007624804973602, mean p set: 0.44953420758247375
loss_pred:0.04445520415902138, decouple_loss:0.029940497130155563
The modified gen p mean: 0.4480491578578949, gen p mean: -0.21183659136295319, mean p set: 0.4485294818878174The modified gen p mean: 0.4472832679748535, gen p mean: -0.21237881481647491, mean p set: 0.4477635622024536
loss_pred:0.04347021505236626, decouple_loss:0.02722936123609543
loss_pred:0.044876519590616226, decouple_loss:0.029077643528580666
Iteration: 328, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447578489780426, gen p mean: -0.21112613379955292, mean p set: 0.44805875420570374
loss_pred:0.04314027354121208, decouple_loss:0.025102736428380013
The modified gen p mean: 0.44731464982032776, gen p mean: -0.21436037123203278, mean p set: 0.44779494404792786The modified gen p mean: 0.4484701454639435, gen p mean: -0.2112773060798645, mean p set: 0.4489504396915436
loss_pred:0.043362297117710114, decouple_loss:0.02522820606827736
loss_pred:0.04305972158908844, decouple_loss:0.02540672942996025
Iteration: 329, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44754984974861145, gen p mean: -0.21874529123306274, mean p set: 0.44803011417388916
loss_pred:0.046012502163648605, decouple_loss:0.02759530022740364
The modified gen p mean: 0.4459533095359802, gen p mean: -0.2216484099626541, mean p set: 0.4464336037635803
The modified gen p mean: 0.44729548692703247, gen p mean: -0.22474732995033264, mean p set: 0.44777578115463257
loss_pred:0.04321989789605141, decouple_loss:0.026689477264881134
loss_pred:0.042258407920598984, decouple_loss:0.02954859845340252
Iteration: 330, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471362829208374, gen p mean: -0.23465117812156677, mean p set: 0.4476166069507599
loss_pred:0.04270361363887787, decouple_loss:0.02791353315114975
The modified gen p mean: 0.4461573362350464, gen p mean: -0.23407478630542755, mean p set: 0.44663766026496887The modified gen p mean: 0.446189284324646, gen p mean: -0.23330344259738922, mean p set: 0.4466695487499237
loss_pred:0.04360494762659073, decouple_loss:0.026486238464713097
loss_pred:0.04236750304698944, decouple_loss:0.02836720086634159
2023-05-01 11:58:27 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.23153918981552124, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.2250065803527832, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.22608081996440887, mean p set: 0.4500633478164673
loss_pred:0.0452481247484684, decouple_loss:0.029343299567699432
loss_pred:0.042940497398376465, decouple_loss:0.02967742644250393
loss_pred:0.04387672245502472, decouple_loss:0.028373004868626595
WV_0_PC_1_EH_0_PS_40_15, loss: 0.04547834396362305, avg_mse: 0.04720987379550934
current test mse: 0.04721
Iteration: 331, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44848689436912537, gen p mean: -0.23286984860897064, mean p set: 0.44896718859672546
The modified gen p mean: 0.4472602307796478, gen p mean: -0.22685548663139343, mean p set: 0.4477405250072479
The modified gen p mean: 0.4476718306541443, gen p mean: -0.22778183221817017, mean p set: 0.448152095079422
loss_pred:0.04296165332198143, decouple_loss:0.02708466164767742
loss_pred:0.0441056452691555, decouple_loss:0.029298104345798492
loss_pred:0.04293111339211464, decouple_loss:0.028404012322425842
Iteration: 332, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44772329926490784, gen p mean: -0.2233404517173767, mean p set: 0.44820359349250793
loss_pred:0.04313810542225838, decouple_loss:0.027153749018907547
The modified gen p mean: 0.4456823468208313, gen p mean: -0.229068785905838, mean p set: 0.4461626410484314The modified gen p mean: 0.4472377598285675, gen p mean: -0.21981239318847656, mean p set: 0.4477180242538452
loss_pred:0.04187619686126709, decouple_loss:0.026605017483234406
loss_pred:0.04453505575656891, decouple_loss:0.026468483731150627
Iteration: 333, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446994811296463, gen p mean: -0.23063622415065765, mean p set: 0.4474751055240631
loss_pred:0.04215036332607269, decouple_loss:0.02550886943936348
The modified gen p mean: 0.4470658600330353, gen p mean: -0.21898053586483002, mean p set: 0.447546124458313The modified gen p mean: 0.44786345958709717, gen p mean: -0.22551777958869934, mean p set: 0.44834375381469727
loss_pred:0.044521406292915344, decouple_loss:0.026711029931902885
loss_pred:0.04543086886405945, decouple_loss:0.028104089200496674
Iteration: 334, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4463563859462738, gen p mean: -0.22904106974601746, mean p set: 0.4468367099761963
loss_pred:0.043306611478328705, decouple_loss:0.02845057100057602
The modified gen p mean: 0.4463949501514435, gen p mean: -0.23115010559558868, mean p set: 0.4468752145767212The modified gen p mean: 0.44622308015823364, gen p mean: -0.2337685376405716, mean p set: 0.44670340418815613
loss_pred:0.0416981540620327, decouple_loss:0.026674779132008553
loss_pred:0.042732078582048416, decouple_loss:0.027683835476636887
Iteration: 335, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44772693514823914, gen p mean: -0.2166004180908203, mean p set: 0.44820722937583923
loss_pred:0.04462143033742905, decouple_loss:0.02663499116897583
The modified gen p mean: 0.44714874029159546, gen p mean: -0.21448802947998047, mean p set: 0.44762900471687317The modified gen p mean: 0.44758981466293335, gen p mean: -0.2159094363451004, mean p set: 0.44807007908821106
loss_pred:0.04133574292063713, decouple_loss:0.026886779814958572
loss_pred:0.04214216768741608, decouple_loss:0.027906237170100212
Iteration: 336, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464568793773651, gen p mean: -0.22606877982616425, mean p set: 0.4469371736049652
loss_pred:0.04240810498595238, decouple_loss:0.02481037937104702
The modified gen p mean: 0.44721198081970215, gen p mean: -0.23351211845874786, mean p set: 0.44769227504730225The modified gen p mean: 0.4474044740200043, gen p mean: -0.23336979746818542, mean p set: 0.44788476824760437
loss_pred:0.04250520095229149, decouple_loss:0.0266583114862442
loss_pred:0.04139363765716553, decouple_loss:0.026500262320041656
Iteration: 337, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472357928752899, gen p mean: -0.23563994467258453, mean p set: 0.4477160573005676
loss_pred:0.042393364012241364, decouple_loss:0.024691255763173103
The modified gen p mean: 0.44653427600860596, gen p mean: -0.24003905057907104, mean p set: 0.44701457023620605The modified gen p mean: 0.44768059253692627, gen p mean: -0.2351522594690323, mean p set: 0.448160856962204
loss_pred:0.04288564249873161, decouple_loss:0.025181272998452187
loss_pred:0.043655507266521454, decouple_loss:0.025508379563689232
Iteration: 338, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44558027386665344, gen p mean: -0.24030351638793945, mean p set: 0.44606053829193115
loss_pred:0.04097703844308853, decouple_loss:0.024263691157102585
The modified gen p mean: 0.44675570726394653, gen p mean: -0.2404320240020752, mean p set: 0.44723597168922424The modified gen p mean: 0.4473939538002014, gen p mean: -0.2375185489654541, mean p set: 0.4478742182254791
loss_pred:0.0426228828728199, decouple_loss:0.025188826024532318
loss_pred:0.04447126016020775, decouple_loss:0.02784132957458496
Iteration: 339, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471409022808075, gen p mean: -0.22504299879074097, mean p set: 0.44762122631073
loss_pred:0.04230145737528801, decouple_loss:0.025723394006490707
The modified gen p mean: 0.4469488859176636, gen p mean: -0.23070669174194336, mean p set: 0.44742920994758606The modified gen p mean: 0.4474177658557892, gen p mean: -0.22560574114322662, mean p set: 0.4478980302810669
loss_pred:0.0429697223007679, decouple_loss:0.025453610345721245
loss_pred:0.04176017642021179, decouple_loss:0.02574709616601467
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012000_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012000_3_24hr.npz
NaN value num: 0
Iteration: 340, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4512248635292053, gen p mean: -0.22659416496753693, mean p set: 0.4517051577568054
loss_pred:0.04241578280925751, decouple_loss:0.03538542985916138
The modified gen p mean: 0.44950807094573975, gen p mean: -0.22828075289726257, mean p set: 0.44998836517333984The modified gen p mean: 0.4494718015193939, gen p mean: -0.22791604697704315, mean p set: 0.449952095746994
loss_pred:0.04305717721581459, decouple_loss:0.029337039217352867
loss_pred:0.04277380555868149, decouple_loss:0.030775386840105057
2023-05-01 12:00:58 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.2348002940416336, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.22646713256835938, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.2292364090681076, mean p set: 0.4500633478164673
loss_pred:0.04497090354561806, decouple_loss:0.03039480745792389
loss_pred:0.04242631420493126, decouple_loss:0.03185403347015381
loss_pred:0.04340032488107681, decouple_loss:0.02996036969125271
WV_0_PC_1_EH_0_PS_40_15, loss: 0.04513600096106529, avg_mse: 0.04702739045023918
current test mse: 0.047027
Iteration: 341, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45145177841186523, gen p mean: -0.23285795748233795, mean p set: 0.4519321024417877
The modified gen p mean: 0.451507031917572, gen p mean: -0.2316504716873169, mean p set: 0.4519873261451721
The modified gen p mean: 0.44813981652259827, gen p mean: -0.23420381546020508, mean p set: 0.44862014055252075
loss_pred:0.042162638157606125, decouple_loss:0.028647027909755707
loss_pred:0.044073864817619324, decouple_loss:0.03108893521130085
loss_pred:0.04288516193628311, decouple_loss:0.02841535396873951
Iteration: 342, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45082300901412964, gen p mean: -0.23492611944675446, mean p set: 0.45130327343940735
loss_pred:0.043547701090574265, decouple_loss:0.02943955734372139
The modified gen p mean: 0.4493529200553894, gen p mean: -0.22241458296775818, mean p set: 0.4498332440853119The modified gen p mean: 0.44974252581596375, gen p mean: -0.23130933940410614, mean p set: 0.45022279024124146
loss_pred:0.041964709758758545, decouple_loss:0.02870095893740654
loss_pred:0.042485836893320084, decouple_loss:0.02763436920940876
Iteration: 343, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490899443626404, gen p mean: -0.2292969673871994, mean p set: 0.4495701789855957
loss_pred:0.04314517229795456, decouple_loss:0.02556309476494789
The modified gen p mean: 0.45150044560432434, gen p mean: -0.23020930588245392, mean p set: 0.45198073983192444
The modified gen p mean: 0.4516070485115051, gen p mean: -0.2303609997034073, mean p set: 0.45208731293678284
loss_pred:0.043589405715465546, decouple_loss:0.03157676011323929
loss_pred:0.0433984138071537, decouple_loss:0.029123574495315552
Iteration: 344, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45058420300483704, gen p mean: -0.23206740617752075, mean p set: 0.4510645270347595
loss_pred:0.042034704238176346, decouple_loss:0.02797560580074787
The modified gen p mean: 0.4518389105796814, gen p mean: -0.2251107394695282, mean p set: 0.4523191750049591The modified gen p mean: 0.4476621448993683, gen p mean: -0.23353981971740723, mean p set: 0.448142409324646
loss_pred:0.043456099927425385, decouple_loss:0.02971644699573517
loss_pred:0.041838690638542175, decouple_loss:0.029200183227658272
Iteration: 345, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496873915195465, gen p mean: -0.2372817099094391, mean p set: 0.4501676559448242
loss_pred:0.04259394109249115, decouple_loss:0.028478996828198433
The modified gen p mean: 0.4507521092891693, gen p mean: -0.22681233286857605, mean p set: 0.4512324035167694The modified gen p mean: 0.4512357711791992, gen p mean: -0.22737690806388855, mean p set: 0.4517160654067993
loss_pred:0.04205438494682312, decouple_loss:0.02709203213453293
loss_pred:0.04257907718420029, decouple_loss:0.030156318098306656
Iteration: 346, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511454105377197, gen p mean: -0.2343991994857788, mean p set: 0.45162567496299744
loss_pred:0.04287521168589592, decouple_loss:0.030591540038585663
The modified gen p mean: 0.44996708631515503, gen p mean: -0.23711445927619934, mean p set: 0.4504474103450775The modified gen p mean: 0.448850154876709, gen p mean: -0.2354041337966919, mean p set: 0.4493304491043091
loss_pred:0.04212794080376625, decouple_loss:0.029430586844682693
loss_pred:0.04180514067411423, decouple_loss:0.029182571917772293
Iteration: 347, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44978782534599304, gen p mean: -0.23030121624469757, mean p set: 0.45026808977127075
loss_pred:0.0415484644472599, decouple_loss:0.027564682066440582
The modified gen p mean: 0.44991931319236755, gen p mean: -0.2301323413848877, mean p set: 0.45039960741996765The modified gen p mean: 0.4516649544239044, gen p mean: -0.2289716899394989, mean p set: 0.4521452486515045
loss_pred:0.04222378507256508, decouple_loss:0.028528371825814247
loss_pred:0.04252232611179352, decouple_loss:0.02694699726998806
Iteration: 348, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45039644837379456, gen p mean: -0.23590004444122314, mean p set: 0.45087674260139465
loss_pred:0.042702894657850266, decouple_loss:0.026330165565013885
The modified gen p mean: 0.451978862285614, gen p mean: -0.23400628566741943, mean p set: 0.4524591267108917The modified gen p mean: 0.4511565864086151, gen p mean: -0.23612606525421143, mean p set: 0.4516368806362152
loss_pred:0.04182901233434677, decouple_loss:0.02772543765604496
loss_pred:0.041913069784641266, decouple_loss:0.025965040549635887
Iteration: 349, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44974350929260254, gen p mean: -0.2538093328475952, mean p set: 0.45022377371788025
loss_pred:0.04188348352909088, decouple_loss:0.02502146176993847
The modified gen p mean: 0.4498012959957123, gen p mean: -0.24783922731876373, mean p set: 0.45028162002563477The modified gen p mean: 0.45149609446525574, gen p mean: -0.24323157966136932, mean p set: 0.45197638869285583
loss_pred:0.0418529212474823, decouple_loss:0.02526581473648548
loss_pred:0.040399421006441116, decouple_loss:0.026816455647349358
Iteration: 350, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44969499111175537, gen p mean: -0.24592433869838715, mean p set: 0.4501752555370331
loss_pred:0.04206162691116333, decouple_loss:0.028041448444128036
The modified gen p mean: 0.448747456073761, gen p mean: -0.2544126510620117, mean p set: 0.44922778010368347The modified gen p mean: 0.45214930176734924, gen p mean: -0.25120413303375244, mean p set: 0.45262959599494934
loss_pred:0.04159832000732422, decouple_loss:0.027732795104384422
loss_pred:0.04182812198996544, decouple_loss:0.024400020018219948
2023-05-01 12:02:53 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.24730969965457916, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.23979420959949493, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.24202175438404083, mean p set: 0.4500633478164673
loss_pred:0.04451563209295273, decouple_loss:0.030628902837634087
loss_pred:0.042215071618556976, decouple_loss:0.03263286501169205
loss_pred:0.04348820447921753, decouple_loss:0.031055059283971786
WV_0_PC_1_EH_0_PS_40_15, loss: 0.04497825354337692, avg_mse: 0.04714968800544739
current test mse: 0.04715
Iteration: 351, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514136016368866, gen p mean: -0.24354742467403412, mean p set: 0.4518939256668091
The modified gen p mean: 0.4499928653240204, gen p mean: -0.2458583265542984, mean p set: 0.4504731595516205
The modified gen p mean: 0.4494360387325287, gen p mean: -0.24323178827762604, mean p set: 0.4499163329601288
loss_pred:0.04316798970103264, decouple_loss:0.02674093283712864
loss_pred:0.042795330286026, decouple_loss:0.029355555772781372
loss_pred:0.04075983539223671, decouple_loss:0.02537641115486622
Iteration: 352, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513486921787262, gen p mean: -0.2364131510257721, mean p set: 0.4518289566040039
loss_pred:0.0395754836499691, decouple_loss:0.02530357614159584
The modified gen p mean: 0.45027345418930054, gen p mean: -0.2410348653793335, mean p set: 0.45075374841690063The modified gen p mean: 0.45147398114204407, gen p mean: -0.2369230091571808, mean p set: 0.45195427536964417
loss_pred:0.04108811542391777, decouple_loss:0.02568463794887066
loss_pred:0.04150238633155823, decouple_loss:0.026782050728797913
Iteration: 353, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4512780010700226, gen p mean: -0.2485634982585907, mean p set: 0.45175832509994507
loss_pred:0.04168538376688957, decouple_loss:0.02613244764506817
The modified gen p mean: 0.4493926763534546, gen p mean: -0.24607956409454346, mean p set: 0.4498729407787323The modified gen p mean: 0.4501604437828064, gen p mean: -0.2407291680574417, mean p set: 0.4506407380104065
loss_pred:0.04265177249908447, decouple_loss:0.02417234145104885
loss_pred:0.04090096801519394, decouple_loss:0.027203992009162903
Iteration: 354, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45285388827323914, gen p mean: -0.24575960636138916, mean p set: 0.45333418250083923
loss_pred:0.0407937690615654, decouple_loss:0.02624312788248062
The modified gen p mean: 0.4511817693710327, gen p mean: -0.24441401660442352, mean p set: 0.4516620337963104The modified gen p mean: 0.44981178641319275, gen p mean: -0.24364037811756134, mean p set: 0.45029211044311523
loss_pred:0.04098891094326973, decouple_loss:0.027081238105893135
loss_pred:0.04169207066297531, decouple_loss:0.02702144719660282
Iteration: 355, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44892236590385437, gen p mean: -0.2527914047241211, mean p set: 0.44940266013145447
loss_pred:0.04166524484753609, decouple_loss:0.02583516389131546
The modified gen p mean: 0.44905152916908264, gen p mean: -0.25413039326667786, mean p set: 0.44953182339668274The modified gen p mean: 0.4528367221355438, gen p mean: -0.2570396363735199, mean p set: 0.4533170461654663
loss_pred:0.04129161685705185, decouple_loss:0.02700347825884819
loss_pred:0.04059809073805809, decouple_loss:0.02641308680176735
Iteration: 356, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4528837502002716, gen p mean: -0.2581018805503845, mean p set: 0.4533640444278717
loss_pred:0.04128488898277283, decouple_loss:0.027895191684365273
The modified gen p mean: 0.4511222541332245, gen p mean: -0.25625887513160706, mean p set: 0.4516025483608246The modified gen p mean: 0.4504871368408203, gen p mean: -0.2537664473056793, mean p set: 0.4509674608707428
loss_pred:0.04209129512310028, decouple_loss:0.0323096327483654
loss_pred:0.04172927886247635, decouple_loss:0.029017247259616852
Iteration: 357, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44903847575187683, gen p mean: -0.24206611514091492, mean p set: 0.44951876997947693
loss_pred:0.04046182334423065, decouple_loss:0.027138542383909225
The modified gen p mean: 0.4509528577327728, gen p mean: -0.24076412618160248, mean p set: 0.4514331519603729The modified gen p mean: 0.4512796401977539, gen p mean: -0.24183276295661926, mean p set: 0.4517599642276764
loss_pred:0.03992299363017082, decouple_loss:0.027074245736002922loss_pred:0.04071298986673355, decouple_loss:0.02702070213854313
Iteration: 358, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513408839702606, gen p mean: -0.24178656935691833, mean p set: 0.4518211781978607
loss_pred:0.04296381399035454, decouple_loss:0.028560400009155273
The modified gen p mean: 0.4493885636329651, gen p mean: -0.24175190925598145, mean p set: 0.4498688280582428The modified gen p mean: 0.4515511989593506, gen p mean: -0.24234993755817413, mean p set: 0.4520314931869507
loss_pred:0.04080459848046303, decouple_loss:0.024732453748583794
loss_pred:0.04099977761507034, decouple_loss:0.02660677768290043
Iteration: 359, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45277976989746094, gen p mean: -0.25413742661476135, mean p set: 0.45326003432273865
loss_pred:0.041326943784952164, decouple_loss:0.025645148009061813
The modified gen p mean: 0.44925540685653687, gen p mean: -0.2432587891817093, mean p set: 0.4497356712818146The modified gen p mean: 0.449867308139801, gen p mean: -0.2466738224029541, mean p set: 0.4503476321697235
loss_pred:0.040302079170942307, decouple_loss:0.026101993396878242
loss_pred:0.040764302015304565, decouple_loss:0.025739096105098724
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012001_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012001_3_24hr.npz
NaN value num: 0
Iteration: 360, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45060259103775024, gen p mean: -0.25648602843284607, mean p set: 0.45108291506767273
loss_pred:0.042158663272857666, decouple_loss:0.026418035849928856
The modified gen p mean: 0.4507247507572174, gen p mean: -0.2605193853378296, mean p set: 0.4512050449848175The modified gen p mean: 0.4506099224090576, gen p mean: -0.2591158449649811, mean p set: 0.4510902166366577
loss_pred:0.04245176166296005, decouple_loss:0.029261184856295586
loss_pred:0.04232199862599373, decouple_loss:0.027037883177399635
2023-05-01 12:05:27 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.24764390289783478, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.23945941030979156, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.2417704164981842, mean p set: 0.4500633478164673
loss_pred:0.04515805095434189, decouple_loss:0.03297942876815796
loss_pred:0.0426989421248436, decouple_loss:0.03433866426348686
loss_pred:0.04399310424923897, decouple_loss:0.03274283558130264
WV_0_PC_1_EH_0_PS_40_15, loss: 0.045617714524269104, avg_mse: 0.04787005856633186
current test mse: 0.04787
Iteration: 361, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44953253865242004, gen p mean: -0.24398472905158997, mean p set: 0.45001283288002014
The modified gen p mean: 0.4499624967575073, gen p mean: -0.2439025640487671, mean p set: 0.45044276118278503
The modified gen p mean: 0.45157793164253235, gen p mean: -0.24524225294589996, mean p set: 0.45205825567245483
loss_pred:0.04194417968392372, decouple_loss:0.027920275926589966
loss_pred:0.04251822456717491, decouple_loss:0.03052183799445629loss_pred:0.04196362569928169, decouple_loss:0.027625935152173042
Iteration: 362, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45202067494392395, gen p mean: -0.24362324178218842, mean p set: 0.45250096917152405
loss_pred:0.0425637811422348, decouple_loss:0.02836231328547001
The modified gen p mean: 0.4499184191226959, gen p mean: -0.23484428226947784, mean p set: 0.450398713350296The modified gen p mean: 0.4497433006763458, gen p mean: -0.23361828923225403, mean p set: 0.4502235949039459
loss_pred:0.04136057570576668, decouple_loss:0.02594757080078125
loss_pred:0.04121699556708336, decouple_loss:0.026759395375847816
Iteration: 363, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45107895135879517, gen p mean: -0.23753045499324799, mean p set: 0.45155924558639526
loss_pred:0.04270165041089058, decouple_loss:0.02518964745104313
The modified gen p mean: 0.4515479803085327, gen p mean: -0.2360527515411377, mean p set: 0.4520282447338104The modified gen p mean: 0.45139291882514954, gen p mean: -0.23704597353935242, mean p set: 0.45187318325042725
loss_pred:0.042537663131952286, decouple_loss:0.026133637875318527
loss_pred:0.04207327216863632, decouple_loss:0.026480544358491898
Iteration: 364, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45045652985572815, gen p mean: -0.24401763081550598, mean p set: 0.45093685388565063
loss_pred:0.041820228099823, decouple_loss:0.025209449231624603
The modified gen p mean: 0.45187345147132874, gen p mean: -0.25143110752105713, mean p set: 0.45235374569892883The modified gen p mean: 0.450859397649765, gen p mean: -0.24519497156143188, mean p set: 0.4513396918773651
loss_pred:0.0418853722512722, decouple_loss:0.029050059616565704
loss_pred:0.041651029139757156, decouple_loss:0.02601160854101181
Iteration: 365, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44859692454338074, gen p mean: -0.254564493894577, mean p set: 0.44907721877098083
loss_pred:0.04147205501794815, decouple_loss:0.025101331993937492
The modified gen p mean: 0.44909119606018066, gen p mean: -0.25179874897003174, mean p set: 0.44957149028778076The modified gen p mean: 0.44832876324653625, gen p mean: -0.24856670200824738, mean p set: 0.44880905747413635
loss_pred:0.04287883639335632, decouple_loss:0.02583058923482895
loss_pred:0.041594043374061584, decouple_loss:0.026385799050331116
Iteration: 366, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44808316230773926, gen p mean: -0.2536284327507019, mean p set: 0.44856342673301697
loss_pred:0.04214702174067497, decouple_loss:0.026663247495889664
The modified gen p mean: 0.44764724373817444, gen p mean: -0.24576373398303986, mean p set: 0.44812753796577454
The modified gen p mean: 0.451168417930603, gen p mean: -0.2517540156841278, mean p set: 0.4516487121582031
loss_pred:0.042087774723768234, decouple_loss:0.026091042906045914
loss_pred:0.041271522641181946, decouple_loss:0.025511756539344788
Iteration: 367, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4517090320587158, gen p mean: -0.2481440156698227, mean p set: 0.4521893560886383
loss_pred:0.04210443049669266, decouple_loss:0.028690675273537636
The modified gen p mean: 0.4504612982273102, gen p mean: -0.24817487597465515, mean p set: 0.4509415924549103The modified gen p mean: 0.4507182240486145, gen p mean: -0.24982568621635437, mean p set: 0.4511985182762146
loss_pred:0.04160299524664879, decouple_loss:0.028065375983715057
loss_pred:0.04121674969792366, decouple_loss:0.029833752661943436
Iteration: 368, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45011767745018005, gen p mean: -0.2523626387119293, mean p set: 0.45059797167778015
loss_pred:0.041648369282484055, decouple_loss:0.027659498155117035
The modified gen p mean: 0.4482850730419159, gen p mean: -0.24666543304920197, mean p set: 0.4487653374671936The modified gen p mean: 0.4477993845939636, gen p mean: -0.25254499912261963, mean p set: 0.4482796788215637
loss_pred:0.04165128991007805, decouple_loss:0.025908444076776505
loss_pred:0.04145843908190727, decouple_loss:0.026437906548380852
Iteration: 369, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500531256198883, gen p mean: -0.2598935067653656, mean p set: 0.4505334198474884
loss_pred:0.04219731688499451, decouple_loss:0.027586132287979126
The modified gen p mean: 0.44793349504470825, gen p mean: -0.26278769969940186, mean p set: 0.44841381907463074The modified gen p mean: 0.4506893754005432, gen p mean: -0.2692158818244934, mean p set: 0.4511696398258209
loss_pred:0.04064001888036728, decouple_loss:0.026260172948241234
loss_pred:0.04183483496308327, decouple_loss:0.03220013156533241
Iteration: 370, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448527067899704, gen p mean: -0.24974580109119415, mean p set: 0.44900739192962646
loss_pred:0.040551166981458664, decouple_loss:0.024667764082551003
The modified gen p mean: 0.4516884386539459, gen p mean: -0.2615493834018707, mean p set: 0.4521687626838684The modified gen p mean: 0.449003666639328, gen p mean: -0.2524377107620239, mean p set: 0.4494839310646057
loss_pred:0.04220730438828468, decouple_loss:0.026987632736563683
loss_pred:0.040574342012405396, decouple_loss:0.026628727093338966
2023-05-01 12:07:22 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.25296053290367126, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.24443161487579346, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.24736036360263824, mean p set: 0.4500633478164673
loss_pred:0.04390265792608261, decouple_loss:0.03197963163256645
loss_pred:0.0417369045317173, decouple_loss:0.03281984105706215
loss_pred:0.04267089441418648, decouple_loss:0.03187976032495499
WV_0_PC_1_EH_0_PS_40_15, loss: 0.04438146948814392, avg_mse: 0.046741731464862823
current test mse: 0.046742
Iteration: 371, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45210736989974976, gen p mean: -0.2540678083896637, mean p set: 0.45258763432502747
The modified gen p mean: 0.44979265332221985, gen p mean: -0.24895450472831726, mean p set: 0.45027294754981995
The modified gen p mean: 0.45140671730041504, gen p mean: -0.25033026933670044, mean p set: 0.45188701152801514
loss_pred:0.04022049158811569, decouple_loss:0.027065953239798546
loss_pred:0.041597772389650345, decouple_loss:0.027689451351761818
loss_pred:0.0416012741625309, decouple_loss:0.028411442413926125
Iteration: 372, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4510978162288666, gen p mean: -0.24800556898117065, mean p set: 0.4515781104564667
loss_pred:0.04149638116359711, decouple_loss:0.025989485904574394
The modified gen p mean: 0.44978296756744385, gen p mean: -0.2469247430562973, mean p set: 0.45026326179504395The modified gen p mean: 0.4512201249599457, gen p mean: -0.24618463218212128, mean p set: 0.4517004191875458
loss_pred:0.043722379952669144, decouple_loss:0.026448050513863564
loss_pred:0.041423652321100235, decouple_loss:0.02691040374338627
Iteration: 373, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45214930176734924, gen p mean: -0.2518432140350342, mean p set: 0.45262959599494934
loss_pred:0.039832618087530136, decouple_loss:0.027077339589595795
The modified gen p mean: 0.45025596022605896, gen p mean: -0.24641035497188568, mean p set: 0.45073628425598145The modified gen p mean: 0.4483596682548523, gen p mean: -0.24094891548156738, mean p set: 0.44883993268013
loss_pred:0.04004095867276192, decouple_loss:0.024104274809360504
loss_pred:0.04010896384716034, decouple_loss:0.025773487985134125
Iteration: 374, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44800230860710144, gen p mean: -0.24788622558116913, mean p set: 0.44848257303237915
loss_pred:0.040422823280096054, decouple_loss:0.025857295840978622
The modified gen p mean: 0.44839081168174744, gen p mean: -0.24914894998073578, mean p set: 0.44887110590934753The modified gen p mean: 0.4516427516937256, gen p mean: -0.2562870681285858, mean p set: 0.4521230459213257
loss_pred:0.04086042195558548, decouple_loss:0.025677340105175972
loss_pred:0.04165692999958992, decouple_loss:0.027970988303422928
Iteration: 375, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45089954137802124, gen p mean: -0.2621343731880188, mean p set: 0.45137983560562134
loss_pred:0.04051728546619415, decouple_loss:0.02784086763858795
The modified gen p mean: 0.4488142132759094, gen p mean: -0.2526644468307495, mean p set: 0.44929447770118713The modified gen p mean: 0.44834089279174805, gen p mean: -0.24838830530643463, mean p set: 0.44882118701934814
loss_pred:0.04081565886735916, decouple_loss:0.02735675498843193
loss_pred:0.04082204028964043, decouple_loss:0.02459672838449478
Iteration: 376, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45037874579429626, gen p mean: -0.2548317611217499, mean p set: 0.45085906982421875
loss_pred:0.041904378682374954, decouple_loss:0.026427334174513817
The modified gen p mean: 0.45109593868255615, gen p mean: -0.25656622648239136, mean p set: 0.45157620310783386The modified gen p mean: 0.4494893252849579, gen p mean: -0.2553413212299347, mean p set: 0.449969619512558
loss_pred:0.04149240255355835, decouple_loss:0.024857008829712868
loss_pred:0.04237433522939682, decouple_loss:0.024666257202625275
Iteration: 377, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502004384994507, gen p mean: -0.24696920812129974, mean p set: 0.4506807327270508
loss_pred:0.0417313352227211, decouple_loss:0.02770000696182251
The modified gen p mean: 0.4486802816390991, gen p mean: -0.2490902692079544, mean p set: 0.4491605758666992The modified gen p mean: 0.4480988383293152, gen p mean: -0.2507469356060028, mean p set: 0.4485791027545929
loss_pred:0.04038083925843239, decouple_loss:0.02472040429711342
loss_pred:0.04144090786576271, decouple_loss:0.024182867258787155
Iteration: 378, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497833847999573, gen p mean: -0.24772287905216217, mean p set: 0.4502636790275574
loss_pred:0.039450060576200485, decouple_loss:0.02399543672800064
The modified gen p mean: 0.4492226541042328, gen p mean: -0.2471623718738556, mean p set: 0.4497029781341553The modified gen p mean: 0.44874826073646545, gen p mean: -0.24626274406909943, mean p set: 0.44922852516174316
loss_pred:0.040157072246074677, decouple_loss:0.02467256784439087
loss_pred:0.0401393361389637, decouple_loss:0.023735225200653076
Iteration: 379, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486495554447174, gen p mean: -0.25305578112602234, mean p set: 0.4491298198699951
loss_pred:0.04010353237390518, decouple_loss:0.023753056302666664
The modified gen p mean: 0.450158029794693, gen p mean: -0.25273939967155457, mean p set: 0.4506383240222931The modified gen p mean: 0.4509420394897461, gen p mean: -0.2615508437156677, mean p set: 0.4514223337173462
loss_pred:0.04166014865040779, decouple_loss:0.025598732754588127
loss_pred:0.041304487735033035, decouple_loss:0.02691875956952572
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012001_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012001_3_24hr.npz
NaN value num: 0
Iteration: 380, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481518268585205, gen p mean: -0.25663214921951294, mean p set: 0.4486321210861206
loss_pred:0.04095853120088577, decouple_loss:0.02804442308843136
The modified gen p mean: 0.44767576456069946, gen p mean: -0.2622365951538086, mean p set: 0.44815605878829956The modified gen p mean: 0.44799819588661194, gen p mean: -0.2612278461456299, mean p set: 0.44847849011421204
loss_pred:0.039998576045036316, decouple_loss:0.030067503452301025
loss_pred:0.04188262298703194, decouple_loss:0.030083253979682922
2023-05-01 12:09:56 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.26424849033355713, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.2551564872264862, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.25843870639801025, mean p set: 0.4500633478164673
loss_pred:0.04285686835646629, decouple_loss:0.02776237390935421
loss_pred:0.040738143026828766, decouple_loss:0.027471447363495827
loss_pred:0.041859257966279984, decouple_loss:0.027080420404672623
WV_0_PC_1_EH_0_PS_40_15, loss: 0.04318999499082565, avg_mse: 0.045648809522390366
current test mse: 0.045649
Iteration: 381, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44639065861701965, gen p mean: -0.2620163857936859, mean p set: 0.44687098264694214
The modified gen p mean: 0.44825175404548645, gen p mean: -0.2653574049472809, mean p set: 0.44873204827308655
The modified gen p mean: 0.4466645419597626, gen p mean: -0.26086458563804626, mean p set: 0.44714486598968506
loss_pred:0.04369274154305458, decouple_loss:0.02682136371731758
loss_pred:0.04122147709131241, decouple_loss:0.027105623856186867
loss_pred:0.03999628871679306, decouple_loss:0.02935708314180374
Iteration: 382, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44694459438323975, gen p mean: -0.26290014386177063, mean p set: 0.44742488861083984
loss_pred:0.04302963241934776, decouple_loss:0.029259733855724335
The modified gen p mean: 0.44865885376930237, gen p mean: -0.2608715891838074, mean p set: 0.44913914799690247The modified gen p mean: 0.44811418652534485, gen p mean: -0.25707703828811646, mean p set: 0.44859448075294495
loss_pred:0.04422338679432869, decouple_loss:0.029585840180516243
loss_pred:0.04315914213657379, decouple_loss:0.029011309146881104
Iteration: 383, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44603416323661804, gen p mean: -0.2516441345214844, mean p set: 0.44651445746421814
loss_pred:0.039841342717409134, decouple_loss:0.02705368585884571
The modified gen p mean: 0.44770726561546326, gen p mean: -0.25534969568252563, mean p set: 0.44818755984306335The modified gen p mean: 0.44901183247566223, gen p mean: -0.2510875463485718, mean p set: 0.44949212670326233
loss_pred:0.04068790003657341, decouple_loss:0.02778332494199276
loss_pred:0.040777284651994705, decouple_loss:0.02608831226825714
Iteration: 384, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44708535075187683, gen p mean: -0.2513318359851837, mean p set: 0.4475656747817993
loss_pred:0.03994791582226753, decouple_loss:0.029613951221108437
The modified gen p mean: 0.44615438580513, gen p mean: -0.24839800596237183, mean p set: 0.4466347098350525The modified gen p mean: 0.44723355770111084, gen p mean: -0.24763977527618408, mean p set: 0.4477138817310333
loss_pred:0.04206530377268791, decouple_loss:0.027225568890571594
loss_pred:0.03979334607720375, decouple_loss:0.028601011261343956
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 385, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44782647490501404, gen p mean: -0.2453700602054596, mean p set: 0.4483067989349365
loss_pred:0.04246218875050545, decouple_loss:0.02769172564148903
The modified gen p mean: 0.44648075103759766, gen p mean: -0.24687102437019348, mean p set: 0.44696107506752014The modified gen p mean: 0.4466317892074585, gen p mean: -0.2491227090358734, mean p set: 0.4471120834350586
loss_pred:0.04242367297410965, decouple_loss:0.02760092355310917
loss_pred:0.04128618538379669, decouple_loss:0.027746202424168587
Iteration: 386, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44720178842544556, gen p mean: -0.2562355697154999, mean p set: 0.44768208265304565
loss_pred:0.03934961557388306, decouple_loss:0.026649970561265945
The modified gen p mean: 0.447226345539093, gen p mean: -0.2590298354625702, mean p set: 0.4477066397666931The modified gen p mean: 0.4470670819282532, gen p mean: -0.26728782057762146, mean p set: 0.44754740595817566
loss_pred:0.041345831006765366, decouple_loss:0.029564285650849342
loss_pred:0.042159367352724075, decouple_loss:0.026851564645767212
Iteration: 387, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483518898487091, gen p mean: -0.2593948543071747, mean p set: 0.4488321542739868
loss_pred:0.03954014927148819, decouple_loss:0.026486294344067574
The modified gen p mean: 0.44669008255004883, gen p mean: -0.2664043605327606, mean p set: 0.44717034697532654The modified gen p mean: 0.44653376936912537, gen p mean: -0.264212429523468, mean p set: 0.44701406359672546
loss_pred:0.04183698073029518, decouple_loss:0.03086739033460617
loss_pred:0.042241841554641724, decouple_loss:0.029386550188064575
Iteration: 388, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468749761581421, gen p mean: -0.26025840640068054, mean p set: 0.4473552703857422
loss_pred:0.04008448123931885, decouple_loss:0.027180539444088936
The modified gen p mean: 0.4465906322002411, gen p mean: -0.260821670293808, mean p set: 0.4470709264278412The modified gen p mean: 0.44826430082321167, gen p mean: -0.25763440132141113, mean p set: 0.4487445652484894
loss_pred:0.04196147248148918, decouple_loss:0.029028644785284996
loss_pred:0.04060729965567589, decouple_loss:0.02626797929406166
Iteration: 389, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4455767571926117, gen p mean: -0.2371968775987625, mean p set: 0.4460570514202118
loss_pred:0.03821703419089317, decouple_loss:0.02968338131904602
The modified gen p mean: 0.44843393564224243, gen p mean: -0.24086716771125793, mean p set: 0.4489142596721649The modified gen p mean: 0.4486105442047119, gen p mean: -0.24246768653392792, mean p set: 0.449090838432312
loss_pred:0.04096364974975586, decouple_loss:0.0258968323469162
loss_pred:0.03971932455897331, decouple_loss:0.027229340746998787
Iteration: 390, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44523462653160095, gen p mean: -0.23380713164806366, mean p set: 0.44571492075920105
loss_pred:0.03909482806921005, decouple_loss:0.02962138131260872
The modified gen p mean: 0.44601142406463623, gen p mean: -0.23155085742473602, mean p set: 0.44649171829223633The modified gen p mean: 0.44730597734451294, gen p mean: -0.2331436723470688, mean p set: 0.44778627157211304
loss_pred:0.04063914716243744, decouple_loss:0.02634277194738388
loss_pred:0.04173790290951729, decouple_loss:0.027215175330638885
2023-05-01 12:11:51 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.24564801156520844, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.23715806007385254, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.2395993173122406, mean p set: 0.4500633478164673
loss_pred:0.04187130928039551, decouple_loss:0.027823586016893387
loss_pred:0.03996414691209793, decouple_loss:0.02899169921875
loss_pred:0.04097158461809158, decouple_loss:0.028435008600354195
WV_0_PC_1_EH_0_PS_40_15, loss: 0.042356520891189575, avg_mse: 0.04454660415649414
current test mse: 0.044547
Iteration: 391, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477525055408478, gen p mean: -0.24490772187709808, mean p set: 0.44823282957077026
The modified gen p mean: 0.44639313220977783, gen p mean: -0.24562664330005646, mean p set: 0.44687342643737793
The modified gen p mean: 0.4466207027435303, gen p mean: -0.24516350030899048, mean p set: 0.44710099697113037
loss_pred:0.038580309599637985, decouple_loss:0.02594478242099285
loss_pred:0.040514279156923294, decouple_loss:0.0261289793998003
loss_pred:0.041788652539253235, decouple_loss:0.026523884385824203
Iteration: 392, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447291761636734, gen p mean: -0.2394431084394455, mean p set: 0.4477720260620117
loss_pred:0.041173964738845825, decouple_loss:0.02806207910180092
The modified gen p mean: 0.4472421705722809, gen p mean: -0.24685566127300262, mean p set: 0.44772249460220337The modified gen p mean: 0.4481533467769623, gen p mean: -0.24759820103645325, mean p set: 0.4486336410045624
loss_pred:0.03929538652300835, decouple_loss:0.027255721390247345
loss_pred:0.04176994413137436, decouple_loss:0.026436856016516685
Iteration: 393, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44729161262512207, gen p mean: -0.2356027215719223, mean p set: 0.44777190685272217
loss_pred:0.03859391063451767, decouple_loss:0.026027653366327286
The modified gen p mean: 0.4474366009235382, gen p mean: -0.2377232164144516, mean p set: 0.4479168951511383The modified gen p mean: 0.4464447498321533, gen p mean: -0.24623143672943115, mean p set: 0.4469250440597534
loss_pred:0.038514405488967896, decouple_loss:0.02580074965953827
loss_pred:0.0415465347468853, decouple_loss:0.02791169472038746
Iteration: 394, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475573003292084, gen p mean: -0.23445254564285278, mean p set: 0.44803762435913086
loss_pred:0.03968285024166107, decouple_loss:0.024928951635956764
The modified gen p mean: 0.4467603862285614, gen p mean: -0.23409408330917358, mean p set: 0.4472406804561615The modified gen p mean: 0.4481727182865143, gen p mean: -0.2338946908712387, mean p set: 0.4486530125141144
loss_pred:0.043139856308698654, decouple_loss:0.02801177278161049
loss_pred:0.04065325856208801, decouple_loss:0.026039792224764824
Iteration: 395, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475003480911255, gen p mean: -0.2450604885816574, mean p set: 0.4479806125164032
loss_pred:0.03980467468500137, decouple_loss:0.02531687170267105
The modified gen p mean: 0.4459710121154785, gen p mean: -0.24726656079292297, mean p set: 0.4464513063430786
The modified gen p mean: 0.448044091463089, gen p mean: -0.24663646519184113, mean p set: 0.4485243558883667
loss_pred:0.038230858743190765, decouple_loss:0.027699220925569534
loss_pred:0.04140957444906235, decouple_loss:0.026957962661981583
Iteration: 396, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44879624247550964, gen p mean: -0.26092007756233215, mean p set: 0.44927650690078735
loss_pred:0.0389164499938488, decouple_loss:0.027189264073967934
The modified gen p mean: 0.4462290108203888, gen p mean: -0.2596573829650879, mean p set: 0.4467092752456665The modified gen p mean: 0.44881632924079895, gen p mean: -0.26041674613952637, mean p set: 0.44929662346839905
loss_pred:0.041301608085632324, decouple_loss:0.025877442210912704
loss_pred:0.04101945832371712, decouple_loss:0.026814721524715424
Iteration: 397, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44699421525001526, gen p mean: -0.2572563886642456, mean p set: 0.44747447967529297
loss_pred:0.040690477937459946, decouple_loss:0.027240561321377754
The modified gen p mean: 0.44880780577659607, gen p mean: -0.26398688554763794, mean p set: 0.44928810000419617The modified gen p mean: 0.4470219612121582, gen p mean: -0.2630290687084198, mean p set: 0.4475022256374359
loss_pred:0.041000425815582275, decouple_loss:0.026797035709023476
loss_pred:0.03962930291891098, decouple_loss:0.025689633563160896
Iteration: 398, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476628601551056, gen p mean: -0.24174977838993073, mean p set: 0.4481431543827057
loss_pred:0.038612909615039825, decouple_loss:0.026365632191300392
The modified gen p mean: 0.44795510172843933, gen p mean: -0.24375933408737183, mean p set: 0.44843539595603943The modified gen p mean: 0.4457424283027649, gen p mean: -0.24327874183654785, mean p set: 0.4462227523326874
loss_pred:0.0380755253136158, decouple_loss:0.026569580659270287
loss_pred:0.03763106092810631, decouple_loss:0.027786819264292717
Iteration: 399, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479070007801056, gen p mean: -0.23617538809776306, mean p set: 0.4483872950077057
loss_pred:0.03959457576274872, decouple_loss:0.028493430465459824
The modified gen p mean: 0.4478665292263031, gen p mean: -0.23890143632888794, mean p set: 0.4483468234539032The modified gen p mean: 0.4470917880535126, gen p mean: -0.2370413839817047, mean p set: 0.44757208228111267
loss_pred:0.040195584297180176, decouple_loss:0.025790415704250336
loss_pred:0.038340989500284195, decouple_loss:0.026898764073848724
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012014_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012014_3_24hr.npz
NaN value num: 0
Iteration: 400, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44737324118614197, gen p mean: -0.24759702384471893, mean p set: 0.44785353541374207
loss_pred:0.041341669857501984, decouple_loss:0.03177788853645325
The modified gen p mean: 0.4481663703918457, gen p mean: -0.24492742121219635, mean p set: 0.4486466944217682The modified gen p mean: 0.4490087032318115, gen p mean: -0.2485499233007431, mean p set: 0.4494889974594116
loss_pred:0.04062888026237488, decouple_loss:0.029180079698562622
loss_pred:0.04152102395892143, decouple_loss:0.0317937470972538
2023-05-01 12:14:22 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.2670607566833496, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.2583407163619995, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.2619829475879669, mean p set: 0.4500633478164673
loss_pred:0.04150845855474472, decouple_loss:0.027481844648718834
loss_pred:0.03961855545639992, decouple_loss:0.02759651653468609
loss_pred:0.040638651698827744, decouple_loss:0.026946086436510086
WV_0_PC_1_EH_0_PS_40_15, loss: 0.04195563122630119, avg_mse: 0.044407572597265244
current test mse: 0.044408
Iteration: 401, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477286636829376, gen p mean: -0.26009589433670044, mean p set: 0.4482089579105377
The modified gen p mean: 0.4480758309364319, gen p mean: -0.2610143721103668, mean p set: 0.44855615496635437
The modified gen p mean: 0.4477505683898926, gen p mean: -0.2615765631198883, mean p set: 0.4482308626174927
loss_pred:0.042109280824661255, decouple_loss:0.02980956621468067
loss_pred:0.041687168180942535, decouple_loss:0.02839556895196438
loss_pred:0.0415346622467041, decouple_loss:0.028822949156165123
Iteration: 402, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44712862372398376, gen p mean: -0.25143930315971375, mean p set: 0.44760891795158386
loss_pred:0.04108153283596039, decouple_loss:0.027869589626789093
The modified gen p mean: 0.4473842680454254, gen p mean: -0.25673043727874756, mean p set: 0.4478645324707031The modified gen p mean: 0.4472653269767761, gen p mean: -0.25842925906181335, mean p set: 0.4477456510066986
loss_pred:0.04154101386666298, decouple_loss:0.027819931507110596
loss_pred:0.04086797684431076, decouple_loss:0.030153067782521248
Iteration: 403, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44856178760528564, gen p mean: -0.2485620677471161, mean p set: 0.44904205203056335
loss_pred:0.04136210307478905, decouple_loss:0.027524320408701897
The modified gen p mean: 0.44694724678993225, gen p mean: -0.25162187218666077, mean p set: 0.44742754101753235The modified gen p mean: 0.4478708803653717, gen p mean: -0.24641747772693634, mean p set: 0.4483511745929718
loss_pred:0.04153316468000412, decouple_loss:0.02760055847465992
loss_pred:0.04107313230633736, decouple_loss:0.02809353545308113
Iteration: 404, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44829726219177246, gen p mean: -0.24140265583992004, mean p set: 0.44877755641937256
loss_pred:0.0419311486184597, decouple_loss:0.02548140101134777
The modified gen p mean: 0.4475277066230774, gen p mean: -0.24681060016155243, mean p set: 0.4480080008506775The modified gen p mean: 0.4461727440357208, gen p mean: -0.24043813347816467, mean p set: 0.44665300846099854
loss_pred:0.04087585583329201, decouple_loss:0.027315331622958183
loss_pred:0.041006214916706085, decouple_loss:0.027228474617004395
Iteration: 405, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475401043891907, gen p mean: -0.2444004863500595, mean p set: 0.44802039861679077
loss_pred:0.039490941911935806, decouple_loss:0.02692403830587864
The modified gen p mean: 0.4472672641277313, gen p mean: -0.23989444971084595, mean p set: 0.4477475583553314The modified gen p mean: 0.44696977734565735, gen p mean: -0.24100595712661743, mean p set: 0.44745007157325745
loss_pred:0.04016934335231781, decouple_loss:0.02744162827730179
loss_pred:0.0407002717256546, decouple_loss:0.026380177587270737
Iteration: 406, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472610652446747, gen p mean: -0.24803173542022705, mean p set: 0.4477413594722748
loss_pred:0.04114280268549919, decouple_loss:0.026061149314045906
The modified gen p mean: 0.44723832607269287, gen p mean: -0.2511958181858063, mean p set: 0.44771865010261536The modified gen p mean: 0.4475630521774292, gen p mean: -0.24859409034252167, mean p set: 0.4480433166027069
loss_pred:0.039958659559488297, decouple_loss:0.02668454684317112
loss_pred:0.04024702310562134, decouple_loss:0.025370648130774498
Iteration: 407, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44873046875, gen p mean: -0.249803826212883, mean p set: 0.4492107927799225
loss_pred:0.041523005813360214, decouple_loss:0.026253405958414078
The modified gen p mean: 0.4474487006664276, gen p mean: -0.2557861804962158, mean p set: 0.4479289650917053The modified gen p mean: 0.4477446377277374, gen p mean: -0.2552752196788788, mean p set: 0.4482249617576599
loss_pred:0.04179346188902855, decouple_loss:0.02646666392683983
loss_pred:0.04034248739480972, decouple_loss:0.026885442435741425
Iteration: 408, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44683802127838135, gen p mean: -0.2456299066543579, mean p set: 0.44731831550598145
loss_pred:0.040857188403606415, decouple_loss:0.02724161557853222
The modified gen p mean: 0.44783875346183777, gen p mean: -0.251863032579422, mean p set: 0.44831904768943787The modified gen p mean: 0.4482654631137848, gen p mean: -0.248665452003479, mean p set: 0.4487457573413849
loss_pred:0.04127585515379906, decouple_loss:0.028113773092627525
loss_pred:0.041603535413742065, decouple_loss:0.025192102417349815
Iteration: 409, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477365016937256, gen p mean: -0.25278398394584656, mean p set: 0.44821682572364807
loss_pred:0.041646525263786316, decouple_loss:0.024020686745643616
The modified gen p mean: 0.4468141496181488, gen p mean: -0.25226637721061707, mean p set: 0.4472944438457489
The modified gen p mean: 0.4478815495967865, gen p mean: -0.24846699833869934, mean p set: 0.4483618438243866
loss_pred:0.04037808999419212, decouple_loss:0.026449143886566162
loss_pred:0.0397462323307991, decouple_loss:0.025936586782336235
Iteration: 410, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44780614972114563, gen p mean: -0.25525417923927307, mean p set: 0.4482864737510681
loss_pred:0.040563613176345825, decouple_loss:0.02634274587035179
The modified gen p mean: 0.44761139154434204, gen p mean: -0.2564542293548584, mean p set: 0.4480917155742645The modified gen p mean: 0.4477596580982208, gen p mean: -0.2547796964645386, mean p set: 0.4482399523258209
loss_pred:0.04140779376029968, decouple_loss:0.02636648155748844
loss_pred:0.04129435122013092, decouple_loss:0.026526009663939476
2023-05-01 12:16:17 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.26378053426742554, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.2564975321292877, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.2588818073272705, mean p set: 0.4500633478164673
loss_pred:0.040972139686346054, decouple_loss:0.025004517287015915
loss_pred:0.03907297924160957, decouple_loss:0.025540513917803764
loss_pred:0.04002254828810692, decouple_loss:0.024965103715658188
WV_0_PC_1_EH_0_PS_40_15, loss: 0.04128105938434601, avg_mse: 0.04377623274922371
current test mse: 0.043776
Iteration: 411, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482875466346741, gen p mean: -0.25578927993774414, mean p set: 0.4487678110599518
The modified gen p mean: 0.44831040501594543, gen p mean: -0.25837332010269165, mean p set: 0.44879069924354553
The modified gen p mean: 0.44754457473754883, gen p mean: -0.25860726833343506, mean p set: 0.4480248689651489
loss_pred:0.03932199627161026, decouple_loss:0.023998379707336426
loss_pred:0.03947029635310173, decouple_loss:0.025027824565768242loss_pred:0.039851706475019455, decouple_loss:0.024259556084871292
Iteration: 412, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44798049330711365, gen p mean: -0.2630135416984558, mean p set: 0.44846081733703613
loss_pred:0.04057662561535835, decouple_loss:0.02553391084074974
The modified gen p mean: 0.4474486708641052, gen p mean: -0.26415568590164185, mean p set: 0.44792893528938293The modified gen p mean: 0.4473441243171692, gen p mean: -0.25868716835975647, mean p set: 0.4478244483470917
loss_pred:0.040878064930438995, decouple_loss:0.02535683661699295
loss_pred:0.040969740599393845, decouple_loss:0.024600302800536156
Iteration: 413, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476693272590637, gen p mean: -0.25672003626823425, mean p set: 0.44814959168434143
loss_pred:0.039498794823884964, decouple_loss:0.025076860561966896
The modified gen p mean: 0.4488472044467926, gen p mean: -0.25678640604019165, mean p set: 0.4493274986743927The modified gen p mean: 0.44658082723617554, gen p mean: -0.2589610815048218, mean p set: 0.44706112146377563
loss_pred:0.040341559797525406, decouple_loss:0.025511933490633965
loss_pred:0.04052824154496193, decouple_loss:0.026264842599630356
Iteration: 414, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489087760448456, gen p mean: -0.24771030247211456, mean p set: 0.4493890404701233
loss_pred:0.040272682905197144, decouple_loss:0.026090040802955627
The modified gen p mean: 0.44742661714553833, gen p mean: -0.2550787627696991, mean p set: 0.4479069411754608The modified gen p mean: 0.44612348079681396, gen p mean: -0.24761977791786194, mean p set: 0.44660380482673645
loss_pred:0.0415659062564373, decouple_loss:0.023535676300525665
loss_pred:0.040743567049503326, decouple_loss:0.0252686757594347
Iteration: 415, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483383893966675, gen p mean: -0.24510490894317627, mean p set: 0.4488186836242676
loss_pred:0.04052845761179924, decouple_loss:0.0249981340020895
The modified gen p mean: 0.44722214341163635, gen p mean: -0.2525298297405243, mean p set: 0.44770246744155884The modified gen p mean: 0.4473407566547394, gen p mean: -0.2479490488767624, mean p set: 0.4478210508823395
loss_pred:0.03947322815656662, decouple_loss:0.024193722754716873
loss_pred:0.04049951955676079, decouple_loss:0.024587295949459076
Iteration: 416, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44758841395378113, gen p mean: -0.2570306062698364, mean p set: 0.44806867837905884
loss_pred:0.03992515802383423, decouple_loss:0.024388635531067848
The modified gen p mean: 0.44771137833595276, gen p mean: -0.2525342106819153, mean p set: 0.44819164276123047The modified gen p mean: 0.44669976830482483, gen p mean: -0.25204795598983765, mean p set: 0.4471800923347473
loss_pred:0.04130911827087402, decouple_loss:0.022878941148519516
loss_pred:0.03921690583229065, decouple_loss:0.023306120187044144
Iteration: 417, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44706377387046814, gen p mean: -0.2564927339553833, mean p set: 0.44754406809806824
loss_pred:0.04053556174039841, decouple_loss:0.02418113872408867
The modified gen p mean: 0.44780266284942627, gen p mean: -0.26291704177856445, mean p set: 0.44828295707702637The modified gen p mean: 0.4473603069782257, gen p mean: -0.25297728180885315, mean p set: 0.4478406012058258
loss_pred:0.04082433879375458, decouple_loss:0.022843847051262856
loss_pred:0.04070622846484184, decouple_loss:0.0240918155759573
Iteration: 418, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44822150468826294, gen p mean: -0.25815731287002563, mean p set: 0.44870179891586304
loss_pred:0.039092257618904114, decouple_loss:0.026150749996304512
The modified gen p mean: 0.44838187098503113, gen p mean: -0.25455525517463684, mean p set: 0.4488621652126312The modified gen p mean: 0.44775915145874023, gen p mean: -0.2599121630191803, mean p set: 0.44823944568634033
loss_pred:0.040679704397916794, decouple_loss:0.023386085405945778
loss_pred:0.04004928842186928, decouple_loss:0.02437322400510311
Iteration: 419, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471328556537628, gen p mean: -0.2509284019470215, mean p set: 0.4476131498813629
loss_pred:0.04007439315319061, decouple_loss:0.024819297716021538
The modified gen p mean: 0.4476584792137146, gen p mean: -0.2552899122238159, mean p set: 0.4481387734413147The modified gen p mean: 0.4471362233161926, gen p mean: -0.2550933361053467, mean p set: 0.44761648774147034
loss_pred:0.04034234210848808, decouple_loss:0.024968288838863373
loss_pred:0.04020840674638748, decouple_loss:0.023881344124674797
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012007_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012007_3_24hr.npz
NaN value num: 0
Iteration: 420, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45046982169151306, gen p mean: -0.25805696845054626, mean p set: 0.45095011591911316
loss_pred:0.04011957719922066, decouple_loss:0.028333429247140884
The modified gen p mean: 0.45170649886131287, gen p mean: -0.260621577501297, mean p set: 0.4521867632865906The modified gen p mean: 0.4509778320789337, gen p mean: -0.2585010826587677, mean p set: 0.4514580965042114
loss_pred:0.03970601037144661, decouple_loss:0.027392299845814705
loss_pred:0.04065784811973572, decouple_loss:0.026121148839592934
2023-05-01 12:18:49 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.2719074785709381, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.2646484971046448, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.26686540246009827, mean p set: 0.4500633478164673
loss_pred:0.04060376062989235, decouple_loss:0.02552969753742218
loss_pred:0.03964408114552498, decouple_loss:0.025262070819735527loss_pred:0.03861048445105553, decouple_loss:0.025769328698515892
WV_0_PC_1_EH_0_PS_40_15, loss: 0.04089546203613281, avg_mse: 0.04341588541865349
current test mse: 0.043416
Iteration: 421, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501040279865265, gen p mean: -0.2614051401615143, mean p set: 0.4505843222141266
The modified gen p mean: 0.450214147567749, gen p mean: -0.2679358720779419, mean p set: 0.4506944417953491
The modified gen p mean: 0.45146384835243225, gen p mean: -0.26347607374191284, mean p set: 0.45194417238235474
loss_pred:0.04059649631381035, decouple_loss:0.027818920090794563
loss_pred:0.041606273502111435, decouple_loss:0.027232635766267776
loss_pred:0.04003171995282173, decouple_loss:0.02659413032233715
Iteration: 422, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45218247175216675, gen p mean: -0.2682802081108093, mean p set: 0.45266276597976685
loss_pred:0.040960390120744705, decouple_loss:0.02637057565152645
The modified gen p mean: 0.45161172747612, gen p mean: -0.266369104385376, mean p set: 0.4520919919013977The modified gen p mean: 0.4500962197780609, gen p mean: -0.2669874131679535, mean p set: 0.450576514005661
loss_pred:0.03968946263194084, decouple_loss:0.026997316628694534
loss_pred:0.03959774598479271, decouple_loss:0.02722177840769291
Iteration: 423, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4519668221473694, gen p mean: -0.2673424184322357, mean p set: 0.45244714617729187
loss_pred:0.03975054994225502, decouple_loss:0.02672363817691803
The modified gen p mean: 0.4531993865966797, gen p mean: -0.26557064056396484, mean p set: 0.4536796808242798The modified gen p mean: 0.45131629705429077, gen p mean: -0.26135653257369995, mean p set: 0.45179659128189087
loss_pred:0.040783412754535675, decouple_loss:0.027801649644970894
loss_pred:0.04056624323129654, decouple_loss:0.027008071541786194
Iteration: 424, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.451825886964798, gen p mean: -0.27284345030784607, mean p set: 0.45230618119239807
The modified gen p mean: 0.44948071241378784, gen p mean: -0.2712387442588806, mean p set: 0.44996097683906555
loss_pred:0.04159912094473839, decouple_loss:0.02604040689766407
loss_pred:0.03979252278804779, decouple_loss:0.025151308625936508
The modified gen p mean: 0.45197054743766785, gen p mean: -0.27205100655555725, mean p set: 0.45245081186294556
loss_pred:0.03976117819547653, decouple_loss:0.027732811868190765
Iteration: 425, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4518858790397644, gen p mean: -0.26860669255256653, mean p set: 0.4523661732673645
loss_pred:0.040514662861824036, decouple_loss:0.025042522698640823
The modified gen p mean: 0.45053309202194214, gen p mean: -0.26642128825187683, mean p set: 0.45101335644721985The modified gen p mean: 0.4494204819202423, gen p mean: -0.2671746611595154, mean p set: 0.44990074634552
loss_pred:0.04077207297086716, decouple_loss:0.02532784454524517
loss_pred:0.03954359143972397, decouple_loss:0.025039808824658394
Iteration: 426, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45251888036727905, gen p mean: -0.27787405252456665, mean p set: 0.45299920439720154
loss_pred:0.04080447554588318, decouple_loss:0.025141065940260887
The modified gen p mean: 0.45007914304733276, gen p mean: -0.27627310156822205, mean p set: 0.4505594074726105The modified gen p mean: 0.4545752704143524, gen p mean: -0.28026822209358215, mean p set: 0.4550555646419525
loss_pred:0.039918601512908936, decouple_loss:0.026602502912282944
loss_pred:0.038973234593868256, decouple_loss:0.025953149423003197
Iteration: 427, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4530189633369446, gen p mean: -0.28489819169044495, mean p set: 0.4534992575645447
The modified gen p mean: 0.4503884017467499, gen p mean: -0.2770426273345947, mean p set: 0.45086869597435
loss_pred:0.04023849964141846, decouple_loss:0.02403428591787815
loss_pred:0.041078612208366394, decouple_loss:0.024171626195311546
The modified gen p mean: 0.45125308632850647, gen p mean: -0.27838873863220215, mean p set: 0.45173338055610657
loss_pred:0.040377747267484665, decouple_loss:0.026596231386065483
Iteration: 428, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4534832239151001, gen p mean: -0.2855663299560547, mean p set: 0.4539635181427002
loss_pred:0.04022163897752762, decouple_loss:0.02522735856473446
The modified gen p mean: 0.448466032743454, gen p mean: -0.27796798944473267, mean p set: 0.4489463269710541
The modified gen p mean: 0.44957563281059265, gen p mean: -0.2775198519229889, mean p set: 0.45005589723587036
loss_pred:0.039731983095407486, decouple_loss:0.024242958053946495
loss_pred:0.039128709584474564, decouple_loss:0.02374006062746048
Iteration: 429, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4517209529876709, gen p mean: -0.2775636613368988, mean p set: 0.452201247215271
loss_pred:0.04076962545514107, decouple_loss:0.024870863184332848
The modified gen p mean: 0.4523911774158478, gen p mean: -0.2775823771953583, mean p set: 0.4528714418411255The modified gen p mean: 0.4508230984210968, gen p mean: -0.27529817819595337, mean p set: 0.4513033628463745
loss_pred:0.03983718529343605, decouple_loss:0.02510274574160576
loss_pred:0.039569418877363205, decouple_loss:0.025157269090414047
Iteration: 430, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513186514377594, gen p mean: -0.2696220576763153, mean p set: 0.4517989158630371
loss_pred:0.040002550929784775, decouple_loss:0.023311372846364975
The modified gen p mean: 0.45008569955825806, gen p mean: -0.2683596611022949, mean p set: 0.45056599378585815The modified gen p mean: 0.4512324333190918, gen p mean: -0.27227938175201416, mean p set: 0.45171278715133667
loss_pred:0.04113639518618584, decouple_loss:0.0231188852339983
loss_pred:0.040880315005779266, decouple_loss:0.023767050355672836
2023-05-01 12:20:44 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.27777957916259766, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.26961129903793335, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.2731306850910187, mean p set: 0.4500633478164673
loss_pred:0.04104446619749069, decouple_loss:0.027256624773144722
loss_pred:0.03896733745932579, decouple_loss:0.027328908443450928
loss_pred:0.04010077565908432, decouple_loss:0.026722081005573273
WV_0_PC_1_EH_0_PS_40_15, loss: 0.04139265418052673, avg_mse: 0.044315923005342484
current test mse: 0.044316
Iteration: 431, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45516249537467957, gen p mean: -0.2804984152317047, mean p set: 0.45564278960227966
The modified gen p mean: 0.4518056809902191, gen p mean: -0.27128633856773376, mean p set: 0.4522860050201416
The modified gen p mean: 0.45285338163375854, gen p mean: -0.2735772430896759, mean p set: 0.45333370566368103
loss_pred:0.040165603160858154, decouple_loss:0.024103229865431786
loss_pred:0.03853609785437584, decouple_loss:0.025234142318367958loss_pred:0.03921130299568176, decouple_loss:0.025485629215836525
Iteration: 432, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4516301155090332, gen p mean: -0.27801769971847534, mean p set: 0.4521104097366333
loss_pred:0.03833174332976341, decouple_loss:0.02230919525027275
The modified gen p mean: 0.45149412751197815, gen p mean: -0.28311631083488464, mean p set: 0.45197439193725586The modified gen p mean: 0.44939470291137695, gen p mean: -0.2832998037338257, mean p set: 0.44987502694129944
loss_pred:0.039341334253549576, decouple_loss:0.023530904203653336
loss_pred:0.038980044424533844, decouple_loss:0.02369030937552452
Iteration: 433, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499392807483673, gen p mean: -0.282943993806839, mean p set: 0.450419545173645
loss_pred:0.04054920747876167, decouple_loss:0.023327723145484924
The modified gen p mean: 0.45147705078125, gen p mean: -0.2898833751678467, mean p set: 0.4519573748111725The modified gen p mean: 0.45448148250579834, gen p mean: -0.2949569821357727, mean p set: 0.45496177673339844
loss_pred:0.03974274918437004, decouple_loss:0.023790346458554268
loss_pred:0.038433048874139786, decouple_loss:0.02409566193819046
Iteration: 434, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45036694407463074, gen p mean: -0.2877890169620514, mean p set: 0.45084720849990845
loss_pred:0.039056453853845596, decouple_loss:0.02521001361310482
The modified gen p mean: 0.4511910676956177, gen p mean: -0.2915256917476654, mean p set: 0.4516713619232178The modified gen p mean: 0.45001882314682007, gen p mean: -0.2966775596141815, mean p set: 0.45049911737442017
loss_pred:0.03995944932103157, decouple_loss:0.02489464171230793
loss_pred:0.038978416472673416, decouple_loss:0.02700704149901867
Iteration: 435, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503123462200165, gen p mean: -0.2991149425506592, mean p set: 0.45079267024993896
loss_pred:0.03904761001467705, decouple_loss:0.023818591609597206
The modified gen p mean: 0.4534813463687897, gen p mean: -0.2986598312854767, mean p set: 0.4539616107940674The modified gen p mean: 0.45081081986427307, gen p mean: -0.2940213084220886, mean p set: 0.45129111409187317
loss_pred:0.040311504155397415, decouple_loss:0.024279216304421425
loss_pred:0.03891124576330185, decouple_loss:0.024549558758735657
Iteration: 436, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4517892897129059, gen p mean: -0.29073962569236755, mean p set: 0.452269583940506
loss_pred:0.03833997994661331, decouple_loss:0.023609386757016182
The modified gen p mean: 0.45176780223846436, gen p mean: -0.2937162518501282, mean p set: 0.45224812626838684The modified gen p mean: 0.44842666387557983, gen p mean: -0.2869580090045929, mean p set: 0.44890692830085754
loss_pred:0.03793265298008919, decouple_loss:0.02413247339427471
loss_pred:0.03985583409667015, decouple_loss:0.024044668301939964
Iteration: 437, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4515712857246399, gen p mean: -0.28073304891586304, mean p set: 0.4520516097545624
loss_pred:0.03804243728518486, decouple_loss:0.023274600505828857
The modified gen p mean: 0.45173612236976624, gen p mean: -0.28443989157676697, mean p set: 0.45221641659736633The modified gen p mean: 0.45048457384109497, gen p mean: -0.27883994579315186, mean p set: 0.45096486806869507
loss_pred:0.039385732263326645, decouple_loss:0.02268931455910206
loss_pred:0.040491487830877304, decouple_loss:0.02242237702012062
Iteration: 438, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497041702270508, gen p mean: -0.28551292419433594, mean p set: 0.4501844644546509
loss_pred:0.039733223617076874, decouple_loss:0.022399822250008583
The modified gen p mean: 0.451246976852417, gen p mean: -0.2884948253631592, mean p set: 0.4517273008823395The modified gen p mean: 0.4498804211616516, gen p mean: -0.2842392921447754, mean p set: 0.4503606855869293
loss_pred:0.03888184577226639, decouple_loss:0.02366432175040245
loss_pred:0.04008413106203079, decouple_loss:0.022099986672401428
Iteration: 439, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45101702213287354, gen p mean: -0.2939511239528656, mean p set: 0.45149728655815125
loss_pred:0.03959861397743225, decouple_loss:0.022332023829221725
The modified gen p mean: 0.4496087431907654, gen p mean: -0.30134961009025574, mean p set: 0.4500890374183655The modified gen p mean: 0.45065465569496155, gen p mean: -0.29941654205322266, mean p set: 0.45113492012023926
loss_pred:0.038816265761852264, decouple_loss:0.02222784422338009
loss_pred:0.0397784523665905, decouple_loss:0.022203221917152405
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012019_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012019_3_24hr.npz
NaN value num: 0
Iteration: 440, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44697052240371704, gen p mean: -0.3090361952781677, mean p set: 0.44745081663131714
loss_pred:0.04099889472126961, decouple_loss:0.027143269777297974
The modified gen p mean: 0.44948768615722656, gen p mean: -0.3084491491317749, mean p set: 0.44996798038482666The modified gen p mean: 0.4479981064796448, gen p mean: -0.30644282698631287, mean p set: 0.44847843050956726
loss_pred:0.041699107736349106, decouple_loss:0.025638405233621597
loss_pred:0.04120330885052681, decouple_loss:0.02569746971130371
2023-05-01 12:23:19 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.30857786536216736, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830535888672, gen p mean: -0.30308082699775696, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.29873931407928467, mean p set: 0.45035696029663086
loss_pred:0.040160078555345535, decouple_loss:0.02567129023373127
loss_pred:0.03936608135700226, decouple_loss:0.024748213589191437
loss_pred:0.0383157953619957, decouple_loss:0.02496076002717018
WV_0_PC_1_EH_0_PS_40_15, loss: 0.040536992251873016, avg_mse: 0.043188080191612244
current test mse: 0.043188
Iteration: 441, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474480450153351, gen p mean: -0.3036155700683594, mean p set: 0.4479283094406128
The modified gen p mean: 0.4475134015083313, gen p mean: -0.3041309416294098, mean p set: 0.4479937255382538
The modified gen p mean: 0.4478062689304352, gen p mean: -0.2990860641002655, mean p set: 0.4482865631580353
loss_pred:0.041295263916254044, decouple_loss:0.023892080411314964
loss_pred:0.04043729230761528, decouple_loss:0.025204423815011978
loss_pred:0.040223944932222366, decouple_loss:0.024525301530957222
Iteration: 442, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494367837905884, gen p mean: -0.2862264811992645, mean p set: 0.4499170780181885
loss_pred:0.03978705778717995, decouple_loss:0.024127710610628128
The modified gen p mean: 0.4486750662326813, gen p mean: -0.27932873368263245, mean p set: 0.44915536046028137The modified gen p mean: 0.447001188993454, gen p mean: -0.28715261816978455, mean p set: 0.4474814832210541
loss_pred:0.0405593104660511, decouple_loss:0.024602120742201805
loss_pred:0.041473764926195145, decouple_loss:0.024825099855661392
Iteration: 443, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501849412918091, gen p mean: -0.2795679271221161, mean p set: 0.4506652057170868
loss_pred:0.03873502090573311, decouple_loss:0.02438010461628437
The modified gen p mean: 0.44869571924209595, gen p mean: -0.279777467250824, mean p set: 0.44917601346969604The modified gen p mean: 0.4491023123264313, gen p mean: -0.2759096324443817, mean p set: 0.44958263635635376
loss_pred:0.04015704244375229, decouple_loss:0.02521873451769352
loss_pred:0.04166071489453316, decouple_loss:0.02577241323888302
Iteration: 444, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44812846183776855, gen p mean: -0.27930551767349243, mean p set: 0.44860872626304626
loss_pred:0.03874928504228592, decouple_loss:0.02476653642952442
The modified gen p mean: 0.44730859994888306, gen p mean: -0.28075119853019714, mean p set: 0.44778892397880554The modified gen p mean: 0.4495876133441925, gen p mean: -0.2861687242984772, mean p set: 0.4500678777694702
loss_pred:0.04028404504060745, decouple_loss:0.025172069668769836
loss_pred:0.041247375309467316, decouple_loss:0.023984063416719437
Iteration: 445, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449787974357605, gen p mean: -0.29181593656539917, mean p set: 0.4502682387828827
loss_pred:0.04037442058324814, decouple_loss:0.026476362720131874
The modified gen p mean: 0.4487517476081848, gen p mean: -0.2879270017147064, mean p set: 0.4492320418357849The modified gen p mean: 0.4490108788013458, gen p mean: -0.28862515091896057, mean p set: 0.44949114322662354
loss_pred:0.04040367901325226, decouple_loss:0.024852760136127472
loss_pred:0.040104325860738754, decouple_loss:0.02556912787258625
Iteration: 446, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475889503955841, gen p mean: -0.29058215022087097, mean p set: 0.4480692446231842
loss_pred:0.039687808603048325, decouple_loss:0.024812614545226097
The modified gen p mean: 0.44840845465660095, gen p mean: -0.29133889079093933, mean p set: 0.44888877868652344The modified gen p mean: 0.44954660534858704, gen p mean: -0.28526318073272705, mean p set: 0.45002689957618713
loss_pred:0.04141727834939957, decouple_loss:0.026715977117419243
loss_pred:0.03909614309668541, decouple_loss:0.023800766095519066
Iteration: 447, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44905567169189453, gen p mean: -0.2776462435722351, mean p set: 0.44953596591949463
loss_pred:0.040248434990644455, decouple_loss:0.024663809686899185
The modified gen p mean: 0.4484270215034485, gen p mean: -0.2810750901699066, mean p set: 0.4489073157310486The modified gen p mean: 0.44943660497665405, gen p mean: -0.27950745820999146, mean p set: 0.44991692900657654
loss_pred:0.0408492237329483, decouple_loss:0.024649038910865784
loss_pred:0.042976994067430496, decouple_loss:0.024868180975317955
Iteration: 448, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44958382844924927, gen p mean: -0.26979365944862366, mean p set: 0.45006415247917175
loss_pred:0.0425875224173069, decouple_loss:0.023462330922484398
The modified gen p mean: 0.44989821314811707, gen p mean: -0.2715197801589966, mean p set: 0.45037850737571716The modified gen p mean: 0.4493815302848816, gen p mean: -0.27363160252571106, mean p set: 0.4498618543148041
loss_pred:0.04067362844944, decouple_loss:0.023834779858589172
loss_pred:0.038768913596868515, decouple_loss:0.02273455075919628
Iteration: 449, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44962504506111145, gen p mean: -0.273843377828598, mean p set: 0.45010536909103394
loss_pred:0.040965911000967026, decouple_loss:0.02429652400314808
The modified gen p mean: 0.4495446979999542, gen p mean: -0.27031266689300537, mean p set: 0.45002496242523193The modified gen p mean: 0.45018404722213745, gen p mean: -0.2770373225212097, mean p set: 0.45066434144973755
loss_pred:0.040970493108034134, decouple_loss:0.024265795946121216
loss_pred:0.04025782644748688, decouple_loss:0.024692852050065994
Iteration: 450, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484054148197174, gen p mean: -0.2753158509731293, mean p set: 0.4488857388496399
loss_pred:0.04060826078057289, decouple_loss:0.02379740960896015
The modified gen p mean: 0.44789645075798035, gen p mean: -0.27007704973220825, mean p set: 0.44837674498558044The modified gen p mean: 0.44856566190719604, gen p mean: -0.2707040309906006, mean p set: 0.44904592633247375
loss_pred:0.04158938303589821, decouple_loss:0.024369703605771065
loss_pred:0.03866993263363838, decouple_loss:0.02426714077591896
2023-05-01 12:25:15 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.2855522334575653, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.27729976177215576, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.2809309661388397, mean p set: 0.4500633478164673
loss_pred:0.03991316258907318, decouple_loss:0.02501237578690052
loss_pred:0.038028959184885025, decouple_loss:0.02632826939225197
loss_pred:0.03905187547206879, decouple_loss:0.024798035621643066
WV_0_PC_1_EH_0_PS_40_15, loss: 0.0402669794857502, avg_mse: 0.04299847036600113
current test mse: 0.042998
Iteration: 451, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503835141658783, gen p mean: -0.28387680649757385, mean p set: 0.4508638381958008
The modified gen p mean: 0.4479564130306244, gen p mean: -0.2755841612815857, mean p set: 0.4484367072582245
The modified gen p mean: 0.44899827241897583, gen p mean: -0.2815651297569275, mean p set: 0.4494785666465759
loss_pred:0.04145670682191849, decouple_loss:0.023092249408364296
loss_pred:0.038208428770303726, decouple_loss:0.022692598402500153loss_pred:0.040162231773138046, decouple_loss:0.023274915292859077
Iteration: 452, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491044878959656, gen p mean: -0.2797040045261383, mean p set: 0.4495847821235657
loss_pred:0.03884563595056534, decouple_loss:0.022888725623488426
The modified gen p mean: 0.447456419467926, gen p mean: -0.2759989798069, mean p set: 0.4479367434978485The modified gen p mean: 0.45032182335853577, gen p mean: -0.27861836552619934, mean p set: 0.45080211758613586
loss_pred:0.04066651314496994, decouple_loss:0.024400796741247177
loss_pred:0.03948836773633957, decouple_loss:0.023068182170391083
Iteration: 453, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469609260559082, gen p mean: -0.2772504985332489, mean p set: 0.4474412202835083
loss_pred:0.039755187928676605, decouple_loss:0.023378264158964157
The modified gen p mean: 0.4485195279121399, gen p mean: -0.27718889713287354, mean p set: 0.4489997923374176The modified gen p mean: 0.44915780425071716, gen p mean: -0.27709218859672546, mean p set: 0.44963809847831726
loss_pred:0.03977571055293083, decouple_loss:0.023395588621497154
loss_pred:0.03994680568575859, decouple_loss:0.023036301136016846
Iteration: 454, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493086040019989, gen p mean: -0.2830450236797333, mean p set: 0.449788898229599
loss_pred:0.04125666245818138, decouple_loss:0.02316656894981861
The modified gen p mean: 0.44855383038520813, gen p mean: -0.27601000666618347, mean p set: 0.4490341246128082The modified gen p mean: 0.4476543366909027, gen p mean: -0.27778661251068115, mean p set: 0.4481346309185028
loss_pred:0.03847378119826317, decouple_loss:0.023522233590483665
loss_pred:0.04109236225485802, decouple_loss:0.02258484624326229
Iteration: 455, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44922003149986267, gen p mean: -0.2734939754009247, mean p set: 0.44970032572746277
loss_pred:0.03869279474020004, decouple_loss:0.022221310064196587
The modified gen p mean: 0.4491068422794342, gen p mean: -0.26908764243125916, mean p set: 0.4495871365070343The modified gen p mean: 0.44894909858703613, gen p mean: -0.26836124062538147, mean p set: 0.4494294226169586
loss_pred:0.04090559110045433, decouple_loss:0.02073628455400467
loss_pred:0.041089415550231934, decouple_loss:0.02275157906115055
Iteration: 456, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44877147674560547, gen p mean: -0.2736143171787262, mean p set: 0.44925177097320557
loss_pred:0.0396113283932209, decouple_loss:0.023150727152824402
The modified gen p mean: 0.45017313957214355, gen p mean: -0.2773834466934204, mean p set: 0.45065340399742126The modified gen p mean: 0.4493502676486969, gen p mean: -0.27511438727378845, mean p set: 0.449830561876297
loss_pred:0.03998672962188721, decouple_loss:0.022292351350188255
loss_pred:0.03911445289850235, decouple_loss:0.02436440996825695
Iteration: 457, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486970007419586, gen p mean: -0.2759803533554077, mean p set: 0.44917726516723633
loss_pred:0.03907278552651405, decouple_loss:0.01988917961716652
The modified gen p mean: 0.4487094581127167, gen p mean: -0.27173176407814026, mean p set: 0.4491897523403168The modified gen p mean: 0.4507370591163635, gen p mean: -0.2782714366912842, mean p set: 0.451217383146286
loss_pred:0.03881993144750595, decouple_loss:0.022586639970541
loss_pred:0.039644986391067505, decouple_loss:0.021162454038858414
Iteration: 458, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44785863161087036, gen p mean: -0.27553239464759827, mean p set: 0.44833892583847046
loss_pred:0.04073729366064072, decouple_loss:0.021401461213827133
The modified gen p mean: 0.45001980662345886, gen p mean: -0.2759828567504883, mean p set: 0.4505000710487366The modified gen p mean: 0.4487400949001312, gen p mean: -0.27346673607826233, mean p set: 0.4492203891277313
loss_pred:0.040124498307704926, decouple_loss:0.023474322631955147
loss_pred:0.03851819783449173, decouple_loss:0.022263653576374054
Iteration: 459, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44981130957603455, gen p mean: -0.27938976883888245, mean p set: 0.45029157400131226
loss_pred:0.039863575249910355, decouple_loss:0.02142924815416336
The modified gen p mean: 0.4490993618965149, gen p mean: -0.275425523519516, mean p set: 0.449579656124115The modified gen p mean: 0.4482823312282562, gen p mean: -0.27965354919433594, mean p set: 0.4487626254558563
loss_pred:0.04025451838970184, decouple_loss:0.020847398787736893
loss_pred:0.03843740001320839, decouple_loss:0.02146022394299507
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012008_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012008_3_24hr.npz
NaN value num: 0
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 460, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466235041618347, gen p mean: -0.2723327577114105, mean p set: 0.4471038281917572
loss_pred:0.0377156063914299, decouple_loss:0.020637888461351395
The modified gen p mean: 0.44759318232536316, gen p mean: -0.273013174533844, mean p set: 0.44807347655296326The modified gen p mean: 0.44794607162475586, gen p mean: -0.2794434130191803, mean p set: 0.44842633605003357
loss_pred:0.03814486041665077, decouple_loss:0.02176680974662304
loss_pred:0.03831692412495613, decouple_loss:0.022548938170075417
2023-05-01 12:27:49 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.28006649017333984, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.2735975980758667, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.2761576771736145, mean p set: 0.4500633478164673
loss_pred:0.03727024793624878, decouple_loss:0.02224707044661045
loss_pred:0.03931880742311478, decouple_loss:0.021692024543881416
loss_pred:0.03834852948784828, decouple_loss:0.021432388573884964
WV_0_PC_1_EH_0_PS_40_15, loss: 0.03940205276012421, avg_mse: 0.04219165816903114
current test mse: 0.042192
Iteration: 461, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44656574726104736, gen p mean: -0.274249404668808, mean p set: 0.44704607129096985
The modified gen p mean: 0.44651535153388977, gen p mean: -0.2772902548313141, mean p set: 0.44699564576148987
The modified gen p mean: 0.4477647840976715, gen p mean: -0.27656054496765137, mean p set: 0.4482450783252716
loss_pred:0.03744151443243027, decouple_loss:0.022659944370388985
loss_pred:0.037401266396045685, decouple_loss:0.02223779819905758
loss_pred:0.03828858584165573, decouple_loss:0.023258963599801064
Iteration: 462, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4463392496109009, gen p mean: -0.2778223752975464, mean p set: 0.446819543838501
loss_pred:0.04013637453317642, decouple_loss:0.021827315911650658
The modified gen p mean: 0.44632676243782043, gen p mean: -0.2797885239124298, mean p set: 0.44680705666542053The modified gen p mean: 0.4468805491924286, gen p mean: -0.28172042965888977, mean p set: 0.4473608434200287
loss_pred:0.03830777853727341, decouple_loss:0.022065933793783188
loss_pred:0.03878139331936836, decouple_loss:0.02104184962809086
Iteration: 463, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44678202271461487, gen p mean: -0.27111366391181946, mean p set: 0.44726231694221497
loss_pred:0.0373244471848011, decouple_loss:0.021416785195469856
The modified gen p mean: 0.4472448229789734, gen p mean: -0.2673156261444092, mean p set: 0.4477251172065735The modified gen p mean: 0.44610631465911865, gen p mean: -0.2702324092388153, mean p set: 0.44658660888671875
loss_pred:0.03804321214556694, decouple_loss:0.021041015163064003
loss_pred:0.03883536905050278, decouple_loss:0.019868362694978714
Iteration: 464, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44758808612823486, gen p mean: -0.26909905672073364, mean p set: 0.44806838035583496
loss_pred:0.036633703857660294, decouple_loss:0.019908323884010315
The modified gen p mean: 0.4469769299030304, gen p mean: -0.2678854763507843, mean p set: 0.4474572241306305The modified gen p mean: 0.4463662803173065, gen p mean: -0.2685879170894623, mean p set: 0.446846604347229
loss_pred:0.03748716786503792, decouple_loss:0.021117402240633965
loss_pred:0.0392589271068573, decouple_loss:0.022782165557146072
Iteration: 465, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468129873275757, gen p mean: -0.27821195125579834, mean p set: 0.44729331135749817
loss_pred:0.03880871459841728, decouple_loss:0.022016555070877075
The modified gen p mean: 0.44712936878204346, gen p mean: -0.2759615182876587, mean p set: 0.44760966300964355The modified gen p mean: 0.4466868042945862, gen p mean: -0.2763935625553131, mean p set: 0.4471670687198639
loss_pred:0.03872579708695412, decouple_loss:0.020407844334840775
loss_pred:0.037360046058893204, decouple_loss:0.020768146961927414
Iteration: 466, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477007985115051, gen p mean: -0.2785685956478119, mean p set: 0.44818106293678284
loss_pred:0.03702506050467491, decouple_loss:0.021469896659255028
The modified gen p mean: 0.446519672870636, gen p mean: -0.27971839904785156, mean p set: 0.4469999372959137The modified gen p mean: 0.4452042877674103, gen p mean: -0.27920830249786377, mean p set: 0.4456845819950104
loss_pred:0.03739646077156067, decouple_loss:0.01959925889968872
loss_pred:0.03889448195695877, decouple_loss:0.020965229719877243
Iteration: 467, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44682130217552185, gen p mean: -0.2822544574737549, mean p set: 0.44730156660079956
loss_pred:0.03710256516933441, decouple_loss:0.02007572166621685
The modified gen p mean: 0.4484494626522064, gen p mean: -0.28556448221206665, mean p set: 0.4489297568798065The modified gen p mean: 0.44643446803092957, gen p mean: -0.2884313762187958, mean p set: 0.44691479206085205
loss_pred:0.037793662399053574, decouple_loss:0.022810624912381172
loss_pred:0.03710443899035454, decouple_loss:0.02147640846669674
Iteration: 468, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465797543525696, gen p mean: -0.2786913514137268, mean p set: 0.44706007838249207
loss_pred:0.036774203181266785, decouple_loss:0.019959283992648125
The modified gen p mean: 0.4468015134334564, gen p mean: -0.2847904860973358, mean p set: 0.44728177785873413
The modified gen p mean: 0.446666419506073, gen p mean: -0.2805895507335663, mean p set: 0.4471467435359955
loss_pred:0.03762884810566902, decouple_loss:0.02147546596825123
loss_pred:0.037159159779548645, decouple_loss:0.02039642073214054
Iteration: 469, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465217888355255, gen p mean: -0.28462499380111694, mean p set: 0.4470020830631256
loss_pred:0.0365917831659317, decouple_loss:0.02051606960594654
The modified gen p mean: 0.44666972756385803, gen p mean: -0.2824028730392456, mean p set: 0.4471500515937805The modified gen p mean: 0.4466151297092438, gen p mean: -0.28614553809165955, mean p set: 0.44709545373916626
loss_pred:0.037495799362659454, decouple_loss:0.020674820989370346
loss_pred:0.036671414971351624, decouple_loss:0.0207324530929327
Iteration: 470, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468703269958496, gen p mean: -0.2771066427230835, mean p set: 0.4473506212234497
loss_pred:0.03788064047694206, decouple_loss:0.02209230698645115
The modified gen p mean: 0.44700536131858826, gen p mean: -0.2809775769710541, mean p set: 0.44748565554618835The modified gen p mean: 0.4468380808830261, gen p mean: -0.2774951457977295, mean p set: 0.4473183751106262
loss_pred:0.03702666983008385, decouple_loss:0.020452303811907768
loss_pred:0.038153089582920074, decouple_loss:0.020904913544654846
2023-05-01 12:29:43 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.28147584199905396, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.2742822766304016, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.27664801478385925, mean p set: 0.4500633478164673
loss_pred:0.03889298811554909, decouple_loss:0.021462352946400642
loss_pred:0.036923669278621674, decouple_loss:0.02239789068698883
loss_pred:0.03791191056370735, decouple_loss:0.021733982488512993
WV_0_PC_1_EH_0_PS_40_15, loss: 0.039002761244773865, avg_mse: 0.04171685129404068
current test mse: 0.041717
Iteration: 471, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44756370782852173, gen p mean: -0.2767704129219055, mean p set: 0.4480440020561218
The modified gen p mean: 0.44674137234687805, gen p mean: -0.27549830079078674, mean p set: 0.44722166657447815
The modified gen p mean: 0.4472530484199524, gen p mean: -0.2780396640300751, mean p set: 0.4477333426475525
loss_pred:0.03878900036215782, decouple_loss:0.020586645230650902
loss_pred:0.035716425627470016, decouple_loss:0.020106999203562737
loss_pred:0.038125280290842056, decouple_loss:0.021471494808793068
Iteration: 472, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44671717286109924, gen p mean: -0.28618526458740234, mean p set: 0.44719746708869934
loss_pred:0.03902028128504753, decouple_loss:0.023562831804156303
The modified gen p mean: 0.44517549872398376, gen p mean: -0.2845270037651062, mean p set: 0.44565579295158386The modified gen p mean: 0.4453771710395813, gen p mean: -0.2850063741207123, mean p set: 0.445857435464859
loss_pred:0.03690420463681221, decouple_loss:0.02168135903775692
loss_pred:0.038708049803972244, decouple_loss:0.021770689636468887
Iteration: 473, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44643330574035645, gen p mean: -0.29807180166244507, mean p set: 0.44691362977027893
loss_pred:0.03775496780872345, decouple_loss:0.02037452720105648
The modified gen p mean: 0.44679540395736694, gen p mean: -0.29370468854904175, mean p set: 0.44727569818496704The modified gen p mean: 0.446067214012146, gen p mean: -0.2951302230358124, mean p set: 0.4465474784374237
loss_pred:0.03733918070793152, decouple_loss:0.020567135885357857
loss_pred:0.03744622692465782, decouple_loss:0.021150358021259308
Iteration: 474, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4461154639720917, gen p mean: -0.29365164041519165, mean p set: 0.44659578800201416
loss_pred:0.037235673516988754, decouple_loss:0.02122686058282852
The modified gen p mean: 0.4467034637928009, gen p mean: -0.29511287808418274, mean p set: 0.447183758020401The modified gen p mean: 0.4460991322994232, gen p mean: -0.29787787795066833, mean p set: 0.4465794563293457
loss_pred:0.0382094606757164, decouple_loss:0.019596684724092484
loss_pred:0.038018178194761276, decouple_loss:0.019642429426312447
Iteration: 475, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44680383801460266, gen p mean: -0.2875370383262634, mean p set: 0.44728413224220276
loss_pred:0.036785684525966644, decouple_loss:0.021308405324816704
The modified gen p mean: 0.44634103775024414, gen p mean: -0.28689467906951904, mean p set: 0.44682133197784424The modified gen p mean: 0.4471513628959656, gen p mean: -0.2824946641921997, mean p set: 0.4476316571235657
loss_pred:0.037948738783597946, decouple_loss:0.021177781745791435
loss_pred:0.037043843418359756, decouple_loss:0.021186528727412224
Iteration: 476, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44740480184555054, gen p mean: -0.2741920053958893, mean p set: 0.44788506627082825
loss_pred:0.037649381905794144, decouple_loss:0.01993059739470482
The modified gen p mean: 0.4459965229034424, gen p mean: -0.27266332507133484, mean p set: 0.44647684693336487The modified gen p mean: 0.4456709921360016, gen p mean: -0.27763012051582336, mean p set: 0.4461512565612793
loss_pred:0.0378468856215477, decouple_loss:0.020103685557842255
loss_pred:0.04015202075242996, decouple_loss:0.02065758965909481
Iteration: 477, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44530779123306274, gen p mean: -0.2764526307582855, mean p set: 0.44578808546066284
loss_pred:0.0371040478348732, decouple_loss:0.02042180299758911
The modified gen p mean: 0.44705235958099365, gen p mean: -0.2776603102684021, mean p set: 0.44753265380859375The modified gen p mean: 0.4469497799873352, gen p mean: -0.2791309356689453, mean p set: 0.4474301338195801
loss_pred:0.03634757921099663, decouple_loss:0.01987302489578724
loss_pred:0.03815726935863495, decouple_loss:0.022196393460035324
Iteration: 478, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470561742782593, gen p mean: -0.2822592854499817, mean p set: 0.4475364685058594
loss_pred:0.03589596599340439, decouple_loss:0.020025404170155525
The modified gen p mean: 0.44698432087898254, gen p mean: -0.2844717800617218, mean p set: 0.44746461510658264The modified gen p mean: 0.44605764746665955, gen p mean: -0.28197741508483887, mean p set: 0.44653791189193726
loss_pred:0.036646150052547455, decouple_loss:0.01910264976322651
loss_pred:0.037228044122457504, decouple_loss:0.01943080499768257
Iteration: 479, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44734692573547363, gen p mean: -0.29090479016304016, mean p set: 0.44782721996307373
loss_pred:0.036401648074388504, decouple_loss:0.020512206479907036
The modified gen p mean: 0.4461234509944916, gen p mean: -0.28270450234413147, mean p set: 0.4466037154197693The modified gen p mean: 0.4467865228652954, gen p mean: -0.2901836037635803, mean p set: 0.4472668468952179
loss_pred:0.037529107183218, decouple_loss:0.01955847442150116
loss_pred:0.03644781932234764, decouple_loss:0.020733671262860298
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012007_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012007_3_24hr.npz
NaN value num: 0
Iteration: 480, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44755682349205017, gen p mean: -0.2814871668815613, mean p set: 0.44803711771965027
loss_pred:0.038481928408145905, decouple_loss:0.02103220857679844
The modified gen p mean: 0.448729932308197, gen p mean: -0.28256115317344666, mean p set: 0.44921019673347473The modified gen p mean: 0.4483753740787506, gen p mean: -0.2789584696292877, mean p set: 0.4488556683063507
loss_pred:0.03623165562748909, decouple_loss:0.01966860331594944
loss_pred:0.03866637498140335, decouple_loss:0.022880081087350845
2023-05-01 12:32:20 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.276753693819046, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.26906588673591614, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.27238747477531433, mean p set: 0.4500633478164673
loss_pred:0.03868291154503822, decouple_loss:0.0195426344871521
loss_pred:0.03647681698203087, decouple_loss:0.020861109718680382
loss_pred:0.03748267516493797, decouple_loss:0.019681358709931374
WV_0_PC_1_EH_0_PS_40_15, loss: 0.03854888677597046, avg_mse: 0.041350703686475754
current test mse: 0.041351
Iteration: 481, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44750353693962097, gen p mean: -0.2677009105682373, mean p set: 0.44798383116722107
The modified gen p mean: 0.44728949666023254, gen p mean: -0.27155816555023193, mean p set: 0.44776979088783264
The modified gen p mean: 0.44715479016304016, gen p mean: -0.27084141969680786, mean p set: 0.44763508439064026
loss_pred:0.03842850774526596, decouple_loss:0.022562118247151375
loss_pred:0.03880483657121658, decouple_loss:0.020126482471823692loss_pred:0.037005044519901276, decouple_loss:0.02055632323026657
Iteration: 482, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44723644852638245, gen p mean: -0.2734017074108124, mean p set: 0.44771671295166016
loss_pred:0.03899114206433296, decouple_loss:0.022536972537636757
The modified gen p mean: 0.4477311372756958, gen p mean: -0.28000906109809875, mean p set: 0.4482114315032959The modified gen p mean: 0.4483889639377594, gen p mean: -0.28137215971946716, mean p set: 0.4488692879676819
loss_pred:0.03759866952896118, decouple_loss:0.020062344148755074
loss_pred:0.03714708238840103, decouple_loss:0.019629474729299545
Iteration: 483, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486527442932129, gen p mean: -0.28842562437057495, mean p set: 0.449133038520813
loss_pred:0.03682706877589226, decouple_loss:0.01941264420747757
The modified gen p mean: 0.4474695920944214, gen p mean: -0.2851864695549011, mean p set: 0.4479498863220215The modified gen p mean: 0.446613073348999, gen p mean: -0.28788241744041443, mean p set: 0.4470933675765991
loss_pred:0.03728287294507027, decouple_loss:0.019299985840916634
loss_pred:0.03698383644223213, decouple_loss:0.021191345527768135
Iteration: 484, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44763848185539246, gen p mean: -0.28187137842178345, mean p set: 0.44811877608299255
loss_pred:0.03696697950363159, decouple_loss:0.020437972620129585
The modified gen p mean: 0.4473142623901367, gen p mean: -0.27557745575904846, mean p set: 0.4477945566177368The modified gen p mean: 0.4484992027282715, gen p mean: -0.28102150559425354, mean p set: 0.4489794969558716
loss_pred:0.03926291689276695, decouple_loss:0.020883027464151382
loss_pred:0.037750255316495895, decouple_loss:0.021023191511631012
Iteration: 485, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44834771752357483, gen p mean: -0.2768626809120178, mean p set: 0.4488280117511749
loss_pred:0.03594324365258217, decouple_loss:0.02148258313536644
The modified gen p mean: 0.449061781167984, gen p mean: -0.27330395579338074, mean p set: 0.4495420455932617The modified gen p mean: 0.44796130061149597, gen p mean: -0.27829158306121826, mean p set: 0.44844159483909607
loss_pred:0.036649301648139954, decouple_loss:0.022354429587721825
loss_pred:0.03723588213324547, decouple_loss:0.020601650699973106
Iteration: 486, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44812270998954773, gen p mean: -0.28252092003822327, mean p set: 0.44860297441482544
loss_pred:0.0358772836625576, decouple_loss:0.01963071897625923
The modified gen p mean: 0.4482242166996002, gen p mean: -0.2795642912387848, mean p set: 0.4487045109272003
The modified gen p mean: 0.4493151009082794, gen p mean: -0.2785717248916626, mean p set: 0.4497953951358795
loss_pred:0.03724568709731102, decouple_loss:0.020756300538778305
loss_pred:0.03755610063672066, decouple_loss:0.021496783941984177
Iteration: 487, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44857344031333923, gen p mean: -0.27903181314468384, mean p set: 0.44905373454093933
loss_pred:0.03831377252936363, decouple_loss:0.020595848560333252
The modified gen p mean: 0.446932315826416, gen p mean: -0.27731677889823914, mean p set: 0.4474125802516937The modified gen p mean: 0.44725486636161804, gen p mean: -0.27511876821517944, mean p set: 0.44773516058921814
loss_pred:0.03680983930826187, decouple_loss:0.019363902509212494
loss_pred:0.038200076669454575, decouple_loss:0.02114049158990383
Iteration: 488, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484296441078186, gen p mean: -0.28448057174682617, mean p set: 0.4489099383354187
loss_pred:0.03641152009367943, decouple_loss:0.019426636397838593
The modified gen p mean: 0.4485977590084076, gen p mean: -0.2836308777332306, mean p set: 0.4490780532360077The modified gen p mean: 0.44846054911613464, gen p mean: -0.28637421131134033, mean p set: 0.44894084334373474
loss_pred:0.03788222372531891, decouple_loss:0.018860284239053726
loss_pred:0.03673454746603966, decouple_loss:0.019550824537873268
Iteration: 489, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44745561480522156, gen p mean: -0.2909969687461853, mean p set: 0.44793590903282166
loss_pred:0.03783157095313072, decouple_loss:0.020105818286538124
The modified gen p mean: 0.4483779966831207, gen p mean: -0.2940012216567993, mean p set: 0.4488582909107208The modified gen p mean: 0.4476485848426819, gen p mean: -0.2908549904823303, mean p set: 0.44812890887260437
loss_pred:0.036480072885751724, decouple_loss:0.020283792167901993
loss_pred:0.03827366232872009, decouple_loss:0.019540036097168922
Iteration: 490, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476211667060852, gen p mean: -0.29892975091934204, mean p set: 0.4481014907360077
loss_pred:0.037166401743888855, decouple_loss:0.019036216661334038
The modified gen p mean: 0.44727110862731934, gen p mean: -0.2963065803050995, mean p set: 0.4477514326572418The modified gen p mean: 0.44736236333847046, gen p mean: -0.2997246980667114, mean p set: 0.44784268736839294
loss_pred:0.037372708320617676, decouple_loss:0.019679300487041473
loss_pred:0.0387689471244812, decouple_loss:0.020407890900969505
2023-05-01 12:34:15 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.3021318316459656, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830833911896, gen p mean: -0.29780763387680054, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.29395461082458496, mean p set: 0.45035696029663086
loss_pred:0.03837457671761513, decouple_loss:0.020290376618504524
loss_pred:0.037436798214912415, decouple_loss:0.01918625831604004
loss_pred:0.03638983890414238, decouple_loss:0.019653761759400368
WV_0_PC_1_EH_0_PS_40_15, loss: 0.03838591277599335, avg_mse: 0.04131607711315155
current test mse: 0.041316
Iteration: 491, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479518532752991, gen p mean: -0.30328118801116943, mean p set: 0.44843214750289917
The modified gen p mean: 0.4481548070907593, gen p mean: -0.2952902913093567, mean p set: 0.4486351013183594
The modified gen p mean: 0.44812414050102234, gen p mean: -0.29326000809669495, mean p set: 0.4486044645309448
loss_pred:0.036536265164613724, decouple_loss:0.01955871284008026
loss_pred:0.03595653176307678, decouple_loss:0.02027350850403309
loss_pred:0.03675897791981697, decouple_loss:0.019543375819921494
Iteration: 492, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476816654205322, gen p mean: -0.2946944534778595, mean p set: 0.44816192984580994
loss_pred:0.037204984575510025, decouple_loss:0.021078353747725487
The modified gen p mean: 0.4480278789997101, gen p mean: -0.2986440658569336, mean p set: 0.4485081434249878The modified gen p mean: 0.4484996497631073, gen p mean: -0.3049878180027008, mean p set: 0.4489799737930298
loss_pred:0.036554962396621704, decouple_loss:0.019820142537355423
loss_pred:0.037452708929777145, decouple_loss:0.02022845670580864
Iteration: 493, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44736185669898987, gen p mean: -0.29066094756126404, mean p set: 0.44784215092658997
loss_pred:0.03756515309214592, decouple_loss:0.021381156519055367
The modified gen p mean: 0.448378324508667, gen p mean: -0.29452642798423767, mean p set: 0.4488586187362671The modified gen p mean: 0.4490264058113098, gen p mean: -0.2946453392505646, mean p set: 0.4495067000389099
loss_pred:0.037076301872730255, decouple_loss:0.019841909408569336
loss_pred:0.03611858934164047, decouple_loss:0.021822694689035416
Iteration: 494, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485164284706116, gen p mean: -0.29521217942237854, mean p set: 0.4489966928958893
The modified gen p mean: 0.44729694724082947, gen p mean: -0.29146987199783325, mean p set: 0.44777724146842957
loss_pred:0.03790685907006264, decouple_loss:0.020621921867132187
loss_pred:0.03812454268336296, decouple_loss:0.021526768803596497
The modified gen p mean: 0.4481460750102997, gen p mean: -0.29639238119125366, mean p set: 0.4486263692378998
loss_pred:0.03757254034280777, decouple_loss:0.020438876003026962
Iteration: 495, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44877690076828003, gen p mean: -0.2955201268196106, mean p set: 0.4492571949958801
The modified gen p mean: 0.44808006286621094, gen p mean: -0.29413384199142456, mean p set: 0.44856035709381104
loss_pred:0.037977978587150574, decouple_loss:0.021005848422646523
loss_pred:0.038053810596466064, decouple_loss:0.02104838192462921
The modified gen p mean: 0.4477725327014923, gen p mean: -0.29453882575035095, mean p set: 0.4482528567314148
loss_pred:0.03659813106060028, decouple_loss:0.020539144054055214
Iteration: 496, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44730043411254883, gen p mean: -0.29397475719451904, mean p set: 0.4477807283401489
The modified gen p mean: 0.44711458683013916, gen p mean: -0.2908247113227844, mean p set: 0.44759488105773926
loss_pred:0.037384070456027985, decouple_loss:0.020458420738577843
loss_pred:0.037342287600040436, decouple_loss:0.021164806559681892
The modified gen p mean: 0.4483235776424408, gen p mean: -0.29665446281433105, mean p set: 0.4488038718700409
loss_pred:0.036219965666532516, decouple_loss:0.020640069618821144
Iteration: 497, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44817668199539185, gen p mean: -0.2897924780845642, mean p set: 0.44865697622299194
loss_pred:0.03684157878160477, decouple_loss:0.0218009352684021
The modified gen p mean: 0.4481067359447479, gen p mean: -0.2952882647514343, mean p set: 0.4485870599746704The modified gen p mean: 0.4479582905769348, gen p mean: -0.2868885397911072, mean p set: 0.4484385848045349
loss_pred:0.03583125025033951, decouple_loss:0.02052423544228077
loss_pred:0.03658248111605644, decouple_loss:0.0203567985445261
Iteration: 498, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474526643753052, gen p mean: -0.30128735303878784, mean p set: 0.4479329288005829
The modified gen p mean: 0.4470907747745514, gen p mean: -0.3021066188812256, mean p set: 0.4475710391998291
loss_pred:0.036545392125844955, decouple_loss:0.018757181242108345
loss_pred:0.03646085783839226, decouple_loss:0.019261304289102554
The modified gen p mean: 0.44777804613113403, gen p mean: -0.30101752281188965, mean p set: 0.44825834035873413
loss_pred:0.03736508637666702, decouple_loss:0.02002590335905552
Iteration: 499, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493856132030487, gen p mean: -0.3055092394351959, mean p set: 0.4498658776283264
The modified gen p mean: 0.4475186765193939, gen p mean: -0.3078383803367615, mean p set: 0.4479990005493164
loss_pred:0.03739417344331741, decouple_loss:0.02091994322836399
loss_pred:0.035704322159290314, decouple_loss:0.019508039578795433
The modified gen p mean: 0.4480270743370056, gen p mean: -0.3121631145477295, mean p set: 0.4485073983669281
loss_pred:0.03602225333452225, decouple_loss:0.020863210782408714
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012015_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012015_3_24hr.npz
NaN value num: 0
Iteration: 500, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4510059058666229, gen p mean: -0.29491743445396423, mean p set: 0.45148617029190063
loss_pred:0.03868349269032478, decouple_loss:0.02682705596089363
The modified gen p mean: 0.44994911551475525, gen p mean: -0.2974628508090973, mean p set: 0.45042943954467773
The modified gen p mean: 0.4511185884475708, gen p mean: -0.2977249324321747, mean p set: 0.4515989124774933
loss_pred:0.03775232657790184, decouple_loss:0.02284531109035015
loss_pred:0.039174020290374756, decouple_loss:0.026640787720680237
2023-05-01 12:36:50 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.30113738775253296, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.29174354672431946, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.295594722032547, mean p set: 0.4500633478164673
loss_pred:0.038324158638715744, decouple_loss:0.02123638242483139
loss_pred:0.036476556211709976, decouple_loss:0.02159624919295311
loss_pred:0.03744462877511978, decouple_loss:0.020627252757549286
WV_0_PC_1_EH_0_PS_40_15, loss: 0.03847277909517288, avg_mse: 0.04142012447118759
current test mse: 0.04142
Iteration: 501, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4510740637779236, gen p mean: -0.2918816804885864, mean p set: 0.4515543580055237
The modified gen p mean: 0.4486089050769806, gen p mean: -0.2936150133609772, mean p set: 0.4490891993045807
The modified gen p mean: 0.4489806890487671, gen p mean: -0.2904525697231293, mean p set: 0.4494609236717224
loss_pred:0.038663510233163834, decouple_loss:0.023425744846463203
loss_pred:0.039365608245134354, decouple_loss:0.025238478556275368
loss_pred:0.03858363628387451, decouple_loss:0.022978782653808594
Iteration: 502, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45053184032440186, gen p mean: -0.30369696021080017, mean p set: 0.45101216435432434
loss_pred:0.03720971941947937, decouple_loss:0.022420400753617287
The modified gen p mean: 0.4520019590854645, gen p mean: -0.30035361647605896, mean p set: 0.4524822235107422The modified gen p mean: 0.4490956664085388, gen p mean: -0.30334168672561646, mean p set: 0.4495759904384613
loss_pred:0.03884025663137436, decouple_loss:0.020856643095612526
loss_pred:0.0384979285299778, decouple_loss:0.023022590205073357
Iteration: 503, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44985663890838623, gen p mean: -0.3110770881175995, mean p set: 0.4503369629383087
loss_pred:0.03758976608514786, decouple_loss:0.022610913962125778
The modified gen p mean: 0.4484226107597351, gen p mean: -0.3074277341365814, mean p set: 0.4489029347896576The modified gen p mean: 0.45099177956581116, gen p mean: -0.3046335279941559, mean p set: 0.45147207379341125
loss_pred:0.035539884120225906, decouple_loss:0.02194187231361866
loss_pred:0.03935237228870392, decouple_loss:0.025152364745736122
Iteration: 504, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44890713691711426, gen p mean: -0.312538206577301, mean p set: 0.44938743114471436
loss_pred:0.03599179536104202, decouple_loss:0.021223798394203186
The modified gen p mean: 0.44951194524765015, gen p mean: -0.3086499273777008, mean p set: 0.44999220967292786The modified gen p mean: 0.4528867304325104, gen p mean: -0.3109654486179352, mean p set: 0.4533670246601105
loss_pred:0.0376921147108078, decouple_loss:0.0231860913336277
loss_pred:0.038207195699214935, decouple_loss:0.02184183895587921
Iteration: 505, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44971194863319397, gen p mean: -0.32076868414878845, mean p set: 0.4501922130584717
loss_pred:0.03753241151571274, decouple_loss:0.0209515281021595
The modified gen p mean: 0.44832563400268555, gen p mean: -0.31918492913246155, mean p set: 0.44880592823028564The modified gen p mean: 0.45146018266677856, gen p mean: -0.31555303931236267, mean p set: 0.45194050669670105
loss_pred:0.03660809248685837, decouple_loss:0.02119656838476658
loss_pred:0.03858962655067444, decouple_loss:0.022874070331454277
Iteration: 506, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507964849472046, gen p mean: -0.30916982889175415, mean p set: 0.45127683877944946
loss_pred:0.03686065971851349, decouple_loss:0.021381422877311707
The modified gen p mean: 0.45325762033462524, gen p mean: -0.3107149302959442, mean p set: 0.45373791456222534The modified gen p mean: 0.449121356010437, gen p mean: -0.31404343247413635, mean p set: 0.4496016502380371
loss_pred:0.03753269836306572, decouple_loss:0.021416572853922844
loss_pred:0.03949576988816261, decouple_loss:0.022175094112753868
Iteration: 507, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502372443675995, gen p mean: -0.3100363612174988, mean p set: 0.4507175385951996
loss_pred:0.03700385242700577, decouple_loss:0.02164640463888645
The modified gen p mean: 0.4491286277770996, gen p mean: -0.31029200553894043, mean p set: 0.4496089518070221The modified gen p mean: 0.4492603838443756, gen p mean: -0.3126448690891266, mean p set: 0.4497406780719757
loss_pred:0.03874247521162033, decouple_loss:0.02291475422680378
loss_pred:0.03623121976852417, decouple_loss:0.02083093300461769
Iteration: 508, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501085579395294, gen p mean: -0.3075728714466095, mean p set: 0.4505888819694519
loss_pred:0.03829306364059448, decouple_loss:0.021387549117207527
The modified gen p mean: 0.4497421085834503, gen p mean: -0.31300655007362366, mean p set: 0.450222373008728The modified gen p mean: 0.44978469610214233, gen p mean: -0.30978962779045105, mean p set: 0.45026499032974243
loss_pred:0.036976590752601624, decouple_loss:0.02030322514474392
loss_pred:0.035632990300655365, decouple_loss:0.01938699744641781
Iteration: 509, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44845959544181824, gen p mean: -0.313836932182312, mean p set: 0.4489399194717407
loss_pred:0.034910500049591064, decouple_loss:0.02027834951877594
The modified gen p mean: 0.4495984613895416, gen p mean: -0.3136230707168579, mean p set: 0.4500787556171417The modified gen p mean: 0.448651522397995, gen p mean: -0.31330740451812744, mean p set: 0.4491318166255951
loss_pred:0.037745069712400436, decouple_loss:0.019934125244617462
loss_pred:0.03484569862484932, decouple_loss:0.01961558684706688
Iteration: 510, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45114290714263916, gen p mean: -0.3122291564941406, mean p set: 0.45162320137023926
loss_pred:0.037492793053388596, decouple_loss:0.021810287609696388
The modified gen p mean: 0.4524902403354645, gen p mean: -0.31301218271255493, mean p set: 0.4529705345630646The modified gen p mean: 0.4502502977848053, gen p mean: -0.3100268840789795, mean p set: 0.4507306218147278
loss_pred:0.03733694180846214, decouple_loss:0.02211751788854599
loss_pred:0.037229716777801514, decouple_loss:0.01992070861160755
2023-05-01 12:38:46 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.32227808237075806, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.31202101707458496, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.3166749179363251, mean p set: 0.4500633478164673
loss_pred:0.03863805532455444, decouple_loss:0.023874342441558838
loss_pred:0.03659466654062271, decouple_loss:0.02399241179227829
loss_pred:0.03759283199906349, decouple_loss:0.02326589822769165
WV_0_PC_1_EH_0_PS_40_15, loss: 0.03879406675696373, avg_mse: 0.0419594906270504
current test mse: 0.041959
Iteration: 511, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45174381136894226, gen p mean: -0.3185907304286957, mean p set: 0.45222410559654236
The modified gen p mean: 0.4508938789367676, gen p mean: -0.31339403986930847, mean p set: 0.4513741731643677
The modified gen p mean: 0.44881466031074524, gen p mean: -0.3132566511631012, mean p set: 0.44929495453834534
loss_pred:0.03627721965312958, decouple_loss:0.020125476643443108
loss_pred:0.03847583383321762, decouple_loss:0.023300904780626297
loss_pred:0.037083953619003296, decouple_loss:0.02152405120432377
Iteration: 512, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45019111037254333, gen p mean: -0.3296630382537842, mean p set: 0.45067140460014343
loss_pred:0.0371740497648716, decouple_loss:0.020933842286467552
The modified gen p mean: 0.44982486963272095, gen p mean: -0.3218342661857605, mean p set: 0.45030519366264343The modified gen p mean: 0.4488903880119324, gen p mean: -0.3209019601345062, mean p set: 0.4493706524372101
loss_pred:0.035956237465143204, decouple_loss:0.020626449957489967
loss_pred:0.036212094128131866, decouple_loss:0.01980423554778099
Iteration: 513, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45049893856048584, gen p mean: -0.31561556458473206, mean p set: 0.45097923278808594
loss_pred:0.035562723875045776, decouple_loss:0.019907359033823013
The modified gen p mean: 0.44957685470581055, gen p mean: -0.3205062448978424, mean p set: 0.45005717873573303The modified gen p mean: 0.4490912854671478, gen p mean: -0.3117643892765045, mean p set: 0.4495715796947479
loss_pred:0.037337567657232285, decouple_loss:0.01952902413904667
loss_pred:0.03749726340174675, decouple_loss:0.019949810579419136
Iteration: 514, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504856467247009, gen p mean: -0.3114132583141327, mean p set: 0.450965940952301
loss_pred:0.03825877979397774, decouple_loss:0.02133534662425518
The modified gen p mean: 0.45058462023735046, gen p mean: -0.321902871131897, mean p set: 0.45106494426727295The modified gen p mean: 0.4497857987880707, gen p mean: -0.3119926452636719, mean p set: 0.4502660930156708
loss_pred:0.03752950578927994, decouple_loss:0.019440164789557457
loss_pred:0.036592960357666016, decouple_loss:0.019479947164654732
Iteration: 515, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491327106952667, gen p mean: -0.31994375586509705, mean p set: 0.44961294531822205
loss_pred:0.03725039213895798, decouple_loss:0.02007085457444191
The modified gen p mean: 0.44844138622283936, gen p mean: -0.3170386850833893, mean p set: 0.44892165064811707The modified gen p mean: 0.44919833540916443, gen p mean: -0.3195418119430542, mean p set: 0.4496786296367645
loss_pred:0.03559800237417221, decouple_loss:0.019821150228381157
loss_pred:0.037320978939533234, decouple_loss:0.021361276507377625
Iteration: 516, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45049571990966797, gen p mean: -0.3255583941936493, mean p set: 0.45097601413726807
loss_pred:0.037567660212516785, decouple_loss:0.02059956267476082
The modified gen p mean: 0.44956880807876587, gen p mean: -0.3237374424934387, mean p set: 0.45004913210868835The modified gen p mean: 0.4493042528629303, gen p mean: -0.3272106349468231, mean p set: 0.4497845768928528
loss_pred:0.037437502294778824, decouple_loss:0.0209919735789299
loss_pred:0.038162823766469955, decouple_loss:0.01958036795258522
Iteration: 517, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490293562412262, gen p mean: -0.33014997839927673, mean p set: 0.4495096802711487
loss_pred:0.037611223757267, decouple_loss:0.01914147101342678
The modified gen p mean: 0.45101237297058105, gen p mean: -0.32879334688186646, mean p set: 0.45149263739585876The modified gen p mean: 0.4482678472995758, gen p mean: -0.3290022909641266, mean p set: 0.4487481415271759
loss_pred:0.03669487684965134, decouple_loss:0.02187713049352169
loss_pred:0.037464775145053864, decouple_loss:0.01943442039191723
Iteration: 518, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45077428221702576, gen p mean: -0.3157727122306824, mean p set: 0.45125457644462585
loss_pred:0.03707849979400635, decouple_loss:0.021488185971975327
The modified gen p mean: 0.4512256383895874, gen p mean: -0.3131423890590668, mean p set: 0.4517059326171875The modified gen p mean: 0.4517269432544708, gen p mean: -0.3089618384838104, mean p set: 0.45220720767974854
loss_pred:0.03872697800397873, decouple_loss:0.02337247133255005
loss_pred:0.037827011197805405, decouple_loss:0.021183034405112267
Iteration: 519, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492291510105133, gen p mean: -0.3141694962978363, mean p set: 0.4497094452381134
loss_pred:0.036519914865493774, decouple_loss:0.020094772800803185
The modified gen p mean: 0.4528255760669708, gen p mean: -0.3128878176212311, mean p set: 0.45330584049224854The modified gen p mean: 0.44866570830345154, gen p mean: -0.31375929713249207, mean p set: 0.44914600253105164
loss_pred:0.03839785233139992, decouple_loss:0.021324418485164642
loss_pred:0.03672286868095398, decouple_loss:0.02003195323050022
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012012_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012012_3_24hr.npz
NaN value num: 0
Iteration: 520, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45094770193099976, gen p mean: -0.3198890686035156, mean p set: 0.45142796635627747
loss_pred:0.03678733482956886, decouple_loss:0.020266586914658546
The modified gen p mean: 0.45210132002830505, gen p mean: -0.3228588402271271, mean p set: 0.45258164405822754The modified gen p mean: 0.45252203941345215, gen p mean: -0.3157173991203308, mean p set: 0.45300236344337463
loss_pred:0.038059696555137634, decouple_loss:0.02457827888429165
loss_pred:0.03746159002184868, decouple_loss:0.020764628425240517
2023-05-01 12:41:18 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.3323305547237396, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830833911896, gen p mean: -0.3274782598018646, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.3247513473033905, mean p set: 0.45035696029663086
loss_pred:0.03908666595816612, decouple_loss:0.023609787225723267
loss_pred:0.038070570677518845, decouple_loss:0.022293169051408768
loss_pred:0.03689228370785713, decouple_loss:0.02285114862024784
WV_0_PC_1_EH_0_PS_40_15, loss: 0.03916240856051445, avg_mse: 0.04255889728665352
current test mse: 0.042559
Iteration: 521, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4527921974658966, gen p mean: -0.32069021463394165, mean p set: 0.4532724618911743
The modified gen p mean: 0.451018363237381, gen p mean: -0.327894389629364, mean p set: 0.4514986276626587
The modified gen p mean: 0.4517531096935272, gen p mean: -0.33277252316474915, mean p set: 0.4522334337234497
loss_pred:0.03816410154104233, decouple_loss:0.02169230580329895
loss_pred:0.038171857595443726, decouple_loss:0.021167021244764328
loss_pred:0.03841347247362137, decouple_loss:0.021846359595656395
Iteration: 522, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45180171728134155, gen p mean: -0.3351559638977051, mean p set: 0.45228198170661926
loss_pred:0.038472168147563934, decouple_loss:0.021937528625130653
The modified gen p mean: 0.45216771960258484, gen p mean: -0.3363134562969208, mean p set: 0.4526480436325073The modified gen p mean: 0.4518972635269165, gen p mean: -0.3306885361671448, mean p set: 0.4523775279521942
loss_pred:0.03793508559465408, decouple_loss:0.021022193133831024
loss_pred:0.03727709874510765, decouple_loss:0.019407689571380615
Iteration: 523, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4529619514942169, gen p mean: -0.32384192943573, mean p set: 0.45344221591949463
loss_pred:0.0397435687482357, decouple_loss:0.020815864205360413
The modified gen p mean: 0.45333120226860046, gen p mean: -0.33042675256729126, mean p set: 0.45381149649620056The modified gen p mean: 0.45133817195892334, gen p mean: -0.33176836371421814, mean p set: 0.45181846618652344
loss_pred:0.036996953189373016, decouple_loss:0.020450079813599586
loss_pred:0.03842843696475029, decouple_loss:0.019596023485064507
Iteration: 524, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514097571372986, gen p mean: -0.32485446333885193, mean p set: 0.45189008116722107
The modified gen p mean: 0.45076045393943787, gen p mean: -0.3218897879123688, mean p set: 0.45124077796936035
loss_pred:0.03785902261734009, decouple_loss:0.020014667883515358
loss_pred:0.035718515515327454, decouple_loss:0.02057665027678013
The modified gen p mean: 0.4520992636680603, gen p mean: -0.31955569982528687, mean p set: 0.4525795578956604
loss_pred:0.03738837316632271, decouple_loss:0.021046701818704605
Iteration: 525, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45108193159103394, gen p mean: -0.3255760967731476, mean p set: 0.4515622556209564
loss_pred:0.037769172340631485, decouple_loss:0.02135026641190052
The modified gen p mean: 0.4521215856075287, gen p mean: -0.333690881729126, mean p set: 0.4526018798351288The modified gen p mean: 0.4526252746582031, gen p mean: -0.3244059383869171, mean p set: 0.4531055986881256
loss_pred:0.03707228600978851, decouple_loss:0.02107873000204563
loss_pred:0.037275280803442, decouple_loss:0.021197017282247543
Iteration: 526, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450235515832901, gen p mean: -0.3399660587310791, mean p set: 0.4507158100605011
loss_pred:0.03539150208234787, decouple_loss:0.020792081952095032
The modified gen p mean: 0.45143890380859375, gen p mean: -0.34701716899871826, mean p set: 0.45191919803619385
The modified gen p mean: 0.4532085657119751, gen p mean: -0.34145021438598633, mean p set: 0.4536888301372528
loss_pred:0.03593017905950546, decouple_loss:0.020365191623568535
loss_pred:0.03897898644208908, decouple_loss:0.0208573080599308
Iteration: 527, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45041078329086304, gen p mean: -0.33785152435302734, mean p set: 0.45089107751846313
loss_pred:0.038024891167879105, decouple_loss:0.02006211131811142
The modified gen p mean: 0.4522748589515686, gen p mean: -0.34658756852149963, mean p set: 0.4527551829814911The modified gen p mean: 0.45308157801628113, gen p mean: -0.3316902220249176, mean p set: 0.4535618722438812
loss_pred:0.03792616352438927, decouple_loss:0.020070413127541542
loss_pred:0.03686691075563431, decouple_loss:0.02001209184527397
Iteration: 528, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45206180214881897, gen p mean: -0.3458443880081177, mean p set: 0.45254209637641907
loss_pred:0.038211505860090256, decouple_loss:0.019773706793785095
The modified gen p mean: 0.4531868100166321, gen p mean: -0.3449392318725586, mean p set: 0.4536671042442322The modified gen p mean: 0.45076799392700195, gen p mean: -0.34466731548309326, mean p set: 0.45124828815460205
loss_pred:0.03682684525847435, decouple_loss:0.01999771036207676
loss_pred:0.036744922399520874, decouple_loss:0.020008809864521027
Iteration: 529, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45073312520980835, gen p mean: -0.33445659279823303, mean p set: 0.45121341943740845
loss_pred:0.03623930364847183, decouple_loss:0.01852536015212536
The modified gen p mean: 0.45241525769233704, gen p mean: -0.340609610080719, mean p set: 0.4528955817222595The modified gen p mean: 0.4513089954853058, gen p mean: -0.3327837884426117, mean p set: 0.4517892897129059
loss_pred:0.03792564943432808, decouple_loss:0.021228747442364693
loss_pred:0.03679172322154045, decouple_loss:0.01973104104399681
Iteration: 530, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45312532782554626, gen p mean: -0.3319587707519531, mean p set: 0.45360562205314636
loss_pred:0.037330131977796555, decouple_loss:0.020389145240187645
The modified gen p mean: 0.45273756980895996, gen p mean: -0.3402920961380005, mean p set: 0.45321789383888245The modified gen p mean: 0.4529753029346466, gen p mean: -0.3357661962509155, mean p set: 0.4534555673599243
loss_pred:0.03690626099705696, decouple_loss:0.02011052705347538
loss_pred:0.03743082284927368, decouple_loss:0.01936933398246765
2023-05-01 12:43:13 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.35686102509498596, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.3482193946838379, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.3517220616340637, mean p set: 0.4500633478164673
loss_pred:0.0383305698633194, decouple_loss:0.023835206404328346
loss_pred:0.03631880506873131, decouple_loss:0.02286367118358612
loss_pred:0.03729560598731041, decouple_loss:0.02249840646982193
WV_0_PC_1_EH_0_PS_40_15, loss: 0.03846828266978264, avg_mse: 0.04182804748415947
current test mse: 0.041828
Iteration: 531, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45364052057266235, gen p mean: -0.339065283536911, mean p set: 0.45412078499794006
The modified gen p mean: 0.451387494802475, gen p mean: -0.3541853427886963, mean p set: 0.4518677592277527
The modified gen p mean: 0.45342588424682617, gen p mean: -0.3478774428367615, mean p set: 0.45390620827674866
loss_pred:0.03834271430969238, decouple_loss:0.01905902847647667
loss_pred:0.037184424698352814, decouple_loss:0.01977577991783619
loss_pred:0.037276722490787506, decouple_loss:0.018896091729402542
Iteration: 532, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508211314678192, gen p mean: -0.35496851801872253, mean p set: 0.4513013958930969
loss_pred:0.03632594272494316, decouple_loss:0.01932625286281109
The modified gen p mean: 0.45189446210861206, gen p mean: -0.3619041442871094, mean p set: 0.45237478613853455The modified gen p mean: 0.45122697949409485, gen p mean: -0.3576575219631195, mean p set: 0.45170727372169495
loss_pred:0.03807135671377182, decouple_loss:0.01877799816429615
loss_pred:0.03534649312496185, decouple_loss:0.01883714459836483
Iteration: 533, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4525606632232666, gen p mean: -0.36316290497779846, mean p set: 0.4530409872531891
loss_pred:0.036852359771728516, decouple_loss:0.019922442734241486
The modified gen p mean: 0.4515746235847473, gen p mean: -0.36145710945129395, mean p set: 0.4520549178123474The modified gen p mean: 0.4511535167694092, gen p mean: -0.35520970821380615, mean p set: 0.4516338109970093
loss_pred:0.036150600761175156, decouple_loss:0.01826665736734867
loss_pred:0.03823304548859596, decouple_loss:0.018775416538119316
Iteration: 534, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45095402002334595, gen p mean: -0.35539427399635315, mean p set: 0.45143428444862366
loss_pred:0.035618722438812256, decouple_loss:0.01822645403444767
The modified gen p mean: 0.4503174126148224, gen p mean: -0.359615683555603, mean p set: 0.4507977068424225The modified gen p mean: 0.45251381397247314, gen p mean: -0.3528687357902527, mean p set: 0.45299410820007324
loss_pred:0.03686964139342308, decouple_loss:0.01941688172519207
loss_pred:0.036082759499549866, decouple_loss:0.02070249244570732
Iteration: 535, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4506116211414337, gen p mean: -0.3529270589351654, mean p set: 0.4510918855667114
loss_pred:0.0358414426445961, decouple_loss:0.018286965787410736
The modified gen p mean: 0.4520900845527649, gen p mean: -0.35516855120658875, mean p set: 0.4525703489780426The modified gen p mean: 0.45320776104927063, gen p mean: -0.3603031039237976, mean p set: 0.45368802547454834
loss_pred:0.03799453750252724, decouple_loss:0.019985871389508247
loss_pred:0.03544694930315018, decouple_loss:0.018847962841391563
Iteration: 536, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4526158273220062, gen p mean: -0.3506793975830078, mean p set: 0.45309609174728394
loss_pred:0.03696804121136665, decouple_loss:0.019094470888376236
The modified gen p mean: 0.4513908624649048, gen p mean: -0.35679617524147034, mean p set: 0.4518711566925049The modified gen p mean: 0.45267388224601746, gen p mean: -0.34919649362564087, mean p set: 0.45315417647361755
loss_pred:0.03670932725071907, decouple_loss:0.019494766369462013
loss_pred:0.036320969462394714, decouple_loss:0.019388793036341667
Iteration: 537, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45103585720062256, gen p mean: -0.35447075963020325, mean p set: 0.45151615142822266
loss_pred:0.036116085946559906, decouple_loss:0.017299678176641464
The modified gen p mean: 0.4514777958393097, gen p mean: -0.36626002192497253, mean p set: 0.4519580900669098The modified gen p mean: 0.45237088203430176, gen p mean: -0.35329195857048035, mean p set: 0.45285117626190186
loss_pred:0.03747604414820671, decouple_loss:0.020029298961162567
loss_pred:0.03654990717768669, decouple_loss:0.01818288303911686
Iteration: 538, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4524537920951843, gen p mean: -0.3705727756023407, mean p set: 0.4529340863227844
loss_pred:0.037216510623693466, decouple_loss:0.020562922582030296
The modified gen p mean: 0.4508955180644989, gen p mean: -0.3621453642845154, mean p set: 0.451375812292099The modified gen p mean: 0.4523821473121643, gen p mean: -0.37169918417930603, mean p set: 0.452862411737442
loss_pred:0.03762316331267357, decouple_loss:0.01791936531662941
loss_pred:0.036930669099092484, decouple_loss:0.018696006387472153
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012007_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012007_3_24hr.npz
NaN value num: 0
Iteration: 539, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502352774143219, gen p mean: -0.37124335765838623, mean p set: 0.4507155418395996
loss_pred:0.034652989357709885, decouple_loss:0.018837252631783485
The modified gen p mean: 0.44930654764175415, gen p mean: -0.37270188331604004, mean p set: 0.44978684186935425The modified gen p mean: 0.4492523670196533, gen p mean: -0.37297624349594116, mean p set: 0.4497326612472534
loss_pred:0.035668812692165375, decouple_loss:0.020941736176609993
loss_pred:0.037869248539209366, decouple_loss:0.021545439958572388
Iteration: 540, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44951069355010986, gen p mean: -0.36408576369285583, mean p set: 0.44999101758003235
loss_pred:0.03656171262264252, decouple_loss:0.019425077363848686
The modified gen p mean: 0.4479636251926422, gen p mean: -0.3665788769721985, mean p set: 0.4484439492225647The modified gen p mean: 0.44779276847839355, gen p mean: -0.36076807975769043, mean p set: 0.44827306270599365
loss_pred:0.03680175915360451, decouple_loss:0.019346782937645912
loss_pred:0.036556169390678406, decouple_loss:0.020254187285900116
2023-05-01 12:45:48 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.37327566742897034, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.3656763434410095, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.36789777874946594, mean p set: 0.4500633478164673
loss_pred:0.03814680129289627, decouple_loss:0.021456265822052956
loss_pred:0.03611351177096367, decouple_loss:0.021106749773025513
loss_pred:0.03707831725478172, decouple_loss:0.020720016211271286
WV_0_PC_1_EH_0_PS_40_15, loss: 0.038167595863342285, avg_mse: 0.04172441363334656
current test mse: 0.041724
Iteration: 541, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449989914894104, gen p mean: -0.3618924915790558, mean p set: 0.4504702091217041
The modified gen p mean: 0.45038244128227234, gen p mean: -0.3687903583049774, mean p set: 0.45086273550987244
The modified gen p mean: 0.4488302171230316, gen p mean: -0.364572674036026, mean p set: 0.4493105113506317
loss_pred:0.03622664883732796, decouple_loss:0.019051741808652878
loss_pred:0.035812169313430786, decouple_loss:0.020302725955843925
loss_pred:0.03613707050681114, decouple_loss:0.02024194411933422
Iteration: 542, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44828465580940247, gen p mean: -0.35889890789985657, mean p set: 0.44876495003700256
loss_pred:0.035343460738658905, decouple_loss:0.019305085763335228
The modified gen p mean: 0.4487841725349426, gen p mean: -0.35906490683555603, mean p set: 0.4492644667625427The modified gen p mean: 0.450428307056427, gen p mean: -0.3581751585006714, mean p set: 0.4509085714817047
loss_pred:0.03551845625042915, decouple_loss:0.019723616540431976
loss_pred:0.03561031073331833, decouple_loss:0.019277410581707954
Iteration: 543, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492669999599457, gen p mean: -0.35923758149147034, mean p set: 0.4497472941875458
loss_pred:0.03580647334456444, decouple_loss:0.01870393007993698
The modified gen p mean: 0.44812923669815063, gen p mean: -0.35613879561424255, mean p set: 0.44860953092575073The modified gen p mean: 0.4501960277557373, gen p mean: -0.36005711555480957, mean p set: 0.4506763517856598
loss_pred:0.03535128012299538, decouple_loss:0.01959669217467308
loss_pred:0.03561782464385033, decouple_loss:0.01860710233449936
Iteration: 544, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450958251953125, gen p mean: -0.35876280069351196, mean p set: 0.4514385461807251
loss_pred:0.03725280240178108, decouple_loss:0.019248390570282936
The modified gen p mean: 0.4493372142314911, gen p mean: -0.3608783185482025, mean p set: 0.4498175084590912The modified gen p mean: 0.45000436902046204, gen p mean: -0.35682085156440735, mean p set: 0.45048466324806213
loss_pred:0.036174096167087555, decouple_loss:0.01837833784520626
loss_pred:0.035928964614868164, decouple_loss:0.0202818401157856
Iteration: 545, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501650929450989, gen p mean: -0.3516305088996887, mean p set: 0.45064541697502136
loss_pred:0.035782590508461, decouple_loss:0.01700008660554886
The modified gen p mean: 0.4483434557914734, gen p mean: -0.3528691530227661, mean p set: 0.4488237500190735The modified gen p mean: 0.4498671889305115, gen p mean: -0.35441914200782776, mean p set: 0.45034751296043396
loss_pred:0.03614460304379463, decouple_loss:0.017756585031747818
loss_pred:0.03664836287498474, decouple_loss:0.01935504376888275
Iteration: 546, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45030298829078674, gen p mean: -0.35380858182907104, mean p set: 0.45078325271606445
loss_pred:0.03576310724020004, decouple_loss:0.018852565437555313
The modified gen p mean: 0.44732365012168884, gen p mean: -0.3466933071613312, mean p set: 0.44780394434928894The modified gen p mean: 0.44888585805892944, gen p mean: -0.355837881565094, mean p set: 0.44936615228652954
loss_pred:0.03562282770872116, decouple_loss:0.01956050656735897
loss_pred:0.035133473575115204, decouple_loss:0.01858646422624588
Iteration: 547, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45119157433509827, gen p mean: -0.3536951541900635, mean p set: 0.45167189836502075
loss_pred:0.033675964921712875, decouple_loss:0.018209263682365417
The modified gen p mean: 0.4491819441318512, gen p mean: -0.35402828454971313, mean p set: 0.4496622681617737The modified gen p mean: 0.4504678249359131, gen p mean: -0.34893837571144104, mean p set: 0.4509481191635132
loss_pred:0.03586664795875549, decouple_loss:0.01755419746041298
loss_pred:0.0354737713932991, decouple_loss:0.017819495871663094
Iteration: 548, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44856709241867065, gen p mean: -0.35280928015708923, mean p set: 0.44904738664627075
loss_pred:0.03510332107543945, decouple_loss:0.017537936568260193
The modified gen p mean: 0.4487535357475281, gen p mean: -0.35763078927993774, mean p set: 0.4492338001728058The modified gen p mean: 0.4490981698036194, gen p mean: -0.35346224904060364, mean p set: 0.4495784640312195
loss_pred:0.03590670973062515, decouple_loss:0.017572402954101562
loss_pred:0.03573339059948921, decouple_loss:0.01792277581989765
Iteration: 549, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494897723197937, gen p mean: -0.35544368624687195, mean p set: 0.4499700367450714
loss_pred:0.03591209650039673, decouple_loss:0.018417857587337494
The modified gen p mean: 0.44951286911964417, gen p mean: -0.35537320375442505, mean p set: 0.44999319314956665The modified gen p mean: 0.4489796757698059, gen p mean: -0.35600605607032776, mean p set: 0.4494599997997284
loss_pred:0.0355604887008667, decouple_loss:0.016907639801502228
loss_pred:0.03521404787898064, decouple_loss:0.016542844474315643
Iteration: 550, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44841957092285156, gen p mean: -0.3613013029098511, mean p set: 0.44889989495277405
loss_pred:0.03551487624645233, decouple_loss:0.018301256000995636
The modified gen p mean: 0.4500577747821808, gen p mean: -0.35501742362976074, mean p set: 0.4505380690097809The modified gen p mean: 0.44851192831993103, gen p mean: -0.35769495368003845, mean p set: 0.44899222254753113
loss_pred:0.03396512195467949, decouple_loss:0.017370665445923805
loss_pred:0.03471124544739723, decouple_loss:0.017804283648729324
2023-05-01 12:47:43 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.3597043454647064, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.3517586886882782, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.3546625077724457, mean p set: 0.4500633478164673
loss_pred:0.03819483891129494, decouple_loss:0.021740909665822983
loss_pred:0.03598308935761452, decouple_loss:0.021814027801156044
loss_pred:0.037106771022081375, decouple_loss:0.02111373282968998
WV_0_PC_1_EH_0_PS_40_15, loss: 0.03817271441221237, avg_mse: 0.04178576171398163
current test mse: 0.041786
Iteration: 551, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483919143676758, gen p mean: -0.3509726822376251, mean p set: 0.4488722085952759
The modified gen p mean: 0.4505018889904022, gen p mean: -0.35270220041275024, mean p set: 0.45098215341567993
The modified gen p mean: 0.44935426115989685, gen p mean: -0.35074228048324585, mean p set: 0.44983452558517456
loss_pred:0.03508920222520828, decouple_loss:0.01873353309929371
loss_pred:0.035875823348760605, decouple_loss:0.019615713506937027
loss_pred:0.03625301271677017, decouple_loss:0.018917353823781013
Iteration: 552, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44873544573783875, gen p mean: -0.3527383804321289, mean p set: 0.44921573996543884
loss_pred:0.03491013124585152, decouple_loss:0.017166046425700188
The modified gen p mean: 0.44946929812431335, gen p mean: -0.35008367896080017, mean p set: 0.44994959235191345The modified gen p mean: 0.45045509934425354, gen p mean: -0.35404279828071594, mean p set: 0.45093539357185364
loss_pred:0.037139058113098145, decouple_loss:0.01963343843817711
loss_pred:0.03531425818800926, decouple_loss:0.017414571717381477
Iteration: 553, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45073336362838745, gen p mean: -0.357954740524292, mean p set: 0.45121368765830994
loss_pred:0.033448170870542526, decouple_loss:0.017191285267472267
The modified gen p mean: 0.4494553208351135, gen p mean: -0.3524887263774872, mean p set: 0.4499356150627136The modified gen p mean: 0.44855016469955444, gen p mean: -0.3560258448123932, mean p set: 0.44903048872947693
loss_pred:0.03617321699857712, decouple_loss:0.016864396631717682
loss_pred:0.03488735482096672, decouple_loss:0.01737212762236595
Iteration: 554, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44839420914649963, gen p mean: -0.35860052704811096, mean p set: 0.44887450337409973
loss_pred:0.03421412780880928, decouple_loss:0.017236853018403053
The modified gen p mean: 0.44936704635620117, gen p mean: -0.3598581850528717, mean p set: 0.44984734058380127The modified gen p mean: 0.4508897364139557, gen p mean: -0.3628147542476654, mean p set: 0.45137009024620056
loss_pred:0.036253176629543304, decouple_loss:0.01718149520456791
loss_pred:0.03280320391058922, decouple_loss:0.017122697085142136
Iteration: 555, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501005709171295, gen p mean: -0.3603871464729309, mean p set: 0.4505808651447296
loss_pred:0.03476960211992264, decouple_loss:0.016349855810403824
The modified gen p mean: 0.448661208152771, gen p mean: -0.36074942350387573, mean p set: 0.4491414725780487The modified gen p mean: 0.4500592350959778, gen p mean: -0.36356526613235474, mean p set: 0.4505395293235779
loss_pred:0.03691724315285683, decouple_loss:0.017778873443603516
loss_pred:0.03466295450925827, decouple_loss:0.016956381499767303
Iteration: 556, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486050605773926, gen p mean: -0.3645505905151367, mean p set: 0.4490853548049927
loss_pred:0.03580760583281517, decouple_loss:0.017835961654782295
The modified gen p mean: 0.448365181684494, gen p mean: -0.3606102466583252, mean p set: 0.4488454759120941The modified gen p mean: 0.44813013076782227, gen p mean: -0.3630976378917694, mean p set: 0.44861045479774475
loss_pred:0.0361408069729805, decouple_loss:0.017484093084931374
loss_pred:0.03573686257004738, decouple_loss:0.018349047750234604
Iteration: 557, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476589858531952, gen p mean: -0.35998955368995667, mean p set: 0.4481392800807953
loss_pred:0.03531097248196602, decouple_loss:0.017272312194108963
The modified gen p mean: 0.44907498359680176, gen p mean: -0.3564082980155945, mean p set: 0.44955530762672424The modified gen p mean: 0.448742538690567, gen p mean: -0.3577509820461273, mean p set: 0.4492228329181671
loss_pred:0.03551135212182999, decouple_loss:0.018147239461541176
loss_pred:0.034945689141750336, decouple_loss:0.01610829308629036
Iteration: 558, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497455358505249, gen p mean: -0.35731860995292664, mean p set: 0.450225830078125
loss_pred:0.037750907242298126, decouple_loss:0.01742842048406601
The modified gen p mean: 0.4501855969429016, gen p mean: -0.35087305307388306, mean p set: 0.4506658911705017The modified gen p mean: 0.4500219225883484, gen p mean: -0.35126233100891113, mean p set: 0.4505022168159485
loss_pred:0.03485831990838051, decouple_loss:0.017248647287487984
loss_pred:0.035624466836452484, decouple_loss:0.0174604170024395
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012019_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012019_3_24hr.npz
NaN value num: 0
Iteration: 559, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4512689709663391, gen p mean: -0.3571683168411255, mean p set: 0.4517492651939392
loss_pred:0.035296835005283356, decouple_loss:0.018971621990203857
The modified gen p mean: 0.4496847987174988, gen p mean: -0.3528991639614105, mean p set: 0.45016512274742126The modified gen p mean: 0.4524184763431549, gen p mean: -0.3477107882499695, mean p set: 0.452898770570755
loss_pred:0.03630741313099861, decouple_loss:0.017245078459382057
loss_pred:0.036183882504701614, decouple_loss:0.01928900182247162
Iteration: 560, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4509282410144806, gen p mean: -0.37201130390167236, mean p set: 0.4514085352420807
loss_pred:0.03550216555595398, decouple_loss:0.017685599625110626
The modified gen p mean: 0.452144593000412, gen p mean: -0.37222129106521606, mean p set: 0.4526248872280121The modified gen p mean: 0.45146703720092773, gen p mean: -0.36797624826431274, mean p set: 0.4519473612308502
loss_pred:0.036662500351667404, decouple_loss:0.017619885504245758
loss_pred:0.037330787628889084, decouple_loss:0.018930327147245407
2023-05-01 12:50:15 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.38176068663597107, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.372414231300354, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.3755876123905182, mean p set: 0.4500633478164673
loss_pred:0.03797796741127968, decouple_loss:0.020433399826288223
loss_pred:0.035933274775743484, decouple_loss:0.020505225285887718
loss_pred:0.036801546812057495, decouple_loss:0.01958310604095459
WV_0_PC_1_EH_0_PS_40_15, loss: 0.03791295737028122, avg_mse: 0.04166169464588165
current test mse: 0.041662
Iteration: 561, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45237088203430176, gen p mean: -0.37943100929260254, mean p set: 0.45285114645957947
The modified gen p mean: 0.4510771334171295, gen p mean: -0.37334033846855164, mean p set: 0.4515573978424072
The modified gen p mean: 0.45241662859916687, gen p mean: -0.3758283853530884, mean p set: 0.4528968930244446
loss_pred:0.03435302898287773, decouple_loss:0.019779058173298836
loss_pred:0.035295385867357254, decouple_loss:0.018693000078201294
loss_pred:0.035029005259275436, decouple_loss:0.019253429025411606
Iteration: 562, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45102858543395996, gen p mean: -0.37902677059173584, mean p set: 0.45150890946388245
loss_pred:0.03521730750799179, decouple_loss:0.019213173538446426
The modified gen p mean: 0.45111164450645447, gen p mean: -0.37742334604263306, mean p set: 0.45159196853637695The modified gen p mean: 0.4507963955402374, gen p mean: -0.37514710426330566, mean p set: 0.4512766897678375
loss_pred:0.036251187324523926, decouple_loss:0.020443173125386238
loss_pred:0.03636934608221054, decouple_loss:0.020366482436656952
Iteration: 563, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45010125637054443, gen p mean: -0.3741380274295807, mean p set: 0.45058155059814453
loss_pred:0.03564964607357979, decouple_loss:0.018902506679296494
The modified gen p mean: 0.45018839836120605, gen p mean: -0.37558960914611816, mean p set: 0.45066869258880615The modified gen p mean: 0.45110297203063965, gen p mean: -0.372653067111969, mean p set: 0.45158323645591736
loss_pred:0.03703756630420685, decouple_loss:0.019128495827317238
loss_pred:0.03570310398936272, decouple_loss:0.018965085968375206
Iteration: 564, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505757689476013, gen p mean: -0.3738381564617157, mean p set: 0.4510560631752014
loss_pred:0.035006970167160034, decouple_loss:0.017497392371296883
The modified gen p mean: 0.4504564106464386, gen p mean: -0.3724314868450165, mean p set: 0.4509367048740387The modified gen p mean: 0.4519047439098358, gen p mean: -0.371787965297699, mean p set: 0.4523850381374359
loss_pred:0.034710586071014404, decouple_loss:0.018527306616306305
loss_pred:0.03664662688970566, decouple_loss:0.018651727586984634
Iteration: 565, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450790673494339, gen p mean: -0.37801194190979004, mean p set: 0.4512709379196167
loss_pred:0.036045681685209274, decouple_loss:0.01811676286160946
The modified gen p mean: 0.45152682065963745, gen p mean: -0.37824565172195435, mean p set: 0.45200711488723755
The modified gen p mean: 0.45099154114723206, gen p mean: -0.3787846863269806, mean p set: 0.45147183537483215
loss_pred:0.03712014853954315, decouple_loss:0.01859910413622856
loss_pred:0.03500259295105934, decouple_loss:0.016830885782837868
Iteration: 566, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501418173313141, gen p mean: -0.37613019347190857, mean p set: 0.4506221413612366
loss_pred:0.035874541848897934, decouple_loss:0.017962465062737465
The modified gen p mean: 0.45123547315597534, gen p mean: -0.38462549448013306, mean p set: 0.4517157971858978The modified gen p mean: 0.45051705837249756, gen p mean: -0.37918820977211, mean p set: 0.45099735260009766
loss_pred:0.03457288816571236, decouple_loss:0.016898388043045998
loss_pred:0.03697749599814415, decouple_loss:0.016570985317230225
Iteration: 567, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4510782063007355, gen p mean: -0.37971141934394836, mean p set: 0.4515584707260132
loss_pred:0.03689694032073021, decouple_loss:0.018731681630015373
The modified gen p mean: 0.4505321681499481, gen p mean: -0.3785478472709656, mean p set: 0.4510124921798706The modified gen p mean: 0.4518786370754242, gen p mean: -0.38641518354415894, mean p set: 0.4523589313030243
loss_pred:0.034979961812496185, decouple_loss:0.01741497591137886
loss_pred:0.035070065408945084, decouple_loss:0.017914539203047752
Iteration: 568, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45307403802871704, gen p mean: -0.3758165240287781, mean p set: 0.4535543620586395
loss_pred:0.03476212918758392, decouple_loss:0.018626773729920387
The modified gen p mean: 0.44992557168006897, gen p mean: -0.3711387515068054, mean p set: 0.45040586590766907The modified gen p mean: 0.4517216384410858, gen p mean: -0.3723948001861572, mean p set: 0.4522019624710083
loss_pred:0.034429676830768585, decouple_loss:0.01960829086601734
loss_pred:0.03604656457901001, decouple_loss:0.018276294693350792
Iteration: 569, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4517934322357178, gen p mean: -0.3773617744445801, mean p set: 0.4522736966609955
loss_pred:0.035158876329660416, decouple_loss:0.016919292509555817
The modified gen p mean: 0.4507935643196106, gen p mean: -0.36967143416404724, mean p set: 0.4512738585472107The modified gen p mean: 0.45081135630607605, gen p mean: -0.3710775077342987, mean p set: 0.45129165053367615
loss_pred:0.03602433577179909, decouple_loss:0.017845535650849342
loss_pred:0.03505600616335869, decouple_loss:0.017296526581048965
Iteration: 570, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.451174259185791, gen p mean: -0.374101459980011, mean p set: 0.4516545534133911
loss_pred:0.035902101546525955, decouple_loss:0.018296390771865845
The modified gen p mean: 0.4502018690109253, gen p mean: -0.36845627427101135, mean p set: 0.450682133436203The modified gen p mean: 0.4497269093990326, gen p mean: -0.3674898147583008, mean p set: 0.4502072036266327
loss_pred:0.03657861426472664, decouple_loss:0.01727263256907463
loss_pred:0.036427225917577744, decouple_loss:0.01738169975578785
2023-05-01 12:52:10 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.3840332329273224, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.3742426931858063, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.3778235912322998, mean p set: 0.4500633478164673
loss_pred:0.037766873836517334, decouple_loss:0.021470932289958
loss_pred:0.035849880427122116, decouple_loss:0.021886510774493217
loss_pred:0.03668302670121193, decouple_loss:0.02061072550714016
WV_0_PC_1_EH_0_PS_40_15, loss: 0.037832729518413544, avg_mse: 0.041627854108810425
current test mse: 0.041628
Iteration: 571, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4516752064228058, gen p mean: -0.3730442523956299, mean p set: 0.4521554708480835
The modified gen p mean: 0.45098811388015747, gen p mean: -0.3768215477466583, mean p set: 0.45146840810775757
The modified gen p mean: 0.4509286880493164, gen p mean: -0.37494003772735596, mean p set: 0.4514089822769165
loss_pred:0.03501846268773079, decouple_loss:0.01775757037103176
loss_pred:0.03558705002069473, decouple_loss:0.017354920506477356
loss_pred:0.036003634333610535, decouple_loss:0.017276914790272713
Iteration: 572, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45022866129875183, gen p mean: -0.3798733055591583, mean p set: 0.4507089853286743
loss_pred:0.03486054390668869, decouple_loss:0.018027763813734055
The modified gen p mean: 0.45015791058540344, gen p mean: -0.3834635019302368, mean p set: 0.45063820481300354The modified gen p mean: 0.45135343074798584, gen p mean: -0.3823157250881195, mean p set: 0.4518337547779083
loss_pred:0.03611719235777855, decouple_loss:0.0186682790517807
loss_pred:0.03575543314218521, decouple_loss:0.01836998388171196
Iteration: 573, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45104265213012695, gen p mean: -0.3757558763027191, mean p set: 0.4515230059623718
loss_pred:0.03509521484375, decouple_loss:0.016849791631102562
The modified gen p mean: 0.4515930414199829, gen p mean: -0.37185394763946533, mean p set: 0.452073335647583The modified gen p mean: 0.4505290687084198, gen p mean: -0.37991100549697876, mean p set: 0.4510093629360199
loss_pred:0.0353427492082119, decouple_loss:0.01662416197359562
loss_pred:0.03536577522754669, decouple_loss:0.017430458217859268
Iteration: 574, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508490264415741, gen p mean: -0.3745519518852234, mean p set: 0.4513293206691742
loss_pred:0.03523463010787964, decouple_loss:0.017326727509498596
The modified gen p mean: 0.4516814053058624, gen p mean: -0.3694905638694763, mean p set: 0.4521616995334625The modified gen p mean: 0.45177724957466125, gen p mean: -0.3751817047595978, mean p set: 0.45225754380226135
loss_pred:0.036049243062734604, decouple_loss:0.0188820231705904
loss_pred:0.035916827619075775, decouple_loss:0.017677931115031242
Iteration: 575, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4506165683269501, gen p mean: -0.37668052315711975, mean p set: 0.4510968327522278
loss_pred:0.03625934571027756, decouple_loss:0.01797344908118248
The modified gen p mean: 0.45073381066322327, gen p mean: -0.37722861766815186, mean p set: 0.45121413469314575The modified gen p mean: 0.4504019320011139, gen p mean: -0.3838956654071808, mean p set: 0.450882226228714
loss_pred:0.03509364649653435, decouple_loss:0.017408808693289757
loss_pred:0.035224564373493195, decouple_loss:0.01677967794239521
Iteration: 576, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45104217529296875, gen p mean: -0.37286490201950073, mean p set: 0.45152246952056885
loss_pred:0.036683276295661926, decouple_loss:0.01831379532814026
The modified gen p mean: 0.4529097378253937, gen p mean: -0.38060808181762695, mean p set: 0.4533900320529938The modified gen p mean: 0.4519376754760742, gen p mean: -0.37629157304763794, mean p set: 0.4524179995059967
loss_pred:0.03395400568842888, decouple_loss:0.01875469461083412
loss_pred:0.03530503809452057, decouple_loss:0.017263982445001602
Iteration: 577, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45027270913124084, gen p mean: -0.3809477388858795, mean p set: 0.45075303316116333
loss_pred:0.03398311883211136, decouple_loss:0.017938220873475075
The modified gen p mean: 0.45063239336013794, gen p mean: -0.38556385040283203, mean p set: 0.45111268758773804The modified gen p mean: 0.45139825344085693, gen p mean: -0.385623961687088, mean p set: 0.45187854766845703
loss_pred:0.03475749492645264, decouple_loss:0.016596488654613495
loss_pred:0.03642512485384941, decouple_loss:0.017029961571097374
Iteration: 578, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514961838722229, gen p mean: -0.38795530796051025, mean p set: 0.451976478099823
loss_pred:0.03491043671965599, decouple_loss:0.01824631728231907
The modified gen p mean: 0.45158693194389343, gen p mean: -0.3907040059566498, mean p set: 0.45206722617149353The modified gen p mean: 0.4511336088180542, gen p mean: -0.38613420724868774, mean p set: 0.4516139328479767
loss_pred:0.03598089888691902, decouple_loss:0.017232343554496765
loss_pred:0.03551948070526123, decouple_loss:0.01756926067173481
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012010_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012010_3_24hr.npz
NaN value num: 0
Iteration: 579, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.453398197889328, gen p mean: -0.3993680775165558, mean p set: 0.4538784623146057
loss_pred:0.03555953875184059, decouple_loss:0.019509276375174522
The modified gen p mean: 0.4505375027656555, gen p mean: -0.39055514335632324, mean p set: 0.451017826795578The modified gen p mean: 0.4511350989341736, gen p mean: -0.400190144777298, mean p set: 0.4516153931617737
loss_pred:0.03488440066576004, decouple_loss:0.020026899874210358
loss_pred:0.03639881685376167, decouple_loss:0.02239321544766426
Iteration: 580, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45329049229621887, gen p mean: -0.38758811354637146, mean p set: 0.45377078652381897
loss_pred:0.03560896962881088, decouple_loss:0.01940927654504776
The modified gen p mean: 0.44999122619628906, gen p mean: -0.37942588329315186, mean p set: 0.45047152042388916The modified gen p mean: 0.451517254114151, gen p mean: -0.38016992807388306, mean p set: 0.4519975483417511
loss_pred:0.03520263731479645, decouple_loss:0.018255027011036873
loss_pred:0.03565806522965431, decouple_loss:0.01949509046971798
2023-05-01 12:54:41 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.378061443567276, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.3687398135662079, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.37245267629623413, mean p set: 0.4500633478164673
loss_pred:0.0375424325466156, decouple_loss:0.02167348563671112
loss_pred:0.036500345915555954, decouple_loss:0.0210727471858263
loss_pred:0.03551875054836273, decouple_loss:0.022565582767128944
WV_0_PC_1_EH_0_PS_40_15, loss: 0.0376090407371521, avg_mse: 0.04132948815822601
current test mse: 0.041329
Iteration: 581, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4525480270385742, gen p mean: -0.37645670771598816, mean p set: 0.4530283212661743
The modified gen p mean: 0.4539630711078644, gen p mean: -0.37545621395111084, mean p set: 0.4544433653354645
The modified gen p mean: 0.4516639709472656, gen p mean: -0.37210357189178467, mean p set: 0.4521442651748657
loss_pred:0.036211077123880386, decouple_loss:0.01987309381365776
loss_pred:0.036223962903022766, decouple_loss:0.019461240619421005
loss_pred:0.03722403198480606, decouple_loss:0.019765419885516167
Iteration: 582, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4510897696018219, gen p mean: -0.37659570574760437, mean p set: 0.4515700936317444
loss_pred:0.03539039567112923, decouple_loss:0.01770738512277603
The modified gen p mean: 0.45124655961990356, gen p mean: -0.38101625442504883, mean p set: 0.45172688364982605The modified gen p mean: 0.4518463611602783, gen p mean: -0.3775690197944641, mean p set: 0.4523266553878784
loss_pred:0.037773046642541885, decouple_loss:0.018355123698711395
loss_pred:0.03629133105278015, decouple_loss:0.018273504450917244
Iteration: 583, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45082804560661316, gen p mean: -0.38247233629226685, mean p set: 0.45130833983421326
loss_pred:0.03590148314833641, decouple_loss:0.019981002435088158
The modified gen p mean: 0.4525427520275116, gen p mean: -0.37491893768310547, mean p set: 0.4530230164527893The modified gen p mean: 0.4517925977706909, gen p mean: -0.38320016860961914, mean p set: 0.45227286219596863
loss_pred:0.035634271800518036, decouple_loss:0.018368525430560112
loss_pred:0.0353098101913929, decouple_loss:0.020662900060415268
Iteration: 584, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496181607246399, gen p mean: -0.3717488944530487, mean p set: 0.4500984251499176
loss_pred:0.03563611954450607, decouple_loss:0.019963154569268227
The modified gen p mean: 0.45270365476608276, gen p mean: -0.38508743047714233, mean p set: 0.45318397879600525The modified gen p mean: 0.45122531056404114, gen p mean: -0.38775435090065, mean p set: 0.45170560479164124
loss_pred:0.035709988325834274, decouple_loss:0.018144764006137848
loss_pred:0.03526841104030609, decouple_loss:0.017674749717116356
Iteration: 585, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4519600570201874, gen p mean: -0.3911612629890442, mean p set: 0.4524403214454651
loss_pred:0.035128042101860046, decouple_loss:0.01914026401937008
The modified gen p mean: 0.4516017436981201, gen p mean: -0.39187267422676086, mean p set: 0.4520820379257202The modified gen p mean: 0.4537601172924042, gen p mean: -0.38769856095314026, mean p set: 0.4542403817176819
loss_pred:0.03611341863870621, decouple_loss:0.01962652988731861
loss_pred:0.035942379385232925, decouple_loss:0.018428662791848183
Iteration: 586, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45174428820610046, gen p mean: -0.3987237811088562, mean p set: 0.4522245526313782
loss_pred:0.034740786999464035, decouple_loss:0.018511736765503883
The modified gen p mean: 0.44998785853385925, gen p mean: -0.3858739137649536, mean p set: 0.45046815276145935The modified gen p mean: 0.4519064426422119, gen p mean: -0.39401698112487793, mean p set: 0.452386736869812
loss_pred:0.03698745742440224, decouple_loss:0.018837058916687965
loss_pred:0.03502471745014191, decouple_loss:0.01912856660783291
Iteration: 587, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496695399284363, gen p mean: -0.38354530930519104, mean p set: 0.4501498341560364
loss_pred:0.03570355102419853, decouple_loss:0.018534619361162186
The modified gen p mean: 0.4518813490867615, gen p mean: -0.3979787826538086, mean p set: 0.4523616135120392The modified gen p mean: 0.45147353410720825, gen p mean: -0.39065495133399963, mean p set: 0.45195385813713074
loss_pred:0.03703030198812485, decouple_loss:0.01820196770131588
loss_pred:0.03690095245838165, decouple_loss:0.020024634897708893
Iteration: 588, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45169639587402344, gen p mean: -0.3964413106441498, mean p set: 0.45217666029930115
loss_pred:0.0352330207824707, decouple_loss:0.019726889207959175
The modified gen p mean: 0.45202934741973877, gen p mean: -0.39432358741760254, mean p set: 0.4525096118450165The modified gen p mean: 0.44897574186325073, gen p mean: -0.37951889634132385, mean p set: 0.44945603609085083
loss_pred:0.03531470149755478, decouple_loss:0.018286190927028656
loss_pred:0.034161318093538284, decouple_loss:0.019520794972777367
Iteration: 589, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45095574855804443, gen p mean: -0.40134117007255554, mean p set: 0.45143604278564453
loss_pred:0.03490811958909035, decouple_loss:0.018693048506975174
The modified gen p mean: 0.4501783549785614, gen p mean: -0.391638845205307, mean p set: 0.4506586492061615The modified gen p mean: 0.45302075147628784, gen p mean: -0.40368232131004333, mean p set: 0.45350101590156555
loss_pred:0.035448066890239716, decouple_loss:0.018800636753439903
loss_pred:0.03565357252955437, decouple_loss:0.017951298505067825
Iteration: 590, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45134004950523376, gen p mean: -0.41288837790489197, mean p set: 0.4518203139305115
loss_pred:0.036989059299230576, decouple_loss:0.018410416319966316
The modified gen p mean: 0.450985848903656, gen p mean: -0.4032619893550873, mean p set: 0.4514661431312561The modified gen p mean: 0.45040854811668396, gen p mean: -0.40644606947898865, mean p set: 0.45088884234428406
loss_pred:0.036640945822000504, decouple_loss:0.018738241866230965
loss_pred:0.03540234640240669, decouple_loss:0.017627883702516556
2023-05-01 12:56:34 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.40934816002845764, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.40025368332862854, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.403937965631485, mean p set: 0.4500633478164673
loss_pred:0.03746212646365166, decouple_loss:0.021316710859537125
loss_pred:0.03561434522271156, decouple_loss:0.02163916453719139
loss_pred:0.03652779385447502, decouple_loss:0.020466778427362442
WV_0_PC_1_EH_0_PS_40_15, loss: 0.03759180009365082, avg_mse: 0.04148385673761368
current test mse: 0.041484
Iteration: 591, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4518691897392273, gen p mean: -0.41574326157569885, mean p set: 0.452349454164505
The modified gen p mean: 0.4520367681980133, gen p mean: -0.4128679037094116, mean p set: 0.4525170624256134
The modified gen p mean: 0.45160138607025146, gen p mean: -0.4116768538951874, mean p set: 0.4520816504955292
loss_pred:0.03626798093318939, decouple_loss:0.018280256539583206
loss_pred:0.03514369949698448, decouple_loss:0.018823722377419472
loss_pred:0.03575633093714714, decouple_loss:0.018462633714079857
Iteration: 592, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4506036341190338, gen p mean: -0.3970189094543457, mean p set: 0.4510838985443115
loss_pred:0.036732085049152374, decouple_loss:0.019442599266767502
The modified gen p mean: 0.4517357051372528, gen p mean: -0.4069717824459076, mean p set: 0.4522160291671753The modified gen p mean: 0.4514321982860565, gen p mean: -0.4123079776763916, mean p set: 0.4519124925136566
loss_pred:0.03763439506292343, decouple_loss:0.01804690808057785
loss_pred:0.03495045378804207, decouple_loss:0.017987500876188278
Iteration: 593, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501592516899109, gen p mean: -0.38921380043029785, mean p set: 0.4506395757198334
loss_pred:0.0360255241394043, decouple_loss:0.018462946638464928
The modified gen p mean: 0.451686829328537, gen p mean: -0.40136608481407166, mean p set: 0.4521671235561371The modified gen p mean: 0.4505755603313446, gen p mean: -0.398169606924057, mean p set: 0.4510558545589447
loss_pred:0.036064375191926956, decouple_loss:0.01744995079934597
loss_pred:0.03709287941455841, decouple_loss:0.018491799011826515
Iteration: 594, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511801600456238, gen p mean: -0.39426225423812866, mean p set: 0.4516604542732239
loss_pred:0.03587447479367256, decouple_loss:0.017926590517163277
The modified gen p mean: 0.4489378333091736, gen p mean: -0.3833121657371521, mean p set: 0.4494180977344513The modified gen p mean: 0.4528464674949646, gen p mean: -0.3985995650291443, mean p set: 0.4533267617225647
loss_pred:0.03400959074497223, decouple_loss:0.01954532042145729
loss_pred:0.03549917787313461, decouple_loss:0.017673537135124207
Iteration: 595, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508105218410492, gen p mean: -0.3992823660373688, mean p set: 0.4512908160686493
loss_pred:0.03500457853078842, decouple_loss:0.018136754631996155
The modified gen p mean: 0.451240211725235, gen p mean: -0.40795254707336426, mean p set: 0.4517205059528351The modified gen p mean: 0.4513707756996155, gen p mean: -0.4085281193256378, mean p set: 0.4518510699272156
loss_pred:0.03681282326579094, decouple_loss:0.017425518482923508
loss_pred:0.0361480787396431, decouple_loss:0.01904008351266384
Iteration: 596, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514986574649811, gen p mean: -0.3994061350822449, mean p set: 0.4519789516925812
loss_pred:0.03594246506690979, decouple_loss:0.01833382435142994
The modified gen p mean: 0.45183253288269043, gen p mean: -0.40192362666130066, mean p set: 0.4523128271102905
The modified gen p mean: 0.4527859091758728, gen p mean: -0.39853906631469727, mean p set: 0.4532662332057953
loss_pred:0.03638429567217827, decouple_loss:0.01819002628326416
loss_pred:0.035356950014829636, decouple_loss:0.017448974773287773
Iteration: 597, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513090252876282, gen p mean: -0.3918498158454895, mean p set: 0.4517892897129059
loss_pred:0.034865450114011765, decouple_loss:0.01871643029153347
The modified gen p mean: 0.4520858824253082, gen p mean: -0.3968629837036133, mean p set: 0.4525661766529083The modified gen p mean: 0.45077207684516907, gen p mean: -0.3876391351222992, mean p set: 0.4512523412704468
loss_pred:0.03527911379933357, decouple_loss:0.01795540563762188
loss_pred:0.03637178614735603, decouple_loss:0.018443357199430466
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012011_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012011_3_24hr.npz
NaN value num: 0
Iteration: 598, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44840705394744873, gen p mean: -0.4022067189216614, mean p set: 0.4488873779773712
The modified gen p mean: 0.44651171565055847, gen p mean: -0.40413814783096313, mean p set: 0.4469919800758362
loss_pred:0.037053436040878296, decouple_loss:0.021316327154636383
loss_pred:0.039244525134563446, decouple_loss:0.020898163318634033
The modified gen p mean: 0.44796356558799744, gen p mean: -0.3999772071838379, mean p set: 0.44844383001327515
loss_pred:0.0357024259865284, decouple_loss:0.02191350981593132
Iteration: 599, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44760170578956604, gen p mean: -0.41217750310897827, mean p set: 0.4480820298194885
loss_pred:0.03690090775489807, decouple_loss:0.020237060263752937
The modified gen p mean: 0.44747117161750793, gen p mean: -0.4093284606933594, mean p set: 0.44795146584510803The modified gen p mean: 0.44786718487739563, gen p mean: -0.40617239475250244, mean p set: 0.44834744930267334
loss_pred:0.03637751191854477, decouple_loss:0.020104506984353065
loss_pred:0.03689136356115341, decouple_loss:0.021661857143044472
Iteration: 600, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44798776507377625, gen p mean: -0.4075460433959961, mean p set: 0.44846805930137634
loss_pred:0.03663317859172821, decouple_loss:0.01902935653924942
The modified gen p mean: 0.4490186870098114, gen p mean: -0.4102371633052826, mean p set: 0.4494989514350891The modified gen p mean: 0.449051171541214, gen p mean: -0.4063727557659149, mean p set: 0.4495314955711365
loss_pred:0.03627724573016167, decouple_loss:0.018888404592871666
loss_pred:0.036621708422899246, decouple_loss:0.01956523209810257
2023-05-01 12:59:05 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.40750807523727417, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.39701828360557556, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.401510089635849, mean p set: 0.4500633478164673
loss_pred:0.03695230185985565, decouple_loss:0.020046185702085495
loss_pred:0.035156603902578354, decouple_loss:0.019400667399168015
loss_pred:0.03619007021188736, decouple_loss:0.019425876438617706
WV_0_PC_1_EH_0_PS_40_15, loss: 0.03708086907863617, avg_mse: 0.040797192603349686
current test mse: 0.040797
Iteration: 601, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44846656918525696, gen p mean: -0.4010618329048157, mean p set: 0.44894686341285706
The modified gen p mean: 0.44763243198394775, gen p mean: -0.40345776081085205, mean p set: 0.44811269640922546
The modified gen p mean: 0.4468826949596405, gen p mean: -0.408457487821579, mean p set: 0.4473629891872406
loss_pred:0.03554692491889, decouple_loss:0.019756194204092026
loss_pred:0.035928890109062195, decouple_loss:0.018049292266368866
loss_pred:0.03673061728477478, decouple_loss:0.018634172156453133
Iteration: 602, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475826621055603, gen p mean: -0.4063991606235504, mean p set: 0.4480629861354828
loss_pred:0.03639546409249306, decouple_loss:0.018704870715737343
The modified gen p mean: 0.4475783109664917, gen p mean: -0.4096199572086334, mean p set: 0.4480586349964142The modified gen p mean: 0.44728732109069824, gen p mean: -0.40241894125938416, mean p set: 0.44776758551597595
loss_pred:0.036437734961509705, decouple_loss:0.018692025914788246
loss_pred:0.03665578365325928, decouple_loss:0.01921953819692135
Iteration: 603, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4455285668373108, gen p mean: -0.40286463499069214, mean p set: 0.4460088610649109
loss_pred:0.03692178055644035, decouple_loss:0.01982976123690605
The modified gen p mean: 0.4484841525554657, gen p mean: -0.40643998980522156, mean p set: 0.4489644169807434The modified gen p mean: 0.44839930534362793, gen p mean: -0.4020858407020569, mean p set: 0.448879599571228
loss_pred:0.035485681146383286, decouple_loss:0.018681325018405914
loss_pred:0.035002730786800385, decouple_loss:0.01832391880452633
Iteration: 604, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488181471824646, gen p mean: -0.39570853114128113, mean p set: 0.4492984712123871
loss_pred:0.033906299620866776, decouple_loss:0.018952742218971252
The modified gen p mean: 0.44752398133277893, gen p mean: -0.40453699231147766, mean p set: 0.44800424575805664The modified gen p mean: 0.4472469389438629, gen p mean: -0.4010201096534729, mean p set: 0.4477272629737854
loss_pred:0.03496040776371956, decouple_loss:0.018427595496177673
loss_pred:0.03607781603932381, decouple_loss:0.018962569534778595
Iteration: 605, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464336037635803, gen p mean: -0.3933708667755127, mean p set: 0.4469138979911804
loss_pred:0.03906622529029846, decouple_loss:0.01791957952082157
The modified gen p mean: 0.447560578584671, gen p mean: -0.39623501896858215, mean p set: 0.4480408728122711The modified gen p mean: 0.4474649131298065, gen p mean: -0.4027271568775177, mean p set: 0.4479452073574066
loss_pred:0.03490395098924637, decouple_loss:0.01881968416273594
loss_pred:0.0371101014316082, decouple_loss:0.0184186939150095
Iteration: 606, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44786784052848816, gen p mean: -0.39897677302360535, mean p set: 0.44834810495376587
loss_pred:0.03575827553868294, decouple_loss:0.017979059368371964
The modified gen p mean: 0.4480271637439728, gen p mean: -0.3825675845146179, mean p set: 0.4485074579715729The modified gen p mean: 0.4475606679916382, gen p mean: -0.3836868107318878, mean p set: 0.44804099202156067
loss_pred:0.03654559329152107, decouple_loss:0.017870524898171425
loss_pred:0.036115653812885284, decouple_loss:0.017531752586364746
Iteration: 607, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476946294307709, gen p mean: -0.3942562937736511, mean p set: 0.44817492365837097
loss_pred:0.03455628454685211, decouple_loss:0.018612969666719437
The modified gen p mean: 0.44710034132003784, gen p mean: -0.37816745042800903, mean p set: 0.4475806653499603The modified gen p mean: 0.4469090700149536, gen p mean: -0.38042059540748596, mean p set: 0.4473893940448761
loss_pred:0.035966888070106506, decouple_loss:0.017584700137376785
loss_pred:0.03646593540906906, decouple_loss:0.017976073548197746
Iteration: 608, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4458010792732239, gen p mean: -0.37911975383758545, mean p set: 0.44628140330314636
loss_pred:0.03638407588005066, decouple_loss:0.01743069291114807
The modified gen p mean: 0.4475351572036743, gen p mean: -0.3865273892879486, mean p set: 0.448015421628952The modified gen p mean: 0.446107417345047, gen p mean: -0.37883052229881287, mean p set: 0.4465877413749695
loss_pred:0.034276075661182404, decouple_loss:0.01779164932668209
loss_pred:0.03573836758732796, decouple_loss:0.017316525802016258
Iteration: 609, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44960346817970276, gen p mean: -0.3769805133342743, mean p set: 0.45008379220962524
loss_pred:0.034570083022117615, decouple_loss:0.017967218533158302
The modified gen p mean: 0.44699928164482117, gen p mean: -0.383419930934906, mean p set: 0.44747960567474365The modified gen p mean: 0.4478951692581177, gen p mean: -0.3724444508552551, mean p set: 0.4483754336833954
loss_pred:0.03468013554811478, decouple_loss:0.017130661755800247
loss_pred:0.03662438690662384, decouple_loss:0.017094584181904793
Iteration: 610, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479265809059143, gen p mean: -0.376432329416275, mean p set: 0.4484068751335144
loss_pred:0.035647254437208176, decouple_loss:0.016904516145586967
The modified gen p mean: 0.4475327730178833, gen p mean: -0.39228031039237976, mean p set: 0.4480130672454834The modified gen p mean: 0.44791364669799805, gen p mean: -0.3927896320819855, mean p set: 0.44839391112327576
loss_pred:0.035637758672237396, decouple_loss:0.016467126086354256
loss_pred:0.03422879800200462, decouple_loss:0.01754477433860302
2023-05-01 13:01:00 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.3894955813884735, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.3801332712173462, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.38353073596954346, mean p set: 0.4500633478164673
loss_pred:0.03634345903992653, decouple_loss:0.017873520031571388
loss_pred:0.03454314544796944, decouple_loss:0.018208002671599388
loss_pred:0.03546968474984169, decouple_loss:0.017458848655223846
WV_0_PC_1_EH_0_PS_40_15, loss: 0.036344438791275024, avg_mse: 0.039890773594379425
current test mse: 0.039891
Iteration: 611, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481637179851532, gen p mean: -0.38490429520606995, mean p set: 0.4486440122127533
The modified gen p mean: 0.4478825628757477, gen p mean: -0.38603708148002625, mean p set: 0.4483628571033478
The modified gen p mean: 0.4482854902744293, gen p mean: -0.3863409757614136, mean p set: 0.44876575469970703
loss_pred:0.035252466797828674, decouple_loss:0.01678643934428692
loss_pred:0.03595248982310295, decouple_loss:0.01715596579015255
loss_pred:0.03769559785723686, decouple_loss:0.016305500641465187
Iteration: 612, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44946858286857605, gen p mean: -0.3857037425041199, mean p set: 0.44994887709617615
loss_pred:0.03534960001707077, decouple_loss:0.016454586759209633
The modified gen p mean: 0.4468431770801544, gen p mean: -0.38971030712127686, mean p set: 0.4473235011100769The modified gen p mean: 0.44816645979881287, gen p mean: -0.38332515954971313, mean p set: 0.4486467242240906
loss_pred:0.03810449317097664, decouple_loss:0.016974834725260735
loss_pred:0.03590979054570198, decouple_loss:0.016648873686790466
Iteration: 613, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484109878540039, gen p mean: -0.3805300295352936, mean p set: 0.4488913118839264
loss_pred:0.03547563776373863, decouple_loss:0.01628154329955578
The modified gen p mean: 0.44749295711517334, gen p mean: -0.383822500705719, mean p set: 0.44797322154045105The modified gen p mean: 0.4470180869102478, gen p mean: -0.3811722993850708, mean p set: 0.4474983811378479
loss_pred:0.03586001321673393, decouple_loss:0.015976514667272568
loss_pred:0.03653176873922348, decouple_loss:0.016312113031744957
Iteration: 614, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44762560725212097, gen p mean: -0.36988213658332825, mean p set: 0.4481058716773987
loss_pred:0.03477468341588974, decouple_loss:0.016188587993383408
The modified gen p mean: 0.4475497901439667, gen p mean: -0.37604987621307373, mean p set: 0.4480300843715668The modified gen p mean: 0.44710806012153625, gen p mean: -0.37296801805496216, mean p set: 0.44758832454681396
loss_pred:0.03451795503497124, decouple_loss:0.0171588733792305
loss_pred:0.03850220516324043, decouple_loss:0.0156477652490139
Iteration: 615, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482696056365967, gen p mean: -0.37267979979515076, mean p set: 0.4487498700618744
loss_pred:0.034302063286304474, decouple_loss:0.014899371191859245
The modified gen p mean: 0.44843438267707825, gen p mean: -0.3700122833251953, mean p set: 0.44891470670700073The modified gen p mean: 0.44835206866264343, gen p mean: -0.369508296251297, mean p set: 0.44883236289024353
loss_pred:0.034294866025447845, decouple_loss:0.014986547641456127
loss_pred:0.03512824699282646, decouple_loss:0.015491954050958157
Iteration: 616, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44696488976478577, gen p mean: -0.3719191253185272, mean p set: 0.44744521379470825
loss_pred:0.03543361276388168, decouple_loss:0.018405215814709663
The modified gen p mean: 0.44687747955322266, gen p mean: -0.37111884355545044, mean p set: 0.44735774397850037The modified gen p mean: 0.4477536976337433, gen p mean: -0.36640664935112, mean p set: 0.4482339918613434
loss_pred:0.03506764769554138, decouple_loss:0.017143508419394493
loss_pred:0.0344688855111599, decouple_loss:0.01659344881772995
Iteration: 617, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44700631499290466, gen p mean: -0.37769386172294617, mean p set: 0.44748660922050476
loss_pred:0.03439616039395332, decouple_loss:0.015719400718808174
The modified gen p mean: 0.44775673747062683, gen p mean: -0.3781214654445648, mean p set: 0.44823703169822693The modified gen p mean: 0.44788849353790283, gen p mean: -0.3692942261695862, mean p set: 0.44836878776550293
loss_pred:0.03783731162548065, decouple_loss:0.015827661380171776
loss_pred:0.034507691860198975, decouple_loss:0.015859322622418404
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012009_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012009_3_24hr.npz
NaN value num: 0
Iteration: 618, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44910913705825806, gen p mean: -0.3703434467315674, mean p set: 0.44958946108818054
loss_pred:0.03619956597685814, decouple_loss:0.018011804670095444
The modified gen p mean: 0.4491191506385803, gen p mean: -0.3710472583770752, mean p set: 0.4495994448661804The modified gen p mean: 0.44913238286972046, gen p mean: -0.3724886476993561, mean p set: 0.4496126174926758
loss_pred:0.03736065700650215, decouple_loss:0.01795741729438305
loss_pred:0.0357164703309536, decouple_loss:0.01792484149336815
Iteration: 619, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44789427518844604, gen p mean: -0.3612779974937439, mean p set: 0.44837456941604614
loss_pred:0.036325860768556595, decouple_loss:0.017603112384676933
The modified gen p mean: 0.44796690344810486, gen p mean: -0.36459487676620483, mean p set: 0.44844722747802734The modified gen p mean: 0.446489542722702, gen p mean: -0.36993497610092163, mean p set: 0.4469698667526245
loss_pred:0.035758234560489655, decouple_loss:0.017408637329936028
loss_pred:0.035332441329956055, decouple_loss:0.01664377935230732
Iteration: 620, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487477242946625, gen p mean: -0.3685596287250519, mean p set: 0.4492279887199402
loss_pred:0.03563506901264191, decouple_loss:0.01874779351055622
The modified gen p mean: 0.448699414730072, gen p mean: -0.367866188287735, mean p set: 0.44917967915534973The modified gen p mean: 0.4484004080295563, gen p mean: -0.35618212819099426, mean p set: 0.44888070225715637
loss_pred:0.035814687609672546, decouple_loss:0.016959039494395256
loss_pred:0.03555593267083168, decouple_loss:0.018895236775279045
2023-05-01 13:03:33 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.3759549558162689, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.36713263392448425, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.36970454454421997, mean p set: 0.4500633478164673
loss_pred:0.03640816733241081, decouple_loss:0.017524035647511482
loss_pred:0.03451399877667427, decouple_loss:0.017276272177696228
loss_pred:0.035432249307632446, decouple_loss:0.01684168353676796
WV_0_PC_1_EH_0_PS_40_15, loss: 0.036312174052000046, avg_mse: 0.0399743989109993
current test mse: 0.039974
Iteration: 621, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487566351890564, gen p mean: -0.3596135973930359, mean p set: 0.4492368996143341
The modified gen p mean: 0.4484628736972809, gen p mean: -0.36853253841400146, mean p set: 0.448943167924881
The modified gen p mean: 0.4493882358074188, gen p mean: -0.36994490027427673, mean p set: 0.4498685300350189
loss_pred:0.03590055927634239, decouple_loss:0.016919970512390137
loss_pred:0.036229509860277176, decouple_loss:0.017076315358281136
loss_pred:0.03468722850084305, decouple_loss:0.01677175797522068
Iteration: 622, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44974711537361145, gen p mean: -0.37133780121803284, mean p set: 0.45022737979888916
loss_pred:0.03672754764556885, decouple_loss:0.016056625172495842
The modified gen p mean: 0.4481106400489807, gen p mean: -0.36870840191841125, mean p set: 0.4485909342765808The modified gen p mean: 0.4491627514362335, gen p mean: -0.37222304940223694, mean p set: 0.44964301586151123
loss_pred:0.037158526480197906, decouple_loss:0.017831945791840553
loss_pred:0.035683050751686096, decouple_loss:0.017240144312381744
Iteration: 623, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478687345981598, gen p mean: -0.37215808033943176, mean p set: 0.4483490288257599
loss_pred:0.03617831692099571, decouple_loss:0.01674864999949932
The modified gen p mean: 0.44882893562316895, gen p mean: -0.37421971559524536, mean p set: 0.44930922985076904The modified gen p mean: 0.4493992328643799, gen p mean: -0.37582436203956604, mean p set: 0.44987955689430237
loss_pred:0.03495822474360466, decouple_loss:0.019142337143421173
loss_pred:0.035955898463726044, decouple_loss:0.017670946195721626
Iteration: 624, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481092393398285, gen p mean: -0.36327195167541504, mean p set: 0.4485895335674286
loss_pred:0.035451121628284454, decouple_loss:0.01667201891541481
The modified gen p mean: 0.44952392578125, gen p mean: -0.3741311728954315, mean p set: 0.4500042200088501The modified gen p mean: 0.4485054016113281, gen p mean: -0.3730239272117615, mean p set: 0.44898566603660583
loss_pred:0.03574080765247345, decouple_loss:0.017580721527338028
loss_pred:0.03575335070490837, decouple_loss:0.016620896756649017
Iteration: 625, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494730234146118, gen p mean: -0.3733619749546051, mean p set: 0.4499533474445343
loss_pred:0.03540828078985214, decouple_loss:0.017505526542663574
The modified gen p mean: 0.4493604004383087, gen p mean: -0.3692764341831207, mean p set: 0.4498407244682312The modified gen p mean: 0.4501529335975647, gen p mean: -0.3739495277404785, mean p set: 0.4506332576274872
loss_pred:0.03409755229949951, decouple_loss:0.01804470829665661
loss_pred:0.036043982952833176, decouple_loss:0.017163552343845367
Iteration: 626, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486570954322815, gen p mean: -0.3734784424304962, mean p set: 0.449137419462204
loss_pred:0.03666817769408226, decouple_loss:0.01698894239962101
The modified gen p mean: 0.44901958107948303, gen p mean: -0.37226009368896484, mean p set: 0.44949984550476074The modified gen p mean: 0.44998177886009216, gen p mean: -0.37558513879776, mean p set: 0.45046207308769226
loss_pred:0.03434773534536362, decouple_loss:0.01652366854250431
loss_pred:0.035669129341840744, decouple_loss:0.015609119087457657
Iteration: 627, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44884318113327026, gen p mean: -0.381494402885437, mean p set: 0.44932347536087036
loss_pred:0.034708745777606964, decouple_loss:0.015610303729772568
The modified gen p mean: 0.44935813546180725, gen p mean: -0.386505126953125, mean p set: 0.44983842968940735The modified gen p mean: 0.44897758960723877, gen p mean: -0.3822384178638458, mean p set: 0.44945788383483887
loss_pred:0.03612653166055679, decouple_loss:0.017177501693367958
loss_pred:0.035044170916080475, decouple_loss:0.015831435099244118
Iteration: 628, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44854825735092163, gen p mean: -0.3822045624256134, mean p set: 0.44902855157852173
loss_pred:0.03542044386267662, decouple_loss:0.01669582724571228
The modified gen p mean: 0.4476395547389984, gen p mean: -0.3865068554878235, mean p set: 0.4481198489665985The modified gen p mean: 0.44888004660606384, gen p mean: -0.38462764024734497, mean p set: 0.44936034083366394
loss_pred:0.03496946021914482, decouple_loss:0.016396602615714073
loss_pred:0.035046566277742386, decouple_loss:0.015863319858908653
Iteration: 629, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473860263824463, gen p mean: -0.38412466645240784, mean p set: 0.4478663504123688
loss_pred:0.035553913563489914, decouple_loss:0.016245201230049133
The modified gen p mean: 0.45015114545822144, gen p mean: -0.38311803340911865, mean p set: 0.45063140988349915The modified gen p mean: 0.4494432210922241, gen p mean: -0.37508922815322876, mean p set: 0.4499235153198242
loss_pred:0.03630547225475311, decouple_loss:0.016510920599102974
loss_pred:0.035681575536727905, decouple_loss:0.01811608113348484
Iteration: 630, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490791857242584, gen p mean: -0.3755132257938385, mean p set: 0.4495595097541809
loss_pred:0.03566090390086174, decouple_loss:0.01579061709344387
The modified gen p mean: 0.44856056571006775, gen p mean: -0.3801726698875427, mean p set: 0.44904085993766785The modified gen p mean: 0.4475764036178589, gen p mean: -0.3746488392353058, mean p set: 0.448056697845459
loss_pred:0.03446992114186287, decouple_loss:0.016797685995697975
loss_pred:0.036065492779016495, decouple_loss:0.015995152294635773
2023-05-01 13:05:29 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.38373830914497375, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.37406668066978455, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.3768230080604553, mean p set: 0.4500633478164673
loss_pred:0.035754211246967316, decouple_loss:0.016297081485390663
loss_pred:0.033960312604904175, decouple_loss:0.01611960679292679
loss_pred:0.0348241925239563, decouple_loss:0.015848658978939056
WV_0_PC_1_EH_0_PS_40_15, loss: 0.03565066307783127, avg_mse: 0.03918217867612839
current test mse: 0.039182
Iteration: 631, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488086700439453, gen p mean: -0.37949755787849426, mean p set: 0.449288934469223
The modified gen p mean: 0.4478866457939148, gen p mean: -0.37194958329200745, mean p set: 0.4483669102191925
The modified gen p mean: 0.4484816789627075, gen p mean: -0.3794725239276886, mean p set: 0.44896194338798523
loss_pred:0.03599688783288002, decouple_loss:0.016168462112545967
loss_pred:0.03542870655655861, decouple_loss:0.015194334089756012
loss_pred:0.03551984578371048, decouple_loss:0.015345335938036442
Iteration: 632, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44927430152893066, gen p mean: -0.3857155442237854, mean p set: 0.44975459575653076
loss_pred:0.035620417445898056, decouple_loss:0.016255773603916168
The modified gen p mean: 0.448865681886673, gen p mean: -0.3864523470401764, mean p set: 0.4493459463119507The modified gen p mean: 0.4481542408466339, gen p mean: -0.38443323969841003, mean p set: 0.448634535074234
loss_pred:0.03585075959563255, decouple_loss:0.016367116943001747
loss_pred:0.03471249341964722, decouple_loss:0.01617654785513878
Iteration: 633, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483877718448639, gen p mean: -0.3972356617450714, mean p set: 0.4488680362701416
loss_pred:0.03581439331173897, decouple_loss:0.015671027824282646
The modified gen p mean: 0.4497900903224945, gen p mean: -0.3978717625141144, mean p set: 0.4502703547477722The modified gen p mean: 0.4499039351940155, gen p mean: -0.3940250277519226, mean p set: 0.4503842294216156
loss_pred:0.03540198877453804, decouple_loss:0.016252033412456512
loss_pred:0.03602498397231102, decouple_loss:0.015304499305784702
Iteration: 634, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504079818725586, gen p mean: -0.3893027603626251, mean p set: 0.4508882462978363
loss_pred:0.03472975641489029, decouple_loss:0.015106459148228168
The modified gen p mean: 0.44981876015663147, gen p mean: -0.3868512511253357, mean p set: 0.45029905438423157The modified gen p mean: 0.447726845741272, gen p mean: -0.38847896456718445, mean p set: 0.44820713996887207
loss_pred:0.035232022404670715, decouple_loss:0.014378171414136887
loss_pred:0.03619981184601784, decouple_loss:0.015374040231108665
Iteration: 635, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44772836565971375, gen p mean: -0.38292133808135986, mean p set: 0.44820865988731384
loss_pred:0.035637266933918, decouple_loss:0.016282908618450165
The modified gen p mean: 0.4502018690109253, gen p mean: -0.38398805260658264, mean p set: 0.450682133436203The modified gen p mean: 0.4472452998161316, gen p mean: -0.3815060257911682, mean p set: 0.4477255642414093
loss_pred:0.035662487149238586, decouple_loss:0.01665150746703148
loss_pred:0.03432410955429077, decouple_loss:0.014697601087391376
Iteration: 636, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44813576340675354, gen p mean: -0.3803032636642456, mean p set: 0.44861605763435364
loss_pred:0.03520014509558678, decouple_loss:0.016424128785729408
The modified gen p mean: 0.4495813846588135, gen p mean: -0.38611283898353577, mean p set: 0.4500616788864136The modified gen p mean: 0.4492068290710449, gen p mean: -0.3821925222873688, mean p set: 0.449687123298645
loss_pred:0.03626171126961708, decouple_loss:0.015616029500961304
loss_pred:0.036501139402389526, decouple_loss:0.01642312854528427
Iteration: 637, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480966031551361, gen p mean: -0.38503506779670715, mean p set: 0.4485769271850586
loss_pred:0.035199277102947235, decouple_loss:0.015399955213069916
The modified gen p mean: 0.44852960109710693, gen p mean: -0.38562944531440735, mean p set: 0.44900989532470703The modified gen p mean: 0.44662219285964966, gen p mean: -0.3837549686431885, mean p set: 0.44710251688957214
loss_pred:0.035386353731155396, decouple_loss:0.015540076419711113
loss_pred:0.035019077360630035, decouple_loss:0.016411377117037773
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012019_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012019_3_24hr.npz
NaN value num: 0
Iteration: 638, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500710964202881, gen p mean: -0.38156434893608093, mean p set: 0.4505513906478882
loss_pred:0.035153016448020935, decouple_loss:0.014988314360380173
The modified gen p mean: 0.4490286111831665, gen p mean: -0.3738155663013458, mean p set: 0.4495089054107666The modified gen p mean: 0.45080986618995667, gen p mean: -0.37276148796081543, mean p set: 0.45129016041755676
loss_pred:0.03553284332156181, decouple_loss:0.014808578416705132
loss_pred:0.03549157828092575, decouple_loss:0.014727997593581676
Iteration: 639, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501873850822449, gen p mean: -0.3853236138820648, mean p set: 0.45066767930984497The modified gen p mean: 0.4500034749507904, gen p mean: -0.38312432169914246, mean p set: 0.4504837691783905
loss_pred:0.03580435737967491, decouple_loss:0.014974799007177353
loss_pred:0.035207364708185196, decouple_loss:0.015122296288609505
The modified gen p mean: 0.45090633630752563, gen p mean: -0.3821999728679657, mean p set: 0.45138660073280334
loss_pred:0.03472192957997322, decouple_loss:0.015074784867465496
Iteration: 640, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44860759377479553, gen p mean: -0.3887094557285309, mean p set: 0.44908788800239563
loss_pred:0.03672733157873154, decouple_loss:0.01596592739224434
The modified gen p mean: 0.44893956184387207, gen p mean: -0.39468148350715637, mean p set: 0.4494198262691498The modified gen p mean: 0.44803228974342346, gen p mean: -0.39146262407302856, mean p set: 0.44851261377334595
loss_pred:0.036173783242702484, decouple_loss:0.016483433544635773
loss_pred:0.03408074006438255, decouple_loss:0.014931835234165192
2023-05-01 13:08:04 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.400605171918869, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.39049986004829407, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.393400102853775, mean p set: 0.4500633478164673
loss_pred:0.03556590899825096, decouple_loss:0.01659761369228363
loss_pred:0.033904220908880234, decouple_loss:0.015689894556999207
loss_pred:0.03484080359339714, decouple_loss:0.015336806885898113
WV_0_PC_1_EH_0_PS_40_15, loss: 0.03556405007839203, avg_mse: 0.039138466119766235
current test mse: 0.039138
Iteration: 641, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498368203639984, gen p mean: -0.3898349404335022, mean p set: 0.4503171145915985
The modified gen p mean: 0.4501242935657501, gen p mean: -0.38565516471862793, mean p set: 0.4506046175956726
The modified gen p mean: 0.4492380619049072, gen p mean: -0.39190611243247986, mean p set: 0.4497183561325073
loss_pred:0.03579328954219818, decouple_loss:0.015685781836509705
loss_pred:0.03482301905751228, decouple_loss:0.01600370928645134
loss_pred:0.03560957685112953, decouple_loss:0.014515114948153496
Iteration: 642, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488268494606018, gen p mean: -0.3770137131214142, mean p set: 0.4493071436882019
loss_pred:0.0358203649520874, decouple_loss:0.016178075224161148
The modified gen p mean: 0.44858768582344055, gen p mean: -0.3765220642089844, mean p set: 0.44906798005104065The modified gen p mean: 0.450296014547348, gen p mean: -0.37833371758461, mean p set: 0.4507763385772705
loss_pred:0.03521033748984337, decouple_loss:0.01623103953897953
loss_pred:0.03527408465743065, decouple_loss:0.015299058519303799
Iteration: 643, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44948598742485046, gen p mean: -0.3715979754924774, mean p set: 0.44996631145477295
loss_pred:0.03465873375535011, decouple_loss:0.015544122084975243
The modified gen p mean: 0.44927504658699036, gen p mean: -0.3723013401031494, mean p set: 0.4497552812099457The modified gen p mean: 0.44965627789497375, gen p mean: -0.3702906668186188, mean p set: 0.45013657212257385
loss_pred:0.03471051901578903, decouple_loss:0.01567542925477028
loss_pred:0.03513304516673088, decouple_loss:0.015325956977903843
Iteration: 644, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491842985153198, gen p mean: -0.37851181626319885, mean p set: 0.4496645927429199
loss_pred:0.03571923077106476, decouple_loss:0.014558115974068642
The modified gen p mean: 0.4497874081134796, gen p mean: -0.37932902574539185, mean p set: 0.4502677023410797The modified gen p mean: 0.4503858983516693, gen p mean: -0.37730565667152405, mean p set: 0.4508661925792694
loss_pred:0.035462766885757446, decouple_loss:0.014513016678392887
loss_pred:0.03499351814389229, decouple_loss:0.016980469226837158
Iteration: 645, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449203222990036, gen p mean: -0.3783413767814636, mean p set: 0.4496835172176361
loss_pred:0.03527282550930977, decouple_loss:0.015705160796642303
The modified gen p mean: 0.44969239830970764, gen p mean: -0.3811115026473999, mean p set: 0.45017269253730774The modified gen p mean: 0.4497798681259155, gen p mean: -0.381590336561203, mean p set: 0.45026013255119324
loss_pred:0.03488575294613838, decouple_loss:0.015937304124236107
loss_pred:0.035277366638183594, decouple_loss:0.015108142048120499
Iteration: 646, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491962790489197, gen p mean: -0.3846760094165802, mean p set: 0.4496765732765198
loss_pred:0.035413794219493866, decouple_loss:0.016151659190654755
The modified gen p mean: 0.4501386880874634, gen p mean: -0.38431426882743835, mean p set: 0.4506189823150635The modified gen p mean: 0.4496731460094452, gen p mean: -0.37861478328704834, mean p set: 0.4501534700393677
loss_pred:0.03501884639263153, decouple_loss:0.015016582794487476
loss_pred:0.03539259359240532, decouple_loss:0.0153657803311944
Iteration: 647, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44797298312187195, gen p mean: -0.38013356924057007, mean p set: 0.44845327734947205
loss_pred:0.034507740288972855, decouple_loss:0.015376396477222443
The modified gen p mean: 0.44901034235954285, gen p mean: -0.38614824414253235, mean p set: 0.44949063658714294The modified gen p mean: 0.44919702410697937, gen p mean: -0.38129788637161255, mean p set: 0.44967731833457947
loss_pred:0.03456322103738785, decouple_loss:0.014385297894477844
loss_pred:0.03416961058974266, decouple_loss:0.015756865963339806
Iteration: 648, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489181935787201, gen p mean: -0.3822460174560547, mean p set: 0.4493984878063202
loss_pred:0.03560648486018181, decouple_loss:0.01516492385417223
The modified gen p mean: 0.44836920499801636, gen p mean: -0.3774677813053131, mean p set: 0.44884949922561646The modified gen p mean: 0.4492708444595337, gen p mean: -0.3774716556072235, mean p set: 0.4497511684894562
loss_pred:0.0360594242811203, decouple_loss:0.01535863894969225
loss_pred:0.03620893135666847, decouple_loss:0.01662309095263481
Iteration: 649, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501102566719055, gen p mean: -0.37317416071891785, mean p set: 0.4505905210971832
loss_pred:0.03506411984562874, decouple_loss:0.015294893644750118
The modified gen p mean: 0.4485131502151489, gen p mean: -0.3746459484100342, mean p set: 0.448993444442749The modified gen p mean: 0.4502295255661011, gen p mean: -0.37867602705955505, mean p set: 0.45070981979370117
loss_pred:0.035250596702098846, decouple_loss:0.016001781448721886
loss_pred:0.03538507595658302, decouple_loss:0.016589567065238953
Iteration: 650, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44903796911239624, gen p mean: -0.3755461275577545, mean p set: 0.4495182931423187
loss_pred:0.03553895279765129, decouple_loss:0.015154607594013214
The modified gen p mean: 0.4488612115383148, gen p mean: -0.37173792719841003, mean p set: 0.44934147596359253The modified gen p mean: 0.45082464814186096, gen p mean: -0.3754172623157501, mean p set: 0.45130491256713867
loss_pred:0.035630278289318085, decouple_loss:0.014557345770299435
loss_pred:0.03494202718138695, decouple_loss:0.015659838914871216
2023-05-01 13:09:57 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.38119664788246155, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.37194907665252686, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.37468063831329346, mean p set: 0.4500633478164673
loss_pred:0.03604133427143097, decouple_loss:0.015967154875397682
loss_pred:0.03410815820097923, decouple_loss:0.015830442309379578
loss_pred:0.035080425441265106, decouple_loss:0.015415558591485023
WV_0_PC_1_EH_0_PS_40_15, loss: 0.03586352616548538, avg_mse: 0.03958272561430931
current test mse: 0.039583
Iteration: 651, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483937919139862, gen p mean: -0.36535391211509705, mean p set: 0.4488740861415863
The modified gen p mean: 0.44765859842300415, gen p mean: -0.3684055209159851, mean p set: 0.44813892245292664
The modified gen p mean: 0.449287086725235, gen p mean: -0.36878183484077454, mean p set: 0.4497673809528351
loss_pred:0.03497237712144852, decouple_loss:0.015503407455980778
loss_pred:0.035096425563097, decouple_loss:0.014940217137336731loss_pred:0.03692473843693733, decouple_loss:0.01602507010102272
Iteration: 652, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44846558570861816, gen p mean: -0.37419605255126953, mean p set: 0.4489458501338959
loss_pred:0.03499447926878929, decouple_loss:0.014658122323453426
The modified gen p mean: 0.4486316740512848, gen p mean: -0.3694380521774292, mean p set: 0.4491119980812073The modified gen p mean: 0.4480297267436981, gen p mean: -0.37077242136001587, mean p set: 0.44850999116897583
loss_pred:0.035455457866191864, decouple_loss:0.014351826161146164
loss_pred:0.03587565943598747, decouple_loss:0.015233987011015415
Iteration: 653, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480578601360321, gen p mean: -0.37592074275016785, mean p set: 0.4485381245613098
loss_pred:0.03661985695362091, decouple_loss:0.01598733849823475
The modified gen p mean: 0.4496931731700897, gen p mean: -0.37887758016586304, mean p set: 0.4501734673976898
The modified gen p mean: 0.4505859315395355, gen p mean: -0.37792983651161194, mean p set: 0.45106619596481323
loss_pred:0.035436078906059265, decouple_loss:0.01541388500481844
loss_pred:0.034333985298871994, decouple_loss:0.01516981516033411
Iteration: 654, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494743347167969, gen p mean: -0.3774421513080597, mean p set: 0.44995465874671936
loss_pred:0.03495006635785103, decouple_loss:0.01717291586101055
The modified gen p mean: 0.4487408995628357, gen p mean: -0.3787698447704315, mean p set: 0.449221134185791The modified gen p mean: 0.4488588273525238, gen p mean: -0.36957284808158875, mean p set: 0.4493391215801239
loss_pred:0.035032857209444046, decouple_loss:0.015714211389422417
loss_pred:0.034721340984106064, decouple_loss:0.01489986851811409
Iteration: 655, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44911807775497437, gen p mean: -0.3721029758453369, mean p set: 0.44959837198257446
loss_pred:0.035238925367593765, decouple_loss:0.014636331237852573
The modified gen p mean: 0.44837287068367004, gen p mean: -0.36932656168937683, mean p set: 0.44885316491127014The modified gen p mean: 0.4492861032485962, gen p mean: -0.37245050072669983, mean p set: 0.4497663974761963
loss_pred:0.03509557619690895, decouple_loss:0.014344189316034317
loss_pred:0.034095101058483124, decouple_loss:0.0156815517693758
Iteration: 656, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494338631629944, gen p mean: -0.3762854337692261, mean p set: 0.44991418719291687
loss_pred:0.0349915586411953, decouple_loss:0.014536193571984768
The modified gen p mean: 0.44965094327926636, gen p mean: -0.37686657905578613, mean p set: 0.45013123750686646The modified gen p mean: 0.4506630599498749, gen p mean: -0.374103844165802, mean p set: 0.451143354177475
loss_pred:0.035448864102363586, decouple_loss:0.014784895814955235
loss_pred:0.03535962849855423, decouple_loss:0.015418061055243015
Iteration: 657, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44822654128074646, gen p mean: -0.37855732440948486, mean p set: 0.44870686531066895
loss_pred:0.03619437292218208, decouple_loss:0.015094165690243244
The modified gen p mean: 0.4492669105529785, gen p mean: -0.38026902079582214, mean p set: 0.4497471749782562The modified gen p mean: 0.4493621587753296, gen p mean: -0.3766534924507141, mean p set: 0.4498424530029297
loss_pred:0.03314362093806267, decouple_loss:0.01540462952107191
loss_pred:0.034960731863975525, decouple_loss:0.01516873948276043
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012012_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012012_3_24hr.npz
NaN value num: 0
Iteration: 658, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45013538002967834, gen p mean: -0.38064780831336975, mean p set: 0.45061564445495605
loss_pred:0.034196238964796066, decouple_loss:0.016563836485147476
The modified gen p mean: 0.4498424530029297, gen p mean: -0.38377678394317627, mean p set: 0.4503227472305298The modified gen p mean: 0.45089876651763916, gen p mean: -0.3859483599662781, mean p set: 0.45137903094291687
loss_pred:0.035298384726047516, decouple_loss:0.018001222983002663
loss_pred:0.03558113053441048, decouple_loss:0.019700653851032257
Iteration: 659, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45037803053855896, gen p mean: -0.38998326659202576, mean p set: 0.45085835456848145
loss_pred:0.035352516919374466, decouple_loss:0.020126143470406532
The modified gen p mean: 0.4499151110649109, gen p mean: -0.3861648440361023, mean p set: 0.450395405292511
The modified gen p mean: 0.45056042075157166, gen p mean: -0.3860754072666168, mean p set: 0.45104068517684937
loss_pred:0.034252315759658813, decouple_loss:0.016453949734568596
loss_pred:0.03494451195001602, decouple_loss:0.018347691744565964
Iteration: 660, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488760232925415, gen p mean: -0.38653144240379333, mean p set: 0.4493563175201416
loss_pred:0.03577831760048866, decouple_loss:0.016328882426023483
The modified gen p mean: 0.4509672224521637, gen p mean: -0.38974499702453613, mean p set: 0.4514475464820862The modified gen p mean: 0.44951504468917847, gen p mean: -0.38512715697288513, mean p set: 0.44999533891677856
loss_pred:0.03516058996319771, decouple_loss:0.017605243250727654
loss_pred:0.03496681526303291, decouple_loss:0.017029007896780968
2023-05-01 13:12:30 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.4063965976238251, mean p set: 0.4502691626548767
The modified gen p mean: 0.4498766362667084, gen p mean: -0.39529934525489807, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.39940690994262695, mean p set: 0.4500633478164673
loss_pred:0.035834766924381256, decouple_loss:0.017583729699254036
loss_pred:0.03397651016712189, decouple_loss:0.01728092133998871
loss_pred:0.03482547774910927, decouple_loss:0.016896503046154976
WV_0_PC_1_EH_0_PS_40_15, loss: 0.03574160486459732, avg_mse: 0.03955443948507309
current test mse: 0.039554
Iteration: 661, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495808780193329, gen p mean: -0.4030683636665344, mean p set: 0.450061172246933
The modified gen p mean: 0.4481469690799713, gen p mean: -0.40604493021965027, mean p set: 0.4486272633075714
The modified gen p mean: 0.44954437017440796, gen p mean: -0.3936009109020233, mean p set: 0.45002463459968567
loss_pred:0.03378937393426895, decouple_loss:0.01562135387212038
loss_pred:0.03434564173221588, decouple_loss:0.016895633190870285
loss_pred:0.03662814199924469, decouple_loss:0.016862042248249054
Iteration: 662, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4522729516029358, gen p mean: -0.4086475670337677, mean p set: 0.4527532756328583
loss_pred:0.03445740416646004, decouple_loss:0.01754382811486721
The modified gen p mean: 0.4497430920600891, gen p mean: -0.4048733413219452, mean p set: 0.4502233564853668The modified gen p mean: 0.44909605383872986, gen p mean: -0.40118592977523804, mean p set: 0.44957631826400757
loss_pred:0.03469030559062958, decouple_loss:0.017060354351997375
loss_pred:0.03490246459841728, decouple_loss:0.015324247069656849
Iteration: 663, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502578377723694, gen p mean: -0.3957507610321045, mean p set: 0.4507381319999695
loss_pred:0.03390855714678764, decouple_loss:0.015734167769551277
The modified gen p mean: 0.45121529698371887, gen p mean: -0.4042515754699707, mean p set: 0.45169559121131897The modified gen p mean: 0.45145395398139954, gen p mean: -0.4032856523990631, mean p set: 0.45193424820899963
loss_pred:0.035650454461574554, decouple_loss:0.01591472141444683
loss_pred:0.03507032245397568, decouple_loss:0.016030199825763702
Iteration: 664, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498869776725769, gen p mean: -0.38986825942993164, mean p set: 0.4503673017024994
The modified gen p mean: 0.4493556320667267, gen p mean: -0.40102601051330566, mean p set: 0.4498359262943268
loss_pred:0.03369347006082535, decouple_loss:0.014952468685805798
loss_pred:0.03439418971538544, decouple_loss:0.015703370794653893
The modified gen p mean: 0.4519721567630768, gen p mean: -0.3975358307361603, mean p set: 0.4524524509906769
loss_pred:0.03358509764075279, decouple_loss:0.016141265630722046
Iteration: 665, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45019590854644775, gen p mean: -0.38980093598365784, mean p set: 0.45067617297172546
The modified gen p mean: 0.45147770643234253, gen p mean: -0.3983331024646759, mean p set: 0.4519580006599426
loss_pred:0.033301688730716705, decouple_loss:0.014633645303547382
loss_pred:0.034920789301395416, decouple_loss:0.01638268306851387
The modified gen p mean: 0.44874173402786255, gen p mean: -0.39365461468696594, mean p set: 0.44922199845314026
loss_pred:0.03439154103398323, decouple_loss:0.015680348500609398
Iteration: 666, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500104486942291, gen p mean: -0.3994617760181427, mean p set: 0.4504907429218292
The modified gen p mean: 0.4503837525844574, gen p mean: -0.39483243227005005, mean p set: 0.4508640468120575
loss_pred:0.03583049401640892, decouple_loss:0.014857342466711998
loss_pred:0.03446577489376068, decouple_loss:0.014794070273637772
The modified gen p mean: 0.4508315324783325, gen p mean: -0.40134021639823914, mean p set: 0.4513118267059326
loss_pred:0.03365495055913925, decouple_loss:0.014975094236433506
Iteration: 667, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45023173093795776, gen p mean: -0.40307381749153137, mean p set: 0.45071205496788025
The modified gen p mean: 0.45040807127952576, gen p mean: -0.4003596603870392, mean p set: 0.45088836550712585
loss_pred:0.03429074585437775, decouple_loss:0.015647945925593376
The modified gen p mean: 0.45172998309135437, gen p mean: -0.4015725255012512, mean p set: 0.45221027731895447
loss_pred:0.03409060090780258, decouple_loss:0.015151049941778183
loss_pred:0.034458693116903305, decouple_loss:0.01627773605287075
Iteration: 668, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4533083140850067, gen p mean: -0.404217392206192, mean p set: 0.4537885785102844
The modified gen p mean: 0.4503800570964813, gen p mean: -0.3991195559501648, mean p set: 0.4508603513240814
loss_pred:0.03238880634307861, decouple_loss:0.014734501019120216
loss_pred:0.035052310675382614, decouple_loss:0.014219305478036404
The modified gen p mean: 0.4500272572040558, gen p mean: -0.40271031856536865, mean p set: 0.4505075514316559
loss_pred:0.03609480336308479, decouple_loss:0.014830481261014938
Iteration: 669, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494835436344147, gen p mean: -0.4046897888183594, mean p set: 0.44996383786201477
The modified gen p mean: 0.4503077566623688, gen p mean: -0.40339168906211853, mean p set: 0.45078805088996887
loss_pred:0.03521685674786568, decouple_loss:0.015124072320759296
loss_pred:0.03437718749046326, decouple_loss:0.015116891823709011
The modified gen p mean: 0.44978445768356323, gen p mean: -0.3972032368183136, mean p set: 0.4502647817134857
loss_pred:0.034486498683691025, decouple_loss:0.014384070411324501
Iteration: 670, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44931164383888245, gen p mean: -0.4016692340373993, mean p set: 0.44979190826416016
The modified gen p mean: 0.452502965927124, gen p mean: -0.40866824984550476, mean p set: 0.4529832601547241
loss_pred:0.035084400326013565, decouple_loss:0.01415302325040102
loss_pred:0.03280245140194893, decouple_loss:0.01460057869553566
The modified gen p mean: 0.45002520084381104, gen p mean: -0.4072912335395813, mean p set: 0.4505055248737335
loss_pred:0.03391844779253006, decouple_loss:0.015220467932522297
2023-05-01 13:14:25 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.4094548523426056, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.39945730566978455, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.4027317464351654, mean p set: 0.4500633478164673
loss_pred:0.03570627421140671, decouple_loss:0.016638807952404022
loss_pred:0.03376774862408638, decouple_loss:0.0169829148799181
loss_pred:0.03464838117361069, decouple_loss:0.016068855300545692
WV_0_PC_1_EH_0_PS_40_15, loss: 0.03553564473986626, avg_mse: 0.03941219300031662
current test mse: 0.039412
Iteration: 671, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45020461082458496, gen p mean: -0.40641483664512634, mean p set: 0.45068490505218506
The modified gen p mean: 0.44999271631240845, gen p mean: -0.40738871693611145, mean p set: 0.45047301054000854
The modified gen p mean: 0.4493119716644287, gen p mean: -0.40710464119911194, mean p set: 0.4497922658920288
loss_pred:0.03446817025542259, decouple_loss:0.014247993007302284
loss_pred:0.0346941202878952, decouple_loss:0.014721510000526905
loss_pred:0.034937601536512375, decouple_loss:0.015228770673274994
Iteration: 672, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502831995487213, gen p mean: -0.4117625057697296, mean p set: 0.4507634937763214
loss_pred:0.03442058712244034, decouple_loss:0.014943660236895084
The modified gen p mean: 0.44950199127197266, gen p mean: -0.40816375613212585, mean p set: 0.44998228549957275The modified gen p mean: 0.4498305916786194, gen p mean: -0.40449774265289307, mean p set: 0.4503108859062195
loss_pred:0.034274980425834656, decouple_loss:0.01432526484131813
loss_pred:0.034403443336486816, decouple_loss:0.015449143014848232
Iteration: 673, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501749873161316, gen p mean: -0.4139147400856018, mean p set: 0.4506552517414093
loss_pred:0.03665974736213684, decouple_loss:0.014675487764179707
The modified gen p mean: 0.45165199041366577, gen p mean: -0.4193429946899414, mean p set: 0.45213228464126587The modified gen p mean: 0.452386736869812, gen p mean: -0.41304442286491394, mean p set: 0.4528670310974121
loss_pred:0.03399264067411423, decouple_loss:0.01594434678554535
loss_pred:0.03453117609024048, decouple_loss:0.015601608902215958
Iteration: 674, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490496814250946, gen p mean: -0.41438624262809753, mean p set: 0.4495299756526947
loss_pred:0.03467218205332756, decouple_loss:0.01363827008754015
The modified gen p mean: 0.4496683180332184, gen p mean: -0.408854603767395, mean p set: 0.4501486122608185The modified gen p mean: 0.4494783580303192, gen p mean: -0.41104575991630554, mean p set: 0.4499586224555969
loss_pred:0.034425824880599976, decouple_loss:0.013621664606034756
loss_pred:0.034919336438179016, decouple_loss:0.01419348269701004
Iteration: 675, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44869574904441833, gen p mean: -0.4026494324207306, mean p set: 0.44917601346969604
loss_pred:0.03390637785196304, decouple_loss:0.01433277316391468
The modified gen p mean: 0.44941961765289307, gen p mean: -0.4051904082298279, mean p set: 0.44989991188049316The modified gen p mean: 0.4521687626838684, gen p mean: -0.41203808784484863, mean p set: 0.4526490569114685
loss_pred:0.03487597033381462, decouple_loss:0.013990586623549461
loss_pred:0.03368113934993744, decouple_loss:0.01448972336947918
Iteration: 676, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.452571302652359, gen p mean: -0.4162757694721222, mean p set: 0.4530515968799591
loss_pred:0.0330951027572155, decouple_loss:0.014013685286045074
The modified gen p mean: 0.44925764203071594, gen p mean: -0.40475940704345703, mean p set: 0.44973790645599365The modified gen p mean: 0.4486158788204193, gen p mean: -0.4050608277320862, mean p set: 0.4490962028503418
loss_pred:0.03288714587688446, decouple_loss:0.013273048214614391
loss_pred:0.03378693759441376, decouple_loss:0.013361794874072075
Iteration: 677, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485391080379486, gen p mean: -0.4240868091583252, mean p set: 0.4490193724632263
loss_pred:0.03364301845431328, decouple_loss:0.014785918407142162
The modified gen p mean: 0.4491752088069916, gen p mean: -0.4174079895019531, mean p set: 0.4496554732322693The modified gen p mean: 0.45253437757492065, gen p mean: -0.427803099155426, mean p set: 0.45301464200019836
loss_pred:0.03379214555025101, decouple_loss:0.015341805294156075
loss_pred:0.03422379121184349, decouple_loss:0.01404605247080326
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012014_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012014_3_24hr.npz
NaN value num: 0
Iteration: 678, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500284194946289, gen p mean: -0.41963547468185425, mean p set: 0.450508713722229
loss_pred:0.03272420912981033, decouple_loss:0.015879979357123375
The modified gen p mean: 0.4484436810016632, gen p mean: -0.41151589155197144, mean p set: 0.4489240050315857The modified gen p mean: 0.4495542049407959, gen p mean: -0.41853031516075134, mean p set: 0.4500344693660736
loss_pred:0.03523501381278038, decouple_loss:0.017032461240887642
loss_pred:0.03672647103667259, decouple_loss:0.01713269017636776
Iteration: 679, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.452470064163208, gen p mean: -0.41255319118499756, mean p set: 0.4529503583908081
loss_pred:0.034835800528526306, decouple_loss:0.015839213505387306
The modified gen p mean: 0.449733167886734, gen p mean: -0.4116320312023163, mean p set: 0.4502134323120117The modified gen p mean: 0.4513009190559387, gen p mean: -0.40301513671875, mean p set: 0.4517812132835388
loss_pred:0.03500375524163246, decouple_loss:0.014994223602116108
loss_pred:0.03415042906999588, decouple_loss:0.01647214964032173
Iteration: 680, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44814273715019226, gen p mean: -0.4115074872970581, mean p set: 0.44862303137779236
loss_pred:0.03437119722366333, decouple_loss:0.016224047169089317
The modified gen p mean: 0.45051509141921997, gen p mean: -0.40698134899139404, mean p set: 0.45099538564682007The modified gen p mean: 0.4490130841732025, gen p mean: -0.4059392511844635, mean p set: 0.4494934380054474
loss_pred:0.033942148089408875, decouple_loss:0.015734655782580376
loss_pred:0.03454338386654854, decouple_loss:0.016329467296600342
2023-05-01 13:16:59 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.4194321930408478, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.4085100591182709, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.4120776653289795, mean p set: 0.4500633478164673
loss_pred:0.03567296639084816, decouple_loss:0.01693054288625717
loss_pred:0.03378106281161308, decouple_loss:0.016844285652041435
loss_pred:0.03461238369345665, decouple_loss:0.016329731792211533
WV_0_PC_1_EH_0_PS_40_15, loss: 0.03552388399839401, avg_mse: 0.03938748687505722
current test mse: 0.039387
Iteration: 681, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448270708322525, gen p mean: -0.4118742346763611, mean p set: 0.4487510621547699
The modified gen p mean: 0.4497763216495514, gen p mean: -0.4106529951095581, mean p set: 0.4502566158771515
The modified gen p mean: 0.44990232586860657, gen p mean: -0.4041518568992615, mean p set: 0.45038262009620667
loss_pred:0.034863028675317764, decouple_loss:0.014481699094176292
loss_pred:0.03542119264602661, decouple_loss:0.014920316636562347
loss_pred:0.0352516770362854, decouple_loss:0.014866773970425129
Iteration: 682, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449812114238739, gen p mean: -0.41585758328437805, mean p set: 0.4502924084663391
loss_pred:0.0339832603931427, decouple_loss:0.014934887178242207
The modified gen p mean: 0.44963744282722473, gen p mean: -0.4147060215473175, mean p set: 0.45011773705482483The modified gen p mean: 0.44825178384780884, gen p mean: -0.409858763217926, mean p set: 0.44873207807540894
loss_pred:0.034135960042476654, decouple_loss:0.016175881028175354
loss_pred:0.03589800372719765, decouple_loss:0.014991553500294685
Iteration: 683, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44789403676986694, gen p mean: -0.42082130908966064, mean p set: 0.44837433099746704
loss_pred:0.035189349204301834, decouple_loss:0.015317793004214764
The modified gen p mean: 0.4502730667591095, gen p mean: -0.4132528007030487, mean p set: 0.4507533609867096The modified gen p mean: 0.4489746391773224, gen p mean: -0.41590505838394165, mean p set: 0.4494549334049225
loss_pred:0.035078421235084534, decouple_loss:0.014954364858567715
loss_pred:0.03352050855755806, decouple_loss:0.014794863760471344
Iteration: 684, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45023342967033386, gen p mean: -0.41570979356765747, mean p set: 0.45071372389793396
loss_pred:0.03347558155655861, decouple_loss:0.014614393934607506
The modified gen p mean: 0.44900038838386536, gen p mean: -0.4233822822570801, mean p set: 0.44948065280914307The modified gen p mean: 0.45186713337898254, gen p mean: -0.4196338653564453, mean p set: 0.45234742760658264
loss_pred:0.03492071107029915, decouple_loss:0.015073555521667004
loss_pred:0.03364963084459305, decouple_loss:0.015002013184130192
Iteration: 685, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490300416946411, gen p mean: -0.4189765453338623, mean p set: 0.4495103359222412
loss_pred:0.036531999707221985, decouple_loss:0.016367528587579727
The modified gen p mean: 0.44966378808021545, gen p mean: -0.4189418852329254, mean p set: 0.45014408230781555The modified gen p mean: 0.4494032859802246, gen p mean: -0.41881024837493896, mean p set: 0.4498836100101471
loss_pred:0.035876818001270294, decouple_loss:0.016350923106074333
loss_pred:0.035753726959228516, decouple_loss:0.014143337495625019
Iteration: 686, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44946563243865967, gen p mean: -0.4164438843727112, mean p set: 0.4499458968639374
loss_pred:0.0354653038084507, decouple_loss:0.014232899062335491
The modified gen p mean: 0.4489809274673462, gen p mean: -0.4201200306415558, mean p set: 0.4494612514972687The modified gen p mean: 0.44906070828437805, gen p mean: -0.41927579045295715, mean p set: 0.44954103231430054
loss_pred:0.035708364099264145, decouple_loss:0.015335384756326675
loss_pred:0.03431658446788788, decouple_loss:0.01576731726527214
Iteration: 687, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483394920825958, gen p mean: -0.4122561514377594, mean p set: 0.4488198161125183
loss_pred:0.03707640990614891, decouple_loss:0.014297101646661758
The modified gen p mean: 0.4501833915710449, gen p mean: -0.4156782031059265, mean p set: 0.450663685798645The modified gen p mean: 0.450116902589798, gen p mean: -0.4168992042541504, mean p set: 0.45059719681739807
loss_pred:0.033873509615659714, decouple_loss:0.015308661386370659
loss_pred:0.03294210135936737, decouple_loss:0.014162168838083744
Iteration: 688, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493236243724823, gen p mean: -0.41586989164352417, mean p set: 0.4498039484024048
loss_pred:0.035058699548244476, decouple_loss:0.014067848213016987
The modified gen p mean: 0.45149093866348267, gen p mean: -0.4127095341682434, mean p set: 0.45197123289108276The modified gen p mean: 0.44875451922416687, gen p mean: -0.4124481678009033, mean p set: 0.4492347836494446
loss_pred:0.0357351154088974, decouple_loss:0.015236331149935722
loss_pred:0.034059181809425354, decouple_loss:0.014523531310260296
Iteration: 689, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4506288766860962, gen p mean: -0.415507435798645, mean p set: 0.4511091411113739
loss_pred:0.03431834653019905, decouple_loss:0.01462052296847105
The modified gen p mean: 0.4518488347530365, gen p mean: -0.41633880138397217, mean p set: 0.4523291289806366The modified gen p mean: 0.45019155740737915, gen p mean: -0.41569608449935913, mean p set: 0.45067182183265686
loss_pred:0.033850736916065216, decouple_loss:0.01496019959449768
loss_pred:0.03371826186776161, decouple_loss:0.01451841276139021
Iteration: 690, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44838157296180725, gen p mean: -0.41502922773361206, mean p set: 0.44886186718940735
loss_pred:0.03435734659433365, decouple_loss:0.015121819451451302
The modified gen p mean: 0.4522463381290436, gen p mean: -0.41351816058158875, mean p set: 0.4527266025543213The modified gen p mean: 0.44969624280929565, gen p mean: -0.4118809401988983, mean p set: 0.45017653703689575
loss_pred:0.035433974117040634, decouple_loss:0.014910397119820118
loss_pred:0.0352463498711586, decouple_loss:0.014590161852538586
2023-05-01 13:18:53 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.42502954602241516, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.41415315866470337, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.41722309589385986, mean p set: 0.4500633478164673
loss_pred:0.035749126225709915, decouple_loss:0.016298780217766762
loss_pred:0.03376957029104233, decouple_loss:0.01630755327641964
loss_pred:0.03468964621424675, decouple_loss:0.016069499775767326
WV_0_PC_1_EH_0_PS_40_15, loss: 0.03554737940430641, avg_mse: 0.03969487547874451
current test mse: 0.039695
Iteration: 691, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45101815462112427, gen p mean: -0.41092315316200256, mean p set: 0.45149844884872437
The modified gen p mean: 0.45069873332977295, gen p mean: -0.4083675146102905, mean p set: 0.45117899775505066
The modified gen p mean: 0.4490245580673218, gen p mean: -0.4101546108722687, mean p set: 0.4495048522949219
loss_pred:0.035932522267103195, decouple_loss:0.015239698812365532
loss_pred:0.03419981151819229, decouple_loss:0.014971747994422913loss_pred:0.03372880071401596, decouple_loss:0.01535154227167368
Iteration: 692, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484897255897522, gen p mean: -0.41008007526397705, mean p set: 0.4489700198173523
loss_pred:0.034307464957237244, decouple_loss:0.014933095313608646
The modified gen p mean: 0.4476169943809509, gen p mean: -0.4174303710460663, mean p set: 0.44809725880622864The modified gen p mean: 0.45081615447998047, gen p mean: -0.40512871742248535, mean p set: 0.45129647850990295
loss_pred:0.034400880336761475, decouple_loss:0.015328120440244675
loss_pred:0.0344400554895401, decouple_loss:0.014723613858222961
Iteration: 693, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45175960659980774, gen p mean: -0.4057924747467041, mean p set: 0.45223987102508545
loss_pred:0.03327249363064766, decouple_loss:0.013869713991880417
The modified gen p mean: 0.4508685767650604, gen p mean: -0.39861199259757996, mean p set: 0.4513488709926605The modified gen p mean: 0.4489710330963135, gen p mean: -0.4063403904438019, mean p set: 0.4494513273239136
loss_pred:0.03542095050215721, decouple_loss:0.015407130122184753
loss_pred:0.034090735018253326, decouple_loss:0.013651912100613117
Iteration: 694, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44812554121017456, gen p mean: -0.4157659113407135, mean p set: 0.44860586524009705
loss_pred:0.03515215963125229, decouple_loss:0.01526773814111948
The modified gen p mean: 0.4523509442806244, gen p mean: -0.4101778566837311, mean p set: 0.4528312385082245The modified gen p mean: 0.44875484704971313, gen p mean: -0.40440985560417175, mean p set: 0.44923514127731323
loss_pred:0.03312717005610466, decouple_loss:0.014607763849198818
loss_pred:0.035749033093452454, decouple_loss:0.015543527901172638
Iteration: 695, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494289457798004, gen p mean: -0.41814976930618286, mean p set: 0.4499092102050781
loss_pred:0.03296181559562683, decouple_loss:0.014453158713877201
The modified gen p mean: 0.44875380396842957, gen p mean: -0.4151304364204407, mean p set: 0.4492340683937073The modified gen p mean: 0.4490962624549866, gen p mean: -0.41601622104644775, mean p set: 0.4495765268802643
loss_pred:0.03480451554059982, decouple_loss:0.014718160964548588
loss_pred:0.03567623719573021, decouple_loss:0.014688661321997643
Iteration: 696, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4509003162384033, gen p mean: -0.41679733991622925, mean p set: 0.4513806104660034
loss_pred:0.033029913902282715, decouple_loss:0.01534503884613514
The modified gen p mean: 0.4489068388938904, gen p mean: -0.4172247350215912, mean p set: 0.4493871033191681The modified gen p mean: 0.44933462142944336, gen p mean: -0.41285645961761475, mean p set: 0.44981491565704346
loss_pred:0.03566870838403702, decouple_loss:0.014005807228386402
loss_pred:0.03407168760895729, decouple_loss:0.014725473709404469
Iteration: 697, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494486153125763, gen p mean: -0.41586822271347046, mean p set: 0.4499289393424988
loss_pred:0.034210000187158585, decouple_loss:0.014172994531691074
The modified gen p mean: 0.4486936330795288, gen p mean: -0.41013965010643005, mean p set: 0.4491738975048065The modified gen p mean: 0.4490867555141449, gen p mean: -0.41323181986808777, mean p set: 0.449567049741745
loss_pred:0.035927269607782364, decouple_loss:0.013968550600111485
loss_pred:0.03543420135974884, decouple_loss:0.014341797679662704
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012007_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012007_3_24hr.npz
NaN value num: 0
Iteration: 698, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4509720802307129, gen p mean: -0.41512763500213623, mean p set: 0.451452374458313
loss_pred:0.03453774377703667, decouple_loss:0.015581194311380386
The modified gen p mean: 0.4505383372306824, gen p mean: -0.4147786796092987, mean p set: 0.4510186016559601The modified gen p mean: 0.4521506130695343, gen p mean: -0.41583606600761414, mean p set: 0.4526309072971344
loss_pred:0.03457479178905487, decouple_loss:0.01666099764406681
loss_pred:0.034119974821805954, decouple_loss:0.017309967428445816
Iteration: 699, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4522641897201538, gen p mean: -0.4183101952075958, mean p set: 0.4527444541454315
loss_pred:0.03357825055718422, decouple_loss:0.015744583681225777
The modified gen p mean: 0.4530586898326874, gen p mean: -0.42480090260505676, mean p set: 0.4535389542579651The modified gen p mean: 0.45180991291999817, gen p mean: -0.4147360324859619, mean p set: 0.45229020714759827
loss_pred:0.033222950994968414, decouple_loss:0.016912411898374557
loss_pred:0.03470476344227791, decouple_loss:0.014962390996515751
Iteration: 700, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45048317313194275, gen p mean: -0.4258522689342499, mean p set: 0.45096346735954285
loss_pred:0.034717727452516556, decouple_loss:0.015019126236438751
The modified gen p mean: 0.453479140996933, gen p mean: -0.42459896206855774, mean p set: 0.45395946502685547The modified gen p mean: 0.4513258635997772, gen p mean: -0.4212827682495117, mean p set: 0.45180612802505493
loss_pred:0.03258708864450455, decouple_loss:0.015365500934422016
loss_pred:0.03458652272820473, decouple_loss:0.015530373901128769
2023-05-01 13:21:27 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.43053561449050903, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987669587135315, gen p mean: -0.41878625750541687, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830237865448, gen p mean: -0.422587126493454, mean p set: 0.4500633478164673
loss_pred:0.035688843578100204, decouple_loss:0.01648140326142311
loss_pred:0.033933449536561966, decouple_loss:0.016690118238329887
loss_pred:0.0347210131585598, decouple_loss:0.016028467565774918
WV_0_PC_1_EH_0_PS_40_15, loss: 0.03560110181570053, avg_mse: 0.03975952789187431
current test mse: 0.03976
Iteration: 701, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45221829414367676, gen p mean: -0.4210619330406189, mean p set: 0.45269855856895447
The modified gen p mean: 0.4536548852920532, gen p mean: -0.42566728591918945, mean p set: 0.4541351795196533
The modified gen p mean: 0.4511546194553375, gen p mean: -0.4233498275279999, mean p set: 0.4516349136829376
loss_pred:0.034778665751218796, decouple_loss:0.01567171700298786
loss_pred:0.03266439959406853, decouple_loss:0.014650222845375538
loss_pred:0.0323944166302681, decouple_loss:0.015657763928174973
Iteration: 702, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4520118534564972, gen p mean: -0.4221792221069336, mean p set: 0.4524921178817749
loss_pred:0.03264843299984932, decouple_loss:0.015483062714338303
The modified gen p mean: 0.4516957700252533, gen p mean: -0.4157324433326721, mean p set: 0.4521760940551758The modified gen p mean: 0.4510241150856018, gen p mean: -0.4201361835002899, mean p set: 0.4515043795108795
loss_pred:0.03414328023791313, decouple_loss:0.015294305048882961
loss_pred:0.033708617091178894, decouple_loss:0.014937321655452251
Iteration: 703, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45056912302970886, gen p mean: -0.4083085358142853, mean p set: 0.4510493874549866
loss_pred:0.03639504685997963, decouple_loss:0.016036098822951317
The modified gen p mean: 0.4539129436016083, gen p mean: -0.42023733258247375, mean p set: 0.45439326763153076The modified gen p mean: 0.4508700370788574, gen p mean: -0.417125940322876, mean p set: 0.4513503611087799
loss_pred:0.03463086113333702, decouple_loss:0.015736941248178482
loss_pred:0.033032067120075226, decouple_loss:0.015465001575648785
Iteration: 704, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45249706506729126, gen p mean: -0.423920601606369, mean p set: 0.45297735929489136
loss_pred:0.031844910234212875, decouple_loss:0.014781630598008633
The modified gen p mean: 0.4527204632759094, gen p mean: -0.42920351028442383, mean p set: 0.45320072770118713The modified gen p mean: 0.45096468925476074, gen p mean: -0.42720621824264526, mean p set: 0.4514450132846832
loss_pred:0.032306984066963196, decouple_loss:0.015392540022730827
loss_pred:0.034034304320812225, decouple_loss:0.015347940847277641
Iteration: 705, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45276230573654175, gen p mean: -0.4304557144641876, mean p set: 0.45324259996414185
loss_pred:0.031189486384391785, decouple_loss:0.014620045199990273
The modified gen p mean: 0.4511820375919342, gen p mean: -0.4296536147594452, mean p set: 0.4516623318195343The modified gen p mean: 0.4508441090583801, gen p mean: -0.4340575039386749, mean p set: 0.4513244330883026
loss_pred:0.034437086433172226, decouple_loss:0.014838027767837048
loss_pred:0.034255705773830414, decouple_loss:0.015346276573836803
Iteration: 706, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45141997933387756, gen p mean: -0.43033915758132935, mean p set: 0.4519002437591553
loss_pred:0.03244706243276596, decouple_loss:0.016382936388254166
The modified gen p mean: 0.4515138268470764, gen p mean: -0.4311293661594391, mean p set: 0.4519941210746765The modified gen p mean: 0.4529424011707306, gen p mean: -0.4371364414691925, mean p set: 0.4534226953983307
loss_pred:0.03227442130446434, decouple_loss:0.015442894771695137
loss_pred:0.033474769443273544, decouple_loss:0.014937532134354115
Iteration: 707, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450749009847641, gen p mean: -0.4150838553905487, mean p set: 0.4512292742729187
loss_pred:0.03626260906457901, decouple_loss:0.01492951437830925
The modified gen p mean: 0.4513101279735565, gen p mean: -0.4181579649448395, mean p set: 0.4517904222011566The modified gen p mean: 0.4513746201992035, gen p mean: -0.4258196949958801, mean p set: 0.4518548846244812
loss_pred:0.035764388740062714, decouple_loss:0.01499071717262268
loss_pred:0.0345589816570282, decouple_loss:0.015158208087086678
Iteration: 708, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45104166865348816, gen p mean: -0.4231230914592743, mean p set: 0.45152196288108826
loss_pred:0.03384203836321831, decouple_loss:0.015790821984410286
The modified gen p mean: 0.4508156180381775, gen p mean: -0.41550755500793457, mean p set: 0.4512959122657776The modified gen p mean: 0.4522281885147095, gen p mean: -0.425273597240448, mean p set: 0.45270848274230957
loss_pred:0.032547250390052795, decouple_loss:0.015903832390904427
loss_pred:0.03398637846112251, decouple_loss:0.015402336604893208
Iteration: 709, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4522453844547272, gen p mean: -0.4265088438987732, mean p set: 0.4527256488800049
loss_pred:0.03274248167872429, decouple_loss:0.015473541803658009
The modified gen p mean: 0.45246726274490356, gen p mean: -0.42541080713272095, mean p set: 0.45294755697250366The modified gen p mean: 0.4539802670478821, gen p mean: -0.42334887385368347, mean p set: 0.45446059107780457
loss_pred:0.0322214737534523, decouple_loss:0.015028193593025208
loss_pred:0.03182735666632652, decouple_loss:0.01628880947828293
Iteration: 710, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45082196593284607, gen p mean: -0.4170770049095154, mean p set: 0.45130228996276855
loss_pred:0.0322357602417469, decouple_loss:0.01664840057492256
The modified gen p mean: 0.45270633697509766, gen p mean: -0.4253905415534973, mean p set: 0.45318663120269775The modified gen p mean: 0.4527190923690796, gen p mean: -0.42598244547843933, mean p set: 0.4531993865966797
loss_pred:0.03189418092370033, decouple_loss:0.014766041189432144
loss_pred:0.03199808672070503, decouple_loss:0.01506337895989418
2023-05-01 13:23:22 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.4351966679096222, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.42315012216567993, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.4275844097137451, mean p set: 0.4500633478164673
loss_pred:0.035333674401044846, decouple_loss:0.0168374702334404
loss_pred:0.03339434787631035, decouple_loss:0.01688334159553051
loss_pred:0.03415745869278908, decouple_loss:0.016305778175592422
WV_0_PC_1_EH_0_PS_40_15, loss: 0.03512893617153168, avg_mse: 0.0391857847571373
current test mse: 0.039186
Iteration: 711, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4524080753326416, gen p mean: -0.43019378185272217, mean p set: 0.4528883397579193
The modified gen p mean: 0.45134875178337097, gen p mean: -0.4171653389930725, mean p set: 0.45182904601097107
The modified gen p mean: 0.4513583779335022, gen p mean: -0.4285285472869873, mean p set: 0.4518386423587799
loss_pred:0.034305159002542496, decouple_loss:0.015110610984265804
loss_pred:0.032828766852617264, decouple_loss:0.014533580280840397
loss_pred:0.03507686033844948, decouple_loss:0.015054362826049328
Iteration: 712, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4543343782424927, gen p mean: -0.4265854060649872, mean p set: 0.4548146724700928
loss_pred:0.03297056257724762, decouple_loss:0.01610361412167549
The modified gen p mean: 0.45271340012550354, gen p mean: -0.4190077483654022, mean p set: 0.45319366455078125The modified gen p mean: 0.4521689713001251, gen p mean: -0.4258541762828827, mean p set: 0.45264923572540283
loss_pred:0.03165601193904877, decouple_loss:0.015166070312261581
loss_pred:0.03271257504820824, decouple_loss:0.015347297303378582
Iteration: 713, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4506838619709015, gen p mean: -0.4121549725532532, mean p set: 0.4511641561985016
loss_pred:0.03246632590889931, decouple_loss:0.015723230317234993
The modified gen p mean: 0.45227065682411194, gen p mean: -0.41325312852859497, mean p set: 0.45275095105171204The modified gen p mean: 0.4522055387496948, gen p mean: -0.41782402992248535, mean p set: 0.45268580317497253
loss_pred:0.031878720968961716, decouple_loss:0.015263590961694717
loss_pred:0.03506121784448624, decouple_loss:0.01478163804858923
Iteration: 714, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4528367221355438, gen p mean: -0.4276905357837677, mean p set: 0.4533170461654663
loss_pred:0.03200371563434601, decouple_loss:0.014497802592813969
The modified gen p mean: 0.45233041048049927, gen p mean: -0.42377394437789917, mean p set: 0.45281070470809937The modified gen p mean: 0.4528239965438843, gen p mean: -0.418439656496048, mean p set: 0.4533042907714844
loss_pred:0.033712029457092285, decouple_loss:0.014497277326881886
loss_pred:0.03188744932413101, decouple_loss:0.014281624928116798
Iteration: 715, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45108267664909363, gen p mean: -0.42607784271240234, mean p set: 0.4515630006790161
loss_pred:0.034922193735837936, decouple_loss:0.015121282078325748
The modified gen p mean: 0.4516972601413727, gen p mean: -0.4201572835445404, mean p set: 0.4521775543689728The modified gen p mean: 0.4527140259742737, gen p mean: -0.4252500534057617, mean p set: 0.4531942903995514
loss_pred:0.0329292006790638, decouple_loss:0.01436692662537098
loss_pred:0.034130681306123734, decouple_loss:0.014154504984617233
Iteration: 716, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45097970962524414, gen p mean: -0.4102466404438019, mean p set: 0.45146000385284424
loss_pred:0.03227876499295235, decouple_loss:0.015401812270283699
The modified gen p mean: 0.4522090256214142, gen p mean: -0.41905471682548523, mean p set: 0.4526892900466919The modified gen p mean: 0.4498565196990967, gen p mean: -0.4192986488342285, mean p set: 0.4503368139266968
loss_pred:0.03316126763820648, decouple_loss:0.013816049322485924
loss_pred:0.03409027308225632, decouple_loss:0.015198816545307636
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012018_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012018_3_24hr.npz
NaN value num: 0
Iteration: 717, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491630792617798, gen p mean: -0.4208620488643646, mean p set: 0.4496433436870575
loss_pred:0.034474436193704605, decouple_loss:0.016583995893597603
The modified gen p mean: 0.44741693139076233, gen p mean: -0.41806426644325256, mean p set: 0.44789719581604004The modified gen p mean: 0.44754910469055176, gen p mean: -0.4251747131347656, mean p set: 0.44802939891815186
loss_pred:0.03506283834576607, decouple_loss:0.017636708915233612
loss_pred:0.034922972321510315, decouple_loss:0.016578931361436844
Iteration: 718, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44791802763938904, gen p mean: -0.41796568036079407, mean p set: 0.44839832186698914
loss_pred:0.033322904258966446, decouple_loss:0.017257943749427795
The modified gen p mean: 0.4484274089336395, gen p mean: -0.4337768852710724, mean p set: 0.4489077031612396The modified gen p mean: 0.44799932837486267, gen p mean: -0.4282195568084717, mean p set: 0.44847962260246277
loss_pred:0.03358553722500801, decouple_loss:0.01722951978445053
loss_pred:0.03606730327010155, decouple_loss:0.01701139286160469
Iteration: 719, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44844841957092285, gen p mean: -0.42260971665382385, mean p set: 0.44892874360084534
loss_pred:0.03419272229075432, decouple_loss:0.01623040810227394
The modified gen p mean: 0.44811341166496277, gen p mean: -0.41604816913604736, mean p set: 0.44859370589256287The modified gen p mean: 0.44771313667297363, gen p mean: -0.4239327311515808, mean p set: 0.44819343090057373
loss_pred:0.03489213436841965, decouple_loss:0.017320124432444572
loss_pred:0.034397903829813004, decouple_loss:0.017036864534020424
Iteration: 720, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44794991612434387, gen p mean: -0.422561913728714, mean p set: 0.44843021035194397
The modified gen p mean: 0.448133647441864, gen p mean: -0.43295860290527344, mean p set: 0.4486139416694641
loss_pred:0.033627115190029144, decouple_loss:0.016531966626644135
loss_pred:0.034063730388879776, decouple_loss:0.016141405329108238
The modified gen p mean: 0.44868525862693787, gen p mean: -0.42214614152908325, mean p set: 0.4491655230522156
loss_pred:0.03377879038453102, decouple_loss:0.015579097904264927
2023-05-01 13:25:57 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.429618775844574, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.41838178038597107, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.4222208261489868, mean p set: 0.4500633478164673
loss_pred:0.03507813811302185, decouple_loss:0.01586608961224556
loss_pred:0.0330963060259819, decouple_loss:0.015541709959506989
loss_pred:0.033999063074588776, decouple_loss:0.015679044649004936
WV_0_PC_1_EH_0_PS_40_15, loss: 0.03484261780977249, avg_mse: 0.03872724995017052
current test mse: 0.038727
Iteration: 721, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44787734746932983, gen p mean: -0.4237625002861023, mean p set: 0.4483576714992523
The modified gen p mean: 0.44744613766670227, gen p mean: -0.42028629779815674, mean p set: 0.44792643189430237
The modified gen p mean: 0.4476363956928253, gen p mean: -0.4224504232406616, mean p set: 0.4481166899204254
loss_pred:0.03458577021956444, decouple_loss:0.01599770411849022
loss_pred:0.034424807876348495, decouple_loss:0.016187675297260284
loss_pred:0.03483448177576065, decouple_loss:0.01482297945767641
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 722, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477713406085968, gen p mean: -0.4300573468208313, mean p set: 0.4482516348361969
loss_pred:0.03476499021053314, decouple_loss:0.016212916001677513
The modified gen p mean: 0.4478335976600647, gen p mean: -0.42163750529289246, mean p set: 0.4483139216899872The modified gen p mean: 0.44880369305610657, gen p mean: -0.42139947414398193, mean p set: 0.44928398728370667
loss_pred:0.03481781855225563, decouple_loss:0.015753671526908875
loss_pred:0.0340263769030571, decouple_loss:0.015541727654635906
Iteration: 723, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483509063720703, gen p mean: -0.4164768159389496, mean p set: 0.4488312005996704
loss_pred:0.032735999673604965, decouple_loss:0.015968961641192436
The modified gen p mean: 0.44719934463500977, gen p mean: -0.4262397587299347, mean p set: 0.4476796090602875The modified gen p mean: 0.448560506105423, gen p mean: -0.4217985272407532, mean p set: 0.44904080033302307
loss_pred:0.03234757110476494, decouple_loss:0.016071779653429985
loss_pred:0.03387818485498428, decouple_loss:0.01587165705859661
Iteration: 724, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44762691855430603, gen p mean: -0.4196499288082123, mean p set: 0.44810721278190613
loss_pred:0.03342783451080322, decouple_loss:0.015401028096675873
The modified gen p mean: 0.4483286142349243, gen p mean: -0.4147493839263916, mean p set: 0.4488089084625244The modified gen p mean: 0.4475034475326538, gen p mean: -0.4217495024204254, mean p set: 0.4479837417602539
loss_pred:0.03473315387964249, decouple_loss:0.015175534412264824
loss_pred:0.034443069249391556, decouple_loss:0.015340723097324371
Iteration: 725, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477216899394989, gen p mean: -0.413551926612854, mean p set: 0.448201984167099
loss_pred:0.03220474720001221, decouple_loss:0.01516414899379015
The modified gen p mean: 0.4475390315055847, gen p mean: -0.4122004210948944, mean p set: 0.4480193257331848The modified gen p mean: 0.4481903612613678, gen p mean: -0.4070795178413391, mean p set: 0.4486706554889679
loss_pred:0.03351562097668648, decouple_loss:0.015119880437850952
loss_pred:0.03224378451704979, decouple_loss:0.01512919645756483
Iteration: 726, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44780266284942627, gen p mean: -0.40985023975372314, mean p set: 0.44828298687934875
loss_pred:0.034503526985645294, decouple_loss:0.014658431522548199
The modified gen p mean: 0.44778382778167725, gen p mean: -0.41272637248039246, mean p set: 0.44826412200927734The modified gen p mean: 0.44806525111198425, gen p mean: -0.41012778878211975, mean p set: 0.44854554533958435
loss_pred:0.03308456018567085, decouple_loss:0.014579619280993938
loss_pred:0.03207375854253769, decouple_loss:0.014287406578660011
Iteration: 727, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44773542881011963, gen p mean: -0.41635626554489136, mean p set: 0.4482157230377197
loss_pred:0.033405739814043045, decouple_loss:0.014810583554208279
The modified gen p mean: 0.44811728596687317, gen p mean: -0.416786253452301, mean p set: 0.44859760999679565The modified gen p mean: 0.44841691851615906, gen p mean: -0.4117213487625122, mean p set: 0.44889721274375916
loss_pred:0.032604046165943146, decouple_loss:0.015005463734269142
loss_pred:0.03492075949907303, decouple_loss:0.01589260995388031
Iteration: 728, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479043781757355, gen p mean: -0.41875895857810974, mean p set: 0.44838467240333557
loss_pred:0.03210246562957764, decouple_loss:0.014440756291151047
The modified gen p mean: 0.44751855731010437, gen p mean: -0.41689226031303406, mean p set: 0.44799885153770447The modified gen p mean: 0.4472784698009491, gen p mean: -0.4194205105304718, mean p set: 0.4477587640285492
loss_pred:0.033226870000362396, decouple_loss:0.014622749760746956
loss_pred:0.03305131569504738, decouple_loss:0.014212343841791153
Iteration: 729, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44749870896339417, gen p mean: -0.4172597825527191, mean p set: 0.44797900319099426
loss_pred:0.033454474061727524, decouple_loss:0.014137799851596355
The modified gen p mean: 0.448762446641922, gen p mean: -0.41239720582962036, mean p set: 0.4492427408695221The modified gen p mean: 0.44806358218193054, gen p mean: -0.41416028141975403, mean p set: 0.44854387640953064
loss_pred:0.03341860696673393, decouple_loss:0.013686816208064556
loss_pred:0.033117953687906265, decouple_loss:0.014685922302305698
Iteration: 730, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44790560007095337, gen p mean: -0.4160922169685364, mean p set: 0.44838589429855347
loss_pred:0.033055804669857025, decouple_loss:0.014001353643834591
The modified gen p mean: 0.44878125190734863, gen p mean: -0.42184385657310486, mean p set: 0.44926151633262634The modified gen p mean: 0.4478529393672943, gen p mean: -0.4113747477531433, mean p set: 0.4483332633972168
loss_pred:0.032902296632528305, decouple_loss:0.014250002801418304
loss_pred:0.03316852077841759, decouple_loss:0.013893145136535168
2023-05-01 13:27:52 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.41557106375694275, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.40467342734336853, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.40801435708999634, mean p set: 0.4500633478164673
loss_pred:0.03450876474380493, decouple_loss:0.014354808256030083
loss_pred:0.03277111053466797, decouple_loss:0.013925023376941681
loss_pred:0.0336129330098629, decouple_loss:0.013751743361353874
WV_0_PC_1_EH_0_PS_40_15, loss: 0.034331463277339935, avg_mse: 0.03824269026517868
current test mse: 0.038243
Iteration: 731, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44798147678375244, gen p mean: -0.41087162494659424, mean p set: 0.44846177101135254
The modified gen p mean: 0.44771623611450195, gen p mean: -0.41304779052734375, mean p set: 0.44819650053977966
The modified gen p mean: 0.447795033454895, gen p mean: -0.41738075017929077, mean p set: 0.4482753276824951
loss_pred:0.034674543887376785, decouple_loss:0.01410437747836113
loss_pred:0.03285987675189972, decouple_loss:0.013257231563329697
loss_pred:0.03287256881594658, decouple_loss:0.01382068544626236
Iteration: 732, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476151466369629, gen p mean: -0.4135518968105316, mean p set: 0.448095440864563
loss_pred:0.0319809727370739, decouple_loss:0.013199569657444954
The modified gen p mean: 0.44780224561691284, gen p mean: -0.4143829345703125, mean p set: 0.44828253984451294
The modified gen p mean: 0.4478616714477539, gen p mean: -0.4152366816997528, mean p set: 0.448341965675354
loss_pred:0.033568814396858215, decouple_loss:0.013219688087701797
loss_pred:0.03388483449816704, decouple_loss:0.013216069899499416
Iteration: 733, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44728925824165344, gen p mean: -0.4162903130054474, mean p set: 0.44776955246925354
loss_pred:0.033061303198337555, decouple_loss:0.013479335233569145
The modified gen p mean: 0.4482262134552002, gen p mean: -0.4094068109989166, mean p set: 0.4487065374851227The modified gen p mean: 0.44811609387397766, gen p mean: -0.42093876004219055, mean p set: 0.44859638810157776
loss_pred:0.03415754809975624, decouple_loss:0.01307914312928915
loss_pred:0.03264167904853821, decouple_loss:0.013281038962304592
Iteration: 734, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480019211769104, gen p mean: -0.4059286117553711, mean p set: 0.4484822154045105
loss_pred:0.03353111073374748, decouple_loss:0.013318019919097424
The modified gen p mean: 0.44788506627082825, gen p mean: -0.4126328229904175, mean p set: 0.44836533069610596The modified gen p mean: 0.4481147229671478, gen p mean: -0.414193332195282, mean p set: 0.4485950171947479
loss_pred:0.03344343975186348, decouple_loss:0.013216870836913586
loss_pred:0.033533934503793716, decouple_loss:0.01371543575078249
Iteration: 735, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471258223056793, gen p mean: -0.40687474608421326, mean p set: 0.4476061165332794
loss_pred:0.032894957810640335, decouple_loss:0.013033495284616947
The modified gen p mean: 0.4475157856941223, gen p mean: -0.40755364298820496, mean p set: 0.4479960799217224The modified gen p mean: 0.4482947587966919, gen p mean: -0.4128081798553467, mean p set: 0.448775053024292
loss_pred:0.033232394605875015, decouple_loss:0.013063866645097733
loss_pred:0.03461755812168121, decouple_loss:0.01324625313282013
Iteration: 736, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474197328090668, gen p mean: -0.40956398844718933, mean p set: 0.4478999972343445
loss_pred:0.033090122044086456, decouple_loss:0.01255524531006813
The modified gen p mean: 0.44799745082855225, gen p mean: -0.4126180410385132, mean p set: 0.44847777485847473The modified gen p mean: 0.4480687975883484, gen p mean: -0.40992188453674316, mean p set: 0.4485490918159485
loss_pred:0.03247058019042015, decouple_loss:0.01249007973819971
loss_pred:0.033886730670928955, decouple_loss:0.012441708706319332
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012012_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012012_3_24hr.npz
NaN value num: 0
Iteration: 737, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475524127483368, gen p mean: -0.4088659882545471, mean p set: 0.4480327069759369
loss_pred:0.033796925097703934, decouple_loss:0.014506533741950989
The modified gen p mean: 0.44889020919799805, gen p mean: -0.41472795605659485, mean p set: 0.44937047362327576The modified gen p mean: 0.44769424200057983, gen p mean: -0.41295740008354187, mean p set: 0.44817450642585754
loss_pred:0.035654548555612564, decouple_loss:0.015698103234171867
loss_pred:0.03403259441256523, decouple_loss:0.013496020808815956
Iteration: 738, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472868740558624, gen p mean: -0.4120774567127228, mean p set: 0.4477671980857849
loss_pred:0.03359680622816086, decouple_loss:0.012993725948035717
The modified gen p mean: 0.4477033019065857, gen p mean: -0.4116232395172119, mean p set: 0.4481835961341858The modified gen p mean: 0.4478236734867096, gen p mean: -0.4148566424846649, mean p set: 0.4483039677143097
loss_pred:0.03432266414165497, decouple_loss:0.01394894253462553
loss_pred:0.03202572092413902, decouple_loss:0.013039176352322102
Iteration: 739, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470369815826416, gen p mean: -0.40881893038749695, mean p set: 0.4475173056125641
loss_pred:0.03399116173386574, decouple_loss:0.01375917624682188
The modified gen p mean: 0.44869041442871094, gen p mean: -0.410523384809494, mean p set: 0.44917070865631104The modified gen p mean: 0.44752028584480286, gen p mean: -0.41098544001579285, mean p set: 0.44800058007240295
loss_pred:0.03469216078519821, decouple_loss:0.014914380386471748
loss_pred:0.032095927745103836, decouple_loss:0.012995094060897827
Iteration: 740, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478985369205475, gen p mean: -0.40939268469810486, mean p set: 0.4483788311481476
loss_pred:0.03407415375113487, decouple_loss:0.014126318506896496
The modified gen p mean: 0.4469403624534607, gen p mean: -0.4129815399646759, mean p set: 0.4474206268787384The modified gen p mean: 0.44789817929267883, gen p mean: -0.4100572466850281, mean p set: 0.44837847352027893
loss_pred:0.03362811356782913, decouple_loss:0.013482969254255295
loss_pred:0.03272689878940582, decouple_loss:0.01256716251373291
2023-05-01 13:30:24 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.42489591240882874, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.4142124056816101, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.41817814111709595, mean p set: 0.4500633478164673
loss_pred:0.03428896144032478, decouple_loss:0.013540612533688545
loss_pred:0.03258397430181503, decouple_loss:0.012878254987299442
loss_pred:0.03334249183535576, decouple_loss:0.012660568580031395
WV_0_PC_1_EH_0_PS_40_15, loss: 0.034056469798088074, avg_mse: 0.03803684934973717
current test mse: 0.038037
Iteration: 741, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474409818649292, gen p mean: -0.4243777394294739, mean p set: 0.4479212760925293
The modified gen p mean: 0.44741910696029663, gen p mean: -0.41505634784698486, mean p set: 0.44789940118789673
The modified gen p mean: 0.44597822427749634, gen p mean: -0.41280391812324524, mean p set: 0.44645851850509644
loss_pred:0.03412725031375885, decouple_loss:0.012381333857774734
loss_pred:0.034468602389097214, decouple_loss:0.013988347724080086loss_pred:0.03272266313433647, decouple_loss:0.013824211433529854
Iteration: 742, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44849735498428345, gen p mean: -0.4223460257053375, mean p set: 0.44897761940956116
loss_pred:0.03302254155278206, decouple_loss:0.012745682150125504
The modified gen p mean: 0.44765469431877136, gen p mean: -0.4210101068019867, mean p set: 0.44813501834869385The modified gen p mean: 0.4486526548862457, gen p mean: -0.42417147755622864, mean p set: 0.44913291931152344
loss_pred:0.03486882150173187, decouple_loss:0.014119545929133892
loss_pred:0.03395973518490791, decouple_loss:0.012744540348649025
Iteration: 743, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474269449710846, gen p mean: -0.4304393529891968, mean p set: 0.4479072690010071
loss_pred:0.034273844212293625, decouple_loss:0.013599881902337074
The modified gen p mean: 0.4465479552745819, gen p mean: -0.43296390771865845, mean p set: 0.4470282196998596The modified gen p mean: 0.4471847116947174, gen p mean: -0.42729878425598145, mean p set: 0.4476650059223175
loss_pred:0.03358077630400658, decouple_loss:0.012857007794082165
loss_pred:0.0329354852437973, decouple_loss:0.013023477047681808
Iteration: 744, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44647809863090515, gen p mean: -0.4230213761329651, mean p set: 0.44695839285850525
loss_pred:0.03361787647008896, decouple_loss:0.012390715070068836
The modified gen p mean: 0.4476260542869568, gen p mean: -0.42359670996665955, mean p set: 0.4481063485145569The modified gen p mean: 0.4477022588253021, gen p mean: -0.4204255938529968, mean p set: 0.4481825828552246
loss_pred:0.03415568917989731, decouple_loss:0.013529174961149693
loss_pred:0.03319486975669861, decouple_loss:0.01267955917865038
Iteration: 745, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44628408551216125, gen p mean: -0.4122903048992157, mean p set: 0.44676437973976135
loss_pred:0.03345576673746109, decouple_loss:0.01389177143573761
The modified gen p mean: 0.4480397701263428, gen p mean: -0.4294816553592682, mean p set: 0.44852009415626526The modified gen p mean: 0.44730570912361145, gen p mean: -0.4171770215034485, mean p set: 0.44778600335121155
loss_pred:0.03374228999018669, decouple_loss:0.014042528346180916
loss_pred:0.03375716134905815, decouple_loss:0.012934278696775436
Iteration: 746, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44743579626083374, gen p mean: -0.41693469882011414, mean p set: 0.44791606068611145
loss_pred:0.03434498608112335, decouple_loss:0.012856295332312584
The modified gen p mean: 0.4470200538635254, gen p mean: -0.41514667868614197, mean p set: 0.4475003480911255The modified gen p mean: 0.4467793107032776, gen p mean: -0.41439664363861084, mean p set: 0.4472596049308777
loss_pred:0.03329096734523773, decouple_loss:0.012173783965408802
loss_pred:0.03306901082396507, decouple_loss:0.013028588145971298
Iteration: 747, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468739926815033, gen p mean: -0.41378045082092285, mean p set: 0.4473542869091034
loss_pred:0.03299281373620033, decouple_loss:0.011850452981889248
The modified gen p mean: 0.4467921853065491, gen p mean: -0.4157795011997223, mean p set: 0.44727250933647156The modified gen p mean: 0.44790807366371155, gen p mean: -0.42264020442962646, mean p set: 0.44838836789131165
loss_pred:0.033097125589847565, decouple_loss:0.012038537301123142
loss_pred:0.032247282564640045, decouple_loss:0.01369041670113802
Iteration: 748, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447234183549881, gen p mean: -0.41390666365623474, mean p set: 0.4477144777774811
loss_pred:0.033315300941467285, decouple_loss:0.013107996433973312
The modified gen p mean: 0.4484599232673645, gen p mean: -0.42388197779655457, mean p set: 0.448940247297287The modified gen p mean: 0.4480159282684326, gen p mean: -0.41372916102409363, mean p set: 0.4484962224960327
loss_pred:0.034334827214479446, decouple_loss:0.013202142901718616
loss_pred:0.034331146627664566, decouple_loss:0.01320452056825161
Iteration: 749, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44838908314704895, gen p mean: -0.4186134934425354, mean p set: 0.44886934757232666
loss_pred:0.03397294506430626, decouple_loss:0.013925546780228615
The modified gen p mean: 0.4474908709526062, gen p mean: -0.41529443860054016, mean p set: 0.4479711353778839The modified gen p mean: 0.44876790046691895, gen p mean: -0.41484713554382324, mean p set: 0.44924822449684143
loss_pred:0.03366060554981232, decouple_loss:0.013005828484892845
loss_pred:0.034062452614307404, decouple_loss:0.01366623118519783
Iteration: 750, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477330446243286, gen p mean: -0.41504135727882385, mean p set: 0.4482133686542511
loss_pred:0.03310006856918335, decouple_loss:0.012250937521457672
The modified gen p mean: 0.4472866356372833, gen p mean: -0.4111843705177307, mean p set: 0.4477669298648834The modified gen p mean: 0.44814231991767883, gen p mean: -0.4134908616542816, mean p set: 0.44862261414527893
loss_pred:0.03233756124973297, decouple_loss:0.012674696743488312
loss_pred:0.032866351306438446, decouple_loss:0.013083579018712044
2023-05-01 13:32:19 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.4161362946033478, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.40629100799560547, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.40956851840019226, mean p set: 0.4500633478164673
loss_pred:0.03412024676799774, decouple_loss:0.013612627983093262
loss_pred:0.03245028480887413, decouple_loss:0.01350929494947195loss_pred:0.03318071365356445, decouple_loss:0.013159781694412231
WV_0_PC_1_EH_0_PS_40_15, loss: 0.033921778202056885, avg_mse: 0.03781108558177948
current test mse: 0.037811
Iteration: 751, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446382999420166, gen p mean: -0.40757519006729126, mean p set: 0.4468632936477661
The modified gen p mean: 0.446853905916214, gen p mean: -0.4102582335472107, mean p set: 0.4473342299461365
The modified gen p mean: 0.4477849304676056, gen p mean: -0.4100877642631531, mean p set: 0.4482652246952057
loss_pred:0.03399635851383209, decouple_loss:0.013224081136286259
loss_pred:0.032920654863119125, decouple_loss:0.013035464100539684
loss_pred:0.03335599601268768, decouple_loss:0.013690187595784664
Iteration: 752, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44695988297462463, gen p mean: -0.40818995237350464, mean p set: 0.4474402070045471
loss_pred:0.03297349438071251, decouple_loss:0.013668549247086048
The modified gen p mean: 0.448669970035553, gen p mean: -0.41550618410110474, mean p set: 0.4491502642631531The modified gen p mean: 0.44773608446121216, gen p mean: -0.4097464382648468, mean p set: 0.44821637868881226
loss_pred:0.03494672104716301, decouple_loss:0.013442426919937134
loss_pred:0.03308558464050293, decouple_loss:0.012845160439610481
Iteration: 753, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44812092185020447, gen p mean: -0.4152742624282837, mean p set: 0.44860121607780457
loss_pred:0.031805288046598434, decouple_loss:0.01299356110394001
The modified gen p mean: 0.4456293284893036, gen p mean: -0.4097529351711273, mean p set: 0.4461096227169037The modified gen p mean: 0.4469078779220581, gen p mean: -0.4163018465042114, mean p set: 0.4473881721496582
loss_pred:0.03383844718337059, decouple_loss:0.01399668026715517
loss_pred:0.033871930092573166, decouple_loss:0.01364743709564209
Iteration: 754, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44720256328582764, gen p mean: -0.42624467611312866, mean p set: 0.4476828873157501
loss_pred:0.03278030827641487, decouple_loss:0.01306688878685236
The modified gen p mean: 0.4476092755794525, gen p mean: -0.414326548576355, mean p set: 0.4480895698070526The modified gen p mean: 0.4474744498729706, gen p mean: -0.4177144169807434, mean p set: 0.4479547441005707
loss_pred:0.03307926654815674, decouple_loss:0.013027756474912167
loss_pred:0.03256873041391373, decouple_loss:0.013689588755369186
Iteration: 755, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477180242538452, gen p mean: -0.419433057308197, mean p set: 0.4481982886791229
loss_pred:0.032307855784893036, decouple_loss:0.012669002637267113
The modified gen p mean: 0.44864141941070557, gen p mean: -0.4209778308868408, mean p set: 0.4491216838359833The modified gen p mean: 0.44812050461769104, gen p mean: -0.42024606466293335, mean p set: 0.44860079884529114
loss_pred:0.03358115255832672, decouple_loss:0.013922065496444702
loss_pred:0.033939797431230545, decouple_loss:0.013808079995214939
Iteration: 756, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481739103794098, gen p mean: -0.42807537317276, mean p set: 0.4486541748046875
loss_pred:0.03464138135313988, decouple_loss:0.014270682819187641
The modified gen p mean: 0.4478202760219574, gen p mean: -0.42151498794555664, mean p set: 0.4483005702495575The modified gen p mean: 0.44732311367988586, gen p mean: -0.4234941899776459, mean p set: 0.44780340790748596
loss_pred:0.03391098231077194, decouple_loss:0.013507201336324215
loss_pred:0.03340080752968788, decouple_loss:0.01309630461037159
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012002_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012002_3_24hr.npz
NaN value num: 0
Iteration: 757, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44836610555648804, gen p mean: -0.42547667026519775, mean p set: 0.44884639978408813
loss_pred:0.03206610307097435, decouple_loss:0.013532961718738079
The modified gen p mean: 0.4474162757396698, gen p mean: -0.41968899965286255, mean p set: 0.4478965699672699The modified gen p mean: 0.4501930773258209, gen p mean: -0.4139986038208008, mean p set: 0.45067334175109863
loss_pred:0.0323493666946888, decouple_loss:0.014702360145747662
loss_pred:0.03316497430205345, decouple_loss:0.013505680486559868
Iteration: 758, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44839343428611755, gen p mean: -0.4162442088127136, mean p set: 0.44887375831604004
loss_pred:0.03503865376114845, decouple_loss:0.013740832917392254
The modified gen p mean: 0.4488476812839508, gen p mean: -0.42888036370277405, mean p set: 0.4493279755115509The modified gen p mean: 0.4489430785179138, gen p mean: -0.4232970178127289, mean p set: 0.4494233727455139
loss_pred:0.03327906131744385, decouple_loss:0.014864000491797924
loss_pred:0.030757568776607513, decouple_loss:0.014752509072422981
Iteration: 759, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489346146583557, gen p mean: -0.4279133975505829, mean p set: 0.4494149386882782
loss_pred:0.03239089250564575, decouple_loss:0.013738024048507214
The modified gen p mean: 0.44961124658584595, gen p mean: -0.42968234419822693, mean p set: 0.45009157061576843The modified gen p mean: 0.44755735993385315, gen p mean: -0.4174509048461914, mean p set: 0.44803765416145325
loss_pred:0.03329110145568848, decouple_loss:0.012371348217129707
loss_pred:0.03253313526511192, decouple_loss:0.013472151011228561
Iteration: 760, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499562680721283, gen p mean: -0.41667884588241577, mean p set: 0.4504365622997284
loss_pred:0.03152608871459961, decouple_loss:0.013779361732304096
The modified gen p mean: 0.4486274719238281, gen p mean: -0.4244968891143799, mean p set: 0.44910773634910583The modified gen p mean: 0.4474972188472748, gen p mean: -0.4208257496356964, mean p set: 0.4479774832725525
loss_pred:0.031802527606487274, decouple_loss:0.013462710194289684
loss_pred:0.03283380717039108, decouple_loss:0.0126587999984622
2023-05-01 13:34:55 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.4300025999546051, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.4204741418361664, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.4233391284942627, mean p set: 0.4500633478164673
loss_pred:0.034092847257852554, decouple_loss:0.01339268684387207
loss_pred:0.032476577907800674, decouple_loss:0.013549871742725372
loss_pred:0.03317613899707794, decouple_loss:0.013113538734614849
WV_0_PC_1_EH_0_PS_40_15, loss: 0.03391612693667412, avg_mse: 0.038054343312978745
current test mse: 0.038054
Iteration: 761, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44837772846221924, gen p mean: -0.4260979890823364, mean p set: 0.44885799288749695
The modified gen p mean: 0.4490821361541748, gen p mean: -0.42718225717544556, mean p set: 0.4495624303817749
The modified gen p mean: 0.44975852966308594, gen p mean: -0.4288623034954071, mean p set: 0.45023879408836365
loss_pred:0.03321479633450508, decouple_loss:0.013681599870324135
loss_pred:0.03383972495794296, decouple_loss:0.013100512325763702loss_pred:0.03278746455907822, decouple_loss:0.013592331670224667
Iteration: 762, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44785284996032715, gen p mean: -0.42265865206718445, mean p set: 0.44833314418792725
loss_pred:0.03386630490422249, decouple_loss:0.013633214868605137
The modified gen p mean: 0.4516567587852478, gen p mean: -0.4272584617137909, mean p set: 0.4521370232105255The modified gen p mean: 0.44798243045806885, gen p mean: -0.4288525879383087, mean p set: 0.44846272468566895
loss_pred:0.03100586123764515, decouple_loss:0.013150503858923912
loss_pred:0.03278111293911934, decouple_loss:0.013560337945818901
Iteration: 763, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493548274040222, gen p mean: -0.4323335886001587, mean p set: 0.4498351216316223
loss_pred:0.03204691410064697, decouple_loss:0.012942582368850708
The modified gen p mean: 0.4476599097251892, gen p mean: -0.42533978819847107, mean p set: 0.4481402039527893The modified gen p mean: 0.4487262964248657, gen p mean: -0.43376609683036804, mean p set: 0.44920656085014343
loss_pred:0.0327361561357975, decouple_loss:0.013128845952451229
loss_pred:0.03264852985739708, decouple_loss:0.012852102518081665
Iteration: 764, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44972044229507446, gen p mean: -0.4433971047401428, mean p set: 0.45020073652267456
loss_pred:0.03150917589664459, decouple_loss:0.01318525429815054
The modified gen p mean: 0.44862765073776245, gen p mean: -0.4375358521938324, mean p set: 0.44910797476768494The modified gen p mean: 0.44819360971450806, gen p mean: -0.433906227350235, mean p set: 0.44867387413978577
loss_pred:0.03276233375072479, decouple_loss:0.013352444395422935
loss_pred:0.03166980668902397, decouple_loss:0.012798755429685116
Iteration: 765, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44975507259368896, gen p mean: -0.4253786504268646, mean p set: 0.4502353370189667
loss_pred:0.032214026898145676, decouple_loss:0.013383894227445126
The modified gen p mean: 0.4472678005695343, gen p mean: -0.4244261682033539, mean p set: 0.447748064994812The modified gen p mean: 0.4489038288593292, gen p mean: -0.429464191198349, mean p set: 0.4493841528892517
loss_pred:0.031977344304323196, decouple_loss:0.012935121543705463
loss_pred:0.03300504386425018, decouple_loss:0.01386161521077156
Iteration: 766, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481161832809448, gen p mean: -0.42493343353271484, mean p set: 0.44859644770622253
loss_pred:0.03231677785515785, decouple_loss:0.011978177353739738
The modified gen p mean: 0.4486962556838989, gen p mean: -0.4323329031467438, mean p set: 0.449176549911499The modified gen p mean: 0.4491240084171295, gen p mean: -0.4423285126686096, mean p set: 0.4496042728424072
loss_pred:0.03281783685088158, decouple_loss:0.012367886491119862
loss_pred:0.03047676756978035, decouple_loss:0.0129530169069767
Iteration: 767, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447856068611145, gen p mean: -0.43003514409065247, mean p set: 0.4483363628387451
loss_pred:0.03321826085448265, decouple_loss:0.011742886155843735
The modified gen p mean: 0.4474325478076935, gen p mean: -0.43238505721092224, mean p set: 0.4479128420352936The modified gen p mean: 0.4507500231266022, gen p mean: -0.4360330402851105, mean p set: 0.45123034715652466
loss_pred:0.031841062009334564, decouple_loss:0.012097731232643127
loss_pred:0.031701620668172836, decouple_loss:0.012728236615657806
Iteration: 768, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484012722969055, gen p mean: -0.43974074721336365, mean p set: 0.4488815367221832
loss_pred:0.03443252667784691, decouple_loss:0.01340555865317583
The modified gen p mean: 0.4474261701107025, gen p mean: -0.440125435590744, mean p set: 0.4479064643383026The modified gen p mean: 0.4476976692676544, gen p mean: -0.43977776169776917, mean p set: 0.4481779932975769
loss_pred:0.03377094492316246, decouple_loss:0.013739691115915775
loss_pred:0.033743955194950104, decouple_loss:0.011972249485552311
Iteration: 769, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44979915022850037, gen p mean: -0.44705864787101746, mean p set: 0.4502794146537781
loss_pred:0.0327475368976593, decouple_loss:0.012776686809957027
The modified gen p mean: 0.4472569227218628, gen p mean: -0.43856096267700195, mean p set: 0.4477371871471405The modified gen p mean: 0.44875746965408325, gen p mean: -0.4450915455818176, mean p set: 0.44923779368400574
loss_pred:0.03213450312614441, decouple_loss:0.012107279151678085
loss_pred:0.03396273031830788, decouple_loss:0.012668193317949772
Iteration: 770, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469147026538849, gen p mean: -0.4418494999408722, mean p set: 0.447394996881485
loss_pred:0.03166733682155609, decouple_loss:0.012429708614945412
The modified gen p mean: 0.44819745421409607, gen p mean: -0.44591549038887024, mean p set: 0.44867774844169617The modified gen p mean: 0.4467901289463043, gen p mean: -0.44458648562431335, mean p set: 0.4472704529762268
loss_pred:0.03429169952869415, decouple_loss:0.013585299253463745
loss_pred:0.03324161842465401, decouple_loss:0.013438107445836067

2023-05-01 13:36:49 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.44018784165382385, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.4317198693752289, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.4345695972442627, mean p set: 0.4500633478164673
loss_pred:0.03412213549017906, decouple_loss:0.013130017556250095
loss_pred:0.032386425882577896, decouple_loss:0.013364971615374088
loss_pred:0.033116016536951065, decouple_loss:0.01269978005439043
WV_0_PC_1_EH_0_PS_40_15, loss: 0.0338614396750927, avg_mse: 0.03803875669836998
current test mse: 0.038039
Iteration: 771, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448194295167923, gen p mean: -0.43194347620010376, mean p set: 0.44867458939552307
The modified gen p mean: 0.448076993227005, gen p mean: -0.4342746138572693, mean p set: 0.4485572874546051
The modified gen p mean: 0.4490068554878235, gen p mean: -0.44571003317832947, mean p set: 0.4494871497154236
loss_pred:0.03019719198346138, decouple_loss:0.014113444834947586
loss_pred:0.03382955491542816, decouple_loss:0.012980303727090359
loss_pred:0.03352336958050728, decouple_loss:0.012385312467813492
Iteration: 772, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44856277108192444, gen p mean: -0.4299810230731964, mean p set: 0.44904303550720215
loss_pred:0.03272160515189171, decouple_loss:0.012222228571772575
The modified gen p mean: 0.44734761118888855, gen p mean: -0.4263247847557068, mean p set: 0.44782793521881104The modified gen p mean: 0.4490741789340973, gen p mean: -0.42733150720596313, mean p set: 0.449554443359375
loss_pred:0.033060599118471146, decouple_loss:0.01312590204179287
loss_pred:0.032838575541973114, decouple_loss:0.011735068634152412
Iteration: 773, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471129775047302, gen p mean: -0.42897164821624756, mean p set: 0.4475933015346527
loss_pred:0.034261349588632584, decouple_loss:0.012322412803769112
The modified gen p mean: 0.4488906264305115, gen p mean: -0.43486353754997253, mean p set: 0.4493709206581116The modified gen p mean: 0.44915971159935, gen p mean: -0.4364679753780365, mean p set: 0.4496400058269501
loss_pred:0.03196156769990921, decouple_loss:0.012525385245680809
loss_pred:0.03246880695223808, decouple_loss:0.012311581522226334
Iteration: 774, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44766315817832947, gen p mean: -0.4263659715652466, mean p set: 0.44814345240592957
loss_pred:0.03370056673884392, decouple_loss:0.012366368435323238
The modified gen p mean: 0.44738543033599854, gen p mean: -0.42785200476646423, mean p set: 0.44786569476127625The modified gen p mean: 0.4488057494163513, gen p mean: -0.4273655414581299, mean p set: 0.4492860734462738
loss_pred:0.032779645174741745, decouple_loss:0.012551017105579376
loss_pred:0.03289361298084259, decouple_loss:0.013662677258253098
Iteration: 775, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466943144798279, gen p mean: -0.4251078963279724, mean p set: 0.447174608707428
loss_pred:0.03418013080954552, decouple_loss:0.012822989374399185
The modified gen p mean: 0.4500373601913452, gen p mean: -0.42611902952194214, mean p set: 0.4505176842212677The modified gen p mean: 0.4479535222053528, gen p mean: -0.4285263121128082, mean p set: 0.44843384623527527
loss_pred:0.031000589951872826, decouple_loss:0.013256644830107689
loss_pred:0.03380877524614334, decouple_loss:0.012428032234311104
Iteration: 776, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472696781158447, gen p mean: -0.43270719051361084, mean p set: 0.4477499723434448
loss_pred:0.033728670328855515, decouple_loss:0.012623190879821777
The modified gen p mean: 0.4475484788417816, gen p mean: -0.4284296929836273, mean p set: 0.4480287730693817The modified gen p mean: 0.44841745495796204, gen p mean: -0.4290392994880676, mean p set: 0.44889771938323975
loss_pred:0.03371305391192436, decouple_loss:0.012471389025449753
loss_pred:0.03301987424492836, decouple_loss:0.0121604073792696
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012006_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012006_3_24hr.npz
NaN value num: 0
Iteration: 777, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44792136549949646, gen p mean: -0.43187955021858215, mean p set: 0.44840162992477417
loss_pred:0.032590266317129135, decouple_loss:0.01330182608217001
The modified gen p mean: 0.44971179962158203, gen p mean: -0.4330039322376251, mean p set: 0.45019209384918213The modified gen p mean: 0.4485423266887665, gen p mean: -0.4312478303909302, mean p set: 0.4490225911140442
loss_pred:0.03400827571749687, decouple_loss:0.013437489978969097
loss_pred:0.03293149918317795, decouple_loss:0.012949159368872643
Iteration: 778, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44944050908088684, gen p mean: -0.4315915107727051, mean p set: 0.44992080330848694
loss_pred:0.033761125057935715, decouple_loss:0.012583187781274319
The modified gen p mean: 0.44923076033592224, gen p mean: -0.43622100353240967, mean p set: 0.44971105456352234The modified gen p mean: 0.4491414427757263, gen p mean: -0.43768933415412903, mean p set: 0.4496217370033264
loss_pred:0.032201215624809265, decouple_loss:0.013399471528828144
loss_pred:0.03308577463030815, decouple_loss:0.013085993938148022
Iteration: 779, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485201835632324, gen p mean: -0.4385581910610199, mean p set: 0.44900044798851013
loss_pred:0.03210432454943657, decouple_loss:0.014036639593541622
The modified gen p mean: 0.44884926080703735, gen p mean: -0.43734803795814514, mean p set: 0.44932955503463745The modified gen p mean: 0.44868409633636475, gen p mean: -0.4401170611381531, mean p set: 0.44916436076164246
loss_pred:0.03359656408429146, decouple_loss:0.013623313046991825
loss_pred:0.03242740407586098, decouple_loss:0.01303831022232771
Iteration: 780, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494444727897644, gen p mean: -0.44400933384895325, mean p set: 0.4499247372150421
loss_pred:0.032192304730415344, decouple_loss:0.01298423483967781
The modified gen p mean: 0.4487152397632599, gen p mean: -0.43767890334129333, mean p set: 0.44919553399086The modified gen p mean: 0.4486697316169739, gen p mean: -0.4467353820800781, mean p set: 0.449150025844574
loss_pred:0.03324798122048378, decouple_loss:0.012937388382852077
loss_pred:0.03324497491121292, decouple_loss:0.013312055729329586
2023-05-01 13:39:22 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.4461834132671356, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830535888672, gen p mean: -0.4393973648548126, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.43608254194259644, mean p set: 0.45035696029663086
loss_pred:0.033874109387397766, decouple_loss:0.013186756521463394
loss_pred:0.032960206270217896, decouple_loss:0.012856652960181236
loss_pred:0.0322461761534214, decouple_loss:0.012973121367394924
WV_0_PC_1_EH_0_PS_40_15, loss: 0.0336771085858345, avg_mse: 0.03793114796280861
current test mse: 0.037931
Iteration: 781, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476867914199829, gen p mean: -0.43098732829093933, mean p set: 0.4481671154499054
The modified gen p mean: 0.44782355427742004, gen p mean: -0.4398036599159241, mean p set: 0.44830384850502014
The modified gen p mean: 0.4473377764225006, gen p mean: -0.44229623675346375, mean p set: 0.4478180706501007
loss_pred:0.03355802223086357, decouple_loss:0.014654508791863918
loss_pred:0.032820552587509155, decouple_loss:0.012684037908911705
loss_pred:0.03154931217432022, decouple_loss:0.012657755054533482
Iteration: 782, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44917070865631104, gen p mean: -0.4394841194152832, mean p set: 0.4496510326862335
loss_pred:0.033554237335920334, decouple_loss:0.012775369919836521
The modified gen p mean: 0.4489497244358063, gen p mean: -0.43112388253211975, mean p set: 0.449429988861084The modified gen p mean: 0.4480856955051422, gen p mean: -0.4386829435825348, mean p set: 0.4485659599304199
loss_pred:0.032938335090875626, decouple_loss:0.014133522287011147
loss_pred:0.03304232284426689, decouple_loss:0.013485288247466087
Iteration: 783, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481750726699829, gen p mean: -0.4353070557117462, mean p set: 0.4486553370952606
loss_pred:0.03293204680085182, decouple_loss:0.013825793750584126
The modified gen p mean: 0.4487764537334442, gen p mean: -0.43005070090293884, mean p set: 0.4492567181587219The modified gen p mean: 0.44835829734802246, gen p mean: -0.43998801708221436, mean p set: 0.44883859157562256
loss_pred:0.03276080638170242, decouple_loss:0.01365311536937952
loss_pred:0.03319156914949417, decouple_loss:0.013217311352491379
Iteration: 784, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474776089191437, gen p mean: -0.4354562759399414, mean p set: 0.4479579031467438
loss_pred:0.03274191543459892, decouple_loss:0.013275199569761753
The modified gen p mean: 0.4476096034049988, gen p mean: -0.43409135937690735, mean p set: 0.4480898678302765The modified gen p mean: 0.44881999492645264, gen p mean: -0.444120317697525, mean p set: 0.44930025935173035
loss_pred:0.032649844884872437, decouple_loss:0.013122604228556156
loss_pred:0.032315511256456375, decouple_loss:0.01257710438221693
Iteration: 785, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497270882129669, gen p mean: -0.4395458698272705, mean p set: 0.450207382440567
loss_pred:0.032638952136039734, decouple_loss:0.013270831666886806
The modified gen p mean: 0.4483506679534912, gen p mean: -0.4413229525089264, mean p set: 0.4488309919834137The modified gen p mean: 0.44840681552886963, gen p mean: -0.4424726963043213, mean p set: 0.4488871097564697
loss_pred:0.03275156021118164, decouple_loss:0.013868491165339947
loss_pred:0.033842459321022034, decouple_loss:0.014042397029697895
Iteration: 786, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471559524536133, gen p mean: -0.4396655857563019, mean p set: 0.4476362466812134
loss_pred:0.033765193074941635, decouple_loss:0.015197725966572762
The modified gen p mean: 0.4499695599079132, gen p mean: -0.4314500689506531, mean p set: 0.4504498541355133The modified gen p mean: 0.44808343052864075, gen p mean: -0.4360630214214325, mean p set: 0.44856372475624084
loss_pred:0.03357900679111481, decouple_loss:0.013179616071283817
loss_pred:0.0325494147837162, decouple_loss:0.01365247368812561
Iteration: 787, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44849711656570435, gen p mean: -0.42341548204421997, mean p set: 0.44897738099098206
loss_pred:0.0321221649646759, decouple_loss:0.01290957722812891
The modified gen p mean: 0.44895660877227783, gen p mean: -0.4207957983016968, mean p set: 0.44943690299987793The modified gen p mean: 0.4492274224758148, gen p mean: -0.4196688234806061, mean p set: 0.4497077465057373
loss_pred:0.031848371028900146, decouple_loss:0.013042419217526913
loss_pred:0.03195175901055336, decouple_loss:0.012985020875930786
Iteration: 788, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501950442790985, gen p mean: -0.4240860641002655, mean p set: 0.4506753385066986
loss_pred:0.03281388804316521, decouple_loss:0.013983615674078465
The modified gen p mean: 0.448650598526001, gen p mean: -0.4201880395412445, mean p set: 0.44913092255592346The modified gen p mean: 0.4478321671485901, gen p mean: -0.426787793636322, mean p set: 0.4483124613761902
loss_pred:0.03217912092804909, decouple_loss:0.013627401553094387
loss_pred:0.031201673671603203, decouple_loss:0.013763878494501114
Iteration: 789, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44857487082481384, gen p mean: -0.429485946893692, mean p set: 0.44905519485473633
loss_pred:0.03295475244522095, decouple_loss:0.014844580553472042
The modified gen p mean: 0.44818273186683655, gen p mean: -0.4329189956188202, mean p set: 0.44866296648979187The modified gen p mean: 0.44793662428855896, gen p mean: -0.42653101682662964, mean p set: 0.44841691851615906
loss_pred:0.033717092126607895, decouple_loss:0.014997517690062523
loss_pred:0.030968008562922478, decouple_loss:0.013398375362157822
Iteration: 790, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478693902492523, gen p mean: -0.43180572986602783, mean p set: 0.44834965467453003
loss_pred:0.03313322365283966, decouple_loss:0.01363071147352457
The modified gen p mean: 0.44858604669570923, gen p mean: -0.4334510564804077, mean p set: 0.4490663409233093The modified gen p mean: 0.4477083086967468, gen p mean: -0.4306700527667999, mean p set: 0.4481886029243469
loss_pred:0.03185722976922989, decouple_loss:0.013164885342121124
loss_pred:0.03275834023952484, decouple_loss:0.013145707547664642
2023-05-01 13:41:19 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.4433850347995758, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.432876855134964, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.4362475872039795, mean p set: 0.4500633478164673
loss_pred:0.033552881330251694, decouple_loss:0.013550895266234875
loss_pred:0.032075434923172, decouple_loss:0.013671605847775936
loss_pred:0.03265703469514847, decouple_loss:0.013333048671483994
WV_0_PC_1_EH_0_PS_40_15, loss: 0.033437710255384445, avg_mse: 0.037582095712423325
current test mse: 0.037582
Iteration: 791, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484025835990906, gen p mean: -0.43767720460891724, mean p set: 0.4488828480243683
The modified gen p mean: 0.44784513115882874, gen p mean: -0.4361092746257782, mean p set: 0.44832542538642883
The modified gen p mean: 0.44841268658638, gen p mean: -0.43967321515083313, mean p set: 0.4488929510116577
loss_pred:0.03231420740485191, decouple_loss:0.013302492909133434
loss_pred:0.03283004090189934, decouple_loss:0.014606593176722527
loss_pred:0.03254007175564766, decouple_loss:0.014421341940760612
Iteration: 792, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481617510318756, gen p mean: -0.43410852551460266, mean p set: 0.4486420452594757
loss_pred:0.033467214554548264, decouple_loss:0.01257876493036747
The modified gen p mean: 0.4487597942352295, gen p mean: -0.43293339014053345, mean p set: 0.4492400586605072The modified gen p mean: 0.4488055109977722, gen p mean: -0.43583035469055176, mean p set: 0.4492858350276947
loss_pred:0.032328903675079346, decouple_loss:0.013452219776809216
loss_pred:0.03334307670593262, decouple_loss:0.013285721652209759
Iteration: 793, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479454457759857, gen p mean: -0.4295317232608795, mean p set: 0.4484257698059082
loss_pred:0.03230847418308258, decouple_loss:0.012657156214118004
The modified gen p mean: 0.44882193207740784, gen p mean: -0.4243883788585663, mean p set: 0.44930222630500793The modified gen p mean: 0.4484231472015381, gen p mean: -0.42712509632110596, mean p set: 0.4489034116268158
loss_pred:0.031977687031030655, decouple_loss:0.012719552032649517
loss_pred:0.03269904479384422, decouple_loss:0.013506932184100151
Iteration: 794, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44897907972335815, gen p mean: -0.4331500828266144, mean p set: 0.44945937395095825
loss_pred:0.03149612620472908, decouple_loss:0.012651899829506874
The modified gen p mean: 0.4480079710483551, gen p mean: -0.43194761872291565, mean p set: 0.4484882652759552The modified gen p mean: 0.44917917251586914, gen p mean: -0.43067681789398193, mean p set: 0.44965940713882446
loss_pred:0.03200424090027809, decouple_loss:0.013170486316084862
loss_pred:0.03193359076976776, decouple_loss:0.013121924363076687
Iteration: 795, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485883116722107, gen p mean: -0.43868786096572876, mean p set: 0.4490686058998108
loss_pred:0.03322692587971687, decouple_loss:0.013826445676386356
The modified gen p mean: 0.44877612590789795, gen p mean: -0.43671855330467224, mean p set: 0.44925642013549805The modified gen p mean: 0.4474453926086426, gen p mean: -0.4325433075428009, mean p set: 0.4479256868362427
loss_pred:0.03311143070459366, decouple_loss:0.014209085144102573
loss_pred:0.03262615203857422, decouple_loss:0.013039030134677887
Iteration: 796, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479890763759613, gen p mean: -0.433455228805542, mean p set: 0.448469340801239
loss_pred:0.032845258712768555, decouple_loss:0.013299446552991867
The modified gen p mean: 0.44761672616004944, gen p mean: -0.43480372428894043, mean p set: 0.4480970501899719The modified gen p mean: 0.44945159554481506, gen p mean: -0.4316858649253845, mean p set: 0.44993188977241516
loss_pred:0.032288119196891785, decouple_loss:0.01297173835337162
loss_pred:0.03182051330804825, decouple_loss:0.013554387725889683
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012007_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012007_3_24hr.npz
NaN value num: 0
Iteration: 797, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44776391983032227, gen p mean: -0.43162909150123596, mean p set: 0.44824421405792236
loss_pred:0.034925200045108795, decouple_loss:0.013597678393125534
The modified gen p mean: 0.4484494626522064, gen p mean: -0.44398096203804016, mean p set: 0.4489297568798065The modified gen p mean: 0.44680458307266235, gen p mean: -0.43995246291160583, mean p set: 0.44728490710258484
loss_pred:0.032323867082595825, decouple_loss:0.015067490749061108
loss_pred:0.03244646266102791, decouple_loss:0.01534388866275549
Iteration: 798, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44653043150901794, gen p mean: -0.4440711736679077, mean p set: 0.44701069593429565
loss_pred:0.03279290720820427, decouple_loss:0.01495326030999422
The modified gen p mean: 0.4466511309146881, gen p mean: -0.44261646270751953, mean p set: 0.4471314251422882The modified gen p mean: 0.4479723274707794, gen p mean: -0.43815112113952637, mean p set: 0.4484526515007019
loss_pred:0.03326175734400749, decouple_loss:0.01554442010819912
loss_pred:0.03356032818555832, decouple_loss:0.0136614004150033
Iteration: 799, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472830295562744, gen p mean: -0.44000890851020813, mean p set: 0.4477632939815521
loss_pred:0.03386910259723663, decouple_loss:0.014413588680326939
The modified gen p mean: 0.4479794204235077, gen p mean: -0.42861828207969666, mean p set: 0.4484597444534302The modified gen p mean: 0.44702786207199097, gen p mean: -0.44537481665611267, mean p set: 0.44750818610191345
loss_pred:0.03368068486452103, decouple_loss:0.012848420068621635
loss_pred:0.032661471515893936, decouple_loss:0.014379629865288734
Iteration: 800, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468744695186615, gen p mean: -0.43879276514053345, mean p set: 0.4473547637462616
loss_pred:0.03210519254207611, decouple_loss:0.01388250570744276
The modified gen p mean: 0.4482360780239105, gen p mean: -0.43188151717185974, mean p set: 0.448716402053833The modified gen p mean: 0.448213666677475, gen p mean: -0.42638033628463745, mean p set: 0.4486939311027527
loss_pred:0.03161797672510147, decouple_loss:0.013985767960548401
loss_pred:0.03418593481183052, decouple_loss:0.01294981874525547
2023-05-01 13:43:53 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.4346199631690979, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.42526257038116455, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.42800581455230713, mean p set: 0.4500633478164673
loss_pred:0.03357236832380295, decouple_loss:0.013651018030941486
loss_pred:0.03209308534860611, decouple_loss:0.01393538061529398
loss_pred:0.03270778805017471, decouple_loss:0.01333810854703188
WV_0_PC_1_EH_0_PS_40_15, loss: 0.03347316011786461, avg_mse: 0.037691179662942886
current test mse: 0.037691
Iteration: 801, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44716039299964905, gen p mean: -0.43646544218063354, mean p set: 0.44764068722724915
The modified gen p mean: 0.4472379684448242, gen p mean: -0.4334855079650879, mean p set: 0.44771823287010193
The modified gen p mean: 0.4478556215763092, gen p mean: -0.4278542399406433, mean p set: 0.4483358860015869
loss_pred:0.03358227387070656, decouple_loss:0.013266618363559246
loss_pred:0.03274132311344147, decouple_loss:0.014042427763342857loss_pred:0.03408537805080414, decouple_loss:0.013297408819198608
Iteration: 802, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44891098141670227, gen p mean: -0.44397997856140137, mean p set: 0.44939130544662476
loss_pred:0.03347254917025566, decouple_loss:0.013699747622013092
The modified gen p mean: 0.44772493839263916, gen p mean: -0.43084144592285156, mean p set: 0.44820523262023926The modified gen p mean: 0.44801634550094604, gen p mean: -0.4361833333969116, mean p set: 0.44849663972854614
loss_pred:0.03336341306567192, decouple_loss:0.012518471106886864
loss_pred:0.03435225039720535, decouple_loss:0.012650641612708569
Iteration: 803, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44663500785827637, gen p mean: -0.43876874446868896, mean p set: 0.4471152722835541
loss_pred:0.0333540216088295, decouple_loss:0.012153321877121925
The modified gen p mean: 0.44786643981933594, gen p mean: -0.43626686930656433, mean p set: 0.44834673404693604
The modified gen p mean: 0.4470593333244324, gen p mean: -0.4392028748989105, mean p set: 0.44753962755203247
loss_pred:0.03349737823009491, decouple_loss:0.012240007519721985
loss_pred:0.032923776656389236, decouple_loss:0.012245869264006615
Iteration: 804, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44702014327049255, gen p mean: -0.44869929552078247, mean p set: 0.44750040769577026
loss_pred:0.03394196555018425, decouple_loss:0.011823063716292381
The modified gen p mean: 0.44788864254951477, gen p mean: -0.45006048679351807, mean p set: 0.44836893677711487The modified gen p mean: 0.4475628435611725, gen p mean: -0.46081095933914185, mean p set: 0.4480431377887726
loss_pred:0.033109404146671295, decouple_loss:0.01203081663697958
loss_pred:0.034074265509843826, decouple_loss:0.013540047220885754
Iteration: 805, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44634732604026794, gen p mean: -0.45253098011016846, mean p set: 0.44682762026786804
loss_pred:0.03192659839987755, decouple_loss:0.014331183396279812
The modified gen p mean: 0.4475528299808502, gen p mean: -0.4529650807380676, mean p set: 0.4480331242084503The modified gen p mean: 0.4470949172973633, gen p mean: -0.4587559998035431, mean p set: 0.4475752115249634
loss_pred:0.03220908343791962, decouple_loss:0.012664368376135826
loss_pred:0.03218366950750351, decouple_loss:0.013022968545556068
Iteration: 806, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44645819067955017, gen p mean: -0.44033437967300415, mean p set: 0.44693848490715027
loss_pred:0.03353484347462654, decouple_loss:0.011931328102946281
The modified gen p mean: 0.44741570949554443, gen p mean: -0.44578060507774353, mean p set: 0.44789600372314453The modified gen p mean: 0.44781041145324707, gen p mean: -0.45432624220848083, mean p set: 0.44829070568084717
loss_pred:0.03377231955528259, decouple_loss:0.012551020830869675
loss_pred:0.03294423967599869, decouple_loss:0.013028085231781006
Iteration: 807, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4462895691394806, gen p mean: -0.4381221830844879, mean p set: 0.4467698633670807
loss_pred:0.03385290130972862, decouple_loss:0.013044636696577072
The modified gen p mean: 0.4457228481769562, gen p mean: -0.44175630807876587, mean p set: 0.44620317220687866The modified gen p mean: 0.44669944047927856, gen p mean: -0.439520925283432, mean p set: 0.44717973470687866
loss_pred:0.034158602356910706, decouple_loss:0.012986293993890285
loss_pred:0.032627351582050323, decouple_loss:0.01239565946161747
Iteration: 808, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44892945885658264, gen p mean: -0.4450940787792206, mean p set: 0.44940972328186035
loss_pred:0.03196905925869942, decouple_loss:0.013142488896846771
The modified gen p mean: 0.44762206077575684, gen p mean: -0.43529775738716125, mean p set: 0.4481023848056793The modified gen p mean: 0.4468402862548828, gen p mean: -0.43640899658203125, mean p set: 0.4473206102848053
loss_pred:0.033605482429265976, decouple_loss:0.012706469744443893
loss_pred:0.03461079299449921, decouple_loss:0.013303576037287712
Iteration: 809, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44694846868515015, gen p mean: -0.4410129189491272, mean p set: 0.44742879271507263
loss_pred:0.03454544395208359, decouple_loss:0.012962988577783108
The modified gen p mean: 0.4470505118370056, gen p mean: -0.4497460424900055, mean p set: 0.4475308060646057The modified gen p mean: 0.4473426938056946, gen p mean: -0.45077812671661377, mean p set: 0.4478229880332947
loss_pred:0.03262420743703842, decouple_loss:0.013851584866642952
loss_pred:0.0320059098303318, decouple_loss:0.012711864896118641
Iteration: 810, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477410912513733, gen p mean: -0.4449597895145416, mean p set: 0.4482213854789734
loss_pred:0.031598810106515884, decouple_loss:0.012722093611955643
The modified gen p mean: 0.44612568616867065, gen p mean: -0.44843119382858276, mean p set: 0.44660601019859314The modified gen p mean: 0.4478079080581665, gen p mean: -0.448343962430954, mean p set: 0.448288232088089
loss_pred:0.0323975495994091, decouple_loss:0.012684065848588943
loss_pred:0.03172636404633522, decouple_loss:0.012170325964689255
2023-05-01 13:45:46 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.44528159499168396, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.43641889095306396, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.43900448083877563, mean p set: 0.4500633478164673
loss_pred:0.03358125314116478, decouple_loss:0.01305497158318758
loss_pred:0.032282233238220215, decouple_loss:0.01428217813372612
loss_pred:0.03293623402714729, decouple_loss:0.013576537370681763
WV_0_PC_1_EH_0_PS_40_15, loss: 0.03361513465642929, avg_mse: 0.03799698129296303
current test mse: 0.037997
Iteration: 811, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471675753593445, gen p mean: -0.43789780139923096, mean p set: 0.4476478397846222
The modified gen p mean: 0.4468745291233063, gen p mean: -0.4456433951854706, mean p set: 0.447354793548584
The modified gen p mean: 0.44810450077056885, gen p mean: -0.4444420039653778, mean p set: 0.44858479499816895
loss_pred:0.03437091037631035, decouple_loss:0.013049757108092308
loss_pred:0.03359231352806091, decouple_loss:0.013677156530320644
loss_pred:0.032750099897384644, decouple_loss:0.012992692179977894
Iteration: 812, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477769434452057, gen p mean: -0.4344993233680725, mean p set: 0.4482572078704834
loss_pred:0.033921580761671066, decouple_loss:0.012001744471490383
The modified gen p mean: 0.4486711323261261, gen p mean: -0.444838285446167, mean p set: 0.4491514265537262The modified gen p mean: 0.4458576738834381, gen p mean: -0.43804022669792175, mean p set: 0.4463379681110382
loss_pred:0.03136245161294937, decouple_loss:0.011965113691985607
loss_pred:0.03299347311258316, decouple_loss:0.011925566010177135
Iteration: 813, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44815143942832947, gen p mean: -0.42869672179222107, mean p set: 0.44863173365592957
loss_pred:0.03242706134915352, decouple_loss:0.012504994869232178
The modified gen p mean: 0.4484260082244873, gen p mean: -0.43947312235832214, mean p set: 0.4489063620567322The modified gen p mean: 0.44811150431632996, gen p mean: -0.4319663941860199, mean p set: 0.44859179854393005
loss_pred:0.031862277537584305, decouple_loss:0.012343127280473709
loss_pred:0.03327829763293266, decouple_loss:0.012874484062194824
Iteration: 814, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471752941608429, gen p mean: -0.43740543723106384, mean p set: 0.447655588388443
loss_pred:0.03350678086280823, decouple_loss:0.012960466556251049
The modified gen p mean: 0.44636884331703186, gen p mean: -0.4341193437576294, mean p set: 0.44684910774230957The modified gen p mean: 0.44784781336784363, gen p mean: -0.4443729817867279, mean p set: 0.4483281373977661
loss_pred:0.033527567982673645, decouple_loss:0.013645509257912636
loss_pred:0.03334180265665054, decouple_loss:0.012856806628406048
Iteration: 815, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468475878238678, gen p mean: -0.44108816981315613, mean p set: 0.4473278820514679
loss_pred:0.03374745696783066, decouple_loss:0.012793133035302162
The modified gen p mean: 0.4468744397163391, gen p mean: -0.43706244230270386, mean p set: 0.4473547041416168The modified gen p mean: 0.4490271210670471, gen p mean: -0.4426024258136749, mean p set: 0.4495074450969696
loss_pred:0.03303688392043114, decouple_loss:0.013190573081374168
loss_pred:0.03301927447319031, decouple_loss:0.012961206957697868
Iteration: 816, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471132755279541, gen p mean: -0.45210888981819153, mean p set: 0.4475935399532318
loss_pred:0.03238612785935402, decouple_loss:0.013198058120906353
The modified gen p mean: 0.4477159082889557, gen p mean: -0.44396457076072693, mean p set: 0.4481962025165558The modified gen p mean: 0.4465724527835846, gen p mean: -0.4435615539550781, mean p set: 0.4470527172088623
loss_pred:0.033315062522888184, decouple_loss:0.011915133334696293
loss_pred:0.03472528234124184, decouple_loss:0.01227717287838459
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012004_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012004_3_24hr.npz
NaN value num: 0
Iteration: 817, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497767388820648, gen p mean: -0.43463119864463806, mean p set: 0.4502570331096649
loss_pred:0.03402113914489746, decouple_loss:0.014416282996535301
The modified gen p mean: 0.4514922797679901, gen p mean: -0.4324297308921814, mean p set: 0.4519725739955902The modified gen p mean: 0.4523635804653168, gen p mean: -0.4348641037940979, mean p set: 0.45284390449523926
loss_pred:0.033466555178165436, decouple_loss:0.014832358807325363
loss_pred:0.03376363590359688, decouple_loss:0.016774412244558334
Iteration: 818, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45051440596580505, gen p mean: -0.4384797215461731, mean p set: 0.45099470019340515
loss_pred:0.03336440399289131, decouple_loss:0.015541342087090015
The modified gen p mean: 0.4496020972728729, gen p mean: -0.4314046800136566, mean p set: 0.450082391500473The modified gen p mean: 0.4489477574825287, gen p mean: -0.43381956219673157, mean p set: 0.4494280517101288
loss_pred:0.0315057747066021, decouple_loss:0.015422765165567398
loss_pred:0.03229260817170143, decouple_loss:0.01534461509436369
Iteration: 819, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45225515961647034, gen p mean: -0.4387349784374237, mean p set: 0.45273545384407043
loss_pred:0.03287247195839882, decouple_loss:0.016401760280132294
The modified gen p mean: 0.4531627595424652, gen p mean: -0.44170495867729187, mean p set: 0.4536430835723877The modified gen p mean: 0.45173248648643494, gen p mean: -0.43769046664237976, mean p set: 0.45221275091171265
loss_pred:0.03427964448928833, decouple_loss:0.01617317646741867
loss_pred:0.03332112357020378, decouple_loss:0.01486301515251398
Iteration: 820, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45142248272895813, gen p mean: -0.4412045180797577, mean p set: 0.4519027769565582
loss_pred:0.031485531479120255, decouple_loss:0.01456256303936243
The modified gen p mean: 0.44925418496131897, gen p mean: -0.4340198040008545, mean p set: 0.4497344493865967The modified gen p mean: 0.4487006664276123, gen p mean: -0.43652406334877014, mean p set: 0.44918093085289
loss_pred:0.032247144728899, decouple_loss:0.013951894827187061
loss_pred:0.032738201320171356, decouple_loss:0.014377180486917496
2023-05-01 13:48:17 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.4527308940887451, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.44255250692367554, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.44611048698425293, mean p set: 0.4500633478164673
loss_pred:0.03382880240678787, decouple_loss:0.01425943337380886
loss_pred:0.03212185204029083, decouple_loss:0.014170111157000065
loss_pred:0.032720860093832016, decouple_loss:0.014073193073272705
WV_0_PC_1_EH_0_PS_40_15, loss: 0.0335988849401474, avg_mse: 0.038014672696590424
current test mse: 0.038015
Iteration: 821, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488845467567444, gen p mean: -0.4369505047798157, mean p set: 0.4493648409843445
The modified gen p mean: 0.4515460133552551, gen p mean: -0.4499446153640747, mean p set: 0.4520263373851776
The modified gen p mean: 0.45051953196525574, gen p mean: -0.44237783551216125, mean p set: 0.45099982619285583
loss_pred:0.03311067819595337, decouple_loss:0.013570141978561878
loss_pred:0.03204470872879028, decouple_loss:0.013622800819575787
loss_pred:0.0322759747505188, decouple_loss:0.013910876587033272
Iteration: 822, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491100013256073, gen p mean: -0.43993568420410156, mean p set: 0.4495902955532074
loss_pred:0.031438782811164856, decouple_loss:0.013283762149512768
The modified gen p mean: 0.45004647970199585, gen p mean: -0.4446515142917633, mean p set: 0.45052674412727356The modified gen p mean: 0.45270460844039917, gen p mean: -0.4432198405265808, mean p set: 0.45318490266799927
loss_pred:0.03276796266436577, decouple_loss:0.014028135687112808
loss_pred:0.033586855977773666, decouple_loss:0.013741347938776016
Iteration: 823, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44974738359451294, gen p mean: -0.45131567120552063, mean p set: 0.45022767782211304
loss_pred:0.033501192927360535, decouple_loss:0.01387281809002161
The modified gen p mean: 0.45059874653816223, gen p mean: -0.45311829447746277, mean p set: 0.45107904076576233The modified gen p mean: 0.4521658420562744, gen p mean: -0.4559996426105499, mean p set: 0.4526461362838745
loss_pred:0.032445065677165985, decouple_loss:0.014170226640999317
loss_pred:0.03169487416744232, decouple_loss:0.014300061389803886
Iteration: 824, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45129385590553284, gen p mean: -0.45995858311653137, mean p set: 0.45177412033081055
loss_pred:0.03157981112599373, decouple_loss:0.015110603533685207
The modified gen p mean: 0.4512546956539154, gen p mean: -0.4598560929298401, mean p set: 0.4517350196838379
The modified gen p mean: 0.44911542534828186, gen p mean: -0.44883492588996887, mean p set: 0.44959568977355957
loss_pred:0.032202061265707016, decouple_loss:0.013624336570501328
loss_pred:0.03268367424607277, decouple_loss:0.013127420097589493
Iteration: 825, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496880769729614, gen p mean: -0.444912314414978, mean p set: 0.4501683712005615
loss_pred:0.033348701894283295, decouple_loss:0.012897874228656292
The modified gen p mean: 0.4513400197029114, gen p mean: -0.4480501115322113, mean p set: 0.4518203139305115The modified gen p mean: 0.4493904411792755, gen p mean: -0.4473310708999634, mean p set: 0.4498707354068756
loss_pred:0.03219138830900192, decouple_loss:0.013890504837036133
loss_pred:0.032237403094768524, decouple_loss:0.013045838102698326
Iteration: 826, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496833384037018, gen p mean: -0.4427231550216675, mean p set: 0.4501636028289795
loss_pred:0.032684072852134705, decouple_loss:0.014520632103085518
The modified gen p mean: 0.45371267199516296, gen p mean: -0.44758790731430054, mean p set: 0.4541929364204407The modified gen p mean: 0.44854339957237244, gen p mean: -0.44473618268966675, mean p set: 0.44902369379997253
loss_pred:0.03271373733878136, decouple_loss:0.01465835515409708
loss_pred:0.03238192945718765, decouple_loss:0.014622338116168976
Iteration: 827, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45213818550109863, gen p mean: -0.4470364451408386, mean p set: 0.45261847972869873
loss_pred:0.03294343873858452, decouple_loss:0.013548832386732101
The modified gen p mean: 0.44855543971061707, gen p mean: -0.4433842897415161, mean p set: 0.4490357041358948The modified gen p mean: 0.4514947235584259, gen p mean: -0.4486992061138153, mean p set: 0.451975017786026
loss_pred:0.03221990168094635, decouple_loss:0.012891226448118687
loss_pred:0.0316050760447979, decouple_loss:0.014444537460803986
Iteration: 828, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504566192626953, gen p mean: -0.4488503038883209, mean p set: 0.4509369134902954
loss_pred:0.033750519156455994, decouple_loss:0.012904200702905655
The modified gen p mean: 0.45158591866493225, gen p mean: -0.45213583111763, mean p set: 0.45206621289253235The modified gen p mean: 0.44923752546310425, gen p mean: -0.446135938167572, mean p set: 0.44971778988838196
loss_pred:0.03252109885215759, decouple_loss:0.013085230253636837
loss_pred:0.03211232274770737, decouple_loss:0.012818881310522556
Iteration: 829, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45052701234817505, gen p mean: -0.4608880281448364, mean p set: 0.45100730657577515
loss_pred:0.03322070091962814, decouple_loss:0.013924963772296906
The modified gen p mean: 0.4509755074977875, gen p mean: -0.45728713274002075, mean p set: 0.4514558017253876The modified gen p mean: 0.45077332854270935, gen p mean: -0.4625796377658844, mean p set: 0.45125362277030945
loss_pred:0.03273226320743561, decouple_loss:0.013068043626844883
loss_pred:0.031576238572597504, decouple_loss:0.012897257693111897
Iteration: 830, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45266130566596985, gen p mean: -0.46248406171798706, mean p set: 0.45314162969589233
loss_pred:0.032896190881729126, decouple_loss:0.013794449158012867
The modified gen p mean: 0.4505396783351898, gen p mean: -0.4562136232852936, mean p set: 0.4510199725627899The modified gen p mean: 0.45160946249961853, gen p mean: -0.45881935954093933, mean p set: 0.452089786529541
loss_pred:0.03048778884112835, decouple_loss:0.013345278799533844
loss_pred:0.03264956921339035, decouple_loss:0.01220089290291071
2023-05-01 13:50:13 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.45941030979156494, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.449624240398407, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.45293307304382324, mean p set: 0.4500633478164673
loss_pred:0.0335988849401474, decouple_loss:0.01406712457537651
loss_pred:0.03183390200138092, decouple_loss:0.014220074750483036
loss_pred:0.03253643214702606, decouple_loss:0.013869266025722027
WV_0_PC_1_EH_0_PS_40_15, loss: 0.03335901349782944, avg_mse: 0.03781825676560402
current test mse: 0.037818
Iteration: 831, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4515613615512848, gen p mean: -0.45420417189598083, mean p set: 0.4520416855812073
The modified gen p mean: 0.4518241286277771, gen p mean: -0.4519350528717041, mean p set: 0.4523043632507324
The modified gen p mean: 0.4512578845024109, gen p mean: -0.45491504669189453, mean p set: 0.451738178730011
loss_pred:0.03225300461053848, decouple_loss:0.0122961001470685
loss_pred:0.031967874616384506, decouple_loss:0.012936603277921677
loss_pred:0.03129970282316208, decouple_loss:0.013682874850928783
Iteration: 832, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45134761929512024, gen p mean: -0.4489852786064148, mean p set: 0.45182791352272034
loss_pred:0.03241381049156189, decouple_loss:0.012417447753250599
The modified gen p mean: 0.4494071900844574, gen p mean: -0.44630029797554016, mean p set: 0.4498874545097351The modified gen p mean: 0.4499387741088867, gen p mean: -0.4504412114620209, mean p set: 0.4504190683364868
loss_pred:0.031616855412721634, decouple_loss:0.013293619267642498
loss_pred:0.03309441730380058, decouple_loss:0.01276896707713604
Iteration: 833, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507658779621124, gen p mean: -0.4522671699523926, mean p set: 0.45124614238739014
loss_pred:0.032384976744651794, decouple_loss:0.012869302183389664
The modified gen p mean: 0.45084869861602783, gen p mean: -0.44936633110046387, mean p set: 0.45132896304130554The modified gen p mean: 0.45130518078804016, gen p mean: -0.45740583539009094, mean p set: 0.45178547501564026
loss_pred:0.031356871128082275, decouple_loss:0.012138291262090206
loss_pred:0.032787393778562546, decouple_loss:0.012145986780524254
Iteration: 834, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4532161355018616, gen p mean: -0.4529784917831421, mean p set: 0.4536963999271393
loss_pred:0.03222813457250595, decouple_loss:0.013441121205687523
The modified gen p mean: 0.45085665583610535, gen p mean: -0.4500822424888611, mean p set: 0.45133697986602783The modified gen p mean: 0.45221543312072754, gen p mean: -0.45618903636932373, mean p set: 0.45269572734832764
loss_pred:0.03250451013445854, decouple_loss:0.011878064833581448
loss_pred:0.030334357172250748, decouple_loss:0.012821217067539692
Iteration: 835, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45272067189216614, gen p mean: -0.4528159499168396, mean p set: 0.45320096611976624
loss_pred:0.03281793370842934, decouple_loss:0.013743235729634762
The modified gen p mean: 0.4512452185153961, gen p mean: -0.4543266296386719, mean p set: 0.4517255127429962The modified gen p mean: 0.45043185353279114, gen p mean: -0.45653048157691956, mean p set: 0.45091211795806885
loss_pred:0.03258780017495155, decouple_loss:0.012938971631228924
loss_pred:0.030960015952587128, decouple_loss:0.012453743256628513
Iteration: 836, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45080551505088806, gen p mean: -0.4525138735771179, mean p set: 0.45128580927848816
loss_pred:0.031135983765125275, decouple_loss:0.011806205846369267
The modified gen p mean: 0.4520755410194397, gen p mean: -0.4557192325592041, mean p set: 0.4525558054447174The modified gen p mean: 0.4497973322868347, gen p mean: -0.45344847440719604, mean p set: 0.4502776563167572
loss_pred:0.03147545084357262, decouple_loss:0.013250431977212429
loss_pred:0.03113611415028572, decouple_loss:0.012684927321970463
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012003_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012003_3_24hr.npz
NaN value num: 0
Iteration: 837, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45007792115211487, gen p mean: -0.44677212834358215, mean p set: 0.4505581855773926
loss_pred:0.03254235163331032, decouple_loss:0.013640780933201313
The modified gen p mean: 0.4496883451938629, gen p mean: -0.44708681106567383, mean p set: 0.4501686692237854The modified gen p mean: 0.451625794172287, gen p mean: -0.4517042934894562, mean p set: 0.4521060883998871
loss_pred:0.033127814531326294, decouple_loss:0.014037626795470715
loss_pred:0.032823506742715836, decouple_loss:0.01475963369011879
Iteration: 838, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44984570145606995, gen p mean: -0.44642317295074463, mean p set: 0.45032599568367004
loss_pred:0.032152894884347916, decouple_loss:0.01337108202278614
The modified gen p mean: 0.44980499148368835, gen p mean: -0.44991910457611084, mean p set: 0.45028528571128845The modified gen p mean: 0.45048782229423523, gen p mean: -0.4533641040325165, mean p set: 0.45096808671951294
loss_pred:0.0319167822599411, decouple_loss:0.013860935345292091
loss_pred:0.03248564526438713, decouple_loss:0.013104632496833801
Iteration: 839, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4529787003993988, gen p mean: -0.4595417380332947, mean p set: 0.4534589648246765
loss_pred:0.032611481845378876, decouple_loss:0.01578870788216591
The modified gen p mean: 0.44892454147338867, gen p mean: -0.45702871680259705, mean p set: 0.4494048058986664The modified gen p mean: 0.4489035904407501, gen p mean: -0.4542345404624939, mean p set: 0.4493838846683502
loss_pred:0.0318216048181057, decouple_loss:0.013996546156704426
loss_pred:0.033449526876211166, decouple_loss:0.014735330827534199
Iteration: 840, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492345154285431, gen p mean: -0.4460408091545105, mean p set: 0.4497148096561432
loss_pred:0.03319069370627403, decouple_loss:0.013717819936573505
The modified gen p mean: 0.45316675305366516, gen p mean: -0.45517608523368835, mean p set: 0.45364704728126526The modified gen p mean: 0.44972240924835205, gen p mean: -0.44765540957450867, mean p set: 0.45020267367362976
loss_pred:0.03257010877132416, decouple_loss:0.013757238164544106
loss_pred:0.03443075343966484, decouple_loss:0.013704164884984493
2023-05-01 13:52:46 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.4616890251636505, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.4515095055103302, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.4547756016254425, mean p set: 0.4500633478164673
loss_pred:0.03324776142835617, decouple_loss:0.014576480723917484
loss_pred:0.03156455233693123, decouple_loss:0.014130943454802036
loss_pred:0.03227667883038521, decouple_loss:0.014173989184200764
WV_0_PC_1_EH_0_PS_40_15, loss: 0.03307768702507019, avg_mse: 0.03741966560482979
current test mse: 0.03742
Iteration: 841, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501268267631531, gen p mean: -0.457114577293396, mean p set: 0.4506070911884308
The modified gen p mean: 0.4527396261692047, gen p mean: -0.44840502738952637, mean p set: 0.4532198905944824
The modified gen p mean: 0.44949871301651, gen p mean: -0.44649046659469604, mean p set: 0.4499790072441101
loss_pred:0.032903555780649185, decouple_loss:0.013404881581664085
loss_pred:0.033226191997528076, decouple_loss:0.014967063441872597
loss_pred:0.03392224386334419, decouple_loss:0.013060233555734158
Iteration: 842, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44876691699028015, gen p mean: -0.46180081367492676, mean p set: 0.44924721121788025
loss_pred:0.03283770754933357, decouple_loss:0.013878893107175827
The modified gen p mean: 0.44970133900642395, gen p mean: -0.4529334306716919, mean p set: 0.45018163323402405The modified gen p mean: 0.4511922299861908, gen p mean: -0.4644530415534973, mean p set: 0.4516725242137909
loss_pred:0.031998854130506516, decouple_loss:0.014804753474891186
loss_pred:0.03335954248905182, decouple_loss:0.014132121577858925
Iteration: 843, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502222239971161, gen p mean: -0.4567886292934418, mean p set: 0.4507025480270386
loss_pred:0.033649884164333344, decouple_loss:0.013744556345045567
The modified gen p mean: 0.4485595226287842, gen p mean: -0.47462669014930725, mean p set: 0.44903984665870667The modified gen p mean: 0.45256519317626953, gen p mean: -0.4598555266857147, mean p set: 0.45304545760154724
loss_pred:0.03242027014493942, decouple_loss:0.014321571215987206
loss_pred:0.031914982944726944, decouple_loss:0.014336100779473782
Iteration: 844, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44918400049209595, gen p mean: -0.46312955021858215, mean p set: 0.44966429471969604
loss_pred:0.033620402216911316, decouple_loss:0.013734064064919949
The modified gen p mean: 0.4502153694629669, gen p mean: -0.46031099557876587, mean p set: 0.450695663690567The modified gen p mean: 0.44933873414993286, gen p mean: -0.4748705327510834, mean p set: 0.44981902837753296
loss_pred:0.033156588673591614, decouple_loss:0.012825002893805504
loss_pred:0.032087478786706924, decouple_loss:0.013765964657068253
Iteration: 845, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488403797149658, gen p mean: -0.4658643305301666, mean p set: 0.4493206739425659
loss_pred:0.0318123921751976, decouple_loss:0.012810957618057728
The modified gen p mean: 0.4496876001358032, gen p mean: -0.4595503509044647, mean p set: 0.45016786456108093The modified gen p mean: 0.45304596424102783, gen p mean: -0.46488285064697266, mean p set: 0.45352625846862793
loss_pred:0.03386405110359192, decouple_loss:0.01311877928674221
loss_pred:0.03244601562619209, decouple_loss:0.014205667190253735
Iteration: 846, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44873303174972534, gen p mean: -0.45770731568336487, mean p set: 0.44921332597732544
loss_pred:0.033140525221824646, decouple_loss:0.012883787043392658
The modified gen p mean: 0.4526509642601013, gen p mean: -0.45793411135673523, mean p set: 0.4531312584877014The modified gen p mean: 0.4495389461517334, gen p mean: -0.4542621374130249, mean p set: 0.4500192403793335
loss_pred:0.03296700119972229, decouple_loss:0.014065990224480629
loss_pred:0.03330915793776512, decouple_loss:0.01265962328761816
Iteration: 847, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44953402876853943, gen p mean: -0.45683762431144714, mean p set: 0.4500143229961395
loss_pred:0.03292045369744301, decouple_loss:0.012876827269792557
The modified gen p mean: 0.4507034122943878, gen p mean: -0.45748478174209595, mean p set: 0.4511836767196655The modified gen p mean: 0.4497276544570923, gen p mean: -0.46309545636177063, mean p set: 0.45020797848701477
loss_pred:0.033058613538742065, decouple_loss:0.013119575567543507
loss_pred:0.03342442214488983, decouple_loss:0.013123519718647003
Iteration: 848, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472643733024597, gen p mean: -0.47139889001846313, mean p set: 0.4477446675300598
loss_pred:0.03145314380526543, decouple_loss:0.013420592993497849
The modified gen p mean: 0.449763685464859, gen p mean: -0.466024249792099, mean p set: 0.4502440094947815The modified gen p mean: 0.44846266508102417, gen p mean: -0.470411092042923, mean p set: 0.44894298911094666
loss_pred:0.03433673083782196, decouple_loss:0.013324580155313015
loss_pred:0.031329747289419174, decouple_loss:0.013287961483001709
Iteration: 849, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491724371910095, gen p mean: -0.4542207419872284, mean p set: 0.4496527314186096
loss_pred:0.03233432397246361, decouple_loss:0.012735642492771149
The modified gen p mean: 0.45059192180633545, gen p mean: -0.4696250855922699, mean p set: 0.4510722756385803The modified gen p mean: 0.4498114287853241, gen p mean: -0.4628772735595703, mean p set: 0.4502916932106018
loss_pred:0.031736791133880615, decouple_loss:0.012652008794248104
loss_pred:0.03350942209362984, decouple_loss:0.012606614269316196
Iteration: 850, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500858783721924, gen p mean: -0.461340069770813, mean p set: 0.4505661725997925
loss_pred:0.03152777999639511, decouple_loss:0.011837760917842388
The modified gen p mean: 0.45171698927879333, gen p mean: -0.46767184138298035, mean p set: 0.45219725370407104The modified gen p mean: 0.4523541033267975, gen p mean: -0.4673510789871216, mean p set: 0.4528343677520752
loss_pred:0.032507553696632385, decouple_loss:0.013405208475887775
loss_pred:0.03228602930903435, decouple_loss:0.013668608851730824
2023-05-01 13:54:41 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.4682328402996063, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.45818430185317993, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.461540162563324, mean p set: 0.4500633478164673
loss_pred:0.033183202147483826, decouple_loss:0.013526447117328644
loss_pred:0.03150985389947891, decouple_loss:0.013390811160206795
loss_pred:0.03218846023082733, decouple_loss:0.013134870678186417
WV_0_PC_1_EH_0_PS_40_15, loss: 0.03296137601137161, avg_mse: 0.037449922412633896
current test mse: 0.03745
Iteration: 851, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45126333832740784, gen p mean: -0.4595619738101959, mean p set: 0.4517436623573303
The modified gen p mean: 0.4498523473739624, gen p mean: -0.46150726079940796, mean p set: 0.4503326416015625
The modified gen p mean: 0.4528215825557709, gen p mean: -0.46731439232826233, mean p set: 0.45330190658569336
loss_pred:0.03168714419007301, decouple_loss:0.012617009691894054
loss_pred:0.03354398533701897, decouple_loss:0.012759006582200527
loss_pred:0.033325426280498505, decouple_loss:0.01327014435082674
Iteration: 852, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44997426867485046, gen p mean: -0.46259087324142456, mean p set: 0.45045459270477295
loss_pred:0.03149212896823883, decouple_loss:0.011484487913548946
The modified gen p mean: 0.45039209723472595, gen p mean: -0.4558536410331726, mean p set: 0.45087239146232605The modified gen p mean: 0.4501339793205261, gen p mean: -0.45802953839302063, mean p set: 0.45061424374580383
loss_pred:0.03161924332380295, decouple_loss:0.011655525304377079
loss_pred:0.032453425228595734, decouple_loss:0.011862858198583126
Iteration: 853, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503084421157837, gen p mean: -0.45816993713378906, mean p set: 0.4507887363433838
loss_pred:0.03177204355597496, decouple_loss:0.012089514173567295
The modified gen p mean: 0.4530010223388672, gen p mean: -0.45550280809402466, mean p set: 0.4534813165664673The modified gen p mean: 0.44983574748039246, gen p mean: -0.4531281590461731, mean p set: 0.45031604170799255
loss_pred:0.033253561705350876, decouple_loss:0.01368079986423254
loss_pred:0.03342299163341522, decouple_loss:0.012397915124893188
Iteration: 854, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45271623134613037, gen p mean: -0.4511396288871765, mean p set: 0.4531964957714081
loss_pred:0.033177439123392105, decouple_loss:0.01337912492454052
The modified gen p mean: 0.44992244243621826, gen p mean: -0.4509495496749878, mean p set: 0.45040273666381836The modified gen p mean: 0.44869181513786316, gen p mean: -0.4588356018066406, mean p set: 0.44917213916778564
loss_pred:0.03211841359734535, decouple_loss:0.0129412692040205
loss_pred:0.0326555036008358, decouple_loss:0.011997236870229244
Iteration: 855, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4515535533428192, gen p mean: -0.4677789509296417, mean p set: 0.4520338773727417
loss_pred:0.032828304916620255, decouple_loss:0.013410895131528378
The modified gen p mean: 0.4506075978279114, gen p mean: -0.45929980278015137, mean p set: 0.4510878920555115The modified gen p mean: 0.4514254629611969, gen p mean: -0.4644777774810791, mean p set: 0.451905757188797
loss_pred:0.032570306211709976, decouple_loss:0.012159463949501514
loss_pred:0.03369459882378578, decouple_loss:0.012931461445987225
Iteration: 856, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44934505224227905, gen p mean: -0.4570404887199402, mean p set: 0.44982537627220154
loss_pred:0.03268612548708916, decouple_loss:0.012807567603886127
The modified gen p mean: 0.45217224955558777, gen p mean: -0.4726986885070801, mean p set: 0.45265257358551025The modified gen p mean: 0.45358121395111084, gen p mean: -0.4703383147716522, mean p set: 0.45406150817871094
loss_pred:0.03182696923613548, decouple_loss:0.012300216592848301
loss_pred:0.03232063353061676, decouple_loss:0.013402598910033703
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012015_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012015_3_24hr.npz
NaN value num: 0
Iteration: 857, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471697509288788, gen p mean: -0.462742418050766, mean p set: 0.4476500451564789
loss_pred:0.034695517271757126, decouple_loss:0.013242561370134354
The modified gen p mean: 0.44697073101997375, gen p mean: -0.4617851972579956, mean p set: 0.44745099544525146The modified gen p mean: 0.44684791564941406, gen p mean: -0.46489110589027405, mean p set: 0.44732820987701416
loss_pred:0.03489011526107788, decouple_loss:0.013820908032357693
loss_pred:0.034805819392204285, decouple_loss:0.013031108304858208
Iteration: 858, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44816336035728455, gen p mean: -0.47223299741744995, mean p set: 0.44864365458488464
loss_pred:0.033050794154405594, decouple_loss:0.012515638023614883
The modified gen p mean: 0.44811344146728516, gen p mean: -0.47537460923194885, mean p set: 0.44859373569488525The modified gen p mean: 0.44643425941467285, gen p mean: -0.47121110558509827, mean p set: 0.44691455364227295
loss_pred:0.032511547207832336, decouple_loss:0.012520813383162022
loss_pred:0.033687423914670944, decouple_loss:0.012442933395504951
Iteration: 859, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44745323061943054, gen p mean: -0.47494569420814514, mean p set: 0.44793352484703064
loss_pred:0.032417409121990204, decouple_loss:0.012548190541565418
The modified gen p mean: 0.4477715492248535, gen p mean: -0.4745745360851288, mean p set: 0.4482518434524536The modified gen p mean: 0.4478738307952881, gen p mean: -0.47675710916519165, mean p set: 0.4483541250228882
loss_pred:0.033877644687891006, decouple_loss:0.012074625119566917
loss_pred:0.033115487545728683, decouple_loss:0.012183559127151966
Iteration: 860, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44685637950897217, gen p mean: -0.4703998863697052, mean p set: 0.44733667373657227
loss_pred:0.035379718989133835, decouple_loss:0.011796867474913597
The modified gen p mean: 0.44541826844215393, gen p mean: -0.4695964455604553, mean p set: 0.44589856266975403The modified gen p mean: 0.4479663074016571, gen p mean: -0.4769141674041748, mean p set: 0.4484466016292572
loss_pred:0.03369805961847305, decouple_loss:0.013952841982245445
loss_pred:0.03388506546616554, decouple_loss:0.012608066201210022
2023-05-01 13:57:20 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.4818251132965088, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.47046610713005066, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.4746745228767395, mean p set: 0.4500633478164673
loss_pred:0.03330075368285179, decouple_loss:0.013268760405480862
loss_pred:0.03168777748942375, decouple_loss:0.013160527683794498
loss_pred:0.03230713680386543, decouple_loss:0.012960648164153099
WV_0_PC_1_EH_0_PS_40_15, loss: 0.03308838978409767, avg_mse: 0.03765517473220825
current test mse: 0.037655
Iteration: 861, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470093846321106, gen p mean: -0.47893089056015015, mean p set: 0.4474896788597107
The modified gen p mean: 0.445504754781723, gen p mean: -0.4742014706134796, mean p set: 0.4459850490093231
The modified gen p mean: 0.4461279511451721, gen p mean: -0.47614696621894836, mean p set: 0.4466082453727722
loss_pred:0.033054135739803314, decouple_loss:0.012702533043920994
loss_pred:0.03276770934462547, decouple_loss:0.012861201539635658
loss_pred:0.03320765495300293, decouple_loss:0.012698094360530376
Iteration: 862, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473522901535034, gen p mean: -0.4691220819950104, mean p set: 0.4478325843811035
loss_pred:0.03431563079357147, decouple_loss:0.011906609870493412
The modified gen p mean: 0.4458296597003937, gen p mean: -0.464524507522583, mean p set: 0.4463099241256714The modified gen p mean: 0.44713306427001953, gen p mean: -0.46518343687057495, mean p set: 0.44761335849761963
loss_pred:0.03412903845310211, decouple_loss:0.011985929682850838
loss_pred:0.03496274724602699, decouple_loss:0.011762352660298347
Iteration: 863, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478360712528229, gen p mean: -0.4772828221321106, mean p set: 0.4483163356781006
loss_pred:0.033324241638183594, decouple_loss:0.012529740110039711
The modified gen p mean: 0.44641926884651184, gen p mean: -0.4729113280773163, mean p set: 0.4468995928764343The modified gen p mean: 0.4452609121799469, gen p mean: -0.46771055459976196, mean p set: 0.4457412362098694
loss_pred:0.03312499448657036, decouple_loss:0.012059731408953667
loss_pred:0.03358842805027962, decouple_loss:0.012345128692686558
Iteration: 864, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4456147253513336, gen p mean: -0.4652930498123169, mean p set: 0.44609498977661133
loss_pred:0.03324098140001297, decouple_loss:0.011690115556120872
The modified gen p mean: 0.44740989804267883, gen p mean: -0.4696767032146454, mean p set: 0.44789019227027893The modified gen p mean: 0.4478876292705536, gen p mean: -0.4731316864490509, mean p set: 0.4483678936958313
loss_pred:0.032890573143959045, decouple_loss:0.011582616716623306
loss_pred:0.033046603202819824, decouple_loss:0.011599913239479065
Iteration: 865, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4463559091091156, gen p mean: -0.46874749660491943, mean p set: 0.4468361735343933
loss_pred:0.03337807580828667, decouple_loss:0.011962235905230045
The modified gen p mean: 0.44663065671920776, gen p mean: -0.4666573107242584, mean p set: 0.4471109211444855The modified gen p mean: 0.4460795521736145, gen p mean: -0.4658059775829315, mean p set: 0.4465598464012146
loss_pred:0.033440619707107544, decouple_loss:0.011859957128763199
loss_pred:0.03413943201303482, decouple_loss:0.011866111308336258
Iteration: 866, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44539394974708557, gen p mean: -0.45415547490119934, mean p set: 0.44587424397468567The modified gen p mean: 0.4481044113636017, gen p mean: -0.46276241540908813, mean p set: 0.4485847055912018The modified gen p mean: 0.44718998670578003, gen p mean: -0.4642867147922516, mean p set: 0.4476702809333801
loss_pred:0.033736780285835266, decouple_loss:0.01311355922371149
loss_pred:0.03293284773826599, decouple_loss:0.012484008446335793loss_pred:0.032724227756261826, decouple_loss:0.012152325361967087
Iteration: 867, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.445453941822052, gen p mean: -0.4543182849884033, mean p set: 0.4459342360496521
loss_pred:0.032588593661785126, decouple_loss:0.011516145430505276
The modified gen p mean: 0.4469396471977234, gen p mean: -0.45128557085990906, mean p set: 0.4474199414253235The modified gen p mean: 0.447578489780426, gen p mean: -0.46079009771347046, mean p set: 0.4480588138103485
loss_pred:0.033335354179143906, decouple_loss:0.011868327856063843
loss_pred:0.03424428775906563, decouple_loss:0.012155583128333092
Iteration: 868, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474359452724457, gen p mean: -0.46147802472114563, mean p set: 0.4479162395000458
loss_pred:0.03282933682203293, decouple_loss:0.011315000243484974
The modified gen p mean: 0.44634801149368286, gen p mean: -0.44928786158561707, mean p set: 0.44682827591896057The modified gen p mean: 0.4479689598083496, gen p mean: -0.45445188879966736, mean p set: 0.4484492540359497
loss_pred:0.03315243870019913, decouple_loss:0.011471223086118698
loss_pred:0.032112739980220795, decouple_loss:0.01184378657490015
Iteration: 869, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466160237789154, gen p mean: -0.45118314027786255, mean p set: 0.4470962882041931
loss_pred:0.0345916748046875, decouple_loss:0.011613772250711918
The modified gen p mean: 0.4461621940135956, gen p mean: -0.45478716492652893, mean p set: 0.4466424882411957The modified gen p mean: 0.4489671289920807, gen p mean: -0.461599200963974, mean p set: 0.4494474530220032
loss_pred:0.033621639013290405, decouple_loss:0.011259479448199272
loss_pred:0.032993488013744354, decouple_loss:0.012078325264155865
Iteration: 870, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44757893681526184, gen p mean: -0.4656258821487427, mean p set: 0.44805923104286194
loss_pred:0.03276572376489639, decouple_loss:0.010808867402374744
The modified gen p mean: 0.44683393836021423, gen p mean: -0.45638737082481384, mean p set: 0.44731420278549194The modified gen p mean: 0.44873663783073425, gen p mean: -0.46506166458129883, mean p set: 0.44921690225601196
loss_pred:0.03297458961606026, decouple_loss:0.011250998824834824
loss_pred:0.03249112144112587, decouple_loss:0.011657904833555222
2023-05-01 13:59:15 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.46349474787712097, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.4532439410686493, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.4566025137901306, mean p set: 0.4500633478164673
loss_pred:0.03280198946595192, decouple_loss:0.011834586970508099
loss_pred:0.031179890036582947, decouple_loss:0.011643949896097183
loss_pred:0.031924769282341, decouple_loss:0.011548495851457119
WV_0_PC_1_EH_0_PS_40_15, loss: 0.03255266696214676, avg_mse: 0.03713221475481987
current test mse: 0.037132
Iteration: 871, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4461263120174408, gen p mean: -0.4549959599971771, mean p set: 0.4466065764427185
The modified gen p mean: 0.44770190119743347, gen p mean: -0.4630393981933594, mean p set: 0.44818219542503357
The modified gen p mean: 0.44676896929740906, gen p mean: -0.45658186078071594, mean p set: 0.44724923372268677
loss_pred:0.03326265141367912, decouple_loss:0.011200356297194958
loss_pred:0.032914988696575165, decouple_loss:0.011166762560606003
loss_pred:0.03293009474873543, decouple_loss:0.01112770102918148
Iteration: 872, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44537967443466187, gen p mean: -0.45805269479751587, mean p set: 0.4458599388599396
loss_pred:0.032173510640859604, decouple_loss:0.011715063825249672
The modified gen p mean: 0.44784945249557495, gen p mean: -0.46616265177726746, mean p set: 0.44832971692085266The modified gen p mean: 0.44766369462013245, gen p mean: -0.46601617336273193, mean p set: 0.44814398884773254
loss_pred:0.0321933887898922, decouple_loss:0.011529218405485153
loss_pred:0.03310846537351608, decouple_loss:0.011639272794127464
Iteration: 873, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44708627462387085, gen p mean: -0.46319305896759033, mean p set: 0.44756653904914856
loss_pred:0.0324055552482605, decouple_loss:0.010575187392532825
The modified gen p mean: 0.44742095470428467, gen p mean: -0.4669422209262848, mean p set: 0.4479012191295624The modified gen p mean: 0.4466838240623474, gen p mean: -0.46085023880004883, mean p set: 0.4471641182899475
loss_pred:0.032765697687864304, decouple_loss:0.010942235589027405
loss_pred:0.03369700908660889, decouple_loss:0.01113491877913475
Iteration: 874, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4457213878631592, gen p mean: -0.4606262147426605, mean p set: 0.44620171189308167
loss_pred:0.033996980637311935, decouple_loss:0.010637236759066582
The modified gen p mean: 0.44625091552734375, gen p mean: -0.46667346358299255, mean p set: 0.44673120975494385The modified gen p mean: 0.44587939977645874, gen p mean: -0.461984783411026, mean p set: 0.44635969400405884
loss_pred:0.032833993434906006, decouple_loss:0.01096692681312561
loss_pred:0.03275832533836365, decouple_loss:0.011264952830970287
Iteration: 875, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471026659011841, gen p mean: -0.4665195345878601, mean p set: 0.4475829601287842
loss_pred:0.031754735857248306, decouple_loss:0.011523290537297726
The modified gen p mean: 0.44656720757484436, gen p mean: -0.46418482065200806, mean p set: 0.44704747200012207The modified gen p mean: 0.4458533823490143, gen p mean: -0.459033340215683, mean p set: 0.4463336765766144
loss_pred:0.0330892875790596, decouple_loss:0.011937885545194149
loss_pred:0.03246031329035759, decouple_loss:0.011149960570037365
Iteration: 876, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479115903377533, gen p mean: -0.46654894948005676, mean p set: 0.4483919143676758
loss_pred:0.03221939131617546, decouple_loss:0.012411536648869514
The modified gen p mean: 0.4480862617492676, gen p mean: -0.46321237087249756, mean p set: 0.4485665559768677The modified gen p mean: 0.4462960958480835, gen p mean: -0.45977306365966797, mean p set: 0.4467763900756836
loss_pred:0.033100370317697525, decouple_loss:0.011770295910537243
loss_pred:0.03249533846974373, decouple_loss:0.011213500052690506
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012005_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012005_3_24hr.npz
NaN value num: 0
Iteration: 877, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489072561264038, gen p mean: -0.47070813179016113, mean p set: 0.4493875503540039
loss_pred:0.03378012776374817, decouple_loss:0.01293271780014038
The modified gen p mean: 0.4479368031024933, gen p mean: -0.4709552526473999, mean p set: 0.4484170973300934The modified gen p mean: 0.44840115308761597, gen p mean: -0.4646749198436737, mean p set: 0.44888144731521606
loss_pred:0.03238463029265404, decouple_loss:0.011189444921910763
loss_pred:0.033255647867918015, decouple_loss:0.012535746209323406
Iteration: 878, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447918564081192, gen p mean: -0.468171626329422, mean p set: 0.4483988583087921
loss_pred:0.03300449624657631, decouple_loss:0.01183264423161745
The modified gen p mean: 0.4473685026168823, gen p mean: -0.47163599729537964, mean p set: 0.4478487968444824The modified gen p mean: 0.45032787322998047, gen p mean: -0.46671345829963684, mean p set: 0.45080816745758057
loss_pred:0.03291963040828705, decouple_loss:0.01194091234356165
loss_pred:0.03315286338329315, decouple_loss:0.012276874855160713
Iteration: 879, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44945579767227173, gen p mean: -0.46564003825187683, mean p set: 0.44993606209754944
loss_pred:0.03254830092191696, decouple_loss:0.010507289320230484
The modified gen p mean: 0.4486202001571655, gen p mean: -0.46883606910705566, mean p set: 0.44910046458244324The modified gen p mean: 0.44815149903297424, gen p mean: -0.47263303399086, mean p set: 0.44863176345825195
loss_pred:0.033176761120557785, decouple_loss:0.011625479906797409
loss_pred:0.03329235687851906, decouple_loss:0.011605694890022278
Iteration: 880, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494517743587494, gen p mean: -0.46549075841903687, mean p set: 0.4499320983886719
loss_pred:0.03256664797663689, decouple_loss:0.0110011612996459
The modified gen p mean: 0.4493016302585602, gen p mean: -0.46480464935302734, mean p set: 0.4497818946838379The modified gen p mean: 0.4486227035522461, gen p mean: -0.46880072355270386, mean p set: 0.4491029977798462
loss_pred:0.033780284225940704, decouple_loss:0.010753408074378967
loss_pred:0.03345281630754471, decouple_loss:0.011063255369663239
2023-05-01 14:01:48 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.47148898243904114, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.460921972990036, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.4648143947124481, mean p set: 0.4500633478164673
loss_pred:0.032822031527757645, decouple_loss:0.011649459600448608
loss_pred:0.03133067861199379, decouple_loss:0.012515480630099773
loss_pred:0.03188488259911537, decouple_loss:0.01181624736636877
WV_0_PC_1_EH_0_PS_40_15, loss: 0.03261221945285797, avg_mse: 0.03712654486298561
current test mse: 0.037127
Iteration: 881, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448386013507843, gen p mean: -0.4665333330631256, mean p set: 0.4488662779331207
The modified gen p mean: 0.45045018196105957, gen p mean: -0.47504788637161255, mean p set: 0.4509304463863373
The modified gen p mean: 0.4476453363895416, gen p mean: -0.4675852358341217, mean p set: 0.4481256306171417
loss_pred:0.03270559012889862, decouple_loss:0.011731015518307686
loss_pred:0.0328691229224205, decouple_loss:0.010572406463325024loss_pred:0.0330924428999424, decouple_loss:0.01108815148472786
Iteration: 882, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44841381907463074, gen p mean: -0.46668076515197754, mean p set: 0.4488941431045532
loss_pred:0.03152988478541374, decouple_loss:0.01027227658778429
The modified gen p mean: 0.4498950242996216, gen p mean: -0.4716808795928955, mean p set: 0.4503753185272217The modified gen p mean: 0.4497861862182617, gen p mean: -0.4665488600730896, mean p set: 0.45026645064353943
loss_pred:0.03182990103960037, decouple_loss:0.010728009045124054
loss_pred:0.03182772547006607, decouple_loss:0.010637189261615276
Iteration: 883, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492219388484955, gen p mean: -0.4645942449569702, mean p set: 0.4497022032737732
loss_pred:0.034041400998830795, decouple_loss:0.011601797305047512
The modified gen p mean: 0.44886526465415955, gen p mean: -0.476794570684433, mean p set: 0.44934555888175964The modified gen p mean: 0.45030322670936584, gen p mean: -0.4692268371582031, mean p set: 0.45078352093696594
loss_pred:0.033186156302690506, decouple_loss:0.011910196393728256
loss_pred:0.03245336934924126, decouple_loss:0.01079714484512806
Iteration: 884, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44869494438171387, gen p mean: -0.47430166602134705, mean p set: 0.44917523860931396
loss_pred:0.032350100576877594, decouple_loss:0.011184942908585072
The modified gen p mean: 0.4496042728424072, gen p mean: -0.4640923738479614, mean p set: 0.4500845670700073The modified gen p mean: 0.4484393894672394, gen p mean: -0.4661998748779297, mean p set: 0.4489196836948395
loss_pred:0.031627919524908066, decouple_loss:0.010381798259913921
loss_pred:0.03146582469344139, decouple_loss:0.011009263806045055
Iteration: 885, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495837986469269, gen p mean: -0.4623238146305084, mean p set: 0.450064092874527
loss_pred:0.03255791962146759, decouple_loss:0.010799555107951164
The modified gen p mean: 0.4498195946216583, gen p mean: -0.4688585698604584, mean p set: 0.4502998888492584
The modified gen p mean: 0.4497113525867462, gen p mean: -0.46372708678245544, mean p set: 0.4501916468143463
loss_pred:0.03328336402773857, decouple_loss:0.011003866791725159
loss_pred:0.031651679426431656, decouple_loss:0.01059768907725811
Iteration: 886, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500262141227722, gen p mean: -0.46947547793388367, mean p set: 0.4505065083503723
loss_pred:0.031956907361745834, decouple_loss:0.010499095544219017
The modified gen p mean: 0.4502228796482086, gen p mean: -0.46631503105163574, mean p set: 0.4507031738758087The modified gen p mean: 0.4499596357345581, gen p mean: -0.47214871644973755, mean p set: 0.4504399299621582
loss_pred:0.031473588198423386, decouple_loss:0.010326238349080086
loss_pred:0.03245102986693382, decouple_loss:0.010710345581173897
Iteration: 887, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503535032272339, gen p mean: -0.46982523798942566, mean p set: 0.45083382725715637
loss_pred:0.031978338956832886, decouple_loss:0.010509884916245937
The modified gen p mean: 0.4487926661968231, gen p mean: -0.46602556109428406, mean p set: 0.44927293062210083The modified gen p mean: 0.44749295711517334, gen p mean: -0.47535595297813416, mean p set: 0.44797325134277344
loss_pred:0.032473862171173096, decouple_loss:0.01028276514261961
loss_pred:0.03350529074668884, decouple_loss:0.01162125263363123
Iteration: 888, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486786425113678, gen p mean: -0.4663942754268646, mean p set: 0.4491589367389679
loss_pred:0.0321478396654129, decouple_loss:0.010554392822086811
The modified gen p mean: 0.4487854838371277, gen p mean: -0.46325698494911194, mean p set: 0.4492657780647278The modified gen p mean: 0.4509904682636261, gen p mean: -0.4729629158973694, mean p set: 0.4514707326889038
loss_pred:0.03274038806557655, decouple_loss:0.010322838090360165
loss_pred:0.031760528683662415, decouple_loss:0.010352070443332195
Iteration: 889, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491669237613678, gen p mean: -0.46356433629989624, mean p set: 0.4496472179889679
loss_pred:0.033401403576135635, decouple_loss:0.011224071495234966
The modified gen p mean: 0.44764408469200134, gen p mean: -0.45993122458457947, mean p set: 0.44812440872192383The modified gen p mean: 0.44978076219558716, gen p mean: -0.4587022364139557, mean p set: 0.45026108622550964
loss_pred:0.03179401159286499, decouple_loss:0.011103862896561623
loss_pred:0.033152710646390915, decouple_loss:0.010651884600520134
Iteration: 890, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496310353279114, gen p mean: -0.4574601948261261, mean p set: 0.4501113295555115
loss_pred:0.03188754618167877, decouple_loss:0.010979740880429745
The modified gen p mean: 0.44807255268096924, gen p mean: -0.46091771125793457, mean p set: 0.44855284690856934The modified gen p mean: 0.44896426796913147, gen p mean: -0.4543090760707855, mean p set: 0.44944456219673157
loss_pred:0.032270390540361404, decouple_loss:0.01135148387402296
loss_pred:0.03238048404455185, decouple_loss:0.010632628574967384
2023-05-01 14:03:44 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.4614468216896057, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.4506247639656067, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.4544338583946228, mean p set: 0.4500633478164673
loss_pred:0.0325288362801075, decouple_loss:0.011738886125385761
loss_pred:0.030895231291651726, decouple_loss:0.01227576658129692
loss_pred:0.03153987228870392, decouple_loss:0.011507228948175907
WV_0_PC_1_EH_0_PS_40_15, loss: 0.032246679067611694, avg_mse: 0.036780498921871185
current test mse: 0.03678
Iteration: 891, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487479627132416, gen p mean: -0.45669546723365784, mean p set: 0.4492282271385193
The modified gen p mean: 0.44858092069625854, gen p mean: -0.4672808051109314, mean p set: 0.44906121492385864
The modified gen p mean: 0.4489375054836273, gen p mean: -0.4640504717826843, mean p set: 0.4494177997112274
loss_pred:0.03278262913227081, decouple_loss:0.010617871768772602
loss_pred:0.0329710952937603, decouple_loss:0.011031541973352432loss_pred:0.033612269908189774, decouple_loss:0.011916670016944408
Iteration: 892, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489058256149292, gen p mean: -0.4727376401424408, mean p set: 0.4493860900402069
loss_pred:0.032723814249038696, decouple_loss:0.01176400389522314
The modified gen p mean: 0.4483083486557007, gen p mean: -0.4622652530670166, mean p set: 0.4487886428833008The modified gen p mean: 0.44973480701446533, gen p mean: -0.4594171643257141, mean p set: 0.45021507143974304
loss_pred:0.03223692253232002, decouple_loss:0.010482567362487316
loss_pred:0.03298117220401764, decouple_loss:0.011817478574812412
Iteration: 893, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44799548387527466, gen p mean: -0.46460697054862976, mean p set: 0.44847577810287476
loss_pred:0.03243895620107651, decouple_loss:0.010820127092301846
The modified gen p mean: 0.4490582346916199, gen p mean: -0.45967450737953186, mean p set: 0.44953852891921997The modified gen p mean: 0.448699414730072, gen p mean: -0.4697760045528412, mean p set: 0.4491797089576721
loss_pred:0.03225421905517578, decouple_loss:0.01028247456997633
loss_pred:0.03375138342380524, decouple_loss:0.011110118590295315
Iteration: 894, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44969338178634644, gen p mean: -0.46912622451782227, mean p set: 0.45017367601394653
loss_pred:0.03174155578017235, decouple_loss:0.011053211987018585
The modified gen p mean: 0.4474797248840332, gen p mean: -0.4722643494606018, mean p set: 0.4479599893093109The modified gen p mean: 0.44845178723335266, gen p mean: -0.4670858383178711, mean p set: 0.44893211126327515
loss_pred:0.03255360946059227, decouple_loss:0.011429430916905403
loss_pred:0.03252720087766647, decouple_loss:0.010823491960763931
Iteration: 895, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482744038105011, gen p mean: -0.4567631483078003, mean p set: 0.4487546980381012
loss_pred:0.0317283533513546, decouple_loss:0.010665761306881905
The modified gen p mean: 0.44820016622543335, gen p mean: -0.4537423849105835, mean p set: 0.44868043065071106The modified gen p mean: 0.4480951726436615, gen p mean: -0.4591805338859558, mean p set: 0.448575496673584
loss_pred:0.032173510640859604, decouple_loss:0.010967977344989777
loss_pred:0.03251504898071289, decouple_loss:0.01075818669050932
Iteration: 896, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502216577529907, gen p mean: -0.4581785202026367, mean p set: 0.4507019817829132
loss_pred:0.03177884593605995, decouple_loss:0.011489778757095337
The modified gen p mean: 0.4498697817325592, gen p mean: -0.4557424783706665, mean p set: 0.4503500759601593The modified gen p mean: 0.44796493649482727, gen p mean: -0.4617936313152313, mean p set: 0.44844523072242737
loss_pred:0.03178324177861214, decouple_loss:0.011522231623530388
loss_pred:0.03216195106506348, decouple_loss:0.011667095124721527
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012016_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012016_3_24hr.npz
NaN value num: 0
Iteration: 897, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514380693435669, gen p mean: -0.45920732617378235, mean p set: 0.451918363571167
loss_pred:0.032495465129613876, decouple_loss:0.014582379721105099
The modified gen p mean: 0.45226433873176575, gen p mean: -0.45559224486351013, mean p set: 0.45274466276168823The modified gen p mean: 0.45021769404411316, gen p mean: -0.45554324984550476, mean p set: 0.45069798827171326
loss_pred:0.030520375818014145, decouple_loss:0.014708779752254486
loss_pred:0.03291734308004379, decouple_loss:0.015055942349135876
Iteration: 898, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45070749521255493, gen p mean: -0.4570591151714325, mean p set: 0.45118778944015503
loss_pred:0.03164909407496452, decouple_loss:0.014561292715370655
The modified gen p mean: 0.45111456513404846, gen p mean: -0.4579850435256958, mean p set: 0.45159485936164856
The modified gen p mean: 0.4512234926223755, gen p mean: -0.46121862530708313, mean p set: 0.4517037868499756
loss_pred:0.03345193341374397, decouple_loss:0.015195813030004501
loss_pred:0.030953753739595413, decouple_loss:0.01391594298183918
Iteration: 899, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513789713382721, gen p mean: -0.4506734609603882, mean p set: 0.4518592655658722
loss_pred:0.033367134630680084, decouple_loss:0.013870918191969395
The modified gen p mean: 0.4505658745765686, gen p mean: -0.4625452160835266, mean p set: 0.4510461390018463The modified gen p mean: 0.4506472647190094, gen p mean: -0.45163992047309875, mean p set: 0.4511275291442871
loss_pred:0.03365054726600647, decouple_loss:0.014265629462897778
loss_pred:0.03275149315595627, decouple_loss:0.01421661488711834
Iteration: 900, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45327654480934143, gen p mean: -0.46785369515419006, mean p set: 0.4537568688392639
loss_pred:0.031783849000930786, decouple_loss:0.013474547304213047
The modified gen p mean: 0.4507308602333069, gen p mean: -0.4529685378074646, mean p set: 0.45121118426322937The modified gen p mean: 0.4532153904438019, gen p mean: -0.4638482332229614, mean p set: 0.453695684671402
loss_pred:0.03247741237282753, decouple_loss:0.014515495859086514
loss_pred:0.03123670257627964, decouple_loss:0.01309753954410553
2023-05-01 14:06:19 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.47690141201019287, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.46607059240341187, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.46974748373031616, mean p set: 0.4500633478164673
loss_pred:0.032599955797195435, decouple_loss:0.014999670907855034
loss_pred:0.03089299239218235, decouple_loss:0.015322896651923656
loss_pred:0.031583718955516815, decouple_loss:0.014670640230178833
WV_0_PC_1_EH_0_PS_40_15, loss: 0.032442107796669006, avg_mse: 0.036910004913806915
current test mse: 0.03691
Iteration: 901, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45112621784210205, gen p mean: -0.4706070125102997, mean p set: 0.45160651206970215
The modified gen p mean: 0.45239225029945374, gen p mean: -0.47300195693969727, mean p set: 0.45287254452705383
The modified gen p mean: 0.45174503326416016, gen p mean: -0.4635343551635742, mean p set: 0.45222529768943787
loss_pred:0.033043161034584045, decouple_loss:0.013755656778812408
loss_pred:0.03289616480469704, decouple_loss:0.013138179667294025
loss_pred:0.03267014026641846, decouple_loss:0.014347925782203674
Iteration: 902, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4525368809700012, gen p mean: -0.4780953824520111, mean p set: 0.45301714539527893
loss_pred:0.03299391642212868, decouple_loss:0.013752253726124763
The modified gen p mean: 0.4511788785457611, gen p mean: -0.4784872531890869, mean p set: 0.4516591429710388The modified gen p mean: 0.4502146244049072, gen p mean: -0.47149333357810974, mean p set: 0.4506949186325073
loss_pred:0.03343559429049492, decouple_loss:0.013485551811754704
loss_pred:0.031505271792411804, decouple_loss:0.014367098920047283
Iteration: 903, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511711001396179, gen p mean: -0.48173362016677856, mean p set: 0.45165136456489563
loss_pred:0.03194040432572365, decouple_loss:0.012378742918372154
The modified gen p mean: 0.45160356163978577, gen p mean: -0.4822526276111603, mean p set: 0.4520838260650635The modified gen p mean: 0.4507941007614136, gen p mean: -0.480751097202301, mean p set: 0.45127442479133606
loss_pred:0.03194406256079674, decouple_loss:0.01313552912324667
loss_pred:0.03207259625196457, decouple_loss:0.012811682187020779
Iteration: 904, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45154109597206116, gen p mean: -0.46915167570114136, mean p set: 0.45202142000198364
loss_pred:0.03235273435711861, decouple_loss:0.01253026444464922
The modified gen p mean: 0.45016083121299744, gen p mean: -0.4726833403110504, mean p set: 0.45064112544059753The modified gen p mean: 0.45244091749191284, gen p mean: -0.46886056661605835, mean p set: 0.45292118191719055
loss_pred:0.032586582005023956, decouple_loss:0.01287907361984253
loss_pred:0.03285868838429451, decouple_loss:0.012767636217176914
Iteration: 905, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45161208510398865, gen p mean: -0.4764770269393921, mean p set: 0.45209240913391113
loss_pred:0.031528372317552567, decouple_loss:0.012676733545958996
The modified gen p mean: 0.4514593183994293, gen p mean: -0.4724470376968384, mean p set: 0.45193958282470703The modified gen p mean: 0.450717568397522, gen p mean: -0.4699983596801758, mean p set: 0.45119786262512207
loss_pred:0.031595245003700256, decouple_loss:0.013619871810078621
loss_pred:0.03198372945189476, decouple_loss:0.013117513619363308
Iteration: 906, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45079344511032104, gen p mean: -0.4685326814651489, mean p set: 0.45127376914024353
loss_pred:0.032988596707582474, decouple_loss:0.012244673445820808
The modified gen p mean: 0.4532906711101532, gen p mean: -0.47618621587753296, mean p set: 0.4537709653377533The modified gen p mean: 0.4510784447193146, gen p mean: -0.4768461585044861, mean p set: 0.4515587389469147
loss_pred:0.03199934586882591, decouple_loss:0.012967430986464024
loss_pred:0.031837500631809235, decouple_loss:0.012625676579773426
Iteration: 907, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45175787806510925, gen p mean: -0.47914832830429077, mean p set: 0.45223820209503174
loss_pred:0.03162134438753128, decouple_loss:0.012022729963064194
The modified gen p mean: 0.4538593888282776, gen p mean: -0.4804230034351349, mean p set: 0.4543396830558777The modified gen p mean: 0.4511578679084778, gen p mean: -0.4769724905490875, mean p set: 0.4516381621360779
loss_pred:0.03231626749038696, decouple_loss:0.012276720255613327
loss_pred:0.031645964831113815, decouple_loss:0.012216572649776936
Iteration: 908, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4519716203212738, gen p mean: -0.47343122959136963, mean p set: 0.4524519443511963
loss_pred:0.032938409596681595, decouple_loss:0.013094475492835045
The modified gen p mean: 0.44989460706710815, gen p mean: -0.47931069135665894, mean p set: 0.45037490129470825The modified gen p mean: 0.4534396529197693, gen p mean: -0.4873991906642914, mean p set: 0.4539199471473694
loss_pred:0.03301457315683365, decouple_loss:0.012601296417415142
loss_pred:0.03039461374282837, decouple_loss:0.012356515042483807
Iteration: 909, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4522683322429657, gen p mean: -0.48780861496925354, mean p set: 0.4527485966682434
loss_pred:0.031323447823524475, decouple_loss:0.01277374941855669
The modified gen p mean: 0.452554315328598, gen p mean: -0.4906522333621979, mean p set: 0.4530346095561981The modified gen p mean: 0.45226389169692993, gen p mean: -0.485489159822464, mean p set: 0.45274418592453003
loss_pred:0.031444400548934937, decouple_loss:0.013341518118977547
loss_pred:0.030429668724536896, decouple_loss:0.013198289088904858
Iteration: 910, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45156583189964294, gen p mean: -0.4883682429790497, mean p set: 0.45204612612724304
loss_pred:0.030715378001332283, decouple_loss:0.011733879335224628
The modified gen p mean: 0.4527044892311096, gen p mean: -0.48853790760040283, mean p set: 0.45318475365638733The modified gen p mean: 0.45206692814826965, gen p mean: -0.483867883682251, mean p set: 0.45254722237586975
loss_pred:0.030727088451385498, decouple_loss:0.011941468343138695
loss_pred:0.030123991891741753, decouple_loss:0.01145404763519764
2023-05-01 14:08:13 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.4876711964607239, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.4779171347618103, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.4813528060913086, mean p set: 0.4500633478164673
loss_pred:0.0326751284301281, decouple_loss:0.013934975489974022
loss_pred:0.031135445460677147, decouple_loss:0.01360701210796833
loss_pred:0.031890299171209335, decouple_loss:0.013483166694641113
WV_0_PC_1_EH_0_PS_40_15, loss: 0.032584048807621, avg_mse: 0.03738611936569214
current test mse: 0.037386
Iteration: 911, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511440396308899, gen p mean: -0.4854344427585602, mean p set: 0.45162433385849
The modified gen p mean: 0.4539720416069031, gen p mean: -0.4842722713947296, mean p set: 0.45445236563682556
The modified gen p mean: 0.45160067081451416, gen p mean: -0.47236257791519165, mean p set: 0.45208099484443665
loss_pred:0.03231988102197647, decouple_loss:0.012464302591979504
loss_pred:0.03320147842168808, decouple_loss:0.013277375139296055
loss_pred:0.03134959563612938, decouple_loss:0.011585082858800888
Iteration: 912, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4506746828556061, gen p mean: -0.47349464893341064, mean p set: 0.4511549472808838
loss_pred:0.032071683555841446, decouple_loss:0.012803127989172935
The modified gen p mean: 0.45201635360717773, gen p mean: -0.46720656752586365, mean p set: 0.4524966776371002The modified gen p mean: 0.4505062401294708, gen p mean: -0.47491246461868286, mean p set: 0.45098650455474854
loss_pred:0.03288523480296135, decouple_loss:0.013054583221673965
loss_pred:0.03025413118302822, decouple_loss:0.011845585890114307
Iteration: 913, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45178738236427307, gen p mean: -0.4802892506122589, mean p set: 0.45226770639419556
loss_pred:0.03066391311585903, decouple_loss:0.011839422397315502
The modified gen p mean: 0.4514394998550415, gen p mean: -0.4705883860588074, mean p set: 0.4519197940826416The modified gen p mean: 0.4512425363063812, gen p mean: -0.48238077759742737, mean p set: 0.4517228305339813
loss_pred:0.03157636150717735, decouple_loss:0.012439708225429058
loss_pred:0.03216962516307831, decouple_loss:0.013021386228501797
Iteration: 914, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514193832874298, gen p mean: -0.46684202551841736, mean p set: 0.4518997073173523
loss_pred:0.03277359902858734, decouple_loss:0.012191074900329113
The modified gen p mean: 0.4514700770378113, gen p mean: -0.4749586582183838, mean p set: 0.45195040106773376The modified gen p mean: 0.45204421877861023, gen p mean: -0.475437730550766, mean p set: 0.4525245428085327
loss_pred:0.030970236286520958, decouple_loss:0.012512425892055035
loss_pred:0.030477281659841537, decouple_loss:0.01224583201110363
Iteration: 915, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4506504237651825, gen p mean: -0.47800329327583313, mean p set: 0.4511306881904602
loss_pred:0.031104080379009247, decouple_loss:0.011614996939897537
The modified gen p mean: 0.4513148069381714, gen p mean: -0.4769560396671295, mean p set: 0.4517951011657715The modified gen p mean: 0.4522475302219391, gen p mean: -0.4705200493335724, mean p set: 0.4527277946472168
loss_pred:0.033271558582782745, decouple_loss:0.013062468729913235
loss_pred:0.0324818380177021, decouple_loss:0.012205236591398716
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012008_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012008_3_24hr.npz
NaN value num: 0
Iteration: 916, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44690242409706116, gen p mean: -0.4815554916858673, mean p set: 0.44738268852233887
loss_pred:0.03209357336163521, decouple_loss:0.013513937592506409
The modified gen p mean: 0.4468684494495392, gen p mean: -0.4947130084037781, mean p set: 0.4473487436771393The modified gen p mean: 0.449349045753479, gen p mean: -0.47878333926200867, mean p set: 0.4498293101787567
loss_pred:0.032117001712322235, decouple_loss:0.014080365188419819
loss_pred:0.03119558095932007, decouple_loss:0.013047442771494389
Iteration: 917, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44977763295173645, gen p mean: -0.48131969571113586, mean p set: 0.45025789737701416
loss_pred:0.031217139214277267, decouple_loss:0.013267440721392632
The modified gen p mean: 0.44713106751441956, gen p mean: -0.48570558428764343, mean p set: 0.44761136174201965The modified gen p mean: 0.4469769597053528, gen p mean: -0.4795669615268707, mean p set: 0.4474572539329529
loss_pred:0.030674656853079796, decouple_loss:0.013290942646563053
loss_pred:0.03137057647109032, decouple_loss:0.013466570526361465
Iteration: 918, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448159396648407, gen p mean: -0.48018044233322144, mean p set: 0.4486396908760071
The modified gen p mean: 0.44751372933387756, gen p mean: -0.48475587368011475, mean p set: 0.4479939937591553
loss_pred:0.031809043139219284, decouple_loss:0.01265927404165268
loss_pred:0.03157687932252884, decouple_loss:0.01246638223528862
The modified gen p mean: 0.44778189063072205, gen p mean: -0.47914645075798035, mean p set: 0.44826218485832214
loss_pred:0.03113572485744953, decouple_loss:0.012795007787644863
Iteration: 919, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489873945713043, gen p mean: -0.4772546589374542, mean p set: 0.4494676887989044
loss_pred:0.031387604773044586, decouple_loss:0.012516751885414124
The modified gen p mean: 0.4482094943523407, gen p mean: -0.48302173614501953, mean p set: 0.4486897885799408The modified gen p mean: 0.44826120138168335, gen p mean: -0.4773056209087372, mean p set: 0.44874149560928345
loss_pred:0.031247127801179886, decouple_loss:0.011818398721516132
loss_pred:0.030010603368282318, decouple_loss:0.011936943046748638
Iteration: 920, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446683794260025, gen p mean: -0.48524898290634155, mean p set: 0.44716405868530273
loss_pred:0.0306097399443388, decouple_loss:0.012017608620226383
The modified gen p mean: 0.44851401448249817, gen p mean: -0.47973525524139404, mean p set: 0.4489942789077759The modified gen p mean: 0.4473857879638672, gen p mean: -0.48162025213241577, mean p set: 0.4478660821914673
loss_pred:0.030984796583652496, decouple_loss:0.012322938069701195
loss_pred:0.03137221187353134, decouple_loss:0.012102475389838219
2023-05-01 14:10:48 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.490279883146286, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.4804028272628784, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.48353302478790283, mean p set: 0.4500633478164673
loss_pred:0.032406363636255264, decouple_loss:0.012719057500362396
loss_pred:0.030840672552585602, decouple_loss:0.011992722749710083
loss_pred:0.03151072934269905, decouple_loss:0.012034193612635136
WV_0_PC_1_EH_0_PS_40_15, loss: 0.032198354601860046, avg_mse: 0.03700825572013855
current test mse: 0.037008
Iteration: 921, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44726985692977905, gen p mean: -0.47889244556427, mean p set: 0.4477500915527344
The modified gen p mean: 0.4483543634414673, gen p mean: -0.4795548617839813, mean p set: 0.4488346576690674
The modified gen p mean: 0.4477499723434448, gen p mean: -0.4765027165412903, mean p set: 0.4482302665710449
loss_pred:0.030338870361447334, decouple_loss:0.012190256267786026
loss_pred:0.03181503713130951, decouple_loss:0.011625578626990318
loss_pred:0.031396910548210144, decouple_loss:0.012293868698179722
Iteration: 922, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44797995686531067, gen p mean: -0.47738149762153625, mean p set: 0.44846025109291077
loss_pred:0.029994569718837738, decouple_loss:0.012380452826619148
The modified gen p mean: 0.4467870593070984, gen p mean: -0.4880196154117584, mean p set: 0.4472673535346985The modified gen p mean: 0.4479721784591675, gen p mean: -0.48334428668022156, mean p set: 0.4484524726867676
loss_pred:0.031172607094049454, decouple_loss:0.012163500301539898
loss_pred:0.031550128012895584, decouple_loss:0.012368757277727127
Iteration: 923, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44781965017318726, gen p mean: -0.48066896200180054, mean p set: 0.44829997420310974
loss_pred:0.03153565153479576, decouple_loss:0.011751607991755009
The modified gen p mean: 0.44779497385025024, gen p mean: -0.47634509205818176, mean p set: 0.44827526807785034The modified gen p mean: 0.44917911291122437, gen p mean: -0.4790404140949249, mean p set: 0.4496593773365021
loss_pred:0.03085559606552124, decouple_loss:0.011765537783503532
loss_pred:0.03144111856818199, decouple_loss:0.011499780230224133
Iteration: 924, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479871988296509, gen p mean: -0.4718475639820099, mean p set: 0.44846752285957336
loss_pred:0.03010719083249569, decouple_loss:0.011822589673101902
The modified gen p mean: 0.44692468643188477, gen p mean: -0.4734586179256439, mean p set: 0.44740498065948486The modified gen p mean: 0.447916179895401, gen p mean: -0.4710918068885803, mean p set: 0.4483965039253235
loss_pred:0.030584752559661865, decouple_loss:0.011308550834655762
loss_pred:0.03093940205872059, decouple_loss:0.011859730817377567
Iteration: 925, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44948098063468933, gen p mean: -0.4621277451515198, mean p set: 0.4499613046646118
loss_pred:0.031086493283510208, decouple_loss:0.01280798390507698
The modified gen p mean: 0.4486221671104431, gen p mean: -0.4626014530658722, mean p set: 0.4491024613380432The modified gen p mean: 0.4466054141521454, gen p mean: -0.46468156576156616, mean p set: 0.4470857083797455
loss_pred:0.03228185325860977, decouple_loss:0.012369632720947266
loss_pred:0.030299272388219833, decouple_loss:0.012003353796899319
Iteration: 926, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44767674803733826, gen p mean: -0.4736618101596832, mean p set: 0.44815701246261597
loss_pred:0.031474754214286804, decouple_loss:0.011832398362457752
The modified gen p mean: 0.44811391830444336, gen p mean: -0.4694206416606903, mean p set: 0.44859424233436584
The modified gen p mean: 0.44645360112190247, gen p mean: -0.47417038679122925, mean p set: 0.44693389534950256
loss_pred:0.03197135031223297, decouple_loss:0.01144819799810648
loss_pred:0.03073657676577568, decouple_loss:0.011605252511799335
Iteration: 927, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479027986526489, gen p mean: -0.48419374227523804, mean p set: 0.4483831226825714
loss_pred:0.03073694184422493, decouple_loss:0.011580020189285278
The modified gen p mean: 0.44802582263946533, gen p mean: -0.48165202140808105, mean p set: 0.44850608706474304The modified gen p mean: 0.44643887877464294, gen p mean: -0.4925256669521332, mean p set: 0.44691917300224304
loss_pred:0.03176809102296829, decouple_loss:0.012005154974758625
loss_pred:0.02957412786781788, decouple_loss:0.011690176092088223
Iteration: 928, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477563798427582, gen p mean: -0.48429983854293823, mean p set: 0.4482366442680359
loss_pred:0.03021414205431938, decouple_loss:0.011526358313858509
The modified gen p mean: 0.44857507944107056, gen p mean: -0.4996601939201355, mean p set: 0.44905540347099304The modified gen p mean: 0.4475749433040619, gen p mean: -0.4827422797679901, mean p set: 0.4480552673339844
loss_pred:0.03178515285253525, decouple_loss:0.012154694646596909
loss_pred:0.031008904799818993, decouple_loss:0.010870355181396008
Iteration: 929, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479478597640991, gen p mean: -0.4744618535041809, mean p set: 0.4484281837940216
loss_pred:0.03218240663409233, decouple_loss:0.01168957632035017
The modified gen p mean: 0.44762831926345825, gen p mean: -0.4686529040336609, mean p set: 0.44810861349105835The modified gen p mean: 0.44687360525131226, gen p mean: -0.474098801612854, mean p set: 0.44735386967658997
loss_pred:0.03084540367126465, decouple_loss:0.010884139686822891
loss_pred:0.032013241201639175, decouple_loss:0.011666684411466122
Iteration: 930, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44765833020210266, gen p mean: -0.46052274107933044, mean p set: 0.44813862442970276
loss_pred:0.03186890110373497, decouple_loss:0.011483972892165184
The modified gen p mean: 0.44743579626083374, gen p mean: -0.4638686776161194, mean p set: 0.44791606068611145The modified gen p mean: 0.44793081283569336, gen p mean: -0.4628221392631531, mean p set: 0.44841110706329346
loss_pred:0.031742244958877563, decouple_loss:0.011364489793777466
loss_pred:0.032415397465229034, decouple_loss:0.01128664892166853
2023-05-01 14:12:43 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.47101011872291565, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.4609202444553375, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.4639635980129242, mean p set: 0.4500633478164673
loss_pred:0.031988102942705154, decouple_loss:0.011987484060227871
loss_pred:0.03052174113690853, decouple_loss:0.011768513359129429
loss_pred:0.030977504327893257, decouple_loss:0.011594383046030998
WV_0_PC_1_EH_0_PS_40_15, loss: 0.03175162523984909, avg_mse: 0.03633038327097893
current test mse: 0.03633
Iteration: 931, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476199746131897, gen p mean: -0.47408971190452576, mean p set: 0.4481002688407898
The modified gen p mean: 0.4472668766975403, gen p mean: -0.4643111526966095, mean p set: 0.447747141122818
The modified gen p mean: 0.44847428798675537, gen p mean: -0.4589720666408539, mean p set: 0.44895458221435547
loss_pred:0.03065955638885498, decouple_loss:0.011458436027169228
loss_pred:0.031182516366243362, decouple_loss:0.011876198463141918
loss_pred:0.030140744522213936, decouple_loss:0.011020401492714882
Iteration: 932, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471588730812073, gen p mean: -0.46798577904701233, mean p set: 0.4476391673088074
loss_pred:0.030761653557419777, decouple_loss:0.011263116262853146
The modified gen p mean: 0.44804447889328003, gen p mean: -0.46198660135269165, mean p set: 0.4485248327255249The modified gen p mean: 0.4483235776424408, gen p mean: -0.4656723439693451, mean p set: 0.4488039016723633
loss_pred:0.02939661592245102, decouple_loss:0.011329716071486473
loss_pred:0.03032211773097515, decouple_loss:0.01131391990929842
Iteration: 933, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44810476899147034, gen p mean: -0.4698444902896881, mean p set: 0.4485850930213928
loss_pred:0.029296763241291046, decouple_loss:0.011676577851176262
The modified gen p mean: 0.4483950734138489, gen p mean: -0.4692404866218567, mean p set: 0.448875367641449The modified gen p mean: 0.44900399446487427, gen p mean: -0.4707960784435272, mean p set: 0.449484258890152
loss_pred:0.03086189366877079, decouple_loss:0.012236122973263264
loss_pred:0.030680732801556587, decouple_loss:0.011409412138164043
Iteration: 934, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469151496887207, gen p mean: -0.47019457817077637, mean p set: 0.4473954439163208
loss_pred:0.03176756203174591, decouple_loss:0.011640934273600578
The modified gen p mean: 0.4484352469444275, gen p mean: -0.4657237231731415, mean p set: 0.4489155113697052The modified gen p mean: 0.4472024142742157, gen p mean: -0.46851518750190735, mean p set: 0.4476827085018158
loss_pred:0.0307234525680542, decouple_loss:0.011456163600087166
loss_pred:0.030888594686985016, decouple_loss:0.011460437439382076
Iteration: 935, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473644196987152, gen p mean: -0.46597832441329956, mean p set: 0.4478446841239929
loss_pred:0.031259264796972275, decouple_loss:0.011255730874836445
The modified gen p mean: 0.44617441296577454, gen p mean: -0.46732190251350403, mean p set: 0.44665467739105225The modified gen p mean: 0.44828876852989197, gen p mean: -0.4617325961589813, mean p set: 0.44876906275749207
loss_pred:0.03142911568284035, decouple_loss:0.011675568297505379
loss_pred:0.02977112866938114, decouple_loss:0.010571676306426525
Traceback (most recent call last):
  File "/work/09012/haoli1/ls6/ERA5_PredRNN/predrnn-pytorch/run1.py", line 345, in <module>
    train_wrapper(model)
  File "/work/09012/haoli1/ls6/ERA5_PredRNN/predrnn-pytorch/run1.py", line 259, in train_wrapper
    train_input_handle = datasets_factory.data_provider(
  File "/work/09012/haoli1/ls6/ERA5_PredRNN/predrnn-pytorch/core/data_provider/datasets_factory.py", line 48, in data_provider
    train_input_handle = datasets_map[dataset_name].InputHandle(train_input_param)
  File "/work/09012/haoli1/ls6/ERA5_PredRNN/predrnn-pytorch/core/data_provider/mnist_new.py", line 26, in __init__
    self.load()
  File "/work/09012/haoli1/ls6/ERA5_PredRNN/predrnn-pytorch/core/data_provider/mnist_new.py", line 31, in load
    self.data['clips'] = dat_1['clips']
  File "/work/09012/haoli1/ls6/Pyt/lib/python3.9/site-packages/numpy/lib/npyio.py", line 260, in __getitem__
    raise KeyError("%s is not a file in the archive" % key)
KeyError: 'clips is not a file in the archive'
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012004_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012004_3_24hr.npz