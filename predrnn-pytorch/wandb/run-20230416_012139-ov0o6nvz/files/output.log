After initialize model, args.img_channel:3
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012000_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012001_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012002_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012003_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012004_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012005_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012006_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012007_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012008_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012009_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012010_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012011_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012012_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012013_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012014_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012015_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012016_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012017_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012018_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012019_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012020_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012000_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012001_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012002_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012003_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012004_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012005_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012006_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012007_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012008_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012009_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012010_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012011_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012012_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012013_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012014_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012015_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012016_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012017_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012018_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012019_3_24hr.npz
train_data_files nums: 41
mnist test iterator, Loading data from /scratch/09012/haoli1/ERA5/val_dataset/era5_train_09012020_3_24hr.npz
NaN value num: 0
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012009_3_24hr.npz
NaN value num: 0
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44861435890197754
loss_pred:0.1633058488368988, decouple_loss:0.08489112555980682
The generated pressure mean: 0.4454862177371979
loss_pred:0.17054595053195953, decouple_loss:0.08668137341737747
The generated pressure mean: 0.4483109414577484
loss_pred:0.16152308881282806, decouple_loss:0.08452645689249039
/work/09012/haoli1/ls6/Pyt/lib/python3.9/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '
Iteration: 2, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44784674048423767
loss_pred:0.18754039704799652, decouple_loss:0.5569418668746948
The generated pressure mean: 0.4493890106678009
loss_pred:0.18789827823638916, decouple_loss:0.5577476620674133
The generated pressure mean: 0.446424663066864
loss_pred:0.194611057639122, decouple_loss:0.5544729828834534
Iteration: 3, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4471396207809448
loss_pred:0.18109068274497986, decouple_loss:0.7303223013877869
The generated pressure mean: 0.4476068913936615
loss_pred:0.17358575761318207, decouple_loss:0.7303900122642517
The generated pressure mean: 0.44982993602752686
loss_pred:0.17392927408218384, decouple_loss:0.7300083637237549
Iteration: 4, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4473932087421417
loss_pred:0.16836269199848175, decouple_loss:0.5942202210426331
The generated pressure mean: 0.44719719886779785
loss_pred:0.1714988350868225, decouple_loss:0.5971053838729858
The generated pressure mean: 0.44749554991722107
loss_pred:0.1637185961008072, decouple_loss:0.5969724059104919
Iteration: 5, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44852012395858765
The generated pressure mean: 0.44623613357543945
loss_pred:0.14156505465507507, decouple_loss:0.7345033884048462
loss_pred:0.14852629601955414, decouple_loss:0.7238220572471619
The generated pressure mean: 0.4480317533016205
loss_pred:0.1395689845085144, decouple_loss:0.7375715374946594
Iteration: 6, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4473239481449127
The generated pressure mean: 0.44727686047554016
loss_pred:0.13021336495876312, decouple_loss:0.7142844796180725
loss_pred:0.1313871145248413, decouple_loss:0.716793954372406
The generated pressure mean: 0.4471273422241211
loss_pred:0.13268500566482544, decouple_loss:0.7181825041770935
Iteration: 7, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4461553692817688
The generated pressure mean: 0.44803327322006226
loss_pred:0.12690263986587524, decouple_loss:0.6166837811470032
loss_pred:0.12051306664943695, decouple_loss:0.6190518140792847
The generated pressure mean: 0.4476727545261383
loss_pred:0.1237015426158905, decouple_loss:0.6230810880661011
Iteration: 8, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44608765840530396
The generated pressure mean: 0.44821038842201233
loss_pred:0.11917851865291595, decouple_loss:0.507011353969574
loss_pred:0.11654409021139145, decouple_loss:0.5046585202217102
The generated pressure mean: 0.44760459661483765
loss_pred:0.11751450598239899, decouple_loss:0.5030122399330139
Iteration: 9, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4461471736431122
The generated pressure mean: 0.4470822811126709
loss_pred:0.11233922839164734, decouple_loss:0.4665287435054779
loss_pred:0.11178470402956009, decouple_loss:0.486634224653244
The generated pressure mean: 0.44688740372657776
loss_pred:0.10922426730394363, decouple_loss:0.4644726812839508
Iteration: 10, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44679686427116394
The generated pressure mean: 0.44741398096084595
loss_pred:0.10645416378974915, decouple_loss:0.5447716116905212
loss_pred:0.10298337787389755, decouple_loss:0.5505163073539734
The generated pressure mean: 0.4483204185962677
loss_pred:0.10311175137758255, decouple_loss:0.5505523681640625
2023-04-16 01:24:47 testing...
The generated pressure mean: 0.4497888684272766
The generated pressure mean: 0.4495830833911896
The generated pressure mean: 0.44987666606903076
loss_pred:0.10190033167600632, decouple_loss:0.46967193484306335
loss_pred:0.10163368284702301, decouple_loss:0.46617117524147034
loss_pred:0.10241762548685074, decouple_loss:0.46620607376098633
Loss: 0.12535136938095093, avg_mse: 0.10189898312091827
current test mse: 0.101899
Iteration: 11, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44778165221214294
The generated pressure mean: 0.4480183720588684
loss_pred:0.09973829239606857, decouple_loss:0.46835091710090637
loss_pred:0.09990133345127106, decouple_loss:0.46905452013015747
The generated pressure mean: 0.44779470562934875
loss_pred:0.09875155240297318, decouple_loss:0.4714334309101105
Iteration: 12, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44661808013916016
loss_pred:0.09791802614927292, decouple_loss:0.4231007993221283
The generated pressure mean: 0.4475298225879669
loss_pred:0.09682373702526093, decouple_loss:0.41893693804740906
The generated pressure mean: 0.44909849762916565
loss_pred:0.09622921049594879, decouple_loss:0.41908299922943115
Iteration: 13, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4476143717765808
loss_pred:0.09353800117969513, decouple_loss:0.45642295479774475
The generated pressure mean: 0.44773584604263306
loss_pred:0.08980023115873337, decouple_loss:0.4517858326435089
The generated pressure mean: 0.44854751229286194
loss_pred:0.09205088764429092, decouple_loss:0.44821229577064514
Iteration: 14, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4485139846801758
loss_pred:0.09053301066160202, decouple_loss:0.4289501905441284
The generated pressure mean: 0.44753408432006836
loss_pred:0.08851144462823868, decouple_loss:0.4277978241443634
The generated pressure mean: 0.4471665322780609
loss_pred:0.0872374027967453, decouple_loss:0.42632776498794556
Iteration: 15, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4487040936946869
loss_pred:0.08967478573322296, decouple_loss:0.3991393446922302
The generated pressure mean: 0.4468082785606384
loss_pred:0.08732745796442032, decouple_loss:0.3978205621242523
The generated pressure mean: 0.44930770993232727
loss_pred:0.08982404321432114, decouple_loss:0.39812126755714417
Iteration: 16, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4487951695919037
loss_pred:0.08509230613708496, decouple_loss:0.3538399934768677
The generated pressure mean: 0.44692885875701904
loss_pred:0.08959265798330307, decouple_loss:0.3524850010871887
The generated pressure mean: 0.4478175938129425
loss_pred:0.08401244133710861, decouple_loss:0.3555395007133484
Iteration: 17, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4483659267425537
loss_pred:0.08600534498691559, decouple_loss:0.3177827298641205
The generated pressure mean: 0.4478420615196228
loss_pred:0.08419779688119888, decouple_loss:0.31422337889671326
The generated pressure mean: 0.4469814896583557
loss_pred:0.08551634103059769, decouple_loss:0.3149760067462921
Iteration: 18, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44736161828041077
loss_pred:0.08565841615200043, decouple_loss:0.29595738649368286
The generated pressure mean: 0.4474327564239502
loss_pred:0.08618959039449692, decouple_loss:0.2947095036506653
The generated pressure mean: 0.44727861881256104
loss_pred:0.08453349769115448, decouple_loss:0.2976713478565216
Iteration: 19, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4468348026275635
loss_pred:0.08273056149482727, decouple_loss:0.26446881890296936
The generated pressure mean: 0.4461551308631897
loss_pred:0.08664071559906006, decouple_loss:0.2623840272426605
The generated pressure mean: 0.4483940899372101
loss_pred:0.08432983607053757, decouple_loss:0.26383498311042786
Iteration: 20, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44697925448417664
loss_pred:0.08661047369241714, decouple_loss:0.2521912753582001
The generated pressure mean: 0.4472886323928833
loss_pred:0.08523868769407272, decouple_loss:0.2541637420654297
The generated pressure mean: 0.4494333267211914
loss_pred:0.0835246741771698, decouple_loss:0.25884172320365906

2023-04-16 01:26:40 testing...
The generated pressure mean: 0.4495830833911896
The generated pressure mean: 0.449788898229599
The generated pressure mean: 0.44987666606903076
loss_pred:0.08455570787191391, decouple_loss:0.23197798430919647
loss_pred:0.08524852246046066, decouple_loss:0.23094965517520905
loss_pred:0.08570041507482529, decouple_loss:0.23037508130073547
Loss: 0.09672325849533081, avg_mse: 0.08464223146438599
current test mse: 0.084642
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012019_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012019_3_24hr.npz
NaN value num: 0
Iteration: 21, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4480297267436981
loss_pred:0.08955084532499313, decouple_loss:0.23190736770629883
The generated pressure mean: 0.4506630301475525
The generated pressure mean: 0.4503858983516693
loss_pred:0.08611999452114105, decouple_loss:0.23098644614219666
loss_pred:0.08326324820518494, decouple_loss:0.23100292682647705
Iteration: 22, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44901031255722046
The generated pressure mean: 0.4476586580276489
loss_pred:0.0858854353427887, decouple_loss:0.22399021685123444
loss_pred:0.08627130091190338, decouple_loss:0.2216244488954544
The generated pressure mean: 0.4490286111831665
loss_pred:0.0856865793466568, decouple_loss:0.22075554728507996
Iteration: 23, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44858768582344055
The generated pressure mean: 0.4501242935657501
loss_pred:0.08607766032218933, decouple_loss:0.20296916365623474
loss_pred:0.08401229232549667, decouple_loss:0.20463363826274872
The generated pressure mean: 0.44860759377479553
loss_pred:0.08585304766893387, decouple_loss:0.20418862998485565
Iteration: 24, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45011022686958313
loss_pred:0.0830010175704956, decouple_loss:0.19099324941635132
The generated pressure mean: 0.4489181935787201
loss_pred:0.08574047684669495, decouple_loss:0.18982595205307007
The generated pressure mean: 0.44969239830970764
loss_pred:0.08473340421915054, decouple_loss:0.1904507875442505
Iteration: 25, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4494338631629944
loss_pred:0.08362508565187454, decouple_loss:0.17961274087429047
The generated pressure mean: 0.4498368203639984
loss_pred:0.08558036386966705, decouple_loss:0.17855145037174225
The generated pressure mean: 0.449203222990036
loss_pred:0.08598621934652328, decouple_loss:0.17770734429359436
Iteration: 26, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44797298312187195
The generated pressure mean: 0.4502295255661011
loss_pred:0.08448749780654907, decouple_loss:0.1671794205904007
loss_pred:0.08220118284225464, decouple_loss:0.16785527765750885
The generated pressure mean: 0.4488588273525238
loss_pred:0.08128459751605988, decouple_loss:0.1666800081729889
Iteration: 27, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4492860734462738
The generated pressure mean: 0.450296014547348
loss_pred:0.08368310332298279, decouple_loss:0.15713128447532654
loss_pred:0.08172070980072021, decouple_loss:0.15517303347587585
The generated pressure mean: 0.44863173365592957
loss_pred:0.08425138145685196, decouple_loss:0.15879851579666138
Iteration: 28, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4493621587753296
loss_pred:0.08574851602315903, decouple_loss:0.14835131168365479
The generated pressure mean: 0.4491962790489197
loss_pred:0.0815778523683548, decouple_loss:0.14674708247184753
The generated pressure mean: 0.4492380619049072
loss_pred:0.08395000547170639, decouple_loss:0.14708445966243744
Iteration: 29, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44977980852127075
loss_pred:0.0829087346792221, decouple_loss:0.139272540807724
The generated pressure mean: 0.44965624809265137
loss_pred:0.08404923230409622, decouple_loss:0.13989773392677307
The generated pressure mean: 0.4492708742618561
loss_pred:0.08352170884609222, decouple_loss:0.1404852718114853
Iteration: 30, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44919705390930176
loss_pred:0.08518346399068832, decouple_loss:0.13364310562610626
The generated pressure mean: 0.44886115193367004
loss_pred:0.08134130388498306, decouple_loss:0.13362042605876923
The generated pressure mean: 0.4500710964202881
loss_pred:0.08126722276210785, decouple_loss:0.13119778037071228
2023-04-16 01:29:07 testing...
The generated pressure mean: 0.4495830535888672
The generated pressure mean: 0.4497888684272766
The generated pressure mean: 0.44987666606903076
loss_pred:0.08165232092142105, decouple_loss:0.12456812709569931
loss_pred:0.08075132220983505, decouple_loss:0.12495752424001694
loss_pred:0.0818910151720047, decouple_loss:0.12405719608068466
Loss: 0.08765794336795807, avg_mse: 0.0807998776435852
current test mse: 0.0808
Iteration: 31, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44851312041282654
loss_pred:0.08408113569021225, decouple_loss:0.125843808054924
The generated pressure mean: 0.4505859315395355
loss_pred:0.08167179673910141, decouple_loss:0.1261080503463745
The generated pressure mean: 0.4483937621116638
loss_pred:0.08007141202688217, decouple_loss:0.12481088191270828
Iteration: 32, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4487408697605133
loss_pred:0.08664444833993912, decouple_loss:0.12080629169940948
The generated pressure mean: 0.4508246183395386
loss_pred:0.08089601993560791, decouple_loss:0.11984934657812119
The generated pressure mean: 0.44803234934806824
loss_pred:0.08194507658481598, decouple_loss:0.11929982155561447
Iteration: 33, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44926688075065613
loss_pred:0.08101261407136917, decouple_loss:0.11451750248670578
The generated pressure mean: 0.4496931731700897
loss_pred:0.0827200636267662, decouple_loss:0.1156439557671547
The generated pressure mean: 0.45090633630752563
loss_pred:0.08072611689567566, decouple_loss:0.1156691387295723
Iteration: 34, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4494743347167969
loss_pred:0.08041635155677795, decouple_loss:0.1098555475473404
The generated pressure mean: 0.4501873850822449
loss_pred:0.07988623529672623, decouple_loss:0.10870438069105148
The generated pressure mean: 0.4492749869823456
loss_pred:0.07973940670490265, decouple_loss:0.10896526277065277
Iteration: 35, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44965094327926636
loss_pred:0.07937062531709671, decouple_loss:0.1029881089925766
The generated pressure mean: 0.4480578303337097
loss_pred:0.0814153254032135, decouple_loss:0.1043994277715683
The generated pressure mean: 0.44837287068367004
loss_pred:0.08064185827970505, decouple_loss:0.10222775489091873
Iteration: 36, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4496731758117676
loss_pred:0.08090341091156006, decouple_loss:0.09740611165761948
The generated pressure mean: 0.44948598742485046
loss_pred:0.08311523497104645, decouple_loss:0.09798462688922882
The generated pressure mean: 0.4500035047531128
loss_pred:0.07966185361146927, decouple_loss:0.09660199284553528
Iteration: 37, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44893956184387207
loss_pred:0.07895027846097946, decouple_loss:0.09348597377538681
The generated pressure mean: 0.44911807775497437
loss_pred:0.0786590650677681, decouple_loss:0.09205353260040283
The generated pressure mean: 0.449287086725235
loss_pred:0.08029218763113022, decouple_loss:0.09244228899478912
Iteration: 38, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4497874081134796
loss_pred:0.08159942924976349, decouple_loss:0.09067744016647339
The generated pressure mean: 0.44903796911239624
loss_pred:0.08340509235858917, decouple_loss:0.0897882953286171
The generated pressure mean: 0.4491843283176422
loss_pred:0.07937002182006836, decouple_loss:0.09091752022504807
Iteration: 39, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4484655559062958
loss_pred:0.08430225402116776, decouple_loss:0.08653410524129868
The generated pressure mean: 0.44836920499801636
loss_pred:0.08157441765069962, decouple_loss:0.08682549744844437
The generated pressure mean: 0.45080986618995667
loss_pred:0.08022349327802658, decouple_loss:0.08681664615869522
Iteration: 40, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44822654128074646
loss_pred:0.08019472658634186, decouple_loss:0.08307677507400513
The generated pressure mean: 0.4488268494606018
loss_pred:0.07866471260786057, decouple_loss:0.08343520015478134
The generated pressure mean: 0.4501386880874634
loss_pred:0.07814400643110275, decouple_loss:0.08280278742313385
2023-04-16 01:31:01 testing...
The generated pressure mean: 0.4497888684272766The generated pressure mean: 0.4495830833911896
The generated pressure mean: 0.44987666606903076
loss_pred:0.07798057049512863, decouple_loss:0.0795300230383873
loss_pred:0.0789802223443985, decouple_loss:0.07915642857551575
loss_pred:0.07893135398626328, decouple_loss:0.07925192266702652
Loss: 0.08259636163711548, avg_mse: 0.07826289534568787
current test mse: 0.078263
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012001_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012001_3_24hr.npz
NaN value num: 0
Iteration: 41, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44879618287086487
loss_pred:0.07958956062793732, decouple_loss:0.08033277094364166
The generated pressure mean: 0.4482642412185669
loss_pred:0.0748259648680687, decouple_loss:0.0805336982011795
The generated pressure mean: 0.44603416323661804
loss_pred:0.07933105528354645, decouple_loss:0.07917104661464691
Iteration: 42, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44799819588661194
The generated pressure mean: 0.4486105442047119
loss_pred:0.07851434499025345, decouple_loss:0.07829322665929794
loss_pred:0.07900240272283554, decouple_loss:0.08006636053323746
The generated pressure mean: 0.44669008255004883
loss_pred:0.07640699297189713, decouple_loss:0.08022276312112808
Iteration: 43, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44730597734451294
The generated pressure mean: 0.4466645419597626
loss_pred:0.07522495836019516, decouple_loss:0.07632565498352051
loss_pred:0.07914504408836365, decouple_loss:0.07572490721940994
The generated pressure mean: 0.4476628601551056
loss_pred:0.07725189626216888, decouple_loss:0.07586201280355453
Iteration: 44, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4481518268585205
The generated pressure mean: 0.44601139426231384
loss_pred:0.07671210169792175, decouple_loss:0.07298901677131653
loss_pred:0.07586222887039185, decouple_loss:0.07418684661388397
The generated pressure mean: 0.44770726561546326
loss_pred:0.07794295251369476, decouple_loss:0.07432511448860168
Iteration: 45, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4475573003292084
The generated pressure mean: 0.4484339952468872
loss_pred:0.07403361052274704, decouple_loss:0.0712692141532898
loss_pred:0.07899870723485947, decouple_loss:0.07259871810674667
The generated pressure mean: 0.4480348825454712
loss_pred:0.07623184472322464, decouple_loss:0.0712137371301651
Iteration: 46, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44574248790740967
loss_pred:0.07734201103448868, decouple_loss:0.06968417763710022
The generated pressure mean: 0.4459710121154785
loss_pred:0.07379788905382156, decouple_loss:0.06833589822053909
The generated pressure mean: 0.44880780577659607
loss_pred:0.07866531610488892, decouple_loss:0.06876111030578613
Iteration: 47, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.448044091463089
loss_pred:0.07180912047624588, decouple_loss:0.06735514104366302
The generated pressure mean: 0.4466207027435303
loss_pred:0.07535681128501892, decouple_loss:0.0662323534488678
The generated pressure mean: 0.44694462418556213
loss_pred:0.07666638493537903, decouple_loss:0.06794249266386032
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 48, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.446533739566803
The generated pressure mean: 0.44523462653160095
loss_pred:0.07467671483755112, decouple_loss:0.06290817260742188
loss_pred:0.07756339758634567, decouple_loss:0.06294181942939758
The generated pressure mean: 0.44782647490501404
loss_pred:0.07616604119539261, decouple_loss:0.06450527906417847
Iteration: 49, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4481533467769623
loss_pred:0.07944932579994202, decouple_loss:0.06176232174038887
The generated pressure mean: 0.447226345539093
The generated pressure mean: 0.44881632924079895
loss_pred:0.07552767544984818, decouple_loss:0.06187121570110321
loss_pred:0.07683045417070389, decouple_loss:0.061294473707675934
Iteration: 50, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4475002884864807
The generated pressure mean: 0.44648075103759766
loss_pred:0.07395581901073456, decouple_loss:0.05873444676399231
The generated pressure mean: 0.44720175862312317
loss_pred:0.07319594919681549, decouple_loss:0.05842973664402962
loss_pred:0.0745408684015274, decouple_loss:0.05838464945554733
2023-04-16 01:33:32 testing...
The generated pressure mean: 0.4495830535888672
The generated pressure mean: 0.4497888386249542
The generated pressure mean: 0.44987666606903076
loss_pred:0.07651752233505249, decouple_loss:0.057395320385694504
loss_pred:0.07537688314914703, decouple_loss:0.05740900710225105
loss_pred:0.07619868218898773, decouple_loss:0.05686222016811371
Loss: 0.07889213413000107, avg_mse: 0.07567908614873886
current test mse: 0.075679
Iteration: 51, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4472336173057556
The generated pressure mean: 0.44865882396698
loss_pred:0.07059372961521149, decouple_loss:0.058426667004823685
loss_pred:0.07946840673685074, decouple_loss:0.05728422477841377
The generated pressure mean: 0.4468749761581421
loss_pred:0.07004905492067337, decouple_loss:0.05739661306142807
Iteration: 52, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44811418652534485
loss_pred:0.07632449269294739, decouple_loss:0.05687624216079712
The generated pressure mean: 0.44639313220977783
loss_pred:0.07351827621459961, decouple_loss:0.055950772017240524
The generated pressure mean: 0.4474366009235382
loss_pred:0.07328835129737854, decouple_loss:0.056696996092796326
Iteration: 53, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4481727182865143
loss_pred:0.07633201777935028, decouple_loss:0.05576683580875397
The generated pressure mean: 0.44644472002983093
loss_pred:0.0723448395729065, decouple_loss:0.05531558394432068
The generated pressure mean: 0.4470854103565216
loss_pred:0.06988159567117691, decouple_loss:0.05494748428463936
Iteration: 54, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4462290108203888
loss_pred:0.07213185727596283, decouple_loss:0.05213121324777603
The generated pressure mean: 0.4466317892074585
loss_pred:0.07478195428848267, decouple_loss:0.05265301838517189
The generated pressure mean: 0.44901183247566223
loss_pred:0.07640210539102554, decouple_loss:0.05237748473882675
Iteration: 55, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44699421525001526
loss_pred:0.07361429184675217, decouple_loss:0.053092263638973236
The generated pressure mean: 0.4472421705722809
loss_pred:0.06955941021442413, decouple_loss:0.0547373928129673
The generated pressure mean: 0.4470917880535126
loss_pred:0.07238323241472244, decouple_loss:0.05366533622145653
Iteration: 56, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4478665292263031
loss_pred:0.07524758577346802, decouple_loss:0.05379873514175415
The generated pressure mean: 0.44639071822166443
loss_pred:0.07322851568460464, decouple_loss:0.05366227775812149
The generated pressure mean: 0.4470219612121582
loss_pred:0.07353031635284424, decouple_loss:0.05367329716682434
Iteration: 57, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4472917318344116
loss_pred:0.07192063331604004, decouple_loss:0.05168643221259117
The generated pressure mean: 0.44767576456069946
loss_pred:0.06813575327396393, decouple_loss:0.050717540085315704
The generated pressure mean: 0.4467603862285614
loss_pred:0.0713498517870903, decouple_loss:0.05247538536787033
Iteration: 58, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4479070007801056
loss_pred:0.07427637279033661, decouple_loss:0.049704741686582565
The generated pressure mean: 0.4465906322002411
loss_pred:0.07177862524986267, decouple_loss:0.05201255530118942
The generated pressure mean: 0.44729161262512207
loss_pred:0.07150468975305557, decouple_loss:0.05104926973581314
Iteration: 59, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4455767571926117
loss_pred:0.0732521116733551, decouple_loss:0.05080319195985794
The generated pressure mean: 0.4477525055408478
loss_pred:0.0715457946062088, decouple_loss:0.05259372666478157
The generated pressure mean: 0.44615438580513
loss_pred:0.07397764921188354, decouple_loss:0.0528060607612133
Iteration: 60, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44706714153289795
loss_pred:0.06912710517644882, decouple_loss:0.050510749220848083
The generated pressure mean: 0.4483518898487091
loss_pred:0.07088849693536758, decouple_loss:0.04990512505173683
The generated pressure mean: 0.44825175404548645
loss_pred:0.07024601846933365, decouple_loss:0.05009777843952179
2023-04-16 01:35:25 testing...
The generated pressure mean: 0.4497888386249542
The generated pressure mean: 0.4495830833911896
The generated pressure mean: 0.44987666606903076
loss_pred:0.07295354455709457, decouple_loss:0.04844033718109131
loss_pred:0.07388987392187119, decouple_loss:0.04915926605463028
loss_pred:0.07323433458805084, decouple_loss:0.0498836487531662
Loss: 0.07581730931997299, avg_mse: 0.07293431460857391
current test mse: 0.072934
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012016_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012016_3_24hr.npz
NaN value num: 0
Iteration: 61, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4466681480407715
loss_pred:0.07373204827308655, decouple_loss:0.051148224622011185
The generated pressure mean: 0.4482465088367462
The generated pressure mean: 0.4469186067581177
loss_pred:0.07430928945541382, decouple_loss:0.050694383680820465
loss_pred:0.07320369780063629, decouple_loss:0.050100624561309814
Iteration: 62, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44798144698143005
The generated pressure mean: 0.44629180431365967
loss_pred:0.07150682806968689, decouple_loss:0.0525968112051487
loss_pred:0.07548697292804718, decouple_loss:0.053768090903759
The generated pressure mean: 0.4492480754852295
loss_pred:0.07669059932231903, decouple_loss:0.05421466752886772
Iteration: 63, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44651758670806885
loss_pred:0.07643098384141922, decouple_loss:0.05477769300341606
The generated pressure mean: 0.44960805773735046
loss_pred:0.07730203866958618, decouple_loss:0.05716213583946228
The generated pressure mean: 0.4468691945075989
loss_pred:0.0795709416270256, decouple_loss:0.05511239543557167
Iteration: 64, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4477654695510864
The generated pressure mean: 0.44723808765411377
loss_pred:0.07675844430923462, decouple_loss:0.05664563551545143
loss_pred:0.07313992828130722, decouple_loss:0.05573423579335213
The generated pressure mean: 0.44680145382881165
loss_pred:0.07543281465768814, decouple_loss:0.05456225201487541
Iteration: 65, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44755110144615173
loss_pred:0.07259683310985565, decouple_loss:0.055113911628723145
The generated pressure mean: 0.44842371344566345
loss_pred:0.07500516623258591, decouple_loss:0.05374739319086075
The generated pressure mean: 0.4468850791454315
loss_pred:0.07589051872491837, decouple_loss:0.054569799453020096
Iteration: 66, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44666460156440735
loss_pred:0.0725829005241394, decouple_loss:0.05344681814312935
The generated pressure mean: 0.44690871238708496
loss_pred:0.07186082005500793, decouple_loss:0.05416935309767723
The generated pressure mean: 0.4484513998031616
loss_pred:0.0737689957022667, decouple_loss:0.05342472344636917
Iteration: 67, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44634178280830383
loss_pred:0.07278677076101303, decouple_loss:0.05026273801922798
The generated pressure mean: 0.4476337432861328
loss_pred:0.07393202930688858, decouple_loss:0.05143558233976364
The generated pressure mean: 0.4464806616306305
loss_pred:0.07286965101957321, decouple_loss:0.05147417262196541
Iteration: 68, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44696342945098877
loss_pred:0.07360442727804184, decouple_loss:0.047193292528390884
The generated pressure mean: 0.4480094313621521
loss_pred:0.0733301192522049, decouple_loss:0.04897936061024666
The generated pressure mean: 0.44705289602279663
loss_pred:0.07152906805276871, decouple_loss:0.047564394772052765
Iteration: 69, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.446621298789978
loss_pred:0.07349491119384766, decouple_loss:0.049772340804338455
The generated pressure mean: 0.4477772116661072
loss_pred:0.07415706664323807, decouple_loss:0.049756795167922974
The generated pressure mean: 0.44655951857566833
loss_pred:0.07473614066839218, decouple_loss:0.04951484873890877
Iteration: 70, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44703516364097595
loss_pred:0.07115118205547333, decouple_loss:0.04595844820141792
The generated pressure mean: 0.4486178159713745
loss_pred:0.07061019539833069, decouple_loss:0.04603070765733719
The generated pressure mean: 0.4466017484664917
loss_pred:0.07165087759494781, decouple_loss:0.046326640993356705
2023-04-16 01:37:56 testing...
The generated pressure mean: 0.449788898229599
The generated pressure mean: 0.4495830833911896
The generated pressure mean: 0.44987666606903076
loss_pred:0.07056567817926407, decouple_loss:0.048284806311130524
loss_pred:0.07101539522409439, decouple_loss:0.04826357215642929
loss_pred:0.07008788734674454, decouple_loss:0.047855257987976074
Loss: 0.07296305149793625, avg_mse: 0.07015109807252884
current test mse: 0.070151
Iteration: 71, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4483056962490082
loss_pred:0.06994502246379852, decouple_loss:0.04786226898431778
The generated pressure mean: 0.44689783453941345
loss_pred:0.07049015909433365, decouple_loss:0.048832911998033524
The generated pressure mean: 0.4483170211315155
loss_pred:0.0719548687338829, decouple_loss:0.04912957176566124
Iteration: 72, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4490155279636383
loss_pred:0.07226002961397171, decouple_loss:0.046951718628406525
The generated pressure mean: 0.4484936594963074
loss_pred:0.07077497243881226, decouple_loss:0.04512186720967293
The generated pressure mean: 0.44762569665908813
loss_pred:0.0696311965584755, decouple_loss:0.04588983207941055
Iteration: 73, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44851794838905334
loss_pred:0.06992802023887634, decouple_loss:0.04508546367287636
The generated pressure mean: 0.44941359758377075
The generated pressure mean: 0.4464671313762665
loss_pred:0.07187126576900482, decouple_loss:0.046162914484739304
loss_pred:0.07142853736877441, decouple_loss:0.0453982837498188
Iteration: 74, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4475051462650299
loss_pred:0.06805241852998734, decouple_loss:0.04298320412635803
The generated pressure mean: 0.44754254817962646
loss_pred:0.0685410127043724, decouple_loss:0.04366570711135864
The generated pressure mean: 0.4481349587440491
loss_pred:0.06790956109762192, decouple_loss:0.0434735044836998
Iteration: 75, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44801685214042664
loss_pred:0.07006996870040894, decouple_loss:0.044512584805488586
The generated pressure mean: 0.4470483064651489
loss_pred:0.06957294791936874, decouple_loss:0.044797733426094055
The generated pressure mean: 0.4469279646873474
loss_pred:0.06861597299575806, decouple_loss:0.04445168003439903
Iteration: 76, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4473802149295807
loss_pred:0.06688499450683594, decouple_loss:0.04187803342938423
The generated pressure mean: 0.4463585615158081
loss_pred:0.0686335638165474, decouple_loss:0.04227374494075775
The generated pressure mean: 0.4473516047000885
loss_pred:0.06722359359264374, decouple_loss:0.0418112576007843
Iteration: 77, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44748455286026
loss_pred:0.06695396453142166, decouple_loss:0.041990552097558975
The generated pressure mean: 0.4475826025009155
loss_pred:0.06980741769075394, decouple_loss:0.043156541883945465
The generated pressure mean: 0.4468767046928406
loss_pred:0.068605937063694, decouple_loss:0.04284631833434105
Iteration: 78, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44716107845306396
loss_pred:0.0677449032664299, decouple_loss:0.04083877429366112
The generated pressure mean: 0.44685885310173035
loss_pred:0.06775791198015213, decouple_loss:0.04037327691912651
The generated pressure mean: 0.4476301968097687
loss_pred:0.06787878274917603, decouple_loss:0.04098954051733017
Iteration: 79, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4466789960861206
loss_pred:0.06683284044265747, decouple_loss:0.04000529274344444
The generated pressure mean: 0.4469491243362427
loss_pred:0.06761760264635086, decouple_loss:0.04006737843155861
The generated pressure mean: 0.44765305519104004
loss_pred:0.07049697637557983, decouple_loss:0.04089685156941414
Iteration: 80, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4472801983356476
The generated pressure mean: 0.44772204756736755
loss_pred:0.06619055569171906, decouple_loss:0.040088869631290436
loss_pred:0.064813993871212, decouple_loss:0.04070602357387543
The generated pressure mean: 0.44759416580200195
loss_pred:0.06710406392812729, decouple_loss:0.040768202394247055
2023-04-16 01:39:49 testing...
The generated pressure mean: 0.4495830833911896
The generated pressure mean: 0.4497888684272766
The generated pressure mean: 0.44987666606903076
loss_pred:0.0670396089553833, decouple_loss:0.038856446743011475
loss_pred:0.06728920340538025, decouple_loss:0.03967152163386345
loss_pred:0.06607209146022797, decouple_loss:0.03851722925901413
Loss: 0.06875105947256088, avg_mse: 0.06636904925107956
current test mse: 0.066369
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012009_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012009_3_24hr.npz
NaN value num: 0
Iteration: 81, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4491191506385803
loss_pred:0.06978147476911545, decouple_loss:0.038553666323423386
The generated pressure mean: 0.44901955127716064
loss_pred:0.06976734101772308, decouple_loss:0.040608856827020645
The generated pressure mean: 0.4502018094062805
loss_pred:0.07023078948259354, decouple_loss:0.03849164396524429
Iteration: 82, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4481092393398285The generated pressure mean: 0.4484004080295563
loss_pred:0.06585043668746948, decouple_loss:0.03840366378426552loss_pred:0.06609785556793213, decouple_loss:0.03841071203351021
The generated pressure mean: 0.44738608598709106
loss_pred:0.0705631822347641, decouple_loss:0.03901180997490883
Iteration: 83, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44974711537361145
loss_pred:0.06956083327531815, decouple_loss:0.03910365328192711
The generated pressure mean: 0.4494432210922241
loss_pred:0.06902895867824554, decouple_loss:0.03910286724567413
The generated pressure mean: 0.4494730234146118
loss_pred:0.06626296788454056, decouple_loss:0.03914016857743263
Iteration: 84, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4487565755844116
The generated pressure mean: 0.4484628736972809
loss_pred:0.0667344182729721, decouple_loss:0.03670595586299896
loss_pred:0.06322792172431946, decouple_loss:0.03690120577812195
The generated pressure mean: 0.4483877718448639
loss_pred:0.06871499121189117, decouple_loss:0.036387499421834946
Iteration: 85, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44910916686058044
The generated pressure mean: 0.45015114545822144
loss_pred:0.06592407077550888, decouple_loss:0.035899315029382706
loss_pred:0.06827156245708466, decouple_loss:0.036511339247226715
The generated pressure mean: 0.4497900903224945
loss_pred:0.06756214052438736, decouple_loss:0.039776887744665146
Iteration: 86, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4501529932022095
loss_pred:0.06454360485076904, decouple_loss:0.0358319990336895
The generated pressure mean: 0.4487476646900177
The generated pressure mean: 0.44772833585739136
loss_pred:0.06765284389257431, decouple_loss:0.03775990009307861
loss_pred:0.06935328245162964, decouple_loss:0.037606190890073776
Iteration: 87, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4493604004383087
The generated pressure mean: 0.44927430152893066
loss_pred:0.06580917537212372, decouple_loss:0.03456208482384682
loss_pred:0.06622972339391708, decouple_loss:0.034952010959386826
The generated pressure mean: 0.4491322934627533
loss_pred:0.06501049548387527, decouple_loss:0.034894850105047226
Iteration: 88, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44662219285964966
The generated pressure mean: 0.4493882358074188
loss_pred:0.06697829067707062, decouple_loss:0.03637916222214699
loss_pred:0.06457355618476868, decouple_loss:0.03554599732160568
The generated pressure mean: 0.44998177886009216
loss_pred:0.06403597444295883, decouple_loss:0.03611604496836662
Iteration: 89, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4495813846588135
loss_pred:0.06739233434200287, decouple_loss:0.03707218915224075
The generated pressure mean: 0.4481542408466339
loss_pred:0.06597292423248291, decouple_loss:0.03700089454650879
The generated pressure mean: 0.44854825735092163
loss_pred:0.06468980759382248, decouple_loss:0.0361877866089344
Iteration: 90, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44880861043930054
The generated pressure mean: 0.44789427518844604
loss_pred:0.06386686116456985, decouple_loss:0.035697054117918015
loss_pred:0.06428280472755432, decouple_loss:0.036336708813905716
The generated pressure mean: 0.4486571252346039
loss_pred:0.06719348579645157, decouple_loss:0.0374373197555542
2023-04-16 01:42:20 testing...
The generated pressure mean: 0.4495830833911896
The generated pressure mean: 0.449788898229599
The generated pressure mean: 0.44987666606903076
loss_pred:0.06406199187040329, decouple_loss:0.038244109600782394
loss_pred:0.06467145681381226, decouple_loss:0.039127398282289505
loss_pred:0.06329278647899628, decouple_loss:0.03804651275277138
Loss: 0.06593238562345505, avg_mse: 0.06373786926269531
current test mse: 0.063738
Iteration: 91, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44813576340675354
The generated pressure mean: 0.44935810565948486
loss_pred:0.06588476896286011, decouple_loss:0.03768079727888107
loss_pred:0.06703169643878937, decouple_loss:0.04223201423883438
The generated pressure mean: 0.4472452700138092
loss_pred:0.06307874619960785, decouple_loss:0.037603750824928284
Iteration: 92, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.448865681886673
loss_pred:0.0662633553147316, decouple_loss:0.03471626341342926
The generated pressure mean: 0.447726845741272
loss_pred:0.06558755785226822, decouple_loss:0.03569291904568672
The generated pressure mean: 0.44882893562316895
loss_pred:0.06751371920108795, decouple_loss:0.03670542687177658
Iteration: 93, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4481106400489807
The generated pressure mean: 0.4478687345981598loss_pred:0.06209758296608925, decouple_loss:0.03295744210481644
loss_pred:0.06485285609960556, decouple_loss:0.03506704792380333
The generated pressure mean: 0.44888004660606384
loss_pred:0.0663219690322876, decouple_loss:0.033350396901369095
Iteration: 94, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44796696305274963
The generated pressure mean: 0.4492068290710449
loss_pred:0.06055775284767151, decouple_loss:0.03275718912482262
loss_pred:0.06638942658901215, decouple_loss:0.03247261047363281
The generated pressure mean: 0.44916269183158875
loss_pred:0.06622396409511566, decouple_loss:0.03256557509303093
Iteration: 95, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44856056571006775
The generated pressure mean: 0.4478866457939148
loss_pred:0.0641789361834526, decouple_loss:0.03153808042407036
loss_pred:0.06270808726549149, decouple_loss:0.03149786591529846
The generated pressure mean: 0.4464895725250244
loss_pred:0.06246887892484665, decouple_loss:0.030970625579357147
Iteration: 96, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44884318113327026
The generated pressure mean: 0.4489775598049164
loss_pred:0.060618653893470764, decouple_loss:0.033584222197532654
loss_pred:0.06113476678729057, decouple_loss:0.033796682953834534
The generated pressure mean: 0.4490792453289032
loss_pred:0.061745401471853256, decouple_loss:0.03322483226656914
Iteration: 97, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4475764334201813
The generated pressure mean: 0.44852960109710693
loss_pred:0.06152116507291794, decouple_loss:0.03497858718037605
loss_pred:0.06522740423679352, decouple_loss:0.03574299067258835
The generated pressure mean: 0.44848164916038513
loss_pred:0.06412653625011444, decouple_loss:0.03745574131608009
Iteration: 98, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44952392578125
The generated pressure mean: 0.4485054016113281
loss_pred:0.06521511822938919, decouple_loss:0.0370761938393116
loss_pred:0.06568024307489395, decouple_loss:0.03707902505993843
The generated pressure mean: 0.4504079520702362
loss_pred:0.06150873750448227, decouple_loss:0.03665534779429436
Iteration: 99, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4498187303543091
loss_pred:0.06151678040623665, decouple_loss:0.0342947356402874
The generated pressure mean: 0.4499039649963379
loss_pred:0.06539877504110336, decouple_loss:0.03514261916279793
The generated pressure mean: 0.448699414730072
loss_pred:0.060735706239938736, decouple_loss:0.034780122339725494
Iteration: 100, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4476395547389984
The generated pressure mean: 0.4480966627597809
loss_pred:0.06032883748412132, decouple_loss:0.031140737235546112
loss_pred:0.06316982954740524, decouple_loss:0.03240543603897095
The generated pressure mean: 0.44939926266670227
loss_pred:0.06227032467722893, decouple_loss:0.03243446350097656
2023-04-16 01:44:14 testing...
The generated pressure mean: 0.4495830535888672
The generated pressure mean: 0.4497888684272766
The generated pressure mean: 0.44987666606903076
loss_pred:0.06165570393204689, decouple_loss:0.03482629731297493
loss_pred:0.06263865530490875, decouple_loss:0.035751163959503174
loss_pred:0.060450609773397446, decouple_loss:0.034606512635946274
Loss: 0.06333472579717636, avg_mse: 0.061502594500780106
current test mse: 0.061503
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012008_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012008_3_24hr.npz
NaN value num: 0
Iteration: 101, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44701674580574036
loss_pred:0.06402114778757095, decouple_loss:0.03639400377869606
The generated pressure mean: 0.4471513628959656
loss_pred:0.06231296807527542, decouple_loss:0.03883439302444458
The generated pressure mean: 0.44656580686569214
loss_pred:0.05969294533133507, decouple_loss:0.03561360016465187
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 102, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44610631465911865
loss_pred:0.0635531023144722, decouple_loss:0.04263908043503761
The generated pressure mean: 0.4479460120201111
The generated pressure mean: 0.44671717286109924
loss_pred:0.06313099712133408, decouple_loss:0.04325210303068161
loss_pred:0.06374946236610413, decouple_loss:0.04221592843532562
Iteration: 103, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4484494626522064
The generated pressure mean: 0.44694986939430237
loss_pred:0.06082983314990997, decouple_loss:0.04198314994573593
loss_pred:0.06216209754347801, decouple_loss:0.04292970895767212
The generated pressure mean: 0.4466868042945862
loss_pred:0.05877818539738655, decouple_loss:0.04135538637638092
Iteration: 104, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44634103775024414
loss_pred:0.06240702047944069, decouple_loss:0.03975716233253479
The generated pressure mean: 0.44680145382881165
The generated pressure mean: 0.4464333653450012
loss_pred:0.06169372797012329, decouple_loss:0.039665013551712036
loss_pred:0.06304684281349182, decouple_loss:0.0397690050303936
Iteration: 105, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44674137234687805
loss_pred:0.06284379214048386, decouple_loss:0.04094625636935234
The generated pressure mean: 0.4472448229789734
loss_pred:0.06143927946686745, decouple_loss:0.04068407043814659The generated pressure mean: 0.44700536131858826
loss_pred:0.06164785847067833, decouple_loss:0.04019209370017052
Iteration: 106, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44632676243782043
loss_pred:0.06269491463899612, decouple_loss:0.034906260669231415
The generated pressure mean: 0.44758808612823486
loss_pred:0.05834878236055374, decouple_loss:0.03525298461318016
The generated pressure mean: 0.4477647840976715
loss_pred:0.05980946123600006, decouple_loss:0.03579298034310341
Iteration: 107, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4459965229034424
The generated pressure mean: 0.44740480184555054The generated pressure mean: 0.4468805491924286
loss_pred:0.06281690299510956, decouple_loss:0.039448194205760956
loss_pred:0.06030770763754845, decouple_loss:0.0388638973236084loss_pred:0.0620785616338253, decouple_loss:0.038740769028663635
Iteration: 108, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44679540395736694
loss_pred:0.05917368084192276, decouple_loss:0.03893790394067764
The generated pressure mean: 0.44657978415489197
loss_pred:0.059559162706136703, decouple_loss:0.0386437252163887
The generated pressure mean: 0.44651535153388977
loss_pred:0.0621197409927845, decouple_loss:0.04007425531744957
Iteration: 109, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44530779123306274
loss_pred:0.05995815992355347, decouple_loss:0.03865984454751015
The generated pressure mean: 0.4463662803173065
loss_pred:0.061444997787475586, decouple_loss:0.03736742213368416
The generated pressure mean: 0.44681304693222046
loss_pred:0.06000250577926636, decouple_loss:0.03876054286956787
Iteration: 110, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4468380808830261
The generated pressure mean: 0.44682130217552185loss_pred:0.058821532875299454, decouple_loss:0.034241072833538055
loss_pred:0.05864729359745979, decouple_loss:0.03403715416789055
The generated pressure mean: 0.4477007985115051
loss_pred:0.05690040811896324, decouple_loss:0.03393102437257767
2023-04-16 01:46:54 testing...
The generated pressure mean: 0.4495830833911896
The generated pressure mean: 0.449788898229599
The generated pressure mean: 0.44987666606903076
loss_pred:0.06007719039916992, decouple_loss:0.0363369882106781
loss_pred:0.06085731461644173, decouple_loss:0.03617985174059868
loss_pred:0.05874065309762955, decouple_loss:0.0363263264298439
Loss: 0.06170577555894852, avg_mse: 0.05992768704891205
current test mse: 0.059928
Iteration: 111, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4465217888355255
loss_pred:0.056830570101737976, decouple_loss:0.035400789231061935
The generated pressure mean: 0.4467865228652954
loss_pred:0.060209907591342926, decouple_loss:0.03631449490785599
The generated pressure mean: 0.4468702971935272
loss_pred:0.06008000671863556, decouple_loss:0.035877324640750885
Iteration: 112, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4461234509944916
loss_pred:0.05836266651749611, decouple_loss:0.035184819251298904
The generated pressure mean: 0.4466151297092438
loss_pred:0.05810580775141716, decouple_loss:0.035018838942050934
The generated pressure mean: 0.446519672870636
loss_pred:0.058370962738990784, decouple_loss:0.035162344574928284
Iteration: 113, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44517549872398376
The generated pressure mean: 0.44756370782852173
loss_pred:0.058649297803640366, decouple_loss:0.03188275173306465
loss_pred:0.0551534965634346, decouple_loss:0.03343707695603371
The generated pressure mean: 0.4466697573661804
loss_pred:0.058326974511146545, decouple_loss:0.03280581533908844
Iteration: 114, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44698435068130493
loss_pred:0.05648081377148628, decouple_loss:0.031446415930986404
The generated pressure mean: 0.44734692573547363
The generated pressure mean: 0.4453771114349365
loss_pred:0.05942491814494133, decouple_loss:0.03194834664463997
loss_pred:0.05968596786260605, decouple_loss:0.031972479075193405
Iteration: 115, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4470561742782593
loss_pred:0.05507393181324005, decouple_loss:0.031975988298654556
The generated pressure mean: 0.4460991322994232
loss_pred:0.06075325235724449, decouple_loss:0.03174949437379837
The generated pressure mean: 0.44643449783325195
loss_pred:0.05804780125617981, decouple_loss:0.030852967873215675
Iteration: 116, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44611552357673645
The generated pressure mean: 0.4472530484199524
loss_pred:0.058669399470090866, decouple_loss:0.03213811665773392
loss_pred:0.06033443287014961, decouple_loss:0.031009359285235405
The generated pressure mean: 0.4463392496109009
loss_pred:0.05841631814837456, decouple_loss:0.031452979892492294
Iteration: 117, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44712939858436584
loss_pred:0.05870254337787628, decouple_loss:0.03178435191512108
The generated pressure mean: 0.44678202271461487
loss_pred:0.05626501515507698, decouple_loss:0.03168763965368271
The generated pressure mean: 0.44605761766433716
loss_pred:0.05778738483786583, decouple_loss:0.03082183003425598
Iteration: 118, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4466235041618347
loss_pred:0.05567675083875656, decouple_loss:0.03041038289666176
The generated pressure mean: 0.44680383801460266
loss_pred:0.056182313710451126, decouple_loss:0.030098391696810722
The generated pressure mean: 0.446067214012146
loss_pred:0.057491376996040344, decouple_loss:0.03127061203122139
Iteration: 119, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4452042877674103
The generated pressure mean: 0.446666419506073
loss_pred:0.05778094008564949, decouple_loss:0.030212827026844025
loss_pred:0.0550631545484066, decouple_loss:0.030284546315670013
The generated pressure mean: 0.44705235958099365
loss_pred:0.05618493631482124, decouple_loss:0.030136751011013985
Iteration: 120, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4456709325313568
loss_pred:0.05961774289608002, decouple_loss:0.029761701822280884
The generated pressure mean: 0.4469769597053528
loss_pred:0.05653616413474083, decouple_loss:0.030285155400633812
The generated pressure mean: 0.44759318232536316
loss_pred:0.05690150335431099, decouple_loss:0.029719902202486992
2023-04-16 01:48:47 testing...
The generated pressure mean: 0.4495830833911896
The generated pressure mean: 0.4497888684272766
The generated pressure mean: 0.44987666606903076
loss_pred:0.059331633150577545, decouple_loss:0.03426156938076019
loss_pred:0.059755586087703705, decouple_loss:0.034451574087142944
loss_pred:0.05781150609254837, decouple_loss:0.034132104367017746
Loss: 0.0606803297996521, avg_mse: 0.05952629819512367
current test mse: 0.059526
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012005_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012005_3_24hr.npz
NaN value num: 0
Iteration: 121, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4496973752975464
loss_pred:0.0557551346719265, decouple_loss:0.033952951431274414
The generated pressure mean: 0.44836828112602234
The generated pressure mean: 0.4494202435016632
loss_pred:0.05866824463009834, decouple_loss:0.03424671292304993
loss_pred:0.05598082393407822, decouple_loss:0.03416800871491432
Iteration: 122, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4504387676715851
loss_pred:0.06207067891955376, decouple_loss:0.033152345567941666
The generated pressure mean: 0.44941654801368713
The generated pressure mean: 0.44795694947242737
loss_pred:0.05993528291583061, decouple_loss:0.033961620181798935
loss_pred:0.05850466340780258, decouple_loss:0.03250771760940552
Iteration: 123, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4505392014980316
The generated pressure mean: 0.4499286413192749
loss_pred:0.059281233698129654, decouple_loss:0.03410939499735832
loss_pred:0.059693384915590286, decouple_loss:0.03546354919672012
The generated pressure mean: 0.45011699199676514
loss_pred:0.062251899391412735, decouple_loss:0.034406837075948715
Iteration: 124, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.448622465133667
The generated pressure mean: 0.44841185212135315
loss_pred:0.05819987878203392, decouple_loss:0.030591342598199844
loss_pred:0.05807553231716156, decouple_loss:0.031006744131445885
The generated pressure mean: 0.450418621301651
loss_pred:0.06061353161931038, decouple_loss:0.03146101534366608
Iteration: 125, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.448871374130249
loss_pred:0.061066363006830215, decouple_loss:0.03460516035556793
The generated pressure mean: 0.45044639706611633
loss_pred:0.058950770646333694, decouple_loss:0.0352805070579052
The generated pressure mean: 0.4505947232246399
loss_pred:0.055953674018383026, decouple_loss:0.03448861092329025
Iteration: 126, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4490104019641876
The generated pressure mean: 0.44910553097724915
loss_pred:0.05897640809416771, decouple_loss:0.03401515632867813
loss_pred:0.05985122174024582, decouple_loss:0.03488821163773537
The generated pressure mean: 0.44931894540786743
loss_pred:0.05996230989694595, decouple_loss:0.034493476152420044
Iteration: 127, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44891074299812317
loss_pred:0.058803584426641464, decouple_loss:0.03311882168054581
The generated pressure mean: 0.4502854347229004
loss_pred:0.05810790881514549, decouple_loss:0.03354514390230179
The generated pressure mean: 0.45028233528137207
loss_pred:0.05761641263961792, decouple_loss:0.03218924254179001
Iteration: 128, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44892197847366333
loss_pred:0.05955223739147186, decouple_loss:0.03388240560889244
The generated pressure mean: 0.4489338994026184
The generated pressure mean: 0.45016369223594666
loss_pred:0.058403380215168, decouple_loss:0.0332513265311718
loss_pred:0.05619154870510101, decouple_loss:0.03467419371008873
Iteration: 129, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4503426253795624
loss_pred:0.056232042610645294, decouple_loss:0.031920671463012695
The generated pressure mean: 0.44905537366867065
loss_pred:0.05702507868409157, decouple_loss:0.030968625098466873
The generated pressure mean: 0.450771301984787
loss_pred:0.05625927820801735, decouple_loss:0.031100373715162277
Iteration: 130, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4487534165382385
The generated pressure mean: 0.44951102137565613
loss_pred:0.05690520629286766, decouple_loss:0.03325827047228813
loss_pred:0.057322390377521515, decouple_loss:0.03342966362833977
The generated pressure mean: 0.45024311542510986
loss_pred:0.056655410677194595, decouple_loss:0.032955098897218704
2023-04-16 01:51:22 testing...
The generated pressure mean: 0.4497888684272766
The generated pressure mean: 0.4495830833911896
The generated pressure mean: 0.44987666606903076
loss_pred:0.058705687522888184, decouple_loss:0.03137190267443657
loss_pred:0.0577322393655777, decouple_loss:0.030945515260100365
loss_pred:0.05594291910529137, decouple_loss:0.030990170314908028
Loss: 0.05901540815830231, avg_mse: 0.05807226896286011
current test mse: 0.058072
Iteration: 131, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4483104348182678
loss_pred:0.05552685633301735, decouple_loss:0.030780283734202385
The generated pressure mean: 0.4478796720504761
loss_pred:0.058778487145900726, decouple_loss:0.03181086480617523
The generated pressure mean: 0.44724041223526
loss_pred:0.05442629009485245, decouple_loss:0.03163154050707817
Iteration: 132, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4492276608943939
loss_pred:0.056360673159360886, decouple_loss:0.0322798490524292
The generated pressure mean: 0.4499109387397766
loss_pred:0.055324163287878036, decouple_loss:0.03277118131518364
The generated pressure mean: 0.4496532082557678
loss_pred:0.05666683241724968, decouple_loss:0.03186731040477753
Iteration: 133, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4494454860687256
loss_pred:0.058646682649850845, decouple_loss:0.031695764511823654
The generated pressure mean: 0.45058080554008484
The generated pressure mean: 0.44959115982055664
loss_pred:0.0549953356385231, decouple_loss:0.03156444802880287
loss_pred:0.055045176297426224, decouple_loss:0.031046323478221893
Iteration: 134, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.449152410030365
loss_pred:0.05765772983431816, decouple_loss:0.033813513815402985
The generated pressure mean: 0.4475288987159729
The generated pressure mean: 0.4496975243091583
loss_pred:0.05273408070206642, decouple_loss:0.0340084582567215
loss_pred:0.05436329543590546, decouple_loss:0.03274909779429436
Iteration: 135, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4495620131492615
loss_pred:0.05678687244653702, decouple_loss:0.03231359273195267
The generated pressure mean: 0.4484518766403198
The generated pressure mean: 0.4475174844264984
loss_pred:0.0565674714744091, decouple_loss:0.032239191234111786
loss_pred:0.05268020182847977, decouple_loss:0.0324188694357872
Iteration: 136, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4498547613620758
loss_pred:0.05310375615954399, decouple_loss:0.03571024909615517
The generated pressure mean: 0.4472036063671112
The generated pressure mean: 0.4494415819644928
loss_pred:0.0536143034696579, decouple_loss:0.03420476242899895
loss_pred:0.05594379082322121, decouple_loss:0.034689631313085556
Iteration: 137, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.449002742767334
loss_pred:0.05805507302284241, decouple_loss:0.033058080822229385
The generated pressure mean: 0.4490041434764862
The generated pressure mean: 0.4500688910484314
loss_pred:0.058263830840587616, decouple_loss:0.03125050291419029
loss_pred:0.05523334816098213, decouple_loss:0.03168477118015289
Iteration: 138, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4500133991241455
loss_pred:0.053627051413059235, decouple_loss:0.03267715871334076
The generated pressure mean: 0.447736918926239
loss_pred:0.05245013162493706, decouple_loss:0.03208818659186363
The generated pressure mean: 0.4490760564804077
loss_pred:0.05687590315937996, decouple_loss:0.031813845038414
Iteration: 139, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44825121760368347
loss_pred:0.055248603224754333, decouple_loss:0.033168092370033264
The generated pressure mean: 0.4487708508968353
The generated pressure mean: 0.4493323266506195
loss_pred:0.0571754015982151, decouple_loss:0.03254495561122894
loss_pred:0.057498201727867126, decouple_loss:0.033389490097761154
Iteration: 140, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45020556449890137
loss_pred:0.05509588494896889, decouple_loss:0.030383337289094925
The generated pressure mean: 0.4494057893753052The generated pressure mean: 0.4502201974391937
loss_pred:0.05768005549907684, decouple_loss:0.03053801693022251
loss_pred:0.05588902160525322, decouple_loss:0.03073006682097912
2023-04-16 01:53:15 testing...
The generated pressure mean: 0.449788898229599
The generated pressure mean: 0.4495830833911896
The generated pressure mean: 0.44987666606903076
loss_pred:0.05644141510128975, decouple_loss:0.029002893716096878
loss_pred:0.055206138640642166, decouple_loss:0.0287029966711998
loss_pred:0.05377016216516495, decouple_loss:0.028859106823801994
Loss: 0.05658198520541191, avg_mse: 0.05595075339078903
current test mse: 0.055951
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012010_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012010_3_24hr.npz
NaN value num: 0
Iteration: 141, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4481261670589447
loss_pred:0.053416091948747635, decouple_loss:0.029556425288319588
The generated pressure mean: 0.44818034768104553
loss_pred:0.056435756385326385, decouple_loss:0.029451368376612663
The generated pressure mean: 0.4480394124984741
loss_pred:0.053552765399217606, decouple_loss:0.030249007046222687
Iteration: 142, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4486684501171112
The generated pressure mean: 0.448211133480072
loss_pred:0.05793245509266853, decouple_loss:0.03358320891857147
loss_pred:0.05392369255423546, decouple_loss:0.03376059606671333
The generated pressure mean: 0.44832539558410645
loss_pred:0.0566442608833313, decouple_loss:0.033158134669065475
Iteration: 143, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44782304763793945
The generated pressure mean: 0.4473575949668884
loss_pred:0.05782030150294304, decouple_loss:0.03128581866621971
loss_pred:0.05512962117791176, decouple_loss:0.030448095872998238
The generated pressure mean: 0.4465717077255249
loss_pred:0.0569225437939167, decouple_loss:0.031651344150304794
Iteration: 144, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4472287595272064
loss_pred:0.05532709136605263, decouple_loss:0.02958809770643711
The generated pressure mean: 0.4488455653190613
The generated pressure mean: 0.4472210109233856
loss_pred:0.05660533159971237, decouple_loss:0.02952575497329235
loss_pred:0.056078579276800156, decouple_loss:0.030871232971549034
Iteration: 145, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44752365350723267
The generated pressure mean: 0.4472235441207886
The generated pressure mean: 0.4477773904800415
loss_pred:0.05665603652596474, decouple_loss:0.034252770245075226
loss_pred:0.05595538392663002, decouple_loss:0.03290362283587456
loss_pred:0.056471195071935654, decouple_loss:0.03381475806236267
Iteration: 146, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44760164618492126
loss_pred:0.05842791125178337, decouple_loss:0.03312793746590614
The generated pressure mean: 0.447181761264801
loss_pred:0.057049043476581573, decouple_loss:0.03315085545182228
The generated pressure mean: 0.44715961813926697
loss_pred:0.05582091212272644, decouple_loss:0.03355755656957626
Iteration: 147, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44685855507850647
The generated pressure mean: 0.4476369321346283
loss_pred:0.05642959102988243, decouple_loss:0.03166484832763672
loss_pred:0.0559823215007782, decouple_loss:0.031643737107515335
The generated pressure mean: 0.44711413979530334
loss_pred:0.054371073842048645, decouple_loss:0.0315222330391407
Iteration: 148, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4480065703392029
The generated pressure mean: 0.4481221139431
loss_pred:0.05497325211763382, decouple_loss:0.03851745277643204
loss_pred:0.05659857019782066, decouple_loss:0.03790387883782387
The generated pressure mean: 0.44782400131225586
loss_pred:0.05532701686024666, decouple_loss:0.0380941703915596
Iteration: 149, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44689860939979553
The generated pressure mean: 0.4471721351146698loss_pred:0.05537686496973038, decouple_loss:0.03325751796364784
loss_pred:0.05774117633700371, decouple_loss:0.03305899351835251
The generated pressure mean: 0.4489342272281647
loss_pred:0.054888974875211716, decouple_loss:0.03406929969787598
Iteration: 150, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.446898490190506
loss_pred:0.055241648107767105, decouple_loss:0.04290277883410454
The generated pressure mean: 0.4480859935283661
loss_pred:0.05354733765125275, decouple_loss:0.043027184903621674
The generated pressure mean: 0.4484303593635559
loss_pred:0.05346723645925522, decouple_loss:0.042311158031225204
2023-04-16 01:55:45 testing...
The generated pressure mean: 0.4495830833911896
The generated pressure mean: 0.4497888684272766
The generated pressure mean: 0.44987666606903076
loss_pred:0.054120879620313644, decouple_loss:0.033640917390584946
loss_pred:0.05519137158989906, decouple_loss:0.03381265699863434
loss_pred:0.0524556040763855, decouple_loss:0.034215059131383896
Loss: 0.05561709403991699, avg_mse: 0.05547574162483215
current test mse: 0.055476
Iteration: 151, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4487683176994324
loss_pred:0.05600237101316452, decouple_loss:0.0341319814324379
The generated pressure mean: 0.44848939776420593
loss_pred:0.056129638105630875, decouple_loss:0.03386470675468445
The generated pressure mean: 0.4479628801345825
loss_pred:0.05196986347436905, decouple_loss:0.03474510461091995
Iteration: 152, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44917985796928406
loss_pred:0.05341244488954544, decouple_loss:0.04226725175976753
The generated pressure mean: 0.4466698467731476
loss_pred:0.05448375269770622, decouple_loss:0.042076580226421356
The generated pressure mean: 0.4485774338245392
loss_pred:0.05402591824531555, decouple_loss:0.04194876179099083
Iteration: 153, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44741079211235046
loss_pred:0.05865474045276642, decouple_loss:0.035907819867134094
The generated pressure mean: 0.4472044110298157
loss_pred:0.05455261096358299, decouple_loss:0.03597722575068474
The generated pressure mean: 0.44735005497932434
loss_pred:0.053576137870550156, decouple_loss:0.03620506078004837
Iteration: 154, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44805118441581726
loss_pred:0.05433610826730728, decouple_loss:0.04075438901782036
The generated pressure mean: 0.44812920689582825
The generated pressure mean: 0.44710662961006165
loss_pred:0.05272773280739784, decouple_loss:0.04113297164440155
loss_pred:0.05604087561368942, decouple_loss:0.040546905249357224
Iteration: 155, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4477587044239044
loss_pred:0.05243333429098129, decouple_loss:0.037574492394924164
The generated pressure mean: 0.44752150774002075
The generated pressure mean: 0.44849157333374023
loss_pred:0.053543057292699814, decouple_loss:0.03762901946902275
loss_pred:0.05630803108215332, decouple_loss:0.03820108249783516
Iteration: 156, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4469960927963257
loss_pred:0.054470520466566086, decouple_loss:0.04114968702197075
The generated pressure mean: 0.4469423294067383
The generated pressure mean: 0.4472768306732178
loss_pred:0.05174941197037697, decouple_loss:0.04197056591510773
loss_pred:0.053805429488420486, decouple_loss:0.041929155588150024
Iteration: 157, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4479084014892578
loss_pred:0.053324468433856964, decouple_loss:0.03721877932548523
The generated pressure mean: 0.4478238523006439
The generated pressure mean: 0.446647047996521
loss_pred:0.055408358573913574, decouple_loss:0.03730325028300285
loss_pred:0.05558019131422043, decouple_loss:0.037397559732198715
Iteration: 158, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.447517991065979
loss_pred:0.05112650245428085, decouple_loss:0.04144614562392235
The generated pressure mean: 0.4472237229347229
The generated pressure mean: 0.4482623338699341
loss_pred:0.05122227594256401, decouple_loss:0.041213955730199814
loss_pred:0.0551464706659317, decouple_loss:0.042145878076553345
Iteration: 159, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44840559363365173
loss_pred:0.052737828344106674, decouple_loss:0.034207556396722794
The generated pressure mean: 0.44714412093162537The generated pressure mean: 0.44746920466423035
loss_pred:0.053228143602609634, decouple_loss:0.0339108482003212
loss_pred:0.05234825238585472, decouple_loss:0.03429216146469116
Iteration: 160, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4467315375804901
loss_pred:0.05511684715747833, decouple_loss:0.03953246399760246
The generated pressure mean: 0.4477115571498871
The generated pressure mean: 0.4464516043663025
loss_pred:0.05468503758311272, decouple_loss:0.040255844593048096
loss_pred:0.05604178458452225, decouple_loss:0.03964809700846672
2023-04-16 01:57:39 testing...
The generated pressure mean: 0.4495830833911896
The generated pressure mean: 0.449788898229599
The generated pressure mean: 0.44987666606903076
loss_pred:0.05469801276922226, decouple_loss:0.037795018404722214
loss_pred:0.05604897812008858, decouple_loss:0.03810160234570503
loss_pred:0.053894318640232086, decouple_loss:0.03730148449540138
Loss: 0.05676707252860069, avg_mse: 0.057126451283693314
current test mse: 0.057126
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012011_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012011_3_24hr.npz
NaN value num: 0
Iteration: 161, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44647493958473206
loss_pred:0.054994016885757446, decouple_loss:0.03860808536410332
The generated pressure mean: 0.44879674911499023
loss_pred:0.0563543364405632, decouple_loss:0.039958611130714417
The generated pressure mean: 0.4472636580467224
loss_pred:0.05534173175692558, decouple_loss:0.03796985000371933
Iteration: 162, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4468763768672943
loss_pred:0.05379237234592438, decouple_loss:0.039157066494226456
The generated pressure mean: 0.4483022689819336
loss_pred:0.05432243272662163, decouple_loss:0.03943827748298645
The generated pressure mean: 0.4481782019138336
loss_pred:0.05458306893706322, decouple_loss:0.038720231503248215
Iteration: 163, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4473292827606201
loss_pred:0.05211776867508888, decouple_loss:0.03898746892809868
The generated pressure mean: 0.44677528738975525
loss_pred:0.0522736981511116, decouple_loss:0.03820846229791641
The generated pressure mean: 0.4459937512874603
loss_pred:0.054382264614105225, decouple_loss:0.03908780217170715
Iteration: 164, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44704756140708923
loss_pred:0.056342169642448425, decouple_loss:0.03951215744018555
The generated pressure mean: 0.4462599456310272
The generated pressure mean: 0.4461468756198883
loss_pred:0.05443849414587021, decouple_loss:0.03873280808329582
loss_pred:0.05560525879263878, decouple_loss:0.03818001225590706
Iteration: 165, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44734594225883484
The generated pressure mean: 0.44739651679992676
loss_pred:0.052102599292993546, decouple_loss:0.04055744782090187
loss_pred:0.05389915779232979, decouple_loss:0.0405753068625927
The generated pressure mean: 0.44582659006118774
loss_pred:0.05387452244758606, decouple_loss:0.04151343181729317
Iteration: 166, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44810667634010315
The generated pressure mean: 0.44664016366004944
loss_pred:0.05143412575125694, decouple_loss:0.03693956509232521
The generated pressure mean: 0.4473477303981781
loss_pred:0.052168719470500946, decouple_loss:0.03699169680476189
loss_pred:0.050935108214616776, decouple_loss:0.03664753958582878
Iteration: 167, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4456849694252014
The generated pressure mean: 0.44620752334594727
loss_pred:0.054131973534822464, decouple_loss:0.04057908058166504
loss_pred:0.05319291353225708, decouple_loss:0.039708271622657776
The generated pressure mean: 0.4468236267566681
loss_pred:0.05139989033341408, decouple_loss:0.0403408482670784
Iteration: 168, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44627130031585693
The generated pressure mean: 0.44625362753868103
loss_pred:0.05219738557934761, decouple_loss:0.03720095008611679
loss_pred:0.05083627626299858, decouple_loss:0.03693854808807373
The generated pressure mean: 0.44883668422698975
loss_pred:0.05120902508497238, decouple_loss:0.037341244518756866
Iteration: 169, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44691959023475647
The generated pressure mean: 0.44582539796829224
loss_pred:0.051602162420749664, decouple_loss:0.04047573730349541
loss_pred:0.05142257362604141, decouple_loss:0.0400497205555439
The generated pressure mean: 0.44609498977661133
loss_pred:0.054148364812135696, decouple_loss:0.040894120931625366
Iteration: 170, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44603100419044495
The generated pressure mean: 0.4478110074996948
loss_pred:0.05154065415263176, decouple_loss:0.037738580256700516
loss_pred:0.05075429007411003, decouple_loss:0.037205349653959274
The generated pressure mean: 0.44859594106674194
loss_pred:0.053223736584186554, decouple_loss:0.038635507225990295
2023-04-16 02:00:13 testing...
The generated pressure mean: 0.4497888684272766
The generated pressure mean: 0.4495830535888672
The generated pressure mean: 0.44987666606903076
loss_pred:0.05290732532739639, decouple_loss:0.035886090248823166
loss_pred:0.052243493497371674, decouple_loss:0.03588295727968216
loss_pred:0.051128994673490524, decouple_loss:0.03619278967380524
Loss: 0.05389263853430748, avg_mse: 0.0543450303375721
current test mse: 0.054345
Iteration: 171, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44746020436286926
The generated pressure mean: 0.4459315240383148
loss_pred:0.04903006926178932, decouple_loss:0.03642577677965164
loss_pred:0.05168487876653671, decouple_loss:0.035696934908628464
The generated pressure mean: 0.44632503390312195
loss_pred:0.050740696489810944, decouple_loss:0.03582433983683586
Iteration: 172, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4472138583660126
The generated pressure mean: 0.44667908549308777
loss_pred:0.051696233451366425, decouple_loss:0.03896762803196907
loss_pred:0.04989031329751015, decouple_loss:0.038969073444604874
The generated pressure mean: 0.44646888971328735
loss_pred:0.04991419240832329, decouple_loss:0.03923935443162918
Iteration: 173, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44904762506484985
The generated pressure mean: 0.44662079215049744
loss_pred:0.05074354633688927, decouple_loss:0.03740893304347992
loss_pred:0.05074548348784447, decouple_loss:0.03668897971510887
The generated pressure mean: 0.44751569628715515
loss_pred:0.049268290400505066, decouple_loss:0.03768134117126465
Iteration: 174, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44710493087768555
The generated pressure mean: 0.44820311665534973
loss_pred:0.049040235579013824, decouple_loss:0.037197038531303406
loss_pred:0.04965626820921898, decouple_loss:0.03732845559716225
The generated pressure mean: 0.44885820150375366
loss_pred:0.05117795616388321, decouple_loss:0.038614220917224884
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 175, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4479667842388153
loss_pred:0.04916122183203697, decouple_loss:0.034259092062711716
The generated pressure mean: 0.4467659592628479
loss_pred:0.04893004149198532, decouple_loss:0.03397437930107117
The generated pressure mean: 0.4456796944141388
loss_pred:0.050312966108322144, decouple_loss:0.03450394421815872
Iteration: 176, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4468863308429718
loss_pred:0.050788234919309616, decouple_loss:0.0353490449488163
The generated pressure mean: 0.44817230105400085
loss_pred:0.04883812367916107, decouple_loss:0.035811230540275574
The generated pressure mean: 0.4475928544998169
loss_pred:0.04963775724172592, decouple_loss:0.0360279344022274
Iteration: 177, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44760066270828247
loss_pred:0.04880018159747124, decouple_loss:0.03299422189593315
The generated pressure mean: 0.44525769352912903
loss_pred:0.04958066716790199, decouple_loss:0.033041805028915405
The generated pressure mean: 0.4474707841873169
loss_pred:0.04982301965355873, decouple_loss:0.033182889223098755
Iteration: 178, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4467124044895172
loss_pred:0.050221022218465805, decouple_loss:0.034693121910095215
The generated pressure mean: 0.4480065703392029
loss_pred:0.0501963347196579, decouple_loss:0.036455098539590836
The generated pressure mean: 0.4474453032016754
loss_pred:0.05061199516057968, decouple_loss:0.036054421216249466
Iteration: 179, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4464486539363861
loss_pred:0.047854479402303696, decouple_loss:0.03244207054376602
The generated pressure mean: 0.44641295075416565
loss_pred:0.05073538050055504, decouple_loss:0.0322917141020298
The generated pressure mean: 0.4452894926071167
loss_pred:0.04753035306930542, decouple_loss:0.03181137889623642
Iteration: 180, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4463035762310028
loss_pred:0.048375822603702545, decouple_loss:0.03131333738565445
The generated pressure mean: 0.4466908872127533
loss_pred:0.04891802370548248, decouple_loss:0.03157537803053856
The generated pressure mean: 0.4485739767551422
loss_pred:0.05033179745078087, decouple_loss:0.032181207090616226
2023-04-16 02:02:06 testing...
The generated pressure mean: 0.4495830535888672
The generated pressure mean: 0.449788898229599
The generated pressure mean: 0.44987666606903076
loss_pred:0.05039561167359352, decouple_loss:0.031468845903873444
loss_pred:0.051042307168245316, decouple_loss:0.03193158283829689
loss_pred:0.04929795116186142, decouple_loss:0.0319666862487793
Loss: 0.05183474346995354, avg_mse: 0.052863821387290955
current test mse: 0.052864
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012005_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012005_3_24hr.npz
NaN value num: 0
Iteration: 181, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4483334422111511
loss_pred:0.04695231840014458, decouple_loss:0.03204036504030228
The generated pressure mean: 0.44808676838874817
loss_pred:0.04977952316403389, decouple_loss:0.03255349025130272
The generated pressure mean: 0.44839170575141907
loss_pred:0.04775296524167061, decouple_loss:0.03167850151658058
Iteration: 182, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4488264322280884
loss_pred:0.04710836336016655, decouple_loss:0.028557568788528442
The generated pressure mean: 0.44758477807044983
loss_pred:0.048587772995233536, decouple_loss:0.028553957119584084
The generated pressure mean: 0.4472561478614807
loss_pred:0.04898883402347565, decouple_loss:0.02886534109711647
Iteration: 183, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44870543479919434
loss_pred:0.04947565868496895, decouple_loss:0.030688295140862465
The generated pressure mean: 0.4477235674858093
loss_pred:0.04861312359571457, decouple_loss:0.029842644929885864
The generated pressure mean: 0.4477488100528717
loss_pred:0.050681017339229584, decouple_loss:0.030318548902869225
Iteration: 184, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4481388032436371
The generated pressure mean: 0.4487854838371277
loss_pred:0.047570984810590744, decouple_loss:0.027185317128896713
loss_pred:0.04797855392098427, decouple_loss:0.027472129091620445
The generated pressure mean: 0.449144572019577
loss_pred:0.04687223210930824, decouple_loss:0.02732805907726288
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 185, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4492049813270569
loss_pred:0.04710594192147255, decouple_loss:0.027913929894566536The generated pressure mean: 0.44876736402511597
loss_pred:0.046337030827999115, decouple_loss:0.028003068640828133
The generated pressure mean: 0.4487197995185852
loss_pred:0.048015251755714417, decouple_loss:0.02883477322757244
Iteration: 186, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44635310769081116
loss_pred:0.04788050800561905, decouple_loss:0.027034888043999672
The generated pressure mean: 0.4487270712852478
The generated pressure mean: 0.4478801488876343
loss_pred:0.04471496492624283, decouple_loss:0.02748395875096321
loss_pred:0.04666746035218239, decouple_loss:0.0269992146641016
Iteration: 187, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44847413897514343
The generated pressure mean: 0.4482080042362213
loss_pred:0.04750954732298851, decouple_loss:0.029040345922112465
loss_pred:0.04704946652054787, decouple_loss:0.029236573725938797
The generated pressure mean: 0.4486894905567169
loss_pred:0.04818788543343544, decouple_loss:0.02875773422420025
Iteration: 188, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44933342933654785
loss_pred:0.04791794717311859, decouple_loss:0.026270166039466858
The generated pressure mean: 0.448775053024292
loss_pred:0.04531071335077286, decouple_loss:0.026087919250130653
The generated pressure mean: 0.448984295129776
loss_pred:0.048265255987644196, decouple_loss:0.026305515319108963
Iteration: 189, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.447951078414917
The generated pressure mean: 0.4486353099346161
loss_pred:0.04650977626442909, decouple_loss:0.02819068543612957
loss_pred:0.04754851758480072, decouple_loss:0.02935256063938141
The generated pressure mean: 0.4482963979244232
loss_pred:0.047985006123781204, decouple_loss:0.028209784999489784
Iteration: 190, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4478552043437958
The generated pressure mean: 0.4488902688026428
loss_pred:0.04761055111885071, decouple_loss:0.025475993752479553
loss_pred:0.0473393090069294, decouple_loss:0.02558526024222374
The generated pressure mean: 0.4480448067188263
loss_pred:0.04620368406176567, decouple_loss:0.025371165946125984
2023-04-16 02:04:36 testing...
The generated pressure mean: 0.4495830535888672
The generated pressure mean: 0.449788898229599
The generated pressure mean: 0.44987666606903076
loss_pred:0.04887314513325691, decouple_loss:0.027875542640686035
loss_pred:0.05000442638993263, decouple_loss:0.02767314948141575
loss_pred:0.04801538214087486, decouple_loss:0.02723548747599125
Loss: 0.05034405738115311, avg_mse: 0.05185215175151825
current test mse: 0.051852
Iteration: 191, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.449032187461853
loss_pred:0.04476577043533325, decouple_loss:0.028482861816883087
The generated pressure mean: 0.4485744833946228
loss_pred:0.04559657350182533, decouple_loss:0.026647303253412247
The generated pressure mean: 0.4477640688419342
loss_pred:0.04744992405176163, decouple_loss:0.027197157964110374
Iteration: 192, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4489459991455078
loss_pred:0.04590439051389694, decouple_loss:0.02572675794363022
The generated pressure mean: 0.4484032988548279
loss_pred:0.04789299890398979, decouple_loss:0.024485765025019646
The generated pressure mean: 0.44869399070739746
loss_pred:0.04618855193257332, decouple_loss:0.02466287650167942
Iteration: 193, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4474312961101532
loss_pred:0.04636438190937042, decouple_loss:0.027383433654904366
The generated pressure mean: 0.4471951425075531
loss_pred:0.04625995084643364, decouple_loss:0.02724597416818142
The generated pressure mean: 0.44737279415130615
loss_pred:0.04778808727860451, decouple_loss:0.027451185509562492
Iteration: 194, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44955793023109436
loss_pred:0.045542486011981964, decouple_loss:0.028023242950439453
The generated pressure mean: 0.4475170075893402
loss_pred:0.04841982573270798, decouple_loss:0.02847112901508808
The generated pressure mean: 0.4487454891204834
loss_pred:0.046013206243515015, decouple_loss:0.028242256492376328
Iteration: 195, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4487707316875458
loss_pred:0.046284183859825134, decouple_loss:0.028757845982909203
The generated pressure mean: 0.4481961727142334
The generated pressure mean: 0.4480121433734894
loss_pred:0.046373240649700165, decouple_loss:0.02868681587278843
loss_pred:0.046258602291345596, decouple_loss:0.02867073565721512
Iteration: 196, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44805780053138733
loss_pred:0.04483010247349739, decouple_loss:0.028821662068367004
The generated pressure mean: 0.44666147232055664
loss_pred:0.04668151214718819, decouple_loss:0.029285432770848274
The generated pressure mean: 0.44807833433151245
loss_pred:0.04704229533672333, decouple_loss:0.02895890362560749
Iteration: 197, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4495488703250885
The generated pressure mean: 0.4485089182853699
loss_pred:0.04564676806330681, decouple_loss:0.02623830921947956
loss_pred:0.045752622187137604, decouple_loss:0.02601926214993
The generated pressure mean: 0.44756248593330383
loss_pred:0.045404743403196335, decouple_loss:0.026349930092692375
Iteration: 198, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44863730669021606
loss_pred:0.04572875797748566, decouple_loss:0.026723308488726616
The generated pressure mean: 0.4482119381427765
loss_pred:0.044785838574171066, decouple_loss:0.026269637048244476
The generated pressure mean: 0.4482309818267822
loss_pred:0.04579317942261696, decouple_loss:0.026512788608670235
Iteration: 199, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44855940341949463
loss_pred:0.04512146860361099, decouple_loss:0.024877170100808144
The generated pressure mean: 0.44858911633491516
loss_pred:0.04654286801815033, decouple_loss:0.024436259642243385
The generated pressure mean: 0.4479963183403015
loss_pred:0.045946475118398666, decouple_loss:0.024456799030303955
Iteration: 200, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4473927617073059
loss_pred:0.046425677835941315, decouple_loss:0.025791501626372337
The generated pressure mean: 0.44862884283065796
loss_pred:0.04449083283543587, decouple_loss:0.026319142431020737
The generated pressure mean: 0.4494702219963074
loss_pred:0.04433084651827812, decouple_loss:0.026933427900075912
2023-04-16 02:06:29 testing...
The generated pressure mean: 0.4495830833911896
The generated pressure mean: 0.449788898229599
The generated pressure mean: 0.44987666606903076
loss_pred:0.048314522951841354, decouple_loss:0.027092212811112404
loss_pred:0.04899516701698303, decouple_loss:0.02669857256114483
loss_pred:0.04709988832473755, decouple_loss:0.026845261454582214
Loss: 0.049480460584163666, avg_mse: 0.05135859176516533
current test mse: 0.051359
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012006_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012006_3_24hr.npz
NaN value num: 0
Iteration: 201, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44823774695396423
loss_pred:0.04709472134709358, decouple_loss:0.02613580971956253
The generated pressure mean: 0.4466507136821747
The generated pressure mean: 0.44660720229148865
loss_pred:0.04518308490514755, decouple_loss:0.025822602212429047
loss_pred:0.045847199857234955, decouple_loss:0.02653459645807743
Iteration: 202, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44815999269485474
loss_pred:0.04667112976312637, decouple_loss:0.025314340367913246
The generated pressure mean: 0.44689297676086426
loss_pred:0.04541502520442009, decouple_loss:0.026111116632819176
The generated pressure mean: 0.4481145143508911
loss_pred:0.04492325708270073, decouple_loss:0.024962706491351128
Iteration: 203, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4484044313430786
loss_pred:0.04425127059221268, decouple_loss:0.024525608867406845
The generated pressure mean: 0.4472491145133972
loss_pred:0.047854360193014145, decouple_loss:0.025333372876048088
The generated pressure mean: 0.44754332304000854
loss_pred:0.046336568892002106, decouple_loss:0.024394948035478592
Iteration: 204, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4474565386772156
loss_pred:0.044913604855537415, decouple_loss:0.025112684816122055
The generated pressure mean: 0.4488238990306854
loss_pred:0.043985765427351, decouple_loss:0.025505349040031433
The generated pressure mean: 0.447611540555954
loss_pred:0.047140397131443024, decouple_loss:0.024985022842884064
Iteration: 205, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44732606410980225
loss_pred:0.047701187431812286, decouple_loss:0.024152511730790138
The generated pressure mean: 0.4482698142528534
loss_pred:0.04507257789373398, decouple_loss:0.0242080707103014
The generated pressure mean: 0.447311133146286
loss_pred:0.0451589971780777, decouple_loss:0.02430858090519905
Iteration: 206, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44688132405281067
loss_pred:0.04474707692861557, decouple_loss:0.023280750960111618
The generated pressure mean: 0.44832292199134827
loss_pred:0.044849373400211334, decouple_loss:0.023545952513813972
The generated pressure mean: 0.44734081625938416
loss_pred:0.046359024941921234, decouple_loss:0.02388172410428524
Iteration: 207, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4470902383327484
loss_pred:0.04495888575911522, decouple_loss:0.023732256144285202
The generated pressure mean: 0.4467688798904419
loss_pred:0.04503979533910751, decouple_loss:0.023828361183404922
The generated pressure mean: 0.4485522210597992
loss_pred:0.0445295125246048, decouple_loss:0.02272334136068821
Iteration: 208, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4471854269504547
loss_pred:0.045453570783138275, decouple_loss:0.024922234937548637
The generated pressure mean: 0.44795042276382446
loss_pred:0.04607529938220978, decouple_loss:0.024207783862948418
The generated pressure mean: 0.4473554193973541
loss_pred:0.04428267851471901, decouple_loss:0.024173816666007042
Iteration: 209, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.447831928730011
loss_pred:0.044184066355228424, decouple_loss:0.02123330533504486
The generated pressure mean: 0.4473397433757782
loss_pred:0.04504236951470375, decouple_loss:0.02180352807044983
The generated pressure mean: 0.4471207857131958
loss_pred:0.044614892452955246, decouple_loss:0.023056384176015854
Iteration: 210, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44682765007019043
loss_pred:0.04363179951906204, decouple_loss:0.022554587572813034
The generated pressure mean: 0.44653046131134033
The generated pressure mean: 0.44862890243530273
loss_pred:0.044358063489198685, decouple_loss:0.021905962377786636
loss_pred:0.04566226154565811, decouple_loss:0.02181740663945675
2023-04-16 02:08:54 testing...
The generated pressure mean: 0.4495830833911896
The generated pressure mean: 0.449788898229599
The generated pressure mean: 0.44987666606903076
loss_pred:0.04734494164586067, decouple_loss:0.022369079291820526
loss_pred:0.048308782279491425, decouple_loss:0.022097062319517136
loss_pred:0.046150095760822296, decouple_loss:0.022576984018087387
Loss: 0.04838532209396362, avg_mse: 0.050576645880937576
current test mse: 0.050577
Iteration: 211, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.446816623210907
The generated pressure mean: 0.4472900927066803
loss_pred:0.043726734817028046, decouple_loss:0.022443968802690506
loss_pred:0.04523371905088425, decouple_loss:0.022360550239682198
The generated pressure mean: 0.4480040967464447
loss_pred:0.04378534108400345, decouple_loss:0.02245795913040638
Iteration: 212, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4472769796848297
The generated pressure mean: 0.4477618634700775
loss_pred:0.04578356444835663, decouple_loss:0.022720063105225563
loss_pred:0.04389171302318573, decouple_loss:0.022769030183553696
The generated pressure mean: 0.44747069478034973
loss_pred:0.04474431276321411, decouple_loss:0.02265135943889618
Iteration: 213, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.447664350271225
The generated pressure mean: 0.44794484972953796
loss_pred:0.045392218977212906, decouple_loss:0.023020261898636818
loss_pred:0.044626519083976746, decouple_loss:0.023357534781098366
The generated pressure mean: 0.4476637840270996
loss_pred:0.04390491917729378, decouple_loss:0.023893842473626137
Iteration: 214, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44675448536872864
The generated pressure mean: 0.44688400626182556
loss_pred:0.04537598788738251, decouple_loss:0.021509671583771706
loss_pred:0.04408816620707512, decouple_loss:0.02253558486700058
The generated pressure mean: 0.44680526852607727
loss_pred:0.044837817549705505, decouple_loss:0.021678844466805458
Iteration: 215, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4479466378688812
The generated pressure mean: 0.4478028416633606
loss_pred:0.04321262612938881, decouple_loss:0.02198375016450882
loss_pred:0.04442206770181656, decouple_loss:0.022042354568839073
The generated pressure mean: 0.44723570346832275
loss_pred:0.043343327939510345, decouple_loss:0.022487349808216095
Iteration: 216, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44660675525665283
The generated pressure mean: 0.44693994522094727
loss_pred:0.04497559368610382, decouple_loss:0.026195351034402847
loss_pred:0.04407628998160362, decouple_loss:0.02561270259320736
The generated pressure mean: 0.44773998856544495
loss_pred:0.04410911351442337, decouple_loss:0.026043789461255074
Iteration: 217, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4473671317100525
The generated pressure mean: 0.4474377930164337
loss_pred:0.045992765575647354, decouple_loss:0.023253723978996277
loss_pred:0.043608617037534714, decouple_loss:0.022207949310541153
The generated pressure mean: 0.4493085741996765
loss_pred:0.04254993051290512, decouple_loss:0.022665509954094887
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 218, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44699323177337646
The generated pressure mean: 0.44814372062683105loss_pred:0.044944122433662415, decouple_loss:0.025494392961263657
loss_pred:0.04570610076189041, decouple_loss:0.025189094245433807
The generated pressure mean: 0.4474269449710846
loss_pred:0.0439913235604763, decouple_loss:0.025492018088698387
Iteration: 219, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4468086063861847
The generated pressure mean: 0.4472196102142334
loss_pred:0.04346552491188049, decouple_loss:0.022793132811784744
loss_pred:0.045111849904060364, decouple_loss:0.02247505448758602
The generated pressure mean: 0.4481635093688965
loss_pred:0.043956391513347626, decouple_loss:0.023076824843883514
Iteration: 220, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4472962021827698
The generated pressure mean: 0.44622570276260376
loss_pred:0.042645834386348724, decouple_loss:0.022903094068169594
loss_pred:0.04390444979071617, decouple_loss:0.021913213655352592
The generated pressure mean: 0.44769397377967834
loss_pred:0.043339382857084274, decouple_loss:0.022839492186903954
2023-04-16 02:10:45 testing...
The generated pressure mean: 0.4495830535888672
The generated pressure mean: 0.4497888684272766
The generated pressure mean: 0.44987666606903076
loss_pred:0.047019537538290024, decouple_loss:0.025584284216165543
loss_pred:0.04808303713798523, decouple_loss:0.025491375476121902
loss_pred:0.045909103006124496, decouple_loss:0.025863101705908775
Loss: 0.048286207020282745, avg_mse: 0.05066142603754997
current test mse: 0.050661
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012017_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012017_3_24hr.npz
NaN value num: 0
Iteration: 221, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44836118817329407
loss_pred:0.04664655774831772, decouple_loss:0.027167415246367455
The generated pressure mean: 0.44900357723236084
loss_pred:0.04743349924683571, decouple_loss:0.026922261342406273
The generated pressure mean: 0.447274774312973
loss_pred:0.04427178576588631, decouple_loss:0.02600105106830597
Iteration: 222, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4476511776447296
The generated pressure mean: 0.4478819668292999
loss_pred:0.046172935515642166, decouple_loss:0.02474844455718994
loss_pred:0.045529693365097046, decouple_loss:0.023340554907917976
The generated pressure mean: 0.4480086863040924
loss_pred:0.046257175505161285, decouple_loss:0.02445097826421261
Iteration: 223, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4493180811405182
loss_pred:0.045780982822179794, decouple_loss:0.029632965102791786
The generated pressure mean: 0.4492121636867523
loss_pred:0.04430554807186127, decouple_loss:0.0303964726626873
The generated pressure mean: 0.44885721802711487
loss_pred:0.046218279749155045, decouple_loss:0.03051145374774933
Iteration: 224, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44756242632865906
loss_pred:0.04565411061048508, decouple_loss:0.02647840604186058
The generated pressure mean: 0.44885775446891785
loss_pred:0.044416919350624084, decouple_loss:0.02543262206017971
The generated pressure mean: 0.4481185972690582
loss_pred:0.04493580013513565, decouple_loss:0.026103423908352852
Iteration: 225, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4483799636363983
loss_pred:0.04532764479517937, decouple_loss:0.02799084037542343
The generated pressure mean: 0.4498462378978729
loss_pred:0.044632572680711746, decouple_loss:0.02756703831255436
The generated pressure mean: 0.44741275906562805
loss_pred:0.0445428341627121, decouple_loss:0.02812201902270317
Iteration: 226, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4487559199333191
loss_pred:0.04641099274158478, decouple_loss:0.027239417657256126
The generated pressure mean: 0.4487735629081726
loss_pred:0.04334171488881111, decouple_loss:0.026833513751626015
The generated pressure mean: 0.44869518280029297
loss_pred:0.04483373463153839, decouple_loss:0.026613742113113403
Iteration: 227, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4478338658809662
loss_pred:0.04586000367999077, decouple_loss:0.02278417907655239
The generated pressure mean: 0.44720131158828735
loss_pred:0.04577195271849632, decouple_loss:0.022360073402523994
The generated pressure mean: 0.4483950734138489
loss_pred:0.041826821863651276, decouple_loss:0.022889625281095505
Iteration: 228, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44725847244262695
loss_pred:0.04538194462656975, decouple_loss:0.02633044309914112
The generated pressure mean: 0.4480818510055542
loss_pred:0.04486990347504616, decouple_loss:0.026675600558519363
The generated pressure mean: 0.4488871693611145
loss_pred:0.044029224663972855, decouple_loss:0.026400821283459663
Iteration: 229, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.448723167181015
loss_pred:0.045618921518325806, decouple_loss:0.02402626723051071
The generated pressure mean: 0.44714075326919556
loss_pred:0.04535384848713875, decouple_loss:0.023265622556209564
The generated pressure mean: 0.44799748063087463
loss_pred:0.045898810029029846, decouple_loss:0.02377147786319256
Iteration: 230, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4481375217437744
loss_pred:0.043169692158699036, decouple_loss:0.023401586338877678
The generated pressure mean: 0.44853323698043823
loss_pred:0.04263080656528473, decouple_loss:0.023297632113099098
The generated pressure mean: 0.4494490623474121
loss_pred:0.044383447617292404, decouple_loss:0.023008404299616814
2023-04-16 02:13:10 testing...
The generated pressure mean: 0.4495830833911896
The generated pressure mean: 0.4497888684272766
The generated pressure mean: 0.44987666606903076
loss_pred:0.04734686762094498, decouple_loss:0.0232626311480999
loss_pred:0.04923681542277336, decouple_loss:0.023139899596571922
loss_pred:0.046196408569812775, decouple_loss:0.02351888082921505
Loss: 0.048758722841739655, avg_mse: 0.052134621888399124
current test mse: 0.052135
Iteration: 231, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4495009481906891
loss_pred:0.04419843479990959, decouple_loss:0.024039138108491898
The generated pressure mean: 0.44853904843330383
loss_pred:0.04525631666183472, decouple_loss:0.023938000202178955
The generated pressure mean: 0.44782891869544983
loss_pred:0.04416912421584129, decouple_loss:0.023830752819776535
Iteration: 232, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4486500322818756
loss_pred:0.044127803295850754, decouple_loss:0.02439175359904766
The generated pressure mean: 0.44753149151802063
loss_pred:0.045011285692453384, decouple_loss:0.02419704757630825
The generated pressure mean: 0.4471893906593323
loss_pred:0.044187627732753754, decouple_loss:0.024410881102085114
Iteration: 233, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4479621946811676
loss_pred:0.04346945509314537, decouple_loss:0.026554223150014877
The generated pressure mean: 0.4486768841743469
loss_pred:0.04505029320716858, decouple_loss:0.02792498655617237
The generated pressure mean: 0.44753068685531616
loss_pred:0.042755112051963806, decouple_loss:0.027131540700793266
Iteration: 234, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44864314794540405
loss_pred:0.04157993942499161, decouple_loss:0.02324250154197216
The generated pressure mean: 0.44782161712646484
The generated pressure mean: 0.44960030913352966
loss_pred:0.0439574308693409, decouple_loss:0.022393951192498207
loss_pred:0.043859370052814484, decouple_loss:0.023097729310393333
Iteration: 235, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4489333927631378
loss_pred:0.041680943220853806, decouple_loss:0.022520704194903374
The generated pressure mean: 0.44893890619277954
loss_pred:0.04429849609732628, decouple_loss:0.02279394119977951
The generated pressure mean: 0.4490025043487549
loss_pred:0.044122111052274704, decouple_loss:0.022749686613678932
Iteration: 236, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4482285976409912
loss_pred:0.04462110251188278, decouple_loss:0.024418039247393608
The generated pressure mean: 0.4494132995605469
loss_pred:0.04334644600749016, decouple_loss:0.023905031383037567
The generated pressure mean: 0.44759809970855713
loss_pred:0.04396205395460129, decouple_loss:0.023275697603821754
Iteration: 237, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4483802318572998
loss_pred:0.044700540602207184, decouple_loss:0.023490671068429947
The generated pressure mean: 0.4488367736339569
loss_pred:0.0428537093102932, decouple_loss:0.023277971893548965
The generated pressure mean: 0.44822728633880615
loss_pred:0.04355446621775627, decouple_loss:0.024585705250501633
Iteration: 238, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4477007985115051
loss_pred:0.044105228036642075, decouple_loss:0.023065118119120598
The generated pressure mean: 0.4492904543876648
loss_pred:0.044548798352479935, decouple_loss:0.02279145084321499
The generated pressure mean: 0.44979754090309143
loss_pred:0.04491886496543884, decouple_loss:0.022541625425219536
Iteration: 239, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44682610034942627
loss_pred:0.043383706361055374, decouple_loss:0.023683536797761917
The generated pressure mean: 0.44861671328544617
loss_pred:0.04321352392435074, decouple_loss:0.02478649467229843
The generated pressure mean: 0.44788235425949097
loss_pred:0.04290107637643814, decouple_loss:0.023590940982103348
Iteration: 240, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4484681785106659
loss_pred:0.042816661298274994, decouple_loss:0.02302480675280094
The generated pressure mean: 0.44762134552001953
loss_pred:0.04397737234830856, decouple_loss:0.02348843775689602
The generated pressure mean: 0.4494127631187439
loss_pred:0.04394770413637161, decouple_loss:0.023562299087643623
2023-04-16 02:15:01 testing...
The generated pressure mean: 0.4497888684272766
The generated pressure mean: 0.4495830535888672
The generated pressure mean: 0.44987666606903076
loss_pred:0.04830310866236687, decouple_loss:0.022487284615635872
loss_pred:0.04695969447493553, decouple_loss:0.022083109244704247
loss_pred:0.04522762447595596, decouple_loss:0.02223983220756054
Loss: 0.04794364795088768, avg_mse: 0.0514674074947834
current test mse: 0.051467
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012018_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012018_3_24hr.npz
NaN value num: 0
Iteration: 241, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44811609387397766
loss_pred:0.044247761368751526, decouple_loss:0.02277454175055027
The generated pressure mean: 0.4471258223056793
loss_pred:0.043068621307611465, decouple_loss:0.022436169907450676
The generated pressure mean: 0.44788506627082825
loss_pred:0.0442504920065403, decouple_loss:0.022769369184970856
Iteration: 242, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44771313667297363
The generated pressure mean: 0.44878119230270386
loss_pred:0.04347844794392586, decouple_loss:0.024716177955269814
loss_pred:0.04288323223590851, decouple_loss:0.025199128314852715
The generated pressure mean: 0.44778382778167725
loss_pred:0.0412997268140316, decouple_loss:0.02432163991034031
Iteration: 243, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4482262134552002
loss_pred:0.04137318953871727, decouple_loss:0.021862151101231575
The generated pressure mean: 0.44806525111198425
loss_pred:0.0413915179669857, decouple_loss:0.021706456318497658
The generated pressure mean: 0.4478335976600647
loss_pred:0.042518217116594315, decouple_loss:0.021453917026519775
Iteration: 244, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44771623611450195
The generated pressure mean: 0.4475157856941223
loss_pred:0.04276319220662117, decouple_loss:0.02154969610273838
loss_pred:0.04202098026871681, decouple_loss:0.021994249895215034
The generated pressure mean: 0.44780224561691284
loss_pred:0.04293765500187874, decouple_loss:0.02226935140788555
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 245, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44749870896339417
The generated pressure mean: 0.44880369305610657loss_pred:0.04438556730747223, decouple_loss:0.020728087052702904
loss_pred:0.04477057233452797, decouple_loss:0.021610645577311516
The generated pressure mean: 0.4474197328090668
loss_pred:0.04358094558119774, decouple_loss:0.02067079395055771
Iteration: 246, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4475034475326538
loss_pred:0.043614741414785385, decouple_loss:0.021849561482667923
The generated pressure mean: 0.4478529691696167
loss_pred:0.04126012697815895, decouple_loss:0.021707741543650627
The generated pressure mean: 0.4479043781757355
loss_pred:0.040946803987026215, decouple_loss:0.021495072171092033
Iteration: 247, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44763636589050293
loss_pred:0.04274662211537361, decouple_loss:0.02090521715581417
The generated pressure mean: 0.44773542881011963
loss_pred:0.04126013070344925, decouple_loss:0.020907223224639893
The generated pressure mean: 0.4481903612613678
loss_pred:0.04094832018017769, decouple_loss:0.021029531955718994
Iteration: 248, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44751855731010437
loss_pred:0.042270366102457047, decouple_loss:0.021054590120911598
The generated pressure mean: 0.44795531034469604
loss_pred:0.04240938648581505, decouple_loss:0.021129123866558075
The generated pressure mean: 0.4477713406085968
loss_pred:0.04352094233036041, decouple_loss:0.02074378728866577
Iteration: 249, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4480687975883484
loss_pred:0.04375781491398811, decouple_loss:0.01970404013991356
The generated pressure mean: 0.44799745082855225
loss_pred:0.04197463393211365, decouple_loss:0.018973395228385925
The generated pressure mean: 0.44753900170326233
loss_pred:0.041918545961380005, decouple_loss:0.01966198720037937
Iteration: 250, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44744616746902466
loss_pred:0.043293073773384094, decouple_loss:0.020698050037026405
The generated pressure mean: 0.448001891374588
loss_pred:0.04158968850970268, decouple_loss:0.019983215257525444
The generated pressure mean: 0.44754910469055176
loss_pred:0.04237278923392296, decouple_loss:0.020544353872537613
2023-04-16 02:17:29 testing...
The generated pressure mean: 0.4495830535888672
The generated pressure mean: 0.4497888684272766
The generated pressure mean: 0.44987666606903076
loss_pred:0.045085154473781586, decouple_loss:0.019725104793906212
loss_pred:0.046426448971033096, decouple_loss:0.01969883218407631
loss_pred:0.04358432814478874, decouple_loss:0.01970783993601799
Loss: 0.04601750895380974, avg_mse: 0.04873911663889885
current test mse: 0.048739
Iteration: 251, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44811728596687317
loss_pred:0.04356568306684494, decouple_loss:0.019314277917146683
The generated pressure mean: 0.44842737913131714
loss_pred:0.04145055636763573, decouple_loss:0.019917380064725876
The generated pressure mean: 0.4481147527694702
loss_pred:0.041979435831308365, decouple_loss:0.019100619480013847
Iteration: 252, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44791799783706665
loss_pred:0.041421253234148026, decouple_loss:0.020266728475689888
The generated pressure mean: 0.44844841957092285
loss_pred:0.04150061681866646, decouple_loss:0.019534055143594742
The generated pressure mean: 0.4481336772441864
loss_pred:0.04234928637742996, decouple_loss:0.02098977193236351
Iteration: 253, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44719934463500977
loss_pred:0.04146237671375275, decouple_loss:0.019770406186580658
The generated pressure mean: 0.4477216899394989
loss_pred:0.04043828323483467, decouple_loss:0.019526250660419464
The generated pressure mean: 0.44798147678375244
loss_pred:0.04160221666097641, decouple_loss:0.019762825220823288
Iteration: 254, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.448762446641922
loss_pred:0.04153582453727722, decouple_loss:0.019258880987763405
The generated pressure mean: 0.44799932837486267
loss_pred:0.04317226633429527, decouple_loss:0.019176535308361053
The generated pressure mean: 0.4472784698009491
loss_pred:0.04105854034423828, decouple_loss:0.018544595688581467
Iteration: 255, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4476151466369629
loss_pred:0.04063458740711212, decouple_loss:0.02002040669322014
The generated pressure mean: 0.4478616714477539
loss_pred:0.04196705296635628, decouple_loss:0.02060106210410595
The generated pressure mean: 0.4483509063720703
loss_pred:0.040248822420835495, decouple_loss:0.020531361922621727
Iteration: 256, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4486851990222931
loss_pred:0.041477058082818985, decouple_loss:0.01855475828051567
The generated pressure mean: 0.449163019657135
loss_pred:0.040795691311359406, decouple_loss:0.018823374062776566
The generated pressure mean: 0.44841691851615906
loss_pred:0.040256623178720474, decouple_loss:0.017944958060979843
Iteration: 257, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44728928804397583
loss_pred:0.040351346135139465, decouple_loss:0.019973360002040863
The generated pressure mean: 0.44762691855430603
loss_pred:0.040749382227659225, decouple_loss:0.019086230546236038
The generated pressure mean: 0.44794991612434387
loss_pred:0.04101567342877388, decouple_loss:0.019954394549131393
Iteration: 258, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4482947587966919
The generated pressure mean: 0.44806361198425293
loss_pred:0.043297749012708664, decouple_loss:0.018441736698150635
loss_pred:0.04106103628873825, decouple_loss:0.018521416932344437
The generated pressure mean: 0.44741687178611755
loss_pred:0.04168625548481941, decouple_loss:0.0184188149869442
Iteration: 259, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44856056571006775
loss_pred:0.03902699798345566, decouple_loss:0.01935751363635063
The generated pressure mean: 0.44787734746932983
loss_pred:0.04138559103012085, decouple_loss:0.019501959905028343
The generated pressure mean: 0.44780269265174866
loss_pred:0.04248317331075668, decouple_loss:0.019648781046271324
Iteration: 260, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.447795033454895
loss_pred:0.04279428347945213, decouple_loss:0.018403248861432076
The generated pressure mean: 0.4483286738395691
loss_pred:0.04268635809421539, decouple_loss:0.01942761428654194
The generated pressure mean: 0.44811344146728516
loss_pred:0.04107736796140671, decouple_loss:0.020321793854236603
2023-04-16 02:19:20 testing...
The generated pressure mean: 0.4497888684272766
The generated pressure mean: 0.4495830535888672
The generated pressure mean: 0.44987666606903076
loss_pred:0.04648401215672493, decouple_loss:0.01942782662808895
loss_pred:0.0455830842256546, decouple_loss:0.019282996654510498
loss_pred:0.044234663248062134, decouple_loss:0.019588124006986618
Loss: 0.04640556871891022, avg_mse: 0.04937364533543587
current test mse: 0.049374
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012000_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012000_3_24hr.npz
NaN value num: 0
Iteration: 261, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.447029709815979
loss_pred:0.04114028066396713, decouple_loss:0.019153598695993423
The generated pressure mean: 0.4465515911579132
loss_pred:0.041233111172914505, decouple_loss:0.019627770408988
The generated pressure mean: 0.44670215249061584
loss_pred:0.04147721827030182, decouple_loss:0.019190996885299683
Iteration: 262, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44655051827430725
loss_pred:0.04303792119026184, decouple_loss:0.023268990218639374
The generated pressure mean: 0.44546037912368774
loss_pred:0.041610583662986755, decouple_loss:0.023642590269446373
The generated pressure mean: 0.44692403078079224
loss_pred:0.04194185510277748, decouple_loss:0.022876711562275887
Iteration: 263, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44737598299980164
The generated pressure mean: 0.44641056656837463
loss_pred:0.04205187410116196, decouple_loss:0.025793034583330154
loss_pred:0.04213906079530716, decouple_loss:0.02574366144835949
The generated pressure mean: 0.4455268085002899
loss_pred:0.043546244502067566, decouple_loss:0.025729160755872726
Iteration: 264, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4468916654586792
The generated pressure mean: 0.44738298654556274
loss_pred:0.04322582855820656, decouple_loss:0.02000303752720356
loss_pred:0.040657177567481995, decouple_loss:0.02031712234020233
The generated pressure mean: 0.44827795028686523
loss_pred:0.04216967150568962, decouple_loss:0.020378747954964638
Iteration: 265, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4472388029098511
loss_pred:0.04206515848636627, decouple_loss:0.02053968794643879
The generated pressure mean: 0.44916799664497375
loss_pred:0.040248800069093704, decouple_loss:0.020640872418880463
The generated pressure mean: 0.44768601655960083
loss_pred:0.04247121512889862, decouple_loss:0.021024854853749275
Iteration: 266, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4466874897480011
The generated pressure mean: 0.4455258548259735
loss_pred:0.0412595234811306, decouple_loss:0.020965874195098877
loss_pred:0.042573120445013046, decouple_loss:0.020570306107401848
The generated pressure mean: 0.44839709997177124
loss_pred:0.041013408452272415, decouple_loss:0.020490722730755806
Iteration: 267, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44630926847457886
loss_pred:0.041112300008535385, decouple_loss:0.01984412595629692
The generated pressure mean: 0.4458523094654083
loss_pred:0.03971871733665466, decouple_loss:0.020177653059363365
The generated pressure mean: 0.44633227586746216
loss_pred:0.04101945832371712, decouple_loss:0.019572246819734573
Iteration: 268, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4470798075199127
The generated pressure mean: 0.44735249876976013
loss_pred:0.04238132759928703, decouple_loss:0.019979136064648628
loss_pred:0.04111946374177933, decouple_loss:0.020050426945090294
The generated pressure mean: 0.448159784078598
loss_pred:0.04190085455775261, decouple_loss:0.02066941000521183
Iteration: 269, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4475764334201813
The generated pressure mean: 0.4478181302547455
loss_pred:0.042461831122636795, decouple_loss:0.01866122893989086
loss_pred:0.04089467227458954, decouple_loss:0.01893463544547558
The generated pressure mean: 0.44797658920288086
loss_pred:0.04192196950316429, decouple_loss:0.018729785457253456
Iteration: 270, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44844359159469604
loss_pred:0.042688243091106415, decouple_loss:0.02129150554537773
The generated pressure mean: 0.44729194045066833
loss_pred:0.04130184277892113, decouple_loss:0.021072177216410637
The generated pressure mean: 0.4461483657360077
loss_pred:0.0403955839574337, decouple_loss:0.02066686935722828
2023-04-16 02:21:46 testing...
The generated pressure mean: 0.4495830833911896
The generated pressure mean: 0.4497888684272766
The generated pressure mean: 0.44987666606903076
loss_pred:0.04427989572286606, decouple_loss:0.019547756761312485
loss_pred:0.04532451182603836, decouple_loss:0.019633201882243156
loss_pred:0.04310670867562294, decouple_loss:0.019980987533926964
Loss: 0.04522307217121124, avg_mse: 0.04790845140814781
current test mse: 0.047908
Iteration: 271, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44691750407218933
loss_pred:0.04102284833788872, decouple_loss:0.019388100132346153
The generated pressure mean: 0.4469894766807556
loss_pred:0.04018644616007805, decouple_loss:0.019108593463897705
The generated pressure mean: 0.44613558053970337
loss_pred:0.04012161120772362, decouple_loss:0.0197063647210598
Iteration: 272, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4468054175376892
loss_pred:0.04016418009996414, decouple_loss:0.019848080351948738
The generated pressure mean: 0.4475334584712982
loss_pred:0.04164418205618858, decouple_loss:0.020087795332074165
The generated pressure mean: 0.44925034046173096
loss_pred:0.04017941281199455, decouple_loss:0.020343871787190437
Iteration: 273, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44661250710487366
loss_pred:0.041815709322690964, decouple_loss:0.018417954444885254
The generated pressure mean: 0.44697317481040955
loss_pred:0.04252789914608002, decouple_loss:0.018599335104227066
The generated pressure mean: 0.4473676085472107
loss_pred:0.040123868733644485, decouple_loss:0.018827110528945923
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 274, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4471036195755005
loss_pred:0.04067346081137657, decouple_loss:0.02081144228577614
The generated pressure mean: 0.44644027948379517
loss_pred:0.041909296065568924, decouple_loss:0.020768124610185623
The generated pressure mean: 0.44786641001701355
loss_pred:0.04168026149272919, decouple_loss:0.02072305977344513
Iteration: 275, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44714266061782837
The generated pressure mean: 0.4487743079662323
loss_pred:0.0417957566678524, decouple_loss:0.020146191120147705
loss_pred:0.04029013216495514, decouple_loss:0.020610075443983078
The generated pressure mean: 0.447671502828598
loss_pred:0.0404922254383564, decouple_loss:0.020579321309924126
Iteration: 276, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4465046525001526
loss_pred:0.039882365614175797, decouple_loss:0.01965487375855446
The generated pressure mean: 0.4465123116970062
loss_pred:0.04218268021941185, decouple_loss:0.01967218704521656
The generated pressure mean: 0.4474863111972809
loss_pred:0.039709512144327164, decouple_loss:0.019198695197701454
Iteration: 277, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4470362365245819
loss_pred:0.04211807623505592, decouple_loss:0.01943095400929451
The generated pressure mean: 0.44701990485191345
loss_pred:0.042821481823921204, decouple_loss:0.018726160749793053
The generated pressure mean: 0.4482708275318146
loss_pred:0.04101354256272316, decouple_loss:0.01911686547100544
Iteration: 278, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4473969638347626
loss_pred:0.04215895012021065, decouple_loss:0.020828833803534508
The generated pressure mean: 0.4480457603931427
loss_pred:0.04208853095769882, decouple_loss:0.021079372614622116
The generated pressure mean: 0.44876816868782043
loss_pred:0.0399705171585083, decouple_loss:0.02110319584608078
Iteration: 279, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44767534732818604
loss_pred:0.040088310837745667, decouple_loss:0.019047563895583153
The generated pressure mean: 0.44717806577682495
loss_pred:0.040086857974529266, decouple_loss:0.019506005570292473
The generated pressure mean: 0.4466387629508972
loss_pred:0.03958471119403839, decouple_loss:0.019216090440750122
Iteration: 280, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44645529985427856
The generated pressure mean: 0.4467405080795288
loss_pred:0.03963003307580948, decouple_loss:0.01962064579129219
loss_pred:0.040415674448013306, decouple_loss:0.01902597025036812
The generated pressure mean: 0.44786253571510315
loss_pred:0.039750486612319946, decouple_loss:0.01993033103644848
2023-04-16 02:23:38 testing...
The generated pressure mean: 0.4495830535888672
The generated pressure mean: 0.4497888684272766
The generated pressure mean: 0.44987666606903076
loss_pred:0.04474038630723953, decouple_loss:0.019251275807619095
loss_pred:0.04577336832880974, decouple_loss:0.01914837397634983
loss_pred:0.04347337409853935, decouple_loss:0.01953727751970291
Loss: 0.04562799260020256, avg_mse: 0.04917673021554947
current test mse: 0.049177
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012006_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012006_3_24hr.npz
NaN value num: 0
Iteration: 281, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44882193207740784
loss_pred:0.04268159344792366, decouple_loss:0.020594792440533638
The generated pressure mean: 0.44858604669570923
The generated pressure mean: 0.4485749304294586
loss_pred:0.04281726852059364, decouple_loss:0.020419612526893616
loss_pred:0.04201333224773407, decouple_loss:0.01979273185133934
Iteration: 282, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4499695599079132
The generated pressure mean: 0.44884926080703735
loss_pred:0.04408011585474014, decouple_loss:0.0207813810557127
loss_pred:0.04440635070204735, decouple_loss:0.02069292776286602
The generated pressure mean: 0.44840681552886963
loss_pred:0.04397469013929367, decouple_loss:0.02129996195435524
Iteration: 283, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4486697316169739
The generated pressure mean: 0.4487597942352295loss_pred:0.04306032136082649, decouple_loss:0.020630061626434326
loss_pred:0.042794518172740936, decouple_loss:0.01824510470032692
The generated pressure mean: 0.44744542241096497
loss_pred:0.04461418837308884, decouple_loss:0.020019905641674995
Iteration: 284, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4480856955051422
The generated pressure mean: 0.4480079710483551
loss_pred:0.04207579046487808, decouple_loss:0.02096133679151535
loss_pred:0.04212198778986931, decouple_loss:0.020388107746839523
The generated pressure mean: 0.4497270882129669
loss_pred:0.043885331600904465, decouple_loss:0.021430950611829758
Iteration: 285, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4479890465736389
The generated pressure mean: 0.4485201835632324
loss_pred:0.04324507340788841, decouple_loss:0.023343577980995178
loss_pred:0.043054983019828796, decouple_loss:0.023077601566910744
The generated pressure mean: 0.44971179962158203
loss_pred:0.04222317785024643, decouple_loss:0.022061752155423164
Iteration: 286, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44835829734802246
loss_pred:0.043304357677698135, decouple_loss:0.01997474581003189
The generated pressure mean: 0.44792136549949646
loss_pred:0.04193902015686035, decouple_loss:0.0211078729480505
The generated pressure mean: 0.4483506977558136
loss_pred:0.04311267286539078, decouple_loss:0.019748765975236893
Iteration: 287, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4494444727897644
The generated pressure mean: 0.44877612590789795loss_pred:0.04261879250407219, decouple_loss:0.01931462623178959
loss_pred:0.04213019087910652, decouple_loss:0.01965898647904396
The generated pressure mean: 0.44917070865631104
loss_pred:0.04275909438729286, decouple_loss:0.02210920862853527
Iteration: 288, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4501950442790985
loss_pred:0.04194321483373642, decouple_loss:0.02052856981754303
The generated pressure mean: 0.44793662428855896
loss_pred:0.039208825677633286, decouple_loss:0.020257558673620224
The generated pressure mean: 0.44944050908088684
loss_pred:0.041960589587688446, decouple_loss:0.01994812674820423
Iteration: 289, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4485422968864441
The generated pressure mean: 0.4476096034049988loss_pred:0.04048189893364906, decouple_loss:0.019401943311095238
loss_pred:0.04334444925189018, decouple_loss:0.02129998989403248
The generated pressure mean: 0.44945159554481506
loss_pred:0.04103957489132881, decouple_loss:0.020089544355869293
Iteration: 290, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4488055408000946
loss_pred:0.04200003668665886, decouple_loss:0.019015265628695488
The generated pressure mean: 0.4485883116722107
loss_pred:0.04403481259942055, decouple_loss:0.01964479498565197
The generated pressure mean: 0.4484126567840576
loss_pred:0.040723610669374466, decouple_loss:0.019012480974197388
2023-04-16 02:26:02 testing...
The generated pressure mean: 0.449788898229599
The generated pressure mean: 0.4495830833911896
The generated pressure mean: 0.44987666606903076
loss_pred:0.046729717403650284, decouple_loss:0.020911168307065964
loss_pred:0.04603816568851471, decouple_loss:0.020720846951007843
loss_pred:0.04512036591768265, decouple_loss:0.02075044810771942
Loss: 0.047002457082271576, avg_mse: 0.051946647465229034
current test mse: 0.051947
Iteration: 291, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44786936044692993
The generated pressure mean: 0.44761672616004944
loss_pred:0.0412578210234642, decouple_loss:0.021003972738981247
loss_pred:0.040319837629795074, decouple_loss:0.020307259634137154
The generated pressure mean: 0.4471559226512909
loss_pred:0.043166618794202805, decouple_loss:0.02156449295580387
Iteration: 292, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44782352447509766
The generated pressure mean: 0.4476867914199829
loss_pred:0.039269354194402695, decouple_loss:0.01997765526175499
loss_pred:0.04174257069826126, decouple_loss:0.020970582962036133
The generated pressure mean: 0.4489496946334839
loss_pred:0.040700752288103104, decouple_loss:0.019724074751138687
Iteration: 293, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4492274224758148
The generated pressure mean: 0.44877639412879944
loss_pred:0.041334133595228195, decouple_loss:0.021542076021432877
loss_pred:0.03983417525887489, decouple_loss:0.02118670381605625
The generated pressure mean: 0.4473377764225006
loss_pred:0.04172586277127266, decouple_loss:0.02150912582874298
Iteration: 294, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44784510135650635
The generated pressure mean: 0.4481750428676605
loss_pred:0.041298944503068924, decouple_loss:0.020872119814157486
loss_pred:0.04107046499848366, decouple_loss:0.0202729981392622
The generated pressure mean: 0.4474776089191437
loss_pred:0.04336284101009369, decouple_loss:0.02173328399658203
Iteration: 295, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.448650598526001
The generated pressure mean: 0.44897907972335815
loss_pred:0.04012889787554741, decouple_loss:0.02250940166413784
loss_pred:0.04103754460811615, decouple_loss:0.022125443443655968
The generated pressure mean: 0.4479455053806305
loss_pred:0.04105215147137642, decouple_loss:0.02280726470053196
Iteration: 296, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44914141297340393
loss_pred:0.04025113210082054, decouple_loss:0.019556861370801926
The generated pressure mean: 0.44923079013824463
loss_pred:0.04390540346503258, decouple_loss:0.019530486315488815
The generated pressure mean: 0.4484025537967682
loss_pred:0.04176655411720276, decouple_loss:0.020320149138569832
Iteration: 297, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44868409633636475
The generated pressure mean: 0.44895660877227783
loss_pred:0.040552444756031036, decouple_loss:0.02295405976474285
loss_pred:0.03916579857468605, decouple_loss:0.022678257897496223
The generated pressure mean: 0.44849711656570435
loss_pred:0.04112612083554268, decouple_loss:0.0235256589949131
Iteration: 298, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.448161780834198
The generated pressure mean: 0.4477083086967468
loss_pred:0.04156016185879707, decouple_loss:0.020695582032203674
loss_pred:0.039661016315221786, decouple_loss:0.020617738366127014
The generated pressure mean: 0.4481826722621918
loss_pred:0.04394789785146713, decouple_loss:0.021388009190559387
Iteration: 299, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4487152099609375
The generated pressure mean: 0.4484231173992157
loss_pred:0.04172876477241516, decouple_loss:0.02423773892223835
loss_pred:0.04079972952604294, decouple_loss:0.02394399605691433
The generated pressure mean: 0.4478321671485901
loss_pred:0.03911513090133667, decouple_loss:0.023428844287991524
Iteration: 300, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44917911291122437
The generated pressure mean: 0.44881996512413025
loss_pred:0.04132695496082306, decouple_loss:0.021941782906651497
loss_pred:0.04116016998887062, decouple_loss:0.022027499973773956
The generated pressure mean: 0.44808343052864075
loss_pred:0.0406445637345314, decouple_loss:0.02229016274213791
2023-04-16 02:27:54 testing...
The generated pressure mean: 0.4495830833911896
The generated pressure mean: 0.4497888684272766
The generated pressure mean: 0.44987666606903076
loss_pred:0.04717365652322769, decouple_loss:0.024659669026732445
loss_pred:0.047820333391427994, decouple_loss:0.024905212223529816
loss_pred:0.046339184045791626, decouple_loss:0.024649158120155334
Loss: 0.04834796115756035, avg_mse: 0.05447928607463837
current test mse: 0.054479
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012020_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012020_3_24hr.npz
NaN value num: 0
Iteration: 301, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4496549367904663
loss_pred:0.03974677994847298, decouple_loss:0.024836465716362
The generated pressure mean: 0.45015162229537964
loss_pred:0.041851457208395004, decouple_loss:0.02504752390086651
The generated pressure mean: 0.44935041666030884
loss_pred:0.039624691009521484, decouple_loss:0.025584189221262932
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 302, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44947323203086853
loss_pred:0.04109947010874748, decouple_loss:0.023070799186825752
The generated pressure mean: 0.4507904052734375
loss_pred:0.04300790652632713, decouple_loss:0.023153159767389297
The generated pressure mean: 0.44940319657325745
loss_pred:0.040044814348220825, decouple_loss:0.023295219987630844
Iteration: 303, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44940632581710815
loss_pred:0.04031936079263687, decouple_loss:0.024400142952799797
The generated pressure mean: 0.4489690959453583
The generated pressure mean: 0.4501695930957794
loss_pred:0.04057204723358154, decouple_loss:0.023943999782204628
loss_pred:0.04349558427929878, decouple_loss:0.024827180430293083
Iteration: 304, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45008423924446106
loss_pred:0.04317789897322655, decouple_loss:0.02280595898628235
The generated pressure mean: 0.44990211725234985
The generated pressure mean: 0.4508281350135803
loss_pred:0.0409744493663311, decouple_loss:0.022874336689710617
loss_pred:0.04245669022202492, decouple_loss:0.022563306614756584
Iteration: 305, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45010730624198914
loss_pred:0.04101339355111122, decouple_loss:0.023564931005239487
The generated pressure mean: 0.45025718212127686
loss_pred:0.0407792404294014, decouple_loss:0.02353799343109131
The generated pressure mean: 0.4502818286418915
loss_pred:0.04219159483909607, decouple_loss:0.023793542757630348
Iteration: 306, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4498880207538605
loss_pred:0.04057265818119049, decouple_loss:0.024458272382616997
The generated pressure mean: 0.4492187201976776
The generated pressure mean: 0.44812899827957153
loss_pred:0.04160827770829201, decouple_loss:0.02421855367720127
loss_pred:0.041525617241859436, decouple_loss:0.024838633835315704
Iteration: 307, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4512348771095276
loss_pred:0.0409725159406662, decouple_loss:0.025872863829135895
The generated pressure mean: 0.4491085708141327
loss_pred:0.041181791573762894, decouple_loss:0.025469643995165825
The generated pressure mean: 0.4495578706264496
loss_pred:0.03919181600213051, decouple_loss:0.025090394541621208
Iteration: 308, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4504680335521698
loss_pred:0.042876992374658585, decouple_loss:0.023341117426753044
The generated pressure mean: 0.4497264325618744
The generated pressure mean: 0.4493504762649536
loss_pred:0.04071284085512161, decouple_loss:0.0228640865534544
loss_pred:0.04102984815835953, decouple_loss:0.023283885791897774
Iteration: 309, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45044729113578796
loss_pred:0.041083939373493195, decouple_loss:0.02958495169878006
The generated pressure mean: 0.4498020112514496
The generated pressure mean: 0.44969967007637024
loss_pred:0.040195390582084656, decouple_loss:0.029845694079995155
loss_pred:0.04115152731537819, decouple_loss:0.02976175770163536
Iteration: 310, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44966641068458557
loss_pred:0.038920145481824875, decouple_loss:0.02558976784348488
The generated pressure mean: 0.450135201215744
The generated pressure mean: 0.44868531823158264
loss_pred:0.04109435901045799, decouple_loss:0.02538410574197769
loss_pred:0.041226983070373535, decouple_loss:0.025635508820414543
2023-04-16 02:30:29 testing...
The generated pressure mean: 0.4495830237865448
The generated pressure mean: 0.449788898229599
The generated pressure mean: 0.44987666606903076
loss_pred:0.043675221502780914, decouple_loss:0.02724834531545639
loss_pred:0.044915106147527695, decouple_loss:0.027199577540159225
loss_pred:0.04273517057299614, decouple_loss:0.02720765955746174
Loss: 0.045136094093322754, avg_mse: 0.04849197342991829
current test mse: 0.048492
Iteration: 311, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4489012062549591
loss_pred:0.03930669277906418, decouple_loss:0.026912692934274673
The generated pressure mean: 0.4499345123767853
loss_pred:0.04005342349410057, decouple_loss:0.027463242411613464
The generated pressure mean: 0.4503428041934967
loss_pred:0.040434472262859344, decouple_loss:0.026620641350746155
Iteration: 312, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4505214989185333
loss_pred:0.04274484142661095, decouple_loss:0.02647605538368225
The generated pressure mean: 0.4493340849876404
loss_pred:0.040501467883586884, decouple_loss:0.026028746739029884
The generated pressure mean: 0.450380802154541
loss_pred:0.04123242199420929, decouple_loss:0.02584095299243927
Iteration: 313, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44958531856536865
loss_pred:0.039939310401678085, decouple_loss:0.02516827918589115
The generated pressure mean: 0.44924840331077576
loss_pred:0.042192816734313965, decouple_loss:0.02549443207681179
The generated pressure mean: 0.44872456789016724
loss_pred:0.03990086913108826, decouple_loss:0.02511327713727951
Iteration: 314, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4507172703742981
loss_pred:0.04114990308880806, decouple_loss:0.02405640110373497
The generated pressure mean: 0.4507772922515869
loss_pred:0.03985340893268585, decouple_loss:0.023509429767727852
The generated pressure mean: 0.45019662380218506
loss_pred:0.041702814400196075, decouple_loss:0.023958437144756317
Iteration: 315, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4493539035320282The generated pressure mean: 0.44925618171691895
loss_pred:0.03938562795519829, decouple_loss:0.02347532846033573
loss_pred:0.03986175358295441, decouple_loss:0.024236900731921196
The generated pressure mean: 0.4498622715473175
loss_pred:0.0391361303627491, decouple_loss:0.023504337295889854
Iteration: 316, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4506218135356903
The generated pressure mean: 0.4491356611251831
loss_pred:0.04043928161263466, decouple_loss:0.021058250218629837
loss_pred:0.04112349450588226, decouple_loss:0.021199384704232216
The generated pressure mean: 0.4501035213470459
loss_pred:0.04211340472102165, decouple_loss:0.020951129496097565
Iteration: 317, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44861218333244324The generated pressure mean: 0.45068731904029846
loss_pred:0.040527570992708206, decouple_loss:0.02401137724518776
loss_pred:0.04170116409659386, decouple_loss:0.024109119549393654
The generated pressure mean: 0.4487124979496002
loss_pred:0.0393635593354702, decouple_loss:0.0238057728856802
Iteration: 318, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4502379894256592
loss_pred:0.040340203791856766, decouple_loss:0.019513579085469246
The generated pressure mean: 0.44821521639823914
loss_pred:0.040893908590078354, decouple_loss:0.019412720575928688
The generated pressure mean: 0.44904807209968567
loss_pred:0.038364753127098083, decouple_loss:0.019374210387468338
Iteration: 319, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4497753381729126
The generated pressure mean: 0.4505953788757324
loss_pred:0.04166360944509506, decouple_loss:0.02274959348142147
loss_pred:0.04127729311585426, decouple_loss:0.02322564460337162
The generated pressure mean: 0.4494397044181824
loss_pred:0.03960978239774704, decouple_loss:0.021793028339743614
Iteration: 320, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4496612548828125
The generated pressure mean: 0.45014554262161255
loss_pred:0.041660696268081665, decouple_loss:0.02045242302119732
loss_pred:0.04001101106405258, decouple_loss:0.020088501274585724
The generated pressure mean: 0.4487113654613495
loss_pred:0.039790935814380646, decouple_loss:0.020669929683208466
2023-04-16 02:32:21 testing...
The generated pressure mean: 0.4495830833911896
The generated pressure mean: 0.4497888684272766
The generated pressure mean: 0.44987666606903076
loss_pred:0.04343702644109726, decouple_loss:0.020453186705708504
loss_pred:0.04454374313354492, decouple_loss:0.02053695172071457
loss_pred:0.04239177703857422, decouple_loss:0.020756646990776062
Loss: 0.044486626982688904, avg_mse: 0.04817952588200569
current test mse: 0.04818
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012013_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012013_3_24hr.npz
NaN value num: 0
Iteration: 321, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4470585882663727
loss_pred:0.038524363189935684, decouple_loss:0.020282359793782234
The generated pressure mean: 0.447532594203949
loss_pred:0.04083112254738808, decouple_loss:0.02036605402827263
The generated pressure mean: 0.4475697875022888
loss_pred:0.038215961307287216, decouple_loss:0.0205171350389719
Iteration: 322, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4472411274909973
loss_pred:0.04059813544154167, decouple_loss:0.020671488717198372
The generated pressure mean: 0.4474700391292572
loss_pred:0.03907959535717964, decouple_loss:0.020668238401412964
The generated pressure mean: 0.44773462414741516
loss_pred:0.039253439754247665, decouple_loss:0.020436281338334084
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 323, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4467221796512604
loss_pred:0.04107385873794556, decouple_loss:0.01987246237695217
The generated pressure mean: 0.4474562704563141
loss_pred:0.0410754531621933, decouple_loss:0.019740469753742218
The generated pressure mean: 0.4472186267375946
loss_pred:0.040031470358371735, decouple_loss:0.019207682460546494
Iteration: 324, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4474034011363983
loss_pred:0.041060373187065125, decouple_loss:0.020948119461536407
The generated pressure mean: 0.44697147607803345
loss_pred:0.040083080530166626, decouple_loss:0.02239242196083069
The generated pressure mean: 0.44668832421302795
loss_pred:0.04130177199840546, decouple_loss:0.020446298643946648
Iteration: 325, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.446501761674881
loss_pred:0.040957361459732056, decouple_loss:0.020169848576188087
The generated pressure mean: 0.4458150565624237
loss_pred:0.041003648191690445, decouple_loss:0.019185354933142662
The generated pressure mean: 0.4461185932159424
loss_pred:0.0404508002102375, decouple_loss:0.02003200724720955
Iteration: 326, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44626617431640625
loss_pred:0.039179280400276184, decouple_loss:0.019275877624750137
The generated pressure mean: 0.4473629295825958
loss_pred:0.040003202855587006, decouple_loss:0.01927725225687027
The generated pressure mean: 0.4465397000312805
loss_pred:0.03991255909204483, decouple_loss:0.01985207200050354
Iteration: 327, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4463847279548645
loss_pred:0.03892552852630615, decouple_loss:0.01986600086092949
The generated pressure mean: 0.44678181409835815
loss_pred:0.03913124278187752, decouple_loss:0.019755998626351357
The generated pressure mean: 0.4477161765098572
loss_pred:0.03701480105519295, decouple_loss:0.02003948763012886
Iteration: 328, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44725653529167175
loss_pred:0.0388171412050724, decouple_loss:0.01927623338997364
The generated pressure mean: 0.44654765725135803
loss_pred:0.039543524384498596, decouple_loss:0.019307028502225876
The generated pressure mean: 0.445743203163147
loss_pred:0.0395212396979332, decouple_loss:0.01941792108118534
Iteration: 329, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44622835516929626
loss_pred:0.040382020175457, decouple_loss:0.019720491021871567
The generated pressure mean: 0.44695645570755005
loss_pred:0.038825925439596176, decouple_loss:0.01934933289885521
The generated pressure mean: 0.44658491015434265
loss_pred:0.03954194486141205, decouple_loss:0.019077813252806664
Iteration: 330, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44699209928512573
loss_pred:0.039137937128543854, decouple_loss:0.018382951617240906
The generated pressure mean: 0.44720005989074707
loss_pred:0.038801778107881546, decouple_loss:0.019445963203907013
The generated pressure mean: 0.4478497803211212
loss_pred:0.03955985978245735, decouple_loss:0.020630016922950745
2023-04-16 02:34:52 testing...
The generated pressure mean: 0.4495830535888672
The generated pressure mean: 0.449788898229599
The generated pressure mean: 0.4498766362667084
loss_pred:0.0430932343006134, decouple_loss:0.01937609538435936
loss_pred:0.04439213126897812, decouple_loss:0.019574511796236038
loss_pred:0.04197224974632263, decouple_loss:0.019281726330518723
Loss: 0.044123079627752304, avg_mse: 0.047859400510787964
current test mse: 0.047859
Iteration: 331, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4466501772403717
The generated pressure mean: 0.44630756974220276
loss_pred:0.03870290517807007, decouple_loss:0.01907840371131897
loss_pred:0.03888275474309921, decouple_loss:0.01904214918613434
The generated pressure mean: 0.4462556838989258
loss_pred:0.03915441036224365, decouple_loss:0.019019991159439087
Iteration: 332, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44708752632141113
loss_pred:0.039354000240564346, decouple_loss:0.01825379766523838
The generated pressure mean: 0.4466029703617096
loss_pred:0.039512064307928085, decouple_loss:0.019488343968987465
The generated pressure mean: 0.4464870095252991
loss_pred:0.03989157825708389, decouple_loss:0.017827415838837624
Iteration: 333, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4476061463356018
loss_pred:0.03951066732406616, decouple_loss:0.019859356805682182
The generated pressure mean: 0.44697555899620056
loss_pred:0.03935123234987259, decouple_loss:0.018586868420243263
The generated pressure mean: 0.44697436690330505
loss_pred:0.03842202201485634, decouple_loss:0.019674161449074745
Iteration: 334, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4465186297893524
loss_pred:0.03922867774963379, decouple_loss:0.01835440658032894
The generated pressure mean: 0.4476163685321808
loss_pred:0.03928060829639435, decouple_loss:0.01896827667951584
The generated pressure mean: 0.4475097954273224
loss_pred:0.040391113609075546, decouple_loss:0.01948559656739235
Iteration: 335, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44701579213142395
loss_pred:0.039670947939157486, decouple_loss:0.01935875602066517
The generated pressure mean: 0.4465055763721466
loss_pred:0.039692312479019165, decouple_loss:0.018917188048362732
The generated pressure mean: 0.44652870297431946
loss_pred:0.037384431809186935, decouple_loss:0.01861748658120632
Iteration: 336, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44666650891304016
loss_pred:0.03955206647515297, decouple_loss:0.0201386958360672
The generated pressure mean: 0.4455907940864563
loss_pred:0.038555808365345, decouple_loss:0.019844654947519302
The generated pressure mean: 0.4459882378578186
loss_pred:0.038554295897483826, decouple_loss:0.019724279642105103
Iteration: 337, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44710981845855713
loss_pred:0.04016941413283348, decouple_loss:0.020762670785188675
The generated pressure mean: 0.446078360080719
loss_pred:0.03876197338104248, decouple_loss:0.01968918740749359
The generated pressure mean: 0.4456627666950226
loss_pred:0.03949718177318573, decouple_loss:0.01920841820538044
Iteration: 338, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44724833965301514
loss_pred:0.039269424974918365, decouple_loss:0.019262125715613365
The generated pressure mean: 0.44590476155281067
loss_pred:0.039393436163663864, decouple_loss:0.018880391493439674
The generated pressure mean: 0.44795098900794983
loss_pred:0.04020807147026062, decouple_loss:0.020299674943089485
Iteration: 339, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44661709666252136
loss_pred:0.039452724158763885, decouple_loss:0.021383309736847878
The generated pressure mean: 0.4463469982147217
loss_pred:0.037879977375268936, decouple_loss:0.021339774131774902
The generated pressure mean: 0.44674399495124817
loss_pred:0.039265669882297516, decouple_loss:0.021548671647906303
Iteration: 340, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44624581933021545
loss_pred:0.038668323308229446, decouple_loss:0.018479246646165848
The generated pressure mean: 0.4475902318954468
loss_pred:0.04010044038295746, decouple_loss:0.01944235898554325
The generated pressure mean: 0.44677552580833435
loss_pred:0.03887738287448883, decouple_loss:0.019262580201029778
2023-04-16 02:36:44 testing...
The generated pressure mean: 0.4497888684272766
The generated pressure mean: 0.4495830833911896
The generated pressure mean: 0.44987666606903076
loss_pred:0.04403040558099747, decouple_loss:0.02042439579963684
loss_pred:0.042907338589429855, decouple_loss:0.020373310893774033loss_pred:0.04181066155433655, decouple_loss:0.020709402859210968
Loss: 0.043941255658864975, avg_mse: 0.04769216105341911
current test mse: 0.047692
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012014_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012014_3_24hr.npz
NaN value num: 0
Iteration: 341, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.447806179523468
loss_pred:0.04128122702240944, decouple_loss:0.021420370787382126
The generated pressure mean: 0.4475277066230774
The generated pressure mean: 0.44758838415145874
loss_pred:0.0397011898458004, decouple_loss:0.020400477573275566
loss_pred:0.03958282992243767, decouple_loss:0.02057933807373047
Iteration: 342, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4470638036727905
loss_pred:0.042725518345832825, decouple_loss:0.020460091531276703
The generated pressure mean: 0.44722214341163635
loss_pred:0.03902633488178253, decouple_loss:0.019081559032201767
The generated pressure mean: 0.44771137833595276
loss_pred:0.04073913395404816, decouple_loss:0.019321374595165253
Iteration: 343, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4474486708641052
loss_pred:0.04140784591436386, decouple_loss:0.019491979852318764
The generated pressure mean: 0.4475630223751068
loss_pred:0.04057624563574791, decouple_loss:0.020526763051748276
The generated pressure mean: 0.4466997981071472
loss_pred:0.0421825610101223, decouple_loss:0.019066182896494865
Iteration: 344, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44617268443107605
loss_pred:0.03947386518120766, decouple_loss:0.02119862288236618
The generated pressure mean: 0.44773659110069275
loss_pred:0.04118737578392029, decouple_loss:0.021410347893834114
The generated pressure mean: 0.4482654631137848
loss_pred:0.041738756000995636, decouple_loss:0.021495996043086052
Iteration: 345, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4476114511489868
The generated pressure mean: 0.44838187098503113
loss_pred:0.040472254157066345, decouple_loss:0.0179008599370718
loss_pred:0.04153796285390854, decouple_loss:0.01952735148370266
The generated pressure mean: 0.4482875466346741
loss_pred:0.039706893265247345, decouple_loss:0.018246976658701897
Iteration: 346, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44694724678993225
loss_pred:0.039688628166913986, decouple_loss:0.023576324805617332
The generated pressure mean: 0.4468141496181488
loss_pred:0.03998614102602005, decouple_loss:0.022619489580392838
The generated pressure mean: 0.4487305283546448
loss_pred:0.041348233819007874, decouple_loss:0.023146750405430794
Iteration: 347, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4489087760448456
The generated pressure mean: 0.44829726219177246
loss_pred:0.040239691734313965, decouple_loss:0.018509844318032265
loss_pred:0.04267141595482826, decouple_loss:0.01766144298017025
The generated pressure mean: 0.44723835587501526
loss_pred:0.03959326073527336, decouple_loss:0.01867971010506153
Iteration: 348, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44612351059913635
The generated pressure mean: 0.44696974754333496
loss_pred:0.040030337870121, decouple_loss:0.02097249962389469
loss_pred:0.039700619876384735, decouple_loss:0.020818153396248817
The generated pressure mean: 0.4473407566547394
loss_pred:0.04102949798107147, decouple_loss:0.020451346412301064
Iteration: 349, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4477286636829376
The generated pressure mean: 0.4473603367805481loss_pred:0.03989610821008682, decouple_loss:0.017598344013094902
loss_pred:0.04066538065671921, decouple_loss:0.018007073551416397
The generated pressure mean: 0.4488472044467926
loss_pred:0.039469536393880844, decouple_loss:0.01791987754404545
Iteration: 350, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4477446675300598
loss_pred:0.039103079587221146, decouple_loss:0.018634160980582237
The generated pressure mean: 0.4479805529117584
loss_pred:0.040613818913698196, decouple_loss:0.018952660262584686
The generated pressure mean: 0.4475400745868683
loss_pred:0.03810257837176323, decouple_loss:0.018422894179821014
2023-04-16 02:39:23 testing...
The generated pressure mean: 0.4495830535888672
The generated pressure mean: 0.4497888684272766
The generated pressure mean: 0.44987666606903076
loss_pred:0.043546948581933975, decouple_loss:0.018819907680153847
loss_pred:0.04436526075005531, decouple_loss:0.018917009234428406
loss_pred:0.042171139270067215, decouple_loss:0.019273536279797554
Loss: 0.044311296194791794, avg_mse: 0.04894395172595978
current test mse: 0.048944
Iteration: 351, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4473842680454254
loss_pred:0.039827216416597366, decouple_loss:0.02085607312619686
The generated pressure mean: 0.4476693272590637
loss_pred:0.03918854519724846, decouple_loss:0.01838470809161663
The generated pressure mean: 0.4483383893966675
loss_pred:0.03984174132347107, decouple_loss:0.019906368106603622
Iteration: 352, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4478815495967865
loss_pred:0.03898419439792633, decouple_loss:0.01743152178823948
The generated pressure mean: 0.4472610652446747
loss_pred:0.03990225866436958, decouple_loss:0.016583256423473358
The generated pressure mean: 0.44783878326416016
loss_pred:0.040935758501291275, decouple_loss:0.016497138887643814
Iteration: 353, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4481663703918457
loss_pred:0.03849341347813606, decouple_loss:0.01962100900709629
The generated pressure mean: 0.44737327098846436
loss_pred:0.0393991582095623, decouple_loss:0.019863877445459366
The generated pressure mean: 0.44712865352630615
loss_pred:0.03913237899541855, decouple_loss:0.019680850207805634
Iteration: 354, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44822150468826294
loss_pred:0.03797311335802078, decouple_loss:0.017371080815792084
The generated pressure mean: 0.4477596580982208
loss_pred:0.04038827866315842, decouple_loss:0.01754532940685749
The generated pressure mean: 0.44744864106178284
loss_pred:0.041234999895095825, decouple_loss:0.01754111610352993
Iteration: 355, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4472672641277313
loss_pred:0.03858514875173569, decouple_loss:0.01800135150551796
The generated pressure mean: 0.44775915145874023
loss_pred:0.03984373062849045, decouple_loss:0.018263714388012886
The generated pressure mean: 0.4480758309364319
loss_pred:0.03895676136016846, decouple_loss:0.018370557576417923
Iteration: 356, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4476584494113922
loss_pred:0.03902445361018181, decouple_loss:0.019246021285653114
The generated pressure mean: 0.4490087032318115
loss_pred:0.039580829441547394, decouple_loss:0.018607184290885925
The generated pressure mean: 0.44713616371154785
loss_pred:0.03939840942621231, decouple_loss:0.01895994320511818
Iteration: 357, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4472653865814209
The generated pressure mean: 0.44780266284942627loss_pred:0.04175124317407608, decouple_loss:0.017465833574533463
loss_pred:0.04034276306629181, decouple_loss:0.017067449167370796
The generated pressure mean: 0.44856175780296326
loss_pred:0.04164838418364525, decouple_loss:0.01727558858692646
Iteration: 358, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44831040501594543
The generated pressure mean: 0.4473441243171692
loss_pred:0.039144277572631836, decouple_loss:0.017368324100971222
loss_pred:0.04051737114787102, decouple_loss:0.0169838797301054
The generated pressure mean: 0.44658082723617554
loss_pred:0.03865288570523262, decouple_loss:0.017037952318787575
Iteration: 359, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4474266767501831
loss_pred:0.040040697902441025, decouple_loss:0.017079249024391174
The generated pressure mean: 0.4477505683898926
loss_pred:0.04032708331942558, decouple_loss:0.0171176940202713
The generated pressure mean: 0.4478708803653717
loss_pred:0.04007788002490997, decouple_loss:0.017965951934456825
Iteration: 360, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44683799147605896
loss_pred:0.039152227342128754, decouple_loss:0.017818210646510124
The generated pressure mean: 0.4471328556537628
loss_pred:0.03900571167469025, decouple_loss:0.01771559752523899
The generated pressure mean: 0.44754454493522644
loss_pred:0.03776666149497032, decouple_loss:0.016909832134842873
2023-04-16 02:41:17 testing...
The generated pressure mean: 0.4495830535888672
The generated pressure mean: 0.449788898229599
The generated pressure mean: 0.44987666606903076
loss_pred:0.04281798005104065, decouple_loss:0.016620339825749397
loss_pred:0.04378236085176468, decouple_loss:0.016996532678604126
loss_pred:0.04167797788977623, decouple_loss:0.016723036766052246
Loss: 0.043598439544439316, avg_mse: 0.04810354486107826
current test mse: 0.048104
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012012_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012012_3_24hr.npz
NaN value num: 0
Iteration: 361, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4461408257484436
loss_pred:0.0377143993973732, decouple_loss:0.01659468747675419
The generated pressure mean: 0.44603610038757324
loss_pred:0.03962687775492668, decouple_loss:0.017491279169917107
The generated pressure mean: 0.44670340418815613
loss_pred:0.03876892849802971, decouple_loss:0.01757633313536644
Iteration: 362, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4468885660171509
loss_pred:0.03902429714798927, decouple_loss:0.017607487738132477
The generated pressure mean: 0.4476472735404968
The generated pressure mean: 0.4473232924938202
loss_pred:0.03885635733604431, decouple_loss:0.01777595840394497
loss_pred:0.03932007774710655, decouple_loss:0.017914429306983948
Iteration: 363, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4480898678302765
loss_pred:0.03906432166695595, decouple_loss:0.018363814800977707
The generated pressure mean: 0.44798222184181213
The generated pressure mean: 0.4462994635105133
loss_pred:0.0378851555287838, decouple_loss:0.018254801630973816
loss_pred:0.03838763013482094, decouple_loss:0.01865563727915287
Iteration: 364, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4465855360031128
loss_pred:0.040464676916599274, decouple_loss:0.01645364612340927
The generated pressure mean: 0.44609978795051575
The generated pressure mean: 0.4471054971218109
loss_pred:0.038803115487098694, decouple_loss:0.01679183728992939
loss_pred:0.03786430507898331, decouple_loss:0.016664884984493256
Iteration: 365, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44758936762809753
loss_pred:0.037811022251844406, decouple_loss:0.018276290968060493
The generated pressure mean: 0.4470537006855011
The generated pressure mean: 0.4468006491661072
loss_pred:0.038348447531461716, decouple_loss:0.018110839650034904
loss_pred:0.03825901821255684, decouple_loss:0.018305731937289238
Iteration: 366, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4478233754634857
loss_pred:0.03711145743727684, decouple_loss:0.017005639150738716
The generated pressure mean: 0.4471133053302765
loss_pred:0.03747083246707916, decouple_loss:0.016319287940859795
The generated pressure mean: 0.44654273986816406
loss_pred:0.036970723420381546, decouple_loss:0.01659931056201458
Iteration: 367, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44808536767959595
loss_pred:0.03752315789461136, decouple_loss:0.016670135781168938
The generated pressure mean: 0.446443647146225
The generated pressure mean: 0.4470779299736023
loss_pred:0.03772155940532684, decouple_loss:0.016299264505505562
loss_pred:0.036571528762578964, decouple_loss:0.017747100442647934
Iteration: 368, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4468631148338318
loss_pred:0.037459053099155426, decouple_loss:0.01583903282880783
The generated pressure mean: 0.4484224021434784
loss_pred:0.03753504157066345, decouple_loss:0.016208738088607788
The generated pressure mean: 0.44882553815841675
loss_pred:0.038247644901275635, decouple_loss:0.01611889898777008
Iteration: 369, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44676217436790466
loss_pred:0.03836510330438614, decouple_loss:0.01614367589354515
The generated pressure mean: 0.4469614624977112
The generated pressure mean: 0.44735151529312134
loss_pred:0.037324558943510056, decouple_loss:0.016218233853578568
loss_pred:0.038185711950063705, decouple_loss:0.016383307054638863
Iteration: 370, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4469561278820038
loss_pred:0.03802904486656189, decouple_loss:0.0165375005453825
The generated pressure mean: 0.4460422694683075
loss_pred:0.03730589523911476, decouple_loss:0.016025830060243607
The generated pressure mean: 0.4470824897289276
loss_pred:0.035954587161540985, decouple_loss:0.016324786469340324
2023-04-16 02:43:46 testing...
The generated pressure mean: 0.449788898229599
The generated pressure mean: 0.4495830833911896
The generated pressure mean: 0.44987666606903076
loss_pred:0.04399663582444191, decouple_loss:0.017110271379351616
loss_pred:0.04318796843290329, decouple_loss:0.017305195331573486
loss_pred:0.04175181686878204, decouple_loss:0.017395388334989548
Loss: 0.04384232312440872, avg_mse: 0.04871543496847153
current test mse: 0.048715
Iteration: 371, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44683948159217834
loss_pred:0.03754264488816261, decouple_loss:0.016690732911229134The generated pressure mean: 0.4469093978404999
loss_pred:0.03822999447584152, decouple_loss:0.01656680926680565
The generated pressure mean: 0.44771745800971985
loss_pred:0.03950745239853859, decouple_loss:0.016630200669169426
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 372, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44686564803123474
loss_pred:0.037122223526239395, decouple_loss:0.01759485900402069
The generated pressure mean: 0.4471959173679352
loss_pred:0.036861125379800797, decouple_loss:0.016710562631487846
The generated pressure mean: 0.4459840953350067
loss_pred:0.03905586525797844, decouple_loss:0.016429774463176727
Iteration: 373, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4460639953613281
loss_pred:0.03742879256606102, decouple_loss:0.0156843401491642
The generated pressure mean: 0.4465208947658539
loss_pred:0.03704856336116791, decouple_loss:0.016613014042377472
The generated pressure mean: 0.4469147026538849
loss_pred:0.037126410752534866, decouple_loss:0.015533178113400936
Iteration: 374, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44698676466941833
loss_pred:0.036667268723249435, decouple_loss:0.0168595053255558
The generated pressure mean: 0.44802191853523254
The generated pressure mean: 0.4473579227924347
loss_pred:0.0371856689453125, decouple_loss:0.016736019402742386
loss_pred:0.03768805414438248, decouple_loss:0.016720935702323914
Iteration: 375, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.447511225938797
loss_pred:0.036917805671691895, decouple_loss:0.017306514084339142
The generated pressure mean: 0.4468706548213959
The generated pressure mean: 0.44724735617637634
loss_pred:0.037134140729904175, decouple_loss:0.01748984307050705
loss_pred:0.03683454170823097, decouple_loss:0.018123015761375427
Iteration: 376, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4470162093639374
loss_pred:0.03626985847949982, decouple_loss:0.01650870591402054
The generated pressure mean: 0.44733890891075134
loss_pred:0.03650134056806564, decouple_loss:0.016514815390110016
The generated pressure mean: 0.44653886556625366
loss_pred:0.036345675587654114, decouple_loss:0.01674496755003929
Iteration: 377, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44625112414360046
loss_pred:0.03928038477897644, decouple_loss:0.015875227749347687
The generated pressure mean: 0.446971595287323
The generated pressure mean: 0.44617095589637756
loss_pred:0.03756570816040039, decouple_loss:0.01584087684750557
loss_pred:0.03860591724514961, decouple_loss:0.01585419476032257
Iteration: 378, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4472261667251587
loss_pred:0.036441657692193985, decouple_loss:0.01634366065263748
The generated pressure mean: 0.44719478487968445
loss_pred:0.03600802645087242, decouple_loss:0.016358789056539536
The generated pressure mean: 0.4467619061470032
loss_pred:0.03650398552417755, decouple_loss:0.01655668579041958
Iteration: 379, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44670695066452026
loss_pred:0.03757214918732643, decouple_loss:0.01615830697119236
The generated pressure mean: 0.4460238814353943
loss_pred:0.037149254232645035, decouple_loss:0.016257712617516518
The generated pressure mean: 0.44785261154174805
loss_pred:0.03670855239033699, decouple_loss:0.01626308262348175
Iteration: 380, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4458525478839874
loss_pred:0.03828880563378334, decouple_loss:0.01554097980260849
The generated pressure mean: 0.4478108584880829
loss_pred:0.039088502526283264, decouple_loss:0.01563059724867344
The generated pressure mean: 0.44709211587905884
loss_pred:0.035562269389629364, decouple_loss:0.01608889549970627
2023-04-16 02:45:40 testing...
The generated pressure mean: 0.4495830535888672
The generated pressure mean: 0.449788898229599
The generated pressure mean: 0.44987666606903076
loss_pred:0.04168308526277542, decouple_loss:0.01656288281083107
loss_pred:0.04318138584494591, decouple_loss:0.016435401514172554
loss_pred:0.041031498461961746, decouple_loss:0.01640872098505497
Loss: 0.04278877377510071, avg_mse: 0.047298744320869446
current test mse: 0.047299
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012004_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012004_3_24hr.npz
NaN value num: 0
Iteration: 381, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44865861535072327
loss_pred:0.03789527714252472, decouple_loss:0.017308032140135765
The generated pressure mean: 0.4479284882545471
loss_pred:0.03987864777445793, decouple_loss:0.017859667539596558
The generated pressure mean: 0.4465603828430176
loss_pred:0.03586360439658165, decouple_loss:0.016573872417211533
Iteration: 382, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45018258690834045
The generated pressure mean: 0.44727644324302673
loss_pred:0.03848689794540405, decouple_loss:0.016217945143580437
loss_pred:0.03795758634805679, decouple_loss:0.017005814239382744
The generated pressure mean: 0.4502047300338745
loss_pred:0.03808840364217758, decouple_loss:0.016851795837283134
Iteration: 383, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4467921853065491
loss_pred:0.03856885805726051, decouple_loss:0.017482815310359The generated pressure mean: 0.4487915635108948
loss_pred:0.03928770869970322, decouple_loss:0.01714610494673252
The generated pressure mean: 0.44871821999549866
loss_pred:0.03836396709084511, decouple_loss:0.017784105613827705
Iteration: 384, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4508858025074005
loss_pred:0.03871139511466026, decouple_loss:0.016568390652537346
The generated pressure mean: 0.4477931559085846
loss_pred:0.037079181522130966, decouple_loss:0.01647411473095417
The generated pressure mean: 0.4463944733142853
loss_pred:0.037027545273303986, decouple_loss:0.017635338008403778
Iteration: 385, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4483143091201782
The generated pressure mean: 0.4487585425376892
loss_pred:0.037743352353572845, decouple_loss:0.016719046980142593
loss_pred:0.03801123797893524, decouple_loss:0.0160176120698452
The generated pressure mean: 0.44962185621261597
loss_pred:0.036883436143398285, decouple_loss:0.01607680507004261
Iteration: 386, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44732072949409485
loss_pred:0.038706935942173004, decouple_loss:0.016724994406104088
The generated pressure mean: 0.4475422501564026
loss_pred:0.03825671970844269, decouple_loss:0.016728827729821205
The generated pressure mean: 0.4482864737510681
loss_pred:0.03624875098466873, decouple_loss:0.01633954979479313
Iteration: 387, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4482608735561371
loss_pred:0.03593812510371208, decouple_loss:0.016247473657131195
The generated pressure mean: 0.4481866657733917
loss_pred:0.03670602664351463, decouple_loss:0.016575906425714493
The generated pressure mean: 0.44748514890670776
loss_pred:0.03840366005897522, decouple_loss:0.01698325015604496
Iteration: 388, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4486162066459656
The generated pressure mean: 0.44940853118896484
loss_pred:0.03943256288766861, decouple_loss:0.01813214272260666
loss_pred:0.03835383430123329, decouple_loss:0.017672626301646233
The generated pressure mean: 0.4482541084289551
loss_pred:0.03817971423268318, decouple_loss:0.017132926732301712
Iteration: 389, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4488387405872345
loss_pred:0.03758526220917702, decouple_loss:0.01811339147388935
The generated pressure mean: 0.4487621486186981
loss_pred:0.03665979206562042, decouple_loss:0.0187190193682909
The generated pressure mean: 0.44850489497184753
loss_pred:0.03686567023396492, decouple_loss:0.0177539624273777
Iteration: 390, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4475911259651184
loss_pred:0.03486977890133858, decouple_loss:0.018448838964104652
The generated pressure mean: 0.44756534695625305
loss_pred:0.03629571944475174, decouple_loss:0.018841266632080078
The generated pressure mean: 0.4465106725692749
loss_pred:0.037146005779504776, decouple_loss:0.01903240941464901
2023-04-16 02:48:15 testing...
The generated pressure mean: 0.4495830833911896
The generated pressure mean: 0.4497888684272766
The generated pressure mean: 0.44987666606903076
loss_pred:0.04305034875869751, decouple_loss:0.018831394612789154
loss_pred:0.0440790131688118, decouple_loss:0.01917925663292408
loss_pred:0.04206016659736633, decouple_loss:0.019062163308262825
Loss: 0.04401439055800438, avg_mse: 0.049558255821466446
current test mse: 0.049558
Iteration: 391, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4487471878528595
loss_pred:0.037732236087322235, decouple_loss:0.01921546645462513
The generated pressure mean: 0.44872063398361206
loss_pred:0.03781309723854065, decouple_loss:0.01964757964015007
The generated pressure mean: 0.4478696584701538
loss_pred:0.03584947809576988, decouple_loss:0.019078552722930908
Iteration: 392, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4481052756309509
loss_pred:0.03891859948635101, decouple_loss:0.018617728725075722
The generated pressure mean: 0.44648703932762146
loss_pred:0.035611581057310104, decouple_loss:0.018576044589281082
The generated pressure mean: 0.44806262850761414
loss_pred:0.03687823563814163, decouple_loss:0.019059516489505768
Iteration: 393, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44782358407974243
loss_pred:0.0379573293030262, decouple_loss:0.019497713074088097
The generated pressure mean: 0.44615504145622253
loss_pred:0.03591691702604294, decouple_loss:0.019207295030355453
The generated pressure mean: 0.4483461380004883
loss_pred:0.03678993135690689, decouple_loss:0.01896728202700615
Iteration: 394, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4481760263442993
The generated pressure mean: 0.4483553469181061
loss_pred:0.036434244364500046, decouple_loss:0.018925126641988754
loss_pred:0.039981551468372345, decouple_loss:0.020179418846964836
The generated pressure mean: 0.44847527146339417
loss_pred:0.0378071665763855, decouple_loss:0.019045904278755188
Iteration: 395, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44707104563713074
The generated pressure mean: 0.4476674795150757
loss_pred:0.035758063197135925, decouple_loss:0.01984124630689621
loss_pred:0.037879057228565216, decouple_loss:0.020249968394637108
The generated pressure mean: 0.4473828673362732
loss_pred:0.03646544739603996, decouple_loss:0.019336111843585968
Iteration: 396, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.447777658700943
loss_pred:0.03899015486240387, decouple_loss:0.020963327959179878
The generated pressure mean: 0.4484059512615204
loss_pred:0.037538278847932816, decouple_loss:0.02095729671418667
The generated pressure mean: 0.44796425104141235
loss_pred:0.03721534088253975, decouple_loss:0.02080204151570797
Iteration: 397, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44837528467178345
loss_pred:0.03713548555970192, decouple_loss:0.019500546157360077
The generated pressure mean: 0.4480462074279785
loss_pred:0.035985834896564484, decouple_loss:0.018522165715694427
The generated pressure mean: 0.44810235500335693
loss_pred:0.035496484488248825, decouple_loss:0.018877984955906868
Iteration: 398, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44788700342178345
The generated pressure mean: 0.44761234521865845
loss_pred:0.0363209992647171, decouple_loss:0.017757674679160118
loss_pred:0.03787446394562721, decouple_loss:0.018062053248286247
The generated pressure mean: 0.447750449180603
loss_pred:0.035624854266643524, decouple_loss:0.01711677387356758
Iteration: 399, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44923385977745056
loss_pred:0.03748028352856636, decouple_loss:0.020789477974176407
The generated pressure mean: 0.44863656163215637
loss_pred:0.03780578449368477, decouple_loss:0.02016202174127102
The generated pressure mean: 0.44935524463653564
loss_pred:0.03660085052251816, decouple_loss:0.019926179200410843
Iteration: 400, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4490843415260315
The generated pressure mean: 0.4483340084552765
loss_pred:0.0361330509185791, decouple_loss:0.018329376354813576
loss_pred:0.03643002361059189, decouple_loss:0.01881817914545536
The generated pressure mean: 0.44828712940216064
loss_pred:0.03666848689317703, decouple_loss:0.01787792146205902
2023-04-16 02:50:09 testing...
The generated pressure mean: 0.4495830535888672
The generated pressure mean: 0.449788898229599
The generated pressure mean: 0.44987666606903076
loss_pred:0.042641397565603256, decouple_loss:0.01894843764603138
loss_pred:0.04358696937561035, decouple_loss:0.01913897693157196
loss_pred:0.041257891803979874, decouple_loss:0.019082708284258842
Loss: 0.043448254466056824, avg_mse: 0.048899248242378235
current test mse: 0.048899
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012002_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012002_3_24hr.npz
NaN value num: 0
Iteration: 401, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4507500231266022
loss_pred:0.03731561452150345, decouple_loss:0.01939331740140915
The generated pressure mean: 0.44811615347862244
loss_pred:0.03672497719526291, decouple_loss:0.019296087324619293
The generated pressure mean: 0.44785282015800476
loss_pred:0.03843502327799797, decouple_loss:0.018923111259937286
Iteration: 402, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4485626816749573
loss_pred:0.03624490648508072, decouple_loss:0.018786177039146423
The generated pressure mean: 0.451656699180603
loss_pred:0.03701759874820709, decouple_loss:0.01931089535355568
The generated pressure mean: 0.4481935501098633
loss_pred:0.03682464361190796, decouple_loss:0.01884007453918457
Iteration: 403, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4467902183532715
loss_pred:0.03933035582304001, decouple_loss:0.018812039867043495
The generated pressure mean: 0.4489430785179138
loss_pred:0.03863859921693802, decouple_loss:0.018088726326823235
The generated pressure mean: 0.44972044229507446
loss_pred:0.035984065383672714, decouple_loss:0.019605671986937523
Iteration: 404, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4497550427913666
loss_pred:0.03733520582318306, decouple_loss:0.019340861588716507
The generated pressure mean: 0.4491240084171295
The generated pressure mean: 0.44975847005844116
loss_pred:0.03652055561542511, decouple_loss:0.019867580384016037
loss_pred:0.03750719875097275, decouple_loss:0.019010528922080994
Iteration: 405, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44795358180999756
loss_pred:0.03941543400287628, decouple_loss:0.019398991018533707
The generated pressure mean: 0.44979915022850037
The generated pressure mean: 0.4472678005695343
loss_pred:0.037149421870708466, decouple_loss:0.01909743621945381
loss_pred:0.036620356142520905, decouple_loss:0.018703753128647804
Iteration: 406, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4499562680721283
loss_pred:0.035735759884119034, decouple_loss:0.019849959760904312
The generated pressure mean: 0.4487262964248657
loss_pred:0.03656501695513725, decouple_loss:0.019778184592723846
The generated pressure mean: 0.44840124249458313
loss_pred:0.03829926624894142, decouple_loss:0.01971834897994995
Iteration: 407, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.447256863117218
loss_pred:0.03635222464799881, decouple_loss:0.018914321437478065
The generated pressure mean: 0.4490821361541748
loss_pred:0.03710824251174927, decouple_loss:0.01993502303957939
The generated pressure mean: 0.4474325478076935
loss_pred:0.03601405397057533, decouple_loss:0.018779313191771507
Iteration: 408, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4486274719238281
loss_pred:0.034972891211509705, decouple_loss:0.02030571736395359
The generated pressure mean: 0.4476976692676544
loss_pred:0.0369122177362442, decouple_loss:0.01975967548787594
The generated pressure mean: 0.4488906264305115
loss_pred:0.03652955964207649, decouple_loss:0.019863951951265335
Iteration: 409, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44836610555648804
loss_pred:0.036076176911592484, decouple_loss:0.019466903060674667
The generated pressure mean: 0.4486962556838989
loss_pred:0.03842877224087715, decouple_loss:0.01976521499454975
The generated pressure mean: 0.4500373899936676
loss_pred:0.03625580295920372, decouple_loss:0.01943330280482769
Iteration: 410, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44798243045806885
loss_pred:0.035464346408843994, decouple_loss:0.01979951560497284
The generated pressure mean: 0.4476631283760071
loss_pred:0.03842085972428322, decouple_loss:0.019637059420347214
The generated pressure mean: 0.448194295167923
loss_pred:0.03755837306380272, decouple_loss:0.019625792279839516
2023-04-16 02:52:37 testing...
The generated pressure mean: 0.449788898229599
The generated pressure mean: 0.4495830535888672
The generated pressure mean: 0.44987666606903076
loss_pred:0.04413864016532898, decouple_loss:0.021462764590978622
loss_pred:0.04264751821756363, decouple_loss:0.02125210128724575
loss_pred:0.0418257862329483, decouple_loss:0.021438704803586006
Loss: 0.043939873576164246, avg_mse: 0.04976369068026543
current test mse: 0.049764
Iteration: 411, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4476599097251892
loss_pred:0.03587571904063225, decouple_loss:0.021211842074990273
The generated pressure mean: 0.4486277103424072
loss_pred:0.03661349043250084, decouple_loss:0.021797645837068558
The generated pressure mean: 0.44755735993385315
loss_pred:0.03718382120132446, decouple_loss:0.02124517410993576
Iteration: 412, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4493548274040222
loss_pred:0.03599293529987335, decouple_loss:0.01997584104537964
The generated pressure mean: 0.44915971159935
loss_pred:0.035553161054849625, decouple_loss:0.019778233021497726
The generated pressure mean: 0.44961124658584595
loss_pred:0.03597060218453407, decouple_loss:0.02035255916416645
Iteration: 413, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44841739535331726
loss_pred:0.03772598132491112, decouple_loss:0.021235862746834755
The generated pressure mean: 0.45019304752349854
loss_pred:0.03535415977239609, decouple_loss:0.021472569555044174
The generated pressure mean: 0.4488476812839508
loss_pred:0.03444350138306618, decouple_loss:0.021857503801584244
Iteration: 414, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4466943144798279
loss_pred:0.038246460258960724, decouple_loss:0.021427404135465622
The generated pressure mean: 0.447856068611145
loss_pred:0.03674763813614845, decouple_loss:0.01976929046213627
The generated pressure mean: 0.44839343428611755
loss_pred:0.03858470916748047, decouple_loss:0.020226439461112022
Iteration: 415, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4490741193294525
loss_pred:0.0383937768638134, decouple_loss:0.020011307671666145
The generated pressure mean: 0.44754844903945923
loss_pred:0.03794034942984581, decouple_loss:0.01975368708372116
The generated pressure mean: 0.4474162459373474
loss_pred:0.03631209582090378, decouple_loss:0.01954561285674572
Iteration: 416, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44837766885757446
loss_pred:0.03748500719666481, decouple_loss:0.019517218694090843
The generated pressure mean: 0.448076993227005
The generated pressure mean: 0.4489346146583557loss_pred:0.037343431264162064, decouple_loss:0.01925826258957386
loss_pred:0.03544318675994873, decouple_loss:0.019476277753710747
Iteration: 417, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4488057792186737
loss_pred:0.036709029227495193, decouple_loss:0.021378306671977043
The generated pressure mean: 0.4489038288593292
loss_pred:0.03670047968626022, decouple_loss:0.021631937474012375
The generated pressure mean: 0.44819745421409607
loss_pred:0.03706381097435951, decouple_loss:0.020684143528342247
Iteration: 418, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4473476707935333
The generated pressure mean: 0.4474261701107025
loss_pred:0.035767242312431335, decouple_loss:0.019282786175608635
loss_pred:0.03751707449555397, decouple_loss:0.02005528099834919
The generated pressure mean: 0.4472696781158447
loss_pred:0.038304828107357025, decouple_loss:0.020226310938596725
Iteration: 419, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4490068256855011
The generated pressure mean: 0.44738543033599854
loss_pred:0.03327285870909691, decouple_loss:0.02223154529929161
loss_pred:0.03550087288022041, decouple_loss:0.021164236590266228
The generated pressure mean: 0.4474971890449524
loss_pred:0.03519890829920769, decouple_loss:0.02122255228459835
Iteration: 420, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.448757529258728
loss_pred:0.03722343593835831, decouple_loss:0.020035915076732635
The generated pressure mean: 0.4469147026538849
loss_pred:0.03675356134772301, decouple_loss:0.019244426861405373
The generated pressure mean: 0.4471130073070526
loss_pred:0.03827106952667236, decouple_loss:0.020515883341431618
2023-04-16 02:54:31 testing...
The generated pressure mean: 0.4495830535888672
The generated pressure mean: 0.4497888684272766
The generated pressure mean: 0.44987666606903076
loss_pred:0.041546039283275604, decouple_loss:0.02191268280148506
loss_pred:0.0429484061896801, decouple_loss:0.022295668721199036
loss_pred:0.04087736830115318, decouple_loss:0.022191310301423073
Loss: 0.042897265404462814, avg_mse: 0.048213694244623184
current test mse: 0.048214
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012012_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012012_3_24hr.npz
NaN value num: 0
Iteration: 421, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4477330446243286
loss_pred:0.03680845722556114, decouple_loss:0.021677594631910324
The generated pressure mean: 0.4456293284893036
The generated pressure mean: 0.4475523829460144
loss_pred:0.03777652978897095, decouple_loss:0.022188860923051834
loss_pred:0.0362783819437027, decouple_loss:0.022209592163562775
Iteration: 422, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44838908314704895
The generated pressure mean: 0.44812092185020447
loss_pred:0.03716571629047394, decouple_loss:0.021565420553088188
loss_pred:0.03570134937763214, decouple_loss:0.021543903276324272
The generated pressure mean: 0.44628408551216125
loss_pred:0.0380898118019104, decouple_loss:0.021404562518000603
Iteration: 423, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44765475392341614
The generated pressure mean: 0.4467921853065491
loss_pred:0.03849606588482857, decouple_loss:0.02372022345662117
loss_pred:0.036233849823474884, decouple_loss:0.022827675566077232
The generated pressure mean: 0.4472866356372833
loss_pred:0.03726876527070999, decouple_loss:0.023245230317115784
Iteration: 424, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44752028584480286
loss_pred:0.03478632867336273, decouple_loss:0.02161707542836666
The generated pressure mean: 0.44732311367988586
loss_pred:0.03729809820652008, decouple_loss:0.02181687019765377
The generated pressure mean: 0.44864141941070557
loss_pred:0.03817101567983627, decouple_loss:0.02194444090127945
Iteration: 425, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4470200538635254The generated pressure mean: 0.44647812843322754
loss_pred:0.036151595413684845, decouple_loss:0.021969588473439217
loss_pred:0.03648403286933899, decouple_loss:0.021877866238355637
The generated pressure mean: 0.44597822427749634
loss_pred:0.03667447715997696, decouple_loss:0.021663716062903404
Iteration: 426, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44741907715797424
The generated pressure mean: 0.4472026228904724
loss_pred:0.038336560130119324, decouple_loss:0.019663501530885696
loss_pred:0.03529246523976326, decouple_loss:0.019599908962845802
The generated pressure mean: 0.4486526548862457
loss_pred:0.037823960185050964, decouple_loss:0.020535988733172417
Iteration: 427, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.446382999420166
The generated pressure mean: 0.44730570912361145
loss_pred:0.036888908594846725, decouple_loss:0.022672299295663834
loss_pred:0.03698603808879852, decouple_loss:0.022717606276273727
The generated pressure mean: 0.4474409818649292
loss_pred:0.03677360713481903, decouple_loss:0.022737281396985054
Iteration: 428, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4484599530696869
loss_pred:0.03779927268624306, decouple_loss:0.02029033750295639
The generated pressure mean: 0.4467793107032776
loss_pred:0.03726309537887573, decouple_loss:0.019644247367978096
The generated pressure mean: 0.4474908709526062
loss_pred:0.03709331154823303, decouple_loss:0.019584910944104195
Iteration: 429, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44769424200057983
loss_pred:0.03647174686193466, decouple_loss:0.02152465656399727
The generated pressure mean: 0.44812050461769104
loss_pred:0.037596445530653, decouple_loss:0.022097226232290268
The generated pressure mean: 0.44773608446121216
loss_pred:0.036201994866132736, decouple_loss:0.022049827501177788
Iteration: 430, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4480159282684326
The generated pressure mean: 0.44654789566993713loss_pred:0.03831896930932999, decouple_loss:0.017919259145855904
loss_pred:0.035871803760528564, decouple_loss:0.017422160133719444
The generated pressure mean: 0.448669970035553
loss_pred:0.03769374266266823, decouple_loss:0.018169399350881577
2023-04-16 02:57:12 testing...
The generated pressure mean: 0.4495830833911896
The generated pressure mean: 0.449788898229599
The generated pressure mean: 0.44987666606903076
loss_pred:0.042831987142562866, decouple_loss:0.018860086798667908
loss_pred:0.04358690232038498, decouple_loss:0.019231179729104042
loss_pred:0.04212276265025139, decouple_loss:0.019109802320599556
Loss: 0.04380057007074356, avg_mse: 0.05041598901152611
current test mse: 0.050416
Iteration: 431, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44685396552085876
loss_pred:0.037220925092697144, decouple_loss:0.018848203122615814
The generated pressure mean: 0.4477033317089081
loss_pred:0.03696668520569801, decouple_loss:0.01871654950082302
The generated pressure mean: 0.4470370411872864
loss_pred:0.037890538573265076, decouple_loss:0.019799457862973213
Iteration: 432, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4487679600715637
loss_pred:0.03810066357254982, decouple_loss:0.01867472380399704
The generated pressure mean: 0.4472869336605072
loss_pred:0.03679759055376053, decouple_loss:0.01824934594333172
The generated pressure mean: 0.44723421335220337
loss_pred:0.036787912249565125, decouple_loss:0.018789216876029968
Iteration: 433, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4478982090950012
loss_pred:0.035079922527074814, decouple_loss:0.01783660613000393
The generated pressure mean: 0.4471847116947174
loss_pred:0.03629295155405998, decouple_loss:0.018021007999777794
The generated pressure mean: 0.44869041442871094
loss_pred:0.037997592240571976, decouple_loss:0.018909072503447533
Iteration: 434, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44814231991767883
loss_pred:0.03465941920876503, decouple_loss:0.017560476437211037
The generated pressure mean: 0.4469078779220581
loss_pred:0.03723934665322304, decouple_loss:0.01817878521978855
The generated pressure mean: 0.44803979992866516
loss_pred:0.0371050201356411, decouple_loss:0.018230581656098366
Iteration: 435, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4474744498729706
loss_pred:0.03416847065091133, decouple_loss:0.01736690290272236
The generated pressure mean: 0.4474269449710846
loss_pred:0.03738143667578697, decouple_loss:0.01795673556625843
The generated pressure mean: 0.4476260542869568
loss_pred:0.036604903638362885, decouple_loss:0.01773804798722267
Iteration: 436, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4469403624534607
loss_pred:0.03570174053311348, decouple_loss:0.016409723088145256
The generated pressure mean: 0.4477849304676056
loss_pred:0.03682640939950943, decouple_loss:0.017512883991003036
The generated pressure mean: 0.4469599425792694
loss_pred:0.03613431006669998, decouple_loss:0.016276521608233452
Iteration: 437, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44889017939567566
loss_pred:0.03719954937696457, decouple_loss:0.017393013462424278
The generated pressure mean: 0.4478202760219574
loss_pred:0.03696706146001816, decouple_loss:0.017344661056995392
The generated pressure mean: 0.4477022588253021
loss_pred:0.035341255366802216, decouple_loss:0.01692114770412445
Iteration: 438, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4468740224838257
loss_pred:0.03558483347296715, decouple_loss:0.015318162739276886
The generated pressure mean: 0.44790810346603394
loss_pred:0.035761065781116486, decouple_loss:0.015576884150505066
The generated pressure mean: 0.4478236734867096
loss_pred:0.03414970263838768, decouple_loss:0.015186524949967861
Iteration: 439, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44849735498428345
loss_pred:0.03502615913748741, decouple_loss:0.016807040199637413
The generated pressure mean: 0.4476092755794525
loss_pred:0.03708897903561592, decouple_loss:0.016292477026581764
The generated pressure mean: 0.4478985369205475
loss_pred:0.03650828078389168, decouple_loss:0.016863934695720673
Iteration: 440, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44743579626083374
loss_pred:0.03624790161848068, decouple_loss:0.015319595113396645
The generated pressure mean: 0.4481739103794098
loss_pred:0.03748292103409767, decouple_loss:0.01661277748644352
The generated pressure mean: 0.44771796464920044
loss_pred:0.034404635429382324, decouple_loss:0.015378450974822044
2023-04-16 02:59:06 testing...
The generated pressure mean: 0.4495830833911896
The generated pressure mean: 0.4497888684272766
The generated pressure mean: 0.44987666606903076
loss_pred:0.0406096875667572, decouple_loss:0.015544903464615345
loss_pred:0.041410934180021286, decouple_loss:0.01578355021774769
loss_pred:0.0394434779882431, decouple_loss:0.01570872589945793
Loss: 0.041271984577178955, avg_mse: 0.04654395952820778
current test mse: 0.046544
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012016_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012016_3_24hr.npz
NaN value num: 0
Iteration: 441, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44745904207229614
loss_pred:0.037779878824949265, decouple_loss:0.015906699001789093
The generated pressure mean: 0.44800665974617004
loss_pred:0.03765420243144035, decouple_loss:0.016671517863869667
The generated pressure mean: 0.44726693630218506
loss_pred:0.03540191799402237, decouple_loss:0.01665620133280754
Iteration: 442, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44707900285720825
The generated pressure mean: 0.4477413594722748
loss_pred:0.03816588595509529, decouple_loss:0.01624523103237152
loss_pred:0.037816617637872696, decouple_loss:0.016639595851302147
The generated pressure mean: 0.4475264549255371
loss_pred:0.037653710693120956, decouple_loss:0.016702799126505852
Iteration: 443, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4479086399078369
The generated pressure mean: 0.4475240707397461
loss_pred:0.03608585521578789, decouple_loss:0.015966149047017097
loss_pred:0.038613151758909225, decouple_loss:0.015812993049621582
The generated pressure mean: 0.44715288281440735
loss_pred:0.03719605877995491, decouple_loss:0.015851149335503578
Iteration: 444, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44744566082954407
loss_pred:0.03676275536417961, decouple_loss:0.014863383024930954
The generated pressure mean: 0.4481313228607178
loss_pred:0.038250263780355453, decouple_loss:0.015431738458573818
The generated pressure mean: 0.4469631314277649
loss_pred:0.03621746227145195, decouple_loss:0.015236546285450459
Iteration: 445, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44729742407798767
loss_pred:0.037099555134773254, decouple_loss:0.015464160591363907
The generated pressure mean: 0.44719043374061584
loss_pred:0.038886118680238724, decouple_loss:0.015988925471901894
The generated pressure mean: 0.448035329580307
loss_pred:0.03470713272690773, decouple_loss:0.0153243038803339
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 446, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4475800395011902
loss_pred:0.03629934787750244, decouple_loss:0.015073694288730621
The generated pressure mean: 0.44748654961586
loss_pred:0.03961708024144173, decouple_loss:0.014913486316800117
The generated pressure mean: 0.4483296573162079
loss_pred:0.037629950791597366, decouple_loss:0.014917785301804543
Iteration: 447, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44677072763442993
loss_pred:0.03522125259041786, decouple_loss:0.014791524037718773
The generated pressure mean: 0.4473910927772522
loss_pred:0.038078922778367996, decouple_loss:0.01466455589979887
The generated pressure mean: 0.44719043374061584
loss_pred:0.03738900274038315, decouple_loss:0.014890692196786404
Iteration: 448, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4476644992828369
loss_pred:0.03775159269571304, decouple_loss:0.01509347278624773
The generated pressure mean: 0.4472975432872772
loss_pred:0.0354890413582325, decouple_loss:0.015675727277994156
The generated pressure mean: 0.4476642608642578
loss_pred:0.035590168088674545, decouple_loss:0.0150011470541358
Iteration: 449, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44681569933891296
loss_pred:0.03609181568026543, decouple_loss:0.01569298282265663
The generated pressure mean: 0.4477626085281372
loss_pred:0.0355195477604866, decouple_loss:0.015937913209199905
The generated pressure mean: 0.44665274024009705
loss_pred:0.03479950502514839, decouple_loss:0.015022475272417068
Iteration: 450, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4478148818016052
loss_pred:0.03654750809073448, decouple_loss:0.01743440143764019
The generated pressure mean: 0.44758734107017517
loss_pred:0.036861177533864975, decouple_loss:0.017502063885331154
The generated pressure mean: 0.4471842348575592
loss_pred:0.03689482435584068, decouple_loss:0.01750088483095169
2023-04-16 03:01:37 testing...
The generated pressure mean: 0.4497888684272766
The generated pressure mean: 0.4495830535888672
The generated pressure mean: 0.44987666606903076
loss_pred:0.04088010638952255, decouple_loss:0.015951579436659813
loss_pred:0.04007614031434059, decouple_loss:0.016030358150601387
loss_pred:0.038924917578697205, decouple_loss:0.016258995980024338
Loss: 0.040764402598142624, avg_mse: 0.045859552919864655
current test mse: 0.04586
Iteration: 451, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44698387384414673
The generated pressure mean: 0.44752684235572815
loss_pred:0.038814060389995575, decouple_loss:0.016140567138791084
loss_pred:0.036067575216293335, decouple_loss:0.016396373510360718
The generated pressure mean: 0.4475558400154114
loss_pred:0.03735319525003433, decouple_loss:0.01595107465982437
Iteration: 452, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4485866129398346
The generated pressure mean: 0.4485894441604614loss_pred:0.03527076542377472, decouple_loss:0.01597120426595211
loss_pred:0.03400462493300438, decouple_loss:0.015869593247771263
The generated pressure mean: 0.4473235309123993
loss_pred:0.035799045115709305, decouple_loss:0.0161413736641407
Iteration: 453, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44772130250930786
The generated pressure mean: 0.44733738899230957
loss_pred:0.03680551052093506, decouple_loss:0.01783864013850689
loss_pred:0.03661658242344856, decouple_loss:0.017803046852350235
The generated pressure mean: 0.4476320445537567
loss_pred:0.033901508897542953, decouple_loss:0.01768379658460617
Iteration: 454, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44735559821128845
loss_pred:0.03540941700339317, decouple_loss:0.01608772948384285
The generated pressure mean: 0.44691622257232666
loss_pred:0.038782380521297455, decouple_loss:0.016809683293104172
The generated pressure mean: 0.446276992559433
loss_pred:0.03429095819592476, decouple_loss:0.01633675955235958
Iteration: 455, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44654354453086853
loss_pred:0.035261813551187515, decouple_loss:0.015695830807089806
The generated pressure mean: 0.4474899470806122
loss_pred:0.03523486107587814, decouple_loss:0.016067707911133766
The generated pressure mean: 0.44630637764930725
loss_pred:0.03523598983883858, decouple_loss:0.015952469781041145
Iteration: 456, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4471803605556488
loss_pred:0.03679880499839783, decouple_loss:0.0167023204267025
The generated pressure mean: 0.44814151525497437
loss_pred:0.03613858297467232, decouple_loss:0.016556065529584885
The generated pressure mean: 0.44760948419570923
loss_pred:0.03564395383000374, decouple_loss:0.01697283610701561
Iteration: 457, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4477905035018921
loss_pred:0.038175154477357864, decouple_loss:0.016764387488365173
The generated pressure mean: 0.44601359963417053
loss_pred:0.03408709913492203, decouple_loss:0.01666674017906189
The generated pressure mean: 0.4475373327732086
loss_pred:0.03599631413817406, decouple_loss:0.01661747694015503
Iteration: 458, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4472311735153198
loss_pred:0.036855507642030716, decouple_loss:0.016092542558908463
The generated pressure mean: 0.4476197361946106
loss_pred:0.03619225695729256, decouple_loss:0.016187364235520363
The generated pressure mean: 0.44779273867607117
loss_pred:0.03433758765459061, decouple_loss:0.01603337936103344
Iteration: 459, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44759687781333923
loss_pred:0.0352252833545208, decouple_loss:0.016849370673298836
The generated pressure mean: 0.44785478711128235
loss_pred:0.03539418801665306, decouple_loss:0.01719067059457302
The generated pressure mean: 0.44701892137527466
loss_pred:0.03757172450423241, decouple_loss:0.016562849283218384
Iteration: 460, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44710057973861694
loss_pred:0.035879090428352356, decouple_loss:0.01732160896062851
The generated pressure mean: 0.44776326417922974
loss_pred:0.03632892668247223, decouple_loss:0.01671679876744747
The generated pressure mean: 0.4471186101436615
loss_pred:0.036449287086725235, decouple_loss:0.01723247393965721
2023-04-16 03:03:31 testing...
The generated pressure mean: 0.449788898229599
The generated pressure mean: 0.4495830833911896
The generated pressure mean: 0.44987666606903076
loss_pred:0.04108157008886337, decouple_loss:0.01685483381152153
loss_pred:0.04050877317786217, decouple_loss:0.01721004582941532
loss_pred:0.039082903414964676, decouple_loss:0.01720486767590046
Loss: 0.04107891023159027, avg_mse: 0.046598032116889954
current test mse: 0.046598
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012011_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012011_3_24hr.npz
NaN value num: 0
Iteration: 461, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44720330834388733
loss_pred:0.03481122478842735, decouple_loss:0.01813400164246559
The generated pressure mean: 0.4468989074230194
The generated pressure mean: 0.44757816195487976
loss_pred:0.034708015620708466, decouple_loss:0.01675221137702465
loss_pred:0.034893788397312164, decouple_loss:0.01644224487245083
Iteration: 462, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4485373795032501
The generated pressure mean: 0.4470285177230835
loss_pred:0.0345887616276741, decouple_loss:0.016273880377411842
loss_pred:0.037520378828048706, decouple_loss:0.016191832721233368
The generated pressure mean: 0.44769522547721863
loss_pred:0.0340610072016716, decouple_loss:0.015394013375043869
Iteration: 463, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44776228070259094
The generated pressure mean: 0.449092298746109
loss_pred:0.03723403438925743, decouple_loss:0.015690263360738754
loss_pred:0.03562759608030319, decouple_loss:0.015697861090302467
The generated pressure mean: 0.44794023036956787
loss_pred:0.03484487906098366, decouple_loss:0.015119154006242752
Iteration: 464, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44778740406036377
loss_pred:0.03590896353125572, decouple_loss:0.015742255374789238
The generated pressure mean: 0.4467989206314087
loss_pred:0.03645649552345276, decouple_loss:0.01540773268789053
The generated pressure mean: 0.4490791857242584
loss_pred:0.03453328087925911, decouple_loss:0.016414759680628777
Iteration: 465, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4476890563964844The generated pressure mean: 0.44715616106987
loss_pred:0.0335448682308197, decouple_loss:0.015580792911350727
loss_pred:0.03606480732560158, decouple_loss:0.01574082300066948
The generated pressure mean: 0.44735175371170044
loss_pred:0.03603008762001991, decouple_loss:0.015407716855406761
Iteration: 466, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44812625646591187
The generated pressure mean: 0.44797784090042114
loss_pred:0.03454006463289261, decouple_loss:0.01801052875816822
loss_pred:0.03260660916566849, decouple_loss:0.01820683665573597
The generated pressure mean: 0.44764891266822815
loss_pred:0.03485066071152687, decouple_loss:0.01778591424226761
Iteration: 467, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44797438383102417
The generated pressure mean: 0.44774553179740906
loss_pred:0.03368235006928444, decouple_loss:0.017689093947410583
loss_pred:0.0357539989054203, decouple_loss:0.01765803061425686
The generated pressure mean: 0.44653698801994324
loss_pred:0.036381740123033524, decouple_loss:0.017583349719643593
Iteration: 468, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4474108815193176
loss_pred:0.03610442951321602, decouple_loss:0.015416989102959633
The generated pressure mean: 0.4475812315940857
loss_pred:0.03459108993411064, decouple_loss:0.01568681187927723
The generated pressure mean: 0.4471355974674225
loss_pred:0.03560790419578552, decouple_loss:0.015622792765498161
Iteration: 469, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44773584604263306
loss_pred:0.035543572157621384, decouple_loss:0.01587776467204094
The generated pressure mean: 0.447274774312973
loss_pred:0.03435945883393288, decouple_loss:0.015498729422688484
The generated pressure mean: 0.4475352168083191
loss_pred:0.03320491313934326, decouple_loss:0.015609735623002052
Iteration: 470, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44720175862312317
loss_pred:0.03699922934174538, decouple_loss:0.018849214538931847
The generated pressure mean: 0.4486345648765564
loss_pred:0.03375040367245674, decouple_loss:0.018685929477214813
The generated pressure mean: 0.4471811056137085
loss_pred:0.03592631593346596, decouple_loss:0.01823028363287449
2023-04-16 03:06:02 testing...
The generated pressure mean: 0.4495830833911896
The generated pressure mean: 0.449788898229599
The generated pressure mean: 0.44987666606903076
loss_pred:0.0400085411965847, decouple_loss:0.01866413839161396
loss_pred:0.04109133780002594, decouple_loss:0.01894783414900303loss_pred:0.03846592456102371, decouple_loss:0.018947659060359
Loss: 0.04079793021082878, avg_mse: 0.04634682089090347
current test mse: 0.046347
Iteration: 471, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4482946991920471
loss_pred:0.0344415046274662, decouple_loss:0.018870428204536438
The generated pressure mean: 0.4486341178417206
loss_pred:0.034801654517650604, decouple_loss:0.019096018746495247
The generated pressure mean: 0.4480414092540741
loss_pred:0.03331468626856804, decouple_loss:0.018942940980196
Iteration: 472, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44768840074539185
loss_pred:0.03424437344074249, decouple_loss:0.017648188397288322
The generated pressure mean: 0.44704321026802063
loss_pred:0.03379451483488083, decouple_loss:0.017336521297693253
The generated pressure mean: 0.44815152883529663
loss_pred:0.03380340337753296, decouple_loss:0.017762022092938423
Iteration: 473, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44785022735595703
loss_pred:0.03663067892193794, decouple_loss:0.01825343817472458
The generated pressure mean: 0.446834534406662
loss_pred:0.035071466118097305, decouple_loss:0.01808065176010132
The generated pressure mean: 0.44766753911972046
loss_pred:0.03897756338119507, decouple_loss:0.018389908596873283
Iteration: 474, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44808363914489746
loss_pred:0.03719208016991615, decouple_loss:0.020930277183651924
The generated pressure mean: 0.4481104910373688
loss_pred:0.03681613877415657, decouple_loss:0.020703695714473724
The generated pressure mean: 0.4470593333244324
loss_pred:0.03717932850122452, decouple_loss:0.020200273022055626
Iteration: 475, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4471130669116974
loss_pred:0.03731493279337883, decouple_loss:0.02000182867050171
The generated pressure mean: 0.4473905861377716
loss_pred:0.03626616299152374, decouple_loss:0.020246507599949837
The generated pressure mean: 0.44668811559677124
loss_pred:0.037430789321660995, decouple_loss:0.020238272845745087
Iteration: 476, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44765564799308777
loss_pred:0.036665916442871094, decouple_loss:0.019466467201709747
The generated pressure mean: 0.44732335209846497
loss_pred:0.03549232333898544, decouple_loss:0.019570959731936455
The generated pressure mean: 0.4478897452354431
loss_pred:0.03471381589770317, decouple_loss:0.019640816375613213
Iteration: 477, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4488285779953003
loss_pred:0.0340508297085762, decouple_loss:0.021655485033988953
The generated pressure mean: 0.4474720358848572
loss_pred:0.039149243384599686, decouple_loss:0.021775448694825172
The generated pressure mean: 0.44870516657829285
loss_pred:0.03461330756545067, decouple_loss:0.02178804576396942
Iteration: 478, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4481147527694702
loss_pred:0.03426067903637886, decouple_loss:0.01884094439446926
The generated pressure mean: 0.4478875398635864
The generated pressure mean: 0.44962751865386963
loss_pred:0.037608806043863297, decouple_loss:0.019533678889274597
loss_pred:0.03507012873888016, decouple_loss:0.019718606024980545
Iteration: 479, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44857919216156006
loss_pred:0.0384942889213562, decouple_loss:0.019015749916434288
The generated pressure mean: 0.44750165939331055
loss_pred:0.036453977227211, decouple_loss:0.018718820065259933
The generated pressure mean: 0.44780397415161133
loss_pred:0.03640109300613403, decouple_loss:0.018481271341443062
Iteration: 480, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4473133385181427
loss_pred:0.03402312844991684, decouple_loss:0.019340014085173607
The generated pressure mean: 0.4481607675552368
loss_pred:0.03477470949292183, decouple_loss:0.019244026392698288
The generated pressure mean: 0.4494800865650177
loss_pred:0.03548683226108551, decouple_loss:0.019130321219563484
2023-04-16 03:07:57 testing...
The generated pressure mean: 0.4495830535888672
The generated pressure mean: 0.4497888684272766
The generated pressure mean: 0.44987666606903076
loss_pred:0.04091280698776245, decouple_loss:0.019109200686216354
loss_pred:0.04199584946036339, decouple_loss:0.01908530481159687
loss_pred:0.040281809866428375, decouple_loss:0.01925438456237316
Loss: 0.042020972818136215, avg_mse: 0.0482424832880497
current test mse: 0.048242
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012018_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012018_3_24hr.npz
NaN value num: 0
Iteration: 481, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4490126073360443
loss_pred:0.03600602224469185, decouple_loss:0.019001781940460205
The generated pressure mean: 0.44786709547042847
The generated pressure mean: 0.44943419098854065
loss_pred:0.0355415977537632, decouple_loss:0.019238896667957306
loss_pred:0.0360095240175724, decouple_loss:0.019084228202700615
Iteration: 482, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4510590732097626
The generated pressure mean: 0.449035108089447
loss_pred:0.03693082183599472, decouple_loss:0.018870223313570023
loss_pred:0.03782526031136513, decouple_loss:0.01867149956524372
The generated pressure mean: 0.44929617643356323
loss_pred:0.035884175449609756, decouple_loss:0.018882708624005318
Iteration: 483, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44948524236679077
loss_pred:0.037328463047742844, decouple_loss:0.01922423020005226
The generated pressure mean: 0.44893208146095276
loss_pred:0.03570953384041786, decouple_loss:0.019077589735388756
The generated pressure mean: 0.4492180645465851
loss_pred:0.03743324428796768, decouple_loss:0.019207675009965897
Iteration: 484, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44823336601257324
loss_pred:0.038391705602407455, decouple_loss:0.018513120710849762
The generated pressure mean: 0.4487936794757843
The generated pressure mean: 0.4478776156902313
loss_pred:0.03597790002822876, decouple_loss:0.018518581986427307
loss_pred:0.03430517017841339, decouple_loss:0.0183049738407135
Iteration: 485, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4479435980319977
The generated pressure mean: 0.4492394030094147
loss_pred:0.03555047884583473, decouple_loss:0.017650563269853592
loss_pred:0.03483410179615021, decouple_loss:0.017620740458369255
The generated pressure mean: 0.4490082561969757
loss_pred:0.036476556211709976, decouple_loss:0.0177475418895483
Iteration: 486, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4485279321670532
loss_pred:0.034468408674001694, decouple_loss:0.018161097541451454
The generated pressure mean: 0.44851556420326233
loss_pred:0.03590582311153412, decouple_loss:0.01777384616434574
The generated pressure mean: 0.4486909806728363
loss_pred:0.03586189076304436, decouple_loss:0.01785941980779171
Iteration: 487, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4478102922439575
loss_pred:0.03594359755516052, decouple_loss:0.018466750159859657
The generated pressure mean: 0.44862130284309387
loss_pred:0.035642996430397034, decouple_loss:0.01818251609802246
The generated pressure mean: 0.44853314757347107
loss_pred:0.036496855318546295, decouple_loss:0.018916957080364227
Iteration: 488, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4482322037220001
The generated pressure mean: 0.44875583052635193
loss_pred:0.03548838943243027, decouple_loss:0.017474539577960968
loss_pred:0.0334777794778347, decouple_loss:0.01742595247924328
The generated pressure mean: 0.44879260659217834
loss_pred:0.037326909601688385, decouple_loss:0.01758352480828762
Iteration: 489, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.449535071849823
loss_pred:0.03453138843178749, decouple_loss:0.01692635379731655
The generated pressure mean: 0.4506921172142029
loss_pred:0.036310452967882156, decouple_loss:0.016990037634968758
The generated pressure mean: 0.44956347346305847
loss_pred:0.03381221368908882, decouple_loss:0.016695909202098846
Iteration: 490, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4499236047267914
loss_pred:0.035043083131313324, decouple_loss:0.016917463392019272
The generated pressure mean: 0.44916248321533203
loss_pred:0.036562446504831314, decouple_loss:0.017866969108581543
The generated pressure mean: 0.4475609362125397
loss_pred:0.035031966865062714, decouple_loss:0.01740679331123829
2023-04-16 03:10:28 testing...
The generated pressure mean: 0.4497888684272766
The generated pressure mean: 0.4495830833911896
The generated pressure mean: 0.44987666606903076
loss_pred:0.04101709648966789, decouple_loss:0.01709364540874958
loss_pred:0.04001504182815552, decouple_loss:0.01676061749458313
loss_pred:0.03859115019440651, decouple_loss:0.0168306827545166
Loss: 0.040719177573919296, avg_mse: 0.04660351946949959
current test mse: 0.046604
Iteration: 491, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45006632804870605
The generated pressure mean: 0.44955405592918396
loss_pred:0.03696347400546074, decouple_loss:0.01694510504603386
loss_pred:0.03436755761504173, decouple_loss:0.016541143879294395
The generated pressure mean: 0.4494500458240509
loss_pred:0.03741280734539032, decouple_loss:0.017177332192659378
Iteration: 492, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45011135935783386
The generated pressure mean: 0.4496171176433563
loss_pred:0.03499288111925125, decouple_loss:0.0174871813505888
loss_pred:0.03581423684954643, decouple_loss:0.017914438620209694
The generated pressure mean: 0.4482743740081787
loss_pred:0.036116134375333786, decouple_loss:0.0179256871342659
Iteration: 493, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4479655921459198
loss_pred:0.03568984940648079, decouple_loss:0.017288899049162865
The generated pressure mean: 0.44982975721359253
loss_pred:0.03615101799368858, decouple_loss:0.01733696646988392
The generated pressure mean: 0.44851455092430115
loss_pred:0.03613262251019478, decouple_loss:0.0171774011105299
Iteration: 494, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4493091106414795
The generated pressure mean: 0.4498286545276642
loss_pred:0.03395317122340202, decouple_loss:0.017521293833851814
loss_pred:0.03352568671107292, decouple_loss:0.01762583665549755
The generated pressure mean: 0.44849181175231934
loss_pred:0.037347860634326935, decouple_loss:0.017808394506573677
Iteration: 495, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44885823130607605
loss_pred:0.03408294916152954, decouple_loss:0.017281608656048775
The generated pressure mean: 0.44861990213394165
loss_pred:0.0360979326069355, decouple_loss:0.016805589199066162
The generated pressure mean: 0.4492822289466858
loss_pred:0.03564945235848427, decouple_loss:0.017345428466796875
Iteration: 496, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4500401020050049
The generated pressure mean: 0.44784530997276306
loss_pred:0.03569462522864342, decouple_loss:0.0168142206966877
loss_pred:0.03392840549349785, decouple_loss:0.016826286911964417
The generated pressure mean: 0.4479248821735382
loss_pred:0.03706168383359909, decouple_loss:0.016830695793032646
Iteration: 497, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44802820682525635
The generated pressure mean: 0.4490712285041809
loss_pred:0.03552475944161415, decouple_loss:0.01762654446065426
loss_pred:0.033555660396814346, decouple_loss:0.017780136317014694
The generated pressure mean: 0.4483950734138489
loss_pred:0.03579772263765335, decouple_loss:0.017996247857809067
Iteration: 498, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44945028424263
loss_pred:0.0332941859960556, decouple_loss:0.01856914348900318
The generated pressure mean: 0.4490033984184265
loss_pred:0.03271310776472092, decouple_loss:0.018626585602760315
The generated pressure mean: 0.4480951428413391
loss_pred:0.03696347028017044, decouple_loss:0.018666110932826996
Iteration: 499, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4483445882797241
loss_pred:0.03537401184439659, decouple_loss:0.018033329397439957
The generated pressure mean: 0.4488747715950012
loss_pred:0.03486107289791107, decouple_loss:0.018355298787355423
The generated pressure mean: 0.4491003453731537
loss_pred:0.03358916938304901, decouple_loss:0.018318545073270798
Iteration: 500, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.448900431394577
The generated pressure mean: 0.44937974214553833
loss_pred:0.03472620248794556, decouple_loss:0.016974855214357376
loss_pred:0.034907013177871704, decouple_loss:0.01714180037379265
The generated pressure mean: 0.44800862669944763
loss_pred:0.035902928560972214, decouple_loss:0.017146257683634758
2023-04-16 03:12:21 testing...
The generated pressure mean: 0.4495830535888672
The generated pressure mean: 0.449788898229599
The generated pressure mean: 0.44987666606903076
loss_pred:0.038935404270887375, decouple_loss:0.015022607520222664
loss_pred:0.03953923285007477, decouple_loss:0.015336512587964535
loss_pred:0.037810299545526505, decouple_loss:0.015078780241310596
Loss: 0.039518944919109344, avg_mse: 0.04510539770126343
current test mse: 0.045105
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012001_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012001_3_24hr.npz
NaN value num: 0
Iteration: 501, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.447295606136322
loss_pred:0.034492287784814835, decouple_loss:0.015552284196019173
The generated pressure mean: 0.4466308355331421
loss_pred:0.0335586816072464, decouple_loss:0.015566343441605568
The generated pressure mean: 0.44717469811439514
loss_pred:0.034234724938869476, decouple_loss:0.015632038936018944
Iteration: 502, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4471665024757385
The generated pressure mean: 0.44660329818725586
loss_pred:0.03456224501132965, decouple_loss:0.017016028985381126
loss_pred:0.03620960935950279, decouple_loss:0.016546422615647316
The generated pressure mean: 0.44794782996177673
loss_pred:0.03714849799871445, decouple_loss:0.016426030546426773
Iteration: 503, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44665172696113586
loss_pred:0.037407953292131424, decouple_loss:0.01917029172182083
The generated pressure mean: 0.44614535570144653
loss_pred:0.03758058696985245, decouple_loss:0.019519204273819923
The generated pressure mean: 0.4482124447822571
loss_pred:0.03604768216609955, decouple_loss:0.01938909851014614
Iteration: 504, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4472768306732178
The generated pressure mean: 0.44691503047943115
loss_pred:0.035577621310949326, decouple_loss:0.02333017811179161
loss_pred:0.03353188559412956, decouple_loss:0.02345157600939274
The generated pressure mean: 0.44731736183166504
loss_pred:0.035404615104198456, decouple_loss:0.02334839105606079
Iteration: 505, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4482123851776123
The generated pressure mean: 0.44640475511550903
loss_pred:0.035166990011930466, decouple_loss:0.019052671268582344
loss_pred:0.035902976989746094, decouple_loss:0.01913195662200451
The generated pressure mean: 0.446893572807312
loss_pred:0.03328711912035942, decouple_loss:0.018254555761814117
Iteration: 506, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44784805178642273The generated pressure mean: 0.4472036063671112
loss_pred:0.036155425012111664, decouple_loss:0.026156790554523468
loss_pred:0.03409922495484352, decouple_loss:0.02574322558939457
The generated pressure mean: 0.44738903641700745
loss_pred:0.03541828319430351, decouple_loss:0.025574972853064537
Iteration: 507, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4471668004989624The generated pressure mean: 0.4467073082923889
loss_pred:0.03442130982875824, decouple_loss:0.01977068930864334loss_pred:0.03514667972922325, decouple_loss:0.019320817664265633
The generated pressure mean: 0.44753625988960266
loss_pred:0.033410701900720596, decouple_loss:0.01914948597550392
Iteration: 508, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4463751018047333
The generated pressure mean: 0.44715994596481323
loss_pred:0.034420181065797806, decouple_loss:0.025917191058397293
loss_pred:0.035694271326065063, decouple_loss:0.026062997058033943
The generated pressure mean: 0.4478078782558441
loss_pred:0.03498397022485733, decouple_loss:0.02601025626063347
Iteration: 509, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4465223252773285
The generated pressure mean: 0.4469364881515503
loss_pred:0.033862125128507614, decouple_loss:0.020175212994217873
loss_pred:0.03485286235809326, decouple_loss:0.0201860461384058
The generated pressure mean: 0.4482475817203522
loss_pred:0.03473518043756485, decouple_loss:0.020400088280439377
Iteration: 510, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4480387568473816
The generated pressure mean: 0.4473952651023865
loss_pred:0.03597236052155495, decouple_loss:0.026571836322546005
loss_pred:0.034806735813617706, decouple_loss:0.026633890345692635
The generated pressure mean: 0.4466247856616974
loss_pred:0.035538092255592346, decouple_loss:0.026593349874019623
2023-04-16 03:14:50 testing...
The generated pressure mean: 0.4497888684272766
The generated pressure mean: 0.4495830237865448
The generated pressure mean: 0.44987666606903076
loss_pred:0.04052190110087395, decouple_loss:0.021198589354753494
loss_pred:0.039746031165122986, decouple_loss:0.021098554134368896
loss_pred:0.038819700479507446, decouple_loss:0.021045610308647156
Loss: 0.04075159132480621, avg_mse: 0.046835627406835556
current test mse: 0.046836
Iteration: 511, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.448147714138031
The generated pressure mean: 0.4474722146987915
loss_pred:0.03439640626311302, decouple_loss:0.021093476563692093
loss_pred:0.0344357043504715, decouple_loss:0.02111075259745121
The generated pressure mean: 0.44737738370895386
loss_pred:0.03536807373166084, decouple_loss:0.020950358361005783
Iteration: 512, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44720712304115295
The generated pressure mean: 0.44818082451820374
loss_pred:0.03526706621050835, decouple_loss:0.025832606479525566
loss_pred:0.033603593707084656, decouple_loss:0.025845900177955627
The generated pressure mean: 0.44812071323394775
loss_pred:0.03479921072721481, decouple_loss:0.02595498599112034
Iteration: 513, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44703611731529236
loss_pred:0.03370695933699608, decouple_loss:0.022654326632618904
The generated pressure mean: 0.4460698068141937
loss_pred:0.03409487009048462, decouple_loss:0.023166868835687637
The generated pressure mean: 0.4470263421535492
loss_pred:0.032792046666145325, decouple_loss:0.023013606667518616
Iteration: 514, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4467913806438446
The generated pressure mean: 0.44814741611480713
loss_pred:0.034607842564582825, decouple_loss:0.020841071382164955
loss_pred:0.03465089574456215, decouple_loss:0.020570948719978333
The generated pressure mean: 0.4476989805698395
loss_pred:0.03445237874984741, decouple_loss:0.020160218700766563
Iteration: 515, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4472956657409668
loss_pred:0.033632706850767136, decouple_loss:0.021703556180000305
The generated pressure mean: 0.4475524127483368
loss_pred:0.032993968576192856, decouple_loss:0.021642660722136497
The generated pressure mean: 0.44719362258911133
loss_pred:0.033948786556720734, decouple_loss:0.021739322692155838
Iteration: 516, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44684135913848877
loss_pred:0.03320710361003876, decouple_loss:0.01913241297006607
The generated pressure mean: 0.4465309977531433
loss_pred:0.0322376973927021, decouple_loss:0.019072601571679115
The generated pressure mean: 0.4474543035030365
loss_pred:0.03468293696641922, decouple_loss:0.01895766332745552
Iteration: 517, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44609716534614563
loss_pred:0.035024549812078476, decouple_loss:0.020199695602059364
The generated pressure mean: 0.447307288646698
loss_pred:0.03455853834748268, decouple_loss:0.020059630274772644
The generated pressure mean: 0.446953147649765
loss_pred:0.03424932062625885, decouple_loss:0.020127300173044205
Iteration: 518, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4471932649612427
loss_pred:0.033265840262174606, decouple_loss:0.017414895817637444
The generated pressure mean: 0.4466235935688019
loss_pred:0.03512308746576309, decouple_loss:0.01730530336499214
The generated pressure mean: 0.44766610860824585
loss_pred:0.03426525369286537, decouple_loss:0.017032520845532417
Iteration: 519, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44667768478393555
loss_pred:0.03353945165872574, decouple_loss:0.018333708867430687
The generated pressure mean: 0.44840213656425476
loss_pred:0.034068942070007324, decouple_loss:0.01882803440093994
The generated pressure mean: 0.4487560987472534
loss_pred:0.0334877073764801, decouple_loss:0.01874210499227047
Iteration: 520, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44669532775878906
loss_pred:0.033895861357450485, decouple_loss:0.0172781553119421
The generated pressure mean: 0.44685688614845276
loss_pred:0.03207685425877571, decouple_loss:0.017060749232769012
The generated pressure mean: 0.44695714116096497
loss_pred:0.03331824764609337, decouple_loss:0.01752248965203762
2023-04-16 03:16:44 testing...
The generated pressure mean: 0.4495830833911896
The generated pressure mean: 0.4497888684272766
The generated pressure mean: 0.44987666606903076
loss_pred:0.040765635669231415, decouple_loss:0.017575357109308243
loss_pred:0.04175477474927902, decouple_loss:0.01752491295337677
loss_pred:0.03980305790901184, decouple_loss:0.0178226288408041
Loss: 0.04165653884410858, avg_mse: 0.04920041188597679
current test mse: 0.0492
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012000_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012000_3_24hr.npz
NaN value num: 0
Iteration: 521, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44923028349876404
loss_pred:0.0333448201417923, decouple_loss:0.017526419833302498
The generated pressure mean: 0.44736945629119873
loss_pred:0.033537425100803375, decouple_loss:0.01779930107295513
The generated pressure mean: 0.4472600817680359
loss_pred:0.03301894664764404, decouple_loss:0.018331211060285568
Iteration: 522, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44794392585754395
The generated pressure mean: 0.44889628887176514
loss_pred:0.03278429061174393, decouple_loss:0.016538802534341812
loss_pred:0.03402481973171234, decouple_loss:0.016263194382190704
The generated pressure mean: 0.4481538236141205
loss_pred:0.03277910500764847, decouple_loss:0.015991605818271637
Iteration: 523, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4487685561180115
The generated pressure mean: 0.44750961661338806
loss_pred:0.03569508716464043, decouple_loss:0.016249436885118484
loss_pred:0.03140744939446449, decouple_loss:0.015966318547725677
The generated pressure mean: 0.44831985235214233
loss_pred:0.032669875770807266, decouple_loss:0.016082026064395905
Iteration: 524, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44661128520965576
The generated pressure mean: 0.44858020544052124
loss_pred:0.03335067629814148, decouple_loss:0.017161495983600616
loss_pred:0.03311982378363609, decouple_loss:0.01655682921409607
The generated pressure mean: 0.44830477237701416
loss_pred:0.032877109944820404, decouple_loss:0.017585525289177895
Iteration: 525, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4490028917789459
The generated pressure mean: 0.4478943645954132
loss_pred:0.0341087281703949, decouple_loss:0.015367614105343819
loss_pred:0.033059004694223404, decouple_loss:0.015902522951364517
The generated pressure mean: 0.44738543033599854
loss_pred:0.03138042986392975, decouple_loss:0.015526991337537766
Iteration: 526, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4482327401638031
loss_pred:0.032153189182281494, decouple_loss:0.018701815977692604
The generated pressure mean: 0.44793716073036194
loss_pred:0.033147234469652176, decouple_loss:0.018430063501000404
The generated pressure mean: 0.44871610403060913
loss_pred:0.03227848559617996, decouple_loss:0.018935823813080788
Iteration: 527, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.449217826128006
The generated pressure mean: 0.44790494441986084
loss_pred:0.033233776688575745, decouple_loss:0.015485704876482487
loss_pred:0.03353583440184593, decouple_loss:0.015115580521523952
The generated pressure mean: 0.4476604163646698
loss_pred:0.033636484295129776, decouple_loss:0.015852071344852448
Iteration: 528, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4482777416706085
The generated pressure mean: 0.44775640964508057
loss_pred:0.03206263482570648, decouple_loss:0.017104245722293854
loss_pred:0.03205201029777527, decouple_loss:0.016958683729171753
The generated pressure mean: 0.4481850862503052
loss_pred:0.033017486333847046, decouple_loss:0.016099559143185616
Iteration: 529, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44783085584640503
The generated pressure mean: 0.4484160840511322
loss_pred:0.03334112837910652, decouple_loss:0.01749548874795437
loss_pred:0.03313315287232399, decouple_loss:0.01712668314576149
The generated pressure mean: 0.4470460116863251
loss_pred:0.030916593968868256, decouple_loss:0.016389120370149612
Iteration: 530, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44902482628822327
The generated pressure mean: 0.4473118782043457
loss_pred:0.032926641404628754, decouple_loss:0.016025077551603317
loss_pred:0.033604178577661514, decouple_loss:0.016500620171427727
The generated pressure mean: 0.447195440530777
loss_pred:0.03331920877099037, decouple_loss:0.016557026654481888
2023-04-16 03:19:18 testing...
The generated pressure mean: 0.4497888684272766
The generated pressure mean: 0.4495830833911896
The generated pressure mean: 0.44987666606903076
loss_pred:0.039588093757629395, decouple_loss:0.015853576362133026
loss_pred:0.03813862428069115, decouple_loss:0.015614314936101437
loss_pred:0.037310000509023666, decouple_loss:0.01575671136379242
Loss: 0.039132650941610336, avg_mse: 0.04491371288895607
current test mse: 0.044914
Iteration: 531, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.449720174074173
loss_pred:0.034320324659347534, decouple_loss:0.015322016552090645
The generated pressure mean: 0.44823944568634033
loss_pred:0.03344358131289482, decouple_loss:0.016971530392766
The generated pressure mean: 0.44937461614608765
loss_pred:0.03326495736837387, decouple_loss:0.015368087217211723
Iteration: 532, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4500364661216736
loss_pred:0.03408034145832062, decouple_loss:0.016864554956555367
The generated pressure mean: 0.4491988718509674
loss_pred:0.03329300880432129, decouple_loss:0.016609692946076393
The generated pressure mean: 0.4492894113063812
loss_pred:0.03303247690200806, decouple_loss:0.016667714342474937
Iteration: 533, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4464573562145233
loss_pred:0.03422275930643082, decouple_loss:0.015637751668691635
The generated pressure mean: 0.4474087059497833
loss_pred:0.0329229012131691, decouple_loss:0.0159841850399971
The generated pressure mean: 0.4485984742641449
loss_pred:0.03226161748170853, decouple_loss:0.0157835241407156
Iteration: 534, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4491006135940552
loss_pred:0.034531403332948685, decouple_loss:0.015106205828487873
The generated pressure mean: 0.4472803473472595
loss_pred:0.033621709793806076, decouple_loss:0.015028680674731731
The generated pressure mean: 0.44693103432655334
loss_pred:0.033939145505428314, decouple_loss:0.01666681468486786
Iteration: 535, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4460189938545227
loss_pred:0.03349893540143967, decouple_loss:0.014695154502987862
The generated pressure mean: 0.4493301808834076
loss_pred:0.03267461806535721, decouple_loss:0.014971432276070118
The generated pressure mean: 0.4473456144332886
loss_pred:0.032836221158504486, decouple_loss:0.014582455158233643
Iteration: 536, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4488295018672943
loss_pred:0.031478069722652435, decouple_loss:0.01604027859866619
The generated pressure mean: 0.4480293095111847
loss_pred:0.03360585495829582, decouple_loss:0.015567745082080364
The generated pressure mean: 0.44876590371131897
loss_pred:0.03293121978640556, decouple_loss:0.014945823699235916
Iteration: 537, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4468691051006317
loss_pred:0.0321338027715683, decouple_loss:0.014426133595407009
The generated pressure mean: 0.44705820083618164
loss_pred:0.03209131956100464, decouple_loss:0.01451784186065197
The generated pressure mean: 0.4471632242202759
loss_pred:0.032666753977537155, decouple_loss:0.014375857077538967
Iteration: 538, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4469315707683563
loss_pred:0.03182042017579079, decouple_loss:0.016278298571705818
The generated pressure mean: 0.44701385498046875
loss_pred:0.032749272882938385, decouple_loss:0.01692875102162361
The generated pressure mean: 0.4461825489997864
loss_pred:0.03233175724744797, decouple_loss:0.016353173181414604
Iteration: 539, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4474874436855316
loss_pred:0.030920037999749184, decouple_loss:0.01480331551283598
The generated pressure mean: 0.4476581811904907
loss_pred:0.032010458409786224, decouple_loss:0.015030010603368282
The generated pressure mean: 0.4464013874530792
loss_pred:0.03300614282488823, decouple_loss:0.01577160321176052
Iteration: 540, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4501919448375702
loss_pred:0.03359644114971161, decouple_loss:0.015544923022389412
The generated pressure mean: 0.4488774240016937
loss_pred:0.03170395269989967, decouple_loss:0.015903767198324203
The generated pressure mean: 0.4488517940044403
loss_pred:0.03406567499041557, decouple_loss:0.01563735119998455
2023-04-16 03:21:13 testing...
The generated pressure mean: 0.4495830833911896
The generated pressure mean: 0.4497888684272766
The generated pressure mean: 0.44987666606903076
loss_pred:0.03853766247630119, decouple_loss:0.016718829050660133
loss_pred:0.03926782310009003, decouple_loss:0.01662585698068142
loss_pred:0.03740180656313896, decouple_loss:0.01681167632341385
Loss: 0.03923837095499039, avg_mse: 0.04530754312872887
current test mse: 0.045308
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012010_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012010_3_24hr.npz
NaN value num: 0
Iteration: 541, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4473322331905365
loss_pred:0.03145141154527664, decouple_loss:0.016828708350658417
The generated pressure mean: 0.44643402099609375
loss_pred:0.033404894173145294, decouple_loss:0.017169484868645668
The generated pressure mean: 0.44736284017562866
loss_pred:0.034687332808971405, decouple_loss:0.0172391589730978
Iteration: 542, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44708606600761414
loss_pred:0.033076126128435135, decouple_loss:0.016284342855215073
The generated pressure mean: 0.4483828842639923
loss_pred:0.034198097884655, decouple_loss:0.0154397152364254
The generated pressure mean: 0.447325736284256
loss_pred:0.03266354650259018, decouple_loss:0.01624702662229538
Iteration: 543, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4472237229347229
loss_pred:0.033409155905246735, decouple_loss:0.016818299889564514
The generated pressure mean: 0.44590359926223755
The generated pressure mean: 0.4477153718471527
loss_pred:0.03245876729488373, decouple_loss:0.016969969496130943
loss_pred:0.03223134204745293, decouple_loss:0.017202161252498627
Iteration: 544, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4465268850326538
loss_pred:0.03304773196578026, decouple_loss:0.017647337168455124
The generated pressure mean: 0.44764435291290283
loss_pred:0.03256067633628845, decouple_loss:0.017523709684610367
The generated pressure mean: 0.44760996103286743
loss_pred:0.03306208923459053, decouple_loss:0.01759331487119198
Iteration: 545, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4474668800830841
loss_pred:0.03374586999416351, decouple_loss:0.01662139967083931
The generated pressure mean: 0.4480712115764618
The generated pressure mean: 0.4459474980831146
loss_pred:0.0346188023686409, decouple_loss:0.01683991402387619
loss_pred:0.03353526070713997, decouple_loss:0.017090484499931335
Iteration: 546, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4479389190673828
loss_pred:0.034143779426813126, decouple_loss:0.015300780534744263
The generated pressure mean: 0.4460480511188507
The generated pressure mean: 0.44698426127433777
loss_pred:0.03377968817949295, decouple_loss:0.015027496963739395
loss_pred:0.031915951520204544, decouple_loss:0.015184449963271618
Iteration: 547, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4484071731567383
loss_pred:0.031967148184776306, decouple_loss:0.016198480501770973
The generated pressure mean: 0.44671371579170227
The generated pressure mean: 0.4478013217449188
loss_pred:0.03406362980604172, decouple_loss:0.015640035271644592
loss_pred:0.031927499920129776, decouple_loss:0.016469260677695274
Iteration: 548, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44731026887893677
loss_pred:0.032341957092285156, decouple_loss:0.018050383776426315
The generated pressure mean: 0.4480937123298645
The generated pressure mean: 0.4485853612422943
loss_pred:0.03149992600083351, decouple_loss:0.01789129339158535
loss_pred:0.032394830137491226, decouple_loss:0.017678456380963326
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 549, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4475243091583252
loss_pred:0.032469991594552994, decouple_loss:0.016394495964050293
The generated pressure mean: 0.44725489616394043
The generated pressure mean: 0.44717881083488464
loss_pred:0.0339367613196373, decouple_loss:0.016850123181939125
loss_pred:0.03275226801633835, decouple_loss:0.016726285219192505
Iteration: 550, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44660109281539917
loss_pred:0.03163045272231102, decouple_loss:0.015411640517413616
The generated pressure mean: 0.44772443175315857
loss_pred:0.03257008641958237, decouple_loss:0.015056917443871498
The generated pressure mean: 0.44761785864830017
loss_pred:0.032088231295347214, decouple_loss:0.015116500668227673
2023-04-16 03:23:42 testing...
The generated pressure mean: 0.4497888684272766
The generated pressure mean: 0.4495830535888672
The generated pressure mean: 0.44987666606903076
loss_pred:0.038679033517837524, decouple_loss:0.015568938106298447
loss_pred:0.03786280378699303, decouple_loss:0.015332408249378204
loss_pred:0.036908894777297974, decouple_loss:0.015436483547091484
Loss: 0.03858920931816101, avg_mse: 0.044381044805049896
current test mse: 0.044381
Iteration: 551, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4461391866207123
loss_pred:0.0316435880959034, decouple_loss:0.015546821989119053
The generated pressure mean: 0.4476853907108307
loss_pred:0.03373530134558678, decouple_loss:0.015180185437202454
The generated pressure mean: 0.44788992404937744
loss_pred:0.03300756216049194, decouple_loss:0.015018291771411896
Iteration: 552, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44755229353904724
loss_pred:0.033074431121349335, decouple_loss:0.017489919438958168
The generated pressure mean: 0.4468335509300232
loss_pred:0.03186279907822609, decouple_loss:0.017597980797290802
The generated pressure mean: 0.4484719932079315
loss_pred:0.032011572271585464, decouple_loss:0.017676817253232002
Iteration: 553, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44836685061454773
loss_pred:0.03367866948246956, decouple_loss:0.016639526933431625
The generated pressure mean: 0.44754186272621155
loss_pred:0.03181159496307373, decouple_loss:0.01694513112306595
The generated pressure mean: 0.44790297746658325
loss_pred:0.032505102455616, decouple_loss:0.017277240753173828
Iteration: 554, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44793903827667236
loss_pred:0.03410845622420311, decouple_loss:0.015506722033023834
The generated pressure mean: 0.44676151871681213
The generated pressure mean: 0.44779470562934875
loss_pred:0.0312049500644207, decouple_loss:0.015401337295770645
loss_pred:0.0319487489759922, decouple_loss:0.015559138730168343
Iteration: 555, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44711533188819885
loss_pred:0.031597428023815155, decouple_loss:0.01640664041042328
The generated pressure mean: 0.4472489058971405
loss_pred:0.03269581124186516, decouple_loss:0.015945499762892723
The generated pressure mean: 0.4482315480709076
loss_pred:0.032075006514787674, decouple_loss:0.016306797042489052
Iteration: 556, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4476871192455292
loss_pred:0.03367218002676964, decouple_loss:0.018014753237366676
The generated pressure mean: 0.4462706446647644
loss_pred:0.03330365568399429, decouple_loss:0.018126124516129494
The generated pressure mean: 0.4463503956794739
loss_pred:0.030776366591453552, decouple_loss:0.017849376425147057
Iteration: 557, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4481946527957916
loss_pred:0.03317070007324219, decouple_loss:0.01728983037173748
The generated pressure mean: 0.44724777340888977
loss_pred:0.03233575448393822, decouple_loss:0.01767672598361969
The generated pressure mean: 0.4473015367984772
loss_pred:0.03207053989171982, decouple_loss:0.01725149154663086
Iteration: 558, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44661808013916016
loss_pred:0.03279253467917442, decouple_loss:0.016145361587405205
The generated pressure mean: 0.44677478075027466
loss_pred:0.03312648832798004, decouple_loss:0.016164561733603477
The generated pressure mean: 0.4477333128452301
loss_pred:0.032319024205207825, decouple_loss:0.015512275509536266
Iteration: 559, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4479878842830658
loss_pred:0.03315657749772072, decouple_loss:0.01670842245221138
The generated pressure mean: 0.44749799370765686
loss_pred:0.03326353430747986, decouple_loss:0.016389869153499603
The generated pressure mean: 0.44749343395233154
loss_pred:0.033639442175626755, decouple_loss:0.016366705298423767
Iteration: 560, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.448092520236969
loss_pred:0.03356952965259552, decouple_loss:0.017143407836556435
The generated pressure mean: 0.44816112518310547
loss_pred:0.031027277931571007, decouple_loss:0.017097247764468193
The generated pressure mean: 0.4473837912082672
loss_pred:0.03194214776158333, decouple_loss:0.017665958032011986
2023-04-16 03:25:36 testing...
The generated pressure mean: 0.4495830833911896
The generated pressure mean: 0.449788898229599
The generated pressure mean: 0.44987666606903076
loss_pred:0.03880596533417702, decouple_loss:0.016542948782444
loss_pred:0.039928898215293884, decouple_loss:0.016482587903738022
loss_pred:0.038153987377882004, decouple_loss:0.016281910240650177
Loss: 0.039784740656614304, avg_mse: 0.04665005952119827
current test mse: 0.04665
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012017_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012017_3_24hr.npz
NaN value num: 0
Iteration: 561, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44762372970581055
loss_pred:0.03164161741733551, decouple_loss:0.016173765063285828
The generated pressure mean: 0.44872283935546875
The generated pressure mean: 0.4484468698501587
loss_pred:0.03228405490517616, decouple_loss:0.016603820025920868
loss_pred:0.03168541193008423, decouple_loss:0.015839358791708946
Iteration: 562, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44816479086875916
loss_pred:0.031059972941875458, decouple_loss:0.015857895836234093
The generated pressure mean: 0.44797733426094055
loss_pred:0.031213810667395592, decouple_loss:0.015850700438022614
The generated pressure mean: 0.4478549063205719
loss_pred:0.031070902943611145, decouple_loss:0.01577596738934517
Iteration: 563, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4481227993965149
loss_pred:0.03193036839365959, decouple_loss:0.015309518203139305
The generated pressure mean: 0.44791847467422485
loss_pred:0.03294090926647186, decouple_loss:0.015010827220976353
The generated pressure mean: 0.44795534014701843
loss_pred:0.032745301723480225, decouple_loss:0.015085989609360695
Iteration: 564, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44830814003944397
loss_pred:0.03126993775367737, decouple_loss:0.014858493581414223
The generated pressure mean: 0.44863346219062805
loss_pred:0.03151259198784828, decouple_loss:0.015220439061522484
The generated pressure mean: 0.44824522733688354
loss_pred:0.0329250693321228, decouple_loss:0.015299071557819843
Iteration: 565, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44800901412963867
loss_pred:0.03147507458925247, decouple_loss:0.014989269897341728
The generated pressure mean: 0.44822442531585693
loss_pred:0.032039985060691833, decouple_loss:0.014981807209551334
The generated pressure mean: 0.448091596364975
loss_pred:0.03272474557161331, decouple_loss:0.015058866702020168
Iteration: 566, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44888076186180115
loss_pred:0.03144212067127228, decouple_loss:0.015145535580813885
The generated pressure mean: 0.44781357049942017
loss_pred:0.03249971941113472, decouple_loss:0.014678480103611946
The generated pressure mean: 0.44811657071113586
loss_pred:0.031093422323465347, decouple_loss:0.015304690226912498
Iteration: 567, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4478556215763092
loss_pred:0.032325513660907745, decouple_loss:0.01507648453116417
The generated pressure mean: 0.4477875232696533
loss_pred:0.032070696353912354, decouple_loss:0.014641563408076763
The generated pressure mean: 0.44802403450012207
loss_pred:0.032027680426836014, decouple_loss:0.01474884431809187
Iteration: 568, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44890785217285156
The generated pressure mean: 0.4470321238040924
loss_pred:0.032476700842380524, decouple_loss:0.014277242124080658
loss_pred:0.03197753429412842, decouple_loss:0.014881322160363197
The generated pressure mean: 0.44875863194465637
loss_pred:0.03188521787524223, decouple_loss:0.014062641188502312
Iteration: 569, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4480210542678833
loss_pred:0.03177811950445175, decouple_loss:0.014357236213982105
The generated pressure mean: 0.44816285371780396
The generated pressure mean: 0.44745364785194397
loss_pred:0.03233298286795616, decouple_loss:0.014014865271747112
loss_pred:0.032765261828899384, decouple_loss:0.014113686978816986
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 570, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44879159331321716
loss_pred:0.031742531806230545, decouple_loss:0.013528547249734402
The generated pressure mean: 0.4482780694961548
loss_pred:0.032240480184555054, decouple_loss:0.013240987434983253
The generated pressure mean: 0.44823944568634033
loss_pred:0.03187315911054611, decouple_loss:0.013090305961668491
2023-04-16 03:28:02 testing...
The generated pressure mean: 0.4495830535888672
The generated pressure mean: 0.4497888684272766
The generated pressure mean: 0.44987666606903076
loss_pred:0.038484491407871246, decouple_loss:0.016150671988725662
loss_pred:0.0385429672896862, decouple_loss:0.016159232705831528
loss_pred:0.037741269916296005, decouple_loss:0.0162335317581892
Loss: 0.03906530141830444, avg_mse: 0.04564935714006424
current test mse: 0.045649
Iteration: 571, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4480619728565216
The generated pressure mean: 0.44810548424720764
loss_pred:0.031840503215789795, decouple_loss:0.016463033854961395
loss_pred:0.030871083959937096, decouple_loss:0.01665954664349556
The generated pressure mean: 0.4473591446876526
loss_pred:0.033625759184360504, decouple_loss:0.015672903507947922
Iteration: 572, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44832268357276917
loss_pred:0.030549420043826103, decouple_loss:0.018919119611382484
The generated pressure mean: 0.44853079319000244
loss_pred:0.031036606058478355, decouple_loss:0.018985958769917488
The generated pressure mean: 0.4473022222518921
loss_pred:0.03300303593277931, decouple_loss:0.01889951340854168
Iteration: 573, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44616711139678955
loss_pred:0.03221569582819939, decouple_loss:0.01716199330985546
The generated pressure mean: 0.44700318574905396
loss_pred:0.03269055113196373, decouple_loss:0.01673593930900097
The generated pressure mean: 0.4482062757015228
loss_pred:0.032440319657325745, decouple_loss:0.016972359269857407
Iteration: 574, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44733431935310364
loss_pred:0.0337136909365654, decouple_loss:0.017855705693364143
The generated pressure mean: 0.4476214051246643
loss_pred:0.031050648540258408, decouple_loss:0.018167855218052864
The generated pressure mean: 0.4478228688240051
loss_pred:0.03186947479844093, decouple_loss:0.0179840549826622
Iteration: 575, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.447857141494751
loss_pred:0.03113595023751259, decouple_loss:0.01709800213575363
The generated pressure mean: 0.447913259267807
loss_pred:0.03042536787688732, decouple_loss:0.017021067440509796
The generated pressure mean: 0.4487875998020172
loss_pred:0.03130815923213959, decouple_loss:0.0172492153942585
Iteration: 576, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4478384852409363
loss_pred:0.032801903784275055, decouple_loss:0.019663307815790176
The generated pressure mean: 0.4482143521308899
loss_pred:0.031249532476067543, decouple_loss:0.019589172676205635
The generated pressure mean: 0.4472324848175049
loss_pred:0.03268847614526749, decouple_loss:0.01981736719608307
Iteration: 577, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4477509558200836
loss_pred:0.032786473631858826, decouple_loss:0.017305050045251846
The generated pressure mean: 0.447463721036911
loss_pred:0.032188545912504196, decouple_loss:0.017079947516322136
The generated pressure mean: 0.44783005118370056
loss_pred:0.03277340158820152, decouple_loss:0.01758202724158764
Iteration: 578, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4479690492153168
loss_pred:0.031495485454797745, decouple_loss:0.021234167739748955
The generated pressure mean: 0.44752660393714905
loss_pred:0.03222718834877014, decouple_loss:0.021785274147987366
The generated pressure mean: 0.4471516013145447
loss_pred:0.03181593120098114, decouple_loss:0.02115904726088047
Iteration: 579, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44637298583984375
loss_pred:0.032152459025382996, decouple_loss:0.017454009503126144
The generated pressure mean: 0.44781047105789185
loss_pred:0.032800111919641495, decouple_loss:0.01770397089421749
The generated pressure mean: 0.44676509499549866
loss_pred:0.032343193888664246, decouple_loss:0.017628634348511696
Iteration: 580, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44692254066467285
loss_pred:0.03190657123923302, decouple_loss:0.020140105858445168
The generated pressure mean: 0.44657102227211
loss_pred:0.03285728394985199, decouple_loss:0.01996600814163685
The generated pressure mean: 0.44740691781044006
loss_pred:0.03380895033478737, decouple_loss:0.01994730718433857
2023-04-16 03:29:55 testing...
The generated pressure mean: 0.4497888684272766
The generated pressure mean: 0.4495830833911896
The generated pressure mean: 0.44987666606903076
loss_pred:0.0381896011531353, decouple_loss:0.017058100551366806
loss_pred:0.037319015711545944, decouple_loss:0.01710664853453636
loss_pred:0.03606932610273361, decouple_loss:0.017121538519859314
Loss: 0.038047417998313904, avg_mse: 0.04368298500776291
current test mse: 0.043683
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012019_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012019_3_24hr.npz
NaN value num: 0
Iteration: 581, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44869744777679443
loss_pred:0.03225797787308693, decouple_loss:0.016927458345890045
The generated pressure mean: 0.4486227035522461
loss_pred:0.03150611370801926, decouple_loss:0.017110634595155716
The generated pressure mean: 0.4494834542274475
loss_pred:0.03168294206261635, decouple_loss:0.017248334363102913
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 582, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4486866891384125
loss_pred:0.03152487054467201, decouple_loss:0.01951860636472702
The generated pressure mean: 0.4491133987903595
The generated pressure mean: 0.4494735300540924
loss_pred:0.03199811279773712, decouple_loss:0.019261235371232033
loss_pred:0.03213609382510185, decouple_loss:0.019646404311060905
Iteration: 583, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4491598308086395
loss_pred:0.032472897320985794, decouple_loss:0.017066607251763344
The generated pressure mean: 0.4473295509815216
The generated pressure mean: 0.44894957542419434
loss_pred:0.03365181386470795, decouple_loss:0.01682255044579506
loss_pred:0.03269766643643379, decouple_loss:0.017074495553970337
Iteration: 584, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4493795335292816
loss_pred:0.030341463163495064, decouple_loss:0.018904875963926315
The generated pressure mean: 0.4483930766582489
The generated pressure mean: 0.4490557909011841
loss_pred:0.03289896622300148, decouple_loss:0.018874915316700935
loss_pred:0.03344576433300972, decouple_loss:0.019006231799721718
Iteration: 585, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4488207697868347
loss_pred:0.03341371566057205, decouple_loss:0.016474278643727303
The generated pressure mean: 0.44886159896850586
The generated pressure mean: 0.4491555094718933
loss_pred:0.03383121266961098, decouple_loss:0.016520319506525993
loss_pred:0.03234762325882912, decouple_loss:0.016543420031666756
Iteration: 586, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44813087582588196
loss_pred:0.03338342159986496, decouple_loss:0.01817701756954193
The generated pressure mean: 0.4489925801753998
loss_pred:0.03167495131492615, decouple_loss:0.018076138570904732The generated pressure mean: 0.4489932656288147
loss_pred:0.032542284578084946, decouple_loss:0.018303992226719856
Iteration: 587, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4489731192588806
loss_pred:0.03080105036497116, decouple_loss:0.01647043228149414
The generated pressure mean: 0.449386328458786
loss_pred:0.03298018127679825, decouple_loss:0.016836246475577354
The generated pressure mean: 0.4477930963039398
loss_pred:0.03340553119778633, decouple_loss:0.01645767316222191
Iteration: 588, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44782623648643494
loss_pred:0.03250731900334358, decouple_loss:0.016721226274967194
The generated pressure mean: 0.448279470205307
The generated pressure mean: 0.44856327772140503
loss_pred:0.0336039662361145, decouple_loss:0.016274886205792427
loss_pred:0.033629994839429855, decouple_loss:0.016355009749531746
Iteration: 589, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4483850300312042
loss_pred:0.03205607458949089, decouple_loss:0.016856707632541656
The generated pressure mean: 0.4493986666202545
loss_pred:0.03258070349693298, decouple_loss:0.017438286915421486
The generated pressure mean: 0.449418306350708
loss_pred:0.03418367728590965, decouple_loss:0.017567098140716553
Iteration: 590, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4481312036514282
loss_pred:0.033682722598314285, decouple_loss:0.017666487023234367
The generated pressure mean: 0.44819584488868713
loss_pred:0.033613964915275574, decouple_loss:0.017028450965881348
The generated pressure mean: 0.44788864254951477
loss_pred:0.03404321148991585, decouple_loss:0.017510386183857918
2023-04-16 03:32:28 testing...
The generated pressure mean: 0.4495830535888672
The generated pressure mean: 0.4497888684272766
The generated pressure mean: 0.44987666606903076
loss_pred:0.03965524956583977, decouple_loss:0.019469982013106346
loss_pred:0.04077378660440445, decouple_loss:0.019372880458831787
loss_pred:0.03804873302578926, decouple_loss:0.019634578377008438
Loss: 0.040467213839292526, avg_mse: 0.04747965186834335
current test mse: 0.04748
Iteration: 591, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4481983184814453
loss_pred:0.035404056310653687, decouple_loss:0.019467579200863838
The generated pressure mean: 0.4481603503227234
loss_pred:0.03429166600108147, decouple_loss:0.01938186027109623
The generated pressure mean: 0.4484134614467621
loss_pred:0.034334875643253326, decouple_loss:0.019474703818559647
Iteration: 592, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44908517599105835
The generated pressure mean: 0.4489580988883972
loss_pred:0.033220015466213226, decouple_loss:0.017106616869568825
loss_pred:0.03274763375520706, decouple_loss:0.01676667109131813
The generated pressure mean: 0.4485247731208801
loss_pred:0.03439561650156975, decouple_loss:0.01729840785264969
Iteration: 593, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4489286243915558
The generated pressure mean: 0.44877132773399353
loss_pred:0.031947556883096695, decouple_loss:0.018420647829771042
loss_pred:0.03302483260631561, decouple_loss:0.018335780128836632
The generated pressure mean: 0.4479416310787201
loss_pred:0.03291197493672371, decouple_loss:0.018281197175383568
Iteration: 594, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4490394592285156
The generated pressure mean: 0.4478198289871216
loss_pred:0.032485149800777435, decouple_loss:0.017875758931040764
loss_pred:0.034254319965839386, decouple_loss:0.017874538898468018
The generated pressure mean: 0.44853857159614563
loss_pred:0.031735386699438095, decouple_loss:0.018081871792674065
Iteration: 595, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4479733109474182
loss_pred:0.03388955816626549, decouple_loss:0.017071720212697983
The generated pressure mean: 0.4495750665664673
loss_pred:0.03220103308558464, decouple_loss:0.017052769660949707
The generated pressure mean: 0.4492949843406677
loss_pred:0.03202143311500549, decouple_loss:0.017016898840665817
Iteration: 596, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4480118453502655
loss_pred:0.03270093724131584, decouple_loss:0.018814539536833763
The generated pressure mean: 0.4491564631462097
loss_pred:0.031520672142505646, decouple_loss:0.018125830218195915
The generated pressure mean: 0.44751986861228943
loss_pred:0.033648040145635605, decouple_loss:0.018772590905427933
Iteration: 597, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4488867223262787
loss_pred:0.0309402234852314, decouple_loss:0.016694307327270508
The generated pressure mean: 0.4487845003604889
loss_pred:0.030827704817056656, decouple_loss:0.016724471002817154
The generated pressure mean: 0.4494485557079315
loss_pred:0.032781172543764114, decouple_loss:0.01685527339577675
Iteration: 598, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44924524426460266
The generated pressure mean: 0.44797804951667786
loss_pred:0.0322108194231987, decouple_loss:0.01714233309030533
loss_pred:0.03242751583456993, decouple_loss:0.01728113181889057
The generated pressure mean: 0.4475499987602234
loss_pred:0.03251336142420769, decouple_loss:0.0175167266279459
Iteration: 599, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4475438594818115
loss_pred:0.03359731659293175, decouple_loss:0.016617298126220703
The generated pressure mean: 0.4489569664001465
loss_pred:0.032788634300231934, decouple_loss:0.016233675181865692
The generated pressure mean: 0.44952592253685
loss_pred:0.03203495219349861, decouple_loss:0.017042098566889763
Iteration: 600, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44903847575187683
loss_pred:0.03277643769979477, decouple_loss:0.017791306599974632
The generated pressure mean: 0.4484594762325287
loss_pred:0.03266323730349541, decouple_loss:0.017712218686938286
The generated pressure mean: 0.44809702038764954
loss_pred:0.031387656927108765, decouple_loss:0.017576118931174278
2023-04-16 03:34:22 testing...
The generated pressure mean: 0.4495830535888672
The generated pressure mean: 0.449788898229599
The generated pressure mean: 0.44987666606903076
loss_pred:0.03782444819808006, decouple_loss:0.016784779727458954
loss_pred:0.03893611580133438, decouple_loss:0.016835611313581467
loss_pred:0.03695361316204071, decouple_loss:0.01699206791818142
Loss: 0.03874826803803444, avg_mse: 0.04519270732998848
current test mse: 0.045193
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012003_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012003_3_24hr.npz
NaN value num: 0
Iteration: 601, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44761529564857483
loss_pred:0.03386877849698067, decouple_loss:0.01706443354487419
The generated pressure mean: 0.44824087619781494
The generated pressure mean: 0.44889312982559204
loss_pred:0.03239041194319725, decouple_loss:0.017051363363862038
loss_pred:0.03309907019138336, decouple_loss:0.016867823898792267
Iteration: 602, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44884786009788513
loss_pred:0.0315803699195385, decouple_loss:0.016174182295799255
The generated pressure mean: 0.44936540722846985
loss_pred:0.0330163799226284, decouple_loss:0.016055865213274956
The generated pressure mean: 0.4481697976589203
loss_pred:0.03386693075299263, decouple_loss:0.01668630912899971
Iteration: 603, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4469038248062134
loss_pred:0.03304613009095192, decouple_loss:0.01571544073522091
The generated pressure mean: 0.44823935627937317
loss_pred:0.03214547410607338, decouple_loss:0.01594424620270729
The generated pressure mean: 0.44872400164604187
loss_pred:0.03147319331765175, decouple_loss:0.01638209819793701
Iteration: 604, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4505738615989685
loss_pred:0.03197399526834488, decouple_loss:0.015962211415171623
The generated pressure mean: 0.44844579696655273
loss_pred:0.031396009027957916, decouple_loss:0.015895310789346695
The generated pressure mean: 0.44815993309020996
loss_pred:0.03412230685353279, decouple_loss:0.015690036118030548
Iteration: 605, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4484531581401825
loss_pred:0.03200847655534744, decouple_loss:0.01481756754219532
The generated pressure mean: 0.44814160466194153
loss_pred:0.033057767897844315, decouple_loss:0.014764593914151192
The generated pressure mean: 0.4476643204689026
loss_pred:0.03269249200820923, decouple_loss:0.014690742827951908
Iteration: 606, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4489864110946655
loss_pred:0.03171856701374054, decouple_loss:0.01638459414243698
The generated pressure mean: 0.44832903146743774
loss_pred:0.03205370903015137, decouple_loss:0.015778379514813423
The generated pressure mean: 0.4476039409637451
loss_pred:0.030277399346232414, decouple_loss:0.01581430621445179
Iteration: 607, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4488731920719147
loss_pred:0.03297702968120575, decouple_loss:0.014747104607522488
The generated pressure mean: 0.4477349519729614
loss_pred:0.03268949314951897, decouple_loss:0.015450544655323029
The generated pressure mean: 0.4481634199619293
loss_pred:0.03034302033483982, decouple_loss:0.015284005552530289
Iteration: 608, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44846776127815247
loss_pred:0.03342083841562271, decouple_loss:0.014912092126905918
The generated pressure mean: 0.44854146242141724
loss_pred:0.03278259560465813, decouple_loss:0.015410508029162884
The generated pressure mean: 0.4480254054069519
loss_pred:0.03151676431298256, decouple_loss:0.014575867913663387
Iteration: 609, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44679591059684753
loss_pred:0.03142322227358818, decouple_loss:0.015143736265599728
The generated pressure mean: 0.4472508132457733
loss_pred:0.031261198222637177, decouple_loss:0.014969952404499054
The generated pressure mean: 0.4482167363166809
loss_pred:0.032489728182554245, decouple_loss:0.015018537640571594
Iteration: 610, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44833943247795105
loss_pred:0.033419836312532425, decouple_loss:0.01525944285094738
The generated pressure mean: 0.4481566250324249
loss_pred:0.03175467252731323, decouple_loss:0.015581549145281315
The generated pressure mean: 0.44821345806121826
loss_pred:0.030745742842555046, decouple_loss:0.015107349492609501
2023-04-16 03:36:48 testing...
The generated pressure mean: 0.449788898229599
The generated pressure mean: 0.4495830833911896
The generated pressure mean: 0.44987666606903076
loss_pred:0.03793160989880562, decouple_loss:0.015474565327167511
loss_pred:0.03740357235074043, decouple_loss:0.015079005621373653
loss_pred:0.03645285591483116, decouple_loss:0.01540021225810051
Loss: 0.03802857547998428, avg_mse: 0.04414564371109009
current test mse: 0.044146
Iteration: 611, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4497413635253906
The generated pressure mean: 0.4470297396183014
loss_pred:0.0326564647257328, decouple_loss:0.01581476628780365
loss_pred:0.030759142711758614, decouple_loss:0.015386614017188549
The generated pressure mean: 0.4480161666870117
loss_pred:0.031246690079569817, decouple_loss:0.015273906290531158
Iteration: 612, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44795915484428406
loss_pred:0.0334191657602787, decouple_loss:0.015227521769702435
The generated pressure mean: 0.44843608140945435
loss_pred:0.030508968979120255, decouple_loss:0.01510646939277649
The generated pressure mean: 0.4493597745895386
loss_pred:0.03228988125920296, decouple_loss:0.015305779874324799
Iteration: 613, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4489331543445587
loss_pred:0.03002837486565113, decouple_loss:0.015680016949772835
The generated pressure mean: 0.449165403842926
loss_pred:0.03185049816966057, decouple_loss:0.0169428251683712
The generated pressure mean: 0.4484662413597107
loss_pred:0.031871505081653595, decouple_loss:0.01567966677248478
Iteration: 614, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4486350119113922
loss_pred:0.030759379267692566, decouple_loss:0.014928752556443214
The generated pressure mean: 0.4478701651096344
loss_pred:0.032875604927539825, decouple_loss:0.01510344073176384
The generated pressure mean: 0.44764280319213867
loss_pred:0.03340055048465729, decouple_loss:0.01566966436803341
Iteration: 615, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4474274516105652
loss_pred:0.032696984708309174, decouple_loss:0.015016606077551842
The generated pressure mean: 0.4490232765674591
loss_pred:0.03204821050167084, decouple_loss:0.01466989703476429
The generated pressure mean: 0.4472561478614807
loss_pred:0.033424511551856995, decouple_loss:0.014493442140519619
Iteration: 616, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44682058691978455
loss_pred:0.03187263011932373, decouple_loss:0.015520653687417507
The generated pressure mean: 0.4477507472038269
loss_pred:0.032554928213357925, decouple_loss:0.015307319350540638
The generated pressure mean: 0.44745132327079773
loss_pred:0.03147231414914131, decouple_loss:0.01593501679599285
Iteration: 617, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4474150240421295
loss_pred:0.03167020529508591, decouple_loss:0.014851625077426434
The generated pressure mean: 0.4488052427768707
loss_pred:0.03144433721899986, decouple_loss:0.01474321261048317
The generated pressure mean: 0.4505002796649933
loss_pred:0.031367942690849304, decouple_loss:0.015493771992623806
Iteration: 618, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4489436149597168
loss_pred:0.0315188467502594, decouple_loss:0.015866590663790703
The generated pressure mean: 0.44861480593681335
loss_pred:0.03206751123070717, decouple_loss:0.015023275278508663
The generated pressure mean: 0.4480617344379425
loss_pred:0.03319243714213371, decouple_loss:0.01476066093891859
Iteration: 619, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44853872060775757
loss_pred:0.03174266591668129, decouple_loss:0.016411451622843742
The generated pressure mean: 0.447750449180603
loss_pred:0.031512755900621414, decouple_loss:0.017003878951072693
The generated pressure mean: 0.4490513205528259
loss_pred:0.03361530601978302, decouple_loss:0.01641164720058441
Iteration: 620, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44841325283050537
loss_pred:0.031274955719709396, decouple_loss:0.015314945951104164
The generated pressure mean: 0.448375940322876
loss_pred:0.03147485479712486, decouple_loss:0.015943579375743866
The generated pressure mean: 0.4493885636329651
loss_pred:0.03344176337122917, decouple_loss:0.015724482014775276
2023-04-16 03:38:42 testing...
The generated pressure mean: 0.4495830833911896
The generated pressure mean: 0.4497888684272766
The generated pressure mean: 0.44987666606903076
loss_pred:0.04032507911324501, decouple_loss:0.015599623322486877
loss_pred:0.04038100689649582, decouple_loss:0.015673574060201645
loss_pred:0.03942658752202988, decouple_loss:0.015906576067209244
Loss: 0.04083055257797241, avg_mse: 0.04973329231142998
current test mse: 0.049733
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012002_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012002_3_24hr.npz
NaN value num: 0
Iteration: 621, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44828417897224426
loss_pred:0.0311716441065073, decouple_loss:0.015809888020157814
The generated pressure mean: 0.447457492351532
loss_pred:0.03428691253066063, decouple_loss:0.016331149265170097
The generated pressure mean: 0.4485968351364136
loss_pred:0.03316853940486908, decouple_loss:0.015736153349280357
Iteration: 622, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44840073585510254
The generated pressure mean: 0.44727280735969543
loss_pred:0.03180467337369919, decouple_loss:0.017037516459822655
loss_pred:0.030046742409467697, decouple_loss:0.016847753897309303
The generated pressure mean: 0.4475288987159729
loss_pred:0.03394560515880585, decouple_loss:0.01629502885043621
Iteration: 623, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44720014929771423
The generated pressure mean: 0.4478778541088104
loss_pred:0.034237973392009735, decouple_loss:0.015071236528456211
loss_pred:0.029919369146227837, decouple_loss:0.013883762992918491
The generated pressure mean: 0.4459763467311859
loss_pred:0.030229181051254272, decouple_loss:0.014720073901116848
Iteration: 624, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4477289617061615
The generated pressure mean: 0.44646069407463074loss_pred:0.030889801681041718, decouple_loss:0.015184043906629086
loss_pred:0.033298905938863754, decouple_loss:0.014980850741267204
The generated pressure mean: 0.4465464651584625
loss_pred:0.03212675079703331, decouple_loss:0.014872394502162933
Iteration: 625, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4455787241458893
loss_pred:0.03156489506363869, decouple_loss:0.014981190674006939
The generated pressure mean: 0.44710928201675415
loss_pred:0.03287987411022186, decouple_loss:0.014784600585699081
The generated pressure mean: 0.44585034251213074
loss_pred:0.03144042566418648, decouple_loss:0.014836923219263554
Iteration: 626, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44691750407218933
The generated pressure mean: 0.44713258743286133
loss_pred:0.031744327396154404, decouple_loss:0.01384790614247322
loss_pred:0.032111771404743195, decouple_loss:0.014188217930495739
The generated pressure mean: 0.44642338156700134
loss_pred:0.031096117570996284, decouple_loss:0.01361067034304142
Iteration: 627, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4478340148925781
The generated pressure mean: 0.44497737288475037
loss_pred:0.031106460839509964, decouple_loss:0.013828801922500134
loss_pred:0.031869836151599884, decouple_loss:0.014328088611364365
The generated pressure mean: 0.4481351971626282
loss_pred:0.030918627977371216, decouple_loss:0.013732006773352623
Iteration: 628, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4462679922580719
The generated pressure mean: 0.4461059272289276
loss_pred:0.03139293193817139, decouple_loss:0.013619666919112206
loss_pred:0.03178483992815018, decouple_loss:0.014357665553689003
The generated pressure mean: 0.44796085357666016
loss_pred:0.03141743689775467, decouple_loss:0.013866926543414593
Iteration: 629, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4478619396686554
The generated pressure mean: 0.44786348938941956
loss_pred:0.03131372854113579, decouple_loss:0.014389502815902233
loss_pred:0.030887175351381302, decouple_loss:0.014695880003273487
The generated pressure mean: 0.44632357358932495
loss_pred:0.030646463856101036, decouple_loss:0.01473283302038908
Iteration: 630, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44622603058815
loss_pred:0.031172368675470352, decouple_loss:0.01413001399487257
The generated pressure mean: 0.44723257422447205
loss_pred:0.031364358961582184, decouple_loss:0.014254546724259853
The generated pressure mean: 0.44644805788993835
loss_pred:0.031005704775452614, decouple_loss:0.0147441066801548
2023-04-16 03:41:10 testing...
The generated pressure mean: 0.4495830833911896
The generated pressure mean: 0.4497888684272766
The generated pressure mean: 0.44987666606903076
loss_pred:0.03675226494669914, decouple_loss:0.013950665481388569
loss_pred:0.03741898387670517, decouple_loss:0.01384094636887312
loss_pred:0.03568946197628975, decouple_loss:0.014044289477169514
Loss: 0.03731750324368477, avg_mse: 0.04332365095615387
current test mse: 0.043324
Iteration: 631, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4464872479438782
The generated pressure mean: 0.445803701877594
loss_pred:0.02918393909931183, decouple_loss:0.013945311307907104
loss_pred:0.030998224392533302, decouple_loss:0.013987359590828419
The generated pressure mean: 0.4464516043663025
loss_pred:0.03184526786208153, decouple_loss:0.014016397297382355
Iteration: 632, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44668105244636536
The generated pressure mean: 0.4468126595020294
loss_pred:0.032671164721250534, decouple_loss:0.012957354076206684
loss_pred:0.03242480382323265, decouple_loss:0.012849264778196812
The generated pressure mean: 0.44721493124961853
loss_pred:0.030515655875205994, decouple_loss:0.01296957116574049
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 633, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4466102421283722
loss_pred:0.029477190226316452, decouple_loss:0.013457720167934895
The generated pressure mean: 0.4490334689617157
loss_pred:0.032097842544317245, decouple_loss:0.013204691000282764
The generated pressure mean: 0.44669926166534424
loss_pred:0.029675444588065147, decouple_loss:0.012815789319574833
Iteration: 634, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44790753722190857
The generated pressure mean: 0.44696521759033203loss_pred:0.03027971088886261, decouple_loss:0.012945943512022495
loss_pred:0.03134811297059059, decouple_loss:0.013359492644667625
The generated pressure mean: 0.44722050428390503
loss_pred:0.03271746635437012, decouple_loss:0.013790789991617203
Iteration: 635, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4470152258872986
The generated pressure mean: 0.44760170578956604
loss_pred:0.03130608797073364, decouple_loss:0.015072561800479889
loss_pred:0.029885683208703995, decouple_loss:0.015062782913446426
The generated pressure mean: 0.44587817788124084
loss_pred:0.031295906752347946, decouple_loss:0.015269238501787186
Iteration: 636, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4466274380683899
The generated pressure mean: 0.4474099278450012
loss_pred:0.03165094926953316, decouple_loss:0.014521383680403233
loss_pred:0.03240739926695824, decouple_loss:0.014818343333899975
The generated pressure mean: 0.44673678278923035
loss_pred:0.03023480996489525, decouple_loss:0.013938928954303265
Iteration: 637, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44501036405563354
The generated pressure mean: 0.4455007314682007
loss_pred:0.03123060055077076, decouple_loss:0.014730985276401043
loss_pred:0.03110908344388008, decouple_loss:0.014766371808946133
The generated pressure mean: 0.44693711400032043
loss_pred:0.03160833567380905, decouple_loss:0.013727975077927113
Iteration: 638, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44668179750442505
loss_pred:0.03210906311869621, decouple_loss:0.013668577186763287
The generated pressure mean: 0.4462986886501312
loss_pred:0.03155573830008507, decouple_loss:0.01369462814182043
The generated pressure mean: 0.44754672050476074
loss_pred:0.028677817434072495, decouple_loss:0.013766204938292503
Iteration: 639, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44660380482673645
loss_pred:0.030027052387595177, decouple_loss:0.013536939397454262
The generated pressure mean: 0.4474528133869171
loss_pred:0.031123172491788864, decouple_loss:0.013575923629105091
The generated pressure mean: 0.44810187816619873
loss_pred:0.03079533576965332, decouple_loss:0.013661175034940243
Iteration: 640, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4472738802433014
The generated pressure mean: 0.4477178752422333
loss_pred:0.03202177211642265, decouple_loss:0.016264131292700768
loss_pred:0.03313476964831352, decouple_loss:0.016866037622094154
The generated pressure mean: 0.44854840636253357
loss_pred:0.031142540276050568, decouple_loss:0.01627977006137371
2023-04-16 03:43:03 testing...
The generated pressure mean: 0.4497888684272766
The generated pressure mean: 0.4495830535888672
The generated pressure mean: 0.44987666606903076
loss_pred:0.03781304880976677, decouple_loss:0.015043708495795727
loss_pred:0.03672417625784874, decouple_loss:0.014917694963514805
loss_pred:0.03591662645339966, decouple_loss:0.015141808427870274
Loss: 0.037569671869277954, avg_mse: 0.043868474662303925
current test mse: 0.043868
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012007_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012007_3_24hr.npz
NaN value num: 0
Iteration: 641, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4485395550727844
loss_pred:0.0318535752594471, decouple_loss:0.01528399158269167
The generated pressure mean: 0.4500880241394043
The generated pressure mean: 0.44700509309768677
loss_pred:0.030272357165813446, decouple_loss:0.015537484548985958
loss_pred:0.029604019597172737, decouple_loss:0.014966800808906555
Iteration: 642, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4461434781551361
The generated pressure mean: 0.44588345289230347
loss_pred:0.03024419955909252, decouple_loss:0.01364459190517664
loss_pred:0.03008672408759594, decouple_loss:0.013449028134346008
The generated pressure mean: 0.44784078001976013
loss_pred:0.03198908641934395, decouple_loss:0.013915332034230232
Iteration: 643, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4483945965766907
loss_pred:0.03162948787212372, decouple_loss:0.014584840275347233
The generated pressure mean: 0.4477677047252655
loss_pred:0.03086385689675808, decouple_loss:0.013920826837420464
The generated pressure mean: 0.44702863693237305
loss_pred:0.0334622822701931, decouple_loss:0.013563116081058979
Iteration: 644, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44881510734558105
loss_pred:0.030796604230999947, decouple_loss:0.014913809485733509
The generated pressure mean: 0.4476286470890045
loss_pred:0.031406205147504807, decouple_loss:0.014902488328516483
The generated pressure mean: 0.4474042057991028
loss_pred:0.030285820364952087, decouple_loss:0.01416204683482647
Iteration: 645, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4477846324443817
loss_pred:0.030829695984721184, decouple_loss:0.016531070694327354
The generated pressure mean: 0.4476760923862457
loss_pred:0.031776491552591324, decouple_loss:0.016532132402062416
The generated pressure mean: 0.4484303593635559
loss_pred:0.03181527554988861, decouple_loss:0.016693485900759697
Iteration: 646, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44713225960731506
loss_pred:0.03070085495710373, decouple_loss:0.015201562084257603
The generated pressure mean: 0.44707077741622925
loss_pred:0.031577352434396744, decouple_loss:0.015119207091629505
The generated pressure mean: 0.4466460347175598
loss_pred:0.029627986252307892, decouple_loss:0.014993132092058659
Iteration: 647, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.448089063167572
loss_pred:0.029831068590283394, decouple_loss:0.014315349981188774
The generated pressure mean: 0.4494439661502838
loss_pred:0.030685095116496086, decouple_loss:0.014276627451181412
The generated pressure mean: 0.4479919672012329
loss_pred:0.030929122120141983, decouple_loss:0.014234491623938084
Iteration: 648, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44970178604125977
loss_pred:0.028366442769765854, decouple_loss:0.014075309038162231
The generated pressure mean: 0.4470553696155548
loss_pred:0.03024601750075817, decouple_loss:0.014087348245084286
The generated pressure mean: 0.44832944869995117
loss_pred:0.031179154291749, decouple_loss:0.014127129688858986
Iteration: 649, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4468289911746979
loss_pred:0.02956416644155979, decouple_loss:0.014492597430944443
The generated pressure mean: 0.4471645653247833
loss_pred:0.030566340312361717, decouple_loss:0.01484241709113121
The generated pressure mean: 0.44617775082588196
loss_pred:0.03003840707242489, decouple_loss:0.01494232565164566
Iteration: 650, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44891947507858276
loss_pred:0.030337071046233177, decouple_loss:0.014983353205025196
The generated pressure mean: 0.447710245847702
loss_pred:0.03167198970913887, decouple_loss:0.01420529279857874
The generated pressure mean: 0.4475904703140259
loss_pred:0.03190285712480545, decouple_loss:0.014310595579445362
2023-04-16 03:45:43 testing...
The generated pressure mean: 0.4495830833911896
The generated pressure mean: 0.449788898229599
The generated pressure mean: 0.44987666606903076
loss_pred:0.03704154118895531, decouple_loss:0.014407570473849773
loss_pred:0.03706292435526848, decouple_loss:0.014329767785966396
loss_pred:0.03588160127401352, decouple_loss:0.014606551267206669
Loss: 0.03738442063331604, avg_mse: 0.04371776431798935
current test mse: 0.043718
Iteration: 651, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4466298222541809
loss_pred:0.03220492601394653, decouple_loss:0.014258455485105515
The generated pressure mean: 0.4480352997779846
loss_pred:0.030241791158914566, decouple_loss:0.014031966216862202
The generated pressure mean: 0.4482154846191406
loss_pred:0.030388731509447098, decouple_loss:0.014339459128677845
Iteration: 652, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4492430090904236
loss_pred:0.02979469485580921, decouple_loss:0.015262759290635586
The generated pressure mean: 0.4464145600795746
loss_pred:0.029382074251770973, decouple_loss:0.015316525474190712
The generated pressure mean: 0.44904133677482605
loss_pred:0.0302576944231987, decouple_loss:0.015256754122674465
Iteration: 653, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44678202271461487
loss_pred:0.031995661556720734, decouple_loss:0.015693455934524536
The generated pressure mean: 0.4478377103805542
loss_pred:0.03219785913825035, decouple_loss:0.015850655734539032
The generated pressure mean: 0.4468880593776703
loss_pred:0.03240824118256569, decouple_loss:0.015741003677248955
Iteration: 654, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44856446981430054
loss_pred:0.030211692675948143, decouple_loss:0.015217273496091366
The generated pressure mean: 0.4474222660064697
loss_pred:0.03027205355465412, decouple_loss:0.014654258266091347
The generated pressure mean: 0.4495560824871063
loss_pred:0.029251014813780785, decouple_loss:0.01504033338278532
Iteration: 655, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4472527801990509
The generated pressure mean: 0.4475352168083191
loss_pred:0.030982771888375282, decouple_loss:0.015660792589187622
loss_pred:0.03293589502573013, decouple_loss:0.015826964750885963
The generated pressure mean: 0.4475768804550171
loss_pred:0.0310687106102705, decouple_loss:0.01542402058839798
Iteration: 656, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44795140624046326The generated pressure mean: 0.44800320267677307
loss_pred:0.030807312577962875, decouple_loss:0.01733020320534706
loss_pred:0.029871216043829918, decouple_loss:0.017493151128292084
The generated pressure mean: 0.44793441891670227
loss_pred:0.031112637370824814, decouple_loss:0.017329484224319458
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 657, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4501623511314392
The generated pressure mean: 0.44852301478385925
loss_pred:0.030017947778105736, decouple_loss:0.017766490578651428
loss_pred:0.029913591220974922, decouple_loss:0.01663300208747387
The generated pressure mean: 0.44691556692123413
loss_pred:0.03246646374464035, decouple_loss:0.016721418127417564
Iteration: 658, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4480734169483185
loss_pred:0.0321250818669796, decouple_loss:0.018627455458045006The generated pressure mean: 0.4482412338256836
loss_pred:0.030362576246261597, decouple_loss:0.017840560525655746
The generated pressure mean: 0.4483628273010254
loss_pred:0.02991005964577198, decouple_loss:0.018128404393792152
Iteration: 659, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44823968410491943
The generated pressure mean: 0.4482189118862152
loss_pred:0.02918248251080513, decouple_loss:0.0158192440867424
loss_pred:0.030894696712493896, decouple_loss:0.0157245434820652
The generated pressure mean: 0.4491856098175049
loss_pred:0.02899394929409027, decouple_loss:0.015659796074032784
Iteration: 660, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44812512397766113
The generated pressure mean: 0.4468555450439453
loss_pred:0.030095186084508896, decouple_loss:0.01734546199440956
loss_pred:0.029647700488567352, decouple_loss:0.017226846888661385
The generated pressure mean: 0.4477187395095825
loss_pred:0.03112925961613655, decouple_loss:0.017397770658135414
2023-04-16 03:47:36 testing...
The generated pressure mean: 0.449788898229599
The generated pressure mean: 0.4495830833911896
The generated pressure mean: 0.44987666606903076
loss_pred:0.03724909573793411, decouple_loss:0.01617632433772087
loss_pred:0.03664295747876167, decouple_loss:0.0162612646818161
loss_pred:0.03570886701345444, decouple_loss:0.0163152776658535
Loss: 0.037346191704273224, avg_mse: 0.04341413080692291
current test mse: 0.043414
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012015_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012015_3_24hr.npz
NaN value num: 0
Iteration: 661, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4484618008136749
loss_pred:0.031249962747097015, decouple_loss:0.016346842050552368
The generated pressure mean: 0.4479629695415497
loss_pred:0.03377021476626396, decouple_loss:0.017006568610668182
The generated pressure mean: 0.44937098026275635
loss_pred:0.0331142358481884, decouple_loss:0.017299585044384003
Iteration: 662, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4471625089645386
The generated pressure mean: 0.44536155462265015
loss_pred:0.032468847930431366, decouple_loss:0.01589854247868061
loss_pred:0.03263486176729202, decouple_loss:0.01574687659740448
The generated pressure mean: 0.4482795298099518
loss_pred:0.032426368445158005, decouple_loss:0.016973424702882767
Iteration: 663, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4459594190120697
The generated pressure mean: 0.44762107729911804
loss_pred:0.03186376392841339, decouple_loss:0.016588671132922173
loss_pred:0.03191637620329857, decouple_loss:0.016455532982945442
The generated pressure mean: 0.44719794392585754
loss_pred:0.03140294924378395, decouple_loss:0.01634175144135952
Iteration: 664, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4487364590167999
The generated pressure mean: 0.44903576374053955
loss_pred:0.033866383135318756, decouple_loss:0.01676996983587742
loss_pred:0.030228663235902786, decouple_loss:0.015644991770386696
The generated pressure mean: 0.4485762417316437
loss_pred:0.031540773808956146, decouple_loss:0.015695298090577126
Iteration: 665, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4479886591434479
The generated pressure mean: 0.4480310380458832
loss_pred:0.0314369834959507, decouple_loss:0.015329407528042793
loss_pred:0.030676236376166344, decouple_loss:0.015402736142277718
The generated pressure mean: 0.44779130816459656
loss_pred:0.033044200390577316, decouple_loss:0.015343520790338516
Iteration: 666, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44841551780700684
The generated pressure mean: 0.44798973202705383
loss_pred:0.03276633098721504, decouple_loss:0.01691119372844696
loss_pred:0.03238014876842499, decouple_loss:0.016462044790387154
The generated pressure mean: 0.44641435146331787
loss_pred:0.032411254942417145, decouple_loss:0.016422947868704796
Iteration: 667, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4485549032688141
The generated pressure mean: 0.4471522867679596
loss_pred:0.029976647347211838, decouple_loss:0.014989444985985756
loss_pred:0.031127288937568665, decouple_loss:0.015114160254597664
The generated pressure mean: 0.4481883943080902
loss_pred:0.032106250524520874, decouple_loss:0.01522848941385746
Iteration: 668, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4489551782608032
The generated pressure mean: 0.44746753573417664
loss_pred:0.031135259196162224, decouple_loss:0.014757838100194931
loss_pred:0.031491488218307495, decouple_loss:0.014442605897784233
The generated pressure mean: 0.44860631227493286
loss_pred:0.031822800636291504, decouple_loss:0.014870567247271538
Iteration: 669, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4471014142036438
loss_pred:0.03257361799478531, decouple_loss:0.014346681535243988
The generated pressure mean: 0.4472449719905853
loss_pred:0.03191356733441353, decouple_loss:0.014100986532866955
The generated pressure mean: 0.4463062286376953
loss_pred:0.032954826951026917, decouple_loss:0.014369088225066662
Iteration: 670, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44896137714385986
loss_pred:0.03301269933581352, decouple_loss:0.015000615268945694
The generated pressure mean: 0.44732341170310974
loss_pred:0.03196939080953598, decouple_loss:0.014310665428638458
The generated pressure mean: 0.4474680721759796
loss_pred:0.031131112948060036, decouple_loss:0.014537743292748928
2023-04-16 03:50:11 testing...
The generated pressure mean: 0.449788898229599
The generated pressure mean: 0.4495830833911896
The generated pressure mean: 0.44987666606903076
loss_pred:0.03786944970488548, decouple_loss:0.015068236738443375
loss_pred:0.037242621183395386, decouple_loss:0.01504982728511095
loss_pred:0.03631759434938431, decouple_loss:0.015220285393297672
Loss: 0.03789886087179184, avg_mse: 0.044888537377119064
current test mse: 0.044889
Iteration: 671, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.448258638381958
The generated pressure mean: 0.4483889639377594loss_pred:0.03331075236201286, decouple_loss:0.015367144718766212
loss_pred:0.03180597350001335, decouple_loss:0.015158914029598236
The generated pressure mean: 0.44818437099456787
loss_pred:0.03180737793445587, decouple_loss:0.015449038706719875
Iteration: 672, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4490233063697815
loss_pred:0.032715704292058945, decouple_loss:0.015476238913834095
The generated pressure mean: 0.44729089736938477
loss_pred:0.03125820308923721, decouple_loss:0.015330491587519646
The generated pressure mean: 0.44793835282325745
loss_pred:0.03104461543262005, decouple_loss:0.015263875015079975
Iteration: 673, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4480283856391907
loss_pred:0.031047387048602104, decouple_loss:0.014537110924720764
The generated pressure mean: 0.44716429710388184
loss_pred:0.03118032030761242, decouple_loss:0.01421061810106039
The generated pressure mean: 0.4477037489414215
loss_pred:0.03191884979605675, decouple_loss:0.014825158752501011
Iteration: 674, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44882652163505554
The generated pressure mean: 0.44919610023498535
loss_pred:0.03221265971660614, decouple_loss:0.013877617195248604
loss_pred:0.03241331875324249, decouple_loss:0.014381811954081059
The generated pressure mean: 0.44778892397880554
loss_pred:0.03212993964552879, decouple_loss:0.013837234117090702
Iteration: 675, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.447185218334198
The generated pressure mean: 0.445667028427124
loss_pred:0.030066723003983498, decouple_loss:0.013534529134631157
loss_pred:0.03137713670730591, decouple_loss:0.014245633035898209
The generated pressure mean: 0.446358859539032
loss_pred:0.03140920773148537, decouple_loss:0.013532252982258797
Iteration: 676, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44764211773872375
The generated pressure mean: 0.4484703838825226
loss_pred:0.03218908980488777, decouple_loss:0.015285545960068703
loss_pred:0.032394494861364365, decouple_loss:0.01546768844127655
The generated pressure mean: 0.4477511942386627
loss_pred:0.030609821900725365, decouple_loss:0.015194226987659931
Iteration: 677, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4468974173069
The generated pressure mean: 0.4474603533744812
loss_pred:0.03255835548043251, decouple_loss:0.014292484149336815
loss_pred:0.03428011015057564, decouple_loss:0.014261126518249512
The generated pressure mean: 0.447562575340271
loss_pred:0.03205516189336777, decouple_loss:0.014434481970965862
Iteration: 678, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44597384333610535
The generated pressure mean: 0.4474125802516937
loss_pred:0.03162936493754387, decouple_loss:0.016636507585644722
loss_pred:0.032422397285699844, decouple_loss:0.015823563560843468
The generated pressure mean: 0.4475595951080322
loss_pred:0.03179972618818283, decouple_loss:0.015720423310995102
Iteration: 679, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4482066035270691
The generated pressure mean: 0.44597193598747253
loss_pred:0.031815290451049805, decouple_loss:0.016464341431856155
loss_pred:0.03229819983243942, decouple_loss:0.016535310074687004
The generated pressure mean: 0.4475211799144745
loss_pred:0.03182745724916458, decouple_loss:0.016535326838493347
Iteration: 680, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44821879267692566
The generated pressure mean: 0.4483566880226135
loss_pred:0.03196350112557411, decouple_loss:0.01679491065442562
loss_pred:0.030795635655522346, decouple_loss:0.016307679936289787
The generated pressure mean: 0.4484391212463379
loss_pred:0.030857296660542488, decouple_loss:0.016326189041137695
2023-04-16 03:52:05 testing...
The generated pressure mean: 0.4497888684272766
The generated pressure mean: 0.4495830535888672
The generated pressure mean: 0.44987666606903076
loss_pred:0.03945079445838928, decouple_loss:0.01663946360349655
loss_pred:0.039216797798871994, decouple_loss:0.016757356002926826
loss_pred:0.03829500079154968, decouple_loss:0.016847211867570877
Loss: 0.03982493281364441, avg_mse: 0.04800118878483772
current test mse: 0.048001
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012014_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012014_3_24hr.npz
NaN value num: 0
Iteration: 681, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4468311071395874
loss_pred:0.031070759519934654, decouple_loss:0.01721680350601673
The generated pressure mean: 0.44607147574424744The generated pressure mean: 0.44750991463661194
loss_pred:0.03249745815992355, decouple_loss:0.0167014691978693
loss_pred:0.03268273547291756, decouple_loss:0.017076408490538597
Iteration: 682, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4459005892276764
loss_pred:0.0314914733171463, decouple_loss:0.014579104259610176
The generated pressure mean: 0.44665440917015076
loss_pred:0.03278208151459694, decouple_loss:0.014697465114295483
The generated pressure mean: 0.44619378447532654
loss_pred:0.03155006840825081, decouple_loss:0.01442581508308649
Iteration: 683, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4476187825202942
loss_pred:0.03355373814702034, decouple_loss:0.016571052372455597
The generated pressure mean: 0.44592297077178955
loss_pred:0.03289124369621277, decouple_loss:0.016527175903320312
The generated pressure mean: 0.44595468044281006
loss_pred:0.03224239498376846, decouple_loss:0.016434643417596817
Iteration: 684, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4475046992301941
loss_pred:0.03393520042300224, decouple_loss:0.017052222043275833
The generated pressure mean: 0.44631731510162354
loss_pred:0.03156960383057594, decouple_loss:0.01697290875017643
The generated pressure mean: 0.44647151231765747
loss_pred:0.03224734961986542, decouple_loss:0.016268936917185783
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 685, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4467596709728241
loss_pred:0.03174785152077675, decouple_loss:0.015835538506507874
The generated pressure mean: 0.44761812686920166
loss_pred:0.03136897087097168, decouple_loss:0.015687979757785797
The generated pressure mean: 0.4468976557254791
loss_pred:0.031538669019937515, decouple_loss:0.015505176037549973
Iteration: 686, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4469756484031677
loss_pred:0.030775977298617363, decouple_loss:0.016265157610177994
The generated pressure mean: 0.44840914011001587
loss_pred:0.03148855268955231, decouple_loss:0.01606796309351921
The generated pressure mean: 0.446569561958313
loss_pred:0.03137073665857315, decouple_loss:0.016178704798221588
Iteration: 687, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4478432238101959
loss_pred:0.03226977959275246, decouple_loss:0.015087977051734924
The generated pressure mean: 0.44623321294784546
loss_pred:0.03129209205508232, decouple_loss:0.015185553580522537
The generated pressure mean: 0.4480520784854889
loss_pred:0.030995411798357964, decouple_loss:0.015318700112402439
Iteration: 688, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4472518563270569
loss_pred:0.031291414052248, decouple_loss:0.015422865748405457
The generated pressure mean: 0.44601970911026
loss_pred:0.030790308490395546, decouple_loss:0.015685129910707474
The generated pressure mean: 0.4457560181617737
loss_pred:0.030055087059736252, decouple_loss:0.015759091824293137
Iteration: 689, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4466250538825989
loss_pred:0.03180086985230446, decouple_loss:0.014879262074828148
The generated pressure mean: 0.4459228217601776
loss_pred:0.03146286681294441, decouple_loss:0.01497854758054018
The generated pressure mean: 0.44583743810653687
loss_pred:0.03233303874731064, decouple_loss:0.015248366631567478
Iteration: 690, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44621577858924866
loss_pred:0.03065144643187523, decouple_loss:0.014942524954676628
The generated pressure mean: 0.44740718603134155
loss_pred:0.03220241144299507, decouple_loss:0.014797152020037174
The generated pressure mean: 0.44548192620277405
loss_pred:0.03024325892329216, decouple_loss:0.01504372525960207
2023-04-16 03:54:32 testing...
The generated pressure mean: 0.4495830535888672
The generated pressure mean: 0.449788898229599
The generated pressure mean: 0.44987666606903076
loss_pred:0.0371733158826828, decouple_loss:0.0139978788793087
loss_pred:0.03833707422018051, decouple_loss:0.014044991694390774
loss_pred:0.036610137671232224, decouple_loss:0.013959198258817196
Loss: 0.038073547184467316, avg_mse: 0.045419808477163315
current test mse: 0.04542
Iteration: 691, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4462399184703827
loss_pred:0.032549500465393066, decouple_loss:0.013970579952001572
The generated pressure mean: 0.4465339481830597
loss_pred:0.030356012284755707, decouple_loss:0.01373684499412775
The generated pressure mean: 0.44739457964897156
loss_pred:0.030772166326642036, decouple_loss:0.013928874395787716
Iteration: 692, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4467751085758209
loss_pred:0.030662722885608673, decouple_loss:0.014937696978449821
The generated pressure mean: 0.446699857711792
loss_pred:0.033013805747032166, decouple_loss:0.014810889028012753
The generated pressure mean: 0.4479432702064514
loss_pred:0.030167588964104652, decouple_loss:0.014943880960345268
Iteration: 693, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44622841477394104
loss_pred:0.0321250855922699, decouple_loss:0.015207923948764801
The generated pressure mean: 0.4465043246746063
loss_pred:0.03191740810871124, decouple_loss:0.015121246688067913
The generated pressure mean: 0.4458337128162384
loss_pred:0.031079569831490517, decouple_loss:0.01517926063388586
Iteration: 694, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44718873500823975
loss_pred:0.031562548130750656, decouple_loss:0.014330129139125347
The generated pressure mean: 0.4480317533016205
loss_pred:0.03093557246029377, decouple_loss:0.014594493433833122
The generated pressure mean: 0.4464617967605591
loss_pred:0.03261808305978775, decouple_loss:0.014546813443303108
Iteration: 695, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4465370178222656
loss_pred:0.030843423679471016, decouple_loss:0.013422606512904167
The generated pressure mean: 0.44703683257102966
loss_pred:0.031160233542323112, decouple_loss:0.013543709181249142
The generated pressure mean: 0.4467129707336426
loss_pred:0.033198282122612, decouple_loss:0.013601183891296387
Iteration: 696, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4480176568031311
loss_pred:0.031722068786621094, decouple_loss:0.013778960332274437
The generated pressure mean: 0.44759777188301086
loss_pred:0.03144209459424019, decouple_loss:0.013846536166965961
The generated pressure mean: 0.445599764585495
loss_pred:0.030560338869690895, decouple_loss:0.013523835688829422
Iteration: 697, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44727879762649536
loss_pred:0.03130407631397247, decouple_loss:0.01291589718312025
The generated pressure mean: 0.4464920163154602
The generated pressure mean: 0.44765180349349976
loss_pred:0.030993299558758736, decouple_loss:0.01288165058940649
loss_pred:0.031339675188064575, decouple_loss:0.013131153769791126
Iteration: 698, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4464482367038727
loss_pred:0.03030325286090374, decouple_loss:0.013270419090986252
The generated pressure mean: 0.44654616713523865
loss_pred:0.030165895819664, decouple_loss:0.013521374203264713
The generated pressure mean: 0.4477819502353668
loss_pred:0.030830303207039833, decouple_loss:0.013185825198888779
Iteration: 699, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44696757197380066
loss_pred:0.03225912153720856, decouple_loss:0.013073698617517948
The generated pressure mean: 0.4452938735485077
loss_pred:0.030138732865452766, decouple_loss:0.013120265677571297
The generated pressure mean: 0.44743824005126953
loss_pred:0.03136827424168587, decouple_loss:0.013002277351915836
Iteration: 700, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44568219780921936
loss_pred:0.032713521271944046, decouple_loss:0.013404911383986473
The generated pressure mean: 0.4464503824710846The generated pressure mean: 0.44656628370285034
loss_pred:0.03161875158548355, decouple_loss:0.013376960530877113
loss_pred:0.030340660363435745, decouple_loss:0.01331795658916235
2023-04-16 03:56:26 testing...
The generated pressure mean: 0.4495830833911896
The generated pressure mean: 0.449788898229599
The generated pressure mean: 0.44987666606903076
loss_pred:0.03667992353439331, decouple_loss:0.01377639826387167
loss_pred:0.03770652040839195, decouple_loss:0.014126548543572426
loss_pred:0.03587118908762932, decouple_loss:0.013765973970293999
Loss: 0.03744702786207199, avg_mse: 0.04441584274172783
current test mse: 0.044416
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012007_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012007_3_24hr.npz
NaN value num: 0
Iteration: 701, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4490264058113098
loss_pred:0.02953563630580902, decouple_loss:0.01439149770885706
The generated pressure mean: 0.4481067955493927
The generated pressure mean: 0.447090744972229
loss_pred:0.029309315606951714, decouple_loss:0.013856773264706135
loss_pred:0.02974620833992958, decouple_loss:0.013829614967107773
Iteration: 702, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44812268018722534
The generated pressure mean: 0.44728949666023254
loss_pred:0.02997174672782421, decouple_loss:0.014216123148798943
loss_pred:0.029755940660834312, decouple_loss:0.014078855514526367
The generated pressure mean: 0.4473142623901367
loss_pred:0.03122500516474247, decouple_loss:0.014854391105473042
Iteration: 703, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4476485848426819
The generated pressure mean: 0.4493856132030487
loss_pred:0.031165972352027893, decouple_loss:0.014541521668434143
loss_pred:0.030368858948349953, decouple_loss:0.014398365281522274
The generated pressure mean: 0.4479582905769348
loss_pred:0.029895655810832977, decouple_loss:0.014659255743026733
Iteration: 704, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4472711682319641
The generated pressure mean: 0.4471547603607178
loss_pred:0.030433567240834236, decouple_loss:0.014709492214024067
loss_pred:0.030992764979600906, decouple_loss:0.014408845454454422
The generated pressure mean: 0.44777804613113403
loss_pred:0.030251996591687202, decouple_loss:0.0144055699929595
Iteration: 705, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44768163561820984
The generated pressure mean: 0.448378324508667
loss_pred:0.02974613755941391, decouple_loss:0.014938983134925365
loss_pred:0.03134604170918465, decouple_loss:0.014444170519709587
The generated pressure mean: 0.44808003306388855
loss_pred:0.030597010627388954, decouple_loss:0.015219383873045444
Iteration: 706, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4485163986682892
The generated pressure mean: 0.4481242001056671
loss_pred:0.03073449619114399, decouple_loss:0.015628989785909653
loss_pred:0.02977607399225235, decouple_loss:0.015350786037743092
The generated pressure mean: 0.4474526643753052
loss_pred:0.02985812909901142, decouple_loss:0.015778634697198868
Iteration: 707, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44711461663246155The generated pressure mean: 0.44755682349205017
loss_pred:0.030735645443201065, decouple_loss:0.01486142072826624loss_pred:0.030946269631385803, decouple_loss:0.014836681075394154
The generated pressure mean: 0.4483753740787506
loss_pred:0.029917839914560318, decouple_loss:0.01527161244302988
Iteration: 708, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.449061781167984
loss_pred:0.029555801302194595, decouple_loss:0.013826504349708557
The generated pressure mean: 0.44877690076828003
loss_pred:0.030334779992699623, decouple_loss:0.014328720048069954
The generated pressure mean: 0.4480270743370056
loss_pred:0.029345018789172173, decouple_loss:0.014154372736811638
Iteration: 709, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4484996795654297
loss_pred:0.029015356674790382, decouple_loss:0.014728793874382973
The generated pressure mean: 0.44750353693962097
loss_pred:0.03146347030997276, decouple_loss:0.014425626955926418
The generated pressure mean: 0.4477725327014923
loss_pred:0.030381876975297928, decouple_loss:0.01436552032828331
Iteration: 710, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4484296441078186
The generated pressure mean: 0.4475187361240387
loss_pred:0.02888096123933792, decouple_loss:0.01479412242770195
loss_pred:0.029146306216716766, decouple_loss:0.014552179723978043
The generated pressure mean: 0.4481460750102997
loss_pred:0.029828736558556557, decouple_loss:0.01470737811177969
2023-04-16 03:58:56 testing...
The generated pressure mean: 0.4497888684272766
The generated pressure mean: 0.4495830833911896
The generated pressure mean: 0.44987666606903076
loss_pred:0.038000933825969696, decouple_loss:0.01480473205447197
loss_pred:0.03720371797680855, decouple_loss:0.01458874624222517
loss_pred:0.03614669293165207, decouple_loss:0.014705698005855083
Loss: 0.037852104753255844, avg_mse: 0.04523047059774399
current test mse: 0.04523
Iteration: 711, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4493151009082794
loss_pred:0.030082089826464653, decouple_loss:0.01441893633455038
The generated pressure mean: 0.4479518532752991
loss_pred:0.029280886054039, decouple_loss:0.014815411530435085
The generated pressure mean: 0.44817668199539185
loss_pred:0.029814982786774635, decouple_loss:0.01454057265073061
Iteration: 712, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4474695920944214
loss_pred:0.029429061338305473, decouple_loss:0.015196731314063072
The generated pressure mean: 0.4477311670780182
loss_pred:0.02994445338845253, decouple_loss:0.014888856559991837
The generated pressure mean: 0.4483235776424408
loss_pred:0.02980935014784336, decouple_loss:0.014858735725283623
Iteration: 713, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44846057891845703
loss_pred:0.02867661789059639, decouple_loss:0.013477714732289314
The generated pressure mean: 0.4483779966831207
loss_pred:0.03015405870974064, decouple_loss:0.013638835400342941
The generated pressure mean: 0.44725486636161804
loss_pred:0.030517835170030594, decouple_loss:0.014041400514543056
Iteration: 714, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44745561480522156
loss_pred:0.03097240813076496, decouple_loss:0.015514316037297249
The generated pressure mean: 0.44796130061149597
loss_pred:0.03049619495868683, decouple_loss:0.015111983753740788
The generated pressure mean: 0.44736239314079285
loss_pred:0.030765200033783913, decouple_loss:0.01545428391546011
Iteration: 715, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44736185669898987
loss_pred:0.029981255531311035, decouple_loss:0.015514742583036423
The generated pressure mean: 0.4476211667060852
loss_pred:0.029507780447602272, decouple_loss:0.015285233967006207
The generated pressure mean: 0.4482242465019226
loss_pred:0.029691306874155998, decouple_loss:0.01516553945839405
Iteration: 716, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4485977590084076
The generated pressure mean: 0.44693225622177124
loss_pred:0.030925175175070763, decouple_loss:0.014988263137638569
loss_pred:0.029264017939567566, decouple_loss:0.014988381415605545
The generated pressure mean: 0.4484992027282715
loss_pred:0.030209606513381004, decouple_loss:0.014603741466999054
Iteration: 717, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4483889937400818
loss_pred:0.03006383590400219, decouple_loss:0.01333127822726965
The generated pressure mean: 0.4473004639148712
loss_pred:0.030443742871284485, decouple_loss:0.013276739045977592
The generated pressure mean: 0.4481548070907593
loss_pred:0.02982257679104805, decouple_loss:0.013620167970657349
Iteration: 718, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44763848185539246
loss_pred:0.02936411090195179, decouple_loss:0.013771356083452702
The generated pressure mean: 0.446613073348999
loss_pred:0.029719052836298943, decouple_loss:0.01402913499623537
The generated pressure mean: 0.44729694724082947
loss_pred:0.030870409682393074, decouple_loss:0.013889825902879238
Iteration: 719, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44723644852638245
loss_pred:0.031012920662760735, decouple_loss:0.01497015543282032
The generated pressure mean: 0.4486527442932129
loss_pred:0.029258616268634796, decouple_loss:0.01486202236264944
The generated pressure mean: 0.44872990250587463
loss_pred:0.028253590688109398, decouple_loss:0.014766134321689606
Iteration: 720, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44857344031333923
loss_pred:0.03088264726102352, decouple_loss:0.01320967823266983
The generated pressure mean: 0.44834771752357483
loss_pred:0.028623169288039207, decouple_loss:0.013276206329464912
The generated pressure mean: 0.4480278193950653
loss_pred:0.03009462170302868, decouple_loss:0.013511528261005878
2023-04-16 04:00:50 testing...
The generated pressure mean: 0.449788898229599
The generated pressure mean: 0.4495830833911896
The generated pressure mean: 0.44987666606903076
loss_pred:0.036727432161569595, decouple_loss:0.01334916241466999
loss_pred:0.03623348847031593, decouple_loss:0.013319049030542374
loss_pred:0.03546125441789627, decouple_loss:0.013460574671626091
Loss: 0.036809537559747696, avg_mse: 0.043731506913900375
current test mse: 0.043732
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012003_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012003_3_24hr.npz
NaN value num: 0
Iteration: 721, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4484729468822479
loss_pred:0.028888992965221405, decouple_loss:0.01414512563496828
The generated pressure mean: 0.4480275809764862
loss_pred:0.02951543964445591, decouple_loss:0.013426351360976696
The generated pressure mean: 0.4477749466896057
loss_pred:0.03216386213898659, decouple_loss:0.014259753748774529
Iteration: 722, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.447377473115921
The generated pressure mean: 0.4482789933681488
loss_pred:0.0295976884663105, decouple_loss:0.013946142978966236
loss_pred:0.03176635131239891, decouple_loss:0.013609680347144604
The generated pressure mean: 0.4471077620983124
loss_pred:0.028724445030093193, decouple_loss:0.013605878688395023
Iteration: 723, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4486084282398224
loss_pred:0.029726505279541016, decouple_loss:0.015338145196437836
The generated pressure mean: 0.44784730672836304
loss_pred:0.03018687479197979, decouple_loss:0.014797649346292019
The generated pressure mean: 0.4481275677680969
loss_pred:0.029138607904314995, decouple_loss:0.015071850270032883
Iteration: 724, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4476287364959717
loss_pred:0.0299836415797472, decouple_loss:0.013577431440353394
The generated pressure mean: 0.44841107726097107
loss_pred:0.03177769482135773, decouple_loss:0.01335242297500372
The generated pressure mean: 0.44828885793685913
loss_pred:0.03132421895861626, decouple_loss:0.013643992133438587
Iteration: 725, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4481653571128845
loss_pred:0.03172551468014717, decouple_loss:0.013862046413123608
The generated pressure mean: 0.4476042091846466
loss_pred:0.03080548346042633, decouple_loss:0.01346767321228981
The generated pressure mean: 0.44777509570121765
loss_pred:0.03013363666832447, decouple_loss:0.013440032489597797
Iteration: 726, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4491927921772003
loss_pred:0.03028448298573494, decouple_loss:0.014164171181619167
The generated pressure mean: 0.44741255044937134
loss_pred:0.030190490186214447, decouple_loss:0.013876877725124359
The generated pressure mean: 0.4473952651023865
loss_pred:0.029368940740823746, decouple_loss:0.01383307296782732
Iteration: 727, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44841238856315613
The generated pressure mean: 0.44751811027526855
loss_pred:0.02994708903133869, decouple_loss:0.013792618177831173
loss_pred:0.030873529613018036, decouple_loss:0.013712425716221333
The generated pressure mean: 0.4473778307437897
loss_pred:0.029939696192741394, decouple_loss:0.014025568962097168
Iteration: 728, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44995635747909546
loss_pred:0.030047446489334106, decouple_loss:0.01431750226765871
The generated pressure mean: 0.4472081959247589
loss_pred:0.029421543702483177, decouple_loss:0.013847464695572853
The generated pressure mean: 0.4479374587535858
loss_pred:0.03152560442686081, decouple_loss:0.014106874354183674
Iteration: 729, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44824665784835815
loss_pred:0.02991522289812565, decouple_loss:0.01462988369166851
The generated pressure mean: 0.447279691696167
loss_pred:0.02840929478406906, decouple_loss:0.01445761974900961
The generated pressure mean: 0.4473389685153961
loss_pred:0.027055304497480392, decouple_loss:0.014632011763751507
Iteration: 730, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44844359159469604
The generated pressure mean: 0.44741374254226685
loss_pred:0.02962406910955906, decouple_loss:0.015423647128045559
loss_pred:0.029894547536969185, decouple_loss:0.015098994597792625
The generated pressure mean: 0.44750773906707764
loss_pred:0.02873332053422928, decouple_loss:0.015340378507971764
2023-04-16 04:03:21 testing...
The generated pressure mean: 0.4497888684272766
The generated pressure mean: 0.4495830833911896
The generated pressure mean: 0.44987666606903076
loss_pred:0.03608342632651329, decouple_loss:0.016738710924983025
loss_pred:0.0355411022901535, decouple_loss:0.016617286950349808
loss_pred:0.03436543047428131, decouple_loss:0.016577117145061493
Loss: 0.036162205040454865, avg_mse: 0.0421457476913929
current test mse: 0.042146
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 731, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44756534695625305
loss_pred:0.029360506683588028, decouple_loss:0.016516558825969696
The generated pressure mean: 0.4484138786792755
loss_pred:0.03033781424164772, decouple_loss:0.016436032950878143
The generated pressure mean: 0.4503796696662903
loss_pred:0.029398348182439804, decouple_loss:0.01762469671666622
Iteration: 732, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44813814759254456
The generated pressure mean: 0.44768255949020386
loss_pred:0.029848583042621613, decouple_loss:0.014134873636066914
loss_pred:0.02839754894375801, decouple_loss:0.013718746602535248
The generated pressure mean: 0.44805198907852173
loss_pred:0.02914232201874256, decouple_loss:0.013703749515116215
Iteration: 733, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44809481501579285
The generated pressure mean: 0.4486619234085083
loss_pred:0.027770280838012695, decouple_loss:0.013835511170327663
loss_pred:0.030089562758803368, decouple_loss:0.013664589263498783
The generated pressure mean: 0.4485880732536316
loss_pred:0.029393788427114487, decouple_loss:0.013937256298959255
Iteration: 734, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4482533037662506
The generated pressure mean: 0.44714847207069397
loss_pred:0.029117319732904434, decouple_loss:0.01366882212460041
loss_pred:0.03249729797244072, decouple_loss:0.013345779851078987
The generated pressure mean: 0.4483591616153717
loss_pred:0.02965511381626129, decouple_loss:0.01375094335526228
Iteration: 735, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4494568407535553
The generated pressure mean: 0.4471055865287781
loss_pred:0.02999570593237877, decouple_loss:0.01608499325811863
loss_pred:0.029197901487350464, decouple_loss:0.014823217876255512
The generated pressure mean: 0.44918733835220337
loss_pred:0.03065141849219799, decouple_loss:0.014986656606197357
Iteration: 736, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44851943850517273
The generated pressure mean: 0.4478241205215454
loss_pred:0.02876623347401619, decouple_loss:0.01583133637905121
loss_pred:0.03051770105957985, decouple_loss:0.015887288376688957
The generated pressure mean: 0.44821542501449585
loss_pred:0.030321793630719185, decouple_loss:0.016069071367383003
Iteration: 737, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44870463013648987
loss_pred:0.029277866706252098, decouple_loss:0.015848368406295776
The generated pressure mean: 0.4495103657245636
loss_pred:0.031244877725839615, decouple_loss:0.015693092718720436
The generated pressure mean: 0.4497060775756836
loss_pred:0.03131754323840141, decouple_loss:0.015932945534586906
Iteration: 738, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44874122738838196
The generated pressure mean: 0.44823116064071655
loss_pred:0.03005896508693695, decouple_loss:0.013751249760389328
loss_pred:0.032282229512929916, decouple_loss:0.01415791641920805
The generated pressure mean: 0.4471968710422516
loss_pred:0.032671600580215454, decouple_loss:0.013887510634958744
Iteration: 739, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44772955775260925
The generated pressure mean: 0.44771498441696167loss_pred:0.032368116080760956, decouple_loss:0.015759576112031937
loss_pred:0.03318117931485176, decouple_loss:0.01600331813097
The generated pressure mean: 0.4475441873073578
loss_pred:0.030955834314227104, decouple_loss:0.01528889313340187
Iteration: 740, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44785621762275696
loss_pred:0.03153860569000244, decouple_loss:0.017520200461149216The generated pressure mean: 0.4480414390563965
loss_pred:0.03157299757003784, decouple_loss:0.017134906724095345
The generated pressure mean: 0.44832947850227356
loss_pred:0.03063870593905449, decouple_loss:0.016821833327412605
2023-04-16 04:05:14 testing...
The generated pressure mean: 0.449788898229599
The generated pressure mean: 0.4495830535888672
The generated pressure mean: 0.44987666606903076
loss_pred:0.03737477585673332, decouple_loss:0.014506095089018345
loss_pred:0.0368773490190506, decouple_loss:0.014332422986626625
loss_pred:0.035988688468933105, decouple_loss:0.014273570850491524
Loss: 0.037465475499629974, avg_mse: 0.0443543866276741
current test mse: 0.044354
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012013_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012013_3_24hr.npz
NaN value num: 0
Iteration: 741, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4465497136116028
loss_pred:0.030665075406432152, decouple_loss:0.014333090744912624
The generated pressure mean: 0.4469245970249176
loss_pred:0.03128058463335037, decouple_loss:0.014950992539525032
The generated pressure mean: 0.44725826382637024
loss_pred:0.029414569959044456, decouple_loss:0.014910087920725346
Iteration: 742, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44691380858421326
The generated pressure mean: 0.4478999078273773
loss_pred:0.030753526836633682, decouple_loss:0.018763629719614983
loss_pred:0.03102121502161026, decouple_loss:0.019317742437124252
The generated pressure mean: 0.4489162862300873
loss_pred:0.03071555495262146, decouple_loss:0.019975043833255768
Iteration: 743, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4472711682319641
The generated pressure mean: 0.44652217626571655
loss_pred:0.03114631399512291, decouple_loss:0.01726524345576763
loss_pred:0.03161119297146797, decouple_loss:0.01715490035712719
The generated pressure mean: 0.448482483625412
loss_pred:0.03147774934768677, decouple_loss:0.017436766996979713
Iteration: 744, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4480850398540497
The generated pressure mean: 0.44745805859565735
loss_pred:0.02997151017189026, decouple_loss:0.018300767987966537
loss_pred:0.029749592766165733, decouple_loss:0.018409954383969307
The generated pressure mean: 0.4465150237083435
loss_pred:0.03029252588748932, decouple_loss:0.018099673092365265
Iteration: 745, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44752824306488037
The generated pressure mean: 0.4487799406051636
loss_pred:0.030484195798635483, decouple_loss:0.018061678856611252
loss_pred:0.03261725232005119, decouple_loss:0.017921602353453636
The generated pressure mean: 0.4467009902000427
loss_pred:0.030699661001563072, decouple_loss:0.01800534687936306
Iteration: 746, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44717198610305786
The generated pressure mean: 0.4483893811702728loss_pred:0.03147639334201813, decouple_loss:0.016298875212669373
loss_pred:0.03043263405561447, decouple_loss:0.01646219938993454
The generated pressure mean: 0.44724032282829285
loss_pred:0.03014465607702732, decouple_loss:0.016896752640604973
Iteration: 747, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44876283407211304The generated pressure mean: 0.44750797748565674
loss_pred:0.03265843167901039, decouple_loss:0.017114024609327316
loss_pred:0.02885863371193409, decouple_loss:0.01689794659614563
The generated pressure mean: 0.44799256324768066
loss_pred:0.030736185610294342, decouple_loss:0.016919763758778572
Iteration: 748, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44732221961021423
The generated pressure mean: 0.4468412697315216
loss_pred:0.03006281703710556, decouple_loss:0.01599310338497162
loss_pred:0.031327564269304276, decouple_loss:0.015835771337151527
The generated pressure mean: 0.4474467933177948
loss_pred:0.02886982262134552, decouple_loss:0.01611408032476902
Iteration: 749, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4470864534378052
The generated pressure mean: 0.4487040936946869
loss_pred:0.030515557155013084, decouple_loss:0.016438376158475876
loss_pred:0.030301187187433243, decouple_loss:0.016233529895544052
The generated pressure mean: 0.448162704706192
loss_pred:0.03110225312411785, decouple_loss:0.016302375122904778
Iteration: 750, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4466283321380615
loss_pred:0.029811469838023186, decouple_loss:0.016244783997535706
The generated pressure mean: 0.4478975534439087
loss_pred:0.030667059123516083, decouple_loss:0.016127238050103188
The generated pressure mean: 0.44819068908691406
loss_pred:0.02880243957042694, decouple_loss:0.016328398138284683
2023-04-16 04:07:44 testing...
The generated pressure mean: 0.4497888684272766
The generated pressure mean: 0.4495830535888672
The generated pressure mean: 0.44987666606903076
loss_pred:0.03765174373984337, decouple_loss:0.016441142186522484
loss_pred:0.03623643517494202, decouple_loss:0.016414372250437737loss_pred:0.035323616117239, decouple_loss:0.01654648967087269
Loss: 0.03722729906439781, avg_mse: 0.044000670313835144
current test mse: 0.044001
Iteration: 751, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4480471909046173
The generated pressure mean: 0.44677913188934326loss_pred:0.03062671795487404, decouple_loss:0.01623760163784027
loss_pred:0.030825713649392128, decouple_loss:0.01646627113223076
The generated pressure mean: 0.4485374093055725
loss_pred:0.02991178259253502, decouple_loss:0.01625753939151764
Iteration: 752, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4481365978717804
loss_pred:0.029997674748301506, decouple_loss:0.016582543030381203
The generated pressure mean: 0.44776859879493713
loss_pred:0.029661353677511215, decouple_loss:0.01661834307014942
The generated pressure mean: 0.44889259338378906
loss_pred:0.029858144000172615, decouple_loss:0.016359180212020874
Iteration: 753, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4472111463546753
The generated pressure mean: 0.4477558732032776
loss_pred:0.030330238863825798, decouple_loss:0.015498727560043335
loss_pred:0.03099517896771431, decouple_loss:0.01562485657632351
The generated pressure mean: 0.4470941126346588
loss_pred:0.03051203489303589, decouple_loss:0.015709828585386276
Iteration: 754, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.447113960981369
The generated pressure mean: 0.44681647419929504
loss_pred:0.03025665506720543, decouple_loss:0.014732054434716702
loss_pred:0.029607001692056656, decouple_loss:0.014697405509650707
The generated pressure mean: 0.4473112225532532
loss_pred:0.030046194791793823, decouple_loss:0.015083888545632362
Iteration: 755, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4474093019962311
The generated pressure mean: 0.44784653186798096
loss_pred:0.0289221853017807, decouple_loss:0.014623524621129036
loss_pred:0.029413649812340736, decouple_loss:0.014760470949113369
The generated pressure mean: 0.44742703437805176
loss_pred:0.029190797358751297, decouple_loss:0.014483099803328514
Iteration: 756, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4462844133377075
The generated pressure mean: 0.4462960362434387
loss_pred:0.02990870736539364, decouple_loss:0.014340661466121674
loss_pred:0.030036959797143936, decouple_loss:0.014895970933139324
The generated pressure mean: 0.44627127051353455
loss_pred:0.030080389231443405, decouple_loss:0.01453404687345028
Iteration: 757, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4470463991165161
loss_pred:0.029888886958360672, decouple_loss:0.014098070561885834
The generated pressure mean: 0.44708892703056335
loss_pred:0.03141070902347565, decouple_loss:0.014166551642119884
The generated pressure mean: 0.4474667012691498
loss_pred:0.028970254585146904, decouple_loss:0.01378115639090538
Iteration: 758, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4479955732822418
loss_pred:0.029088344424962997, decouple_loss:0.014671939425170422
The generated pressure mean: 0.44779103994369507
loss_pred:0.029177533462643623, decouple_loss:0.015403163619339466
The generated pressure mean: 0.44788146018981934
loss_pred:0.02956794947385788, decouple_loss:0.01545771211385727
Iteration: 759, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.446719229221344
The generated pressure mean: 0.44747138023376465
loss_pred:0.030698737129569054, decouple_loss:0.01386659312993288
loss_pred:0.029274795204401016, decouple_loss:0.014518385753035545
The generated pressure mean: 0.44763094186782837
loss_pred:0.03062395378947258, decouple_loss:0.01429239846765995
Iteration: 760, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4469221234321594
The generated pressure mean: 0.44799885153770447
loss_pred:0.030153336003422737, decouple_loss:0.014684340916574001
loss_pred:0.02879808284342289, decouple_loss:0.014526569284498692
The generated pressure mean: 0.4482991695404053
loss_pred:0.028531813994050026, decouple_loss:0.014785190112888813
2023-04-16 04:09:37 testing...
The generated pressure mean: 0.4495830833911896
The generated pressure mean: 0.4497888684272766
The generated pressure mean: 0.44987666606903076
loss_pred:0.03616970404982567, decouple_loss:0.01402681227773428
loss_pred:0.03693943843245506, decouple_loss:0.01415114663541317
loss_pred:0.03523973748087883, decouple_loss:0.014213125221431255
Loss: 0.036822810769081116, avg_mse: 0.043844807893037796
current test mse: 0.043845
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012008_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012008_3_24hr.npz
NaN value num: 0
Iteration: 761, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.448513925075531
loss_pred:0.029563141986727715, decouple_loss:0.014960210770368576
The generated pressure mean: 0.4472668468952179
loss_pred:0.0286434143781662, decouple_loss:0.01446186937391758
The generated pressure mean: 0.44743573665618896
loss_pred:0.02912217751145363, decouple_loss:0.014323892071843147
Iteration: 762, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44736436009407043
The generated pressure mean: 0.4466054439544678
loss_pred:0.029940428212285042, decouple_loss:0.013948529027402401
loss_pred:0.030299313366413116, decouple_loss:0.013940191827714443
The generated pressure mean: 0.448159396648407
loss_pred:0.030825290828943253, decouple_loss:0.013744156807661057
Iteration: 763, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44797995686531067
The generated pressure mean: 0.4482094943523407
loss_pred:0.028335431590676308, decouple_loss:0.014029244892299175
loss_pred:0.029531210660934448, decouple_loss:0.014104521833360195
The generated pressure mean: 0.4469151496887207
loss_pred:0.03182530403137207, decouple_loss:0.01416244637221098
Iteration: 764, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4477563798427582
The generated pressure mean: 0.4469769597053528
loss_pred:0.02853827178478241, decouple_loss:0.014335459098219872
loss_pred:0.02980445884168148, decouple_loss:0.013893318362534046
The generated pressure mean: 0.4472697675228119
loss_pred:0.029901789501309395, decouple_loss:0.013992752879858017
Iteration: 765, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4486221969127655
The generated pressure mean: 0.44767674803733826loss_pred:0.02891480177640915, decouple_loss:0.014616982080042362
The generated pressure mean: 0.44828876852989197
loss_pred:0.0293654166162014, decouple_loss:0.014807643368840218
loss_pred:0.028860775753855705, decouple_loss:0.015063191764056683
Iteration: 766, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44668376445770264
The generated pressure mean: 0.44687357544898987
loss_pred:0.02910517528653145, decouple_loss:0.014994787983596325
loss_pred:0.03098215162754059, decouple_loss:0.015097749419510365
The generated pressure mean: 0.44802576303482056
loss_pred:0.028061626479029655, decouple_loss:0.014812527224421501
Iteration: 767, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4484352171421051
The generated pressure mean: 0.44762831926345825
loss_pred:0.02987370453774929, decouple_loss:0.014475378207862377
loss_pred:0.028739644214510918, decouple_loss:0.014490651898086071
The generated pressure mean: 0.4468684494495392
loss_pred:0.02943224273622036, decouple_loss:0.01442975178360939
Iteration: 768, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4477500021457672
The generated pressure mean: 0.44847428798675537
loss_pred:0.029122833162546158, decouple_loss:0.014004879631102085
loss_pred:0.02941691316664219, decouple_loss:0.014174544252455235
The generated pressure mean: 0.44690239429473877
loss_pred:0.030091676861047745, decouple_loss:0.014085007831454277
Iteration: 769, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44798728823661804The generated pressure mean: 0.449179083108902
loss_pred:0.028421681374311447, decouple_loss:0.014320910908281803
loss_pred:0.028961576521396637, decouple_loss:0.014079032465815544
The generated pressure mean: 0.44778189063072205
loss_pred:0.029387526214122772, decouple_loss:0.014003225602209568
Iteration: 770, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4483543634414673
The generated pressure mean: 0.4489873945713043
loss_pred:0.029650438576936722, decouple_loss:0.013569009490311146
loss_pred:0.029688937589526176, decouple_loss:0.013801796361804008
The generated pressure mean: 0.44713106751441956
loss_pred:0.029153594747185707, decouple_loss:0.013446665368974209
2023-04-16 04:12:08 testing...
The generated pressure mean: 0.4495830535888672
The generated pressure mean: 0.4497888684272766
The generated pressure mean: 0.44987666606903076
loss_pred:0.037139877676963806, decouple_loss:0.01321621984243393
loss_pred:0.037412963807582855, decouple_loss:0.013302210718393326
loss_pred:0.036420464515686035, decouple_loss:0.013081278651952744
Loss: 0.037651099264621735, avg_mse: 0.04564240202307701
current test mse: 0.045642
Iteration: 771, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44617441296577454
The generated pressure mean: 0.4471588730812073loss_pred:0.03057168982923031, decouple_loss:0.01336161233484745
loss_pred:0.029731184244155884, decouple_loss:0.012841432355344296
The generated pressure mean: 0.44934898614883423
loss_pred:0.02881523221731186, decouple_loss:0.012676510959863663
Iteration: 772, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44692468643188477
The generated pressure mean: 0.4476199448108673
loss_pred:0.02904970943927765, decouple_loss:0.01438408624380827
loss_pred:0.030011998489499092, decouple_loss:0.014521322213113308
The generated pressure mean: 0.44826120138168335
loss_pred:0.02860851027071476, decouple_loss:0.013990413397550583
Iteration: 773, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4483950734138489
The generated pressure mean: 0.44948098063468933
loss_pred:0.02989603951573372, decouple_loss:0.01483683567494154
loss_pred:0.028994427993893623, decouple_loss:0.01495267916470766
The generated pressure mean: 0.44645360112190247
loss_pred:0.029488949105143547, decouple_loss:0.01456921361386776
Iteration: 774, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4473857581615448
The generated pressure mean: 0.4472024142742157
loss_pred:0.029161756858229637, decouple_loss:0.014010903425514698
loss_pred:0.029336368665099144, decouple_loss:0.014281409792602062
The generated pressure mean: 0.44811391830444336
loss_pred:0.029240278527140617, decouple_loss:0.013625984080135822
Iteration: 775, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44751372933387756
The generated pressure mean: 0.44793081283569336
loss_pred:0.030921269208192825, decouple_loss:0.015760445967316628
loss_pred:0.03061489760875702, decouple_loss:0.015520508401095867
The generated pressure mean: 0.447916179895401
loss_pred:0.029620865359902382, decouple_loss:0.015734819695353508
Iteration: 776, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4479028582572937
loss_pred:0.029699379578232765, decouple_loss:0.013393799774348736
The generated pressure mean: 0.44810476899147034
loss_pred:0.027763674035668373, decouple_loss:0.013887295499444008
The generated pressure mean: 0.4480445384979248
loss_pred:0.028346652165055275, decouple_loss:0.013378207571804523
Iteration: 777, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44781970977783203
The generated pressure mean: 0.4467870891094208
loss_pred:0.029021503403782845, decouple_loss:0.013122749514877796
loss_pred:0.028877239674329758, decouple_loss:0.013431052677333355
The generated pressure mean: 0.44797220826148987
loss_pred:0.02951871231198311, decouple_loss:0.013047339394688606
Iteration: 778, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4479478597640991
The generated pressure mean: 0.4475749433040619
loss_pred:0.03064725361764431, decouple_loss:0.01298064086586237
loss_pred:0.028584495186805725, decouple_loss:0.01344040036201477
The generated pressure mean: 0.44765833020210266
loss_pred:0.02925962209701538, decouple_loss:0.013063891790807247
Iteration: 779, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44643887877464294
The generated pressure mean: 0.44857507944107056
loss_pred:0.03033769689500332, decouple_loss:0.013011159375309944
loss_pred:0.028987964615225792, decouple_loss:0.013259509578347206
The generated pressure mean: 0.44779497385025024
loss_pred:0.029167037457227707, decouple_loss:0.01314881443977356
Iteration: 780, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44900399446487427The generated pressure mean: 0.4483235776424408
loss_pred:0.027902131900191307, decouple_loss:0.014008176513016224
loss_pred:0.027984002605080605, decouple_loss:0.01397427823394537
The generated pressure mean: 0.44977760314941406
loss_pred:0.028688369318842888, decouple_loss:0.014415159821510315
2023-04-16 04:14:01 testing...
The generated pressure mean: 0.4497888684272766
The generated pressure mean: 0.4495830833911896
The generated pressure mean: 0.44987666606903076
loss_pred:0.035936396569013596, decouple_loss:0.015180683694779873
loss_pred:0.03494267165660858, decouple_loss:0.014757564291357994
loss_pred:0.03444649651646614, decouple_loss:0.01481248252093792
Loss: 0.03585436940193176, avg_mse: 0.0421481654047966
current test mse: 0.042148
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012004_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012004_3_24hr.npz
NaN value num: 0
Iteration: 781, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44727715849876404
loss_pred:0.03035830520093441, decouple_loss:0.015044688247144222
The generated pressure mean: 0.44642502069473267
The generated pressure mean: 0.44769221544265747
loss_pred:0.029873164370656013, decouple_loss:0.015005530789494514
loss_pred:0.03027305193245411, decouple_loss:0.01533786952495575
Iteration: 782, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4466927945613861
loss_pred:0.029540851712226868, decouple_loss:0.01412908174097538
The generated pressure mean: 0.44716641306877136
loss_pred:0.030060846358537674, decouple_loss:0.014494025148451328
The generated pressure mean: 0.4475368559360504
loss_pred:0.02978692017495632, decouple_loss:0.014664223417639732
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 783, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44809916615486145
The generated pressure mean: 0.4483192265033722
loss_pred:0.028735607862472534, decouple_loss:0.01404092088341713
loss_pred:0.030717428773641586, decouple_loss:0.014294445514678955
The generated pressure mean: 0.4455784261226654
loss_pred:0.028758786618709564, decouple_loss:0.013890978880226612
Iteration: 784, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4486333727836609
loss_pred:0.03025975078344345, decouple_loss:0.012958886101841927
The generated pressure mean: 0.44792696833610535
loss_pred:0.030883096158504486, decouple_loss:0.012944639660418034
The generated pressure mean: 0.44786536693573
loss_pred:0.02917986549437046, decouple_loss:0.012760763987898827
Iteration: 785, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44804468750953674
loss_pred:0.03036443702876568, decouple_loss:0.014346378855407238
The generated pressure mean: 0.44784584641456604
loss_pred:0.028400836512446404, decouple_loss:0.013869869522750378
The generated pressure mean: 0.4481574296951294
loss_pred:0.030461082234978676, decouple_loss:0.013934224843978882
Iteration: 786, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44733601808547974
loss_pred:0.029760276898741722, decouple_loss:0.015245254151523113
The generated pressure mean: 0.4468432366847992
loss_pred:0.02969135157763958, decouple_loss:0.015452399849891663
The generated pressure mean: 0.44751399755477905
loss_pred:0.02868390455842018, decouple_loss:0.015773799270391464
Iteration: 787, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44762372970581055
loss_pred:0.02842400036752224, decouple_loss:0.013488095253705978
The generated pressure mean: 0.44733962416648865
loss_pred:0.030048709362745285, decouple_loss:0.013590161688625813
The generated pressure mean: 0.44772398471832275
loss_pred:0.029047992080450058, decouple_loss:0.01369787473231554
Iteration: 788, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44812795519828796
loss_pred:0.028816869482398033, decouple_loss:0.013692226260900497
The generated pressure mean: 0.4476580023765564
loss_pred:0.028534885495901108, decouple_loss:0.013531187549233437
The generated pressure mean: 0.44784218072891235
loss_pred:0.030533920973539352, decouple_loss:0.013908358290791512
Iteration: 789, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4458563029766083
loss_pred:0.028808072209358215, decouple_loss:0.014867505989968777
The generated pressure mean: 0.44606471061706543
loss_pred:0.029435131698846817, decouple_loss:0.014801968820393085
The generated pressure mean: 0.448651522397995
loss_pred:0.02866445668041706, decouple_loss:0.01510811597108841
Iteration: 790, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4481734037399292
loss_pred:0.02802530862390995, decouple_loss:0.013241011649370193
The generated pressure mean: 0.44665247201919556
loss_pred:0.029127780348062515, decouple_loss:0.013251190073788166
The generated pressure mean: 0.44732123613357544
loss_pred:0.029868820682168007, decouple_loss:0.013504729606211185
2023-04-16 04:16:36 testing...
The generated pressure mean: 0.4495830535888672
The generated pressure mean: 0.4497888684272766
The generated pressure mean: 0.44987666606903076
loss_pred:0.03560078889131546, decouple_loss:0.01394602283835411
loss_pred:0.036320216953754425, decouple_loss:0.014092224650084972
loss_pred:0.03508879989385605, decouple_loss:0.013847948983311653
Loss: 0.03636804223060608, avg_mse: 0.043489083647727966
current test mse: 0.043489
Iteration: 791, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44728487730026245
loss_pred:0.029922490939497948, decouple_loss:0.013894326984882355
The generated pressure mean: 0.44744783639907837
loss_pred:0.030504174530506134, decouple_loss:0.013877381570637226
The generated pressure mean: 0.44811680912971497
loss_pred:0.028009813278913498, decouple_loss:0.013835861347615719
Iteration: 792, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4474705159664154
loss_pred:0.02927446737885475, decouple_loss:0.013697510585188866
The generated pressure mean: 0.4466976225376129
loss_pred:0.028357185423374176, decouple_loss:0.013445795513689518
The generated pressure mean: 0.44619259238243103
loss_pred:0.028747042641043663, decouple_loss:0.013374216854572296
Iteration: 793, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4466819167137146
The generated pressure mean: 0.44809389114379883loss_pred:0.02992970123887062, decouple_loss:0.01259224209934473
loss_pred:0.028485465794801712, decouple_loss:0.012341044843196869
The generated pressure mean: 0.4479922950267792
loss_pred:0.028117168694734573, decouple_loss:0.012338208965957165
Iteration: 794, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44827938079833984
loss_pred:0.028310410678386688, decouple_loss:0.012462690472602844
The generated pressure mean: 0.4462664723396301
loss_pred:0.028615174815058708, decouple_loss:0.012793688103556633
The generated pressure mean: 0.447194367647171
loss_pred:0.030016496777534485, decouple_loss:0.01293635368347168
Iteration: 795, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44795340299606323
The generated pressure mean: 0.4473423361778259loss_pred:0.02913978137075901, decouple_loss:0.012631737627089024
loss_pred:0.028494205325841904, decouple_loss:0.012626244686543941
The generated pressure mean: 0.44782304763793945
loss_pred:0.028974447399377823, decouple_loss:0.012934324331581593
Iteration: 796, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44777384400367737
The generated pressure mean: 0.4473124146461487
loss_pred:0.029219072312116623, decouple_loss:0.012883368879556656
loss_pred:0.029165586456656456, decouple_loss:0.012814274057745934
The generated pressure mean: 0.4463234841823578
loss_pred:0.030082060024142265, decouple_loss:0.01281226146966219
Iteration: 797, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44763290882110596
loss_pred:0.028465861454606056, decouple_loss:0.013052558526396751
The generated pressure mean: 0.4460369944572449
loss_pred:0.02857484668493271, decouple_loss:0.013114036992192268
The generated pressure mean: 0.4473298490047455
loss_pred:0.028799016028642654, decouple_loss:0.012970241717994213
Iteration: 798, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44725462794303894
loss_pred:0.02821652777493, decouple_loss:0.012603824026882648
The generated pressure mean: 0.4483369290828705
loss_pred:0.028346464037895203, decouple_loss:0.012407948262989521
The generated pressure mean: 0.4476127028465271
loss_pred:0.029819387942552567, decouple_loss:0.012390145100653172
Iteration: 799, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44667744636535645
loss_pred:0.028942061588168144, decouple_loss:0.012469327077269554
The generated pressure mean: 0.44786497950553894
loss_pred:0.02909603714942932, decouple_loss:0.012776789255440235
The generated pressure mean: 0.4480590224266052
loss_pred:0.028363240882754326, decouple_loss:0.01266811229288578
Iteration: 800, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4481970965862274
loss_pred:0.02851676009595394, decouple_loss:0.01201031543314457
The generated pressure mean: 0.4470152258872986
loss_pred:0.03048934042453766, decouple_loss:0.011900783516466618
The generated pressure mean: 0.44663006067276
loss_pred:0.030051447451114655, decouple_loss:0.01191345602273941
2023-04-16 04:18:30 testing...
The generated pressure mean: 0.4495830535888672
The generated pressure mean: 0.449788898229599
The generated pressure mean: 0.44987666606903076
loss_pred:0.03557794541120529, decouple_loss:0.013158394955098629
loss_pred:0.03588710352778435, decouple_loss:0.013081764802336693
loss_pred:0.0351584367454052, decouple_loss:0.01309006568044424
Loss: 0.03619666397571564, avg_mse: 0.04334129020571709
current test mse: 0.043341
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012015_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012015_3_24hr.npz
NaN value num: 0
Iteration: 801, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44692474603652954
loss_pred:0.02915075048804283, decouple_loss:0.013144463300704956
The generated pressure mean: 0.44681504368782043
loss_pred:0.029539281502366066, decouple_loss:0.013024687767028809
The generated pressure mean: 0.44675591588020325
loss_pred:0.0324971005320549, decouple_loss:0.012985066510736942
Iteration: 802, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4463682174682617The generated pressure mean: 0.447144091129303
loss_pred:0.029929442331194878, decouple_loss:0.013122924603521824loss_pred:0.02891809120774269, decouple_loss:0.013189898803830147
The generated pressure mean: 0.4457946717739105
loss_pred:0.0318596288561821, decouple_loss:0.012909282930195332
Iteration: 803, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44683507084846497
The generated pressure mean: 0.44764935970306396
loss_pred:0.031047988682985306, decouple_loss:0.012907885946333408
loss_pred:0.031068358570337296, decouple_loss:0.012783448211848736
The generated pressure mean: 0.44418954849243164
loss_pred:0.03047354519367218, decouple_loss:0.013033594936132431
Iteration: 804, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44547614455223083
The generated pressure mean: 0.4465303421020508
loss_pred:0.029682451859116554, decouple_loss:0.012529769912362099
loss_pred:0.03136124089360237, decouple_loss:0.013212790712714195
The generated pressure mean: 0.4476238787174225
loss_pred:0.030450966209173203, decouple_loss:0.012319201603531837
Iteration: 805, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44671282172203064
The generated pressure mean: 0.44565340876579285loss_pred:0.02956807240843773, decouple_loss:0.013003154657781124
loss_pred:0.0298406183719635, decouple_loss:0.012792044319212437
The generated pressure mean: 0.4470517337322235
loss_pred:0.02973753958940506, decouple_loss:0.01289004273712635
Iteration: 806, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4449183940887451
loss_pred:0.03143739700317383, decouple_loss:0.012917188927531242
The generated pressure mean: 0.44599515199661255
The generated pressure mean: 0.44563719630241394
loss_pred:0.033341072499752045, decouple_loss:0.012969942763447762
loss_pred:0.02918742410838604, decouple_loss:0.012615279294550419
Iteration: 807, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44701582193374634
loss_pred:0.02994445711374283, decouple_loss:0.013779198750853539
The generated pressure mean: 0.446176677942276
loss_pred:0.03133091330528259, decouple_loss:0.013526701368391514
The generated pressure mean: 0.4465227425098419
loss_pred:0.02961011789739132, decouple_loss:0.013693776912987232
Iteration: 808, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44647565484046936
loss_pred:0.028559988364577293, decouple_loss:0.013556892052292824
The generated pressure mean: 0.4471602141857147
loss_pred:0.029835576191544533, decouple_loss:0.0132443243637681
The generated pressure mean: 0.44558170437812805
loss_pred:0.02968604303896427, decouple_loss:0.013528481125831604
Iteration: 809, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44725629687309265
loss_pred:0.029254978522658348, decouple_loss:0.013417504727840424
The generated pressure mean: 0.4451724886894226
loss_pred:0.02962482161819935, decouple_loss:0.013127108104526997
The generated pressure mean: 0.4473857581615448
loss_pred:0.031853318214416504, decouple_loss:0.012875320389866829
Iteration: 810, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44705435633659363
loss_pred:0.031706467270851135, decouple_loss:0.012408532202243805
The generated pressure mean: 0.44706955552101135
loss_pred:0.029235685244202614, decouple_loss:0.012267396785318851
The generated pressure mean: 0.445913702249527
loss_pred:0.02930363453924656, decouple_loss:0.012091273441910744
2023-04-16 04:21:01 testing...
The generated pressure mean: 0.4495830833911896
The generated pressure mean: 0.449788898229599
The generated pressure mean: 0.44987666606903076
loss_pred:0.03572805970907211, decouple_loss:0.012130139395594597
loss_pred:0.03618315979838371, decouple_loss:0.012031198479235172
loss_pred:0.03496979549527168, decouple_loss:0.012245466001331806
Loss: 0.03623378649353981, avg_mse: 0.04349606856703758
current test mse: 0.043496
Iteration: 811, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4464186131954193
The generated pressure mean: 0.4454677700996399
loss_pred:0.03111189231276512, decouple_loss:0.012112317606806755
loss_pred:0.03175896033644676, decouple_loss:0.011835078708827496
The generated pressure mean: 0.44592511653900146
loss_pred:0.029435504227876663, decouple_loss:0.011972491629421711
Iteration: 812, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4467942416667938
The generated pressure mean: 0.44717806577682495
loss_pred:0.029145818203687668, decouple_loss:0.012368262745440006
loss_pred:0.02928708679974079, decouple_loss:0.012270847335457802
The generated pressure mean: 0.44665977358818054
loss_pred:0.029647991061210632, decouple_loss:0.012681156396865845
Iteration: 813, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4459589421749115
loss_pred:0.029074382036924362, decouple_loss:0.012267048470675945
The generated pressure mean: 0.4456939995288849
The generated pressure mean: 0.4463280439376831
loss_pred:0.030888652428984642, decouple_loss:0.012299696914851665
loss_pred:0.030348870903253555, decouple_loss:0.01266586221754551
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 814, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44696277379989624
The generated pressure mean: 0.4470646381378174
loss_pred:0.03128210827708244, decouple_loss:0.012306010350584984
loss_pred:0.030473772436380386, decouple_loss:0.01233167015016079
The generated pressure mean: 0.4465557038784027
loss_pred:0.028685206547379494, decouple_loss:0.012186197564005852
Iteration: 815, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44587963819503784
loss_pred:0.031034573912620544, decouple_loss:0.01266373973339796
The generated pressure mean: 0.4458605945110321
loss_pred:0.029095547273755074, decouple_loss:0.012476441450417042
The generated pressure mean: 0.4465024769306183
loss_pred:0.031303521245718, decouple_loss:0.012563246302306652
Iteration: 816, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44630181789398193
loss_pred:0.028973020613193512, decouple_loss:0.01255506370216608
The generated pressure mean: 0.44660240411758423
loss_pred:0.028909746557474136, decouple_loss:0.012588249519467354
The generated pressure mean: 0.44647127389907837
loss_pred:0.029480841010808945, decouple_loss:0.012808685190975666
Iteration: 817, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44583043456077576
loss_pred:0.028965912759304047, decouple_loss:0.012331603094935417
The generated pressure mean: 0.44665899872779846
loss_pred:0.030189916491508484, decouple_loss:0.01214118953794241
The generated pressure mean: 0.44659748673439026
loss_pred:0.029990335926413536, decouple_loss:0.01219630055129528
Iteration: 818, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44556576013565063
loss_pred:0.030208490788936615, decouple_loss:0.013031462207436562
The generated pressure mean: 0.44609972834587097
loss_pred:0.02929251827299595, decouple_loss:0.013019944541156292
The generated pressure mean: 0.44704344868659973
loss_pred:0.03117767721414566, decouple_loss:0.013186602853238583
Iteration: 819, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4471549987792969
The generated pressure mean: 0.4479641616344452
loss_pred:0.031147023662924767, decouple_loss:0.013061551377177238
loss_pred:0.031231846660375595, decouple_loss:0.013244492933154106
The generated pressure mean: 0.44722798466682434
loss_pred:0.029929734766483307, decouple_loss:0.013028017245233059
Iteration: 820, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4471542239189148
loss_pred:0.02969830110669136, decouple_loss:0.01314378622919321
The generated pressure mean: 0.44618159532546997
loss_pred:0.03063344955444336, decouple_loss:0.012948288582265377
The generated pressure mean: 0.4464435279369354
loss_pred:0.03029322437942028, decouple_loss:0.012727630324661732
2023-04-16 04:22:55 testing...
The generated pressure mean: 0.4495830833911896
The generated pressure mean: 0.4497888684272766
The generated pressure mean: 0.44987666606903076
loss_pred:0.036174219101667404, decouple_loss:0.012777095660567284
loss_pred:0.03684120625257492, decouple_loss:0.012844846583902836
loss_pred:0.03581856191158295, decouple_loss:0.012805662117898464
Loss: 0.036918457597494125, avg_mse: 0.04490131884813309
current test mse: 0.044901
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012009_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012009_3_24hr.npz
NaN value num: 0
Iteration: 821, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4478420615196228
loss_pred:0.028900785371661186, decouple_loss:0.01268803235143423
The generated pressure mean: 0.4476727247238159
loss_pred:0.029870467260479927, decouple_loss:0.012480735778808594
The generated pressure mean: 0.44736161828041077
loss_pred:0.029972543939948082, decouple_loss:0.012766582891345024
Iteration: 822, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4470822811126709
The generated pressure mean: 0.4483659267425537
loss_pred:0.02877245470881462, decouple_loss:0.014106658287346363
loss_pred:0.028878575190901756, decouple_loss:0.013883993960916996
The generated pressure mean: 0.44697925448417664
loss_pred:0.02871115319430828, decouple_loss:0.014060428366065025
Iteration: 823, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4473932087421417
loss_pred:0.028770238161087036, decouple_loss:0.014659770764410496
The generated pressure mean: 0.4480317533016205
loss_pred:0.03175920620560646, decouple_loss:0.014775835908949375
The generated pressure mean: 0.44679686427116394
loss_pred:0.02818113937973976, decouple_loss:0.015215183608233929
Iteration: 824, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4476069211959839
loss_pred:0.029143286868929863, decouple_loss:0.014506268315017223
The generated pressure mean: 0.44752976298332214
loss_pred:0.029470719397068024, decouple_loss:0.014357523061335087
The generated pressure mean: 0.4469814896583557
loss_pred:0.02904062531888485, decouple_loss:0.014260122552514076
Iteration: 825, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44778165221214294
loss_pred:0.028676088899374008, decouple_loss:0.013349439948797226
The generated pressure mean: 0.4471273124217987
loss_pred:0.028556382283568382, decouple_loss:0.013176200911402702
The generated pressure mean: 0.4472886323928833
loss_pred:0.02855410799384117, decouple_loss:0.013570435345172882
Iteration: 826, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4461471736431122
loss_pred:0.02959885448217392, decouple_loss:0.013617808930575848
The generated pressure mean: 0.4461553990840912
loss_pred:0.028302321210503578, decouple_loss:0.013866444118320942
The generated pressure mean: 0.44852012395858765
loss_pred:0.028704162687063217, decouple_loss:0.013451485894620419
Iteration: 827, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44803327322006226
loss_pred:0.029578443616628647, decouple_loss:0.013730814680457115
The generated pressure mean: 0.4487040936946869
loss_pred:0.029558366164565086, decouple_loss:0.013986112549901009
The generated pressure mean: 0.44854751229286194
loss_pred:0.029725130647420883, decouple_loss:0.013638129457831383
Iteration: 828, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4474954903125763
loss_pred:0.02884935960173607, decouple_loss:0.012934510596096516
The generated pressure mean: 0.44982996582984924
loss_pred:0.030199838802218437, decouple_loss:0.012812012806534767
The generated pressure mean: 0.445587694644928
loss_pred:0.028774995356798172, decouple_loss:0.012837751768529415
Iteration: 829, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4493076503276825
loss_pred:0.029010269790887833, decouple_loss:0.01295497640967369
The generated pressure mean: 0.44608765840530396
loss_pred:0.028583770617842674, decouple_loss:0.013042652048170567
The generated pressure mean: 0.44727861881256104
loss_pred:0.029138145968317986, decouple_loss:0.013571137562394142
Iteration: 830, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4468082785606384
loss_pred:0.029769955202937126, decouple_loss:0.012843168340623379
The generated pressure mean: 0.44760459661483765
loss_pred:0.02898717112839222, decouple_loss:0.012169173918664455
The generated pressure mean: 0.44623613357543945
loss_pred:0.02842388115823269, decouple_loss:0.012307669036090374
2023-04-16 04:25:25 testing...
The generated pressure mean: 0.4495830833911896
The generated pressure mean: 0.4497888684272766
The generated pressure mean: 0.44987666606903076
loss_pred:0.03484569489955902, decouple_loss:0.011880619451403618
loss_pred:0.03519221022725105, decouple_loss:0.011885061860084534
loss_pred:0.03437570109963417, decouple_loss:0.01190697867423296
Loss: 0.03539907932281494, avg_mse: 0.04221663996577263
current test mse: 0.042217
Iteration: 831, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44753408432006836
The generated pressure mean: 0.44779470562934875
loss_pred:0.029023291543126106, decouple_loss:0.011883344501256943
loss_pred:0.028712494298815727, decouple_loss:0.011743872426450253
The generated pressure mean: 0.4468348026275635
loss_pred:0.02872268296778202, decouple_loss:0.012509956024587154
Iteration: 832, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44741398096084595
loss_pred:0.028339693322777748, decouple_loss:0.011830520816147327
The generated pressure mean: 0.44661808013916016
loss_pred:0.02882114239037037, decouple_loss:0.011820030398666859
The generated pressure mean: 0.4483109414577484
loss_pred:0.029852362349629402, decouple_loss:0.011879953555762768
Iteration: 833, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4471665322780609
loss_pred:0.028771651908755302, decouple_loss:0.012625829316675663
The generated pressure mean: 0.4483940899372101
The generated pressure mean: 0.4474327862262726
loss_pred:0.02971552312374115, decouple_loss:0.012137343175709248
loss_pred:0.028808876872062683, decouple_loss:0.012062589637935162
Iteration: 834, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4476143717765808
loss_pred:0.028849570080637932, decouple_loss:0.013720470480620861
The generated pressure mean: 0.44692885875701904
loss_pred:0.028131311759352684, decouple_loss:0.013931987807154655
The generated pressure mean: 0.4487951695919037
loss_pred:0.02915370464324951, decouple_loss:0.013728278689086437
Iteration: 835, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.446424663066864
The generated pressure mean: 0.4461551308631897
loss_pred:0.028315989300608635, decouple_loss:0.013401019386947155
loss_pred:0.02928307093679905, decouple_loss:0.013482932932674885
The generated pressure mean: 0.44773581624031067
loss_pred:0.030321257188916206, decouple_loss:0.013665039092302322
Iteration: 836, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44688740372657776
loss_pred:0.028329715132713318, decouple_loss:0.012969046831130981
The generated pressure mean: 0.44851401448249817
loss_pred:0.030098997056484222, decouple_loss:0.013115057721734047
The generated pressure mean: 0.44719722867012024
loss_pred:0.02824699878692627, decouple_loss:0.01283369492739439
Iteration: 837, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4494333267211914
loss_pred:0.029447119683027267, decouple_loss:0.012415987439453602
The generated pressure mean: 0.4493889808654785
loss_pred:0.030163785442709923, decouple_loss:0.012567188590765
The generated pressure mean: 0.4483204483985901
loss_pred:0.02976643294095993, decouple_loss:0.012511777691543102
Iteration: 838, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44732388854026794
loss_pred:0.028671856969594955, decouple_loss:0.013714706525206566
The generated pressure mean: 0.44727686047554016
loss_pred:0.028535261750221252, decouple_loss:0.013918663375079632
The generated pressure mean: 0.44713956117630005
loss_pred:0.02978483773767948, decouple_loss:0.013959611766040325
Iteration: 839, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44784674048423767
loss_pred:0.02757328562438488, decouple_loss:0.013495306484401226
The generated pressure mean: 0.44821032881736755
loss_pred:0.027824971824884415, decouple_loss:0.013628466986119747
The generated pressure mean: 0.4454862177371979
loss_pred:0.031015615910291672, decouple_loss:0.013646709732711315
Iteration: 840, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.448018342256546
loss_pred:0.02813020907342434, decouple_loss:0.013191552832722664
The generated pressure mean: 0.44909846782684326
loss_pred:0.027908608317375183, decouple_loss:0.013215108774602413
The generated pressure mean: 0.4478175938129425
loss_pred:0.02907552570104599, decouple_loss:0.013607275672256947
2023-04-16 04:27:18 testing...
The generated pressure mean: 0.4495830535888672
The generated pressure mean: 0.4497888684272766
The generated pressure mean: 0.44987666606903076
loss_pred:0.034818608313798904, decouple_loss:0.01344901043921709
loss_pred:0.035341259092092514, decouple_loss:0.013518122024834156
loss_pred:0.034273985773324966, decouple_loss:0.01360733900219202
Loss: 0.03548752889037132, avg_mse: 0.04235433042049408
current test mse: 0.042354
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012019_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012019_3_24hr.npz
NaN value num: 0
Iteration: 841, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45082464814186096
loss_pred:0.02879362553358078, decouple_loss:0.014218123629689217
The generated pressure mean: 0.4488588273525238
The generated pressure mean: 0.4491843283176422
loss_pred:0.029735418036580086, decouple_loss:0.013639082200825214
loss_pred:0.03080853819847107, decouple_loss:0.013720671646296978
Iteration: 842, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4502295255661011
loss_pred:0.029768817126750946, decouple_loss:0.01452893391251564
The generated pressure mean: 0.45090633630752563
loss_pred:0.02916763909161091, decouple_loss:0.0141229759901762
The generated pressure mean: 0.44911807775497437
loss_pred:0.02920384518802166, decouple_loss:0.014030657708644867
Iteration: 843, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4492669105529785
The generated pressure mean: 0.44874081015586853
loss_pred:0.02763720043003559, decouple_loss:0.013859308324754238
loss_pred:0.032065749168395996, decouple_loss:0.013788358308374882
The generated pressure mean: 0.44903796911239624
loss_pred:0.030181560665369034, decouple_loss:0.013618608005344868
Iteration: 844, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4485131502151489
The generated pressure mean: 0.4496731460094452
loss_pred:0.02904210239648819, decouple_loss:0.0129967937245965
loss_pred:0.029570480808615685, decouple_loss:0.013592848554253578
The generated pressure mean: 0.4503858983516693
loss_pred:0.028709901496767998, decouple_loss:0.013360192067921162
Iteration: 845, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4498368203639984
The generated pressure mean: 0.4500034749507904
loss_pred:0.02878132276237011, decouple_loss:0.013874584808945656
loss_pred:0.03110797144472599, decouple_loss:0.014070562086999416
The generated pressure mean: 0.45018741488456726
loss_pred:0.03149533271789551, decouple_loss:0.014145961962640285
Iteration: 846, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44803234934806824
The generated pressure mean: 0.4491962790489197
loss_pred:0.028528312221169472, decouple_loss:0.013559478335082531
loss_pred:0.029490957036614418, decouple_loss:0.01374182291328907
The generated pressure mean: 0.4492749869823456
loss_pred:0.029095683246850967, decouple_loss:0.013927226886153221
Iteration: 847, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4480297267436981
loss_pred:0.029906122013926506, decouple_loss:0.014506724663078785
The generated pressure mean: 0.4492708444595337
loss_pred:0.029198413714766502, decouple_loss:0.014593907631933689
The generated pressure mean: 0.449203222990036
loss_pred:0.02887784317135811, decouple_loss:0.014329719357192516
Iteration: 848, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44919705390930176The generated pressure mean: 0.449287086725235
loss_pred:0.02845604158937931, decouple_loss:0.014312434010207653
loss_pred:0.029872111976146698, decouple_loss:0.013915592804551125
The generated pressure mean: 0.44948598742485046
loss_pred:0.028448764234781265, decouple_loss:0.014324763789772987
Iteration: 849, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44822660088539124
loss_pred:0.03000210039317608, decouple_loss:0.013554156757891178
The generated pressure mean: 0.4496931731700897
loss_pred:0.02903386950492859, decouple_loss:0.01363362092524767
The generated pressure mean: 0.4486316740512848
loss_pred:0.02979251928627491, decouple_loss:0.013548679649829865
Iteration: 850, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44860759377479553
loss_pred:0.029797455295920372, decouple_loss:0.012816478498280048
The generated pressure mean: 0.4506630599498749
loss_pred:0.03171997889876366, decouple_loss:0.013031840324401855
The generated pressure mean: 0.44893956184387207
loss_pred:0.03030223399400711, decouple_loss:0.013202986679971218
2023-04-16 04:29:49 testing...
The generated pressure mean: 0.4497888684272766
The generated pressure mean: 0.4495830833911896
The generated pressure mean: 0.44987666606903076
loss_pred:0.036165203899145126, decouple_loss:0.01364215835928917
loss_pred:0.03539688512682915, decouple_loss:0.013610613532364368
loss_pred:0.034448832273483276, decouple_loss:0.013640910387039185
Loss: 0.03601853549480438, avg_mse: 0.04330165684223175
current test mse: 0.043302
Iteration: 851, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44886115193367004
loss_pred:0.030160708352923393, decouple_loss:0.013512978330254555
The generated pressure mean: 0.44846558570861816
loss_pred:0.028681909665465355, decouple_loss:0.013724290765821934
The generated pressure mean: 0.45080986618995667
loss_pred:0.029829084873199463, decouple_loss:0.013580494560301304
Iteration: 852, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44836920499801636
loss_pred:0.030453957617282867, decouple_loss:0.012673323042690754
The generated pressure mean: 0.44858765602111816
loss_pred:0.028935963287949562, decouple_loss:0.012719525955617428
The generated pressure mean: 0.44977980852127075
loss_pred:0.03111123852431774, decouple_loss:0.012968110851943493
Iteration: 853, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4492861032485962
loss_pred:0.028181182220578194, decouple_loss:0.014410847797989845
The generated pressure mean: 0.4493621587753296
loss_pred:0.02928365394473076, decouple_loss:0.01440483145415783
The generated pressure mean: 0.44765859842300415
loss_pred:0.031122764572501183, decouple_loss:0.014262660406529903
Iteration: 854, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4501243233680725
loss_pred:0.02942994423210621, decouple_loss:0.015593340620398521
The generated pressure mean: 0.4480578303337097
loss_pred:0.030418220907449722, decouple_loss:0.015575431287288666
The generated pressure mean: 0.44947436451911926
loss_pred:0.029195239767432213, decouple_loss:0.016051603481173515
Iteration: 855, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4490286111831665
loss_pred:0.02890557423233986, decouple_loss:0.013141927309334278
The generated pressure mean: 0.4489181935787201
loss_pred:0.028913922607898712, decouple_loss:0.012869005091488361
The generated pressure mean: 0.44901034235954285
loss_pred:0.028128257021307945, decouple_loss:0.012859668582677841
Iteration: 856, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4502960443496704
loss_pred:0.028899284079670906, decouple_loss:0.01395656168460846
The generated pressure mean: 0.4492380619049072
loss_pred:0.029817869886755943, decouple_loss:0.013743560761213303
The generated pressure mean: 0.4500710964202881
loss_pred:0.028625736013054848, decouple_loss:0.014077478088438511
Iteration: 857, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44965630769729614
loss_pred:0.02996976673603058, decouple_loss:0.01514642033725977
The generated pressure mean: 0.4501102566719055
loss_pred:0.02848370373249054, decouple_loss:0.015006572008132935
The generated pressure mean: 0.4494338631629944
loss_pred:0.02859761193394661, decouple_loss:0.01494281180202961
Iteration: 858, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4497874081134796
loss_pred:0.02885247766971588, decouple_loss:0.014164434745907784
The generated pressure mean: 0.4505859315395355
loss_pred:0.027859142050147057, decouple_loss:0.014130386523902416
The generated pressure mean: 0.44965094327926636
loss_pred:0.028949517756700516, decouple_loss:0.01417782623320818
Iteration: 859, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4488268494606018
loss_pred:0.029647856950759888, decouple_loss:0.015203970484435558
The generated pressure mean: 0.44969239830970764
loss_pred:0.02833283692598343, decouple_loss:0.014823139645159245
The generated pressure mean: 0.450138658285141
loss_pred:0.028796087950468063, decouple_loss:0.01497304905205965
Iteration: 860, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44797298312187195
loss_pred:0.027423350140452385, decouple_loss:0.01453059446066618
The generated pressure mean: 0.44837287068367004
loss_pred:0.029357735067605972, decouple_loss:0.014449931681156158
The generated pressure mean: 0.4483937621116638
loss_pred:0.029170341789722443, decouple_loss:0.0143482880666852
2023-04-16 04:31:43 testing...
The generated pressure mean: 0.4495830535888672
The generated pressure mean: 0.449788898229599
The generated pressure mean: 0.44987666606903076
loss_pred:0.0359666608273983, decouple_loss:0.013300282880663872
loss_pred:0.03677903860807419, decouple_loss:0.01356864720582962
loss_pred:0.03488362953066826, decouple_loss:0.013388196937739849
Loss: 0.03654739260673523, avg_mse: 0.044385701417922974
current test mse: 0.044386
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012001_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012001_3_24hr.npz
NaN value num: 0
Iteration: 861, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4470854103565216
loss_pred:0.02839800715446472, decouple_loss:0.013920789584517479
The generated pressure mean: 0.44825175404548645
loss_pred:0.02737509459257126, decouple_loss:0.013485370203852654
The generated pressure mean: 0.4484339952468872
loss_pred:0.028793146833777428, decouple_loss:0.013604952953755856
Iteration: 862, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4455767571926117
loss_pred:0.026523957028985023, decouple_loss:0.016075031831860542
The generated pressure mean: 0.44881632924079895
loss_pred:0.028130395337939262, decouple_loss:0.015580378472805023
The generated pressure mean: 0.44730597734451294
loss_pred:0.028287939727306366, decouple_loss:0.015632620081305504
Iteration: 863, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.447226345539093
loss_pred:0.02901165559887886, decouple_loss:0.01624232530593872
The generated pressure mean: 0.44699421525001526
loss_pred:0.028309041634202003, decouple_loss:0.016004012897610664
The generated pressure mean: 0.44639071822166443
loss_pred:0.028356045484542847, decouple_loss:0.01577100344002247
Iteration: 864, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4475573003292084
The generated pressure mean: 0.4466317892074585
loss_pred:0.028686875477433205, decouple_loss:0.014749083667993546
loss_pred:0.02904328517615795, decouple_loss:0.014670133590698242
The generated pressure mean: 0.44601139426231384
loss_pred:0.028617676347494125, decouple_loss:0.014725230634212494
Iteration: 865, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4459710121154785
The generated pressure mean: 0.44653376936912537
loss_pred:0.0289255790412426, decouple_loss:0.016810690984129906
loss_pred:0.028956949710845947, decouple_loss:0.016947757452726364
The generated pressure mean: 0.4463931620121002
loss_pred:0.029335681349039078, decouple_loss:0.016902927309274673
Iteration: 866, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4490118622779846
loss_pred:0.02744092419743538, decouple_loss:0.014567647129297256
The generated pressure mean: 0.448044091463089
loss_pred:0.02664707787334919, decouple_loss:0.014585050754249096
The generated pressure mean: 0.44767576456069946
loss_pred:0.027587631717324257, decouple_loss:0.014611484482884407
Iteration: 867, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4470219612121582
The generated pressure mean: 0.44811418652534485
loss_pred:0.026853781193494797, decouple_loss:0.01625666953623295
loss_pred:0.02932899259030819, decouple_loss:0.01652202568948269
The generated pressure mean: 0.44880780577659607
loss_pred:0.02832697331905365, decouple_loss:0.016138125211000443
Iteration: 868, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44694462418556213
The generated pressure mean: 0.44795510172843933
loss_pred:0.030334170907735825, decouple_loss:0.014277161099016666
loss_pred:0.02684972621500492, decouple_loss:0.01424902118742466
The generated pressure mean: 0.4483518600463867
loss_pred:0.028522713109850883, decouple_loss:0.01432481687515974
Iteration: 869, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44603413343429565
The generated pressure mean: 0.44799819588661194loss_pred:0.026534752920269966, decouple_loss:0.014929156750440598
loss_pred:0.027949880808591843, decouple_loss:0.014948677271604538
The generated pressure mean: 0.44644472002983093
loss_pred:0.028777560219168663, decouple_loss:0.01494256779551506
Iteration: 870, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4477525055408478
The generated pressure mean: 0.44720178842544556
loss_pred:0.028246887028217316, decouple_loss:0.015524385496973991
loss_pred:0.027271807193756104, decouple_loss:0.015474165789783001
The generated pressure mean: 0.4480348825454712
loss_pred:0.02758616767823696, decouple_loss:0.015248737297952175
2023-04-16 04:34:18 testing...
The generated pressure mean: 0.4495830535888672
The generated pressure mean: 0.4497888684272766
The generated pressure mean: 0.44987666606903076
loss_pred:0.0349799282848835, decouple_loss:0.015210889279842377
loss_pred:0.03530479967594147, decouple_loss:0.015139637514948845
loss_pred:0.034266699105501175, decouple_loss:0.015163739211857319
Loss: 0.03560904785990715, avg_mse: 0.042784880846738815
current test mse: 0.042785
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 871, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44770726561546326
loss_pred:0.026355145499110222, decouple_loss:0.015146289020776749
The generated pressure mean: 0.44782647490501404
loss_pred:0.029270105063915253, decouple_loss:0.0158827006816864
The generated pressure mean: 0.44865885376930237
loss_pred:0.029477374628186226, decouple_loss:0.015406894497573376
Iteration: 872, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4474366009235382
loss_pred:0.02728140726685524, decouple_loss:0.016384728252887726
The generated pressure mean: 0.4475003480911255
loss_pred:0.02826758660376072, decouple_loss:0.016290657222270966
The generated pressure mean: 0.44523462653160095
loss_pred:0.027952080592513084, decouple_loss:0.016714755445718765
Iteration: 873, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4481533467769623
loss_pred:0.027438979595899582, decouple_loss:0.013811127282679081
The generated pressure mean: 0.4486105442047119The generated pressure mean: 0.4479070007801056
loss_pred:0.02726532518863678, decouple_loss:0.013848450966179371
loss_pred:0.027330374345183372, decouple_loss:0.013897977769374847
Iteration: 874, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4476628601551056
loss_pred:0.027239901944994926, decouple_loss:0.015546715818345547
The generated pressure mean: 0.44574248790740967
loss_pred:0.026190929114818573, decouple_loss:0.015423146076500416
The generated pressure mean: 0.44615447521209717
loss_pred:0.028286276385188103, decouple_loss:0.015414081513881683
Iteration: 875, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4462290108203888
The generated pressure mean: 0.44826430082321167
loss_pred:0.02833828702569008, decouple_loss:0.014358055777847767
loss_pred:0.02737356536090374, decouple_loss:0.014427459798753262
The generated pressure mean: 0.4478665292263031
loss_pred:0.027618803083896637, decouple_loss:0.014127708040177822
Iteration: 876, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44729161262512207
The generated pressure mean: 0.4470670819282532loss_pred:0.02792993374168873, decouple_loss:0.015180747024714947
loss_pred:0.02821231260895729, decouple_loss:0.01538289524614811
The generated pressure mean: 0.4472917318344116
loss_pred:0.02875283919274807, decouple_loss:0.015128890052437782
Iteration: 877, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4465906322002411
loss_pred:0.02908487245440483, decouple_loss:0.014672179706394672
The generated pressure mean: 0.4468749463558197
loss_pred:0.027064191177487373, decouple_loss:0.014520883560180664
The generated pressure mean: 0.4466207027435303
loss_pred:0.026896823197603226, decouple_loss:0.014288106933236122
Iteration: 878, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44879624247550964
loss_pred:0.028085744008421898, decouple_loss:0.013863256201148033
The generated pressure mean: 0.4481727182865143
loss_pred:0.03304341435432434, decouple_loss:0.0141857098788023
The generated pressure mean: 0.4467603266239166
loss_pred:0.02822081185877323, decouple_loss:0.01386276911944151
Iteration: 879, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44669008255004883
loss_pred:0.028728675097227097, decouple_loss:0.014447243884205818
The generated pressure mean: 0.44666460156440735
loss_pred:0.02854549139738083, decouple_loss:0.014008442871272564
The generated pressure mean: 0.44648075103759766
loss_pred:0.028497440740466118, decouple_loss:0.013853147625923157
Iteration: 880, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4472336173057556
loss_pred:0.02781209908425808, decouple_loss:0.014243663288652897
The generated pressure mean: 0.4481518566608429
loss_pred:0.02778909169137478, decouple_loss:0.014178547076880932
The generated pressure mean: 0.4472421705722809
loss_pred:0.02779420278966427, decouple_loss:0.014181103557348251
2023-04-16 04:36:12 testing...
The generated pressure mean: 0.4495830535888672
The generated pressure mean: 0.4497888684272766
The generated pressure mean: 0.44987666606903076
loss_pred:0.03682568669319153, decouple_loss:0.014769954606890678
loss_pred:0.036956787109375, decouple_loss:0.01477538701146841
loss_pred:0.03595385700464249, decouple_loss:0.014890390448272228
Loss: 0.0373193733394146, avg_mse: 0.04599228873848915
current test mse: 0.045992
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012016_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012016_3_24hr.npz
NaN value num: 0
Iteration: 881, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44680145382881165
loss_pred:0.02954787388443947, decouple_loss:0.014945908449590206
The generated pressure mean: 0.4471610486507416
loss_pred:0.029369501397013664, decouple_loss:0.015366257168352604
The generated pressure mean: 0.4484936594963074
loss_pred:0.029388094320893288, decouple_loss:0.014881636016070843
Iteration: 882, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4476337432861328
loss_pred:0.027922339737415314, decouple_loss:0.01379285380244255
The generated pressure mean: 0.4468691945075989
loss_pred:0.030297404155135155, decouple_loss:0.013454188592731953
The generated pressure mean: 0.4463586211204529
loss_pred:0.02846306376159191, decouple_loss:0.013308344408869743
Iteration: 883, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4492480754852295
loss_pred:0.02885020710527897, decouple_loss:0.01527362409979105The generated pressure mean: 0.44696342945098877
loss_pred:0.029299046844244003, decouple_loss:0.014656109735369682
The generated pressure mean: 0.44759416580200195
loss_pred:0.02888219989836216, decouple_loss:0.014909183606505394
Iteration: 884, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4464806616306305
loss_pred:0.03142782673239708, decouple_loss:0.013569245114922523
The generated pressure mean: 0.44755110144615173
loss_pred:0.0297216959297657, decouple_loss:0.013141846284270287
The generated pressure mean: 0.44655951857566833
loss_pred:0.028910737484693527, decouple_loss:0.01328342966735363
Iteration: 885, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4483056962490082
loss_pred:0.028869161382317543, decouple_loss:0.015363956801593304
The generated pressure mean: 0.4473802447319031
loss_pred:0.029698623344302177, decouple_loss:0.01530827023088932
The generated pressure mean: 0.4469279646873474
loss_pred:0.030652273446321487, decouple_loss:0.015334832482039928
Iteration: 886, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4466645419597626
The generated pressure mean: 0.4469086825847626
loss_pred:0.02805405482649803, decouple_loss:0.014531200751662254
loss_pred:0.028158048167824745, decouple_loss:0.014624604023993015
The generated pressure mean: 0.446621298789978
loss_pred:0.03120630420744419, decouple_loss:0.01448805257678032
Iteration: 887, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44689786434173584
loss_pred:0.028762686997652054, decouple_loss:0.015857744961977005
The generated pressure mean: 0.4469186067581177
loss_pred:0.0298478826880455, decouple_loss:0.015981502830982208
The generated pressure mean: 0.4466789960861206
loss_pred:0.029806097969412804, decouple_loss:0.016041506081819534
Iteration: 888, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.447238028049469
loss_pred:0.030561884865164757, decouple_loss:0.015226571820676327
The generated pressure mean: 0.4480094313621521
loss_pred:0.029591936618089676, decouple_loss:0.015370916575193405
The generated pressure mean: 0.44685888290405273
loss_pred:0.029269937425851822, decouple_loss:0.015497555956244469
Iteration: 889, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4463418126106262
loss_pred:0.028293373063206673, decouple_loss:0.014641822315752506
The generated pressure mean: 0.4477654695510864
loss_pred:0.02872435562312603, decouple_loss:0.01484083104878664
The generated pressure mean: 0.4466681480407715
loss_pred:0.028453737497329712, decouple_loss:0.014841518364846706
Iteration: 890, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44798144698143005
loss_pred:0.028599534183740616, decouple_loss:0.01520031038671732
The generated pressure mean: 0.4470483064651489
loss_pred:0.029159601777791977, decouple_loss:0.015482661314308643
The generated pressure mean: 0.4472801387310028
loss_pred:0.02891732193529606, decouple_loss:0.015397023409605026
2023-04-16 04:38:41 testing...
The generated pressure mean: 0.4497888684272766
The generated pressure mean: 0.4495830535888672
The generated pressure mean: 0.44987666606903076
loss_pred:0.03564414754509926, decouple_loss:0.014151330105960369
loss_pred:0.03481292352080345, decouple_loss:0.013992051593959332
loss_pred:0.034325841814279556, decouple_loss:0.013886306434869766
Loss: 0.03562813252210617, avg_mse: 0.0430944561958313
current test mse: 0.043094
Iteration: 891, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4464671313762665
loss_pred:0.027879400178790092, decouple_loss:0.014058470726013184
The generated pressure mean: 0.4475051462650299
loss_pred:0.028741002082824707, decouple_loss:0.013848748058080673
The generated pressure mean: 0.4469491243362427
loss_pred:0.02859429083764553, decouple_loss:0.014058120548725128
Iteration: 892, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4483170509338379
The generated pressure mean: 0.44748455286026
loss_pred:0.029508208855986595, decouple_loss:0.014584342017769814
loss_pred:0.029038887470960617, decouple_loss:0.014277101494371891
The generated pressure mean: 0.44801685214042664
loss_pred:0.02778533659875393, decouple_loss:0.014300105161964893
Iteration: 893, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44651758670806885
The generated pressure mean: 0.4476301968097687
loss_pred:0.02842365950345993, decouple_loss:0.014589441008865833
loss_pred:0.028688861057162285, decouple_loss:0.01428880263119936
The generated pressure mean: 0.44754254817962646
loss_pred:0.029353825375437737, decouple_loss:0.014385021291673183
Iteration: 894, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4473516047000885
The generated pressure mean: 0.44941359758377075
loss_pred:0.030064649879932404, decouple_loss:0.014123259112238884
loss_pred:0.028756532818078995, decouple_loss:0.014800389297306538
The generated pressure mean: 0.4481349587440491
loss_pred:0.029800957068800926, decouple_loss:0.014067113399505615
Iteration: 895, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44703513383865356
The generated pressure mean: 0.4466017484664917
loss_pred:0.02774006500840187, decouple_loss:0.015417222864925861
loss_pred:0.027739301323890686, decouple_loss:0.015709348022937775
The generated pressure mean: 0.44762569665908813
loss_pred:0.02979782409965992, decouple_loss:0.015231190249323845
Iteration: 896, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44824644923210144
The generated pressure mean: 0.44629180431365967
loss_pred:0.02876404859125614, decouple_loss:0.014059526845812798
loss_pred:0.030190447345376015, decouple_loss:0.014114121906459332
The generated pressure mean: 0.44851794838905334
loss_pred:0.028818873688578606, decouple_loss:0.0139187416061759
Iteration: 897, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44705289602279663
The generated pressure mean: 0.4475826025009155
loss_pred:0.029632387682795525, decouple_loss:0.014584830030798912
loss_pred:0.028850698843598366, decouple_loss:0.014632928185164928
The generated pressure mean: 0.44842371344566345
loss_pred:0.028061410412192345, decouple_loss:0.01423307228833437
Iteration: 898, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4477772116661072
The generated pressure mean: 0.4484513998031616
loss_pred:0.030023248866200447, decouple_loss:0.014766484498977661
loss_pred:0.029316965490579605, decouple_loss:0.014612262137234211
The generated pressure mean: 0.4486178457736969
loss_pred:0.02947501465678215, decouple_loss:0.014731768518686295
Iteration: 899, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44765305519104004
The generated pressure mean: 0.44772204756736755
loss_pred:0.029436400160193443, decouple_loss:0.015597782097756863
loss_pred:0.028218960389494896, decouple_loss:0.015596534125506878
The generated pressure mean: 0.44688501954078674
loss_pred:0.03048182651400566, decouple_loss:0.015272215940058231
Iteration: 900, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44960805773735046
loss_pred:0.027810988947749138, decouple_loss:0.015545347705483437
The generated pressure mean: 0.4468767046928406
loss_pred:0.028441017493605614, decouple_loss:0.01519762072712183
The generated pressure mean: 0.4490155279636383
loss_pred:0.028860092163085938, decouple_loss:0.015553953126072884
2023-04-16 04:40:35 testing...
The generated pressure mean: 0.4495830833911896
The generated pressure mean: 0.449788898229599
The generated pressure mean: 0.44987666606903076
loss_pred:0.03479619696736336, decouple_loss:0.01249717641621828
loss_pred:0.03603948652744293, decouple_loss:0.012764395214617252
loss_pred:0.03420035168528557, decouple_loss:0.012562244199216366
Loss: 0.035642411559820175, avg_mse: 0.043475743383169174
current test mse: 0.043476
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012009_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012009_3_24hr.npz
NaN value num: 0
Iteration: 901, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44856056571006775
loss_pred:0.028672849759459496, decouple_loss:0.012767313048243523
The generated pressure mean: 0.44927433133125305
loss_pred:0.028305595740675926, decouple_loss:0.01262832060456276
The generated pressure mean: 0.4480966031551361
loss_pred:0.028367528691887856, decouple_loss:0.01282506249845028
Iteration: 902, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45015114545822144
The generated pressure mean: 0.4490792155265808
loss_pred:0.028940029442310333, decouple_loss:0.014184503816068172
loss_pred:0.028949325904250145, decouple_loss:0.013815085403621197
The generated pressure mean: 0.4499039351940155
loss_pred:0.02942436933517456, decouple_loss:0.013888366520404816
Iteration: 903, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4484004080295563
loss_pred:0.02965575084090233, decouple_loss:0.015155138447880745
The generated pressure mean: 0.446489542722702
loss_pred:0.028205083683133125, decouple_loss:0.015460689552128315
The generated pressure mean: 0.44935813546180725
loss_pred:0.029202891513705254, decouple_loss:0.01582111418247223
Iteration: 904, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4472452700138092
loss_pred:0.028671707957983017, decouple_loss:0.014617843553423882
The generated pressure mean: 0.44884318113327026
loss_pred:0.027621356770396233, decouple_loss:0.014601693488657475
The generated pressure mean: 0.447726845741272
loss_pred:0.028771117329597473, decouple_loss:0.014694243669509888
Iteration: 905, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4487477242946625
The generated pressure mean: 0.44974711537361145
loss_pred:0.027793968096375465, decouple_loss:0.01334258820861578
loss_pred:0.029818283393979073, decouple_loss:0.012967538088560104
The generated pressure mean: 0.4493992328643799
loss_pred:0.02695656754076481, decouple_loss:0.013451815582811832
Iteration: 906, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44952392578125
The generated pressure mean: 0.44662222266197205
loss_pred:0.027868784964084625, decouple_loss:0.013588709756731987
loss_pred:0.027988893911242485, decouple_loss:0.013982478529214859
The generated pressure mean: 0.44796690344810486
loss_pred:0.029627954587340355, decouple_loss:0.013305052183568478
Iteration: 907, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44788658618927
The generated pressure mean: 0.4495813846588135
loss_pred:0.028468921780586243, decouple_loss:0.013851972296833992
loss_pred:0.02837342582643032, decouple_loss:0.014001595787703991
The generated pressure mean: 0.44869935512542725
loss_pred:0.028029505163431168, decouple_loss:0.013837448321282864
Iteration: 908, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4502018094062805
The generated pressure mean: 0.4491191506385803
loss_pred:0.028517629951238632, decouple_loss:0.016893796622753143
loss_pred:0.029056105762720108, decouple_loss:0.01660049892961979
The generated pressure mean: 0.44979003071784973
loss_pred:0.029339930042624474, decouple_loss:0.016920408234000206
Iteration: 909, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44888007640838623
The generated pressure mean: 0.44882893562316895
loss_pred:0.027332337573170662, decouple_loss:0.0159238800406456
loss_pred:0.028200741857290268, decouple_loss:0.01618674024939537
The generated pressure mean: 0.4483877718448639
loss_pred:0.02901291847229004, decouple_loss:0.01619822345674038
Iteration: 910, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4504079818725586
The generated pressure mean: 0.4478687345981598
loss_pred:0.027941981330513954, decouple_loss:0.014035467989742756
loss_pred:0.02947268635034561, decouple_loss:0.014036599546670914
The generated pressure mean: 0.4481106400489807
loss_pred:0.030377348884940147, decouple_loss:0.014117985963821411
2023-04-16 04:43:02 testing...
The generated pressure mean: 0.4497888684272766
The generated pressure mean: 0.4495830833911896
The generated pressure mean: 0.44987666606903076
loss_pred:0.03578205034136772, decouple_loss:0.015148448757827282
loss_pred:0.03495229408144951, decouple_loss:0.014804812148213387
loss_pred:0.03414538502693176, decouple_loss:0.01498954277485609
Loss: 0.0357089564204216, avg_mse: 0.04302534833550453
current test mse: 0.043025
Iteration: 911, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44854825735092163
loss_pred:0.029284240677952766, decouple_loss:0.015273901633918285
The generated pressure mean: 0.4487565755844116
loss_pred:0.02918485552072525, decouple_loss:0.015141131356358528
The generated pressure mean: 0.4491323232650757
loss_pred:0.029856182634830475, decouple_loss:0.014969880692660809
Iteration: 912, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4484816789627075
loss_pred:0.029675796627998352, decouple_loss:0.014911099337041378
The generated pressure mean: 0.4492068290710449
loss_pred:0.03041001781821251, decouple_loss:0.01469300128519535
The generated pressure mean: 0.44897758960723877
loss_pred:0.028543781489133835, decouple_loss:0.014786375686526299
Iteration: 913, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4493604004383087
loss_pred:0.028681615367531776, decouple_loss:0.015521406196057796
The generated pressure mean: 0.4473860263824463
loss_pred:0.029174575582146645, decouple_loss:0.01575942151248455
The generated pressure mean: 0.44772836565971375
loss_pred:0.02817978337407112, decouple_loss:0.015748264268040657
Iteration: 914, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4475764334201813
loss_pred:0.02783474326133728, decouple_loss:0.014940916560590267
The generated pressure mean: 0.4501529335975647
loss_pred:0.028521237894892693, decouple_loss:0.014819731935858727
The generated pressure mean: 0.44850537180900574
loss_pred:0.027773553505539894, decouple_loss:0.014847599901258945
Iteration: 915, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44916269183158875
loss_pred:0.02890321984887123, decouple_loss:0.016495339572429657
The generated pressure mean: 0.44852960109710693
loss_pred:0.030016129836440086, decouple_loss:0.016728727146983147
The generated pressure mean: 0.44910913705825806
loss_pred:0.02921190671622753, decouple_loss:0.01656949892640114
Iteration: 916, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4481542408466339
loss_pred:0.027975862845778465, decouple_loss:0.014100495725870132
The generated pressure mean: 0.4493882358074188
loss_pred:0.028833085671067238, decouple_loss:0.01357180718332529
The generated pressure mean: 0.4494730532169342
loss_pred:0.027515720576047897, decouple_loss:0.01381300576031208
Iteration: 917, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44880861043930054
loss_pred:0.02925082854926586, decouple_loss:0.01573844812810421
The generated pressure mean: 0.44813576340675354
loss_pred:0.028109293431043625, decouple_loss:0.016090549528598785
The generated pressure mean: 0.4481092393398285
loss_pred:0.028567126020789146, decouple_loss:0.01555451937019825
Iteration: 918, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4476395547389984
loss_pred:0.027754859998822212, decouple_loss:0.013963809236884117
The generated pressure mean: 0.44998177886009216
loss_pred:0.027432875707745552, decouple_loss:0.01374205481261015
The generated pressure mean: 0.4486571252346039
loss_pred:0.02946491166949272, decouple_loss:0.013820254243910313
Iteration: 919, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44901958107948303
loss_pred:0.0285799540579319, decouple_loss:0.015885356813669205
The generated pressure mean: 0.448865681886673
loss_pred:0.02815960720181465, decouple_loss:0.016185563057661057
The generated pressure mean: 0.44981876015663147
loss_pred:0.028064174577593803, decouple_loss:0.01538687665015459
Iteration: 920, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4484628736972809
loss_pred:0.027567680925130844, decouple_loss:0.013377468101680279
The generated pressure mean: 0.44789427518844604
loss_pred:0.028343774378299713, decouple_loss:0.013371403329074383
The generated pressure mean: 0.4494432210922241
loss_pred:0.0310317762196064, decouple_loss:0.013293309137225151
2023-04-16 04:44:57 testing...
The generated pressure mean: 0.4497888684272766
The generated pressure mean: 0.4495830833911896
The generated pressure mean: 0.44987666606903076
loss_pred:0.035080477595329285, decouple_loss:0.01325715146958828
loss_pred:0.03415074944496155, decouple_loss:0.013242337852716446
loss_pred:0.03318152576684952, decouple_loss:0.013242878019809723
Loss: 0.034799959510564804, avg_mse: 0.0419139564037323
current test mse: 0.041914
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012008_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012008_3_24hr.npz
NaN value num: 0
Iteration: 921, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44681304693222046
loss_pred:0.02898482047021389, decouple_loss:0.013728266581892967
The generated pressure mean: 0.44599658250808716
loss_pred:0.029561253264546394, decouple_loss:0.013800217770040035
The generated pressure mean: 0.44756370782852173
loss_pred:0.027216149494051933, decouple_loss:0.013265025801956654
Iteration: 922, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44634103775024414
The generated pressure mean: 0.4461234509944916
loss_pred:0.028262348845601082, decouple_loss:0.014338401146233082
loss_pred:0.02818850614130497, decouple_loss:0.014032234437763691
The generated pressure mean: 0.44758808612823486
loss_pred:0.02662280946969986, decouple_loss:0.014191845431923866
Iteration: 923, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44694983959198
loss_pred:0.029455598443746567, decouple_loss:0.013368085958063602
The generated pressure mean: 0.44651535153388977
loss_pred:0.027529975399374962, decouple_loss:0.01372163463383913
The generated pressure mean: 0.44705235958099365
loss_pred:0.026860591024160385, decouple_loss:0.013534178026020527
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 924, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44794607162475586
loss_pred:0.027901992201805115, decouple_loss:0.015549846924841404
The generated pressure mean: 0.4460991322994232
loss_pred:0.027844445779919624, decouple_loss:0.015494006685912609
The generated pressure mean: 0.44682130217552185
loss_pred:0.027381304651498795, decouple_loss:0.015428408049046993
Iteration: 925, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4463662803173065
loss_pred:0.029597647488117218, decouple_loss:0.01410792674869299
The generated pressure mean: 0.4453771114349365
loss_pred:0.02842007763683796, decouple_loss:0.014295426197350025
The generated pressure mean: 0.4468805491924286
loss_pred:0.027694080024957657, decouple_loss:0.014183021150529385
Iteration: 926, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44678202271461487
loss_pred:0.030217021703720093, decouple_loss:0.013790304772555828
The generated pressure mean: 0.4452042877674103
loss_pred:0.028922369703650475, decouple_loss:0.013852139003574848
The generated pressure mean: 0.4465196132659912
loss_pred:0.02750340849161148, decouple_loss:0.01369416806846857
Iteration: 927, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4466235339641571
loss_pred:0.02822447381913662, decouple_loss:0.01333408709615469
The generated pressure mean: 0.44674137234687805
loss_pred:0.02713940292596817, decouple_loss:0.013331982307136059
The generated pressure mean: 0.4466868042945862
loss_pred:0.027095885947346687, decouple_loss:0.013494757004082203
Iteration: 928, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44657978415489197
loss_pred:0.026660703122615814, decouple_loss:0.013450860977172852
The generated pressure mean: 0.44712936878204346
loss_pred:0.02854197658598423, decouple_loss:0.013729178346693516
The generated pressure mean: 0.44632676243782043
loss_pred:0.028492214158177376, decouple_loss:0.01369258388876915
Iteration: 929, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.446067214012146
loss_pred:0.026309143751859665, decouple_loss:0.014112193137407303
The generated pressure mean: 0.44759318232536316
loss_pred:0.026624809950590134, decouple_loss:0.014081550762057304
The generated pressure mean: 0.44656574726104736
loss_pred:0.028493599966168404, decouple_loss:0.014257727190852165
Iteration: 930, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44610628485679626
loss_pred:0.02764004096388817, decouple_loss:0.014730324037373066
The generated pressure mean: 0.4468380808830261
loss_pred:0.027326131239533424, decouple_loss:0.014868437312543392
The generated pressure mean: 0.44680383801460266
loss_pred:0.027531828731298447, decouple_loss:0.014527765102684498
2023-04-16 04:47:25 testing...
The generated pressure mean: 0.4495830535888672
The generated pressure mean: 0.4497888684272766
The generated pressure mean: 0.44987666606903076
loss_pred:0.03427360579371452, decouple_loss:0.013439974747598171
loss_pred:0.035227395594120026, decouple_loss:0.013476206921041012
loss_pred:0.03370816633105278, decouple_loss:0.013507219962775707
Loss: 0.03507678210735321, avg_mse: 0.042684294283390045
current test mse: 0.042684
Iteration: 931, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44700536131858826
loss_pred:0.027253495529294014, decouple_loss:0.01314059179276228
The generated pressure mean: 0.4466697573661804
loss_pred:0.0272388756275177, decouple_loss:0.013125592842698097
The generated pressure mean: 0.44698432087898254
loss_pred:0.026784546673297882, decouple_loss:0.013090147636830807
Iteration: 932, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44517549872398376
loss_pred:0.02660827524960041, decouple_loss:0.01266249269247055
The generated pressure mean: 0.4472448229789734
loss_pred:0.0277798343449831, decouple_loss:0.012664771638810635
The generated pressure mean: 0.446666419506073
loss_pred:0.026620259508490562, decouple_loss:0.012716543860733509
Iteration: 933, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44701677560806274
loss_pred:0.02753218449652195, decouple_loss:0.01334163174033165
The generated pressure mean: 0.4477007985115051
loss_pred:0.02718270942568779, decouple_loss:0.013423353433609009
The generated pressure mean: 0.4484494626522064
loss_pred:0.026957755908370018, decouple_loss:0.013403359800577164
Iteration: 934, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4469769299030304
loss_pred:0.026773272082209587, decouple_loss:0.013395731337368488
The generated pressure mean: 0.4467865228652954
loss_pred:0.0265331007540226, decouple_loss:0.01327701285481453
The generated pressure mean: 0.44734692573547363
loss_pred:0.026841627433896065, decouple_loss:0.013282163999974728
Iteration: 935, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44605761766433716
loss_pred:0.02832084707915783, decouple_loss:0.013382320292294025
The generated pressure mean: 0.4463392496109009
loss_pred:0.02954542450606823, decouple_loss:0.013461467809975147
The generated pressure mean: 0.4472530484199524
loss_pred:0.029054585844278336, decouple_loss:0.013353423215448856
Iteration: 936, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4456709921360016
loss_pred:0.026896722614765167, decouple_loss:0.013685577549040318
The generated pressure mean: 0.44680145382881165
loss_pred:0.0273146815598011, decouple_loss:0.01386953517794609
The generated pressure mean: 0.44611552357673645
loss_pred:0.02704673446714878, decouple_loss:0.013781684450805187
Iteration: 937, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44643330574035645
loss_pred:0.028273560106754303, decouple_loss:0.013101042248308659
The generated pressure mean: 0.4468703269958496
The generated pressure mean: 0.4470561742782593
loss_pred:0.028207285329699516, decouple_loss:0.013359097763895988
loss_pred:0.026480436325073242, decouple_loss:0.013227086514234543
Iteration: 938, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44530776143074036
loss_pred:0.026966549456119537, decouple_loss:0.01309930719435215
The generated pressure mean: 0.4477647840976715
loss_pred:0.02688167802989483, decouple_loss:0.013262235559523106
The generated pressure mean: 0.44679540395736694
loss_pred:0.027025064453482628, decouple_loss:0.012887411750853062
Iteration: 939, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44715139269828796
loss_pred:0.02913666144013405, decouple_loss:0.01231576967984438
The generated pressure mean: 0.44740480184555054
loss_pred:0.026663755998015404, decouple_loss:0.012250781059265137
The generated pressure mean: 0.4467034637928009
loss_pred:0.027400700375437737, decouple_loss:0.012226271443068981
Iteration: 940, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4466151297092438
loss_pred:0.02709081396460533, decouple_loss:0.012336279265582561
The generated pressure mean: 0.4465217888355255
loss_pred:0.02640610560774803, decouple_loss:0.012227087281644344
The generated pressure mean: 0.44671717286109924
loss_pred:0.028269853442907333, decouple_loss:0.012489491142332554
2023-04-16 04:49:20 testing...
The generated pressure mean: 0.4495830833911896
The generated pressure mean: 0.4497888684272766
The generated pressure mean: 0.44987666606903076
loss_pred:0.034681662917137146, decouple_loss:0.012289080768823624
loss_pred:0.03525420278310776, decouple_loss:0.012248432263731956
loss_pred:0.033995795994997025, decouple_loss:0.012336540035903454
Loss: 0.0352584533393383, avg_mse: 0.04336521774530411
current test mse: 0.043365
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012005_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012005_3_24hr.npz
NaN value num: 0
Iteration: 941, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45011699199676514
loss_pred:0.028351133689284325, decouple_loss:0.012977026402950287
The generated pressure mean: 0.4502202570438385
loss_pred:0.027789225801825523, decouple_loss:0.012567050755023956
The generated pressure mean: 0.4472403824329376
loss_pred:0.026263101026415825, decouple_loss:0.012364805676043034
Iteration: 942, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.448871374130249
loss_pred:0.027408404275774956, decouple_loss:0.012356867082417011
The generated pressure mean: 0.4494202733039856
loss_pred:0.027182292193174362, decouple_loss:0.012563099153339863
The generated pressure mean: 0.44941654801368713
loss_pred:0.026298075914382935, decouple_loss:0.012944260612130165
Iteration: 943, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44891074299812317
loss_pred:0.026680605486035347, decouple_loss:0.014179952442646027
The generated pressure mean: 0.4472036063671112
loss_pred:0.02659711427986622, decouple_loss:0.013883373700082302
The generated pressure mean: 0.4490104019641876
loss_pred:0.02936967834830284, decouple_loss:0.01443034503608942
Iteration: 944, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4494454860687256
loss_pred:0.0283936969935894, decouple_loss:0.013355201110243797
The generated pressure mean: 0.4484518766403198
loss_pred:0.026679879054427147, decouple_loss:0.013690540567040443
The generated pressure mean: 0.4498547315597534
loss_pred:0.02576051652431488, decouple_loss:0.013425532728433609
Iteration: 945, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.449152410030365The generated pressure mean: 0.4489338994026184
loss_pred:0.027101431041955948, decouple_loss:0.012928241863846779loss_pred:0.02833111584186554, decouple_loss:0.012914649210870266
The generated pressure mean: 0.45058080554008484
loss_pred:0.02610212378203869, decouple_loss:0.013153907842934132
Iteration: 946, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4500133991241455
loss_pred:0.025541936978697777, decouple_loss:0.012829946354031563
The generated pressure mean: 0.4499109387397766
loss_pred:0.0253309216350317, decouple_loss:0.012944439426064491
The generated pressure mean: 0.4494057595729828
loss_pred:0.02742030844092369, decouple_loss:0.012802937999367714
Iteration: 947, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44825121760368347
loss_pred:0.027241306379437447, decouple_loss:0.012101352214813232
The generated pressure mean: 0.4493323266506195
loss_pred:0.02715834230184555, decouple_loss:0.0122159942984581
The generated pressure mean: 0.45028233528137207
loss_pred:0.026360681280493736, decouple_loss:0.012116285040974617
Iteration: 948, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44959110021591187
loss_pred:0.02612820267677307, decouple_loss:0.014871817082166672
The generated pressure mean: 0.4490760564804077
loss_pred:0.02750820480287075, decouple_loss:0.014760681428015232
The generated pressure mean: 0.44841182231903076
loss_pred:0.02693844586610794, decouple_loss:0.01485341228544712
Iteration: 949, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4496532380580902
loss_pred:0.02698756754398346, decouple_loss:0.014713441953063011
The generated pressure mean: 0.44892197847366333
loss_pred:0.02815111353993416, decouple_loss:0.014496506191790104
The generated pressure mean: 0.4502854347229004
loss_pred:0.026474395766854286, decouple_loss:0.014886102639138699
Iteration: 950, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45020556449890137
loss_pred:0.026530001312494278, decouple_loss:0.012584866024553776
The generated pressure mean: 0.4499286413192749
loss_pred:0.02584298513829708, decouple_loss:0.012465538457036018
The generated pressure mean: 0.45044639706611633
loss_pred:0.026286190375685692, decouple_loss:0.012754980474710464
2023-04-16 04:51:50 testing...
The generated pressure mean: 0.4495830535888672
The generated pressure mean: 0.449788898229599
The generated pressure mean: 0.44987666606903076
loss_pred:0.03360076621174812, decouple_loss:0.011658672243356705
loss_pred:0.0341000109910965, decouple_loss:0.011782902292907238
loss_pred:0.03290270268917084, decouple_loss:0.01166712399572134
Loss: 0.034119635820388794, avg_mse: 0.04144660383462906
current test mse: 0.041447
Iteration: 951, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4505947232246399
loss_pred:0.027365105226635933, decouple_loss:0.011832701042294502
The generated pressure mean: 0.450771301984787
loss_pred:0.027124186977744102, decouple_loss:0.011972194537520409
The generated pressure mean: 0.44969743490219116
loss_pred:0.02480774000287056, decouple_loss:0.011885353364050388
Iteration: 952, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.448622465133667
loss_pred:0.02762153558433056, decouple_loss:0.014645830728113651
The generated pressure mean: 0.4502430558204651
The generated pressure mean: 0.4490027129650116
loss_pred:0.026544777676463127, decouple_loss:0.014753051102161407
loss_pred:0.02638905495405197, decouple_loss:0.014645259827375412
Iteration: 953, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4475288987159729
loss_pred:0.02644207514822483, decouple_loss:0.013566899113357067
The generated pressure mean: 0.4505392014980316
loss_pred:0.026018161326646805, decouple_loss:0.01353403925895691
The generated pressure mean: 0.4492276608943939
loss_pred:0.026012269780039787, decouple_loss:0.013429675251245499
Iteration: 954, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4483104348182678
loss_pred:0.027498161420226097, decouple_loss:0.012879723682999611
The generated pressure mean: 0.44836828112602234
The generated pressure mean: 0.4504186511039734
loss_pred:0.027041537687182426, decouple_loss:0.013024548999965191
loss_pred:0.025765664875507355, decouple_loss:0.013325769454240799
Iteration: 955, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4487534761428833
loss_pred:0.026007240638136864, decouple_loss:0.012053565122187138
The generated pressure mean: 0.45016369223594666
The generated pressure mean: 0.4504387676715851
loss_pred:0.024976108223199844, decouple_loss:0.012341651134192944
loss_pred:0.026785381138324738, decouple_loss:0.012445860542356968
Iteration: 956, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45034259557724
loss_pred:0.02528359368443489, decouple_loss:0.013869410380721092
The generated pressure mean: 0.4490041136741638
The generated pressure mean: 0.44795694947242737
loss_pred:0.027146607637405396, decouple_loss:0.01411083247512579
loss_pred:0.026201767846941948, decouple_loss:0.013912451453506947
Iteration: 957, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4495620131492615
loss_pred:0.0268296767026186, decouple_loss:0.01581696979701519
The generated pressure mean: 0.44951102137565613
The generated pressure mean: 0.4496975243091583
loss_pred:0.02669963240623474, decouple_loss:0.015515170991420746
loss_pred:0.025966664776206017, decouple_loss:0.015793390572071075
Iteration: 958, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4494415521621704
loss_pred:0.02622956410050392, decouple_loss:0.014328008517622948
The generated pressure mean: 0.44905534386634827
loss_pred:0.026801250874996185, decouple_loss:0.014987020753324032
The generated pressure mean: 0.44910547137260437
loss_pred:0.027857940644025803, decouple_loss:0.015026985667645931
Iteration: 959, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4475174844264984
loss_pred:0.026572750881314278, decouple_loss:0.013160097412765026
The generated pressure mean: 0.44931894540786743
loss_pred:0.0263059139251709, decouple_loss:0.013441364280879498
The generated pressure mean: 0.4478796720504761
loss_pred:0.02850554697215557, decouple_loss:0.013479823246598244
Iteration: 960, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4477369487285614
loss_pred:0.026466844603419304, decouple_loss:0.012259043753147125
The generated pressure mean: 0.4500689208507538
The generated pressure mean: 0.4487708508968353
loss_pred:0.025554334744811058, decouple_loss:0.01272657047957182
loss_pred:0.02842143550515175, decouple_loss:0.012387009337544441
2023-04-16 04:53:43 testing...
The generated pressure mean: 0.4495830535888672
The generated pressure mean: 0.449788898229599
The generated pressure mean: 0.44987666606903076
loss_pred:0.03366668522357941, decouple_loss:0.012283951044082642
loss_pred:0.03449847176671028, decouple_loss:0.012492419220507145
loss_pred:0.03293486312031746, decouple_loss:0.012355254963040352
Loss: 0.03431886434555054, avg_mse: 0.04164975881576538
current test mse: 0.04165
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012010_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012010_3_24hr.npz
NaN value num: 0
Iteration: 961, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4489342272281647
loss_pred:0.02776746265590191, decouple_loss:0.012727921828627586
The generated pressure mean: 0.44741079211235046
loss_pred:0.029075633734464645, decouple_loss:0.012476136907935143
The generated pressure mean: 0.447221040725708
loss_pred:0.028020944446325302, decouple_loss:0.01250465214252472
Iteration: 962, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44782304763793945
loss_pred:0.02746855653822422, decouple_loss:0.012839464470744133
The generated pressure mean: 0.4479628801345825
loss_pred:0.025810012593865395, decouple_loss:0.012837839312851429
The generated pressure mean: 0.446898490190506
loss_pred:0.028589488938450813, decouple_loss:0.013324880041182041
Iteration: 963, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.447517991065979
loss_pred:0.025648189708590508, decouple_loss:0.013583090156316757
The generated pressure mean: 0.44917985796928406
loss_pred:0.02735752798616886, decouple_loss:0.01389820221811533
The generated pressure mean: 0.4480065703392029
loss_pred:0.02727462351322174, decouple_loss:0.013745143078267574
Iteration: 964, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4480394124984741
The generated pressure mean: 0.4481261670589447
loss_pred:0.025756878778338432, decouple_loss:0.01321551576256752
loss_pred:0.026451831683516502, decouple_loss:0.013195197097957134
The generated pressure mean: 0.4464516043663025
loss_pred:0.028455277904868126, decouple_loss:0.013066108338534832
Iteration: 965, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4467315375804901
loss_pred:0.027748282998800278, decouple_loss:0.013049101456999779
The generated pressure mean: 0.44812214374542236
The generated pressure mean: 0.44818034768104553
loss_pred:0.026990802958607674, decouple_loss:0.013134707696735859
loss_pred:0.027454888448119164, decouple_loss:0.013098652474582195
Iteration: 966, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44782400131225586
The generated pressure mean: 0.44832539558410645
loss_pred:0.026541702449321747, decouple_loss:0.012468094006180763
loss_pred:0.02707076445221901, decouple_loss:0.01207885891199112
The generated pressure mean: 0.44812914729118347
loss_pred:0.02813001535832882, decouple_loss:0.012190205976366997
Iteration: 967, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4478238523006439
loss_pred:0.028138374909758568, decouple_loss:0.013656595721840858
The generated pressure mean: 0.447181761264801
loss_pred:0.03008582815527916, decouple_loss:0.013394721783697605
The generated pressure mean: 0.4465717077255249
loss_pred:0.027274589985609055, decouple_loss:0.01356858853250742
Iteration: 968, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44710662961006165
The generated pressure mean: 0.4486684501171112
loss_pred:0.028374943882226944, decouple_loss:0.013685996644198895
loss_pred:0.028010282665491104, decouple_loss:0.013667485676705837
The generated pressure mean: 0.44752365350723267
loss_pred:0.028643501922488213, decouple_loss:0.013687411323189735
Iteration: 969, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4479084014892578
The generated pressure mean: 0.4480511248111725
loss_pred:0.027879497036337852, decouple_loss:0.016266437247395515
loss_pred:0.0277481097728014, decouple_loss:0.016513170674443245
The generated pressure mean: 0.4476369321346283
loss_pred:0.027762634679675102, decouple_loss:0.016420412808656693
Iteration: 970, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4484303295612335
The generated pressure mean: 0.4472768306732178loss_pred:0.02686709724366665, decouple_loss:0.013457278721034527
loss_pred:0.028885148465633392, decouple_loss:0.013652297668159008
The generated pressure mean: 0.44760164618492126
loss_pred:0.029788456857204437, decouple_loss:0.013178977183997631
2023-04-16 04:56:10 testing...
The generated pressure mean: 0.4495830535888672
The generated pressure mean: 0.449788898229599
The generated pressure mean: 0.44987666606903076
loss_pred:0.03446584194898605, decouple_loss:0.01496315747499466
loss_pred:0.03559179604053497, decouple_loss:0.014895801432430744
loss_pred:0.03424728661775589, decouple_loss:0.014911376871168613
Loss: 0.035514481365680695, avg_mse: 0.04375343769788742
current test mse: 0.043753
Iteration: 971, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4472044110298157
The generated pressure mean: 0.44752150774002075
loss_pred:0.02950122207403183, decouple_loss:0.01499041449278593
loss_pred:0.028232334181666374, decouple_loss:0.014678710140287876
The generated pressure mean: 0.4488455653190613
loss_pred:0.026789013296365738, decouple_loss:0.014855479821562767
Iteration: 972, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4469423294067383
loss_pred:0.027932003140449524, decouple_loss:0.012856969609856606
The generated pressure mean: 0.4477773904800415
loss_pred:0.028689369559288025, decouple_loss:0.01266784593462944
The generated pressure mean: 0.44689860939979553
loss_pred:0.027827823534607887, decouple_loss:0.012869000434875488
Iteration: 973, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4477587044239044
loss_pred:0.027086663991212845, decouple_loss:0.012803885154426098
The generated pressure mean: 0.448211133480072
loss_pred:0.02565099485218525, decouple_loss:0.013277570717036724
The generated pressure mean: 0.44735005497932434
loss_pred:0.027041180059313774, decouple_loss:0.01269583497196436
Iteration: 974, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44848939776420593
loss_pred:0.02675069496035576, decouple_loss:0.012655619531869888
The generated pressure mean: 0.446647047996521
The generated pressure mean: 0.4482623338699341
loss_pred:0.02856595069169998, decouple_loss:0.01264139823615551
loss_pred:0.028516720980405807, decouple_loss:0.012603865936398506
Iteration: 975, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4477115571498871
loss_pred:0.027722487226128578, decouple_loss:0.013055700808763504
The generated pressure mean: 0.4484916031360626
loss_pred:0.02748248167335987, decouple_loss:0.012827242724597454
The generated pressure mean: 0.4472287595272064
loss_pred:0.027933716773986816, decouple_loss:0.012986256740987301
Iteration: 976, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44711413979530334
loss_pred:0.026334397494792938, decouple_loss:0.012073984369635582
The generated pressure mean: 0.44722360372543335
The generated pressure mean: 0.4472237229347229
loss_pred:0.02615705132484436, decouple_loss:0.012122915126383305
loss_pred:0.025711679831147194, decouple_loss:0.012201407924294472
Iteration: 977, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4473575949668884The generated pressure mean: 0.4480860233306885
The generated pressure mean: 0.44715961813926697
loss_pred:0.026502462103962898, decouple_loss:0.013013388030230999
loss_pred:0.02656775899231434, decouple_loss:0.013509838841855526
loss_pred:0.027400316670536995, decouple_loss:0.013279291801154613
Iteration: 978, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44840559363365173
loss_pred:0.027741219848394394, decouple_loss:0.012613296508789062
The generated pressure mean: 0.4485773742198944
The generated pressure mean: 0.4468585252761841
loss_pred:0.02567022293806076, decouple_loss:0.012476623058319092
loss_pred:0.02641909010708332, decouple_loss:0.012630569748580456
Iteration: 979, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44746920466423035
loss_pred:0.028496028855443, decouple_loss:0.01347178965806961
The generated pressure mean: 0.4469960927963257The generated pressure mean: 0.4487683176994324
loss_pred:0.027443818747997284, decouple_loss:0.013271486386656761loss_pred:0.026027683168649673, decouple_loss:0.013374860398471355
Iteration: 980, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.447144091129303
loss_pred:0.02679106406867504, decouple_loss:0.01258569024503231
The generated pressure mean: 0.4466698467731476
The generated pressure mean: 0.447172075510025
loss_pred:0.027888160198926926, decouple_loss:0.012547490186989307
loss_pred:0.027939461171627045, decouple_loss:0.012840790674090385
2023-04-16 04:58:04 testing...
The generated pressure mean: 0.4495830535888672
The generated pressure mean: 0.4497888684272766
The generated pressure mean: 0.44987666606903076
loss_pred:0.033624317497015, decouple_loss:0.011551570147275925
loss_pred:0.03444027155637741, decouple_loss:0.01157900970429182
loss_pred:0.032676536589860916, decouple_loss:0.011595449410378933
Loss: 0.03415914252400398, avg_mse: 0.04172134771943092
current test mse: 0.041721
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012011_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012011_3_24hr.npz
NaN value num: 0
Iteration: 981, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4480065703392029
loss_pred:0.02872883714735508, decouple_loss:0.012289063073694706
The generated pressure mean: 0.4473292827606201The generated pressure mean: 0.4467124044895172
loss_pred:0.027275335043668747, decouple_loss:0.011530344374477863
loss_pred:0.027961865067481995, decouple_loss:0.011550381779670715
Iteration: 982, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44662079215049744
loss_pred:0.02678094059228897, decouple_loss:0.011795721016824245
The generated pressure mean: 0.44525763392448425
loss_pred:0.026319604367017746, decouple_loss:0.011778298765420914
The generated pressure mean: 0.44810667634010315
loss_pred:0.028240667656064034, decouple_loss:0.01235546451061964
Iteration: 983, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4459937512874603
The generated pressure mean: 0.44667911529541016
loss_pred:0.02925746887922287, decouple_loss:0.012751853093504906
loss_pred:0.026990856975317, decouple_loss:0.012306060642004013
The generated pressure mean: 0.44632503390312195
loss_pred:0.026644287630915642, decouple_loss:0.012664231471717358
Iteration: 984, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44859594106674194
The generated pressure mean: 0.44734594225883484
loss_pred:0.02875574678182602, decouple_loss:0.014240202493965626
loss_pred:0.02753150649368763, decouple_loss:0.013770724646747112
The generated pressure mean: 0.4468235969543457
loss_pred:0.025761684402823448, decouple_loss:0.013439553789794445
Iteration: 985, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4474453032016754
The generated pressure mean: 0.4452894926071167
loss_pred:0.02875920757651329, decouple_loss:0.014499594457447529
loss_pred:0.026807425543665886, decouple_loss:0.014415580779314041
The generated pressure mean: 0.4456849694252014
loss_pred:0.027107343077659607, decouple_loss:0.014537328854203224
Iteration: 986, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4468763768672943
The generated pressure mean: 0.44646894931793213
loss_pred:0.026883795857429504, decouple_loss:0.012805243022739887
loss_pred:0.026723122224211693, decouple_loss:0.012767715379595757
The generated pressure mean: 0.44664016366004944
loss_pred:0.027501555159687996, decouple_loss:0.012785009108483791
Iteration: 987, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4466908872127533
The generated pressure mean: 0.44820308685302734
loss_pred:0.02675316110253334, decouple_loss:0.014542770572006702
loss_pred:0.026414889842271805, decouple_loss:0.014795901253819466
The generated pressure mean: 0.4478110373020172
loss_pred:0.026723911985754967, decouple_loss:0.014810515567660332
Iteration: 988, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4464486539363861
The generated pressure mean: 0.44625359773635864
loss_pred:0.02653602883219719, decouple_loss:0.014552737586200237
loss_pred:0.02626633644104004, decouple_loss:0.014366536401212215
The generated pressure mean: 0.44620752334594727
loss_pred:0.028313003480434418, decouple_loss:0.014418049715459347
Iteration: 989, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44751569628715515
The generated pressure mean: 0.44582533836364746
loss_pred:0.025964589789509773, decouple_loss:0.013157782144844532
loss_pred:0.02629115991294384, decouple_loss:0.01311750803142786
The generated pressure mean: 0.44883668422698975
loss_pred:0.027420131489634514, decouple_loss:0.012951967306435108
Iteration: 990, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44817230105400085
The generated pressure mean: 0.4461468756198883
loss_pred:0.027393599972128868, decouple_loss:0.013208008371293545
loss_pred:0.02827567420899868, decouple_loss:0.013035132549703121
The generated pressure mean: 0.44746020436286926
loss_pred:0.026497332379221916, decouple_loss:0.013184054754674435
2023-04-16 05:00:33 testing...
The generated pressure mean: 0.449788898229599
The generated pressure mean: 0.4495830535888672
The generated pressure mean: 0.44987666606903076
loss_pred:0.034806929528713226, decouple_loss:0.014288029633462429
loss_pred:0.033683136105537415, decouple_loss:0.014452752657234669
loss_pred:0.033611759543418884, decouple_loss:0.014426217414438725
Loss: 0.03475339338183403, avg_mse: 0.04268538951873779
current test mse: 0.042685
Iteration: 991, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44582653045654297
The generated pressure mean: 0.4459315240383148
loss_pred:0.028369078412652016, decouple_loss:0.014611638151109219
loss_pred:0.029112566262483597, decouple_loss:0.014244908466935158
The generated pressure mean: 0.44627127051353455
loss_pred:0.027287974953651428, decouple_loss:0.014388972893357277
Iteration: 992, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44677528738975525
The generated pressure mean: 0.4474707841873169loss_pred:0.02674374170601368, decouple_loss:0.012550558894872665
loss_pred:0.02629893086850643, decouple_loss:0.012727892026305199
The generated pressure mean: 0.44760069251060486
loss_pred:0.026674427092075348, decouple_loss:0.012730240821838379
Iteration: 993, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44647493958473206
loss_pred:0.025742216035723686, decouple_loss:0.012914663180708885
The generated pressure mean: 0.4473477303981781
loss_pred:0.02707376517355442, decouple_loss:0.012739055790007114
The generated pressure mean: 0.4479667842388153
loss_pred:0.026684727519750595, decouple_loss:0.012826432473957539
Iteration: 994, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4472138285636902
loss_pred:0.027185143902897835, decouple_loss:0.01406601071357727
The generated pressure mean: 0.4462599456310272
loss_pred:0.026978055015206337, decouple_loss:0.014085084199905396
The generated pressure mean: 0.44691959023475647
loss_pred:0.025973057374358177, decouple_loss:0.013954633846879005
Iteration: 995, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4481782019138336
loss_pred:0.026999427005648613, decouple_loss:0.013206359930336475
The generated pressure mean: 0.44710493087768555
loss_pred:0.02730424702167511, decouple_loss:0.013290970586240292
The generated pressure mean: 0.4456796944141388
loss_pred:0.02632215805351734, decouple_loss:0.013301395811140537
Iteration: 996, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.448574036359787
loss_pred:0.02755313366651535, decouple_loss:0.012518651783466339
The generated pressure mean: 0.4475928544998169
loss_pred:0.028544776141643524, decouple_loss:0.012198618613183498
The generated pressure mean: 0.4483022391796112
loss_pred:0.02613416314125061, decouple_loss:0.012504572980105877
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 997, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4467659294605255
loss_pred:0.02646389976143837, decouple_loss:0.012584952637553215
The generated pressure mean: 0.44603100419044495
loss_pred:0.027277324348688126, decouple_loss:0.012515317648649216
The generated pressure mean: 0.4468863010406494
loss_pred:0.026404647156596184, decouple_loss:0.012636146508157253
Iteration: 998, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44641295075416565
loss_pred:0.028837626799941063, decouple_loss:0.01391120906919241
The generated pressure mean: 0.4463035464286804
loss_pred:0.026996323838829994, decouple_loss:0.013865159824490547
The generated pressure mean: 0.44879671931266785
loss_pred:0.026438824832439423, decouple_loss:0.014081547036767006
Iteration: 999, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4472636580467224
loss_pred:0.025502029806375504, decouple_loss:0.013878149911761284
The generated pressure mean: 0.44577547907829285
loss_pred:0.02717532217502594, decouple_loss:0.013785366900265217
The generated pressure mean: 0.44609498977661133
loss_pred:0.02681008167564869, decouple_loss:0.013710754923522472
Iteration: 1000, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44739651679992676
loss_pred:0.028164569288492203, decouple_loss:0.01308425422757864
The generated pressure mean: 0.44704756140708923
loss_pred:0.02814219333231449, decouple_loss:0.012700198218226433
The generated pressure mean: 0.44885823130607605
loss_pred:0.02658538520336151, decouple_loss:0.013042353093624115
2023-04-16 05:02:28 itr: 1000
training loss: [0.0272375  0.02881878 0.0287772 ]
2023-04-16 05:02:28 testing...
The generated pressure mean: 0.4495830833911896
The generated pressure mean: 0.449788898229599
The generated pressure mean: 0.44987666606903076
loss_pred:0.03639291599392891, decouple_loss:0.014008191414177418
loss_pred:0.03677009418606758, decouple_loss:0.014079492539167404
loss_pred:0.03628430888056755, decouple_loss:0.014225502498447895
Loss: 0.03718766197562218, avg_mse: 0.04761866480112076
current test mse: 0.047619
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012005_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012005_3_24hr.npz
NaN value num: 0
Iteration: 1001, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4494702219963074
loss_pred:0.026619581505656242, decouple_loss:0.014263789169490337
The generated pressure mean: 0.4478801488876343
loss_pred:0.026693953201174736, decouple_loss:0.014149434864521027
The generated pressure mean: 0.448984295129776
loss_pred:0.02809155359864235, decouple_loss:0.01441241055727005
Iteration: 1002, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44933342933654785
loss_pred:0.028289569541811943, decouple_loss:0.012261518277227879
The generated pressure mean: 0.44858911633491516
loss_pred:0.026756584644317627, decouple_loss:0.012240318581461906
The generated pressure mean: 0.448012113571167
loss_pred:0.02676108293235302, decouple_loss:0.012188239023089409
Iteration: 1003, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44955798983573914
loss_pred:0.02598446235060692, decouple_loss:0.013895483687520027
The generated pressure mean: 0.4481388330459595
loss_pred:0.027107281610369682, decouple_loss:0.013617966324090958
The generated pressure mean: 0.4481961727142334
loss_pred:0.026731355115771294, decouple_loss:0.013761192560195923
Iteration: 1004, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4480447769165039
loss_pred:0.026768758893013, decouple_loss:0.013111796230077744
The generated pressure mean: 0.4482963979244232
loss_pred:0.028385115787386894, decouple_loss:0.013348381966352463
The generated pressure mean: 0.44839170575141907
loss_pred:0.02661694772541523, decouple_loss:0.013143467716872692
Iteration: 1005, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4484032988548279
loss_pred:0.026707958430051804, decouple_loss:0.013405653648078442
The generated pressure mean: 0.4487270712852478
loss_pred:0.025063257664442062, decouple_loss:0.013799009844660759
The generated pressure mean: 0.44889020919799805
loss_pred:0.02825847454369068, decouple_loss:0.013450725935399532
Iteration: 1006, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44847413897514343
loss_pred:0.026463180780410767, decouple_loss:0.0133353928104043
The generated pressure mean: 0.4477488100528717
loss_pred:0.026419326663017273, decouple_loss:0.013496006838977337
The generated pressure mean: 0.449032187461853
loss_pred:0.025946756824851036, decouple_loss:0.013745161704719067
Iteration: 1007, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4483334422111511
loss_pred:0.025951910763978958, decouple_loss:0.013484332710504532
The generated pressure mean: 0.4487454891204834
loss_pred:0.026118500158190727, decouple_loss:0.013244629837572575
The generated pressure mean: 0.4472561478614807
loss_pred:0.027098417282104492, decouple_loss:0.013176891952753067
Iteration: 1008, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4482119381427765
loss_pred:0.027049915865063667, decouple_loss:0.013234938494861126
The generated pressure mean: 0.44772353768348694
loss_pred:0.026855885982513428, decouple_loss:0.013092659413814545
The generated pressure mean: 0.4486353397369385
loss_pred:0.02601942978799343, decouple_loss:0.013593100942671299
Iteration: 1009, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44869402050971985
loss_pred:0.026578333228826523, decouple_loss:0.013683144003152847
The generated pressure mean: 0.4482080340385437
loss_pred:0.02529369480907917, decouple_loss:0.013756115920841694
The generated pressure mean: 0.44870543479919434
loss_pred:0.02676944062113762, decouple_loss:0.013782263733446598
Iteration: 1010, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4478552043437958
loss_pred:0.027043083682656288, decouple_loss:0.012135030701756477
The generated pressure mean: 0.4479963183403015
loss_pred:0.026439078152179718, decouple_loss:0.012171171605587006
The generated pressure mean: 0.4471951127052307
loss_pred:0.02688099443912506, decouple_loss:0.012114633806049824
2023-04-16 05:04:57 testing...
The generated pressure mean: 0.4497888684272766
The generated pressure mean: 0.4495830535888672
The generated pressure mean: 0.44987666606903076
loss_pred:0.03376523405313492, decouple_loss:0.013178643770515919
loss_pred:0.03268599510192871, decouple_loss:0.013061272911727428
loss_pred:0.03213980421423912, decouple_loss:0.013068879954516888
Loss: 0.03351882845163345, avg_mse: 0.04080435633659363
current test mse: 0.040804
Iteration: 1011, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4487707316875458
loss_pred:0.025981782004237175, decouple_loss:0.012681040912866592
The generated pressure mean: 0.44758477807044983
loss_pred:0.02658952958881855, decouple_loss:0.012973683886229992
The generated pressure mean: 0.44876736402511597
loss_pred:0.02544073574244976, decouple_loss:0.013180646114051342
Iteration: 1012, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.448775053024292
loss_pred:0.025800401344895363, decouple_loss:0.012085586786270142
The generated pressure mean: 0.4480783939361572
loss_pred:0.026444081217050552, decouple_loss:0.012202199548482895
The generated pressure mean: 0.44808676838874817
loss_pred:0.029555397108197212, decouple_loss:0.01226793322712183
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1013, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4487197995185852
The generated pressure mean: 0.4485745131969452loss_pred:0.02677617408335209, decouple_loss:0.014361564069986343
loss_pred:0.028085770085453987, decouple_loss:0.014288700185716152
The generated pressure mean: 0.44878554344177246
loss_pred:0.02734636701643467, decouple_loss:0.014383114874362946
Iteration: 1014, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44862884283065796
loss_pred:0.02773558907210827, decouple_loss:0.014765845611691475
The generated pressure mean: 0.4489459991455078
loss_pred:0.026921512559056282, decouple_loss:0.014648492448031902
The generated pressure mean: 0.4474312961101532
loss_pred:0.02774033322930336, decouple_loss:0.014341077767312527
Iteration: 1015, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4492050111293793
loss_pred:0.026007724925875664, decouple_loss:0.014890187419950962
The generated pressure mean: 0.4485594630241394
loss_pred:0.027210615575313568, decouple_loss:0.014810082502663136
The generated pressure mean: 0.4475170075893402
loss_pred:0.026201307773590088, decouple_loss:0.014735718257725239
Iteration: 1016, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44666147232055664
loss_pred:0.026500802487134933, decouple_loss:0.013070227578282356
The generated pressure mean: 0.44635310769081116
loss_pred:0.026875976473093033, decouple_loss:0.013213750906288624
The generated pressure mean: 0.44756248593330383
loss_pred:0.02716033346951008, decouple_loss:0.012847707606852055
Iteration: 1017, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4486894905567169
loss_pred:0.027693217620253563, decouple_loss:0.014290207996964455
The generated pressure mean: 0.4486238360404968
loss_pred:0.02642672508955002, decouple_loss:0.014333515428006649
The generated pressure mean: 0.449144572019577
loss_pred:0.025666283443570137, decouple_loss:0.014531799592077732
Iteration: 1018, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4488264322280884
loss_pred:0.02544362097978592, decouple_loss:0.013387996703386307
The generated pressure mean: 0.4485089182853699
loss_pred:0.026412153616547585, decouple_loss:0.013304644264280796
The generated pressure mean: 0.4477640688419342
loss_pred:0.026796314865350723, decouple_loss:0.013148908503353596
Iteration: 1019, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44823095202445984
loss_pred:0.02745787985622883, decouple_loss:0.013926167972385883
The generated pressure mean: 0.44737279415130615
loss_pred:0.029568614438176155, decouple_loss:0.013738429173827171
The generated pressure mean: 0.447951078414917
loss_pred:0.026463132351636887, decouple_loss:0.01388504821807146
Iteration: 1020, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4473927617073059
loss_pred:0.027166059240698814, decouple_loss:0.015072835609316826
The generated pressure mean: 0.44863730669021606
loss_pred:0.026670025661587715, decouple_loss:0.015022183768451214
The generated pressure mean: 0.44805780053138733
loss_pred:0.025312373414635658, decouple_loss:0.014831606298685074
2023-04-16 05:06:52 testing...
The generated pressure mean: 0.4495830833911896
The generated pressure mean: 0.4497888684272766
The generated pressure mean: 0.44987666606903076
loss_pred:0.03442293405532837, decouple_loss:0.013832632452249527
loss_pred:0.03506460413336754, decouple_loss:0.01372609194368124
loss_pred:0.03383057564496994, decouple_loss:0.013636043295264244
Loss: 0.03512594848871231, avg_mse: 0.043603405356407166
current test mse: 0.043603
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012006_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012006_3_24hr.npz
NaN value num: 0
Iteration: 1021, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4473671317100525
loss_pred:0.02738022245466709, decouple_loss:0.013363419100642204
The generated pressure mean: 0.4488238990306854
loss_pred:0.027017462998628616, decouple_loss:0.014169852249324322
The generated pressure mean: 0.44820716977119446
loss_pred:0.026057619601488113, decouple_loss:0.01408479269593954
Iteration: 1022, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4470902383327484
loss_pred:0.026353418827056885, decouple_loss:0.014945635572075844
The generated pressure mean: 0.44688403606414795
loss_pred:0.02651762031018734, decouple_loss:0.015468752011656761
The generated pressure mean: 0.4472901225090027
loss_pred:0.02720087766647339, decouple_loss:0.01539876963943243
Iteration: 1023, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4467688500881195
loss_pred:0.027345024049282074, decouple_loss:0.013684323988854885
The generated pressure mean: 0.44742700457572937
loss_pred:0.026364190503954887, decouple_loss:0.014034739695489407
The generated pressure mean: 0.4481145143508911
loss_pred:0.027269627898931503, decouple_loss:0.013733485713601112
Iteration: 1024, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4478028416633606
The generated pressure mean: 0.44815999269485474
loss_pred:0.02609509602189064, decouple_loss:0.012526419013738632
loss_pred:0.027161139994859695, decouple_loss:0.012362918816506863
The generated pressure mean: 0.4484044313430786
loss_pred:0.026109997183084488, decouple_loss:0.012522694654762745
Iteration: 1025, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44699326157569885
loss_pred:0.027113966643810272, decouple_loss:0.012849046848714352
The generated pressure mean: 0.44832292199134827
loss_pred:0.026126602664589882, decouple_loss:0.01284631248563528
The generated pressure mean: 0.447663813829422
loss_pred:0.027476554736495018, decouple_loss:0.012775852344930172
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1026, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44814372062683105
loss_pred:0.027968861162662506, decouple_loss:0.012219205498695374
The generated pressure mean: 0.4471854269504547
loss_pred:0.0257307980209589, decouple_loss:0.012448016554117203
The generated pressure mean: 0.446816623210907
loss_pred:0.025695009157061577, decouple_loss:0.01223221980035305
Iteration: 1027, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4493086040019989
loss_pred:0.02495303750038147, decouple_loss:0.01313639897853136
The generated pressure mean: 0.4466072618961334
loss_pred:0.027492113411426544, decouple_loss:0.012883372604846954
The generated pressure mean: 0.44773998856544495
loss_pred:0.02587857097387314, decouple_loss:0.013030576519668102
Iteration: 1028, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44761157035827637
loss_pred:0.02790519967675209, decouple_loss:0.013015077449381351
The generated pressure mean: 0.4466507136821747
loss_pred:0.02586272358894348, decouple_loss:0.0131072411313653
The generated pressure mean: 0.4472962021827698
loss_pred:0.026395384222269058, decouple_loss:0.013346759602427483
Iteration: 1029, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4473554491996765
loss_pred:0.02626781538128853, decouple_loss:0.012724180705845356
The generated pressure mean: 0.4472491145133972
loss_pred:0.02775384485721588, decouple_loss:0.012853465043008327
The generated pressure mean: 0.4468085765838623
loss_pred:0.027056053280830383, decouple_loss:0.01289454847574234
Iteration: 1030, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44653046131134033
loss_pred:0.026327157393097878, decouple_loss:0.013736790046095848
The generated pressure mean: 0.4480040967464447
loss_pred:0.026812590658664703, decouple_loss:0.01356642134487629
The generated pressure mean: 0.447831928730011
loss_pred:0.026356840506196022, decouple_loss:0.013389076106250286
2023-04-16 05:09:23 testing...
The generated pressure mean: 0.4495830833911896
The generated pressure mean: 0.4497888684272766
The generated pressure mean: 0.44987666606903076
loss_pred:0.03423195704817772, decouple_loss:0.012028743512928486
loss_pred:0.034517716616392136, decouple_loss:0.01205043587833643
loss_pred:0.0332457534968853, decouple_loss:0.012134082615375519
Loss: 0.034602031111717224, avg_mse: 0.04314512014389038
current test mse: 0.043145
Iteration: 1031, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4473397433757782
loss_pred:0.027715664356946945, decouple_loss:0.012000235728919506
The generated pressure mean: 0.44682765007019043
loss_pred:0.026426296681165695, decouple_loss:0.01206049881875515
The generated pressure mean: 0.44732606410980225
loss_pred:0.027222411707043648, decouple_loss:0.012040777131915092
Iteration: 1032, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4477618932723999
loss_pred:0.0261714868247509, decouple_loss:0.01299633365124464
The generated pressure mean: 0.44693994522094727
loss_pred:0.025895684957504272, decouple_loss:0.012645886279642582
The generated pressure mean: 0.447664350271225
loss_pred:0.02774803154170513, decouple_loss:0.012782487086951733
Iteration: 1033, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44689303636550903
loss_pred:0.02524564042687416, decouple_loss:0.014034262858331203
The generated pressure mean: 0.44660675525665283
loss_pred:0.027248527854681015, decouple_loss:0.01374909933656454
The generated pressure mean: 0.4468052387237549
loss_pred:0.02715151570737362, decouple_loss:0.013939307071268559
Iteration: 1034, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44747069478034973
loss_pred:0.026539329439401627, decouple_loss:0.01343583781272173
The generated pressure mean: 0.44795042276382446
loss_pred:0.026155933737754822, decouple_loss:0.013525119051337242
The generated pressure mean: 0.44823771715164185
loss_pred:0.0272940956056118, decouple_loss:0.013415038585662842
Iteration: 1035, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44688132405281067
loss_pred:0.026058707386255264, decouple_loss:0.01172079611569643
The generated pressure mean: 0.44794484972953796
The generated pressure mean: 0.4479466378688812
loss_pred:0.026705870404839516, decouple_loss:0.011591971851885319
loss_pred:0.025731807574629784, decouple_loss:0.011851870454847813
Iteration: 1036, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4472769796848297
loss_pred:0.02794455923140049, decouple_loss:0.011019452475011349
The generated pressure mean: 0.44723570346832275
loss_pred:0.025523973628878593, decouple_loss:0.011139045469462872
The generated pressure mean: 0.44734081625938416
loss_pred:0.027449339628219604, decouple_loss:0.01126367598772049
Iteration: 1037, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44622570276260376
The generated pressure mean: 0.4473111629486084
loss_pred:0.02693038433790207, decouple_loss:0.011467402800917625
loss_pred:0.02701917663216591, decouple_loss:0.011708814650774002
The generated pressure mean: 0.4485522210597992
loss_pred:0.025388365611433983, decouple_loss:0.011457150802016258
Iteration: 1038, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44745659828186035
loss_pred:0.026596035808324814, decouple_loss:0.013170617632567883
The generated pressure mean: 0.44862884283065796
loss_pred:0.02694132551550865, decouple_loss:0.012981079518795013
The generated pressure mean: 0.446754515171051
loss_pred:0.027462763711810112, decouple_loss:0.01317326258867979
Iteration: 1039, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44754335284233093
loss_pred:0.02637566067278385, decouple_loss:0.012135886587202549
The generated pressure mean: 0.4481634795665741
loss_pred:0.025604089722037315, decouple_loss:0.012390614487230778
The generated pressure mean: 0.4471207857131958
loss_pred:0.025900302454829216, decouple_loss:0.012524960562586784
Iteration: 1040, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4482698440551758
loss_pred:0.025630155578255653, decouple_loss:0.012252784334123135
The generated pressure mean: 0.4474378228187561
loss_pred:0.025671573355793953, decouple_loss:0.011941890232264996
The generated pressure mean: 0.4472196400165558
loss_pred:0.027643505483865738, decouple_loss:0.011835143901407719
2023-04-16 05:11:17 testing...
The generated pressure mean: 0.4495830833911896
The generated pressure mean: 0.449788898229599
The generated pressure mean: 0.44987666606903076
loss_pred:0.03242429345846176, decouple_loss:0.013166740536689758
loss_pred:0.03349193185567856, decouple_loss:0.01317533478140831
loss_pred:0.0319785550236702, decouple_loss:0.013064779341220856
Loss: 0.03328837454319, avg_mse: 0.04070374369621277
current test mse: 0.040704
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012017_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012017_3_24hr.npz
NaN value num: 0
Iteration: 1041, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44893890619277954
loss_pred:0.02772011049091816, decouple_loss:0.013834100216627121
The generated pressure mean: 0.44900357723236084
loss_pred:0.02740889973938465, decouple_loss:0.013996938243508339
The generated pressure mean: 0.4471893906593323
loss_pred:0.026439666748046875, decouple_loss:0.013494149781763554
Iteration: 1042, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44753149151802063
The generated pressure mean: 0.44853904843330383
loss_pred:0.025895657017827034, decouple_loss:0.012029893696308136
loss_pred:0.026706630364060402, decouple_loss:0.012680623680353165
The generated pressure mean: 0.44720131158828735
loss_pred:0.02985103242099285, decouple_loss:0.012304739095270634
Iteration: 1043, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4494127631187439
The generated pressure mean: 0.4480086863040924
loss_pred:0.026718327775597572, decouple_loss:0.012870484963059425
loss_pred:0.02699696272611618, decouple_loss:0.012877169996500015
The generated pressure mean: 0.44788235425949097
loss_pred:0.02646676078438759, decouple_loss:0.012765881605446339
Iteration: 1044, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44762134552001953
The generated pressure mean: 0.44714075326919556
loss_pred:0.026667820289731026, decouple_loss:0.015201753005385399
The generated pressure mean: 0.44682610034942627
loss_pred:0.026807095855474472, decouple_loss:0.014787737280130386
loss_pred:0.026490429416298866, decouple_loss:0.014960476197302341
Iteration: 1045, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44984617829322815
The generated pressure mean: 0.4483799636363983
loss_pred:0.025854567065835, decouple_loss:0.01331399567425251
loss_pred:0.02805575728416443, decouple_loss:0.013316340744495392
The generated pressure mean: 0.44759809970855713
loss_pred:0.026925429701805115, decouple_loss:0.013087915256619453
Iteration: 1046, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4476511776447296
The generated pressure mean: 0.44836121797561646
loss_pred:0.028269927948713303, decouple_loss:0.013884969986975193
The generated pressure mean: 0.4493180811405182
loss_pred:0.027957508340477943, decouple_loss:0.01388546358793974
loss_pred:0.026336990296840668, decouple_loss:0.013631696812808514
Iteration: 1047, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4479621946811676
The generated pressure mean: 0.448137491941452
loss_pred:0.0272197425365448, decouple_loss:0.0128059396520257
loss_pred:0.026501450687646866, decouple_loss:0.012770125642418861
The generated pressure mean: 0.4478819668292999
loss_pred:0.026942240074276924, decouple_loss:0.01303661335259676
Iteration: 1048, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4490025043487549
loss_pred:0.026228642091155052, decouple_loss:0.013892862014472485
The generated pressure mean: 0.44725844264030457
loss_pred:0.025951238349080086, decouple_loss:0.013613460585474968
The generated pressure mean: 0.44782891869544983
loss_pred:0.02592579275369644, decouple_loss:0.013625392690300941
Iteration: 1049, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4481185972690582
The generated pressure mean: 0.44753068685531616
loss_pred:0.027089456096291542, decouple_loss:0.014500956051051617
loss_pred:0.025254441425204277, decouple_loss:0.013976434245705605
The generated pressure mean: 0.4482285976409912
loss_pred:0.02720804698765278, decouple_loss:0.014401069842278957
Iteration: 1050, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4487735331058502
loss_pred:0.025461990386247635, decouple_loss:0.0140674514696002
The generated pressure mean: 0.44979754090309143
The generated pressure mean: 0.44839510321617126
loss_pred:0.02720218151807785, decouple_loss:0.014211218804121017
loss_pred:0.02545825019478798, decouple_loss:0.01430430542677641
2023-04-16 05:13:47 testing...
The generated pressure mean: 0.4495830535888672
The generated pressure mean: 0.4497888684272766
The generated pressure mean: 0.44987666606903076
loss_pred:0.0333782434463501, decouple_loss:0.014880528673529625
loss_pred:0.0338321290910244, decouple_loss:0.014750447124242783
loss_pred:0.03275784105062485, decouple_loss:0.014830682426691055
Loss: 0.03406376764178276, avg_mse: 0.04187376797199249
current test mse: 0.041874
Iteration: 1051, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4487559199333191
The generated pressure mean: 0.44864314794540405
loss_pred:0.02494717948138714, decouple_loss:0.015275104902684689
loss_pred:0.0251301359385252, decouple_loss:0.01483374647796154
The generated pressure mean: 0.44838017225265503
loss_pred:0.026465581730008125, decouple_loss:0.015211193822324276
Iteration: 1052, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44741275906562805
The generated pressure mean: 0.4478338658809662
loss_pred:0.027419036254286766, decouple_loss:0.014742785133421421
loss_pred:0.026217030361294746, decouple_loss:0.01466958038508892
The generated pressure mean: 0.44756239652633667
loss_pred:0.025585312396287918, decouple_loss:0.014892790466547012
Iteration: 1053, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44822725653648376
loss_pred:0.025645360350608826, decouple_loss:0.014060392044484615
The generated pressure mean: 0.4488871693611145
loss_pred:0.026353877037763596, decouple_loss:0.01380170602351427
The generated pressure mean: 0.4487232267856598
loss_pred:0.027474217116832733, decouple_loss:0.014112835749983788
Iteration: 1054, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4486769139766693
loss_pred:0.025912078097462654, decouple_loss:0.014109215699136257
The generated pressure mean: 0.44885775446891785
loss_pred:0.025413868948817253, decouple_loss:0.014524145983159542
The generated pressure mean: 0.44960030913352966
loss_pred:0.025915367528796196, decouple_loss:0.014295325614511967
Iteration: 1055, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44799748063087463
The generated pressure mean: 0.4478216767311096
loss_pred:0.027441207319498062, decouple_loss:0.0140610933303833
loss_pred:0.026202131062746048, decouple_loss:0.014022872783243656
The generated pressure mean: 0.4477008283138275
loss_pred:0.02914809249341488, decouple_loss:0.014226607047021389
Iteration: 1056, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44869518280029297
The generated pressure mean: 0.44893336296081543
loss_pred:0.026495516300201416, decouple_loss:0.013764683157205582
loss_pred:0.02489105798304081, decouple_loss:0.013546159490942955
The generated pressure mean: 0.44861671328544617
loss_pred:0.025317803025245667, decouple_loss:0.01371945533901453
Iteration: 1057, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4492904543876648
loss_pred:0.026387576013803482, decouple_loss:0.013607100583612919
The generated pressure mean: 0.44885721802711487
loss_pred:0.026515239849686623, decouple_loss:0.01361948624253273
The generated pressure mean: 0.4495008885860443
loss_pred:0.025105049833655357, decouple_loss:0.013584929518401623
Iteration: 1058, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4480818510055542
loss_pred:0.026783457025885582, decouple_loss:0.01330136600881815
The generated pressure mean: 0.447274774312973
loss_pred:0.027117718011140823, decouple_loss:0.013164980337023735
The generated pressure mean: 0.4494132995605469
loss_pred:0.02601080760359764, decouple_loss:0.013253279961645603
Iteration: 1059, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4494490623474121
The generated pressure mean: 0.4486500322818756
loss_pred:0.026545755565166473, decouple_loss:0.013782828114926815
loss_pred:0.026210153475403786, decouple_loss:0.0136211346834898
The generated pressure mean: 0.4488367736339569
loss_pred:0.026233673095703125, decouple_loss:0.013602682389318943
Iteration: 1060, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44853317737579346
The generated pressure mean: 0.4492121636867523
loss_pred:0.026293599978089333, decouple_loss:0.012979485094547272
loss_pred:0.027375221252441406, decouple_loss:0.013158267363905907
The generated pressure mean: 0.4484681785106659
loss_pred:0.027118440717458725, decouple_loss:0.013282916508615017
2023-04-16 05:15:41 testing...
The generated pressure mean: 0.449788898229599
The generated pressure mean: 0.4495830535888672
The generated pressure mean: 0.44987666606903076
loss_pred:0.035376425832509995, decouple_loss:0.015213578008115292
loss_pred:0.034916337579488754, decouple_loss:0.015056212432682514
loss_pred:0.03423747420310974, decouple_loss:0.015125853940844536
Loss: 0.03560000658035278, avg_mse: 0.04480321332812309
current test mse: 0.044803
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012018_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012018_3_24hr.npz
NaN value num: 0
Iteration: 1061, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44795525074005127
loss_pred:0.027825703844428062, decouple_loss:0.015649594366550446
The generated pressure mean: 0.44762691855430603
The generated pressure mean: 0.4475157856941223loss_pred:0.026452679187059402, decouple_loss:0.015330621041357517
loss_pred:0.027761070057749748, decouple_loss:0.015304108150303364
Iteration: 1062, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4478335976600647
loss_pred:0.026814917102456093, decouple_loss:0.0146718705072999
The generated pressure mean: 0.4481903612613678
loss_pred:0.025086304172873497, decouple_loss:0.015146328136324883
The generated pressure mean: 0.44832858443260193
loss_pred:0.028011783957481384, decouple_loss:0.014764060266315937
Iteration: 1063, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44811341166496277
loss_pred:0.02691757306456566, decouple_loss:0.014302033931016922
The generated pressure mean: 0.44719934463500977
loss_pred:0.026642465963959694, decouple_loss:0.014165746979415417
The generated pressure mean: 0.44799932837486267
loss_pred:0.027618039399385452, decouple_loss:0.014601798728108406
Iteration: 1064, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4482947587966919
loss_pred:0.026989854872226715, decouple_loss:0.01358938217163086
The generated pressure mean: 0.44841691851615906
loss_pred:0.026198871433734894, decouple_loss:0.013570800423622131
The generated pressure mean: 0.44878119230270386
loss_pred:0.026128316298127174, decouple_loss:0.01380532793700695
Iteration: 1065, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4472784698009491
loss_pred:0.02518560364842415, decouple_loss:0.01470947451889515
The generated pressure mean: 0.4481147229671478
loss_pred:0.026843206956982613, decouple_loss:0.01499213557690382
The generated pressure mean: 0.4483509063720703
loss_pred:0.025772975757718086, decouple_loss:0.014993016608059406
Iteration: 1066, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.448560506105423
loss_pred:0.02457793988287449, decouple_loss:0.013643810525536537
The generated pressure mean: 0.4478529691696167
loss_pred:0.025487655773758888, decouple_loss:0.013430802151560783
The generated pressure mean: 0.4478616714477539
loss_pred:0.026907658204436302, decouple_loss:0.013505076989531517
Iteration: 1067, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4484274089336395
loss_pred:0.025267377495765686, decouple_loss:0.013565863482654095
The generated pressure mean: 0.4476151466369629
loss_pred:0.02575892023742199, decouple_loss:0.013490544632077217
The generated pressure mean: 0.44799745082855225
loss_pred:0.025885095819830894, decouple_loss:0.013398350216448307
Iteration: 1068, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44744616746902466
loss_pred:0.027481751516461372, decouple_loss:0.015209321863949299
The generated pressure mean: 0.447795033454895
loss_pred:0.026826970279216766, decouple_loss:0.015117025002837181
The generated pressure mean: 0.4479043781757355
loss_pred:0.025974344462156296, decouple_loss:0.015253812074661255
Iteration: 1069, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4477216899394989
The generated pressure mean: 0.44868525862693787
loss_pred:0.024773595854640007, decouple_loss:0.012711298651993275
loss_pred:0.026348266750574112, decouple_loss:0.012801041826605797
The generated pressure mean: 0.44773542881011963
loss_pred:0.025927776470780373, decouple_loss:0.012705947272479534
Iteration: 1070, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44780224561691284
loss_pred:0.025891322642564774, decouple_loss:0.013781233690679073
The generated pressure mean: 0.448762446641922
loss_pred:0.02529831975698471, decouple_loss:0.013781574554741383
The generated pressure mean: 0.44754910469055176
loss_pred:0.026994500309228897, decouple_loss:0.01353186834603548
2023-04-16 05:18:15 testing...
The generated pressure mean: 0.4495830833911896
The generated pressure mean: 0.4497888684272766
The generated pressure mean: 0.44987666606903076
loss_pred:0.033039432018995285, decouple_loss:0.014363560825586319
loss_pred:0.03388189524412155, decouple_loss:0.014203272759914398
loss_pred:0.032166000455617905, decouple_loss:0.01417046319693327
Loss: 0.03374139964580536, avg_mse: 0.04169166088104248
current test mse: 0.041692
Iteration: 1071, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44794991612434387
The generated pressure mean: 0.44811728596687317
loss_pred:0.025719447061419487, decouple_loss:0.014474932104349136
loss_pred:0.026339849457144737, decouple_loss:0.014172699302434921
The generated pressure mean: 0.44778382778167725
loss_pred:0.025699401274323463, decouple_loss:0.014354966580867767
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1072, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44753900170326233
The generated pressure mean: 0.44880369305610657
loss_pred:0.026061812415719032, decouple_loss:0.013754189014434814
loss_pred:0.026996303349733353, decouple_loss:0.013571028597652912
The generated pressure mean: 0.44728928804397583
loss_pred:0.02524116076529026, decouple_loss:0.014017489738762379
Iteration: 1073, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4476363956928253
loss_pred:0.026513615623116493, decouple_loss:0.012230398133397102
The generated pressure mean: 0.44787734746932983
loss_pred:0.026182271540164948, decouple_loss:0.01229892112314701
The generated pressure mean: 0.4475034475326538
loss_pred:0.027231791988015175, decouple_loss:0.012290076352655888
Iteration: 1074, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44749870896339417
loss_pred:0.02554534561932087, decouple_loss:0.012273930944502354
The generated pressure mean: 0.4471258223056793
loss_pred:0.02509394846856594, decouple_loss:0.012032344937324524
The generated pressure mean: 0.4480019211769104
loss_pred:0.026626376435160637, decouple_loss:0.012017790228128433
Iteration: 1075, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.448133647441864
loss_pred:0.025538286194205284, decouple_loss:0.012948576360940933
The generated pressure mean: 0.44771623611450195
loss_pred:0.024624360725283623, decouple_loss:0.012837878428399563
The generated pressure mean: 0.44791802763938904
loss_pred:0.025311795994639397, decouple_loss:0.013068892061710358
Iteration: 1076, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44771313667297363
The generated pressure mean: 0.4477713108062744
loss_pred:0.025893952697515488, decouple_loss:0.013507653959095478
loss_pred:0.025470353662967682, decouple_loss:0.013597089797258377
The generated pressure mean: 0.44806525111198425
loss_pred:0.024423157796263695, decouple_loss:0.013625114224851131
Iteration: 1077, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44844841957092285
loss_pred:0.02688623033463955, decouple_loss:0.011986466124653816
The generated pressure mean: 0.44751855731010437
loss_pred:0.02566264010965824, decouple_loss:0.012060114182531834
The generated pressure mean: 0.4480687975883484
loss_pred:0.02611534856259823, decouple_loss:0.012157376855611801
Iteration: 1078, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44788500666618347
loss_pred:0.02721281163394451, decouple_loss:0.011641595512628555
The generated pressure mean: 0.4474197030067444
loss_pred:0.02572707086801529, decouple_loss:0.011753348633646965
The generated pressure mean: 0.44741690158843994
loss_pred:0.025160258635878563, decouple_loss:0.01174348033964634
Iteration: 1079, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44811609387397766
loss_pred:0.02590790018439293, decouple_loss:0.011741753667593002
The generated pressure mean: 0.44806361198425293
loss_pred:0.0262060035020113, decouple_loss:0.011782525107264519
The generated pressure mean: 0.44798147678375244
loss_pred:0.024695279076695442, decouple_loss:0.011734534986317158
Iteration: 1080, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4491630792617798
loss_pred:0.02530563995242119, decouple_loss:0.012784333899617195
The generated pressure mean: 0.44790560007095337
loss_pred:0.026316653937101364, decouple_loss:0.01294775027781725
The generated pressure mean: 0.44780266284942627
loss_pred:0.026111215353012085, decouple_loss:0.012717693112790585
2023-04-16 05:20:09 testing...
The generated pressure mean: 0.4497888684272766
The generated pressure mean: 0.4495830833911896
The generated pressure mean: 0.44987666606903076
loss_pred:0.03329848870635033, decouple_loss:0.012743646278977394
loss_pred:0.03213445469737053, decouple_loss:0.012798456475138664loss_pred:0.031717076897621155, decouple_loss:0.012949567288160324
Loss: 0.0330248698592186, avg_mse: 0.04063836485147476
current test mse: 0.040638
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012000_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012000_3_24hr.npz
NaN value num: 0
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1081, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44644027948379517
loss_pred:0.02566814422607422, decouple_loss:0.012683838605880737
The generated pressure mean: 0.4467405080795288
loss_pred:0.02472078613936901, decouple_loss:0.0129000348970294
The generated pressure mean: 0.44827795028686523
loss_pred:0.0258182305842638, decouple_loss:0.012830928899347782
Iteration: 1082, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4470362365245819
The generated pressure mean: 0.44925034046173096
loss_pred:0.026104653254151344, decouple_loss:0.011999543756246567
loss_pred:0.024672705680131912, decouple_loss:0.011767822317779064
The generated pressure mean: 0.44781818985939026
loss_pred:0.0245859082788229, decouple_loss:0.011965896002948284
Iteration: 1083, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44630932807922363The generated pressure mean: 0.44738295674324036
loss_pred:0.025270605459809303, decouple_loss:0.010563885793089867The generated pressure mean: 0.4475334584712982
loss_pred:0.02435368299484253, decouple_loss:0.010470974259078503
loss_pred:0.024458875879645348, decouple_loss:0.010426683351397514
Iteration: 1084, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44916796684265137
loss_pred:0.02454516850411892, decouple_loss:0.010507137514650822
The generated pressure mean: 0.4466509222984314
loss_pred:0.02414582669734955, decouple_loss:0.01065437775105238
The generated pressure mean: 0.44729188084602356
loss_pred:0.02444593608379364, decouple_loss:0.010866709053516388
Iteration: 1085, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44717806577682495
The generated pressure mean: 0.4469894468784332
loss_pred:0.02540372498333454, decouple_loss:0.011924278922379017
loss_pred:0.02409914880990982, decouple_loss:0.011786727234721184
The generated pressure mean: 0.4475764036178589
loss_pred:0.02457370236515999, decouple_loss:0.011801947839558125
Iteration: 1086, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4461483955383301
The generated pressure mean: 0.44786641001701355
loss_pred:0.024608025327324867, decouple_loss:0.012090195901691914
loss_pred:0.025513825938105583, decouple_loss:0.011917788535356522
The generated pressure mean: 0.44815972447395325
loss_pred:0.026371551677584648, decouple_loss:0.011835543438792229
Iteration: 1087, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44702965021133423
loss_pred:0.024745309725403786, decouple_loss:0.010652459226548672
The generated pressure mean: 0.44661250710487366
loss_pred:0.025044573470950127, decouple_loss:0.010414755903184414
The generated pressure mean: 0.4468916654586792
loss_pred:0.026038244366645813, decouple_loss:0.010551631450653076
Iteration: 1088, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44645529985427856
The generated pressure mean: 0.4466874897480011
loss_pred:0.025294747203588486, decouple_loss:0.011268186382949352
loss_pred:0.026062550023198128, decouple_loss:0.011157330125570297
The generated pressure mean: 0.4471036195755005
loss_pred:0.02528594620525837, decouple_loss:0.011611687019467354
Iteration: 1089, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4468054175376892
The generated pressure mean: 0.4487743079662323
loss_pred:0.024197736755013466, decouple_loss:0.010280531831085682
loss_pred:0.024246037006378174, decouple_loss:0.010476360097527504
The generated pressure mean: 0.44641056656837463
loss_pred:0.023967815563082695, decouple_loss:0.010410096496343613
Iteration: 1090, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4458523094654083
The generated pressure mean: 0.4454604387283325
loss_pred:0.023816470056772232, decouple_loss:0.010792925953865051
loss_pred:0.024589795619249344, decouple_loss:0.011083880439400673
The generated pressure mean: 0.44714269042015076
loss_pred:0.024755191057920456, decouple_loss:0.010624933056533337
2023-04-16 05:22:40 testing...
The generated pressure mean: 0.449788898229599
The generated pressure mean: 0.4495830535888672
The generated pressure mean: 0.44987666606903076
loss_pred:0.03352715075016022, decouple_loss:0.012153037823736668
loss_pred:0.03279132395982742, decouple_loss:0.012218785472214222
loss_pred:0.03247257322072983, decouple_loss:0.012197593227028847
Loss: 0.03353983908891678, avg_mse: 0.04188168793916702
current test mse: 0.041882
Iteration: 1091, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44737595319747925
loss_pred:0.024800192564725876, decouple_loss:0.011783404275774956
The generated pressure mean: 0.4465504586696625
loss_pred:0.02637232467532158, decouple_loss:0.011836694553494453
The generated pressure mean: 0.4478625953197479
loss_pred:0.024676846340298653, decouple_loss:0.012133070267736912
Iteration: 1092, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44691750407218933
loss_pred:0.0249661672860384, decouple_loss:0.010727613233029842
The generated pressure mean: 0.4455258548259735
loss_pred:0.024305202066898346, decouple_loss:0.010809681378304958
The generated pressure mean: 0.4473969638347626
loss_pred:0.026027468964457512, decouple_loss:0.01057253684848547
Iteration: 1093, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44844359159469604
loss_pred:0.02602136693894863, decouple_loss:0.010937080718576908
The generated pressure mean: 0.446135550737381
loss_pred:0.024139879271388054, decouple_loss:0.011067632585763931
The generated pressure mean: 0.44839704036712646
loss_pred:0.02573726326227188, decouple_loss:0.010709313675761223
Iteration: 1094, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44768601655960083
loss_pred:0.024993091821670532, decouple_loss:0.012721795588731766
The generated pressure mean: 0.44697317481040955
loss_pred:0.025866691023111343, decouple_loss:0.012623196467757225
The generated pressure mean: 0.4472388029098511
loss_pred:0.026033522561192513, decouple_loss:0.012654253281652927
Iteration: 1095, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44827088713645935
loss_pred:0.02549644745886326, decouple_loss:0.01325835008174181
The generated pressure mean: 0.446512371301651
loss_pred:0.025697004050016403, decouple_loss:0.012945126742124557
The generated pressure mean: 0.447671502828598
loss_pred:0.024645941331982613, decouple_loss:0.012793753296136856
Iteration: 1096, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4480457603931427
loss_pred:0.026032187044620514, decouple_loss:0.011220239102840424
The generated pressure mean: 0.44876810908317566
loss_pred:0.024158935993909836, decouple_loss:0.011160612106323242
The generated pressure mean: 0.44633227586746216
loss_pred:0.02508484572172165, decouple_loss:0.011360847391188145
Iteration: 1097, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44701990485191345
loss_pred:0.025838881731033325, decouple_loss:0.01168111339211464
The generated pressure mean: 0.4466387629508972
loss_pred:0.024114415049552917, decouple_loss:0.012049305252730846
The generated pressure mean: 0.44797664880752563
loss_pred:0.025743631646037102, decouple_loss:0.011881893500685692
Iteration: 1098, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4455268383026123
loss_pred:0.02563377469778061, decouple_loss:0.014677696861326694
The generated pressure mean: 0.4465046525001526
loss_pred:0.026037538424134254, decouple_loss:0.014911211095750332
The generated pressure mean: 0.4470798075199127
loss_pred:0.02664732001721859, decouple_loss:0.01448555663228035
Iteration: 1099, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44670215249061584
loss_pred:0.026576930657029152, decouple_loss:0.01281718723475933
The generated pressure mean: 0.44767534732818604
loss_pred:0.02522260695695877, decouple_loss:0.012560968287289143
The generated pressure mean: 0.4474863111972809
loss_pred:0.027531970292329788, decouple_loss:0.012886949814856052
Iteration: 1100, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4465515613555908
loss_pred:0.025109602138400078, decouple_loss:0.014596974477171898
The generated pressure mean: 0.44735249876976013
loss_pred:0.025864209979772568, decouple_loss:0.01480637677013874
The generated pressure mean: 0.4473676085472107
loss_pred:0.025921158492565155, decouple_loss:0.014915934763848782
2023-04-16 05:24:34 testing...
The generated pressure mean: 0.449788898229599
The generated pressure mean: 0.4495830535888672
The generated pressure mean: 0.44987666606903076
loss_pred:0.03464996814727783, decouple_loss:0.013247630558907986
loss_pred:0.03374335542321205, decouple_loss:0.013103365898132324
loss_pred:0.03332177549600601, decouple_loss:0.013078218325972557
Loss: 0.034562185406684875, avg_mse: 0.0430319681763649
current test mse: 0.043032
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012006_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012006_3_24hr.npz
NaN value num: 0
Iteration: 1101, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44917911291122437
loss_pred:0.026672599837183952, decouple_loss:0.013254926539957523
The generated pressure mean: 0.4480079710483551
loss_pred:0.02642238885164261, decouple_loss:0.01325303316116333
The generated pressure mean: 0.44786936044692993
loss_pred:0.026802359148859978, decouple_loss:0.013608547858893871
Iteration: 1102, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44835829734802246
loss_pred:0.025971118360757828, decouple_loss:0.013437241315841675
The generated pressure mean: 0.4497270882129669
loss_pred:0.02658834308385849, decouple_loss:0.013453135266900063
The generated pressure mean: 0.44877615571022034
loss_pred:0.025910306721925735, decouple_loss:0.013230334967374802
Iteration: 1103, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4481826722621918
loss_pred:0.026682639494538307, decouple_loss:0.012480382807552814
The generated pressure mean: 0.44884926080703735
loss_pred:0.027578478679060936, decouple_loss:0.012375261634588242
The generated pressure mean: 0.4499695599079132
loss_pred:0.02545361965894699, decouple_loss:0.012363946996629238
Iteration: 1104, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44881996512413025
loss_pred:0.02675599232316017, decouple_loss:0.013350212015211582
The generated pressure mean: 0.44923079013824463
loss_pred:0.026036255061626434, decouple_loss:0.013709613122045994
The generated pressure mean: 0.44944050908088684
loss_pred:0.02664371021091938, decouple_loss:0.013177311047911644
Iteration: 1105, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4492274522781372
loss_pred:0.026234686374664307, decouple_loss:0.01378555502742529
The generated pressure mean: 0.4471559524536133
loss_pred:0.027506304904818535, decouple_loss:0.013845699839293957
The generated pressure mean: 0.4473377764225006
loss_pred:0.026691444218158722, decouple_loss:0.013894646428525448
Iteration: 1106, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44782352447509766
loss_pred:0.026731515303254128, decouple_loss:0.014358214102685452
The generated pressure mean: 0.4491414725780487
loss_pred:0.028606878593564034, decouple_loss:0.01473650336265564
The generated pressure mean: 0.4494444727897644
loss_pred:0.026150567457079887, decouple_loss:0.014361989684402943
Iteration: 1107, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44849711656570435
loss_pred:0.026726379990577698, decouple_loss:0.01398675236850977
The generated pressure mean: 0.4478321671485901
loss_pred:0.026120398193597794, decouple_loss:0.013638049364089966
The generated pressure mean: 0.4474776089191437
loss_pred:0.02673155441880226, decouple_loss:0.014065404422581196
Iteration: 1108, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44793662428855896
loss_pred:0.02558828517794609, decouple_loss:0.01337497215718031
The generated pressure mean: 0.4476096034049988
loss_pred:0.0259954035282135, decouple_loss:0.013764680363237858
The generated pressure mean: 0.4474453926086426
loss_pred:0.025952793657779694, decouple_loss:0.013844791799783707
Iteration: 1109, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4484231173992157
loss_pred:0.026338892057538033, decouple_loss:0.013189516961574554
The generated pressure mean: 0.4485883116722107
loss_pred:0.027806101366877556, decouple_loss:0.01334258820861578
The generated pressure mean: 0.4485749304294586
loss_pred:0.02914068102836609, decouple_loss:0.013886365108191967
Iteration: 1110, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4479455053806305
loss_pred:0.025256449356675148, decouple_loss:0.012724671512842178
The generated pressure mean: 0.4489496350288391
loss_pred:0.026396887376904488, decouple_loss:0.012749002315104008
The generated pressure mean: 0.44882193207740784
loss_pred:0.027026766911149025, decouple_loss:0.012591912411153316
2023-04-16 05:27:02 testing...
The generated pressure mean: 0.449788898229599
The generated pressure mean: 0.4495830535888672
The generated pressure mean: 0.44987666606903076
loss_pred:0.03405756503343582, decouple_loss:0.013482389971613884
loss_pred:0.03328434005379677, decouple_loss:0.013395960442721844
loss_pred:0.033176012337207794, decouple_loss:0.013362734578549862
Loss: 0.03417665883898735, avg_mse: 0.04228321835398674
current test mse: 0.042283
Iteration: 1111, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4487764537334442
loss_pred:0.028625493869185448, decouple_loss:0.013547994196414948
The generated pressure mean: 0.44858604669570923
loss_pred:0.02622157149016857, decouple_loss:0.013766082935035229
The generated pressure mean: 0.4486697316169739
loss_pred:0.026929734274744987, decouple_loss:0.014088270254433155
Iteration: 1112, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4479890465736389
loss_pred:0.026434224098920822, decouple_loss:0.013596062548458576
The generated pressure mean: 0.44852012395858765
loss_pred:0.02670201286673546, decouple_loss:0.013645785860717297
The generated pressure mean: 0.44945159554481506
loss_pred:0.026645828038454056, decouple_loss:0.013466814532876015
Iteration: 1113, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4501950442790985
loss_pred:0.02688041515648365, decouple_loss:0.013856405392289162
The generated pressure mean: 0.4485423266887665
The generated pressure mean: 0.44865065813064575
loss_pred:0.026696033775806427, decouple_loss:0.013755898922681808
loss_pred:0.025347596034407616, decouple_loss:0.013747687451541424
Iteration: 1114, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44868409633636475
loss_pred:0.027094213292002678, decouple_loss:0.013574597425758839
The generated pressure mean: 0.4488055109977722
loss_pred:0.02721034735441208, decouple_loss:0.013202493079006672
The generated pressure mean: 0.44784510135650635
loss_pred:0.026261769235134125, decouple_loss:0.01373316626995802
Iteration: 1115, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44895660877227783
loss_pred:0.024997271597385406, decouple_loss:0.013309559784829617
The generated pressure mean: 0.4481617510318756
loss_pred:0.026573821902275085, decouple_loss:0.013284808024764061
The generated pressure mean: 0.4491707384586334
loss_pred:0.025920040905475616, decouple_loss:0.013941335491836071
Iteration: 1116, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44761672616004944
loss_pred:0.025621024891734123, decouple_loss:0.014044910669326782
The generated pressure mean: 0.4484126567840576
loss_pred:0.0255875401198864, decouple_loss:0.014245984144508839
The generated pressure mean: 0.4480856955051422
loss_pred:0.02720724232494831, decouple_loss:0.014372006990015507
Iteration: 1117, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44770827889442444
loss_pred:0.026767248287796974, decouple_loss:0.013169492594897747
The generated pressure mean: 0.4483506977558136
loss_pred:0.026896588504314423, decouple_loss:0.01336277462542057
The generated pressure mean: 0.44897907972335815
loss_pred:0.02530812658369541, decouple_loss:0.013418390415608883
Iteration: 1118, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4487152099609375
loss_pred:0.025487219914793968, decouple_loss:0.013955075293779373
The generated pressure mean: 0.4484025537967682
loss_pred:0.026123253628611565, decouple_loss:0.013981098309159279
The generated pressure mean: 0.44971179962158203
loss_pred:0.02643919736146927, decouple_loss:0.013888826593756676
Iteration: 1119, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4476868510246277
loss_pred:0.02677840366959572, decouple_loss:0.013590434566140175
The generated pressure mean: 0.4487597346305847
loss_pred:0.026188479736447334, decouple_loss:0.013267613016068935
The generated pressure mean: 0.44840681552886963
loss_pred:0.025555964559316635, decouple_loss:0.013605685904622078
Iteration: 1120, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4481750428676605
The generated pressure mean: 0.44808343052864075
loss_pred:0.024582896381616592, decouple_loss:0.011917829513549805
loss_pred:0.02605043724179268, decouple_loss:0.012008531019091606
The generated pressure mean: 0.44792136549949646
loss_pred:0.024988042190670967, decouple_loss:0.012140230275690556
2023-04-16 05:28:56 testing...
The generated pressure mean: 0.4495830535888672
The generated pressure mean: 0.4497888684272766
The generated pressure mean: 0.44987666606903076
loss_pred:0.03394201025366783, decouple_loss:0.012498512864112854
loss_pred:0.03463462367653847, decouple_loss:0.012729172594845295
loss_pred:0.033502090722322464, decouple_loss:0.01250662561506033
Loss: 0.03465515002608299, avg_mse: 0.043640173971652985
current test mse: 0.04364
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012020_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012020_3_24hr.npz
NaN value num: 0
Iteration: 1121, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45015162229537964
loss_pred:0.02724873647093773, decouple_loss:0.01264762319624424
The generated pressure mean: 0.45044729113578796
The generated pressure mean: 0.4497753977775574
loss_pred:0.025930728763341904, decouple_loss:0.012572661973536015
loss_pred:0.027207747101783752, decouple_loss:0.012741408310830593
Iteration: 1122, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44990208745002747
The generated pressure mean: 0.4493504762649536
loss_pred:0.02715153619647026, decouple_loss:0.012178081087768078
loss_pred:0.025022568181157112, decouple_loss:0.012259229086339474
The generated pressure mean: 0.449248343706131
loss_pred:0.02603648230433464, decouple_loss:0.012200548313558102
Iteration: 1123, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4492187201976776
The generated pressure mean: 0.4487125277519226The generated pressure mean: 0.4489012062549591
loss_pred:0.026845131069421768, decouple_loss:0.011953028850257397
loss_pred:0.02586001344025135, decouple_loss:0.012070327997207642
loss_pred:0.02640349417924881, decouple_loss:0.012058638036251068
Iteration: 1124, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4508281350135803
loss_pred:0.026151606813073158, decouple_loss:0.01207141112536192
The generated pressure mean: 0.4481290280818939
The generated pressure mean: 0.4491356611251831
loss_pred:0.027698498219251633, decouple_loss:0.01194138452410698
loss_pred:0.02866780385375023, decouple_loss:0.01207101158797741
Iteration: 1125, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4493243396282196
The generated pressure mean: 0.450380802154541
loss_pred:0.026256892830133438, decouple_loss:0.012826909311115742
loss_pred:0.028663765639066696, decouple_loss:0.012774784117937088
The generated pressure mean: 0.4507772922515869
loss_pred:0.024838747456669807, decouple_loss:0.012913820333778858
Iteration: 1126, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4501035213470459
loss_pred:0.02670898474752903, decouple_loss:0.012246975675225258
The generated pressure mean: 0.4507172703742981
loss_pred:0.025972437113523483, decouple_loss:0.012286515906453133
The generated pressure mean: 0.44966641068458557
loss_pred:0.027160437777638435, decouple_loss:0.012450166046619415
Iteration: 1127, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4502818286418915
loss_pred:0.026774968951940536, decouple_loss:0.012356853112578392
The generated pressure mean: 0.4494032561779022
loss_pred:0.02443196251988411, decouple_loss:0.012206205166876316
The generated pressure mean: 0.44861218333244324
loss_pred:0.026047969236969948, decouple_loss:0.012238476425409317
Iteration: 1128, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45068731904029846
loss_pred:0.026360929012298584, decouple_loss:0.01205844059586525
The generated pressure mean: 0.44988805055618286
loss_pred:0.02556428872048855, decouple_loss:0.011985063552856445
The generated pressure mean: 0.45010730624198914
loss_pred:0.025467529892921448, decouple_loss:0.012007186189293861
Iteration: 1129, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44925618171691895
loss_pred:0.026791153475642204, decouple_loss:0.012470432557165623
The generated pressure mean: 0.4493504762649536
loss_pred:0.02585071325302124, decouple_loss:0.012420049868524075
The generated pressure mean: 0.4506218135356903
loss_pred:0.02486792393028736, decouple_loss:0.012166077271103859
Iteration: 1130, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4503428041934967
loss_pred:0.025336401537060738, decouple_loss:0.011448144912719727
The generated pressure mean: 0.4504680335521698
loss_pred:0.027238138020038605, decouple_loss:0.01160451676696539
The generated pressure mean: 0.4505954086780548
loss_pred:0.025898605585098267, decouple_loss:0.01185169629752636
2023-04-16 05:31:27 testing...
The generated pressure mean: 0.4495830535888672
The generated pressure mean: 0.4497888684272766
The generated pressure mean: 0.44987666606903076
loss_pred:0.0342835895717144, decouple_loss:0.011345363222062588
loss_pred:0.035346563905477524, decouple_loss:0.011393014341592789
loss_pred:0.03426733613014221, decouple_loss:0.011566158384084702
Loss: 0.035204239189624786, avg_mse: 0.04531756415963173
current test mse: 0.045318
Iteration: 1131, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45008423924446106
loss_pred:0.029690701514482498, decouple_loss:0.01112596970051527
The generated pressure mean: 0.45014554262161255
loss_pred:0.025645991787314415, decouple_loss:0.011522873304784298
The generated pressure mean: 0.44969961047172546
loss_pred:0.025511479005217552, decouple_loss:0.011099287308752537
Iteration: 1132, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4505214989185333
loss_pred:0.027355613186955452, decouple_loss:0.01113712228834629
The generated pressure mean: 0.4496549367904663
The generated pressure mean: 0.4501695930957794
loss_pred:0.025971706956624985, decouple_loss:0.011420690454542637
loss_pred:0.0262208953499794, decouple_loss:0.011217931285500526
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1133, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4498020112514496
loss_pred:0.0260542593896389, decouple_loss:0.01090768352150917
The generated pressure mean: 0.44958534836769104
The generated pressure mean: 0.4507904052734375
loss_pred:0.025670597329735756, decouple_loss:0.011056357063353062
loss_pred:0.02612825110554695, decouple_loss:0.010850776918232441
Iteration: 1134, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44868531823158264
loss_pred:0.027315936982631683, decouple_loss:0.011940841563045979
The generated pressure mean: 0.4487113654613495
The generated pressure mean: 0.44904807209968567
loss_pred:0.025111351162195206, decouple_loss:0.01200498640537262
loss_pred:0.024991432204842567, decouple_loss:0.01193210482597351
Iteration: 1135, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4482152760028839
loss_pred:0.02743261680006981, decouple_loss:0.012844899669289589
The generated pressure mean: 0.44947320222854614
The generated pressure mean: 0.4502379894256592
loss_pred:0.026266394183039665, decouple_loss:0.012778591364622116
loss_pred:0.02537166140973568, decouple_loss:0.012629615142941475
Iteration: 1136, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4494397044181824
loss_pred:0.025964222848415375, decouple_loss:0.011726520955562592
The generated pressure mean: 0.4493340849876404
loss_pred:0.02635127678513527, decouple_loss:0.0118336770683527
The generated pressure mean: 0.45013517141342163
loss_pred:0.02597171999514103, decouple_loss:0.011699235998094082
Iteration: 1137, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4499345123767853
loss_pred:0.02856234647333622, decouple_loss:0.011360838077962399
The generated pressure mean: 0.4496612548828125
The generated pressure mean: 0.44896915555000305
loss_pred:0.025774307548999786, decouple_loss:0.011047875508666039
loss_pred:0.025073643773794174, decouple_loss:0.010933817364275455
Iteration: 1138, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.449557900428772
loss_pred:0.024870332330465317, decouple_loss:0.01225794292986393
The generated pressure mean: 0.45025718212127686
loss_pred:0.02681453712284565, decouple_loss:0.012610371224582195
The generated pressure mean: 0.44940632581710815
loss_pred:0.025049591436982155, decouple_loss:0.012321565300226212
Iteration: 1139, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4498622715473175
loss_pred:0.024653224274516106, decouple_loss:0.011343694292008877
The generated pressure mean: 0.45019662380218506
The generated pressure mean: 0.4497264325618744
loss_pred:0.02560763992369175, decouple_loss:0.011562331579625607
loss_pred:0.024272391572594643, decouple_loss:0.011190365999937057
Iteration: 1140, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4491085112094879
loss_pred:0.026150040328502655, decouple_loss:0.011932446621358395
The generated pressure mean: 0.4493539035320282
loss_pred:0.025477595627307892, decouple_loss:0.011998111382126808
The generated pressure mean: 0.45123490691185
loss_pred:0.025010380893945694, decouple_loss:0.012134019285440445
2023-04-16 05:33:20 testing...
The generated pressure mean: 0.4495830535888672
The generated pressure mean: 0.449788898229599
The generated pressure mean: 0.44987666606903076
loss_pred:0.03184007108211517, decouple_loss:0.011729047633707523
loss_pred:0.0333113856613636, decouple_loss:0.011710367165505886
loss_pred:0.0316152349114418, decouple_loss:0.01182706281542778
Loss: 0.03284333646297455, avg_mse: 0.04082478582859039
current test mse: 0.040825
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012013_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012013_3_24hr.npz
NaN value num: 0
Iteration: 1141, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44773462414741516
loss_pred:0.02527458406984806, decouple_loss:0.011851850897073746
The generated pressure mean: 0.4466029703617096
loss_pred:0.0244979877024889, decouple_loss:0.011884337291121483
The generated pressure mean: 0.445743203163147
loss_pred:0.025042446330189705, decouple_loss:0.011645234189927578
Iteration: 1142, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44658491015434265
loss_pred:0.024778157472610474, decouple_loss:0.011144183576107025
The generated pressure mean: 0.4466501772403717
loss_pred:0.027397429570555687, decouple_loss:0.01119204331189394
The generated pressure mean: 0.44654762744903564
loss_pred:0.025873947888612747, decouple_loss:0.011093898676335812
Iteration: 1143, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.447590172290802The generated pressure mean: 0.44626617431640625
loss_pred:0.026789328083395958, decouple_loss:0.012209868989884853
loss_pred:0.024535082280635834, decouple_loss:0.01181090995669365
The generated pressure mean: 0.4475097358226776
loss_pred:0.026076797395944595, decouple_loss:0.012341827154159546
Iteration: 1144, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4464870095252991
The generated pressure mean: 0.4467817544937134
loss_pred:0.026248618960380554, decouple_loss:0.011439823545515537
loss_pred:0.026619866490364075, decouple_loss:0.01161463838070631
The generated pressure mean: 0.44708752632141113
loss_pred:0.024538569152355194, decouple_loss:0.01171640120446682
Iteration: 1145, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4474700093269348
The generated pressure mean: 0.4472411274909973
loss_pred:0.02554195001721382, decouple_loss:0.011105016805231571
loss_pred:0.024675654247403145, decouple_loss:0.01117903832346201
The generated pressure mean: 0.44590476155281067
loss_pred:0.024635761976242065, decouple_loss:0.010973194614052773
Iteration: 1146, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44725653529167175
The generated pressure mean: 0.4456627666950226
loss_pred:0.024729469791054726, decouple_loss:0.010495235212147236
loss_pred:0.026490407064557076, decouple_loss:0.010547200217843056
The generated pressure mean: 0.44771623611450195
loss_pred:0.024363072589039803, decouple_loss:0.010787914507091045
Iteration: 1147, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44666650891304016
The generated pressure mean: 0.4473629295825958
loss_pred:0.02579796500504017, decouple_loss:0.011141756549477577
loss_pred:0.025359824299812317, decouple_loss:0.011049467138946056
The generated pressure mean: 0.4461185932159424
loss_pred:0.026325205340981483, decouple_loss:0.011289621703326702
Iteration: 1148, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4463469684123993
loss_pred:0.02466459944844246, decouple_loss:0.013446610420942307
The generated pressure mean: 0.4458150565624237
loss_pred:0.025431349873542786, decouple_loss:0.013273379765450954
The generated pressure mean: 0.4465186297893524
loss_pred:0.025490615516901016, decouple_loss:0.013326063752174377
Iteration: 1149, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44704368710517883
The generated pressure mean: 0.4475697875022888
loss_pred:0.02489824779331684, decouple_loss:0.011811993084847927
loss_pred:0.02391732670366764, decouple_loss:0.011599276214838028
The generated pressure mean: 0.446501761674881
loss_pred:0.025630291551351547, decouple_loss:0.011624369770288467
Iteration: 1150, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4459882080554962
The generated pressure mean: 0.44624581933021545
loss_pred:0.025944149121642113, decouple_loss:0.01117594912648201
loss_pred:0.025133905932307243, decouple_loss:0.011157453991472721
The generated pressure mean: 0.4476163685321808
loss_pred:0.026348566636443138, decouple_loss:0.01161160971969366
2023-04-16 05:36:00 testing...
The generated pressure mean: 0.449788898229599
The generated pressure mean: 0.4495830535888672
The generated pressure mean: 0.44987666606903076
loss_pred:0.0321650467813015, decouple_loss:0.012735082767903805
loss_pred:0.031142644584178925, decouple_loss:0.012822235934436321
loss_pred:0.030777083709836006, decouple_loss:0.012710517272353172
Loss: 0.031999390572309494, avg_mse: 0.03908509016036987
current test mse: 0.039085
Iteration: 1151, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4465055465698242
The generated pressure mean: 0.4469921588897705
loss_pred:0.024902304634451866, decouple_loss:0.012950081378221512
loss_pred:0.026830578222870827, decouple_loss:0.012455250136554241
The generated pressure mean: 0.4472186267375946
loss_pred:0.02571750618517399, decouple_loss:0.012552476488053799
Iteration: 1152, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44695645570755005
loss_pred:0.024235326796770096, decouple_loss:0.011182546615600586
The generated pressure mean: 0.44697561860084534
loss_pred:0.02471405267715454, decouple_loss:0.011306998319923878
The generated pressure mean: 0.44724833965301514
loss_pred:0.024968715384602547, decouple_loss:0.011414160951972008
Iteration: 1153, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44661709666252136
loss_pred:0.02613343670964241, decouple_loss:0.01096627488732338
The generated pressure mean: 0.44622835516929626
loss_pred:0.02750340662896633, decouple_loss:0.010972936637699604
The generated pressure mean: 0.44677552580833435
loss_pred:0.02500656060874462, decouple_loss:0.010852758772671223
Iteration: 1154, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4476061463356018
loss_pred:0.02523692697286606, decouple_loss:0.011997443623840809
The generated pressure mean: 0.44652870297431946
loss_pred:0.024302637204527855, decouple_loss:0.011530213989317417
The generated pressure mean: 0.447532594203949
loss_pred:0.027045445516705513, decouple_loss:0.011360911652445793
Iteration: 1155, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44795098900794983
loss_pred:0.025439172983169556, decouple_loss:0.011926023289561272
The generated pressure mean: 0.44697147607803345
The generated pressure mean: 0.44674405455589294
loss_pred:0.02535453625023365, decouple_loss:0.012151844799518585
loss_pred:0.02595740742981434, decouple_loss:0.011674176901578903
Iteration: 1156, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4474562704563141
loss_pred:0.02589789777994156, decouple_loss:0.010996567085385323
The generated pressure mean: 0.44630762934684753
loss_pred:0.023371025919914246, decouple_loss:0.011182925663888454
The generated pressure mean: 0.4465397000312805
loss_pred:0.025561517104506493, decouple_loss:0.01136744488030672
Iteration: 1157, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44784969091415405
loss_pred:0.025286268442869186, decouple_loss:0.013205859810113907
The generated pressure mean: 0.4474033713340759
loss_pred:0.025644535198807716, decouple_loss:0.012661292217671871
The generated pressure mean: 0.4455907940864563
loss_pred:0.024707861244678497, decouple_loss:0.012858366593718529
Iteration: 1158, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44697436690330505
loss_pred:0.024703750386834145, decouple_loss:0.01148886326700449
The generated pressure mean: 0.4470585882663727
loss_pred:0.024539818987250328, decouple_loss:0.011449838988482952
The generated pressure mean: 0.44701579213142395
loss_pred:0.02436644397675991, decouple_loss:0.011421463452279568
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1159, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44607841968536377
loss_pred:0.027721213176846504, decouple_loss:0.01094973087310791
The generated pressure mean: 0.4467221796512604
loss_pred:0.025282740592956543, decouple_loss:0.011129879392683506
The generated pressure mean: 0.44710981845855713
loss_pred:0.02571817860007286, decouple_loss:0.010885481722652912
Iteration: 1160, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4462556838989258
loss_pred:0.025601452216506004, decouple_loss:0.010976087301969528
The generated pressure mean: 0.44720005989074707
loss_pred:0.025461306795477867, decouple_loss:0.010861548595130444
The generated pressure mean: 0.44668835401535034
loss_pred:0.024855056777596474, decouple_loss:0.010684166103601456
2023-04-16 05:37:53 testing...
The generated pressure mean: 0.4495830535888672
The generated pressure mean: 0.449788898229599
The generated pressure mean: 0.44987666606903076
loss_pred:0.03261931985616684, decouple_loss:0.010763068683445454
loss_pred:0.03310776501893997, decouple_loss:0.010676401667296886
loss_pred:0.03240416571497917, decouple_loss:0.01077889371663332
Loss: 0.033247388899326324, avg_mse: 0.04182291775941849
current test mse: 0.041823
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012014_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012014_3_24hr.npz
NaN value num: 0
Iteration: 1161, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44775915145874023
loss_pred:0.026249583810567856, decouple_loss:0.011227096430957317
The generated pressure mean: 0.44722214341163635
loss_pred:0.02530435286462307, decouple_loss:0.0104741295799613
The generated pressure mean: 0.44612351059913635
loss_pred:0.027133800089359283, decouple_loss:0.010441186837852001
Iteration: 1162, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44758832454681396
The generated pressure mean: 0.4466997981071472
loss_pred:0.025950541719794273, decouple_loss:0.01108902134001255
loss_pred:0.02718418277800083, decouple_loss:0.011113841086626053
The generated pressure mean: 0.4472610652446747
loss_pred:0.025553377345204353, decouple_loss:0.011067391373217106
Iteration: 1163, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44754457473754883
loss_pred:0.02469833940267563, decouple_loss:0.010752284899353981
The generated pressure mean: 0.44838187098503113
loss_pred:0.026912257075309753, decouple_loss:0.011358082294464111
The generated pressure mean: 0.44696977734565735
loss_pred:0.024858947843313217, decouple_loss:0.011002663522958755
Iteration: 1164, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.447384238243103
loss_pred:0.025018220767378807, decouple_loss:0.013744927011430264
The generated pressure mean: 0.4483383893966675
loss_pred:0.024826576933264732, decouple_loss:0.013115499168634415
The generated pressure mean: 0.4488472044467926
loss_pred:0.0244598388671875, decouple_loss:0.012935769744217396
Iteration: 1165, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44658082723617554
loss_pred:0.024434033781290054, decouple_loss:0.011702415533363819
The generated pressure mean: 0.4475630521774292
loss_pred:0.02609676495194435, decouple_loss:0.01210070587694645
The generated pressure mean: 0.44744864106178284
loss_pred:0.026329360902309418, decouple_loss:0.011787130497395992
Iteration: 1166, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44873046875
loss_pred:0.025970537215471268, decouple_loss:0.014918799512088299
The generated pressure mean: 0.4478708803653717
loss_pred:0.024962948635220528, decouple_loss:0.014767258428037167
The generated pressure mean: 0.4473441243171692
loss_pred:0.026755863800644875, decouple_loss:0.01478706393390894
Iteration: 1167, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44807589054107666
loss_pred:0.025421833619475365, decouple_loss:0.013408160768449306
The generated pressure mean: 0.4477446675300598
loss_pred:0.024046825245022774, decouple_loss:0.013432328589260578
The generated pressure mean: 0.447806179523468
loss_pred:0.024734491482377052, decouple_loss:0.013519068248569965
Iteration: 1168, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44683802127838135
loss_pred:0.025164561346173286, decouple_loss:0.012569713406264782
The generated pressure mean: 0.44783875346183777
loss_pred:0.02570801042020321, decouple_loss:0.012208882719278336
The generated pressure mean: 0.4479805529117584
loss_pred:0.02674580179154873, decouple_loss:0.012172667309641838
Iteration: 1169, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44712865352630615
loss_pred:0.02604292519390583, decouple_loss:0.012089747935533524
The generated pressure mean: 0.4481663703918457
loss_pred:0.026158416643738747, decouple_loss:0.012151466682553291
The generated pressure mean: 0.4476584494113922
loss_pred:0.025144018232822418, decouple_loss:0.012303455732762814
Iteration: 1170, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44780266284942627
loss_pred:0.025357985869050026, decouple_loss:0.012237307615578175
The generated pressure mean: 0.44706377387046814
loss_pred:0.025006841868162155, decouple_loss:0.012463732622563839
The generated pressure mean: 0.447736531496048
loss_pred:0.0266558937728405, decouple_loss:0.012198462150990963
2023-04-16 05:40:23 testing...
The generated pressure mean: 0.4497888684272766
The generated pressure mean: 0.4495830535888672
The generated pressure mean: 0.44987666606903076
loss_pred:0.03358713164925575, decouple_loss:0.011613057926297188
loss_pred:0.03237421065568924, decouple_loss:0.011305714957416058
loss_pred:0.03166478872299194, decouple_loss:0.011553553864359856
Loss: 0.03311658650636673, avg_mse: 0.04163603112101555
current test mse: 0.041636
Iteration: 1171, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4477286636829376
The generated pressure mean: 0.4489087164402008
loss_pred:0.025052737444639206, decouple_loss:0.01141086220741272
loss_pred:0.026101715862751007, decouple_loss:0.011631609871983528
The generated pressure mean: 0.447527676820755
loss_pred:0.02527398243546486, decouple_loss:0.011558443307876587
Iteration: 1172, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44822147488594055
The generated pressure mean: 0.44856178760528564
loss_pred:0.024814825505018234, decouple_loss:0.012650593183934689
loss_pred:0.024594413116574287, decouple_loss:0.012857847847044468
The generated pressure mean: 0.44737327098846436
loss_pred:0.02494855783879757, decouple_loss:0.012748844921588898
Iteration: 1173, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4475401043891907
loss_pred:0.024011382833123207, decouple_loss:0.012395351193845272
The generated pressure mean: 0.4482654631137848
loss_pred:0.025873541831970215, decouple_loss:0.012305586598813534
The generated pressure mean: 0.4473603069782257
loss_pred:0.026051148772239685, decouple_loss:0.012333170510828495
Iteration: 1174, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44831040501594543
loss_pred:0.024304740130901337, decouple_loss:0.012583018280565739
The generated pressure mean: 0.4471328556537628
loss_pred:0.024719545617699623, decouple_loss:0.01286236010491848
The generated pressure mean: 0.4468141496181488
loss_pred:0.026811012998223305, decouple_loss:0.012530406005680561
Iteration: 1175, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4477505385875702
loss_pred:0.026848476380109787, decouple_loss:0.010997170582413673
The generated pressure mean: 0.44900867342948914
loss_pred:0.02606208808720112, decouple_loss:0.011072050780057907
The generated pressure mean: 0.4474266767501831
loss_pred:0.025131825357675552, decouple_loss:0.011059695854783058
Iteration: 1176, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44766926765441895
The generated pressure mean: 0.44617268443107605
loss_pred:0.02505185455083847, decouple_loss:0.011056019924581051
loss_pred:0.026445940136909485, decouple_loss:0.011069576255977154
The generated pressure mean: 0.4482875466346741
loss_pred:0.024694737046957016, decouple_loss:0.010892564430832863
Iteration: 1177, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4478815495967865The generated pressure mean: 0.44694724678993225
loss_pred:0.025084178894758224, decouple_loss:0.010778547264635563
loss_pred:0.024803487583994865, decouple_loss:0.011067545041441917
The generated pressure mean: 0.4472653269767761
loss_pred:0.024964040145277977, decouple_loss:0.010711564682424068
Iteration: 1178, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4477112889289856
The generated pressure mean: 0.44761139154434204
loss_pred:0.02604626677930355, decouple_loss:0.012403184548020363
loss_pred:0.026340879499912262, decouple_loss:0.012604447081685066
The generated pressure mean: 0.4471362233161926
loss_pred:0.02612701803445816, decouple_loss:0.012769853696227074
Iteration: 1179, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4482972323894501
The generated pressure mean: 0.4473407566547394
loss_pred:0.026198269799351692, decouple_loss:0.012934013269841671
loss_pred:0.02585603855550289, decouple_loss:0.012937655672430992
The generated pressure mean: 0.4472672641277313
loss_pred:0.026196343824267387, decouple_loss:0.012836112640798092
Iteration: 1180, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4474486708641052
The generated pressure mean: 0.44723835587501526
loss_pred:0.025300920009613037, decouple_loss:0.011954951100051403
loss_pred:0.02509751170873642, decouple_loss:0.012231792323291302
The generated pressure mean: 0.4477596580982208
loss_pred:0.02572035789489746, decouple_loss:0.01193196326494217
2023-04-16 05:42:16 testing...
The generated pressure mean: 0.449788898229599
The generated pressure mean: 0.4495830535888672
The generated pressure mean: 0.44987666606903076
loss_pred:0.03277008980512619, decouple_loss:0.011300025507807732
loss_pred:0.03351818770170212, decouple_loss:0.011329811997711658
loss_pred:0.03272847458720207, decouple_loss:0.011468549259006977
Loss: 0.03357389196753502, avg_mse: 0.04253670573234558
current test mse: 0.042537
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012012_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012012_3_24hr.npz
NaN value num: 0
Iteration: 1181, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4475893974304199
loss_pred:0.02444830909371376, decouple_loss:0.01167834922671318
The generated pressure mean: 0.4480898678302765
The generated pressure mean: 0.4460238814353943
loss_pred:0.026231104508042336, decouple_loss:0.0118655264377594
loss_pred:0.026421617716550827, decouple_loss:0.011799381114542484
Iteration: 1182, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4468630850315094
The generated pressure mean: 0.44724735617637634
loss_pred:0.02698192000389099, decouple_loss:0.011960219591856003
loss_pred:0.024936910718679428, decouple_loss:0.012093419209122658
The generated pressure mean: 0.44683948159217834
loss_pred:0.024956870824098587, decouple_loss:0.012158866971731186
Iteration: 1183, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4484224021434784
The generated pressure mean: 0.4461709260940552
loss_pred:0.02549743838608265, decouple_loss:0.012347604148089886
loss_pred:0.028222206979990005, decouple_loss:0.012478343211114407
The generated pressure mean: 0.4469147324562073
loss_pred:0.02510800212621689, decouple_loss:0.01223986130207777
Iteration: 1184, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4468006491661072
The generated pressure mean: 0.447511225938797
loss_pred:0.024844171479344368, decouple_loss:0.012060684151947498
loss_pred:0.0252513624727726, decouple_loss:0.012747817672789097
The generated pressure mean: 0.446971595287323
loss_pred:0.025506850332021713, decouple_loss:0.012057053856551647
Iteration: 1185, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4470824897289276
The generated pressure mean: 0.4469561278820038
loss_pred:0.02287238836288452, decouple_loss:0.011250641196966171
loss_pred:0.025020238012075424, decouple_loss:0.012010633945465088
The generated pressure mean: 0.4467621445655823
loss_pred:0.024244317784905434, decouple_loss:0.01130656711757183
Iteration: 1186, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44733887910842896
The generated pressure mean: 0.44653886556625366
loss_pred:0.02563299983739853, decouple_loss:0.01238227728754282
loss_pred:0.025055017322301865, decouple_loss:0.01253173965960741
The generated pressure mean: 0.4468657076358795
loss_pred:0.025106165558099747, decouple_loss:0.012432022020220757
Iteration: 1187, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44771745800971985
loss_pred:0.025348225608468056, decouple_loss:0.011064503341913223
The generated pressure mean: 0.4467068910598755
loss_pred:0.025423139333724976, decouple_loss:0.01100678090006113
The generated pressure mean: 0.4470162093639374
loss_pred:0.024414001032710075, decouple_loss:0.011239963583648205
Iteration: 1188, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44670337438583374
loss_pred:0.024916136637330055, decouple_loss:0.01166348997503519
The generated pressure mean: 0.44802191853523254
loss_pred:0.026109604164958, decouple_loss:0.011597887612879276
The generated pressure mean: 0.4470779299736023
loss_pred:0.023890236392617226, decouple_loss:0.012095456942915916
Iteration: 1189, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44798222184181213
loss_pred:0.02419470250606537, decouple_loss:0.013321442529559135
The generated pressure mean: 0.44719478487968445
loss_pred:0.023837096989154816, decouple_loss:0.013212520629167557
The generated pressure mean: 0.4471054971218109
loss_pred:0.02415701374411583, decouple_loss:0.01323943305760622
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1190, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4478108584880829
loss_pred:0.02539902925491333, decouple_loss:0.01103671733289957
The generated pressure mean: 0.4471958875656128
loss_pred:0.02354680374264717, decouple_loss:0.01142285205423832
The generated pressure mean: 0.4473514258861542
loss_pred:0.024491215124726295, decouple_loss:0.011079964227974415
2023-04-16 05:44:45 testing...
The generated pressure mean: 0.4495830535888672
The generated pressure mean: 0.4497888684272766
The generated pressure mean: 0.44987666606903076
loss_pred:0.032506313174963, decouple_loss:0.011913125403225422
loss_pred:0.03333035111427307, decouple_loss:0.012017438188195229
loss_pred:0.03235791251063347, decouple_loss:0.01189140509814024
Loss: 0.03332855924963951, avg_mse: 0.04209205508232117
current test mse: 0.042092
Iteration: 1191, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44709211587905884
The generated pressure mean: 0.4476472735404968
loss_pred:0.024091195315122604, decouple_loss:0.011950907297432423
loss_pred:0.024842532351613045, decouple_loss:0.011700024828314781
The generated pressure mean: 0.44625112414360046
loss_pred:0.02739163115620613, decouple_loss:0.011732719838619232
Iteration: 1192, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4471133351325989
The generated pressure mean: 0.4471782445907593
loss_pred:0.02361142635345459, decouple_loss:0.011396963149309158
loss_pred:0.025266334414482117, decouple_loss:0.011515996418893337
The generated pressure mean: 0.44644370675086975
loss_pred:0.024176955223083496, decouple_loss:0.011326533742249012
Iteration: 1193, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44654273986816406
The generated pressure mean: 0.44882553815841675loss_pred:0.025018850341439247, decouple_loss:0.010414037853479385
loss_pred:0.023644547909498215, decouple_loss:0.010594419203698635
The generated pressure mean: 0.4470537006855011
loss_pred:0.024724651128053665, decouple_loss:0.010646657086908817
Iteration: 1194, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4460422694683075
The generated pressure mean: 0.4467619061470032
loss_pred:0.024852583184838295, decouple_loss:0.011062524281442165
loss_pred:0.02565225027501583, decouple_loss:0.011097636073827744
The generated pressure mean: 0.4465208947658539
loss_pred:0.02481878735125065, decouple_loss:0.011374491266906261
Iteration: 1195, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4468706548213959
loss_pred:0.025970710441470146, decouple_loss:0.011194581165909767
The generated pressure mean: 0.44785258173942566
loss_pred:0.026538416743278503, decouple_loss:0.011220699176192284
The generated pressure mean: 0.4460998475551605
loss_pred:0.025826456025242805, decouple_loss:0.011326086707413197
Iteration: 1196, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4478234350681305
loss_pred:0.024431943893432617, decouple_loss:0.010971265845000744
The generated pressure mean: 0.4458525478839874
loss_pred:0.02478206716477871, decouple_loss:0.010647258721292019
The generated pressure mean: 0.4460639953613281
loss_pred:0.024593738839030266, decouple_loss:0.010874464176595211
Iteration: 1197, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4462994635105133
loss_pred:0.0252548661082983, decouple_loss:0.010948975570499897
The generated pressure mean: 0.4473232924938202
loss_pred:0.025252480059862137, decouple_loss:0.011059822514653206
The generated pressure mean: 0.4461408257484436
loss_pred:0.02636704035103321, decouple_loss:0.010987089946866035
Iteration: 1198, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4465855360031128
loss_pred:0.02623789571225643, decouple_loss:0.011238137260079384
The generated pressure mean: 0.44603610038757324
loss_pred:0.024284621700644493, decouple_loss:0.011150105856359005
The generated pressure mean: 0.4468885660171509
loss_pred:0.025170376524329185, decouple_loss:0.01094990037381649
Iteration: 1199, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4472261667251587
The generated pressure mean: 0.4459840953350067
loss_pred:0.025225332006812096, decouple_loss:0.010402382351458073
loss_pred:0.02591179683804512, decouple_loss:0.010346459224820137
The generated pressure mean: 0.44808536767959595
loss_pred:0.023986609652638435, decouple_loss:0.010505893267691135
Iteration: 1200, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4473579227924347
loss_pred:0.025141604244709015, decouple_loss:0.011068500578403473
The generated pressure mean: 0.4469868242740631
loss_pred:0.02404644899070263, decouple_loss:0.011192570440471172
The generated pressure mean: 0.44690945744514465
loss_pred:0.026265602558851242, decouple_loss:0.010823111049830914
2023-04-16 05:46:39 testing...
The generated pressure mean: 0.4495830535888672
The generated pressure mean: 0.449788898229599
The generated pressure mean: 0.44987666606903076
loss_pred:0.03277788683772087, decouple_loss:0.010885152034461498
loss_pred:0.033499013632535934, decouple_loss:0.0107719199731946
loss_pred:0.03261702135205269, decouple_loss:0.010974268428981304
Loss: 0.03350849449634552, avg_mse: 0.042599547654390335
current test mse: 0.0426
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012004_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012004_3_24hr.npz
NaN value num: 0
Iteration: 1201, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4483340084552765
loss_pred:0.024169806391000748, decouple_loss:0.011088904924690723
The generated pressure mean: 0.4486162066459656
loss_pred:0.024527542293071747, decouple_loss:0.01171225868165493
The generated pressure mean: 0.44761234521865845
loss_pred:0.02573144994676113, decouple_loss:0.011708368547260761
Iteration: 1202, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44872066378593445
The generated pressure mean: 0.44818660616874695loss_pred:0.025491492822766304, decouple_loss:0.011438059620559216
loss_pred:0.02491595596075058, decouple_loss:0.010684492066502571
The generated pressure mean: 0.44817599654197693
loss_pred:0.024144092574715614, decouple_loss:0.010607536882162094
Iteration: 1203, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4482540488243103
loss_pred:0.026891564950346947, decouple_loss:0.009995226748287678
The generated pressure mean: 0.4490843415260315
loss_pred:0.0241957176476717, decouple_loss:0.010204017162322998
The generated pressure mean: 0.4483143091201782
loss_pred:0.02470819279551506, decouple_loss:0.010383161716163158
Iteration: 1204, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45018258690834045
The generated pressure mean: 0.4482864737510681
loss_pred:0.026876194402575493, decouple_loss:0.010761436074972153
loss_pred:0.023918073624372482, decouple_loss:0.010610389523208141
The generated pressure mean: 0.44923391938209534
loss_pred:0.02460584230720997, decouple_loss:0.011085319332778454
Iteration: 1205, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4475911259651184
The generated pressure mean: 0.44727641344070435
loss_pred:0.02434578724205494, decouple_loss:0.011712849140167236
loss_pred:0.023380981758236885, decouple_loss:0.011788210831582546
The generated pressure mean: 0.44935524463653564
loss_pred:0.025038424879312515, decouple_loss:0.012143798172473907
Iteration: 1206, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44732072949409485
The generated pressure mean: 0.44656041264533997
loss_pred:0.024721253663301468, decouple_loss:0.012967752292752266
loss_pred:0.023125246167182922, decouple_loss:0.012996253557503223
The generated pressure mean: 0.44782358407974243
loss_pred:0.02691619098186493, decouple_loss:0.012947163544595242
Iteration: 1207, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4502047300338745
The generated pressure mean: 0.4479285478591919
loss_pred:0.024633634835481644, decouple_loss:0.011694797314703465
loss_pred:0.025185881182551384, decouple_loss:0.011882890947163105
The generated pressure mean: 0.44615504145622253
loss_pred:0.025292180478572845, decouple_loss:0.011708593927323818
Iteration: 1208, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4476674199104309
The generated pressure mean: 0.44962185621261597
loss_pred:0.02494097128510475, decouple_loss:0.01083491463214159
loss_pred:0.023975232616066933, decouple_loss:0.010516292415559292
The generated pressure mean: 0.44788697361946106
loss_pred:0.02384878695011139, decouple_loss:0.010363769717514515
Iteration: 1209, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4477931559085846
The generated pressure mean: 0.4482608139514923
loss_pred:0.0242264736443758, decouple_loss:0.011895296163856983
loss_pred:0.02362257055938244, decouple_loss:0.011962362565100193
The generated pressure mean: 0.44648703932762146
loss_pred:0.024267680943012238, decouple_loss:0.012067128904163837
Iteration: 1210, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44828712940216064
The generated pressure mean: 0.44748514890670776
loss_pred:0.024553706869482994, decouple_loss:0.01173204742372036
loss_pred:0.025505488738417625, decouple_loss:0.011898315511643887
The generated pressure mean: 0.447750449180603
loss_pred:0.02361634187400341, decouple_loss:0.011750342324376106
2023-04-16 05:49:09 testing...
The generated pressure mean: 0.4497888386249542
The generated pressure mean: 0.4495830833911896
The generated pressure mean: 0.44987666606903076
loss_pred:0.032935597002506256, decouple_loss:0.010954133234918118
loss_pred:0.031909290701150894, decouple_loss:0.011080719530582428
loss_pred:0.031178385019302368, decouple_loss:0.011189177632331848
Loss: 0.032561492174863815, avg_mse: 0.04086221382021904
current test mse: 0.040862
Iteration: 1211, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4487471878528595
The generated pressure mean: 0.44707104563713074
loss_pred:0.024079443886876106, decouple_loss:0.011564059183001518
loss_pred:0.02315930277109146, decouple_loss:0.010747748427093029
The generated pressure mean: 0.4487585425376892
loss_pred:0.024894384667277336, decouple_loss:0.011280089616775513
Iteration: 1212, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44850486516952515
The generated pressure mean: 0.4483461380004883
loss_pred:0.024403557181358337, decouple_loss:0.011843930929899216
loss_pred:0.023953309282660484, decouple_loss:0.011759934015572071
The generated pressure mean: 0.44796425104141235
loss_pred:0.02324417233467102, decouple_loss:0.012114637531340122
Iteration: 1213, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4481023848056793
The generated pressure mean: 0.44865864515304565
loss_pred:0.024025771766901016, decouple_loss:0.012645987793803215
loss_pred:0.02333553321659565, decouple_loss:0.012603424489498138
The generated pressure mean: 0.44837528467178345
loss_pred:0.0234602689743042, decouple_loss:0.012866516597568989
Iteration: 1214, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4477776288986206
loss_pred:0.024637578055262566, decouple_loss:0.010865013115108013
The generated pressure mean: 0.44756534695625305
loss_pred:0.024187618866562843, decouple_loss:0.011095092631876469
The generated pressure mean: 0.4467921853065491
loss_pred:0.023845309391617775, decouple_loss:0.011091937310993671
Iteration: 1215, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4481053054332733
The generated pressure mean: 0.44806262850761414
loss_pred:0.02448110654950142, decouple_loss:0.011538863182067871
loss_pred:0.023884987458586693, decouple_loss:0.011540536768734455
The generated pressure mean: 0.4488388001918793
loss_pred:0.025333473458886147, decouple_loss:0.01152422558516264
Iteration: 1216, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4463944733142853
loss_pred:0.024102643132209778, decouple_loss:0.013297916390001774
The generated pressure mean: 0.4486365020275116
loss_pred:0.0243112500756979, decouple_loss:0.012790298089385033
The generated pressure mean: 0.4508858323097229
loss_pred:0.024469690397381783, decouple_loss:0.012627748772501945
Iteration: 1217, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4480462074279785
The generated pressure mean: 0.44835537672042847
loss_pred:0.022902319207787514, decouple_loss:0.011191345751285553
loss_pred:0.02644219808280468, decouple_loss:0.01121675968170166
The generated pressure mean: 0.4475422203540802
loss_pred:0.025750262662768364, decouple_loss:0.011486521922051907
Iteration: 1218, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4473828375339508
The generated pressure mean: 0.4465106725692749
loss_pred:0.02360965870320797, decouple_loss:0.010549456812441349
loss_pred:0.02431194670498371, decouple_loss:0.010934710502624512
The generated pressure mean: 0.4487621486186981
loss_pred:0.024482786655426025, decouple_loss:0.010708256624639034
Iteration: 1219, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4484059512615204
The generated pressure mean: 0.44940853118896484
loss_pred:0.025060435757040977, decouple_loss:0.011493743397295475
loss_pred:0.02557683363556862, decouple_loss:0.011420604772865772
The generated pressure mean: 0.44871824979782104
loss_pred:0.025597894564270973, decouple_loss:0.011697623878717422
Iteration: 1220, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4478696584701538
The generated pressure mean: 0.44847527146339417
loss_pred:0.023211855441331863, decouple_loss:0.010367539711296558
loss_pred:0.024780133739113808, decouple_loss:0.010664951987564564
The generated pressure mean: 0.4487915635108948
loss_pred:0.025799773633480072, decouple_loss:0.010599777102470398
2023-04-16 05:51:02 testing...
The generated pressure mean: 0.449788898229599
The generated pressure mean: 0.4495830535888672
The generated pressure mean: 0.44987666606903076
loss_pred:0.031979355961084366, decouple_loss:0.011681978590786457
loss_pred:0.03152874484658241, decouple_loss:0.011621099896728992
loss_pred:0.0308524277061224, decouple_loss:0.011651860550045967
Loss: 0.03203609213232994, avg_mse: 0.039864249527454376
current test mse: 0.039864
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012002_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012002_3_24hr.npz
NaN value num: 0
Iteration: 1221, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4469147026538849
loss_pred:0.023862218484282494, decouple_loss:0.01163250021636486
The generated pressure mean: 0.44734761118888855
loss_pred:0.025197170674800873, decouple_loss:0.011671365238726139
The generated pressure mean: 0.4474261403083801
loss_pred:0.024498187005519867, decouple_loss:0.011992456391453743
Iteration: 1222, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44811615347862244
The generated pressure mean: 0.4490741789340973
loss_pred:0.024232206866145134, decouple_loss:0.012253989465534687
loss_pred:0.02403826080262661, decouple_loss:0.012726981192827225
The generated pressure mean: 0.4490821361541748
loss_pred:0.02451833337545395, decouple_loss:0.012794842943549156
Iteration: 1223, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44875746965408325
The generated pressure mean: 0.44862765073776245
loss_pred:0.025545800104737282, decouple_loss:0.010820018127560616
loss_pred:0.02371443621814251, decouple_loss:0.010875209234654903
The generated pressure mean: 0.4472696781158447
loss_pred:0.025687314569950104, decouple_loss:0.011091476306319237
Iteration: 1224, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45019304752349854The generated pressure mean: 0.4467901289463043
loss_pred:0.02387152425944805, decouple_loss:0.011501600965857506
loss_pred:0.028338735923171043, decouple_loss:0.012079691514372826
The generated pressure mean: 0.44856277108192444
loss_pred:0.02411995641887188, decouple_loss:0.011482159607112408
Iteration: 1225, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44961124658584595
The generated pressure mean: 0.44819748401641846loss_pred:0.02413768507540226, decouple_loss:0.012096323072910309
loss_pred:0.02510783076286316, decouple_loss:0.011983475647866726
The generated pressure mean: 0.4476976692676544
loss_pred:0.025535551831126213, decouple_loss:0.011795743368566036
Iteration: 1226, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4471129775047302
The generated pressure mean: 0.4472678005695343
loss_pred:0.025596728548407555, decouple_loss:0.01183046493679285
loss_pred:0.025399401783943176, decouple_loss:0.011735524982213974
The generated pressure mean: 0.45075008273124695
loss_pred:0.023944195359945297, decouple_loss:0.011568297632038593
Iteration: 1227, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.447256863117218
loss_pred:0.025834668427705765, decouple_loss:0.012404914014041424The generated pressure mean: 0.44798243045806885
loss_pred:0.023664984852075577, decouple_loss:0.01286408957093954
The generated pressure mean: 0.4487262964248657
loss_pred:0.02357742190361023, decouple_loss:0.012363654561340809
Iteration: 1228, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.448194295167923
The generated pressure mean: 0.4474162757396698
loss_pred:0.025090128183364868, decouple_loss:0.010731803253293037
loss_pred:0.02462039142847061, decouple_loss:0.010800221934914589
The generated pressure mean: 0.44743257761001587
loss_pred:0.0248643159866333, decouple_loss:0.010744530707597733
Iteration: 1229, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4488057792186737
The generated pressure mean: 0.4497550427913666
loss_pred:0.02544519118964672, decouple_loss:0.010614624246954918
loss_pred:0.024676134809851646, decouple_loss:0.010595396161079407
The generated pressure mean: 0.44975852966308594
loss_pred:0.026355190202593803, decouple_loss:0.010722939856350422
Iteration: 1230, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4493548274040222
The generated pressure mean: 0.44766315817832947
loss_pred:0.023731380701065063, decouple_loss:0.01072740275412798
loss_pred:0.025834882631897926, decouple_loss:0.010687930509448051
The generated pressure mean: 0.4488476812839508
loss_pred:0.022460952401161194, decouple_loss:0.011002271436154842
2023-04-16 05:53:32 testing...
The generated pressure mean: 0.4497888684272766
The generated pressure mean: 0.4495830535888672
The generated pressure mean: 0.44987666606903076
loss_pred:0.033130478113889694, decouple_loss:0.012865488417446613
loss_pred:0.03281039744615555, decouple_loss:0.012607862241566181
loss_pred:0.03247903659939766, decouple_loss:0.012908926233649254
Loss: 0.03344634547829628, avg_mse: 0.04258110374212265
current test mse: 0.042581
Iteration: 1231, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44840124249458313
loss_pred:0.025989511981606483, decouple_loss:0.012664147652685642
The generated pressure mean: 0.4476599097251892
loss_pred:0.02551230415701866, decouple_loss:0.012592043727636337
The generated pressure mean: 0.44836610555648804
loss_pred:0.025222353637218475, decouple_loss:0.012673070654273033
Iteration: 1232, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4479535222053528
The generated pressure mean: 0.44785282015800476
loss_pred:0.024494290351867676, decouple_loss:0.011004635132849216
loss_pred:0.02575831487774849, decouple_loss:0.010864836163818836
The generated pressure mean: 0.4486962556838989
loss_pred:0.024599021300673485, decouple_loss:0.010910378769040108
Iteration: 1233, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44755735993385315
The generated pressure mean: 0.4475484788417816
loss_pred:0.02456890419125557, decouple_loss:0.011559668928384781
loss_pred:0.026027074083685875, decouple_loss:0.011627458035945892
The generated pressure mean: 0.4516567587852478
loss_pred:0.023888040333986282, decouple_loss:0.011796506121754646
Iteration: 1234, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44979915022850037
The generated pressure mean: 0.4499562680721283
loss_pred:0.023871412500739098, decouple_loss:0.011560493148863316
loss_pred:0.023178014904260635, decouple_loss:0.011554304510354996
The generated pressure mean: 0.4490068554878235
loss_pred:0.022518426179885864, decouple_loss:0.012022379785776138
Iteration: 1235, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4478560984134674
The generated pressure mean: 0.44841745495796204
loss_pred:0.024594144895672798, decouple_loss:0.011425846256315708
loss_pred:0.025686509907245636, decouple_loss:0.01149347797036171
The generated pressure mean: 0.4486274719238281
loss_pred:0.0240252036601305, decouple_loss:0.01169532909989357
Iteration: 1236, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4500373601913452
The generated pressure mean: 0.4491240084171295
loss_pred:0.024472132325172424, decouple_loss:0.012060803361237049
loss_pred:0.022271275520324707, decouple_loss:0.012313451617956161
The generated pressure mean: 0.44669434428215027
loss_pred:0.025119202211499214, decouple_loss:0.012568671256303787
Iteration: 1237, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4488906264305115
The generated pressure mean: 0.4489430785179138
loss_pred:0.025761358439922333, decouple_loss:0.011559568345546722
loss_pred:0.02455875463783741, decouple_loss:0.011724662035703659
The generated pressure mean: 0.44972044229507446
loss_pred:0.02309272065758705, decouple_loss:0.011673051863908768
Iteration: 1238, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44837772846221924
The generated pressure mean: 0.4474971890449524
loss_pred:0.024806372821331024, decouple_loss:0.011498544365167618
loss_pred:0.024963805451989174, decouple_loss:0.01163062360137701
The generated pressure mean: 0.4489346146583557
loss_pred:0.025434140115976334, decouple_loss:0.01155923493206501
Iteration: 1239, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4481935501098633
The generated pressure mean: 0.44839343428611755
loss_pred:0.02426861599087715, decouple_loss:0.011255878955125809
loss_pred:0.0254579596221447, decouple_loss:0.011184215545654297
The generated pressure mean: 0.44915971159935
loss_pred:0.02448301576077938, decouple_loss:0.011325525119900703
Iteration: 1240, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4489038288593292
loss_pred:0.024539122357964516, decouple_loss:0.010877332650125027
The generated pressure mean: 0.448076993227005
loss_pred:0.023864954710006714, decouple_loss:0.010636145249009132
The generated pressure mean: 0.44738543033599854
loss_pred:0.023382559418678284, decouple_loss:0.010474308393895626
2023-04-16 05:55:26 testing...
The generated pressure mean: 0.4495830833911896
The generated pressure mean: 0.4497888684272766
The generated pressure mean: 0.44987666606903076
loss_pred:0.03344466909766197, decouple_loss:0.010643178597092628
loss_pred:0.03477877005934715, decouple_loss:0.010730575770139694
loss_pred:0.03316580131649971, decouple_loss:0.010762267746031284
Loss: 0.03433201462030411, avg_mse: 0.04441783204674721
current test mse: 0.044418
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012012_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012012_3_24hr.npz
NaN value num: 0
Iteration: 1241, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4484599530696869
loss_pred:0.025431057438254356, decouple_loss:0.011041252873837948
The generated pressure mean: 0.4467921853065491
loss_pred:0.02476135455071926, decouple_loss:0.01052968017756939
The generated pressure mean: 0.4477180242538452
loss_pred:0.02536788210272789, decouple_loss:0.010644258931279182
Iteration: 1242, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44628408551216125
The generated pressure mean: 0.44695988297462463
loss_pred:0.02360440231859684, decouple_loss:0.010975634679198265
loss_pred:0.024893470108509064, decouple_loss:0.01069976668804884
The generated pressure mean: 0.44773605465888977
loss_pred:0.02487778477370739, decouple_loss:0.01073572225868702
Iteration: 1243, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44849732518196106
The generated pressure mean: 0.44790807366371155
loss_pred:0.023778963834047318, decouple_loss:0.011014636605978012
loss_pred:0.023734120652079582, decouple_loss:0.010837464593350887
The generated pressure mean: 0.4487679600715637
loss_pred:0.024303114041686058, decouple_loss:0.010942168533802032
Iteration: 1244, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44730570912361145
The generated pressure mean: 0.44789817929267883
loss_pred:0.026340631768107414, decouple_loss:0.011446214281022549
loss_pred:0.023754190653562546, decouple_loss:0.011437461711466312
The generated pressure mean: 0.4474908709526062
loss_pred:0.023911846801638603, decouple_loss:0.011268427595496178
Iteration: 1245, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4471847116947174
The generated pressure mean: 0.448669970035553
loss_pred:0.02456618659198284, decouple_loss:0.010568398050963879
loss_pred:0.025076240301132202, decouple_loss:0.01055043376982212
The generated pressure mean: 0.4476092755794525
loss_pred:0.02411162666976452, decouple_loss:0.010243883356451988
Iteration: 1246, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.446382999420166
The generated pressure mean: 0.4477022588253021
loss_pred:0.02421397529542446, decouple_loss:0.009836302138864994
loss_pred:0.0238123070448637, decouple_loss:0.009627153165638447
The generated pressure mean: 0.44812050461769104
loss_pred:0.024352021515369415, decouple_loss:0.010337555781006813
Iteration: 1247, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44803979992866516
The generated pressure mean: 0.445629358291626
loss_pred:0.026438890025019646, decouple_loss:0.01042952574789524
loss_pred:0.025628389790654182, decouple_loss:0.010035457089543343
The generated pressure mean: 0.44814231991767883
loss_pred:0.023687215521931648, decouple_loss:0.009776131249964237
Iteration: 1248, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.446853905916214
The generated pressure mean: 0.4467793107032776
loss_pred:0.024955056607723236, decouple_loss:0.010765613988041878
loss_pred:0.023836594074964523, decouple_loss:0.010729826055467129
The generated pressure mean: 0.44752028584480286
loss_pred:0.02337094210088253, decouple_loss:0.010714774020016193
Iteration: 1249, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4486526548862457The generated pressure mean: 0.4480159282684326
loss_pred:0.02501240186393261, decouple_loss:0.011922620236873627
loss_pred:0.02532125823199749, decouple_loss:0.011608348228037357
The generated pressure mean: 0.44654789566993713
loss_pred:0.024688417091965675, decouple_loss:0.01128021813929081
Iteration: 1250, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44864141941070557
The generated pressure mean: 0.4474409520626068
loss_pred:0.024428488686680794, decouple_loss:0.01065598614513874
loss_pred:0.023697378113865852, decouple_loss:0.010665563866496086
The generated pressure mean: 0.44741907715797424
loss_pred:0.024854011833667755, decouple_loss:0.010736500844359398
2023-04-16 05:57:57 testing...
The generated pressure mean: 0.4497888684272766
The generated pressure mean: 0.4495830535888672
The generated pressure mean: 0.44987666606903076
loss_pred:0.03239067271351814, decouple_loss:0.01019030250608921
loss_pred:0.03165481239557266, decouple_loss:0.01005523931235075
loss_pred:0.031126055866479874, decouple_loss:0.01014267560094595
Loss: 0.03223031759262085, avg_mse: 0.040680427104234695
current test mse: 0.04068
Iteration: 1251, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44732311367988586
loss_pred:0.02395138517022133, decouple_loss:0.010320421308279037
The generated pressure mean: 0.447234183549881
loss_pred:0.02393614687025547, decouple_loss:0.01005968451499939
The generated pressure mean: 0.44720256328582764
loss_pred:0.023947248235344887, decouple_loss:0.009924274869263172
Iteration: 1252, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4472866356372833
loss_pred:0.02363191731274128, decouple_loss:0.009615128859877586
The generated pressure mean: 0.44812092185020447
loss_pred:0.02415727637708187, decouple_loss:0.009768258780241013
The generated pressure mean: 0.44889017939567566
loss_pred:0.027001002803444862, decouple_loss:0.009949144907295704
Iteration: 1253, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4477032721042633
loss_pred:0.025378303602337837, decouple_loss:0.01223323680460453
The generated pressure mean: 0.44769424200057983
loss_pred:0.025127528235316277, decouple_loss:0.012522401288151741
The generated pressure mean: 0.44765475392341614
loss_pred:0.024266600608825684, decouple_loss:0.01251190435141325
Iteration: 1254, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4469078779220581
The generated pressure mean: 0.4478236734867096
loss_pred:0.02404353953897953, decouple_loss:0.010760491713881493
loss_pred:0.02285143919289112, decouple_loss:0.01065480150282383
The generated pressure mean: 0.44747447967529297
loss_pred:0.023289384320378304, decouple_loss:0.01073487475514412
Iteration: 1255, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.448173850774765
The generated pressure mean: 0.4475524127483368
loss_pred:0.025626128539443016, decouple_loss:0.01108698733150959
loss_pred:0.02428479865193367, decouple_loss:0.010306877084076405
The generated pressure mean: 0.4477330446243286
loss_pred:0.02423316054046154, decouple_loss:0.010339333675801754
Iteration: 1256, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4472869336605072
The generated pressure mean: 0.44647812843322754
loss_pred:0.023813677951693535, decouple_loss:0.009766822680830956
loss_pred:0.024104442447423935, decouple_loss:0.009619566611945629
The generated pressure mean: 0.44838908314704895
loss_pred:0.02633063681423664, decouple_loss:0.010168724693357944
Iteration: 1257, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4470200538635254
The generated pressure mean: 0.4478203058242798
loss_pred:0.024267161265015602, decouple_loss:0.010230928659439087
loss_pred:0.02593211643397808, decouple_loss:0.010455613024532795
The generated pressure mean: 0.4478985369205475
loss_pred:0.02466762252151966, decouple_loss:0.01035474706441164
Iteration: 1258, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4474269449710846
The generated pressure mean: 0.4469403624534607
loss_pred:0.02469831332564354, decouple_loss:0.011885730549693108
loss_pred:0.024215880781412125, decouple_loss:0.01151357777416706
The generated pressure mean: 0.4470370411872864
loss_pred:0.023885969072580338, decouple_loss:0.01192288938909769
Iteration: 1259, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4468739926815033
loss_pred:0.024335671216249466, decouple_loss:0.009780680760741234
The generated pressure mean: 0.44869041442871094
loss_pred:0.02472526766359806, decouple_loss:0.010417376644909382
The generated pressure mean: 0.4477849304676056
loss_pred:0.030065884813666344, decouple_loss:0.010289080440998077
Iteration: 1260, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44743573665618896
The generated pressure mean: 0.44597822427749634
loss_pred:0.02642473392188549, decouple_loss:0.01100003533065319
loss_pred:0.024652384221553802, decouple_loss:0.01081639900803566
The generated pressure mean: 0.4476260840892792
loss_pred:0.025115465745329857, decouple_loss:0.01107302587479353
2023-04-16 05:59:51 testing...
The generated pressure mean: 0.449788898229599
The generated pressure mean: 0.4495830833911896
The generated pressure mean: 0.44987666606903076
loss_pred:0.03361296281218529, decouple_loss:0.011337284930050373
loss_pred:0.03244014084339142, decouple_loss:0.011120042763650417loss_pred:0.03209875896573067, decouple_loss:0.011219635605812073
Loss: 0.03327856957912445, avg_mse: 0.04252730309963226
current test mse: 0.042527
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012016_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012016_3_24hr.npz
NaN value num: 0
Iteration: 1261, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4471803605556488
loss_pred:0.025531858205795288, decouple_loss:0.01128616463392973
The generated pressure mean: 0.4476644992828369
loss_pred:0.025083433836698532, decouple_loss:0.011372475884854794
The generated pressure mean: 0.4477926790714264
loss_pred:0.02459065429866314, decouple_loss:0.011405542492866516
Iteration: 1262, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44715288281440735
loss_pred:0.02603466995060444, decouple_loss:0.010439366102218628
The generated pressure mean: 0.4475240707397461
loss_pred:0.025528667494654655, decouple_loss:0.010478337295353413
The generated pressure mean: 0.44691622257232666
loss_pred:0.027060559019446373, decouple_loss:0.010420465841889381
Iteration: 1263, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4477413594722748
loss_pred:0.02672743611037731, decouple_loss:0.010941166430711746
The generated pressure mean: 0.4471185505390167
loss_pred:0.025207573547959328, decouple_loss:0.010875839740037918
The generated pressure mean: 0.44723114371299744
loss_pred:0.0248158760368824, decouple_loss:0.010985588654875755
Iteration: 1264, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4479086697101593
loss_pred:0.02622511237859726, decouple_loss:0.012271651066839695
The generated pressure mean: 0.4480352997779846
loss_pred:0.02470032311975956, decouple_loss:0.012181147001683712
The generated pressure mean: 0.4471006393432617
loss_pred:0.028119785711169243, decouple_loss:0.012367176823318005
Iteration: 1265, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4475264549255371
loss_pred:0.024802563712000847, decouple_loss:0.011177741922438145
The generated pressure mean: 0.44776326417922974
loss_pred:0.026114532724022865, decouple_loss:0.010807989165186882
The generated pressure mean: 0.4470789432525635
loss_pred:0.026141539216041565, decouple_loss:0.01082258764654398
Iteration: 1266, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4476095139980316
loss_pred:0.025426192209124565, decouple_loss:0.010799041017889977
The generated pressure mean: 0.44814151525497437
loss_pred:0.025749485939741135, decouple_loss:0.010770587250590324
The generated pressure mean: 0.4478148818016052
loss_pred:0.026206335052847862, decouple_loss:0.010881948284804821
Iteration: 1267, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4463063180446625
loss_pred:0.024477994069457054, decouple_loss:0.012247446924448013
The generated pressure mean: 0.4472668766975403
loss_pred:0.02475142478942871, decouple_loss:0.012072223238646984
The generated pressure mean: 0.4467707574367523
loss_pred:0.0241651963442564, decouple_loss:0.011971664614975452
Iteration: 1268, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4471842646598816
loss_pred:0.026988238096237183, decouple_loss:0.010145852342247963
The generated pressure mean: 0.44698387384414673
loss_pred:0.02575177699327469, decouple_loss:0.010146114975214005
The generated pressure mean: 0.44785478711128235
loss_pred:0.024735478684306145, decouple_loss:0.010341024957597256
Iteration: 1269, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44729742407798767
loss_pred:0.025346748530864716, decouple_loss:0.010361063294112682
The generated pressure mean: 0.4472975432872772
loss_pred:0.02367970533668995, decouple_loss:0.010386190377175808
The generated pressure mean: 0.4469631314277649
loss_pred:0.02476395294070244, decouple_loss:0.01019298192113638
Iteration: 1270, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44701895117759705
loss_pred:0.026836911216378212, decouple_loss:0.010657559148967266
The generated pressure mean: 0.4473910927772522
loss_pred:0.025592487305402756, decouple_loss:0.010628897696733475
The generated pressure mean: 0.44858667254447937
loss_pred:0.02543661743402481, decouple_loss:0.010815773159265518
2023-04-16 06:02:21 testing...
The generated pressure mean: 0.4495830535888672
The generated pressure mean: 0.4497888684272766
The generated pressure mean: 0.44987666606903076
loss_pred:0.03215325251221657, decouple_loss:0.010577739216387272
loss_pred:0.032996125519275665, decouple_loss:0.010675165802240372
loss_pred:0.031425897032022476, decouple_loss:0.010612567886710167
Loss: 0.03272285312414169, avg_mse: 0.04159750044345856
current test mse: 0.041598
Iteration: 1271, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4477905035018921
The generated pressure mean: 0.44744566082954407
loss_pred:0.025862688198685646, decouple_loss:0.010741549544036388
loss_pred:0.024914352223277092, decouple_loss:0.010691089555621147
The generated pressure mean: 0.4485894441604614
loss_pred:0.023077692836523056, decouple_loss:0.01067886408418417
Iteration: 1272, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44735562801361084
loss_pred:0.023512568324804306, decouple_loss:0.010124088265001774
The generated pressure mean: 0.44772130250930786
loss_pred:0.026448627933859825, decouple_loss:0.010054032318294048
The generated pressure mean: 0.44665277004241943
loss_pred:0.023911818861961365, decouple_loss:0.010155405849218369
Iteration: 1273, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44752681255340576
The generated pressure mean: 0.4462769329547882
loss_pred:0.025418326258659363, decouple_loss:0.009935545735061169
loss_pred:0.02373860590159893, decouple_loss:0.009651961736381054
The generated pressure mean: 0.4475873112678528
loss_pred:0.024780694395303726, decouple_loss:0.009946861304342747
Iteration: 1274, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4476197361946106
The generated pressure mean: 0.4468156695365906
loss_pred:0.02494528703391552, decouple_loss:0.009437342174351215
loss_pred:0.02379757910966873, decouple_loss:0.009504647925496101
The generated pressure mean: 0.44749000668525696
loss_pred:0.02406138926744461, decouple_loss:0.009705723263323307
Iteration: 1275, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44719046354293823
The generated pressure mean: 0.44748654961586
loss_pred:0.02548665925860405, decouple_loss:0.009722492657601833
loss_pred:0.028393279761075974, decouple_loss:0.009781370870769024
The generated pressure mean: 0.44720011949539185
loss_pred:0.02504822611808777, decouple_loss:0.009685290046036243
Iteration: 1276, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.447537362575531
The generated pressure mean: 0.44654354453086853
loss_pred:0.025246504694223404, decouple_loss:0.00997229665517807
loss_pred:0.026841742917895317, decouple_loss:0.009976125322282314
The generated pressure mean: 0.44719046354293823
loss_pred:0.025825941935181618, decouple_loss:0.010096351616084576
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1277, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4475558400154114
The generated pressure mean: 0.44601359963417053
loss_pred:0.024828873574733734, decouple_loss:0.009659897536039352
loss_pred:0.023984376341104507, decouple_loss:0.009686741977930069
The generated pressure mean: 0.4475800395011902
loss_pred:0.02483486570417881, decouple_loss:0.00955063197761774
Iteration: 1278, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44733738899230957The generated pressure mean: 0.44800665974617004
loss_pred:0.025346264243125916, decouple_loss:0.010615721344947815
loss_pred:0.02522812783718109, decouple_loss:0.010606278665363789
The generated pressure mean: 0.4473235309123993
loss_pred:0.02447783760726452, decouple_loss:0.010516047477722168
Iteration: 1279, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4476642608642578
loss_pred:0.02545720525085926, decouple_loss:0.010302480310201645
The generated pressure mean: 0.44759684801101685
loss_pred:0.024832608178257942, decouple_loss:0.010599350556731224
The generated pressure mean: 0.4481312930583954
loss_pred:0.02453834004700184, decouple_loss:0.010601788759231567
Iteration: 1280, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44745901226997375
loss_pred:0.024592241272330284, decouple_loss:0.009639116004109383
The generated pressure mean: 0.4476320445537567The generated pressure mean: 0.4477626085281372
loss_pred:0.025011694058775902, decouple_loss:0.009568598121404648
loss_pred:0.024734091013669968, decouple_loss:0.009967215359210968
2023-04-16 06:04:15 testing...
The generated pressure mean: 0.4495830535888672
The generated pressure mean: 0.4497888684272766
The generated pressure mean: 0.44987666606903076
loss_pred:0.031450096517801285, decouple_loss:0.0102523323148489
loss_pred:0.03237127140164375, decouple_loss:0.010401115752756596
loss_pred:0.03113146871328354, decouple_loss:0.010251332074403763
Loss: 0.032166026532649994, avg_mse: 0.04066665843129158
current test mse: 0.040667
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012011_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012011_3_24hr.npz
NaN value num: 0
Iteration: 1281, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44766753911972046
loss_pred:0.023809725418686867, decouple_loss:0.010536563582718372
The generated pressure mean: 0.44764891266822815
loss_pred:0.02374875172972679, decouple_loss:0.010224143043160439
The generated pressure mean: 0.44653698801994324
loss_pred:0.0239223875105381, decouple_loss:0.010537560097873211
Iteration: 1282, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4476890563964844The generated pressure mean: 0.4480413794517517
loss_pred:0.023287439718842506, decouple_loss:0.010246138088405132
loss_pred:0.024580420926213264, decouple_loss:0.010493017733097076
The generated pressure mean: 0.446834534406662
loss_pred:0.022618168964982033, decouple_loss:0.010195950046181679
Iteration: 1283, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4473133385181427
loss_pred:0.024514246731996536, decouple_loss:0.010236648842692375
The generated pressure mean: 0.4471130669116974
loss_pred:0.026219559833407402, decouple_loss:0.01008669938892126
The generated pressure mean: 0.44720178842544556
loss_pred:0.025452952831983566, decouple_loss:0.010174762457609177
Iteration: 1284, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4481147527694702
loss_pred:0.023148274049162865, decouple_loss:0.009976452216506004
The generated pressure mean: 0.44808363914489746
loss_pred:0.025325791910290718, decouple_loss:0.010708712041378021
The generated pressure mean: 0.44780397415161133
loss_pred:0.025593234226107597, decouple_loss:0.010406835936009884
Iteration: 1285, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.449092298746109
loss_pred:0.02417623996734619, decouple_loss:0.00998815055936575
The generated pressure mean: 0.44870516657829285
loss_pred:0.023037461563944817, decouple_loss:0.00962923001497984
The generated pressure mean: 0.4467988908290863
loss_pred:0.02365172654390335, decouple_loss:0.00946841761469841
Iteration: 1286, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44765564799308777
The generated pressure mean: 0.4475351870059967
loss_pred:0.027472244575619698, decouple_loss:0.009969043545424938
loss_pred:0.02232913300395012, decouple_loss:0.00990626122802496
The generated pressure mean: 0.44962751865386963
loss_pred:0.022582875564694405, decouple_loss:0.010180489160120487
Iteration: 1287, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4482946991920471
loss_pred:0.024476870894432068, decouple_loss:0.009601222351193428
The generated pressure mean: 0.44797784090042114
loss_pred:0.022943714633584023, decouple_loss:0.00975759606808424
The generated pressure mean: 0.4474719762802124
loss_pred:0.024521466344594955, decouple_loss:0.009941581636667252
Iteration: 1288, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44774556159973145
loss_pred:0.02551950328052044, decouple_loss:0.010133730247616768
The generated pressure mean: 0.4468989074230194
loss_pred:0.023461272940039635, decouple_loss:0.00996593851596117
The generated pressure mean: 0.44732335209846497
loss_pred:0.023605722934007645, decouple_loss:0.009863758459687233
Iteration: 1289, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4481607675552368
loss_pred:0.024793226271867752, decouple_loss:0.009748661890625954
The generated pressure mean: 0.447274774312973
loss_pred:0.023343153297901154, decouple_loss:0.00963431317359209
The generated pressure mean: 0.4478897452354431
loss_pred:0.022676857188344002, decouple_loss:0.009653341956436634
Iteration: 1290, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44735175371170044
loss_pred:0.024800054728984833, decouple_loss:0.009871046058833599
The generated pressure mean: 0.44815152883529663
loss_pred:0.02460266463458538, decouple_loss:0.01001372653990984
The generated pressure mean: 0.44773584604263306
loss_pred:0.024725742638111115, decouple_loss:0.010068081319332123
2023-04-16 06:06:54 testing...
The generated pressure mean: 0.4497888684272766
The generated pressure mean: 0.4495830535888672
The generated pressure mean: 0.44987666606903076
loss_pred:0.03204532340168953, decouple_loss:0.00982598029077053
loss_pred:0.030660120770335197, decouple_loss:0.009795437566936016
loss_pred:0.030033256858587265, decouple_loss:0.00991390086710453
Loss: 0.03140515834093094, avg_mse: 0.03927423804998398
current test mse: 0.039274
Iteration: 1291, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4475812017917633
The generated pressure mean: 0.4490791857242584
loss_pred:0.023945173248648643, decouple_loss:0.009960226714611053
loss_pred:0.024447862058877945, decouple_loss:0.009911567904055119
The generated pressure mean: 0.4488285779953003
loss_pred:0.0229022279381752, decouple_loss:0.009753058664500713
Iteration: 1292, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44812625646591187
loss_pred:0.023612286895513535, decouple_loss:0.010381431318819523
The generated pressure mean: 0.4470285177230835
loss_pred:0.024498561397194862, decouple_loss:0.010547553189098835
The generated pressure mean: 0.44750165939331055
loss_pred:0.025577688589692116, decouple_loss:0.010533066466450691
Iteration: 1293, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4486341178417206
The generated pressure mean: 0.4486345648765564
loss_pred:0.02410736121237278, decouple_loss:0.01029372587800026
loss_pred:0.02437295950949192, decouple_loss:0.01028074324131012
The generated pressure mean: 0.44720330834388733
loss_pred:0.02394644357264042, decouple_loss:0.010562139563262463
Iteration: 1294, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44715616106987
loss_pred:0.024469302967190742, decouple_loss:0.011062068864703178
The generated pressure mean: 0.44757816195487976
loss_pred:0.025008458644151688, decouple_loss:0.01107479352504015
The generated pressure mean: 0.44776228070259094
loss_pred:0.025990664958953857, decouple_loss:0.011092618107795715
Iteration: 1295, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4478875398635864
loss_pred:0.025408431887626648, decouple_loss:0.010338117368519306
The generated pressure mean: 0.4485373795032501
loss_pred:0.02408618852496147, decouple_loss:0.009773554280400276
The generated pressure mean: 0.4471355676651001
loss_pred:0.024540532380342484, decouple_loss:0.010012323036789894
Iteration: 1296, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44768840074539185
loss_pred:0.02420470491051674, decouple_loss:0.00959884561598301
The generated pressure mean: 0.4494800567626953
loss_pred:0.023660756647586823, decouple_loss:0.010138760320842266
The generated pressure mean: 0.44794023036956787
loss_pred:0.0246144887059927, decouple_loss:0.009780979715287685
Iteration: 1297, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44797438383102417
loss_pred:0.02323237806558609, decouple_loss:0.009807896800339222
The generated pressure mean: 0.44857919216156006
loss_pred:0.024173248559236526, decouple_loss:0.009613167494535446
The generated pressure mean: 0.4470593333244324
loss_pred:0.02345958910882473, decouple_loss:0.009643904864788055
Iteration: 1298, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4481104910373688
loss_pred:0.02375635877251625, decouple_loss:0.011026116088032722
The generated pressure mean: 0.44704321026802063
loss_pred:0.023909656330943108, decouple_loss:0.010607653297483921
The generated pressure mean: 0.4478502869606018
loss_pred:0.023709548637270927, decouple_loss:0.01088794507086277
Iteration: 1299, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.447787344455719
loss_pred:0.025779103860259056, decouple_loss:0.00989088136702776
The generated pressure mean: 0.4474108815193176
loss_pred:0.02524447627365589, decouple_loss:0.009698436595499516
The generated pressure mean: 0.447695255279541
loss_pred:0.02370268478989601, decouple_loss:0.009752052836120129
Iteration: 1300, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44668814539909363
loss_pred:0.024087920784950256, decouple_loss:0.010617879219353199
The generated pressure mean: 0.4473905861377716
loss_pred:0.024557804688811302, decouple_loss:0.010606588795781136
The generated pressure mean: 0.4471810758113861
loss_pred:0.02550286427140236, decouple_loss:0.010457667522132397
2023-04-16 06:08:48 testing...
The generated pressure mean: 0.4495830833911896
The generated pressure mean: 0.449788898229599
The generated pressure mean: 0.44987666606903076
loss_pred:0.03127652779221535, decouple_loss:0.00989079475402832
loss_pred:0.032140590250492096, decouple_loss:0.009876307100057602
loss_pred:0.030770065262913704, decouple_loss:0.00997239537537098
Loss: 0.031891386955976486, avg_mse: 0.04022584483027458
current test mse: 0.040226
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012018_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012018_3_24hr.npz
NaN value num: 0
Iteration: 1301, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4492394030094147
loss_pred:0.026738127693533897, decouple_loss:0.009835835546255112
The generated pressure mean: 0.4475609362125397
The generated pressure mean: 0.4496171176433563
loss_pred:0.02538202702999115, decouple_loss:0.010272342711687088
loss_pred:0.025913452729582787, decouple_loss:0.009879041463136673
Iteration: 1302, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.448874831199646
The generated pressure mean: 0.44800862669944763
loss_pred:0.024311596527695656, decouple_loss:0.01208826806396246
loss_pred:0.025473186746239662, decouple_loss:0.011981578543782234
The generated pressure mean: 0.44786709547042847
loss_pred:0.024158060550689697, decouple_loss:0.011981157585978508
Iteration: 1303, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44937974214553833
The generated pressure mean: 0.44823336601257324
loss_pred:0.02576855570077896, decouple_loss:0.011388485319912434
loss_pred:0.025904491543769836, decouple_loss:0.01118518877774477
The generated pressure mean: 0.4490126073360443
loss_pred:0.02521638199687004, decouple_loss:0.011210021562874317
Iteration: 1304, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44851458072662354
The generated pressure mean: 0.4479248821735382
loss_pred:0.024818992242217064, decouple_loss:0.010834761895239353
loss_pred:0.024553807452321053, decouple_loss:0.011087587103247643
The generated pressure mean: 0.4486909806728363
loss_pred:0.025991741567850113, decouple_loss:0.010999293997883797
Iteration: 1305, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44827431440353394
The generated pressure mean: 0.4492180645465851
loss_pred:0.026200715452432632, decouple_loss:0.012673746794462204
loss_pred:0.025749051943421364, decouple_loss:0.012773718684911728
The generated pressure mean: 0.4479655921459198
loss_pred:0.024955736473202705, decouple_loss:0.012781715951859951
Iteration: 1306, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44982975721359253
The generated pressure mean: 0.4478452801704407
loss_pred:0.025402484461665154, decouple_loss:0.011819171719253063
loss_pred:0.02461494319140911, decouple_loss:0.011332723312079906
The generated pressure mean: 0.4487936794757843
loss_pred:0.02396552637219429, decouple_loss:0.011211740784347057
Iteration: 1307, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.449035108089447The generated pressure mean: 0.44851556420326233
loss_pred:0.026387164369225502, decouple_loss:0.010673264041543007loss_pred:0.02910025417804718, decouple_loss:0.01070998702198267
The generated pressure mean: 0.4494500756263733
loss_pred:0.025772040709853172, decouple_loss:0.010983850806951523
Iteration: 1308, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44916248321533203
The generated pressure mean: 0.44853314757347107
loss_pred:0.02680674009025097, decouple_loss:0.012897456996142864
loss_pred:0.027367090806365013, decouple_loss:0.012703273445367813
The generated pressure mean: 0.44802823662757874
loss_pred:0.025772498920559883, decouple_loss:0.01257510855793953
Iteration: 1309, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4491003453731537
The generated pressure mean: 0.44893208146095276
loss_pred:0.02525358460843563, decouple_loss:0.01232059020549059
loss_pred:0.02503136917948723, decouple_loss:0.01231448445469141
The generated pressure mean: 0.44943419098854065
loss_pred:0.025077568367123604, decouple_loss:0.011962715536355972
Iteration: 1310, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4498286545276642
The generated pressure mean: 0.45069214701652527
loss_pred:0.02635984495282173, decouple_loss:0.013870913535356522
loss_pred:0.026486597955226898, decouple_loss:0.01406939048320055
The generated pressure mean: 0.4490082561969757
loss_pred:0.02675771154463291, decouple_loss:0.013947390019893646
2023-04-16 06:11:18 testing...
The generated pressure mean: 0.449788898229599
The generated pressure mean: 0.4495830833911896
The generated pressure mean: 0.44987666606903076
loss_pred:0.03434460610151291, decouple_loss:0.014050252735614777
loss_pred:0.033843815326690674, decouple_loss:0.013868574984371662
loss_pred:0.033283233642578125, decouple_loss:0.013948000967502594
Loss: 0.034521665424108505, avg_mse: 0.04433603212237358
current test mse: 0.044336
Iteration: 1311, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4500400722026825
loss_pred:0.02529892511665821, decouple_loss:0.01415162067860365
The generated pressure mean: 0.44948524236679077
loss_pred:0.025772977620363235, decouple_loss:0.014037016779184341
The generated pressure mean: 0.4479435980319977
loss_pred:0.02558489888906479, decouple_loss:0.013732470571994781
Iteration: 1312, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4510590434074402
The generated pressure mean: 0.45011135935783386
loss_pred:0.027645541355013847, decouple_loss:0.014016362838447094
loss_pred:0.024696776643395424, decouple_loss:0.013731880113482475
The generated pressure mean: 0.44879257678985596
loss_pred:0.025124162435531616, decouple_loss:0.014054239727556705
Iteration: 1313, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4483445882797241
The generated pressure mean: 0.44861990213394165
loss_pred:0.025559116154909134, decouple_loss:0.013701783493161201
loss_pred:0.025590434670448303, decouple_loss:0.01383520569652319
The generated pressure mean: 0.4490712881088257
loss_pred:0.024115558713674545, decouple_loss:0.013539385981857777
Iteration: 1314, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.448900431394577
The generated pressure mean: 0.45006632804870605
loss_pred:0.025565173476934433, decouple_loss:0.013352462090551853
loss_pred:0.024688124656677246, decouple_loss:0.013338510878384113
The generated pressure mean: 0.449535071849823
loss_pred:0.024133995175361633, decouple_loss:0.013517413288354874
Iteration: 1315, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4492962062358856
The generated pressure mean: 0.44945028424263
loss_pred:0.02539103664457798, decouple_loss:0.012762978672981262
loss_pred:0.024873139336705208, decouple_loss:0.01290830783545971
The generated pressure mean: 0.4499236047267914
loss_pred:0.025567254051566124, decouple_loss:0.01292350236326456
Iteration: 1316, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44862130284309387
The generated pressure mean: 0.4478102922439575
loss_pred:0.02500397525727749, decouple_loss:0.01281034480780363
loss_pred:0.024134080857038498, decouple_loss:0.012840384617447853
The generated pressure mean: 0.4478776156902313
loss_pred:0.0241760965436697, decouple_loss:0.0130125368013978
Iteration: 1317, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44875583052635193The generated pressure mean: 0.4480951428413391
loss_pred:0.023818913847208023, decouple_loss:0.012190640904009342
loss_pred:0.027100462466478348, decouple_loss:0.012165671214461327
The generated pressure mean: 0.44849181175231934
loss_pred:0.027017051354050636, decouple_loss:0.01222545001655817
Iteration: 1318, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4493091106414795The generated pressure mean: 0.4490033984184265
loss_pred:0.024400029331445694, decouple_loss:0.012510493397712708
loss_pred:0.024055764079093933, decouple_loss:0.012755099684000015
The generated pressure mean: 0.44885820150375366
loss_pred:0.023230528458952904, decouple_loss:0.012774286791682243
Iteration: 1319, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44823217391967773
loss_pred:0.024905242025852203, decouple_loss:0.012783601880073547
The generated pressure mean: 0.4485279321670532
loss_pred:0.023588877171278, decouple_loss:0.012802781537175179
The generated pressure mean: 0.44955405592918396
loss_pred:0.024151457473635674, decouple_loss:0.01261224877089262
Iteration: 1320, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4483950436115265
The generated pressure mean: 0.4492822289466858
loss_pred:0.024912316352128983, decouple_loss:0.012475982308387756
loss_pred:0.02560117281973362, decouple_loss:0.0126184755936265
The generated pressure mean: 0.44956347346305847
loss_pred:0.023651771247386932, decouple_loss:0.012500070035457611
2023-04-16 06:13:11 testing...
The generated pressure mean: 0.4497888684272766
The generated pressure mean: 0.4495830535888672
The generated pressure mean: 0.44987666606903076
loss_pred:0.033160530030727386, decouple_loss:0.011772695928812027
loss_pred:0.03232691064476967, decouple_loss:0.0119315879419446
loss_pred:0.0317758284509182, decouple_loss:0.011941174045205116
Loss: 0.033015184104442596, avg_mse: 0.04216139763593674
current test mse: 0.042161
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012001_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012001_3_24hr.npz
NaN value num: 0
Iteration: 1321, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.447307288646698
loss_pred:0.02493513561785221, decouple_loss:0.011619333177804947
The generated pressure mean: 0.4467913806438446
loss_pred:0.025406640022993088, decouple_loss:0.011772459372878075
The generated pressure mean: 0.4471668004989624
loss_pred:0.025744443759322166, decouple_loss:0.012199566699564457
Iteration: 1322, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.447276771068573
The generated pressure mean: 0.4479478597640991
loss_pred:0.0248686783015728, decouple_loss:0.012149110436439514
loss_pred:0.024043653160333633, decouple_loss:0.01198374293744564
The generated pressure mean: 0.4466235935688019
loss_pred:0.02625548094511032, decouple_loss:0.012047922238707542
Iteration: 1323, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44640475511550903
The generated pressure mean: 0.44753625988960266
loss_pred:0.02452239580452442, decouple_loss:0.011656037531793118
loss_pred:0.022857671603560448, decouple_loss:0.011629459448158741
The generated pressure mean: 0.4478078782558441
loss_pred:0.025235801935195923, decouple_loss:0.011492526158690453
Iteration: 1324, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44716647267341614
The generated pressure mean: 0.4472956955432892
loss_pred:0.02527358941733837, decouple_loss:0.012497163377702236
loss_pred:0.024025484919548035, decouple_loss:0.012540099211037159
The generated pressure mean: 0.44737738370895386
loss_pred:0.025601236149668694, decouple_loss:0.012407851405441761
Iteration: 1325, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44667771458625793
loss_pred:0.02417515218257904, decouple_loss:0.011650003492832184
The generated pressure mean: 0.447295606136322
The generated pressure mean: 0.4465309977531433
loss_pred:0.025026768445968628, decouple_loss:0.011869460344314575
loss_pred:0.02357145957648754, decouple_loss:0.011553718708455563
Iteration: 1326, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44738903641700745
loss_pred:0.024004478007555008, decouple_loss:0.011717003770172596
The generated pressure mean: 0.4466308355331421
loss_pred:0.02470121532678604, decouple_loss:0.011747248470783234
The generated pressure mean: 0.4467073678970337
loss_pred:0.025270650163292885, decouple_loss:0.01156431995332241
Iteration: 1327, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4482124447822571
The generated pressure mean: 0.448147714138031loss_pred:0.023426512256264687, decouple_loss:0.011981147341430187
loss_pred:0.024034060537815094, decouple_loss:0.01172013022005558
The generated pressure mean: 0.4473174512386322
loss_pred:0.0238968338817358, decouple_loss:0.011570697650313377
Iteration: 1328, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.446953147649765
The generated pressure mean: 0.44818082451820374
loss_pred:0.023712333291769028, decouple_loss:0.010999754071235657
loss_pred:0.02379739284515381, decouple_loss:0.01133248396217823
The generated pressure mean: 0.4482475817203522
loss_pred:0.023323794826865196, decouple_loss:0.011096900328993797
Iteration: 1329, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4474543631076813
loss_pred:0.024739474058151245, decouple_loss:0.01102850865572691
The generated pressure mean: 0.4470263421535492
loss_pred:0.023246316239237785, decouple_loss:0.010876655578613281
The generated pressure mean: 0.44691503047943115
loss_pred:0.023173863068223, decouple_loss:0.01112137921154499
Iteration: 1330, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44669535756111145
loss_pred:0.024151206016540527, decouple_loss:0.010513736866414547
The generated pressure mean: 0.4466247260570526
loss_pred:0.023150743916630745, decouple_loss:0.010844232514500618
The generated pressure mean: 0.4480387568473816
loss_pred:0.024232804775238037, decouple_loss:0.010566206648945808
2023-04-16 06:15:48 testing...
The generated pressure mean: 0.449788898229599
The generated pressure mean: 0.4495830833911896
The generated pressure mean: 0.44987669587135315
loss_pred:0.03189081326127052, decouple_loss:0.010625071823596954
loss_pred:0.030839595943689346, decouple_loss:0.010427884757518768
loss_pred:0.03018166869878769, decouple_loss:0.010495983995497227
Loss: 0.03149650990962982, avg_mse: 0.03957467898726463
current test mse: 0.039575
Iteration: 1331, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44614535570144653The generated pressure mean: 0.44766610860824585
loss_pred:0.026152092963457108, decouple_loss:0.01083256583660841
loss_pred:0.023911744356155396, decouple_loss:0.010250452905893326
The generated pressure mean: 0.44720712304115295
loss_pred:0.024234412238001823, decouple_loss:0.010406975634396076
Iteration: 1332, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4476989805698395
The generated pressure mean: 0.44814738631248474
loss_pred:0.025397127494215965, decouple_loss:0.010484243743121624
loss_pred:0.025663958862423897, decouple_loss:0.010682987980544567
The generated pressure mean: 0.4469364881515503
loss_pred:0.023979857563972473, decouple_loss:0.010440129786729813
Iteration: 1333, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4482123553752899
The generated pressure mean: 0.4472036063671112
loss_pred:0.024649018421769142, decouple_loss:0.010275336913764477
loss_pred:0.022937649860978127, decouple_loss:0.010209886357188225
The generated pressure mean: 0.44609716534614563
loss_pred:0.02501732110977173, decouple_loss:0.010268231853842735
Iteration: 1334, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44715994596481323
The generated pressure mean: 0.4474721848964691
loss_pred:0.024579597637057304, decouple_loss:0.010540921241044998
loss_pred:0.024313388392329216, decouple_loss:0.01039823703467846
The generated pressure mean: 0.44717469811439514
loss_pred:0.023953918367624283, decouple_loss:0.010443514212965965
Iteration: 1335, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44719362258911133
The generated pressure mean: 0.446856826543808
loss_pred:0.024894054979085922, decouple_loss:0.0102297468110919
loss_pred:0.02191859856247902, decouple_loss:0.01038982905447483
The generated pressure mean: 0.4463751018047333
loss_pred:0.0236209649592638, decouple_loss:0.010304483585059643
Iteration: 1336, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4465223252773285
loss_pred:0.024208685383200645, decouple_loss:0.009356511756777763
The generated pressure mean: 0.44703611731529236
loss_pred:0.022928597405552864, decouple_loss:0.009255431592464447
The generated pressure mean: 0.446893572807312
loss_pred:0.022537540644407272, decouple_loss:0.00948443915694952
Iteration: 1337, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4471932649612427
The generated pressure mean: 0.44812074303627014
loss_pred:0.024241091683506966, decouple_loss:0.01065103430300951
loss_pred:0.023610347881913185, decouple_loss:0.010836777277290821
The generated pressure mean: 0.44840213656425476
loss_pred:0.023029500618577003, decouple_loss:0.010997987352311611
Iteration: 1338, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44665178656578064
loss_pred:0.024221273139119148, decouple_loss:0.011010237969458103
The generated pressure mean: 0.44784802198410034
loss_pred:0.024477729573845863, decouple_loss:0.011288183741271496
The generated pressure mean: 0.4473952651023865
loss_pred:0.02339600957930088, decouple_loss:0.010983309708535671
Iteration: 1339, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44684135913848877
loss_pred:0.023045741021633148, decouple_loss:0.01050129346549511
The generated pressure mean: 0.44660335779190063
loss_pred:0.02375708520412445, decouple_loss:0.01030019111931324
The generated pressure mean: 0.4460698068141937
loss_pred:0.02360980398952961, decouple_loss:0.010608918964862823
Iteration: 1340, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4487560987472534
loss_pred:0.02305608242750168, decouple_loss:0.010578632354736328
The generated pressure mean: 0.4469571113586426
loss_pred:0.023760749027132988, decouple_loss:0.01059566531330347
The generated pressure mean: 0.44755247235298157
loss_pred:0.024432269856333733, decouple_loss:0.010421693325042725
2023-04-16 06:17:42 testing...
The generated pressure mean: 0.449788898229599
The generated pressure mean: 0.4495830833911896
The generated pressure mean: 0.44987666606903076
loss_pred:0.03216465935111046, decouple_loss:0.010492699220776558
loss_pred:0.030970243737101555, decouple_loss:0.010523920878767967
loss_pred:0.03098011016845703, decouple_loss:0.010543621145188808
Loss: 0.03189767524600029, avg_mse: 0.040526293218135834
current test mse: 0.040526
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012000_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012000_3_24hr.npz
NaN value num: 0
Iteration: 1341, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4491988718509674
loss_pred:0.02324717864394188, decouple_loss:0.01066315732896328
The generated pressure mean: 0.4481538236141205
The generated pressure mean: 0.44830477237701416
loss_pred:0.022861311212182045, decouple_loss:0.01048703957349062
loss_pred:0.022745512425899506, decouple_loss:0.011122508905827999
Iteration: 1342, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4490247964859009
The generated pressure mean: 0.4482394754886627
loss_pred:0.02346731163561344, decouple_loss:0.010175472125411034
loss_pred:0.02334950678050518, decouple_loss:0.010653913952410221
The generated pressure mean: 0.4471631646156311
loss_pred:0.023378292098641396, decouple_loss:0.009913635440170765
Iteration: 1343, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4492894113063812
loss_pred:0.023216990754008293, decouple_loss:0.0106689827516675
The generated pressure mean: 0.44704604148864746
loss_pred:0.02169017493724823, decouple_loss:0.010534879751503468
The generated pressure mean: 0.44693103432655334
loss_pred:0.023601362481713295, decouple_loss:0.011232095770537853
Iteration: 1344, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4491006135940552
loss_pred:0.024768618866801262, decouple_loss:0.009738316759467125
The generated pressure mean: 0.44783085584640503
loss_pred:0.024005409330129623, decouple_loss:0.01022513210773468
The generated pressure mean: 0.449720174074173
loss_pred:0.024109909310936928, decouple_loss:0.009674515575170517
Iteration: 1345, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44693154096603394
loss_pred:0.022877737879753113, decouple_loss:0.010088346898555756
The generated pressure mean: 0.44736942648887634
loss_pred:0.023307789117097855, decouple_loss:0.009742648340761662
The generated pressure mean: 0.4473118782043457
loss_pred:0.02268964983522892, decouple_loss:0.00996838603168726
Iteration: 1346, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4484160542488098
loss_pred:0.02324347384274006, decouple_loss:0.00938091054558754
The generated pressure mean: 0.44858020544052124
loss_pred:0.023035526275634766, decouple_loss:0.009024378843605518
The generated pressure mean: 0.4472600817680359
loss_pred:0.022633269429206848, decouple_loss:0.009430204518139362
Iteration: 1347, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4476581811904907
loss_pred:0.023407217115163803, decouple_loss:0.009255114942789078
The generated pressure mean: 0.4480293095111847
loss_pred:0.02336379699409008, decouple_loss:0.009385342709720135
The generated pressure mean: 0.44871610403060913
loss_pred:0.0234152153134346, decouple_loss:0.009203116409480572
Iteration: 1348, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44921785593032837
loss_pred:0.023152654990553856, decouple_loss:0.010007313452661037
The generated pressure mean: 0.4488517940044403
loss_pred:0.022847624495625496, decouple_loss:0.010008838027715683
The generated pressure mean: 0.4487685561180115
loss_pred:0.023061007261276245, decouple_loss:0.009856725111603737
Iteration: 1349, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4476604163646698
loss_pred:0.023324113339185715, decouple_loss:0.010593991726636887
The generated pressure mean: 0.4501919448375702
loss_pred:0.024864347651600838, decouple_loss:0.010017947293817997
The generated pressure mean: 0.44748741388320923
loss_pred:0.02247294969856739, decouple_loss:0.010105353780090809
Iteration: 1350, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4461825489997864
loss_pred:0.023739345371723175, decouple_loss:0.00972052849829197
The generated pressure mean: 0.4500364661216736
loss_pred:0.024371782317757607, decouple_loss:0.009334524162113667
The generated pressure mean: 0.44831985235214233
loss_pred:0.0220384169369936, decouple_loss:0.009373140521347523
2023-04-16 06:20:13 testing...
The generated pressure mean: 0.4495830833911896
The generated pressure mean: 0.4497888684272766
The generated pressure mean: 0.44987666606903076
loss_pred:0.031336039304733276, decouple_loss:0.009173794649541378
loss_pred:0.032427337020635605, decouple_loss:0.009251048788428307
loss_pred:0.030722856521606445, decouple_loss:0.009181258268654346
Loss: 0.03195551037788391, avg_mse: 0.040795035660266876
current test mse: 0.040795
Iteration: 1351, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4464013874530792
The generated pressure mean: 0.44705814123153687
loss_pred:0.02294382080435753, decouple_loss:0.009955225512385368
loss_pred:0.02324538305401802, decouple_loss:0.0091122817248106
The generated pressure mean: 0.4472804069519043
loss_pred:0.023475807160139084, decouple_loss:0.009092290885746479
Iteration: 1352, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4460189938545227
The generated pressure mean: 0.4481850862503052
loss_pred:0.025802958756685257, decouple_loss:0.008974847383797169
loss_pred:0.023314479738473892, decouple_loss:0.008964544162154198
The generated pressure mean: 0.44794392585754395
loss_pred:0.023100649937987328, decouple_loss:0.009164797142148018
Iteration: 1353, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44900283217430115
The generated pressure mean: 0.44775640964508057
loss_pred:0.023484015837311745, decouple_loss:0.008271947503089905
loss_pred:0.02432585507631302, decouple_loss:0.008669215254485607
The generated pressure mean: 0.4493301808834076
loss_pred:0.024284206330776215, decouple_loss:0.00842199381440878
Iteration: 1354, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4488295614719391
The generated pressure mean: 0.44790494441986084
loss_pred:0.022511260583996773, decouple_loss:0.008954178541898727
loss_pred:0.02355039492249489, decouple_loss:0.008454608730971813
The generated pressure mean: 0.44701385498046875
loss_pred:0.02256050519645214, decouple_loss:0.009061905555427074
Iteration: 1355, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4474087357521057
The generated pressure mean: 0.44923028349876404
loss_pred:0.023627905175089836, decouple_loss:0.00933513417840004
loss_pred:0.022407127544283867, decouple_loss:0.009518266655504704
The generated pressure mean: 0.4464573562145233
loss_pred:0.023660553619265556, decouple_loss:0.009165068157017231
Iteration: 1356, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4482327103614807
The generated pressure mean: 0.4482777416706085
loss_pred:0.02268553152680397, decouple_loss:0.010656863451004028
loss_pred:0.021867521107196808, decouple_loss:0.010702712461352348
The generated pressure mean: 0.44661128520965576
loss_pred:0.023469319567084312, decouple_loss:0.010677422396838665
Iteration: 1357, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4485984444618225
The generated pressure mean: 0.44738543033599854
loss_pred:0.024247638881206512, decouple_loss:0.010454618372023106
loss_pred:0.02287334017455578, decouple_loss:0.010467682033777237
The generated pressure mean: 0.447195440530777
loss_pred:0.02275240235030651, decouple_loss:0.01061597652733326
Iteration: 1358, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44750961661338806
The generated pressure mean: 0.4478943943977356
loss_pred:0.021893801167607307, decouple_loss:0.009722212329506874
loss_pred:0.023410001769661903, decouple_loss:0.01034094300121069
The generated pressure mean: 0.44889628887176514
loss_pred:0.02420911006629467, decouple_loss:0.00968146976083517
Iteration: 1359, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4473456144332886The generated pressure mean: 0.4468690752983093
loss_pred:0.024243315681815147, decouple_loss:0.009903645142912865
loss_pred:0.02321079559624195, decouple_loss:0.010087939910590649
The generated pressure mean: 0.44876590371131897
loss_pred:0.02336510829627514, decouple_loss:0.009861188940703869
Iteration: 1360, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44793713092803955
The generated pressure mean: 0.4488774240016937
loss_pred:0.022341126576066017, decouple_loss:0.009010203182697296
loss_pred:0.02164541371166706, decouple_loss:0.0092604486271739
The generated pressure mean: 0.44937461614608765
loss_pred:0.02420659177005291, decouple_loss:0.008903084322810173
2023-04-16 06:22:06 testing...
The generated pressure mean: 0.4495830535888672
The generated pressure mean: 0.4497888684272766
The generated pressure mean: 0.44987666606903076
loss_pred:0.03134370222687721, decouple_loss:0.01003155019134283
loss_pred:0.03226089850068092, decouple_loss:0.010161253623664379
loss_pred:0.03094271942973137, decouple_loss:0.010186868719756603
Loss: 0.032022103667259216, avg_mse: 0.04094840586185455
current test mse: 0.040948
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012010_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012010_3_24hr.npz
NaN value num: 0
Iteration: 1361, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44840723276138306
loss_pred:0.023948630318045616, decouple_loss:0.01042628102004528
The generated pressure mean: 0.44711533188819885
loss_pred:0.023918988183140755, decouple_loss:0.010460667312145233
The generated pressure mean: 0.4476871192455292
loss_pred:0.023860888555645943, decouple_loss:0.010445626452565193
Iteration: 1362, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44708606600761414
The generated pressure mean: 0.44671371579170227
loss_pred:0.02541489340364933, decouple_loss:0.01049498375505209
loss_pred:0.02448819950222969, decouple_loss:0.010341833345592022
The generated pressure mean: 0.4477333128452301
loss_pred:0.023860877379775047, decouple_loss:0.010259796865284443
Iteration: 1363, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4468335509300232
The generated pressure mean: 0.44761788845062256
loss_pred:0.023472759872674942, decouple_loss:0.011167063377797604
loss_pred:0.023938743397593498, decouple_loss:0.011222569271922112
The generated pressure mean: 0.4472237527370453
loss_pred:0.023944711312651634, decouple_loss:0.011145738884806633
Iteration: 1364, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4473837912082672
The generated pressure mean: 0.44661808013916016
loss_pred:0.023519571870565414, decouple_loss:0.009717356413602829
loss_pred:0.026260945945978165, decouple_loss:0.009783892892301083
The generated pressure mean: 0.44749343395233154
loss_pred:0.024936068803071976, decouple_loss:0.009767379611730576
Iteration: 1365, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44771531224250793
The generated pressure mean: 0.44836685061454773
loss_pred:0.023299938067793846, decouple_loss:0.009735162369906902
loss_pred:0.024077098816633224, decouple_loss:0.009702074341475964
The generated pressure mean: 0.4478013217449188
loss_pred:0.025568049401044846, decouple_loss:0.009875055402517319
Iteration: 1366, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44755229353904724
The generated pressure mean: 0.4479389786720276
loss_pred:0.0230952650308609, decouple_loss:0.00915850792080164
loss_pred:0.02374490723013878, decouple_loss:0.009061470627784729
The generated pressure mean: 0.446601003408432
loss_pred:0.023896409198641777, decouple_loss:0.00930340401828289
Iteration: 1367, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4476853907108307
The generated pressure mean: 0.44677478075027466
loss_pred:0.024233762174844742, decouple_loss:0.009068222716450691
loss_pred:0.023896247148513794, decouple_loss:0.009049010463058949
The generated pressure mean: 0.44819462299346924
loss_pred:0.024261657148599625, decouple_loss:0.009011645801365376
Iteration: 1368, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44779470562934875
The generated pressure mean: 0.44731026887893677
loss_pred:0.023304812610149384, decouple_loss:0.009917892515659332
loss_pred:0.023634634912014008, decouple_loss:0.009845048189163208
The generated pressure mean: 0.4481610953807831
loss_pred:0.02312459424138069, decouple_loss:0.009625562466681004
Iteration: 1369, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4479029178619385
The generated pressure mean: 0.4473015367984772
loss_pred:0.024252265691757202, decouple_loss:0.009755163453519344
loss_pred:0.02336275763809681, decouple_loss:0.009591390378773212
The generated pressure mean: 0.44724777340888977
loss_pred:0.024022545665502548, decouple_loss:0.00950250681489706
Iteration: 1370, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4467615783214569
loss_pred:0.022478895261883736, decouple_loss:0.009523985907435417
The generated pressure mean: 0.4480712413787842
loss_pred:0.02469603903591633, decouple_loss:0.009493833407759666
The generated pressure mean: 0.44772449135780334
loss_pred:0.024999292567372322, decouple_loss:0.009283896535634995
2023-04-16 06:24:37 testing...
The generated pressure mean: 0.4495830833911896
The generated pressure mean: 0.4497888684272766
The generated pressure mean: 0.44987666606903076
loss_pred:0.03101911023259163, decouple_loss:0.010028376244008541
loss_pred:0.03195006772875786, decouple_loss:0.010144696570932865
loss_pred:0.03054899349808693, decouple_loss:0.009957339614629745
Loss: 0.03167489916086197, avg_mse: 0.04026055335998535
current test mse: 0.040261
Iteration: 1371, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.447325736284256
The generated pressure mean: 0.44698426127433777
loss_pred:0.024876495823264122, decouple_loss:0.00990837812423706
loss_pred:0.022815661504864693, decouple_loss:0.009883890859782696
The generated pressure mean: 0.4463503658771515
loss_pred:0.022801220417022705, decouple_loss:0.010109306313097477
Iteration: 1372, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4474668502807617
loss_pred:0.023058976978063583, decouple_loss:0.010291848331689835
The generated pressure mean: 0.4484719932079315
loss_pred:0.023813702166080475, decouple_loss:0.010410159826278687
The generated pressure mean: 0.4479878842830658
loss_pred:0.024229178205132484, decouple_loss:0.010501125827431679
Iteration: 1373, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.446433961391449
The generated pressure mean: 0.4480925500392914
loss_pred:0.02478884533047676, decouple_loss:0.009763372130692005
loss_pred:0.023261073976755142, decouple_loss:0.009670676663517952
The generated pressure mean: 0.4461391866207123
loss_pred:0.023446885868906975, decouple_loss:0.009705537930130959
Iteration: 1374, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4475243091583252
loss_pred:0.02362971380352974, decouple_loss:0.009241152554750443
The generated pressure mean: 0.44725489616394043
loss_pred:0.024061253294348717, decouple_loss:0.009417979046702385
The generated pressure mean: 0.4462707042694092
loss_pred:0.024581903591752052, decouple_loss:0.009386789985001087
Iteration: 1375, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44594743847846985
The generated pressure mean: 0.44604799151420593
loss_pred:0.023204267024993896, decouple_loss:0.009182186797261238
loss_pred:0.02460796944797039, decouple_loss:0.009038180112838745
The generated pressure mean: 0.44754186272621155
loss_pred:0.022254647687077522, decouple_loss:0.008975151926279068
Iteration: 1376, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44590359926223755
loss_pred:0.022934896871447563, decouple_loss:0.008717859163880348
The generated pressure mean: 0.4480937123298645
loss_pred:0.023166727274656296, decouple_loss:0.008971761912107468
The generated pressure mean: 0.4485853612422943
loss_pred:0.02612811140716076, decouple_loss:0.009033686481416225
Iteration: 1377, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44760993123054504
The generated pressure mean: 0.4461376368999481
loss_pred:0.023908235132694244, decouple_loss:0.009288281202316284
loss_pred:0.024216918274760246, decouple_loss:0.009563039056956768
The generated pressure mean: 0.4473322331905365
loss_pred:0.023119766265153885, decouple_loss:0.009698617272078991
Iteration: 1378, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44749799370765686
loss_pred:0.024822575971484184, decouple_loss:0.010861819609999657
The generated pressure mean: 0.44736284017562866
loss_pred:0.025392862036824226, decouple_loss:0.01096911821514368
The generated pressure mean: 0.4483828842639923
loss_pred:0.025841252878308296, decouple_loss:0.01078524999320507
Iteration: 1379, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4482315480709076
loss_pred:0.02648185007274151, decouple_loss:0.011727719567716122
The generated pressure mean: 0.44764432311058044
loss_pred:0.024303901940584183, decouple_loss:0.01145658828318119
The generated pressure mean: 0.4472489058971405
loss_pred:0.025777192786335945, decouple_loss:0.011408939026296139
Iteration: 1380, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44793903827667236
loss_pred:0.02573656290769577, decouple_loss:0.010511551052331924
The generated pressure mean: 0.4465268552303314
loss_pred:0.02293984219431877, decouple_loss:0.010613938793540001
The generated pressure mean: 0.44788992404937744
loss_pred:0.02385907620191574, decouple_loss:0.010538116097450256
2023-04-16 06:26:31 testing...
The generated pressure mean: 0.449788898229599
The generated pressure mean: 0.4495830833911896
The generated pressure mean: 0.44987666606903076
loss_pred:0.03272620216012001, decouple_loss:0.012050734832882881
loss_pred:0.031880076974630356, decouple_loss:0.01205646712332964
loss_pred:0.031331971287727356, decouple_loss:0.011990239843726158
Loss: 0.032581038773059845, avg_mse: 0.04136672988533974
current test mse: 0.041367
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012017_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012017_3_24hr.npz
NaN value num: 0
Iteration: 1381, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4484468698501587
loss_pred:0.023856403306126595, decouple_loss:0.01208693627268076
The generated pressure mean: 0.44783854484558105
loss_pred:0.025613734498620033, decouple_loss:0.011965236626565456
The generated pressure mean: 0.44832268357276917
loss_pred:0.024172063916921616, decouple_loss:0.011952840723097324
Iteration: 1382, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44888073205947876
loss_pred:0.024057988077402115, decouple_loss:0.010988044552505016
The generated pressure mean: 0.44791844487190247
loss_pred:0.0264811459928751, decouple_loss:0.010852126404643059
The generated pressure mean: 0.44816482067108154
loss_pred:0.023797767236828804, decouple_loss:0.010882452130317688
Iteration: 1383, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4478228688240051
loss_pred:0.025068994611501694, decouple_loss:0.01104247011244297
The generated pressure mean: 0.4474121332168579
loss_pred:0.024495841935276985, decouple_loss:0.010977308265864849
The generated pressure mean: 0.44863346219062805
loss_pred:0.024296443909406662, decouple_loss:0.011214377358555794
Iteration: 1384, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4465709626674652
The generated pressure mean: 0.44781047105789185
loss_pred:0.025390369817614555, decouple_loss:0.011564226821064949
loss_pred:0.02536807954311371, decouple_loss:0.011734865605831146
The generated pressure mean: 0.4482780992984772
loss_pred:0.024427056312561035, decouple_loss:0.011686504818499088
Iteration: 1385, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4473591446876526
The generated pressure mean: 0.4480619728565216
loss_pred:0.026015277951955795, decouple_loss:0.013804874382913113
loss_pred:0.024243971332907677, decouple_loss:0.013513180427253246
The generated pressure mean: 0.44692254066467285
loss_pred:0.024481596425175667, decouple_loss:0.01372635830193758
Iteration: 1386, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44783005118370056
The generated pressure mean: 0.44872283935546875
loss_pred:0.03015274927020073, decouple_loss:0.0182367991656065
loss_pred:0.02920917049050331, decouple_loss:0.018314780667424202
The generated pressure mean: 0.4476214051246643
loss_pred:0.02952355518937111, decouple_loss:0.01839095540344715
Iteration: 1387, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.448091596364975
loss_pred:0.02865959331393242, decouple_loss:0.020218031480908394
The generated pressure mean: 0.44700318574905396
loss_pred:0.02843269146978855, decouple_loss:0.020134296268224716
The generated pressure mean: 0.44890785217285156
loss_pred:0.028402268886566162, decouple_loss:0.02017367258667946
Iteration: 1388, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4479132294654846
The generated pressure mean: 0.4470321238040924
loss_pred:0.02651268243789673, decouple_loss:0.02215196192264557
loss_pred:0.029031164944171906, decouple_loss:0.0223477091640234
The generated pressure mean: 0.44762372970581055
loss_pred:0.027169404551386833, decouple_loss:0.022372761741280556
Iteration: 1389, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4478556215763092
The generated pressure mean: 0.44811657071113586
loss_pred:0.027830319479107857, decouple_loss:0.02355257421731949
loss_pred:0.026615656912326813, decouple_loss:0.023598313331604004
The generated pressure mean: 0.447463721036911
loss_pred:0.028028998523950577, decouple_loss:0.023674022406339645
Iteration: 1390, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4479690492153168
loss_pred:0.026871323585510254, decouple_loss:0.019405489787459373
The generated pressure mean: 0.4482062757015228
loss_pred:0.028691021725535393, decouple_loss:0.019413117319345474
The generated pressure mean: 0.44800901412963867
loss_pred:0.02635923959314823, decouple_loss:0.01942841149866581
2023-04-16 06:29:01 testing...
The generated pressure mean: 0.4497888684272766
The generated pressure mean: 0.4495830535888672
The generated pressure mean: 0.44987666606903076
loss_pred:0.03591063246130943, decouple_loss:0.023221734911203384
loss_pred:0.03568786010146141, decouple_loss:0.023329338058829308
loss_pred:0.03454377502202988, decouple_loss:0.023208556696772575
Loss: 0.03654341772198677, avg_mse: 0.04563309997320175
current test mse: 0.045633
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1391, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44810548424720764
loss_pred:0.02606985718011856, decouple_loss:0.023140979930758476
The generated pressure mean: 0.4471515715122223
loss_pred:0.029878657311201096, decouple_loss:0.02328084222972393
The generated pressure mean: 0.44823944568634033
loss_pred:0.028512613847851753, decouple_loss:0.02345389872789383
Iteration: 1392, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4472324848175049
loss_pred:0.02608168125152588, decouple_loss:0.019277920946478844
The generated pressure mean: 0.4487875998020172
loss_pred:0.026316797360777855, decouple_loss:0.019492948427796364
The generated pressure mean: 0.44875863194465637
loss_pred:0.026804419234395027, decouple_loss:0.019273364916443825
Iteration: 1393, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44775089621543884
loss_pred:0.027832606807351112, decouple_loss:0.02195732109248638
The generated pressure mean: 0.44733431935310364
loss_pred:0.028148919343948364, decouple_loss:0.02176046371459961
The generated pressure mean: 0.44802403450012207
loss_pred:0.026016006246209145, decouple_loss:0.021558113396167755
Iteration: 1394, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44824522733688354
loss_pred:0.02851770631968975, decouple_loss:0.018919194117188454
The generated pressure mean: 0.44676509499549866
loss_pred:0.027320757508277893, decouple_loss:0.018458809703588486
The generated pressure mean: 0.44879159331321716
loss_pred:0.027067234739661217, decouple_loss:0.01856481283903122
Iteration: 1395, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4481227993965149
loss_pred:0.026043979451060295, decouple_loss:0.02050485461950302
The generated pressure mean: 0.4473021924495697
loss_pred:0.027487708255648613, decouple_loss:0.020479056984186172
The generated pressure mean: 0.44822442531585693
loss_pred:0.027561267837882042, decouple_loss:0.020536508411169052
Iteration: 1396, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44816285371780396
loss_pred:0.02657838724553585, decouple_loss:0.019023116677999496
The generated pressure mean: 0.4478548765182495
loss_pred:0.024768535047769547, decouple_loss:0.019292673096060753
The generated pressure mean: 0.44740691781044006
loss_pred:0.027441473677754402, decouple_loss:0.01896139420568943
Iteration: 1397, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44853079319000244
loss_pred:0.027409806847572327, decouple_loss:0.01748725399374962
The generated pressure mean: 0.44797733426094055
loss_pred:0.024980707094073296, decouple_loss:0.0174601711332798
The generated pressure mean: 0.4480210542678833
loss_pred:0.026125986129045486, decouple_loss:0.01760735921561718
Iteration: 1398, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44830814003944397
The generated pressure mean: 0.4482143521308899
loss_pred:0.0262173879891634, decouple_loss:0.01880650594830513
The generated pressure mean: 0.4461670517921448
loss_pred:0.027704164385795593, decouple_loss:0.01870637759566307
loss_pred:0.027897421270608902, decouple_loss:0.01846492476761341
Iteration: 1399, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44745364785194397
loss_pred:0.03355404734611511, decouple_loss:0.022798430174589157
The generated pressure mean: 0.4477875530719757
loss_pred:0.032542746514081955, decouple_loss:0.02276831492781639
The generated pressure mean: 0.4478570818901062
loss_pred:0.03275779262185097, decouple_loss:0.022828327491879463
Iteration: 1400, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44752660393714905
loss_pred:0.03059614822268486, decouple_loss:0.02049884758889675
The generated pressure mean: 0.44781357049942017
The generated pressure mean: 0.44637298583984375
loss_pred:0.03379252925515175, decouple_loss:0.020640550181269646
loss_pred:0.030748918652534485, decouple_loss:0.020472683012485504
2023-04-16 06:30:56 testing...
The generated pressure mean: 0.4495830833911896
The generated pressure mean: 0.4497888684272766
The generated pressure mean: 0.44987666606903076
loss_pred:0.04279707744717598, decouple_loss:0.02278825454413891
loss_pred:0.043529171496629715, decouple_loss:0.022754570469260216
loss_pred:0.041982296854257584, decouple_loss:0.022853802889585495
Loss: 0.0439094603061676, avg_mse: 0.05590059980750084
current test mse: 0.055901
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012019_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012019_3_24hr.npz
NaN value num: 0
Iteration: 1401, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44886159896850586
loss_pred:0.03352779150009155, decouple_loss:0.022564491257071495
The generated pressure mean: 0.44809702038764954
loss_pred:0.030992617830634117, decouple_loss:0.02226044423878193
The generated pressure mean: 0.4484594762325287
loss_pred:0.031049760058522224, decouple_loss:0.02231336571276188
Iteration: 1402, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.449386328458786
The generated pressure mean: 0.448279470205307
loss_pred:0.029213545843958855, decouple_loss:0.02328077144920826
loss_pred:0.030474042519927025, decouple_loss:0.023312130942940712
The generated pressure mean: 0.4491598308086395
loss_pred:0.030044574290513992, decouple_loss:0.02299795113503933
Iteration: 1403, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4491564631462097
The generated pressure mean: 0.4489581286907196
loss_pred:0.0275594349950552, decouple_loss:0.02060173824429512
loss_pred:0.02859879843890667, decouple_loss:0.02080056257545948
The generated pressure mean: 0.4494182765483856
loss_pred:0.02918992191553116, decouple_loss:0.02060353010892868
Iteration: 1404, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44788870215415955
The generated pressure mean: 0.44853851199150085
loss_pred:0.029360054060816765, decouple_loss:0.021973127499222755
loss_pred:0.02647406980395317, decouple_loss:0.02201109752058983
The generated pressure mean: 0.4491133987903595
loss_pred:0.028815949335694313, decouple_loss:0.022175800055265427
Iteration: 1405, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4487845003604889
The generated pressure mean: 0.4481983482837677
loss_pred:0.028457824140787125, decouple_loss:0.020645592361688614
loss_pred:0.02832181379199028, decouple_loss:0.020805003121495247
The generated pressure mean: 0.4483930170536041
loss_pred:0.028536684811115265, decouple_loss:0.020700573921203613
Iteration: 1406, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4473295211791992
The generated pressure mean: 0.44899260997772217
loss_pred:0.030090661719441414, decouple_loss:0.01987776719033718
loss_pred:0.027132757008075714, decouple_loss:0.019755925983190536
The generated pressure mean: 0.4481312036514282
loss_pred:0.027400577440857887, decouple_loss:0.019758382812142372
Iteration: 1407, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4492949843406677
The generated pressure mean: 0.44797804951667786
loss_pred:0.027027789503335953, decouple_loss:0.020357970148324966
loss_pred:0.027704205363988876, decouple_loss:0.020277895033359528
The generated pressure mean: 0.4478198289871216
loss_pred:0.02733449637889862, decouple_loss:0.02038884535431862
Iteration: 1408, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4488867223262787The generated pressure mean: 0.4489932358264923
loss_pred:0.026413612067699432, decouple_loss:0.01925584115087986loss_pred:0.02825668640434742, decouple_loss:0.01927918568253517
The generated pressure mean: 0.44751986861228943
loss_pred:0.02916940301656723, decouple_loss:0.019208768382668495
Iteration: 1409, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4488207697868347
The generated pressure mean: 0.44908520579338074
loss_pred:0.02788270078599453, decouple_loss:0.019279321655631065
loss_pred:0.02696462720632553, decouple_loss:0.019337931647896767
The generated pressure mean: 0.44957512617111206
loss_pred:0.028723614290356636, decouple_loss:0.01943551003932953
Iteration: 1410, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4480118453502655
loss_pred:0.026944085955619812, decouple_loss:0.017268186435103416
The generated pressure mean: 0.4484134614467621
loss_pred:0.027611851692199707, decouple_loss:0.017211342230439186
The generated pressure mean: 0.4491555690765381
loss_pred:0.028757696971297264, decouple_loss:0.016986781731247902
2023-04-16 06:33:24 testing...
The generated pressure mean: 0.449788898229599
The generated pressure mean: 0.4495830237865448
The generated pressure mean: 0.44987666606903076
loss_pred:0.03542571887373924, decouple_loss:0.01759283058345318
loss_pred:0.03446038439869881, decouple_loss:0.017581582069396973
loss_pred:0.03361756354570389, decouple_loss:0.017560573294758797
Loss: 0.03538013994693756, avg_mse: 0.04451881721615791
current test mse: 0.044519
Iteration: 1411, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4477930963039398
The generated pressure mean: 0.4479733109474182
loss_pred:0.027356021106243134, decouple_loss:0.017403913661837578
loss_pred:0.02889692783355713, decouple_loss:0.017574209719896317
The generated pressure mean: 0.4493795335292816
loss_pred:0.026513192802667618, decouple_loss:0.017587820068001747
Iteration: 1412, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4479416608810425
The generated pressure mean: 0.44895699620246887
loss_pred:0.026226956397294998, decouple_loss:0.016411496326327324
loss_pred:0.02561046928167343, decouple_loss:0.016306063160300255
The generated pressure mean: 0.4486974775791168
loss_pred:0.027755608782172203, decouple_loss:0.01646851748228073
Iteration: 1413, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44877126812934875
The generated pressure mean: 0.4486866891384125
loss_pred:0.025940559804439545, decouple_loss:0.01585220731794834
loss_pred:0.025899279862642288, decouple_loss:0.0161144882440567
The generated pressure mean: 0.4483850300312042
loss_pred:0.02592534013092518, decouple_loss:0.01563938334584236
Iteration: 1414, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4481603503227234
The generated pressure mean: 0.44952592253685
loss_pred:0.02736816368997097, decouple_loss:0.015926767140626907
loss_pred:0.027093444019556046, decouple_loss:0.015620654448866844
The generated pressure mean: 0.4486227035522461
loss_pred:0.026709116995334625, decouple_loss:0.01536358892917633
Iteration: 1415, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44856327772140503
The generated pressure mean: 0.4494834542274475
loss_pred:0.02545848675072193, decouple_loss:0.014814713969826698
loss_pred:0.02463964745402336, decouple_loss:0.014683576300740242
The generated pressure mean: 0.4475438594818115
loss_pred:0.02636270597577095, decouple_loss:0.014794760383665562
Iteration: 1416, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44813087582588196
The generated pressure mean: 0.44782623648643494
loss_pred:0.026070749387145042, decouple_loss:0.014641844667494297
loss_pred:0.026357658207416534, decouple_loss:0.014956239610910416
The generated pressure mean: 0.4475499987602234
loss_pred:0.02698865905404091, decouple_loss:0.01466255821287632
Iteration: 1417, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4490557909011841
The generated pressure mean: 0.44894957542419434
loss_pred:0.027433080598711967, decouple_loss:0.014280473813414574
loss_pred:0.027026230469346046, decouple_loss:0.014354808256030083
The generated pressure mean: 0.4490394592285156
loss_pred:0.02559451013803482, decouple_loss:0.014117768965661526
Iteration: 1418, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4485247731208801
The generated pressure mean: 0.4489731192588806
loss_pred:0.02582070231437683, decouple_loss:0.015511220321059227
loss_pred:0.02419913560152054, decouple_loss:0.015572535805404186
The generated pressure mean: 0.44819584488868713
loss_pred:0.026010707020759583, decouple_loss:0.01562673971056938
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1419, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44903847575187683
loss_pred:0.026089150458574295, decouple_loss:0.014824483543634415
The generated pressure mean: 0.4494486153125763
loss_pred:0.02523060142993927, decouple_loss:0.014680756255984306
The generated pressure mean: 0.4494735300540924
loss_pred:0.02585349790751934, decouple_loss:0.014807160012423992
Iteration: 1420, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4489286243915558
The generated pressure mean: 0.4493986666202545
loss_pred:0.02488582395017147, decouple_loss:0.014203217811882496
loss_pred:0.025541121140122414, decouple_loss:0.0143295181915164
The generated pressure mean: 0.44924524426460266
loss_pred:0.025109313428401947, decouple_loss:0.01419607363641262
2023-04-16 06:35:18 testing...
The generated pressure mean: 0.4495830833911896
The generated pressure mean: 0.449788898229599
The generated pressure mean: 0.44987666606903076
loss_pred:0.0326874703168869, decouple_loss:0.013418171554803848
loss_pred:0.03349384292960167, decouple_loss:0.013416911475360394
loss_pred:0.03218599036335945, decouple_loss:0.013379273936152458
Loss: 0.033459343016147614, avg_mse: 0.042318250983953476
current test mse: 0.042318
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012003_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012003_3_24hr.npz
NaN value num: 0
Iteration: 1421, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4486350119113922
loss_pred:0.024090658873319626, decouple_loss:0.013386104255914688
The generated pressure mean: 0.4476643204689026
loss_pred:0.025470413267612457, decouple_loss:0.01332056988030672
The generated pressure mean: 0.4474150538444519
loss_pred:0.024751150980591774, decouple_loss:0.013295340351760387
Iteration: 1422, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4481634199619293
The generated pressure mean: 0.448375940322876
loss_pred:0.024776561185717583, decouple_loss:0.012578705325722694
loss_pred:0.024862606078386307, decouple_loss:0.0124691566452384
The generated pressure mean: 0.44832900166511536
loss_pred:0.024650035426020622, decouple_loss:0.012490560300648212
Iteration: 1423, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4489436447620392
loss_pred:0.024793274700641632, decouple_loss:0.013376034796237946
The generated pressure mean: 0.44861480593681335
The generated pressure mean: 0.44745132327079773
loss_pred:0.02563277818262577, decouple_loss:0.012832775712013245
loss_pred:0.025642335414886475, decouple_loss:0.012726801447570324
Iteration: 1424, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4481416344642639
loss_pred:0.026254994794726372, decouple_loss:0.014622371643781662
The generated pressure mean: 0.4487239420413971
loss_pred:0.024883193895220757, decouple_loss:0.014963002875447273
The generated pressure mean: 0.44775041937828064
loss_pred:0.025166956707835197, decouple_loss:0.015142311342060566
Iteration: 1425, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4489331543445587
loss_pred:0.025113213807344437, decouple_loss:0.015024671331048012
The generated pressure mean: 0.44884786009788513
The generated pressure mean: 0.4490513205528259
loss_pred:0.02497537061572075, decouple_loss:0.014927830547094345
loss_pred:0.02477962337434292, decouple_loss:0.014945645816624165
Iteration: 1426, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44843608140945435
loss_pred:0.024778252467513084, decouple_loss:0.013037661090493202
The generated pressure mean: 0.44846776127815247
The generated pressure mean: 0.44916537404060364
loss_pred:0.025735018774867058, decouple_loss:0.01311821211129427
loss_pred:0.02495049312710762, decouple_loss:0.013298878446221352
Iteration: 1427, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4480161666870117
loss_pred:0.024422310292720795, decouple_loss:0.012496883980929852
The generated pressure mean: 0.44725608825683594
The generated pressure mean: 0.4484531879425049
loss_pred:0.02499711699783802, decouple_loss:0.012920401990413666
loss_pred:0.024032054468989372, decouple_loss:0.012528405524790287
Iteration: 1428, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4493885040283203
loss_pred:0.02477436698973179, decouple_loss:0.012771028093993664
The generated pressure mean: 0.4481566250324249
The generated pressure mean: 0.4476039409637451
loss_pred:0.023361140862107277, decouple_loss:0.012836109846830368
loss_pred:0.023923370987176895, decouple_loss:0.012732566334307194
Iteration: 1429, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44854146242141724
loss_pred:0.026090169325470924, decouple_loss:0.012667947448790073
The generated pressure mean: 0.4470297396183014
loss_pred:0.02353205345571041, decouple_loss:0.013045228086411953
The generated pressure mean: 0.4469038248062134
loss_pred:0.025002645328640938, decouple_loss:0.013137558475136757
Iteration: 1430, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44844579696655273
loss_pred:0.023991161957383156, decouple_loss:0.010909228585660458
The generated pressure mean: 0.4477507174015045
loss_pred:0.024284517392516136, decouple_loss:0.011047697626054287
The generated pressure mean: 0.44841331243515015
loss_pred:0.02316993661224842, decouple_loss:0.010766495950520039
2023-04-16 06:37:48 testing...
The generated pressure mean: 0.449788898229599
The generated pressure mean: 0.4495830237865448
The generated pressure mean: 0.44987666606903076
loss_pred:0.03266921266913414, decouple_loss:0.01074026245623827
loss_pred:0.03163833171129227, decouple_loss:0.010670207440853119
loss_pred:0.030821889638900757, decouple_loss:0.010837620124220848
Loss: 0.032247282564640045, avg_mse: 0.040813837200403214
current test mse: 0.040814
Iteration: 1431, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44821345806121826
loss_pred:0.0227181538939476, decouple_loss:0.010976563207805157
The generated pressure mean: 0.44679591059684753
loss_pred:0.023704148828983307, decouple_loss:0.011109774932265282
The generated pressure mean: 0.44761529564857483
loss_pred:0.025510266423225403, decouple_loss:0.01079686637967825
Iteration: 1432, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4493597447872162
The generated pressure mean: 0.4505738615989685
loss_pred:0.025620214641094208, decouple_loss:0.011945757083594799
loss_pred:0.023975295946002007, decouple_loss:0.01182082574814558
The generated pressure mean: 0.4489864110946655
loss_pred:0.023788845166563988, decouple_loss:0.012138087302446365
Iteration: 1433, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44889312982559204
The generated pressure mean: 0.4483393728733063
loss_pred:0.02386200986802578, decouple_loss:0.01162555068731308
loss_pred:0.026420917361974716, decouple_loss:0.011744562536478043
The generated pressure mean: 0.4488731920719147
loss_pred:0.02520459145307541, decouple_loss:0.011408807709813118
Iteration: 1434, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44824087619781494
loss_pred:0.024533847346901894, decouple_loss:0.011871377006173134
The generated pressure mean: 0.44823935627937317
loss_pred:0.023277228698134422, decouple_loss:0.01185865793377161
The generated pressure mean: 0.4474274516105652
loss_pred:0.02413010038435459, decouple_loss:0.012600651942193508
Iteration: 1435, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4497413635253906
The generated pressure mean: 0.4482167959213257
loss_pred:0.025297755375504494, decouple_loss:0.010774335823953152
loss_pred:0.024573007598519325, decouple_loss:0.010904775932431221
The generated pressure mean: 0.4477349817752838
loss_pred:0.024525104090571404, decouple_loss:0.010801277123391628
Iteration: 1436, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44795912504196167The generated pressure mean: 0.4488052427768707
loss_pred:0.02412588708102703, decouple_loss:0.01029307022690773
loss_pred:0.02291947603225708, decouple_loss:0.010071828030049801
The generated pressure mean: 0.4476427733898163
loss_pred:0.024900905787944794, decouple_loss:0.010794310830533504
Iteration: 1437, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44853872060775757
The generated pressure mean: 0.44936537742614746
loss_pred:0.02541334554553032, decouple_loss:0.011711026541888714
loss_pred:0.025167327374219894, decouple_loss:0.01158888079226017
The generated pressure mean: 0.4481697380542755
loss_pred:0.02453763224184513, decouple_loss:0.011405491270124912
Iteration: 1438, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44682058691978455
loss_pred:0.025032855570316315, decouple_loss:0.01637643575668335
The generated pressure mean: 0.4480254352092743
loss_pred:0.025927474722266197, decouple_loss:0.016355430707335472
The generated pressure mean: 0.4484662413597107
loss_pred:0.026686836034059525, decouple_loss:0.016224611550569534
Iteration: 1439, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4490232765674591
The generated pressure mean: 0.447870135307312
loss_pred:0.027696935459971428, decouple_loss:0.013741659931838512
loss_pred:0.02668093703687191, decouple_loss:0.01328262872993946
The generated pressure mean: 0.44815993309020996
loss_pred:0.026892701163887978, decouple_loss:0.013575204648077488
Iteration: 1440, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4505002796649933
The generated pressure mean: 0.4472508430480957
loss_pred:0.025262292474508286, decouple_loss:0.013103030622005463
loss_pred:0.02447608858346939, decouple_loss:0.012808670289814472
The generated pressure mean: 0.4480617344379425
loss_pred:0.02517055720090866, decouple_loss:0.012815870344638824
2023-04-16 06:39:41 testing...
The generated pressure mean: 0.4495830535888672
The generated pressure mean: 0.4497888684272766
The generated pressure mean: 0.44987666606903076
loss_pred:0.03261448070406914, decouple_loss:0.01519397459924221
loss_pred:0.033287301659584045, decouple_loss:0.015302754007279873
loss_pred:0.031735241413116455, decouple_loss:0.015431875362992287
Loss: 0.0333111509680748, avg_mse: 0.04183702915906906
current test mse: 0.041837
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012002_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012002_3_24hr.npz
NaN value num: 0
Iteration: 1441, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4466274380683899
loss_pred:0.024694612249732018, decouple_loss:0.015607203356921673
The generated pressure mean: 0.44828417897224426
loss_pred:0.024974195286631584, decouple_loss:0.015432084910571575
The generated pressure mean: 0.44673675298690796
loss_pred:0.025688473135232925, decouple_loss:0.015384875237941742
Iteration: 1442, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44723257422447205
loss_pred:0.025749972090125084, decouple_loss:0.012099571526050568
The generated pressure mean: 0.44854840636253357
loss_pred:0.025094272568821907, decouple_loss:0.011793676763772964
The generated pressure mean: 0.445803701877594
loss_pred:0.024840015918016434, decouple_loss:0.011937574483454227
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1443, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44727280735969543
loss_pred:0.022327782586216927, decouple_loss:0.013325551524758339
The generated pressure mean: 0.4490334689617157
loss_pred:0.02484852820634842, decouple_loss:0.013651217333972454
The generated pressure mean: 0.44550079107284546
loss_pred:0.02478361502289772, decouple_loss:0.014109622687101364
Iteration: 1444, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44501030445098877
loss_pred:0.023737246170639992, decouple_loss:0.014098488725721836
The generated pressure mean: 0.44754672050476074
loss_pred:0.02334447391331196, decouple_loss:0.014180664904415607
The generated pressure mean: 0.4484007954597473
loss_pred:0.025222543627023697, decouple_loss:0.014397809281945229
Iteration: 1445, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4462260901927948
loss_pred:0.024650011211633682, decouple_loss:0.013308837078511715
The generated pressure mean: 0.44644805788993835
loss_pred:0.02396377921104431, decouple_loss:0.013394186273217201
The generated pressure mean: 0.44660380482673645
loss_pred:0.023491447791457176, decouple_loss:0.013238146901130676
Iteration: 1446, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4474528133869171
loss_pred:0.023621486499905586, decouple_loss:0.012387612834572792
The generated pressure mean: 0.44722050428390503
loss_pred:0.02454530820250511, decouple_loss:0.012891827151179314
The generated pressure mean: 0.44669926166534424
loss_pred:0.023746095597743988, decouple_loss:0.012260466814041138
Iteration: 1447, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4475288689136505
loss_pred:0.024798566475510597, decouple_loss:0.014067343436181545
The generated pressure mean: 0.4472738802433014
loss_pred:0.025287751108407974, decouple_loss:0.014050552621483803
The generated pressure mean: 0.4458503723144531
loss_pred:0.0242453645914793, decouple_loss:0.014005163684487343
Iteration: 1448, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44691750407218933
loss_pred:0.025177957490086555, decouple_loss:0.012824898585677147
The generated pressure mean: 0.44646063446998596
loss_pred:0.027558183297514915, decouple_loss:0.012705312110483646
The generated pressure mean: 0.44745752215385437
loss_pred:0.02581370435655117, decouple_loss:0.012915537692606449
Iteration: 1449, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.447200208902359
loss_pred:0.025149798020720482, decouple_loss:0.012018933892250061
The generated pressure mean: 0.4474099576473236
loss_pred:0.02499503083527088, decouple_loss:0.011975872330367565
The generated pressure mean: 0.4465464651584625
loss_pred:0.024572469294071198, decouple_loss:0.011959423311054707
Iteration: 1450, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44783398509025574
loss_pred:0.02414059452712536, decouple_loss:0.011817550286650658
The generated pressure mean: 0.44696521759033203
loss_pred:0.023883862420916557, decouple_loss:0.011720065958797932
The generated pressure mean: 0.44681262969970703
loss_pred:0.025168851017951965, decouple_loss:0.011732533574104309
2023-04-16 06:42:22 testing...
The generated pressure mean: 0.449788898229599
The generated pressure mean: 0.4495830833911896
The generated pressure mean: 0.44987666606903076
loss_pred:0.033650826662778854, decouple_loss:0.01251870859414339
loss_pred:0.032551106065511703, decouple_loss:0.012507326900959015
loss_pred:0.03191753476858139, decouple_loss:0.012645901180803776
Loss: 0.03333435580134392, avg_mse: 0.042763613164424896
current test mse: 0.042764
Iteration: 1451, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44721493124961853
The generated pressure mean: 0.4466102421283722
loss_pred:0.02428506314754486, decouple_loss:0.012639530003070831
loss_pred:0.02438395842909813, decouple_loss:0.012815668247640133
The generated pressure mean: 0.4469771385192871
loss_pred:0.025145385414361954, decouple_loss:0.01266841683536768
Iteration: 1452, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44668179750442505
The generated pressure mean: 0.4478778541088104
loss_pred:0.023814208805561066, decouple_loss:0.01166919432580471
loss_pred:0.02339833416044712, decouple_loss:0.011664736084640026
The generated pressure mean: 0.4455787241458893
loss_pred:0.023473266512155533, decouple_loss:0.011712598614394665
Iteration: 1453, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4464515745639801
The generated pressure mean: 0.4481351971626282
loss_pred:0.024433735758066177, decouple_loss:0.010433432646095753
loss_pred:0.02357340417802334, decouple_loss:0.01025425735861063
The generated pressure mean: 0.44587817788124084
loss_pred:0.024042680859565735, decouple_loss:0.010605484247207642
Iteration: 1454, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44796085357666016
The generated pressure mean: 0.44786348938941956
loss_pred:0.023478984832763672, decouple_loss:0.010901108384132385
loss_pred:0.023901380598545074, decouple_loss:0.010925364680588245
The generated pressure mean: 0.44810187816619873
loss_pred:0.023644493892788887, decouple_loss:0.011039165779948235
Iteration: 1455, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44790753722190857
loss_pred:0.0233084075152874, decouple_loss:0.010208699852228165
The generated pressure mean: 0.44693711400032043
loss_pred:0.024629907682538033, decouple_loss:0.01024850644171238
The generated pressure mean: 0.44642341136932373
loss_pred:0.02389940433204174, decouple_loss:0.010198323056101799
Iteration: 1456, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44710928201675415
The generated pressure mean: 0.4462679922580719
loss_pred:0.025637302547693253, decouple_loss:0.010092757642269135
loss_pred:0.023805422708392143, decouple_loss:0.010352149605751038
The generated pressure mean: 0.4464872479438782
loss_pred:0.02429553121328354, decouple_loss:0.010484202764928341
Iteration: 1457, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4477289915084839
The generated pressure mean: 0.4459763467311859
loss_pred:0.022899668663740158, decouple_loss:0.011362182907760143
loss_pred:0.0227824617177248, decouple_loss:0.011640375480055809
The generated pressure mean: 0.44632357358932495
loss_pred:0.02482745610177517, decouple_loss:0.011659459210932255
Iteration: 1458, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4485968351364136
The generated pressure mean: 0.44610586762428284
loss_pred:0.022731754928827286, decouple_loss:0.010564975440502167
loss_pred:0.023886768147349358, decouple_loss:0.010376914404332638
The generated pressure mean: 0.44760170578956604
loss_pred:0.0213810745626688, decouple_loss:0.010234675370156765
Iteration: 1459, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4477178752422333
The generated pressure mean: 0.4478619396686554
loss_pred:0.023875242099165916, decouple_loss:0.010832562111318111
loss_pred:0.024168292060494423, decouple_loss:0.01030195876955986
The generated pressure mean: 0.44713258743286133
loss_pred:0.02460770308971405, decouple_loss:0.010823381133377552
Iteration: 1460, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44497737288475037The generated pressure mean: 0.4470152258872986
loss_pred:0.024646803736686707, decouple_loss:0.01176346093416214
loss_pred:0.02455548569560051, decouple_loss:0.0115761524066329
The generated pressure mean: 0.44668105244636536
loss_pred:0.024524511769413948, decouple_loss:0.01148530188947916
2023-04-16 06:44:16 testing...
The generated pressure mean: 0.4497888684272766
The generated pressure mean: 0.4495830535888672
The generated pressure mean: 0.44987666606903076
loss_pred:0.03248831257224083, decouple_loss:0.011398623697459698
loss_pred:0.03149525821208954, decouple_loss:0.011364314705133438
loss_pred:0.03076394461095333, decouple_loss:0.01134752668440342
Loss: 0.03215101361274719, avg_mse: 0.04091895744204521
current test mse: 0.040919
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012007_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012007_3_24hr.npz
NaN value num: 0
Iteration: 1461, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4468555450439453
loss_pred:0.023108918219804764, decouple_loss:0.011081377975642681
The generated pressure mean: 0.44795140624046326
The generated pressure mean: 0.44856446981430054
loss_pred:0.02357211522758007, decouple_loss:0.011248339898884296
loss_pred:0.0246299896389246, decouple_loss:0.011430968530476093
Iteration: 1462, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4480031430721283
The generated pressure mean: 0.4501623511314392
loss_pred:0.023089073598384857, decouple_loss:0.010568867437541485
loss_pred:0.022158131003379822, decouple_loss:0.011035142466425896
The generated pressure mean: 0.4471322298049927
loss_pred:0.02310638688504696, decouple_loss:0.010630778968334198
Iteration: 1463, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4495560824871063
The generated pressure mean: 0.44904133677482605
loss_pred:0.02331789769232273, decouple_loss:0.010175609961152077
loss_pred:0.022551007568836212, decouple_loss:0.010159566067159176
The generated pressure mean: 0.4480733871459961
loss_pred:0.026480335742235184, decouple_loss:0.010543066076934338
Iteration: 1464, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4471645653247833
loss_pred:0.023579908534884453, decouple_loss:0.011435366235673428
The generated pressure mean: 0.4475904405117035
loss_pred:0.02376386895775795, decouple_loss:0.011712520383298397
The generated pressure mean: 0.44793441891670227
loss_pred:0.024535756558179855, decouple_loss:0.011559728533029556
Iteration: 1465, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44753527641296387
loss_pred:0.025110317394137383, decouple_loss:0.010677164420485497
The generated pressure mean: 0.44678202271461487
loss_pred:0.02558087557554245, decouple_loss:0.010398687794804573
The generated pressure mean: 0.44821897149086
loss_pred:0.023486798629164696, decouple_loss:0.010632859542965889
Iteration: 1466, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44891953468322754
loss_pred:0.02258065901696682, decouple_loss:0.010844782926142216
The generated pressure mean: 0.4474222660064697
loss_pred:0.022196831181645393, decouple_loss:0.01092979684472084
The generated pressure mean: 0.4483945965766907
loss_pred:0.024479510262608528, decouple_loss:0.01081444788724184
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1467, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44852301478385925
loss_pred:0.022863153368234634, decouple_loss:0.009778708219528198
The generated pressure mean: 0.4483628273010254
loss_pred:0.02300909534096718, decouple_loss:0.009557046927511692
The generated pressure mean: 0.44812509417533875
loss_pred:0.025105278939008713, decouple_loss:0.009809034876525402
Iteration: 1468, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44784075021743774
loss_pred:0.023295508697628975, decouple_loss:0.010486124083399773
The generated pressure mean: 0.4476761221885681
loss_pred:0.023932240903377533, decouple_loss:0.010183773003518581
The generated pressure mean: 0.4482412040233612
loss_pred:0.0238469447940588, decouple_loss:0.010154163464903831
Iteration: 1469, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4474042057991028
loss_pred:0.022981520742177963, decouple_loss:0.011446147225797176
The generated pressure mean: 0.447070837020874
loss_pred:0.023998107761144638, decouple_loss:0.011317241005599499
The generated pressure mean: 0.4480353891849518
loss_pred:0.022685576230287552, decouple_loss:0.011495573446154594
Iteration: 1470, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.448089063167572
loss_pred:0.022895755246281624, decouple_loss:0.010764575563371181
The generated pressure mean: 0.4477677047252655
loss_pred:0.02360488846898079, decouple_loss:0.010795291513204575
The generated pressure mean: 0.4476286470890045
loss_pred:0.023730933666229248, decouple_loss:0.010916819795966148
2023-04-16 06:46:47 testing...
The generated pressure mean: 0.449788898229599
The generated pressure mean: 0.4495830535888672
The generated pressure mean: 0.4498766362667084
loss_pred:0.03150910511612892, decouple_loss:0.009921854361891747
loss_pred:0.03062448836863041, decouple_loss:0.009828760288655758
loss_pred:0.030614681541919708, decouple_loss:0.009941961616277695
Loss: 0.03141096979379654, avg_mse: 0.03989496827125549
current test mse: 0.039895
Iteration: 1471, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4479919672012329The generated pressure mean: 0.4482154846191406
loss_pred:0.022163907065987587, decouple_loss:0.009859362617135048
loss_pred:0.023271197453141212, decouple_loss:0.010059447027742863
The generated pressure mean: 0.4475768506526947
loss_pred:0.024646669626235962, decouple_loss:0.009903651662170887
Iteration: 1472, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44881510734558105
The generated pressure mean: 0.44691556692123413
loss_pred:0.023545796051621437, decouple_loss:0.009357978589832783
loss_pred:0.022796405479311943, decouple_loss:0.009436686523258686
The generated pressure mean: 0.4464145600795746
loss_pred:0.02317461557686329, decouple_loss:0.009555613622069359
Iteration: 1473, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4466298222541809
The generated pressure mean: 0.44617775082588196
loss_pred:0.024719422683119774, decouple_loss:0.010007169097661972
loss_pred:0.023213373497128487, decouple_loss:0.010225550271570683
The generated pressure mean: 0.4492429792881012
loss_pred:0.021713944151997566, decouple_loss:0.01022378820925951
Iteration: 1474, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4482479691505432
loss_pred:0.02376483753323555, decouple_loss:0.0104615967720747
The generated pressure mean: 0.4485396146774292The generated pressure mean: 0.4470553696155548
loss_pred:0.023335013538599014, decouple_loss:0.010502371937036514
loss_pred:0.0223385076969862, decouple_loss:0.010248878039419651
Iteration: 1475, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44771867990493774
loss_pred:0.023180579766631126, decouple_loss:0.009440835565328598
The generated pressure mean: 0.44700509309768677
The generated pressure mean: 0.4500880837440491
loss_pred:0.022448180243372917, decouple_loss:0.009077414870262146
loss_pred:0.02300528809428215, decouple_loss:0.00943832192569971
Iteration: 1476, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.447710245847702
loss_pred:0.023652397096157074, decouple_loss:0.009778416715562344
The generated pressure mean: 0.44823968410491943
The generated pressure mean: 0.4484303593635559
loss_pred:0.024294422939419746, decouple_loss:0.009492049925029278
loss_pred:0.023715676739811897, decouple_loss:0.01014306303113699
Iteration: 1477, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4461434781551361
loss_pred:0.021961556747555733, decouple_loss:0.010679537430405617
The generated pressure mean: 0.44702860713005066
loss_pred:0.022925395518541336, decouple_loss:0.01053814310580492
The generated pressure mean: 0.447837769985199
loss_pred:0.024034976959228516, decouple_loss:0.010707134380936623
Iteration: 1478, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4468880593776703
loss_pred:0.023146018385887146, decouple_loss:0.009782721288502216
The generated pressure mean: 0.44970178604125977
The generated pressure mean: 0.4468289911746979
loss_pred:0.021875794976949692, decouple_loss:0.009747421368956566
loss_pred:0.022353531792759895, decouple_loss:0.009761801920831203
Iteration: 1479, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4472527801990509The generated pressure mean: 0.4477846324443817
loss_pred:0.023039935156702995, decouple_loss:0.010192565619945526loss_pred:0.022817984223365784, decouple_loss:0.010419214144349098
The generated pressure mean: 0.44588345289230347
loss_pred:0.023150181397795677, decouple_loss:0.010297034867107868
Iteration: 1480, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44918563961982727
loss_pred:0.021624194458127022, decouple_loss:0.010002274997532368
The generated pressure mean: 0.4466460347175598
loss_pred:0.022111801430583, decouple_loss:0.010097063146531582
The generated pressure mean: 0.4483294188976288
loss_pred:0.024114618077874184, decouple_loss:0.010018736124038696
2023-04-16 06:48:43 testing...
The generated pressure mean: 0.4495830535888672
The generated pressure mean: 0.4497888684272766
The generated pressure mean: 0.44987666606903076
loss_pred:0.030302440747618675, decouple_loss:0.00976362731307745
loss_pred:0.03135759010910988, decouple_loss:0.00982996728271246
loss_pred:0.030048422515392303, decouple_loss:0.009809642098844051
Loss: 0.031059538945555687, avg_mse: 0.03926179185509682
current test mse: 0.039262
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012015_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012015_3_24hr.npz
NaN value num: 0
Iteration: 1481, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4483889639377594
loss_pred:0.02493899315595627, decouple_loss:0.00996132381260395
The generated pressure mean: 0.44793835282325745
loss_pred:0.02354658767580986, decouple_loss:0.009766358882188797
The generated pressure mean: 0.4479629695415497
loss_pred:0.02581801824271679, decouple_loss:0.010226570069789886
Iteration: 1482, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4490232765674591
The generated pressure mean: 0.4463062286376953
loss_pred:0.026001224294304848, decouple_loss:0.010012217797338963
loss_pred:0.02484937570989132, decouple_loss:0.009711588732898235
The generated pressure mean: 0.44882652163505554
loss_pred:0.026541240513324738, decouple_loss:0.009709125384688377
Iteration: 1483, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44821879267692566
The generated pressure mean: 0.44778892397880554
loss_pred:0.022903988137841225, decouple_loss:0.009306734427809715
loss_pred:0.024233708158135414, decouple_loss:0.009443424642086029
The generated pressure mean: 0.4479886591434479
loss_pred:0.023965435102581978, decouple_loss:0.009241707623004913
Iteration: 1484, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.447562575340271
The generated pressure mean: 0.4487364590167999
loss_pred:0.02228289470076561, decouple_loss:0.009244057349860668
loss_pred:0.026448816061019897, decouple_loss:0.009611651301383972
The generated pressure mean: 0.4476211369037628
loss_pred:0.023988831788301468, decouple_loss:0.00887067336589098
Iteration: 1485, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4474680721759796
The generated pressure mean: 0.44903576374053955loss_pred:0.023253032937645912, decouple_loss:0.009086900390684605
loss_pred:0.023686958476901054, decouple_loss:0.009049121290445328
The generated pressure mean: 0.4471522867679596
loss_pred:0.023770010098814964, decouple_loss:0.009128764271736145
Iteration: 1486, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4453616142272949The generated pressure mean: 0.44860631227493286
The generated pressure mean: 0.4472449719905853loss_pred:0.02508939802646637, decouple_loss:0.009646296501159668loss_pred:0.02398640289902687, decouple_loss:0.009744986891746521
loss_pred:0.02454802580177784, decouple_loss:0.00977308489382267
Iteration: 1487, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44895514845848083
The generated pressure mean: 0.4477511942386627
loss_pred:0.02562595158815384, decouple_loss:0.009416299872100353
loss_pred:0.02307720296084881, decouple_loss:0.009434550069272518
The generated pressure mean: 0.44896137714385986
loss_pred:0.025598764419555664, decouple_loss:0.00939474068582058
Iteration: 1488, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44732344150543213
The generated pressure mean: 0.4474125802516937
loss_pred:0.024462589994072914, decouple_loss:0.009052727371454239
loss_pred:0.024328362196683884, decouple_loss:0.008902164176106453
The generated pressure mean: 0.44764211773872375
loss_pred:0.024297086521983147, decouple_loss:0.008938451297581196
Iteration: 1489, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44919610023498535
The generated pressure mean: 0.44729092717170715
loss_pred:0.0245954692363739, decouple_loss:0.009777833707630634
The generated pressure mean: 0.4475211799144745
loss_pred:0.024569785222411156, decouple_loss:0.00930839218199253
loss_pred:0.0235739815980196, decouple_loss:0.00932883471250534
Iteration: 1490, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4468974173069
The generated pressure mean: 0.4475595951080322
loss_pred:0.025303799659013748, decouple_loss:0.011432524770498276
loss_pred:0.02408522181212902, decouple_loss:0.01115251425653696
The generated pressure mean: 0.4463588297367096
loss_pred:0.02404291369020939, decouple_loss:0.01114495936781168
2023-04-16 06:51:18 testing...
The generated pressure mean: 0.449788898229599
The generated pressure mean: 0.4495830535888672
The generated pressure mean: 0.44987666606903076
loss_pred:0.0315404050052166, decouple_loss:0.00955977849662304
loss_pred:0.03037329390645027, decouple_loss:0.009485107846558094
loss_pred:0.03036617673933506, decouple_loss:0.009621686302125454
Loss: 0.031237734481692314, avg_mse: 0.03956276923418045
current test mse: 0.039563
Iteration: 1491, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44818437099456787
loss_pred:0.024400826543569565, decouple_loss:0.009521462954580784
The generated pressure mean: 0.44779133796691895
loss_pred:0.024826714769005775, decouple_loss:0.009842130355536938
The generated pressure mean: 0.4480310380458832
loss_pred:0.023449910804629326, decouple_loss:0.00943742599338293
Iteration: 1492, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4482065737247467
The generated pressure mean: 0.4485762417316437
loss_pred:0.024214738979935646, decouple_loss:0.00920077320188284
loss_pred:0.02299034222960472, decouple_loss:0.009045641869306564
The generated pressure mean: 0.4482586979866028
loss_pred:0.025304900482296944, decouple_loss:0.009478777647018433
Iteration: 1493, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4471014440059662
The generated pressure mean: 0.4459594190120697
loss_pred:0.024093152955174446, decouple_loss:0.009704411961138248
The generated pressure mean: 0.4471624791622162
loss_pred:0.0247257761657238, decouple_loss:0.009675848297774792
loss_pred:0.02587517723441124, decouple_loss:0.009874645620584488
Iteration: 1494, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4474603533744812
The generated pressure mean: 0.44641435146331787
loss_pred:0.024889377877116203, decouple_loss:0.009327582083642483
loss_pred:0.024500684812664986, decouple_loss:0.009465169161558151
The generated pressure mean: 0.44597190618515015
loss_pred:0.024228623136878014, decouple_loss:0.009744571521878242
Iteration: 1495, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4484703838825226
The generated pressure mean: 0.4480283856391907
loss_pred:0.02371685579419136, decouple_loss:0.010564896278083324
The generated pressure mean: 0.44716429710388184
loss_pred:0.024157488718628883, decouple_loss:0.010482307523488998
loss_pred:0.02324514463543892, decouple_loss:0.010110925883054733
Iteration: 1496, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.447185218334198
The generated pressure mean: 0.4485549032688141
loss_pred:0.02258964627981186, decouple_loss:0.010756313800811768
loss_pred:0.023283028975129128, decouple_loss:0.01090096402913332
The generated pressure mean: 0.4483566880226135
loss_pred:0.023642515763640404, decouple_loss:0.010597477667033672
Iteration: 1497, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4482795298099518
The generated pressure mean: 0.44937098026275635
loss_pred:0.02372804284095764, decouple_loss:0.008643052540719509
loss_pred:0.024883849546313286, decouple_loss:0.008934603072702885
The generated pressure mean: 0.44798973202705383
loss_pred:0.024940166622400284, decouple_loss:0.008327631279826164
Iteration: 1498, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44746753573417664
loss_pred:0.024266375228762627, decouple_loss:0.008936126716434956
The generated pressure mean: 0.44841551780700684
loss_pred:0.02455589734017849, decouple_loss:0.00912983063608408
The generated pressure mean: 0.4481883943080902
loss_pred:0.024205530062317848, decouple_loss:0.008917256258428097
Iteration: 1499, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44597387313842773
The generated pressure mean: 0.445667028427124
loss_pred:0.023860706016421318, decouple_loss:0.010287276469171047
loss_pred:0.02468498796224594, decouple_loss:0.01011051144450903
The generated pressure mean: 0.4484618008136749
loss_pred:0.02373519539833069, decouple_loss:0.009495223872363567
Iteration: 1500, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4484391212463379
The generated pressure mean: 0.4477037489414215
loss_pred:0.023264791816473007, decouple_loss:0.010596667416393757
loss_pred:0.0239093154668808, decouple_loss:0.010653700679540634
The generated pressure mean: 0.44719794392585754
loss_pred:0.023317422717809677, decouple_loss:0.01064831018447876
2023-04-16 06:53:11 testing...
The generated pressure mean: 0.449788898229599
The generated pressure mean: 0.4495830833911896
The generated pressure mean: 0.44987666606903076
loss_pred:0.03287346661090851, decouple_loss:0.011140515096485615
loss_pred:0.03152922913432121, decouple_loss:0.010846941731870174
loss_pred:0.03142579644918442, decouple_loss:0.011014622636139393
Loss: 0.03249286860227585, avg_mse: 0.04199286177754402
current test mse: 0.041993
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012014_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012014_3_24hr.npz
NaN value num: 0
Iteration: 1501, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4458337724208832
loss_pred:0.024575404822826385, decouple_loss:0.011387965641915798
The generated pressure mean: 0.4484091103076935
The generated pressure mean: 0.4452938735485077
loss_pred:0.024512404575943947, decouple_loss:0.011109085753560066
loss_pred:0.024169160053133965, decouple_loss:0.011370452120900154
Iteration: 1502, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4464482367038727
loss_pred:0.023427044972777367, decouple_loss:0.01072703953832388
The generated pressure mean: 0.4472518563270569
loss_pred:0.024389205500483513, decouple_loss:0.010718794539570808
The generated pressure mean: 0.44765180349349976
loss_pred:0.02554185688495636, decouple_loss:0.010767308995127678
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1503, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4465339481830597
The generated pressure mean: 0.4468311667442322
loss_pred:0.023525472730398178, decouple_loss:0.008814590983092785
loss_pred:0.02361788973212242, decouple_loss:0.008900847285985947
The generated pressure mean: 0.4467596709728241
loss_pred:0.02339293248951435, decouple_loss:0.009030735120177269
Iteration: 1504, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4467751085758209
loss_pred:0.02323118969798088, decouple_loss:0.009364529512822628
The generated pressure mean: 0.4476187825202942
The generated pressure mean: 0.4457560181617737
loss_pred:0.02503609098494053, decouple_loss:0.009575732983648777
loss_pred:0.023339029401540756, decouple_loss:0.009452796541154385
Iteration: 1505, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44654616713523865
loss_pred:0.023119941353797913, decouple_loss:0.010080554522573948
The generated pressure mean: 0.4460196793079376
loss_pred:0.02415880747139454, decouple_loss:0.009824960492551327
The generated pressure mean: 0.4469756484031677
loss_pred:0.022871069610118866, decouple_loss:0.010049480013549328
Iteration: 1506, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44622841477394104
loss_pred:0.02527376264333725, decouple_loss:0.008936076425015926
The generated pressure mean: 0.44761812686920166
The generated pressure mean: 0.4465043246746063
loss_pred:0.02311769500374794, decouple_loss:0.008650386705994606
loss_pred:0.024047277867794037, decouple_loss:0.008961479179561138
Iteration: 1507, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4459005892276764
loss_pred:0.023046715185046196, decouple_loss:0.00840593222528696
The generated pressure mean: 0.44718873500823975
The generated pressure mean: 0.44727879762649536
loss_pred:0.023182092234492302, decouple_loss:0.008394181728363037
loss_pred:0.02460918016731739, decouple_loss:0.008425531908869743
Iteration: 1508, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4478432238101959
loss_pred:0.02466708794236183, decouple_loss:0.008625318296253681
The generated pressure mean: 0.4477819800376892
The generated pressure mean: 0.4460561275482178
loss_pred:0.025536885485053062, decouple_loss:0.008498148061335087
loss_pred:0.02272355742752552, decouple_loss:0.008651536889374256
Iteration: 1509, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4466998875141144
loss_pred:0.025035183876752853, decouple_loss:0.00822992343455553
The generated pressure mean: 0.44548192620277405
The generated pressure mean: 0.44665443897247314
loss_pred:0.024951022118330002, decouple_loss:0.0085320258513093
loss_pred:0.023757893592119217, decouple_loss:0.008575472049415112
Iteration: 1510, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4465695321559906
loss_pred:0.023888982832431793, decouple_loss:0.008674436248838902
The generated pressure mean: 0.4465370178222656
The generated pressure mean: 0.4473945200443268
loss_pred:0.02324632741510868, decouple_loss:0.008598865009844303
loss_pred:0.022804712876677513, decouple_loss:0.008753323927521706
2023-04-16 06:55:41 testing...
The generated pressure mean: 0.4495830833911896
The generated pressure mean: 0.4497888684272766
The generated pressure mean: 0.44987666606903076
loss_pred:0.029751049354672432, decouple_loss:0.009277882054448128
loss_pred:0.030636373907327652, decouple_loss:0.009397425688803196
loss_pred:0.02904140017926693, decouple_loss:0.00936077255755663
Loss: 0.03027687594294548, avg_mse: 0.0380515493452549
current test mse: 0.038052
Iteration: 1511, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4480176568031311
loss_pred:0.02461775206029415, decouple_loss:0.00949205830693245
The generated pressure mean: 0.4456821382045746
The generated pressure mean: 0.4464503824710846
loss_pred:0.024870682507753372, decouple_loss:0.009441263973712921
loss_pred:0.02381494641304016, decouple_loss:0.009220193140208721
Iteration: 1512, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4462399482727051
loss_pred:0.024777913466095924, decouple_loss:0.008737991563975811
The generated pressure mean: 0.44631731510162354
loss_pred:0.024099567905068398, decouple_loss:0.00869834516197443
The generated pressure mean: 0.4459228217601776
loss_pred:0.024073196575045586, decouple_loss:0.00884079746901989
Iteration: 1513, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4479432702064514
loss_pred:0.02335951291024685, decouple_loss:0.008845281787216663
The generated pressure mean: 0.4464920163154602
loss_pred:0.023347046226263046, decouple_loss:0.0091242715716362
The generated pressure mean: 0.4464617967605591
loss_pred:0.025329582393169403, decouple_loss:0.009011710993945599
Iteration: 1514, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4480317533016205
loss_pred:0.0222339928150177, decouple_loss:0.008469426073133945
The generated pressure mean: 0.44583743810653687
The generated pressure mean: 0.44619378447532654
loss_pred:0.022976599633693695, decouple_loss:0.008246251381933689
loss_pred:0.023426314815878868, decouple_loss:0.008197247050702572
Iteration: 1515, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44696757197380066
loss_pred:0.023994192481040955, decouple_loss:0.009361849166452885
The generated pressure mean: 0.4467129707336426
loss_pred:0.023602919653058052, decouple_loss:0.009351968765258789
The generated pressure mean: 0.4475099444389343
loss_pred:0.02311275154352188, decouple_loss:0.009293906390666962
Iteration: 1516, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44656628370285034
loss_pred:0.022846156731247902, decouple_loss:0.008548508398234844
The generated pressure mean: 0.44759777188301086
The generated pressure mean: 0.4480520784854889
loss_pred:0.024889538064599037, decouple_loss:0.008646512404084206
loss_pred:0.023245466873049736, decouple_loss:0.00861637108027935
Iteration: 1517, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4474382996559143
loss_pred:0.023282332345843315, decouple_loss:0.008281959220767021
The generated pressure mean: 0.4470368027687073
loss_pred:0.022972628474235535, decouple_loss:0.007900155149400234
The generated pressure mean: 0.4455997347831726
loss_pred:0.02317926287651062, decouple_loss:0.007935845293104649
Iteration: 1518, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44647151231765747
loss_pred:0.022804128006100655, decouple_loss:0.00754271587356925
The generated pressure mean: 0.4466250538825989The generated pressure mean: 0.4474071264266968
loss_pred:0.02368091233074665, decouple_loss:0.007836739532649517
loss_pred:0.023936813697218895, decouple_loss:0.007764444686472416
Iteration: 1519, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44689762592315674
loss_pred:0.023708047345280647, decouple_loss:0.008942186832427979
The generated pressure mean: 0.44623327255249023
The generated pressure mean: 0.44621577858924866
loss_pred:0.023150669410824776, decouple_loss:0.00886229332536459
loss_pred:0.025085628032684326, decouple_loss:0.008831505663692951
Iteration: 1520, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44607147574424744
loss_pred:0.02430136315524578, decouple_loss:0.008711106143891811
The generated pressure mean: 0.4459546208381653
The generated pressure mean: 0.4459230303764343
loss_pred:0.023110104724764824, decouple_loss:0.008785279467701912
loss_pred:0.023134896531701088, decouple_loss:0.008831997402012348
2023-04-16 06:57:34 testing...
The generated pressure mean: 0.4495830237865448
The generated pressure mean: 0.449788898229599
The generated pressure mean: 0.44987666606903076
loss_pred:0.029146894812583923, decouple_loss:0.00817921757698059
loss_pred:0.030305035412311554, decouple_loss:0.008183828555047512
loss_pred:0.028576577082276344, decouple_loss:0.008117260411381721
Loss: 0.029750842601060867, avg_mse: 0.03718795254826546
current test mse: 0.037188
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012007_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012007_3_24hr.npz
NaN value num: 0
Iteration: 1521, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4485163986682892
loss_pred:0.026222513988614082, decouple_loss:0.008434375748038292
The generated pressure mean: 0.44723644852638245
loss_pred:0.02433551661670208, decouple_loss:0.008703827857971191
The generated pressure mean: 0.4481242001056671
loss_pred:0.022069893777370453, decouple_loss:0.008488873951137066
Iteration: 1522, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4483235776424408
The generated pressure mean: 0.4472711682319641
loss_pred:0.02191063016653061, decouple_loss:0.0098026804625988
loss_pred:0.023659056052565575, decouple_loss:0.00979676190763712
The generated pressure mean: 0.449061781167984
loss_pred:0.022967610508203506, decouple_loss:0.009895245544612408
Iteration: 1523, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4484296441078186
loss_pred:0.022991107776761055, decouple_loss:0.009079243056476116
The generated pressure mean: 0.44877690076828003
The generated pressure mean: 0.4483753740787506
loss_pred:0.02280503511428833, decouple_loss:0.009810328483581543
loss_pred:0.023236185312271118, decouple_loss:0.009275194257497787
Iteration: 1524, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4477311670780182
The generated pressure mean: 0.4476485848426819
loss_pred:0.022188561037182808, decouple_loss:0.008628897368907928
loss_pred:0.024332452565431595, decouple_loss:0.008897465653717518
The generated pressure mean: 0.44755682349205017
loss_pred:0.023133346810936928, decouple_loss:0.008697770535945892
Iteration: 1525, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4481548070907593
loss_pred:0.02262098900973797, decouple_loss:0.00986817292869091
The generated pressure mean: 0.446613073348999
The generated pressure mean: 0.4482242166996002loss_pred:0.0229319017380476, decouple_loss:0.009760274551808834
loss_pred:0.022486601024866104, decouple_loss:0.009874927811324596
Iteration: 1526, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.447469562292099
The generated pressure mean: 0.44736185669898987
The generated pressure mean: 0.44728949666023254loss_pred:0.02224096655845642, decouple_loss:0.00981341116130352
loss_pred:0.022614052519202232, decouple_loss:0.01019812561571598
loss_pred:0.02307608723640442, decouple_loss:0.009656310081481934
Iteration: 1527, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4481460750102997
loss_pred:0.022974712774157524, decouple_loss:0.009455645456910133
The generated pressure mean: 0.4476816654205322
loss_pred:0.02317693829536438, decouple_loss:0.00967321079224348
The generated pressure mean: 0.44763848185539246
loss_pred:0.02350356988608837, decouple_loss:0.00950655434280634
Iteration: 1528, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44777804613113403
loss_pred:0.02238496206700802, decouple_loss:0.009568780660629272
The generated pressure mean: 0.4485977590084076
loss_pred:0.02258489280939102, decouple_loss:0.009742693975567818
The generated pressure mean: 0.44736236333847046
loss_pred:0.02361268922686577, decouple_loss:0.009615407325327396
Iteration: 1529, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4479518532752991
loss_pred:0.023408928886055946, decouple_loss:0.008994139730930328
The generated pressure mean: 0.44834771752357483
loss_pred:0.0236898735165596, decouple_loss:0.00894444715231657
The generated pressure mean: 0.448378324508667
loss_pred:0.024531733244657516, decouple_loss:0.008928871713578701
Iteration: 1530, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4483779966831207
loss_pred:0.023464960977435112, decouple_loss:0.009176814928650856
The generated pressure mean: 0.44750353693962097
loss_pred:0.024106351658701897, decouple_loss:0.009264293126761913
The generated pressure mean: 0.4474526643753052
loss_pred:0.021658120676875114, decouple_loss:0.009239288978278637
2023-04-16 07:00:05 testing...
The generated pressure mean: 0.4497888684272766
The generated pressure mean: 0.4495830535888672
The generated pressure mean: 0.44987666606903076
loss_pred:0.031895656138658524, decouple_loss:0.009512540884315968
loss_pred:0.03108072280883789, decouple_loss:0.009467251598834991
loss_pred:0.03046685829758644, decouple_loss:0.009525145404040813
Loss: 0.03162282705307007, avg_mse: 0.04070078954100609
current test mse: 0.040701
Iteration: 1531, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44808003306388855
loss_pred:0.023054899647831917, decouple_loss:0.009770144708454609
The generated pressure mean: 0.44872990250587463
loss_pred:0.02246255613863468, decouple_loss:0.009404639713466167
The generated pressure mean: 0.4486527442932129
loss_pred:0.022940978407859802, decouple_loss:0.00940033234655857
Iteration: 1532, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4484996497631073
loss_pred:0.022497527301311493, decouple_loss:0.008763636462390423
The generated pressure mean: 0.4483889937400818
loss_pred:0.022572601214051247, decouple_loss:0.008623550646007061
The generated pressure mean: 0.4490264058113098
loss_pred:0.023072553798556328, decouple_loss:0.008749289438128471
Iteration: 1533, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4493151009082794
loss_pred:0.02336539886891842, decouple_loss:0.008556981571018696
The generated pressure mean: 0.44730043411254883
The generated pressure mean: 0.4479582905769348
loss_pred:0.022698406130075455, decouple_loss:0.008500459603965282
loss_pred:0.022092236205935478, decouple_loss:0.008775785565376282
Iteration: 1534, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44812268018722534
loss_pred:0.023559480905532837, decouple_loss:0.008223638869822025
The generated pressure mean: 0.44711461663246155
The generated pressure mean: 0.4480278789997101
loss_pred:0.023774979636073112, decouple_loss:0.008135897107422352
loss_pred:0.023937562480568886, decouple_loss:0.008339205756783485
Iteration: 1535, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4475187361240387
loss_pred:0.022748315706849098, decouple_loss:0.008162843994796276
The generated pressure mean: 0.44729694724082947
The generated pressure mean: 0.446932315826416
loss_pred:0.023312484845519066, decouple_loss:0.008095513097941875
loss_pred:0.02257576398551464, decouple_loss:0.008261366747319698
Iteration: 1536, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4480270743370056
loss_pred:0.024468639865517616, decouple_loss:0.008417981676757336
The generated pressure mean: 0.4484992027282715
The generated pressure mean: 0.44846054911613464
loss_pred:0.02268083766102791, decouple_loss:0.008531020022928715
loss_pred:0.022581536322832108, decouple_loss:0.008288531564176083
Iteration: 1537, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44745561480522156
loss_pred:0.023472022265195847, decouple_loss:0.008724691346287727
The generated pressure mean: 0.44725486636161804
The generated pressure mean: 0.44817668199539185
loss_pred:0.02363855205476284, decouple_loss:0.008681491017341614
loss_pred:0.023160625249147415, decouple_loss:0.008572797290980816
Iteration: 1538, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4493856132030487
loss_pred:0.02328120917081833, decouple_loss:0.008637659251689911
The generated pressure mean: 0.4477725923061371
loss_pred:0.022838616743683815, decouple_loss:0.008913252502679825
The generated pressure mean: 0.4481067955493927
loss_pred:0.02137385867536068, decouple_loss:0.008619915693998337
Iteration: 1539, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44762122631073
loss_pred:0.02269740216434002, decouple_loss:0.008490553125739098
The generated pressure mean: 0.447090744972229
The generated pressure mean: 0.4471547603607178
loss_pred:0.0224900059401989, decouple_loss:0.008391272276639938
loss_pred:0.021982969716191292, decouple_loss:0.00827784463763237
Iteration: 1540, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44857344031333923
loss_pred:0.023858970031142235, decouple_loss:0.008036261424422264
The generated pressure mean: 0.44796130061149597
loss_pred:0.022223109379410744, decouple_loss:0.007977298460900784
The generated pressure mean: 0.4473142623901367
loss_pred:0.023910295218229294, decouple_loss:0.008299145847558975
2023-04-16 07:01:58 testing...
The generated pressure mean: 0.4495830833911896
The generated pressure mean: 0.449788898229599
The generated pressure mean: 0.44987666606903076
loss_pred:0.029905937612056732, decouple_loss:0.00826387107372284
loss_pred:0.030948344618082047, decouple_loss:0.008391081355512142
loss_pred:0.029059259220957756, decouple_loss:0.008342858403921127
Loss: 0.030387811362743378, avg_mse: 0.038499098271131516
current test mse: 0.038499
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012003_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012003_3_24hr.npz
NaN value num: 0
Iteration: 1541, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44710773229599
loss_pred:0.024713682010769844, decouple_loss:0.00850551389157772
The generated pressure mean: 0.44874122738838196
The generated pressure mean: 0.4483591914176941
loss_pred:0.02464553713798523, decouple_loss:0.008364427834749222
loss_pred:0.023442821577191353, decouple_loss:0.00845066737383604
Iteration: 1542, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4486619234085083
The generated pressure mean: 0.4482533037662506
loss_pred:0.02384435012936592, decouple_loss:0.008718973025679588
loss_pred:0.02341274917125702, decouple_loss:0.008784067817032337
The generated pressure mean: 0.44751811027526855
loss_pred:0.023165389895439148, decouple_loss:0.008812635205686092
Iteration: 1543, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44841238856315613
The generated pressure mean: 0.4497060775756836
loss_pred:0.02399744652211666, decouple_loss:0.00870478991419077
loss_pred:0.022402632981538773, decouple_loss:0.009206032380461693
The generated pressure mean: 0.44777509570121765
loss_pred:0.023507900536060333, decouple_loss:0.008772308006882668
Iteration: 1544, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44785627722740173
loss_pred:0.02316688559949398, decouple_loss:0.00860014371573925
The generated pressure mean: 0.44851943850517273
loss_pred:0.022417159751057625, decouple_loss:0.008658395148813725
The generated pressure mean: 0.447377473115921
loss_pred:0.02237805351614952, decouple_loss:0.008401700295507908
Iteration: 1545, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4494568407535553
loss_pred:0.023644359782338142, decouple_loss:0.008609436452388763
The generated pressure mean: 0.4475441873073578
loss_pred:0.02227320894598961, decouple_loss:0.008436305448412895
The generated pressure mean: 0.44847288727760315
loss_pred:0.02274750918149948, decouple_loss:0.00870438851416111
Iteration: 1546, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44823116064071655
loss_pred:0.024110862985253334, decouple_loss:0.008871281519532204
The generated pressure mean: 0.44750773906707764
The generated pressure mean: 0.4491927921772003loss_pred:0.021771183237433434, decouple_loss:0.008981671184301376
loss_pred:0.02409403771162033, decouple_loss:0.008771205320954323
Iteration: 1547, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44809481501579285
loss_pred:0.022543923929333687, decouple_loss:0.008711745031177998
The generated pressure mean: 0.44918733835220337
loss_pred:0.023897958919405937, decouple_loss:0.008790072053670883
The generated pressure mean: 0.44772955775260925
loss_pred:0.022922666743397713, decouple_loss:0.008584539406001568
Iteration: 1548, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44741371273994446
loss_pred:0.023251745849847794, decouple_loss:0.00883515179157257
The generated pressure mean: 0.447196900844574
loss_pred:0.024403171613812447, decouple_loss:0.008842731826007366
The generated pressure mean: 0.4485880732536316
loss_pred:0.023378727957606316, decouple_loss:0.008811015635728836
Iteration: 1549, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4484138786792755
loss_pred:0.024557938799262047, decouple_loss:0.008840817026793957
The generated pressure mean: 0.4495103657245636
loss_pred:0.022546377032995224, decouple_loss:0.008970165625214577
The generated pressure mean: 0.4471484422683716
loss_pred:0.027196791023015976, decouple_loss:0.008825568482279778
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1550, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4473952651023865
loss_pred:0.02103063277900219, decouple_loss:0.008970079943537712
The generated pressure mean: 0.44756534695625305
loss_pred:0.023708702996373177, decouple_loss:0.009391233325004578
The generated pressure mean: 0.44870465993881226
loss_pred:0.02289530821144581, decouple_loss:0.009027398191392422
2023-04-16 07:04:35 testing...
The generated pressure mean: 0.4495830833911896
The generated pressure mean: 0.4497888684272766
The generated pressure mean: 0.44987666606903076
loss_pred:0.030187532305717468, decouple_loss:0.008507704362273216
loss_pred:0.03126861900091171, decouple_loss:0.008617829531431198
loss_pred:0.03008951246738434, decouple_loss:0.008464845828711987
Loss: 0.030941728502511978, avg_mse: 0.03960004076361656
current test mse: 0.0396
Iteration: 1551, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4476287364959717
The generated pressure mean: 0.4481275677680969
loss_pred:0.022752508521080017, decouple_loss:0.008461175486445427
loss_pred:0.0235114935785532, decouple_loss:0.008529793471097946
The generated pressure mean: 0.44828882813453674
loss_pred:0.023875759914517403, decouple_loss:0.008243998512625694
Iteration: 1552, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4486084282398224
loss_pred:0.024929318577051163, decouple_loss:0.009286980144679546
The generated pressure mean: 0.44784730672836304
loss_pred:0.023680590093135834, decouple_loss:0.008967912755906582
The generated pressure mean: 0.44821539521217346
loss_pred:0.023366227746009827, decouple_loss:0.009020153433084488
Iteration: 1553, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44995635747909546
loss_pred:0.02348659560084343, decouple_loss:0.008128653280436993
The generated pressure mean: 0.4481653571128845
The generated pressure mean: 0.4480276107788086
loss_pred:0.0237844530493021, decouple_loss:0.008100556209683418
loss_pred:0.023877670988440514, decouple_loss:0.00818375963717699
Iteration: 1554, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44710564613342285
loss_pred:0.022246452048420906, decouple_loss:0.009237194433808327
The generated pressure mean: 0.44804149866104126
The generated pressure mean: 0.4484110474586487
loss_pred:0.02514772117137909, decouple_loss:0.009333882480859756
loss_pred:0.02512311562895775, decouple_loss:0.009172032587230206
Iteration: 1555, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4503796696662903
loss_pred:0.022853849455714226, decouple_loss:0.009153550490736961
The generated pressure mean: 0.44768255949020386
loss_pred:0.021620504558086395, decouple_loss:0.008977935649454594
The generated pressure mean: 0.4484435021877289
loss_pred:0.02280060388147831, decouple_loss:0.00875875260680914
Iteration: 1556, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44860878586769104
loss_pred:0.023247094824910164, decouple_loss:0.009009460918605328
The generated pressure mean: 0.44771498441696167
loss_pred:0.023209339007735252, decouple_loss:0.008859195746481419
The generated pressure mean: 0.4472081959247589
loss_pred:0.023344717919826508, decouple_loss:0.008967099711298943
Iteration: 1557, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4477750062942505
loss_pred:0.024629008024930954, decouple_loss:0.008332871831953526
The generated pressure mean: 0.4473778009414673
The generated pressure mean: 0.4482789933681488
loss_pred:0.02286754548549652, decouple_loss:0.008254289627075195
loss_pred:0.024860607460141182, decouple_loss:0.00811459869146347
Iteration: 1558, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4476041793823242
loss_pred:0.023693935945630074, decouple_loss:0.007905218750238419
The generated pressure mean: 0.44741255044937134
loss_pred:0.022242501378059387, decouple_loss:0.008113126270473003
The generated pressure mean: 0.4473389685153961
loss_pred:0.02041397988796234, decouple_loss:0.008051675744354725
Iteration: 1559, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4483295679092407
loss_pred:0.02387910522520542, decouple_loss:0.009251384995877743
The generated pressure mean: 0.44824665784835815
loss_pred:0.023172983899712563, decouple_loss:0.009428809396922588
The generated pressure mean: 0.4479374587535858
loss_pred:0.023876728489995003, decouple_loss:0.009250347502529621
Iteration: 1560, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44805198907852173
loss_pred:0.022488897666335106, decouple_loss:0.009425423108041286
The generated pressure mean: 0.4478241801261902
loss_pred:0.023034343495965004, decouple_loss:0.009305973537266254
The generated pressure mean: 0.44813817739486694
loss_pred:0.022604534402489662, decouple_loss:0.009853237308561802
2023-04-16 07:06:28 testing...
The generated pressure mean: 0.4497888684272766
The generated pressure mean: 0.4495830833911896
The generated pressure mean: 0.44987666606903076
loss_pred:0.03088022582232952, decouple_loss:0.008568519726395607
loss_pred:0.029775436967611313, decouple_loss:0.008418884128332138
loss_pred:0.029164839535951614, decouple_loss:0.008429060690104961
Loss: 0.0303637757897377, avg_mse: 0.03851485252380371
current test mse: 0.038515
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012013_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012013_3_24hr.npz
NaN value num: 0
Iteration: 1561, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44725826382637024
loss_pred:0.021762123331427574, decouple_loss:0.008955189026892185
The generated pressure mean: 0.4470864534378052
The generated pressure mean: 0.44732221961021423
loss_pred:0.023037973791360855, decouple_loss:0.009048987179994583
loss_pred:0.022147826850414276, decouple_loss:0.00876828096807003
Iteration: 1562, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44876283407211304
loss_pred:0.025745831429958344, decouple_loss:0.009609663859009743
The generated pressure mean: 0.44788146018981934
loss_pred:0.022165926173329353, decouple_loss:0.00955263338983059
The generated pressure mean: 0.44799885153770447
loss_pred:0.022624148055911064, decouple_loss:0.009290080517530441
Iteration: 1563, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4470941126346588
The generated pressure mean: 0.44819068908691406
loss_pred:0.022989889606833458, decouple_loss:0.00939815491437912
loss_pred:0.022214431315660477, decouple_loss:0.009545376524329185
The generated pressure mean: 0.4467791020870209
loss_pred:0.024338366463780403, decouple_loss:0.00942476186901331
Iteration: 1564, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.446719229221344
The generated pressure mean: 0.44691383838653564
loss_pred:0.023100456222891808, decouple_loss:0.0096351383253932
loss_pred:0.024637797847390175, decouple_loss:0.009608945809304714
The generated pressure mean: 0.44681647419929504
loss_pred:0.024187561124563217, decouple_loss:0.00971092376857996
Iteration: 1565, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4485374093055725
The generated pressure mean: 0.4469221234321594
loss_pred:0.023122426122426987, decouple_loss:0.008843368850648403
loss_pred:0.023001249879598618, decouple_loss:0.008865267038345337
The generated pressure mean: 0.4481365978717804
loss_pred:0.023391203954815865, decouple_loss:0.008945763111114502
Iteration: 1566, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4478975534439087
The generated pressure mean: 0.4472711682319641
loss_pred:0.023283900693058968, decouple_loss:0.008851795457303524
loss_pred:0.022247565910220146, decouple_loss:0.008756319060921669
The generated pressure mean: 0.4480471909046173
loss_pred:0.02255677990615368, decouple_loss:0.00856647826731205
Iteration: 1567, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4477559030056
The generated pressure mean: 0.448482483625412
loss_pred:0.021944314241409302, decouple_loss:0.008276814594864845
loss_pred:0.024383092299103737, decouple_loss:0.007994397543370724
The generated pressure mean: 0.44742703437805176
loss_pred:0.02281985618174076, decouple_loss:0.00799061544239521
Iteration: 1568, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4479955732822418The generated pressure mean: 0.446549654006958
loss_pred:0.022219182923436165, decouple_loss:0.010166611522436142
loss_pred:0.023108189925551414, decouple_loss:0.009868243709206581
The generated pressure mean: 0.44745805859565735
loss_pred:0.02323850430548191, decouple_loss:0.010380847379565239
Iteration: 1569, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4473112225532532
The generated pressure mean: 0.4466283321380615loss_pred:0.023476023226976395, decouple_loss:0.008650990203022957
loss_pred:0.022461574524641037, decouple_loss:0.0087418919429183
The generated pressure mean: 0.44889259338378906
loss_pred:0.02337939664721489, decouple_loss:0.008727354928851128
Iteration: 1570, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44724032282829285
loss_pred:0.022312013432383537, decouple_loss:0.008856013417243958The generated pressure mean: 0.4482991695404053
loss_pred:0.022077417001128197, decouple_loss:0.008574946783483028
The generated pressure mean: 0.44652217626571655
loss_pred:0.02291160449385643, decouple_loss:0.008754326961934566
2023-04-16 07:08:56 testing...
The generated pressure mean: 0.4495830535888672
The generated pressure mean: 0.449788898229599
The generated pressure mean: 0.44987666606903076
loss_pred:0.031235476955771446, decouple_loss:0.008090716786682606
loss_pred:0.03214287385344505, decouple_loss:0.008135983720421791
loss_pred:0.03103938326239586, decouple_loss:0.008298099972307682
Loss: 0.03188132494688034, avg_mse: 0.041578348726034164
current test mse: 0.041578
Iteration: 1571, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4467009902000427
The generated pressure mean: 0.44750797748565674
loss_pred:0.022899573668837547, decouple_loss:0.008045499213039875
loss_pred:0.021944435313344002, decouple_loss:0.008118380792438984
The generated pressure mean: 0.44628435373306274
loss_pred:0.022889265790581703, decouple_loss:0.008141138590872288
Iteration: 1572, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44629597663879395
loss_pred:0.023218516260385513, decouple_loss:0.008086487650871277
The generated pressure mean: 0.4474667012691498
loss_pred:0.022313684225082397, decouple_loss:0.007952750660479069
The generated pressure mean: 0.4478999078273773
loss_pred:0.023179223760962486, decouple_loss:0.007646022830158472
Iteration: 1573, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.447113960981369
loss_pred:0.022743050009012222, decouple_loss:0.008295932784676552
The generated pressure mean: 0.4465149939060211
loss_pred:0.021978814154863358, decouple_loss:0.008624550886452198
The generated pressure mean: 0.44799256324768066
loss_pred:0.023359058424830437, decouple_loss:0.008289579302072525
Iteration: 1574, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44784659147262573
loss_pred:0.02196890488266945, decouple_loss:0.008578034117817879
The generated pressure mean: 0.44692462682724
loss_pred:0.02434086985886097, decouple_loss:0.008803484961390495
The generated pressure mean: 0.44717198610305786
loss_pred:0.02168167196214199, decouple_loss:0.008615536615252495
Iteration: 1575, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44763094186782837
The generated pressure mean: 0.44627130031585693
loss_pred:0.02323843538761139, decouple_loss:0.00907590426504612
loss_pred:0.023289846256375313, decouple_loss:0.008913788013160229
The generated pressure mean: 0.4470464587211609
loss_pred:0.024754906073212624, decouple_loss:0.009068801999092102
Iteration: 1576, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4474714398384094
The generated pressure mean: 0.44776856899261475
loss_pred:0.022990355268120766, decouple_loss:0.008913089521229267
loss_pred:0.02318582870066166, decouple_loss:0.008782547898590565
The generated pressure mean: 0.4474093019962311
loss_pred:0.022775879129767418, decouple_loss:0.008580454625189304
Iteration: 1577, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4474468231201172
The generated pressure mean: 0.44877997040748596
loss_pred:0.02107277698814869, decouple_loss:0.007659873925149441
loss_pred:0.02258751168847084, decouple_loss:0.00751835061237216
The generated pressure mean: 0.44708892703056335
loss_pred:0.02376781962811947, decouple_loss:0.007829665206372738
Iteration: 1578, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44752824306488037
The generated pressure mean: 0.4483894109725952
loss_pred:0.02217622846364975, decouple_loss:0.008586535230278969
loss_pred:0.02208472602069378, decouple_loss:0.008465130813419819
The generated pressure mean: 0.44891631603240967
loss_pred:0.02285013720393181, decouple_loss:0.00861347932368517
Iteration: 1579, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.448162704706192
The generated pressure mean: 0.4480850398540497
loss_pred:0.02303895354270935, decouple_loss:0.008296186104416847
loss_pred:0.022168472409248352, decouple_loss:0.008484454825520515
The generated pressure mean: 0.4468412697315216
loss_pred:0.022995807230472565, decouple_loss:0.008371974341571331
Iteration: 1580, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4472111463546753
loss_pred:0.024086840450763702, decouple_loss:0.008222741074860096
The generated pressure mean: 0.44779109954833984
loss_pred:0.02228737808763981, decouple_loss:0.008626916445791721
The generated pressure mean: 0.4487041234970093
loss_pred:0.022431593388319016, decouple_loss:0.008193406276404858
2023-04-16 07:10:50 testing...
The generated pressure mean: 0.4495830833911896
The generated pressure mean: 0.449788898229599
The generated pressure mean: 0.44987666606903076
loss_pred:0.029480300843715668, decouple_loss:0.00818235706537962
loss_pred:0.03037453070282936, decouple_loss:0.008356350474059582
loss_pred:0.02904326468706131, decouple_loss:0.008407551795244217
Loss: 0.030048470944166183, avg_mse: 0.037988729774951935
current test mse: 0.037989
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012008_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012008_3_24hr.npz
NaN value num: 0
Iteration: 1581, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4481048285961151
loss_pred:0.021701276302337646, decouple_loss:0.00863559078425169
The generated pressure mean: 0.44977760314941406
loss_pred:0.0223250612616539, decouple_loss:0.008640504442155361
The generated pressure mean: 0.4482094943523407
loss_pred:0.022619174793362617, decouple_loss:0.008165991865098476
Iteration: 1582, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44692468643188477
loss_pred:0.0230373814702034, decouple_loss:0.009421509690582752
The generated pressure mean: 0.44802582263946533
loss_pred:0.021404555067420006, decouple_loss:0.009053559973835945
The generated pressure mean: 0.44900399446487427
loss_pred:0.02282783016562462, decouple_loss:0.009078671224415302
Iteration: 1583, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44713103771209717
The generated pressure mean: 0.4483950734138489
loss_pred:0.021788861602544785, decouple_loss:0.009396352805197239
loss_pred:0.022467782720923424, decouple_loss:0.009620275348424911
The generated pressure mean: 0.44643887877464294
loss_pred:0.023038513958454132, decouple_loss:0.009678776375949383
Iteration: 1584, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4481593668460846
The generated pressure mean: 0.449179083108902
loss_pred:0.023278873413801193, decouple_loss:0.009142800234258175
loss_pred:0.022611984983086586, decouple_loss:0.008867102675139904
The generated pressure mean: 0.44798722863197327
loss_pred:0.022647885605692863, decouple_loss:0.009246684610843658
Iteration: 1585, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4477499723434448
loss_pred:0.022273050621151924, decouple_loss:0.008361691609025002
The generated pressure mean: 0.44826120138168335
loss_pred:0.022842692211270332, decouple_loss:0.008429907262325287
The generated pressure mean: 0.4466054141521454
loss_pred:0.024568621069192886, decouple_loss:0.008703870698809624
Iteration: 1586, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4479799270629883
The generated pressure mean: 0.4485139846801758
loss_pred:0.022718271240592003, decouple_loss:0.009022335521876812
loss_pred:0.02240806818008423, decouple_loss:0.009086035192012787
The generated pressure mean: 0.44828876852989197
loss_pred:0.022228917106986046, decouple_loss:0.009023231454193592
Iteration: 1587, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44617438316345215
The generated pressure mean: 0.44781965017318726
loss_pred:0.02339133620262146, decouple_loss:0.009410901926457882
loss_pred:0.024386068806052208, decouple_loss:0.009580242447555065
The generated pressure mean: 0.44779497385025024
loss_pred:0.02310543693602085, decouple_loss:0.009710022248327732
Iteration: 1588, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44793081283569336
loss_pred:0.023342180997133255, decouple_loss:0.00897759199142456
The generated pressure mean: 0.4472024142742157
loss_pred:0.022912316024303436, decouple_loss:0.009036445058882236
The generated pressure mean: 0.44762831926345825
loss_pred:0.022753160446882248, decouple_loss:0.009182371199131012
Iteration: 1589, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44765833020210266
loss_pred:0.022859293967485428, decouple_loss:0.008131979033350945
The generated pressure mean: 0.44751372933387756
loss_pred:0.022408535704016685, decouple_loss:0.007985500618815422
The generated pressure mean: 0.4475749433040619
loss_pred:0.022290760651230812, decouple_loss:0.008350305259227753
Iteration: 1590, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44690242409706116
The generated pressure mean: 0.4484352171421051
loss_pred:0.023209402337670326, decouple_loss:0.00898096151649952
loss_pred:0.023086924105882645, decouple_loss:0.00930310133844614
The generated pressure mean: 0.4477563202381134
loss_pred:0.021605024114251137, decouple_loss:0.009425084106624126
2023-04-16 07:13:21 testing...
The generated pressure mean: 0.4497888684272766
The generated pressure mean: 0.4495830535888672
The generated pressure mean: 0.44987666606903076
loss_pred:0.030267905443906784, decouple_loss:0.009401736781001091
loss_pred:0.029324771836400032, decouple_loss:0.009148984216153622
loss_pred:0.02904842048883438, decouple_loss:0.009314898401498795
Loss: 0.030011460185050964, avg_mse: 0.03795871138572693
current test mse: 0.037959
Iteration: 1591, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4494810402393341
loss_pred:0.022485781461000443, decouple_loss:0.00967569649219513
The generated pressure mean: 0.4471588730812073
loss_pred:0.021357998251914978, decouple_loss:0.009418818168342113
The generated pressure mean: 0.4468735456466675
loss_pred:0.023761888965964317, decouple_loss:0.009304406121373177
Iteration: 1592, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4468684494495392
loss_pred:0.022391164675354958, decouple_loss:0.009002592414617538
The generated pressure mean: 0.4467870593070984
loss_pred:0.022734535858035088, decouple_loss:0.008901726454496384
The generated pressure mean: 0.44726985692977905
loss_pred:0.022722849622368813, decouple_loss:0.00897992867976427
Iteration: 1593, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44857507944107056
loss_pred:0.02303900569677353, decouple_loss:0.008667495101690292
The generated pressure mean: 0.4479028582572937
loss_pred:0.023317527025938034, decouple_loss:0.008349895477294922
The generated pressure mean: 0.4486221671104431
loss_pred:0.02225717343389988, decouple_loss:0.008361230604350567
Iteration: 1594, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44645360112190247
loss_pred:0.023117151111364365, decouple_loss:0.008541584946215153
The generated pressure mean: 0.44767674803733826
The generated pressure mean: 0.4489873945713043
loss_pred:0.02185046672821045, decouple_loss:0.008476966060698032
loss_pred:0.02225860394537449, decouple_loss:0.008734690956771374
Iteration: 1595, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44778189063072205
loss_pred:0.02242415025830269, decouple_loss:0.008315255865454674
The generated pressure mean: 0.446683794260025
The generated pressure mean: 0.44743579626083374
loss_pred:0.02283051796257496, decouple_loss:0.008439071476459503
loss_pred:0.021854454651474953, decouple_loss:0.008426577784121037
Iteration: 1596, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4479162395000458
loss_pred:0.022233298048377037, decouple_loss:0.008549555204808712
The generated pressure mean: 0.4473857581615448
The generated pressure mean: 0.4469151496887207
loss_pred:0.021824464201927185, decouple_loss:0.008443811908364296
loss_pred:0.023248692974448204, decouple_loss:0.008390095084905624
Iteration: 1597, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44847428798675537
loss_pred:0.021815160289406776, decouple_loss:0.00793063547462225
The generated pressure mean: 0.4479479193687439
The generated pressure mean: 0.4480445683002472
loss_pred:0.02332361415028572, decouple_loss:0.007797751575708389
loss_pred:0.02316736802458763, decouple_loss:0.008104829117655754
Iteration: 1598, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.449349045753479
loss_pred:0.02227306179702282, decouple_loss:0.00774698331952095
The generated pressure mean: 0.4479721784591675
loss_pred:0.02233666554093361, decouple_loss:0.007728361524641514
The generated pressure mean: 0.4483236074447632
loss_pred:0.020917287096381187, decouple_loss:0.0077529046684503555
Iteration: 1599, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4483543634414673
loss_pred:0.0240766741335392, decouple_loss:0.007727572228759527
The generated pressure mean: 0.4469769299030304
loss_pred:0.022392233833670616, decouple_loss:0.007717883214354515
The generated pressure mean: 0.44811391830444336
loss_pred:0.02273140661418438, decouple_loss:0.0076490119099617004
Iteration: 1600, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4476199448108673
loss_pred:0.023023217916488647, decouple_loss:0.008350812830030918
The generated pressure mean: 0.44736436009407043
loss_pred:0.02429717592895031, decouple_loss:0.008199254982173443
The generated pressure mean: 0.4472668170928955
loss_pred:0.02223806269466877, decouple_loss:0.008144988678395748
2023-04-16 07:15:15 testing...
The generated pressure mean: 0.4495830535888672
The generated pressure mean: 0.449788898229599
The generated pressure mean: 0.44987666606903076
loss_pred:0.030106179416179657, decouple_loss:0.00898676086217165
loss_pred:0.031072910875082016, decouple_loss:0.009069470688700676
loss_pred:0.029796697199344635, decouple_loss:0.009040141478180885
Loss: 0.030776869505643845, avg_mse: 0.03943511098623276
current test mse: 0.039435
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012004_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012004_3_24hr.npz
NaN value num: 0
Iteration: 1601, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44619256258010864
loss_pred:0.022698676213622093, decouple_loss:0.008968438021838665
The generated pressure mean: 0.44809916615486145
loss_pred:0.022769365459680557, decouple_loss:0.00910812709480524
The generated pressure mean: 0.44716641306877136
loss_pred:0.02249658666551113, decouple_loss:0.00911574624478817
Iteration: 1602, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44733595848083496
The generated pressure mean: 0.44667744636535645
loss_pred:0.023448055610060692, decouple_loss:0.008264370262622833
The generated pressure mean: 0.4481167495250702
loss_pred:0.022744739428162575, decouple_loss:0.008164821192622185
loss_pred:0.02203206904232502, decouple_loss:0.008373445831239223
Iteration: 1603, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4463234543800354
loss_pred:0.022973190993070602, decouple_loss:0.007616308983415365
The generated pressure mean: 0.44792693853378296
The generated pressure mean: 0.44751399755477905
loss_pred:0.025546185672283173, decouple_loss:0.0077998521737754345
loss_pred:0.02230854704976082, decouple_loss:0.007676084525883198
Iteration: 1604, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4483192265033722
The generated pressure mean: 0.4483369290828705
loss_pred:0.02317447029054165, decouple_loss:0.00788275245577097
The generated pressure mean: 0.44762372970581055
loss_pred:0.021964125335216522, decouple_loss:0.007815198972821236
loss_pred:0.021873166784644127, decouple_loss:0.007811070419847965
Iteration: 1605, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4478653073310852
The generated pressure mean: 0.44744789600372314loss_pred:0.02271464467048645, decouple_loss:0.008231650106608868
The generated pressure mean: 0.448651522397995
loss_pred:0.022269602864980698, decouple_loss:0.00814299937337637
loss_pred:0.02201196923851967, decouple_loss:0.0082095330581069
Iteration: 1606, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44812795519828796
loss_pred:0.022508980706334114, decouple_loss:0.008765237405896187
The generated pressure mean: 0.44784584641456604
The generated pressure mean: 0.4473423361778259
loss_pred:0.022831397131085396, decouple_loss:0.00879613496363163
loss_pred:0.0219509806483984, decouple_loss:0.008700817823410034
Iteration: 1607, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4479922950267792
The generated pressure mean: 0.44725462794303894
loss_pred:0.022384708747267723, decouple_loss:0.00915774516761303
The generated pressure mean: 0.4470152258872986
loss_pred:0.022235164418816566, decouple_loss:0.009161760099232197
loss_pred:0.023804105818271637, decouple_loss:0.009170026518404484
Iteration: 1608, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4481734037399292
loss_pred:0.022258881479501724, decouple_loss:0.00835139025002718
The generated pressure mean: 0.44777384400367737
The generated pressure mean: 0.4467615783214569
loss_pred:0.02274361625313759, decouple_loss:0.008395531214773655
loss_pred:0.022135157138109207, decouple_loss:0.008580232970416546
Iteration: 1609, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44763290882110596
The generated pressure mean: 0.4458562433719635
loss_pred:0.023006796836853027, decouple_loss:0.007954639382660389
loss_pred:0.02188340201973915, decouple_loss:0.00793120265007019
The generated pressure mean: 0.4480590224266052
loss_pred:0.02193685993552208, decouple_loss:0.008066585287451744
Iteration: 1610, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4466300308704376
loss_pred:0.022452926263213158, decouple_loss:0.0078341756016016
The generated pressure mean: 0.4481970965862274
The generated pressure mean: 0.44732123613357544
loss_pred:0.022663302719593048, decouple_loss:0.007954956032335758
loss_pred:0.02269129827618599, decouple_loss:0.008024252019822598

2023-04-16 07:17:46 testing...
The generated pressure mean: 0.4495830833911896
The generated pressure mean: 0.4497888684272766
The generated pressure mean: 0.44987666606903076
loss_pred:0.031006699427962303, decouple_loss:0.008521006442606449
loss_pred:0.032678570598363876, decouple_loss:0.008579520508646965
loss_pred:0.03097488172352314, decouple_loss:0.008556491695344448
Loss: 0.031981002539396286, avg_mse: 0.0418962761759758
current test mse: 0.041896
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1611, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4455784261226654
loss_pred:0.02363901399075985, decouple_loss:0.008515771478414536
The generated pressure mean: 0.44809389114379883
loss_pred:0.022515777498483658, decouple_loss:0.008384646847844124
The generated pressure mean: 0.4472848176956177
loss_pred:0.023297851905226707, decouple_loss:0.008417145349085331
Iteration: 1612, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4476127028465271
loss_pred:0.022249748930335045, decouple_loss:0.008998137898743153
The generated pressure mean: 0.4486333727836609
The generated pressure mean: 0.44784215092658997loss_pred:0.02434256672859192, decouple_loss:0.009122462011873722
loss_pred:0.022966070100665092, decouple_loss:0.009315639734268188
Iteration: 1613, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4473123550415039
loss_pred:0.02210751175880432, decouple_loss:0.009268349036574364
The generated pressure mean: 0.4462664723396301
The generated pressure mean: 0.447194367647171loss_pred:0.023223960772156715, decouple_loss:0.009436026215553284
loss_pred:0.023098504170775414, decouple_loss:0.009245436638593674
Iteration: 1614, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4475368559360504
loss_pred:0.022858181968331337, decouple_loss:0.008640454150736332
The generated pressure mean: 0.4474705159664154
loss_pred:0.023086974397301674, decouple_loss:0.00877118855714798
The generated pressure mean: 0.44665244221687317
loss_pred:0.022213252261281013, decouple_loss:0.008437256328761578
Iteration: 1615, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4460369944572449
loss_pred:0.022663399577140808, decouple_loss:0.008222300559282303
The generated pressure mean: 0.4473298490047455
loss_pred:0.023088907822966576, decouple_loss:0.008215995505452156
The generated pressure mean: 0.44827932119369507
loss_pred:0.023697277531027794, decouple_loss:0.00831933319568634
Iteration: 1616, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4464249908924103
loss_pred:0.022677842527627945, decouple_loss:0.009233209304511547
The generated pressure mean: 0.4480447471141815
loss_pred:0.02328544668853283, decouple_loss:0.008933641947805882
The generated pressure mean: 0.44733962416648865
loss_pred:0.022676369175314903, decouple_loss:0.009067305363714695
Iteration: 1617, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4468432366847992
loss_pred:0.02222721092402935, decouple_loss:0.008869883604347706
The generated pressure mean: 0.44769221544265747
loss_pred:0.022646524012088776, decouple_loss:0.00896184891462326
The generated pressure mean: 0.4466976225376129
loss_pred:0.022140154615044594, decouple_loss:0.009275173768401146
Iteration: 1618, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4466818571090698
loss_pred:0.024132773280143738, decouple_loss:0.008810956962406635
The generated pressure mean: 0.4476579427719116
loss_pred:0.02179117500782013, decouple_loss:0.008745756931602955
The generated pressure mean: 0.44606471061706543
loss_pred:0.02165830507874489, decouple_loss:0.008696820586919785
Iteration: 1619, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44727715849876404
loss_pred:0.022353723645210266, decouple_loss:0.010155019350349903
The generated pressure mean: 0.44782304763793945
loss_pred:0.0228887889534235, decouple_loss:0.010230941697955132
The generated pressure mean: 0.44815748929977417
loss_pred:0.022267164662480354, decouple_loss:0.01008594874292612
Iteration: 1620, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44772395491600037
loss_pred:0.02362966537475586, decouple_loss:0.008269459009170532
The generated pressure mean: 0.44795340299606323
loss_pred:0.023862775415182114, decouple_loss:0.008199961856007576
The generated pressure mean: 0.4466927945613861
loss_pred:0.023888204246759415, decouple_loss:0.00816633552312851
2023-04-16 07:19:39 testing...
The generated pressure mean: 0.449788898229599
The generated pressure mean: 0.4495830833911896
The generated pressure mean: 0.44987666606903076
loss_pred:0.03206563740968704, decouple_loss:0.010102321393787861
loss_pred:0.030910508707165718, decouple_loss:0.01016537006944418loss_pred:0.03099173866212368, decouple_loss:0.010153135284781456
Loss: 0.03182964399456978, avg_mse: 0.04140515625476837
current test mse: 0.041405
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012015_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012015_3_24hr.npz
NaN value num: 0
Iteration: 1621, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4465615153312683
loss_pred:0.02314862795174122, decouple_loss:0.010030456818640232
The generated pressure mean: 0.44671282172203064
loss_pred:0.023551318794488907, decouple_loss:0.010148083791136742
The generated pressure mean: 0.44587963819503784
loss_pred:0.02422899380326271, decouple_loss:0.01006590947508812
Iteration: 1622, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4456939697265625
loss_pred:0.023579902946949005, decouple_loss:0.009511510841548443
The generated pressure mean: 0.44681504368782043
loss_pred:0.022722277790308, decouple_loss:0.009321466088294983
The generated pressure mean: 0.44558167457580566
loss_pred:0.023845603689551353, decouple_loss:0.009270009584724903
Iteration: 1623, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44583043456077576
The generated pressure mean: 0.44706955552101135
loss_pred:0.022957555949687958, decouple_loss:0.008358551189303398
loss_pred:0.02387268841266632, decouple_loss:0.008459992706775665
The generated pressure mean: 0.4464186131954193
loss_pred:0.025002114474773407, decouple_loss:0.008562309667468071
Iteration: 1624, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4465557038784027
The generated pressure mean: 0.44556576013565063
loss_pred:0.0225443784147501, decouple_loss:0.008717911317944527
loss_pred:0.024398285895586014, decouple_loss:0.008767927996814251
The generated pressure mean: 0.4468350410461426
loss_pred:0.024698015302419662, decouple_loss:0.008785612881183624
Iteration: 1625, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4467942416667938The generated pressure mean: 0.44647565484046936
loss_pred:0.022596219554543495, decouple_loss:0.009058820083737373
loss_pred:0.02196621522307396, decouple_loss:0.009301946498453617
The generated pressure mean: 0.4470517337322235
loss_pred:0.021905560046434402, decouple_loss:0.009152526035904884
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1626, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44696277379989624
The generated pressure mean: 0.44704344868659973
loss_pred:0.02423589676618576, decouple_loss:0.009492753073573112
loss_pred:0.02351616881787777, decouple_loss:0.009302680380642414
The generated pressure mean: 0.44563719630241394
loss_pred:0.02342107705771923, decouple_loss:0.009097506292164326
Iteration: 1627, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44717806577682495
The generated pressure mean: 0.4459589719772339
loss_pred:0.02277078479528427, decouple_loss:0.008668794296681881
loss_pred:0.022647183388471603, decouple_loss:0.008564156480133533
The generated pressure mean: 0.44764941930770874
loss_pred:0.02379155158996582, decouple_loss:0.008671607822179794
Iteration: 1628, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.446176677942276
loss_pred:0.024021003395318985, decouple_loss:0.008382685482501984
The generated pressure mean: 0.44725629687309265
loss_pred:0.02196834236383438, decouple_loss:0.008643814362585545
The generated pressure mean: 0.44659748673439026
loss_pred:0.02309257537126541, decouple_loss:0.008338037878274918
Iteration: 1629, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44418957829475403
The generated pressure mean: 0.4449184238910675
loss_pred:0.02392761781811714, decouple_loss:0.008081314153969288
loss_pred:0.024847591295838356, decouple_loss:0.007934533059597015
The generated pressure mean: 0.44647127389907837
loss_pred:0.02310679480433464, decouple_loss:0.008051724173128605
Iteration: 1630, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44722798466682434
The generated pressure mean: 0.44701582193374634
loss_pred:0.024242784827947617, decouple_loss:0.00779723608866334
loss_pred:0.02346596121788025, decouple_loss:0.007771429605782032
The generated pressure mean: 0.44665905833244324
loss_pred:0.023894721642136574, decouple_loss:0.007847510278224945
2023-04-16 07:22:08 testing...
The generated pressure mean: 0.4495830833911896
The generated pressure mean: 0.449788898229599
The generated pressure mean: 0.44987666606903076
loss_pred:0.029535971581935883, decouple_loss:0.008121352642774582
loss_pred:0.03052246756851673, decouple_loss:0.008286318741738796
loss_pred:0.029187534004449844, decouple_loss:0.008137947879731655
Loss: 0.030157750472426414, avg_mse: 0.03851482644677162
current test mse: 0.038515
Iteration: 1631, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44660240411758423
loss_pred:0.021684374660253525, decouple_loss:0.008189951069653034
The generated pressure mean: 0.4476238787174225
loss_pred:0.023990189656615257, decouple_loss:0.008075959049165249
The generated pressure mean: 0.4458606541156769
loss_pred:0.022747967392206192, decouple_loss:0.008316743187606335
Iteration: 1632, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4463682174682617
loss_pred:0.023457733914256096, decouple_loss:0.008115077391266823
The generated pressure mean: 0.44546782970428467
loss_pred:0.02293999493122101, decouple_loss:0.008080418221652508
The generated pressure mean: 0.44618159532546997
loss_pred:0.023557811975479126, decouple_loss:0.008092091418802738
Iteration: 1633, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4465024173259735
loss_pred:0.023449664935469627, decouple_loss:0.00827503390610218
The generated pressure mean: 0.4471602141857147
loss_pred:0.023687275126576424, decouple_loss:0.008414377458393574
The generated pressure mean: 0.4451724886894226
loss_pred:0.022224223241209984, decouple_loss:0.00848424807190895
Iteration: 1634, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4471440613269806
loss_pred:0.02314271591603756, decouple_loss:0.008797943592071533
The generated pressure mean: 0.44692474603652954
loss_pred:0.021681977435946465, decouple_loss:0.009211568161845207
The generated pressure mean: 0.4465227425098419
loss_pred:0.023067109286785126, decouple_loss:0.008666420355439186
Iteration: 1635, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4457947313785553
loss_pred:0.023980483412742615, decouple_loss:0.008095765486359596
The generated pressure mean: 0.4460996687412262
loss_pred:0.02221684344112873, decouple_loss:0.008030331693589687
The generated pressure mean: 0.4463280439376831
loss_pred:0.023064015433192253, decouple_loss:0.008327913470566273
Iteration: 1636, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44599515199661255
loss_pred:0.025809140875935555, decouple_loss:0.008148896507918835
The generated pressure mean: 0.4470646381378174
loss_pred:0.023287979885935783, decouple_loss:0.00782795436680317
The generated pressure mean: 0.4464435577392578
loss_pred:0.02432377263903618, decouple_loss:0.008146822452545166
Iteration: 1637, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.445913702249527
loss_pred:0.024067804217338562, decouple_loss:0.007526957895606756
The generated pressure mean: 0.44653037190437317
loss_pred:0.02317735180258751, decouple_loss:0.007745465263724327
The generated pressure mean: 0.4470544159412384
loss_pred:0.024189624935388565, decouple_loss:0.007585866842418909
Iteration: 1638, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4471542239189148
loss_pred:0.022571664303541183, decouple_loss:0.0077296532690525055
The generated pressure mean: 0.44547614455223083
loss_pred:0.024270672351121902, decouple_loss:0.007627980783581734
The generated pressure mean: 0.44665977358818054
loss_pred:0.023324869573116302, decouple_loss:0.007912441156804562
Iteration: 1639, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44592511653900146
loss_pred:0.023751839995384216, decouple_loss:0.008040880784392357
The generated pressure mean: 0.44675591588020325
loss_pred:0.02309957519173622, decouple_loss:0.008168479427695274
The generated pressure mean: 0.4471549987792969
loss_pred:0.023265555500984192, decouple_loss:0.007894162088632584
Iteration: 1640, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44565340876579285
loss_pred:0.02233508974313736, decouple_loss:0.008653219789266586
The generated pressure mean: 0.4473857581615448
loss_pred:0.02374783717095852, decouple_loss:0.008751049637794495
The generated pressure mean: 0.44630181789398193
loss_pred:0.022910311818122864, decouple_loss:0.008648614399135113
2023-04-16 07:24:02 testing...
The generated pressure mean: 0.449788898229599
The generated pressure mean: 0.4495830535888672
The generated pressure mean: 0.44987666606903076
loss_pred:0.0309140682220459, decouple_loss:0.008420777507126331
loss_pred:0.02988395094871521, decouple_loss:0.008387833833694458
loss_pred:0.029770798981189728, decouple_loss:0.008329515345394611
Loss: 0.03060857579112053, avg_mse: 0.03934599831700325
current test mse: 0.039346
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012009_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012009_3_24hr.npz
NaN value num: 0
Iteration: 1641, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4476143717765808
loss_pred:0.022443847730755806, decouple_loss:0.008295735344290733
The generated pressure mean: 0.446424663066864
loss_pred:0.023179149255156517, decouple_loss:0.008378966711461544
The generated pressure mean: 0.44803327322006226
loss_pred:0.0238025039434433, decouple_loss:0.008479597046971321
Iteration: 1642, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4478175938129425
The generated pressure mean: 0.4483109414577484
loss_pred:0.02376825176179409, decouple_loss:0.010000716894865036
loss_pred:0.02300240658223629, decouple_loss:0.009676369838416576
The generated pressure mean: 0.4472886323928833
loss_pred:0.022877773270010948, decouple_loss:0.009622595272958279
Iteration: 1643, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44698143005371094
The generated pressure mean: 0.4478420615196228
loss_pred:0.02243408001959324, decouple_loss:0.007962743751704693
loss_pred:0.02249879576265812, decouple_loss:0.007922951132059097
The generated pressure mean: 0.4476069211959839
loss_pred:0.02306574210524559, decouple_loss:0.008132086135447025
Iteration: 1644, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44784674048423767
The generated pressure mean: 0.4461551308631897
loss_pred:0.022262701764702797, decouple_loss:0.008353287354111671
loss_pred:0.023444075137376785, decouple_loss:0.008603434078395367
The generated pressure mean: 0.4487951695919037
loss_pred:0.022656908258795738, decouple_loss:0.008533903397619724
Iteration: 1645, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44982996582984924The generated pressure mean: 0.44688740372657776
loss_pred:0.022203709930181503, decouple_loss:0.00948852114379406
loss_pred:0.022854309529066086, decouple_loss:0.009355857968330383
The generated pressure mean: 0.4480317533016205
loss_pred:0.022872738540172577, decouple_loss:0.009320555254817009
Iteration: 1646, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44608765840530396
loss_pred:0.022191768512129784, decouple_loss:0.009160378016531467
The generated pressure mean: 0.4487040936946869
loss_pred:0.022279338911175728, decouple_loss:0.009141197428107262
The generated pressure mean: 0.44661805033683777
loss_pred:0.021997680887579918, decouple_loss:0.00916782021522522
Iteration: 1647, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4461471736431122
The generated pressure mean: 0.44697925448417664
loss_pred:0.022483471781015396, decouple_loss:0.00902645755559206
loss_pred:0.021879304200410843, decouple_loss:0.008974861353635788
The generated pressure mean: 0.4480183720588684
loss_pred:0.02250063605606556, decouple_loss:0.008832263760268688
Iteration: 1648, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44854751229286194
The generated pressure mean: 0.44736164808273315
loss_pred:0.022762827575206757, decouple_loss:0.00782593060284853
loss_pred:0.023023249581456184, decouple_loss:0.007965616881847382
The generated pressure mean: 0.4483659267425537
loss_pred:0.02172928862273693, decouple_loss:0.007777887396514416
Iteration: 1649, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4471273422241211
The generated pressure mean: 0.44623613357543945
loss_pred:0.021492362022399902, decouple_loss:0.009003700688481331
loss_pred:0.02234317548573017, decouple_loss:0.009112550877034664
The generated pressure mean: 0.44773584604263306
loss_pred:0.023027364164590836, decouple_loss:0.009206450544297695
Iteration: 1650, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4483940899372101
loss_pred:0.023192882537841797, decouple_loss:0.008470606990158558
The generated pressure mean: 0.4473239481449127
loss_pred:0.023327985778450966, decouple_loss:0.008709754794836044
The generated pressure mean: 0.4474954903125763
loss_pred:0.021578948944807053, decouple_loss:0.008604972623288631
2023-04-16 07:26:32 testing...
The generated pressure mean: 0.4495830535888672
The generated pressure mean: 0.449788898229599
The generated pressure mean: 0.44987666606903076
loss_pred:0.029147833585739136, decouple_loss:0.008597396314144135
loss_pred:0.03036106750369072, decouple_loss:0.0086077144369483
loss_pred:0.028861943632364273, decouple_loss:0.008626439608633518
Loss: 0.029887475073337555, avg_mse: 0.03791409358382225
current test mse: 0.037914
Iteration: 1651, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44692885875701904
The generated pressure mean: 0.4475298225879669loss_pred:0.02372380532324314, decouple_loss:0.00867758970707655
loss_pred:0.022212686017155647, decouple_loss:0.008533462882041931
The generated pressure mean: 0.44753408432006836
loss_pred:0.023340318351984024, decouple_loss:0.008620763197541237
Iteration: 1652, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44760459661483765
The generated pressure mean: 0.4493890404701233
loss_pred:0.021643487736582756, decouple_loss:0.007558930199593306
loss_pred:0.023676401004195213, decouple_loss:0.008009244687855244
The generated pressure mean: 0.4474327564239502
loss_pred:0.02330213412642479, decouple_loss:0.007848981767892838
Iteration: 1653, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4485139846801758
The generated pressure mean: 0.4461553990840912
loss_pred:0.02271718718111515, decouple_loss:0.008140557445585728
loss_pred:0.022340191528201103, decouple_loss:0.008379057981073856
The generated pressure mean: 0.4454862177371979
loss_pred:0.022692391648888588, decouple_loss:0.008189349435269833
Iteration: 1654, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4473932087421417
The generated pressure mean: 0.4468348026275635
loss_pred:0.02346763014793396, decouple_loss:0.009124530479311943
loss_pred:0.022321809083223343, decouple_loss:0.009578702040016651
The generated pressure mean: 0.4483204185962677
loss_pred:0.022951191291213036, decouple_loss:0.009499206207692623
Iteration: 1655, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4471665322780609
The generated pressure mean: 0.44719719886779785
loss_pred:0.023391367867588997, decouple_loss:0.008783657103776932
loss_pred:0.021925361827015877, decouple_loss:0.008239537477493286
The generated pressure mean: 0.44778165221214294
loss_pred:0.02289118617773056, decouple_loss:0.008268571458756924
Iteration: 1656, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4470822811126709
The generated pressure mean: 0.44558775424957275
loss_pred:0.02276592142879963, decouple_loss:0.00807120930403471
loss_pred:0.023241076618433, decouple_loss:0.008134917356073856
The generated pressure mean: 0.44727861881256104
loss_pred:0.022626986727118492, decouple_loss:0.008475403301417828
Iteration: 1657, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4493076503276825
loss_pred:0.02268574759364128, decouple_loss:0.008200020529329777
The generated pressure mean: 0.4468082785606384
loss_pred:0.023384617641568184, decouple_loss:0.00834900513291359
The generated pressure mean: 0.44713956117630005
loss_pred:0.02276509627699852, decouple_loss:0.008077039383351803
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1658, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44727686047554016
The generated pressure mean: 0.44861432909965515
loss_pred:0.023433968424797058, decouple_loss:0.008277310989797115
loss_pred:0.023768963292241096, decouple_loss:0.008172390051186085
The generated pressure mean: 0.4476727247238159
loss_pred:0.022068630903959274, decouple_loss:0.00818613450974226
Iteration: 1659, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4474140405654907
The generated pressure mean: 0.4494333267211914
loss_pred:0.02509845606982708, decouple_loss:0.00832984410226345
loss_pred:0.022154133766889572, decouple_loss:0.00827812496572733
The generated pressure mean: 0.44779470562934875
loss_pred:0.023092858493328094, decouple_loss:0.00849978905171156
Iteration: 1660, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44821038842201233
The generated pressure mean: 0.4490985572338104
loss_pred:0.02354028820991516, decouple_loss:0.008982532657682896
loss_pred:0.022521812468767166, decouple_loss:0.009001749567687511
The generated pressure mean: 0.44852009415626526
loss_pred:0.02125142700970173, decouple_loss:0.008875396102666855
2023-04-16 07:28:26 testing...
The generated pressure mean: 0.4497888684272766
The generated pressure mean: 0.4495830535888672
The generated pressure mean: 0.44987666606903076
loss_pred:0.03193570300936699, decouple_loss:0.008205755613744259
loss_pred:0.030884305015206337, decouple_loss:0.008090016432106495
loss_pred:0.030678443610668182, decouple_loss:0.008257136680185795
Loss: 0.031575366854667664, avg_mse: 0.04134371504187584
current test mse: 0.041344
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012019_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012019_3_24hr.npz
NaN value num: 0
Iteration: 1661, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4502960443496704
loss_pred:0.022216783836483955, decouple_loss:0.008317792788147926
The generated pressure mean: 0.4490286111831665
loss_pred:0.02206711657345295, decouple_loss:0.008295380510389805
The generated pressure mean: 0.4502295255661011
loss_pred:0.022543948143720627, decouple_loss:0.008474743925035
Iteration: 1662, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44965627789497375
The generated pressure mean: 0.44911807775497437
loss_pred:0.024098530411720276, decouple_loss:0.007801973260939121
loss_pred:0.02316497266292572, decouple_loss:0.007696600630879402
The generated pressure mean: 0.44919705390930176
loss_pred:0.022375326603651047, decouple_loss:0.007939048111438751
Iteration: 1663, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45080986618995667
The generated pressure mean: 0.44797298312187195loss_pred:0.022908728569746017, decouple_loss:0.008217377588152885
loss_pred:0.02230902574956417, decouple_loss:0.008409271948039532
The generated pressure mean: 0.44948604702949524
loss_pred:0.02290530875325203, decouple_loss:0.008122592233121395
Iteration: 1664, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44863173365592957
loss_pred:0.022648533806204796, decouple_loss:0.009091087616980076
The generated pressure mean: 0.4492380619049072
loss_pred:0.023023562505841255, decouple_loss:0.008860441856086254
The generated pressure mean: 0.44969242811203003
loss_pred:0.02436688356101513, decouple_loss:0.008924632333219051
Iteration: 1665, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44874081015586853
loss_pred:0.022299079224467278, decouple_loss:0.009125564247369766
The generated pressure mean: 0.4494338631629944
loss_pred:0.023504916578531265, decouple_loss:0.008973189629614353
The generated pressure mean: 0.4492861032485962
loss_pred:0.023043451830744743, decouple_loss:0.009116237983107567
Iteration: 1666, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4496931731700897
loss_pred:0.02266106940805912, decouple_loss:0.008046972565352917
The generated pressure mean: 0.4488268494606018
loss_pred:0.022461533546447754, decouple_loss:0.00809607282280922
The generated pressure mean: 0.4501243233680725
loss_pred:0.024312682449817657, decouple_loss:0.00811629556119442
Iteration: 1667, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44837287068367004
loss_pred:0.024141812697052956, decouple_loss:0.00793579500168562
The generated pressure mean: 0.4491843283176422
loss_pred:0.022792547941207886, decouple_loss:0.0076973047107458115
The generated pressure mean: 0.44836920499801636
loss_pred:0.02379702217876911, decouple_loss:0.007903731428086758
Iteration: 1668, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.450138658285141
loss_pred:0.02192234806716442, decouple_loss:0.008218927308917046
The generated pressure mean: 0.44903796911239624
loss_pred:0.02199934981763363, decouple_loss:0.007897644303739071
The generated pressure mean: 0.44977980852127075
loss_pred:0.0224965438246727, decouple_loss:0.00797157734632492
Iteration: 1669, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.449287086725235
loss_pred:0.023116450756788254, decouple_loss:0.008702087216079235
The generated pressure mean: 0.44803228974342346
loss_pred:0.021609200164675713, decouple_loss:0.008854173123836517
The generated pressure mean: 0.4494743347167969
loss_pred:0.023513101041316986, decouple_loss:0.009097360074520111
Iteration: 1670, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4500710964202881
loss_pred:0.024773675948381424, decouple_loss:0.008632914163172245
The generated pressure mean: 0.44893956184387207
The generated pressure mean: 0.4492032527923584
loss_pred:0.02454211935400963, decouple_loss:0.008479722775518894
loss_pred:0.021967554464936256, decouple_loss:0.008485780097544193
2023-04-16 07:31:03 testing...
The generated pressure mean: 0.4497888684272766
The generated pressure mean: 0.4495830833911896
The generated pressure mean: 0.44987666606903076
loss_pred:0.030523937195539474, decouple_loss:0.008572930470108986
loss_pred:0.02943698689341545, decouple_loss:0.008563377894461155
loss_pred:0.02908635139465332, decouple_loss:0.008638246916234493
Loss: 0.030112002044916153, avg_mse: 0.038532231003046036
current test mse: 0.038532
Iteration: 1671, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44860759377479553
loss_pred:0.022556457668542862, decouple_loss:0.00869663804769516
The generated pressure mean: 0.45018741488456726
loss_pred:0.02297227829694748, decouple_loss:0.008561315014958382
The generated pressure mean: 0.4488588571548462
loss_pred:0.02393786981701851, decouple_loss:0.008488384075462818
Iteration: 1672, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4506630599498749
loss_pred:0.022708596661686897, decouple_loss:0.00819979514926672
The generated pressure mean: 0.4480578303337097
loss_pred:0.023240480571985245, decouple_loss:0.008235398679971695
The generated pressure mean: 0.45011022686958313
loss_pred:0.02239815704524517, decouple_loss:0.00806206464767456
Iteration: 1673, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44886115193367004
loss_pred:0.02309405989944935, decouple_loss:0.008457341231405735
The generated pressure mean: 0.45090633630752563
loss_pred:0.022875970229506493, decouple_loss:0.00854919571429491
The generated pressure mean: 0.44901034235954285
loss_pred:0.022892972454428673, decouple_loss:0.008737298659980297
Iteration: 1674, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4500035047531128
loss_pred:0.022916162386536598, decouple_loss:0.008983241394162178
The generated pressure mean: 0.44846558570861816
loss_pred:0.023888377472758293, decouple_loss:0.009160260669887066
The generated pressure mean: 0.44822660088539124
loss_pred:0.023563202470541, decouple_loss:0.00912653747946024
Iteration: 1675, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4489181935787201
loss_pred:0.023061702027916908, decouple_loss:0.008891947567462921
The generated pressure mean: 0.4505859315395355
loss_pred:0.02275708317756653, decouple_loss:0.008810213766992092
The generated pressure mean: 0.4493621587753296
loss_pred:0.02238856628537178, decouple_loss:0.00906292349100113
Iteration: 1676, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4483937919139862
loss_pred:0.022727496922016144, decouple_loss:0.007895235903561115
The generated pressure mean: 0.4492708444595337
loss_pred:0.022653521969914436, decouple_loss:0.007974467240273952
The generated pressure mean: 0.4492669105529785
loss_pred:0.02120484597980976, decouple_loss:0.007885054685175419
Iteration: 1677, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44765859842300415
loss_pred:0.024112004786729813, decouple_loss:0.0075643896125257015
The generated pressure mean: 0.44851312041282654
loss_pred:0.022716747596859932, decouple_loss:0.007425541523844004
The generated pressure mean: 0.4498368203639984
loss_pred:0.0225446205586195, decouple_loss:0.00757144158706069
Iteration: 1678, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45082464814186096
loss_pred:0.023538241162896156, decouple_loss:0.00846218690276146
The generated pressure mean: 0.44965094327926636
loss_pred:0.023828953504562378, decouple_loss:0.008159171789884567
The generated pressure mean: 0.4503858983516693
loss_pred:0.02319810912013054, decouple_loss:0.008504259400069714
Iteration: 1679, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4492749571800232
loss_pred:0.022656681016087532, decouple_loss:0.010358726605772972
The generated pressure mean: 0.4497874081134796
loss_pred:0.02334507741034031, decouple_loss:0.010249132290482521
The generated pressure mean: 0.4491962790489197
loss_pred:0.022749947383999825, decouple_loss:0.010040203109383583
Iteration: 1680, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4496731460094452
loss_pred:0.022887639701366425, decouple_loss:0.009458987042307854
The generated pressure mean: 0.44858768582344055
loss_pred:0.022277390584349632, decouple_loss:0.009584356099367142
The generated pressure mean: 0.4480297267436981
loss_pred:0.022848673164844513, decouple_loss:0.009419016540050507
2023-04-16 07:32:56 testing...
The generated pressure mean: 0.4497888684272766
The generated pressure mean: 0.4495830535888672
The generated pressure mean: 0.44987666606903076
loss_pred:0.030604783445596695, decouple_loss:0.008444329723715782
loss_pred:0.02984294295310974, decouple_loss:0.008460183627903461
loss_pred:0.02936958707869053, decouple_loss:0.008532702922821045
Loss: 0.030363058671355247, avg_mse: 0.03906182199716568
current test mse: 0.039062
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012001_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012001_3_24hr.npz
NaN value num: 0
Iteration: 1681, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4464447498321533
loss_pred:0.0230781938880682, decouple_loss:0.00884934887290001
The generated pressure mean: 0.4472917318344116
loss_pred:0.02205626666545868, decouple_loss:0.008431158028542995
The generated pressure mean: 0.4455767571926117
loss_pred:0.020494990050792694, decouple_loss:0.008915581740438938
Iteration: 1682, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.447226345539093
loss_pred:0.02248506247997284, decouple_loss:0.009576022624969482
The generated pressure mean: 0.44795510172843933
loss_pred:0.02131323143839836, decouple_loss:0.009345167316496372
The generated pressure mean: 0.44574248790740967
loss_pred:0.020373592153191566, decouple_loss:0.009592507034540176
Iteration: 1683, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44639065861701965
loss_pred:0.022482173517346382, decouple_loss:0.009295342490077019
The generated pressure mean: 0.4470917880535126
loss_pred:0.02290620468556881, decouple_loss:0.009322581812739372
The generated pressure mean: 0.446228951215744
loss_pred:0.022810237482190132, decouple_loss:0.00930333137512207
Iteration: 1684, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4483518600463867
loss_pred:0.02101399190723896, decouple_loss:0.009031334891915321
The generated pressure mean: 0.4466207027435303
loss_pred:0.021249493584036827, decouple_loss:0.009057076647877693
The generated pressure mean: 0.44879624247550964
loss_pred:0.021371884271502495, decouple_loss:0.00898656900972128
Iteration: 1685, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44825175404548645
loss_pred:0.02165544219315052, decouple_loss:0.009791137650609016
The generated pressure mean: 0.44730597734451294
loss_pred:0.022080563008785248, decouple_loss:0.009635108523070812
The generated pressure mean: 0.4470219612121582
loss_pred:0.021056031808257103, decouple_loss:0.009807124733924866
Iteration: 1686, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4482642710208893
loss_pred:0.02230648696422577, decouple_loss:0.008577029220759869
The generated pressure mean: 0.4468749761581421
loss_pred:0.02177983894944191, decouple_loss:0.00866714958101511
The generated pressure mean: 0.4481727182865143
loss_pred:0.023935800418257713, decouple_loss:0.008975609205663204
Iteration: 1687, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44648075103759766
loss_pred:0.023779813200235367, decouple_loss:0.009366669692099094
The generated pressure mean: 0.44603413343429565
loss_pred:0.02027001418173313, decouple_loss:0.009306550957262516
The generated pressure mean: 0.44880780577659607
loss_pred:0.02361551858484745, decouple_loss:0.009311993606388569
Iteration: 1688, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4476628601551056
loss_pred:0.022178011015057564, decouple_loss:0.009139164350926876
The generated pressure mean: 0.44639313220977783
loss_pred:0.022994250059127808, decouple_loss:0.009075792506337166
The generated pressure mean: 0.44901183247566223
loss_pred:0.021368125453591347, decouple_loss:0.008949627168476582
Iteration: 1689, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44653376936912537
loss_pred:0.02357524447143078, decouple_loss:0.008207641541957855
The generated pressure mean: 0.4486105442047119
loss_pred:0.021621303632855415, decouple_loss:0.008112129755318165
The generated pressure mean: 0.44811418652534485
loss_pred:0.022807514294981956, decouple_loss:0.00837805774062872
Iteration: 1690, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44775256514549255
loss_pred:0.02349918894469738, decouple_loss:0.009228406473994255
The generated pressure mean: 0.4481533467769623
loss_pred:0.022235708311200142, decouple_loss:0.009339780546724796
The generated pressure mean: 0.44699421525001526
loss_pred:0.021838432177901268, decouple_loss:0.009388347156345844
2023-04-16 07:35:27 testing...
The generated pressure mean: 0.449788898229599
The generated pressure mean: 0.4495830833911896
The generated pressure mean: 0.44987666606903076
loss_pred:0.030888639390468597, decouple_loss:0.008166670799255371
loss_pred:0.02984326332807541, decouple_loss:0.008232107385993004
loss_pred:0.029800422489643097, decouple_loss:0.008355849422514439
Loss: 0.03059002012014389, avg_mse: 0.03952181339263916
current test mse: 0.039522
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1691, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44694462418556213
loss_pred:0.023088201880455017, decouple_loss:0.008224750868976116
The generated pressure mean: 0.44782647490501404
The generated pressure mean: 0.44865885376930237
loss_pred:0.02426467090845108, decouple_loss:0.008266427554190159
loss_pred:0.02381763607263565, decouple_loss:0.008445831015706062
Iteration: 1692, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4466645419597626
loss_pred:0.02332139015197754, decouple_loss:0.008190910331904888
The generated pressure mean: 0.44881632924079895
The generated pressure mean: 0.44523462653160095
loss_pred:0.02202177233994007, decouple_loss:0.008317230269312859
loss_pred:0.023263460025191307, decouple_loss:0.00849977321922779
Iteration: 1693, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4466317892074585
The generated pressure mean: 0.44729161262512207
loss_pred:0.022067269310355186, decouple_loss:0.009254436008632183
loss_pred:0.020826086401939392, decouple_loss:0.009373589418828487
The generated pressure mean: 0.4478665292263031
loss_pred:0.021369382739067078, decouple_loss:0.009312480688095093
Iteration: 1694, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4459710121154785
loss_pred:0.022915761917829514, decouple_loss:0.00815559457987547
The generated pressure mean: 0.4484339952468872
loss_pred:0.021380480378866196, decouple_loss:0.008170065470039845
The generated pressure mean: 0.44755735993385315
loss_pred:0.021803688257932663, decouple_loss:0.00810280628502369
Iteration: 1695, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4481518268585205
loss_pred:0.023242905735969543, decouple_loss:0.007961087860167027
The generated pressure mean: 0.44669008255004883
The generated pressure mean: 0.44723355770111084
loss_pred:0.02500949241220951, decouple_loss:0.008517561480402946
loss_pred:0.022356944158673286, decouple_loss:0.007979643531143665
Iteration: 1696, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44720178842544556
loss_pred:0.022212980315089226, decouple_loss:0.00856449082493782
The generated pressure mean: 0.4461544156074524
The generated pressure mean: 0.4470854103565216
loss_pred:0.022667115554213524, decouple_loss:0.008339311927556992
loss_pred:0.02307879365980625, decouple_loss:0.008339866064488888
Iteration: 1697, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44799819588661194
loss_pred:0.0218177679926157, decouple_loss:0.007791987620294094
The generated pressure mean: 0.44724223017692566
loss_pred:0.023049574345350266, decouple_loss:0.007706314790993929
The generated pressure mean: 0.4480348825454712
loss_pred:0.022127537056803703, decouple_loss:0.007648300379514694
Iteration: 1698, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4479070007801056
The generated pressure mean: 0.4475003480911255
loss_pred:0.021341796964406967, decouple_loss:0.007869974710047245
loss_pred:0.021707233041524887, decouple_loss:0.007644336670637131
The generated pressure mean: 0.44767576456069946
loss_pred:0.02107744850218296, decouple_loss:0.007486176211386919
Iteration: 1699, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4467603862285614
The generated pressure mean: 0.448044091463089
loss_pred:0.02282552234828472, decouple_loss:0.007973729632794857
loss_pred:0.02074650302529335, decouple_loss:0.007616767194122076
The generated pressure mean: 0.4474366307258606
loss_pred:0.02200097218155861, decouple_loss:0.007728161755949259
Iteration: 1700, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44601142406463623
loss_pred:0.023591041564941406, decouple_loss:0.008317275904119015
The generated pressure mean: 0.44770726561546326
loss_pred:0.021628087386488914, decouple_loss:0.008285066112875938
The generated pressure mean: 0.4470670819282532
loss_pred:0.02483231946825981, decouple_loss:0.008530578576028347
2023-04-16 07:37:20 testing...
The generated pressure mean: 0.4497888684272766
The generated pressure mean: 0.4495830535888672
The generated pressure mean: 0.44987666606903076
loss_pred:0.030555378645658493, decouple_loss:0.009320845827460289
loss_pred:0.02930516190826893, decouple_loss:0.009265869855880737loss_pred:0.02889380045235157, decouple_loss:0.009227973408997059
Loss: 0.03004836104810238, avg_mse: 0.038371361792087555
current test mse: 0.038371
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012016_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012016_3_24hr.npz
NaN value num: 0
Iteration: 1701, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44813498854637146
loss_pred:0.02441350184381008, decouple_loss:0.009339593350887299
The generated pressure mean: 0.44772204756736755
loss_pred:0.022752707824110985, decouple_loss:0.009400466457009315
The generated pressure mean: 0.4469491243362427
loss_pred:0.021562688052654266, decouple_loss:0.009370491839945316
Iteration: 1702, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4480094313621521
The generated pressure mean: 0.4484513998031616
loss_pred:0.02276753820478916, decouple_loss:0.00870025996118784
loss_pred:0.023318031802773476, decouple_loss:0.008783896453678608
The generated pressure mean: 0.4466681480407715
loss_pred:0.02221602573990822, decouple_loss:0.008603321388363838
Iteration: 1703, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44703513383865356
The generated pressure mean: 0.44696342945098877
loss_pred:0.022511683404445648, decouple_loss:0.008356928825378418
loss_pred:0.022232426330447197, decouple_loss:0.008498781360685825
The generated pressure mean: 0.4483056962490082
loss_pred:0.022573551163077354, decouple_loss:0.00805785320699215
Iteration: 1704, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44687673449516296
loss_pred:0.022057313472032547, decouple_loss:0.00863648485392332
The generated pressure mean: 0.44798144698143005
loss_pred:0.021723587065935135, decouple_loss:0.008465672843158245
The generated pressure mean: 0.44824644923210144
loss_pred:0.02364392951130867, decouple_loss:0.00880317110568285
Iteration: 1705, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44754254817962646
The generated pressure mean: 0.4490155577659607
loss_pred:0.023299038410186768, decouple_loss:0.008965401910245419
loss_pred:0.022007351741194725, decouple_loss:0.00943102315068245
The generated pressure mean: 0.4475826025009155
loss_pred:0.022946855053305626, decouple_loss:0.00907415896654129
Iteration: 1706, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44765305519104004
loss_pred:0.022466719150543213, decouple_loss:0.008492429740726948
The generated pressure mean: 0.4476337432861328
The generated pressure mean: 0.4492480754852295
loss_pred:0.022098185494542122, decouple_loss:0.008559648878872395
loss_pred:0.02199394255876541, decouple_loss:0.008703140541911125
Iteration: 1707, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4484936594963074
loss_pred:0.023641733452677727, decouple_loss:0.00822422094643116
The generated pressure mean: 0.44685885310173035
loss_pred:0.02201460488140583, decouple_loss:0.008270861580967903
The generated pressure mean: 0.44801685214042664
loss_pred:0.02176806516945362, decouple_loss:0.008136751130223274
Iteration: 1708, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44689786434173584
The generated pressure mean: 0.4476301968097687
loss_pred:0.02410101890563965, decouple_loss:0.007987895049154758
The generated pressure mean: 0.4475051462650299
loss_pred:0.022021373733878136, decouple_loss:0.007988069206476212
loss_pred:0.02369932271540165, decouple_loss:0.008048790507018566
Iteration: 1709, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4469279646873474
loss_pred:0.024223489686846733, decouple_loss:0.008016509003937244
The generated pressure mean: 0.4466789960861206
The generated pressure mean: 0.4469186067581177
loss_pred:0.021852457895874977, decouple_loss:0.008042814210057259
loss_pred:0.023360537365078926, decouple_loss:0.008021684363484383
Iteration: 1710, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44716107845306396
loss_pred:0.022489624097943306, decouple_loss:0.00816298183053732
The generated pressure mean: 0.4473802447319031
loss_pred:0.024736233055591583, decouple_loss:0.008028759621083736
The generated pressure mean: 0.4463586211204529
loss_pred:0.022761980071663857, decouple_loss:0.008205268532037735
2023-04-16 07:39:49 testing...
The generated pressure mean: 0.4495830833911896
The generated pressure mean: 0.4497888684272766
The generated pressure mean: 0.44987666606903076
loss_pred:0.030037764459848404, decouple_loss:0.009314159862697124
loss_pred:0.031372860074043274, decouple_loss:0.009233115240931511
loss_pred:0.0294742863625288, decouple_loss:0.009292258881032467
Loss: 0.030758962035179138, avg_mse: 0.039928775280714035
current test mse: 0.039929
Iteration: 1711, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44688501954078674
loss_pred:0.024773215875029564, decouple_loss:0.009136457927525043
The generated pressure mean: 0.44690871238708496
loss_pred:0.021987585350871086, decouple_loss:0.009096801280975342
The generated pressure mean: 0.44941359758377075
loss_pred:0.02183956652879715, decouple_loss:0.009197298437356949
Iteration: 1712, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4477772116661072
loss_pred:0.023039022460579872, decouple_loss:0.008353851735591888
The generated pressure mean: 0.4466017484664917
loss_pred:0.021889539435505867, decouple_loss:0.008141189813613892
The generated pressure mean: 0.44705286622047424
loss_pred:0.02371875010430813, decouple_loss:0.00813545472919941
Iteration: 1713, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4472801983356476
loss_pred:0.022403471171855927, decouple_loss:0.00790309812873602
The generated pressure mean: 0.4483170509338379
loss_pred:0.02225339040160179, decouple_loss:0.007799198850989342
The generated pressure mean: 0.4466645419597626
loss_pred:0.022431505843997, decouple_loss:0.0081325713545084
Iteration: 1714, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4496080279350281
loss_pred:0.02187226712703705, decouple_loss:0.007802889682352543
The generated pressure mean: 0.44723808765411377
loss_pred:0.025523662567138672, decouple_loss:0.007654881104826927
The generated pressure mean: 0.4486178457736969
loss_pred:0.024317806586623192, decouple_loss:0.007677397690713406
Iteration: 1715, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4464806616306305
loss_pred:0.022643808275461197, decouple_loss:0.008111006580293179
The generated pressure mean: 0.44762569665908813
The generated pressure mean: 0.446621298789978
loss_pred:0.023121429607272148, decouple_loss:0.007892303168773651
loss_pred:0.02506607212126255, decouple_loss:0.008243855088949203
Iteration: 1716, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4473516047000885
loss_pred:0.023232556879520416, decouple_loss:0.007595923263579607
The generated pressure mean: 0.44680145382881165
The generated pressure mean: 0.44851794838905334
loss_pred:0.02298213168978691, decouple_loss:0.008071023970842361
loss_pred:0.02429492399096489, decouple_loss:0.008012988604605198
Iteration: 1717, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4477654695510864
loss_pred:0.022097909823060036, decouple_loss:0.008585755713284016
The generated pressure mean: 0.4470483064651489
The generated pressure mean: 0.44634178280830383
loss_pred:0.022633204236626625, decouple_loss:0.008498607203364372
loss_pred:0.022547647356987, decouple_loss:0.00856422632932663
Iteration: 1718, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44655951857566833
loss_pred:0.02285628952085972, decouple_loss:0.007529523689299822
The generated pressure mean: 0.44629180431365967
The generated pressure mean: 0.44755107164382935
loss_pred:0.02257995866239071, decouple_loss:0.007727655582129955
loss_pred:0.02320091612637043, decouple_loss:0.007406624499708414
Iteration: 1719, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4468691349029541
The generated pressure mean: 0.4474845826625824
loss_pred:0.024419689550995827, decouple_loss:0.007929002866148949
loss_pred:0.02271244488656521, decouple_loss:0.007799114100635052
The generated pressure mean: 0.44842371344566345
loss_pred:0.021984122693538666, decouple_loss:0.00790430884808302
Iteration: 1720, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44759416580200195
loss_pred:0.02078750543296337, decouple_loss:0.008400454185903072
The generated pressure mean: 0.44651761651039124
The generated pressure mean: 0.4464671313762665
loss_pred:0.022359473630785942, decouple_loss:0.008394517935812473
loss_pred:0.022560277953743935, decouple_loss:0.008392572402954102
2023-04-16 07:41:42 testing...
The generated pressure mean: 0.4495830833911896
The generated pressure mean: 0.449788898229599
The generated pressure mean: 0.44987666606903076
loss_pred:0.029663631692528725, decouple_loss:0.007382225710898638
loss_pred:0.03070860356092453, decouple_loss:0.007585989311337471
loss_pred:0.029443781822919846, decouple_loss:0.0073449877090752125
Loss: 0.030310561880469322, avg_mse: 0.039302319288253784
current test mse: 0.039302
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012009_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012009_3_24hr.npz
NaN value num: 0
Iteration: 1721, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44884318113327026
loss_pred:0.021993516013026237, decouple_loss:0.00747712142765522
The generated pressure mean: 0.44939926266670227
The generated pressure mean: 0.447726845741272
loss_pred:0.022576700896024704, decouple_loss:0.007683880627155304
loss_pred:0.02293822169303894, decouple_loss:0.00734448479488492
Iteration: 1722, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4501529335975647
The generated pressure mean: 0.44910916686058044
loss_pred:0.02123129367828369, decouple_loss:0.00777767039835453
loss_pred:0.02198047749698162, decouple_loss:0.007774597033858299
The generated pressure mean: 0.44935813546180725
loss_pred:0.022846011444926262, decouple_loss:0.007930757477879524
Iteration: 1723, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4494432210922241
The generated pressure mean: 0.44901958107948303
loss_pred:0.023460520431399345, decouple_loss:0.00829902570694685
loss_pred:0.022844793274998665, decouple_loss:0.008433462120592594
The generated pressure mean: 0.4464895725250244
loss_pred:0.021964775398373604, decouple_loss:0.008477943949401379
Iteration: 1724, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4478687345981598
The generated pressure mean: 0.4486571252346039
loss_pred:0.022644253447651863, decouple_loss:0.0090570617467165
loss_pred:0.024281010031700134, decouple_loss:0.008744138292968273
The generated pressure mean: 0.4489775598049164
loss_pred:0.022030040621757507, decouple_loss:0.008461817167699337
Iteration: 1725, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.448865681886673
The generated pressure mean: 0.4484628736972809loss_pred:0.023052487522363663, decouple_loss:0.0083763487637043
The generated pressure mean: 0.45015114545822144
loss_pred:0.02195615880191326, decouple_loss:0.00801945198327303
loss_pred:0.024328984320163727, decouple_loss:0.008155004121363163
Iteration: 1726, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44772836565971375
loss_pred:0.022409148514270782, decouple_loss:0.00760507071390748
The generated pressure mean: 0.44854825735092163
loss_pred:0.021911319345235825, decouple_loss:0.007316363509744406
The generated pressure mean: 0.44882890582084656
loss_pred:0.022768564522266388, decouple_loss:0.007654052693396807
Iteration: 1727, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44888004660606384
The generated pressure mean: 0.4487477242946625
loss_pred:0.02297968417406082, decouple_loss:0.007099122740328312
The generated pressure mean: 0.4504079520702362
loss_pred:0.021925311535596848, decouple_loss:0.007546633947640657
loss_pred:0.02126426249742508, decouple_loss:0.007250518538057804
Iteration: 1728, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44880861043930054
The generated pressure mean: 0.4499039649963379loss_pred:0.02224765159189701, decouple_loss:0.008197195827960968
loss_pred:0.02352970279753208, decouple_loss:0.008172865957021713
The generated pressure mean: 0.4491191506385803
loss_pred:0.02208758145570755, decouple_loss:0.008103116415441036
Iteration: 1729, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44662222266197205
The generated pressure mean: 0.44738608598709106
loss_pred:0.023048795759677887, decouple_loss:0.010478210635483265
loss_pred:0.023057997226715088, decouple_loss:0.010306797921657562
The generated pressure mean: 0.4497900903224945
loss_pred:0.02236681990325451, decouple_loss:0.01031236257404089
Iteration: 1730, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44998177886009216
The generated pressure mean: 0.4475764036178589
loss_pred:0.024033617228269577, decouple_loss:0.008362616412341595
loss_pred:0.02173973061144352, decouple_loss:0.008220001123845577
The generated pressure mean: 0.4478866457939148
loss_pred:0.02265402115881443, decouple_loss:0.008191049098968506
2023-04-16 07:44:16 testing...
The generated pressure mean: 0.4497888684272766
The generated pressure mean: 0.4495830535888672
The generated pressure mean: 0.44987666606903076
loss_pred:0.030606847256422043, decouple_loss:0.008364849723875523
loss_pred:0.029640302062034607, decouple_loss:0.008174221031367779
loss_pred:0.029215792194008827, decouple_loss:0.008275475353002548
Loss: 0.030234556645154953, avg_mse: 0.03906520828604698
current test mse: 0.039065
Iteration: 1731, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4472452700138092
loss_pred:0.025137750431895256, decouple_loss:0.008174736984074116
The generated pressure mean: 0.4481542408466339
loss_pred:0.02235269919037819, decouple_loss:0.008387718349695206
The generated pressure mean: 0.4502018690109253
loss_pred:0.023220056667923927, decouple_loss:0.008296152576804161
Iteration: 1732, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4476395547389984
loss_pred:0.02302694134414196, decouple_loss:0.00935082696378231
The generated pressure mean: 0.4480966031551361
loss_pred:0.021886512637138367, decouple_loss:0.00972296204417944
The generated pressure mean: 0.448699414730072
loss_pred:0.022388387471437454, decouple_loss:0.009354096837341785
Iteration: 1733, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44856056571006775
loss_pred:0.02412581257522106, decouple_loss:0.008653677068650723
The generated pressure mean: 0.4481092393398285
loss_pred:0.02269769459962845, decouple_loss:0.00866857822984457
The generated pressure mean: 0.44813576340675354
loss_pred:0.023785606026649475, decouple_loss:0.008634462021291256
Iteration: 1734, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44796690344810486
loss_pred:0.02304205298423767, decouple_loss:0.008298392407596111
The generated pressure mean: 0.4494730234146118
loss_pred:0.0229084100574255, decouple_loss:0.008367873728275299
The generated pressure mean: 0.44927430152893066
loss_pred:0.02333870343863964, decouple_loss:0.008479421027004719
Iteration: 1735, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4484004080295563
loss_pred:0.022981837391853333, decouple_loss:0.008086921647191048
The generated pressure mean: 0.4481106400489807
loss_pred:0.022360926494002342, decouple_loss:0.008141531608998775
The generated pressure mean: 0.44850537180900574
loss_pred:0.02368207648396492, decouple_loss:0.008169524371623993
Iteration: 1736, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4491627514362335
The generated pressure mean: 0.4483877420425415loss_pred:0.0229695662856102, decouple_loss:0.00756986066699028
loss_pred:0.022677624598145485, decouple_loss:0.007629034109413624
The generated pressure mean: 0.44852960109710693
loss_pred:0.022460004314780235, decouple_loss:0.007661068346351385
Iteration: 1737, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4490791857242584
The generated pressure mean: 0.4495813846588135
loss_pred:0.021916525438427925, decouple_loss:0.007965678349137306
loss_pred:0.022021371871232986, decouple_loss:0.00808272697031498
The generated pressure mean: 0.4492068588733673
loss_pred:0.023214055225253105, decouple_loss:0.008306687697768211
Iteration: 1738, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44981876015663147
loss_pred:0.02274441160261631, decouple_loss:0.00756870536133647
The generated pressure mean: 0.44974711537361145
loss_pred:0.022714341059327126, decouple_loss:0.007624360732734203
The generated pressure mean: 0.4493604004383087
loss_pred:0.022116221487522125, decouple_loss:0.007621739059686661
Iteration: 1739, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4493882358074188
loss_pred:0.021694235503673553, decouple_loss:0.007799119222909212
The generated pressure mean: 0.44952392578125
loss_pred:0.021568775177001953, decouple_loss:0.008011949248611927
The generated pressure mean: 0.44789427518844604
loss_pred:0.022920114919543266, decouple_loss:0.008060477674007416
Iteration: 1740, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4487566351890564
The generated pressure mean: 0.4491322934627533
loss_pred:0.022792326286435127, decouple_loss:0.007559200283139944
loss_pred:0.02366001158952713, decouple_loss:0.0075943684205412865
The generated pressure mean: 0.4484816789627075
loss_pred:0.02247484214603901, decouple_loss:0.0076083410531282425
2023-04-16 07:46:09 testing...
The generated pressure mean: 0.4495830535888672
The generated pressure mean: 0.4497888684272766
The generated pressure mean: 0.44987666606903076
loss_pred:0.029204335063695908, decouple_loss:0.007936815731227398
loss_pred:0.03041580319404602, decouple_loss:0.008034009486436844
loss_pred:0.028611084446310997, decouple_loss:0.007988566532731056
Loss: 0.029809728264808655, avg_mse: 0.038282133638858795
current test mse: 0.038282
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012008_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012008_3_24hr.npz
NaN value num: 0
Iteration: 1741, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4460671544075012
loss_pred:0.021799756214022636, decouple_loss:0.007952255196869373
The generated pressure mean: 0.44759318232536316
The generated pressure mean: 0.4468380808830261
loss_pred:0.02169070392847061, decouple_loss:0.00793538335710764
loss_pred:0.0213586688041687, decouple_loss:0.008265407755970955
Iteration: 1742, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44651535153388977The generated pressure mean: 0.44605761766433716
loss_pred:0.02208932489156723, decouple_loss:0.008495294488966465
loss_pred:0.023166265338659286, decouple_loss:0.008170390501618385
The generated pressure mean: 0.4470561742782593
loss_pred:0.022280624136328697, decouple_loss:0.00814987625926733
Iteration: 1743, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4477647542953491
The generated pressure mean: 0.44681304693222046
loss_pred:0.02163194864988327, decouple_loss:0.008565636351704597
loss_pred:0.023578684777021408, decouple_loss:0.008734225295484066
The generated pressure mean: 0.4477007985115051
loss_pred:0.022508947178721428, decouple_loss:0.008413225412368774
Iteration: 1744, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44610628485679626
The generated pressure mean: 0.4466235339641571
loss_pred:0.02190370298922062, decouple_loss:0.008832946419715881
loss_pred:0.021867036819458008, decouple_loss:0.008716260083019733
The generated pressure mean: 0.44678202271461487
loss_pred:0.021698402240872383, decouple_loss:0.008758350275456905
Iteration: 1745, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4465217888355255
The generated pressure mean: 0.44694983959198
loss_pred:0.02154535986483097, decouple_loss:0.008703796193003654
loss_pred:0.022136665880680084, decouple_loss:0.008792636916041374
The generated pressure mean: 0.44725310802459717
loss_pred:0.022211814299225807, decouple_loss:0.008612905628979206
Iteration: 1746, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4459965229034424
The generated pressure mean: 0.44756370782852173
loss_pred:0.023443294689059258, decouple_loss:0.0086653558537364
loss_pred:0.02113458327949047, decouple_loss:0.008706871420145035
The generated pressure mean: 0.4466151297092438
loss_pred:0.021202651783823967, decouple_loss:0.00876464881002903
Iteration: 1747, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4466697573661804
The generated pressure mean: 0.4468015134334564
loss_pred:0.021835103631019592, decouple_loss:0.007643059827387333
loss_pred:0.0211626086384058, decouple_loss:0.007709165569394827
The generated pressure mean: 0.4467034637928009
loss_pred:0.02265913411974907, decouple_loss:0.00762962969020009
Iteration: 1748, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4461233913898468
The generated pressure mean: 0.4453771114349365
loss_pred:0.02244138903915882, decouple_loss:0.007844190113246441
loss_pred:0.025134636089205742, decouple_loss:0.00808088667690754
The generated pressure mean: 0.4466868042945862
loss_pred:0.022719433531165123, decouple_loss:0.008109196089208126
Iteration: 1749, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44674137234687805
The generated pressure mean: 0.44517549872398376
loss_pred:0.021850695833563805, decouple_loss:0.009727738797664642
loss_pred:0.02225402183830738, decouple_loss:0.009675569832324982
The generated pressure mean: 0.44698435068130493
loss_pred:0.021403515711426735, decouple_loss:0.009586688131093979
Iteration: 1750, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44705235958099365
The generated pressure mean: 0.4463392496109009
loss_pred:0.022036001086235046, decouple_loss:0.008992508053779602
loss_pred:0.022525114938616753, decouple_loss:0.008880007080733776
The generated pressure mean: 0.4456709325313568
loss_pred:0.021313363686203957, decouple_loss:0.008858687244355679
2023-04-16 07:48:46 testing...
The generated pressure mean: 0.449788898229599
The generated pressure mean: 0.4495830833911896
The generated pressure mean: 0.44987666606903076
loss_pred:0.030489346012473106, decouple_loss:0.007864422164857388
loss_pred:0.029494253918528557, decouple_loss:0.007872029207646847
loss_pred:0.028913529589772224, decouple_loss:0.007888616062700748
Loss: 0.030026128515601158, avg_mse: 0.038839418441057205
current test mse: 0.038839
Iteration: 1751, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44700536131858826
loss_pred:0.022444384172558784, decouple_loss:0.00769172003492713
The generated pressure mean: 0.44740474224090576
The generated pressure mean: 0.446519672870636loss_pred:0.021343933418393135, decouple_loss:0.007651555817574263
loss_pred:0.02106766402721405, decouple_loss:0.007662704214453697
Iteration: 1752, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44680383801460266
loss_pred:0.02186703123152256, decouple_loss:0.008508499711751938
The generated pressure mean: 0.4468212425708771
loss_pred:0.021840624511241913, decouple_loss:0.008228541351854801
The generated pressure mean: 0.44520431756973267
loss_pred:0.021757200360298157, decouple_loss:0.008438951335847378
Iteration: 1753, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44679540395736694
The generated pressure mean: 0.4464333653450012
loss_pred:0.021677561104297638, decouple_loss:0.009362054988741875
loss_pred:0.02251780591905117, decouple_loss:0.00926038809120655
The generated pressure mean: 0.44634103775024414
loss_pred:0.02223755232989788, decouple_loss:0.009362272918224335
Iteration: 1754, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4484494626522064
The generated pressure mean: 0.4463663399219513
loss_pred:0.021524885669350624, decouple_loss:0.008461778052151203
loss_pred:0.021918460726737976, decouple_loss:0.008588184602558613
The generated pressure mean: 0.446666419506073
loss_pred:0.021359998732805252, decouple_loss:0.008461729623377323
Iteration: 1755, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4465797543525696The generated pressure mean: 0.44656580686569214
loss_pred:0.021516045555472374, decouple_loss:0.007841942831873894loss_pred:0.021495096385478973, decouple_loss:0.007668724283576012
The generated pressure mean: 0.44643449783325195
loss_pred:0.02294524945318699, decouple_loss:0.007679447066038847
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1756, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4467865526676178
The generated pressure mean: 0.4472448229789734
loss_pred:0.02229956164956093, decouple_loss:0.008259925991296768
loss_pred:0.02201485075056553, decouple_loss:0.008121565915644169
The generated pressure mean: 0.4479460120201111
loss_pred:0.020881107077002525, decouple_loss:0.008223471231758595
Iteration: 1757, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4460991322994232
loss_pred:0.021688174456357956, decouple_loss:0.009262997657060623
The generated pressure mean: 0.4469769597053528
loss_pred:0.02165033295750618, decouple_loss:0.009194212034344673
The generated pressure mean: 0.44758808612823486
loss_pred:0.020641226321458817, decouple_loss:0.009147114120423794
Iteration: 1758, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44712939858436584
The generated pressure mean: 0.44530779123306274
loss_pred:0.02358843758702278, decouple_loss:0.008095930330455303
loss_pred:0.02094084955751896, decouple_loss:0.008317065425217152
The generated pressure mean: 0.4461154639720917
loss_pred:0.02150096744298935, decouple_loss:0.00816923938691616
Iteration: 1759, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44671717286109924
The generated pressure mean: 0.44701674580574036
loss_pred:0.022242583334445953, decouple_loss:0.007855155505239964
loss_pred:0.02305135875940323, decouple_loss:0.007562361191958189
The generated pressure mean: 0.44734692573547363
loss_pred:0.021719370037317276, decouple_loss:0.00768266012892127
Iteration: 1760, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4468805193901062
The generated pressure mean: 0.4468703269958496
loss_pred:0.021139321848750114, decouple_loss:0.007667636498808861
loss_pred:0.020877769216895103, decouple_loss:0.0077085960656404495
The generated pressure mean: 0.44715139269828796
loss_pred:0.021984154358506203, decouple_loss:0.007483070716261864
2023-04-16 07:50:40 testing...
The generated pressure mean: 0.4495830535888672
The generated pressure mean: 0.449788898229599
The generated pressure mean: 0.44987666606903076
loss_pred:0.029447583481669426, decouple_loss:0.008161729201674461
loss_pred:0.030478233471512794, decouple_loss:0.008087709546089172
loss_pred:0.029172727838158607, decouple_loss:0.00810476765036583
Loss: 0.03010541945695877, avg_mse: 0.03898724541068077
current test mse: 0.038987
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012005_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012005_3_24hr.npz
NaN value num: 0
Iteration: 1761, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4475288987159729
loss_pred:0.022530414164066315, decouple_loss:0.008329949341714382
The generated pressure mean: 0.4504387676715851
loss_pred:0.021828513592481613, decouple_loss:0.008505003526806831
The generated pressure mean: 0.4502853751182556
loss_pred:0.021543148905038834, decouple_loss:0.008464350365102291
Iteration: 1762, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4489338994026184
The generated pressure mean: 0.4483104944229126
loss_pred:0.022705523297190666, decouple_loss:0.007877162657678127
loss_pred:0.021327851340174675, decouple_loss:0.008035196922719479
The generated pressure mean: 0.448622465133667
loss_pred:0.02175753004848957, decouple_loss:0.007937747053802013
Iteration: 1763, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4484518766403198
The generated pressure mean: 0.449152410030365loss_pred:0.02102169580757618, decouple_loss:0.008238802663981915
loss_pred:0.02193140797317028, decouple_loss:0.008033782243728638
The generated pressure mean: 0.44825124740600586
loss_pred:0.02271736040711403, decouple_loss:0.008199495263397694
Iteration: 1764, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45020556449890137
loss_pred:0.022539101541042328, decouple_loss:0.00778490025550127
The generated pressure mean: 0.4475174844264984
loss_pred:0.02237050049006939, decouple_loss:0.007747582625597715
The generated pressure mean: 0.4502202570438385
loss_pred:0.02222074195742607, decouple_loss:0.007903351448476315
Iteration: 1765, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44795694947242737
loss_pred:0.021733639761805534, decouple_loss:0.00839075818657875
The generated pressure mean: 0.45058080554008484
loss_pred:0.02058974653482437, decouple_loss:0.008447736501693726
The generated pressure mean: 0.44724041223526
loss_pred:0.02212105691432953, decouple_loss:0.008408835157752037
Iteration: 1766, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44841185212135315
The generated pressure mean: 0.4472036361694336
loss_pred:0.02145181968808174, decouple_loss:0.007700210902839899
loss_pred:0.02117723599076271, decouple_loss:0.007569808512926102
The generated pressure mean: 0.447736918926239
loss_pred:0.021662544459104538, decouple_loss:0.007667806465178728
Iteration: 1767, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44836828112602234
loss_pred:0.02156178094446659, decouple_loss:0.007939047180116177
The generated pressure mean: 0.44905534386634827
loss_pred:0.021565444767475128, decouple_loss:0.008323176763951778
The generated pressure mean: 0.45016369223594666
loss_pred:0.02026333473622799, decouple_loss:0.008291803300380707
Iteration: 1768, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4505947530269623
The generated pressure mean: 0.4494415819644928
loss_pred:0.021476449444890022, decouple_loss:0.0073392693884670734
loss_pred:0.022252453491091728, decouple_loss:0.007247813045978546
The generated pressure mean: 0.44891074299812317
loss_pred:0.022731343284249306, decouple_loss:0.007631874643266201
Iteration: 1769, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4499286413192749
loss_pred:0.021887382492423058, decouple_loss:0.008513413369655609
The generated pressure mean: 0.44941654801368713
loss_pred:0.021066106855869293, decouple_loss:0.008381398394703865
The generated pressure mean: 0.4496532380580902
loss_pred:0.02159501612186432, decouple_loss:0.008354256860911846
Iteration: 1770, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4500689208507538
loss_pred:0.02158958464860916, decouple_loss:0.007840080186724663
The generated pressure mean: 0.45044639706611633
loss_pred:0.021875742822885513, decouple_loss:0.007747213821858168
The generated pressure mean: 0.4494202733039856
loss_pred:0.023134758695960045, decouple_loss:0.007751876022666693
2023-04-16 07:53:16 testing...
The generated pressure mean: 0.449788898229599
The generated pressure mean: 0.4495830237865448
The generated pressure mean: 0.44987666606903076
loss_pred:0.0309766698628664, decouple_loss:0.009153352119028568
loss_pred:0.029616663232445717, decouple_loss:0.009065568447113037
loss_pred:0.029338035732507706, decouple_loss:0.008961128070950508
Loss: 0.030430123209953308, avg_mse: 0.03932149335741997
current test mse: 0.039321
Iteration: 1771, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.448871374130249
loss_pred:0.023505104705691338, decouple_loss:0.009067871607840061
The generated pressure mean: 0.44951102137565613
loss_pred:0.022030062973499298, decouple_loss:0.009150112979114056
The generated pressure mean: 0.450418621301651
loss_pred:0.02204868011176586, decouple_loss:0.009117892012000084
Iteration: 1772, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4487708508968353
The generated pressure mean: 0.4498547315597534
loss_pred:0.022776594385504723, decouple_loss:0.009279303252696991
loss_pred:0.020499566569924355, decouple_loss:0.009085585363209248
The generated pressure mean: 0.450771301984787
loss_pred:0.021789949387311935, decouple_loss:0.009045432321727276
Iteration: 1773, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44892197847366333
loss_pred:0.022855736315250397, decouple_loss:0.008730614557862282
The generated pressure mean: 0.4492276608943939
loss_pred:0.021761341020464897, decouple_loss:0.008769203908741474
The generated pressure mean: 0.45011699199676514
loss_pred:0.021681958809494972, decouple_loss:0.008831260725855827
Iteration: 1774, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4499109387397766
The generated pressure mean: 0.4505392014980316
loss_pred:0.021281013265252113, decouple_loss:0.00803480762988329
loss_pred:0.021511228755116463, decouple_loss:0.007715124171227217
The generated pressure mean: 0.45028233528137207
loss_pred:0.021319281309843063, decouple_loss:0.00778051745146513
Iteration: 1775, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45034259557724
The generated pressure mean: 0.4495910704135895
loss_pred:0.02128041721880436, decouple_loss:0.008927957154810429
loss_pred:0.02166004665195942, decouple_loss:0.008607564494013786
The generated pressure mean: 0.4478796720504761
loss_pred:0.0223076269030571, decouple_loss:0.008948393166065216
Iteration: 1776, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4502430558204651
loss_pred:0.021636955440044403, decouple_loss:0.007996929809451103
The generated pressure mean: 0.4487534761428833
loss_pred:0.021224142983555794, decouple_loss:0.008001246489584446
The generated pressure mean: 0.4493190050125122
loss_pred:0.02240568958222866, decouple_loss:0.008064552210271358
Iteration: 1777, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4490041136741638
The generated pressure mean: 0.4494454860687256
loss_pred:0.022503266111016273, decouple_loss:0.008623084984719753
loss_pred:0.02294168807566166, decouple_loss:0.008478844538331032
The generated pressure mean: 0.4500133991241455
loss_pred:0.020313190296292305, decouple_loss:0.008595301769673824
Iteration: 1778, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4495620131492615
The generated pressure mean: 0.4490760564804077
loss_pred:0.02257123403251171, decouple_loss:0.008173436857759953
loss_pred:0.02172512747347355, decouple_loss:0.0080306651070714
The generated pressure mean: 0.4494057595729828
loss_pred:0.02214287966489792, decouple_loss:0.008216703310608864
Iteration: 1779, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44910553097724915The generated pressure mean: 0.4490104019641876
loss_pred:0.022481808438897133, decouple_loss:0.008757512085139751loss_pred:0.022729841992259026, decouple_loss:0.008812421932816505
The generated pressure mean: 0.4496975243091583
loss_pred:0.021765850484371185, decouple_loss:0.008488169871270657
Iteration: 1780, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4493323266506195
The generated pressure mean: 0.449002742767334
loss_pred:0.023073092103004456, decouple_loss:0.007850554771721363
loss_pred:0.022807711735367775, decouple_loss:0.007808071095496416
The generated pressure mean: 0.4496974050998688
loss_pred:0.021527623757719994, decouple_loss:0.007777155376970768
2023-04-16 07:55:08 testing...
The generated pressure mean: 0.4495830833911896
The generated pressure mean: 0.4497888684272766
The generated pressure mean: 0.4498766362667084
loss_pred:0.030345309525728226, decouple_loss:0.009459766559302807
loss_pred:0.03121192194521427, decouple_loss:0.009212525561451912
loss_pred:0.029563935473561287, decouple_loss:0.009417732246220112
Loss: 0.0308418907225132, avg_mse: 0.040289223194122314
current test mse: 0.040289
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012010_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012010_3_24hr.npz
NaN value num: 0
Iteration: 1781, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44760164618492126
loss_pred:0.022717095911502838, decouple_loss:0.009253173135221004
The generated pressure mean: 0.4469422698020935
loss_pred:0.02203957922756672, decouple_loss:0.009229608811438084
The generated pressure mean: 0.4477773904800415
loss_pred:0.023092063143849373, decouple_loss:0.009151115082204342
Iteration: 1782, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44685855507850647
The generated pressure mean: 0.446647047996521
loss_pred:0.022085577249526978, decouple_loss:0.00838734582066536
loss_pred:0.02510800212621689, decouple_loss:0.008526104502379894
The generated pressure mean: 0.4472237229347229
loss_pred:0.022415388375520706, decouple_loss:0.008307766169309616
Iteration: 1783, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44849157333374023
The generated pressure mean: 0.4477587342262268
loss_pred:0.022783536463975906, decouple_loss:0.008750145323574543
loss_pred:0.021726291626691818, decouple_loss:0.008596832863986492
The generated pressure mean: 0.4465716779232025
loss_pred:0.022072618827223778, decouple_loss:0.008687291294336319
Iteration: 1784, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44752150774002075
The generated pressure mean: 0.447517991065979
loss_pred:0.0218290314078331, decouple_loss:0.008119986392557621
loss_pred:0.020453281700611115, decouple_loss:0.008143997751176357
The generated pressure mean: 0.44735005497932434
loss_pred:0.022263888269662857, decouple_loss:0.008126487024128437
Iteration: 1785, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44812914729118347The generated pressure mean: 0.44689857959747314
loss_pred:0.023620188236236572, decouple_loss:0.008827165700495243
loss_pred:0.024807021021842957, decouple_loss:0.00873098149895668
The generated pressure mean: 0.4476369321346283
loss_pred:0.02221531979739666, decouple_loss:0.008606321178376675
Iteration: 1786, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44848939776420593
The generated pressure mean: 0.44741079211235046
loss_pred:0.022051364183425903, decouple_loss:0.008557847701013088
loss_pred:0.02382010780274868, decouple_loss:0.008594347164034843
The generated pressure mean: 0.44711413979530334
loss_pred:0.021951260045170784, decouple_loss:0.008450888097286224
Iteration: 1787, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4466698467731476
The generated pressure mean: 0.4467315375804901
loss_pred:0.02256489172577858, decouple_loss:0.00932672992348671
loss_pred:0.022027524188160896, decouple_loss:0.009174677543342113
The generated pressure mean: 0.4480860233306885
loss_pred:0.021869489923119545, decouple_loss:0.009213943965733051
Iteration: 1788, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4472287595272064
The generated pressure mean: 0.44917982816696167
loss_pred:0.02167651429772377, decouple_loss:0.00844124797731638
loss_pred:0.021741028875112534, decouple_loss:0.008603028953075409
The generated pressure mean: 0.4473575949668884
loss_pred:0.021336354315280914, decouple_loss:0.0083622420206666
Iteration: 1789, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4479084014892578
The generated pressure mean: 0.447172075510025
loss_pred:0.021679712459445, decouple_loss:0.00894637405872345
loss_pred:0.022479983046650887, decouple_loss:0.009070158004760742
The generated pressure mean: 0.4479628801345825
loss_pred:0.02111867628991604, decouple_loss:0.009107081219553947
Iteration: 1790, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44840559363365173
The generated pressure mean: 0.4481261074542999
loss_pred:0.022335384041070938, decouple_loss:0.00875894445925951
loss_pred:0.021309560164809227, decouple_loss:0.008815388195216656
The generated pressure mean: 0.4488455653190613
loss_pred:0.02173636481165886, decouple_loss:0.00874718464910984
2023-04-16 07:57:45 testing...
The generated pressure mean: 0.4497888684272766
The generated pressure mean: 0.4495830535888672
The generated pressure mean: 0.4498766362667084
loss_pred:0.030238931998610497, decouple_loss:0.008639113046228886
loss_pred:0.029342960566282272, decouple_loss:0.008487120270729065
loss_pred:0.029115619137883186, decouple_loss:0.008538524620234966
Loss: 0.029993584379553795, avg_mse: 0.03875729814171791
current test mse: 0.038757
Iteration: 1791, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4487683176994324
The generated pressure mean: 0.4477115571498871
loss_pred:0.020844267681241035, decouple_loss:0.008543949574232101
loss_pred:0.021592028439044952, decouple_loss:0.008553232066333294
The generated pressure mean: 0.4484303593635559
loss_pred:0.02064438909292221, decouple_loss:0.008806643076241016
Iteration: 1792, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4486684501171112
The generated pressure mean: 0.447221040725708
loss_pred:0.022249506786465645, decouple_loss:0.008178552612662315
loss_pred:0.022075651213526726, decouple_loss:0.008084005676209927
The generated pressure mean: 0.4482623338699341
loss_pred:0.022251348942518234, decouple_loss:0.008183072321116924
Iteration: 1793, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4478238523006439
loss_pred:0.02224116399884224, decouple_loss:0.008688634261488914
The generated pressure mean: 0.44812214374542236
loss_pred:0.02153746783733368, decouple_loss:0.008570104837417603
The generated pressure mean: 0.44782301783561707
loss_pred:0.022081008180975914, decouple_loss:0.008551063016057014
Iteration: 1794, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.446898490190506
The generated pressure mean: 0.4464516043663025loss_pred:0.022194482386112213, decouple_loss:0.008033095858991146
loss_pred:0.0235903300344944, decouple_loss:0.007848274894058704
The generated pressure mean: 0.44818034768104553
loss_pred:0.023441234603524208, decouple_loss:0.008142219856381416
Iteration: 1795, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4472768306732178
loss_pred:0.022827068343758583, decouple_loss:0.008638786152005196
The generated pressure mean: 0.4469960927963257
loss_pred:0.02189413644373417, decouple_loss:0.008465672843158245
The generated pressure mean: 0.448211133480072
loss_pred:0.020268123596906662, decouple_loss:0.008560346439480782
Iteration: 1796, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44746920466423035
loss_pred:0.022968992590904236, decouple_loss:0.007926227524876595
The generated pressure mean: 0.44714412093162537
loss_pred:0.022347088903188705, decouple_loss:0.00791475921869278
The generated pressure mean: 0.44752365350723267
loss_pred:0.022396238520741463, decouple_loss:0.007672767620533705
Iteration: 1797, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44715961813926697
loss_pred:0.02210417576134205, decouple_loss:0.0081134969368577
The generated pressure mean: 0.4480065703392029
loss_pred:0.02281106822192669, decouple_loss:0.008445540443062782
The generated pressure mean: 0.44832539558410645
loss_pred:0.021186189725995064, decouple_loss:0.008349482901394367
Iteration: 1798, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4480511248111725
loss_pred:0.022446420043706894, decouple_loss:0.007893169298768044
The generated pressure mean: 0.44893425703048706
loss_pred:0.021119775250554085, decouple_loss:0.008030462078750134
The generated pressure mean: 0.4472235441207886
loss_pred:0.02152649685740471, decouple_loss:0.007836367934942245
Iteration: 1799, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44710662961006165
loss_pred:0.02256658673286438, decouple_loss:0.008980968035757542
The generated pressure mean: 0.4485773742198944
loss_pred:0.02156784012913704, decouple_loss:0.008948090486228466
The generated pressure mean: 0.44782397150993347
loss_pred:0.021863533183932304, decouple_loss:0.008986418135464191
Iteration: 1800, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4472044110298157
loss_pred:0.022446678951382637, decouple_loss:0.008050905540585518
The generated pressure mean: 0.4480394124984741
loss_pred:0.0210490133613348, decouple_loss:0.008144645020365715
The generated pressure mean: 0.447181761264801
loss_pred:0.022288640961050987, decouple_loss:0.00806078128516674
2023-04-16 07:59:39 testing...
The generated pressure mean: 0.4497888684272766
The generated pressure mean: 0.4495830535888672
The generated pressure mean: 0.44987666606903076
loss_pred:0.030291642993688583, decouple_loss:0.007947576232254505
loss_pred:0.029384911060333252, decouple_loss:0.007907254621386528
loss_pred:0.02867746539413929, decouple_loss:0.00787291955202818
Loss: 0.029846802353858948, avg_mse: 0.03864411264657974
current test mse: 0.038644
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012011_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012011_3_24hr.npz
NaN value num: 0
Iteration: 1801, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44885823130607605
loss_pred:0.022775547578930855, decouple_loss:0.00854417122900486
The generated pressure mean: 0.44760072231292725
loss_pred:0.02233176678419113, decouple_loss:0.008007422089576721
The generated pressure mean: 0.44691959023475647
loss_pred:0.022346869111061096, decouple_loss:0.007873873226344585
Iteration: 1802, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44568493962287903
loss_pred:0.02250460349023342, decouple_loss:0.007363330572843552
The generated pressure mean: 0.44704756140708923
loss_pred:0.022572923451662064, decouple_loss:0.0073648192919790745
The generated pressure mean: 0.44810667634010315
loss_pred:0.025418628007173538, decouple_loss:0.007446243893355131
Iteration: 1803, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4473292827606201
The generated pressure mean: 0.44751569628715515
loss_pred:0.022495131939649582, decouple_loss:0.007908827625215054
loss_pred:0.022133199498057365, decouple_loss:0.007906341925263405
The generated pressure mean: 0.44817230105400085
loss_pred:0.021529491990804672, decouple_loss:0.007803598418831825
Iteration: 1804, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44641295075416565
The generated pressure mean: 0.44582653045654297
loss_pred:0.02243451029062271, decouple_loss:0.008055252023041248
loss_pred:0.021677738055586815, decouple_loss:0.008196625858545303
The generated pressure mean: 0.4464486241340637
loss_pred:0.020867088809609413, decouple_loss:0.008189300075173378
Iteration: 1805, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4472138285636902
loss_pred:0.022135930135846138, decouple_loss:0.008442758582532406
The generated pressure mean: 0.44625362753868103
loss_pred:0.024562332779169083, decouple_loss:0.008369166404008865
The generated pressure mean: 0.44632503390312195
loss_pred:0.020958229899406433, decouple_loss:0.008597549051046371
Iteration: 1806, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4475928544998169
loss_pred:0.023423010483384132, decouple_loss:0.0078439274802804
The generated pressure mean: 0.4459315538406372
loss_pred:0.02300834283232689, decouple_loss:0.007933867163956165
The generated pressure mean: 0.4463035464286804
loss_pred:0.02133132703602314, decouple_loss:0.007896091789007187
Iteration: 1807, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4480065703392029
The generated pressure mean: 0.44609498977661133
loss_pred:0.022240418940782547, decouple_loss:0.008167501538991928
loss_pred:0.02179662138223648, decouple_loss:0.00811478216201067
The generated pressure mean: 0.4478110373020172
loss_pred:0.02232738956809044, decouple_loss:0.008249561302363873
Iteration: 1808, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4479667842388153
loss_pred:0.022124234586954117, decouple_loss:0.008195766247808933
The generated pressure mean: 0.44646894931793213
loss_pred:0.022402584552764893, decouple_loss:0.00826337467879057
The generated pressure mean: 0.4459937512874603
loss_pred:0.022264808416366577, decouple_loss:0.008552583865821362
Iteration: 1809, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4468763768672943
loss_pred:0.021869514137506485, decouple_loss:0.00841210875660181
The generated pressure mean: 0.44820311665534973
loss_pred:0.021908659487962723, decouple_loss:0.008375108242034912
The generated pressure mean: 0.4460310637950897
loss_pred:0.023064181208610535, decouple_loss:0.008276025764644146
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1810, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4466208219528198
The generated pressure mean: 0.4467660188674927
loss_pred:0.022200627252459526, decouple_loss:0.007859908044338226
loss_pred:0.02094193361699581, decouple_loss:0.007687818259000778
The generated pressure mean: 0.4473477303981781
loss_pred:0.021327773109078407, decouple_loss:0.007903180085122585
2023-04-16 08:02:10 testing...
The generated pressure mean: 0.4497888684272766
The generated pressure mean: 0.4495830535888672
The generated pressure mean: 0.44987666606903076
loss_pred:0.030756063759326935, decouple_loss:0.008013851009309292
loss_pred:0.029877685010433197, decouple_loss:0.0079197334125638
loss_pred:0.029756348580121994, decouple_loss:0.007999044843018055
Loss: 0.030528908595442772, avg_mse: 0.039986371994018555
current test mse: 0.039986
Iteration: 1811, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4488367438316345
The generated pressure mean: 0.4467123746871948
loss_pred:0.021685903891921043, decouple_loss:0.00810937862843275
loss_pred:0.02237977646291256, decouple_loss:0.008097737096250057
The generated pressure mean: 0.44746020436286926
loss_pred:0.021213175728917122, decouple_loss:0.00814527552574873
Iteration: 1812, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4456796944141388
loss_pred:0.021272756159305573, decouple_loss:0.007694419007748365
The generated pressure mean: 0.44904762506484985
loss_pred:0.022073272615671158, decouple_loss:0.007741765584796667
The generated pressure mean: 0.44647493958473206
loss_pred:0.021773170679807663, decouple_loss:0.007816378027200699
Iteration: 1813, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44739651679992676
The generated pressure mean: 0.44582533836364746
loss_pred:0.02213473990559578, decouple_loss:0.008293235674500465
loss_pred:0.02191031165421009, decouple_loss:0.008277527987957
The generated pressure mean: 0.44879674911499023
loss_pred:0.021900497376918793, decouple_loss:0.008241123519837856
Iteration: 1814, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4462599754333496
loss_pred:0.022901665419340134, decouple_loss:0.007845105603337288
The generated pressure mean: 0.44710493087768555
loss_pred:0.0216565802693367, decouple_loss:0.007805274799466133
The generated pressure mean: 0.4474707841873169
loss_pred:0.02153022587299347, decouple_loss:0.0078057898208498955
Iteration: 1815, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4481782019138336
loss_pred:0.020918363705277443, decouple_loss:0.008205697871744633
The generated pressure mean: 0.4474453032016754
loss_pred:0.02229527197778225, decouple_loss:0.008185169659554958
The generated pressure mean: 0.44664016366004944
loss_pred:0.021659260615706444, decouple_loss:0.008276636712253094
Iteration: 1816, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4452895224094391
loss_pred:0.02125711739063263, decouple_loss:0.008037056773900986
The generated pressure mean: 0.44667911529541016
loss_pred:0.02144070342183113, decouple_loss:0.007936978712677956
The generated pressure mean: 0.4461468756198883
loss_pred:0.022327587008476257, decouple_loss:0.007791002281010151
Iteration: 1817, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4472636878490448
The generated pressure mean: 0.4483022689819336
loss_pred:0.02136850543320179, decouple_loss:0.007930192165076733
loss_pred:0.02169172279536724, decouple_loss:0.008144724182784557
The generated pressure mean: 0.4462074935436249
loss_pred:0.021432606503367424, decouple_loss:0.008106487803161144
Iteration: 1818, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44577547907829285
loss_pred:0.023536089807748795, decouple_loss:0.007985427975654602
The generated pressure mean: 0.4485739767551422
loss_pred:0.02344760112464428, decouple_loss:0.008360243402421474
The generated pressure mean: 0.44859594106674194
loss_pred:0.023105258122086525, decouple_loss:0.008214191533625126
Iteration: 1819, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4468863010406494
loss_pred:0.021752169355750084, decouple_loss:0.00859961099922657
The generated pressure mean: 0.4468236267566681
loss_pred:0.02165529504418373, decouple_loss:0.008553343825042248
The generated pressure mean: 0.44627127051353455
loss_pred:0.022883683443069458, decouple_loss:0.00856810063123703
Iteration: 1820, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4466908872127533
loss_pred:0.022082006558775902, decouple_loss:0.009798232465982437
The generated pressure mean: 0.44525769352912903
loss_pred:0.02103513851761818, decouple_loss:0.01000277604907751
The generated pressure mean: 0.44677528738975525
loss_pred:0.023196130990982056, decouple_loss:0.009816686622798443
2023-04-16 08:04:03 testing...
The generated pressure mean: 0.4497888684272766
The generated pressure mean: 0.4495830535888672
The generated pressure mean: 0.44987666606903076
loss_pred:0.029850831255316734, decouple_loss:0.010202337987720966
loss_pred:0.028873097151517868, decouple_loss:0.010144982486963272
loss_pred:0.028681378811597824, decouple_loss:0.01030992902815342
Loss: 0.02964605763554573, avg_mse: 0.03809259831905365
current test mse: 0.038093
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012005_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012005_3_24hr.npz
NaN value num: 0
Iteration: 1821, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4482309818267822
loss_pred:0.02177691087126732, decouple_loss:0.010202114470303059
The generated pressure mean: 0.44870543479919434
loss_pred:0.022510312497615814, decouple_loss:0.01033391896635294
The generated pressure mean: 0.4486353099346161
loss_pred:0.021484555676579475, decouple_loss:0.010315257124602795
Iteration: 1822, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4479963183403015
The generated pressure mean: 0.4478552043437958
loss_pred:0.022400345653295517, decouple_loss:0.008555019274353981
loss_pred:0.022580556571483612, decouple_loss:0.008574998006224632
The generated pressure mean: 0.4485089182853699
loss_pred:0.020878635346889496, decouple_loss:0.008483783341944218
Iteration: 1823, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4481388330459595
The generated pressure mean: 0.44635310769081116
loss_pred:0.02254428155720234, decouple_loss:0.009598883800208569
loss_pred:0.02263164520263672, decouple_loss:0.009980757720768452
The generated pressure mean: 0.44933339953422546
loss_pred:0.022735727950930595, decouple_loss:0.009851460345089436
Iteration: 1824, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4484032988548279
The generated pressure mean: 0.4482119381427765
loss_pred:0.02117869444191456, decouple_loss:0.00883651152253151
loss_pred:0.022203808650374413, decouple_loss:0.008997536264359951
The generated pressure mean: 0.44903212785720825
loss_pred:0.02064485102891922, decouple_loss:0.009196043945848942
Iteration: 1825, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44756248593330383
The generated pressure mean: 0.44805780053138733
loss_pred:0.021968035027384758, decouple_loss:0.008464738726615906
loss_pred:0.020800599828362465, decouple_loss:0.008411083370447159
The generated pressure mean: 0.44876736402511597
loss_pred:0.020372038707137108, decouple_loss:0.008531835861504078
Iteration: 1826, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4473727345466614
The generated pressure mean: 0.4494702219963074
loss_pred:0.02168901450932026, decouple_loss:0.008922030217945576
loss_pred:0.021674318239092827, decouple_loss:0.009249449707567692
The generated pressure mean: 0.4489459991455078
loss_pred:0.021494291722774506, decouple_loss:0.009225428104400635
Iteration: 1827, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4487270414829254
The generated pressure mean: 0.448775053024292
loss_pred:0.020833780989050865, decouple_loss:0.0080791674554348
loss_pred:0.02057141624391079, decouple_loss:0.008125885389745235
The generated pressure mean: 0.44869399070739746
loss_pred:0.02173570729792118, decouple_loss:0.007940794341266155
Iteration: 1828, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4485594630241394
The generated pressure mean: 0.4492049813270569
loss_pred:0.02142208255827427, decouple_loss:0.009373134933412075
loss_pred:0.022135071456432343, decouple_loss:0.009362592361867428
The generated pressure mean: 0.4478801488876343
loss_pred:0.021446773782372475, decouple_loss:0.009340981021523476
Iteration: 1829, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44955798983573914
loss_pred:0.019913071766495705, decouple_loss:0.008644244633615017
The generated pressure mean: 0.44862884283065796
loss_pred:0.02128705009818077, decouple_loss:0.008655811659991741
The generated pressure mean: 0.44863730669021606
loss_pred:0.02265419252216816, decouple_loss:0.00851255003362894
Iteration: 1830, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4475170373916626
The generated pressure mean: 0.44862377643585205
loss_pred:0.022744489833712578, decouple_loss:0.008129321038722992
loss_pred:0.022827696055173874, decouple_loss:0.007878214120864868
The generated pressure mean: 0.4495489001274109
loss_pred:0.021381184458732605, decouple_loss:0.00788236316293478
2023-04-16 08:06:34 testing...
The generated pressure mean: 0.4495830237865448
The generated pressure mean: 0.449788898229599
The generated pressure mean: 0.44987666606903076
loss_pred:0.028291741386055946, decouple_loss:0.009609290398657322
loss_pred:0.029210669919848442, decouple_loss:0.009554675780236721
loss_pred:0.027893761172890663, decouple_loss:0.009557478129863739
Loss: 0.02894408069550991, avg_mse: 0.03683967888355255
current test mse: 0.03684
Iteration: 1831, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.447951078414917
loss_pred:0.021572234109044075, decouple_loss:0.00959057454019785
The generated pressure mean: 0.448984295129776
loss_pred:0.020863261073827744, decouple_loss:0.009743251837790012
The generated pressure mean: 0.448012113571167
loss_pred:0.022533519193530083, decouple_loss:0.009479757398366928
Iteration: 1832, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4483334422111511
loss_pred:0.021139416843652725, decouple_loss:0.009214374236762524
The generated pressure mean: 0.4477488100528717
loss_pred:0.02139171212911606, decouple_loss:0.008833962492644787
The generated pressure mean: 0.44808676838874817
loss_pred:0.022631097584962845, decouple_loss:0.008959413506090641
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1833, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44758477807044983
loss_pred:0.021465802565217018, decouple_loss:0.009016897529363632
The generated pressure mean: 0.44871985912323
loss_pred:0.020853674039244652, decouple_loss:0.009047415107488632
The generated pressure mean: 0.4472561478614807
loss_pred:0.022353485226631165, decouple_loss:0.009343781508505344
Iteration: 1834, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4487855136394501
loss_pred:0.022728705778717995, decouple_loss:0.0091674430295825
The generated pressure mean: 0.44839170575141907
loss_pred:0.02139264903962612, decouple_loss:0.009053708985447884
The generated pressure mean: 0.449144572019577
loss_pred:0.02124175801873207, decouple_loss:0.009070275351405144
Iteration: 1835, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4481961727142334
loss_pred:0.021101221442222595, decouple_loss:0.009814516641199589
The generated pressure mean: 0.44847413897514343
loss_pred:0.023496219888329506, decouple_loss:0.009916188195347786
The generated pressure mean: 0.4471951127052307
loss_pred:0.021512260660529137, decouple_loss:0.009829566814005375
Iteration: 1836, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4486894905567169
The generated pressure mean: 0.4482963979244232
loss_pred:0.022120047360658646, decouple_loss:0.008535477332770824
loss_pred:0.021954359486699104, decouple_loss:0.008646201342344284
The generated pressure mean: 0.4485745131969452
loss_pred:0.02150495909154415, decouple_loss:0.00848234910517931
Iteration: 1837, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44666150212287903
loss_pred:0.022390516474843025, decouple_loss:0.009931604377925396
The generated pressure mean: 0.44882646203041077
loss_pred:0.021688714623451233, decouple_loss:0.010216559283435345
The generated pressure mean: 0.4480783939361572
loss_pred:0.02176753431558609, decouple_loss:0.010000686161220074
Iteration: 1838, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44858911633491516
loss_pred:0.021236442029476166, decouple_loss:0.008212633430957794
The generated pressure mean: 0.4477235674858093
loss_pred:0.02260481007397175, decouple_loss:0.00804940052330494
The generated pressure mean: 0.44877079129219055
loss_pred:0.02097824029624462, decouple_loss:0.008241122588515282
Iteration: 1839, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4473927319049835
The generated pressure mean: 0.4482080340385437
loss_pred:0.02285950630903244, decouple_loss:0.008256848901510239
loss_pred:0.02173997275531292, decouple_loss:0.00839804857969284
The generated pressure mean: 0.4480448067188263
loss_pred:0.021373143419623375, decouple_loss:0.008508175611495972
Iteration: 1840, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4474312961101532
loss_pred:0.021661922335624695, decouple_loss:0.008798993192613125
The generated pressure mean: 0.44889020919799805
loss_pred:0.021237041801214218, decouple_loss:0.008950895629823208
The generated pressure mean: 0.4487454891204834
loss_pred:0.022105516865849495, decouple_loss:0.008889909833669662
2023-04-16 08:08:27 testing...
The generated pressure mean: 0.4495830535888672
The generated pressure mean: 0.4497888684272766
The generated pressure mean: 0.44987666606903076
loss_pred:0.03001672774553299, decouple_loss:0.008189670741558075
loss_pred:0.030702626332640648, decouple_loss:0.008149789646267891
loss_pred:0.029711276292800903, decouple_loss:0.00814664177596569
Loss: 0.030551645904779434, avg_mse: 0.04017828404903412
current test mse: 0.040178
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012006_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012006_3_24hr.npz
NaN value num: 0
Iteration: 1841, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4485522210597992
loss_pred:0.020418507978320122, decouple_loss:0.00815801415592432
The generated pressure mean: 0.4471854567527771
loss_pred:0.02299978956580162, decouple_loss:0.008211893029510975
The generated pressure mean: 0.44688403606414795
loss_pred:0.021509479731321335, decouple_loss:0.008263514377176762
Iteration: 1842, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4493085741996765
The generated pressure mean: 0.4473554193973541
loss_pred:0.020652534440159798, decouple_loss:0.008860954083502293
loss_pred:0.02124447375535965, decouple_loss:0.008735861629247665
The generated pressure mean: 0.4476637840270996
loss_pred:0.022353509441018105, decouple_loss:0.00894010066986084
Iteration: 1843, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44675448536872864
The generated pressure mean: 0.4474269449710846
loss_pred:0.021991394460201263, decouple_loss:0.009328598156571388
loss_pred:0.0216438639909029, decouple_loss:0.009468348696827888
The generated pressure mean: 0.44660717248916626
loss_pred:0.02183365635573864, decouple_loss:0.00923839583992958
Iteration: 1844, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44769397377967834
The generated pressure mean: 0.44653046131134033
loss_pred:0.021709946915507317, decouple_loss:0.008567285723984241
loss_pred:0.021911252290010452, decouple_loss:0.008643954992294312
The generated pressure mean: 0.44820713996887207
loss_pred:0.021395722404122353, decouple_loss:0.008537767454981804
Iteration: 1845, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44688132405281067
The generated pressure mean: 0.44693994522094727
loss_pred:0.022703371942043304, decouple_loss:0.007408040575683117
loss_pred:0.022306734696030617, decouple_loss:0.007287441287189722
The generated pressure mean: 0.44734081625938416
loss_pred:0.021822098642587662, decouple_loss:0.007586861494928598
Iteration: 1846, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4473111629486084The generated pressure mean: 0.4474707543849945
loss_pred:0.022275708615779877, decouple_loss:0.009542549960315228loss_pred:0.022120902314782143, decouple_loss:0.009425684809684753
The generated pressure mean: 0.4470902383327484
loss_pred:0.020870016887784004, decouple_loss:0.00946022104471922
Iteration: 1847, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4480040967464447The generated pressure mean: 0.44832292199134827
loss_pred:0.022125698626041412, decouple_loss:0.008212936110794544
loss_pred:0.022283006459474564, decouple_loss:0.008418469689786434
The generated pressure mean: 0.44795042276382446
loss_pred:0.02277402952313423, decouple_loss:0.008537826128304005
Iteration: 1848, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4479466378688812
The generated pressure mean: 0.44862890243530273
loss_pred:0.02063031494617462, decouple_loss:0.00784599781036377
loss_pred:0.022562550380825996, decouple_loss:0.0077062565833330154
The generated pressure mean: 0.447664350271225
loss_pred:0.02250714786350727, decouple_loss:0.0077979168854653835
Iteration: 1849, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44823774695396423The generated pressure mean: 0.44815999269485474
loss_pred:0.023373443633317947, decouple_loss:0.007822857238352299loss_pred:0.022690072655677795, decouple_loss:0.007915819995105267
The generated pressure mean: 0.44660675525665283
loss_pred:0.023206669837236404, decouple_loss:0.008047375828027725
Iteration: 1850, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44682765007019043
The generated pressure mean: 0.4478028416633606
loss_pred:0.022044148296117783, decouple_loss:0.008288185112178326
loss_pred:0.02174311690032482, decouple_loss:0.00811745971441269
The generated pressure mean: 0.4473397135734558
loss_pred:0.021732773631811142, decouple_loss:0.008228890597820282
2023-04-16 08:10:59 testing...
The generated pressure mean: 0.449788898229599
The generated pressure mean: 0.4495830535888672
The generated pressure mean: 0.44987666606903076
loss_pred:0.030965806916356087, decouple_loss:0.008074155077338219
loss_pred:0.029870852828025818, decouple_loss:0.00811922550201416
loss_pred:0.029319124296307564, decouple_loss:0.008138233795762062
Loss: 0.030457455664873123, avg_mse: 0.039956316351890564
current test mse: 0.039956
Iteration: 1851, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44699323177337646
loss_pred:0.022115547209978104, decouple_loss:0.008130771107971668
The generated pressure mean: 0.44732606410980225
loss_pred:0.022839341312646866, decouple_loss:0.008186636492609978
The generated pressure mean: 0.447831928730011
loss_pred:0.022393887862563133, decouple_loss:0.007940039969980717
Iteration: 1852, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44681665301322937
The generated pressure mean: 0.44773998856544495
loss_pred:0.02110470086336136, decouple_loss:0.007816433906555176
loss_pred:0.021105334162712097, decouple_loss:0.007760218344628811
The generated pressure mean: 0.4482698440551758
loss_pred:0.021225959062576294, decouple_loss:0.007849004119634628
Iteration: 1853, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4473671317100525
The generated pressure mean: 0.44622570276260376
loss_pred:0.021941622719168663, decouple_loss:0.00859007891267538
loss_pred:0.023095816373825073, decouple_loss:0.008570264093577862
The generated pressure mean: 0.44745659828186035
loss_pred:0.021835165098309517, decouple_loss:0.008651523850858212
Iteration: 1854, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4481634795665741
loss_pred:0.021319951862096786, decouple_loss:0.008455135859549046
The generated pressure mean: 0.44761157035827637
loss_pred:0.024960657581686974, decouple_loss:0.008178546093404293
The generated pressure mean: 0.4474378228187561
loss_pred:0.023016346618533134, decouple_loss:0.00825501512736082
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1855, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44754332304000854
loss_pred:0.022321725264191628, decouple_loss:0.007736312225461006
The generated pressure mean: 0.4472196102142334
loss_pred:0.022269057109951973, decouple_loss:0.007805895525962114
The generated pressure mean: 0.44814372062683105
loss_pred:0.02346697263419628, decouple_loss:0.00784857664257288
Iteration: 1856, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4477618932723999
loss_pred:0.0236239992082119, decouple_loss:0.007965669967234135
The generated pressure mean: 0.4472962021827698
loss_pred:0.022766536101698875, decouple_loss:0.008111527189612389
The generated pressure mean: 0.4481145441532135
loss_pred:0.02272089570760727, decouple_loss:0.007798327598720789
Iteration: 1857, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44723570346832275
loss_pred:0.021868064999580383, decouple_loss:0.008038122206926346
The generated pressure mean: 0.4488238990306854
loss_pred:0.0209527388215065, decouple_loss:0.008098973892629147
The generated pressure mean: 0.4472769796848297
loss_pred:0.02365831471979618, decouple_loss:0.008088216185569763
Iteration: 1858, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4466507136821747
loss_pred:0.020578183233737946, decouple_loss:0.007905742153525352
The generated pressure mean: 0.4468086063861847
loss_pred:0.022041447460651398, decouple_loss:0.007982984185218811
The generated pressure mean: 0.44794484972953796
loss_pred:0.022816868498921394, decouple_loss:0.007844099774956703
Iteration: 1859, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44680526852607727
loss_pred:0.021990567445755005, decouple_loss:0.007419880013912916
The generated pressure mean: 0.44689297676086426
loss_pred:0.021210981532931328, decouple_loss:0.007404608651995659
The generated pressure mean: 0.4467688500881195
loss_pred:0.023672597482800484, decouple_loss:0.00730634992942214
Iteration: 1860, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4471207857131958
loss_pred:0.023037973791360855, decouple_loss:0.007765856105834246
The generated pressure mean: 0.4472900927066803
loss_pred:0.024814339354634285, decouple_loss:0.00759537611156702
The generated pressure mean: 0.4472491145133972
loss_pred:0.02227095142006874, decouple_loss:0.007734308019280434
2023-04-16 08:12:52 testing...
The generated pressure mean: 0.4495830535888672
The generated pressure mean: 0.449788898229599
The generated pressure mean: 0.44987666606903076
loss_pred:0.028418762609362602, decouple_loss:0.0075569250620901585
loss_pred:0.029263140633702278, decouple_loss:0.007677657529711723
loss_pred:0.028058959171175957, decouple_loss:0.007541861850768328
Loss: 0.02895989641547203, avg_mse: 0.03711584955453873
current test mse: 0.037116
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012017_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012017_3_24hr.npz
NaN value num: 0
Iteration: 1861, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44885721802711487
loss_pred:0.022015320137143135, decouple_loss:0.007770526688545942
The generated pressure mean: 0.44799748063087463
loss_pred:0.026328114792704582, decouple_loss:0.007634480483829975
The generated pressure mean: 0.4477007985115051
loss_pred:0.022519633173942566, decouple_loss:0.007686323020607233
Iteration: 1862, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4487735331058502
The generated pressure mean: 0.4497976005077362
loss_pred:0.02148445136845112, decouple_loss:0.008407809771597385
loss_pred:0.024979475885629654, decouple_loss:0.008529487997293472
The generated pressure mean: 0.4480086863040924
loss_pred:0.023285841569304466, decouple_loss:0.008472665213048458
Iteration: 1863, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44720131158828735
loss_pred:0.024310017004609108, decouple_loss:0.007843810133635998
The generated pressure mean: 0.4482285976409912
loss_pred:0.0214689951390028, decouple_loss:0.008301718160510063
The generated pressure mean: 0.4494132995605469
loss_pred:0.02165764383971691, decouple_loss:0.008004187606275082
Iteration: 1864, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4481375217437744
loss_pred:0.021226126700639725, decouple_loss:0.0076695093885064125
The generated pressure mean: 0.4475981593132019
loss_pred:0.022117918357253075, decouple_loss:0.00767045421525836
The generated pressure mean: 0.44861671328544617
loss_pred:0.02094012126326561, decouple_loss:0.007851722650229931
Iteration: 1865, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44741275906562805
loss_pred:0.024095457047224045, decouple_loss:0.007115955930203199
The generated pressure mean: 0.4486769139766693
loss_pred:0.024314992129802704, decouple_loss:0.007530359085649252
The generated pressure mean: 0.44900357723236084
loss_pred:0.021554162725806236, decouple_loss:0.007489364128559828
Iteration: 1866, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44885775446891785
loss_pred:0.02075546607375145, decouple_loss:0.008166670799255371
The generated pressure mean: 0.448723167181015
loss_pred:0.02194802649319172, decouple_loss:0.007915755733847618
The generated pressure mean: 0.4488871693611145
loss_pred:0.022086795419454575, decouple_loss:0.007932559587061405
Iteration: 1867, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4481185972690582
loss_pred:0.02236831746995449, decouple_loss:0.007923660799860954
The generated pressure mean: 0.44984617829322815
loss_pred:0.021873945370316505, decouple_loss:0.007741335779428482
The generated pressure mean: 0.44788235425949097
loss_pred:0.022596869617700577, decouple_loss:0.007708663586527109
Iteration: 1868, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44853904843330383
loss_pred:0.02162862755358219, decouple_loss:0.008759363554418087
The generated pressure mean: 0.4484681785106659
loss_pred:0.0211349930614233, decouple_loss:0.00859973207116127
The generated pressure mean: 0.4475306272506714
loss_pred:0.021918682381510735, decouple_loss:0.008466205559670925
Iteration: 1869, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4492904543876648
loss_pred:0.02227700687944889, decouple_loss:0.008207556791603565
The generated pressure mean: 0.4478338658809662
loss_pred:0.02176949754357338, decouple_loss:0.008404791355133057
The generated pressure mean: 0.44762134552001953
loss_pred:0.022819798439741135, decouple_loss:0.00838795118033886
Iteration: 1870, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4480818510055542
loss_pred:0.02193954773247242, decouple_loss:0.008036484941840172
The generated pressure mean: 0.44753146171569824
loss_pred:0.02171272039413452, decouple_loss:0.007702987641096115
The generated pressure mean: 0.44853323698043823
loss_pred:0.020788706839084625, decouple_loss:0.0077614253386855125
2023-04-16 08:15:18 testing...
The generated pressure mean: 0.4495830833911896
The generated pressure mean: 0.449788898229599
The generated pressure mean: 0.44987666606903076
loss_pred:0.030382545664906502, decouple_loss:0.008155535906553268
loss_pred:0.03125075623393059, decouple_loss:0.008144423365592957
loss_pred:0.02994510903954506, decouple_loss:0.008269818499684334
Loss: 0.030935633927583694, avg_mse: 0.04089892655611038
current test mse: 0.040899
Iteration: 1871, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44782161712646484
The generated pressure mean: 0.4492121636867523loss_pred:0.021741805598139763, decouple_loss:0.008181373588740826
loss_pred:0.02191970869898796, decouple_loss:0.008163140155375004
The generated pressure mean: 0.4483950734138489
loss_pred:0.021281501278281212, decouple_loss:0.008044394664466381
Iteration: 1872, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4483802318572998
loss_pred:0.022018976509571075, decouple_loss:0.008214726112782955
The generated pressure mean: 0.4493180513381958
loss_pred:0.023778393864631653, decouple_loss:0.007976911030709743
The generated pressure mean: 0.4494127631187439
loss_pred:0.021928416565060616, decouple_loss:0.007883032783865929
Iteration: 1873, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4489333927631378
loss_pred:0.01997547037899494, decouple_loss:0.00896377395838499
The generated pressure mean: 0.44682610034942627
loss_pred:0.020770201459527016, decouple_loss:0.009038747288286686
The generated pressure mean: 0.4494490623474121
loss_pred:0.022755920886993408, decouple_loss:0.009130360558629036
Iteration: 1874, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4483799636363983
loss_pred:0.02206316404044628, decouple_loss:0.008304557763040066
The generated pressure mean: 0.44782891869544983
loss_pred:0.02108321338891983, decouple_loss:0.008546791970729828
The generated pressure mean: 0.4479621648788452
loss_pred:0.02273319661617279, decouple_loss:0.008544341661036015
Iteration: 1875, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44714075326919556
The generated pressure mean: 0.44836118817329407
loss_pred:0.02372255176305771, decouple_loss:0.008182656019926071
loss_pred:0.02174750529229641, decouple_loss:0.008407543413341045
The generated pressure mean: 0.4488367736339569
loss_pred:0.02157079055905342, decouple_loss:0.008256783708930016
Iteration: 1876, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44893890619277954
loss_pred:0.02209882251918316, decouple_loss:0.008601280860602856
The generated pressure mean: 0.44869518280029297
loss_pred:0.02278788946568966, decouple_loss:0.008511890657246113
The generated pressure mean: 0.44960033893585205
loss_pred:0.022668639197945595, decouple_loss:0.008462159894406796
Iteration: 1877, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4486500322818756
The generated pressure mean: 0.44864314794540405
loss_pred:0.021906038746237755, decouple_loss:0.008778701536357403
loss_pred:0.020437052473425865, decouple_loss:0.008660608902573586
The generated pressure mean: 0.44756239652633667
loss_pred:0.022523432970046997, decouple_loss:0.008965899236500263
Iteration: 1878, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44788190722465515
The generated pressure mean: 0.44822725653648376
loss_pred:0.021469203755259514, decouple_loss:0.00876555684953928
loss_pred:0.020935654640197754, decouple_loss:0.00880980584770441
The generated pressure mean: 0.44725847244262695
loss_pred:0.02204281836748123, decouple_loss:0.008767911233007908
Iteration: 1879, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4472748041152954
loss_pred:0.022330066189169884, decouple_loss:0.008488615974783897
The generated pressure mean: 0.4490025043487549
loss_pred:0.023456742987036705, decouple_loss:0.008373535238206387
The generated pressure mean: 0.4495009481906891
loss_pred:0.020884467288851738, decouple_loss:0.008373805321753025
Iteration: 1880, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4487559199333191
The generated pressure mean: 0.4476511776447296
loss_pred:0.020749803632497787, decouple_loss:0.008668450638651848
loss_pred:0.022918518632650375, decouple_loss:0.008611640892922878
The generated pressure mean: 0.4471893906593323
loss_pred:0.022609403356909752, decouple_loss:0.008267288096249104
2023-04-16 08:17:10 testing...
The generated pressure mean: 0.4495830833911896
The generated pressure mean: 0.4497888684272766
The generated pressure mean: 0.44987666606903076
loss_pred:0.029420601204037666, decouple_loss:0.008431682363152504
loss_pred:0.030489090830087662, decouple_loss:0.008490443229675293
loss_pred:0.028942765668034554, decouple_loss:0.008386682718992233
Loss: 0.03003929927945137, avg_mse: 0.03918683901429176
current test mse: 0.039187
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012018_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012018_3_24hr.npz
NaN value num: 0
Iteration: 1881, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4474197030067444
loss_pred:0.022622903808951378, decouple_loss:0.00837994460016489
The generated pressure mean: 0.448133647441864
loss_pred:0.021067623049020767, decouple_loss:0.008527601137757301
The generated pressure mean: 0.44798144698143005
loss_pred:0.022627100348472595, decouple_loss:0.008470626547932625
Iteration: 1882, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44778382778167725
The generated pressure mean: 0.4475034475326538
loss_pred:0.021070893853902817, decouple_loss:0.008192717097699642
loss_pred:0.024340830743312836, decouple_loss:0.008334887214004993
The generated pressure mean: 0.4478336572647095
loss_pred:0.02225326932966709, decouple_loss:0.008108426816761494
Iteration: 1883, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4481903612613678The generated pressure mean: 0.4480687975883484
loss_pred:0.021402833983302116, decouple_loss:0.008265096694231033
loss_pred:0.022526172921061516, decouple_loss:0.008297061547636986
The generated pressure mean: 0.44744613766670227
loss_pred:0.02216409519314766, decouple_loss:0.008162916637957096
Iteration: 1884, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44844841957092285
The generated pressure mean: 0.44771310687065125
loss_pred:0.022128749638795853, decouple_loss:0.00814192183315754
loss_pred:0.022408299148082733, decouple_loss:0.008305858820676804
The generated pressure mean: 0.44762691855430603
loss_pred:0.021522367373108864, decouple_loss:0.008500774390995502
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1885, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44753900170326233The generated pressure mean: 0.44880369305610657
loss_pred:0.021680016070604324, decouple_loss:0.007883381098508835
loss_pred:0.02344212494790554, decouple_loss:0.007921669632196426
The generated pressure mean: 0.44751855731010437
loss_pred:0.021612439304590225, decouple_loss:0.00776542816311121
Iteration: 1886, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4478529691696167
The generated pressure mean: 0.44749870896339417
loss_pred:0.020748311653733253, decouple_loss:0.007951648905873299
loss_pred:0.022074030712246895, decouple_loss:0.007630299776792526
The generated pressure mean: 0.44780269265174866
loss_pred:0.021788407117128372, decouple_loss:0.007663008291274309
Iteration: 1887, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4475157856941223
The generated pressure mean: 0.4483509063720703
loss_pred:0.022792965173721313, decouple_loss:0.00781426765024662
loss_pred:0.020202934741973877, decouple_loss:0.007926911115646362
The generated pressure mean: 0.44790440797805786
loss_pred:0.021273501217365265, decouple_loss:0.008019529283046722
Iteration: 1888, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4484274089336395
The generated pressure mean: 0.44822627305984497
loss_pred:0.020370306447148323, decouple_loss:0.008304078131914139
loss_pred:0.021760066971182823, decouple_loss:0.008253130130469799
The generated pressure mean: 0.4480019211769104
loss_pred:0.02208709344267845, decouple_loss:0.008197692222893238
Iteration: 1889, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4478616714477539
The generated pressure mean: 0.44878119230270386
loss_pred:0.022286321967840195, decouple_loss:0.007919743657112122
loss_pred:0.020251989364624023, decouple_loss:0.00812785979360342
The generated pressure mean: 0.44790560007095337
loss_pred:0.022242853417992592, decouple_loss:0.007880475372076035
Iteration: 1890, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4486851990222931
The generated pressure mean: 0.44841691851615906
loss_pred:0.022225286811590195, decouple_loss:0.007700898218899965
loss_pred:0.021906141191720963, decouple_loss:0.007590829860419035
The generated pressure mean: 0.4471258223056793
loss_pred:0.021359648555517197, decouple_loss:0.007738388143479824
2023-04-16 08:19:53 testing...
The generated pressure mean: 0.4495830535888672
The generated pressure mean: 0.449788898229599
The generated pressure mean: 0.44987666606903076
loss_pred:0.028504235669970512, decouple_loss:0.00734119676053524
loss_pred:0.029130231589078903, decouple_loss:0.007275143638253212
loss_pred:0.02823435328900814, decouple_loss:0.007235752418637276
Loss: 0.02898714318871498, avg_mse: 0.037319689989089966
current test mse: 0.03732
Iteration: 1891, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4481147229671478
loss_pred:0.022309349849820137, decouple_loss:0.007316043600440025
The generated pressure mean: 0.4483286142349243
loss_pred:0.021809373050928116, decouple_loss:0.007204877212643623
The generated pressure mean: 0.44788503646850586
loss_pred:0.022145504131913185, decouple_loss:0.0072629558853805065
Iteration: 1892, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.447795033454895
loss_pred:0.0220581516623497, decouple_loss:0.00806131400167942
The generated pressure mean: 0.4482947587966919
loss_pred:0.021962763741612434, decouple_loss:0.008054771460592747
The generated pressure mean: 0.44780224561691284
loss_pred:0.020904816687107086, decouple_loss:0.008266502059996128
Iteration: 1893, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.448762446641922
loss_pred:0.021572422236204147, decouple_loss:0.007998197339475155
The generated pressure mean: 0.44795525074005127
loss_pred:0.021526524797081947, decouple_loss:0.008083761669695377
The generated pressure mean: 0.44741690158843994
loss_pred:0.022296952083706856, decouple_loss:0.008069726638495922
Iteration: 1894, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4481160640716553
The generated pressure mean: 0.4476151466369629
loss_pred:0.022016292437911034, decouple_loss:0.007667295169085264
loss_pred:0.019898323342204094, decouple_loss:0.007786078844219446
The generated pressure mean: 0.44728925824165344
loss_pred:0.02090008370578289, decouple_loss:0.007715784013271332
Iteration: 1895, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44787734746932983
loss_pred:0.023976396769285202, decouple_loss:0.008495441637933254
The generated pressure mean: 0.44799932837486267
loss_pred:0.022562488913536072, decouple_loss:0.008552792482078075
The generated pressure mean: 0.44806358218193054
loss_pred:0.021097294986248016, decouple_loss:0.008791721425950527
Iteration: 1896, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44811344146728516
loss_pred:0.022137489169836044, decouple_loss:0.008639783598482609
The generated pressure mean: 0.4477713406085968
loss_pred:0.022301670163869858, decouple_loss:0.00892238412052393
The generated pressure mean: 0.4485604763031006
loss_pred:0.0207630917429924, decouple_loss:0.008820975199341774
Iteration: 1897, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44799745082855225
loss_pred:0.021439796313643456, decouple_loss:0.008388600312173367
The generated pressure mean: 0.44811734557151794
loss_pred:0.02306295931339264, decouple_loss:0.0085991146042943
The generated pressure mean: 0.4477217197418213
loss_pred:0.020740129053592682, decouple_loss:0.008576065301895142
Iteration: 1898, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44806525111198425
loss_pred:0.021671511232852936, decouple_loss:0.008389269933104515
The generated pressure mean: 0.44791802763938904
loss_pred:0.020142557099461555, decouple_loss:0.008535463362932205
The generated pressure mean: 0.4491630792617798
loss_pred:0.021106692031025887, decouple_loss:0.0085139786824584
Iteration: 1899, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44773542881011963
loss_pred:0.020372970029711723, decouple_loss:0.008431813679635525
The generated pressure mean: 0.4472784698009491
loss_pred:0.020300252363085747, decouple_loss:0.00841885432600975
The generated pressure mean: 0.44754910469055176
loss_pred:0.021631432697176933, decouple_loss:0.008417057804763317
Iteration: 1900, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44794991612434387
loss_pred:0.021438322961330414, decouple_loss:0.007125312928110361
The generated pressure mean: 0.44719934463500977
loss_pred:0.021258020773530006, decouple_loss:0.006882600951939821
The generated pressure mean: 0.44771623611450195
loss_pred:0.020416999235749245, decouple_loss:0.006983940489590168
2023-04-16 08:21:46 testing...
The generated pressure mean: 0.4495830535888672
The generated pressure mean: 0.4497888684272766
The generated pressure mean: 0.44987666606903076
loss_pred:0.028598323464393616, decouple_loss:0.00678453641012311
loss_pred:0.029587693512439728, decouple_loss:0.006696041207760572
loss_pred:0.02842407487332821, decouple_loss:0.006831360515207052
Loss: 0.029208563268184662, avg_mse: 0.03793865069746971
current test mse: 0.037939
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012000_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012000_3_24hr.npz
NaN value num: 0
Iteration: 1901, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44827795028686523
loss_pred:0.022098185494542122, decouple_loss:0.006661809515208006
The generated pressure mean: 0.4458523094654083
loss_pred:0.02009088173508644, decouple_loss:0.00673416443169117
The generated pressure mean: 0.4478625953197479
loss_pred:0.022799963131546974, decouple_loss:0.006885491777211428
Iteration: 1902, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4468054175376892
The generated pressure mean: 0.44630926847457886
loss_pred:0.020449720323085785, decouple_loss:0.007277246098965406
loss_pred:0.020036596804857254, decouple_loss:0.007311554625630379
The generated pressure mean: 0.4475764036178589
loss_pred:0.02027125097811222, decouple_loss:0.007421077229082584
Iteration: 1903, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.446135550737381
loss_pred:0.019350770860910416, decouple_loss:0.007256035227328539
The generated pressure mean: 0.4471036195755005
loss_pred:0.02219400927424431, decouple_loss:0.007357340771704912
The generated pressure mean: 0.4470362365245819
loss_pred:0.023220552131533623, decouple_loss:0.00711095193400979
Iteration: 1904, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44738295674324036
loss_pred:0.022573355585336685, decouple_loss:0.007382505107671022
The generated pressure mean: 0.4472388029098511
loss_pred:0.02155054546892643, decouple_loss:0.007183604408055544
The generated pressure mean: 0.447671502828598
loss_pred:0.02021307870745659, decouple_loss:0.007176958490163088
Iteration: 1905, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44737598299980164
loss_pred:0.02030554786324501, decouple_loss:0.007308001164346933
The generated pressure mean: 0.4466509521007538
loss_pred:0.022451231256127357, decouple_loss:0.007221160922199488
The generated pressure mean: 0.44714266061782837
loss_pred:0.022053774446249008, decouple_loss:0.007307719439268112
Iteration: 1906, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4466387629508972
loss_pred:0.02059408277273178, decouple_loss:0.007493685465306044
The generated pressure mean: 0.44786643981933594
loss_pred:0.022820178419351578, decouple_loss:0.007324562408030033
The generated pressure mean: 0.4461483955383301
loss_pred:0.021002093330025673, decouple_loss:0.007351944223046303
Iteration: 1907, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4465046525001526
loss_pred:0.020278537645936012, decouple_loss:0.00805844459682703
The generated pressure mean: 0.4473675787448883
loss_pred:0.020638462156057358, decouple_loss:0.008188426494598389
The generated pressure mean: 0.4465515911579132
loss_pred:0.021101726219058037, decouple_loss:0.008044089190661907
Iteration: 1908, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4474863111972809
loss_pred:0.020156677812337875, decouple_loss:0.008454056456685066
The generated pressure mean: 0.44729194045066833
loss_pred:0.02043030597269535, decouple_loss:0.008597228676080704
The generated pressure mean: 0.44661250710487366
loss_pred:0.02050139009952545, decouple_loss:0.008201898075640202
Iteration: 1909, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44701990485191345
loss_pred:0.022465398535132408, decouple_loss:0.007695164997130632
The generated pressure mean: 0.44827088713645935
loss_pred:0.021753987297415733, decouple_loss:0.007853565737605095
The generated pressure mean: 0.4454604387283325
loss_pred:0.01983140967786312, decouple_loss:0.007717770058661699
Iteration: 1910, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44768601655960083
loss_pred:0.021181350573897362, decouple_loss:0.0076415566727519035
The generated pressure mean: 0.4468916654586792
loss_pred:0.021563099697232246, decouple_loss:0.007577400654554367
The generated pressure mean: 0.4467405080795288
loss_pred:0.021746454760432243, decouple_loss:0.0074584088288247585
2023-04-16 08:24:14 testing...
The generated pressure mean: 0.4497888684272766
The generated pressure mean: 0.4495830535888672
The generated pressure mean: 0.44987666606903076
loss_pred:0.029901839792728424, decouple_loss:0.008081547915935516
loss_pred:0.028727266937494278, decouple_loss:0.007929819636046886
loss_pred:0.028389986604452133, decouple_loss:0.007962684147059917
Loss: 0.029405932873487473, avg_mse: 0.03823179751634598
current test mse: 0.038232
Iteration: 1911, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.446512371301651
loss_pred:0.021580437198281288, decouple_loss:0.007888869382441044
The generated pressure mean: 0.4469175338745117
loss_pred:0.020943941548466682, decouple_loss:0.008041667751967907
The generated pressure mean: 0.44633227586746216
loss_pred:0.020885039120912552, decouple_loss:0.007933503948152065
Iteration: 1912, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44717806577682495
loss_pred:0.023352961987257004, decouple_loss:0.008930501528084278
The generated pressure mean: 0.4455258548259735
loss_pred:0.02118130959570408, decouple_loss:0.008877496235072613
The generated pressure mean: 0.44692403078079224
loss_pred:0.021617839112877846, decouple_loss:0.008825898170471191
Iteration: 1913, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44839704036712646
loss_pred:0.02146887592971325, decouple_loss:0.008210546337068081
The generated pressure mean: 0.44876816868782043
loss_pred:0.02027955651283264, decouple_loss:0.008183755911886692
The generated pressure mean: 0.44670215249061584
loss_pred:0.02009493298828602, decouple_loss:0.008224904537200928
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1914, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44644027948379517
loss_pred:0.022469446063041687, decouple_loss:0.008865177631378174
The generated pressure mean: 0.44735249876976013
loss_pred:0.020908815786242485, decouple_loss:0.008854709565639496
The generated pressure mean: 0.4475334584712982
loss_pred:0.02031726762652397, decouple_loss:0.008870954625308514
Iteration: 1915, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4473969638347626
loss_pred:0.021139446645975113, decouple_loss:0.0075617278926074505
The generated pressure mean: 0.44815972447395325
loss_pred:0.021817341446876526, decouple_loss:0.007694595493376255
The generated pressure mean: 0.4476753771305084
loss_pred:0.020400837063789368, decouple_loss:0.007718519773334265
Iteration: 1916, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4470297396183014
loss_pred:0.020312486216425896, decouple_loss:0.00719929626211524
The generated pressure mean: 0.44916796684265137
loss_pred:0.0205145962536335, decouple_loss:0.007199193816632032
The generated pressure mean: 0.44844359159469604
loss_pred:0.022757476195693016, decouple_loss:0.007165204733610153
Iteration: 1917, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44781818985939026
loss_pred:0.020019078627228737, decouple_loss:0.007045876234769821
The generated pressure mean: 0.44641056656837463
loss_pred:0.020180311053991318, decouple_loss:0.006837689783424139
The generated pressure mean: 0.4480457603931427
loss_pred:0.02353108860552311, decouple_loss:0.007088499143719673
Iteration: 1918, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44697317481040955
loss_pred:0.020904656499624252, decouple_loss:0.007482906337827444
The generated pressure mean: 0.44707977771759033
loss_pred:0.021124929189682007, decouple_loss:0.0075550624169409275
The generated pressure mean: 0.4487743079662323
loss_pred:0.021858086809515953, decouple_loss:0.007463285233825445
Iteration: 1919, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44925034046173096
loss_pred:0.02046831324696541, decouple_loss:0.00869186595082283
The generated pressure mean: 0.4465504586696625
loss_pred:0.021249962970614433, decouple_loss:0.008620277047157288
The generated pressure mean: 0.44797658920288086
loss_pred:0.02097100205719471, decouple_loss:0.008523594588041306
Iteration: 1920, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4469894468784332
loss_pred:0.01992536336183548, decouple_loss:0.007546584587544203
The generated pressure mean: 0.4455268085002899
loss_pred:0.020806536078453064, decouple_loss:0.007704819552600384
The generated pressure mean: 0.44645535945892334
loss_pred:0.02007419615983963, decouple_loss:0.007706101052463055
2023-04-16 08:26:06 testing...
The generated pressure mean: 0.4495830833911896
The generated pressure mean: 0.4497888684272766
The generated pressure mean: 0.44987666606903076
loss_pred:0.028927423059940338, decouple_loss:0.007808241061866283
loss_pred:0.029659420251846313, decouple_loss:0.007906037382781506
loss_pred:0.028554312884807587, decouple_loss:0.007877429015934467
Loss: 0.029440246522426605, avg_mse: 0.03835514187812805
current test mse: 0.038355
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012006_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012006_3_24hr.npz
NaN value num: 0
Iteration: 1921, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4471559226512909
loss_pred:0.02113446779549122, decouple_loss:0.008051947690546513
The generated pressure mean: 0.44868409633636475
loss_pred:0.020568856969475746, decouple_loss:0.007917155511677265
The generated pressure mean: 0.4485749304294586
loss_pred:0.021148283034563065, decouple_loss:0.008022241294384003
Iteration: 1922, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4484126567840576
The generated pressure mean: 0.44917911291122437
loss_pred:0.020607970654964447, decouple_loss:0.008556456305086613
loss_pred:0.020619995892047882, decouple_loss:0.008536684326827526
The generated pressure mean: 0.4499695599079132
loss_pred:0.021361082792282104, decouple_loss:0.008663882501423359
Iteration: 1923, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4478321671485901
loss_pred:0.021351240575313568, decouple_loss:0.007417868357151747
The generated pressure mean: 0.4491707384586334
loss_pred:0.022551916539669037, decouple_loss:0.007930941879749298
The generated pressure mean: 0.44792136549949646
loss_pred:0.02101948857307434, decouple_loss:0.007833238691091537
Iteration: 1924, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44895660877227783
The generated pressure mean: 0.4494444727897644
loss_pred:0.021019073203206062, decouple_loss:0.010057666338980198
loss_pred:0.02049536444246769, decouple_loss:0.009707244113087654
The generated pressure mean: 0.44808343052864075
loss_pred:0.021144578233361244, decouple_loss:0.009828551672399044
Iteration: 1925, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.447337806224823The generated pressure mean: 0.44852012395858765
loss_pred:0.022282110527157784, decouple_loss:0.009360791184008121loss_pred:0.020888198167085648, decouple_loss:0.00931159034371376
The generated pressure mean: 0.44881996512413025
loss_pred:0.02165236324071884, decouple_loss:0.009074265137314796
Iteration: 1926, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4485883116722107
The generated pressure mean: 0.449227511882782
loss_pred:0.02200423553586006, decouple_loss:0.007688174489885569
loss_pred:0.021214129403233528, decouple_loss:0.007525413762778044
The generated pressure mean: 0.4484231173992157
loss_pred:0.02145986258983612, decouple_loss:0.007434331811964512
Iteration: 1927, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4478451907634735
The generated pressure mean: 0.4474776089191437
loss_pred:0.02179540880024433, decouple_loss:0.008329784497618675
loss_pred:0.02156890742480755, decouple_loss:0.008230868726968765
The generated pressure mean: 0.4477083086967468
loss_pred:0.02103746123611927, decouple_loss:0.008155305869877338
Iteration: 1928, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4476096034049988
The generated pressure mean: 0.4481826722621918
loss_pred:0.021090693771839142, decouple_loss:0.008985761553049088
loss_pred:0.020936641842126846, decouple_loss:0.009084140881896019
The generated pressure mean: 0.44786936044692993
loss_pred:0.022265173494815826, decouple_loss:0.008897640742361546
Iteration: 1929, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4488219618797302The generated pressure mean: 0.4474453926086426
loss_pred:0.021326936781406403, decouple_loss:0.008500726893544197
loss_pred:0.02332567237317562, decouple_loss:0.008576378226280212
The generated pressure mean: 0.44835829734802246
loss_pred:0.021464070305228233, decouple_loss:0.008318934589624405
Iteration: 1930, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4488055109977722
The generated pressure mean: 0.4501950442790985
loss_pred:0.021580247208476067, decouple_loss:0.008005858398973942
loss_pred:0.020831914618611336, decouple_loss:0.008128400892019272
The generated pressure mean: 0.44897910952568054
loss_pred:0.020622532814741135, decouple_loss:0.008010143414139748
2023-04-16 08:28:31 testing...
The generated pressure mean: 0.4495830833911896
The generated pressure mean: 0.4497888684272766
The generated pressure mean: 0.44987666606903076
loss_pred:0.02990739978849888, decouple_loss:0.00731496000662446
loss_pred:0.030482178553938866, decouple_loss:0.007357786875218153
loss_pred:0.02969244122505188, decouple_loss:0.0073354411870241165
Loss: 0.030394142493605614, avg_mse: 0.040127698332071304
current test mse: 0.040128
Iteration: 1931, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44782352447509766
loss_pred:0.021558571606874466, decouple_loss:0.0073034330271184444
The generated pressure mean: 0.4476167857646942
loss_pred:0.02074057050049305, decouple_loss:0.007193614728748798
The generated pressure mean: 0.44793662428855896
loss_pred:0.020600037649273872, decouple_loss:0.007324238773435354
Iteration: 1932, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44945159554481506
The generated pressure mean: 0.4491414427757263
loss_pred:0.021321529522538185, decouple_loss:0.008189489133656025
loss_pred:0.021442636847496033, decouple_loss:0.008202901110053062
The generated pressure mean: 0.44923079013824463
loss_pred:0.020348036661744118, decouple_loss:0.008105691522359848
Iteration: 1933, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.448650598526001
The generated pressure mean: 0.4489496946334839
loss_pred:0.020628686994314194, decouple_loss:0.007908579893410206
loss_pred:0.021446188911795616, decouple_loss:0.008012400008738041
The generated pressure mean: 0.4487152397632599
loss_pred:0.0218602754175663, decouple_loss:0.007914233952760696
Iteration: 1934, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4487764537334442
loss_pred:0.021834805607795715, decouple_loss:0.007299608085304499
The generated pressure mean: 0.4480856657028198
loss_pred:0.021328361704945564, decouple_loss:0.007689121179282665
The generated pressure mean: 0.44858601689338684
loss_pred:0.021295346319675446, decouple_loss:0.007765845861285925
Iteration: 1935, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4481617510318756
loss_pred:0.02164093591272831, decouple_loss:0.007547321263700724
The generated pressure mean: 0.44971179962158203
The generated pressure mean: 0.4487597942352295
loss_pred:0.022066188976168633, decouple_loss:0.0076094805262982845
loss_pred:0.022649304941296577, decouple_loss:0.00752865569666028
Iteration: 1936, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4480079710483551
loss_pred:0.02119121327996254, decouple_loss:0.00727877439931035
The generated pressure mean: 0.4483506977558136
loss_pred:0.02239271067082882, decouple_loss:0.007472251076251268
The generated pressure mean: 0.44849705696105957
loss_pred:0.02125716581940651, decouple_loss:0.007510437164455652
Iteration: 1937, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44840681552886963
loss_pred:0.021869424730539322, decouple_loss:0.008403650484979153
The generated pressure mean: 0.4479454457759857
loss_pred:0.02088003419339657, decouple_loss:0.008344734087586403
The generated pressure mean: 0.4481750428676605
loss_pred:0.020645836368203163, decouple_loss:0.00829510111361742
Iteration: 1938, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4485422968864441
loss_pred:0.021593203768134117, decouple_loss:0.00781924556940794
The generated pressure mean: 0.4497270882129669
loss_pred:0.02271547168493271, decouple_loss:0.00782567448914051
The generated pressure mean: 0.44944050908088684
loss_pred:0.021941516548395157, decouple_loss:0.007912352681159973
Iteration: 1939, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4484025537967682
loss_pred:0.023884888738393784, decouple_loss:0.0073912497609853745
The generated pressure mean: 0.4486697316169739
loss_pred:0.02117011696100235, decouple_loss:0.00749964639544487
The generated pressure mean: 0.4479890763759613
loss_pred:0.02068888023495674, decouple_loss:0.007304169703274965
Iteration: 1940, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44884926080703735
loss_pred:0.02217642217874527, decouple_loss:0.0072967419400811195
The generated pressure mean: 0.44877612590789795
loss_pred:0.02087305299937725, decouple_loss:0.00698348181322217
The generated pressure mean: 0.4476868510246277
loss_pred:0.02050704136490822, decouple_loss:0.007214074023067951
2023-04-16 08:30:23 testing...
The generated pressure mean: 0.449788898229599
The generated pressure mean: 0.4495830535888672
The generated pressure mean: 0.44987666606903076
loss_pred:0.031094511970877647, decouple_loss:0.008146591484546661
loss_pred:0.029896803200244904, decouple_loss:0.008012342266738415
loss_pred:0.029771093279123306, decouple_loss:0.007934602908790112
Loss: 0.030655695125460625, avg_mse: 0.04074275493621826
current test mse: 0.040743
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012020_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012020_3_24hr.npz
NaN value num: 0
Iteration: 1941, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.450380802154541
loss_pred:0.021762123331427574, decouple_loss:0.008155792951583862
The generated pressure mean: 0.4499345123767853
loss_pred:0.022487951442599297, decouple_loss:0.008166826330125332
The generated pressure mean: 0.4487125277519226
loss_pred:0.02152712456882, decouple_loss:0.008104616776108742
Iteration: 1942, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4493504762649536The generated pressure mean: 0.4497753381729126
loss_pred:0.021760160103440285, decouple_loss:0.008504096418619156
loss_pred:0.021850507706403732, decouple_loss:0.008685596287250519
The generated pressure mean: 0.4504680633544922
loss_pred:0.023302871733903885, decouple_loss:0.008413909003138542
Iteration: 1943, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45068731904029846
loss_pred:0.02350730448961258, decouple_loss:0.007070078048855066
The generated pressure mean: 0.4487113654613495
loss_pred:0.0215207077562809, decouple_loss:0.007064516190439463
The generated pressure mean: 0.44990211725234985
loss_pred:0.023526204749941826, decouple_loss:0.0071509587578475475
Iteration: 1944, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.449324369430542
loss_pred:0.023585235700011253, decouple_loss:0.00801596138626337
The generated pressure mean: 0.4492187201976776
loss_pred:0.022777922451496124, decouple_loss:0.007925329729914665
The generated pressure mean: 0.4493340849876404
loss_pred:0.02196795493364334, decouple_loss:0.008094005286693573
Iteration: 1945, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44925618171691895
loss_pred:0.021691953763365746, decouple_loss:0.007861698977649212
The generated pressure mean: 0.44969967007637024
loss_pred:0.02136410027742386, decouple_loss:0.007819640450179577
The generated pressure mean: 0.4496612548828125
loss_pred:0.023300455883145332, decouple_loss:0.00780987273901701
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1946, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4507904052734375
loss_pred:0.021936072036623955, decouple_loss:0.007986661046743393
The generated pressure mean: 0.4493504762649536
loss_pred:0.022461308166384697, decouple_loss:0.00796277355402708
The generated pressure mean: 0.4502818286418915
loss_pred:0.023000195622444153, decouple_loss:0.007952441461384296
Iteration: 1947, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4496549367904663
loss_pred:0.021961329504847527, decouple_loss:0.00931561179459095
The generated pressure mean: 0.4491356611251831
loss_pred:0.022647710517048836, decouple_loss:0.00931648537516594
The generated pressure mean: 0.44940629601478577
loss_pred:0.02089407481253147, decouple_loss:0.009226653724908829
Iteration: 1948, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.449557900428772
loss_pred:0.021769246086478233, decouple_loss:0.007157632615417242
The generated pressure mean: 0.4498020112514496
loss_pred:0.021895935758948326, decouple_loss:0.007224449887871742
The generated pressure mean: 0.4507772922515869
loss_pred:0.02145170047879219, decouple_loss:0.007171190343797207
Iteration: 1949, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44896915555000305
loss_pred:0.02187488041818142, decouple_loss:0.0090591786429286
The generated pressure mean: 0.45019662380218506
loss_pred:0.021845631301403046, decouple_loss:0.009327946230769157
The generated pressure mean: 0.4481290280818939
loss_pred:0.02216053195297718, decouple_loss:0.009077122434973717
Iteration: 1950, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4498622715473175
loss_pred:0.022457685321569443, decouple_loss:0.007597490679472685
The generated pressure mean: 0.44904807209968567
loss_pred:0.021319326013326645, decouple_loss:0.007708374876528978
The generated pressure mean: 0.4505953788757324
loss_pred:0.022677667438983917, decouple_loss:0.008149011991918087
2023-04-16 08:33:00 testing...
The generated pressure mean: 0.4497888684272766
The generated pressure mean: 0.4495830833911896
The generated pressure mean: 0.44987666606903076
loss_pred:0.029353193938732147, decouple_loss:0.00835442915558815
loss_pred:0.02842409536242485, decouple_loss:0.008203798905014992
loss_pred:0.0280609093606472, decouple_loss:0.008299645036458969
Loss: 0.029027029871940613, avg_mse: 0.03752543777227402
current test mse: 0.037525
Iteration: 1951, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4502379894256592
The generated pressure mean: 0.450135201215744
loss_pred:0.021153803914785385, decouple_loss:0.00810610968619585
loss_pred:0.02232794463634491, decouple_loss:0.008307664655148983
The generated pressure mean: 0.4494032561779022
loss_pred:0.02110925130546093, decouple_loss:0.008229772560298443
Iteration: 1952, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44988805055618286
loss_pred:0.021493444219231606, decouple_loss:0.008362747728824615
The generated pressure mean: 0.4486853778362274
loss_pred:0.021438052877783775, decouple_loss:0.008378715254366398
The generated pressure mean: 0.4497264325618744
loss_pred:0.021351048722863197, decouple_loss:0.008331570774316788
Iteration: 1953, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45008423924446106
loss_pred:0.02290281280875206, decouple_loss:0.007852453738451004
The generated pressure mean: 0.44947323203086853
loss_pred:0.025665797293186188, decouple_loss:0.007863129489123821
The generated pressure mean: 0.44966641068458557
loss_pred:0.02214612439274788, decouple_loss:0.007929950952529907
Iteration: 1954, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4503428041934967
The generated pressure mean: 0.4491085708141327
loss_pred:0.02203202061355114, decouple_loss:0.007908535189926624
loss_pred:0.021787820383906364, decouple_loss:0.00790760200470686
The generated pressure mean: 0.4489012062549591
loss_pred:0.02201513759791851, decouple_loss:0.007821928709745407
Iteration: 1955, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4493539035320282
The generated pressure mean: 0.4501695930957794
loss_pred:0.021644046530127525, decouple_loss:0.008839011192321777
loss_pred:0.02223443053662777, decouple_loss:0.009002411738038063
The generated pressure mean: 0.4506218135356903
loss_pred:0.02112525701522827, decouple_loss:0.008932584896683693
Iteration: 1956, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45025718212127686
The generated pressure mean: 0.449248343706131
loss_pred:0.023135926574468613, decouple_loss:0.0072113689966499805
loss_pred:0.021947139874100685, decouple_loss:0.007115840911865234
The generated pressure mean: 0.44872456789016724
loss_pred:0.021297713741660118, decouple_loss:0.007043140009045601
Iteration: 1957, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45044729113578796
The generated pressure mean: 0.4507172703742981
loss_pred:0.02241542562842369, decouple_loss:0.009218119084835052
loss_pred:0.022056356072425842, decouple_loss:0.009342938661575317
The generated pressure mean: 0.45014554262161255
loss_pred:0.022061467170715332, decouple_loss:0.009174124337732792
Iteration: 1958, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44821521639823914
The generated pressure mean: 0.4501035213470459
loss_pred:0.021810708567500114, decouple_loss:0.008605308830738068
loss_pred:0.021775228902697563, decouple_loss:0.008754408918321133
The generated pressure mean: 0.4501517117023468
loss_pred:0.021832801401615143, decouple_loss:0.008626538328826427
Iteration: 1959, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44958534836769104
loss_pred:0.02138402685523033, decouple_loss:0.008103650994598866
The generated pressure mean: 0.4494397044181824
loss_pred:0.021738776937127113, decouple_loss:0.008101612329483032
The generated pressure mean: 0.4505215585231781
loss_pred:0.02319955639541149, decouple_loss:0.00800043810158968
Iteration: 1960, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45010724663734436
The generated pressure mean: 0.4512348175048828
loss_pred:0.021928317844867706, decouple_loss:0.007666309364140034
loss_pred:0.0218193382024765, decouple_loss:0.0079552186653018
The generated pressure mean: 0.44861218333244324
loss_pred:0.021180398762226105, decouple_loss:0.007751097436994314
2023-04-16 08:34:54 testing...
The generated pressure mean: 0.4497888684272766
The generated pressure mean: 0.4495830535888672
The generated pressure mean: 0.44987666606903076
loss_pred:0.02974705584347248, decouple_loss:0.00756108621135354
loss_pred:0.028753899037837982, decouple_loss:0.007587894331663847
loss_pred:0.02866171859204769, decouple_loss:0.0076946234330534935
Loss: 0.029434949159622192, avg_mse: 0.03850282356142998
current test mse: 0.038503
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012013_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012013_3_24hr.npz
NaN value num: 0
Iteration: 1961, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44611862301826477
loss_pred:0.02154608443379402, decouple_loss:0.007742417976260185
The generated pressure mean: 0.44668835401535034
loss_pred:0.021669795736670494, decouple_loss:0.00747738778591156
The generated pressure mean: 0.44701576232910156
loss_pred:0.02220899984240532, decouple_loss:0.00771107105538249
Iteration: 1962, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4463469684123993
The generated pressure mean: 0.44626617431640625
loss_pred:0.02045823261141777, decouple_loss:0.008396605029702187
loss_pred:0.019829288125038147, decouple_loss:0.008502814918756485
The generated pressure mean: 0.44697147607803345
loss_pred:0.02266649156808853, decouple_loss:0.008656132966279984
Iteration: 1963, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.445743203163147
The generated pressure mean: 0.4472186267375946
loss_pred:0.021809661760926247, decouple_loss:0.007981479167938232
loss_pred:0.021314483135938644, decouple_loss:0.008144360966980457
The generated pressure mean: 0.446078360080719
loss_pred:0.021177174523472786, decouple_loss:0.008198308758437634
Iteration: 1964, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4470585584640503
The generated pressure mean: 0.4465397000312805
loss_pred:0.019488226622343063, decouple_loss:0.008718371391296387
loss_pred:0.021827340126037598, decouple_loss:0.008929373696446419
The generated pressure mean: 0.4474700093269348
loss_pred:0.019747596234083176, decouple_loss:0.008825796656310558
Iteration: 1965, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4463847279548645
The generated pressure mean: 0.4464870095252991
loss_pred:0.021113913506269455, decouple_loss:0.00743566919118166
loss_pred:0.020929573103785515, decouple_loss:0.007272754795849323
The generated pressure mean: 0.44704368710517883
loss_pred:0.02185736410319805, decouple_loss:0.007437851745635271
Iteration: 1966, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4458150565624237
The generated pressure mean: 0.44650182127952576
loss_pred:0.021315502002835274, decouple_loss:0.007828846573829651
loss_pred:0.022525807842612267, decouple_loss:0.007820989936590195
The generated pressure mean: 0.4474562704563141
loss_pred:0.02365015633404255, decouple_loss:0.00792184378951788
Iteration: 1967, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.447532594203949
The generated pressure mean: 0.44695645570755005
loss_pred:0.022127749398350716, decouple_loss:0.008417855016887188
loss_pred:0.02087753266096115, decouple_loss:0.008389107882976532
The generated pressure mean: 0.44710978865623474
loss_pred:0.023304488509893417, decouple_loss:0.00888361968100071
Iteration: 1968, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4475697875022888The generated pressure mean: 0.44771623611450195
loss_pred:0.02087104134261608, decouple_loss:0.007854263298213482
loss_pred:0.023204734548926353, decouple_loss:0.0078927306458354
The generated pressure mean: 0.4475097954273224
loss_pred:0.021946894004940987, decouple_loss:0.007860363461077213
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1969, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44630762934684753
The generated pressure mean: 0.44590476155281067
loss_pred:0.021514317020773888, decouple_loss:0.008208217099308968
loss_pred:0.02044457010924816, decouple_loss:0.008169155567884445
The generated pressure mean: 0.4467221796512604
loss_pred:0.022076332941651344, decouple_loss:0.008312917314469814
Iteration: 1970, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44661709666252136
The generated pressure mean: 0.4476061463356018
loss_pred:0.021838607266545296, decouple_loss:0.008366579189896584
loss_pred:0.02092696540057659, decouple_loss:0.008647099137306213
The generated pressure mean: 0.4466501772403717
loss_pred:0.02304110862314701, decouple_loss:0.008330855518579483
2023-04-16 08:37:25 testing...
The generated pressure mean: 0.4497888684272766
The generated pressure mean: 0.4495830535888672
The generated pressure mean: 0.44987666606903076
loss_pred:0.02957601472735405, decouple_loss:0.007726920302957296
loss_pred:0.028525512665510178, decouple_loss:0.007644592318683863
loss_pred:0.028206078335642815, decouple_loss:0.007628436665982008
Loss: 0.029152533039450645, avg_mse: 0.03787641599774361
current test mse: 0.037876
Iteration: 1971, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4455908238887787
The generated pressure mean: 0.44724833965301514
loss_pred:0.022137893363833427, decouple_loss:0.0075249746441841125
loss_pred:0.020519044250249863, decouple_loss:0.00766733568161726
The generated pressure mean: 0.4465286433696747
loss_pred:0.022514235228300095, decouple_loss:0.007678933907300234
Iteration: 1972, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4456627666950226
The generated pressure mean: 0.4475902318954468
loss_pred:0.020983269438147545, decouple_loss:0.0072233895771205425
loss_pred:0.021284397691488266, decouple_loss:0.007313729263842106
The generated pressure mean: 0.44654765725135803
loss_pred:0.021930333226919174, decouple_loss:0.007283816114068031
Iteration: 1973, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44773462414741516
The generated pressure mean: 0.44677552580833435
loss_pred:0.020871825516223907, decouple_loss:0.007710660807788372
loss_pred:0.021364297717809677, decouple_loss:0.007784637622535229
The generated pressure mean: 0.44708752632141113
loss_pred:0.019513128325343132, decouple_loss:0.007586670573800802
Iteration: 1974, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4462556838989258
The generated pressure mean: 0.44674399495124817
loss_pred:0.021359102800488472, decouple_loss:0.0069764163345098495
loss_pred:0.02093377523124218, decouple_loss:0.006991798989474773
The generated pressure mean: 0.4472411274909973
loss_pred:0.021229729056358337, decouple_loss:0.006922380067408085
Iteration: 1975, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4466029703617096
The generated pressure mean: 0.44725653529167175
loss_pred:0.021485183387994766, decouple_loss:0.007577755022794008
loss_pred:0.022274736315011978, decouple_loss:0.007267144974321127
The generated pressure mean: 0.44658491015434265
loss_pred:0.021084990352392197, decouple_loss:0.007139993365854025
Iteration: 1976, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44697436690330505
The generated pressure mean: 0.4465055763721466
loss_pred:0.020750222727656364, decouple_loss:0.00762261962518096
loss_pred:0.022486597299575806, decouple_loss:0.00761632202193141
The generated pressure mean: 0.4473629593849182
loss_pred:0.023396460339426994, decouple_loss:0.007621403317898512
Iteration: 1977, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4459882080554962The generated pressure mean: 0.4476163387298584
loss_pred:0.0207884032279253, decouple_loss:0.007784815970808268
loss_pred:0.02238628827035427, decouple_loss:0.007921488955616951
The generated pressure mean: 0.44624581933021545
loss_pred:0.021607574075460434, decouple_loss:0.007788728456944227
Iteration: 1978, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4467817544937134
The generated pressure mean: 0.4469921588897705
loss_pred:0.021349087357521057, decouple_loss:0.007505779154598713
loss_pred:0.021117733791470528, decouple_loss:0.0073424396105110645
The generated pressure mean: 0.44697561860084534
loss_pred:0.021893838420510292, decouple_loss:0.007517063058912754
Iteration: 1979, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4465186297893524
The generated pressure mean: 0.44784975051879883
loss_pred:0.021839188411831856, decouple_loss:0.007397821173071861
loss_pred:0.021695783361792564, decouple_loss:0.007827695459127426
The generated pressure mean: 0.44795098900794983
loss_pred:0.02076413296163082, decouple_loss:0.007872779853641987
Iteration: 1980, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4474034011363983
The generated pressure mean: 0.44666650891304016
loss_pred:0.02168906107544899, decouple_loss:0.007628510240465403
loss_pred:0.02205542102456093, decouple_loss:0.007803776767104864
The generated pressure mean: 0.44622835516929626
loss_pred:0.02239990048110485, decouple_loss:0.007734974846243858
2023-04-16 08:39:19 testing...
The generated pressure mean: 0.4495830535888672
The generated pressure mean: 0.4497888684272766
The generated pressure mean: 0.44987666606903076
loss_pred:0.02866961993277073, decouple_loss:0.00805843248963356
loss_pred:0.029430991038680077, decouple_loss:0.00809223111718893
loss_pred:0.028416913002729416, decouple_loss:0.00812472403049469
Loss: 0.02924376353621483, avg_mse: 0.03815336897969246
current test mse: 0.038153
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012014_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012014_3_24hr.npz
NaN value num: 0
Iteration: 1981, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4466997981071472
loss_pred:0.02222525328397751, decouple_loss:0.008072253316640854
The generated pressure mean: 0.4473441243171692
loss_pred:0.02270588092505932, decouple_loss:0.008114449679851532
The generated pressure mean: 0.44829732179641724
loss_pred:0.02173432894051075, decouple_loss:0.008220984600484371
Iteration: 1982, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4480758309364319
The generated pressure mean: 0.44754457473754883
loss_pred:0.02250409871339798, decouple_loss:0.008068845607340336
loss_pred:0.0214704480022192, decouple_loss:0.007966002449393272
The generated pressure mean: 0.44780614972114563
loss_pred:0.021169191226363182, decouple_loss:0.008074019104242325
Iteration: 1983, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44758838415145874
The generated pressure mean: 0.4477446675300598
loss_pred:0.020304521545767784, decouple_loss:0.008358784951269627
loss_pred:0.02092576026916504, decouple_loss:0.008472079411149025
The generated pressure mean: 0.4478709101676941
loss_pred:0.023227212950587273, decouple_loss:0.00870796199887991
Iteration: 1984, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44737327098846436
The generated pressure mean: 0.44798049330711365
loss_pred:0.021480070427060127, decouple_loss:0.0075640506111085415
loss_pred:0.021304398775100708, decouple_loss:0.007306626997888088
The generated pressure mean: 0.4475277066230774
loss_pred:0.022832874208688736, decouple_loss:0.007345681078732014
Iteration: 1985, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44744864106178284
The generated pressure mean: 0.44612351059913635
loss_pred:0.021801143884658813, decouple_loss:0.00717891613021493
loss_pred:0.02138122171163559, decouple_loss:0.007240103557705879
The generated pressure mean: 0.44783875346183777
loss_pred:0.022725924849510193, decouple_loss:0.007147165015339851
Iteration: 1986, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4472610652446747
The generated pressure mean: 0.4461727440357208
loss_pred:0.021709950640797615, decouple_loss:0.0076883649453520775
loss_pred:0.02089439518749714, decouple_loss:0.007832185365259647
The generated pressure mean: 0.4473407566547394
loss_pred:0.021782130002975464, decouple_loss:0.007905993610620499
Iteration: 1987, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4477505385875702
The generated pressure mean: 0.4481663703918457loss_pred:0.023503802716732025, decouple_loss:0.007428391370922327
loss_pred:0.021420929580926895, decouple_loss:0.0074094925075769424
The generated pressure mean: 0.44775915145874023
loss_pred:0.02262122370302677, decouple_loss:0.007478565443307161
Iteration: 1988, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4488472044467926
loss_pred:0.021140621975064278, decouple_loss:0.007112248335033655
The generated pressure mean: 0.44831040501594543
loss_pred:0.021446483209729195, decouple_loss:0.0070450748316943645
The generated pressure mean: 0.44856178760528564
loss_pred:0.022326922044157982, decouple_loss:0.007185238413512707
Iteration: 1989, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4475630521774292
loss_pred:0.02165772020816803, decouple_loss:0.007465618662536144
The generated pressure mean: 0.44696977734565735
loss_pred:0.02066546119749546, decouple_loss:0.007442927919328213
The generated pressure mean: 0.4489087760448456
loss_pred:0.022091884166002274, decouple_loss:0.00763668492436409
Iteration: 1990, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44744864106178284
The generated pressure mean: 0.44771134853363037
loss_pred:0.022264886647462845, decouple_loss:0.00759495934471488
loss_pred:0.023547429591417313, decouple_loss:0.007500390987843275
The generated pressure mean: 0.4468141496181488
loss_pred:0.021437611430883408, decouple_loss:0.007402707822620869
2023-04-16 08:41:49 testing...
The generated pressure mean: 0.4497888684272766
The generated pressure mean: 0.4495830535888672
The generated pressure mean: 0.44987666606903076
loss_pred:0.03005688451230526, decouple_loss:0.006970557384192944
loss_pred:0.029123887419700623, decouple_loss:0.006926599889993668
loss_pred:0.028684498742222786, decouple_loss:0.0070493584498763084
Loss: 0.02963753044605255, avg_mse: 0.039066381752491
current test mse: 0.039066
Iteration: 1991, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4475401043891907
loss_pred:0.020106563344597816, decouple_loss:0.006851230747997761
The generated pressure mean: 0.447384238243103
loss_pred:0.020825175568461418, decouple_loss:0.007397877052426338
The generated pressure mean: 0.44873046875
loss_pred:0.02246621437370777, decouple_loss:0.007130325771868229
Iteration: 1992, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4476584792137146
loss_pred:0.02128099836409092, decouple_loss:0.00661024684086442
The generated pressure mean: 0.44833844900131226
loss_pred:0.02196344919502735, decouple_loss:0.0067520905286073685
The generated pressure mean: 0.44712862372398376
loss_pred:0.022459279745817184, decouple_loss:0.006614078767597675
Iteration: 1993, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4473603069782257
The generated pressure mean: 0.44722220301628113
loss_pred:0.021823978051543236, decouple_loss:0.0067144096828997135
loss_pred:0.021838726475834846, decouple_loss:0.0067750150337815285
The generated pressure mean: 0.4471328556537628
loss_pred:0.02069617062807083, decouple_loss:0.006575208622962236
Iteration: 1994, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44706377387046814
loss_pred:0.022268539294600487, decouple_loss:0.006904240231961012
The generated pressure mean: 0.4472653269767761
loss_pred:0.021087877452373505, decouple_loss:0.006852397229522467
The generated pressure mean: 0.44683802127838135
loss_pred:0.021883845329284668, decouple_loss:0.006781653966754675
Iteration: 1995, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.447736531496048
loss_pred:0.022793760523200035, decouple_loss:0.007311927154660225
The generated pressure mean: 0.4490087032318115
loss_pred:0.02167132869362831, decouple_loss:0.007241853978484869
The generated pressure mean: 0.4477596580982208
loss_pred:0.02182902581989765, decouple_loss:0.0074595301412045956
Iteration: 1996, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4478815495967865
The generated pressure mean: 0.44766926765441895
loss_pred:0.022083738818764687, decouple_loss:0.00846787542104721
loss_pred:0.021467147395014763, decouple_loss:0.008263043127954006
The generated pressure mean: 0.44742661714553833
loss_pred:0.021148566156625748, decouple_loss:0.008351168595254421
Iteration: 1997, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44658082723617554
loss_pred:0.02112460695207119, decouple_loss:0.0077485148794949055
The generated pressure mean: 0.44822150468826294
loss_pred:0.020754383876919746, decouple_loss:0.007585492450743914
The generated pressure mean: 0.4471362233161926
loss_pred:0.021119212731719017, decouple_loss:0.007641672156751156
Iteration: 1998, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44726720452308655
loss_pred:0.02076382376253605, decouple_loss:0.007289012428373098
The generated pressure mean: 0.4482654631137848
loss_pred:0.02223370410501957, decouple_loss:0.007251698523759842
The generated pressure mean: 0.44761139154434204
loss_pred:0.022504059597849846, decouple_loss:0.007354747503995895
Iteration: 1999, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4482874572277069
loss_pred:0.022145288065075874, decouple_loss:0.006917910184711218
The generated pressure mean: 0.44838187098503113
loss_pred:0.02231268398463726, decouple_loss:0.007138622924685478
The generated pressure mean: 0.44780266284942627
loss_pred:0.02108665183186531, decouple_loss:0.006851661950349808
Iteration: 2000, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44723832607269287
loss_pred:0.02088898792862892, decouple_loss:0.006993154063820839
The generated pressure mean: 0.4477286636829376
loss_pred:0.023431506007909775, decouple_loss:0.006876317318528891
The generated pressure mean: 0.44694724678993225
loss_pred:0.021918943151831627, decouple_loss:0.007186003495007753
2023-04-16 08:43:43 itr: 2000
training loss: [0.02227824 0.02123865 0.02377532]
save model to /work/09012/haoli1/ls6/ERA5_PredRNN/checkpoints/WV_0_PC_1_EH_0_PS_40/model_2000.ckpt
2023-04-16 08:43:49 testing...
The generated pressure mean: 0.4495830833911896
The generated pressure mean: 0.449788898229599
The generated pressure mean: 0.44987666606903076
loss_pred:0.02898937650024891, decouple_loss:0.006659427657723427
loss_pred:0.030023757368326187, decouple_loss:0.006781626492738724
loss_pred:0.028672892600297928, decouple_loss:0.0067982240580022335
Loss: 0.029565997421741486, avg_mse: 0.038942042738199234
current test mse: 0.038942
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012012_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012012_3_24hr.npz
NaN value num: 0
Iteration: 2001, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44719478487968445
loss_pred:0.02018551714718342, decouple_loss:0.007000408135354519
The generated pressure mean: 0.44652092456817627
loss_pred:0.020155591890215874, decouple_loss:0.0070231580175459385
The generated pressure mean: 0.446971595287323
loss_pred:0.02232769876718521, decouple_loss:0.006858309265226126
Iteration: 2002, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44708251953125
The generated pressure mean: 0.44670695066452026
loss_pred:0.020509831607341766, decouple_loss:0.006937399040907621
loss_pred:0.021405262872576714, decouple_loss:0.006860828027129173
The generated pressure mean: 0.4460639953613281
loss_pred:0.020575299859046936, decouple_loss:0.0069077215157449245
Iteration: 2003, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44771742820739746
loss_pred:0.022777065634727478, decouple_loss:0.006335898768156767
The generated pressure mean: 0.44676193594932556
loss_pred:0.02138342708349228, decouple_loss:0.006399011239409447
The generated pressure mean: 0.4461408257484436
loss_pred:0.020907510071992874, decouple_loss:0.006284702103585005
Iteration: 2004, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4478234350681305
The generated pressure mean: 0.4469561278820038
loss_pred:0.019987327978014946, decouple_loss:0.006926612462848425
loss_pred:0.021154815331101418, decouple_loss:0.006978713441640139
The generated pressure mean: 0.4460238218307495
loss_pred:0.020073579624295235, decouple_loss:0.006738716270774603
Iteration: 2005, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4465855360031128
The generated pressure mean: 0.44686564803123474
loss_pred:0.02139177918434143, decouple_loss:0.006661523133516312
loss_pred:0.02105545625090599, decouple_loss:0.007010537199676037
The generated pressure mean: 0.4484224021434784
loss_pred:0.022867433726787567, decouple_loss:0.006767080165445805
Iteration: 2006, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44802191853523254
The generated pressure mean: 0.4461709260940552
loss_pred:0.0207037515938282, decouple_loss:0.006920943036675453
loss_pred:0.02234618552029133, decouple_loss:0.006834926083683968
The generated pressure mean: 0.4470537006855011
loss_pred:0.021133216097950935, decouple_loss:0.006984331179410219
Iteration: 2007, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4468885660171509
loss_pred:0.021446187049150467, decouple_loss:0.0066651850938797
The generated pressure mean: 0.4462994337081909
loss_pred:0.02154430001974106, decouple_loss:0.006811212748289108
The generated pressure mean: 0.4480898678302765
loss_pred:0.021274590864777565, decouple_loss:0.006672208197414875
Iteration: 2008, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4476472735404968
loss_pred:0.02138596586883068, decouple_loss:0.007352167274802923
The generated pressure mean: 0.4471054971218109
loss_pred:0.022914724424481392, decouple_loss:0.007514380384236574
The generated pressure mean: 0.44654276967048645
loss_pred:0.02154259756207466, decouple_loss:0.007698331493884325
Iteration: 2009, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44653886556625366
The generated pressure mean: 0.4473514258861542
loss_pred:0.020469844341278076, decouple_loss:0.007891805842518806
loss_pred:0.022583194077014923, decouple_loss:0.00793716311454773
The generated pressure mean: 0.4460422098636627
loss_pred:0.020354604348540306, decouple_loss:0.00801666360348463
Iteration: 2010, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4469614624977112
loss_pred:0.02086048759520054, decouple_loss:0.007222013082355261
The generated pressure mean: 0.4472261667251587
loss_pred:0.020926665514707565, decouple_loss:0.007102044764906168
The generated pressure mean: 0.44758936762809753
loss_pred:0.02025666832923889, decouple_loss:0.007116322405636311
2023-04-16 08:46:15 testing...
The generated pressure mean: 0.4495830833911896
The generated pressure mean: 0.4497888684272766
The generated pressure mean: 0.44987666606903076
loss_pred:0.0289361160248518, decouple_loss:0.008028718642890453
loss_pred:0.02963446080684662, decouple_loss:0.007995294407010078
loss_pred:0.028557728976011276, decouple_loss:0.007989495061337948
Loss: 0.02944299392402172, avg_mse: 0.038654036819934845
current test mse: 0.038654
Iteration: 2011, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4473232924938202
loss_pred:0.021463830024003983, decouple_loss:0.007901876233518124
The generated pressure mean: 0.44709211587905884
loss_pred:0.020818207412958145, decouple_loss:0.00788028258830309
The generated pressure mean: 0.44882553815841675
loss_pred:0.021420646458864212, decouple_loss:0.00784934964030981
Iteration: 2012, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44670340418815613
loss_pred:0.021490968763828278, decouple_loss:0.0074160462245345116
The generated pressure mean: 0.44808536767959595
loss_pred:0.020817074924707413, decouple_loss:0.007450733799487352
The generated pressure mean: 0.4468630850315094
loss_pred:0.021373970434069633, decouple_loss:0.007261413149535656
Iteration: 2013, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4471133351325989
loss_pred:0.020838357508182526, decouple_loss:0.007078265771269798
The generated pressure mean: 0.4470162093639374
loss_pred:0.020607899874448776, decouple_loss:0.007082568481564522
The generated pressure mean: 0.44603610038757324
loss_pred:0.021669350564479828, decouple_loss:0.007073536515235901
Iteration: 2014, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44724732637405396
loss_pred:0.019943363964557648, decouple_loss:0.007355351001024246
The generated pressure mean: 0.44625115394592285
loss_pred:0.022193260490894318, decouple_loss:0.007295471150428057
The generated pressure mean: 0.4471782445907593
loss_pred:0.022606896236538887, decouple_loss:0.007332867011427879
Iteration: 2015, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4468706548213959
loss_pred:0.0203639417886734, decouple_loss:0.006613743957132101
The generated pressure mean: 0.44785258173942566
loss_pred:0.02124667353928089, decouple_loss:0.0066098798997700214
The generated pressure mean: 0.4478108584880829
loss_pred:0.020956438034772873, decouple_loss:0.006572208367288113
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 2016, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.446443647146225
loss_pred:0.020934252068400383, decouple_loss:0.00675051799044013
The generated pressure mean: 0.4468006491661072
loss_pred:0.02188592404127121, decouple_loss:0.006972811184823513
The generated pressure mean: 0.4471959173679352
loss_pred:0.021205054596066475, decouple_loss:0.007174193859100342
Iteration: 2017, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44733890891075134
loss_pred:0.021366648375988007, decouple_loss:0.0068898070603609085
The generated pressure mean: 0.4469093978404999
loss_pred:0.021847572177648544, decouple_loss:0.006764361169189215
The generated pressure mean: 0.4467621445655823
loss_pred:0.020946260541677475, decouple_loss:0.006812407169491053
Iteration: 2018, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4458526074886322
loss_pred:0.0211651511490345, decouple_loss:0.006698824465274811
The generated pressure mean: 0.4470779299736023
loss_pred:0.019532855600118637, decouple_loss:0.0069300164468586445
The generated pressure mean: 0.44798222184181213
loss_pred:0.02104225941002369, decouple_loss:0.006812544539570808
Iteration: 2019, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44683948159217834
loss_pred:0.02033558487892151, decouple_loss:0.007125917822122574
The generated pressure mean: 0.4473578929901123
loss_pred:0.02047618292272091, decouple_loss:0.006990422494709492
The generated pressure mean: 0.4469147026538849
loss_pred:0.020245546475052834, decouple_loss:0.0070069171488285065
Iteration: 2020, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4459841251373291
loss_pred:0.021616414189338684, decouple_loss:0.007248124107718468
The generated pressure mean: 0.447511225938797
loss_pred:0.020816078409552574, decouple_loss:0.007480018772184849
The generated pressure mean: 0.44609978795051575
loss_pred:0.021023418754339218, decouple_loss:0.007241643965244293
2023-04-16 08:48:09 testing...
The generated pressure mean: 0.4495830535888672
The generated pressure mean: 0.4497888684272766
The generated pressure mean: 0.44987666606903076
loss_pred:0.028097905218601227, decouple_loss:0.008543038740754128
loss_pred:0.029065588489174843, decouple_loss:0.008490944281220436
loss_pred:0.028060222044587135, decouple_loss:0.00852219108492136
Loss: 0.028833841904997826, avg_mse: 0.03748191520571709
current test mse: 0.037482
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012004_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012004_3_24hr.npz
NaN value num: 0
Iteration: 2021, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44648706912994385
loss_pred:0.01960381492972374, decouple_loss:0.008503387682139874
The generated pressure mean: 0.44872066378593445
loss_pred:0.02196449786424637, decouple_loss:0.00894438847899437
The generated pressure mean: 0.44850483536720276
loss_pred:0.021198410540819168, decouple_loss:0.008705570362508297
Iteration: 2022, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4479285478591919
The generated pressure mean: 0.4477931559085846
loss_pred:0.020720528438687325, decouple_loss:0.007583692669868469
loss_pred:0.020704716444015503, decouple_loss:0.0073411716148257256
The generated pressure mean: 0.4482864737510681
loss_pred:0.02141485922038555, decouple_loss:0.007392817176878452
Iteration: 2023, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45018258690834045
loss_pred:0.021878542378544807, decouple_loss:0.00732704671099782
The generated pressure mean: 0.44756534695625305
loss_pred:0.02028159610927105, decouple_loss:0.007273527327924967
The generated pressure mean: 0.4475911557674408
loss_pred:0.01981964334845543, decouple_loss:0.007070591673254967
Iteration: 2024, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4476674199104309
loss_pred:0.021832650527358055, decouple_loss:0.0078086163848638535
The generated pressure mean: 0.44615504145622253
loss_pred:0.02031697705388069, decouple_loss:0.007677054964005947
The generated pressure mean: 0.4487471878528595
loss_pred:0.022230489179491997, decouple_loss:0.007782774046063423
Iteration: 2025, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4467921555042267
loss_pred:0.020455559715628624, decouple_loss:0.0072724055498838425
The generated pressure mean: 0.44962185621261597
loss_pred:0.02029547467827797, decouple_loss:0.007140067871659994
The generated pressure mean: 0.4487585425376892
loss_pred:0.020139429718255997, decouple_loss:0.007177988067269325
Iteration: 2026, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4490843415260315
loss_pred:0.02208041585981846, decouple_loss:0.0068962471559643745
The generated pressure mean: 0.4482608139514923
loss_pred:0.02018120512366295, decouple_loss:0.00691002095118165
The generated pressure mean: 0.448636531829834
loss_pred:0.022298147901892662, decouple_loss:0.007046636659651995
Iteration: 2027, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44837528467178345
loss_pred:0.021144336089491844, decouple_loss:0.007856038399040699
The generated pressure mean: 0.4483340084552765
loss_pred:0.02176324464380741, decouple_loss:0.007894089445471764
The generated pressure mean: 0.447777658700943
loss_pred:0.020580047741532326, decouple_loss:0.007781412918120623
Iteration: 2028, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44817599654197693
loss_pred:0.020765002816915512, decouple_loss:0.0070861028507351875
The generated pressure mean: 0.4482541084289551
loss_pred:0.02102355659008026, decouple_loss:0.0071816155686974525
The generated pressure mean: 0.4478696584701538
loss_pred:0.020603381097316742, decouple_loss:0.007163376081734896
Iteration: 2029, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44935524463653564
loss_pred:0.02189107984304428, decouple_loss:0.007853051647543907
The generated pressure mean: 0.44727644324302673
loss_pred:0.019592730328440666, decouple_loss:0.007925072684884071
The generated pressure mean: 0.4502047300338745
loss_pred:0.020344454795122147, decouple_loss:0.007843121886253357
Iteration: 2030, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4488387405872345
loss_pred:0.021587464958429337, decouple_loss:0.008336457423865795
The generated pressure mean: 0.44788697361946106
loss_pred:0.02104952372610569, decouple_loss:0.008298451080918312
The generated pressure mean: 0.4483461380004883
loss_pred:0.020616840571165085, decouple_loss:0.008302640169858932
2023-04-16 08:50:39 testing...
The generated pressure mean: 0.4495830535888672
The generated pressure mean: 0.449788898229599
The generated pressure mean: 0.44987666606903076
loss_pred:0.02896135300397873, decouple_loss:0.00707054790109396
loss_pred:0.02988802269101143, decouple_loss:0.0070398421958088875
loss_pred:0.02842710167169571, decouple_loss:0.0071777468547225
Loss: 0.029446963220834732, avg_mse: 0.038830649107694626
current test mse: 0.038831
Iteration: 2031, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44828712940216064
loss_pred:0.021447569131851196, decouple_loss:0.006915748119354248
The generated pressure mean: 0.4481053054332733
loss_pred:0.020656414330005646, decouple_loss:0.0071507105603814125
The generated pressure mean: 0.44732072949409485
loss_pred:0.020787889137864113, decouple_loss:0.007089578080922365
Iteration: 2032, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44656041264533997
The generated pressure mean: 0.44748514890670776
loss_pred:0.01984703354537487, decouple_loss:0.006748403422534466
loss_pred:0.020659472793340683, decouple_loss:0.006497121881693602
The generated pressure mean: 0.44871821999549866
loss_pred:0.020724209025502205, decouple_loss:0.0068085938692092896
Iteration: 2033, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4463944733142853
loss_pred:0.020821616053581238, decouple_loss:0.007333456538617611
The generated pressure mean: 0.4483553469181061
loss_pred:0.020859474316239357, decouple_loss:0.007168829441070557
The generated pressure mean: 0.44782355427742004
loss_pred:0.0201558917760849, decouple_loss:0.00702064810320735
Iteration: 2034, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44940853118896484
The generated pressure mean: 0.44865861535072327
loss_pred:0.021198850125074387, decouple_loss:0.00834654550999403
The generated pressure mean: 0.4480462074279785loss_pred:0.020337942987680435, decouple_loss:0.008316725492477417
loss_pred:0.020155392587184906, decouple_loss:0.008319972082972527
Iteration: 2035, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44806262850761414
loss_pred:0.02060859464108944, decouple_loss:0.007966224104166031
The generated pressure mean: 0.4486162066459656
The generated pressure mean: 0.44796425104141235
loss_pred:0.022505220025777817, decouple_loss:0.007921669632196426
loss_pred:0.020288197323679924, decouple_loss:0.00794301275163889
Iteration: 2036, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44818660616874695
loss_pred:0.020740579813718796, decouple_loss:0.006853939034044743
The generated pressure mean: 0.44923385977745056
loss_pred:0.02130780555307865, decouple_loss:0.00718456506729126
The generated pressure mean: 0.4508858025074005
loss_pred:0.020947029814124107, decouple_loss:0.006818223278969526
Iteration: 2037, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4475422203540802
loss_pred:0.020745152607560158, decouple_loss:0.007975785061717033
The generated pressure mean: 0.44707104563713074
loss_pred:0.02010810375213623, decouple_loss:0.008138486184179783
The generated pressure mean: 0.4487621486186981
loss_pred:0.021527351811528206, decouple_loss:0.007965818978846073
Iteration: 2038, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4487915635108948
loss_pred:0.020881112664937973, decouple_loss:0.008227392099797726
The generated pressure mean: 0.44847527146339417
loss_pred:0.021252188831567764, decouple_loss:0.008153244853019714
The generated pressure mean: 0.4484059512615204
loss_pred:0.020996082574129105, decouple_loss:0.007973491214215755
Iteration: 2039, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.447750449180603
loss_pred:0.019823800772428513, decouple_loss:0.007406923919916153
The generated pressure mean: 0.44810235500335693
loss_pred:0.022475576028227806, decouple_loss:0.007680609822273254
The generated pressure mean: 0.4465106725692749
loss_pred:0.02085842192173004, decouple_loss:0.007715017069131136
Iteration: 2040, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4483143091201782
loss_pred:0.020896892994642258, decouple_loss:0.007259518373757601
The generated pressure mean: 0.4473828375339508
loss_pred:0.02047625370323658, decouple_loss:0.006947303656488657
The generated pressure mean: 0.44761234521865845
loss_pred:0.021189412102103233, decouple_loss:0.007394996006041765
2023-04-16 08:52:33 testing...
The generated pressure mean: 0.4495830833911896
The generated pressure mean: 0.4497888386249542
The generated pressure mean: 0.44987666606903076
loss_pred:0.02781178429722786, decouple_loss:0.007018278818577528
loss_pred:0.0288372952491045, decouple_loss:0.007032396271824837
loss_pred:0.027294836938381195, decouple_loss:0.0071580130606889725
Loss: 0.028334781527519226, avg_mse: 0.036634668707847595
current test mse: 0.036635
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012002_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012002_3_24hr.npz
NaN value num: 0
Iteration: 2041, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4486277103424072
loss_pred:0.019015779718756676, decouple_loss:0.0072851418517529964
The generated pressure mean: 0.4490741789340973
loss_pred:0.02046004869043827, decouple_loss:0.007465595845133066
The generated pressure mean: 0.4488476812839508
loss_pred:0.019467493519186974, decouple_loss:0.007719413843005896
Iteration: 2042, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4475484788417816
loss_pred:0.0217053834348917, decouple_loss:0.008786287158727646
The generated pressure mean: 0.44819745421409607
loss_pred:0.022373326122760773, decouple_loss:0.009058978408575058
The generated pressure mean: 0.4474261701107025
loss_pred:0.020909173414111137, decouple_loss:0.009043252095580101
Iteration: 2043, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4507500231266022
The generated pressure mean: 0.4466943144798279
loss_pred:0.020989416167140007, decouple_loss:0.00805470161139965
loss_pred:0.021686891093850136, decouple_loss:0.008410767652094364
The generated pressure mean: 0.4473476707935333
loss_pred:0.021043237298727036, decouple_loss:0.00795977097004652
Iteration: 2044, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4476976692676544
loss_pred:0.021063392981886864, decouple_loss:0.007412321865558624
The generated pressure mean: 0.44811615347862244
loss_pred:0.021360447630286217, decouple_loss:0.007419930305331945
The generated pressure mean: 0.4493548274040222
loss_pred:0.019926441833376884, decouple_loss:0.007636267691850662
Iteration: 2045, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4490821361541748
loss_pred:0.02213849499821663, decouple_loss:0.007323600817471743
The generated pressure mean: 0.4500373899936676
loss_pred:0.02182597853243351, decouple_loss:0.006971060298383236
The generated pressure mean: 0.44836610555648804
loss_pred:0.021245446056127548, decouple_loss:0.007124268915504217
Iteration: 2046, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44738543033599854
loss_pred:0.020153548568487167, decouple_loss:0.008069684728980064
The generated pressure mean: 0.44972044229507446
loss_pred:0.01940111443400383, decouple_loss:0.008354002609848976
The generated pressure mean: 0.4467901289463043
loss_pred:0.02077576145529747, decouple_loss:0.008439162746071815
Iteration: 2047, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4488057792186737
The generated pressure mean: 0.4471129775047302
loss_pred:0.020958129316568375, decouple_loss:0.008024431765079498
loss_pred:0.020905856043100357, decouple_loss:0.008199391886591911
The generated pressure mean: 0.4488906264305115
loss_pred:0.019898202270269394, decouple_loss:0.008090075105428696
Iteration: 2048, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44975507259368896
loss_pred:0.020369160920381546, decouple_loss:0.007909508422017097
The generated pressure mean: 0.4472696781158447
loss_pred:0.021352648735046387, decouple_loss:0.0077366093173623085
The generated pressure mean: 0.44841739535331726
loss_pred:0.02215837687253952, decouple_loss:0.007688834797590971
Iteration: 2049, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4474325478076935
loss_pred:0.0206073559820652, decouple_loss:0.007651463150978088
The generated pressure mean: 0.4499562680721283
loss_pred:0.020078901201486588, decouple_loss:0.00764341140165925
The generated pressure mean: 0.4486962556838989
loss_pred:0.020996171981096268, decouple_loss:0.007747339084744453
Iteration: 2050, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44979915022850037
loss_pred:0.02163795940577984, decouple_loss:0.008851642720401287
The generated pressure mean: 0.4474972188472748
loss_pred:0.02095748670399189, decouple_loss:0.00880525540560484
The generated pressure mean: 0.4474162459373474
loss_pred:0.021958002820611, decouple_loss:0.008740582503378391
2023-04-16 08:55:03 testing...
The generated pressure mean: 0.4497888684272766
The generated pressure mean: 0.4495830833911896
The generated pressure mean: 0.44987666606903076
loss_pred:0.02930506318807602, decouple_loss:0.0077223991975188255
loss_pred:0.02827521227300167, decouple_loss:0.007716156542301178
loss_pred:0.027971414849162102, decouple_loss:0.007878554984927177
Loss: 0.028905849903821945, avg_mse: 0.037549421191215515
current test mse: 0.037549
Iteration: 2051, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44975847005844116
loss_pred:0.020682724192738533, decouple_loss:0.007866641506552696
The generated pressure mean: 0.4479535222053528
loss_pred:0.020828742533922195, decouple_loss:0.007734240964055061
The generated pressure mean: 0.4478560984134674
loss_pred:0.020579596981406212, decouple_loss:0.007757887244224548
Iteration: 2052, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44912394881248474
loss_pred:0.01863422617316246, decouple_loss:0.008542939089238644
The generated pressure mean: 0.44755735993385315
loss_pred:0.02105780877172947, decouple_loss:0.008363491855561733
The generated pressure mean: 0.4516567587852478
loss_pred:0.019894156605005264, decouple_loss:0.008356833830475807
Iteration: 2053, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4476599097251892
loss_pred:0.021993733942508698, decouple_loss:0.007118055131286383
The generated pressure mean: 0.44862741231918335
loss_pred:0.01972820609807968, decouple_loss:0.007419907487928867
The generated pressure mean: 0.448194295167923
loss_pred:0.02274094521999359, decouple_loss:0.007163343485444784
Iteration: 2054, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44915971159935
loss_pred:0.020877866074442863, decouple_loss:0.007046105805784464
The generated pressure mean: 0.4469146728515625
loss_pred:0.01977638527750969, decouple_loss:0.006883210968226194
The generated pressure mean: 0.4487262964248657
loss_pred:0.02152002975344658, decouple_loss:0.007088780403137207
Iteration: 2055, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44837766885757446
loss_pred:0.021445877850055695, decouple_loss:0.00778750516474247
The generated pressure mean: 0.4490068554878235
loss_pred:0.02059260383248329, decouple_loss:0.008150720968842506
The generated pressure mean: 0.4489038288593292
loss_pred:0.02085155062377453, decouple_loss:0.00789888296276331
Iteration: 2056, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44840124249458313
loss_pred:0.02241506613790989, decouple_loss:0.008296352811157703
The generated pressure mean: 0.4472677409648895
loss_pred:0.02147396095097065, decouple_loss:0.008157576434314251
The generated pressure mean: 0.4472569227218628
loss_pred:0.02198241464793682, decouple_loss:0.008213945664465427
Iteration: 2057, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4489346146583557
loss_pred:0.020621102303266525, decouple_loss:0.007642629090696573
The generated pressure mean: 0.448757529258728
loss_pred:0.02189931832253933, decouple_loss:0.00717491889372468
The generated pressure mean: 0.45019304752349854
loss_pred:0.020493807271122932, decouple_loss:0.007220887113362551
Iteration: 2058, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44839343428611755
loss_pred:0.0225832499563694, decouple_loss:0.007190525531768799
The generated pressure mean: 0.4489430785179138
loss_pred:0.020671097561717033, decouple_loss:0.007619994692504406
The generated pressure mean: 0.448076993227005
loss_pred:0.021664420142769814, decouple_loss:0.007252965588122606
Iteration: 2059, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44961124658584595
loss_pred:0.01970590092241764, decouple_loss:0.008086863905191422
The generated pressure mean: 0.44766315817832947
loss_pred:0.02133568376302719, decouple_loss:0.007842729799449444
The generated pressure mean: 0.44798243045806885
loss_pred:0.01897251419723034, decouple_loss:0.008199993520975113
Iteration: 2060, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44856274127960205
loss_pred:0.020121483132243156, decouple_loss:0.007897911593317986
The generated pressure mean: 0.4481935501098633
loss_pred:0.020432407036423683, decouple_loss:0.007961420342326164
The generated pressure mean: 0.44785284996032715
loss_pred:0.022150855511426926, decouple_loss:0.007912181317806244
2023-04-16 08:56:58 testing...
The generated pressure mean: 0.4495830833911896
The generated pressure mean: 0.4497888684272766
The generated pressure mean: 0.44987666606903076
loss_pred:0.029441138729453087, decouple_loss:0.007802056148648262
loss_pred:0.030208135023713112, decouple_loss:0.007828463800251484
loss_pred:0.029186967760324478, decouple_loss:0.007958052679896355
Loss: 0.03000522218644619, avg_mse: 0.039758022874593735
current test mse: 0.039758
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012012_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012012_3_24hr.npz
NaN value num: 0
Iteration: 2061, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44849732518196106
loss_pred:0.02017243206501007, decouple_loss:0.007868305779993534
The generated pressure mean: 0.44628408551216125
loss_pred:0.0210203155875206, decouple_loss:0.008028117008507252
The generated pressure mean: 0.4469599425792694
loss_pred:0.02291610650718212, decouple_loss:0.007874161005020142
Iteration: 2062, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44743579626083374
The generated pressure mean: 0.44728660583496094
loss_pred:0.022523920983076096, decouple_loss:0.007264803629368544
loss_pred:0.02144223265349865, decouple_loss:0.007213925942778587
The generated pressure mean: 0.44814231991767883
loss_pred:0.020049894228577614, decouple_loss:0.00704243965446949
Iteration: 2063, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4465479552745819
loss_pred:0.021207569167017937, decouple_loss:0.007258533500134945
The generated pressure mean: 0.44773608446121216
loss_pred:0.0211130753159523, decouple_loss:0.007562561426311731
The generated pressure mean: 0.44790807366371155
loss_pred:0.021065568551421165, decouple_loss:0.00736971152946353
Iteration: 2064, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44838905334472656
loss_pred:0.022009437903761864, decouple_loss:0.0074141849763691425
The generated pressure mean: 0.4468740224838257
loss_pred:0.020567113533616066, decouple_loss:0.007222765125334263
The generated pressure mean: 0.44812092185020447
loss_pred:0.02253439836204052, decouple_loss:0.007387688383460045
Iteration: 2065, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4476092755794525
loss_pred:0.02116791531443596, decouple_loss:0.008068987168371677
The generated pressure mean: 0.4467793107032776
loss_pred:0.019712677225470543, decouple_loss:0.00808200053870678
The generated pressure mean: 0.44597822427749634
loss_pred:0.021609948948025703, decouple_loss:0.00800261739641428
Iteration: 2066, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44730570912361145
loss_pred:0.020928358659148216, decouple_loss:0.007984586991369724
The generated pressure mean: 0.4474744498729706
loss_pred:0.02018105797469616, decouple_loss:0.007964346557855606
The generated pressure mean: 0.4478985369205475
loss_pred:0.022039668634533882, decouple_loss:0.007914189249277115
Iteration: 2067, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4486413598060608
loss_pred:0.021345918998122215, decouple_loss:0.007639069110155106
The generated pressure mean: 0.446382999420166
loss_pred:0.021713823080062866, decouple_loss:0.007280046585947275
The generated pressure mean: 0.44869041442871094
loss_pred:0.022394156083464622, decouple_loss:0.007665468845516443
Iteration: 2068, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44752028584480286
loss_pred:0.021775677800178528, decouple_loss:0.00741956103593111
The generated pressure mean: 0.4477849304676056
loss_pred:0.021087709814310074, decouple_loss:0.007711970712989569
The generated pressure mean: 0.4477180242538452
loss_pred:0.020496344193816185, decouple_loss:0.007450907491147518
Iteration: 2069, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4470200538635254
loss_pred:0.020885957404971123, decouple_loss:0.007407600991427898
The generated pressure mean: 0.44865262508392334
loss_pred:0.022488951683044434, decouple_loss:0.007871792651712894
The generated pressure mean: 0.44765475392341614
loss_pred:0.021855711936950684, decouple_loss:0.007612365763634443
Iteration: 2070, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4471847116947174
loss_pred:0.021580034866929054, decouple_loss:0.007777081336826086
The generated pressure mean: 0.44889017939567566
loss_pred:0.02367783710360527, decouple_loss:0.00766076659783721
The generated pressure mean: 0.44789817929267883
loss_pred:0.021082064136862755, decouple_loss:0.007557997480034828
2023-04-16 08:59:33 testing...
The generated pressure mean: 0.449788898229599
The generated pressure mean: 0.4495830535888672
The generated pressure mean: 0.44987666606903076
loss_pred:0.029011651873588562, decouple_loss:0.007066106423735619
loss_pred:0.028063610196113586, decouple_loss:0.006944261025637388
loss_pred:0.027659822255373, decouple_loss:0.006993768271058798
Loss: 0.028595097362995148, avg_mse: 0.03711676970124245
current test mse: 0.037117
Iteration: 2071, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4472026228904724
loss_pred:0.021141069009900093, decouple_loss:0.006836646236479282
The generated pressure mean: 0.44742700457572937
loss_pred:0.021291105076670647, decouple_loss:0.007210560142993927
The generated pressure mean: 0.44732311367988586
loss_pred:0.02164778858423233, decouple_loss:0.006978426594287157
Iteration: 2072, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44803979992866516
The generated pressure mean: 0.4476260542869568loss_pred:0.02116241864860058, decouple_loss:0.007676742039620876
loss_pred:0.020996181294322014, decouple_loss:0.007499920204281807
The generated pressure mean: 0.447037011384964
loss_pred:0.021775992587208748, decouple_loss:0.007550631649792194
Iteration: 2073, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.448173850774765
loss_pred:0.021319149062037468, decouple_loss:0.00710269482806325
The generated pressure mean: 0.4469403624534607
loss_pred:0.020831260830163956, decouple_loss:0.006949412636458874
The generated pressure mean: 0.4477330446243286
loss_pred:0.02071313001215458, decouple_loss:0.006821161136031151
Iteration: 2074, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44741910696029663
The generated pressure mean: 0.4474409818649292
loss_pred:0.02272212877869606, decouple_loss:0.006885145325213671
loss_pred:0.02055169641971588, decouple_loss:0.006763008423149586
The generated pressure mean: 0.44812050461769104
loss_pred:0.02234504371881485, decouple_loss:0.0070574539713561535
Iteration: 2075, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4477022588253021The generated pressure mean: 0.4478236734867096
loss_pred:0.021846363320946693, decouple_loss:0.006479076109826565
loss_pred:0.020428549498319626, decouple_loss:0.006613736040890217
The generated pressure mean: 0.44647809863090515
loss_pred:0.0220356248319149, decouple_loss:0.006479260046035051
Iteration: 2076, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44769424200057983
The generated pressure mean: 0.4474908113479614
loss_pred:0.02035323902964592, decouple_loss:0.007849960587918758
loss_pred:0.02133137919008732, decouple_loss:0.007597866468131542
The generated pressure mean: 0.4484599530696869
loss_pred:0.021281592547893524, decouple_loss:0.007932065054774284
Iteration: 2077, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.445629358291626
The generated pressure mean: 0.446853905916214
loss_pred:0.02176768146455288, decouple_loss:0.007924008183181286
loss_pred:0.0204769354313612, decouple_loss:0.007700032088905573
The generated pressure mean: 0.4472869336605072
loss_pred:0.02010475844144821, decouple_loss:0.007815920747816563
Iteration: 2078, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.447234183549881
The generated pressure mean: 0.4469078481197357
loss_pred:0.021899938583374023, decouple_loss:0.007203748449683189
loss_pred:0.020233914256095886, decouple_loss:0.007176799699664116
The generated pressure mean: 0.4467921853065491
loss_pred:0.020795419812202454, decouple_loss:0.007016078568994999
Iteration: 2079, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4478202760219574
The generated pressure mean: 0.4475524127483368
loss_pred:0.02144111692905426, decouple_loss:0.006683206185698509
loss_pred:0.020032212138175964, decouple_loss:0.006531743798404932
The generated pressure mean: 0.448015958070755
loss_pred:0.02196040190756321, decouple_loss:0.006754737813025713
Iteration: 2080, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.448669970035553
The generated pressure mean: 0.4477033019065857
loss_pred:0.021601127460598946, decouple_loss:0.006916058715432882
loss_pred:0.021429097279906273, decouple_loss:0.006713313981890678
The generated pressure mean: 0.4487679600715637
loss_pred:0.020584721118211746, decouple_loss:0.006853833794593811
2023-04-16 09:01:27 testing...
The generated pressure mean: 0.4495830833911896
The generated pressure mean: 0.4497888684272766
The generated pressure mean: 0.44987666606903076
loss_pred:0.028531618416309357, decouple_loss:0.007452651392668486
loss_pred:0.029280124232172966, decouple_loss:0.007463821675628424
loss_pred:0.028296446427702904, decouple_loss:0.007433877792209387
Loss: 0.02907523512840271, avg_mse: 0.038160014897584915
current test mse: 0.03816
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012016_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012016_3_24hr.npz
NaN value num: 0
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 2081, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44758734107017517
loss_pred:0.020921749994158745, decouple_loss:0.007617844734340906
The generated pressure mean: 0.4475800395011902
loss_pred:0.02197258733212948, decouple_loss:0.00750906253233552
The generated pressure mean: 0.4476321041584015
loss_pred:0.02023419365286827, decouple_loss:0.0074462019838392735
Iteration: 2082, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4485894441604614
loss_pred:0.021004144102334976, decouple_loss:0.008719050325453281
The generated pressure mean: 0.448141485452652
loss_pred:0.021357908844947815, decouple_loss:0.0085914833471179
The generated pressure mean: 0.448035329580307
loss_pred:0.020459335297346115, decouple_loss:0.008688325993716717
Iteration: 2083, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4475558400154114
The generated pressure mean: 0.4477905035018921
loss_pred:0.023477565497159958, decouple_loss:0.007294865325093269
loss_pred:0.022486422210931778, decouple_loss:0.007382076233625412
The generated pressure mean: 0.44720014929771423
loss_pred:0.02121187373995781, decouple_loss:0.0075152055360376835
Iteration: 2084, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4463063180446625
loss_pred:0.020990852266550064, decouple_loss:0.00696121109649539
The generated pressure mean: 0.44601359963417053
loss_pred:0.02062021754682064, decouple_loss:0.006749229039996862
The generated pressure mean: 0.4477625787258148
loss_pred:0.02116459421813488, decouple_loss:0.0071740541607141495
Iteration: 2085, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44759687781333923
The generated pressure mean: 0.4479086697101593
loss_pred:0.020396394655108452, decouple_loss:0.007387304212898016
loss_pred:0.021338356658816338, decouple_loss:0.007391864899545908
The generated pressure mean: 0.4473910331726074
loss_pred:0.022117916494607925, decouple_loss:0.0074241068214178085
Iteration: 2086, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4476197361946106
loss_pred:0.02191566489636898, decouple_loss:0.007376526482403278
The generated pressure mean: 0.4469631314277649
loss_pred:0.021988922730088234, decouple_loss:0.007364544086158276
The generated pressure mean: 0.44729742407798767
loss_pred:0.021280329674482346, decouple_loss:0.007423426024615765
Iteration: 2087, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4476644992828369
The generated pressure mean: 0.447537362575531
loss_pred:0.021441079676151276, decouple_loss:0.007605100981891155
loss_pred:0.02212778851389885, decouple_loss:0.007720694877207279
The generated pressure mean: 0.4462769329547882
loss_pred:0.020471177995204926, decouple_loss:0.0076102688908576965
Iteration: 2088, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44785478711128235The generated pressure mean: 0.44800665974617004
loss_pred:0.02208561636507511, decouple_loss:0.007305814418941736
loss_pred:0.021997423842549324, decouple_loss:0.007117028813809156
The generated pressure mean: 0.44701892137527466
loss_pred:0.022606369107961655, decouple_loss:0.007132778409868479
Iteration: 2089, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44726693630218506
loss_pred:0.020764946937561035, decouple_loss:0.006779431365430355
The generated pressure mean: 0.44779273867607117
loss_pred:0.020983625203371048, decouple_loss:0.006701156497001648
The generated pressure mean: 0.4475240707397461
loss_pred:0.02228039875626564, decouple_loss:0.006901847198605537
Iteration: 2090, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44729751348495483
The generated pressure mean: 0.44744566082954407
loss_pred:0.020861297845840454, decouple_loss:0.006715357303619385
loss_pred:0.022704418748617172, decouple_loss:0.006582902744412422
The generated pressure mean: 0.4483296573162079
loss_pred:0.021945644170045853, decouple_loss:0.006780699826776981
2023-04-16 09:04:04 testing...
The generated pressure mean: 0.449788898229599
The generated pressure mean: 0.4495830535888672
The generated pressure mean: 0.44987666606903076
loss_pred:0.028171315789222717, decouple_loss:0.007055847905576229
loss_pred:0.027260472998023033, decouple_loss:0.0069967047311365604loss_pred:0.027002181857824326, decouple_loss:0.007000648882240057
Loss: 0.027828877791762352, avg_mse: 0.03590531647205353
current test mse: 0.035905
Iteration: 2091, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44733744859695435
loss_pred:0.02370288409292698, decouple_loss:0.007048023398965597
The generated pressure mean: 0.4471803605556488
loss_pred:0.020987825468182564, decouple_loss:0.006909968331456184
The generated pressure mean: 0.44776326417922974
loss_pred:0.022856995463371277, decouple_loss:0.006933957803994417
Iteration: 2092, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4476643204689026
loss_pred:0.020673952996730804, decouple_loss:0.008113552816212177
The generated pressure mean: 0.44719043374061584
loss_pred:0.022094763815402985, decouple_loss:0.008043627254664898
The generated pressure mean: 0.44710057973861694
loss_pred:0.021544279530644417, decouple_loss:0.008060641586780548
Iteration: 2093, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44677072763442993
loss_pred:0.02021057903766632, decouple_loss:0.007130349520593882
The generated pressure mean: 0.44654354453086853
loss_pred:0.021502600982785225, decouple_loss:0.007163746282458305
The generated pressure mean: 0.4473235309123993
loss_pred:0.02157643809914589, decouple_loss:0.007152792997658253
Iteration: 2094, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4471528232097626
loss_pred:0.021164800971746445, decouple_loss:0.006597691215574741
The generated pressure mean: 0.44752684235572815
loss_pred:0.023553291335701942, decouple_loss:0.006828778423368931
The generated pressure mean: 0.4476095139980316
loss_pred:0.022263674065470695, decouple_loss:0.006892804056406021
Iteration: 2095, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4474899172782898
loss_pred:0.021108299493789673, decouple_loss:0.00784002710133791
The generated pressure mean: 0.4471842646598816
loss_pred:0.020874090492725372, decouple_loss:0.007697041612118483
The generated pressure mean: 0.4481312930583954
loss_pred:0.022194568067789078, decouple_loss:0.007838786579668522
Iteration: 2096, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44698387384414673
loss_pred:0.022582687437534332, decouple_loss:0.007376613561064005
The generated pressure mean: 0.4468156695365906
loss_pred:0.021109886467456818, decouple_loss:0.007288089022040367
The generated pressure mean: 0.44745901226997375
loss_pred:0.021361319348216057, decouple_loss:0.007230998016893864
Iteration: 2097, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4478148818016052
loss_pred:0.021837932989001274, decouple_loss:0.006579669192433357
The generated pressure mean: 0.4485866129398346
loss_pred:0.02119405008852482, decouple_loss:0.006534458138048649
The generated pressure mean: 0.4469161927700043
loss_pred:0.02281264401972294, decouple_loss:0.006691687740385532
Iteration: 2098, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44707900285720825
loss_pred:0.023612434044480324, decouple_loss:0.007050396874547005
The generated pressure mean: 0.44735559821128845
loss_pred:0.02079133130609989, decouple_loss:0.007070924621075392
The generated pressure mean: 0.44772130250930786
loss_pred:0.022620515897870064, decouple_loss:0.0070647988468408585
Iteration: 2099, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44723114371299744
loss_pred:0.022756531834602356, decouple_loss:0.00671767070889473
The generated pressure mean: 0.44719043374061584
loss_pred:0.02460407465696335, decouple_loss:0.006715648807585239
The generated pressure mean: 0.4477413594722748
loss_pred:0.02193354070186615, decouple_loss:0.006586212199181318
Iteration: 2100, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4475264549255371
loss_pred:0.021795177832245827, decouple_loss:0.006886614486575127
The generated pressure mean: 0.44748654961586
loss_pred:0.0224961768835783, decouple_loss:0.0067954896949231625
The generated pressure mean: 0.4471185505390167
loss_pred:0.021800190210342407, decouple_loss:0.006764498073607683
2023-04-16 09:05:58 testing...
The generated pressure mean: 0.4495830535888672
The generated pressure mean: 0.4497888684272766
The generated pressure mean: 0.44987666606903076
loss_pred:0.028899939730763435, decouple_loss:0.007797048427164555
loss_pred:0.029475457966327667, decouple_loss:0.007660573814064264
loss_pred:0.02841314859688282, decouple_loss:0.007816433906555176
Loss: 0.02931741625070572, avg_mse: 0.038621243089437485
current test mse: 0.038621
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012011_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012011_3_24hr.npz
NaN value num: 0
Iteration: 2101, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4471810758113861
loss_pred:0.023144187405705452, decouple_loss:0.007791030220687389
The generated pressure mean: 0.44815149903297424
loss_pred:0.020104266703128815, decouple_loss:0.007737578824162483
The generated pressure mean: 0.4473905861377716
loss_pred:0.020078470930457115, decouple_loss:0.00798851903527975
Iteration: 2102, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44766750931739807
loss_pred:0.020327236503362656, decouple_loss:0.007626572158187628
The generated pressure mean: 0.44764891266822815
The generated pressure mean: 0.4481104910373688
loss_pred:0.020889893174171448, decouple_loss:0.007451558019965887
loss_pred:0.020639998838305473, decouple_loss:0.007645816076546907
Iteration: 2103, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4473133385181427
The generated pressure mean: 0.44794023036956787loss_pred:0.02051236853003502, decouple_loss:0.00709929596632719
loss_pred:0.020918888971209526, decouple_loss:0.0069855013862252235
The generated pressure mean: 0.44788751006126404
loss_pred:0.02314034476876259, decouple_loss:0.0071023027412593365
Iteration: 2104, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44765564799308777
The generated pressure mean: 0.4476890563964844
loss_pred:0.021044667810201645, decouple_loss:0.008009161800146103
loss_pred:0.019541773945093155, decouple_loss:0.008043580688536167
The generated pressure mean: 0.44808363914489746
loss_pred:0.02245337702333927, decouple_loss:0.008174012415111065
Iteration: 2105, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.449092298746109
The generated pressure mean: 0.44870510697364807
loss_pred:0.019945133477449417, decouple_loss:0.007283126004040241
loss_pred:0.019985666498541832, decouple_loss:0.0070457723923027515
The generated pressure mean: 0.44962751865386963
loss_pred:0.021279901266098022, decouple_loss:0.007340798620134592
Iteration: 2106, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4494800865650177
loss_pred:0.020858703181147575, decouple_loss:0.007772105745971203
The generated pressure mean: 0.4471355676651001
loss_pred:0.022420911118388176, decouple_loss:0.007718225009739399
The generated pressure mean: 0.4480414092540741
loss_pred:0.019477562978863716, decouple_loss:0.007436239626258612
Iteration: 2107, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4488285779953003
The generated pressure mean: 0.4474720358848572
loss_pred:0.01921895146369934, decouple_loss:0.0070341178216040134
loss_pred:0.02206578478217125, decouple_loss:0.007167777977883816
The generated pressure mean: 0.44863414764404297
loss_pred:0.02049221657216549, decouple_loss:0.007108634803444147
Iteration: 2108, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.447787344455719
The generated pressure mean: 0.4475351870059967
loss_pred:0.021956458687782288, decouple_loss:0.007671223022043705
loss_pred:0.019359910860657692, decouple_loss:0.0074171763844788074
The generated pressure mean: 0.4486345052719116
loss_pred:0.02036440558731556, decouple_loss:0.007462434936314821
Iteration: 2109, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44750165939331055
loss_pred:0.021940702572464943, decouple_loss:0.007851759903132915
The generated pressure mean: 0.44668814539909363
loss_pred:0.020829271525144577, decouple_loss:0.008080932311713696
The generated pressure mean: 0.4490791857242584
loss_pred:0.020548155531287193, decouple_loss:0.007868878543376923
Iteration: 2110, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44769522547721863The generated pressure mean: 0.44776228070259094
loss_pred:0.01896742545068264, decouple_loss:0.007000078447163105
loss_pred:0.02163189835846424, decouple_loss:0.007046212442219257
The generated pressure mean: 0.446834534406662
loss_pred:0.02008223719894886, decouple_loss:0.0069555905647575855
2023-04-16 09:08:27 testing...
The generated pressure mean: 0.4497888684272766
The generated pressure mean: 0.4495830833911896
The generated pressure mean: 0.44987666606903076
loss_pred:0.02886386774480343, decouple_loss:0.007012113928794861
loss_pred:0.02840493991971016, decouple_loss:0.007012521848082542
loss_pred:0.02770429104566574, decouple_loss:0.007094771135598421
Loss: 0.028676357120275497, avg_mse: 0.037578001618385315
current test mse: 0.037578
Iteration: 2111, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4470285177230835
loss_pred:0.021709131076931953, decouple_loss:0.007157767657190561
The generated pressure mean: 0.44715616106987
loss_pred:0.022656146436929703, decouple_loss:0.007160795386880636
The generated pressure mean: 0.44797784090042114
loss_pred:0.018631741404533386, decouple_loss:0.00703502306714654
Iteration: 2112, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44773584604263306
The generated pressure mean: 0.4467989206314087loss_pred:0.022424906492233276, decouple_loss:0.007966575212776661
loss_pred:0.021210823208093643, decouple_loss:0.007862081751227379
The generated pressure mean: 0.4468989074230194
loss_pred:0.0219406895339489, decouple_loss:0.008033071644604206
Iteration: 2113, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44720175862312317
The generated pressure mean: 0.4485373795032501
loss_pred:0.021908117458224297, decouple_loss:0.008848398923873901
loss_pred:0.021798549219965935, decouple_loss:0.008728585205972195
The generated pressure mean: 0.4482946991920471
loss_pred:0.021802978590130806, decouple_loss:0.008681245148181915
Iteration: 2114, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4481607675552368
The generated pressure mean: 0.4478897452354431
loss_pred:0.020316705107688904, decouple_loss:0.007622642442584038
loss_pred:0.019289258867502213, decouple_loss:0.007600767072290182
The generated pressure mean: 0.44768840074539185
loss_pred:0.021343961358070374, decouple_loss:0.00763727305456996
Iteration: 2115, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44812625646591187
The generated pressure mean: 0.44732335209846497
loss_pred:0.021167879924178123, decouple_loss:0.007551657035946846
loss_pred:0.021440062671899796, decouple_loss:0.007525017485022545
The generated pressure mean: 0.4471130669116974
loss_pred:0.021659644320607185, decouple_loss:0.00752514461055398
Iteration: 2116, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44757816195487976
The generated pressure mean: 0.44741091132164
loss_pred:0.02037985622882843, decouple_loss:0.006392117124050856
loss_pred:0.02271171659231186, decouple_loss:0.00645951135084033
The generated pressure mean: 0.44780397415161133
loss_pred:0.02241096831858158, decouple_loss:0.006464013364166021
Iteration: 2117, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4475812315940857The generated pressure mean: 0.4470593333244324
loss_pred:0.02085994742810726, decouple_loss:0.008466620929539204
loss_pred:0.019879193976521492, decouple_loss:0.008304126560688019
The generated pressure mean: 0.44720330834388733
loss_pred:0.021262386813759804, decouple_loss:0.008452220819890499
Iteration: 2118, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44653698801994324
The generated pressure mean: 0.4481147825717926
loss_pred:0.022320261225104332, decouple_loss:0.007939840666949749
loss_pred:0.021417519077658653, decouple_loss:0.007728067692369223
The generated pressure mean: 0.44797438383102417
loss_pred:0.02195301465690136, decouple_loss:0.0080192219465971
Iteration: 2119, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44704321026802063
The generated pressure mean: 0.447274774312973
loss_pred:0.019970908761024475, decouple_loss:0.007144078612327576
loss_pred:0.02080940641462803, decouple_loss:0.007172024343162775
The generated pressure mean: 0.4478502869606018
loss_pred:0.022995393723249435, decouple_loss:0.0071419463492929935
Iteration: 2120, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44774556159973145
loss_pred:0.02115422673523426, decouple_loss:0.007353129331022501
The generated pressure mean: 0.44857919216156006
loss_pred:0.021633939817547798, decouple_loss:0.007207739166915417
The generated pressure mean: 0.44735175371170044
loss_pred:0.021649474278092384, decouple_loss:0.007176915183663368
2023-04-16 09:10:20 testing...
The generated pressure mean: 0.4495830833911896
The generated pressure mean: 0.4497888684272766
The generated pressure mean: 0.44987666606903076
loss_pred:0.02829105406999588, decouple_loss:0.007818901911377907
loss_pred:0.029373500496149063, decouple_loss:0.007841379381716251
loss_pred:0.02815917134284973, decouple_loss:0.007793581113219261
Loss: 0.028998807072639465, avg_mse: 0.03805020451545715
current test mse: 0.03805
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012018_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012018_3_24hr.npz
NaN value num: 0
Iteration: 2121, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4479655921459198
loss_pred:0.021532446146011353, decouple_loss:0.007867570966482162
The generated pressure mean: 0.44916248321533203
loss_pred:0.022789694368839264, decouple_loss:0.008075372315943241
The generated pressure mean: 0.44851455092430115
loss_pred:0.023620516061782837, decouple_loss:0.00782784540206194
Iteration: 2122, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4490712881088257
loss_pred:0.022212989628314972, decouple_loss:0.008027235977351665
The generated pressure mean: 0.44875583052635193
loss_pred:0.02022857777774334, decouple_loss:0.008009929209947586
The generated pressure mean: 0.44851556420326233
loss_pred:0.022126657888293266, decouple_loss:0.007980779744684696
Iteration: 2123, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4494500756263733
The generated pressure mean: 0.44879257678985596
loss_pred:0.021938545629382133, decouple_loss:0.007589282467961311
loss_pred:0.022200504317879677, decouple_loss:0.007569741457700729
The generated pressure mean: 0.44862130284309387
loss_pred:0.022258799523115158, decouple_loss:0.007327530533075333
Iteration: 2124, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4492180645465851
The generated pressure mean: 0.44861987233161926loss_pred:0.022568216547369957, decouple_loss:0.007072680629789829
loss_pred:0.02220962941646576, decouple_loss:0.006954432465136051
The generated pressure mean: 0.4510590732097626
loss_pred:0.022897876799106598, decouple_loss:0.007049061357975006
Iteration: 2125, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4499236047267914
loss_pred:0.021039914339780807, decouple_loss:0.007696978747844696
The generated pressure mean: 0.4486909806728363
loss_pred:0.020977944135665894, decouple_loss:0.007835950702428818
The generated pressure mean: 0.44893208146095276
loss_pred:0.02240070328116417, decouple_loss:0.007736940868198872
Iteration: 2126, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.449035108089447
loss_pred:0.02208608016371727, decouple_loss:0.007595048286020756
The generated pressure mean: 0.4483445882797241
loss_pred:0.02078929729759693, decouple_loss:0.007728093769401312
The generated pressure mean: 0.4478102922439575
loss_pred:0.02232160046696663, decouple_loss:0.007574034389108419
Iteration: 2127, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.448900431394577
loss_pred:0.022333411499857903, decouple_loss:0.006786178797483444
The generated pressure mean: 0.44955405592918396
loss_pred:0.021488260477781296, decouple_loss:0.0068084802478551865
The generated pressure mean: 0.44823339581489563
loss_pred:0.021819453686475754, decouple_loss:0.006821734830737114
Iteration: 2128, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4493091106414795
The generated pressure mean: 0.44948524236679077
loss_pred:0.021588999778032303, decouple_loss:0.007277545519173145
loss_pred:0.022175176069140434, decouple_loss:0.0073535870760679245
The generated pressure mean: 0.44945028424263
loss_pred:0.02152218110859394, decouple_loss:0.007161454763263464
Iteration: 2129, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44885820150375366
loss_pred:0.02051112800836563, decouple_loss:0.007306476589292288
The generated pressure mean: 0.45069214701652527
loss_pred:0.022842399775981903, decouple_loss:0.007133080158382654
The generated pressure mean: 0.44823217391967773
loss_pred:0.021803634241223335, decouple_loss:0.007107172627002001
Iteration: 2130, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4487936794757843
loss_pred:0.02145538665354252, decouple_loss:0.006754138041287661
The generated pressure mean: 0.4485279619693756
loss_pred:0.020160013809800148, decouple_loss:0.006892273668199778
The generated pressure mean: 0.4491003453731537
loss_pred:0.020621933043003082, decouple_loss:0.006898880936205387
2023-04-16 09:12:55 testing...
The generated pressure mean: 0.4495830833911896
The generated pressure mean: 0.4497888684272766
The generated pressure mean: 0.44987666606903076
loss_pred:0.02821285091340542, decouple_loss:0.0068765971809625626
loss_pred:0.028917988762259483, decouple_loss:0.006921976804733276
loss_pred:0.02778518758714199, decouple_loss:0.006929706782102585
Loss: 0.028650812804698944, avg_mse: 0.03760537505149841
current test mse: 0.037605
Iteration: 2131, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44929617643356323
The generated pressure mean: 0.4498286247253418
loss_pred:0.021414997056126595, decouple_loss:0.007111135870218277
loss_pred:0.020249266177415848, decouple_loss:0.006877433508634567
The generated pressure mean: 0.45011135935783386
loss_pred:0.021542543545365334, decouple_loss:0.006768814753741026
Iteration: 2132, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4500401020050049
The generated pressure mean: 0.44943416118621826
loss_pred:0.021753400564193726, decouple_loss:0.00690043717622757
loss_pred:0.022260334342718124, decouple_loss:0.006804870441555977
The generated pressure mean: 0.4496171176433563
loss_pred:0.021800708025693893, decouple_loss:0.006825231481343508
Iteration: 2133, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44982975721359253
The generated pressure mean: 0.4490033686161041
loss_pred:0.021688543260097504, decouple_loss:0.007755744270980358
loss_pred:0.01965916156768799, decouple_loss:0.007550159469246864
The generated pressure mean: 0.44784530997276306
loss_pred:0.021430309861898422, decouple_loss:0.007563893683254719
Iteration: 2134, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4495351314544678
loss_pred:0.020709771662950516, decouple_loss:0.0072976090013980865
The generated pressure mean: 0.44956347346305847
The generated pressure mean: 0.4490126073360443
loss_pred:0.020883673802018166, decouple_loss:0.0073513733223080635
loss_pred:0.022733451798558235, decouple_loss:0.007131367921829224
Iteration: 2135, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4483950436115265
The generated pressure mean: 0.4475609362125397
loss_pred:0.022262632846832275, decouple_loss:0.006497264839708805
loss_pred:0.022193053737282753, decouple_loss:0.006352683063596487
The generated pressure mean: 0.44849181175231934
loss_pred:0.02268662117421627, decouple_loss:0.006552793551236391
Iteration: 2136, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44802820682525635
The generated pressure mean: 0.44853314757347107
loss_pred:0.021642550826072693, decouple_loss:0.006609926465898752
loss_pred:0.021893301978707314, decouple_loss:0.0067772166803479195
The generated pressure mean: 0.4492822289466858
loss_pred:0.02060285210609436, decouple_loss:0.0069603873416781425
Iteration: 2137, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4488747715950012
loss_pred:0.02250201813876629, decouple_loss:0.007105384953320026
The generated pressure mean: 0.4480951428413391
loss_pred:0.022421160712838173, decouple_loss:0.007032633759081364
The generated pressure mean: 0.4479248821735382
loss_pred:0.021487712860107422, decouple_loss:0.006880568340420723
Iteration: 2138, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44794365763664246
The generated pressure mean: 0.44786709547042847
loss_pred:0.021651500836014748, decouple_loss:0.0076326713897287846
loss_pred:0.022041236981749535, decouple_loss:0.007705033756792545
The generated pressure mean: 0.4478776156902313
loss_pred:0.0217210054397583, decouple_loss:0.007737053092569113
Iteration: 2139, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44800862669944763The generated pressure mean: 0.45006638765335083
loss_pred:0.021793769672513008, decouple_loss:0.006720239762216806
loss_pred:0.021208686754107475, decouple_loss:0.006674470845609903
The generated pressure mean: 0.44937968254089355
loss_pred:0.021971071138978004, decouple_loss:0.006577652413398027
Iteration: 2140, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4490082561969757
loss_pred:0.022329362109303474, decouple_loss:0.0066741639748215675
The generated pressure mean: 0.44923946261405945
loss_pred:0.021036820486187935, decouple_loss:0.006486692000180483
The generated pressure mean: 0.44827431440353394
loss_pred:0.02235276997089386, decouple_loss:0.006608272902667522
2023-04-16 09:14:49 testing...
The generated pressure mean: 0.4495830833911896
The generated pressure mean: 0.4497888684272766
The generated pressure mean: 0.44987666606903076
loss_pred:0.028135675936937332, decouple_loss:0.006704624276608229
loss_pred:0.029154295101761818, decouple_loss:0.006875180639326572
loss_pred:0.027982039377093315, decouple_loss:0.006688306573778391
Loss: 0.02876180410385132, avg_mse: 0.037807613611221313
current test mse: 0.037808
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012001_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012001_3_24hr.npz
NaN value num: 0
Iteration: 2141, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44669535756111145
loss_pred:0.021761460229754448, decouple_loss:0.006867542397230864
The generated pressure mean: 0.44738903641700745
loss_pred:0.021001489832997322, decouple_loss:0.006816423032432795
The generated pressure mean: 0.44755247235298157
loss_pred:0.02064332738518715, decouple_loss:0.006796658039093018
Iteration: 2142, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4472768306732178
The generated pressure mean: 0.44720712304115295
loss_pred:0.020700132474303246, decouple_loss:0.0069501278921961784
loss_pred:0.02041446790099144, decouple_loss:0.006963214837014675
The generated pressure mean: 0.44660335779190063
loss_pred:0.020794596523046494, decouple_loss:0.006807070691138506
Iteration: 2143, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44717469811439514
The generated pressure mean: 0.4480387568473816
loss_pred:0.02126091532409191, decouple_loss:0.007063857279717922
loss_pred:0.020258670672774315, decouple_loss:0.006972382310777903
The generated pressure mean: 0.4466248154640198
loss_pred:0.020621158182621002, decouple_loss:0.007006494794040918
Iteration: 2144, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44684138894081116
The generated pressure mean: 0.44715994596481323
loss_pred:0.019882824271917343, decouple_loss:0.008010918274521828
loss_pred:0.020694073289632797, decouple_loss:0.007897128351032734
The generated pressure mean: 0.44769904017448425
loss_pred:0.020769450813531876, decouple_loss:0.00781723577529192
Iteration: 2145, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44812071323394775
loss_pred:0.021897215396165848, decouple_loss:0.00832369178533554
The generated pressure mean: 0.4474722146987915
loss_pred:0.01997954398393631, decouple_loss:0.00828398298472166
The generated pressure mean: 0.44753625988960266
loss_pred:0.0199917983263731, decouple_loss:0.008259103633463383
Iteration: 2146, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.447307288646698
loss_pred:0.021024614572525024, decouple_loss:0.007124478463083506
The generated pressure mean: 0.4471668303012848
loss_pred:0.021624449640512466, decouple_loss:0.007604437880218029
The generated pressure mean: 0.4474543333053589
loss_pred:0.020926298573613167, decouple_loss:0.007120220921933651
Iteration: 2147, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44814741611480713
loss_pred:0.02040179632604122, decouple_loss:0.006596350111067295
The generated pressure mean: 0.44818082451820374
loss_pred:0.020494788885116577, decouple_loss:0.006588269956409931
The generated pressure mean: 0.4482123553752899
loss_pred:0.022084694355726242, decouple_loss:0.006580327171832323
Iteration: 2148, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4479478597640991
The generated pressure mean: 0.44691500067710876
loss_pred:0.02171352133154869, decouple_loss:0.006589052267372608
loss_pred:0.020779691636562347, decouple_loss:0.006480030249804258
The generated pressure mean: 0.4469571113586426
loss_pred:0.020347096025943756, decouple_loss:0.0068806870840489864
Iteration: 2149, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4471932649612427
The generated pressure mean: 0.44716647267341614
loss_pred:0.021153440698981285, decouple_loss:0.006504196673631668
loss_pred:0.021541906520724297, decouple_loss:0.006661876570433378
The generated pressure mean: 0.4463751018047333
loss_pred:0.022298654541373253, decouple_loss:0.006777768023312092
Iteration: 2150, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4467913806438446
The generated pressure mean: 0.4478078782558441
loss_pred:0.021730395033955574, decouple_loss:0.0072868820279836655
loss_pred:0.02071528136730194, decouple_loss:0.007217555306851864
The generated pressure mean: 0.44737738370895386
loss_pred:0.02239142917096615, decouple_loss:0.007265961263328791
2023-04-16 09:17:23 testing...
The generated pressure mean: 0.4495830535888672
The generated pressure mean: 0.4497888684272766
The generated pressure mean: 0.44987666606903076
loss_pred:0.02765263058245182, decouple_loss:0.006794271524995565
loss_pred:0.028582323342561722, decouple_loss:0.006935874465852976
loss_pred:0.02758273109793663, decouple_loss:0.006901790387928486
Loss: 0.028283094987273216, avg_mse: 0.03697868064045906
current test mse: 0.036979
Iteration: 2151, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44719362258911133
The generated pressure mean: 0.4473174512386322loss_pred:0.021059243008494377, decouple_loss:0.006804345641285181
loss_pred:0.020049434155225754, decouple_loss:0.006780295167118311
The generated pressure mean: 0.4473952651023865
loss_pred:0.019936135038733482, decouple_loss:0.006793932523578405
Iteration: 2152, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44667768478393555
The generated pressure mean: 0.4460698068141937
loss_pred:0.019150851294398308, decouple_loss:0.006194632966071367
loss_pred:0.020552489906549454, decouple_loss:0.006368346977978945
The generated pressure mean: 0.44840213656425476
loss_pred:0.02102041058242321, decouple_loss:0.006331765558570623
Iteration: 2153, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4482475817203522
The generated pressure mean: 0.4487560987472534
loss_pred:0.022992918267846107, decouple_loss:0.0075836386531591415
loss_pred:0.021659279242157936, decouple_loss:0.0076466212049126625
The generated pressure mean: 0.4472036063671112
loss_pred:0.019706226885318756, decouple_loss:0.007524157874286175
Iteration: 2154, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44609716534614563
loss_pred:0.021082689985632896, decouple_loss:0.007212597411125898
The generated pressure mean: 0.4467073678970337
loss_pred:0.02083948440849781, decouple_loss:0.00726573308929801
The generated pressure mean: 0.44665172696113586
loss_pred:0.02075480856001377, decouple_loss:0.0072916168719530106
Iteration: 2155, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44703614711761475
The generated pressure mean: 0.447295606136322loss_pred:0.021311065182089806, decouple_loss:0.0064415764063596725
loss_pred:0.02085023932158947, decouple_loss:0.006631364114582539
The generated pressure mean: 0.4482124447822571
loss_pred:0.020110704004764557, decouple_loss:0.006564195733517408
Iteration: 2156, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4465309977531433
loss_pred:0.0193968266248703, decouple_loss:0.0064168632961809635
The generated pressure mean: 0.4469364881515503
loss_pred:0.020764347165822983, decouple_loss:0.006455937400460243
The generated pressure mean: 0.446856826543808
loss_pred:0.019155221059918404, decouple_loss:0.0065100230276584625
Iteration: 2157, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.446953147649765
loss_pred:0.0202997587621212, decouple_loss:0.006627367809414864
The generated pressure mean: 0.4470263123512268
loss_pred:0.01935233734548092, decouple_loss:0.006856068503111601
The generated pressure mean: 0.446893572807312
loss_pred:0.019471248611807823, decouple_loss:0.006676024291664362
Iteration: 2158, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.448147714138031
loss_pred:0.02086908370256424, decouple_loss:0.007377436384558678
The generated pressure mean: 0.4472956657409668
loss_pred:0.022899486124515533, decouple_loss:0.007434542290866375
The generated pressure mean: 0.4464047849178314
loss_pred:0.022645097225904465, decouple_loss:0.007428822107613087
Iteration: 2159, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44766610860824585
The generated pressure mean: 0.44614535570144653
loss_pred:0.022582629695534706, decouple_loss:0.007225949317216873
loss_pred:0.021553268656134605, decouple_loss:0.0074000577442348
The generated pressure mean: 0.44784802198410034
loss_pred:0.020713375881314278, decouple_loss:0.007382125593721867
Iteration: 2160, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4466308355331421
loss_pred:0.02111370489001274, decouple_loss:0.006894396152347326
The generated pressure mean: 0.4466235935688019
loss_pred:0.02348109520971775, decouple_loss:0.006903285626322031
The generated pressure mean: 0.4465223252773285
loss_pred:0.02083674818277359, decouple_loss:0.0068847863003611565
2023-04-16 09:19:16 testing...
The generated pressure mean: 0.4495830833911896
The generated pressure mean: 0.4497888684272766
The generated pressure mean: 0.44987666606903076
loss_pred:0.02894611470401287, decouple_loss:0.00698501244187355
loss_pred:0.02976713515818119, decouple_loss:0.007072536740452051
loss_pred:0.028941163793206215, decouple_loss:0.006952192168682814
Loss: 0.029568299651145935, avg_mse: 0.039315130561590195
current test mse: 0.039315
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012000_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012000_3_24hr.npz
NaN value num: 0
Iteration: 2161, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44902482628822327
loss_pred:0.019663294777274132, decouple_loss:0.006951507646590471
The generated pressure mean: 0.44704604148864746
loss_pred:0.021489331498742104, decouple_loss:0.0069071948528289795
The generated pressure mean: 0.44661128520965576
loss_pred:0.019529106095433235, decouple_loss:0.0070306695997715
Iteration: 2162, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44719547033309937
The generated pressure mean: 0.44693154096603394
loss_pred:0.02064194530248642, decouple_loss:0.0065789418295025826
loss_pred:0.02031676657497883, decouple_loss:0.006471039727330208
The generated pressure mean: 0.44738543033599854
loss_pred:0.019299786537885666, decouple_loss:0.006449318956583738
Iteration: 2163, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44750961661338806
The generated pressure mean: 0.4482327103614807
loss_pred:0.020079223439097404, decouple_loss:0.006669274996966124
loss_pred:0.019792523235082626, decouple_loss:0.006995310075581074
The generated pressure mean: 0.44923028349876404
loss_pred:0.020819038152694702, decouple_loss:0.006783704739063978
Iteration: 2164, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4491988718509674
The generated pressure mean: 0.4500364661216736
loss_pred:0.020177029073238373, decouple_loss:0.007197738159447908
loss_pred:0.021832305938005447, decouple_loss:0.007026920095086098
The generated pressure mean: 0.4461825489997864
loss_pred:0.02066844142973423, decouple_loss:0.007158774416893721
Iteration: 2165, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4482777416706085
loss_pred:0.018879491835832596, decouple_loss:0.008051427081227303
The generated pressure mean: 0.4484160840511322
loss_pred:0.021585658192634583, decouple_loss:0.008055672980844975
The generated pressure mean: 0.4501919448375702
loss_pred:0.021141022443771362, decouple_loss:0.007855485193431377
Iteration: 2166, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4474087357521057
loss_pred:0.020039543509483337, decouple_loss:0.0077650644816458225
The generated pressure mean: 0.4476581811904907
loss_pred:0.02064308524131775, decouple_loss:0.007752400357276201
The generated pressure mean: 0.4464013874530792
loss_pred:0.021289464086294174, decouple_loss:0.008473952300846577
Iteration: 2167, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4472803473472595
The generated pressure mean: 0.4473456144332886
loss_pred:0.020859451964497566, decouple_loss:0.006548949051648378
loss_pred:0.02127722278237343, decouple_loss:0.006618479732424021
The generated pressure mean: 0.44937461614608765
loss_pred:0.021493248641490936, decouple_loss:0.0066082412376999855
Iteration: 2168, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4482394754886627
The generated pressure mean: 0.4488295614719391
loss_pred:0.020692044869065285, decouple_loss:0.007214066572487354
loss_pred:0.019826190546154976, decouple_loss:0.006899234838783741
The generated pressure mean: 0.44858020544052124
loss_pred:0.01956368423998356, decouple_loss:0.006590493023395538
Iteration: 2169, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4473118782043457
loss_pred:0.019036781042814255, decouple_loss:0.006959893275052309
The generated pressure mean: 0.4493301808834076
loss_pred:0.022266928106546402, decouple_loss:0.006780919618904591
The generated pressure mean: 0.4481538236141205
loss_pred:0.019850604236125946, decouple_loss:0.006799263879656792
Iteration: 2170, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4485984742641449
loss_pred:0.020647060126066208, decouple_loss:0.006989128887653351
The generated pressure mean: 0.44790494441986084
loss_pred:0.02044447883963585, decouple_loss:0.006952221039682627
The generated pressure mean: 0.4473694860935211
loss_pred:0.019646724686026573, decouple_loss:0.007260071113705635
2023-04-16 09:21:46 testing...
The generated pressure mean: 0.4495830833911896
The generated pressure mean: 0.4497888684272766
The generated pressure mean: 0.44987666606903076
loss_pred:0.028383471071720123, decouple_loss:0.007514144293963909
loss_pred:0.0294002965092659, decouple_loss:0.007622884586453438
loss_pred:0.027940919622778893, decouple_loss:0.007529280614107847
Loss: 0.028952669352293015, avg_mse: 0.03812321648001671
current test mse: 0.038123
Iteration: 2171, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44794389605522156
The generated pressure mean: 0.4471632242202759
loss_pred:0.02162824384868145, decouple_loss:0.007574776187539101
loss_pred:0.019432146102190018, decouple_loss:0.007490980438888073
The generated pressure mean: 0.449720174074173
loss_pred:0.022016968578100204, decouple_loss:0.007601595018059015
Iteration: 2172, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4490028917789459
The generated pressure mean: 0.4464573562145233
loss_pred:0.022612571716308594, decouple_loss:0.007624348159879446
loss_pred:0.02093510329723358, decouple_loss:0.00770548963919282
The generated pressure mean: 0.44889628887176514
loss_pred:0.02201368659734726, decouple_loss:0.007639394607394934
Iteration: 2173, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44793716073036194
loss_pred:0.020330246537923813, decouple_loss:0.006792496889829636
The generated pressure mean: 0.4472601115703583
loss_pred:0.021015241742134094, decouple_loss:0.007131894584745169
The generated pressure mean: 0.4468690752983093
loss_pred:0.019979584962129593, decouple_loss:0.006847440265119076
Iteration: 2174, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4478943645954132
loss_pred:0.019962234422564507, decouple_loss:0.00768575444817543
The generated pressure mean: 0.447660356760025
loss_pred:0.019394461065530777, decouple_loss:0.007600295823067427
The generated pressure mean: 0.44831985235214233
loss_pred:0.019968902692198753, decouple_loss:0.007471936754882336
Iteration: 2175, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4488517940044403
loss_pred:0.02004222758114338, decouple_loss:0.007290709298104048
The generated pressure mean: 0.44693103432655334
loss_pred:0.020502494648098946, decouple_loss:0.007735701277852058
The generated pressure mean: 0.44871610403060913
loss_pred:0.019536791369318962, decouple_loss:0.007306649815291166
Iteration: 2176, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44910064339637756
loss_pred:0.02083398401737213, decouple_loss:0.0069654411636292934
The generated pressure mean: 0.4487685561180115
loss_pred:0.02000296860933304, decouple_loss:0.006911046337336302
The generated pressure mean: 0.449217826128006
loss_pred:0.020420730113983154, decouple_loss:0.006922573316842318
Iteration: 2177, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4474874436855316
loss_pred:0.018476078286767006, decouple_loss:0.007254164665937424
The generated pressure mean: 0.44783085584640503
loss_pred:0.021132148802280426, decouple_loss:0.007410626392811537
The generated pressure mean: 0.44701385498046875
loss_pred:0.020049523562192917, decouple_loss:0.007613280788064003
Iteration: 2178, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44705814123153687
loss_pred:0.02016487717628479, decouple_loss:0.007334183435887098
The generated pressure mean: 0.4492894113063812
loss_pred:0.020957201719284058, decouple_loss:0.007310887333005667
The generated pressure mean: 0.44775640964508057
loss_pred:0.019339466467499733, decouple_loss:0.007285460829734802
Iteration: 2179, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44818514585494995
loss_pred:0.0203985795378685, decouple_loss:0.007318115793168545
The generated pressure mean: 0.4460190236568451
loss_pred:0.02071160450577736, decouple_loss:0.007413021754473448
The generated pressure mean: 0.44830483198165894
loss_pred:0.02028784155845642, decouple_loss:0.007669566664844751
Iteration: 2180, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4488774240016937
loss_pred:0.02110479027032852, decouple_loss:0.007330769207328558
The generated pressure mean: 0.44876590371131897
loss_pred:0.020115768536925316, decouple_loss:0.007147854659706354
The generated pressure mean: 0.4480293095111847
loss_pred:0.021036166697740555, decouple_loss:0.007339564152061939
2023-04-16 09:23:40 testing...
The generated pressure mean: 0.4495830833911896
The generated pressure mean: 0.4497888684272766
The generated pressure mean: 0.44987666606903076
loss_pred:0.028342094272375107, decouple_loss:0.006468989420682192
loss_pred:0.029007453471422195, decouple_loss:0.006573354825377464
loss_pred:0.028017211705446243, decouple_loss:0.006582812871783972
Loss: 0.028782673180103302, avg_mse: 0.038001615554094315
current test mse: 0.038002
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012010_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012010_3_24hr.npz
NaN value num: 0
Iteration: 2181, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44708606600761414
loss_pred:0.020251795649528503, decouple_loss:0.006847582291811705
The generated pressure mean: 0.44749343395233154
The generated pressure mean: 0.44788992404937744
loss_pred:0.022422436624765396, decouple_loss:0.006745719816535711
loss_pred:0.020530294626951218, decouple_loss:0.006713676266372204
Iteration: 2182, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4459474980831146
The generated pressure mean: 0.4473014771938324
loss_pred:0.020236849784851074, decouple_loss:0.00718335248529911
loss_pred:0.0207289420068264, decouple_loss:0.007063653785735369
The generated pressure mean: 0.44677475094795227
loss_pred:0.020005445927381516, decouple_loss:0.0072278776206076145
Iteration: 2183, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44736284017562866
The generated pressure mean: 0.44790297746658325
loss_pred:0.02280094102025032, decouple_loss:0.00764990272000432
loss_pred:0.02072744630277157, decouple_loss:0.007651199586689472
The generated pressure mean: 0.44761785864830017
loss_pred:0.020767692476511, decouple_loss:0.007616743445396423
Iteration: 2184, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44660109281539917
loss_pred:0.02081160806119442, decouple_loss:0.007408467121422291
The generated pressure mean: 0.44755229353904724
The generated pressure mean: 0.44749799370765686
loss_pred:0.019924644380807877, decouple_loss:0.007393664214760065
loss_pred:0.020459063351154327, decouple_loss:0.007428538054227829
Iteration: 2185, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4479389190673828
The generated pressure mean: 0.4463503360748291
loss_pred:0.024729669094085693, decouple_loss:0.007908160798251629
loss_pred:0.019246965646743774, decouple_loss:0.008063022047281265
The generated pressure mean: 0.44731026887893677
loss_pred:0.020177094265818596, decouple_loss:0.008004896342754364
Iteration: 2186, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44836685061454773
loss_pred:0.0212558526545763, decouple_loss:0.007330767344683409
The generated pressure mean: 0.4479878842830658
loss_pred:0.021276891231536865, decouple_loss:0.007587441708892584
The generated pressure mean: 0.44809257984161377
loss_pred:0.020389758050441742, decouple_loss:0.0074512590654194355
Iteration: 2187, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4461391866207123
loss_pred:0.0194819588214159, decouple_loss:0.007123508024960756
The generated pressure mean: 0.4477333128452301
loss_pred:0.021193524822592735, decouple_loss:0.0070388042367994785
The generated pressure mean: 0.4480937123298645
loss_pred:0.019759254530072212, decouple_loss:0.007056343834847212
Iteration: 2188, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4484720230102539
loss_pred:0.021076813340187073, decouple_loss:0.0062118717469275
The generated pressure mean: 0.4468335509300232
loss_pred:0.02035181224346161, decouple_loss:0.006261899136006832
The generated pressure mean: 0.44671371579170227
loss_pred:0.022279934957623482, decouple_loss:0.006184128578752279
Iteration: 2189, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44772443175315857
The generated pressure mean: 0.4462706446647644
loss_pred:0.020949335768818855, decouple_loss:0.006404327228665352
loss_pred:0.020760847255587578, decouple_loss:0.006491373758763075
The generated pressure mean: 0.44661808013916016
loss_pred:0.02344556525349617, decouple_loss:0.00642006192356348
Iteration: 2190, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.447325736284256
The generated pressure mean: 0.44816112518310547
loss_pred:0.0199954342097044, decouple_loss:0.007248070556670427
loss_pred:0.020508568733930588, decouple_loss:0.007316340692341328
The generated pressure mean: 0.44764432311058044
loss_pred:0.022134630009531975, decouple_loss:0.0072198002599179745
2023-04-16 09:26:26 testing...
The generated pressure mean: 0.449788898229599
The generated pressure mean: 0.4495830833911896
The generated pressure mean: 0.44987666606903076
loss_pred:0.029324045404791832, decouple_loss:0.007741047069430351
loss_pred:0.028227852657437325, decouple_loss:0.007812939584255219
loss_pred:0.02855173870921135, decouple_loss:0.007735362276434898
Loss: 0.029089368879795074, avg_mse: 0.03840005770325661
current test mse: 0.0384
Iteration: 2191, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44840723276138306
The generated pressure mean: 0.44676151871681213
loss_pred:0.021185049787163734, decouple_loss:0.007556356489658356
loss_pred:0.02200249768793583, decouple_loss:0.007572478149086237
The generated pressure mean: 0.44779473543167114
loss_pred:0.019954565912485123, decouple_loss:0.0076176864095032215
Iteration: 2192, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4480712115764618
The generated pressure mean: 0.4485853612422943
loss_pred:0.02224869467318058, decouple_loss:0.0071351551450788975
loss_pred:0.020551148802042007, decouple_loss:0.0070290956646203995
The generated pressure mean: 0.44725489616394043
loss_pred:0.023402169346809387, decouple_loss:0.0070485747419297695
Iteration: 2193, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44698426127433777
The generated pressure mean: 0.44590359926223755
loss_pred:0.019748518243432045, decouple_loss:0.006898575462400913
loss_pred:0.019830279052257538, decouple_loss:0.0069814869202673435
The generated pressure mean: 0.4473837912082672
loss_pred:0.021000003442168236, decouple_loss:0.007193416822701693
Iteration: 2194, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4461376368999481The generated pressure mean: 0.4478013515472412
loss_pred:0.021818388253450394, decouple_loss:0.007308115251362324
loss_pred:0.020216137170791626, decouple_loss:0.006971347611397505
The generated pressure mean: 0.4465268552303314
loss_pred:0.019772134721279144, decouple_loss:0.007292645983397961
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 2195, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4460480511188507
loss_pred:0.02144516445696354, decouple_loss:0.007055917754769325
The generated pressure mean: 0.447247713804245
loss_pred:0.020984098315238953, decouple_loss:0.006920153740793467
The generated pressure mean: 0.44717881083488464
loss_pred:0.02061745896935463, decouple_loss:0.006941554136574268
Iteration: 2196, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4474668502807617
The generated pressure mean: 0.4472237527370453
loss_pred:0.020857632160186768, decouple_loss:0.00692554097622633
loss_pred:0.02149568870663643, decouple_loss:0.006986584980040789
The generated pressure mean: 0.44768717885017395
loss_pred:0.021095430478453636, decouple_loss:0.007047935854643583
Iteration: 2197, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44754183292388916
loss_pred:0.02037542685866356, decouple_loss:0.0066307298839092255
The generated pressure mean: 0.44643402099609375
loss_pred:0.021375488489866257, decouple_loss:0.006651547271758318
The generated pressure mean: 0.4473322331905365
loss_pred:0.01954745501279831, decouple_loss:0.006563480477780104
Iteration: 2198, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4481946527957916
The generated pressure mean: 0.4482315480709076
loss_pred:0.020992334932088852, decouple_loss:0.006661278661340475
loss_pred:0.021037759259343147, decouple_loss:0.006516415625810623
The generated pressure mean: 0.4483828544616699
loss_pred:0.02116478979587555, decouple_loss:0.0066378493793308735
Iteration: 2199, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4477153718471527
The generated pressure mean: 0.4472489058971405
loss_pred:0.02064833603799343, decouple_loss:0.007065087556838989
loss_pred:0.02060435339808464, decouple_loss:0.0071030971594154835
The generated pressure mean: 0.44711533188819885
loss_pred:0.020335499197244644, decouple_loss:0.007174455560743809
Iteration: 2200, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4476853609085083
The generated pressure mean: 0.44760996103286743
loss_pred:0.020941095426678658, decouple_loss:0.006786730606108904
loss_pred:0.020263468846678734, decouple_loss:0.00678594596683979
The generated pressure mean: 0.44793903827667236
loss_pred:0.021204249933362007, decouple_loss:0.006869341246783733
2023-04-16 09:28:20 testing...
The generated pressure mean: 0.4497888684272766
The generated pressure mean: 0.4495830535888672
The generated pressure mean: 0.44987666606903076
loss_pred:0.028994210064411163, decouple_loss:0.0074153319001197815
loss_pred:0.02798590064048767, decouple_loss:0.007368491962552071
loss_pred:0.027418052777647972, decouple_loss:0.00735135655850172
Loss: 0.028501641005277634, avg_mse: 0.03735040873289108
current test mse: 0.03735
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012017_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012017_3_24hr.npz
NaN value num: 0
Iteration: 2201, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4478549063205719
The generated pressure mean: 0.44816482067108154
The generated pressure mean: 0.44797733426094055
loss_pred:0.02089270018041134, decouple_loss:0.007273388560861349
loss_pred:0.020335137844085693, decouple_loss:0.007193707395344973
loss_pred:0.019779115915298462, decouple_loss:0.007173141464591026
Iteration: 2202, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44822442531585693
The generated pressure mean: 0.44783008098602295
loss_pred:0.02061879262328148, decouple_loss:0.007770235184580088
loss_pred:0.02290303446352482, decouple_loss:0.00782830361276865
The generated pressure mean: 0.4476214051246643
loss_pred:0.020194971933960915, decouple_loss:0.0076017011888325214
Iteration: 2203, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44875863194465637
The generated pressure mean: 0.4480619728565216
loss_pred:0.021436143666505814, decouple_loss:0.007432969752699137
loss_pred:0.020800795406103134, decouple_loss:0.007342172786593437
The generated pressure mean: 0.4480210542678833
loss_pred:0.021322103217244148, decouple_loss:0.007382596842944622
Iteration: 2204, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4479690492153168The generated pressure mean: 0.4478556215763092
loss_pred:0.02025226131081581, decouple_loss:0.007018340285867453
loss_pred:0.020659619942307472, decouple_loss:0.006940149702131748
The generated pressure mean: 0.44802403450012207
loss_pred:0.021234847605228424, decouple_loss:0.00713785644620657
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 2205, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4478135406970978
The generated pressure mean: 0.4473591446876526
loss_pred:0.02082778699696064, decouple_loss:0.006701213773339987
loss_pred:0.020906902849674225, decouple_loss:0.006595423445105553
The generated pressure mean: 0.44823944568634033
loss_pred:0.020305851474404335, decouple_loss:0.006779287476092577
Iteration: 2206, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44888073205947876
loss_pred:0.020296553149819374, decouple_loss:0.007459118962287903
The generated pressure mean: 0.447857141494751
The generated pressure mean: 0.4479132294654846
loss_pred:0.019270529970526695, decouple_loss:0.007484127767384052
loss_pred:0.020701227709650993, decouple_loss:0.007469646167010069
Iteration: 2207, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44890785217285156
The generated pressure mean: 0.44863346219062805
loss_pred:0.02052878960967064, decouple_loss:0.007096603512763977
loss_pred:0.021111276000738144, decouple_loss:0.0070805675350129604
The generated pressure mean: 0.44879162311553955
loss_pred:0.020768502727150917, decouple_loss:0.007131495978683233
Iteration: 2208, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.448091596364975
The generated pressure mean: 0.44676509499549866
loss_pred:0.02097233571112156, decouple_loss:0.006812403444200754
loss_pred:0.02113460563123226, decouple_loss:0.006742397323250771
The generated pressure mean: 0.44762372970581055
loss_pred:0.019682466983795166, decouple_loss:0.006791916210204363
Iteration: 2209, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44752660393714905
The generated pressure mean: 0.4484468400478363
loss_pred:0.021465936675667763, decouple_loss:0.0065663959830999374
loss_pred:0.020332159474492073, decouple_loss:0.006428912281990051
The generated pressure mean: 0.44832268357276917
loss_pred:0.019230592995882034, decouple_loss:0.006478084251284599
Iteration: 2210, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44781047105789185
The generated pressure mean: 0.4477875232696533
loss_pred:0.021779559552669525, decouple_loss:0.00686445040628314
loss_pred:0.022482985630631447, decouple_loss:0.006853429134935141
The generated pressure mean: 0.4482143521308899
loss_pred:0.021097183227539062, decouple_loss:0.006852013990283012
2023-04-16 09:30:51 testing...
The generated pressure mean: 0.4497888684272766
The generated pressure mean: 0.4495830535888672
The generated pressure mean: 0.44987666606903076
loss_pred:0.02996043860912323, decouple_loss:0.007720097433775663
loss_pred:0.029120653867721558, decouple_loss:0.007702067494392395
loss_pred:0.028475379571318626, decouple_loss:0.007633616682142019
Loss: 0.029569756239652634, avg_mse: 0.03945893794298172
current test mse: 0.039459
Iteration: 2211, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4465709626674652
The generated pressure mean: 0.4477509558200836
loss_pred:0.021570470184087753, decouple_loss:0.007551232352852821
loss_pred:0.021326331421732903, decouple_loss:0.007733373902738094
The generated pressure mean: 0.4481227993965149
loss_pred:0.02013721689581871, decouple_loss:0.0075512356124818325
Iteration: 2212, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44692251086235046
The generated pressure mean: 0.44824519753456116
loss_pred:0.019884204491972923, decouple_loss:0.0066389967687428
loss_pred:0.021787256002426147, decouple_loss:0.00693082669749856
The generated pressure mean: 0.44810548424720764
loss_pred:0.021271873265504837, decouple_loss:0.006800311617553234
Iteration: 2213, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44783854484558105
The generated pressure mean: 0.44637301564216614
loss_pred:0.019526701420545578, decouple_loss:0.006980685982853174
loss_pred:0.020527293905615807, decouple_loss:0.006884078960865736
The generated pressure mean: 0.4474068880081177
loss_pred:0.021176768466830254, decouple_loss:0.006704254075884819
Iteration: 2214, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44830814003944397
loss_pred:0.020434696227312088, decouple_loss:0.008041730150580406
The generated pressure mean: 0.44715163111686707
loss_pred:0.02144511789083481, decouple_loss:0.007958774454891682
The generated pressure mean: 0.44700318574905396
loss_pred:0.02156723104417324, decouple_loss:0.00787575077265501
Iteration: 2215, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4487875998020172
loss_pred:0.01953302137553692, decouple_loss:0.007379847578704357
The generated pressure mean: 0.44811657071113586
loss_pred:0.01942053996026516, decouple_loss:0.007380704861134291
The generated pressure mean: 0.4482062757015228
loss_pred:0.021255651488900185, decouple_loss:0.007407852914184332
Iteration: 2216, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44745364785194397
loss_pred:0.020463770255446434, decouple_loss:0.006475619040429592
The generated pressure mean: 0.44816282391548157
loss_pred:0.021322347223758698, decouple_loss:0.006411312613636255
The generated pressure mean: 0.4485308527946472
loss_pred:0.019577274098992348, decouple_loss:0.0064759994857013226
Iteration: 2217, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4473022222518921
loss_pred:0.020849080756306648, decouple_loss:0.007014207076281309
The generated pressure mean: 0.4478228688240051
loss_pred:0.020555470138788223, decouple_loss:0.0072604757733643055
The generated pressure mean: 0.44872283935546875
loss_pred:0.02053607441484928, decouple_loss:0.007260298356413841
Iteration: 2218, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4470321238040924
loss_pred:0.020993629470467567, decouple_loss:0.006669469177722931
The generated pressure mean: 0.4482780992984772
loss_pred:0.021737411618232727, decouple_loss:0.006601507309824228
The generated pressure mean: 0.44733431935310364
loss_pred:0.022251004353165627, decouple_loss:0.006418771576136351
Iteration: 2219, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4474121034145355
loss_pred:0.021333327516913414, decouple_loss:0.006682718638330698
The generated pressure mean: 0.4472324848175049
loss_pred:0.021560268476605415, decouple_loss:0.006673638708889484
The generated pressure mean: 0.4474637806415558
loss_pred:0.02101018838584423, decouple_loss:0.006659385282546282
Iteration: 2220, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44791844487190247
loss_pred:0.02163241058588028, decouple_loss:0.00709960050880909
The generated pressure mean: 0.4461670517921448
loss_pred:0.02090923674404621, decouple_loss:0.007087047211825848
The generated pressure mean: 0.44800901412963867
loss_pred:0.019640633836388588, decouple_loss:0.0070332856848835945
2023-04-16 09:32:45 testing...
The generated pressure mean: 0.4495830833911896
The generated pressure mean: 0.449788898229599
The generated pressure mean: 0.44987666606903076
loss_pred:0.027193710207939148, decouple_loss:0.007632922381162643
loss_pred:0.028398966416716576, decouple_loss:0.0077749271877110004
loss_pred:0.026878155767917633, decouple_loss:0.0076219867914915085
Loss: 0.027874110266566277, avg_mse: 0.03626175969839096
current test mse: 0.036262
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012019_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012019_3_24hr.npz
NaN value num: 0
Iteration: 2221, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44915643334388733
loss_pred:0.020657209679484367, decouple_loss:0.007698900997638702
The generated pressure mean: 0.44908520579338074
loss_pred:0.020173516124486923, decouple_loss:0.007715436164289713
The generated pressure mean: 0.44782623648643494
loss_pred:0.021358603611588478, decouple_loss:0.008002512156963348
Iteration: 2222, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4481983482837677
loss_pred:0.02226453833281994, decouple_loss:0.006740476004779339
The generated pressure mean: 0.4475438594818115
loss_pred:0.02143627405166626, decouple_loss:0.006563772447407246
The generated pressure mean: 0.44894957542419434
loss_pred:0.02090427652001381, decouple_loss:0.006586006842553616
Iteration: 2223, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44813087582588196
loss_pred:0.020862827077507973, decouple_loss:0.0073136198334395885
The generated pressure mean: 0.4485247731208801
loss_pred:0.021200336515903473, decouple_loss:0.007361594587564468
The generated pressure mean: 0.4477930963039398
loss_pred:0.021722465753555298, decouple_loss:0.0072683608159422874
Iteration: 2224, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4494486153125763
loss_pred:0.020313341170549393, decouple_loss:0.0068893758580088615
The generated pressure mean: 0.4493795335292816
loss_pred:0.019686518236994743, decouple_loss:0.006919494830071926
The generated pressure mean: 0.4473295211791992
loss_pred:0.02201816812157631, decouple_loss:0.00684740673750639
Iteration: 2225, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4489286243915558
loss_pred:0.02108439989387989, decouple_loss:0.0076912082731723785
The generated pressure mean: 0.44853851199150085
loss_pred:0.020086156204342842, decouple_loss:0.0076161837205290794
The generated pressure mean: 0.44788870215415955
loss_pred:0.02110406570136547, decouple_loss:0.007738383486866951
Iteration: 2226, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44905582070350647
loss_pred:0.020780056715011597, decouple_loss:0.0071798344142735004
The generated pressure mean: 0.4490394592285156
loss_pred:0.020256392657756805, decouple_loss:0.007163813337683678
The generated pressure mean: 0.4481312036514282
loss_pred:0.02130322903394699, decouple_loss:0.007256763055920601
Iteration: 2227, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4491133987903595
loss_pred:0.020998070016503334, decouple_loss:0.006734354887157679
The generated pressure mean: 0.4489581286907196
loss_pred:0.019743256270885468, decouple_loss:0.0066833398304879665
The generated pressure mean: 0.4479733109474182
loss_pred:0.022280242294073105, decouple_loss:0.006773150991648436
Iteration: 2228, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4486387372016907
loss_pred:0.020181355997920036, decouple_loss:0.006220356561243534
The generated pressure mean: 0.44856327772140503
loss_pred:0.021097546443343163, decouple_loss:0.006144545041024685
The generated pressure mean: 0.4493986666202545
loss_pred:0.020945196971297264, decouple_loss:0.006218841765075922
Iteration: 2229, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4489932656288147
loss_pred:0.020463494583964348, decouple_loss:0.006181320641189814
The generated pressure mean: 0.44809702038764954
loss_pred:0.019671767950057983, decouple_loss:0.006201124284416437
The generated pressure mean: 0.4486866891384125
loss_pred:0.020651590079069138, decouple_loss:0.0062304227612912655
Iteration: 2230, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4489731192588806
loss_pred:0.020533844828605652, decouple_loss:0.007414596155285835
The generated pressure mean: 0.44886159896850586
loss_pred:0.020986493676900864, decouple_loss:0.007466412149369717
The generated pressure mean: 0.4488207697868347
loss_pred:0.021491048857569695, decouple_loss:0.007379826623946428
2023-04-16 09:35:14 testing...
The generated pressure mean: 0.4495830833911896
The generated pressure mean: 0.449788898229599
The generated pressure mean: 0.44987666606903076
loss_pred:0.026852983981370926, decouple_loss:0.007163879461586475
loss_pred:0.027758674696087837, decouple_loss:0.007188070099800825
loss_pred:0.026370707899332047, decouple_loss:0.007343676406890154
Loss: 0.02735571563243866, avg_mse: 0.035369500517845154
current test mse: 0.03537
Iteration: 2231, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4475499987602234
loss_pred:0.021458450704813004, decouple_loss:0.007567567750811577
The generated pressure mean: 0.4488866925239563
loss_pred:0.02047351561486721, decouple_loss:0.007193497382104397
The generated pressure mean: 0.449386328458786
loss_pred:0.020178426057100296, decouple_loss:0.0072939214296638966
Iteration: 2232, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4480119049549103
loss_pred:0.021589424461126328, decouple_loss:0.006924599874764681
The generated pressure mean: 0.4492949843406677
loss_pred:0.02075451798737049, decouple_loss:0.006816726643592119
The generated pressure mean: 0.4484594762325287
loss_pred:0.02026454545557499, decouple_loss:0.006716162897646427
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 2233, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4491598308086395
loss_pred:0.020813480019569397, decouple_loss:0.006956525146961212
The generated pressure mean: 0.4494735300540924
loss_pred:0.02014595828950405, decouple_loss:0.006787407211959362
The generated pressure mean: 0.4478198289871216
loss_pred:0.020827608183026314, decouple_loss:0.006792325060814619
Iteration: 2234, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44797807931900024
loss_pred:0.020344920456409454, decouple_loss:0.006941336207091808
The generated pressure mean: 0.44952598214149475
loss_pred:0.020053161308169365, decouple_loss:0.006938043981790543
The generated pressure mean: 0.4482795000076294
loss_pred:0.021161695942282677, decouple_loss:0.006956062279641628
Iteration: 2235, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44924524426460266
loss_pred:0.021099207922816277, decouple_loss:0.006929333787411451
The generated pressure mean: 0.4483850598335266
loss_pred:0.020384782925248146, decouple_loss:0.006994024850428104
The generated pressure mean: 0.4487845003604889
loss_pred:0.02043808065354824, decouple_loss:0.0069719539023935795
Iteration: 2236, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4490385055541992
loss_pred:0.02088201977312565, decouple_loss:0.006251731887459755
The generated pressure mean: 0.4483930170536041
loss_pred:0.020454643294215202, decouple_loss:0.006223850883543491
The generated pressure mean: 0.4481603503227234
loss_pred:0.022527430206537247, decouple_loss:0.006438375450670719
Iteration: 2237, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4479416608810425
loss_pred:0.021946193650364876, decouple_loss:0.00609012134373188
The generated pressure mean: 0.4489569664001465
loss_pred:0.020864302292466164, decouple_loss:0.006060679908841848
The generated pressure mean: 0.4489925801753998
loss_pred:0.020978564396500587, decouple_loss:0.0060325670056045055
Iteration: 2238, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4491555094718933
loss_pred:0.02055417187511921, decouple_loss:0.005903626326471567
The generated pressure mean: 0.449418306350708
The generated pressure mean: 0.44877126812934875
loss_pred:0.020162709057331085, decouple_loss:0.006026620976626873
loss_pred:0.020708218216896057, decouple_loss:0.0060403598472476006
Iteration: 2239, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4486974775791168
loss_pred:0.021760176867246628, decouple_loss:0.006542799063026905
The generated pressure mean: 0.44751986861228943
loss_pred:0.022060299292206764, decouple_loss:0.006591627839952707
The generated pressure mean: 0.44819584488868713
loss_pred:0.02040320821106434, decouple_loss:0.0065810950472950935
Iteration: 2240, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4495750963687897
loss_pred:0.020511910319328308, decouple_loss:0.006422029808163643
The generated pressure mean: 0.4494834542274475
loss_pred:0.021354833617806435, decouple_loss:0.006355825811624527
The generated pressure mean: 0.4486227035522461
loss_pred:0.02109927125275135, decouple_loss:0.006368793547153473
2023-04-16 09:37:09 testing...
The generated pressure mean: 0.4495830833911896
The generated pressure mean: 0.449788898229599
The generated pressure mean: 0.44987666606903076
loss_pred:0.028100967407226562, decouple_loss:0.006723260506987572
loss_pred:0.028774375095963478, decouple_loss:0.0068084304220974445
loss_pred:0.027896326035261154, decouple_loss:0.006718342192471027
Loss: 0.028594722971320152, avg_mse: 0.03786386549472809
current test mse: 0.037864
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012003_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012003_3_24hr.npz
NaN value num: 0
Iteration: 2241, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44832903146743774
loss_pred:0.019382033497095108, decouple_loss:0.006605690810829401
The generated pressure mean: 0.44853872060775757
loss_pred:0.020946672186255455, decouple_loss:0.007101936265826225
The generated pressure mean: 0.44745132327079773
loss_pred:0.0205120500177145, decouple_loss:0.006962140556424856
Iteration: 2242, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44844579696655273
loss_pred:0.01988396607339382, decouple_loss:0.007019378710538149
The generated pressure mean: 0.4474150240421295
loss_pred:0.0200972780585289, decouple_loss:0.007057083770632744
The generated pressure mean: 0.44690385460853577
loss_pred:0.020537151023745537, decouple_loss:0.007163412868976593
Iteration: 2243, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4478701651096344
loss_pred:0.02124706283211708, decouple_loss:0.007402322255074978
The generated pressure mean: 0.44682058691978455
loss_pred:0.020020591095089912, decouple_loss:0.007127759046852589
The generated pressure mean: 0.44795912504196167
loss_pred:0.019840799272060394, decouple_loss:0.007357168477028608
Iteration: 2244, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4484531581401825
loss_pred:0.020662495866417885, decouple_loss:0.0068594119511544704
The generated pressure mean: 0.4481634199619293
loss_pred:0.01998184621334076, decouple_loss:0.00666558463126421
The generated pressure mean: 0.4481697380542755
loss_pred:0.02096673659980297, decouple_loss:0.006895625498145819
Iteration: 2245, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45050033926963806
loss_pred:0.021001629531383514, decouple_loss:0.006750030908733606
The generated pressure mean: 0.44815993309020996
loss_pred:0.021524393931031227, decouple_loss:0.006699133664369583
The generated pressure mean: 0.4480617344379425
loss_pred:0.021131886169314384, decouple_loss:0.006709933280944824
Iteration: 2246, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44761526584625244
loss_pred:0.020583951845765114, decouple_loss:0.006571121513843536
The generated pressure mean: 0.4490232765674591
loss_pred:0.021046984940767288, decouple_loss:0.006813603453338146
The generated pressure mean: 0.44725608825683594
loss_pred:0.02213957905769348, decouple_loss:0.006826815195381641
Iteration: 2247, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4490513503551483
loss_pred:0.021110698580741882, decouple_loss:0.00799228623509407
The generated pressure mean: 0.44893309473991394
loss_pred:0.0196025762706995, decouple_loss:0.007867654785513878
The generated pressure mean: 0.4481416344642639
loss_pred:0.020973453298211098, decouple_loss:0.008056840859353542
Iteration: 2248, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44823935627937317
loss_pred:0.019375579431653023, decouple_loss:0.007158995606005192
The generated pressure mean: 0.44872400164604187
loss_pred:0.01936640776693821, decouple_loss:0.007149942219257355
The generated pressure mean: 0.4482167959213257
loss_pred:0.020538320764899254, decouple_loss:0.00733530055731535
Iteration: 2249, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4476039707660675
loss_pred:0.01914253830909729, decouple_loss:0.006574368569999933
The generated pressure mean: 0.4484662413597107
loss_pred:0.019861070439219475, decouple_loss:0.006548650097101927
The generated pressure mean: 0.447664350271225
loss_pred:0.021463481709361076, decouple_loss:0.00660990085452795
Iteration: 2250, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4477507174015045
loss_pred:0.021974191069602966, decouple_loss:0.007083099335432053
The generated pressure mean: 0.44824087619781494
The generated pressure mean: 0.44846776127815247
loss_pred:0.02107388898730278, decouple_loss:0.007035686168819666
loss_pred:0.021298903971910477, decouple_loss:0.007035708520561457
2023-04-16 09:39:38 testing...
The generated pressure mean: 0.4495830535888672
The generated pressure mean: 0.4497888684272766
The generated pressure mean: 0.44987666606903076
loss_pred:0.027370164170861244, decouple_loss:0.007636603433638811
loss_pred:0.028580661863088608, decouple_loss:0.007715215440839529
loss_pred:0.02722734585404396, decouple_loss:0.007768119685351849
Loss: 0.02811139076948166, avg_mse: 0.03677584230899811
current test mse: 0.036776
Iteration: 2251, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44861480593681335
loss_pred:0.019992634654045105, decouple_loss:0.007668137084692717
The generated pressure mean: 0.4505738615989685
loss_pred:0.02055436000227928, decouple_loss:0.007696939166635275
The generated pressure mean: 0.44679588079452515
loss_pred:0.02015971578657627, decouple_loss:0.007997702807188034
Iteration: 2252, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4480161666870117
loss_pred:0.018978428095579147, decouple_loss:0.007923541590571404
The generated pressure mean: 0.44889312982559204
loss_pred:0.020252326503396034, decouple_loss:0.00792668666690588
The generated pressure mean: 0.4476427733898163
loss_pred:0.021590355783700943, decouple_loss:0.008060161955654621
Iteration: 2253, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4489436149597168
loss_pred:0.01977372355759144, decouple_loss:0.007872416637837887
The generated pressure mean: 0.4489864110946655
loss_pred:0.019956262782216072, decouple_loss:0.007830947637557983
The generated pressure mean: 0.448375940322876
loss_pred:0.019741607829928398, decouple_loss:0.007479352876543999
Iteration: 2254, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44833943247795105
loss_pred:0.020913586020469666, decouple_loss:0.007045287638902664
The generated pressure mean: 0.44887322187423706
loss_pred:0.02120239846408367, decouple_loss:0.00694300327450037
The generated pressure mean: 0.4488052427768707
loss_pred:0.020141301676630974, decouple_loss:0.007053411565721035
Iteration: 2255, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4493597745895386
loss_pred:0.020598305389285088, decouple_loss:0.0070816464722156525
The generated pressure mean: 0.44936540722846985
loss_pred:0.02123575285077095, decouple_loss:0.007045374251902103
The generated pressure mean: 0.4486350119113922
loss_pred:0.020013924688100815, decouple_loss:0.007153436075896025
Iteration: 2256, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44843611121177673
The generated pressure mean: 0.44884786009788513
loss_pred:0.01999295875430107, decouple_loss:0.007666972931474447
loss_pred:0.019386878237128258, decouple_loss:0.007624374702572823
The generated pressure mean: 0.4480254054069519
loss_pred:0.02014775387942791, decouple_loss:0.00758214620873332
Iteration: 2257, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4481566250324249
The generated pressure mean: 0.44854146242141724
loss_pred:0.019655371084809303, decouple_loss:0.008500671945512295
loss_pred:0.021296316757798195, decouple_loss:0.008511152118444443
The generated pressure mean: 0.4477349817752838
loss_pred:0.021261636167764664, decouple_loss:0.008716344833374023
Iteration: 2258, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44821345806121826
loss_pred:0.020603163167834282, decouple_loss:0.0073149362578988075
The generated pressure mean: 0.4474274516105652
loss_pred:0.021628599613904953, decouple_loss:0.007542372681200504
The generated pressure mean: 0.44841331243515015
loss_pred:0.019785935059189796, decouple_loss:0.007222193293273449
Iteration: 2259, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4497413635253906
loss_pred:0.021892210468649864, decouple_loss:0.007404780481010675
The generated pressure mean: 0.4472508132457733
loss_pred:0.02009749412536621, decouple_loss:0.007437472231686115
The generated pressure mean: 0.449165403842926
loss_pred:0.020117247477173805, decouple_loss:0.007552861701697111
Iteration: 2260, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4470297396183014
The generated pressure mean: 0.44775041937828064
loss_pred:0.019957832992076874, decouple_loss:0.007845556363463402
loss_pred:0.020086225122213364, decouple_loss:0.008020006120204926
The generated pressure mean: 0.4493885636329651
loss_pred:0.022198237478733063, decouple_loss:0.007937842980027199
2023-04-16 09:41:32 testing...
The generated pressure mean: 0.4495830535888672
The generated pressure mean: 0.4497888684272766
The generated pressure mean: 0.44987666606903076
loss_pred:0.02824798785150051, decouple_loss:0.008641182444989681
loss_pred:0.029075780883431435, decouple_loss:0.008610320277512074
loss_pred:0.02782626636326313, decouple_loss:0.008627274073660374
Loss: 0.028814658522605896, avg_mse: 0.03799111396074295
current test mse: 0.037991
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012002_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012002_3_24hr.npz
NaN value num: 0
Iteration: 2261, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44828417897224426
loss_pred:0.021059200167655945, decouple_loss:0.008697551675140858
The generated pressure mean: 0.44720014929771423
loss_pred:0.020791467279195786, decouple_loss:0.008949680253863335
The generated pressure mean: 0.44710928201675415
loss_pred:0.020235566422343254, decouple_loss:0.008607114665210247
Iteration: 2262, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44786348938941956The generated pressure mean: 0.44587817788124084
loss_pred:0.018707631155848503, decouple_loss:0.00690052704885602
loss_pred:0.019595922902226448, decouple_loss:0.006944491062313318
The generated pressure mean: 0.4470151662826538
loss_pred:0.020882802084088326, decouple_loss:0.006930873729288578
Iteration: 2263, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4477178752422333
The generated pressure mean: 0.4469371438026428
loss_pred:0.021372945979237556, decouple_loss:0.007015735376626253
loss_pred:0.020860925316810608, decouple_loss:0.006842273287475109
The generated pressure mean: 0.4485968351364136
loss_pred:0.020083479583263397, decouple_loss:0.006827610544860363
Iteration: 2264, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4462679922580719
The generated pressure mean: 0.44501036405563354
loss_pred:0.020853977650403976, decouple_loss:0.007143530994653702
loss_pred:0.020409828051924706, decouple_loss:0.007275148760527372
The generated pressure mean: 0.4462986886501312
loss_pred:0.023908980190753937, decouple_loss:0.007006570231169462
Iteration: 2265, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4469771385192871
The generated pressure mean: 0.4459763467311859
loss_pred:0.021704282611608505, decouple_loss:0.007778787054121494
loss_pred:0.02040562592446804, decouple_loss:0.007922712713479996
The generated pressure mean: 0.44810187816619873
loss_pred:0.020622873678803444, decouple_loss:0.007771908771246672
Iteration: 2266, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4466274380683899
The generated pressure mean: 0.4478619396686554
loss_pred:0.02064358815550804, decouple_loss:0.008050243370234966
loss_pred:0.020434873178601265, decouple_loss:0.008021979592740536
The generated pressure mean: 0.44723257422447205
loss_pred:0.020405899733304977, decouple_loss:0.007860451936721802
Iteration: 2267, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4477289915084839
The generated pressure mean: 0.44722050428390503
loss_pred:0.020554862916469574, decouple_loss:0.006780712865293026
loss_pred:0.020268626511096954, decouple_loss:0.006989050656557083
The generated pressure mean: 0.44669926166534424
loss_pred:0.019572632387280464, decouple_loss:0.006889152806252241
Iteration: 2268, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44660383462905884
The generated pressure mean: 0.4455787241458893
loss_pred:0.020384451374411583, decouple_loss:0.007082547526806593
loss_pred:0.02174864336848259, decouple_loss:0.007031213492155075
The generated pressure mean: 0.4478778541088104
loss_pred:0.019135817885398865, decouple_loss:0.0069772787392139435
Iteration: 2269, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4472739100456238
The generated pressure mean: 0.44646063446998596
loss_pred:0.023883303627371788, decouple_loss:0.007197547238320112
loss_pred:0.022943541407585144, decouple_loss:0.007300947792828083
The generated pressure mean: 0.4455007314682007
loss_pred:0.020557759329676628, decouple_loss:0.007455610670149326
Iteration: 2270, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44760170578956604
loss_pred:0.020051857456564903, decouple_loss:0.007372117601335049
The generated pressure mean: 0.44644808769226074
loss_pred:0.01915035955607891, decouple_loss:0.007327534724026918
The generated pressure mean: 0.4464516043663025
loss_pred:0.02183639071881771, decouple_loss:0.007542639505118132
2023-04-16 09:44:01 testing...
The generated pressure mean: 0.4495830833911896
The generated pressure mean: 0.4497888684272766
The generated pressure mean: 0.44987666606903076
loss_pred:0.028251199051737785, decouple_loss:0.008883826434612274
loss_pred:0.029360562562942505, decouple_loss:0.008791891857981682
loss_pred:0.027956761419773102, decouple_loss:0.00893405918031931
Loss: 0.02896633744239807, avg_mse: 0.03819328173995018
current test mse: 0.038193
Iteration: 2271, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4475288987159729
The generated pressure mean: 0.4481351971626282
loss_pred:0.021788720041513443, decouple_loss:0.008790086023509502
loss_pred:0.020103272050619125, decouple_loss:0.00875403918325901
The generated pressure mean: 0.4474099576473236
loss_pred:0.020690172910690308, decouple_loss:0.009076012298464775
Iteration: 2272, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44713258743286133
loss_pred:0.02118746191263199, decouple_loss:0.007622301112860441
The generated pressure mean: 0.4464872479438782
loss_pred:0.01927388459444046, decouple_loss:0.007459805812686682
The generated pressure mean: 0.44721493124961853
loss_pred:0.020199667662382126, decouple_loss:0.007488505449146032
Iteration: 2273, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44796085357666016
The generated pressure mean: 0.447457492351532
loss_pred:0.020255498588085175, decouple_loss:0.008170594461262226
loss_pred:0.021498320624232292, decouple_loss:0.008370059542357922
The generated pressure mean: 0.4458503723144531
loss_pred:0.02045409381389618, decouple_loss:0.008225752972066402
Iteration: 2274, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4466102421283722
loss_pred:0.018964292481541634, decouple_loss:0.007725503761321306
The generated pressure mean: 0.4474528431892395
loss_pred:0.01967017725110054, decouple_loss:0.0075432313606143
The generated pressure mean: 0.44668105244636536
loss_pred:0.02146664634346962, decouple_loss:0.007357774768024683
Iteration: 2275, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44691744446754456
The generated pressure mean: 0.44681262969970703
loss_pred:0.020009934902191162, decouple_loss:0.007426746189594269
loss_pred:0.020773055031895638, decouple_loss:0.007289022672921419
The generated pressure mean: 0.445803701877594
loss_pred:0.021164536476135254, decouple_loss:0.007566206622868776
Iteration: 2276, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44654643535614014
loss_pred:0.021037224680185318, decouple_loss:0.006403739098459482
The generated pressure mean: 0.44668179750442505
loss_pred:0.02035209722816944, decouple_loss:0.0065414803102612495
The generated pressure mean: 0.44790756702423096
loss_pred:0.020297454670071602, decouple_loss:0.006340560503304005
Iteration: 2277, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4484007954597473
The generated pressure mean: 0.44696521759033203
loss_pred:0.02078212983906269, decouple_loss:0.00742036709561944
loss_pred:0.02062218263745308, decouple_loss:0.007480451371520758
The generated pressure mean: 0.4485483765602112
loss_pred:0.0203574039041996, decouple_loss:0.00736280856654048
Iteration: 2278, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44754672050476074
loss_pred:0.018141500651836395, decouple_loss:0.006858395412564278
The generated pressure mean: 0.44727280735969543
loss_pred:0.019338533282279968, decouple_loss:0.0066405851393938065
The generated pressure mean: 0.44673675298690796
loss_pred:0.020729362964630127, decouple_loss:0.0066153183579444885
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 2279, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44632357358932495
loss_pred:0.019816624000668526, decouple_loss:0.0066012851893901825
The generated pressure mean: 0.44622603058815
loss_pred:0.019745752215385437, decouple_loss:0.006757315713912249
The generated pressure mean: 0.4490334689617157
loss_pred:0.020651428028941154, decouple_loss:0.006655383855104446
Iteration: 2280, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44642341136932373
The generated pressure mean: 0.44497737288475037
loss_pred:0.020907314494252205, decouple_loss:0.007125453557819128
loss_pred:0.020802080631256104, decouple_loss:0.0073640127666294575
The generated pressure mean: 0.44610586762428284
loss_pred:0.0200942475348711, decouple_loss:0.007256379351019859
2023-04-16 09:45:55 testing...
The generated pressure mean: 0.449788898229599
The generated pressure mean: 0.4495830833911896
The generated pressure mean: 0.44987666606903076
loss_pred:0.028277050703763962, decouple_loss:0.007722501643002033
loss_pred:0.027331355959177017, decouple_loss:0.007698662579059601
loss_pred:0.027005774900317192, decouple_loss:0.007717156317085028
Loss: 0.027923699468374252, avg_mse: 0.036412544548511505
current test mse: 0.036413
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012007_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012007_3_24hr.npz
NaN value num: 0
Iteration: 2281, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44617778062820435
loss_pred:0.02204469032585621, decouple_loss:0.007692045532166958
The generated pressure mean: 0.44891947507858276
The generated pressure mean: 0.44881513714790344
loss_pred:0.022765271365642548, decouple_loss:0.008285810239613056
loss_pred:0.019665637984871864, decouple_loss:0.007892483845353127
Iteration: 2282, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.447005033493042
The generated pressure mean: 0.4468880593776703
loss_pred:0.020572636276483536, decouple_loss:0.007485381327569485
loss_pred:0.020173372700810432, decouple_loss:0.007413952611386776
The generated pressure mean: 0.4491856098175049
loss_pred:0.019672807306051254, decouple_loss:0.0073446123860776424
Iteration: 2283, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4461434781551361
The generated pressure mean: 0.4494439363479614
loss_pred:0.01978583261370659, decouple_loss:0.0067990305833518505
loss_pred:0.019947031512856483, decouple_loss:0.006947335321456194
The generated pressure mean: 0.4479919672012329
loss_pred:0.01910344697535038, decouple_loss:0.006749983411282301
Iteration: 2284, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44707077741622925
loss_pred:0.02016807347536087, decouple_loss:0.0066446769051253796
The generated pressure mean: 0.4466298222541809
loss_pred:0.020617593079805374, decouple_loss:0.006715003401041031
The generated pressure mean: 0.4477846324443817
loss_pred:0.020493045449256897, decouple_loss:0.006639827974140644
Iteration: 2285, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4500880539417267
loss_pred:0.020072821527719498, decouple_loss:0.007224085740745068
The generated pressure mean: 0.44793441891670227
loss_pred:0.020954163745045662, decouple_loss:0.007117129862308502
The generated pressure mean: 0.4474042057991028
loss_pred:0.020303796976804733, decouple_loss:0.007169186137616634
Iteration: 2286, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44821897149086
loss_pred:0.021446729078888893, decouple_loss:0.006934890523552895
The generated pressure mean: 0.4501623511314392
loss_pred:0.018697328865528107, decouple_loss:0.007201118394732475
The generated pressure mean: 0.4482154846191406
loss_pred:0.019660132005810738, decouple_loss:0.006948734633624554
Iteration: 2287, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4472527801990509
loss_pred:0.021793421357870102, decouple_loss:0.0066795144230127335
The generated pressure mean: 0.4484303593635559
loss_pred:0.01991460844874382, decouple_loss:0.006489071063697338
The generated pressure mean: 0.4468289613723755
loss_pred:0.019092656672000885, decouple_loss:0.00681182648986578
Iteration: 2288, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44784075021743774
loss_pred:0.0208867359906435, decouple_loss:0.0068974364548921585
The generated pressure mean: 0.4474222660064697
loss_pred:0.0190265029668808, decouple_loss:0.006904544774442911
The generated pressure mean: 0.4477677047252655
loss_pred:0.019519638270139694, decouple_loss:0.006778237409889698
Iteration: 2289, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44800320267677307
loss_pred:0.019496232271194458, decouple_loss:0.007500652689486742
The generated pressure mean: 0.4483945965766907
loss_pred:0.01995638757944107, decouple_loss:0.007477723527699709
The generated pressure mean: 0.44856446981430054
loss_pred:0.019567040726542473, decouple_loss:0.007616071496158838
Iteration: 2290, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4475768506526947
loss_pred:0.020659713074564934, decouple_loss:0.006841748021543026
The generated pressure mean: 0.447710245847702
loss_pred:0.020296642556786537, decouple_loss:0.006840623449534178
The generated pressure mean: 0.4471322298049927
loss_pred:0.019600089639425278, decouple_loss:0.007006156723946333
2023-04-16 09:48:27 testing...
The generated pressure mean: 0.4495830535888672
The generated pressure mean: 0.4497888684272766
The generated pressure mean: 0.44987666606903076
loss_pred:0.027710964903235435, decouple_loss:0.00721721863374114
loss_pred:0.028524503111839294, decouple_loss:0.007362676318734884
loss_pred:0.027502819895744324, decouple_loss:0.007358227390795946
Loss: 0.028278399258852005, avg_mse: 0.03719840943813324
current test mse: 0.037198
Iteration: 2291, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44812512397766113
loss_pred:0.020558683201670647, decouple_loss:0.007181864697486162
The generated pressure mean: 0.4476761221885681
loss_pred:0.021336624398827553, decouple_loss:0.007161516696214676
The generated pressure mean: 0.4458834230899811
loss_pred:0.01963188126683235, decouple_loss:0.007371788844466209
Iteration: 2292, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4485395848751068
loss_pred:0.019653771072626114, decouple_loss:0.007009343709796667
The generated pressure mean: 0.4482412040233612
loss_pred:0.020055104047060013, decouple_loss:0.006988858804106712
The generated pressure mean: 0.4466460347175598
loss_pred:0.019703250378370285, decouple_loss:0.0069656409323215485
Iteration: 2293, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4495560824871063
loss_pred:0.020817577838897705, decouple_loss:0.006551037076860666
The generated pressure mean: 0.447837769985199
loss_pred:0.02182234264910221, decouple_loss:0.006630856543779373
The generated pressure mean: 0.4483628273010254
loss_pred:0.020588476210832596, decouple_loss:0.00659423740580678
Iteration: 2294, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44795140624046326
loss_pred:0.01926199346780777, decouple_loss:0.006960370112210512
The generated pressure mean: 0.4482479691505432
loss_pred:0.02187991701066494, decouple_loss:0.0069852471351623535
The generated pressure mean: 0.44678202271461487
loss_pred:0.021688928827643394, decouple_loss:0.007146237883716822
Iteration: 2295, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4492429792881012
loss_pred:0.01941404864192009, decouple_loss:0.0076588974334299564
The generated pressure mean: 0.4483294188976288
loss_pred:0.020833820104599, decouple_loss:0.007337362505495548
The generated pressure mean: 0.4480734169483185
loss_pred:0.02157627046108246, decouple_loss:0.0077036116272211075
Iteration: 2296, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4475352168083191
loss_pred:0.021912826225161552, decouple_loss:0.007409869693219662
The generated pressure mean: 0.4471645653247833
loss_pred:0.020213885232806206, decouple_loss:0.007169738411903381
The generated pressure mean: 0.4468555450439453
loss_pred:0.019846368581056595, decouple_loss:0.00707471976056695
Iteration: 2297, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44762858748435974
loss_pred:0.019964586943387985, decouple_loss:0.006853417493402958
The generated pressure mean: 0.44970178604125977
loss_pred:0.019080111756920815, decouple_loss:0.006776940543204546
The generated pressure mean: 0.44705531001091003
loss_pred:0.019958477467298508, decouple_loss:0.006926730275154114
Iteration: 2298, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44702863693237305
loss_pred:0.019225208088755608, decouple_loss:0.0069658816792070866
The generated pressure mean: 0.44904136657714844
loss_pred:0.020525755360722542, decouple_loss:0.0069882930256426334
The generated pressure mean: 0.4469155967235565
loss_pred:0.019954754039645195, decouple_loss:0.007102832198143005
Iteration: 2299, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4477187395095825
loss_pred:0.020049508661031723, decouple_loss:0.006802157498896122
The generated pressure mean: 0.448089063167572
loss_pred:0.019454350695014, decouple_loss:0.007014285773038864
The generated pressure mean: 0.446414589881897
loss_pred:0.01898866891860962, decouple_loss:0.007036326918751001
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 2300, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4480353891849518
loss_pred:0.020655591040849686, decouple_loss:0.006537339650094509
The generated pressure mean: 0.4475904405117035
loss_pred:0.021013906225562096, decouple_loss:0.006632696837186813
The generated pressure mean: 0.44852301478385925
loss_pred:0.0190510842949152, decouple_loss:0.006503177806735039
2023-04-16 09:50:21 testing...
The generated pressure mean: 0.4495830535888672
The generated pressure mean: 0.4497888684272766
The generated pressure mean: 0.44987666606903076
loss_pred:0.02806122414767742, decouple_loss:0.006902031134814024
loss_pred:0.028851445764303207, decouple_loss:0.006983282510191202
loss_pred:0.027758479118347168, decouple_loss:0.006867242511361837
Loss: 0.028569594025611877, avg_mse: 0.03779952973127365
current test mse: 0.0378
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012015_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012015_3_24hr.npz
NaN value num: 0
Iteration: 2301, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4483889639377594
loss_pred:0.023727523162961006, decouple_loss:0.007054847199469805
The generated pressure mean: 0.44746753573417664
loss_pred:0.023382095620036125, decouple_loss:0.007251689210534096
The generated pressure mean: 0.4475595951080322
loss_pred:0.020391425117850304, decouple_loss:0.006993286777287722
Iteration: 2302, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4463588297367096
loss_pred:0.02127699926495552, decouple_loss:0.006336850579828024
The generated pressure mean: 0.44764211773872375
The generated pressure mean: 0.4480283856391907
loss_pred:0.02049095556139946, decouple_loss:0.006540723145008087
loss_pred:0.02159014344215393, decouple_loss:0.006552961189299822
Iteration: 2303, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4486062824726105
loss_pred:0.02029081992805004, decouple_loss:0.007287398912012577
The generated pressure mean: 0.4474680721759796The generated pressure mean: 0.44778886437416077
loss_pred:0.02046388015151024, decouple_loss:0.007251535076647997
loss_pred:0.020884772762656212, decouple_loss:0.007486066780984402
Iteration: 2304, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44732341170310974
loss_pred:0.021572062745690346, decouple_loss:0.006833880208432674
The generated pressure mean: 0.4484618008136749
The generated pressure mean: 0.44882652163505554
loss_pred:0.02146505005657673, decouple_loss:0.007001536898314953
loss_pred:0.02199641615152359, decouple_loss:0.007021429017186165
Iteration: 2305, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.447185218334198
loss_pred:0.021913515403866768, decouple_loss:0.0071246507577598095
The generated pressure mean: 0.44903576374053955
The generated pressure mean: 0.4480310380458832loss_pred:0.019954955205321312, decouple_loss:0.007092044688761234
loss_pred:0.01998954266309738, decouple_loss:0.007010424975305796
Iteration: 2306, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44597387313842773
loss_pred:0.02184646762907505, decouple_loss:0.009065135382115841
The generated pressure mean: 0.4479629695415497
The generated pressure mean: 0.44818437099456787
loss_pred:0.021251792088150978, decouple_loss:0.009177821688354015
loss_pred:0.02014051377773285, decouple_loss:0.009058102034032345
Iteration: 2307, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4463062286376953
loss_pred:0.02176094613969326, decouple_loss:0.007908260449767113
The generated pressure mean: 0.4484155476093292
The generated pressure mean: 0.4471625089645386
loss_pred:0.020758669823408127, decouple_loss:0.008183224126696587
loss_pred:0.02280847355723381, decouple_loss:0.007840696722269058
Iteration: 2308, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4485549032688141
loss_pred:0.020791415125131607, decouple_loss:0.0069040171802043915
The generated pressure mean: 0.4474125802516937
loss_pred:0.020948203280568123, decouple_loss:0.006845630239695311
The generated pressure mean: 0.4459594190120697
loss_pred:0.021264947950839996, decouple_loss:0.006771443877369165
Iteration: 2309, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4482065737247467
loss_pred:0.021668825298547745, decouple_loss:0.006823653820902109
The generated pressure mean: 0.44597193598747253
The generated pressure mean: 0.44821879267692566
loss_pred:0.020790858194231987, decouple_loss:0.006920800544321537
loss_pred:0.021324951201677322, decouple_loss:0.006821869406849146
Iteration: 2310, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4484703838825226
loss_pred:0.021685035899281502, decouple_loss:0.008481862023472786
The generated pressure mean: 0.44798973202705383
The generated pressure mean: 0.4474603533744812loss_pred:0.0224764421582222, decouple_loss:0.008224648423492908
loss_pred:0.02195223607122898, decouple_loss:0.008294956758618355
2023-04-16 09:52:53 testing...
The generated pressure mean: 0.449788898229599
The generated pressure mean: 0.4495830833911896
The generated pressure mean: 0.44987666606903076
loss_pred:0.02926480956375599, decouple_loss:0.007919127121567726
loss_pred:0.028235040605068207, decouple_loss:0.00799159798771143
loss_pred:0.02810433879494667, decouple_loss:0.008039101026952267
Loss: 0.028933893889188766, avg_mse: 0.03837020695209503
current test mse: 0.03837
Iteration: 2311, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44762107729911804
loss_pred:0.020449072122573853, decouple_loss:0.007970279082655907
The generated pressure mean: 0.44937098026275635
loss_pred:0.02234390750527382, decouple_loss:0.00808814074844122
The generated pressure mean: 0.44835665822029114
loss_pred:0.02136005088686943, decouple_loss:0.007877099327743053
Iteration: 2312, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44716429710388184
loss_pred:0.02075309120118618, decouple_loss:0.0068052224814891815
The generated pressure mean: 0.4477037489414215
The generated pressure mean: 0.4481884241104126
loss_pred:0.020479673519730568, decouple_loss:0.006804426200687885
loss_pred:0.020400622859597206, decouple_loss:0.006889466196298599
Iteration: 2313, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4487364590167999
loss_pred:0.022649608552455902, decouple_loss:0.007040789350867271
The generated pressure mean: 0.4489551782608032
loss_pred:0.020544521510601044, decouple_loss:0.006859139539301395
The generated pressure mean: 0.4477511942386627
loss_pred:0.019724329933524132, decouple_loss:0.006971839815378189
Iteration: 2314, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4475625157356262
loss_pred:0.020341387018561363, decouple_loss:0.007218442391604185
The generated pressure mean: 0.4453616142272949
The generated pressure mean: 0.4485762417316437
loss_pred:0.021274302154779434, decouple_loss:0.0071919746696949005
loss_pred:0.021208245307207108, decouple_loss:0.007184255868196487
Iteration: 2315, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44719794392585754
loss_pred:0.021251419559121132, decouple_loss:0.007538715377449989
The generated pressure mean: 0.44779130816459656
The generated pressure mean: 0.4490232765674591
loss_pred:0.02060498669743538, decouple_loss:0.007646328303962946
loss_pred:0.022570589557290077, decouple_loss:0.007694833911955357
Iteration: 2316, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44793835282325745
loss_pred:0.020049920305609703, decouple_loss:0.0070977117866277695
The generated pressure mean: 0.44919610023498535
loss_pred:0.022914286702871323, decouple_loss:0.007236683275550604
The generated pressure mean: 0.4484391212463379
loss_pred:0.02073289081454277, decouple_loss:0.007123301271349192
Iteration: 2317, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44729089736938477
The generated pressure mean: 0.44896137714385986
The generated pressure mean: 0.4471014738082886
loss_pred:0.02133568748831749, decouple_loss:0.008405405096709728
loss_pred:0.022763686254620552, decouple_loss:0.008570683188736439
loss_pred:0.022186461836099625, decouple_loss:0.008330591954290867
Iteration: 2318, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.445667028427124
loss_pred:0.021317677572369576, decouple_loss:0.007823573425412178
The generated pressure mean: 0.4479886591434479
loss_pred:0.021134711802005768, decouple_loss:0.007354507688432932
The generated pressure mean: 0.4468974173069
loss_pred:0.022268151864409447, decouple_loss:0.007555428892374039
Iteration: 2319, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4482795298099518
loss_pred:0.021156921982765198, decouple_loss:0.007236127275973558
The generated pressure mean: 0.4475211799144745
loss_pred:0.020832844078540802, decouple_loss:0.0069006215780973434
The generated pressure mean: 0.4472449719905853
loss_pred:0.023484908044338226, decouple_loss:0.007022800389677286
Iteration: 2320, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4471522867679596
loss_pred:0.020539911463856697, decouple_loss:0.008566646836698055
The generated pressure mean: 0.448258638381958
loss_pred:0.022295145317912102, decouple_loss:0.008685773238539696
The generated pressure mean: 0.44641435146331787
loss_pred:0.020795457065105438, decouple_loss:0.008858060464262962
2023-04-16 09:54:47 testing...
The generated pressure mean: 0.4495830833911896
The generated pressure mean: 0.4497888684272766
The generated pressure mean: 0.44987666606903076
loss_pred:0.029179256409406662, decouple_loss:0.00838245265185833
loss_pred:0.03038043901324272, decouple_loss:0.008665023371577263
loss_pred:0.029145995154976845, decouple_loss:0.008375081233680248
Loss: 0.029992273077368736, avg_mse: 0.040434036403894424
current test mse: 0.040434
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012014_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012014_3_24hr.npz
NaN value num: 0
Iteration: 2321, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4472518563270569
loss_pred:0.021109608933329582, decouple_loss:0.008685523644089699
The generated pressure mean: 0.44621577858924866
The generated pressure mean: 0.4470368027687073
loss_pred:0.020360998809337616, decouple_loss:0.008605129085481167
loss_pred:0.020780926570296288, decouple_loss:0.008419259451329708
Iteration: 2322, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4452938735485077
The generated pressure mean: 0.4465043246746063
loss_pred:0.021398896351456642, decouple_loss:0.007540768478065729
loss_pred:0.022497108206152916, decouple_loss:0.0075184619054198265
The generated pressure mean: 0.4475099444389343
loss_pred:0.020223913714289665, decouple_loss:0.0075686341151595116
Iteration: 2323, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4465339481830597
The generated pressure mean: 0.44605615735054016
loss_pred:0.020113540813326836, decouple_loss:0.0075667854398489
loss_pred:0.020581772550940514, decouple_loss:0.007553307805210352
The generated pressure mean: 0.4458337724208832
loss_pred:0.022131212055683136, decouple_loss:0.00792385172098875
Iteration: 2324, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44759777188301086
loss_pred:0.021921399980783463, decouple_loss:0.00826120376586914
The generated pressure mean: 0.4459228217601776
The generated pressure mean: 0.44583749771118164loss_pred:0.02196027711033821, decouple_loss:0.008226594887673855
loss_pred:0.020804069936275482, decouple_loss:0.008259707130491734
Iteration: 2325, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44665440917015076
The generated pressure mean: 0.4459230303764343
loss_pred:0.0207940973341465, decouple_loss:0.008409623056650162
loss_pred:0.01991356536746025, decouple_loss:0.00836210511624813
The generated pressure mean: 0.44623327255249023
loss_pred:0.02092585526406765, decouple_loss:0.008355822414159775
Iteration: 2326, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4474382996559143
The generated pressure mean: 0.4464617967605591
loss_pred:0.02033698558807373, decouple_loss:0.0075944578275084496
loss_pred:0.022824512794613838, decouple_loss:0.0076798610389232635
The generated pressure mean: 0.44548192620277405
loss_pred:0.020863479003310204, decouple_loss:0.0076445783488452435
Iteration: 2327, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44718873500823975
The generated pressure mean: 0.44656628370285034
loss_pred:0.020497389137744904, decouple_loss:0.007026965264230967
loss_pred:0.02049594558775425, decouple_loss:0.006984169129282236
The generated pressure mean: 0.4466250538825989
loss_pred:0.02155381254851818, decouple_loss:0.007087090518325567
Iteration: 2328, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44631731510162354
loss_pred:0.022720057517290115, decouple_loss:0.007956580258905888
The generated pressure mean: 0.44619378447532654
The generated pressure mean: 0.44677507877349854
loss_pred:0.020945632830262184, decouple_loss:0.008052317425608635
loss_pred:0.02073860727250576, decouple_loss:0.0080685680732131
Iteration: 2329, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44761812686920166
loss_pred:0.0210155937820673, decouple_loss:0.007872333750128746
The generated pressure mean: 0.4462284743785858
loss_pred:0.021000586450099945, decouple_loss:0.007931889034807682
The generated pressure mean: 0.4465370178222656
loss_pred:0.019853973761200905, decouple_loss:0.007916262373328209
Iteration: 2330, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4480520784854889
The generated pressure mean: 0.4465695321559906
loss_pred:0.020807482302188873, decouple_loss:0.007363525684922934
loss_pred:0.020221306011080742, decouple_loss:0.007396826054900885
The generated pressure mean: 0.44601970911026
loss_pred:0.02031317725777626, decouple_loss:0.007065335288643837
2023-04-16 09:57:16 testing...
The generated pressure mean: 0.449788898229599
The generated pressure mean: 0.4495830833911896
The generated pressure mean: 0.44987666606903076
loss_pred:0.02837274968624115, decouple_loss:0.00703066773712635
loss_pred:0.02725706435739994, decouple_loss:0.007038772571831942
loss_pred:0.027065780013799667, decouple_loss:0.007067611441016197
Loss: 0.02791748195886612, avg_mse: 0.0366191565990448
current test mse: 0.036619
Iteration: 2331, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44669991731643677
The generated pressure mean: 0.44761884212493896
loss_pred:0.022855574265122414, decouple_loss:0.006850858684629202
loss_pred:0.02185608632862568, decouple_loss:0.007127692457288504
The generated pressure mean: 0.44607147574424744
loss_pred:0.020391011610627174, decouple_loss:0.006989085581153631
Iteration: 2332, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44689762592315674
loss_pred:0.021487616002559662, decouple_loss:0.007553915958851576
The generated pressure mean: 0.4464482367038727
loss_pred:0.019927872344851494, decouple_loss:0.007409772835671902
The generated pressure mean: 0.44840914011001587
loss_pred:0.020934997126460075, decouple_loss:0.0074485596269369125
Iteration: 2333, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4459005892276764
The generated pressure mean: 0.4474071264266968
loss_pred:0.020879555493593216, decouple_loss:0.0075096492655575275
loss_pred:0.020847754552960396, decouple_loss:0.007568070199340582
The generated pressure mean: 0.4464920163154602
loss_pred:0.02094045840203762, decouple_loss:0.007421406917273998
Iteration: 2334, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4480317533016205
The generated pressure mean: 0.4477819800376892
loss_pred:0.021482665091753006, decouple_loss:0.007310743909329176
loss_pred:0.02219969965517521, decouple_loss:0.00720963254570961
The generated pressure mean: 0.4479432702064514
loss_pred:0.0201968215405941, decouple_loss:0.007106142118573189
Iteration: 2335, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44654616713523865
The generated pressure mean: 0.445599764585495
loss_pred:0.019615869969129562, decouple_loss:0.0074109481647610664
loss_pred:0.019874131307005882, decouple_loss:0.007043259218335152
The generated pressure mean: 0.44647157192230225
loss_pred:0.01990295574069023, decouple_loss:0.007146876771003008
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 2336, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4467596113681793
The generated pressure mean: 0.446450412273407
loss_pred:0.020150180906057358, decouple_loss:0.006779130082577467
loss_pred:0.021586669608950615, decouple_loss:0.006749340798705816
The generated pressure mean: 0.4480176568031311
loss_pred:0.0222741961479187, decouple_loss:0.006731091532856226
Iteration: 2337, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4468311369419098
The generated pressure mean: 0.4457560181617737
loss_pred:0.021489979699254036, decouple_loss:0.006127269007265568
loss_pred:0.02084590308368206, decouple_loss:0.006168791558593512
The generated pressure mean: 0.4462399482727051
loss_pred:0.020780552178621292, decouple_loss:0.0061976611614227295
Iteration: 2338, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4478432238101959
The generated pressure mean: 0.4469756782054901
loss_pred:0.02171947993338108, decouple_loss:0.0068178302608430386
loss_pred:0.019837813451886177, decouple_loss:0.006753236521035433
The generated pressure mean: 0.44696760177612305
loss_pred:0.021762168034911156, decouple_loss:0.006603338290005922
Iteration: 2339, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4467129707336426
The generated pressure mean: 0.44765180349349976
loss_pred:0.02173001319169998, decouple_loss:0.007047916762530804
loss_pred:0.021909374743700027, decouple_loss:0.006975587923079729
The generated pressure mean: 0.4456821382045746
loss_pred:0.022311348468065262, decouple_loss:0.007087601348757744
Iteration: 2340, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4459546208381653
The generated pressure mean: 0.4473945200443268
loss_pred:0.020177336409687996, decouple_loss:0.0068878591991961
loss_pred:0.019983505830168724, decouple_loss:0.006968808826059103
The generated pressure mean: 0.44727879762649536
loss_pred:0.020861370489001274, decouple_loss:0.006926249247044325
2023-04-16 09:59:11 testing...
The generated pressure mean: 0.4495830535888672
The generated pressure mean: 0.4497888684272766
The generated pressure mean: 0.44987666606903076
loss_pred:0.028212303295731544, decouple_loss:0.007491797674447298
loss_pred:0.028805991634726524, decouple_loss:0.007620110642164946
loss_pred:0.027833206579089165, decouple_loss:0.0075594778172671795
Loss: 0.028661690652370453, avg_mse: 0.038063131272792816
current test mse: 0.038063
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012007_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012007_3_24hr.npz
NaN value num: 0
Iteration: 2341, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44834771752357483
loss_pred:0.0200827494263649, decouple_loss:0.007558239623904228
The generated pressure mean: 0.4473004639148712
loss_pred:0.0196995809674263, decouple_loss:0.007674918510019779
The generated pressure mean: 0.4481548070907593
loss_pred:0.019024252891540527, decouple_loss:0.007574234623461962
Iteration: 2342, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4475187361240387
loss_pred:0.019308948889374733, decouple_loss:0.006979641504585743
The generated pressure mean: 0.4485977590084076
loss_pred:0.01922810822725296, decouple_loss:0.0070665255188941956
The generated pressure mean: 0.4483235776424408
loss_pred:0.01823914423584938, decouple_loss:0.007089790888130665
Iteration: 2343, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4483889937400818
loss_pred:0.02010590396821499, decouple_loss:0.006367803085595369
The generated pressure mean: 0.4474695920944214
loss_pred:0.019060460850596428, decouple_loss:0.006472846493124962
The generated pressure mean: 0.44808006286621094
loss_pred:0.019866077229380608, decouple_loss:0.006803637836128473
Iteration: 2344, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44857344031333923
loss_pred:0.02113051898777485, decouple_loss:0.006155647803097963
The generated pressure mean: 0.4476211667060852
loss_pred:0.019512047991156578, decouple_loss:0.006328064948320389
The generated pressure mean: 0.446613073348999
loss_pred:0.02058492787182331, decouple_loss:0.006229006685316563
Iteration: 2345, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44872990250587463
loss_pred:0.018827350810170174, decouple_loss:0.006874728482216597
The generated pressure mean: 0.4481460750102997
loss_pred:0.019825031980872154, decouple_loss:0.006752675864845514
The generated pressure mean: 0.44768163561820984
loss_pred:0.019237451255321503, decouple_loss:0.006949355825781822
Iteration: 2346, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4474526643753052
loss_pred:0.022126395255327225, decouple_loss:0.006856879219412804
The generated pressure mean: 0.4479582905769348
loss_pred:0.01986692287027836, decouple_loss:0.007085268385708332
The generated pressure mean: 0.4484996497631073
loss_pred:0.020086020231246948, decouple_loss:0.007079159840941429
Iteration: 2347, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44796130061149597
loss_pred:0.01946420781314373, decouple_loss:0.006615552119910717
The generated pressure mean: 0.44755682349205017
loss_pred:0.020830262452363968, decouple_loss:0.006585186813026667
The generated pressure mean: 0.4480270743370056
loss_pred:0.01935996674001217, decouple_loss:0.00667524803429842
Iteration: 2348, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.449061781167984
loss_pred:0.019830716773867607, decouple_loss:0.0068146102130413055
The generated pressure mean: 0.44723644852638245
loss_pred:0.021353134885430336, decouple_loss:0.006697218399494886
The generated pressure mean: 0.4487769305706024
loss_pred:0.02008984424173832, decouple_loss:0.006789343431591988
Iteration: 2349, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44711458683013916
loss_pred:0.020148733630776405, decouple_loss:0.0066269137896597385
The generated pressure mean: 0.4477311372756958
loss_pred:0.018531810492277145, decouple_loss:0.006766417529433966
The generated pressure mean: 0.44750353693962097
loss_pred:0.020343327894806862, decouple_loss:0.006769230589270592
Iteration: 2350, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44763848185539246
loss_pred:0.01967901550233364, decouple_loss:0.00704405689612031
The generated pressure mean: 0.44812268018722534
loss_pred:0.019589325413107872, decouple_loss:0.0069774603471159935
The generated pressure mean: 0.4480278789997101
loss_pred:0.019975624978542328, decouple_loss:0.007087939418852329
2023-04-16 10:01:40 testing...
The generated pressure mean: 0.4495830535888672
The generated pressure mean: 0.4497888684272766
The generated pressure mean: 0.44987666606903076
loss_pred:0.0274328775703907, decouple_loss:0.006943920627236366
loss_pred:0.028084641322493553, decouple_loss:0.006978217978030443
loss_pred:0.026888947933912277, decouple_loss:0.006951271090656519
Loss: 0.027816712856292725, avg_mse: 0.036542948335409164
current test mse: 0.036543
Iteration: 2351, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4486527442932129
The generated pressure mean: 0.446932315826416
loss_pred:0.020873654633760452, decouple_loss:0.006879081949591637
loss_pred:0.01919134333729744, decouple_loss:0.0069459774531424046
The generated pressure mean: 0.44817665219306946
loss_pred:0.021814968436956406, decouple_loss:0.007045371923595667
Iteration: 2352, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4479518234729767
The generated pressure mean: 0.44745561480522156
loss_pred:0.018378496170043945, decouple_loss:0.00688235042616725
loss_pred:0.019860025495290756, decouple_loss:0.006851563695818186
The generated pressure mean: 0.44938555359840393
loss_pred:0.02064184844493866, decouple_loss:0.006906846072524786
Iteration: 2353, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4481067359447479
The generated pressure mean: 0.4482242166996002
loss_pred:0.01832582987844944, decouple_loss:0.006834845524281263
loss_pred:0.019498879089951515, decouple_loss:0.006968807894736528
The generated pressure mean: 0.447090744972229
loss_pred:0.0192717295140028, decouple_loss:0.007107949815690517
Iteration: 2354, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44715479016304016
loss_pred:0.020096607506275177, decouple_loss:0.007344045210629702
The generated pressure mean: 0.4473142623901367
loss_pred:0.021419910714030266, decouple_loss:0.007320836186408997
The generated pressure mean: 0.4484992027282715
loss_pred:0.019135771319270134, decouple_loss:0.007365360390394926
Iteration: 2355, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4483753740787506
loss_pred:0.01982480101287365, decouple_loss:0.006549464538693428
The generated pressure mean: 0.4477725327014923
loss_pred:0.019400063902139664, decouple_loss:0.006544061470776796
The generated pressure mean: 0.44729694724082947
loss_pred:0.02042134664952755, decouple_loss:0.0065808724611997604
Iteration: 2356, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.448378324508667
The generated pressure mean: 0.4485163986682892
loss_pred:0.02225261926651001, decouple_loss:0.0067576030269265175
loss_pred:0.02089839056134224, decouple_loss:0.006739486940205097
The generated pressure mean: 0.44725486636161804
loss_pred:0.020935576409101486, decouple_loss:0.006840350106358528
Iteration: 2357, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4472711682319641
The generated pressure mean: 0.44736185669898987
loss_pred:0.020228790119290352, decouple_loss:0.006262010429054499
loss_pred:0.01865622028708458, decouple_loss:0.006229075603187084
The generated pressure mean: 0.4483779966831207
loss_pred:0.01964048482477665, decouple_loss:0.00625486159697175
Iteration: 2358, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44728946685791016
The generated pressure mean: 0.44736239314079285
loss_pred:0.019528497010469437, decouple_loss:0.006511016748845577
loss_pred:0.02145334705710411, decouple_loss:0.006605495698750019
The generated pressure mean: 0.4484296441078186
loss_pred:0.019922330975532532, decouple_loss:0.006567845121026039
Iteration: 2359, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44777804613113403
The generated pressure mean: 0.4490264058113098
loss_pred:0.019680745899677277, decouple_loss:0.00685144355520606
loss_pred:0.019105924293398857, decouple_loss:0.0070241657085716724
The generated pressure mean: 0.44846054911613464
loss_pred:0.02019151672720909, decouple_loss:0.006917070597410202
Iteration: 2360, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44764864444732666
The generated pressure mean: 0.4493151009082794
loss_pred:0.01955411769449711, decouple_loss:0.006895874626934528
loss_pred:0.020611565560102463, decouple_loss:0.006955662742257118
The generated pressure mean: 0.4481242001056671
loss_pred:0.019377106800675392, decouple_loss:0.006916264537721872
2023-04-16 10:03:35 testing...
The generated pressure mean: 0.4495830535888672
The generated pressure mean: 0.449788898229599
The generated pressure mean: 0.44987666606903076
loss_pred:0.028436217457056046, decouple_loss:0.007512144278734922
loss_pred:0.029321644455194473, decouple_loss:0.007557794451713562
loss_pred:0.02821023017168045, decouple_loss:0.007483337540179491
Loss: 0.029031921178102493, avg_mse: 0.03888820484280586
current test mse: 0.038888
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012003_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012003_3_24hr.npz
NaN value num: 0
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 2361, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4495103657245636
loss_pred:0.020331954583525658, decouple_loss:0.00740177882835269
The generated pressure mean: 0.44756534695625305
loss_pred:0.01987280696630478, decouple_loss:0.007507906761020422
The generated pressure mean: 0.4491927921772003
loss_pred:0.019963093101978302, decouple_loss:0.007585602812469006
Iteration: 2362, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4494568407535553
loss_pred:0.019515350461006165, decouple_loss:0.007050205022096634
The generated pressure mean: 0.4484139084815979
loss_pred:0.02184421941637993, decouple_loss:0.006552570033818483
The generated pressure mean: 0.4486084282398224
loss_pred:0.019907768815755844, decouple_loss:0.006862518843263388
Iteration: 2363, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4491872787475586
loss_pred:0.019732333719730377, decouple_loss:0.006756320130079985
The generated pressure mean: 0.4480414390563965
loss_pred:0.02006957121193409, decouple_loss:0.0065924134105443954
The generated pressure mean: 0.4479374587535858
loss_pred:0.02130969800055027, decouple_loss:0.006507107522338629
Iteration: 2364, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4472796618938446
loss_pred:0.02014257200062275, decouple_loss:0.0063117025420069695
The generated pressure mean: 0.44870465993881226
loss_pred:0.019657675176858902, decouple_loss:0.006557428278028965
The generated pressure mean: 0.44741255044937134
loss_pred:0.019848303869366646, decouple_loss:0.006354253739118576
Iteration: 2365, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44750773906707764
loss_pred:0.02040344662964344, decouple_loss:0.007174136582762003
The generated pressure mean: 0.4486619234085083
loss_pred:0.019999999552965164, decouple_loss:0.006793247535824776
The generated pressure mean: 0.4471968710422516
loss_pred:0.021653829142451286, decouple_loss:0.006879547610878944
Iteration: 2366, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4484110474586487
loss_pred:0.020896263420581818, decouple_loss:0.006872511934489012
The generated pressure mean: 0.4473778009414673
loss_pred:0.019602736458182335, decouple_loss:0.006925343070179224
The generated pressure mean: 0.4482533037662506
loss_pred:0.02006879448890686, decouple_loss:0.007047556806355715
Iteration: 2367, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4471077620983124
loss_pred:0.02004539780318737, decouple_loss:0.006351679563522339
The generated pressure mean: 0.4503796696662903
loss_pred:0.020028870552778244, decouple_loss:0.006663920357823372
The generated pressure mean: 0.4485880732536316
loss_pred:0.020133065059781075, decouple_loss:0.006512801628559828
Iteration: 2368, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44874122738838196
loss_pred:0.021431399509310722, decouple_loss:0.00651536975055933
The generated pressure mean: 0.4476041793823242
loss_pred:0.02187895029783249, decouple_loss:0.006489300634711981
The generated pressure mean: 0.4483591914176941
loss_pred:0.020991697907447815, decouple_loss:0.006460644770413637
Iteration: 2369, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44741371273994446
loss_pred:0.020712140947580338, decouple_loss:0.006477048620581627
The generated pressure mean: 0.4478241801261902
loss_pred:0.02204831689596176, decouple_loss:0.006597967818379402
The generated pressure mean: 0.44813817739486694
loss_pred:0.020332638174295425, decouple_loss:0.006580044515430927
Iteration: 2370, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44714847207069397
loss_pred:0.02165760099887848, decouple_loss:0.006550862919539213
The generated pressure mean: 0.4482789933681488
loss_pred:0.02155296877026558, decouple_loss:0.006483258679509163
The generated pressure mean: 0.4472081959247589
loss_pred:0.021062124520540237, decouple_loss:0.006594632752239704
2023-04-16 10:06:14 testing...
The generated pressure mean: 0.4497888684272766
The generated pressure mean: 0.4495830535888672
The generated pressure mean: 0.44987666606903076
loss_pred:0.02819962613284588, decouple_loss:0.007187869865447283
loss_pred:0.027092402800917625, decouple_loss:0.007151657249778509
loss_pred:0.026888323947787285, decouple_loss:0.007075060158967972
Loss: 0.02775036171078682, avg_mse: 0.03637436404824257
current test mse: 0.036374
Iteration: 2371, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44784730672836304
The generated pressure mean: 0.4476287364959717
loss_pred:0.020355695858597755, decouple_loss:0.007019450422376394
loss_pred:0.019803501665592194, decouple_loss:0.007054867688566446
The generated pressure mean: 0.44832953810691833
loss_pred:0.021930931136012077, decouple_loss:0.00691396277397871
Iteration: 2372, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44768255949020386
loss_pred:0.019497506320476532, decouple_loss:0.006124586332589388
The generated pressure mean: 0.44737741351127625
loss_pred:0.019688354805111885, decouple_loss:0.006250593811273575
The generated pressure mean: 0.4480275809764862
loss_pred:0.021028129383921623, decouple_loss:0.006222614552825689
Iteration: 2373, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4484435021877289
The generated pressure mean: 0.4477750062942505
loss_pred:0.020672090351581573, decouple_loss:0.006866946816444397
loss_pred:0.02192254178225994, decouple_loss:0.006977101322263479
The generated pressure mean: 0.44805198907852173
loss_pred:0.01846712827682495, decouple_loss:0.0069565498270094395
Iteration: 2374, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44823116064071655
loss_pred:0.02079027332365513, decouple_loss:0.00798772368580103
The generated pressure mean: 0.44995635747909546
loss_pred:0.019197670742869377, decouple_loss:0.007941240444779396
The generated pressure mean: 0.44828882813453674
loss_pred:0.020994236692786217, decouple_loss:0.007977444678544998
Iteration: 2375, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44860875606536865
loss_pred:0.020127400755882263, decouple_loss:0.007330571301281452
The generated pressure mean: 0.44772952795028687
loss_pred:0.020218368619680405, decouple_loss:0.007432425860315561
The generated pressure mean: 0.44809481501579285
loss_pred:0.019386999309062958, decouple_loss:0.00749436067417264
Iteration: 2376, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4497060775756836
The generated pressure mean: 0.4475441873073578loss_pred:0.01879037357866764, decouple_loss:0.006422565318644047
loss_pred:0.019251978024840355, decouple_loss:0.006228450685739517
The generated pressure mean: 0.44851943850517273
loss_pred:0.019629906862974167, decouple_loss:0.006412904243916273
Iteration: 2377, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44777509570121765
loss_pred:0.020445507019758224, decouple_loss:0.006680297665297985
The generated pressure mean: 0.44785627722740173
loss_pred:0.02073666639626026, decouple_loss:0.0065650297328829765
The generated pressure mean: 0.4484729468822479
loss_pred:0.019379103556275368, decouple_loss:0.0064785173162817955
Iteration: 2378, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44841238856315613
loss_pred:0.02021307870745659, decouple_loss:0.00672072172164917
The generated pressure mean: 0.4473952651023865
loss_pred:0.018748873844742775, decouple_loss:0.006682258099317551
The generated pressure mean: 0.44824662804603577
loss_pred:0.019972430542111397, decouple_loss:0.006743724457919598
Iteration: 2379, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4473389685153961
loss_pred:0.018191959708929062, decouple_loss:0.006415337789803743
The generated pressure mean: 0.44821539521217346
loss_pred:0.021099338307976723, decouple_loss:0.0066073318012058735
The generated pressure mean: 0.4481275677680969
loss_pred:0.01998969539999962, decouple_loss:0.006565629504621029
Iteration: 2380, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44751808047294617
loss_pred:0.020595278590917587, decouple_loss:0.007553488481789827
The generated pressure mean: 0.4471055865287781
loss_pred:0.019962545484304428, decouple_loss:0.00752900168299675
The generated pressure mean: 0.4481653571128845
loss_pred:0.02036770060658455, decouple_loss:0.007733410689979792
2023-04-16 10:08:08 testing...
The generated pressure mean: 0.4495830535888672
The generated pressure mean: 0.449788898229599
The generated pressure mean: 0.44987666606903076
loss_pred:0.027187103405594826, decouple_loss:0.00740371597930789
loss_pred:0.02802731841802597, decouple_loss:0.0073493169620633125
loss_pred:0.026973174884915352, decouple_loss:0.007359128911048174
Loss: 0.027764402329921722, avg_mse: 0.036476071923971176
current test mse: 0.036476
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012013_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012013_3_24hr.npz
NaN value num: 0
Iteration: 2381, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44750797748565674
loss_pred:0.01922263205051422, decouple_loss:0.007542898878455162
The generated pressure mean: 0.44788146018981934
loss_pred:0.01925678737461567, decouple_loss:0.00773235410451889
The generated pressure mean: 0.44681647419929504
loss_pred:0.020041797310113907, decouple_loss:0.007449000608175993
Iteration: 2382, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44691380858421326
The generated pressure mean: 0.448162704706192
loss_pred:0.019942454993724823, decouple_loss:0.006011265330016613
loss_pred:0.019808974117040634, decouple_loss:0.0061190747655928135
The generated pressure mean: 0.44819068908691406
loss_pred:0.019683923572301865, decouple_loss:0.006226910278201103
Iteration: 2383, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4469221234321594The generated pressure mean: 0.4480850398540497
loss_pred:0.019806716591119766, decouple_loss:0.005826652981340885
loss_pred:0.020767446607351303, decouple_loss:0.005964507348835468
The generated pressure mean: 0.44629597663879395
loss_pred:0.02111252397298813, decouple_loss:0.005906638689339161
Iteration: 2384, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44876283407211304
loss_pred:0.02137375995516777, decouple_loss:0.006420020945370197
The generated pressure mean: 0.4472111463546753
loss_pred:0.02094561979174614, decouple_loss:0.0061442735604941845
The generated pressure mean: 0.44889262318611145
loss_pred:0.020255859941244125, decouple_loss:0.006322524975985289
Iteration: 2385, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44677913188934326
The generated pressure mean: 0.44752824306488037
loss_pred:0.02194943092763424, decouple_loss:0.007760155014693737
loss_pred:0.01939670369029045, decouple_loss:0.007554415613412857
The generated pressure mean: 0.4462844133377075
loss_pred:0.020810915157198906, decouple_loss:0.007629132363945246
Iteration: 2386, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4487799406051636
loss_pred:0.018917683511972427, decouple_loss:0.007474780548363924
The generated pressure mean: 0.44627127051353455
loss_pred:0.021621907129883766, decouple_loss:0.007556766737252474
The generated pressure mean: 0.4479925334453583
loss_pred:0.0203248243778944, decouple_loss:0.007597904186695814
Iteration: 2387, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44708892703056335
The generated pressure mean: 0.44692462682724
loss_pred:0.020143430680036545, decouple_loss:0.006878669839352369
loss_pred:0.021116919815540314, decouple_loss:0.006750559434294701
The generated pressure mean: 0.4474467933177948
loss_pred:0.020311223343014717, decouple_loss:0.006848406046628952
Iteration: 2388, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4479955732822418
loss_pred:0.020430322736501694, decouple_loss:0.007341699209064245
The generated pressure mean: 0.44652217626571655
loss_pred:0.020404839888215065, decouple_loss:0.007354521192610264
The generated pressure mean: 0.4478999376296997
loss_pred:0.021794026717543602, decouple_loss:0.007144663482904434
Iteration: 2389, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4474714398384094
The generated pressure mean: 0.4466283321380615
loss_pred:0.021847166121006012, decouple_loss:0.006962787359952927
loss_pred:0.021273965016007423, decouple_loss:0.006970019079744816
The generated pressure mean: 0.4481365978717804
loss_pred:0.021968690678477287, decouple_loss:0.0068492162972688675
Iteration: 2390, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4473112225532532
The generated pressure mean: 0.448482483625412
loss_pred:0.019874073565006256, decouple_loss:0.007624561432749033
loss_pred:0.020249485969543457, decouple_loss:0.007708370219916105
The generated pressure mean: 0.44763094186782837
loss_pred:0.022030942142009735, decouple_loss:0.007713960018008947
2023-04-16 10:10:36 testing...
The generated pressure mean: 0.449788898229599
The generated pressure mean: 0.4495830535888672
The generated pressure mean: 0.44987666606903076
loss_pred:0.029946763068437576, decouple_loss:0.007422207854688168
loss_pred:0.02912278287112713, decouple_loss:0.007391412742435932
loss_pred:0.029259229078888893, decouple_loss:0.007438565604388714
Loss: 0.029813794419169426, avg_mse: 0.04034547880291939
current test mse: 0.040345
Iteration: 2391, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4470463991165161
loss_pred:0.021597295999526978, decouple_loss:0.007404412142932415
The generated pressure mean: 0.44725826382637024
loss_pred:0.020493406802415848, decouple_loss:0.007504113484174013
The generated pressure mean: 0.4468412697315216
loss_pred:0.020656531676650047, decouple_loss:0.007426384836435318
Iteration: 2392, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4467009902000427
loss_pred:0.020422836765646935, decouple_loss:0.007191523443907499
The generated pressure mean: 0.4479988217353821
loss_pred:0.020508185029029846, decouple_loss:0.00696210190653801
The generated pressure mean: 0.4487040936946869
loss_pred:0.021257251501083374, decouple_loss:0.00704792607575655
Iteration: 2393, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4473222494125366
loss_pred:0.01964491233229637, decouple_loss:0.006865165662020445
The generated pressure mean: 0.4477558732032776
loss_pred:0.019902948290109634, decouple_loss:0.006799309514462948
The generated pressure mean: 0.447113960981369
loss_pred:0.019144028425216675, decouple_loss:0.006845641881227493
Iteration: 2394, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4480471909046173
loss_pred:0.01980961300432682, decouple_loss:0.00672859838232398
The generated pressure mean: 0.44784659147262573
loss_pred:0.02010558359324932, decouple_loss:0.006720162462443113
The generated pressure mean: 0.4465150237083435
loss_pred:0.019782502204179764, decouple_loss:0.006875638850033283
Iteration: 2395, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4489162862300873
loss_pred:0.019543837755918503, decouple_loss:0.006605565547943115
The generated pressure mean: 0.4483894109725952
loss_pred:0.02158902771770954, decouple_loss:0.0065348767675459385
The generated pressure mean: 0.44789764285087585
loss_pred:0.020780405029654503, decouple_loss:0.006647426635026932
Iteration: 2396, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4474667012691498
loss_pred:0.019591324031352997, decouple_loss:0.006452647037804127
The generated pressure mean: 0.44779109954833984
loss_pred:0.020450232550501823, decouple_loss:0.006662073079496622
The generated pressure mean: 0.4472711682319641
loss_pred:0.0200661551207304, decouple_loss:0.00662329001352191
Iteration: 2397, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4465497136116028
The generated pressure mean: 0.44742703437805176
loss_pred:0.020191680639982224, decouple_loss:0.006915922276675701
loss_pred:0.021518517285585403, decouple_loss:0.007054972928017378
The generated pressure mean: 0.44776856899261475
loss_pred:0.020044449716806412, decouple_loss:0.007248972076922655
Iteration: 2398, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4482991099357605
loss_pred:0.01979132555425167, decouple_loss:0.008107950910925865
The generated pressure mean: 0.44724029302597046
loss_pred:0.019961507990956306, decouple_loss:0.008088560774922371
The generated pressure mean: 0.44717198610305786
loss_pred:0.02124222181737423, decouple_loss:0.00796225480735302
Iteration: 2399, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44745805859565735
loss_pred:0.019823281094431877, decouple_loss:0.007205125410109758
The generated pressure mean: 0.4470941126346588
loss_pred:0.02108129672706127, decouple_loss:0.007010031025856733
The generated pressure mean: 0.44708651304244995
loss_pred:0.020652903243899345, decouple_loss:0.007043700199574232
Iteration: 2400, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4485373795032501
loss_pred:0.019829239696264267, decouple_loss:0.006650232244282961
The generated pressure mean: 0.446719229221344
loss_pred:0.020294189453125, decouple_loss:0.006647602654993534
The generated pressure mean: 0.4474093019962311
loss_pred:0.020494654774665833, decouple_loss:0.006671964190900326
2023-04-16 10:12:30 testing...
The generated pressure mean: 0.4495830833911896
The generated pressure mean: 0.449788898229599
The generated pressure mean: 0.44987666606903076
loss_pred:0.02733161672949791, decouple_loss:0.006766695529222488
loss_pred:0.02852614037692547, decouple_loss:0.006756206508725882
loss_pred:0.027403390035033226, decouple_loss:0.006869092117995024
Loss: 0.028093582019209862, avg_mse: 0.03717651218175888
current test mse: 0.037177
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012008_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012008_3_24hr.npz
NaN value num: 0
Iteration: 2401, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4471588730812073
loss_pred:0.018742114305496216, decouple_loss:0.006994790863245726
The generated pressure mean: 0.44743573665618896
loss_pred:0.020121239125728607, decouple_loss:0.006923179607838392
The generated pressure mean: 0.4486221671104431
loss_pred:0.020335447043180466, decouple_loss:0.006807876750826836
Iteration: 2402, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4483543634414673
loss_pred:0.02089685946702957, decouple_loss:0.0071058799512684345
The generated pressure mean: 0.4485139846801758
loss_pred:0.019967813044786453, decouple_loss:0.007138421759009361
The generated pressure mean: 0.44900399446487427
loss_pred:0.020218146964907646, decouple_loss:0.00698612816631794
Iteration: 2403, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4472668766975403
loss_pred:0.02025371789932251, decouple_loss:0.006759474519640207
The generated pressure mean: 0.4489873945713043
The generated pressure mean: 0.449179083108902
loss_pred:0.01890205591917038, decouple_loss:0.0068854293785989285
loss_pred:0.02040625922381878, decouple_loss:0.006836125627160072
Iteration: 2404, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44798722863197327
The generated pressure mean: 0.44934898614883423loss_pred:0.018837539479136467, decouple_loss:0.007094088941812515
loss_pred:0.019837746396660805, decouple_loss:0.006896443665027618
The generated pressure mean: 0.44645360112190247
loss_pred:0.019609803333878517, decouple_loss:0.007095666602253914
Iteration: 2405, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44692468643188477
The generated pressure mean: 0.4480445683002472
loss_pred:0.01926932856440544, decouple_loss:0.0072281877510249615
loss_pred:0.019450658932328224, decouple_loss:0.007055739406496286
The generated pressure mean: 0.4482094943523407
loss_pred:0.019499093294143677, decouple_loss:0.007271958980709314
Iteration: 2406, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44793081283569336
loss_pred:0.021716410294175148, decouple_loss:0.006625383161008358
The generated pressure mean: 0.447916179895401
loss_pred:0.019421691074967384, decouple_loss:0.006595585960894823
The generated pressure mean: 0.44977760314941406
loss_pred:0.01921381987631321, decouple_loss:0.006601736880838871
Iteration: 2407, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44857507944107056
The generated pressure mean: 0.44811391830444336
loss_pred:0.021408814936876297, decouple_loss:0.007720522582530975
The generated pressure mean: 0.44779497385025024
loss_pred:0.01986306719481945, decouple_loss:0.0075033861212432384
loss_pred:0.021970706060528755, decouple_loss:0.007799258455634117
Iteration: 2408, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4483235776424408
loss_pred:0.01877647638320923, decouple_loss:0.006759753450751305
The generated pressure mean: 0.44713103771209717
loss_pred:0.01962551474571228, decouple_loss:0.006643739994615316
The generated pressure mean: 0.4479478597640991
loss_pred:0.020757999271154404, decouple_loss:0.006774114444851875
Iteration: 2409, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4467870593070984
The generated pressure mean: 0.4473857581615448
loss_pred:0.02067640982568264, decouple_loss:0.006354442331939936
loss_pred:0.02030331827700138, decouple_loss:0.0063898381777107716
The generated pressure mean: 0.44847428798675537
loss_pred:0.019022183492779732, decouple_loss:0.006374042946845293
Iteration: 2410, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4476200342178345
The generated pressure mean: 0.4479027986526489
loss_pred:0.020887715741991997, decouple_loss:0.0068669128231704235
loss_pred:0.019516712054610252, decouple_loss:0.00670370738953352
The generated pressure mean: 0.44617441296577454
loss_pred:0.020635826513171196, decouple_loss:0.006870321463793516
2023-04-16 10:15:05 testing...
The generated pressure mean: 0.449788898229599
The generated pressure mean: 0.4495830535888672
The generated pressure mean: 0.44987666606903076
loss_pred:0.028673585504293442, decouple_loss:0.007698827423155308
loss_pred:0.02724132128059864, decouple_loss:0.007766316179186106
loss_pred:0.027095261961221695, decouple_loss:0.007789939176291227
Loss: 0.0280576404184103, avg_mse: 0.03689543902873993
current test mse: 0.036895
Iteration: 2411, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44797995686531067
loss_pred:0.018499266356229782, decouple_loss:0.007709925062954426
The generated pressure mean: 0.4472024142742157
loss_pred:0.020342016592621803, decouple_loss:0.007684212643653154
The generated pressure mean: 0.4479721784591675
loss_pred:0.021164480596780777, decouple_loss:0.0076847979798913
Iteration: 2412, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44778189063072205
The generated pressure mean: 0.4469151496887207
loss_pred:0.021215293556451797, decouple_loss:0.008102547377347946
loss_pred:0.02033170871436596, decouple_loss:0.008051284588873386
The generated pressure mean: 0.4475749433040619
loss_pred:0.01996096968650818, decouple_loss:0.008011216297745705
Iteration: 2413, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44802576303482056
The generated pressure mean: 0.4477563798427582
loss_pred:0.018662765622138977, decouple_loss:0.007508018985390663
loss_pred:0.01914428360760212, decouple_loss:0.007551579736173153
The generated pressure mean: 0.44828876852989197
loss_pred:0.01987721025943756, decouple_loss:0.007659700233489275
Iteration: 2414, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44781965017318726
The generated pressure mean: 0.44765833020210266
loss_pred:0.02237728424370289, decouple_loss:0.006424711085855961
loss_pred:0.022139104083180428, decouple_loss:0.006435279734432697
The generated pressure mean: 0.44643884897232056
loss_pred:0.019540652632713318, decouple_loss:0.00662895105779171
Iteration: 2415, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44767674803733826
loss_pred:0.020327351987361908, decouple_loss:0.00722447969019413
The generated pressure mean: 0.4477499723434448
loss_pred:0.019944503903388977, decouple_loss:0.007085784804075956
The generated pressure mean: 0.4472697675228119
loss_pred:0.020667096599936485, decouple_loss:0.007222428917884827
Iteration: 2416, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44668376445770264
The generated pressure mean: 0.4468684792518616
loss_pred:0.019961271435022354, decouple_loss:0.008065332658588886
loss_pred:0.020570365712046623, decouple_loss:0.008125422522425652
The generated pressure mean: 0.44751372933387756
loss_pred:0.020232412964105606, decouple_loss:0.007961547933518887
Iteration: 2417, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4481048285961151
The generated pressure mean: 0.44762831926345825
loss_pred:0.021435024216771126, decouple_loss:0.0067855059169232845
loss_pred:0.0201611015945673, decouple_loss:0.0068265171721577644
The generated pressure mean: 0.4473644196987152
loss_pred:0.020531926304101944, decouple_loss:0.006755978334695101
Iteration: 2418, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4483950734138489The generated pressure mean: 0.4469769597053528
loss_pred:0.02023448422551155, decouple_loss:0.006704964209347963
loss_pred:0.01959831267595291, decouple_loss:0.00653757294639945
The generated pressure mean: 0.44826120138168335
loss_pred:0.021110987290740013, decouple_loss:0.006517261266708374
Iteration: 2419, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4484352171421051The generated pressure mean: 0.4494810402393341
loss_pred:0.02079835906624794, decouple_loss:0.006783217657357454
loss_pred:0.019117144867777824, decouple_loss:0.0067959995940327644
The generated pressure mean: 0.4468735456466675
loss_pred:0.020950432866811752, decouple_loss:0.00670731533318758
Iteration: 2420, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.448159396648407
The generated pressure mean: 0.4466054141521454
loss_pred:0.020389338955283165, decouple_loss:0.006684224586933851
loss_pred:0.01998235285282135, decouple_loss:0.006836527027189732
The generated pressure mean: 0.44690242409706116
loss_pred:0.019870545715093613, decouple_loss:0.00679382961243391
2023-04-16 10:16:59 testing...
The generated pressure mean: 0.4495830833911896
The generated pressure mean: 0.4497888684272766
The generated pressure mean: 0.44987666606903076
loss_pred:0.02929927222430706, decouple_loss:0.006908636540174484
loss_pred:0.030213596299290657, decouple_loss:0.0070201740600168705
loss_pred:0.02913345955312252, decouple_loss:0.006969790440052748
Loss: 0.029897086322307587, avg_mse: 0.040649183094501495
current test mse: 0.040649
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012004_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012004_3_24hr.npz
NaN value num: 0
Iteration: 2421, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44751396775245667
loss_pred:0.019180769100785255, decouple_loss:0.007019182201474905
The generated pressure mean: 0.4481734037399292
loss_pred:0.019235806539654732, decouple_loss:0.0069847372360527515
The generated pressure mean: 0.4472847878932953
loss_pred:0.019414976239204407, decouple_loss:0.007022535428404808
Iteration: 2422, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4473298490047455
loss_pred:0.02093014493584633, decouple_loss:0.007391212973743677
The generated pressure mean: 0.44667747616767883
loss_pred:0.02245752513408661, decouple_loss:0.0072829886339604855
The generated pressure mean: 0.4470152258872986
loss_pred:0.021132197231054306, decouple_loss:0.007118656765669584
Iteration: 2423, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4476580023765564
The generated pressure mean: 0.4461926221847534
loss_pred:0.019780045375227928, decouple_loss:0.007124986965209246
loss_pred:0.020143311470746994, decouple_loss:0.007206952199339867
The generated pressure mean: 0.44827932119369507
loss_pred:0.019543061032891273, decouple_loss:0.0071078878827393055
Iteration: 2424, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44795340299606323The generated pressure mean: 0.44815748929977417
loss_pred:0.01944444514811039, decouple_loss:0.006713538430631161
loss_pred:0.02040465548634529, decouple_loss:0.006634699180722237
The generated pressure mean: 0.4486514627933502
loss_pred:0.018950635567307472, decouple_loss:0.006700710393488407
Iteration: 2425, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4467615783214569
The generated pressure mean: 0.4462664723396301
loss_pred:0.019952617585659027, decouple_loss:0.007539972197264433
loss_pred:0.02130269631743431, decouple_loss:0.00759215047582984
The generated pressure mean: 0.44762372970581055
loss_pred:0.020181450992822647, decouple_loss:0.00758710689842701
Iteration: 2426, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4475368559360504
The generated pressure mean: 0.44786497950553894
loss_pred:0.021442169323563576, decouple_loss:0.008160361088812351
loss_pred:0.020854681730270386, decouple_loss:0.008214455097913742
The generated pressure mean: 0.44663000106811523
loss_pred:0.020480677485466003, decouple_loss:0.008080913685262203
Iteration: 2427, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44784584641456604
The generated pressure mean: 0.4468432068824768
loss_pred:0.019984962418675423, decouple_loss:0.006876946426928043
loss_pred:0.020215999335050583, decouple_loss:0.006980918813496828
The generated pressure mean: 0.44732123613357544
loss_pred:0.019908830523490906, decouple_loss:0.0069119930267333984
Iteration: 2428, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44809916615486145
The generated pressure mean: 0.447194367647171
loss_pred:0.018860025331377983, decouple_loss:0.006317435298115015
loss_pred:0.021650569513440132, decouple_loss:0.00647240923717618
The generated pressure mean: 0.44733601808547974
loss_pred:0.02050555869936943, decouple_loss:0.006320840213447809
Iteration: 2429, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44665244221687317
The generated pressure mean: 0.44763290882110596
loss_pred:0.01922021061182022, decouple_loss:0.007164969574660063
loss_pred:0.01891409233212471, decouple_loss:0.007147556636482477
The generated pressure mean: 0.44782304763793945
loss_pred:0.019471783190965652, decouple_loss:0.007226709276437759
Iteration: 2430, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4473423361778259
loss_pred:0.019772913306951523, decouple_loss:0.008253763429820538
The generated pressure mean: 0.44792693853378296
loss_pred:0.02073550410568714, decouple_loss:0.008316471241414547
The generated pressure mean: 0.44769221544265747
loss_pred:0.021103976294398308, decouple_loss:0.008235436864197254
2023-04-16 10:19:31 testing...
The generated pressure mean: 0.4495830833911896
The generated pressure mean: 0.4497888684272766
The generated pressure mean: 0.44987666606903076
loss_pred:0.027842069044709206, decouple_loss:0.007328360341489315
loss_pred:0.028761252760887146, decouple_loss:0.007361828815191984
loss_pred:0.02771063894033432, decouple_loss:0.007329521235078573
Loss: 0.028471648693084717, avg_mse: 0.03782724589109421
current test mse: 0.037827
Iteration: 2431, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4483192265033722
The generated pressure mean: 0.4463234841823578
loss_pred:0.021148761734366417, decouple_loss:0.007233249023556709
loss_pred:0.019900674000382423, decouple_loss:0.0072893486358225346
The generated pressure mean: 0.4486333727836609
loss_pred:0.021020496264100075, decouple_loss:0.00731405895203352
Iteration: 2432, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44642502069473267
loss_pred:0.019404130056500435, decouple_loss:0.007035021670162678
The generated pressure mean: 0.44733962416648865
loss_pred:0.020447876304388046, decouple_loss:0.006911025382578373
The generated pressure mean: 0.4458563029766083
loss_pred:0.018857136368751526, decouple_loss:0.006922260858118534
Iteration: 2433, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4474705159664154
loss_pred:0.020791908726096153, decouple_loss:0.007202044129371643
The generated pressure mean: 0.44744789600372314
loss_pred:0.02010924741625786, decouple_loss:0.007195258047431707
The generated pressure mean: 0.44772395491600037
loss_pred:0.02136768400669098, decouple_loss:0.00704351719468832
Iteration: 2434, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44727715849876404
loss_pred:0.020395083352923393, decouple_loss:0.008299742825329304
The generated pressure mean: 0.44804468750953674
loss_pred:0.020923729985952377, decouple_loss:0.008353975601494312
The generated pressure mean: 0.4481167495250702
loss_pred:0.019658243283629417, decouple_loss:0.008293581195175648
Iteration: 2435, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44809389114379883
loss_pred:0.019247770309448242, decouple_loss:0.008097526617348194
The generated pressure mean: 0.44784218072891235
loss_pred:0.019857492297887802, decouple_loss:0.008125885389745235
The generated pressure mean: 0.4466976225376129
loss_pred:0.020655708387494087, decouple_loss:0.008178584277629852
Iteration: 2436, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4480590224266052
loss_pred:0.019750792533159256, decouple_loss:0.007048021536320448
The generated pressure mean: 0.4466928243637085
loss_pred:0.020122427493333817, decouple_loss:0.007002596277743578
The generated pressure mean: 0.4476127028465271
loss_pred:0.020282229408621788, decouple_loss:0.006889352109283209
Iteration: 2437, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44833695888519287
loss_pred:0.019789136946201324, decouple_loss:0.00790331419557333
The generated pressure mean: 0.44725462794303894
loss_pred:0.02026495523750782, decouple_loss:0.007951756939291954
The generated pressure mean: 0.4473123550415039
loss_pred:0.020145654678344727, decouple_loss:0.007888415828347206
Iteration: 2438, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44812795519828796
loss_pred:0.019561899825930595, decouple_loss:0.008322592824697495
The generated pressure mean: 0.44606471061706543
loss_pred:0.02053445391356945, decouple_loss:0.008377842605113983
The generated pressure mean: 0.4479922950267792
loss_pred:0.021152563393115997, decouple_loss:0.008208304643630981
Iteration: 2439, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4460369944572449
loss_pred:0.02038034051656723, decouple_loss:0.0070595508441329
The generated pressure mean: 0.447773814201355
loss_pred:0.02126060612499714, decouple_loss:0.006957019679248333
The generated pressure mean: 0.4481970965862274
loss_pred:0.020403048023581505, decouple_loss:0.006974741816520691
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 2440, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4466818571090698
loss_pred:0.01957475021481514, decouple_loss:0.007495618425309658
The generated pressure mean: 0.44716641306877136
loss_pred:0.021640615537762642, decouple_loss:0.00767755601555109
The generated pressure mean: 0.4455784261226654
loss_pred:0.019308604300022125, decouple_loss:0.007593960501253605
2023-04-16 10:21:24 testing...
The generated pressure mean: 0.4497888684272766
The generated pressure mean: 0.4495830237865448
The generated pressure mean: 0.44987666606903076
loss_pred:0.02957824431359768, decouple_loss:0.0070627774111926556
loss_pred:0.028567461296916008, decouple_loss:0.007045791484415531
loss_pred:0.028234057128429413, decouple_loss:0.006932701449841261
Loss: 0.029143942520022392, avg_mse: 0.03893337771296501
current test mse: 0.038933
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012015_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012015_3_24hr.npz
NaN value num: 0
Iteration: 2441, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44659748673439026
loss_pred:0.021435977891087532, decouple_loss:0.006874502170830965
The generated pressure mean: 0.44418957829475403
loss_pred:0.021628741174936295, decouple_loss:0.006855587940663099
The generated pressure mean: 0.4471549987792969
loss_pred:0.02270551770925522, decouple_loss:0.006753962021321058
Iteration: 2442, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4465557038784027
The generated pressure mean: 0.44692474603652954
loss_pred:0.01950795017182827, decouple_loss:0.006841498892754316
loss_pred:0.020340710878372192, decouple_loss:0.007000243291258812
The generated pressure mean: 0.4464435279369354
loss_pred:0.022281521931290627, decouple_loss:0.006943808868527412
Iteration: 2443, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4470646381378174
loss_pred:0.022636618465185165, decouple_loss:0.007324517704546452
The generated pressure mean: 0.4461767077445984
loss_pred:0.020951347425580025, decouple_loss:0.007370682433247566
The generated pressure mean: 0.4449184238910675
loss_pred:0.023884741589426994, decouple_loss:0.007471972145140171
Iteration: 2444, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4471542239189148
The generated pressure mean: 0.4465227425098419
loss_pred:0.020199717953801155, decouple_loss:0.007012811489403248
loss_pred:0.02141321450471878, decouple_loss:0.007004338316619396
The generated pressure mean: 0.4460996389389038
loss_pred:0.02039899304509163, decouple_loss:0.006853736471384764
Iteration: 2445, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44592511653900146
loss_pred:0.02069544978439808, decouple_loss:0.007455700077116489
The generated pressure mean: 0.44671282172203064
loss_pred:0.02012109011411667, decouple_loss:0.00749753275886178
The generated pressure mean: 0.4457946717739105
loss_pred:0.022269265726208687, decouple_loss:0.007530868984758854
Iteration: 2446, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44705435633659363
The generated pressure mean: 0.445913702249527
loss_pred:0.020855296403169632, decouple_loss:0.007502323016524315
loss_pred:0.020072828978300095, decouple_loss:0.007515863981097937
The generated pressure mean: 0.44630181789398193
loss_pred:0.021040748804807663, decouple_loss:0.0075516533106565475
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 2447, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44722798466682434
loss_pred:0.021524738520383835, decouple_loss:0.006395677104592323
The generated pressure mean: 0.44704344868659973
loss_pred:0.020544730126857758, decouple_loss:0.006460134871304035
The generated pressure mean: 0.44696277379989624
loss_pred:0.021848632022738457, decouple_loss:0.006532685365527868
Iteration: 2448, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44558170437812805
loss_pred:0.01981213688850403, decouple_loss:0.006944268010556698
The generated pressure mean: 0.44547614455223083
loss_pred:0.021163830533623695, decouple_loss:0.00687382323667407
The generated pressure mean: 0.4463280737400055
loss_pred:0.01960785873234272, decouple_loss:0.006807687226682901
Iteration: 2449, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4471602141857147
The generated pressure mean: 0.44660240411758423loss_pred:0.020747190341353416, decouple_loss:0.006820573005825281
loss_pred:0.021872838959097862, decouple_loss:0.006842934060841799
The generated pressure mean: 0.447144091129303
loss_pred:0.01994166523218155, decouple_loss:0.006911765784025192
Iteration: 2450, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44725629687309265
The generated pressure mean: 0.44583046436309814
loss_pred:0.019621357321739197, decouple_loss:0.006875331047922373
loss_pred:0.01947968639433384, decouple_loss:0.006703713908791542
The generated pressure mean: 0.4479641318321228
loss_pred:0.02053302899003029, decouple_loss:0.006908445619046688
2023-04-16 10:23:55 testing...
The generated pressure mean: 0.4495830535888672
The generated pressure mean: 0.449788898229599
The generated pressure mean: 0.44987666606903076
loss_pred:0.028591228649020195, decouple_loss:0.007022334728389978
loss_pred:0.02976248227059841, decouple_loss:0.007030257489532232
loss_pred:0.028633972629904747, decouple_loss:0.0070602912455797195
Loss: 0.029347775503993034, avg_mse: 0.03962201252579689
current test mse: 0.039622
Iteration: 2451, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4470517337322235
The generated pressure mean: 0.44647565484046936
loss_pred:0.021496836096048355, decouple_loss:0.006780991796404123
loss_pred:0.019823778420686722, decouple_loss:0.00686819339171052
The generated pressure mean: 0.44556576013565063
loss_pred:0.02004346251487732, decouple_loss:0.0068631647154688835
Iteration: 2452, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4463682472705841
The generated pressure mean: 0.44565340876579285
loss_pred:0.020554352551698685, decouple_loss:0.008225886151194572
loss_pred:0.020592734217643738, decouple_loss:0.008187439292669296
The generated pressure mean: 0.44706955552101135
loss_pred:0.020192688331007957, decouple_loss:0.008203093893826008
Iteration: 2453, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44701579213142395
The generated pressure mean: 0.4464186728000641
loss_pred:0.02010919898748398, decouple_loss:0.006504036020487547
loss_pred:0.020731724798679352, decouple_loss:0.006454623769968748
The generated pressure mean: 0.44647127389907837
loss_pred:0.019802171736955643, decouple_loss:0.0066763898357748985
Iteration: 2454, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4456939697265625
The generated pressure mean: 0.4458605945110321
loss_pred:0.022959241643548012, decouple_loss:0.0066757588647305965
loss_pred:0.02219643071293831, decouple_loss:0.006705768406391144
The generated pressure mean: 0.44683507084846497
loss_pred:0.02114509791135788, decouple_loss:0.006910566706210375
Iteration: 2455, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4476238787174225
The generated pressure mean: 0.4451724886894226
loss_pred:0.023135121911764145, decouple_loss:0.007034416776150465
loss_pred:0.01988716796040535, decouple_loss:0.0072165862657129765
The generated pressure mean: 0.4467942416667938
loss_pred:0.020223023369908333, decouple_loss:0.0072124009020626545
Iteration: 2456, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44563716650009155
loss_pred:0.020264750346541405, decouple_loss:0.007471031509339809
The generated pressure mean: 0.44665905833244324
loss_pred:0.021231234073638916, decouple_loss:0.007370101287961006
The generated pressure mean: 0.4465024173259735
loss_pred:0.02087581157684326, decouple_loss:0.007315135560929775
Iteration: 2457, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44546782970428467
loss_pred:0.019350921735167503, decouple_loss:0.007248660083860159
The generated pressure mean: 0.44665977358818054
loss_pred:0.021170804277062416, decouple_loss:0.007482604589313269
The generated pressure mean: 0.44599518179893494
loss_pred:0.02202727645635605, decouple_loss:0.007577740121632814
Iteration: 2458, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44764935970306396
loss_pred:0.020849118009209633, decouple_loss:0.007009061053395271
The generated pressure mean: 0.4465615153312683
The generated pressure mean: 0.4465303421020508
loss_pred:0.021106023341417313, decouple_loss:0.006936831399798393
loss_pred:0.021908286958932877, decouple_loss:0.006918394472450018
Iteration: 2459, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4459589421749115
loss_pred:0.020354410633444786, decouple_loss:0.0066986242309212685
The generated pressure mean: 0.4473857581615448
loss_pred:0.021553456783294678, decouple_loss:0.006869826931506395
The generated pressure mean: 0.44717806577682495
loss_pred:0.019889384508132935, decouple_loss:0.006802339106798172
Iteration: 2460, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44681504368782043
loss_pred:0.020716529339551926, decouple_loss:0.006886321119964123
The generated pressure mean: 0.44675591588020325
The generated pressure mean: 0.4458796977996826loss_pred:0.019372280687093735, decouple_loss:0.007039566989988089
loss_pred:0.021377941593527794, decouple_loss:0.006770546082407236
2023-04-16 10:25:49 testing...
The generated pressure mean: 0.4495830833911896
The generated pressure mean: 0.4497888684272766
The generated pressure mean: 0.44987666606903076
loss_pred:0.027571292594075203, decouple_loss:0.0069076865911483765
loss_pred:0.028557518497109413, decouple_loss:0.006961462553590536
loss_pred:0.02734716609120369, decouple_loss:0.0068407244980335236
Loss: 0.028170492500066757, avg_mse: 0.03734629973769188
current test mse: 0.037346
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012009_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012009_3_24hr.npz
NaN value num: 0
Iteration: 2461, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44719722867012024
loss_pred:0.019531477242708206, decouple_loss:0.006887364201247692
The generated pressure mean: 0.44982996582984924
The generated pressure mean: 0.4483659267425537
loss_pred:0.02203390933573246, decouple_loss:0.0069664716720581055
loss_pred:0.020872214809060097, decouple_loss:0.006817357614636421
Iteration: 2462, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44608765840530396
loss_pred:0.021471379324793816, decouple_loss:0.006523342803120613
The generated pressure mean: 0.448513925075531
loss_pred:0.020948117598891258, decouple_loss:0.006675229873508215
The generated pressure mean: 0.4478175938129425
loss_pred:0.020397506654262543, decouple_loss:0.0068319556303322315
Iteration: 2463, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4483204185962677
loss_pred:0.02129998430609703, decouple_loss:0.007506583817303181
The generated pressure mean: 0.44909849762916565
The generated pressure mean: 0.44753408432006836
loss_pred:0.0200955867767334, decouple_loss:0.0073333075270056725
loss_pred:0.02135225385427475, decouple_loss:0.007531920447945595
Iteration: 2464, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44679683446884155
loss_pred:0.020122569054365158, decouple_loss:0.0076314290054142475
The generated pressure mean: 0.4476069211959839
The generated pressure mean: 0.4461471736431122
loss_pred:0.020327525213360786, decouple_loss:0.007579283323138952
loss_pred:0.020397773012518883, decouple_loss:0.007637611590325832
Iteration: 2465, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44736161828041077
loss_pred:0.019847428426146507, decouple_loss:0.0074963998049497604
The generated pressure mean: 0.44697925448417664
loss_pred:0.019693490117788315, decouple_loss:0.007546528708189726The generated pressure mean: 0.4483940899372101
loss_pred:0.01990743912756443, decouple_loss:0.007353504188358784
Iteration: 2466, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44854751229286194
loss_pred:0.020737478509545326, decouple_loss:0.007209855131804943
The generated pressure mean: 0.4474954903125763
loss_pred:0.019233668223023415, decouple_loss:0.007146164774894714
The generated pressure mean: 0.44623613357543945
loss_pred:0.020039374008774757, decouple_loss:0.007335533853620291
Iteration: 2467, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44760459661483765
loss_pred:0.019167594611644745, decouple_loss:0.0063055395148694515
The generated pressure mean: 0.4487951695919037
loss_pred:0.01943889446556568, decouple_loss:0.00639439607039094
The generated pressure mean: 0.4473239481449127
loss_pred:0.020002013072371483, decouple_loss:0.006391881499439478
Iteration: 2468, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44661805033683777
loss_pred:0.01941755600273609, decouple_loss:0.005946121644228697
The generated pressure mean: 0.4483109414577484The generated pressure mean: 0.4476727247238159
loss_pred:0.021665388718247414, decouple_loss:0.005935994908213615
loss_pred:0.02096501551568508, decouple_loss:0.005822207313030958
Iteration: 2469, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.448018342256546
loss_pred:0.02012801170349121, decouple_loss:0.00622713053599
The generated pressure mean: 0.4474327564239502
The generated pressure mean: 0.4487040936946869
loss_pred:0.019568413496017456, decouple_loss:0.0062554641626775265
loss_pred:0.0220186784863472, decouple_loss:0.006281320471316576
Iteration: 2470, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4472768306732178
loss_pred:0.019943974912166595, decouple_loss:0.006067177746444941
The generated pressure mean: 0.44852012395858765
loss_pred:0.01848338358104229, decouple_loss:0.006078748032450676
The generated pressure mean: 0.4475298225879669
loss_pred:0.020547326654195786, decouple_loss:0.00596257857978344
2023-04-16 10:28:23 testing...
The generated pressure mean: 0.4495830833911896
The generated pressure mean: 0.449788898229599
The generated pressure mean: 0.44987666606903076
loss_pred:0.028136208653450012, decouple_loss:0.006450451444834471
loss_pred:0.028622489422559738, decouple_loss:0.0065160468220710754
loss_pred:0.027866968885064125, decouple_loss:0.006501615047454834
Loss: 0.028533024713397026, avg_mse: 0.03821921721100807
current test mse: 0.038219
Iteration: 2471, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4461551308631897
loss_pred:0.020201804116368294, decouple_loss:0.00655024591833353
The generated pressure mean: 0.44688746333122253
loss_pred:0.018949944525957108, decouple_loss:0.0065562971867620945
The generated pressure mean: 0.4480317533016205
loss_pred:0.02060927078127861, decouple_loss:0.0065235416404902935
Iteration: 2472, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.449433296918869
loss_pred:0.019482316449284554, decouple_loss:0.007227246183902025
The generated pressure mean: 0.44727861881256104
loss_pred:0.019761258736252785, decouple_loss:0.007393745239824057
The generated pressure mean: 0.4469814896583557
loss_pred:0.02032606676220894, decouple_loss:0.007057312875986099
Iteration: 2473, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44713956117630005
loss_pred:0.019558757543563843, decouple_loss:0.007068396080285311
The generated pressure mean: 0.4493076503276825
The generated pressure mean: 0.44773584604263306
loss_pred:0.02079782821238041, decouple_loss:0.007034074515104294
loss_pred:0.01954955980181694, decouple_loss:0.007145535200834274
Iteration: 2474, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4454862177371979
loss_pred:0.019948739558458328, decouple_loss:0.006468940060585737
The generated pressure mean: 0.44779470562934875
The generated pressure mean: 0.4476143717765808
loss_pred:0.01977587305009365, decouple_loss:0.0066116550005972385
loss_pred:0.021208105608820915, decouple_loss:0.006557784508913755
Iteration: 2475, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44803327322006226
loss_pred:0.020323531702160835, decouple_loss:0.006466705352067947
The generated pressure mean: 0.4478420615196228
The generated pressure mean: 0.4470822811126709
loss_pred:0.019777456298470497, decouple_loss:0.006407003849744797
loss_pred:0.019511934369802475, decouple_loss:0.006460547912865877
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 2476, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.446424663066864
loss_pred:0.020177699625492096, decouple_loss:0.006396112497895956
The generated pressure mean: 0.44861432909965515
The generated pressure mean: 0.4493890404701233
loss_pred:0.02008143439888954, decouple_loss:0.006380647886544466
loss_pred:0.0203770212829113, decouple_loss:0.006384584121406078
Iteration: 2477, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4472886323928833
loss_pred:0.01904863864183426, decouple_loss:0.006753521040081978
The generated pressure mean: 0.44558775424957275
The generated pressure mean: 0.44778165221214294
loss_pred:0.0213022418320179, decouple_loss:0.006855369545519352
loss_pred:0.01998656988143921, decouple_loss:0.006732707843184471
Iteration: 2478, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4468083083629608
loss_pred:0.019286764785647392, decouple_loss:0.007384656462818384
The generated pressure mean: 0.44741398096084595
loss_pred:0.019337043166160583, decouple_loss:0.007291334681212902
The generated pressure mean: 0.4468348026275635
loss_pred:0.019774846732616425, decouple_loss:0.007410661783069372
Iteration: 2479, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44784674048423767
loss_pred:0.019062263891100883, decouple_loss:0.006834586150944233
The generated pressure mean: 0.4471273124217987
The generated pressure mean: 0.44692885875701904
loss_pred:0.019418884068727493, decouple_loss:0.006774493958801031
loss_pred:0.020196424797177315, decouple_loss:0.006762070581316948
Iteration: 2480, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4473932087421417
loss_pred:0.019294671714305878, decouple_loss:0.005722763482481241
The generated pressure mean: 0.4461553990840912
loss_pred:0.019894789904356003, decouple_loss:0.005887793377041817
The generated pressure mean: 0.4471665024757385
loss_pred:0.020260794088244438, decouple_loss:0.005991156678646803
2023-04-16 10:30:16 testing...
The generated pressure mean: 0.4497888684272766
The generated pressure mean: 0.4495830535888672
The generated pressure mean: 0.44987666606903076
loss_pred:0.02778182178735733, decouple_loss:0.005920725874602795
loss_pred:0.02675476297736168, decouple_loss:0.005802370607852936
loss_pred:0.02668239362537861, decouple_loss:0.005783571861684322
Loss: 0.02736477181315422, avg_mse: 0.03608386963605881
current test mse: 0.036084
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012019_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012019_3_24hr.npz
NaN value num: 0
Iteration: 2481, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44893956184387207
loss_pred:0.019565017893910408, decouple_loss:0.005824061576277018
The generated pressure mean: 0.4492380619049072
loss_pred:0.019188309088349342, decouple_loss:0.00620222557336092
The generated pressure mean: 0.45058590173721313
loss_pred:0.020252250134944916, decouple_loss:0.005985391791909933
Iteration: 2482, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44822654128074646
loss_pred:0.01990889199078083, decouple_loss:0.006579196080565453
The generated pressure mean: 0.44860759377479553
loss_pred:0.02212340198457241, decouple_loss:0.0066801924258470535The generated pressure mean: 0.44919705390930176
loss_pred:0.019610794261097908, decouple_loss:0.006496489979326725
Iteration: 2483, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44911807775497437
The generated pressure mean: 0.45018741488456726
loss_pred:0.021730715408921242, decouple_loss:0.007363167591392994
loss_pred:0.019880356267094612, decouple_loss:0.0075036087073385715
The generated pressure mean: 0.44903796911239624
loss_pred:0.019447259604930878, decouple_loss:0.007433958351612091
Iteration: 2484, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44836920499801636
loss_pred:0.02069561555981636, decouple_loss:0.007463482674211264
The generated pressure mean: 0.44863173365592957
The generated pressure mean: 0.44927504658699036loss_pred:0.019885875284671783, decouple_loss:0.007490635383874178
loss_pred:0.019979896023869514, decouple_loss:0.007751222234219313
Iteration: 2485, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4483937621116638
loss_pred:0.02150220051407814, decouple_loss:0.005916075315326452
The generated pressure mean: 0.4492861032485962
The generated pressure mean: 0.4506630301475525
loss_pred:0.019086968153715134, decouple_loss:0.006070652976632118
loss_pred:0.0203517135232687, decouple_loss:0.006028525065630674
Iteration: 2486, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4484655559062958
loss_pred:0.020200513303279877, decouple_loss:0.00673719635233283
The generated pressure mean: 0.44948598742485046
The generated pressure mean: 0.4502960443496704
loss_pred:0.019143152981996536, decouple_loss:0.006632139906287193
loss_pred:0.019404595717787743, decouple_loss:0.006794204469770193
Iteration: 2487, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4502295255661011
loss_pred:0.019165774807333946, decouple_loss:0.006653911899775267
The generated pressure mean: 0.4489181935787201
loss_pred:0.02075958624482155, decouple_loss:0.006406204309314489
The generated pressure mean: 0.4491842985153198
loss_pred:0.019583210349082947, decouple_loss:0.00642146123573184
Iteration: 2488, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4480297267436981
loss_pred:0.019338879734277725, decouple_loss:0.006659067701548338
The generated pressure mean: 0.44969242811203003
loss_pred:0.01981114223599434, decouple_loss:0.006819089874625206
The generated pressure mean: 0.44803234934806824
loss_pred:0.019347824156284332, decouple_loss:0.006799959111958742
Iteration: 2489, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44797298312187195
loss_pred:0.01977136917412281, decouple_loss:0.007276738993823528
The generated pressure mean: 0.45090633630752563
loss_pred:0.019005626440048218, decouple_loss:0.007219362538307905
The generated pressure mean: 0.4503858983516693
loss_pred:0.01990288309752941, decouple_loss:0.007525008171796799
Iteration: 2490, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4500034749507904
loss_pred:0.020531345158815384, decouple_loss:0.006575757171958685
The generated pressure mean: 0.4496931731700897
The generated pressure mean: 0.45011022686958313
loss_pred:0.02012496069073677, decouple_loss:0.006467154249548912
loss_pred:0.019928600639104843, decouple_loss:0.006522310897707939
2023-04-16 10:32:49 testing...
The generated pressure mean: 0.4495830833911896
The generated pressure mean: 0.449788898229599
The generated pressure mean: 0.44987666606903076
loss_pred:0.026385314762592316, decouple_loss:0.006149459630250931
loss_pred:0.02735932357609272, decouple_loss:0.006277282722294331
loss_pred:0.02628079243004322, decouple_loss:0.006185974460095167
Loss: 0.026985354721546173, avg_mse: 0.035328179597854614
current test mse: 0.035328
Iteration: 2491, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44858768582344055
loss_pred:0.019822169095277786, decouple_loss:0.006215102970600128
The generated pressure mean: 0.4497798681259155
The generated pressure mean: 0.4491962790489197
loss_pred:0.019836435094475746, decouple_loss:0.006167715415358543
loss_pred:0.019418755546212196, decouple_loss:0.006208258680999279
Iteration: 2492, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44901031255722046
loss_pred:0.02030089683830738, decouple_loss:0.006707325577735901
The generated pressure mean: 0.4492708742618561
The generated pressure mean: 0.449203222990036
loss_pred:0.019630851224064827, decouple_loss:0.006957303266972303
loss_pred:0.01957075111567974, decouple_loss:0.006779282353818417
Iteration: 2493, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4498368203639984
loss_pred:0.019349534064531326, decouple_loss:0.0075996206142008305
The generated pressure mean: 0.4497874081134796
The generated pressure mean: 0.4501243233680725
loss_pred:0.01992110349237919, decouple_loss:0.007669318001717329
loss_pred:0.02069384977221489, decouple_loss:0.007660866715013981
Iteration: 2494, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45080986618995667
loss_pred:0.01985337771475315, decouple_loss:0.006980570033192635
The generated pressure mean: 0.4494338631629944
The generated pressure mean: 0.449287086725235
loss_pred:0.021280910819768906, decouple_loss:0.006937450263649225
loss_pred:0.020170899108052254, decouple_loss:0.0069904932752251625
Iteration: 2495, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4493621587753296
loss_pred:0.019495118409395218, decouple_loss:0.0064328317530453205
The generated pressure mean: 0.4492669105529785
The generated pressure mean: 0.4508246183395386
loss_pred:0.018806174397468567, decouple_loss:0.006348327733576298
loss_pred:0.01960126683115959, decouple_loss:0.006364588625729084
Iteration: 2496, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44965630769729614
loss_pred:0.021025314927101135, decouple_loss:0.00649321498349309
The generated pressure mean: 0.44947436451911926
The generated pressure mean: 0.44837287068367004loss_pred:0.019573034718632698, decouple_loss:0.006721790414303541
loss_pred:0.02034732513129711, decouple_loss:0.006510759703814983
Iteration: 2497, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.450138658285141
loss_pred:0.019469205290079117, decouple_loss:0.006447747349739075
The generated pressure mean: 0.4488268494606018
loss_pred:0.020743507891893387, decouple_loss:0.006379263009876013
The generated pressure mean: 0.4500710964202881
loss_pred:0.018922610208392143, decouple_loss:0.006530599668622017
Iteration: 2498, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44851312041282654
loss_pred:0.01936960406601429, decouple_loss:0.006983314640820026
The generated pressure mean: 0.44965094327926636
The generated pressure mean: 0.44886115193367004
loss_pred:0.019588293507695198, decouple_loss:0.0068710604682564735
loss_pred:0.02026413381099701, decouple_loss:0.006849357392638922
Iteration: 2499, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4488588571548462
loss_pred:0.020548271015286446, decouple_loss:0.006421815603971481
The generated pressure mean: 0.44874081015586853
The generated pressure mean: 0.44765859842300415
loss_pred:0.019235247746109962, decouple_loss:0.006588268559426069
loss_pred:0.0207448061555624, decouple_loss:0.006459793075919151
Iteration: 2500, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4490286111831665
loss_pred:0.0201835036277771, decouple_loss:0.0061904191970825195
The generated pressure mean: 0.44805780053138733
The generated pressure mean: 0.4496731460094452
loss_pred:0.02052059769630432, decouple_loss:0.00621107779443264
loss_pred:0.020308157429099083, decouple_loss:0.0061842696741223335
2023-04-16 10:34:43 testing...
The generated pressure mean: 0.449788898229599
The generated pressure mean: 0.4495830237865448
The generated pressure mean: 0.44987666606903076
loss_pred:0.027463681995868683, decouple_loss:0.005875220987945795
loss_pred:0.026314128190279007, decouple_loss:0.005865956656634808
loss_pred:0.02616770938038826, decouple_loss:0.005946481134742498
Loss: 0.026943301782011986, avg_mse: 0.03534792736172676
current test mse: 0.035348
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012001_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012001_3_24hr.npz
NaN value num: 0
Iteration: 2501, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44879624247550964
loss_pred:0.018815727904438972, decouple_loss:0.005961509421467781
The generated pressure mean: 0.4486105442047119
loss_pred:0.019185971468687057, decouple_loss:0.006012194789946079
The generated pressure mean: 0.44720178842544556
loss_pred:0.020952150225639343, decouple_loss:0.006185195408761501
Iteration: 2502, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4481727182865143
The generated pressure mean: 0.4459710121154785
loss_pred:0.022025061771273613, decouple_loss:0.006589923985302448
loss_pred:0.02047690749168396, decouple_loss:0.006409810855984688
The generated pressure mean: 0.4479070007801056
loss_pred:0.019266348332166672, decouple_loss:0.00643674423918128
Iteration: 2503, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4482642710208893
loss_pred:0.019445791840553284, decouple_loss:0.006410520989447832
The generated pressure mean: 0.44694459438323975
loss_pred:0.020625777542591095, decouple_loss:0.006391068454831839
The generated pressure mean: 0.4480348825454712
loss_pred:0.01971057429909706, decouple_loss:0.006310752127319574
Iteration: 2504, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4466207027435303
loss_pred:0.01776030659675598, decouple_loss:0.006216499023139477
The generated pressure mean: 0.44825178384780884
loss_pred:0.018227800726890564, decouple_loss:0.0062158796936273575
The generated pressure mean: 0.4462290108203888
loss_pred:0.020029421895742416, decouple_loss:0.006210579536855221
Iteration: 2505, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.447226345539093
loss_pred:0.021234437823295593, decouple_loss:0.006051164586097002
The generated pressure mean: 0.44639071822166443
loss_pred:0.019733401015400887, decouple_loss:0.005840963218361139
The generated pressure mean: 0.4472421705722809
loss_pred:0.0202178917825222, decouple_loss:0.005940812639892101
Iteration: 2506, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4478665292263031
loss_pred:0.01843220181763172, decouple_loss:0.006793018896132708
The generated pressure mean: 0.44755735993385315
loss_pred:0.01915142312645912, decouple_loss:0.006660690065473318
The generated pressure mean: 0.4472336173057556
loss_pred:0.019902735948562622, decouple_loss:0.006701663136482239
Iteration: 2507, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4467603862285614
loss_pred:0.02105996198952198, decouple_loss:0.006709362845867872
The generated pressure mean: 0.44865885376930237
loss_pred:0.02141548879444599, decouple_loss:0.006551295984536409
The generated pressure mean: 0.4465906322002411
loss_pred:0.01982101984322071, decouple_loss:0.006917087826877832
Iteration: 2508, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44729161262512207
loss_pred:0.020000629127025604, decouple_loss:0.006504761055111885
The generated pressure mean: 0.44708535075187683
loss_pred:0.021132316440343857, decouple_loss:0.006633203011006117
The generated pressure mean: 0.4466645419597626
loss_pred:0.01944614388048649, decouple_loss:0.0065634241327643394
Iteration: 2509, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44795510172843933
loss_pred:0.018035704270005226, decouple_loss:0.006606941111385822
The generated pressure mean: 0.44880780577659607
loss_pred:0.020172085613012314, decouple_loss:0.006666417233645916
The generated pressure mean: 0.4481533467769623
loss_pred:0.020423052832484245, decouple_loss:0.0066734240390360355
Iteration: 2510, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44699421525001526
loss_pred:0.019753992557525635, decouple_loss:0.006112343166023493
The generated pressure mean: 0.448044091463089
loss_pred:0.01983250118792057, decouple_loss:0.006093753036111593
The generated pressure mean: 0.44644472002983093
loss_pred:0.020416259765625, decouple_loss:0.006161780096590519
2023-04-16 10:37:14 testing...
The generated pressure mean: 0.4495830535888672
The generated pressure mean: 0.4497888386249542
The generated pressure mean: 0.44987666606903076
loss_pred:0.026759948581457138, decouple_loss:0.005881322082132101
loss_pred:0.027628635987639427, decouple_loss:0.005802122876048088
loss_pred:0.026272615417838097, decouple_loss:0.005938677582889795
Loss: 0.02718077227473259, avg_mse: 0.0357261560857296
current test mse: 0.035726
Iteration: 2511, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4470670819282532
loss_pred:0.01915883831679821, decouple_loss:0.00594002939760685
The generated pressure mean: 0.4477525055408478
loss_pred:0.020113443955779076, decouple_loss:0.005765928886830807
The generated pressure mean: 0.44648081064224243
loss_pred:0.020304908975958824, decouple_loss:0.005783982574939728
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 2512, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44799819588661194
loss_pred:0.020227273926138878, decouple_loss:0.007024435792118311
The generated pressure mean: 0.4466317892074585
loss_pred:0.01958967186510563, decouple_loss:0.006959955673664808
The generated pressure mean: 0.4478265047073364
loss_pred:0.023723673075437546, decouple_loss:0.0071668787859380245
Iteration: 2513, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44574248790740967
loss_pred:0.019271790981292725, decouple_loss:0.006299692206084728
The generated pressure mean: 0.4474366009235382
loss_pred:0.019588163122534752, decouple_loss:0.00626139622181654
The generated pressure mean: 0.44601142406463623
loss_pred:0.01968460902571678, decouple_loss:0.006088912952691317
Iteration: 2514, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44653376936912537
loss_pred:0.021597201004624367, decouple_loss:0.0063295564614236355
The generated pressure mean: 0.4455767571926117
The generated pressure mean: 0.44730597734451294
loss_pred:0.019644178450107574, decouple_loss:0.0066368053667247295
loss_pred:0.01909536123275757, decouple_loss:0.0061188312247395515
Iteration: 2515, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4470917880535126
loss_pred:0.01943082921206951, decouple_loss:0.006466205697506666
The generated pressure mean: 0.4490118622779846
loss_pred:0.020773258060216904, decouple_loss:0.006648430600762367
The generated pressure mean: 0.4475002884864807
loss_pred:0.019987910985946655, decouple_loss:0.006339238956570625
Iteration: 2516, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44603416323661804
The generated pressure mean: 0.44669008255004883
loss_pred:0.01908848062157631, decouple_loss:0.00645442632958293
loss_pred:0.020146122202277184, decouple_loss:0.006730522494763136
The generated pressure mean: 0.44811418652534485
loss_pred:0.02086815796792507, decouple_loss:0.006681282073259354
Iteration: 2517, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4461544156074524
loss_pred:0.018839962780475616, decouple_loss:0.0073554334230721
The generated pressure mean: 0.4468749761581421
loss_pred:0.020143216475844383, decouple_loss:0.007575610652565956
The generated pressure mean: 0.4481518268585205
loss_pred:0.019141172990202904, decouple_loss:0.0074056461453437805
Iteration: 2518, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4463931620121002
loss_pred:0.021043606102466583, decouple_loss:0.00650630472227931
The generated pressure mean: 0.4484339952468872
loss_pred:0.01951052062213421, decouple_loss:0.006548390723764896
The generated pressure mean: 0.4470219612121582
loss_pred:0.018768327310681343, decouple_loss:0.006443121004849672
Iteration: 2519, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4472917318344116
loss_pred:0.02004029043018818, decouple_loss:0.007590357214212418
The generated pressure mean: 0.44881632924079895
loss_pred:0.021959468722343445, decouple_loss:0.0074911112897098064
The generated pressure mean: 0.44770726561546326
loss_pred:0.020047960802912712, decouple_loss:0.0075016324408352375
Iteration: 2520, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4483518600463867
loss_pred:0.020472746342420578, decouple_loss:0.007082426454871893
The generated pressure mean: 0.44767576456069946
The generated pressure mean: 0.4476628601551056
loss_pred:0.019082408398389816, decouple_loss:0.006992114242166281
loss_pred:0.02108413353562355, decouple_loss:0.00715450756251812
2023-04-16 10:39:08 testing...
The generated pressure mean: 0.4495830535888672
The generated pressure mean: 0.4497888684272766
The generated pressure mean: 0.44987666606903076
loss_pred:0.02804456651210785, decouple_loss:0.008395195007324219
loss_pred:0.028795814141631126, decouple_loss:0.008268454112112522
loss_pred:0.027922455221414566, decouple_loss:0.008451334200799465
Loss: 0.02867286279797554, avg_mse: 0.038252733647823334
current test mse: 0.038253
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012016_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012016_3_24hr.npz
NaN value num: 0
Iteration: 2521, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44759416580200195
loss_pred:0.020263412967324257, decouple_loss:0.008439326658844948
The generated pressure mean: 0.44634178280830383
loss_pred:0.019600117579102516, decouple_loss:0.00871980469673872
The generated pressure mean: 0.44762569665908813
loss_pred:0.020512854680418968, decouple_loss:0.00835142657160759
Iteration: 2522, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4464671015739441
loss_pred:0.020876135677099228, decouple_loss:0.008822078816592693
The generated pressure mean: 0.4466789960861206
loss_pred:0.021998457610607147, decouple_loss:0.009011544287204742
The generated pressure mean: 0.44655951857566833
loss_pred:0.02087131142616272, decouple_loss:0.008787361904978752
Iteration: 2523, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4466681480407715
loss_pred:0.020874081179499626, decouple_loss:0.008270718157291412
The generated pressure mean: 0.4477654695510864
loss_pred:0.019757993519306183, decouple_loss:0.008419510908424854
The generated pressure mean: 0.4483170509338379
loss_pred:0.020558388903737068, decouple_loss:0.008216166868805885
Iteration: 2524, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44705286622047424
loss_pred:0.021359359845519066, decouple_loss:0.009372266009449959
The generated pressure mean: 0.44748449325561523
loss_pred:0.02152685448527336, decouple_loss:0.009497673250734806
The generated pressure mean: 0.4477772116661072
loss_pred:0.020555445924401283, decouple_loss:0.009530783630907536
Iteration: 2525, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44696342945098877
loss_pred:0.021020324900746346, decouple_loss:0.008036613464355469
The generated pressure mean: 0.44960805773735046
loss_pred:0.020152797922492027, decouple_loss:0.008008657023310661
The generated pressure mean: 0.44685888290405273
loss_pred:0.02013055980205536, decouple_loss:0.008100930601358414
Iteration: 2526, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4468691349029541
loss_pred:0.02291741780936718, decouple_loss:0.008704898878932
The generated pressure mean: 0.446621298789978
loss_pred:0.021912315860390663, decouple_loss:0.00869996938854456
The generated pressure mean: 0.4469086825847626
loss_pred:0.021079171448946, decouple_loss:0.008652232587337494
Iteration: 2527, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4483056962490082
loss_pred:0.020263461396098137, decouple_loss:0.00844113714993
The generated pressure mean: 0.4475826025009155
loss_pred:0.020617879927158356, decouple_loss:0.008475364185869694
The generated pressure mean: 0.4472801983356476
loss_pred:0.020297126844525337, decouple_loss:0.008408821187913418
Iteration: 2528, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4476301968097687
loss_pred:0.019406398758292198, decouple_loss:0.007692152168601751
The generated pressure mean: 0.44703513383865356
loss_pred:0.0216489527374506, decouple_loss:0.0078062210232019424
The generated pressure mean: 0.44755110144615173
loss_pred:0.020408185198903084, decouple_loss:0.007708570919930935
Iteration: 2529, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4470483064651489
loss_pred:0.02075539529323578, decouple_loss:0.008237727917730808
The generated pressure mean: 0.44680145382881165
loss_pred:0.02101220190525055, decouple_loss:0.008110271766781807
The generated pressure mean: 0.4466017484664917
loss_pred:0.01909683644771576, decouple_loss:0.008187305182218552
Iteration: 2530, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4481349587440491
loss_pred:0.02275850810110569, decouple_loss:0.00733413640409708
The generated pressure mean: 0.4480094313621521
loss_pred:0.02159060351550579, decouple_loss:0.007333860732614994
The generated pressure mean: 0.4475051760673523
loss_pred:0.02140830084681511, decouple_loss:0.0072619132697582245
2023-04-16 10:41:33 testing...
The generated pressure mean: 0.4497888684272766
The generated pressure mean: 0.4495830833911896
The generated pressure mean: 0.44987666606903076
loss_pred:0.028369110077619553, decouple_loss:0.008260811679065228
loss_pred:0.02745230309665203, decouple_loss:0.00815595407038927
loss_pred:0.02729865536093712, decouple_loss:0.008132154121994972
Loss: 0.028115838766098022, avg_mse: 0.03721705451607704
current test mse: 0.037217
Iteration: 2531, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44765302538871765
The generated pressure mean: 0.4492480754852295loss_pred:0.023025909438729286, decouple_loss:0.008282164111733437
loss_pred:0.020927248522639275, decouple_loss:0.00832358654588461
The generated pressure mean: 0.44687673449516296
loss_pred:0.019224047660827637, decouple_loss:0.008303561247885227
Iteration: 2532, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4484513998031616
loss_pred:0.019954733550548553, decouple_loss:0.007405004929751158
The generated pressure mean: 0.44798144698143005
loss_pred:0.019649673253297806, decouple_loss:0.00717209605500102
The generated pressure mean: 0.44842371344566345
loss_pred:0.0219185259193182, decouple_loss:0.007474949583411217
Iteration: 2533, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4473802447319031
loss_pred:0.02094520628452301, decouple_loss:0.008091773837804794
The generated pressure mean: 0.447238028049469
loss_pred:0.022174809128046036, decouple_loss:0.008192650973796844
The generated pressure mean: 0.44772204756736755
loss_pred:0.021828431636095047, decouple_loss:0.008071611635386944
Iteration: 2534, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4490155279636383
loss_pred:0.018967976793646812, decouple_loss:0.008172073401510715
The generated pressure mean: 0.4464806318283081
loss_pred:0.01994696445763111, decouple_loss:0.008184608072042465
The generated pressure mean: 0.4471610486507416
loss_pred:0.021595317870378494, decouple_loss:0.007939404807984829
Iteration: 2535, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44941359758377075
loss_pred:0.02123670093715191, decouple_loss:0.007691563107073307
The generated pressure mean: 0.4484936594963074
loss_pred:0.019885003566741943, decouple_loss:0.007705999072641134
The generated pressure mean: 0.44629183411598206
loss_pred:0.019774863496422768, decouple_loss:0.007928687147796154
Iteration: 2536, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44754254817962646
loss_pred:0.020520882681012154, decouple_loss:0.007428509648889303
The generated pressure mean: 0.4469491243362427
loss_pred:0.02020423114299774, decouple_loss:0.007343990728259087
The generated pressure mean: 0.4463586211204529
loss_pred:0.020910488441586494, decouple_loss:0.007520883809775114
Iteration: 2537, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4482465088367462
loss_pred:0.019803684204816818, decouple_loss:0.008571791462600231
The generated pressure mean: 0.44851794838905334
loss_pred:0.018978552892804146, decouple_loss:0.008747370913624763
The generated pressure mean: 0.4480169117450714
loss_pred:0.019457846879959106, decouple_loss:0.008580065332353115
Iteration: 2538, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4469186067581177
loss_pred:0.022021301090717316, decouple_loss:0.007450766861438751
The generated pressure mean: 0.44666460156440735
loss_pred:0.020309049636125565, decouple_loss:0.007538447622209787
The generated pressure mean: 0.4473516047000885
loss_pred:0.020593199878931046, decouple_loss:0.007417990360409021
Iteration: 2539, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44689786434173584
loss_pred:0.019770294427871704, decouple_loss:0.007302775979042053
The generated pressure mean: 0.4468850791454315
loss_pred:0.021296290680766106, decouple_loss:0.007390686776489019
The generated pressure mean: 0.4486178457736969
loss_pred:0.01929357461631298, decouple_loss:0.007443019654601812
Iteration: 2540, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4469279646873474
loss_pred:0.020601147785782814, decouple_loss:0.007864191196858883
The generated pressure mean: 0.4476337432861328
loss_pred:0.019699491560459137, decouple_loss:0.007890385575592518
The generated pressure mean: 0.44651761651039124
loss_pred:0.020233087241649628, decouple_loss:0.00795280747115612
2023-04-16 10:43:25 testing...
The generated pressure mean: 0.449788898229599
The generated pressure mean: 0.4495830535888672
The generated pressure mean: 0.44987666606903076
loss_pred:0.02910906821489334, decouple_loss:0.0074819475412368774
loss_pred:0.028133446350693703, decouple_loss:0.007409317884594202
loss_pred:0.027609772980213165, decouple_loss:0.00739166047424078
Loss: 0.02865547686815262, avg_mse: 0.038528554141521454
current test mse: 0.038529
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012009_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012009_3_24hr.npz
NaN value num: 0
Iteration: 2541, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4481092393398285
loss_pred:0.02054193802177906, decouple_loss:0.0074397907592356205
The generated pressure mean: 0.44813576340675354
loss_pred:0.01977410353720188, decouple_loss:0.0074601429514586926
The generated pressure mean: 0.4499039351940155
loss_pred:0.020844880491495132, decouple_loss:0.007350178435444832
Iteration: 2542, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44901955127716064
The generated pressure mean: 0.44789427518844604
loss_pred:0.019687682390213013, decouple_loss:0.007436838466674089
loss_pred:0.020248938351869583, decouple_loss:0.007609520573168993
The generated pressure mean: 0.4480966627597809
loss_pred:0.020345738157629967, decouple_loss:0.007502045948058367
Iteration: 2543, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4484004080295563
The generated pressure mean: 0.44927430152893066
loss_pred:0.01961158588528633, decouple_loss:0.007223444990813732
loss_pred:0.01977667585015297, decouple_loss:0.007365287281572819
The generated pressure mean: 0.4502018690109253
loss_pred:0.022014517337083817, decouple_loss:0.007172287441790104
Iteration: 2544, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44939926266670227
The generated pressure mean: 0.4489775598049164
loss_pred:0.01928768679499626, decouple_loss:0.006937948055565357
loss_pred:0.02066287398338318, decouple_loss:0.007043211720883846
The generated pressure mean: 0.44854825735092163
loss_pred:0.022554345428943634, decouple_loss:0.0070663802325725555
Iteration: 2545, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4487477242946625
The generated pressure mean: 0.4481542408466339
loss_pred:0.020478492602705956, decouple_loss:0.0073476810939610004
loss_pred:0.02085404470562935, decouple_loss:0.007309241686016321
The generated pressure mean: 0.446489542722702
loss_pred:0.02000286616384983, decouple_loss:0.007313813082873821
Iteration: 2546, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45015114545822144
loss_pred:0.019783424213528633, decouple_loss:0.007088189013302326
The generated pressure mean: 0.4494432210922241
loss_pred:0.02066659741103649, decouple_loss:0.006951291114091873
The generated pressure mean: 0.4491191506385803
loss_pred:0.01952185295522213, decouple_loss:0.006827216129750013
Iteration: 2547, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4494730532169342
The generated pressure mean: 0.4484628736972809
loss_pred:0.02031514421105385, decouple_loss:0.0070332069881260395
loss_pred:0.019746143370866776, decouple_loss:0.006967787630856037
The generated pressure mean: 0.44910913705825806
loss_pred:0.022528989240527153, decouple_loss:0.0069473315961658955
Iteration: 2548, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4493604302406311The generated pressure mean: 0.44662219285964966
loss_pred:0.019191304221749306, decouple_loss:0.006642424501478672
loss_pred:0.019413745030760765, decouple_loss:0.0069161998108029366
The generated pressure mean: 0.4476395547389984
loss_pred:0.019759168848395348, decouple_loss:0.006728159263730049
Iteration: 2549, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44884318113327026
The generated pressure mean: 0.4490792453289032
loss_pred:0.019274288788437843, decouple_loss:0.007400634232908487
loss_pred:0.019793374463915825, decouple_loss:0.007359629962593317
The generated pressure mean: 0.4493882358074188
loss_pred:0.020392756909132004, decouple_loss:0.007332762237638235
Iteration: 2550, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4501529335975647
The generated pressure mean: 0.4472452700138092
loss_pred:0.01894046738743782, decouple_loss:0.007124398369342089
loss_pred:0.019835352897644043, decouple_loss:0.006926353555172682
The generated pressure mean: 0.44848164916038513
loss_pred:0.02060723304748535, decouple_loss:0.007166638504713774
2023-04-16 10:46:02 testing...
The generated pressure mean: 0.4495830833911896
The generated pressure mean: 0.449788898229599
The generated pressure mean: 0.44987666606903076
loss_pred:0.029182979837059975, decouple_loss:0.007370280101895332
loss_pred:0.030402863398194313, decouple_loss:0.007407942786812782
loss_pred:0.028905224055051804, decouple_loss:0.0073577482253313065
Loss: 0.02986595593392849, avg_mse: 0.04089780151844025
current test mse: 0.040898
Iteration: 2551, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4488656222820282
The generated pressure mean: 0.44869935512542725
loss_pred:0.019912738353013992, decouple_loss:0.007515044882893562
loss_pred:0.020113274455070496, decouple_loss:0.007461247034370899
The generated pressure mean: 0.4492068290710449
loss_pred:0.022493552416563034, decouple_loss:0.007314177230000496
Iteration: 2552, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44981876015663147The generated pressure mean: 0.44796690344810486
loss_pred:0.01970706135034561, decouple_loss:0.007469838950783014
loss_pred:0.020996643230319023, decouple_loss:0.00738739175722003
The generated pressure mean: 0.4478687345981598
loss_pred:0.02008388563990593, decouple_loss:0.007472063880413771
Iteration: 2553, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44916269183158875
The generated pressure mean: 0.44856056571006775
loss_pred:0.020337851718068123, decouple_loss:0.007190959062427282
loss_pred:0.020999126136302948, decouple_loss:0.007386169862002134
The generated pressure mean: 0.44998177886009216
loss_pred:0.019192487001419067, decouple_loss:0.007187779061496258
Iteration: 2554, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44738608598709106
The generated pressure mean: 0.4491323232650757
loss_pred:0.01969967782497406, decouple_loss:0.007346874102950096
loss_pred:0.01873701997101307, decouple_loss:0.007275623735040426
The generated pressure mean: 0.4481106400489807
loss_pred:0.022306406870484352, decouple_loss:0.007280031684786081
Iteration: 2555, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4475764036178589
The generated pressure mean: 0.44880861043930054
loss_pred:0.020695382729172707, decouple_loss:0.006987629923969507
loss_pred:0.0196538046002388, decouple_loss:0.0070210970006883144
The generated pressure mean: 0.4483877718448639
loss_pred:0.01911969669163227, decouple_loss:0.0071126725524663925
Iteration: 2556, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4504079818725586
The generated pressure mean: 0.4486571252346039
loss_pred:0.02019336447119713, decouple_loss:0.006947666872292757
loss_pred:0.020848574116826057, decouple_loss:0.007182363420724869
The generated pressure mean: 0.44935810565948486
loss_pred:0.021023552864789963, decouple_loss:0.007010017521679401
Iteration: 2557, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4487566351890564
loss_pred:0.01932348683476448, decouple_loss:0.007109043188393116
The generated pressure mean: 0.4497900903224945
loss_pred:0.021256007254123688, decouple_loss:0.007293666712939739
The generated pressure mean: 0.44772836565971375
loss_pred:0.01926199160516262, decouple_loss:0.006967104505747557
Iteration: 2558, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4485054016113281
The generated pressure mean: 0.447726845741272
loss_pred:0.01901465468108654, decouple_loss:0.0072140260599553585
loss_pred:0.020575225353240967, decouple_loss:0.007218909915536642
The generated pressure mean: 0.44974711537361145
loss_pred:0.020397810265421867, decouple_loss:0.007308315485715866
Iteration: 2559, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4495813846588135
The generated pressure mean: 0.44952392578125
loss_pred:0.02010418474674225, decouple_loss:0.006799913477152586
loss_pred:0.01961454190313816, decouple_loss:0.006824159063398838
The generated pressure mean: 0.4478866457939148
loss_pred:0.019378945231437683, decouple_loss:0.0066397348418831825
Iteration: 2560, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44882893562316895
The generated pressure mean: 0.44852960109710693
loss_pred:0.020956002175807953, decouple_loss:0.007070641964673996
loss_pred:0.01943509839475155, decouple_loss:0.007040692027658224
The generated pressure mean: 0.44888004660606384
loss_pred:0.019201206043362617, decouple_loss:0.0070319268852472305
2023-04-16 10:47:53 testing...
The generated pressure mean: 0.4495830833911896
The generated pressure mean: 0.449788898229599
The generated pressure mean: 0.44987666606903076
loss_pred:0.02791019156575203, decouple_loss:0.00677180290222168
loss_pred:0.028894033282995224, decouple_loss:0.006706480868160725
loss_pred:0.027746830135583878, decouple_loss:0.006838405039161444
Loss: 0.028522295877337456, avg_mse: 0.03843972086906433
current test mse: 0.03844
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012008_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012008_3_24hr.npz
NaN value num: 0
Iteration: 2561, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4460991322994232
loss_pred:0.019040986895561218, decouple_loss:0.006781629752367735
The generated pressure mean: 0.4468380808830261
loss_pred:0.01951592229306698, decouple_loss:0.006955948192626238
The generated pressure mean: 0.44517549872398376
loss_pred:0.019256148487329483, decouple_loss:0.006716445088386536
Iteration: 2562, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4472448229789734
loss_pred:0.020506061613559723, decouple_loss:0.006950538605451584
The generated pressure mean: 0.44656580686569214
loss_pred:0.020228222012519836, decouple_loss:0.006826639175415039
The generated pressure mean: 0.44674137234687805
loss_pred:0.019270244985818863, decouple_loss:0.007094813976436853
Iteration: 2563, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44770076870918274
loss_pred:0.020187797024846077, decouple_loss:0.0071207270957529545
The generated pressure mean: 0.4465153217315674
loss_pred:0.019160883501172066, decouple_loss:0.007034929934889078
The generated pressure mean: 0.44700536131858826
loss_pred:0.018648922443389893, decouple_loss:0.0068260012194514275
Iteration: 2564, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44643449783325195
loss_pred:0.019756726920604706, decouple_loss:0.006562860682606697
The generated pressure mean: 0.4467034637928009
loss_pred:0.020722361281514168, decouple_loss:0.006646648049354553
The generated pressure mean: 0.44605761766433716
loss_pred:0.020544789731502533, decouple_loss:0.006666285451501608
Iteration: 2565, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4466235339641571
loss_pred:0.019249269738793373, decouple_loss:0.006785644683986902
The generated pressure mean: 0.44634103775024414
loss_pred:0.01994379051029682, decouple_loss:0.006801884155720472
The generated pressure mean: 0.44715139269828796
loss_pred:0.02009911648929119, decouple_loss:0.006821171846240759
Iteration: 2566, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4468212425708771
loss_pred:0.01975991763174534, decouple_loss:0.007749626878648996
The generated pressure mean: 0.4459965229034424
loss_pred:0.020489158108830452, decouple_loss:0.007733134087175131
The generated pressure mean: 0.44712939858436584
loss_pred:0.019544534385204315, decouple_loss:0.007573679089546204
Iteration: 2567, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44694986939430237
loss_pred:0.020437613129615784, decouple_loss:0.006712706759572029
The generated pressure mean: 0.4465217888355255
loss_pred:0.019139183685183525, decouple_loss:0.006686589680612087
The generated pressure mean: 0.4466697573661804
loss_pred:0.019236929714679718, decouple_loss:0.006583775393664837
Iteration: 2568, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44530776143074036
loss_pred:0.01983984187245369, decouple_loss:0.009110584855079651
The generated pressure mean: 0.4463663399219513
loss_pred:0.020924042910337448, decouple_loss:0.00895665306597948
The generated pressure mean: 0.44734692573547363
loss_pred:0.019449133425951004, decouple_loss:0.008911794982850552
Iteration: 2569, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44610631465911865
loss_pred:0.019605174660682678, decouple_loss:0.007644040044397116
The generated pressure mean: 0.4468129873275757
loss_pred:0.0191311314702034, decouple_loss:0.007548450026661158
The generated pressure mean: 0.44756370782852173
loss_pred:0.018696928396821022, decouple_loss:0.007561767939478159
Iteration: 2570, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4469769299030304
The generated pressure mean: 0.4477647840976715
loss_pred:0.020752713084220886, decouple_loss:0.0073155490681529045
loss_pred:0.020154399797320366, decouple_loss:0.007193935569375753
The generated pressure mean: 0.44680145382881165
loss_pred:0.019746704027056694, decouple_loss:0.007217358332127333
2023-04-16 10:50:19 testing...
The generated pressure mean: 0.4497888684272766
The generated pressure mean: 0.4495830535888672
The generated pressure mean: 0.44987666606903076
loss_pred:0.027921203523874283, decouple_loss:0.007374939974397421
loss_pred:0.026956787332892418, decouple_loss:0.007329884916543961
loss_pred:0.02654692344367504, decouple_loss:0.007283878978341818
Loss: 0.027508117258548737, avg_mse: 0.0363471582531929
current test mse: 0.036347
Iteration: 2571, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4464333653450012
loss_pred:0.019497284665703773, decouple_loss:0.007198895327746868
The generated pressure mean: 0.4453771710395813
loss_pred:0.020799264311790466, decouple_loss:0.007304084952920675
The generated pressure mean: 0.44657978415489197
loss_pred:0.019605763256549835, decouple_loss:0.007290339097380638
Iteration: 2572, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44705235958099365
The generated pressure mean: 0.4456709921360016
loss_pred:0.01952192559838295, decouple_loss:0.007405700162053108
loss_pred:0.020074008032679558, decouple_loss:0.00733294477686286
The generated pressure mean: 0.446519672870636
loss_pred:0.021074866876006126, decouple_loss:0.007350307423621416
Iteration: 2573, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.446666419506073
The generated pressure mean: 0.44698435068130493
loss_pred:0.018986232578754425, decouple_loss:0.007388631347566843
loss_pred:0.018703574314713478, decouple_loss:0.007276581134647131
The generated pressure mean: 0.4470561742782593
loss_pred:0.019693845883011818, decouple_loss:0.007325468119233847
Iteration: 2574, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44759318232536316
loss_pred:0.01933697611093521, decouple_loss:0.007190818432718515
The generated pressure mean: 0.4461154639720917
loss_pred:0.02036188915371895, decouple_loss:0.0072451368905603886
The generated pressure mean: 0.4460671544075012
loss_pred:0.01857159473001957, decouple_loss:0.00724348658695817
Iteration: 2575, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44632676243782043
loss_pred:0.020028309896588326, decouple_loss:0.0076637365855276585
The generated pressure mean: 0.4468703269958496
loss_pred:0.019318953156471252, decouple_loss:0.007896079681813717
The generated pressure mean: 0.44725301861763
loss_pred:0.02158082090318203, decouple_loss:0.007943650707602501
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 2576, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4461234509944916
loss_pred:0.019292645156383514, decouple_loss:0.0073396903462708
The generated pressure mean: 0.44794607162475586
loss_pred:0.019438227638602257, decouple_loss:0.007515321020036936
The generated pressure mean: 0.44688060879707336
loss_pred:0.01844465732574463, decouple_loss:0.007312655448913574
Iteration: 2577, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44679540395736694
loss_pred:0.019615672528743744, decouple_loss:0.007425366435199976
The generated pressure mean: 0.4463392496109009
loss_pred:0.021139269694685936, decouple_loss:0.007389731705188751
The generated pressure mean: 0.44680383801460266
loss_pred:0.01891450770199299, decouple_loss:0.007331589236855507
Iteration: 2578, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4452042877674103
loss_pred:0.02048945054411888, decouple_loss:0.008329917676746845
The generated pressure mean: 0.44740474224090576
loss_pred:0.019725941121578217, decouple_loss:0.008455038070678711
The generated pressure mean: 0.44701674580574036
loss_pred:0.01998826302587986, decouple_loss:0.008487139828503132
Iteration: 2579, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44678202271461487
loss_pred:0.020435873419046402, decouple_loss:0.0076255714520812035
The generated pressure mean: 0.4484494626522064
loss_pred:0.01920698583126068, decouple_loss:0.0076304166577756405
The generated pressure mean: 0.44758808612823486
loss_pred:0.01847010850906372, decouple_loss:0.007608375977724791
Iteration: 2580, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44671717286109924
loss_pred:0.020032651722431183, decouple_loss:0.007652056869119406
The generated pressure mean: 0.4467865228652954
loss_pred:0.018979443237185478, decouple_loss:0.007478404324501753
The generated pressure mean: 0.4466151297092438
loss_pred:0.01842443458735943, decouple_loss:0.007568115834146738
2023-04-16 10:52:10 testing...
The generated pressure mean: 0.4495830535888672
The generated pressure mean: 0.449788898229599
The generated pressure mean: 0.44987666606903076
loss_pred:0.0278153195977211, decouple_loss:0.007241864688694477
loss_pred:0.02864237315952778, decouple_loss:0.007205383386462927
loss_pred:0.027444543316960335, decouple_loss:0.007207270245999098
Loss: 0.028328320011496544, avg_mse: 0.03805095702409744
current test mse: 0.038051
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012005_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012005_3_24hr.npz
NaN value num: 0
Iteration: 2581, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45034259557724
loss_pred:0.018366623669862747, decouple_loss:0.007322642020881176
The generated pressure mean: 0.44875338673591614
loss_pred:0.018382497131824493, decouple_loss:0.0072997575625777245
The generated pressure mean: 0.4496532380580902
loss_pred:0.020249392837285995, decouple_loss:0.007281534839421511
Iteration: 2582, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.448871374130249
The generated pressure mean: 0.45059481263160706
loss_pred:0.022333195433020592, decouple_loss:0.007768347393721342
loss_pred:0.019811728969216347, decouple_loss:0.007631269749253988
The generated pressure mean: 0.44891074299812317
loss_pred:0.020193301141262054, decouple_loss:0.007818260230123997
Iteration: 2583, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4494202733039856
loss_pred:0.018724359571933746, decouple_loss:0.0069252438843250275
The generated pressure mean: 0.4500133991241455
loss_pred:0.01847861520946026, decouple_loss:0.007050666958093643
The generated pressure mean: 0.450418621301651
loss_pred:0.019545940682291985, decouple_loss:0.007084572222083807
Iteration: 2584, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44841182231903076
The generated pressure mean: 0.44836828112602234
loss_pred:0.01952863298356533, decouple_loss:0.007850266061723232
loss_pred:0.019919423386454582, decouple_loss:0.00788524467498064
The generated pressure mean: 0.449405699968338
loss_pred:0.021882789209485054, decouple_loss:0.007890727370977402
Iteration: 2585, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4502430558204651
The generated pressure mean: 0.449445515871048
loss_pred:0.01903499849140644, decouple_loss:0.007523678708821535
loss_pred:0.019888918846845627, decouple_loss:0.00758819654583931
The generated pressure mean: 0.4483104944229126
loss_pred:0.020366301760077477, decouple_loss:0.007536646910011768
Iteration: 2586, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4496975243091583
The generated pressure mean: 0.4487708508968353
loss_pred:0.020326150581240654, decouple_loss:0.00903971865773201
loss_pred:0.02001071907579899, decouple_loss:0.00905286893248558
The generated pressure mean: 0.45058080554008484
loss_pred:0.018155893310904503, decouple_loss:0.008957442827522755
Iteration: 2587, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4502055048942566
The generated pressure mean: 0.4500689208507538
loss_pred:0.018953673541545868, decouple_loss:0.00710106547921896
loss_pred:0.019308220595121384, decouple_loss:0.0071066576056182384
The generated pressure mean: 0.4499286413192749
loss_pred:0.01826309971511364, decouple_loss:0.0071164872497320175
Iteration: 2588, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4493323266506195The generated pressure mean: 0.44795697927474976
loss_pred:0.02117633819580078, decouple_loss:0.007904155179858208
loss_pred:0.019159944728016853, decouple_loss:0.007851971313357353
The generated pressure mean: 0.4498547613620758
loss_pred:0.019110726192593575, decouple_loss:0.008035737089812756
Iteration: 2589, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4502823054790497
The generated pressure mean: 0.44825124740600586
loss_pred:0.017978066578507423, decouple_loss:0.006900253240019083
loss_pred:0.019562339410185814, decouple_loss:0.0068795629777014256
The generated pressure mean: 0.4490104019641876
loss_pred:0.020164960995316505, decouple_loss:0.0069611589424312115
Iteration: 2590, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45016369223594666
The generated pressure mean: 0.45011699199676514
loss_pred:0.018297219648957253, decouple_loss:0.007480767089873552
loss_pred:0.01978396065533161, decouple_loss:0.007483679801225662
The generated pressure mean: 0.449002742767334
loss_pred:0.019366826862096786, decouple_loss:0.007407020777463913
2023-04-16 10:54:35 testing...
The generated pressure mean: 0.449788898229599
The generated pressure mean: 0.4495830833911896
The generated pressure mean: 0.44987666606903076
loss_pred:0.027865838259458542, decouple_loss:0.007935178466141224
loss_pred:0.026984333992004395, decouple_loss:0.007934696041047573
loss_pred:0.026960406452417374, decouple_loss:0.007926372811198235
Loss: 0.02766679786145687, avg_mse: 0.03663957864046097
current test mse: 0.03664
Iteration: 2591, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4493190050125122
The generated pressure mean: 0.448622465133667
loss_pred:0.019520264118909836, decouple_loss:0.007956190966069698
loss_pred:0.019872525706887245, decouple_loss:0.007851705886423588
The generated pressure mean: 0.44941654801368713
loss_pred:0.019215837121009827, decouple_loss:0.007837997749447823
Iteration: 2592, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4496974050998688
loss_pred:0.02024553157389164, decouple_loss:0.006999132689088583
The generated pressure mean: 0.4492276608943939
loss_pred:0.0193362757563591, decouple_loss:0.007072555832564831
The generated pressure mean: 0.450771301984787
loss_pred:0.01914457604289055, decouple_loss:0.0070196217857301235
Iteration: 2593, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44951102137565613
The generated pressure mean: 0.4502854347229004
loss_pred:0.018194830045104027, decouple_loss:0.007476698607206345
loss_pred:0.019931554794311523, decouple_loss:0.007482640910893679
The generated pressure mean: 0.4502201974391937
loss_pred:0.018118061125278473, decouple_loss:0.007486604619771242
Iteration: 2594, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4495910704135895
loss_pred:0.018494553864002228, decouple_loss:0.007615122944116592
The generated pressure mean: 0.44910547137260437
loss_pred:0.019844137132167816, decouple_loss:0.007761494722217321
The generated pressure mean: 0.4499109387397766
loss_pred:0.019204212352633476, decouple_loss:0.007815316319465637
Iteration: 2595, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44905534386634827
loss_pred:0.020464325323700905, decouple_loss:0.006908273324370384
The generated pressure mean: 0.4472403824329376
loss_pred:0.018695475533604622, decouple_loss:0.006770039908587933
The generated pressure mean: 0.449152410030365
loss_pred:0.019596118479967117, decouple_loss:0.006866906303912401
Iteration: 2596, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4475288987159729
loss_pred:0.019722910597920418, decouple_loss:0.007214267738163471
The generated pressure mean: 0.4484518766403198
loss_pred:0.020738929510116577, decouple_loss:0.007116633467376232
The generated pressure mean: 0.4490041434764862
loss_pred:0.01944846101105213, decouple_loss:0.007235702592879534
Iteration: 2597, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4472036361694336
The generated pressure mean: 0.4478796720504761
loss_pred:0.019072672352194786, decouple_loss:0.007242492400109768
loss_pred:0.01994713395833969, decouple_loss:0.007206229958683252
The generated pressure mean: 0.447736918926239
loss_pred:0.018587980419397354, decouple_loss:0.007236879784613848
Iteration: 2598, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4495620131492615
The generated pressure mean: 0.44892197847366333
loss_pred:0.019841555505990982, decouple_loss:0.007748403120785952
loss_pred:0.02146315388381481, decouple_loss:0.007621695287525654
The generated pressure mean: 0.4490760862827301
loss_pred:0.019510554149746895, decouple_loss:0.0076499511487782
Iteration: 2599, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.450539231300354
The generated pressure mean: 0.4475174844264984
loss_pred:0.018173571676015854, decouple_loss:0.007369236554950476
loss_pred:0.018855275586247444, decouple_loss:0.0074275522492825985
The generated pressure mean: 0.45044639706611633
loss_pred:0.01851891539990902, decouple_loss:0.0074424054473638535
Iteration: 2600, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4494415521621704
loss_pred:0.019383316859602928, decouple_loss:0.006879375781863928
The generated pressure mean: 0.4489338994026184
loss_pred:0.019179945811629295, decouple_loss:0.006884977221488953
The generated pressure mean: 0.4504387676715851
loss_pred:0.018825918436050415, decouple_loss:0.006917907390743494
2023-04-16 10:56:27 testing...
The generated pressure mean: 0.4497888684272766
The generated pressure mean: 0.4495830535888672
The generated pressure mean: 0.44987666606903076
loss_pred:0.028436968103051186, decouple_loss:0.006988287903368473
loss_pred:0.02782418206334114, decouple_loss:0.006902460474520922
loss_pred:0.027649346739053726, decouple_loss:0.006898537278175354
Loss: 0.02831665426492691, avg_mse: 0.03816885128617287
current test mse: 0.038169
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012010_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012010_3_24hr.npz
NaN value num: 0
Iteration: 2601, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4472044110298157
loss_pred:0.019335780292749405, decouple_loss:0.0069979894906282425
The generated pressure mean: 0.4472287595272064
The generated pressure mean: 0.4486684203147888
loss_pred:0.020154371857643127, decouple_loss:0.006976578384637833
loss_pred:0.019846301525831223, decouple_loss:0.007002250757068396
Iteration: 2602, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44746920466423035
The generated pressure mean: 0.447172075510025
loss_pred:0.019292481243610382, decouple_loss:0.006481454707682133
loss_pred:0.02001836523413658, decouple_loss:0.006300537846982479
The generated pressure mean: 0.44666987657546997
loss_pred:0.020063819363713264, decouple_loss:0.006363621447235346
Iteration: 2603, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44812914729118347
loss_pred:0.0198251660913229, decouple_loss:0.007243905682116747
The generated pressure mean: 0.44735005497932434
loss_pred:0.019585460424423218, decouple_loss:0.007298971526324749
The generated pressure mean: 0.4464516043663025
loss_pred:0.020514249801635742, decouple_loss:0.007084378972649574
Iteration: 2604, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4478238523006439
loss_pred:0.019388465210795403, decouple_loss:0.006028220988810062
The generated pressure mean: 0.44849157333374023
loss_pred:0.018845954909920692, decouple_loss:0.006031753960996866
The generated pressure mean: 0.44715961813926697
loss_pred:0.019187893718481064, decouple_loss:0.00603304011747241
Iteration: 2605, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44893425703048706
loss_pred:0.019782859832048416, decouple_loss:0.006494864821434021
The generated pressure mean: 0.447517991065979
loss_pred:0.018448689952492714, decouple_loss:0.006459049414843321
The generated pressure mean: 0.4479628801345825
loss_pred:0.020016513764858246, decouple_loss:0.006355363875627518
Iteration: 2606, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.447221040725708
loss_pred:0.019112227484583855, decouple_loss:0.006324515677988529
The generated pressure mean: 0.4484303593635559
loss_pred:0.018578313291072845, decouple_loss:0.00639856094494462
The generated pressure mean: 0.44821107387542725
loss_pred:0.018824784085154533, decouple_loss:0.006425611209124327
Iteration: 2607, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44848939776420593
loss_pred:0.019016332924365997, decouple_loss:0.006837504915893078
The generated pressure mean: 0.44876834750175476
loss_pred:0.019107144325971603, decouple_loss:0.00671137310564518
The generated pressure mean: 0.4480065703392029
loss_pred:0.019494539126753807, decouple_loss:0.006795387249439955
Iteration: 2608, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4469423294067383
loss_pred:0.019317222759127617, decouple_loss:0.0059812553226947784
The generated pressure mean: 0.44741079211235046
loss_pred:0.019014541059732437, decouple_loss:0.00614485377445817
The generated pressure mean: 0.4473575949668884
loss_pred:0.019936349242925644, decouple_loss:0.005941626615822315
Iteration: 2609, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4485774338245392
loss_pred:0.018350718542933464, decouple_loss:0.007008875720202923
The generated pressure mean: 0.446647047996521
loss_pred:0.02013334073126316, decouple_loss:0.007173849735409021
The generated pressure mean: 0.4472768306732178
loss_pred:0.019907860085368156, decouple_loss:0.00723286485299468
Iteration: 2610, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4469960927963257
loss_pred:0.02027752250432968, decouple_loss:0.006634707096964121
The generated pressure mean: 0.4465717077255249
loss_pred:0.019650200381875038, decouple_loss:0.006682058330625296
The generated pressure mean: 0.4468585252761841
loss_pred:0.019221527501940727, decouple_loss:0.0066834851168096066
2023-04-16 10:59:05 testing...
The generated pressure mean: 0.449788898229599
The generated pressure mean: 0.4495830535888672
The generated pressure mean: 0.44987666606903076
loss_pred:0.027302734553813934, decouple_loss:0.007346558850258589
loss_pred:0.026320621371269226, decouple_loss:0.0074830250814557076
loss_pred:0.02606070041656494, decouple_loss:0.007614037953317165
Loss: 0.026935413479804993, avg_mse: 0.035477884113788605
current test mse: 0.035478
Iteration: 2611, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4480859935283661
loss_pred:0.018403705209493637, decouple_loss:0.0074574993923306465
The generated pressure mean: 0.4479084014892578
loss_pred:0.018872028216719627, decouple_loss:0.007314328104257584
The generated pressure mean: 0.4467315375804901
loss_pred:0.01912631280720234, decouple_loss:0.00734529085457325
Iteration: 2612, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44782301783561707
The generated pressure mean: 0.4480511248111725
loss_pred:0.020024502649903297, decouple_loss:0.006798888556659222
loss_pred:0.019978011026978493, decouple_loss:0.006983791012316942
The generated pressure mean: 0.447181761264801
loss_pred:0.022175580263137817, decouple_loss:0.006878598127514124
Iteration: 2613, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44818034768104553
loss_pred:0.019559789448976517, decouple_loss:0.006928847171366215
The generated pressure mean: 0.44710665941238403
loss_pred:0.02042333222925663, decouple_loss:0.006789886858314276
The generated pressure mean: 0.447144091129303
loss_pred:0.019379105418920517, decouple_loss:0.006983708590269089
Iteration: 2614, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44917985796928406
loss_pred:0.01849372498691082, decouple_loss:0.006448990199714899
The generated pressure mean: 0.4481261074542999
loss_pred:0.020455457270145416, decouple_loss:0.006508331745862961
The generated pressure mean: 0.4482623338699341
loss_pred:0.020189279690384865, decouple_loss:0.006553699262440205
Iteration: 2615, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4480394124984741
loss_pred:0.01911192201077938, decouple_loss:0.006594205740839243
The generated pressure mean: 0.446898490190506
loss_pred:0.01938541606068611, decouple_loss:0.006526865530759096
The generated pressure mean: 0.44782400131225586
loss_pred:0.01870686374604702, decouple_loss:0.0064549255184829235
Iteration: 2616, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44711413979530334
loss_pred:0.018830938264727592, decouple_loss:0.006688774563372135
The generated pressure mean: 0.4476015865802765
loss_pred:0.022479066625237465, decouple_loss:0.006691386457532644
The generated pressure mean: 0.4477773904800415
loss_pred:0.02004435285925865, decouple_loss:0.0067216320894658566
Iteration: 2617, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44812214374542236
loss_pred:0.01861274056136608, decouple_loss:0.006672210525721312
The generated pressure mean: 0.4477115571498871
loss_pred:0.019215784966945648, decouple_loss:0.006698794197291136
The generated pressure mean: 0.4488455355167389
loss_pred:0.01845257356762886, decouple_loss:0.006657755002379417
Iteration: 2618, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44689860939979553
loss_pred:0.019807515665888786, decouple_loss:0.006698062643408775
The generated pressure mean: 0.4476369321346283
loss_pred:0.021618058905005455, decouple_loss:0.006714605260640383
The generated pressure mean: 0.44752365350723267
loss_pred:0.02007843367755413, decouple_loss:0.0066443621180951595
Iteration: 2619, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44832539558410645
loss_pred:0.019223053008317947, decouple_loss:0.006335792131721973
The generated pressure mean: 0.4472237229347229
loss_pred:0.018687399104237556, decouple_loss:0.006216645240783691
The generated pressure mean: 0.44752150774002075
loss_pred:0.021015625447034836, decouple_loss:0.006252788472920656
Iteration: 2620, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4472235441207886
The generated pressure mean: 0.44840559363365173
loss_pred:0.019530221819877625, decouple_loss:0.006165552418678999
loss_pred:0.018253054469823837, decouple_loss:0.006393216084688902
The generated pressure mean: 0.44775867462158203
loss_pred:0.01905927248299122, decouple_loss:0.0061624664813280106
2023-04-16 11:00:56 testing...
The generated pressure mean: 0.449788898229599
The generated pressure mean: 0.4495830535888672
The generated pressure mean: 0.44987666606903076
loss_pred:0.027956904843449593, decouple_loss:0.006480252370238304
loss_pred:0.02704516239464283, decouple_loss:0.006399126723408699
loss_pred:0.026745470240712166, decouple_loss:0.006291261874139309
Loss: 0.027568690478801727, avg_mse: 0.03680841252207756
current test mse: 0.036808
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012011_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012011_3_24hr.npz
NaN value num: 0
Iteration: 2621, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44883668422698975
loss_pred:0.021204331889748573, decouple_loss:0.006596425082534552
The generated pressure mean: 0.44760069251060486
loss_pred:0.02044118009507656, decouple_loss:0.006457846146076918
The generated pressure mean: 0.4467123746871948
loss_pred:0.02080591395497322, decouple_loss:0.006420808844268322
Iteration: 2622, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4452894926071167
The generated pressure mean: 0.4472636580467224
loss_pred:0.0190825704485178, decouple_loss:0.006007678806781769
loss_pred:0.019815878942608833, decouple_loss:0.0060019539669156075
The generated pressure mean: 0.4461468756198883
loss_pred:0.019345270469784737, decouple_loss:0.00602731155231595
Iteration: 2623, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44646894931793213The generated pressure mean: 0.4456796944141388
loss_pred:0.01904914155602455, decouple_loss:0.0064727612771093845loss_pred:0.020654702559113503, decouple_loss:0.006446021609008312
The generated pressure mean: 0.4459315538406372
loss_pred:0.019984280690550804, decouple_loss:0.006416880525648594
Iteration: 2624, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4463035464286804The generated pressure mean: 0.4475928544998169
loss_pred:0.018744561821222305, decouple_loss:0.006352301221340895loss_pred:0.019274817779660225, decouple_loss:0.006306455470621586
The generated pressure mean: 0.44751569628715515
loss_pred:0.01927567645907402, decouple_loss:0.006288310047239065
Iteration: 2625, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4473477303981781
The generated pressure mean: 0.4468763768672943
loss_pred:0.01877237670123577, decouple_loss:0.006494239903986454
loss_pred:0.020063448697328568, decouple_loss:0.006693067029118538
The generated pressure mean: 0.4468236267566681
loss_pred:0.019672274589538574, decouple_loss:0.0064441184513270855
Iteration: 2626, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4472138285636902
The generated pressure mean: 0.44691959023475647
loss_pred:0.020725928246974945, decouple_loss:0.0057715424336493015
loss_pred:0.01836615800857544, decouple_loss:0.005747614894062281
The generated pressure mean: 0.44632503390312195
loss_pred:0.01857323944568634, decouple_loss:0.005866618826985359
Iteration: 2627, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4480065703392029
The generated pressure mean: 0.44641295075416565
loss_pred:0.019905967637896538, decouple_loss:0.006737141869962215
loss_pred:0.019574450328946114, decouple_loss:0.006633331533521414
The generated pressure mean: 0.44582653045654297
loss_pred:0.021020693704485893, decouple_loss:0.006657157558947802
Iteration: 2628, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44647493958473206
The generated pressure mean: 0.4464486241340637
loss_pred:0.01947491616010666, decouple_loss:0.005891114939004183
loss_pred:0.020031435415148735, decouple_loss:0.005999285262078047
The generated pressure mean: 0.44662079215049744
loss_pred:0.018910545855760574, decouple_loss:0.005808122921735048
Iteration: 2629, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44859591126441956
The generated pressure mean: 0.44810670614242554
loss_pred:0.021053411066532135, decouple_loss:0.007161242887377739
loss_pred:0.019859496504068375, decouple_loss:0.0071155414916574955
The generated pressure mean: 0.44609498977661133
loss_pred:0.02030905708670616, decouple_loss:0.00723609235137701
Iteration: 2630, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44732922315597534
loss_pred:0.01976626366376877, decouple_loss:0.006745398510247469
The generated pressure mean: 0.44627130031585693
loss_pred:0.02021666243672371, decouple_loss:0.006599821150302887
The generated pressure mean: 0.44582533836364746
loss_pred:0.019244594499468803, decouple_loss:0.006583204492926598
2023-04-16 11:03:31 testing...
The generated pressure mean: 0.4497888684272766
The generated pressure mean: 0.4495830535888672
The generated pressure mean: 0.44987666606903076
loss_pred:0.028796428814530373, decouple_loss:0.0075896428897976875
loss_pred:0.028079012408852577, decouple_loss:0.007498278748244047
loss_pred:0.027630196884274483, decouple_loss:0.007580525241792202
Loss: 0.028546353802084923, avg_mse: 0.0383337140083313
current test mse: 0.038334
Iteration: 2631, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4462599456310272
loss_pred:0.02098117768764496, decouple_loss:0.007555438671261072
The generated pressure mean: 0.44710493087768555
loss_pred:0.02042515017092228, decouple_loss:0.00751684932038188
The generated pressure mean: 0.44879674911499023
loss_pred:0.021262643858790398, decouple_loss:0.007601895835250616
Iteration: 2632, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44739651679992676
loss_pred:0.020999504253268242, decouple_loss:0.009512440301477909
The generated pressure mean: 0.44677528738975525
loss_pred:0.022548988461494446, decouple_loss:0.0097117368131876
The generated pressure mean: 0.4462074935436249
loss_pred:0.02067539654672146, decouple_loss:0.00952304620295763
Iteration: 2633, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.448574036359787
The generated pressure mean: 0.44577547907829285
loss_pred:0.02110748365521431, decouple_loss:0.008233442902565002
loss_pred:0.020455891266465187, decouple_loss:0.008009546436369419
The generated pressure mean: 0.44885820150375366
loss_pred:0.02029326744377613, decouple_loss:0.00814722292125225
Iteration: 2634, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44817230105400085
The generated pressure mean: 0.4479667544364929
loss_pred:0.020474497228860855, decouple_loss:0.008023714646697044
loss_pred:0.02031959779560566, decouple_loss:0.00795971229672432
The generated pressure mean: 0.4459937512874603
loss_pred:0.022274186834692955, decouple_loss:0.00832735188305378
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 2635, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4467659592628479
The generated pressure mean: 0.4466908872127533
loss_pred:0.019587872549891472, decouple_loss:0.009362290613353252
loss_pred:0.019114388152956963, decouple_loss:0.009323809295892715
The generated pressure mean: 0.44664016366004944
loss_pred:0.02028846926987171, decouple_loss:0.009387845173478127
Iteration: 2636, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44746023416519165
The generated pressure mean: 0.44667911529541016
loss_pred:0.019369127228856087, decouple_loss:0.007768569048494101
loss_pred:0.020382655784487724, decouple_loss:0.007635688409209251
The generated pressure mean: 0.4468863308429718
loss_pred:0.019377535209059715, decouple_loss:0.007665729150176048
Iteration: 2637, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4483022689819336
The generated pressure mean: 0.44734594225883484
loss_pred:0.019635802134871483, decouple_loss:0.008709799498319626
loss_pred:0.020416950806975365, decouple_loss:0.008642790839076042
The generated pressure mean: 0.4474707841873169
loss_pred:0.019398149102926254, decouple_loss:0.008703876286745071
Iteration: 2638, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44704753160476685
The generated pressure mean: 0.4481782019138336
loss_pred:0.020404737442731857, decouple_loss:0.00806630589067936
loss_pred:0.018823057413101196, decouple_loss:0.008061506785452366
The generated pressure mean: 0.4478110074996948
loss_pred:0.019499974325299263, decouple_loss:0.008213109336793423
Iteration: 2639, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44525769352912903
The generated pressure mean: 0.4460310637950897
loss_pred:0.019721077755093575, decouple_loss:0.009187918156385422
loss_pred:0.02085329033434391, decouple_loss:0.009138424880802631
The generated pressure mean: 0.4482031464576721
loss_pred:0.019873492419719696, decouple_loss:0.009265672415494919
Iteration: 2640, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44904762506484985
The generated pressure mean: 0.4474453330039978
loss_pred:0.022746115922927856, decouple_loss:0.010949557647109032
loss_pred:0.021390845999121666, decouple_loss:0.010894961655139923
The generated pressure mean: 0.44568493962287903
loss_pred:0.020920658484101295, decouple_loss:0.010846482589840889
2023-04-16 11:05:23 testing...
The generated pressure mean: 0.4495830535888672
The generated pressure mean: 0.4497888684272766
The generated pressure mean: 0.44987666606903076
loss_pred:0.02928590402007103, decouple_loss:0.011672680266201496
loss_pred:0.029812419787049294, decouple_loss:0.011702390387654305
loss_pred:0.028768479824066162, decouple_loss:0.011731794103980064
Loss: 0.029874049127101898, avg_mse: 0.03909317031502724
current test mse: 0.039093
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012005_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012005_3_24hr.npz
NaN value num: 0
Iteration: 2641, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44847413897514343
loss_pred:0.022585930302739143, decouple_loss:0.011876093223690987
The generated pressure mean: 0.4487855136394501
loss_pred:0.021136200055480003, decouple_loss:0.011898834258317947
The generated pressure mean: 0.4492049813270569
loss_pred:0.021095680072903633, decouple_loss:0.011804903857409954
Iteration: 2642, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44807833433151245
The generated pressure mean: 0.4478801488876343
loss_pred:0.020948752760887146, decouple_loss:0.009539440274238586
loss_pred:0.02042287215590477, decouple_loss:0.009725052863359451
The generated pressure mean: 0.448984295129776
loss_pred:0.021315963938832283, decouple_loss:0.009728179313242435
Iteration: 2643, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44756248593330383
The generated pressure mean: 0.4495488703250885
loss_pred:0.02016977220773697, decouple_loss:0.009233967401087284
loss_pred:0.021202534437179565, decouple_loss:0.009352941997349262
The generated pressure mean: 0.44876736402511597
loss_pred:0.021831180900335312, decouple_loss:0.00939631462097168
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 2644, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44868943095207214
loss_pred:0.020470531657338142, decouple_loss:0.008970865979790688
The generated pressure mean: 0.4485089182853699
loss_pred:0.019015338271856308, decouple_loss:0.00902255903929472
The generated pressure mean: 0.4487197995185852
loss_pred:0.019039109349250793, decouple_loss:0.008973435498774052
Iteration: 2645, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4485745131969452The generated pressure mean: 0.4471951127052307
loss_pred:0.020482970401644707, decouple_loss:0.00950613897293806
loss_pred:0.019980348646640778, decouple_loss:0.0094706816598773
The generated pressure mean: 0.44877079129219055
loss_pred:0.01937124691903591, decouple_loss:0.009634365327656269
Iteration: 2646, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.448012113571167
The generated pressure mean: 0.4494702219963074
loss_pred:0.020214838907122612, decouple_loss:0.009075228124856949
loss_pred:0.020466383546590805, decouple_loss:0.009359815157949924
The generated pressure mean: 0.44823095202445984
loss_pred:0.02167537435889244, decouple_loss:0.009149925783276558
Iteration: 2647, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4480448067188263
The generated pressure mean: 0.44903212785720825
loss_pred:0.019267823547124863, decouple_loss:0.009029582142829895
loss_pred:0.019877789542078972, decouple_loss:0.009142623282968998
The generated pressure mean: 0.4487270712852478
loss_pred:0.019098758697509766, decouple_loss:0.008977241814136505
Iteration: 2648, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44933342933654785
The generated pressure mean: 0.4481388330459595
loss_pred:0.022265197709202766, decouple_loss:0.00979185476899147
loss_pred:0.02136419527232647, decouple_loss:0.009866474196314812
The generated pressure mean: 0.44635310769081116
loss_pred:0.021765097975730896, decouple_loss:0.00992914754897356
Iteration: 2649, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44855940341949463
loss_pred:0.02254389598965645, decouple_loss:0.011719449423253536
The generated pressure mean: 0.4475170075893402
loss_pred:0.0229338351637125, decouple_loss:0.011724414303898811
The generated pressure mean: 0.44862890243530273
loss_pred:0.022551262751221657, decouple_loss:0.011736009269952774
Iteration: 2650, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4482119381427765
The generated pressure mean: 0.4472561478614807
loss_pred:0.019983964040875435, decouple_loss:0.010030374862253666
loss_pred:0.020649464800953865, decouple_loss:0.009959159418940544
The generated pressure mean: 0.4473927319049835
loss_pred:0.020479939877986908, decouple_loss:0.00987257156521082
2023-04-16 11:07:59 testing...
The generated pressure mean: 0.4495830535888672
The generated pressure mean: 0.4497888684272766
The generated pressure mean: 0.44987666606903076
loss_pred:0.029824137687683105, decouple_loss:0.01006938423961401
loss_pred:0.03068026714026928, decouple_loss:0.010025299154222012
loss_pred:0.029487062245607376, decouple_loss:0.010036710649728775
Loss: 0.030499344691634178, avg_mse: 0.04078322649002075
current test mse: 0.040783
Iteration: 2651, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44839170575141907
The generated pressure mean: 0.4487454891204834
loss_pred:0.022137824445962906, decouple_loss:0.010110810399055481
loss_pred:0.020202629268169403, decouple_loss:0.010031231679022312
The generated pressure mean: 0.4473727345466614
loss_pred:0.021675389260053635, decouple_loss:0.010064717382192612
Iteration: 2652, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4479963183403015
loss_pred:0.020980969071388245, decouple_loss:0.010931667871773243
The generated pressure mean: 0.4475848078727722
loss_pred:0.020885050296783447, decouple_loss:0.0108454879373312
The generated pressure mean: 0.4482080340385437
loss_pred:0.02014085277915001, decouple_loss:0.010962420143187046
Iteration: 2653, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44666147232055664
The generated pressure mean: 0.4486353099346161
loss_pred:0.020857112482190132, decouple_loss:0.010936949402093887
loss_pred:0.020415449514985085, decouple_loss:0.010866187512874603
The generated pressure mean: 0.44808676838874817
loss_pred:0.021011384204030037, decouple_loss:0.01091048400849104
Iteration: 2654, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4484032988548279
The generated pressure mean: 0.44772353768348694
loss_pred:0.020064663141965866, decouple_loss:0.010429717600345612
loss_pred:0.019429389387369156, decouple_loss:0.010429151356220245
The generated pressure mean: 0.44805780053138733
loss_pred:0.020861318334937096, decouple_loss:0.010593961924314499
Iteration: 2655, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.448775053024292
The generated pressure mean: 0.44858911633491516
loss_pred:0.01985497586429119, decouple_loss:0.009760590270161629
loss_pred:0.021091921254992485, decouple_loss:0.009870056062936783
The generated pressure mean: 0.449144572019577
loss_pred:0.02014065347611904, decouple_loss:0.009767274372279644
Iteration: 2656, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4478552043437958
The generated pressure mean: 0.44863730669021606
loss_pred:0.021376995369791985, decouple_loss:0.010193685069680214
loss_pred:0.01985286921262741, decouple_loss:0.010125773958861828
The generated pressure mean: 0.4474312663078308
loss_pred:0.019311780110001564, decouple_loss:0.010005638934671879
Iteration: 2657, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44955793023109436
loss_pred:0.019326457753777504, decouple_loss:0.010821869596838951
The generated pressure mean: 0.44889020919799805
loss_pred:0.020496021956205368, decouple_loss:0.010707922279834747
The generated pressure mean: 0.44862380623817444
loss_pred:0.019303295761346817, decouple_loss:0.010756497271358967
Iteration: 2658, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4483334422111511
loss_pred:0.01929493248462677, decouple_loss:0.009340059943497181
The generated pressure mean: 0.4489459991455078
loss_pred:0.02003195881843567, decouple_loss:0.009333928115665913
The generated pressure mean: 0.4477640688419342
loss_pred:0.020222928375005722, decouple_loss:0.009231092408299446
Iteration: 2659, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.447951078414917
The generated pressure mean: 0.44882646203041077
loss_pred:0.022056303918361664, decouple_loss:0.009670077823102474
loss_pred:0.01879100874066353, decouple_loss:0.009625498205423355
The generated pressure mean: 0.44870543479919434
loss_pred:0.020770378410816193, decouple_loss:0.009701532311737537
Iteration: 2660, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4481961727142334
loss_pred:0.01906304620206356, decouple_loss:0.008812285959720612
The generated pressure mean: 0.4482963979244232
loss_pred:0.01942804642021656, decouple_loss:0.00881689228117466
The generated pressure mean: 0.4486939609050751
loss_pred:0.020687174052000046, decouple_loss:0.008745103143155575
2023-04-16 11:09:51 testing...
The generated pressure mean: 0.4497888684272766
The generated pressure mean: 0.4495830535888672
The generated pressure mean: 0.44987666606903076
loss_pred:0.028066597878932953, decouple_loss:0.009013546630740166
loss_pred:0.027075618505477905, decouple_loss:0.008973272517323494
loss_pred:0.026379158720374107, decouple_loss:0.009036916308104992
Loss: 0.027624187991023064, avg_mse: 0.03625154495239258
current test mse: 0.036252
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012006_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012006_3_24hr.npz
NaN value num: 0
Iteration: 2661, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4468086063861847
loss_pred:0.021121112629771233, decouple_loss:0.009011204354465008
The generated pressure mean: 0.44660720229148865
loss_pred:0.021481813862919807, decouple_loss:0.008940559811890125
The generated pressure mean: 0.44723570346832275
loss_pred:0.020106062293052673, decouple_loss:0.00917320791631937
Iteration: 2662, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4478319585323334
loss_pred:0.02024281956255436, decouple_loss:0.008442745544016361
The generated pressure mean: 0.44823771715164185
loss_pred:0.021194158121943474, decouple_loss:0.008477195166051388
The generated pressure mean: 0.44832292199134827
loss_pred:0.022521208971738815, decouple_loss:0.00851387344300747
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 2663, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4479466378688812
The generated pressure mean: 0.44814372062683105
loss_pred:0.01999892294406891, decouple_loss:0.008303984999656677
loss_pred:0.020081762224435806, decouple_loss:0.008277161046862602
The generated pressure mean: 0.44622570276260376
loss_pred:0.021301841363310814, decouple_loss:0.00823094230145216
Iteration: 2664, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4472769796848297
loss_pred:0.022620629519224167, decouple_loss:0.007799170445650816
The generated pressure mean: 0.4484044313430786
loss_pred:0.019765889272093773, decouple_loss:0.007825084961950779
The generated pressure mean: 0.44794487953186035
loss_pred:0.020772915333509445, decouple_loss:0.007723303511738777
Iteration: 2665, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4466507136821747
The generated pressure mean: 0.44769397377967834loss_pred:0.019964290782809258, decouple_loss:0.008932949975132942
loss_pred:0.021022718399763107, decouple_loss:0.008832801133394241
The generated pressure mean: 0.4471207857131958
loss_pred:0.02089647576212883, decouple_loss:0.008811384439468384
Iteration: 2666, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4478028416633606
The generated pressure mean: 0.447664350271225
loss_pred:0.0200042761862278, decouple_loss:0.00904137920588255
loss_pred:0.021974559873342514, decouple_loss:0.009075334295630455
The generated pressure mean: 0.44735538959503174
loss_pred:0.021805843338370323, decouple_loss:0.009076452814042568
Iteration: 2667, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4472962021827698The generated pressure mean: 0.4476638436317444
loss_pred:0.021502964198589325, decouple_loss:0.008401729166507721loss_pred:0.02147652395069599, decouple_loss:0.008411391638219357
The generated pressure mean: 0.4480040669441223
loss_pred:0.02064850740134716, decouple_loss:0.008377744816243649
Iteration: 2668, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44660675525665283
The generated pressure mean: 0.4471854567527771
loss_pred:0.02147058956325054, decouple_loss:0.008740779012441635
loss_pred:0.020075010135769844, decouple_loss:0.008761177770793438
The generated pressure mean: 0.4472196102142334
loss_pred:0.020854398608207703, decouple_loss:0.0086212158203125
Iteration: 2669, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.447311133146286
loss_pred:0.021128660067915916, decouple_loss:0.009732667356729507
The generated pressure mean: 0.4485522210597992
loss_pred:0.01926228776574135, decouple_loss:0.009590066969394684
The generated pressure mean: 0.44795045256614685
loss_pred:0.01993495598435402, decouple_loss:0.00961755495518446
Iteration: 2670, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4473671317100525The generated pressure mean: 0.44754332304000854
loss_pred:0.02136107347905636, decouple_loss:0.008374077267944813loss_pred:0.02141975425183773, decouple_loss:0.00835245568305254
The generated pressure mean: 0.44747069478034973
loss_pred:0.020479323342442513, decouple_loss:0.008365335874259472
2023-04-16 11:12:20 testing...
The generated pressure mean: 0.449788898229599
The generated pressure mean: 0.4495830833911896
The generated pressure mean: 0.44987666606903076
loss_pred:0.02943282388150692, decouple_loss:0.00810310896486044
loss_pred:0.028239566832780838, decouple_loss:0.008170844055712223
loss_pred:0.02807910554111004, decouple_loss:0.008174474351108074
Loss: 0.02899130806326866, avg_mse: 0.03907284140586853
current test mse: 0.039073
Iteration: 2671, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4473397433757782
loss_pred:0.019689874723553658, decouple_loss:0.008042672649025917
The generated pressure mean: 0.44862884283065796
loss_pred:0.02163747139275074, decouple_loss:0.008172478526830673
The generated pressure mean: 0.44680526852607727
loss_pred:0.021453216671943665, decouple_loss:0.008323152549564838
Iteration: 2672, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4474378228187561
The generated pressure mean: 0.44653046131134033
loss_pred:0.019917167723178864, decouple_loss:0.008911690674722195
loss_pred:0.020062126219272614, decouple_loss:0.009016100317239761
The generated pressure mean: 0.446816623210907
loss_pred:0.020300831645727158, decouple_loss:0.009093791246414185
Iteration: 2673, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4477618634700775
loss_pred:0.021186701953411102, decouple_loss:0.007903994992375374
The generated pressure mean: 0.44815999269485474
loss_pred:0.020438775420188904, decouple_loss:0.007822832092642784
The generated pressure mean: 0.44688132405281067
loss_pred:0.01942124217748642, decouple_loss:0.007786905393004417
Iteration: 2674, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44693994522094727
The generated pressure mean: 0.44675448536872864
loss_pred:0.01955503597855568, decouple_loss:0.007664022035896778
loss_pred:0.020523065701127052, decouple_loss:0.007898467592895031
The generated pressure mean: 0.44882383942604065
loss_pred:0.019890399649739265, decouple_loss:0.007812174037098885
Iteration: 2675, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44773998856544495
The generated pressure mean: 0.4472491145133972
loss_pred:0.01897403970360756, decouple_loss:0.008408823050558567
loss_pred:0.02051703818142414, decouple_loss:0.008206348866224289
The generated pressure mean: 0.4481146037578583
loss_pred:0.0199911966919899, decouple_loss:0.008205649442970753
Iteration: 2676, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44682765007019043
The generated pressure mean: 0.4467688798904419
loss_pred:0.019922008737921715, decouple_loss:0.008044961839914322
The generated pressure mean: 0.44820713996887207
loss_pred:0.020992130041122437, decouple_loss:0.007878251373767853
loss_pred:0.0208493210375309, decouple_loss:0.00800217967480421
Iteration: 2677, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4472901225090027
The generated pressure mean: 0.4474269449710846
loss_pred:0.020419105887413025, decouple_loss:0.007622905075550079
loss_pred:0.019788667559623718, decouple_loss:0.007797857280820608
The generated pressure mean: 0.44689297676086426
loss_pred:0.01893053576350212, decouple_loss:0.00779889477416873
Iteration: 2678, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44826990365982056
The generated pressure mean: 0.44734084606170654
The generated pressure mean: 0.4470902979373932loss_pred:0.01914101280272007, decouple_loss:0.007165700662881136
loss_pred:0.02081073634326458, decouple_loss:0.007242709398269653
loss_pred:0.0184831153601408, decouple_loss:0.007116188760846853
Iteration: 2679, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44699323177337646
The generated pressure mean: 0.44688403606414795
loss_pred:0.019552921876311302, decouple_loss:0.007207362912595272
loss_pred:0.01980195939540863, decouple_loss:0.007329079322516918
The generated pressure mean: 0.4493085741996765
loss_pred:0.01851842924952507, decouple_loss:0.0072993128560483456
Iteration: 2680, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44745659828186035
The generated pressure mean: 0.447611540555954
loss_pred:0.01991187036037445, decouple_loss:0.007010790519416332
loss_pred:0.021669652312994003, decouple_loss:0.006972495466470718
The generated pressure mean: 0.44732606410980225
loss_pred:0.021090727299451828, decouple_loss:0.007074759341776371
2023-04-16 11:14:13 testing...
The generated pressure mean: 0.4495830833911896
The generated pressure mean: 0.449788898229599
The generated pressure mean: 0.44987666606903076
loss_pred:0.02709496207535267, decouple_loss:0.007519120816141367
loss_pred:0.027933094650506973, decouple_loss:0.007485195994377136
loss_pred:0.026802733540534973, decouple_loss:0.007574921473860741
Loss: 0.027653250843286514, avg_mse: 0.03662574663758278
current test mse: 0.036626
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012017_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012017_3_24hr.npz
NaN value num: 0
Iteration: 2681, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4494132995605469
loss_pred:0.019729329273104668, decouple_loss:0.0075400229543447495
The generated pressure mean: 0.4476213753223419
The generated pressure mean: 0.4472748041152954
loss_pred:0.019122106954455376, decouple_loss:0.007776094134896994
loss_pred:0.01974835991859436, decouple_loss:0.007676402106881142
Iteration: 2682, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4478216767311096
loss_pred:0.01993815042078495, decouple_loss:0.007479473482817411
The generated pressure mean: 0.4471893906593323
loss_pred:0.02062089554965496, decouple_loss:0.007425304967910051
The generated pressure mean: 0.44725844264030457
loss_pred:0.02099575661122799, decouple_loss:0.00744755519554019
Iteration: 2683, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44900357723236084
loss_pred:0.019887546077370644, decouple_loss:0.008040023036301136
The generated pressure mean: 0.4478819668292999
The generated pressure mean: 0.4490025043487549
loss_pred:0.019857315346598625, decouple_loss:0.007858703844249249
loss_pred:0.020525841042399406, decouple_loss:0.007783090695738792
Iteration: 2684, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4495009481906891
loss_pred:0.019033657386898994, decouple_loss:0.0071962084621191025
The generated pressure mean: 0.4483950734138489
loss_pred:0.019480271264910698, decouple_loss:0.007168700452893972
The generated pressure mean: 0.4489333927631378
loss_pred:0.01807151921093464, decouple_loss:0.007224023342132568
Iteration: 2685, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44682610034942627
loss_pred:0.018800068646669388, decouple_loss:0.007167208939790726
The generated pressure mean: 0.44885775446891785
loss_pred:0.02129238285124302, decouple_loss:0.007159384433180094
The generated pressure mean: 0.44864314794540405
loss_pred:0.018872098997235298, decouple_loss:0.0071823131293058395
Iteration: 2686, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4497976005077362
loss_pred:0.020700912922620773, decouple_loss:0.007527781184762716
The generated pressure mean: 0.44799745082855225
loss_pred:0.019518841058015823, decouple_loss:0.0073032197542488575
The generated pressure mean: 0.4488367736339569
loss_pred:0.018498266115784645, decouple_loss:0.007258668541908264
Iteration: 2687, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4486500322818756
loss_pred:0.018324853852391243, decouple_loss:0.007583094295114279
The generated pressure mean: 0.44836118817329407
loss_pred:0.0195179246366024, decouple_loss:0.00780528737232089
The generated pressure mean: 0.4494490623474121
loss_pred:0.01997176744043827, decouple_loss:0.007603560574352741
Iteration: 2688, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4480086863040924
loss_pred:0.02152612991631031, decouple_loss:0.00812098290771246
The generated pressure mean: 0.44861671328544617
loss_pred:0.01940356008708477, decouple_loss:0.008045158348977566
The generated pressure mean: 0.448723167181015
loss_pred:0.01934189349412918, decouple_loss:0.007994773797690868
Iteration: 2689, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.448118656873703
loss_pred:0.020406484603881836, decouple_loss:0.00710572162643075
The generated pressure mean: 0.4494127631187439
loss_pred:0.01999771222472191, decouple_loss:0.0067575774155557156
The generated pressure mean: 0.4493180811405182
loss_pred:0.019720928743481636, decouple_loss:0.007122114300727844
Iteration: 2690, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4486769437789917
loss_pred:0.021740086376667023, decouple_loss:0.007428720127791166
The generated pressure mean: 0.44869518280029297
loss_pred:0.019727278500795364, decouple_loss:0.007308206520974636
The generated pressure mean: 0.44756239652633667
loss_pred:0.02183682657778263, decouple_loss:0.007541117258369923
2023-04-16 11:16:40 testing...
The generated pressure mean: 0.4497888684272766
The generated pressure mean: 0.4495830535888672
The generated pressure mean: 0.44987666606903076
loss_pred:0.029102759435772896, decouple_loss:0.008382215164601803
loss_pred:0.02819112502038479, decouple_loss:0.008457653224468231
loss_pred:0.028122389689087868, decouple_loss:0.008479740470647812
Loss: 0.028894085437059402, avg_mse: 0.03900502249598503
current test mse: 0.039005
Iteration: 2691, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4483799636363983
The generated pressure mean: 0.44714072346687317
loss_pred:0.018745366483926773, decouple_loss:0.008303126320242882
loss_pred:0.020230600610375404, decouple_loss:0.008192346431314945
The generated pressure mean: 0.4483802318572998
loss_pred:0.020826179534196854, decouple_loss:0.00833557453006506
Iteration: 2692, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4488871693611145
loss_pred:0.021000469103455544, decouple_loss:0.007747578900307417
The generated pressure mean: 0.44741275906562805
loss_pred:0.02211836725473404, decouple_loss:0.00787131953984499
The generated pressure mean: 0.44822725653648376
loss_pred:0.018998898565769196, decouple_loss:0.00787106528878212
Iteration: 2693, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4487558901309967
loss_pred:0.01834520511329174, decouple_loss:0.006933067459613085
The generated pressure mean: 0.44753068685531616
loss_pred:0.01966674067080021, decouple_loss:0.0068025835789740086
The generated pressure mean: 0.4477007985115051
loss_pred:0.020374104380607605, decouple_loss:0.006854631472378969
Iteration: 2694, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4476511776447296
loss_pred:0.021684592589735985, decouple_loss:0.008025435730814934
The generated pressure mean: 0.44960030913352966
loss_pred:0.019762221723794937, decouple_loss:0.007848908193409443
The generated pressure mean: 0.4481375217437744
loss_pred:0.018853364512324333, decouple_loss:0.007987668737769127
Iteration: 2695, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4492121636867523
loss_pred:0.020159214735031128, decouple_loss:0.007127824239432812
The generated pressure mean: 0.44885721802711487
loss_pred:0.02024824544787407, decouple_loss:0.006858238484710455
The generated pressure mean: 0.4480818510055542
loss_pred:0.01972697675228119, decouple_loss:0.007063144352287054
Iteration: 2696, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44759809970855713
loss_pred:0.019557932391762733, decouple_loss:0.007146032527089119
The generated pressure mean: 0.4498462378978729
The generated pressure mean: 0.44853323698043823
loss_pred:0.019982418045401573, decouple_loss:0.007103265263140202
loss_pred:0.019689805805683136, decouple_loss:0.007208532188087702
Iteration: 2697, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44782891869544983
loss_pred:0.019864723086357117, decouple_loss:0.007879679091274738
The generated pressure mean: 0.4482285976409912
loss_pred:0.02001582644879818, decouple_loss:0.008080254308879375
The generated pressure mean: 0.44788235425949097
loss_pred:0.019860267639160156, decouple_loss:0.007944059558212757
Iteration: 2698, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44853904843330383
loss_pred:0.01991727016866207, decouple_loss:0.007497711107134819
The generated pressure mean: 0.4492904543876648
loss_pred:0.022244684398174286, decouple_loss:0.007509209215641022
The generated pressure mean: 0.4487735629081726
loss_pred:0.02044927328824997, decouple_loss:0.007440011482685804
Iteration: 2699, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4484681785106659
loss_pred:0.020857950672507286, decouple_loss:0.009226953610777855
The generated pressure mean: 0.4478338658809662
loss_pred:0.01977473311126232, decouple_loss:0.009142888709902763
The generated pressure mean: 0.44753149151802063
loss_pred:0.020539510995149612, decouple_loss:0.009240737184882164
Iteration: 2700, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4472012519836426
loss_pred:0.02089676819741726, decouple_loss:0.008338703773915768
The generated pressure mean: 0.44893890619277954
loss_pred:0.02054353430867195, decouple_loss:0.008595242165029049
The generated pressure mean: 0.4479621648788452
loss_pred:0.01951257698237896, decouple_loss:0.008200901560485363
2023-04-16 11:18:33 testing...
The generated pressure mean: 0.4497888684272766
The generated pressure mean: 0.4495830535888672
The generated pressure mean: 0.44987666606903076
loss_pred:0.02926846779882908, decouple_loss:0.008731575682759285
loss_pred:0.02822002023458481, decouple_loss:0.008776891976594925
loss_pred:0.028121698647737503, decouple_loss:0.008709988556802273
Loss: 0.02897370420396328, avg_mse: 0.03913570195436478
current test mse: 0.039136
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012018_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012018_3_24hr.npz
NaN value num: 0
Iteration: 2701, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44790560007095337
loss_pred:0.020084058865904808, decouple_loss:0.00869826041162014
The generated pressure mean: 0.44844841957092285
loss_pred:0.02084231749176979, decouple_loss:0.008667630143463612
The generated pressure mean: 0.4475157856941223
loss_pred:0.020194314420223236, decouple_loss:0.008742171339690685
Iteration: 2702, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44798147678375244
The generated pressure mean: 0.448113352060318
loss_pred:0.019864521920681, decouple_loss:0.009017755277454853
loss_pred:0.020778510719537735, decouple_loss:0.008886265568435192
The generated pressure mean: 0.44799932837486267
loss_pred:0.022201640531420708, decouple_loss:0.008893477730453014
Iteration: 2703, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4482262134552002
The generated pressure mean: 0.4471258223056793
loss_pred:0.019721295684576035, decouple_loss:0.008161121979355812
loss_pred:0.019850125536322594, decouple_loss:0.007924270816147327
The generated pressure mean: 0.44791799783706665
loss_pred:0.01936921663582325, decouple_loss:0.008039619773626328
Iteration: 2704, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44780224561691284
The generated pressure mean: 0.4481903612613678
loss_pred:0.01887151040136814, decouple_loss:0.008053382858633995
loss_pred:0.019435986876487732, decouple_loss:0.008078317157924175
The generated pressure mean: 0.44806525111198425
loss_pred:0.018304388970136642, decouple_loss:0.007985422387719154
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 2705, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44868525862693787
The generated pressure mean: 0.44880369305610657
loss_pred:0.021589869633316994, decouple_loss:0.007907629944384098
loss_pred:0.02140614576637745, decouple_loss:0.007802458480000496
The generated pressure mean: 0.44744616746902466
loss_pred:0.019761692732572556, decouple_loss:0.007831341587007046
Iteration: 2706, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.447199285030365
The generated pressure mean: 0.44741690158843994
loss_pred:0.02018079161643982, decouple_loss:0.007898593321442604
loss_pred:0.0197678804397583, decouple_loss:0.007927668280899525
The generated pressure mean: 0.4479043781757355
loss_pred:0.018676770851016045, decouple_loss:0.00791989453136921
Iteration: 2707, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44841691851615906
The generated pressure mean: 0.44753900170326233
loss_pred:0.019881736487150192, decouple_loss:0.008615261875092983
loss_pred:0.02046847715973854, decouple_loss:0.008781325072050095
The generated pressure mean: 0.447795033454895
loss_pred:0.019861526787281036, decouple_loss:0.008878171443939209
Iteration: 2708, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4482947587966919
loss_pred:0.021698517724871635, decouple_loss:0.007328582461923361
The generated pressure mean: 0.44749870896339417
loss_pred:0.019443826749920845, decouple_loss:0.007230726070702076
The generated pressure mean: 0.4478529691696167
loss_pred:0.01912085711956024, decouple_loss:0.007284068968147039
Iteration: 2709, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4480688273906708
The generated pressure mean: 0.44762691855430603
loss_pred:0.020764444023370743, decouple_loss:0.007594857830554247
loss_pred:0.019377944990992546, decouple_loss:0.007579887751489878
The generated pressure mean: 0.4480019211769104
loss_pred:0.019743910059332848, decouple_loss:0.007523364387452602
Iteration: 2710, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4484274089336395
loss_pred:0.019201235845685005, decouple_loss:0.007641450501978397
The generated pressure mean: 0.4474197328090668
The generated pressure mean: 0.44778382778167725
loss_pred:0.02035173401236534, decouple_loss:0.007534113712608814
loss_pred:0.01915983110666275, decouple_loss:0.007581086829304695
2023-04-16 11:21:06 testing...
The generated pressure mean: 0.449788898229599
The generated pressure mean: 0.4495830535888672
The generated pressure mean: 0.44987666606903076
loss_pred:0.02774582989513874, decouple_loss:0.007523039355874062
loss_pred:0.026844702661037445, decouple_loss:0.007608541753143072
loss_pred:0.0265655517578125, decouple_loss:0.00756782665848732
Loss: 0.027430351823568344, avg_mse: 0.03633293882012367
current test mse: 0.036333
Iteration: 2711, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44771623611450195
loss_pred:0.01854746788740158, decouple_loss:0.007519249338656664
The generated pressure mean: 0.44751855731010437
loss_pred:0.020156359300017357, decouple_loss:0.007510806433856487
The generated pressure mean: 0.449163019657135
loss_pred:0.02063482627272606, decouple_loss:0.0075458805076777935
Iteration: 2712, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4481147527694702
loss_pred:0.020399879664182663, decouple_loss:0.007005515042692423
The generated pressure mean: 0.44878119230270386
loss_pred:0.019184255972504616, decouple_loss:0.007091950625181198
The generated pressure mean: 0.4472784698009491
loss_pred:0.01957882009446621, decouple_loss:0.007082073949277401
Iteration: 2713, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44806361198425293
loss_pred:0.01937931962311268, decouple_loss:0.007315244060009718
The generated pressure mean: 0.448133647441864
loss_pred:0.02015962265431881, decouple_loss:0.007464542984962463
The generated pressure mean: 0.44799745082855225
loss_pred:0.020460840314626694, decouple_loss:0.007445814553648233
Iteration: 2714, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4476151764392853
loss_pred:0.020023778080940247, decouple_loss:0.006925574969500303
The generated pressure mean: 0.44728925824165344
loss_pred:0.019277550280094147, decouple_loss:0.006924775894731283
The generated pressure mean: 0.44788506627082825
loss_pred:0.02107979543507099, decouple_loss:0.006806609220802784
Iteration: 2715, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44780266284942627
loss_pred:0.01954789273440838, decouple_loss:0.0066977026872336864
The generated pressure mean: 0.4487624168395996
loss_pred:0.018923956900835037, decouple_loss:0.006665689870715141
The generated pressure mean: 0.44773542881011963
loss_pred:0.01936926692724228, decouple_loss:0.006544346921145916
Iteration: 2716, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44795531034469604
loss_pred:0.01972769945859909, decouple_loss:0.0068420828320086
The generated pressure mean: 0.4475034475326538
loss_pred:0.020664948970079422, decouple_loss:0.00678544444963336
The generated pressure mean: 0.44787734746932983
loss_pred:0.01902039349079132, decouple_loss:0.006741860881447792
Iteration: 2717, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4477713406085968
loss_pred:0.019019590690732002, decouple_loss:0.007631209213286638
The generated pressure mean: 0.44754910469055176
loss_pred:0.01926584169268608, decouple_loss:0.007651809602975845
The generated pressure mean: 0.44832858443260193
loss_pred:0.02099737897515297, decouple_loss:0.00772668793797493
Iteration: 2718, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4478616714477539
loss_pred:0.020200736820697784, decouple_loss:0.006654918193817139
The generated pressure mean: 0.44811728596687317
loss_pred:0.020517680794000626, decouple_loss:0.0069224098697304726
The generated pressure mean: 0.44771313667297363
loss_pred:0.019535040482878685, decouple_loss:0.006738282274454832
Iteration: 2719, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44794991612434387
loss_pred:0.01918627694249153, decouple_loss:0.007089401129633188
The generated pressure mean: 0.4477216899394989
loss_pred:0.0192086361348629, decouple_loss:0.007062062621116638
The generated pressure mean: 0.4476363956928253
loss_pred:0.020136861130595207, decouple_loss:0.007045510224997997
Iteration: 2720, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.448560506105423
loss_pred:0.019313562661409378, decouple_loss:0.006745839025825262
The generated pressure mean: 0.44811609387397766
loss_pred:0.019879570230841637, decouple_loss:0.0066888658329844475
The generated pressure mean: 0.4478335976600647
loss_pred:0.019228802993893623, decouple_loss:0.006612252444028854
2023-04-16 11:23:00 testing...
The generated pressure mean: 0.4495830535888672
The generated pressure mean: 0.4497888386249542
The generated pressure mean: 0.44987666606903076
loss_pred:0.026192951947450638, decouple_loss:0.0066385408863425255
loss_pred:0.027351606637239456, decouple_loss:0.006595741491764784
loss_pred:0.025902021676301956, decouple_loss:0.006625778507441282
Loss: 0.026813194155693054, avg_mse: 0.035317905247211456
current test mse: 0.035318
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012000_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012000_3_24hr.npz
NaN value num: 0
Iteration: 2721, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4476753771305084
loss_pred:0.017796145752072334, decouple_loss:0.00669458694756031
The generated pressure mean: 0.44739699363708496
loss_pred:0.019029121845960617, decouple_loss:0.006510111037641764
The generated pressure mean: 0.4482708275318146
loss_pred:0.01948251947760582, decouple_loss:0.006613549776375294
Iteration: 2722, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4478625953197479
loss_pred:0.018725240603089333, decouple_loss:0.0067350734025239944
The generated pressure mean: 0.4471035897731781
loss_pred:0.020894402638077736, decouple_loss:0.006752329878509045
The generated pressure mean: 0.4469175338745117
loss_pred:0.020796120166778564, decouple_loss:0.006712952628731728
Iteration: 2723, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44827789068222046
loss_pred:0.02094617486000061, decouple_loss:0.0062213498167693615
The generated pressure mean: 0.44768601655960083
loss_pred:0.021281540393829346, decouple_loss:0.0062249465845525265
The generated pressure mean: 0.44839704036712646
loss_pred:0.018842486664652824, decouple_loss:0.006096751429140568
Iteration: 2724, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4461483955383301
loss_pred:0.019522560760378838, decouple_loss:0.005976163316518068
The generated pressure mean: 0.44717806577682495
The generated pressure mean: 0.44692403078079224
loss_pred:0.020638376474380493, decouple_loss:0.005954711232334375
loss_pred:0.017537232488393784, decouple_loss:0.005988743621855974
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 2725, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44916799664497375
loss_pred:0.01928451471030712, decouple_loss:0.006273613311350346
The generated pressure mean: 0.44644027948379517
The generated pressure mean: 0.44697317481040955
loss_pred:0.018831685185432434, decouple_loss:0.006244079675525427
loss_pred:0.019125323742628098, decouple_loss:0.006228218320757151
Iteration: 2726, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44797658920288086
The generated pressure mean: 0.4475764036178589
loss_pred:0.019836612045764923, decouple_loss:0.0072124674916267395
loss_pred:0.018599625676870346, decouple_loss:0.007146578747779131
The generated pressure mean: 0.44781818985939026
loss_pred:0.019645780324935913, decouple_loss:0.00725804828107357
Iteration: 2727, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4465046525001526
loss_pred:0.018439827486872673, decouple_loss:0.006452581845223904
The generated pressure mean: 0.4469894468784332
loss_pred:0.018115075305104256, decouple_loss:0.00645847013220191
The generated pressure mean: 0.4474863111972809
loss_pred:0.018995774909853935, decouple_loss:0.006346955895423889
Iteration: 2728, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44714266061782837
loss_pred:0.01966005004942417, decouple_loss:0.006282570771872997
The generated pressure mean: 0.446135550737381
loss_pred:0.018692919984459877, decouple_loss:0.006195068825036287
The generated pressure mean: 0.4480457603931427
loss_pred:0.019608035683631897, decouple_loss:0.00605329405516386
Iteration: 2729, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4473676085472107
loss_pred:0.019080648198723793, decouple_loss:0.006151549983769655
The generated pressure mean: 0.447671502828598
loss_pred:0.019637849181890488, decouple_loss:0.006042079534381628
The generated pressure mean: 0.44737598299980164
loss_pred:0.01806667447090149, decouple_loss:0.006022964138537645
Iteration: 2730, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44786643981933594
The generated pressure mean: 0.4466509521007538
loss_pred:0.0187218077480793, decouple_loss:0.0058991387486457825
loss_pred:0.018953073769807816, decouple_loss:0.005784950219094753
The generated pressure mean: 0.4466387629508972
loss_pred:0.018534690141677856, decouple_loss:0.005736540537327528
2023-04-16 11:25:39 testing...
The generated pressure mean: 0.449788898229599
The generated pressure mean: 0.4495830535888672
The generated pressure mean: 0.44987666606903076
loss_pred:0.027429351583123207, decouple_loss:0.00600321963429451
loss_pred:0.026417652145028114, decouple_loss:0.006020006723701954
loss_pred:0.025964144617319107, decouple_loss:0.006021938752382994
Loss: 0.02690446935594082, avg_mse: 0.035683099180459976
current test mse: 0.035683
Iteration: 2731, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4465123116970062
loss_pred:0.020063165575265884, decouple_loss:0.005961250513792038
The generated pressure mean: 0.44729194045066833
loss_pred:0.017977595329284668, decouple_loss:0.006004092283546925
The generated pressure mean: 0.44670215249061584
loss_pred:0.0178415197879076, decouple_loss:0.0059372736141085625
Iteration: 2732, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4472388029098511
The generated pressure mean: 0.4465515613555908
loss_pred:0.018695326521992683, decouple_loss:0.007515974808484316
loss_pred:0.01883717253804207, decouple_loss:0.007478488143533468
The generated pressure mean: 0.4475334584712982
loss_pred:0.0195021852850914, decouple_loss:0.007575933821499348
Iteration: 2733, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44661250710487366
loss_pred:0.018619336187839508, decouple_loss:0.006518632639199495
The generated pressure mean: 0.44630926847457886
The generated pressure mean: 0.4467404782772064
loss_pred:0.019347501918673515, decouple_loss:0.006532678846269846
loss_pred:0.01868479512631893, decouple_loss:0.006524872034788132
Iteration: 2734, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44876816868782043
loss_pred:0.018667925149202347, decouple_loss:0.006252246908843517
The generated pressure mean: 0.4454604387283325
The generated pressure mean: 0.44633227586746216
loss_pred:0.018699845299124718, decouple_loss:0.006381893064826727
loss_pred:0.018832290545105934, decouple_loss:0.006294673774391413
Iteration: 2735, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44844359159469604
loss_pred:0.01988343708217144, decouple_loss:0.007151457481086254
The generated pressure mean: 0.4470362365245819
The generated pressure mean: 0.4466874897480011
loss_pred:0.01958794705569744, decouple_loss:0.006989532150328159
loss_pred:0.0185055211186409, decouple_loss:0.007001558318734169
Iteration: 2736, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4468054175376892
loss_pred:0.01881619170308113, decouple_loss:0.006571104750037193
The generated pressure mean: 0.44655051827430725
The generated pressure mean: 0.44641056656837463
loss_pred:0.019480381160974503, decouple_loss:0.006600173190236092
loss_pred:0.018685026094317436, decouple_loss:0.006680648308247328
Iteration: 2737, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44645529985427856
loss_pred:0.019376251846551895, decouple_loss:0.007105167489498854
The generated pressure mean: 0.4458523094654083
loss_pred:0.019296690821647644, decouple_loss:0.006984653417021036
The generated pressure mean: 0.44735249876976013
loss_pred:0.0192217119038105, decouple_loss:0.007223948836326599
Iteration: 2738, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4487743079662323
loss_pred:0.01837732084095478, decouple_loss:0.007584567181766033
The generated pressure mean: 0.44701990485191345
loss_pred:0.019326817244291306, decouple_loss:0.007546474691480398
The generated pressure mean: 0.44925034046173096
loss_pred:0.018376434221863747, decouple_loss:0.007585683837532997
Iteration: 2739, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4468916654586792
loss_pred:0.019845258444547653, decouple_loss:0.0062032053247094154
The generated pressure mean: 0.4455268383026123
The generated pressure mean: 0.4470798075199127
loss_pred:0.01888168975710869, decouple_loss:0.006255640648305416
loss_pred:0.01971721090376377, decouple_loss:0.006226964294910431
Iteration: 2740, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44738295674324036
loss_pred:0.01826285757124424, decouple_loss:0.006846432574093342
The generated pressure mean: 0.4455258548259735
loss_pred:0.018751729279756546, decouple_loss:0.00718292873352766
The generated pressure mean: 0.4470297396183014
loss_pred:0.018961695954203606, decouple_loss:0.006947907619178295
2023-04-16 11:27:33 testing...
The generated pressure mean: 0.4495830833911896
The generated pressure mean: 0.4497888684272766
The generated pressure mean: 0.44987666606903076
loss_pred:0.02653733268380165, decouple_loss:0.007188064511865377
loss_pred:0.027650879696011543, decouple_loss:0.007211239077150822
loss_pred:0.026478758081793785, decouple_loss:0.007197448518127203
Loss: 0.027248937636613846, avg_mse: 0.036228906363248825
current test mse: 0.036229
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012006_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012006_3_24hr.npz
NaN value num: 0
Iteration: 2741, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44882193207740784
loss_pred:0.019345952197909355, decouple_loss:0.007199805695563555
The generated pressure mean: 0.44881996512413025
loss_pred:0.018693549558520317, decouple_loss:0.006953377276659012
The generated pressure mean: 0.4501950442790985
loss_pred:0.018864834681153297, decouple_loss:0.007257340010255575
Iteration: 2742, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44835829734802246
The generated pressure mean: 0.4484231472015381
loss_pred:0.01815158873796463, decouple_loss:0.008220002986490726
loss_pred:0.01885126531124115, decouple_loss:0.008048508316278458
The generated pressure mean: 0.4480856955051422
loss_pred:0.023324742913246155, decouple_loss:0.008374352008104324
Iteration: 2743, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44852012395858765The generated pressure mean: 0.4485749304294586
loss_pred:0.01997671090066433, decouple_loss:0.0077646393328905106
loss_pred:0.020347315818071365, decouple_loss:0.007949366234242916
The generated pressure mean: 0.44917911291122437
loss_pred:0.018591029569506645, decouple_loss:0.007694479543715715
Iteration: 2744, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44808343052864075
The generated pressure mean: 0.4487152099609375
loss_pred:0.019211266189813614, decouple_loss:0.0067381183616817
loss_pred:0.020429691299796104, decouple_loss:0.006936685647815466
The generated pressure mean: 0.44744542241096497
loss_pred:0.020702390000224113, decouple_loss:0.006902939174324274
Iteration: 2745, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4474776089191437
The generated pressure mean: 0.4485883116722107
loss_pred:0.019392354413866997, decouple_loss:0.008139456622302532
loss_pred:0.019330205395817757, decouple_loss:0.008232152089476585
The generated pressure mean: 0.4489497244358063
loss_pred:0.02016560547053814, decouple_loss:0.007779567502439022
Iteration: 2746, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4494444727897644
The generated pressure mean: 0.4477083384990692
loss_pred:0.018768852576613426, decouple_loss:0.0064570666290819645
loss_pred:0.020312253385782242, decouple_loss:0.00662072142586112
The generated pressure mean: 0.44858604669570923
loss_pred:0.017987562343478203, decouple_loss:0.006525338627398014
Iteration: 2747, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4471559524536133
The generated pressure mean: 0.44971179962158203
loss_pred:0.02080228552222252, decouple_loss:0.007702880539000034
loss_pred:0.019400781020522118, decouple_loss:0.00781301036477089
The generated pressure mean: 0.44784510135650635
loss_pred:0.019086454063653946, decouple_loss:0.007600867655128241
Iteration: 2748, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4491707384586334
The generated pressure mean: 0.44792136549949646
loss_pred:0.01868358813226223, decouple_loss:0.00736868754029274
loss_pred:0.019033588469028473, decouple_loss:0.00733624491840601
The generated pressure mean: 0.4481826722621918
loss_pred:0.01914004422724247, decouple_loss:0.007435495499521494
Iteration: 2749, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4491414725780487
The generated pressure mean: 0.4478321373462677
loss_pred:0.019076086580753326, decouple_loss:0.00621408224105835
loss_pred:0.0188237726688385, decouple_loss:0.00615606177598238
The generated pressure mean: 0.4479455053806305
loss_pred:0.018682001158595085, decouple_loss:0.006251549813896418
Iteration: 2750, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4487764537334442
The generated pressure mean: 0.44945159554481506
loss_pred:0.01911134645342827, decouple_loss:0.007197971921414137
loss_pred:0.019946416839957237, decouple_loss:0.007245786488056183
The generated pressure mean: 0.44897910952568054
loss_pred:0.018073704093694687, decouple_loss:0.0070436871610581875
2023-04-16 11:30:00 testing...
The generated pressure mean: 0.4497888684272766
The generated pressure mean: 0.4495830535888672
The generated pressure mean: 0.44987666606903076
loss_pred:0.02761736512184143, decouple_loss:0.006520707160234451
loss_pred:0.026368992403149605, decouple_loss:0.006460763514041901
loss_pred:0.02640257589519024, decouple_loss:0.006500097922980785
Loss: 0.027121005579829216, avg_mse: 0.036132290959358215
current test mse: 0.036132
Iteration: 2751, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4483506679534912
loss_pred:0.02049854025244713, decouple_loss:0.00644667586311698
The generated pressure mean: 0.44761672616004944
loss_pred:0.018188603222370148, decouple_loss:0.0064973970875144005
The generated pressure mean: 0.4480080008506775
loss_pred:0.019841762259602547, decouple_loss:0.0064633931033313274
Iteration: 2752, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44793662428855896
loss_pred:0.020695026963949203, decouple_loss:0.006636090110987425
The generated pressure mean: 0.4492274224758148
loss_pred:0.018570875748991966, decouple_loss:0.006631005555391312
The generated pressure mean: 0.4484025537967682
loss_pred:0.018744664266705513, decouple_loss:0.006735829170793295
Iteration: 2753, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4473377764225006
loss_pred:0.02039993181824684, decouple_loss:0.006142966914921999
The generated pressure mean: 0.44849711656570435
loss_pred:0.01940448209643364, decouple_loss:0.006148774176836014
The generated pressure mean: 0.447609543800354
loss_pred:0.019518714398145676, decouple_loss:0.006435596849769354
Iteration: 2754, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.448650598526001
loss_pred:0.019592560827732086, decouple_loss:0.0060532609932124615
The generated pressure mean: 0.4488055408000946
loss_pred:0.019882913678884506, decouple_loss:0.006093879230320454
The generated pressure mean: 0.44782352447509766
loss_pred:0.01825152523815632, decouple_loss:0.0061583505012094975
Iteration: 2755, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4481617510318756
loss_pred:0.020552704110741615, decouple_loss:0.00668148510158062
The generated pressure mean: 0.44868406653404236
loss_pred:0.020044296979904175, decouple_loss:0.006684168241918087
The generated pressure mean: 0.4484126567840576
loss_pred:0.020425226539373398, decouple_loss:0.006775004789233208
Iteration: 2756, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4497270882129669
loss_pred:0.01940999925136566, decouple_loss:0.006828829646110535
The generated pressure mean: 0.4476868510246277
The generated pressure mean: 0.44884926080703735
loss_pred:0.019291426986455917, decouple_loss:0.006900324951857328
loss_pred:0.02013213373720646, decouple_loss:0.006910016760230064
Iteration: 2757, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4479890465736389
loss_pred:0.018733788281679153, decouple_loss:0.006245491560548544
The generated pressure mean: 0.4481750428676605
loss_pred:0.01984553225338459, decouple_loss:0.005968868732452393
The generated pressure mean: 0.4499695599079132
loss_pred:0.019687240943312645, decouple_loss:0.005991227924823761
Iteration: 2758, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44877612590789795
loss_pred:0.020505651831626892, decouple_loss:0.006100516766309738
The generated pressure mean: 0.44840681552886963
The generated pressure mean: 0.4487597942352295loss_pred:0.018646614626049995, decouple_loss:0.00622930470854044
loss_pred:0.020086441189050674, decouple_loss:0.006094368174672127
Iteration: 2759, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44786936044692993
loss_pred:0.019089261069893837, decouple_loss:0.006827361416071653
The generated pressure mean: 0.4485422968864441
loss_pred:0.020582444965839386, decouple_loss:0.0066502331756055355
The generated pressure mean: 0.4486697316169739
loss_pred:0.019464941695332527, decouple_loss:0.007071362808346748
Iteration: 2760, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44923079013824463
loss_pred:0.019462950527668, decouple_loss:0.006904241628944874
The generated pressure mean: 0.44944050908088684
The generated pressure mean: 0.44895660877227783
loss_pred:0.01968967728316784, decouple_loss:0.006799367256462574
loss_pred:0.01867069862782955, decouple_loss:0.006632770411670208
2023-04-16 11:31:54 testing...
The generated pressure mean: 0.4497888386249542
The generated pressure mean: 0.4495830833911896
The generated pressure mean: 0.44987666606903076
loss_pred:0.02785065770149231, decouple_loss:0.006581982132047415
loss_pred:0.0269724540412426, decouple_loss:0.006584841758012772
loss_pred:0.026726074516773224, decouple_loss:0.00669469591230154
Loss: 0.027514085173606873, avg_mse: 0.036938752979040146
current test mse: 0.036939
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012020_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012020_3_24hr.npz
NaN value num: 0
Iteration: 2761, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4497753381729126
loss_pred:0.020272009074687958, decouple_loss:0.006838769186288118
The generated pressure mean: 0.4493340849876404
loss_pred:0.01915409229695797, decouple_loss:0.006675892975181341
The generated pressure mean: 0.4496612548828125
loss_pred:0.019508156925439835, decouple_loss:0.006617133505642414
Iteration: 2762, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4487124979496002
loss_pred:0.019479265436530113, decouple_loss:0.006725794170051813
The generated pressure mean: 0.4493504762649536
loss_pred:0.018930967897176743, decouple_loss:0.006862902548164129
The generated pressure mean: 0.4494397044181824
loss_pred:0.019928166642785072, decouple_loss:0.006736667826771736
Iteration: 2763, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.449248343706131
loss_pred:0.02008802257478237, decouple_loss:0.005639916751533747
The generated pressure mean: 0.45019662380218506
loss_pred:0.02115306444466114, decouple_loss:0.005605107638984919
The generated pressure mean: 0.44940319657325745
loss_pred:0.01828046329319477, decouple_loss:0.005620823707431555
Iteration: 2764, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4505215585231781
loss_pred:0.02043004333972931, decouple_loss:0.0061427936889231205
The generated pressure mean: 0.4481290280818939
loss_pred:0.019488845020532608, decouple_loss:0.00608693016692996
The generated pressure mean: 0.4503428041934967
loss_pred:0.01997384987771511, decouple_loss:0.006162106990814209
Iteration: 2765, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4505954086780548
loss_pred:0.020418528467416763, decouple_loss:0.006470664869993925
The generated pressure mean: 0.4487113654613495
loss_pred:0.020440038293600082, decouple_loss:0.006521083414554596
The generated pressure mean: 0.44940632581710815
loss_pred:0.01986663229763508, decouple_loss:0.006472934037446976
Iteration: 2766, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44966641068458557
loss_pred:0.018628930673003197, decouple_loss:0.0061124758794903755
The generated pressure mean: 0.4491356611251831
loss_pred:0.019631030037999153, decouple_loss:0.005926457233726978
The generated pressure mean: 0.4489690959453583
loss_pred:0.018719498068094254, decouple_loss:0.005810221191495657
Iteration: 2767, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4503808617591858
loss_pred:0.020652543753385544, decouple_loss:0.00604488980025053
The generated pressure mean: 0.4506217837333679
loss_pred:0.018751362338662148, decouple_loss:0.006118095945566893
The generated pressure mean: 0.4504680335521698
loss_pred:0.020409228280186653, decouple_loss:0.006130779627710581
Iteration: 2768, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44868531823158264
loss_pred:0.019982926547527313, decouple_loss:0.006061370950192213
The generated pressure mean: 0.4489012062549591
The generated pressure mean: 0.4502818286418915
loss_pred:0.02059236168861389, decouple_loss:0.006003588438034058
loss_pred:0.020011603832244873, decouple_loss:0.006271700840443373
Iteration: 2769, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4507172703742981
loss_pred:0.018310582265257835, decouple_loss:0.006439922843128443
The generated pressure mean: 0.4507772922515869
loss_pred:0.01949065737426281, decouple_loss:0.006352017167955637
The generated pressure mean: 0.45008423924446106
loss_pred:0.020122438669204712, decouple_loss:0.006460508331656456
Iteration: 2770, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44947320222854614
loss_pred:0.019707756116986275, decouple_loss:0.006037698592990637
The generated pressure mean: 0.4492562413215637
loss_pred:0.01880921609699726, decouple_loss:0.005862517282366753
The generated pressure mean: 0.4499345123767853
loss_pred:0.021671447902917862, decouple_loss:0.005950574763119221
2023-04-16 11:34:29 testing...
The generated pressure mean: 0.4495830833911896
The generated pressure mean: 0.4497888684272766
The generated pressure mean: 0.44987666606903076
loss_pred:0.025931894779205322, decouple_loss:0.0062244064174592495
loss_pred:0.027096185833215714, decouple_loss:0.006326169241219759
loss_pred:0.0261029452085495, decouple_loss:0.0062937973998487
Loss: 0.02669108286499977, avg_mse: 0.03540775924921036
current test mse: 0.035408
Iteration: 2771, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4508281350135803
loss_pred:0.019755378365516663, decouple_loss:0.006270780228078365
The generated pressure mean: 0.4498020112514496
loss_pred:0.01986604742705822, decouple_loss:0.006245610304176807
The generated pressure mean: 0.45010730624198914
loss_pred:0.019298870116472244, decouple_loss:0.006152917630970478
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 2772, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4507904052734375
loss_pred:0.02031719870865345, decouple_loss:0.006377126555889845
The generated pressure mean: 0.4498622715473175
loss_pred:0.018577128648757935, decouple_loss:0.006324733607470989
The generated pressure mean: 0.45044729113578796
loss_pred:0.0191656406968832, decouple_loss:0.0062675634399056435
Iteration: 2773, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44861218333244324
loss_pred:0.019652483984827995, decouple_loss:0.0060712057165801525
The generated pressure mean: 0.4501035213470459
loss_pred:0.020208382979035378, decouple_loss:0.006075034383684397
The generated pressure mean: 0.4501695930957794
loss_pred:0.019962744787335396, decouple_loss:0.006216271780431271
Iteration: 2774, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44872456789016724
loss_pred:0.021263033151626587, decouple_loss:0.005213930271565914
The generated pressure mean: 0.44990208745002747
loss_pred:0.019678128883242607, decouple_loss:0.005311345681548119
The generated pressure mean: 0.45025718212127686
loss_pred:0.019612567499279976, decouple_loss:0.005564122460782528
Iteration: 2775, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4497264325618744The generated pressure mean: 0.449557900428772
loss_pred:0.019542159512639046, decouple_loss:0.006291854660958052
loss_pred:0.01949361152946949, decouple_loss:0.0064506856724619865
The generated pressure mean: 0.4502379894256592
loss_pred:0.019792769104242325, decouple_loss:0.006396227516233921
Iteration: 2776, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4492187201976776
loss_pred:0.0199461430311203, decouple_loss:0.00718719931319356
The generated pressure mean: 0.44988805055618286
The generated pressure mean: 0.4491085112094879
loss_pred:0.020350638777017593, decouple_loss:0.007314105983823538
