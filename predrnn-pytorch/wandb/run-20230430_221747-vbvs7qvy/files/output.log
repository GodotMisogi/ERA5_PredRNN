After initialize model, args.img_channel:3
load model: /work/09012/haoli1/ls6/ERA5_PredRNN/checkpoints/WV_0_PC_1_EH_0_PS_40/model_model_test_schedule_sampling_DynaMean.ckpt
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012000_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012001_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012002_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012003_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012004_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012005_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012006_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012007_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012008_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012009_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012010_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012011_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012012_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012013_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012014_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012015_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012016_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012017_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012018_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012019_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012020_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012000_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012001_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012002_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012003_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012004_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012005_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012006_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012007_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012008_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012009_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012010_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012011_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012012_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012013_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012014_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012015_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012016_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012017_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012018_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012019_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012020_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012000_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012001_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012002_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012003_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012004_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012005_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012006_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012007_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012008_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012009_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012010_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012011_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012012_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012013_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012014_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012015_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012016_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012017_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012018_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012019_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012020_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012000_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012001_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012002_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012003_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012004_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012005_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012006_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012007_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012008_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012009_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012010_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012011_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012012_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012013_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012014_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012015_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012016_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012017_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012018_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012019_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012020_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012000_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012001_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012002_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012003_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012004_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012005_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012006_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012007_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012008_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012009_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012010_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012011_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012012_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012013_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012014_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012015_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012016_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012017_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012018_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012019_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012000_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012001_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012002_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012003_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012004_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012005_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012006_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012007_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012008_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012009_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012010_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012011_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012012_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012013_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012014_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012015_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012016_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012017_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012018_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012019_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012020_3_24hr.npz
train_data_files nums: 125
mnist test iterator, Loading data from /scratch/09012/haoli1/ERA5/val_dataset/era5_train_09012020_3_24hr.npz
NaN value num: 0
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012017_3_24hr.npz
NaN value num: 0
Iteration: 1, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4510340094566345, gen p mean: -0.042364899069070816, mean p set: 0.45151427388191223The modified gen p mean: 0.4511813521385193, gen p mean: -0.03731361776590347, mean p set: 0.451661616563797
The modified gen p mean: 0.451181560754776, gen p mean: -0.04142410680651665, mean p set: 0.4516618549823761
loss_pred:0.01865275576710701, decouple_loss:0.0014039914822205901
loss_pred:0.018305355682969093, decouple_loss:0.001378436922095716
loss_pred:0.01773974299430847, decouple_loss:0.0013920870842412114
/work/09012/haoli1/ls6/Pyt/lib/python3.9/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '
Iteration: 2, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508385956287384, gen p mean: -0.06230883300304413, mean p set: 0.4513188898563385
The modified gen p mean: 0.4503362476825714, gen p mean: -0.05614818260073662, mean p set: 0.4508165121078491
loss_pred:0.023837832733988762, decouple_loss:0.012542744167149067
loss_pred:0.023895949125289917, decouple_loss:0.011974629946053028
The modified gen p mean: 0.4498046040534973, gen p mean: -0.05872680991888046, mean p set: 0.4502848982810974
loss_pred:0.02419605478644371, decouple_loss:0.011844636872410774
Iteration: 3, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44997742772102356, gen p mean: -0.06619693338871002, mean p set: 0.45045775175094604
loss_pred:0.019242893904447556, decouple_loss:0.008998914621770382
The modified gen p mean: 0.4502759575843811, gen p mean: -0.06556226313114166, mean p set: 0.4507562518119812The modified gen p mean: 0.4501436650753021, gen p mean: -0.06915674358606339, mean p set: 0.4506239891052246
loss_pred:0.019801398739218712, decouple_loss:0.008350733667612076
loss_pred:0.019429435953497887, decouple_loss:0.009016044437885284
Iteration: 4, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45019635558128357, gen p mean: -0.06373370438814163, mean p set: 0.45067667961120605
loss_pred:0.018260164186358452, decouple_loss:0.004841492511332035
The modified gen p mean: 0.4483577609062195, gen p mean: -0.05890339985489845, mean p set: 0.4488380551338196The modified gen p mean: 0.4502236843109131, gen p mean: -0.0650094524025917, mean p set: 0.4507039785385132
loss_pred:0.018282655626535416, decouple_loss:0.005074918735772371
loss_pred:0.018663011491298676, decouple_loss:0.004540986381471157
Iteration: 5, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482896029949188, gen p mean: -0.048860929906368256, mean p set: 0.4487698972225189
loss_pred:0.019308963790535927, decouple_loss:0.00400635926052928
The modified gen p mean: 0.4490130841732025, gen p mean: -0.051160216331481934, mean p set: 0.449493408203125The modified gen p mean: 0.45016372203826904, gen p mean: -0.0464441142976284, mean p set: 0.45064401626586914
loss_pred:0.01893041469156742, decouple_loss:0.003949384205043316
loss_pred:0.01872396282851696, decouple_loss:0.004195712972432375
Iteration: 6, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501136541366577, gen p mean: -0.04806312546133995, mean p set: 0.4505939483642578
loss_pred:0.01842440292239189, decouple_loss:0.005583253223448992
The modified gen p mean: 0.44882988929748535, gen p mean: -0.04963136091828346, mean p set: 0.44931018352508545The modified gen p mean: 0.44983839988708496, gen p mean: -0.05253032594919205, mean p set: 0.45031872391700745
loss_pred:0.018205152824521065, decouple_loss:0.004869643598794937
loss_pred:0.018689027056097984, decouple_loss:0.005064746830612421
Iteration: 7, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44860726594924927, gen p mean: -0.05005846545100212, mean p set: 0.44908758997917175
loss_pred:0.01920146495103836, decouple_loss:0.0038447093684226274
The modified gen p mean: 0.45051079988479614, gen p mean: -0.05504699796438217, mean p set: 0.45099109411239624The modified gen p mean: 0.45019397139549255, gen p mean: -0.05106547847390175, mean p set: 0.45067429542541504
loss_pred:0.018535541370511055, decouple_loss:0.003949265461415052
loss_pred:0.018164118751883507, decouple_loss:0.0037504357751458883
Iteration: 8, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485202133655548, gen p mean: -0.04413651302456856, mean p set: 0.4490005075931549
loss_pred:0.017956838011741638, decouple_loss:0.003866618499159813
The modified gen p mean: 0.44986429810523987, gen p mean: -0.05524284765124321, mean p set: 0.4503445625305176The modified gen p mean: 0.45127686858177185, gen p mean: -0.04345288127660751, mean p set: 0.45175716280937195
loss_pred:0.018439024686813354, decouple_loss:0.004033274482935667
loss_pred:0.01878098025918007, decouple_loss:0.003913483116775751
Iteration: 9, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450148344039917, gen p mean: -0.041710853576660156, mean p set: 0.4506286382675171
loss_pred:0.01773596554994583, decouple_loss:0.0034237243235111237
The modified gen p mean: 0.4495129883289337, gen p mean: -0.04249285161495209, mean p set: 0.4499933123588562The modified gen p mean: 0.4503641128540039, gen p mean: -0.044874563813209534, mean p set: 0.4508443772792816
loss_pred:0.01773030497133732, decouple_loss:0.003405975643545389
loss_pred:0.01776563562452793, decouple_loss:0.003298529190942645
Iteration: 10, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493566155433655, gen p mean: -0.03923363611102104, mean p set: 0.44983693957328796
loss_pred:0.018132373690605164, decouple_loss:0.0033798711374402046
The modified gen p mean: 0.4501728117465973, gen p mean: -0.0393853597342968, mean p set: 0.4506531357765198The modified gen p mean: 0.4495947062969208, gen p mean: -0.04209117591381073, mean p set: 0.4500750005245209
loss_pred:0.017987582832574844, decouple_loss:0.0033768792636692524
loss_pred:0.01822843961417675, decouple_loss:0.003387074451893568
2023-04-30 22:21:09 testing...
The modified gen p mean: 0.44987666606903076, gen p mean: -0.0406062975525856, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.041220664978027344, mean p set: 0.4500633478164673
The modified gen p mean: 0.449788898229599, gen p mean: -0.04547777771949768, mean p set: 0.4502691626548767
loss_pred:0.01795869693160057, decouple_loss:0.002757392358034849
loss_pred:0.018121890723705292, decouple_loss:0.0027771901804953814
loss_pred:0.019002307206392288, decouple_loss:0.0028691759798675776
WV_0_PC_1_EH_0_PS_40, loss: 0.018501028418540955, avg_mse: 0.026224378496408463
current test mse: 0.026224
At step 10, Best test: 0.026224
save model to /work/09012/haoli1/ls6/ERA5_PredRNN/checkpoints/WV_0_PC_1_EH_0_PS_40/model_model_test_schedule_sampling_DynaMean.ckpt
Iteration: 11, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44883400201797485, gen p mean: -0.03294740617275238, mean p set: 0.44931429624557495
loss_pred:0.018565623089671135, decouple_loss:0.002844184171408415
The modified gen p mean: 0.44940176606178284, gen p mean: -0.04017740860581398, mean p set: 0.4498820900917053The modified gen p mean: 0.44992145895957947, gen p mean: -0.03892503306269646, mean p set: 0.45040175318717957
loss_pred:0.017471373081207275, decouple_loss:0.00280926120467484
loss_pred:0.017625058069825172, decouple_loss:0.002801643218845129
Iteration: 12, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45010191202163696, gen p mean: -0.04006347805261612, mean p set: 0.45058220624923706
loss_pred:0.017911648377776146, decouple_loss:0.002797634806483984
The modified gen p mean: 0.45033565163612366, gen p mean: -0.038985759019851685, mean p set: 0.45081597566604614The modified gen p mean: 0.44987753033638, gen p mean: -0.04614511877298355, mean p set: 0.4503578245639801
loss_pred:0.017712218686938286, decouple_loss:0.0030156720895320177
loss_pred:0.0183003731071949, decouple_loss:0.002828683005645871
Iteration: 13, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44889456033706665, gen p mean: -0.03798016160726547, mean p set: 0.44937488436698914
loss_pred:0.017638595774769783, decouple_loss:0.002614726312458515
The modified gen p mean: 0.45004984736442566, gen p mean: -0.03892676904797554, mean p set: 0.45053014159202576The modified gen p mean: 0.44945964217185974, gen p mean: -0.03990216925740242, mean p set: 0.44993993639945984
loss_pred:0.017491716891527176, decouple_loss:0.002395170507952571
loss_pred:0.01820412091910839, decouple_loss:0.002619936130940914
Iteration: 14, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488689601421356, gen p mean: -0.037143342196941376, mean p set: 0.4493492543697357
loss_pred:0.017784807831048965, decouple_loss:0.002407667227089405
The modified gen p mean: 0.44822803139686584, gen p mean: -0.030774692073464394, mean p set: 0.44870832562446594The modified gen p mean: 0.450810045003891, gen p mean: -0.03729686141014099, mean p set: 0.4512903094291687
loss_pred:0.018092695623636246, decouple_loss:0.002608170500025153
loss_pred:0.018048616126179695, decouple_loss:0.002323593245819211
Iteration: 15, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504992663860321, gen p mean: -0.04006605222821236, mean p set: 0.4509795904159546
loss_pred:0.017802836373448372, decouple_loss:0.0023923676926642656
The modified gen p mean: 0.44998276233673096, gen p mean: -0.03745776787400246, mean p set: 0.45046308636665344The modified gen p mean: 0.4488926827907562, gen p mean: -0.038669027388095856, mean p set: 0.44937294721603394
loss_pred:0.017296764999628067, decouple_loss:0.0022731400094926357
loss_pred:0.017135784029960632, decouple_loss:0.002229811390861869
Iteration: 16, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507595896720886, gen p mean: -0.04247044399380684, mean p set: 0.4512398838996887
loss_pred:0.01837855577468872, decouple_loss:0.0023815783206373453
The modified gen p mean: 0.4485991299152374, gen p mean: -0.03763000667095184, mean p set: 0.4490794241428375The modified gen p mean: 0.44860321283340454, gen p mean: -0.03602541983127594, mean p set: 0.44908347725868225
loss_pred:0.017507081851363182, decouple_loss:0.0026500443927943707
loss_pred:0.017889246344566345, decouple_loss:0.002652588067576289
Iteration: 17, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499850869178772, gen p mean: -0.03870973736047745, mean p set: 0.4504653811454773
loss_pred:0.017001695930957794, decouple_loss:0.0032048269640654325
The modified gen p mean: 0.44985517859458923, gen p mean: -0.04365503042936325, mean p set: 0.45033547282218933The modified gen p mean: 0.44957005977630615, gen p mean: -0.0367547832429409, mean p set: 0.45005032420158386
loss_pred:0.01714523881673813, decouple_loss:0.0033958489075303078
loss_pred:0.017552271485328674, decouple_loss:0.003108037170022726
Iteration: 18, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508129358291626, gen p mean: -0.04242159426212311, mean p set: 0.4512932300567627
loss_pred:0.017190782353281975, decouple_loss:0.0025280211120843887
The modified gen p mean: 0.45013922452926636, gen p mean: -0.03810753673315048, mean p set: 0.45061951875686646The modified gen p mean: 0.4509466290473938, gen p mean: -0.03139541298151016, mean p set: 0.4514269232749939
loss_pred:0.017276542261242867, decouple_loss:0.002464011311531067
loss_pred:0.017760058864951134, decouple_loss:0.0025994714815169573
Iteration: 19, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45031073689460754, gen p mean: -0.04347250610589981, mean p set: 0.45079106092453003
loss_pred:0.01705048978328705, decouple_loss:0.0028895875439047813
The modified gen p mean: 0.44897353649139404, gen p mean: -0.04176139831542969, mean p set: 0.44945380091667175The modified gen p mean: 0.45056435465812683, gen p mean: -0.04395561292767525, mean p set: 0.45104461908340454
loss_pred:0.017507361248135567, decouple_loss:0.0029236692935228348
loss_pred:0.01748303323984146, decouple_loss:0.003151163924485445
Iteration: 20, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44861555099487305, gen p mean: -0.041340019553899765, mean p set: 0.44909584522247314
loss_pred:0.01727822981774807, decouple_loss:0.0017527632880955935
The modified gen p mean: 0.44824227690696716, gen p mean: -0.035014692693948746, mean p set: 0.4487225413322449The modified gen p mean: 0.4509267508983612, gen p mean: -0.034753814339637756, mean p set: 0.4514070451259613
loss_pred:0.018084965646266937, decouple_loss:0.0017784471856430173
loss_pred:0.01698555238544941, decouple_loss:0.0018658469198271632
2023-04-30 22:23:09 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.04856773465871811, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04327315464615822, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.044258251786231995, mean p set: 0.4500633478164673
loss_pred:0.018689483404159546, decouple_loss:0.0026932174805551767
loss_pred:0.017568370327353477, decouple_loss:0.002734406152740121
loss_pred:0.017733130604028702, decouple_loss:0.002653147792443633
WV_0_PC_1_EH_0_PS_40, loss: 0.018131675198674202, avg_mse: 0.02586406096816063
current test mse: 0.025864
At step 20, Best test: 0.025864
save model to /work/09012/haoli1/ls6/ERA5_PredRNN/checkpoints/WV_0_PC_1_EH_0_PS_40/model_model_test_schedule_sampling_DynaMean.ckpt
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012010_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012010_3_24hr.npz
NaN value num: 0
Iteration: 21, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4463266432285309, gen p mean: -0.04921045899391174, mean p set: 0.4468069076538086
loss_pred:0.017858756706118584, decouple_loss:0.002725879428908229
The modified gen p mean: 0.4477614462375641, gen p mean: -0.045685503631830215, mean p set: 0.4482417702674866The modified gen p mean: 0.447494775056839, gen p mean: -0.04422972351312637, mean p set: 0.4479750096797943
loss_pred:0.018709318712353706, decouple_loss:0.002604918321594596
loss_pred:0.01934577152132988, decouple_loss:0.002715315204113722
Iteration: 22, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465072751045227, gen p mean: -0.053980112075805664, mean p set: 0.4469875395298004
loss_pred:0.01889118179678917, decouple_loss:0.0019327516201883554
The modified gen p mean: 0.4475124478340149, gen p mean: -0.05198177322745323, mean p set: 0.447992742061615The modified gen p mean: 0.44768568873405457, gen p mean: -0.048967987298965454, mean p set: 0.44816598296165466
loss_pred:0.019166700541973114, decouple_loss:0.0020652092061936855
loss_pred:0.019163666293025017, decouple_loss:0.0020045721903443336
Iteration: 23, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479115605354309, gen p mean: -0.050666313618421555, mean p set: 0.448391854763031
loss_pred:0.019387371838092804, decouple_loss:0.0030869317706674337
The modified gen p mean: 0.4469502866268158, gen p mean: -0.051022324711084366, mean p set: 0.4474305510520935The modified gen p mean: 0.4466244876384735, gen p mean: -0.0561339445412159, mean p set: 0.447104811668396
loss_pred:0.018689963966608047, decouple_loss:0.0032012448646128178
loss_pred:0.017926277592778206, decouple_loss:0.0030441710259765387
Iteration: 24, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44771096110343933, gen p mean: -0.0529029406607151, mean p set: 0.44819125533103943
loss_pred:0.017727309837937355, decouple_loss:0.0020866994746029377
The modified gen p mean: 0.4468751847743988, gen p mean: -0.052649907767772675, mean p set: 0.4473554790019989The modified gen p mean: 0.4477812349796295, gen p mean: -0.05174088478088379, mean p set: 0.4482615292072296
loss_pred:0.017896320670843124, decouple_loss:0.002045555505901575
loss_pred:0.019004475325345993, decouple_loss:0.0020466530695557594
Iteration: 25, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465983510017395, gen p mean: -0.052527546882629395, mean p set: 0.4470786452293396
loss_pred:0.018842848017811775, decouple_loss:0.002887533977627754
The modified gen p mean: 0.4479469358921051, gen p mean: -0.059881001710891724, mean p set: 0.4484272003173828The modified gen p mean: 0.4480290412902832, gen p mean: -0.05263170972466469, mean p set: 0.4485093653202057
loss_pred:0.019275732338428497, decouple_loss:0.0028903952334076166
loss_pred:0.019012102857232094, decouple_loss:0.00283618806861341
Iteration: 26, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474125802516937, gen p mean: -0.030760886147618294, mean p set: 0.4478928744792938
loss_pred:0.021378926932811737, decouple_loss:0.0026104676071554422
The modified gen p mean: 0.4475911557674408, gen p mean: -0.026632225140929222, mean p set: 0.4480714499950409The modified gen p mean: 0.4479251205921173, gen p mean: -0.02722678892314434, mean p set: 0.4484054148197174
loss_pred:0.02124423161149025, decouple_loss:0.0024873455986380577
loss_pred:0.021684084087610245, decouple_loss:0.002624956425279379
Iteration: 27, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44797372817993164, gen p mean: -0.06719733774662018, mean p set: 0.4484540522098541
loss_pred:0.019510062411427498, decouple_loss:0.003627476980909705
The modified gen p mean: 0.44886574149131775, gen p mean: -0.06401951611042023, mean p set: 0.44934606552124023The modified gen p mean: 0.4499262571334839, gen p mean: -0.06933125108480453, mean p set: 0.45040658116340637
loss_pred:0.020333869382739067, decouple_loss:0.0034712953492999077
loss_pred:0.019456788897514343, decouple_loss:0.003504715161398053
Iteration: 28, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465520977973938, gen p mean: -0.0766327753663063, mean p set: 0.4470323920249939
loss_pred:0.022925741970539093, decouple_loss:0.0025062919594347477
The modified gen p mean: 0.4462946653366089, gen p mean: -0.07572852820158005, mean p set: 0.446774959564209The modified gen p mean: 0.4474639892578125, gen p mean: -0.08063852041959763, mean p set: 0.4479442238807678
loss_pred:0.02282731793820858, decouple_loss:0.002459157956764102
loss_pred:0.022426746785640717, decouple_loss:0.002494310261681676
Iteration: 29, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478977620601654, gen p mean: -0.06524714082479477, mean p set: 0.4483780562877655
loss_pred:0.021029097959399223, decouple_loss:0.0045026689767837524
The modified gen p mean: 0.44661226868629456, gen p mean: -0.062231261283159256, mean p set: 0.44709256291389465
The modified gen p mean: 0.44795945286750793, gen p mean: -0.06138405203819275, mean p set: 0.44843971729278564
loss_pred:0.02093808725476265, decouple_loss:0.00454024039208889
loss_pred:0.021489877253770828, decouple_loss:0.0046495068818330765
Iteration: 30, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468501806259155, gen p mean: -0.06325693428516388, mean p set: 0.4473304748535156
loss_pred:0.021361785009503365, decouple_loss:0.004952431656420231
The modified gen p mean: 0.44862693548202515, gen p mean: -0.06676458567380905, mean p set: 0.44910722970962524The modified gen p mean: 0.44677734375, gen p mean: -0.06711999326944351, mean p set: 0.4472576081752777
loss_pred:0.02191709727048874, decouple_loss:0.005158021114766598
loss_pred:0.02105652168393135, decouple_loss:0.004941776394844055
2023-04-30 22:25:46 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.06624242663383484, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.05968790501356125, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.06098908558487892, mean p set: 0.4500633478164673
loss_pred:0.021234668791294098, decouple_loss:0.0036067527253180742
loss_pred:0.020125774666666985, decouple_loss:0.003517299424856901
loss_pred:0.020249366760253906, decouple_loss:0.0035067491699010134
WV_0_PC_1_EH_0_PS_40, loss: 0.02071378380060196, avg_mse: 0.028026822954416275
current test mse: 0.028027
Iteration: 31, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476429224014282, gen p mean: -0.0667666643857956, mean p set: 0.4481232166290283
The modified gen p mean: 0.44634953141212463, gen p mean: -0.06447708606719971, mean p set: 0.44682982563972473
The modified gen p mean: 0.44669774174690247, gen p mean: -0.06508424878120422, mean p set: 0.44717806577682495
loss_pred:0.021073417738080025, decouple_loss:0.003501980798318982
loss_pred:0.019850002601742744, decouple_loss:0.003594201523810625
loss_pred:0.019725903868675232, decouple_loss:0.0034804900642484426
Iteration: 32, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44763636589050293, gen p mean: -0.05767347291111946, mean p set: 0.448116660118103
The modified gen p mean: 0.44926369190216064, gen p mean: -0.06330129504203796, mean p set: 0.44974398612976074
loss_pred:0.021512417122721672, decouple_loss:0.002864918438717723
loss_pred:0.020142966881394386, decouple_loss:0.0028373454697430134
The modified gen p mean: 0.44631609320640564, gen p mean: -0.06151026114821434, mean p set: 0.4467964172363281
loss_pred:0.020050060003995895, decouple_loss:0.0029264504555612803
Iteration: 33, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469059705734253, gen p mean: -0.05318482592701912, mean p set: 0.447386234998703
loss_pred:0.019828906282782555, decouple_loss:0.003886063816025853
The modified gen p mean: 0.4480692446231842, gen p mean: -0.0580766499042511, mean p set: 0.4485495090484619The modified gen p mean: 0.4468787908554077, gen p mean: -0.05953991413116455, mean p set: 0.4473590552806854
loss_pred:0.021062571555376053, decouple_loss:0.0037288807798177004
loss_pred:0.019583703950047493, decouple_loss:0.0038522114045917988
Iteration: 34, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44730207324028015, gen p mean: -0.05142004415392876, mean p set: 0.44778236746788025
loss_pred:0.020279409363865852, decouple_loss:0.003846342209726572
The modified gen p mean: 0.44953829050064087, gen p mean: -0.05584552139043808, mean p set: 0.4500185549259186The modified gen p mean: 0.44860222935676575, gen p mean: -0.052014563232660294, mean p set: 0.44908249378204346
loss_pred:0.02008531056344509, decouple_loss:0.003812932875007391
loss_pred:0.01994980126619339, decouple_loss:0.0037772972136735916
Iteration: 35, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44793370366096497, gen p mean: -0.04419064521789551, mean p set: 0.44841399788856506
loss_pred:0.019934341311454773, decouple_loss:0.0029105977155268192
The modified gen p mean: 0.44859179854393005, gen p mean: -0.04891199618577957, mean p set: 0.44907209277153015The modified gen p mean: 0.4472706615924835, gen p mean: -0.047847893089056015, mean p set: 0.4477509558200836
loss_pred:0.020703768357634544, decouple_loss:0.003007336985319853
loss_pred:0.019781380891799927, decouple_loss:0.0030028673354536295
Iteration: 36, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44866013526916504, gen p mean: -0.04726928099989891, mean p set: 0.44914042949676514
loss_pred:0.02012534998357296, decouple_loss:0.0032309365924447775
The modified gen p mean: 0.44684475660324097, gen p mean: -0.05038377270102501, mean p set: 0.44732505083084106The modified gen p mean: 0.44738316535949707, gen p mean: -0.04700319841504097, mean p set: 0.44786348938941956
loss_pred:0.019197683781385422, decouple_loss:0.0032312641851603985
loss_pred:0.01946892961859703, decouple_loss:0.0034072238486260176
Iteration: 37, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44698894023895264, gen p mean: -0.042029835283756256, mean p set: 0.4474692642688751
loss_pred:0.020570509135723114, decouple_loss:0.0028078313916921616
The modified gen p mean: 0.4478965699672699, gen p mean: -0.044463835656642914, mean p set: 0.44837686419487The modified gen p mean: 0.44695374369621277, gen p mean: -0.04670415446162224, mean p set: 0.44743403792381287
loss_pred:0.019926318898797035, decouple_loss:0.002817921107634902
loss_pred:0.020445547997951508, decouple_loss:0.00273000611923635
Iteration: 38, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44706299901008606, gen p mean: -0.047092899680137634, mean p set: 0.44754326343536377
loss_pred:0.019313065335154533, decouple_loss:0.0027150872629135847
The modified gen p mean: 0.44722703099250793, gen p mean: -0.05018121004104614, mean p set: 0.44770732522010803
The modified gen p mean: 0.4478081166744232, gen p mean: -0.04845254868268967, mean p set: 0.4482884109020233
loss_pred:0.01826844923198223, decouple_loss:0.0028846224304288626
loss_pred:0.01875869184732437, decouple_loss:0.0028652034234255552
Iteration: 39, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44696977734565735, gen p mean: -0.05119531229138374, mean p set: 0.44745010137557983
loss_pred:0.02041211910545826, decouple_loss:0.002591760829091072
The modified gen p mean: 0.4485021233558655, gen p mean: -0.05379883944988251, mean p set: 0.4489823877811432The modified gen p mean: 0.44763433933258057, gen p mean: -0.04975263401865959, mean p set: 0.44811463356018066
loss_pred:0.019330499693751335, decouple_loss:0.0026621995493769646
loss_pred:0.019815629348158836, decouple_loss:0.002597254468128085
Iteration: 40, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490973949432373, gen p mean: -0.05458468943834305, mean p set: 0.4495777189731598
loss_pred:0.01990598812699318, decouple_loss:0.0024087666533887386
The modified gen p mean: 0.44697925448417664, gen p mean: -0.05576838180422783, mean p set: 0.4474595785140991The modified gen p mean: 0.44757428765296936, gen p mean: -0.05863592401146889, mean p set: 0.44805458188056946
loss_pred:0.018060103058815002, decouple_loss:0.002451046835631132
loss_pred:0.0180318932980299, decouple_loss:0.00233427993953228
2023-04-30 22:27:40 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.05873420089483261, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.051789723336696625, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.05350194498896599, mean p set: 0.4500633478164673
loss_pred:0.019261077046394348, decouple_loss:0.0024579206947237253
loss_pred:0.018245043233036995, decouple_loss:0.0022436892613768578
loss_pred:0.01833736151456833, decouple_loss:0.0022676363587379456
WV_0_PC_1_EH_0_PS_40, loss: 0.01873064786195755, avg_mse: 0.026450207456946373
current test mse: 0.02645
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012009_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012009_3_24hr.npz
NaN value num: 0
Iteration: 41, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4509732723236084, gen p mean: -0.04560806229710579, mean p set: 0.4514535665512085
loss_pred:0.017927540466189384, decouple_loss:0.002352961339056492
The modified gen p mean: 0.4525910019874573, gen p mean: -0.043493933975696564, mean p set: 0.4530712962150574The modified gen p mean: 0.4500044584274292, gen p mean: -0.04889271408319473, mean p set: 0.4504847228527069
loss_pred:0.017418215051293373, decouple_loss:0.0022727930918335915
loss_pred:0.01804843544960022, decouple_loss:0.002350702416151762
Iteration: 42, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4510084390640259, gen p mean: -0.044849809259176254, mean p set: 0.45148876309394836
The modified gen p mean: 0.45268043875694275, gen p mean: -0.04667045921087265, mean p set: 0.45316070318222046
loss_pred:0.01812431588768959, decouple_loss:0.002171660540625453
loss_pred:0.017548220232129097, decouple_loss:0.002171967178583145
The modified gen p mean: 0.4509032070636749, gen p mean: -0.05214233323931694, mean p set: 0.4513835310935974
loss_pred:0.017933402210474014, decouple_loss:0.0022958337794989347
Iteration: 43, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45280054211616516, gen p mean: -0.04388587921857834, mean p set: 0.45328083634376526
loss_pred:0.0172563549131155, decouple_loss:0.002086763735860586
The modified gen p mean: 0.45169106125831604, gen p mean: -0.05129693076014519, mean p set: 0.4521713852882385The modified gen p mean: 0.45206841826438904, gen p mean: -0.045414287596940994, mean p set: 0.45254871249198914
loss_pred:0.01688351295888424, decouple_loss:0.0023038238286972046
loss_pred:0.018132761120796204, decouple_loss:0.0021998838055878878
Iteration: 44, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44949817657470703, gen p mean: -0.0470055416226387, mean p set: 0.44997847080230713
loss_pred:0.017626747488975525, decouple_loss:0.0021884252782911062
The modified gen p mean: 0.45232534408569336, gen p mean: -0.05071510002017021, mean p set: 0.45280560851097107
The modified gen p mean: 0.4496479630470276, gen p mean: -0.0425417535007, mean p set: 0.4501282274723053
loss_pred:0.01669657975435257, decouple_loss:0.00223642960190773
loss_pred:0.01802118867635727, decouple_loss:0.002303451532498002
Iteration: 45, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514251947402954, gen p mean: -0.03953336924314499, mean p set: 0.4519054889678955
loss_pred:0.017228014767169952, decouple_loss:0.002068139147013426
The modified gen p mean: 0.455077588558197, gen p mean: -0.047529783099889755, mean p set: 0.4555578827857971
The modified gen p mean: 0.45113781094551086, gen p mean: -0.052804745733737946, mean p set: 0.4516180753707886
loss_pred:0.01707378774881363, decouple_loss:0.002155648311600089
loss_pred:0.017547640949487686, decouple_loss:0.0019374556140974164
Iteration: 46, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45269447565078735, gen p mean: -0.04619395732879639, mean p set: 0.45317476987838745
loss_pred:0.01664258912205696, decouple_loss:0.0018500837031751871
The modified gen p mean: 0.4519517719745636, gen p mean: -0.036938104778528214, mean p set: 0.4524320662021637The modified gen p mean: 0.45263397693634033, gen p mean: -0.04425554350018501, mean p set: 0.45311427116394043
loss_pred:0.01691373437643051, decouple_loss:0.0022241121623665094
loss_pred:0.016958855092525482, decouple_loss:0.0021850240882486105
Iteration: 47, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45261350274086, gen p mean: -0.03855277597904205, mean p set: 0.4530937969684601
loss_pred:0.01724446751177311, decouple_loss:0.001976254628971219
The modified gen p mean: 0.4495428502559662, gen p mean: -0.04102843627333641, mean p set: 0.4500231444835663The modified gen p mean: 0.45247066020965576, gen p mean: -0.04454178363084793, mean p set: 0.45295095443725586
loss_pred:0.016741124913096428, decouple_loss:0.0018685756949707866
loss_pred:0.018033698201179504, decouple_loss:0.001964281080290675
Iteration: 48, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500288963317871, gen p mean: -0.04651039093732834, mean p set: 0.4505091905593872
loss_pred:0.017831260338425636, decouple_loss:0.0019253089558333158
The modified gen p mean: 0.45129069685935974, gen p mean: -0.0448882058262825, mean p set: 0.45177099108695984The modified gen p mean: 0.4506045877933502, gen p mean: -0.05285315588116646, mean p set: 0.45108485221862793
loss_pred:0.017011385411024094, decouple_loss:0.0018363724229857326
loss_pred:0.016665678471326828, decouple_loss:0.0020636252593249083
Iteration: 49, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507342576980591, gen p mean: -0.04922105744481087, mean p set: 0.4512145519256592
loss_pred:0.017416587099432945, decouple_loss:0.0019758203998208046
The modified gen p mean: 0.4508156180381775, gen p mean: -0.05847683548927307, mean p set: 0.4512959122657776The modified gen p mean: 0.45212826132774353, gen p mean: -0.05484020337462425, mean p set: 0.45260855555534363
loss_pred:0.016123389825224876, decouple_loss:0.002098605502396822
loss_pred:0.01632312498986721, decouple_loss:0.0019797165878117085
Iteration: 50, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4532754719257355, gen p mean: -0.05339575186371803, mean p set: 0.45375576615333557
loss_pred:0.016469087451696396, decouple_loss:0.0018134091515094042
The modified gen p mean: 0.45118024945259094, gen p mean: -0.04967181757092476, mean p set: 0.45166051387786865The modified gen p mean: 0.45394575595855713, gen p mean: -0.049570344388484955, mean p set: 0.4544260501861572
loss_pred:0.017118386924266815, decouple_loss:0.001867598039098084
loss_pred:0.01673492044210434, decouple_loss:0.001970305573195219
2023-04-30 22:30:10 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.0630945935845375, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.05685921385884285, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.058329470455646515, mean p set: 0.4500633478164673
loss_pred:0.01892472431063652, decouple_loss:0.00197393330745399
loss_pred:0.017854338511824608, decouple_loss:0.001888892031274736
loss_pred:0.017925450578331947, decouple_loss:0.0019304808229207993
WV_0_PC_1_EH_0_PS_40, loss: 0.018331393599510193, avg_mse: 0.02613642066717148
current test mse: 0.026136
Iteration: 51, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45258569717407227, gen p mean: -0.05395028367638588, mean p set: 0.45306602120399475
The modified gen p mean: 0.45276182889938354, gen p mean: -0.054092127829790115, mean p set: 0.45324212312698364
The modified gen p mean: 0.45117950439453125, gen p mean: -0.04858306795358658, mean p set: 0.45165982842445374
loss_pred:0.017081189900636673, decouple_loss:0.0018776294309645891
loss_pred:0.015960481017827988, decouple_loss:0.001946526113897562loss_pred:0.017037514597177505, decouple_loss:0.0022028167732059956
Iteration: 52, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4512356221675873, gen p mean: -0.05466453358530998, mean p set: 0.4517159163951874
loss_pred:0.018068952485919, decouple_loss:0.0018887005280703306
The modified gen p mean: 0.452853798866272, gen p mean: -0.049230437725782394, mean p set: 0.4533340632915497The modified gen p mean: 0.4513115882873535, gen p mean: -0.050124406814575195, mean p set: 0.4517918825149536
loss_pred:0.01683417335152626, decouple_loss:0.0018357044318690896
loss_pred:0.016668651252985, decouple_loss:0.0017485007410869002
Iteration: 53, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45255064964294434, gen p mean: -0.0562569834291935, mean p set: 0.4530309736728668
loss_pred:0.01685943640768528, decouple_loss:0.001589765539392829
The modified gen p mean: 0.45209187269210815, gen p mean: -0.052613094449043274, mean p set: 0.45257216691970825The modified gen p mean: 0.4516717791557312, gen p mean: -0.05415268987417221, mean p set: 0.4521520435810089
loss_pred:0.016517559066414833, decouple_loss:0.0015988273080438375
loss_pred:0.01656913384795189, decouple_loss:0.0018211937276646495
Iteration: 54, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44911250472068787, gen p mean: -0.05669392645359039, mean p set: 0.44959282875061035
loss_pred:0.017122140154242516, decouple_loss:0.001584557699970901
The modified gen p mean: 0.44926100969314575, gen p mean: -0.05866261571645737, mean p set: 0.44974127411842346The modified gen p mean: 0.4535921514034271, gen p mean: -0.057444825768470764, mean p set: 0.4540724456310272
loss_pred:0.016866464167833328, decouple_loss:0.0015558317536488175
loss_pred:0.016506897285580635, decouple_loss:0.0017335546435788274
Iteration: 55, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450872540473938, gen p mean: -0.05583832040429115, mean p set: 0.4513528347015381
loss_pred:0.01754431612789631, decouple_loss:0.001610812614671886
The modified gen p mean: 0.45204970240592957, gen p mean: -0.04950892925262451, mean p set: 0.45252999663352966The modified gen p mean: 0.4504259526729584, gen p mean: -0.05573192983865738, mean p set: 0.4509062170982361
loss_pred:0.017230937257409096, decouple_loss:0.0016072255093604326
loss_pred:0.016644202172756195, decouple_loss:0.0015526723582297564
Iteration: 56, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511440098285675, gen p mean: -0.05450695380568504, mean p set: 0.4516242742538452
loss_pred:0.01655658148229122, decouple_loss:0.0016167397843673825
The modified gen p mean: 0.45326367020606995, gen p mean: -0.06087178364396095, mean p set: 0.45374393463134766The modified gen p mean: 0.4516836404800415, gen p mean: -0.05250855162739754, mean p set: 0.4521639347076416
loss_pred:0.016818426549434662, decouple_loss:0.0016972462181001902
loss_pred:0.0161704421043396, decouple_loss:0.0016444451175630093
Iteration: 57, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4515306353569031, gen p mean: -0.06232500821352005, mean p set: 0.4520109295845032
loss_pred:0.01643257960677147, decouple_loss:0.0015561538748443127
The modified gen p mean: 0.4501611590385437, gen p mean: -0.05415999889373779, mean p set: 0.4506414532661438The modified gen p mean: 0.452254056930542, gen p mean: -0.058004748076200485, mean p set: 0.4527343511581421
loss_pred:0.016684651374816895, decouple_loss:0.0014312666608020663
loss_pred:0.01648418791592121, decouple_loss:0.0015480720903724432
Iteration: 58, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503200948238373, gen p mean: -0.05245222896337509, mean p set: 0.45080041885375977
loss_pred:0.017054138705134392, decouple_loss:0.001475701224990189
The modified gen p mean: 0.44975897669792175, gen p mean: -0.051097605377435684, mean p set: 0.45023927092552185The modified gen p mean: 0.4511748254299164, gen p mean: -0.05585385113954544, mean p set: 0.4516550898551941
loss_pred:0.0164091307669878, decouple_loss:0.0013937645126134157
loss_pred:0.017149128019809723, decouple_loss:0.0014296919107437134
Iteration: 59, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4517531096935272, gen p mean: -0.04699388146400452, mean p set: 0.4522334337234497
loss_pred:0.016917850822210312, decouple_loss:0.001416284590959549
The modified gen p mean: 0.4519859254360199, gen p mean: -0.05027620121836662, mean p set: 0.45246621966362The modified gen p mean: 0.4524647891521454, gen p mean: -0.0499851293861866, mean p set: 0.45294511318206787
loss_pred:0.016500398516654968, decouple_loss:0.0014148035552352667
loss_pred:0.01602458953857422, decouple_loss:0.0013596254866570234
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012001_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012001_3_24hr.npz
NaN value num: 0
Iteration: 60, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44669002294540405, gen p mean: -0.058340124785900116, mean p set: 0.44717034697532654
loss_pred:0.015383278951048851, decouple_loss:0.0022253775969147682
The modified gen p mean: 0.4481727182865143, gen p mean: -0.05808704346418381, mean p set: 0.4486530125141144The modified gen p mean: 0.4455767571926117, gen p mean: -0.05882580578327179, mean p set: 0.4460570514202118
loss_pred:0.016234364360570908, decouple_loss:0.0022405346389859915
loss_pred:0.014139344915747643, decouple_loss:0.0017695024143904448
2023-04-30 22:32:47 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.05966314673423767, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.053906310349702835, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.05490276962518692, mean p set: 0.4500633478164673
loss_pred:0.018718775361776352, decouple_loss:0.0016104906098917127
loss_pred:0.017629429697990417, decouple_loss:0.0014930578181520104
loss_pred:0.01773773692548275, decouple_loss:0.0014587851474061608
WV_0_PC_1_EH_0_PS_40, loss: 0.018104687333106995, avg_mse: 0.025904694572091103
current test mse: 0.025905
Iteration: 61, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464447498321533, gen p mean: -0.05646153539419174, mean p set: 0.4469250440597534
The modified gen p mean: 0.4470917880535126, gen p mean: -0.05641128122806549, mean p set: 0.44757208228111267
The modified gen p mean: 0.4475003480911255, gen p mean: -0.05682344362139702, mean p set: 0.4479806125164032
loss_pred:0.014771465212106705, decouple_loss:0.0015845559537410736
loss_pred:0.015347111970186234, decouple_loss:0.0016699599800631404
loss_pred:0.01430624257773161, decouple_loss:0.00153749727178365
Iteration: 62, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468749761581421, gen p mean: -0.05579397827386856, mean p set: 0.4473552703857422
loss_pred:0.01456361822783947, decouple_loss:0.0017474773339927197
The modified gen p mean: 0.4457424283027649, gen p mean: -0.05827898159623146, mean p set: 0.4462227523326874
The modified gen p mean: 0.44865882396698, gen p mean: -0.0640135109424591, mean p set: 0.44913914799690247
loss_pred:0.013956107199192047, decouple_loss:0.0019127735868096352
loss_pred:0.014714903198182583, decouple_loss:0.0014754246221855283
Iteration: 63, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44723355770111084, gen p mean: -0.05590098351240158, mean p set: 0.4477138817310333
loss_pred:0.014445020817220211, decouple_loss:0.001403829432092607
The modified gen p mean: 0.4477525055408478, gen p mean: -0.06066418066620827, mean p set: 0.44823282957077026The modified gen p mean: 0.44639071822166443, gen p mean: -0.058591775596141815, mean p set: 0.44687098264694214
loss_pred:0.014863044023513794, decouple_loss:0.0015162047930061817
loss_pred:0.014136319980025291, decouple_loss:0.0014848236460238695
Iteration: 64, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476628601551056, gen p mean: -0.055164750665426254, mean p set: 0.4481431543827057
loss_pred:0.013947645202279091, decouple_loss:0.0016032648272812366
The modified gen p mean: 0.4459710121154785, gen p mean: -0.05799043923616409, mean p set: 0.4464513063430786The modified gen p mean: 0.44881632924079895, gen p mean: -0.05911422148346901, mean p set: 0.44929662346839905
loss_pred:0.014746527187526226, decouple_loss:0.0016912072896957397
loss_pred:0.013981208205223083, decouple_loss:0.0016239084070548415
Iteration: 65, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44767576456069946, gen p mean: -0.05246005579829216, mean p set: 0.44815605878829956
loss_pred:0.013732412829995155, decouple_loss:0.0013579066144302487
The modified gen p mean: 0.44901183247566223, gen p mean: -0.05794515833258629, mean p set: 0.44949212670326233The modified gen p mean: 0.4480348825454712, gen p mean: -0.05468021705746651, mean p set: 0.4485151767730713
loss_pred:0.013787265866994858, decouple_loss:0.0015333741903305054
loss_pred:0.013630729168653488, decouple_loss:0.0014699400635436177
Iteration: 66, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481533467769623, gen p mean: -0.05778198316693306, mean p set: 0.4486336410045624
loss_pred:0.013734366744756699, decouple_loss:0.0015397004317492247
The modified gen p mean: 0.44879624247550964, gen p mean: -0.05694160237908363, mean p set: 0.44927650690078735
The modified gen p mean: 0.44699421525001526, gen p mean: -0.054044630378484726, mean p set: 0.44747447967529297
loss_pred:0.01348921936005354, decouple_loss:0.0017039010999724269
loss_pred:0.01394984032958746, decouple_loss:0.00156279222574085
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 67, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486105442047119, gen p mean: -0.05740833282470703, mean p set: 0.449090838432312
loss_pred:0.013405733741819859, decouple_loss:0.0015277310740202665
The modified gen p mean: 0.447226345539093, gen p mean: -0.05336738005280495, mean p set: 0.4477066397666931The modified gen p mean: 0.4478265047073364, gen p mean: -0.05179739370942116, mean p set: 0.4483067989349365
loss_pred:0.014111618511378765, decouple_loss:0.0015879615675657988
loss_pred:0.014572207815945148, decouple_loss:0.001503207255154848
Iteration: 68, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4462290108203888, gen p mean: -0.05179477483034134, mean p set: 0.4467092752456665
loss_pred:0.014018425717949867, decouple_loss:0.0015320517122745514
The modified gen p mean: 0.44811418652534485, gen p mean: -0.050554368644952774, mean p set: 0.44859448075294495The modified gen p mean: 0.44720178842544556, gen p mean: -0.048710234463214874, mean p set: 0.44768208265304565
loss_pred:0.014313149265944958, decouple_loss:0.0015738226938992739
loss_pred:0.013429291546344757, decouple_loss:0.0014733582502231002
Iteration: 69, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479982256889343, gen p mean: -0.04918811097741127, mean p set: 0.44847849011421204
loss_pred:0.01327101793140173, decouple_loss:0.0014413772150874138
The modified gen p mean: 0.44706714153289795, gen p mean: -0.047455914318561554, mean p set: 0.44754740595817566The modified gen p mean: 0.4461544156074524, gen p mean: -0.05031680315732956, mean p set: 0.4466347098350525
loss_pred:0.013378364965319633, decouple_loss:0.0014856178313493729
loss_pred:0.01366142462939024, decouple_loss:0.0015429010381922126
Iteration: 70, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44770726561546326, gen p mean: -0.05101044476032257, mean p set: 0.44818755984306335
loss_pred:0.013152549043297768, decouple_loss:0.0015804339200258255
The modified gen p mean: 0.4470854103565216, gen p mean: -0.045047156512737274, mean p set: 0.4475656747817993The modified gen p mean: 0.4466317892074585, gen p mean: -0.04665249213576317, mean p set: 0.4471120834350586
loss_pred:0.013535989448428154, decouple_loss:0.001500451471656561
loss_pred:0.013562638312578201, decouple_loss:0.001490144175477326
2023-04-30 22:34:41 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.04866291582584381, mean p set: 0.4502691626548767
The modified gen p mean: 0.4498766362667084, gen p mean: -0.043114956468343735, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.0442141592502594, mean p set: 0.4500633478164673
loss_pred:0.01939687691628933, decouple_loss:0.0014288340462371707
loss_pred:0.018228329718112946, decouple_loss:0.0014413729077205062
loss_pred:0.018383493646979332, decouple_loss:0.0014346358366310596
WV_0_PC_1_EH_0_PS_40, loss: 0.018741315230727196, avg_mse: 0.027181219309568405
current test mse: 0.027181
Iteration: 71, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482642710208893, gen p mean: -0.04577077180147171, mean p set: 0.4487445652484894
The modified gen p mean: 0.4467604160308838, gen p mean: -0.04364671930670738, mean p set: 0.4472406804561615
The modified gen p mean: 0.4475573003292084, gen p mean: -0.04440419003367424, mean p set: 0.44803762435913086
loss_pred:0.013431338593363762, decouple_loss:0.0013432467821985483
loss_pred:0.013433285057544708, decouple_loss:0.0014165000757202506
loss_pred:0.01349297072738409, decouple_loss:0.0013415993889793754
Iteration: 72, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44730597734451294, gen p mean: -0.044757019728422165, mean p set: 0.44778627157211304
The modified gen p mean: 0.44523462653160095, gen p mean: -0.049705758690834045, mean p set: 0.44571492075920105
loss_pred:0.013312164694070816, decouple_loss:0.0013910651905462146
loss_pred:0.012641514651477337, decouple_loss:0.001433354103937745
The modified gen p mean: 0.4474366009235382, gen p mean: -0.04120911657810211, mean p set: 0.4479168951511383
loss_pred:0.012871935963630676, decouple_loss:0.001361460192129016
Iteration: 73, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472421705722809, gen p mean: -0.04383467137813568, mean p set: 0.44772249460220337
loss_pred:0.013501311652362347, decouple_loss:0.0012676138430833817
The modified gen p mean: 0.44603413343429565, gen p mean: -0.049400053918361664, mean p set: 0.44651445746421814The modified gen p mean: 0.4478665292263031, gen p mean: -0.045098334550857544, mean p set: 0.4483468234539032
loss_pred:0.01280056033283472, decouple_loss:0.0012761245016008615
loss_pred:0.012491617351770401, decouple_loss:0.0012428639456629753
Iteration: 74, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448044091463089, gen p mean: -0.043024927377700806, mean p set: 0.4485243558883667
loss_pred:0.012825093232095242, decouple_loss:0.00151956791523844
The modified gen p mean: 0.4484339952468872, gen p mean: -0.049485377967357635, mean p set: 0.4489142596721649The modified gen p mean: 0.44795510172843933, gen p mean: -0.04325044900178909, mean p set: 0.44843539595603943
loss_pred:0.013067813590168953, decouple_loss:0.0015053387032821774
loss_pred:0.012810204178094864, decouple_loss:0.001393601531162858
Iteration: 75, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472917318344116, gen p mean: -0.04318714514374733, mean p set: 0.4477720260620117
loss_pred:0.013121162541210651, decouple_loss:0.0014880701201036572
The modified gen p mean: 0.4466645419597626, gen p mean: -0.045548807829618454, mean p set: 0.44714486598968506The modified gen p mean: 0.44729161262512207, gen p mean: -0.04279148578643799, mean p set: 0.44777190685272217
loss_pred:0.012717461213469505, decouple_loss:0.001446576789021492
loss_pred:0.013312666676938534, decouple_loss:0.0014989477349445224
Iteration: 76, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44653376936912537, gen p mean: -0.04672376438975334, mean p set: 0.44701406359672546
loss_pred:0.013268916867673397, decouple_loss:0.0013485680101439357
The modified gen p mean: 0.44880780577659607, gen p mean: -0.05124472454190254, mean p set: 0.44928810000419617The modified gen p mean: 0.4479070007801056, gen p mean: -0.05001455917954445, mean p set: 0.4483872950077057
loss_pred:0.012905462644994259, decouple_loss:0.0014514770591631532
loss_pred:0.013157668523490429, decouple_loss:0.0013661171542480588
Iteration: 77, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481518268585205, gen p mean: -0.04837046563625336, mean p set: 0.4486321210861206
loss_pred:0.01292700506746769, decouple_loss:0.0013639552053064108
The modified gen p mean: 0.44694462418556213, gen p mean: -0.05127432197332382, mean p set: 0.44742488861083984The modified gen p mean: 0.4465906620025635, gen p mean: -0.04762866348028183, mean p set: 0.4470709264278412
loss_pred:0.013609340414404869, decouple_loss:0.0014307847013697028
loss_pred:0.013455343432724476, decouple_loss:0.001457348931580782
Iteration: 78, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470219612121582, gen p mean: -0.04905255138874054, mean p set: 0.4475022256374359
loss_pred:0.012861451134085655, decouple_loss:0.0013488337863236666
The modified gen p mean: 0.44648075103759766, gen p mean: -0.04567895829677582, mean p set: 0.44696107506752014
The modified gen p mean: 0.44601139426231384, gen p mean: -0.04491480067372322, mean p set: 0.44649171829223633
loss_pred:0.013741339556872845, decouple_loss:0.0013162795221433043
loss_pred:0.01321074366569519, decouple_loss:0.0012486227788031101
Iteration: 79, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466207027435303, gen p mean: -0.04854859039187431, mean p set: 0.44710099697113037
loss_pred:0.01237849798053503, decouple_loss:0.0013386280043050647
The modified gen p mean: 0.44639310240745544, gen p mean: -0.049166955053806305, mean p set: 0.44687342643737793The modified gen p mean: 0.4483518898487091, gen p mean: -0.04647509381175041, mean p set: 0.4488321542739868
loss_pred:0.013445512391626835, decouple_loss:0.0015456830151379108
loss_pred:0.012706084176898003, decouple_loss:0.0012632469879463315
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012019_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012019_3_24hr.npz
NaN value num: 0
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 80, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44894957542419434, gen p mean: -0.04991753399372101, mean p set: 0.44942986965179443
loss_pred:0.013654293492436409, decouple_loss:0.0012066878844052553
The modified gen p mean: 0.44853857159614563, gen p mean: -0.0435737669467926, mean p set: 0.44901883602142334The modified gen p mean: 0.4494735300540924, gen p mean: -0.04363422468304634, mean p set: 0.4499538242816925
loss_pred:0.012889120727777481, decouple_loss:0.0012881174916401505
loss_pred:0.01351198460906744, decouple_loss:0.0012386419111862779
2023-04-30 22:37:16 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.048456840217113495, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.042789068073034286, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04393539950251579, mean p set: 0.4500633478164673
loss_pred:0.019252989441156387, decouple_loss:0.0013004556531086564
loss_pred:0.0180716160684824, decouple_loss:0.0014545939629897475
loss_pred:0.0182171817868948, decouple_loss:0.0013892195420339704
WV_0_PC_1_EH_0_PS_40, loss: 0.01858299970626831, avg_mse: 0.026982838287949562
current test mse: 0.026983
Iteration: 81, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489581286907196, gen p mean: -0.041702188551425934, mean p set: 0.4494384229183197
The modified gen p mean: 0.4491555094718933, gen p mean: -0.04563179239630699, mean p set: 0.4496358335018158
The modified gen p mean: 0.4494182765483856, gen p mean: -0.04917452484369278, mean p set: 0.4498986005783081
loss_pred:0.01333822775632143, decouple_loss:0.0012192499125376344
loss_pred:0.013001391664147377, decouple_loss:0.00125113723333925
loss_pred:0.013361796736717224, decouple_loss:0.0014684040797874331
Iteration: 82, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448279470205307, gen p mean: -0.042913928627967834, mean p set: 0.4487597644329071
loss_pred:0.013516472652554512, decouple_loss:0.0012065962655469775
The modified gen p mean: 0.44924524426460266, gen p mean: -0.04523688927292824, mean p set: 0.44972550868988037
The modified gen p mean: 0.44797807931900024, gen p mean: -0.04816048964858055, mean p set: 0.44845834374427795
loss_pred:0.01326972059905529, decouple_loss:0.0012072160607203841
loss_pred:0.013375445269048214, decouple_loss:0.0011636510025709867
Iteration: 83, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493795335292816, gen p mean: -0.04996831342577934, mean p set: 0.4498598277568817
loss_pred:0.013173721730709076, decouple_loss:0.0013506370596587658
The modified gen p mean: 0.4493986666202545, gen p mean: -0.04963165894150734, mean p set: 0.4498789310455322The modified gen p mean: 0.4487845003604889, gen p mean: -0.0453869104385376, mean p set: 0.4492647647857666
loss_pred:0.01305411383509636, decouple_loss:0.001386449788697064
loss_pred:0.012991140596568584, decouple_loss:0.001218134188093245
Iteration: 84, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483930170536041, gen p mean: -0.048783618956804276, mean p set: 0.4488733410835266
loss_pred:0.013539318926632404, decouple_loss:0.0011239040177315474
The modified gen p mean: 0.4477930963039398, gen p mean: -0.043323926627635956, mean p set: 0.4482733905315399The modified gen p mean: 0.4475438594818115, gen p mean: -0.04890895262360573, mean p set: 0.4480241537094116
loss_pred:0.013424777425825596, decouple_loss:0.0012148303212597966
loss_pred:0.01349075511097908, decouple_loss:0.0012762421974912286
Iteration: 85, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44819584488868713, gen p mean: -0.04684138670563698, mean p set: 0.4486761689186096
loss_pred:0.013162635266780853, decouple_loss:0.0011681899195536971
The modified gen p mean: 0.44856327772140503, gen p mean: -0.04820508509874344, mean p set: 0.4490435719490051The modified gen p mean: 0.4485247731208801, gen p mean: -0.040562380105257034, mean p set: 0.4490050673484802
loss_pred:0.01380976103246212, decouple_loss:0.0012793480418622494
loss_pred:0.013286842964589596, decouple_loss:0.0012535379501059651
Iteration: 86, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481603503227234, gen p mean: -0.037507422268390656, mean p set: 0.4486406445503235
loss_pred:0.013844538480043411, decouple_loss:0.001447730464860797
The modified gen p mean: 0.4484134614467621, gen p mean: -0.047507476061582565, mean p set: 0.4488937258720398The modified gen p mean: 0.4475499987602234, gen p mean: -0.03656388074159622, mean p set: 0.4480302929878235
loss_pred:0.013853473588824272, decouple_loss:0.0015877679688856006
loss_pred:0.013499469496309757, decouple_loss:0.0015046241460368037
Iteration: 87, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495750963687897, gen p mean: -0.04916748031973839, mean p set: 0.45005539059638977
loss_pred:0.01303072739392519, decouple_loss:0.0011313973227515817
The modified gen p mean: 0.4489569664001465, gen p mean: -0.05079571530222893, mean p set: 0.4494372606277466The modified gen p mean: 0.44952598214149475, gen p mean: -0.05375363305211067, mean p set: 0.4500062167644501
loss_pred:0.012992024421691895, decouple_loss:0.0011758317705243826
loss_pred:0.013434745371341705, decouple_loss:0.0011210165685042739
Iteration: 88, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478198289871216, gen p mean: -0.049470484256744385, mean p set: 0.4483001232147217
loss_pred:0.013412905856966972, decouple_loss:0.001265108585357666
The modified gen p mean: 0.4494485557079315, gen p mean: -0.05163874849677086, mean p set: 0.449928879737854The modified gen p mean: 0.44886156916618347, gen p mean: -0.04752183333039284, mean p set: 0.44934189319610596
loss_pred:0.013248979113996029, decouple_loss:0.0012677820632234216
loss_pred:0.01325079333037138, decouple_loss:0.001167041016742587
Iteration: 89, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491133987903595, gen p mean: -0.05049779266119003, mean p set: 0.4495936930179596
loss_pred:0.012947974726557732, decouple_loss:0.0011684831697493792
The modified gen p mean: 0.44868671894073486, gen p mean: -0.045829933136701584, mean p set: 0.4491669833660126The modified gen p mean: 0.4489925801753998, gen p mean: -0.04893358424305916, mean p set: 0.44947290420532227
loss_pred:0.012968678958714008, decouple_loss:0.001159764127805829
loss_pred:0.012823725119233131, decouple_loss:0.0011478050146251917
Iteration: 90, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488867223262787, gen p mean: -0.048715610057115555, mean p set: 0.4493670165538788
loss_pred:0.01281773205846548, decouple_loss:0.0012182352365925908
The modified gen p mean: 0.4488207697868347, gen p mean: -0.05397481843829155, mean p set: 0.4493010640144348The modified gen p mean: 0.4486974775791168, gen p mean: -0.049289021641016006, mean p set: 0.44917774200439453
loss_pred:0.013870606198906898, decouple_loss:0.0011827306589111686
loss_pred:0.01325961947441101, decouple_loss:0.0012918137945234776
2023-04-30 22:39:11 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.0518881231546402, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04622102156281471, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.04720302298665047, mean p set: 0.4500633478164673
loss_pred:0.019234241917729378, decouple_loss:0.0011591364163905382
loss_pred:0.01817944087088108, decouple_loss:0.0012144310167059302
loss_pred:0.01799045130610466, decouple_loss:0.0012325061252340674
WV_0_PC_1_EH_0_PS_40, loss: 0.018528146669268608, avg_mse: 0.026948820799589157
current test mse: 0.026949
Iteration: 91, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486227035522461, gen p mean: -0.050678182393312454, mean p set: 0.4491029977798462
The modified gen p mean: 0.44908520579338074, gen p mean: -0.04956093057990074, mean p set: 0.44956550002098083
The modified gen p mean: 0.44809702038764954, gen p mean: -0.05229499191045761, mean p set: 0.448577344417572
loss_pred:0.012795262038707733, decouple_loss:0.0011037931544706225
loss_pred:0.012950828298926353, decouple_loss:0.0012443297309800982loss_pred:0.013276870362460613, decouple_loss:0.0011214619735255837
Iteration: 92, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44782623648643494, gen p mean: -0.038196712732315063, mean p set: 0.44830653071403503
loss_pred:0.013065424747765064, decouple_loss:0.0011868600267916918
The modified gen p mean: 0.4489731192588806, gen p mean: -0.046549320220947266, mean p set: 0.4494534134864807The modified gen p mean: 0.44813093543052673, gen p mean: -0.04886181280016899, mean p set: 0.44861117005348206
loss_pred:0.012705876491963863, decouple_loss:0.0011579871643334627
loss_pred:0.013112922199070454, decouple_loss:0.0012330785393714905
Iteration: 93, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449386328458786, gen p mean: -0.05145372077822685, mean p set: 0.4498666524887085
loss_pred:0.013404990546405315, decouple_loss:0.0012608878314495087
The modified gen p mean: 0.4491598308086395, gen p mean: -0.047332435846328735, mean p set: 0.4496401250362396The modified gen p mean: 0.4483850300312042, gen p mean: -0.04918886721134186, mean p set: 0.4488653242588043
loss_pred:0.013167157769203186, decouple_loss:0.0013445199001580477
loss_pred:0.012968262657523155, decouple_loss:0.001286616432480514
Iteration: 94, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479416310787201, gen p mean: -0.04390078783035278, mean p set: 0.4484219551086426
The modified gen p mean: 0.4490557909011841, gen p mean: -0.05054397135972977, mean p set: 0.4495360851287842
loss_pred:0.013009551912546158, decouple_loss:0.0010718079283833504
loss_pred:0.013380403630435467, decouple_loss:0.0011829630238935351
The modified gen p mean: 0.4489286243915558, gen p mean: -0.04872846603393555, mean p set: 0.4494089186191559
loss_pred:0.013040991500020027, decouple_loss:0.001164760789833963
Iteration: 95, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44813117384910583, gen p mean: -0.044812656939029694, mean p set: 0.4486114978790283
loss_pred:0.013311043381690979, decouple_loss:0.0014021887909621
The modified gen p mean: 0.4479733109474182, gen p mean: -0.04414373263716698, mean p set: 0.4484536051750183The modified gen p mean: 0.44788870215415955, gen p mean: -0.04578245431184769, mean p set: 0.44836896657943726
loss_pred:0.013462690636515617, decouple_loss:0.0012063918402418494
loss_pred:0.013327346183359623, decouple_loss:0.0014048736775293946
Iteration: 96, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480119049549103, gen p mean: -0.041800323873758316, mean p set: 0.448492169380188
loss_pred:0.013306479901075363, decouple_loss:0.0011545417364686728
The modified gen p mean: 0.44751986861228943, gen p mean: -0.051199231296777725, mean p set: 0.4480001628398895The modified gen p mean: 0.4492949843406677, gen p mean: -0.04793180525302887, mean p set: 0.4497752785682678
loss_pred:0.013510401360690594, decouple_loss:0.0011689024977385998
loss_pred:0.012540952302515507, decouple_loss:0.0011511584743857384
Iteration: 97, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481983184814453, gen p mean: -0.044912226498126984, mean p set: 0.4486786425113678
loss_pred:0.013596630655229092, decouple_loss:0.0013662994606420398
The modified gen p mean: 0.4484594762325287, gen p mean: -0.047067515552043915, mean p set: 0.4489397704601288The modified gen p mean: 0.4486387372016907, gen p mean: -0.045386701822280884, mean p set: 0.44911903142929077
loss_pred:0.01291944645345211, decouple_loss:0.0014760749181732535
loss_pred:0.012518225237727165, decouple_loss:0.0014303440693765879
Iteration: 98, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44877126812934875, gen p mean: -0.046690575778484344, mean p set: 0.44925159215927124
loss_pred:0.012710895389318466, decouple_loss:0.0011541160056367517
The modified gen p mean: 0.4490394592285156, gen p mean: -0.04619407653808594, mean p set: 0.44951972365379333The modified gen p mean: 0.44903847575187683, gen p mean: -0.0446869395673275, mean p set: 0.44951876997947693
loss_pred:0.013041257858276367, decouple_loss:0.001080997521057725
loss_pred:0.012900321744382381, decouple_loss:0.0010812790133059025
Iteration: 99, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491564631462097, gen p mean: -0.049316443502902985, mean p set: 0.4496367573738098
loss_pred:0.012547915801405907, decouple_loss:0.0013519536005333066
The modified gen p mean: 0.4489932656288147, gen p mean: -0.04754825308918953, mean p set: 0.4494735598564148The modified gen p mean: 0.4473295509815216, gen p mean: -0.04495726525783539, mean p set: 0.4478098452091217
loss_pred:0.01290912926197052, decouple_loss:0.0012564799981191754
loss_pred:0.013342516496777534, decouple_loss:0.0013068473199382424
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012003_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012003_3_24hr.npz
NaN value num: 0
Iteration: 100, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44835373759269714, gen p mean: -0.050458263605833054, mean p set: 0.44883406162261963
loss_pred:0.017569053918123245, decouple_loss:0.0011751540005207062
The modified gen p mean: 0.44805678725242615, gen p mean: -0.041504960507154465, mean p set: 0.44853708148002625The modified gen p mean: 0.4497392177581787, gen p mean: -0.051861658692359924, mean p set: 0.4502195119857788
loss_pred:0.017787612974643707, decouple_loss:0.0010976982302963734
loss_pred:0.01569546014070511, decouple_loss:0.001257034600712359
2023-04-30 22:41:44 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.04745025187730789, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.0418197326362133, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.0425526462495327, mean p set: 0.4500633478164673
loss_pred:0.01903935708105564, decouple_loss:0.0013708872720599174
loss_pred:0.01784295029938221, decouple_loss:0.001304142875596881
loss_pred:0.018018363043665886, decouple_loss:0.00131340348161757
WV_0_PC_1_EH_0_PS_40, loss: 0.018366698175668716, avg_mse: 0.026639679446816444
current test mse: 0.02664
Iteration: 101, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44786274433135986, gen p mean: -0.04526263847947121, mean p set: 0.44834303855895996
The modified gen p mean: 0.4479466378688812, gen p mean: -0.0425209105014801, mean p set: 0.44842690229415894
The modified gen p mean: 0.4496183693408966, gen p mean: -0.04421401768922806, mean p set: 0.4500986337661743
loss_pred:0.01718573272228241, decouple_loss:0.0012100229505449533
loss_pred:0.01680358499288559, decouple_loss:0.0014116510283201933
loss_pred:0.01675138622522354, decouple_loss:0.0012724042171612382
Iteration: 102, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44802042841911316, gen p mean: -0.0434291698038578, mean p set: 0.44850072264671326
loss_pred:0.01782836765050888, decouple_loss:0.0011089384788647294
The modified gen p mean: 0.44803911447525024, gen p mean: -0.03759722784161568, mean p set: 0.44851937890052795The modified gen p mean: 0.4492662847042084, gen p mean: -0.04635769501328468, mean p set: 0.44974657893180847
loss_pred:0.01729791983962059, decouple_loss:0.0011290292022749782
loss_pred:0.016937097534537315, decouple_loss:0.0011101829586550593
Iteration: 103, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485088884830475, gen p mean: -0.03935805335640907, mean p set: 0.4489891827106476
loss_pred:0.017701301723718643, decouple_loss:0.0013046072563156486
The modified gen p mean: 0.44731348752975464, gen p mean: -0.03801977261900902, mean p set: 0.44779375195503235The modified gen p mean: 0.44936150312423706, gen p mean: -0.046051785349845886, mean p set: 0.44984182715415955
loss_pred:0.01657877489924431, decouple_loss:0.0013525324175134301
loss_pred:0.01797281950712204, decouple_loss:0.001350054400973022
Iteration: 104, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44783738255500793, gen p mean: -0.03886742889881134, mean p set: 0.44831764698028564
loss_pred:0.01683122105896473, decouple_loss:0.0011075822403654456
The modified gen p mean: 0.4483935832977295, gen p mean: -0.04008256271481514, mean p set: 0.4488738775253296The modified gen p mean: 0.4480515420436859, gen p mean: -0.039868228137493134, mean p set: 0.4485318660736084
loss_pred:0.016043679788708687, decouple_loss:0.0010582396062090993
loss_pred:0.017020363360643387, decouple_loss:0.0011388547718524933
Iteration: 105, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476093649864197, gen p mean: -0.03830861300230026, mean p set: 0.4480896592140198
loss_pred:0.017315780743956566, decouple_loss:0.001530325855128467
The modified gen p mean: 0.44754356145858765, gen p mean: -0.040499329566955566, mean p set: 0.44802385568618774The modified gen p mean: 0.448375940322876, gen p mean: -0.039809226989746094, mean p set: 0.4488562047481537
loss_pred:0.016724415123462677, decouple_loss:0.0016452828422188759
loss_pred:0.017541183158755302, decouple_loss:0.0015043403254821897
Iteration: 106, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480110704898834, gen p mean: -0.041930366307497025, mean p set: 0.44849133491516113
loss_pred:0.016929345205426216, decouple_loss:0.0012496145209297538
The modified gen p mean: 0.4490705728530884, gen p mean: -0.04283405840396881, mean p set: 0.4495508372783661The modified gen p mean: 0.4495101273059845, gen p mean: -0.04480166360735893, mean p set: 0.4499904215335846
loss_pred:0.01694878190755844, decouple_loss:0.0013193023623898625
loss_pred:0.01604703813791275, decouple_loss:0.0012097483268007636
Iteration: 107, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494950771331787, gen p mean: -0.04806912690401077, mean p set: 0.4499753415584564
loss_pred:0.016421016305685043, decouple_loss:0.0013369007501751184
The modified gen p mean: 0.44802823662757874, gen p mean: -0.0372261144220829, mean p set: 0.44850850105285645The modified gen p mean: 0.4481784403324127, gen p mean: -0.038453731685876846, mean p set: 0.4486587643623352
loss_pred:0.016962725669145584, decouple_loss:0.001382168265990913
loss_pred:0.017623405903577805, decouple_loss:0.001308712875470519
Iteration: 108, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486146569252014, gen p mean: -0.04663020372390747, mean p set: 0.4490949809551239
loss_pred:0.01620558649301529, decouple_loss:0.0011926889419555664
The modified gen p mean: 0.44859200716018677, gen p mean: -0.04075213149189949, mean p set: 0.4490722715854645The modified gen p mean: 0.4477972388267517, gen p mean: -0.04113885387778282, mean p set: 0.4482775628566742
loss_pred:0.017116425558924675, decouple_loss:0.0011710792314261198
loss_pred:0.017348673194646835, decouple_loss:0.0012221498182043433
Iteration: 109, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493980407714844, gen p mean: -0.04315533861517906, mean p set: 0.4498783349990845
loss_pred:0.015983013436198235, decouple_loss:0.001155999256297946
The modified gen p mean: 0.44820448756217957, gen p mean: -0.04469679668545723, mean p set: 0.44868478178977966The modified gen p mean: 0.4468842148780823, gen p mean: -0.04331912100315094, mean p set: 0.44736447930336
loss_pred:0.017477136105298996, decouple_loss:0.0012857499532401562
loss_pred:0.01745895855128765, decouple_loss:0.001240895944647491
Iteration: 110, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44861719012260437, gen p mean: -0.04747249558568001, mean p set: 0.44909751415252686
loss_pred:0.017208542674779892, decouple_loss:0.0012967768125236034
The modified gen p mean: 0.4482074975967407, gen p mean: -0.04517301544547081, mean p set: 0.4486878216266632The modified gen p mean: 0.4477604329586029, gen p mean: -0.04796833544969559, mean p set: 0.448240727186203
loss_pred:0.016825873404741287, decouple_loss:0.0013037350727245212
loss_pred:0.016447922214865685, decouple_loss:0.0013151188613846898
2023-04-30 22:43:38 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.0525142066180706, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04685907065868378, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04751134663820267, mean p set: 0.4500633478164673
loss_pred:0.018533803522586823, decouple_loss:0.0014193352544680238
loss_pred:0.017405493184924126, decouple_loss:0.0012814935762435198
loss_pred:0.01751982793211937, decouple_loss:0.0013168856967240572
WV_0_PC_1_EH_0_PS_40, loss: 0.017886672168970108, avg_mse: 0.02567526139318943
current test mse: 0.025675
At step 110, Best test: 0.025675
save model to /work/09012/haoli1/ls6/ERA5_PredRNN/checkpoints/WV_0_PC_1_EH_0_PS_40/model_model_test_schedule_sampling_DynaMean.ckpt
Iteration: 111, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44775399565696716, gen p mean: -0.04537511616945267, mean p set: 0.4482342600822449
loss_pred:0.016677375882864, decouple_loss:0.0014567108592018485
The modified gen p mean: 0.44792941212654114, gen p mean: -0.04915560036897659, mean p set: 0.44840967655181885The modified gen p mean: 0.4494318962097168, gen p mean: -0.052299775183200836, mean p set: 0.4499121904373169
loss_pred:0.01616666465997696, decouple_loss:0.001332337618805468
loss_pred:0.016281260177493095, decouple_loss:0.0012605282245203853
Iteration: 112, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447353333234787, gen p mean: -0.0447956807911396, mean p set: 0.4478336274623871
The modified gen p mean: 0.4480580687522888, gen p mean: -0.04469335824251175, mean p set: 0.4485383629798889
loss_pred:0.01772204227745533, decouple_loss:0.0013862629421055317
loss_pred:0.016358662396669388, decouple_loss:0.0012809471227228642
The modified gen p mean: 0.448249876499176, gen p mean: -0.05231460556387901, mean p set: 0.4487301707267761
loss_pred:0.017209215089678764, decouple_loss:0.0012598105240613222
Iteration: 113, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44783344864845276, gen p mean: -0.04785553738474846, mean p set: 0.44831374287605286
loss_pred:0.01664026640355587, decouple_loss:0.001277448027394712
The modified gen p mean: 0.44767630100250244, gen p mean: -0.04773920401930809, mean p set: 0.44815659523010254The modified gen p mean: 0.44782301783561707, gen p mean: -0.049761876463890076, mean p set: 0.44830331206321716
loss_pred:0.017470218241214752, decouple_loss:0.0013556337216868997
loss_pred:0.017352387309074402, decouple_loss:0.0014066286385059357
Iteration: 114, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480273425579071, gen p mean: -0.05037716031074524, mean p set: 0.4485076069831848
loss_pred:0.017039043828845024, decouple_loss:0.0012603823561221361
The modified gen p mean: 0.4488072991371155, gen p mean: -0.05594225600361824, mean p set: 0.4492875933647156The modified gen p mean: 0.4487382471561432, gen p mean: -0.052568815648555756, mean p set: 0.4492185115814209
loss_pred:0.01650785654783249, decouple_loss:0.001307582133449614
loss_pred:0.01627962477505207, decouple_loss:0.0012370275799185038
Iteration: 115, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44816097617149353, gen p mean: -0.054175663739442825, mean p set: 0.448641300201416
loss_pred:0.01606924831867218, decouple_loss:0.0013890069676563144
The modified gen p mean: 0.45010989904403687, gen p mean: -0.05670561641454697, mean p set: 0.4505901634693146The modified gen p mean: 0.4483061730861664, gen p mean: -0.051243506371974945, mean p set: 0.4487864673137665
loss_pred:0.016732972115278244, decouple_loss:0.0012641219655051827
loss_pred:0.01615704596042633, decouple_loss:0.0012077325955033302
Iteration: 116, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44844934344291687, gen p mean: -0.05260566249489784, mean p set: 0.44892963767051697
loss_pred:0.017156144604086876, decouple_loss:0.001227432512678206
The modified gen p mean: 0.446767657995224, gen p mean: -0.04771680384874344, mean p set: 0.4472479820251465The modified gen p mean: 0.4486355185508728, gen p mean: -0.053460635244846344, mean p set: 0.4491157829761505
loss_pred:0.017201730981469154, decouple_loss:0.0011819605715572834
loss_pred:0.015972722321748734, decouple_loss:0.0011278054444119334
Iteration: 117, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491247832775116, gen p mean: -0.05496295914053917, mean p set: 0.4496051073074341
loss_pred:0.016260791569948196, decouple_loss:0.0013415556168183684
The modified gen p mean: 0.44823139905929565, gen p mean: -0.04747810214757919, mean p set: 0.44871172308921814The modified gen p mean: 0.4479117691516876, gen p mean: -0.048668500036001205, mean p set: 0.44839203357696533
loss_pred:0.017501724883913994, decouple_loss:0.0014188396744430065
loss_pred:0.016839683055877686, decouple_loss:0.0013297999976202846
Iteration: 118, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44791701436042786, gen p mean: -0.04424036294221878, mean p set: 0.44839733839035034
The modified gen p mean: 0.44883787631988525, gen p mean: -0.051260072737932205, mean p set: 0.44931817054748535
loss_pred:0.01667352393269539, decouple_loss:0.0011065725702792406
loss_pred:0.017049944028258324, decouple_loss:0.001237363088876009
The modified gen p mean: 0.44992712140083313, gen p mean: -0.0535048209130764, mean p set: 0.4504074156284332
loss_pred:0.016008451581001282, decouple_loss:0.001119303167797625
Iteration: 119, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44758620858192444, gen p mean: -0.04836617410182953, mean p set: 0.44806647300720215
loss_pred:0.016186408698558807, decouple_loss:0.0012797537492588162
The modified gen p mean: 0.4478890597820282, gen p mean: -0.046229805797338486, mean p set: 0.4483693838119507The modified gen p mean: 0.44711536169052124, gen p mean: -0.048136744648218155, mean p set: 0.44759565591812134
loss_pred:0.016986465081572533, decouple_loss:0.0014500018442049623
loss_pred:0.016497410833835602, decouple_loss:0.0014198559802025557
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012018_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012018_3_24hr.npz
NaN value num: 0
Iteration: 120, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44804269075393677, gen p mean: -0.04431746155023575, mean p set: 0.44852298498153687
loss_pred:0.018092947080731392, decouple_loss:0.0011820833897218108
The modified gen p mean: 0.450702428817749, gen p mean: -0.041084062308073044, mean p set: 0.45118266344070435The modified gen p mean: 0.45277729630470276, gen p mean: -0.04457356408238411, mean p set: 0.45325756072998047
loss_pred:0.018121439963579178, decouple_loss:0.0012831181520596147
loss_pred:0.017338452860713005, decouple_loss:0.0012044787872582674
2023-04-30 22:46:16 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.04910799488425255, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.043450504541397095, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04432046413421631, mean p set: 0.4500633478164673
loss_pred:0.01851634681224823, decouple_loss:0.0011293698335066438
loss_pred:0.01737908087670803, decouple_loss:0.0012753066839650273
loss_pred:0.017495721578598022, decouple_loss:0.0012089497176930308
WV_0_PC_1_EH_0_PS_40, loss: 0.017857275903224945, avg_mse: 0.025620555505156517
current test mse: 0.025621
At step 120, Best test: 0.025621
save model to /work/09012/haoli1/ls6/ERA5_PredRNN/checkpoints/WV_0_PC_1_EH_0_PS_40/model_model_test_schedule_sampling_DynaMean.ckpt
Iteration: 121, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4506523609161377, gen p mean: -0.03948679938912392, mean p set: 0.4511326253414154
loss_pred:0.018509728834033012, decouple_loss:0.0011366524267941713
The modified gen p mean: 0.45008784532546997, gen p mean: -0.0398121103644371, mean p set: 0.45056816935539246The modified gen p mean: 0.4507633149623871, gen p mean: -0.04693932458758354, mean p set: 0.4512436091899872
loss_pred:0.018028466030955315, decouple_loss:0.0011575600365176797loss_pred:0.01774008944630623, decouple_loss:0.001256700255908072
Iteration: 122, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44840550422668457, gen p mean: -0.04208653047680855, mean p set: 0.4488857686519623
loss_pred:0.018474381417036057, decouple_loss:0.0012693414464592934
The modified gen p mean: 0.4511845111846924, gen p mean: -0.04578964039683342, mean p set: 0.4516648054122925The modified gen p mean: 0.4499867856502533, gen p mean: -0.04869823157787323, mean p set: 0.4504671096801758
loss_pred:0.016783904284238815, decouple_loss:0.0012627594405785203
loss_pred:0.01778632216155529, decouple_loss:0.0012774139177054167
Iteration: 123, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45077523589134216, gen p mean: -0.04558686539530754, mean p set: 0.4512555003166199
loss_pred:0.018583012744784355, decouple_loss:0.0012217519106343389
The modified gen p mean: 0.4503582715988159, gen p mean: -0.04490423947572708, mean p set: 0.450838565826416The modified gen p mean: 0.45090603828430176, gen p mean: -0.047841932624578476, mean p set: 0.45138633251190186
loss_pred:0.01725555956363678, decouple_loss:0.0012455553514882922
loss_pred:0.018389005213975906, decouple_loss:0.0011216233251616359
Iteration: 124, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44866201281547546, gen p mean: -0.03891989216208458, mean p set: 0.44914230704307556
loss_pred:0.017282970249652863, decouple_loss:0.0010445020161569118
The modified gen p mean: 0.4501718282699585, gen p mean: -0.036758050322532654, mean p set: 0.4506521224975586The modified gen p mean: 0.4496780037879944, gen p mean: -0.034320950508117676, mean p set: 0.4501582682132721
loss_pred:0.017578691244125366, decouple_loss:0.0012546115322038531
loss_pred:0.017117733135819435, decouple_loss:0.0010841493494808674
Iteration: 125, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45143282413482666, gen p mean: -0.04516179859638214, mean p set: 0.45191308856010437
loss_pred:0.01740473508834839, decouple_loss:0.001264059217646718
The modified gen p mean: 0.44905751943588257, gen p mean: -0.0444624200463295, mean p set: 0.4495377540588379The modified gen p mean: 0.45149004459381104, gen p mean: -0.04256296902894974, mean p set: 0.45197030901908875
loss_pred:0.018034791573882103, decouple_loss:0.0012952957767993212
loss_pred:0.017042461782693863, decouple_loss:0.001341762370429933
Iteration: 126, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45244041085243225, gen p mean: -0.03632712364196777, mean p set: 0.45292070508003235
loss_pred:0.018698591738939285, decouple_loss:0.0011907643638551235
The modified gen p mean: 0.45017117261886597, gen p mean: -0.04020614176988602, mean p set: 0.4506514370441437The modified gen p mean: 0.4512278139591217, gen p mean: -0.04230042174458504, mean p set: 0.4517081081867218
loss_pred:0.01727738231420517, decouple_loss:0.0012904288014397025
loss_pred:0.018263857811689377, decouple_loss:0.0013961819931864738
Iteration: 127, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448230504989624, gen p mean: -0.0340539887547493, mean p set: 0.4487107992172241
loss_pred:0.017868831753730774, decouple_loss:0.001299185329116881
The modified gen p mean: 0.45089441537857056, gen p mean: -0.04119258001446724, mean p set: 0.45137470960617065The modified gen p mean: 0.4513542950153351, gen p mean: -0.03504827991127968, mean p set: 0.4518345892429352
loss_pred:0.01855381578207016, decouple_loss:0.001277493080124259
loss_pred:0.01754436455667019, decouple_loss:0.0012309636222198606
Iteration: 128, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45285534858703613, gen p mean: -0.0388738252222538, mean p set: 0.45333564281463623
loss_pred:0.016276180744171143, decouple_loss:0.0013026188826188445
The modified gen p mean: 0.4487243890762329, gen p mean: -0.033647678792476654, mean p set: 0.4492046535015106The modified gen p mean: 0.4497639238834381, gen p mean: -0.041851677000522614, mean p set: 0.4502442479133606
loss_pred:0.018144123256206512, decouple_loss:0.0013043168000876904
loss_pred:0.017666788771748543, decouple_loss:0.0013174227206036448
Iteration: 129, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486974775791168, gen p mean: -0.03883129730820656, mean p set: 0.4491777718067169
loss_pred:0.01731891557574272, decouple_loss:0.0011205701157450676
The modified gen p mean: 0.4526841342449188, gen p mean: -0.04230174049735069, mean p set: 0.4531644284725189The modified gen p mean: 0.4494902193546295, gen p mean: -0.03076021559536457, mean p set: 0.4499705135822296
loss_pred:0.01681336760520935, decouple_loss:0.001116508967243135
loss_pred:0.016917424276471138, decouple_loss:0.0010644322028383613
Iteration: 130, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507392644882202, gen p mean: -0.04145492613315582, mean p set: 0.4512195587158203
loss_pred:0.018318237736821175, decouple_loss:0.001331050880253315
The modified gen p mean: 0.45035213232040405, gen p mean: -0.04030212387442589, mean p set: 0.45083242654800415The modified gen p mean: 0.4500799775123596, gen p mean: -0.04364646598696709, mean p set: 0.45056024193763733
loss_pred:0.017295585945248604, decouple_loss:0.0011434287298470736
loss_pred:0.017805062234401703, decouple_loss:0.0012771018082275987
2023-04-30 22:48:16 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.050988148897886276, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04515927657485008, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.046222295612096786, mean p set: 0.4500633478164673
loss_pred:0.01839832216501236, decouple_loss:0.001080874353647232
loss_pred:0.01731814816594124, decouple_loss:0.001188442693091929
loss_pred:0.017424937337636948, decouple_loss:0.0011381573276594281
WV_0_PC_1_EH_0_PS_40, loss: 0.017770593985915184, avg_mse: 0.02548932656645775
current test mse: 0.025489
At step 130, Best test: 0.025489
save model to /work/09012/haoli1/ls6/ERA5_PredRNN/checkpoints/WV_0_PC_1_EH_0_PS_40/model_model_test_schedule_sampling_DynaMean.ckpt
Iteration: 131, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4524685740470886, gen p mean: -0.0449637733399868, mean p set: 0.4529488980770111
loss_pred:0.017363624647259712, decouple_loss:0.0011516365921124816
The modified gen p mean: 0.45249879360198975, gen p mean: -0.044613100588321686, mean p set: 0.45297905802726746The modified gen p mean: 0.44968530535697937, gen p mean: -0.04247131571173668, mean p set: 0.45016559958457947
loss_pred:0.018249444663524628, decouple_loss:0.0011216551065444946
loss_pred:0.01661195047199726, decouple_loss:0.0011073023779317737
Iteration: 132, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4515188932418823, gen p mean: -0.04687679931521416, mean p set: 0.4519991874694824
The modified gen p mean: 0.4496941566467285, gen p mean: -0.05396858975291252, mean p set: 0.4501744508743286
loss_pred:0.018434341996908188, decouple_loss:0.0012807016028091311
loss_pred:0.017114318907260895, decouple_loss:0.0011295214062556624
The modified gen p mean: 0.4501558542251587, gen p mean: -0.05323735624551773, mean p set: 0.4506361782550812
loss_pred:0.017685014754533768, decouple_loss:0.0011551760835573077
Iteration: 133, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503033757209778, gen p mean: -0.05025186389684677, mean p set: 0.4507836401462555
loss_pred:0.017781171947717667, decouple_loss:0.0010792869143188
The modified gen p mean: 0.45093390345573425, gen p mean: -0.05237964540719986, mean p set: 0.45141419768333435The modified gen p mean: 0.45324620604515076, gen p mean: -0.050934527069330215, mean p set: 0.45372650027275085
loss_pred:0.017863955348730087, decouple_loss:0.0011782421497628093
loss_pred:0.016093332320451736, decouple_loss:0.001126886811107397
Iteration: 134, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498998820781708, gen p mean: -0.052992891520261765, mean p set: 0.4503801465034485
loss_pred:0.017036793753504753, decouple_loss:0.0011416004272177815
The modified gen p mean: 0.44935181736946106, gen p mean: -0.04445932060480118, mean p set: 0.44983211159706116
The modified gen p mean: 0.4509352445602417, gen p mean: -0.0504426471889019, mean p set: 0.4514155387878418
loss_pred:0.017014112323522568, decouple_loss:0.0010985052213072777
loss_pred:0.0172230564057827, decouple_loss:0.001124767237342894
Iteration: 135, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483364522457123, gen p mean: -0.0449712909758091, mean p set: 0.44881677627563477
loss_pred:0.017635462805628777, decouple_loss:0.0010485723614692688
The modified gen p mean: 0.4508529305458069, gen p mean: -0.04645094275474548, mean p set: 0.451333224773407The modified gen p mean: 0.4512171447277069, gen p mean: -0.046000611037015915, mean p set: 0.451697438955307
loss_pred:0.01689145155251026, decouple_loss:0.0010450076078996062
loss_pred:0.018217673525214195, decouple_loss:0.0010096918558701873
Iteration: 136, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4518306851387024, gen p mean: -0.04901778697967529, mean p set: 0.4523109793663025
loss_pred:0.018004026263952255, decouple_loss:0.0012186722597107291
The modified gen p mean: 0.44978851079940796, gen p mean: -0.04693526402115822, mean p set: 0.45026880502700806The modified gen p mean: 0.4513773024082184, gen p mean: -0.04173636808991432, mean p set: 0.4518575668334961
loss_pred:0.01805027760565281, decouple_loss:0.0011315925512462854
loss_pred:0.017325472086668015, decouple_loss:0.001055584172718227
Iteration: 137, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45195168256759644, gen p mean: -0.040930818766355515, mean p set: 0.45243194699287415
loss_pred:0.018147936090826988, decouple_loss:0.0010381785687059164
The modified gen p mean: 0.4508698880672455, gen p mean: -0.037416309118270874, mean p set: 0.4513501822948456The modified gen p mean: 0.4502318203449249, gen p mean: -0.038126714527606964, mean p set: 0.4507121443748474
loss_pred:0.017710981890559196, decouple_loss:0.001041795127093792
loss_pred:0.016972912475466728, decouple_loss:0.0009746425203047693
Iteration: 138, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45074793696403503, gen p mean: -0.03867000713944435, mean p set: 0.45122823119163513
loss_pred:0.018556449562311172, decouple_loss:0.0011919632088392973
The modified gen p mean: 0.4517655074596405, gen p mean: -0.03693899139761925, mean p set: 0.4522458016872406The modified gen p mean: 0.44927510619163513, gen p mean: -0.03703141212463379, mean p set: 0.4497554302215576
loss_pred:0.017101937904953957, decouple_loss:0.0011777582112699747
loss_pred:0.018463656306266785, decouple_loss:0.0011127025354653597
Iteration: 139, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44956615567207336, gen p mean: -0.042190998792648315, mean p set: 0.4500464200973511
loss_pred:0.01677875593304634, decouple_loss:0.001086678123101592
The modified gen p mean: 0.4514182209968567, gen p mean: -0.042584776878356934, mean p set: 0.4518985152244568The modified gen p mean: 0.45174968242645264, gen p mean: -0.03836698457598686, mean p set: 0.45222997665405273
loss_pred:0.017144888639450073, decouple_loss:0.001010397681966424
loss_pred:0.01776105724275112, decouple_loss:0.001059360452927649
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012009_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012009_3_24hr.npz
NaN value num: 0
Iteration: 140, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44856974482536316, gen p mean: -0.032976727932691574, mean p set: 0.44905006885528564
loss_pred:0.0181720107793808, decouple_loss:0.0010615936480462551
The modified gen p mean: 0.447566956281662, gen p mean: -0.03815414756536484, mean p set: 0.4480472505092621The modified gen p mean: 0.44650036096572876, gen p mean: -0.03642470762133598, mean p set: 0.44698062539100647
loss_pred:0.018100114539265633, decouple_loss:0.0015512079698964953
loss_pred:0.01899075135588646, decouple_loss:0.0012932226527482271
2023-04-30 22:50:59 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.042018357664346695, mean p set: 0.4502691626548767
The modified gen p mean: 0.4498766362667084, gen p mean: -0.03633785992860794, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.0374504029750824, mean p set: 0.4500633478164673
loss_pred:0.01834936812520027, decouple_loss:0.001118602231144905
loss_pred:0.01730342209339142, decouple_loss:0.001062475610524416
loss_pred:0.017383357509970665, decouple_loss:0.001138774212449789
WV_0_PC_1_EH_0_PS_40, loss: 0.017734047025442123, avg_mse: 0.02543455734848976
current test mse: 0.025435
At step 140, Best test: 0.025435
save model to /work/09012/haoli1/ls6/ERA5_PredRNN/checkpoints/WV_0_PC_1_EH_0_PS_40/model_model_test_schedule_sampling_DynaMean.ckpt
Iteration: 141, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4457154870033264, gen p mean: -0.03509509190917015, mean p set: 0.4461957514286041
loss_pred:0.01817493326961994, decouple_loss:0.0010707498295232654
The modified gen p mean: 0.4475644528865814, gen p mean: -0.036612674593925476, mean p set: 0.4480447769165039The modified gen p mean: 0.44656434655189514, gen p mean: -0.03991038352251053, mean p set: 0.44704464077949524
loss_pred:0.01778588816523552, decouple_loss:0.0012081507593393326
loss_pred:0.018315838649868965, decouple_loss:0.0010080925421789289
Iteration: 142, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479660093784332, gen p mean: -0.0375344455242157, mean p set: 0.44844627380371094
The modified gen p mean: 0.4494776129722595, gen p mean: -0.04107994958758354, mean p set: 0.449957937002182
loss_pred:0.018430864438414574, decouple_loss:0.0012623668881133199
loss_pred:0.01738245040178299, decouple_loss:0.0012013205559924245
The modified gen p mean: 0.44664105772972107, gen p mean: -0.03924524039030075, mean p set: 0.44712138175964355
loss_pred:0.018606586381793022, decouple_loss:0.0012645249953493476
Iteration: 143, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44762352108955383, gen p mean: -0.04159500077366829, mean p set: 0.44810381531715393
loss_pred:0.018810410052537918, decouple_loss:0.0010513161541894078
The modified gen p mean: 0.44708743691444397, gen p mean: -0.04094067960977554, mean p set: 0.44756776094436646The modified gen p mean: 0.4485849440097809, gen p mean: -0.04532232508063316, mean p set: 0.449065238237381
loss_pred:0.01816808059811592, decouple_loss:0.0009478962165303528
loss_pred:0.018223753198981285, decouple_loss:0.0010741945588961244
Iteration: 144, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44800689816474915, gen p mean: -0.038060467690229416, mean p set: 0.44848722219467163
loss_pred:0.01791815273463726, decouple_loss:0.0011532303178682923
The modified gen p mean: 0.44640523195266724, gen p mean: -0.03901764005422592, mean p set: 0.44688549637794495The modified gen p mean: 0.4472668468952179, gen p mean: -0.047186318784952164, mean p set: 0.447747141122818
loss_pred:0.019483331590890884, decouple_loss:0.0011864631669595838
loss_pred:0.01832559145987034, decouple_loss:0.0012829722836613655
Iteration: 145, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44692349433898926, gen p mean: -0.04540545865893364, mean p set: 0.44740378856658936
loss_pred:0.018313268199563026, decouple_loss:0.0009500918095000088
The modified gen p mean: 0.45010480284690857, gen p mean: -0.04611634090542793, mean p set: 0.45058512687683105The modified gen p mean: 0.44805100560188293, gen p mean: -0.039678364992141724, mean p set: 0.4485313296318054
loss_pred:0.01776733063161373, decouple_loss:0.0009321123943664134
loss_pred:0.018205691128969193, decouple_loss:0.0009155409643426538
Iteration: 146, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471374452114105, gen p mean: -0.04533860832452774, mean p set: 0.4476177394390106
loss_pred:0.017843443900346756, decouple_loss:0.0011612949892878532
The modified gen p mean: 0.4484080970287323, gen p mean: -0.047539860010147095, mean p set: 0.4488883912563324The modified gen p mean: 0.4482971429824829, gen p mean: -0.045702602714300156, mean p set: 0.4487774670124054
loss_pred:0.01835634931921959, decouple_loss:0.0011054875794798136
loss_pred:0.017422154545783997, decouple_loss:0.0012111155083402991
Iteration: 147, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472569227218628, gen p mean: -0.0480801984667778, mean p set: 0.4477372169494629
loss_pred:0.01846284791827202, decouple_loss:0.0009510780218988657
The modified gen p mean: 0.44678249955177307, gen p mean: -0.045486412942409515, mean p set: 0.44726279377937317The modified gen p mean: 0.4476662278175354, gen p mean: -0.04468086361885071, mean p set: 0.4481465220451355
loss_pred:0.01793939806520939, decouple_loss:0.0009440475841984153
loss_pred:0.018755583092570305, decouple_loss:0.0010053791338577867
Iteration: 148, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44672462344169617, gen p mean: -0.04710772633552551, mean p set: 0.44720491766929626
loss_pred:0.018642129376530647, decouple_loss:0.0011483367998152971
The modified gen p mean: 0.4491763710975647, gen p mean: -0.050019945949316025, mean p set: 0.4496566355228424The modified gen p mean: 0.4460969567298889, gen p mean: -0.043788693845272064, mean p set: 0.446577250957489
loss_pred:0.01773427240550518, decouple_loss:0.0011264883214607835
loss_pred:0.018359050154685974, decouple_loss:0.0011397141497582197
Iteration: 149, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488506019115448, gen p mean: -0.049788881093263626, mean p set: 0.4493309259414673
loss_pred:0.01826559752225876, decouple_loss:0.0012415199307724833
The modified gen p mean: 0.4486321806907654, gen p mean: -0.04832620546221733, mean p set: 0.4491124749183655The modified gen p mean: 0.4465142488479614, gen p mean: -0.04520438611507416, mean p set: 0.4469945430755615
loss_pred:0.018041176721453667, decouple_loss:0.001043202355504036
loss_pred:0.018219074234366417, decouple_loss:0.0010702109429985285
Iteration: 150, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44769006967544556, gen p mean: -0.046164385974407196, mean p set: 0.44817039370536804
loss_pred:0.017824219539761543, decouple_loss:0.0010771325323730707
The modified gen p mean: 0.4470927119255066, gen p mean: -0.04693764075636864, mean p set: 0.4475730061531067The modified gen p mean: 0.4465080201625824, gen p mean: -0.046284597367048264, mean p set: 0.4469883143901825
loss_pred:0.017997927963733673, decouple_loss:0.0008841784438118339
loss_pred:0.018023936077952385, decouple_loss:0.0009076503338292241
2023-04-30 22:52:57 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.04988276585936546, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04394196718931198, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.044999998062849045, mean p set: 0.4500633478164673
loss_pred:0.018357472494244576, decouple_loss:0.0011292649433016777
loss_pred:0.01731395721435547, decouple_loss:0.0011885499116033316
loss_pred:0.01742616482079029, decouple_loss:0.0011451708851382136
WV_0_PC_1_EH_0_PS_40, loss: 0.017756914719939232, avg_mse: 0.025474335998296738
current test mse: 0.025474
Iteration: 151, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481431543827057, gen p mean: -0.04351796209812164, mean p set: 0.4486234486103058
The modified gen p mean: 0.4475695490837097, gen p mean: -0.04604183882474899, mean p set: 0.4480498135089874
The modified gen p mean: 0.4468706250190735, gen p mean: -0.04131194204092026, mean p set: 0.4473509192466736
loss_pred:0.018745122477412224, decouple_loss:0.0011189291253685951
loss_pred:0.01819651387631893, decouple_loss:0.0012037056731060147loss_pred:0.018703995272517204, decouple_loss:0.001095660263672471
Iteration: 152, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44732263684272766, gen p mean: -0.049555473029613495, mean p set: 0.44780290126800537
loss_pred:0.018528195098042488, decouple_loss:0.0010236669331789017
The modified gen p mean: 0.4473632276058197, gen p mean: -0.04721676930785179, mean p set: 0.4478435218334198The modified gen p mean: 0.44708481431007385, gen p mean: -0.049958765506744385, mean p set: 0.44756510853767395
loss_pred:0.017650892958045006, decouple_loss:0.0011037943186238408
loss_pred:0.01851636730134487, decouple_loss:0.0012087677605450153
Iteration: 153, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4462997615337372, gen p mean: -0.04571015015244484, mean p set: 0.4467800557613373
loss_pred:0.018452994525432587, decouple_loss:0.0010371538810431957
The modified gen p mean: 0.44580337405204773, gen p mean: -0.0427226796746254, mean p set: 0.44628363847732544
The modified gen p mean: 0.44786548614501953, gen p mean: -0.04165906086564064, mean p set: 0.44834578037261963
loss_pred:0.018196677789092064, decouple_loss:0.0009797281818464398
loss_pred:0.017879974097013474, decouple_loss:0.0009191291173920035
Iteration: 154, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474189877510071, gen p mean: -0.046199820935726166, mean p set: 0.44789931178092957
loss_pred:0.017788942903280258, decouple_loss:0.0010198644595220685
The modified gen p mean: 0.447181761264801, gen p mean: -0.04148247092962265, mean p set: 0.4476620852947235The modified gen p mean: 0.4482744634151459, gen p mean: -0.04285900667309761, mean p set: 0.44875475764274597
loss_pred:0.01811215467751026, decouple_loss:0.0010659841354936361
loss_pred:0.01807737536728382, decouple_loss:0.0009962540352717042
Iteration: 155, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44842782616615295, gen p mean: -0.047241393476724625, mean p set: 0.44890812039375305
loss_pred:0.01765800081193447, decouple_loss:0.000975998817011714
The modified gen p mean: 0.44688671827316284, gen p mean: -0.045506127178668976, mean p set: 0.44736701250076294The modified gen p mean: 0.4469072222709656, gen p mean: -0.04422881081700325, mean p set: 0.4473875164985657
loss_pred:0.01853906735777855, decouple_loss:0.0009294059127569199
loss_pred:0.018654968589544296, decouple_loss:0.0010219746036455035
Iteration: 156, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474196434020996, gen p mean: -0.04790445417165756, mean p set: 0.4478999078273773
loss_pred:0.018827885389328003, decouple_loss:0.00095929711824283
The modified gen p mean: 0.44811922311782837, gen p mean: -0.05333283543586731, mean p set: 0.4485994875431061The modified gen p mean: 0.4477560818195343, gen p mean: -0.05064915865659714, mean p set: 0.4482364058494568
loss_pred:0.018011141568422318, decouple_loss:0.0009721034439280629
loss_pred:0.017588667571544647, decouple_loss:0.0009442951995879412
Iteration: 157, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44676363468170166, gen p mean: -0.04852836951613426, mean p set: 0.44724392890930176
loss_pred:0.018323563039302826, decouple_loss:0.001020653173327446
The modified gen p mean: 0.44652819633483887, gen p mean: -0.04848799109458923, mean p set: 0.44700849056243896The modified gen p mean: 0.4470256268978119, gen p mean: -0.0483735091984272, mean p set: 0.4475059509277344
loss_pred:0.018619924783706665, decouple_loss:0.0009723422699607909
loss_pred:0.018328508362174034, decouple_loss:0.0009913290850818157
Iteration: 158, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44686856865882874, gen p mean: -0.049286581575870514, mean p set: 0.44734886288642883
loss_pred:0.01781250536441803, decouple_loss:0.0009694334003143013
The modified gen p mean: 0.4474089741706848, gen p mean: -0.04782888665795326, mean p set: 0.4478892683982849The modified gen p mean: 0.44661030173301697, gen p mean: -0.05100421980023384, mean p set: 0.4470905661582947
loss_pred:0.017694061622023582, decouple_loss:0.0009767195442691445
loss_pred:0.018527723848819733, decouple_loss:0.000957290583755821
Iteration: 159, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492040276527405, gen p mean: -0.054721321910619736, mean p set: 0.4496842920780182
loss_pred:0.017246950417757034, decouple_loss:0.0011059264652431011
The modified gen p mean: 0.44827577471733093, gen p mean: -0.047360945492982864, mean p set: 0.44875606894493103The modified gen p mean: 0.44779494404792786, gen p mean: -0.052975717931985855, mean p set: 0.44827520847320557
loss_pred:0.017605291679501534, decouple_loss:0.0010790082160383463
loss_pred:0.018312405794858932, decouple_loss:0.0010390154784545302
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012016_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012016_3_24hr.npz
NaN value num: 0
Iteration: 160, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514394998550415, gen p mean: -0.04345490410923958, mean p set: 0.4519197940826416
loss_pred:0.017388569191098213, decouple_loss:0.001529067987576127
The modified gen p mean: 0.4507308900356293, gen p mean: -0.03962237015366554, mean p set: 0.45121118426322937The modified gen p mean: 0.45270445942878723, gen p mean: -0.049804799258708954, mean p set: 0.45318475365638733
loss_pred:0.01757160946726799, decouple_loss:0.001662567025050521
loss_pred:0.016283348202705383, decouple_loss:0.0012378451647236943
2023-04-30 22:55:29 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.05480591580271721, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.048914000391960144, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830237865448, gen p mean: -0.04962347075343132, mean p set: 0.4500633478164673
loss_pred:0.01839124597609043, decouple_loss:0.0011379159986972809
loss_pred:0.017351360991597176, decouple_loss:0.0010214492212980986
loss_pred:0.017491629347205162, decouple_loss:0.0010175713105127215
WV_0_PC_1_EH_0_PS_40, loss: 0.017797695472836494, avg_mse: 0.025555767118930817
current test mse: 0.025556
Iteration: 161, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45161208510398865, gen p mean: -0.04621201753616333, mean p set: 0.45209240913391113
The modified gen p mean: 0.4512234926223755, gen p mean: -0.04816814512014389, mean p set: 0.4517037868499756
The modified gen p mean: 0.45021769404411316, gen p mean: -0.04825662076473236, mean p set: 0.45069798827171326
loss_pred:0.016197221353650093, decouple_loss:0.001188368652947247
loss_pred:0.016963547095656395, decouple_loss:0.001092060119844973
loss_pred:0.017864307388663292, decouple_loss:0.0011135612148791552
Iteration: 162, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4512425363063812, gen p mean: -0.05101640895009041, mean p set: 0.4517228305339813
loss_pred:0.01763499714434147, decouple_loss:0.0013617490185424685
The modified gen p mean: 0.45201635360717773, gen p mean: -0.041711967438459396, mean p set: 0.4524966776371002The modified gen p mean: 0.4532906711101532, gen p mean: -0.04711207374930382, mean p set: 0.4537709653377533
loss_pred:0.017879502847790718, decouple_loss:0.0011985069140791893
loss_pred:0.017021657899022102, decouple_loss:0.0013681937707588077
Iteration: 163, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45079344511032104, gen p mean: -0.04572697728872299, mean p set: 0.45127376914024353
loss_pred:0.017875254154205322, decouple_loss:0.001132083940319717
The modified gen p mean: 0.4511788487434387, gen p mean: -0.05304032936692238, mean p set: 0.4516591429710388The modified gen p mean: 0.4506503641605377, gen p mean: -0.048149462789297104, mean p set: 0.4511306881904602
loss_pred:0.01654297672212124, decouple_loss:0.0011323867365717888
loss_pred:0.016564423218369484, decouple_loss:0.0011761304922401905
Iteration: 164, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505658447742462, gen p mean: -0.04518450051546097, mean p set: 0.4510461390018463
loss_pred:0.017901061102747917, decouple_loss:0.0012687024427577853
The modified gen p mean: 0.450717568397522, gen p mean: -0.037302415817976, mean p set: 0.45119786262512207The modified gen p mean: 0.45117104053497314, gen p mean: -0.04561813175678253, mean p set: 0.45165136456489563
loss_pred:0.017072945833206177, decouple_loss:0.0014339810004457831
loss_pred:0.01662047952413559, decouple_loss:0.0011953613720834255
Iteration: 165, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45226389169692993, gen p mean: -0.04329729825258255, mean p set: 0.45274418592453003
loss_pred:0.01609838753938675, decouple_loss:0.0013047200627624989
The modified gen p mean: 0.45021459460258484, gen p mean: -0.04232209548354149, mean p set: 0.4506949186325073The modified gen p mean: 0.4522475302219391, gen p mean: -0.03926974907517433, mean p set: 0.4527277946472168
loss_pred:0.017529228702187538, decouple_loss:0.0012341459514573216
loss_pred:0.01752837747335434, decouple_loss:0.0013646602164953947
Iteration: 166, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45206692814826965, gen p mean: -0.04450126364827156, mean p set: 0.45254722237586975
loss_pred:0.016287028789520264, decouple_loss:0.00122164492495358
The modified gen p mean: 0.45070749521255493, gen p mean: -0.04905172809958458, mean p set: 0.45118778944015503The modified gen p mean: 0.45156580209732056, gen p mean: -0.046357959508895874, mean p set: 0.45204612612724304
loss_pred:0.016833066940307617, decouple_loss:0.001218873425386846
loss_pred:0.016255948692560196, decouple_loss:0.0012867518234997988
Iteration: 167, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45174503326416016, gen p mean: -0.0419972725212574, mean p set: 0.45222529768943787
loss_pred:0.017407672479748726, decouple_loss:0.001271223765797913
The modified gen p mean: 0.4511440396308899, gen p mean: -0.045893263071775436, mean p set: 0.45162433385849The modified gen p mean: 0.4513789713382721, gen p mean: -0.040874022990465164, mean p set: 0.4518592655658722
loss_pred:0.017485536634922028, decouple_loss:0.0013487121323123574
loss_pred:0.017738839611411095, decouple_loss:0.0011445599375292659
Iteration: 168, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4522682726383209, gen p mean: -0.04586562514305115, mean p set: 0.4527485966682434
loss_pred:0.016861671581864357, decouple_loss:0.001073360093869269
The modified gen p mean: 0.45327654480934143, gen p mean: -0.049661699682474136, mean p set: 0.4537568688392639The modified gen p mean: 0.4514380693435669, gen p mean: -0.05208209156990051, mean p set: 0.451918363571167
loss_pred:0.016274627298116684, decouple_loss:0.001114333514124155
loss_pred:0.016108017414808273, decouple_loss:0.0010967920534312725
Iteration: 169, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514700770378113, gen p mean: -0.04685215651988983, mean p set: 0.45195040106773376
loss_pred:0.01606850139796734, decouple_loss:0.001484358566813171
The modified gen p mean: 0.45112621784210205, gen p mean: -0.04468894749879837, mean p set: 0.45160651206970215The modified gen p mean: 0.44989460706710815, gen p mean: -0.04811909794807434, mean p set: 0.45037490129470825
loss_pred:0.017431816086173058, decouple_loss:0.001330972765572369
loss_pred:0.0171358585357666, decouple_loss:0.0013310941867530346
Iteration: 170, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4510784447193146, gen p mean: -0.04572566971182823, mean p set: 0.4515587389469147
loss_pred:0.016983751207590103, decouple_loss:0.0011782343499362469
The modified gen p mean: 0.45016083121299744, gen p mean: -0.045354213565588, mean p set: 0.45064112544059753The modified gen p mean: 0.4505062401294708, gen p mean: -0.04825441166758537, mean p set: 0.45098650455474854
loss_pred:0.01742510125041008, decouple_loss:0.0011490995530039072
loss_pred:0.015771716833114624, decouple_loss:0.0011754361912608147
2023-04-30 22:57:23 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.057098425924777985, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.051858723163604736, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830237865448, gen p mean: -0.052267104387283325, mean p set: 0.4500633478164673
loss_pred:0.01861449144780636, decouple_loss:0.0017095421208068728
loss_pred:0.017452053725719452, decouple_loss:0.001545400358736515
loss_pred:0.01772562973201275, decouple_loss:0.0014570519560948014
WV_0_PC_1_EH_0_PS_40, loss: 0.018009258434176445, avg_mse: 0.025877682492136955
current test mse: 0.025878
Iteration: 171, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45178744196891785, gen p mean: -0.04929552972316742, mean p set: 0.45226770639419556
The modified gen p mean: 0.45178964734077454, gen p mean: -0.05117112398147583, mean p set: 0.45226994156837463
The modified gen p mean: 0.45079416036605835, gen p mean: -0.05385651811957359, mean p set: 0.45127442479133606
loss_pred:0.017764974385499954, decouple_loss:0.0011481866240501404
loss_pred:0.016269102692604065, decouple_loss:0.0013035744195804loss_pred:0.01579398103058338, decouple_loss:0.0013014496071264148
Iteration: 172, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45160067081451416, gen p mean: -0.0457439161837101, mean p set: 0.45208099484443665
loss_pred:0.016649320721626282, decouple_loss:0.0012848640326410532
The modified gen p mean: 0.4516028165817261, gen p mean: -0.0427100732922554, mean p set: 0.4520830810070038The modified gen p mean: 0.45239225029945374, gen p mean: -0.049587786197662354, mean p set: 0.45287254452705383
loss_pred:0.016901319846510887, decouple_loss:0.0012814471265301108
loss_pred:0.01680297777056694, decouple_loss:0.001271658344194293
Iteration: 173, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511578679084778, gen p mean: -0.0449289008975029, mean p set: 0.4516381621360779
loss_pred:0.017062131315469742, decouple_loss:0.0012731909519061446
The modified gen p mean: 0.4538593888282776, gen p mean: -0.05012282356619835, mean p set: 0.4543396830558777The modified gen p mean: 0.4539720416069031, gen p mean: -0.05049823969602585, mean p set: 0.45445236563682556
loss_pred:0.016626626253128052, decouple_loss:0.0013538976199924946
loss_pred:0.016746466979384422, decouple_loss:0.0012889455538243055
Iteration: 174, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514194428920746, gen p mean: -0.04410722851753235, mean p set: 0.4518997073173523
loss_pred:0.01763235218822956, decouple_loss:0.0011724194046109915
The modified gen p mean: 0.45145928859710693, gen p mean: -0.04814615100622177, mean p set: 0.45193958282470703The modified gen p mean: 0.4525368809700012, gen p mean: -0.04764024540781975, mean p set: 0.45301714539527893
loss_pred:0.016247564926743507, decouple_loss:0.0011751389829441905
loss_pred:0.016939397901296616, decouple_loss:0.001156665850430727
Iteration: 175, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4532153904438019, gen p mean: -0.04510405659675598, mean p set: 0.453695684671402
loss_pred:0.01608647219836712, decouple_loss:0.001349340658634901
The modified gen p mean: 0.45226433873176575, gen p mean: -0.045483533293008804, mean p set: 0.45274466276168823The modified gen p mean: 0.45111456513404846, gen p mean: -0.049287691712379456, mean p set: 0.45159485936164856
loss_pred:0.01578608714044094, decouple_loss:0.0012762048281729221
loss_pred:0.01715996488928795, decouple_loss:0.0014640563167631626
Iteration: 176, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.452044278383255, gen p mean: -0.048210933804512024, mean p set: 0.4525245428085327
loss_pred:0.015725504606962204, decouple_loss:0.0011998489499092102
The modified gen p mean: 0.4519716203212738, gen p mean: -0.04475593566894531, mean p set: 0.4524519443511963The modified gen p mean: 0.452554315328598, gen p mean: -0.05417652800679207, mean p set: 0.4530346095561981
loss_pred:0.01595332846045494, decouple_loss:0.0010638104286044836
loss_pred:0.01805040054023266, decouple_loss:0.0011514544021338224
Iteration: 177, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4506746828556061, gen p mean: -0.043974488973617554, mean p set: 0.4511549472808838
The modified gen p mean: 0.45175787806510925, gen p mean: -0.04999518766999245, mean p set: 0.45223820209503174
loss_pred:0.017355289310216904, decouple_loss:0.0013486244715750217
loss_pred:0.016660379245877266, decouple_loss:0.001119751250371337
The modified gen p mean: 0.45154112577438354, gen p mean: -0.0448141023516655, mean p set: 0.45202142000198364
loss_pred:0.01703687384724617, decouple_loss:0.0013393429107964039
Iteration: 178, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4534396529197693, gen p mean: -0.04963398352265358, mean p set: 0.4539199471473694
loss_pred:0.01577720232307911, decouple_loss:0.0010895811719819903
The modified gen p mean: 0.45244091749191284, gen p mean: -0.038218483328819275, mean p set: 0.45292118191719055The modified gen p mean: 0.4513148069381714, gen p mean: -0.04251888394355774, mean p set: 0.4517951011657715
loss_pred:0.016998600214719772, decouple_loss:0.001174217090010643
loss_pred:0.017252188175916672, decouple_loss:0.0011964505538344383
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012007_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012007_3_24hr.npz
NaN value num: 0
Iteration: 179, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44588345289230347, gen p mean: -0.05073684826493263, mean p set: 0.44636374711990356
loss_pred:0.013976099900901318, decouple_loss:0.0013816235587000847
The modified gen p mean: 0.4492429792881012, gen p mean: -0.052740518003702164, mean p set: 0.4497232735157013The modified gen p mean: 0.446414589881897, gen p mean: -0.05485254526138306, mean p set: 0.4468948543071747
loss_pred:0.013836835511028767, decouple_loss:0.0016354855615645647
loss_pred:0.01370903942734003, decouple_loss:0.001362169743515551
Iteration: 180, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44795140624046326, gen p mean: -0.04895292967557907, mean p set: 0.44843170046806335
loss_pred:0.013736698776483536, decouple_loss:0.001638710731640458
The modified gen p mean: 0.4495560824871063, gen p mean: -0.049508802592754364, mean p set: 0.4500364065170288The modified gen p mean: 0.4479919672012329, gen p mean: -0.05035228282213211, mean p set: 0.448472261428833
loss_pred:0.013755504973232746, decouple_loss:0.0015976732829585671
loss_pred:0.013649972155690193, decouple_loss:0.001602337695658207
2023-04-30 22:59:58 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.050455790013074875, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.044811349362134933, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04526128992438316, mean p set: 0.4500633478164673
loss_pred:0.0187668576836586, decouple_loss:0.0012201033532619476
loss_pred:0.017623234540224075, decouple_loss:0.001271084533073008
loss_pred:0.017863595858216286, decouple_loss:0.0012369900941848755
WV_0_PC_1_EH_0_PS_40, loss: 0.0181466992944479, avg_mse: 0.026220252737402916
current test mse: 0.02622
Iteration: 181, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469155967235565, gen p mean: -0.049039311707019806, mean p set: 0.4473958909511566
The modified gen p mean: 0.4480734169483185, gen p mean: -0.04489736258983612, mean p set: 0.4485537111759186
The modified gen p mean: 0.44771867990493774, gen p mean: -0.04879244789481163, mean p set: 0.44819900393486023
loss_pred:0.01381551194936037, decouple_loss:0.001212865812703967
loss_pred:0.013945764862000942, decouple_loss:0.001242645550519228loss_pred:0.014744721353054047, decouple_loss:0.001348606077954173
Iteration: 182, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477676451206207, gen p mean: -0.046834371984004974, mean p set: 0.4482479691505432
loss_pred:0.013982146978378296, decouple_loss:0.0014015600318089128
The modified gen p mean: 0.4485396146774292, gen p mean: -0.04434977099299431, mean p set: 0.4490198791027069
The modified gen p mean: 0.4491856098175049, gen p mean: -0.044222332537174225, mean p set: 0.449665904045105
loss_pred:0.013109703548252583, decouple_loss:0.0014161679428070784
loss_pred:0.014214882627129555, decouple_loss:0.001484458683989942
Iteration: 183, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44904136657714844, gen p mean: -0.04222945123910904, mean p set: 0.44952166080474854
loss_pred:0.013255462981760502, decouple_loss:0.001444504247047007
The modified gen p mean: 0.44707077741622925, gen p mean: -0.040822822600603104, mean p set: 0.44755110144615173The modified gen p mean: 0.448035329580307, gen p mean: -0.039617717266082764, mean p set: 0.4485156238079071
loss_pred:0.013885747641324997, decouple_loss:0.0013714644592255354
loss_pred:0.013038566336035728, decouple_loss:0.0014274585992097855
Iteration: 184, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489194452762604, gen p mean: -0.03956098482012749, mean p set: 0.44939976930618286
loss_pred:0.013473883271217346, decouple_loss:0.001411989564076066
The modified gen p mean: 0.44700509309768677, gen p mean: -0.04281838238239288, mean p set: 0.4474853575229645The modified gen p mean: 0.44702863693237305, gen p mean: -0.04328160360455513, mean p set: 0.44750893115997314
loss_pred:0.013107053004205227, decouple_loss:0.0012890795478597283
loss_pred:0.01318376138806343, decouple_loss:0.0013012603158131242
Iteration: 185, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468555450439453, gen p mean: -0.040568169206380844, mean p set: 0.4473358392715454
loss_pred:0.013300105929374695, decouple_loss:0.001350373262539506
The modified gen p mean: 0.4468880295753479, gen p mean: -0.038857072591781616, mean p set: 0.447368323802948The modified gen p mean: 0.4482189118862152, gen p mean: -0.03672974929213524, mean p set: 0.4486992359161377
loss_pred:0.013455160893499851, decouple_loss:0.0014084219001233578
loss_pred:0.013642871752381325, decouple_loss:0.001423779409378767
Iteration: 186, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482479691505432, gen p mean: -0.038733553141355515, mean p set: 0.4487282633781433
loss_pred:0.013552740216255188, decouple_loss:0.0013836693251505494
The modified gen p mean: 0.4482154846191406, gen p mean: -0.03866921365261078, mean p set: 0.44869574904441833The modified gen p mean: 0.4483628273010254, gen p mean: -0.039915621280670166, mean p set: 0.4488431215286255
loss_pred:0.013032512739300728, decouple_loss:0.001380281406454742
loss_pred:0.013545402325689793, decouple_loss:0.0013581652892753482
Iteration: 187, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466298222541809, gen p mean: -0.038401730358600616, mean p set: 0.447110116481781
loss_pred:0.01376519538462162, decouple_loss:0.0012524980120360851
The modified gen p mean: 0.4475352168083191, gen p mean: -0.03763263300061226, mean p set: 0.4480155408382416The modified gen p mean: 0.4461434781551361, gen p mean: -0.04038381949067116, mean p set: 0.4466237425804138
loss_pred:0.014373642392456532, decouple_loss:0.001354999840259552
loss_pred:0.012997434474527836, decouple_loss:0.0012953378027305007
Iteration: 188, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44793441891670227, gen p mean: -0.036384616047143936, mean p set: 0.44841471314430237
loss_pred:0.013601476326584816, decouple_loss:0.0014323353534564376
The modified gen p mean: 0.4468289911746979, gen p mean: -0.04371533542871475, mean p set: 0.447309285402298The modified gen p mean: 0.4500880241394043, gen p mean: -0.03916553035378456, mean p set: 0.4505683481693268
loss_pred:0.012757714837789536, decouple_loss:0.001296668197028339
loss_pred:0.01283150352537632, decouple_loss:0.0012500532902777195
Iteration: 189, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476286470890045, gen p mean: -0.03618452697992325, mean p set: 0.4481089115142822
loss_pred:0.013762171380221844, decouple_loss:0.0013890113914385438
The modified gen p mean: 0.4476761221885681, gen p mean: -0.036202214658260345, mean p set: 0.4481564164161682The modified gen p mean: 0.44970178604125977, gen p mean: -0.04015706479549408, mean p set: 0.45018208026885986
loss_pred:0.013158855959773064, decouple_loss:0.0012565176002681255
loss_pred:0.012369521893560886, decouple_loss:0.0011947532184422016
Iteration: 190, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44856446981430054, gen p mean: -0.041641488671302795, mean p set: 0.44904476404190063
loss_pred:0.013423323631286621, decouple_loss:0.0014794457238167524
The modified gen p mean: 0.4472527801990509, gen p mean: -0.03914770111441612, mean p set: 0.4477330446243286The modified gen p mean: 0.44881510734558105, gen p mean: -0.03795792534947395, mean p set: 0.44929543137550354
loss_pred:0.013117141090333462, decouple_loss:0.0012846876634284854
loss_pred:0.013132933527231216, decouple_loss:0.0012877050321549177
2023-04-30 23:01:52 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.04236879572272301, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.036890193819999695, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.0375906303524971, mean p set: 0.4500633478164673
loss_pred:0.019294463098049164, decouple_loss:0.0013364906189963222
loss_pred:0.01812121272087097, decouple_loss:0.0014135559322312474
loss_pred:0.018281998112797737, decouple_loss:0.0013560991501435637
WV_0_PC_1_EH_0_PS_40, loss: 0.01863432675600052, avg_mse: 0.027157124131917953
current test mse: 0.027157
Iteration: 191, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475768506526947, gen p mean: -0.04427897557616234, mean p set: 0.4480571746826172
The modified gen p mean: 0.44784075021743774, gen p mean: -0.04011740908026695, mean p set: 0.44832107424736023
The modified gen p mean: 0.44832944869995117, gen p mean: -0.03853654861450195, mean p set: 0.4488097131252289
loss_pred:0.013360847719013691, decouple_loss:0.0013426498044282198
loss_pred:0.013147640973329544, decouple_loss:0.0013158887159079313
loss_pred:0.01385219395160675, decouple_loss:0.001307808794081211
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 192, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477846324443817, gen p mean: -0.04123415797948837, mean p set: 0.4482649564743042
loss_pred:0.013109222054481506, decouple_loss:0.001211998169310391
The modified gen p mean: 0.44852301478385925, gen p mean: -0.03924053534865379, mean p set: 0.44900330901145935The modified gen p mean: 0.45016229152679443, gen p mean: -0.04218662902712822, mean p set: 0.4506426155567169
loss_pred:0.012662823311984539, decouple_loss:0.0014633822720497847
loss_pred:0.012765252031385899, decouple_loss:0.0012567926896736026
Iteration: 193, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447710245847702, gen p mean: -0.03914785385131836, mean p set: 0.4481905400753021
loss_pred:0.013165069743990898, decouple_loss:0.0012506454950198531
The modified gen p mean: 0.4474222660064697, gen p mean: -0.04690088331699371, mean p set: 0.4479025602340698The modified gen p mean: 0.44678202271461487, gen p mean: -0.038285281509160995, mean p set: 0.44726231694221497
loss_pred:0.013864047825336456, decouple_loss:0.0012785318540409207
loss_pred:0.012787607498466969, decouple_loss:0.0012439474230632186
Iteration: 194, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475904703140259, gen p mean: -0.04910758510231972, mean p set: 0.4480707347393036
loss_pred:0.013863916508853436, decouple_loss:0.0013702958822250366
The modified gen p mean: 0.44800320267677307, gen p mean: -0.03978336602449417, mean p set: 0.4484834671020508The modified gen p mean: 0.4484303593635559, gen p mean: -0.04261326789855957, mean p set: 0.4489106833934784
loss_pred:0.013262998312711716, decouple_loss:0.001379788969643414
loss_pred:0.01303007360547781, decouple_loss:0.0011542988941073418
Iteration: 195, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483945965766907, gen p mean: -0.04133715108036995, mean p set: 0.4488748610019684
loss_pred:0.013386376202106476, decouple_loss:0.0012941723689436913
The modified gen p mean: 0.4494439363479614, gen p mean: -0.04586043953895569, mean p set: 0.4499242305755615The modified gen p mean: 0.4474042057991028, gen p mean: -0.04702766239643097, mean p set: 0.4478845000267029
loss_pred:0.01287388987839222, decouple_loss:0.001350674661807716
loss_pred:0.012841488234698772, decouple_loss:0.001411827397532761
Iteration: 196, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44617775082588196, gen p mean: -0.043172694742679596, mean p set: 0.44665804505348206
loss_pred:0.012864850461483002, decouple_loss:0.0013087070547044277
The modified gen p mean: 0.4471322298049927, gen p mean: -0.04556486755609512, mean p set: 0.4476125240325928The modified gen p mean: 0.4478377103805542, gen p mean: -0.04914478957653046, mean p set: 0.4483180344104767
loss_pred:0.01388982031494379, decouple_loss:0.0012243544915691018
loss_pred:0.012948296964168549, decouple_loss:0.001314235501922667
Iteration: 197, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466460347175598, gen p mean: -0.04762684553861618, mean p set: 0.4471263289451599
loss_pred:0.012652537785470486, decouple_loss:0.0012024272000417113
The modified gen p mean: 0.4482412040233612, gen p mean: -0.04723785072565079, mean p set: 0.4487214982509613The modified gen p mean: 0.44812509417533875, gen p mean: -0.04353857412934303, mean p set: 0.44860541820526123
loss_pred:0.013101980090141296, decouple_loss:0.0013187744189053774
loss_pred:0.0131189851090312, decouple_loss:0.0011412652675062418
Iteration: 198, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44823968410491943, gen p mean: -0.04468967765569687, mean p set: 0.44871997833251953
loss_pred:0.012670810334384441, decouple_loss:0.0013014886062592268
The modified gen p mean: 0.44716453552246094, gen p mean: -0.04610901698470116, mean p set: 0.4476448595523834The modified gen p mean: 0.448089063167572, gen p mean: -0.04435070976614952, mean p set: 0.4485693573951721
loss_pred:0.013069882057607174, decouple_loss:0.0012283199466764927
loss_pred:0.012636048719286919, decouple_loss:0.0013030957197770476
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012005_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012005_3_24hr.npz
NaN value num: 0
Iteration: 199, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45290446281433105, gen p mean: -0.043221551924943924, mean p set: 0.45338475704193115
loss_pred:0.01875980943441391, decouple_loss:0.0013669654726982117
The modified gen p mean: 0.45163244009017944, gen p mean: -0.04287142679095268, mean p set: 0.45211273431777954The modified gen p mean: 0.4506296217441559, gen p mean: -0.03912249580025673, mean p set: 0.4511098861694336
loss_pred:0.019660135731101036, decouple_loss:0.0014269847888499498
loss_pred:0.019275765866041183, decouple_loss:0.0013267408357933164
Iteration: 200, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4517457187175751, gen p mean: -0.0361676923930645, mean p set: 0.45222604274749756
loss_pred:0.019645052030682564, decouple_loss:0.0014980853302404284
The modified gen p mean: 0.45289456844329834, gen p mean: -0.039295490831136703, mean p set: 0.45337486267089844The modified gen p mean: 0.4512058198451996, gen p mean: -0.04447673261165619, mean p set: 0.4516860842704773
loss_pred:0.017643483355641365, decouple_loss:0.0014350861310958862
loss_pred:0.017985636368393898, decouple_loss:0.0012986866058781743
2023-04-30 23:04:29 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.038394927978515625, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.03304065763950348, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.03355151042342186, mean p set: 0.4500633478164673
loss_pred:0.01875004544854164, decouple_loss:0.00125367590226233
loss_pred:0.017676595598459244, decouple_loss:0.0011957205133512616
loss_pred:0.017808355391025543, decouple_loss:0.0012272184249013662
WV_0_PC_1_EH_0_PS_40, loss: 0.018139608204364777, avg_mse: 0.026166168972849846
current test mse: 0.026166
Iteration: 201, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500422775745392, gen p mean: -0.037301383912563324, mean p set: 0.45052260160446167
The modified gen p mean: 0.4522184729576111, gen p mean: -0.03744804114103317, mean p set: 0.45269879698753357
The modified gen p mean: 0.4508022367954254, gen p mean: -0.02533484622836113, mean p set: 0.4512825310230255
loss_pred:0.017539463937282562, decouple_loss:0.001262220786884427
loss_pred:0.017545970156788826, decouple_loss:0.001195457298308611
loss_pred:0.017439348623156548, decouple_loss:0.001269295229576528
Iteration: 202, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45060622692108154, gen p mean: -0.029638445004820824, mean p set: 0.45108652114868164
loss_pred:0.019420094788074493, decouple_loss:0.0012602834030985832
The modified gen p mean: 0.4518134891986847, gen p mean: -0.03271539881825447, mean p set: 0.4522937834262848The modified gen p mean: 0.4523831307888031, gen p mean: -0.02776244282722473, mean p set: 0.4528633952140808
loss_pred:0.01774810068309307, decouple_loss:0.0012655744794756174
loss_pred:0.01656348817050457, decouple_loss:0.001197264646179974
Iteration: 203, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45191705226898193, gen p mean: -0.032579369843006134, mean p set: 0.45239734649658203
loss_pred:0.01697600446641445, decouple_loss:0.0012880353024229407
The modified gen p mean: 0.4509257674217224, gen p mean: -0.02898620441555977, mean p set: 0.4514060616493225The modified gen p mean: 0.4523986279964447, gen p mean: -0.031181251630187035, mean p set: 0.4528789222240448
loss_pred:0.01906679943203926, decouple_loss:0.0014157322002574801
loss_pred:0.016964135691523552, decouple_loss:0.001308860839344561
Iteration: 204, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45139768719673157, gen p mean: -0.027932574972510338, mean p set: 0.45187801122665405
loss_pred:0.01882368139922619, decouple_loss:0.0011770311975851655
The modified gen p mean: 0.4515439569950104, gen p mean: -0.03290233016014099, mean p set: 0.4520242512226105The modified gen p mean: 0.4512471556663513, gen p mean: -0.03377784043550491, mean p set: 0.45172742009162903
loss_pred:0.01734928973019123, decouple_loss:0.0012129477690905333
loss_pred:0.01841859146952629, decouple_loss:0.0012679280480369925
Iteration: 205, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45097115635871887, gen p mean: -0.02911587618291378, mean p set: 0.45145145058631897
loss_pred:0.01727960631251335, decouple_loss:0.001313007203862071
The modified gen p mean: 0.452442467212677, gen p mean: -0.029879186302423477, mean p set: 0.4529227614402771The modified gen p mean: 0.4509144127368927, gen p mean: -0.02415027655661106, mean p set: 0.4513946771621704
loss_pred:0.017726093530654907, decouple_loss:0.0013205393915995955
loss_pred:0.01834426075220108, decouple_loss:0.00123053346760571
Iteration: 206, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450927734375, gen p mean: -0.03081478923559189, mean p set: 0.4514080286026001
loss_pred:0.01881660707294941, decouple_loss:0.0012658254709094763
The modified gen p mean: 0.45057252049446106, gen p mean: -0.02849883958697319, mean p set: 0.45105281472206116The modified gen p mean: 0.4505358338356018, gen p mean: -0.03547655791044235, mean p set: 0.4510160982608795
loss_pred:0.01626189611852169, decouple_loss:0.0012160756159573793
loss_pred:0.018262309953570366, decouple_loss:0.0012543268967419863
Iteration: 207, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494110643863678, gen p mean: -0.03969189524650574, mean p set: 0.4498913586139679
loss_pred:0.01675262860953808, decouple_loss:0.0012474760878831148
The modified gen p mean: 0.4510226249694824, gen p mean: -0.031866416335105896, mean p set: 0.4515029489994049The modified gen p mean: 0.4510059058666229, gen p mean: -0.026003118604421616, mean p set: 0.45148617029190063
loss_pred:0.017485836520791054, decouple_loss:0.0012929912190884352
loss_pred:0.016479436308145523, decouple_loss:0.0011456380598247051
Iteration: 208, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4510725140571594, gen p mean: -0.030167419463396072, mean p set: 0.4515528082847595
loss_pred:0.019027505069971085, decouple_loss:0.0013215208891779184
The modified gen p mean: 0.45116761326789856, gen p mean: -0.033702243119478226, mean p set: 0.45164790749549866
The modified gen p mean: 0.45093539357185364, gen p mean: -0.032044220715761185, mean p set: 0.45141565799713135
loss_pred:0.017532533034682274, decouple_loss:0.001240127021446824
loss_pred:0.018722254782915115, decouple_loss:0.001394626684486866
Iteration: 209, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45149075984954834, gen p mean: -0.031078603118658066, mean p set: 0.45197105407714844
loss_pred:0.01766788773238659, decouple_loss:0.001136827515438199
The modified gen p mean: 0.4502906799316406, gen p mean: -0.03970020264387131, mean p set: 0.4507710039615631The modified gen p mean: 0.45133718848228455, gen p mean: -0.03099401853978634, mean p set: 0.45181748270988464
loss_pred:0.01820327900350094, decouple_loss:0.0011900303652510047
loss_pred:0.01880866289138794, decouple_loss:0.0011219069128856063
Iteration: 210, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45110514760017395, gen p mean: -0.03580833226442337, mean p set: 0.45158541202545166
loss_pred:0.018308423459529877, decouple_loss:0.0011991063365712762
The modified gen p mean: 0.451057106256485, gen p mean: -0.03791316971182823, mean p set: 0.4515374004840851The modified gen p mean: 0.45191532373428345, gen p mean: -0.04468898847699165, mean p set: 0.45239561796188354
loss_pred:0.018380139023065567, decouple_loss:0.0011344659142196178
loss_pred:0.017134739086031914, decouple_loss:0.0013306726468726993
2023-04-30 23:06:22 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.04468876123428345, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.03935764729976654, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.039648283272981644, mean p set: 0.4500633478164673
loss_pred:0.018510738387703896, decouple_loss:0.001460122293792665
loss_pred:0.01742616295814514, decouple_loss:0.0013410499086603522
loss_pred:0.017517002299427986, decouple_loss:0.0013408479280769825
WV_0_PC_1_EH_0_PS_40, loss: 0.01788700371980667, avg_mse: 0.02568095363676548
current test mse: 0.025681
Iteration: 211, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503636956214905, gen p mean: -0.04573870450258255, mean p set: 0.4508439898490906
The modified gen p mean: 0.4513143002986908, gen p mean: -0.04130881279706955, mean p set: 0.4517945945262909
The modified gen p mean: 0.4510253071784973, gen p mean: -0.044371675699949265, mean p set: 0.451505571603775
loss_pred:0.01750820502638817, decouple_loss:0.0011906072031706572
loss_pred:0.016439897939562798, decouple_loss:0.0011921040713787079
loss_pred:0.016272401437163353, decouple_loss:0.0010957117192447186
Iteration: 212, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45028239488601685, gen p mean: -0.041736356914043427, mean p set: 0.45076268911361694
The modified gen p mean: 0.45060819387435913, gen p mean: -0.03461131826043129, mean p set: 0.45108845829963684
loss_pred:0.01832173950970173, decouple_loss:0.0014599015703424811
loss_pred:0.017527537420392036, decouple_loss:0.0013522175140678883
The modified gen p mean: 0.4514937400817871, gen p mean: -0.04301813617348671, mean p set: 0.45197397470474243
loss_pred:0.016087401658296585, decouple_loss:0.0013655043439939618
Iteration: 213, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45106038451194763, gen p mean: -0.047655194997787476, mean p set: 0.45154067873954773
loss_pred:0.018243521451950073, decouple_loss:0.0012570425169542432
The modified gen p mean: 0.4511990249156952, gen p mean: -0.03802848607301712, mean p set: 0.4516793489456177The modified gen p mean: 0.4514378607273102, gen p mean: -0.04649830237030983, mean p set: 0.4519181549549103
loss_pred:0.018367938697338104, decouple_loss:0.0010408199159428477
loss_pred:0.016327250748872757, decouple_loss:0.0011179143330082297
Iteration: 214, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45126789808273315, gen p mean: -0.04355519637465477, mean p set: 0.45174819231033325
loss_pred:0.018286684527993202, decouple_loss:0.0015593291027471423
The modified gen p mean: 0.45039984583854675, gen p mean: -0.04066535457968712, mean p set: 0.45088016986846924The modified gen p mean: 0.45155468583106995, gen p mean: -0.041706670075654984, mean p set: 0.45203498005867004
loss_pred:0.01752658002078533, decouple_loss:0.0013691765489056706
loss_pred:0.01821604184806347, decouple_loss:0.0015442281728610396
Iteration: 215, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4524074196815491, gen p mean: -0.04594700410962105, mean p set: 0.45288771390914917
loss_pred:0.019031958654522896, decouple_loss:0.0011089231120422482
The modified gen p mean: 0.45118048787117004, gen p mean: -0.04907912760972977, mean p set: 0.45166081190109253The modified gen p mean: 0.4523017406463623, gen p mean: -0.043799735605716705, mean p set: 0.45278200507164
loss_pred:0.01694340817630291, decouple_loss:0.0011640558950603008
loss_pred:0.017393488436937332, decouple_loss:0.0012210308341309428
Iteration: 216, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507334530353546, gen p mean: -0.03860592469573021, mean p set: 0.4512137174606323
loss_pred:0.016261767596006393, decouple_loss:0.0011749658733606339
The modified gen p mean: 0.4506426751613617, gen p mean: -0.04610294848680496, mean p set: 0.4511229395866394The modified gen p mean: 0.4510195255279541, gen p mean: -0.043281715363264084, mean p set: 0.4514998197555542
loss_pred:0.01873442530632019, decouple_loss:0.0012162697967141867
loss_pred:0.017792413011193275, decouple_loss:0.001123403781093657
Iteration: 217, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45209985971450806, gen p mean: -0.043247342109680176, mean p set: 0.45258012413978577
loss_pred:0.018023759126663208, decouple_loss:0.0011220889864489436
The modified gen p mean: 0.4509027600288391, gen p mean: -0.053788360208272934, mean p set: 0.4513830542564392The modified gen p mean: 0.4513819217681885, gen p mean: -0.04548628255724907, mean p set: 0.4518622159957886
loss_pred:0.017379140481352806, decouple_loss:0.00120983284432441
loss_pred:0.018325192853808403, decouple_loss:0.00125021580606699
Iteration: 218, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4527597725391388, gen p mean: -0.0460430383682251, mean p set: 0.4532400667667389
loss_pred:0.018820898607373238, decouple_loss:0.0013090405846014619
The modified gen p mean: 0.4515528380870819, gen p mean: -0.04213676601648331, mean p set: 0.4520331025123596The modified gen p mean: 0.45133134722709656, gen p mean: -0.04753054305911064, mean p set: 0.45181164145469666
loss_pred:0.018278930336236954, decouple_loss:0.001188641763292253
loss_pred:0.018413271754980087, decouple_loss:0.0011791345896199346
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012011_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012011_3_24hr.npz
NaN value num: 0
Iteration: 219, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4527105689048767, gen p mean: -0.03704269602894783, mean p set: 0.4531908929347992
loss_pred:0.016932189464569092, decouple_loss:0.0012074250262230635
The modified gen p mean: 0.4520944356918335, gen p mean: -0.040922850370407104, mean p set: 0.452574759721756The modified gen p mean: 0.45193371176719666, gen p mean: -0.03674608841538429, mean p set: 0.45241400599479675
loss_pred:0.017581716179847717, decouple_loss:0.001248112297616899
loss_pred:0.017537759616971016, decouple_loss:0.001218449673615396
Iteration: 220, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4526793360710144, gen p mean: -0.04528426378965378, mean p set: 0.4531596302986145
loss_pred:0.01729380339384079, decouple_loss:0.0013742948649451137
The modified gen p mean: 0.4515134394168854, gen p mean: -0.038829363882541656, mean p set: 0.4519937038421631The modified gen p mean: 0.4522055387496948, gen p mean: -0.036684855818748474, mean p set: 0.4526858329772949
loss_pred:0.017344992607831955, decouple_loss:0.0012141306651756167
loss_pred:0.017623640596866608, decouple_loss:0.001245531952008605
2023-04-30 23:09:10 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.047113824635744095, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04144173488020897, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.04215341806411743, mean p set: 0.4500633478164673
loss_pred:0.018514109775424004, decouple_loss:0.0012694441247731447
loss_pred:0.017387522384524345, decouple_loss:0.0011876645730808377
loss_pred:0.017495034262537956, decouple_loss:0.0011579128913581371
WV_0_PC_1_EH_0_PS_40, loss: 0.017859138548374176, avg_mse: 0.02563450299203396
current test mse: 0.025635
Iteration: 221, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4521663784980774, gen p mean: -0.03301572799682617, mean p set: 0.4526466727256775
The modified gen p mean: 0.450969934463501, gen p mean: -0.03652030974626541, mean p set: 0.45145025849342346
The modified gen p mean: 0.45241689682006836, gen p mean: -0.032825030386447906, mean p set: 0.45289722084999084
loss_pred:0.018017921596765518, decouple_loss:0.0011330671841278672
loss_pred:0.017975717782974243, decouple_loss:0.0012149811955168843
loss_pred:0.017192412167787552, decouple_loss:0.0011232676915824413
Iteration: 222, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4518750011920929, gen p mean: -0.029944024980068207, mean p set: 0.452355295419693
loss_pred:0.017168454825878143, decouple_loss:0.0011333496076986194
The modified gen p mean: 0.4513395428657532, gen p mean: -0.03730440139770508, mean p set: 0.45181983709335327The modified gen p mean: 0.4514908194541931, gen p mean: -0.03818462789058685, mean p set: 0.4519711136817932
loss_pred:0.018240539357066154, decouple_loss:0.0012419633567333221
loss_pred:0.018094781786203384, decouple_loss:0.0013039519544690847
Iteration: 223, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4506920278072357, gen p mean: -0.03466753289103508, mean p set: 0.4511723518371582
loss_pred:0.01785373128950596, decouple_loss:0.0011186928022652864
The modified gen p mean: 0.4518061578273773, gen p mean: -0.03238086402416229, mean p set: 0.45228642225265503The modified gen p mean: 0.4518676996231079, gen p mean: -0.038287967443466187, mean p set: 0.4523479640483856
loss_pred:0.016939666122198105, decouple_loss:0.0011797575280070305
loss_pred:0.01739761047065258, decouple_loss:0.0011939617106691003
Iteration: 224, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45180773735046387, gen p mean: -0.036723822355270386, mean p set: 0.45228806138038635
loss_pred:0.01710584945976734, decouple_loss:0.0011501992121338844
The modified gen p mean: 0.45074141025543213, gen p mean: -0.034391775727272034, mean p set: 0.4512217342853546The modified gen p mean: 0.45150279998779297, gen p mean: -0.03763338923454285, mean p set: 0.45198309421539307
loss_pred:0.017520960420370102, decouple_loss:0.0011685389326885343
loss_pred:0.017134496942162514, decouple_loss:0.0010857202578336
Iteration: 225, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513983130455017, gen p mean: -0.03924741595983505, mean p set: 0.4518786072731018
loss_pred:0.017778249457478523, decouple_loss:0.001324295881204307
The modified gen p mean: 0.45147213339805603, gen p mean: -0.039874833077192307, mean p set: 0.45195239782333374The modified gen p mean: 0.4532409608364105, gen p mean: -0.04588744789361954, mean p set: 0.4537212550640106
loss_pred:0.017740588635206223, decouple_loss:0.0012400021078065038loss_pred:0.017260396853089333, decouple_loss:0.0012749523157253861
Iteration: 226, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45261839032173157, gen p mean: -0.04177361726760864, mean p set: 0.4530986547470093
loss_pred:0.016870038583874702, decouple_loss:0.001131174503825605
The modified gen p mean: 0.4520377218723297, gen p mean: -0.0329509899020195, mean p set: 0.4525179862976074The modified gen p mean: 0.45035693049430847, gen p mean: -0.036971721798181534, mean p set: 0.4508371949195862
loss_pred:0.016682500019669533, decouple_loss:0.0010669053299352527
loss_pred:0.017517125234007835, decouple_loss:0.001112587284296751
Iteration: 227, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45191672444343567, gen p mean: -0.04037635773420334, mean p set: 0.4523969888687134
loss_pred:0.017225852236151695, decouple_loss:0.001127624767832458
The modified gen p mean: 0.45124927163124084, gen p mean: -0.03229350969195366, mean p set: 0.45172953605651855The modified gen p mean: 0.4527018666267395, gen p mean: -0.048672933131456375, mean p set: 0.4531821608543396
loss_pred:0.01666240207850933, decouple_loss:0.0011955441441386938
loss_pred:0.016744595021009445, decouple_loss:0.0012592737330123782
Iteration: 228, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4524117708206177, gen p mean: -0.04084177687764168, mean p set: 0.4528920352458954
loss_pred:0.017663775011897087, decouple_loss:0.0010297916596755385
The modified gen p mean: 0.45310261845588684, gen p mean: -0.04150395467877388, mean p set: 0.45358291268348694The modified gen p mean: 0.4532967507839203, gen p mean: -0.051985468715429306, mean p set: 0.453777015209198
loss_pred:0.016489151865243912, decouple_loss:0.0011310811387374997
loss_pred:0.016916237771511078, decouple_loss:0.0012110292445868254
Iteration: 229, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45123928785324097, gen p mean: -0.04355845972895622, mean p set: 0.45171958208084106
loss_pred:0.01709865964949131, decouple_loss:0.001211442518979311
The modified gen p mean: 0.4533819854259491, gen p mean: -0.04592086374759674, mean p set: 0.4538623094558716The modified gen p mean: 0.45314139127731323, gen p mean: -0.04377986490726471, mean p set: 0.45362168550491333
loss_pred:0.017651140689849854, decouple_loss:0.0011668713996186852
loss_pred:0.016390549018979073, decouple_loss:0.001221880316734314
Iteration: 230, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4512045383453369, gen p mean: -0.04889165610074997, mean p set: 0.4516848623752594
loss_pred:0.01752515882253647, decouple_loss:0.0010962911183014512
The modified gen p mean: 0.4510209262371063, gen p mean: -0.04240794852375984, mean p set: 0.45150119066238403The modified gen p mean: 0.4535418748855591, gen p mean: -0.03898302838206291, mean p set: 0.4540221691131592
loss_pred:0.016434356570243835, decouple_loss:0.0010018659522756934
loss_pred:0.017924249172210693, decouple_loss:0.0010322945890948176
2023-04-30 23:11:03 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.052928224205970764, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.046948496252298355, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04801694303750992, mean p set: 0.4500633478164673
loss_pred:0.01857997477054596, decouple_loss:0.001349428785033524
loss_pred:0.01739317923784256, decouple_loss:0.0012953459518030286
loss_pred:0.017522089183330536, decouple_loss:0.0012925503542646766
WV_0_PC_1_EH_0_PS_40, loss: 0.01789737120270729, avg_mse: 0.025711601600050926
current test mse: 0.025712
Iteration: 231, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45258283615112305, gen p mean: -0.040532492101192474, mean p set: 0.45306316018104553
The modified gen p mean: 0.4534513056278229, gen p mean: -0.04986703395843506, mean p set: 0.45393162965774536
The modified gen p mean: 0.45208415389060974, gen p mean: -0.03976479545235634, mean p set: 0.45256444811820984
loss_pred:0.01689150184392929, decouple_loss:0.0010520872892811894
loss_pred:0.01738881878554821, decouple_loss:0.0010638425592333078loss_pred:0.017437389120459557, decouple_loss:0.001129755168221891
Iteration: 232, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4532608687877655, gen p mean: -0.04232913628220558, mean p set: 0.453741192817688
loss_pred:0.01722513698041439, decouple_loss:0.0010331518715247512
The modified gen p mean: 0.45338529348373413, gen p mean: -0.04287116974592209, mean p set: 0.45386558771133423The modified gen p mean: 0.4508679509162903, gen p mean: -0.04301298409700394, mean p set: 0.4513482451438904
loss_pred:0.016994789242744446, decouple_loss:0.0010093261953443289
loss_pred:0.016449322924017906, decouple_loss:0.0009850644273683429
Iteration: 233, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4523659348487854, gen p mean: -0.039311639964580536, mean p set: 0.4528461992740631
loss_pred:0.01715029962360859, decouple_loss:0.0012924509355798364
The modified gen p mean: 0.4517366290092468, gen p mean: -0.036558691412210464, mean p set: 0.4522169232368469The modified gen p mean: 0.45239338278770447, gen p mean: -0.04472191631793976, mean p set: 0.45287367701530457
loss_pred:0.01741599105298519, decouple_loss:0.0011633617104962468
loss_pred:0.016870656982064247, decouple_loss:0.0012297231005504727
Iteration: 234, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4521658420562744, gen p mean: -0.04005380719900131, mean p set: 0.4526461064815521
loss_pred:0.01730971969664097, decouple_loss:0.001022102078422904
The modified gen p mean: 0.45355185866355896, gen p mean: -0.03802096098661423, mean p set: 0.45403215289115906The modified gen p mean: 0.45066335797309875, gen p mean: -0.036770645529031754, mean p set: 0.45114362239837646
loss_pred:0.016423221677541733, decouple_loss:0.0010004570940509439
loss_pred:0.016542285680770874, decouple_loss:0.0009615264716558158
Iteration: 235, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4512758255004883, gen p mean: -0.04520905762910843, mean p set: 0.4517561197280884
loss_pred:0.01743728667497635, decouple_loss:0.0011916256044059992
The modified gen p mean: 0.45192667841911316, gen p mean: -0.0371074303984642, mean p set: 0.45240697264671326The modified gen p mean: 0.4506340026855469, gen p mean: -0.039896346628665924, mean p set: 0.451114296913147
loss_pred:0.0174068845808506, decouple_loss:0.001057918299920857
loss_pred:0.016508949920535088, decouple_loss:0.001029504812322557
Iteration: 236, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45155200362205505, gen p mean: -0.039978187531232834, mean p set: 0.45203232765197754
loss_pred:0.017633115872740746, decouple_loss:0.0010152342729270458
The modified gen p mean: 0.4526510536670685, gen p mean: -0.03882782533764839, mean p set: 0.4531313478946686The modified gen p mean: 0.45242398977279663, gen p mean: -0.0422263965010643, mean p set: 0.4529043138027191
loss_pred:0.01708984561264515, decouple_loss:0.0010104887187480927
loss_pred:0.01682054065167904, decouple_loss:0.0010096641490235925
Iteration: 237, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45091700553894043, gen p mean: -0.045404307544231415, mean p set: 0.4513972997665405
loss_pred:0.017094336450099945, decouple_loss:0.0010647159069776535
The modified gen p mean: 0.452045738697052, gen p mean: -0.04434472694993019, mean p set: 0.4525260329246521The modified gen p mean: 0.45173466205596924, gen p mean: -0.045419808477163315, mean p set: 0.45221495628356934
loss_pred:0.017430661246180534, decouple_loss:0.0012153591960668564
loss_pred:0.017757192254066467, decouple_loss:0.00118141935672611
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012012_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012012_3_24hr.npz
NaN value num: 0
Iteration: 238, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44812050461769104, gen p mean: -0.044520631432533264, mean p set: 0.44860079884529114
loss_pred:0.0159272663295269, decouple_loss:0.0010740056168287992
The modified gen p mean: 0.4468739926815033, gen p mean: -0.0437491238117218, mean p set: 0.4473542869091034The modified gen p mean: 0.4474409818649292, gen p mean: -0.048997219651937485, mean p set: 0.4479212760925293
loss_pred:0.015422631986439228, decouple_loss:0.0011269405949860811
loss_pred:0.015222154557704926, decouple_loss:0.001179839251562953
Iteration: 239, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474908709526062, gen p mean: -0.051546160131692886, mean p set: 0.4479711353778839
loss_pred:0.0152732003480196, decouple_loss:0.0010736165568232536
The modified gen p mean: 0.44654789566993713, gen p mean: -0.05226900056004524, mean p set: 0.4470282196998596The modified gen p mean: 0.44742700457572937, gen p mean: -0.04889792576432228, mean p set: 0.4479072690010071
loss_pred:0.015160033479332924, decouple_loss:0.0010952722514048219
loss_pred:0.01586080528795719, decouple_loss:0.0010190455941483378
Iteration: 240, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44647812843322754, gen p mean: -0.0541754812002182, mean p set: 0.44695839285850525
loss_pred:0.01496442686766386, decouple_loss:0.001091859070584178
The modified gen p mean: 0.4477849304676056, gen p mean: -0.0523764006793499, mean p set: 0.4482652246952057The modified gen p mean: 0.44790807366371155, gen p mean: -0.053185995668172836, mean p set: 0.44838836789131165
loss_pred:0.015578268095850945, decouple_loss:0.0011203252943232656
loss_pred:0.014618280343711376, decouple_loss:0.0012058187276124954
2023-04-30 23:13:58 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.05879940837621689, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.05337514728307724, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.05415831506252289, mean p set: 0.4500633478164673
loss_pred:0.018779998645186424, decouple_loss:0.0011564393062144518
loss_pred:0.01770848035812378, decouple_loss:0.0011786599643528461loss_pred:0.017629534006118774, decouple_loss:0.0011852572206407785
WV_0_PC_1_EH_0_PS_40, loss: 0.01809801161289215, avg_mse: 0.026105079799890518
current test mse: 0.026105
Iteration: 241, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44752028584480286, gen p mean: -0.0547330379486084, mean p set: 0.44800058007240295
The modified gen p mean: 0.4481739103794098, gen p mean: -0.054664529860019684, mean p set: 0.4486541748046875
The modified gen p mean: 0.4467793107032776, gen p mean: -0.05390791967511177, mean p set: 0.4472596049308777
loss_pred:0.01458615344017744, decouple_loss:0.0011029447196051478
loss_pred:0.013973770663142204, decouple_loss:0.0011473777703940868
loss_pred:0.015622508712112904, decouple_loss:0.0011199687141925097
Iteration: 242, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44773608446121216, gen p mean: -0.05769472196698189, mean p set: 0.44821637868881226
loss_pred:0.014875007793307304, decouple_loss:0.0012071197852492332
The modified gen p mean: 0.4476260542869568, gen p mean: -0.059357721358537674, mean p set: 0.4481063485145569The modified gen p mean: 0.4480159282684326, gen p mean: -0.05145978182554245, mean p set: 0.4484962224960327
loss_pred:0.014911219477653503, decouple_loss:0.001190148526802659
loss_pred:0.015169252641499043, decouple_loss:0.0012545597273856401
Iteration: 243, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44732311367988586, gen p mean: -0.05922326073050499, mean p set: 0.44780340790748596
loss_pred:0.014157994650304317, decouple_loss:0.0013329905923455954
The modified gen p mean: 0.4475524127483368, gen p mean: -0.056583281606435776, mean p set: 0.4480327069759369The modified gen p mean: 0.447184681892395, gen p mean: -0.0622832365334034, mean p set: 0.4476650059223175
loss_pred:0.014234730042517185, decouple_loss:0.0012286336859688163
loss_pred:0.01409671176224947, decouple_loss:0.0013295903336256742
Iteration: 244, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478203058242798, gen p mean: -0.059509702026844025, mean p set: 0.4483005702495575
loss_pred:0.014654680155217648, decouple_loss:0.001325869234278798
The modified gen p mean: 0.4477179944515228, gen p mean: -0.05811968445777893, mean p set: 0.4481982886791229The modified gen p mean: 0.4477330446243286, gen p mean: -0.05725274607539177, mean p set: 0.4482133686542511
loss_pred:0.013600224629044533, decouple_loss:0.0012778769014403224
loss_pred:0.01403816044330597, decouple_loss:0.0013746172189712524
Iteration: 245, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44814231991767883, gen p mean: -0.05574405938386917, mean p set: 0.44862261414527893
loss_pred:0.013394580222666264, decouple_loss:0.0013103075325489044
The modified gen p mean: 0.446382999420166, gen p mean: -0.05657532066106796, mean p set: 0.4468632936477661The modified gen p mean: 0.4474744498729706, gen p mean: -0.05605892091989517, mean p set: 0.4479547441005707
loss_pred:0.013454466126859188, decouple_loss:0.001344132237136364
loss_pred:0.013682207092642784, decouple_loss:0.001351612969301641
Iteration: 246, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44597822427749634, gen p mean: -0.05343347415328026, mean p set: 0.44645851850509644
The modified gen p mean: 0.44812092185020447, gen p mean: -0.053627509623765945, mean p set: 0.44860121607780457
loss_pred:0.013796811923384666, decouple_loss:0.0013279981212690473
loss_pred:0.013134250417351723, decouple_loss:0.0013019675388932228
The modified gen p mean: 0.44869041442871094, gen p mean: -0.05221245810389519, mean p set: 0.44917070865631104
loss_pred:0.014893918298184872, decouple_loss:0.0013228657189756632
Iteration: 247, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478985369205475, gen p mean: -0.05287619307637215, mean p set: 0.4483788311481476
loss_pred:0.014237676747143269, decouple_loss:0.0014410183066502213
The modified gen p mean: 0.44849732518196106, gen p mean: -0.05269362032413483, mean p set: 0.44897761940956116The modified gen p mean: 0.44743579626083374, gen p mean: -0.052205976098775864, mean p set: 0.44791606068611145
loss_pred:0.013348227366805077, decouple_loss:0.0013658397365361452
loss_pred:0.014382065273821354, decouple_loss:0.0014112084172666073
Iteration: 248, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44695988297462463, gen p mean: -0.055922601372003555, mean p set: 0.4474402070045471
loss_pred:0.013984426856040955, decouple_loss:0.001457888982258737
The modified gen p mean: 0.447037011384964, gen p mean: -0.05080468952655792, mean p set: 0.4475173056125641The modified gen p mean: 0.4469078481197357, gen p mean: -0.05702737718820572, mean p set: 0.4473881721496582
loss_pred:0.013939118012785912, decouple_loss:0.0015886517940089107
loss_pred:0.013668917119503021, decouple_loss:0.0014349250122904778
Iteration: 249, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446853905916214, gen p mean: -0.052536237984895706, mean p set: 0.4473342299461365
The modified gen p mean: 0.4484599232673645, gen p mean: -0.052087511867284775, mean p set: 0.448940247297287
loss_pred:0.013858032412827015, decouple_loss:0.0012989301467314363
loss_pred:0.014488068409264088, decouple_loss:0.0013932345900684595
The modified gen p mean: 0.4476092755794525, gen p mean: -0.04451211914420128, mean p set: 0.4480895698070526
loss_pred:0.013652618043124676, decouple_loss:0.0012714735930785537
Iteration: 250, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44628408551216125, gen p mean: -0.04244156554341316, mean p set: 0.44676437973976135
loss_pred:0.013661276549100876, decouple_loss:0.0014343986986204982
The modified gen p mean: 0.448669970035553, gen p mean: -0.04873410612344742, mean p set: 0.4491502642631531The modified gen p mean: 0.4470200538635254, gen p mean: -0.04918890818953514, mean p set: 0.4475003480911255
loss_pred:0.01445959135890007, decouple_loss:0.0014888558071106672
loss_pred:0.013433068990707397, decouple_loss:0.0014369344571605325
2023-04-30 23:15:52 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.050410833209753036, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.045085977762937546, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.04559915512800217, mean p set: 0.4500633478164673
loss_pred:0.019638529047369957, decouple_loss:0.0014493208145722747
loss_pred:0.01838815025985241, decouple_loss:0.0014205441111698747
loss_pred:0.01853393018245697, decouple_loss:0.0013835857389494777
WV_0_PC_1_EH_0_PS_40, loss: 0.018924428150057793, avg_mse: 0.027664007619023323
current test mse: 0.027664
Iteration: 251, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44730570912361145, gen p mean: -0.05014004558324814, mean p set: 0.44778600335121155
The modified gen p mean: 0.44741907715797424, gen p mean: -0.04768255352973938, mean p set: 0.44789940118789673
The modified gen p mean: 0.44765475392341614, gen p mean: -0.049475912004709244, mean p set: 0.44813501834869385
loss_pred:0.014109078794717789, decouple_loss:0.0013509057462215424
loss_pred:0.013511981815099716, decouple_loss:0.0013523957459256053
loss_pred:0.013801377266645432, decouple_loss:0.0014599935384467244
Iteration: 252, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477022588253021, gen p mean: -0.0459955632686615, mean p set: 0.4481825828552246
loss_pred:0.013251304626464844, decouple_loss:0.001374752027913928
The modified gen p mean: 0.44889017939567566, gen p mean: -0.047673534601926804, mean p set: 0.44937047362327576The modified gen p mean: 0.4472868740558624, gen p mean: -0.04974740371108055, mean p set: 0.4477671980857849
loss_pred:0.014491455629467964, decouple_loss:0.0013736771652475
loss_pred:0.013372405432164669, decouple_loss:0.0013933879090473056
Iteration: 253, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44679224491119385, gen p mean: -0.05010855942964554, mean p set: 0.44727250933647156
loss_pred:0.013425485230982304, decouple_loss:0.0013452108250930905
The modified gen p mean: 0.44876790046691895, gen p mean: -0.04810645058751106, mean p set: 0.44924822449684143The modified gen p mean: 0.4472026228904724, gen p mean: -0.049884650856256485, mean p set: 0.4476828873157501
loss_pred:0.013649488799273968, decouple_loss:0.0013344342587515712
loss_pred:0.013341976329684258, decouple_loss:0.0014836593763902783
Iteration: 254, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44769424200057983, gen p mean: -0.05081787705421448, mean p set: 0.44817450642585754
loss_pred:0.013335926458239555, decouple_loss:0.0014606784097850323
The modified gen p mean: 0.4478236734867096, gen p mean: -0.04755527153611183, mean p set: 0.4483039677143097The modified gen p mean: 0.44838908314704895, gen p mean: -0.052109796553850174, mean p set: 0.44886934757232666
loss_pred:0.012746660970151424, decouple_loss:0.001516849035397172
loss_pred:0.013700923882424831, decouple_loss:0.0014562209835276008
Iteration: 255, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.445629358291626, gen p mean: -0.04394053295254707, mean p set: 0.4461096227169037
loss_pred:0.013360519893467426, decouple_loss:0.001352246617898345
The modified gen p mean: 0.44723421335220337, gen p mean: -0.047984689474105835, mean p set: 0.4477144777774811The modified gen p mean: 0.4472866654396057, gen p mean: -0.05217413976788521, mean p set: 0.4477669298648834
loss_pred:0.01333010196685791, decouple_loss:0.0013878009049221873
loss_pred:0.013542172499001026, decouple_loss:0.0013569402508437634
Iteration: 256, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478982090950012, gen p mean: -0.046581581234931946, mean p set: 0.44837847352027893
loss_pred:0.013044235296547413, decouple_loss:0.0014374350430443883
The modified gen p mean: 0.44803979992866516, gen p mean: -0.05161801725625992, mean p set: 0.44852009415626526The modified gen p mean: 0.4469403624534607, gen p mean: -0.04988015815615654, mean p set: 0.4474206268787384
loss_pred:0.01358820777386427, decouple_loss:0.0014844308607280254
loss_pred:0.013144289143383503, decouple_loss:0.001399286207742989
Iteration: 257, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44864141941070557, gen p mean: -0.042775172740221024, mean p set: 0.4491216838359833
loss_pred:0.01345045305788517, decouple_loss:0.0013790647499263287
The modified gen p mean: 0.4486526548862457, gen p mean: -0.04380783438682556, mean p set: 0.44913291931152344The modified gen p mean: 0.4477033019065857, gen p mean: -0.046296730637550354, mean p set: 0.4481835961341858
loss_pred:0.013594983145594597, decouple_loss:0.0013193466002121568
loss_pred:0.014107332564890385, decouple_loss:0.0013832066906616092
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012020_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012020_3_24hr.npz
NaN value num: 0
Iteration: 258, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503428041934967, gen p mean: -0.04065897315740585, mean p set: 0.4508230984210968
loss_pred:0.01935591921210289, decouple_loss:0.001589736551977694
The modified gen p mean: 0.4525023102760315, gen p mean: -0.03862094506621361, mean p set: 0.4529826045036316The modified gen p mean: 0.4516649544239044, gen p mean: -0.038110390305519104, mean p set: 0.4521452486515045
loss_pred:0.018333401530981064, decouple_loss:0.0014980870764702559
loss_pred:0.01886855997145176, decouple_loss:0.0014346330426633358
Iteration: 259, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.452048659324646, gen p mean: -0.032995130866765976, mean p set: 0.4525289833545685
loss_pred:0.018790069967508316, decouple_loss:0.0015836451202630997
The modified gen p mean: 0.45273301005363464, gen p mean: -0.040932878851890564, mean p set: 0.45321333408355713The modified gen p mean: 0.4498354196548462, gen p mean: -0.03741993010044098, mean p set: 0.4503157436847687
loss_pred:0.01839757338166237, decouple_loss:0.0014398217899724841
loss_pred:0.018385734409093857, decouple_loss:0.0014577748952433467
Iteration: 260, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4520719349384308, gen p mean: -0.025034179911017418, mean p set: 0.45255225896835327
loss_pred:0.01709488406777382, decouple_loss:0.0014990390045568347
The modified gen p mean: 0.4518081247806549, gen p mean: -0.03524083271622658, mean p set: 0.4522883892059326The modified gen p mean: 0.4531138837337494, gen p mean: -0.026474693790078163, mean p set: 0.4535941779613495
loss_pred:0.017979860305786133, decouple_loss:0.0013648421736434102
loss_pred:0.018857205286622047, decouple_loss:0.0013695500092580914
2023-04-30 23:18:40 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.03640371933579445, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.031270336359739304, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.03158598020672798, mean p set: 0.4500633478164673
loss_pred:0.01888590306043625, decouple_loss:0.001528256107121706
loss_pred:0.017718877643346786, decouple_loss:0.0014337020693346858
loss_pred:0.017865104600787163, decouple_loss:0.0014968437608331442
WV_0_PC_1_EH_0_PS_40, loss: 0.018230943009257317, avg_mse: 0.02632220834493637
current test mse: 0.026322
Iteration: 261, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513130187988281, gen p mean: -0.0286838561296463, mean p set: 0.4517933130264282
The modified gen p mean: 0.4515398144721985, gen p mean: -0.025452133268117905, mean p set: 0.4520201086997986
The modified gen p mean: 0.45018839836120605, gen p mean: -0.030330318957567215, mean p set: 0.45066869258880615
loss_pred:0.018668167293071747, decouple_loss:0.001410311320796609
loss_pred:0.01780465804040432, decouple_loss:0.0014101681299507618
loss_pred:0.017675548791885376, decouple_loss:0.0013104367535561323
Iteration: 262, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4527319073677063, gen p mean: -0.026310643181204796, mean p set: 0.453212171792984
The modified gen p mean: 0.45097616314888, gen p mean: -0.02517002820968628, mean p set: 0.4514564573764801
loss_pred:0.018465636298060417, decouple_loss:0.0014728970127180219
loss_pred:0.01809089072048664, decouple_loss:0.0012737486977130175
The modified gen p mean: 0.4525221884250641, gen p mean: -0.025666192173957825, mean p set: 0.4530024528503418
loss_pred:0.018331114202737808, decouple_loss:0.0014097964158281684
Iteration: 263, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45154717564582825, gen p mean: -0.025152171030640602, mean p set: 0.45202744007110596
loss_pred:0.018200276419520378, decouple_loss:0.0014324664371088147
The modified gen p mean: 0.4498312771320343, gen p mean: -0.035738930106163025, mean p set: 0.4503115713596344The modified gen p mean: 0.4511301815509796, gen p mean: -0.03291701525449753, mean p set: 0.4516104459762573
loss_pred:0.017820626497268677, decouple_loss:0.0013833224074915051
loss_pred:0.018538065254688263, decouple_loss:0.001255737617611885
Iteration: 264, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44984734058380127, gen p mean: -0.029805973172187805, mean p set: 0.45032763481140137
loss_pred:0.018516216427087784, decouple_loss:0.0014981449348852038
The modified gen p mean: 0.45259809494018555, gen p mean: -0.038507938385009766, mean p set: 0.45307838916778564The modified gen p mean: 0.45186764001846313, gen p mean: -0.03115307167172432, mean p set: 0.45234790444374084
loss_pred:0.01752733625471592, decouple_loss:0.0015533844707533717
loss_pred:0.017982790246605873, decouple_loss:0.0014791442081332207
Iteration: 265, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45063936710357666, gen p mean: -0.03145851194858551, mean p set: 0.45111966133117676
loss_pred:0.018451619893312454, decouple_loss:0.0013843828346580267
The modified gen p mean: 0.4506247639656067, gen p mean: -0.03182544931769371, mean p set: 0.4511050879955292The modified gen p mean: 0.45240479707717896, gen p mean: -0.02367367036640644, mean p set: 0.45288509130477905
loss_pred:0.018455199897289276, decouple_loss:0.0013354715192690492
loss_pred:0.017437724396586418, decouple_loss:0.0014287581434473395
Iteration: 266, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45168864727020264, gen p mean: -0.027789412066340446, mean p set: 0.4521689713001251
loss_pred:0.017964160069823265, decouple_loss:0.0016494494630023837
The modified gen p mean: 0.44991931319236755, gen p mean: -0.03264041617512703, mean p set: 0.45039960741996765The modified gen p mean: 0.4502890408039093, gen p mean: -0.035242192447185516, mean p set: 0.450769305229187
loss_pred:0.017570454627275467, decouple_loss:0.0013865485088899732
loss_pred:0.018397009000182152, decouple_loss:0.0013900537742301822
Iteration: 267, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497220814228058, gen p mean: -0.03949497640132904, mean p set: 0.4502023756504059
loss_pred:0.017073070630431175, decouple_loss:0.0012206018436700106
The modified gen p mean: 0.45123717188835144, gen p mean: -0.03338371962308884, mean p set: 0.45171743631362915The modified gen p mean: 0.4519454538822174, gen p mean: -0.030660545453429222, mean p set: 0.4524257183074951
loss_pred:0.01863669790327549, decouple_loss:0.0013352235546335578
loss_pred:0.018078915774822235, decouple_loss:0.0012812026543542743
Iteration: 268, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45305564999580383, gen p mean: -0.03762519359588623, mean p set: 0.4535359740257263
loss_pred:0.017926165834069252, decouple_loss:0.0013906153617426753
The modified gen p mean: 0.4519249498844147, gen p mean: -0.046339478343725204, mean p set: 0.45240524411201477The modified gen p mean: 0.4526446461677551, gen p mean: -0.03804410248994827, mean p set: 0.4531249403953552
loss_pred:0.01755056343972683, decouple_loss:0.0014055073261260986
loss_pred:0.018185287714004517, decouple_loss:0.0013922021025791764
Iteration: 269, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45281991362571716, gen p mean: -0.04190369322896004, mean p set: 0.4533001780509949
loss_pred:0.017863381654024124, decouple_loss:0.0013690355699509382
The modified gen p mean: 0.4519554674625397, gen p mean: -0.03965550661087036, mean p set: 0.45243576169013977The modified gen p mean: 0.45107221603393555, gen p mean: -0.04568857327103615, mean p set: 0.45155251026153564
loss_pred:0.018260003998875618, decouple_loss:0.0013737044064328074
loss_pred:0.018095437437295914, decouple_loss:0.0013005139771848917
Iteration: 270, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45109429955482483, gen p mean: -0.04546067863702774, mean p set: 0.45157456398010254
loss_pred:0.017829935997724533, decouple_loss:0.0013460427289828658
The modified gen p mean: 0.453066885471344, gen p mean: -0.049819935113191605, mean p set: 0.4535471498966217The modified gen p mean: 0.4507010579109192, gen p mean: -0.04259985312819481, mean p set: 0.4511813521385193
loss_pred:0.017516544088721275, decouple_loss:0.001381855458021164
loss_pred:0.01772502064704895, decouple_loss:0.001304308301769197
2023-04-30 23:20:33 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.05352169647812843, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.047948647290468216, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.04829631745815277, mean p set: 0.4500633478164673
loss_pred:0.01863575354218483, decouple_loss:0.001319000730291009
loss_pred:0.017511485144495964, decouple_loss:0.0013642149278894067
loss_pred:0.017598969861865044, decouple_loss:0.0013709714403375983
WV_0_PC_1_EH_0_PS_40, loss: 0.017982972785830498, avg_mse: 0.025856226682662964
current test mse: 0.025856
Iteration: 271, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45016443729400635, gen p mean: -0.04460025206208229, mean p set: 0.45064473152160645
The modified gen p mean: 0.4522134065628052, gen p mean: -0.04076676070690155, mean p set: 0.45269373059272766
The modified gen p mean: 0.45134252309799194, gen p mean: -0.04299566522240639, mean p set: 0.45182281732559204
loss_pred:0.01801559142768383, decouple_loss:0.0013231879565864801
loss_pred:0.01847795955836773, decouple_loss:0.0012678131461143494
loss_pred:0.017954597249627113, decouple_loss:0.0012138845631852746
Iteration: 272, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4522389769554138, gen p mean: -0.042312026023864746, mean p set: 0.45271924138069153
loss_pred:0.01728787273168564, decouple_loss:0.0012018444249406457
The modified gen p mean: 0.4513815641403198, gen p mean: -0.039382729679346085, mean p set: 0.4518618583679199The modified gen p mean: 0.4523659944534302, gen p mean: -0.043546684086322784, mean p set: 0.45284631848335266
loss_pred:0.017607785761356354, decouple_loss:0.0013273990480229259
loss_pred:0.01766771264374256, decouple_loss:0.0012966111535206437
Iteration: 273, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4516293406486511, gen p mean: -0.04275340959429741, mean p set: 0.45210960507392883
loss_pred:0.017108848318457603, decouple_loss:0.0011830079602077603
The modified gen p mean: 0.4521292448043823, gen p mean: -0.044771958142519, mean p set: 0.45260950922966003The modified gen p mean: 0.45037195086479187, gen p mean: -0.04760492965579033, mean p set: 0.4508522152900696
loss_pred:0.018421322107315063, decouple_loss:0.0012102571781724691
loss_pred:0.0179711002856493, decouple_loss:0.00121627829503268
Iteration: 274, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511075019836426, gen p mean: -0.045990314334630966, mean p set: 0.45158782601356506
loss_pred:0.017880046740174294, decouple_loss:0.0012700189836323261
The modified gen p mean: 0.45236918330192566, gen p mean: -0.04977284371852875, mean p set: 0.45284944772720337The modified gen p mean: 0.4515971839427948, gen p mean: -0.04530995711684227, mean p set: 0.4520774781703949
loss_pred:0.01749170385301113, decouple_loss:0.0012338785454630852
loss_pred:0.017788637429475784, decouple_loss:0.0012256354093551636
Iteration: 275, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4524232745170593, gen p mean: -0.03800257667899132, mean p set: 0.4529035687446594
loss_pred:0.018107235431671143, decouple_loss:0.0012342705158516765
The modified gen p mean: 0.45213136076927185, gen p mean: -0.03909843787550926, mean p set: 0.45261165499687195The modified gen p mean: 0.45230579376220703, gen p mean: -0.037125114351511, mean p set: 0.45278608798980713
loss_pred:0.01892131380736828, decouple_loss:0.0013096589827910066
loss_pred:0.016871564090251923, decouple_loss:0.001227020751684904
Iteration: 276, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45225998759269714, gen p mean: -0.04656841233372688, mean p set: 0.45274025201797485
loss_pred:0.017831260338425636, decouple_loss:0.001089278026483953
The modified gen p mean: 0.45179077982902527, gen p mean: -0.044425029307603836, mean p set: 0.45227110385894775The modified gen p mean: 0.44912242889404297, gen p mean: -0.04169347137212753, mean p set: 0.4496026933193207
loss_pred:0.017906852066516876, decouple_loss:0.0011640366865321994
loss_pred:0.018454860895872116, decouple_loss:0.001121860696002841
Iteration: 277, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4533770680427551, gen p mean: -0.040416378527879715, mean p set: 0.45385733246803284
loss_pred:0.018144389614462852, decouple_loss:0.0011615355033427477
The modified gen p mean: 0.4530324637889862, gen p mean: -0.039468277245759964, mean p set: 0.4535127878189087The modified gen p mean: 0.44985446333885193, gen p mean: -0.04312845692038536, mean p set: 0.450334757566452
loss_pred:0.018268436193466187, decouple_loss:0.0011868767905980349
loss_pred:0.01844828575849533, decouple_loss:0.0011929133906960487
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012006_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012006_3_24hr.npz
NaN value num: 0
Iteration: 278, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4517037868499756, gen p mean: -0.03797806054353714, mean p set: 0.45218411087989807
loss_pred:0.01706470176577568, decouple_loss:0.0012243135133758187
The modified gen p mean: 0.4517109990119934, gen p mean: -0.03668986260890961, mean p set: 0.4521912932395935The modified gen p mean: 0.4490474462509155, gen p mean: -0.04175131395459175, mean p set: 0.4495277404785156
loss_pred:0.01713472232222557, decouple_loss:0.0012281278613954782
loss_pred:0.017340710386633873, decouple_loss:0.0011252694530412555
Iteration: 279, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45187094807624817, gen p mean: -0.04146616533398628, mean p set: 0.45235124230384827
The modified gen p mean: 0.45097821950912476, gen p mean: -0.037719205021858215, mean p set: 0.45145851373672485
The modified gen p mean: 0.44879651069641113, gen p mean: -0.04400705173611641, mean p set: 0.44927680492401123
loss_pred:0.016879204660654068, decouple_loss:0.0010865953518077731
loss_pred:0.01842902973294258, decouple_loss:0.0011649859370663762loss_pred:0.01714683696627617, decouple_loss:0.0012505714548751712
Iteration: 280, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44951415061950684, gen p mean: -0.04748004302382469, mean p set: 0.44999441504478455
The modified gen p mean: 0.45170465111732483, gen p mean: -0.03782425448298454, mean p set: 0.45218491554260254
The modified gen p mean: 0.4501021206378937, gen p mean: -0.04129885882139206, mean p set: 0.4505823850631714
loss_pred:0.01778688095510006, decouple_loss:0.0010612955084070563
loss_pred:0.017089782282710075, decouple_loss:0.0010495127644389868
loss_pred:0.017436087131500244, decouple_loss:0.001114071230404079
2023-04-30 23:23:29 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.05335628241300583, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04770572856068611, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04837450012564659, mean p set: 0.4500633478164673
loss_pred:0.018446169793605804, decouple_loss:0.001250882283784449
loss_pred:0.0173093993216753, decouple_loss:0.0011731681879609823
loss_pred:0.01744063012301922, decouple_loss:0.0011625548359006643
WV_0_PC_1_EH_0_PS_40, loss: 0.01779184490442276, avg_mse: 0.02552000619471073
current test mse: 0.02552
Iteration: 281, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4517773687839508, gen p mean: -0.04017956182360649, mean p set: 0.4522576630115509
The modified gen p mean: 0.4515303373336792, gen p mean: -0.04104163870215416, mean p set: 0.4520106315612793
The modified gen p mean: 0.4518933594226837, gen p mean: -0.03739611431956291, mean p set: 0.4523736536502838
loss_pred:0.01654229126870632, decouple_loss:0.0011797709157690406
loss_pred:0.01646633818745613, decouple_loss:0.0011311578564345837
loss_pred:0.016547290608286858, decouple_loss:0.0012165965745225549
Iteration: 282, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45043501257896423, gen p mean: -0.041084639728069305, mean p set: 0.45091530680656433
The modified gen p mean: 0.44799908995628357, gen p mean: -0.04843240603804588, mean p set: 0.44847941398620605
loss_pred:0.01687202788889408, decouple_loss:0.0011177638079971075
loss_pred:0.016896529123187065, decouple_loss:0.0011519190156832337
The modified gen p mean: 0.44932815432548523, gen p mean: -0.044194404035806656, mean p set: 0.4498084783554077
loss_pred:0.01747913658618927, decouple_loss:0.0010444833897054195
Iteration: 283, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45159855484962463, gen p mean: -0.03662076219916344, mean p set: 0.45207884907722473
loss_pred:0.01653994619846344, decouple_loss:0.00105457310564816
The modified gen p mean: 0.4522525668144226, gen p mean: -0.04383717477321625, mean p set: 0.4527328312397003The modified gen p mean: 0.45030251145362854, gen p mean: -0.038211390376091, mean p set: 0.45078280568122864
loss_pred:0.016329674050211906, decouple_loss:0.0010072917211800814
loss_pred:0.01718849316239357, decouple_loss:0.001053844578564167
Iteration: 284, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514516294002533, gen p mean: -0.0433008149266243, mean p set: 0.4519319236278534
loss_pred:0.016712849959731102, decouple_loss:0.0011804106179624796
The modified gen p mean: 0.45113933086395264, gen p mean: -0.03900202736258507, mean p set: 0.45161959528923035The modified gen p mean: 0.4511168301105499, gen p mean: -0.0433981828391552, mean p set: 0.4515971541404724
loss_pred:0.01735503040254116, decouple_loss:0.0011169284116476774
loss_pred:0.016520092263817787, decouple_loss:0.0010558429639786482
Iteration: 285, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494708776473999, gen p mean: -0.04761103168129921, mean p set: 0.449951171875
loss_pred:0.01774580217897892, decouple_loss:0.0011263821506872773
The modified gen p mean: 0.451058030128479, gen p mean: -0.04457126557826996, mean p set: 0.4515382945537567The modified gen p mean: 0.4490896165370941, gen p mean: -0.04809693247079849, mean p set: 0.4495699107646942
loss_pred:0.016263989731669426, decouple_loss:0.0010425535729154944
loss_pred:0.01764819584786892, decouple_loss:0.0011054519563913345
Iteration: 286, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45136773586273193, gen p mean: -0.045732419937849045, mean p set: 0.45184803009033203
loss_pred:0.016480758786201477, decouple_loss:0.001133639132604003
The modified gen p mean: 0.4515560567378998, gen p mean: -0.045000359416007996, mean p set: 0.45203638076782227The modified gen p mean: 0.4482744038105011, gen p mean: -0.0509028434753418, mean p set: 0.4487546980381012
loss_pred:0.01708819344639778, decouple_loss:0.0011456531938165426
loss_pred:0.01592402532696724, decouple_loss:0.0010346226627007127
Iteration: 287, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508572220802307, gen p mean: -0.03874276950955391, mean p set: 0.4513375163078308
loss_pred:0.016905536875128746, decouple_loss:0.001197364181280136
The modified gen p mean: 0.4509863555431366, gen p mean: -0.03954475745558739, mean p set: 0.4514666199684143The modified gen p mean: 0.4493485689163208, gen p mean: -0.04832129552960396, mean p set: 0.4498288631439209
loss_pred:0.017211299389600754, decouple_loss:0.0010969628347083926
loss_pred:0.017317429184913635, decouple_loss:0.001169541385024786
Iteration: 288, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514239430427551, gen p mean: -0.04281074181199074, mean p set: 0.4519042372703552
loss_pred:0.016684792935848236, decouple_loss:0.0010167675791308284
The modified gen p mean: 0.4508605897426605, gen p mean: -0.045514218509197235, mean p set: 0.4513408839702606The modified gen p mean: 0.4516501724720001, gen p mean: -0.039182066917419434, mean p set: 0.4521304666996002
loss_pred:0.016198398545384407, decouple_loss:0.0011053485795855522
loss_pred:0.017047928646206856, decouple_loss:0.0010233790380880237
Iteration: 289, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45099201798439026, gen p mean: -0.04287601262331009, mean p set: 0.45147234201431274
loss_pred:0.016285154968500137, decouple_loss:0.0010262514697387815
The modified gen p mean: 0.4489649832248688, gen p mean: -0.04632621631026268, mean p set: 0.44944530725479126The modified gen p mean: 0.4516366422176361, gen p mean: -0.04199237748980522, mean p set: 0.4521169364452362
loss_pred:0.016314581036567688, decouple_loss:0.0010847777593880892
loss_pred:0.016278812661767006, decouple_loss:0.001032368396408856
Iteration: 290, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45150136947631836, gen p mean: -0.044711045920848846, mean p set: 0.45198163390159607
loss_pred:0.01706266961991787, decouple_loss:0.0010223627323284745
The modified gen p mean: 0.45100700855255127, gen p mean: -0.041442688554525375, mean p set: 0.45148730278015137The modified gen p mean: 0.44807472825050354, gen p mean: -0.047194886952638626, mean p set: 0.44855502247810364
loss_pred:0.01626833714544773, decouple_loss:0.0010168645530939102
loss_pred:0.016863469034433365, decouple_loss:0.0010854190913960338
2023-04-30 23:25:23 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.05505911260843277, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04926304891705513, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.04994902387261391, mean p set: 0.4500633478164673
loss_pred:0.018414078280329704, decouple_loss:0.001174728386104107
loss_pred:0.01729549467563629, decouple_loss:0.0011346546234562993
loss_pred:0.01744825765490532, decouple_loss:0.0011335235321894288
WV_0_PC_1_EH_0_PS_40, loss: 0.01777666062116623, avg_mse: 0.02549978718161583
current test mse: 0.0255
Iteration: 291, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45071345567703247, gen p mean: -0.0380912646651268, mean p set: 0.45119374990463257
The modified gen p mean: 0.45198434591293335, gen p mean: -0.043259620666503906, mean p set: 0.45246466994285583
The modified gen p mean: 0.4509750008583069, gen p mean: -0.03876417130231857, mean p set: 0.451455295085907
loss_pred:0.01684803143143654, decouple_loss:0.001105886185541749
loss_pred:0.01721380278468132, decouple_loss:0.0011675457935780287
loss_pred:0.015867844223976135, decouple_loss:0.000982592231594026
Iteration: 292, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499015808105469, gen p mean: -0.0451621487736702, mean p set: 0.45038190484046936
The modified gen p mean: 0.44935938715934753, gen p mean: -0.045619383454322815, mean p set: 0.44983968138694763
loss_pred:0.01687491685152054, decouple_loss:0.0010451753623783588
loss_pred:0.016201630234718323, decouple_loss:0.0010403752094134688
The modified gen p mean: 0.44800442457199097, gen p mean: -0.050162095576524734, mean p set: 0.44848471879959106
loss_pred:0.016710780560970306, decouple_loss:0.0010688476031646132
Iteration: 293, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511788487434387, gen p mean: -0.04057398810982704, mean p set: 0.45165911316871643The modified gen p mean: 0.44998079538345337, gen p mean: -0.04988662153482437, mean p set: 0.4504610598087311
loss_pred:0.01683281920850277, decouple_loss:0.001103249262087047
loss_pred:0.017025522887706757, decouple_loss:0.001133245648816228
The modified gen p mean: 0.44980132579803467, gen p mean: -0.04361831396818161, mean p set: 0.45028162002563477
loss_pred:0.017545828595757484, decouple_loss:0.0012613978469744325
Iteration: 294, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44996964931488037, gen p mean: -0.04553313925862312, mean p set: 0.45044994354248047
The modified gen p mean: 0.4486517608165741, gen p mean: -0.04660749435424805, mean p set: 0.4491320550441742
loss_pred:0.01605960726737976, decouple_loss:0.0010259944247081876
loss_pred:0.016901543363928795, decouple_loss:0.0009940438903868198
The modified gen p mean: 0.45163416862487793, gen p mean: -0.037490200251340866, mean p set: 0.452114462852478
loss_pred:0.016847368329763412, decouple_loss:0.0011443296680226922
Iteration: 295, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500167667865753, gen p mean: -0.048439715057611465, mean p set: 0.4504970610141754
The modified gen p mean: 0.4495141804218292, gen p mean: -0.047489095479249954, mean p set: 0.4499944746494293
loss_pred:0.017157617956399918, decouple_loss:0.001067810459062457
loss_pred:0.017011471092700958, decouple_loss:0.0010450865374878049
The modified gen p mean: 0.4504876732826233, gen p mean: -0.03936767578125, mean p set: 0.4509679973125458
loss_pred:0.017430121079087257, decouple_loss:0.0011350048007443547
Iteration: 296, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513588547706604, gen p mean: -0.03684842586517334, mean p set: 0.4518391489982605
loss_pred:0.016685670241713524, decouple_loss:0.0009748596348799765
The modified gen p mean: 0.44925743341445923, gen p mean: -0.04287179186940193, mean p set: 0.4497377276420593The modified gen p mean: 0.4492376148700714, gen p mean: -0.045660607516765594, mean p set: 0.4497178792953491
loss_pred:0.016451021656394005, decouple_loss:0.0011160223511978984
loss_pred:0.017021406441926956, decouple_loss:0.0010211649350821972
Iteration: 297, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45063233375549316, gen p mean: -0.03655517101287842, mean p set: 0.45111262798309326
loss_pred:0.01625906676054001, decouple_loss:0.0010907102841883898
The modified gen p mean: 0.45128822326660156, gen p mean: -0.03302375599741936, mean p set: 0.4517684876918793The modified gen p mean: 0.4517100155353546, gen p mean: -0.03829292953014374, mean p set: 0.4521903395652771
loss_pred:0.01664748787879944, decouple_loss:0.0010280131828039885
loss_pred:0.017041562125086784, decouple_loss:0.0011038949014618993
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012012_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012012_3_24hr.npz
NaN value num: 0
Iteration: 298, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44972747564315796, gen p mean: -0.047042906284332275, mean p set: 0.45020779967308044
loss_pred:0.016990745440125465, decouple_loss:0.0010786819038912654
The modified gen p mean: 0.44955775141716003, gen p mean: -0.0544932596385479, mean p set: 0.45003804564476013The modified gen p mean: 0.45086926221847534, gen p mean: -0.051254935562610626, mean p set: 0.45134952664375305
loss_pred:0.016726775094866753, decouple_loss:0.0010351745877414942
loss_pred:0.017807461321353912, decouple_loss:0.0010644674766808748
Iteration: 299, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500582218170166, gen p mean: -0.04404580593109131, mean p set: 0.4505384862422943
loss_pred:0.016872551292181015, decouple_loss:0.000995743554085493
The modified gen p mean: 0.44856002926826477, gen p mean: -0.04587259143590927, mean p set: 0.44904032349586487The modified gen p mean: 0.4490213990211487, gen p mean: -0.0478459857404232, mean p set: 0.4495016634464264
loss_pred:0.017325472086668015, decouple_loss:0.0010321128647774458
loss_pred:0.01797724887728691, decouple_loss:0.0010588981676846743
Iteration: 300, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4525958001613617, gen p mean: -0.04367045685648918, mean p set: 0.4530760943889618
The modified gen p mean: 0.4498851001262665, gen p mean: -0.044483184814453125, mean p set: 0.4503653943538666
loss_pred:0.015506215393543243, decouple_loss:0.0011581428116187453
loss_pred:0.01694452203810215, decouple_loss:0.0011445306008681655
The modified gen p mean: 0.4488624334335327, gen p mean: -0.04360166937112808, mean p set: 0.4493427276611328
loss_pred:0.01754346676170826, decouple_loss:0.0010846751974895597
2023-04-30 23:29:01 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.04909722879528999, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04375382885336876, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.044111769646406174, mean p set: 0.4500633478164673
loss_pred:0.01844390667974949, decouple_loss:0.001185405533760786
loss_pred:0.01733376644551754, decouple_loss:0.001191232819110155
loss_pred:0.017430497333407402, decouple_loss:0.0011648734798654914
WV_0_PC_1_EH_0_PS_40, loss: 0.017795082181692123, avg_mse: 0.02553333155810833
current test mse: 0.025533
Iteration: 301, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4510343670845032, gen p mean: -0.04338546469807625, mean p set: 0.45151469111442566
The modified gen p mean: 0.45197778940200806, gen p mean: -0.04383473098278046, mean p set: 0.45245808362960815
The modified gen p mean: 0.45196977257728577, gen p mean: -0.04362957552075386, mean p set: 0.45245006680488586
loss_pred:0.01611952669918537, decouple_loss:0.0011208930518478155
loss_pred:0.017047621309757233, decouple_loss:0.0011043999111279845
loss_pred:0.01572970673441887, decouple_loss:0.0011096308007836342
Iteration: 302, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45025256276130676, gen p mean: -0.04245704784989357, mean p set: 0.4507328271865845
loss_pred:0.016628596931695938, decouple_loss:0.0011395827168598771
The modified gen p mean: 0.4500754475593567, gen p mean: -0.042870599776506424, mean p set: 0.4505557417869568The modified gen p mean: 0.4494932293891907, gen p mean: -0.04486972466111183, mean p set: 0.4499734938144684
loss_pred:0.016881026327610016, decouple_loss:0.00104875850956887
loss_pred:0.017478063702583313, decouple_loss:0.0010895529994741082
Iteration: 303, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493951201438904, gen p mean: -0.04289204999804497, mean p set: 0.4498754143714905
loss_pred:0.017401743680238724, decouple_loss:0.0009868755005300045
The modified gen p mean: 0.45205244421958923, gen p mean: -0.043706607073545456, mean p set: 0.45253270864486694The modified gen p mean: 0.4504432678222656, gen p mean: -0.04810318350791931, mean p set: 0.4509235620498657
loss_pred:0.017038453370332718, decouple_loss:0.0010034807492047548
loss_pred:0.016762634739279747, decouple_loss:0.0010252112988382578
Iteration: 304, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45041948556900024, gen p mean: -0.04582858085632324, mean p set: 0.45089974999427795
loss_pred:0.016281472519040108, decouple_loss:0.0010149616282433271
The modified gen p mean: 0.45289766788482666, gen p mean: -0.047163598239421844, mean p set: 0.45337799191474915The modified gen p mean: 0.449384868144989, gen p mean: -0.0463196262717247, mean p set: 0.4498651623725891
loss_pred:0.015730375424027443, decouple_loss:0.0010923496447503567
loss_pred:0.017412638291716576, decouple_loss:0.001010315609164536
Iteration: 305, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4509352147579193, gen p mean: -0.045612968504428864, mean p set: 0.4514155089855194
loss_pred:0.016326500102877617, decouple_loss:0.0009632448782213032
The modified gen p mean: 0.45035654306411743, gen p mean: -0.046427320688962936, mean p set: 0.4508368670940399The modified gen p mean: 0.4487227201461792, gen p mean: -0.05210825428366661, mean p set: 0.4492030143737793
loss_pred:0.01621883548796177, decouple_loss:0.0009898953139781952
loss_pred:0.017346646636724472, decouple_loss:0.0011587284971028566
Iteration: 306, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501848816871643, gen p mean: -0.054110050201416016, mean p set: 0.450665146112442
loss_pred:0.016344238072633743, decouple_loss:0.0011429442092776299
The modified gen p mean: 0.44932544231414795, gen p mean: -0.05399199575185776, mean p set: 0.44980570673942566The modified gen p mean: 0.45028501749038696, gen p mean: -0.04454488679766655, mean p set: 0.4507652819156647
loss_pred:0.01661844179034233, decouple_loss:0.0010606287978589535
loss_pred:0.01695960760116577, decouple_loss:0.0010746055049821734
Iteration: 307, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500119090080261, gen p mean: -0.04569217935204506, mean p set: 0.4504922032356262
loss_pred:0.01690593548119068, decouple_loss:0.000987890874966979
The modified gen p mean: 0.45110011100769043, gen p mean: -0.045708198100328445, mean p set: 0.4515804052352905The modified gen p mean: 0.4505613148212433, gen p mean: -0.04759710282087326, mean p set: 0.45104163885116577
loss_pred:0.01625177077949047, decouple_loss:0.001050662132911384
loss_pred:0.016723569482564926, decouple_loss:0.0010457654716446996
Iteration: 308, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44808024168014526, gen p mean: -0.04747636988759041, mean p set: 0.44856053590774536
loss_pred:0.017595306038856506, decouple_loss:0.0011408873833715916
The modified gen p mean: 0.4499675929546356, gen p mean: -0.04507801681756973, mean p set: 0.4504478871822357The modified gen p mean: 0.45283302664756775, gen p mean: -0.04488307610154152, mean p set: 0.45331335067749023
loss_pred:0.017003584653139114, decouple_loss:0.000970113615039736
loss_pred:0.015550384297966957, decouple_loss:0.0010654244106262922
Iteration: 309, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493483006954193, gen p mean: -0.038642145693302155, mean p set: 0.449828565120697
loss_pred:0.017144234851002693, decouple_loss:0.0009606442181393504
The modified gen p mean: 0.4490398168563843, gen p mean: -0.043465953320264816, mean p set: 0.4495201110839844The modified gen p mean: 0.4506535530090332, gen p mean: -0.04188048094511032, mean p set: 0.4511338472366333
loss_pred:0.01676035113632679, decouple_loss:0.0009902110323309898
loss_pred:0.016403447836637497, decouple_loss:0.0009257307392545044
Iteration: 310, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485224783420563, gen p mean: -0.04430459812283516, mean p set: 0.44900277256965637
The modified gen p mean: 0.4498934745788574, gen p mean: -0.041278667747974396, mean p set: 0.45037373900413513
loss_pred:0.017349841073155403, decouple_loss:0.0010063749505206943
loss_pred:0.016455743461847305, decouple_loss:0.0009767006849870086
The modified gen p mean: 0.45013418793678284, gen p mean: -0.041814856231212616, mean p set: 0.45061448216438293
loss_pred:0.01641470193862915, decouple_loss:0.0009242111118510365
2023-04-30 23:30:54 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.044840630143880844, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.039680350571870804, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.04008733481168747, mean p set: 0.4500633478164673
loss_pred:0.018484966829419136, decouple_loss:0.001137946150265634
loss_pred:0.01734110340476036, decouple_loss:0.0011050498578697443
loss_pred:0.017405783757567406, decouple_loss:0.0011124216252937913
WV_0_PC_1_EH_0_PS_40, loss: 0.017799874767661095, avg_mse: 0.025552652776241302
current test mse: 0.025553
Iteration: 311, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44982409477233887, gen p mean: -0.03902673348784447, mean p set: 0.45030441880226135
The modified gen p mean: 0.45044654607772827, gen p mean: -0.03962404280900955, mean p set: 0.45092687010765076
The modified gen p mean: 0.4495936632156372, gen p mean: -0.036244094371795654, mean p set: 0.4500739574432373
loss_pred:0.016376657411456108, decouple_loss:0.0009717970970086753
loss_pred:0.016750195994973183, decouple_loss:0.0009548062807880342
loss_pred:0.016414126381278038, decouple_loss:0.001014451845549047
Iteration: 312, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45101550221443176, gen p mean: -0.03904806450009346, mean p set: 0.45149579644203186
loss_pred:0.016684677451848984, decouple_loss:0.0009665214456617832
The modified gen p mean: 0.44985833764076233, gen p mean: -0.04188363999128342, mean p set: 0.4503386318683624The modified gen p mean: 0.4495698809623718, gen p mean: -0.03834431990981102, mean p set: 0.4500502049922943
loss_pred:0.016687292605638504, decouple_loss:0.0009353152709081769
loss_pred:0.01738806441426277, decouple_loss:0.0009738177177496254
Iteration: 313, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449357271194458, gen p mean: -0.040915559977293015, mean p set: 0.4498375654220581
loss_pred:0.01700262725353241, decouple_loss:0.0009966674260795116
The modified gen p mean: 0.4533085525035858, gen p mean: -0.035719409584999084, mean p set: 0.4537888467311859The modified gen p mean: 0.45049503445625305, gen p mean: -0.03893221542239189, mean p set: 0.45097532868385315
loss_pred:0.0163265448063612, decouple_loss:0.0010082944063469768
loss_pred:0.016135049983859062, decouple_loss:0.0010318502318114042
Iteration: 314, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481806755065918, gen p mean: -0.04451052471995354, mean p set: 0.4486609697341919
loss_pred:0.01687466911971569, decouple_loss:0.0009522393229417503
The modified gen p mean: 0.45188695192337036, gen p mean: -0.04434692859649658, mean p set: 0.45236724615097046The modified gen p mean: 0.4527561664581299, gen p mean: -0.03855278342962265, mean p set: 0.45323646068573
loss_pred:0.016482630744576454, decouple_loss:0.0009811855852603912
loss_pred:0.01567443087697029, decouple_loss:0.0009235652978532016
Iteration: 315, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45251452922821045, gen p mean: -0.042392298579216, mean p set: 0.45299485325813293
loss_pred:0.016250476241111755, decouple_loss:0.0009772073244675994
The modified gen p mean: 0.45096859335899353, gen p mean: -0.04883154109120369, mean p set: 0.45144885778427124The modified gen p mean: 0.4485822319984436, gen p mean: -0.04578809440135956, mean p set: 0.4490624964237213
loss_pred:0.016841638833284378, decouple_loss:0.0010226998711004853
loss_pred:0.01715228520333767, decouple_loss:0.0009740091627463698
Iteration: 316, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45071595907211304, gen p mean: -0.050750549882650375, mean p set: 0.45119625329971313
loss_pred:0.01734430529177189, decouple_loss:0.000986644416116178
The modified gen p mean: 0.45096173882484436, gen p mean: -0.04817323386669159, mean p set: 0.45144200325012207The modified gen p mean: 0.4524904787540436, gen p mean: -0.04629087448120117, mean p set: 0.4529707729816437
loss_pred:0.01598045788705349, decouple_loss:0.0009793954668566585
loss_pred:0.016661355271935463, decouple_loss:0.0009476874256506562
Iteration: 317, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44967761635780334, gen p mean: -0.04623829945921898, mean p set: 0.45015794038772583
loss_pred:0.01697898656129837, decouple_loss:0.0009248457499779761
The modified gen p mean: 0.4529532790184021, gen p mean: -0.040705032646656036, mean p set: 0.4534335732460022The modified gen p mean: 0.4483598470687866, gen p mean: -0.047866642475128174, mean p set: 0.4488401710987091
loss_pred:0.015500541776418686, decouple_loss:0.0009408940095454454
loss_pred:0.016729408875107765, decouple_loss:0.0010240449337288737
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012013_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012013_3_24hr.npz
NaN value num: 0
Iteration: 318, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44747990369796753, gen p mean: -0.0434739887714386, mean p set: 0.4479601979255676
loss_pred:0.015981556847691536, decouple_loss:0.00107811379712075
The modified gen p mean: 0.448612242937088, gen p mean: -0.04261637106537819, mean p set: 0.4490925371646881The modified gen p mean: 0.44968754053115845, gen p mean: -0.03153616562485695, mean p set: 0.45016783475875854
loss_pred:0.017098311334848404, decouple_loss:0.0011497823288664222
loss_pred:0.01648268848657608, decouple_loss:0.0011620752047747374
Iteration: 319, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44774141907691956, gen p mean: -0.033057618886232376, mean p set: 0.44822174310684204
loss_pred:0.017983056604862213, decouple_loss:0.0010438556782901287
The modified gen p mean: 0.45010942220687866, gen p mean: -0.03854745253920555, mean p set: 0.45058971643447876The modified gen p mean: 0.44839757680892944, gen p mean: -0.03811831772327423, mean p set: 0.44887787103652954
loss_pred:0.017571333795785904, decouple_loss:0.0010445229709148407
loss_pred:0.01635945402085781, decouple_loss:0.0010430790716782212
Iteration: 320, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484219253063202, gen p mean: -0.03565601631999016, mean p set: 0.4489021897315979
loss_pred:0.01712934859097004, decouple_loss:0.0010165455751121044
The modified gen p mean: 0.44752296805381775, gen p mean: -0.0405094213783741, mean p set: 0.44800323247909546The modified gen p mean: 0.4498848617076874, gen p mean: -0.039485979825258255, mean p set: 0.4503651261329651
loss_pred:0.017218437045812607, decouple_loss:0.0010496906470507383
loss_pred:0.01708007976412773, decouple_loss:0.0010383049957454205
2023-04-30 23:33:55 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.05075109750032425, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04494357481598854, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.045736346393823624, mean p set: 0.4500633478164673
loss_pred:0.018460210412740707, decouple_loss:0.0010421114275231957
loss_pred:0.017274055629968643, decouple_loss:0.001126750954426825
loss_pred:0.017407622188329697, decouple_loss:0.0010541011579334736
WV_0_PC_1_EH_0_PS_40, loss: 0.017767678946256638, avg_mse: 0.025472430512309074
current test mse: 0.025472
Iteration: 321, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44778189063072205, gen p mean: -0.03722907602787018, mean p set: 0.44826221466064453
The modified gen p mean: 0.44740962982177734, gen p mean: -0.04197286069393158, mean p set: 0.44788995385169983
The modified gen p mean: 0.45040223002433777, gen p mean: -0.037685297429561615, mean p set: 0.45088252425193787
loss_pred:0.016978712752461433, decouple_loss:0.001014124951325357
loss_pred:0.017517782747745514, decouple_loss:0.0009738415828906
loss_pred:0.016281675547361374, decouple_loss:0.0010609872406348586
Iteration: 322, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44726619124412537, gen p mean: -0.04267974942922592, mean p set: 0.44774648547172546
The modified gen p mean: 0.44942229986190796, gen p mean: -0.042424220591783524, mean p set: 0.44990259408950806
loss_pred:0.015946164727211, decouple_loss:0.0010231080232188106
loss_pred:0.016838137060403824, decouple_loss:0.0009824526496231556The modified gen p mean: 0.4502808153629303, gen p mean: -0.040194012224674225, mean p set: 0.4507611393928528
loss_pred:0.017179735004901886, decouple_loss:0.0010734978131949902
Iteration: 323, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44734182953834534, gen p mean: -0.040742747485637665, mean p set: 0.44782212376594543
The modified gen p mean: 0.4471459686756134, gen p mean: -0.045450709760189056, mean p set: 0.4476262331008911loss_pred:0.01714642345905304, decouple_loss:0.0011178447166457772
The modified gen p mean: 0.4497023820877075, gen p mean: -0.03590453416109085, mean p set: 0.4501826763153076
loss_pred:0.01581105962395668, decouple_loss:0.0010146687272936106
loss_pred:0.015888717025518417, decouple_loss:0.0011294845025986433
Iteration: 324, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502868950366974, gen p mean: -0.03886009752750397, mean p set: 0.4507671892642975
loss_pred:0.017045876011252403, decouple_loss:0.0010656500235199928
The modified gen p mean: 0.4481179416179657, gen p mean: -0.0393141508102417, mean p set: 0.4485982656478882The modified gen p mean: 0.45007219910621643, gen p mean: -0.04126451909542084, mean p set: 0.45055249333381653
loss_pred:0.017857816070318222, decouple_loss:0.0010313804959878325
loss_pred:0.016008775681257248, decouple_loss:0.0010263249278068542
Iteration: 325, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503134489059448, gen p mean: -0.040136002004146576, mean p set: 0.4507937431335449
loss_pred:0.01632564328610897, decouple_loss:0.0010689824121072888
The modified gen p mean: 0.44859418272972107, gen p mean: -0.045098885893821716, mean p set: 0.4490744471549988The modified gen p mean: 0.4507507383823395, gen p mean: -0.041018929332494736, mean p set: 0.4512310028076172
loss_pred:0.016782473772764206, decouple_loss:0.0009267110144719481
loss_pred:0.0158259104937315, decouple_loss:0.000965320912655443
Iteration: 326, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45012199878692627, gen p mean: -0.044492825865745544, mean p set: 0.45060229301452637
loss_pred:0.0162187609821558, decouple_loss:0.0010209705214947462
The modified gen p mean: 0.45013856887817383, gen p mean: -0.04051339998841286, mean p set: 0.4506188929080963The modified gen p mean: 0.4481813609600067, gen p mean: -0.040601879358291626, mean p set: 0.4486616849899292
loss_pred:0.01638813689351082, decouple_loss:0.0010562881361693144
loss_pred:0.01776530034840107, decouple_loss:0.0010902226204052567
Iteration: 327, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505457878112793, gen p mean: -0.03801633045077324, mean p set: 0.4510261118412018
loss_pred:0.016033239662647247, decouple_loss:0.000974925875198096
The modified gen p mean: 0.45023879408836365, gen p mean: -0.039100613445043564, mean p set: 0.45071908831596375The modified gen p mean: 0.4500086307525635, gen p mean: -0.03575213626027107, mean p set: 0.4504888951778412
loss_pred:0.01703583635389805, decouple_loss:0.0010363833280280232
loss_pred:0.01585162617266178, decouple_loss:0.0010130911832675338
Iteration: 328, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4506209194660187, gen p mean: -0.035478945821523666, mean p set: 0.4511011838912964
loss_pred:0.016836117953062057, decouple_loss:0.0009981420589610934
The modified gen p mean: 0.4473850131034851, gen p mean: -0.035478413105010986, mean p set: 0.4478653073310852The modified gen p mean: 0.44900307059288025, gen p mean: -0.03794717416167259, mean p set: 0.44948336482048035
loss_pred:0.01719268225133419, decouple_loss:0.0009960924508050084
loss_pred:0.017563607543706894, decouple_loss:0.0009839629055932164
Iteration: 329, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44859281182289124, gen p mean: -0.03542749583721161, mean p set: 0.44907310605049133
loss_pred:0.016896624118089676, decouple_loss:0.0009870206704363227
The modified gen p mean: 0.44965460896492004, gen p mean: -0.03210777789354324, mean p set: 0.45013487339019775The modified gen p mean: 0.45033779740333557, gen p mean: -0.035643961280584335, mean p set: 0.45081809163093567
loss_pred:0.01679255999624729, decouple_loss:0.0009779356187209487
loss_pred:0.016485143452882767, decouple_loss:0.0010031260317191482
Iteration: 330, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450177401304245, gen p mean: -0.03714706003665924, mean p set: 0.4506576955318451
The modified gen p mean: 0.44847986102104187, gen p mean: -0.03404524549841881, mean p set: 0.44896015524864197
loss_pred:0.016536619514226913, decouple_loss:0.0009890558430925012
loss_pred:0.017521202564239502, decouple_loss:0.0009615684393793344
The modified gen p mean: 0.44833797216415405, gen p mean: -0.03545062988996506, mean p set: 0.44881829619407654
loss_pred:0.017315750941634178, decouple_loss:0.0009467717027291656
2023-04-30 23:35:48 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.048550453037023544, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04277113080024719, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04357451573014259, mean p set: 0.4500633478164673
loss_pred:0.018539536744356155, decouple_loss:0.0011293954448774457
loss_pred:0.017308510839939117, decouple_loss:0.0010653419885784388
loss_pred:0.017500964924693108, decouple_loss:0.0010642374400049448
WV_0_PC_1_EH_0_PS_40, loss: 0.017837321385741234, avg_mse: 0.025642087683081627
current test mse: 0.025642
Iteration: 331, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449121356010437, gen p mean: -0.03957044333219528, mean p set: 0.4496016502380371
The modified gen p mean: 0.44778764247894287, gen p mean: -0.04117622226476669, mean p set: 0.4482679069042206
The modified gen p mean: 0.45063212513923645, gen p mean: -0.03566440939903259, mean p set: 0.45111238956451416
loss_pred:0.01728743687272072, decouple_loss:0.0011192196980118752
loss_pred:0.017197132110595703, decouple_loss:0.0010372608667239547
loss_pred:0.016847552731633186, decouple_loss:0.0010452688438817859
Iteration: 332, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489588439464569, gen p mean: -0.04179048538208008, mean p set: 0.449439138174057
loss_pred:0.01683792658150196, decouple_loss:0.0009223615052178502
The modified gen p mean: 0.44817742705345154, gen p mean: -0.03819260373711586, mean p set: 0.44865772128105164The modified gen p mean: 0.45001158118247986, gen p mean: -0.043006762862205505, mean p set: 0.45049184560775757
loss_pred:0.016651133075356483, decouple_loss:0.001020375406369567
loss_pred:0.01727593131363392, decouple_loss:0.0009408679907210171
Iteration: 333, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478376805782318, gen p mean: -0.040913406759500504, mean p set: 0.4483179748058319
loss_pred:0.016917508095502853, decouple_loss:0.0010252873180434108
The modified gen p mean: 0.44850990176200867, gen p mean: -0.043648988008499146, mean p set: 0.44899022579193115The modified gen p mean: 0.44791412353515625, gen p mean: -0.041932113468647, mean p set: 0.44839444756507874
loss_pred:0.015938643366098404, decouple_loss:0.0009813647484406829
loss_pred:0.01660272292792797, decouple_loss:0.0010146842105314136
Iteration: 334, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498419165611267, gen p mean: -0.03780427575111389, mean p set: 0.4503222107887268
The modified gen p mean: 0.4498549699783325, gen p mean: -0.03215249255299568, mean p set: 0.45033523440361023
loss_pred:0.01684955321252346, decouple_loss:0.0009664659737609327
loss_pred:0.01686829701066017, decouple_loss:0.001016212278045714
The modified gen p mean: 0.44976675510406494, gen p mean: -0.03729213401675224, mean p set: 0.4502470791339874
loss_pred:0.01734451949596405, decouple_loss:0.0009471792145632207
Iteration: 335, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478347897529602, gen p mean: -0.03692327067255974, mean p set: 0.4483151137828827
loss_pred:0.017000211402773857, decouple_loss:0.0009807207388803363
The modified gen p mean: 0.44746989011764526, gen p mean: -0.03814828023314476, mean p set: 0.447950154542923The modified gen p mean: 0.447441041469574, gen p mean: -0.038204606622457504, mean p set: 0.4479213356971741
loss_pred:0.01664566434919834, decouple_loss:0.0009761403198353946
loss_pred:0.016061296686530113, decouple_loss:0.0009734693448990583
Iteration: 336, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44818419218063354, gen p mean: -0.03985575959086418, mean p set: 0.44866451621055603
loss_pred:0.016384003683924675, decouple_loss:0.0009740705136209726
The modified gen p mean: 0.44838863611221313, gen p mean: -0.03816929832100868, mean p set: 0.44886893033981323The modified gen p mean: 0.45067405700683594, gen p mean: -0.0353676863014698, mean p set: 0.45115435123443604
loss_pred:0.017184462398290634, decouple_loss:0.0009625416132621467
loss_pred:0.016877321526408195, decouple_loss:0.0010208745952695608
Iteration: 337, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500276744365692, gen p mean: -0.03618136793375015, mean p set: 0.4505079984664917
loss_pred:0.0160627793520689, decouple_loss:0.0010614156490191817
The modified gen p mean: 0.4483879804611206, gen p mean: -0.03663826733827591, mean p set: 0.4488682746887207The modified gen p mean: 0.4498942792415619, gen p mean: -0.03526026010513306, mean p set: 0.4503746032714844
loss_pred:0.016178065910935402, decouple_loss:0.0010896765161305666
loss_pred:0.01677006110548973, decouple_loss:0.0010203683050349355
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012011_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012011_3_24hr.npz
NaN value num: 0
Iteration: 338, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.452358216047287, gen p mean: -0.037003789097070694, mean p set: 0.4528384804725647
loss_pred:0.017008330672979355, decouple_loss:0.001171908457763493
The modified gen p mean: 0.4527861773967743, gen p mean: -0.03909767419099808, mean p set: 0.4532664716243744The modified gen p mean: 0.4538688063621521, gen p mean: -0.043602146208286285, mean p set: 0.4543490707874298
loss_pred:0.017163371667265892, decouple_loss:0.0010232081403955817
loss_pred:0.016986431553959846, decouple_loss:0.001089723315089941
Iteration: 339, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505113959312439, gen p mean: -0.033686768263578415, mean p set: 0.4509917199611664
loss_pred:0.01708412356674671, decouple_loss:0.001142387161962688
The modified gen p mean: 0.4521077275276184, gen p mean: -0.03709546849131584, mean p set: 0.4525880217552185The modified gen p mean: 0.451873779296875, gen p mean: -0.03837371617555618, mean p set: 0.4523541033267975
loss_pred:0.01712413690984249, decouple_loss:0.0010283926967531443
loss_pred:0.016888296231627464, decouple_loss:0.0010178160155192018
Iteration: 340, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44893988966941833, gen p mean: -0.04142622649669647, mean p set: 0.44942015409469604
loss_pred:0.017738763242959976, decouple_loss:0.001177539466880262
The modified gen p mean: 0.4505225718021393, gen p mean: -0.030507994815707207, mean p set: 0.4510028660297394The modified gen p mean: 0.449347585439682, gen p mean: -0.03741268813610077, mean p set: 0.4498278796672821
loss_pred:0.016984084621071815, decouple_loss:0.0010927035473287106
loss_pred:0.017937278375029564, decouple_loss:0.0010715671814978123
2023-04-30 23:38:38 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.04344843700528145, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.03805089741945267, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.03866279870271683, mean p set: 0.4500633478164673
loss_pred:0.01851740851998329, decouple_loss:0.0011188930366188288
loss_pred:0.017338842153549194, decouple_loss:0.0011147235054522753
loss_pred:0.017560113221406937, decouple_loss:0.0011052556801587343
WV_0_PC_1_EH_0_PS_40, loss: 0.017861103639006615, avg_mse: 0.025654548779129982
current test mse: 0.025655
Iteration: 341, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45263224840164185, gen p mean: -0.03526898846030235, mean p set: 0.45311251282691956
The modified gen p mean: 0.4536969065666199, gen p mean: -0.033953674137592316, mean p set: 0.45417720079421997
The modified gen p mean: 0.45039984583854675, gen p mean: -0.031687382608652115, mean p set: 0.45088011026382446
loss_pred:0.01691199652850628, decouple_loss:0.0010991789167746902
loss_pred:0.016331980004906654, decouple_loss:0.0009715704363770783
loss_pred:0.018131829798221588, decouple_loss:0.0010572053724899888
Iteration: 342, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502444267272949, gen p mean: -0.031030988320708275, mean p set: 0.450724720954895
loss_pred:0.016960786655545235, decouple_loss:0.0010317278793081641
The modified gen p mean: 0.44947129487991333, gen p mean: -0.03500121459364891, mean p set: 0.4499515891075134The modified gen p mean: 0.45128703117370605, gen p mean: -0.03473839908838272, mean p set: 0.45176732540130615
loss_pred:0.017823325470089912, decouple_loss:0.000989116495475173
loss_pred:0.01774315908551216, decouple_loss:0.0010148731525987387
Iteration: 343, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44776785373687744, gen p mean: -0.03688233718276024, mean p set: 0.4482481777667999
loss_pred:0.017827976495027542, decouple_loss:0.001123442780226469
The modified gen p mean: 0.44961437582969666, gen p mean: -0.03736107423901558, mean p set: 0.45009464025497437The modified gen p mean: 0.44795286655426025, gen p mean: -0.030869990587234497, mean p set: 0.44843316078186035
loss_pred:0.01733347214758396, decouple_loss:0.0011167761404067278
loss_pred:0.017999980598688126, decouple_loss:0.0010826203506439924
Iteration: 344, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490574598312378, gen p mean: -0.03630624711513519, mean p set: 0.4495377540588379
loss_pred:0.01784031093120575, decouple_loss:0.0011880139354616404
The modified gen p mean: 0.4496529698371887, gen p mean: -0.03939921036362648, mean p set: 0.4501332640647888The modified gen p mean: 0.45027536153793335, gen p mean: -0.03226945549249649, mean p set: 0.45075568556785583
loss_pred:0.017415784299373627, decouple_loss:0.0010889389086514711loss_pred:0.01689288206398487, decouple_loss:0.001101297908462584
Iteration: 345, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4527747631072998, gen p mean: -0.035737186670303345, mean p set: 0.4532550275325775
loss_pred:0.01696382462978363, decouple_loss:0.001214663847349584
The modified gen p mean: 0.4536886215209961, gen p mean: -0.03739480301737785, mean p set: 0.4541688859462738The modified gen p mean: 0.4511649012565613, gen p mean: -0.04062647745013237, mean p set: 0.45164522528648376
loss_pred:0.01758962869644165, decouple_loss:0.001035297173075378
loss_pred:0.0169578455388546, decouple_loss:0.001213418203406036
Iteration: 346, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4529041349887848, gen p mean: -0.03507265821099281, mean p set: 0.4533843994140625
loss_pred:0.017795296385884285, decouple_loss:0.001187186106108129
The modified gen p mean: 0.4527755677700043, gen p mean: -0.03801224008202553, mean p set: 0.45325586199760437The modified gen p mean: 0.45109039545059204, gen p mean: -0.03817741945385933, mean p set: 0.45157068967819214
loss_pred:0.01757155731320381, decouple_loss:0.001096364576369524
loss_pred:0.01728452555835247, decouple_loss:0.0011643263278529048
Iteration: 347, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4519825875759125, gen p mean: -0.03580499812960625, mean p set: 0.4524628818035126
loss_pred:0.017073404043912888, decouple_loss:0.001089095021598041
The modified gen p mean: 0.4490417540073395, gen p mean: -0.04273529723286629, mean p set: 0.4495220482349396The modified gen p mean: 0.44808679819107056, gen p mean: -0.04384435713291168, mean p set: 0.44856709241867065
loss_pred:0.017761867493391037, decouple_loss:0.001103892456740141
loss_pred:0.01791238598525524, decouple_loss:0.0010643515270203352
Iteration: 348, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44835197925567627, gen p mean: -0.038643572479486465, mean p set: 0.44883227348327637
loss_pred:0.0177825465798378, decouple_loss:0.0011291616829112172
The modified gen p mean: 0.4511868953704834, gen p mean: -0.04064272344112396, mean p set: 0.4516671597957611The modified gen p mean: 0.4490250051021576, gen p mean: -0.03878941386938095, mean p set: 0.4495052993297577
loss_pred:0.01793387345969677, decouple_loss:0.0011742872884497046
loss_pred:0.01767151430249214, decouple_loss:0.0011885595740750432
Iteration: 349, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514996409416199, gen p mean: -0.033941544592380524, mean p set: 0.45197993516921997
loss_pred:0.017147114500403404, decouple_loss:0.0010713018709793687
The modified gen p mean: 0.44802626967430115, gen p mean: -0.03617815300822258, mean p set: 0.44850653409957886The modified gen p mean: 0.44904929399490356, gen p mean: -0.03963595628738403, mean p set: 0.44952961802482605
loss_pred:0.01771080307662487, decouple_loss:0.0010609031887724996
loss_pred:0.01762903295457363, decouple_loss:0.001124928006902337
Iteration: 350, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45138776302337646, gen p mean: -0.035502754151821136, mean p set: 0.45186808705329895
loss_pred:0.01613510027527809, decouple_loss:0.0012155486037954688
The modified gen p mean: 0.45065250992774963, gen p mean: -0.03610696271061897, mean p set: 0.45113280415534973The modified gen p mean: 0.4484826624393463, gen p mean: -0.0360209196805954, mean p set: 0.4489629566669464
loss_pred:0.017675776034593582, decouple_loss:0.0011727433884516358
loss_pred:0.016349172219634056, decouple_loss:0.0012688568094745278
2023-04-30 23:40:30 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.037041544914245605, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.031863078474998474, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830237865448, gen p mean: -0.03266322612762451, mean p set: 0.4500633478164673
loss_pred:0.018494416028261185, decouple_loss:0.0012008830672129989
loss_pred:0.017330767586827278, decouple_loss:0.0011834497563540936
loss_pred:0.017551252618432045, decouple_loss:0.0011883804108947515
WV_0_PC_1_EH_0_PS_40, loss: 0.01785169169306755, avg_mse: 0.02563149854540825
current test mse: 0.025631
Iteration: 351, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45114827156066895, gen p mean: -0.03195181488990784, mean p set: 0.45162856578826904
The modified gen p mean: 0.4496348202228546, gen p mean: -0.03488347679376602, mean p set: 0.4501151144504547
The modified gen p mean: 0.45189160108566284, gen p mean: -0.027928782626986504, mean p set: 0.45237189531326294
loss_pred:0.016916560009121895, decouple_loss:0.0012495011324062943
loss_pred:0.016099750995635986, decouple_loss:0.0011400458170101047
loss_pred:0.017360171303153038, decouple_loss:0.0012027608463540673
Iteration: 352, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502812325954437, gen p mean: -0.030919788405299187, mean p set: 0.4507615268230438
loss_pred:0.01754431612789631, decouple_loss:0.0012145608197897673
The modified gen p mean: 0.44916778802871704, gen p mean: -0.03139818459749222, mean p set: 0.44964808225631714The modified gen p mean: 0.4515826106071472, gen p mean: -0.0277481097728014, mean p set: 0.4520629048347473
loss_pred:0.01782199740409851, decouple_loss:0.0012489223154261708
loss_pred:0.017215006053447723, decouple_loss:0.0011768973199650645
Iteration: 353, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45012104511260986, gen p mean: -0.030282815918326378, mean p set: 0.45060133934020996
loss_pred:0.01651538722217083, decouple_loss:0.0012404292356222868
The modified gen p mean: 0.45334023237228394, gen p mean: -0.02932017110288143, mean p set: 0.4538205564022064The modified gen p mean: 0.44970130920410156, gen p mean: -0.032781291753053665, mean p set: 0.45018160343170166
loss_pred:0.017760727554559708, decouple_loss:0.001235196366906166
loss_pred:0.017710119485855103, decouple_loss:0.0012609191471710801
Iteration: 354, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503602981567383, gen p mean: -0.02634534426033497, mean p set: 0.4508405923843384
loss_pred:0.016645628958940506, decouple_loss:0.00107059464789927
The modified gen p mean: 0.4525482952594757, gen p mean: -0.03326031565666199, mean p set: 0.4530285596847534The modified gen p mean: 0.45353665947914124, gen p mean: -0.036321163177490234, mean p set: 0.4540169835090637
loss_pred:0.016476858407258987, decouple_loss:0.0011053512571379542
loss_pred:0.017185280099511147, decouple_loss:0.0012460848083719611
Iteration: 355, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45162874460220337, gen p mean: -0.030846120789647102, mean p set: 0.45210903882980347
loss_pred:0.016978204250335693, decouple_loss:0.0011814775643870234
The modified gen p mean: 0.4513629674911499, gen p mean: -0.030614307150244713, mean p set: 0.4518432915210724The modified gen p mean: 0.4494574964046478, gen p mean: -0.0334358811378479, mean p set: 0.4499378204345703
loss_pred:0.017151307314634323, decouple_loss:0.0011053949128836393
loss_pred:0.0169302336871624, decouple_loss:0.0011413207976147532
Iteration: 356, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45214828848838806, gen p mean: -0.03271760046482086, mean p set: 0.45262858271598816
loss_pred:0.01703333854675293, decouple_loss:0.0010901095811277628
The modified gen p mean: 0.4534391462802887, gen p mean: -0.03129778057336807, mean p set: 0.4539194405078888The modified gen p mean: 0.45147180557250977, gen p mean: -0.0351540632545948, mean p set: 0.45195209980010986
loss_pred:0.017170047387480736, decouple_loss:0.0010791237000375986
loss_pred:0.016382766887545586, decouple_loss:0.0011273593408986926
Iteration: 357, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4522474408149719, gen p mean: -0.03737718611955643, mean p set: 0.452727735042572
loss_pred:0.01625884510576725, decouple_loss:0.0011747763492166996
The modified gen p mean: 0.4479731619358063, gen p mean: -0.04315458983182907, mean p set: 0.448453426361084The modified gen p mean: 0.45214441418647766, gen p mean: -0.0405036099255085, mean p set: 0.45262470841407776
loss_pred:0.017626306042075157, decouple_loss:0.00114004360511899
loss_pred:0.016751881688833237, decouple_loss:0.001086043892428279
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012008_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012008_3_24hr.npz
NaN value num: 0
Iteration: 358, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44687357544898987, gen p mean: -0.04845213145017624, mean p set: 0.44735386967658997
loss_pred:0.015470310114324093, decouple_loss:0.0011731983395293355
The modified gen p mean: 0.4473644196987152, gen p mean: -0.04557562246918678, mean p set: 0.4478446841239929The modified gen p mean: 0.449179083108902, gen p mean: -0.04553956538438797, mean p set: 0.4496593773365021
loss_pred:0.015310704708099365, decouple_loss:0.0012763551203534007
loss_pred:0.014831899665296078, decouple_loss:0.001201687497086823
Iteration: 359, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44900399446487427, gen p mean: -0.04741228371858597, mean p set: 0.449484258890152
loss_pred:0.015391740016639233, decouple_loss:0.0010986749548465014
The modified gen p mean: 0.4475136697292328, gen p mean: -0.05227885767817497, mean p set: 0.4479939937591553The modified gen p mean: 0.44948098063468933, gen p mean: -0.04875713959336281, mean p set: 0.4499613046646118
loss_pred:0.014821438118815422, decouple_loss:0.0011364588281139731
loss_pred:0.01488558016717434, decouple_loss:0.001058938098140061
Iteration: 360, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469151496887207, gen p mean: -0.05486326292157173, mean p set: 0.4473954439163208
The modified gen p mean: 0.44977760314941406, gen p mean: -0.052819326519966125, mean p set: 0.45025789737701416
loss_pred:0.015105566009879112, decouple_loss:0.0012552224798128009
loss_pred:0.01427299901843071, decouple_loss:0.0011210954980924726
The modified gen p mean: 0.4471588730812073, gen p mean: -0.05345258116722107, mean p set: 0.4476391673088074
loss_pred:0.01472531072795391, decouple_loss:0.0011730229016393423
2023-04-30 23:43:26 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.05760197341442108, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.052542492747306824, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.05342349037528038, mean p set: 0.4500633478164673
loss_pred:0.01884818822145462, decouple_loss:0.001219561556354165
loss_pred:0.01767110824584961, decouple_loss:0.0011744342045858502
loss_pred:0.017731456086039543, decouple_loss:0.0011877829674631357
WV_0_PC_1_EH_0_PS_40, loss: 0.01814328134059906, avg_mse: 0.026181919500231743
current test mse: 0.026182
Iteration: 361, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44797995686531067, gen p mean: -0.04958411306142807, mean p set: 0.44846025109291077
The modified gen p mean: 0.44779494404792786, gen p mean: -0.052107494324445724, mean p set: 0.44827526807785034
The modified gen p mean: 0.4467870593070984, gen p mean: -0.054822102189064026, mean p set: 0.4472673535346985
loss_pred:0.014792860485613346, decouple_loss:0.0012476774863898754
loss_pred:0.01457833033055067, decouple_loss:0.0011108601465821266
loss_pred:0.015070744790136814, decouple_loss:0.0011411227751523256
Iteration: 362, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44798722863197327, gen p mean: -0.05650253966450691, mean p set: 0.44846752285957336
The modified gen p mean: 0.44690239429473877, gen p mean: -0.04997369274497032, mean p set: 0.44738268852233887
loss_pred:0.013939726166427135, decouple_loss:0.0012777134543284774
loss_pred:0.014646809548139572, decouple_loss:0.0012926091440021992
The modified gen p mean: 0.4477563202381134, gen p mean: -0.05607582628726959, mean p set: 0.4482366442680359
loss_pred:0.01380103174597025, decouple_loss:0.0012854658998548985
Iteration: 363, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469769597053528, gen p mean: -0.05147850140929222, mean p set: 0.4474572539329529
loss_pred:0.014050099067389965, decouple_loss:0.0012789629399776459
The modified gen p mean: 0.4482094943523407, gen p mean: -0.055191222578287125, mean p set: 0.4486897885799408The modified gen p mean: 0.449349045753479, gen p mean: -0.05050408095121384, mean p set: 0.4498293101787567
loss_pred:0.014467746950685978, decouple_loss:0.0012477388372644782
loss_pred:0.014171524904668331, decouple_loss:0.0012555504217743874
Iteration: 364, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472697973251343, gen p mean: -0.05040212348103523, mean p set: 0.4477500915527344
loss_pred:0.014017174020409584, decouple_loss:0.0013124247780069709
The modified gen p mean: 0.44765836000442505, gen p mean: -0.0498453751206398, mean p set: 0.44813862442970276The modified gen p mean: 0.4483543634414673, gen p mean: -0.050062816590070724, mean p set: 0.4488346576690674
loss_pred:0.014757262542843819, decouple_loss:0.0012833046494051814
loss_pred:0.014554299414157867, decouple_loss:0.0012622274225577712
Iteration: 365, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480445683002472, gen p mean: -0.046674519777297974, mean p set: 0.4485248327255249
loss_pred:0.01397234108299017, decouple_loss:0.0013507899129763246
The modified gen p mean: 0.4486221671104431, gen p mean: -0.044956691563129425, mean p set: 0.4491024613380432The modified gen p mean: 0.44692468643188477, gen p mean: -0.04795031249523163, mean p set: 0.44740498065948486
loss_pred:0.013884540647268295, decouple_loss:0.0014345931122079492
loss_pred:0.01384970173239708, decouple_loss:0.001311509171500802
Iteration: 366, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44781970977783203, gen p mean: -0.05029493570327759, mean p set: 0.44829997420310974
loss_pred:0.014060087502002716, decouple_loss:0.001501149614341557
The modified gen p mean: 0.4473857879638672, gen p mean: -0.04684033989906311, mean p set: 0.4478660821914673The modified gen p mean: 0.4481048285961151, gen p mean: -0.043717753142118454, mean p set: 0.4485850930213928
loss_pred:0.013599583879113197, decouple_loss:0.0013977825874462724
loss_pred:0.013837953098118305, decouple_loss:0.001463168766349554
Iteration: 367, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476199448108673, gen p mean: -0.05576527863740921, mean p set: 0.4481002688407898
The modified gen p mean: 0.4472668170928955, gen p mean: -0.044703684747219086, mean p set: 0.447747141122818
loss_pred:0.013788988813757896, decouple_loss:0.0014693076955154538
loss_pred:0.01365355309098959, decouple_loss:0.0013361073797568679
The modified gen p mean: 0.44743573665618896, gen p mean: -0.04892601817846298, mean p set: 0.44791606068611145
loss_pred:0.013688658364117146, decouple_loss:0.0014354573795571923
Iteration: 368, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44802576303482056, gen p mean: -0.04065658524632454, mean p set: 0.44850608706474304
loss_pred:0.01346335094422102, decouple_loss:0.0014296082081273198
The modified gen p mean: 0.4483236074447632, gen p mean: -0.03933120518922806, mean p set: 0.4488039016723633The modified gen p mean: 0.4484352171421051, gen p mean: -0.044919610023498535, mean p set: 0.4489155113697052
loss_pred:0.013362725265324116, decouple_loss:0.001433957600966096
loss_pred:0.014110894873738289, decouple_loss:0.0014864199329167604
Iteration: 369, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472024142742157, gen p mean: -0.04573410004377365, mean p set: 0.4476827085018158
loss_pred:0.013774123974144459, decouple_loss:0.001440674066543579
The modified gen p mean: 0.44713103771209717, gen p mean: -0.04483833163976669, mean p set: 0.44761136174201965The modified gen p mean: 0.448159396648407, gen p mean: -0.043734077364206314, mean p set: 0.4486396908760071
loss_pred:0.013442551717162132, decouple_loss:0.0014080333057790995
loss_pred:0.013927039690315723, decouple_loss:0.0014647853095084429
Iteration: 370, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44645363092422485, gen p mean: -0.043792448937892914, mean p set: 0.44693389534950256
loss_pred:0.01369375642389059, decouple_loss:0.001440847641788423
The modified gen p mean: 0.4485139846801758, gen p mean: -0.04716787114739418, mean p set: 0.4489942789077759The modified gen p mean: 0.44762831926345825, gen p mean: -0.0438581258058548, mean p set: 0.44810861349105835
loss_pred:0.013585365377366543, decouple_loss:0.0014413034077733755
loss_pred:0.013384959660470486, decouple_loss:0.0013940982753410935
2023-04-30 23:45:19 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.04875647649168968, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04396705701947212, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.044815968722105026, mean p set: 0.4500633478164673
loss_pred:0.01950242556631565, decouple_loss:0.001409413293004036
loss_pred:0.018347743898630142, decouple_loss:0.0014262808253988624
loss_pred:0.018390171229839325, decouple_loss:0.0014240265591070056
WV_0_PC_1_EH_0_PS_40, loss: 0.018817776814103127, avg_mse: 0.027461634948849678
current test mse: 0.027462
Iteration: 371, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447916179895401, gen p mean: -0.04679659754037857, mean p set: 0.4483965039253235
The modified gen p mean: 0.44668376445770264, gen p mean: -0.04558248445391655, mean p set: 0.44716405868530273
The modified gen p mean: 0.44811397790908813, gen p mean: -0.04444045573472977, mean p set: 0.44859424233436584
loss_pred:0.013903999701142311, decouple_loss:0.0013598357327282429
loss_pred:0.013453357852995396, decouple_loss:0.001320981071330607
loss_pred:0.013510515913367271, decouple_loss:0.0013084582751616836
Iteration: 372, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44617438316345215, gen p mean: -0.043332748115062714, mean p set: 0.44665467739105225
loss_pred:0.01389420684427023, decouple_loss:0.0013400561874732375
The modified gen p mean: 0.4466054439544678, gen p mean: -0.040751904249191284, mean p set: 0.4470857083797455The modified gen p mean: 0.4477499723434448, gen p mean: -0.04238261282444, mean p set: 0.4482302665710449
loss_pred:0.013416199944913387, decouple_loss:0.0013663305435329676
loss_pred:0.013869673013687134, decouple_loss:0.0014045354910194874
Iteration: 373, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44857507944107056, gen p mean: -0.0564725436270237, mean p set: 0.44905540347099304
The modified gen p mean: 0.44828876852989197, gen p mean: -0.044780634343624115, mean p set: 0.44876906275749207
loss_pred:0.013418382033705711, decouple_loss:0.0015256416518241167
loss_pred:0.012978523038327694, decouple_loss:0.0014274453278630972
The modified gen p mean: 0.44847428798675537, gen p mean: -0.04468776658177376, mean p set: 0.44895458221435547
loss_pred:0.013257759623229504, decouple_loss:0.0013851354597136378
Iteration: 374, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44767674803733826, gen p mean: -0.0506742037832737, mean p set: 0.44815701246261597
The modified gen p mean: 0.44793081283569336, gen p mean: -0.050784632563591, mean p set: 0.44841110706329346
loss_pred:0.013494494371116161, decouple_loss:0.0012972960248589516
loss_pred:0.014085470698773861, decouple_loss:0.0013422674965113401
The modified gen p mean: 0.4475749433040619, gen p mean: -0.0475635901093483, mean p set: 0.4480552673339844
loss_pred:0.013441013172268867, decouple_loss:0.0012960413005203009
Iteration: 375, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44643887877464294, gen p mean: -0.05320167914032936, mean p set: 0.44691917300224304
The modified gen p mean: 0.4479478597640991, gen p mean: -0.04960227012634277, mean p set: 0.4484281837940216
loss_pred:0.013589451089501381, decouple_loss:0.0015105886850506067
loss_pred:0.014204532839357853, decouple_loss:0.0014083541464060545
The modified gen p mean: 0.4479027986526489, gen p mean: -0.048996701836586, mean p set: 0.4483831226825714
loss_pred:0.013322168029844761, decouple_loss:0.0013802152825519443
Iteration: 376, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479721784591675, gen p mean: -0.046606358140707016, mean p set: 0.4484524726867676
The modified gen p mean: 0.44778189063072205, gen p mean: -0.046475935727357864, mean p set: 0.44826218485832214
loss_pred:0.013656221330165863, decouple_loss:0.0013458093162626028
loss_pred:0.013285775668919086, decouple_loss:0.0013609766028821468
The modified gen p mean: 0.4483950734138489, gen p mean: -0.04748176410794258, mean p set: 0.448875367641449
loss_pred:0.013352256268262863, decouple_loss:0.0014092546189203858
Iteration: 377, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44826120138168335, gen p mean: -0.04240793362259865, mean p set: 0.44874149560928345
The modified gen p mean: 0.4468684494495392, gen p mean: -0.05434497818350792, mean p set: 0.4473487436771393
loss_pred:0.013097665272653103, decouple_loss:0.0012513917172327638
loss_pred:0.01324891485273838, decouple_loss:0.0013937567127868533
The modified gen p mean: 0.4489873945713043, gen p mean: -0.04533376544713974, mean p set: 0.4494676887989044
loss_pred:0.013386334292590618, decouple_loss:0.0012711196905001998
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012014_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012014_3_24hr.npz
NaN value num: 0
Iteration: 378, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471362233161926, gen p mean: -0.04822390526533127, mean p set: 0.44761648774147034
loss_pred:0.013553150929510593, decouple_loss:0.0014671137323603034
The modified gen p mean: 0.4490087032318115, gen p mean: -0.04428520053625107, mean p set: 0.4494889974594116The modified gen p mean: 0.44723835587501526, gen p mean: -0.0480179563164711, mean p set: 0.44771865010261536
loss_pred:0.013709277845919132, decouple_loss:0.00129791465587914
loss_pred:0.013406856916844845, decouple_loss:0.001388350035995245
Iteration: 379, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44873046875, gen p mean: -0.041458744555711746, mean p set: 0.4492107927799225
The modified gen p mean: 0.44766926765441895, gen p mean: -0.04429636895656586, mean p set: 0.44814959168434143
loss_pred:0.014029943384230137, decouple_loss:0.0012678337516263127
loss_pred:0.013213596306741238, decouple_loss:0.0012642501387745142The modified gen p mean: 0.44807589054107666, gen p mean: -0.04554867744445801, mean p set: 0.44855615496635437
loss_pred:0.013618997298181057, decouple_loss:0.0014165743486955762
Iteration: 380, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488472044467926, gen p mean: -0.04675403982400894, mean p set: 0.4493274986743927
The modified gen p mean: 0.44838187098503113, gen p mean: -0.045376501977443695, mean p set: 0.4488621652126312
loss_pred:0.013720666989684105, decouple_loss:0.0012879043351858854
loss_pred:0.014220256358385086, decouple_loss:0.0013601032551378012
The modified gen p mean: 0.44706377387046814, gen p mean: -0.04925701767206192, mean p set: 0.44754406809806824
loss_pred:0.013572280295193195, decouple_loss:0.0013936206232756376
2023-04-30 23:49:12 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.04982418939471245, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.0452963225543499, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.045963604003190994, mean p set: 0.4500633478164673
loss_pred:0.019488107413053513, decouple_loss:0.0013446353841573
loss_pred:0.01836070790886879, decouple_loss:0.0012875690590590239
loss_pred:0.018398813903331757, decouple_loss:0.001292466651648283
WV_0_PC_1_EH_0_PS_40, loss: 0.01881462149322033, avg_mse: 0.027535175904631615
current test mse: 0.027535
Iteration: 381, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447527676820755, gen p mean: -0.04874998331069946, mean p set: 0.4480080008506775
The modified gen p mean: 0.4476584792137146, gen p mean: -0.05035066977143288, mean p set: 0.4481387734413147
The modified gen p mean: 0.4475400745868683, gen p mean: -0.04623023420572281, mean p set: 0.44802039861679077
loss_pred:0.013130546547472477, decouple_loss:0.001240844838321209
loss_pred:0.013525115326046944, decouple_loss:0.0012520025484263897
loss_pred:0.013381126336753368, decouple_loss:0.0014548753388226032
Iteration: 382, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489087164402008, gen p mean: -0.043176453560590744, mean p set: 0.4493890404701233
loss_pred:0.013625376857817173, decouple_loss:0.0011833372991532087
The modified gen p mean: 0.44612351059913635, gen p mean: -0.04358593374490738, mean p set: 0.44660380482673645The modified gen p mean: 0.4482654631137848, gen p mean: -0.045988284051418304, mean p set: 0.4487457573413849
loss_pred:0.013742160983383656, decouple_loss:0.001228499342687428
loss_pred:0.013704042881727219, decouple_loss:0.001313627464696765
Iteration: 383, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473407566547394, gen p mean: -0.044122014194726944, mean p set: 0.4478210508823395
loss_pred:0.013687185943126678, decouple_loss:0.0011578931007534266
The modified gen p mean: 0.44712865352630615, gen p mean: -0.04139852523803711, mean p set: 0.44760891795158386The modified gen p mean: 0.4483383893966675, gen p mean: -0.04162803664803505, mean p set: 0.4488186836242676
loss_pred:0.01371008437126875, decouple_loss:0.001207215478643775
loss_pred:0.01350102573633194, decouple_loss:0.0011561282444745302
Iteration: 384, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478815495967865, gen p mean: -0.038582298904657364, mean p set: 0.4483618438243866
loss_pred:0.013274045661091805, decouple_loss:0.001380903529934585
The modified gen p mean: 0.4468141794204712, gen p mean: -0.04539985582232475, mean p set: 0.4472944438457489The modified gen p mean: 0.44754454493522644, gen p mean: -0.043206121772527695, mean p set: 0.4480248689651489
loss_pred:0.013064631260931492, decouple_loss:0.0012968298979103565
loss_pred:0.013596895150840282, decouple_loss:0.0011993388179689646
Iteration: 385, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477365016937256, gen p mean: -0.0434422567486763, mean p set: 0.44821682572364807
loss_pred:0.013664452359080315, decouple_loss:0.0014341346686705947
The modified gen p mean: 0.4473842680454254, gen p mean: -0.04816628247499466, mean p set: 0.4478645324707031The modified gen p mean: 0.44683799147605896, gen p mean: -0.039625611156225204, mean p set: 0.44731831550598145
loss_pred:0.012965484522283077, decouple_loss:0.001373926643282175
loss_pred:0.01353865209966898, decouple_loss:0.0012914168182760477
Iteration: 386, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44758838415145874, gen p mean: -0.04390249773859978, mean p set: 0.44806867837905884
loss_pred:0.013168586418032646, decouple_loss:0.0011873220792040229
The modified gen p mean: 0.44744864106178284, gen p mean: -0.04421183839440346, mean p set: 0.44792893528938293The modified gen p mean: 0.4477286636829376, gen p mean: -0.04323491081595421, mean p set: 0.4482089579105377
loss_pred:0.013502654619514942, decouple_loss:0.0012087277136743069
loss_pred:0.013532677665352821, decouple_loss:0.0011902072001248598
Iteration: 387, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44694724678993225, gen p mean: -0.0483878031373024, mean p set: 0.44742754101753235
loss_pred:0.01277732290327549, decouple_loss:0.00126100133638829
The modified gen p mean: 0.4482875168323517, gen p mean: -0.04508623853325844, mean p set: 0.4487678110599518The modified gen p mean: 0.4479805529117584, gen p mean: -0.04640689119696617, mean p set: 0.44846081733703613
loss_pred:0.013010840862989426, decouple_loss:0.0012483947211876512
loss_pred:0.013127699494361877, decouple_loss:0.001287776860408485
Iteration: 388, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44742661714553833, gen p mean: -0.04661847651004791, mean p set: 0.4479069411754608
loss_pred:0.013327369466423988, decouple_loss:0.0011073803761973977
The modified gen p mean: 0.4474486708641052, gen p mean: -0.04615344852209091, mean p set: 0.4479289650917053The modified gen p mean: 0.44822150468826294, gen p mean: -0.04232405871152878, mean p set: 0.44870179891586304
loss_pred:0.013317451812326908, decouple_loss:0.0011621828889474273
loss_pred:0.013222831301391125, decouple_loss:0.001145837246440351
Iteration: 389, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44658082723617554, gen p mean: -0.04533255100250244, mean p set: 0.44706112146377563
loss_pred:0.013324261642992496, decouple_loss:0.001292614033445716
The modified gen p mean: 0.44775915145874023, gen p mean: -0.04750336334109306, mean p set: 0.44823944568634033The modified gen p mean: 0.4472610652446747, gen p mean: -0.04599782079458237, mean p set: 0.4477413594722748
loss_pred:0.013525819405913353, decouple_loss:0.001399738946929574
loss_pred:0.013241801410913467, decouple_loss:0.0013610727619379759
Iteration: 390, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4461727440357208, gen p mean: -0.04511315003037453, mean p set: 0.44665300846099854
loss_pred:0.013265230692923069, decouple_loss:0.0011494893115013838
The modified gen p mean: 0.4473603069782257, gen p mean: -0.047442227602005005, mean p set: 0.4478406012058258The modified gen p mean: 0.4478708803653717, gen p mean: -0.044535234570503235, mean p set: 0.4483511745929718
loss_pred:0.013664972968399525, decouple_loss:0.0011227612849324942
loss_pred:0.01313630398362875, decouple_loss:0.0011920168763026595
2023-04-30 23:51:04 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.04837357625365257, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04457375034689903, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.04488920047879219, mean p set: 0.4500633478164673
loss_pred:0.019432103261351585, decouple_loss:0.0015025503234937787
loss_pred:0.018227871507406235, decouple_loss:0.0013451144332066178
loss_pred:0.018353372812271118, decouple_loss:0.0013658362440764904
WV_0_PC_1_EH_0_PS_40, loss: 0.018741343170404434, avg_mse: 0.027414290234446526
current test mse: 0.027414
Iteration: 391, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472653269767761, gen p mean: -0.04643964767456055, mean p set: 0.4477456510066986
The modified gen p mean: 0.44780266284942627, gen p mean: -0.05081336945295334, mean p set: 0.44828295707702637
The modified gen p mean: 0.4477446675300598, gen p mean: -0.04746999964118004, mean p set: 0.4482249617576599
loss_pred:0.012838532216846943, decouple_loss:0.0013051480054855347
loss_pred:0.013354022987186909, decouple_loss:0.001366777578368783
loss_pred:0.013162167742848396, decouple_loss:0.001420936780050397
Iteration: 392, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44722220301628113, gen p mean: -0.043446436524391174, mean p set: 0.44770246744155884
loss_pred:0.012771445326507092, decouple_loss:0.0011221475433558226
The modified gen p mean: 0.44829726219177246, gen p mean: -0.04485400393605232, mean p set: 0.44877755641937256The modified gen p mean: 0.44756296277046204, gen p mean: -0.04543832316994667, mean p set: 0.4480433166027069
loss_pred:0.013492121361196041, decouple_loss:0.001109028933569789
loss_pred:0.013063463382422924, decouple_loss:0.0010716249234974384
Iteration: 393, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44771134853363037, gen p mean: -0.0449804849922657, mean p set: 0.44819164276123047
loss_pred:0.012756070122122765, decouple_loss:0.001158159109763801
The modified gen p mean: 0.44856178760528564, gen p mean: -0.044047124683856964, mean p set: 0.44904205203056335The modified gen p mean: 0.44761139154434204, gen p mean: -0.046427782624959946, mean p set: 0.4480917155742645
loss_pred:0.012948107905685902, decouple_loss:0.0011898105731233954
loss_pred:0.013427174650132656, decouple_loss:0.001146098249591887
Iteration: 394, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477596580982208, gen p mean: -0.04832252487540245, mean p set: 0.4482399523258209
loss_pred:0.01346056442707777, decouple_loss:0.0012186527019366622
The modified gen p mean: 0.4473441243171692, gen p mean: -0.046550240367650986, mean p set: 0.4478244483470917The modified gen p mean: 0.44737324118614197, gen p mean: -0.04574229195713997, mean p set: 0.44785353541374207
loss_pred:0.013203307054936886, decouple_loss:0.0011870856396853924
loss_pred:0.013232083059847355, decouple_loss:0.0011939991964027286
Iteration: 395, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466997981071472, gen p mean: -0.0479615293443203, mean p set: 0.4471800923347473
The modified gen p mean: 0.4477505683898926, gen p mean: -0.04719827324151993, mean p set: 0.4482308626174927
loss_pred:0.013222957961261272, decouple_loss:0.0011105817975476384
loss_pred:0.013296600431203842, decouple_loss:0.0011140403803437948
The modified gen p mean: 0.4481663703918457, gen p mean: -0.042480774223804474, mean p set: 0.4486466944217682
loss_pred:0.013159389607608318, decouple_loss:0.0011515456717461348
Iteration: 396, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472672641277313, gen p mean: -0.045221470296382904, mean p set: 0.4477475583553314
The modified gen p mean: 0.44783875346183777, gen p mean: -0.04865685850381851, mean p set: 0.44831904768943787
loss_pred:0.013003909960389137, decouple_loss:0.0011734929867088795
loss_pred:0.013171467930078506, decouple_loss:0.00121726980432868
The modified gen p mean: 0.447806179523468, gen p mean: -0.04563456401228905, mean p set: 0.4482864737510681
loss_pred:0.012968279421329498, decouple_loss:0.001121373730711639
Iteration: 397, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471328556537628, gen p mean: -0.05064957216382027, mean p set: 0.4476131498813629
loss_pred:0.01258400734513998, decouple_loss:0.0011016227072104812
The modified gen p mean: 0.44831040501594543, gen p mean: -0.04780372604727745, mean p set: 0.44879069924354553The modified gen p mean: 0.44696974754333496, gen p mean: -0.04962226003408432, mean p set: 0.44745007157325745
loss_pred:0.012972621247172356, decouple_loss:0.0009867141488939524
loss_pred:0.012876098044216633, decouple_loss:0.0011284698266535997
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012001_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012001_3_24hr.npz
NaN value num: 0
Iteration: 398, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499267637729645, gen p mean: -0.044698864221572876, mean p set: 0.4504070580005646
loss_pred:0.018499065190553665, decouple_loss:0.0013455532025545835
The modified gen p mean: 0.4501236379146576, gen p mean: -0.04169140011072159, mean p set: 0.4506039321422577The modified gen p mean: 0.44973331689834595, gen p mean: -0.04153214767575264, mean p set: 0.45021358132362366
loss_pred:0.018109578639268875, decouple_loss:0.0015398632967844605
loss_pred:0.017309745773673058, decouple_loss:0.0014182485174387693
Iteration: 399, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479660987854004, gen p mean: -0.037434011697769165, mean p set: 0.4484463632106781
loss_pred:0.01706673763692379, decouple_loss:0.0012597673339769244
The modified gen p mean: 0.4474199712276459, gen p mean: -0.04085739329457283, mean p set: 0.44790026545524597The modified gen p mean: 0.4473233222961426, gen p mean: -0.04086524620652199, mean p set: 0.44780364632606506
loss_pred:0.017416661605238914, decouple_loss:0.0013338665012270212
loss_pred:0.01823430322110653, decouple_loss:0.0013048445107415318
Iteration: 400, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495709240436554, gen p mean: -0.03547399491071701, mean p set: 0.4500511884689331
loss_pred:0.01746325194835663, decouple_loss:0.0014020606176927686
The modified gen p mean: 0.45021116733551025, gen p mean: -0.033964432775974274, mean p set: 0.45069149136543274The modified gen p mean: 0.45018166303634644, gen p mean: -0.033054791390895844, mean p set: 0.4506619870662689
loss_pred:0.01812695898115635, decouple_loss:0.0013941270299255848
loss_pred:0.017605183646082878, decouple_loss:0.001527894288301468
2023-04-30 23:53:54 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.03739117830991745, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.03340296447277069, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.0339624397456646, mean p set: 0.4500633478164673
loss_pred:0.018772337585687637, decouple_loss:0.0013572159223258495
loss_pred:0.017613306641578674, decouple_loss:0.0012988800881430507
loss_pred:0.01779215596616268, decouple_loss:0.0012997309677302837
WV_0_PC_1_EH_0_PS_40, loss: 0.018125196918845177, avg_mse: 0.0261341892182827
current test mse: 0.026134
Iteration: 401, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44973939657211304, gen p mean: -0.025575289502739906, mean p set: 0.4502197206020355
The modified gen p mean: 0.45006489753723145, gen p mean: -0.027702266350388527, mean p set: 0.45054522156715393
The modified gen p mean: 0.4475097954273224, gen p mean: -0.028815245255827904, mean p set: 0.4479900598526001
loss_pred:0.018105901777744293, decouple_loss:0.0013134829932823777
loss_pred:0.018196672201156616, decouple_loss:0.0013361608143895864
loss_pred:0.018178174272179604, decouple_loss:0.0012890043435618281
Iteration: 402, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44880279898643494, gen p mean: -0.02518037147819996, mean p set: 0.4492831230163574
loss_pred:0.016927264630794525, decouple_loss:0.0013042944483458996
The modified gen p mean: 0.4505390226840973, gen p mean: -0.023526107892394066, mean p set: 0.451019287109375The modified gen p mean: 0.4505366086959839, gen p mean: -0.024669229984283447, mean p set: 0.45101693272590637
loss_pred:0.016861258074641228, decouple_loss:0.0012678067432716489
loss_pred:0.016741598024964333, decouple_loss:0.0012983966153115034
Iteration: 403, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45033854246139526, gen p mean: -0.02663031965494156, mean p set: 0.450818806886673
loss_pred:0.017955156043171883, decouple_loss:0.0013263759901747108
The modified gen p mean: 0.4502367377281189, gen p mean: -0.026769816875457764, mean p set: 0.4507170021533966The modified gen p mean: 0.44823697209358215, gen p mean: -0.023322831839323044, mean p set: 0.44871723651885986
loss_pred:0.017436839640140533, decouple_loss:0.001349401893094182
loss_pred:0.01754566840827465, decouple_loss:0.0016567269340157509
Iteration: 404, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44836822152137756, gen p mean: -0.02026267535984516, mean p set: 0.44884851574897766
loss_pred:0.01781889796257019, decouple_loss:0.0013063986552879214
The modified gen p mean: 0.447935551404953, gen p mean: -0.021439507603645325, mean p set: 0.4484158456325531The modified gen p mean: 0.4502882957458496, gen p mean: -0.024394504725933075, mean p set: 0.4507685601711273
loss_pred:0.017397498711943626, decouple_loss:0.0012776984367519617loss_pred:0.016942190006375313, decouple_loss:0.0013300888240337372
Iteration: 405, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491611123085022, gen p mean: -0.024314017966389656, mean p set: 0.4496413767337799
loss_pred:0.017157545313239098, decouple_loss:0.0015139204915612936
The modified gen p mean: 0.45032650232315063, gen p mean: -0.023500723764300346, mean p set: 0.45080679655075073The modified gen p mean: 0.4502337872982025, gen p mean: -0.019529767334461212, mean p set: 0.450714111328125
loss_pred:0.016433753073215485, decouple_loss:0.0014802017249166965
loss_pred:0.01692792773246765, decouple_loss:0.0014182257000356913
Iteration: 406, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45038384199142456, gen p mean: -0.02744496800005436, mean p set: 0.45086413621902466
loss_pred:0.016819419339299202, decouple_loss:0.0012508712243288755
The modified gen p mean: 0.44779157638549805, gen p mean: -0.02712377719581127, mean p set: 0.44827190041542053The modified gen p mean: 0.44820454716682434, gen p mean: -0.026571646332740784, mean p set: 0.44868484139442444
loss_pred:0.016802458092570305, decouple_loss:0.001234820461831987
loss_pred:0.01667128875851631, decouple_loss:0.0012815711088478565
Iteration: 407, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44768667221069336, gen p mean: -0.031799666583538055, mean p set: 0.44816699624061584
loss_pred:0.017220187932252884, decouple_loss:0.0013992448803037405
The modified gen p mean: 0.450183629989624, gen p mean: -0.027964651584625244, mean p set: 0.45066389441490173The modified gen p mean: 0.44783496856689453, gen p mean: -0.030757814645767212, mean p set: 0.44831526279449463
loss_pred:0.017018893733620644, decouple_loss:0.0013693998334929347
loss_pred:0.017695095390081406, decouple_loss:0.0013243641005828977
Iteration: 408, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497472047805786, gen p mean: -0.03264319896697998, mean p set: 0.4502274990081787
loss_pred:0.01638719066977501, decouple_loss:0.0013478531036525965
The modified gen p mean: 0.44963374733924866, gen p mean: -0.03390924632549286, mean p set: 0.45011407136917114The modified gen p mean: 0.44863617420196533, gen p mean: -0.03086201287806034, mean p set: 0.44911646842956543
loss_pred:0.017769601196050644, decouple_loss:0.0012420808197930455
loss_pred:0.016937145963311195, decouple_loss:0.0012886968906968832
Iteration: 409, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44751399755477905, gen p mean: -0.03342728689312935, mean p set: 0.44799432158470154
loss_pred:0.016665484756231308, decouple_loss:0.0011730254627764225
The modified gen p mean: 0.4490787982940674, gen p mean: -0.0367095023393631, mean p set: 0.4495590925216675The modified gen p mean: 0.44969460368156433, gen p mean: -0.03794476017355919, mean p set: 0.45017489790916443
loss_pred:0.0169236958026886, decouple_loss:0.0012704612454399467
loss_pred:0.017074212431907654, decouple_loss:0.001212871866300702
Iteration: 410, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44960710406303406, gen p mean: -0.03924894332885742, mean p set: 0.45008742809295654
loss_pred:0.016898568719625473, decouple_loss:0.0011842722306028008
The modified gen p mean: 0.4479018747806549, gen p mean: -0.03778345510363579, mean p set: 0.448382169008255The modified gen p mean: 0.4492204189300537, gen p mean: -0.039787743240594864, mean p set: 0.4497006833553314
loss_pred:0.01725037582218647, decouple_loss:0.001211856259033084
loss_pred:0.01764778606593609, decouple_loss:0.0012467355700209737
2023-04-30 23:55:49 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.04971415922045708, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04469212517142296, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04557393863797188, mean p set: 0.4500633478164673
loss_pred:0.018488479778170586, decouple_loss:0.0013162557734176517
loss_pred:0.017301425337791443, decouple_loss:0.0012582667404785752
loss_pred:0.017480622977018356, decouple_loss:0.0013001603074371815
WV_0_PC_1_EH_0_PS_40, loss: 0.0178214218467474, avg_mse: 0.02554890513420105
current test mse: 0.025549
Iteration: 411, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496905505657196, gen p mean: -0.0413280613720417, mean p set: 0.4501708745956421
The modified gen p mean: 0.4509035348892212, gen p mean: -0.04194217920303345, mean p set: 0.4513837993144989
The modified gen p mean: 0.4482101798057556, gen p mean: -0.041831668466329575, mean p set: 0.4486904740333557
loss_pred:0.01650429144501686, decouple_loss:0.0011911805486306548
loss_pred:0.016749566420912743, decouple_loss:0.0011843169340863824
loss_pred:0.01665058173239231, decouple_loss:0.0012172242859378457
Iteration: 412, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44882693886756897, gen p mean: -0.041540343314409256, mean p set: 0.44930723309516907
The modified gen p mean: 0.45034468173980713, gen p mean: -0.04516791179776192, mean p set: 0.4508250057697296
loss_pred:0.01674007624387741, decouple_loss:0.001239052857272327
loss_pred:0.017484206706285477, decouple_loss:0.0012437683762982488
The modified gen p mean: 0.4476509690284729, gen p mean: -0.04762618616223335, mean p set: 0.4481312930583954
loss_pred:0.016887551173567772, decouple_loss:0.0012253907043486834
Iteration: 413, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475921094417572, gen p mean: -0.05026456341147423, mean p set: 0.4480723738670349The modified gen p mean: 0.45021921396255493, gen p mean: -0.04433683678507805, mean p set: 0.45069950819015503
loss_pred:0.01678589917719364, decouple_loss:0.001144226174801588loss_pred:0.016327375546097755, decouple_loss:0.0011448845034465194
The modified gen p mean: 0.44767817854881287, gen p mean: -0.04587193951010704, mean p set: 0.44815847277641296
loss_pred:0.01682509295642376, decouple_loss:0.0010865723015740514
Iteration: 414, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480181336402893, gen p mean: -0.04494248330593109, mean p set: 0.4484984576702118
loss_pred:0.01666419394314289, decouple_loss:0.0011832995805889368
The modified gen p mean: 0.44733551144599915, gen p mean: -0.04368186742067337, mean p set: 0.44781580567359924
The modified gen p mean: 0.4480643570423126, gen p mean: -0.043987344950437546, mean p set: 0.4485446512699127
loss_pred:0.016576098278164864, decouple_loss:0.0012575278524309397
loss_pred:0.017308123409748077, decouple_loss:0.0012129589449614286
Iteration: 415, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500120282173157, gen p mean: -0.04713260382413864, mean p set: 0.45049232244491577
loss_pred:0.016544541344046593, decouple_loss:0.0012459817808121443
The modified gen p mean: 0.4510071277618408, gen p mean: -0.04591020569205284, mean p set: 0.45148739218711853The modified gen p mean: 0.4492908716201782, gen p mean: -0.0449976809322834, mean p set: 0.4497711658477783
loss_pred:0.017733057960867882, decouple_loss:0.001149356015957892
loss_pred:0.017290260642766953, decouple_loss:0.001137251267209649
Iteration: 416, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44756880402565, gen p mean: -0.045143354684114456, mean p set: 0.4480490982532501
loss_pred:0.017127977684140205, decouple_loss:0.0012894881656393409
The modified gen p mean: 0.44751736521720886, gen p mean: -0.04800133779644966, mean p set: 0.44799768924713135The modified gen p mean: 0.4512284994125366, gen p mean: -0.046690862625837326, mean p set: 0.4517087936401367
loss_pred:0.017601896077394485, decouple_loss:0.0011538990074768662
loss_pred:0.0169054102152586, decouple_loss:0.001223341329023242
Iteration: 417, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480859041213989, gen p mean: -0.03927206993103027, mean p set: 0.4485662281513214
loss_pred:0.017046675086021423, decouple_loss:0.001194114563986659
The modified gen p mean: 0.45052462816238403, gen p mean: -0.04364107549190521, mean p set: 0.45100489258766174The modified gen p mean: 0.4493815004825592, gen p mean: -0.040130943059921265, mean p set: 0.4498618245124817
loss_pred:0.016576016321778297, decouple_loss:0.001213101320900023
loss_pred:0.016647648066282272, decouple_loss:0.0012828204780817032
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012013_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012013_3_24hr.npz
NaN value num: 0
Iteration: 418, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474034011363983, gen p mean: -0.04444720596075058, mean p set: 0.447883665561676
loss_pred:0.015489877201616764, decouple_loss:0.0011913108173757792
The modified gen p mean: 0.44697436690330505, gen p mean: -0.04886771738529205, mean p set: 0.44745466113090515The modified gen p mean: 0.447532594203949, gen p mean: -0.04710623249411583, mean p set: 0.4480128884315491
loss_pred:0.016167832538485527, decouple_loss:0.001229161862283945
loss_pred:0.015010706149041653, decouple_loss:0.0012204754166305065
Iteration: 419, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44773462414741516, gen p mean: -0.038668300956487656, mean p set: 0.44821488857269287
loss_pred:0.015070272609591484, decouple_loss:0.0011820659274235368
The modified gen p mean: 0.445743203163147, gen p mean: -0.04460621252655983, mean p set: 0.44622352719306946The modified gen p mean: 0.44704368710517883, gen p mean: -0.04421794414520264, mean p set: 0.44752398133277893
loss_pred:0.015162393450737, decouple_loss:0.001199234975501895
loss_pred:0.014680877327919006, decouple_loss:0.0011711239349097013
Iteration: 420, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4455907940864563, gen p mean: -0.04032547399401665, mean p set: 0.4460710883140564
The modified gen p mean: 0.4475097954273224, gen p mean: -0.04118863865733147, mean p set: 0.4479900598526001
loss_pred:0.014509993605315685, decouple_loss:0.0012383002322167158
loss_pred:0.015138376504182816, decouple_loss:0.0012538867304101586
The modified gen p mean: 0.44697561860084534, gen p mean: -0.03907076641917229, mean p set: 0.44745591282844543
loss_pred:0.014813828282058239, decouple_loss:0.0012306332355365157
2023-04-30 23:58:48 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.04531975835561752, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04038270190358162, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.04130258411169052, mean p set: 0.4500633478164673
loss_pred:0.01867520995438099, decouple_loss:0.0012478675926104188
loss_pred:0.017511656507849693, decouple_loss:0.0012899599969387054
loss_pred:0.017683612182736397, decouple_loss:0.001242251368239522
WV_0_PC_1_EH_0_PS_40, loss: 0.01801982894539833, avg_mse: 0.025930939242243767
current test mse: 0.025931
Iteration: 421, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465055465698242, gen p mean: -0.04338816925883293, mean p set: 0.4469858705997467
The modified gen p mean: 0.4472411274909973, gen p mean: -0.04833107069134712, mean p set: 0.4477214217185974
The modified gen p mean: 0.44622835516929626, gen p mean: -0.03975875675678253, mean p set: 0.446708619594574
loss_pred:0.01488438993692398, decouple_loss:0.001303515862673521
loss_pred:0.014452815987169743, decouple_loss:0.0013157337671145797
loss_pred:0.014409185387194157, decouple_loss:0.0012856889516115189
Iteration: 422, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44653964042663574, gen p mean: -0.04285375028848648, mean p set: 0.4470199644565582
loss_pred:0.014651300385594368, decouple_loss:0.0013194541679695249
The modified gen p mean: 0.4469921588897705, gen p mean: -0.049097392708063126, mean p set: 0.4474724233150482The modified gen p mean: 0.44724833965301514, gen p mean: -0.04219694808125496, mean p set: 0.44772863388061523
loss_pred:0.01446687150746584, decouple_loss:0.0014058747328817844
loss_pred:0.014083396643400192, decouple_loss:0.001304771052673459
Iteration: 423, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4456627666950226, gen p mean: -0.046678025275468826, mean p set: 0.4461430609226227
loss_pred:0.014486859552562237, decouple_loss:0.0013888066168874502
The modified gen p mean: 0.44720005989074707, gen p mean: -0.04439212381839752, mean p set: 0.44768035411834717The modified gen p mean: 0.4475902318954468, gen p mean: -0.047403983771800995, mean p set: 0.4480704963207245
loss_pred:0.013672924600541592, decouple_loss:0.001286419341340661
loss_pred:0.014173135161399841, decouple_loss:0.0014419298386201262
Iteration: 424, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473629593849182, gen p mean: -0.053650904446840286, mean p set: 0.4478432536125183
loss_pred:0.014257272705435753, decouple_loss:0.0014513492351397872
The modified gen p mean: 0.44652870297431946, gen p mean: -0.048774272203445435, mean p set: 0.44700896739959717
The modified gen p mean: 0.4459882378578186, gen p mean: -0.04948835447430611, mean p set: 0.4464685022830963
loss_pred:0.013904981315135956, decouple_loss:0.0014675532002002
loss_pred:0.014364982955157757, decouple_loss:0.0014440296217799187
Iteration: 425, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475697875022888, gen p mean: -0.05243253707885742, mean p set: 0.4480500817298889
The modified gen p mean: 0.4463469684123993, gen p mean: -0.04978174343705177, mean p set: 0.4468272626399994
loss_pred:0.013228260912001133, decouple_loss:0.0013921266654506326
loss_pred:0.013791795819997787, decouple_loss:0.0014668065123260021
The modified gen p mean: 0.4474562704563141, gen p mean: -0.0476955883204937, mean p set: 0.4479365348815918
loss_pred:0.014315676875412464, decouple_loss:0.0014580595307052135
Iteration: 426, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44668832421302795, gen p mean: -0.04683542996644974, mean p set: 0.44716861844062805
loss_pred:0.013755057007074356, decouple_loss:0.0014514231588691473
The modified gen p mean: 0.44624581933021545, gen p mean: -0.048802588135004044, mean p set: 0.44672611355781555The modified gen p mean: 0.44666650891304016, gen p mean: -0.05123332142829895, mean p set: 0.44714680314064026
loss_pred:0.013930107466876507, decouple_loss:0.0015097028808668256
loss_pred:0.014343105256557465, decouple_loss:0.0014699528692290187
Iteration: 427, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44677552580833435, gen p mean: -0.05055247247219086, mean p set: 0.44725584983825684
The modified gen p mean: 0.44650182127952576, gen p mean: -0.04565802216529846, mean p set: 0.44698208570480347
loss_pred:0.013742965646088123, decouple_loss:0.0013751236256211996
loss_pred:0.014183164574205875, decouple_loss:0.001455007935874164
The modified gen p mean: 0.44708752632141113, gen p mean: -0.04763709753751755, mean p set: 0.44756782054901123
loss_pred:0.013522050343453884, decouple_loss:0.0013244713190943003
Iteration: 428, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44697147607803345, gen p mean: -0.042390938848257065, mean p set: 0.44745174050331116
The modified gen p mean: 0.4458150565624237, gen p mean: -0.041367057710886, mean p set: 0.4462953209877014
loss_pred:0.01382466871291399, decouple_loss:0.001432838849723339
loss_pred:0.01347375474870205, decouple_loss:0.001393103157170117
The modified gen p mean: 0.4462556838989258, gen p mean: -0.04459010064601898, mean p set: 0.4467359483242035
loss_pred:0.013771380297839642, decouple_loss:0.0014935851795598865
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 429, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467221796512604, gen p mean: -0.03749062120914459, mean p set: 0.4472024440765381
loss_pred:0.013956906273961067, decouple_loss:0.001425612485036254
The modified gen p mean: 0.4474700093269348, gen p mean: -0.040366433560848236, mean p set: 0.4479503035545349The modified gen p mean: 0.44611862301826477, gen p mean: -0.04039457440376282, mean p set: 0.44659891724586487
loss_pred:0.01294003613293171, decouple_loss:0.0014336982276290655
loss_pred:0.013818680308759212, decouple_loss:0.001479978789575398
Iteration: 430, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472186267375946, gen p mean: -0.039876922965049744, mean p set: 0.4476989209651947
The modified gen p mean: 0.44630762934684753, gen p mean: -0.03681725636124611, mean p set: 0.44678789377212524
loss_pred:0.01380091905593872, decouple_loss:0.001403555739670992
loss_pred:0.013190391473472118, decouple_loss:0.0013885555090382695
The modified gen p mean: 0.44590479135513306, gen p mean: -0.03665851801633835, mean p set: 0.44638508558273315
loss_pred:0.013593151234090328, decouple_loss:0.0014106826856732368
2023-05-01 00:00:41 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.04170094057917595, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.036935873329639435, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.037325065582990646, mean p set: 0.4500633478164673
loss_pred:0.01928669400513172, decouple_loss:0.0014834348112344742
loss_pred:0.01810472458600998, decouple_loss:0.0014075936051085591
loss_pred:0.01822737604379654, decouple_loss:0.0014250962994992733
WV_0_PC_1_EH_0_PS_40, loss: 0.01861153542995453, avg_mse: 0.02708955854177475
current test mse: 0.02709
Iteration: 431, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44658491015434265, gen p mean: -0.04298454895615578, mean p set: 0.44706523418426514
The modified gen p mean: 0.4463847279548645, gen p mean: -0.03744269534945488, mean p set: 0.4468649923801422
The modified gen p mean: 0.4476163685321808, gen p mean: -0.036375269293785095, mean p set: 0.4480966627597809
loss_pred:0.013774922117590904, decouple_loss:0.0013707400066778064
loss_pred:0.014033826999366283, decouple_loss:0.0014006957644596696
loss_pred:0.013829314149916172, decouple_loss:0.0014341509668156505
Iteration: 432, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478497803211212, gen p mean: -0.04545348137617111, mean p set: 0.4483300447463989The modified gen p mean: 0.44701579213142395, gen p mean: -0.04226955026388168, mean p set: 0.44749605655670166
loss_pred:0.013775116764008999, decouple_loss:0.001721974927932024
loss_pred:0.01336496789008379, decouple_loss:0.0018939683213829994
The modified gen p mean: 0.44626617431640625, gen p mean: -0.0406184121966362, mean p set: 0.44674646854400635
loss_pred:0.013141181319952011, decouple_loss:0.0015017035184428096
Iteration: 433, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466501772403717, gen p mean: -0.04785004258155823, mean p set: 0.4471304714679718
The modified gen p mean: 0.44651859998703003, gen p mean: -0.0447356216609478, mean p set: 0.4469989240169525
loss_pred:0.013632295653223991, decouple_loss:0.0016235987422987819
loss_pred:0.013578592799603939, decouple_loss:0.0015808165771886706
The modified gen p mean: 0.4466029703617096, gen p mean: -0.0445534773170948, mean p set: 0.4470832645893097
loss_pred:0.01304815337061882, decouple_loss:0.0013981754891574383
Iteration: 434, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476061463356018, gen p mean: -0.051839679479599, mean p set: 0.4480864405632019
loss_pred:0.013584310188889503, decouple_loss:0.0014153645606711507
The modified gen p mean: 0.44710981845855713, gen p mean: -0.05161887779831886, mean p set: 0.4475901126861572The modified gen p mean: 0.44674399495124817, gen p mean: -0.053778525441884995, mean p set: 0.44722431898117065
loss_pred:0.013727250508964062, decouple_loss:0.0014150830684229732
loss_pred:0.013618924655020237, decouple_loss:0.001589686842635274
Iteration: 435, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44795098900794983, gen p mean: -0.05362127348780632, mean p set: 0.4484312832355499
loss_pred:0.013582687824964523, decouple_loss:0.0014248067745938897
The modified gen p mean: 0.44771623611450195, gen p mean: -0.049756232649087906, mean p set: 0.44819650053977966The modified gen p mean: 0.44725653529167175, gen p mean: -0.05072681978344917, mean p set: 0.44773682951927185
loss_pred:0.013541916385293007, decouple_loss:0.0013370171654969454
loss_pred:0.013105688616633415, decouple_loss:0.0012962671462446451
Iteration: 436, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446078360080719, gen p mean: -0.05149872601032257, mean p set: 0.4465586841106415
loss_pred:0.013960896991193295, decouple_loss:0.001339136390015483
The modified gen p mean: 0.44695645570755005, gen p mean: -0.05720028653740883, mean p set: 0.44743674993515015The modified gen p mean: 0.44661709666252136, gen p mean: -0.05094580724835396, mean p set: 0.44709739089012146
loss_pred:0.01345456950366497, decouple_loss:0.0013477966422215104
loss_pred:0.013843211345374584, decouple_loss:0.0013347218045964837
Iteration: 437, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44654765725135803, gen p mean: -0.049260616302490234, mean p set: 0.44702792167663574
loss_pred:0.013444249518215656, decouple_loss:0.001275702379643917
The modified gen p mean: 0.4467817544937134, gen p mean: -0.05210382118821144, mean p set: 0.44726207852363586The modified gen p mean: 0.4464870095252991, gen p mean: -0.05152308568358421, mean p set: 0.44696730375289917
loss_pred:0.013243498280644417, decouple_loss:0.001293085515499115
loss_pred:0.01369506772607565, decouple_loss:0.0012507623760029674
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012003_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012003_3_24hr.npz
NaN value num: 0
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 438, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479374587535858, gen p mean: -0.05003608763217926, mean p set: 0.4484177529811859
loss_pred:0.013873381540179253, decouple_loss:0.0011996974935755134
The modified gen p mean: 0.4475441873073578, gen p mean: -0.04928691312670708, mean p set: 0.4480244815349579The modified gen p mean: 0.4475654065608978, gen p mean: -0.04866914451122284, mean p set: 0.44804567098617554
loss_pred:0.013325993902981281, decouple_loss:0.001262496691197157
loss_pred:0.013347805477678776, decouple_loss:0.0012252269079908729
Iteration: 439, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44918733835220337, gen p mean: -0.05005533620715141, mean p set: 0.4496676027774811
loss_pred:0.0137547068297863, decouple_loss:0.0012962307082489133
The modified gen p mean: 0.4486088156700134, gen p mean: -0.04768498241901398, mean p set: 0.44908908009529114The modified gen p mean: 0.44824665784835815, gen p mean: -0.04366748407483101, mean p set: 0.44872695207595825
loss_pred:0.013687266036868095, decouple_loss:0.0011968350736424327
loss_pred:0.01384612824767828, decouple_loss:0.0012552122352644801
Iteration: 440, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44771504402160645, gen p mean: -0.048941172659397125, mean p set: 0.44819530844688416
loss_pred:0.013602261431515217, decouple_loss:0.0012194064911454916
The modified gen p mean: 0.44784727692604065, gen p mean: -0.048080503940582275, mean p set: 0.44832760095596313The modified gen p mean: 0.44768255949020386, gen p mean: -0.04928493872284889, mean p set: 0.44816285371780396
loss_pred:0.013349326327443123, decouple_loss:0.0012722526444122195
loss_pred:0.01280665397644043, decouple_loss:0.0012231889413669705
2023-05-01 00:03:39 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.049305129796266556, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04455223307013512, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.045061007142066956, mean p set: 0.4500633478164673
loss_pred:0.019221723079681396, decouple_loss:0.0013043509097769856
loss_pred:0.018025310710072517, decouple_loss:0.001206328277476132
loss_pred:0.018104977905750275, decouple_loss:0.0011925449362024665
WV_0_PC_1_EH_0_PS_40, loss: 0.018512390553951263, avg_mse: 0.02696824260056019
current test mse: 0.026968
Iteration: 441, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44714847207069397, gen p mean: -0.046207863837480545, mean p set: 0.44762876629829407
The modified gen p mean: 0.44841238856315613, gen p mean: -0.04604474455118179, mean p set: 0.4488926827907562
loss_pred:0.013504431582987309, decouple_loss:0.0012215175665915012
The modified gen p mean: 0.44772955775260925, gen p mean: -0.048100218176841736, mean p set: 0.44820985198020935
loss_pred:0.014511805027723312, decouple_loss:0.0012339596869423985
loss_pred:0.013519004918634892, decouple_loss:0.0012140297330915928
Iteration: 442, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44832953810691833, gen p mean: -0.04709499329328537, mean p set: 0.44880983233451843
loss_pred:0.014095493592321873, decouple_loss:0.0011833978351205587
The modified gen p mean: 0.44751808047294617, gen p mean: -0.046519096940755844, mean p set: 0.44799840450286865The modified gen p mean: 0.4484110474586487, gen p mean: -0.04742102697491646, mean p set: 0.4488913416862488
loss_pred:0.013825921341776848, decouple_loss:0.0011795754544436932
loss_pred:0.014013048261404037, decouple_loss:0.0011752102291211486
Iteration: 443, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476287364959717, gen p mean: -0.04806739464402199, mean p set: 0.4481090009212494
The modified gen p mean: 0.44823116064071655, gen p mean: -0.04538613557815552, mean p set: 0.44871145486831665
loss_pred:0.013155166991055012, decouple_loss:0.001199172344058752
loss_pred:0.014089043252170086, decouple_loss:0.0011783461086452007
The modified gen p mean: 0.4475077688694, gen p mean: -0.048787668347358704, mean p set: 0.44798803329467773
loss_pred:0.012839501723647118, decouple_loss:0.0013213938800618052
Iteration: 444, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44828885793685913, gen p mean: -0.041833825409412384, mean p set: 0.44876912236213684
loss_pred:0.013721173629164696, decouple_loss:0.001114757265895605
The modified gen p mean: 0.4473778009414673, gen p mean: -0.044522468000650406, mean p set: 0.4478580951690674The modified gen p mean: 0.4476042091846466, gen p mean: -0.044384680688381195, mean p set: 0.4480845034122467
loss_pred:0.013953616842627525, decouple_loss:0.0011218874715268612
loss_pred:0.013142845593392849, decouple_loss:0.0011258405866101384
Iteration: 445, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44874122738838196, gen p mean: -0.042693253606557846, mean p set: 0.44922152161598206
loss_pred:0.013510310091078281, decouple_loss:0.0011828083079308271
The modified gen p mean: 0.4473952651023865, gen p mean: -0.04584197700023651, mean p set: 0.4478755593299866The modified gen p mean: 0.4481653571128845, gen p mean: -0.04409284517168999, mean p set: 0.4486456513404846
loss_pred:0.013561844825744629, decouple_loss:0.0011762328213080764
loss_pred:0.012416633777320385, decouple_loss:0.0011378203053027391
Iteration: 446, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44995635747909546, gen p mean: -0.0458710752427578, mean p set: 0.45043665170669556
loss_pred:0.01321132481098175, decouple_loss:0.0012653340818360448
The modified gen p mean: 0.44847288727760315, gen p mean: -0.04220820963382721, mean p set: 0.44895321130752563The modified gen p mean: 0.4472796618938446, gen p mean: -0.04468647763133049, mean p set: 0.4477599561214447
loss_pred:0.012946147471666336, decouple_loss:0.0012907148338854313
loss_pred:0.012588903307914734, decouple_loss:0.0011517477687448263
Iteration: 447, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44777512550354004, gen p mean: -0.04502391070127487, mean p set: 0.44825538992881775
loss_pred:0.012906322255730629, decouple_loss:0.0011365909595042467
The modified gen p mean: 0.44812750816345215, gen p mean: -0.046535514295101166, mean p set: 0.44860783219337463The modified gen p mean: 0.4491927921772003, gen p mean: -0.046007346361875534, mean p set: 0.4496730864048004
loss_pred:0.013227146118879318, decouple_loss:0.0011483593843877316
loss_pred:0.01296309195458889, decouple_loss:0.001153652905486524
Iteration: 448, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483591914176941, gen p mean: -0.04637619107961655, mean p set: 0.4488394856452942
loss_pred:0.013104432262480259, decouple_loss:0.0012257485650479794
The modified gen p mean: 0.4503796696662903, gen p mean: -0.05019216239452362, mean p set: 0.4508599638938904The modified gen p mean: 0.4482533037662506, gen p mean: -0.04593038931488991, mean p set: 0.4487335979938507
loss_pred:0.012897235341370106, decouple_loss:0.0013497525360435247
loss_pred:0.01320630218833685, decouple_loss:0.0012361552799120545
Iteration: 449, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44741255044937134, gen p mean: -0.04790719971060753, mean p set: 0.44789284467697144
loss_pred:0.012967008166015148, decouple_loss:0.0011140902061015368
The modified gen p mean: 0.4494568407535553, gen p mean: -0.04922456666827202, mean p set: 0.4499371349811554The modified gen p mean: 0.44741371273994446, gen p mean: -0.051018666476011276, mean p set: 0.44789400696754456
loss_pred:0.012963160872459412, decouple_loss:0.0013395912246778607
loss_pred:0.013468090444803238, decouple_loss:0.00110586266964674
Iteration: 450, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473389685153961, gen p mean: -0.05287868157029152, mean p set: 0.4478192627429962
loss_pred:0.012190965004265308, decouple_loss:0.0012150575639680028
The modified gen p mean: 0.4482789635658264, gen p mean: -0.04925334081053734, mean p set: 0.4487592875957489The modified gen p mean: 0.44809475541114807, gen p mean: -0.04961569607257843, mean p set: 0.44857507944107056
loss_pred:0.012512103654444218, decouple_loss:0.0013217057567089796
loss_pred:0.013757227919995785, decouple_loss:0.0012620582710951567
2023-05-01 00:05:33 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.04914699122309685, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.044714584946632385, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04519357904791832, mean p set: 0.4500633478164673
loss_pred:0.01933274045586586, decouple_loss:0.0012400306295603514
loss_pred:0.018155153840780258, decouple_loss:0.001147410599514842
loss_pred:0.01818574033677578, decouple_loss:0.001137804938480258
WV_0_PC_1_EH_0_PS_40, loss: 0.018616633489727974, avg_mse: 0.02719852700829506
current test mse: 0.027199
Iteration: 451, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447377473115921, gen p mean: -0.04588542878627777, mean p set: 0.44785773754119873
The modified gen p mean: 0.4485880732536316, gen p mean: -0.047629546374082565, mean p set: 0.4490683674812317
The modified gen p mean: 0.44785621762275696, gen p mean: -0.048032764345407486, mean p set: 0.44833654165267944
loss_pred:0.013470014557242393, decouple_loss:0.0011998264817520976
loss_pred:0.012759393081068993, decouple_loss:0.0011812036391347647
loss_pred:0.012952341698110104, decouple_loss:0.0011010391172021627
Iteration: 452, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477750062942505, gen p mean: -0.04672279953956604, mean p set: 0.4482552707195282
The modified gen p mean: 0.44851943850517273, gen p mean: -0.049849867820739746, mean p set: 0.4489997327327728
loss_pred:0.01367467362433672, decouple_loss:0.0010536657646298409
loss_pred:0.01288651768118143, decouple_loss:0.0011101068230345845
The modified gen p mean: 0.44804149866104126, gen p mean: -0.0482860766351223, mean p set: 0.44852176308631897
loss_pred:0.013317802920937538, decouple_loss:0.001135037513449788
Iteration: 453, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486084282398224, gen p mean: -0.04382304474711418, mean p set: 0.4490887224674225
The modified gen p mean: 0.4484139084815979, gen p mean: -0.04578786715865135, mean p set: 0.448894202709198
loss_pred:0.012595842592418194, decouple_loss:0.0012188598047941923
loss_pred:0.013610299676656723, decouple_loss:0.00111106364056468
The modified gen p mean: 0.44821539521217346, gen p mean: -0.04397658631205559, mean p set: 0.44869568943977356
loss_pred:0.013218349777162075, decouple_loss:0.0011714118300005794
Iteration: 454, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44710773229599, gen p mean: -0.04471176117658615, mean p set: 0.4475880563259125
loss_pred:0.013067553751170635, decouple_loss:0.0011649633524939418
The modified gen p mean: 0.44844356179237366, gen p mean: -0.04380333051085472, mean p set: 0.44892382621765137The modified gen p mean: 0.44870465993881226, gen p mean: -0.04469243437051773, mean p set: 0.44918495416641235
loss_pred:0.013072672300040722, decouple_loss:0.001042588148266077
loss_pred:0.012802026234567165, decouple_loss:0.001107318908907473
Iteration: 455, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472081959247589, gen p mean: -0.043488454073667526, mean p set: 0.447688490152359
loss_pred:0.013242750428617, decouple_loss:0.0010467559332028031
The modified gen p mean: 0.4495103657245636, gen p mean: -0.04272051900625229, mean p set: 0.4499906599521637The modified gen p mean: 0.44805195927619934, gen p mean: -0.044951554387807846, mean p set: 0.4485322833061218
loss_pred:0.012624391354620457, decouple_loss:0.001056722947396338
loss_pred:0.013007169589400291, decouple_loss:0.001050162361934781
Iteration: 456, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486619234085083, gen p mean: -0.04727519303560257, mean p set: 0.4491422176361084
loss_pred:0.01306894887238741, decouple_loss:0.0011793384328484535
The modified gen p mean: 0.4471968710422516, gen p mean: -0.045568011701107025, mean p set: 0.4476771950721741The modified gen p mean: 0.4478241801261902, gen p mean: -0.045679476112127304, mean p set: 0.4483044445514679
loss_pred:0.01331701036542654, decouple_loss:0.0011455124476924539
loss_pred:0.01417484786361456, decouple_loss:0.0011570536298677325
Iteration: 457, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497060179710388, gen p mean: -0.050453271716833115, mean p set: 0.4501863420009613
loss_pred:0.012902331538498402, decouple_loss:0.0011852484894916415
The modified gen p mean: 0.44813817739486694, gen p mean: -0.050380680710077286, mean p set: 0.44861847162246704
The modified gen p mean: 0.4480275809764862, gen p mean: -0.04831341654062271, mean p set: 0.4485079050064087
loss_pred:0.01289660669863224, decouple_loss:0.0011323579819872975
loss_pred:0.012794408947229385, decouple_loss:0.0010180374374613166
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012014_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012014_3_24hr.npz
NaN value num: 0
Iteration: 458, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4459546208381653, gen p mean: -0.05005858466029167, mean p set: 0.44643494486808777
loss_pred:0.013384487479925156, decouple_loss:0.0011713028652593493
The modified gen p mean: 0.44689762592315674, gen p mean: -0.04521681368350983, mean p set: 0.44737792015075684The modified gen p mean: 0.44740718603134155, gen p mean: -0.04658828675746918, mean p set: 0.44788745045661926
loss_pred:0.013915177434682846, decouple_loss:0.0011983361328020692
loss_pred:0.013976768590509892, decouple_loss:0.0011658848961815238
Iteration: 459, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44647157192230225, gen p mean: -0.05211665481328964, mean p set: 0.44695183634757996
loss_pred:0.013766885735094547, decouple_loss:0.0011277112644165754
The modified gen p mean: 0.44548192620277405, gen p mean: -0.05091576650738716, mean p set: 0.44596222043037415The modified gen p mean: 0.4464482367038727, gen p mean: -0.045905958861112595, mean p set: 0.44692856073379517
loss_pred:0.013601524755358696, decouple_loss:0.0011751371202990413
loss_pred:0.013657532632350922, decouple_loss:0.001164416316896677
Iteration: 460, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480317533016205, gen p mean: -0.04928508400917053, mean p set: 0.44851207733154297
loss_pred:0.013392130844295025, decouple_loss:0.0012223041849210858
The modified gen p mean: 0.44761812686920166, gen p mean: -0.047163158655166626, mean p set: 0.44809842109680176The modified gen p mean: 0.44656628370285034, gen p mean: -0.049515653401613235, mean p set: 0.44704657793045044
loss_pred:0.013561881147325039, decouple_loss:0.0012279879301786423
loss_pred:0.013937363401055336, decouple_loss:0.0011048237793147564
2023-05-01 00:08:40 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.04863150417804718, mean p set: 0.4502691626548767
The modified gen p mean: 0.4498766362667084, gen p mean: -0.04431183636188507, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.044881366193294525, mean p set: 0.4500633478164673
loss_pred:0.0192266758531332, decouple_loss:0.001277918927371502
loss_pred:0.018037032335996628, decouple_loss:0.0011487569427117705
loss_pred:0.018100298941135406, decouple_loss:0.0011163210729137063
WV_0_PC_1_EH_0_PS_40, loss: 0.018513720482587814, avg_mse: 0.027019718661904335
current test mse: 0.02702
Iteration: 461, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44696757197380066, gen p mean: -0.04497222229838371, mean p set: 0.44744786620140076
The modified gen p mean: 0.4457559883594513, gen p mean: -0.04741701856255531, mean p set: 0.4462362825870514
The modified gen p mean: 0.4475099444389343, gen p mean: -0.04600386321544647, mean p set: 0.44799020886421204
loss_pred:0.013682661578059196, decouple_loss:0.0011471097823232412
loss_pred:0.01384865865111351, decouple_loss:0.00116283493116498
loss_pred:0.013489446602761745, decouple_loss:0.0011361290235072374
Iteration: 462, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479432702064514, gen p mean: -0.045238737016916275, mean p set: 0.4484235644340515
The modified gen p mean: 0.4469756782054901, gen p mean: -0.04435206949710846, mean p set: 0.4474559724330902
loss_pred:0.013180620037019253, decouple_loss:0.0010456120362505317
loss_pred:0.01324705220758915, decouple_loss:0.0012019190471619368
The modified gen p mean: 0.4476187825202942, gen p mean: -0.044569339603185654, mean p set: 0.4480991065502167
loss_pred:0.013703589327633381, decouple_loss:0.0011301187332719564
Iteration: 463, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44583743810653687, gen p mean: -0.048604816198349, mean p set: 0.44631776213645935
loss_pred:0.013320527970790863, decouple_loss:0.0011447530705481768
The modified gen p mean: 0.4467129707336426, gen p mean: -0.04787115752696991, mean p set: 0.4471932351589203The modified gen p mean: 0.4466250538825989, gen p mean: -0.045762598514556885, mean p set: 0.447105348110199
loss_pred:0.013773503713309765, decouple_loss:0.0011552724754437804
loss_pred:0.013787893578410149, decouple_loss:0.0010994358453899622
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 464, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467596411705017, gen p mean: -0.042019955813884735, mean p set: 0.4472399353981018
loss_pred:0.013817254453897476, decouple_loss:0.0010279681300744414
The modified gen p mean: 0.4462399482727051, gen p mean: -0.0450778566300869, mean p set: 0.4467202425003052The modified gen p mean: 0.4480520486831665, gen p mean: -0.04624643176794052, mean p set: 0.448532372713089
loss_pred:0.01377381756901741, decouple_loss:0.0010746341431513429
loss_pred:0.013476314954459667, decouple_loss:0.0011302968487143517
Iteration: 465, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477819800376892, gen p mean: -0.04915425553917885, mean p set: 0.4482622444629669
loss_pred:0.013932449743151665, decouple_loss:0.0010393814882263541
The modified gen p mean: 0.4473945200443268, gen p mean: -0.0458400659263134, mean p set: 0.44787484407424927The modified gen p mean: 0.44718873500823975, gen p mean: -0.04706399887800217, mean p set: 0.44766902923583984
loss_pred:0.013442518189549446, decouple_loss:0.0010339189320802689
loss_pred:0.013531343080103397, decouple_loss:0.001081210095435381
Iteration: 466, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44607147574424744, gen p mean: -0.04991074651479721, mean p set: 0.44655176997184753
loss_pred:0.013793117366731167, decouple_loss:0.0010764101753011346
The modified gen p mean: 0.44727882742881775, gen p mean: -0.04893749579787254, mean p set: 0.44775912165641785The modified gen p mean: 0.4467751085758209, gen p mean: -0.04732072353363037, mean p set: 0.44725537300109863
loss_pred:0.013267231173813343, decouple_loss:0.0011660093441605568
loss_pred:0.013958211056888103, decouple_loss:0.0012170762056484818
Iteration: 467, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44743824005126953, gen p mean: -0.044196002185344696, mean p set: 0.447918564081192
loss_pred:0.012937404215335846, decouple_loss:0.0010345005430281162
The modified gen p mean: 0.4458337724208832, gen p mean: -0.04395449906587601, mean p set: 0.4463140368461609The modified gen p mean: 0.44621577858924866, gen p mean: -0.041232142597436905, mean p set: 0.44669607281684875
loss_pred:0.013682263903319836, decouple_loss:0.0010030025150626898
loss_pred:0.013288328424096107, decouple_loss:0.001008299645036459
Iteration: 468, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44592297077178955, gen p mean: -0.04225057736039162, mean p set: 0.44640329480171204
loss_pred:0.013590125367045403, decouple_loss:0.0010498985648155212
The modified gen p mean: 0.4468311071395874, gen p mean: -0.044625554233789444, mean p set: 0.4473114311695099The modified gen p mean: 0.44619378447532654, gen p mean: -0.04324588179588318, mean p set: 0.44667407870292664
loss_pred:0.01313734706491232, decouple_loss:0.0009967004880309105
loss_pred:0.013906882144510746, decouple_loss:0.0009841903811320662
Iteration: 469, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478432238101959, gen p mean: -0.04259324446320534, mean p set: 0.448323518037796
loss_pred:0.013695092871785164, decouple_loss:0.001087138894945383
The modified gen p mean: 0.44653698801994324, gen p mean: -0.04517267644405365, mean p set: 0.4470173120498657The modified gen p mean: 0.4452938735485077, gen p mean: -0.04491668567061424, mean p set: 0.4457741975784302
loss_pred:0.013429401442408562, decouple_loss:0.0010880448389798403
loss_pred:0.013338971883058548, decouple_loss:0.001137632061727345
Iteration: 470, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44765180349349976, gen p mean: -0.04429183900356293, mean p set: 0.44813206791877747
loss_pred:0.01371755637228489, decouple_loss:0.0010343748144805431
The modified gen p mean: 0.44568219780921936, gen p mean: -0.0423283614218235, mean p set: 0.44616246223449707The modified gen p mean: 0.44649195671081543, gen p mean: -0.047184333205223083, mean p set: 0.4469722807407379
loss_pred:0.013981690630316734, decouple_loss:0.0010547054698690772
loss_pred:0.013521596789360046, decouple_loss:0.0010255801025778055
2023-05-01 00:10:32 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.04687760770320892, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04259463772177696, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04316291958093643, mean p set: 0.4500633478164673
loss_pred:0.019261421635746956, decouple_loss:0.0012759696692228317
loss_pred:0.018115652725100517, decouple_loss:0.001109698205254972
loss_pred:0.01816263049840927, decouple_loss:0.0011346261017024517
WV_0_PC_1_EH_0_PS_40, loss: 0.01857190579175949, avg_mse: 0.027130763977766037
current test mse: 0.027131
Iteration: 471, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44669991731643677, gen p mean: -0.04889512434601784, mean p set: 0.4471801817417145
The modified gen p mean: 0.4464617967605591, gen p mean: -0.04525820165872574, mean p set: 0.4469420909881592
The modified gen p mean: 0.44759777188301086, gen p mean: -0.04513171687722206, mean p set: 0.44807806611061096
loss_pred:0.013669228181242943, decouple_loss:0.0011271844850853086
loss_pred:0.013916061259806156, decouple_loss:0.0011996707180514932
loss_pred:0.01401193905621767, decouple_loss:0.0011120749404653907
Iteration: 472, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44631731510162354, gen p mean: -0.047482945024967194, mean p set: 0.44679760932922363
The modified gen p mean: 0.4464503824710846, gen p mean: -0.048230838030576706, mean p set: 0.4469307065010071loss_pred:0.013849807903170586, decouple_loss:0.0010147375287488103
The modified gen p mean: 0.4475047290325165, gen p mean: -0.04777899011969566, mean p set: 0.4479850232601166
loss_pred:0.01350279152393341, decouple_loss:0.0010007729288190603
loss_pred:0.014011628925800323, decouple_loss:0.001019803574308753
Iteration: 473, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.445599764585495, gen p mean: -0.05235409736633301, mean p set: 0.4460800588130951
loss_pred:0.013143066316843033, decouple_loss:0.0010483709629625082
The modified gen p mean: 0.44601970911026, gen p mean: -0.04841695725917816, mean p set: 0.4465000033378601The modified gen p mean: 0.4465043246746063, gen p mean: -0.04885930195450783, mean p set: 0.4469846189022064
loss_pred:0.013852905482053757, decouple_loss:0.0010854221181944013
loss_pred:0.013253744691610336, decouple_loss:0.001060074893757701
Iteration: 474, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465695321559906, gen p mean: -0.047390975058078766, mean p set: 0.4470498263835907
loss_pred:0.012814492918550968, decouple_loss:0.0010273114312440157
The modified gen p mean: 0.44622841477394104, gen p mean: -0.04809826985001564, mean p set: 0.4467087388038635
The modified gen p mean: 0.4472518563270569, gen p mean: -0.04516530781984329, mean p set: 0.447732150554657
loss_pred:0.013652388006448746, decouple_loss:0.0011707738740369678
loss_pred:0.013301532715559006, decouple_loss:0.0012741971295326948
Iteration: 475, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44605615735054016, gen p mean: -0.04606929421424866, mean p set: 0.44653645157814026
loss_pred:0.012903659604489803, decouple_loss:0.0010380608728155494
The modified gen p mean: 0.4465339481830597, gen p mean: -0.04093507304787636, mean p set: 0.4470142424106598The modified gen p mean: 0.4459005892276764, gen p mean: -0.047044575214385986, mean p set: 0.4463808834552765
loss_pred:0.013240576721727848, decouple_loss:0.0010070318821817636
loss_pred:0.013308752328157425, decouple_loss:0.0010461799101904035
Iteration: 476, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44654616713523865, gen p mean: -0.04253916069865227, mean p set: 0.44702646136283875
loss_pred:0.013332163915038109, decouple_loss:0.0010396101279184222
The modified gen p mean: 0.44665440917015076, gen p mean: -0.04458247870206833, mean p set: 0.44713470339775085The modified gen p mean: 0.4459228217601776, gen p mean: -0.04400039464235306, mean p set: 0.4464031159877777
loss_pred:0.01345696859061718, decouple_loss:0.0010539899813011289
loss_pred:0.013695537112653255, decouple_loss:0.0010768515057861805
Iteration: 477, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44840914011001587, gen p mean: -0.04680299013853073, mean p set: 0.44888943433761597
The modified gen p mean: 0.44703683257102966, gen p mean: -0.048266444355249405, mean p set: 0.44751712679862976loss_pred:0.013413917273283005, decouple_loss:0.001013424713164568
The modified gen p mean: 0.4480176568031311, gen p mean: -0.04475760459899902, mean p set: 0.4484979510307312
loss_pred:0.013600759208202362, decouple_loss:0.0009877100819721818
loss_pred:0.013627303764224052, decouple_loss:0.0009657088667154312
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012010_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012010_3_24hr.npz
NaN value num: 0
Iteration: 478, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503456652164459, gen p mean: -0.041739631444215775, mean p set: 0.4508259892463684
loss_pred:0.017909303307533264, decouple_loss:0.0010988304857164621
The modified gen p mean: 0.45143741369247437, gen p mean: -0.03997569531202316, mean p set: 0.4519176781177521The modified gen p mean: 0.4508810043334961, gen p mean: -0.041501354426145554, mean p set: 0.4513612687587738
loss_pred:0.018496552482247353, decouple_loss:0.0011951607884839177
loss_pred:0.018426189199090004, decouple_loss:0.0011288967216387391
Iteration: 479, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504493772983551, gen p mean: -0.040361929684877396, mean p set: 0.4509296715259552
The modified gen p mean: 0.450673371553421, gen p mean: -0.034946974366903305, mean p set: 0.4511536657810211
loss_pred:0.019174428656697273, decouple_loss:0.00114407145883888
loss_pred:0.017623087391257286, decouple_loss:0.0011656328570097685
The modified gen p mean: 0.45070645213127136, gen p mean: -0.03656268119812012, mean p set: 0.4511867165565491
loss_pred:0.019262095913290977, decouple_loss:0.001140024745836854
Iteration: 480, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45160576701164246, gen p mean: -0.03414272516965866, mean p set: 0.45208606123924255
loss_pred:0.018348895013332367, decouple_loss:0.0012808030005544424
The modified gen p mean: 0.45000413060188293, gen p mean: -0.03306915611028671, mean p set: 0.45048442482948303The modified gen p mean: 0.4505902826786041, gen p mean: -0.03172590956091881, mean p set: 0.4510705769062042
loss_pred:0.01850784197449684, decouple_loss:0.0012283272808417678
loss_pred:0.01783483661711216, decouple_loss:0.0011703058844432235
2023-05-01 00:13:04 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.040502700954675674, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.03655911982059479, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.03687407448887825, mean p set: 0.4500633478164673
loss_pred:0.01873425953090191, decouple_loss:0.001303464756347239
loss_pred:0.017634378746151924, decouple_loss:0.0013433704152703285
loss_pred:0.017713936045765877, decouple_loss:0.0013192486949265003
WV_0_PC_1_EH_0_PS_40, loss: 0.01809362694621086, avg_mse: 0.026092881336808205
current test mse: 0.026093
Iteration: 481, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4512858986854553, gen p mean: -0.03377065062522888, mean p set: 0.45176616311073303
The modified gen p mean: 0.45035356283187866, gen p mean: -0.03396179527044296, mean p set: 0.45083388686180115
The modified gen p mean: 0.4506233036518097, gen p mean: -0.037033114582300186, mean p set: 0.4511035680770874
loss_pred:0.01873933896422386, decouple_loss:0.0012352163903415203
loss_pred:0.01803998090326786, decouple_loss:0.0013026075903326273
loss_pred:0.018384531140327454, decouple_loss:0.0012644012458622456
Iteration: 482, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508184790611267, gen p mean: -0.03189679607748985, mean p set: 0.4512987732887268
The modified gen p mean: 0.45093023777008057, gen p mean: -0.03505362942814827, mean p set: 0.45141053199768066
loss_pred:0.017889004200696945, decouple_loss:0.0012781034456565976
loss_pred:0.018815143033862114, decouple_loss:0.00130775838624686The modified gen p mean: 0.4511512517929077, gen p mean: -0.034839000552892685, mean p set: 0.4516315758228302
loss_pred:0.01844235323369503, decouple_loss:0.0012707679998129606
Iteration: 483, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504936635494232, gen p mean: -0.03507339209318161, mean p set: 0.4509739875793457
loss_pred:0.01811801642179489, decouple_loss:0.0012277523055672646
The modified gen p mean: 0.45102566480636597, gen p mean: -0.033832453191280365, mean p set: 0.45150595903396606The modified gen p mean: 0.45091500878334045, gen p mean: -0.03490142151713371, mean p set: 0.45139533281326294
loss_pred:0.01792925037443638, decouple_loss:0.0013760750880464911
loss_pred:0.01778959482908249, decouple_loss:0.0012182972859591246
Iteration: 484, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508441686630249, gen p mean: -0.032099682837724686, mean p set: 0.4513244926929474
loss_pred:0.018300389871001244, decouple_loss:0.0012526803184300661
The modified gen p mean: 0.45150989294052124, gen p mean: -0.03345255181193352, mean p set: 0.45199018716812134The modified gen p mean: 0.45011213421821594, gen p mean: -0.03837842866778374, mean p set: 0.4505924582481384
loss_pred:0.017803503200411797, decouple_loss:0.0012190458364784718
loss_pred:0.01753726415336132, decouple_loss:0.0011950100306421518
Iteration: 485, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450674831867218, gen p mean: -0.04039793089032173, mean p set: 0.4511551260948181
loss_pred:0.01898062787950039, decouple_loss:0.0012177963508293033
The modified gen p mean: 0.4498886168003082, gen p mean: -0.04031718522310257, mean p set: 0.4503689110279083The modified gen p mean: 0.4491048753261566, gen p mean: -0.03443450108170509, mean p set: 0.4495851993560791
loss_pred:0.017943184822797775, decouple_loss:0.0012432713992893696
loss_pred:0.018253061920404434, decouple_loss:0.001243956503458321
Iteration: 486, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44879794120788574, gen p mean: -0.03335322439670563, mean p set: 0.44927823543548584
The modified gen p mean: 0.45113706588745117, gen p mean: -0.03468053415417671, mean p set: 0.45161738991737366
loss_pred:0.018382200971245766, decouple_loss:0.0011791606666520238
loss_pred:0.017191683873534203, decouple_loss:0.0013205602299422026
The modified gen p mean: 0.45087429881095886, gen p mean: -0.030927402898669243, mean p set: 0.45135459303855896
loss_pred:0.017122896388173103, decouple_loss:0.0011939206160604954
Iteration: 487, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513743817806244, gen p mean: -0.030672188848257065, mean p set: 0.4518546462059021
loss_pred:0.017833353951573372, decouple_loss:0.001280894735828042
The modified gen p mean: 0.45126527547836304, gen p mean: -0.03503051772713661, mean p set: 0.45174556970596313The modified gen p mean: 0.4508250653743744, gen p mean: -0.0302890632301569, mean p set: 0.4513053894042969
loss_pred:0.018149981275200844, decouple_loss:0.001239547273144126
loss_pred:0.017287686467170715, decouple_loss:0.0012133922427892685
Iteration: 488, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500940144062042, gen p mean: -0.036364082247018814, mean p set: 0.4505743086338043
loss_pred:0.018363524228334427, decouple_loss:0.0012047041673213243
The modified gen p mean: 0.4498027563095093, gen p mean: -0.038144733756780624, mean p set: 0.450283020734787The modified gen p mean: 0.45182347297668457, gen p mean: -0.034879401326179504, mean p set: 0.4523037374019623
loss_pred:0.017409736290574074, decouple_loss:0.001288732630200684
loss_pred:0.017678866162896156, decouple_loss:0.0011612431844696403
Iteration: 489, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503123164176941, gen p mean: -0.040646880865097046, mean p set: 0.4507925808429718The modified gen p mean: 0.45181915163993835, gen p mean: -0.035948507487773895, mean p set: 0.45229944586753845
loss_pred:0.01750759966671467, decouple_loss:0.0012463661842048168
loss_pred:0.017547719180583954, decouple_loss:0.0011666640639305115
The modified gen p mean: 0.45170944929122925, gen p mean: -0.03660106658935547, mean p set: 0.45218974351882935
loss_pred:0.017902158200740814, decouple_loss:0.0012290008598938584
Iteration: 490, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505714178085327, gen p mean: -0.03909781202673912, mean p set: 0.4510516822338104
loss_pred:0.017258809879422188, decouple_loss:0.0010155870113521814
The modified gen p mean: 0.4503781795501709, gen p mean: -0.03516390919685364, mean p set: 0.450858473777771The modified gen p mean: 0.4501503109931946, gen p mean: -0.039982326328754425, mean p set: 0.45063063502311707
loss_pred:0.017170952633023262, decouple_loss:0.0010709065245464444
loss_pred:0.018149470910429955, decouple_loss:0.0011329712579026818
2023-05-01 00:14:56 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.04389345273375511, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.03958742320537567, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.03975243866443634, mean p set: 0.4500633478164673
loss_pred:0.01850712113082409, decouple_loss:0.0012366474838927388
loss_pred:0.017430614680051804, decouple_loss:0.0012103557819500566
loss_pred:0.017554910853505135, decouple_loss:0.001194574637338519
WV_0_PC_1_EH_0_PS_40, loss: 0.017891576513648033, avg_mse: 0.025684913620352745
current test mse: 0.025685
Iteration: 491, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508654475212097, gen p mean: -0.03868800401687622, mean p set: 0.4513457417488098
The modified gen p mean: 0.45091620087623596, gen p mean: -0.03726905956864357, mean p set: 0.45139649510383606
The modified gen p mean: 0.4500954747200012, gen p mean: -0.03899199888110161, mean p set: 0.4505757987499237
loss_pred:0.01719064451754093, decouple_loss:0.0010859101312234998
loss_pred:0.018546588718891144, decouple_loss:0.0011197144631296396
loss_pred:0.01831401325762272, decouple_loss:0.0011493171332404017
Iteration: 492, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45136839151382446, gen p mean: -0.04055333137512207, mean p set: 0.4518486559391022
The modified gen p mean: 0.4505552351474762, gen p mean: -0.03800546005368233, mean p set: 0.4510355293750763
loss_pred:0.01698293350636959, decouple_loss:0.0010816084686666727
loss_pred:0.0175711028277874, decouple_loss:0.0012182523496448994
The modified gen p mean: 0.45211341977119446, gen p mean: -0.04079948738217354, mean p set: 0.45259371399879456
loss_pred:0.017520276829600334, decouple_loss:0.0012161006452515721
Iteration: 493, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4525202810764313, gen p mean: -0.04308250918984413, mean p set: 0.45300063490867615
The modified gen p mean: 0.45217272639274597, gen p mean: -0.041524726897478104, mean p set: 0.45265302062034607
loss_pred:0.016929782927036285, decouple_loss:0.0011308799730613828
loss_pred:0.01727624237537384, decouple_loss:0.001107709715142846
The modified gen p mean: 0.4510484039783478, gen p mean: -0.04143831506371498, mean p set: 0.45152872800827026
loss_pred:0.017570331692695618, decouple_loss:0.001064845360815525
Iteration: 494, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500894844532013, gen p mean: -0.04775966703891754, mean p set: 0.4505697786808014
The modified gen p mean: 0.45080429315567017, gen p mean: -0.050047289580106735, mean p set: 0.45128458738327026
loss_pred:0.018713152036070824, decouple_loss:0.0011886429274454713
loss_pred:0.018107520416378975, decouple_loss:0.001137654180638492
The modified gen p mean: 0.4503532350063324, gen p mean: -0.04335376247763634, mean p set: 0.4508335292339325
loss_pred:0.017771346494555473, decouple_loss:0.001074103987775743
Iteration: 495, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503062069416046, gen p mean: -0.043942298740148544, mean p set: 0.4507865309715271
The modified gen p mean: 0.45091378688812256, gen p mean: -0.03966313973069191, mean p set: 0.45139408111572266
loss_pred:0.01693110354244709, decouple_loss:0.0010602042311802506
loss_pred:0.017650475725531578, decouple_loss:0.001181510859169066
The modified gen p mean: 0.45096108317375183, gen p mean: -0.041527047753334045, mean p set: 0.45144134759902954
loss_pred:0.017316922545433044, decouple_loss:0.0011595675023272634
Iteration: 496, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4515972435474396, gen p mean: -0.04050986096262932, mean p set: 0.4520775377750397
loss_pred:0.017016472294926643, decouple_loss:0.0010926596587523818
The modified gen p mean: 0.4503021240234375, gen p mean: -0.040798865258693695, mean p set: 0.45078244805336The modified gen p mean: 0.4497883915901184, gen p mean: -0.04080076143145561, mean p set: 0.4502687156200409
loss_pred:0.01760292984545231, decouple_loss:0.0010989626171067357
loss_pred:0.01707581989467144, decouple_loss:0.0010705603053793311
Iteration: 497, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.451200932264328, gen p mean: -0.035567935556173325, mean p set: 0.4516811966896057
loss_pred:0.017563913017511368, decouple_loss:0.001148322713561356
The modified gen p mean: 0.4501175284385681, gen p mean: -0.037168845534324646, mean p set: 0.4505978226661682The modified gen p mean: 0.4487875998020172, gen p mean: -0.037697263062000275, mean p set: 0.4492678940296173
loss_pred:0.017568737268447876, decouple_loss:0.0010759920114651322
loss_pred:0.017393847927451134, decouple_loss:0.0010931863216683269
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012003_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012003_3_24hr.npz
NaN value num: 0
Iteration: 498, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497283101081848, gen p mean: -0.0337991937994957, mean p set: 0.4502086043357849
loss_pred:0.01638309471309185, decouple_loss:0.001060042530298233
The modified gen p mean: 0.45181411504745483, gen p mean: -0.030151430517435074, mean p set: 0.45229440927505493The modified gen p mean: 0.4522443115711212, gen p mean: -0.03682365268468857, mean p set: 0.4527246057987213
loss_pred:0.016308745369315147, decouple_loss:0.001124052214436233
loss_pred:0.017598561942577362, decouple_loss:0.0012206024257466197
Iteration: 499, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504478871822357, gen p mean: -0.04083190858364105, mean p set: 0.4509281814098358
loss_pred:0.01678331382572651, decouple_loss:0.0011237075086683035
The modified gen p mean: 0.4511606693267822, gen p mean: -0.033511944115161896, mean p set: 0.45164093375205994
The modified gen p mean: 0.4504151940345764, gen p mean: -0.03389458730816841, mean p set: 0.4508955478668213
loss_pred:0.016162291169166565, decouple_loss:0.0011122380383312702
loss_pred:0.016249919310212135, decouple_loss:0.0010544250253587961
Iteration: 500, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45045846700668335, gen p mean: -0.03296639770269394, mean p set: 0.45093876123428345
loss_pred:0.016556039452552795, decouple_loss:0.0012426665052771568
The modified gen p mean: 0.45255526900291443, gen p mean: -0.031967416405677795, mean p set: 0.45303553342819214The modified gen p mean: 0.45187821984291077, gen p mean: -0.032326553016901016, mean p set: 0.45235851407051086
loss_pred:0.016989892348647118, decouple_loss:0.0010770794469863176
loss_pred:0.01634538732469082, decouple_loss:0.0010222987039014697
2023-05-01 00:17:29 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.045460280030965805, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.040939245373010635, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.04150821641087532, mean p set: 0.4500633478164673
loss_pred:0.018450697883963585, decouple_loss:0.0011482896516099572
loss_pred:0.017353439703583717, decouple_loss:0.0011599741410464048
loss_pred:0.017414700239896774, decouple_loss:0.0011607533087953925
WV_0_PC_1_EH_0_PS_40, loss: 0.017797430977225304, avg_mse: 0.025544794276356697
current test mse: 0.025545
Iteration: 501, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500848352909088, gen p mean: -0.037627529352903366, mean p set: 0.4505651295185089
The modified gen p mean: 0.4514724612236023, gen p mean: -0.033253032714128494, mean p set: 0.4519527554512024
The modified gen p mean: 0.45086026191711426, gen p mean: -0.03761095181107521, mean p set: 0.45134058594703674
loss_pred:0.016161218285560608, decouple_loss:0.0010770921362563968
loss_pred:0.016757981851696968, decouple_loss:0.0010850861435756087loss_pred:0.016306119039654732, decouple_loss:0.001076467800885439
Iteration: 502, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45121800899505615, gen p mean: -0.034652505069971085, mean p set: 0.45169830322265625
The modified gen p mean: 0.45046862959861755, gen p mean: -0.0366385318338871, mean p set: 0.45094895362854004
loss_pred:0.01604321040213108, decouple_loss:0.0011486259754747152
loss_pred:0.01648331992328167, decouple_loss:0.00101838493719697
The modified gen p mean: 0.45126569271087646, gen p mean: -0.0402301587164402, mean p set: 0.4517459571361542
loss_pred:0.016228480264544487, decouple_loss:0.0011506940936669707
Iteration: 503, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4518909454345703, gen p mean: -0.03659960627555847, mean p set: 0.4523712396621704
The modified gen p mean: 0.4506170451641083, gen p mean: -0.04064612090587616, mean p set: 0.45109736919403076
loss_pred:0.01730700023472309, decouple_loss:0.0011544334702193737
loss_pred:0.016420356929302216, decouple_loss:0.0010287414770573378
The modified gen p mean: 0.45319584012031555, gen p mean: -0.036024753004312515, mean p set: 0.45367616415023804
loss_pred:0.01704866997897625, decouple_loss:0.0010866177035495639
Iteration: 504, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513220489025116, gen p mean: -0.039525363594293594, mean p set: 0.4518023431301117
loss_pred:0.01626281626522541, decouple_loss:0.0011484335409477353
The modified gen p mean: 0.45068761706352234, gen p mean: -0.04081742838025093, mean p set: 0.45116788148880005The modified gen p mean: 0.4518243372440338, gen p mean: -0.045987606048583984, mean p set: 0.4523046314716339
loss_pred:0.016463182866573334, decouple_loss:0.0011897378135472536
loss_pred:0.016794348135590553, decouple_loss:0.00122450094204396
Iteration: 505, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4510365128517151, gen p mean: -0.04585029184818268, mean p set: 0.4515168070793152
loss_pred:0.01623251661658287, decouple_loss:0.0011347925756126642
The modified gen p mean: 0.45287272334098816, gen p mean: -0.042952340096235275, mean p set: 0.45335304737091064The modified gen p mean: 0.44978272914886475, gen p mean: -0.042258165776729584, mean p set: 0.45026299357414246
loss_pred:0.017073309049010277, decouple_loss:0.0010848945239558816
loss_pred:0.01701759733259678, decouple_loss:0.00117507204413414
Iteration: 506, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4518912732601166, gen p mean: -0.04724261537194252, mean p set: 0.4523715376853943
loss_pred:0.015705667436122894, decouple_loss:0.0010986141860485077
The modified gen p mean: 0.45170214772224426, gen p mean: -0.04552878439426422, mean p set: 0.45218244194984436The modified gen p mean: 0.45057961344718933, gen p mean: -0.04646651819348335, mean p set: 0.4510599374771118
loss_pred:0.016424736008048058, decouple_loss:0.0010606753639876842
loss_pred:0.01664802059531212, decouple_loss:0.0010340178851038218
Iteration: 507, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4518422484397888, gen p mean: -0.04763563349843025, mean p set: 0.4523225724697113
The modified gen p mean: 0.44996029138565063, gen p mean: -0.049149274826049805, mean p set: 0.45044055581092834
loss_pred:0.0156901553273201, decouple_loss:0.0010899633634835482
loss_pred:0.01706150732934475, decouple_loss:0.0010414343560114503
The modified gen p mean: 0.4511999487876892, gen p mean: -0.04720365256071091, mean p set: 0.4516802132129669
loss_pred:0.015703806653618813, decouple_loss:0.0010451797861605883
Iteration: 508, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502285420894623, gen p mean: -0.04832491651177406, mean p set: 0.4507088363170624
loss_pred:0.016363175585865974, decouple_loss:0.001092639984562993
The modified gen p mean: 0.4514588415622711, gen p mean: -0.043831150978803635, mean p set: 0.4519391357898712The modified gen p mean: 0.4522086977958679, gen p mean: -0.04924779012799263, mean p set: 0.45268896222114563
loss_pred:0.01567569188773632, decouple_loss:0.0011328019900247455
loss_pred:0.01589283160865307, decouple_loss:0.0011658306466415524
Iteration: 509, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511014521121979, gen p mean: -0.049368277192115784, mean p set: 0.4515817165374756
loss_pred:0.01713472232222557, decouple_loss:0.0011528281029313803
The modified gen p mean: 0.45068731904029846, gen p mean: -0.047720689326524734, mean p set: 0.45116758346557617The modified gen p mean: 0.45080626010894775, gen p mean: -0.04985252022743225, mean p set: 0.45128652453422546
loss_pred:0.016085803508758545, decouple_loss:0.0010810852982103825
loss_pred:0.01615452580153942, decouple_loss:0.0010573570616543293
Iteration: 510, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45172634720802307, gen p mean: -0.05132810398936272, mean p set: 0.45220664143562317
The modified gen p mean: 0.44994911551475525, gen p mean: -0.04627758637070656, mean p set: 0.45042940974235535
loss_pred:0.016071205958724022, decouple_loss:0.0009719756199046969
loss_pred:0.01714668609201908, decouple_loss:0.0010127704590559006
The modified gen p mean: 0.4518289268016815, gen p mean: -0.045507948845624924, mean p set: 0.4523092210292816
loss_pred:0.016199979931116104, decouple_loss:0.001047895522788167
2023-05-01 00:19:20 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.05896848812699318, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.05409587174654007, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.05476986989378929, mean p set: 0.4500633478164673
loss_pred:0.01845749467611313, decouple_loss:0.0013383084442466497
loss_pred:0.017337381839752197, decouple_loss:0.001233644550666213
loss_pred:0.017494220286607742, decouple_loss:0.0012687505222856998
WV_0_PC_1_EH_0_PS_40, loss: 0.017827045172452927, avg_mse: 0.025579102337360382
current test mse: 0.025579
Iteration: 511, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4512845575809479, gen p mean: -0.04784315451979637, mean p set: 0.45176488161087036
The modified gen p mean: 0.4503079950809479, gen p mean: -0.05264654755592346, mean p set: 0.450788289308548
The modified gen p mean: 0.45203185081481934, gen p mean: -0.044450193643569946, mean p set: 0.45251214504241943
loss_pred:0.01647784188389778, decouple_loss:0.0012108589289709926
loss_pred:0.016335025429725647, decouple_loss:0.00112349190749228
loss_pred:0.016263524070382118, decouple_loss:0.0011625767219811678
Iteration: 512, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45282426476478577, gen p mean: -0.0449259914457798, mean p set: 0.4533045291900635
The modified gen p mean: 0.45129308104515076, gen p mean: -0.05011233314871788, mean p set: 0.45177337527275085
loss_pred:0.01582520827651024, decouple_loss:0.0010333539685234427
loss_pred:0.016669519245624542, decouple_loss:0.001070906757377088
The modified gen p mean: 0.4496269226074219, gen p mean: -0.0494576059281826, mean p set: 0.45010724663734436
loss_pred:0.016473064199090004, decouple_loss:0.0010081384098157287
Iteration: 513, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4520137310028076, gen p mean: -0.04226897656917572, mean p set: 0.4524940252304077
loss_pred:0.015850231051445007, decouple_loss:0.001077599823474884
The modified gen p mean: 0.4521043300628662, gen p mean: -0.04778726398944855, mean p set: 0.4525846242904663The modified gen p mean: 0.4515930414199829, gen p mean: -0.047453515231609344, mean p set: 0.4520733654499054
loss_pred:0.01633809320628643, decouple_loss:0.0010413160780444741
loss_pred:0.01618221215903759, decouple_loss:0.0009968383237719536
Iteration: 514, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44986605644226074, gen p mean: -0.04360291734337807, mean p set: 0.45034632086753845
loss_pred:0.015989573672413826, decouple_loss:0.0010035031009465456
The modified gen p mean: 0.4533810317516327, gen p mean: -0.042812276631593704, mean p set: 0.4538613259792328The modified gen p mean: 0.45076966285705566, gen p mean: -0.041103824973106384, mean p set: 0.45124995708465576
loss_pred:0.016190141439437866, decouple_loss:0.0010196433868259192
loss_pred:0.016091363504529, decouple_loss:0.001112000667490065
Iteration: 515, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45102256536483765, gen p mean: -0.03900960832834244, mean p set: 0.45150282979011536
loss_pred:0.015961283817887306, decouple_loss:0.001045134966261685
The modified gen p mean: 0.45262864232063293, gen p mean: -0.04139791801571846, mean p set: 0.45310890674591064The modified gen p mean: 0.4492797553539276, gen p mean: -0.03979027271270752, mean p set: 0.4497600495815277
loss_pred:0.016700610518455505, decouple_loss:0.000977307092398405
loss_pred:0.015975696966052055, decouple_loss:0.0009964872151613235
Iteration: 516, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45056816935539246, gen p mean: -0.04090846702456474, mean p set: 0.45104846358299255
loss_pred:0.016067039221525192, decouple_loss:0.001049420447088778
The modified gen p mean: 0.451941579580307, gen p mean: -0.039393216371536255, mean p set: 0.4524218738079071The modified gen p mean: 0.4519196152687073, gen p mean: -0.04035383090376854, mean p set: 0.45239993929862976
loss_pred:0.016045890748500824, decouple_loss:0.0011276003206148744
loss_pred:0.016361195594072342, decouple_loss:0.0010953400051221251
Iteration: 517, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45082539319992065, gen p mean: -0.04037044569849968, mean p set: 0.45130568742752075
loss_pred:0.01606275886297226, decouple_loss:0.0009442162699997425
The modified gen p mean: 0.45107415318489075, gen p mean: -0.04102788865566254, mean p set: 0.45155444741249084The modified gen p mean: 0.4525086283683777, gen p mean: -0.038829755038022995, mean p set: 0.4529889225959778
loss_pred:0.01587994396686554, decouple_loss:0.001170341158285737
loss_pred:0.015864966437220573, decouple_loss:0.001038660411722958
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012005_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012005_3_24hr.npz
NaN value num: 0
Iteration: 518, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45060399174690247, gen p mean: -0.03696861118078232, mean p set: 0.45108428597450256
loss_pred:0.017145557329058647, decouple_loss:0.0010046240640804172
The modified gen p mean: 0.45290035009384155, gen p mean: -0.037009142339229584, mean p set: 0.45338064432144165The modified gen p mean: 0.4494636654853821, gen p mean: -0.03978941962122917, mean p set: 0.4499439597129822
loss_pred:0.016639944165945053, decouple_loss:0.0010947533883154392
loss_pred:0.01753472536802292, decouple_loss:0.001078778994269669
Iteration: 519, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45040592551231384, gen p mean: -0.041757043451070786, mean p set: 0.45088624954223633
loss_pred:0.01732402667403221, decouple_loss:0.0010979694779962301
The modified gen p mean: 0.454100102186203, gen p mean: -0.04525143280625343, mean p set: 0.4545804262161255The modified gen p mean: 0.45198854804039, gen p mean: -0.04818226397037506, mean p set: 0.4524688422679901
loss_pred:0.01711709052324295, decouple_loss:0.0012245423858985305
loss_pred:0.0170170608907938, decouple_loss:0.0012346042785793543
Iteration: 520, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4523387849330902, gen p mean: -0.04266935959458351, mean p set: 0.4528190791606903
The modified gen p mean: 0.4514361023902893, gen p mean: -0.03754211589694023, mean p set: 0.4519164264202118
loss_pred:0.01679944060742855, decouple_loss:0.0010753688402473927
loss_pred:0.017299572005867958, decouple_loss:0.0010915561579167843
The modified gen p mean: 0.4525851309299469, gen p mean: -0.039337728172540665, mean p set: 0.453065425157547
loss_pred:0.017383668571710587, decouple_loss:0.0010596849024295807
2023-05-01 00:22:01 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.047192033380270004, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.0422847718000412, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.042761582881212234, mean p set: 0.4500633478164673
loss_pred:0.01845315471291542, decouple_loss:0.001271560788154602
loss_pred:0.017357109114527702, decouple_loss:0.001235062605701387
loss_pred:0.01744430512189865, decouple_loss:0.0012396570527926087
WV_0_PC_1_EH_0_PS_40, loss: 0.01781396195292473, avg_mse: 0.02557108923792839
current test mse: 0.025571
Iteration: 521, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45024573802948, gen p mean: -0.03648022189736366, mean p set: 0.4507260322570801
The modified gen p mean: 0.4505912661552429, gen p mean: -0.036505430936813354, mean p set: 0.451071560382843
The modified gen p mean: 0.4493984580039978, gen p mean: -0.03909292072057724, mean p set: 0.4498787522315979
loss_pred:0.016212990507483482, decouple_loss:0.0011129977647215128
loss_pred:0.017453502863645554, decouple_loss:0.001103260787203908
loss_pred:0.016847021877765656, decouple_loss:0.0011817397316917777
Iteration: 522, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45273321866989136, gen p mean: -0.03633464500308037, mean p set: 0.45321348309516907
loss_pred:0.01695188134908676, decouple_loss:0.0011480009416118264
The modified gen p mean: 0.45038139820098877, gen p mean: -0.029993150383234024, mean p set: 0.45086169242858887The modified gen p mean: 0.450573205947876, gen p mean: -0.028178369626402855, mean p set: 0.45105352997779846
loss_pred:0.017414728179574013, decouple_loss:0.001020173542201519
loss_pred:0.017736991867423058, decouple_loss:0.001084289513528347
Iteration: 523, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503895938396454, gen p mean: -0.03417927399277687, mean p set: 0.45086991786956787
loss_pred:0.017084233462810516, decouple_loss:0.001105790724977851
The modified gen p mean: 0.451201468706131, gen p mean: -0.031023869290947914, mean p set: 0.4516817331314087The modified gen p mean: 0.4527290463447571, gen p mean: -0.034639470279216766, mean p set: 0.4532093107700348
loss_pred:0.016995631158351898, decouple_loss:0.0011389809660613537
loss_pred:0.01692122407257557, decouple_loss:0.0011535906232893467
Iteration: 524, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4519653022289276, gen p mean: -0.03665480762720108, mean p set: 0.4524455666542053
The modified gen p mean: 0.4512365162372589, gen p mean: -0.03014606237411499, mean p set: 0.451716810464859
The modified gen p mean: 0.4548640251159668, gen p mean: -0.037920400500297546, mean p set: 0.4553443193435669
loss_pred:0.016782598569989204, decouple_loss:0.0010377941653132439
loss_pred:0.01665412448346615, decouple_loss:0.00104259152431041
loss_pred:0.016379494220018387, decouple_loss:0.0010642549023032188
Iteration: 525, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511701762676239, gen p mean: -0.03107231669127941, mean p set: 0.4516505002975464
The modified gen p mean: 0.45228126645088196, gen p mean: -0.03498079255223274, mean p set: 0.45276156067848206
loss_pred:0.016698338091373444, decouple_loss:0.0011907535372301936
loss_pred:0.016588883474469185, decouple_loss:0.0012017894769087434
The modified gen p mean: 0.45334434509277344, gen p mean: -0.030801251530647278, mean p set: 0.45382463932037354
loss_pred:0.01695949025452137, decouple_loss:0.0011187490308657289
Iteration: 526, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44977107644081116, gen p mean: -0.039184749126434326, mean p set: 0.45025137066841125
The modified gen p mean: 0.45404502749443054, gen p mean: -0.03975572809576988, mean p set: 0.45452532172203064
loss_pred:0.016648296266794205, decouple_loss:0.0012140937615185976
loss_pred:0.017310146242380142, decouple_loss:0.0011788574047386646
The modified gen p mean: 0.45217081904411316, gen p mean: -0.03273825719952583, mean p set: 0.45265111327171326
loss_pred:0.016978390514850616, decouple_loss:0.0010999282822012901
Iteration: 527, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45117464661598206, gen p mean: -0.032896772027015686, mean p set: 0.45165497064590454
The modified gen p mean: 0.45310527086257935, gen p mean: -0.04500199854373932, mean p set: 0.45358556509017944
loss_pred:0.017902644351124763, decouple_loss:0.0009695033659227192
loss_pred:0.017092065885663033, decouple_loss:0.0011694430140778422
The modified gen p mean: 0.4531160593032837, gen p mean: -0.04601524770259857, mean p set: 0.4535963535308838
loss_pred:0.01655871979892254, decouple_loss:0.001137539278715849
Iteration: 528, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4523015320301056, gen p mean: -0.04134278744459152, mean p set: 0.4527818560600281
The modified gen p mean: 0.4505560100078583, gen p mean: -0.04586606100201607, mean p set: 0.4510363042354584
loss_pred:0.016517598181962967, decouple_loss:0.0011316812597215176
loss_pred:0.016897140070796013, decouple_loss:0.0011215799022465944
The modified gen p mean: 0.4499375820159912, gen p mean: -0.03940150514245033, mean p set: 0.4504178762435913
loss_pred:0.016690123826265335, decouple_loss:0.0011398450005799532
Iteration: 529, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507405161857605, gen p mean: -0.043308377265930176, mean p set: 0.4512208104133606
The modified gen p mean: 0.45174407958984375, gen p mean: -0.046177711337804794, mean p set: 0.45222437381744385
loss_pred:0.017021959647536278, decouple_loss:0.0010345119517296553
loss_pred:0.016764523461461067, decouple_loss:0.0010476228781044483
The modified gen p mean: 0.4505847990512848, gen p mean: -0.042152490466833115, mean p set: 0.4510650634765625
loss_pred:0.01668635942041874, decouple_loss:0.0009688233840279281
Iteration: 530, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507555365562439, gen p mean: -0.04567895457148552, mean p set: 0.451235830783844The modified gen p mean: 0.4534416198730469, gen p mean: -0.04401261731982231, mean p set: 0.453921914100647
loss_pred:0.015930132940411568, decouple_loss:0.0010365386260673404
loss_pred:0.016912981867790222, decouple_loss:0.001141939079388976
The modified gen p mean: 0.45194631814956665, gen p mean: -0.04462084546685219, mean p set: 0.45242658257484436
loss_pred:0.0167746152728796, decouple_loss:0.0010037194006145
2023-05-01 00:23:53 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.05308835208415985, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04808834567666054, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04858599230647087, mean p set: 0.4500633478164673
loss_pred:0.018479257822036743, decouple_loss:0.0011122928699478507
loss_pred:0.017327826470136642, decouple_loss:0.0010520487558096647
loss_pred:0.017431743443012238, decouple_loss:0.001052750158123672
WV_0_PC_1_EH_0_PS_40, loss: 0.017799895256757736, avg_mse: 0.02556857094168663
current test mse: 0.025569
Iteration: 531, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44958359003067017, gen p mean: -0.0460052490234375, mean p set: 0.45006391406059265
The modified gen p mean: 0.45161476731300354, gen p mean: -0.04269850254058838, mean p set: 0.45209503173828125
loss_pred:0.016453703865408897, decouple_loss:0.0010790417436510324
The modified gen p mean: 0.4515925645828247, gen p mean: -0.040867358446121216, mean p set: 0.4520728290081024
loss_pred:0.016196921467781067, decouple_loss:0.0009757674997672439
loss_pred:0.016226278617978096, decouple_loss:0.0010470951674506068
Iteration: 532, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45201173424720764, gen p mean: -0.04456913098692894, mean p set: 0.45249199867248535
loss_pred:0.016951588913798332, decouple_loss:0.0011013601906597614
The modified gen p mean: 0.4510310888290405, gen p mean: -0.045381877571344376, mean p set: 0.4515113830566406The modified gen p mean: 0.45204100012779236, gen p mean: -0.040486257523298264, mean p set: 0.45252126455307007
loss_pred:0.01674722135066986, decouple_loss:0.0010445083025842905
loss_pred:0.016229256987571716, decouple_loss:0.001054228749126196
Iteration: 533, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45183470845222473, gen p mean: -0.03885341063141823, mean p set: 0.45231500267982483
loss_pred:0.01622859574854374, decouple_loss:0.0010131436865776777
The modified gen p mean: 0.45042428374290466, gen p mean: -0.04904339835047722, mean p set: 0.45090457797050476The modified gen p mean: 0.45258834958076477, gen p mean: -0.044102560728788376, mean p set: 0.45306864380836487
loss_pred:0.016552161425352097, decouple_loss:0.0010078747291117907
loss_pred:0.017059344798326492, decouple_loss:0.0010168773587793112
Iteration: 534, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45282450318336487, gen p mean: -0.046261563897132874, mean p set: 0.4533047676086426
loss_pred:0.017235808074474335, decouple_loss:0.0010038962354883552
The modified gen p mean: 0.4501190483570099, gen p mean: -0.04626955837011337, mean p set: 0.4505993127822876The modified gen p mean: 0.4497024118900299, gen p mean: -0.050064221024513245, mean p set: 0.45018270611763
loss_pred:0.016671597957611084, decouple_loss:0.0009596477611921728
loss_pred:0.016098778694868088, decouple_loss:0.0009374478831887245
Iteration: 535, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45383355021476746, gen p mean: -0.045962799340486526, mean p set: 0.45431381464004517
loss_pred:0.016770200803875923, decouple_loss:0.0011487210867926478
The modified gen p mean: 0.4504230320453644, gen p mean: -0.047082845121622086, mean p set: 0.4509033262729645The modified gen p mean: 0.4513079524040222, gen p mean: -0.043631430715322495, mean p set: 0.4517882466316223
loss_pred:0.016915906220674515, decouple_loss:0.00098800053820014
loss_pred:0.016659634187817574, decouple_loss:0.0009594944422133267
Iteration: 536, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4518640637397766, gen p mean: -0.04163185507059097, mean p set: 0.4523443579673767
loss_pred:0.01672786846756935, decouple_loss:0.0010496136965230107
The modified gen p mean: 0.4540459215641022, gen p mean: -0.04685473442077637, mean p set: 0.45452621579170227The modified gen p mean: 0.45240917801856995, gen p mean: -0.04607585072517395, mean p set: 0.45288947224617004
loss_pred:0.015826763585209846, decouple_loss:0.0010524317622184753
loss_pred:0.016520528122782707, decouple_loss:0.0010085158282890916
Iteration: 537, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4532493054866791, gen p mean: -0.04186061769723892, mean p set: 0.4537295699119568
loss_pred:0.016555339097976685, decouple_loss:0.0010364758782088757
The modified gen p mean: 0.4519380033016205, gen p mean: -0.04413406923413277, mean p set: 0.4524182975292206The modified gen p mean: 0.4530910849571228, gen p mean: -0.0412643663585186, mean p set: 0.4535713791847229
loss_pred:0.016596563160419464, decouple_loss:0.0009800558909773827
loss_pred:0.0169869065284729, decouple_loss:0.0010559482034295797
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012005_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012005_3_24hr.npz
NaN value num: 0
Iteration: 538, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44805780053138733, gen p mean: -0.046379007399082184, mean p set: 0.44853806495666504
loss_pred:0.014336168766021729, decouple_loss:0.0011592264054343104
The modified gen p mean: 0.44666150212287903, gen p mean: -0.048593830317258835, mean p set: 0.44714176654815674The modified gen p mean: 0.4474312663078308, gen p mean: -0.0465964712202549, mean p set: 0.4479115903377533
loss_pred:0.015184436924755573, decouple_loss:0.0012328607263043523
loss_pred:0.014865417964756489, decouple_loss:0.0011583906598389149
Iteration: 539, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489459991455078, gen p mean: -0.04442353919148445, mean p set: 0.4494262933731079
loss_pred:0.014765515923500061, decouple_loss:0.0012844810262322426
The modified gen p mean: 0.44756248593330383, gen p mean: -0.04563004896044731, mean p set: 0.44804278016090393The modified gen p mean: 0.4483334422111511, gen p mean: -0.04545751214027405, mean p set: 0.4488137364387512
loss_pred:0.015052350237965584, decouple_loss:0.0010976239573210478
loss_pred:0.014593660831451416, decouple_loss:0.0011990844504907727
Iteration: 540, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479963183403015, gen p mean: -0.05124994367361069, mean p set: 0.4484765827655792
The modified gen p mean: 0.4477640390396118, gen p mean: -0.047385863959789276, mean p set: 0.4482443630695343
loss_pred:0.014373594895005226, decouple_loss:0.0011047795414924622
loss_pred:0.014439413323998451, decouple_loss:0.0011222097091376781
The modified gen p mean: 0.44847413897514343, gen p mean: -0.05288001522421837, mean p set: 0.44895440340042114
loss_pred:0.014231637120246887, decouple_loss:0.0012091895332559943
2023-05-01 00:26:25 testing...
The modified gen p mean: 0.44987666606903076, gen p mean: -0.05064039304852486, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.051023513078689575, mean p set: 0.4500633478164673
The modified gen p mean: 0.4497888684272766, gen p mean: -0.0550907738506794, mean p set: 0.4502691626548767
loss_pred:0.017662260681390762, decouple_loss:0.001269098138436675loss_pred:0.017566166818141937, decouple_loss:0.0012792040361091495
loss_pred:0.01862744614481926, decouple_loss:0.001246666070073843
WV_0_PC_1_EH_0_PS_40, loss: 0.01801520586013794, avg_mse: 0.025942981243133545
current test mse: 0.025943
Iteration: 541, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44862884283065796, gen p mean: -0.05329427123069763, mean p set: 0.44910916686058044
The modified gen p mean: 0.4485089182853699, gen p mean: -0.057983893901109695, mean p set: 0.44898921251296997
loss_pred:0.013582340441644192, decouple_loss:0.0011859484948217869
The modified gen p mean: 0.4478552043437958, gen p mean: -0.05349770188331604, mean p set: 0.4483354985713959
loss_pred:0.014229651540517807, decouple_loss:0.0011956306407228112
loss_pred:0.01408066600561142, decouple_loss:0.001135419006459415
Iteration: 542, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44839170575141907, gen p mean: -0.05927887186408043, mean p set: 0.44887199997901917
The modified gen p mean: 0.4484032988548279, gen p mean: -0.05782737955451012, mean p set: 0.4488835632801056
loss_pred:0.01356189139187336, decouple_loss:0.001298487652093172
loss_pred:0.013473453000187874, decouple_loss:0.0013139129150658846
The modified gen p mean: 0.4480783939361572, gen p mean: -0.0554848350584507, mean p set: 0.44855865836143494
loss_pred:0.013823209330439568, decouple_loss:0.001364123891107738
Iteration: 543, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449032187461853, gen p mean: -0.054855216294527054, mean p set: 0.44951245188713074
The modified gen p mean: 0.4487054944038391, gen p mean: -0.05850081145763397, mean p set: 0.4491857588291168
loss_pred:0.01319262757897377, decouple_loss:0.0013375025009736419
loss_pred:0.013755994848906994, decouple_loss:0.0013122018426656723
The modified gen p mean: 0.4471951425075531, gen p mean: -0.05610233545303345, mean p set: 0.4476754069328308
loss_pred:0.013754334300756454, decouple_loss:0.0013100147480145097
Iteration: 544, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492049813270569, gen p mean: -0.059397365897893906, mean p set: 0.449685275554657
loss_pred:0.013529343530535698, decouple_loss:0.0013261891435831785
The modified gen p mean: 0.4491446018218994, gen p mean: -0.05716324225068092, mean p set: 0.4496248662471771The modified gen p mean: 0.4495488703250885, gen p mean: -0.06269277632236481, mean p set: 0.450029194355011
loss_pred:0.01342363003641367, decouple_loss:0.0013568017166107893
loss_pred:0.013779210858047009, decouple_loss:0.0013154218904674053
Iteration: 545, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44877079129219055, gen p mean: -0.05526072904467583, mean p set: 0.44925105571746826
loss_pred:0.013452920131385326, decouple_loss:0.0014099481049925089
The modified gen p mean: 0.44863730669021606, gen p mean: -0.05663108080625534, mean p set: 0.44911760091781616The modified gen p mean: 0.448984295129776, gen p mean: -0.05874175950884819, mean p set: 0.4494645595550537
loss_pred:0.01380112860351801, decouple_loss:0.0014893304323777556
loss_pred:0.013412595726549625, decouple_loss:0.001431782147847116
Iteration: 546, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448012113571167, gen p mean: -0.05699622631072998, mean p set: 0.4484924077987671
loss_pred:0.013509094715118408, decouple_loss:0.0013219130923971534
The modified gen p mean: 0.4485744833946228, gen p mean: -0.056131280958652496, mean p set: 0.4490547776222229The modified gen p mean: 0.44862380623817444, gen p mean: -0.05709587410092354, mean p set: 0.44910410046577454
loss_pred:0.013801118358969688, decouple_loss:0.0013706609606742859
loss_pred:0.013316908851265907, decouple_loss:0.0013551037991419435
Iteration: 547, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477488100528717, gen p mean: -0.054964855313301086, mean p set: 0.4482291042804718
loss_pred:0.013594583608210087, decouple_loss:0.0013504282105714083
The modified gen p mean: 0.4494702219963074, gen p mean: -0.05248207971453667, mean p set: 0.44995051622390747The modified gen p mean: 0.44933342933654785, gen p mean: -0.056578755378723145, mean p set: 0.44981372356414795
loss_pred:0.013476644642651081, decouple_loss:0.0013169129379093647
loss_pred:0.01305249985307455, decouple_loss:0.0012904846807941794
Iteration: 548, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482963979244232, gen p mean: -0.05626165494322777, mean p set: 0.4487766921520233
loss_pred:0.013404752127826214, decouple_loss:0.001352482009679079
The modified gen p mean: 0.4487454891204834, gen p mean: -0.05219882354140282, mean p set: 0.4492258131504059The modified gen p mean: 0.4487673342227936, gen p mean: -0.05637385696172714, mean p set: 0.44924765825271606
loss_pred:0.012952744960784912, decouple_loss:0.0014194679679349065
loss_pred:0.013193828985095024, decouple_loss:0.0013786371564492583
Iteration: 549, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481961727142334, gen p mean: -0.05394768714904785, mean p set: 0.4486764669418335
The modified gen p mean: 0.44855940341949463, gen p mean: -0.05154944956302643, mean p set: 0.4490397274494171
loss_pred:0.013078657910227776, decouple_loss:0.0013851551339030266
loss_pred:0.013501816429197788, decouple_loss:0.001322044525295496
The modified gen p mean: 0.44869399070739746, gen p mean: -0.05210602283477783, mean p set: 0.44917428493499756
loss_pred:0.01320424024015665, decouple_loss:0.0013267736649140716
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 550, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478801488876343, gen p mean: -0.04786968603730202, mean p set: 0.4483604431152344
loss_pred:0.013284505344927311, decouple_loss:0.0014620664296671748
The modified gen p mean: 0.44955793023109436, gen p mean: -0.05272762477397919, mean p set: 0.45003825426101685The modified gen p mean: 0.44871985912323, gen p mean: -0.04735450819134712, mean p set: 0.4492001235485077
loss_pred:0.013028150424361229, decouple_loss:0.001412790734320879
loss_pred:0.013000726699829102, decouple_loss:0.0014288501115515828
2023-05-01 00:28:18 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.05011824145913124, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04529162496328354, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.045666009187698364, mean p set: 0.4500633478164673
loss_pred:0.019244065508246422, decouple_loss:0.0013806995702907443
loss_pred:0.018108731135725975, decouple_loss:0.001377995009534061
loss_pred:0.01818222366273403, decouple_loss:0.001393058686517179
WV_0_PC_1_EH_0_PS_40, loss: 0.01858087070286274, avg_mse: 0.027021754533052444
current test mse: 0.027022
Iteration: 551, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447951078414917, gen p mean: -0.048622097820043564, mean p set: 0.4484313726425171
The modified gen p mean: 0.4472561478614807, gen p mean: -0.04944575950503349, mean p set: 0.4477364122867584
The modified gen p mean: 0.44882646203041077, gen p mean: -0.04964794963598251, mean p set: 0.44930675625801086
loss_pred:0.012981755658984184, decouple_loss:0.0013859798200428486
loss_pred:0.013236426748335361, decouple_loss:0.0013736396795138717
loss_pred:0.013841829262673855, decouple_loss:0.0013197979424148798
Iteration: 552, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475170075893402, gen p mean: -0.043387964367866516, mean p set: 0.4479973018169403
loss_pred:0.013126260600984097, decouple_loss:0.001428875490091741
The modified gen p mean: 0.44808676838874817, gen p mean: -0.04720209538936615, mean p set: 0.44856706261634827The modified gen p mean: 0.44823095202445984, gen p mean: -0.04026681184768677, mean p set: 0.44871124625205994
loss_pred:0.013302076607942581, decouple_loss:0.0014744378859177232
loss_pred:0.013280823826789856, decouple_loss:0.0014015361666679382
Iteration: 553, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487855136394501, gen p mean: -0.04332946613430977, mean p set: 0.44926580786705017
loss_pred:0.013467135839164257, decouple_loss:0.0013602165272459388
The modified gen p mean: 0.4486353099346161, gen p mean: -0.046008266508579254, mean p set: 0.4491156041622162The modified gen p mean: 0.44635310769081116, gen p mean: -0.04508046805858612, mean p set: 0.44683340191841125
loss_pred:0.013442781753838062, decouple_loss:0.00131902820430696
loss_pred:0.013779590837657452, decouple_loss:0.001337627531029284
Iteration: 554, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477235674858093, gen p mean: -0.03905879706144333, mean p set: 0.4482038617134094
The modified gen p mean: 0.4475848078727722, gen p mean: -0.042414452880620956, mean p set: 0.4480650722980499loss_pred:0.013129494152963161, decouple_loss:0.0013717861147597432
The modified gen p mean: 0.4482119381427765, gen p mean: -0.046934835612773895, mean p set: 0.4486922323703766
loss_pred:0.012941134162247181, decouple_loss:0.0013685898156836629
loss_pred:0.013375086709856987, decouple_loss:0.0013586428249254823
Iteration: 555, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44889020919799805, gen p mean: -0.051607295870780945, mean p set: 0.44937053322792053
The modified gen p mean: 0.4480448067188263, gen p mean: -0.05231061577796936, mean p set: 0.4485251009464264
loss_pred:0.013364728540182114, decouple_loss:0.0013600221136584878
The modified gen p mean: 0.44737279415130615, gen p mean: -0.05267642065882683, mean p set: 0.44785305857658386
loss_pred:0.013070064596831799, decouple_loss:0.0013232155470177531
loss_pred:0.013425702229142189, decouple_loss:0.0013581783277913928
Iteration: 556, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482080340385437, gen p mean: -0.05213387310504913, mean p set: 0.4486883282661438
loss_pred:0.013015303760766983, decouple_loss:0.0013439793838188052
The modified gen p mean: 0.4481388330459595, gen p mean: -0.053225334733724594, mean p set: 0.44861912727355957The modified gen p mean: 0.44868943095207214, gen p mean: -0.05306591838598251, mean p set: 0.44916975498199463
loss_pred:0.013119978830218315, decouple_loss:0.0013428775127977133
loss_pred:0.013662642799317837, decouple_loss:0.0013059412594884634
Iteration: 557, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473927617073059, gen p mean: -0.04649072512984276, mean p set: 0.447873055934906
loss_pred:0.013190357945859432, decouple_loss:0.00123121018987149
The modified gen p mean: 0.44858911633491516, gen p mean: -0.056839823722839355, mean p set: 0.44906941056251526The modified gen p mean: 0.4487270712852478, gen p mean: -0.05356872081756592, mean p set: 0.4492073655128479
loss_pred:0.01306195743381977, decouple_loss:0.0012106145732104778
loss_pred:0.012782000936567783, decouple_loss:0.0013007089728489518
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012019_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012019_3_24hr.npz
NaN value num: 0
Iteration: 558, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507963955402374, gen p mean: -0.04632154852151871, mean p set: 0.4512766897678375
loss_pred:0.017589008435606956, decouple_loss:0.0013765074545517564
The modified gen p mean: 0.45107710361480713, gen p mean: -0.04414799064397812, mean p set: 0.4515573978424072The modified gen p mean: 0.4516751766204834, gen p mean: -0.04579998925328255, mean p set: 0.4521554708480835
loss_pred:0.017631659284234047, decouple_loss:0.0014697287697345018
loss_pred:0.016759002581238747, decouple_loss:0.0014970930060371757
Iteration: 559, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45015791058540344, gen p mean: -0.05198758468031883, mean p set: 0.45063820481300354
loss_pred:0.01722508668899536, decouple_loss:0.0012125571956858039
The modified gen p mean: 0.4529097080230713, gen p mean: -0.04814866930246353, mean p set: 0.4533900320529938The modified gen p mean: 0.4524165689945221, gen p mean: -0.046809032559394836, mean p set: 0.4528968930244446
loss_pred:0.016758285462856293, decouple_loss:0.0013151809107512236
loss_pred:0.016427746042609215, decouple_loss:0.0013173735933378339
Iteration: 560, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45102861523628235, gen p mean: -0.05097251757979393, mean p set: 0.45150890946388245
The modified gen p mean: 0.45237085223197937, gen p mean: -0.05115703120827675, mean p set: 0.45285114645957947
loss_pred:0.016311421990394592, decouple_loss:0.001396771869622171
loss_pred:0.01696016453206539, decouple_loss:0.001367778517305851
The modified gen p mean: 0.4504564106464386, gen p mean: -0.045274846255779266, mean p set: 0.4509367048740387
loss_pred:0.01628423109650612, decouple_loss:0.0014118242543190718
2023-05-01 00:30:48 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.0598868653178215, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.05583812668919563, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.056115031242370605, mean p set: 0.4500633478164673
loss_pred:0.018777284771203995, decouple_loss:0.00154469336848706
loss_pred:0.017694393172860146, decouple_loss:0.0014944456052035093
loss_pred:0.017828358337283134, decouple_loss:0.0015068716602399945
WV_0_PC_1_EH_0_PS_40, loss: 0.018175778910517693, avg_mse: 0.026214778423309326
current test mse: 0.026215
Iteration: 561, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4517934322357178, gen p mean: -0.05111005902290344, mean p set: 0.4522736966609955
The modified gen p mean: 0.452144593000412, gen p mean: -0.05093695595860481, mean p set: 0.4526248872280121
The modified gen p mean: 0.4512689709663391, gen p mean: -0.04902443662285805, mean p set: 0.4517492651939392
loss_pred:0.016370989382267, decouple_loss:0.0013561156811192632
loss_pred:0.01661653071641922, decouple_loss:0.0012768099550157785
loss_pred:0.017246950417757034, decouple_loss:0.0013139118673279881
Iteration: 562, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508490264415741, gen p mean: -0.04511428624391556, mean p set: 0.4513293206691742
The modified gen p mean: 0.4510782063007355, gen p mean: -0.04850976541638374, mean p set: 0.4515584707260132
loss_pred:0.016747821122407913, decouple_loss:0.001262767007574439
loss_pred:0.017770592123270035, decouple_loss:0.0014039762318134308
The modified gen p mean: 0.451174259185791, gen p mean: -0.04850391298532486, mean p set: 0.4516545534133911
loss_pred:0.01751072332262993, decouple_loss:0.0012491126544773579
Iteration: 563, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4518786370754242, gen p mean: -0.047169242054224014, mean p set: 0.4523589313030243
loss_pred:0.016527699306607246, decouple_loss:0.0012829944025725126
The modified gen p mean: 0.451937735080719, gen p mean: -0.04323328286409378, mean p set: 0.4524179995059967The modified gen p mean: 0.4496847987174988, gen p mean: -0.04595879092812538, mean p set: 0.45016512274742126
loss_pred:0.017214199528098106, decouple_loss:0.001498380326665938
loss_pred:0.017091771587729454, decouple_loss:0.0013452752027660608
Iteration: 564, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4519047439098358, gen p mean: -0.0407247394323349, mean p set: 0.4523850381374359
loss_pred:0.017235271632671356, decouple_loss:0.001366795040667057
The modified gen p mean: 0.4501418471336365, gen p mean: -0.04022303223609924, mean p set: 0.4506221413612366The modified gen p mean: 0.4509286880493164, gen p mean: -0.04213220998644829, mean p set: 0.4514089822769165
loss_pred:0.016756437718868256, decouple_loss:0.0013975354377180338
loss_pred:0.017052756622433662, decouple_loss:0.0012537856819108129
Iteration: 565, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45307406783103943, gen p mean: -0.04021034762263298, mean p set: 0.4535543620586395
loss_pred:0.01652289740741253, decouple_loss:0.0012218912597745657
The modified gen p mean: 0.4506165683269501, gen p mean: -0.03940294682979584, mean p set: 0.4510968327522278The modified gen p mean: 0.4505321681499481, gen p mean: -0.04121388494968414, mean p set: 0.4510124921798706
loss_pred:0.01681373454630375, decouple_loss:0.0012053484097123146
loss_pred:0.017083240672945976, decouple_loss:0.0011968842009082437
Iteration: 566, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45146703720092773, gen p mean: -0.03960828483104706, mean p set: 0.4519473612308502
loss_pred:0.017252925783395767, decouple_loss:0.0012851451756432652
The modified gen p mean: 0.45081135630607605, gen p mean: -0.03353205695748329, mean p set: 0.45129165053367615The modified gen p mean: 0.4514961838722229, gen p mean: -0.03314727172255516, mean p set: 0.451976478099823
loss_pred:0.0172377098351717, decouple_loss:0.0013261751737445593
loss_pred:0.01660890318453312, decouple_loss:0.0012145757209509611
Iteration: 567, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45099154114723206, gen p mean: -0.03750850260257721, mean p set: 0.45147183537483215
loss_pred:0.016215989366173744, decouple_loss:0.0012191126588732004
The modified gen p mean: 0.4509282410144806, gen p mean: -0.04100313410162926, mean p set: 0.4514085352420807The modified gen p mean: 0.45177724957466125, gen p mean: -0.036810506135225296, mean p set: 0.45225754380226135
loss_pred:0.0164651982486248, decouple_loss:0.0012304019182920456
loss_pred:0.01742972433567047, decouple_loss:0.001228546374477446
Iteration: 568, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4515930414199829, gen p mean: -0.0383048839867115, mean p set: 0.452073335647583
loss_pred:0.01666218228638172, decouple_loss:0.001154996920377016
The modified gen p mean: 0.4502018690109253, gen p mean: -0.039071109145879745, mean p set: 0.450682133436203The modified gen p mean: 0.4507906138896942, gen p mean: -0.03967887535691261, mean p set: 0.4512709379196167
loss_pred:0.016615260392427444, decouple_loss:0.0011239753803238273
loss_pred:0.017100362107157707, decouple_loss:0.0010810859967023134
Iteration: 569, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505290687084198, gen p mean: -0.047230370342731476, mean p set: 0.4510093629360199
loss_pred:0.016364509239792824, decouple_loss:0.0011553724762052298
The modified gen p mean: 0.44992557168006897, gen p mean: -0.03466378524899483, mean p set: 0.45040586590766907The modified gen p mean: 0.4517216682434082, gen p mean: -0.03884037956595421, mean p set: 0.4522019624710083
loss_pred:0.016584526747465134, decouple_loss:0.0013420871691778302
loss_pred:0.017092276364564896, decouple_loss:0.0011050640605390072
Iteration: 570, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45010125637054443, gen p mean: -0.03656082600355148, mean p set: 0.45058155059814453
loss_pred:0.01646934077143669, decouple_loss:0.0012169283581897616
The modified gen p mean: 0.45152682065963745, gen p mean: -0.04658452793955803, mean p set: 0.45200711488723755The modified gen p mean: 0.4511336088180542, gen p mean: -0.044144101440906525, mean p set: 0.4516139328479767
loss_pred:0.017123376950621605, decouple_loss:0.0011134016094729304
loss_pred:0.017057018354535103, decouple_loss:0.0012453580275177956
2023-05-01 00:32:41 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.05516045540571213, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.051090680062770844, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.051310744136571884, mean p set: 0.4500633478164673
loss_pred:0.018681365996599197, decouple_loss:0.00136200909037143
loss_pred:0.017579341307282448, decouple_loss:0.0012866100296378136
loss_pred:0.017716389149427414, decouple_loss:0.0012940893648192286
WV_0_PC_1_EH_0_PS_40, loss: 0.01805807650089264, avg_mse: 0.02599601447582245
current test mse: 0.025996
Iteration: 571, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45098811388015747, gen p mean: -0.04629780352115631, mean p set: 0.45146840810775757
The modified gen p mean: 0.4511029124259949, gen p mean: -0.043146274983882904, mean p set: 0.45158323645591736
The modified gen p mean: 0.45111170411109924, gen p mean: -0.04594843462109566, mean p set: 0.45159196853637695
loss_pred:0.017033588141202927, decouple_loss:0.00108087039552629
loss_pred:0.017075715586543083, decouple_loss:0.0011391460429877043
loss_pred:0.0173681378364563, decouple_loss:0.0011353431036695838
Iteration: 572, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505757689476013, gen p mean: -0.041060976684093475, mean p set: 0.4510560631752014
The modified gen p mean: 0.45027270913124084, gen p mean: -0.03998393192887306, mean p set: 0.45075303316116333loss_pred:0.0163424089550972, decouple_loss:0.0011277423473075032
The modified gen p mean: 0.45073387026786804, gen p mean: -0.04145406559109688, mean p set: 0.45121413469314575
loss_pred:0.016428068280220032, decouple_loss:0.0011605406180024147
loss_pred:0.01637566275894642, decouple_loss:0.0011929561151191592
Iteration: 573, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504019021987915, gen p mean: -0.04961558058857918, mean p set: 0.450882226228714
loss_pred:0.015864722430706024, decouple_loss:0.0011593139497563243
The modified gen p mean: 0.45123547315597534, gen p mean: -0.044157933443784714, mean p set: 0.4517157971858978The modified gen p mean: 0.45168137550354004, gen p mean: -0.03868650645017624, mean p set: 0.4521616995334625
loss_pred:0.017247183248400688, decouple_loss:0.001158495550043881
loss_pred:0.01741407997906208, decouple_loss:0.0013035004958510399
Iteration: 574, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45139825344085693, gen p mean: -0.042157191783189774, mean p set: 0.45187854766845703
loss_pred:0.017062555998563766, decouple_loss:0.0010826779762282968
The modified gen p mean: 0.4497269093990326, gen p mean: -0.043271180242300034, mean p set: 0.4502072036266327The modified gen p mean: 0.45018839836120605, gen p mean: -0.044798266142606735, mean p set: 0.45066869258880615
loss_pred:0.016587821766734123, decouple_loss:0.0011492421617731452
loss_pred:0.01695304736495018, decouple_loss:0.001154953963123262
Iteration: 575, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45104265213012695, gen p mean: -0.043347474187612534, mean p set: 0.4515230059623718
loss_pred:0.016106072813272476, decouple_loss:0.0012183858780190349
The modified gen p mean: 0.4507935345172882, gen p mean: -0.03718606382608414, mean p set: 0.4512738585472107The modified gen p mean: 0.45135343074798584, gen p mean: -0.04141360893845558, mean p set: 0.4518337547779083
loss_pred:0.016948774456977844, decouple_loss:0.0013356563868001103
loss_pred:0.0166500061750412, decouple_loss:0.0012279729126021266
Iteration: 576, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45022866129875183, gen p mean: -0.037921156734228134, mean p set: 0.4507089853286743
loss_pred:0.016341976821422577, decouple_loss:0.001003806828521192
The modified gen p mean: 0.45063239336013794, gen p mean: -0.049570146948099136, mean p set: 0.45111268758773804The modified gen p mean: 0.45104217529296875, gen p mean: -0.04135149344801903, mean p set: 0.45152246952056885
loss_pred:0.017399616539478302, decouple_loss:0.0010961458319798112
loss_pred:0.01572226919233799, decouple_loss:0.0010200737742707133
Iteration: 577, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45158693194389343, gen p mean: -0.04638797044754028, mean p set: 0.45206722617149353
loss_pred:0.0170719213783741, decouple_loss:0.0011563504813238978
The modified gen p mean: 0.4524185061454773, gen p mean: -0.03647584840655327, mean p set: 0.452898770570755The modified gen p mean: 0.45051705837249756, gen p mean: -0.043370913714170456, mean p set: 0.45099735260009766
loss_pred:0.015958432108163834, decouple_loss:0.0011008733417838812
loss_pred:0.01690685749053955, decouple_loss:0.0011985779274255037
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012008_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012008_3_24hr.npz
NaN value num: 0
Iteration: 578, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502795934677124, gen p mean: -0.04021603986620903, mean p set: 0.4507599174976349
loss_pred:0.01640063151717186, decouple_loss:0.0011578465346246958
The modified gen p mean: 0.4512979984283447, gen p mean: -0.04714545980095863, mean p set: 0.4517782926559448The modified gen p mean: 0.4535878896713257, gen p mean: -0.03839699178934097, mean p set: 0.45406821370124817
loss_pred:0.01644187606871128, decouple_loss:0.001204049913212657
loss_pred:0.016723724082112312, decouple_loss:0.0011324778897687793
Iteration: 579, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45210379362106323, gen p mean: -0.04529488831758499, mean p set: 0.45258408784866333
loss_pred:0.016746383160352707, decouple_loss:0.0011347740655764937
The modified gen p mean: 0.4538218379020691, gen p mean: -0.041284382343292236, mean p set: 0.4543021321296692The modified gen p mean: 0.45215561985969543, gen p mean: -0.0400635227560997, mean p set: 0.45263591408729553
loss_pred:0.016215484589338303, decouple_loss:0.0011631859233602881
loss_pred:0.016136636957526207, decouple_loss:0.0010831226827576756
Iteration: 580, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45069366693496704, gen p mean: -0.04229418560862541, mean p set: 0.45117396116256714
loss_pred:0.016206981614232063, decouple_loss:0.0012515031266957521
The modified gen p mean: 0.4506218433380127, gen p mean: -0.040963150560855865, mean p set: 0.4511021673679352The modified gen p mean: 0.4524848163127899, gen p mean: -0.045976780354976654, mean p set: 0.4529651403427124
loss_pred:0.016560271382331848, decouple_loss:0.0012680336367338896
loss_pred:0.016042284667491913, decouple_loss:0.0011798652121797204
2023-05-01 00:35:12 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.05788598582148552, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.05371379852294922, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.05388019233942032, mean p set: 0.4500633478164673
loss_pred:0.01858389377593994, decouple_loss:0.001315426779910922
loss_pred:0.017415327951312065, decouple_loss:0.0013300984865054488
loss_pred:0.017589829862117767, decouple_loss:0.0012621806235983968
WV_0_PC_1_EH_0_PS_40, loss: 0.017928145825862885, avg_mse: 0.025752941146492958
current test mse: 0.025753
Iteration: 581, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4535067081451416, gen p mean: -0.04392017051577568, mean p set: 0.4539869725704193
The modified gen p mean: 0.4534977674484253, gen p mean: -0.04553322121500969, mean p set: 0.4539780914783478
The modified gen p mean: 0.45269882678985596, gen p mean: -0.04429670423269272, mean p set: 0.45317909121513367
loss_pred:0.01625593937933445, decouple_loss:0.001124455127865076
loss_pred:0.016729651018977165, decouple_loss:0.0011934032663702965
loss_pred:0.016597948968410492, decouple_loss:0.0012010529171675444
Iteration: 582, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45330971479415894, gen p mean: -0.04329485446214676, mean p set: 0.45378997921943665
loss_pred:0.016061821952462196, decouple_loss:0.0011522993445396423
The modified gen p mean: 0.45166248083114624, gen p mean: -0.05143839493393898, mean p set: 0.4521428048610687The modified gen p mean: 0.452810138463974, gen p mean: -0.04472411423921585, mean p set: 0.4532904326915741
loss_pred:0.015269186347723007, decouple_loss:0.0011789167765527964
loss_pred:0.01648065075278282, decouple_loss:0.0011257841251790524
Iteration: 583, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511784315109253, gen p mean: -0.04194415360689163, mean p set: 0.4516587555408478
loss_pred:0.015862857922911644, decouple_loss:0.0012864533346146345
The modified gen p mean: 0.45352113246917725, gen p mean: -0.043201081454753876, mean p set: 0.45400142669677734The modified gen p mean: 0.4529775083065033, gen p mean: -0.04557383060455322, mean p set: 0.4534578025341034
loss_pred:0.015912380069494247, decouple_loss:0.0011774457525461912
loss_pred:0.016345921903848648, decouple_loss:0.001163927256129682
Iteration: 584, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498867392539978, gen p mean: -0.04079199209809303, mean p set: 0.4503670632839203
loss_pred:0.016217926517128944, decouple_loss:0.0010711897630244493
The modified gen p mean: 0.4518735408782959, gen p mean: -0.04525967314839363, mean p set: 0.4523538649082184The modified gen p mean: 0.45190176367759705, gen p mean: -0.0425206683576107, mean p set: 0.45238205790519714
loss_pred:0.016131097450852394, decouple_loss:0.0010669020703062415
loss_pred:0.01653139665722847, decouple_loss:0.0010958355851471424
Iteration: 585, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4521459639072418, gen p mean: -0.04053662717342377, mean p set: 0.4526262879371643
loss_pred:0.015825333073735237, decouple_loss:0.0012880750000476837
The modified gen p mean: 0.4535704255104065, gen p mean: -0.04049244150519371, mean p set: 0.4540506899356842The modified gen p mean: 0.45130714774131775, gen p mean: -0.04993632808327675, mean p set: 0.45178741216659546
loss_pred:0.01577831618487835, decouple_loss:0.0014144583838060498
loss_pred:0.016381220892071724, decouple_loss:0.0013265999732539058
Iteration: 586, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45365244150161743, gen p mean: -0.052068375051021576, mean p set: 0.4541327655315399
loss_pred:0.01635667309165001, decouple_loss:0.001169402152299881
The modified gen p mean: 0.4512661397457123, gen p mean: -0.04773677513003349, mean p set: 0.45174646377563477The modified gen p mean: 0.45323196053504944, gen p mean: -0.03970044478774071, mean p set: 0.45371225476264954
loss_pred:0.016684232279658318, decouple_loss:0.0010891815181821585
loss_pred:0.016367437317967415, decouple_loss:0.0011767097748816013
Iteration: 587, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511004686355591, gen p mean: -0.0445668064057827, mean p set: 0.4515807330608368
loss_pred:0.0166722871363163, decouple_loss:0.0012750092428177595
The modified gen p mean: 0.45272883772850037, gen p mean: -0.04645426943898201, mean p set: 0.4532091021537781The modified gen p mean: 0.45416638255119324, gen p mean: -0.049230705946683884, mean p set: 0.45464667677879333
loss_pred:0.016780825331807137, decouple_loss:0.0011898104567080736
loss_pred:0.01604577898979187, decouple_loss:0.001206371234729886
Iteration: 588, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45276474952697754, gen p mean: -0.04789239168167114, mean p set: 0.45324504375457764
loss_pred:0.016175322234630585, decouple_loss:0.0011647413484752178
The modified gen p mean: 0.45151811838150024, gen p mean: -0.043466150760650635, mean p set: 0.45199844241142273The modified gen p mean: 0.45251134037971497, gen p mean: -0.040507785975933075, mean p set: 0.45299163460731506
loss_pred:0.016861846670508385, decouple_loss:0.0012560971081256866
loss_pred:0.015662245452404022, decouple_loss:0.0010850750841200352
Iteration: 589, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4527757465839386, gen p mean: -0.049541130661964417, mean p set: 0.4532560408115387
loss_pred:0.015816068276762962, decouple_loss:0.001210083020851016
The modified gen p mean: 0.4504817724227905, gen p mean: -0.04293864592909813, mean p set: 0.450962096452713The modified gen p mean: 0.4518187940120697, gen p mean: -0.04782643914222717, mean p set: 0.4522990584373474
loss_pred:0.016478007659316063, decouple_loss:0.0011122840223833919
loss_pred:0.016430750489234924, decouple_loss:0.0011757430620491505
Iteration: 590, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45349135994911194, gen p mean: -0.043157774955034256, mean p set: 0.45397165417671204
The modified gen p mean: 0.4525458514690399, gen p mean: -0.05242980644106865, mean p set: 0.45302614569664
loss_pred:0.015773510560393333, decouple_loss:0.0011262930929660797
loss_pred:0.016105685383081436, decouple_loss:0.0011662037577480078
The modified gen p mean: 0.453730970621109, gen p mean: -0.05652569606900215, mean p set: 0.4542112350463867
loss_pred:0.01648739166557789, decouple_loss:0.001255644834600389
2023-05-01 00:37:05 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.055689506232738495, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.052165158092975616, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.052554868161678314, mean p set: 0.4500633478164673
loss_pred:0.018602635711431503, decouple_loss:0.0014838927891105413
loss_pred:0.01748095452785492, decouple_loss:0.001333153573796153
loss_pred:0.017687495797872543, decouple_loss:0.0013352619716897607
WV_0_PC_1_EH_0_PS_40, loss: 0.017992902547121048, avg_mse: 0.025865865871310234
current test mse: 0.025866
Iteration: 591, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4519471526145935, gen p mean: -0.045048028230667114, mean p set: 0.452427476644516
The modified gen p mean: 0.45204904675483704, gen p mean: -0.045575253665447235, mean p set: 0.4525293707847595
The modified gen p mean: 0.4519035816192627, gen p mean: -0.0416206531226635, mean p set: 0.4523839056491852
loss_pred:0.016077453270554543, decouple_loss:0.0012166770175099373
loss_pred:0.0161906648427248, decouple_loss:0.0013223877176642418
loss_pred:0.016476675868034363, decouple_loss:0.0012283283285796642
Iteration: 592, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4536437690258026, gen p mean: -0.04760243743658066, mean p set: 0.4541240334510803
loss_pred:0.01608019694685936, decouple_loss:0.0011250399984419346
The modified gen p mean: 0.4525628089904785, gen p mean: -0.042651351541280746, mean p set: 0.453043133020401The modified gen p mean: 0.45072656869888306, gen p mean: -0.04663588106632233, mean p set: 0.45120686292648315
loss_pred:0.016078034415841103, decouple_loss:0.0009851569775491953
loss_pred:0.016040246933698654, decouple_loss:0.0010325104231014848
Iteration: 593, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45226365327835083, gen p mean: -0.03873959183692932, mean p set: 0.4527439475059509
The modified gen p mean: 0.451273113489151, gen p mean: -0.048629023134708405, mean p set: 0.4517534077167511
loss_pred:0.016190461814403534, decouple_loss:0.0010853610001504421
loss_pred:0.01587240770459175, decouple_loss:0.0010763106402009726The modified gen p mean: 0.452887624502182, gen p mean: -0.042903464287519455, mean p set: 0.4533679187297821
loss_pred:0.015797605738043785, decouple_loss:0.0009975682478398085
Iteration: 594, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45308825373649597, gen p mean: -0.03798346593976021, mean p set: 0.45356857776641846
loss_pred:0.016042320057749748, decouple_loss:0.0009936942951753736
The modified gen p mean: 0.4529880881309509, gen p mean: -0.03816691413521767, mean p set: 0.4534684121608734The modified gen p mean: 0.4523571729660034, gen p mean: -0.03755219280719757, mean p set: 0.4528374671936035
loss_pred:0.016274597495794296, decouple_loss:0.0010409345850348473
loss_pred:0.016052525490522385, decouple_loss:0.0010893461294472218
Iteration: 595, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.453026682138443, gen p mean: -0.036432407796382904, mean p set: 0.4535069465637207
loss_pred:0.015717968344688416, decouple_loss:0.001084983116015792
The modified gen p mean: 0.45104438066482544, gen p mean: -0.04181274026632309, mean p set: 0.4515247046947479The modified gen p mean: 0.4529445171356201, gen p mean: -0.0406031608581543, mean p set: 0.4534248113632202
loss_pred:0.016269786283373833, decouple_loss:0.0011945184087380767
loss_pred:0.01623629778623581, decouple_loss:0.0011026730062440038
Iteration: 596, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45227381587028503, gen p mean: -0.04407678171992302, mean p set: 0.4527541399002075
loss_pred:0.016680549830198288, decouple_loss:0.000977324671112001
The modified gen p mean: 0.45249542593955994, gen p mean: -0.041930753737688065, mean p set: 0.45297572016716003The modified gen p mean: 0.4507077634334564, gen p mean: -0.04944274201989174, mean p set: 0.4511880576610565
loss_pred:0.01664792001247406, decouple_loss:0.0009969950187951326
loss_pred:0.016806455329060555, decouple_loss:0.0009621866629458964
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012001_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012001_3_24hr.npz
NaN value num: 0
Iteration: 597, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44609618186950684, gen p mean: -0.05434633046388626, mean p set: 0.44657647609710693
loss_pred:0.01741817779839039, decouple_loss:0.0012193870497867465
The modified gen p mean: 0.4475260376930237, gen p mean: -0.05755555257201195, mean p set: 0.4480063021183014The modified gen p mean: 0.44636714458465576, gen p mean: -0.051497772336006165, mean p set: 0.44684743881225586
loss_pred:0.017999116331338882, decouple_loss:0.0011344384402036667
loss_pred:0.017154892906546593, decouple_loss:0.0012213655281811953
Iteration: 598, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44904494285583496, gen p mean: -0.052670788019895554, mean p set: 0.44952526688575745
loss_pred:0.017234671860933304, decouple_loss:0.0010806260397657752
The modified gen p mean: 0.4482974708080292, gen p mean: -0.050575606524944305, mean p set: 0.4487777352333069The modified gen p mean: 0.4453831911087036, gen p mean: -0.057326141744852066, mean p set: 0.4458634853363037
loss_pred:0.018340934067964554, decouple_loss:0.0011615199036896229
loss_pred:0.01688811369240284, decouple_loss:0.0011286505032330751
Iteration: 599, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473308026790619, gen p mean: -0.05284356325864792, mean p set: 0.447811096906662
The modified gen p mean: 0.4488806128501892, gen p mean: -0.047745950520038605, mean p set: 0.4493609070777893
loss_pred:0.017235703766345978, decouple_loss:0.0010659529361873865
loss_pred:0.01831877790391445, decouple_loss:0.0010006383527070284
The modified gen p mean: 0.4472513496875763, gen p mean: -0.052418921142816544, mean p set: 0.4477316439151764
loss_pred:0.017671477049589157, decouple_loss:0.001143813249655068
Iteration: 600, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4463096559047699, gen p mean: -0.05188531056046486, mean p set: 0.44678995013237
loss_pred:0.01777532324194908, decouple_loss:0.0011168703204020858
The modified gen p mean: 0.4475783109664917, gen p mean: -0.05261051282286644, mean p set: 0.4480586051940918The modified gen p mean: 0.44538137316703796, gen p mean: -0.05194142833352089, mean p set: 0.44586169719696045
loss_pred:0.017886243760585785, decouple_loss:0.0012356317602097988
loss_pred:0.017136652022600174, decouple_loss:0.001236164360307157
2023-05-01 00:39:48 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.052672129124403, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04780600219964981, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04834252595901489, mean p set: 0.4500633478164673
loss_pred:0.018479961901903152, decouple_loss:0.001194508746266365
loss_pred:0.0173533596098423, decouple_loss:0.0011865586275234818
loss_pred:0.017476171255111694, decouple_loss:0.001197347417473793
WV_0_PC_1_EH_0_PS_40, loss: 0.017829470336437225, avg_mse: 0.025580445304512978
current test mse: 0.02558
Iteration: 601, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4458862543106079, gen p mean: -0.053672488778829575, mean p set: 0.446366548538208
The modified gen p mean: 0.4470728039741516, gen p mean: -0.049367714673280716, mean p set: 0.4475530982017517
The modified gen p mean: 0.4462382197380066, gen p mean: -0.048008695244789124, mean p set: 0.4467185139656067
loss_pred:0.017908351495862007, decouple_loss:0.001157382852397859
loss_pred:0.017140675336122513, decouple_loss:0.0012036783155053854loss_pred:0.018019096925854683, decouple_loss:0.0011456612264737487
Iteration: 602, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491589665412903, gen p mean: -0.05816863104701042, mean p set: 0.44963929057121277
The modified gen p mean: 0.4481053948402405, gen p mean: -0.051256339997053146, mean p set: 0.44858571887016296
loss_pred:0.0183592326939106, decouple_loss:0.0011466961586847901
loss_pred:0.018034614622592926, decouple_loss:0.0011820154031738639
The modified gen p mean: 0.4470754563808441, gen p mean: -0.05087381228804588, mean p set: 0.4475557208061218
loss_pred:0.01808682084083557, decouple_loss:0.0010695301461964846
Iteration: 603, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44561290740966797, gen p mean: -0.04842124879360199, mean p set: 0.44609320163726807
loss_pred:0.016301289200782776, decouple_loss:0.0012365445727482438
The modified gen p mean: 0.44823578000068665, gen p mean: -0.04687659069895744, mean p set: 0.44871607422828674The modified gen p mean: 0.4475814700126648, gen p mean: -0.05064196512103081, mean p set: 0.4480617940425873
loss_pred:0.01805204711854458, decouple_loss:0.0011085798032581806
loss_pred:0.01772261969745159, decouple_loss:0.001162062049843371
Iteration: 604, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473434090614319, gen p mean: -0.04792213812470436, mean p set: 0.4478236734867096
loss_pred:0.018061548471450806, decouple_loss:0.0010768610518425703
The modified gen p mean: 0.44870543479919434, gen p mean: -0.04718640446662903, mean p set: 0.44918572902679443The modified gen p mean: 0.4456712305545807, gen p mean: -0.045689407736063004, mean p set: 0.4461515247821808
loss_pred:0.017655350267887115, decouple_loss:0.0011365253012627363
loss_pred:0.016870539635419846, decouple_loss:0.001058252528309822
Iteration: 605, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464940130710602, gen p mean: -0.04724567383527756, mean p set: 0.4469743072986603
loss_pred:0.017980437725782394, decouple_loss:0.0012531168758869171
The modified gen p mean: 0.44712579250335693, gen p mean: -0.047936949878931046, mean p set: 0.44760608673095703The modified gen p mean: 0.4471910893917084, gen p mean: -0.04800265654921532, mean p set: 0.4476713538169861
loss_pred:0.017491651698946953, decouple_loss:0.0014139467384666204
loss_pred:0.01797165907919407, decouple_loss:0.0013932217843830585
Iteration: 606, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44633179903030396, gen p mean: -0.050890833139419556, mean p set: 0.44681212306022644
loss_pred:0.0178456362336874, decouple_loss:0.0010680323466658592
The modified gen p mean: 0.44666028022766113, gen p mean: -0.05102058872580528, mean p set: 0.44714057445526123The modified gen p mean: 0.446638286113739, gen p mean: -0.052152398973703384, mean p set: 0.4471185803413391
loss_pred:0.01779194548726082, decouple_loss:0.001280754106119275
loss_pred:0.01715589128434658, decouple_loss:0.0012310738675296307
Iteration: 607, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44540107250213623, gen p mean: -0.051133155822753906, mean p set: 0.44588136672973633
loss_pred:0.018218040466308594, decouple_loss:0.0013012178242206573
The modified gen p mean: 0.4465714693069458, gen p mean: -0.04485603794455528, mean p set: 0.4470517337322235
The modified gen p mean: 0.44807305932044983, gen p mean: -0.048799507319927216, mean p set: 0.4485533535480499
loss_pred:0.01750638522207737, decouple_loss:0.0013834047131240368
loss_pred:0.0177957471460104, decouple_loss:0.001226126099936664
Iteration: 608, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44588375091552734, gen p mean: -0.04879910871386528, mean p set: 0.44636404514312744
loss_pred:0.017221808433532715, decouple_loss:0.001187324058264494
The modified gen p mean: 0.44793540239334106, gen p mean: -0.05545531213283539, mean p set: 0.4484156668186188The modified gen p mean: 0.44648781418800354, gen p mean: -0.04893970489501953, mean p set: 0.446968138217926
loss_pred:0.016850411891937256, decouple_loss:0.0011199635919183493
loss_pred:0.017821764573454857, decouple_loss:0.0011589557398110628
Iteration: 609, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44641467928886414, gen p mean: -0.05443933978676796, mean p set: 0.4468950033187866
loss_pred:0.016843387857079506, decouple_loss:0.0011497949017211795
The modified gen p mean: 0.4456835389137268, gen p mean: -0.0518670454621315, mean p set: 0.4461638331413269The modified gen p mean: 0.4477458596229553, gen p mean: -0.05330055207014084, mean p set: 0.4482261538505554
loss_pred:0.01718216761946678, decouple_loss:0.001132414792664349
loss_pred:0.01670607179403305, decouple_loss:0.0012149142567068338
Iteration: 610, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446050226688385, gen p mean: -0.04890895634889603, mean p set: 0.4465305209159851
loss_pred:0.017580687999725342, decouple_loss:0.001161743188276887
The modified gen p mean: 0.44722530245780945, gen p mean: -0.05371415242552757, mean p set: 0.44770559668540955The modified gen p mean: 0.4460093677043915, gen p mean: -0.054727423936128616, mean p set: 0.4464896619319916
loss_pred:0.017453378066420555, decouple_loss:0.0012582313502207398
loss_pred:0.01720559224486351, decouple_loss:0.0011492634657770395
2023-05-01 00:41:41 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.055300090461969376, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.05171320587396622, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.051080621778964996, mean p set: 0.4500633478164673
loss_pred:0.018454493954777718, decouple_loss:0.001204913598485291
loss_pred:0.01742827519774437, decouple_loss:0.0011580530554056168
loss_pred:0.017514359205961227, decouple_loss:0.0011493874480947852
WV_0_PC_1_EH_0_PS_40, loss: 0.01785758137702942, avg_mse: 0.025585979223251343
current test mse: 0.025586
Iteration: 611, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44680696725845337, gen p mean: -0.056941598653793335, mean p set: 0.44728726148605347
The modified gen p mean: 0.4464987814426422, gen p mean: -0.04719693586230278, mean p set: 0.4469790756702423
The modified gen p mean: 0.4482898712158203, gen p mean: -0.05567231401801109, mean p set: 0.4487701654434204
loss_pred:0.017210228368639946, decouple_loss:0.0011630968656390905
loss_pred:0.016684507951140404, decouple_loss:0.0011378673370927572
loss_pred:0.017055325210094452, decouple_loss:0.001127805677242577
Iteration: 612, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4459381401538849, gen p mean: -0.0521496906876564, mean p set: 0.446418434381485
loss_pred:0.017758013680577278, decouple_loss:0.0011710443068295717
The modified gen p mean: 0.4471195936203003, gen p mean: -0.05124475806951523, mean p set: 0.4475998878479004The modified gen p mean: 0.44593241810798645, gen p mean: -0.052965015172958374, mean p set: 0.44641271233558655
loss_pred:0.017149103805422783, decouple_loss:0.0011491184122860432
loss_pred:0.018217597156763077, decouple_loss:0.0011195202823728323
Iteration: 613, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44679054617881775, gen p mean: -0.054080985486507416, mean p set: 0.44727084040641785
loss_pred:0.017417557537555695, decouple_loss:0.0011712114792317152
The modified gen p mean: 0.44878455996513367, gen p mean: -0.05709879845380783, mean p set: 0.44926485419273376The modified gen p mean: 0.4472919702529907, gen p mean: -0.05095343291759491, mean p set: 0.44777223467826843
loss_pred:0.017826249822974205, decouple_loss:0.0011216626735404134
loss_pred:0.017760666087269783, decouple_loss:0.0011507791932672262
Iteration: 614, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44592028856277466, gen p mean: -0.05568782985210419, mean p set: 0.44640052318573
loss_pred:0.017041193321347237, decouple_loss:0.0011036721989512444
The modified gen p mean: 0.44616612792015076, gen p mean: -0.05414704978466034, mean p set: 0.44664642214775085The modified gen p mean: 0.44568878412246704, gen p mean: -0.05562952160835266, mean p set: 0.4461691081523895
loss_pred:0.01732070930302143, decouple_loss:0.0011654439149424434
loss_pred:0.017406979575753212, decouple_loss:0.0011501669650897384
Iteration: 615, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44632381200790405, gen p mean: -0.04736380651593208, mean p set: 0.44680410623550415
The modified gen p mean: 0.4483083188533783, gen p mean: -0.04814763739705086, mean p set: 0.4487886130809784
loss_pred:0.01706250011920929, decouple_loss:0.001232355018146336
loss_pred:0.01776961423456669, decouple_loss:0.001167581183835864
The modified gen p mean: 0.44733691215515137, gen p mean: -0.05222311243414879, mean p set: 0.44781720638275146
loss_pred:0.01738079823553562, decouple_loss:0.001167799229733646
Iteration: 616, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44939735531806946, gen p mean: -0.054474711418151855, mean p set: 0.44987761974334717
The modified gen p mean: 0.44680359959602356, gen p mean: -0.04986531659960747, mean p set: 0.44728389382362366
loss_pred:0.017169807106256485, decouple_loss:0.001101518515497446
loss_pred:0.01753794029355049, decouple_loss:0.0011104498989880085
The modified gen p mean: 0.44714638590812683, gen p mean: -0.04934513568878174, mean p set: 0.4476267099380493
loss_pred:0.017988314852118492, decouple_loss:0.0011162427254021168
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012005_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012005_3_24hr.npz
NaN value num: 0
Iteration: 617, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487854838371277, gen p mean: -0.04923287779092789, mean p set: 0.4492657780647278
loss_pred:0.018353845924139023, decouple_loss:0.001237478805705905
The modified gen p mean: 0.44858092069625854, gen p mean: -0.049604758620262146, mean p set: 0.44906121492385864The modified gen p mean: 0.4498950242996216, gen p mean: -0.047849930822849274, mean p set: 0.4503753185272217
loss_pred:0.018472034484148026, decouple_loss:0.0012403131695464253
loss_pred:0.017421159893274307, decouple_loss:0.0011615940602496266
Iteration: 618, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44820013642311096, gen p mean: -0.048067670315504074, mean p set: 0.44868043065071106
loss_pred:0.018193237483501434, decouple_loss:0.0011098901741206646
The modified gen p mean: 0.44749295711517334, gen p mean: -0.05112067610025406, mean p set: 0.44797325134277344The modified gen p mean: 0.44764411449432373, gen p mean: -0.046034298837184906, mean p set: 0.44812440872192383
loss_pred:0.018478455021977425, decouple_loss:0.0011768500553444028
loss_pred:0.01760207675397396, decouple_loss:0.0011609663488343358
Iteration: 619, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45032787322998047, gen p mean: -0.046667009592056274, mean p set: 0.45080816745758057
loss_pred:0.01843239739537239, decouple_loss:0.001111665740609169
The modified gen p mean: 0.44840115308761597, gen p mean: -0.04712623730301857, mean p set: 0.44888144731521606The modified gen p mean: 0.4479368031024933, gen p mean: -0.05065049231052399, mean p set: 0.4484170973300934
loss_pred:0.01831122860312462, decouple_loss:0.001078150817193091
loss_pred:0.017540574073791504, decouple_loss:0.0010494719026610255
Iteration: 620, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489058256149292, gen p mean: -0.04813550412654877, mean p set: 0.4493860900402069
loss_pred:0.018041793256998062, decouple_loss:0.0011871007736772299
The modified gen p mean: 0.4489375054836273, gen p mean: -0.04722020775079727, mean p set: 0.4494177997112274The modified gen p mean: 0.4480952024459839, gen p mean: -0.045472580939531326, mean p set: 0.448575496673584
loss_pred:0.018368089571595192, decouple_loss:0.001107162912376225
loss_pred:0.01823168806731701, decouple_loss:0.0011073274072259665
2023-05-01 00:44:15 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.05304328724741936, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04858364909887314, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04893796518445015, mean p set: 0.4500633478164673
loss_pred:0.018441511318087578, decouple_loss:0.0010976556222885847
loss_pred:0.017359869554638863, decouple_loss:0.0012088775401934981
loss_pred:0.017479293048381805, decouple_loss:0.0010977963684126735
WV_0_PC_1_EH_0_PS_40, loss: 0.01781696453690529, avg_mse: 0.02555936388671398
current test mse: 0.025559
Iteration: 621, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497861862182617, gen p mean: -0.04672418162226677, mean p set: 0.45026645064353943
The modified gen p mean: 0.4491669237613678, gen p mean: -0.04865763336420059, mean p set: 0.4496472179889679
The modified gen p mean: 0.4484393894672394, gen p mean: -0.04833652451634407, mean p set: 0.4489196836948395
loss_pred:0.017615757882595062, decouple_loss:0.001107070012949407
loss_pred:0.01740804687142372, decouple_loss:0.0010891606798395514loss_pred:0.018258482217788696, decouple_loss:0.0010827815858647227
Iteration: 622, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484138786792755, gen p mean: -0.0490063838660717, mean p set: 0.4488941431045532
loss_pred:0.01731119677424431, decouple_loss:0.0011007949942722917
The modified gen p mean: 0.4503535032272339, gen p mean: -0.05195662006735802, mean p set: 0.45083382725715637The modified gen p mean: 0.44973480701446533, gen p mean: -0.05475869029760361, mean p set: 0.45021507143974304
loss_pred:0.018253980204463005, decouple_loss:0.0011331629939377308
loss_pred:0.017543023452162743, decouple_loss:0.001078041736036539
Iteration: 623, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498698115348816, gen p mean: -0.05195428803563118, mean p set: 0.4503500759601593
loss_pred:0.01780063658952713, decouple_loss:0.0010746207553893328
The modified gen p mean: 0.44886526465415955, gen p mean: -0.05503268167376518, mean p set: 0.44934555888175964The modified gen p mean: 0.4474796950817108, gen p mean: -0.057144030928611755, mean p set: 0.4479599893093109
loss_pred:0.018088581040501595, decouple_loss:0.0011361152864992619
loss_pred:0.01816406100988388, decouple_loss:0.0011999912094324827
Iteration: 624, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495837986469269, gen p mean: -0.053752318024635315, mean p set: 0.450064092874527
loss_pred:0.018005019053816795, decouple_loss:0.0009730645106174052
The modified gen p mean: 0.4489072561264038, gen p mean: -0.05881411209702492, mean p set: 0.4493875503540039The modified gen p mean: 0.44879260659217834, gen p mean: -0.05477885156869888, mean p set: 0.44927293062210083
loss_pred:0.01845778338611126, decouple_loss:0.0011089612962678075
loss_pred:0.01821901649236679, decouple_loss:0.0009805221343412995
Iteration: 625, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502216875553131, gen p mean: -0.05550399050116539, mean p set: 0.4507019817829132
loss_pred:0.01772277057170868, decouple_loss:0.0011893657501786947
The modified gen p mean: 0.45022284984588623, gen p mean: -0.05710000917315483, mean p set: 0.4507031738758087The modified gen p mean: 0.4483083188533783, gen p mean: -0.055261727422475815, mean p set: 0.4487886428833008
loss_pred:0.017983661964535713, decouple_loss:0.001146725844591856
loss_pred:0.018003784120082855, decouple_loss:0.0011227771174162626
Iteration: 626, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44896426796913147, gen p mean: -0.05201892554759979, mean p set: 0.44944456219673157
loss_pred:0.01831665262579918, decouple_loss:0.0010317565174773335
The modified gen p mean: 0.44869494438171387, gen p mean: -0.0564725399017334, mean p set: 0.44917523860931396The modified gen p mean: 0.4494518041610718, gen p mean: -0.053444065153598785, mean p set: 0.4499320983886719
loss_pred:0.017935840412974358, decouple_loss:0.0010990992886945605
loss_pred:0.01822979934513569, decouple_loss:0.0011151687940582633
Iteration: 627, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499596357345581, gen p mean: -0.05046122893691063, mean p set: 0.4504399299621582
loss_pred:0.01739453710615635, decouple_loss:0.0010000945767387748
The modified gen p mean: 0.4504501223564148, gen p mean: -0.05198913812637329, mean p set: 0.4509304463863373The modified gen p mean: 0.44945579767227173, gen p mean: -0.04895959794521332, mean p set: 0.44993606209754944
loss_pred:0.017738018184900284, decouple_loss:0.0010250852210447192
loss_pred:0.017647864297032356, decouple_loss:0.0010526026599109173
Iteration: 628, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44764530658721924, gen p mean: -0.04582584649324417, mean p set: 0.4481256306171417
loss_pred:0.017702724784612656, decouple_loss:0.001011269399896264
The modified gen p mean: 0.4482744038105011, gen p mean: -0.04244840145111084, mean p set: 0.4487546980381012The modified gen p mean: 0.44971132278442383, gen p mean: -0.043179742991924286, mean p set: 0.4501916468143463
loss_pred:0.017596520483493805, decouple_loss:0.0010204109130427241
loss_pred:0.01878301426768303, decouple_loss:0.001010452164337039
Iteration: 629, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500262439250946, gen p mean: -0.04408781975507736, mean p set: 0.4505065083503723
loss_pred:0.01752549409866333, decouple_loss:0.0009755708160810173
The modified gen p mean: 0.44862014055252075, gen p mean: -0.04188786447048187, mean p set: 0.44910046458244324The modified gen p mean: 0.44978076219558716, gen p mean: -0.04598630592226982, mean p set: 0.45026108622550964
loss_pred:0.017948882654309273, decouple_loss:0.001082899165339768
loss_pred:0.01809224672615528, decouple_loss:0.0010943588567897677
Iteration: 630, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45030322670936584, gen p mean: -0.04456125199794769, mean p set: 0.45078352093696594
loss_pred:0.017288070172071457, decouple_loss:0.0009532889234833419
The modified gen p mean: 0.4490582346916199, gen p mean: -0.04432696849107742, mean p set: 0.44953852891921997The modified gen p mean: 0.44969338178634644, gen p mean: -0.046339478343725204, mean p set: 0.45017367601394653
loss_pred:0.017535092309117317, decouple_loss:0.0009632380679249763
loss_pred:0.018682098016142845, decouple_loss:0.000982769182883203
2023-05-01 00:46:08 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.046926625072956085, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04221232607960701, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.042802080512046814, mean p set: 0.4500633478164673
loss_pred:0.018433373421430588, decouple_loss:0.001072398154065013
loss_pred:0.017368219792842865, decouple_loss:0.0011233732802793384
loss_pred:0.017506694421172142, decouple_loss:0.0010444653453305364
WV_0_PC_1_EH_0_PS_40, loss: 0.017823433503508568, avg_mse: 0.025584395974874496
current test mse: 0.025584
Iteration: 631, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493016302585602, gen p mean: -0.0426236167550087, mean p set: 0.4497818946838379
The modified gen p mean: 0.44807255268096924, gen p mean: -0.048536304384469986, mean p set: 0.44855284690856934
The modified gen p mean: 0.4487479329109192, gen p mean: -0.04267193749547005, mean p set: 0.4492282271385193
loss_pred:0.018210051581263542, decouple_loss:0.001071006990969181
loss_pred:0.018602006137371063, decouple_loss:0.00107699038926512
loss_pred:0.017640650272369385, decouple_loss:0.0010904885130003095
Iteration: 632, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498195946216583, gen p mean: -0.042465630918741226, mean p set: 0.4502998888492584
loss_pred:0.017452379688620567, decouple_loss:0.0009468305506743491
The modified gen p mean: 0.44799548387527466, gen p mean: -0.042410917580127716, mean p set: 0.44847577810287476The modified gen p mean: 0.4473685026168823, gen p mean: -0.04391941800713539, mean p set: 0.4478487968444824
loss_pred:0.018142366781830788, decouple_loss:0.001086787087842822
loss_pred:0.018252061679959297, decouple_loss:0.0010530633153393865
Iteration: 633, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448699414730072, gen p mean: -0.047160472720861435, mean p set: 0.4491797089576721
loss_pred:0.017938395962119102, decouple_loss:0.0009955671848729253
The modified gen p mean: 0.44796493649482727, gen p mean: -0.04430875554680824, mean p set: 0.44844523072242737The modified gen p mean: 0.44838595390319824, gen p mean: -0.04336341843008995, mean p set: 0.4488662779331207
loss_pred:0.017799023538827896, decouple_loss:0.0009885692270472646
loss_pred:0.017823701724410057, decouple_loss:0.0009735500789247453
Iteration: 634, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496310353279114, gen p mean: -0.04562618210911751, mean p set: 0.4501113295555115
loss_pred:0.017504645511507988, decouple_loss:0.001055308268405497
The modified gen p mean: 0.44815143942832947, gen p mean: -0.046165067702531815, mean p set: 0.44863176345825195The modified gen p mean: 0.4509904682636261, gen p mean: -0.04884018748998642, mean p set: 0.4514707326889038
loss_pred:0.01834401860833168, decouple_loss:0.0011887048603966832
loss_pred:0.017452305182814598, decouple_loss:0.0010778442956507206
Iteration: 635, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44845178723335266, gen p mean: -0.04666256904602051, mean p set: 0.44893211126327515
loss_pred:0.01785091497004032, decouple_loss:0.0009945768397301435
The modified gen p mean: 0.4496042728424072, gen p mean: -0.043370820581912994, mean p set: 0.4500845670700073The modified gen p mean: 0.4486227035522461, gen p mean: -0.04469512775540352, mean p set: 0.4491029977798462
loss_pred:0.017413975670933723, decouple_loss:0.00099959596991539
loss_pred:0.01825585961341858, decouple_loss:0.0009785890579223633
Iteration: 636, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447918564081192, gen p mean: -0.04355373978614807, mean p set: 0.4483988583087921
loss_pred:0.017351452261209488, decouple_loss:0.0009512724936939776
The modified gen p mean: 0.4492219388484955, gen p mean: -0.04686462879180908, mean p set: 0.4497022032737732The modified gen p mean: 0.4486786425113678, gen p mean: -0.044470541179180145, mean p set: 0.4491589367389679
loss_pred:0.01769801788032055, decouple_loss:0.0010234360815957189
loss_pred:0.018552929162979126, decouple_loss:0.001073459628969431
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012018_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012018_3_24hr.npz
NaN value num: 0
Iteration: 637, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483950436115265, gen p mean: -0.04196862503886223, mean p set: 0.4488753378391266
loss_pred:0.016326094046235085, decouple_loss:0.0010665747104212642
The modified gen p mean: 0.4492394030094147, gen p mean: -0.040904488414525986, mean p set: 0.44971972703933716The modified gen p mean: 0.4496171176433563, gen p mean: -0.04392147436738014, mean p set: 0.4500974118709564
loss_pred:0.01605643890798092, decouple_loss:0.0009930584346875548
loss_pred:0.01565050520002842, decouple_loss:0.001009320723824203
Iteration: 638, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44943416118621826, gen p mean: -0.04780595749616623, mean p set: 0.44991445541381836
loss_pred:0.015529587864875793, decouple_loss:0.0011366838589310646
The modified gen p mean: 0.4498298168182373, gen p mean: -0.040967050939798355, mean p set: 0.450310081243515The modified gen p mean: 0.449282169342041, gen p mean: -0.0424402616918087, mean p set: 0.4497624933719635
loss_pred:0.0159099530428648, decouple_loss:0.0010797242866829038
loss_pred:0.016149401664733887, decouple_loss:0.0011076276423409581
Iteration: 639, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490712583065033, gen p mean: -0.046057552099227905, mean p set: 0.4495515525341034
The modified gen p mean: 0.44851556420326233, gen p mean: -0.03737176954746246, mean p set: 0.4489958584308624
loss_pred:0.014998062513768673, decouple_loss:0.0010549130383878946
loss_pred:0.015937741845846176, decouple_loss:0.0010802964679896832The modified gen p mean: 0.4479655921459198, gen p mean: -0.04800081253051758, mean p set: 0.4484458863735199
loss_pred:0.015262279659509659, decouple_loss:0.001151720411144197
Iteration: 640, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479248821735382, gen p mean: -0.03681078180670738, mean p set: 0.4484051764011383
loss_pred:0.015300006605684757, decouple_loss:0.00121528678573668
The modified gen p mean: 0.4510590434074402, gen p mean: -0.034518759697675705, mean p set: 0.4515393376350403The modified gen p mean: 0.4478776156902313, gen p mean: -0.04242181032896042, mean p set: 0.4483579099178314
loss_pred:0.015331029891967773, decouple_loss:0.001418168074451387
loss_pred:0.014502438716590405, decouple_loss:0.001227836823090911
2023-05-01 00:48:37 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.04445374011993408, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04009465500712395, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.040371447801589966, mean p set: 0.4500633478164673
loss_pred:0.018788916990160942, decouple_loss:0.0013513509184122086
loss_pred:0.0176240187138319, decouple_loss:0.001300936215557158
loss_pred:0.01768697425723076, decouple_loss:0.0013488562544807792
WV_0_PC_1_EH_0_PS_40, loss: 0.018099989742040634, avg_mse: 0.026043305173516273
current test mse: 0.026043
Iteration: 641, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449035108089447, gen p mean: -0.034998245537281036, mean p set: 0.4495154023170471
The modified gen p mean: 0.4480951428413391, gen p mean: -0.040418315678834915, mean p set: 0.4485754370689392
The modified gen p mean: 0.4492180645465851, gen p mean: -0.040655795484781265, mean p set: 0.4496983587741852
loss_pred:0.01537159364670515, decouple_loss:0.0012297972571104765
loss_pred:0.01473457645624876, decouple_loss:0.0012883562594652176
loss_pred:0.0154725331813097, decouple_loss:0.0013102949596941471
Iteration: 642, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475609362125397, gen p mean: -0.04467835649847984, mean p set: 0.4480412006378174
loss_pred:0.014704459346830845, decouple_loss:0.0013266674941405654
The modified gen p mean: 0.44862130284309387, gen p mean: -0.038891635835170746, mean p set: 0.44910159707069397The modified gen p mean: 0.4483445882797241, gen p mean: -0.038634780794382095, mean p set: 0.4488248825073242
loss_pred:0.014892779290676117, decouple_loss:0.001232040929608047
loss_pred:0.014743532054126263, decouple_loss:0.001239998615346849
Iteration: 643, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44885820150375366, gen p mean: -0.04015965387225151, mean p set: 0.44933852553367615
loss_pred:0.013769950717687607, decouple_loss:0.0015078693395480514
The modified gen p mean: 0.44853314757347107, gen p mean: -0.03513156995177269, mean p set: 0.44901344180107117The modified gen p mean: 0.4495634436607361, gen p mean: -0.035511814057826996, mean p set: 0.45004376769065857
loss_pred:0.015004455111920834, decouple_loss:0.0013424498029053211
loss_pred:0.014090044423937798, decouple_loss:0.0013077305629849434
Iteration: 644, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494500458240509, gen p mean: -0.043305255472660065, mean p set: 0.4499303698539734
loss_pred:0.01522331777960062, decouple_loss:0.0013285311870276928
The modified gen p mean: 0.4485279321670532, gen p mean: -0.0467957966029644, mean p set: 0.4490082263946533The modified gen p mean: 0.44879257678985596, gen p mean: -0.03959115594625473, mean p set: 0.44927287101745605
loss_pred:0.013627368956804276, decouple_loss:0.0014367145486176014
loss_pred:0.014713217504322529, decouple_loss:0.0014022658579051495
Iteration: 645, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44937974214553833, gen p mean: -0.03782300278544426, mean p set: 0.44986000657081604
loss_pred:0.01432470791041851, decouple_loss:0.0014457632787525654
The modified gen p mean: 0.4486910402774811, gen p mean: -0.03916086256504059, mean p set: 0.4491713047027588The modified gen p mean: 0.4490082561969757, gen p mean: -0.04128110408782959, mean p set: 0.4494885504245758
loss_pred:0.015153692103922367, decouple_loss:0.0015822735149413347
loss_pred:0.014707976952195168, decouple_loss:0.001551841152831912
Iteration: 646, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500400722026825, gen p mean: -0.043188706040382385, mean p set: 0.450520396232605
loss_pred:0.014182832092046738, decouple_loss:0.0015299264341592789
The modified gen p mean: 0.4490126073360443, gen p mean: -0.0419989675283432, mean p set: 0.4494929015636444The modified gen p mean: 0.44786709547042847, gen p mean: -0.04818887263536453, mean p set: 0.44834738969802856
loss_pred:0.014543470926582813, decouple_loss:0.0014400854706764221
loss_pred:0.013699572533369064, decouple_loss:0.0014635013649240136
Iteration: 647, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491003453731537, gen p mean: -0.04990586265921593, mean p set: 0.4495806396007538
loss_pred:0.013779530301690102, decouple_loss:0.001515523181296885
The modified gen p mean: 0.44916248321533203, gen p mean: -0.04457256942987442, mean p set: 0.44964277744293213The modified gen p mean: 0.44800862669944763, gen p mean: -0.05403224378824234, mean p set: 0.44848892092704773
loss_pred:0.01462956890463829, decouple_loss:0.0014081632252782583
loss_pred:0.01430832501500845, decouple_loss:0.0014427757123485208
Iteration: 648, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44823336601257324, gen p mean: -0.05218646675348282, mean p set: 0.4487136900424957
loss_pred:0.014518383890390396, decouple_loss:0.0015670887660235167
The modified gen p mean: 0.4494502544403076, gen p mean: -0.04935915768146515, mean p set: 0.4499305486679077The modified gen p mean: 0.44827431440353394, gen p mean: -0.053689371794462204, mean p set: 0.4487546384334564
loss_pred:0.013560621999204159, decouple_loss:0.0016229725442826748
loss_pred:0.01442306861281395, decouple_loss:0.0015666785184293985
Iteration: 649, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44955405592918396, gen p mean: -0.047142162919044495, mean p set: 0.45003435015678406
loss_pred:0.01375117152929306, decouple_loss:0.0014902778202667832
The modified gen p mean: 0.44823217391967773, gen p mean: -0.05175689235329628, mean p set: 0.44871246814727783The modified gen p mean: 0.449535071849823, gen p mean: -0.04355466365814209, mean p set: 0.4500153958797455
loss_pred:0.014054191298782825, decouple_loss:0.0015808077296242118
loss_pred:0.013688036240637302, decouple_loss:0.0014891814207658172
Iteration: 650, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44893208146095276, gen p mean: -0.04289355129003525, mean p set: 0.44941237568855286
loss_pred:0.014194651506841183, decouple_loss:0.001516483025625348
The modified gen p mean: 0.4498286545276642, gen p mean: -0.04435192048549652, mean p set: 0.4503089487552643The modified gen p mean: 0.44875583052635193, gen p mean: -0.048618778586387634, mean p set: 0.449236124753952
loss_pred:0.01348917931318283, decouple_loss:0.0014849596191197634
loss_pred:0.013256681151688099, decouple_loss:0.001502834027633071
2023-05-01 00:50:32 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.048427216708660126, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.0437716469168663, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04406001418828964, mean p set: 0.4500633478164673
loss_pred:0.019504843279719353, decouple_loss:0.0015762308612465858
loss_pred:0.01835312694311142, decouple_loss:0.001460603903979063
loss_pred:0.018537448719143867, decouple_loss:0.0015188457909971476
WV_0_PC_1_EH_0_PS_40, loss: 0.018874403089284897, avg_mse: 0.02753879874944687
current test mse: 0.027539
Iteration: 651, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44948524236679077, gen p mean: -0.040056705474853516, mean p set: 0.44996556639671326
The modified gen p mean: 0.44861990213394165, gen p mean: -0.03984295576810837, mean p set: 0.44910016655921936
The modified gen p mean: 0.4493091106414795, gen p mean: -0.04296485334634781, mean p set: 0.4497894048690796
loss_pred:0.013457905501127243, decouple_loss:0.0014322244096547365
loss_pred:0.013818240724503994, decouple_loss:0.0014841248048469424
loss_pred:0.014143927954137325, decouple_loss:0.0014698831364512444
Iteration: 652, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44802820682525635, gen p mean: -0.044871095567941666, mean p set: 0.44850850105285645
loss_pred:0.01330309547483921, decouple_loss:0.001451208721846342
The modified gen p mean: 0.45006632804870605, gen p mean: -0.03456728532910347, mean p set: 0.45054665207862854The modified gen p mean: 0.4499236047267914, gen p mean: -0.041177328675985336, mean p set: 0.4504038989543915
loss_pred:0.013727981597185135, decouple_loss:0.0014556554378941655
loss_pred:0.013935094699263573, decouple_loss:0.001393977552652359
Iteration: 653, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479435980319977, gen p mean: -0.043493859469890594, mean p set: 0.44842392206192017
loss_pred:0.013287697918713093, decouple_loss:0.001377403736114502
The modified gen p mean: 0.4488747715950012, gen p mean: -0.04361958056688309, mean p set: 0.4493550956249237The modified gen p mean: 0.4487936794757843, gen p mean: -0.037506792694330215, mean p set: 0.4492739737033844
loss_pred:0.014086904004216194, decouple_loss:0.0013920324854552746
loss_pred:0.013924713246524334, decouple_loss:0.0013383206678554416
Iteration: 654, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44929617643356323, gen p mean: -0.03944610059261322, mean p set: 0.44977647066116333
loss_pred:0.013556430116295815, decouple_loss:0.0013506155228242278
The modified gen p mean: 0.45011135935783386, gen p mean: -0.045035310089588165, mean p set: 0.45059165358543396The modified gen p mean: 0.4478102922439575, gen p mean: -0.04770110920071602, mean p set: 0.44829061627388
loss_pred:0.0139293959364295, decouple_loss:0.0012746818829327822
loss_pred:0.013343079946935177, decouple_loss:0.0013235339429229498
Iteration: 655, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4506920874118805, gen p mean: -0.03681591525673866, mean p set: 0.451172411441803
loss_pred:0.013860063627362251, decouple_loss:0.001476838137023151
The modified gen p mean: 0.44851458072662354, gen p mean: -0.041854843497276306, mean p set: 0.44899484515190125The modified gen p mean: 0.4490033984184265, gen p mean: -0.04534667357802391, mean p set: 0.4494836926460266
loss_pred:0.014470310881733894, decouple_loss:0.0013700027484446764
loss_pred:0.012987400405108929, decouple_loss:0.0014358891639858484
Iteration: 656, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44890040159225464, gen p mean: -0.041598133742809296, mean p set: 0.4493807256221771
loss_pred:0.013547300361096859, decouple_loss:0.0012643425725400448
The modified gen p mean: 0.44849181175231934, gen p mean: -0.043062806129455566, mean p set: 0.44897210597991943The modified gen p mean: 0.44784533977508545, gen p mean: -0.05017983913421631, mean p set: 0.44832560420036316
loss_pred:0.013805363327264786, decouple_loss:0.0013100961223244667
loss_pred:0.01312781311571598, decouple_loss:0.0015406723832711577
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012014_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012014_3_24hr.npz
NaN value num: 0
Iteration: 657, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484897255897522, gen p mean: -0.042527589946985245, mean p set: 0.4489700198173523
loss_pred:0.018630528822541237, decouple_loss:0.0013857471058145165
The modified gen p mean: 0.44969624280929565, gen p mean: -0.04217643663287163, mean p set: 0.45017653703689575The modified gen p mean: 0.4501833915710449, gen p mean: -0.040630634874105453, mean p set: 0.450663685798645
loss_pred:0.017798813059926033, decouple_loss:0.0013784768525511026
loss_pred:0.019091831520199776, decouple_loss:0.0014377509942278266
Iteration: 658, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490300416946411, gen p mean: -0.039950549602508545, mean p set: 0.4495103359222412
loss_pred:0.018749019131064415, decouple_loss:0.0014473535120487213
The modified gen p mean: 0.45069873332977295, gen p mean: -0.03486946225166321, mean p set: 0.45117899775505066The modified gen p mean: 0.45019152760505676, gen p mean: -0.03973826393485069, mean p set: 0.45067182183265686
loss_pred:0.01771378517150879, decouple_loss:0.0013963681412860751
loss_pred:0.0177997387945652, decouple_loss:0.001340930350124836
Iteration: 659, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4523509442806244, gen p mean: -0.03790188580751419, mean p set: 0.4528312385082245
loss_pred:0.01733987219631672, decouple_loss:0.0013093006564304233
The modified gen p mean: 0.4509003162384033, gen p mean: -0.041003067046403885, mean p set: 0.4513806104660034The modified gen p mean: 0.450116902589798, gen p mean: -0.039621468633413315, mean p set: 0.45059719681739807
loss_pred:0.017820442095398903, decouple_loss:0.001492728479206562
loss_pred:0.01753596030175686, decouple_loss:0.001379232737235725
Iteration: 660, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487544894218445, gen p mean: -0.038318999111652374, mean p set: 0.4492347836494446
loss_pred:0.0177233275026083, decouple_loss:0.0013926445972174406
The modified gen p mean: 0.449428915977478, gen p mean: -0.03951791301369667, mean p set: 0.4499092102050781The modified gen p mean: 0.4484436810016632, gen p mean: -0.041378919035196304, mean p set: 0.4489240050315857
loss_pred:0.01720336265861988, decouple_loss:0.0013544817920774221
loss_pred:0.01807045377790928, decouple_loss:0.001495502656325698
2023-05-01 00:53:07 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.04892433434724808, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.044230394065380096, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.04494021087884903, mean p set: 0.4500633478164673
loss_pred:0.01877925544977188, decouple_loss:0.0014236822025850415
loss_pred:0.017693139612674713, decouple_loss:0.0014078622916713357
loss_pred:0.017858386039733887, decouple_loss:0.0013702332507818937
WV_0_PC_1_EH_0_PS_40, loss: 0.01818029023706913, avg_mse: 0.02616589143872261
current test mse: 0.026166
Iteration: 661, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489710330963135, gen p mean: -0.042769771069288254, mean p set: 0.4494513273239136
The modified gen p mean: 0.4483395516872406, gen p mean: -0.039430808275938034, mean p set: 0.4488198161125183
The modified gen p mean: 0.449733167886734, gen p mean: -0.044298917055130005, mean p set: 0.4502134323120117
loss_pred:0.017631979659199715, decouple_loss:0.0013211595360189676
loss_pred:0.018461555242538452, decouple_loss:0.00143500289414078
loss_pred:0.018990518525242805, decouple_loss:0.0012812868226319551
Iteration: 662, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44789403676986694, gen p mean: -0.04889143630862236, mean p set: 0.44837433099746704
loss_pred:0.018205735832452774, decouple_loss:0.0014594492968171835
The modified gen p mean: 0.4490245580673218, gen p mean: -0.043981343507766724, mean p set: 0.4495048522949219The modified gen p mean: 0.45101815462112427, gen p mean: -0.0386747270822525, mean p set: 0.45149844884872437
loss_pred:0.01764070615172386, decouple_loss:0.001426038914360106
loss_pred:0.018461432307958603, decouple_loss:0.0013791759265586734
Iteration: 663, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45175960659980774, gen p mean: -0.04041118919849396, mean p set: 0.45223987102508545
loss_pred:0.017170149832963943, decouple_loss:0.001404201495461166
The modified gen p mean: 0.448906809091568, gen p mean: -0.0435507707297802, mean p set: 0.4493871033191681The modified gen p mean: 0.45081618428230286, gen p mean: -0.03723153844475746, mean p set: 0.45129647850990295
loss_pred:0.017367033287882805, decouple_loss:0.0013976041227579117
loss_pred:0.01796732284128666, decouple_loss:0.0013549980940297246
Iteration: 664, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44812560081481934, gen p mean: -0.05106205493211746, mean p set: 0.44860586524009705
loss_pred:0.01844213902950287, decouple_loss:0.0013936894247308373
The modified gen p mean: 0.44838157296180725, gen p mean: -0.04357315972447395, mean p set: 0.44886186718940735The modified gen p mean: 0.4508685767650604, gen p mean: -0.0361311212182045, mean p set: 0.4513488709926605
loss_pred:0.0180232971906662, decouple_loss:0.0013508200645446777
loss_pred:0.01805366389453411, decouple_loss:0.00128691247664392
Iteration: 665, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.452470064163208, gen p mean: -0.04174938052892685, mean p set: 0.4529503583908081
loss_pred:0.018079087138175964, decouple_loss:0.0012874751118943095
The modified gen p mean: 0.4513009190559387, gen p mean: -0.04110812395811081, mean p set: 0.4517812132835388The modified gen p mean: 0.4493236243724823, gen p mean: -0.045139241963624954, mean p set: 0.4498039484024048
loss_pred:0.017927296459674835, decouple_loss:0.0013556353515014052
loss_pred:0.017737634479999542, decouple_loss:0.001276439055800438
Iteration: 666, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500284194946289, gen p mean: -0.042386699467897415, mean p set: 0.450508713722229
loss_pred:0.016416901722550392, decouple_loss:0.0013225807342678308
The modified gen p mean: 0.44761693477630615, gen p mean: -0.04397035017609596, mean p set: 0.44809725880622864The modified gen p mean: 0.4494486451148987, gen p mean: -0.04515647143125534, mean p set: 0.4499289393424988
loss_pred:0.017635518684983253, decouple_loss:0.001320588868111372
loss_pred:0.01784212701022625, decouple_loss:0.0014196927659213543
Iteration: 667, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495542049407959, gen p mean: -0.03845370560884476, mean p set: 0.4500344693660736
loss_pred:0.018470223993062973, decouple_loss:0.0012674867175519466
The modified gen p mean: 0.45023342967033386, gen p mean: -0.04144131764769554, mean p set: 0.45071372389793396The modified gen p mean: 0.45051509141921997, gen p mean: -0.041415829211473465, mean p set: 0.45099538564682007
loss_pred:0.017197873443365097, decouple_loss:0.0013256646925583482
loss_pred:0.017158661037683487, decouple_loss:0.0013611357426270843
Iteration: 668, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44933462142944336, gen p mean: -0.037611667066812515, mean p set: 0.44981491565704346
loss_pred:0.018723417073488235, decouple_loss:0.0012613155413419008
The modified gen p mean: 0.44906073808670044, gen p mean: -0.03867802023887634, mean p set: 0.44954103231430054The modified gen p mean: 0.4502730667591095, gen p mean: -0.04192469269037247, mean p set: 0.4507533609867096
loss_pred:0.017750009894371033, decouple_loss:0.0014232288813218474
loss_pred:0.016962716355919838, decouple_loss:0.0013337429845705628
Iteration: 669, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44966378808021545, gen p mean: -0.04293869808316231, mean p set: 0.45014408230781555
loss_pred:0.018055317923426628, decouple_loss:0.0014494967181235552
The modified gen p mean: 0.4489746391773224, gen p mean: -0.039854828268289566, mean p set: 0.4494549334049225The modified gen p mean: 0.44990232586860657, gen p mean: -0.042621541768312454, mean p set: 0.45038262009620667
loss_pred:0.018132319673895836, decouple_loss:0.001304635894484818
loss_pred:0.0179753340780735, decouple_loss:0.0013252139324322343
Iteration: 670, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449812114238739, gen p mean: -0.046550486236810684, mean p set: 0.4502924084663391
loss_pred:0.017354950308799744, decouple_loss:0.0012114843120798469
The modified gen p mean: 0.4522463381290436, gen p mean: -0.04568427428603172, mean p set: 0.4527266025543213The modified gen p mean: 0.45186713337898254, gen p mean: -0.045998215675354004, mean p set: 0.45234742760658264
loss_pred:0.01825961098074913, decouple_loss:0.0012351592304185033
loss_pred:0.017155727371573448, decouple_loss:0.0012316919164732099
2023-05-01 00:55:00 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.05634928494691849, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.05082761496305466, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.05198831111192703, mean p set: 0.4500633478164673
loss_pred:0.01855427585542202, decouple_loss:0.001413771416991949
loss_pred:0.017502639442682266, decouple_loss:0.0014454354532063007
loss_pred:0.01760091632604599, decouple_loss:0.0013699437258765101
WV_0_PC_1_EH_0_PS_40, loss: 0.017956430092453957, avg_mse: 0.025781257078051567
current test mse: 0.025781
Iteration: 671, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44900038838386536, gen p mean: -0.04919751361012459, mean p set: 0.44948065280914307
The modified gen p mean: 0.44963744282722473, gen p mean: -0.05040790140628815, mean p set: 0.45011773705482483
The modified gen p mean: 0.4518488347530365, gen p mean: -0.04699139669537544, mean p set: 0.4523291289806366
loss_pred:0.01756731979548931, decouple_loss:0.0013237594394013286
loss_pred:0.017796309664845467, decouple_loss:0.0012588712852448225
loss_pred:0.01828247867524624, decouple_loss:0.001356726628728211
Iteration: 672, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4506288766860962, gen p mean: -0.05360262840986252, mean p set: 0.4511091411113739
loss_pred:0.017282821238040924, decouple_loss:0.0012022394221276045
The modified gen p mean: 0.4490962624549866, gen p mean: -0.054423827677965164, mean p set: 0.4495765268802643The modified gen p mean: 0.44946563243865967, gen p mean: -0.05159466713666916, mean p set: 0.4499458968639374
loss_pred:0.01797761209309101, decouple_loss:0.001336284913122654
loss_pred:0.01765366457402706, decouple_loss:0.001181508181616664
Iteration: 673, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489809572696686, gen p mean: -0.054673049598932266, mean p set: 0.4494612514972687
loss_pred:0.017823562026023865, decouple_loss:0.001234054216183722
The modified gen p mean: 0.4497763216495514, gen p mean: -0.054845985025167465, mean p set: 0.4502566158771515The modified gen p mean: 0.4490131735801697, gen p mean: -0.04976539686322212, mean p set: 0.4494934380054474
loss_pred:0.01804340071976185, decouple_loss:0.0011808142298832536
loss_pred:0.017382077872753143, decouple_loss:0.001185237430036068
Iteration: 674, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44814273715019226, gen p mean: -0.05178866162896156, mean p set: 0.44862303137779236
loss_pred:0.01734687201678753, decouple_loss:0.0012778198579326272
The modified gen p mean: 0.44825178384780884, gen p mean: -0.05069518834352493, mean p set: 0.44873207807540894The modified gen p mean: 0.4494033455848694, gen p mean: -0.04988405853509903, mean p set: 0.4498836100101471
loss_pred:0.01736629009246826, decouple_loss:0.0012449456844478846
loss_pred:0.018137600272893906, decouple_loss:0.0011421074159443378
Iteration: 675, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490867257118225, gen p mean: -0.04795611649751663, mean p set: 0.449567049741745
loss_pred:0.01820608787238598, decouple_loss:0.0011720916954800487
The modified gen p mean: 0.4487537443637848, gen p mean: -0.046396106481552124, mean p set: 0.4492340683937073The modified gen p mean: 0.45149093866348267, gen p mean: -0.047158218920230865, mean p set: 0.45197123289108276
loss_pred:0.01817147433757782, decouple_loss:0.0011120912386104465
loss_pred:0.018393652513623238, decouple_loss:0.0011714339489117265
Iteration: 676, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44875484704971313, gen p mean: -0.041556015610694885, mean p set: 0.44923514127731323
loss_pred:0.018094509840011597, decouple_loss:0.0011646859347820282
The modified gen p mean: 0.4482707977294922, gen p mean: -0.041517697274684906, mean p set: 0.4487510621547699The modified gen p mean: 0.4486936330795288, gen p mean: -0.040192533284425735, mean p set: 0.4491738975048065
loss_pred:0.018080975860357285, decouple_loss:0.0010770512744784355
loss_pred:0.017878180369734764, decouple_loss:0.0011544683948159218
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012013_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012013_3_24hr.npz
NaN value num: 0
Iteration: 677, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44725826382637024, gen p mean: -0.04944448545575142, mean p set: 0.4477385878562927
loss_pred:0.014753295108675957, decouple_loss:0.0012174206785857677
The modified gen p mean: 0.4483893811702728, gen p mean: -0.03955798223614693, mean p set: 0.4488696753978729The modified gen p mean: 0.4473222494125366, gen p mean: -0.04946557432413101, mean p set: 0.4478025436401367
loss_pred:0.014807314611971378, decouple_loss:0.001156710321083665
loss_pred:0.014741586521267891, decouple_loss:0.0012022530427202582
Iteration: 678, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467009902000427, gen p mean: -0.03884052485227585, mean p set: 0.4471812844276428
loss_pred:0.014919879846274853, decouple_loss:0.0011962121352553368
The modified gen p mean: 0.4470463991165161, gen p mean: -0.042408641427755356, mean p set: 0.4475267231464386The modified gen p mean: 0.4465150237083435, gen p mean: -0.04057060554623604, mean p set: 0.4469953179359436
loss_pred:0.014624747447669506, decouple_loss:0.0012608253164216876
loss_pred:0.014769249595701694, decouple_loss:0.0012200764613226056
Iteration: 679, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44799256324768066, gen p mean: -0.041252605617046356, mean p set: 0.44847285747528076
loss_pred:0.014917491003870964, decouple_loss:0.001311665284447372
The modified gen p mean: 0.4466283321380615, gen p mean: -0.040973108261823654, mean p set: 0.447108656167984The modified gen p mean: 0.44819068908691406, gen p mean: -0.039046596735715866, mean p set: 0.4486709535121918
loss_pred:0.014257172122597694, decouple_loss:0.001275703078135848
loss_pred:0.014215960167348385, decouple_loss:0.001387167489156127
Iteration: 680, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485374093055725, gen p mean: -0.04372068867087364, mean p set: 0.4490176737308502
loss_pred:0.014594328589737415, decouple_loss:0.0012226136168465018
The modified gen p mean: 0.44877997040748596, gen p mean: -0.047651298344135284, mean p set: 0.44926023483276367The modified gen p mean: 0.4465497136116028, gen p mean: -0.045028120279312134, mean p set: 0.4470299780368805
loss_pred:0.014454390853643417, decouple_loss:0.0012924631591886282
loss_pred:0.014386278577148914, decouple_loss:0.0013083729427307844
2023-05-01 00:57:46 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.05053505301475525, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04578563943505287, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04689743369817734, mean p set: 0.4500633478164673
loss_pred:0.018945883959531784, decouple_loss:0.0015243624802678823
loss_pred:0.01781511679291725, decouple_loss:0.001468685339204967
loss_pred:0.01791062019765377, decouple_loss:0.0015056068077683449
WV_0_PC_1_EH_0_PS_40, loss: 0.018298853188753128, avg_mse: 0.026396820321679115
current test mse: 0.026397
Iteration: 681, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44745805859565735, gen p mean: -0.05239728093147278, mean p set: 0.44793838262557983
The modified gen p mean: 0.44752824306488037, gen p mean: -0.04787667468190193, mean p set: 0.44800853729248047
The modified gen p mean: 0.44750797748565674, gen p mean: -0.04411734268069267, mean p set: 0.44798827171325684
loss_pred:0.01362633053213358, decouple_loss:0.0014026868157088757
loss_pred:0.014112802222371101, decouple_loss:0.0014550333144143224
loss_pred:0.013800224289298058, decouple_loss:0.0015609449474141002
Iteration: 682, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481365978717804, gen p mean: -0.05024847015738487, mean p set: 0.4486168920993805
The modified gen p mean: 0.4480850398540497, gen p mean: -0.04426382854580879, mean p set: 0.4485653042793274
loss_pred:0.013939226977527142, decouple_loss:0.0013042934006080031
loss_pred:0.013519098982214928, decouple_loss:0.0013409493258222938
The modified gen p mean: 0.4479955732822418, gen p mean: -0.05389184504747391, mean p set: 0.4484758675098419
loss_pred:0.013737767934799194, decouple_loss:0.00134015001822263
Iteration: 683, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487041234970093, gen p mean: -0.04530182108283043, mean p set: 0.449184387922287
loss_pred:0.01378089189529419, decouple_loss:0.0013048569671809673
The modified gen p mean: 0.44742703437805176, gen p mean: -0.05185973644256592, mean p set: 0.44790735840797424The modified gen p mean: 0.4477558732032776, gen p mean: -0.050846535712480545, mean p set: 0.4482361972332001
loss_pred:0.013531791046261787, decouple_loss:0.0013732177903875709
loss_pred:0.013621496967971325, decouple_loss:0.0013735397951677442
Iteration: 684, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44889259338378906, gen p mean: -0.04179270938038826, mean p set: 0.44937291741371155
loss_pred:0.013756252825260162, decouple_loss:0.0014305012300610542
The modified gen p mean: 0.4472711682319641, gen p mean: -0.048970576375722885, mean p set: 0.4477514624595642The modified gen p mean: 0.44724029302597046, gen p mean: -0.049206022173166275, mean p set: 0.44772061705589294
loss_pred:0.013203473761677742, decouple_loss:0.0014572086511179805
loss_pred:0.013644084334373474, decouple_loss:0.0015254032332450151
Iteration: 685, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4462844133377075, gen p mean: -0.04557211324572563, mean p set: 0.44676467776298523
loss_pred:0.013510089367628098, decouple_loss:0.0014340978814288974
The modified gen p mean: 0.44691383838653564, gen p mean: -0.045560017228126526, mean p set: 0.44739410281181335The modified gen p mean: 0.44708651304244995, gen p mean: -0.05451834946870804, mean p set: 0.44756677746772766
loss_pred:0.014113221317529678, decouple_loss:0.001442032284103334
loss_pred:0.013479952700436115, decouple_loss:0.0015013008378446102
Iteration: 686, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448162704706192, gen p mean: -0.041226573288440704, mean p set: 0.4486429989337921
loss_pred:0.013855607248842716, decouple_loss:0.0013868219684809446
The modified gen p mean: 0.44681644439697266, gen p mean: -0.05210518091917038, mean p set: 0.44729676842689514The modified gen p mean: 0.44779103994369507, gen p mean: -0.05378611758351326, mean p set: 0.44827136397361755
loss_pred:0.013616339303553104, decouple_loss:0.0013978990027680993
loss_pred:0.013247905299067497, decouple_loss:0.0014431108720600605
Iteration: 687, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480471909046173, gen p mean: -0.050639789551496506, mean p set: 0.4485274851322174
loss_pred:0.013551284559071064, decouple_loss:0.0014557299437001348
The modified gen p mean: 0.44711393117904663, gen p mean: -0.05283733084797859, mean p set: 0.44759422540664673The modified gen p mean: 0.44627127051353455, gen p mean: -0.04515474662184715, mean p set: 0.44675159454345703
loss_pred:0.01373347733169794, decouple_loss:0.0015131960390135646
loss_pred:0.013111899606883526, decouple_loss:0.0014111528871580958
Iteration: 688, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44629597663879395, gen p mean: -0.05150437727570534, mean p set: 0.44677630066871643
loss_pred:0.013628542423248291, decouple_loss:0.0013641023542732
The modified gen p mean: 0.4489162862300873, gen p mean: -0.04649270698428154, mean p set: 0.4493965804576874The modified gen p mean: 0.4470941126346588, gen p mean: -0.04800437390804291, mean p set: 0.4475743770599365
loss_pred:0.013314465992152691, decouple_loss:0.0013685778249055147
loss_pred:0.01379815861582756, decouple_loss:0.0014414209872484207
Iteration: 689, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472111463546753, gen p mean: -0.051769789308309555, mean p set: 0.4476914703845978
loss_pred:0.013346454128623009, decouple_loss:0.0013723383890464902
The modified gen p mean: 0.4467791020870209, gen p mean: -0.05460469424724579, mean p set: 0.44725939631462097The modified gen p mean: 0.4474667012691498, gen p mean: -0.053138021379709244, mean p set: 0.4479469656944275
loss_pred:0.013248643837869167, decouple_loss:0.001449062954634428
loss_pred:0.013035062700510025, decouple_loss:0.0014780432684347034
Iteration: 690, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44717198610305786, gen p mean: -0.053735654801130295, mean p set: 0.44765228033065796
loss_pred:0.013258250430226326, decouple_loss:0.0014086539158597589
The modified gen p mean: 0.44776859879493713, gen p mean: -0.05579153448343277, mean p set: 0.44824886322021484The modified gen p mean: 0.44784653186798096, gen p mean: -0.04904975742101669, mean p set: 0.44832685589790344
loss_pred:0.013061681762337685, decouple_loss:0.0014495343202725053
loss_pred:0.013066812418401241, decouple_loss:0.0013703814474865794
2023-05-01 00:59:39 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.051104336977005005, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04635177552700043, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.047033075243234634, mean p set: 0.4500633478164673
loss_pred:0.01936551369726658, decouple_loss:0.0014425507979467511
loss_pred:0.018234461545944214, decouple_loss:0.001492430455982685
loss_pred:0.018343163654208183, decouple_loss:0.0015238694613799453
WV_0_PC_1_EH_0_PS_40, loss: 0.01872202754020691, avg_mse: 0.027274347841739655
current test mse: 0.027274
Iteration: 691, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44876283407211304, gen p mean: -0.03794446960091591, mean p set: 0.44924309849739075
The modified gen p mean: 0.4469245970249176, gen p mean: -0.046584513038396835, mean p set: 0.4474049210548401
The modified gen p mean: 0.4478999376296997, gen p mean: -0.042196549475193024, mean p set: 0.4483802020549774
loss_pred:0.013258377090096474, decouple_loss:0.0013943534577265382
loss_pred:0.013797365128993988, decouple_loss:0.0013679924886673689
loss_pred:0.013305575586855412, decouple_loss:0.0013389348750934005
Iteration: 692, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44788146018981934, gen p mean: -0.047600384801626205, mean p set: 0.44836175441741943
loss_pred:0.013110609725117683, decouple_loss:0.001401666086167097
The modified gen p mean: 0.4473112225532532, gen p mean: -0.043345339596271515, mean p set: 0.44779151678085327The modified gen p mean: 0.44744673371315, gen p mean: -0.04368450120091438, mean p set: 0.4479270875453949
loss_pred:0.012843851931393147, decouple_loss:0.0013699005357921124
loss_pred:0.013212788850069046, decouple_loss:0.0014316588640213013
Iteration: 693, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468412697315216, gen p mean: -0.045474112033843994, mean p set: 0.4473215639591217
loss_pred:0.013288656249642372, decouple_loss:0.0013131487648934126
The modified gen p mean: 0.44763094186782837, gen p mean: -0.039395708590745926, mean p set: 0.4481112062931061The modified gen p mean: 0.4469221234321594, gen p mean: -0.0400594063103199, mean p set: 0.4474024176597595
loss_pred:0.013185395859181881, decouple_loss:0.0013021467020735145
loss_pred:0.013502789661288261, decouple_loss:0.0014034119667485356
Iteration: 694, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482991695404053, gen p mean: -0.03601597249507904, mean p set: 0.44877946376800537
loss_pred:0.012888653203845024, decouple_loss:0.0014259755844250321
The modified gen p mean: 0.44747141003608704, gen p mean: -0.04380202293395996, mean p set: 0.44795170426368713The modified gen p mean: 0.44708889722824097, gen p mean: -0.03747132420539856, mean p set: 0.44756919145584106
loss_pred:0.013163762167096138, decouple_loss:0.0014499822864308953
loss_pred:0.01357914786785841, decouple_loss:0.0014025099808350205
Iteration: 695, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478975832462311, gen p mean: -0.037368517369031906, mean p set: 0.4483778774738312
loss_pred:0.01343590673059225, decouple_loss:0.0012588659301400185
The modified gen p mean: 0.44799885153770447, gen p mean: -0.04574843496084213, mean p set: 0.4484791159629822
The modified gen p mean: 0.4474093019962311, gen p mean: -0.039712175726890564, mean p set: 0.4478895962238312
loss_pred:0.012698260135948658, decouple_loss:0.0012890707002952695
loss_pred:0.013147559016942978, decouple_loss:0.0013242991408333182
Iteration: 696, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465221166610718, gen p mean: -0.049221426248550415, mean p set: 0.44700247049331665
loss_pred:0.013190118595957756, decouple_loss:0.0014650902012363076
The modified gen p mean: 0.448482483625412, gen p mean: -0.04706556722521782, mean p set: 0.4489628076553345The modified gen p mean: 0.446719229221344, gen p mean: -0.04956025257706642, mean p set: 0.4471994936466217
loss_pred:0.013292979449033737, decouple_loss:0.001489930902607739
loss_pred:0.013307684101164341, decouple_loss:0.0013327626511454582
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012007_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012007_3_24hr.npz
NaN value num: 0
Iteration: 697, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486050605773926, gen p mean: -0.045247633010149, mean p set: 0.4490853548049927
loss_pred:0.017631037160754204, decouple_loss:0.0013941331999376416
The modified gen p mean: 0.4501855969429016, gen p mean: -0.039221636950969696, mean p set: 0.4506658911705017The modified gen p mean: 0.4494897723197937, gen p mean: -0.042566362768411636, mean p set: 0.4499700367450714
loss_pred:0.018055010586977005, decouple_loss:0.0014442258980125189
loss_pred:0.01762181892991066, decouple_loss:0.0013915009330958128
Iteration: 698, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492669999599457, gen p mean: -0.04579458758234978, mean p set: 0.4497472941875458
loss_pred:0.01719575747847557, decouple_loss:0.0013448981335386634
The modified gen p mean: 0.45088979601860046, gen p mean: -0.041180405765771866, mean p set: 0.45137009024620056The modified gen p mean: 0.4487535059452057, gen p mean: -0.04805709794163704, mean p set: 0.4492338001728058
loss_pred:0.01751103810966015, decouple_loss:0.0014337303582578897
loss_pred:0.015885258093476295, decouple_loss:0.0014858796494081616
Iteration: 699, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44930654764175415, gen p mean: -0.045484308153390884, mean p set: 0.44978684186935425
loss_pred:0.01704780012369156, decouple_loss:0.0014587710611522198
The modified gen p mean: 0.44907504320144653, gen p mean: -0.039370208978652954, mean p set: 0.44955530762672424The modified gen p mean: 0.4500577747821808, gen p mean: -0.03981030732393265, mean p set: 0.4505380690097809
loss_pred:0.016910571604967117, decouple_loss:0.0013816453283652663
loss_pred:0.017015816643834114, decouple_loss:0.001348511315882206
Iteration: 700, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44888585805892944, gen p mean: -0.04582386836409569, mean p set: 0.44936615228652954
loss_pred:0.016925640404224396, decouple_loss:0.0013545284746214747
The modified gen p mean: 0.45045509934425354, gen p mean: -0.04187048599123955, mean p set: 0.45093539357185364The modified gen p mean: 0.44851192831993103, gen p mean: -0.04121101647615433, mean p set: 0.44899222254753113
loss_pred:0.018051249906420708, decouple_loss:0.0013620131649076939
loss_pred:0.01611443981528282, decouple_loss:0.0013586818240582943
2023-05-01 01:02:15 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.04802882671356201, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04345029965043068, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.044082701206207275, mean p set: 0.4500633478164673
loss_pred:0.018636874854564667, decouple_loss:0.001459965598769486
loss_pred:0.017597651109099388, decouple_loss:0.0014518412062898278
loss_pred:0.01769394800066948, decouple_loss:0.0014411995653063059
WV_0_PC_1_EH_0_PS_40, loss: 0.018048709258437157, avg_mse: 0.025946246460080147
current test mse: 0.025946
Iteration: 701, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501960873603821, gen p mean: -0.0407743826508522, mean p set: 0.4506763517856598
The modified gen p mean: 0.4483919143676758, gen p mean: -0.037968896329402924, mean p set: 0.4488722085952759
The modified gen p mean: 0.4493371844291687, gen p mean: -0.04158905893564224, mean p set: 0.4498175084590912
loss_pred:0.01741325668990612, decouple_loss:0.0015289434231817722
loss_pred:0.017240755259990692, decouple_loss:0.0014604023890569806
loss_pred:0.017117928713560104, decouple_loss:0.001451484626159072
Iteration: 702, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497455358505249, gen p mean: -0.04009580612182617, mean p set: 0.450225830078125
loss_pred:0.018361771479249, decouple_loss:0.001318747061304748
The modified gen p mean: 0.4502352178096771, gen p mean: -0.03468003496527672, mean p set: 0.4507155418395996The modified gen p mean: 0.4491819441318512, gen p mean: -0.042235732078552246, mean p set: 0.4496622681617737
loss_pred:0.01632264256477356, decouple_loss:0.0013128322316333652
loss_pred:0.01700257696211338, decouple_loss:0.001282056444324553
Iteration: 703, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504282474517822, gen p mean: -0.03319737687706947, mean p set: 0.4509085714817047
loss_pred:0.017020734027028084, decouple_loss:0.001487153465859592
The modified gen p mean: 0.44951069355010986, gen p mean: -0.038950417190790176, mean p set: 0.44999101758003235The modified gen p mean: 0.4483434557914734, gen p mean: -0.037890903651714325, mean p set: 0.4488237500190735
loss_pred:0.01702689938247204, decouple_loss:0.0013920917408540845
loss_pred:0.017477920278906822, decouple_loss:0.0013455726439133286
Iteration: 704, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500592350959778, gen p mean: -0.04029494524002075, mean p set: 0.4505395293235779
loss_pred:0.017855582758784294, decouple_loss:0.0012718845391646028
The modified gen p mean: 0.44946929812431335, gen p mean: -0.0352223739027977, mean p set: 0.44994959235191345The modified gen p mean: 0.4479636251926422, gen p mean: -0.04183049499988556, mean p set: 0.4484439492225647
loss_pred:0.01676933653652668, decouple_loss:0.001184471882879734
loss_pred:0.01711895875632763, decouple_loss:0.0012761824764311314
Iteration: 705, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45050185918807983, gen p mean: -0.03374191373586655, mean p set: 0.45098215341567993
loss_pred:0.017720848321914673, decouple_loss:0.00130602833814919
The modified gen p mean: 0.4476589858531952, gen p mean: -0.03921839967370033, mean p set: 0.4481392800807953The modified gen p mean: 0.44873544573783875, gen p mean: -0.039694894105196, mean p set: 0.44921573996543884
loss_pred:0.01653033122420311, decouple_loss:0.0012916270643472672
loss_pred:0.016248919069767, decouple_loss:0.001331682549789548
Iteration: 706, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44836515188217163, gen p mean: -0.04238610342144966, mean p set: 0.4488454759120941
loss_pred:0.017052145674824715, decouple_loss:0.0011894736671820283
The modified gen p mean: 0.449098140001297, gen p mean: -0.04130816459655762, mean p set: 0.4495784640312195The modified gen p mean: 0.44839420914649963, gen p mean: -0.04077116772532463, mean p set: 0.44887450337409973
loss_pred:0.017133232206106186, decouple_loss:0.0012219297932460904
loss_pred:0.0162583589553833, decouple_loss:0.0011888963636010885
Iteration: 707, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45119160413742065, gen p mean: -0.0412767268717289, mean p set: 0.45167189836502075
loss_pred:0.0159476175904274, decouple_loss:0.0011688945814967155
The modified gen p mean: 0.44935426115989685, gen p mean: -0.04076998308300972, mean p set: 0.44983452558517456The modified gen p mean: 0.44841963052749634, gen p mean: -0.042977508157491684, mean p set: 0.44889989495277405
loss_pred:0.017052190378308296, decouple_loss:0.0011768981348723173
loss_pred:0.016862664371728897, decouple_loss:0.0011590960202738643
Iteration: 708, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45000436902046204, gen p mean: -0.04198895022273064, mean p set: 0.45048466324806213
loss_pred:0.01687026210129261, decouple_loss:0.001328680315054953
The modified gen p mean: 0.4489797353744507, gen p mean: -0.041269365698099136, mean p set: 0.4494599997997284The modified gen p mean: 0.4487841725349426, gen p mean: -0.04262643679976463, mean p set: 0.4492644667625427
loss_pred:0.01699976995587349, decouple_loss:0.0012997742742300034
loss_pred:0.016747739166021347, decouple_loss:0.0012648800620809197
Iteration: 709, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44951286911964417, gen p mean: -0.041907332837581635, mean p set: 0.44999319314956665
loss_pred:0.016752496361732483, decouple_loss:0.001195338787510991
The modified gen p mean: 0.45016512274742126, gen p mean: -0.04093208163976669, mean p set: 0.45064541697502136The modified gen p mean: 0.44986724853515625, gen p mean: -0.03934736177325249, mean p set: 0.45034751296043396
loss_pred:0.01695016771554947, decouple_loss:0.0012308021541684866
loss_pred:0.01769891194999218, decouple_loss:0.0012729908339679241
Iteration: 710, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44936704635620117, gen p mean: -0.04927491396665573, mean p set: 0.44984734058380127
loss_pred:0.01726279780268669, decouple_loss:0.0012972988188266754
The modified gen p mean: 0.4500219225883484, gen p mean: -0.0384843684732914, mean p set: 0.4505022168159485
The modified gen p mean: 0.4488302171230316, gen p mean: -0.046397801488637924, mean p set: 0.4493105113506317
loss_pred:0.017241666093468666, decouple_loss:0.0012636944884434342
loss_pred:0.017027029767632484, decouple_loss:0.0012337688822299242
2023-05-01 01:04:08 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.052385393530130386, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04783497750759125, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.04824609309434891, mean p set: 0.4500633478164673
loss_pred:0.01848241314291954, decouple_loss:0.0014334549196064472
loss_pred:0.017419658601284027, decouple_loss:0.0013052301947027445
loss_pred:0.017472080886363983, decouple_loss:0.0012774462811648846
WV_0_PC_1_EH_0_PS_40, loss: 0.017858318984508514, avg_mse: 0.02558932825922966
current test mse: 0.025589
Iteration: 711, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448661208152771, gen p mean: -0.040480803698301315, mean p set: 0.4491414725780487
The modified gen p mean: 0.44812923669815063, gen p mean: -0.04197098687291145, mean p set: 0.44860953092575073
The modified gen p mean: 0.45073336362838745, gen p mean: -0.042110029608011246, mean p set: 0.45121368765830994
loss_pred:0.015605645254254341, decouple_loss:0.0012686793925240636
loss_pred:0.017102638259530067, decouple_loss:0.0012046744814142585
loss_pred:0.01628212258219719, decouple_loss:0.0013635505456477404
Iteration: 712, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492523670196533, gen p mean: -0.04688664898276329, mean p set: 0.4497326612472534
loss_pred:0.017691290006041527, decouple_loss:0.0014571474166586995
The modified gen p mean: 0.44945529103279114, gen p mean: -0.039517320692539215, mean p set: 0.4499356150627136The modified gen p mean: 0.44813019037246704, gen p mean: -0.046396005898714066, mean p set: 0.44861045479774475
loss_pred:0.01662265509366989, decouple_loss:0.0013170948950573802
loss_pred:0.01688583754003048, decouple_loss:0.0012331005418673158
Iteration: 713, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449989914894104, gen p mean: -0.04074585437774658, mean p set: 0.4504702091217041
loss_pred:0.016909301280975342, decouple_loss:0.0012395039666444063
The modified gen p mean: 0.44828465580940247, gen p mean: -0.04323124140501022, mean p set: 0.44876495003700256The modified gen p mean: 0.4504678249359131, gen p mean: -0.039002545177936554, mean p set: 0.4509481191635132
loss_pred:0.01724882982671261, decouple_loss:0.0011583598097786307
loss_pred:0.016750575974583626, decouple_loss:0.0011395725887268782
Iteration: 714, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45030295848846436, gen p mean: -0.0413736067712307, mean p set: 0.45078325271606445
loss_pred:0.01694338209927082, decouple_loss:0.0014672529650852084
The modified gen p mean: 0.4485502243041992, gen p mean: -0.047183603048324585, mean p set: 0.44903048872947693The modified gen p mean: 0.44732365012168884, gen p mean: -0.0380515530705452, mean p set: 0.44780394434928894
loss_pred:0.01689641736447811, decouple_loss:0.0014921966940164566
loss_pred:0.01653089001774788, decouple_loss:0.0015822978457435966
Iteration: 715, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501005709171295, gen p mean: -0.038381870836019516, mean p set: 0.4505808651447296
loss_pred:0.01687263511121273, decouple_loss:0.0012870284263044596
The modified gen p mean: 0.44856712222099304, gen p mean: -0.03913065418601036, mean p set: 0.44904738664627075The modified gen p mean: 0.45038244128227234, gen p mean: -0.04177829250693321, mean p set: 0.45086273550987244
loss_pred:0.017021875828504562, decouple_loss:0.0012444347376003861
loss_pred:0.017258642241358757, decouple_loss:0.001267382176592946
Iteration: 716, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450958251953125, gen p mean: -0.04188554361462593, mean p set: 0.4514385461807251
loss_pred:0.017499035224318504, decouple_loss:0.0014942939160391688
The modified gen p mean: 0.44779273867607117, gen p mean: -0.03901853412389755, mean p set: 0.44827306270599365The modified gen p mean: 0.448742538690567, gen p mean: -0.04075975343585014, mean p set: 0.4492228329181671
loss_pred:0.01657349243760109, decouple_loss:0.0014783622464165092
loss_pred:0.017007501795887947, decouple_loss:0.0015526977367699146
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012004_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012004_3_24hr.npz
NaN value num: 0
Iteration: 717, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44580167531967163, gen p mean: -0.04572327435016632, mean p set: 0.44628193974494934
loss_pred:0.017494412139058113, decouple_loss:0.0013442926574498415
The modified gen p mean: 0.4467996656894684, gen p mean: -0.04907769337296486, mean p set: 0.44727998971939087The modified gen p mean: 0.4499937891960144, gen p mean: -0.05044863745570183, mean p set: 0.4504740536212921
loss_pred:0.01842552050948143, decouple_loss:0.0013308447087183595
loss_pred:0.016888730227947235, decouple_loss:0.0012456156546249986
Iteration: 718, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44793251156806946, gen p mean: -0.044033877551555634, mean p set: 0.44841283559799194
loss_pred:0.018235309049487114, decouple_loss:0.0015629621921107173
The modified gen p mean: 0.4457978904247284, gen p mean: -0.04778188839554787, mean p set: 0.4462781846523285The modified gen p mean: 0.4476347863674164, gen p mean: -0.04667816683650017, mean p set: 0.44811511039733887
loss_pred:0.018269352614879608, decouple_loss:0.0014927461743354797
loss_pred:0.018992215394973755, decouple_loss:0.0014983706641942263
Iteration: 719, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464915096759796, gen p mean: -0.04883873462677002, mean p set: 0.4469718039035797
loss_pred:0.01746242493391037, decouple_loss:0.0014757891185581684
The modified gen p mean: 0.4444916844367981, gen p mean: -0.0506226122379303, mean p set: 0.4449720084667206The modified gen p mean: 0.449760377407074, gen p mean: -0.048168033361434937, mean p set: 0.4502406716346741
loss_pred:0.017992017790675163, decouple_loss:0.0014634233666583896
loss_pred:0.017153333872556686, decouple_loss:0.0014719299506396055
Iteration: 720, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483136534690857, gen p mean: -0.0545303151011467, mean p set: 0.4487939476966858
loss_pred:0.018057720735669136, decouple_loss:0.0013288783375173807
The modified gen p mean: 0.44816797971725464, gen p mean: -0.05089149251580238, mean p set: 0.4486483037471771The modified gen p mean: 0.4452667832374573, gen p mean: -0.05557841435074806, mean p set: 0.4457470774650574
loss_pred:0.018635110929608345, decouple_loss:0.001353011466562748
loss_pred:0.017172249034047127, decouple_loss:0.0013258381513878703
2023-05-01 01:06:40 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.055144988000392914, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.05040305107831955, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.05083330348134041, mean p set: 0.4500633478164673
loss_pred:0.018388835713267326, decouple_loss:0.0013275815872475505
loss_pred:0.017306648194789886, decouple_loss:0.0013906400417909026
loss_pred:0.01738777570426464, decouple_loss:0.0012955166166648269
WV_0_PC_1_EH_0_PS_40, loss: 0.017761316150426865, avg_mse: 0.02542893774807453
current test mse: 0.025429
At step 720, Best test: 0.025429
save model to /work/09012/haoli1/ls6/ERA5_PredRNN/checkpoints/WV_0_PC_1_EH_0_PS_40/model_model_test_schedule_sampling_DynaMean.ckpt
Iteration: 721, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44656050205230713, gen p mean: -0.050963059067726135, mean p set: 0.4470408260822296
loss_pred:0.01722346991300583, decouple_loss:0.0014903093688189983
The modified gen p mean: 0.44594669342041016, gen p mean: -0.06047565117478371, mean p set: 0.44642698764801025The modified gen p mean: 0.4470677375793457, gen p mean: -0.05533131584525108, mean p set: 0.4475480318069458
loss_pred:0.017308905720710754, decouple_loss:0.001391301047988236loss_pred:0.017726508900523186, decouple_loss:0.0013567254645749927
Iteration: 722, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503893554210663, gen p mean: -0.060711976140737534, mean p set: 0.450869619846344
loss_pred:0.01639963500201702, decouple_loss:0.001356493099592626
The modified gen p mean: 0.4495728015899658, gen p mean: -0.062348950654268265, mean p set: 0.4500530958175659The modified gen p mean: 0.448137491941452, gen p mean: -0.052890557795763016, mean p set: 0.4486178159713745
loss_pred:0.01633124053478241, decouple_loss:0.001301864511333406
loss_pred:0.01853879727423191, decouple_loss:0.001310847932472825
Iteration: 723, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.444752037525177, gen p mean: -0.0594341903924942, mean p set: 0.4452323615550995
loss_pred:0.01694021187722683, decouple_loss:0.0012250110739842057
The modified gen p mean: 0.44419872760772705, gen p mean: -0.06061512604355812, mean p set: 0.44467902183532715The modified gen p mean: 0.4467149078845978, gen p mean: -0.056117478758096695, mean p set: 0.4471952021121979
loss_pred:0.01801312156021595, decouple_loss:0.0012649957789108157
loss_pred:0.01711391471326351, decouple_loss:0.0012286996934562922
Iteration: 724, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44685015082359314, gen p mean: -0.05825011432170868, mean p set: 0.4473304748535156
loss_pred:0.017600812017917633, decouple_loss:0.00121832184959203
The modified gen p mean: 0.44864141941070557, gen p mean: -0.06069834530353546, mean p set: 0.44912174344062805The modified gen p mean: 0.44702309370040894, gen p mean: -0.05770672857761383, mean p set: 0.44750338792800903
loss_pred:0.017672978341579437, decouple_loss:0.0013511519646272063
loss_pred:0.017339611425995827, decouple_loss:0.0013017861638218164
Iteration: 725, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448302686214447, gen p mean: -0.06002206355333328, mean p set: 0.4487829804420471
loss_pred:0.01712854765355587, decouple_loss:0.0011789536802098155
The modified gen p mean: 0.4480220079421997, gen p mean: -0.05786847323179245, mean p set: 0.4485023021697998The modified gen p mean: 0.44610947370529175, gen p mean: -0.0575503334403038, mean p set: 0.44658976793289185
loss_pred:0.017161397263407707, decouple_loss:0.0012341650435701013
loss_pred:0.018206259235739708, decouple_loss:0.0012292086612433195
Iteration: 726, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469650089740753, gen p mean: -0.060095205903053284, mean p set: 0.4474453032016754
loss_pred:0.01722130924463272, decouple_loss:0.0012515840353444219
The modified gen p mean: 0.44722214341163635, gen p mean: -0.05794253200292587, mean p set: 0.44770243763923645The modified gen p mean: 0.44548359513282776, gen p mean: -0.061390459537506104, mean p set: 0.4459638297557831
loss_pred:0.017951611429452896, decouple_loss:0.0012188591063022614
loss_pred:0.017549673095345497, decouple_loss:0.0012695585610345006
Iteration: 727, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480065107345581, gen p mean: -0.05457243323326111, mean p set: 0.4484868049621582
loss_pred:0.018990881741046906, decouple_loss:0.0012986506335437298
The modified gen p mean: 0.44663774967193604, gen p mean: -0.06276042759418488, mean p set: 0.44711804389953613The modified gen p mean: 0.4492722451686859, gen p mean: -0.060200925916433334, mean p set: 0.449752539396286
loss_pred:0.017330080270767212, decouple_loss:0.0011999254347756505
loss_pred:0.016837695613503456, decouple_loss:0.0011657264549285173
Iteration: 728, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44853469729423523, gen p mean: -0.05234742909669876, mean p set: 0.4490150213241577
loss_pred:0.018649613484740257, decouple_loss:0.0013186661526560783
The modified gen p mean: 0.448622465133667, gen p mean: -0.05453598126769066, mean p set: 0.4491027295589447The modified gen p mean: 0.44529515504837036, gen p mean: -0.05662762001156807, mean p set: 0.44577544927597046
loss_pred:0.01753201149404049, decouple_loss:0.0011760271154344082
loss_pred:0.017006443813443184, decouple_loss:0.0011929050087928772
Iteration: 729, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44638708233833313, gen p mean: -0.056006111204624176, mean p set: 0.4468673765659332
loss_pred:0.017777757719159126, decouple_loss:0.0013230894692242146
The modified gen p mean: 0.4473022222518921, gen p mean: -0.05058865249156952, mean p set: 0.4477825164794922The modified gen p mean: 0.44679737091064453, gen p mean: -0.05607344210147858, mean p set: 0.447277694940567
loss_pred:0.01755196787416935, decouple_loss:0.0012847381876781583
loss_pred:0.018048156052827835, decouple_loss:0.0013295963872224092
Iteration: 730, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44836103916168213, gen p mean: -0.06049085408449173, mean p set: 0.4488413631916046
loss_pred:0.017784373834729195, decouple_loss:0.0013662837445735931
The modified gen p mean: 0.4467070400714874, gen p mean: -0.06362797319889069, mean p set: 0.44718730449676514The modified gen p mean: 0.4475797116756439, gen p mean: -0.054794274270534515, mean p set: 0.4480600357055664
loss_pred:0.018629206344485283, decouple_loss:0.0011994807282462716
loss_pred:0.017282472923398018, decouple_loss:0.001110493903979659
2023-05-01 01:08:38 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.05567716807126999, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.050130415707826614, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.051235850900411606, mean p set: 0.4500633478164673
loss_pred:0.0184039156883955, decouple_loss:0.00115971639752388
loss_pred:0.01738589257001877, decouple_loss:0.0012167032109573483
loss_pred:0.017425183206796646, decouple_loss:0.0012532038381323218
WV_0_PC_1_EH_0_PS_40, loss: 0.017798826098442078, avg_mse: 0.025540897622704506
current test mse: 0.025541
Iteration: 731, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472947120666504, gen p mean: -0.05531619116663933, mean p set: 0.4477749764919281
The modified gen p mean: 0.4479103982448578, gen p mean: -0.05286315828561783, mean p set: 0.4483906924724579
The modified gen p mean: 0.44583219289779663, gen p mean: -0.0550115741789341, mean p set: 0.4463125169277191
loss_pred:0.01756170019507408, decouple_loss:0.001264242921024561
loss_pred:0.018452517688274384, decouple_loss:0.0011623563477769494
loss_pred:0.0179732795804739, decouple_loss:0.001207777764648199
Iteration: 732, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481664299964905, gen p mean: -0.05858783423900604, mean p set: 0.4486467242240906
loss_pred:0.017482925206422806, decouple_loss:0.0013710069470107555
The modified gen p mean: 0.44587600231170654, gen p mean: -0.05007113516330719, mean p set: 0.44635626673698425The modified gen p mean: 0.4465527832508087, gen p mean: -0.05290118604898453, mean p set: 0.4470330774784088
loss_pred:0.016995221376419067, decouple_loss:0.0012132312403991818
loss_pred:0.016711970791220665, decouple_loss:0.0011831291485577822
Iteration: 733, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44626855850219727, gen p mean: -0.05619088560342789, mean p set: 0.44674885272979736
loss_pred:0.017211727797985077, decouple_loss:0.0011283174389973283
The modified gen p mean: 0.4471827447414398, gen p mean: -0.05379794165492058, mean p set: 0.4476630687713623The modified gen p mean: 0.44767454266548157, gen p mean: -0.05519942194223404, mean p set: 0.44815483689308167
loss_pred:0.01705714873969555, decouple_loss:0.0011407829588279128
loss_pred:0.01763998717069626, decouple_loss:0.001318129594437778
Iteration: 734, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492434859275818, gen p mean: -0.05561358854174614, mean p set: 0.4497237801551819
loss_pred:0.017163842916488647, decouple_loss:0.001078976085409522
The modified gen p mean: 0.44514530897140503, gen p mean: -0.05882447585463524, mean p set: 0.4456256330013275The modified gen p mean: 0.4476396441459656, gen p mean: -0.05479418858885765, mean p set: 0.4481199383735657
loss_pred:0.017618423327803612, decouple_loss:0.001159684150479734
loss_pred:0.017384665086865425, decouple_loss:0.001193856238387525
Iteration: 735, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44909387826919556, gen p mean: -0.05940204858779907, mean p set: 0.44957417249679565
loss_pred:0.016125068068504333, decouple_loss:0.0012607852695509791
The modified gen p mean: 0.44611889123916626, gen p mean: -0.056536801159381866, mean p set: 0.44659915566444397The modified gen p mean: 0.4474874436855316, gen p mean: -0.052662499248981476, mean p set: 0.4479677379131317
loss_pred:0.018173793330788612, decouple_loss:0.0011325684608891606
loss_pred:0.017419811338186264, decouple_loss:0.0011257472215220332
Iteration: 736, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44540053606033325, gen p mean: -0.057145338505506516, mean p set: 0.44588083028793335
loss_pred:0.017111454159021378, decouple_loss:0.000983139150775969
The modified gen p mean: 0.4476720690727234, gen p mean: -0.051935892552137375, mean p set: 0.4481523334980011The modified gen p mean: 0.4475308656692505, gen p mean: -0.05469074100255966, mean p set: 0.4480111598968506
loss_pred:0.017565710470080376, decouple_loss:0.0009907353669404984
loss_pred:0.01804875023663044, decouple_loss:0.0010220743715763092
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012002_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012002_3_24hr.npz
NaN value num: 0
Iteration: 737, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487651586532593, gen p mean: -0.05565682798624039, mean p set: 0.4492454528808594
loss_pred:0.01770131103694439, decouple_loss:0.0013608240988105536
The modified gen p mean: 0.4469551742076874, gen p mean: -0.0527195930480957, mean p set: 0.44743549823760986The modified gen p mean: 0.4477980136871338, gen p mean: -0.05486456677317619, mean p set: 0.4482783079147339
loss_pred:0.01721535250544548, decouple_loss:0.0012591414852067828
loss_pred:0.017988400533795357, decouple_loss:0.0012519484153017402
Iteration: 738, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44563642144203186, gen p mean: -0.05086948350071907, mean p set: 0.44611674547195435
loss_pred:0.01712164469063282, decouple_loss:0.0012215686729177833
The modified gen p mean: 0.44678986072540283, gen p mean: -0.05086062476038933, mean p set: 0.44727015495300293The modified gen p mean: 0.4473472535610199, gen p mean: -0.054835282266139984, mean p set: 0.4478275179862976
loss_pred:0.017421623691916466, decouple_loss:0.0010722745209932327
loss_pred:0.017438450828194618, decouple_loss:0.0010458878241479397
Iteration: 739, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44721418619155884, gen p mean: -0.05335844308137894, mean p set: 0.44769448041915894
loss_pred:0.017363516613841057, decouple_loss:0.0010654740035533905
The modified gen p mean: 0.44877082109451294, gen p mean: -0.052992820739746094, mean p set: 0.44925111532211304The modified gen p mean: 0.44681331515312195, gen p mean: -0.05244823545217514, mean p set: 0.44729360938072205
loss_pred:0.017448069527745247, decouple_loss:0.0010361522436141968
loss_pred:0.017231062054634094, decouple_loss:0.0011337745236232877
Iteration: 740, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4457029104232788, gen p mean: -0.04956457391381264, mean p set: 0.4461832046508789
loss_pred:0.01721864379942417, decouple_loss:0.0011360306525602937
The modified gen p mean: 0.44711974263191223, gen p mean: -0.052004989236593246, mean p set: 0.44760003685951233The modified gen p mean: 0.4467082917690277, gen p mean: -0.04771143198013306, mean p set: 0.4471885859966278
loss_pred:0.017279282212257385, decouple_loss:0.0010452914284542203
loss_pred:0.01750982739031315, decouple_loss:0.001154174911789596
2023-05-01 01:11:12 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.051357537508010864, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.046012572944164276, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04699696600437164, mean p set: 0.4500633478164673
loss_pred:0.01838754676282406, decouple_loss:0.0010366789065301418
loss_pred:0.017348922789096832, decouple_loss:0.0010210919426754117
loss_pred:0.017483152449131012, decouple_loss:0.0010128208668902516
WV_0_PC_1_EH_0_PS_40, loss: 0.017791051417589188, avg_mse: 0.02553536184132099
current test mse: 0.025535
Iteration: 741, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44690144062042236, gen p mean: -0.04833686351776123, mean p set: 0.44738173484802246
The modified gen p mean: 0.446042537689209, gen p mean: -0.05113700404763222, mean p set: 0.44652286171913147
The modified gen p mean: 0.4471961259841919, gen p mean: -0.05249294266104698, mean p set: 0.447676420211792
loss_pred:0.018156634643673897, decouple_loss:0.0011441208189353347
loss_pred:0.017809787765145302, decouple_loss:0.0010703164152801037
loss_pred:0.017477598041296005, decouple_loss:0.0010612464975565672
Iteration: 742, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4461938142776489, gen p mean: -0.045339185744524, mean p set: 0.446674108505249
loss_pred:0.017053376883268356, decouple_loss:0.001061747083440423
The modified gen p mean: 0.4496762156486511, gen p mean: -0.04690428823232651, mean p set: 0.4501565396785736The modified gen p mean: 0.4461633265018463, gen p mean: -0.04730825498700142, mean p set: 0.446643590927124
loss_pred:0.01711176335811615, decouple_loss:0.0010692746145650744
loss_pred:0.01713179238140583, decouple_loss:0.0010795084526762366
Iteration: 743, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44580021500587463, gen p mean: -0.04718751087784767, mean p set: 0.44628050923347473
loss_pred:0.017147036269307137, decouple_loss:0.000942879356443882
The modified gen p mean: 0.4470807909965515, gen p mean: -0.04494350403547287, mean p set: 0.4475610554218292The modified gen p mean: 0.4463620185852051, gen p mean: -0.042781416326761246, mean p set: 0.4468423128128052
loss_pred:0.0172106996178627, decouple_loss:0.0010888783726841211
loss_pred:0.01734219305217266, decouple_loss:0.0009745546267367899
Iteration: 744, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44767042994499207, gen p mean: -0.045586924999952316, mean p set: 0.44815075397491455
loss_pred:0.017062894999980927, decouple_loss:0.0011785018723458052
The modified gen p mean: 0.44906169176101685, gen p mean: -0.04475706070661545, mean p set: 0.44954198598861694The modified gen p mean: 0.44606515765190125, gen p mean: -0.0403573103249073, mean p set: 0.44654545187950134
loss_pred:0.01763693057000637, decouple_loss:0.0012353156926110387
loss_pred:0.017987487837672234, decouple_loss:0.0011019314406439662
Iteration: 745, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4459373950958252, gen p mean: -0.03982767090201378, mean p set: 0.4464176893234253
loss_pred:0.016960132867097855, decouple_loss:0.00104039185680449
The modified gen p mean: 0.44694700837135315, gen p mean: -0.04046532139182091, mean p set: 0.44742733240127563The modified gen p mean: 0.44659224152565, gen p mean: -0.04014405235648155, mean p set: 0.4470725357532501
loss_pred:0.018137993291020393, decouple_loss:0.001034793327562511
loss_pred:0.017536500468850136, decouple_loss:0.0010448434622958302
Iteration: 746, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44848328828811646, gen p mean: -0.042013008147478104, mean p set: 0.44896358251571655
loss_pred:0.017165564000606537, decouple_loss:0.0011473583290353417
The modified gen p mean: 0.447517454624176, gen p mean: -0.04406131058931351, mean p set: 0.4479977488517761The modified gen p mean: 0.44587406516075134, gen p mean: -0.03981056064367294, mean p set: 0.44635435938835144
loss_pred:0.016396980732679367, decouple_loss:0.0010385747300460935
loss_pred:0.01745707355439663, decouple_loss:0.0011165027972310781
Iteration: 747, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44829386472702026, gen p mean: -0.045707542449235916, mean p set: 0.448774129152298
loss_pred:0.017757078632712364, decouple_loss:0.0011901805410161614
The modified gen p mean: 0.44572699069976807, gen p mean: -0.04221086949110031, mean p set: 0.44620731472969055The modified gen p mean: 0.44861599802970886, gen p mean: -0.04602937400341034, mean p set: 0.44909629225730896
loss_pred:0.017807267606258392, decouple_loss:0.0010549513390287757
loss_pred:0.017928894609212875, decouple_loss:0.00097403529798612
Iteration: 748, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44631490111351013, gen p mean: -0.04848770052194595, mean p set: 0.44679519534111023
loss_pred:0.01685665361583233, decouple_loss:0.0012746095890179276
The modified gen p mean: 0.44691091775894165, gen p mean: -0.050219614058732986, mean p set: 0.44739121198654175The modified gen p mean: 0.44649532437324524, gen p mean: -0.04660341516137123, mean p set: 0.44697561860084534
loss_pred:0.017918050289154053, decouple_loss:0.0013027125969529152
loss_pred:0.01707557402551174, decouple_loss:0.0012564120115712285
Iteration: 749, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44630491733551025, gen p mean: -0.056818339973688126, mean p set: 0.44678524136543274
loss_pred:0.017034143209457397, decouple_loss:0.0010504561942070723
The modified gen p mean: 0.4457554519176483, gen p mean: -0.05430833250284195, mean p set: 0.4462357461452484The modified gen p mean: 0.44780677556991577, gen p mean: -0.05637223646044731, mean p set: 0.4482870399951935
loss_pred:0.01752430386841297, decouple_loss:0.0010555010521784425
loss_pred:0.016753487288951874, decouple_loss:0.001028337748721242
Iteration: 750, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4463137090206146, gen p mean: -0.0546937920153141, mean p set: 0.44679397344589233
loss_pred:0.018365606665611267, decouple_loss:0.0012647062540054321
The modified gen p mean: 0.4469471573829651, gen p mean: -0.058053091168403625, mean p set: 0.4474274814128876The modified gen p mean: 0.44687435030937195, gen p mean: -0.05625767260789871, mean p set: 0.44735464453697205
loss_pred:0.016657624393701553, decouple_loss:0.001460298546589911
loss_pred:0.016941579058766365, decouple_loss:0.0013534917961806059
2023-05-01 01:13:07 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.06084347143769264, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.055394161492586136, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.05634593963623047, mean p set: 0.4500633478164673
loss_pred:0.01847201958298683, decouple_loss:0.0010393920820206404
loss_pred:0.017340799793601036, decouple_loss:0.00104716292116791
loss_pred:0.017438650131225586, decouple_loss:0.001007665996439755
WV_0_PC_1_EH_0_PS_40, loss: 0.017802059650421143, avg_mse: 0.025557521730661392
current test mse: 0.025558
Iteration: 751, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467291831970215, gen p mean: -0.060980312526226044, mean p set: 0.4472094774246216
The modified gen p mean: 0.4463766813278198, gen p mean: -0.054664913564920425, mean p set: 0.4468569755554199
The modified gen p mean: 0.4472074508666992, gen p mean: -0.05850614607334137, mean p set: 0.4476877748966217
loss_pred:0.01716075837612152, decouple_loss:0.000974873430095613
loss_pred:0.01624124124646187, decouple_loss:0.000978982774540782
loss_pred:0.01702476665377617, decouple_loss:0.0010218354873359203
Iteration: 752, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44793158769607544, gen p mean: -0.060237277299165726, mean p set: 0.44841188192367554
The modified gen p mean: 0.44660159945487976, gen p mean: -0.053093321621418, mean p set: 0.44708189368247986
loss_pred:0.016996925696730614, decouple_loss:0.001244818209670484
loss_pred:0.017735639587044716, decouple_loss:0.0012216734467074275
The modified gen p mean: 0.447654664516449, gen p mean: -0.059942059218883514, mean p set: 0.4481349289417267
loss_pred:0.017567813396453857, decouple_loss:0.001339126843959093
Iteration: 753, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4462195634841919, gen p mean: -0.05329921096563339, mean p set: 0.4466998875141144
loss_pred:0.017326049506664276, decouple_loss:0.001062413095496595
The modified gen p mean: 0.4488300383090973, gen p mean: -0.055166371166706085, mean p set: 0.4493103623390198The modified gen p mean: 0.4464661180973053, gen p mean: -0.05567379668354988, mean p set: 0.446946382522583
loss_pred:0.017687490209937096, decouple_loss:0.0010237247915938497
loss_pred:0.017155716195702553, decouple_loss:0.001089260564185679
Iteration: 754, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44654712080955505, gen p mean: -0.052429795265197754, mean p set: 0.44702741503715515
loss_pred:0.01651626266539097, decouple_loss:0.0009888855274766684
The modified gen p mean: 0.44663169980049133, gen p mean: -0.04672471433877945, mean p set: 0.44711199402809143The modified gen p mean: 0.44608253240585327, gen p mean: -0.046972110867500305, mean p set: 0.446562796831131
loss_pred:0.017310071736574173, decouple_loss:0.0009375973604619503
loss_pred:0.017749078571796417, decouple_loss:0.0009927247883751988
Iteration: 755, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44585978984832764, gen p mean: -0.04333173856139183, mean p set: 0.44634005427360535
loss_pred:0.01755531318485737, decouple_loss:0.0011269253445789218
The modified gen p mean: 0.4478931725025177, gen p mean: -0.046882208436727524, mean p set: 0.4483734667301178The modified gen p mean: 0.44572097063064575, gen p mean: -0.042851705104112625, mean p set: 0.44620129466056824
loss_pred:0.016679205000400543, decouple_loss:0.0011681452160701156
loss_pred:0.017193078994750977, decouple_loss:0.0011875323252752423
Iteration: 756, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44953835010528564, gen p mean: -0.04058687388896942, mean p set: 0.45001867413520813
loss_pred:0.01709138974547386, decouple_loss:0.000975787581410259
The modified gen p mean: 0.44721871614456177, gen p mean: -0.042688146233558655, mean p set: 0.4476989805698395The modified gen p mean: 0.44560834765434265, gen p mean: -0.042266130447387695, mean p set: 0.44608867168426514
loss_pred:0.017853213474154472, decouple_loss:0.001005775760859251
loss_pred:0.01765512116253376, decouple_loss:0.0009544661152176559
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012000_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012000_3_24hr.npz
NaN value num: 0
Iteration: 757, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474874436855316, gen p mean: -0.04058035835623741, mean p set: 0.4479677379131317
loss_pred:0.014682717621326447, decouple_loss:0.0013061972567811608
The modified gen p mean: 0.4461825489997864, gen p mean: -0.04025295749306679, mean p set: 0.4466628134250641The modified gen p mean: 0.4481538236141205, gen p mean: -0.04185093194246292, mean p set: 0.44863414764404297
loss_pred:0.015815407037734985, decouple_loss:0.0013141428353264928
loss_pred:0.014684775844216347, decouple_loss:0.0012491137022152543
Iteration: 758, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482327103614807, gen p mean: -0.043932102620601654, mean p set: 0.4487130343914032
loss_pred:0.014592910185456276, decouple_loss:0.0011328712571412325
The modified gen p mean: 0.4501919448375702, gen p mean: -0.03469398245215416, mean p set: 0.4506722390651703The modified gen p mean: 0.4492303431034088, gen p mean: -0.04448061063885689, mean p set: 0.4497106075286865
loss_pred:0.015577204525470734, decouple_loss:0.0011878100922331214
loss_pred:0.014741940423846245, decouple_loss:0.0012153607094660401
Iteration: 759, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480293095111847, gen p mean: -0.04319188371300697, mean p set: 0.4485096037387848
loss_pred:0.014682751148939133, decouple_loss:0.0016686636954545975
The modified gen p mean: 0.44704607129096985, gen p mean: -0.043708786368370056, mean p set: 0.44752633571624756The modified gen p mean: 0.44831985235214233, gen p mean: -0.04511655867099762, mean p set: 0.44880014657974243
loss_pred:0.013969848863780499, decouple_loss:0.0013460370246320963
loss_pred:0.014188620261847973, decouple_loss:0.0014700692845508456
Iteration: 760, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481850862503052, gen p mean: -0.04328541457653046, mean p set: 0.44866541028022766
The modified gen p mean: 0.4472803473472595, gen p mean: -0.040384355932474136, mean p set: 0.447760671377182
loss_pred:0.014545129612088203, decouple_loss:0.00120707624591887
loss_pred:0.014673292636871338, decouple_loss:0.0011766322422772646
The modified gen p mean: 0.449720174074173, gen p mean: -0.04014735668897629, mean p set: 0.45020049810409546
loss_pred:0.014920772053301334, decouple_loss:0.0011701142648234963
2023-05-01 01:15:47 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.046996742486953735, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04224877431988716, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.04273509979248047, mean p set: 0.4500633478164673
loss_pred:0.0187732744961977, decouple_loss:0.001378802233375609
loss_pred:0.01754407398402691, decouple_loss:0.0013346209889277816
loss_pred:0.017610276117920876, decouple_loss:0.001341401832178235
WV_0_PC_1_EH_0_PS_40, loss: 0.018043456599116325, avg_mse: 0.02593279629945755
current test mse: 0.025933
Iteration: 761, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464574158191681, gen p mean: -0.042260050773620605, mean p set: 0.4469376802444458
The modified gen p mean: 0.44693154096603394, gen p mean: -0.04723677039146423, mean p set: 0.44741183519363403
The modified gen p mean: 0.4492894113063812, gen p mean: -0.038109540939331055, mean p set: 0.44976967573165894
loss_pred:0.01453995518386364, decouple_loss:0.0013757238630205393
loss_pred:0.014589347876608372, decouple_loss:0.0012569194659590721
loss_pred:0.014182212762534618, decouple_loss:0.0012972387485206127
Iteration: 762, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44876590371131897, gen p mean: -0.0375496931374073, mean p set: 0.44924619793891907
loss_pred:0.014752916060388088, decouple_loss:0.0012938722502440214
The modified gen p mean: 0.44775643944740295, gen p mean: -0.03735886141657829, mean p set: 0.44823670387268066The modified gen p mean: 0.44736945629119873, gen p mean: -0.035661909729242325, mean p set: 0.44784975051879883
loss_pred:0.013862762600183487, decouple_loss:0.0012771423207595944
loss_pred:0.014426758512854576, decouple_loss:0.0012623913353309035
Iteration: 763, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44701382517814636, gen p mean: -0.04173218831419945, mean p set: 0.44749414920806885
loss_pred:0.014068684540688992, decouple_loss:0.0015125494683161378
The modified gen p mean: 0.44790494441986084, gen p mean: -0.037940144538879395, mean p set: 0.44838523864746094The modified gen p mean: 0.4473118782043457, gen p mean: -0.04510819539427757, mean p set: 0.4477921724319458
loss_pred:0.014391244389116764, decouple_loss:0.001365850679576397
loss_pred:0.013706794008612633, decouple_loss:0.0014570631319656968
Iteration: 764, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478943645954132, gen p mean: -0.04634178429841995, mean p set: 0.4483746588230133
loss_pred:0.013893241994082928, decouple_loss:0.0015770321479067206
The modified gen p mean: 0.4473456144332886, gen p mean: -0.04067164659500122, mean p set: 0.44782590866088867The modified gen p mean: 0.4471631646156311, gen p mean: -0.044519465416669846, mean p set: 0.4476434886455536
loss_pred:0.014201431535184383, decouple_loss:0.0015459890710189939
loss_pred:0.01382923498749733, decouple_loss:0.001476780278608203
Iteration: 765, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485984742641449, gen p mean: -0.04512821137905121, mean p set: 0.449078768491745
loss_pred:0.013779079541563988, decouple_loss:0.0014536649687215686
The modified gen p mean: 0.44738543033599854, gen p mean: -0.04691700637340546, mean p set: 0.44786572456359863The modified gen p mean: 0.44900283217430115, gen p mean: -0.04269146919250488, mean p set: 0.44948315620422363
loss_pred:0.013498459942638874, decouple_loss:0.0014204836916178465
loss_pred:0.014014034532010555, decouple_loss:0.0013418509624898434
Iteration: 766, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44858017563819885, gen p mean: -0.04297930374741554, mean p set: 0.44906049966812134
loss_pred:0.013971947133541107, decouple_loss:0.0014689926756545901
The modified gen p mean: 0.4484160542488098, gen p mean: -0.04752270504832268, mean p set: 0.4488963484764099The modified gen p mean: 0.44750961661338806, gen p mean: -0.05059107765555382, mean p set: 0.44798991084098816
loss_pred:0.013048794120550156, decouple_loss:0.001525668310932815
loss_pred:0.0138217993080616, decouple_loss:0.0016465315129607916
Iteration: 767, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44783085584640503, gen p mean: -0.04862232878804207, mean p set: 0.4483111500740051
loss_pred:0.014326350763440132, decouple_loss:0.001694339676760137
The modified gen p mean: 0.4500364661216736, gen p mean: -0.045500241219997406, mean p set: 0.4505167305469513The modified gen p mean: 0.4487685561180115, gen p mean: -0.053343791514635086, mean p set: 0.44924888014793396
loss_pred:0.014305653981864452, decouple_loss:0.0018275417387485504
loss_pred:0.013892880640923977, decouple_loss:0.0018973771948367357
Iteration: 768, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488517940044403, gen p mean: -0.051566608250141144, mean p set: 0.4493320882320404
loss_pred:0.013296710327267647, decouple_loss:0.0014725766377523541
The modified gen p mean: 0.4488295614719391, gen p mean: -0.05302879586815834, mean p set: 0.4493098258972168The modified gen p mean: 0.44719547033309937, gen p mean: -0.0498979315161705, mean p set: 0.4476757347583771
loss_pred:0.013100091367959976, decouple_loss:0.0017091669142246246
loss_pred:0.013384251855313778, decouple_loss:0.0015903941821306944
Iteration: 769, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482777416706085, gen p mean: -0.05070283263921738, mean p set: 0.4487580358982086
loss_pred:0.012834838591516018, decouple_loss:0.0018358490196987987
The modified gen p mean: 0.4491006135940552, gen p mean: -0.04730549454689026, mean p set: 0.4495809078216553
The modified gen p mean: 0.44705814123153687, gen p mean: -0.050172001123428345, mean p set: 0.44753846526145935
loss_pred:0.014025842770934105, decouple_loss:0.0017596936086192727
loss_pred:0.013741941191256046, decouple_loss:0.0020809220150113106
Iteration: 770, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488963186740875, gen p mean: -0.04687158390879631, mean p set: 0.4493766129016876
loss_pred:0.013713667169213295, decouple_loss:0.0017404784448444843
The modified gen p mean: 0.44693103432655334, gen p mean: -0.04937571659684181, mean p set: 0.44741132855415344The modified gen p mean: 0.44661128520965576, gen p mean: -0.050343431532382965, mean p set: 0.44709157943725586
loss_pred:0.013335859403014183, decouple_loss:0.0016938471235334873
loss_pred:0.013742534443736076, decouple_loss:0.0020803220104426146
2023-05-01 01:17:40 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.05194815620779991, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04702259600162506, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.047358233481645584, mean p set: 0.4500633478164673
loss_pred:0.019413093104958534, decouple_loss:0.0016751713119447231
loss_pred:0.0183404590934515, decouple_loss:0.0015569123206660151
loss_pred:0.018368849530816078, decouple_loss:0.001519719953648746
WV_0_PC_1_EH_0_PS_40, loss: 0.018786665052175522, avg_mse: 0.027393566444516182
current test mse: 0.027394
Iteration: 771, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476581811904907, gen p mean: -0.04488128051161766, mean p set: 0.4481384754180908
The modified gen p mean: 0.44794389605522156, gen p mean: -0.04795645922422409, mean p set: 0.44842419028282166
The modified gen p mean: 0.4491988718509674, gen p mean: -0.04984888806939125, mean p set: 0.4496791362762451
loss_pred:0.013574653305113316, decouple_loss:0.0016146614216268063
loss_pred:0.012861219234764576, decouple_loss:0.0015605237567797303
loss_pred:0.01324394065886736, decouple_loss:0.0015976165886968374
Iteration: 772, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44902482628822327, gen p mean: -0.044350262731313705, mean p set: 0.44950512051582336
loss_pred:0.01343295443803072, decouple_loss:0.0015806329902261496
The modified gen p mean: 0.4474087357521057, gen p mean: -0.045886799693107605, mean p set: 0.4478890001773834The modified gen p mean: 0.4493301808834076, gen p mean: -0.043241068720817566, mean p set: 0.4498105049133301
loss_pred:0.01343101728707552, decouple_loss:0.0015773015329614282
loss_pred:0.01337149366736412, decouple_loss:0.0015151709085330367
Iteration: 773, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44921785593032837, gen p mean: -0.043581925332546234, mean p set: 0.44969815015792847
loss_pred:0.013364315964281559, decouple_loss:0.0013552503660321236
The modified gen p mean: 0.44793716073036194, gen p mean: -0.039973169565200806, mean p set: 0.44841745495796204The modified gen p mean: 0.4460189938545227, gen p mean: -0.04545915126800537, mean p set: 0.4464992880821228
loss_pred:0.013772295787930489, decouple_loss:0.0014687376096844673loss_pred:0.013048507273197174, decouple_loss:0.0016328960191458464
Iteration: 774, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482394754886627, gen p mean: -0.046244557946920395, mean p set: 0.4487197697162628
loss_pred:0.013311360031366348, decouple_loss:0.0017713849665597081
The modified gen p mean: 0.4468691051006317, gen p mean: -0.04981808364391327, mean p set: 0.4473493695259094The modified gen p mean: 0.447660356760025, gen p mean: -0.04582613334059715, mean p set: 0.4481406807899475
loss_pred:0.01333469245582819, decouple_loss:0.0014499796088784933
loss_pred:0.013093908317387104, decouple_loss:0.0015671724686399102
Iteration: 775, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488774538040161, gen p mean: -0.04965147003531456, mean p set: 0.4493577182292938
loss_pred:0.01263380516320467, decouple_loss:0.001464361441321671
The modified gen p mean: 0.44830483198165894, gen p mean: -0.04560568183660507, mean p set: 0.44878509640693665The modified gen p mean: 0.44871610403060913, gen p mean: -0.049586985260248184, mean p set: 0.4491964280605316
loss_pred:0.013223957270383835, decouple_loss:0.0014375875471159816
loss_pred:0.012635662220418453, decouple_loss:0.0014445398701354861
Iteration: 776, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44937461614608765, gen p mean: -0.04512638971209526, mean p set: 0.44985491037368774
loss_pred:0.013435172848403454, decouple_loss:0.001416799845173955
The modified gen p mean: 0.4464013874530792, gen p mean: -0.04467747360467911, mean p set: 0.4468816816806793The modified gen p mean: 0.4472601115703583, gen p mean: -0.045308422297239304, mean p set: 0.4477404057979584
loss_pred:0.013463672250509262, decouple_loss:0.0015575912548229098
loss_pred:0.013111550360918045, decouple_loss:0.001443933928385377
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012014_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012014_3_24hr.npz
NaN value num: 0
Iteration: 777, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45023971796035767, gen p mean: -0.04267421364784241, mean p set: 0.45072001218795776
loss_pred:0.01851515844464302, decouple_loss:0.0014542089775204659
The modified gen p mean: 0.4477938711643219, gen p mean: -0.044342365115880966, mean p set: 0.4482741951942444The modified gen p mean: 0.4495052695274353, gen p mean: -0.04178106039762497, mean p set: 0.4499855935573578
loss_pred:0.018400629982352257, decouple_loss:0.0014280795585364103
loss_pred:0.017818937078118324, decouple_loss:0.0014777806354686618
Iteration: 778, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44900259375572205, gen p mean: -0.04267219081521034, mean p set: 0.44948288798332214
loss_pred:0.01712380163371563, decouple_loss:0.00138680764939636
The modified gen p mean: 0.449479341506958, gen p mean: -0.04388464614748955, mean p set: 0.4499596655368805
The modified gen p mean: 0.4508521556854248, gen p mean: -0.04738367721438408, mean p set: 0.4513324499130249
loss_pred:0.017692536115646362, decouple_loss:0.0013740553986281157
loss_pred:0.017288200557231903, decouple_loss:0.0013372418470680714
Iteration: 779, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45043060183525085, gen p mean: -0.04462045803666115, mean p set: 0.45091089606285095
loss_pred:0.01722286455333233, decouple_loss:0.0014610220678150654
The modified gen p mean: 0.44895386695861816, gen p mean: -0.04758240655064583, mean p set: 0.44943416118621826The modified gen p mean: 0.4510965049266815, gen p mean: -0.04375335946679115, mean p set: 0.4515767991542816
loss_pred:0.01711399294435978, decouple_loss:0.001413310063071549
loss_pred:0.016750870272517204, decouple_loss:0.001370226382277906
Iteration: 780, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497719407081604, gen p mean: -0.04344490170478821, mean p set: 0.4502522349357605
The modified gen p mean: 0.45079007744789124, gen p mean: -0.0473238080739975, mean p set: 0.45127037167549133
loss_pred:0.016811877489089966, decouple_loss:0.0014647786738350987
loss_pred:0.01782848685979843, decouple_loss:0.0015655335737392306
The modified gen p mean: 0.4514254629611969, gen p mean: -0.05088018625974655, mean p set: 0.4519057869911194
loss_pred:0.019344402477145195, decouple_loss:0.001647370751015842
2023-05-01 01:20:25 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.055429913103580475, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.050468865782022476, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.05123061314225197, mean p set: 0.4500633478164673
loss_pred:0.01880580186843872, decouple_loss:0.0016632681945338845
loss_pred:0.017648546025156975, decouple_loss:0.0014893849147483706
loss_pred:0.01776871085166931, decouple_loss:0.0015133956912904978
WV_0_PC_1_EH_0_PS_40, loss: 0.01815212145447731, avg_mse: 0.026103252544999123
current test mse: 0.026103
Iteration: 781, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44781580567359924, gen p mean: -0.04868054762482643, mean p set: 0.44829609990119934
The modified gen p mean: 0.4481632709503174, gen p mean: -0.045709025114774704, mean p set: 0.4486435651779175
The modified gen p mean: 0.45048201084136963, gen p mean: -0.04743804782629013, mean p set: 0.4509623348712921
loss_pred:0.01842825673520565, decouple_loss:0.0014113279758021235
loss_pred:0.01784582994878292, decouple_loss:0.0014543950092047453
loss_pred:0.016749944537878036, decouple_loss:0.0013478483306244016
Iteration: 782, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44892340898513794, gen p mean: -0.03824451193213463, mean p set: 0.44940370321273804
loss_pred:0.017741432413458824, decouple_loss:0.001376971835270524
The modified gen p mean: 0.44736045598983765, gen p mean: -0.048112139105796814, mean p set: 0.44784078001976013The modified gen p mean: 0.45174407958984375, gen p mean: -0.042725689709186554, mean p set: 0.45222434401512146
loss_pred:0.017365936189889908, decouple_loss:0.0013349258806556463
loss_pred:0.017482459545135498, decouple_loss:0.0014638066058978438
Iteration: 783, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44853904843330383, gen p mean: -0.04787077754735947, mean p set: 0.44901934266090393
loss_pred:0.017351722344756126, decouple_loss:0.0013936464674770832
The modified gen p mean: 0.45106568932533264, gen p mean: -0.048143476247787476, mean p set: 0.45154598355293274The modified gen p mean: 0.44890737533569336, gen p mean: -0.04447999596595764, mean p set: 0.44938766956329346
loss_pred:0.017019862309098244, decouple_loss:0.0014421730302274227
loss_pred:0.017201067879796028, decouple_loss:0.0014720195904374123
Iteration: 784, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487953186035156, gen p mean: -0.04259924218058586, mean p set: 0.4492756426334381
loss_pred:0.018612518906593323, decouple_loss:0.001301469630561769
The modified gen p mean: 0.4504086673259735, gen p mean: -0.049056075513362885, mean p set: 0.450888991355896The modified gen p mean: 0.4486335217952728, gen p mean: -0.04739505425095558, mean p set: 0.4491138160228729
loss_pred:0.01720775105059147, decouple_loss:0.0012841257266700268
loss_pred:0.01770949363708496, decouple_loss:0.0012872915249317884
Iteration: 785, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473794400691986, gen p mean: -0.04982883855700493, mean p set: 0.4478597342967987
loss_pred:0.017689252272248268, decouple_loss:0.001372959348373115
The modified gen p mean: 0.4491342306137085, gen p mean: -0.040401529520750046, mean p set: 0.4496145248413086The modified gen p mean: 0.45027220249176025, gen p mean: -0.04471893236041069, mean p set: 0.45075252652168274
loss_pred:0.017611555755138397, decouple_loss:0.001458028214983642
loss_pred:0.01838078908622265, decouple_loss:0.0013007527450099587
Iteration: 786, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44945549964904785, gen p mean: -0.04796091467142105, mean p set: 0.44993579387664795
loss_pred:0.01694120280444622, decouple_loss:0.0013440879993140697
The modified gen p mean: 0.44784224033355713, gen p mean: -0.04574434831738472, mean p set: 0.4483225345611572The modified gen p mean: 0.4506310820579529, gen p mean: -0.04404487460851669, mean p set: 0.451111376285553
loss_pred:0.01683887280523777, decouple_loss:0.0013723362935706973
loss_pred:0.018039794638752937, decouple_loss:0.0013008599635213614
Iteration: 787, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511122703552246, gen p mean: -0.045308612287044525, mean p set: 0.4515925347805023
loss_pred:0.01648237742483616, decouple_loss:0.0012817704118788242
The modified gen p mean: 0.44993770122528076, gen p mean: -0.049596983939409256, mean p set: 0.45041805505752563The modified gen p mean: 0.44856590032577515, gen p mean: -0.04358641430735588, mean p set: 0.44904619455337524
loss_pred:0.016751281917095184, decouple_loss:0.00131825334392488
loss_pred:0.018113980069756508, decouple_loss:0.0012712113093584776
Iteration: 788, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44889235496520996, gen p mean: -0.04041469842195511, mean p set: 0.44937264919281006
loss_pred:0.018055148422718048, decouple_loss:0.0013539521023631096
The modified gen p mean: 0.44781234860420227, gen p mean: -0.049267418682575226, mean p set: 0.44829264283180237The modified gen p mean: 0.44963958859443665, gen p mean: -0.05024413764476776, mean p set: 0.45011985301971436
loss_pred:0.01719197817146778, decouple_loss:0.0013402658514678478
loss_pred:0.01676294393837452, decouple_loss:0.0013222538400441408
Iteration: 789, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502425789833069, gen p mean: -0.04884166643023491, mean p set: 0.4507228434085846
loss_pred:0.017026960849761963, decouple_loss:0.0013804413611069322
The modified gen p mean: 0.4482405185699463, gen p mean: -0.04628386348485947, mean p set: 0.4487208127975464The modified gen p mean: 0.4503285884857178, gen p mean: -0.053949132561683655, mean p set: 0.45080891251564026
loss_pred:0.016730235889554024, decouple_loss:0.0013928540283814073
loss_pred:0.017772743478417397, decouple_loss:0.0014827321283519268
Iteration: 790, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44919106364250183, gen p mean: -0.0437823086977005, mean p set: 0.44967135787010193
loss_pred:0.017474964261054993, decouple_loss:0.001331816427409649
The modified gen p mean: 0.44947919249534607, gen p mean: -0.04962136223912239, mean p set: 0.4499594569206238The modified gen p mean: 0.4492426812648773, gen p mean: -0.0469902902841568, mean p set: 0.4497230052947998
loss_pred:0.01681869849562645, decouple_loss:0.001336074317805469
loss_pred:0.016823720186948776, decouple_loss:0.0013602871913462877
2023-05-01 01:22:19 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.057480525225400925, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.05256907641887665, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.05319146066904068, mean p set: 0.4500633478164673
loss_pred:0.018518541008234024, decouple_loss:0.0015638144686818123
loss_pred:0.017394712194800377, decouple_loss:0.0014004865661263466
loss_pred:0.017487773671746254, decouple_loss:0.0014807868283241987
WV_0_PC_1_EH_0_PS_40, loss: 0.017874427139759064, avg_mse: 0.025631120428442955
current test mse: 0.025631
Iteration: 791, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448962539434433, gen p mean: -0.047347068786621094, mean p set: 0.4494428038597107
The modified gen p mean: 0.45083239674568176, gen p mean: -0.04477402940392494, mean p set: 0.45131269097328186
The modified gen p mean: 0.44764041900634766, gen p mean: -0.049211014062166214, mean p set: 0.44812071323394775
loss_pred:0.017670221626758575, decouple_loss:0.0012869143392890692
loss_pred:0.016308743506669998, decouple_loss:0.0012398002436384559
loss_pred:0.01729489676654339, decouple_loss:0.0012353176716715097
Iteration: 792, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45031604170799255, gen p mean: -0.049680668860673904, mean p set: 0.45079630613327026
loss_pred:0.016761112958192825, decouple_loss:0.0014572999207302928
The modified gen p mean: 0.44923338294029236, gen p mean: -0.048017263412475586, mean p set: 0.44971367716789246The modified gen p mean: 0.45154479146003723, gen p mean: -0.05356292426586151, mean p set: 0.45202508568763733
loss_pred:0.01896456815302372, decouple_loss:0.0014819150092080235
loss_pred:0.017827043309807777, decouple_loss:0.0014697653241455555
Iteration: 793, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495643079280853, gen p mean: -0.054740771651268005, mean p set: 0.4500446021556854
loss_pred:0.01730263978242874, decouple_loss:0.0012280016671866179
The modified gen p mean: 0.4503253102302551, gen p mean: -0.04867604374885559, mean p set: 0.4508056342601776The modified gen p mean: 0.4504573941230774, gen p mean: -0.05487930402159691, mean p set: 0.4509376883506775
loss_pred:0.016138527542352676, decouple_loss:0.0011683476623147726
loss_pred:0.016967447474598885, decouple_loss:0.00118633930105716
Iteration: 794, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44972679018974304, gen p mean: -0.04985656961798668, mean p set: 0.45020708441734314
loss_pred:0.01760043576359749, decouple_loss:0.0012617968022823334
The modified gen p mean: 0.4521694481372833, gen p mean: -0.04858594015240669, mean p set: 0.4526497423648834The modified gen p mean: 0.4495418071746826, gen p mean: -0.04796554520726204, mean p set: 0.4500221312046051
loss_pred:0.01671728864312172, decouple_loss:0.001287285122089088
loss_pred:0.016395218670368195, decouple_loss:0.0013152435421943665
Iteration: 795, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45113056898117065, gen p mean: -0.048208799213171005, mean p set: 0.45161086320877075
loss_pred:0.017065800726413727, decouple_loss:0.0012241711374372244
The modified gen p mean: 0.4473547637462616, gen p mean: -0.05112866312265396, mean p set: 0.4478350281715393The modified gen p mean: 0.44846534729003906, gen p mean: -0.050454407930374146, mean p set: 0.4489456117153168
loss_pred:0.01686992309987545, decouple_loss:0.0012632706202566624
loss_pred:0.017228221520781517, decouple_loss:0.0012201874051243067
Iteration: 796, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478863775730133, gen p mean: -0.045476872473955154, mean p set: 0.4483667314052582
loss_pred:0.017530422657728195, decouple_loss:0.0010947301052510738
The modified gen p mean: 0.44983920454978943, gen p mean: -0.05271162837743759, mean p set: 0.45031946897506714The modified gen p mean: 0.44994351267814636, gen p mean: -0.04674631729722023, mean p set: 0.4504237771034241
loss_pred:0.017431849613785744, decouple_loss:0.0012192720314487815
loss_pred:0.017139578238129616, decouple_loss:0.0011522703571245074
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012006_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012006_3_24hr.npz
NaN value num: 0
Iteration: 797, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4540155529975891, gen p mean: -0.04745588079094887, mean p set: 0.4544958472251892
loss_pred:0.01695609837770462, decouple_loss:0.0012518572621047497
The modified gen p mean: 0.45317336916923523, gen p mean: -0.04317078739404678, mean p set: 0.4536536633968353The modified gen p mean: 0.45255032181739807, gen p mean: -0.045865580439567566, mean p set: 0.4530305862426758
loss_pred:0.017199914902448654, decouple_loss:0.0012445542961359024
loss_pred:0.01693575084209442, decouple_loss:0.0012948705116286874
Iteration: 798, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4535083472728729, gen p mean: -0.034444086253643036, mean p set: 0.453988641500473
loss_pred:0.0179606880992651, decouple_loss:0.0013594689080491662
The modified gen p mean: 0.4525143504142761, gen p mean: -0.043054770678281784, mean p set: 0.45299461483955383The modified gen p mean: 0.45182642340660095, gen p mean: -0.04224911332130432, mean p set: 0.45230671763420105
loss_pred:0.017309464514255524, decouple_loss:0.0011725238291546702
loss_pred:0.016964536160230637, decouple_loss:0.0013833061093464494
Iteration: 799, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.453774631023407, gen p mean: -0.04555390030145645, mean p set: 0.45425495505332947
The modified gen p mean: 0.4533478021621704, gen p mean: -0.04329860955476761, mean p set: 0.4538280665874481
loss_pred:0.017339931800961494, decouple_loss:0.0012416100362315774
loss_pred:0.017097102478146553, decouple_loss:0.0012317338259890676
The modified gen p mean: 0.45329082012176514, gen p mean: -0.03789583221077919, mean p set: 0.4537711441516876
loss_pred:0.017181536182761192, decouple_loss:0.0011103848228231072
Iteration: 800, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4530910849571228, gen p mean: -0.0367216020822525, mean p set: 0.4535713493824005
loss_pred:0.016846071928739548, decouple_loss:0.0015881885774433613
The modified gen p mean: 0.4529658555984497, gen p mean: -0.03493080288171768, mean p set: 0.4534461498260498The modified gen p mean: 0.45459312200546265, gen p mean: -0.03203381970524788, mean p set: 0.45507341623306274
loss_pred:0.017103388905525208, decouple_loss:0.0015062994789332151
loss_pred:0.01713494211435318, decouple_loss:0.001551773282699287
2023-05-01 01:24:51 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.04475615918636322, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04020838811993599, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.040597282350063324, mean p set: 0.4500633478164673
loss_pred:0.018438072875142097, decouple_loss:0.0014429594157263637
loss_pred:0.017282195389270782, decouple_loss:0.0013729457277804613
loss_pred:0.017446083948016167, decouple_loss:0.0013625957071781158
WV_0_PC_1_EH_0_PS_40, loss: 0.017791759222745895, avg_mse: 0.025505002588033676
current test mse: 0.025505
Iteration: 801, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4537653923034668, gen p mean: -0.034606147557497025, mean p set: 0.4542456865310669
The modified gen p mean: 0.45321083068847656, gen p mean: -0.02539863996207714, mean p set: 0.45369112491607666
The modified gen p mean: 0.4535242021083832, gen p mean: -0.029353944584727287, mean p set: 0.4540044963359833
loss_pred:0.017861900851130486, decouple_loss:0.0013841097243130207
loss_pred:0.01688171736896038, decouple_loss:0.0012269396102055907
loss_pred:0.01749679446220398, decouple_loss:0.0014394473982974887
Iteration: 802, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45216041803359985, gen p mean: -0.03345464542508125, mean p set: 0.45264074206352234
loss_pred:0.017515620216727257, decouple_loss:0.0013474425068125129
The modified gen p mean: 0.4530271589756012, gen p mean: -0.03339017555117607, mean p set: 0.4535074532032013The modified gen p mean: 0.4523785710334778, gen p mean: -0.03618323802947998, mean p set: 0.4528588652610779
loss_pred:0.016220638528466225, decouple_loss:0.0015084239421412349
loss_pred:0.016825679689645767, decouple_loss:0.0014839301584288478
Iteration: 803, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45387405157089233, gen p mean: -0.028511518612504005, mean p set: 0.45435431599617004
loss_pred:0.01703118160367012, decouple_loss:0.0013492113212123513
The modified gen p mean: 0.45288416743278503, gen p mean: -0.034554172307252884, mean p set: 0.45336446166038513The modified gen p mean: 0.4538981318473816, gen p mean: -0.044248491525650024, mean p set: 0.4543784260749817
loss_pred:0.01717524603009224, decouple_loss:0.0014351187273859978
loss_pred:0.016845235601067543, decouple_loss:0.0015182946808636189
Iteration: 804, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4521951973438263, gen p mean: -0.03598630800843239, mean p set: 0.4526754915714264
loss_pred:0.016981573775410652, decouple_loss:0.0013969663996249437
The modified gen p mean: 0.45412731170654297, gen p mean: -0.041488103568553925, mean p set: 0.45460760593414307The modified gen p mean: 0.4528730809688568, gen p mean: -0.03867047652602196, mean p set: 0.4533534049987793
loss_pred:0.01728844828903675, decouple_loss:0.0014556266833096743
loss_pred:0.016804778948426247, decouple_loss:0.0014082032721489668
Iteration: 805, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4534195363521576, gen p mean: -0.03931303322315216, mean p set: 0.4538998007774353
loss_pred:0.016205014660954475, decouple_loss:0.0012512507382780313
The modified gen p mean: 0.4506906270980835, gen p mean: -0.03706137835979462, mean p set: 0.451170951128006The modified gen p mean: 0.45344677567481995, gen p mean: -0.040842216461896896, mean p set: 0.45392709970474243
loss_pred:0.01711367815732956, decouple_loss:0.0013698734110221267
loss_pred:0.01630726456642151, decouple_loss:0.0013267968315631151
Iteration: 806, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4529710114002228, gen p mean: -0.04078865051269531, mean p set: 0.45345136523246765
loss_pred:0.01720164343714714, decouple_loss:0.0013753094244748354
The modified gen p mean: 0.4524138271808624, gen p mean: -0.03828022629022598, mean p set: 0.4528941214084625The modified gen p mean: 0.45436426997184753, gen p mean: -0.03167406842112541, mean p set: 0.45484453439712524
loss_pred:0.016692202538251877, decouple_loss:0.0012410719646140933
loss_pred:0.016630869358778, decouple_loss:0.0012160239275544882
Iteration: 807, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45303255319595337, gen p mean: -0.04003581777215004, mean p set: 0.45351284742355347
loss_pred:0.01718747988343239, decouple_loss:0.0012957942672073841
The modified gen p mean: 0.45443862676620483, gen p mean: -0.03516826778650284, mean p set: 0.45491892099380493The modified gen p mean: 0.45313799381256104, gen p mean: -0.04210765287280083, mean p set: 0.45361828804016113
loss_pred:0.01721894182264805, decouple_loss:0.00121220457367599
loss_pred:0.01657276041805744, decouple_loss:0.0012962669134140015
Iteration: 808, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45304909348487854, gen p mean: -0.0382869727909565, mean p set: 0.453529417514801
loss_pred:0.017059221863746643, decouple_loss:0.0012026741169393063
The modified gen p mean: 0.4523594081401825, gen p mean: -0.035869304090738297, mean p set: 0.4528396725654602The modified gen p mean: 0.4536207616329193, gen p mean: -0.03532802686095238, mean p set: 0.4541010856628418
loss_pred:0.016380907967686653, decouple_loss:0.0012229661224409938
loss_pred:0.0163800697773695, decouple_loss:0.0012342025293037295
Iteration: 809, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45277315378189087, gen p mean: -0.034558624029159546, mean p set: 0.45325344800949097
loss_pred:0.01642858423292637, decouple_loss:0.0011571332579478621
The modified gen p mean: 0.45239123702049255, gen p mean: -0.0332748182117939, mean p set: 0.4528715908527374The modified gen p mean: 0.4518917500972748, gen p mean: -0.03747788444161415, mean p set: 0.45237207412719727
loss_pred:0.015884311869740486, decouple_loss:0.0011651832610368729
loss_pred:0.016750579699873924, decouple_loss:0.001371046295389533
Iteration: 810, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4534859359264374, gen p mean: -0.045083384960889816, mean p set: 0.45396625995635986
loss_pred:0.016898931935429573, decouple_loss:0.0012130886316299438
The modified gen p mean: 0.453923761844635, gen p mean: -0.03726322576403618, mean p set: 0.4544040560722351The modified gen p mean: 0.453023225069046, gen p mean: -0.03672642633318901, mean p set: 0.4535035192966461
loss_pred:0.017061354592442513, decouple_loss:0.001127760042436421
loss_pred:0.01792931742966175, decouple_loss:0.0011779513442888856
2023-05-01 01:26:44 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.051803819835186005, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.046919338405132294, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04738700017333031, mean p set: 0.4500633478164673
loss_pred:0.018527695909142494, decouple_loss:0.0013478667242452502
loss_pred:0.017315929755568504, decouple_loss:0.001246943138539791
loss_pred:0.017504988238215446, decouple_loss:0.0012162276543676853
WV_0_PC_1_EH_0_PS_40, loss: 0.01784638874232769, avg_mse: 0.025631532073020935
current test mse: 0.025632
Iteration: 811, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4530012309551239, gen p mean: -0.03867754340171814, mean p set: 0.453481525182724
The modified gen p mean: 0.45343250036239624, gen p mean: -0.04392039030790329, mean p set: 0.4539128243923187
The modified gen p mean: 0.45374584197998047, gen p mean: -0.04694215580821037, mean p set: 0.4542261064052582
loss_pred:0.016995033249258995, decouple_loss:0.0012255670735612512
loss_pred:0.017278924584388733, decouple_loss:0.0012610576814040542
loss_pred:0.01687641255557537, decouple_loss:0.001103214337490499
Iteration: 812, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4532182514667511, gen p mean: -0.04005090519785881, mean p set: 0.4536985456943512
loss_pred:0.01717037707567215, decouple_loss:0.001238019554875791
The modified gen p mean: 0.4529619514942169, gen p mean: -0.040842898190021515, mean p set: 0.4534422755241394The modified gen p mean: 0.4543045163154602, gen p mean: -0.04415961727499962, mean p set: 0.4547848105430603
loss_pred:0.0171509962528944, decouple_loss:0.0012365402653813362
loss_pred:0.01686275564134121, decouple_loss:0.0011913437629118562
Iteration: 813, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4525662958621979, gen p mean: -0.04323805496096611, mean p set: 0.453046590089798
loss_pred:0.017132483422756195, decouple_loss:0.0011352695291861892
The modified gen p mean: 0.45275551080703735, gen p mean: -0.03843143954873085, mean p set: 0.45323580503463745The modified gen p mean: 0.453561395406723, gen p mean: -0.04396010935306549, mean p set: 0.4540416896343231
loss_pred:0.016389718279242516, decouple_loss:0.0012144885258749127
loss_pred:0.01634896546602249, decouple_loss:0.0011464046547189355
Iteration: 814, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502704441547394, gen p mean: -0.03890065476298332, mean p set: 0.4507507383823395
loss_pred:0.016293983906507492, decouple_loss:0.0010677335085347295
The modified gen p mean: 0.4524284303188324, gen p mean: -0.04062635824084282, mean p set: 0.4529087543487549The modified gen p mean: 0.4528639018535614, gen p mean: -0.04294775426387787, mean p set: 0.4533441960811615
loss_pred:0.017018133774399757, decouple_loss:0.0011982590658590198
loss_pred:0.01663712039589882, decouple_loss:0.0010693820659071207
Iteration: 815, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45244985818862915, gen p mean: -0.036048948764801025, mean p set: 0.45293015241622925
The modified gen p mean: 0.45247045159339905, gen p mean: -0.03846042975783348, mean p set: 0.45295077562332153loss_pred:0.016087649390101433, decouple_loss:0.0011808041017502546
The modified gen p mean: 0.45335716009140015, gen p mean: -0.036098409444093704, mean p set: 0.45383745431900024
loss_pred:0.0160384401679039, decouple_loss:0.0011317988391965628
loss_pred:0.017105620354413986, decouple_loss:0.0014122375287115574
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012001_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012001_3_24hr.npz
NaN value num: 0
Iteration: 816, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480988383293152, gen p mean: -0.04618872329592705, mean p set: 0.4485791027545929
loss_pred:0.017275825142860413, decouple_loss:0.0012901572044938803
The modified gen p mean: 0.4509420394897461, gen p mean: -0.04321872442960739, mean p set: 0.4514223337173462The modified gen p mean: 0.4507182240486145, gen p mean: -0.046799436211586, mean p set: 0.4511985182762146
loss_pred:0.017178019508719444, decouple_loss:0.0012242022203281522
loss_pred:0.0170859694480896, decouple_loss:0.0012988117523491383
Iteration: 817, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44978296756744385, gen p mean: -0.03816981986165047, mean p set: 0.45026326179504395
loss_pred:0.017703816294670105, decouple_loss:0.0013198427623137832
The modified gen p mean: 0.44800224900245667, gen p mean: -0.043324653059244156, mean p set: 0.44848257303237915The modified gen p mean: 0.4497433304786682, gen p mean: -0.03643219545483589, mean p set: 0.4502235949039459
loss_pred:0.01668696664273739, decouple_loss:0.0012654727324843407
loss_pred:0.017153872177004814, decouple_loss:0.001321200979873538
Iteration: 818, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44808316230773926, gen p mean: -0.0447499118745327, mean p set: 0.44856342673301697
loss_pred:0.01672348566353321, decouple_loss:0.0012188985710963607
The modified gen p mean: 0.4506099224090576, gen p mean: -0.04050169512629509, mean p set: 0.4510902166366577The modified gen p mean: 0.44839081168174744, gen p mean: -0.04387775808572769, mean p set: 0.44887110590934753
loss_pred:0.01718439906835556, decouple_loss:0.0012472926173359156
loss_pred:0.017619557678699493, decouple_loss:0.0012316692154854536
Iteration: 819, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45107895135879517, gen p mean: -0.04032799229025841, mean p set: 0.45155924558639526
loss_pred:0.017042240127921104, decouple_loss:0.0012796714436262846
The modified gen p mean: 0.44922271370887756, gen p mean: -0.044645942747592926, mean p set: 0.4497029781341553The modified gen p mean: 0.4494893550872803, gen p mean: -0.04042994603514671, mean p set: 0.449969619512558
loss_pred:0.016633646562695503, decouple_loss:0.0012384405126795173
loss_pred:0.017744310200214386, decouple_loss:0.0010952798184007406
Iteration: 820, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45020046830177307, gen p mean: -0.03882645070552826, mean p set: 0.4506807327270508
loss_pred:0.0171335581690073, decouple_loss:0.001311830710619688
The modified gen p mean: 0.4504612982273102, gen p mean: -0.04536379873752594, mean p set: 0.4509415924549103The modified gen p mean: 0.4483596682548523, gen p mean: -0.040788229554891586, mean p set: 0.44883993268013
loss_pred:0.016984762623906136, decouple_loss:0.0013531030854210258
loss_pred:0.01650579646229744, decouple_loss:0.0012441091239452362
2023-05-01 01:29:27 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.050771210342645645, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04579838737845421, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.04651452600955963, mean p set: 0.4500633478164673
loss_pred:0.01843450218439102, decouple_loss:0.0012066175695508718
loss_pred:0.017339149489998817, decouple_loss:0.0012161046033725142
loss_pred:0.017491990700364113, decouple_loss:0.0011770300334319472
WV_0_PC_1_EH_0_PS_40, loss: 0.017815209925174713, avg_mse: 0.025554323568940163
current test mse: 0.025554
Iteration: 821, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4517090320587158, gen p mean: -0.04838069900870323, mean p set: 0.4521893560886383
The modified gen p mean: 0.44996246695518494, gen p mean: -0.04468397796154022, mean p set: 0.45044276118278503
The modified gen p mean: 0.4512201249599457, gen p mean: -0.04502438008785248, mean p set: 0.4517004191875458
loss_pred:0.016932375729084015, decouple_loss:0.001100210822187364
loss_pred:0.017267001792788506, decouple_loss:0.0011549972696229815
loss_pred:0.016639137640595436, decouple_loss:0.0010457017924636602
Iteration: 822, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507247507572174, gen p mean: -0.049681778997182846, mean p set: 0.4512050449848175
loss_pred:0.01680539920926094, decouple_loss:0.0011909648310393095
The modified gen p mean: 0.45202067494392395, gen p mean: -0.05218400061130524, mean p set: 0.45250096917152405The modified gen p mean: 0.4516884684562683, gen p mean: -0.05161362513899803, mean p set: 0.4521687626838684
loss_pred:0.017376510426402092, decouple_loss:0.0012437382247298956
loss_pred:0.01733461767435074, decouple_loss:0.0012324631679803133
Iteration: 823, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486495554447174, gen p mean: -0.04311556741595268, mean p set: 0.4491298198699951
loss_pred:0.01685035601258278, decouple_loss:0.001181975589133799
The modified gen p mean: 0.4476472735404968, gen p mean: -0.0468762144446373, mean p set: 0.44812753796577454The modified gen p mean: 0.451168417930603, gen p mean: -0.044540341943502426, mean p set: 0.4516487121582031
loss_pred:0.01722017116844654, decouple_loss:0.0011876908829435706
loss_pred:0.0175156407058239, decouple_loss:0.0010910970158874989
Iteration: 824, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44832876324653625, gen p mean: -0.047297537326812744, mean p set: 0.44880905747413635
loss_pred:0.016951777040958405, decouple_loss:0.0010176798095926642
The modified gen p mean: 0.450158029794693, gen p mean: -0.04099148139357567, mean p set: 0.4506383240222931The modified gen p mean: 0.45139288902282715, gen p mean: -0.04668905586004257, mean p set: 0.45187318325042725
loss_pred:0.01701129972934723, decouple_loss:0.0010370647069066763loss_pred:0.016789741814136505, decouple_loss:0.0011540045961737633
Iteration: 825, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4506893754005432, gen p mean: -0.04804147034883499, mean p set: 0.4511696398258209
loss_pred:0.017239809036254883, decouple_loss:0.0011550372000783682
The modified gen p mean: 0.4499184191226959, gen p mean: -0.04317683354020119, mean p set: 0.450398713350296The modified gen p mean: 0.45187345147132874, gen p mean: -0.04691610112786293, mean p set: 0.45235374569892883
loss_pred:0.01655879244208336, decouple_loss:0.0011333073489367962
loss_pred:0.01667226478457451, decouple_loss:0.0011540234554558992
Iteration: 826, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44953253865242004, gen p mean: -0.03984634205698967, mean p set: 0.45001283288002014
loss_pred:0.0165378637611866, decouple_loss:0.001128343865275383
The modified gen p mean: 0.4500531256198883, gen p mean: -0.03886420279741287, mean p set: 0.4505334198474884The modified gen p mean: 0.45037874579429626, gen p mean: -0.037333931773900986, mean p set: 0.45085906982421875
loss_pred:0.017087971791625023, decouple_loss:0.000999867683276534
loss_pred:0.017194699496030807, decouple_loss:0.0010081555228680372
Iteration: 827, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45060259103775024, gen p mean: -0.03509867936372757, mean p set: 0.45108291506767273
loss_pred:0.017071152105927467, decouple_loss:0.0010740592842921615
The modified gen p mean: 0.44859692454338074, gen p mean: -0.042456503957509995, mean p set: 0.44907721877098083The modified gen p mean: 0.4487482011318207, gen p mean: -0.039874594658613205, mean p set: 0.44922852516174316
loss_pred:0.016628999263048172, decouple_loss:0.0010741028236225247
loss_pred:0.017116589471697807, decouple_loss:0.0011261535109952092
Iteration: 828, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4515479803085327, gen p mean: -0.03986944258213043, mean p set: 0.4520282447338104
loss_pred:0.017048969864845276, decouple_loss:0.001085895230062306
The modified gen p mean: 0.45011767745018005, gen p mean: -0.03624195605516434, mean p set: 0.45059797167778015The modified gen p mean: 0.4488142132759094, gen p mean: -0.036058228462934494, mean p set: 0.44929447770118713
loss_pred:0.017377609387040138, decouple_loss:0.0010274061933159828
loss_pred:0.01721656136214733, decouple_loss:0.0010175453498959541
Iteration: 829, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44852709770202637, gen p mean: -0.04005361720919609, mean p set: 0.44900739192962646
loss_pred:0.01726260967552662, decouple_loss:0.0011524700094014406
The modified gen p mean: 0.44909119606018066, gen p mean: -0.03959657996892929, mean p set: 0.44957149028778076The modified gen p mean: 0.45025596022605896, gen p mean: -0.04099690169095993, mean p set: 0.45073628425598145
loss_pred:0.01745082437992096, decouple_loss:0.0010655256919562817
loss_pred:0.016860395669937134, decouple_loss:0.0011992069194093347
Iteration: 830, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45109590888023376, gen p mean: -0.038741398602724075, mean p set: 0.45157620310783386
loss_pred:0.01715840771794319, decouple_loss:0.001011289656162262
The modified gen p mean: 0.451642781496048, gen p mean: -0.047366492450237274, mean p set: 0.4521230459213257The modified gen p mean: 0.45214927196502686, gen p mean: -0.04284369945526123, mean p set: 0.45262959599494934
loss_pred:0.016296129673719406, decouple_loss:0.0011367318220436573
loss_pred:0.017023742198944092, decouple_loss:0.0011658985167741776
2023-05-01 01:31:20 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.049301110208034515, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04456649720668793, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.045376699417829514, mean p set: 0.4500633478164673
loss_pred:0.01841939240694046, decouple_loss:0.0011187958298251033
loss_pred:0.017376363277435303, decouple_loss:0.0011040845420211554
loss_pred:0.017500681802630424, decouple_loss:0.0011088416213169694
WV_0_PC_1_EH_0_PS_40, loss: 0.01782100833952427, avg_mse: 0.025591757148504257
current test mse: 0.025592
Iteration: 831, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45210736989974976, gen p mean: -0.04914100468158722, mean p set: 0.45258763432502747
The modified gen p mean: 0.4482850432395935, gen p mean: -0.043718282133340836, mean p set: 0.4487653374671936
The modified gen p mean: 0.4497833847999573, gen p mean: -0.04185876250267029, mean p set: 0.4502636790275574
loss_pred:0.016491113230586052, decouple_loss:0.0009836007375270128
loss_pred:0.01714114099740982, decouple_loss:0.0011797884944826365
loss_pred:0.016908256337046623, decouple_loss:0.0010964366374537349
Iteration: 832, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45140671730041504, gen p mean: -0.04661978781223297, mean p set: 0.45188701152801514
loss_pred:0.01652023009955883, decouple_loss:0.0010226592421531677
The modified gen p mean: 0.450859397649765, gen p mean: -0.049216724932193756, mean p set: 0.4513396918773651The modified gen p mean: 0.4477993845939636, gen p mean: -0.04856665059924126, mean p set: 0.4482796788215637
loss_pred:0.016388513147830963, decouple_loss:0.0010735926916822791
loss_pred:0.016640352085232735, decouple_loss:0.0011316118761897087
Iteration: 833, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4510978162288666, gen p mean: -0.048374224454164505, mean p set: 0.4515781104564667
loss_pred:0.016992896795272827, decouple_loss:0.0011136983521282673
The modified gen p mean: 0.44979265332221985, gen p mean: -0.043706879019737244, mean p set: 0.45027294754981995The modified gen p mean: 0.449003666639328, gen p mean: -0.04811403527855873, mean p set: 0.4494839310646057
loss_pred:0.017122546210885048, decouple_loss:0.0010890625417232513
loss_pred:0.016317153349518776, decouple_loss:0.0010587162105366588
Iteration: 834, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44834089279174805, gen p mean: -0.046692781150341034, mean p set: 0.44882118701934814
loss_pred:0.016928544268012047, decouple_loss:0.0011491019977256656
The modified gen p mean: 0.45157793164253235, gen p mean: -0.04612273722887039, mean p set: 0.45205825567245483The modified gen p mean: 0.4486802816390991, gen p mean: -0.04615270346403122, mean p set: 0.4491605758666992
loss_pred:0.01716451905667782, decouple_loss:0.0010975196491926908
loss_pred:0.016628585755825043, decouple_loss:0.0011275113793089986
Iteration: 835, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45089951157569885, gen p mean: -0.05028551444411278, mean p set: 0.45137983560562134The modified gen p mean: 0.44793349504470825, gen p mean: -0.04889616370201111, mean p set: 0.44841381907463074
The modified gen p mean: 0.45045652985572815, gen p mean: -0.04289413243532181, mean p set: 0.45093685388565063
loss_pred:0.016683755442500114, decouple_loss:0.0010444663930684328
loss_pred:0.016606757417321205, decouple_loss:0.0009939107112586498loss_pred:0.017213063314557076, decouple_loss:0.001017280388623476
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012014_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012014_3_24hr.npz
NaN value num: 0
Iteration: 836, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44673365354537964, gen p mean: -0.04431084170937538, mean p set: 0.4472139775753021
loss_pred:0.01744498685002327, decouple_loss:0.0011441843817010522
The modified gen p mean: 0.44628268480300903, gen p mean: -0.048467062413692474, mean p set: 0.4467630088329315The modified gen p mean: 0.4462166130542755, gen p mean: -0.049253445118665695, mean p set: 0.4466968774795532
loss_pred:0.018057066947221756, decouple_loss:0.0011217144783586264
loss_pred:0.018018415197730064, decouple_loss:0.001207994413562119
Iteration: 837, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469219148159027, gen p mean: -0.044223301112651825, mean p set: 0.4474022090435028
The modified gen p mean: 0.44828104972839355, gen p mean: -0.047647520899772644, mean p set: 0.44876134395599365
loss_pred:0.018482506275177002, decouple_loss:0.001101180911064148
loss_pred:0.01906888373196125, decouple_loss:0.0010515815811231732
The modified gen p mean: 0.4467674791812897, gen p mean: -0.04556224122643471, mean p set: 0.44724777340888977
loss_pred:0.01746213622391224, decouple_loss:0.001146363909356296
Iteration: 838, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44753193855285645, gen p mean: -0.055436696857213974, mean p set: 0.44801223278045654
loss_pred:0.018350867554545403, decouple_loss:0.0011438422370702028
The modified gen p mean: 0.44763386249542236, gen p mean: -0.05379997193813324, mean p set: 0.44811415672302246The modified gen p mean: 0.4461723566055298, gen p mean: -0.05523715540766716, mean p set: 0.4466526508331299
loss_pred:0.018512137234210968, decouple_loss:0.0012144227512180805
loss_pred:0.017336027696728706, decouple_loss:0.0011483781272545457
Iteration: 839, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466865062713623, gen p mean: -0.04750024899840355, mean p set: 0.4471668004989624
loss_pred:0.01813109964132309, decouple_loss:0.0013275580713525414
The modified gen p mean: 0.4487219452857971, gen p mean: -0.05421971157193184, mean p set: 0.4492022693157196The modified gen p mean: 0.44592970609664917, gen p mean: -0.05596844106912613, mean p set: 0.44641000032424927
loss_pred:0.01784280315041542, decouple_loss:0.0012295643100515008
loss_pred:0.018536170944571495, decouple_loss:0.001207950757816434
Iteration: 840, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44829297065734863, gen p mean: -0.054011814296245575, mean p set: 0.44877323508262634
loss_pred:0.018133865669369698, decouple_loss:0.0011329019907861948
The modified gen p mean: 0.44689828157424927, gen p mean: -0.051924385130405426, mean p set: 0.44737857580184937The modified gen p mean: 0.4468585252761841, gen p mean: -0.057137489318847656, mean p set: 0.4473387897014618
loss_pred:0.01818414404988289, decouple_loss:0.0011943066492676735
loss_pred:0.017284417524933815, decouple_loss:0.0011681132018566132
2023-05-01 01:33:54 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.06044171005487442, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.05513285845518112, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.056079138070344925, mean p set: 0.4500633478164673
loss_pred:0.018448365852236748, decouple_loss:0.0010875349398702383
loss_pred:0.017396166920661926, decouple_loss:0.0010892122518271208
loss_pred:0.01747157797217369, decouple_loss:0.001034399727359414
WV_0_PC_1_EH_0_PS_40, loss: 0.01782555691897869, avg_mse: 0.025597836822271347
current test mse: 0.025598
Iteration: 841, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44731974601745605, gen p mean: -0.059067390859127045, mean p set: 0.44780007004737854
The modified gen p mean: 0.4475215971469879, gen p mean: -0.057100359350442886, mean p set: 0.448001891374588
The modified gen p mean: 0.4489080309867859, gen p mean: -0.053941380232572556, mean p set: 0.449388325214386
loss_pred:0.018050076439976692, decouple_loss:0.0010838847374543548
loss_pred:0.017480822280049324, decouple_loss:0.0010945965768769383loss_pred:0.018515681847929955, decouple_loss:0.0010910334531217813
Iteration: 842, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44678717851638794, gen p mean: -0.05517381802201271, mean p set: 0.44726744294166565
loss_pred:0.01741853542625904, decouple_loss:0.0011542483698576689
The modified gen p mean: 0.44622448086738586, gen p mean: -0.05469174310564995, mean p set: 0.44670480489730835The modified gen p mean: 0.4469979405403137, gen p mean: -0.058389291167259216, mean p set: 0.4474782347679138
loss_pred:0.017284385859966278, decouple_loss:0.0010924042435362935
loss_pred:0.0175107903778553, decouple_loss:0.0010877561289817095
Iteration: 843, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469245970249176, gen p mean: -0.057715434581041336, mean p set: 0.4474048614501953
loss_pred:0.017449302598834038, decouple_loss:0.0011016136268153787
The modified gen p mean: 0.44634953141212463, gen p mean: -0.05735134333372116, mean p set: 0.44682982563972473The modified gen p mean: 0.44886305928230286, gen p mean: -0.0590655691921711, mean p set: 0.44934335350990295
loss_pred:0.018598251044750214, decouple_loss:0.0012112854747101665
loss_pred:0.017650727182626724, decouple_loss:0.001121063600294292
Iteration: 844, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473405182361603, gen p mean: -0.059505969285964966, mean p set: 0.4478208124637604
loss_pred:0.018164074048399925, decouple_loss:0.001097178435884416
The modified gen p mean: 0.44618141651153564, gen p mean: -0.05376475304365158, mean p set: 0.44666171073913574The modified gen p mean: 0.44714465737342834, gen p mean: -0.05088721215724945, mean p set: 0.44762495160102844
loss_pred:0.017527980729937553, decouple_loss:0.000992541783489287
loss_pred:0.016917172819375992, decouple_loss:0.0010343025205656886
Iteration: 845, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4460732042789459, gen p mean: -0.05374181270599365, mean p set: 0.446553498506546
loss_pred:0.017367321997880936, decouple_loss:0.001070422469638288
The modified gen p mean: 0.44708576798439026, gen p mean: -0.055650703608989716, mean p set: 0.44756606221199036The modified gen p mean: 0.44834718108177185, gen p mean: -0.05379749834537506, mean p set: 0.44882747530937195
loss_pred:0.0182072501629591, decouple_loss:0.0011681703617796302
loss_pred:0.017063697800040245, decouple_loss:0.0010529076680541039
Iteration: 846, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477894604206085, gen p mean: -0.048592109233140945, mean p set: 0.44826972484588623
loss_pred:0.01679178886115551, decouple_loss:0.0009936485439538956
The modified gen p mean: 0.445794939994812, gen p mean: -0.05725998431444168, mean p set: 0.4462752044200897The modified gen p mean: 0.44688180088996887, gen p mean: -0.05408332496881485, mean p set: 0.4473620653152466
loss_pred:0.01793566346168518, decouple_loss:0.0010104194516316056
loss_pred:0.017722325399518013, decouple_loss:0.000991137116216123
Iteration: 847, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4463682472705841, gen p mean: -0.052979081869125366, mean p set: 0.4468485414981842
loss_pred:0.016754498705267906, decouple_loss:0.0009413750958628953
The modified gen p mean: 0.4477754533290863, gen p mean: -0.050867702811956406, mean p set: 0.4482557475566864The modified gen p mean: 0.44835275411605835, gen p mean: -0.04744928330183029, mean p set: 0.44883307814598083
loss_pred:0.018482685089111328, decouple_loss:0.0009399858536198735
loss_pred:0.01785636879503727, decouple_loss:0.0010229302570223808
Iteration: 848, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44600510597229004, gen p mean: -0.04865230619907379, mean p set: 0.44648540019989014
loss_pred:0.018060816451907158, decouple_loss:0.0010615232167765498
The modified gen p mean: 0.44636473059654236, gen p mean: -0.05128243938088417, mean p set: 0.44684502482414246The modified gen p mean: 0.4469447135925293, gen p mean: -0.04484904557466507, mean p set: 0.4474250078201294
loss_pred:0.01683070696890354, decouple_loss:0.0009570819092914462
loss_pred:0.018181156367063522, decouple_loss:0.0011063595302402973
Iteration: 849, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44708535075187683, gen p mean: -0.050453297793865204, mean p set: 0.44756564497947693
loss_pred:0.016652578487992287, decouple_loss:0.0009605058585293591
The modified gen p mean: 0.4482387900352478, gen p mean: -0.04825169965624809, mean p set: 0.4487190544605255The modified gen p mean: 0.44614875316619873, gen p mean: -0.05467583239078522, mean p set: 0.44662904739379883
loss_pred:0.01821999065577984, decouple_loss:0.0011500235414132476
loss_pred:0.017295917496085167, decouple_loss:0.001024461816996336
Iteration: 850, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4463445842266083, gen p mean: -0.0497465580701828, mean p set: 0.4468248784542084
loss_pred:0.01695931702852249, decouple_loss:0.0010242792777717113
The modified gen p mean: 0.4477706551551819, gen p mean: -0.051325369626283646, mean p set: 0.448250949382782The modified gen p mean: 0.4461558759212494, gen p mean: -0.05323890224099159, mean p set: 0.4466361403465271
loss_pred:0.017440609633922577, decouple_loss:0.0009504097979515791
loss_pred:0.01821616291999817, decouple_loss:0.0010377096477895975
2023-05-01 01:35:47 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.05224006995558739, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04703458771109581, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.0479135736823082, mean p set: 0.4500633478164673
loss_pred:0.01843305490911007, decouple_loss:0.0010297892149537802
loss_pred:0.017353177070617676, decouple_loss:0.0009981509065255523
loss_pred:0.017443865537643433, decouple_loss:0.0009877341799438
WV_0_PC_1_EH_0_PS_40, loss: 0.017793627455830574, avg_mse: 0.025532910600304604
current test mse: 0.025533
Iteration: 851, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4462904930114746, gen p mean: -0.05076107010245323, mean p set: 0.4467707574367523
The modified gen p mean: 0.4462824761867523, gen p mean: -0.05199894309043884, mean p set: 0.4467627704143524
The modified gen p mean: 0.4487491250038147, gen p mean: -0.04907476529479027, mean p set: 0.4492294192314148
loss_pred:0.01739273965358734, decouple_loss:0.0009432858205400407
loss_pred:0.017644885927438736, decouple_loss:0.0009357098024338484
loss_pred:0.018326012417674065, decouple_loss:0.0009641321958042681
Iteration: 852, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481840431690216, gen p mean: -0.048223838210105896, mean p set: 0.4486643373966217
loss_pred:0.018513061106204987, decouple_loss:0.0009436270338483155
The modified gen p mean: 0.4473279118537903, gen p mean: -0.04462427645921707, mean p set: 0.4478082060813904
The modified gen p mean: 0.44776710867881775, gen p mean: -0.051867127418518066, mean p set: 0.44824743270874023
loss_pred:0.01828964613378048, decouple_loss:0.0009300662786699831
loss_pred:0.017375778406858444, decouple_loss:0.0009275468182750046
Iteration: 853, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470100998878479, gen p mean: -0.04836367443203926, mean p set: 0.4474903643131256
loss_pred:0.016926061362028122, decouple_loss:0.0009568515815772116
The modified gen p mean: 0.44682130217552185, gen p mean: -0.052537161856889725, mean p set: 0.44730156660079956The modified gen p mean: 0.4462626874446869, gen p mean: -0.050005875527858734, mean p set: 0.446742981672287
loss_pred:0.01769339106976986, decouple_loss:0.0009551061666570604
loss_pred:0.017748983576893806, decouple_loss:0.0009037986746989191
Iteration: 854, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44780921936035156, gen p mean: -0.048067349940538406, mean p set: 0.44828951358795166
loss_pred:0.017113877460360527, decouple_loss:0.0010245043085888028
The modified gen p mean: 0.4480167031288147, gen p mean: -0.050960347056388855, mean p set: 0.4484969973564148The modified gen p mean: 0.44751158356666565, gen p mean: -0.052443623542785645, mean p set: 0.44799190759658813
loss_pred:0.018301011994481087, decouple_loss:0.0009530669776722789
loss_pred:0.016585785895586014, decouple_loss:0.0010174870258197188
Iteration: 855, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44848915934562683, gen p mean: -0.052728865295648575, mean p set: 0.4489694833755493
loss_pred:0.018207848072052002, decouple_loss:0.0011030003661289811
The modified gen p mean: 0.44659125804901123, gen p mean: -0.05294175073504448, mean p set: 0.44707152247428894The modified gen p mean: 0.44858792424201965, gen p mean: -0.047840069979429245, mean p set: 0.44906821846961975
loss_pred:0.017041055485606194, decouple_loss:0.0009574629948474467
loss_pred:0.01692306436598301, decouple_loss:0.0008924886933527887
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012011_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012011_3_24hr.npz
NaN value num: 0
Iteration: 856, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4510660469532013, gen p mean: -0.04122838005423546, mean p set: 0.4515463411808014
loss_pred:0.01703922636806965, decouple_loss:0.0011083873687312007
The modified gen p mean: 0.45159170031547546, gen p mean: -0.04515055939555168, mean p set: 0.45207199454307556The modified gen p mean: 0.4490896165370941, gen p mean: -0.051497142761945724, mean p set: 0.44956985116004944
loss_pred:0.01723637245595455, decouple_loss:0.001085439813323319
loss_pred:0.017001062631607056, decouple_loss:0.0010738675482571125
Iteration: 857, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500146210193634, gen p mean: -0.04071328788995743, mean p set: 0.4504949152469635
The modified gen p mean: 0.45027145743370056, gen p mean: -0.04447603598237038, mean p set: 0.45075175166130066
The modified gen p mean: 0.4499324858188629, gen p mean: -0.04209696501493454, mean p set: 0.4504128098487854
loss_pred:0.016940888017416, decouple_loss:0.0011040789540857077
loss_pred:0.016981348395347595, decouple_loss:0.00109111366327852loss_pred:0.01812705583870411, decouple_loss:0.0011383293895050883
Iteration: 858, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45027074217796326, gen p mean: -0.04129103198647499, mean p set: 0.45075103640556335
loss_pred:0.016649415716528893, decouple_loss:0.0011135587701573968
The modified gen p mean: 0.44911232590675354, gen p mean: -0.04901176691055298, mean p set: 0.449592649936676The modified gen p mean: 0.45103469491004944, gen p mean: -0.04467037320137024, mean p set: 0.45151498913764954
loss_pred:0.017204241827130318, decouple_loss:0.0012064717011526227
loss_pred:0.016636420041322708, decouple_loss:0.0012039905413985252
Iteration: 859, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44895103573799133, gen p mean: -0.0396433062851429, mean p set: 0.44943130016326904
loss_pred:0.017175931483507156, decouple_loss:0.0011391197331249714
The modified gen p mean: 0.44981467723846436, gen p mean: -0.03899229317903519, mean p set: 0.45029497146606445The modified gen p mean: 0.4490172863006592, gen p mean: -0.04177434369921684, mean p set: 0.4494975507259369
loss_pred:0.016608139500021935, decouple_loss:0.0010826843790709972
loss_pred:0.016697121784090996, decouple_loss:0.0011133007938042283
Iteration: 860, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490228593349457, gen p mean: -0.03778091073036194, mean p set: 0.4495031237602234
loss_pred:0.016331510618329048, decouple_loss:0.0010626171715557575
The modified gen p mean: 0.4498765468597412, gen p mean: -0.03999723866581917, mean p set: 0.4503568708896637The modified gen p mean: 0.45033037662506104, gen p mean: -0.03991386294364929, mean p set: 0.45081067085266113
loss_pred:0.016910340636968613, decouple_loss:0.0010135909542441368
loss_pred:0.016579585149884224, decouple_loss:0.001064870972186327
2023-05-01 01:38:20 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.04767923057079315, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04256447032094002, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.04351857304573059, mean p set: 0.4500633478164673
loss_pred:0.018396198749542236, decouple_loss:0.0012352957855910063
loss_pred:0.017340777441859245, decouple_loss:0.0011988922487944365
loss_pred:0.017476307228207588, decouple_loss:0.0012599381152540445
WV_0_PC_1_EH_0_PS_40, loss: 0.01779933087527752, avg_mse: 0.0255519300699234
current test mse: 0.025552
Iteration: 861, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505166709423065, gen p mean: -0.0361165814101696, mean p set: 0.450996994972229
The modified gen p mean: 0.450730562210083, gen p mean: -0.035913508385419846, mean p set: 0.4512108564376831
The modified gen p mean: 0.45135101675987244, gen p mean: -0.04239499568939209, mean p set: 0.45183131098747253
loss_pred:0.015672804787755013, decouple_loss:0.0011014359770342708
loss_pred:0.016672750934958458, decouple_loss:0.001141166314482689
loss_pred:0.0164567232131958, decouple_loss:0.0011720623588189483
Iteration: 862, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45193350315093994, gen p mean: -0.03289773687720299, mean p set: 0.45241379737854004
loss_pred:0.016854407265782356, decouple_loss:0.0009873334784060717
The modified gen p mean: 0.44990256428718567, gen p mean: -0.032344408333301544, mean p set: 0.45038288831710815The modified gen p mean: 0.44896262884140015, gen p mean: -0.036648038774728775, mean p set: 0.44944292306900024
loss_pred:0.016297472640872, decouple_loss:0.0010452372953295708
loss_pred:0.017167087644338608, decouple_loss:0.0010542430682107806
Iteration: 863, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501987099647522, gen p mean: -0.03445516154170036, mean p set: 0.4506790041923523
loss_pred:0.01656530424952507, decouple_loss:0.0010892050340771675
The modified gen p mean: 0.451831579208374, gen p mean: -0.03502333164215088, mean p set: 0.4523118734359741The modified gen p mean: 0.4500882923603058, gen p mean: -0.03599479794502258, mean p set: 0.4505685865879059
loss_pred:0.016827164217829704, decouple_loss:0.0010378950973972678
loss_pred:0.017925046384334564, decouple_loss:0.001185298664495349
Iteration: 864, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499701261520386, gen p mean: -0.037374503910541534, mean p set: 0.45045042037963867
loss_pred:0.016793619841337204, decouple_loss:0.0010606790892779827
The modified gen p mean: 0.45062196254730225, gen p mean: -0.03782827779650688, mean p set: 0.45110228657722473The modified gen p mean: 0.4492666721343994, gen p mean: -0.041475262492895126, mean p set: 0.4497469365596771
loss_pred:0.016773805022239685, decouple_loss:0.0010762092424556613
loss_pred:0.01767222210764885, decouple_loss:0.0011340529890730977
Iteration: 865, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504881501197815, gen p mean: -0.03673407435417175, mean p set: 0.4509684145450592
The modified gen p mean: 0.449672669172287, gen p mean: -0.038804616779088974, mean p set: 0.4501529335975647
loss_pred:0.017027823254466057, decouple_loss:0.001087651471607387
loss_pred:0.016576001420617104, decouple_loss:0.0010600524256005883
The modified gen p mean: 0.4506820738315582, gen p mean: -0.03730204328894615, mean p set: 0.45116233825683594
loss_pred:0.01677613891661167, decouple_loss:0.0010010384721681476
Iteration: 866, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45185530185699463, gen p mean: -0.039356060326099396, mean p set: 0.4523356258869171
The modified gen p mean: 0.4500886797904968, gen p mean: -0.041491080075502396, mean p set: 0.4505689740180969
loss_pred:0.016476944088935852, decouple_loss:0.001148369861766696
loss_pred:0.016919303685426712, decouple_loss:0.0011114664375782013
The modified gen p mean: 0.44838088750839233, gen p mean: -0.03908092901110649, mean p set: 0.44886115193367004
loss_pred:0.016656627878546715, decouple_loss:0.0010533753084018826
Iteration: 867, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492405652999878, gen p mean: -0.04789062589406967, mean p set: 0.4497208595275879
loss_pred:0.017320286482572556, decouple_loss:0.0011108495527878404
The modified gen p mean: 0.4495488703250885, gen p mean: -0.0403389073908329, mean p set: 0.4500291645526886The modified gen p mean: 0.4494132697582245, gen p mean: -0.0466194786131382, mean p set: 0.4498935639858246
loss_pred:0.016507912427186966, decouple_loss:0.0010224285069853067
loss_pred:0.016697484999895096, decouple_loss:0.0010737027041614056
Iteration: 868, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44988730549812317, gen p mean: -0.047200702130794525, mean p set: 0.45036759972572327
loss_pred:0.016826707869768143, decouple_loss:0.0010814110282808542
The modified gen p mean: 0.45033106207847595, gen p mean: -0.05111471936106682, mean p set: 0.45081138610839844The modified gen p mean: 0.4491910934448242, gen p mean: -0.04452010244131088, mean p set: 0.4496713876724243
loss_pred:0.016766708344221115, decouple_loss:0.0011089558247476816
loss_pred:0.01699141412973404, decouple_loss:0.0011076907394453883
Iteration: 869, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45067375898361206, gen p mean: -0.05408904701471329, mean p set: 0.45115405321121216
loss_pred:0.015959221869707108, decouple_loss:0.0010897833853960037
The modified gen p mean: 0.4498192071914673, gen p mean: -0.05436279624700546, mean p set: 0.45029953122138977The modified gen p mean: 0.4513145387172699, gen p mean: -0.04356469213962555, mean p set: 0.45179483294487
loss_pred:0.01650233566761017, decouple_loss:0.0010347749339416623
loss_pred:0.016402406617999077, decouple_loss:0.0011153175728395581
Iteration: 870, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45050114393234253, gen p mean: -0.04699535295367241, mean p set: 0.45098140835762024
loss_pred:0.016479335725307465, decouple_loss:0.0010357240680605173
The modified gen p mean: 0.45037171244621277, gen p mean: -0.044760704040527344, mean p set: 0.4508519768714905The modified gen p mean: 0.45003724098205566, gen p mean: -0.04670719802379608, mean p set: 0.45051753520965576
loss_pred:0.01578277163207531, decouple_loss:0.0010467832908034325
loss_pred:0.01708597131073475, decouple_loss:0.0011101010022684932
2023-05-01 01:40:14 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.05488407611846924, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.05018896609544754, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.0508972704410553, mean p set: 0.4500633478164673
loss_pred:0.0184063371270895, decouple_loss:0.0011351552093401551
loss_pred:0.01733948290348053, decouple_loss:0.001163229113444686
loss_pred:0.017532046884298325, decouple_loss:0.0011679299641400576
WV_0_PC_1_EH_0_PS_40, loss: 0.01781706139445305, avg_mse: 0.02558097057044506
current test mse: 0.025581
Iteration: 871, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45075684785842896, gen p mean: -0.04428960382938385, mean p set: 0.45123711228370667
The modified gen p mean: 0.45020654797554016, gen p mean: -0.05163218826055527, mean p set: 0.45068684220314026
The modified gen p mean: 0.45214927196502686, gen p mean: -0.046596694737672806, mean p set: 0.45262953639030457
loss_pred:0.0167507566511631, decouple_loss:0.001028064638376236
loss_pred:0.017571870237588882, decouple_loss:0.0010850881226360798
loss_pred:0.016147667542099953, decouple_loss:0.0011026173597201705
Iteration: 872, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502185583114624, gen p mean: -0.04221238195896149, mean p set: 0.4506988525390625
The modified gen p mean: 0.4509523808956146, gen p mean: -0.04289085045456886, mean p set: 0.4514326751232147
loss_pred:0.01639079488813877, decouple_loss:0.001040362287312746
loss_pred:0.016227751970291138, decouple_loss:0.0010002180933952332
The modified gen p mean: 0.4502076208591461, gen p mean: -0.04504627734422684, mean p set: 0.4506879150867462
loss_pred:0.01674521714448929, decouple_loss:0.0010334292892366648
Iteration: 873, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44979915022850037, gen p mean: -0.04572189971804619, mean p set: 0.45027947425842285
loss_pred:0.016288693994283676, decouple_loss:0.0009449234930798411
The modified gen p mean: 0.4491015374660492, gen p mean: -0.04336698353290558, mean p set: 0.4495818316936493
The modified gen p mean: 0.4493039548397064, gen p mean: -0.04488690569996834, mean p set: 0.4497842490673065
loss_pred:0.016969220712780952, decouple_loss:0.0009894634131342173
loss_pred:0.01654181443154812, decouple_loss:0.0009770850883796811
Iteration: 874, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497401714324951, gen p mean: -0.0422884002327919, mean p set: 0.4502204656600952
loss_pred:0.016276013106107712, decouple_loss:0.001019845250993967
The modified gen p mean: 0.4501641094684601, gen p mean: -0.035481639206409454, mean p set: 0.4506444036960602The modified gen p mean: 0.4511227011680603, gen p mean: -0.04177916422486305, mean p set: 0.4516029953956604
loss_pred:0.016241056844592094, decouple_loss:0.0009863071609288454
loss_pred:0.0165305957198143, decouple_loss:0.0010164332343265414
Iteration: 875, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495244026184082, gen p mean: -0.03810124471783638, mean p set: 0.4500047266483307
loss_pred:0.016616811975836754, decouple_loss:0.0010641089174896479
The modified gen p mean: 0.4499249756336212, gen p mean: -0.03494714945554733, mean p set: 0.4504052996635437The modified gen p mean: 0.44838547706604004, gen p mean: -0.03813323378562927, mean p set: 0.4488658010959625
loss_pred:0.0166626013815403, decouple_loss:0.0010353033430874348
loss_pred:0.016721801832318306, decouple_loss:0.0009654159075580537
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012007_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012007_3_24hr.npz
NaN value num: 0
Iteration: 876, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478886127471924, gen p mean: -0.049980808049440384, mean p set: 0.44836893677711487
loss_pred:0.017502082511782646, decouple_loss:0.0010507554979994893
The modified gen p mean: 0.4457228481769562, gen p mean: -0.04590580612421036, mean p set: 0.44620317220687866The modified gen p mean: 0.4486711323261261, gen p mean: -0.04983368515968323, mean p set: 0.4491514265537262
loss_pred:0.01782732643187046, decouple_loss:0.0010071340948343277
loss_pred:0.016843466088175774, decouple_loss:0.001033848850056529
Iteration: 877, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484260678291321, gen p mean: -0.04731297492980957, mean p set: 0.4489063620567322
loss_pred:0.01756688393652439, decouple_loss:0.0009779756655916572
The modified gen p mean: 0.44702789187431335, gen p mean: -0.04907598719000816, mean p set: 0.44750818610191345The modified gen p mean: 0.44663500785827637, gen p mean: -0.04395371302962303, mean p set: 0.4471152722835541
loss_pred:0.017690028995275497, decouple_loss:0.0009989595273509622
loss_pred:0.017719916999340057, decouple_loss:0.0010990927694365382
Iteration: 878, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471132159233093, gen p mean: -0.05139412730932236, mean p set: 0.4475935399532318
loss_pred:0.01746005192399025, decouple_loss:0.0010002610506489873
The modified gen p mean: 0.44723790884017944, gen p mean: -0.045170798897743225, mean p set: 0.44771823287010193The modified gen p mean: 0.44891098141670227, gen p mean: -0.05002368241548538, mean p set: 0.44939130544662476
loss_pred:0.01830974407494068, decouple_loss:0.0009835812961682677
loss_pred:0.017733506858348846, decouple_loss:0.001036179019138217
Iteration: 879, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465724527835846, gen p mean: -0.047661591321229935, mean p set: 0.4470527172088623
loss_pred:0.0187868382781744, decouple_loss:0.0009652680018916726
The modified gen p mean: 0.4458576738834381, gen p mean: -0.04750077798962593, mean p set: 0.4463379681110382The modified gen p mean: 0.4475528299808502, gen p mean: -0.04725027456879616, mean p set: 0.4480331242084503
loss_pred:0.017685143277049065, decouple_loss:0.0009578743483871222
loss_pred:0.01715833880007267, decouple_loss:0.0009390534833073616
Iteration: 880, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468475878238678, gen p mean: -0.05025375634431839, mean p set: 0.4473278820514679
loss_pred:0.018111832439899445, decouple_loss:0.0011300707701593637
The modified gen p mean: 0.447847843170166, gen p mean: -0.0523456409573555, mean p set: 0.4483281373977661The modified gen p mean: 0.4462895691394806, gen p mean: -0.047217629849910736, mean p set: 0.4467698633670807
loss_pred:0.01800617389380932, decouple_loss:0.0010149386944249272
loss_pred:0.017966212704777718, decouple_loss:0.001011629356071353
2023-05-01 01:42:48 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.049588948488235474, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.045136164873838425, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04586004093289375, mean p set: 0.4500633478164673
loss_pred:0.01837257109582424, decouple_loss:0.0009816456586122513
loss_pred:0.01725628972053528, decouple_loss:0.001121901674196124
loss_pred:0.01746768318116665, decouple_loss:0.0010422513587400317
WV_0_PC_1_EH_0_PS_40, loss: 0.017751280218362808, avg_mse: 0.025461025536060333
current test mse: 0.025461
Iteration: 881, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484494924545288, gen p mean: -0.0466495156288147, mean p set: 0.4489297568798065
The modified gen p mean: 0.4468745291233063, gen p mean: -0.04792017489671707, mean p set: 0.447354793548584
The modified gen p mean: 0.44669944047927856, gen p mean: -0.046003784984350204, mean p set: 0.44717973470687866
loss_pred:0.01809411309659481, decouple_loss:0.0009164445218630135
loss_pred:0.017004510387778282, decouple_loss:0.000930004520341754
loss_pred:0.018353037536144257, decouple_loss:0.0009371298947371542
Iteration: 882, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44728296995162964, gen p mean: -0.04752744361758232, mean p set: 0.4477632939815521
loss_pred:0.017978524789214134, decouple_loss:0.001127463998273015
The modified gen p mean: 0.4479723274707794, gen p mean: -0.04704620689153671, mean p set: 0.4484526515007019The modified gen p mean: 0.4470949172973633, gen p mean: -0.049497365951538086, mean p set: 0.4475752115249634
loss_pred:0.017279379069805145, decouple_loss:0.0009771556360647082
loss_pred:0.017069440335035324, decouple_loss:0.0010461510391905904
Iteration: 883, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44665107131004333, gen p mean: -0.04777093604207039, mean p set: 0.4471314251422882
loss_pred:0.01730388030409813, decouple_loss:0.0011032838374376297
The modified gen p mean: 0.44811150431632996, gen p mean: -0.04882621765136719, mean p set: 0.44859179854393005The modified gen p mean: 0.44772493839263916, gen p mean: -0.04383408650755882, mean p set: 0.44820523262023926
loss_pred:0.0171897504478693, decouple_loss:0.0010276167886331677
loss_pred:0.018025575205683708, decouple_loss:0.0010798354633152485
Iteration: 884, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448213666677475, gen p mean: -0.043171994388103485, mean p set: 0.4486939311027527
loss_pred:0.0177037101238966, decouple_loss:0.0009538187878206372
The modified gen p mean: 0.4471752941608429, gen p mean: -0.04767683893442154, mean p set: 0.447655588388443The modified gen p mean: 0.44612574577331543, gen p mean: -0.04493013024330139, mean p set: 0.44660601019859314
loss_pred:0.017755191773176193, decouple_loss:0.0010782021563500166
loss_pred:0.016886604949831963, decouple_loss:0.0010053740115836263
Iteration: 885, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473426640033722, gen p mean: -0.05207189917564392, mean p set: 0.4478229880332947
loss_pred:0.016972456127405167, decouple_loss:0.0011207038769498467
The modified gen p mean: 0.44797948002815247, gen p mean: -0.04766423627734184, mean p set: 0.4484597444534302The modified gen p mean: 0.44781041145324707, gen p mean: -0.05199410393834114, mean p set: 0.44829070568084717
loss_pred:0.01815933920443058, decouple_loss:0.0011935047805309296
loss_pred:0.017626382410526276, decouple_loss:0.0010696533136069775
Iteration: 886, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44815143942832947, gen p mean: -0.05160106346011162, mean p set: 0.44863173365592957
loss_pred:0.017320221289992332, decouple_loss:0.0010265400633215904
The modified gen p mean: 0.4470505118370056, gen p mean: -0.052699651569128036, mean p set: 0.4475308060646057The modified gen p mean: 0.4470593333244324, gen p mean: -0.049424976110458374, mean p set: 0.44753962755203247
loss_pred:0.017215166240930557, decouple_loss:0.0010855216532945633
loss_pred:0.01757398620247841, decouple_loss:0.0010575762717053294
Iteration: 887, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44810450077056885, gen p mean: -0.05299213528633118, mean p set: 0.44858479499816895
loss_pred:0.017008060589432716, decouple_loss:0.0009991999249905348
The modified gen p mean: 0.4490271210670471, gen p mean: -0.052096735686063766, mean p set: 0.4495074450969696The modified gen p mean: 0.44645819067955017, gen p mean: -0.04956716671586037, mean p set: 0.44693848490715027
loss_pred:0.017660703510046005, decouple_loss:0.0009731688187457621
loss_pred:0.01730717159807682, decouple_loss:0.00103600206784904
Iteration: 888, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44634732604026794, gen p mean: -0.05443916842341423, mean p set: 0.44682762026786804
The modified gen p mean: 0.44892945885658264, gen p mean: -0.05638270080089569, mean p set: 0.44940972328186035
loss_pred:0.016976602375507355, decouple_loss:0.0012522587785497308
loss_pred:0.01683128997683525, decouple_loss:0.001079296343959868
The modified gen p mean: 0.4471675753593445, gen p mean: -0.04961398243904114, mean p set: 0.4476478397846222
loss_pred:0.017549807205796242, decouple_loss:0.001145519083365798
Iteration: 889, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477410912513733, gen p mean: -0.051363490521907806, mean p set: 0.4482213854789734
loss_pred:0.016624150797724724, decouple_loss:0.0009622114012017846
The modified gen p mean: 0.44801634550094604, gen p mean: -0.05179114267230034, mean p set: 0.44849663972854614The modified gen p mean: 0.4475628137588501, gen p mean: -0.05626910552382469, mean p set: 0.4480431377887726
loss_pred:0.017131710425019264, decouple_loss:0.000986520666629076
loss_pred:0.01747751608490944, decouple_loss:0.0010502421064302325
Iteration: 890, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44653043150901794, gen p mean: -0.052568767219781876, mean p set: 0.44701069593429565
The modified gen p mean: 0.44680458307266235, gen p mean: -0.052109554409980774, mean p set: 0.44728490710258484
The modified gen p mean: 0.4468744397163391, gen p mean: -0.04791368171572685, mean p set: 0.4473547041416168
loss_pred:0.017265817150473595, decouple_loss:0.001065662014298141
loss_pred:0.016939101740717888, decouple_loss:0.0011564934393391013loss_pred:0.01738666743040085, decouple_loss:0.0010783987818285823
2023-05-01 01:44:41 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.0500672310590744, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04569869115948677, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.046471234411001205, mean p set: 0.4500633478164673
loss_pred:0.018400894477963448, decouple_loss:0.001017463975585997
loss_pred:0.017300264909863472, decouple_loss:0.0010936199687421322
loss_pred:0.017402878031134605, decouple_loss:0.001044952659867704
WV_0_PC_1_EH_0_PS_40, loss: 0.017753947526216507, avg_mse: 0.025487972423434258
current test mse: 0.025488
Iteration: 891, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477159082889557, gen p mean: -0.049511075019836426, mean p set: 0.4481962025165558
The modified gen p mean: 0.44786643981933594, gen p mean: -0.048055339604616165, mean p set: 0.44834673404693604
The modified gen p mean: 0.4476221203804016, gen p mean: -0.04567632079124451, mean p set: 0.4481023848056793
loss_pred:0.017408540472388268, decouple_loss:0.0009545140783302486
loss_pred:0.018018124625086784, decouple_loss:0.0009406117023900151
loss_pred:0.01768955960869789, decouple_loss:0.0010179787641391158
Iteration: 892, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478079080581665, gen p mean: -0.04918086528778076, mean p set: 0.448288232088089
loss_pred:0.016827251762151718, decouple_loss:0.000969648826867342
The modified gen p mean: 0.44694846868515015, gen p mean: -0.04951661080121994, mean p set: 0.44742879271507263The modified gen p mean: 0.4477769434452057, gen p mean: -0.04828915372490883, mean p set: 0.4482572078704834
loss_pred:0.017698021605610847, decouple_loss:0.0009113567066378891
loss_pred:0.018254123628139496, decouple_loss:0.0009762208792380989
Iteration: 893, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482361078262329, gen p mean: -0.04943213239312172, mean p set: 0.448716402053833
loss_pred:0.016737736761569977, decouple_loss:0.0010448988759890199
The modified gen p mean: 0.44741570949554443, gen p mean: -0.049575261771678925, mean p set: 0.44789600372314453The modified gen p mean: 0.4468402862548828, gen p mean: -0.05063479021191597, mean p set: 0.4473206102848053
loss_pred:0.017723865807056427, decouple_loss:0.0010819952003657818loss_pred:0.018088163807988167, decouple_loss:0.0010264364536851645
Iteration: 894, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468744695186615, gen p mean: -0.04795370623469353, mean p set: 0.4473547637462616
loss_pred:0.01686961203813553, decouple_loss:0.0009003350860439241
The modified gen p mean: 0.44716039299964905, gen p mean: -0.0526563785970211, mean p set: 0.44764068722724915The modified gen p mean: 0.4478556215763092, gen p mean: -0.04930329695343971, mean p set: 0.4483358860015869
loss_pred:0.01721198856830597, decouple_loss:0.001017286442220211
loss_pred:0.017798960208892822, decouple_loss:0.0009215897880494595
Iteration: 895, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44776391983032227, gen p mean: -0.043929655104875565, mean p set: 0.44824421405792236
loss_pred:0.018048755824565887, decouple_loss:0.0009623455698601902
The modified gen p mean: 0.4463687837123871, gen p mean: -0.048529136925935745, mean p set: 0.44684910774230957The modified gen p mean: 0.44702014327049255, gen p mean: -0.04794025421142578, mean p set: 0.44750040769577026
loss_pred:0.017459625378251076, decouple_loss:0.0010228977771475911
loss_pred:0.017630431801080704, decouple_loss:0.0010593608021736145
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012013_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012013_3_24hr.npz
NaN value num: 0
Iteration: 896, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450836181640625, gen p mean: -0.04611246660351753, mean p set: 0.4513164758682251
loss_pred:0.01732482947409153, decouple_loss:0.0010862534400075674
The modified gen p mean: 0.4501218795776367, gen p mean: -0.052325207740068436, mean p set: 0.45060214400291443The modified gen p mean: 0.4493718445301056, gen p mean: -0.04899008572101593, mean p set: 0.4498521387577057
loss_pred:0.017571771517395973, decouple_loss:0.001089629833586514
loss_pred:0.017465537413954735, decouple_loss:0.0011709672398865223
Iteration: 897, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45089563727378845, gen p mean: -0.05227883532643318, mean p set: 0.45137593150138855
The modified gen p mean: 0.4509749114513397, gen p mean: -0.0510006807744503, mean p set: 0.4514552056789398loss_pred:0.01785026304423809, decouple_loss:0.0012759638484567404
The modified gen p mean: 0.4474261403083801, gen p mean: -0.046917401254177094, mean p set: 0.4479064345359802
loss_pred:0.017664501443505287, decouple_loss:0.0012946975184604526
loss_pred:0.016853127628564835, decouple_loss:0.001261889934539795
Iteration: 898, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503542184829712, gen p mean: -0.047638460993766785, mean p set: 0.4508344829082489
loss_pred:0.01706235483288765, decouple_loss:0.001028268365189433
The modified gen p mean: 0.4503313899040222, gen p mean: -0.047557298094034195, mean p set: 0.4508116841316223The modified gen p mean: 0.4509216845035553, gen p mean: -0.05151971057057381, mean p set: 0.4514020085334778
loss_pred:0.01752610318362713, decouple_loss:0.0010778007563203573
loss_pred:0.01737629435956478, decouple_loss:0.001101184170693159
Iteration: 899, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45143359899520874, gen p mean: -0.050038933753967285, mean p set: 0.45191389322280884
loss_pred:0.017013810575008392, decouple_loss:0.001153069082647562
The modified gen p mean: 0.45019635558128357, gen p mean: -0.05418526008725166, mean p set: 0.4506766200065613The modified gen p mean: 0.4486290216445923, gen p mean: -0.05112377926707268, mean p set: 0.4491093158721924
loss_pred:0.016966601833701134, decouple_loss:0.0012172189308330417
loss_pred:0.017459457740187645, decouple_loss:0.0009835254168137908
Iteration: 900, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45036378502845764, gen p mean: -0.042264699935913086, mean p set: 0.45084407925605774
loss_pred:0.017739592120051384, decouple_loss:0.0011041865218430758
The modified gen p mean: 0.4498560428619385, gen p mean: -0.04482122138142586, mean p set: 0.4503363370895386The modified gen p mean: 0.4502499997615814, gen p mean: -0.047570232301950455, mean p set: 0.4507302939891815
loss_pred:0.01752638816833496, decouple_loss:0.0010021536145359278
loss_pred:0.017194095999002457, decouple_loss:0.0011225235648453236
2023-05-01 01:47:15 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.04684772714972496, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.042672593146562576, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.043498508632183075, mean p set: 0.4500633478164673
loss_pred:0.018488282337784767, decouple_loss:0.0012043770402669907
loss_pred:0.0173382218927145, decouple_loss:0.0011514452053233981
loss_pred:0.017402390018105507, decouple_loss:0.0011172291124239564
WV_0_PC_1_EH_0_PS_40, loss: 0.01780085079371929, avg_mse: 0.025539614260196686
current test mse: 0.02554
Iteration: 901, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45072245597839355, gen p mean: -0.04702035337686539, mean p set: 0.45120275020599365
The modified gen p mean: 0.4491064250469208, gen p mean: -0.043259356170892715, mean p set: 0.44958674907684326
The modified gen p mean: 0.44977468252182007, gen p mean: -0.0454648993909359, mean p set: 0.45025497674942017
loss_pred:0.017261754721403122, decouple_loss:0.0010643207933753729
loss_pred:0.016481196507811546, decouple_loss:0.001093048369511962
loss_pred:0.017438478767871857, decouple_loss:0.001001529861241579
Iteration: 902, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45064085721969604, gen p mean: -0.04819442331790924, mean p set: 0.45112112164497375
loss_pred:0.01647586189210415, decouple_loss:0.0010999029036611319
The modified gen p mean: 0.45072975754737854, gen p mean: -0.045058589428663254, mean p set: 0.451210081577301The modified gen p mean: 0.44930562376976013, gen p mean: -0.043739840388298035, mean p set: 0.44978588819503784
loss_pred:0.017834819853305817, decouple_loss:0.0010599035304039717
loss_pred:0.016946418210864067, decouple_loss:0.0010171654867008328
Iteration: 903, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44987475872039795, gen p mean: -0.04896840453147888, mean p set: 0.45035505294799805
loss_pred:0.01693602465093136, decouple_loss:0.0010458334581926465
The modified gen p mean: 0.4475767910480499, gen p mean: -0.042503729462623596, mean p set: 0.4480571150779724The modified gen p mean: 0.4506642520427704, gen p mean: -0.04497061297297478, mean p set: 0.4511445164680481
loss_pred:0.016913503408432007, decouple_loss:0.0010281827999278903
loss_pred:0.01737099327147007, decouple_loss:0.0010895944433286786
Iteration: 904, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492305815219879, gen p mean: -0.042318131774663925, mean p set: 0.449710875749588
loss_pred:0.01745045930147171, decouple_loss:0.0010655653895810246
The modified gen p mean: 0.45121094584465027, gen p mean: -0.04472414776682854, mean p set: 0.451691210269928The modified gen p mean: 0.4491533041000366, gen p mean: -0.04422854259610176, mean p set: 0.4496335983276367
loss_pred:0.016750814393162727, decouple_loss:0.0011310180416330695
loss_pred:0.01653239130973816, decouple_loss:0.0010642748093232512
Iteration: 905, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488905966281891, gen p mean: -0.04832075908780098, mean p set: 0.4493708908557892
loss_pred:0.017614711076021194, decouple_loss:0.0011327178217470646
The modified gen p mean: 0.45092812180519104, gen p mean: -0.05153714120388031, mean p set: 0.45140841603279114The modified gen p mean: 0.4502270221710205, gen p mean: -0.0510222353041172, mean p set: 0.4507073163986206
loss_pred:0.01738528162240982, decouple_loss:0.001380272675305605
loss_pred:0.017084352672100067, decouple_loss:0.0012203032383695245
Iteration: 906, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45018118619918823, gen p mean: -0.04928587004542351, mean p set: 0.45066148042678833
loss_pred:0.01664314977824688, decouple_loss:0.0013780612498521805
The modified gen p mean: 0.4507967233657837, gen p mean: -0.05119619891047478, mean p set: 0.4512770175933838The modified gen p mean: 0.45012757182121277, gen p mean: -0.04647807031869888, mean p set: 0.45060789585113525
loss_pred:0.017047736793756485, decouple_loss:0.001305650337599218
loss_pred:0.01725078746676445, decouple_loss:0.0014865403063595295
Iteration: 907, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45071253180503845, gen p mean: -0.05102524533867836, mean p set: 0.45119279623031616
loss_pred:0.01665748655796051, decouple_loss:0.001142851891927421
The modified gen p mean: 0.4504499137401581, gen p mean: -0.054167840629816055, mean p set: 0.4509302079677582The modified gen p mean: 0.45086777210235596, gen p mean: -0.04851657152175903, mean p set: 0.45134806632995605
loss_pred:0.01685604453086853, decouple_loss:0.001317201997153461
loss_pred:0.017087653279304504, decouple_loss:0.001102541689760983
Iteration: 908, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44876593351364136, gen p mean: -0.046782515943050385, mean p set: 0.44924622774124146
loss_pred:0.016731755807995796, decouple_loss:0.0011455962667241693
The modified gen p mean: 0.4506102502346039, gen p mean: -0.05094928666949272, mean p set: 0.451090544462204The modified gen p mean: 0.45106908679008484, gen p mean: -0.045897603034973145, mean p set: 0.45154935121536255
loss_pred:0.016346275806427002, decouple_loss:0.0012726741842925549
loss_pred:0.017626358196139336, decouple_loss:0.00149254291318357
Iteration: 909, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490281939506531, gen p mean: -0.043206922709941864, mean p set: 0.4495084881782532
The modified gen p mean: 0.45021581649780273, gen p mean: -0.0533742792904377, mean p set: 0.45069611072540283
loss_pred:0.0170064028352499, decouple_loss:0.00108330009970814
loss_pred:0.01619860529899597, decouple_loss:0.0013297401601448655
The modified gen p mean: 0.44861987233161926, gen p mean: -0.04471292719244957, mean p set: 0.44910016655921936
loss_pred:0.016867533326148987, decouple_loss:0.0010981238447129726
Iteration: 910, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45033878087997437, gen p mean: -0.04629875719547272, mean p set: 0.45081907510757446
loss_pred:0.01663150079548359, decouple_loss:0.0011874533956870437
The modified gen p mean: 0.44914960861206055, gen p mean: -0.040556274354457855, mean p set: 0.44962990283966064The modified gen p mean: 0.4504632353782654, gen p mean: -0.04397858306765556, mean p set: 0.4509435296058655
loss_pred:0.01704343594610691, decouple_loss:0.0010583129478618503
loss_pred:0.017597448080778122, decouple_loss:0.0011025917483493686
2023-05-01 01:49:08 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.04584933817386627, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04204079881310463, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.042679086327552795, mean p set: 0.4500633478164673
loss_pred:0.018490184098482132, decouple_loss:0.0012172554852440953
loss_pred:0.017300497740507126, decouple_loss:0.0012535720597952604
loss_pred:0.017445934936404228, decouple_loss:0.001214908086694777
WV_0_PC_1_EH_0_PS_40, loss: 0.017806967720389366, avg_mse: 0.025566041469573975
current test mse: 0.025566
Iteration: 911, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486197829246521, gen p mean: -0.041409045457839966, mean p set: 0.4491001069545746
The modified gen p mean: 0.4506271183490753, gen p mean: -0.04477553069591522, mean p set: 0.451107382774353
The modified gen p mean: 0.4502987563610077, gen p mean: -0.04199109971523285, mean p set: 0.4507790505886078
loss_pred:0.01727132312953472, decouple_loss:0.001074788044206798
loss_pred:0.0168558768928051, decouple_loss:0.001123722642660141
loss_pred:0.016500700265169144, decouple_loss:0.0010439511388540268
Iteration: 912, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45054301619529724, gen p mean: -0.045137058943510056, mean p set: 0.4510233402252197
loss_pred:0.01684933342039585, decouple_loss:0.001275459653697908
The modified gen p mean: 0.45052289962768555, gen p mean: -0.042255569249391556, mean p set: 0.45100319385528564The modified gen p mean: 0.4497581422328949, gen p mean: -0.04125841706991196, mean p set: 0.450238436460495
loss_pred:0.01677640713751316, decouple_loss:0.001245229970663786
loss_pred:0.016750089824199677, decouple_loss:0.0013044463703408837
Iteration: 913, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44862794876098633, gen p mean: -0.04572880268096924, mean p set: 0.44910821318626404
loss_pred:0.01702934503555298, decouple_loss:0.0011960973497480154
The modified gen p mean: 0.44932565093040466, gen p mean: -0.04224075376987457, mean p set: 0.4498059153556824The modified gen p mean: 0.4487893283367157, gen p mean: -0.04457032307982445, mean p set: 0.4492696523666382
loss_pred:0.017219968140125275, decouple_loss:0.001132159261032939
loss_pred:0.016775835305452347, decouple_loss:0.001065582036972046
Iteration: 914, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497682750225067, gen p mean: -0.0412413664162159, mean p set: 0.4502485692501068
loss_pred:0.017143607139587402, decouple_loss:0.0011943902354687452
The modified gen p mean: 0.4492439329624176, gen p mean: -0.044539328664541245, mean p set: 0.4497242569923401The modified gen p mean: 0.4498402774333954, gen p mean: -0.05045752227306366, mean p set: 0.4503205716609955
loss_pred:0.017400944605469704, decouple_loss:0.0011755697196349502
loss_pred:0.016981637105345726, decouple_loss:0.0013982270611450076
Iteration: 915, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498802423477173, gen p mean: -0.04359360411763191, mean p set: 0.4503605365753174
loss_pred:0.01644422858953476, decouple_loss:0.0010358053259551525
The modified gen p mean: 0.4498160481452942, gen p mean: -0.046050626784563065, mean p set: 0.4502963423728943The modified gen p mean: 0.4508408308029175, gen p mean: -0.04898491129279137, mean p set: 0.4513210952281952
loss_pred:0.015989849343895912, decouple_loss:0.0010410214308649302
loss_pred:0.016688548028469086, decouple_loss:0.0012516675051301718
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012003_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012003_3_24hr.npz
NaN value num: 0
Iteration: 916, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44936540722846985, gen p mean: -0.04697483032941818, mean p set: 0.44984567165374756
loss_pred:0.015237334184348583, decouple_loss:0.001171243260614574
The modified gen p mean: 0.4470297396183014, gen p mean: -0.049732185900211334, mean p set: 0.4475100636482239The modified gen p mean: 0.44841331243515015, gen p mean: -0.0506739504635334, mean p set: 0.44889357686042786
loss_pred:0.014695425517857075, decouple_loss:0.0011974502122029662
loss_pred:0.014596573077142239, decouple_loss:0.001291893539018929
Iteration: 917, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44823938608169556, gen p mean: -0.047632262110710144, mean p set: 0.44871968030929565
The modified gen p mean: 0.4489436447620392, gen p mean: -0.040425315499305725, mean p set: 0.4494239091873169
loss_pred:0.01470259390771389, decouple_loss:0.0011861314997076988
loss_pred:0.014619003050029278, decouple_loss:0.0011071935296058655
The modified gen p mean: 0.4488052427768707, gen p mean: -0.050701916217803955, mean p set: 0.4492855668067932
loss_pred:0.014483565464615822, decouple_loss:0.0012001680443063378
Iteration: 918, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480617344379425, gen p mean: -0.03855052962899208, mean p set: 0.4485420286655426
loss_pred:0.015244903042912483, decouple_loss:0.0013375339331105351
The modified gen p mean: 0.44898638129234314, gen p mean: -0.0416693352162838, mean p set: 0.4494667053222656The modified gen p mean: 0.4482167959213257, gen p mean: -0.04732801765203476, mean p set: 0.4486970603466034
loss_pred:0.014601098373532295, decouple_loss:0.0013111545704305172
loss_pred:0.014901161193847656, decouple_loss:0.0014371351571753621
Iteration: 919, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44843608140945435, gen p mean: -0.04632372036576271, mean p set: 0.44891637563705444
loss_pred:0.014228472486138344, decouple_loss:0.0012306265998631716
The modified gen p mean: 0.4474274516105652, gen p mean: -0.03641757369041443, mean p set: 0.4479077458381653The modified gen p mean: 0.4505738615989685, gen p mean: -0.04358344152569771, mean p set: 0.4510541558265686
loss_pred:0.014667020179331303, decouple_loss:0.001473466050811112
loss_pred:0.01476783026009798, decouple_loss:0.0012477780692279339
Iteration: 920, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44679591059684753, gen p mean: -0.03980923071503639, mean p set: 0.44727620482444763
The modified gen p mean: 0.44893309473991394, gen p mean: -0.045107897371053696, mean p set: 0.4494134187698364
loss_pred:0.01448049396276474, decouple_loss:0.0013337302953004837
loss_pred:0.013645898550748825, decouple_loss:0.0013262206921353936
The modified gen p mean: 0.44872400164604187, gen p mean: -0.04550038278102875, mean p set: 0.4492042660713196
loss_pred:0.013812699355185032, decouple_loss:0.0013763941824436188
2023-05-01 01:51:44 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.04475139081478119, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.040987592190504074, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.041302163153886795, mean p set: 0.4500633478164673
loss_pred:0.019114477559924126, decouple_loss:0.0016710114432498813
loss_pred:0.01788080297410488, decouple_loss:0.0015359732788056135
loss_pred:0.017987584695219994, decouple_loss:0.0015146535588428378
WV_0_PC_1_EH_0_PS_40, loss: 0.01840631663799286, avg_mse: 0.026648294180631638
current test mse: 0.026648
Iteration: 921, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497413635253906, gen p mean: -0.038304973393678665, mean p set: 0.4502216577529907
The modified gen p mean: 0.45050033926963806, gen p mean: -0.044538140296936035, mean p set: 0.45098060369491577
The modified gen p mean: 0.4472561478614807, gen p mean: -0.042832471430301666, mean p set: 0.4477364122867584
loss_pred:0.014711295254528522, decouple_loss:0.0013277620309963822
loss_pred:0.01480959728360176, decouple_loss:0.0013633924536406994
loss_pred:0.014369793236255646, decouple_loss:0.0015782543923705816
Iteration: 922, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44690385460853577, gen p mean: -0.043088920414447784, mean p set: 0.44738414883613586
loss_pred:0.014587893150746822, decouple_loss:0.001374400919303298
The modified gen p mean: 0.4480161666870117, gen p mean: -0.04807952791452408, mean p set: 0.4484964609146118
The modified gen p mean: 0.44795912504196167, gen p mean: -0.043428435921669006, mean p set: 0.44843941926956177
loss_pred:0.014305668883025646, decouple_loss:0.001190360402688384
loss_pred:0.013886850327253342, decouple_loss:0.0013664064463227987
Iteration: 923, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481599032878876, gen p mean: -0.039470374584198, mean p set: 0.44864022731781006
loss_pred:0.014596940949559212, decouple_loss:0.0017058639787137508
The modified gen p mean: 0.4476427733898163, gen p mean: -0.04511948674917221, mean p set: 0.4481230676174164The modified gen p mean: 0.4486349821090698, gen p mean: -0.050717681646347046, mean p set: 0.4491152763366699
loss_pred:0.014589627273380756, decouple_loss:0.0017748646205291152
loss_pred:0.013887645676732063, decouple_loss:0.0015941838501021266
Iteration: 924, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448375940322876, gen p mean: -0.049872953444719315, mean p set: 0.4488562345504761
loss_pred:0.01418386958539486, decouple_loss:0.0014595622196793556
The modified gen p mean: 0.4490232765674591, gen p mean: -0.04503582790493965, mean p set: 0.4495035707950592The modified gen p mean: 0.44821345806121826, gen p mean: -0.04848232865333557, mean p set: 0.44869375228881836
loss_pred:0.014020120725035667, decouple_loss:0.0013849560637027025
loss_pred:0.01402880996465683, decouple_loss:0.001410661032423377
Iteration: 925, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44832903146743774, gen p mean: -0.04712556302547455, mean p set: 0.44880932569503784
loss_pred:0.013995376415550709, decouple_loss:0.001626419834792614
The modified gen p mean: 0.44844579696655273, gen p mean: -0.04615325853228569, mean p set: 0.44892609119415283The modified gen p mean: 0.44854143261909485, gen p mean: -0.04353807121515274, mean p set: 0.44902175664901733
loss_pred:0.013662414625287056, decouple_loss:0.00165458838455379
loss_pred:0.014464208856225014, decouple_loss:0.0015054249670356512
Iteration: 926, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490513503551483, gen p mean: -0.04693979769945145, mean p set: 0.449531614780426
loss_pred:0.014212439768016338, decouple_loss:0.0015401967102661729
The modified gen p mean: 0.44853872060775757, gen p mean: -0.044473569840192795, mean p set: 0.44901901483535767The modified gen p mean: 0.447750449180603, gen p mean: -0.043691959232091904, mean p set: 0.44823071360588074
loss_pred:0.014253086410462856, decouple_loss:0.0014781794743612409
loss_pred:0.014398288913071156, decouple_loss:0.0015338149387389421
Iteration: 927, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474150240421295, gen p mean: -0.04763009026646614, mean p set: 0.4478953182697296
loss_pred:0.01363798975944519, decouple_loss:0.0014509661123156548
The modified gen p mean: 0.44682058691978455, gen p mean: -0.0461745485663414, mean p set: 0.44730088114738464The modified gen p mean: 0.4484531879425049, gen p mean: -0.05289589613676071, mean p set: 0.4489334523677826
loss_pred:0.01374869141727686, decouple_loss:0.0015646202955394983
loss_pred:0.013758455403149128, decouple_loss:0.0015325911808758974
Iteration: 928, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477507770061493, gen p mean: -0.04088975116610527, mean p set: 0.448231041431427
loss_pred:0.014068571850657463, decouple_loss:0.0013912023277953267
The modified gen p mean: 0.4493885040283203, gen p mean: -0.049521252512931824, mean p set: 0.4498688280582428The modified gen p mean: 0.4481697380542755, gen p mean: -0.04116472229361534, mean p set: 0.448650062084198
loss_pred:0.013807754963636398, decouple_loss:0.0014248128281906247
loss_pred:0.01430104672908783, decouple_loss:0.0013866872759535909
Iteration: 929, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472508430480957, gen p mean: -0.04051017016172409, mean p set: 0.4477311074733734
loss_pred:0.01394008006900549, decouple_loss:0.0013689298648387194
The modified gen p mean: 0.4478701651096344, gen p mean: -0.04609648138284683, mean p set: 0.4483504593372345The modified gen p mean: 0.44761529564857483, gen p mean: -0.04094551503658295, mean p set: 0.4480955898761749
loss_pred:0.014204627834260464, decouple_loss:0.0013204424176365137
loss_pred:0.014217828400433064, decouple_loss:0.0013334323884919286
Iteration: 930, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44884786009788513, gen p mean: -0.0471639409661293, mean p set: 0.44932815432548523
loss_pred:0.013390314765274525, decouple_loss:0.0012736606877297163
The modified gen p mean: 0.44833943247795105, gen p mean: -0.04148891568183899, mean p set: 0.44881969690322876The modified gen p mean: 0.4481566250324249, gen p mean: -0.044183578342199326, mean p set: 0.44863688945770264
loss_pred:0.01418408751487732, decouple_loss:0.0012362441048026085
loss_pred:0.013426646590232849, decouple_loss:0.0012578079476952553
2023-05-01 01:53:35 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.045358315110206604, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04154232144355774, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04207956790924072, mean p set: 0.4500633478164673
loss_pred:0.019298996776342392, decouple_loss:0.0013377948198467493
loss_pred:0.01815158873796463, decouple_loss:0.0014118824619799852
loss_pred:0.018180107697844505, decouple_loss:0.001358676003292203
WV_0_PC_1_EH_0_PS_40, loss: 0.01861203834414482, avg_mse: 0.02710633911192417
current test mse: 0.027106
Iteration: 931, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493597745895386, gen p mean: -0.038673609495162964, mean p set: 0.44984006881713867
The modified gen p mean: 0.44889312982559204, gen p mean: -0.04737069457769394, mean p set: 0.44937342405319214
The modified gen p mean: 0.44745132327079773, gen p mean: -0.040305089205503464, mean p set: 0.4479316174983978
loss_pred:0.014179538935422897, decouple_loss:0.0014404354151338339
loss_pred:0.014449696987867355, decouple_loss:0.0015496566193178296
loss_pred:0.013281777501106262, decouple_loss:0.0012857605470344424
Iteration: 932, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44846776127815247, gen p mean: -0.035603512078523636, mean p set: 0.44894805550575256
The modified gen p mean: 0.4480254352092743, gen p mean: -0.044930461794137955, mean p set: 0.448505699634552
loss_pred:0.013938013464212418, decouple_loss:0.0013260392006486654
loss_pred:0.01357939001172781, decouple_loss:0.0013836584985256195
The modified gen p mean: 0.44824087619781494, gen p mean: -0.04269545152783394, mean p set: 0.44872117042541504
loss_pred:0.014115528203547001, decouple_loss:0.0012820132542401552
Iteration: 933, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484662413597107, gen p mean: -0.044795624911785126, mean p set: 0.4489465653896332
loss_pred:0.013444872573018074, decouple_loss:0.0012351969489827752
The modified gen p mean: 0.44814160466194153, gen p mean: -0.03968435525894165, mean p set: 0.448621928691864The modified gen p mean: 0.44861480593681335, gen p mean: -0.03874361887574196, mean p set: 0.44909510016441345
loss_pred:0.014126017689704895, decouple_loss:0.001248325570486486
loss_pred:0.013824612833559513, decouple_loss:0.001299879513680935
Iteration: 934, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44816339015960693, gen p mean: -0.04779454320669174, mean p set: 0.4486437141895294
loss_pred:0.013619245029985905, decouple_loss:0.0015377403469756246
The modified gen p mean: 0.449165403842926, gen p mean: -0.045570697635412216, mean p set: 0.4496456980705261The modified gen p mean: 0.4477349817752838, gen p mean: -0.04137708991765976, mean p set: 0.4482152760028839
loss_pred:0.013784587383270264, decouple_loss:0.001488991780206561
loss_pred:0.014015407301485538, decouple_loss:0.0016890288097783923
Iteration: 935, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476039409637451, gen p mean: -0.04634474962949753, mean p set: 0.4480842351913452
loss_pred:0.013241734355688095, decouple_loss:0.0012594956206157804
The modified gen p mean: 0.4488731920719147, gen p mean: -0.04781855642795563, mean p set: 0.44935348629951477The modified gen p mean: 0.4476643204689026, gen p mean: -0.04592740535736084, mean p set: 0.4481446146965027
loss_pred:0.013960842043161392, decouple_loss:0.0013115080073475838
loss_pred:0.014281706884503365, decouple_loss:0.0013865504879504442
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012006_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012006_3_24hr.npz
NaN value num: 0
Iteration: 936, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44622570276260376, gen p mean: -0.04535509645938873, mean p set: 0.44670602679252625
loss_pred:0.014819914475083351, decouple_loss:0.001315214205533266
The modified gen p mean: 0.44795045256614685, gen p mean: -0.052676230669021606, mean p set: 0.44843074679374695The modified gen p mean: 0.4477618932723999, gen p mean: -0.04909569025039673, mean p set: 0.4482421875
loss_pred:0.014272541739046574, decouple_loss:0.001362694543786347
loss_pred:0.014014781452715397, decouple_loss:0.0014250569511204958
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 937, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44734084606170654, gen p mean: -0.04417300596833229, mean p set: 0.44782111048698425
The modified gen p mean: 0.44653043150901794, gen p mean: -0.05030663684010506, mean p set: 0.44701075553894043
loss_pred:0.014216563664376736, decouple_loss:0.0013653746573254466
loss_pred:0.014431968331336975, decouple_loss:0.0014043516712263227
The modified gen p mean: 0.44814372062683105, gen p mean: -0.04734448343515396, mean p set: 0.44862401485443115
loss_pred:0.014400361105799675, decouple_loss:0.0013926815008744597
Iteration: 938, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447611540555954, gen p mean: -0.04134882986545563, mean p set: 0.4480918347835541
The modified gen p mean: 0.44732606410980225, gen p mean: -0.04524676874279976, mean p set: 0.44780635833740234
loss_pred:0.014637066051363945, decouple_loss:0.0011952790664508939
loss_pred:0.014551266096532345, decouple_loss:0.0013116328045725822
The modified gen p mean: 0.4468052387237549, gen p mean: -0.048874132335186005, mean p set: 0.44728556275367737
loss_pred:0.014561657793819904, decouple_loss:0.0012757718795910478
Iteration: 939, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484044313430786, gen p mean: -0.039222486317157745, mean p set: 0.4488847255706787
loss_pred:0.013638432137668133, decouple_loss:0.0014182948507368565
The modified gen p mean: 0.4472491145133972, gen p mean: -0.04257218912243843, mean p set: 0.4477294087409973The modified gen p mean: 0.44823774695396423, gen p mean: -0.04128662869334221, mean p set: 0.44871804118156433
loss_pred:0.014131329022347927, decouple_loss:0.0013028427492827177
loss_pred:0.014036841690540314, decouple_loss:0.001289821695536375
Iteration: 940, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485522210597992, gen p mean: -0.045507654547691345, mean p set: 0.4490325152873993
loss_pred:0.01324062142521143, decouple_loss:0.0012621841160580516
The modified gen p mean: 0.447831928730011, gen p mean: -0.042621366679668427, mean p set: 0.4483122229576111
The modified gen p mean: 0.44769397377967834, gen p mean: -0.04242696613073349, mean p set: 0.44817429780960083
loss_pred:0.013621541671454906, decouple_loss:0.0012093966361135244
loss_pred:0.01384694967418909, decouple_loss:0.001246947213076055
2023-05-01 01:56:08 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.0417153500020504, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.037984538823366165, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.03862737864255905, mean p set: 0.4500633478164673
loss_pred:0.019213467836380005, decouple_loss:0.001312243053689599
loss_pred:0.01809610426425934, decouple_loss:0.0013610379537567496
loss_pred:0.01809884048998356, decouple_loss:0.0013617046643048525
WV_0_PC_1_EH_0_PS_40, loss: 0.018536720424890518, avg_mse: 0.02699178084731102
current test mse: 0.026992
Iteration: 941, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44745659828186035, gen p mean: -0.03913301229476929, mean p set: 0.44793686270713806
The modified gen p mean: 0.44688400626182556, gen p mean: -0.035881850868463516, mean p set: 0.44736430048942566
The modified gen p mean: 0.4473554193973541, gen p mean: -0.040242329239845276, mean p set: 0.4478357136249542
loss_pred:0.013676897622644901, decouple_loss:0.0013065391685813665
loss_pred:0.013818656094372272, decouple_loss:0.0012873806990683079
loss_pred:0.0139425378292799, decouple_loss:0.0013407496735453606
Iteration: 942, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446754515171051, gen p mean: -0.044508058577775955, mean p set: 0.44723477959632874
The modified gen p mean: 0.4481145441532135, gen p mean: -0.04038374498486519, mean p set: 0.4485948383808136
loss_pred:0.014370225369930267, decouple_loss:0.0011940713739022613
The modified gen p mean: 0.4471207857131958, gen p mean: -0.038676753640174866, mean p set: 0.4476010799407959
loss_pred:0.014033635146915913, decouple_loss:0.0011406781850382686
loss_pred:0.013688463717699051, decouple_loss:0.0012705649714916945
Iteration: 943, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44699323177337646, gen p mean: -0.043357912451028824, mean p set: 0.44747352600097656
loss_pred:0.013738365843892097, decouple_loss:0.0011204355396330357
The modified gen p mean: 0.4470902979373932, gen p mean: -0.042664170265197754, mean p set: 0.4475705623626709The modified gen p mean: 0.4473670721054077, gen p mean: -0.04422778636217117, mean p set: 0.4478473961353302
loss_pred:0.013544633984565735, decouple_loss:0.0012401925632730126
loss_pred:0.01425421703606844, decouple_loss:0.0012570023536682129
Iteration: 944, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44693994522094727, gen p mean: -0.04793321713805199, mean p set: 0.44742023944854736
loss_pred:0.013599902391433716, decouple_loss:0.0011878376826643944
The modified gen p mean: 0.44723570346832275, gen p mean: -0.0439368411898613, mean p set: 0.44771599769592285
The modified gen p mean: 0.44682765007019043, gen p mean: -0.04183927923440933, mean p set: 0.4473079442977905
loss_pred:0.013507493771612644, decouple_loss:0.0012822856660932302
loss_pred:0.013864006847143173, decouple_loss:0.0013668301980942488
Iteration: 945, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466507136821747, gen p mean: -0.052110157907009125, mean p set: 0.4471310079097748
loss_pred:0.013330417685210705, decouple_loss:0.0011549120536074042
The modified gen p mean: 0.44882383942604065, gen p mean: -0.051878150552511215, mean p set: 0.44930416345596313
The modified gen p mean: 0.4480040669441223, gen p mean: -0.04697079211473465, mean p set: 0.4484843611717224
loss_pred:0.013356112875044346, decouple_loss:0.0011539844563230872
loss_pred:0.013589457608759403, decouple_loss:0.001160101150162518
Iteration: 946, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44754332304000854, gen p mean: -0.04984068125486374, mean p set: 0.44802361726760864
loss_pred:0.013650666922330856, decouple_loss:0.0014268169179558754
The modified gen p mean: 0.44773995876312256, gen p mean: -0.04905043542385101, mean p set: 0.44822028279304504The modified gen p mean: 0.44862884283065796, gen p mean: -0.04779280722141266, mean p set: 0.44910916686058044
loss_pred:0.013497564941644669, decouple_loss:0.001377823413349688
loss_pred:0.013880342245101929, decouple_loss:0.001294868066906929
Iteration: 947, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44794484972953796, gen p mean: -0.04685360565781593, mean p set: 0.44842514395713806
loss_pred:0.013831610791385174, decouple_loss:0.001165741472505033
The modified gen p mean: 0.4473397433757782, gen p mean: -0.04565432667732239, mean p set: 0.4478200376033783The modified gen p mean: 0.4482698440551758, gen p mean: -0.053808022290468216, mean p set: 0.4487501382827759
loss_pred:0.013408082537353039, decouple_loss:0.0011714986758306623
loss_pred:0.014116819947957993, decouple_loss:0.0011619885917752981
Iteration: 948, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44832292199134827, gen p mean: -0.0458754301071167, mean p set: 0.44880321621894836
loss_pred:0.013575799763202667, decouple_loss:0.001137471990659833
The modified gen p mean: 0.447311133146286, gen p mean: -0.04566974192857742, mean p set: 0.4477914571762085The modified gen p mean: 0.44660717248916626, gen p mean: -0.05184248834848404, mean p set: 0.44708749651908875
loss_pred:0.013422035612165928, decouple_loss:0.0011860793456435204
loss_pred:0.014275897294282913, decouple_loss:0.0012231478467583656
Iteration: 949, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44815999269485474, gen p mean: -0.045958902686834335, mean p set: 0.44864028692245483
loss_pred:0.013859047554433346, decouple_loss:0.0011766888201236725
The modified gen p mean: 0.4466067850589752, gen p mean: -0.0459294393658638, mean p set: 0.4470870792865753The modified gen p mean: 0.447663813829422, gen p mean: -0.04414502903819084, mean p set: 0.4481441080570221
loss_pred:0.014379754662513733, decouple_loss:0.0011940158437937498
loss_pred:0.013383476063609123, decouple_loss:0.001103084534406662
Iteration: 950, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471854269504547, gen p mean: -0.04600828140974045, mean p set: 0.4476657211780548
loss_pred:0.013231968507170677, decouple_loss:0.0011574544478207827
The modified gen p mean: 0.44820713996887207, gen p mean: -0.04475142061710358, mean p set: 0.44868743419647217The modified gen p mean: 0.4472900927066803, gen p mean: -0.05351271480321884, mean p set: 0.4477703869342804
loss_pred:0.013843092136085033, decouple_loss:0.0010686794994398952
loss_pred:0.0134316086769104, decouple_loss:0.0010872709099203348
2023-05-01 01:58:00 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.0486532524228096, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04446526989340782, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.04535631835460663, mean p set: 0.4500633478164673
loss_pred:0.019189981743693352, decouple_loss:0.0011541452258825302
loss_pred:0.018103081732988358, decouple_loss:0.001136884675361216
loss_pred:0.018126217648386955, decouple_loss:0.0011211457895115018
WV_0_PC_1_EH_0_PS_40, loss: 0.018529964610934258, avg_mse: 0.027030453085899353
current test mse: 0.02703
Iteration: 951, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474378228187561, gen p mean: -0.04275958985090256, mean p set: 0.4479181170463562
The modified gen p mean: 0.4478028416633606, gen p mean: -0.045778997242450714, mean p set: 0.4482831358909607
The modified gen p mean: 0.44688132405281067, gen p mean: -0.04704766348004341, mean p set: 0.44736161828041077
loss_pred:0.013311098329722881, decouple_loss:0.0010782362660393119
loss_pred:0.013566053472459316, decouple_loss:0.0010012546554207802
loss_pred:0.013423845171928406, decouple_loss:0.001058325171470642
Iteration: 952, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44747069478034973, gen p mean: -0.04032615199685097, mean p set: 0.4479510188102722
The modified gen p mean: 0.4479466378688812, gen p mean: -0.04400632530450821, mean p set: 0.4484269320964813
loss_pred:0.013925560750067234, decouple_loss:0.0010332954116165638
loss_pred:0.0132431760430336, decouple_loss:0.0011223305482417345
The modified gen p mean: 0.446816623210907, gen p mean: -0.04802393168210983, mean p set: 0.4472969174385071
loss_pred:0.013218959793448448, decouple_loss:0.0010844628559425473
Iteration: 953, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493085741996765, gen p mean: -0.05046588554978371, mean p set: 0.4497888684272766
loss_pred:0.012818832881748676, decouple_loss:0.0012631671270355582
The modified gen p mean: 0.4474269449710846, gen p mean: -0.04709620401263237, mean p set: 0.4479072690010071The modified gen p mean: 0.447664350271225, gen p mean: -0.041204359382390976, mean p set: 0.4481446444988251
loss_pred:0.013075271621346474, decouple_loss:0.0011662110919132829
loss_pred:0.014375099912285805, decouple_loss:0.0011578903067857027
Iteration: 954, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481635093688965, gen p mean: -0.04533635079860687, mean p set: 0.4486437737941742
loss_pred:0.013220171444118023, decouple_loss:0.001084698480553925
The modified gen p mean: 0.4468085765838623, gen p mean: -0.05156392231583595, mean p set: 0.4472888708114624The modified gen p mean: 0.4472769796848297, gen p mean: -0.04732907935976982, mean p set: 0.4477572739124298
loss_pred:0.013660518452525139, decouple_loss:0.0011627934873104095
loss_pred:0.014171561226248741, decouple_loss:0.0011356477625668049
Iteration: 955, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472962021827698, gen p mean: -0.042165376245975494, mean p set: 0.4477764964103699
loss_pred:0.013333846814930439, decouple_loss:0.001161191612482071
The modified gen p mean: 0.4467688500881195, gen p mean: -0.050810690969228745, mean p set: 0.4472491443157196The modified gen p mean: 0.4472196400165558, gen p mean: -0.04767343029379845, mean p set: 0.4476999342441559
loss_pred:0.013754944317042828, decouple_loss:0.0010395105928182602loss_pred:0.013512782752513885, decouple_loss:0.001099508604966104
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012005_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012005_3_24hr.npz
NaN value num: 0
Iteration: 956, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4541638493537903, gen p mean: -0.031749382615089417, mean p set: 0.45464417338371277
loss_pred:0.01869061589241028, decouple_loss:0.001269445288926363
The modified gen p mean: 0.4513419568538666, gen p mean: -0.03282135725021362, mean p set: 0.4518222510814667The modified gen p mean: 0.4548449218273163, gen p mean: -0.033244162797927856, mean p set: 0.4553252160549164
loss_pred:0.01801469177007675, decouple_loss:0.0012113291304558516
loss_pred:0.017749708145856857, decouple_loss:0.0013764937175437808
Iteration: 957, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4516180157661438, gen p mean: -0.04421039670705795, mean p set: 0.4520983099937439
loss_pred:0.018038423731923103, decouple_loss:0.001305960351601243
The modified gen p mean: 0.4519526958465576, gen p mean: -0.03468484804034233, mean p set: 0.4524330198764801The modified gen p mean: 0.4524298310279846, gen p mean: -0.03126290440559387, mean p set: 0.4529101252555847
loss_pred:0.017179124057292938, decouple_loss:0.0011844448745250702
loss_pred:0.017002694308757782, decouple_loss:0.0012147718807682395
Iteration: 958, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4527265727519989, gen p mean: -0.041016142815351486, mean p set: 0.453206866979599
loss_pred:0.01606561429798603, decouple_loss:0.00151429558172822
The modified gen p mean: 0.45301082730293274, gen p mean: -0.03750649839639664, mean p set: 0.45349109172821045The modified gen p mean: 0.4525229036808014, gen p mean: -0.038179248571395874, mean p set: 0.4530031979084015
loss_pred:0.01715092547237873, decouple_loss:0.0014509339816868305
loss_pred:0.018014803528785706, decouple_loss:0.0015712179010733962
Iteration: 959, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45199093222618103, gen p mean: -0.0380898155272007, mean p set: 0.45247119665145874
loss_pred:0.017885232344269753, decouple_loss:0.0012788315070793033
The modified gen p mean: 0.453250527381897, gen p mean: -0.04082605987787247, mean p set: 0.45373082160949707The modified gen p mean: 0.4522419273853302, gen p mean: -0.0395888052880764, mean p set: 0.4527222514152527
loss_pred:0.015759043395519257, decouple_loss:0.001263293786905706
loss_pred:0.017028696835041046, decouple_loss:0.0013138222275301814
Iteration: 960, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.452231764793396, gen p mean: -0.04016891494393349, mean p set: 0.4527120590209961
loss_pred:0.01753704808652401, decouple_loss:0.0015447457553818822
The modified gen p mean: 0.45258498191833496, gen p mean: -0.03715475648641586, mean p set: 0.45306530594825745
The modified gen p mean: 0.4516844153404236, gen p mean: -0.04167881980538368, mean p set: 0.4521646797657013
loss_pred:0.01632259413599968, decouple_loss:0.0014455815544351935
loss_pred:0.016895508393645287, decouple_loss:0.0014736232114955783
2023-05-01 02:00:31 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.050682395696640015, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.046862874180078506, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.04714737832546234, mean p set: 0.4500633478164673
loss_pred:0.01857987977564335, decouple_loss:0.001516483724117279
loss_pred:0.017579637467861176, decouple_loss:0.0014030110323801637loss_pred:0.017461813986301422, decouple_loss:0.0013911883579567075
WV_0_PC_1_EH_0_PS_40, loss: 0.01794562116265297, avg_mse: 0.025779958814382553
current test mse: 0.02578
Iteration: 961, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45305269956588745, gen p mean: -0.039144452661275864, mean p set: 0.45353299379348755
The modified gen p mean: 0.4529091417789459, gen p mean: -0.04263343662023544, mean p set: 0.45338940620422363
The modified gen p mean: 0.4520016610622406, gen p mean: -0.04006223753094673, mean p set: 0.4524819552898407
loss_pred:0.017925933003425598, decouple_loss:0.001514268689788878
loss_pred:0.017581487074494362, decouple_loss:0.001442969311028719
loss_pred:0.017453106120228767, decouple_loss:0.0014137018006294966
Iteration: 962, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513481557369232, gen p mean: -0.037010252475738525, mean p set: 0.4518284201622009
loss_pred:0.016948826611042023, decouple_loss:0.0014065421419218183
The modified gen p mean: 0.4526849389076233, gen p mean: -0.032828912138938904, mean p set: 0.4531652331352234The modified gen p mean: 0.452146053314209, gen p mean: -0.03845025971531868, mean p set: 0.45262637734413147
loss_pred:0.01712823659181595, decouple_loss:0.0013747927732765675
loss_pred:0.017378585413098335, decouple_loss:0.0012935836566612124
Iteration: 963, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4542931020259857, gen p mean: -0.03390848636627197, mean p set: 0.4547733962535858
loss_pred:0.017705490812659264, decouple_loss:0.0014507855521515012
The modified gen p mean: 0.4529833197593689, gen p mean: -0.04102883115410805, mean p set: 0.4534636437892914The modified gen p mean: 0.4535497725009918, gen p mean: -0.04005063697695732, mean p set: 0.4540300667285919
loss_pred:0.0181139949709177, decouple_loss:0.0015415779780596495
loss_pred:0.016952823847532272, decouple_loss:0.001462343498133123
Iteration: 964, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4527721405029297, gen p mean: -0.042157117277383804, mean p set: 0.4532524347305298
loss_pred:0.016353368759155273, decouple_loss:0.0013515730388462543
The modified gen p mean: 0.4525115489959717, gen p mean: -0.03464658185839653, mean p set: 0.4529918134212494The modified gen p mean: 0.45190414786338806, gen p mean: -0.03759345784783363, mean p set: 0.45238441228866577
loss_pred:0.01821247488260269, decouple_loss:0.0014036812353879213
loss_pred:0.01614665612578392, decouple_loss:0.0013857381418347359
Iteration: 965, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45272377133369446, gen p mean: -0.040260810405015945, mean p set: 0.45320409536361694
The modified gen p mean: 0.4527427554130554, gen p mean: -0.038572758436203, mean p set: 0.45322301983833313
loss_pred:0.017187288030982018, decouple_loss:0.0013820710591971874
loss_pred:0.01595468446612358, decouple_loss:0.0014438350917771459
The modified gen p mean: 0.4525059163570404, gen p mean: -0.03771818429231644, mean p set: 0.4529862403869629
loss_pred:0.01585119590163231, decouple_loss:0.0014329071855172515
Iteration: 966, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45311427116394043, gen p mean: -0.04389447346329689, mean p set: 0.4535945653915405
loss_pred:0.01556531060487032, decouple_loss:0.0013571116141974926
The modified gen p mean: 0.45363762974739075, gen p mean: -0.04452298954129219, mean p set: 0.45411795377731323The modified gen p mean: 0.4515909254550934, gen p mean: -0.037019602954387665, mean p set: 0.4520712196826935
loss_pred:0.01600601151585579, decouple_loss:0.0013009336544200778
loss_pred:0.016739411279559135, decouple_loss:0.0013197080697864294
Iteration: 967, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45121005177497864, gen p mean: -0.04123339056968689, mean p set: 0.45169031620025635
loss_pred:0.016862384974956512, decouple_loss:0.0014055641368031502
The modified gen p mean: 0.45210444927215576, gen p mean: -0.03845655545592308, mean p set: 0.45258474349975586The modified gen p mean: 0.4527815580368042, gen p mean: -0.041275978088378906, mean p set: 0.4532618522644043
loss_pred:0.018129805102944374, decouple_loss:0.0017311626579612494
loss_pred:0.017917292192578316, decouple_loss:0.0016478559700772166
Iteration: 968, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45320364832878113, gen p mean: -0.04562689736485481, mean p set: 0.4536839425563812
The modified gen p mean: 0.45179280638694763, gen p mean: -0.04776845872402191, mean p set: 0.45227310061454773
loss_pred:0.018126269802451134, decouple_loss:0.0014717242447659373
loss_pred:0.018232986330986023, decouple_loss:0.0015022491570562124
The modified gen p mean: 0.4524511694908142, gen p mean: -0.036068420857191086, mean p set: 0.4529314935207367
loss_pred:0.016329707577824593, decouple_loss:0.0014388874405995011
Iteration: 969, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45313453674316406, gen p mean: -0.05078095570206642, mean p set: 0.45361486077308655
loss_pred:0.015886357054114342, decouple_loss:0.0014415213372558355
The modified gen p mean: 0.4533916711807251, gen p mean: -0.04592173174023628, mean p set: 0.4538719952106476The modified gen p mean: 0.45410701632499695, gen p mean: -0.05036041513085365, mean p set: 0.45458728075027466
loss_pred:0.017484981566667557, decouple_loss:0.0013851611874997616
loss_pred:0.016904527321457863, decouple_loss:0.0014269178500398993
Iteration: 970, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45258545875549316, gen p mean: -0.04311802238225937, mean p set: 0.4530657231807709
loss_pred:0.016206083819270134, decouple_loss:0.001441644155420363
The modified gen p mean: 0.4533199667930603, gen p mean: -0.051817089319229126, mean p set: 0.4538002610206604The modified gen p mean: 0.45237550139427185, gen p mean: -0.048142582178115845, mean p set: 0.45285579562187195
loss_pred:0.017654813826084137, decouple_loss:0.0016498574987053871
loss_pred:0.016759563237428665, decouple_loss:0.0016264382284134626
2023-05-01 02:02:24 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.05866207182407379, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.05488850548863411, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.05490531027317047, mean p set: 0.4500633478164673
loss_pred:0.0184690672904253, decouple_loss:0.0015255038160830736
loss_pred:0.017573831602931023, decouple_loss:0.0015190186677500606loss_pred:0.01740308292210102, decouple_loss:0.0015589494723826647
WV_0_PC_1_EH_0_PS_40, loss: 0.017892053350806236, avg_mse: 0.025660309940576553
current test mse: 0.02566
Iteration: 971, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45377805829048157, gen p mean: -0.04443185403943062, mean p set: 0.45425835251808167
The modified gen p mean: 0.4518902897834778, gen p mean: -0.04649150371551514, mean p set: 0.4523705840110779
The modified gen p mean: 0.4531157910823822, gen p mean: -0.04935406520962715, mean p set: 0.4535960853099823
loss_pred:0.018473278731107712, decouple_loss:0.00149723538197577
loss_pred:0.017305849120020866, decouple_loss:0.0013545770198106766loss_pred:0.016356969252228737, decouple_loss:0.001480333274230361
Iteration: 972, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.452714741230011, gen p mean: -0.049317725002765656, mean p set: 0.4531950354576111
The modified gen p mean: 0.4520867168903351, gen p mean: -0.0538235604763031, mean p set: 0.4525669813156128
loss_pred:0.017767000943422318, decouple_loss:0.001455475576221943
loss_pred:0.017237095162272453, decouple_loss:0.0013663378776982427
The modified gen p mean: 0.4524059295654297, gen p mean: -0.051091741770505905, mean p set: 0.4528862237930298
loss_pred:0.016379093751311302, decouple_loss:0.001482334453612566
Iteration: 973, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4519331455230713, gen p mean: -0.04820214956998825, mean p set: 0.4524134397506714
The modified gen p mean: 0.45231375098228455, gen p mean: -0.04493235796689987, mean p set: 0.45279404520988464
loss_pred:0.016056053340435028, decouple_loss:0.001393335871398449
loss_pred:0.01740328222513199, decouple_loss:0.0015009159687906504
The modified gen p mean: 0.4525592029094696, gen p mean: -0.04582257941365242, mean p set: 0.4530394971370697
loss_pred:0.016917945817112923, decouple_loss:0.00140296365134418
Iteration: 974, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4525388479232788, gen p mean: -0.038917507976293564, mean p set: 0.4530191123485565
loss_pred:0.01752457208931446, decouple_loss:0.0014097420498728752
The modified gen p mean: 0.4513065218925476, gen p mean: -0.03595995903015137, mean p set: 0.4517868459224701The modified gen p mean: 0.45320212841033936, gen p mean: -0.043829839676618576, mean p set: 0.45368245244026184
loss_pred:0.01666080579161644, decouple_loss:0.0014734171563759446
loss_pred:0.016786769032478333, decouple_loss:0.0013891590060666203
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012017_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012017_3_24hr.npz
NaN value num: 0
Iteration: 975, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474068880081177, gen p mean: -0.04380868747830391, mean p set: 0.4478871822357178
loss_pred:0.015617921017110348, decouple_loss:0.001365809584967792
The modified gen p mean: 0.44872283935546875, gen p mean: -0.047689929604530334, mean p set: 0.44920313358306885The modified gen p mean: 0.44752660393714905, gen p mean: -0.04492844268679619, mean p set: 0.44800689816474915
loss_pred:0.014644702896475792, decouple_loss:0.0014135701349005103
loss_pred:0.015114670619368553, decouple_loss:0.0013259869301691651
Iteration: 976, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481227993965149, gen p mean: -0.04373926669359207, mean p set: 0.448603093624115
loss_pred:0.014703765511512756, decouple_loss:0.0015055775875225663
The modified gen p mean: 0.44781047105789185, gen p mean: -0.04600479081273079, mean p set: 0.44829073548316956The modified gen p mean: 0.4477875232696533, gen p mean: -0.04450429975986481, mean p set: 0.4482678174972534
loss_pred:0.015007379464805126, decouple_loss:0.0013870574766770005
loss_pred:0.014750904403626919, decouple_loss:0.0013775450643151999
Iteration: 977, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482780992984772, gen p mean: -0.03865107148885727, mean p set: 0.4487583637237549
The modified gen p mean: 0.4472324848175049, gen p mean: -0.04645088315010071, mean p set: 0.447712779045105
loss_pred:0.014780927449464798, decouple_loss:0.001274646958336234
loss_pred:0.014592187479138374, decouple_loss:0.001302925986237824
The modified gen p mean: 0.44733428955078125, gen p mean: -0.04072978347539902, mean p set: 0.44781461358070374
loss_pred:0.015159279108047485, decouple_loss:0.001321539399214089
Iteration: 978, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44637301564216614, gen p mean: -0.04475068300962448, mean p set: 0.44685330986976624
The modified gen p mean: 0.4478228688240051, gen p mean: -0.03861282020807266, mean p set: 0.4483031630516052
loss_pred:0.014372944831848145, decouple_loss:0.001457716221921146
loss_pred:0.014536705799400806, decouple_loss:0.0013058342738077044
The modified gen p mean: 0.44745364785194397, gen p mean: -0.04439004138112068, mean p set: 0.4479339122772217
loss_pred:0.014234828762710094, decouple_loss:0.0015369611792266369
Iteration: 979, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482143223285675, gen p mean: -0.03979063779115677, mean p set: 0.44869464635849
The modified gen p mean: 0.44890785217285156, gen p mean: -0.03619866445660591, mean p set: 0.44938814640045166
loss_pred:0.013786419294774532, decouple_loss:0.0013993027387186885
loss_pred:0.014459110796451569, decouple_loss:0.0013720853021368384
The modified gen p mean: 0.4480210542678833, gen p mean: -0.03801235184073448, mean p set: 0.4485013484954834
loss_pred:0.01408433634787798, decouple_loss:0.0014716709265485406
Iteration: 980, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485308527946472, gen p mean: -0.03678816929459572, mean p set: 0.4490111172199249
loss_pred:0.013390687294304371, decouple_loss:0.001501126098446548
The modified gen p mean: 0.44810548424720764, gen p mean: -0.037246983498334885, mean p set: 0.44858577847480774The modified gen p mean: 0.4470321238040924, gen p mean: -0.0414142943918705, mean p set: 0.4475124180316925
loss_pred:0.013859190046787262, decouple_loss:0.001439734478481114
loss_pred:0.014143355190753937, decouple_loss:0.0014801439829170704
2023-05-01 02:04:57 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.041060373187065125, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.03761953487992287, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.0375591516494751, mean p set: 0.4500633478164673
loss_pred:0.01927267573773861, decouple_loss:0.0014903773553669453
loss_pred:0.018143903464078903, decouple_loss:0.0016082334332168102
loss_pred:0.018206384032964706, decouple_loss:0.0015658184420317411
WV_0_PC_1_EH_0_PS_40, loss: 0.01861872896552086, avg_mse: 0.027022134512662888
current test mse: 0.027022
Iteration: 981, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44775089621543884, gen p mean: -0.03586181253194809, mean p set: 0.44823122024536133
The modified gen p mean: 0.4474121332168579, gen p mean: -0.0400848463177681, mean p set: 0.447892427444458
The modified gen p mean: 0.44791844487190247, gen p mean: -0.03952180966734886, mean p set: 0.44839873909950256
loss_pred:0.014539654366672039, decouple_loss:0.0015175240114331245
loss_pred:0.013951919972896576, decouple_loss:0.0014547042082995176
loss_pred:0.014530274085700512, decouple_loss:0.001459457678720355
Iteration: 982, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471516013145447, gen p mean: -0.03752895072102547, mean p set: 0.4476318955421448
loss_pred:0.014117226004600525, decouple_loss:0.0014605092583224177
The modified gen p mean: 0.44795534014701843, gen p mean: -0.04404895752668381, mean p set: 0.4484356641769409The modified gen p mean: 0.4465709626674652, gen p mean: -0.045065030455589294, mean p set: 0.4470512866973877
loss_pred:0.0140756294131279, decouple_loss:0.0014705435605719686
loss_pred:0.013742663897573948, decouple_loss:0.0014855784829705954
Iteration: 983, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448091596364975, gen p mean: -0.04323045164346695, mean p set: 0.44857192039489746
loss_pred:0.01403047889471054, decouple_loss:0.00137084792368114
The modified gen p mean: 0.4479690194129944, gen p mean: -0.042229317128658295, mean p set: 0.4484493136405945The modified gen p mean: 0.4476214051246643, gen p mean: -0.04559517279267311, mean p set: 0.4481017291545868
loss_pred:0.01322405319660902, decouple_loss:0.0014214179245755076
loss_pred:0.013462369330227375, decouple_loss:0.0013614377239719033
Iteration: 984, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44797733426094055, gen p mean: -0.04636412858963013, mean p set: 0.44845762848854065
loss_pred:0.0132930688560009, decouple_loss:0.0014187685446813703
The modified gen p mean: 0.44783005118370056, gen p mean: -0.04594960808753967, mean p set: 0.44831034541130066The modified gen p mean: 0.447913259267807, gen p mean: -0.04804766923189163, mean p set: 0.4483935534954071
loss_pred:0.01396747212857008, decouple_loss:0.0013934843009337783
loss_pred:0.01318090595304966, decouple_loss:0.0013846862129867077
Iteration: 985, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44822442531585693, gen p mean: -0.047166645526885986, mean p set: 0.44870471954345703
loss_pred:0.013512372970581055, decouple_loss:0.0014946447918191552
The modified gen p mean: 0.44830814003944397, gen p mean: -0.050442758947610855, mean p set: 0.44878846406936646The modified gen p mean: 0.44700318574905396, gen p mean: -0.05271522328257561, mean p set: 0.44748347997665405
loss_pred:0.013383160345256329, decouple_loss:0.0013318131677806377loss_pred:0.013534405268728733, decouple_loss:0.0013691144995391369
Iteration: 986, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44863346219062805, gen p mean: -0.051423121243715286, mean p set: 0.44911372661590576
loss_pred:0.013336452655494213, decouple_loss:0.0015949188964441419
The modified gen p mean: 0.44816282391548157, gen p mean: -0.050402577966451645, mean p set: 0.44864311814308167The modified gen p mean: 0.44888073205947876, gen p mean: -0.05225399136543274, mean p set: 0.44936102628707886
loss_pred:0.013308107852935791, decouple_loss:0.001443437417037785
loss_pred:0.012949354946613312, decouple_loss:0.0014863286633044481
Iteration: 987, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44692251086235046, gen p mean: -0.05516360327601433, mean p set: 0.44740280508995056
loss_pred:0.013461144641041756, decouple_loss:0.0016416258877143264
The modified gen p mean: 0.44811657071113586, gen p mean: -0.05193408951163292, mean p set: 0.4485968351364136The modified gen p mean: 0.4478556215763092, gen p mean: -0.04675675928592682, mean p set: 0.4483359158039093
loss_pred:0.013308622874319553, decouple_loss:0.0015641317004337907
loss_pred:0.012926836498081684, decouple_loss:0.0014919318491593003
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 988, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44781357049942017, gen p mean: -0.05182451382279396, mean p set: 0.4482938349246979
loss_pred:0.01323430985212326, decouple_loss:0.0014802986988797784
The modified gen p mean: 0.44823944568634033, gen p mean: -0.050795309245586395, mean p set: 0.44871973991394043The modified gen p mean: 0.4473022222518921, gen p mean: -0.052630554884672165, mean p set: 0.4477825164794922
loss_pred:0.013521656394004822, decouple_loss:0.001472898875363171
loss_pred:0.01356547325849533, decouple_loss:0.0014526424929499626
Iteration: 989, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448758602142334, gen p mean: -0.04877309873700142, mean p set: 0.4492388963699341
loss_pred:0.013627888634800911, decouple_loss:0.0014118881663307548
The modified gen p mean: 0.44824522733688354, gen p mean: -0.04502080753445625, mean p set: 0.44872552156448364The modified gen p mean: 0.4478570818901062, gen p mean: -0.048212725669145584, mean p set: 0.4483374059200287
loss_pred:0.013876612298190594, decouple_loss:0.0014129106421023607
loss_pred:0.012922818772494793, decouple_loss:0.0014445580309256911
Iteration: 990, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447463721036911, gen p mean: -0.04477020353078842, mean p set: 0.4479440450668335
loss_pred:0.013480515219271183, decouple_loss:0.001510254805907607
The modified gen p mean: 0.4480619728565216, gen p mean: -0.04358159750699997, mean p set: 0.4485422670841217The modified gen p mean: 0.44676509499549866, gen p mean: -0.0474260188639164, mean p set: 0.44724538922309875
loss_pred:0.013084795325994492, decouple_loss:0.00150861160364002
loss_pred:0.014023690484464169, decouple_loss:0.0015305682318285108
2023-05-01 02:06:51 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.048523932695388794, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.044622961431741714, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.044784896075725555, mean p set: 0.4500633478164673
loss_pred:0.01920350454747677, decouple_loss:0.0014376931358128786
loss_pred:0.0181367676705122, decouple_loss:0.0014332085847854614
loss_pred:0.018152063712477684, decouple_loss:0.0014987362083047628
WV_0_PC_1_EH_0_PS_40, loss: 0.018570274114608765, avg_mse: 0.027023710310459137
current test mse: 0.027024
Iteration: 991, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44832268357276917, gen p mean: -0.0460745207965374, mean p set: 0.4488029479980469
The modified gen p mean: 0.4473591446876526, gen p mean: -0.047958727926015854, mean p set: 0.4478394687175751
The modified gen p mean: 0.44800901412963867, gen p mean: -0.04620205610990524, mean p set: 0.44848933815956116
loss_pred:0.013170202262699604, decouple_loss:0.0013307491317391396
loss_pred:0.013076839968562126, decouple_loss:0.0014355521416291595
loss_pred:0.013281600549817085, decouple_loss:0.0014384165406227112
Iteration: 992, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478384852409363, gen p mean: -0.04901430383324623, mean p set: 0.44831880927085876
The modified gen p mean: 0.4484468698501587, gen p mean: -0.043184321373701096, mean p set: 0.4489271342754364
loss_pred:0.013293194584548473, decouple_loss:0.0014912972692400217
loss_pred:0.013200408779084682, decouple_loss:0.0015116254799067974
The modified gen p mean: 0.44879159331321716, gen p mean: -0.04761083051562309, mean p set: 0.44927188754081726
loss_pred:0.012911939062178135, decouple_loss:0.0014421169180423021
Iteration: 993, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478549659252167, gen p mean: -0.047606077045202255, mean p set: 0.448335200548172
The modified gen p mean: 0.44762372970581055, gen p mean: -0.048395175486803055, mean p set: 0.44810402393341064
loss_pred:0.012797772884368896, decouple_loss:0.0012980111641809344
loss_pred:0.012749374844133854, decouple_loss:0.0013200067915022373
The modified gen p mean: 0.44616711139678955, gen p mean: -0.04909193515777588, mean p set: 0.44664737582206726
loss_pred:0.013579929247498512, decouple_loss:0.0013190286699682474
Iteration: 994, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44802403450012207, gen p mean: -0.04851056635379791, mean p set: 0.44850432872772217
The modified gen p mean: 0.4487875998020172, gen p mean: -0.050445832312107086, mean p set: 0.4492678940296173
loss_pred:0.012792423367500305, decouple_loss:0.0013537482591345906
loss_pred:0.012765239924192429, decouple_loss:0.001516513293609023
The modified gen p mean: 0.4482062757015228, gen p mean: -0.04621106758713722, mean p set: 0.4486865699291229
loss_pred:0.013052058406174183, decouple_loss:0.0014430908486247063
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012012_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012012_3_24hr.npz
NaN value num: 0
Iteration: 995, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498870372772217, gen p mean: -0.038232576102018356, mean p set: 0.4503673017024994
loss_pred:0.01729942485690117, decouple_loss:0.0013513390440493822
The modified gen p mean: 0.4496683180332184, gen p mean: -0.03623538091778755, mean p set: 0.4501486122608185The modified gen p mean: 0.45165199041366577, gen p mean: -0.04199783131480217, mean p set: 0.45213228464126587
loss_pred:0.018242614343762398, decouple_loss:0.0017757890745997429
loss_pred:0.017480943351984024, decouple_loss:0.0017927606822922826
Iteration: 996, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487416744232178, gen p mean: -0.040288928896188736, mean p set: 0.44922199845314026
loss_pred:0.017399754375219345, decouple_loss:0.0014610616490244865
The modified gen p mean: 0.4493556320667267, gen p mean: -0.04246197268366814, mean p set: 0.4498359262943268The modified gen p mean: 0.4503077566623688, gen p mean: -0.03622395172715187, mean p set: 0.45078805088996887
loss_pred:0.01792636699974537, decouple_loss:0.001477069454267621
loss_pred:0.017860742285847664, decouple_loss:0.0015034625539556146
Iteration: 997, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502831995487213, gen p mean: -0.035747479647397995, mean p set: 0.4507634937763214
loss_pred:0.017970355227589607, decouple_loss:0.0016105900285765529
The modified gen p mean: 0.45172998309135437, gen p mean: -0.04111102223396301, mean p set: 0.45221027731895447The modified gen p mean: 0.4521687626838684, gen p mean: -0.03475063294172287, mean p set: 0.4526490569114685
loss_pred:0.017210299149155617, decouple_loss:0.0016572460299357772
loss_pred:0.017809554934501648, decouple_loss:0.001723805908113718
Iteration: 998, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44974303245544434, gen p mean: -0.03989928588271141, mean p set: 0.4502233564853668
loss_pred:0.01766432449221611, decouple_loss:0.0018131551332771778
The modified gen p mean: 0.45013532042503357, gen p mean: -0.03577885404229164, mean p set: 0.45061564445495605The modified gen p mean: 0.4533082842826843, gen p mean: -0.03783952072262764, mean p set: 0.4537885785102844
loss_pred:0.017332008108496666, decouple_loss:0.0017559734405949712
loss_pred:0.016630511730909348, decouple_loss:0.0017551518976688385
Iteration: 999, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481469690799713, gen p mean: -0.04392760619521141, mean p set: 0.4486272633075714
The modified gen p mean: 0.45227301120758057, gen p mean: -0.03729242458939552, mean p set: 0.4527532756328583
loss_pred:0.017723046243190765, decouple_loss:0.001766144996508956
loss_pred:0.017621371895074844, decouple_loss:0.0016331215156242251
The modified gen p mean: 0.44931161403656006, gen p mean: -0.035918887704610825, mean p set: 0.44979190826416016
loss_pred:0.018141206353902817, decouple_loss:0.0015962792094796896
Iteration: 1000, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503837525844574, gen p mean: -0.035560671240091324, mean p set: 0.4508640468120575
The modified gen p mean: 0.45121529698371887, gen p mean: -0.03522501140832901, mean p set: 0.45169559121131897
loss_pred:0.017262129113078117, decouple_loss:0.0015877459663897753
loss_pred:0.01811729557812214, decouple_loss:0.0017558473628014326
The modified gen p mean: 0.4488760530948639, gen p mean: -0.037607766687870026, mean p set: 0.4493563175201416
loss_pred:0.018064239993691444, decouple_loss:0.0017581057036295533
2023-05-01 02:09:23 itr: 1000
training loss: [0.01815215 0.01820509 0.01734152]
2023-05-01 02:09:23 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.04832785949110985, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.043982408940792084, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.04460180923342705, mean p set: 0.4500633478164673
loss_pred:0.018635042011737823, decouple_loss:0.0015826054150238633
loss_pred:0.017521843314170837, decouple_loss:0.001505123800598085
loss_pred:0.017663374543190002, decouple_loss:0.0015784926945343614
WV_0_PC_1_EH_0_PS_40, loss: 0.018017858266830444, avg_mse: 0.025866474956274033
current test mse: 0.025866
Iteration: 1001, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503800570964813, gen p mean: -0.040187474340200424, mean p set: 0.4508603513240814
The modified gen p mean: 0.4494835436344147, gen p mean: -0.037719640880823135, mean p set: 0.44996383786201477
The modified gen p mean: 0.4508315324783325, gen p mean: -0.044349927455186844, mean p set: 0.4513118267059326
loss_pred:0.017030885443091393, decouple_loss:0.0014019579393789172
loss_pred:0.01774117350578308, decouple_loss:0.0013952032895758748loss_pred:0.018097812309861183, decouple_loss:0.001448814757168293
Iteration: 1002, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45037806034088135, gen p mean: -0.03994911164045334, mean p set: 0.45085835456848145
loss_pred:0.01717505417764187, decouple_loss:0.0017849378054961562
The modified gen p mean: 0.45023173093795776, gen p mean: -0.0375388041138649, mean p set: 0.45071205496788025
The modified gen p mean: 0.44954437017440796, gen p mean: -0.03697561100125313, mean p set: 0.45002463459968567
loss_pred:0.016922129318118095, decouple_loss:0.0017623157473281026
loss_pred:0.017654728144407272, decouple_loss:0.0016614538617432117
Iteration: 1003, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449049711227417, gen p mean: -0.043056223541498184, mean p set: 0.4495299756526947The modified gen p mean: 0.45002520084381104, gen p mean: -0.04194334149360657, mean p set: 0.4505055248737335
loss_pred:0.017925402149558067, decouple_loss:0.001342484261840582
loss_pred:0.017264606431126595, decouple_loss:0.0014774104347452521
The modified gen p mean: 0.44941961765289307, gen p mean: -0.04223412647843361, mean p set: 0.44989991188049316
loss_pred:0.01743185892701149, decouple_loss:0.0013376956339925528
Iteration: 1004, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486158788204193, gen p mean: -0.041894227266311646, mean p set: 0.4490962028503418
loss_pred:0.017464280128479004, decouple_loss:0.001594205154106021
The modified gen p mean: 0.4495808482170105, gen p mean: -0.04950638860464096, mean p set: 0.450061172246933The modified gen p mean: 0.45019587874412537, gen p mean: -0.04314063861966133, mean p set: 0.45067617297172546
loss_pred:0.016767501831054688, decouple_loss:0.0016301749274134636
loss_pred:0.01818257011473179, decouple_loss:0.0017488047014921904
Iteration: 1005, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.452502965927124, gen p mean: -0.04442155361175537, mean p set: 0.4529832601547241
The modified gen p mean: 0.45147767663002014, gen p mean: -0.04848402366042137, mean p set: 0.4519580006599426
loss_pred:0.016192656010389328, decouple_loss:0.0015038438141345978
loss_pred:0.017717942595481873, decouple_loss:0.0016108271665871143
The modified gen p mean: 0.44869571924209595, gen p mean: -0.04437408968806267, mean p set: 0.44917601346969604
loss_pred:0.01717044971883297, decouple_loss:0.0013004483189433813
Iteration: 1006, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505603611469269, gen p mean: -0.046766478568315506, mean p set: 0.45104068517684937
The modified gen p mean: 0.44925764203071594, gen p mean: -0.042985089123249054, mean p set: 0.44973790645599365
loss_pred:0.017472120001912117, decouple_loss:0.001683756709098816
loss_pred:0.01701168343424797, decouple_loss:0.0017213135724887252
The modified gen p mean: 0.4501749277114868, gen p mean: -0.052581075578927994, mean p set: 0.4506552517414093
loss_pred:0.017955608665943146, decouple_loss:0.0016672926722094417
Iteration: 1007, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.452571302652359, gen p mean: -0.04568297788500786, mean p set: 0.4530515968799591
loss_pred:0.01721319556236267, decouple_loss:0.0014323395444080234
The modified gen p mean: 0.44978445768356323, gen p mean: -0.04489152505993843, mean p set: 0.4502647817134857The modified gen p mean: 0.45020461082458496, gen p mean: -0.04846373200416565, mean p set: 0.45068490505218506
loss_pred:0.017451250925660133, decouple_loss:0.001324629527516663
loss_pred:0.017390919849276543, decouple_loss:0.001283859135583043
Iteration: 1008, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500104486942291, gen p mean: -0.050739627331495285, mean p set: 0.4504907429218292
loss_pred:0.017812250182032585, decouple_loss:0.0016075028106570244
The modified gen p mean: 0.4519721567630768, gen p mean: -0.04987495765089989, mean p set: 0.4524524509906769The modified gen p mean: 0.4525343179702759, gen p mean: -0.045445315539836884, mean p set: 0.45301464200019836
loss_pred:0.01676276884973049, decouple_loss:0.0017040650127455592
loss_pred:0.01657487079501152, decouple_loss:0.0016345805488526821
Iteration: 1009, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45096728205680847, gen p mean: -0.0398576594889164, mean p set: 0.4514475464820862The modified gen p mean: 0.4493119716644287, gen p mean: -0.04740308225154877, mean p set: 0.4497922658920288
loss_pred:0.017839176580309868, decouple_loss:0.0013567281421273947
loss_pred:0.017539992928504944, decouple_loss:0.0013182824477553368
The modified gen p mean: 0.45089876651763916, gen p mean: -0.03970726206898689, mean p set: 0.45137903094291687
loss_pred:0.01806173473596573, decouple_loss:0.0013092290610074997
Iteration: 1010, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490959942340851, gen p mean: -0.04518508166074753, mean p set: 0.44957631826400757
The modified gen p mean: 0.45145395398139954, gen p mean: -0.0416894257068634, mean p set: 0.45193424820899963
loss_pred:0.017526427283883095, decouple_loss:0.0016721496358513832
loss_pred:0.017884837463498116, decouple_loss:0.0015517267165705562
The modified gen p mean: 0.45040807127952576, gen p mean: -0.04780285805463791, mean p set: 0.45088836550712585
loss_pred:0.017093060538172722, decouple_loss:0.0016147047281265259
2023-05-01 02:11:17 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.05318988114595413, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.048825524747371674, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04929174482822418, mean p set: 0.4500633478164673
loss_pred:0.01846163533627987, decouple_loss:0.001694106264039874
loss_pred:0.01737414300441742, decouple_loss:0.0014471549075096846
loss_pred:0.017537321895360947, decouple_loss:0.0016356492415070534
WV_0_PC_1_EH_0_PS_40, loss: 0.017870649695396423, avg_mse: 0.025631651282310486
current test mse: 0.025632
Iteration: 1011, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494783282279968, gen p mean: -0.05046800151467323, mean p set: 0.4499586224555969
The modified gen p mean: 0.4498424828052521, gen p mean: -0.04310361295938492, mean p set: 0.4503227472305298
The modified gen p mean: 0.44951504468917847, gen p mean: -0.042102329432964325, mean p set: 0.44999533891677856
loss_pred:0.017182834446430206, decouple_loss:0.0012176157906651497
loss_pred:0.016965052112936974, decouple_loss:0.0012867654440924525
loss_pred:0.017447805032134056, decouple_loss:0.0012995809083804488
Iteration: 1012, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44999271631240845, gen p mean: -0.046015914529561996, mean p set: 0.45047301054000854
The modified gen p mean: 0.452386736869812, gen p mean: -0.04507026448845863, mean p set: 0.4528670310974121
loss_pred:0.017710208892822266, decouple_loss:0.0014339551562443376
loss_pred:0.01680085062980652, decouple_loss:0.0014146191533654928
The modified gen p mean: 0.4502578377723694, gen p mean: -0.04521737992763519, mean p set: 0.4507381319999695
loss_pred:0.016882751137018204, decouple_loss:0.0013085890095680952
Iteration: 1013, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44950199127197266, gen p mean: -0.038477636873722076, mean p set: 0.44998228549957275
The modified gen p mean: 0.4499151408672333, gen p mean: -0.04761633649468422, mean p set: 0.450395405292511
loss_pred:0.017366090789437294, decouple_loss:0.0013078058836981654
loss_pred:0.016518251970410347, decouple_loss:0.0014278864255174994
The modified gen p mean: 0.44853904843330383, gen p mean: -0.04667535424232483, mean p set: 0.4490193724632263
loss_pred:0.016601845622062683, decouple_loss:0.001396021107211709
Iteration: 1014, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500272572040558, gen p mean: -0.045022152364254, mean p set: 0.4505075514316559
loss_pred:0.017762186005711555, decouple_loss:0.0012274121399968863
The modified gen p mean: 0.4491751790046692, gen p mean: -0.03927440941333771, mean p set: 0.4496554732322693The modified gen p mean: 0.4498305916786194, gen p mean: -0.03527144715189934, mean p set: 0.4503108859062195
loss_pred:0.017365023493766785, decouple_loss:0.001162678119726479
loss_pred:0.01702520065009594, decouple_loss:0.0011255246354267001
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012001_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012001_3_24hr.npz
NaN value num: 0
Iteration: 1015, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45025599002838135, gen p mean: -0.04708973318338394, mean p set: 0.45073628425598145
loss_pred:0.016197752207517624, decouple_loss:0.0014187134802341461
The modified gen p mean: 0.45011767745018005, gen p mean: -0.04266078397631645, mean p set: 0.45059797167778015The modified gen p mean: 0.4480988383293152, gen p mean: -0.05046252906322479, mean p set: 0.4485791027545929
loss_pred:0.016672953963279724, decouple_loss:0.001281749689951539
loss_pred:0.01635064370930195, decouple_loss:0.0013305121101439
Iteration: 1016, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45214930176734924, gen p mean: -0.04725794866681099, mean p set: 0.45262959599494934
loss_pred:0.01583060435950756, decouple_loss:0.0012336451327428222
The modified gen p mean: 0.4492226541042328, gen p mean: -0.04882163554430008, mean p set: 0.4497029781341553The modified gen p mean: 0.45187345147132874, gen p mean: -0.0499485544860363, mean p set: 0.45235374569892883
loss_pred:0.015752386301755905, decouple_loss:0.001265730825252831
loss_pred:0.016039714217185974, decouple_loss:0.001266908599063754
Iteration: 1017, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45140671730041504, gen p mean: -0.04558379948139191, mean p set: 0.45188701152801514
loss_pred:0.015649205073714256, decouple_loss:0.0012684720568358898
The modified gen p mean: 0.45107895135879517, gen p mean: -0.044373054057359695, mean p set: 0.45155924558639526
The modified gen p mean: 0.45037874579429626, gen p mean: -0.04281392693519592, mean p set: 0.45085906982421875
loss_pred:0.016004255041480064, decouple_loss:0.0012598296161741018
loss_pred:0.016372717916965485, decouple_loss:0.0013179657980799675
Iteration: 1018, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44859692454338074, gen p mean: -0.050526950508356094, mean p set: 0.44907721877098083
loss_pred:0.016199851408600807, decouple_loss:0.0011703084455803037
The modified gen p mean: 0.4487482011318207, gen p mean: -0.04794488474726677, mean p set: 0.44922852516174316The modified gen p mean: 0.4497833847999573, gen p mean: -0.044765084981918335, mean p set: 0.4502636790275574
loss_pred:0.015646900981664658, decouple_loss:0.0011080324184149504
loss_pred:0.015740588307380676, decouple_loss:0.0011428684229031205
Iteration: 1019, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4510978162288666, gen p mean: -0.047174181789159775, mean p set: 0.4515781104564667
loss_pred:0.016207847744226456, decouple_loss:0.0012473657261580229
The modified gen p mean: 0.44909119606018066, gen p mean: -0.04581241309642792, mean p set: 0.44957149028778076The modified gen p mean: 0.4517090916633606, gen p mean: -0.0492449589073658, mean p set: 0.4521893560886383
loss_pred:0.01621423475444317, decouple_loss:0.0013141395756974816
loss_pred:0.016464848071336746, decouple_loss:0.0011092054191976786
Iteration: 1020, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507182240486145, gen p mean: -0.0531531386077404, mean p set: 0.4511985182762146
loss_pred:0.01583675481379032, decouple_loss:0.001341446884907782
The modified gen p mean: 0.44800230860710144, gen p mean: -0.05001310259103775, mean p set: 0.44848257303237915The modified gen p mean: 0.45109590888023376, gen p mean: -0.04414161667227745, mean p set: 0.45157620310783386
loss_pred:0.015469484031200409, decouple_loss:0.0012918539578095078
loss_pred:0.01624598354101181, decouple_loss:0.0012588442768901587
2023-05-01 02:13:55 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.054364629089832306, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.05003569275140762, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.05059300363063812, mean p set: 0.4500633478164673
loss_pred:0.018529929220676422, decouple_loss:0.0013640511315315962
loss_pred:0.017377130687236786, decouple_loss:0.0014305186923593283
loss_pred:0.01758093573153019, decouple_loss:0.0014450331218540668
WV_0_PC_1_EH_0_PS_40, loss: 0.017899993807077408, avg_mse: 0.025713395327329636
current test mse: 0.025713
Iteration: 1021, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44832876324653625, gen p mean: -0.05141096189618111, mean p set: 0.44880905747413635
The modified gen p mean: 0.44834089279174805, gen p mean: -0.04809761047363281, mean p set: 0.44882118701934814
The modified gen p mean: 0.45045655965805054, gen p mean: -0.04555371403694153, mean p set: 0.45093685388565063
loss_pred:0.016437016427516937, decouple_loss:0.0012143764179199934
loss_pred:0.0158291757106781, decouple_loss:0.0012530222302302718
loss_pred:0.016018543392419815, decouple_loss:0.0013478832552209496
Iteration: 1022, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44978296756744385, gen p mean: -0.047673918306827545, mean p set: 0.45026326179504395
loss_pred:0.016147753223776817, decouple_loss:0.0012561589246615767
The modified gen p mean: 0.44864949584007263, gen p mean: -0.04621158540248871, mean p set: 0.4491298198699951The modified gen p mean: 0.45089954137802124, gen p mean: -0.05365453287959099, mean p set: 0.45137983560562134
loss_pred:0.01581893116235733, decouple_loss:0.0012691640295088291
loss_pred:0.015731414780020714, decouple_loss:0.001336121466010809
Iteration: 1023, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45210736989974976, gen p mean: -0.052729811519384384, mean p set: 0.45258763432502747
loss_pred:0.01609548181295395, decouple_loss:0.0013106254627928138
The modified gen p mean: 0.4483596086502075, gen p mean: -0.04557633399963379, mean p set: 0.44883993268013The modified gen p mean: 0.4512201249599457, gen p mean: -0.047124799340963364, mean p set: 0.4517004191875458
loss_pred:0.015469146892428398, decouple_loss:0.0012296036584302783
loss_pred:0.01582907699048519, decouple_loss:0.0012378547107800841
Iteration: 1024, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500531256198883, gen p mean: -0.04380505159497261, mean p set: 0.4505334198474884
loss_pred:0.01587963104248047, decouple_loss:0.0011545087909325957
The modified gen p mean: 0.449003666639328, gen p mean: -0.04568727687001228, mean p set: 0.4494839310646057The modified gen p mean: 0.44979265332221985, gen p mean: -0.040463827550411224, mean p set: 0.45027294754981995
loss_pred:0.015289724804461002, decouple_loss:0.0012267330894246697
loss_pred:0.01594618521630764, decouple_loss:0.0012844089651480317
Iteration: 1025, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44996246695518494, gen p mean: -0.041209928691387177, mean p set: 0.45044276118278503
loss_pred:0.015494713559746742, decouple_loss:0.0011127004399895668
The modified gen p mean: 0.4488142132759094, gen p mean: -0.039883725345134735, mean p set: 0.44929447770118713The modified gen p mean: 0.4506099224090576, gen p mean: -0.040141984820365906, mean p set: 0.4510902166366577
loss_pred:0.01601860485970974, decouple_loss:0.0012039083521813154
loss_pred:0.015946567058563232, decouple_loss:0.001221697311848402
Iteration: 1026, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476472735404968, gen p mean: -0.03890305384993553, mean p set: 0.44812753796577454
loss_pred:0.015979163348674774, decouple_loss:0.0012030606158077717
The modified gen p mean: 0.4516427516937256, gen p mean: -0.04287657141685486, mean p set: 0.4521230459213257The modified gen p mean: 0.4477993845939636, gen p mean: -0.04067111387848854, mean p set: 0.4482796788215637
loss_pred:0.015499595552682877, decouple_loss:0.0012492830865085125
loss_pred:0.01597939245402813, decouple_loss:0.0013629085151478648
Iteration: 1027, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507247507572174, gen p mean: -0.0371997207403183, mean p set: 0.4512050449848175
loss_pred:0.015553288161754608, decouple_loss:0.001342387986369431
The modified gen p mean: 0.450602650642395, gen p mean: -0.031646907329559326, mean p set: 0.45108291506767273The modified gen p mean: 0.4515479803085327, gen p mean: -0.03619998320937157, mean p set: 0.4520282447338104
loss_pred:0.015720242634415627, decouple_loss:0.0011947352904826403
loss_pred:0.016000818461179733, decouple_loss:0.0012137418380007148
Iteration: 1028, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494893252849579, gen p mean: -0.03300982341170311, mean p set: 0.449969619512558
loss_pred:0.016394389793276787, decouple_loss:0.0012512827524915338
The modified gen p mean: 0.4499184191226959, gen p mean: -0.03540146350860596, mean p set: 0.450398713350296The modified gen p mean: 0.4502004384994507, gen p mean: -0.029861655086278915, mean p set: 0.4506807327270508
loss_pred:0.015424872748553753, decouple_loss:0.001281796139664948
loss_pred:0.015883326530456543, decouple_loss:0.0014115972444415092
Iteration: 1029, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.451168417930603, gen p mean: -0.034314606338739395, mean p set: 0.4516487121582031
loss_pred:0.01605801284313202, decouple_loss:0.0012846726458519697
The modified gen p mean: 0.448527067899704, gen p mean: -0.03584359958767891, mean p set: 0.44900739192962646The modified gen p mean: 0.4509420394897461, gen p mean: -0.03811872750520706, mean p set: 0.4514223337173462
loss_pred:0.015970120206475258, decouple_loss:0.001331114792264998
loss_pred:0.01585160382091999, decouple_loss:0.001373033388517797
Iteration: 1030, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486802816390991, gen p mean: -0.03769589960575104, mean p set: 0.4491605758666992
loss_pred:0.015552778728306293, decouple_loss:0.001470414805226028
The modified gen p mean: 0.45139288902282715, gen p mean: -0.038102831691503525, mean p set: 0.45187318325042725The modified gen p mean: 0.4504612982273102, gen p mean: -0.039000753313302994, mean p set: 0.4509415924549103
loss_pred:0.015673639252781868, decouple_loss:0.0013763111783191562
loss_pred:0.015751522034406662, decouple_loss:0.0013570890296250582
2023-05-01 02:15:49 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.04611179605126381, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04194886237382889, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.04239659011363983, mean p set: 0.4500633478164673
loss_pred:0.018569281324744225, decouple_loss:0.0015527628129348159
loss_pred:0.017472347244620323, decouple_loss:0.0013875191798433661
loss_pred:0.01761738955974579, decouple_loss:0.0016200710088014603
WV_0_PC_1_EH_0_PS_40, loss: 0.017962345853447914, avg_mse: 0.025830330327153206
current test mse: 0.02583
Iteration: 1031, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4516884684562683, gen p mean: -0.043941937386989594, mean p set: 0.4521687626838684
The modified gen p mean: 0.4508593678474426, gen p mean: -0.04294373467564583, mean p set: 0.4513396918773651
The modified gen p mean: 0.4497433304786682, gen p mean: -0.03669195622205734, mean p set: 0.4502235949039459
loss_pred:0.015891127288341522, decouple_loss:0.0013157420326024294
loss_pred:0.016129225492477417, decouple_loss:0.0014331070706248283loss_pred:0.01530049555003643, decouple_loss:0.0013669393956661224
Iteration: 1032, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482850134372711, gen p mean: -0.04145422205328941, mean p set: 0.4487653374671936
loss_pred:0.015927184373140335, decouple_loss:0.0013903839280828834
The modified gen p mean: 0.44953253865242004, gen p mean: -0.04125765711069107, mean p set: 0.45001283288002014The modified gen p mean: 0.45068931579589844, gen p mean: -0.04604174569249153, mean p set: 0.4511696398258209
loss_pred:0.015397639945149422, decouple_loss:0.0012225337559357285
loss_pred:0.015918077901005745, decouple_loss:0.001334595144726336
Iteration: 1033, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45202067494392395, gen p mean: -0.04759446531534195, mean p set: 0.45250096917152405
loss_pred:0.015946103259921074, decouple_loss:0.0014304851647466421
The modified gen p mean: 0.45157793164253235, gen p mean: -0.04230377823114395, mean p set: 0.45205825567245483The modified gen p mean: 0.44839081168174744, gen p mean: -0.04533839970827103, mean p set: 0.44887110590934753
loss_pred:0.015889398753643036, decouple_loss:0.0012883543968200684
loss_pred:0.015995770692825317, decouple_loss:0.0011629348155111074
Iteration: 1034, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44793349504470825, gen p mean: -0.04523153230547905, mean p set: 0.44841381907463074
loss_pred:0.015307387337088585, decouple_loss:0.0010958053171634674
The modified gen p mean: 0.4480831027030945, gen p mean: -0.04553642496466637, mean p set: 0.44856342673301697The modified gen p mean: 0.450158029794693, gen p mean: -0.03886646777391434, mean p set: 0.4506383240222931
loss_pred:0.015345505438745022, decouple_loss:0.001159099512733519
loss_pred:0.015716640278697014, decouple_loss:0.001247669686563313
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012018_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012018_3_24hr.npz
NaN value num: 0
Iteration: 1035, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44744613766670227, gen p mean: -0.044729191809892654, mean p set: 0.44792643189430237
loss_pred:0.014859979040920734, decouple_loss:0.0012899155262857676
The modified gen p mean: 0.4478616714477539, gen p mean: -0.04688166081905365, mean p set: 0.448341965675354The modified gen p mean: 0.448133647441864, gen p mean: -0.04638650268316269, mean p set: 0.4486139416694641
loss_pred:0.01459084078669548, decouple_loss:0.001353273750282824
loss_pred:0.014283040538430214, decouple_loss:0.0012908391654491425
Iteration: 1036, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44806525111198425, gen p mean: -0.04280973970890045, mean p set: 0.44854554533958435
loss_pred:0.013589760288596153, decouple_loss:0.0012512205867096782
The modified gen p mean: 0.4483509063720703, gen p mean: -0.0442509688436985, mean p set: 0.4488312005996704The modified gen p mean: 0.44763636589050293, gen p mean: -0.04223601892590523, mean p set: 0.4481166899204254
loss_pred:0.013859957456588745, decouple_loss:0.001241578022018075
loss_pred:0.014939804561436176, decouple_loss:0.0012900802539661527
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1037, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44880369305610657, gen p mean: -0.04107697680592537, mean p set: 0.44928398728370667
loss_pred:0.014568530954420567, decouple_loss:0.0013740027789026499
The modified gen p mean: 0.4472784698009491, gen p mean: -0.045775070786476135, mean p set: 0.4477587640285492The modified gen p mean: 0.44799745082855225, gen p mean: -0.04722682759165764, mean p set: 0.44847777485847473
loss_pred:0.01396523043513298, decouple_loss:0.0013979526702314615
loss_pred:0.013992033898830414, decouple_loss:0.0015176807064563036
Iteration: 1038, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44780224561691284, gen p mean: -0.04645318537950516, mean p set: 0.44828253984451294
loss_pred:0.014079863205552101, decouple_loss:0.0013720380375161767
The modified gen p mean: 0.44787734746932983, gen p mean: -0.04465052857995033, mean p set: 0.4483576714992523The modified gen p mean: 0.44799932837486267, gen p mean: -0.045973919332027435, mean p set: 0.44847962260246277
loss_pred:0.014386971481144428, decouple_loss:0.0013442299095913768
loss_pred:0.014725547283887863, decouple_loss:0.0013598330551758409
Iteration: 1039, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478335976600647, gen p mean: -0.04291481152176857, mean p set: 0.4483139216899872
loss_pred:0.01388641819357872, decouple_loss:0.0013794112019240856
The modified gen p mean: 0.4475034177303314, gen p mean: -0.04764408990740776, mean p set: 0.4479837417602539The modified gen p mean: 0.44811344146728516, gen p mean: -0.04234280064702034, mean p set: 0.44859370589256287
loss_pred:0.014211966656148434, decouple_loss:0.0012797139352187514
loss_pred:0.014031395316123962, decouple_loss:0.0013952559093013406
Iteration: 1040, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44762691855430603, gen p mean: -0.04728686809539795, mean p set: 0.44810721278190613
The modified gen p mean: 0.4476151466369629, gen p mean: -0.04455612599849701, mean p set: 0.448095440864563
loss_pred:0.013714417815208435, decouple_loss:0.0014770528068765998
loss_pred:0.01331399753689766, decouple_loss:0.001330078928731382
The modified gen p mean: 0.44832858443260193, gen p mean: -0.040323104709386826, mean p set: 0.4488089084625244
loss_pred:0.014263179153203964, decouple_loss:0.0013544337125495076
2023-05-01 02:18:26 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.04436974227428436, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04084470495581627, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.04102246090769768, mean p set: 0.4500633478164673
loss_pred:0.019116897135972977, decouple_loss:0.0014374280581250787
loss_pred:0.018032018095254898, decouple_loss:0.0013597197830677032
loss_pred:0.018096119165420532, decouple_loss:0.0013154488988220692
WV_0_PC_1_EH_0_PS_40, loss: 0.01848355494439602, avg_mse: 0.026841754093766212
current test mse: 0.026842
Iteration: 1041, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482262134552002, gen p mean: -0.04067011922597885, mean p set: 0.4487065374851227
The modified gen p mean: 0.448001891374588, gen p mean: -0.041327398270368576, mean p set: 0.4484822154045105
The modified gen p mean: 0.4477216899394989, gen p mean: -0.04472984001040459, mean p set: 0.448201984167099
loss_pred:0.013231171295046806, decouple_loss:0.0013008472742512822
loss_pred:0.013721550814807415, decouple_loss:0.0014140558196231723
loss_pred:0.013848341070115566, decouple_loss:0.0013097879709675908
Iteration: 1042, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44811728596687317, gen p mean: -0.04348527640104294, mean p set: 0.44859760999679565
loss_pred:0.014439932070672512, decouple_loss:0.001581755350343883
The modified gen p mean: 0.44728922843933105, gen p mean: -0.04893305152654648, mean p set: 0.44776955246925354The modified gen p mean: 0.44753900170326233, gen p mean: -0.04294322803616524, mean p set: 0.4480193257331848
loss_pred:0.013882172293961048, decouple_loss:0.0013538766652345657
loss_pred:0.013537266291677952, decouple_loss:0.0013115991605445743
Iteration: 1043, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448762446641922, gen p mean: -0.0440262146294117, mean p set: 0.4492427408695221
The modified gen p mean: 0.44868525862693787, gen p mean: -0.04364541545510292, mean p set: 0.4491655230522156
loss_pred:0.013686710968613625, decouple_loss:0.0014421958476305008
loss_pred:0.013653728179633617, decouple_loss:0.0014845810364931822
The modified gen p mean: 0.44878119230270386, gen p mean: -0.04847653582692146, mean p set: 0.44926151633262634
loss_pred:0.013223622925579548, decouple_loss:0.0013583911349996924
Iteration: 1044, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491630792617798, gen p mean: -0.04576237499713898, mean p set: 0.4496433436870575
loss_pred:0.01362360268831253, decouple_loss:0.0013038772158324718
The modified gen p mean: 0.4478529691696167, gen p mean: -0.04437782242894173, mean p set: 0.4483332633972168The modified gen p mean: 0.44771623611450195, gen p mean: -0.04464409127831459, mean p set: 0.44819650053977966
loss_pred:0.01351279765367508, decouple_loss:0.0014093265635892749
loss_pred:0.013098055496811867, decouple_loss:0.0014123684959486127
Iteration: 1045, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474197328090668, gen p mean: -0.04704243317246437, mean p set: 0.4478999972343445
loss_pred:0.013643331825733185, decouple_loss:0.0013453633291646838
The modified gen p mean: 0.44780269265174866, gen p mean: -0.047901540994644165, mean p set: 0.44828298687934875The modified gen p mean: 0.4480687975883484, gen p mean: -0.046642154455184937, mean p set: 0.4485490918159485
loss_pred:0.014349817298352718, decouple_loss:0.001406582072377205
loss_pred:0.013842067681252956, decouple_loss:0.00135774293448776
Iteration: 1046, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44795525074005127, gen p mean: -0.04941253736615181, mean p set: 0.44843557476997375
loss_pred:0.013621187768876553, decouple_loss:0.0013464007060974836
The modified gen p mean: 0.44841691851615906, gen p mean: -0.04397675767540932, mean p set: 0.44889721274375916The modified gen p mean: 0.44794991612434387, gen p mean: -0.0442153736948967, mean p set: 0.44843021035194397
loss_pred:0.013568950816988945, decouple_loss:0.0014083553105592728
loss_pred:0.013143589720129967, decouple_loss:0.0013741496950387955
Iteration: 1047, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44806358218193054, gen p mean: -0.04645085707306862, mean p set: 0.44854387640953064
loss_pred:0.013631828129291534, decouple_loss:0.0013616663636639714
The modified gen p mean: 0.4482947587966919, gen p mean: -0.04674740880727768, mean p set: 0.448775053024292The modified gen p mean: 0.4484274089336395, gen p mean: -0.048103608191013336, mean p set: 0.4489077031612396
loss_pred:0.012851301580667496, decouple_loss:0.0014038411900401115
loss_pred:0.014172307215631008, decouple_loss:0.0013357659336179495
Iteration: 1048, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471258223056793, gen p mean: -0.04925880953669548, mean p set: 0.4476061165332794
loss_pred:0.013446712866425514, decouple_loss:0.0013520123902708292
The modified gen p mean: 0.4481147229671478, gen p mean: -0.04620904475450516, mean p set: 0.4485950171947479The modified gen p mean: 0.44741690158843994, gen p mean: -0.046021200716495514, mean p set: 0.44789719581604004
loss_pred:0.013530055060982704, decouple_loss:0.0013396847061812878
loss_pred:0.013736817054450512, decouple_loss:0.0013757915003225207
Iteration: 1049, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44790560007095337, gen p mean: -0.04355562850832939, mean p set: 0.44838589429855347
loss_pred:0.013547698967158794, decouple_loss:0.0014578173868358135
The modified gen p mean: 0.4481903612613678, gen p mean: -0.048802804201841354, mean p set: 0.4486706554889679The modified gen p mean: 0.447795033454895, gen p mean: -0.04874766990542412, mean p set: 0.4482753276824951
loss_pred:0.013083897531032562, decouple_loss:0.0013862550258636475
loss_pred:0.013855848461389542, decouple_loss:0.0013291150098666549
Iteration: 1050, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44719934463500977, gen p mean: -0.048547033220529556, mean p set: 0.4476796090602875
loss_pred:0.013550013303756714, decouple_loss:0.001304732752032578
The modified gen p mean: 0.4477713406085968, gen p mean: -0.04607674106955528, mean p set: 0.4482516348361969The modified gen p mean: 0.44749870896339417, gen p mean: -0.044974736869335175, mean p set: 0.44797900319099426
loss_pred:0.013723233714699745, decouple_loss:0.001357711968012154
loss_pred:0.013694053515791893, decouple_loss:0.0012731637107208371
2023-05-01 02:20:19 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.04810554161667824, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04472443833947182, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.04461877420544624, mean p set: 0.4500633478164673
loss_pred:0.01900571398437023, decouple_loss:0.0014074341161176562
loss_pred:0.01799408532679081, decouple_loss:0.0014242039760574698
loss_pred:0.01801137998700142, decouple_loss:0.0013777603162452579
WV_0_PC_1_EH_0_PS_40, loss: 0.018407218158245087, avg_mse: 0.02675025537610054
current test mse: 0.02675
Iteration: 1051, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44811609387397766, gen p mean: -0.050192415714263916, mean p set: 0.44859638810157776
The modified gen p mean: 0.448560506105423, gen p mean: -0.045889489352703094, mean p set: 0.44904080033302307
The modified gen p mean: 0.44771310687065125, gen p mean: -0.04896242544054985, mean p set: 0.44819343090057373
loss_pred:0.013414071872830391, decouple_loss:0.0013467924436554313
loss_pred:0.012762700207531452, decouple_loss:0.001385874580591917loss_pred:0.013854061253368855, decouple_loss:0.001318486174568534
Iteration: 1052, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44754910469055176, gen p mean: -0.051109734922647476, mean p set: 0.44802939891815186
loss_pred:0.013426702469587326, decouple_loss:0.0012956116115674376
The modified gen p mean: 0.44778382778167725, gen p mean: -0.04514136165380478, mean p set: 0.44826412200927734The modified gen p mean: 0.44798144698143005, gen p mean: -0.0453951433300972, mean p set: 0.44846177101135254
loss_pred:0.013362700119614601, decouple_loss:0.0013205698924139142
loss_pred:0.013509705662727356, decouple_loss:0.0013461234048008919
Iteration: 1053, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44844841957092285, gen p mean: -0.046807803213596344, mean p set: 0.44892874360084534
The modified gen p mean: 0.44773542881011963, gen p mean: -0.0516996867954731, mean p set: 0.4482157230377197
loss_pred:0.013473876751959324, decouple_loss:0.0012535301502794027
loss_pred:0.013035014271736145, decouple_loss:0.0013203872367739677
The modified gen p mean: 0.4475157856941223, gen p mean: -0.045665811747312546, mean p set: 0.4479960799217224
loss_pred:0.013712434098124504, decouple_loss:0.0014189690118655562
Iteration: 1054, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44791802763938904, gen p mean: -0.04672086238861084, mean p set: 0.44839832186698914
loss_pred:0.012903894297778606, decouple_loss:0.0013068595435470343
The modified gen p mean: 0.44751855731010437, gen p mean: -0.048341456800699234, mean p set: 0.44799885153770447The modified gen p mean: 0.44788500666618347, gen p mean: -0.04892604425549507, mean p set: 0.44836533069610596
loss_pred:0.013591715134680271, decouple_loss:0.0012743913102895021
loss_pred:0.013123794458806515, decouple_loss:0.0011578693520277739
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012016_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012016_3_24hr.npz
NaN value num: 0
Iteration: 1055, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471006393432617, gen p mean: -0.05254953354597092, mean p set: 0.44758090376853943
loss_pred:0.014143360778689384, decouple_loss:0.0014484251150861382
The modified gen p mean: 0.44735559821128845, gen p mean: -0.046034425497055054, mean p set: 0.44783589243888855The modified gen p mean: 0.4469631314277649, gen p mean: -0.048885755240917206, mean p set: 0.447443425655365
loss_pred:0.01383259054273367, decouple_loss:0.0012965835630893707
loss_pred:0.014218563213944435, decouple_loss:0.0012923895847052336
Iteration: 1056, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44748654961586, gen p mean: -0.04745181277394295, mean p set: 0.4479668438434601
loss_pred:0.01469260361045599, decouple_loss:0.0013203999260440469
The modified gen p mean: 0.4476642608642578, gen p mean: -0.04592113569378853, mean p set: 0.4481445848941803The modified gen p mean: 0.4476320445537567, gen p mean: -0.04484345391392708, mean p set: 0.4481123387813568
loss_pred:0.013817637227475643, decouple_loss:0.0012073162943124771
loss_pred:0.013566077686846256, decouple_loss:0.001217780401930213
Iteration: 1057, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44701892137527466, gen p mean: -0.04930250719189644, mean p set: 0.44749921560287476
The modified gen p mean: 0.44745898246765137, gen p mean: -0.05058508738875389, mean p set: 0.44793930649757385
loss_pred:0.014552921056747437, decouple_loss:0.0013344187755137682
loss_pred:0.01425903383642435, decouple_loss:0.0011941301636397839
The modified gen p mean: 0.44719043374061584, gen p mean: -0.04876963421702385, mean p set: 0.44767072796821594
loss_pred:0.014371300116181374, decouple_loss:0.001133445417508483
Iteration: 1058, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44781494140625, gen p mean: -0.054462019354104996, mean p set: 0.4482952058315277
The modified gen p mean: 0.44665274024009705, gen p mean: -0.04680527001619339, mean p set: 0.44713303446769714
loss_pred:0.013893414288759232, decouple_loss:0.001311780302785337
loss_pred:0.013571010902523994, decouple_loss:0.001288539613597095
The modified gen p mean: 0.4477413594722748, gen p mean: -0.050083402544260025, mean p set: 0.4482216238975525
loss_pred:0.014515944756567478, decouple_loss:0.0012778674717992544
Iteration: 1059, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4462769329547882, gen p mean: -0.0472596250474453, mean p set: 0.4467572569847107
The modified gen p mean: 0.4463063180446625, gen p mean: -0.050385408103466034, mean p set: 0.44678664207458496
loss_pred:0.013505750335752964, decouple_loss:0.0012084530899301171
loss_pred:0.01390857994556427, decouple_loss:0.0013072713045403361
The modified gen p mean: 0.44800665974617004, gen p mean: -0.05233065411448479, mean p set: 0.44848695397377014
loss_pred:0.013922061771154404, decouple_loss:0.0012815077789127827
Iteration: 1060, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44772130250930786, gen p mean: -0.053747471421957016, mean p set: 0.44820162653923035
loss_pred:0.014322871342301369, decouple_loss:0.001284867525100708
The modified gen p mean: 0.4475240707397461, gen p mean: -0.05564511939883232, mean p set: 0.4480043649673462
The modified gen p mean: 0.4471185505390167, gen p mean: -0.05070091038942337, mean p set: 0.4475988745689392
loss_pred:0.014363971538841724, decouple_loss:0.001430682372301817
loss_pred:0.013942966237664223, decouple_loss:0.0014323637587949634
2023-05-01 02:22:53 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.05343558266758919, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.050010401755571365, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.050185345113277435, mean p set: 0.4500633478164673
loss_pred:0.0190809965133667, decouple_loss:0.001263073063455522
loss_pred:0.01810021512210369, decouple_loss:0.0011565632885321975
loss_pred:0.018065443262457848, decouple_loss:0.0011916784569621086
WV_0_PC_1_EH_0_PS_40, loss: 0.018475741147994995, avg_mse: 0.026924559846520424
current test mse: 0.026925
Iteration: 1061, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475373327732086, gen p mean: -0.05225434899330139, mean p set: 0.4480176270008087
The modified gen p mean: 0.44858667254447937, gen p mean: -0.05242174491286278, mean p set: 0.4490669369697571
The modified gen p mean: 0.4485894441604614, gen p mean: -0.05172554776072502, mean p set: 0.4490697383880615
loss_pred:0.013499935157597065, decouple_loss:0.0012516953283920884
loss_pred:0.014037225395441055, decouple_loss:0.001198635553009808
loss_pred:0.013714073225855827, decouple_loss:0.0012099298182874918
Iteration: 1062, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44677072763442993, gen p mean: -0.04992109164595604, mean p set: 0.44725102186203003
The modified gen p mean: 0.4477626085281372, gen p mean: -0.05554504320025444, mean p set: 0.4482428729534149loss_pred:0.013683009892702103, decouple_loss:0.0011851313756778836
The modified gen p mean: 0.4476095139980316, gen p mean: -0.05001251772046089, mean p set: 0.4480897784233093
loss_pred:0.01393149420619011, decouple_loss:0.0013112046290189028
loss_pred:0.013711836189031601, decouple_loss:0.0012867775512859225
Iteration: 1063, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44691622257232666, gen p mean: -0.05706881359219551, mean p set: 0.44739648699760437
loss_pred:0.014531372115015984, decouple_loss:0.0012784048449248075
The modified gen p mean: 0.4483295977115631, gen p mean: -0.05453456565737724, mean p set: 0.4488099217414856The modified gen p mean: 0.4475264549255371, gen p mean: -0.053504638373851776, mean p set: 0.4480067491531372
loss_pred:0.013879855163395405, decouple_loss:0.0013407269725576043
loss_pred:0.014438606798648834, decouple_loss:0.0013136107008904219
Iteration: 1064, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44785475730895996, gen p mean: -0.05162261053919792, mean p set: 0.44833505153656006
loss_pred:0.014081691391766071, decouple_loss:0.0013098909985274076
The modified gen p mean: 0.44759684801101685, gen p mean: -0.05098452419042587, mean p set: 0.44807714223861694The modified gen p mean: 0.44723111391067505, gen p mean: -0.054245103150606155, mean p set: 0.44771143794059753
loss_pred:0.013762040063738823, decouple_loss:0.0012233228189870715
loss_pred:0.013909205794334412, decouple_loss:0.00123629963491112
Iteration: 1065, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473235309123993, gen p mean: -0.05051282048225403, mean p set: 0.4478038251399994
loss_pred:0.013818463310599327, decouple_loss:0.001348680118098855
The modified gen p mean: 0.44698387384414673, gen p mean: -0.05153520405292511, mean p set: 0.4474641680717468The modified gen p mean: 0.4471803605556488, gen p mean: -0.051563557237386703, mean p set: 0.4476606547832489
loss_pred:0.014278534799814224, decouple_loss:0.001200835220515728
loss_pred:0.013957630842924118, decouple_loss:0.0011968899052590132
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1066, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475800395011902, gen p mean: -0.05454128608107567, mean p set: 0.4480603337287903
loss_pred:0.013578863814473152, decouple_loss:0.0013189815217629075
The modified gen p mean: 0.44720011949539185, gen p mean: -0.052881669253110886, mean p set: 0.44768041372299194The modified gen p mean: 0.44752684235572815, gen p mean: -0.05404416844248772, mean p set: 0.44800713658332825
loss_pred:0.013449852354824543, decouple_loss:0.0013233969220891595
loss_pred:0.013691418804228306, decouple_loss:0.0013585137203335762
Iteration: 1067, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473910927772522, gen p mean: -0.047063589096069336, mean p set: 0.4478713572025299
loss_pred:0.014396978542208672, decouple_loss:0.001321875024586916
The modified gen p mean: 0.44719043374061584, gen p mean: -0.055570799857378006, mean p set: 0.44767072796821594The modified gen p mean: 0.44779273867607117, gen p mean: -0.04882991313934326, mean p set: 0.4482730031013489
loss_pred:0.014234752394258976, decouple_loss:0.0013127439888194203
loss_pred:0.013675561174750328, decouple_loss:0.0011884267441928387
Iteration: 1068, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481312930583954, gen p mean: -0.0496990866959095, mean p set: 0.4486115872859955
loss_pred:0.013993484899401665, decouple_loss:0.001117925625294447
The modified gen p mean: 0.4471842646598816, gen p mean: -0.050313059240579605, mean p set: 0.4476645588874817The modified gen p mean: 0.4476197361946106, gen p mean: -0.05012524873018265, mean p set: 0.4481000304222107
loss_pred:0.013966458849608898, decouple_loss:0.001152094453573227
loss_pred:0.013939943164587021, decouple_loss:0.0012507684295997024
Iteration: 1069, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44654354453086853, gen p mean: -0.05110745504498482, mean p set: 0.44702383875846863
loss_pred:0.01377833727747202, decouple_loss:0.0012760574463754892
The modified gen p mean: 0.44601359963417053, gen p mean: -0.04856818541884422, mean p set: 0.44649389386177063The modified gen p mean: 0.44758734107017517, gen p mean: -0.05270174890756607, mean p set: 0.44806763529777527
loss_pred:0.013357519172132015, decouple_loss:0.0012838367838412523
loss_pred:0.01367234531790018, decouple_loss:0.0012917185667902231
Iteration: 1070, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474899172782898, gen p mean: -0.04882432892918587, mean p set: 0.4479702413082123
loss_pred:0.013464436866343021, decouple_loss:0.001121471868827939
The modified gen p mean: 0.44776326417922974, gen p mean: -0.05210878700017929, mean p set: 0.44824355840682983The modified gen p mean: 0.448035329580307, gen p mean: -0.048773143440485, mean p set: 0.4485156238079071
loss_pred:0.014076057821512222, decouple_loss:0.0012014054227620363
loss_pred:0.013126672245562077, decouple_loss:0.0011505009606480598
2023-05-01 02:24:46 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.04926461726427078, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.045732107013463974, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.04605697840452194, mean p set: 0.4500633478164673
loss_pred:0.01912367343902588, decouple_loss:0.0012388391187414527
loss_pred:0.018129145726561546, decouple_loss:0.0012505176709964871
loss_pred:0.01810968853533268, decouple_loss:0.0011747477110475302
WV_0_PC_1_EH_0_PS_40, loss: 0.01851523667573929, avg_mse: 0.02700876258313656
current test mse: 0.027009
Iteration: 1071, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44715288281440735, gen p mean: -0.04739422723650932, mean p set: 0.44763314723968506
The modified gen p mean: 0.44707900285720825, gen p mean: -0.04379387944936752, mean p set: 0.44755926728248596
The modified gen p mean: 0.44729751348495483, gen p mean: -0.04788016527891159, mean p set: 0.4477778375148773
loss_pred:0.013327721506357193, decouple_loss:0.0011444574920460582
loss_pred:0.014150789007544518, decouple_loss:0.0011703540803864598
loss_pred:0.014455577358603477, decouple_loss:0.0011649922234937549
Iteration: 1072, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44733738899230957, gen p mean: -0.0446297861635685, mean p set: 0.44781771302223206
loss_pred:0.0141051160171628, decouple_loss:0.0013372001703828573
The modified gen p mean: 0.4477905035018921, gen p mean: -0.04898213595151901, mean p set: 0.4482708275318146The modified gen p mean: 0.44814151525497437, gen p mean: -0.04996535927057266, mean p set: 0.4486217796802521
loss_pred:0.014279507100582123, decouple_loss:0.0011868937872350216
loss_pred:0.013581182807683945, decouple_loss:0.0012042513117194176
Iteration: 1073, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44744566082954407, gen p mean: -0.04714595898985863, mean p set: 0.44792598485946655
loss_pred:0.013911536894738674, decouple_loss:0.0010791354579851031
The modified gen p mean: 0.44729742407798767, gen p mean: -0.04653205722570419, mean p set: 0.44777771830558777The modified gen p mean: 0.4479086697101593, gen p mean: -0.04365479573607445, mean p set: 0.4483889639377594
loss_pred:0.013517474755644798, decouple_loss:0.001103810267522931
loss_pred:0.013750073499977589, decouple_loss:0.0010686492314562201
Iteration: 1074, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472668766975403, gen p mean: -0.04737551137804985, mean p set: 0.44774720072746277
loss_pred:0.013348877429962158, decouple_loss:0.001207412569783628
The modified gen p mean: 0.4468156695365906, gen p mean: -0.04545927047729492, mean p set: 0.44729599356651306The modified gen p mean: 0.4475558400154114, gen p mean: -0.04403947666287422, mean p set: 0.4480361342430115
loss_pred:0.013185505755245686, decouple_loss:0.0013127594720572233
loss_pred:0.013924681581556797, decouple_loss:0.0013318521669134498
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012015_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012015_3_24hr.npz
NaN value num: 0
Iteration: 1075, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44841551780700684, gen p mean: -0.04812376946210861, mean p set: 0.44889581203460693
loss_pred:0.014153271913528442, decouple_loss:0.0012415585806593299
The modified gen p mean: 0.4484618008136749, gen p mean: -0.04561375454068184, mean p set: 0.4489421248435974The modified gen p mean: 0.44818437099456787, gen p mean: -0.04751289635896683, mean p set: 0.4486646354198456
loss_pred:0.01376392412930727, decouple_loss:0.0011895759962499142
loss_pred:0.014024457894265652, decouple_loss:0.0010675741359591484
Iteration: 1076, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44937098026275635, gen p mean: -0.0385969914495945, mean p set: 0.44985130429267883
loss_pred:0.014558538794517517, decouple_loss:0.0011779017513617873
The modified gen p mean: 0.44716429710388184, gen p mean: -0.043825894594192505, mean p set: 0.44764459133148193The modified gen p mean: 0.4482795000076294, gen p mean: -0.043764106929302216, mean p set: 0.4487598240375519
loss_pred:0.013600125908851624, decouple_loss:0.001153513672761619
loss_pred:0.014441304840147495, decouple_loss:0.0011000591330230236
Iteration: 1077, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447185218334198, gen p mean: -0.043588265776634216, mean p set: 0.4476655125617981
loss_pred:0.01339411735534668, decouple_loss:0.0011131979990750551
The modified gen p mean: 0.4453616142272949, gen p mean: -0.0514838844537735, mean p set: 0.44584187865257263The modified gen p mean: 0.4471014440059662, gen p mean: -0.04420614615082741, mean p set: 0.4475817382335663
loss_pred:0.014107516035437584, decouple_loss:0.0012102075852453709
loss_pred:0.01395088154822588, decouple_loss:0.0011863274266943336
Iteration: 1078, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472449719905853, gen p mean: -0.04774726182222366, mean p set: 0.4477252662181854
loss_pred:0.014446472749114037, decouple_loss:0.0011756271123886108
The modified gen p mean: 0.4480310380458832, gen p mean: -0.04537865146994591, mean p set: 0.4485113322734833The modified gen p mean: 0.4475211501121521, gen p mean: -0.04691348969936371, mean p set: 0.4480014741420746
loss_pred:0.013524306006729603, decouple_loss:0.001173363416455686
loss_pred:0.013752141036093235, decouple_loss:0.0011029255110770464
Iteration: 1079, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4459594190120697, gen p mean: -0.05126528814435005, mean p set: 0.4464397132396698
loss_pred:0.014073077589273453, decouple_loss:0.001190648996271193
The modified gen p mean: 0.445667028427124, gen p mean: -0.05337990075349808, mean p set: 0.4461473524570465The modified gen p mean: 0.4463588297367096, gen p mean: -0.04609265923500061, mean p set: 0.4468391239643097
loss_pred:0.013956863433122635, decouple_loss:0.0013362609315663576
loss_pred:0.013811489567160606, decouple_loss:0.0011695424327626824
Iteration: 1080, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44779133796691895, gen p mean: -0.049617573618888855, mean p set: 0.44827160239219666
loss_pred:0.014436780475080013, decouple_loss:0.0010548733407631516
The modified gen p mean: 0.4474603533744812, gen p mean: -0.05113229528069496, mean p set: 0.4479406476020813
The modified gen p mean: 0.44597190618515015, gen p mean: -0.05224604532122612, mean p set: 0.44645223021507263
loss_pred:0.01388441864401102, decouple_loss:0.0010064688976854086
loss_pred:0.013886160217225552, decouple_loss:0.0011696122819557786
2023-05-01 02:27:21 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.05186023563146591, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04843495041131973, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.048674095422029495, mean p set: 0.4500633478164673
loss_pred:0.019358396530151367, decouple_loss:0.0013370056403800845
loss_pred:0.01826103962957859, decouple_loss:0.0011124351294711232
loss_pred:0.018254483118653297, decouple_loss:0.0011923349229618907
WV_0_PC_1_EH_0_PS_40, loss: 0.018685337156057358, avg_mse: 0.027344191446900368
current test mse: 0.027344
Iteration: 1081, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477511942386627, gen p mean: -0.05476047471165657, mean p set: 0.4482314884662628
The modified gen p mean: 0.4490233063697815, gen p mean: -0.04669208079576492, mean p set: 0.4495036005973816
The modified gen p mean: 0.44860631227493286, gen p mean: -0.05097731947898865, mean p set: 0.44908660650253296
loss_pred:0.013500918634235859, decouple_loss:0.00140373595058918
loss_pred:0.013544764369726181, decouple_loss:0.001193283125758171
loss_pred:0.014851677231490612, decouple_loss:0.001075540785677731
Iteration: 1082, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44919607043266296, gen p mean: -0.04102000966668129, mean p set: 0.44967639446258545
loss_pred:0.014192625880241394, decouple_loss:0.0010755950352177024
The modified gen p mean: 0.4484391212463379, gen p mean: -0.04728949815034866, mean p set: 0.448919415473938The modified gen p mean: 0.4475595951080322, gen p mean: -0.0456276498734951, mean p set: 0.4480399191379547
loss_pred:0.013688884675502777, decouple_loss:0.0011950895423069596
loss_pred:0.013353143818676472, decouple_loss:0.0011007045395672321
Iteration: 1083, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485762417316437, gen p mean: -0.04968967288732529, mean p set: 0.4490565061569214
loss_pred:0.013471584767103195, decouple_loss:0.0011606430634856224
The modified gen p mean: 0.4471625089645386, gen p mean: -0.043395254760980606, mean p set: 0.44764280319213867
The modified gen p mean: 0.4481883943080902, gen p mean: -0.04889986291527748, mean p set: 0.4486686885356903
loss_pred:0.01397738792002201, decouple_loss:0.0011996172834187746
loss_pred:0.013963066972792149, decouple_loss:0.0011891121976077557
Iteration: 1084, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487364590167999, gen p mean: -0.044108208268880844, mean p set: 0.4492167532444
loss_pred:0.014650567434728146, decouple_loss:0.0012023592134937644
The modified gen p mean: 0.448388934135437, gen p mean: -0.04382283613085747, mean p set: 0.4488692581653595The modified gen p mean: 0.44719794392585754, gen p mean: -0.05057242512702942, mean p set: 0.44767823815345764
loss_pred:0.013541517779231071, decouple_loss:0.0011924471473321319
loss_pred:0.01415978092700243, decouple_loss:0.001262473757378757
Iteration: 1085, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448258638381958, gen p mean: -0.041048813611269, mean p set: 0.4487389624118805
loss_pred:0.014680622145533562, decouple_loss:0.0010190769098699093
The modified gen p mean: 0.44882652163505554, gen p mean: -0.042624279856681824, mean p set: 0.44930681586265564
The modified gen p mean: 0.4474125802516937, gen p mean: -0.049156878143548965, mean p set: 0.4478928744792938
loss_pred:0.014677558094263077, decouple_loss:0.0010511688888072968
loss_pred:0.013520307838916779, decouple_loss:0.0010818042792379856
Iteration: 1086, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479886591434479, gen p mean: -0.04973197355866432, mean p set: 0.448468953371048
loss_pred:0.013648143038153648, decouple_loss:0.0012456144904717803
The modified gen p mean: 0.44778892397880554, gen p mean: -0.04932810366153717, mean p set: 0.44826918840408325The modified gen p mean: 0.44896137714385986, gen p mean: -0.039275117218494415, mean p set: 0.44944167137145996
loss_pred:0.014185184612870216, decouple_loss:0.0011390479048714042
loss_pred:0.013772993348538876, decouple_loss:0.0011787430848926306
Iteration: 1087, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44764211773872375, gen p mean: -0.051943715661764145, mean p set: 0.44812238216400146
loss_pred:0.013746319338679314, decouple_loss:0.001169202383607626
The modified gen p mean: 0.44746750593185425, gen p mean: -0.04922553524374962, mean p set: 0.44794782996177673The modified gen p mean: 0.44762107729911804, gen p mean: -0.0484895221889019, mean p set: 0.4481014013290405
loss_pred:0.014056771993637085, decouple_loss:0.001127015333622694
loss_pred:0.013798129744827747, decouple_loss:0.0011663708137348294
Iteration: 1088, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480283856391907, gen p mean: -0.04665988311171532, mean p set: 0.44850867986679077
loss_pred:0.013716242276132107, decouple_loss:0.0012126847868785262
The modified gen p mean: 0.4485549032688141, gen p mean: -0.04459678381681442, mean p set: 0.4490351974964142The modified gen p mean: 0.44732341170310974, gen p mean: -0.0442814826965332, mean p set: 0.44780370593070984
loss_pred:0.013337242417037487, decouple_loss:0.0013152502942830324
loss_pred:0.01414214726537466, decouple_loss:0.0013455285225063562
Iteration: 1089, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44796302914619446, gen p mean: -0.05374326929450035, mean p set: 0.44844329357147217
loss_pred:0.013460531830787659, decouple_loss:0.0013516569742932916
The modified gen p mean: 0.44821879267692566, gen p mean: -0.05224153771996498, mean p set: 0.44869908690452576The modified gen p mean: 0.44641435146331787, gen p mean: -0.05298679694533348, mean p set: 0.44689464569091797
loss_pred:0.013319890946149826, decouple_loss:0.0013238665414974093
loss_pred:0.013897005468606949, decouple_loss:0.0011821744265034795
Iteration: 1090, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44798973202705383, gen p mean: -0.0468207448720932, mean p set: 0.44847002625465393
loss_pred:0.014239131473004818, decouple_loss:0.0014063207199797034
The modified gen p mean: 0.4463062286376953, gen p mean: -0.054841313511133194, mean p set: 0.4467865526676178The modified gen p mean: 0.4474680721759796, gen p mean: -0.05211034044623375, mean p set: 0.4479483664035797
loss_pred:0.013498389162123203, decouple_loss:0.0013163978001102805
loss_pred:0.013923359103500843, decouple_loss:0.001507539302110672
2023-05-01 02:29:15 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.05341816321015358, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.050207264721393585, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.05025748908519745, mean p set: 0.4500633478164673
loss_pred:0.019585849717259407, decouple_loss:0.0013825113419443369
loss_pred:0.018418792635202408, decouple_loss:0.0013024682411924005
loss_pred:0.018449461087584496, decouple_loss:0.0013314771931618452
WV_0_PC_1_EH_0_PS_40, loss: 0.01888497732579708, avg_mse: 0.02772429585456848
current test mse: 0.027724
Iteration: 1091, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471522867679596, gen p mean: -0.05072075128555298, mean p set: 0.4476326107978821
The modified gen p mean: 0.4489551782608032, gen p mean: -0.05027265474200249, mean p set: 0.4494354724884033
The modified gen p mean: 0.447562575340271, gen p mean: -0.05286874622106552, mean p set: 0.4480428397655487
loss_pred:0.01315409503877163, decouple_loss:0.0011562500149011612
loss_pred:0.013280115090310574, decouple_loss:0.0011627244530245662loss_pred:0.013770165853202343, decouple_loss:0.001299759722314775
Iteration: 1092, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44903576374053955, gen p mean: -0.05137436091899872, mean p set: 0.44951605796813965
loss_pred:0.013502233661711216, decouple_loss:0.0012758394004777074
The modified gen p mean: 0.44835665822029114, gen p mean: -0.04986574500799179, mean p set: 0.4488369822502136The modified gen p mean: 0.44597384333610535, gen p mean: -0.05042532831430435, mean p set: 0.44645413756370544
loss_pred:0.013678116723895073, decouple_loss:0.0012219721684232354
loss_pred:0.013665694743394852, decouple_loss:0.001389845972880721
Iteration: 1093, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468974173069, gen p mean: -0.0465712696313858, mean p set: 0.4473777115345001
loss_pred:0.013963563367724419, decouple_loss:0.0012434949167072773
The modified gen p mean: 0.4477037787437439, gen p mean: -0.05305679142475128, mean p set: 0.448184072971344The modified gen p mean: 0.4484703540802002, gen p mean: -0.05162882059812546, mean p set: 0.4489506781101227
loss_pred:0.013599978759884834, decouple_loss:0.0012847252655774355
loss_pred:0.013240400701761246, decouple_loss:0.0013365973718464375
Iteration: 1094, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482065737247467, gen p mean: -0.044474925845861435, mean p set: 0.4486868679523468
loss_pred:0.013607566244900227, decouple_loss:0.0012007619952782989
The modified gen p mean: 0.44793835282325745, gen p mean: -0.043671172112226486, mean p set: 0.44841864705085754The modified gen p mean: 0.44729092717170715, gen p mean: -0.046318553388118744, mean p set: 0.44777119159698486
loss_pred:0.01345389150083065, decouple_loss:0.0011543596629053354
loss_pred:0.013559481129050255, decouple_loss:0.0012176516465842724
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012018_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012018_3_24hr.npz
NaN value num: 0
Iteration: 1095, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44797590374946594, gen p mean: -0.040802955627441406, mean p set: 0.44845619797706604
loss_pred:0.01792219839990139, decouple_loss:0.001331988605670631
The modified gen p mean: 0.4491898715496063, gen p mean: -0.04250015690922737, mean p set: 0.44967013597488403The modified gen p mean: 0.44757699966430664, gen p mean: -0.045322466641664505, mean p set: 0.44805729389190674
loss_pred:0.0185137540102005, decouple_loss:0.001372810686007142
loss_pred:0.019832339137792587, decouple_loss:0.0013974127359688282
Iteration: 1096, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44826894998550415, gen p mean: -0.04344576224684715, mean p set: 0.44874924421310425
The modified gen p mean: 0.44772714376449585, gen p mean: -0.046230826526880264, mean p set: 0.44820740818977356
loss_pred:0.018329184502363205, decouple_loss:0.0013301955768838525
loss_pred:0.019019553437829018, decouple_loss:0.0013609473826363683
The modified gen p mean: 0.4481064975261688, gen p mean: -0.047533322125673294, mean p set: 0.4485867917537689
loss_pred:0.019113926216959953, decouple_loss:0.0014022074174135923
Iteration: 1097, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480954706668854, gen p mean: -0.04563893377780914, mean p set: 0.4485757648944855
loss_pred:0.01813068427145481, decouple_loss:0.001344939460977912
The modified gen p mean: 0.44797283411026, gen p mean: -0.04742284491658211, mean p set: 0.4484530985355377The modified gen p mean: 0.4475128650665283, gen p mean: -0.04553156718611717, mean p set: 0.4479931592941284
loss_pred:0.017868945375084877, decouple_loss:0.0014388160780072212
loss_pred:0.018176717683672905, decouple_loss:0.0014587006298825145
Iteration: 1098, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44906744360923767, gen p mean: -0.05293292924761772, mean p set: 0.4495477080345154
loss_pred:0.018163051456212997, decouple_loss:0.0015423798467963934
The modified gen p mean: 0.44850051403045654, gen p mean: -0.0540502704679966, mean p set: 0.44898083806037903The modified gen p mean: 0.4485818147659302, gen p mean: -0.05423012375831604, mean p set: 0.4490620791912079
loss_pred:0.018661700189113617, decouple_loss:0.0014625618932768703
loss_pred:0.01930953748524189, decouple_loss:0.0014112372882664204
Iteration: 1099, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488906264305115, gen p mean: -0.05288713425397873, mean p set: 0.44937095046043396
loss_pred:0.018509168177843094, decouple_loss:0.0014757334720343351
The modified gen p mean: 0.4481285512447357, gen p mean: -0.0573231540620327, mean p set: 0.4486088454723358
The modified gen p mean: 0.44820618629455566, gen p mean: -0.05410678684711456, mean p set: 0.44868648052215576
loss_pred:0.018200820311903954, decouple_loss:0.0015188072575256228
loss_pred:0.01780892163515091, decouple_loss:0.0014172144001349807
Iteration: 1100, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44887346029281616, gen p mean: -0.05905051901936531, mean p set: 0.44935378432273865
loss_pred:0.01844542659819126, decouple_loss:0.0013729505008086562
The modified gen p mean: 0.4495514929294586, gen p mean: -0.0600961335003376, mean p set: 0.4500318169593811The modified gen p mean: 0.44801101088523865, gen p mean: -0.05790671706199646, mean p set: 0.44849130511283875
loss_pred:0.01765494793653488, decouple_loss:0.0014201926533132792
loss_pred:0.017327958717942238, decouple_loss:0.0014109655749052763
2023-05-01 02:31:43 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.06730588525533676, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.063783660531044, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.0642385333776474, mean p set: 0.4500633478164673
loss_pred:0.018594492226839066, decouple_loss:0.0014982180437073112
loss_pred:0.017462534829974174, decouple_loss:0.001406823517754674
loss_pred:0.01758527010679245, decouple_loss:0.001412911107763648
WV_0_PC_1_EH_0_PS_40, loss: 0.017952732741832733, avg_mse: 0.02576274983584881
current test mse: 0.025763
Iteration: 1101, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476563036441803, gen p mean: -0.061673615127801895, mean p set: 0.4481366276741028
The modified gen p mean: 0.44938093423843384, gen p mean: -0.06698881834745407, mean p set: 0.44986119866371155
The modified gen p mean: 0.4461364448070526, gen p mean: -0.06443982571363449, mean p set: 0.4466167390346527
loss_pred:0.019277820363640785, decouple_loss:0.0013764958130195737
loss_pred:0.017842169851064682, decouple_loss:0.0014338381588459015loss_pred:0.018277635797858238, decouple_loss:0.0014107858296483755
Iteration: 1102, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44624578952789307, gen p mean: -0.06674081832170486, mean p set: 0.44672608375549316
loss_pred:0.01869143918156624, decouple_loss:0.0014135405654087663
The modified gen p mean: 0.44710925221443176, gen p mean: -0.06706108897924423, mean p set: 0.44758954644203186
The modified gen p mean: 0.4483500123023987, gen p mean: -0.062340982258319855, mean p set: 0.4488303065299988
loss_pred:0.018668584525585175, decouple_loss:0.0013623922131955624
loss_pred:0.017875829711556435, decouple_loss:0.001290059881284833
Iteration: 1103, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490949511528015, gen p mean: -0.05724652111530304, mean p set: 0.449575275182724
loss_pred:0.018034180626273155, decouple_loss:0.001400247449055314
The modified gen p mean: 0.4480680525302887, gen p mean: -0.06639089435338974, mean p set: 0.4485483467578888The modified gen p mean: 0.44777607917785645, gen p mean: -0.06017086282372475, mean p set: 0.44825637340545654
loss_pred:0.017854975536465645, decouple_loss:0.0013676874805241823
loss_pred:0.018465228378772736, decouple_loss:0.0015645575476810336
Iteration: 1104, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44672706723213196, gen p mean: -0.04988909512758255, mean p set: 0.44720733165740967
The modified gen p mean: 0.4492214322090149, gen p mean: -0.05150742083787918, mean p set: 0.4497016966342926
loss_pred:0.01802988350391388, decouple_loss:0.0013144463300704956
loss_pred:0.018289273604750633, decouple_loss:0.0013047382235527039
The modified gen p mean: 0.4478619396686554, gen p mean: -0.05609697848558426, mean p set: 0.4483422338962555
loss_pred:0.01802193559706211, decouple_loss:0.001373570179566741
Iteration: 1105, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44796857237815857, gen p mean: -0.055083971470594406, mean p set: 0.4484488368034363
The modified gen p mean: 0.44753506779670715, gen p mean: -0.04896733537316322, mean p set: 0.44801533222198486
loss_pred:0.017793934792280197, decouple_loss:0.001411832170560956
loss_pred:0.017434554174542427, decouple_loss:0.0013631903566420078
The modified gen p mean: 0.4482825696468353, gen p mean: -0.057517629116773605, mean p set: 0.4487628936767578
loss_pred:0.018292834982275963, decouple_loss:0.0014579200651496649
Iteration: 1106, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473099410533905, gen p mean: -0.053106412291526794, mean p set: 0.447790265083313
The modified gen p mean: 0.4482520520687103, gen p mean: -0.05254804342985153, mean p set: 0.44873231649398804
loss_pred:0.01789209619164467, decouple_loss:0.0013711282517760992
loss_pred:0.01777929998934269, decouple_loss:0.0013905835803598166
The modified gen p mean: 0.4467930793762207, gen p mean: -0.0517825148999691, mean p set: 0.4472734034061432
loss_pred:0.018846387043595314, decouple_loss:0.00138087198138237
Iteration: 1107, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44830670952796936, gen p mean: -0.05355699360370636, mean p set: 0.44878700375556946
The modified gen p mean: 0.45025891065597534, gen p mean: -0.05360434576869011, mean p set: 0.4507392346858978
loss_pred:0.018403341993689537, decouple_loss:0.0012138168094679713
loss_pred:0.01723676547408104, decouple_loss:0.001260471297428012
The modified gen p mean: 0.4467003345489502, gen p mean: -0.056118860840797424, mean p set: 0.4471806287765503
loss_pred:0.01843990385532379, decouple_loss:0.0013225749135017395
Iteration: 1108, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483039677143097, gen p mean: -0.057711441069841385, mean p set: 0.4487842321395874
loss_pred:0.01779012568295002, decouple_loss:0.0012472170637920499
The modified gen p mean: 0.4472379982471466, gen p mean: -0.053786929696798325, mean p set: 0.4477182924747467The modified gen p mean: 0.44583308696746826, gen p mean: -0.059728894382715225, mean p set: 0.44631341099739075
loss_pred:0.018695009872317314, decouple_loss:0.0012810230255126953
loss_pred:0.018646128475666046, decouple_loss:0.0013816398568451405
Iteration: 1109, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44652047753334045, gen p mean: -0.05630914866924286, mean p set: 0.44700080156326294
loss_pred:0.018579808995127678, decouple_loss:0.0011449200101196766
The modified gen p mean: 0.4465082287788391, gen p mean: -0.05613114312291145, mean p set: 0.4469884932041168The modified gen p mean: 0.4470476806163788, gen p mean: -0.060969118028879166, mean p set: 0.4475279748439789
loss_pred:0.018010396510362625, decouple_loss:0.0012669858988374472
loss_pred:0.018776249140501022, decouple_loss:0.001187870861031115
Iteration: 1110, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44760385155677795, gen p mean: -0.05767237767577171, mean p set: 0.44808417558670044
The modified gen p mean: 0.4473567306995392, gen p mean: -0.05590071529150009, mean p set: 0.4478370249271393
loss_pred:0.01844898611307144, decouple_loss:0.0012037447886541486
loss_pred:0.018110673874616623, decouple_loss:0.0012674666941165924
The modified gen p mean: 0.44899240136146545, gen p mean: -0.05545390397310257, mean p set: 0.44947269558906555
loss_pred:0.018062828108668327, decouple_loss:0.001159552251920104
2023-05-01 02:33:37 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.06232238560914993, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.05802810192108154, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.05857161059975624, mean p set: 0.4500633478164673
loss_pred:0.018465666100382805, decouple_loss:0.0013611046597361565
loss_pred:0.01734994351863861, decouple_loss:0.0013072004076093435
loss_pred:0.017499418929219246, decouple_loss:0.0013367501087486744
WV_0_PC_1_EH_0_PS_40, loss: 0.017838427796959877, avg_mse: 0.02555989846587181
current test mse: 0.02556
Iteration: 1111, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476211667060852, gen p mean: -0.05946195125579834, mean p set: 0.4481014907360077
The modified gen p mean: 0.4477001428604126, gen p mean: -0.056874360889196396, mean p set: 0.4481804668903351
The modified gen p mean: 0.448026180267334, gen p mean: -0.0604715496301651, mean p set: 0.4485064744949341
loss_pred:0.018011894077062607, decouple_loss:0.001206936314702034
loss_pred:0.018471254035830498, decouple_loss:0.0012158615281805396
loss_pred:0.0176780316978693, decouple_loss:0.001330014318227768
Iteration: 1112, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44721996784210205, gen p mean: -0.05878228321671486, mean p set: 0.44770026206970215
loss_pred:0.018682293593883514, decouple_loss:0.0011649677762761712
The modified gen p mean: 0.44722896814346313, gen p mean: -0.058815330266952515, mean p set: 0.44770923256874084The modified gen p mean: 0.44806066155433655, gen p mean: -0.06491336226463318, mean p set: 0.44854092597961426
loss_pred:0.01843937113881111, decouple_loss:0.0011150321224704385
loss_pred:0.018152544274926186, decouple_loss:0.0011959531111642718
Iteration: 1113, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488983154296875, gen p mean: -0.05748238414525986, mean p set: 0.4493786096572876
loss_pred:0.017364347353577614, decouple_loss:0.0013509892160072923
The modified gen p mean: 0.44676050543785095, gen p mean: -0.059076327830553055, mean p set: 0.44724079966545105The modified gen p mean: 0.44812726974487305, gen p mean: -0.052724115550518036, mean p set: 0.44860756397247314
loss_pred:0.01881427690386772, decouple_loss:0.0013561235973611474
loss_pred:0.01700015179812908, decouple_loss:0.0013452814891934395
Iteration: 1114, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503830373287201, gen p mean: -0.053617049008607864, mean p set: 0.4508633017539978
loss_pred:0.017132986336946487, decouple_loss:0.0011327562388032675
The modified gen p mean: 0.4461628794670105, gen p mean: -0.050505246967077255, mean p set: 0.4466431736946106The modified gen p mean: 0.4474814534187317, gen p mean: -0.05108170583844185, mean p set: 0.4479617476463318
loss_pred:0.018307629972696304, decouple_loss:0.0011938107199966908
loss_pred:0.01728058233857155, decouple_loss:0.0011538885300979018
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012011_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012011_3_24hr.npz
NaN value num: 0
Iteration: 1115, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44786781072616577, gen p mean: -0.05373266711831093, mean p set: 0.44834810495376587
loss_pred:0.01753370650112629, decouple_loss:0.0011642175959423184
The modified gen p mean: 0.4475606679916382, gen p mean: -0.05136825889348984, mean p set: 0.44804099202156067The modified gen p mean: 0.44786715507507324, gen p mean: -0.05237819254398346, mean p set: 0.44834744930267334
loss_pred:0.017846960574388504, decouple_loss:0.001175974728539586
loss_pred:0.017794767394661903, decouple_loss:0.0012876347173005342
Iteration: 1116, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488181471824646, gen p mean: -0.047614168375730515, mean p set: 0.4492984712123871
loss_pred:0.016689613461494446, decouple_loss:0.0011233700206503272
The modified gen p mean: 0.44728732109069824, gen p mean: -0.04984843358397484, mean p set: 0.44776758551597595The modified gen p mean: 0.44700631499290466, gen p mean: -0.04870544373989105, mean p set: 0.44748660922050476
loss_pred:0.016826491802930832, decouple_loss:0.0011271635303273797
loss_pred:0.018015868961811066, decouple_loss:0.0011546240421012044
Iteration: 1117, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475783109664917, gen p mean: -0.054832879453897476, mean p set: 0.4480586349964142
loss_pred:0.01788744516670704, decouple_loss:0.0011294871801510453
The modified gen p mean: 0.44788849353790283, gen p mean: -0.04928307235240936, mean p set: 0.44836878776550293The modified gen p mean: 0.44699928164482117, gen p mean: -0.05246559530496597, mean p set: 0.44747960567474365
loss_pred:0.01757829263806343, decouple_loss:0.0012267238926142454
loss_pred:0.016701729968190193, decouple_loss:0.001130859600380063
Iteration: 1118, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449051171541214, gen p mean: -0.05199863016605377, mean p set: 0.4495314955711365
loss_pred:0.017849281430244446, decouple_loss:0.0010557095520198345
The modified gen p mean: 0.44839930534362793, gen p mean: -0.05354640632867813, mean p set: 0.448879599571228The modified gen p mean: 0.4480271637439728, gen p mean: -0.04859047010540962, mean p set: 0.4485074579715729
loss_pred:0.017432304099202156, decouple_loss:0.0010906023671850562
loss_pred:0.017647726461291313, decouple_loss:0.0010977049823850393
Iteration: 1119, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482695758342743, gen p mean: -0.055863894522190094, mean p set: 0.4487498700618744
loss_pred:0.01690588891506195, decouple_loss:0.0010864792857319117
The modified gen p mean: 0.4475327730178833, gen p mean: -0.05746890604496002, mean p set: 0.4480130672454834The modified gen p mean: 0.44828546047210693, gen p mean: -0.052956268191337585, mean p set: 0.44876575469970703
loss_pred:0.017291879281401634, decouple_loss:0.0011014611227437854
loss_pred:0.017518268898129463, decouple_loss:0.0011405365075916052
Iteration: 1120, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472469985485077, gen p mean: -0.05385037884116173, mean p set: 0.4477272629737854
loss_pred:0.01748831756412983, decouple_loss:0.0011950340121984482
The modified gen p mean: 0.4476255774497986, gen p mean: -0.04976246878504753, mean p set: 0.4481058716773987The modified gen p mean: 0.44946858286857605, gen p mean: -0.05331971496343613, mean p set: 0.44994887709617615
loss_pred:0.017345668748021126, decouple_loss:0.0010680218692868948
loss_pred:0.017264537513256073, decouple_loss:0.0010773175163194537
2023-05-01 02:36:10 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.05049114301800728, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04615039750933647, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.046676553785800934, mean p set: 0.4500633478164673
loss_pred:0.018367182463407516, decouple_loss:0.0012595194857567549
loss_pred:0.017274411395192146, decouple_loss:0.0011883995030075312
loss_pred:0.017424097284674644, decouple_loss:0.0011845348635688424
WV_0_PC_1_EH_0_PS_40, loss: 0.017749104648828506, avg_mse: 0.025453392416238785
current test mse: 0.025453
Iteration: 1121, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478951692581177, gen p mean: -0.0464717298746109, mean p set: 0.4483754336833954
The modified gen p mean: 0.4475497901439667, gen p mean: -0.04686613008379936, mean p set: 0.4480300843715668
The modified gen p mean: 0.44796356558799744, gen p mean: -0.04829806834459305, mean p set: 0.44844383001327515
loss_pred:0.016849471256136894, decouple_loss:0.0011850944720208645
loss_pred:0.017888864502310753, decouple_loss:0.001200281665660441
loss_pred:0.01689326949417591, decouple_loss:0.0012394108343869448
Iteration: 1122, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468826949596405, gen p mean: -0.04689323157072067, mean p set: 0.4473629891872406
loss_pred:0.01737903617322445, decouple_loss:0.0010608371812850237
The modified gen p mean: 0.4470180869102478, gen p mean: -0.04770980775356293, mean p set: 0.4474983811378479The modified gen p mean: 0.4475826621055603, gen p mean: -0.048401348292827606, mean p set: 0.4480629861354828
loss_pred:0.017850277945399284, decouple_loss:0.001109294593334198
loss_pred:0.018140101805329323, decouple_loss:0.0011179022258147597
Iteration: 1123, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490186870098114, gen p mean: -0.04028112068772316, mean p set: 0.4494989514350891
loss_pred:0.017333148047327995, decouple_loss:0.001177074620500207
The modified gen p mean: 0.44791364669799805, gen p mean: -0.04033647105097771, mean p set: 0.44839391112327576The modified gen p mean: 0.44775673747062683, gen p mean: -0.0440768264234066, mean p set: 0.44823703169822693
loss_pred:0.016786053776741028, decouple_loss:0.0011465760180726647
loss_pred:0.01902061514556408, decouple_loss:0.001101609435863793
Iteration: 1124, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484841525554657, gen p mean: -0.043924879282712936, mean p set: 0.4489644169807434
loss_pred:0.016993341967463493, decouple_loss:0.0010327980853617191
The modified gen p mean: 0.4464336037635803, gen p mean: -0.04028845578432083, mean p set: 0.4469138979911804The modified gen p mean: 0.4468432068824768, gen p mean: -0.043107375502586365, mean p set: 0.4473235011100769
loss_pred:0.019219044595956802, decouple_loss:0.0010229730978608131
loss_pred:0.0190920177847147, decouple_loss:0.0010681160492822528
Iteration: 1125, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447632372379303, gen p mean: -0.04554590955376625, mean p set: 0.44811269640922546
loss_pred:0.017688602209091187, decouple_loss:0.0011020111851394176
The modified gen p mean: 0.44687744975090027, gen p mean: -0.04360846057534218, mean p set: 0.44735774397850037The modified gen p mean: 0.4455285668373108, gen p mean: -0.04026397690176964, mean p set: 0.4460088610649109
loss_pred:0.01734461449086666, decouple_loss:0.0010915177408605814
loss_pred:0.017740398645401, decouple_loss:0.0011427155695855618
Iteration: 1126, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44710806012153625, gen p mean: -0.0477648489177227, mean p set: 0.44758832454681396
loss_pred:0.019162209704518318, decouple_loss:0.0010739569552242756
The modified gen p mean: 0.4479265809059143, gen p mean: -0.04271795228123665, mean p set: 0.4484068751335144The modified gen p mean: 0.44696488976478577, gen p mean: -0.04808219149708748, mean p set: 0.44744521379470825
loss_pred:0.017430664971470833, decouple_loss:0.0011304778745397925
loss_pred:0.0174899660050869, decouple_loss:0.0010829769307747483
Iteration: 1127, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44756054878234863, gen p mean: -0.05103817582130432, mean p set: 0.4480408728122711
loss_pred:0.018069123849272728, decouple_loss:0.001088508521206677
The modified gen p mean: 0.4469090700149536, gen p mean: -0.049770571291446686, mean p set: 0.4473893940448761The modified gen p mean: 0.44835206866264343, gen p mean: -0.05024712160229683, mean p set: 0.44883236289024353
loss_pred:0.017765551805496216, decouple_loss:0.0011863611871376634
loss_pred:0.01776736043393612, decouple_loss:0.0010844768257811666
Iteration: 1128, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474712014198303, gen p mean: -0.05429556220769882, mean p set: 0.44795146584510803
loss_pred:0.017828887328505516, decouple_loss:0.0010050188284367323
The modified gen p mean: 0.44749295711517334, gen p mean: -0.05547076836228371, mean p set: 0.44797322154045105The modified gen p mean: 0.4477536678314209, gen p mean: -0.04824059084057808, mean p set: 0.4482339918613434
loss_pred:0.018103213980793953, decouple_loss:0.0010343027533963323
loss_pred:0.017163563519716263, decouple_loss:0.001041751354932785
Iteration: 1129, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484071135520935, gen p mean: -0.05350113660097122, mean p set: 0.4488873779773712
loss_pred:0.01774197444319725, decouple_loss:0.0011933937203139067
The modified gen p mean: 0.4484109878540039, gen p mean: -0.054171089082956314, mean p set: 0.4488913118839264The modified gen p mean: 0.4476946294307709, gen p mean: -0.05265286937355995, mean p set: 0.44817492365837097
loss_pred:0.017475351691246033, decouple_loss:0.001133133890107274
loss_pred:0.01637413166463375, decouple_loss:0.001213113428093493
Iteration: 1130, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475351572036743, gen p mean: -0.04868736490607262, mean p set: 0.448015421628952
loss_pred:0.016689904034137726, decouple_loss:0.0010205762227997184
The modified gen p mean: 0.44710037112236023, gen p mean: -0.04731348529458046, mean p set: 0.4475806653499603The modified gen p mean: 0.44752395153045654, gen p mean: -0.05240575969219208, mean p set: 0.44800424575805664
loss_pred:0.017377855256199837, decouple_loss:0.0009870938956737518
loss_pred:0.016454346477985382, decouple_loss:0.0010176635114476085
2023-05-01 02:38:04 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.046717505902051926, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04237453266978264, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.04297136515378952, mean p set: 0.4500633478164673
loss_pred:0.018367482349276543, decouple_loss:0.0011128701735287905
loss_pred:0.017305275425314903, decouple_loss:0.0011823427630588412
loss_pred:0.017372116446495056, decouple_loss:0.001176749705336988
WV_0_PC_1_EH_0_PS_40, loss: 0.017739489674568176, avg_mse: 0.025461213663220406
current test mse: 0.025461
Iteration: 1131, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44960346817970276, gen p mean: -0.04688899591565132, mean p set: 0.45008379220962524
The modified gen p mean: 0.448434442281723, gen p mean: -0.04764468967914581, mean p set: 0.44891470670700073
The modified gen p mean: 0.44846656918525696, gen p mean: -0.04249058663845062, mean p set: 0.44894686341285706
loss_pred:0.017172323539853096, decouple_loss:0.0010648505995050073
loss_pred:0.01664651371538639, decouple_loss:0.001141835586167872
loss_pred:0.016715778037905693, decouple_loss:0.0011053300695493817
Iteration: 1132, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44651171565055847, gen p mean: -0.04163946583867073, mean p set: 0.4469919800758362
The modified gen p mean: 0.4481663703918457, gen p mean: -0.04064463824033737, mean p set: 0.4486467242240906
loss_pred:0.01877920888364315, decouple_loss:0.0010534406173974276
loss_pred:0.01761057786643505, decouple_loss:0.001185837434604764
The modified gen p mean: 0.446107417345047, gen p mean: -0.04279845580458641, mean p set: 0.4465877413749695
loss_pred:0.017470039427280426, decouple_loss:0.001158902421593666
Iteration: 1133, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478825330734253, gen p mean: -0.040320590138435364, mean p set: 0.4483628571033478
loss_pred:0.018907351419329643, decouple_loss:0.0010394417913630605
The modified gen p mean: 0.4481637179851532, gen p mean: -0.038797955960035324, mean p set: 0.4486440122127533The modified gen p mean: 0.44798776507377625, gen p mean: -0.041419170796871185, mean p set: 0.44846805930137634
loss_pred:0.017708992585539818, decouple_loss:0.0011267500231042504
loss_pred:0.017855044454336166, decouple_loss:0.0010761548765003681
Iteration: 1134, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4458010792732239, gen p mean: -0.036676693707704544, mean p set: 0.44628140330314636
loss_pred:0.017518047243356705, decouple_loss:0.0011528913164511323
The modified gen p mean: 0.44760170578956604, gen p mean: -0.0414733923971653, mean p set: 0.4480820298194885The modified gen p mean: 0.4474649131298065, gen p mean: -0.03808879107236862, mean p set: 0.4479452073574066
loss_pred:0.017568791285157204, decouple_loss:0.0012042808812111616
loss_pred:0.01659100316464901, decouple_loss:0.0011322215432301164
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012000_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012000_3_24hr.npz
NaN value num: 0
Iteration: 1135, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44760647416114807, gen p mean: -0.03578467294573784, mean p set: 0.44808676838874817
loss_pred:0.01639004796743393, decouple_loss:0.001055047963745892
The modified gen p mean: 0.4463949501514435, gen p mean: -0.03636356070637703, mean p set: 0.4468752145767212The modified gen p mean: 0.44772329926490784, gen p mean: -0.04106467589735985, mean p set: 0.44820359349250793
loss_pred:0.01634356565773487, decouple_loss:0.0010902206413447857
loss_pred:0.01666761375963688, decouple_loss:0.0010415402939543128
Iteration: 1136, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44694972038269043, gen p mean: -0.031374335289001465, mean p set: 0.44742998480796814
loss_pred:0.017845580354332924, decouple_loss:0.0009626179817132652
The modified gen p mean: 0.44731462001800537, gen p mean: -0.0372692234814167, mean p set: 0.44779494404792786The modified gen p mean: 0.44848689436912537, gen p mean: -0.04327070340514183, mean p set: 0.44896718859672546
loss_pred:0.017202191054821014, decouple_loss:0.0010012085549533367
loss_pred:0.01701742596924305, decouple_loss:0.0011354662710800767
Iteration: 1137, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44681090116500854, gen p mean: -0.041635237634181976, mean p set: 0.44729119539260864
loss_pred:0.016574300825595856, decouple_loss:0.001065087621100247
The modified gen p mean: 0.4469488859176636, gen p mean: -0.04144992306828499, mean p set: 0.44742920994758606The modified gen p mean: 0.4472357928752899, gen p mean: -0.039163727313280106, mean p set: 0.4477160573005676
loss_pred:0.01664602942764759, decouple_loss:0.0010741064324975014
loss_pred:0.016444416716694832, decouple_loss:0.0010330644436180592
Iteration: 1138, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446159690618515, gen p mean: -0.038743067532777786, mean p set: 0.4466399550437927
loss_pred:0.016640909016132355, decouple_loss:0.001153858145698905
The modified gen p mean: 0.4472602307796478, gen p mean: -0.042132362723350525, mean p set: 0.4477405250072479The modified gen p mean: 0.4476805627346039, gen p mean: -0.03950408101081848, mean p set: 0.448160856962204
loss_pred:0.016382016241550446, decouple_loss:0.0011074935318902135
loss_pred:0.01710496097803116, decouple_loss:0.0010529292048886418
Iteration: 1139, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469947814941406, gen p mean: -0.03974858671426773, mean p set: 0.4474751055240631
loss_pred:0.01600991189479828, decouple_loss:0.0010156251955777407
The modified gen p mean: 0.44675564765930176, gen p mean: -0.039782751351594925, mean p set: 0.44723597168922424The modified gen p mean: 0.4476718306541443, gen p mean: -0.039937932044267654, mean p set: 0.448152095079422
loss_pred:0.016738424077630043, decouple_loss:0.001060044509358704
loss_pred:0.016612419858574867, decouple_loss:0.000934003503061831
Iteration: 1140, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470890164375305, gen p mean: -0.044147759675979614, mean p set: 0.447569340467453
The modified gen p mean: 0.4470345973968506, gen p mean: -0.042592357844114304, mean p set: 0.4475148916244507
loss_pred:0.01664368249475956, decouple_loss:0.0010411083931103349
loss_pred:0.01637149788439274, decouple_loss:0.0010309175122529268
The modified gen p mean: 0.44622308015823364, gen p mean: -0.04119553416967392, mean p set: 0.44670340418815613
loss_pred:0.016434989869594574, decouple_loss:0.0009203936788253486
2023-05-01 02:40:44 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.04117631912231445, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.03712554648518562, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.037607789039611816, mean p set: 0.4500633478164673
loss_pred:0.018323557451367378, decouple_loss:0.001083675306290388
loss_pred:0.01725521683692932, decouple_loss:0.0011183018796145916
loss_pred:0.01736360415816307, decouple_loss:0.0010438667377457023
WV_0_PC_1_EH_0_PS_40, loss: 0.017701556906104088, avg_mse: 0.025367554277181625
current test mse: 0.025368
At step 1140, Best test: 0.025368
save model to /work/09012/haoli1/ls6/ERA5_PredRNN/checkpoints/WV_0_PC_1_EH_0_PS_40/model_model_test_schedule_sampling_DynaMean.ckpt
Iteration: 1141, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473946988582611, gen p mean: -0.041048284620046616, mean p set: 0.4478749930858612
loss_pred:0.016740547493100166, decouple_loss:0.0011521014384925365
The modified gen p mean: 0.4471486806869507, gen p mean: -0.03412005305290222, mean p set: 0.44762900471687317The modified gen p mean: 0.4472377598285675, gen p mean: -0.0343937948346138, mean p set: 0.4477180242538452
loss_pred:0.01645023003220558, decouple_loss:0.0010395664721727371loss_pred:0.017603229731321335, decouple_loss:0.0010865936055779457
Iteration: 1142, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464568793773651, gen p mean: -0.03894003853201866, mean p set: 0.4469371736049652
loss_pred:0.016302350908517838, decouple_loss:0.001020208466798067
The modified gen p mean: 0.4471362829208374, gen p mean: -0.04537497088313103, mean p set: 0.4476166069507599
The modified gen p mean: 0.446189284324646, gen p mean: -0.042162973433732986, mean p set: 0.4466695487499237
loss_pred:0.016729438677430153, decouple_loss:0.0010804753983393312
loss_pred:0.016560694202780724, decouple_loss:0.0009808589238673449
Iteration: 1143, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44661176204681396, gen p mean: -0.046212337911129, mean p set: 0.44709208607673645
loss_pred:0.01645328849554062, decouple_loss:0.0012164129875600338
The modified gen p mean: 0.4478931128978729, gen p mean: -0.04631374031305313, mean p set: 0.448373407125473The modified gen p mean: 0.4461573660373688, gen p mean: -0.043765563517808914, mean p set: 0.44663766026496887
loss_pred:0.0164803396910429, decouple_loss:0.0010919923661276698
loss_pred:0.01677885465323925, decouple_loss:0.0011047970037907362
Iteration: 1144, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44754984974861145, gen p mean: -0.043109238147735596, mean p set: 0.44803011417388916
loss_pred:0.017772391438484192, decouple_loss:0.0011950061889365315
The modified gen p mean: 0.44653427600860596, gen p mean: -0.04419860243797302, mean p set: 0.44701457023620605The modified gen p mean: 0.4469406008720398, gen p mean: -0.05087434500455856, mean p set: 0.4474208950996399
loss_pred:0.016277329996228218, decouple_loss:0.0010692577343434095
loss_pred:0.01678287982940674, decouple_loss:0.0010774609399959445
Iteration: 1145, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484701454639435, gen p mean: -0.04201967641711235, mean p set: 0.4489504396915436
loss_pred:0.017250221222639084, decouple_loss:0.001158118830062449
The modified gen p mean: 0.44905388355255127, gen p mean: -0.04951931908726692, mean p set: 0.44953420758247375The modified gen p mean: 0.4463563859462738, gen p mean: -0.045742906630039215, mean p set: 0.4468367099761963
loss_pred:0.016525749117136, decouple_loss:0.0011927292216569185
loss_pred:0.016804656013846397, decouple_loss:0.001225711195729673
Iteration: 1146, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44772693514823914, gen p mean: -0.045763276517391205, mean p set: 0.44820722937583923
loss_pred:0.017129162326455116, decouple_loss:0.0010531529551371932
The modified gen p mean: 0.44758981466293335, gen p mean: -0.04168655350804329, mean p set: 0.44807007908821106The modified gen p mean: 0.44732069969177246, gen p mean: -0.045823972672224045, mean p set: 0.44780099391937256
loss_pred:0.016615141183137894, decouple_loss:0.0010113820899277925
loss_pred:0.01619800180196762, decouple_loss:0.000996928894892335
Iteration: 1147, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44698771834373474, gen p mean: -0.04528902471065521, mean p set: 0.44746798276901245
loss_pred:0.016545161604881287, decouple_loss:0.0013080196222290397
The modified gen p mean: 0.4474177658557892, gen p mean: -0.04578809440135956, mean p set: 0.4478980302810669The modified gen p mean: 0.44721198081970215, gen p mean: -0.04372059926390648, mean p set: 0.44769227504730225
loss_pred:0.016118861734867096, decouple_loss:0.001316790352575481
loss_pred:0.016413366422057152, decouple_loss:0.001413739169947803
Iteration: 1148, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472954571247101, gen p mean: -0.03907788172364235, mean p set: 0.44777578115463257
loss_pred:0.016382046043872833, decouple_loss:0.001000970252789557
The modified gen p mean: 0.4475298821926117, gen p mean: -0.035757262259721756, mean p set: 0.4480101466178894The modified gen p mean: 0.44717586040496826, gen p mean: -0.04011471942067146, mean p set: 0.44765612483024597
loss_pred:0.016570717096328735, decouple_loss:0.0009955265559256077
loss_pred:0.016433443874120712, decouple_loss:0.0010500443167984486
Iteration: 1149, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44714096188545227, gen p mean: -0.04142863303422928, mean p set: 0.44762122631073
loss_pred:0.01634708233177662, decouple_loss:0.0011912006884813309
The modified gen p mean: 0.44739386439323425, gen p mean: -0.04189561679959297, mean p set: 0.4478742182254791The modified gen p mean: 0.4480491578578949, gen p mean: -0.03511228784918785, mean p set: 0.4485294818878174
loss_pred:0.016957368701696396, decouple_loss:0.0012736293720081449
loss_pred:0.01709923706948757, decouple_loss:0.0012254543835297227
Iteration: 1150, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44786345958709717, gen p mean: -0.03761449083685875, mean p set: 0.44834375381469727
loss_pred:0.0174654982984066, decouple_loss:0.0010334301041439176
The modified gen p mean: 0.44757845997810364, gen p mean: -0.03748244419693947, mean p set: 0.44805875420570374The modified gen p mean: 0.4484093189239502, gen p mean: -0.03909362107515335, mean p set: 0.4488895833492279
loss_pred:0.01637362502515316, decouple_loss:0.0010698882397264242
loss_pred:0.01658213697373867, decouple_loss:0.0010759825818240643
2023-05-01 02:42:42 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.041877444833517075, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.037894107401371, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.038221102207899094, mean p set: 0.4500633478164673
loss_pred:0.018388917669653893, decouple_loss:0.0011987137841060758
loss_pred:0.0172495748847723, decouple_loss:0.0013542172964662313
loss_pred:0.017326371744275093, decouple_loss:0.0012702628737315536
WV_0_PC_1_EH_0_PS_40, loss: 0.01771867647767067, avg_mse: 0.025405211374163628
current test mse: 0.025405
Iteration: 1151, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470658600330353, gen p mean: -0.03310147300362587, mean p set: 0.447546124458313
The modified gen p mean: 0.4456823468208313, gen p mean: -0.04098041355609894, mean p set: 0.4461626410484314
The modified gen p mean: 0.44735077023506165, gen p mean: -0.035853538662195206, mean p set: 0.44783106446266174
loss_pred:0.01632816158235073, decouple_loss:0.0011810915311798453
loss_pred:0.017482614144682884, decouple_loss:0.001129237818531692
loss_pred:0.01586577109992504, decouple_loss:0.00130237836856395
Iteration: 1152, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44671186804771423, gen p mean: -0.04226548969745636, mean p set: 0.44719216227531433
The modified gen p mean: 0.445953369140625, gen p mean: -0.03977728635072708, mean p set: 0.4464336037635803
loss_pred:0.0159075278788805, decouple_loss:0.0010211542248725891
The modified gen p mean: 0.44558027386665344, gen p mean: -0.04194239154458046, mean p set: 0.44606053829193115
loss_pred:0.015997309237718582, decouple_loss:0.0010254870867356658
loss_pred:0.016215277835726738, decouple_loss:0.001057820743881166
Iteration: 1153, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474044740200043, gen p mean: -0.04546976089477539, mean p set: 0.44788476824760437
loss_pred:0.015749521553516388, decouple_loss:0.0011268906528130174
The modified gen p mean: 0.4477144181728363, gen p mean: -0.040031298995018005, mean p set: 0.4481947124004364The modified gen p mean: 0.4472832679748535, gen p mean: -0.041530050337314606, mean p set: 0.4477635622024536
loss_pred:0.01738685742020607, decouple_loss:0.0011981955030933022
loss_pred:0.016443969681859016, decouple_loss:0.0011783051304519176
Iteration: 1154, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465195834636688, gen p mean: -0.0460834838449955, mean p set: 0.44699984788894653
loss_pred:0.016496414318680763, decouple_loss:0.001037397189065814
The modified gen p mean: 0.4473946690559387, gen p mean: -0.0447222925722599, mean p set: 0.4478749632835388The modified gen p mean: 0.4494279623031616, gen p mean: -0.05054934322834015, mean p set: 0.44990822672843933
loss_pred:0.01617700234055519, decouple_loss:0.00106984400190413
loss_pred:0.016522545367479324, decouple_loss:0.0012293743202462792
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012020_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012020_3_24hr.npz
NaN value num: 0
Iteration: 1155, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44895657896995544, gen p mean: -0.04239002987742424, mean p set: 0.44943687319755554
loss_pred:0.018320756033062935, decouple_loss:0.0011200587032362819
The modified gen p mean: 0.44922593235969543, gen p mean: -0.04555564746260643, mean p set: 0.4497062563896179The modified gen p mean: 0.44816696643829346, gen p mean: -0.04855264350771904, mean p set: 0.44864723086357117
loss_pred:0.018494850024580956, decouple_loss:0.0010827436344698071
loss_pred:0.018567312508821487, decouple_loss:0.001146019552834332
Iteration: 1156, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496626853942871, gen p mean: -0.04806241765618324, mean p set: 0.4501429796218872
loss_pred:0.0176797304302454, decouple_loss:0.0009756262297742069
The modified gen p mean: 0.4481431245803833, gen p mean: -0.04519309848546982, mean p set: 0.4486234188079834The modified gen p mean: 0.4485275149345398, gen p mean: -0.04315684735774994, mean p set: 0.4490078091621399
loss_pred:0.018274294212460518, decouple_loss:0.0010782078607007861
loss_pred:0.017855791375041008, decouple_loss:0.0010280387941747904
Iteration: 1157, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44919368624687195, gen p mean: -0.044048819690942764, mean p set: 0.44967401027679443
loss_pred:0.018084386363625526, decouple_loss:0.0011173285311087966
The modified gen p mean: 0.44995805621147156, gen p mean: -0.04810669273138046, mean p set: 0.45043838024139404The modified gen p mean: 0.4497183859348297, gen p mean: -0.04594575986266136, mean p set: 0.4501986801624298
loss_pred:0.018042782321572304, decouple_loss:0.001187613233923912
loss_pred:0.017864275723695755, decouple_loss:0.0010531420120969415
Iteration: 1158, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496336579322815, gen p mean: -0.05104765295982361, mean p set: 0.450113981962204
The modified gen p mean: 0.4489961862564087, gen p mean: -0.046071894466876984, mean p set: 0.4494764804840088loss_pred:0.018481435254216194, decouple_loss:0.0011112680658698082
The modified gen p mean: 0.44987934827804565, gen p mean: -0.05354684218764305, mean p set: 0.45035961270332336
loss_pred:0.017652036622166634, decouple_loss:0.0009166864329017699
loss_pred:0.01887943223118782, decouple_loss:0.0009114813874475658
Iteration: 1159, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499053955078125, gen p mean: -0.047623369842767715, mean p set: 0.450385719537735
loss_pred:0.018325841054320335, decouple_loss:0.001090336823835969
The modified gen p mean: 0.4489402174949646, gen p mean: -0.04598447307944298, mean p set: 0.4494204819202423The modified gen p mean: 0.4494567811489105, gen p mean: -0.0423363521695137, mean p set: 0.4499370753765106
loss_pred:0.019183490425348282, decouple_loss:0.0009724986739456654
loss_pred:0.017934493720531464, decouple_loss:0.0009458920103497803
Iteration: 1160, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498935341835022, gen p mean: -0.043720219284296036, mean p set: 0.4503738284111023
loss_pred:0.017784396186470985, decouple_loss:0.001029058825224638
The modified gen p mean: 0.4482547640800476, gen p mean: -0.042022451758384705, mean p set: 0.4487350583076477The modified gen p mean: 0.4497392177581787, gen p mean: -0.04871170595288277, mean p set: 0.4502195417881012
loss_pred:0.018256885930895805, decouple_loss:0.0010607235599309206
loss_pred:0.018163908272981644, decouple_loss:0.001153318677097559
2023-05-01 02:45:17 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.04817230999469757, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04402204975485802, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.04430311545729637, mean p set: 0.4500633478164673
loss_pred:0.018373101949691772, decouple_loss:0.0010790827218443155
loss_pred:0.017223818227648735, decouple_loss:0.0010764533653855324
loss_pred:0.01740632764995098, decouple_loss:0.001060008886270225
WV_0_PC_1_EH_0_PS_40, loss: 0.01772134006023407, avg_mse: 0.025413427501916885
current test mse: 0.025413
Iteration: 1161, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44877198338508606, gen p mean: -0.04116198420524597, mean p set: 0.44925227761268616
The modified gen p mean: 0.44881120324134827, gen p mean: -0.04640066251158714, mean p set: 0.44929149746894836
The modified gen p mean: 0.44935736060142517, gen p mean: -0.04757013916969299, mean p set: 0.44983765482902527
loss_pred:0.0170727651566267, decouple_loss:0.0009619226912036538
loss_pred:0.018221819773316383, decouple_loss:0.0009727372089400887
loss_pred:0.018848011270165443, decouple_loss:0.0009796442463994026
Iteration: 1162, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497492015361786, gen p mean: -0.04822118580341339, mean p set: 0.4502294957637787
loss_pred:0.018838858231902122, decouple_loss:0.001084145624190569
The modified gen p mean: 0.44877657294273376, gen p mean: -0.045893698930740356, mean p set: 0.44925686717033386The modified gen p mean: 0.4488781988620758, gen p mean: -0.04821058362722397, mean p set: 0.4493584930896759
loss_pred:0.018002087250351906, decouple_loss:0.0011453131446614861
loss_pred:0.019147496670484543, decouple_loss:0.0010490862186998129
Iteration: 1163, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499937891960144, gen p mean: -0.04232204705476761, mean p set: 0.4504740536212921
loss_pred:0.017772527411580086, decouple_loss:0.001011245185509324
The modified gen p mean: 0.4479087293148041, gen p mean: -0.044207967817783356, mean p set: 0.4483890235424042The modified gen p mean: 0.44819748401641846, gen p mean: -0.04384683817625046, mean p set: 0.44867777824401855
loss_pred:0.01778239570558071, decouple_loss:0.0010608049342408776
loss_pred:0.017924780026078224, decouple_loss:0.0010698502883315086
Iteration: 1164, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449593186378479, gen p mean: -0.04348386451601982, mean p set: 0.4500735104084015
loss_pred:0.017899716272950172, decouple_loss:0.001146013499237597
The modified gen p mean: 0.4486680030822754, gen p mean: -0.05050509795546532, mean p set: 0.4491483271121979The modified gen p mean: 0.4495718479156494, gen p mean: -0.04421770200133324, mean p set: 0.4500521421432495
loss_pred:0.017161017283797264, decouple_loss:0.0011363294906914234
loss_pred:0.017815882340073586, decouple_loss:0.001222616177983582
Iteration: 1165, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492073953151703, gen p mean: -0.04655800387263298, mean p set: 0.4496876895427704
loss_pred:0.018326614052057266, decouple_loss:0.0011162395821884274
The modified gen p mean: 0.4497009813785553, gen p mean: -0.04620509222149849, mean p set: 0.4501812756061554The modified gen p mean: 0.44845089316368103, gen p mean: -0.04220127314329147, mean p set: 0.4489312171936035
loss_pred:0.018156234174966812, decouple_loss:0.001133663929067552
loss_pred:0.018376734107732773, decouple_loss:0.0011450375895947218
Iteration: 1166, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44948074221611023, gen p mean: -0.04465416446328163, mean p set: 0.4499610364437103
loss_pred:0.01789221167564392, decouple_loss:0.0010411341208964586
The modified gen p mean: 0.45013242959976196, gen p mean: -0.04735473543405533, mean p set: 0.45061272382736206The modified gen p mean: 0.44947925209999084, gen p mean: -0.04328151419758797, mean p set: 0.44995957612991333
loss_pred:0.018744736909866333, decouple_loss:0.0012411040952429175
loss_pred:0.01800316385924816, decouple_loss:0.0011195082915946841
Iteration: 1167, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494662582874298, gen p mean: -0.04701532423496246, mean p set: 0.4499465525150299
loss_pred:0.017087280750274658, decouple_loss:0.0010386687936261296
The modified gen p mean: 0.4502822160720825, gen p mean: -0.050646644085645676, mean p set: 0.4507625102996826The modified gen p mean: 0.44849124550819397, gen p mean: -0.04457644745707512, mean p set: 0.44897153973579407
loss_pred:0.01758451946079731, decouple_loss:0.001034365501254797
loss_pred:0.01863420009613037, decouple_loss:0.0010670212795957923
Iteration: 1168, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486444890499115, gen p mean: -0.04455122724175453, mean p set: 0.4491247832775116
loss_pred:0.017743784934282303, decouple_loss:0.0010385033674538136
The modified gen p mean: 0.4492981731891632, gen p mean: -0.04629208520054817, mean p set: 0.4497784972190857The modified gen p mean: 0.448944091796875, gen p mean: -0.047873251140117645, mean p set: 0.4494244158267975
loss_pred:0.01963176764547825, decouple_loss:0.0011196101550012827
loss_pred:0.017023419961333275, decouple_loss:0.0011224773479625583
Iteration: 1169, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44971853494644165, gen p mean: -0.046011533588171005, mean p set: 0.45019885897636414
loss_pred:0.018307091668248177, decouple_loss:0.001040747738443315
The modified gen p mean: 0.44854286313056946, gen p mean: -0.041150063276290894, mean p set: 0.44902318716049194The modified gen p mean: 0.44904962182044983, gen p mean: -0.04453520104289055, mean p set: 0.4495299160480499
loss_pred:0.017567019909620285, decouple_loss:0.0010128977010026574
loss_pred:0.01776743121445179, decouple_loss:0.0010271687060594559
Iteration: 1170, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44969406723976135, gen p mean: -0.046414200216531754, mean p set: 0.45017439126968384
loss_pred:0.018363086506724358, decouple_loss:0.0010299786226823926
The modified gen p mean: 0.4490707218647003, gen p mean: -0.04765879735350609, mean p set: 0.4495510160923004The modified gen p mean: 0.44961875677108765, gen p mean: -0.042686693370342255, mean p set: 0.45009905099868774
loss_pred:0.019373741000890732, decouple_loss:0.0009726369753479958
loss_pred:0.018153883516788483, decouple_loss:0.000934343843255192
2023-05-01 02:47:10 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.045086853206157684, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04092025011777878, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.041188281029462814, mean p set: 0.4500633478164673
loss_pred:0.018299322575330734, decouple_loss:0.0010106301633641124
loss_pred:0.017209555953741074, decouple_loss:0.0009525165660306811
loss_pred:0.017335394397377968, decouple_loss:0.0009654441382735968
WV_0_PC_1_EH_0_PS_40, loss: 0.017663568258285522, avg_mse: 0.025329751893877983
current test mse: 0.02533
At step 1170, Best test: 0.02533
save model to /work/09012/haoli1/ls6/ERA5_PredRNN/checkpoints/WV_0_PC_1_EH_0_PS_40/model_model_test_schedule_sampling_DynaMean.ckpt
Iteration: 1171, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501723051071167, gen p mean: -0.044589973986148834, mean p set: 0.4506526291370392
loss_pred:0.018566163256764412, decouple_loss:0.0010391643736511469
The modified gen p mean: 0.44872575998306274, gen p mean: -0.04055599495768547, mean p set: 0.44920605421066284The modified gen p mean: 0.4496510624885559, gen p mean: -0.04237191751599312, mean p set: 0.4501313269138336
loss_pred:0.01761840656399727, decouple_loss:0.0011706133373081684loss_pred:0.01750466600060463, decouple_loss:0.0009639963391236961
Iteration: 1172, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486953020095825, gen p mean: -0.036823686212301254, mean p set: 0.449175626039505
loss_pred:0.017986398190259933, decouple_loss:0.0011362567311152816
The modified gen p mean: 0.4492141306400299, gen p mean: -0.04821998253464699, mean p set: 0.44969442486763
The modified gen p mean: 0.4487052857875824, gen p mean: -0.04018999636173248, mean p set: 0.4491855800151825
loss_pred:0.017384769394993782, decouple_loss:0.001022807788103819
loss_pred:0.019145961850881577, decouple_loss:0.0010766354389488697
Iteration: 1173, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45037803053855896, gen p mean: -0.04504907876253128, mean p set: 0.45085832476615906
loss_pred:0.017902959138154984, decouple_loss:0.0010165282292291522
The modified gen p mean: 0.44985103607177734, gen p mean: -0.04327165335416794, mean p set: 0.45033130049705505The modified gen p mean: 0.44877374172210693, gen p mean: -0.04218197241425514, mean p set: 0.44925400614738464
loss_pred:0.017547445371747017, decouple_loss:0.0010417066514492035
loss_pred:0.018161924555897713, decouple_loss:0.0010353454854339361
Iteration: 1174, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44972893595695496, gen p mean: -0.04494067654013634, mean p set: 0.45020923018455505
loss_pred:0.018275514245033264, decouple_loss:0.0010747876949608326
The modified gen p mean: 0.44917985796928406, gen p mean: -0.043808046728372574, mean p set: 0.44966015219688416The modified gen p mean: 0.44827064871788025, gen p mean: -0.04249574989080429, mean p set: 0.44875091314315796
loss_pred:0.017413495108485222, decouple_loss:0.001042728079482913
loss_pred:0.017898457124829292, decouple_loss:0.001048100064508617
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012019_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012019_3_24hr.npz
NaN value num: 0
Iteration: 1175, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508246183395386, gen p mean: -0.03862840309739113, mean p set: 0.45130491256713867
loss_pred:0.015924373641610146, decouple_loss:0.0010767861967906356
The modified gen p mean: 0.4489181935787201, gen p mean: -0.04460602626204491, mean p set: 0.4493984878063202The modified gen p mean: 0.4500710964202881, gen p mean: -0.04017283767461777, mean p set: 0.4505513906478882
loss_pred:0.016157448291778564, decouple_loss:0.0009899509605020285
loss_pred:0.01583922654390335, decouple_loss:0.0010110660223290324
Iteration: 1176, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493621587753296, gen p mean: -0.044857207685709, mean p set: 0.4498424530029297
loss_pred:0.016044801101088524, decouple_loss:0.0011625518091022968
The modified gen p mean: 0.4502295255661011, gen p mean: -0.039149753749370575, mean p set: 0.45070981979370117The modified gen p mean: 0.4503858983516693, gen p mean: -0.038233477622270584, mean p set: 0.4508661925792694
loss_pred:0.01576574146747589, decouple_loss:0.0011048192391172051
loss_pred:0.015759862959384918, decouple_loss:0.0010778614087030292
Iteration: 1177, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44765859842300415, gen p mean: -0.04428103566169739, mean p set: 0.44813892245292664
loss_pred:0.016452061012387276, decouple_loss:0.0010700924322009087
The modified gen p mean: 0.45011022686958313, gen p mean: -0.038080763071775436, mean p set: 0.4505905210971832
The modified gen p mean: 0.44947436451911926, gen p mean: -0.038976382464170456, mean p set: 0.44995465874671936
loss_pred:0.01566370390355587, decouple_loss:0.0010626340517774224
loss_pred:0.015568437986075878, decouple_loss:0.0010195374488830566
Iteration: 1178, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501386880874634, gen p mean: -0.03761487826704979, mean p set: 0.4506189823150635
loss_pred:0.015197250992059708, decouple_loss:0.0012666132533922791
The modified gen p mean: 0.4490104019641876, gen p mean: -0.039208460599184036, mean p set: 0.44949063658714294The modified gen p mean: 0.449203222990036, gen p mean: -0.044749870896339417, mean p set: 0.4496835172176361
loss_pred:0.015167790465056896, decouple_loss:0.0012053630780428648
loss_pred:0.015263132750988007, decouple_loss:0.001333913067355752
Iteration: 1179, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492861032485962, gen p mean: -0.034748323261737823, mean p set: 0.4497663974761963
loss_pred:0.014896288514137268, decouple_loss:0.0011272159172222018
The modified gen p mean: 0.44948604702949524, gen p mean: -0.040847547352313995, mean p set: 0.44996631145477295The modified gen p mean: 0.44836917519569397, gen p mean: -0.039040401577949524, mean p set: 0.44884949922561646
loss_pred:0.014753061346709728, decouple_loss:0.0011592183727771044
loss_pred:0.015451804734766483, decouple_loss:0.0011213176185265183
Iteration: 1180, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44846558570861816, gen p mean: -0.04073355346918106, mean p set: 0.4489458501338959
loss_pred:0.01478643249720335, decouple_loss:0.0014203079044818878
The modified gen p mean: 0.4498368203639984, gen p mean: -0.039507485926151276, mean p set: 0.4503171145915985The modified gen p mean: 0.4480578601360321, gen p mean: -0.03491688519716263, mean p set: 0.4485381245613098
loss_pred:0.014591042883694172, decouple_loss:0.0013419782044366002
loss_pred:0.015579542145133018, decouple_loss:0.0013466891832649708
2023-05-01 02:49:57 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.0355624258518219, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.03214959055185318, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.032008569687604904, mean p set: 0.4500633478164673
loss_pred:0.018828872591257095, decouple_loss:0.0013636352960020304
loss_pred:0.017680633813142776, decouple_loss:0.0012944050831720233
loss_pred:0.017752762883901596, decouple_loss:0.001290488406084478
WV_0_PC_1_EH_0_PS_40, loss: 0.0181532334536314, avg_mse: 0.026156852021813393
current test mse: 0.026157
Iteration: 1181, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45090633630752563, gen p mean: -0.028646346181631088, mean p set: 0.45138660073280334
The modified gen p mean: 0.4501873850822449, gen p mean: -0.02864253520965576, mean p set: 0.45066767930984497
The modified gen p mean: 0.44851312041282654, gen p mean: -0.034639112651348114, mean p set: 0.448993444442749
loss_pred:0.014764570631086826, decouple_loss:0.0012825250159949064
loss_pred:0.014822278171777725, decouple_loss:0.001267357962206006
loss_pred:0.015230240300297737, decouple_loss:0.001344930729828775
Iteration: 1182, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44874081015586853, gen p mean: -0.037696972489356995, mean p set: 0.449221134185791
loss_pred:0.014265191741287708, decouple_loss:0.0014337333850562572
The modified gen p mean: 0.44858768582344055, gen p mean: -0.030449531972408295, mean p set: 0.44906798005104065The modified gen p mean: 0.4492749571800232, gen p mean: -0.023801736533641815, mean p set: 0.4497552812099457
loss_pred:0.014629103243350983, decouple_loss:0.0014252221444621682
loss_pred:0.014628010801970959, decouple_loss:0.0014367193216457963
Iteration: 1183, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44911807775497437, gen p mean: -0.028034714981913567, mean p set: 0.44959837198257446
loss_pred:0.015008557587862015, decouple_loss:0.0014084751019254327
The modified gen p mean: 0.44822660088539124, gen p mean: -0.03212565556168556, mean p set: 0.44870686531066895The modified gen p mean: 0.4492380917072296, gen p mean: -0.031878307461738586, mean p set: 0.4497183561325073
loss_pred:0.014809510670602322, decouple_loss:0.0014406724367290735
loss_pred:0.015333620831370354, decouple_loss:0.001501650782302022
Iteration: 1184, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44860759377479553, gen p mean: -0.03553137183189392, mean p set: 0.44908788800239563
The modified gen p mean: 0.44965094327926636, gen p mean: -0.03148498758673668, mean p set: 0.45013123750686646loss_pred:0.015103482641279697, decouple_loss:0.0014904862036928535
The modified gen p mean: 0.4496731460094452, gen p mean: -0.032170142978429794, mean p set: 0.4501534700393677
loss_pred:0.014681407250463963, decouple_loss:0.001378093147650361
loss_pred:0.014676576480269432, decouple_loss:0.0013862296473234892
Iteration: 1185, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491842985153198, gen p mean: -0.03446729853749275, mean p set: 0.4496645927429199
loss_pred:0.014441992156207561, decouple_loss:0.0016499619232490659
The modified gen p mean: 0.4497874081134796, gen p mean: -0.03788191080093384, mean p set: 0.4502677023410797The modified gen p mean: 0.4490286111831665, gen p mean: -0.03540261462330818, mean p set: 0.4495089054107666
loss_pred:0.01446033176034689, decouple_loss:0.0016872166888788342
loss_pred:0.014277899637818336, decouple_loss:0.0015888964990153909
Iteration: 1186, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502960443496704, gen p mean: -0.031856417655944824, mean p set: 0.4507763385772705
loss_pred:0.014211867935955524, decouple_loss:0.001546015264466405
The modified gen p mean: 0.4497798681259155, gen p mean: -0.03763076290488243, mean p set: 0.45026013255119324The modified gen p mean: 0.4492669105529785, gen p mean: -0.035076793283224106, mean p set: 0.4497471749782562
loss_pred:0.01455589011311531, decouple_loss:0.001564470469020307
loss_pred:0.013566356152296066, decouple_loss:0.0014540503034368157
Iteration: 1187, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44965627789497375, gen p mean: -0.04022642597556114, mean p set: 0.45013657212257385
loss_pred:0.014050038531422615, decouple_loss:0.0015011943178251386
The modified gen p mean: 0.44886115193367004, gen p mean: -0.035801712423563004, mean p set: 0.44934147596359253The modified gen p mean: 0.44837287068367004, gen p mean: -0.03828246146440506, mean p set: 0.44885316491127014
loss_pred:0.014544055797159672, decouple_loss:0.0014205804327502847
loss_pred:0.014573580585420132, decouple_loss:0.0014729112153872848
Iteration: 1188, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489395022392273, gen p mean: -0.04188172146677971, mean p set: 0.4494198262691498
loss_pred:0.014556465670466423, decouple_loss:0.0015248340787366033
The modified gen p mean: 0.4488588571548462, gen p mean: -0.03970130532979965, mean p set: 0.4493391215801239The modified gen p mean: 0.44863173365592957, gen p mean: -0.04356098547577858, mean p set: 0.4491119980812073
loss_pred:0.014361754059791565, decouple_loss:0.0014406119007617235
loss_pred:0.014507537707686424, decouple_loss:0.0014964011497795582
Iteration: 1189, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501243233680725, gen p mean: -0.03740285709500313, mean p set: 0.4506046175956726
loss_pred:0.014232601039111614, decouple_loss:0.0014747767709195614
The modified gen p mean: 0.4500034749507904, gen p mean: -0.038697030395269394, mean p set: 0.4504837691783905The modified gen p mean: 0.449287086725235, gen p mean: -0.041112612932920456, mean p set: 0.4497673809528351
loss_pred:0.014122835360467434, decouple_loss:0.0015259860083460808
loss_pred:0.014226979576051235, decouple_loss:0.0015155605506151915
Iteration: 1190, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480297267436981, gen p mean: -0.04237675666809082, mean p set: 0.44850999116897583
loss_pred:0.01415726263076067, decouple_loss:0.0016340558649972081
The modified gen p mean: 0.44969236850738525, gen p mean: -0.04108508676290512, mean p set: 0.45017269253730774The modified gen p mean: 0.4491962790489197, gen p mean: -0.036776985973119736, mean p set: 0.4496765732765198
loss_pred:0.014316894114017487, decouple_loss:0.0015216689789667726
loss_pred:0.013831101357936859, decouple_loss:0.0014732069103047252
2023-05-01 02:51:49 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.03992617875337601, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.03681980073451996, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.0365915521979332, mean p set: 0.4500633478164673
loss_pred:0.019388526678085327, decouple_loss:0.0015512811951339245
loss_pred:0.018140407279133797, decouple_loss:0.0015900725265964866
loss_pred:0.018282568082213402, decouple_loss:0.001553039182908833
WV_0_PC_1_EH_0_PS_40, loss: 0.018682073801755905, avg_mse: 0.027201134711503983
current test mse: 0.027201
Iteration: 1191, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483937621116638, gen p mean: -0.03315187990665436, mean p set: 0.4488740861415863
The modified gen p mean: 0.4494338631629944, gen p mean: -0.03470013290643692, mean p set: 0.44991418719291687
The modified gen p mean: 0.4506630599498749, gen p mean: -0.03350584954023361, mean p set: 0.451143354177475
loss_pred:0.014236297458410263, decouple_loss:0.001460387255065143
loss_pred:0.014052671380341053, decouple_loss:0.001477937214076519
loss_pred:0.014235668815672398, decouple_loss:0.0014902350958436728
Iteration: 1192, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488268494606018, gen p mean: -0.03600896894931793, mean p set: 0.4493071436882019
The modified gen p mean: 0.44803228974342346, gen p mean: -0.0324934720993042, mean p set: 0.44851261377334595
loss_pred:0.014290979132056236, decouple_loss:0.001526620122604072
loss_pred:0.01333041675388813, decouple_loss:0.0014920902904123068
The modified gen p mean: 0.45080986618995667, gen p mean: -0.03232148662209511, mean p set: 0.45129016041755676
loss_pred:0.014131493866443634, decouple_loss:0.0014365746174007654
Iteration: 1193, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496931731700897, gen p mean: -0.034569136798381805, mean p set: 0.4501734673976898
loss_pred:0.01397948432713747, decouple_loss:0.0014879852533340454
The modified gen p mean: 0.44919705390930176, gen p mean: -0.03631949424743652, mean p set: 0.44967731833457947The modified gen p mean: 0.44797298312187195, gen p mean: -0.03271583467721939, mean p set: 0.44845327734947205
loss_pred:0.013584320433437824, decouple_loss:0.0014517566887661815
loss_pred:0.013662755489349365, decouple_loss:0.0014400024665519595
Iteration: 1194, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45058590173721313, gen p mean: -0.03301471099257469, mean p set: 0.45106619596481323
loss_pred:0.013568351045250893, decouple_loss:0.0014170509530231357
The modified gen p mean: 0.4492708742618561, gen p mean: -0.03609591722488403, mean p set: 0.4497511684894562The modified gen p mean: 0.44903796911239624, gen p mean: -0.03862666338682175, mean p set: 0.4495182931423187
loss_pred:0.014073333702981472, decouple_loss:0.001458019600249827
loss_pred:0.013632331974804401, decouple_loss:0.0015435154782608151
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012011_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012011_3_24hr.npz
NaN value num: 0
Iteration: 1195, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478898048400879, gen p mean: -0.03776843473315239, mean p set: 0.4483700692653656
loss_pred:0.013184873387217522, decouple_loss:0.0013928222469985485
The modified gen p mean: 0.4471130669116974, gen p mean: -0.03945745900273323, mean p set: 0.4475933611392975The modified gen p mean: 0.44741091132164, gen p mean: -0.03759580850601196, mean p set: 0.4478912055492401
loss_pred:0.014505516737699509, decouple_loss:0.0013934567105025053
loss_pred:0.014587259851396084, decouple_loss:0.001362177194096148
Iteration: 1196, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44788751006126404, gen p mean: -0.041726402938365936, mean p set: 0.44836780428886414
The modified gen p mean: 0.44812625646591187, gen p mean: -0.03911234438419342, mean p set: 0.44860655069351196
loss_pred:0.014453905634582043, decouple_loss:0.0017554002115502954
loss_pred:0.013524805195629597, decouple_loss:0.0014642206951975822
The modified gen p mean: 0.44764891266822815, gen p mean: -0.04144202917814255, mean p set: 0.44812917709350586
loss_pred:0.013832347467541695, decouple_loss:0.0015061104204505682
Iteration: 1197, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478502869606018, gen p mean: -0.04362082853913307, mean p set: 0.4483305513858795
loss_pred:0.014058991335332394, decouple_loss:0.0013797678984701633
The modified gen p mean: 0.44776225090026855, gen p mean: -0.039517760276794434, mean p set: 0.44824254512786865The modified gen p mean: 0.447274774312973, gen p mean: -0.04503874480724335, mean p set: 0.44775503873825073
loss_pred:0.014295676723122597, decouple_loss:0.001408318872563541
loss_pred:0.013351931236684322, decouple_loss:0.0013370993547141552
Iteration: 1198, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44766753911972046, gen p mean: -0.04053150862455368, mean p set: 0.44814783334732056
loss_pred:0.013887998647987843, decouple_loss:0.00138006079941988
The modified gen p mean: 0.4471355676651001, gen p mean: -0.03923465311527252, mean p set: 0.4476158618927002The modified gen p mean: 0.4486345052719116, gen p mean: -0.03941589221358299, mean p set: 0.4491148293018341
loss_pred:0.013749510049819946, decouple_loss:0.001361265080049634
loss_pred:0.014231041073799133, decouple_loss:0.001370132900774479
Iteration: 1199, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470285177230835, gen p mean: -0.042596977204084396, mean p set: 0.4475088119506836
The modified gen p mean: 0.4475812017917633, gen p mean: -0.040366195142269135, mean p set: 0.4480615258216858
loss_pred:0.013867520727217197, decouple_loss:0.0013299809070304036
loss_pred:0.013434610329568386, decouple_loss:0.0013737088302150369
The modified gen p mean: 0.4486341178417206, gen p mean: -0.038155991584062576, mean p set: 0.4491144120693207
loss_pred:0.013513709418475628, decouple_loss:0.0014002042589709163
Iteration: 1200, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449092298746109, gen p mean: -0.03426863253116608, mean p set: 0.4495725929737091
loss_pred:0.013469407334923744, decouple_loss:0.0013536122860386968
The modified gen p mean: 0.44780397415161133, gen p mean: -0.04117045924067497, mean p set: 0.4482842683792114The modified gen p mean: 0.4473133385181427, gen p mean: -0.04532384127378464, mean p set: 0.4477936327457428
loss_pred:0.014114337973296642, decouple_loss:0.0014093132922425866
loss_pred:0.013072277419269085, decouple_loss:0.0014215041883289814
2023-05-01 02:54:23 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.045047059655189514, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.0420367568731308, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04203816130757332, mean p set: 0.4500633478164673
loss_pred:0.019235605373978615, decouple_loss:0.0013683171709999442
loss_pred:0.018167253583669662, decouple_loss:0.0013984867837280035
loss_pred:0.018201181665062904, decouple_loss:0.0013507683761417866
WV_0_PC_1_EH_0_PS_40, loss: 0.018603306263685226, avg_mse: 0.027127249166369438
current test mse: 0.027127
Iteration: 1201, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446834534406662, gen p mean: -0.04571446776390076, mean p set: 0.4473148286342621
The modified gen p mean: 0.44797438383102417, gen p mean: -0.0396730974316597, mean p set: 0.44845467805862427
The modified gen p mean: 0.44857919216156006, gen p mean: -0.04130801185965538, mean p set: 0.44905948638916016
loss_pred:0.013602618128061295, decouple_loss:0.001378403976559639
loss_pred:0.01315983571112156, decouple_loss:0.0013026600936427712
loss_pred:0.013164292089641094, decouple_loss:0.0014338480541482568
Iteration: 1202, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468989074230194, gen p mean: -0.046284422278404236, mean p set: 0.4473792016506195
loss_pred:0.013250214979052544, decouple_loss:0.0013467284152284265
The modified gen p mean: 0.4490792155265808, gen p mean: -0.034634534269571304, mean p set: 0.4495594799518585The modified gen p mean: 0.4488285779953003, gen p mean: -0.04397326707839966, mean p set: 0.449308842420578
loss_pred:0.012760651297867298, decouple_loss:0.0013425517827272415
loss_pred:0.013380919583141804, decouple_loss:0.0012477155542001128
Iteration: 1203, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494800865650177, gen p mean: -0.03468036651611328, mean p set: 0.4499603509902954
loss_pred:0.013269253075122833, decouple_loss:0.0012800281401723623
The modified gen p mean: 0.44757816195487976, gen p mean: -0.04515333101153374, mean p set: 0.44805845618247986The modified gen p mean: 0.44705930352211, gen p mean: -0.04931493476033211, mean p set: 0.44753962755203247
loss_pred:0.013259478844702244, decouple_loss:0.0012738428777083755
loss_pred:0.0131310960277915, decouple_loss:0.0013217569794505835
Iteration: 1204, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481104910373688, gen p mean: -0.04730478674173355, mean p set: 0.44859078526496887
loss_pred:0.012853925116360188, decouple_loss:0.001227722386829555
The modified gen p mean: 0.44962751865386963, gen p mean: -0.04256914556026459, mean p set: 0.45010778307914734The modified gen p mean: 0.44797784090042114, gen p mean: -0.0458839014172554, mean p set: 0.44845813512802124
loss_pred:0.013044619932770729, decouple_loss:0.0013697863323614001
loss_pred:0.012823349796235561, decouple_loss:0.0012142353225499392
Iteration: 1205, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44870510697364807, gen p mean: -0.044197455048561096, mean p set: 0.44918543100357056
loss_pred:0.013007532805204391, decouple_loss:0.0012868166668340564
The modified gen p mean: 0.4472017288208008, gen p mean: -0.04633582383394241, mean p set: 0.44768205285072327The modified gen p mean: 0.4475351870059967, gen p mean: -0.04502568766474724, mean p set: 0.4480154812335968
loss_pred:0.01428352203220129, decouple_loss:0.0013944398378953338
loss_pred:0.012837960384786129, decouple_loss:0.0013038755860179663
Iteration: 1206, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44774556159973145, gen p mean: -0.04088287800550461, mean p set: 0.44822585582733154
loss_pred:0.013933544047176838, decouple_loss:0.0014010983286425471
The modified gen p mean: 0.4473905563354492, gen p mean: -0.04423610493540764, mean p set: 0.4478708505630493The modified gen p mean: 0.44778740406036377, gen p mean: -0.045407287776470184, mean p set: 0.4482676684856415
loss_pred:0.01357769500464201, decouple_loss:0.0014889552257955074
loss_pred:0.013215990737080574, decouple_loss:0.0013805791968479753
Iteration: 1207, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467989206314087, gen p mean: -0.0456722266972065, mean p set: 0.4472792148590088
loss_pred:0.013096947222948074, decouple_loss:0.001365205622278154
The modified gen p mean: 0.4479402005672455, gen p mean: -0.04310592636466026, mean p set: 0.44842052459716797The modified gen p mean: 0.4481147527694702, gen p mean: -0.04661646485328674, mean p set: 0.4485950767993927
loss_pred:0.013005523011088371, decouple_loss:0.0013601148966699839loss_pred:0.013518698513507843, decouple_loss:0.001616404508240521
Iteration: 1208, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44732335209846497, gen p mean: -0.04973406344652176, mean p set: 0.44780364632606506
loss_pred:0.01320579182356596, decouple_loss:0.001299914438277483
The modified gen p mean: 0.4482946991920471, gen p mean: -0.04203605651855469, mean p set: 0.4487749934196472The modified gen p mean: 0.44668814539909363, gen p mean: -0.04307979717850685, mean p set: 0.4471684396266937
loss_pred:0.013571060262620449, decouple_loss:0.0014365975512191653
loss_pred:0.013771402649581432, decouple_loss:0.0012047295458614826
Iteration: 1209, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44735175371170044, gen p mean: -0.04286068305373192, mean p set: 0.44783204793930054
loss_pred:0.013697471469640732, decouple_loss:0.0013704883167520165
The modified gen p mean: 0.4471811056137085, gen p mean: -0.043869756162166595, mean p set: 0.4476613700389862The modified gen p mean: 0.44715616106987, gen p mean: -0.038814861327409744, mean p set: 0.4476364552974701
loss_pred:0.013495286926627159, decouple_loss:0.0012248394777998328
loss_pred:0.013882492668926716, decouple_loss:0.0014191208174452186
Iteration: 1210, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485374093055725, gen p mean: -0.039277784526348114, mean p set: 0.4490176737308502
loss_pred:0.013491064310073853, decouple_loss:0.0013711946085095406
The modified gen p mean: 0.4481607675552368, gen p mean: -0.0460456982254982, mean p set: 0.4486410617828369The modified gen p mean: 0.44653695821762085, gen p mean: -0.038423795253038406, mean p set: 0.44701725244522095
loss_pred:0.013024887070059776, decouple_loss:0.0013161245733499527
loss_pred:0.013905001804232597, decouple_loss:0.001429846859537065
2023-05-01 02:56:16 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.045688729733228683, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04269527643918991, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.042641084641218185, mean p set: 0.4500633478164673
loss_pred:0.01922721229493618, decouple_loss:0.001371647696942091
loss_pred:0.018168745562434196, decouple_loss:0.0014116826932877302
loss_pred:0.018273506313562393, decouple_loss:0.0013624578714370728
WV_0_PC_1_EH_0_PS_40, loss: 0.018625585362315178, avg_mse: 0.027204547077417374
current test mse: 0.027205
Iteration: 1211, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44704321026802063, gen p mean: -0.043373953551054, mean p set: 0.4475235044956207
The modified gen p mean: 0.447695255279541, gen p mean: -0.04685859754681587, mean p set: 0.4481755197048187
The modified gen p mean: 0.44750165939331055, gen p mean: -0.04240106791257858, mean p set: 0.44798195362091064
loss_pred:0.013220592401921749, decouple_loss:0.0013005243381485343
loss_pred:0.013145819306373596, decouple_loss:0.0014379123458638787
loss_pred:0.012747163884341717, decouple_loss:0.0013450145488604903
Iteration: 1212, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474720358848572, gen p mean: -0.039839569479227066, mean p set: 0.4479523003101349
loss_pred:0.013750983402132988, decouple_loss:0.0012314600171521306
The modified gen p mean: 0.44815152883529663, gen p mean: -0.044236019253730774, mean p set: 0.44863179326057434The modified gen p mean: 0.44720327854156494, gen p mean: -0.0402764193713665, mean p set: 0.4476836025714874
loss_pred:0.012959688901901245, decouple_loss:0.0014021068345755339
loss_pred:0.012861811555922031, decouple_loss:0.0012414451921358705
Iteration: 1213, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480414092540741, gen p mean: -0.03851938992738724, mean p set: 0.4485217034816742
loss_pred:0.013087769970297813, decouple_loss:0.0014567908365279436
The modified gen p mean: 0.44808363914489746, gen p mean: -0.039259035140275955, mean p set: 0.44856393337249756The modified gen p mean: 0.4476890563964844, gen p mean: -0.042545419186353683, mean p set: 0.4481693506240845
loss_pred:0.013606338761746883, decouple_loss:0.001332466839812696
loss_pred:0.012700853869318962, decouple_loss:0.0014171521179378033
Iteration: 1214, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44768840074539185, gen p mean: -0.046612631529569626, mean p set: 0.44816869497299194
The modified gen p mean: 0.44765567779541016, gen p mean: -0.03941604495048523, mean p set: 0.44813597202301025
loss_pred:0.013233741745352745, decouple_loss:0.0013348909560590982
loss_pred:0.013745758682489395, decouple_loss:0.0011917620431631804
The modified gen p mean: 0.44773584604263306, gen p mean: -0.042608462274074554, mean p set: 0.44821614027023315
loss_pred:0.013689410872757435, decouple_loss:0.0012916490668430924
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012009_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012009_3_24hr.npz
NaN value num: 0
Iteration: 1215, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.452109694480896, gen p mean: -0.04032614827156067, mean p set: 0.4525899887084961
loss_pred:0.01726386323571205, decouple_loss:0.0014769115950912237
The modified gen p mean: 0.44981104135513306, gen p mean: -0.03984324261546135, mean p set: 0.45029133558273315The modified gen p mean: 0.45172128081321716, gen p mean: -0.037204500287771225, mean p set: 0.45220157504081726
loss_pred:0.017941610887646675, decouple_loss:0.0014494853094220161
loss_pred:0.01703915186226368, decouple_loss:0.0013446705415844917
Iteration: 1216, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45034050941467285, gen p mean: -0.03894900158047676, mean p set: 0.45082080364227295
loss_pred:0.01684648171067238, decouple_loss:0.0015519290463998914
The modified gen p mean: 0.451815128326416, gen p mean: -0.039001382887363434, mean p set: 0.4522954225540161The modified gen p mean: 0.45099058747291565, gen p mean: -0.03765887767076492, mean p set: 0.45147088170051575
loss_pred:0.01701323129236698, decouple_loss:0.0014409039868041873
loss_pred:0.016667243093252182, decouple_loss:0.0013940768549218774
Iteration: 1217, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45031842589378357, gen p mean: -0.039607301354408264, mean p set: 0.45079872012138367
loss_pred:0.017904682084918022, decouple_loss:0.001383968978188932
The modified gen p mean: 0.4508695900440216, gen p mean: -0.033614061772823334, mean p set: 0.4513498842716217
The modified gen p mean: 0.45179039239883423, gen p mean: -0.03528469428420067, mean p set: 0.4522706866264343
loss_pred:0.016713876277208328, decouple_loss:0.0013768196804448962
loss_pred:0.01758684404194355, decouple_loss:0.0013413699343800545
Iteration: 1218, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4525103271007538, gen p mean: -0.03514896333217621, mean p set: 0.4529906213283539
The modified gen p mean: 0.4497740864753723, gen p mean: -0.041563112288713455, mean p set: 0.4502543807029724loss_pred:0.016491694375872612, decouple_loss:0.001650613034144044
The modified gen p mean: 0.4516625702381134, gen p mean: -0.038592156022787094, mean p set: 0.4521428644657135
loss_pred:0.017598794773221016, decouple_loss:0.001531094778329134
loss_pred:0.016412882134318352, decouple_loss:0.0014523970894515514
Iteration: 1219, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450502872467041, gen p mean: -0.03857062757015228, mean p set: 0.4509831368923187
loss_pred:0.017280444502830505, decouple_loss:0.0015118560986593366
The modified gen p mean: 0.4517621099948883, gen p mean: -0.0346323698759079, mean p set: 0.4522424042224884The modified gen p mean: 0.4508477449417114, gen p mean: -0.03784199431538582, mean p set: 0.4513280689716339
loss_pred:0.016734963282942772, decouple_loss:0.0015328939771279693
loss_pred:0.01654420606791973, decouple_loss:0.0015888233901932836
Iteration: 1220, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45108267664909363, gen p mean: -0.03291540965437889, mean p set: 0.4515630006790161
loss_pred:0.01655995473265648, decouple_loss:0.0015036292606964707
The modified gen p mean: 0.45142197608947754, gen p mean: -0.04162769392132759, mean p set: 0.45190224051475525The modified gen p mean: 0.45043936371803284, gen p mean: -0.03792819753289223, mean p set: 0.4509196877479553
loss_pred:0.017434002831578255, decouple_loss:0.0015924035105854273
loss_pred:0.01720595918595791, decouple_loss:0.0015383404679596424
2023-05-01 02:58:51 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.04162314534187317, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.03844187408685684, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.03855770826339722, mean p set: 0.4500633478164673
loss_pred:0.018620837479829788, decouple_loss:0.0015234125312417746
loss_pred:0.017503704875707626, decouple_loss:0.0015523175243288279
loss_pred:0.01759474165737629, decouple_loss:0.0014738497557118535
WV_0_PC_1_EH_0_PS_40, loss: 0.017982255667448044, avg_mse: 0.025819556787610054
current test mse: 0.02582
Iteration: 1221, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44962507486343384, gen p mean: -0.03632628545165062, mean p set: 0.45010536909103394
The modified gen p mean: 0.4499293267726898, gen p mean: -0.03877032548189163, mean p set: 0.4504096210002899
The modified gen p mean: 0.44939762353897095, gen p mean: -0.037666261196136475, mean p set: 0.44987794756889343
loss_pred:0.01732310652732849, decouple_loss:0.001553592854179442
loss_pred:0.01661651022732258, decouple_loss:0.0014896192587912083
loss_pred:0.017178792506456375, decouple_loss:0.001517448341473937
Iteration: 1222, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4517834484577179, gen p mean: -0.039488956332206726, mean p set: 0.452263742685318
loss_pred:0.016535282135009766, decouple_loss:0.0013689396437257528
The modified gen p mean: 0.45203569531440735, gen p mean: -0.037784185260534286, mean p set: 0.45251601934432983
The modified gen p mean: 0.44968274235725403, gen p mean: -0.037457555532455444, mean p set: 0.4501630365848541
loss_pred:0.01626407727599144, decouple_loss:0.001475425553508103
loss_pred:0.01670079678297043, decouple_loss:0.001520874327979982
Iteration: 1223, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498148560523987, gen p mean: -0.03921758010983467, mean p set: 0.4502951502799988
loss_pred:0.016492364928126335, decouple_loss:0.0014924687566235662
The modified gen p mean: 0.4505032002925873, gen p mean: -0.03921966254711151, mean p set: 0.4509834945201874The modified gen p mean: 0.4511820375919342, gen p mean: -0.040306344628334045, mean p set: 0.4516623318195343
loss_pred:0.016558868810534477, decouple_loss:0.0014473332557827234
loss_pred:0.016762075945734978, decouple_loss:0.001416884595528245
Iteration: 1224, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44945886731147766, gen p mean: -0.042721234261989594, mean p set: 0.44993916153907776
loss_pred:0.016462666913866997, decouple_loss:0.0013460149057209492
The modified gen p mean: 0.4502983093261719, gen p mean: -0.04051704332232475, mean p set: 0.450778603553772The modified gen p mean: 0.45053043961524963, gen p mean: -0.04426290839910507, mean p set: 0.45101073384284973
loss_pred:0.01722278632223606, decouple_loss:0.001291138818487525
loss_pred:0.017222454771399498, decouple_loss:0.0013151587918400764
Iteration: 1225, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4516680836677551, gen p mean: -0.05539259687066078, mean p set: 0.4521483778953552
loss_pred:0.017087604850530624, decouple_loss:0.0013081493088975549
The modified gen p mean: 0.45246824622154236, gen p mean: -0.04491203650832176, mean p set: 0.45294854044914246The modified gen p mean: 0.4513101875782013, gen p mean: -0.04416673257946968, mean p set: 0.4517904818058014
loss_pred:0.017588002607226372, decouple_loss:0.0013782210880890489
loss_pred:0.016311489045619965, decouple_loss:0.0013614207273349166
Iteration: 1226, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511794149875641, gen p mean: -0.05223609879612923, mean p set: 0.4516597390174866
loss_pred:0.016152799129486084, decouple_loss:0.0012559810420498252
The modified gen p mean: 0.4502943754196167, gen p mean: -0.049262695014476776, mean p set: 0.4507746696472168The modified gen p mean: 0.4533883035182953, gen p mean: -0.04718567803502083, mean p set: 0.453868567943573
loss_pred:0.016499537974596024, decouple_loss:0.0013418577145785093
loss_pred:0.017507076263427734, decouple_loss:0.001269168802537024
Iteration: 1227, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494033455848694, gen p mean: -0.05318104848265648, mean p set: 0.4498836398124695
loss_pred:0.016522765159606934, decouple_loss:0.001459712628275156
The modified gen p mean: 0.453704297542572, gen p mean: -0.04652326926589012, mean p set: 0.45418456196784973The modified gen p mean: 0.4508407711982727, gen p mean: -0.046507395803928375, mean p set: 0.4513210654258728
loss_pred:0.016731323674321175, decouple_loss:0.001257423311471939
loss_pred:0.017290938645601273, decouple_loss:0.0012288058642297983
Iteration: 1228, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45086970925331116, gen p mean: -0.04882996156811714, mean p set: 0.45135000348091125
loss_pred:0.01650628261268139, decouple_loss:0.0013695396482944489
The modified gen p mean: 0.4494931399822235, gen p mean: -0.05142749473452568, mean p set: 0.449973464012146
The modified gen p mean: 0.4514254629611969, gen p mean: -0.04704877361655235, mean p set: 0.451905757188797
loss_pred:0.01675243303179741, decouple_loss:0.0013529323041439056
loss_pred:0.016969110816717148, decouple_loss:0.0013650722103193402
Iteration: 1229, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45193731784820557, gen p mean: -0.04471486434340477, mean p set: 0.45241761207580566
loss_pred:0.0167777668684721, decouple_loss:0.0013348071370273829
The modified gen p mean: 0.4515420198440552, gen p mean: -0.04648848995566368, mean p set: 0.4520223140716553The modified gen p mean: 0.45151445269584656, gen p mean: -0.050389040261507034, mean p set: 0.45199474692344666
loss_pred:0.0169203020632267, decouple_loss:0.0013079555938020349
loss_pred:0.01613416150212288, decouple_loss:0.0013018405297771096
Iteration: 1230, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44928792119026184, gen p mean: -0.044141314923763275, mean p set: 0.4497682452201843
loss_pred:0.016871556639671326, decouple_loss:0.0012019730638712645
The modified gen p mean: 0.4493584632873535, gen p mean: -0.048242755234241486, mean p set: 0.4498387575149536
The modified gen p mean: 0.4510711133480072, gen p mean: -0.04473142698407173, mean p set: 0.4515514075756073
loss_pred:0.016852006316184998, decouple_loss:0.0011381604708731174
loss_pred:0.016987700015306473, decouple_loss:0.0012350353645160794
2023-05-01 03:00:43 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.04937177896499634, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.045718517154455185, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04603132605552673, mean p set: 0.4500633478164673
loss_pred:0.018379278481006622, decouple_loss:0.0011852927273139358
loss_pred:0.01731353998184204, decouple_loss:0.0012258897768333554
loss_pred:0.01741189695894718, decouple_loss:0.0012051906669512391
WV_0_PC_1_EH_0_PS_40, loss: 0.017761845141649246, avg_mse: 0.02546023018658161
current test mse: 0.02546
Iteration: 1231, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45313552021980286, gen p mean: -0.04346449300646782, mean p set: 0.45361581444740295
The modified gen p mean: 0.45180270075798035, gen p mean: -0.04134461283683777, mean p set: 0.45228299498558044
The modified gen p mean: 0.4527937173843384, gen p mean: -0.044090237468481064, mean p set: 0.4532740116119385
loss_pred:0.016200941056013107, decouple_loss:0.0011041999096050858
loss_pred:0.016556130722165108, decouple_loss:0.0011933251516893506
loss_pred:0.016513651236891747, decouple_loss:0.0013198289088904858
Iteration: 1232, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4517233073711395, gen p mean: -0.04087767004966736, mean p set: 0.452203631401062The modified gen p mean: 0.45124033093452454, gen p mean: -0.05035097897052765, mean p set: 0.45172062516212463
loss_pred:0.016902783885598183, decouple_loss:0.001169377937912941loss_pred:0.017136413604021072, decouple_loss:0.0012427984038367867
The modified gen p mean: 0.4499562680721283, gen p mean: -0.04196229577064514, mean p set: 0.4504365921020508
loss_pred:0.01609002985060215, decouple_loss:0.0012158566387370229
Iteration: 1233, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45118770003318787, gen p mean: -0.04059508815407753, mean p set: 0.45166799426078796
loss_pred:0.016881238669157028, decouple_loss:0.001090194913558662
The modified gen p mean: 0.4498800039291382, gen p mean: -0.043167851865291595, mean p set: 0.4503602981567383The modified gen p mean: 0.44959643483161926, gen p mean: -0.04075910896062851, mean p set: 0.45007672905921936
loss_pred:0.016499554738402367, decouple_loss:0.0011306017404422164
loss_pred:0.016715511679649353, decouple_loss:0.0011591685470193624
Iteration: 1234, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500633776187897, gen p mean: -0.0409696027636528, mean p set: 0.45054367184638977
loss_pred:0.016008567065000534, decouple_loss:0.001176689867861569
The modified gen p mean: 0.4520491063594818, gen p mean: -0.03870142996311188, mean p set: 0.4525294005870819
The modified gen p mean: 0.4510924220085144, gen p mean: -0.04015045985579491, mean p set: 0.4515727162361145
loss_pred:0.01653962768614292, decouple_loss:0.0011245092609897256
loss_pred:0.016391851007938385, decouple_loss:0.0010694453958421946
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012015_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012015_3_24hr.npz
NaN value num: 0
Iteration: 1235, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492291510105133, gen p mean: -0.03589816391468048, mean p set: 0.4497094452381134
loss_pred:0.017309486865997314, decouple_loss:0.0013117481721565127
The modified gen p mean: 0.4524902403354645, gen p mean: -0.03606824949383736, mean p set: 0.4529705345630646The modified gen p mean: 0.4497421085834503, gen p mean: -0.03698232024908066, mean p set: 0.450222373008728
loss_pred:0.01727720908820629, decouple_loss:0.0012934493133798242
loss_pred:0.017259985208511353, decouple_loss:0.0011797825573012233
Iteration: 1236, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501085579395294, gen p mean: -0.03336836025118828, mean p set: 0.4505888819694519
The modified gen p mean: 0.4488903880119324, gen p mean: -0.03512798994779587, mean p set: 0.4493706524372101
loss_pred:0.018057482317090034, decouple_loss:0.00132597831543535
loss_pred:0.017119761556386948, decouple_loss:0.0012311895843595266
The modified gen p mean: 0.45025038719177246, gen p mean: -0.03430850803852081, mean p set: 0.4507306218147278
loss_pred:0.017600610852241516, decouple_loss:0.0012103364570066333
Iteration: 1237, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45288676023483276, gen p mean: -0.03351150453090668, mean p set: 0.4533670246601105
loss_pred:0.01751265488564968, decouple_loss:0.0012543811462819576
The modified gen p mean: 0.45058462023735046, gen p mean: -0.04252508282661438, mean p set: 0.45106494426727295The modified gen p mean: 0.45174384117126465, gen p mean: -0.02894231490790844, mean p set: 0.45222410559654236
loss_pred:0.01709304377436638, decouple_loss:0.0011254549026489258
loss_pred:0.018058398738503456, decouple_loss:0.0013149080332368612
Iteration: 1238, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44832563400268555, gen p mean: -0.03472699224948883, mean p set: 0.44880592823028564
loss_pred:0.016888432204723358, decouple_loss:0.001253813155926764
The modified gen p mean: 0.45019111037254333, gen p mean: -0.043183691799640656, mean p set: 0.45067140460014343The modified gen p mean: 0.4508938491344452, gen p mean: -0.03219261020421982, mean p set: 0.4513741731643677
loss_pred:0.017162619158625603, decouple_loss:0.0011947306338697672
loss_pred:0.017270196229219437, decouple_loss:0.0011640359880402684
Iteration: 1239, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489805996417999, gen p mean: -0.03625689819455147, mean p set: 0.4494609236717224
loss_pred:0.017333166673779488, decouple_loss:0.0011579240672290325
The modified gen p mean: 0.44881466031074524, gen p mean: -0.03584575653076172, mean p set: 0.44929495453834534The modified gen p mean: 0.4511186480522156, gen p mean: -0.031151754781603813, mean p set: 0.4515989124774933
loss_pred:0.01719357818365097, decouple_loss:0.001268225023522973
loss_pred:0.018178723752498627, decouple_loss:0.0012161585036665201
Iteration: 1240, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44971194863319397, gen p mean: -0.04110117629170418, mean p set: 0.4501922130584717
loss_pred:0.017078973352909088, decouple_loss:0.001253538765013218
The modified gen p mean: 0.4484226703643799, gen p mean: -0.04039117321372032, mean p set: 0.4489029347896576The modified gen p mean: 0.4490912854671478, gen p mean: -0.039208993315696716, mean p set: 0.4495715796947479
loss_pred:0.016289658844470978, decouple_loss:0.0011675527784973383
loss_pred:0.017311448231339455, decouple_loss:0.0011273093987256289
2023-05-01 03:03:16 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.05299808084964752, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04900505393743515, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.0492338165640831, mean p set: 0.4500633478164673
loss_pred:0.018390798941254616, decouple_loss:0.0012192423455417156
loss_pred:0.017303084954619408, decouple_loss:0.0011652186512947083
loss_pred:0.017384536564350128, decouple_loss:0.001158221042715013
WV_0_PC_1_EH_0_PS_40, loss: 0.01775185391306877, avg_mse: 0.025440070778131485
current test mse: 0.02544
Iteration: 1241, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4512256383895874, gen p mean: -0.041113708168268204, mean p set: 0.4517059326171875
The modified gen p mean: 0.4497857689857483, gen p mean: -0.04627971723675728, mean p set: 0.4502660930156708
The modified gen p mean: 0.45325762033462524, gen p mean: -0.041073840111494064, mean p set: 0.45373791456222534
loss_pred:0.018109994009137154, decouple_loss:0.0011655519483610988
loss_pred:0.01829802431166172, decouple_loss:0.0011901728576049209
loss_pred:0.01684987172484398, decouple_loss:0.0011600102297961712
Iteration: 1242, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493042826652527, gen p mean: -0.04955463111400604, mean p set: 0.4497845768928528
The modified gen p mean: 0.45079657435417175, gen p mean: -0.04518500715494156, mean p set: 0.45127683877944946
loss_pred:0.018238332122564316, decouple_loss:0.0012605370720848441
loss_pred:0.016852430999279022, decouple_loss:0.0011257135774940252
The modified gen p mean: 0.4490957260131836, gen p mean: -0.049995455890893936, mean p set: 0.4495759904384613
loss_pred:0.017954068258404732, decouple_loss:0.0013408745871856809
Iteration: 1243, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482678472995758, gen p mean: -0.0523848831653595, mean p set: 0.4487481415271759
loss_pred:0.01753990724682808, decouple_loss:0.0012105877976864576
The modified gen p mean: 0.44957685470581055, gen p mean: -0.05776072293519974, mean p set: 0.45005717873573303The modified gen p mean: 0.449121356010437, gen p mean: -0.05491769313812256, mean p set: 0.4496016502380371
loss_pred:0.0172459427267313, decouple_loss:0.001185996225103736
loss_pred:0.017433568835258484, decouple_loss:0.0011827758280560374
Iteration: 1244, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4528255760669708, gen p mean: -0.05053149163722992, mean p set: 0.45330584049224854
loss_pred:0.017841637134552002, decouple_loss:0.0013389234663918614
The modified gen p mean: 0.45049571990966797, gen p mean: -0.05328036844730377, mean p set: 0.45097601413726807The modified gen p mean: 0.44994911551475525, gen p mean: -0.05502181127667427, mean p set: 0.45042943954467773
loss_pred:0.017729509621858597, decouple_loss:0.0012398241087794304
loss_pred:0.017253445461392403, decouple_loss:0.0011964538134634495
Iteration: 1245, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498249292373657, gen p mean: -0.0553290881216526, mean p set: 0.45030519366264343
loss_pred:0.01678498275578022, decouple_loss:0.0012309820158407092
The modified gen p mean: 0.4490293860435486, gen p mean: -0.053517989814281464, mean p set: 0.4495096802711487The modified gen p mean: 0.4510059058666229, gen p mean: -0.051494698971509933, mean p set: 0.45148617029190063
loss_pred:0.01737508364021778, decouple_loss:0.0011324805673211813
loss_pred:0.017691796645522118, decouple_loss:0.0012745554558932781
Iteration: 1246, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44951194524765015, gen p mean: -0.05312355235219002, mean p set: 0.44999220967292786
loss_pred:0.01736057549715042, decouple_loss:0.0011629854561761022
The modified gen p mean: 0.45053189992904663, gen p mean: -0.05168658122420311, mean p set: 0.45101216435432434The modified gen p mean: 0.4491286873817444, gen p mean: -0.05299486964941025, mean p set: 0.4496089518070221
loss_pred:0.016987666487693787, decouple_loss:0.001204719883389771
loss_pred:0.017888296395540237, decouple_loss:0.0011860061204060912
Iteration: 1247, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504856467247009, gen p mean: -0.04683542996644974, mean p set: 0.450965940952301
loss_pred:0.017799263820052147, decouple_loss:0.0012954515404999256
The modified gen p mean: 0.45099177956581116, gen p mean: -0.043076880276203156, mean p set: 0.45147207379341125The modified gen p mean: 0.44985663890838623, gen p mean: -0.05741383880376816, mean p set: 0.4503369629383087
loss_pred:0.016788821667432785, decouple_loss:0.0011825464898720384
loss_pred:0.01804959774017334, decouple_loss:0.0012598372995853424
Iteration: 1248, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486089050769806, gen p mean: -0.048557452857494354, mean p set: 0.4490891993045807
loss_pred:0.01753958687186241, decouple_loss:0.0011478607775643468
The modified gen p mean: 0.45101234316825867, gen p mean: -0.04727896675467491, mean p set: 0.45149263739585876The modified gen p mean: 0.4495984613895416, gen p mean: -0.052206747233867645, mean p set: 0.4500787556171417
loss_pred:0.01673153229057789, decouple_loss:0.0012184776132926345
loss_pred:0.017642568796873093, decouple_loss:0.0011995069216936827
Iteration: 1249, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44890713691711426, gen p mean: -0.04853148013353348, mean p set: 0.44938743114471436
loss_pred:0.01654919609427452, decouple_loss:0.0010806431528180838
The modified gen p mean: 0.45146018266677856, gen p mean: -0.0398557074368, mean p set: 0.45194050669670105The modified gen p mean: 0.4517269432544708, gen p mean: -0.04320972412824631, mean p set: 0.45220720767974854
loss_pred:0.017420971766114235, decouple_loss:0.001120482455007732
loss_pred:0.01742822304368019, decouple_loss:0.0011255171848461032
Iteration: 1250, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44866570830345154, gen p mean: -0.04413282498717308, mean p set: 0.44914600253105164
loss_pred:0.017522528767585754, decouple_loss:0.0012834124499931931
The modified gen p mean: 0.44919833540916443, gen p mean: -0.047813814133405685, mean p set: 0.4496786296367645The modified gen p mean: 0.4520019292831421, gen p mean: -0.047771163284778595, mean p set: 0.4524822235107422
loss_pred:0.017204085364937782, decouple_loss:0.001312147593125701
loss_pred:0.016773534938693047, decouple_loss:0.0013177277287468314
2023-05-01 03:05:09 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.05696498975157738, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.05284545570611954, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.05280585214495659, mean p set: 0.4500633478164673
loss_pred:0.018391381949186325, decouple_loss:0.0013889019610360265
loss_pred:0.017272230237722397, decouple_loss:0.0012632292928174138
loss_pred:0.017395924776792526, decouple_loss:0.0012492986861616373
WV_0_PC_1_EH_0_PS_40, loss: 0.017751537263393402, avg_mse: 0.02544740028679371
current test mse: 0.025447
Iteration: 1251, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44845959544181824, gen p mean: -0.046144843101501465, mean p set: 0.4489399194717407
The modified gen p mean: 0.44978469610214233, gen p mean: -0.04711734503507614, mean p set: 0.45026499032974243
The modified gen p mean: 0.44844138622283936, gen p mean: -0.04744405299425125, mean p set: 0.44892165064811707
loss_pred:0.01728983223438263, decouple_loss:0.0013605765998363495
loss_pred:0.01628217287361622, decouple_loss:0.0012803812278434634
loss_pred:0.01615879312157631, decouple_loss:0.0012481630546972156
Iteration: 1252, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502372443675995, gen p mean: -0.04645422101020813, mean p set: 0.4507175385951996
The modified gen p mean: 0.448651522397995, gen p mean: -0.04707910120487213, mean p set: 0.4491318166255951
loss_pred:0.01692749746143818, decouple_loss:0.001130184275098145
loss_pred:0.016003910452127457, decouple_loss:0.001157556427642703
The modified gen p mean: 0.44913265109062195, gen p mean: -0.04818716645240784, mean p set: 0.44961294531822205
loss_pred:0.017128635197877884, decouple_loss:0.0012291281018406153
Iteration: 1253, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45077425241470337, gen p mean: -0.04116776958107948, mean p set: 0.45125457644462585
loss_pred:0.01699031889438629, decouple_loss:0.0012309273006394506
The modified gen p mean: 0.44956880807876587, gen p mean: -0.03914128988981247, mean p set: 0.45004913210868835The modified gen p mean: 0.45107409358024597, gen p mean: -0.03692812845110893, mean p set: 0.4515543580055237
loss_pred:0.017798548564314842, decouple_loss:0.00128931796643883
loss_pred:0.017525218427181244, decouple_loss:0.0012113723205402493
Iteration: 1254, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45114290714263916, gen p mean: -0.045060545206069946, mean p set: 0.45162320137023926
loss_pred:0.017180759459733963, decouple_loss:0.0012927113566547632
The modified gen p mean: 0.4492603838443756, gen p mean: -0.04775197431445122, mean p set: 0.4497406780719757The modified gen p mean: 0.45049893856048584, gen p mean: -0.044454071670770645, mean p set: 0.45097923278808594
loss_pred:0.016217514872550964, decouple_loss:0.0012338757514953613
loss_pred:0.01664956472814083, decouple_loss:0.001153192250058055
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012013_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012013_3_24hr.npz
NaN value num: 0
Iteration: 1255, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473395347595215, gen p mean: -0.05193851515650749, mean p set: 0.4478198289871216
loss_pred:0.017176058143377304, decouple_loss:0.0012264617253094912
The modified gen p mean: 0.44679510593414307, gen p mean: -0.054441530257463455, mean p set: 0.44727540016174316The modified gen p mean: 0.4478020966053009, gen p mean: -0.06014884263277054, mean p set: 0.4482823610305786
loss_pred:0.017250584438443184, decouple_loss:0.0013311043148860335
loss_pred:0.01761082001030445, decouple_loss:0.0012291627936065197
Iteration: 1256, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447870135307312, gen p mean: -0.05549044534564018, mean p set: 0.4483503997325897
The modified gen p mean: 0.4464631974697113, gen p mean: -0.05071532726287842, mean p set: 0.4469434916973114
loss_pred:0.0173035841435194, decouple_loss:0.0011749278055503964
loss_pred:0.01793430559337139, decouple_loss:0.0012464304454624653
The modified gen p mean: 0.4461911916732788, gen p mean: -0.05331962928175926, mean p set: 0.4466714859008789
loss_pred:0.017444798722863197, decouple_loss:0.0013010506518185139
Iteration: 1257, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44741547107696533, gen p mean: -0.056548792868852615, mean p set: 0.44789573550224304
The modified gen p mean: 0.44642043113708496, gen p mean: -0.05357193946838379, mean p set: 0.44690072536468506
loss_pred:0.017543064430356026, decouple_loss:0.0011239905143156648
loss_pred:0.017352372407913208, decouple_loss:0.0011768525000661612
The modified gen p mean: 0.4460989236831665, gen p mean: -0.05106976628303528, mean p set: 0.4465792179107666
loss_pred:0.01735157147049904, decouple_loss:0.0012781963450834155
Iteration: 1258, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465689957141876, gen p mean: -0.05201563239097595, mean p set: 0.44704926013946533
loss_pred:0.018250012770295143, decouple_loss:0.0014255042187869549
The modified gen p mean: 0.44760680198669434, gen p mean: -0.05644501745700836, mean p set: 0.4480871260166168The modified gen p mean: 0.4454883337020874, gen p mean: -0.05516820773482323, mean p set: 0.4459685981273651
loss_pred:0.017330246046185493, decouple_loss:0.0012437643017619848
loss_pred:0.01733136922121048, decouple_loss:0.0013458147877827287
Iteration: 1259, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470159113407135, gen p mean: -0.057191573083400726, mean p set: 0.4474962055683136
loss_pred:0.017709285020828247, decouple_loss:0.0012916459236294031
The modified gen p mean: 0.4461131691932678, gen p mean: -0.055630628019571304, mean p set: 0.4465934634208679The modified gen p mean: 0.4469752311706543, gen p mean: -0.05169833451509476, mean p set: 0.4474555552005768
loss_pred:0.016830483451485634, decouple_loss:0.0011385453399270773
loss_pred:0.017396148294210434, decouple_loss:0.0011572209186851978
Iteration: 1260, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44726109504699707, gen p mean: -0.046816788613796234, mean p set: 0.44774138927459717
loss_pred:0.01785874553024769, decouple_loss:0.0014528747415170074
The modified gen p mean: 0.4462970495223999, gen p mean: -0.047175440937280655, mean p set: 0.44677734375The modified gen p mean: 0.4484342336654663, gen p mean: -0.05142439156770706, mean p set: 0.448914498090744
loss_pred:0.017566602677106857, decouple_loss:0.001413749996572733
loss_pred:0.017394712194800377, decouple_loss:0.0015721957897767425
2023-05-01 03:07:47 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.05132622271776199, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.046975042670965195, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830237865448, gen p mean: -0.04730786010622978, mean p set: 0.4500633478164673
loss_pred:0.0183187797665596, decouple_loss:0.0014824050012975931
loss_pred:0.01726841926574707, decouple_loss:0.001515163923613727
loss_pred:0.01736358366906643, decouple_loss:0.001456312369555235
WV_0_PC_1_EH_0_PS_40, loss: 0.01772449165582657, avg_mse: 0.025362597778439522
current test mse: 0.025363
Iteration: 1261, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44664090871810913, gen p mean: -0.05173683539032936, mean p set: 0.44712120294570923
The modified gen p mean: 0.44687533378601074, gen p mean: -0.04777534306049347, mean p set: 0.44735562801361084
The modified gen p mean: 0.446698933839798, gen p mean: -0.05065862089395523, mean p set: 0.44717922806739807
loss_pred:0.017774783074855804, decouple_loss:0.0014450210146605968
loss_pred:0.018136678263545036, decouple_loss:0.0015754480846226215
loss_pred:0.017227817326784134, decouple_loss:0.001373267499729991
Iteration: 1262, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4456179440021515, gen p mean: -0.0446731261909008, mean p set: 0.446098268032074
loss_pred:0.017572129145264626, decouple_loss:0.0014622987946495414
The modified gen p mean: 0.4471037983894348, gen p mean: -0.04596712067723274, mean p set: 0.4475840926170349The modified gen p mean: 0.44737502932548523, gen p mean: -0.05116394907236099, mean p set: 0.4478553533554077
loss_pred:0.017812812700867653, decouple_loss:0.001534316223114729
loss_pred:0.016892440617084503, decouple_loss:0.001400889945216477
Iteration: 1263, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471263885498047, gen p mean: -0.04108735918998718, mean p set: 0.4476066827774048
loss_pred:0.01681247539818287, decouple_loss:0.0014895584899932146
The modified gen p mean: 0.4469386339187622, gen p mean: -0.03881340101361275, mean p set: 0.4474189281463623The modified gen p mean: 0.44791150093078613, gen p mean: -0.042312536388635635, mean p set: 0.44839179515838623
loss_pred:0.017301272600889206, decouple_loss:0.001410714816302061
loss_pred:0.017387036234140396, decouple_loss:0.0013899847399443388
Iteration: 1264, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477238059043884, gen p mean: -0.04199518263339996, mean p set: 0.4482041299343109
loss_pred:0.01711563766002655, decouple_loss:0.0013871961273252964
The modified gen p mean: 0.4476120173931122, gen p mean: -0.0446641743183136, mean p set: 0.4480923116207123The modified gen p mean: 0.44800689816474915, gen p mean: -0.037945542484521866, mean p set: 0.44848719239234924
loss_pred:0.0174099188297987, decouple_loss:0.0015077220741659403
loss_pred:0.01713489554822445, decouple_loss:0.001470285002142191
Iteration: 1265, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464642107486725, gen p mean: -0.04576863348484039, mean p set: 0.4469445049762726
loss_pred:0.016840118914842606, decouple_loss:0.0012046158080920577
The modified gen p mean: 0.44698628783226013, gen p mean: -0.045684121549129486, mean p set: 0.44746658205986023The modified gen p mean: 0.44826653599739075, gen p mean: -0.04176152125000954, mean p set: 0.44874683022499084
loss_pred:0.01738651655614376, decouple_loss:0.0011503977002575994
loss_pred:0.01816822588443756, decouple_loss:0.0011939272517338395
Iteration: 1266, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470379650592804, gen p mean: -0.04095641151070595, mean p set: 0.4475182592868805
loss_pred:0.01722160540521145, decouple_loss:0.0014824240934103727
The modified gen p mean: 0.44770678877830505, gen p mean: -0.03881515562534332, mean p set: 0.44818708300590515The modified gen p mean: 0.44699329137802124, gen p mean: -0.04575349763035774, mean p set: 0.44747358560562134
loss_pred:0.01715051755309105, decouple_loss:0.0012647492112591863
loss_pred:0.0172225721180439, decouple_loss:0.0012921721208840609
Iteration: 1267, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44673311710357666, gen p mean: -0.041748952120542526, mean p set: 0.44721341133117676
loss_pred:0.01712588220834732, decouple_loss:0.0012717714998871088
The modified gen p mean: 0.44781431555747986, gen p mean: -0.04029401019215584, mean p set: 0.44829463958740234The modified gen p mean: 0.44674113392829895, gen p mean: -0.037833478301763535, mean p set: 0.44722142815589905
loss_pred:0.0175312552601099, decouple_loss:0.0011692713014781475
loss_pred:0.01827276311814785, decouple_loss:0.0012832037173211575
Iteration: 1268, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4463730454444885, gen p mean: -0.045627277344465256, mean p set: 0.446853369474411
loss_pred:0.01727130636572838, decouple_loss:0.001251731300726533
The modified gen p mean: 0.4479556977748871, gen p mean: -0.04001794382929802, mean p set: 0.4484359920024872The modified gen p mean: 0.44809529185295105, gen p mean: -0.039786115288734436, mean p set: 0.44857561588287354
loss_pred:0.017509303987026215, decouple_loss:0.001115127233788371
loss_pred:0.01704837940633297, decouple_loss:0.0011648478684946895
Iteration: 1269, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4460814893245697, gen p mean: -0.04639282077550888, mean p set: 0.4465617835521698
loss_pred:0.016799939796328545, decouple_loss:0.0012731829192489386
The modified gen p mean: 0.4479420483112335, gen p mean: -0.044699158519506454, mean p set: 0.44842231273651123The modified gen p mean: 0.4464874863624573, gen p mean: -0.036744631826877594, mean p set: 0.4469677805900574
loss_pred:0.01756906323134899, decouple_loss:0.0010926899267360568
loss_pred:0.017863867804408073, decouple_loss:0.0013452761340886354
Iteration: 1270, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44801345467567444, gen p mean: -0.044769804924726486, mean p set: 0.44849371910095215
loss_pred:0.017339956015348434, decouple_loss:0.0010823126649484038
The modified gen p mean: 0.44815316796302795, gen p mean: -0.04973377287387848, mean p set: 0.44863349199295044The modified gen p mean: 0.4472595155239105, gen p mean: -0.04635576158761978, mean p set: 0.4477398097515106
loss_pred:0.01719602756202221, decouple_loss:0.0010272322688251734
loss_pred:0.018099742010235786, decouple_loss:0.0011249834205955267
2023-05-01 03:09:39 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.05127457529306412, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04652702435851097, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.04710068926215172, mean p set: 0.4500633478164673
loss_pred:0.018275080248713493, decouple_loss:0.0013632354093715549
loss_pred:0.017267214134335518, decouple_loss:0.001505936961621046
loss_pred:0.017316527664661407, decouple_loss:0.0014358989428728819
WV_0_PC_1_EH_0_PS_40, loss: 0.01769135892391205, avg_mse: 0.025331968441605568
current test mse: 0.025332
Iteration: 1271, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44780200719833374, gen p mean: -0.04844796657562256, mean p set: 0.44828227162361145
The modified gen p mean: 0.44728416204452515, gen p mean: -0.05119085684418678, mean p set: 0.44776445627212524
The modified gen p mean: 0.4473097324371338, gen p mean: -0.04649008437991142, mean p set: 0.4477900266647339
loss_pred:0.017538487911224365, decouple_loss:0.0014584267046302557
loss_pred:0.017920799553394318, decouple_loss:0.001470232498832047
loss_pred:0.018319198861718178, decouple_loss:0.0013655426446348429
Iteration: 1272, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44686761498451233, gen p mean: -0.05244596302509308, mean p set: 0.4473479390144348
loss_pred:0.017350519075989723, decouple_loss:0.0011529569746926427
The modified gen p mean: 0.4477015435695648, gen p mean: -0.051739729940891266, mean p set: 0.4481818377971649The modified gen p mean: 0.4486715495586395, gen p mean: -0.04981272667646408, mean p set: 0.44915181398391724
loss_pred:0.018093548715114594, decouple_loss:0.001075299340300262
loss_pred:0.017009224742650986, decouple_loss:0.001148841343820095
Iteration: 1273, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478500783443451, gen p mean: -0.04933043569326401, mean p set: 0.4483303725719452
loss_pred:0.017393141984939575, decouple_loss:0.0011185260955244303
The modified gen p mean: 0.4459565579891205, gen p mean: -0.05118921399116516, mean p set: 0.4464368224143982The modified gen p mean: 0.4473837912082672, gen p mean: -0.05074043944478035, mean p set: 0.4478640854358673
loss_pred:0.017691679298877716, decouple_loss:0.0012468915665522218
loss_pred:0.018007323145866394, decouple_loss:0.0010480866767466068
Iteration: 1274, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44695407152175903, gen p mean: -0.04564184322953224, mean p set: 0.44743436574935913
loss_pred:0.01696111261844635, decouple_loss:0.0010989047586917877
The modified gen p mean: 0.4464389681816101, gen p mean: -0.04565351828932762, mean p set: 0.4469192922115326The modified gen p mean: 0.4456441104412079, gen p mean: -0.04618389904499054, mean p set: 0.4461243748664856
loss_pred:0.01820339635014534, decouple_loss:0.0011823797831311822
loss_pred:0.017230544239282608, decouple_loss:0.0011661278549581766
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012018_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012018_3_24hr.npz
NaN value num: 0
Iteration: 1275, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4531592130661011, gen p mean: -0.040833234786987305, mean p set: 0.45363950729370117
loss_pred:0.017486579716205597, decouple_loss:0.0013580051017925143
The modified gen p mean: 0.4502507746219635, gen p mean: -0.040735259652137756, mean p set: 0.4507310390472412The modified gen p mean: 0.4519538879394531, gen p mean: -0.039454467594623566, mean p set: 0.4524341821670532
loss_pred:0.01682523638010025, decouple_loss:0.0013143452815711498loss_pred:0.016476908698678017, decouple_loss:0.0012020276626572013
Iteration: 1276, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4531858265399933, gen p mean: -0.038123223930597305, mean p set: 0.45366615056991577
loss_pred:0.018556825816631317, decouple_loss:0.00133029546122998
The modified gen p mean: 0.4505513906478882, gen p mean: -0.04158647730946541, mean p set: 0.4510316848754883The modified gen p mean: 0.45375755429267883, gen p mean: -0.03995951637625694, mean p set: 0.4542378783226013
loss_pred:0.016407696530222893, decouple_loss:0.0011750839184969664
loss_pred:0.01716616563498974, decouple_loss:0.00123331299982965
Iteration: 1277, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4534457325935364, gen p mean: -0.04535452276468277, mean p set: 0.4539260268211365
loss_pred:0.016199812293052673, decouple_loss:0.0013679960975423455
The modified gen p mean: 0.4496065378189087, gen p mean: -0.046702753752470016, mean p set: 0.4500868618488312The modified gen p mean: 0.4541676640510559, gen p mean: -0.03912609443068504, mean p set: 0.454647958278656
loss_pred:0.015447832643985748, decouple_loss:0.0012226179242134094
loss_pred:0.01662343554198742, decouple_loss:0.0011797075858339667
Iteration: 1278, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45180192589759827, gen p mean: -0.03531739115715027, mean p set: 0.452282190322876
loss_pred:0.0167585089802742, decouple_loss:0.0013066160026937723
The modified gen p mean: 0.45329105854034424, gen p mean: -0.04319196939468384, mean p set: 0.4537713825702667The modified gen p mean: 0.45349958539009094, gen p mean: -0.04207659140229225, mean p set: 0.45397984981536865
loss_pred:0.017003346234560013, decouple_loss:0.0014131595380604267
loss_pred:0.015899812802672386, decouple_loss:0.0013231536140665412
Iteration: 1279, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4521256983280182, gen p mean: -0.0440068393945694, mean p set: 0.4526059925556183
loss_pred:0.017698245123028755, decouple_loss:0.0012901206500828266
The modified gen p mean: 0.45374709367752075, gen p mean: -0.04326995834708214, mean p set: 0.45422741770744324The modified gen p mean: 0.4499393105506897, gen p mean: -0.04580322653055191, mean p set: 0.4504196047782898
loss_pred:0.016574544832110405, decouple_loss:0.0011502067791298032
loss_pred:0.015542964451014996, decouple_loss:0.0012931308010593057
Iteration: 1280, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514513611793518, gen p mean: -0.04433421790599823, mean p set: 0.4519317150115967
loss_pred:0.018041986972093582, decouple_loss:0.0010983844986185431
The modified gen p mean: 0.4498823583126068, gen p mean: -0.042496174573898315, mean p set: 0.4503626525402069The modified gen p mean: 0.4529207944869995, gen p mean: -0.042616646736860275, mean p set: 0.4534010887145996
loss_pred:0.016192199662327766, decouple_loss:0.0011498993262648582loss_pred:0.01680237427353859, decouple_loss:0.0012028972851112485
2023-05-01 03:12:05 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.05001137778162956, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04615580290555954, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.04630833864212036, mean p set: 0.4500633478164673
loss_pred:0.018364427611231804, decouple_loss:0.0013927617110311985
loss_pred:0.01726256124675274, decouple_loss:0.0012515634298324585
loss_pred:0.017392553389072418, decouple_loss:0.001343178446404636
WV_0_PC_1_EH_0_PS_40, loss: 0.017739638686180115, avg_mse: 0.025416620075702667
current test mse: 0.025417
Iteration: 1281, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4523985683917999, gen p mean: -0.04053519666194916, mean p set: 0.45287883281707764
The modified gen p mean: 0.4530890882015228, gen p mean: -0.04334490746259689, mean p set: 0.4535693824291229
The modified gen p mean: 0.45179131627082825, gen p mean: -0.0351140983402729, mean p set: 0.45227164030075073
loss_pred:0.018281223252415657, decouple_loss:0.0013232877245172858
loss_pred:0.01572687178850174, decouple_loss:0.0012975718127563596
loss_pred:0.01666332222521305, decouple_loss:0.0012718781363219023
Iteration: 1282, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508505165576935, gen p mean: -0.040407538414001465, mean p set: 0.4513308107852936
loss_pred:0.016619788482785225, decouple_loss:0.0012163023930042982
The modified gen p mean: 0.45042169094085693, gen p mean: -0.044374946504831314, mean p set: 0.45090195536613464The modified gen p mean: 0.4501402974128723, gen p mean: -0.04320148006081581, mean p set: 0.4506206214427948
loss_pred:0.016516270115971565, decouple_loss:0.0011358213378116488
loss_pred:0.015375514514744282, decouple_loss:0.00121150107588619
Iteration: 1283, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4548651874065399, gen p mean: -0.04249716177582741, mean p set: 0.45534548163414
loss_pred:0.015990400686860085, decouple_loss:0.0012581830378621817
The modified gen p mean: 0.4515368342399597, gen p mean: -0.04044255241751671, mean p set: 0.4520170986652374The modified gen p mean: 0.45307889580726624, gen p mean: -0.04388362169265747, mean p set: 0.45355919003486633
loss_pred:0.017544928938150406, decouple_loss:0.0012519237352535129
loss_pred:0.01742606982588768, decouple_loss:0.0012180798221379519
Iteration: 1284, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45320290327072144, gen p mean: -0.045920852571725845, mean p set: 0.4536832273006439
loss_pred:0.01611509546637535, decouple_loss:0.0013943978119641542
The modified gen p mean: 0.4495961666107178, gen p mean: -0.03995595872402191, mean p set: 0.4500764310359955The modified gen p mean: 0.4529380202293396, gen p mean: -0.036878131330013275, mean p set: 0.4534182846546173
loss_pred:0.01655816100537777, decouple_loss:0.0014666407369077206
loss_pred:0.01791469380259514, decouple_loss:0.0015709016006439924
Iteration: 1285, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508812725543976, gen p mean: -0.04187946394085884, mean p set: 0.45136159658432007
loss_pred:0.016344986855983734, decouple_loss:0.0013104660902172327
The modified gen p mean: 0.4530724287033081, gen p mean: -0.043577734380960464, mean p set: 0.4535527229309082The modified gen p mean: 0.45190170407295227, gen p mean: -0.04210542142391205, mean p set: 0.45238202810287476
loss_pred:0.015616258606314659, decouple_loss:0.0013744767056778073
loss_pred:0.017626365646719933, decouple_loss:0.0012534635607153177
Iteration: 1286, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45127907395362854, gen p mean: -0.04485413804650307, mean p set: 0.45175933837890625
loss_pred:0.016038939356803894, decouple_loss:0.0013622676488012075
The modified gen p mean: 0.45120465755462646, gen p mean: -0.03856572136282921, mean p set: 0.45168498158454895The modified gen p mean: 0.451896607875824, gen p mean: -0.043345749378204346, mean p set: 0.4523768723011017
loss_pred:0.017252173274755478, decouple_loss:0.0012611937709152699
loss_pred:0.015848277136683464, decouple_loss:0.0012261491501703858
Iteration: 1287, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514559805393219, gen p mean: -0.04194825515151024, mean p set: 0.451936274766922
loss_pred:0.017076965421438217, decouple_loss:0.0014152138028293848
The modified gen p mean: 0.4502141773700714, gen p mean: -0.04401906207203865, mean p set: 0.4506944417953491The modified gen p mean: 0.45060786604881287, gen p mean: -0.03894847258925438, mean p set: 0.4510881304740906
loss_pred:0.016665218397974968, decouple_loss:0.0014112308854237199
loss_pred:0.016636114567518234, decouple_loss:0.0015583165222778916
Iteration: 1288, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45211803913116455, gen p mean: -0.03477691859006882, mean p set: 0.45259830355644226
loss_pred:0.016940627247095108, decouple_loss:0.0011723863426595926
The modified gen p mean: 0.45099908113479614, gen p mean: -0.041806966066360474, mean p set: 0.45147937536239624The modified gen p mean: 0.452873170375824, gen p mean: -0.04215378686785698, mean p set: 0.4533534646034241
loss_pred:0.016086265444755554, decouple_loss:0.0012003578012809157
loss_pred:0.01696925237774849, decouple_loss:0.0012252744054421782
Iteration: 1289, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504041075706482, gen p mean: -0.043232060968875885, mean p set: 0.4508844316005707
loss_pred:0.015875669196248055, decouple_loss:0.0014112601056694984
The modified gen p mean: 0.44963768124580383, gen p mean: -0.042997922748327255, mean p set: 0.45011797547340393The modified gen p mean: 0.4540480971336365, gen p mean: -0.03862372040748596, mean p set: 0.4545283913612366
loss_pred:0.015543203800916672, decouple_loss:0.001377326319925487
loss_pred:0.01567508652806282, decouple_loss:0.0012868329649791121
Iteration: 1290, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4533970057964325, gen p mean: -0.03769039362668991, mean p set: 0.4538773000240326
loss_pred:0.01801314763724804, decouple_loss:0.001175840967334807
The modified gen p mean: 0.45041540265083313, gen p mean: -0.03777159005403519, mean p set: 0.4508957266807556The modified gen p mean: 0.4533480405807495, gen p mean: -0.03786255419254303, mean p set: 0.4538283348083496
loss_pred:0.017176026478409767, decouple_loss:0.0011873551411554217
loss_pred:0.016052022576332092, decouple_loss:0.0013174555497244
2023-05-01 03:13:57 testing...
The modified gen p mean: 0.44987666606903076, gen p mean: -0.044985972344875336, mean p set: 0.45035696029663086
The modified gen p mean: 0.4497888684272766, gen p mean: -0.04873405396938324, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04493064433336258, mean p set: 0.4500633478164673
loss_pred:0.017403429374098778, decouple_loss:0.0013619473902508616
loss_pred:0.0184660442173481, decouple_loss:0.0014064639108255506
loss_pred:0.017573248594999313, decouple_loss:0.001354504725895822
WV_0_PC_1_EH_0_PS_40, loss: 0.017882956191897392, avg_mse: 0.025649691000580788
current test mse: 0.02565
Iteration: 1291, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4521729052066803, gen p mean: -0.041312169283628464, mean p set: 0.452653169631958
The modified gen p mean: 0.45206934213638306, gen p mean: -0.03695973753929138, mean p set: 0.45254963636398315
The modified gen p mean: 0.45257753133773804, gen p mean: -0.039149221032857895, mean p set: 0.4530578553676605
loss_pred:0.017634738236665726, decouple_loss:0.001422438770532608
loss_pred:0.017338356003165245, decouple_loss:0.0011792705627158284
loss_pred:0.017417609691619873, decouple_loss:0.0013431578408926725
Iteration: 1292, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4527311623096466, gen p mean: -0.036742035299539566, mean p set: 0.4532114863395691
loss_pred:0.01673838496208191, decouple_loss:0.001168046030215919
The modified gen p mean: 0.45238861441612244, gen p mean: -0.03517679497599602, mean p set: 0.45286890864372253The modified gen p mean: 0.45496630668640137, gen p mean: -0.03881648927927017, mean p set: 0.45544660091400146
loss_pred:0.016413381323218346, decouple_loss:0.0012560832547023892
loss_pred:0.01857917010784149, decouple_loss:0.0013690178748220205
Iteration: 1293, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507194459438324, gen p mean: -0.03645763546228409, mean p set: 0.4511997699737549
loss_pred:0.016103871166706085, decouple_loss:0.0011260509490966797
The modified gen p mean: 0.4519626498222351, gen p mean: -0.03563841059803963, mean p set: 0.4524429440498352The modified gen p mean: 0.45113590359687805, gen p mean: -0.03787975758314133, mean p set: 0.45161619782447815
loss_pred:0.01630217209458351, decouple_loss:0.0011601790320128202
loss_pred:0.017071962356567383, decouple_loss:0.0012225600657984614
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012001_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012001_3_24hr.npz
NaN value num: 0
Iteration: 1294, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44812074303627014, gen p mean: -0.042840782552957535, mean p set: 0.44860100746154785
loss_pred:0.015090729109942913, decouple_loss:0.0013579291990026832
The modified gen p mean: 0.44738903641700745, gen p mean: -0.044495731592178345, mean p set: 0.44786933064460754The modified gen p mean: 0.4466235935688019, gen p mean: -0.048592474311590195, mean p set: 0.4471038579940796
loss_pred:0.015151391737163067, decouple_loss:0.0014809195417910814
loss_pred:0.015801869332790375, decouple_loss:0.0016215068753808737
Iteration: 1295, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44818082451820374, gen p mean: -0.052496280521154404, mean p set: 0.4486611485481262
loss_pred:0.014812975190579891, decouple_loss:0.001369035104289651
The modified gen p mean: 0.446856826543808, gen p mean: -0.05103499814867973, mean p set: 0.4473371207714081The modified gen p mean: 0.4471665024757385, gen p mean: -0.049879010766744614, mean p set: 0.44764676690101624
loss_pred:0.015109846368432045, decouple_loss:0.0013049773406237364
loss_pred:0.014136247336864471, decouple_loss:0.0014061825349926949
Iteration: 1296, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478079080581665, gen p mean: -0.053342949599027634, mean p set: 0.4482881724834442
loss_pred:0.014310083352029324, decouple_loss:0.0013577230274677277
The modified gen p mean: 0.448147714138031, gen p mean: -0.052130311727523804, mean p set: 0.4486280083656311The modified gen p mean: 0.44665178656578064, gen p mean: -0.0548713281750679, mean p set: 0.44713205099105835
loss_pred:0.014512625522911549, decouple_loss:0.0015457726549357176
loss_pred:0.01456026267260313, decouple_loss:0.0015029829228296876
Iteration: 1297, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471668303012848, gen p mean: -0.04486754909157753, mean p set: 0.4476470947265625
loss_pred:0.014455386437475681, decouple_loss:0.0014426371781155467
The modified gen p mean: 0.4473174214363098, gen p mean: -0.047146350145339966, mean p set: 0.4477977156639099The modified gen p mean: 0.44695714116096497, gen p mean: -0.053665053099393845, mean p set: 0.44743743538856506
loss_pred:0.014488904736936092, decouple_loss:0.0016898325411602855
loss_pred:0.014056285843253136, decouple_loss:0.0014079235261306167
Iteration: 1298, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44640475511550903, gen p mean: -0.04240328446030617, mean p set: 0.44688504934310913
loss_pred:0.014157483354210854, decouple_loss:0.0012544931378215551
The modified gen p mean: 0.446893572807312, gen p mean: -0.052322156727313995, mean p set: 0.4473738372325897The modified gen p mean: 0.4474722146987915, gen p mean: -0.04865095764398575, mean p set: 0.4479525089263916
loss_pred:0.013509783893823624, decouple_loss:0.0012810624903067946
loss_pred:0.014004198834300041, decouple_loss:0.001325032557360828
Iteration: 1299, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482123553752899, gen p mean: -0.04027700051665306, mean p set: 0.44869264960289
loss_pred:0.014216079376637936, decouple_loss:0.0013757151318714023
The modified gen p mean: 0.4467073082923889, gen p mean: -0.04826701804995537, mean p set: 0.4471876323223114The modified gen p mean: 0.44737741351127625, gen p mean: -0.04683534428477287, mean p set: 0.44785767793655396
loss_pred:0.01441383920609951, decouple_loss:0.0014154083328321576
loss_pred:0.014599155634641647, decouple_loss:0.001434884499758482
Iteration: 1300, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44717469811439514, gen p mean: -0.04519816115498543, mean p set: 0.44765499234199524
loss_pred:0.014012712985277176, decouple_loss:0.0013844487257301807
The modified gen p mean: 0.4469364881515503, gen p mean: -0.03940756246447563, mean p set: 0.447416752576828The modified gen p mean: 0.4476989805698395, gen p mean: -0.04077758267521858, mean p set: 0.44817930459976196
loss_pred:0.014250395819544792, decouple_loss:0.0015404931036755443
loss_pred:0.014035826548933983, decouple_loss:0.0014334062580019236
2023-05-01 03:16:29 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.04618460312485695, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04252888634800911, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04223623871803284, mean p set: 0.4500633478164673
loss_pred:0.01936330832540989, decouple_loss:0.0014494028873741627
loss_pred:0.01833724044263363, decouple_loss:0.0014663462061434984
loss_pred:0.018439199775457382, decouple_loss:0.001420845976099372
WV_0_PC_1_EH_0_PS_40, loss: 0.018785526975989342, avg_mse: 0.027385888621211052
current test mse: 0.027386
Iteration: 1301, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472956955432892, gen p mean: -0.0410725437104702, mean p set: 0.4477759599685669
The modified gen p mean: 0.4467913806438446, gen p mean: -0.044103991240262985, mean p set: 0.4472716748714447
The modified gen p mean: 0.44784802198410034, gen p mean: -0.042252589017152786, mean p set: 0.44832831621170044
loss_pred:0.014128518290817738, decouple_loss:0.0014343042857944965
loss_pred:0.014167141169309616, decouple_loss:0.001450529438443482
loss_pred:0.014248841442167759, decouple_loss:0.0015162969939410686
Iteration: 1302, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44614535570144653, gen p mean: -0.051434580236673355, mean p set: 0.44662564992904663
loss_pred:0.014127356931567192, decouple_loss:0.0015212371945381165
The modified gen p mean: 0.4465309977531433, gen p mean: -0.044029269367456436, mean p set: 0.4470112919807434The modified gen p mean: 0.4460698366165161, gen p mean: -0.04990940913558006, mean p set: 0.4465501010417938
loss_pred:0.014018982648849487, decouple_loss:0.0015610200352966785
loss_pred:0.013372396118938923, decouple_loss:0.0015588951064273715
Iteration: 1303, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44814738631248474, gen p mean: -0.04024181514978409, mean p set: 0.44862768054008484
loss_pred:0.01371779665350914, decouple_loss:0.0013982412638142705
The modified gen p mean: 0.4474543333053589, gen p mean: -0.048495814204216, mean p set: 0.447934627532959The modified gen p mean: 0.44703611731529236, gen p mean: -0.04768647253513336, mean p set: 0.44751641154289246
loss_pred:0.014097489416599274, decouple_loss:0.0014207442291080952
loss_pred:0.013475731946527958, decouple_loss:0.001478404039517045
Iteration: 1304, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446953147649765, gen p mean: -0.04834171012043953, mean p set: 0.4474334716796875
loss_pred:0.013867090456187725, decouple_loss:0.0013820176245644689
The modified gen p mean: 0.44766607880592346, gen p mean: -0.04395287111401558, mean p set: 0.44814640283584595The modified gen p mean: 0.4472036063671112, gen p mean: -0.04658703878521919, mean p set: 0.4476839005947113
loss_pred:0.014077159576117992, decouple_loss:0.001442412380129099
loss_pred:0.013155965134501457, decouple_loss:0.0015265868278220296
Iteration: 1305, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466308057308197, gen p mean: -0.052731163799762726, mean p set: 0.4471111297607422
loss_pred:0.013378782197833061, decouple_loss:0.0013847935479134321
The modified gen p mean: 0.44753625988960266, gen p mean: -0.043415606021881104, mean p set: 0.44801655411720276The modified gen p mean: 0.44691500067710876, gen p mean: -0.048731107264757156, mean p set: 0.44739529490470886
loss_pred:0.013274469412863255, decouple_loss:0.0013343070168048143
loss_pred:0.013035331852734089, decouple_loss:0.0013044322840869427
Iteration: 1306, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473952353000641, gen p mean: -0.04671870172023773, mean p set: 0.4478755593299866
loss_pred:0.013798047788441181, decouple_loss:0.001352629391476512
The modified gen p mean: 0.4470263421535492, gen p mean: -0.043683990836143494, mean p set: 0.4475066065788269The modified gen p mean: 0.44794782996177673, gen p mean: -0.04289310798048973, mean p set: 0.44842812418937683
loss_pred:0.013721928000450134, decouple_loss:0.0013208428863435984
loss_pred:0.013058905489742756, decouple_loss:0.0013437746092677116
Iteration: 1307, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466247856616974, gen p mean: -0.03742007911205292, mean p set: 0.4471050798892975
loss_pred:0.0135234035551548, decouple_loss:0.0012405988527461886
The modified gen p mean: 0.44660329818725586, gen p mean: -0.04273691773414612, mean p set: 0.44708362221717834
The modified gen p mean: 0.44840213656425476, gen p mean: -0.03735223412513733, mean p set: 0.44888240098953247
loss_pred:0.013647432439029217, decouple_loss:0.0012039452558383346
loss_pred:0.013731798157095909, decouple_loss:0.0014466536231338978
Iteration: 1308, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44755247235298157, gen p mean: -0.04568738117814064, mean p set: 0.4480327367782593
loss_pred:0.013567655347287655, decouple_loss:0.001389301149174571
The modified gen p mean: 0.44609716534614563, gen p mean: -0.043712202459573746, mean p set: 0.4465774595737457The modified gen p mean: 0.44684135913848877, gen p mean: -0.041039008647203445, mean p set: 0.44732168316841125
loss_pred:0.014105799607932568, decouple_loss:0.0012058975407853723
loss_pred:0.013402746990323067, decouple_loss:0.001292502274736762
Iteration: 1309, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480387568473816, gen p mean: -0.04463688284158707, mean p set: 0.4485190510749817
loss_pred:0.013975565321743488, decouple_loss:0.0012753449846059084
The modified gen p mean: 0.4472768306732178, gen p mean: -0.03956450894474983, mean p set: 0.4477570950984955The modified gen p mean: 0.44667771458625793, gen p mean: -0.045042842626571655, mean p set: 0.44715800881385803
loss_pred:0.01363703515380621, decouple_loss:0.0012295934138819575
loss_pred:0.013024905696511269, decouple_loss:0.001297363662160933
Iteration: 1310, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471932649612427, gen p mean: -0.043504927307367325, mean p set: 0.4476735293865204
loss_pred:0.013822769746184349, decouple_loss:0.0012193908914923668
The modified gen p mean: 0.4482475817203522, gen p mean: -0.04213717207312584, mean p set: 0.44872787594795227The modified gen p mean: 0.44715988636016846, gen p mean: -0.042454734444618225, mean p set: 0.44764021039009094
loss_pred:0.014121163636446, decouple_loss:0.0012712024617940187
loss_pred:0.013106223195791245, decouple_loss:0.001330339116975665
2023-05-01 03:18:22 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.049572110176086426, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04619726166129112, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04606608673930168, mean p set: 0.4500633478164673
loss_pred:0.019302213564515114, decouple_loss:0.001408937736414373
loss_pred:0.018244894221425056, decouple_loss:0.001299154944717884
loss_pred:0.018360638990998268, decouple_loss:0.0013308438938111067
WV_0_PC_1_EH_0_PS_40, loss: 0.01870323158800602, avg_mse: 0.027294518426060677
current test mse: 0.027295
Iteration: 1311, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487560987472534, gen p mean: -0.047738611698150635, mean p set: 0.44923636317253113
The modified gen p mean: 0.447307288646698, gen p mean: -0.0474422350525856, mean p set: 0.4477875828742981
The modified gen p mean: 0.44669532775878906, gen p mean: -0.04815239459276199, mean p set: 0.44717565178871155
loss_pred:0.013878745026886463, decouple_loss:0.001303892582654953
loss_pred:0.013299691490828991, decouple_loss:0.0012288816506043077
loss_pred:0.01369117759168148, decouple_loss:0.0012560797622427344
Iteration: 1312, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482124447822571, gen p mean: -0.04405558109283447, mean p set: 0.4486927390098572
loss_pred:0.013264086097478867, decouple_loss:0.0014523800928145647
The modified gen p mean: 0.44720712304115295, gen p mean: -0.04625845327973366, mean p set: 0.44768741726875305The modified gen p mean: 0.4463750720024109, gen p mean: -0.05798940360546112, mean p set: 0.4468553960323334
loss_pred:0.013636729680001736, decouple_loss:0.001311943051405251
loss_pred:0.013366851955652237, decouple_loss:0.0014586267061531544
Iteration: 1313, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447295606136322, gen p mean: -0.04793554171919823, mean p set: 0.4477759003639221
The modified gen p mean: 0.4465222954750061, gen p mean: -0.05212605744600296, mean p set: 0.4470026195049286
loss_pred:0.0134891914203763, decouple_loss:0.001214445917867124
loss_pred:0.01352075394243002, decouple_loss:0.0012348443269729614
The modified gen p mean: 0.44719362258911133, gen p mean: -0.046884991228580475, mean p set: 0.4476739168167114
loss_pred:0.013902013190090656, decouple_loss:0.001193488948047161
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012016_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012016_3_24hr.npz
NaN value num: 0
Iteration: 1314, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447444349527359, gen p mean: -0.04960496351122856, mean p set: 0.4479246735572815
loss_pred:0.019153201952576637, decouple_loss:0.0015185854863375425
The modified gen p mean: 0.4465150833129883, gen p mean: -0.05012573301792145, mean p set: 0.4469953775405884The modified gen p mean: 0.44818708300590515, gen p mean: -0.048593513667583466, mean p set: 0.44866740703582764
loss_pred:0.01938636228442192, decouple_loss:0.0014127629110589623
loss_pred:0.01814524084329605, decouple_loss:0.0014662450412288308
Iteration: 1315, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470826983451843, gen p mean: -0.05029691755771637, mean p set: 0.4475629925727844
loss_pred:0.017881127074360847, decouple_loss:0.0014504971913993359
The modified gen p mean: 0.44731447100639343, gen p mean: -0.046519383788108826, mean p set: 0.44779476523399353The modified gen p mean: 0.4483150541782379, gen p mean: -0.046617381274700165, mean p set: 0.448795348405838
loss_pred:0.01712959259748459, decouple_loss:0.0015698997303843498
loss_pred:0.01786772347986698, decouple_loss:0.0013722280273213983
Iteration: 1316, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468609094619751, gen p mean: -0.051457252353429794, mean p set: 0.4473411440849304
The modified gen p mean: 0.4474761188030243, gen p mean: -0.0505099855363369, mean p set: 0.4479564428329468loss_pred:0.01813504286110401, decouple_loss:0.0013476961757987738
The modified gen p mean: 0.44716793298721313, gen p mean: -0.05218144506216049, mean p set: 0.44764822721481323
loss_pred:0.018647657707333565, decouple_loss:0.001400099485181272
loss_pred:0.017975030466914177, decouple_loss:0.0013827263610437512
Iteration: 1317, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44712480902671814, gen p mean: -0.054071709513664246, mean p set: 0.44760507345199585
The modified gen p mean: 0.4461888074874878, gen p mean: -0.056094661355018616, mean p set: 0.4466691315174103
loss_pred:0.016914982348680496, decouple_loss:0.0014162901788949966
loss_pred:0.01840336248278618, decouple_loss:0.001500063226558268
The modified gen p mean: 0.44771137833595276, gen p mean: -0.053546249866485596, mean p set: 0.44819167256355286
loss_pred:0.018451988697052002, decouple_loss:0.0015117537695914507
Iteration: 1318, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44613587856292725, gen p mean: -0.059191297739744186, mean p set: 0.44661614298820496
The modified gen p mean: 0.4476653039455414, gen p mean: -0.05951792001724243, mean p set: 0.4481455683708191
loss_pred:0.01863700896501541, decouple_loss:0.0014670535456389189
loss_pred:0.01848113164305687, decouple_loss:0.0016607792349532247
The modified gen p mean: 0.44829297065734863, gen p mean: -0.053979482501745224, mean p set: 0.44877323508262634
loss_pred:0.01795262098312378, decouple_loss:0.0016186763532459736
Iteration: 1319, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44564110040664673, gen p mean: -0.062308307737112045, mean p set: 0.44612136483192444
loss_pred:0.018258707597851753, decouple_loss:0.001706817769445479
The modified gen p mean: 0.4464946985244751, gen p mean: -0.05886314436793327, mean p set: 0.4469749927520752The modified gen p mean: 0.44908756017684937, gen p mean: -0.05778162181377411, mean p set: 0.44956785440444946
loss_pred:0.01847458817064762, decouple_loss:0.001618706388399005
loss_pred:0.017970630899071693, decouple_loss:0.0015264438698068261
Iteration: 1320, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44929268956184387, gen p mean: -0.06031346693634987, mean p set: 0.44977301359176636
The modified gen p mean: 0.4483351409435272, gen p mean: -0.060740675777196884, mean p set: 0.44881540536880493
loss_pred:0.01779230125248432, decouple_loss:0.0013745761243626475
loss_pred:0.017813410609960556, decouple_loss:0.0014011809835210443
The modified gen p mean: 0.4484826624393463, gen p mean: -0.060812417417764664, mean p set: 0.448962926864624
loss_pred:0.01808115281164646, decouple_loss:0.0013629905879497528
2023-05-01 03:20:58 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.060634493827819824, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.056946348398923874, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.05715680122375488, mean p set: 0.4500633478164673
loss_pred:0.018453411757946014, decouple_loss:0.0014172113733366132
loss_pred:0.017489084973931313, decouple_loss:0.001342609990388155
loss_pred:0.017566373571753502, decouple_loss:0.001373831182718277
WV_0_PC_1_EH_0_PS_40, loss: 0.017905184999108315, avg_mse: 0.025699689984321594
current test mse: 0.0257
Iteration: 1321, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474298655986786, gen p mean: -0.06304475665092468, mean p set: 0.4479101598262787
The modified gen p mean: 0.4470779597759247, gen p mean: -0.06040411442518234, mean p set: 0.4475582540035248
The modified gen p mean: 0.44587668776512146, gen p mean: -0.05931101739406586, mean p set: 0.44635701179504395
loss_pred:0.01804877072572708, decouple_loss:0.0014323031064122915
loss_pred:0.01845906674861908, decouple_loss:0.0014347528340294957
loss_pred:0.018452730029821396, decouple_loss:0.0014398529892787337
Iteration: 1322, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448380708694458, gen p mean: -0.06108348071575165, mean p set: 0.4488610029220581
loss_pred:0.018587391823530197, decouple_loss:0.0013504551025107503
The modified gen p mean: 0.4467546045780182, gen p mean: -0.0607718750834465, mean p set: 0.4472349286079407The modified gen p mean: 0.4474543035030365, gen p mean: -0.05714358016848564, mean p set: 0.4479345977306366
loss_pred:0.01801469549536705, decouple_loss:0.0012761619873344898
loss_pred:0.017854291945695877, decouple_loss:0.001392684644088149
Iteration: 1323, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44838374853134155, gen p mean: -0.053521428257226944, mean p set: 0.44886404275894165
loss_pred:0.018029242753982544, decouple_loss:0.0012961631873622537
The modified gen p mean: 0.44696423411369324, gen p mean: -0.058281075209379196, mean p set: 0.44744452834129333
The modified gen p mean: 0.4488820433616638, gen p mean: -0.05708971247076988, mean p set: 0.4493623375892639
loss_pred:0.01750275120139122, decouple_loss:0.0012849848717451096
loss_pred:0.017818430438637733, decouple_loss:0.0013607381843030453
Iteration: 1324, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44815248250961304, gen p mean: -0.06164736673235893, mean p set: 0.44863274693489075
loss_pred:0.017635270953178406, decouple_loss:0.0012575412401929498
The modified gen p mean: 0.44649913907051086, gen p mean: -0.06544342637062073, mean p set: 0.44697946310043335The modified gen p mean: 0.4473735988140106, gen p mean: -0.06207413226366043, mean p set: 0.4478538930416107
loss_pred:0.01734636351466179, decouple_loss:0.0014536874368786812
loss_pred:0.018034880980849266, decouple_loss:0.0012725323904305696
Iteration: 1325, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469808340072632, gen p mean: -0.05816688388586044, mean p set: 0.4474611282348633
loss_pred:0.017085162922739983, decouple_loss:0.0013428269885480404
The modified gen p mean: 0.44723373651504517, gen p mean: -0.060774847865104675, mean p set: 0.44771403074264526The modified gen p mean: 0.44745978713035583, gen p mean: -0.06404221802949905, mean p set: 0.4479401111602783
loss_pred:0.017819222062826157, decouple_loss:0.0012963354820385575
loss_pred:0.018478481099009514, decouple_loss:0.001216001226566732
Iteration: 1326, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472741186618805, gen p mean: -0.06568533182144165, mean p set: 0.4477544128894806
loss_pred:0.018026631325483322, decouple_loss:0.0014340629568323493
The modified gen p mean: 0.4475539028644562, gen p mean: -0.061663053929805756, mean p set: 0.4480341970920563The modified gen p mean: 0.44809791445732117, gen p mean: -0.06076541543006897, mean p set: 0.44857820868492126
loss_pred:0.01885121874511242, decouple_loss:0.001403647125698626
loss_pred:0.017612094059586525, decouple_loss:0.0014362008078023791
Iteration: 1327, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480666518211365, gen p mean: -0.06031878665089607, mean p set: 0.44854697585105896
loss_pred:0.017971841618418694, decouple_loss:0.0013689663028344512
The modified gen p mean: 0.4470103681087494, gen p mean: -0.05867990478873253, mean p set: 0.4474906623363495The modified gen p mean: 0.4475862979888916, gen p mean: -0.05727659538388252, mean p set: 0.4480665326118469
loss_pred:0.016449294984340668, decouple_loss:0.0012442185543477535
loss_pred:0.016880406066775322, decouple_loss:0.00124264950864017
Iteration: 1328, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44814085960388184, gen p mean: -0.05772988125681877, mean p set: 0.44862115383148193
loss_pred:0.017717907205224037, decouple_loss:0.001488217618316412
The modified gen p mean: 0.4475901424884796, gen p mean: -0.06247449293732643, mean p set: 0.4480704367160797The modified gen p mean: 0.4467078745365143, gen p mean: -0.06152604892849922, mean p set: 0.4471881687641144
loss_pred:0.017179304733872414, decouple_loss:0.0013078345218673348
loss_pred:0.017936019226908684, decouple_loss:0.001401280052959919
Iteration: 1329, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447206974029541, gen p mean: -0.06036572530865669, mean p set: 0.4476872384548187
loss_pred:0.017595818266272545, decouple_loss:0.0013501291396096349
The modified gen p mean: 0.4465456008911133, gen p mean: -0.06041266396641731, mean p set: 0.447025865316391The modified gen p mean: 0.44669753313064575, gen p mean: -0.06074294447898865, mean p set: 0.44717782735824585
loss_pred:0.01664864271879196, decouple_loss:0.0013384829508140683
loss_pred:0.017069710418581963, decouple_loss:0.0012780068209394813
Iteration: 1330, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44743454456329346, gen p mean: -0.060968492180109024, mean p set: 0.44791483879089355
loss_pred:0.0184780303388834, decouple_loss:0.0012405992019921541
The modified gen p mean: 0.4487350285053253, gen p mean: -0.06245682016015053, mean p set: 0.4492153227329254The modified gen p mean: 0.44831234216690063, gen p mean: -0.05442628636956215, mean p set: 0.44879260659217834
loss_pred:0.01808915287256241, decouple_loss:0.0012218070914968848
loss_pred:0.017803028225898743, decouple_loss:0.0013467560056596994
2023-05-01 03:22:51 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.06324785202741623, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.05912063643336296, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.05960388109087944, mean p set: 0.4500633478164673
loss_pred:0.01833323761820793, decouple_loss:0.0014059667009860277
loss_pred:0.017355576157569885, decouple_loss:0.0013577607460319996
loss_pred:0.0175038930028677, decouple_loss:0.0013374631525948644
WV_0_PC_1_EH_0_PS_40, loss: 0.01779925636947155, avg_mse: 0.02551443874835968
current test mse: 0.025514
Iteration: 1331, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44708651304244995, gen p mean: -0.05976267531514168, mean p set: 0.44756677746772766
The modified gen p mean: 0.4478066861629486, gen p mean: -0.0585564523935318, mean p set: 0.4482869803905487
The modified gen p mean: 0.4472391903400421, gen p mean: -0.06253316253423691, mean p set: 0.4477194845676422
loss_pred:0.01705741509795189, decouple_loss:0.0014427792048081756
loss_pred:0.017829157412052155, decouple_loss:0.001385060022585094loss_pred:0.017556045204401016, decouple_loss:0.001405793591402471
Iteration: 1332, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4461660385131836, gen p mean: -0.05967774614691734, mean p set: 0.4466463625431061
loss_pred:0.01832832396030426, decouple_loss:0.0013191871112212539
The modified gen p mean: 0.4455741345882416, gen p mean: -0.0599246509373188, mean p set: 0.4460543990135193The modified gen p mean: 0.4466773569583893, gen p mean: -0.061475325375795364, mean p set: 0.4471576511859894
loss_pred:0.017723165452480316, decouple_loss:0.0012568999081850052
loss_pred:0.018031597137451172, decouple_loss:0.0013340445002540946
Iteration: 1333, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476057291030884, gen p mean: -0.06172976270318031, mean p set: 0.44808605313301086
loss_pred:0.018087508156895638, decouple_loss:0.001514446223154664
The modified gen p mean: 0.44718053936958313, gen p mean: -0.056447889655828476, mean p set: 0.4476608335971832
The modified gen p mean: 0.4470619261264801, gen p mean: -0.059698428958654404, mean p set: 0.4475422501564026
loss_pred:0.016489071771502495, decouple_loss:0.0012580918846651912
loss_pred:0.017816634848713875, decouple_loss:0.0012197105679661036
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012006_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012006_3_24hr.npz
NaN value num: 0
Iteration: 1334, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4539056420326233, gen p mean: -0.06060880795121193, mean p set: 0.4543859660625458
loss_pred:0.016367295756936073, decouple_loss:0.0011680185561999679
The modified gen p mean: 0.451323926448822, gen p mean: -0.056411609053611755, mean p set: 0.4518042206764221The modified gen p mean: 0.4529622793197632, gen p mean: -0.05654588341712952, mean p set: 0.4534425735473633
loss_pred:0.016446519643068314, decouple_loss:0.0012345355935394764
loss_pred:0.016875537112355232, decouple_loss:0.0012931657256558537
Iteration: 1335, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45206886529922485, gen p mean: -0.05462577939033508, mean p set: 0.45254912972450256
The modified gen p mean: 0.4500974416732788, gen p mean: -0.06059841811656952, mean p set: 0.4505777657032013
loss_pred:0.016603605821728706, decouple_loss:0.0014077540254220366
loss_pred:0.01692936196923256, decouple_loss:0.0013127323472872376
The modified gen p mean: 0.4528324604034424, gen p mean: -0.052457235753536224, mean p set: 0.4533127248287201
loss_pred:0.016660120338201523, decouple_loss:0.001624616445042193
Iteration: 1336, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493550658226013, gen p mean: -0.05611719191074371, mean p set: 0.4498353600502014
loss_pred:0.017198747023940086, decouple_loss:0.0013901067432016134
The modified gen p mean: 0.45566436648368835, gen p mean: -0.054884493350982666, mean p set: 0.45614469051361084The modified gen p mean: 0.45203670859336853, gen p mean: -0.04851836338639259, mean p set: 0.452517032623291
loss_pred:0.01637420989573002, decouple_loss:0.0013770970981568098
loss_pred:0.016773272305727005, decouple_loss:0.001306399586610496
Iteration: 1337, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45280522108078003, gen p mean: -0.056893832981586456, mean p set: 0.45328548550605774
The modified gen p mean: 0.452595055103302, gen p mean: -0.0521254763007164, mean p set: 0.4530753493309021
loss_pred:0.01675538159906864, decouple_loss:0.001271007931791246
The modified gen p mean: 0.45141032338142395, gen p mean: -0.05606016144156456, mean p set: 0.45189061760902405
loss_pred:0.0167930256575346, decouple_loss:0.0011992022627964616
loss_pred:0.016587231308221817, decouple_loss:0.0013626550789922476
Iteration: 1338, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4524964988231659, gen p mean: -0.046698205173015594, mean p set: 0.452976793050766
The modified gen p mean: 0.4527682662010193, gen p mean: -0.052362751215696335, mean p set: 0.4532485604286194
loss_pred:0.016895750537514687, decouple_loss:0.0012267157435417175
loss_pred:0.017426958307623863, decouple_loss:0.0013173919869586825
The modified gen p mean: 0.45109182596206665, gen p mean: -0.05112411454319954, mean p set: 0.45157214999198914
loss_pred:0.016929866746068, decouple_loss:0.0013243004214018583
Iteration: 1339, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4523853361606598, gen p mean: -0.04142091050744057, mean p set: 0.4528656601905823
loss_pred:0.01669798232614994, decouple_loss:0.001208419562317431
The modified gen p mean: 0.45029473304748535, gen p mean: -0.051140520721673965, mean p set: 0.45077502727508545The modified gen p mean: 0.4518226385116577, gen p mean: -0.05047328770160675, mean p set: 0.4523029327392578
loss_pred:0.01722426526248455, decouple_loss:0.0011995842214673758
loss_pred:0.0165946613997221, decouple_loss:0.0011575156822800636
Iteration: 1340, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45286643505096436, gen p mean: -0.04565058648586273, mean p set: 0.45334672927856445
The modified gen p mean: 0.45221641659736633, gen p mean: -0.04638725519180298, mean p set: 0.45269668102264404
loss_pred:0.017064813524484634, decouple_loss:0.0011944934958592057
loss_pred:0.016584092751145363, decouple_loss:0.0011658616131171584
The modified gen p mean: 0.4525321125984192, gen p mean: -0.05092490836977959, mean p set: 0.4530124366283417
loss_pred:0.016233094036579132, decouple_loss:0.001464278670027852
2023-05-01 03:25:26 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.047260161489248276, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04323483258485794, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.04340055584907532, mean p set: 0.4500633478164673
loss_pred:0.018411878496408463, decouple_loss:0.0012052305974066257loss_pred:0.01734188385307789, decouple_loss:0.0012600002810359001
loss_pred:0.017535319551825523, decouple_loss:0.001225528190843761
WV_0_PC_1_EH_0_PS_40, loss: 0.01782454177737236, avg_mse: 0.025548774749040604
current test mse: 0.025549
Iteration: 1341, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45154979825019836, gen p mean: -0.0447709895670414, mean p set: 0.45203009247779846
The modified gen p mean: 0.45025011897087097, gen p mean: -0.044895973056554794, mean p set: 0.45073044300079346
The modified gen p mean: 0.4530589282512665, gen p mean: -0.046689458191394806, mean p set: 0.45353925228118896
loss_pred:0.016285007819533348, decouple_loss:0.0012630521086975932
loss_pred:0.01632135547697544, decouple_loss:0.001135302591137588
loss_pred:0.016958529129624367, decouple_loss:0.0011187545023858547
Iteration: 1342, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45203450322151184, gen p mean: -0.04694267734885216, mean p set: 0.45251479744911194
loss_pred:0.016605069860816002, decouple_loss:0.00119186588563025
The modified gen p mean: 0.45303037762641907, gen p mean: -0.03852546215057373, mean p set: 0.45351067185401917The modified gen p mean: 0.4534645974636078, gen p mean: -0.043876681476831436, mean p set: 0.4539449214935303
loss_pred:0.016520803794264793, decouple_loss:0.0012282263487577438
loss_pred:0.016496995463967323, decouple_loss:0.001294703222811222
Iteration: 1343, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44957488775253296, gen p mean: -0.04614632576704025, mean p set: 0.45005518198013306
The modified gen p mean: 0.4523267447948456, gen p mean: -0.04386686161160469, mean p set: 0.4528070092201233
loss_pred:0.01665256731212139, decouple_loss:0.0012137644225731492
loss_pred:0.01650276593863964, decouple_loss:0.0011696524452418089
The modified gen p mean: 0.45132339000701904, gen p mean: -0.04372150078415871, mean p set: 0.45180368423461914
loss_pred:0.016376378014683723, decouple_loss:0.0012339706299826503
Iteration: 1344, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.451680064201355, gen p mean: -0.04550641402602196, mean p set: 0.4521603584289551
loss_pred:0.016574950888752937, decouple_loss:0.0012447605840861797
The modified gen p mean: 0.45300841331481934, gen p mean: -0.04323133826255798, mean p set: 0.45348870754241943The modified gen p mean: 0.4524695873260498, gen p mean: -0.05243423581123352, mean p set: 0.4529498815536499
loss_pred:0.01647646725177765, decouple_loss:0.0012084250338375568
loss_pred:0.015952114015817642, decouple_loss:0.0013499821070581675
Iteration: 1345, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4509139657020569, gen p mean: -0.04034656658768654, mean p set: 0.451394259929657
loss_pred:0.016558587551116943, decouple_loss:0.0011444668052718043
The modified gen p mean: 0.45258426666259766, gen p mean: -0.04296227917075157, mean p set: 0.45306456089019775The modified gen p mean: 0.4512932002544403, gen p mean: -0.049066439270973206, mean p set: 0.451773464679718
loss_pred:0.01663070358335972, decouple_loss:0.0011809017742052674
loss_pred:0.01694440096616745, decouple_loss:0.0010998803190886974
Iteration: 1346, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45246604084968567, gen p mean: -0.03249365836381912, mean p set: 0.45294633507728577
loss_pred:0.016719933599233627, decouple_loss:0.0012718401849269867
The modified gen p mean: 0.4525904655456543, gen p mean: -0.04961346834897995, mean p set: 0.453070729970932The modified gen p mean: 0.4507061243057251, gen p mean: -0.045629117637872696, mean p set: 0.4511864483356476
loss_pred:0.01716117560863495, decouple_loss:0.0012456263648346066
loss_pred:0.016233190894126892, decouple_loss:0.0014421507949009538
Iteration: 1347, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45142704248428345, gen p mean: -0.04173086956143379, mean p set: 0.45190730690956116
loss_pred:0.016532955691218376, decouple_loss:0.001212812727317214
The modified gen p mean: 0.45179104804992676, gen p mean: -0.040675606578588486, mean p set: 0.45227131247520447The modified gen p mean: 0.45311006903648376, gen p mean: -0.04304295405745506, mean p set: 0.45359036326408386
loss_pred:0.017237676307559013, decouple_loss:0.0011679558083415031
loss_pred:0.016323724761605263, decouple_loss:0.0012383279390633106
Iteration: 1348, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4509826600551605, gen p mean: -0.03912852331995964, mean p set: 0.4514629542827606
loss_pred:0.016459284350275993, decouple_loss:0.0013946628896519542
The modified gen p mean: 0.45167723298072815, gen p mean: -0.04316416382789612, mean p set: 0.45215752720832825The modified gen p mean: 0.4538275897502899, gen p mean: -0.03856046497821808, mean p set: 0.4543078541755676
loss_pred:0.016674518585205078, decouple_loss:0.0014098936226218939
loss_pred:0.0165481586009264, decouple_loss:0.0013968246057629585
Iteration: 1349, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508593678474426, gen p mean: -0.04384666681289673, mean p set: 0.45133963227272034
loss_pred:0.01660347916185856, decouple_loss:0.001294005080126226
The modified gen p mean: 0.44968923926353455, gen p mean: -0.046558018773794174, mean p set: 0.45016953349113464The modified gen p mean: 0.4547361135482788, gen p mean: -0.04065033420920372, mean p set: 0.4552163779735565
loss_pred:0.01662635989487171, decouple_loss:0.0012114146957173944
loss_pred:0.01655317097902298, decouple_loss:0.0012168961111456156
Iteration: 1350, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45488834381103516, gen p mean: -0.04340357333421707, mean p set: 0.45536860823631287
loss_pred:0.01591617241501808, decouple_loss:0.0011927041923627257
The modified gen p mean: 0.4523903429508209, gen p mean: -0.04574260115623474, mean p set: 0.452870637178421The modified gen p mean: 0.4508713483810425, gen p mean: -0.04496315121650696, mean p set: 0.4513516426086426
loss_pred:0.017230797559022903, decouple_loss:0.0012240150244906545
loss_pred:0.01647280901670456, decouple_loss:0.0011893522460013628
2023-05-01 03:27:20 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.04871674254536629, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.044565390795469284, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830237865448, gen p mean: -0.044900450855493546, mean p set: 0.4500633478164673
loss_pred:0.018381575122475624, decouple_loss:0.0012800043914467096
loss_pred:0.017386537045240402, decouple_loss:0.0013138947542756796
loss_pred:0.017517220228910446, decouple_loss:0.0013818934094160795
WV_0_PC_1_EH_0_PS_40, loss: 0.017828039824962616, avg_mse: 0.025589177384972572
current test mse: 0.025589
Iteration: 1351, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4521898925304413, gen p mean: -0.03574362397193909, mean p set: 0.45267021656036377
The modified gen p mean: 0.4527053236961365, gen p mean: -0.04891062527894974, mean p set: 0.4531856179237366
The modified gen p mean: 0.4513205289840698, gen p mean: -0.0468829981982708, mean p set: 0.4518008232116699
loss_pred:0.016283774748444557, decouple_loss:0.0012999685714021325
loss_pred:0.01660018041729927, decouple_loss:0.0013035907177254558
loss_pred:0.01609019748866558, decouple_loss:0.0013303924351930618
Iteration: 1352, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4524969458580017, gen p mean: -0.043110836297273636, mean p set: 0.4529772400856018
loss_pred:0.016423169523477554, decouple_loss:0.0010861493647098541
The modified gen p mean: 0.45100733637809753, gen p mean: -0.05050855875015259, mean p set: 0.45148760080337524The modified gen p mean: 0.45163533091545105, gen p mean: -0.04357829689979553, mean p set: 0.45211559534072876
loss_pred:0.01643451489508152, decouple_loss:0.001149639836512506
loss_pred:0.016600240021944046, decouple_loss:0.0010416943114250898
Iteration: 1353, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4521520137786865, gen p mean: -0.03911872208118439, mean p set: 0.4526323080062866
loss_pred:0.016500195488333702, decouple_loss:0.0012202683137729764
The modified gen p mean: 0.45037293434143066, gen p mean: -0.046379346400499344, mean p set: 0.45085322856903076The modified gen p mean: 0.45077621936798096, gen p mean: -0.04310539737343788, mean p set: 0.45125651359558105
loss_pred:0.017256610095500946, decouple_loss:0.0012496240669861436
loss_pred:0.015958478674292564, decouple_loss:0.0014618386048823595
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012003_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012003_3_24hr.npz
NaN value num: 0
Iteration: 1354, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511922299861908, gen p mean: -0.041424695402383804, mean p set: 0.4516725242137909
loss_pred:0.01747731864452362, decouple_loss:0.0011061017867177725
The modified gen p mean: 0.4498114287853241, gen p mean: -0.04325640946626663, mean p set: 0.4502916932106018The modified gen p mean: 0.4489035904407501, gen p mean: -0.0466700941324234, mean p set: 0.4493838846683502
loss_pred:0.017433641478419304, decouple_loss:0.0011482659028843045
loss_pred:0.017490273341536522, decouple_loss:0.0010689845075830817
Iteration: 1355, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44970130920410156, gen p mean: -0.03545157238841057, mean p set: 0.45018163323402405
loss_pred:0.017209181562066078, decouple_loss:0.0013610349269583821
The modified gen p mean: 0.45217227935791016, gen p mean: -0.03519122675061226, mean p set: 0.45265257358551025The modified gen p mean: 0.44949871301651, gen p mean: -0.0377180278301239, mean p set: 0.4499790072441101
loss_pred:0.016869880259037018, decouple_loss:0.001280029071494937
loss_pred:0.01728888787329197, decouple_loss:0.001198900630697608
Iteration: 1356, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44984570145606995, gen p mean: -0.03532618284225464, mean p set: 0.45032599568367004
loss_pred:0.01664000377058983, decouple_loss:0.0010781720047816634
The modified gen p mean: 0.4500858783721924, gen p mean: -0.036885809153318405, mean p set: 0.4505661725997925The modified gen p mean: 0.44873303174972534, gen p mean: -0.041259270161390305, mean p set: 0.44921332597732544
loss_pred:0.017234625294804573, decouple_loss:0.0011930350447073579
loss_pred:0.01632513292133808, decouple_loss:0.0011031810427084565
Iteration: 1357, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4526509642601013, gen p mean: -0.03977278992533684, mean p set: 0.4531312584877014
loss_pred:0.017375992611050606, decouple_loss:0.0012281895615160465
The modified gen p mean: 0.45171695947647095, gen p mean: -0.03563432767987251, mean p set: 0.45219725370407104The modified gen p mean: 0.45013394951820374, gen p mean: -0.036048825830221176, mean p set: 0.45061424374580383
loss_pred:0.01661684364080429, decouple_loss:0.0013148648431524634
loss_pred:0.01674102246761322, decouple_loss:0.0010478917974978685
Iteration: 1358, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45273956656455994, gen p mean: -0.040166351944208145, mean p set: 0.4532198905944824
loss_pred:0.017506077885627747, decouple_loss:0.0011947908205911517
The modified gen p mean: 0.44876691699028015, gen p mean: -0.04614650830626488, mean p set: 0.44924721121788025The modified gen p mean: 0.4495389461517334, gen p mean: -0.03854743391275406, mean p set: 0.4500192403793335
loss_pred:0.016667792573571205, decouple_loss:0.00123139179777354
loss_pred:0.017023254185914993, decouple_loss:0.0010700307320803404
Iteration: 1359, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503084123134613, gen p mean: -0.04507576674222946, mean p set: 0.4507887363433838
loss_pred:0.01622551493346691, decouple_loss:0.001181075000204146
The modified gen p mean: 0.4502153694629669, gen p mean: -0.04451661929488182, mean p set: 0.450695663690567The modified gen p mean: 0.4530010223388672, gen p mean: -0.04318838194012642, mean p set: 0.4534813165664673
loss_pred:0.017277739942073822, decouple_loss:0.0010998619254678488
loss_pred:0.017399489879608154, decouple_loss:0.0012544661294668913
Iteration: 1360, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4506075978279114, gen p mean: -0.046527743339538574, mean p set: 0.4510878920555115
loss_pred:0.0175748523324728, decouple_loss:0.001061980496160686
The modified gen p mean: 0.4535812437534332, gen p mean: -0.04836287349462509, mean p set: 0.45406150817871094The modified gen p mean: 0.4512633979320526, gen p mean: -0.04584132134914398, mean p set: 0.4517436623573303
loss_pred:0.016416436061263084, decouple_loss:0.0011671982938423753
loss_pred:0.01741371862590313, decouple_loss:0.0012923700269311666
2023-05-01 03:30:02 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.05304276943206787, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.048793975263834, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.04926655441522598, mean p set: 0.4500633478164673
loss_pred:0.01841207593679428, decouple_loss:0.0012136312434449792
loss_pred:0.017323432490229607, decouple_loss:0.0011582319857552648
loss_pred:0.017482049763202667, decouple_loss:0.0012026216136291623
WV_0_PC_1_EH_0_PS_40, loss: 0.017798762768507004, avg_mse: 0.02555285394191742
current test mse: 0.025553
Iteration: 1361, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44726434350013733, gen p mean: -0.05450979992747307, mean p set: 0.4477446675300598
The modified gen p mean: 0.44846272468566895, gen p mean: -0.0541982427239418, mean p set: 0.44894298911094666
The modified gen p mean: 0.451625794172287, gen p mean: -0.046309564262628555, mean p set: 0.4521060883998871
loss_pred:0.017113041132688522, decouple_loss:0.0011838048230856657
loss_pred:0.016260772943496704, decouple_loss:0.0012086947681382298
loss_pred:0.016151675954461098, decouple_loss:0.001163309090770781
Iteration: 1362, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44980499148368835, gen p mean: -0.04414574056863785, mean p set: 0.45028528571128845
The modified gen p mean: 0.4514254629611969, gen p mean: -0.04701400175690651, mean p set: 0.451905757188797
loss_pred:0.01637331023812294, decouple_loss:0.0011748389806598425
loss_pred:0.01659506745636463, decouple_loss:0.0012129588285461068
The modified gen p mean: 0.45048782229423523, gen p mean: -0.0472664050757885, mean p set: 0.45096808671951294
loss_pred:0.016431385651230812, decouple_loss:0.00117803318426013
Iteration: 1363, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44997432827949524, gen p mean: -0.04323466122150421, mean p set: 0.45045459270477295
loss_pred:0.016023654490709305, decouple_loss:0.00112344219814986
The modified gen p mean: 0.4496883749961853, gen p mean: -0.03987877815961838, mean p set: 0.4501686692237854The modified gen p mean: 0.44869184494018555, gen p mean: -0.046951983124017715, mean p set: 0.44917213916778564
loss_pred:0.016624193638563156, decouple_loss:0.0011679636081680655
loss_pred:0.016521481797099113, decouple_loss:0.0010999784572049975
Iteration: 1364, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44972240924835205, gen p mean: -0.043418411165475845, mean p set: 0.45020267367362976
The modified gen p mean: 0.45304596424102783, gen p mean: -0.045459602028131485, mean p set: 0.45352625846862793
loss_pred:0.017872389405965805, decouple_loss:0.0010402381885796785
loss_pred:0.01687876507639885, decouple_loss:0.0011016250355169177
The modified gen p mean: 0.4515535533428192, gen p mean: -0.03999224677681923, mean p set: 0.4520338773727417
loss_pred:0.01704985275864601, decouple_loss:0.001066490076482296
Iteration: 1365, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44918400049209595, gen p mean: -0.04291505739092827, mean p set: 0.44966429471969604
The modified gen p mean: 0.45316678285598755, gen p mean: -0.04273712635040283, mean p set: 0.45364704728126526
loss_pred:0.01748478226363659, decouple_loss:0.0011810327414423227
loss_pred:0.016512177884578705, decouple_loss:0.0013369083171710372
The modified gen p mean: 0.45256516337394714, gen p mean: -0.04154089093208313, mean p set: 0.45304545760154724
loss_pred:0.0169936865568161, decouple_loss:0.0012214623857289553
Iteration: 1366, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449763685464859, gen p mean: -0.05051670968532562, mean p set: 0.4502440094947815
The modified gen p mean: 0.44953402876853943, gen p mean: -0.04196373373270035, mean p set: 0.4500143229961395
loss_pred:0.017720889300107956, decouple_loss:0.0010826787911355495
loss_pred:0.01664702780544758, decouple_loss:0.0010879684705287218
The modified gen p mean: 0.44934505224227905, gen p mean: -0.04123406857252121, mean p set: 0.44982537627220154
loss_pred:0.01718929223716259, decouple_loss:0.001128512085415423
Iteration: 1367, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4527161717414856, gen p mean: -0.04104125127196312, mean p set: 0.4531964957714081
The modified gen p mean: 0.4491724371910095, gen p mean: -0.0412122942507267, mean p set: 0.4496527314186096
loss_pred:0.017135467380285263, decouple_loss:0.0012791056651622057
loss_pred:0.01712828315794468, decouple_loss:0.001343712443485856
The modified gen p mean: 0.45297864079475403, gen p mean: -0.042409513145685196, mean p set: 0.4534589648246765
loss_pred:0.01644846983253956, decouple_loss:0.0013841426698490977
Iteration: 1368, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44983574748039246, gen p mean: -0.04447275400161743, mean p set: 0.45031604170799255
loss_pred:0.017266474664211273, decouple_loss:0.0011800454230979085
The modified gen p mean: 0.4488403797149658, gen p mean: -0.046509455889463425, mean p set: 0.4493206739425659
The modified gen p mean: 0.44933873414993286, gen p mean: -0.049979258328676224, mean p set: 0.44981902837753296
loss_pred:0.01641693152487278, decouple_loss:0.0011986646568402648
loss_pred:0.016571201384067535, decouple_loss:0.0012282676761969924
Iteration: 1369, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45282161235809326, gen p mean: -0.04343051835894585, mean p set: 0.45330190658569336
The modified gen p mean: 0.4501268267631531, gen p mean: -0.05248040705919266, mean p set: 0.4506070911884308
loss_pred:0.016399206593632698, decouple_loss:0.0011909321183338761
loss_pred:0.016888367012143135, decouple_loss:0.0011927528539672494
The modified gen p mean: 0.4507034122943878, gen p mean: -0.042844463139772415, mean p set: 0.4511836767196655
loss_pred:0.017402196303009987, decouple_loss:0.001169632188975811
Iteration: 1370, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45039212703704834, gen p mean: -0.03982800245285034, mean p set: 0.45087239146232605
loss_pred:0.01693178340792656, decouple_loss:0.0012451778165996075
The modified gen p mean: 0.4498523473739624, gen p mean: -0.045592889189720154, mean p set: 0.4503326416015625The modified gen p mean: 0.44992244243621826, gen p mean: -0.04164848104119301, mean p set: 0.45040273666381836
loss_pred:0.016853531822562218, decouple_loss:0.001329893828369677
loss_pred:0.017757168039679527, decouple_loss:0.0013932845322415233
2023-05-01 03:31:56 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.05074664205312729, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04656713083386421, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.04703959822654724, mean p set: 0.4500633478164673
loss_pred:0.018522901460528374, decouple_loss:0.0014250503154471517
loss_pred:0.01738174445927143, decouple_loss:0.0012786627048626542
loss_pred:0.017561016604304314, decouple_loss:0.0013681456912308931
WV_0_PC_1_EH_0_PS_40, loss: 0.017889751121401787, avg_mse: 0.025703685358166695
current test mse: 0.025704
Iteration: 1371, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44892454147338867, gen p mean: -0.0494668111205101, mean p set: 0.4494048058986664
The modified gen p mean: 0.4492345154285431, gen p mean: -0.045190297067165375, mean p set: 0.4497148096561432
The modified gen p mean: 0.45007792115211487, gen p mean: -0.03941916674375534, mean p set: 0.4505581855773926
loss_pred:0.016959212720394135, decouple_loss:0.0011981067946180701
loss_pred:0.01605784334242344, decouple_loss:0.0013802460161969066
loss_pred:0.016807453706860542, decouple_loss:0.0012741722166538239
Iteration: 1372, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505920112133026, gen p mean: -0.043860871344804764, mean p set: 0.4510722756385803
loss_pred:0.01636846363544464, decouple_loss:0.0010984770487993956
The modified gen p mean: 0.44855958223342896, gen p mean: -0.0478435717523098, mean p set: 0.44903984665870667
The modified gen p mean: 0.4496876001358032, gen p mean: -0.04373089596629143, mean p set: 0.45016786456108093
loss_pred:0.01739680953323841, decouple_loss:0.00109425513073802
loss_pred:0.016599085181951523, decouple_loss:0.0011824655812233686
Iteration: 1373, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497276842594147, gen p mean: -0.04761405661702156, mean p set: 0.45020797848701477
loss_pred:0.01706751435995102, decouple_loss:0.001435342594049871
The modified gen p mean: 0.4523540735244751, gen p mean: -0.03491877019405365, mean p set: 0.4528343677520752The modified gen p mean: 0.4502222239971161, gen p mean: -0.034842561930418015, mean p set: 0.4507025480270386
loss_pred:0.016657965257763863, decouple_loss:0.0013195219216868281
loss_pred:0.017328865826129913, decouple_loss:0.0014016174245625734
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012004_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012004_3_24hr.npz
NaN value num: 0
Iteration: 1374, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45134761929512024, gen p mean: -0.0317368283867836, mean p set: 0.45182791352272034
loss_pred:0.01740683801472187, decouple_loss:0.0012544866185635328
The modified gen p mean: 0.4508567154407501, gen p mean: -0.03355416655540466, mean p set: 0.45133697986602783The modified gen p mean: 0.4491100013256073, gen p mean: -0.03243274986743927, mean p set: 0.4495902955532074
loss_pred:0.017576012760400772, decouple_loss:0.0013965999241918325
loss_pred:0.0170455202460289, decouple_loss:0.001377249602228403
Iteration: 1375, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45134004950523376, gen p mean: -0.03806198388338089, mean p set: 0.4518203139305115
The modified gen p mean: 0.4532161355018616, gen p mean: -0.03339313715696335, mean p set: 0.4536963999271393
loss_pred:0.01729348860681057, decouple_loss:0.0011267070658504963
loss_pred:0.017651349306106567, decouple_loss:0.0012001878349110484
The modified gen p mean: 0.4497767388820648, gen p mean: -0.039132650941610336, mean p set: 0.4502570331096649
loss_pred:0.017906468361616135, decouple_loss:0.0010918914340436459
Iteration: 1376, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45213818550109863, gen p mean: -0.03860997408628464, mean p set: 0.45261847972869873
loss_pred:0.017219360917806625, decouple_loss:0.0013140497030690312
The modified gen p mean: 0.45045655965805054, gen p mean: -0.03364263474941254, mean p set: 0.4509369134902954The modified gen p mean: 0.45043182373046875, gen p mean: -0.0424494706094265, mean p set: 0.45091211795806885
loss_pred:0.017496228218078613, decouple_loss:0.0012703267857432365
loss_pred:0.017739906907081604, decouple_loss:0.0013107056729495525
Iteration: 1377, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4509755074977875, gen p mean: -0.04183410108089447, mean p set: 0.4514558017253876
The modified gen p mean: 0.45173242688179016, gen p mean: -0.044692885130643845, mean p set: 0.45221275091171265
loss_pred:0.017428582534193993, decouple_loss:0.0010610505705699325
loss_pred:0.017323670908808708, decouple_loss:0.001185961184091866
The modified gen p mean: 0.45051953196525574, gen p mean: -0.04082532227039337, mean p set: 0.45099982619285583
loss_pred:0.017471151426434517, decouple_loss:0.0011316525051370263
Iteration: 1378, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492374658584595, gen p mean: -0.04011902958154678, mean p set: 0.44971778988838196
loss_pred:0.017293289303779602, decouple_loss:0.0012193901930004358
The modified gen p mean: 0.45371267199516296, gen p mean: -0.04044045880436897, mean p set: 0.4541929364204407The modified gen p mean: 0.4512578845024109, gen p mean: -0.04467204585671425, mean p set: 0.451738178730011
loss_pred:0.017564550042152405, decouple_loss:0.001328985090367496
loss_pred:0.017158811911940575, decouple_loss:0.0011189060751348734
Iteration: 1379, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487006366252899, gen p mean: -0.04490484297275543, mean p set: 0.44918093085289
loss_pred:0.016997020691633224, decouple_loss:0.0011279045138508081
The modified gen p mean: 0.45129385590553284, gen p mean: -0.0434313528239727, mean p set: 0.45177412033081055The modified gen p mean: 0.45272067189216614, gen p mean: -0.04209697246551514, mean p set: 0.45320096611976624
loss_pred:0.016567686572670937, decouple_loss:0.0012492539826780558
loss_pred:0.01785323955118656, decouple_loss:0.0012673806631937623
Iteration: 1380, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507658779621124, gen p mean: -0.041645027697086334, mean p set: 0.45124614238739014
The modified gen p mean: 0.44925418496131897, gen p mean: -0.042270317673683167, mean p set: 0.4497344493865967loss_pred:0.017244752496480942, decouple_loss:0.0012128379894420505
The modified gen p mean: 0.4515613913536072, gen p mean: -0.04453311488032341, mean p set: 0.4520416855812073
loss_pred:0.016929514706134796, decouple_loss:0.001095833838917315
loss_pred:0.017036721110343933, decouple_loss:0.0011098079849034548
2023-05-01 03:34:28 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.05124200880527496, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04718656465411186, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04757299646735191, mean p set: 0.4500633478164673
loss_pred:0.018391277641057968, decouple_loss:0.0012106816284358501
loss_pred:0.017394891008734703, decouple_loss:0.001212188508361578
loss_pred:0.017553701996803284, decouple_loss:0.0012389292242005467
WV_0_PC_1_EH_0_PS_40, loss: 0.01784098707139492, avg_mse: 0.025601834058761597
current test mse: 0.025602
Iteration: 1381, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449407160282135, gen p mean: -0.04151303693652153, mean p set: 0.4498874545097351
The modified gen p mean: 0.45051440596580505, gen p mean: -0.04492941126227379, mean p set: 0.45099470019340515
The modified gen p mean: 0.4496880769729614, gen p mean: -0.0368245504796505, mean p set: 0.4501683712005615
loss_pred:0.0174949299544096, decouple_loss:0.0010875000152736902
loss_pred:0.016578996554017067, decouple_loss:0.0011901347897946835
loss_pred:0.017533885315060616, decouple_loss:0.00106995168607682
Iteration: 1382, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45160946249961853, gen p mean: -0.04289185628294945, mean p set: 0.452089786529541
loss_pred:0.016076628118753433, decouple_loss:0.0011361526558175683
The modified gen p mean: 0.4497973322868347, gen p mean: -0.04568955674767494, mean p set: 0.4502776563167572The modified gen p mean: 0.45142248272895813, gen p mean: -0.042459335178136826, mean p set: 0.4519027769565582
loss_pred:0.016705455258488655, decouple_loss:0.0012155764270573854
loss_pred:0.016611946746706963, decouple_loss:0.001128960051573813
Iteration: 1383, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4531627595424652, gen p mean: -0.04357725754380226, mean p set: 0.4536430835723877
loss_pred:0.017564119771122932, decouple_loss:0.0012326849391683936
The modified gen p mean: 0.4499387741088867, gen p mean: -0.0482269749045372, mean p set: 0.4504190683364868The modified gen p mean: 0.4514947235584259, gen p mean: -0.04336191713809967, mean p set: 0.451975017786026
loss_pred:0.016708221286535263, decouple_loss:0.0011217942228540778
loss_pred:0.017492258921265602, decouple_loss:0.0013569302391260862
Iteration: 1384, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45084869861602783, gen p mean: -0.04799241945147514, mean p set: 0.45132896304130554
loss_pred:0.017510730773210526, decouple_loss:0.0011186311021447182
The modified gen p mean: 0.45182403922080994, gen p mean: -0.04311804845929146, mean p set: 0.4523043632507324The modified gen p mean: 0.45130518078804016, gen p mean: -0.049874432384967804, mean p set: 0.45178547501564026
loss_pred:0.016472073271870613, decouple_loss:0.0011764330556616187
loss_pred:0.01678924821317196, decouple_loss:0.0010548902209848166
Iteration: 1385, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45052701234817505, gen p mean: -0.052756551653146744, mean p set: 0.45100730657577515
loss_pred:0.017275739461183548, decouple_loss:0.001224660431034863
The modified gen p mean: 0.4489477574825287, gen p mean: -0.04960112273693085, mean p set: 0.4494280517101288The modified gen p mean: 0.4514922797679901, gen p mean: -0.04249648377299309, mean p set: 0.4519725739955902
loss_pred:0.016245098784565926, decouple_loss:0.0011963419383391738
loss_pred:0.0173539686948061, decouple_loss:0.0012276617344468832
Iteration: 1386, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45158591866493225, gen p mean: -0.05242212489247322, mean p set: 0.45206621289253235
loss_pred:0.016928307712078094, decouple_loss:0.0011061166878789663
The modified gen p mean: 0.4515460133552551, gen p mean: -0.0553998164832592, mean p set: 0.4520263373851776The modified gen p mean: 0.45225515961647034, gen p mean: -0.04819193482398987, mean p set: 0.45273545384407043
loss_pred:0.017459189519286156, decouple_loss:0.0014773898292332888
loss_pred:0.016509147360920906, decouple_loss:0.0011246934300288558
Iteration: 1387, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4521658420562744, gen p mean: -0.0538407564163208, mean p set: 0.4526461362838745
loss_pred:0.016216835007071495, decouple_loss:0.0010343065951019526
The modified gen p mean: 0.4527045786380768, gen p mean: -0.050159137696027756, mean p set: 0.45318490266799927The modified gen p mean: 0.45077332854270935, gen p mean: -0.05160820111632347, mean p set: 0.45125362277030945
loss_pred:0.0176224522292614, decouple_loss:0.0010826913639903069
loss_pred:0.016685547307133675, decouple_loss:0.0010171693284064531
Iteration: 1388, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4523635804653168, gen p mean: -0.05837811157107353, mean p set: 0.45284390449523926
loss_pred:0.01739983633160591, decouple_loss:0.0012601554626598954
The modified gen p mean: 0.4520755112171173, gen p mean: -0.05096781998872757, mean p set: 0.4525558054447174The modified gen p mean: 0.45004647970199585, gen p mean: -0.05628863722085953, mean p set: 0.45052674412727356
loss_pred:0.016675245016813278, decouple_loss:0.0012835069792345166
loss_pred:0.01657717116177082, decouple_loss:0.0012650026474148035
Iteration: 1389, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45221543312072754, gen p mean: -0.0529119148850441, mean p set: 0.45269572734832764
loss_pred:0.01602128893136978, decouple_loss:0.0011599409626796842
The modified gen p mean: 0.4493904411792755, gen p mean: -0.05454336479306221, mean p set: 0.4498707354068756The modified gen p mean: 0.45053964853286743, gen p mean: -0.056230783462524414, mean p set: 0.4510199725627899
loss_pred:0.01656072586774826, decouple_loss:0.0010912216966971755
loss_pred:0.017392192035913467, decouple_loss:0.0011088590836152434
Iteration: 1390, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44854339957237244, gen p mean: -0.05111874267458916, mean p set: 0.44902369379997253
loss_pred:0.01708337850868702, decouple_loss:0.0012723890831694007
The modified gen p mean: 0.44974738359451294, gen p mean: -0.054342564195394516, mean p set: 0.45022767782211304The modified gen p mean: 0.4512546956539154, gen p mean: -0.04946432635188103, mean p set: 0.4517350196838379
loss_pred:0.017350275069475174, decouple_loss:0.001241493271663785
loss_pred:0.016640523448586464, decouple_loss:0.0012939677108079195
2023-05-01 03:36:21 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.05721651390194893, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.053008098155260086, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.053072452545166016, mean p set: 0.4500633478164673
loss_pred:0.018384167924523354, decouple_loss:0.0014254600973799825
loss_pred:0.017320606857538223, decouple_loss:0.0012938018189743161
loss_pred:0.017517119646072388, decouple_loss:0.0013223853893578053
WV_0_PC_1_EH_0_PS_40, loss: 0.017807992175221443, avg_mse: 0.025550631806254387
current test mse: 0.025551
Iteration: 1391, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45080551505088806, gen p mean: -0.046668559312820435, mean p set: 0.45128580927848816
The modified gen p mean: 0.4485553801059723, gen p mean: -0.048013705760240555, mean p set: 0.4490357041358948
The modified gen p mean: 0.4496020972728729, gen p mean: -0.049359049648046494, mean p set: 0.450082391500473
loss_pred:0.01694854162633419, decouple_loss:0.0013374857371672988
loss_pred:0.016915475949645042, decouple_loss:0.0014544390141963959
loss_pred:0.01670774258673191, decouple_loss:0.0012419462436810136
Iteration: 1392, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45059874653816223, gen p mean: -0.04321581497788429, mean p set: 0.45107904076576233
loss_pred:0.0167317446321249, decouple_loss:0.0011870275484398007
The modified gen p mean: 0.4512452185153961, gen p mean: -0.0425393246114254, mean p set: 0.4517255127429962The modified gen p mean: 0.4526613652706146, gen p mean: -0.04382665455341339, mean p set: 0.45314162969589233
loss_pred:0.016877757385373116, decouple_loss:0.0011589693604037166
loss_pred:0.017414404079318047, decouple_loss:0.001133394311182201
Iteration: 1393, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449683278799057, gen p mean: -0.047291722148656845, mean p set: 0.4501636028289795
loss_pred:0.017146704718470573, decouple_loss:0.0016007465310394764
The modified gen p mean: 0.4491153657436371, gen p mean: -0.04082206264138222, mean p set: 0.44959568977355957The modified gen p mean: 0.4488845467567444, gen p mean: -0.044860295951366425, mean p set: 0.4493648409843445
loss_pred:0.017170721665024757, decouple_loss:0.0014459408121183515
loss_pred:0.016815485432744026, decouple_loss:0.0015926910564303398
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012010_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012010_3_24hr.npz
NaN value num: 0
Iteration: 1394, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480511248111725, gen p mean: -0.05534753575921059, mean p set: 0.44853144884109497
loss_pred:0.015207401476800442, decouple_loss:0.0014982620486989617
The modified gen p mean: 0.447172075510025, gen p mean: -0.05387263000011444, mean p set: 0.4476523995399475The modified gen p mean: 0.4480394124984741, gen p mean: -0.0509071983397007, mean p set: 0.4485197067260742
loss_pred:0.015845537185668945, decouple_loss:0.0013343570753932
loss_pred:0.015228223986923695, decouple_loss:0.0012867306359112263
Iteration: 1395, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465716779232025, gen p mean: -0.04719093441963196, mean p set: 0.4470519721508026
The modified gen p mean: 0.44689860939979553, gen p mean: -0.04968443512916565, mean p set: 0.44737890362739563
loss_pred:0.015415445901453495, decouple_loss:0.0013875325676053762
loss_pred:0.015655234456062317, decouple_loss:0.0013517128536477685
The modified gen p mean: 0.44752365350723267, gen p mean: -0.05236685276031494, mean p set: 0.44800394773483276
loss_pred:0.01583775132894516, decouple_loss:0.0013119843788444996
Iteration: 1396, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447181761264801, gen p mean: -0.04678887501358986, mean p set: 0.4476620554924011
loss_pred:0.015660012140870094, decouple_loss:0.0013439902104437351
The modified gen p mean: 0.4472044110298157, gen p mean: -0.049929793924093246, mean p set: 0.44768473505973816The modified gen p mean: 0.44818034768104553, gen p mean: -0.04617824777960777, mean p set: 0.44866064190864563
loss_pred:0.015537571161985397, decouple_loss:0.0014030828606337309
loss_pred:0.015683874487876892, decouple_loss:0.0014179969439283013
Iteration: 1397, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467315375804901, gen p mean: -0.04965768754482269, mean p set: 0.4472118318080902
loss_pred:0.015210218727588654, decouple_loss:0.0012676643673330545
The modified gen p mean: 0.4479084014892578, gen p mean: -0.05346814543008804, mean p set: 0.4483886957168579The modified gen p mean: 0.44782400131225586, gen p mean: -0.04746001213788986, mean p set: 0.44830429553985596
loss_pred:0.014950437471270561, decouple_loss:0.0013634682400152087
loss_pred:0.014751014299690723, decouple_loss:0.0013146502897143364
Iteration: 1398, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446647047996521, gen p mean: -0.0498654879629612, mean p set: 0.4471273422241211
loss_pred:0.01523455698043108, decouple_loss:0.0014158382546156645
The modified gen p mean: 0.4482623338699341, gen p mean: -0.05248231813311577, mean p set: 0.4487426280975342The modified gen p mean: 0.4481261074542999, gen p mean: -0.04735498130321503, mean p set: 0.4486064314842224
loss_pred:0.014589431695640087, decouple_loss:0.0013475182931870222
loss_pred:0.014701450243592262, decouple_loss:0.001294739544391632
Iteration: 1399, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472287595272064, gen p mean: -0.04109576344490051, mean p set: 0.4477090537548065
loss_pred:0.014540204778313637, decouple_loss:0.0014676610007882118
The modified gen p mean: 0.446898490190506, gen p mean: -0.04187653586268425, mean p set: 0.4473787844181061The modified gen p mean: 0.4484303593635559, gen p mean: -0.04388553276658058, mean p set: 0.448910653591156
loss_pred:0.015051211230456829, decouple_loss:0.0016010180115699768
loss_pred:0.01410533208400011, decouple_loss:0.0013791563687846065
Iteration: 1400, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472210109233856, gen p mean: -0.046310558915138245, mean p set: 0.4477013349533081
loss_pred:0.014652918092906475, decouple_loss:0.0013134743785485625
The modified gen p mean: 0.4477115571498871, gen p mean: -0.039813634008169174, mean p set: 0.4481918513774872The modified gen p mean: 0.44848939776420593, gen p mean: -0.04142327979207039, mean p set: 0.44896969199180603
loss_pred:0.014402639120817184, decouple_loss:0.0012673746095970273
loss_pred:0.014736484736204147, decouple_loss:0.0012342563131824136
2023-05-01 03:39:01 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.03921861946582794, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.03546074777841568, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.03522138670086861, mean p set: 0.4500633478164673
loss_pred:0.018947025761008263, decouple_loss:0.0014156524557620287
loss_pred:0.017858456820249557, decouple_loss:0.0014604699099436402
loss_pred:0.017985578626394272, decouple_loss:0.0013598778750747442
WV_0_PC_1_EH_0_PS_40, loss: 0.018334288150072098, avg_mse: 0.026486126706004143
current test mse: 0.026486
Iteration: 1401, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484916031360626, gen p mean: -0.03672502934932709, mean p set: 0.44897186756134033
The modified gen p mean: 0.44710662961006165, gen p mean: -0.043590180575847626, mean p set: 0.44758692383766174
The modified gen p mean: 0.44666987657546997, gen p mean: -0.033534981310367584, mean p set: 0.4471501410007477
loss_pred:0.014496694318950176, decouple_loss:0.0013420042814686894
loss_pred:0.014675276353955269, decouple_loss:0.0014082343550398946
loss_pred:0.014800111763179302, decouple_loss:0.001482345280237496
Iteration: 1402, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468585252761841, gen p mean: -0.038439810276031494, mean p set: 0.4473388195037842
The modified gen p mean: 0.447144091129303, gen p mean: -0.03307589888572693, mean p set: 0.44762441515922546
loss_pred:0.014095297083258629, decouple_loss:0.0014609177596867085
loss_pred:0.014652010053396225, decouple_loss:0.0015183000359684229
The modified gen p mean: 0.448211133480072, gen p mean: -0.034620873630046844, mean p set: 0.44869139790534973
loss_pred:0.014044034294784069, decouple_loss:0.0014660152373835444
Iteration: 1403, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487683176994324, gen p mean: -0.03374722972512245, mean p set: 0.44924864172935486
loss_pred:0.013892803341150284, decouple_loss:0.0014129936462268233
The modified gen p mean: 0.44722360372543335, gen p mean: -0.03270920738577843, mean p set: 0.44770386815071106The modified gen p mean: 0.4489342272281647, gen p mean: -0.03441378101706505, mean p set: 0.44941452145576477
loss_pred:0.014269654639065266, decouple_loss:0.0015304344706237316
loss_pred:0.014164203777909279, decouple_loss:0.0013671698980033398
Iteration: 1404, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472768306732178, gen p mean: -0.03650422766804695, mean p set: 0.4477570950984955
loss_pred:0.014568982645869255, decouple_loss:0.0017214689869433641
The modified gen p mean: 0.4469960927963257, gen p mean: -0.03815988823771477, mean p set: 0.4474763870239258The modified gen p mean: 0.4480860233306885, gen p mean: -0.03849500045180321, mean p set: 0.4485662877559662
loss_pred:0.014435704797506332, decouple_loss:0.0015223880764096975
loss_pred:0.014062070287764072, decouple_loss:0.0013561698142439127
Iteration: 1405, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44746914505958557, gen p mean: -0.04133972153067589, mean p set: 0.44794946908950806
loss_pred:0.014321107417345047, decouple_loss:0.001561387674883008
The modified gen p mean: 0.44711413979530334, gen p mean: -0.043133292347192764, mean p set: 0.44759440422058105The modified gen p mean: 0.4479628801345825, gen p mean: -0.04237882420420647, mean p set: 0.448443204164505
loss_pred:0.013892780058085918, decouple_loss:0.001455078017897904
loss_pred:0.013835608959197998, decouple_loss:0.0014795211609452963
Iteration: 1406, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478238523006439, gen p mean: -0.04600296542048454, mean p set: 0.448304146528244
loss_pred:0.014035130850970745, decouple_loss:0.0015385743463411927
The modified gen p mean: 0.4472237229347229, gen p mean: -0.0445072315633297, mean p set: 0.4477039873600006The modified gen p mean: 0.44741079211235046, gen p mean: -0.0473080575466156, mean p set: 0.44789108633995056
loss_pred:0.013554300181567669, decouple_loss:0.0015987984370440245
loss_pred:0.014516938477754593, decouple_loss:0.001641357783228159
Iteration: 1407, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477587044239044, gen p mean: -0.04623517021536827, mean p set: 0.4482389986515045
loss_pred:0.013617228716611862, decouple_loss:0.0016835929127410054
The modified gen p mean: 0.4485773742198944, gen p mean: -0.04511638730764389, mean p set: 0.4490576982498169The modified gen p mean: 0.4481221139431, gen p mean: -0.04384953901171684, mean p set: 0.4486024081707001
loss_pred:0.01349242776632309, decouple_loss:0.0015324562555179
loss_pred:0.01406274177134037, decouple_loss:0.0015605665976181626
Iteration: 1408, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473575949668884, gen p mean: -0.04183731973171234, mean p set: 0.4478378891944885
loss_pred:0.01350942999124527, decouple_loss:0.0013933901209384203
The modified gen p mean: 0.4486684501171112, gen p mean: -0.0458681620657444, mean p set: 0.4491487443447113The modified gen p mean: 0.4464516043663025, gen p mean: -0.04668816551566124, mean p set: 0.4469318985939026
loss_pred:0.01356941182166338, decouple_loss:0.001354197971522808
loss_pred:0.014693188481032848, decouple_loss:0.0014770589768886566
Iteration: 1409, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447517991065979, gen p mean: -0.042666226625442505, mean p set: 0.4479982852935791
loss_pred:0.013495177961885929, decouple_loss:0.001532251015305519
The modified gen p mean: 0.4488455653190613, gen p mean: -0.04187837243080139, mean p set: 0.449325829744339The modified gen p mean: 0.44812914729118347, gen p mean: -0.044304076582193375, mean p set: 0.44860947132110596
loss_pred:0.013251732103526592, decouple_loss:0.0016448568785563111
loss_pred:0.013904310762882233, decouple_loss:0.0014187275664880872
Iteration: 1410, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44832539558410645, gen p mean: -0.05011153593659401, mean p set: 0.44880568981170654
loss_pred:0.013706446625292301, decouple_loss:0.0015783520648255944
The modified gen p mean: 0.44735005497932434, gen p mean: -0.04773692786693573, mean p set: 0.44783034920692444The modified gen p mean: 0.44715961813926697, gen p mean: -0.04609310254454613, mean p set: 0.4476398825645447
loss_pred:0.014164240099489689, decouple_loss:0.0016204850981011987
loss_pred:0.014276267029345036, decouple_loss:0.0014279652386903763
2023-05-01 03:40:54 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.04503094404935837, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04105481505393982, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.040767114609479904, mean p set: 0.4500633478164673
loss_pred:0.019229015335440636, decouple_loss:0.0013941318029537797
loss_pred:0.018155694007873535, decouple_loss:0.0013182538095861673
loss_pred:0.018306488171219826, decouple_loss:0.0013196268118917942
WV_0_PC_1_EH_0_PS_40, loss: 0.01863093301653862, avg_mse: 0.02716205082833767
current test mse: 0.027162
Iteration: 1411, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44752150774002075, gen p mean: -0.042766403406858444, mean p set: 0.44800183176994324
The modified gen p mean: 0.4477773904800415, gen p mean: -0.040860146284103394, mean p set: 0.4482576549053192
The modified gen p mean: 0.44840559363365173, gen p mean: -0.0399053655564785, mean p set: 0.44888588786125183
loss_pred:0.013954789377748966, decouple_loss:0.0013475328451022506
loss_pred:0.014266389422118664, decouple_loss:0.0013053548755124211
loss_pred:0.014180081896483898, decouple_loss:0.001297769253142178
Iteration: 1412, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44782304763793945, gen p mean: -0.0404851920902729, mean p set: 0.44830334186553955
loss_pred:0.014268581755459309, decouple_loss:0.0017805858515203
The modified gen p mean: 0.4469423294067383, gen p mean: -0.037180326879024506, mean p set: 0.447422593832016The modified gen p mean: 0.44760164618492126, gen p mean: -0.04139605164527893, mean p set: 0.448081910610199
loss_pred:0.013822504319250584, decouple_loss:0.0015935772098600864
loss_pred:0.01438833586871624, decouple_loss:0.0016955867176875472
Iteration: 1413, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480065703392029, gen p mean: -0.03718804568052292, mean p set: 0.448486864566803
loss_pred:0.013484538532793522, decouple_loss:0.0014081945409998298
The modified gen p mean: 0.44917985796928406, gen p mean: -0.03654460981488228, mean p set: 0.44966015219688416The modified gen p mean: 0.4476369321346283, gen p mean: -0.04340578615665436, mean p set: 0.4481172263622284
loss_pred:0.013584185391664505, decouple_loss:0.001442394102923572
loss_pred:0.013935437425971031, decouple_loss:0.00135245721321553
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012018_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012018_3_24hr.npz
NaN value num: 0
Iteration: 1414, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45147356390953064, gen p mean: -0.030964747071266174, mean p set: 0.45195385813713074
loss_pred:0.016688993200659752, decouple_loss:0.0017147600883617997
The modified gen p mean: 0.4504055976867676, gen p mean: -0.037900544703006744, mean p set: 0.4508858919143677The modified gen p mean: 0.450111448764801, gen p mean: -0.03818715363740921, mean p set: 0.4505917727947235
loss_pred:0.017971238121390343, decouple_loss:0.0015426891623064876
loss_pred:0.017395449802279472, decouple_loss:0.001770764822140336
Iteration: 1415, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511641561985016, gen p mean: -0.03412886708974838, mean p set: 0.4516444504261017
loss_pred:0.018465407192707062, decouple_loss:0.0014613087987527251
The modified gen p mean: 0.4499695599079132, gen p mean: -0.03747135400772095, mean p set: 0.4504498541355133The modified gen p mean: 0.45085054636001587, gen p mean: -0.03518875688314438, mean p set: 0.45133084058761597
loss_pred:0.017622338607907295, decouple_loss:0.0014766267267987132
loss_pred:0.018374493345618248, decouple_loss:0.0016137296333909035
Iteration: 1416, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4510863423347473, gen p mean: -0.03482595458626747, mean p set: 0.451566606760025
loss_pred:0.018492242321372032, decouple_loss:0.0014444931875914335
The modified gen p mean: 0.4501606523990631, gen p mean: -0.03380247950553894, mean p set: 0.4506409764289856The modified gen p mean: 0.4500679075717926, gen p mean: -0.03638600558042526, mean p set: 0.4505482017993927
loss_pred:0.01758704148232937, decouple_loss:0.001679187174886465
loss_pred:0.017593352124094963, decouple_loss:0.0015495389234274626
Iteration: 1417, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45096904039382935, gen p mean: -0.029448453336954117, mean p set: 0.45144933462142944
loss_pred:0.016344932839274406, decouple_loss:0.0015436758985742927
The modified gen p mean: 0.44996291399002075, gen p mean: -0.03642643615603447, mean p set: 0.45044317841529846The modified gen p mean: 0.45372727513313293, gen p mean: -0.030066905543208122, mean p set: 0.45420756936073303
loss_pred:0.017214113846421242, decouple_loss:0.0015321186510846019
loss_pred:0.017438609153032303, decouple_loss:0.0014897745568305254
Iteration: 1418, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502720534801483, gen p mean: -0.036276984959840775, mean p set: 0.450752317905426
The modified gen p mean: 0.45250585675239563, gen p mean: -0.031093966215848923, mean p set: 0.4529861509799957
loss_pred:0.016901439055800438, decouple_loss:0.001388124655932188
loss_pred:0.01698576658964157, decouple_loss:0.0014482885599136353
The modified gen p mean: 0.4523758292198181, gen p mean: -0.03234728425741196, mean p set: 0.4528560936450958
loss_pred:0.017374487593770027, decouple_loss:0.001379860914312303
Iteration: 1419, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4522205889225006, gen p mean: -0.03325174003839493, mean p set: 0.4527009129524231
The modified gen p mean: 0.4522046148777008, gen p mean: -0.030024848878383636, mean p set: 0.4526849389076233
loss_pred:0.01660311594605446, decouple_loss:0.001615760731510818
loss_pred:0.017300724983215332, decouple_loss:0.001692452235147357
The modified gen p mean: 0.4500938057899475, gen p mean: -0.03457041457295418, mean p set: 0.4505741000175476
loss_pred:0.017897294834256172, decouple_loss:0.0016720844432711601
Iteration: 1420, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45057153701782227, gen p mean: -0.040332190692424774, mean p set: 0.45105183124542236
loss_pred:0.018205106258392334, decouple_loss:0.0013352478854358196
The modified gen p mean: 0.4508111774921417, gen p mean: -0.03330862522125244, mean p set: 0.4512914717197418The modified gen p mean: 0.45092833042144775, gen p mean: -0.03917423263192177, mean p set: 0.45140859484672546
loss_pred:0.017831474542617798, decouple_loss:0.0014391107251867652
loss_pred:0.016938528046011925, decouple_loss:0.0013083686353638768
2023-05-01 03:43:29 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.04803340509533882, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.044553134590387344, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.044499143958091736, mean p set: 0.4500633478164673
loss_pred:0.01857113279402256, decouple_loss:0.0015642918879166245
loss_pred:0.017548397183418274, decouple_loss:0.0016909437254071236
loss_pred:0.017724039033055305, decouple_loss:0.0015736973145976663
WV_0_PC_1_EH_0_PS_40, loss: 0.018028339371085167, avg_mse: 0.02587423101067543
current test mse: 0.025874
Iteration: 1421, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45075225830078125, gen p mean: -0.03908609598875046, mean p set: 0.45123252272605896
The modified gen p mean: 0.4495902359485626, gen p mean: -0.03648433834314346, mean p set: 0.4500705301761627
The modified gen p mean: 0.45037972927093506, gen p mean: -0.0429580993950367, mean p set: 0.45086002349853516
loss_pred:0.017689848318696022, decouple_loss:0.0014218018623068929
loss_pred:0.017561985179781914, decouple_loss:0.0016015057917684317
loss_pred:0.017484422773122787, decouple_loss:0.0014213841641321778
Iteration: 1422, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4506599009037018, gen p mean: -0.04256128519773483, mean p set: 0.4511401653289795
loss_pred:0.01750914566218853, decouple_loss:0.0015435267705470324
The modified gen p mean: 0.45031094551086426, gen p mean: -0.044711582362651825, mean p set: 0.45079126954078674The modified gen p mean: 0.45253220200538635, gen p mean: -0.04256023094058037, mean p set: 0.45301249623298645
loss_pred:0.016807811334729195, decouple_loss:0.0013991717714816332
loss_pred:0.01707780361175537, decouple_loss:0.00132767076138407
Iteration: 1423, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4526808559894562, gen p mean: -0.04510458931326866, mean p set: 0.4531611502170563
loss_pred:0.017152775079011917, decouple_loss:0.0013125763507559896
The modified gen p mean: 0.45007598400115967, gen p mean: -0.04715227335691452, mean p set: 0.45055627822875977The modified gen p mean: 0.4499722719192505, gen p mean: -0.04850445315241814, mean p set: 0.4504525363445282
loss_pred:0.017244847491383553, decouple_loss:0.0014704414643347263
loss_pred:0.01730065979063511, decouple_loss:0.0014071856858208776
Iteration: 1424, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45219242572784424, gen p mean: -0.05065690726041794, mean p set: 0.45267269015312195
loss_pred:0.01649406924843788, decouple_loss:0.00142084457911551
The modified gen p mean: 0.45389440655708313, gen p mean: -0.04790163412690163, mean p set: 0.45437467098236084The modified gen p mean: 0.45068255066871643, gen p mean: -0.05069240927696228, mean p set: 0.45116284489631653
loss_pred:0.017153853550553322, decouple_loss:0.0014635181287303567
loss_pred:0.016599101945757866, decouple_loss:0.0014252347173169255
Iteration: 1425, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4535161554813385, gen p mean: -0.051734741777181625, mean p set: 0.453996479511261
loss_pred:0.016435982659459114, decouple_loss:0.0012612983118742704
The modified gen p mean: 0.4510114789009094, gen p mean: -0.04937062785029411, mean p set: 0.45149174332618713The modified gen p mean: 0.4522593319416046, gen p mean: -0.05226869508624077, mean p set: 0.4527396559715271
loss_pred:0.01699366234242916, decouple_loss:0.0013052095891907811
loss_pred:0.016613885760307312, decouple_loss:0.0012648716801777482
Iteration: 1426, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4515415132045746, gen p mean: -0.05098098888993263, mean p set: 0.4520217776298523
loss_pred:0.016498545184731483, decouple_loss:0.0013771348167210817
The modified gen p mean: 0.4499717652797699, gen p mean: -0.05565085634589195, mean p set: 0.45045205950737The modified gen p mean: 0.4519071877002716, gen p mean: -0.04712994024157524, mean p set: 0.4523874819278717
loss_pred:0.01719169318675995, decouple_loss:0.0013686249731108546
loss_pred:0.01640510931611061, decouple_loss:0.0013693245127797127
Iteration: 1427, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45046618580818176, gen p mean: -0.051041875034570694, mean p set: 0.4509464502334595
loss_pred:0.01657290570437908, decouple_loss:0.0012513111578300595
The modified gen p mean: 0.45030415058135986, gen p mean: -0.05959984287619591, mean p set: 0.45078444480895996The modified gen p mean: 0.4521706998348236, gen p mean: -0.058455582708120346, mean p set: 0.4526509940624237
loss_pred:0.018190717324614525, decouple_loss:0.0014449042500928044
loss_pred:0.017220020294189453, decouple_loss:0.0013739494606852531
Iteration: 1428, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505919814109802, gen p mean: -0.054655976593494415, mean p set: 0.4510722756385803
loss_pred:0.017613215371966362, decouple_loss:0.0012411159696057439
The modified gen p mean: 0.4521578848361969, gen p mean: -0.055078133940696716, mean p set: 0.452638179063797The modified gen p mean: 0.4497382342815399, gen p mean: -0.05818042531609535, mean p set: 0.4502184987068176
loss_pred:0.0173586867749691, decouple_loss:0.0012221394572407007
loss_pred:0.01748490333557129, decouple_loss:0.0012753837509080768
Iteration: 1429, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4520878493785858, gen p mean: -0.0542617030441761, mean p set: 0.4525681734085083
loss_pred:0.016931891441345215, decouple_loss:0.001419664011336863
The modified gen p mean: 0.4505867063999176, gen p mean: -0.05735572800040245, mean p set: 0.4510670304298401The modified gen p mean: 0.44997653365135193, gen p mean: -0.05716830864548683, mean p set: 0.450456827878952
loss_pred:0.016704199835658073, decouple_loss:0.0014238918665796518
loss_pred:0.01775597222149372, decouple_loss:0.0015459824353456497
Iteration: 1430, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45085394382476807, gen p mean: -0.0546317882835865, mean p set: 0.45133426785469055
loss_pred:0.017490889877080917, decouple_loss:0.001321014598943293
The modified gen p mean: 0.45017921924591064, gen p mean: -0.054606761783361435, mean p set: 0.45065951347351074The modified gen p mean: 0.4502878785133362, gen p mean: -0.056926481425762177, mean p set: 0.4507681429386139
loss_pred:0.016845103353261948, decouple_loss:0.0013064176309853792
loss_pred:0.016692759469151497, decouple_loss:0.0013113277964293957
2023-05-01 03:45:22 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.058900684118270874, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.05530152842402458, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.05518961697816849, mean p set: 0.4500633478164673
loss_pred:0.01839206926524639, decouple_loss:0.001297705457545817
loss_pred:0.017367947846651077, decouple_loss:0.0014267823426052928
loss_pred:0.017513765022158623, decouple_loss:0.0013566900743171573
WV_0_PC_1_EH_0_PS_40, loss: 0.01782594621181488, avg_mse: 0.025578085333108902
current test mse: 0.025578
Iteration: 1431, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45093458890914917, gen p mean: -0.048743098974227905, mean p set: 0.45141491293907166
The modified gen p mean: 0.449016273021698, gen p mean: -0.052469126880168915, mean p set: 0.4494965374469757
The modified gen p mean: 0.45123782753944397, gen p mean: -0.05008469521999359, mean p set: 0.45171812176704407
loss_pred:0.017690308392047882, decouple_loss:0.0013178720837458968
loss_pred:0.017331844195723534, decouple_loss:0.001328812912106514
loss_pred:0.017750803381204605, decouple_loss:0.0012478668941184878
Iteration: 1432, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45066073536872864, gen p mean: -0.049649663269519806, mean p set: 0.45114099979400635
loss_pred:0.017057567834854126, decouple_loss:0.0014711891999468207
The modified gen p mean: 0.4518769085407257, gen p mean: -0.044847436249256134, mean p set: 0.4523571729660034The modified gen p mean: 0.4523325562477112, gen p mean: -0.05036698281764984, mean p set: 0.45281288027763367
loss_pred:0.016397403553128242, decouple_loss:0.0015421727439388633
loss_pred:0.0180875975638628, decouple_loss:0.0012631153222173452
Iteration: 1433, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45059317350387573, gen p mean: -0.04984147474169731, mean p set: 0.45107343792915344
loss_pred:0.017001744359731674, decouple_loss:0.0011553032090887427
The modified gen p mean: 0.4502183496952057, gen p mean: -0.04725167527794838, mean p set: 0.4506986141204834The modified gen p mean: 0.45089730620384216, gen p mean: -0.04981100186705589, mean p set: 0.4513775408267975
loss_pred:0.01743754930794239, decouple_loss:0.0011310628615319729
loss_pred:0.016543224453926086, decouple_loss:0.001149198622442782
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012002_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012002_3_24hr.npz
NaN value num: 0
Iteration: 1434, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44668179750442505, gen p mean: -0.05433418229222298, mean p set: 0.44716206192970276
loss_pred:0.015848862007260323, decouple_loss:0.0014773968141525984
The modified gen p mean: 0.4459763467311859, gen p mean: -0.058388851583004, mean p set: 0.446456640958786The modified gen p mean: 0.44646063446998596, gen p mean: -0.0533500500023365, mean p set: 0.44694095849990845
loss_pred:0.014866912737488747, decouple_loss:0.0015360618708655238
loss_pred:0.016154685989022255, decouple_loss:0.0014519380638375878
Iteration: 1435, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44669926166534424, gen p mean: -0.057121507823467255, mean p set: 0.44717955589294434
loss_pred:0.014804214239120483, decouple_loss:0.0013678004033863544
The modified gen p mean: 0.4478778541088104, gen p mean: -0.05728989094495773, mean p set: 0.4483581483364105The modified gen p mean: 0.4485483765602112, gen p mean: -0.05217054486274719, mean p set: 0.4490286707878113
loss_pred:0.014634910970926285, decouple_loss:0.0014220846351236105
loss_pred:0.01540780533105135, decouple_loss:0.0013005739310756326
Iteration: 1436, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464872479438782, gen p mean: -0.05865753814578056, mean p set: 0.44696754217147827
loss_pred:0.013899194076657295, decouple_loss:0.0016465586377307773
The modified gen p mean: 0.44796085357666016, gen p mean: -0.05570628494024277, mean p set: 0.44844114780426025The modified gen p mean: 0.4472739100456238, gen p mean: -0.05062714219093323, mean p set: 0.4477542042732239
loss_pred:0.014938258565962315, decouple_loss:0.001591695356182754
loss_pred:0.015698429197072983, decouple_loss:0.001416711718775332
Iteration: 1437, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44501036405563354, gen p mean: -0.0603099949657917, mean p set: 0.44549062848091125
loss_pred:0.014601994305849075, decouple_loss:0.0015347760636359453
The modified gen p mean: 0.44790756702423096, gen p mean: -0.05705176666378975, mean p set: 0.44838783144950867The modified gen p mean: 0.44632357358932495, gen p mean: -0.054285865277051926, mean p set: 0.44680383801460266
loss_pred:0.014733112417161465, decouple_loss:0.0014764025108888745
loss_pred:0.01483660563826561, decouple_loss:0.0015139385359361768
Iteration: 1438, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4462986886501312, gen p mean: -0.05086874961853027, mean p set: 0.4467789828777313
loss_pred:0.014641012996435165, decouple_loss:0.0015471000224351883
The modified gen p mean: 0.447200208902359, gen p mean: -0.05426636338233948, mean p set: 0.4476804733276367The modified gen p mean: 0.4464516043663025, gen p mean: -0.05125498026609421, mean p set: 0.4469318985939026
loss_pred:0.015176727436482906, decouple_loss:0.0014717879239469767
loss_pred:0.014513550326228142, decouple_loss:0.0015450165374204516
Iteration: 1439, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475288987159729, gen p mean: -0.045858852565288544, mean p set: 0.448009192943573
loss_pred:0.014848699793219566, decouple_loss:0.0016989702126011252
The modified gen p mean: 0.4455007314682007, gen p mean: -0.05915586277842522, mean p set: 0.44598105549812317The modified gen p mean: 0.4464479982852936, gen p mean: -0.05686032399535179, mean p set: 0.44692835211753845
loss_pred:0.014076698571443558, decouple_loss:0.0017017005011439323
loss_pred:0.01387549564242363, decouple_loss:0.0017114249058067799
Iteration: 1440, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44723257422447205, gen p mean: -0.05234074965119362, mean p set: 0.44771286845207214
loss_pred:0.0138873141258955, decouple_loss:0.0015156466979533434
The modified gen p mean: 0.44727280735969543, gen p mean: -0.05226249247789383, mean p set: 0.44775307178497314The modified gen p mean: 0.4474528431892395, gen p mean: -0.0548507422208786, mean p set: 0.4479331374168396
loss_pred:0.013299507088959217, decouple_loss:0.0015145954675972462
loss_pred:0.014123491942882538, decouple_loss:0.0015429313061758876
2023-05-01 03:47:56 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.05354443937540054, mean p set: 0.4502691626548767
The modified gen p mean: 0.4498766362667084, gen p mean: -0.05050992965698242, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.0500989593565464, mean p set: 0.4500633478164673
loss_pred:0.019003374502062798, decouple_loss:0.0018330501625314355
loss_pred:0.017991550266742706, decouple_loss:0.0016668501775711775
loss_pred:0.01813206449151039, decouple_loss:0.0016648126766085625
WV_0_PC_1_EH_0_PS_40, loss: 0.018461741507053375, avg_mse: 0.026705581694841385
current test mse: 0.026706
Iteration: 1441, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.445803701877594, gen p mean: -0.053558751940727234, mean p set: 0.4462839961051941
The modified gen p mean: 0.4477289915084839, gen p mean: -0.052303239703178406, mean p set: 0.448209285736084
The modified gen p mean: 0.44828417897224426, gen p mean: -0.05163994058966637, mean p set: 0.44876447319984436
loss_pred:0.01381656527519226, decouple_loss:0.0016543506644666195
loss_pred:0.014183154329657555, decouple_loss:0.00164412974845618
loss_pred:0.01398735772818327, decouple_loss:0.0016390859382227063
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1442, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490334987640381, gen p mean: -0.05000896379351616, mean p set: 0.4495137631893158
loss_pred:0.014060676097869873, decouple_loss:0.0017439053626731038
The modified gen p mean: 0.44654643535614014, gen p mean: -0.05083409696817398, mean p set: 0.4470267593860626The modified gen p mean: 0.4462679922580719, gen p mean: -0.049246396869421005, mean p set: 0.446748286485672
loss_pred:0.014059578068554401, decouple_loss:0.0017836416373029351
loss_pred:0.01406079065054655, decouple_loss:0.0016806954517960548
Iteration: 1443, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481351971626282, gen p mean: -0.047557439655065536, mean p set: 0.44861549139022827
loss_pred:0.014186405576765537, decouple_loss:0.0015948066720739007
The modified gen p mean: 0.44783398509025574, gen p mean: -0.046745434403419495, mean p set: 0.44831427931785583The modified gen p mean: 0.44786348938941956, gen p mean: -0.046280860900878906, mean p set: 0.44834378361701965
loss_pred:0.013634804636240005, decouple_loss:0.0017548336181789637
loss_pred:0.014097287319600582, decouple_loss:0.001563910162076354
Iteration: 1444, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44696521759033203, gen p mean: -0.042645420879125595, mean p set: 0.44744551181793213
loss_pred:0.013840246945619583, decouple_loss:0.0015278831124305725
The modified gen p mean: 0.4474099576473236, gen p mean: -0.04244397580623627, mean p set: 0.4478902518749237The modified gen p mean: 0.44754672050476074, gen p mean: -0.05051536485552788, mean p set: 0.44802701473236084
loss_pred:0.012883885763585567, decouple_loss:0.0015688750427216291
loss_pred:0.014162098988890648, decouple_loss:0.0015618873294442892
Iteration: 1445, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484007954597473, gen p mean: -0.04648183286190033, mean p set: 0.448881059885025
loss_pred:0.014037747867405415, decouple_loss:0.0014738354366272688
The modified gen p mean: 0.4477178752422333, gen p mean: -0.04747240990400314, mean p set: 0.4481981694698334The modified gen p mean: 0.44691744446754456, gen p mean: -0.04475295543670654, mean p set: 0.44739776849746704
loss_pred:0.013982263393700123, decouple_loss:0.001508242916315794
loss_pred:0.014291833154857159, decouple_loss:0.0017093609785661101
Iteration: 1446, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44660383462905884, gen p mean: -0.04538581520318985, mean p set: 0.44708412885665894
loss_pred:0.013526417315006256, decouple_loss:0.0015346335712820292
The modified gen p mean: 0.4458503723144531, gen p mean: -0.044376324862241745, mean p set: 0.4463306665420532The modified gen p mean: 0.44642341136932373, gen p mean: -0.039949074387550354, mean p set: 0.44690370559692383
loss_pred:0.013553711585700512, decouple_loss:0.0016819463344290853
loss_pred:0.014079668559134007, decouple_loss:0.0014950992772355676
Iteration: 1447, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44760170578956604, gen p mean: -0.04852893203496933, mean p set: 0.44808200001716614
loss_pred:0.012808898463845253, decouple_loss:0.0014541050186380744
The modified gen p mean: 0.4471326470375061, gen p mean: -0.044117480516433716, mean p set: 0.4476129114627838The modified gen p mean: 0.4466274380683899, gen p mean: -0.0423705130815506, mean p set: 0.44710773229599
loss_pred:0.01397054735571146, decouple_loss:0.001480781240388751
loss_pred:0.01418138388544321, decouple_loss:0.0015339571982622147
Iteration: 1448, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470151662826538, gen p mean: -0.04563344269990921, mean p set: 0.4474954903125763
loss_pred:0.014186764135956764, decouple_loss:0.0014698936138302088
The modified gen p mean: 0.44587817788124084, gen p mean: -0.047732263803482056, mean p set: 0.44635844230651855
The modified gen p mean: 0.44610586762428284, gen p mean: -0.0464823879301548, mean p set: 0.4465861916542053
loss_pred:0.01392992865294218, decouple_loss:0.001577633316628635
loss_pred:0.013454686850309372, decouple_loss:0.0015197115717455745
Iteration: 1449, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44668105244636536, gen p mean: -0.042914003133773804, mean p set: 0.44716131687164307
loss_pred:0.014135437086224556, decouple_loss:0.0013805519556626678
The modified gen p mean: 0.44722050428390503, gen p mean: -0.04353104159235954, mean p set: 0.4477007985115051The modified gen p mean: 0.44810187816619873, gen p mean: -0.0449737049639225, mean p set: 0.44858217239379883
loss_pred:0.013824030756950378, decouple_loss:0.001357651432044804
loss_pred:0.013700360432267189, decouple_loss:0.0014043989358469844
Iteration: 1450, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44497737288475037, gen p mean: -0.048618633300065994, mean p set: 0.4454576373100281
loss_pred:0.013764206320047379, decouple_loss:0.001547643099911511
The modified gen p mean: 0.4466102421283722, gen p mean: -0.04501957818865776, mean p set: 0.4470905363559723The modified gen p mean: 0.44710928201675415, gen p mean: -0.044387709349393845, mean p set: 0.44758957624435425
loss_pred:0.013158554211258888, decouple_loss:0.0015125749632716179
loss_pred:0.01368829607963562, decouple_loss:0.0014644275652244687
2023-05-01 03:49:50 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.04665817320346832, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04289059340953827, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.04274573177099228, mean p set: 0.4500633478164673
loss_pred:0.01916995272040367, decouple_loss:0.0015180844347923994
loss_pred:0.018088145181536674, decouple_loss:0.001459446270018816
loss_pred:0.018253806978464127, decouple_loss:0.0014118418330326676
WV_0_PC_1_EH_0_PS_40, loss: 0.018577124923467636, avg_mse: 0.02703375183045864
current test mse: 0.027034
Iteration: 1451, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4455787241458893, gen p mean: -0.04265149310231209, mean p set: 0.4460590183734894
The modified gen p mean: 0.44721493124961853, gen p mean: -0.04712209105491638, mean p set: 0.44769522547721863
The modified gen p mean: 0.4485968351364136, gen p mean: -0.045512717217206955, mean p set: 0.44907715916633606
loss_pred:0.01340786088258028, decouple_loss:0.0014025061391294003
loss_pred:0.01336718536913395, decouple_loss:0.0014955028891563416
loss_pred:0.013426697812974453, decouple_loss:0.0014110681368038058
Iteration: 1452, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478619694709778, gen p mean: -0.04632410407066345, mean p set: 0.4483422338962555
loss_pred:0.0136174988001585, decouple_loss:0.001539866323582828
The modified gen p mean: 0.44693711400032043, gen p mean: -0.04495170712471008, mean p set: 0.44741740822792053The modified gen p mean: 0.44673675298690796, gen p mean: -0.04122685641050339, mean p set: 0.44721704721450806
loss_pred:0.01415734738111496, decouple_loss:0.001484558219090104
loss_pred:0.013586193323135376, decouple_loss:0.001360938884317875
Iteration: 1453, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44745752215385437, gen p mean: -0.04779918119311333, mean p set: 0.44793781638145447
loss_pred:0.014156689867377281, decouple_loss:0.0014180050930008292
The modified gen p mean: 0.44622603058815, gen p mean: -0.04451775550842285, mean p set: 0.4467063546180725The modified gen p mean: 0.4469771385192871, gen p mean: -0.04441695287823677, mean p set: 0.4474574029445648
loss_pred:0.013551253825426102, decouple_loss:0.0013510765274986625
loss_pred:0.013660792261362076, decouple_loss:0.0013918245676904917
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012002_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012002_3_24hr.npz
NaN value num: 0
Iteration: 1454, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45227620005607605, gen p mean: -0.03308992460370064, mean p set: 0.45275649428367615
loss_pred:0.016336174681782722, decouple_loss:0.0015848424518480897
The modified gen p mean: 0.4501246511936188, gen p mean: -0.03962289169430733, mean p set: 0.45060494542121887The modified gen p mean: 0.4500126540660858, gen p mean: -0.04174661636352539, mean p set: 0.4504929184913635
loss_pred:0.01700892671942711, decouple_loss:0.0014723798958584666
loss_pred:0.01672353222966194, decouple_loss:0.0014034046325832605
Iteration: 1455, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478793442249298, gen p mean: -0.02897653914988041, mean p set: 0.4483596682548523
loss_pred:0.01744849607348442, decouple_loss:0.0016268054023385048
The modified gen p mean: 0.44978219270706177, gen p mean: -0.038784220814704895, mean p set: 0.45026248693466187The modified gen p mean: 0.4528353810310364, gen p mean: -0.02741689234972, mean p set: 0.4533156752586365
loss_pred:0.01697109453380108, decouple_loss:0.001537316245958209
loss_pred:0.01665833406150341, decouple_loss:0.0016540924552828074
Iteration: 1456, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513724744319916, gen p mean: -0.029338708147406578, mean p set: 0.4518527686595917
loss_pred:0.016426147893071175, decouple_loss:0.0014013219624757767
The modified gen p mean: 0.4510818123817444, gen p mean: -0.029376313090324402, mean p set: 0.45156213641166687
The modified gen p mean: 0.4504621624946594, gen p mean: -0.027814054861664772, mean p set: 0.4509424567222595
loss_pred:0.01656830497086048, decouple_loss:0.0014784347731620073
loss_pred:0.017370274290442467, decouple_loss:0.0014901702525094151
Iteration: 1457, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44982656836509705, gen p mean: -0.030887886881828308, mean p set: 0.45030689239501953
loss_pred:0.015955043956637383, decouple_loss:0.001744583249092102
The modified gen p mean: 0.44928374886512756, gen p mean: -0.02926512621343136, mean p set: 0.44976404309272766The modified gen p mean: 0.45248979330062866, gen p mean: -0.02830088511109352, mean p set: 0.45297008752822876
loss_pred:0.016637640073895454, decouple_loss:0.001605353900231421
loss_pred:0.015994302928447723, decouple_loss:0.001714071026071906
Iteration: 1458, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44997966289520264, gen p mean: -0.02731473557651043, mean p set: 0.45045995712280273
loss_pred:0.016422512009739876, decouple_loss:0.0014848968712612987
The modified gen p mean: 0.4497230648994446, gen p mean: -0.03298085555434227, mean p set: 0.4502033293247223The modified gen p mean: 0.4494591951370239, gen p mean: -0.03729051724076271, mean p set: 0.44993945956230164
loss_pred:0.016331076622009277, decouple_loss:0.0014870439190417528
loss_pred:0.016047628596425056, decouple_loss:0.0015201595379039645
Iteration: 1459, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44863754510879517, gen p mean: -0.0344390943646431, mean p set: 0.44911783933639526
loss_pred:0.01617414318025112, decouple_loss:0.0017618099227547646
The modified gen p mean: 0.4514055550098419, gen p mean: -0.03295459225773811, mean p set: 0.451885849237442The modified gen p mean: 0.44860783219337463, gen p mean: -0.0416981466114521, mean p set: 0.44908812642097473
loss_pred:0.016394970938563347, decouple_loss:0.0016735426615923643
loss_pred:0.015860360115766525, decouple_loss:0.00172921153716743
Iteration: 1460, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44915926456451416, gen p mean: -0.029093002900481224, mean p set: 0.44963955879211426
loss_pred:0.016683712601661682, decouple_loss:0.0015430544735863805
The modified gen p mean: 0.4490277171134949, gen p mean: -0.037772100418806076, mean p set: 0.4495079815387726The modified gen p mean: 0.4500269293785095, gen p mean: -0.03348824009299278, mean p set: 0.4505072236061096
loss_pred:0.016132067888975143, decouple_loss:0.0015172139974310994
loss_pred:0.01601431891322136, decouple_loss:0.001535186660476029
2023-05-01 03:52:27 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.04227877035737038, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.03835197165608406, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.038197703659534454, mean p set: 0.4500633478164673
loss_pred:0.018687784671783447, decouple_loss:0.0017776621971279383
loss_pred:0.017621740698814392, decouple_loss:0.0017690646927803755
loss_pred:0.017697790637612343, decouple_loss:0.0018347504083067179
WV_0_PC_1_EH_0_PS_40, loss: 0.01809213124215603, avg_mse: 0.026026850566267967
current test mse: 0.026027
Iteration: 1461, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44976598024368286, gen p mean: -0.03971805423498154, mean p set: 0.45024624466896057
The modified gen p mean: 0.4493011236190796, gen p mean: -0.030843576416373253, mean p set: 0.4497814178466797
The modified gen p mean: 0.4504455626010895, gen p mean: -0.03396833688020706, mean p set: 0.4509258568286896
loss_pred:0.016253964975476265, decouple_loss:0.0016143914544954896
loss_pred:0.01592113822698593, decouple_loss:0.001545292092487216
loss_pred:0.016691969707608223, decouple_loss:0.0014979748521000147
Iteration: 1462, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490024149417877, gen p mean: -0.041759297251701355, mean p set: 0.4494827091693878
loss_pred:0.0163583941757679, decouple_loss:0.0014461810933426023
The modified gen p mean: 0.4505431652069092, gen p mean: -0.04095635563135147, mean p set: 0.4510234594345093The modified gen p mean: 0.4501555562019348, gen p mean: -0.03592681139707565, mean p set: 0.4506358802318573
loss_pred:0.016405826434493065, decouple_loss:0.00148763379547745
loss_pred:0.016952715814113617, decouple_loss:0.0014103876892477274
Iteration: 1463, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45181918144226074, gen p mean: -0.0345025472342968, mean p set: 0.4522995054721832
loss_pred:0.015388166531920433, decouple_loss:0.001396128092892468
The modified gen p mean: 0.4503028690814972, gen p mean: -0.03466097265481949, mean p set: 0.4507831633090973The modified gen p mean: 0.45017823576927185, gen p mean: -0.03961612284183502, mean p set: 0.45065850019454956
loss_pred:0.01695283316075802, decouple_loss:0.001393304206430912
loss_pred:0.015860047191381454, decouple_loss:0.0014819216448813677
Iteration: 1464, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514411389827728, gen p mean: -0.03974681720137596, mean p set: 0.4519214332103729
loss_pred:0.01559017226099968, decouple_loss:0.0014054925413802266
The modified gen p mean: 0.44904351234436035, gen p mean: -0.04323836416006088, mean p set: 0.44952380657196045The modified gen p mean: 0.44969338178634644, gen p mean: -0.04293244332075119, mean p set: 0.45017367601394653
loss_pred:0.015955688431859016, decouple_loss:0.0015065802726894617
loss_pred:0.015937726944684982, decouple_loss:0.0013576511992141604
Iteration: 1465, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45199519395828247, gen p mean: -0.04345678165555, mean p set: 0.45247551798820496
loss_pred:0.016030674800276756, decouple_loss:0.0013709000777453184
The modified gen p mean: 0.4502885341644287, gen p mean: -0.04353530704975128, mean p set: 0.4507688283920288The modified gen p mean: 0.4509250223636627, gen p mean: -0.04096975177526474, mean p set: 0.45140528678894043
loss_pred:0.016678910702466965, decouple_loss:0.0015196949243545532
loss_pred:0.015753882005810738, decouple_loss:0.0016198165249079466
Iteration: 1466, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485812485218048, gen p mean: -0.03847680613398552, mean p set: 0.4490615427494049
loss_pred:0.017145341262221336, decouple_loss:0.0013180460082367063
The modified gen p mean: 0.4513234794139862, gen p mean: -0.04391113668680191, mean p set: 0.4518038034439087The modified gen p mean: 0.44893309473991394, gen p mean: -0.05196797102689743, mean p set: 0.44941338896751404
loss_pred:0.01567457616329193, decouple_loss:0.001445674686692655
loss_pred:0.015685811638832092, decouple_loss:0.0013253119541332126
Iteration: 1467, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477841854095459, gen p mean: -0.041358575224876404, mean p set: 0.4482645094394684
loss_pred:0.017064306885004044, decouple_loss:0.0013679178664460778
The modified gen p mean: 0.45141148567199707, gen p mean: -0.04052022472023964, mean p set: 0.4518917500972748The modified gen p mean: 0.4493713080883026, gen p mean: -0.045474421232938766, mean p set: 0.4498515725135803
loss_pred:0.015773147344589233, decouple_loss:0.0013606501743197441
loss_pred:0.015408665873110294, decouple_loss:0.0013423418859019876
Iteration: 1468, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485863745212555, gen p mean: -0.050057124346494675, mean p set: 0.4490666687488556
loss_pred:0.015710774809122086, decouple_loss:0.001240754616446793
The modified gen p mean: 0.4494997560977936, gen p mean: -0.03867150843143463, mean p set: 0.4499800503253937The modified gen p mean: 0.45104700326919556, gen p mean: -0.041912466287612915, mean p set: 0.45152729749679565
loss_pred:0.01689123921096325, decouple_loss:0.001293171546421945
loss_pred:0.016312990337610245, decouple_loss:0.0012712659081444144
Iteration: 1469, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44910693168640137, gen p mean: -0.04166216030716896, mean p set: 0.44958722591400146
loss_pred:0.016199015080928802, decouple_loss:0.0012389190960675478
The modified gen p mean: 0.44761791825294495, gen p mean: -0.04954937845468521, mean p set: 0.44809824228286743The modified gen p mean: 0.4514023959636688, gen p mean: -0.04293081536889076, mean p set: 0.4518826901912689
loss_pred:0.015592585317790508, decouple_loss:0.001256753457710147
loss_pred:0.01647859252989292, decouple_loss:0.0012673590099439025
Iteration: 1470, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45145854353904724, gen p mean: -0.040718331933021545, mean p set: 0.45193883776664734
loss_pred:0.015833593904972076, decouple_loss:0.0013228271855041385
The modified gen p mean: 0.4505285620689392, gen p mean: -0.04054371640086174, mean p set: 0.4510088264942169
The modified gen p mean: 0.4521656334400177, gen p mean: -0.03881659731268883, mean p set: 0.4526459276676178
loss_pred:0.015193089842796326, decouple_loss:0.001340861665084958
loss_pred:0.01599176973104477, decouple_loss:0.0013559495564550161
2023-05-01 03:54:20 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.04625461995601654, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04207272082567215, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.042226165533065796, mean p set: 0.4500633478164673
loss_pred:0.018576443195343018, decouple_loss:0.0013757864944636822
loss_pred:0.01752423867583275, decouple_loss:0.0013276926474645734
loss_pred:0.017604123800992966, decouple_loss:0.001376597792841494
WV_0_PC_1_EH_0_PS_40, loss: 0.017969604581594467, avg_mse: 0.025877362117171288
current test mse: 0.025877
Iteration: 1471, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44975754618644714, gen p mean: -0.04510986804962158, mean p set: 0.45023781061172485
The modified gen p mean: 0.4499203860759735, gen p mean: -0.035175543278455734, mean p set: 0.4504006803035736
The modified gen p mean: 0.45216304063796997, gen p mean: -0.035543620586395264, mean p set: 0.45264333486557007
loss_pred:0.01565951108932495, decouple_loss:0.0012208514381200075
loss_pred:0.016089700162410736, decouple_loss:0.0013473648577928543
loss_pred:0.01616446115076542, decouple_loss:0.0012150374241173267
Iteration: 1472, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4517676532268524, gen p mean: -0.037955015897750854, mean p set: 0.4522479474544525
loss_pred:0.01571607030928135, decouple_loss:0.0011942541459575295
The modified gen p mean: 0.448527067899704, gen p mean: -0.03982231020927429, mean p set: 0.44900739192962646
The modified gen p mean: 0.4500460922718048, gen p mean: -0.0370975062251091, mean p set: 0.4505264163017273
loss_pred:0.015348609536886215, decouple_loss:0.0013046890962868929
loss_pred:0.01625724323093891, decouple_loss:0.0013041285565122962
Iteration: 1473, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450093537569046, gen p mean: -0.04527668654918671, mean p set: 0.4505738615989685
loss_pred:0.015580031089484692, decouple_loss:0.0013120902003720403
The modified gen p mean: 0.4490102231502533, gen p mean: -0.04539681226015091, mean p set: 0.4494905471801758The modified gen p mean: 0.44890162348747253, gen p mean: -0.037629008293151855, mean p set: 0.449381947517395
loss_pred:0.015473500825464725, decouple_loss:0.0013366006314754486loss_pred:0.01640789397060871, decouple_loss:0.0012678210623562336
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012004_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012004_3_24hr.npz
NaN value num: 0
Iteration: 1474, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44786536693573, gen p mean: -0.04018314555287361, mean p set: 0.4483456313610077
loss_pred:0.014502168633043766, decouple_loss:0.0012578822206705809
The modified gen p mean: 0.4473298192024231, gen p mean: -0.044346198439598083, mean p set: 0.4478101134300232The modified gen p mean: 0.4466300308704376, gen p mean: -0.046330951154232025, mean p set: 0.4471103250980377
loss_pred:0.015027444809675217, decouple_loss:0.001247800886631012
loss_pred:0.014593325555324554, decouple_loss:0.0013463866198435426
Iteration: 1475, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44744789600372314, gen p mean: -0.042801160365343094, mean p set: 0.44792816042900085
loss_pred:0.013913631439208984, decouple_loss:0.0013013752177357674
The modified gen p mean: 0.44769221544265747, gen p mean: -0.04624919593334198, mean p set: 0.44817250967025757
The modified gen p mean: 0.44786497950553894, gen p mean: -0.042487677186727524, mean p set: 0.44834527373313904
loss_pred:0.014552757143974304, decouple_loss:0.0013450323604047298
loss_pred:0.014247330836951733, decouple_loss:0.0012862016446888447
Iteration: 1476, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44809389114379883, gen p mean: -0.05102832615375519, mean p set: 0.4485742151737213
loss_pred:0.013892688788473606, decouple_loss:0.00129994610324502
The modified gen p mean: 0.4472848176956177, gen p mean: -0.046070538461208344, mean p set: 0.4477651119232178The modified gen p mean: 0.4481167495250702, gen p mean: -0.049926940351724625, mean p set: 0.4485970735549927
loss_pred:0.013635626062750816, decouple_loss:0.0012647415278479457
loss_pred:0.014107898809015751, decouple_loss:0.0013462163042277098
Iteration: 1477, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44792696833610535, gen p mean: -0.05310656130313873, mean p set: 0.44840726256370544
loss_pred:0.014070606790482998, decouple_loss:0.0013316762633621693
The modified gen p mean: 0.44812795519828796, gen p mean: -0.05099998414516449, mean p set: 0.44860827922821045The modified gen p mean: 0.44667744636535645, gen p mean: -0.05423631891608238, mean p set: 0.44715774059295654
loss_pred:0.013952238485217094, decouple_loss:0.001348915509879589
loss_pred:0.013897575438022614, decouple_loss:0.0013605356216430664
Iteration: 1478, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44619259238243103, gen p mean: -0.053624145686626434, mean p set: 0.44667288661003113
loss_pred:0.013552716001868248, decouple_loss:0.0013947229599580169
The modified gen p mean: 0.4463234543800354, gen p mean: -0.05420055240392685, mean p set: 0.4468037486076355The modified gen p mean: 0.4466819167137146, gen p mean: -0.04968860745429993, mean p set: 0.4471621811389923
loss_pred:0.014178234152495861, decouple_loss:0.0014138560509309173
loss_pred:0.01391353365033865, decouple_loss:0.0014003077521920204
Iteration: 1479, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476127624511719, gen p mean: -0.04125986993312836, mean p set: 0.4480930268764496
The modified gen p mean: 0.4473123550415039, gen p mean: -0.0514148585498333, mean p set: 0.4477926790714264
loss_pred:0.014078711159527302, decouple_loss:0.001227426459081471
loss_pred:0.01377011463046074, decouple_loss:0.0012994921999052167
The modified gen p mean: 0.4481574296951294, gen p mean: -0.0499597042798996, mean p set: 0.4486377537250519
loss_pred:0.013861317187547684, decouple_loss:0.0012321381364017725
Iteration: 1480, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481733739376068, gen p mean: -0.04661194607615471, mean p set: 0.4486536979675293
The modified gen p mean: 0.44784215092658997, gen p mean: -0.04225490242242813, mean p set: 0.44832247495651245
loss_pred:0.013384776189923286, decouple_loss:0.0013593046460300684
loss_pred:0.014065113849937916, decouple_loss:0.0013562726089730859
The modified gen p mean: 0.44665244221687317, gen p mean: -0.04590390622615814, mean p set: 0.44713273644447327
loss_pred:0.013531627133488655, decouple_loss:0.0013872472336515784
2023-05-01 03:56:54 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.05001750588417053, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04622373357415199, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04589518532156944, mean p set: 0.4500633478164673
loss_pred:0.01914568804204464, decouple_loss:0.0013958053896203637
loss_pred:0.01808793656527996, decouple_loss:0.0013566473498940468
loss_pred:0.01825200580060482, decouple_loss:0.0013464319054037333
WV_0_PC_1_EH_0_PS_40, loss: 0.0185635257512331, avg_mse: 0.026999665424227715
current test mse: 0.027
Iteration: 1481, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476579427719116, gen p mean: -0.04874495416879654, mean p set: 0.4481382668018341
The modified gen p mean: 0.44772395491600037, gen p mean: -0.04268858581781387, mean p set: 0.44820424914360046
The modified gen p mean: 0.44606471061706543, gen p mean: -0.05036238208413124, mean p set: 0.4465450048446655
loss_pred:0.013728557154536247, decouple_loss:0.0012716050259768963
loss_pred:0.013261488638818264, decouple_loss:0.0013022217899560928
loss_pred:0.01381576806306839, decouple_loss:0.0013159906957298517
Iteration: 1482, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44733962416648865, gen p mean: -0.04856611043214798, mean p set: 0.44781988859176636
loss_pred:0.013940411619842052, decouple_loss:0.0012492709793150425
The modified gen p mean: 0.44782301783561707, gen p mean: -0.0560564324259758, mean p set: 0.44830334186553955
The modified gen p mean: 0.4466976225376129, gen p mean: -0.04600219428539276, mean p set: 0.447177916765213
loss_pred:0.013509277254343033, decouple_loss:0.0013080467469990253
loss_pred:0.013489904813468456, decouple_loss:0.0013493505539372563
Iteration: 1483, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4460369944572449, gen p mean: -0.05172564834356308, mean p set: 0.44651728868484497
loss_pred:0.013382934965193272, decouple_loss:0.0013166131684556603
The modified gen p mean: 0.4473423361778259, gen p mean: -0.054282933473587036, mean p set: 0.447822630405426The modified gen p mean: 0.4466927945613861, gen p mean: -0.05429799482226372, mean p set: 0.4471730887889862
loss_pred:0.013878706842660904, decouple_loss:0.0013651885092258453
loss_pred:0.013202804140746593, decouple_loss:0.0012995490105822682
Iteration: 1484, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470152258872986, gen p mean: -0.05746149271726608, mean p set: 0.4474954903125763
loss_pred:0.014113585464656353, decouple_loss:0.0012095384299755096
The modified gen p mean: 0.4483369290828705, gen p mean: -0.053082726895809174, mean p set: 0.4488171935081482The modified gen p mean: 0.44716641306877136, gen p mean: -0.04862268641591072, mean p set: 0.44764673709869385
loss_pred:0.013204336166381836, decouple_loss:0.0012161987833678722
loss_pred:0.013607628643512726, decouple_loss:0.0012062746100127697
Iteration: 1485, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44827932119369507, gen p mean: -0.05907956510782242, mean p set: 0.44875964522361755
loss_pred:0.01327264029532671, decouple_loss:0.0013108487473800778
The modified gen p mean: 0.44751399755477905, gen p mean: -0.050645776093006134, mean p set: 0.44799429178237915The modified gen p mean: 0.44763290882110596, gen p mean: -0.059065137058496475, mean p set: 0.44811320304870605
loss_pred:0.013343874365091324, decouple_loss:0.0013077538460493088
loss_pred:0.013102215714752674, decouple_loss:0.0011987013276666403
Iteration: 1486, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44777384400367737, gen p mean: -0.05791092664003372, mean p set: 0.4482541084289551
loss_pred:0.01360978465527296, decouple_loss:0.0011976921232417226
The modified gen p mean: 0.4483192265033722, gen p mean: -0.04896204546093941, mean p set: 0.4487995207309723The modified gen p mean: 0.44809916615486145, gen p mean: -0.052561454474925995, mean p set: 0.44857946038246155
loss_pred:0.013070651330053806, decouple_loss:0.001232047681696713
loss_pred:0.013625474646687508, decouple_loss:0.001188336405903101
Iteration: 1487, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44733601808547974, gen p mean: -0.0542154535651207, mean p set: 0.44781628251075745
loss_pred:0.013733224011957645, decouple_loss:0.0012084899935871363
The modified gen p mean: 0.44762372970581055, gen p mean: -0.05345039442181587, mean p set: 0.44810402393341064The modified gen p mean: 0.4468432366847992, gen p mean: -0.051946114748716354, mean p set: 0.4473235309123993
loss_pred:0.013633365742862225, decouple_loss:0.0012218860210850835
loss_pred:0.013184117153286934, decouple_loss:0.0012719281949102879
Iteration: 1488, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448651522397995, gen p mean: -0.044737059623003006, mean p set: 0.4491317868232727
loss_pred:0.013140041381120682, decouple_loss:0.0013201244873926044
The modified gen p mean: 0.4458563029766083, gen p mean: -0.050264786928892136, mean p set: 0.446336567401886
The modified gen p mean: 0.4462665021419525, gen p mean: -0.046520672738552094, mean p set: 0.4467467665672302
loss_pred:0.013205642811954021, decouple_loss:0.001208331435918808
loss_pred:0.013286080211400986, decouple_loss:0.00147631682921201
Iteration: 1489, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480590522289276, gen p mean: -0.045450884848833084, mean p set: 0.4485393166542053
loss_pred:0.013241001404821873, decouple_loss:0.0013591136084869504
The modified gen p mean: 0.44804468750953674, gen p mean: -0.04566147178411484, mean p set: 0.44852498173713684The modified gen p mean: 0.44725465774536133, gen p mean: -0.04686802998185158, mean p set: 0.44773492217063904
loss_pred:0.013701050542294979, decouple_loss:0.001228446140885353
loss_pred:0.01338849775493145, decouple_loss:0.001187401358038187
Iteration: 1490, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44727715849876404, gen p mean: -0.051137734204530716, mean p set: 0.44775745272636414
loss_pred:0.013279174454510212, decouple_loss:0.0012138530146330595
The modified gen p mean: 0.447194367647171, gen p mean: -0.04242092743515968, mean p set: 0.4476746618747711The modified gen p mean: 0.4481970965862274, gen p mean: -0.04380009323358536, mean p set: 0.4486773908138275
loss_pred:0.013653358444571495, decouple_loss:0.001211462658829987
loss_pred:0.013003733940422535, decouple_loss:0.0012358268722891808
2023-05-01 03:58:47 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.0500679574906826, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04645382985472679, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.04619993269443512, mean p set: 0.4500633478164673
loss_pred:0.019177794456481934, decouple_loss:0.0014290346298366785
loss_pred:0.01814023032784462, decouple_loss:0.00134486542083323
loss_pred:0.018220797181129456, decouple_loss:0.0013604344567283988
WV_0_PC_1_EH_0_PS_40, loss: 0.018581848591566086, avg_mse: 0.02709091827273369
current test mse: 0.027091
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1491, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44795337319374084, gen p mean: -0.04853538051247597, mean p set: 0.44843369722366333
The modified gen p mean: 0.44642502069473267, gen p mean: -0.04551251605153084, mean p set: 0.4469052851200104
The modified gen p mean: 0.4455784261226654, gen p mean: -0.04271946847438812, mean p set: 0.4460587203502655
loss_pred:0.013235103338956833, decouple_loss:0.0013723531737923622
loss_pred:0.013215788640081882, decouple_loss:0.0013258133549243212
loss_pred:0.01337948627769947, decouple_loss:0.0013960045762360096
Iteration: 1492, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475368559360504, gen p mean: -0.04359354078769684, mean p set: 0.4480171501636505
loss_pred:0.013763691298663616, decouple_loss:0.0012621070491150022
The modified gen p mean: 0.44732123613357544, gen p mean: -0.05146562680602074, mean p set: 0.44780153036117554The modified gen p mean: 0.4474705159664154, gen p mean: -0.04437560215592384, mean p set: 0.4479508101940155
loss_pred:0.01357580441981554, decouple_loss:0.0013151230523362756
loss_pred:0.013895214535295963, decouple_loss:0.0012374105863273144
Iteration: 1493, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479922950267792, gen p mean: -0.04687374457716942, mean p set: 0.4484725892543793
loss_pred:0.012941520661115646, decouple_loss:0.001185699482448399
The modified gen p mean: 0.4467615783214569, gen p mean: -0.04947318136692047, mean p set: 0.447241872549057The modified gen p mean: 0.4486333727836609, gen p mean: -0.0495651550590992, mean p set: 0.449113667011261
loss_pred:0.013767230324447155, decouple_loss:0.0012310174060985446
loss_pred:0.013484439812600613, decouple_loss:0.0011910642497241497
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012007_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012007_3_24hr.npz
NaN value num: 0
Iteration: 1494, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4534832239151001, gen p mean: -0.041848525404930115, mean p set: 0.4539635181427002
loss_pred:0.01721007004380226, decouple_loss:0.0015388858737424016
The modified gen p mean: 0.45081081986427307, gen p mean: -0.041844356805086136, mean p set: 0.45129111409187317The modified gen p mean: 0.4511910676956177, gen p mean: -0.040635768324136734, mean p set: 0.4516713619232178
loss_pred:0.018030202016234398, decouple_loss:0.0014496420044451952
loss_pred:0.01744348183274269, decouple_loss:0.001578470808453858
Iteration: 1495, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4518057405948639, gen p mean: -0.03697197511792183, mean p set: 0.4522860050201416
loss_pred:0.016961993649601936, decouple_loss:0.0012490589870139956
The modified gen p mean: 0.4531993865966797, gen p mean: -0.04536166042089462, mean p set: 0.4536796808242798The modified gen p mean: 0.45036694407463074, gen p mean: -0.03354131802916527, mean p set: 0.45084720849990845
loss_pred:0.01753581501543522, decouple_loss:0.001211349735967815
loss_pred:0.01734762452542782, decouple_loss:0.0012822260614484549
Iteration: 1496, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4516116976737976, gen p mean: -0.041886333376169205, mean p set: 0.4520919919013977
loss_pred:0.017004910856485367, decouple_loss:0.0013782638125121593
The modified gen p mean: 0.44957560300827026, gen p mean: -0.040526263415813446, mean p set: 0.45005589723587036The modified gen p mean: 0.4503123462200165, gen p mean: -0.04071640968322754, mean p set: 0.45079267024993896
loss_pred:0.017552847042679787, decouple_loss:0.0013788791839033365
loss_pred:0.01709788292646408, decouple_loss:0.0014823316596448421
Iteration: 1497, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4516301155090332, gen p mean: -0.030129285529255867, mean p set: 0.4521104097366333
loss_pred:0.01671241968870163, decouple_loss:0.0013511459110304713
The modified gen p mean: 0.4494204521179199, gen p mean: -0.037840500473976135, mean p set: 0.44990074634552The modified gen p mean: 0.4499392807483673, gen p mean: -0.030129868537187576, mean p set: 0.450419545173645
loss_pred:0.01849750243127346, decouple_loss:0.0014115620870143175
loss_pred:0.01745542883872986, decouple_loss:0.0012755078496411443
Iteration: 1498, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496087431907654, gen p mean: -0.039089422672986984, mean p set: 0.4500890374183655
loss_pred:0.017617609351873398, decouple_loss:0.0012977274600416422
The modified gen p mean: 0.4534813165664673, gen p mean: -0.03289463371038437, mean p set: 0.4539616107940674The modified gen p mean: 0.45196688175201416, gen p mean: -0.040290746837854385, mean p set: 0.45244714617729187
loss_pred:0.017984582111239433, decouple_loss:0.001274669193662703
loss_pred:0.017097238451242447, decouple_loss:0.0012898350832983851
Iteration: 1499, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45065465569496155, gen p mean: -0.03637223690748215, mean p set: 0.45113492012023926
loss_pred:0.01760168746113777, decouple_loss:0.0012601083144545555
The modified gen p mean: 0.45182591676712036, gen p mean: -0.04044423997402191, mean p set: 0.45230618119239807The modified gen p mean: 0.45176780223846436, gen p mean: -0.040897566825151443, mean p set: 0.45224812626838684
loss_pred:0.018133891746401787, decouple_loss:0.0012582007329910994
loss_pred:0.016477111726999283, decouple_loss:0.0011840573279187083
Iteration: 1500, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4530189633369446, gen p mean: -0.03502040356397629, mean p set: 0.4534992575645447
loss_pred:0.017371132969856262, decouple_loss:0.0012476322008296847
The modified gen p mean: 0.45048460364341736, gen p mean: -0.03549346327781677, mean p set: 0.45096486806869507The modified gen p mean: 0.45251893997192383, gen p mean: -0.04104488715529442, mean p set: 0.45299920439720154
loss_pred:0.018062831833958626, decouple_loss:0.0013236543163657188
loss_pred:0.0170857273042202, decouple_loss:0.0013195808278396726
2023-05-01 04:01:28 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.044901832938194275, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04096987098455429, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.040849290788173676, mean p set: 0.4500633478164673
loss_pred:0.018519863486289978, decouple_loss:0.0014488688902929425
loss_pred:0.01761319860816002, decouple_loss:0.0013818303123116493
loss_pred:0.01752854511141777, decouple_loss:0.0014608094934374094
WV_0_PC_1_EH_0_PS_40, loss: 0.017958728596568108, avg_mse: 0.025839602574706078
current test mse: 0.02584
Iteration: 1501, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45197048783302307, gen p mean: -0.03718393296003342, mean p set: 0.45245081186294556
The modified gen p mean: 0.45001882314682007, gen p mean: -0.0429193340241909, mean p set: 0.45049911737442017
The modified gen p mean: 0.45097777247428894, gen p mean: -0.03556051850318909, mean p set: 0.4514580965042114
loss_pred:0.016866562888026237, decouple_loss:0.0013176117790862918
loss_pred:0.017094077542424202, decouple_loss:0.0012733943294733763
loss_pred:0.016952116042375565, decouple_loss:0.0013577938079833984
Iteration: 1502, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4512470066547394, gen p mean: -0.035633064806461334, mean p set: 0.4517273008823395
loss_pred:0.01705005206167698, decouple_loss:0.0012790545588359237
The modified gen p mean: 0.4545752704143524, gen p mean: -0.043227363377809525, mean p set: 0.4550555646419525The modified gen p mean: 0.44939470291137695, gen p mean: -0.044070765376091, mean p set: 0.44987502694129944
loss_pred:0.01744743064045906, decouple_loss:0.0012598377652466297
loss_pred:0.01631801575422287, decouple_loss:0.001489419722929597
Iteration: 1503, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44842663407325745, gen p mean: -0.03942381590604782, mean p set: 0.44890692830085754
loss_pred:0.017779221758246422, decouple_loss:0.0013430933468043804
The modified gen p mean: 0.4517209827899933, gen p mean: -0.03806460648775101, mean p set: 0.452201247215271The modified gen p mean: 0.45131629705429077, gen p mean: -0.03577718883752823, mean p set: 0.45179659128189087
loss_pred:0.01750769466161728, decouple_loss:0.0012842764845117927
loss_pred:0.01732991263270378, decouple_loss:0.0013631995534524322
Iteration: 1504, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503883719444275, gen p mean: -0.0383969247341156, mean p set: 0.45086869597435
loss_pred:0.017704421654343605, decouple_loss:0.0012817755341529846
The modified gen p mean: 0.45170649886131287, gen p mean: -0.033735573291778564, mean p set: 0.4521867632865906The modified gen p mean: 0.45218250155448914, gen p mean: -0.042740434408187866, mean p set: 0.45266276597976685
loss_pred:0.016778672114014626, decouple_loss:0.001178201986476779
loss_pred:0.01674245111644268, decouple_loss:0.0012567732483148575
Iteration: 1505, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450214147567749, gen p mean: -0.044295523315668106, mean p set: 0.4506944417953491
loss_pred:0.01691443659365177, decouple_loss:0.001285938429646194
The modified gen p mean: 0.44988036155700684, gen p mean: -0.04128444194793701, mean p set: 0.4503606855869293The modified gen p mean: 0.448466032743454, gen p mean: -0.04496913030743599, mean p set: 0.4489463269710541
loss_pred:0.017913270741701126, decouple_loss:0.0012574625434353948
loss_pred:0.017101841047406197, decouple_loss:0.0012046736665070057
Iteration: 1506, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44948071241378784, gen p mean: -0.04618828371167183, mean p set: 0.44996097683906555
loss_pred:0.016843516379594803, decouple_loss:0.0012810772750526667
The modified gen p mean: 0.4512324929237366, gen p mean: -0.047726649791002274, mean p set: 0.45171278715133667
The modified gen p mean: 0.4514771103858948, gen p mean: -0.04895962029695511, mean p set: 0.4519573748111725
loss_pred:0.017378821969032288, decouple_loss:0.0012999483151361346
loss_pred:0.016692636534571648, decouple_loss:0.0013100657379254699
Iteration: 1507, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.451885849237442, gen p mean: -0.050612300634384155, mean p set: 0.4523661732673645
loss_pred:0.01729920133948326, decouple_loss:0.0012366690207272768
The modified gen p mean: 0.45285338163375854, gen p mean: -0.04815572127699852, mean p set: 0.45333370566368103The modified gen p mean: 0.45149412751197815, gen p mean: -0.05145854875445366, mean p set: 0.45197439193725586
loss_pred:0.016915151849389076, decouple_loss:0.0012254950124770403
loss_pred:0.01696942374110222, decouple_loss:0.001237130374647677
Iteration: 1508, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4523911774158478, gen p mean: -0.053406912833452225, mean p set: 0.4528714418411255
loss_pred:0.016449684277176857, decouple_loss:0.0012328361626714468
The modified gen p mean: 0.4515712857246399, gen p mean: -0.04667745530605316, mean p set: 0.4520516097545624The modified gen p mean: 0.4500791132450104, gen p mean: -0.056761592626571655, mean p set: 0.4505594074726105
loss_pred:0.01633625477552414, decouple_loss:0.001226750435307622
loss_pred:0.016617674380540848, decouple_loss:0.001304993056692183
Iteration: 1509, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501040279865265, gen p mean: -0.046120453625917435, mean p set: 0.4505843222141266
loss_pred:0.01798337884247303, decouple_loss:0.0012909633805975318
The modified gen p mean: 0.45146387815475464, gen p mean: -0.05256633833050728, mean p set: 0.45194417238235474The modified gen p mean: 0.45008569955825806, gen p mean: -0.04829522594809532, mean p set: 0.45056599378585815
loss_pred:0.016875475645065308, decouple_loss:0.0012136184377595782
loss_pred:0.01801433227956295, decouple_loss:0.0012842942960560322
Iteration: 1510, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500962197780609, gen p mean: -0.054248057305812836, mean p set: 0.450576514005661
loss_pred:0.016372427344322205, decouple_loss:0.0011935430811718106
The modified gen p mean: 0.4517892897129059, gen p mean: -0.05285567417740822, mean p set: 0.452269583940506The modified gen p mean: 0.4551624655723572, gen p mean: -0.055663928389549255, mean p set: 0.45564278960227966
loss_pred:0.016786741092801094, decouple_loss:0.0011853426694869995
loss_pred:0.01645583286881447, decouple_loss:0.001284066354855895
2023-05-01 04:03:21 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.057149965316057205, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.053590625524520874, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.05344058945775032, mean p set: 0.4500633478164673
loss_pred:0.01840095967054367, decouple_loss:0.001446492737159133
loss_pred:0.01741058938205242, decouple_loss:0.0015432635555043817
loss_pred:0.017495591193437576, decouple_loss:0.0014782502548769116
WV_0_PC_1_EH_0_PS_40, loss: 0.017843514680862427, avg_mse: 0.02558947540819645
current test mse: 0.025589
Iteration: 1511, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45101702213287354, gen p mean: -0.04907406121492386, mean p set: 0.45149728655815125
The modified gen p mean: 0.45125308632850647, gen p mean: -0.05199796333909035, mean p set: 0.45173338055610657
The modified gen p mean: 0.45448148250579834, gen p mean: -0.05766763910651207, mean p set: 0.45496177673339844
loss_pred:0.01669284515082836, decouple_loss:0.0014974646037444472
loss_pred:0.018201950937509537, decouple_loss:0.0014383775414898992
loss_pred:0.017185071483254433, decouple_loss:0.001507986569777131
Iteration: 1512, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513186514377594, gen p mean: -0.05006907507777214, mean p set: 0.4517989158630371
loss_pred:0.01720522716641426, decouple_loss:0.0011836857302114367
The modified gen p mean: 0.45173612236976624, gen p mean: -0.05450267717242241, mean p set: 0.45221641659736633The modified gen p mean: 0.4504697918891907, gen p mean: -0.04232603311538696, mean p set: 0.45095011591911316
loss_pred:0.016647962853312492, decouple_loss:0.001187759917229414
loss_pred:0.016889164224267006, decouple_loss:0.0011437045177444816
Iteration: 1513, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508230984210968, gen p mean: -0.0466073676943779, mean p set: 0.4513033628463745
loss_pred:0.01714049093425274, decouple_loss:0.0012191473506391048
The modified gen p mean: 0.4497041702270508, gen p mean: -0.04786050319671631, mean p set: 0.4501844644546509The modified gen p mean: 0.45053309202194214, gen p mean: -0.048552338033914566, mean p set: 0.45101335644721985
loss_pred:0.017564719542860985, decouple_loss:0.001336782006546855
loss_pred:0.017216870561242104, decouple_loss:0.0012665599351748824
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012002_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012002_3_24hr.npz
NaN value num: 0
Iteration: 1514, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44840124249458313, gen p mean: -0.0446169376373291, mean p set: 0.4488815367221832
loss_pred:0.015685642138123512, decouple_loss:0.0011099791154265404
The modified gen p mean: 0.4489038288593292, gen p mean: -0.043561793863773346, mean p set: 0.4493841528892517The modified gen p mean: 0.4489430785179138, gen p mean: -0.04811282828450203, mean p set: 0.4494233727455139
loss_pred:0.015264445915818214, decouple_loss:0.0012175013544037938
loss_pred:0.015120386146008968, decouple_loss:0.0011430575978010893
Iteration: 1515, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44738537073135376, gen p mean: -0.04161916673183441, mean p set: 0.44786569476127625
loss_pred:0.014432402327656746, decouple_loss:0.0013124074321240187
The modified gen p mean: 0.4493548274040222, gen p mean: -0.0447276346385479, mean p set: 0.4498351216316223
The modified gen p mean: 0.4490741789340973, gen p mean: -0.038175251334905624, mean p set: 0.449554443359375
loss_pred:0.014684668742120266, decouple_loss:0.0013339417055249214
loss_pred:0.015059225261211395, decouple_loss:0.0012677822960540652
Iteration: 1516, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500373601913452, gen p mean: -0.03783423826098442, mean p set: 0.4505176842212677
The modified gen p mean: 0.44811615347862244, gen p mean: -0.04485204070806503, mean p set: 0.44859644770622253
loss_pred:0.014438960701227188, decouple_loss:0.0012542444746941328
loss_pred:0.014395356178283691, decouple_loss:0.0013152327155694366
The modified gen p mean: 0.44872623682022095, gen p mean: -0.045884475111961365, mean p set: 0.44920656085014343
loss_pred:0.01471127662807703, decouple_loss:0.0013009307440370321
Iteration: 1517, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44798243045806885, gen p mean: -0.04875469580292702, mean p set: 0.44846272468566895
loss_pred:0.013631054200232029, decouple_loss:0.0012345158029347658
The modified gen p mean: 0.4489346146583557, gen p mean: -0.04928123205900192, mean p set: 0.4494149386882782The modified gen p mean: 0.44669434428215027, gen p mean: -0.05210898444056511, mean p set: 0.447174608707428
loss_pred:0.014397652819752693, decouple_loss:0.001190275652334094
loss_pred:0.014743770472705364, decouple_loss:0.0012761084362864494
Iteration: 1518, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44841739535331726, gen p mean: -0.045230306684970856, mean p set: 0.44889771938323975
loss_pred:0.014729894697666168, decouple_loss:0.001256706309504807
The modified gen p mean: 0.448194295167923, gen p mean: -0.04631899669766426, mean p set: 0.44867458939552307The modified gen p mean: 0.448076993227005, gen p mean: -0.04520270973443985, mean p set: 0.4485572874546051
loss_pred:0.014717058278620243, decouple_loss:0.001267721294425428
loss_pred:0.01457784604281187, decouple_loss:0.0012002732837572694
Iteration: 1519, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44915971159935, gen p mean: -0.05094122141599655, mean p set: 0.4496400058269501
loss_pred:0.01409466564655304, decouple_loss:0.001376527827233076
The modified gen p mean: 0.44975507259368896, gen p mean: -0.03864254802465439, mean p set: 0.4502353370189667The modified gen p mean: 0.44734761118888855, gen p mean: -0.04182887449860573, mean p set: 0.44782793521881104
loss_pred:0.014267698861658573, decouple_loss:0.0012683175737038255
loss_pred:0.014681284315884113, decouple_loss:0.0012261068914085627
Iteration: 1520, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44856274127960205, gen p mean: -0.04516179487109184, mean p set: 0.44904303550720215
loss_pred:0.014366733841598034, decouple_loss:0.0013269084738567472
The modified gen p mean: 0.4490821361541748, gen p mean: -0.044284772127866745, mean p set: 0.4495624303817749The modified gen p mean: 0.4516567587852478, gen p mean: -0.0411236509680748, mean p set: 0.4521370232105255
loss_pred:0.013968260958790779, decouple_loss:0.0014231496024876833
loss_pred:0.01431205589324236, decouple_loss:0.0014305313816294074
2023-05-01 04:06:00 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.04724449664354324, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.044005248695611954, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.043603312224149704, mean p set: 0.4500633478164673
loss_pred:0.019313465803861618, decouple_loss:0.001337327528744936
loss_pred:0.01821112632751465, decouple_loss:0.0014574226224794984loss_pred:0.018297234550118446, decouple_loss:0.0013591763563454151
WV_0_PC_1_EH_0_PS_40, loss: 0.018676508218050003, avg_mse: 0.027183089405298233
current test mse: 0.027183
Iteration: 1521, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486274719238281, gen p mean: -0.0422733873128891, mean p set: 0.44910773634910583
The modified gen p mean: 0.4478560984134674, gen p mean: -0.04635978117585182, mean p set: 0.4483363628387451
The modified gen p mean: 0.4476599097251892, gen p mean: -0.04383743926882744, mean p set: 0.4481402039527893
loss_pred:0.013815108686685562, decouple_loss:0.0013237729435786605
loss_pred:0.013456032611429691, decouple_loss:0.0014203564496710896
loss_pred:0.014291820116341114, decouple_loss:0.0012934121768921614
Iteration: 1522, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472677409648895, gen p mean: -0.040387678891420364, mean p set: 0.447748064994812
loss_pred:0.013726532459259033, decouple_loss:0.0013275448000058532
The modified gen p mean: 0.4488476812839508, gen p mean: -0.048988066613674164, mean p set: 0.4493279755115509The modified gen p mean: 0.4491240084171295, gen p mean: -0.049303267151117325, mean p set: 0.4496042728424072
loss_pred:0.012876071035861969, decouple_loss:0.0015106636565178633
loss_pred:0.012930016033351421, decouple_loss:0.001511078211478889
Iteration: 1523, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44839343428611755, gen p mean: -0.047124333679676056, mean p set: 0.44887375831604004
loss_pred:0.014504273422062397, decouple_loss:0.0014820507494732738
The modified gen p mean: 0.44819360971450806, gen p mean: -0.051943447440862656, mean p set: 0.44867387413978577The modified gen p mean: 0.4471130073070526, gen p mean: -0.055326174944639206, mean p set: 0.4475933015346527
loss_pred:0.01404255535453558, decouple_loss:0.0015282758977264166
loss_pred:0.013732146471738815, decouple_loss:0.0015262161614373326
Iteration: 1524, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474971890449524, gen p mean: -0.05030294880270958, mean p set: 0.4479774832725525
loss_pred:0.013523521833121777, decouple_loss:0.0014505225699394941
The modified gen p mean: 0.4476976692676544, gen p mean: -0.048070941120386124, mean p set: 0.4481779932975769The modified gen p mean: 0.44961124658584595, gen p mean: -0.053745318204164505, mean p set: 0.45009157061576843
loss_pred:0.014471166767179966, decouple_loss:0.0014205926563590765
loss_pred:0.013197890482842922, decouple_loss:0.0015368600143119693
Iteration: 1525, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486962556838989, gen p mean: -0.049217648804187775, mean p set: 0.449176549911499
loss_pred:0.013813254423439503, decouple_loss:0.001439388724975288
The modified gen p mean: 0.4472696781158447, gen p mean: -0.0546969398856163, mean p set: 0.4477499723434448The modified gen p mean: 0.4507500231266022, gen p mean: -0.047735005617141724, mean p set: 0.45123034715652466
loss_pred:0.013639078475534916, decouple_loss:0.0013679402181878686
loss_pred:0.013716614805161953, decouple_loss:0.0014475322095677257
Iteration: 1526, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447256863117218, gen p mean: -0.047371864318847656, mean p set: 0.4477371871471405
loss_pred:0.013898915611207485, decouple_loss:0.0014605607138946652
The modified gen p mean: 0.4499562680721283, gen p mean: -0.04317314550280571, mean p set: 0.4504365622997284
The modified gen p mean: 0.449799120426178, gen p mean: -0.051138781011104584, mean p set: 0.4502794146537781
loss_pred:0.013755504041910172, decouple_loss:0.0014670449309051037
loss_pred:0.013409317471086979, decouple_loss:0.0014468651497736573
Iteration: 1527, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474261701107025, gen p mean: -0.05263170227408409, mean p set: 0.4479064643383026
loss_pred:0.01349988766014576, decouple_loss:0.001485193963162601
The modified gen p mean: 0.4474162757396698, gen p mean: -0.05150735378265381, mean p set: 0.4478965699672699The modified gen p mean: 0.448757529258728, gen p mean: -0.05056361109018326, mean p set: 0.44923779368400574
loss_pred:0.013608397915959358, decouple_loss:0.0013928115367889404
loss_pred:0.013868125155568123, decouple_loss:0.0014557783724740148
Iteration: 1528, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44836610555648804, gen p mean: -0.04833687096834183, mean p set: 0.44884639978408813
loss_pred:0.013325034640729427, decouple_loss:0.0014818935887888074
The modified gen p mean: 0.4469147026538849, gen p mean: -0.04269740730524063, mean p set: 0.447394996881485The modified gen p mean: 0.4490068554878235, gen p mean: -0.05158374831080437, mean p set: 0.4494871497154236
loss_pred:0.013145347125828266, decouple_loss:0.0013997278874740005
loss_pred:0.012457935139536858, decouple_loss:0.0017099956749007106
Iteration: 1529, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474325478076935, gen p mean: -0.037930067628622055, mean p set: 0.4479128420352936
loss_pred:0.013370386324822903, decouple_loss:0.0013630330795422196
The modified gen p mean: 0.44975852966308594, gen p mean: -0.04326360300183296, mean p set: 0.45023879408836365
The modified gen p mean: 0.44819745421409607, gen p mean: -0.04402152821421623, mean p set: 0.44867774844169617
loss_pred:0.013618744909763336, decouple_loss:0.001378853339701891
loss_pred:0.013669822365045547, decouple_loss:0.001433605677448213
Iteration: 1530, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488057792186737, gen p mean: -0.03372823819518089, mean p set: 0.4492860734462738
loss_pred:0.013599398545920849, decouple_loss:0.0014391692820936441
The modified gen p mean: 0.44766318798065186, gen p mean: -0.034471455961465836, mean p set: 0.44814345240592957The modified gen p mean: 0.44972044229507446, gen p mean: -0.043591491878032684, mean p set: 0.45020073652267456
loss_pred:0.012807227671146393, decouple_loss:0.0013859908794984221
loss_pred:0.014023996889591217, decouple_loss:0.0014073294587433338
2023-05-01 04:07:53 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.04203956201672554, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.038496170192956924, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.038002029061317444, mean p set: 0.4500633478164673
loss_pred:0.019357535988092422, decouple_loss:0.0014011524617671967
loss_pred:0.01823071390390396, decouple_loss:0.0014527078019455075
loss_pred:0.018352432176470757, decouple_loss:0.001325001590885222
WV_0_PC_1_EH_0_PS_40, loss: 0.018716542050242424, avg_mse: 0.027330422773957253
current test mse: 0.02733
Iteration: 1531, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44862765073776245, gen p mean: -0.040224067866802216, mean p set: 0.44910797476768494
The modified gen p mean: 0.4467901289463043, gen p mean: -0.039653003215789795, mean p set: 0.4472704529762268
The modified gen p mean: 0.44837766885757446, gen p mean: -0.03751157224178314, mean p set: 0.44885799288749695
loss_pred:0.013309817761182785, decouple_loss:0.0013313725357875228
loss_pred:0.012952635996043682, decouple_loss:0.0013765888288617134
loss_pred:0.013426839374005795, decouple_loss:0.00142098858486861
Iteration: 1532, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44785282015800476, gen p mean: -0.036401405930519104, mean p set: 0.44833314418792725
loss_pred:0.013987166807055473, decouple_loss:0.0014065357390791178
The modified gen p mean: 0.4475484788417816, gen p mean: -0.03598643094301224, mean p set: 0.4480287730693817The modified gen p mean: 0.4501930773258209, gen p mean: -0.03227729722857475, mean p set: 0.45067334175109863
loss_pred:0.014386355876922607, decouple_loss:0.0012424972373992205
loss_pred:0.013317215256392956, decouple_loss:0.001293630339205265
Iteration: 1533, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44795358180999756, gen p mean: -0.04295356199145317, mean p set: 0.44843384623527527
loss_pred:0.013650096021592617, decouple_loss:0.0012559728929772973
The modified gen p mean: 0.4488906264305115, gen p mean: -0.04448913037776947, mean p set: 0.4493709206581116The modified gen p mean: 0.44755735993385315, gen p mean: -0.04092729836702347, mean p set: 0.44803765416145325
loss_pred:0.01335608959197998, decouple_loss:0.0012939850566908717
loss_pred:0.013488884083926678, decouple_loss:0.0013106327969580889
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012009_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012009_3_24hr.npz
NaN value num: 0
Iteration: 1534, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483204185962677, gen p mean: -0.047405075281858444, mean p set: 0.4488007128238678
loss_pred:0.014166374690830708, decouple_loss:0.0011843167012557387
The modified gen p mean: 0.44821032881736755, gen p mean: -0.04772608354687691, mean p set: 0.44869065284729004The modified gen p mean: 0.448018342256546, gen p mean: -0.048562631011009216, mean p set: 0.4484986364841461
loss_pred:0.014162441715598106, decouple_loss:0.0011960630072280765
loss_pred:0.013988437131047249, decouple_loss:0.0011975206434726715
Iteration: 1535, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464246928691864, gen p mean: -0.051928356289863586, mean p set: 0.4469049572944641
loss_pred:0.014400084502995014, decouple_loss:0.001338968169875443
The modified gen p mean: 0.447794646024704, gen p mean: -0.04320991784334183, mean p set: 0.44827497005462646The modified gen p mean: 0.4471273422241211, gen p mean: -0.04854783043265343, mean p set: 0.4476076066493988
loss_pred:0.013835746794939041, decouple_loss:0.0013172166654840112
loss_pred:0.01402335986495018, decouple_loss:0.0012633136939257383
Iteration: 1536, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44558775424957275, gen p mean: -0.05342289060354233, mean p set: 0.44606801867485046
loss_pred:0.014060788787901402, decouple_loss:0.0012720486847683787
The modified gen p mean: 0.4461471736431122, gen p mean: -0.05313432961702347, mean p set: 0.4466274678707123The modified gen p mean: 0.44930770993232727, gen p mean: -0.04934046044945717, mean p set: 0.449787974357605
loss_pred:0.01383218728005886, decouple_loss:0.0013629051391035318
loss_pred:0.014344623312354088, decouple_loss:0.0012608584947884083
Iteration: 1537, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44909849762916565, gen p mean: -0.05055497959256172, mean p set: 0.44957879185676575
loss_pred:0.01374961156398058, decouple_loss:0.001353682018816471
The modified gen p mean: 0.44623613357543945, gen p mean: -0.05467817559838295, mean p set: 0.44671642780303955The modified gen p mean: 0.4487951695919037, gen p mean: -0.043754544109106064, mean p set: 0.4492754638195038
loss_pred:0.013900642283260822, decouple_loss:0.0012434389209374785
loss_pred:0.013910423964262009, decouple_loss:0.0012527134967967868
Iteration: 1538, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470822811126709, gen p mean: -0.04667875915765762, mean p set: 0.447562575340271
loss_pred:0.013877486810088158, decouple_loss:0.0013137293281033635
The modified gen p mean: 0.4475298225879669, gen p mean: -0.04741183668375015, mean p set: 0.44801008701324463The modified gen p mean: 0.44688740372657776, gen p mean: -0.0437336303293705, mean p set: 0.44736772775650024
loss_pred:0.01389631349593401, decouple_loss:0.001323227770626545
loss_pred:0.01382668036967516, decouple_loss:0.0013602420222014189
Iteration: 1539, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474327564239502, gen p mean: -0.040136247873306274, mean p set: 0.4479130506515503
loss_pred:0.01379397138953209, decouple_loss:0.0013249688781797886
The modified gen p mean: 0.44727686047554016, gen p mean: -0.0422477163374424, mean p set: 0.44775715470314026The modified gen p mean: 0.4476727545261383, gen p mean: -0.0431724488735199, mean p set: 0.4481530487537384
loss_pred:0.01390722393989563, decouple_loss:0.0013349639484658837
loss_pred:0.013531193137168884, decouple_loss:0.0014033060288056731
Iteration: 1540, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44713956117630005, gen p mean: -0.048718277364969254, mean p set: 0.44761988520622253
loss_pred:0.013794654048979282, decouple_loss:0.0013503897935152054
The modified gen p mean: 0.4474140405654907, gen p mean: -0.0402107872068882, mean p set: 0.44789430499076843The modified gen p mean: 0.44679683446884155, gen p mean: -0.04507836326956749, mean p set: 0.44727712869644165
loss_pred:0.013763099908828735, decouple_loss:0.0013284566812217236
loss_pred:0.013511436060070992, decouple_loss:0.001354730105958879
2023-05-01 04:10:26 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.046980030834674835, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04347700998187065, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.04301426187157631, mean p set: 0.4500633478164673
loss_pred:0.019156785681843758, decouple_loss:0.0013423599302768707
loss_pred:0.018149172887206078, decouple_loss:0.0014144476735964417
loss_pred:0.018179023638367653, decouple_loss:0.0013579154619947076
WV_0_PC_1_EH_0_PS_40, loss: 0.01856357418000698, avg_mse: 0.027069956064224243
current test mse: 0.02707
Iteration: 1541, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483940899372101, gen p mean: -0.04482410103082657, mean p set: 0.44887441396713257
The modified gen p mean: 0.44692885875701904, gen p mean: -0.049363601952791214, mean p set: 0.44740915298461914
The modified gen p mean: 0.449433296918869, gen p mean: -0.04368337616324425, mean p set: 0.4499136209487915
loss_pred:0.01373336836695671, decouple_loss:0.0012838885886594653
loss_pred:0.013983001001179218, decouple_loss:0.0012815800728276372
loss_pred:0.01377835962921381, decouple_loss:0.0012696947669610381
Iteration: 1542, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471665024757385, gen p mean: -0.04639642313122749, mean p set: 0.447646826505661
loss_pred:0.013715812005102634, decouple_loss:0.0013872740091755986
The modified gen p mean: 0.4480317533016205, gen p mean: -0.04495978355407715, mean p set: 0.4485120475292206The modified gen p mean: 0.4478175640106201, gen p mean: -0.04671119526028633, mean p set: 0.4482978880405426
loss_pred:0.013932199217379093, decouple_loss:0.0014093726640567183
loss_pred:0.01411457173526287, decouple_loss:0.0013369580265134573
Iteration: 1543, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487040936946869, gen p mean: -0.049997057765722275, mean p set: 0.449184387922287
loss_pred:0.013564473018050194, decouple_loss:0.0013829348608851433
The modified gen p mean: 0.44760459661483765, gen p mean: -0.04950004816055298, mean p set: 0.44808489084243774The modified gen p mean: 0.4483659267425537, gen p mean: -0.050183217972517014, mean p set: 0.4488462209701538
loss_pred:0.013431726954877377, decouple_loss:0.0012825778685510159
loss_pred:0.013698740862309933, decouple_loss:0.001340518705546856
Iteration: 1544, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468082785606384, gen p mean: -0.04826052114367485, mean p set: 0.4472885727882385
loss_pred:0.013950342312455177, decouple_loss:0.0015936356503516436
The modified gen p mean: 0.4473932087421417, gen p mean: -0.050353143364191055, mean p set: 0.4478735327720642The modified gen p mean: 0.44803324341773987, gen p mean: -0.04561484605073929, mean p set: 0.44851356744766235
loss_pred:0.01362068485468626, decouple_loss:0.0013489348348230124
loss_pred:0.013983174227178097, decouple_loss:0.0015759803354740143
Iteration: 1545, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44784674048423767, gen p mean: -0.04408004879951477, mean p set: 0.44832706451416016
loss_pred:0.013643421232700348, decouple_loss:0.0013025047956034541
The modified gen p mean: 0.4483109414577484, gen p mean: -0.041671138256788254, mean p set: 0.4487912356853485The modified gen p mean: 0.44773584604263306, gen p mean: -0.04351501166820526, mean p set: 0.44821611046791077
loss_pred:0.014000949449837208, decouple_loss:0.0013176309876143932
loss_pred:0.01394403912127018, decouple_loss:0.001374789047986269
Iteration: 1546, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44854751229286194, gen p mean: -0.0432877391576767, mean p set: 0.44902777671813965
loss_pred:0.013866045512259007, decouple_loss:0.0012611123966053128
The modified gen p mean: 0.4476069211959839, gen p mean: -0.044601935893297195, mean p set: 0.448087215423584
The modified gen p mean: 0.4461553692817688, gen p mean: -0.04753030836582184, mean p set: 0.4466356933116913
loss_pred:0.013453586958348751, decouple_loss:0.0012474495451897383
loss_pred:0.013598037883639336, decouple_loss:0.001307585509493947
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1547, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44736161828041077, gen p mean: -0.04442032799124718, mean p set: 0.44784191250801086
loss_pred:0.013578180223703384, decouple_loss:0.0012848128098994493
The modified gen p mean: 0.4454862177371979, gen p mean: -0.04769769310951233, mean p set: 0.445966511964798The modified gen p mean: 0.44861432909965515, gen p mean: -0.0417664498090744, mean p set: 0.44909462332725525
loss_pred:0.014030708000063896, decouple_loss:0.001339316600933671
loss_pred:0.013525514863431454, decouple_loss:0.001204386935569346
Iteration: 1548, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468347430229187, gen p mean: -0.04279233515262604, mean p set: 0.4473150670528412
loss_pred:0.013656370341777802, decouple_loss:0.0013759281719103456
The modified gen p mean: 0.44753408432006836, gen p mean: -0.03984211012721062, mean p set: 0.44801437854766846The modified gen p mean: 0.4461550712585449, gen p mean: -0.047337960451841354, mean p set: 0.4466353952884674
loss_pred:0.013554932549595833, decouple_loss:0.00135381321888417
loss_pred:0.013816100545227528, decouple_loss:0.0012119825696572661
Iteration: 1549, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472886323928833, gen p mean: -0.04116802290081978, mean p set: 0.4477689266204834
loss_pred:0.013650709763169289, decouple_loss:0.0012107181828469038
The modified gen p mean: 0.4493890106678009, gen p mean: -0.04137052968144417, mean p set: 0.449869304895401The modified gen p mean: 0.4476143717765808, gen p mean: -0.0453525148332119, mean p set: 0.4480946362018585
loss_pred:0.014035001397132874, decouple_loss:0.0012913569808006287
loss_pred:0.013676797039806843, decouple_loss:0.0012833471409976482
Iteration: 1550, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44661805033683777, gen p mean: -0.04939660429954529, mean p set: 0.44709834456443787
loss_pred:0.013347767293453217, decouple_loss:0.0013122677337378263
The modified gen p mean: 0.44982993602752686, gen p mean: -0.04395061731338501, mean p set: 0.45031026005744934
The modified gen p mean: 0.44852012395858765, gen p mean: -0.04398626834154129, mean p set: 0.44900041818618774
loss_pred:0.013307152315974236, decouple_loss:0.001247550593689084
loss_pred:0.013646144419908524, decouple_loss:0.001312958775088191
2023-05-01 04:12:19 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.046771977096796036, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04304281622171402, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04281681030988693, mean p set: 0.4500633478164673
loss_pred:0.01922491379082203, decouple_loss:0.0014756874879822135
loss_pred:0.018237406387925148, decouple_loss:0.0014970299089327455
loss_pred:0.01819964125752449, decouple_loss:0.001456833677366376
WV_0_PC_1_EH_0_PS_40, loss: 0.018627813085913658, avg_mse: 0.027197878807783127
current test mse: 0.027198
Iteration: 1551, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485139846801758, gen p mean: -0.04449321702122688, mean p set: 0.4489942789077759
The modified gen p mean: 0.44608765840530396, gen p mean: -0.048633892089128494, mean p set: 0.44656795263290405
The modified gen p mean: 0.44719722867012024, gen p mean: -0.04778933897614479, mean p set: 0.44767752289772034
loss_pred:0.013426565565168858, decouple_loss:0.001331041450612247
loss_pred:0.013750455342233181, decouple_loss:0.0013216598890721798
loss_pred:0.013983496464788914, decouple_loss:0.0015031312359496951
Iteration: 1552, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478420615196228, gen p mean: -0.04197710379958153, mean p set: 0.4483223557472229
loss_pred:0.01346510834991932, decouple_loss:0.0013282594736665487
The modified gen p mean: 0.4474954903125763, gen p mean: -0.04520047828555107, mean p set: 0.4479758143424988The modified gen p mean: 0.4469814896583557, gen p mean: -0.04533753916621208, mean p set: 0.4474617540836334
loss_pred:0.013730663806200027, decouple_loss:0.0014747913228347898
loss_pred:0.013262155465781689, decouple_loss:0.0013522327644750476
Iteration: 1553, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473239481449127, gen p mean: -0.042676981538534164, mean p set: 0.44780421257019043
loss_pred:0.013447051867842674, decouple_loss:0.0011813963064923882
The modified gen p mean: 0.44727861881256104, gen p mean: -0.04800158739089966, mean p set: 0.44775891304016113The modified gen p mean: 0.44697925448417664, gen p mean: -0.04780912399291992, mean p set: 0.44745954871177673
loss_pred:0.013493337668478489, decouple_loss:0.0013737725093960762
loss_pred:0.013691416941583157, decouple_loss:0.0012868342455476522
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012007_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012007_3_24hr.npz
NaN value num: 0
Iteration: 1554, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508441686630249, gen p mean: -0.042007509618997574, mean p set: 0.4513244330883026
loss_pred:0.017710408195853233, decouple_loss:0.0014546160819008946
The modified gen p mean: 0.45216891169548035, gen p mean: -0.03822487220168114, mean p set: 0.45264923572540283The modified gen p mean: 0.4508700668811798, gen p mean: -0.0364985466003418, mean p set: 0.4513503611087799
loss_pred:0.01664232462644577, decouple_loss:0.001388074248097837
loss_pred:0.017527364194393158, decouple_loss:0.0013883411884307861
Iteration: 1555, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4510827362537384, gen p mean: -0.03851627558469772, mean p set: 0.4515630006790161
loss_pred:0.017632819712162018, decouple_loss:0.001411593984812498
The modified gen p mean: 0.45272040367126465, gen p mean: -0.03702474385499954, mean p set: 0.45320072770118713
The modified gen p mean: 0.4511820077896118, gen p mean: -0.037044718861579895, mean p set: 0.4516623318195343
loss_pred:0.016403857618570328, decouple_loss:0.0013772934908047318
loss_pred:0.01714826375246048, decouple_loss:0.0012622815556824207
Iteration: 1556, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45233041048049927, gen p mean: -0.038025714457035065, mean p set: 0.45281070470809937
loss_pred:0.016805563122034073, decouple_loss:0.001342735718935728
The modified gen p mean: 0.45134875178337097, gen p mean: -0.02909621223807335, mean p set: 0.45182904601097107The modified gen p mean: 0.4522281587123871, gen p mean: -0.03780215233564377, mean p set: 0.45270848274230957
loss_pred:0.017701242119073868, decouple_loss:0.001401105779223144
loss_pred:0.016992919147014618, decouple_loss:0.001323168515227735
Iteration: 1557, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4536548852920532, gen p mean: -0.031831178814172745, mean p set: 0.4541351795196533
loss_pred:0.01601226255297661, decouple_loss:0.0013045279774814844
The modified gen p mean: 0.45227065682411194, gen p mean: -0.03153935447335243, mean p set: 0.45275095105171204The modified gen p mean: 0.4524080455303192, gen p mean: -0.035739947110414505, mean p set: 0.4528883397579193
loss_pred:0.015739882364869118, decouple_loss:0.001372551778331399
loss_pred:0.016287190839648247, decouple_loss:0.001274456037208438
Iteration: 1558, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514199197292328, gen p mean: -0.029760053381323814, mean p set: 0.4519002437591553
loss_pred:0.015595849603414536, decouple_loss:0.0013542076339945197
The modified gen p mean: 0.4520118534564972, gen p mean: -0.038130976259708405, mean p set: 0.4524921178817749The modified gen p mean: 0.45270630717277527, gen p mean: -0.0337132066488266, mean p set: 0.45318663120269775
loss_pred:0.01633467897772789, decouple_loss:0.0013161692768335342
loss_pred:0.016092142090201378, decouple_loss:0.001427320996299386
Iteration: 1559, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4539129436016083, gen p mean: -0.030090991407632828, mean p set: 0.45439326763153076
The modified gen p mean: 0.45249706506729126, gen p mean: -0.03177860379219055, mean p set: 0.45297735929489136
loss_pred:0.016130948439240456, decouple_loss:0.0015391436172649264
loss_pred:0.015825608745217323, decouple_loss:0.0014519281685352325
The modified gen p mean: 0.4529423713684082, gen p mean: -0.03507760912179947, mean p set: 0.4534226953983307
loss_pred:0.016072945669293404, decouple_loss:0.0014610864454880357
Iteration: 1560, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508156180381775, gen p mean: -0.030498767271637917, mean p set: 0.4512959122657776
loss_pred:0.015992574393749237, decouple_loss:0.0014662542380392551
The modified gen p mean: 0.4521505832672119, gen p mean: -0.03343600034713745, mean p set: 0.4526309072971344The modified gen p mean: 0.4527140259742737, gen p mean: -0.032816603779792786, mean p set: 0.4531942903995514
loss_pred:0.016637686640024185, decouple_loss:0.0013664922444149852
loss_pred:0.016612665727734566, decouple_loss:0.001379125751554966
2023-05-01 04:14:52 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.04600426182150841, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.042755089700222015, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.042450495064258575, mean p set: 0.4500633478164673
loss_pred:0.018670570105314255, decouple_loss:0.0014875151682645082loss_pred:0.017656059935688972, decouple_loss:0.001470907242037356
loss_pred:0.017699161544442177, decouple_loss:0.001513018854893744
WV_0_PC_1_EH_0_PS_40, loss: 0.0180831216275692, avg_mse: 0.026038633659482002
current test mse: 0.026039
Iteration: 1561, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4528367817401886, gen p mean: -0.038451049476861954, mean p set: 0.4533170461654663
The modified gen p mean: 0.45276230573654175, gen p mean: -0.03592606261372566, mean p set: 0.45324259996414185
The modified gen p mean: 0.4513746201992035, gen p mean: -0.03766981512308121, mean p set: 0.4518548846244812
loss_pred:0.016830995678901672, decouple_loss:0.0013147240970283747
loss_pred:0.015901725739240646, decouple_loss:0.0012608413817360997
loss_pred:0.015542935580015182, decouple_loss:0.00126096629537642
Iteration: 1562, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45104166865348816, gen p mean: -0.04412160441279411, mean p set: 0.45152196288108826
loss_pred:0.01695815660059452, decouple_loss:0.001451288117095828
The modified gen p mean: 0.4510241150856018, gen p mean: -0.04412085935473442, mean p set: 0.4515043795108795The modified gen p mean: 0.4498565196990967, gen p mean: -0.04061291366815567, mean p set: 0.4503368139266968
loss_pred:0.01711776852607727, decouple_loss:0.0014006346464157104
loss_pred:0.016884060576558113, decouple_loss:0.0014475076459348202
Iteration: 1563, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513583779335022, gen p mean: -0.04275292530655861, mean p set: 0.4518386423587799
loss_pred:0.016758760437369347, decouple_loss:0.0013291239738464355
The modified gen p mean: 0.45097973942756653, gen p mean: -0.035702791064977646, mean p set: 0.45146000385284424The modified gen p mean: 0.45220547914505005, gen p mean: -0.0412413664162159, mean p set: 0.45268580317497253
loss_pred:0.015992296859622, decouple_loss:0.0013810477685183287
loss_pred:0.01718759350478649, decouple_loss:0.0013476299354806542
Iteration: 1564, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45271334052085876, gen p mean: -0.039425112307071686, mean p set: 0.45319366455078125
loss_pred:0.01495315507054329, decouple_loss:0.0012309921439737082
The modified gen p mean: 0.4522090256214142, gen p mean: -0.04223525896668434, mean p set: 0.4526892900466919The modified gen p mean: 0.4507489502429962, gen p mean: -0.03920026496052742, mean p set: 0.4512292742729187
loss_pred:0.01653118059039116, decouple_loss:0.0013478277251124382
loss_pred:0.018102645874023438, decouple_loss:0.0013634812785312533
Iteration: 1565, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4509720802307129, gen p mean: -0.04080028459429741, mean p set: 0.451452374458313
loss_pred:0.01659327931702137, decouple_loss:0.0013876075390726328
The modified gen p mean: 0.45131009817123413, gen p mean: -0.042021799832582474, mean p set: 0.4517904222011566The modified gen p mean: 0.45246726274490356, gen p mean: -0.04519642889499664, mean p set: 0.45294755697250366
loss_pred:0.01716315932571888, decouple_loss:0.0013670505722984672
loss_pred:0.016030093654990196, decouple_loss:0.0015351021429523826
Iteration: 1566, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4521137475967407, gen p mean: -0.03756958618760109, mean p set: 0.4525940418243408
loss_pred:0.01623861864209175, decouple_loss:0.0012369804317131639
The modified gen p mean: 0.45398029685020447, gen p mean: -0.035947903990745544, mean p set: 0.45446059107780457The modified gen p mean: 0.45048317313194275, gen p mean: -0.0432797335088253, mean p set: 0.45096346735954285
loss_pred:0.016978422179818153, decouple_loss:0.0013797017745673656
loss_pred:0.01545479241758585, decouple_loss:0.0014404213288798928
Iteration: 1567, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511546194553375, gen p mean: -0.04091443121433258, mean p set: 0.4516349136829376
loss_pred:0.017009781673550606, decouple_loss:0.0012832018546760082
The modified gen p mean: 0.45180991291999817, gen p mean: -0.03918946161866188, mean p set: 0.45229020714759827The modified gen p mean: 0.4527190625667572, gen p mean: -0.039812833070755005, mean p set: 0.4531993865966797
loss_pred:0.016868261620402336, decouple_loss:0.0014018738875165582
loss_pred:0.015882618725299835, decouple_loss:0.0012645430397242308
Iteration: 1568, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45132583379745483, gen p mean: -0.044422753155231476, mean p set: 0.45180612802505493
loss_pred:0.016830628737807274, decouple_loss:0.0014964452711865306
The modified gen p mean: 0.4516972601413727, gen p mean: -0.03638738766312599, mean p set: 0.4521775543689728The modified gen p mean: 0.4522641897201538, gen p mean: -0.038793858140707016, mean p set: 0.4527444541454315
loss_pred:0.01695931702852249, decouple_loss:0.001675053732469678
loss_pred:0.016317635774612427, decouple_loss:0.0016982187516987324
Iteration: 1569, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4516957700252533, gen p mean: -0.03741908818483353, mean p set: 0.4521760940551758
loss_pred:0.01655140519142151, decouple_loss:0.0014631007798016071
The modified gen p mean: 0.45096471905708313, gen p mean: -0.04276436194777489, mean p set: 0.4514450132846832The modified gen p mean: 0.4506838619709015, gen p mean: -0.03801671415567398, mean p set: 0.4511641561985016
loss_pred:0.01663728430867195, decouple_loss:0.0012254008324816823
loss_pred:0.015890225768089294, decouple_loss:0.0013882621424272656
Iteration: 1570, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45347917079925537, gen p mean: -0.04319204390048981, mean p set: 0.45395946502685547
loss_pred:0.01566450670361519, decouple_loss:0.0015310466988012195
The modified gen p mean: 0.45056912302970886, gen p mean: -0.03827754408121109, mean p set: 0.4510493874549866The modified gen p mean: 0.4528239965438843, gen p mean: -0.04009804502129555, mean p set: 0.4533042907714844
loss_pred:0.01743553951382637, decouple_loss:0.0013243183493614197
loss_pred:0.015800390392541885, decouple_loss:0.0012714809272438288
2023-05-01 04:16:46 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.05345837026834488, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.050017569214105606, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04989057779312134, mean p set: 0.4500633478164673
loss_pred:0.018518347293138504, decouple_loss:0.0014180495636537671
loss_pred:0.017517168074846268, decouple_loss:0.0013414925197139382
loss_pred:0.017595477402210236, decouple_loss:0.0014142458094283938
WV_0_PC_1_EH_0_PS_40, loss: 0.01794656179845333, avg_mse: 0.02580169029533863
current test mse: 0.025802
Iteration: 1571, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45221829414367676, gen p mean: -0.042850036174058914, mean p set: 0.45269855856895447
The modified gen p mean: 0.4522453546524048, gen p mean: -0.04552742466330528, mean p set: 0.4527256488800049
The modified gen p mean: 0.453058660030365, gen p mean: -0.04421394318342209, mean p set: 0.4535389542579651
loss_pred:0.01639200747013092, decouple_loss:0.0014961761189624667
loss_pred:0.01568920537829399, decouple_loss:0.0013942834921181202
loss_pred:0.016216417774558067, decouple_loss:0.001375562627799809
Iteration: 1572, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4515138268470764, gen p mean: -0.039553601294755936, mean p set: 0.4519941210746765
The modified gen p mean: 0.45082202553749084, gen p mean: -0.04273197799921036, mean p set: 0.45130228996276855
loss_pred:0.016381870955228806, decouple_loss:0.0011706785298883915
loss_pred:0.015542972832918167, decouple_loss:0.0014814778696745634
The modified gen p mean: 0.4505382776260376, gen p mean: -0.04512321949005127, mean p set: 0.4510186016559601
loss_pred:0.01652367413043976, decouple_loss:0.0013290022034198046
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012019_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012019_3_24hr.npz
NaN value num: 0
Iteration: 1573, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.451214998960495, gen p mean: -0.04062074422836304, mean p set: 0.4516952931880951
loss_pred:0.016701027750968933, decouple_loss:0.0015441922005265951
The modified gen p mean: 0.4506399631500244, gen p mean: -0.046199455857276917, mean p set: 0.4511202275753021The modified gen p mean: 0.4514373242855072, gen p mean: -0.03901318088173866, mean p set: 0.4519175887107849
loss_pred:0.017053544521331787, decouple_loss:0.0015960801392793655
loss_pred:0.017126712948083878, decouple_loss:0.0015412968350574374
Iteration: 1574, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507615566253662, gen p mean: -0.035299256443977356, mean p set: 0.4512418508529663
loss_pred:0.017302988097071648, decouple_loss:0.0011960100382566452
The modified gen p mean: 0.45083531737327576, gen p mean: -0.036552317440509796, mean p set: 0.45131561160087585The modified gen p mean: 0.45096656680107117, gen p mean: -0.04253317415714264, mean p set: 0.45144689083099365
loss_pred:0.017180465161800385, decouple_loss:0.0012224855599924922
loss_pred:0.017909787595272064, decouple_loss:0.001292568165808916
Iteration: 1575, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508517384529114, gen p mean: -0.038146860897541046, mean p set: 0.45133206248283386
loss_pred:0.017513716593384743, decouple_loss:0.0012278627837076783
The modified gen p mean: 0.45004433393478394, gen p mean: -0.04253765195608139, mean p set: 0.45052459836006165The modified gen p mean: 0.4507334530353546, gen p mean: -0.04462697356939316, mean p set: 0.4512137174606323
loss_pred:0.01811417192220688, decouple_loss:0.001132907927967608
loss_pred:0.017223946750164032, decouple_loss:0.0010922307847067714
Iteration: 1576, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45082083344459534, gen p mean: -0.03608829900622368, mean p set: 0.45130112767219543
loss_pred:0.017355075106024742, decouple_loss:0.001227669301442802
The modified gen p mean: 0.44982588291168213, gen p mean: -0.04493231326341629, mean p set: 0.45030614733695984The modified gen p mean: 0.4518752694129944, gen p mean: -0.03939128667116165, mean p set: 0.4523555636405945
loss_pred:0.017544331029057503, decouple_loss:0.00117948604747653
loss_pred:0.016588516533374786, decouple_loss:0.0012249371502548456
Iteration: 1577, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4518773853778839, gen p mean: -0.04163558408617973, mean p set: 0.452357679605484
loss_pred:0.016847016289830208, decouple_loss:0.0012098235310986638
The modified gen p mean: 0.4519239366054535, gen p mean: -0.04358882084488869, mean p set: 0.4524042010307312
The modified gen p mean: 0.4517272710800171, gen p mean: -0.04262400418519974, mean p set: 0.4522075653076172
loss_pred:0.016876354813575745, decouple_loss:0.0012355766957625747
loss_pred:0.016385521739721298, decouple_loss:0.001253463327884674
Iteration: 1578, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44943222403526306, gen p mean: -0.05187580734491348, mean p set: 0.44991254806518555
loss_pred:0.017195578664541245, decouple_loss:0.0011346585815772414
The modified gen p mean: 0.45183250308036804, gen p mean: -0.050847720354795456, mean p set: 0.45231279730796814The modified gen p mean: 0.4505957067012787, gen p mean: -0.056759949773550034, mean p set: 0.4510760009288788
loss_pred:0.016994275152683258, decouple_loss:0.0011328114196658134
loss_pred:0.018161319196224213, decouple_loss:0.0012059505097568035
Iteration: 1579, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4523179829120636, gen p mean: -0.05227319151163101, mean p set: 0.4527982771396637
loss_pred:0.017822492867708206, decouple_loss:0.0014019733062013984
The modified gen p mean: 0.4508074223995209, gen p mean: -0.055072832852602005, mean p set: 0.4512876868247986The modified gen p mean: 0.4493287205696106, gen p mean: -0.05272500962018967, mean p set: 0.4498090147972107
loss_pred:0.018030868843197823, decouple_loss:0.0012720897793769836
loss_pred:0.018042955547571182, decouple_loss:0.0013379387091845274
Iteration: 1580, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45084184408187866, gen p mean: -0.048865728080272675, mean p set: 0.45132210850715637
loss_pred:0.017913606017827988, decouple_loss:0.0012426802422851324
The modified gen p mean: 0.4494194984436035, gen p mean: -0.052789732813835144, mean p set: 0.449899822473526The modified gen p mean: 0.4508407413959503, gen p mean: -0.04501475393772125, mean p set: 0.451321005821228
loss_pred:0.017007717862725258, decouple_loss:0.0012434758245944977
loss_pred:0.017269354313611984, decouple_loss:0.0013322634622454643
2023-05-01 04:19:20 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.05677058547735214, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.05288565158843994, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.05294756591320038, mean p set: 0.4500633478164673
loss_pred:0.017487037926912308, decouple_loss:0.0014669654192402959
loss_pred:0.0185064896941185, decouple_loss:0.0015495828120037913
loss_pred:0.01755370944738388, decouple_loss:0.0016135310288518667
WV_0_PC_1_EH_0_PS_40, loss: 0.01792624592781067, avg_mse: 0.025747910141944885
current test mse: 0.025748
Iteration: 1581, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497205913066864, gen p mean: -0.05161682888865471, mean p set: 0.4502009153366089
The modified gen p mean: 0.45010021328926086, gen p mean: -0.053839754313230515, mean p set: 0.45058050751686096
The modified gen p mean: 0.4496927559375763, gen p mean: -0.0507977195084095, mean p set: 0.450173020362854
loss_pred:0.017799051478505135, decouple_loss:0.0014972309581935406
loss_pred:0.01733434572815895, decouple_loss:0.001388119999319315
loss_pred:0.017133720219135284, decouple_loss:0.0014038932276889682
Iteration: 1582, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4512808918952942, gen p mean: -0.04250669851899147, mean p set: 0.4517611861228943
loss_pred:0.017364777624607086, decouple_loss:0.0012256992049515247
The modified gen p mean: 0.4503265619277954, gen p mean: -0.04756049066781998, mean p set: 0.4508068561553955The modified gen p mean: 0.44965270161628723, gen p mean: -0.04220724105834961, mean p set: 0.45013299584388733
loss_pred:0.017474496737122536, decouple_loss:0.001171973068267107
loss_pred:0.01726534217596054, decouple_loss:0.0011498561361804605
Iteration: 1583, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44986769556999207, gen p mean: -0.044967275112867355, mean p set: 0.45034801959991455
loss_pred:0.01748812012374401, decouple_loss:0.001214803196489811
The modified gen p mean: 0.4514906108379364, gen p mean: -0.03768078610301018, mean p set: 0.4519709050655365The modified gen p mean: 0.4512348175048828, gen p mean: -0.03711826726794243, mean p set: 0.4517151117324829
loss_pred:0.017245685681700706, decouple_loss:0.0012641757493838668
loss_pred:0.017079563811421394, decouple_loss:0.0012640588684007525
Iteration: 1584, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44983214139938354, gen p mean: -0.04033837839961052, mean p set: 0.45031243562698364
loss_pred:0.017136303707957268, decouple_loss:0.0012143985368311405
The modified gen p mean: 0.45036160945892334, gen p mean: -0.04425279423594475, mean p set: 0.4508419334888458The modified gen p mean: 0.451535165309906, gen p mean: -0.037093132734298706, mean p set: 0.4520154595375061
loss_pred:0.01724492758512497, decouple_loss:0.0012452201917767525loss_pred:0.017489049583673477, decouple_loss:0.0012698366772383451
Iteration: 1585, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4509578347206116, gen p mean: -0.035726189613342285, mean p set: 0.45143812894821167
loss_pred:0.017624106258153915, decouple_loss:0.001099566463381052
The modified gen p mean: 0.45078355073928833, gen p mean: -0.04118330404162407, mean p set: 0.4512638449668884The modified gen p mean: 0.4513067305088043, gen p mean: -0.0365009605884552, mean p set: 0.45178699493408203
loss_pred:0.016774725168943405, decouple_loss:0.0011463640257716179
loss_pred:0.017517315223813057, decouple_loss:0.001057697576470673
Iteration: 1586, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45153141021728516, gen p mean: -0.03506788611412048, mean p set: 0.45201170444488525
loss_pred:0.01651466079056263, decouple_loss:0.0012354236096143723
The modified gen p mean: 0.45209643244743347, gen p mean: -0.036404311656951904, mean p set: 0.45257672667503357The modified gen p mean: 0.45255059003829956, gen p mean: -0.0376552939414978, mean p set: 0.45303085446357727
loss_pred:0.017009204253554344, decouple_loss:0.0011347407707944512
loss_pred:0.016611121594905853, decouple_loss:0.0012472381349653006
Iteration: 1587, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45012742280960083, gen p mean: -0.04244549572467804, mean p set: 0.45060768723487854
loss_pred:0.01747700572013855, decouple_loss:0.0011245054192841053
The modified gen p mean: 0.4502672851085663, gen p mean: -0.044113390147686005, mean p set: 0.45074760913848877The modified gen p mean: 0.45010122656822205, gen p mean: -0.04062282294034958, mean p set: 0.45058155059814453
loss_pred:0.017774133011698723, decouple_loss:0.001082344097085297
loss_pred:0.017441250383853912, decouple_loss:0.0010849609971046448
Iteration: 1588, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45210570096969604, gen p mean: -0.04749159887433052, mean p set: 0.45258599519729614
loss_pred:0.017535101622343063, decouple_loss:0.001226960332132876
The modified gen p mean: 0.4497329592704773, gen p mean: -0.0468079149723053, mean p set: 0.4502132534980774The modified gen p mean: 0.45038220286369324, gen p mean: -0.04527602717280388, mean p set: 0.45086249709129333
loss_pred:0.017509078606963158, decouple_loss:0.0011672620894387364
loss_pred:0.016756033524870872, decouple_loss:0.001160898245871067
Iteration: 1589, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496115744113922, gen p mean: -0.05050528049468994, mean p set: 0.4500918984413147
loss_pred:0.017456475645303726, decouple_loss:0.0012934738770127296
The modified gen p mean: 0.45269033312797546, gen p mean: -0.046342674642801285, mean p set: 0.45317062735557556The modified gen p mean: 0.45233821868896484, gen p mean: -0.04381465166807175, mean p set: 0.45281848311424255
loss_pred:0.01654580794274807, decouple_loss:0.0014047955628484488
loss_pred:0.01747063361108303, decouple_loss:0.0013180602109059691
Iteration: 1590, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45115041732788086, gen p mean: -0.04624520242214203, mean p set: 0.45163068175315857
loss_pred:0.01683492586016655, decouple_loss:0.001246951287612319
The modified gen p mean: 0.4519759714603424, gen p mean: -0.04501510038971901, mean p set: 0.4524562954902649The modified gen p mean: 0.45141705870628357, gen p mean: -0.04664049670100212, mean p set: 0.45189735293388367
loss_pred:0.018075959756970406, decouple_loss:0.0011216271668672562
loss_pred:0.016834000125527382, decouple_loss:0.0012473774841055274
2023-05-01 04:21:13 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.05975955352187157, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.0553877092897892, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.05583563074469566, mean p set: 0.4500633478164673
loss_pred:0.01853027753531933, decouple_loss:0.001528558088466525
loss_pred:0.01747811585664749, decouple_loss:0.001411823439411819
loss_pred:0.01756194978952408, decouple_loss:0.0014547723112627864
WV_0_PC_1_EH_0_PS_40, loss: 0.017930034548044205, avg_mse: 0.02579534612596035
current test mse: 0.025795
Iteration: 1591, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449715793132782, gen p mean: -0.05613093450665474, mean p set: 0.4501960873603821
The modified gen p mean: 0.44944486021995544, gen p mean: -0.04945547506213188, mean p set: 0.44992515444755554
The modified gen p mean: 0.45006638765335083, gen p mean: -0.056604526937007904, mean p set: 0.4505466818809509
loss_pred:0.017603427171707153, decouple_loss:0.0013936527539044619
loss_pred:0.017179232090711594, decouple_loss:0.001368590397760272
loss_pred:0.017256123945116997, decouple_loss:0.0013795281993225217
Iteration: 1592, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508119225502014, gen p mean: -0.05653964355587959, mean p set: 0.4512922167778015
The modified gen p mean: 0.4517497420310974, gen p mean: -0.05115693435072899, mean p set: 0.4522300362586975
loss_pred:0.017819320783019066, decouple_loss:0.0012187316315248609
loss_pred:0.01791335828602314, decouple_loss:0.0015195003943517804
The modified gen p mean: 0.4509640336036682, gen p mean: -0.05006203427910805, mean p set: 0.4514442980289459
loss_pred:0.01704547554254532, decouple_loss:0.0013269883347675204
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012006_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012006_3_24hr.npz
NaN value num: 0
Iteration: 1593, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497276246547699, gen p mean: -0.05937148630619049, mean p set: 0.45020791888237
loss_pred:0.01750754565000534, decouple_loss:0.0012777179945260286
The modified gen p mean: 0.4486241340637207, gen p mean: -0.05420059710741043, mean p set: 0.4491044282913208
The modified gen p mean: 0.44830429553985596, gen p mean: -0.059934355318546295, mean p set: 0.44878458976745605
loss_pred:0.016447745263576508, decouple_loss:0.001449190778657794
loss_pred:0.017410967499017715, decouple_loss:0.001287392107769847
Iteration: 1594, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44967159628868103, gen p mean: -0.05791420862078667, mean p set: 0.45015189051628113
loss_pred:0.017870424315333366, decouple_loss:0.0011699747992679477
The modified gen p mean: 0.44914892315864563, gen p mean: -0.057272255420684814, mean p set: 0.4496292173862457The modified gen p mean: 0.44750362634658813, gen p mean: -0.05323706194758415, mean p set: 0.4479839503765106
loss_pred:0.017427809536457062, decouple_loss:0.0012738016666844487
loss_pred:0.018605109304189682, decouple_loss:0.0011838667560368776
Iteration: 1595, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44832828640937805, gen p mean: -0.050580866634845734, mean p set: 0.44880858063697815
loss_pred:0.01705663837492466, decouple_loss:0.0012438346166163683
The modified gen p mean: 0.4483519494533539, gen p mean: -0.05599009618163109, mean p set: 0.448832243680954
The modified gen p mean: 0.44811561703681946, gen p mean: -0.05724804848432541, mean p set: 0.44859588146209717
loss_pred:0.019174639135599136, decouple_loss:0.0011547731701284647
loss_pred:0.01811232604086399, decouple_loss:0.0011722114868462086
Iteration: 1596, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470460116863251, gen p mean: -0.05658479407429695, mean p set: 0.4475262761116028
loss_pred:0.018277937546372414, decouple_loss:0.0012643823865801096
The modified gen p mean: 0.4469853341579437, gen p mean: -0.05645107105374336, mean p set: 0.4474656283855438The modified gen p mean: 0.44731876254081726, gen p mean: -0.05262382701039314, mean p set: 0.44779905676841736
loss_pred:0.01792575791478157, decouple_loss:0.0012796733062714338
loss_pred:0.01685940846800804, decouple_loss:0.0011872979812324047
Iteration: 1597, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464704096317291, gen p mean: -0.050751060247421265, mean p set: 0.44695067405700684
loss_pred:0.017757602035999298, decouple_loss:0.0014093386707827449
The modified gen p mean: 0.4471716582775116, gen p mean: -0.05529666692018509, mean p set: 0.4476519823074341The modified gen p mean: 0.44807925820350647, gen p mean: -0.04936086758971214, mean p set: 0.44855955243110657
loss_pred:0.016915056854486465, decouple_loss:0.0012027034536004066
loss_pred:0.017261486500501633, decouple_loss:0.0012548563536256552
Iteration: 1598, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491839110851288, gen p mean: -0.05269007757306099, mean p set: 0.4496642053127289
loss_pred:0.01709216833114624, decouple_loss:0.0012408345937728882
The modified gen p mean: 0.44879695773124695, gen p mean: -0.045303359627723694, mean p set: 0.44927728176116943The modified gen p mean: 0.44741854071617126, gen p mean: -0.052790768444538116, mean p set: 0.44789883494377136
loss_pred:0.01854034885764122, decouple_loss:0.0011787009425461292
loss_pred:0.01661645993590355, decouple_loss:0.0011534953955560923
Iteration: 1599, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489961862564087, gen p mean: -0.0536520853638649, mean p set: 0.4494765102863312
loss_pred:0.01622493378818035, decouple_loss:0.001085707568563521
The modified gen p mean: 0.44772812724113464, gen p mean: -0.0536235012114048, mean p set: 0.44820842146873474The modified gen p mean: 0.44916045665740967, gen p mean: -0.04863211140036583, mean p set: 0.44964075088500977
loss_pred:0.01766418293118477, decouple_loss:0.0010742532322183251
loss_pred:0.01713954657316208, decouple_loss:0.001004957128316164
Iteration: 1600, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44813400506973267, gen p mean: -0.04989971965551376, mean p set: 0.44861429929733276
loss_pred:0.01674835756421089, decouple_loss:0.0011422350071370602
The modified gen p mean: 0.447998970746994, gen p mean: -0.04915972426533699, mean p set: 0.4484792649745941The modified gen p mean: 0.44814759492874146, gen p mean: -0.041490182280540466, mean p set: 0.44862788915634155
loss_pred:0.01779928430914879, decouple_loss:0.0011190669611096382
loss_pred:0.01643282175064087, decouple_loss:0.0011155419051647186
2023-05-01 04:23:45 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.05080833658576012, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.046729300171136856, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.046759188175201416, mean p set: 0.4500633478164673
loss_pred:0.018362166360020638, decouple_loss:0.0011273541022092104
loss_pred:0.01734423078596592, decouple_loss:0.0012141821207478642
loss_pred:0.017448250204324722, decouple_loss:0.0011756772873923182
WV_0_PC_1_EH_0_PS_40, loss: 0.017776835709810257, avg_mse: 0.025513075292110443
current test mse: 0.025513
Iteration: 1601, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474733769893646, gen p mean: -0.050586603581905365, mean p set: 0.4479536712169647
The modified gen p mean: 0.44778746366500854, gen p mean: -0.05143075808882713, mean p set: 0.44826775789260864
The modified gen p mean: 0.4474940299987793, gen p mean: -0.04746367782354355, mean p set: 0.447974294424057
loss_pred:0.016821470111608505, decouple_loss:0.0010480417404323816
loss_pred:0.01789766177535057, decouple_loss:0.0011720919283106923
loss_pred:0.01861000806093216, decouple_loss:0.0012067400384694338
Iteration: 1602, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44690847396850586, gen p mean: -0.05024973675608635, mean p set: 0.44738876819610596
loss_pred:0.018371660262346268, decouple_loss:0.0012407803442329168
The modified gen p mean: 0.4501868486404419, gen p mean: -0.04897255077958107, mean p set: 0.450667142868042
The modified gen p mean: 0.44690951704978943, gen p mean: -0.052146196365356445, mean p set: 0.4473898112773895
loss_pred:0.01671399548649788, decouple_loss:0.0010897985193878412
loss_pred:0.017545023933053017, decouple_loss:0.0011262240586802363
Iteration: 1603, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44698935747146606, gen p mean: -0.04870354384183884, mean p set: 0.44746968150138855
loss_pred:0.016987226903438568, decouple_loss:0.001036134664900601
The modified gen p mean: 0.44909271597862244, gen p mean: -0.05216515064239502, mean p set: 0.44957301020622253
The modified gen p mean: 0.44786950945854187, gen p mean: -0.04881426319479942, mean p set: 0.44834980368614197
loss_pred:0.01728168874979019, decouple_loss:0.001121689099818468
loss_pred:0.018737664446234703, decouple_loss:0.0011558994883671403
Iteration: 1604, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44831886887550354, gen p mean: -0.05855950340628624, mean p set: 0.44879916310310364
loss_pred:0.017996149137616158, decouple_loss:0.0010486759711056948
The modified gen p mean: 0.44787687063217163, gen p mean: -0.0532294437289238, mean p set: 0.44835713505744934The modified gen p mean: 0.4477471709251404, gen p mean: -0.055395402014255524, mean p set: 0.4482274651527405
loss_pred:0.018314959481358528, decouple_loss:0.001101041561923921
loss_pred:0.0176813006401062, decouple_loss:0.001061100047081709
Iteration: 1605, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44697391986846924, gen p mean: -0.0539470799267292, mean p set: 0.44745421409606934
loss_pred:0.017007265239953995, decouple_loss:0.0011820548679679632
The modified gen p mean: 0.447129487991333, gen p mean: -0.057500503957271576, mean p set: 0.4476097822189331The modified gen p mean: 0.4498458504676819, gen p mean: -0.05594769865274429, mean p set: 0.45032617449760437
loss_pred:0.018155299127101898, decouple_loss:0.0010761419543996453
loss_pred:0.017257889732718468, decouple_loss:0.0011605331674218178
Iteration: 1606, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469103217124939, gen p mean: -0.0528949499130249, mean p set: 0.447390615940094
loss_pred:0.018336815759539604, decouple_loss:0.0011552046053111553
The modified gen p mean: 0.447294145822525, gen p mean: -0.05783519521355629, mean p set: 0.4477744400501251The modified gen p mean: 0.4469221830368042, gen p mean: -0.05242156982421875, mean p set: 0.4474024772644043
loss_pred:0.017212796956300735, decouple_loss:0.0010757694253697991
loss_pred:0.017569411545991898, decouple_loss:0.000995130161754787
Iteration: 1607, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44772282242774963, gen p mean: -0.05337238311767578, mean p set: 0.44820311665534973
loss_pred:0.017400085926055908, decouple_loss:0.0011230413801968098
The modified gen p mean: 0.447347491979599, gen p mean: -0.055221375077962875, mean p set: 0.4478277862071991The modified gen p mean: 0.4487006664276123, gen p mean: -0.05001656338572502, mean p set: 0.4491809606552124
loss_pred:0.018070412799715996, decouple_loss:0.0010544349206611514
loss_pred:0.016905371099710464, decouple_loss:0.0011252714321017265
Iteration: 1608, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487018585205078, gen p mean: -0.05105981603264809, mean p set: 0.4491821527481079
loss_pred:0.016164956614375114, decouple_loss:0.001083867042325437
The modified gen p mean: 0.4493010640144348, gen p mean: -0.05034201964735985, mean p set: 0.4497813284397125The modified gen p mean: 0.4483039677143097, gen p mean: -0.052667584270238876, mean p set: 0.4487842917442322
loss_pred:0.017298636958003044, decouple_loss:0.0009953684639185667
loss_pred:0.017626585438847542, decouple_loss:0.001065034419298172
Iteration: 1609, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44717302918434143, gen p mean: -0.050029970705509186, mean p set: 0.44765329360961914
loss_pred:0.017853807657957077, decouple_loss:0.0010726620675995946
The modified gen p mean: 0.4485624432563782, gen p mean: -0.049331359565258026, mean p set: 0.44904273748397827The modified gen p mean: 0.44750964641571045, gen p mean: -0.04870456084609032, mean p set: 0.44798994064331055
loss_pred:0.016523653641343117, decouple_loss:0.0010523771634325385
loss_pred:0.017303062602877617, decouple_loss:0.0010583384428173304
Iteration: 1610, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44851288199424744, gen p mean: -0.0528089664876461, mean p set: 0.44899317622184753
loss_pred:0.016563691198825836, decouple_loss:0.0009893834358081222
The modified gen p mean: 0.44792255759239197, gen p mean: -0.05380126088857651, mean p set: 0.44840285181999207The modified gen p mean: 0.44660404324531555, gen p mean: -0.057057611644268036, mean p set: 0.44708430767059326
loss_pred:0.0177331380546093, decouple_loss:0.0010012146085500717
loss_pred:0.017266880720853806, decouple_loss:0.0010006203083321452
2023-05-01 04:25:39 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.055956367403268814, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.05153825879096985, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.05174928531050682, mean p set: 0.4500633478164673
loss_pred:0.018292928114533424, decouple_loss:0.0010883548529818654
loss_pred:0.017315946519374847, decouple_loss:0.0010310825891792774
loss_pred:0.017449092119932175, decouple_loss:0.00103785190731287
WV_0_PC_1_EH_0_PS_40, loss: 0.01773861050605774, avg_mse: 0.025443026795983315
current test mse: 0.025443
Iteration: 1611, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44725683331489563, gen p mean: -0.052882321178913116, mean p set: 0.4477371573448181
The modified gen p mean: 0.4493914246559143, gen p mean: -0.05618899315595627, mean p set: 0.4498717188835144
The modified gen p mean: 0.4474138915538788, gen p mean: -0.05430527403950691, mean p set: 0.44789421558380127
loss_pred:0.017223095521330833, decouple_loss:0.0010285789612680674
loss_pred:0.016704710200428963, decouple_loss:0.0009713662439025939
loss_pred:0.017499182373285294, decouple_loss:0.0009647185797803104
Iteration: 1612, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465521574020386, gen p mean: -0.06056525558233261, mean p set: 0.4470324218273163
The modified gen p mean: 0.447131872177124, gen p mean: -0.05245593562722206, mean p set: 0.44761213660240173
loss_pred:0.017373448237776756, decouple_loss:0.0010099662467837334
loss_pred:0.01823681779205799, decouple_loss:0.0008975715609267354
The modified gen p mean: 0.44918811321258545, gen p mean: -0.05223267525434494, mean p set: 0.44966837763786316
loss_pred:0.01724844053387642, decouple_loss:0.0009842227445915341
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012017_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012017_3_24hr.npz
NaN value num: 0
Iteration: 1613, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4510997235774994, gen p mean: -0.04917045682668686, mean p set: 0.4515799880027771
loss_pred:0.01766461692750454, decouple_loss:0.0011614484246820211
The modified gen p mean: 0.45000511407852173, gen p mean: -0.05132601037621498, mean p set: 0.4504854083061218The modified gen p mean: 0.452507883310318, gen p mean: -0.045092400163412094, mean p set: 0.4529881477355957
loss_pred:0.017748231068253517, decouple_loss:0.0013169574085623026
loss_pred:0.017920419573783875, decouple_loss:0.0011167190968990326
Iteration: 1614, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45214712619781494, gen p mean: -0.05335178226232529, mean p set: 0.45262742042541504
loss_pred:0.017388716340065002, decouple_loss:0.001105339964851737
The modified gen p mean: 0.45151031017303467, gen p mean: -0.0483882911503315, mean p set: 0.4519905745983124The modified gen p mean: 0.452606737613678, gen p mean: -0.05257437378168106, mean p set: 0.4530870020389557
loss_pred:0.016959747299551964, decouple_loss:0.0010078571503981948
loss_pred:0.017214588820934296, decouple_loss:0.0011021122336387634
Iteration: 1615, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496256113052368, gen p mean: -0.04967016354203224, mean p set: 0.4501059055328369
loss_pred:0.017369264736771584, decouple_loss:0.0012807889143005013
The modified gen p mean: 0.4522381126880646, gen p mean: -0.0497794933617115, mean p set: 0.4527184069156647The modified gen p mean: 0.4511058032512665, gen p mean: -0.05337085947394371, mean p set: 0.4515860676765442
loss_pred:0.017176179215312004, decouple_loss:0.0012111017713323236
loss_pred:0.016515132039785385, decouple_loss:0.0013070914428681135
Iteration: 1616, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.451567679643631, gen p mean: -0.046959683299064636, mean p set: 0.4520479440689087
The modified gen p mean: 0.4515107572078705, gen p mean: -0.04930412769317627, mean p set: 0.4519910514354706
loss_pred:0.0164949893951416, decouple_loss:0.0011848550057038665
loss_pred:0.016713621094822884, decouple_loss:0.0012138582533225417
The modified gen p mean: 0.4512491226196289, gen p mean: -0.04767873138189316, mean p set: 0.451729416847229
loss_pred:0.017346728593111038, decouple_loss:0.0012222600635141134
Iteration: 1617, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4512441158294678, gen p mean: -0.046193454414606094, mean p set: 0.45172441005706787
The modified gen p mean: 0.45213308930397034, gen p mean: -0.043701671063899994, mean p set: 0.45261338353157043
loss_pred:0.018240252509713173, decouple_loss:0.0012014321982860565
loss_pred:0.017447233200073242, decouple_loss:0.001253834692761302
The modified gen p mean: 0.44973111152648926, gen p mean: -0.0442376546561718, mean p set: 0.45021140575408936
loss_pred:0.017335614189505577, decouple_loss:0.0013643363490700722
Iteration: 1618, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.452006995677948, gen p mean: -0.04251862317323685, mean p set: 0.4524872899055481
loss_pred:0.01673777773976326, decouple_loss:0.0012373211793601513
The modified gen p mean: 0.45136523246765137, gen p mean: -0.04471863433718681, mean p set: 0.4518454968929291The modified gen p mean: 0.4523071050643921, gen p mean: -0.04131840169429779, mean p set: 0.4527874290943146
loss_pred:0.016828546300530434, decouple_loss:0.0012961378088220954
loss_pred:0.017468174919486046, decouple_loss:0.0011780521599575877
Iteration: 1619, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45157450437545776, gen p mean: -0.04069359228014946, mean p set: 0.45205479860305786
loss_pred:0.016442041844129562, decouple_loss:0.0012770883040502667
The modified gen p mean: 0.4510944187641144, gen p mean: -0.041082415729761124, mean p set: 0.45157474279403687The modified gen p mean: 0.4527052342891693, gen p mean: -0.041347794234752655, mean p set: 0.4531855285167694
loss_pred:0.016785230487585068, decouple_loss:0.0013155760243535042
loss_pred:0.01701780967414379, decouple_loss:0.0013625732390210032
Iteration: 1620, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45156458020210266, gen p mean: -0.043074607849121094, mean p set: 0.45204487442970276
The modified gen p mean: 0.45300528407096863, gen p mean: -0.043710529804229736, mean p set: 0.4534855782985687
loss_pred:0.016510171815752983, decouple_loss:0.0012372188502922654
loss_pred:0.016788383945822716, decouple_loss:0.001253519207239151
The modified gen p mean: 0.4518470764160156, gen p mean: -0.04597469046711922, mean p set: 0.4523273706436157
loss_pred:0.016854535788297653, decouple_loss:0.0013104554964229465
2023-05-01 04:28:09 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.058781154453754425, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.055206459015607834, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.055158693343400955, mean p set: 0.4500633478164673
loss_pred:0.018481966108083725, decouple_loss:0.0013361815363168716
loss_pred:0.017420101910829544, decouple_loss:0.001321770716458559
loss_pred:0.017588427290320396, decouple_loss:0.0012831937056034803
WV_0_PC_1_EH_0_PS_40, loss: 0.017895851284265518, avg_mse: 0.025700131431221962
current test mse: 0.0257
Iteration: 1621, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4515809118747711, gen p mean: -0.04668547213077545, mean p set: 0.4520612061023712
The modified gen p mean: 0.45136353373527527, gen p mean: -0.04774109274148941, mean p set: 0.45184382796287537
The modified gen p mean: 0.4515194892883301, gen p mean: -0.04391687735915184, mean p set: 0.45199981331825256
loss_pred:0.01653108559548855, decouple_loss:0.0010933812009170651
loss_pred:0.016986969858407974, decouple_loss:0.00113000872079283
loss_pred:0.01624891720712185, decouple_loss:0.0012504806509241462
Iteration: 1622, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45138177275657654, gen p mean: -0.051049575209617615, mean p set: 0.45186206698417664
The modified gen p mean: 0.45116686820983887, gen p mean: -0.04993429407477379, mean p set: 0.45164716243743896
loss_pred:0.017378926277160645, decouple_loss:0.0011274743592366576
loss_pred:0.01669163629412651, decouple_loss:0.0013195934006944299
The modified gen p mean: 0.45119529962539673, gen p mean: -0.051714297384023666, mean p set: 0.4516755938529968
loss_pred:0.016755888238549232, decouple_loss:0.0012414655648171902
Iteration: 1623, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4521905481815338, gen p mean: -0.056069668382406235, mean p set: 0.4526708424091339
loss_pred:0.01703500561416149, decouple_loss:0.0012460191501304507
The modified gen p mean: 0.45214134454727173, gen p mean: -0.052611254155635834, mean p set: 0.4526216387748718The modified gen p mean: 0.45214730501174927, gen p mean: -0.04768279567360878, mean p set: 0.452627569437027
loss_pred:0.017521223053336143, decouple_loss:0.0013418544549494982
loss_pred:0.017276860773563385, decouple_loss:0.0012155987787991762
Iteration: 1624, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4516770541667938, gen p mean: -0.05425664037466049, mean p set: 0.4521573483943939
loss_pred:0.017068400979042053, decouple_loss:0.0011758998734876513
The modified gen p mean: 0.4519518315792084, gen p mean: -0.05110213905572891, mean p set: 0.45243212580680847The modified gen p mean: 0.4513913691043854, gen p mean: -0.052784569561481476, mean p set: 0.4518716335296631
loss_pred:0.01651012897491455, decouple_loss:0.00122166913934052
loss_pred:0.016830630600452423, decouple_loss:0.0011034057242795825
Iteration: 1625, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4516157805919647, gen p mean: -0.05063934996724129, mean p set: 0.45209604501724243
loss_pred:0.016960570588707924, decouple_loss:0.001475083758123219
The modified gen p mean: 0.4508665204048157, gen p mean: -0.05509663373231888, mean p set: 0.45134681463241577The modified gen p mean: 0.4505493640899658, gen p mean: -0.05160970240831375, mean p set: 0.4510296881198883
loss_pred:0.016396697610616684, decouple_loss:0.0013796319253742695
loss_pred:0.017332443967461586, decouple_loss:0.001307372353039682
Iteration: 1626, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505445659160614, gen p mean: -0.0467224046587944, mean p set: 0.4510248601436615
loss_pred:0.016795983538031578, decouple_loss:0.0012164083309471607
The modified gen p mean: 0.45163705945014954, gen p mean: -0.045771896839141846, mean p set: 0.45211732387542725The modified gen p mean: 0.4505527913570404, gen p mean: -0.04616856575012207, mean p set: 0.4510330855846405
loss_pred:0.01692761294543743, decouple_loss:0.0011280470062047243
loss_pred:0.016993682831525803, decouple_loss:0.0012003639712929726
Iteration: 1627, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4520340859889984, gen p mean: -0.04191609099507332, mean p set: 0.4525144100189209
loss_pred:0.016799811273813248, decouple_loss:0.0014511895133182406
The modified gen p mean: 0.45138242840766907, gen p mean: -0.044182922691106796, mean p set: 0.4518626928329468
The modified gen p mean: 0.4520479142665863, gen p mean: -0.05288894847035408, mean p set: 0.4525282084941864
loss_pred:0.016608400270342827, decouple_loss:0.0012722696410492063
loss_pred:0.016132844612002373, decouple_loss:0.0015158241149038076
Iteration: 1628, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45159995555877686, gen p mean: -0.04087504372000694, mean p set: 0.45208021998405457
loss_pred:0.016137737780809402, decouple_loss:0.0012773667695000768
The modified gen p mean: 0.450133353471756, gen p mean: -0.04081624746322632, mean p set: 0.45061367750167847The modified gen p mean: 0.4494275450706482, gen p mean: -0.03889155760407448, mean p set: 0.4499078094959259
loss_pred:0.017021698877215385, decouple_loss:0.0013490193523466587
loss_pred:0.017203668132424355, decouple_loss:0.0012650073040276766
Iteration: 1629, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4515424966812134, gen p mean: -0.04456653445959091, mean p set: 0.4520227611064911
loss_pred:0.016594456508755684, decouple_loss:0.0013046199455857277
The modified gen p mean: 0.4500552713871002, gen p mean: -0.039737120270729065, mean p set: 0.45053553581237793
The modified gen p mean: 0.4520275294780731, gen p mean: -0.04381335526704788, mean p set: 0.4525078237056732
loss_pred:0.017199210822582245, decouple_loss:0.0012356797233223915
loss_pred:0.0168419498950243, decouple_loss:0.0012408707989379764
Iteration: 1630, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4518471956253052, gen p mean: -0.04608575254678726, mean p set: 0.4523274898529053
loss_pred:0.016783975064754486, decouple_loss:0.0013185156276449561
The modified gen p mean: 0.45201826095581055, gen p mean: -0.04339933395385742, mean p set: 0.45249855518341064The modified gen p mean: 0.45215368270874023, gen p mean: -0.037823501974344254, mean p set: 0.4526340067386627
loss_pred:0.017047492787241936, decouple_loss:0.0012073343386873603
loss_pred:0.01670326478779316, decouple_loss:0.001620352384634316
2023-05-01 04:30:03 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.053504765033721924, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.049890413880348206, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.049689315259456635, mean p set: 0.4500633478164673
loss_pred:0.018434831872582436, decouple_loss:0.0012615361483767629
loss_pred:0.017425352707505226, decouple_loss:0.0012685691472142935
loss_pred:0.017503906041383743, decouple_loss:0.00122833251953125
WV_0_PC_1_EH_0_PS_40, loss: 0.01785067282617092, avg_mse: 0.025622734799981117
current test mse: 0.025623
Iteration: 1631, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45160791277885437, gen p mean: -0.04073050990700722, mean p set: 0.45208823680877686
The modified gen p mean: 0.45171883702278137, gen p mean: -0.04305774345993996, mean p set: 0.45219916105270386
The modified gen p mean: 0.45196521282196045, gen p mean: -0.050484925508499146, mean p set: 0.45244550704956055
loss_pred:0.015957625582814217, decouple_loss:0.0011468931334093213
loss_pred:0.016316590830683708, decouple_loss:0.001187758520245552
loss_pred:0.01712840609252453, decouple_loss:0.0012236336478963494
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012005_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012005_3_24hr.npz
NaN value num: 0
Iteration: 1632, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450771301984787, gen p mean: -0.04681514948606491, mean p set: 0.4512515664100647
loss_pred:0.014685509726405144, decouple_loss:0.0013893081340938807
The modified gen p mean: 0.45044636726379395, gen p mean: -0.04986121132969856, mean p set: 0.45092666149139404The modified gen p mean: 0.4475174844264984, gen p mean: -0.049150120466947556, mean p set: 0.4479977786540985
loss_pred:0.014551978558301926, decouple_loss:0.0012777290539816022
loss_pred:0.014527159743010998, decouple_loss:0.0014329937985166907
Iteration: 1633, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44969749450683594, gen p mean: -0.048011403530836105, mean p set: 0.4501778185367584
loss_pred:0.014475125819444656, decouple_loss:0.0012525062775239348
The modified gen p mean: 0.4490041136741638, gen p mean: -0.05800553411245346, mean p set: 0.4494844079017639The modified gen p mean: 0.45016369223594666, gen p mean: -0.05038497596979141, mean p set: 0.45064398646354675
loss_pred:0.01492010522633791, decouple_loss:0.001150342053733766
loss_pred:0.013685200363397598, decouple_loss:0.0011519307736307383
Iteration: 1634, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494415819644928, gen p mean: -0.055008694529533386, mean p set: 0.4499218463897705
loss_pred:0.014456360600888729, decouple_loss:0.0013036029413342476
The modified gen p mean: 0.44841182231903076, gen p mean: -0.04824288189411163, mean p set: 0.44889214634895325The modified gen p mean: 0.4499286413192749, gen p mean: -0.05014105513691902, mean p set: 0.450408935546875
loss_pred:0.014683897607028484, decouple_loss:0.001349041354842484
loss_pred:0.014018288813531399, decouple_loss:0.0012710425071418285
Iteration: 1635, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483683109283447, gen p mean: -0.0523853600025177, mean p set: 0.44884857535362244
loss_pred:0.01427118107676506, decouple_loss:0.0013268818147480488
The modified gen p mean: 0.44959110021591187, gen p mean: -0.047073692083358765, mean p set: 0.45007139444351196The modified gen p mean: 0.45020556449890137, gen p mean: -0.045797690749168396, mean p set: 0.4506858289241791
loss_pred:0.014032470993697643, decouple_loss:0.0014481371035799384
loss_pred:0.014251763932406902, decouple_loss:0.0013788671931251884
Iteration: 1636, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44892197847366333, gen p mean: -0.045308634638786316, mean p set: 0.4494022727012634
The modified gen p mean: 0.4505392014980316, gen p mean: -0.041046228259801865, mean p set: 0.4510194957256317loss_pred:0.0147315738722682, decouple_loss:0.0012127856025472283
The modified gen p mean: 0.4489338994026184, gen p mean: -0.04473798722028732, mean p set: 0.4494141638278961
loss_pred:0.01374042872339487, decouple_loss:0.0011970503255724907
loss_pred:0.014652586542069912, decouple_loss:0.0012137811863794923
Iteration: 1637, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45024311542510986, gen p mean: -0.03795585036277771, mean p set: 0.4507233798503876
loss_pred:0.013981490395963192, decouple_loss:0.0013707431498914957
The modified gen p mean: 0.44724041223526, gen p mean: -0.04408035799860954, mean p set: 0.4477207064628601The modified gen p mean: 0.4493323266506195, gen p mean: -0.04276493191719055, mean p set: 0.4498126208782196
loss_pred:0.01353548001497984, decouple_loss:0.0013663283316418529
loss_pred:0.01410351786762476, decouple_loss:0.0013700282434001565
Iteration: 1638, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502202570438385, gen p mean: -0.03944765776395798, mean p set: 0.4507005214691162
loss_pred:0.013419353403151035, decouple_loss:0.001398915541358292
The modified gen p mean: 0.4504387676715851, gen p mean: -0.03680504113435745, mean p set: 0.4509190618991852The modified gen p mean: 0.449152410030365, gen p mean: -0.045022930949926376, mean p set: 0.4496326744556427
loss_pred:0.0139295170083642, decouple_loss:0.001379249501042068
loss_pred:0.013736467808485031, decouple_loss:0.0014278447488322854
Iteration: 1639, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44795694947242737, gen p mean: -0.044556260108947754, mean p set: 0.44843724370002747
loss_pred:0.013792489655315876, decouple_loss:0.0014965819427743554
The modified gen p mean: 0.4500689208507538, gen p mean: -0.036488793790340424, mean p set: 0.4505492150783539The modified gen p mean: 0.4499109387397766, gen p mean: -0.039599161595106125, mean p set: 0.4503912329673767
loss_pred:0.013380013406276703, decouple_loss:0.0014167582849040627
loss_pred:0.013078637421131134, decouple_loss:0.0013845068169757724
Iteration: 1640, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44825124740600586, gen p mean: -0.04401499405503273, mean p set: 0.44873154163360596
The modified gen p mean: 0.4498547613620758, gen p mean: -0.03897399082779884, mean p set: 0.4503350555896759loss_pred:0.013383337296545506, decouple_loss:0.0012722903629764915
The modified gen p mean: 0.45058080554008484, gen p mean: -0.03931763023138046, mean p set: 0.45106109976768494
loss_pred:0.013607203029096127, decouple_loss:0.0014536500675603747
loss_pred:0.013278604485094547, decouple_loss:0.0013052555732429028
2023-05-01 04:32:35 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.04839127138257027, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.044409070163965225, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.04460189491510391, mean p set: 0.4500633478164673
loss_pred:0.019312774762511253, decouple_loss:0.0016010304680094123
loss_pred:0.01831706427037716, decouple_loss:0.001456898869946599
loss_pred:0.018349405378103256, decouple_loss:0.0014384614769369364
WV_0_PC_1_EH_0_PS_40, loss: 0.01873468980193138, avg_mse: 0.027306927368044853
current test mse: 0.027307
Iteration: 1641, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44931894540786743, gen p mean: -0.04701750725507736, mean p set: 0.4497992694377899
The modified gen p mean: 0.44910553097724915, gen p mean: -0.04593822732567787, mean p set: 0.44958579540252686
The modified gen p mean: 0.4501170814037323, gen p mean: -0.04583632946014404, mean p set: 0.4505973160266876
loss_pred:0.013743349350988865, decouple_loss:0.001487565110437572
loss_pred:0.013256636448204517, decouple_loss:0.001463653170503676
loss_pred:0.013962087221443653, decouple_loss:0.0015490081859752536
Iteration: 1642, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487708508968353, gen p mean: -0.04443439841270447, mean p set: 0.4492511451244354
loss_pred:0.014066467061638832, decouple_loss:0.0016121836379170418
The modified gen p mean: 0.4475288987159729, gen p mean: -0.04423973709344864, mean p set: 0.448009192943573The modified gen p mean: 0.4494454860687256, gen p mean: -0.0484938845038414, mean p set: 0.4499257802963257
loss_pred:0.013708788901567459, decouple_loss:0.0015107521321624517
loss_pred:0.013503470458090305, decouple_loss:0.0014922133414074779
Iteration: 1643, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45028233528137207, gen p mean: -0.04544125497341156, mean p set: 0.45076262950897217
loss_pred:0.013029556721448898, decouple_loss:0.0014738589525222778
The modified gen p mean: 0.449002742767334, gen p mean: -0.04746454581618309, mean p set: 0.4494830369949341The modified gen p mean: 0.4500133991241455, gen p mean: -0.04113520681858063, mean p set: 0.4504936933517456
loss_pred:0.01274385116994381, decouple_loss:0.0013736343244090676
loss_pred:0.013247331604361534, decouple_loss:0.0014785074163228273
Iteration: 1644, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494202435016632, gen p mean: -0.04168820381164551, mean p set: 0.4499005675315857
loss_pred:0.013170060701668262, decouple_loss:0.0013992262538522482
The modified gen p mean: 0.4487534165382385, gen p mean: -0.04318595305085182, mean p set: 0.4492337107658386The modified gen p mean: 0.4494165778160095, gen p mean: -0.046444810926914215, mean p set: 0.4498968720436096
loss_pred:0.013219502754509449, decouple_loss:0.0013265989255160093
loss_pred:0.012977366335690022, decouple_loss:0.0013855486176908016
Iteration: 1645, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502854347229004, gen p mean: -0.04493489861488342, mean p set: 0.4507656991481781
loss_pred:0.013128352351486683, decouple_loss:0.0016941925277933478
The modified gen p mean: 0.45034259557724, gen p mean: -0.0442143939435482, mean p set: 0.4508228898048401The modified gen p mean: 0.4483104944229126, gen p mean: -0.04536972939968109, mean p set: 0.4487907588481903
loss_pred:0.013730758801102638, decouple_loss:0.0015339961973950267
loss_pred:0.012958644889295101, decouple_loss:0.0014799570199102163
Iteration: 1646, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495620131492615, gen p mean: -0.048111867159605026, mean p set: 0.4500423073768616
loss_pred:0.013633014634251595, decouple_loss:0.00144730054307729
The modified gen p mean: 0.4478796720504761, gen p mean: -0.04616091027855873, mean p set: 0.44835996627807617The modified gen p mean: 0.4505947530269623, gen p mean: -0.05136405676603317, mean p set: 0.4510750472545624
loss_pred:0.01340857706964016, decouple_loss:0.0015107333892956376
loss_pred:0.013706629164516926, decouple_loss:0.0014418188948184252
Iteration: 1647, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448871374130249, gen p mean: -0.05091758817434311, mean p set: 0.4493516683578491
loss_pred:0.013531161472201347, decouple_loss:0.0012853898806497455
The modified gen p mean: 0.4492276608943939, gen p mean: -0.048302166163921356, mean p set: 0.449707955121994The modified gen p mean: 0.447736918926239, gen p mean: -0.04825561121106148, mean p set: 0.4482172131538391
loss_pred:0.01334904320538044, decouple_loss:0.0012899290304630995
loss_pred:0.01330652367323637, decouple_loss:0.0015614682342857122
Iteration: 1648, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494057595729828, gen p mean: -0.05230429768562317, mean p set: 0.4498860538005829
loss_pred:0.013537717051804066, decouple_loss:0.0015232291771098971
The modified gen p mean: 0.4490104019641876, gen p mean: -0.045526664704084396, mean p set: 0.44949066638946533The modified gen p mean: 0.4496532380580902, gen p mean: -0.04738534986972809, mean p set: 0.4501335322856903
loss_pred:0.013657113537192345, decouple_loss:0.0014474326744675636
loss_pred:0.012985258363187313, decouple_loss:0.0014591095969080925
Iteration: 1649, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448622465133667, gen p mean: -0.04465814307332039, mean p set: 0.4491027593612671
loss_pred:0.013581287115812302, decouple_loss:0.0012782476842403412
The modified gen p mean: 0.4472036361694336, gen p mean: -0.04917528107762337, mean p set: 0.4476839303970337The modified gen p mean: 0.44951102137565613, gen p mean: -0.04386764392256737, mean p set: 0.4499913156032562
loss_pred:0.013033249415457249, decouple_loss:0.0014420772204175591
loss_pred:0.013012690469622612, decouple_loss:0.0014137235702946782
Iteration: 1650, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44891074299812317, gen p mean: -0.0470019169151783, mean p set: 0.44939103722572327
loss_pred:0.013289050199091434, decouple_loss:0.0014048170996829867
The modified gen p mean: 0.450418621301651, gen p mean: -0.04360851272940636, mean p set: 0.4508989155292511The modified gen p mean: 0.4490760564804077, gen p mean: -0.04994993284344673, mean p set: 0.4495563805103302
loss_pred:0.013480893336236477, decouple_loss:0.0014305954100564122
loss_pred:0.013042137958109379, decouple_loss:0.0013985034311190248
2023-05-01 04:34:28 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.04582499340176582, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04181470349431038, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.04192527011036873, mean p set: 0.4500633478164673
loss_pred:0.019229654222726822, decouple_loss:0.0013707352336496115
loss_pred:0.018197542056441307, decouple_loss:0.0015194477746263146
loss_pred:0.01824399270117283, decouple_loss:0.0014427317073568702
WV_0_PC_1_EH_0_PS_40, loss: 0.018629278987646103, avg_mse: 0.027168862521648407
current test mse: 0.027169
Iteration: 1651, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484518766403198, gen p mean: -0.03972291946411133, mean p set: 0.4489321708679199
The modified gen p mean: 0.44969743490219116, gen p mean: -0.04353735223412514, mean p set: 0.45017769932746887
The modified gen p mean: 0.44905534386634827, gen p mean: -0.038719817996025085, mean p set: 0.44953563809394836
loss_pred:0.013004777021706104, decouple_loss:0.0015167504316195846
loss_pred:0.012947436422109604, decouple_loss:0.0013672041241079569
loss_pred:0.012853438965976238, decouple_loss:0.0014574117958545685
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012012_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012012_3_24hr.npz
NaN value num: 0
Iteration: 1652, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450235515832901, gen p mean: -0.03707634657621384, mean p set: 0.4507158100605011
loss_pred:0.017463432624936104, decouple_loss:0.001654821797274053
The modified gen p mean: 0.4524537920951843, gen p mean: -0.03912900388240814, mean p set: 0.4529340863227844The modified gen p mean: 0.4529753029346466, gen p mean: -0.03423934057354927, mean p set: 0.4534555673599243
loss_pred:0.017756571993231773, decouple_loss:0.001583104720339179
loss_pred:0.0184969250112772, decouple_loss:0.0016190203605219722
Iteration: 1653, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45103585720062256, gen p mean: -0.03270383179187775, mean p set: 0.45151615142822266
loss_pred:0.017286837100982666, decouple_loss:0.0016025849618017673
The modified gen p mean: 0.4511535167694092, gen p mean: -0.031057696789503098, mean p set: 0.4516338109970093The modified gen p mean: 0.45076048374176025, gen p mean: -0.03445009887218475, mean p set: 0.45124077796936035
loss_pred:0.016424547880887985, decouple_loss:0.001580400625243783
loss_pred:0.017571358010172844, decouple_loss:0.0014888005098327994
Iteration: 1654, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4531868100166321, gen p mean: -0.03431742265820503, mean p set: 0.4536671042442322
The modified gen p mean: 0.45122694969177246, gen p mean: -0.03755040466785431, mean p set: 0.45170727372169495
loss_pred:0.017314353957772255, decouple_loss:0.0014258150476962328
loss_pred:0.016928356140851974, decouple_loss:0.0015176096931099892
The modified gen p mean: 0.45296192169189453, gen p mean: -0.03636418282985687, mean p set: 0.45344221591949463
loss_pred:0.01808176189661026, decouple_loss:0.0015675356844440103
Iteration: 1655, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45041078329086304, gen p mean: -0.03376882150769234, mean p set: 0.45089107751846313
loss_pred:0.017603622749447823, decouple_loss:0.0017848736606538296
The modified gen p mean: 0.4527921676635742, gen p mean: -0.02930329367518425, mean p set: 0.4532724618911743The modified gen p mean: 0.45320770144462585, gen p mean: -0.043349649757146835, mean p set: 0.45368802547454834
loss_pred:0.017601585015654564, decouple_loss:0.0016650597099214792
loss_pred:0.018164601176977158, decouple_loss:0.0017355290474370122
Iteration: 1656, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4510819911956787, gen p mean: -0.03205623850226402, mean p set: 0.4515622556209564
loss_pred:0.01727036014199257, decouple_loss:0.0014670045347884297
The modified gen p mean: 0.4531252980232239, gen p mean: -0.032276950776576996, mean p set: 0.45360562205314636The modified gen p mean: 0.45273756980895996, gen p mean: -0.04033830016851425, mean p set: 0.45321789383888245
loss_pred:0.01786484569311142, decouple_loss:0.0016188871813938022
loss_pred:0.017294811084866524, decouple_loss:0.001471748691983521
Iteration: 1657, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508955180644989, gen p mean: -0.03680982440710068, mean p set: 0.451375812292099
loss_pred:0.01791159249842167, decouple_loss:0.0016810584347695112
The modified gen p mean: 0.4522748589515686, gen p mean: -0.04395059868693352, mean p set: 0.4527551829814911The modified gen p mean: 0.45216771960258484, gen p mean: -0.04128333553671837, mean p set: 0.4526480436325073
loss_pred:0.017474139109253883, decouple_loss:0.001816584961488843
loss_pred:0.017077013850212097, decouple_loss:0.0017750400584191084
Iteration: 1658, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45124709606170654, gen p mean: -0.03127970173954964, mean p set: 0.45172739028930664
loss_pred:0.01686638966202736, decouple_loss:0.0015465128235518932
The modified gen p mean: 0.4526158273220062, gen p mean: -0.030450018122792244, mean p set: 0.45309609174728394The modified gen p mean: 0.4515746533870697, gen p mean: -0.03927534446120262, mean p set: 0.4520549178123474
loss_pred:0.017480282112956047, decouple_loss:0.0015247190603986382
loss_pred:0.018164075911045074, decouple_loss:0.0015489071374759078
Iteration: 1659, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4533539414405823, gen p mean: -0.039119988679885864, mean p set: 0.45383426547050476
loss_pred:0.017786141484975815, decouple_loss:0.001642028335481882
The modified gen p mean: 0.45073312520980835, gen p mean: -0.034770846366882324, mean p set: 0.45121341943740845The modified gen p mean: 0.451018363237381, gen p mean: -0.04078901931643486, mean p set: 0.4514986276626587
loss_pred:0.01730373129248619, decouple_loss:0.0016035772860050201
loss_pred:0.01682165451347828, decouple_loss:0.0016154944896697998
Iteration: 1660, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514777958393097, gen p mean: -0.04315388202667236, mean p set: 0.4519580900669098
loss_pred:0.0174236036837101, decouple_loss:0.0016623899573460221
The modified gen p mean: 0.4523821473121643, gen p mean: -0.039912138134241104, mean p set: 0.452862411737442The modified gen p mean: 0.4503174424171448, gen p mean: -0.03684148192405701, mean p set: 0.4507977068424225
loss_pred:0.017183858901262283, decouple_loss:0.0016192100010812283
loss_pred:0.017063815146684647, decouple_loss:0.0014347066171467304
2023-05-01 04:36:59 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.04164566472172737, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.03788990154862404, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.03833687677979469, mean p set: 0.4500633478164673
loss_pred:0.01854071579873562, decouple_loss:0.0018733653705567122
loss_pred:0.017521901056170464, decouple_loss:0.0017181079601868987
loss_pred:0.01756512187421322, decouple_loss:0.001705489819869399
WV_0_PC_1_EH_0_PS_40, loss: 0.0179641954600811, avg_mse: 0.02579660154879093
current test mse: 0.025797
Iteration: 1661, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4532085359096527, gen p mean: -0.037337858229875565, mean p set: 0.4536888301372528
The modified gen p mean: 0.45210137963294983, gen p mean: -0.028489282354712486, mean p set: 0.45258164405822754
The modified gen p mean: 0.45140978693962097, gen p mean: -0.03637828305363655, mean p set: 0.45189008116722107
loss_pred:0.017189132049679756, decouple_loss:0.0014671505196020007
loss_pred:0.01773962564766407, decouple_loss:0.001518096192739904
loss_pred:0.017780063673853874, decouple_loss:0.0016112057492136955
Iteration: 1662, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45076799392700195, gen p mean: -0.027995282784104347, mean p set: 0.45124828815460205
The modified gen p mean: 0.45189720392227173, gen p mean: -0.02737504057586193, mean p set: 0.4523775279521942
loss_pred:0.01703047566115856, decouple_loss:0.001404477865435183
loss_pred:0.016965454444289207, decouple_loss:0.0014395258622244The modified gen p mean: 0.45252203941345215, gen p mean: -0.025103667750954628, mean p set: 0.45300236344337463
loss_pred:0.01715635322034359, decouple_loss:0.0014825455145910382
Iteration: 1663, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45237088203430176, gen p mean: -0.03014637902379036, mean p set: 0.45285117626190186
loss_pred:0.017453396692872047, decouple_loss:0.0013502741931006312
The modified gen p mean: 0.45180171728134155, gen p mean: -0.03527979180216789, mean p set: 0.45228198170661926
The modified gen p mean: 0.4520900249481201, gen p mean: -0.03305637463927269, mean p set: 0.4525703489780426
loss_pred:0.017545199021697044, decouple_loss:0.0013789597433060408
loss_pred:0.01718030497431755, decouple_loss:0.0014076371444389224
Iteration: 1664, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45364052057266235, gen p mean: -0.03578219562768936, mean p set: 0.45412078499794006
loss_pred:0.01711225137114525, decouple_loss:0.0014263546327129006
The modified gen p mean: 0.4521215856075287, gen p mean: -0.03641828894615173, mean p set: 0.4526018798351288The modified gen p mean: 0.45095402002334595, gen p mean: -0.037514735013246536, mean p set: 0.45143428444862366
loss_pred:0.01696483977138996, decouple_loss:0.0013830525567755103
loss_pred:0.01637500524520874, decouple_loss:0.0013780907029286027
Iteration: 1665, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45342594385147095, gen p mean: -0.03957001864910126, mean p set: 0.45390620827674866
loss_pred:0.017595725134015083, decouple_loss:0.0014828145503997803
The modified gen p mean: 0.45251381397247314, gen p mean: -0.036992937326431274, mean p set: 0.45299410820007324The modified gen p mean: 0.4520992636680603, gen p mean: -0.03790279105305672, mean p set: 0.4525795578956604
loss_pred:0.017410991713404655, decouple_loss:0.001431527198292315
loss_pred:0.0171139445155859, decouple_loss:0.0015054447576403618
Iteration: 1666, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45133817195892334, gen p mean: -0.04715365916490555, mean p set: 0.45181846618652344
loss_pred:0.01703345775604248, decouple_loss:0.0013388182269409299
The modified gen p mean: 0.45189446210861206, gen p mean: -0.048940956592559814, mean p set: 0.45237478613853455The modified gen p mean: 0.4524152874946594, gen p mean: -0.05273769423365593, mean p set: 0.4528955817222595
loss_pred:0.01732301153242588, decouple_loss:0.001347026089206338
loss_pred:0.01725982502102852, decouple_loss:0.001353670610114932
Iteration: 1667, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45267388224601746, gen p mean: -0.03972914069890976, mean p set: 0.45315417647361755
loss_pred:0.01706908643245697, decouple_loss:0.0014527699677273631
The modified gen p mean: 0.45308157801628113, gen p mean: -0.04257579892873764, mean p set: 0.4535618722438812The modified gen p mean: 0.45206180214881897, gen p mean: -0.04746556282043457, mean p set: 0.45254209637641907
loss_pred:0.016651960089802742, decouple_loss:0.0015857346588745713
loss_pred:0.017314869910478592, decouple_loss:0.0013766209594905376
Iteration: 1668, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45143890380859375, gen p mean: -0.04689472168684006, mean p set: 0.45191919803619385
loss_pred:0.016396543011069298, decouple_loss:0.0012673885794356465
The modified gen p mean: 0.45094770193099976, gen p mean: -0.04105472192168236, mean p set: 0.45142796635627747The modified gen p mean: 0.451753169298172, gen p mean: -0.05176282674074173, mean p set: 0.4522334337234497
loss_pred:0.016342198476195335, decouple_loss:0.0013420286122709513
loss_pred:0.01663959212601185, decouple_loss:0.0013711410574615002
Iteration: 1669, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508211314678192, gen p mean: -0.04219339042901993, mean p set: 0.4513013958930969
The modified gen p mean: 0.4513908624649048, gen p mean: -0.037956979125738144, mean p set: 0.4518711566925049
loss_pred:0.016909057274460793, decouple_loss:0.0012215159367769957
loss_pred:0.017274880781769753, decouple_loss:0.00124131899792701
The modified gen p mean: 0.4513874351978302, gen p mean: -0.046113062649965286, mean p set: 0.4518677592277527
loss_pred:0.01677660644054413, decouple_loss:0.0012277963105589151
Iteration: 1670, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45333120226860046, gen p mean: -0.037316616624593735, mean p set: 0.45381149649620056
loss_pred:0.017230141907930374, decouple_loss:0.0012309735175222158
The modified gen p mean: 0.4513090252876282, gen p mean: -0.03935372084379196, mean p set: 0.4517892897129059The modified gen p mean: 0.45061159133911133, gen p mean: -0.03977961838245392, mean p set: 0.4510918855667114
loss_pred:0.016698433086276054, decouple_loss:0.0012757095973938704
loss_pred:0.01704597845673561, decouple_loss:0.0013211892219260335
2023-05-01 04:38:52 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.04804662615060806, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.044530998915433884, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830237865448, gen p mean: -0.04462447762489319, mean p set: 0.4500633478164673
loss_pred:0.01844312995672226, decouple_loss:0.0014612883096560836
loss_pred:0.017362629994750023, decouple_loss:0.001406957395374775
loss_pred:0.01748513989150524, decouple_loss:0.0013781095622107387
WV_0_PC_1_EH_0_PS_40, loss: 0.017834406346082687, avg_mse: 0.02559056505560875
current test mse: 0.025591
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012008_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012008_3_24hr.npz
NaN value num: 0
Iteration: 1671, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446099191904068, gen p mean: -0.04828834906220436, mean p set: 0.4465794563293457
loss_pred:0.01524106040596962, decouple_loss:0.0013927173567935824
The modified gen p mean: 0.44674137234687805, gen p mean: -0.04858371242880821, mean p set: 0.44722166657447815The modified gen p mean: 0.44680383801460266, gen p mean: -0.04602771997451782, mean p set: 0.44728413224220276
loss_pred:0.014889523386955261, decouple_loss:0.0013386283535510302
loss_pred:0.014704164117574692, decouple_loss:0.001432226039469242
Iteration: 1672, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467865228652954, gen p mean: -0.05281767249107361, mean p set: 0.4472668468952179
loss_pred:0.01461524423211813, decouple_loss:0.0015552224358543754
The modified gen p mean: 0.4466664791107178, gen p mean: -0.047508325427770615, mean p set: 0.4471467435359955The modified gen p mean: 0.44671717286109924, gen p mean: -0.049930915236473083, mean p set: 0.44719746708869934
loss_pred:0.015039312653243542, decouple_loss:0.0014427865389734507
loss_pred:0.01467620488256216, decouple_loss:0.0014404281973838806
Iteration: 1673, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4461154639720917, gen p mean: -0.053801342844963074, mean p set: 0.44659578800201416
loss_pred:0.014312763698399067, decouple_loss:0.0013862388441339135
The modified gen p mean: 0.4468805491924286, gen p mean: -0.05221272259950638, mean p set: 0.4473608434200287The modified gen p mean: 0.4477648138999939, gen p mean: -0.04776296392083168, mean p set: 0.4482450783252716
loss_pred:0.01461923960596323, decouple_loss:0.001371830003336072
loss_pred:0.014319573529064655, decouple_loss:0.001295616733841598
Iteration: 1674, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465217888355255, gen p mean: -0.052064407616853714, mean p set: 0.4470020830631256
loss_pred:0.014269712381064892, decouple_loss:0.0013877206947654486
The modified gen p mean: 0.44661515951156616, gen p mean: -0.0534304641187191, mean p set: 0.44709545373916626The modified gen p mean: 0.44700536131858826, gen p mean: -0.05193455517292023, mean p set: 0.44748565554618835
loss_pred:0.014162212610244751, decouple_loss:0.001291907043196261
loss_pred:0.014098200015723705, decouple_loss:0.0013717019464820623
Iteration: 1675, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44698432087898254, gen p mean: -0.05108887329697609, mean p set: 0.44746461510658264
loss_pred:0.014062941074371338, decouple_loss:0.001387779600918293
The modified gen p mean: 0.44610628485679626, gen p mean: -0.0495721735060215, mean p set: 0.44658660888671875The modified gen p mean: 0.4466868042945862, gen p mean: -0.044125523418188095, mean p set: 0.4471670687198639
loss_pred:0.01449353527277708, decouple_loss:0.0014459280064329505
loss_pred:0.014285694807767868, decouple_loss:0.0014636617852374911
Iteration: 1676, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44605761766433716, gen p mean: -0.04587249085307121, mean p set: 0.44653791189193726
loss_pred:0.014283278957009315, decouple_loss:0.001455041579902172
The modified gen p mean: 0.4466697573661804, gen p mean: -0.04900519177317619, mean p set: 0.4471500515937805The modified gen p mean: 0.4463663399219513, gen p mean: -0.04842770844697952, mean p set: 0.446846604347229
loss_pred:0.014300301671028137, decouple_loss:0.001373104751110077
loss_pred:0.014307175762951374, decouple_loss:0.001446882146410644
Iteration: 1677, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469769299030304, gen p mean: -0.0488249771296978, mean p set: 0.4474572241306305
loss_pred:0.013964006677269936, decouple_loss:0.001468972535803914
The modified gen p mean: 0.4470561742782593, gen p mean: -0.04422449320554733, mean p set: 0.4475364685058594The modified gen p mean: 0.44634103775024414, gen p mean: -0.0502346009016037, mean p set: 0.44682133197784424
loss_pred:0.013897937722504139, decouple_loss:0.0014043619157746434
loss_pred:0.013972334563732147, decouple_loss:0.0014825144317001104
Iteration: 1678, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484494626522064, gen p mean: -0.04695006087422371, mean p set: 0.4489297568798065
loss_pred:0.013778249733150005, decouple_loss:0.001481533981859684
The modified gen p mean: 0.44517549872398376, gen p mean: -0.05052465945482254, mean p set: 0.44565579295158386The modified gen p mean: 0.44680145382881165, gen p mean: -0.05092174932360649, mean p set: 0.44728177785873413
loss_pred:0.01396253239363432, decouple_loss:0.0014299115864560008
loss_pred:0.013903915882110596, decouple_loss:0.0014598410343751311
Iteration: 1679, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464333653450012, gen p mean: -0.05210167542099953, mean p set: 0.44691362977027893
loss_pred:0.013943832367658615, decouple_loss:0.001606095116585493
The modified gen p mean: 0.4465153217315674, gen p mean: -0.05293907970190048, mean p set: 0.44699564576148987The modified gen p mean: 0.44643449783325195, gen p mean: -0.048690468072891235, mean p set: 0.44691479206085205
loss_pred:0.013817064464092255, decouple_loss:0.0015830000629648566
loss_pred:0.014297803863883018, decouple_loss:0.0015688478015363216
Iteration: 1680, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4461233913898468, gen p mean: -0.04698653891682625, mean p set: 0.4466037154197693
loss_pred:0.01397696416825056, decouple_loss:0.0014862389070913196
The modified gen p mean: 0.4459965229034424, gen p mean: -0.05030620098114014, mean p set: 0.44647684693336487The modified gen p mean: 0.44756370782852173, gen p mean: -0.04711426794528961, mean p set: 0.4480440020561218
loss_pred:0.013631056994199753, decouple_loss:0.0014660661108791828
loss_pred:0.014564755372703075, decouple_loss:0.0014148163609206676
2023-05-01 04:41:29 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.04945359751582146, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04562881588935852, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.0460917130112648, mean p set: 0.4500633478164673
loss_pred:0.019264115020632744, decouple_loss:0.0015885519096627831
loss_pred:0.018131433054804802, decouple_loss:0.0015586480731144547
loss_pred:0.018241390585899353, decouple_loss:0.0014576773392036557
WV_0_PC_1_EH_0_PS_40, loss: 0.018622394651174545, avg_mse: 0.02710384503006935
current test mse: 0.027104
Iteration: 1681, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468703269958496, gen p mean: -0.048964403569698334, mean p set: 0.4473506212234497
The modified gen p mean: 0.44705238938331604, gen p mean: -0.0480881929397583, mean p set: 0.44753265380859375
The modified gen p mean: 0.4467034637928009, gen p mean: -0.04685115069150925, mean p set: 0.447183758020401
loss_pred:0.013874717988073826, decouple_loss:0.0015339208766818047
loss_pred:0.013692284002900124, decouple_loss:0.001395954517647624
loss_pred:0.013890075497329235, decouple_loss:0.001609685248695314
Iteration: 1682, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44694986939430237, gen p mean: -0.04571104049682617, mean p set: 0.4474301338195801
The modified gen p mean: 0.44633927941322327, gen p mean: -0.047585926949977875, mean p set: 0.446819543838501
loss_pred:0.01382092759013176, decouple_loss:0.0013410565443336964
The modified gen p mean: 0.446519672870636, gen p mean: -0.04655465483665466, mean p set: 0.4469999372959137loss_pred:0.014072883874177933, decouple_loss:0.0014291375409811735
loss_pred:0.013853116892278194, decouple_loss:0.0013391657266765833
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1683, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468380808830261, gen p mean: -0.043094784021377563, mean p set: 0.4473183751106262
loss_pred:0.013724738731980324, decouple_loss:0.0013556359335780144
The modified gen p mean: 0.4460671544075012, gen p mean: -0.044790007174015045, mean p set: 0.4465474784374237The modified gen p mean: 0.44794607162475586, gen p mean: -0.04523241147398949, mean p set: 0.44842633605003357
loss_pred:0.013698825612664223, decouple_loss:0.0013807915383949876
loss_pred:0.0134440828114748, decouple_loss:0.0014736078446730971
Iteration: 1684, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44520431756973267, gen p mean: -0.04449968412518501, mean p set: 0.4456845819950104
loss_pred:0.013656800612807274, decouple_loss:0.0014070738106966019
The modified gen p mean: 0.44530782103538513, gen p mean: -0.045335229486227036, mean p set: 0.44578808546066284The modified gen p mean: 0.44632676243782043, gen p mean: -0.04520418494939804, mean p set: 0.44680705666542053
loss_pred:0.01338270679116249, decouple_loss:0.0015095886774361134
loss_pred:0.01369968056678772, decouple_loss:0.0014065545983612537
Iteration: 1685, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4456709921360016, gen p mean: -0.046870358288288116, mean p set: 0.4461512565612793
loss_pred:0.013712910935282707, decouple_loss:0.0014179367572069168
The modified gen p mean: 0.44701677560806274, gen p mean: -0.042729005217552185, mean p set: 0.44749704003334045The modified gen p mean: 0.4472530484199524, gen p mean: -0.042525533586740494, mean p set: 0.4477333426475525
loss_pred:0.014297028072178364, decouple_loss:0.0013699441915377975
loss_pred:0.014360005967319012, decouple_loss:0.0013622299302369356
Iteration: 1686, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477007985115051, gen p mean: -0.04521918296813965, mean p set: 0.44818106293678284
loss_pred:0.013651237823069096, decouple_loss:0.0013093429151922464
The modified gen p mean: 0.44759318232536316, gen p mean: -0.048211537301540375, mean p set: 0.44807347655296326The modified gen p mean: 0.4472448229789734, gen p mean: -0.04734247177839279, mean p set: 0.4477251172065735
loss_pred:0.013582078740000725, decouple_loss:0.0013200636021792889
loss_pred:0.013757837936282158, decouple_loss:0.0013063778169453144
Iteration: 1687, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44758808612823486, gen p mean: -0.04662797600030899, mean p set: 0.44806838035583496
loss_pred:0.013160173781216145, decouple_loss:0.0013330689398571849
The modified gen p mean: 0.4466235041618347, gen p mean: -0.04674370959401131, mean p set: 0.4471038281917572The modified gen p mean: 0.44681304693222046, gen p mean: -0.04947515204548836, mean p set: 0.44729331135749817
loss_pred:0.013520577922463417, decouple_loss:0.0013068123953416944
loss_pred:0.013726538047194481, decouple_loss:0.001337677240371704
Iteration: 1688, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471513628959656, gen p mean: -0.046436063945293427, mean p set: 0.4476316571235657
loss_pred:0.01399312261492014, decouple_loss:0.0012622483773157
The modified gen p mean: 0.4453771114349365, gen p mean: -0.050263985991477966, mean p set: 0.445857435464859The modified gen p mean: 0.44740474224090576, gen p mean: -0.04853455349802971, mean p set: 0.44788506627082825
loss_pred:0.013594746589660645, decouple_loss:0.0013483708025887609
loss_pred:0.013766290619969368, decouple_loss:0.0013543260283768177
Iteration: 1689, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468212425708771, gen p mean: -0.047517288476228714, mean p set: 0.44730156660079956
loss_pred:0.013580895029008389, decouple_loss:0.0013338911812752485
The modified gen p mean: 0.44679540395736694, gen p mean: -0.046877652406692505, mean p set: 0.44727569818496704The modified gen p mean: 0.44656580686569214, gen p mean: -0.044031623750925064, mean p set: 0.44704607129096985
loss_pred:0.013541562482714653, decouple_loss:0.0012971751857548952
loss_pred:0.01363797951489687, decouple_loss:0.0012838689144700766
Iteration: 1690, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44657978415489197, gen p mean: -0.04522337764501572, mean p set: 0.44706007838249207
loss_pred:0.01336702797561884, decouple_loss:0.0012810250045731664
The modified gen p mean: 0.44678202271461487, gen p mean: -0.04789567366242409, mean p set: 0.44726231694221497The modified gen p mean: 0.44734692573547363, gen p mean: -0.050292957574129105, mean p set: 0.44782721996307373
loss_pred:0.013417382724583149, decouple_loss:0.0012087642680853605
loss_pred:0.01338757760822773, decouple_loss:0.0012811950873583555
2023-05-01 04:43:23 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.04715627804398537, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.042957521975040436, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.04338158667087555, mean p set: 0.4500633478164673
loss_pred:0.01907452382147312, decouple_loss:0.0013111685402691364
loss_pred:0.017945118248462677, decouple_loss:0.0013484567170962691
loss_pred:0.018034275621175766, decouple_loss:0.0013480068882927299
WV_0_PC_1_EH_0_PS_40, loss: 0.018418099731206894, avg_mse: 0.026772942394018173
current test mse: 0.026773
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012014_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012014_3_24hr.npz
NaN value num: 0
Iteration: 1691, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45299434661865234, gen p mean: -0.03786927089095116, mean p set: 0.45347464084625244
loss_pred:0.016875503584742546, decouple_loss:0.001695179147645831
The modified gen p mean: 0.4526252746582031, gen p mean: -0.03369757533073425, mean p set: 0.4531055688858032The modified gen p mean: 0.45261842012405396, gen p mean: -0.03391268476843834, mean p set: 0.45309871435165405
loss_pred:0.01717585138976574, decouple_loss:0.001662211143411696
loss_pred:0.016992704942822456, decouple_loss:0.0016569944564253092
Iteration: 1692, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45000267028808594, gen p mean: -0.035816024988889694, mean p set: 0.4504829943180084
loss_pred:0.015678703784942627, decouple_loss:0.0013844008790329099
The modified gen p mean: 0.45068982243537903, gen p mean: -0.03477821499109268, mean p set: 0.4511701166629791
The modified gen p mean: 0.450194776058197, gen p mean: -0.03575429320335388, mean p set: 0.45067504048347473
loss_pred:0.01651826687157154, decouple_loss:0.001408807118423283
loss_pred:0.016348185017704964, decouple_loss:0.0014466569991782308
Iteration: 1693, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492179751396179, gen p mean: -0.03813573345541954, mean p set: 0.4496982991695404
loss_pred:0.016310347244143486, decouple_loss:0.001598428119905293
The modified gen p mean: 0.4521403908729553, gen p mean: -0.040110982954502106, mean p set: 0.45262065529823303The modified gen p mean: 0.4501752555370331, gen p mean: -0.03852058947086334, mean p set: 0.4506555497646332
loss_pred:0.017033308744430542, decouple_loss:0.001721051405183971
loss_pred:0.017102999612689018, decouple_loss:0.0016510324785485864
Iteration: 1694, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513232409954071, gen p mean: -0.03739986568689346, mean p set: 0.4518035352230072
loss_pred:0.016854383051395416, decouple_loss:0.0013528299750760198
The modified gen p mean: 0.4532533288002014, gen p mean: -0.035239916294813156, mean p set: 0.4537335932254791The modified gen p mean: 0.45020055770874023, gen p mean: -0.03327028825879097, mean p set: 0.45068085193634033
loss_pred:0.017093224450945854, decouple_loss:0.0014808123232796788
loss_pred:0.016165899112820625, decouple_loss:0.0016474304720759392
Iteration: 1695, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4519236981868744, gen p mean: -0.03720191866159439, mean p set: 0.4524039626121521
loss_pred:0.016150204464793205, decouple_loss:0.0015284086111932993
The modified gen p mean: 0.449970006942749, gen p mean: -0.034075167030096054, mean p set: 0.4504503011703491The modified gen p mean: 0.45005980134010315, gen p mean: -0.035794924944639206, mean p set: 0.45054012537002563
loss_pred:0.017011074349284172, decouple_loss:0.001500103622674942
loss_pred:0.017152009531855583, decouple_loss:0.0014604453463107347
Iteration: 1696, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4517694115638733, gen p mean: -0.034876588732004166, mean p set: 0.4522497057914734
loss_pred:0.01683429814875126, decouple_loss:0.0015215026214718819
The modified gen p mean: 0.4500267803668976, gen p mean: -0.03163491189479828, mean p set: 0.4505070447921753The modified gen p mean: 0.44960248470306396, gen p mean: -0.035618625581264496, mean p set: 0.45008277893066406
loss_pred:0.017917176708579063, decouple_loss:0.0013365386985242367
loss_pred:0.016530832275748253, decouple_loss:0.0014086501905694604
Iteration: 1697, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494049847126007, gen p mean: -0.03703609108924866, mean p set: 0.4498852789402008
loss_pred:0.017176194116473198, decouple_loss:0.00129038468003273
The modified gen p mean: 0.45024290680885315, gen p mean: -0.036242857575416565, mean p set: 0.45072323083877563The modified gen p mean: 0.4532553255558014, gen p mean: -0.03631202504038811, mean p set: 0.4537356197834015
loss_pred:0.015882790088653564, decouple_loss:0.0014032385079190135
loss_pred:0.016765641048550606, decouple_loss:0.001520185498520732
Iteration: 1698, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45263898372650146, gen p mean: -0.038223326206207275, mean p set: 0.45311927795410156
loss_pred:0.016082579270005226, decouple_loss:0.0013366194907575846
The modified gen p mean: 0.4502231180667877, gen p mean: -0.03728984668850899, mean p set: 0.4507034122943878The modified gen p mean: 0.4497902989387512, gen p mean: -0.03912700340151787, mean p set: 0.4502705931663513
loss_pred:0.016558488830924034, decouple_loss:0.001396886189468205
loss_pred:0.01583848148584366, decouple_loss:0.0013210447505116463
Iteration: 1699, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4515954256057739, gen p mean: -0.03735540807247162, mean p set: 0.45207569003105164
loss_pred:0.016398664563894272, decouple_loss:0.001347307930700481
The modified gen p mean: 0.45062196254730225, gen p mean: -0.03535642847418785, mean p set: 0.45110225677490234
The modified gen p mean: 0.4507703185081482, gen p mean: -0.031898606568574905, mean p set: 0.4512505531311035
loss_pred:0.016391877084970474, decouple_loss:0.0013415614375844598
loss_pred:0.01727226935327053, decouple_loss:0.0013517198385670781
Iteration: 1700, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45142993330955505, gen p mean: -0.03975833207368851, mean p set: 0.45191025733947754
loss_pred:0.016114922240376472, decouple_loss:0.0013052363647148013
The modified gen p mean: 0.4520683288574219, gen p mean: -0.04094173014163971, mean p set: 0.4525485932826996The modified gen p mean: 0.45041683316230774, gen p mean: -0.03665946424007416, mean p set: 0.4508971571922302
loss_pred:0.016210712492465973, decouple_loss:0.001344422809779644
loss_pred:0.016496548429131508, decouple_loss:0.001327971462160349
2023-05-01 04:45:59 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.04900894686579704, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04455205053091049, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04522538557648659, mean p set: 0.4500633478164673
loss_pred:0.018728021532297134, decouple_loss:0.0015153728891164064
loss_pred:0.017596760764718056, decouple_loss:0.0015519886510446668
loss_pred:0.017707834020256996, decouple_loss:0.0014805995160713792
WV_0_PC_1_EH_0_PS_40, loss: 0.018086671829223633, avg_mse: 0.026091184467077255
current test mse: 0.026091
Iteration: 1701, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450313001871109, gen p mean: -0.03701343387365341, mean p set: 0.4507932960987091
The modified gen p mean: 0.45138290524482727, gen p mean: -0.04221788048744202, mean p set: 0.45186319947242737
The modified gen p mean: 0.4505433738231659, gen p mean: -0.03754532337188721, mean p set: 0.4510236978530884
loss_pred:0.01605316437780857, decouple_loss:0.001186592155136168
loss_pred:0.0160350501537323, decouple_loss:0.00115697062574327
loss_pred:0.01672792062163353, decouple_loss:0.0012148080859333277
Iteration: 1702, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499615430831909, gen p mean: -0.036725495010614395, mean p set: 0.450441837310791
loss_pred:0.016388684511184692, decouple_loss:0.0012242700904607773
The modified gen p mean: 0.45090559124946594, gen p mean: -0.03670932725071907, mean p set: 0.4513859152793884The modified gen p mean: 0.4504302144050598, gen p mean: -0.03932080417871475, mean p set: 0.4509105384349823
loss_pred:0.01692405343055725, decouple_loss:0.001170843606814742
loss_pred:0.016667792573571205, decouple_loss:0.0012661705259233713
Iteration: 1703, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500761032104492, gen p mean: -0.038444459438323975, mean p set: 0.4505563974380493
The modified gen p mean: 0.4496537744998932, gen p mean: -0.042591534554958344, mean p set: 0.4501340985298157
loss_pred:0.01719244010746479, decouple_loss:0.0010976297780871391
loss_pred:0.01677461713552475, decouple_loss:0.001086382195353508
The modified gen p mean: 0.45139604806900024, gen p mean: -0.03797308728098869, mean p set: 0.45187634229660034
loss_pred:0.016442930325865746, decouple_loss:0.0011268402449786663
Iteration: 1704, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45007872581481934, gen p mean: -0.04002947360277176, mean p set: 0.45055902004241943
loss_pred:0.016420649364590645, decouple_loss:0.0011832051677629352
The modified gen p mean: 0.4504399001598358, gen p mean: -0.0377156138420105, mean p set: 0.4509201943874359The modified gen p mean: 0.4525906443595886, gen p mean: -0.04446155205368996, mean p set: 0.4530709385871887
loss_pred:0.016364311799407005, decouple_loss:0.0012273496249690652
loss_pred:0.016064103692770004, decouple_loss:0.0012397407554090023
Iteration: 1705, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504378139972687, gen p mean: -0.03872323036193848, mean p set: 0.4509181082248688
The modified gen p mean: 0.45108312368392944, gen p mean: -0.03778960928320885, mean p set: 0.45156341791152954
loss_pred:0.016518831253051758, decouple_loss:0.001060783164575696
loss_pred:0.01646704226732254, decouple_loss:0.001085346331819892
The modified gen p mean: 0.45049917697906494, gen p mean: -0.03657533600926399, mean p set: 0.45097947120666504
loss_pred:0.01656244322657585, decouple_loss:0.0010718581033870578
Iteration: 1706, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45292118191719055, gen p mean: -0.034156639128923416, mean p set: 0.45340150594711304
loss_pred:0.01657889038324356, decouple_loss:0.001172356423921883
The modified gen p mean: 0.4514337480068207, gen p mean: -0.04128699004650116, mean p set: 0.4519140422344208The modified gen p mean: 0.4494568109512329, gen p mean: -0.036073237657547, mean p set: 0.449937105178833
loss_pred:0.017006412148475647, decouple_loss:0.0011207475326955318
loss_pred:0.01570931263267994, decouple_loss:0.0011455223429948092
Iteration: 1707, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450580358505249, gen p mean: -0.03433726727962494, mean p set: 0.4510606527328491
loss_pred:0.01649198867380619, decouple_loss:0.001184317166917026
The modified gen p mean: 0.45077088475227356, gen p mean: -0.037306368350982666, mean p set: 0.45125120878219604The modified gen p mean: 0.44915416836738586, gen p mean: -0.03912925347685814, mean p set: 0.44963446259498596
loss_pred:0.016336873173713684, decouple_loss:0.0011882117250934243
loss_pred:0.016514191403985023, decouple_loss:0.001147044007666409
Iteration: 1708, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44935160875320435, gen p mean: -0.03317628800868988, mean p set: 0.44983193278312683
loss_pred:0.017780911177396774, decouple_loss:0.0011728238314390182
The modified gen p mean: 0.4504571557044983, gen p mean: -0.03801758214831352, mean p set: 0.450937420129776The modified gen p mean: 0.45270371437072754, gen p mean: -0.037465211004018784, mean p set: 0.45318400859832764
loss_pred:0.01663033850491047, decouple_loss:0.0011843587271869183
loss_pred:0.016797758638858795, decouple_loss:0.0012371503980830312
Iteration: 1709, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44920673966407776, gen p mean: -0.04049485921859741, mean p set: 0.44968703389167786
loss_pred:0.016599522903561592, decouple_loss:0.001283783814869821
The modified gen p mean: 0.4518849551677704, gen p mean: -0.04161272197961807, mean p set: 0.4523652195930481The modified gen p mean: 0.44951656460762024, gen p mean: -0.03484029322862625, mean p set: 0.44999685883522034
loss_pred:0.016777336597442627, decouple_loss:0.0012327017029747367
loss_pred:0.015891339629888535, decouple_loss:0.0012475791154429317
Traceback (most recent call last):
  File "/work/09012/haoli1/ls6/ERA5_PredRNN/predrnn-pytorch/run1.py", line 338, in <module>
    train_wrapper(model)
  File "/work/09012/haoli1/ls6/ERA5_PredRNN/predrnn-pytorch/run1.py", line 259, in train_wrapper
    train_input_handle = datasets_factory.data_provider(
  File "/work/09012/haoli1/ls6/ERA5_PredRNN/predrnn-pytorch/core/data_provider/datasets_factory.py", line 48, in data_provider
    train_input_handle = datasets_map[dataset_name].InputHandle(train_input_param)
  File "/work/09012/haoli1/ls6/ERA5_PredRNN/predrnn-pytorch/core/data_provider/mnist_new.py", line 26, in __init__
    self.load()
  File "/work/09012/haoli1/ls6/ERA5_PredRNN/predrnn-pytorch/core/data_provider/mnist_new.py", line 31, in load
    self.data['clips'] = dat_1['clips']
  File "/work/09012/haoli1/ls6/Pyt/lib/python3.9/site-packages/numpy/lib/npyio.py", line 260, in __getitem__
    raise KeyError("%s is not a file in the archive" % key)
KeyError: 'clips is not a file in the archive'
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012004_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012004_3_24hr.npz