After initialize model, args.img_channel:3
load model: /work/09012/haoli1/ls6/ERA5_PredRNN/checkpoints/WV_0_PC_0_EH_1_PS_40/model_2000.ckpt
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012000_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012001_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012002_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012003_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012004_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012005_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012006_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012007_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012008_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012009_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012010_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012011_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012012_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012013_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012014_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012015_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012016_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012017_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012018_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012019_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012020_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012000_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012001_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012002_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012003_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012004_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012005_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012006_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012007_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012008_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012009_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012010_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012011_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012012_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012013_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012014_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012015_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012016_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012017_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012018_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012019_3_24hr.npz
train_data_files nums: 41
mnist test iterator, Loading data from /scratch/09012/haoli1/ERA5/val_dataset/era5_train_09012020_3_24hr.npz
NaN value num: 0
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012001_3_24hr.npz
NaN value num: 0
Iteration: 1, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43133047223091125, gen p mean: 0.0, mean p set: 0.448, frame p mean: 0.44826778769493103
loss_pred:0.02199254184961319, decouple_loss:0.010925508104264736
The modified gen p mean: 0.4316961467266083, gen p mean: 0.0, mean p set: 0.448, frame p mean: 0.44787687063217163
loss_pred:0.020676670596003532, decouple_loss:0.01104847900569439
The modified gen p mean: 0.4359078109264374, gen p mean: 0.0, mean p set: 0.448, frame p mean: 0.44864362478256226
loss_pred:0.021193547174334526, decouple_loss:0.011041958816349506
/work/09012/haoli1/ls6/Pyt/lib/python3.9/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '
Iteration: 2, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.8883420825004578, gen p mean: 0.0, mean p set: 0.448, frame p mean: 0.44857439398765564
The modified gen p mean: 0.9168096780776978, gen p mean: 0.0, mean p set: 0.448, frame p mean: 0.44870153069496155
The modified gen p mean: 0.928255558013916, gen p mean: 0.0, mean p set: 0.448, frame p mean: 0.44658246636390686
loss_pred:0.2753902077674866, decouple_loss:0.48288461565971375
loss_pred:0.2794656753540039, decouple_loss:0.48413655161857605
loss_pred:0.23630456626415253, decouple_loss:0.4828658998012543
Iteration: 3, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 1.100174903869629, gen p mean: 0.0, mean p set: 0.448, frame p mean: 0.4470108151435852
The modified gen p mean: 1.1050788164138794, gen p mean: 0.0, mean p set: 0.448, frame p mean: 0.4471919536590576
The modified gen p mean: 1.0479079484939575, gen p mean: 0.0, mean p set: 0.448, frame p mean: 0.4466276168823242
loss_pred:0.324711412191391, decouple_loss:0.5085248351097107
loss_pred:0.32909610867500305, decouple_loss:0.5002335906028748
loss_pred:0.29876700043678284, decouple_loss:0.5224721431732178
Iteration: 4, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.664607584476471, gen p mean: 0.0, mean p set: 0.448, frame p mean: 0.44683656096458435
The modified gen p mean: 0.6623350977897644, gen p mean: 0.0, mean p set: 0.448, frame p mean: 0.447124719619751
The modified gen p mean: 0.6649763584136963, gen p mean: 0.0, mean p set: 0.448, frame p mean: 0.4478362500667572
loss_pred:0.13241362571716309, decouple_loss:0.5398846864700317
loss_pred:0.13225328922271729, decouple_loss:0.5417374968528748
loss_pred:0.13086944818496704, decouple_loss:0.5359178781509399
Iteration: 5, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.37701448798179626, gen p mean: 0.0, mean p set: 0.448, frame p mean: 0.44806969165802
The modified gen p mean: 0.3747463524341583, gen p mean: 0.0, mean p set: 0.448, frame p mean: 0.44707149267196655
The modified gen p mean: 0.3754871189594269, gen p mean: 0.0, mean p set: 0.448, frame p mean: 0.4469379782676697
loss_pred:0.1119905337691307, decouple_loss:0.8526065349578857
loss_pred:0.11278831213712692, decouple_loss:0.8520834445953369
loss_pred:0.10559915006160736, decouple_loss:0.842893123626709
Iteration: 6, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.6620631814002991, gen p mean: 0.0, mean p set: 0.448, frame p mean: 0.4475541114807129The modified gen p mean: 0.6589335799217224, gen p mean: 0.0, mean p set: 0.448, frame p mean: 0.4464026093482971
loss_pred:0.13655592501163483, decouple_loss:0.4901900589466095
loss_pred:0.13701125979423523, decouple_loss:0.49613016843795776
The modified gen p mean: 0.6599709987640381, gen p mean: 0.0, mean p set: 0.448, frame p mean: 0.4464757442474365
loss_pred:0.1402573436498642, decouple_loss:0.49149808287620544
Iteration: 7, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43981581926345825, gen p mean: 0.0, mean p set: 0.448, frame p mean: 0.4462892413139343
The modified gen p mean: 0.4404914081096649, gen p mean: 0.0, mean p set: 0.448, frame p mean: 0.44803163409233093
loss_pred:0.10869597643613815, decouple_loss:0.4535912275314331
The modified gen p mean: 0.4423794448375702, gen p mean: 0.0, mean p set: 0.448, frame p mean: 0.4486770033836365
loss_pred:0.10389394313097, decouple_loss:0.4535394608974457
loss_pred:0.10579050332307816, decouple_loss:0.45501837134361267
Iteration: 8, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4776585102081299, gen p mean: 0.0, mean p set: 0.448, frame p mean: 0.44735994935035706
The modified gen p mean: 0.47636568546295166, gen p mean: 0.0, mean p set: 0.448, frame p mean: 0.4480380713939667
The modified gen p mean: 0.47619083523750305, gen p mean: 0.0, mean p set: 0.448, frame p mean: 0.44800278544425964
loss_pred:0.07837469130754471, decouple_loss:0.37339770793914795
loss_pred:0.07711724936962128, decouple_loss:0.3724357485771179
loss_pred:0.08115419745445251, decouple_loss:0.3714366555213928
Iteration: 9, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.49304887652397156, gen p mean: 0.0, mean p set: 0.448, frame p mean: 0.44829100370407104
The modified gen p mean: 0.4883779287338257, gen p mean: 0.0, mean p set: 0.448, frame p mean: 0.446306437253952
The modified gen p mean: 0.4873863160610199, gen p mean: 0.0, mean p set: 0.448, frame p mean: 0.4474387764930725
loss_pred:0.06922033429145813, decouple_loss:0.3302665054798126
loss_pred:0.07036026567220688, decouple_loss:0.3306203782558441
loss_pred:0.07150573283433914, decouple_loss:0.3323189318180084
Iteration: 10, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4668203592300415, gen p mean: 0.0, mean p set: 0.448, frame p mean: 0.4464479684829712
The modified gen p mean: 0.4666633903980255, gen p mean: 0.0, mean p set: 0.448, frame p mean: 0.44668346643447876
The modified gen p mean: 0.46751782298088074, gen p mean: 0.0, mean p set: 0.448, frame p mean: 0.44615060091018677
loss_pred:0.06502226740121841, decouple_loss:0.32276660203933716
loss_pred:0.06468618661165237, decouple_loss:0.315866619348526
loss_pred:0.06746871024370193, decouple_loss:0.3233184218406677
2023-04-16 23:54:59 testing...
The modified gen p mean: 0.4238802492618561, gen p mean: 0.0, mean p set: 0.448, frame p mean: 0.4499312937259674
loss_pred:0.06497148424386978, decouple_loss:0.266999751329422
The modified gen p mean: 0.42463091015815735, gen p mean: 0.0, mean p set: 0.448, frame p mean: 0.4493577778339386
The modified gen p mean: 0.42502978444099426, gen p mean: 0.0, mean p set: 0.448, frame p mean: 0.4499579966068268
loss_pred:0.06417262554168701, decouple_loss:0.2695715129375458
loss_pred:0.06440576165914536, decouple_loss:0.26711902022361755
WV_0_PC_0_EH_1_PS_40, loss: 0.07791146636009216, avg_mse: 0.07613791525363922
current test mse: 0.076138
Iteration: 11, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.40857648849487305, gen p mean: 0.0, mean p set: 0.448, frame p mean: 0.4487229585647583
loss_pred:0.05909310653805733, decouple_loss:0.26500752568244934
The modified gen p mean: 0.4094923138618469, gen p mean: 0.0, mean p set: 0.448, frame p mean: 0.4478543698787689
The modified gen p mean: 0.4061889052391052, gen p mean: 0.0, mean p set: 0.448, frame p mean: 0.4469921588897705
loss_pred:0.057235416024923325, decouple_loss:0.2619309723377228
loss_pred:0.05877834931015968, decouple_loss:0.2652100622653961
Iteration: 12, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4031887948513031, gen p mean: 0.0, mean p set: 0.448, frame p mean: 0.4461505115032196
loss_pred:0.054188843816518784, decouple_loss:0.22690938413143158
The modified gen p mean: 0.4011387526988983, gen p mean: 0.0, mean p set: 0.448, frame p mean: 0.44675520062446594
The modified gen p mean: 0.40591394901275635, gen p mean: 0.0, mean p set: 0.448, frame p mean: 0.447406530380249
loss_pred:0.05474909022450447, decouple_loss:0.22384122014045715
loss_pred:0.04957718029618263, decouple_loss:0.2261635661125183
Iteration: 13, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44914311170578003, gen p mean: 0.0, mean p set: 0.448, frame p mean: 0.4467039406299591
loss_pred:0.04900806397199631, decouple_loss:0.19540554285049438
The modified gen p mean: 0.44795912504196167, gen p mean: 0.0, mean p set: 0.448, frame p mean: 0.44716086983680725
The modified gen p mean: 0.4508976340293884, gen p mean: 0.0, mean p set: 0.448, frame p mean: 0.4480378031730652
loss_pred:0.051293984055519104, decouple_loss:0.19506791234016418
loss_pred:0.04889335483312607, decouple_loss:0.19648754596710205
Iteration: 14, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4696175754070282, gen p mean: 0.0, mean p set: 0.448, frame p mean: 0.4487563669681549
The modified gen p mean: 0.47238048911094666, gen p mean: 0.0, mean p set: 0.448, frame p mean: 0.44758546352386475loss_pred:0.04877562075853348, decouple_loss:0.1673181802034378
loss_pred:0.045534469187259674, decouple_loss:0.16495589911937714
The modified gen p mean: 0.4737144708633423, gen p mean: 0.0, mean p set: 0.448, frame p mean: 0.44804710149765015
loss_pred:0.04780444875359535, decouple_loss:0.16372495889663696
Iteration: 15, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4518364369869232, gen p mean: 0.0, mean p set: 0.448, frame p mean: 0.4488830864429474
The modified gen p mean: 0.4526194632053375, gen p mean: 0.0, mean p set: 0.448, frame p mean: 0.44793185591697693
loss_pred:0.047191303223371506, decouple_loss:0.14848345518112183
loss_pred:0.044078439474105835, decouple_loss:0.14729911088943481
The modified gen p mean: 0.4517066180706024, gen p mean: 0.0, mean p set: 0.448, frame p mean: 0.4455479085445404
loss_pred:0.043288156390190125, decouple_loss:0.14888322353363037
Iteration: 16, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44238710403442383, gen p mean: 0.0, mean p set: 0.448, frame p mean: 0.4473881423473358
The modified gen p mean: 0.44235020875930786, gen p mean: 0.0, mean p set: 0.448, frame p mean: 0.4475817382335663
loss_pred:0.046295516192913055, decouple_loss:0.1282792091369629
loss_pred:0.0452849417924881, decouple_loss:0.12779872119426727
The modified gen p mean: 0.4449584484100342, gen p mean: 0.0, mean p set: 0.448, frame p mean: 0.44695591926574707
loss_pred:0.04551142826676369, decouple_loss:0.12789714336395264
Iteration: 17, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4752775728702545, gen p mean: 0.0, mean p set: 0.448, frame p mean: 0.44599103927612305
The modified gen p mean: 0.474265992641449, gen p mean: 0.0, mean p set: 0.448, frame p mean: 0.44549545645713806
loss_pred:0.04337982088327408, decouple_loss:0.1174316555261612
loss_pred:0.042667049914598465, decouple_loss:0.11742247641086578
The modified gen p mean: 0.4720548689365387, gen p mean: 0.0, mean p set: 0.448, frame p mean: 0.44607284665107727
loss_pred:0.043492041528224945, decouple_loss:0.11693287640810013
Iteration: 18, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4574328362941742, gen p mean: 0.0, mean p set: 0.448, frame p mean: 0.4470473825931549
The modified gen p mean: 0.45926883816719055, gen p mean: 0.0, mean p set: 0.448, frame p mean: 0.4483243227005005
loss_pred:0.04398597404360771, decouple_loss:0.10755746811628342
loss_pred:0.04248354583978653, decouple_loss:0.107692189514637
The modified gen p mean: 0.45641517639160156, gen p mean: 0.0, mean p set: 0.448, frame p mean: 0.44727927446365356
loss_pred:0.044037047773599625, decouple_loss:0.1065145805478096
Iteration: 19, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498271346092224, gen p mean: 0.0, mean p set: 0.448, frame p mean: 0.4475921094417572
The modified gen p mean: 0.45029938220977783, gen p mean: 0.0, mean p set: 0.448, frame p mean: 0.44779202342033386
loss_pred:0.04078776389360428, decouple_loss:0.0975487232208252
loss_pred:0.04254169389605522, decouple_loss:0.0946720615029335
The modified gen p mean: 0.452766478061676, gen p mean: 0.0, mean p set: 0.448, frame p mean: 0.44785913825035095
loss_pred:0.04180431738495827, decouple_loss:0.09664172679185867
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 20, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45166757702827454, gen p mean: 0.0, mean p set: 0.448, frame p mean: 0.4479801058769226
loss_pred:0.040678828954696655, decouple_loss:0.09621662646532059
The modified gen p mean: 0.45014193654060364, gen p mean: 0.0, mean p set: 0.448, frame p mean: 0.4480048418045044
loss_pred:0.04181995242834091, decouple_loss:0.09914881736040115
The modified gen p mean: 0.44959816336631775, gen p mean: 0.0, mean p set: 0.448, frame p mean: 0.4466162919998169
loss_pred:0.04204023629426956, decouple_loss:0.09477212280035019

2023-04-16 23:56:52 testing...
The modified gen p mean: 0.41676032543182373, gen p mean: 0.0, mean p set: 0.448, frame p mean: 0.4499312937259674
loss_pred:0.05290449783205986, decouple_loss:0.08996666222810745
The modified gen p mean: 0.41717997193336487, gen p mean: 0.0, mean p set: 0.448, frame p mean: 0.4493577778339386
The modified gen p mean: 0.41811203956604004, gen p mean: 0.0, mean p set: 0.448, frame p mean: 0.4499579966068268
loss_pred:0.052061162889003754, decouple_loss:0.09115038067102432
loss_pred:0.05220405384898186, decouple_loss:0.0915791317820549
WV_0_PC_0_EH_1_PS_40, loss: 0.056934844702482224, avg_mse: 0.06387578696012497
current test mse: 0.063876
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012008_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012008_3_24hr.npz
NaN value num: 0
Iteration: 21, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44089195132255554, gen p mean: 0.0, mean p set: 0.448, frame p mean: 0.4476444721221924
loss_pred:0.04143485054373741, decouple_loss:0.0874648168683052
The modified gen p mean: 0.4404192268848419, gen p mean: 0.0, mean p set: 0.448, frame p mean: 0.44699934124946594
The modified gen p mean: 0.43881651759147644, gen p mean: 0.0, mean p set: 0.448, frame p mean: 0.44674190878868103
loss_pred:0.04044606164097786, decouple_loss:0.08781807869672775
loss_pred:0.04442371055483818, decouple_loss:0.08694127202033997
Iteration: 22, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4599182903766632, gen p mean: 0.0, mean p set: 0.448, frame p mean: 0.4461887776851654
The modified gen p mean: 0.46193841099739075, gen p mean: 0.0, mean p set: 0.448, frame p mean: 0.4454061686992645
loss_pred:0.042373575270175934, decouple_loss:0.08605127036571503
The modified gen p mean: 0.4611985385417938, gen p mean: 0.0, mean p set: 0.448, frame p mean: 0.4468900263309479
loss_pred:0.04355429485440254, decouple_loss:0.08385387063026428
loss_pred:0.043913234025239944, decouple_loss:0.08654356002807617
Iteration: 23, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4388461410999298, gen p mean: 0.0, mean p set: 0.448, frame p mean: 0.4482536017894745
loss_pred:0.03834167867898941, decouple_loss:0.07820872962474823
The modified gen p mean: 0.43561065196990967, gen p mean: 0.0, mean p set: 0.448, frame p mean: 0.4469202160835266The modified gen p mean: 0.43686291575431824, gen p mean: 0.0, mean p set: 0.448, frame p mean: 0.4473651945590973
loss_pred:0.04115978255867958, decouple_loss:0.07906652241945267loss_pred:0.03772689402103424, decouple_loss:0.0806584358215332
Iteration: 24, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44080328941345215, gen p mean: 0.0, mean p set: 0.448, frame p mean: 0.44624659419059753
loss_pred:0.04176785796880722, decouple_loss:0.07283703237771988
The modified gen p mean: 0.44701817631721497, gen p mean: 0.0, mean p set: 0.448, frame p mean: 0.4474709630012512
The modified gen p mean: 0.44553378224372864, gen p mean: 0.0, mean p set: 0.448, frame p mean: 0.445332795381546
loss_pred:0.03654671832919121, decouple_loss:0.07390329986810684
loss_pred:0.038973454385995865, decouple_loss:0.0729883536696434
Iteration: 25, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.47415101528167725, gen p mean: 0.0, mean p set: 0.448, frame p mean: 0.4467284381389618
loss_pred:0.03868003562092781, decouple_loss:0.07221571356058121
The modified gen p mean: 0.4707379639148712, gen p mean: 0.0, mean p set: 0.448, frame p mean: 0.4469960927963257
The modified gen p mean: 0.47084081172943115, gen p mean: 0.0, mean p set: 0.448, frame p mean: 0.4466053247451782
loss_pred:0.037774521857500076, decouple_loss:0.07131780683994293
loss_pred:0.03846287727355957, decouple_loss:0.07005374133586884
Iteration: 26, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45761993527412415, gen p mean: 0.0, mean p set: 0.448, frame p mean: 0.44745659828186035
loss_pred:0.03598565608263016, decouple_loss:0.06502865254878998
The modified gen p mean: 0.4628695547580719, gen p mean: 0.0, mean p set: 0.448, frame p mean: 0.4462628960609436
The modified gen p mean: 0.4603332281112671, gen p mean: 0.0, mean p set: 0.448, frame p mean: 0.447147011756897loss_pred:0.039522238075733185, decouple_loss:0.06447678059339523
loss_pred:0.03873905539512634, decouple_loss:0.06402961909770966
Iteration: 27, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4187266230583191, gen p mean: 0.0, mean p set: 0.448, frame p mean: 0.4468747675418854
loss_pred:0.03964913263916969, decouple_loss:0.06325238943099976
The modified gen p mean: 0.4219363331794739, gen p mean: 0.0, mean p set: 0.448, frame p mean: 0.4465879499912262
loss_pred:0.03901629522442818, decouple_loss:0.06576673686504364
The modified gen p mean: 0.4221344590187073, gen p mean: 0.0, mean p set: 0.448, frame p mean: 0.44654229283332825
loss_pred:0.040025241672992706, decouple_loss:0.06435481458902359
Iteration: 28, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4352772533893585, gen p mean: 0.0, mean p set: 0.448, frame p mean: 0.4469469487667084
loss_pred:0.03676450252532959, decouple_loss:0.05967973917722702
The modified gen p mean: 0.44107311964035034, gen p mean: 0.0, mean p set: 0.448, frame p mean: 0.44678521156311035
The modified gen p mean: 0.4404953718185425, gen p mean: 0.0, mean p set: 0.448, frame p mean: 0.44708630442619324
loss_pred:0.035960663110017776, decouple_loss:0.05980324372649193
loss_pred:0.036314625293016434, decouple_loss:0.05999090149998665
Iteration: 29, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4658304750919342, gen p mean: 0.0, mean p set: 0.448, frame p mean: 0.44650906324386597
loss_pred:0.04000786691904068, decouple_loss:0.05627887696027756
The modified gen p mean: 0.46558859944343567, gen p mean: 0.0, mean p set: 0.448, frame p mean: 0.4458368718624115
The modified gen p mean: 0.4670572578907013, gen p mean: 0.0, mean p set: 0.448, frame p mean: 0.44556811451911926
loss_pred:0.038125719875097275, decouple_loss:0.055829763412475586
loss_pred:0.038283899426460266, decouple_loss:0.05688563734292984
Iteration: 30, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497569501399994, gen p mean: 0.0, mean p set: 0.448, frame p mean: 0.4466305077075958
loss_pred:0.0359974168241024, decouple_loss:0.0565367117524147
The modified gen p mean: 0.4510142505168915, gen p mean: 0.0, mean p set: 0.448, frame p mean: 0.44728970527648926The modified gen p mean: 0.4503847360610962, gen p mean: 0.0, mean p set: 0.448, frame p mean: 0.4468725621700287
loss_pred:0.03460847586393356, decouple_loss:0.05560043454170227
loss_pred:0.036096494644880295, decouple_loss:0.05630182474851608
2023-04-16 23:59:17 testing...
The modified gen p mean: 0.41817158460617065, gen p mean: 0.0, mean p set: 0.448, frame p mean: 0.4499312937259674
The modified gen p mean: 0.41910800337791443, gen p mean: 0.0, mean p set: 0.448, frame p mean: 0.4493577778339386
loss_pred:0.045563988387584686, decouple_loss:0.053561732172966
The modified gen p mean: 0.42049625515937805, gen p mean: 0.0, mean p set: 0.448, frame p mean: 0.4499579966068268
loss_pred:0.0450982004404068, decouple_loss:0.05417816340923309
loss_pred:0.04458107799291611, decouple_loss:0.05249449983239174
WV_0_PC_0_EH_1_PS_40, loss: 0.04775166139006615, avg_mse: 0.0548885241150856
current test mse: 0.054889
Iteration: 31, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43513283133506775, gen p mean: 0.0, mean p set: 0.448, frame p mean: 0.44596952199935913
The modified gen p mean: 0.4348870515823364, gen p mean: 0.0, mean p set: 0.448, frame p mean: 0.446161687374115
loss_pred:0.03672581538558006, decouple_loss:0.05148210749030113
The modified gen p mean: 0.4346992075443268, gen p mean: 0.0, mean p set: 0.448, frame p mean: 0.4467822015285492
loss_pred:0.03575502708554268, decouple_loss:0.05075271055102348
loss_pred:0.03710710257291794, decouple_loss:0.0511045940220356
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 32, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475095272064209, gen p mean: 0.0, mean p set: 0.448, frame p mean: 0.44708946347236633
The modified gen p mean: 0.44960787892341614, gen p mean: 0.0, mean p set: 0.448, frame p mean: 0.4467242956161499
The modified gen p mean: 0.45281562209129333, gen p mean: 0.0, mean p set: 0.448, frame p mean: 0.44803959131240845
loss_pred:0.03614261746406555, decouple_loss:0.052922323346138
loss_pred:0.034131310880184174, decouple_loss:0.05239070951938629
loss_pred:0.0368037149310112, decouple_loss:0.05507553368806839
Iteration: 33, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45669010281562805, gen p mean: 0.0, mean p set: 0.448, frame p mean: 0.447514146566391
The modified gen p mean: 0.453813374042511, gen p mean: 0.0, mean p set: 0.448, frame p mean: 0.4459904730319977
loss_pred:0.032885387539863586, decouple_loss:0.04746948182582855
loss_pred:0.03629803657531738, decouple_loss:0.04730333015322685
The modified gen p mean: 0.4518636167049408, gen p mean: 0.0, mean p set: 0.448, frame p mean: 0.4468025267124176
loss_pred:0.03416072204709053, decouple_loss:0.049099501222372055
Iteration: 34, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45002201199531555, gen p mean: 0.0, mean p set: 0.448, frame p mean: 0.448025107383728
The modified gen p mean: 0.44670945405960083, gen p mean: 0.0, mean p set: 0.448, frame p mean: 0.4467681050300598
loss_pred:0.03400145843625069, decouple_loss:0.049586907029151917
The modified gen p mean: 0.4444015324115753, gen p mean: 0.0, mean p set: 0.448, frame p mean: 0.446627676486969
loss_pred:0.03404946252703667, decouple_loss:0.04958023875951767
loss_pred:0.035230085253715515, decouple_loss:0.05078912153840065
Iteration: 35, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4390188157558441, gen p mean: 0.0, mean p set: 0.448, frame p mean: 0.4459870159626007
loss_pred:0.033553678542375565, decouple_loss:0.04633268713951111
The modified gen p mean: 0.43840885162353516, gen p mean: 0.0, mean p set: 0.448, frame p mean: 0.44507086277008057
The modified gen p mean: 0.43699878454208374, gen p mean: 0.0, mean p set: 0.448, frame p mean: 0.44714105129241943
loss_pred:0.035556331276893616, decouple_loss:0.04522198811173439
loss_pred:0.035214606672525406, decouple_loss:0.04625101014971733
Iteration: 36, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44633275270462036, gen p mean: 0.0, mean p set: 0.448, frame p mean: 0.4466346800327301
loss_pred:0.032620687037706375, decouple_loss:0.0441170372068882
The modified gen p mean: 0.44971415400505066, gen p mean: 0.0, mean p set: 0.448, frame p mean: 0.4467928409576416
The modified gen p mean: 0.44231951236724854, gen p mean: 0.0, mean p set: 0.448, frame p mean: 0.4464525878429413
loss_pred:0.03486479073762894, decouple_loss:0.043872248381376266
loss_pred:0.03741774335503578, decouple_loss:0.045566376298666
Iteration: 37, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44581642746925354, gen p mean: 0.0, mean p set: 0.448, frame p mean: 0.4466856122016907
loss_pred:0.03266075253486633, decouple_loss:0.044353168457746506
The modified gen p mean: 0.44727665185928345, gen p mean: 0.0, mean p set: 0.448, frame p mean: 0.44687238335609436
The modified gen p mean: 0.4472791254520416, gen p mean: 0.0, mean p set: 0.448, frame p mean: 0.44626984000205994
loss_pred:0.03362759202718735, decouple_loss:0.04841894283890724
loss_pred:0.03680402785539627, decouple_loss:0.04384275898337364
Iteration: 38, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44094178080558777, gen p mean: 0.0, mean p set: 0.448, frame p mean: 0.4467180371284485
The modified gen p mean: 0.43982017040252686, gen p mean: 0.0, mean p set: 0.448, frame p mean: 0.44681787490844727
The modified gen p mean: 0.4373137652873993, gen p mean: 0.0, mean p set: 0.448, frame p mean: 0.4463648200035095
loss_pred:0.03462890163064003, decouple_loss:0.043742481619119644
loss_pred:0.03402862697839737, decouple_loss:0.044378604739904404
loss_pred:0.033658530563116074, decouple_loss:0.044904835522174835
Iteration: 39, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466922879219055, gen p mean: 0.0, mean p set: 0.448, frame p mean: 0.4468848705291748
loss_pred:0.03271784260869026, decouple_loss:0.04482119902968407The modified gen p mean: 0.44817984104156494, gen p mean: 0.0, mean p set: 0.448, frame p mean: 0.44672641158103943
loss_pred:0.033839840441942215, decouple_loss:0.044975001364946365
The modified gen p mean: 0.448358952999115, gen p mean: 0.0, mean p set: 0.448, frame p mean: 0.446686714887619
loss_pred:0.03371955826878548, decouple_loss:0.04536041244864464
Iteration: 40, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479184150695801, gen p mean: 0.0, mean p set: 0.448, frame p mean: 0.4470623731613159
loss_pred:0.033694248646497726, decouple_loss:0.03901723399758339
The modified gen p mean: 0.44576048851013184, gen p mean: 0.0, mean p set: 0.448, frame p mean: 0.44690513610839844
The modified gen p mean: 0.44937148690223694, gen p mean: 0.0, mean p set: 0.448, frame p mean: 0.4461464583873749
loss_pred:0.03554254770278931, decouple_loss:0.03908725455403328
loss_pred:0.034969937056303024, decouple_loss:0.03934343159198761
2023-04-17 00:01:10 testing...
The modified gen p mean: 0.41872143745422363, gen p mean: 0.0, mean p set: 0.448, frame p mean: 0.4499312937259674
The modified gen p mean: 0.42087188363075256, gen p mean: 0.0, mean p set: 0.448, frame p mean: 0.4493577778339386
loss_pred:0.04319082945585251, decouple_loss:0.04663237929344177
The modified gen p mean: 0.42263704538345337, gen p mean: 0.0, mean p set: 0.448, frame p mean: 0.4499579966068268
loss_pred:0.042670655995607376, decouple_loss:0.04555406793951988
loss_pred:0.04211419075727463, decouple_loss:0.04438013583421707
WV_0_PC_0_EH_1_PS_40, loss: 0.04493466764688492, avg_mse: 0.05413438752293587
current test mse: 0.054134
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012010_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012010_3_24hr.npz
NaN value num: 0
Iteration: 41, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44433724880218506, gen p mean: 0.0, mean p set: 0.448, frame p mean: 0.44753822684288025
loss_pred:0.03545775264501572, decouple_loss:0.0461585558950901
The modified gen p mean: 0.4428521692752838, gen p mean: 0.0, mean p set: 0.448, frame p mean: 0.44854339957237244The modified gen p mean: 0.443130224943161, gen p mean: 0.0, mean p set: 0.448, frame p mean: 0.4473784863948822
loss_pred:0.03330607712268829, decouple_loss:0.04424086958169937
loss_pred:0.0377226248383522, decouple_loss:0.045712683349847794
Iteration: 42, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44772690534591675, gen p mean: 0.0, mean p set: 0.448, frame p mean: 0.4471035897731781
loss_pred:0.03330085426568985, decouple_loss:0.048387669026851654
The modified gen p mean: 0.4481455087661743, gen p mean: 0.0, mean p set: 0.448, frame p mean: 0.44835373759269714
The modified gen p mean: 0.44423049688339233, gen p mean: 0.0, mean p set: 0.448, frame p mean: 0.4479575455188751
loss_pred:0.03368915617465973, decouple_loss:0.050346504896879196
loss_pred:0.037529025226831436, decouple_loss:0.04963575303554535
Iteration: 43, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45738041400909424, gen p mean: 0.0, mean p set: 0.448, frame p mean: 0.4471614956855774
loss_pred:0.03290221840143204, decouple_loss:0.04034100100398064
The modified gen p mean: 0.4554156959056854, gen p mean: 0.0, mean p set: 0.448, frame p mean: 0.44768840074539185
The modified gen p mean: 0.45678263902664185, gen p mean: 0.0, mean p set: 0.448, frame p mean: 0.44871488213539124
loss_pred:0.03349560499191284, decouple_loss:0.04106646776199341
loss_pred:0.03294096514582634, decouple_loss:0.044963136315345764
Iteration: 44, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44508612155914307, gen p mean: 0.0, mean p set: 0.448, frame p mean: 0.44756224751472473
loss_pred:0.03314965218305588, decouple_loss:0.03762650862336159
The modified gen p mean: 0.44827425479888916, gen p mean: 0.0, mean p set: 0.448, frame p mean: 0.4480694830417633
loss_pred:0.03042738325893879, decouple_loss:0.03831414133310318
The modified gen p mean: 0.4445473551750183, gen p mean: 0.0, mean p set: 0.448, frame p mean: 0.44713449478149414
loss_pred:0.033427949994802475, decouple_loss:0.03807928413152695
Iteration: 45, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4382960796356201, gen p mean: 0.0, mean p set: 0.448, frame p mean: 0.44863107800483704
The modified gen p mean: 0.43791964650154114, gen p mean: 0.0, mean p set: 0.448, frame p mean: 0.44859641790390015
loss_pred:0.03260333836078644, decouple_loss:0.0408005565404892
The modified gen p mean: 0.4394557476043701, gen p mean: 0.0, mean p set: 0.448, frame p mean: 0.447089821100235
loss_pred:0.03192421793937683, decouple_loss:0.040928468108177185
loss_pred:0.03357715532183647, decouple_loss:0.039099711924791336
Iteration: 46, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44673463702201843, gen p mean: 0.0, mean p set: 0.448, frame p mean: 0.4468834698200226
loss_pred:0.03378681093454361, decouple_loss:0.03910954296588898
The modified gen p mean: 0.4474797248840332, gen p mean: 0.0, mean p set: 0.448, frame p mean: 0.4468897879123688
loss_pred:0.031672313809394836, decouple_loss:0.03869406506419182
The modified gen p mean: 0.4477596879005432, gen p mean: 0.0, mean p set: 0.448, frame p mean: 0.44783979654312134
loss_pred:0.030579423531889915, decouple_loss:0.04070879518985748
Iteration: 47, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4518226087093353, gen p mean: 0.0, mean p set: 0.448, frame p mean: 0.44724082946777344
The modified gen p mean: 0.45203566551208496, gen p mean: 0.0, mean p set: 0.448, frame p mean: 0.4481234550476074
The modified gen p mean: 0.45424023270606995, gen p mean: 0.0, mean p set: 0.448, frame p mean: 0.44751203060150146
loss_pred:0.03318819776177406, decouple_loss:0.043800219893455505
loss_pred:0.031506218016147614, decouple_loss:0.04182107746601105
loss_pred:0.0306117981672287, decouple_loss:0.04370681568980217
Iteration: 48, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44656649231910706, gen p mean: 0.0, mean p set: 0.448, frame p mean: 0.44783255457878113
The modified gen p mean: 0.4406890869140625, gen p mean: 0.0, mean p set: 0.448, frame p mean: 0.4475235044956207
loss_pred:0.029527239501476288, decouple_loss:0.04924759268760681
The modified gen p mean: 0.4405713975429535, gen p mean: 0.0, mean p set: 0.448, frame p mean: 0.4470137059688568
loss_pred:0.03181303292512894, decouple_loss:0.04921906068921089
loss_pred:0.03472071886062622, decouple_loss:0.04874425008893013
Iteration: 49, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44117581844329834, gen p mean: 0.0, mean p set: 0.448, frame p mean: 0.44751691818237305
The modified gen p mean: 0.43504664301872253, gen p mean: 0.0, mean p set: 0.448, frame p mean: 0.4482853412628174
The modified gen p mean: 0.43169835209846497, gen p mean: 0.0, mean p set: 0.448, frame p mean: 0.44801953434944153loss_pred:0.031770676374435425, decouple_loss:0.038604483008384705
loss_pred:0.030611524358391762, decouple_loss:0.03726477548480034
loss_pred:0.0305804293602705, decouple_loss:0.03788064047694206
Iteration: 50, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4705541729927063, gen p mean: 0.0, mean p set: 0.448, frame p mean: 0.4473431408405304
The modified gen p mean: 0.4668554663658142, gen p mean: 0.0, mean p set: 0.448, frame p mean: 0.4473765194416046
loss_pred:0.030984167009592056, decouple_loss:0.039613544940948486
The modified gen p mean: 0.4715026617050171, gen p mean: 0.0, mean p set: 0.448, frame p mean: 0.4472281336784363loss_pred:0.03147235885262489, decouple_loss:0.04208502173423767
loss_pred:0.030909163877367973, decouple_loss:0.041413046419620514
2023-04-17 00:03:42 testing...
The modified gen p mean: 0.429818332195282, gen p mean: 0.0, mean p set: 0.448, frame p mean: 0.4499312937259674
loss_pred:0.0397900827229023, decouple_loss:0.04671324044466019
The modified gen p mean: 0.4336360692977905, gen p mean: 0.0, mean p set: 0.448, frame p mean: 0.4493577778339386
The modified gen p mean: 0.4363219141960144, gen p mean: 0.0, mean p set: 0.448, frame p mean: 0.4499579966068268
loss_pred:0.03889603912830353, decouple_loss:0.04734421521425247
loss_pred:0.03869573399424553, decouple_loss:0.04476424306631088
WV_0_PC_0_EH_1_PS_40, loss: 0.04144097864627838, avg_mse: 0.050054799765348434
current test mse: 0.050055