After initialize model, args.img_channel:30
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012000_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012001_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012002_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012003_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012004_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012005_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012006_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012007_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012008_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012009_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012010_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012011_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012012_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012013_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012014_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012015_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012016_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012017_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012018_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012019_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012020_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012000_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012001_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012002_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012003_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012004_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012005_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012006_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012007_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012008_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012009_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012010_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012011_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012012_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012013_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012014_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012015_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012016_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012017_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012018_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012019_3_24hr.npz
train_data_files nums: 41
mnist test iterator, Loading data from /scratch/09012/haoli1/ERA5/val_dataset/era5_train_09012020_3_24hr.npz
NaN value num: 0
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012019_3_24hr.npz
NaN value num: 0
Iteration: 1, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.9051563143730164
loss_pred:0.2119518369436264, decouple_loss:0.050629664212465286
The generated pressure mean: 0.9048144221305847
loss_pred:0.19941318035125732, decouple_loss:0.05613906309008598
The generated pressure mean: 0.9053782820701599
loss_pred:0.205846905708313, decouple_loss:0.05705619230866432
/work/09012/haoli1/ls6/Pyt/lib/python3.9/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '
Iteration: 2, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.9015699028968811
loss_pred:0.21473321318626404, decouple_loss:0.29816848039627075
The generated pressure mean: 0.899813175201416
loss_pred:0.21407060325145721, decouple_loss:0.2976747751235962
The generated pressure mean: 0.8985869884490967
loss_pred:0.21218173205852509, decouple_loss:0.28715530037879944
Iteration: 3, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.907433807849884
loss_pred:0.2260935753583908, decouple_loss:0.5204997062683105
The generated pressure mean: 0.9102587699890137
loss_pred:0.2259741723537445, decouple_loss:0.5324216485023499
The generated pressure mean: 0.9088572859764099
loss_pred:0.2273833155632019, decouple_loss:0.5245639681816101
Iteration: 4, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.910590410232544
loss_pred:0.2533490061759949, decouple_loss:0.7543273568153381
The generated pressure mean: 0.9115480184555054
loss_pred:0.2549932897090912, decouple_loss:0.7453652620315552
The generated pressure mean: 0.908889889717102
loss_pred:0.2592703104019165, decouple_loss:0.754006028175354
Iteration: 5, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.8921707272529602
loss_pred:0.21224260330200195, decouple_loss:0.5311284065246582
The generated pressure mean: 0.8928034901618958
loss_pred:0.21224206686019897, decouple_loss:0.5155808329582214
The generated pressure mean: 0.8996170163154602
loss_pred:0.21382327377796173, decouple_loss:0.4839128255844116
Iteration: 6, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.9012114405632019
loss_pred:0.20720769464969635, decouple_loss:0.6934978365898132
The generated pressure mean: 0.9012324810028076
loss_pred:0.21459007263183594, decouple_loss:0.6956769227981567
The generated pressure mean: 0.9025580883026123
loss_pred:0.20816248655319214, decouple_loss:0.679740846157074
Iteration: 7, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.9027474522590637
loss_pred:0.20233824849128723, decouple_loss:0.7009209990501404
The generated pressure mean: 0.9018436074256897
loss_pred:0.20598287880420685, decouple_loss:0.6163294315338135
The generated pressure mean: 0.9021764993667603
loss_pred:0.1956045925617218, decouple_loss:0.6521376967430115
Iteration: 8, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.8651571273803711
loss_pred:0.18798325955867767, decouple_loss:0.7495039105415344
The generated pressure mean: 0.8632968068122864
loss_pred:0.18905049562454224, decouple_loss:0.638834536075592
The generated pressure mean: 0.8652712106704712
loss_pred:0.1868576556444168, decouple_loss:0.7414272427558899
Iteration: 9, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.8737006187438965
loss_pred:0.18468138575553894, decouple_loss:0.6224460005760193
The generated pressure mean: 0.8746155500411987
loss_pred:0.17936702072620392, decouple_loss:0.6392471790313721
The generated pressure mean: 0.8735219836235046
loss_pred:0.18715766072273254, decouple_loss:0.5941837430000305
Iteration: 10, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.8895695805549622
loss_pred:0.19571174681186676, decouple_loss:0.5668829083442688
The generated pressure mean: 0.8896223306655884
loss_pred:0.18875548243522644, decouple_loss:0.491253525018692
The generated pressure mean: 0.8885367512702942
loss_pred:0.19370658695697784, decouple_loss:0.5765679478645325
2023-04-16 01:25:56 testing...
The generated pressure mean: 0.31550347805023193
loss_pred:0.19284799695014954, decouple_loss:0.5107778906822205
The generated pressure mean: 0.31547901034355164
loss_pred:0.19897538423538208, decouple_loss:0.5195272564888
The generated pressure mean: 0.31520089507102966
loss_pred:0.19142310321331024, decouple_loss:0.5155720114707947
Loss: 0.22018012404441833, avg_mse: 0.21246552467346191
current test mse: 0.212466
Iteration: 11, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.8431585431098938
loss_pred:0.18140216171741486, decouple_loss:0.55210280418396
The generated pressure mean: 0.8414644598960876
loss_pred:0.18982650339603424, decouple_loss:0.5336661338806152
The generated pressure mean: 0.8425711393356323
loss_pred:0.1859147995710373, decouple_loss:0.5797422528266907
Iteration: 12, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.8232577443122864
loss_pred:0.16950324177742004, decouple_loss:0.507157027721405
The generated pressure mean: 0.8229294419288635
The generated pressure mean: 0.8236541748046875loss_pred:0.16350042819976807, decouple_loss:0.512056291103363
loss_pred:0.16684944927692413, decouple_loss:0.5250113010406494
Iteration: 13, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.8041218519210815
loss_pred:0.16308222711086273, decouple_loss:0.4698348939418793
The generated pressure mean: 0.8041441440582275
loss_pred:0.15771885216236115, decouple_loss:0.4807332456111908
The generated pressure mean: 0.8034033179283142
loss_pred:0.16291330754756927, decouple_loss:0.4707570970058441
Iteration: 14, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.7836664319038391
loss_pred:0.15206031501293182, decouple_loss:0.4486461281776428
The generated pressure mean: 0.7832251787185669
loss_pred:0.1462632566690445, decouple_loss:0.4648556709289551
The generated pressure mean: 0.7848379611968994
loss_pred:0.1502702534198761, decouple_loss:0.45039188861846924
Iteration: 15, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.7648741006851196
loss_pred:0.13826344907283783, decouple_loss:0.42274537682533264
The generated pressure mean: 0.7630124092102051
loss_pred:0.14355801045894623, decouple_loss:0.4221104383468628
The generated pressure mean: 0.7643138766288757
loss_pred:0.1454756110906601, decouple_loss:0.41573625802993774
Iteration: 16, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.7421138882637024
loss_pred:0.13447347283363342, decouple_loss:0.37829962372779846
The generated pressure mean: 0.7398362755775452
loss_pred:0.13542276620864868, decouple_loss:0.39337339997291565
The generated pressure mean: 0.7419725656509399
loss_pred:0.13240636885166168, decouple_loss:0.3938531279563904
Iteration: 17, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.7116875648498535
loss_pred:0.12133530527353287, decouple_loss:0.35489150881767273
The generated pressure mean: 0.7113091945648193
loss_pred:0.12321293354034424, decouple_loss:0.35353589057922363
The generated pressure mean: 0.7126342058181763
loss_pred:0.1291249394416809, decouple_loss:0.3453359007835388
Iteration: 18, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.6844613552093506
loss_pred:0.11625690013170242, decouple_loss:0.33359789848327637
The generated pressure mean: 0.6842337250709534
loss_pred:0.1202467679977417, decouple_loss:0.33420416712760925
The generated pressure mean: 0.6844668388366699
loss_pred:0.11691993474960327, decouple_loss:0.3447243571281433
Iteration: 19, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.6491934657096863
loss_pred:0.1145990714430809, decouple_loss:0.32425981760025024
The generated pressure mean: 0.6506237983703613
loss_pred:0.10712514817714691, decouple_loss:0.31783801317214966
The generated pressure mean: 0.6488276124000549
loss_pred:0.11302627623081207, decouple_loss:0.3169817328453064
Iteration: 20, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.6160716414451599
loss_pred:0.10696922242641449, decouple_loss:0.2952476441860199
The generated pressure mean: 0.6179585456848145
loss_pred:0.09946822375059128, decouple_loss:0.2904150187969208
The generated pressure mean: 0.6175893545150757
loss_pred:0.10271351784467697, decouple_loss:0.2922622859477997
2023-04-16 01:27:56 testing...
The generated pressure mean: 0.3762601912021637
loss_pred:0.10802706331014633, decouple_loss:0.284369558095932
The generated pressure mean: 0.37625783681869507
loss_pred:0.10393201559782028, decouple_loss:0.28292030096054077
The generated pressure mean: 0.37592577934265137
loss_pred:0.10436471551656723, decouple_loss:0.28848764300346375
Loss: 0.1197042316198349, avg_mse: 0.10697626322507858
current test mse: 0.106976
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012003_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012003_3_24hr.npz
NaN value num: 0
Iteration: 21, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.581754744052887
loss_pred:0.09771361947059631, decouple_loss:0.2828947603702545
The generated pressure mean: 0.5824307203292847
loss_pred:0.09603473544120789, decouple_loss:0.2839832901954651
The generated pressure mean: 0.5830283761024475
loss_pred:0.09672446548938751, decouple_loss:0.2858854830265045
Iteration: 22, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.5462860465049744
loss_pred:0.09392879903316498, decouple_loss:0.2571169137954712
The generated pressure mean: 0.5465143918991089
The generated pressure mean: 0.5467219948768616
loss_pred:0.09312758594751358, decouple_loss:0.25851669907569885
loss_pred:0.0939122885465622, decouple_loss:0.25678348541259766
Iteration: 23, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.5149813890457153
loss_pred:0.0887317955493927, decouple_loss:0.2538890838623047
The generated pressure mean: 0.5147960186004639
loss_pred:0.09076026827096939, decouple_loss:0.2541499733924866
The generated pressure mean: 0.5147576332092285
loss_pred:0.08954557776451111, decouple_loss:0.2499396800994873
Iteration: 24, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4850050210952759
loss_pred:0.08291111141443253, decouple_loss:0.22845935821533203
The generated pressure mean: 0.48599398136138916
loss_pred:0.09063272923231125, decouple_loss:0.2299811691045761
The generated pressure mean: 0.484493225812912
loss_pred:0.08565641939640045, decouple_loss:0.2329387664794922
Iteration: 25, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45943379402160645
loss_pred:0.08450309187173843, decouple_loss:0.22247160971164703
The generated pressure mean: 0.4580409526824951
loss_pred:0.0844254419207573, decouple_loss:0.22641144692897797
The generated pressure mean: 0.45810818672180176
loss_pred:0.08431386202573776, decouple_loss:0.22261472046375275
Iteration: 26, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43850916624069214
loss_pred:0.08551455289125443, decouple_loss:0.20607136189937592
The generated pressure mean: 0.43718284368515015
loss_pred:0.08233942091464996, decouple_loss:0.21007561683654785
The generated pressure mean: 0.43786752223968506
loss_pred:0.08196493983268738, decouple_loss:0.21229831874370575
Iteration: 27, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4260559678077698
loss_pred:0.0830986350774765, decouple_loss:0.217310830950737
The generated pressure mean: 0.42472970485687256
loss_pred:0.08213212341070175, decouple_loss:0.21003170311450958
The generated pressure mean: 0.42560654878616333
loss_pred:0.08371518552303314, decouple_loss:0.21877925097942352
Iteration: 28, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4181232452392578
loss_pred:0.08769255131483078, decouple_loss:0.21210619807243347
The generated pressure mean: 0.4190513491630554
loss_pred:0.08608562499284744, decouple_loss:0.20278704166412354
The generated pressure mean: 0.41922685503959656
loss_pred:0.08776684105396271, decouple_loss:0.19654422998428345
Iteration: 29, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.41162940859794617
loss_pred:0.08568112552165985, decouple_loss:0.1800832450389862
The generated pressure mean: 0.4119173586368561
loss_pred:0.08446979522705078, decouple_loss:0.18273401260375977
The generated pressure mean: 0.4114684760570526
loss_pred:0.08044495433568954, decouple_loss:0.20070330798625946
Iteration: 30, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.40944740176200867
loss_pred:0.07977503538131714, decouple_loss:0.18082809448242188
The generated pressure mean: 0.40872350335121155
loss_pred:0.07889458537101746, decouple_loss:0.18370959162712097
The generated pressure mean: 0.4089949429035187
loss_pred:0.08255890756845474, decouple_loss:0.18749961256980896
2023-04-16 01:30:30 testing...
The generated pressure mean: 0.4181677997112274
loss_pred:0.08919417858123779, decouple_loss:0.1795690506696701
The generated pressure mean: 0.41856810450553894
loss_pred:0.08702223002910614, decouple_loss:0.18282634019851685
The generated pressure mean: 0.4183645248413086
loss_pred:0.08866375684738159, decouple_loss:0.1848825067281723
Loss: 0.09741469472646713, avg_mse: 0.08958694338798523
current test mse: 0.089587
Iteration: 31, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4175027906894684
loss_pred:0.08335894346237183, decouple_loss:0.18239180743694305
The generated pressure mean: 0.4178861379623413
loss_pred:0.0815454050898552, decouple_loss:0.19098861515522003
The generated pressure mean: 0.4164208769798279
loss_pred:0.08346665650606155, decouple_loss:0.18748365342617035
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 32, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4282529950141907
loss_pred:0.08052542060613632, decouple_loss:0.1768801212310791
The generated pressure mean: 0.42873191833496094
loss_pred:0.07895758002996445, decouple_loss:0.18092116713523865
The generated pressure mean: 0.4283732771873474
loss_pred:0.08163086324930191, decouple_loss:0.1818879097700119
Iteration: 33, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4372480809688568
loss_pred:0.08175700902938843, decouple_loss:0.1700601577758789
The generated pressure mean: 0.4373400807380676
loss_pred:0.0803983211517334, decouple_loss:0.16368936002254486
The generated pressure mean: 0.4371879994869232
loss_pred:0.08149014413356781, decouple_loss:0.16622291505336761
Iteration: 34, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44282883405685425
loss_pred:0.07887446880340576, decouple_loss:0.15809489786624908
The generated pressure mean: 0.4434179663658142
loss_pred:0.08172645419836044, decouple_loss:0.16271907091140747
The generated pressure mean: 0.4438299536705017
loss_pred:0.08058519661426544, decouple_loss:0.16344356536865234
Iteration: 35, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4495643973350525
loss_pred:0.08231306076049805, decouple_loss:0.1739111840724945
The generated pressure mean: 0.446200966835022
loss_pred:0.07755288481712341, decouple_loss:0.1526317298412323
The generated pressure mean: 0.4469050467014313
loss_pred:0.08036505430936813, decouple_loss:0.15399883687496185
Iteration: 36, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4525330066680908
loss_pred:0.07977905869483948, decouple_loss:0.15184317529201508
The generated pressure mean: 0.45284855365753174
loss_pred:0.07811805605888367, decouple_loss:0.14394806325435638
The generated pressure mean: 0.4507620930671692
loss_pred:0.07784224301576614, decouple_loss:0.1449194997549057
Iteration: 37, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4578460156917572
loss_pred:0.07665878534317017, decouple_loss:0.16515861451625824
The generated pressure mean: 0.4588056802749634
loss_pred:0.0792461410164833, decouple_loss:0.15716171264648438
The generated pressure mean: 0.45797669887542725
loss_pred:0.07768048346042633, decouple_loss:0.1335112452507019
Iteration: 38, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45822247862815857
loss_pred:0.07911673188209534, decouple_loss:0.16287273168563843
The generated pressure mean: 0.4584467113018036
loss_pred:0.0786103755235672, decouple_loss:0.13549189269542694
The generated pressure mean: 0.4580724835395813
loss_pred:0.07794193923473358, decouple_loss:0.13438564538955688
Iteration: 39, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45616498589515686
loss_pred:0.07729379087686539, decouple_loss:0.15299777686595917
The generated pressure mean: 0.4536874294281006
loss_pred:0.0781237781047821, decouple_loss:0.15367695689201355
The generated pressure mean: 0.4553588926792145
loss_pred:0.08016802370548248, decouple_loss:0.13120153546333313
Iteration: 40, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4491190016269684
loss_pred:0.0763133317232132, decouple_loss:0.14708653092384338
The generated pressure mean: 0.44975781440734863
loss_pred:0.0786048099398613, decouple_loss:0.14753831923007965
The generated pressure mean: 0.4506722092628479
loss_pred:0.08061656355857849, decouple_loss:0.12479399889707565
2023-04-16 01:32:32 testing...
The generated pressure mean: 0.41017845273017883
loss_pred:0.08588549494743347, decouple_loss:0.12034700065851212
The generated pressure mean: 0.41118723154067993
loss_pred:0.08383901417255402, decouple_loss:0.1253110021352768
The generated pressure mean: 0.4111608564853668
loss_pred:0.08530749380588531, decouple_loss:0.12543976306915283
Loss: 0.09119562804698944, avg_mse: 0.08633386343717575
current test mse: 0.086334
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012014_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012014_3_24hr.npz
NaN value num: 0
Iteration: 41, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44831380248069763
loss_pred:0.07707683742046356, decouple_loss:0.14253228902816772
The generated pressure mean: 0.44724801182746887
loss_pred:0.07665453106164932, decouple_loss:0.12098942697048187
The generated pressure mean: 0.4488826096057892
loss_pred:0.0800662711262703, decouple_loss:0.1315605491399765
Iteration: 42, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45200246572494507
loss_pred:0.07889968901872635, decouple_loss:0.11535751819610596
The generated pressure mean: 0.4512297809123993
loss_pred:0.07768340408802032, decouple_loss:0.11624830961227417
The generated pressure mean: 0.44959598779678345
loss_pred:0.07484881579875946, decouple_loss:0.12202499061822891
Iteration: 43, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44922560453414917
loss_pred:0.07612136751413345, decouple_loss:0.12511451542377472
The generated pressure mean: 0.44835370779037476
loss_pred:0.07936114072799683, decouple_loss:0.13661280274391174
The generated pressure mean: 0.446853905916214
loss_pred:0.07817681133747101, decouple_loss:0.12189725041389465
Iteration: 44, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4452941119670868
loss_pred:0.07810308039188385, decouple_loss:0.11667405068874359
The generated pressure mean: 0.4427151679992676
loss_pred:0.07581107318401337, decouple_loss:0.11206063628196716
The generated pressure mean: 0.4427977502346039
loss_pred:0.07549936324357986, decouple_loss:0.10961008816957474
Iteration: 45, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4476104974746704
loss_pred:0.07556858658790588, decouple_loss:0.12184063345193863
The generated pressure mean: 0.449270099401474
loss_pred:0.07968927919864655, decouple_loss:0.10410512238740921
The generated pressure mean: 0.44620150327682495
loss_pred:0.07578213512897491, decouple_loss:0.10529990494251251
Iteration: 46, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44589629769325256
loss_pred:0.07353566586971283, decouple_loss:0.11120270192623138
The generated pressure mean: 0.44575852155685425
loss_pred:0.07625777274370193, decouple_loss:0.10254409164190292
The generated pressure mean: 0.4488111138343811
loss_pred:0.07860974222421646, decouple_loss:0.09999716281890869
Iteration: 47, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4448307156562805
loss_pred:0.07642044126987457, decouple_loss:0.10042255371809006
The generated pressure mean: 0.445883184671402
loss_pred:0.07738441973924637, decouple_loss:0.09895940124988556
The generated pressure mean: 0.4454074800014496
loss_pred:0.07853350043296814, decouple_loss:0.09772744029760361
Iteration: 48, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45328837633132935
loss_pred:0.0747586265206337, decouple_loss:0.09453487396240234
The generated pressure mean: 0.4521366357803345
loss_pred:0.07568687200546265, decouple_loss:0.09396985918283463
The generated pressure mean: 0.4562942683696747
loss_pred:0.07928444445133209, decouple_loss:0.09746482968330383
Iteration: 49, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4581357538700104
loss_pred:0.07681816071271896, decouple_loss:0.09228412806987762
The generated pressure mean: 0.45833757519721985
loss_pred:0.07869075238704681, decouple_loss:0.0944393202662468
The generated pressure mean: 0.45701783895492554
loss_pred:0.07447190582752228, decouple_loss:0.0957791805267334
Iteration: 50, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45548751950263977
loss_pred:0.07869347929954529, decouple_loss:0.09209194034337997
The generated pressure mean: 0.45493578910827637
loss_pred:0.07883837819099426, decouple_loss:0.09968438744544983
The generated pressure mean: 0.45436474680900574
loss_pred:0.07676886022090912, decouple_loss:0.09249796718358994
2023-04-16 01:35:11 testing...
The generated pressure mean: 0.407340943813324
loss_pred:0.08496877551078796, decouple_loss:0.09253629297018051
The generated pressure mean: 0.40820303559303284
loss_pred:0.08298711478710175, decouple_loss:0.09889364242553711
The generated pressure mean: 0.4084923565387726
loss_pred:0.08445750921964645, decouple_loss:0.09902720153331757
Loss: 0.08897875249385834, avg_mse: 0.08587173372507095
current test mse: 0.085872
Iteration: 51, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45775899291038513
loss_pred:0.07475561648607254, decouple_loss:0.08536254614591599
The generated pressure mean: 0.45909008383750916
loss_pred:0.07635831832885742, decouple_loss:0.08813701570034027
The generated pressure mean: 0.4584670662879944
loss_pred:0.07486776262521744, decouple_loss:0.08613546937704086
Iteration: 52, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4613737463951111
loss_pred:0.07597335427999496, decouple_loss:0.0833568274974823
The generated pressure mean: 0.46396586298942566
loss_pred:0.07806700468063354, decouple_loss:0.0842972919344902
The generated pressure mean: 0.45860469341278076
loss_pred:0.07405716180801392, decouple_loss:0.08692913502454758
Iteration: 53, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4592147767543793
loss_pred:0.07855425775051117, decouple_loss:0.0835561603307724
The generated pressure mean: 0.4580938220024109
loss_pred:0.07565553486347198, decouple_loss:0.08233537524938583
The generated pressure mean: 0.457593709230423
loss_pred:0.0734679102897644, decouple_loss:0.08098376542329788
Iteration: 54, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4570978879928589
loss_pred:0.07533574849367142, decouple_loss:0.08191975206136703
The generated pressure mean: 0.4566250145435333
loss_pred:0.07564003765583038, decouple_loss:0.0813932791352272
The generated pressure mean: 0.4609238803386688
loss_pred:0.07720117270946503, decouple_loss:0.08103232085704803
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 55, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46033817529678345
loss_pred:0.07515683025121689, decouple_loss:0.08440177887678146
The generated pressure mean: 0.4580554962158203
loss_pred:0.0722912847995758, decouple_loss:0.07773800194263458
The generated pressure mean: 0.45850256085395813
loss_pred:0.07705085724592209, decouple_loss:0.0790804848074913
Iteration: 56, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4561147391796112
loss_pred:0.07604492455720901, decouple_loss:0.0753253921866417
The generated pressure mean: 0.45636600255966187
loss_pred:0.07586678862571716, decouple_loss:0.07654581218957901
The generated pressure mean: 0.45780208706855774
loss_pred:0.07721257954835892, decouple_loss:0.08049940317869186
Iteration: 57, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45637741684913635
loss_pred:0.07438912242650986, decouple_loss:0.07400016486644745
The generated pressure mean: 0.45537760853767395
loss_pred:0.07396533340215683, decouple_loss:0.07517250627279282
The generated pressure mean: 0.4565237760543823
loss_pred:0.07766756415367126, decouple_loss:0.07377204298973083
Iteration: 58, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4540002942085266
loss_pred:0.07430309802293777, decouple_loss:0.07239413261413574
The generated pressure mean: 0.4523015320301056
loss_pred:0.07295306771993637, decouple_loss:0.07031983137130737
The generated pressure mean: 0.4524553716182709
loss_pred:0.07778631895780563, decouple_loss:0.0830811932682991
Iteration: 59, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.454262912273407
loss_pred:0.07513744384050369, decouple_loss:0.07025331258773804
The generated pressure mean: 0.45554378628730774
loss_pred:0.07588129490613937, decouple_loss:0.07778158038854599
The generated pressure mean: 0.45575717091560364
loss_pred:0.07459887117147446, decouple_loss:0.07380851358175278
Iteration: 60, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45619040727615356
loss_pred:0.07361667603254318, decouple_loss:0.07031283527612686
The generated pressure mean: 0.45614880323410034
loss_pred:0.07387419044971466, decouple_loss:0.07059494405984879
The generated pressure mean: 0.45654118061065674
loss_pred:0.0748012587428093, decouple_loss:0.07063711434602737
2023-04-16 01:37:12 testing...
The generated pressure mean: 0.4086308777332306
loss_pred:0.08384928852319717, decouple_loss:0.07169612497091293
The generated pressure mean: 0.4097818434238434
loss_pred:0.08193235099315643, decouple_loss:0.07645289599895477
The generated pressure mean: 0.4099714457988739
loss_pred:0.08330147713422775, decouple_loss:0.07721968740224838
Loss: 0.08678385615348816, avg_mse: 0.08488939702510834
current test mse: 0.084889
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012017_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012017_3_24hr.npz
NaN value num: 0
Iteration: 61, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45691925287246704
loss_pred:0.07466229051351547, decouple_loss:0.07313898205757141
The generated pressure mean: 0.45709794759750366
loss_pred:0.07248654216527939, decouple_loss:0.07406876981258392
The generated pressure mean: 0.4590502977371216
loss_pred:0.07566145062446594, decouple_loss:0.07221423834562302
Iteration: 62, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46194329857826233
loss_pred:0.07655470073223114, decouple_loss:0.07387877255678177
The generated pressure mean: 0.459931343793869
loss_pred:0.07633260637521744, decouple_loss:0.07896837592124939
The generated pressure mean: 0.458476722240448
loss_pred:0.07645126432180405, decouple_loss:0.06953627616167068
Iteration: 63, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4598079025745392
loss_pred:0.07351968437433243, decouple_loss:0.06865566223859787
The generated pressure mean: 0.4608735144138336
loss_pred:0.07528488337993622, decouple_loss:0.07005169987678528
The generated pressure mean: 0.45900899171829224
loss_pred:0.07894296199083328, decouple_loss:0.06948784738779068
Iteration: 64, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4567655026912689
loss_pred:0.07632597535848618, decouple_loss:0.06895551830530167
The generated pressure mean: 0.45535987615585327
loss_pred:0.07754091173410416, decouple_loss:0.06686360388994217
The generated pressure mean: 0.45483681559562683
loss_pred:0.07634750753641129, decouple_loss:0.06939944624900818
Iteration: 65, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45517224073410034
loss_pred:0.07617441564798355, decouple_loss:0.06671680510044098
The generated pressure mean: 0.4533761143684387
loss_pred:0.07462191581726074, decouple_loss:0.06562738865613937
The generated pressure mean: 0.45372769236564636
loss_pred:0.07429061830043793, decouple_loss:0.06890557706356049
Iteration: 66, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4565901756286621
loss_pred:0.07508863508701324, decouple_loss:0.06640555709600449
The generated pressure mean: 0.45845237374305725
loss_pred:0.07427872717380524, decouple_loss:0.06452152878046036
The generated pressure mean: 0.4590476453304291
loss_pred:0.07682009041309357, decouple_loss:0.062330152839422226
Iteration: 67, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44781920313835144
loss_pred:0.07391975820064545, decouple_loss:0.06574578583240509
The generated pressure mean: 0.4479982256889343
loss_pred:0.07409116625785828, decouple_loss:0.06311938166618347
The generated pressure mean: 0.44795453548431396
loss_pred:0.07300510257482529, decouple_loss:0.06989649683237076
Iteration: 68, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45743271708488464
loss_pred:0.07442866265773773, decouple_loss:0.0663527399301529
The generated pressure mean: 0.45497334003448486
loss_pred:0.07359025627374649, decouple_loss:0.06359492987394333
The generated pressure mean: 0.45567911863327026
loss_pred:0.07538852840662003, decouple_loss:0.06576835364103317
Iteration: 69, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45011186599731445
loss_pred:0.07827579230070114, decouple_loss:0.06303179264068604
The generated pressure mean: 0.45298299193382263
loss_pred:0.0759952962398529, decouple_loss:0.060538072139024734
The generated pressure mean: 0.45184528827667236
loss_pred:0.07740538567304611, decouple_loss:0.060567114502191544
Iteration: 70, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4498004615306854
loss_pred:0.07537999004125595, decouple_loss:0.06553572416305542
The generated pressure mean: 0.44760480523109436
loss_pred:0.07684124261140823, decouple_loss:0.06190119683742523
The generated pressure mean: 0.44952210783958435
loss_pred:0.07407631725072861, decouple_loss:0.06322518736124039
2023-04-16 01:39:59 testing...
The generated pressure mean: 0.40851086378097534
loss_pred:0.082887202501297, decouple_loss:0.0594756081700325
The generated pressure mean: 0.4089590907096863
loss_pred:0.08113853633403778, decouple_loss:0.060642678290605545
The generated pressure mean: 0.4092932641506195
loss_pred:0.0824330672621727, decouple_loss:0.060924552381038666
Loss: 0.08517032116651535, avg_mse: 0.08438314497470856
current test mse: 0.084383
Iteration: 71, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4551297128200531
loss_pred:0.07659800350666046, decouple_loss:0.06316382437944412
The generated pressure mean: 0.4536280333995819
loss_pred:0.07722841203212738, decouple_loss:0.06102783605456352
The generated pressure mean: 0.45466944575309753
loss_pred:0.07324475049972534, decouple_loss:0.06082264706492424
Iteration: 72, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4546152651309967
loss_pred:0.07517071068286896, decouple_loss:0.06305767595767975
The generated pressure mean: 0.4543953239917755
loss_pred:0.07560332119464874, decouple_loss:0.060213588178157806
The generated pressure mean: 0.45597848296165466
loss_pred:0.07227502763271332, decouple_loss:0.0588386133313179
Iteration: 73, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.455194890499115
loss_pred:0.07216353714466095, decouple_loss:0.05817827209830284
The generated pressure mean: 0.4554363787174225
loss_pred:0.0743042603135109, decouple_loss:0.05965713411569595
The generated pressure mean: 0.4560944139957428
loss_pred:0.07602030038833618, decouple_loss:0.062206584960222244
Iteration: 74, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45889776945114136
loss_pred:0.0725628063082695, decouple_loss:0.05873239040374756
The generated pressure mean: 0.4594325125217438
loss_pred:0.07464579492807388, decouple_loss:0.058684855699539185
The generated pressure mean: 0.4579600691795349
loss_pred:0.07357291877269745, decouple_loss:0.05920747295022011
Iteration: 75, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45758241415023804
loss_pred:0.07636738568544388, decouple_loss:0.05546550452709198
The generated pressure mean: 0.45756158232688904
loss_pred:0.07947882264852524, decouple_loss:0.056492794305086136
The generated pressure mean: 0.4556902050971985
loss_pred:0.0781206414103508, decouple_loss:0.058502767235040665
Iteration: 76, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45850515365600586
loss_pred:0.07859643548727036, decouple_loss:0.057261742651462555
The generated pressure mean: 0.4600764214992523
loss_pred:0.07347986847162247, decouple_loss:0.05745859071612358
The generated pressure mean: 0.46070021390914917
loss_pred:0.07456690818071365, decouple_loss:0.05674814060330391
Iteration: 77, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4618420898914337
loss_pred:0.07444167137145996, decouple_loss:0.056535445153713226
The generated pressure mean: 0.460226446390152
loss_pred:0.07610934972763062, decouple_loss:0.05597042292356491
The generated pressure mean: 0.46104690432548523
loss_pred:0.07620391249656677, decouple_loss:0.05771511048078537
Iteration: 78, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4561336934566498
loss_pred:0.07880588620901108, decouple_loss:0.05841292068362236
The generated pressure mean: 0.45700085163116455
loss_pred:0.07310294359922409, decouple_loss:0.058075252920389175
The generated pressure mean: 0.4567725360393524
loss_pred:0.07178191840648651, decouple_loss:0.056413162499666214
Iteration: 79, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46257781982421875
loss_pred:0.07257745414972305, decouple_loss:0.054574426263570786
The generated pressure mean: 0.46271786093711853
loss_pred:0.07299353182315826, decouple_loss:0.05859237164258957
The generated pressure mean: 0.46260392665863037
loss_pred:0.07626179605722427, decouple_loss:0.05399634316563606
Iteration: 80, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4628313183784485
The generated pressure mean: 0.4635148048400879
loss_pred:0.07303569465875626, decouple_loss:0.05637981370091438
loss_pred:0.0780562311410904, decouple_loss:0.055128175765275955
The generated pressure mean: 0.4659997224807739
loss_pred:0.0785784125328064, decouple_loss:0.05426725372672081
2023-04-16 01:42:01 testing...
The generated pressure mean: 0.4077904224395752
loss_pred:0.08213614672422409, decouple_loss:0.05505942180752754
The generated pressure mean: 0.4083743989467621
loss_pred:0.08042731136083603, decouple_loss:0.055932775139808655
The generated pressure mean: 0.408713161945343
loss_pred:0.08160732686519623, decouple_loss:0.056414779275655746
Loss: 0.08418037742376328, avg_mse: 0.0835672989487648
current test mse: 0.083567
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012013_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012013_3_24hr.npz
NaN value num: 0
Iteration: 81, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4553273320198059
loss_pred:0.0728975236415863, decouple_loss:0.05456140637397766
The generated pressure mean: 0.4542567729949951
loss_pred:0.06955618411302567, decouple_loss:0.05650508403778076
The generated pressure mean: 0.45428451895713806
loss_pred:0.07176027446985245, decouple_loss:0.060191065073013306
Iteration: 82, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.456412136554718
loss_pred:0.07529883831739426, decouple_loss:0.05895046144723892
The generated pressure mean: 0.4550926089286804
loss_pred:0.07072348892688751, decouple_loss:0.0541255921125412
The generated pressure mean: 0.45661044120788574
loss_pred:0.07369738817214966, decouple_loss:0.05401967093348503
Iteration: 83, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45930853486061096
The generated pressure mean: 0.45930060744285583
loss_pred:0.07182691246271133, decouple_loss:0.06148376315832138
loss_pred:0.07251910120248795, decouple_loss:0.05462684854865074
The generated pressure mean: 0.45923739671707153
loss_pred:0.07537498325109482, decouple_loss:0.05432231351733208
Iteration: 84, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45230504870414734
loss_pred:0.07279685139656067, decouple_loss:0.055941686034202576
The generated pressure mean: 0.45163097977638245
loss_pred:0.07224444299936295, decouple_loss:0.052980270236730576
The generated pressure mean: 0.45075979828834534
loss_pred:0.07101938128471375, decouple_loss:0.05495944246649742
Iteration: 85, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45440173149108887
The generated pressure mean: 0.45495733618736267
loss_pred:0.07062114775180817, decouple_loss:0.05415267124772072
loss_pred:0.07296603918075562, decouple_loss:0.05294158309698105
The generated pressure mean: 0.45587414503097534
loss_pred:0.07670421898365021, decouple_loss:0.05095107853412628
Iteration: 86, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4581333100795746
loss_pred:0.07490251213312149, decouple_loss:0.051013849675655365
The generated pressure mean: 0.4573149085044861
loss_pred:0.07067124545574188, decouple_loss:0.05306263640522957
The generated pressure mean: 0.45768946409225464
loss_pred:0.07495202124118805, decouple_loss:0.05066825821995735
Iteration: 87, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45392295718193054
loss_pred:0.0723901018500328, decouple_loss:0.05365990847349167
The generated pressure mean: 0.4532545506954193
loss_pred:0.07242873311042786, decouple_loss:0.05343526229262352
The generated pressure mean: 0.45449379086494446
loss_pred:0.07010182738304138, decouple_loss:0.05301976948976517
Iteration: 88, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4644205868244171
loss_pred:0.07250586897134781, decouple_loss:0.05332835018634796
The generated pressure mean: 0.46542513370513916
loss_pred:0.0686074048280716, decouple_loss:0.05535118281841278
The generated pressure mean: 0.46477583050727844
loss_pred:0.0762881338596344, decouple_loss:0.05236402899026871
Iteration: 89, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4600642919540405
loss_pred:0.07207541167736053, decouple_loss:0.05161657556891441
The generated pressure mean: 0.4609103798866272
loss_pred:0.06804914027452469, decouple_loss:0.049268320202827454
The generated pressure mean: 0.4601399004459381
loss_pred:0.07470361143350601, decouple_loss:0.0487467423081398
Iteration: 90, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4568853974342346
loss_pred:0.07571243494749069, decouple_loss:0.05209140479564667
The generated pressure mean: 0.45658737421035767
loss_pred:0.0703856348991394, decouple_loss:0.052186720073223114
The generated pressure mean: 0.4564502537250519
loss_pred:0.07431228458881378, decouple_loss:0.05094192549586296
2023-04-16 01:44:43 testing...
The generated pressure mean: 0.40594482421875
loss_pred:0.08173011988401413, decouple_loss:0.05092709884047508
The generated pressure mean: 0.4070174992084503
loss_pred:0.07997933775186539, decouple_loss:0.053835686296224594
The generated pressure mean: 0.4071859121322632
loss_pred:0.08103972673416138, decouple_loss:0.05368562415242195
Loss: 0.08355721086263657, avg_mse: 0.08300558477640152
current test mse: 0.083006
Iteration: 91, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4640531539916992
loss_pred:0.07578164339065552, decouple_loss:0.05081135034561157
The generated pressure mean: 0.4638267755508423
loss_pred:0.0729028508067131, decouple_loss:0.05005010962486267
The generated pressure mean: 0.4636997878551483
loss_pred:0.07394152134656906, decouple_loss:0.05218810960650444
Iteration: 92, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45625999569892883
loss_pred:0.06800390779972076, decouple_loss:0.04863333702087402
The generated pressure mean: 0.4553498327732086
loss_pred:0.07558692991733551, decouple_loss:0.04828464984893799
The generated pressure mean: 0.45567795634269714
loss_pred:0.06957930326461792, decouple_loss:0.049555905163288116
Iteration: 93, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46078529953956604
loss_pred:0.07491688430309296, decouple_loss:0.04868707433342934
The generated pressure mean: 0.46028953790664673
loss_pred:0.0743560865521431, decouple_loss:0.04953505098819733
The generated pressure mean: 0.4597587287425995
loss_pred:0.07350197434425354, decouple_loss:0.048750169575214386
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 94, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4576387107372284
loss_pred:0.074513278901577, decouple_loss:0.049762725830078125
The generated pressure mean: 0.4584924280643463
loss_pred:0.07413940131664276, decouple_loss:0.04829263687133789
The generated pressure mean: 0.4588966965675354
loss_pred:0.07309766858816147, decouple_loss:0.05097619816660881
Iteration: 95, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45860692858695984
loss_pred:0.07138558477163315, decouple_loss:0.047537315636873245
The generated pressure mean: 0.45879000425338745
loss_pred:0.0704185739159584, decouple_loss:0.04902945086359978
The generated pressure mean: 0.4568207561969757
loss_pred:0.0681479349732399, decouple_loss:0.04882102087140083
Iteration: 96, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46249935030937195
loss_pred:0.07101237773895264, decouple_loss:0.05087129399180412
The generated pressure mean: 0.4630621671676636
loss_pred:0.06651444733142853, decouple_loss:0.0473489835858345
The generated pressure mean: 0.4610808491706848
loss_pred:0.07283850014209747, decouple_loss:0.04840705543756485
Iteration: 97, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4527680277824402
loss_pred:0.07409388571977615, decouple_loss:0.048293858766555786
The generated pressure mean: 0.452634334564209
loss_pred:0.07476037740707397, decouple_loss:0.048566531389951706
The generated pressure mean: 0.45435842871665955
loss_pred:0.07632764428853989, decouple_loss:0.04991777241230011
Iteration: 98, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46958038210868835
loss_pred:0.070513054728508, decouple_loss:0.04884487763047218
The generated pressure mean: 0.4698927402496338
loss_pred:0.07030171900987625, decouple_loss:0.05033817142248154
The generated pressure mean: 0.46922096610069275
loss_pred:0.07222554832696915, decouple_loss:0.04921324551105499
Iteration: 99, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4359997808933258
loss_pred:0.07189302146434784, decouple_loss:0.05820909142494202
The generated pressure mean: 0.43548908829689026
loss_pred:0.0766839012503624, decouple_loss:0.05999889224767685
The generated pressure mean: 0.4365885257720947
loss_pred:0.07669242471456528, decouple_loss:0.05933579429984093
Iteration: 100, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4670996069908142
loss_pred:0.06797685474157333, decouple_loss:0.05029096454381943
The generated pressure mean: 0.46692147850990295
loss_pred:0.07070356607437134, decouple_loss:0.04912862181663513
The generated pressure mean: 0.4674646854400635
loss_pred:0.07052076607942581, decouple_loss:0.047484390437603
2023-04-16 01:46:44 testing...
The generated pressure mean: 0.40498772263526917
loss_pred:0.08061818778514862, decouple_loss:0.0509973019361496
The generated pressure mean: 0.4059005677700043
loss_pred:0.0789366140961647, decouple_loss:0.053059060126543045
The generated pressure mean: 0.40592798590660095
loss_pred:0.0800711140036583, decouple_loss:0.05380759760737419
Loss: 0.08250637352466583, avg_mse: 0.08184847235679626
current test mse: 0.081848
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012012_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012012_3_24hr.npz
NaN value num: 0
Iteration: 101, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4687650501728058
loss_pred:0.07174637913703918, decouple_loss:0.05326221138238907
The generated pressure mean: 0.4692040979862213
loss_pred:0.07391341030597687, decouple_loss:0.051911789923906326
The generated pressure mean: 0.4677835702896118
loss_pred:0.07414864748716354, decouple_loss:0.04814315214753151
Iteration: 102, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45577502250671387
loss_pred:0.07275130599737167, decouple_loss:0.05013458803296089
The generated pressure mean: 0.45648714900016785
loss_pred:0.07559186965227127, decouple_loss:0.050775155425071716
The generated pressure mean: 0.4553064703941345
loss_pred:0.07138476520776749, decouple_loss:0.04802142083644867
Iteration: 103, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46511492133140564
loss_pred:0.07414499670267105, decouple_loss:0.04544948413968086
The generated pressure mean: 0.46542349457740784
loss_pred:0.0754564180970192, decouple_loss:0.04710500314831734
The generated pressure mean: 0.46512776613235474
loss_pred:0.07154647260904312, decouple_loss:0.048450637608766556
Iteration: 104, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4669456481933594
loss_pred:0.07039643079042435, decouple_loss:0.04824014753103256
The generated pressure mean: 0.46651268005371094
loss_pred:0.07156254351139069, decouple_loss:0.04921788349747658
The generated pressure mean: 0.46702149510383606
loss_pred:0.07303482294082642, decouple_loss:0.05373970791697502
Iteration: 105, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4575333893299103
loss_pred:0.07301536202430725, decouple_loss:0.043299078941345215
The generated pressure mean: 0.4573187828063965
loss_pred:0.07467731088399887, decouple_loss:0.04502474516630173
The generated pressure mean: 0.4582435190677643
loss_pred:0.06976815313100815, decouple_loss:0.043984659016132355
Iteration: 106, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4611148238182068
loss_pred:0.07208098471164703, decouple_loss:0.04667571187019348
The generated pressure mean: 0.45999768376350403
loss_pred:0.07064257562160492, decouple_loss:0.046063244342803955
The generated pressure mean: 0.46061384677886963
loss_pred:0.07063524425029755, decouple_loss:0.04688987508416176
Iteration: 107, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46657341718673706
loss_pred:0.07129136472940445, decouple_loss:0.04570391774177551
The generated pressure mean: 0.4664700925350189
loss_pred:0.07084393501281738, decouple_loss:0.04597821831703186
The generated pressure mean: 0.46661561727523804
loss_pred:0.07026679068803787, decouple_loss:0.04633688926696777
Iteration: 108, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45802003145217896
loss_pred:0.07356996834278107, decouple_loss:0.04441126808524132
The generated pressure mean: 0.4570706784725189
loss_pred:0.07263516634702682, decouple_loss:0.045022979378700256
The generated pressure mean: 0.4567013084888458
loss_pred:0.06996288895606995, decouple_loss:0.04430007189512253
Iteration: 109, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4671279191970825
loss_pred:0.07276437431573868, decouple_loss:0.04645448923110962
The generated pressure mean: 0.46738091111183167
loss_pred:0.07184156775474548, decouple_loss:0.046180058270692825
The generated pressure mean: 0.4672292172908783
loss_pred:0.07100975513458252, decouple_loss:0.0480184331536293
Iteration: 110, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4646364152431488
loss_pred:0.07026495039463043, decouple_loss:0.04260461404919624
The generated pressure mean: 0.46831750869750977
loss_pred:0.07027453184127808, decouple_loss:0.043002720922231674
The generated pressure mean: 0.4679148197174072
loss_pred:0.06996867060661316, decouple_loss:0.04304974153637886
2023-04-16 01:49:37 testing...
The generated pressure mean: 0.4070291817188263
loss_pred:0.07865509390830994, decouple_loss:0.04619748517870903
The generated pressure mean: 0.40761640667915344
loss_pred:0.07717029005289078, decouple_loss:0.04638024419546127
The generated pressure mean: 0.4076593220233917
loss_pred:0.07827264070510864, decouple_loss:0.048058439046144485
Loss: 0.08037661015987396, avg_mse: 0.079781174659729
current test mse: 0.079781
Iteration: 111, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46064645051956177
loss_pred:0.07043802738189697, decouple_loss:0.045942552387714386
The generated pressure mean: 0.458709716796875
loss_pred:0.0681685209274292, decouple_loss:0.04651470109820366
The generated pressure mean: 0.4580879807472229
loss_pred:0.07001855224370956, decouple_loss:0.0477004274725914
Iteration: 112, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46211278438568115
loss_pred:0.07003651559352875, decouple_loss:0.045606423169374466
The generated pressure mean: 0.46372178196907043
loss_pred:0.07068809866905212, decouple_loss:0.043752994388341904
The generated pressure mean: 0.46583253145217896
loss_pred:0.07145838439464569, decouple_loss:0.04521806538105011
Iteration: 113, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46212249994277954
loss_pred:0.07172541320323944, decouple_loss:0.04262964800000191
The generated pressure mean: 0.4640578329563141
loss_pred:0.07032347470521927, decouple_loss:0.04290055111050606
The generated pressure mean: 0.46417227387428284
loss_pred:0.07108066976070404, decouple_loss:0.045750658959150314
Iteration: 114, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45297253131866455
loss_pred:0.07074635475873947, decouple_loss:0.04440833628177643
The generated pressure mean: 0.45526912808418274
loss_pred:0.06983683258295059, decouple_loss:0.04406818374991417
The generated pressure mean: 0.4540868401527405
loss_pred:0.0677524134516716, decouple_loss:0.04464209824800491
Iteration: 115, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46541258692741394
loss_pred:0.07251853495836258, decouple_loss:0.04234597831964493
The generated pressure mean: 0.4660140573978424
loss_pred:0.07181186228990555, decouple_loss:0.042909834533929825
The generated pressure mean: 0.4667564034461975
loss_pred:0.06906982511281967, decouple_loss:0.0419117733836174
Iteration: 116, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4513481557369232
The generated pressure mean: 0.4512595236301422
loss_pred:0.07036036998033524, decouple_loss:0.04300026223063469
loss_pred:0.07102254033088684, decouple_loss:0.04141099005937576
The generated pressure mean: 0.4516974687576294
loss_pred:0.06967197358608246, decouple_loss:0.04512879624962807
Iteration: 117, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4647185504436493
The generated pressure mean: 0.46494558453559875
loss_pred:0.07123783975839615, decouple_loss:0.040197424590587616
loss_pred:0.06977318227291107, decouple_loss:0.04175828397274017
The generated pressure mean: 0.46648454666137695
loss_pred:0.06975297629833221, decouple_loss:0.04060987010598183
Iteration: 118, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4608120918273926
loss_pred:0.06837072223424911, decouple_loss:0.039797183126211166
The generated pressure mean: 0.4618337154388428
loss_pred:0.07198092341423035, decouple_loss:0.04071793705224991
The generated pressure mean: 0.4643654227256775
loss_pred:0.0697910338640213, decouple_loss:0.04622005671262741
Iteration: 119, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4522128701210022
loss_pred:0.07039434462785721, decouple_loss:0.04021988809108734
The generated pressure mean: 0.452720582485199
loss_pred:0.07011609524488449, decouple_loss:0.043145209550857544
The generated pressure mean: 0.45155656337738037
loss_pred:0.07030835002660751, decouple_loss:0.04648052155971527
Iteration: 120, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4688445031642914
loss_pred:0.07114523649215698, decouple_loss:0.04117705672979355
The generated pressure mean: 0.46926525235176086
loss_pred:0.06769930571317673, decouple_loss:0.04069458693265915
The generated pressure mean: 0.4690343141555786
loss_pred:0.06753025949001312, decouple_loss:0.04147263243794441
2023-04-16 01:51:39 testing...
The generated pressure mean: 0.4095102548599243
loss_pred:0.07686978578567505, decouple_loss:0.04080500453710556
The generated pressure mean: 0.41021928191185
loss_pred:0.07569106668233871, decouple_loss:0.043075889348983765
The generated pressure mean: 0.410165011882782
loss_pred:0.07656692713499069, decouple_loss:0.04288140684366226
Loss: 0.07848863303661346, avg_mse: 0.07791752368211746
current test mse: 0.077918
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012007_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012007_3_24hr.npz
NaN value num: 0
Iteration: 121, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44900161027908325
loss_pred:0.06682471185922623, decouple_loss:0.04110317677259445
The generated pressure mean: 0.4468260109424591
loss_pred:0.06768796592950821, decouple_loss:0.04072417691349983
The generated pressure mean: 0.44828829169273376
loss_pred:0.06944895535707474, decouple_loss:0.040041111409664154
Iteration: 122, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4593634307384491
The generated pressure mean: 0.46006232500076294
loss_pred:0.07059765607118607, decouple_loss:0.039055235683918
loss_pred:0.07094276696443558, decouple_loss:0.03881654888391495
The generated pressure mean: 0.4632044732570648
loss_pred:0.06757257878780365, decouple_loss:0.0402328260242939
Iteration: 123, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4594593942165375
loss_pred:0.06629098951816559, decouple_loss:0.03928216174244881
The generated pressure mean: 0.4574195146560669
loss_pred:0.06750136613845825, decouple_loss:0.03831949084997177
The generated pressure mean: 0.4595387876033783
loss_pred:0.06625735014677048, decouple_loss:0.03837675228714943
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 124, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4453275799751282
The generated pressure mean: 0.44796472787857056
loss_pred:0.06762165576219559, decouple_loss:0.039418041706085205
loss_pred:0.06561222672462463, decouple_loss:0.0396558940410614
The generated pressure mean: 0.44756171107292175
loss_pred:0.0668153241276741, decouple_loss:0.03891781345009804
Iteration: 125, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4627877175807953
loss_pred:0.06560986489057541, decouple_loss:0.04062662273645401
The generated pressure mean: 0.46107131242752075
loss_pred:0.06764020025730133, decouple_loss:0.040429163724184036
The generated pressure mean: 0.4659883677959442
loss_pred:0.06618878990411758, decouple_loss:0.04002372920513153
Iteration: 126, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44946542382240295
loss_pred:0.06619318574666977, decouple_loss:0.04119006171822548
The generated pressure mean: 0.44885221123695374
loss_pred:0.06901401281356812, decouple_loss:0.03935850039124489
The generated pressure mean: 0.4511335790157318
loss_pred:0.06671512126922607, decouple_loss:0.039879199117422104
Iteration: 127, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46117791533470154
loss_pred:0.06855852156877518, decouple_loss:0.03955177590250969
The generated pressure mean: 0.46156835556030273
loss_pred:0.06748157739639282, decouple_loss:0.038958389312028885
The generated pressure mean: 0.459098219871521
loss_pred:0.06429106742143631, decouple_loss:0.03870163857936859
Iteration: 128, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4650896489620209
loss_pred:0.06783726811408997, decouple_loss:0.03857061639428139
The generated pressure mean: 0.4665023386478424
loss_pred:0.06516555696725845, decouple_loss:0.03979858011007309
The generated pressure mean: 0.46963736414909363
loss_pred:0.06622210890054703, decouple_loss:0.038549281656742096
Iteration: 129, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4467092454433441
loss_pred:0.06566685438156128, decouple_loss:0.041493009775877
The generated pressure mean: 0.44707736372947693
loss_pred:0.06633011251688004, decouple_loss:0.0407835952937603
The generated pressure mean: 0.44667530059814453
loss_pred:0.06585511565208435, decouple_loss:0.04123952239751816
Iteration: 130, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4714595079421997
loss_pred:0.06464948505163193, decouple_loss:0.03829525411128998
The generated pressure mean: 0.4693550765514374
loss_pred:0.06519751250743866, decouple_loss:0.03875885158777237
The generated pressure mean: 0.4690801203250885
loss_pred:0.06529326736927032, decouple_loss:0.039950210601091385
2023-04-16 01:54:15 testing...
The generated pressure mean: 0.4046168327331543
loss_pred:0.07515837997198105, decouple_loss:0.040755726397037506
The generated pressure mean: 0.40531474351882935
loss_pred:0.07394328713417053, decouple_loss:0.04348364099860191
The generated pressure mean: 0.4051036238670349
loss_pred:0.0746149942278862, decouple_loss:0.04448739439249039
Loss: 0.07671767473220825, avg_mse: 0.07592886686325073
current test mse: 0.075929
Iteration: 131, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4671194553375244
loss_pred:0.06452431529760361, decouple_loss:0.037902068346738815
The generated pressure mean: 0.46738436818122864
loss_pred:0.06464046239852905, decouple_loss:0.039333563297986984
The generated pressure mean: 0.46760258078575134
loss_pred:0.06707045435905457, decouple_loss:0.038923654705286026
Iteration: 132, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4519686698913574
loss_pred:0.06542286276817322, decouple_loss:0.03786080703139305
The generated pressure mean: 0.4513793885707855
loss_pred:0.06788171082735062, decouple_loss:0.03806092217564583
The generated pressure mean: 0.453210711479187
loss_pred:0.0651775673031807, decouple_loss:0.03662107139825821
Iteration: 133, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4626949727535248
loss_pred:0.06766221672296524, decouple_loss:0.03787124902009964
The generated pressure mean: 0.4651477634906769
loss_pred:0.06421962380409241, decouple_loss:0.03719528019428253
The generated pressure mean: 0.4632759690284729
loss_pred:0.06661389023065567, decouple_loss:0.03788551688194275
Iteration: 134, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45937350392341614
loss_pred:0.06530328094959259, decouple_loss:0.03661801666021347
The generated pressure mean: 0.4588727653026581
loss_pred:0.0641540139913559, decouple_loss:0.0390658862888813
The generated pressure mean: 0.4577774703502655
loss_pred:0.06680159270763397, decouple_loss:0.03680834174156189
Iteration: 135, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4518860876560211
loss_pred:0.06726958602666855, decouple_loss:0.03638511151075363
The generated pressure mean: 0.4514157176017761
loss_pred:0.0640919879078865, decouple_loss:0.0359712652862072
The generated pressure mean: 0.45093104243278503
loss_pred:0.0657787173986435, decouple_loss:0.035567548125982285
Iteration: 136, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4608463943004608
loss_pred:0.06707893311977386, decouple_loss:0.035605501383543015
The generated pressure mean: 0.46225735545158386
loss_pred:0.06401646137237549, decouple_loss:0.036182042211294174
The generated pressure mean: 0.4615713059902191
loss_pred:0.06607208400964737, decouple_loss:0.035181622952222824
Iteration: 137, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4588320255279541
The generated pressure mean: 0.4615769684314728
loss_pred:0.06617779284715652, decouple_loss:0.035999052226543427
loss_pred:0.06393463909626007, decouple_loss:0.03818938881158829
The generated pressure mean: 0.4595741629600525
loss_pred:0.0641319528222084, decouple_loss:0.037170473486185074
Iteration: 138, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4509093463420868
loss_pred:0.06838343292474747, decouple_loss:0.03557642549276352
The generated pressure mean: 0.45113393664360046
loss_pred:0.06555211544036865, decouple_loss:0.03630338981747627
The generated pressure mean: 0.4501286447048187
loss_pred:0.06658010929822922, decouple_loss:0.03585851937532425
Iteration: 139, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4550219178199768
The generated pressure mean: 0.4543091058731079
loss_pred:0.06366138905286789, decouple_loss:0.036159154027700424
loss_pred:0.06319917738437653, decouple_loss:0.033741626888513565
The generated pressure mean: 0.4518476724624634
loss_pred:0.06233814358711243, decouple_loss:0.03440279886126518
Iteration: 140, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46188050508499146
loss_pred:0.06406253576278687, decouple_loss:0.034239910542964935
The generated pressure mean: 0.4621489346027374
loss_pred:0.0645795613527298, decouple_loss:0.034786056727170944
The generated pressure mean: 0.4607463479042053
loss_pred:0.06351692229509354, decouple_loss:0.034898463636636734
2023-04-16 01:56:16 testing...
The generated pressure mean: 0.4067593216896057
loss_pred:0.07253333926200867, decouple_loss:0.03473234549164772
The generated pressure mean: 0.40722379088401794
loss_pred:0.07191519439220428, decouple_loss:0.037357136607170105
The generated pressure mean: 0.4069392681121826
loss_pred:0.07242867350578308, decouple_loss:0.0385875478386879
Loss: 0.07413702458143234, avg_mse: 0.07329928129911423
current test mse: 0.073299
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012000_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012000_3_24hr.npz
NaN value num: 0
Iteration: 141, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45745038986206055
loss_pred:0.0669899731874466, decouple_loss:0.03308742865920067
The generated pressure mean: 0.4568485915660858
loss_pred:0.06288667023181915, decouple_loss:0.03225568309426308
The generated pressure mean: 0.45820489525794983
loss_pred:0.0650571882724762, decouple_loss:0.03327866643667221
Iteration: 142, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4572010636329651
loss_pred:0.06343431770801544, decouple_loss:0.034735530614852905
The generated pressure mean: 0.45613279938697815
loss_pred:0.06634809076786041, decouple_loss:0.03551146015524864
The generated pressure mean: 0.4560483992099762
loss_pred:0.06652852892875671, decouple_loss:0.03505870699882507
Iteration: 143, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45721715688705444
loss_pred:0.06141335144639015, decouple_loss:0.03073367103934288
The generated pressure mean: 0.4592137038707733
loss_pred:0.06106771156191826, decouple_loss:0.03231772780418396
The generated pressure mean: 0.46022549271583557
loss_pred:0.06067972630262375, decouple_loss:0.03087419643998146
Iteration: 144, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4522094428539276
loss_pred:0.06765036284923553, decouple_loss:0.03312405198812485
The generated pressure mean: 0.45042455196380615
loss_pred:0.0613313764333725, decouple_loss:0.034799665212631226
The generated pressure mean: 0.4526798129081726
loss_pred:0.0625113993883133, decouple_loss:0.03461951017379761
Iteration: 145, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4602471888065338
loss_pred:0.06389627605676651, decouple_loss:0.03254370763897896
The generated pressure mean: 0.4606750011444092
loss_pred:0.0635262057185173, decouple_loss:0.03289789706468582
The generated pressure mean: 0.459368497133255
loss_pred:0.06387975811958313, decouple_loss:0.03283286839723587
Iteration: 146, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45692238211631775
loss_pred:0.060946326702833176, decouple_loss:0.030208442360162735
The generated pressure mean: 0.4588160216808319
loss_pred:0.06281442940235138, decouple_loss:0.03094259649515152
The generated pressure mean: 0.4578930735588074
loss_pred:0.06166365370154381, decouple_loss:0.031518153846263885
Iteration: 147, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4448212683200836
loss_pred:0.06740444153547287, decouple_loss:0.03753439337015152
The generated pressure mean: 0.4443380832672119
loss_pred:0.06601070612668991, decouple_loss:0.03636394441127777
The generated pressure mean: 0.44475728273391724
loss_pred:0.06622404605150223, decouple_loss:0.03684861585497856
Iteration: 148, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45446279644966125
loss_pred:0.06014152988791466, decouple_loss:0.02909843623638153
The generated pressure mean: 0.4535592496395111
loss_pred:0.06138993054628372, decouple_loss:0.029642712324857712
The generated pressure mean: 0.45399564504623413
loss_pred:0.06275898218154907, decouple_loss:0.029748499393463135
Iteration: 149, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4633806347846985
loss_pred:0.06415052711963654, decouple_loss:0.03486961871385574
The generated pressure mean: 0.4629193842411041
loss_pred:0.06461354345083237, decouple_loss:0.03437497094273567
The generated pressure mean: 0.463894248008728
loss_pred:0.06312115490436554, decouple_loss:0.034442294389009476
Iteration: 150, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45567435026168823
loss_pred:0.06264953315258026, decouple_loss:0.03200780600309372
The generated pressure mean: 0.453093945980072
loss_pred:0.061048418283462524, decouple_loss:0.0317867286503315
The generated pressure mean: 0.453253835439682
loss_pred:0.06586005538702011, decouple_loss:0.03272205963730812
2023-04-16 01:58:50 testing...
The generated pressure mean: 0.4076552093029022
loss_pred:0.07055121660232544, decouple_loss:0.0326443575322628
The generated pressure mean: 0.40783020853996277
loss_pred:0.07025949656963348, decouple_loss:0.03452952578663826
The generated pressure mean: 0.40746766328811646
loss_pred:0.07077326625585556, decouple_loss:0.03533273935317993
Loss: 0.07223644107580185, avg_mse: 0.07125861942768097
current test mse: 0.071259
Iteration: 151, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45372629165649414
loss_pred:0.06398062407970428, decouple_loss:0.031373847275972366
The generated pressure mean: 0.4528394043445587
loss_pred:0.05994280055165291, decouple_loss:0.03141484409570694
The generated pressure mean: 0.4548107981681824
loss_pred:0.06034291535615921, decouple_loss:0.0305790938436985
Iteration: 152, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.455700546503067
loss_pred:0.06265457719564438, decouple_loss:0.0327230766415596
The generated pressure mean: 0.4547085762023926
loss_pred:0.06129484623670578, decouple_loss:0.032034844160079956
The generated pressure mean: 0.45456835627555847
loss_pred:0.06514454632997513, decouple_loss:0.03288402408361435
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 153, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45357510447502136
loss_pred:0.06292234361171722, decouple_loss:0.03012443520128727
The generated pressure mean: 0.4532288610935211
loss_pred:0.0657099261879921, decouple_loss:0.030274739488959312
The generated pressure mean: 0.4513603448867798
loss_pred:0.06179484352469444, decouple_loss:0.030073506757616997
Iteration: 154, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4574614465236664
loss_pred:0.06779913604259491, decouple_loss:0.029603224247694016
The generated pressure mean: 0.45736488699913025
loss_pred:0.06643838435411453, decouple_loss:0.031403206288814545
The generated pressure mean: 0.45862793922424316
loss_pred:0.06349542737007141, decouple_loss:0.030541064217686653
Iteration: 155, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4597512185573578
loss_pred:0.06268192827701569, decouple_loss:0.030725907534360886
The generated pressure mean: 0.4600502550601959
loss_pred:0.0661243125796318, decouple_loss:0.031482044607400894
The generated pressure mean: 0.4608546793460846
loss_pred:0.06281022727489471, decouple_loss:0.030130872502923012
Iteration: 156, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4561542570590973
loss_pred:0.05898966267704964, decouple_loss:0.03077259659767151
The generated pressure mean: 0.45547521114349365
loss_pred:0.0610416904091835, decouple_loss:0.029474440962076187
The generated pressure mean: 0.45636045932769775
loss_pred:0.062118254601955414, decouple_loss:0.029232336208224297
Iteration: 157, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45360150933265686
loss_pred:0.06383264064788818, decouple_loss:0.032257743179798126
The generated pressure mean: 0.4523164629936218
loss_pred:0.06560077518224716, decouple_loss:0.030360843986272812
The generated pressure mean: 0.4540240168571472
loss_pred:0.06124754622578621, decouple_loss:0.03038993664085865
Iteration: 158, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4552537500858307
The generated pressure mean: 0.45499181747436523loss_pred:0.06323976069688797, decouple_loss:0.02914217673242092
loss_pred:0.06016358360648155, decouple_loss:0.029840901494026184
The generated pressure mean: 0.4555653929710388
loss_pred:0.06476832181215286, decouple_loss:0.029546450823545456
Iteration: 159, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.455682635307312
loss_pred:0.06594040989875793, decouple_loss:0.031232420355081558
The generated pressure mean: 0.45630812644958496
loss_pred:0.06174895912408829, decouple_loss:0.0303425882011652
The generated pressure mean: 0.4567330777645111
loss_pred:0.06316091120243073, decouple_loss:0.029320478439331055
Iteration: 160, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45419517159461975
loss_pred:0.06421176344156265, decouple_loss:0.028335049748420715
The generated pressure mean: 0.456632524728775
loss_pred:0.0577317550778389, decouple_loss:0.0269615538418293
The generated pressure mean: 0.454146146774292
loss_pred:0.05935483053326607, decouple_loss:0.028333093971014023
2023-04-16 02:00:51 testing...
The generated pressure mean: 0.40716224908828735
loss_pred:0.06945838034152985, decouple_loss:0.031117534264922142
The generated pressure mean: 0.40717795491218567
loss_pred:0.06938561052083969, decouple_loss:0.03310537710785866
The generated pressure mean: 0.4068491756916046
loss_pred:0.06997451931238174, decouple_loss:0.03370172157883644
Loss: 0.07123824208974838, avg_mse: 0.07036115974187851
current test mse: 0.070361
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012004_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012004_3_24hr.npz
NaN value num: 0
Iteration: 161, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4554091691970825
loss_pred:0.06467290222644806, decouple_loss:0.037415988743305206
The generated pressure mean: 0.45556196570396423
loss_pred:0.06338417530059814, decouple_loss:0.03131011873483658
The generated pressure mean: 0.4582989811897278
loss_pred:0.06566528230905533, decouple_loss:0.02968488447368145
Iteration: 162, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4586643874645233
loss_pred:0.06460264325141907, decouple_loss:0.030118582770228386
The generated pressure mean: 0.4594331681728363
loss_pred:0.06292056292295456, decouple_loss:0.03126627579331398
The generated pressure mean: 0.46057191491127014
loss_pred:0.06303786486387253, decouple_loss:0.036230213940143585
Iteration: 163, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45707786083221436
loss_pred:0.060230184346437454, decouple_loss:0.03458689898252487
The generated pressure mean: 0.45567622780799866
loss_pred:0.06335511058568954, decouple_loss:0.03243766352534294
The generated pressure mean: 0.4541544020175934
loss_pred:0.06259692460298538, decouple_loss:0.033486150205135345
Iteration: 164, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45030027627944946
loss_pred:0.06032901629805565, decouple_loss:0.03043304570019245
The generated pressure mean: 0.44972681999206543
loss_pred:0.06141065061092377, decouple_loss:0.02820468880236149
The generated pressure mean: 0.4505188763141632
loss_pred:0.06167605519294739, decouple_loss:0.028224030509591103
Iteration: 165, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4473406970500946
loss_pred:0.0596904419362545, decouple_loss:0.030879219993948936
The generated pressure mean: 0.44546839594841003
loss_pred:0.06273973733186722, decouple_loss:0.033466365188360214
The generated pressure mean: 0.44639337062835693
loss_pred:0.06010806933045387, decouple_loss:0.03046581521630287
Iteration: 166, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4495822787284851
loss_pred:0.06090424209833145, decouple_loss:0.02940751612186432
The generated pressure mean: 0.44989296793937683
loss_pred:0.05816204845905304, decouple_loss:0.03003808669745922
The generated pressure mean: 0.449556827545166
loss_pred:0.06141906976699829, decouple_loss:0.02960633859038353
Iteration: 167, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4529343247413635
loss_pred:0.06083275377750397, decouple_loss:0.02826448529958725
The generated pressure mean: 0.4528696835041046
loss_pred:0.06207118555903435, decouple_loss:0.03043810836970806
The generated pressure mean: 0.4521765112876892
loss_pred:0.061690185219049454, decouple_loss:0.02852794900536537
Iteration: 168, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.454287588596344
loss_pred:0.06095367297530174, decouple_loss:0.029303116723895073
The generated pressure mean: 0.45368319749832153
loss_pred:0.06193877011537552, decouple_loss:0.02692228928208351
The generated pressure mean: 0.4555007219314575
loss_pred:0.06032069772481918, decouple_loss:0.028241872787475586
Iteration: 169, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45115458965301514
loss_pred:0.05932899937033653, decouple_loss:0.026519957929849625
The generated pressure mean: 0.4522530138492584
loss_pred:0.05967298522591591, decouple_loss:0.027968870475888252
The generated pressure mean: 0.45166248083114624
loss_pred:0.05878864973783493, decouple_loss:0.02848563902080059
Iteration: 170, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45415717363357544
loss_pred:0.061167534440755844, decouple_loss:0.03125649318099022
The generated pressure mean: 0.45167216658592224
loss_pred:0.05964979901909828, decouple_loss:0.026247940957546234
The generated pressure mean: 0.4542485177516937
loss_pred:0.060425836592912674, decouple_loss:0.02799047715961933
2023-04-16 02:03:30 testing...
The generated pressure mean: 0.4075774848461151
loss_pred:0.06775418668985367, decouple_loss:0.026958826929330826
The generated pressure mean: 0.40762922167778015
loss_pred:0.06790246814489365, decouple_loss:0.027998149394989014
The generated pressure mean: 0.4072858691215515
loss_pred:0.0685773566365242, decouple_loss:0.030533216893672943
Loss: 0.06950284540653229, avg_mse: 0.06872811168432236
current test mse: 0.068728
Iteration: 171, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45564624667167664
loss_pred:0.05858682096004486, decouple_loss:0.02766597457230091
The generated pressure mean: 0.458610475063324
loss_pred:0.0612536258995533, decouple_loss:0.025860846042633057
The generated pressure mean: 0.45592594146728516
loss_pred:0.05756397545337677, decouple_loss:0.02755717933177948
Iteration: 172, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45649150013923645
loss_pred:0.06251315027475357, decouple_loss:0.025421245023608208
The generated pressure mean: 0.4584094285964966
loss_pred:0.060434747487306595, decouple_loss:0.02580917812883854The generated pressure mean: 0.4568398892879486
loss_pred:0.06169251352548599, decouple_loss:0.027013499289751053
Iteration: 173, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45597928762435913
loss_pred:0.06319303810596466, decouple_loss:0.024561602622270584
The generated pressure mean: 0.45206668972969055
loss_pred:0.06219906359910965, decouple_loss:0.027118202298879623
The generated pressure mean: 0.4543616771697998
loss_pred:0.058219317346811295, decouple_loss:0.024507028982043266
Iteration: 174, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45016565918922424
loss_pred:0.05964028835296631, decouple_loss:0.025792479515075684
The generated pressure mean: 0.4501380920410156
loss_pred:0.059316057711839676, decouple_loss:0.02468421496450901
The generated pressure mean: 0.4508468210697174
loss_pred:0.058461032807826996, decouple_loss:0.0294055063277483
Iteration: 175, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4485812485218048
loss_pred:0.06407584249973297, decouple_loss:0.02518819086253643
The generated pressure mean: 0.4491148889064789
loss_pred:0.05693698301911354, decouple_loss:0.025104807689785957
The generated pressure mean: 0.44947800040245056
loss_pred:0.05878651514649391, decouple_loss:0.02646678313612938
Iteration: 176, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45115458965301514
loss_pred:0.06348695605993271, decouple_loss:0.026564180850982666
The generated pressure mean: 0.4506306052207947
loss_pred:0.05984187871217728, decouple_loss:0.023554837331175804
The generated pressure mean: 0.4511888921260834
loss_pred:0.05829961225390434, decouple_loss:0.023196561262011528
Iteration: 177, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44915202260017395
loss_pred:0.05593942478299141, decouple_loss:0.024305766448378563
The generated pressure mean: 0.4508640468120575
loss_pred:0.0600537545979023, decouple_loss:0.027616094797849655
The generated pressure mean: 0.44681477546691895
loss_pred:0.058045078068971634, decouple_loss:0.02363503910601139
Iteration: 178, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4484768211841583
loss_pred:0.06160804629325867, decouple_loss:0.025883924216032028
The generated pressure mean: 0.4471970796585083
loss_pred:0.06110373139381409, decouple_loss:0.024786455556750298
The generated pressure mean: 0.4495105743408203
loss_pred:0.06351169943809509, decouple_loss:0.024984290823340416
Iteration: 179, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4475671052932739
loss_pred:0.057251572608947754, decouple_loss:0.025973651558160782
The generated pressure mean: 0.44692206382751465
loss_pred:0.060062579810619354, decouple_loss:0.027796383947134018
The generated pressure mean: 0.44527655839920044
loss_pred:0.061059433966875076, decouple_loss:0.025383586063981056
Iteration: 180, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45099496841430664
loss_pred:0.05936114490032196, decouple_loss:0.02564896270632744
The generated pressure mean: 0.44796022772789
loss_pred:0.05655703693628311, decouple_loss:0.024697812274098396
The generated pressure mean: 0.4518848657608032
loss_pred:0.05909266695380211, decouple_loss:0.02425771951675415
2023-04-16 02:05:31 testing...
The generated pressure mean: 0.40847349166870117
loss_pred:0.0674937441945076, decouple_loss:0.02738083526492119
The generated pressure mean: 0.4083307087421417
loss_pred:0.06698979437351227, decouple_loss:0.02823810838162899
The generated pressure mean: 0.40804797410964966
loss_pred:0.06769711524248123, decouple_loss:0.02917821705341339
Loss: 0.06880684196949005, avg_mse: 0.06789602339267731
current test mse: 0.067896
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012001_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012001_3_24hr.npz
NaN value num: 0
Iteration: 181, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45071613788604736
loss_pred:0.05787510424852371, decouple_loss:0.026723375543951988
The generated pressure mean: 0.4506283700466156
loss_pred:0.06672927737236023, decouple_loss:0.026377709582448006
The generated pressure mean: 0.4495946764945984
loss_pred:0.061801277101039886, decouple_loss:0.02835092879831791
Iteration: 182, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4433891773223877
loss_pred:0.06135382503271103, decouple_loss:0.02310730144381523
The generated pressure mean: 0.44515761733055115
loss_pred:0.056752100586891174, decouple_loss:0.024286441504955292
The generated pressure mean: 0.4437204599380493
loss_pred:0.06176513060927391, decouple_loss:0.02339106798171997
Iteration: 183, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44099923968315125
loss_pred:0.06186344847083092, decouple_loss:0.028630012646317482
The generated pressure mean: 0.4430049955844879
The generated pressure mean: 0.44172585010528564loss_pred:0.06175495311617851, decouple_loss:0.02593398466706276
loss_pred:0.05564537271857262, decouple_loss:0.02624400518834591
Iteration: 184, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4411680996417999
loss_pred:0.060379840433597565, decouple_loss:0.024603333324193954
The generated pressure mean: 0.442308634519577
loss_pred:0.05904879420995712, decouple_loss:0.026090653613209724
The generated pressure mean: 0.4422152638435364
loss_pred:0.056665077805519104, decouple_loss:0.02555416338145733
Iteration: 185, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4483312666416168
loss_pred:0.06083038076758385, decouple_loss:0.02508155256509781
The generated pressure mean: 0.449392169713974
loss_pred:0.055122241377830505, decouple_loss:0.024999214336276054
The generated pressure mean: 0.4499647617340088
loss_pred:0.061220183968544006, decouple_loss:0.02817339263856411
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 186, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4580939710140228
loss_pred:0.05988016352057457, decouple_loss:0.02351786196231842
The generated pressure mean: 0.45710861682891846
loss_pred:0.05646643415093422, decouple_loss:0.024071350693702698
The generated pressure mean: 0.45611172914505005
loss_pred:0.060766782611608505, decouple_loss:0.023851286619901657
Iteration: 187, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4584568738937378
loss_pred:0.06092075631022453, decouple_loss:0.027280477806925774
The generated pressure mean: 0.45906490087509155
loss_pred:0.05872536078095436, decouple_loss:0.02652222476899624
The generated pressure mean: 0.4586389660835266
loss_pred:0.057805899530649185, decouple_loss:0.026148632168769836
Iteration: 188, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45586198568344116
loss_pred:0.055326830595731735, decouple_loss:0.025233633816242218
The generated pressure mean: 0.4554089605808258
loss_pred:0.06229913979768753, decouple_loss:0.02599942870438099
The generated pressure mean: 0.45336946845054626
loss_pred:0.05847032368183136, decouple_loss:0.025011267513036728
Iteration: 189, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44626954197883606
loss_pred:0.05942166596651077, decouple_loss:0.025371119379997253
The generated pressure mean: 0.44603830575942993
loss_pred:0.061689529567956924, decouple_loss:0.024908026680350304
The generated pressure mean: 0.44559571146965027
loss_pred:0.06039538234472275, decouple_loss:0.024684078991413116
Iteration: 190, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44595515727996826
loss_pred:0.05956600233912468, decouple_loss:0.024658842012286186
The generated pressure mean: 0.44637537002563477
loss_pred:0.05710276961326599, decouple_loss:0.023883169516921043
The generated pressure mean: 0.4463239014148712
loss_pred:0.05814068019390106, decouple_loss:0.02588745206594467
2023-04-16 02:08:06 testing...
The generated pressure mean: 0.40733298659324646
loss_pred:0.06654427945613861, decouple_loss:0.023333104327321053
The generated pressure mean: 0.40697699785232544
loss_pred:0.06682456284761429, decouple_loss:0.025025827810168266
The generated pressure mean: 0.4066479206085205
loss_pred:0.0671158879995346, decouple_loss:0.026083318516612053
Loss: 0.06806895136833191, avg_mse: 0.06772980093955994
current test mse: 0.06773
Iteration: 191, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4525001049041748
loss_pred:0.058449458330869675, decouple_loss:0.022739693522453308
The generated pressure mean: 0.4503949284553528
loss_pred:0.05759241059422493, decouple_loss:0.022903000935912132
The generated pressure mean: 0.4531335234642029
loss_pred:0.05739426985383034, decouple_loss:0.02232334576547146
Iteration: 192, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4524684250354767
loss_pred:0.05937035009264946, decouple_loss:0.024878179654479027
The generated pressure mean: 0.4527149200439453
The generated pressure mean: 0.4521089494228363
loss_pred:0.06238074600696564, decouple_loss:0.025085289031267166
loss_pred:0.06247589737176895, decouple_loss:0.026301860809326172
Iteration: 193, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4483085572719574
loss_pred:0.05448763445019722, decouple_loss:0.022555867210030556
The generated pressure mean: 0.4484734535217285
loss_pred:0.06315074861049652, decouple_loss:0.026222296059131622
The generated pressure mean: 0.4487711191177368
loss_pred:0.05669688433408737, decouple_loss:0.022557798773050308
Iteration: 194, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4472961127758026
loss_pred:0.05904277414083481, decouple_loss:0.02310195378959179
The generated pressure mean: 0.44800427556037903
loss_pred:0.05774027854204178, decouple_loss:0.023608751595020294
The generated pressure mean: 0.44855228066444397
loss_pred:0.05701839551329613, decouple_loss:0.023496216163039207
Iteration: 195, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44749167561531067
loss_pred:0.06042495742440224, decouple_loss:0.027815349400043488
The generated pressure mean: 0.44617509841918945
loss_pred:0.057497087866067886, decouple_loss:0.02563518099486828
The generated pressure mean: 0.445354700088501
loss_pred:0.055635735392570496, decouple_loss:0.025183070451021194
Iteration: 196, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4453144967556
loss_pred:0.056639332324266434, decouple_loss:0.022966379299759865
The generated pressure mean: 0.44462060928344727
loss_pred:0.056909654289484024, decouple_loss:0.02374381385743618
The generated pressure mean: 0.44531410932540894
loss_pred:0.05463917553424835, decouple_loss:0.02379065752029419
Iteration: 197, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4475092887878418
loss_pred:0.060515403747558594, decouple_loss:0.022649506106972694
The generated pressure mean: 0.4496118724346161
loss_pred:0.05636032670736313, decouple_loss:0.02452988177537918
The generated pressure mean: 0.4506012201309204
loss_pred:0.062175679951906204, decouple_loss:0.023271478712558746
Iteration: 198, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44698992371559143
loss_pred:0.0583244226872921, decouple_loss:0.029686804860830307
The generated pressure mean: 0.4464157521724701
loss_pred:0.05369030311703682, decouple_loss:0.02920513041317463
The generated pressure mean: 0.4476265609264374
loss_pred:0.05716255307197571, decouple_loss:0.028332538902759552
Iteration: 199, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.445276141166687
loss_pred:0.0572131872177124, decouple_loss:0.024558989331126213
The generated pressure mean: 0.44487515091896057
loss_pred:0.0622381828725338, decouple_loss:0.023983025923371315
The generated pressure mean: 0.4444562792778015
loss_pred:0.057000644505023956, decouple_loss:0.02399934083223343
Iteration: 200, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4473063051700592
loss_pred:0.058948319405317307, decouple_loss:0.02558925189077854
The generated pressure mean: 0.44787612557411194
loss_pred:0.05580878630280495, decouple_loss:0.023589001968503
The generated pressure mean: 0.44748738408088684
loss_pred:0.05623946711421013, decouple_loss:0.024060141295194626
2023-04-16 02:10:06 testing...
The generated pressure mean: 0.4068191945552826
loss_pred:0.06543734669685364, decouple_loss:0.026829130947589874
The generated pressure mean: 0.40625330805778503
loss_pred:0.06588828563690186, decouple_loss:0.028671232983469963
The generated pressure mean: 0.40604692697525024
loss_pred:0.06589393317699432, decouple_loss:0.029653966426849365
Loss: 0.06715908646583557, avg_mse: 0.06640603393316269
current test mse: 0.066406
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012019_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012019_3_24hr.npz
NaN value num: 0
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 201, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4553484618663788
loss_pred:0.05995951220393181, decouple_loss:0.02667148783802986
The generated pressure mean: 0.45518922805786133
loss_pred:0.05785077437758446, decouple_loss:0.027618249878287315
The generated pressure mean: 0.4554362893104553
loss_pred:0.057398296892642975, decouple_loss:0.02629905752837658
Iteration: 202, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45915544033050537
loss_pred:0.059186313301324844, decouple_loss:0.02365235984325409
The generated pressure mean: 0.4598814845085144
loss_pred:0.05709265172481537, decouple_loss:0.024598712101578712
The generated pressure mean: 0.4584880769252777
loss_pred:0.05862874910235405, decouple_loss:0.024011481553316116
Iteration: 203, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4571438431739807
loss_pred:0.05939323827624321, decouple_loss:0.023633580654859543
The generated pressure mean: 0.45682215690612793
loss_pred:0.056913040578365326, decouple_loss:0.024141957983374596
The generated pressure mean: 0.45689526200294495
loss_pred:0.0585109144449234, decouple_loss:0.026119831949472427
Iteration: 204, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4524509608745575
loss_pred:0.058857426047325134, decouple_loss:0.022108612582087517
The generated pressure mean: 0.4517722427845001
loss_pred:0.0590873584151268, decouple_loss:0.02482951432466507
The generated pressure mean: 0.45115914940834045
loss_pred:0.06002344563603401, decouple_loss:0.024894054979085922
Iteration: 205, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4525262713432312
loss_pred:0.05643024295568466, decouple_loss:0.0210710559040308
The generated pressure mean: 0.45240113139152527
loss_pred:0.0580306313931942, decouple_loss:0.021882489323616028
The generated pressure mean: 0.45218324661254883
loss_pred:0.05938281491398811, decouple_loss:0.022600626572966576
Iteration: 206, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45423412322998047
loss_pred:0.059231556951999664, decouple_loss:0.024589192122220993
The generated pressure mean: 0.454667329788208
loss_pred:0.060721177607774734, decouple_loss:0.027341529726982117
The generated pressure mean: 0.45375651121139526
loss_pred:0.059187449514865875, decouple_loss:0.023629076778888702
Iteration: 207, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4517889618873596
loss_pred:0.05654830485582352, decouple_loss:0.023206349462270737
The generated pressure mean: 0.45183709263801575
loss_pred:0.05672391876578331, decouple_loss:0.025374680757522583
The generated pressure mean: 0.4511864483356476
loss_pred:0.056287191808223724, decouple_loss:0.024894634261727333
Iteration: 208, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4496084749698639
loss_pred:0.05869784206151962, decouple_loss:0.02723078615963459
The generated pressure mean: 0.4493238627910614
loss_pred:0.059093791991472244, decouple_loss:0.025201376527547836
The generated pressure mean: 0.4497813284397125
loss_pred:0.05844921991229057, decouple_loss:0.025709252804517746
Iteration: 209, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44632068276405334
loss_pred:0.057899702340364456, decouple_loss:0.025896605104207993
The generated pressure mean: 0.44815969467163086
loss_pred:0.058223191648721695, decouple_loss:0.02668270654976368
The generated pressure mean: 0.4460183382034302
loss_pred:0.05812684819102287, decouple_loss:0.026184044778347015
Iteration: 210, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44656994938850403
loss_pred:0.0558505542576313, decouple_loss:0.02283625304698944
The generated pressure mean: 0.44685983657836914
loss_pred:0.055730972439050674, decouple_loss:0.02352958545088768
The generated pressure mean: 0.44635188579559326
loss_pred:0.05573585256934166, decouple_loss:0.02312125824391842
2023-04-16 02:12:48 testing...
The generated pressure mean: 0.40783658623695374
loss_pred:0.06453684717416763, decouple_loss:0.024715200066566467
The generated pressure mean: 0.4072936475276947
loss_pred:0.0645807757973671, decouple_loss:0.02668100595474243
The generated pressure mean: 0.40714868903160095
loss_pred:0.06489098072052002, decouple_loss:0.027538197115063667
Loss: 0.06598511338233948, avg_mse: 0.06532550603151321
current test mse: 0.065326
Iteration: 211, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44961991906166077
The generated pressure mean: 0.44951504468917847
loss_pred:0.05544489622116089, decouple_loss:0.024591464549303055
loss_pred:0.05675991252064705, decouple_loss:0.02460048533976078
The generated pressure mean: 0.4490889012813568
loss_pred:0.05724795535206795, decouple_loss:0.023636266589164734
Iteration: 212, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44945430755615234
The generated pressure mean: 0.44965237379074097
loss_pred:0.05515575781464577, decouple_loss:0.02251419983804226
loss_pred:0.05342886224389076, decouple_loss:0.02222541533410549
The generated pressure mean: 0.4500560760498047
loss_pred:0.055083710700273514, decouple_loss:0.02256430871784687
Iteration: 213, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4520394206047058
loss_pred:0.05745324864983559, decouple_loss:0.023143623024225235
The generated pressure mean: 0.450690895318985
loss_pred:0.05924876779317856, decouple_loss:0.025783931836485863
The generated pressure mean: 0.4518243670463562
loss_pred:0.05491442605853081, decouple_loss:0.02311306819319725
Iteration: 214, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44656699895858765
loss_pred:0.05438612401485443, decouple_loss:0.021988824009895325
The generated pressure mean: 0.44509178400039673
loss_pred:0.057901982218027115, decouple_loss:0.022953040897846222
The generated pressure mean: 0.4460902214050293
loss_pred:0.054575420916080475, decouple_loss:0.02194397710263729
Iteration: 215, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44981804490089417
loss_pred:0.05467809736728668, decouple_loss:0.021818511188030243
The generated pressure mean: 0.4485640227794647
loss_pred:0.054955415427684784, decouple_loss:0.021784454584121704
The generated pressure mean: 0.44906389713287354
loss_pred:0.05819064378738403, decouple_loss:0.022280870005488396
Iteration: 216, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4502760171890259
loss_pred:0.05226471647620201, decouple_loss:0.021183399483561516
The generated pressure mean: 0.4496437907218933
loss_pred:0.05436614528298378, decouple_loss:0.02132626809179783
The generated pressure mean: 0.45104578137397766
loss_pred:0.054562292993068695, decouple_loss:0.02099565602838993
Iteration: 217, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4507921040058136
loss_pred:0.056491173803806305, decouple_loss:0.01956741325557232
The generated pressure mean: 0.4484506845474243
loss_pred:0.057024966925382614, decouple_loss:0.020456967875361443
The generated pressure mean: 0.4488379955291748
loss_pred:0.05630574747920036, decouple_loss:0.020649554207921028
Iteration: 218, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44989150762557983
loss_pred:0.05649276450276375, decouple_loss:0.0240155216306448
The generated pressure mean: 0.4496307373046875
loss_pred:0.05757381021976471, decouple_loss:0.0213009063154459
The generated pressure mean: 0.4504988491535187
loss_pred:0.05426442623138428, decouple_loss:0.022420477122068405
Iteration: 219, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4518401324748993
loss_pred:0.052703142166137695, decouple_loss:0.018439706414937973
The generated pressure mean: 0.4511706233024597
loss_pred:0.053631141781806946, decouple_loss:0.02108222246170044
The generated pressure mean: 0.45057395100593567
loss_pred:0.059214551001787186, decouple_loss:0.019476324319839478
Iteration: 220, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45062342286109924
loss_pred:0.055680010467767715, decouple_loss:0.019471392035484314
The generated pressure mean: 0.4512038826942444
loss_pred:0.056402452290058136, decouple_loss:0.020107857882976532
The generated pressure mean: 0.4509538412094116
loss_pred:0.05725705623626709, decouple_loss:0.019991734996438026
2023-04-16 02:14:49 testing...
The generated pressure mean: 0.40719130635261536
loss_pred:0.06417101621627808, decouple_loss:0.022249527275562286
The generated pressure mean: 0.4067023992538452
loss_pred:0.06385347247123718, decouple_loss:0.024687670171260834
The generated pressure mean: 0.40660232305526733
loss_pred:0.06419023871421814, decouple_loss:0.026226576417684555
Loss: 0.06529097259044647, avg_mse: 0.06496118009090424
current test mse: 0.064961
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012011_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012011_3_24hr.npz
NaN value num: 0
Iteration: 221, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44817015528678894
loss_pred:0.05939025059342384, decouple_loss:0.021518126130104065
The generated pressure mean: 0.4506957232952118
loss_pred:0.0580635741353035, decouple_loss:0.021433088928461075
The generated pressure mean: 0.4498658776283264
loss_pred:0.054479315876960754, decouple_loss:0.020795166492462158
Iteration: 222, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4488086998462677
loss_pred:0.058340899646282196, decouple_loss:0.021338948979973793
The generated pressure mean: 0.44968175888061523
loss_pred:0.05788851156830788, decouple_loss:0.018224306404590607
The generated pressure mean: 0.44939708709716797
loss_pred:0.05660301074385643, decouple_loss:0.018993334844708443
Iteration: 223, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4445871114730835
loss_pred:0.05702051892876625, decouple_loss:0.01961723156273365
The generated pressure mean: 0.44545263051986694
loss_pred:0.05659450590610504, decouple_loss:0.021739274263381958
The generated pressure mean: 0.44587308168411255
loss_pred:0.05759216845035553, decouple_loss:0.021411096677184105
Iteration: 224, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4456024467945099
loss_pred:0.05821305140852928, decouple_loss:0.0217888243496418
The generated pressure mean: 0.4455677270889282
loss_pred:0.05981380492448807, decouple_loss:0.020893478766083717
The generated pressure mean: 0.4455885589122772
loss_pred:0.058005593717098236, decouple_loss:0.022583110257983208
Iteration: 225, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44128891825675964
The generated pressure mean: 0.4394646883010864
loss_pred:0.055930737406015396, decouple_loss:0.02158268168568611
loss_pred:0.057976823300123215, decouple_loss:0.022416992112994194
The generated pressure mean: 0.4412444233894348
loss_pred:0.05488033965229988, decouple_loss:0.02296105958521366
Iteration: 226, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4392164945602417
loss_pred:0.05701152980327606, decouple_loss:0.022443627938628197
The generated pressure mean: 0.43707969784736633
loss_pred:0.05771729722619057, decouple_loss:0.027001749724149704
The generated pressure mean: 0.43624091148376465
loss_pred:0.0566343329846859, decouple_loss:0.02221391722559929
Iteration: 227, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44523364305496216
loss_pred:0.056838762015104294, decouple_loss:0.024577626958489418
The generated pressure mean: 0.44649291038513184
loss_pred:0.05655444785952568, decouple_loss:0.02461734227836132
The generated pressure mean: 0.446983277797699
loss_pred:0.0581437312066555, decouple_loss:0.023731067776679993
Iteration: 228, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45009326934814453
The generated pressure mean: 0.4512925446033478
loss_pred:0.05473046004772186, decouple_loss:0.022527161985635757
loss_pred:0.05633420869708061, decouple_loss:0.020275970920920372
The generated pressure mean: 0.4500632584095001
loss_pred:0.05682312697172165, decouple_loss:0.02111240103840828
Iteration: 229, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44960805773735046
loss_pred:0.0573606938123703, decouple_loss:0.02440199814736843
The generated pressure mean: 0.4495810568332672
loss_pred:0.05556834116578102, decouple_loss:0.023169001564383507
The generated pressure mean: 0.45293354988098145
loss_pred:0.055357106029987335, decouple_loss:0.023851851001381874
Iteration: 230, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45209062099456787
loss_pred:0.0570831336081028, decouple_loss:0.021030433475971222
The generated pressure mean: 0.4525811970233917
loss_pred:0.057852476835250854, decouple_loss:0.0218901839107275
The generated pressure mean: 0.4541330933570862
loss_pred:0.056224338710308075, decouple_loss:0.02098381705582142
2023-04-16 02:17:24 testing...
The generated pressure mean: 0.40705958008766174
loss_pred:0.06324565410614014, decouple_loss:0.02268601953983307
The generated pressure mean: 0.4067787230014801
loss_pred:0.06380460411310196, decouple_loss:0.024482110515236855
The generated pressure mean: 0.4066477417945862
loss_pred:0.06366512924432755, decouple_loss:0.025683384388685226
Loss: 0.06478598713874817, avg_mse: 0.06445969641208649
current test mse: 0.06446
Iteration: 231, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45077434182167053
loss_pred:0.0568094439804554, decouple_loss:0.022013965994119644
The generated pressure mean: 0.4512074887752533
loss_pred:0.05684275180101395, decouple_loss:0.021091893315315247
The generated pressure mean: 0.45139145851135254
loss_pred:0.053977735340595245, decouple_loss:0.021378660574555397
Iteration: 232, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45031046867370605
The generated pressure mean: 0.44908657670021057
loss_pred:0.054273974150419235, decouple_loss:0.02135442942380905
loss_pred:0.05504312366247177, decouple_loss:0.021554067730903625
The generated pressure mean: 0.4475472569465637
loss_pred:0.05378799885511398, decouple_loss:0.022740906104445457
Iteration: 233, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4532261788845062
loss_pred:0.05796874314546585, decouple_loss:0.02125466987490654
The generated pressure mean: 0.45456552505493164
loss_pred:0.056723013520240784, decouple_loss:0.020630382001399994
The generated pressure mean: 0.45231711864471436
loss_pred:0.05523168295621872, decouple_loss:0.021775495260953903
Iteration: 234, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.438992440700531
loss_pred:0.05665896087884903, decouple_loss:0.021791545674204826
The generated pressure mean: 0.43854179978370667
loss_pred:0.058095164597034454, decouple_loss:0.02175341174006462
The generated pressure mean: 0.4382385313510895
loss_pred:0.05409109964966774, decouple_loss:0.022487910464406013
Iteration: 235, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4530809223651886
loss_pred:0.05671768635511398, decouple_loss:0.024190597236156464
The generated pressure mean: 0.449032187461853
loss_pred:0.05812211334705353, decouple_loss:0.02413199283182621
The generated pressure mean: 0.45085740089416504
loss_pred:0.053825169801712036, decouple_loss:0.024901097640395164
Iteration: 236, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4465497136116028
loss_pred:0.055862173438072205, decouple_loss:0.021993007510900497
The generated pressure mean: 0.44705551862716675
loss_pred:0.052944425493478775, decouple_loss:0.0224309004843235
The generated pressure mean: 0.44413039088249207
loss_pred:0.05680396780371666, decouple_loss:0.021039528772234917
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 237, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4428902566432953
loss_pred:0.05810268968343735, decouple_loss:0.0231186430901289
The generated pressure mean: 0.4438929259777069
loss_pred:0.0558537021279335, decouple_loss:0.023254621773958206
The generated pressure mean: 0.4431101679801941
loss_pred:0.05373230576515198, decouple_loss:0.02283416874706745
Iteration: 238, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4580456018447876
loss_pred:0.057031307369470596, decouple_loss:0.0226787980645895
The generated pressure mean: 0.45819199085235596
loss_pred:0.05597585439682007, decouple_loss:0.022926317527890205
The generated pressure mean: 0.45740991830825806
loss_pred:0.05531498044729233, decouple_loss:0.022253669798374176
Iteration: 239, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45550253987312317
loss_pred:0.054577287286520004, decouple_loss:0.022975733503699303
The generated pressure mean: 0.45775628089904785
loss_pred:0.05413031578063965, decouple_loss:0.022348027676343918
The generated pressure mean: 0.4551098048686981
loss_pred:0.05376172438263893, decouple_loss:0.02401336096227169
Iteration: 240, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44534459710121155
The generated pressure mean: 0.448539137840271loss_pred:0.05600652098655701, decouple_loss:0.026000909507274628
loss_pred:0.05597132816910744, decouple_loss:0.023917213082313538
The generated pressure mean: 0.4467162489891052
loss_pred:0.05521843209862709, decouple_loss:0.023428089916706085
2023-04-16 02:19:25 testing...
The generated pressure mean: 0.40784624218940735
loss_pred:0.06201034411787987, decouple_loss:0.02344740554690361
The generated pressure mean: 0.4076422452926636
loss_pred:0.06276226788759232, decouple_loss:0.02497442439198494
The generated pressure mean: 0.4075268805027008
loss_pred:0.06289249658584595, decouple_loss:0.025349535048007965
Loss: 0.06378456205129623, avg_mse: 0.06354008615016937
current test mse: 0.06354
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012000_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012000_3_24hr.npz
NaN value num: 0
Iteration: 241, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4509451389312744
loss_pred:0.06074589863419533, decouple_loss:0.026967711746692657
The generated pressure mean: 0.44853469729423523
loss_pred:0.05456551909446716, decouple_loss:0.02362772263586521
The generated pressure mean: 0.44928479194641113
loss_pred:0.05438949167728424, decouple_loss:0.023989664390683174
Iteration: 242, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4549762010574341
loss_pred:0.060549456626176834, decouple_loss:0.025586791336536407
The generated pressure mean: 0.45136502385139465
loss_pred:0.054898761212825775, decouple_loss:0.026509631425142288
The generated pressure mean: 0.45244285464286804
loss_pred:0.05562762916088104, decouple_loss:0.025696540251374245
Iteration: 243, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45033249258995056
loss_pred:0.05642805993556976, decouple_loss:0.02353176847100258
The generated pressure mean: 0.44969937205314636
loss_pred:0.0546950064599514, decouple_loss:0.02476630173623562
The generated pressure mean: 0.44943296909332275
loss_pred:0.05626426264643669, decouple_loss:0.02361099235713482
Iteration: 244, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4427073895931244
loss_pred:0.05668376758694649, decouple_loss:0.02315918169915676
The generated pressure mean: 0.445412814617157
loss_pred:0.05501183494925499, decouple_loss:0.02442394755780697
The generated pressure mean: 0.44620001316070557
loss_pred:0.05662381276488304, decouple_loss:0.02416921593248844
Iteration: 245, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4451446533203125
loss_pred:0.056526266038417816, decouple_loss:0.02170819789171219
The generated pressure mean: 0.44530168175697327
loss_pred:0.05518820509314537, decouple_loss:0.021658767014741898
The generated pressure mean: 0.4458942115306854
loss_pred:0.055067289620637894, decouple_loss:0.02150718867778778
Iteration: 246, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44668543338775635
The generated pressure mean: 0.4492932856082916
loss_pred:0.05641545355319977, decouple_loss:0.02493853121995926
loss_pred:0.05380155146121979, decouple_loss:0.021793894469738007
The generated pressure mean: 0.44829651713371277
loss_pred:0.05594015493988991, decouple_loss:0.022810237482190132
Iteration: 247, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4487477242946625
loss_pred:0.05542333051562309, decouple_loss:0.0196043960750103
The generated pressure mean: 0.4493851661682129
loss_pred:0.05818259343504906, decouple_loss:0.022053265944123268
The generated pressure mean: 0.45282259583473206
loss_pred:0.05581333115696907, decouple_loss:0.021594863384962082
Iteration: 248, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44757771492004395
loss_pred:0.05555253475904465, decouple_loss:0.022713977843523026
The generated pressure mean: 0.44964519143104553
loss_pred:0.05429970100522041, decouple_loss:0.023617634549736977
The generated pressure mean: 0.44968274235725403
loss_pred:0.06027591973543167, decouple_loss:0.02205193229019642
Iteration: 249, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45048871636390686
loss_pred:0.05978332459926605, decouple_loss:0.020985184237360954
The generated pressure mean: 0.4492471516132355
loss_pred:0.05434055253863335, decouple_loss:0.0218651220202446
The generated pressure mean: 0.4507899284362793
loss_pred:0.056939393281936646, decouple_loss:0.020445743575692177
Iteration: 250, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44934266805648804
loss_pred:0.05289158597588539, decouple_loss:0.02301921509206295
The generated pressure mean: 0.45311230421066284
loss_pred:0.05466540902853012, decouple_loss:0.022901641204953194
The generated pressure mean: 0.45139169692993164
loss_pred:0.05382995307445526, decouple_loss:0.02208980731666088
2023-04-16 02:22:00 testing...
The generated pressure mean: 0.40895795822143555
loss_pred:0.06292407214641571, decouple_loss:0.020840635523200035
The generated pressure mean: 0.4088362157344818
loss_pred:0.06183922290802002, decouple_loss:0.021575424820184708
The generated pressure mean: 0.4089556634426117
loss_pred:0.06272891908884048, decouple_loss:0.022064097225666046
Loss: 0.06357207894325256, avg_mse: 0.06434101611375809
current test mse: 0.064341
Iteration: 251, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4468781650066376
loss_pred:0.05320683494210243, decouple_loss:0.020389076322317123
The generated pressure mean: 0.44823870062828064
loss_pred:0.054912395775318146, decouple_loss:0.0200133565813303
The generated pressure mean: 0.4487798810005188
loss_pred:0.05232621356844902, decouple_loss:0.020838100463151932
Iteration: 252, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44387754797935486
The generated pressure mean: 0.4451841413974762
loss_pred:0.05409519374370575, decouple_loss:0.020966017618775368
loss_pred:0.05329262465238571, decouple_loss:0.022246552631258965
The generated pressure mean: 0.4459518790245056
loss_pred:0.05790381506085396, decouple_loss:0.022010019049048424
Iteration: 253, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4465099275112152
The generated pressure mean: 0.445485383272171
loss_pred:0.05296827107667923, decouple_loss:0.021506858989596367
loss_pred:0.05422460660338402, decouple_loss:0.022629261016845703
The generated pressure mean: 0.44591715931892395
loss_pred:0.0551694892346859, decouple_loss:0.022975698113441467
Iteration: 254, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4476255178451538
The generated pressure mean: 0.44616612792015076
loss_pred:0.05394749715924263, decouple_loss:0.02141636423766613
loss_pred:0.053281158208847046, decouple_loss:0.021475844085216522
The generated pressure mean: 0.445038765668869
loss_pred:0.05140187218785286, decouple_loss:0.02031845599412918
Iteration: 255, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44510573148727417
loss_pred:0.05310177057981491, decouple_loss:0.02270224131643772
The generated pressure mean: 0.4439223110675812
loss_pred:0.05463675409555435, decouple_loss:0.02331419847905636
The generated pressure mean: 0.44617846608161926
loss_pred:0.05480894818902016, decouple_loss:0.021274272352457047
Iteration: 256, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4451071321964264
loss_pred:0.05372610688209534, decouple_loss:0.018772760406136513
The generated pressure mean: 0.4428407847881317
loss_pred:0.056110914796590805, decouple_loss:0.020462436601519585
The generated pressure mean: 0.44350218772888184
loss_pred:0.0527748242020607, decouple_loss:0.01962793618440628
Iteration: 257, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4460063874721527
loss_pred:0.05247027054429054, decouple_loss:0.021618809551000595
The generated pressure mean: 0.44342389702796936
loss_pred:0.05181318148970604, decouple_loss:0.02227228693664074
The generated pressure mean: 0.442489355802536
loss_pred:0.05526066571474075, decouple_loss:0.021915145218372345
Iteration: 258, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44543924927711487
loss_pred:0.05326545611023903, decouple_loss:0.023288480937480927
The generated pressure mean: 0.44537588953971863
loss_pred:0.05351797118782997, decouple_loss:0.023856207728385925
The generated pressure mean: 0.4467524588108063
loss_pred:0.053012747317552567, decouple_loss:0.020989757031202316
Iteration: 259, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4441699683666229
The generated pressure mean: 0.44430825114250183
loss_pred:0.05543313920497894, decouple_loss:0.01958797685801983
loss_pred:0.05310401692986488, decouple_loss:0.02032705768942833
The generated pressure mean: 0.4471440613269806
loss_pred:0.05253360792994499, decouple_loss:0.020098986104130745
Iteration: 260, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44566571712493896
loss_pred:0.050988949835300446, decouple_loss:0.021648390218615532
The generated pressure mean: 0.4450548589229584
loss_pred:0.05486821010708809, decouple_loss:0.021516697481274605
The generated pressure mean: 0.4468823969364166
loss_pred:0.05036887526512146, decouple_loss:0.021676717326045036
2023-04-16 02:24:01 testing...
The generated pressure mean: 0.40984034538269043
loss_pred:0.060928650200366974, decouple_loss:0.019556378945708275
The generated pressure mean: 0.40966957807540894
loss_pred:0.05984808877110481, decouple_loss:0.01967453584074974
The generated pressure mean: 0.4099258482456207
loss_pred:0.06055465340614319, decouple_loss:0.02091183327138424
Loss: 0.0614461749792099, avg_mse: 0.06258782744407654
current test mse: 0.062588
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012018_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012018_3_24hr.npz
NaN value num: 0
Iteration: 261, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44687190651893616
loss_pred:0.05044236034154892, decouple_loss:0.019566280767321587
The generated pressure mean: 0.44643038511276245
loss_pred:0.05519392341375351, decouple_loss:0.020533623173832893
The generated pressure mean: 0.4465106725692749
loss_pred:0.0539117306470871, decouple_loss:0.018564218655228615
Iteration: 262, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44314488768577576
loss_pred:0.05425920709967613, decouple_loss:0.021684249863028526
The generated pressure mean: 0.444671094417572
loss_pred:0.05007508769631386, decouple_loss:0.022338517010211945
The generated pressure mean: 0.4429222643375397
loss_pred:0.0578288771212101, decouple_loss:0.0217289961874485
Iteration: 263, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4507114589214325
loss_pred:0.05499820038676262, decouple_loss:0.020363030955195427
The generated pressure mean: 0.4489314556121826
loss_pred:0.05545300990343094, decouple_loss:0.019621716812253
The generated pressure mean: 0.44709959626197815
loss_pred:0.05332683399319649, decouple_loss:0.020255768671631813
Iteration: 264, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4527536630630493
loss_pred:0.05444413423538208, decouple_loss:0.02158317156136036
The generated pressure mean: 0.45336785912513733
loss_pred:0.056123487651348114, decouple_loss:0.021958505734801292
The generated pressure mean: 0.44958052039146423
loss_pred:0.05420404300093651, decouple_loss:0.022278400138020515
Iteration: 265, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45314139127731323
loss_pred:0.050023630261421204, decouple_loss:0.020555943250656128
The generated pressure mean: 0.4523359537124634
loss_pred:0.05286431685090065, decouple_loss:0.021098334342241287
The generated pressure mean: 0.452761173248291
loss_pred:0.054887596517801285, decouple_loss:0.022325634956359863
Iteration: 266, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4504166543483734
loss_pred:0.05212435871362686, decouple_loss:0.022323794662952423
The generated pressure mean: 0.4520120918750763
loss_pred:0.056269604712724686, decouple_loss:0.023532425984740257
The generated pressure mean: 0.45102477073669434
loss_pred:0.05085305869579315, decouple_loss:0.022021759301424026
Iteration: 267, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4459036886692047
loss_pred:0.05299389362335205, decouple_loss:0.023752614855766296
The generated pressure mean: 0.4507349729537964
loss_pred:0.0557754784822464, decouple_loss:0.026040809229016304
The generated pressure mean: 0.44895458221435547
loss_pred:0.051054973155260086, decouple_loss:0.02435493841767311
Iteration: 268, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4522245228290558
loss_pred:0.05294644087553024, decouple_loss:0.021578552201390266
The generated pressure mean: 0.45343032479286194
loss_pred:0.05367017909884453, decouple_loss:0.02166854217648506
The generated pressure mean: 0.4530984163284302
loss_pred:0.053403813391923904, decouple_loss:0.021410219371318817
Iteration: 269, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4535914361476898
loss_pred:0.05046825855970383, decouple_loss:0.02226852998137474The generated pressure mean: 0.4526074528694153
loss_pred:0.05346718057990074, decouple_loss:0.02267640084028244
The generated pressure mean: 0.4530599117279053
loss_pred:0.05333055183291435, decouple_loss:0.022673316299915314
Iteration: 270, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4477233588695526
loss_pred:0.052417103201150894, decouple_loss:0.020750634372234344
The generated pressure mean: 0.44808104634284973
loss_pred:0.05359971523284912, decouple_loss:0.022964799776673317
The generated pressure mean: 0.4479348361492157
loss_pred:0.05078773945569992, decouple_loss:0.021974999457597733
2023-04-16 02:26:36 testing...
The generated pressure mean: 0.40886518359184265
loss_pred:0.059486135840415955, decouple_loss:0.021550914272665977
The generated pressure mean: 0.4085725247859955
loss_pred:0.05894892290234566, decouple_loss:0.02178376540541649
The generated pressure mean: 0.40895289182662964
loss_pred:0.05937986820936203, decouple_loss:0.022200994193553925
Loss: 0.060363903641700745, avg_mse: 0.061901673674583435
current test mse: 0.061902
Iteration: 271, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4497595429420471The generated pressure mean: 0.4520426392555237
loss_pred:0.05178743600845337, decouple_loss:0.0212243665009737loss_pred:0.05395609885454178, decouple_loss:0.021734798327088356
The generated pressure mean: 0.45022737979888916
loss_pred:0.05137312784790993, decouple_loss:0.020917216315865517
Iteration: 272, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4506493806838989
loss_pred:0.0494583398103714, decouple_loss:0.021046534180641174
The generated pressure mean: 0.4487529993057251
loss_pred:0.050239916890859604, decouple_loss:0.0208184402436018
The generated pressure mean: 0.451035737991333
loss_pred:0.05550174042582512, decouple_loss:0.021478477865457535
Iteration: 273, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4507504403591156
loss_pred:0.05287730321288109, decouple_loss:0.024357959628105164
The generated pressure mean: 0.4511995017528534
loss_pred:0.053812433034181595, decouple_loss:0.023136703297495842
The generated pressure mean: 0.45094290375709534
loss_pred:0.04941698908805847, decouple_loss:0.0231475867331028
Iteration: 274, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4477132260799408
loss_pred:0.052086059004068375, decouple_loss:0.02542952634394169
The generated pressure mean: 0.4486389458179474
loss_pred:0.05040258541703224, decouple_loss:0.023729804903268814
The generated pressure mean: 0.449788898229599
loss_pred:0.05359043553471565, decouple_loss:0.02412090264260769
Iteration: 275, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45453688502311707
The generated pressure mean: 0.4562585651874542
loss_pred:0.0521119087934494, decouple_loss:0.03202911466360092
loss_pred:0.05453520640730858, decouple_loss:0.03207491338253021
The generated pressure mean: 0.4558264911174774
loss_pred:0.051923200488090515, decouple_loss:0.03213200718164444
Iteration: 276, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4585878849029541
loss_pred:0.05229249969124794, decouple_loss:0.023396698758006096
The generated pressure mean: 0.45901843905448914
loss_pred:0.054468557238578796, decouple_loss:0.022602364420890808
The generated pressure mean: 0.4581592381000519
loss_pred:0.05297126993536949, decouple_loss:0.022689903154969215
Iteration: 277, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45452120900154114
loss_pred:0.05133538320660591, decouple_loss:0.022202948108315468
The generated pressure mean: 0.45541200041770935
loss_pred:0.05161546915769577, decouple_loss:0.022227752953767776
The generated pressure mean: 0.45184996724128723
loss_pred:0.050154466181993484, decouple_loss:0.021498730406165123
Iteration: 278, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4452975392341614
loss_pred:0.05325237289071083, decouple_loss:0.020439624786376953
The generated pressure mean: 0.4449463188648224
loss_pred:0.0521395169198513, decouple_loss:0.02170734666287899
The generated pressure mean: 0.44452768564224243
loss_pred:0.05495845898985863, decouple_loss:0.020535621792078018
Iteration: 279, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44903624057769775
loss_pred:0.053055912256240845, decouple_loss:0.02086513862013817
The generated pressure mean: 0.45119813084602356
loss_pred:0.054280299693346024, decouple_loss:0.020372509956359863
The generated pressure mean: 0.44957834482192993
loss_pred:0.05190431326627731, decouple_loss:0.020636534318327904
Iteration: 280, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45618170499801636
loss_pred:0.04960479959845543, decouple_loss:0.022830255329608917
The generated pressure mean: 0.46002766489982605
loss_pred:0.05287863686680794, decouple_loss:0.022770769894123077
The generated pressure mean: 0.4553968906402588
loss_pred:0.051410842686891556, decouple_loss:0.022405127063393593
2023-04-16 02:28:37 testing...
The generated pressure mean: 0.40994027256965637
loss_pred:0.05941248685121536, decouple_loss:0.019426465034484863
The generated pressure mean: 0.4095441699028015
loss_pred:0.058029718697071075, decouple_loss:0.01996835134923458
The generated pressure mean: 0.4101298749446869
loss_pred:0.05896656960248947, decouple_loss:0.020449399948120117
Loss: 0.05980032682418823, avg_mse: 0.06210838630795479
current test mse: 0.062108
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012001_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012001_3_24hr.npz
NaN value num: 0
Iteration: 281, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4460342526435852
loss_pred:0.05363042280077934, decouple_loss:0.018902920186519623
The generated pressure mean: 0.4455358684062958
loss_pred:0.049040183424949646, decouple_loss:0.021920543164014816
The generated pressure mean: 0.44603511691093445
loss_pred:0.050053808838129044, decouple_loss:0.019870838150382042
Iteration: 282, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.434869647026062
loss_pred:0.05176985636353493, decouple_loss:0.022129395976662636
The generated pressure mean: 0.4369910955429077
loss_pred:0.04933357611298561, decouple_loss:0.02275506593286991
The generated pressure mean: 0.4347485303878784
loss_pred:0.050845060497522354, decouple_loss:0.021485773846507072
Iteration: 283, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44249072670936584
loss_pred:0.049661390483379364, decouple_loss:0.01990724541246891
The generated pressure mean: 0.44297733902931213
loss_pred:0.052310213446617126, decouple_loss:0.019296634942293167
The generated pressure mean: 0.4393724799156189
loss_pred:0.049670249223709106, decouple_loss:0.01975448802113533
Iteration: 284, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45052608847618103
The generated pressure mean: 0.44832420349121094loss_pred:0.04802890866994858, decouple_loss:0.020232927054166794
loss_pred:0.047852400690317154, decouple_loss:0.020745616406202316
The generated pressure mean: 0.4505747854709625
loss_pred:0.049157947301864624, decouple_loss:0.02263372205197811
Iteration: 285, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4425206184387207
loss_pred:0.051885396242141724, decouple_loss:0.01994999870657921
The generated pressure mean: 0.4438233971595764
loss_pred:0.05291777849197388, decouple_loss:0.01958094909787178
The generated pressure mean: 0.44449710845947266
loss_pred:0.048296328634023666, decouple_loss:0.01907050982117653
Iteration: 286, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45498278737068176
loss_pred:0.04965654015541077, decouple_loss:0.02091633714735508
The generated pressure mean: 0.45176932215690613
loss_pred:0.05125006288290024, decouple_loss:0.02130446955561638
The generated pressure mean: 0.45280635356903076
loss_pred:0.05100211501121521, decouple_loss:0.02170286513864994
Iteration: 287, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4539608061313629
loss_pred:0.04994139075279236, decouple_loss:0.018948571756482124
The generated pressure mean: 0.4506072700023651
loss_pred:0.05225896090269089, decouple_loss:0.0200372114777565
The generated pressure mean: 0.4503144919872284
loss_pred:0.05162980780005455, decouple_loss:0.019599776715040207
Iteration: 288, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44098398089408875
loss_pred:0.05121582746505737, decouple_loss:0.023333629593253136
The generated pressure mean: 0.44070369005203247
loss_pred:0.0485297366976738, decouple_loss:0.020036904141306877
The generated pressure mean: 0.4378090798854828
loss_pred:0.051754266023635864, decouple_loss:0.020940937101840973
Iteration: 289, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44876039028167725
loss_pred:0.0509469248354435, decouple_loss:0.02093813382089138
The generated pressure mean: 0.45029228925704956
loss_pred:0.05086585134267807, decouple_loss:0.022292204201221466
The generated pressure mean: 0.44859445095062256
loss_pred:0.048292793333530426, decouple_loss:0.01959557645022869
Iteration: 290, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4583297371864319
loss_pred:0.05106348916888237, decouple_loss:0.020108187571167946
The generated pressure mean: 0.46178874373435974
loss_pred:0.049095965921878815, decouple_loss:0.020681656897068024
The generated pressure mean: 0.4597218632698059
loss_pred:0.04725898429751396, decouple_loss:0.020862439647316933
2023-04-16 02:31:24 testing...
The generated pressure mean: 0.40952950716018677
loss_pred:0.05856727063655853, decouple_loss:0.022256486117839813
The generated pressure mean: 0.4089263379573822
loss_pred:0.0577068105340004, decouple_loss:0.02233079820871353
The generated pressure mean: 0.40970101952552795
loss_pred:0.058350857347249985, decouple_loss:0.022966476157307625
Loss: 0.05933421105146408, avg_mse: 0.06224958598613739
current test mse: 0.06225
Iteration: 291, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4484741985797882The generated pressure mean: 0.44912055134773254
loss_pred:0.04910942167043686, decouple_loss:0.020265264436602592
loss_pred:0.047959424555301666, decouple_loss:0.021422816440463066
The generated pressure mean: 0.446988046169281
loss_pred:0.05101390555500984, decouple_loss:0.022043393924832344
Iteration: 292, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4349375367164612
loss_pred:0.04966935142874718, decouple_loss:0.01982961967587471
The generated pressure mean: 0.4337599575519562
loss_pred:0.048589710146188736, decouple_loss:0.01992836594581604
The generated pressure mean: 0.43277114629745483
loss_pred:0.05018738657236099, decouple_loss:0.01986035890877247
Iteration: 293, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43543702363967896
loss_pred:0.05200576037168503, decouple_loss:0.021410804241895676
The generated pressure mean: 0.44049692153930664
loss_pred:0.048342812806367874, decouple_loss:0.024519361555576324
The generated pressure mean: 0.43887582421302795
loss_pred:0.04664516821503639, decouple_loss:0.02230938710272312
Iteration: 294, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4517626464366913
loss_pred:0.0468510203063488, decouple_loss:0.020093314349651337
The generated pressure mean: 0.4533159136772156
loss_pred:0.048286717385053635, decouple_loss:0.02164348028600216
The generated pressure mean: 0.4538439214229584
loss_pred:0.04911191761493683, decouple_loss:0.0211196206510067
Iteration: 295, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4500923156738281
loss_pred:0.04753025621175766, decouple_loss:0.02047066204249859
The generated pressure mean: 0.45136797428131104
loss_pred:0.050212085247039795, decouple_loss:0.020963679999113083
The generated pressure mean: 0.4504944980144501
loss_pred:0.047660376876592636, decouple_loss:0.01995600014925003
Iteration: 296, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45182329416275024
loss_pred:0.049048587679862976, decouple_loss:0.020898517221212387
The generated pressure mean: 0.4519675374031067
loss_pred:0.052278485149145126, decouple_loss:0.020032554864883423
The generated pressure mean: 0.44942721724510193
loss_pred:0.047231514006853104, decouple_loss:0.02032051607966423
Iteration: 297, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45489850640296936
loss_pred:0.0474601574242115, decouple_loss:0.02057475969195366
The generated pressure mean: 0.45396795868873596
loss_pred:0.047280203551054, decouple_loss:0.02064613811671734
The generated pressure mean: 0.453284353017807
loss_pred:0.04819219559431076, decouple_loss:0.020195448771119118
Iteration: 298, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4458633363246918
loss_pred:0.04698888584971428, decouple_loss:0.020410891622304916
The generated pressure mean: 0.443755179643631
loss_pred:0.04851807653903961, decouple_loss:0.02007579244673252
The generated pressure mean: 0.44431862235069275
loss_pred:0.04804578423500061, decouple_loss:0.02019631676375866
Iteration: 299, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4429241418838501
loss_pred:0.047618333250284195, decouple_loss:0.020422128960490227
The generated pressure mean: 0.4445336163043976
loss_pred:0.04847221076488495, decouple_loss:0.01975812204182148
The generated pressure mean: 0.444146990776062
loss_pred:0.047607164829969406, decouple_loss:0.01985422521829605
Iteration: 300, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44628575444221497
loss_pred:0.050816141068935394, decouple_loss:0.01992311142385006
The generated pressure mean: 0.4486742615699768
loss_pred:0.04774219170212746, decouple_loss:0.020670268684625626
The generated pressure mean: 0.44881314039230347
loss_pred:0.046988874673843384, decouple_loss:0.02023063227534294
2023-04-16 02:33:24 testing...
The generated pressure mean: 0.41065695881843567
loss_pred:0.05759674310684204, decouple_loss:0.01822170428931713
The generated pressure mean: 0.4098701775074005
loss_pred:0.056416917592287064, decouple_loss:0.018487829715013504
The generated pressure mean: 0.4106697142124176
loss_pred:0.05693930387496948, decouple_loss:0.01926266774535179
Loss: 0.057917192578315735, avg_mse: 0.06079180911183357
current test mse: 0.060792
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012010_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012010_3_24hr.npz
NaN value num: 0
Iteration: 301, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4434265196323395
loss_pred:0.047138892114162445, decouple_loss:0.018020344898104668
The generated pressure mean: 0.4427381455898285
loss_pred:0.0482996329665184, decouple_loss:0.017860088497400284
The generated pressure mean: 0.44436195492744446
loss_pred:0.04554399847984314, decouple_loss:0.017251411452889442
Iteration: 302, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44068747758865356
loss_pred:0.04538794606924057, decouple_loss:0.019680391997098923
The generated pressure mean: 0.44101160764694214
The generated pressure mean: 0.44150808453559875
loss_pred:0.04575500637292862, decouple_loss:0.020258573815226555
loss_pred:0.04714377224445343, decouple_loss:0.021315451711416245
Iteration: 303, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4544280469417572
loss_pred:0.04685482755303383, decouple_loss:0.018959645181894302
The generated pressure mean: 0.45451095700263977
loss_pred:0.049862246960401535, decouple_loss:0.019049033522605896
The generated pressure mean: 0.4533679783344269
loss_pred:0.046957626938819885, decouple_loss:0.018777020275592804
Iteration: 304, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4510897397994995
loss_pred:0.04677719250321388, decouple_loss:0.022131379693746567
The generated pressure mean: 0.4497738182544708
loss_pred:0.04854225739836693, decouple_loss:0.02095906436443329
The generated pressure mean: 0.4485267400741577
loss_pred:0.04654575511813164, decouple_loss:0.02108774147927761
Iteration: 305, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4514308571815491
loss_pred:0.04749797657132149, decouple_loss:0.01744786836206913
The generated pressure mean: 0.45235562324523926
loss_pred:0.050191234797239304, decouple_loss:0.016994597390294075
The generated pressure mean: 0.4515986442565918
loss_pred:0.04791834577918053, decouple_loss:0.01730400323867798
Iteration: 306, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44789886474609375
loss_pred:0.04599980264902115, decouple_loss:0.020051157101988792
The generated pressure mean: 0.44919630885124207
loss_pred:0.04670985788106918, decouple_loss:0.019831720739603043
The generated pressure mean: 0.4463275969028473
loss_pred:0.04607664793729782, decouple_loss:0.01959824748337269
Iteration: 307, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4449688494205475
loss_pred:0.04953198507428169, decouple_loss:0.01839764043688774
The generated pressure mean: 0.44282856583595276
loss_pred:0.04802856594324112, decouple_loss:0.019018085673451424
The generated pressure mean: 0.4439115524291992
loss_pred:0.0483093298971653, decouple_loss:0.016669588163495064
Iteration: 308, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4605030417442322
loss_pred:0.047110188752412796, decouple_loss:0.01710900291800499
The generated pressure mean: 0.4606061279773712
loss_pred:0.04785402864217758, decouple_loss:0.01686939224600792
The generated pressure mean: 0.46082285046577454
loss_pred:0.047062262892723083, decouple_loss:0.0168475229293108
Iteration: 309, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4412255883216858
loss_pred:0.04714652895927429, decouple_loss:0.01818537339568138
The generated pressure mean: 0.44201308488845825
loss_pred:0.04543548449873924, decouple_loss:0.01790613681077957
The generated pressure mean: 0.4427453577518463
loss_pred:0.045798830687999725, decouple_loss:0.019792597740888596
Iteration: 310, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4476071298122406
loss_pred:0.047232214361429214, decouple_loss:0.016816113144159317
The generated pressure mean: 0.4453676640987396
loss_pred:0.04430544003844261, decouple_loss:0.016964564099907875
The generated pressure mean: 0.4477505087852478
loss_pred:0.047391291707754135, decouple_loss:0.018049484118819237
2023-04-16 02:36:05 testing...
The generated pressure mean: 0.4082132577896118
loss_pred:0.05711616203188896, decouple_loss:0.017783917486667633
The generated pressure mean: 0.4072973132133484
loss_pred:0.05574828386306763, decouple_loss:0.018255624920129776
The generated pressure mean: 0.40850090980529785
loss_pred:0.05642388015985489, decouple_loss:0.01897919550538063
Loss: 0.05734642595052719, avg_mse: 0.06086372211575508
current test mse: 0.060864
Iteration: 311, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45575687289237976
The generated pressure mean: 0.45367559790611267
loss_pred:0.0458286814391613, decouple_loss:0.01738688349723816
loss_pred:0.050541479140520096, decouple_loss:0.01762794330716133
The generated pressure mean: 0.45298662781715393
loss_pred:0.0516929067671299, decouple_loss:0.01908327266573906
Iteration: 312, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4496159255504608
The generated pressure mean: 0.4506346881389618
loss_pred:0.04503795877099037, decouple_loss:0.0188838392496109
loss_pred:0.045211050659418106, decouple_loss:0.01853449083864689
The generated pressure mean: 0.4511960744857788
loss_pred:0.04573347792029381, decouple_loss:0.018169227987527847
Iteration: 313, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43457159399986267
loss_pred:0.04727670177817345, decouple_loss:0.017254943028092384
The generated pressure mean: 0.4345698952674866
loss_pred:0.04703816771507263, decouple_loss:0.017014289274811745
The generated pressure mean: 0.4353981018066406
loss_pred:0.04469847306609154, decouple_loss:0.017723534256219864
Iteration: 314, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44963765144348145
loss_pred:0.046165481209754944, decouple_loss:0.017798949033021927
The generated pressure mean: 0.44990238547325134
loss_pred:0.04492369666695595, decouple_loss:0.01707557588815689
The generated pressure mean: 0.45207899808883667
loss_pred:0.046671025454998016, decouple_loss:0.0177061278373003
Iteration: 315, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4450412094593048
loss_pred:0.04872429370880127, decouple_loss:0.022621290758252144
The generated pressure mean: 0.44603797793388367
loss_pred:0.04613548517227173, decouple_loss:0.023494815453886986
The generated pressure mean: 0.44483518600463867
loss_pred:0.047915633767843246, decouple_loss:0.022482937201857567
Iteration: 316, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4720383286476135
loss_pred:0.049805719405412674, decouple_loss:0.018896715715527534
The generated pressure mean: 0.4720863997936249
loss_pred:0.05090568587183952, decouple_loss:0.019738296046853065
The generated pressure mean: 0.4734688401222229
loss_pred:0.04995020851492882, decouple_loss:0.01962420903146267
Iteration: 317, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43203654885292053
loss_pred:0.04912992939352989, decouple_loss:0.02173709310591221
The generated pressure mean: 0.432187020778656
loss_pred:0.04706808179616928, decouple_loss:0.020461980253458023
The generated pressure mean: 0.4324159622192383
loss_pred:0.0503845252096653, decouple_loss:0.02122817002236843
Iteration: 318, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45313867926597595
loss_pred:0.048714593052864075, decouple_loss:0.01764678582549095
The generated pressure mean: 0.45224669575691223
loss_pred:0.0465010404586792, decouple_loss:0.018177196383476257
The generated pressure mean: 0.4563846290111542
loss_pred:0.04487231746315956, decouple_loss:0.017375139519572258
Iteration: 319, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46602490544319153
The generated pressure mean: 0.4647594094276428
loss_pred:0.046666864305734634, decouple_loss:0.018433991819620132
loss_pred:0.048004571348428726, decouple_loss:0.018147921189665794
The generated pressure mean: 0.467049241065979
loss_pred:0.049628328531980515, decouple_loss:0.019378233700990677
Iteration: 320, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.441708505153656
loss_pred:0.04385518282651901, decouple_loss:0.018689550459384918
The generated pressure mean: 0.4429861307144165
loss_pred:0.04522918164730072, decouple_loss:0.01903638429939747
The generated pressure mean: 0.44293174147605896
loss_pred:0.04689893126487732, decouple_loss:0.018873414024710655
2023-04-16 02:38:06 testing...
The generated pressure mean: 0.41414666175842285
loss_pred:0.05785432085394859, decouple_loss:0.019647710025310516
The generated pressure mean: 0.4136284291744232
loss_pred:0.05717683583498001, decouple_loss:0.02017032355070114
The generated pressure mean: 0.4146173596382141
loss_pred:0.05700550973415375, decouple_loss:0.020355775952339172
Loss: 0.05834845453500748, avg_mse: 0.06205463036894798
current test mse: 0.062055
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012009_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012009_3_24hr.npz
NaN value num: 0
Iteration: 321, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43276506662368774
loss_pred:0.04497246816754341, decouple_loss:0.019897181540727615
The generated pressure mean: 0.43366241455078125
loss_pred:0.04705505445599556, decouple_loss:0.019711080938577652
The generated pressure mean: 0.43168938159942627
loss_pred:0.049573786556720734, decouple_loss:0.019098691642284393
Iteration: 322, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4442466199398041
loss_pred:0.04919580742716789, decouple_loss:0.019993843510746956
The generated pressure mean: 0.44394561648368835
loss_pred:0.049586221575737, decouple_loss:0.020979298278689384
The generated pressure mean: 0.44473281502723694
loss_pred:0.04734329879283905, decouple_loss:0.020233165472745895
Iteration: 323, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4455515146255493
The generated pressure mean: 0.4496736526489258
loss_pred:0.0476595014333725, decouple_loss:0.02016151323914528
loss_pred:0.0476422943174839, decouple_loss:0.019871346652507782
The generated pressure mean: 0.4471302330493927
loss_pred:0.04655398428440094, decouple_loss:0.019781548529863358
Iteration: 324, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4564233720302582
loss_pred:0.04596298187971115, decouple_loss:0.020523833110928535
The generated pressure mean: 0.4569527208805084
loss_pred:0.04776403307914734, decouple_loss:0.0207061804831028
The generated pressure mean: 0.456131249666214
loss_pred:0.04477560892701149, decouple_loss:0.020770903676748276
Iteration: 325, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4603148400783539
loss_pred:0.04744550585746765, decouple_loss:0.020652059465646744
The generated pressure mean: 0.45536065101623535
loss_pred:0.0470767617225647, decouple_loss:0.019101867452263832
The generated pressure mean: 0.4576098918914795
loss_pred:0.04585322365164757, decouple_loss:0.020376699045300484
Iteration: 326, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.42708301544189453
loss_pred:0.04538128152489662, decouple_loss:0.021329184994101524
The generated pressure mean: 0.4292975962162018
loss_pred:0.04566069319844246, decouple_loss:0.020245671272277832
The generated pressure mean: 0.43105411529541016
loss_pred:0.04770512506365776, decouple_loss:0.020653584972023964
Iteration: 327, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4431869387626648
loss_pred:0.04567278176546097, decouple_loss:0.017481645569205284
The generated pressure mean: 0.44136902689933777
loss_pred:0.047162920236587524, decouple_loss:0.017984826117753983
The generated pressure mean: 0.44325897097587585
loss_pred:0.04717642068862915, decouple_loss:0.018105661496520042
Iteration: 328, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.461722731590271
loss_pred:0.04660278186202049, decouple_loss:0.01874142326414585
The generated pressure mean: 0.46112027764320374
loss_pred:0.050735581666231155, decouple_loss:0.018632417544722557
The generated pressure mean: 0.45877349376678467
loss_pred:0.04592936858534813, decouple_loss:0.018356701359152794
Iteration: 329, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44947153329849243
loss_pred:0.04448055103421211, decouple_loss:0.018045781180262566
The generated pressure mean: 0.4490104019641876
loss_pred:0.046189915388822556, decouple_loss:0.018576910719275475
The generated pressure mean: 0.45177406072616577
loss_pred:0.04535464197397232, decouple_loss:0.017959902063012123
Iteration: 330, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4497745931148529
loss_pred:0.04809218645095825, decouple_loss:0.01833750493824482
The generated pressure mean: 0.4442227780818939
loss_pred:0.04512792453169823, decouple_loss:0.018773365765810013
The generated pressure mean: 0.44719478487968445
loss_pred:0.04781750217080116, decouple_loss:0.018908850848674774
2023-04-16 02:40:42 testing...
The generated pressure mean: 0.4105619192123413
loss_pred:0.057255588471889496, decouple_loss:0.017838381230831146
The generated pressure mean: 0.4096638858318329
loss_pred:0.054330065846443176, decouple_loss:0.017734577879309654
The generated pressure mean: 0.41118207573890686
loss_pred:0.05564311891794205, decouple_loss:0.01807071454823017
Loss: 0.0566369853913784, avg_mse: 0.05966828390955925
current test mse: 0.059668
Iteration: 331, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4454644024372101
loss_pred:0.044231582432985306, decouple_loss:0.01671791262924671
The generated pressure mean: 0.44224804639816284
loss_pred:0.04333236441016197, decouple_loss:0.016435721889138222
The generated pressure mean: 0.44505760073661804
loss_pred:0.047508105635643005, decouple_loss:0.01671968586742878
Iteration: 332, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4466106593608856
The generated pressure mean: 0.44914475083351135
loss_pred:0.043570149689912796, decouple_loss:0.017894310876727104
loss_pred:0.04825254902243614, decouple_loss:0.01818271167576313
The generated pressure mean: 0.45133835077285767
loss_pred:0.04838927090167999, decouple_loss:0.017992671579122543
Iteration: 333, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.441721111536026
loss_pred:0.045850250869989395, decouple_loss:0.017064904794096947
The generated pressure mean: 0.44050517678260803
loss_pred:0.04466728866100311, decouple_loss:0.01864081621170044
The generated pressure mean: 0.4390585720539093
loss_pred:0.049622707068920135, decouple_loss:0.016949478536844254
Iteration: 334, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46587708592414856
loss_pred:0.043765340000391006, decouple_loss:0.01778593473136425
The generated pressure mean: 0.4613208472728729
loss_pred:0.0450165830552578, decouple_loss:0.017145438119769096
The generated pressure mean: 0.46687546372413635
loss_pred:0.04468988999724388, decouple_loss:0.015979550778865814
Iteration: 335, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46030184626579285
loss_pred:0.04448637738823891, decouple_loss:0.017063982784748077
The generated pressure mean: 0.4605504870414734
loss_pred:0.04721340537071228, decouple_loss:0.01630682311952114
The generated pressure mean: 0.457132488489151
loss_pred:0.04689062386751175, decouple_loss:0.016911061480641365
Iteration: 336, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4306032657623291
loss_pred:0.045600004494190216, decouple_loss:0.01550227776169777
The generated pressure mean: 0.43143022060394287
loss_pred:0.04524679481983185, decouple_loss:0.015927724540233612
The generated pressure mean: 0.4322444796562195
loss_pred:0.047421153634786606, decouple_loss:0.016230689361691475
Iteration: 337, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44213876128196716
loss_pred:0.04461660608649254, decouple_loss:0.018475504592061043
The generated pressure mean: 0.44422462582588196
loss_pred:0.04673714563250542, decouple_loss:0.018245255574584007
The generated pressure mean: 0.4410855174064636
loss_pred:0.04677128791809082, decouple_loss:0.018410610035061836
Iteration: 338, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46668538451194763
loss_pred:0.04701196774840355, decouple_loss:0.015946686267852783
The generated pressure mean: 0.4603002071380615
loss_pred:0.043509457260370255, decouple_loss:0.01586725562810898
The generated pressure mean: 0.4649253189563751
loss_pred:0.04749709367752075, decouple_loss:0.014859667979180813
Iteration: 339, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4434192180633545
loss_pred:0.04694947227835655, decouple_loss:0.017798474058508873
The generated pressure mean: 0.4420924484729767
loss_pred:0.04519348219037056, decouple_loss:0.01779959723353386
The generated pressure mean: 0.4431668817996979
loss_pred:0.04495449364185333, decouple_loss:0.01732352003455162
Iteration: 340, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44489413499832153
loss_pred:0.04358089715242386, decouple_loss:0.016152648255228996
The generated pressure mean: 0.4491165280342102
loss_pred:0.043194763362407684, decouple_loss:0.01709330826997757
The generated pressure mean: 0.4482426941394806
loss_pred:0.04699510708451271, decouple_loss:0.017621910199522972
2023-04-16 02:42:43 testing...
The generated pressure mean: 0.40835830569267273
loss_pred:0.05809710919857025, decouple_loss:0.016907189041376114
The generated pressure mean: 0.40779536962509155
loss_pred:0.05479099974036217, decouple_loss:0.016858963295817375
The generated pressure mean: 0.40951603651046753
loss_pred:0.05620405822992325, decouple_loss:0.01710926927626133
Loss: 0.0572119802236557, avg_mse: 0.06146155670285225
current test mse: 0.061462
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012012_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012012_3_24hr.npz
NaN value num: 0
Iteration: 341, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45084819197654724
loss_pred:0.045460741966962814, decouple_loss:0.016201643273234367
The generated pressure mean: 0.4489928185939789
loss_pred:0.04482276365160942, decouple_loss:0.016671625897288322
The generated pressure mean: 0.4494713544845581
loss_pred:0.04498419538140297, decouple_loss:0.016624003648757935
Iteration: 342, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4388813078403473
loss_pred:0.04468386992812157, decouple_loss:0.015601660124957561
The generated pressure mean: 0.4403042197227478
loss_pred:0.044088639318943024, decouple_loss:0.01597306691110134
The generated pressure mean: 0.44346821308135986
loss_pred:0.04470085725188255, decouple_loss:0.016337800770998
Iteration: 343, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4418732225894928
loss_pred:0.043307457119226456, decouple_loss:0.016251353546977043
The generated pressure mean: 0.4401533603668213
loss_pred:0.04449823126196861, decouple_loss:0.01651247777044773
The generated pressure mean: 0.4441242814064026
loss_pred:0.04447053000330925, decouple_loss:0.017706798389554024
Iteration: 344, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45793694257736206
loss_pred:0.042668722569942474, decouple_loss:0.016010945662856102
The generated pressure mean: 0.4539090692996979
loss_pred:0.04459579661488533, decouple_loss:0.01585215888917446
The generated pressure mean: 0.4559229016304016
loss_pred:0.042161423712968826, decouple_loss:0.01680714637041092
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 345, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4360693395137787
loss_pred:0.04394172504544258, decouple_loss:0.01549470890313387
The generated pressure mean: 0.4368622601032257
loss_pred:0.042999908328056335, decouple_loss:0.01478355098515749
The generated pressure mean: 0.4399818778038025
loss_pred:0.04376993328332901, decouple_loss:0.015232430770993233
Iteration: 346, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4274660348892212
loss_pred:0.044337134808301926, decouple_loss:0.01725802570581436
The generated pressure mean: 0.4269660413265228
loss_pred:0.04455523192882538, decouple_loss:0.01684117503464222
The generated pressure mean: 0.42907285690307617
loss_pred:0.04395517706871033, decouple_loss:0.016558190807700157
Iteration: 347, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4593343138694763
loss_pred:0.044613827019929886, decouple_loss:0.0149613032117486
The generated pressure mean: 0.46054768562316895
loss_pred:0.04536004364490509, decouple_loss:0.014932367950677872
The generated pressure mean: 0.4618922472000122
loss_pred:0.043382469564676285, decouple_loss:0.015430787578225136
Iteration: 348, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45870241522789
loss_pred:0.04493730142712593, decouple_loss:0.015367340296506882
The generated pressure mean: 0.4590887129306793
loss_pred:0.0422976016998291, decouple_loss:0.01511756144464016
The generated pressure mean: 0.46105578541755676
loss_pred:0.04323180764913559, decouple_loss:0.015352326445281506
Iteration: 349, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4259665608406067
loss_pred:0.044548217207193375, decouple_loss:0.01662701554596424The generated pressure mean: 0.4297826588153839
loss_pred:0.04268168285489082, decouple_loss:0.01701863668859005
The generated pressure mean: 0.4273435175418854
loss_pred:0.044663649052381516, decouple_loss:0.017344651743769646
Iteration: 350, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4549095034599304
loss_pred:0.04382242262363434, decouple_loss:0.016798393800854683
The generated pressure mean: 0.45591866970062256
loss_pred:0.04337596520781517, decouple_loss:0.01695472188293934
The generated pressure mean: 0.45499011874198914
loss_pred:0.043753959238529205, decouple_loss:0.01734747923910618
2023-04-16 02:45:19 testing...
The generated pressure mean: 0.4074980318546295
loss_pred:0.05541137978434563, decouple_loss:0.018519120290875435
The generated pressure mean: 0.4066116213798523
loss_pred:0.053574275225400925, decouple_loss:0.019115570932626724
The generated pressure mean: 0.40828847885131836
loss_pred:0.05429143086075783, decouple_loss:0.01954212225973606
Loss: 0.055378641933202744, avg_mse: 0.05948150157928467
current test mse: 0.059482
Iteration: 351, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45509129762649536
The generated pressure mean: 0.4547813832759857
loss_pred:0.042788293212652206, decouple_loss:0.017715418711304665
loss_pred:0.043032608926296234, decouple_loss:0.018823113292455673
The generated pressure mean: 0.45616990327835083
loss_pred:0.04305604472756386, decouple_loss:0.018129071220755577
Iteration: 352, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.42701977491378784
loss_pred:0.04256438836455345, decouple_loss:0.017850365489721298
The generated pressure mean: 0.42775145173072815
The generated pressure mean: 0.42689260840415955
loss_pred:0.04358647018671036, decouple_loss:0.01778397150337696
loss_pred:0.04210633784532547, decouple_loss:0.01764984056353569
Iteration: 353, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4450395107269287
loss_pred:0.0423852764070034, decouple_loss:0.017066705971956253
The generated pressure mean: 0.4442371129989624
loss_pred:0.04319360479712486, decouple_loss:0.01739794760942459
The generated pressure mean: 0.44800689816474915
loss_pred:0.04308133199810982, decouple_loss:0.018104592338204384
Iteration: 354, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4542877674102783
loss_pred:0.04205452278256416, decouple_loss:0.01814640685915947
The generated pressure mean: 0.4536932110786438
loss_pred:0.042525868862867355, decouple_loss:0.01878642663359642
The generated pressure mean: 0.4526146352291107
loss_pred:0.042908597737550735, decouple_loss:0.018843790516257286
Iteration: 355, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44414132833480835
loss_pred:0.0425349622964859, decouple_loss:0.016204478219151497
The generated pressure mean: 0.4412068724632263
loss_pred:0.04316752031445503, decouple_loss:0.015875833109021187
The generated pressure mean: 0.44082242250442505
loss_pred:0.04412432014942169, decouple_loss:0.017233164981007576
Iteration: 356, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44568830728530884
loss_pred:0.042415790259838104, decouple_loss:0.015545117668807507
The generated pressure mean: 0.44345611333847046
loss_pred:0.04226086661219597, decouple_loss:0.015628758817911148
The generated pressure mean: 0.44584718346595764
loss_pred:0.040549833327531815, decouple_loss:0.015780290588736534
Iteration: 357, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.440748929977417
loss_pred:0.043322138488292694, decouple_loss:0.018806217238307
The generated pressure mean: 0.44305872917175293
loss_pred:0.043236590921878815, decouple_loss:0.018473543226718903
The generated pressure mean: 0.4423922896385193
loss_pred:0.04195159673690796, decouple_loss:0.017633777111768723
Iteration: 358, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4644670784473419
loss_pred:0.04346701130270958, decouple_loss:0.017135540023446083
The generated pressure mean: 0.4663931727409363
loss_pred:0.04212101548910141, decouple_loss:0.015683481469750404
The generated pressure mean: 0.46791791915893555
loss_pred:0.04303772374987602, decouple_loss:0.017041627317667007
Iteration: 359, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44067656993865967
loss_pred:0.04143543913960457, decouple_loss:0.016005078330636024
The generated pressure mean: 0.4418513774871826
loss_pred:0.040707651525735855, decouple_loss:0.016063299030065536
The generated pressure mean: 0.43944674730300903
loss_pred:0.042445406317710876, decouple_loss:0.015604238025844097
Iteration: 360, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.444331556558609
loss_pred:0.04459312558174133, decouple_loss:0.016115088015794754
The generated pressure mean: 0.4499552845954895
loss_pred:0.04240845888853073, decouple_loss:0.016835026443004608
The generated pressure mean: 0.44806697964668274
loss_pred:0.04328423738479614, decouple_loss:0.016796015202999115
2023-04-16 02:47:20 testing...
The generated pressure mean: 0.41099539399147034
loss_pred:0.05502515286207199, decouple_loss:0.017291847616434097
The generated pressure mean: 0.4108564853668213
loss_pred:0.053107649087905884, decouple_loss:0.017778147011995316
The generated pressure mean: 0.41273462772369385
loss_pred:0.054310381412506104, decouple_loss:0.017884520813822746
Loss: 0.05503030866384506, avg_mse: 0.05999121442437172
current test mse: 0.059991
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012016_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012016_3_24hr.npz
NaN value num: 0
Iteration: 361, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4470629394054413
loss_pred:0.04517193138599396, decouple_loss:0.016820648685097694
The generated pressure mean: 0.4466663897037506
loss_pred:0.04711974784731865, decouple_loss:0.01716751605272293
The generated pressure mean: 0.4483170211315155
loss_pred:0.04425941780209541, decouple_loss:0.0175853930413723
Iteration: 362, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4404972791671753
loss_pred:0.04618993401527405, decouple_loss:0.01669984869658947
The generated pressure mean: 0.4400615394115448
loss_pred:0.044641923159360886, decouple_loss:0.01690753735601902
The generated pressure mean: 0.4425447881221771
loss_pred:0.04665854200720787, decouple_loss:0.016329476609826088
Iteration: 363, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4865431487560272
loss_pred:0.04547132924199104, decouple_loss:0.01914222724735737
The generated pressure mean: 0.48572540283203125
loss_pred:0.04600532352924347, decouple_loss:0.01785610243678093
The generated pressure mean: 0.48421749472618103
loss_pred:0.045648641884326935, decouple_loss:0.018153542652726173
Iteration: 364, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.39305588603019714
loss_pred:0.04531072452664375, decouple_loss:0.018417567014694214
The generated pressure mean: 0.3944520056247711
loss_pred:0.04362144693732262, decouple_loss:0.01825840026140213
The generated pressure mean: 0.39699864387512207
loss_pred:0.04646189510822296, decouple_loss:0.01799304038286209
Iteration: 365, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45687395334243774
loss_pred:0.0456123948097229, decouple_loss:0.01948261633515358
The generated pressure mean: 0.45823779702186584
loss_pred:0.043082792311906815, decouple_loss:0.01951887272298336
The generated pressure mean: 0.45769578218460083
loss_pred:0.044640399515628815, decouple_loss:0.018587978556752205
Iteration: 366, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4675541818141937
loss_pred:0.04667722433805466, decouple_loss:0.018343206495046616
The generated pressure mean: 0.4676227271556854
loss_pred:0.04511623829603195, decouple_loss:0.018945470452308655
The generated pressure mean: 0.46738287806510925
loss_pred:0.04561356455087662, decouple_loss:0.019195476546883583
Iteration: 367, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44398730993270874
loss_pred:0.04374287277460098, decouple_loss:0.017285345122218132
The generated pressure mean: 0.44439196586608887
loss_pred:0.04211809113621712, decouple_loss:0.017310261726379395
The generated pressure mean: 0.4463045299053192
loss_pred:0.045565418899059296, decouple_loss:0.017127852886915207
Iteration: 368, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44696059823036194
loss_pred:0.04564312845468521, decouple_loss:0.018317723646759987
The generated pressure mean: 0.4476877748966217
loss_pred:0.044611163437366486, decouple_loss:0.018087221309542656
The generated pressure mean: 0.4479854702949524
loss_pred:0.04594077169895172, decouple_loss:0.017523502930998802
Iteration: 369, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.429424911737442
loss_pred:0.0454154796898365, decouple_loss:0.017955999821424484
The generated pressure mean: 0.42973577976226807
loss_pred:0.04499513655900955, decouple_loss:0.016803478822112083
The generated pressure mean: 0.429414838552475
loss_pred:0.04281703755259514, decouple_loss:0.016799040138721466
Iteration: 370, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4744185209274292
loss_pred:0.04440788924694061, decouple_loss:0.01503237709403038
The generated pressure mean: 0.47205379605293274
loss_pred:0.04130766540765762, decouple_loss:0.016753682866692543
The generated pressure mean: 0.4747273325920105
loss_pred:0.04457150772213936, decouple_loss:0.015087038278579712
2023-04-16 02:49:56 testing...
The generated pressure mean: 0.40729036927223206
loss_pred:0.05428457632660866, decouple_loss:0.01658504083752632
The generated pressure mean: 0.4071385860443115
loss_pred:0.05284286290407181, decouple_loss:0.017175745218992233
The generated pressure mean: 0.4088090658187866
loss_pred:0.053844474256038666, decouple_loss:0.01744661293923855
Loss: 0.05451076477766037, avg_mse: 0.059716615825891495
current test mse: 0.059717
Iteration: 371, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45899340510368347
loss_pred:0.041579343378543854, decouple_loss:0.015298469923436642
The generated pressure mean: 0.46032553911209106
loss_pred:0.0420178584754467, decouple_loss:0.015448526479303837
The generated pressure mean: 0.4584330916404724
loss_pred:0.04057330638170242, decouple_loss:0.015474006533622742
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 372, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.40724241733551025
The generated pressure mean: 0.40924951434135437loss_pred:0.04268690571188927, decouple_loss:0.01616496592760086
loss_pred:0.04466564580798149, decouple_loss:0.015618516132235527
The generated pressure mean: 0.40929776430130005
loss_pred:0.04462652653455734, decouple_loss:0.014798993244767189
Iteration: 373, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45448294281959534
loss_pred:0.04375705495476723, decouple_loss:0.01559226680546999
The generated pressure mean: 0.45636168122291565
loss_pred:0.04279385507106781, decouple_loss:0.016366831958293915
The generated pressure mean: 0.4526960253715515
loss_pred:0.04436955600976944, decouple_loss:0.015157978050410748
Iteration: 374, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4721361994743347
loss_pred:0.04319557920098305, decouple_loss:0.014998290687799454
The generated pressure mean: 0.47521868348121643
loss_pred:0.043986976146698, decouple_loss:0.015551644377410412
The generated pressure mean: 0.4746742248535156
loss_pred:0.041533056646585464, decouple_loss:0.015225815586745739
Iteration: 375, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44087332487106323
loss_pred:0.04466823861002922, decouple_loss:0.01412066351622343
The generated pressure mean: 0.4378746449947357
loss_pred:0.04133305698633194, decouple_loss:0.014948821626603603
The generated pressure mean: 0.44023969769477844
loss_pred:0.044583581387996674, decouple_loss:0.014108039438724518
Iteration: 376, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4352352023124695
loss_pred:0.04512198269367218, decouple_loss:0.013948775827884674
The generated pressure mean: 0.43376991152763367
loss_pred:0.041160039603710175, decouple_loss:0.013646923936903477
The generated pressure mean: 0.43549278378486633
loss_pred:0.0442749485373497, decouple_loss:0.013847596943378448
Iteration: 377, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4502725303173065
loss_pred:0.04257141053676605, decouple_loss:0.013847020454704762
The generated pressure mean: 0.4499388635158539
loss_pred:0.043788179755210876, decouple_loss:0.014100340195000172
The generated pressure mean: 0.4498496651649475
loss_pred:0.04366209730505943, decouple_loss:0.013990528881549835
Iteration: 378, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45080679655075073
loss_pred:0.04376595467329025, decouple_loss:0.014402654953300953
The generated pressure mean: 0.45031407475471497
loss_pred:0.041260480880737305, decouple_loss:0.013784055598080158
The generated pressure mean: 0.45017924904823303
loss_pred:0.04377797618508339, decouple_loss:0.013562926091253757
Iteration: 379, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4438362717628479
loss_pred:0.042137354612350464, decouple_loss:0.013892370276153088
The generated pressure mean: 0.4450434446334839
loss_pred:0.044836241751909256, decouple_loss:0.013385502621531487
The generated pressure mean: 0.44541674852371216
loss_pred:0.04299313202500343, decouple_loss:0.014235526323318481
Iteration: 380, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4393194317817688
loss_pred:0.042612213641405106, decouple_loss:0.013510785065591335
The generated pressure mean: 0.43899208307266235
loss_pred:0.0426989421248436, decouple_loss:0.013149535283446312
The generated pressure mean: 0.4385741055011749
loss_pred:0.041927579790353775, decouple_loss:0.014093984849750996
2023-04-16 02:51:56 testing...
The generated pressure mean: 0.410058856010437
loss_pred:0.05452458932995796, decouple_loss:0.014571327716112137
The generated pressure mean: 0.4096609950065613
loss_pred:0.05227290093898773, decouple_loss:0.015322594903409481
The generated pressure mean: 0.4120335876941681
loss_pred:0.053312912583351135, decouple_loss:0.01573972776532173
Loss: 0.05413069576025009, avg_mse: 0.059522844851017
current test mse: 0.059523
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012002_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012002_3_24hr.npz
NaN value num: 0
Iteration: 381, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44943657517433167
loss_pred:0.04209952428936958, decouple_loss:0.013032718561589718
The generated pressure mean: 0.45087677240371704
loss_pred:0.0414486899971962, decouple_loss:0.014098933897912502
The generated pressure mean: 0.4482320249080658
loss_pred:0.042513735592365265, decouple_loss:0.014314313419163227
Iteration: 382, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45129886269569397
loss_pred:0.04204282537102699, decouple_loss:0.015482371672987938
The generated pressure mean: 0.4496922194957733
loss_pred:0.041589219123125076, decouple_loss:0.015803001821041107
The generated pressure mean: 0.44735968112945557
loss_pred:0.04127896949648857, decouple_loss:0.01483369991183281
Iteration: 383, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43636927008628845
loss_pred:0.042275235056877136, decouple_loss:0.01276822853833437
The generated pressure mean: 0.43857860565185547
loss_pred:0.04268406704068184, decouple_loss:0.012915841303765774
The generated pressure mean: 0.43887442350387573
loss_pred:0.042954906821250916, decouple_loss:0.012432018294930458
Iteration: 384, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4618331789970398
The generated pressure mean: 0.4613482654094696
loss_pred:0.04162018746137619, decouple_loss:0.014310736209154129
loss_pred:0.042460013180971146, decouple_loss:0.014601084403693676
The generated pressure mean: 0.46137863397598267
loss_pred:0.04205169528722763, decouple_loss:0.013716453686356544
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 385, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.42620542645454407
loss_pred:0.04246523231267929, decouple_loss:0.014810672961175442
The generated pressure mean: 0.433062881231308
loss_pred:0.04318273440003395, decouple_loss:0.015491165220737457
The generated pressure mean: 0.42815685272216797
loss_pred:0.04403857886791229, decouple_loss:0.014970545656979084
Iteration: 386, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44116824865341187
loss_pred:0.04206935316324234, decouple_loss:0.01655503921210766
The generated pressure mean: 0.43846583366394043
loss_pred:0.0418933667242527, decouple_loss:0.016580916941165924
The generated pressure mean: 0.4407082498073578
loss_pred:0.039524853229522705, decouple_loss:0.016239747405052185
Iteration: 387, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4694984257221222
loss_pred:0.04176771640777588, decouple_loss:0.014831345528364182
The generated pressure mean: 0.47237515449523926
loss_pred:0.04161784052848816, decouple_loss:0.014010774902999401
The generated pressure mean: 0.47089067101478577
loss_pred:0.04318022355437279, decouple_loss:0.014305350370705128
Iteration: 388, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4397592544555664
The generated pressure mean: 0.4430408477783203loss_pred:0.04043981432914734, decouple_loss:0.013722089119255543
loss_pred:0.03945460543036461, decouple_loss:0.013797352090477943
The generated pressure mean: 0.44177454710006714
loss_pred:0.04242615029215813, decouple_loss:0.01327131874859333
Iteration: 389, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.42992138862609863
loss_pred:0.039616141468286514, decouple_loss:0.016227126121520996
The generated pressure mean: 0.43047234416007996
loss_pred:0.03856702893972397, decouple_loss:0.016081439331173897
The generated pressure mean: 0.42943263053894043
loss_pred:0.04365617409348488, decouple_loss:0.01703733205795288
Iteration: 390, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.440140962600708
The generated pressure mean: 0.4409072697162628
loss_pred:0.04134546220302582, decouple_loss:0.016207316890358925
loss_pred:0.04296194389462471, decouple_loss:0.016034157946705818
The generated pressure mean: 0.44032466411590576
loss_pred:0.04297827556729317, decouple_loss:0.016451949253678322
2023-04-16 02:54:33 testing...
The generated pressure mean: 0.40776821970939636
loss_pred:0.05425036698579788, decouple_loss:0.017047392204403877
The generated pressure mean: 0.4081980884075165
loss_pred:0.053197577595710754, decouple_loss:0.01745813712477684
The generated pressure mean: 0.41002869606018066
loss_pred:0.05389556661248207, decouple_loss:0.017552196979522705
Loss: 0.05464880168437958, avg_mse: 0.061085060238838196
current test mse: 0.061085
Iteration: 391, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4637922942638397
The generated pressure mean: 0.4622690975666046loss_pred:0.042806077748537064, decouple_loss:0.016604268923401833
loss_pred:0.043589700013399124, decouple_loss:0.01730641908943653
The generated pressure mean: 0.46605384349823
loss_pred:0.042264483869075775, decouple_loss:0.01708512380719185
Iteration: 392, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44048038125038147
loss_pred:0.04250214993953705, decouple_loss:0.014640462584793568
The generated pressure mean: 0.4417867660522461
loss_pred:0.040423568338155746, decouple_loss:0.01332639716565609
The generated pressure mean: 0.4437040090560913
loss_pred:0.04082992300391197, decouple_loss:0.01347704604268074
Iteration: 393, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4544438123703003
loss_pred:0.04167084023356438, decouple_loss:0.016624970361590385
The generated pressure mean: 0.45363664627075195
loss_pred:0.03989879786968231, decouple_loss:0.016360152512788773
The generated pressure mean: 0.4541991055011749
loss_pred:0.04260649159550667, decouple_loss:0.017046567052602768
Iteration: 394, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4429601728916168
loss_pred:0.0429978147149086, decouple_loss:0.015671273693442345
The generated pressure mean: 0.44407573342323303
loss_pred:0.03949397802352905, decouple_loss:0.016090799123048782
The generated pressure mean: 0.44036832451820374
loss_pred:0.04075915366411209, decouple_loss:0.015777412801980972
Iteration: 395, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.42373761534690857
loss_pred:0.04413605108857155, decouple_loss:0.015593786723911762
The generated pressure mean: 0.42689716815948486
loss_pred:0.043737947940826416, decouple_loss:0.015248818323016167
The generated pressure mean: 0.4248565137386322
loss_pred:0.041767820715904236, decouple_loss:0.015430042520165443
Iteration: 396, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.467232346534729
loss_pred:0.04043382778763771, decouple_loss:0.015495353378355503
The generated pressure mean: 0.4650443494319916
loss_pred:0.04085913673043251, decouple_loss:0.015364838764071465
The generated pressure mean: 0.46609562635421753
loss_pred:0.040416691452264786, decouple_loss:0.015009354799985886
Iteration: 397, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4434037208557129
loss_pred:0.0425109826028347, decouple_loss:0.015676438808441162
The generated pressure mean: 0.4426399767398834
loss_pred:0.0416242852807045, decouple_loss:0.014887411147356033
The generated pressure mean: 0.4457779824733734
loss_pred:0.0421188585460186, decouple_loss:0.01450924389064312
Iteration: 398, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4328678250312805
loss_pred:0.041626520454883575, decouple_loss:0.013743560761213303
The generated pressure mean: 0.4328896701335907
loss_pred:0.0423402413725853, decouple_loss:0.01338997483253479
The generated pressure mean: 0.43500781059265137
loss_pred:0.03984007611870766, decouple_loss:0.013510901480913162
Iteration: 399, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46845734119415283
loss_pred:0.041445787996053696, decouple_loss:0.013513574376702309
The generated pressure mean: 0.46739462018013
loss_pred:0.041666317731142044, decouple_loss:0.013497136533260345
The generated pressure mean: 0.4696362018585205
loss_pred:0.04257398843765259, decouple_loss:0.014834701083600521
Iteration: 400, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4193911850452423
loss_pred:0.042144808918237686, decouple_loss:0.0160694420337677
The generated pressure mean: 0.42326998710632324
loss_pred:0.04176563769578934, decouple_loss:0.015975499525666237
The generated pressure mean: 0.4206027388572693
loss_pred:0.04137135297060013, decouple_loss:0.016397971659898758
2023-04-16 02:56:33 testing...
The generated pressure mean: 0.4045465588569641
loss_pred:0.055032599717378616, decouple_loss:0.015680959448218346
The generated pressure mean: 0.40494781732559204
loss_pred:0.0525502972304821, decouple_loss:0.016254153102636337
The generated pressure mean: 0.40666255354881287
loss_pred:0.054125141352415085, decouple_loss:0.016207436099648476
Loss: 0.05470506101846695, avg_mse: 0.061859581619501114
current test mse: 0.06186
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012004_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012004_3_24hr.npz
NaN value num: 0
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 401, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4759865701198578
loss_pred:0.040781211107969284, decouple_loss:0.017271898686885834
The generated pressure mean: 0.4745948314666748
loss_pred:0.04256995767354965, decouple_loss:0.01474964339286089
The generated pressure mean: 0.475994735956192
loss_pred:0.043118804693222046, decouple_loss:0.015037731267511845
Iteration: 402, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44060027599334717
loss_pred:0.041113413870334625, decouple_loss:0.015283845365047455
The generated pressure mean: 0.43871191143989563
loss_pred:0.04215332865715027, decouple_loss:0.015756774693727493
The generated pressure mean: 0.4410194456577301
loss_pred:0.03967144340276718, decouple_loss:0.015477370470762253
Iteration: 403, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43434062600135803The generated pressure mean: 0.43761783838272095
loss_pred:0.04027444124221802, decouple_loss:0.014500170946121216
loss_pred:0.040712617337703705, decouple_loss:0.01559368520975113
The generated pressure mean: 0.4345044493675232
loss_pred:0.03999876230955124, decouple_loss:0.014334581792354584
Iteration: 404, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45311105251312256
loss_pred:0.04256961867213249, decouple_loss:0.014256772585213184
The generated pressure mean: 0.4547291398048401
loss_pred:0.04183526337146759, decouple_loss:0.013820097781717777
The generated pressure mean: 0.45374563336372375
loss_pred:0.04175610467791557, decouple_loss:0.01386675238609314
Iteration: 405, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4349605441093445
loss_pred:0.04155195504426956, decouple_loss:0.014191015623509884
The generated pressure mean: 0.43346890807151794
loss_pred:0.042229145765304565, decouple_loss:0.014223405160009861
The generated pressure mean: 0.43678396940231323
loss_pred:0.041444920003414154, decouple_loss:0.01383050624281168
Iteration: 406, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4540298581123352
loss_pred:0.04238467290997505, decouple_loss:0.015935536473989487
The generated pressure mean: 0.4539738595485687
loss_pred:0.04264088347554207, decouple_loss:0.016863374039530754
The generated pressure mean: 0.450842946767807
loss_pred:0.04098709672689438, decouple_loss:0.017200201749801636
Iteration: 407, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45330774784088135
loss_pred:0.04010114446282387, decouple_loss:0.013266854919493198
The generated pressure mean: 0.4527060389518738
loss_pred:0.040113698691129684, decouple_loss:0.013370170257985592
The generated pressure mean: 0.4545106887817383
loss_pred:0.042087357491254807, decouple_loss:0.01339121162891388
Iteration: 408, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4239921569824219
loss_pred:0.040477193892002106, decouple_loss:0.014822643250226974
The generated pressure mean: 0.42241403460502625
loss_pred:0.04066932573914528, decouple_loss:0.014312664978206158
The generated pressure mean: 0.42242032289505005
loss_pred:0.041685931384563446, decouple_loss:0.013473176397383213
Iteration: 409, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.450898677110672
loss_pred:0.0426100492477417, decouple_loss:0.013823499903082848
The generated pressure mean: 0.452862411737442
loss_pred:0.04128098860383034, decouple_loss:0.014340591616928577
The generated pressure mean: 0.45145153999328613
loss_pred:0.04025425761938095, decouple_loss:0.014177357777953148
Iteration: 410, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46780848503112793
loss_pred:0.04030223190784454, decouple_loss:0.015385067090392113
The generated pressure mean: 0.4628339111804962
loss_pred:0.0399191677570343, decouple_loss:0.015385553240776062
The generated pressure mean: 0.4667286276817322
loss_pred:0.040787823498249054, decouple_loss:0.01440813671797514
2023-04-16 02:59:11 testing...
The generated pressure mean: 0.4137018620967865
loss_pred:0.053033046424388885, decouple_loss:0.013983359560370445
The generated pressure mean: 0.414289653301239
loss_pred:0.05236999690532684, decouple_loss:0.01466179359704256
The generated pressure mean: 0.4160977303981781
loss_pred:0.05331995338201523, decouple_loss:0.014881443232297897
Loss: 0.053633108735084534, avg_mse: 0.05924496427178383
current test mse: 0.059245
Iteration: 411, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4451288878917694
loss_pred:0.039124686270952225, decouple_loss:0.012804306112229824
The generated pressure mean: 0.4419926106929779
loss_pred:0.0404273122549057, decouple_loss:0.012686447240412235
The generated pressure mean: 0.4440646469593048
loss_pred:0.04208271950483322, decouple_loss:0.012617592699825764
Iteration: 412, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4428046643733978
loss_pred:0.04272106662392616, decouple_loss:0.014908901415765285
The generated pressure mean: 0.4428859353065491
loss_pred:0.042985640466213226, decouple_loss:0.015433835797011852
The generated pressure mean: 0.4438513517379761
loss_pred:0.040016625076532364, decouple_loss:0.014917360618710518
Iteration: 413, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4386455714702606
loss_pred:0.041996393352746964, decouple_loss:0.014990411698818207
The generated pressure mean: 0.4382514953613281
The generated pressure mean: 0.44012773036956787
loss_pred:0.040341347455978394, decouple_loss:0.014631900005042553
loss_pred:0.04170597717165947, decouple_loss:0.014554277993738651
Iteration: 414, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4696919023990631
loss_pred:0.041323672980070114, decouple_loss:0.014018271118402481
The generated pressure mean: 0.4720105826854706
loss_pred:0.040224168449640274, decouple_loss:0.014381026849150658
The generated pressure mean: 0.4687916040420532
loss_pred:0.04046979919075966, decouple_loss:0.014501519501209259
Iteration: 415, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44067031145095825
loss_pred:0.041903842240571976, decouple_loss:0.013354421593248844
The generated pressure mean: 0.43854331970214844
loss_pred:0.04038257896900177, decouple_loss:0.013380699791014194
The generated pressure mean: 0.43372786045074463
loss_pred:0.04191555827856064, decouple_loss:0.013356180861592293
Iteration: 416, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4299379587173462
loss_pred:0.04005755856633186, decouple_loss:0.01272520236670971
The generated pressure mean: 0.42724448442459106
loss_pred:0.03932972252368927, decouple_loss:0.013370729051530361
The generated pressure mean: 0.4262939691543579
loss_pred:0.04028435796499252, decouple_loss:0.014114159159362316
Iteration: 417, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45484182238578796
loss_pred:0.04003692790865898, decouple_loss:0.013605558313429356
The generated pressure mean: 0.4604608416557312
loss_pred:0.040743712335824966, decouple_loss:0.013583984225988388
The generated pressure mean: 0.4566969573497772
loss_pred:0.04188981652259827, decouple_loss:0.013059339486062527
Iteration: 418, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4634398818016052
loss_pred:0.04094429314136505, decouple_loss:0.013587686233222485
The generated pressure mean: 0.46611231565475464
loss_pred:0.04094947874546051, decouple_loss:0.013330221176147461
The generated pressure mean: 0.46396520733833313
loss_pred:0.04041455313563347, decouple_loss:0.013312011957168579
Iteration: 419, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.42168137431144714
loss_pred:0.03973175957798958, decouple_loss:0.01264344621449709
The generated pressure mean: 0.4205438792705536
loss_pred:0.04121272265911102, decouple_loss:0.012520406395196915
The generated pressure mean: 0.42295771837234497
loss_pred:0.03986773267388344, decouple_loss:0.012624580413103104
Iteration: 420, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4360448122024536
loss_pred:0.04033707082271576, decouple_loss:0.012849504128098488
The generated pressure mean: 0.4418448805809021
loss_pred:0.040914762765169144, decouple_loss:0.012151372618973255
The generated pressure mean: 0.4412653148174286
loss_pred:0.04027145355939865, decouple_loss:0.013065546751022339
2023-04-16 03:01:11 testing...
The generated pressure mean: 0.40597453713417053
loss_pred:0.05343678966164589, decouple_loss:0.012911899015307426
The generated pressure mean: 0.4067844748497009
loss_pred:0.051867276430130005, decouple_loss:0.013429219834506512
The generated pressure mean: 0.40893152356147766
loss_pred:0.05239395797252655, decouple_loss:0.013863288797438145
Loss: 0.05323608219623566, avg_mse: 0.06011229008436203
current test mse: 0.060112
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012003_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012003_3_24hr.npz
NaN value num: 0
Iteration: 421, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.47478482127189636
loss_pred:0.0403096079826355, decouple_loss:0.012875236570835114
The generated pressure mean: 0.47546887397766113
loss_pred:0.04101599380373955, decouple_loss:0.013253443874418736
The generated pressure mean: 0.47531354427337646
loss_pred:0.04232620447874069, decouple_loss:0.013072785921394825
Iteration: 422, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4526849389076233
The generated pressure mean: 0.45218899846076965
loss_pred:0.04098561033606529, decouple_loss:0.013267152942717075
loss_pred:0.04135510325431824, decouple_loss:0.014733743853867054
The generated pressure mean: 0.45073574781417847
loss_pred:0.03914260119199753, decouple_loss:0.01269124262034893
Iteration: 423, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43047037720680237
loss_pred:0.04142151400446892, decouple_loss:0.013797348365187645
The generated pressure mean: 0.4286312758922577
The generated pressure mean: 0.4307854175567627
loss_pred:0.04015406593680382, decouple_loss:0.011382341384887695
loss_pred:0.04095001146197319, decouple_loss:0.011818100698292255
Iteration: 424, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46019619703292847
loss_pred:0.04119136556982994, decouple_loss:0.013257544487714767
The generated pressure mean: 0.45799317955970764
loss_pred:0.042355019599199295, decouple_loss:0.01362637709826231
The generated pressure mean: 0.4624594748020172
loss_pred:0.04367000609636307, decouple_loss:0.01309895608574152
Iteration: 425, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4621202051639557
The generated pressure mean: 0.4570428729057312loss_pred:0.040122974663972855, decouple_loss:0.01283856388181448
loss_pred:0.04015984758734703, decouple_loss:0.0122655825689435
The generated pressure mean: 0.45940086245536804
loss_pred:0.039285119622945786, decouple_loss:0.013085613027215004
Iteration: 426, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4437522292137146
loss_pred:0.041757117956876755, decouple_loss:0.013001460582017899
The generated pressure mean: 0.4380625784397125
loss_pred:0.039832595735788345, decouple_loss:0.012426572851836681
The generated pressure mean: 0.43579792976379395
loss_pred:0.04188036173582077, decouple_loss:0.013004872016608715
Iteration: 427, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4520963132381439
loss_pred:0.041896622627973557, decouple_loss:0.012844685465097427
The generated pressure mean: 0.4566226005554199
loss_pred:0.04115604609251022, decouple_loss:0.012668967247009277
The generated pressure mean: 0.45225754380226135
loss_pred:0.04031514748930931, decouple_loss:0.013212429359555244
Iteration: 428, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.445222944021225
loss_pred:0.04070080816745758, decouple_loss:0.013542999513447285
The generated pressure mean: 0.4445854723453522
loss_pred:0.040846291929483414, decouple_loss:0.013778290711343288
The generated pressure mean: 0.4408681392669678
loss_pred:0.038660190999507904, decouple_loss:0.013490037061274052
Iteration: 429, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4503507614135742
loss_pred:0.039411310106515884, decouple_loss:0.01191010046750307
The generated pressure mean: 0.45150333642959595
loss_pred:0.04113610461354256, decouple_loss:0.012501213699579239
The generated pressure mean: 0.4501529335975647
loss_pred:0.03988032415509224, decouple_loss:0.011744110845029354
Iteration: 430, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44403746724128723
loss_pred:0.040184181183576584, decouple_loss:0.012871031649410725
The generated pressure mean: 0.44236859679222107
loss_pred:0.04036709666252136, decouple_loss:0.013076089322566986
The generated pressure mean: 0.44218766689300537
loss_pred:0.040065914392471313, decouple_loss:0.012692879885435104
2023-04-16 03:03:46 testing...
The generated pressure mean: 0.4135892987251282
loss_pred:0.051807910203933716, decouple_loss:0.012742552906274796
The generated pressure mean: 0.4142511188983917
loss_pred:0.05069327354431152, decouple_loss:0.013281669467687607
The generated pressure mean: 0.4166562855243683
loss_pred:0.05101294443011284, decouple_loss:0.014036591164767742
Loss: 0.051839061081409454, avg_mse: 0.058106884360313416
current test mse: 0.058107
Iteration: 431, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44965529441833496
loss_pred:0.04169311374425888, decouple_loss:0.011694015935063362
The generated pressure mean: 0.4494437277317047
loss_pred:0.040289171040058136, decouple_loss:0.012269481085240841
The generated pressure mean: 0.4519158899784088
loss_pred:0.040361206978559494, decouple_loss:0.011578122153878212
Iteration: 432, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45491260290145874
loss_pred:0.041209105402231216, decouple_loss:0.013529021292924881
The generated pressure mean: 0.44782450795173645
The generated pressure mean: 0.4476219117641449loss_pred:0.041118599474430084, decouple_loss:0.012822684831917286
loss_pred:0.04088739678263664, decouple_loss:0.014606518670916557
Iteration: 433, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44229644536972046
loss_pred:0.04026401415467262, decouple_loss:0.013387355022132397
The generated pressure mean: 0.4389496445655823
loss_pred:0.03940070793032646, decouple_loss:0.012359388172626495
The generated pressure mean: 0.4438079297542572
loss_pred:0.03975773975253105, decouple_loss:0.012865864671766758
Iteration: 434, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4469482898712158
loss_pred:0.03973662108182907, decouple_loss:0.012891871854662895
The generated pressure mean: 0.4468117952346802
loss_pred:0.03937250375747681, decouple_loss:0.012695456854999065
The generated pressure mean: 0.4470004141330719
loss_pred:0.039848122745752335, decouple_loss:0.013961182907223701
Iteration: 435, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46154963970184326
loss_pred:0.039986513555049896, decouple_loss:0.012813452631235123
The generated pressure mean: 0.46404531598091125
loss_pred:0.04117269814014435, decouple_loss:0.01243538036942482
The generated pressure mean: 0.45981648564338684
loss_pred:0.03886771574616432, decouple_loss:0.011751807294785976
Iteration: 436, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4429450035095215
loss_pred:0.040732480585575104, decouple_loss:0.01250398252159357
The generated pressure mean: 0.44025471806526184
loss_pred:0.04040857031941414, decouple_loss:0.012922201305627823
The generated pressure mean: 0.44160565733909607
loss_pred:0.040969911962747574, decouple_loss:0.012365763075649738
Iteration: 437, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44829320907592773
loss_pred:0.04145560413599014, decouple_loss:0.012981699779629707
The generated pressure mean: 0.4456254243850708
loss_pred:0.03951120004057884, decouple_loss:0.011915965005755424
The generated pressure mean: 0.4459030330181122
loss_pred:0.039954837411642075, decouple_loss:0.012669112533330917
Iteration: 438, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44262510538101196
loss_pred:0.038374099880456924, decouple_loss:0.01270447950810194
The generated pressure mean: 0.44195520877838135
loss_pred:0.04017122462391853, decouple_loss:0.014535821042954922
The generated pressure mean: 0.43971067667007446
loss_pred:0.038468003273010254, decouple_loss:0.013258012942969799
Iteration: 439, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45822080969810486
loss_pred:0.03985481336712837, decouple_loss:0.013697545975446701
The generated pressure mean: 0.45577195286750793
loss_pred:0.03919585794210434, decouple_loss:0.013243649154901505
The generated pressure mean: 0.4566073417663574
loss_pred:0.04000791534781456, decouple_loss:0.01388502586632967
Iteration: 440, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44282621145248413
loss_pred:0.03874337300658226, decouple_loss:0.01251903548836708
The generated pressure mean: 0.44465041160583496
loss_pred:0.040129341185092926, decouple_loss:0.012311408296227455
The generated pressure mean: 0.4448200762271881
loss_pred:0.04045504704117775, decouple_loss:0.012089652940630913
2023-04-16 03:05:47 testing...
The generated pressure mean: 0.41425979137420654
loss_pred:0.05225842446088791, decouple_loss:0.013317108154296875
The generated pressure mean: 0.41564732789993286
loss_pred:0.0497911311686039, decouple_loss:0.013600409962236881
The generated pressure mean: 0.4188673496246338
loss_pred:0.050353534519672394, decouple_loss:0.014154236763715744
Loss: 0.051485560834407806, avg_mse: 0.05777488648891449
current test mse: 0.057775
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012008_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012008_3_24hr.npz
NaN value num: 0
Iteration: 441, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44825971126556396
loss_pred:0.039666056632995605, decouple_loss:0.012895690277218819
The generated pressure mean: 0.4488195478916168
loss_pred:0.042146436870098114, decouple_loss:0.013796322979032993
The generated pressure mean: 0.448215514421463
loss_pred:0.03993241861462593, decouple_loss:0.014378013089299202
Iteration: 442, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.42185014486312866
loss_pred:0.04146320000290871, decouple_loss:0.012720157392323017
The generated pressure mean: 0.4248991310596466
loss_pred:0.0403711162507534, decouple_loss:0.012987188063561916
The generated pressure mean: 0.42524993419647217
loss_pred:0.041990481317043304, decouple_loss:0.01374091301113367
Iteration: 443, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4680120348930359
loss_pred:0.04102866351604462, decouple_loss:0.013526847586035728
The generated pressure mean: 0.46749427914619446
loss_pred:0.04125899821519852, decouple_loss:0.01244825217872858
The generated pressure mean: 0.46563535928726196
loss_pred:0.04025641083717346, decouple_loss:0.012429848313331604
Iteration: 444, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4053654670715332
loss_pred:0.04111422598361969, decouple_loss:0.019144903868436813
The generated pressure mean: 0.40987738966941833
loss_pred:0.04010460525751114, decouple_loss:0.017230765894055367
The generated pressure mean: 0.41097912192344666
loss_pred:0.04036678001284599, decouple_loss:0.017397316172719002
Iteration: 445, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.5103906393051147
loss_pred:0.04282741993665695, decouple_loss:0.014944588765501976
The generated pressure mean: 0.5158649682998657
loss_pred:0.04474081099033356, decouple_loss:0.01554794330149889
The generated pressure mean: 0.5075960755348206
loss_pred:0.04354386404156685, decouple_loss:0.014799733646214008
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 446, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.36934247612953186
loss_pred:0.04655638337135315, decouple_loss:0.022512877359986305
The generated pressure mean: 0.3657502233982086
loss_pred:0.045559801161289215, decouple_loss:0.02292412891983986
The generated pressure mean: 0.3645276427268982
loss_pred:0.046593084931373596, decouple_loss:0.0231940895318985
Iteration: 447, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4819241762161255
loss_pred:0.044832129031419754, decouple_loss:0.018785975873470306
The generated pressure mean: 0.48232072591781616
loss_pred:0.04214014112949371, decouple_loss:0.01843462884426117
The generated pressure mean: 0.4810706675052643
loss_pred:0.0428396575152874, decouple_loss:0.01908760890364647
Iteration: 448, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.5269814133644104
loss_pred:0.04137369245290756, decouple_loss:0.017466768622398376
The generated pressure mean: 0.528682291507721
loss_pred:0.042601943016052246, decouple_loss:0.0174923874437809
The generated pressure mean: 0.5253467559814453
loss_pred:0.0418693870306015, decouple_loss:0.01709521748125553
Iteration: 449, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45213761925697327
loss_pred:0.04189242422580719, decouple_loss:0.017290549352765083The generated pressure mean: 0.4504570960998535
loss_pred:0.04220488667488098, decouple_loss:0.018159111961722374
The generated pressure mean: 0.45153385400772095
loss_pred:0.04136699438095093, decouple_loss:0.01695387437939644
Iteration: 450, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.36367297172546387
loss_pred:0.04291989654302597, decouple_loss:0.017336098477244377
The generated pressure mean: 0.3672938942909241
loss_pred:0.042722925543785095, decouple_loss:0.01798922009766102
The generated pressure mean: 0.36434102058410645
loss_pred:0.0420287624001503, decouple_loss:0.01802978850901127
2023-04-16 03:08:27 testing...
The generated pressure mean: 0.4213290214538574
loss_pred:0.05388011783361435, decouple_loss:0.016308365389704704
The generated pressure mean: 0.421342670917511
loss_pred:0.051806457340717316, decouple_loss:0.0170521829277277
The generated pressure mean: 0.42349565029144287
loss_pred:0.05326051637530327, decouple_loss:0.01730997860431671
Loss: 0.05382687598466873, avg_mse: 0.059202902019023895
current test mse: 0.059203
Iteration: 451, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4070959985256195
loss_pred:0.041354093700647354, decouple_loss:0.016118576750159264
The generated pressure mean: 0.4088449776172638
loss_pred:0.042284682393074036, decouple_loss:0.015653392300009727
The generated pressure mean: 0.4107183814048767
loss_pred:0.042360544204711914, decouple_loss:0.01631978340446949
Iteration: 452, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.48931190371513367
loss_pred:0.040077097713947296, decouple_loss:0.01681198924779892
The generated pressure mean: 0.493230402469635
loss_pred:0.04191805049777031, decouple_loss:0.017251141369342804
The generated pressure mean: 0.49226245284080505
loss_pred:0.04045996069908142, decouple_loss:0.01684708148241043
Iteration: 453, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.49973413348197937
loss_pred:0.0421525202691555, decouple_loss:0.01777797006070614
The generated pressure mean: 0.4999758005142212
loss_pred:0.041888799518346786, decouple_loss:0.01650962047278881
The generated pressure mean: 0.5001646876335144
loss_pred:0.040718529373407364, decouple_loss:0.01782231591641903
Iteration: 454, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4561522603034973
loss_pred:0.03984890878200531, decouple_loss:0.01673290506005287
The generated pressure mean: 0.4535103142261505
loss_pred:0.04147642105817795, decouple_loss:0.01660568080842495
The generated pressure mean: 0.45674973726272583
loss_pred:0.0404617115855217, decouple_loss:0.016429241746664047
Iteration: 455, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.420160174369812
loss_pred:0.040093742311000824, decouple_loss:0.017540473490953445
The generated pressure mean: 0.42114904522895813
loss_pred:0.04127618297934532, decouple_loss:0.018139934167265892
The generated pressure mean: 0.4214805066585541
loss_pred:0.03903482109308243, decouple_loss:0.016561493277549744
Iteration: 456, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4233092963695526
loss_pred:0.04129182919859886, decouple_loss:0.015551168471574783
The generated pressure mean: 0.4264783263206482
loss_pred:0.040504127740859985, decouple_loss:0.016047175973653793
The generated pressure mean: 0.425321102142334
loss_pred:0.04198891296982765, decouple_loss:0.016248859465122223
Iteration: 457, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44841375946998596
loss_pred:0.037867654114961624, decouple_loss:0.018060116097331047
The generated pressure mean: 0.4469279646873474
loss_pred:0.040134068578481674, decouple_loss:0.01615007035434246
The generated pressure mean: 0.4503595530986786
loss_pred:0.03801652416586876, decouple_loss:0.01781519502401352
Iteration: 458, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45790091156959534
loss_pred:0.04157416522502899, decouple_loss:0.014495192095637321
The generated pressure mean: 0.45783212780952454
loss_pred:0.03828831762075424, decouple_loss:0.014862485229969025
The generated pressure mean: 0.4560443162918091
loss_pred:0.038647908717393875, decouple_loss:0.0151117704808712
Iteration: 459, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4590883255004883
loss_pred:0.039480552077293396, decouple_loss:0.017442822456359863
The generated pressure mean: 0.4570862352848053
loss_pred:0.043591342866420746, decouple_loss:0.018719440326094627
The generated pressure mean: 0.45711731910705566
loss_pred:0.041245486587285995, decouple_loss:0.01727033406496048
Iteration: 460, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4491647779941559
loss_pred:0.039139047265052795, decouple_loss:0.014426256529986858
The generated pressure mean: 0.4486624300479889
loss_pred:0.04198119416832924, decouple_loss:0.014177137985825539
The generated pressure mean: 0.4502466320991516
loss_pred:0.03944169729948044, decouple_loss:0.013790746219456196
2023-04-16 03:10:28 testing...
The generated pressure mean: 0.4152197539806366
loss_pred:0.05279937759041786, decouple_loss:0.01765263080596924
The generated pressure mean: 0.4150666296482086
loss_pred:0.05180314928293228, decouple_loss:0.017706284299492836
The generated pressure mean: 0.4170752465724945
loss_pred:0.05234179645776749, decouple_loss:0.0183721873909235
Loss: 0.0532102957367897, avg_mse: 0.05963946506381035
current test mse: 0.059639
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012014_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012014_3_24hr.npz
NaN value num: 0
Iteration: 461, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4354828894138336
loss_pred:0.040837883949279785, decouple_loss:0.017923397943377495
The generated pressure mean: 0.4358891248703003
loss_pred:0.04245414957404137, decouple_loss:0.018016492947936058
The generated pressure mean: 0.43581700325012207
loss_pred:0.04221475496888161, decouple_loss:0.017757335677742958
Iteration: 462, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4302881062030792
loss_pred:0.03940611332654953, decouple_loss:0.014244474470615387
The generated pressure mean: 0.42913293838500977
loss_pred:0.03971631079912186, decouple_loss:0.01401110365986824
The generated pressure mean: 0.4313465356826782
loss_pred:0.042570196092128754, decouple_loss:0.015184054151177406
Iteration: 463, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44503816962242126
loss_pred:0.04213760793209076, decouple_loss:0.01681472733616829
The generated pressure mean: 0.44828367233276367
loss_pred:0.0423724390566349, decouple_loss:0.017393890768289566
The generated pressure mean: 0.4454745948314667
loss_pred:0.04173944517970085, decouple_loss:0.01736488565802574
Iteration: 464, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45372140407562256
loss_pred:0.04002077504992485, decouple_loss:0.0153588205575943
The generated pressure mean: 0.4587661027908325
loss_pred:0.040723979473114014, decouple_loss:0.014385729096829891
The generated pressure mean: 0.4578988552093506
loss_pred:0.04246632009744644, decouple_loss:0.014752316288650036
Iteration: 465, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4540041387081146
loss_pred:0.04109550267457962, decouple_loss:0.016609998419880867
The generated pressure mean: 0.4509614109992981
loss_pred:0.04031200706958771, decouple_loss:0.016750289127230644
The generated pressure mean: 0.45164358615875244
loss_pred:0.03910737484693527, decouple_loss:0.016602855175733566
Iteration: 466, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.446723073720932
loss_pred:0.03936520963907242, decouple_loss:0.014064540155231953
The generated pressure mean: 0.4482766389846802
loss_pred:0.03814267739653587, decouple_loss:0.014043563045561314
The generated pressure mean: 0.44814184308052063
loss_pred:0.040535006672143936, decouple_loss:0.014506214298307896
Iteration: 467, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4457736611366272
loss_pred:0.041648924350738525, decouple_loss:0.015855219215154648
The generated pressure mean: 0.4463544189929962
loss_pred:0.041316334158182144, decouple_loss:0.017591742798686028
The generated pressure mean: 0.4441160261631012
loss_pred:0.04044128954410553, decouple_loss:0.016345100477337837
Iteration: 468, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44407781958580017
loss_pred:0.0420546792447567, decouple_loss:0.014752039685845375
The generated pressure mean: 0.44145238399505615
loss_pred:0.0393129363656044, decouple_loss:0.014353619888424873
The generated pressure mean: 0.4413508176803589
loss_pred:0.039368756115436554, decouple_loss:0.014240598306059837
Iteration: 469, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44180557131767273
loss_pred:0.04092390835285187, decouple_loss:0.016830705106258392
The generated pressure mean: 0.4452199637889862
loss_pred:0.04129635915160179, decouple_loss:0.01660286635160446
The generated pressure mean: 0.4439823627471924
loss_pred:0.04164222627878189, decouple_loss:0.01674060896039009
Iteration: 470, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4536944329738617
loss_pred:0.04084010794758797, decouple_loss:0.014702283777296543
The generated pressure mean: 0.45179182291030884
loss_pred:0.04137791693210602, decouple_loss:0.014956641010940075
The generated pressure mean: 0.4524872899055481
loss_pred:0.041104916483163834, decouple_loss:0.015089021995663643
2023-04-16 03:13:03 testing...
The generated pressure mean: 0.40864142775535583
loss_pred:0.052041225135326385, decouple_loss:0.016130177304148674
The generated pressure mean: 0.40884721279144287
loss_pred:0.050584569573402405, decouple_loss:0.016496717929840088
The generated pressure mean: 0.4113558530807495
loss_pred:0.051723089069128036, decouple_loss:0.01687006838619709
Loss: 0.05227458104491234, avg_mse: 0.05838756635785103
current test mse: 0.058388
Iteration: 471, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46256551146507263
loss_pred:0.03935827687382698, decouple_loss:0.016386203467845917
The generated pressure mean: 0.4606989622116089
loss_pred:0.03913776949048042, decouple_loss:0.015733949840068817
The generated pressure mean: 0.45894545316696167
loss_pred:0.03944399952888489, decouple_loss:0.01744096726179123
Iteration: 472, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4506455659866333
loss_pred:0.04065486043691635, decouple_loss:0.015590542927384377
The generated pressure mean: 0.4491257071495056
loss_pred:0.04109469801187515, decouple_loss:0.014745996333658695
The generated pressure mean: 0.45254117250442505
loss_pred:0.04142727330327034, decouple_loss:0.01502066757529974
Iteration: 473, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4377967417240143
loss_pred:0.040853384882211685, decouple_loss:0.015080558136105537
The generated pressure mean: 0.4414357841014862
loss_pred:0.040946319699287415, decouple_loss:0.014984254725277424
The generated pressure mean: 0.43774929642677307
loss_pred:0.04042312502861023, decouple_loss:0.014472025446593761
Iteration: 474, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4468480348587036
loss_pred:0.04142950102686882, decouple_loss:0.01615041121840477
The generated pressure mean: 0.4436451494693756
loss_pred:0.03833262249827385, decouple_loss:0.015742473304271698
The generated pressure mean: 0.4437834620475769
loss_pred:0.04029420390725136, decouple_loss:0.016856610774993896
Iteration: 475, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44916579127311707
loss_pred:0.04093832150101662, decouple_loss:0.013121911324560642
The generated pressure mean: 0.44717520475387573
loss_pred:0.04068956896662712, decouple_loss:0.013578190468251705
The generated pressure mean: 0.4485633075237274
loss_pred:0.03914548456668854, decouple_loss:0.013415713794529438
Iteration: 476, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4423270523548126
The generated pressure mean: 0.4436286985874176
loss_pred:0.03800397366285324, decouple_loss:0.016337040811777115
loss_pred:0.038311924785375595, decouple_loss:0.01697692461311817
The generated pressure mean: 0.4456157386302948
loss_pred:0.039803460240364075, decouple_loss:0.017719736322760582
Iteration: 477, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44343727827072144
The generated pressure mean: 0.441829651594162
loss_pred:0.04008738696575165, decouple_loss:0.01307691354304552
loss_pred:0.039977576583623886, decouple_loss:0.014029616490006447
The generated pressure mean: 0.4439834654331207
loss_pred:0.04120670258998871, decouple_loss:0.013158652931451797
Iteration: 478, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45035693049430847
loss_pred:0.03904194012284279, decouple_loss:0.016541827470064163
The generated pressure mean: 0.44984200596809387
loss_pred:0.038926705718040466, decouple_loss:0.0161769837141037
The generated pressure mean: 0.4467805325984955
loss_pred:0.03956163302063942, decouple_loss:0.016915783286094666
Iteration: 479, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45116326212882996
loss_pred:0.040602706372737885, decouple_loss:0.013696643523871899
The generated pressure mean: 0.45138585567474365
loss_pred:0.03993329033255577, decouple_loss:0.01454382948577404
The generated pressure mean: 0.4499623477458954
loss_pred:0.040154144167900085, decouple_loss:0.014429008588194847
Iteration: 480, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45002561807632446
The generated pressure mean: 0.4506162405014038
loss_pred:0.0403924398124218, decouple_loss:0.01589507982134819
loss_pred:0.03856717050075531, decouple_loss:0.016550302505493164
The generated pressure mean: 0.44724538922309875
loss_pred:0.040447793900966644, decouple_loss:0.01652853563427925
2023-04-16 03:15:04 testing...
The generated pressure mean: 0.4151076674461365
loss_pred:0.05084925517439842, decouple_loss:0.01494030561298132
The generated pressure mean: 0.41631805896759033
loss_pred:0.04918190836906433, decouple_loss:0.014971037395298481
The generated pressure mean: 0.4192226827144623
loss_pred:0.05031580850481987, decouple_loss:0.015270732343196869
Loss: 0.0508686900138855, avg_mse: 0.05758829414844513
current test mse: 0.057588
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012017_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012017_3_24hr.npz
NaN value num: 0
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 481, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4427216053009033
loss_pred:0.03975120931863785, decouple_loss:0.01470922864973545
The generated pressure mean: 0.441705584526062
loss_pred:0.039359211921691895, decouple_loss:0.014592057093977928
The generated pressure mean: 0.444351464509964
loss_pred:0.039578478783369064, decouple_loss:0.013927235268056393
Iteration: 482, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43602463603019714
loss_pred:0.039281103760004044, decouple_loss:0.016851238906383514
The generated pressure mean: 0.4391573369503021
loss_pred:0.04024026542901993, decouple_loss:0.01596970669925213
The generated pressure mean: 0.43819957971572876
loss_pred:0.03812248259782791, decouple_loss:0.016466910019516945
Iteration: 483, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43791115283966064
loss_pred:0.039208266884088516, decouple_loss:0.015392622910439968
The generated pressure mean: 0.4391581416130066
loss_pred:0.03919190913438797, decouple_loss:0.015035020187497139
The generated pressure mean: 0.4391763210296631
loss_pred:0.040641553699970245, decouple_loss:0.01550424937158823
Iteration: 484, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45137766003608704
loss_pred:0.04038623347878456, decouple_loss:0.01537046767771244
The generated pressure mean: 0.4525642991065979
loss_pred:0.03795289620757103, decouple_loss:0.015535729937255383
The generated pressure mean: 0.44806501269340515
loss_pred:0.03962547704577446, decouple_loss:0.01541199441999197
Iteration: 485, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4544961750507355
loss_pred:0.03841487318277359, decouple_loss:0.01570453867316246
The generated pressure mean: 0.45364534854888916
loss_pred:0.04076506942510605, decouple_loss:0.01556701585650444
The generated pressure mean: 0.45415961742401123
loss_pred:0.03923065960407257, decouple_loss:0.016307422891259193
Iteration: 486, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45079678297042847
loss_pred:0.03798674792051315, decouple_loss:0.014716485515236855
The generated pressure mean: 0.45375287532806396
loss_pred:0.03912011906504631, decouple_loss:0.01511572115123272
The generated pressure mean: 0.44918593764305115
loss_pred:0.03820761293172836, decouple_loss:0.014416142366826534
Iteration: 487, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44285255670547485
loss_pred:0.040268633514642715, decouple_loss:0.015888961032032967
The generated pressure mean: 0.4438026249408722
loss_pred:0.03905009105801582, decouple_loss:0.015851551666855812
The generated pressure mean: 0.4440367519855499
loss_pred:0.03907674178481102, decouple_loss:0.01541141327470541
Iteration: 488, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43902283906936646
loss_pred:0.03794948384165764, decouple_loss:0.013193974271416664
The generated pressure mean: 0.44044870138168335
loss_pred:0.039803896099328995, decouple_loss:0.013370777480304241
The generated pressure mean: 0.44039496779441833
loss_pred:0.038322314620018005, decouple_loss:0.014154222793877125
Iteration: 489, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4444851875305176
loss_pred:0.038524169474840164, decouple_loss:0.015164319425821304
The generated pressure mean: 0.44611144065856934
loss_pred:0.036872874945402145, decouple_loss:0.014905022457242012
The generated pressure mean: 0.4454606771469116
loss_pred:0.03942336514592171, decouple_loss:0.015185718424618244
Iteration: 490, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4502895772457123
loss_pred:0.03933059051632881, decouple_loss:0.013172031380236149
The generated pressure mean: 0.45431023836135864
loss_pred:0.03871934115886688, decouple_loss:0.014055958017706871
The generated pressure mean: 0.45314642786979675
loss_pred:0.03944723680615425, decouple_loss:0.012972026132047176
2023-04-16 03:17:45 testing...
The generated pressure mean: 0.4162422716617584
loss_pred:0.04976223036646843, decouple_loss:0.016240324825048447
The generated pressure mean: 0.41738417744636536
loss_pred:0.04951930418610573, decouple_loss:0.016765158623456955
The generated pressure mean: 0.4206051528453827
loss_pred:0.0502840094268322, decouple_loss:0.01708042621612549
Loss: 0.050689946860075, avg_mse: 0.056972771883010864
current test mse: 0.056973
Iteration: 491, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44899478554725647
loss_pred:0.04018853232264519, decouple_loss:0.015277057886123657
The generated pressure mean: 0.4437178373336792
loss_pred:0.039003051817417145, decouple_loss:0.015453323721885681
The generated pressure mean: 0.4446357488632202
loss_pred:0.038984015583992004, decouple_loss:0.01610318012535572
Iteration: 492, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4524937868118286
loss_pred:0.039138369262218475, decouple_loss:0.013787404634058475
The generated pressure mean: 0.4518655240535736
The generated pressure mean: 0.45285099744796753loss_pred:0.03837186098098755, decouple_loss:0.013741817325353622
loss_pred:0.038917284458875656, decouple_loss:0.0144125297665596
Iteration: 493, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45154744386672974
loss_pred:0.03846772387623787, decouple_loss:0.015817316249012947
The generated pressure mean: 0.453410267829895
loss_pred:0.03767284378409386, decouple_loss:0.01560179889202118
The generated pressure mean: 0.45268264412879944
loss_pred:0.03813576698303223, decouple_loss:0.01652616262435913
Iteration: 494, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4480530619621277
loss_pred:0.03758785501122475, decouple_loss:0.014133465476334095
The generated pressure mean: 0.45037195086479187
loss_pred:0.03918495774269104, decouple_loss:0.014402398839592934
The generated pressure mean: 0.4494155943393707
loss_pred:0.0397370271384716, decouple_loss:0.013746192678809166
Iteration: 495, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4378542900085449
loss_pred:0.03865080699324608, decouple_loss:0.015774253755807877
The generated pressure mean: 0.43649059534072876
loss_pred:0.0389249362051487, decouple_loss:0.015505559742450714
The generated pressure mean: 0.4365595877170563
loss_pred:0.03854679688811302, decouple_loss:0.015183866955339909
Iteration: 496, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4461399018764496
loss_pred:0.03926561027765274, decouple_loss:0.014130264520645142
The generated pressure mean: 0.44472166895866394
loss_pred:0.03838852047920227, decouple_loss:0.014603853225708008
The generated pressure mean: 0.44288310408592224
loss_pred:0.03770748898386955, decouple_loss:0.01498978678137064
Iteration: 497, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4513568580150604
loss_pred:0.0380307137966156, decouple_loss:0.014219384640455246
The generated pressure mean: 0.45377403497695923
loss_pred:0.03810460492968559, decouple_loss:0.014755116775631905
The generated pressure mean: 0.4570808708667755
loss_pred:0.03867281973361969, decouple_loss:0.014971067197620869
Iteration: 498, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45034900307655334
loss_pred:0.03682710602879524, decouple_loss:0.013787629082798958
The generated pressure mean: 0.4488495886325836
loss_pred:0.03750446438789368, decouple_loss:0.013785514049232006
The generated pressure mean: 0.4502284526824951
loss_pred:0.03876267001032829, decouple_loss:0.013941720128059387
Iteration: 499, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4428126811981201
loss_pred:0.03738398104906082, decouple_loss:0.01622806489467621
The generated pressure mean: 0.43908047676086426
loss_pred:0.037972595542669296, decouple_loss:0.01576046459376812
The generated pressure mean: 0.443538635969162
loss_pred:0.03940524160861969, decouple_loss:0.016072960570454597
Iteration: 500, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4391780197620392
loss_pred:0.037962961941957474, decouple_loss:0.014162824489176273
The generated pressure mean: 0.4397251009941101
loss_pred:0.03927943855524063, decouple_loss:0.01375426072627306
The generated pressure mean: 0.4375078082084656
loss_pred:0.03820258006453514, decouple_loss:0.014229599386453629
2023-04-16 03:19:46 testing...
The generated pressure mean: 0.41503286361694336
loss_pred:0.049385007470846176, decouple_loss:0.015830760821700096
The generated pressure mean: 0.4167056381702423
loss_pred:0.04845597594976425, decouple_loss:0.01623459719121456
The generated pressure mean: 0.4202467203140259
loss_pred:0.0490381121635437, decouple_loss:0.016486499458551407
Loss: 0.04976889491081238, avg_mse: 0.05651058629155159
current test mse: 0.056511
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012018_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012018_3_24hr.npz
NaN value num: 0
Iteration: 501, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45556312799453735
loss_pred:0.040038563311100006, decouple_loss:0.014862592332065105
The generated pressure mean: 0.4550861120223999
loss_pred:0.0377335250377655, decouple_loss:0.014698628336191177
The generated pressure mean: 0.4493896961212158
loss_pred:0.03781016170978546, decouple_loss:0.014671899378299713
Iteration: 502, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4501020908355713
loss_pred:0.03793449327349663, decouple_loss:0.013444960117340088
The generated pressure mean: 0.44994115829467773
The generated pressure mean: 0.4494093656539917
loss_pred:0.03972747549414635, decouple_loss:0.013851205818355083
loss_pred:0.039850324392318726, decouple_loss:0.014040636830031872
Iteration: 503, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4402717649936676
loss_pred:0.039244867861270905, decouple_loss:0.01455338578671217
The generated pressure mean: 0.4416057765483856
The generated pressure mean: 0.4421175718307495loss_pred:0.04054009169340134, decouple_loss:0.014938874170184135
loss_pred:0.040752653032541275, decouple_loss:0.015322040766477585
Iteration: 504, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4463210999965668
loss_pred:0.03841806948184967, decouple_loss:0.01393681950867176
The generated pressure mean: 0.4483017325401306
loss_pred:0.038485098630189896, decouple_loss:0.013608759269118309
The generated pressure mean: 0.44704902172088623
loss_pred:0.03947719931602478, decouple_loss:0.01492826733738184
Iteration: 505, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44804808497428894
loss_pred:0.03682822361588478, decouple_loss:0.013574386946856976
The generated pressure mean: 0.44876036047935486
loss_pred:0.0405479371547699, decouple_loss:0.013412409462034702
The generated pressure mean: 0.44577112793922424
loss_pred:0.03865902125835419, decouple_loss:0.013672846369445324
Iteration: 506, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4500463008880615
loss_pred:0.039064329117536545, decouple_loss:0.014877823181450367
The generated pressure mean: 0.4533606767654419
loss_pred:0.03819246217608452, decouple_loss:0.014321685768663883
The generated pressure mean: 0.44860953092575073
loss_pred:0.03701047599315643, decouple_loss:0.014429626986384392
Iteration: 507, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4516749680042267
loss_pred:0.03780750930309296, decouple_loss:0.014336461201310158
The generated pressure mean: 0.45552700757980347
loss_pred:0.0404776930809021, decouple_loss:0.01433743629604578
The generated pressure mean: 0.4546271860599518
loss_pred:0.03844241797924042, decouple_loss:0.014110587537288666
Iteration: 508, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43762996792793274
loss_pred:0.03949052840471268, decouple_loss:0.014495570212602615
The generated pressure mean: 0.4400651454925537
loss_pred:0.037246569991111755, decouple_loss:0.014086015522480011
The generated pressure mean: 0.4405774772167206
loss_pred:0.03731193393468857, decouple_loss:0.014729737304151058
Iteration: 509, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44570809602737427
loss_pred:0.038400620222091675, decouple_loss:0.013492428697645664The generated pressure mean: 0.4418438971042633
loss_pred:0.03813045844435692, decouple_loss:0.01314760185778141
The generated pressure mean: 0.4464758336544037
loss_pred:0.03882753103971481, decouple_loss:0.013649828732013702
Iteration: 510, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4509454071521759
loss_pred:0.039089057594537735, decouple_loss:0.014156668446958065
The generated pressure mean: 0.44970130920410156
loss_pred:0.03831890970468521, decouple_loss:0.014480321668088436
The generated pressure mean: 0.4502895176410675
loss_pred:0.03851478546857834, decouple_loss:0.014513273723423481
2023-04-16 03:22:32 testing...
The generated pressure mean: 0.41418370604515076
loss_pred:0.04951031506061554, decouple_loss:0.014221062883734703
The generated pressure mean: 0.4162127375602722
loss_pred:0.04917313531041145, decouple_loss:0.014390239492058754
The generated pressure mean: 0.4198015630245209
loss_pred:0.04935126006603241, decouple_loss:0.015002764761447906
Loss: 0.05007180571556091, avg_mse: 0.057451192289590836
current test mse: 0.057451
Iteration: 511, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45623844861984253
loss_pred:0.037268850952386856, decouple_loss:0.01387990266084671
The generated pressure mean: 0.4580928385257721
loss_pred:0.037217605859041214, decouple_loss:0.013971560634672642
The generated pressure mean: 0.45540937781333923
loss_pred:0.038669392466545105, decouple_loss:0.012952832505106926
Iteration: 512, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44335994124412537
loss_pred:0.03687305375933647, decouple_loss:0.013667311519384384
The generated pressure mean: 0.4448651373386383
loss_pred:0.040678996592760086, decouple_loss:0.013730417937040329
The generated pressure mean: 0.44845929741859436
loss_pred:0.04028056189417839, decouple_loss:0.01361794862896204
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 513, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44284558296203613
loss_pred:0.03985658288002014, decouple_loss:0.012941278517246246
The generated pressure mean: 0.43483051657676697
loss_pred:0.038990676403045654, decouple_loss:0.012766577303409576
The generated pressure mean: 0.4340960383415222
loss_pred:0.038278404623270035, decouple_loss:0.013567419722676277
Iteration: 514, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4475364685058594
loss_pred:0.03942006826400757, decouple_loss:0.012623254209756851
The generated pressure mean: 0.44921427965164185
loss_pred:0.0382971428334713, decouple_loss:0.012440006248652935
The generated pressure mean: 0.44703158736228943
loss_pred:0.039111047983169556, decouple_loss:0.012442811392247677
Iteration: 515, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45631298422813416
loss_pred:0.03964722529053688, decouple_loss:0.013226808048784733
The generated pressure mean: 0.4518340528011322
loss_pred:0.03689654916524887, decouple_loss:0.01342622097581625
The generated pressure mean: 0.4516078233718872
loss_pred:0.038648076355457306, decouple_loss:0.013309633359313011
Iteration: 516, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4411379396915436
loss_pred:0.037076808512210846, decouple_loss:0.013192759826779366
The generated pressure mean: 0.4417250454425812
loss_pred:0.037493735551834106, decouple_loss:0.012957395985722542
The generated pressure mean: 0.4430607259273529
loss_pred:0.037712741643190384, decouple_loss:0.01259019784629345
Iteration: 517, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4335193634033203
loss_pred:0.037170734256505966, decouple_loss:0.01205932255834341
The generated pressure mean: 0.4350033402442932
loss_pred:0.037497714161872864, decouple_loss:0.01156423706561327
The generated pressure mean: 0.43633711338043213
loss_pred:0.03663242608308792, decouple_loss:0.011683681979775429
Iteration: 518, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4514550566673279
loss_pred:0.03619421645998955, decouple_loss:0.012629798613488674
The generated pressure mean: 0.4505341351032257
loss_pred:0.039302848279476166, decouple_loss:0.01343089435249567
The generated pressure mean: 0.45406490564346313
loss_pred:0.03778477758169174, decouple_loss:0.012974311597645283
Iteration: 519, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46177202463150024
loss_pred:0.036586131900548935, decouple_loss:0.01149255782365799
The generated pressure mean: 0.4623175263404846
loss_pred:0.03870116174221039, decouple_loss:0.01141109224408865
The generated pressure mean: 0.4585704207420349
loss_pred:0.037277404218912125, decouple_loss:0.011275824159383774
Iteration: 520, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4488479793071747
loss_pred:0.03680098056793213, decouple_loss:0.01237835455685854
The generated pressure mean: 0.44499942660331726
loss_pred:0.03653747960925102, decouple_loss:0.012121821753680706
The generated pressure mean: 0.44409656524658203
loss_pred:0.03792676329612732, decouple_loss:0.012339897453784943
2023-04-16 03:24:33 testing...
The generated pressure mean: 0.42119693756103516
loss_pred:0.048459410667419434, decouple_loss:0.012561853043735027
The generated pressure mean: 0.42322587966918945
loss_pred:0.04781602695584297, decouple_loss:0.013062423095107079
The generated pressure mean: 0.4275553822517395
loss_pred:0.04892676696181297, decouple_loss:0.013285522349178791
Loss: 0.04904922842979431, avg_mse: 0.056551773101091385
current test mse: 0.056552
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012011_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012011_3_24hr.npz
NaN value num: 0
Iteration: 521, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4291062653064728
loss_pred:0.0371275395154953, decouple_loss:0.011985113844275475
The generated pressure mean: 0.43475237488746643
loss_pred:0.03693335875868797, decouple_loss:0.011869820766150951
The generated pressure mean: 0.43585553765296936
loss_pred:0.03975613787770271, decouple_loss:0.013070032931864262
Iteration: 522, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4539724588394165
loss_pred:0.04065392166376114, decouple_loss:0.015327710658311844
The generated pressure mean: 0.4548548758029938
loss_pred:0.03666875511407852, decouple_loss:0.014086013659834862
The generated pressure mean: 0.44927898049354553
loss_pred:0.03721598908305168, decouple_loss:0.013370621018111706
Iteration: 523, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.467367947101593
loss_pred:0.0399518646299839, decouple_loss:0.011891962960362434
The generated pressure mean: 0.46830686926841736
loss_pred:0.03699120879173279, decouple_loss:0.010806730948388577
The generated pressure mean: 0.46157407760620117
loss_pred:0.037106193602085114, decouple_loss:0.012434989213943481
Iteration: 524, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45422086119651794
loss_pred:0.03765101730823517, decouple_loss:0.012455472722649574
The generated pressure mean: 0.45775118470191956
loss_pred:0.038290705531835556, decouple_loss:0.012223249301314354
The generated pressure mean: 0.4555070698261261
loss_pred:0.03950236365199089, decouple_loss:0.012192114256322384
Iteration: 525, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.434622585773468
The generated pressure mean: 0.4340428411960602
loss_pred:0.03839525952935219, decouple_loss:0.011956587433815002
loss_pred:0.03850628808140755, decouple_loss:0.01149065513163805
The generated pressure mean: 0.4316837191581726
loss_pred:0.041114840656518936, decouple_loss:0.012854241766035557
Iteration: 526, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4354362189769745
loss_pred:0.041468095034360886, decouple_loss:0.011541707441210747
The generated pressure mean: 0.4368334710597992
loss_pred:0.03834379464387894, decouple_loss:0.011380081996321678
The generated pressure mean: 0.4318544566631317
loss_pred:0.03807247430086136, decouple_loss:0.011502820067107677
Iteration: 527, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46475788950920105
loss_pred:0.03650043532252312, decouple_loss:0.01283616665750742
The generated pressure mean: 0.46225079894065857
loss_pred:0.039136290550231934, decouple_loss:0.01298805046826601
The generated pressure mean: 0.4654013216495514
loss_pred:0.03823757916688919, decouple_loss:0.012052081525325775
Iteration: 528, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.456773966550827
loss_pred:0.03761903941631317, decouple_loss:0.012280348688364029
The generated pressure mean: 0.4588193893432617
loss_pred:0.0380772203207016, decouple_loss:0.013245919719338417
The generated pressure mean: 0.46307429671287537
loss_pred:0.04050849378108978, decouple_loss:0.011859891004860401
Iteration: 529, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4390568435192108
loss_pred:0.036368947476148605, decouple_loss:0.011740022338926792
The generated pressure mean: 0.4396928548812866
loss_pred:0.037272509187459946, decouple_loss:0.012077175080776215
The generated pressure mean: 0.4379059970378876
loss_pred:0.038690656423568726, decouple_loss:0.011861865408718586
Iteration: 530, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4301222264766693
loss_pred:0.03619871661067009, decouple_loss:0.012144390493631363
The generated pressure mean: 0.429531455039978
loss_pred:0.037600234150886536, decouple_loss:0.010360504500567913
The generated pressure mean: 0.4326418936252594
loss_pred:0.03790956735610962, decouple_loss:0.010819343850016594
2023-04-16 03:27:06 testing...
The generated pressure mean: 0.4142664968967438
loss_pred:0.04994567111134529, decouple_loss:0.013426738791167736
The generated pressure mean: 0.4169771373271942
loss_pred:0.04732036590576172, decouple_loss:0.013391612097620964
The generated pressure mean: 0.42044833302497864
loss_pred:0.04856698587536812, decouple_loss:0.013932863250374794
Loss: 0.04929019510746002, avg_mse: 0.05700964108109474
current test mse: 0.05701
Iteration: 531, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45371952652931213
loss_pred:0.04082779213786125, decouple_loss:0.012701108120381832
The generated pressure mean: 0.4534130394458771
The generated pressure mean: 0.4505016505718231
loss_pred:0.03868258371949196, decouple_loss:0.01330229640007019
loss_pred:0.03699373081326485, decouple_loss:0.013037450611591339
Iteration: 532, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46199724078178406
loss_pred:0.038326844573020935, decouple_loss:0.010997979901731014
The generated pressure mean: 0.46175917983055115
loss_pred:0.03858203440904617, decouple_loss:0.01163690909743309
The generated pressure mean: 0.45821088552474976
loss_pred:0.03915815055370331, decouple_loss:0.010838023386895657
Iteration: 533, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44717109203338623
loss_pred:0.03548043966293335, decouple_loss:0.012388247065246105
The generated pressure mean: 0.44313132762908936
loss_pred:0.03796309232711792, decouple_loss:0.012515324167907238
The generated pressure mean: 0.44136592745780945
loss_pred:0.03727724030613899, decouple_loss:0.011692606844007969
Iteration: 534, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4313794672489166
loss_pred:0.037397973239421844, decouple_loss:0.01133792381733656
The generated pressure mean: 0.4350319504737854
loss_pred:0.03767726942896843, decouple_loss:0.013207660987973213
The generated pressure mean: 0.43285471200942993
loss_pred:0.037265900522470474, decouple_loss:0.011551600880920887
Iteration: 535, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4467049241065979
loss_pred:0.03708619251847267, decouple_loss:0.011043630540370941
The generated pressure mean: 0.44949468970298767
loss_pred:0.036486174911260605, decouple_loss:0.012040202505886555
The generated pressure mean: 0.4473046362400055
loss_pred:0.03787379711866379, decouple_loss:0.011035241186618805
Iteration: 536, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4581212103366852
loss_pred:0.03866782411932945, decouple_loss:0.013462654314935207
The generated pressure mean: 0.4574052393436432
loss_pred:0.03718471899628639, decouple_loss:0.012064230628311634
The generated pressure mean: 0.45927518606185913
loss_pred:0.03922872990369797, decouple_loss:0.01189135666936636
Iteration: 537, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44730350375175476
loss_pred:0.03643926978111267, decouple_loss:0.012430009432137012
The generated pressure mean: 0.451040118932724
loss_pred:0.036945946514606476, decouple_loss:0.01078499760478735
The generated pressure mean: 0.44902294874191284
loss_pred:0.035812847316265106, decouple_loss:0.011606251820921898
Iteration: 538, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4371126592159271
loss_pred:0.03679715842008591, decouple_loss:0.011557978577911854
The generated pressure mean: 0.4418894648551941
loss_pred:0.03817305341362953, decouple_loss:0.01294462475925684
The generated pressure mean: 0.4361025393009186
loss_pred:0.03629693388938904, decouple_loss:0.011820422485470772
Iteration: 539, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4479151964187622
loss_pred:0.03779258206486702, decouple_loss:0.012425119988620281
The generated pressure mean: 0.443815678358078
loss_pred:0.034738361835479736, decouple_loss:0.012105841189622879
The generated pressure mean: 0.44626057147979736
loss_pred:0.03983992338180542, decouple_loss:0.013617701828479767
Iteration: 540, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4574088454246521
loss_pred:0.04097926989197731, decouple_loss:0.011905471794307232
The generated pressure mean: 0.46012043952941895
loss_pred:0.037284694612026215, decouple_loss:0.011193803511559963
The generated pressure mean: 0.4626254439353943
loss_pred:0.03976478427648544, decouple_loss:0.011524228379130363
2023-04-16 03:29:06 testing...
The generated pressure mean: 0.4187076687812805
loss_pred:0.047939907759428024, decouple_loss:0.01317012682557106
The generated pressure mean: 0.4211179316043854
loss_pred:0.04642874747514725, decouple_loss:0.013727196492254734
The generated pressure mean: 0.42535194754600525
loss_pred:0.04760485142469406, decouple_loss:0.01402333378791809
Loss: 0.048006512224674225, avg_mse: 0.05551536753773689
current test mse: 0.055515
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012005_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012005_3_24hr.npz
NaN value num: 0
Iteration: 541, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4490240216255188
loss_pred:0.03505559265613556, decouple_loss:0.012927236035466194
The generated pressure mean: 0.4502142071723938
loss_pred:0.03753006458282471, decouple_loss:0.012895542196929455
The generated pressure mean: 0.45206543803215027
loss_pred:0.0371963307261467, decouple_loss:0.013539602048695087
Iteration: 542, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43127915263175964
loss_pred:0.03701653704047203, decouple_loss:0.014430372975766659
The generated pressure mean: 0.4338671863079071
loss_pred:0.037265997380018234, decouple_loss:0.013180889189243317
The generated pressure mean: 0.43560096621513367
loss_pred:0.035762060433626175, decouple_loss:0.013484597206115723
Iteration: 543, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44183406233787537
loss_pred:0.03734475001692772, decouple_loss:0.014443076215684414
The generated pressure mean: 0.4374428689479828
The generated pressure mean: 0.4366256296634674
loss_pred:0.04003387689590454, decouple_loss:0.015106248669326305
loss_pred:0.034837428480386734, decouple_loss:0.01535558607429266
Iteration: 544, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4635518491268158
loss_pred:0.035971835255622864, decouple_loss:0.01350346952676773
The generated pressure mean: 0.46591854095458984
loss_pred:0.03779560327529907, decouple_loss:0.013970239087939262
The generated pressure mean: 0.4667908847332001
loss_pred:0.03615730628371239, decouple_loss:0.014134535565972328
Iteration: 545, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46283140778541565
The generated pressure mean: 0.4585559368133545
loss_pred:0.03586173430085182, decouple_loss:0.015294496901333332
loss_pred:0.03757042437791824, decouple_loss:0.01463287603110075
The generated pressure mean: 0.45756396651268005
loss_pred:0.03833659738302231, decouple_loss:0.014102627523243427
Iteration: 546, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4212620258331299
loss_pred:0.03681014105677605, decouple_loss:0.01602358929812908
The generated pressure mean: 0.42742836475372314
loss_pred:0.039446696639060974, decouple_loss:0.016141895204782486
The generated pressure mean: 0.423218309879303
loss_pred:0.03714407607913017, decouple_loss:0.015772923827171326
Iteration: 547, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43980178236961365
loss_pred:0.03557648882269859, decouple_loss:0.013904380612075329
The generated pressure mean: 0.4419764578342438
loss_pred:0.038258932530879974, decouple_loss:0.013905552215874195
The generated pressure mean: 0.439718097448349
loss_pred:0.03554701432585716, decouple_loss:0.014497634954750538
Iteration: 548, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4731564521789551The generated pressure mean: 0.4748339056968689
loss_pred:0.03710145875811577, decouple_loss:0.015019915997982025
loss_pred:0.03585571423172951, decouple_loss:0.014649014919996262
The generated pressure mean: 0.4727415144443512
loss_pred:0.03641320765018463, decouple_loss:0.014157203026115894
Iteration: 549, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44883549213409424
The generated pressure mean: 0.4478006064891815
loss_pred:0.04040925204753876, decouple_loss:0.015127566643059254
loss_pred:0.035828568041324615, decouple_loss:0.014962736517190933
The generated pressure mean: 0.4486682116985321
loss_pred:0.03842049464583397, decouple_loss:0.014723471365869045
Iteration: 550, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4500071108341217
The generated pressure mean: 0.4473406970500946
loss_pred:0.036332305520772934, decouple_loss:0.01393306814134121
loss_pred:0.03631633520126343, decouple_loss:0.01393976341933012
The generated pressure mean: 0.45319849252700806
loss_pred:0.03697466850280762, decouple_loss:0.014341074973344803
2023-04-16 03:31:40 testing...
The generated pressure mean: 0.4208148419857025
loss_pred:0.048323504626750946, decouple_loss:0.014102653600275517
The generated pressure mean: 0.42386820912361145
loss_pred:0.04680691659450531, decouple_loss:0.014453188516199589
The generated pressure mean: 0.42851030826568604
loss_pred:0.04799759015440941, decouple_loss:0.014552821405231953
Loss: 0.04842781648039818, avg_mse: 0.056852586567401886
current test mse: 0.056853
Iteration: 551, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.447631299495697
loss_pred:0.036928437650203705, decouple_loss:0.013543294742703438
The generated pressure mean: 0.44753497838974
loss_pred:0.03524123877286911, decouple_loss:0.013989567756652832
The generated pressure mean: 0.4515070915222168
loss_pred:0.03585120290517807, decouple_loss:0.014029713347554207
Iteration: 552, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4445660412311554
loss_pred:0.038200750946998596, decouple_loss:0.015797365456819534
The generated pressure mean: 0.44212302565574646
The generated pressure mean: 0.443740576505661
loss_pred:0.037107985466718674, decouple_loss:0.01538896281272173
loss_pred:0.03725091367959976, decouple_loss:0.015421394258737564
Iteration: 553, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4496603012084961
loss_pred:0.03753066062927246, decouple_loss:0.014825500547885895
The generated pressure mean: 0.4462958574295044
The generated pressure mean: 0.44385451078414917
loss_pred:0.03504924476146698, decouple_loss:0.014887512661516666
loss_pred:0.0377715602517128, decouple_loss:0.0152190662920475
Iteration: 554, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4437701106071472
loss_pred:0.03423691168427467, decouple_loss:0.014165796339511871
The generated pressure mean: 0.44780832529067993
loss_pred:0.036087676882743835, decouple_loss:0.014481140300631523
The generated pressure mean: 0.4457094073295593
loss_pred:0.035832710564136505, decouple_loss:0.013841751962900162
Iteration: 555, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44639432430267334
The generated pressure mean: 0.44452375173568726
loss_pred:0.03630773350596428, decouple_loss:0.015851862728595734
loss_pred:0.036875177174806595, decouple_loss:0.01567341946065426
The generated pressure mean: 0.44404712319374084
loss_pred:0.0354621596634388, decouple_loss:0.015527446754276752
Iteration: 556, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.465542197227478
loss_pred:0.03587640821933746, decouple_loss:0.01451730914413929
The generated pressure mean: 0.46000006794929504
loss_pred:0.03493638336658478, decouple_loss:0.014573251828551292
The generated pressure mean: 0.45887520909309387
loss_pred:0.03832092508673668, decouple_loss:0.014381336979568005
Iteration: 557, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44965842366218567
loss_pred:0.036179106682538986, decouple_loss:0.013147990219295025The generated pressure mean: 0.4455730617046356
loss_pred:0.03646240383386612, decouple_loss:0.01345627848058939
The generated pressure mean: 0.4460506737232208
loss_pred:0.036344822496175766, decouple_loss:0.012826383113861084
Iteration: 558, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4306586682796478
loss_pred:0.0374775305390358, decouple_loss:0.016480041667819023
The generated pressure mean: 0.4277222454547882
loss_pred:0.036010175943374634, decouple_loss:0.016542335972189903
The generated pressure mean: 0.4295535385608673
loss_pred:0.03662696108222008, decouple_loss:0.016862524673342705
Iteration: 559, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4625135064125061
The generated pressure mean: 0.4614041745662689
loss_pred:0.03639493137598038, decouple_loss:0.013027532957494259
loss_pred:0.035390228033065796, decouple_loss:0.01382132712751627
The generated pressure mean: 0.46250659227371216
loss_pred:0.036393921822309494, decouple_loss:0.01369474921375513
Iteration: 560, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46015360951423645
loss_pred:0.0369398407638073, decouple_loss:0.014961966313421726
The generated pressure mean: 0.4586319625377655
loss_pred:0.03587387502193451, decouple_loss:0.014515653252601624
The generated pressure mean: 0.4572896361351013
loss_pred:0.03629974275827408, decouple_loss:0.01415056549012661
2023-04-16 03:33:40 testing...
The generated pressure mean: 0.42487475275993347
loss_pred:0.046102650463581085, decouple_loss:0.015780532732605934
The generated pressure mean: 0.42758914828300476
loss_pred:0.045522283762693405, decouple_loss:0.01619097962975502
The generated pressure mean: 0.43239039182662964
loss_pred:0.04576830938458443, decouple_loss:0.01632472313940525
Loss: 0.04660268872976303, avg_mse: 0.05395570397377014
current test mse: 0.053956
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012013_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012013_3_24hr.npz
NaN value num: 0
Iteration: 561, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4312054514884949
loss_pred:0.03567884862422943, decouple_loss:0.015333320014178753
The generated pressure mean: 0.4275984466075897
loss_pred:0.03848149627447128, decouple_loss:0.014981172978878021
The generated pressure mean: 0.4280424416065216
loss_pred:0.037367697805166245, decouple_loss:0.014569869264960289
Iteration: 562, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44383659958839417
loss_pred:0.03571537882089615, decouple_loss:0.015461183153092861
The generated pressure mean: 0.44348928332328796
loss_pred:0.036070358008146286, decouple_loss:0.014669734984636307
The generated pressure mean: 0.4410785436630249
loss_pred:0.03815001621842384, decouple_loss:0.015061327256262302
Iteration: 563, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4589080810546875
loss_pred:0.03711042180657387, decouple_loss:0.015244179405272007
The generated pressure mean: 0.45558831095695496
loss_pred:0.037151820957660675, decouple_loss:0.014079311862587929
The generated pressure mean: 0.4581308364868164
loss_pred:0.036485519260168076, decouple_loss:0.015041650272905827
Iteration: 564, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44916900992393494
loss_pred:0.037439364939928055, decouple_loss:0.013303986750543118
The generated pressure mean: 0.44569820165634155
loss_pred:0.03647070378065109, decouple_loss:0.013360319659113884
The generated pressure mean: 0.4477035105228424
loss_pred:0.03722654655575752, decouple_loss:0.014327822253108025
Iteration: 565, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44660064578056335
loss_pred:0.03741534426808357, decouple_loss:0.014188938774168491
The generated pressure mean: 0.4438672363758087
loss_pred:0.03569398820400238, decouple_loss:0.01436695083975792
The generated pressure mean: 0.4478807747364044
loss_pred:0.0373368076980114, decouple_loss:0.014610495418310165
Iteration: 566, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4314361810684204
loss_pred:0.03880370035767555, decouple_loss:0.016453251242637634
The generated pressure mean: 0.4327535629272461
loss_pred:0.03531302139163017, decouple_loss:0.015881985425949097
The generated pressure mean: 0.4293409585952759
loss_pred:0.03798840567469597, decouple_loss:0.01716437004506588
Iteration: 567, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44740691781044006
loss_pred:0.03821342810988426, decouple_loss:0.01444343663752079
The generated pressure mean: 0.45187127590179443
loss_pred:0.03945576772093773, decouple_loss:0.014450806193053722
The generated pressure mean: 0.4501293897628784
loss_pred:0.036647308617830276, decouple_loss:0.014454209245741367
Iteration: 568, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44709327816963196
loss_pred:0.03732797130942345, decouple_loss:0.012443013489246368
The generated pressure mean: 0.4466712772846222
loss_pred:0.03673901781439781, decouple_loss:0.013740772381424904
The generated pressure mean: 0.4448648989200592
loss_pred:0.039634618908166885, decouple_loss:0.012746857479214668
Iteration: 569, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4515949487686157
loss_pred:0.037008125334978104, decouple_loss:0.013023030944168568
The generated pressure mean: 0.45347949862480164
loss_pred:0.03552012890577316, decouple_loss:0.014212465845048428
The generated pressure mean: 0.45550307631492615
loss_pred:0.03553710877895355, decouple_loss:0.013176335953176022
Iteration: 570, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44541558623313904
loss_pred:0.03814775124192238, decouple_loss:0.013289636000990868
The generated pressure mean: 0.4446510970592499
loss_pred:0.03499333932995796, decouple_loss:0.012757264077663422
The generated pressure mean: 0.4452563226222992
loss_pred:0.03695451468229294, decouple_loss:0.012944705784320831
2023-04-16 03:36:13 testing...
The generated pressure mean: 0.42330676317214966
loss_pred:0.04824182018637657, decouple_loss:0.013445157557725906
The generated pressure mean: 0.42664748430252075
loss_pred:0.04570136219263077, decouple_loss:0.013706015422940254
The generated pressure mean: 0.4309343099594116
loss_pred:0.04661063849925995, decouple_loss:0.014069797471165657
Loss: 0.04753829166293144, avg_mse: 0.056249845772981644
current test mse: 0.05625
Iteration: 571, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43093496561050415
loss_pred:0.03631434962153435, decouple_loss:0.012338993139564991
The generated pressure mean: 0.4299473166465759
loss_pred:0.03769269585609436, decouple_loss:0.012347822077572346
The generated pressure mean: 0.43232887983322144
loss_pred:0.03396444767713547, decouple_loss:0.011498069390654564
Iteration: 572, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4584258496761322
loss_pred:0.03701664134860039, decouple_loss:0.014120636507868767
The generated pressure mean: 0.4518607258796692
loss_pred:0.03566383570432663, decouple_loss:0.013528415001928806
The generated pressure mean: 0.45236310362815857
loss_pred:0.03671003878116608, decouple_loss:0.01468994002789259
Iteration: 573, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4591425061225891
loss_pred:0.034568700939416885, decouple_loss:0.013184871524572372
The generated pressure mean: 0.46194350719451904
loss_pred:0.03741162270307541, decouple_loss:0.012878304347395897
The generated pressure mean: 0.46097034215927124
loss_pred:0.03578011691570282, decouple_loss:0.013234867714345455
Iteration: 574, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43205881118774414
loss_pred:0.03492980822920799, decouple_loss:0.013381566852331161
The generated pressure mean: 0.43392157554626465
loss_pred:0.0378401018679142, decouple_loss:0.013795535080134869
The generated pressure mean: 0.4348321557044983
loss_pred:0.035289693623781204, decouple_loss:0.01384552102535963
Iteration: 575, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4368636906147003
loss_pred:0.03581349551677704, decouple_loss:0.013028930872678757
The generated pressure mean: 0.43384984135627747
loss_pred:0.03560826927423477, decouple_loss:0.013005550019443035
The generated pressure mean: 0.43137189745903015
loss_pred:0.03665083274245262, decouple_loss:0.01366120669990778
Iteration: 576, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45248857140541077
loss_pred:0.03348638862371445, decouple_loss:0.013386286795139313
The generated pressure mean: 0.4515783488750458
loss_pred:0.034633833914995193, decouple_loss:0.012338909320533276
The generated pressure mean: 0.44968608021736145
loss_pred:0.03653964772820473, decouple_loss:0.01254842709749937
Iteration: 577, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46574148535728455
loss_pred:0.03936256840825081, decouple_loss:0.012693720869719982
The generated pressure mean: 0.4631647765636444
loss_pred:0.035758018493652344, decouple_loss:0.012375222519040108
The generated pressure mean: 0.46482497453689575
loss_pred:0.03586186096072197, decouple_loss:0.012303745374083519
Iteration: 578, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4412417709827423
loss_pred:0.03628436103463173, decouple_loss:0.011923369020223618
The generated pressure mean: 0.4379802942276001
loss_pred:0.03488418459892273, decouple_loss:0.011557670310139656
The generated pressure mean: 0.44376951456069946
loss_pred:0.03728232905268669, decouple_loss:0.012434730306267738
Iteration: 579, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4294813275337219
loss_pred:0.0348782017827034, decouple_loss:0.011517161503434181
The generated pressure mean: 0.4268830120563507
loss_pred:0.035049691796302795, decouple_loss:0.012013597413897514
The generated pressure mean: 0.4320918023586273
loss_pred:0.033901799470186234, decouple_loss:0.013826638460159302
Iteration: 580, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4559893012046814
loss_pred:0.03513527289032936, decouple_loss:0.01172233372926712
The generated pressure mean: 0.4566705524921417
loss_pred:0.035754814743995667, decouple_loss:0.012382161803543568
The generated pressure mean: 0.45235875248908997
loss_pred:0.03423359990119934, decouple_loss:0.011973005719482899
2023-04-16 03:38:12 testing...
The generated pressure mean: 0.41577374935150146
loss_pred:0.048064231872558594, decouple_loss:0.011788242496550083
The generated pressure mean: 0.4192074239253998
loss_pred:0.04572141543030739, decouple_loss:0.011835737153887749
The generated pressure mean: 0.42360684275627136
loss_pred:0.04590759426355362, decouple_loss:0.012518372386693954
Loss: 0.04716678708791733, avg_mse: 0.05686361342668533
current test mse: 0.056864
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012007_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012007_3_24hr.npz
NaN value num: 0
Iteration: 581, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46363699436187744
loss_pred:0.03571932390332222, decouple_loss:0.011916758492588997
The generated pressure mean: 0.46083900332450867
loss_pred:0.03748296946287155, decouple_loss:0.011130737140774727
The generated pressure mean: 0.4599856436252594
loss_pred:0.03499541059136391, decouple_loss:0.010920810513198376
Iteration: 582, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4381772577762604
loss_pred:0.0359044075012207, decouple_loss:0.011994819156825542
The generated pressure mean: 0.4373701810836792
loss_pred:0.03514063358306885, decouple_loss:0.01262026559561491
The generated pressure mean: 0.4338831603527069
loss_pred:0.03846948593854904, decouple_loss:0.011774187907576561
Iteration: 583, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44338104128837585
loss_pred:0.03506005182862282, decouple_loss:0.010747041553258896
The generated pressure mean: 0.4408465325832367
loss_pred:0.037672847509384155, decouple_loss:0.010595163330435753
The generated pressure mean: 0.4426995515823364
loss_pred:0.03354168310761452, decouple_loss:0.010724141262471676
Iteration: 584, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44543933868408203
loss_pred:0.03581250086426735, decouple_loss:0.012326373718678951
The generated pressure mean: 0.44715648889541626
loss_pred:0.03481417894363403, decouple_loss:0.012941773049533367
The generated pressure mean: 0.4497438371181488
loss_pred:0.03635091334581375, decouple_loss:0.011264864355325699
Iteration: 585, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44714564085006714
loss_pred:0.03610975667834282, decouple_loss:0.011172786355018616
The generated pressure mean: 0.4462983310222626
loss_pred:0.03609683737158775, decouple_loss:0.011060293763875961
The generated pressure mean: 0.4442647695541382
loss_pred:0.03612465783953667, decouple_loss:0.011074891313910484
Iteration: 586, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44727519154548645
loss_pred:0.03517652302980423, decouple_loss:0.011440958827733994
The generated pressure mean: 0.44928473234176636
loss_pred:0.0366528145968914, decouple_loss:0.010781276039779186
The generated pressure mean: 0.4450584053993225
loss_pred:0.03650771453976631, decouple_loss:0.011140807531774044
Iteration: 587, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.458736389875412
loss_pred:0.034371014684438705, decouple_loss:0.011523756198585033
The generated pressure mean: 0.46560367941856384
loss_pred:0.035148102790117264, decouple_loss:0.011976110748946667
The generated pressure mean: 0.46160921454429626
loss_pred:0.036346785724163055, decouple_loss:0.011868605390191078
Iteration: 588, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43975961208343506
loss_pred:0.035797834396362305, decouple_loss:0.01074216142296791
The generated pressure mean: 0.43906185030937195
loss_pred:0.03522792458534241, decouple_loss:0.011332186870276928
The generated pressure mean: 0.43811097741127014
loss_pred:0.03613123670220375, decouple_loss:0.01104742381721735
Iteration: 589, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43826961517333984
loss_pred:0.037082526832818985, decouple_loss:0.012757273390889168
The generated pressure mean: 0.4363633692264557
loss_pred:0.03345057740807533, decouple_loss:0.013543816283345222
The generated pressure mean: 0.4380868077278137
loss_pred:0.0347929522395134, decouple_loss:0.012831234373152256
Iteration: 590, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4475998282432556
The generated pressure mean: 0.44649988412857056
loss_pred:0.03495410084724426, decouple_loss:0.010837078094482422
loss_pred:0.03610501065850258, decouple_loss:0.010571792721748352
The generated pressure mean: 0.4471694529056549
loss_pred:0.034908995032310486, decouple_loss:0.010728673078119755
2023-04-16 03:40:47 testing...
The generated pressure mean: 0.41710326075553894
loss_pred:0.04640601947903633, decouple_loss:0.013014493510127068
The generated pressure mean: 0.420094758272171
loss_pred:0.04396519437432289, decouple_loss:0.013016650453209877
The generated pressure mean: 0.4250228703022003
loss_pred:0.04536691680550575, decouple_loss:0.013379281386733055
Loss: 0.04590288922190666, avg_mse: 0.054019711911678314
current test mse: 0.05402
Iteration: 591, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46376684308052063
loss_pred:0.03486446291208267, decouple_loss:0.012608115561306477
The generated pressure mean: 0.45854538679122925
loss_pred:0.03640669956803322, decouple_loss:0.012332468293607235
The generated pressure mean: 0.4617048501968384
loss_pred:0.03453407436609268, decouple_loss:0.012250029481947422
Iteration: 592, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44121813774108887
loss_pred:0.03395016863942146, decouple_loss:0.011268891394138336
The generated pressure mean: 0.4450705945491791
loss_pred:0.034534014761447906, decouple_loss:0.010939846746623516
The generated pressure mean: 0.44305849075317383
loss_pred:0.03638381510972977, decouple_loss:0.011510292999446392
Iteration: 593, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43473705649375916
loss_pred:0.03571179136633873, decouple_loss:0.012959228828549385
The generated pressure mean: 0.43646758794784546
loss_pred:0.03441449627280235, decouple_loss:0.012304401025176048
The generated pressure mean: 0.43097561597824097
loss_pred:0.03596192225813866, decouple_loss:0.012787840329110622
Iteration: 594, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44095295667648315
loss_pred:0.03525078296661377, decouple_loss:0.012526228092610836
The generated pressure mean: 0.4394771158695221
loss_pred:0.034891482442617416, decouple_loss:0.011754735372960567
The generated pressure mean: 0.4412020742893219
loss_pred:0.034531790763139725, decouple_loss:0.011260628700256348
Iteration: 595, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4613036513328552
loss_pred:0.03573918715119362, decouple_loss:0.014084546826779842
The generated pressure mean: 0.46612975001335144
loss_pred:0.03615650162100792, decouple_loss:0.014039769768714905
The generated pressure mean: 0.4648131728172302
loss_pred:0.03442881628870964, decouple_loss:0.013739997521042824
Iteration: 596, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4558027982711792
loss_pred:0.03451692685484886, decouple_loss:0.012103919871151447
The generated pressure mean: 0.45129647850990295
loss_pred:0.03575778380036354, decouple_loss:0.01252667885273695
The generated pressure mean: 0.45362386107444763
loss_pred:0.032833486795425415, decouple_loss:0.012356390245258808
Iteration: 597, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4256986975669861
loss_pred:0.034371450543403625, decouple_loss:0.013212058693170547
The generated pressure mean: 0.43031707406044006
loss_pred:0.03398265317082405, decouple_loss:0.014004739932715893
The generated pressure mean: 0.4279765188694
loss_pred:0.03393365815281868, decouple_loss:0.013599029742181301
Iteration: 598, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4415656626224518
loss_pred:0.03543456271290779, decouple_loss:0.012841032817959785
The generated pressure mean: 0.44444766640663147
loss_pred:0.03408075124025345, decouple_loss:0.013023464009165764
The generated pressure mean: 0.44229403138160706
loss_pred:0.03557746484875679, decouple_loss:0.01312678400427103
Iteration: 599, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4667074680328369
loss_pred:0.0352301262319088, decouple_loss:0.013440540060400963
The generated pressure mean: 0.46731188893318176
loss_pred:0.03341963514685631, decouple_loss:0.013844726607203484
The generated pressure mean: 0.4663108289241791
loss_pred:0.03598487377166748, decouple_loss:0.013764080591499805
Iteration: 600, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44770747423171997
The generated pressure mean: 0.45304080843925476
loss_pred:0.03628562018275261, decouple_loss:0.014007619582116604
loss_pred:0.03408295288681984, decouple_loss:0.01245499774813652
The generated pressure mean: 0.4486341178417206
loss_pred:0.03403647989034653, decouple_loss:0.014579790644347668
2023-04-16 03:42:46 testing...
The generated pressure mean: 0.425708144903183
loss_pred:0.044996485114097595, decouple_loss:0.015850165858864784
The generated pressure mean: 0.43026700615882874
loss_pred:0.0440945066511631, decouple_loss:0.015947187319397926
The generated pressure mean: 0.43491706252098083
loss_pred:0.04393719881772995, decouple_loss:0.0161563940346241
Loss: 0.04514196142554283, avg_mse: 0.05311965569853783
current test mse: 0.05312
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012005_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012005_3_24hr.npz
NaN value num: 0
Iteration: 601, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.42962512373924255
loss_pred:0.0352177657186985, decouple_loss:0.015057690441608429
The generated pressure mean: 0.42986568808555603
loss_pred:0.034936171025037766, decouple_loss:0.015083394013345242
The generated pressure mean: 0.4290720820426941
loss_pred:0.03560417890548706, decouple_loss:0.015264421701431274
Iteration: 602, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4536539316177368
loss_pred:0.035675689578056335, decouple_loss:0.012578250840306282
The generated pressure mean: 0.4545639753341675
loss_pred:0.035212501883506775, decouple_loss:0.012667757458984852
The generated pressure mean: 0.46035444736480713
loss_pred:0.039367951452732086, decouple_loss:0.012599574401974678
Iteration: 603, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43309327960014343
loss_pred:0.03552284464240074, decouple_loss:0.01462454441934824
The generated pressure mean: 0.434223473072052
loss_pred:0.0338229201734066, decouple_loss:0.014875302091240883
The generated pressure mean: 0.4307790994644165
loss_pred:0.034572210162878036, decouple_loss:0.014978933148086071
Iteration: 604, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4646158814430237
loss_pred:0.03670578822493553, decouple_loss:0.013997371308505535
The generated pressure mean: 0.46587038040161133
loss_pred:0.03546018525958061, decouple_loss:0.013680311851203442
The generated pressure mean: 0.46482715010643005
loss_pred:0.03616821765899658, decouple_loss:0.013576053082942963
Iteration: 605, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4501674175262451
loss_pred:0.036333899945020676, decouple_loss:0.014251447282731533
The generated pressure mean: 0.4497142732143402
loss_pred:0.03507065027952194, decouple_loss:0.014632629230618477
The generated pressure mean: 0.45227479934692383
loss_pred:0.03527737036347389, decouple_loss:0.01516268402338028
Iteration: 606, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4298367500305176
loss_pred:0.03553198277950287, decouple_loss:0.014918972738087177
The generated pressure mean: 0.426749587059021
loss_pred:0.03617226332426071, decouple_loss:0.014720898121595383
The generated pressure mean: 0.42768076062202454
loss_pred:0.03543853014707565, decouple_loss:0.01508768554776907
Iteration: 607, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45732972025871277
loss_pred:0.03555960953235626, decouple_loss:0.015397949144244194
The generated pressure mean: 0.45553070306777954
loss_pred:0.03449117764830589, decouple_loss:0.01512051559984684
The generated pressure mean: 0.4531261920928955
loss_pred:0.03503701463341713, decouple_loss:0.014668410643935204
Iteration: 608, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4597964882850647
loss_pred:0.03497607633471489, decouple_loss:0.014432539232075214
The generated pressure mean: 0.461149126291275
loss_pred:0.03556327521800995, decouple_loss:0.014146669767796993
The generated pressure mean: 0.4669990539550781
loss_pred:0.03582527115941048, decouple_loss:0.013967247679829597
Iteration: 609, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.42698758840560913
loss_pred:0.03587467595934868, decouple_loss:0.013715671375393867
The generated pressure mean: 0.42911848425865173
loss_pred:0.0342983677983284, decouple_loss:0.014286956749856472
The generated pressure mean: 0.4274646043777466
loss_pred:0.03626011312007904, decouple_loss:0.01429966650903225
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 610, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43910157680511475
loss_pred:0.034020110964775085, decouple_loss:0.014472873881459236
The generated pressure mean: 0.43907663226127625
loss_pred:0.03396054357290268, decouple_loss:0.01426254864782095
The generated pressure mean: 0.4418029487133026
loss_pred:0.03574398159980774, decouple_loss:0.014820766635239124
2023-04-16 03:45:17 testing...
The generated pressure mean: 0.41345450282096863
loss_pred:0.04638427495956421, decouple_loss:0.013370816595852375
The generated pressure mean: 0.4159143567085266
loss_pred:0.04524132236838341, decouple_loss:0.01350636500865221
The generated pressure mean: 0.4207456111907959
loss_pred:0.045620039105415344, decouple_loss:0.014057273045182228
Loss: 0.046430788934230804, avg_mse: 0.056217778474092484
current test mse: 0.056218
Iteration: 611, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.47549760341644287
loss_pred:0.0352950356900692, decouple_loss:0.012293247506022453
The generated pressure mean: 0.4714316725730896
The generated pressure mean: 0.4710083603858948
loss_pred:0.037095796316862106, decouple_loss:0.013155330903828144
loss_pred:0.035191211849451065, decouple_loss:0.012914175167679787
Iteration: 612, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43699905276298523
loss_pred:0.03556951880455017, decouple_loss:0.014746611937880516
The generated pressure mean: 0.43786078691482544
loss_pred:0.03548261150717735, decouple_loss:0.014897231943905354
The generated pressure mean: 0.4314144253730774
loss_pred:0.03463490307331085, decouple_loss:0.014848313294351101
Iteration: 613, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4346376061439514
loss_pred:0.03381176292896271, decouple_loss:0.013447492383420467
The generated pressure mean: 0.4333387613296509
loss_pred:0.0349227674305439, decouple_loss:0.01320217177271843
The generated pressure mean: 0.4340013265609741
loss_pred:0.035637930035591125, decouple_loss:0.01323039922863245
Iteration: 614, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4656006395816803
loss_pred:0.03422090411186218, decouple_loss:0.014373068697750568
The generated pressure mean: 0.4620388448238373
loss_pred:0.03397340327501297, decouple_loss:0.014330429956316948
The generated pressure mean: 0.45848751068115234
loss_pred:0.03631780296564102, decouple_loss:0.014434381388127804
Iteration: 615, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46101638674736023
loss_pred:0.03428635373711586, decouple_loss:0.015077791176736355
The generated pressure mean: 0.4596477746963501
loss_pred:0.033449798822402954, decouple_loss:0.01493450254201889
The generated pressure mean: 0.4539615511894226
loss_pred:0.03476688638329506, decouple_loss:0.014920061454176903
Iteration: 616, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43729570508003235
loss_pred:0.03579098358750343, decouple_loss:0.014322573319077492
The generated pressure mean: 0.43738263845443726
loss_pred:0.033674728125333786, decouple_loss:0.014640885405242443
The generated pressure mean: 0.44231700897216797
loss_pred:0.03422261029481888, decouple_loss:0.015099669806659222
Iteration: 617, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4329060912132263
loss_pred:0.034106869250535965, decouple_loss:0.017966343089938164
The generated pressure mean: 0.43450960516929626
loss_pred:0.03431281819939613, decouple_loss:0.018120018765330315
The generated pressure mean: 0.4346188008785248
loss_pred:0.0347992368042469, decouple_loss:0.018485186621546745
Iteration: 618, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45852452516555786
loss_pred:0.036027561873197556, decouple_loss:0.014589167200028896
The generated pressure mean: 0.456100732088089
loss_pred:0.035186562687158585, decouple_loss:0.014603164047002792
The generated pressure mean: 0.45539653301239014
loss_pred:0.03568221628665924, decouple_loss:0.014787138439714909
Iteration: 619, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4538593590259552
loss_pred:0.03528870269656181, decouple_loss:0.01933852583169937
The generated pressure mean: 0.44892802834510803
loss_pred:0.03357790783047676, decouple_loss:0.019641106948256493
The generated pressure mean: 0.4485921561717987
loss_pred:0.03549551963806152, decouple_loss:0.019337931647896767
Iteration: 620, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44442328810691833
loss_pred:0.03441796079277992, decouple_loss:0.01632087491452694
The generated pressure mean: 0.4479007422924042
loss_pred:0.03511911258101463, decouple_loss:0.016188157722353935
The generated pressure mean: 0.4482119083404541
loss_pred:0.03342089429497719, decouple_loss:0.016275586560368538
2023-04-16 03:47:17 testing...
The generated pressure mean: 0.4200345575809479
loss_pred:0.045367032289505005, decouple_loss:0.016209308058023453
The generated pressure mean: 0.42287585139274597
loss_pred:0.04339785873889923, decouple_loss:0.015896352007985115
The generated pressure mean: 0.42737510800361633
loss_pred:0.04441692307591438, decouple_loss:0.0163049828261137
Loss: 0.04520078003406525, avg_mse: 0.05383268743753433
current test mse: 0.053833
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012015_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012015_3_24hr.npz
NaN value num: 0
Iteration: 621, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4399157166481018
loss_pred:0.03460538759827614, decouple_loss:0.015846185386180878
The generated pressure mean: 0.44222792983055115
loss_pred:0.034901462495326996, decouple_loss:0.015916328877210617
The generated pressure mean: 0.4422958195209503
loss_pred:0.03580423444509506, decouple_loss:0.01565251126885414
Iteration: 622, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4454100430011749
loss_pred:0.033887844532728195, decouple_loss:0.01680603250861168
The generated pressure mean: 0.44705602526664734
loss_pred:0.033508237451314926, decouple_loss:0.017221907153725624
The generated pressure mean: 0.4458370804786682
loss_pred:0.03479872643947601, decouple_loss:0.017289690673351288
Iteration: 623, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44911324977874756
loss_pred:0.034744203090667725, decouple_loss:0.01398779172450304
The generated pressure mean: 0.44751590490341187
loss_pred:0.035704705864191055, decouple_loss:0.013785394839942455
The generated pressure mean: 0.44753298163414
loss_pred:0.03682677447795868, decouple_loss:0.01386463362723589
Iteration: 624, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4440379738807678
loss_pred:0.03534749522805214, decouple_loss:0.01665085181593895
The generated pressure mean: 0.4443839490413666
loss_pred:0.034722160547971725, decouple_loss:0.01671421527862549
The generated pressure mean: 0.4409160614013672
loss_pred:0.034317925572395325, decouple_loss:0.016786927357316017
Iteration: 625, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4471721649169922
loss_pred:0.03546999767422676, decouple_loss:0.015305232256650925
The generated pressure mean: 0.43853428959846497
loss_pred:0.0346921943128109, decouple_loss:0.015879079699516296
The generated pressure mean: 0.4396853744983673
loss_pred:0.03490582853555679, decouple_loss:0.014749802649021149
Iteration: 626, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4429114758968353
loss_pred:0.03541890159249306, decouple_loss:0.015502523630857468
The generated pressure mean: 0.44244423508644104
loss_pred:0.036033470183610916, decouple_loss:0.0162084698677063
The generated pressure mean: 0.44154462218284607
loss_pred:0.0370500348508358, decouple_loss:0.016074808314442635
Iteration: 627, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44282281398773193
loss_pred:0.035630758851766586, decouple_loss:0.0142207657918334
The generated pressure mean: 0.44180381298065186
loss_pred:0.03525787591934204, decouple_loss:0.013859691098332405
The generated pressure mean: 0.4398007094860077
loss_pred:0.03583374619483948, decouple_loss:0.014721131883561611
Iteration: 628, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45560330152511597
loss_pred:0.03564634174108505, decouple_loss:0.016539135947823524
The generated pressure mean: 0.4511636197566986
loss_pred:0.03502778708934784, decouple_loss:0.01656181924045086
The generated pressure mean: 0.4511650502681732
loss_pred:0.03591294586658478, decouple_loss:0.016730643808841705
Iteration: 629, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45334944128990173
loss_pred:0.03461820259690285, decouple_loss:0.012847085483372211
The generated pressure mean: 0.44891268014907837
loss_pred:0.03532260283827782, decouple_loss:0.013045058585703373
The generated pressure mean: 0.44924941658973694
loss_pred:0.03592556342482567, decouple_loss:0.013248554430902004
Iteration: 630, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44543692469596863
loss_pred:0.03594182804226875, decouple_loss:0.014935065992176533
The generated pressure mean: 0.43472346663475037
loss_pred:0.03586938604712486, decouple_loss:0.015111851505935192
The generated pressure mean: 0.43740224838256836
loss_pred:0.03398333489894867, decouple_loss:0.015187853947281837
2023-04-16 03:49:57 testing...
The generated pressure mean: 0.4230312407016754
loss_pred:0.04495847225189209, decouple_loss:0.012159939855337143
The generated pressure mean: 0.4269729256629944
loss_pred:0.043293651193380356, decouple_loss:0.01225866749882698
The generated pressure mean: 0.43143847584724426
loss_pred:0.04384886100888252, decouple_loss:0.012776506133377552
Loss: 0.04465357959270477, avg_mse: 0.05331721156835556
current test mse: 0.053317
Iteration: 631, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4371456205844879
loss_pred:0.037076111882925034, decouple_loss:0.011130185797810555
The generated pressure mean: 0.43740954995155334
loss_pred:0.03490687534213066, decouple_loss:0.011159914545714855
The generated pressure mean: 0.4423823952674866
loss_pred:0.03399946913123131, decouple_loss:0.011486023664474487
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 632, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4419737756252289The generated pressure mean: 0.4462828040122986
loss_pred:0.0347815677523613, decouple_loss:0.012325544841587543
loss_pred:0.03434131294488907, decouple_loss:0.011908264830708504
The generated pressure mean: 0.44326621294021606
loss_pred:0.03556366264820099, decouple_loss:0.01212328765541315
Iteration: 633, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4540046453475952
loss_pred:0.034875668585300446, decouple_loss:0.010938018560409546
The generated pressure mean: 0.4550119638442993
loss_pred:0.03775780275464058, decouple_loss:0.011131159029901028
The generated pressure mean: 0.4507036805152893
loss_pred:0.03492961823940277, decouple_loss:0.01026865467429161
Iteration: 634, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4527665376663208
loss_pred:0.03428130969405174, decouple_loss:0.010950053110718727
The generated pressure mean: 0.4441075921058655
loss_pred:0.035448107868433, decouple_loss:0.01073998399078846
The generated pressure mean: 0.4456087648868561
loss_pred:0.03452534228563309, decouple_loss:0.01079507265239954
Iteration: 635, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4364951252937317
loss_pred:0.035679787397384644, decouple_loss:0.01108045969158411
The generated pressure mean: 0.4353560209274292
loss_pred:0.0377114862203598, decouple_loss:0.011435411870479584
The generated pressure mean: 0.4370808005332947
loss_pred:0.03635421022772789, decouple_loss:0.011423406191170216
Iteration: 636, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4559391140937805
loss_pred:0.03737237676978111, decouple_loss:0.012491114437580109
The generated pressure mean: 0.45337700843811035
loss_pred:0.03656488284468651, decouple_loss:0.011767026968300343
The generated pressure mean: 0.4554612636566162
loss_pred:0.037514906376600266, decouple_loss:0.01260482706129551
Iteration: 637, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45056426525115967
loss_pred:0.034813042730093, decouple_loss:0.013546811416745186
The generated pressure mean: 0.44842106103897095
loss_pred:0.0347050242125988, decouple_loss:0.013278027065098286
The generated pressure mean: 0.4509088695049286
loss_pred:0.03610415384173393, decouple_loss:0.013108346611261368
Iteration: 638, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4344497621059418
loss_pred:0.034306786954402924, decouple_loss:0.012232904322445393
The generated pressure mean: 0.4373238980770111
loss_pred:0.03575848788022995, decouple_loss:0.012213042937219143
The generated pressure mean: 0.43440553545951843
loss_pred:0.03717711567878723, decouple_loss:0.011808270588517189
Iteration: 639, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44342491030693054
loss_pred:0.035337768495082855, decouple_loss:0.010845866054296494
The generated pressure mean: 0.44801679253578186
loss_pred:0.03658830374479294, decouple_loss:0.010963424108922482
The generated pressure mean: 0.44390684366226196
loss_pred:0.0349421389400959, decouple_loss:0.010701391845941544
Iteration: 640, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4572645425796509
loss_pred:0.03412458673119545, decouple_loss:0.013013210147619247
The generated pressure mean: 0.4588843882083893
loss_pred:0.03520280122756958, decouple_loss:0.013284607790410519
The generated pressure mean: 0.4573463797569275
loss_pred:0.03486308082938194, decouple_loss:0.01328248344361782
2023-04-16 03:51:58 testing...
The generated pressure mean: 0.4205355644226074
loss_pred:0.046705495566129684, decouple_loss:0.01375714223831892
The generated pressure mean: 0.4243910014629364
loss_pred:0.04449837654829025, decouple_loss:0.013546342961490154
The generated pressure mean: 0.4283033013343811
loss_pred:0.045386653393507004, decouple_loss:0.0141944894567132
Loss: 0.04622180759906769, avg_mse: 0.05508119985461235
current test mse: 0.055081
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012008_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012008_3_24hr.npz
NaN value num: 0
Iteration: 641, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4453217387199402
loss_pred:0.03483501076698303, decouple_loss:0.014524020254611969
The generated pressure mean: 0.44474300742149353
loss_pred:0.03326745331287384, decouple_loss:0.0136558273807168
The generated pressure mean: 0.44867318868637085
loss_pred:0.033732008188962936, decouple_loss:0.013625114224851131
Iteration: 642, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43241235613822937
loss_pred:0.034877799451351166, decouple_loss:0.014130663126707077
The generated pressure mean: 0.42892399430274963
loss_pred:0.03382152318954468, decouple_loss:0.01364439819008112
The generated pressure mean: 0.43187376856803894
loss_pred:0.035204946994781494, decouple_loss:0.01398181077092886
Iteration: 643, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46280497312545776
loss_pred:0.03521817550063133, decouple_loss:0.014734909869730473
The generated pressure mean: 0.4638442099094391
loss_pred:0.03373432904481888, decouple_loss:0.014618690125644207
The generated pressure mean: 0.4669812321662903
loss_pred:0.033899128437042236, decouple_loss:0.014691793359816074
Iteration: 644, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45582300424575806
loss_pred:0.03292485699057579, decouple_loss:0.012704888358712196
The generated pressure mean: 0.4603181481361389
loss_pred:0.0366290807723999, decouple_loss:0.012989907525479794
The generated pressure mean: 0.46433812379837036
loss_pred:0.03416327387094498, decouple_loss:0.013165428303182125
Iteration: 645, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4278915524482727
The generated pressure mean: 0.4271214008331299
loss_pred:0.032957565039396286, decouple_loss:0.013653300702571869
loss_pred:0.03340385854244232, decouple_loss:0.015100333839654922
The generated pressure mean: 0.4274531304836273
loss_pred:0.03402252122759819, decouple_loss:0.013612625189125538
Iteration: 646, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4450741410255432
loss_pred:0.03455917537212372, decouple_loss:0.013381781056523323
The generated pressure mean: 0.4511260688304901
loss_pred:0.03407057002186775, decouple_loss:0.012662605382502079
The generated pressure mean: 0.4492241144180298
loss_pred:0.034807413816452026, decouple_loss:0.013349699787795544
Iteration: 647, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4599953889846802
loss_pred:0.03390518203377724, decouple_loss:0.012036132626235485
The generated pressure mean: 0.4620111882686615
loss_pred:0.03783790394663811, decouple_loss:0.012528973631560802
The generated pressure mean: 0.46229660511016846
loss_pred:0.03516867011785507, decouple_loss:0.012718797661364079
Iteration: 648, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4404933452606201
loss_pred:0.03577413782477379, decouple_loss:0.014856482855975628
The generated pressure mean: 0.4342677593231201
loss_pred:0.03587949275970459, decouple_loss:0.013615979813039303
The generated pressure mean: 0.43701472878456116
loss_pred:0.03284842148423195, decouple_loss:0.014347639866173267
Iteration: 649, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.441005140542984
loss_pred:0.03288833051919937, decouple_loss:0.012540034018456936
The generated pressure mean: 0.4407351613044739
loss_pred:0.032618626952171326, decouple_loss:0.01223313994705677
The generated pressure mean: 0.44414573907852173
loss_pred:0.03539777547121048, decouple_loss:0.012608702294528484
Iteration: 650, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4555361866950989
loss_pred:0.032653309404850006, decouple_loss:0.013687924481928349
The generated pressure mean: 0.4581407606601715
loss_pred:0.033987052738666534, decouple_loss:0.014074706472456455
The generated pressure mean: 0.45740655064582825
loss_pred:0.03424331918358803, decouple_loss:0.013903003185987473
2023-04-16 03:54:37 testing...
The generated pressure mean: 0.4225449562072754
loss_pred:0.04339056834578514, decouple_loss:0.013060241937637329
The generated pressure mean: 0.426658034324646
loss_pred:0.04224460944533348, decouple_loss:0.01340752188116312
The generated pressure mean: 0.43077024817466736
loss_pred:0.042581167072057724, decouple_loss:0.013447621837258339
Loss: 0.04340403899550438, avg_mse: 0.05208699777722359
current test mse: 0.052087
Iteration: 651, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44016188383102417
loss_pred:0.03503522276878357, decouple_loss:0.01220626849681139
The generated pressure mean: 0.43905577063560486
loss_pred:0.03139939531683922, decouple_loss:0.012161606922745705
The generated pressure mean: 0.44146978855133057
loss_pred:0.03241239860653877, decouple_loss:0.012445125728845596
Iteration: 652, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4376577138900757The generated pressure mean: 0.4391442835330963
loss_pred:0.0336209200322628, decouple_loss:0.014507505111396313
loss_pred:0.03240058198571205, decouple_loss:0.014649664983153343
The generated pressure mean: 0.43938353657722473
loss_pred:0.0330188050866127, decouple_loss:0.015041004866361618
Iteration: 653, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45514538884162903
loss_pred:0.033249277621507645, decouple_loss:0.012201986275613308
The generated pressure mean: 0.4554939270019531
loss_pred:0.0347953736782074, decouple_loss:0.012420031242072582
The generated pressure mean: 0.45297110080718994
loss_pred:0.03316531330347061, decouple_loss:0.011743010021746159
Iteration: 654, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44808658957481384
loss_pred:0.0346723273396492, decouple_loss:0.014278594404459
The generated pressure mean: 0.4451749324798584
loss_pred:0.03189900144934654, decouple_loss:0.014647526666522026
The generated pressure mean: 0.44538283348083496
loss_pred:0.034720081835985184, decouple_loss:0.015187148936092854
Iteration: 655, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4460980296134949
loss_pred:0.033473994582891464, decouple_loss:0.012464050203561783
The generated pressure mean: 0.445167601108551
loss_pred:0.03252043202519417, decouple_loss:0.012418246828019619
The generated pressure mean: 0.44842109084129333
loss_pred:0.03389398008584976, decouple_loss:0.012909939512610435
Iteration: 656, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44638174772262573
loss_pred:0.03270086273550987, decouple_loss:0.01313050091266632
The generated pressure mean: 0.44665277004241943
loss_pred:0.03204753249883652, decouple_loss:0.012848304584622383
The generated pressure mean: 0.4473623037338257
loss_pred:0.03400374948978424, decouple_loss:0.01228287722915411
Iteration: 657, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44700679183006287
loss_pred:0.03247721493244171, decouple_loss:0.01159605011343956
The generated pressure mean: 0.44878286123275757
loss_pred:0.03327758610248566, decouple_loss:0.012080544605851173
The generated pressure mean: 0.45449140667915344
loss_pred:0.03410889953374863, decouple_loss:0.013452582992613316
Iteration: 658, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45647624135017395
loss_pred:0.03441716730594635, decouple_loss:0.012242508120834827
The generated pressure mean: 0.4489627480506897
loss_pred:0.033278848975896835, decouple_loss:0.011164909228682518
The generated pressure mean: 0.4507524371147156
loss_pred:0.03374722972512245, decouple_loss:0.011216332204639912
Iteration: 659, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4297192096710205
loss_pred:0.032750651240348816, decouple_loss:0.010343941859900951
The generated pressure mean: 0.4325612783432007
loss_pred:0.03308750316500664, decouple_loss:0.009946894831955433
The generated pressure mean: 0.43455520272254944
loss_pred:0.034243348985910416, decouple_loss:0.010557210072875023
Iteration: 660, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4535440504550934
loss_pred:0.03195619583129883, decouple_loss:0.012450859881937504
The generated pressure mean: 0.4448810815811157
loss_pred:0.0325244702398777, decouple_loss:0.011413165368139744
The generated pressure mean: 0.4510800242424011
loss_pred:0.03310638666152954, decouple_loss:0.012130128219723701
2023-04-16 03:56:38 testing...
The generated pressure mean: 0.41752973198890686
loss_pred:0.04452970251441002, decouple_loss:0.012248216196894646
The generated pressure mean: 0.42168474197387695
loss_pred:0.04300190508365631, decouple_loss:0.012682552449405193
The generated pressure mean: 0.4260726571083069
loss_pred:0.04367483779788017, decouple_loss:0.012891191989183426
Loss: 0.04436584934592247, avg_mse: 0.05379577353596687
current test mse: 0.053796
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012016_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012016_3_24hr.npz
NaN value num: 0
Iteration: 661, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45780062675476074
loss_pred:0.03579891845583916, decouple_loss:0.01063650380820036
The generated pressure mean: 0.45730283856391907
The generated pressure mean: 0.45476868748664856
loss_pred:0.03358327969908714, decouple_loss:0.01231057196855545
loss_pred:0.03394816443324089, decouple_loss:0.011209149844944477
Iteration: 662, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43828898668289185
The generated pressure mean: 0.4365014433860779loss_pred:0.033907484263181686, decouple_loss:0.011748612858355045
loss_pred:0.03353693336248398, decouple_loss:0.011171527206897736
The generated pressure mean: 0.4375641345977783
loss_pred:0.03464476019144058, decouple_loss:0.011271456256508827
Iteration: 663, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4365033805370331
loss_pred:0.03384203091263771, decouple_loss:0.011499034240841866
The generated pressure mean: 0.4396936297416687
loss_pred:0.033967453986406326, decouple_loss:0.01092747412621975
The generated pressure mean: 0.43758973479270935
loss_pred:0.03538823127746582, decouple_loss:0.010741693899035454
Iteration: 664, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45748549699783325
loss_pred:0.033663228154182434, decouple_loss:0.011234592646360397
The generated pressure mean: 0.46024733781814575
loss_pred:0.03662814572453499, decouple_loss:0.011231781914830208
The generated pressure mean: 0.4581640362739563
loss_pred:0.03460411727428436, decouple_loss:0.011404585093259811
Iteration: 665, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44775334000587463
The generated pressure mean: 0.44288524985313416
loss_pred:0.03500845655798912, decouple_loss:0.011859874241054058
loss_pred:0.03382354974746704, decouple_loss:0.01215896662324667
The generated pressure mean: 0.44461676478385925
loss_pred:0.03246216103434563, decouple_loss:0.012222515419125557
Iteration: 666, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4385996460914612
The generated pressure mean: 0.44170570373535156
loss_pred:0.03276906535029411, decouple_loss:0.01084743719547987
loss_pred:0.03146488592028618, decouple_loss:0.010572966188192368
The generated pressure mean: 0.4380822479724884
loss_pred:0.03304947167634964, decouple_loss:0.010657421313226223
Iteration: 667, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44920870661735535
loss_pred:0.0331355482339859, decouple_loss:0.01143625658005476
The generated pressure mean: 0.4503175914287567
loss_pred:0.03565133735537529, decouple_loss:0.011672290973365307
The generated pressure mean: 0.4480167031288147
loss_pred:0.03486999496817589, decouple_loss:0.011643401347100735
Iteration: 668, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4441083073616028
loss_pred:0.03373093158006668, decouple_loss:0.012502226047217846
The generated pressure mean: 0.4421752393245697
loss_pred:0.03402729332447052, decouple_loss:0.01252384390681982
The generated pressure mean: 0.4434366226196289
loss_pred:0.035940781235694885, decouple_loss:0.01320586632937193
Iteration: 669, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45856305956840515
loss_pred:0.03410372510552406, decouple_loss:0.011515941470861435
The generated pressure mean: 0.46256396174430847
loss_pred:0.03238540515303612, decouple_loss:0.011501625180244446
The generated pressure mean: 0.4608810245990753
loss_pred:0.03370467945933342, decouple_loss:0.011578595265746117
Iteration: 670, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4290752708911896
The generated pressure mean: 0.42660707235336304
loss_pred:0.03318345174193382, decouple_loss:0.013204813003540039
loss_pred:0.033159930258989334, decouple_loss:0.011028941720724106
The generated pressure mean: 0.42902761697769165
loss_pred:0.03348388150334358, decouple_loss:0.01135317049920559
2023-04-16 03:59:23 testing...
The generated pressure mean: 0.42125165462493896
loss_pred:0.044284891337156296, decouple_loss:0.012797163799405098
The generated pressure mean: 0.42586731910705566
loss_pred:0.043593984097242355, decouple_loss:0.012721157632768154
The generated pressure mean: 0.4308728575706482
loss_pred:0.043467845767736435, decouple_loss:0.013196154497563839
Loss: 0.04442748427391052, avg_mse: 0.054602332413196564
current test mse: 0.054602
Iteration: 671, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45335572957992554
loss_pred:0.03312394395470619, decouple_loss:0.010897290892899036
The generated pressure mean: 0.4504215717315674
loss_pred:0.032335564494132996, decouple_loss:0.012024764902889729
The generated pressure mean: 0.449604332447052
loss_pred:0.033581145107746124, decouple_loss:0.011829773895442486
Iteration: 672, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4577672779560089
The generated pressure mean: 0.46060991287231445
loss_pred:0.03445165604352951, decouple_loss:0.013108469545841217
loss_pred:0.03466109186410904, decouple_loss:0.012344800867140293
The generated pressure mean: 0.4612562656402588
loss_pred:0.032719917595386505, decouple_loss:0.012721830047667027
Iteration: 673, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43772247433662415
The generated pressure mean: 0.4410913288593292
loss_pred:0.03262804448604584, decouple_loss:0.011149781756103039
loss_pred:0.03346453979611397, decouple_loss:0.01134832575917244
The generated pressure mean: 0.4391437768936157
loss_pred:0.032848406583070755, decouple_loss:0.011884370818734169
Iteration: 674, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43199482560157776
loss_pred:0.03283442184329033, decouple_loss:0.010434179566800594
The generated pressure mean: 0.4327224791049957
loss_pred:0.034981511533260345, decouple_loss:0.011135347187519073
The generated pressure mean: 0.4343019425868988
loss_pred:0.03437850996851921, decouple_loss:0.011713782325387001
Iteration: 675, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4459051191806793
loss_pred:0.03454580530524254, decouple_loss:0.01095556654036045
The generated pressure mean: 0.45152249932289124
loss_pred:0.03151950240135193, decouple_loss:0.010699880309402943
The generated pressure mean: 0.4510953724384308
loss_pred:0.03303179889917374, decouple_loss:0.011511333286762238
Iteration: 676, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46077579259872437
loss_pred:0.03526555374264717, decouple_loss:0.012022898532450199
The generated pressure mean: 0.45945659279823303
loss_pred:0.03598406910896301, decouple_loss:0.011546899564564228
The generated pressure mean: 0.4540202021598816
loss_pred:0.03216591849923134, decouple_loss:0.012056084349751472
Iteration: 677, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4472673535346985
loss_pred:0.033008359372615814, decouple_loss:0.012562497518956661
The generated pressure mean: 0.4473530352115631
loss_pred:0.03479649871587753, decouple_loss:0.013419412076473236
The generated pressure mean: 0.44623664021492004
loss_pred:0.033788569271564484, decouple_loss:0.012788371182978153
Iteration: 678, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4368824064731598
The generated pressure mean: 0.4371245503425598loss_pred:0.03562292829155922, decouple_loss:0.013179355300962925
loss_pred:0.03433974087238312, decouple_loss:0.01286107487976551
The generated pressure mean: 0.43646758794784546
loss_pred:0.03331810235977173, decouple_loss:0.013025590218603611
Iteration: 679, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.438376784324646
loss_pred:0.03260089457035065, decouple_loss:0.017729640007019043
The generated pressure mean: 0.43538859486579895
loss_pred:0.032904308289289474, decouple_loss:0.01826290786266327
The generated pressure mean: 0.4388960897922516
loss_pred:0.03423852473497391, decouple_loss:0.0191193837672472
Iteration: 680, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4683031439781189
loss_pred:0.03398333489894867, decouple_loss:0.012980595231056213
The generated pressure mean: 0.47212594747543335
loss_pred:0.03607691451907158, decouple_loss:0.013128463178873062
The generated pressure mean: 0.47258877754211426
loss_pred:0.03442460298538208, decouple_loss:0.012381783686578274
2023-04-16 04:01:24 testing...
The generated pressure mean: 0.42229998111724854
loss_pred:0.04549635201692581, decouple_loss:0.015287743881344795
The generated pressure mean: 0.42693236470222473
loss_pred:0.04374395310878754, decouple_loss:0.015003074891865253
The generated pressure mean: 0.4314653277397156
loss_pred:0.043963123112916946, decouple_loss:0.015590923838317394
Loss: 0.045165836811065674, avg_mse: 0.05605475977063179
current test mse: 0.056055
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012002_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012002_3_24hr.npz
NaN value num: 0
Iteration: 681, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44473716616630554
loss_pred:0.03243960812687874, decouple_loss:0.01486612856388092
The generated pressure mean: 0.4438188076019287
loss_pred:0.033507246524095535, decouple_loss:0.014830837026238441
The generated pressure mean: 0.44250449538230896
loss_pred:0.0311967134475708, decouple_loss:0.014989311806857586
Iteration: 682, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.424909383058548
The generated pressure mean: 0.4252021610736847
loss_pred:0.031531766057014465, decouple_loss:0.01316706370562315
loss_pred:0.033725012093782425, decouple_loss:0.013082968071103096
The generated pressure mean: 0.4265541732311249
loss_pred:0.03036092408001423, decouple_loss:0.013845161534845829
Iteration: 683, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4665486514568329
loss_pred:0.030129194259643555, decouple_loss:0.01261423621326685
The generated pressure mean: 0.47935056686401367
The generated pressure mean: 0.4711012840270996
loss_pred:0.034249745309352875, decouple_loss:0.012550091370940208
loss_pred:0.03148872032761574, decouple_loss:0.012222027406096458
Iteration: 684, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45464077591896057
loss_pred:0.035000432282686234, decouple_loss:0.012194265611469746
The generated pressure mean: 0.4533954858779907
loss_pred:0.03125207871198654, decouple_loss:0.010913891717791557
The generated pressure mean: 0.45484063029289246
loss_pred:0.03279786929488182, decouple_loss:0.010342855006456375
Iteration: 685, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.410253643989563
loss_pred:0.03597718104720116, decouple_loss:0.012872571125626564
The generated pressure mean: 0.41232094168663025
loss_pred:0.03468609228730202, decouple_loss:0.012270595878362656
The generated pressure mean: 0.4053519666194916
loss_pred:0.0341215580701828, decouple_loss:0.011436057277023792
Iteration: 686, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4727291166782379
loss_pred:0.03224063664674759, decouple_loss:0.012937269173562527
The generated pressure mean: 0.46560922265052795
loss_pred:0.031161034479737282, decouple_loss:0.013093816116452217
The generated pressure mean: 0.4699518382549286
loss_pred:0.034118179231882095, decouple_loss:0.013733231462538242
Iteration: 687, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46359118819236755
loss_pred:0.03410324826836586, decouple_loss:0.01457766443490982
The generated pressure mean: 0.4713234007358551
loss_pred:0.0346030630171299, decouple_loss:0.013028262183070183
The generated pressure mean: 0.4694007933139801
loss_pred:0.03458528593182564, decouple_loss:0.014065897092223167
Iteration: 688, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4288293123245239
loss_pred:0.031363558024168015, decouple_loss:0.012725578621029854
The generated pressure mean: 0.4332827925682068
loss_pred:0.033509962260723114, decouple_loss:0.011862770654261112
The generated pressure mean: 0.42956024408340454
loss_pred:0.033502742648124695, decouple_loss:0.012351910583674908
Iteration: 689, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44411370158195496
loss_pred:0.030400339514017105, decouple_loss:0.014901820570230484
The generated pressure mean: 0.4410094916820526
loss_pred:0.031690847128629684, decouple_loss:0.014656756073236465
The generated pressure mean: 0.44231367111206055
loss_pred:0.0328846275806427, decouple_loss:0.014338703826069832
Iteration: 690, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45369160175323486
loss_pred:0.03220393508672714, decouple_loss:0.012534546665847301
The generated pressure mean: 0.44619613885879517
loss_pred:0.03441700339317322, decouple_loss:0.012675046920776367
The generated pressure mean: 0.4461362957954407
loss_pred:0.034099280834198, decouple_loss:0.012740717269480228
2023-04-16 04:04:01 testing...
The generated pressure mean: 0.41965460777282715
loss_pred:0.04319281503558159, decouple_loss:0.014762087725102901
The generated pressure mean: 0.42517930269241333
loss_pred:0.04225385561585426, decouple_loss:0.014848523773252964
The generated pressure mean: 0.4285805821418762
loss_pred:0.04267648607492447, decouple_loss:0.015215328894555569
Loss: 0.04345482215285301, avg_mse: 0.05330308899283409
current test mse: 0.053303
Iteration: 691, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45451921224594116
The generated pressure mean: 0.4513973593711853
loss_pred:0.03338366001844406, decouple_loss:0.012835818342864513
loss_pred:0.0337839312851429, decouple_loss:0.012806247919797897
The generated pressure mean: 0.45488011837005615
loss_pred:0.03267734870314598, decouple_loss:0.013394005596637726
Iteration: 692, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4455430805683136
The generated pressure mean: 0.4474772810935974
loss_pred:0.032269831746816635, decouple_loss:0.013222211971879005
loss_pred:0.0314299650490284, decouple_loss:0.014391939155757427
The generated pressure mean: 0.44557473063468933
loss_pred:0.03264017775654793, decouple_loss:0.013003462925553322
Iteration: 693, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4544745981693268
loss_pred:0.03412990644574165, decouple_loss:0.010862010531127453
The generated pressure mean: 0.4551289677619934
loss_pred:0.03301480785012245, decouple_loss:0.011147492565214634
The generated pressure mean: 0.45239290595054626
loss_pred:0.032094281166791916, decouple_loss:0.011139165610074997
Iteration: 694, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4358227550983429
loss_pred:0.030414540320634842, decouple_loss:0.013058516196906567
The generated pressure mean: 0.4377821385860443
loss_pred:0.03497022017836571, decouple_loss:0.013269183225929737
The generated pressure mean: 0.4317246377468109
loss_pred:0.03026888333261013, decouple_loss:0.013595379889011383
Iteration: 695, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45790717005729675
loss_pred:0.0313127227127552, decouple_loss:0.011280547827482224
The generated pressure mean: 0.4596092104911804
loss_pred:0.031409040093421936, decouple_loss:0.01189470011740923
The generated pressure mean: 0.45896458625793457
loss_pred:0.033043023198843, decouple_loss:0.01213992852717638
Iteration: 696, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4559260904788971
loss_pred:0.03264131024479866, decouple_loss:0.010990537703037262
The generated pressure mean: 0.4568636417388916
loss_pred:0.0331386961042881, decouple_loss:0.010990826413035393
The generated pressure mean: 0.45230552554130554
loss_pred:0.031687136739492416, decouple_loss:0.010990218259394169
Iteration: 697, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.42499253153800964
loss_pred:0.029945312067866325, decouple_loss:0.01157986931502819
The generated pressure mean: 0.4270816147327423
loss_pred:0.033201079815626144, decouple_loss:0.011518692597746849
The generated pressure mean: 0.42534399032592773
loss_pred:0.032576337456703186, decouple_loss:0.011371200904250145
Iteration: 698, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4520972967147827
loss_pred:0.028635509312152863, decouple_loss:0.012237207032740116
The generated pressure mean: 0.45514029264450073
loss_pred:0.032404836267232895, decouple_loss:0.0114074582234025
The generated pressure mean: 0.45358484983444214
loss_pred:0.03161442279815674, decouple_loss:0.011975186876952648
Iteration: 699, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46953821182250977
loss_pred:0.03324081376194954, decouple_loss:0.01058997493237257
The generated pressure mean: 0.46692755818367004
loss_pred:0.03233092650771141, decouple_loss:0.010541174560785294
The generated pressure mean: 0.4670393764972687
loss_pred:0.033039480447769165, decouple_loss:0.010458584874868393
Iteration: 700, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43393272161483765
loss_pred:0.031197629868984222, decouple_loss:0.012113712728023529
The generated pressure mean: 0.43818190693855286
loss_pred:0.0315193235874176, decouple_loss:0.011916665360331535
The generated pressure mean: 0.4378461539745331
loss_pred:0.031844623386859894, decouple_loss:0.011702949181199074
2023-04-16 04:06:01 testing...
The generated pressure mean: 0.42422419786453247
loss_pred:0.042477916926145554, decouple_loss:0.01268758624792099
The generated pressure mean: 0.4301683008670807
loss_pred:0.04127705469727516, decouple_loss:0.012400523759424686
The generated pressure mean: 0.434201717376709
loss_pred:0.04165508598089218, decouple_loss:0.013023440726101398
Loss: 0.04243854805827141, avg_mse: 0.051768239587545395
current test mse: 0.051768
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012010_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012010_3_24hr.npz
NaN value num: 0
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 701, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4359220862388611
loss_pred:0.03263453394174576, decouple_loss:0.011737550608813763
The generated pressure mean: 0.4349849224090576
loss_pred:0.03258923441171646, decouple_loss:0.011522711254656315
The generated pressure mean: 0.4331720173358917
loss_pred:0.03299456089735031, decouple_loss:0.01159434113651514
Iteration: 702, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45061323046684265
loss_pred:0.033311087638139725, decouple_loss:0.012215257622301579
The generated pressure mean: 0.4483197331428528
loss_pred:0.032283663749694824, decouple_loss:0.011892694979906082
The generated pressure mean: 0.45204436779022217
loss_pred:0.032962046563625336, decouple_loss:0.012513529509305954
Iteration: 703, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44187110662460327
loss_pred:0.03210267052054405, decouple_loss:0.011035870760679245
The generated pressure mean: 0.4409622251987457
loss_pred:0.0326121523976326, decouple_loss:0.011432101018726826
The generated pressure mean: 0.4448183476924896
loss_pred:0.03255074471235275, decouple_loss:0.011060201562941074
Iteration: 704, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4467605948448181
loss_pred:0.031193437054753304, decouple_loss:0.011504651047289371
The generated pressure mean: 0.44665858149528503
loss_pred:0.0329228937625885, decouple_loss:0.011067548766732216
The generated pressure mean: 0.44401219487190247
loss_pred:0.03387828171253204, decouple_loss:0.010832514613866806
Iteration: 705, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46476778388023376
loss_pred:0.035185616463422775, decouple_loss:0.01212366297841072
The generated pressure mean: 0.46679070591926575
loss_pred:0.03211606293916702, decouple_loss:0.011439754627645016
The generated pressure mean: 0.46466273069381714
loss_pred:0.032845932990312576, decouple_loss:0.011219131760299206
Iteration: 706, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43708527088165283
loss_pred:0.034053582698106766, decouple_loss:0.011630091816186905
The generated pressure mean: 0.43629762530326843
loss_pred:0.03228222578763962, decouple_loss:0.011744983494281769
The generated pressure mean: 0.4396515488624573
loss_pred:0.031762588769197464, decouple_loss:0.011610382236540318
Iteration: 707, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43304410576820374
loss_pred:0.03384916111826897, decouple_loss:0.011038990691304207
The generated pressure mean: 0.4316270351409912
loss_pred:0.03157694265246391, decouple_loss:0.011670183390378952
The generated pressure mean: 0.4267391264438629
loss_pred:0.03299178555607796, decouple_loss:0.011106474325060844
Iteration: 708, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4550444781780243
loss_pred:0.03144415095448494, decouple_loss:0.009917721152305603
The generated pressure mean: 0.4579286575317383
loss_pred:0.03136732429265976, decouple_loss:0.010164406150579453
The generated pressure mean: 0.45341238379478455
loss_pred:0.03167710453271866, decouple_loss:0.010768248699605465
Iteration: 709, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46342527866363525
loss_pred:0.03323354572057724, decouple_loss:0.011602377519011497
The generated pressure mean: 0.46542415022850037
loss_pred:0.03133338689804077, decouple_loss:0.012043265625834465
The generated pressure mean: 0.4667520523071289
loss_pred:0.03146609291434288, decouple_loss:0.011976194567978382
Iteration: 710, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43216371536254883
loss_pred:0.0318373441696167, decouple_loss:0.011232688091695309
The generated pressure mean: 0.43406611680984497
loss_pred:0.03211779147386551, decouple_loss:0.01125069335103035
The generated pressure mean: 0.42966580390930176
loss_pred:0.03258238732814789, decouple_loss:0.011438516899943352
2023-04-16 04:08:39 testing...
The generated pressure mean: 0.4233197271823883
loss_pred:0.0422164611518383, decouple_loss:0.011836592108011246
The generated pressure mean: 0.42956551909446716
loss_pred:0.040711600333452225, decouple_loss:0.01199769414961338
The generated pressure mean: 0.434040367603302
loss_pred:0.04175734519958496, decouple_loss:0.012326955795288086
Loss: 0.04216448962688446, avg_mse: 0.05198325216770172
current test mse: 0.051983
Iteration: 711, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43961232900619507
loss_pred:0.03170851618051529, decouple_loss:0.011323025450110435
The generated pressure mean: 0.4381975829601288
loss_pred:0.03146105632185936, decouple_loss:0.011407001875340939
The generated pressure mean: 0.4363279938697815
loss_pred:0.03197607398033142, decouple_loss:0.01095634512603283
Iteration: 712, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45889949798583984
loss_pred:0.03294258192181587, decouple_loss:0.011545027606189251
The generated pressure mean: 0.46192172169685364
loss_pred:0.033396027982234955, decouple_loss:0.011232688091695309
The generated pressure mean: 0.4584476947784424
loss_pred:0.032384660094976425, decouple_loss:0.011464348994195461
Iteration: 713, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44383496046066284
loss_pred:0.031024709343910217, decouple_loss:0.012790331616997719
The generated pressure mean: 0.44442442059516907
loss_pred:0.03394282981753349, decouple_loss:0.0133658517152071
The generated pressure mean: 0.44417768716812134
loss_pred:0.03268799930810928, decouple_loss:0.013515070080757141
Iteration: 714, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44276556372642517
loss_pred:0.034236691892147064, decouple_loss:0.01095400657504797
The generated pressure mean: 0.4415229558944702
loss_pred:0.03440067172050476, decouple_loss:0.011001802049577236
The generated pressure mean: 0.4432045817375183
loss_pred:0.03486244007945061, decouple_loss:0.011170736514031887
Iteration: 715, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43930909037590027
loss_pred:0.03464631363749504, decouple_loss:0.013079054653644562
The generated pressure mean: 0.4371013939380646
loss_pred:0.03693840652704239, decouple_loss:0.01374188344925642
The generated pressure mean: 0.44112804532051086
loss_pred:0.037181541323661804, decouple_loss:0.012920711189508438
Iteration: 716, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.48768389225006104
loss_pred:0.03533601015806198, decouple_loss:0.013889797031879425
The generated pressure mean: 0.49255549907684326
loss_pred:0.03521120175719261, decouple_loss:0.013540460728108883
The generated pressure mean: 0.4888341426849365
loss_pred:0.03256123512983322, decouple_loss:0.012957911007106304
Iteration: 717, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43647247552871704
loss_pred:0.0333251915872097, decouple_loss:0.0115922000259161
The generated pressure mean: 0.4319080114364624
loss_pred:0.03280719369649887, decouple_loss:0.0119757279753685
The generated pressure mean: 0.43506795167922974
loss_pred:0.034005772322416306, decouple_loss:0.011671270243823528
Iteration: 718, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4203336238861084
loss_pred:0.03261914104223251, decouple_loss:0.01359881367534399
The generated pressure mean: 0.4211791455745697
loss_pred:0.03295593336224556, decouple_loss:0.012814730405807495
The generated pressure mean: 0.4263244569301605
loss_pred:0.03436329588294029, decouple_loss:0.013816777616739273
Iteration: 719, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4541701674461365
loss_pred:0.03480226919054985, decouple_loss:0.012514417059719563
The generated pressure mean: 0.4500364661216736
loss_pred:0.03322314843535423, decouple_loss:0.012291631661355495
The generated pressure mean: 0.45097002387046814
loss_pred:0.0321236290037632, decouple_loss:0.012564565986394882
Iteration: 720, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4622389078140259
loss_pred:0.03308834880590439, decouple_loss:0.012172047048807144
The generated pressure mean: 0.45676523447036743
loss_pred:0.030523624271154404, decouple_loss:0.011891853995621204
The generated pressure mean: 0.45869383215904236
loss_pred:0.03461696580052376, decouple_loss:0.012235757894814014
2023-04-16 04:10:39 testing...
The generated pressure mean: 0.42290398478507996
loss_pred:0.04722342640161514, decouple_loss:0.014037947170436382
The generated pressure mean: 0.4280414581298828
loss_pred:0.04430636018514633, decouple_loss:0.014310123398900032
The generated pressure mean: 0.4326496422290802
loss_pred:0.04535394161939621, decouple_loss:0.014612908475100994
Loss: 0.04634392261505127, avg_mse: 0.05667371675372124
current test mse: 0.056674
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012006_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012006_3_24hr.npz
NaN value num: 0
Iteration: 721, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4351653754711151
loss_pred:0.03541475161910057, decouple_loss:0.012855120934545994
The generated pressure mean: 0.4358498156070709
loss_pred:0.03212374821305275, decouple_loss:0.012786241248250008
The generated pressure mean: 0.4331895709037781
loss_pred:0.03425315022468567, decouple_loss:0.013343356549739838
Iteration: 722, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45340943336486816
The generated pressure mean: 0.4502846896648407
loss_pred:0.033467333763837814, decouple_loss:0.012957517057657242
loss_pred:0.032789453864097595, decouple_loss:0.013957925140857697
The generated pressure mean: 0.4527602791786194
loss_pred:0.03376748785376549, decouple_loss:0.013916237279772758
Iteration: 723, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45614126324653625
loss_pred:0.03414854034781456, decouple_loss:0.012249152176082134
The generated pressure mean: 0.4580584466457367
The generated pressure mean: 0.4561086893081665
loss_pred:0.033802516758441925, decouple_loss:0.012321420013904572
loss_pred:0.033467985689640045, decouple_loss:0.012329040095210075
Iteration: 724, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4268401265144348
loss_pred:0.03327867388725281, decouple_loss:0.014845999889075756
The generated pressure mean: 0.43163424730300903
loss_pred:0.03362322598695755, decouple_loss:0.014026524499058723
The generated pressure mean: 0.4250791072845459
loss_pred:0.03316402807831764, decouple_loss:0.013427131809294224
Iteration: 725, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43370962142944336
loss_pred:0.03269072249531746, decouple_loss:0.011937351897358894
The generated pressure mean: 0.4351215958595276
loss_pred:0.031387392431497574, decouple_loss:0.012445359490811825
The generated pressure mean: 0.43733927607536316
loss_pred:0.03420265018939972, decouple_loss:0.012160062789916992
Iteration: 726, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45322689414024353
loss_pred:0.033376920968294144, decouple_loss:0.012887411750853062
The generated pressure mean: 0.4543531835079193
loss_pred:0.03333381563425064, decouple_loss:0.012603174895048141
The generated pressure mean: 0.4535667300224304
loss_pred:0.03324681520462036, decouple_loss:0.012982170097529888
Iteration: 727, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46352419257164
loss_pred:0.03202313184738159, decouple_loss:0.012457347474992275
The generated pressure mean: 0.4666977822780609
loss_pred:0.032103992998600006, decouple_loss:0.012020423077046871
The generated pressure mean: 0.4657514691352844
loss_pred:0.03178998455405235, decouple_loss:0.011574252508580685
Iteration: 728, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44970449805259705
loss_pred:0.03427714854478836, decouple_loss:0.012081891298294067
The generated pressure mean: 0.4508701264858246
loss_pred:0.03522278741002083, decouple_loss:0.012163622304797173
The generated pressure mean: 0.4510861039161682
loss_pred:0.03374476358294487, decouple_loss:0.011695043183863163
Iteration: 729, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4286578297615051
loss_pred:0.03136557340621948, decouple_loss:0.011358138173818588
The generated pressure mean: 0.42911267280578613
loss_pred:0.0328243151307106, decouple_loss:0.011593188159167767
The generated pressure mean: 0.43001019954681396
loss_pred:0.033095356076955795, decouple_loss:0.011774932965636253
Iteration: 730, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43322232365608215
The generated pressure mean: 0.4333271086215973
loss_pred:0.030718659982085228, decouple_loss:0.01151246391236782
loss_pred:0.03270823135972023, decouple_loss:0.010954676195979118
The generated pressure mean: 0.43929827213287354
loss_pred:0.030778275802731514, decouple_loss:0.011094331741333008
2023-04-16 04:13:15 testing...
The generated pressure mean: 0.41524580121040344
loss_pred:0.043349552899599075, decouple_loss:0.012064236216247082
The generated pressure mean: 0.42117926478385925
loss_pred:0.04232141003012657, decouple_loss:0.012028858996927738
The generated pressure mean: 0.4253835082054138
loss_pred:0.04258221387863159, decouple_loss:0.012555776163935661
Loss: 0.04336187243461609, avg_mse: 0.054435014724731445
current test mse: 0.054435
Iteration: 731, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45988836884498596
The generated pressure mean: 0.4651067554950714loss_pred:0.03286696597933769, decouple_loss:0.011449279263615608
loss_pred:0.032044246792793274, decouple_loss:0.011311223730444908
The generated pressure mean: 0.46437549591064453
loss_pred:0.03176272660493851, decouple_loss:0.011615176685154438
Iteration: 732, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46276965737342834
The generated pressure mean: 0.45640793442726135
loss_pred:0.03377636522054672, decouple_loss:0.010643744841217995
loss_pred:0.03326389566063881, decouple_loss:0.010743738152086735
The generated pressure mean: 0.4598356783390045
loss_pred:0.03237900137901306, decouple_loss:0.010905202478170395
Iteration: 733, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43791332840919495
loss_pred:0.03179183229804039, decouple_loss:0.010740326717495918
The generated pressure mean: 0.43629565834999084
loss_pred:0.03267844393849373, decouple_loss:0.010803512297570705
The generated pressure mean: 0.44101065397262573
loss_pred:0.033037785440683365, decouple_loss:0.01116997841745615
Iteration: 734, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4298553466796875
loss_pred:0.034001268446445465, decouple_loss:0.009799575433135033
The generated pressure mean: 0.43052196502685547
loss_pred:0.03291090205311775, decouple_loss:0.009562508203089237
The generated pressure mean: 0.42904913425445557
loss_pred:0.033510107547044754, decouple_loss:0.009720772504806519
Iteration: 735, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4432631731033325
loss_pred:0.03223729878664017, decouple_loss:0.010973594151437283
The generated pressure mean: 0.4440563917160034
loss_pred:0.032581254839897156, decouple_loss:0.011107671074569225
The generated pressure mean: 0.44406506419181824
loss_pred:0.034225527197122574, decouple_loss:0.011064200662076473
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 736, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46814507246017456
loss_pred:0.032305218279361725, decouple_loss:0.009337651543319225
The generated pressure mean: 0.46732690930366516
loss_pred:0.030916525050997734, decouple_loss:0.00965562742203474
The generated pressure mean: 0.46975502371788025
loss_pred:0.03304904326796532, decouple_loss:0.009510664269328117
Iteration: 737, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46042677760124207
loss_pred:0.03323175758123398, decouple_loss:0.009883753955364227
The generated pressure mean: 0.4594857394695282
loss_pred:0.03221491724252701, decouple_loss:0.009770295582711697
The generated pressure mean: 0.45539501309394836
loss_pred:0.03224896267056465, decouple_loss:0.009858781471848488
Iteration: 738, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4217853844165802
loss_pred:0.033472735434770584, decouple_loss:0.009946691803634167
The generated pressure mean: 0.4196259081363678
loss_pred:0.0330059789121151, decouple_loss:0.009990141727030277
The generated pressure mean: 0.4200754463672638
loss_pred:0.031190108507871628, decouple_loss:0.010805809870362282
Iteration: 739, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4348568022251129
loss_pred:0.03197681903839111, decouple_loss:0.009753698483109474
The generated pressure mean: 0.43386369943618774
loss_pred:0.031853724271059036, decouple_loss:0.0097396494820714
The generated pressure mean: 0.431749165058136
loss_pred:0.03169706091284752, decouple_loss:0.00981209333986044
Iteration: 740, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.48171937465667725
loss_pred:0.03258253261446953, decouple_loss:0.011157449334859848
The generated pressure mean: 0.48151618242263794
loss_pred:0.03317581117153168, decouple_loss:0.011101200245320797
The generated pressure mean: 0.47845038771629333
loss_pred:0.03130312263965607, decouple_loss:0.010825647972524166
2023-04-16 04:15:16 testing...
The generated pressure mean: 0.41737857460975647
loss_pred:0.04457264393568039, decouple_loss:0.01111567858606577
The generated pressure mean: 0.4212409257888794
loss_pred:0.04302143678069115, decouple_loss:0.011043363250792027
The generated pressure mean: 0.4246239960193634
loss_pred:0.04366638511419296, decouple_loss:0.011600040830671787
Loss: 0.044316139072179794, avg_mse: 0.054635364562273026
current test mse: 0.054635
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012006_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012006_3_24hr.npz
NaN value num: 0
Iteration: 741, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44913673400878906
loss_pred:0.029582954943180084, decouple_loss:0.01015002653002739
The generated pressure mean: 0.450278639793396
loss_pred:0.030916010960936546, decouple_loss:0.010660901665687561
The generated pressure mean: 0.44927412271499634
loss_pred:0.030030516907572746, decouple_loss:0.010109895840287209
Iteration: 742, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4195176064968109
loss_pred:0.03223127871751785, decouple_loss:0.011338233947753906
The generated pressure mean: 0.422257661819458
loss_pred:0.03295942023396492, decouple_loss:0.011065294966101646
The generated pressure mean: 0.4210502505302429
loss_pred:0.03016844019293785, decouple_loss:0.011041147634387016
Iteration: 743, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44458088278770447
loss_pred:0.031224841251969337, decouple_loss:0.01153609063476324
The generated pressure mean: 0.44268718361854553
loss_pred:0.03220122307538986, decouple_loss:0.011220891028642654
The generated pressure mean: 0.44319772720336914
loss_pred:0.029485508799552917, decouple_loss:0.011015784926712513
Iteration: 744, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4674707055091858
loss_pred:0.03288332000374794, decouple_loss:0.010304617695510387
The generated pressure mean: 0.46523821353912354
loss_pred:0.032106202095746994, decouple_loss:0.009982777759432793
The generated pressure mean: 0.46552544832229614
loss_pred:0.030352113768458366, decouple_loss:0.00982319749891758
Iteration: 745, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4522645175457001
loss_pred:0.031856968998909, decouple_loss:0.011502214707434177
The generated pressure mean: 0.45107409358024597
loss_pred:0.030820580199360847, decouple_loss:0.011382860131561756
The generated pressure mean: 0.4528985023498535
loss_pred:0.030792726203799248, decouple_loss:0.0116847800090909
Iteration: 746, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4374437928199768
loss_pred:0.03194835036993027, decouple_loss:0.011191066354513168
The generated pressure mean: 0.43493881821632385
loss_pred:0.031298235058784485, decouple_loss:0.010660042054951191
The generated pressure mean: 0.43546128273010254
loss_pred:0.029842745512723923, decouple_loss:0.011077801696956158
Iteration: 747, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4422030746936798
loss_pred:0.032494377344846725, decouple_loss:0.011411615647375584
The generated pressure mean: 0.4447748064994812
loss_pred:0.03255154564976692, decouple_loss:0.011691841296851635
The generated pressure mean: 0.44053688645362854
loss_pred:0.03149409592151642, decouple_loss:0.011512406170368195
Iteration: 748, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4477701187133789
loss_pred:0.03081577457487583, decouple_loss:0.011291944421827793
The generated pressure mean: 0.4523700773715973
loss_pred:0.0317099392414093, decouple_loss:0.011609330773353577
The generated pressure mean: 0.44434019923210144
loss_pred:0.030832432210445404, decouple_loss:0.011436371132731438
Iteration: 749, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.451370507478714
loss_pred:0.030967270955443382, decouple_loss:0.010842477902770042
The generated pressure mean: 0.45438289642333984
loss_pred:0.03388237953186035, decouple_loss:0.011127030476927757
The generated pressure mean: 0.4501170814037323
loss_pred:0.03234003111720085, decouple_loss:0.010810631327331066
Iteration: 750, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45375382900238037
loss_pred:0.03263311833143234, decouple_loss:0.011440195143222809
The generated pressure mean: 0.45403122901916504
loss_pred:0.0311664380133152, decouple_loss:0.011999286711215973
The generated pressure mean: 0.4487937390804291
loss_pred:0.03306072950363159, decouple_loss:0.01214172225445509
2023-04-16 04:17:51 testing...
The generated pressure mean: 0.42395928502082825
loss_pred:0.041185688227415085, decouple_loss:0.011700999923050404
The generated pressure mean: 0.4294511377811432
loss_pred:0.04041057825088501, decouple_loss:0.011489208787679672
The generated pressure mean: 0.43357446789741516
loss_pred:0.04032856225967407, decouple_loss:0.011915239505469799
Loss: 0.04122670367360115, avg_mse: 0.050814270973205566
current test mse: 0.050814
Iteration: 751, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43675845861434937
loss_pred:0.031010741367936134, decouple_loss:0.01114756241440773The generated pressure mean: 0.4339209198951721
loss_pred:0.0315842404961586, decouple_loss:0.01044267788529396
The generated pressure mean: 0.4334452152252197
loss_pred:0.03091084398329258, decouple_loss:0.010560572147369385
Iteration: 752, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4286348521709442
The generated pressure mean: 0.4368525743484497
loss_pred:0.030676601454615593, decouple_loss:0.011817985214293003
loss_pred:0.030832014977931976, decouple_loss:0.011364303529262543
The generated pressure mean: 0.4274556040763855
loss_pred:0.03074462339282036, decouple_loss:0.012262744829058647
Iteration: 753, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4646388292312622
loss_pred:0.030059639364480972, decouple_loss:0.010812100023031235
The generated pressure mean: 0.4692239761352539
loss_pred:0.031900692731142044, decouple_loss:0.01194375567138195
The generated pressure mean: 0.46920812129974365
loss_pred:0.031166929751634598, decouple_loss:0.01106815692037344
Iteration: 754, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4686133563518524
loss_pred:0.031285591423511505, decouple_loss:0.01060604490339756
The generated pressure mean: 0.4701627194881439
loss_pred:0.03242524713277817, decouple_loss:0.010699662379920483
The generated pressure mean: 0.47000646591186523
loss_pred:0.03238676115870476, decouple_loss:0.011400298215448856
Iteration: 755, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4204592704772949
loss_pred:0.03321259468793869, decouple_loss:0.012656759470701218
The generated pressure mean: 0.4269310235977173
loss_pred:0.030433714389801025, decouple_loss:0.012303153052926064
The generated pressure mean: 0.4284238815307617
loss_pred:0.033226240426301956, decouple_loss:0.01241256296634674
Iteration: 756, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.42113497853279114
loss_pred:0.03149890527129173, decouple_loss:0.00985017977654934
The generated pressure mean: 0.42242246866226196
loss_pred:0.03303666040301323, decouple_loss:0.009897172451019287
The generated pressure mean: 0.4227267801761627
loss_pred:0.032694075256586075, decouple_loss:0.0099854851141572
Iteration: 757, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.47630631923675537
loss_pred:0.03098427690565586, decouple_loss:0.010097994469106197
The generated pressure mean: 0.4740005433559418
loss_pred:0.02968003787100315, decouple_loss:0.010456760413944721
The generated pressure mean: 0.4729061722755432
loss_pred:0.02988460846245289, decouple_loss:0.010730277746915817
Iteration: 758, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4704533815383911
loss_pred:0.031333502382040024, decouple_loss:0.009986475110054016
The generated pressure mean: 0.46373826265335083
loss_pred:0.03169695660471916, decouple_loss:0.009694907814264297
The generated pressure mean: 0.46463096141815186
loss_pred:0.030414732173085213, decouple_loss:0.0102648064494133
Iteration: 759, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4427652060985565
loss_pred:0.031050071120262146, decouple_loss:0.011142062023282051
The generated pressure mean: 0.44060519337654114
loss_pred:0.03007562644779682, decouple_loss:0.011201504617929459
The generated pressure mean: 0.4396030604839325
loss_pred:0.03320997953414917, decouple_loss:0.010661182925105095
Iteration: 760, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43381527066230774
loss_pred:0.030985141173005104, decouple_loss:0.009487941861152649
The generated pressure mean: 0.4299529790878296
loss_pred:0.0323600098490715, decouple_loss:0.010026213712990284
The generated pressure mean: 0.43350136280059814
loss_pred:0.030216092243790627, decouple_loss:0.010084152221679688
2023-04-16 04:19:52 testing...
The generated pressure mean: 0.42322155833244324
loss_pred:0.044165339320898056, decouple_loss:0.01213484164327383
The generated pressure mean: 0.42835694551467896
loss_pred:0.043455228209495544, decouple_loss:0.012161276303231716
The generated pressure mean: 0.43327346444129944
loss_pred:0.043110765516757965, decouple_loss:0.012561686336994171
Loss: 0.04419141262769699, avg_mse: 0.05777643248438835
current test mse: 0.057776
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012015_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012015_3_24hr.npz
NaN value num: 0
Iteration: 761, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43753695487976074
loss_pred:0.03439168632030487, decouple_loss:0.011331314221024513
The generated pressure mean: 0.44115889072418213
loss_pred:0.03386553004384041, decouple_loss:0.011844447813928127
The generated pressure mean: 0.43602654337882996
loss_pred:0.031167050823569298, decouple_loss:0.011203737929463387
Iteration: 762, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4564887583255768
The generated pressure mean: 0.46669507026672363
loss_pred:0.03268354386091232, decouple_loss:0.011216509155929089
loss_pred:0.03244626522064209, decouple_loss:0.011400219984352589
The generated pressure mean: 0.4636470377445221
loss_pred:0.03275054693222046, decouple_loss:0.012109816074371338
Iteration: 763, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45590639114379883
loss_pred:0.035136107355356216, decouple_loss:0.00999146793037653
The generated pressure mean: 0.4567885100841522
loss_pred:0.03129566088318825, decouple_loss:0.009957208298146725
The generated pressure mean: 0.4588542580604553
loss_pred:0.033083416521549225, decouple_loss:0.00969772320240736
Iteration: 764, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43330150842666626
loss_pred:0.03233710303902626, decouple_loss:0.012606874108314514
The generated pressure mean: 0.43259555101394653
loss_pred:0.03125406429171562, decouple_loss:0.012129660695791245
The generated pressure mean: 0.43677645921707153
loss_pred:0.03240227699279785, decouple_loss:0.012919922359287739
Iteration: 765, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4348161518573761
loss_pred:0.03431763872504234, decouple_loss:0.010588896460831165
The generated pressure mean: 0.4385709762573242
loss_pred:0.03444123640656471, decouple_loss:0.01088572759181261
The generated pressure mean: 0.4349188208580017
loss_pred:0.0342228077352047, decouple_loss:0.010981285013258457
Iteration: 766, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4666653573513031
loss_pred:0.031775280833244324, decouple_loss:0.011438041925430298
The generated pressure mean: 0.46083182096481323
loss_pred:0.0321955606341362, decouple_loss:0.010135228745639324
The generated pressure mean: 0.46323689818382263
loss_pred:0.032365862280130386, decouple_loss:0.010645330883562565
Iteration: 767, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4317336678504944
loss_pred:0.03107202611863613, decouple_loss:0.011468659155070782
The generated pressure mean: 0.4343360960483551
loss_pred:0.03147459775209427, decouple_loss:0.011864797212183475
The generated pressure mean: 0.43305644392967224
loss_pred:0.029835715889930725, decouple_loss:0.011765727773308754
Iteration: 768, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44436153769493103
loss_pred:0.032457247376441956, decouple_loss:0.011438806541264057
The generated pressure mean: 0.4397043287754059
loss_pred:0.03212488442659378, decouple_loss:0.011418831534683704
The generated pressure mean: 0.4380071461200714
loss_pred:0.030865272507071495, decouple_loss:0.010787006467580795
Iteration: 769, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4659859538078308
loss_pred:0.030175020918250084, decouple_loss:0.009546773508191109
The generated pressure mean: 0.464103639125824
loss_pred:0.03375709056854248, decouple_loss:0.009122825227677822
The generated pressure mean: 0.46890854835510254
loss_pred:0.03182203695178032, decouple_loss:0.009494656696915627
Iteration: 770, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45960864424705505
loss_pred:0.031911734491586685, decouple_loss:0.011176222935318947
The generated pressure mean: 0.45272764563560486
loss_pred:0.03080296888947487, decouple_loss:0.011216751299798489
The generated pressure mean: 0.456009179353714
loss_pred:0.03021826036274433, decouple_loss:0.011343258433043957
2023-04-16 04:22:28 testing...
The generated pressure mean: 0.4261254668235779
loss_pred:0.040547601878643036, decouple_loss:0.01143336296081543
The generated pressure mean: 0.4321662187576294
loss_pred:0.03947588801383972, decouple_loss:0.011374551802873611
The generated pressure mean: 0.43623086810112
loss_pred:0.04027031734585762, decouple_loss:0.011855943128466606
Loss: 0.04067566990852356, avg_mse: 0.05076596885919571
current test mse: 0.050766
Iteration: 771, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4272630214691162
The generated pressure mean: 0.4219173789024353
loss_pred:0.03365718200802803, decouple_loss:0.010765403509140015
loss_pred:0.031000085175037384, decouple_loss:0.01149130892008543
The generated pressure mean: 0.42707332968711853
loss_pred:0.03181486204266548, decouple_loss:0.011223586276173592
Iteration: 772, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44308215379714966
loss_pred:0.03283314406871796, decouple_loss:0.011102080345153809
The generated pressure mean: 0.4392681419849396
loss_pred:0.029838336631655693, decouple_loss:0.011088459752500057
The generated pressure mean: 0.43789878487586975
loss_pred:0.031881220638751984, decouple_loss:0.011501368135213852
Iteration: 773, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45479854941368103
loss_pred:0.03221607953310013, decouple_loss:0.011397439986467361
The generated pressure mean: 0.45662105083465576
loss_pred:0.036032263189554214, decouple_loss:0.00996752642095089
The generated pressure mean: 0.460090309381485
loss_pred:0.03179144859313965, decouple_loss:0.010206989012658596
Iteration: 774, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4451338052749634
loss_pred:0.03187283128499985, decouple_loss:0.012495924718677998
The generated pressure mean: 0.44344305992126465
loss_pred:0.03163687884807587, decouple_loss:0.013708453625440598
The generated pressure mean: 0.44477319717407227
loss_pred:0.03130323439836502, decouple_loss:0.013539189472794533
Iteration: 775, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4391174614429474
loss_pred:0.030958125367760658, decouple_loss:0.01120875496417284
The generated pressure mean: 0.4373791813850403
loss_pred:0.033727314323186874, decouple_loss:0.011043991893529892
The generated pressure mean: 0.4401860237121582
loss_pred:0.03281038627028465, decouple_loss:0.011430535465478897
Iteration: 776, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4454108476638794
The generated pressure mean: 0.446827232837677
loss_pred:0.030213046818971634, decouple_loss:0.01261732168495655
loss_pred:0.03169957175850868, decouple_loss:0.012220874428749084
The generated pressure mean: 0.44388023018836975
loss_pred:0.031127316877245903, decouple_loss:0.01214966457337141
Iteration: 777, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45152345299720764
loss_pred:0.030671337619423866, decouple_loss:0.012087052688002586
The generated pressure mean: 0.4473229646682739
loss_pred:0.03218778967857361, decouple_loss:0.011424858123064041
The generated pressure mean: 0.4449220597743988
loss_pred:0.031376421451568604, decouple_loss:0.011551661416888237
Iteration: 778, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4457428753376007
The generated pressure mean: 0.4516368806362152
loss_pred:0.03160012885928154, decouple_loss:0.0115975895896554
loss_pred:0.03103671595454216, decouple_loss:0.011619131080806255
The generated pressure mean: 0.45512914657592773
loss_pred:0.03143289312720299, decouple_loss:0.011135266162455082
Iteration: 779, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4490574300289154
loss_pred:0.03262356296181679, decouple_loss:0.012334154918789864
The generated pressure mean: 0.4450867772102356
loss_pred:0.03203512728214264, decouple_loss:0.01204707846045494
The generated pressure mean: 0.4445370137691498
loss_pred:0.03161481395363808, decouple_loss:0.011950894258916378
Iteration: 780, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4391426146030426
The generated pressure mean: 0.43848294019699097
loss_pred:0.031666114926338196, decouple_loss:0.010622403584420681
loss_pred:0.030956968665122986, decouple_loss:0.010988948866724968
The generated pressure mean: 0.44599613547325134
loss_pred:0.030241524800658226, decouple_loss:0.010272487066686153
2023-04-16 04:24:28 testing...
The generated pressure mean: 0.41981837153434753
loss_pred:0.04191509634256363, decouple_loss:0.01374796312302351
The generated pressure mean: 0.4264412224292755
loss_pred:0.04171103984117508, decouple_loss:0.013590695336461067
The generated pressure mean: 0.43128466606140137
loss_pred:0.04123566299676895, decouple_loss:0.014162835665047169
Loss: 0.04231229051947594, avg_mse: 0.05372484028339386
current test mse: 0.053725
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012020_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012020_3_24hr.npz
NaN value num: 0
Iteration: 781, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4491301476955414
loss_pred:0.03233836963772774, decouple_loss:0.01336097251623869
The generated pressure mean: 0.45688489079475403
loss_pred:0.03178824484348297, decouple_loss:0.01347922720015049
The generated pressure mean: 0.4514927268028259
loss_pred:0.03163785859942436, decouple_loss:0.013622344471514225
Iteration: 782, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4555489122867584
loss_pred:0.030941372737288475, decouple_loss:0.01162684429436922
The generated pressure mean: 0.46089157462120056
loss_pred:0.031639598309993744, decouple_loss:0.011473571881651878
The generated pressure mean: 0.46010905504226685
loss_pred:0.030194872990250587, decouple_loss:0.011071689426898956
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 783, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4433876872062683
loss_pred:0.03086222894489765, decouple_loss:0.014674399048089981
The generated pressure mean: 0.44025513529777527
loss_pred:0.03065590001642704, decouple_loss:0.014520606957376003
The generated pressure mean: 0.4479905068874359
loss_pred:0.03260917216539383, decouple_loss:0.014925578609108925
Iteration: 784, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43464210629463196
loss_pred:0.03148183226585388, decouple_loss:0.013913961127400398
The generated pressure mean: 0.4352943003177643
loss_pred:0.03204309567809105, decouple_loss:0.014059776440262794
The generated pressure mean: 0.43362730741500854
loss_pred:0.033382005989551544, decouple_loss:0.014348718337714672
Iteration: 785, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45190340280532837
loss_pred:0.03263436257839203, decouple_loss:0.01340301800519228
The generated pressure mean: 0.45146819949150085
loss_pred:0.03044077381491661, decouple_loss:0.01286416593939066
The generated pressure mean: 0.45460453629493713
loss_pred:0.03204593062400818, decouple_loss:0.012943794019520283
Iteration: 786, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4566810131072998
loss_pred:0.031332727521657944, decouple_loss:0.01254235114902258
The generated pressure mean: 0.458118200302124
loss_pred:0.031065981835126877, decouple_loss:0.012678996659815311
The generated pressure mean: 0.4600546956062317
loss_pred:0.030983485281467438, decouple_loss:0.012815777212381363
Iteration: 787, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45033878087997437
loss_pred:0.030910035595297813, decouple_loss:0.012134075164794922
The generated pressure mean: 0.4447921812534332
loss_pred:0.030254507437348366, decouple_loss:0.011947100050747395
The generated pressure mean: 0.44902318716049194
loss_pred:0.031787704676389694, decouple_loss:0.011622864753007889
Iteration: 788, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44484472274780273
loss_pred:0.031060529872775078, decouple_loss:0.01138379331678152
The generated pressure mean: 0.4458562433719635
loss_pred:0.02982199192047119, decouple_loss:0.011199112981557846
The generated pressure mean: 0.44927921891212463
loss_pred:0.03230147063732147, decouple_loss:0.011642033234238625
Iteration: 789, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44407933950424194
loss_pred:0.03166258707642555, decouple_loss:0.012472603470087051
The generated pressure mean: 0.4405919313430786
loss_pred:0.03113449364900589, decouple_loss:0.011324177496135235
The generated pressure mean: 0.43646517395973206
loss_pred:0.029264116659760475, decouple_loss:0.011782731860876083
Iteration: 790, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4503839313983917
loss_pred:0.029689572751522064, decouple_loss:0.010121427476406097
The generated pressure mean: 0.4557251036167145
loss_pred:0.030993059277534485, decouple_loss:0.009572947397828102
The generated pressure mean: 0.45585593581199646
loss_pred:0.031472835689783096, decouple_loss:0.009583346545696259
2023-04-16 04:27:04 testing...
The generated pressure mean: 0.4209390878677368
loss_pred:0.04060753434896469, decouple_loss:0.011357245035469532
The generated pressure mean: 0.4288240671157837
loss_pred:0.03988078236579895, decouple_loss:0.011570993810892105
The generated pressure mean: 0.43328872323036194
loss_pred:0.04006534069776535, decouple_loss:0.011838164180517197
Loss: 0.04076399654150009, avg_mse: 0.05161605030298233
current test mse: 0.051616
Iteration: 791, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45828327536582947
The generated pressure mean: 0.4567267596721649
loss_pred:0.03166442736983299, decouple_loss:0.010377916507422924
loss_pred:0.03025360405445099, decouple_loss:0.01030008215457201
The generated pressure mean: 0.457348495721817
loss_pred:0.03085886687040329, decouple_loss:0.010792933404445648
Iteration: 792, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44238409399986267
The generated pressure mean: 0.44198885560035706
loss_pred:0.030595360323786736, decouple_loss:0.010744191706180573
loss_pred:0.03133762627840042, decouple_loss:0.010586580261588097
The generated pressure mean: 0.44102582335472107
loss_pred:0.030865108594298363, decouple_loss:0.010456200689077377
Iteration: 793, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4346405565738678
loss_pred:0.030701888725161552, decouple_loss:0.009837099350988865
The generated pressure mean: 0.4384820759296417
loss_pred:0.032118719071149826, decouple_loss:0.01023629680275917
The generated pressure mean: 0.4422912299633026
loss_pred:0.031275805085897446, decouple_loss:0.0100984713062644
Iteration: 794, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45311951637268066
The generated pressure mean: 0.45624664425849915
loss_pred:0.030041426420211792, decouple_loss:0.010365987196564674
loss_pred:0.031753916293382645, decouple_loss:0.010330631397664547
The generated pressure mean: 0.45606374740600586
loss_pred:0.03095836006104946, decouple_loss:0.010034757666289806
Iteration: 795, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45807912945747375
loss_pred:0.030385002493858337, decouple_loss:0.010190354660153389
The generated pressure mean: 0.4629055857658386
loss_pred:0.03257324546575546, decouple_loss:0.010174321010708809
The generated pressure mean: 0.46125176548957825
loss_pred:0.029975419864058495, decouple_loss:0.010068235918879509
Iteration: 796, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44646376371383667
loss_pred:0.03014237806200981, decouple_loss:0.010253086686134338
The generated pressure mean: 0.44214218854904175
loss_pred:0.030102109536528587, decouple_loss:0.009864681400358677
The generated pressure mean: 0.443550705909729
loss_pred:0.029654065147042274, decouple_loss:0.010049575008451939
Iteration: 797, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.42785486578941345
loss_pred:0.031522564589977264, decouple_loss:0.009855646640062332
The generated pressure mean: 0.4336036443710327
loss_pred:0.03236943483352661, decouple_loss:0.009587522596120834
The generated pressure mean: 0.4319934546947479
loss_pred:0.03052559494972229, decouple_loss:0.008876814506947994
Iteration: 798, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45853668451309204
loss_pred:0.031560804694890976, decouple_loss:0.009460586123168468
The generated pressure mean: 0.45893529057502747
loss_pred:0.029489463195204735, decouple_loss:0.009351452812552452
The generated pressure mean: 0.4596216678619385
loss_pred:0.03088965266942978, decouple_loss:0.009230231866240501
Iteration: 799, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.47532573342323303
loss_pred:0.03062804415822029, decouple_loss:0.00991958286613226
The generated pressure mean: 0.4701479375362396
loss_pred:0.030691128224134445, decouple_loss:0.010201509110629559
The generated pressure mean: 0.4659290909767151
loss_pred:0.03160148113965988, decouple_loss:0.009472662582993507
Iteration: 800, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4279124438762665
loss_pred:0.03232211992144585, decouple_loss:0.010041812434792519
The generated pressure mean: 0.43188413977622986
loss_pred:0.030660497024655342, decouple_loss:0.010289420373737812
The generated pressure mean: 0.432396799325943
loss_pred:0.029944106936454773, decouple_loss:0.009531700983643532
2023-04-16 04:29:05 testing...
The generated pressure mean: 0.4274631440639496
loss_pred:0.040603332221508026, decouple_loss:0.009554287418723106
The generated pressure mean: 0.4354472756385803
loss_pred:0.03997268155217171, decouple_loss:0.00949864462018013
The generated pressure mean: 0.4404108226299286
loss_pred:0.04005274921655655, decouple_loss:0.010061760433018208
Loss: 0.04069483280181885, avg_mse: 0.051774729043245316
current test mse: 0.051775
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012009_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012009_3_24hr.npz
NaN value num: 0
Iteration: 801, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4265652298927307
loss_pred:0.030937490984797478, decouple_loss:0.008887055329978466
The generated pressure mean: 0.43017902970314026
loss_pred:0.030250662937760353, decouple_loss:0.008694698102772236
The generated pressure mean: 0.42668843269348145
loss_pred:0.029925288632512093, decouple_loss:0.008991176262497902
Iteration: 802, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4719308316707611
loss_pred:0.029797913506627083, decouple_loss:0.009577435441315174
The generated pressure mean: 0.4653760492801666
loss_pred:0.029803598299622536, decouple_loss:0.009522279724478722
The generated pressure mean: 0.4681161046028137
loss_pred:0.03168148919939995, decouple_loss:0.01061246357858181
Iteration: 803, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4678628742694855
loss_pred:0.030426258221268654, decouple_loss:0.008535999804735184
The generated pressure mean: 0.46811944246292114
loss_pred:0.031982336193323135, decouple_loss:0.009112995117902756
The generated pressure mean: 0.46347612142562866
loss_pred:0.030249394476413727, decouple_loss:0.009049251675605774
Iteration: 804, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4281449615955353
loss_pred:0.031374625861644745, decouple_loss:0.00856468640267849
The generated pressure mean: 0.42789986729621887
loss_pred:0.031218938529491425, decouple_loss:0.008962403982877731
The generated pressure mean: 0.4279446601867676
loss_pred:0.029469598084688187, decouple_loss:0.009294605813920498
Iteration: 805, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.42677757143974304
loss_pred:0.029608866199851036, decouple_loss:0.009536705911159515
The generated pressure mean: 0.4273713529109955
loss_pred:0.030567212030291557, decouple_loss:0.009715245105326176
The generated pressure mean: 0.4266498386859894
loss_pred:0.030789226293563843, decouple_loss:0.009540240280330181
Iteration: 806, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45849213004112244
loss_pred:0.03162606433033943, decouple_loss:0.009544230066239834
The generated pressure mean: 0.45882412791252136
loss_pred:0.032129108905792236, decouple_loss:0.008960707113146782
The generated pressure mean: 0.45830419659614563
loss_pred:0.031433604657649994, decouple_loss:0.00928560458123684
Iteration: 807, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4661615192890167
loss_pred:0.031490251421928406, decouple_loss:0.011167320422828197
The generated pressure mean: 0.4701458811759949
loss_pred:0.0316697396337986, decouple_loss:0.011253789998590946
The generated pressure mean: 0.4716264605522156
loss_pred:0.03183835744857788, decouple_loss:0.011192628182470798
Iteration: 808, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.41920551657676697
loss_pred:0.03258930519223213, decouple_loss:0.010840458795428276
The generated pressure mean: 0.4192298948764801
loss_pred:0.03218310326337814, decouple_loss:0.010787705890834332
The generated pressure mean: 0.425045907497406
loss_pred:0.031325917690992355, decouple_loss:0.0109662851318717
Iteration: 809, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4426559805870056
loss_pred:0.031521450728178024, decouple_loss:0.009785644710063934
The generated pressure mean: 0.44238099455833435
loss_pred:0.030610229820013046, decouple_loss:0.009424257092177868
The generated pressure mean: 0.44513940811157227
loss_pred:0.030604606494307518, decouple_loss:0.009537756443023682
Iteration: 810, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46238115429878235
loss_pred:0.031627677381038666, decouple_loss:0.009954333305358887
The generated pressure mean: 0.46395447850227356
loss_pred:0.02962811104953289, decouple_loss:0.010323694907128811
The generated pressure mean: 0.45636337995529175
loss_pred:0.030303403735160828, decouple_loss:0.01035931333899498
2023-04-16 04:31:41 testing...
The generated pressure mean: 0.4156222641468048
loss_pred:0.04143025353550911, decouple_loss:0.009184004738926888
The generated pressure mean: 0.4227946400642395
loss_pred:0.04003634676337242, decouple_loss:0.009198494255542755
The generated pressure mean: 0.42681026458740234
loss_pred:0.040343813598155975, decouple_loss:0.009691880084574223
Loss: 0.04107138141989708, avg_mse: 0.052222102880477905
current test mse: 0.052222
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 811, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.458261638879776
loss_pred:0.031301695853471756, decouple_loss:0.008686094544827938
The generated pressure mean: 0.46084868907928467
loss_pred:0.0313597209751606, decouple_loss:0.008123562671244144
The generated pressure mean: 0.46183666586875916
loss_pred:0.031587693840265274, decouple_loss:0.008311710320413113
Iteration: 812, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43491479754447937
loss_pred:0.03271937370300293, decouple_loss:0.00992493238300085
The generated pressure mean: 0.4381204843521118
loss_pred:0.030355961993336678, decouple_loss:0.009464887902140617
The generated pressure mean: 0.4379154443740845
loss_pred:0.031227674335241318, decouple_loss:0.010453885421156883
Iteration: 813, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43023109436035156
loss_pred:0.030744770541787148, decouple_loss:0.010073981247842312
The generated pressure mean: 0.42938438057899475
loss_pred:0.030597511678934097, decouple_loss:0.009819419123232365
The generated pressure mean: 0.43021878600120544
loss_pred:0.030155032873153687, decouple_loss:0.009620112366974354
Iteration: 814, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44582653045654297
loss_pred:0.030197443440556526, decouple_loss:0.011847740039229393
The generated pressure mean: 0.4483594596385956
loss_pred:0.03043513000011444, decouple_loss:0.012042568065226078
The generated pressure mean: 0.44675564765930176
loss_pred:0.030584830790758133, decouple_loss:0.01204319391399622
Iteration: 815, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.47574055194854736
loss_pred:0.031007681041955948, decouple_loss:0.00927644781768322
The generated pressure mean: 0.47441819310188293
loss_pred:0.031767114996910095, decouple_loss:0.009091585874557495
The generated pressure mean: 0.4723374545574188
loss_pred:0.029796123504638672, decouple_loss:0.008977695368230343
Iteration: 816, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4352484941482544
loss_pred:0.029683653265237808, decouple_loss:0.01065591350197792
The generated pressure mean: 0.4366830289363861
loss_pred:0.0322912223637104, decouple_loss:0.010751014575362206
The generated pressure mean: 0.4398425817489624
loss_pred:0.03131723776459694, decouple_loss:0.01054413989186287
Iteration: 817, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43329423666000366
loss_pred:0.029076455160975456, decouple_loss:0.00937566440552473
The generated pressure mean: 0.4340868890285492
loss_pred:0.031809087842702866, decouple_loss:0.009600194171071053
The generated pressure mean: 0.4266718029975891
loss_pred:0.03179257735610008, decouple_loss:0.009591305628418922
Iteration: 818, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4556930661201477
loss_pred:0.03036077693104744, decouple_loss:0.009478962980210781
The generated pressure mean: 0.4583064913749695
loss_pred:0.030797593295574188, decouple_loss:0.009865346364676952
The generated pressure mean: 0.4551945626735687
loss_pred:0.03146328032016754, decouple_loss:0.009641760028898716
Iteration: 819, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4490765631198883
loss_pred:0.03155269846320152, decouple_loss:0.009725036099553108
The generated pressure mean: 0.4504880905151367
loss_pred:0.02997579239308834, decouple_loss:0.00955683272331953
The generated pressure mean: 0.4496370851993561
loss_pred:0.029500680044293404, decouple_loss:0.00994175486266613
Iteration: 820, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4361034035682678
loss_pred:0.030599649995565414, decouple_loss:0.009835024364292622
The generated pressure mean: 0.43472033739089966
loss_pred:0.030535006895661354, decouple_loss:0.009718408808112144
The generated pressure mean: 0.4400637149810791
loss_pred:0.03156719356775284, decouple_loss:0.009263806976377964
2023-04-16 04:33:42 testing...
The generated pressure mean: 0.41907644271850586
loss_pred:0.04127832129597664, decouple_loss:0.01123048085719347
The generated pressure mean: 0.42713138461112976
loss_pred:0.03964121267199516, decouple_loss:0.01116122305393219
The generated pressure mean: 0.430961936712265
loss_pred:0.040596216917037964, decouple_loss:0.011747234500944614
Loss: 0.0410742349922657, avg_mse: 0.05223497003316879
current test mse: 0.052235
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012019_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012019_3_24hr.npz
NaN value num: 0
Iteration: 821, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4502895176410675
loss_pred:0.030260909348726273, decouple_loss:0.010266318917274475
The generated pressure mean: 0.45490291714668274
loss_pred:0.03222611919045448, decouple_loss:0.010904131457209587
The generated pressure mean: 0.4483553469181061
loss_pred:0.03199049457907677, decouple_loss:0.010650274343788624
Iteration: 822, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44475680589675903
loss_pred:0.030037082731723785, decouple_loss:0.011956753209233284
The generated pressure mean: 0.44723060727119446
loss_pred:0.030055928975343704, decouple_loss:0.010559584014117718
The generated pressure mean: 0.44849318265914917
loss_pred:0.03134089708328247, decouple_loss:0.010552708990871906
Iteration: 823, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4416671693325043
loss_pred:0.029659276828169823, decouple_loss:0.010537810623645782
The generated pressure mean: 0.438106507062912
loss_pred:0.028957417234778404, decouple_loss:0.011209748685359955
The generated pressure mean: 0.4427860677242279
loss_pred:0.030392998829483986, decouple_loss:0.011512410826981068
Iteration: 824, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45393383502960205
The generated pressure mean: 0.4575667083263397
loss_pred:0.03122028335928917, decouple_loss:0.011257720179855824
loss_pred:0.031932782381772995, decouple_loss:0.011186218820512295
The generated pressure mean: 0.4560047388076782
loss_pred:0.030642857775092125, decouple_loss:0.010823744349181652
Iteration: 825, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46250009536743164
loss_pred:0.029282256960868835, decouple_loss:0.010494755581021309
The generated pressure mean: 0.46201184391975403
loss_pred:0.0298976581543684, decouple_loss:0.010448002256453037
The generated pressure mean: 0.45974358916282654
loss_pred:0.029855307191610336, decouple_loss:0.010606909170746803
Iteration: 826, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44143247604370117
loss_pred:0.03321029990911484, decouple_loss:0.011816095560789108
The generated pressure mean: 0.44219404458999634
loss_pred:0.030011817812919617, decouple_loss:0.011998209170997143
The generated pressure mean: 0.4399550259113312
loss_pred:0.030495012179017067, decouple_loss:0.012343242764472961
Iteration: 827, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4289345443248749
loss_pred:0.031801193952560425, decouple_loss:0.011897728778421879
The generated pressure mean: 0.4246509373188019
loss_pred:0.03058377280831337, decouple_loss:0.011536605656147003
The generated pressure mean: 0.42612114548683167
loss_pred:0.030507734045386314, decouple_loss:0.012068307027220726
Iteration: 828, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4574703276157379
loss_pred:0.029089951887726784, decouple_loss:0.011228956282138824
The generated pressure mean: 0.4575462341308594
loss_pred:0.030135609209537506, decouple_loss:0.011729160323739052
The generated pressure mean: 0.4548823833465576
loss_pred:0.031221715733408928, decouple_loss:0.011845235712826252
Iteration: 829, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4556032717227936
loss_pred:0.028174210339784622, decouple_loss:0.012381901033222675
The generated pressure mean: 0.46467044949531555
loss_pred:0.03084964118897915, decouple_loss:0.012884295545518398
The generated pressure mean: 0.461607426404953
loss_pred:0.02980554662644863, decouple_loss:0.012588427402079105
Iteration: 830, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4518428444862366
loss_pred:0.031070485711097717, decouple_loss:0.010597248561680317
The generated pressure mean: 0.44864320755004883
loss_pred:0.02940640226006508, decouple_loss:0.011194963939487934
The generated pressure mean: 0.44763895869255066
loss_pred:0.030155744403600693, decouple_loss:0.011214361526072025
2023-04-16 04:36:18 testing...
The generated pressure mean: 0.4230922758579254
loss_pred:0.040555257350206375, decouple_loss:0.013728687539696693
The generated pressure mean: 0.4317362308502197
loss_pred:0.03896088898181915, decouple_loss:0.013433435931801796
The generated pressure mean: 0.43613237142562866
loss_pred:0.03962652012705803, decouple_loss:0.013728780671954155
Loss: 0.04039573669433594, avg_mse: 0.05149385333061218
current test mse: 0.051494
Iteration: 831, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44093331694602966
loss_pred:0.031993720680475235, decouple_loss:0.013180112466216087
The generated pressure mean: 0.43630871176719666
loss_pred:0.03000389225780964, decouple_loss:0.013152102008461952
The generated pressure mean: 0.44112908840179443
loss_pred:0.029839934781193733, decouple_loss:0.013353537768125534
Iteration: 832, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43693214654922485
The generated pressure mean: 0.4364270269870758loss_pred:0.028386075049638748, decouple_loss:0.011077050119638443
loss_pred:0.030445732176303864, decouple_loss:0.011301100254058838
The generated pressure mean: 0.44314929842948914
loss_pred:0.030052155256271362, decouple_loss:0.01179245300590992
Iteration: 833, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.461609810590744
loss_pred:0.02878335490822792, decouple_loss:0.011421862989664078
The generated pressure mean: 0.4583936035633087
loss_pred:0.03035675920546055, decouple_loss:0.011385316029191017
The generated pressure mean: 0.46185538172721863
loss_pred:0.02998971939086914, decouple_loss:0.011790722608566284
Iteration: 834, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45652127265930176
loss_pred:0.0315430723130703, decouple_loss:0.013501371257007122
The generated pressure mean: 0.45904794335365295
loss_pred:0.031056271865963936, decouple_loss:0.013212043792009354
The generated pressure mean: 0.45978444814682007
loss_pred:0.03048926219344139, decouple_loss:0.013176988810300827
Iteration: 835, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4336932897567749
loss_pred:0.030328432098031044, decouple_loss:0.010387130081653595
The generated pressure mean: 0.43323948979377747
loss_pred:0.02976691909134388, decouple_loss:0.010486122220754623
The generated pressure mean: 0.42356154322624207
loss_pred:0.028985539451241493, decouple_loss:0.010414610616862774
Iteration: 836, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4491064250469208
loss_pred:0.029289420694112778, decouple_loss:0.013955428265035152
The generated pressure mean: 0.4453965723514557
loss_pred:0.02968641370534897, decouple_loss:0.013678331859409809
The generated pressure mean: 0.44771188497543335
loss_pred:0.0314595028758049, decouple_loss:0.013851935975253582
Iteration: 837, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4618149399757385
loss_pred:0.029312102124094963, decouple_loss:0.0119650699198246
The generated pressure mean: 0.45497432351112366
loss_pred:0.030099529772996902, decouple_loss:0.012071891687810421
The generated pressure mean: 0.4587388038635254
loss_pred:0.029400022700428963, decouple_loss:0.012128484435379505
Iteration: 838, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44657182693481445
loss_pred:0.029530152678489685, decouple_loss:0.011809325776994228
The generated pressure mean: 0.4559500813484192
loss_pred:0.029596706852316856, decouple_loss:0.012157178483903408
The generated pressure mean: 0.45370444655418396
loss_pred:0.03038323111832142, decouple_loss:0.01208172831684351
Iteration: 839, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.434781014919281
loss_pred:0.02844022773206234, decouple_loss:0.012906195595860481
The generated pressure mean: 0.43778613209724426
loss_pred:0.029394639655947685, decouple_loss:0.012746517546474934
The generated pressure mean: 0.4402492940425873
loss_pred:0.030360883101820946, decouple_loss:0.012700400315225124
Iteration: 840, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.449094295501709
loss_pred:0.03024967759847641, decouple_loss:0.010975039564073086
The generated pressure mean: 0.44994157552719116
loss_pred:0.030018599703907967, decouple_loss:0.010791856795549393
The generated pressure mean: 0.44783294200897217
loss_pred:0.03085368499159813, decouple_loss:0.010948746465146542
2023-04-16 04:38:19 testing...
The generated pressure mean: 0.4198399782180786
loss_pred:0.04074646905064583, decouple_loss:0.012678398750722408
The generated pressure mean: 0.4269965589046478
loss_pred:0.039608243852853775, decouple_loss:0.012126554735004902
The generated pressure mean: 0.43103933334350586
loss_pred:0.04016828536987305, decouple_loss:0.012962874956429005
Loss: 0.04080379754304886, avg_mse: 0.05121975019574165
current test mse: 0.05122
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012003_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012003_3_24hr.npz
NaN value num: 0
Iteration: 841, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45436418056488037
loss_pred:0.030948681756854057, decouple_loss:0.012307822704315186
The generated pressure mean: 0.45367366075515747
loss_pred:0.030681250616908073, decouple_loss:0.01225139107555151
The generated pressure mean: 0.4522274434566498
loss_pred:0.031019026413559914, decouple_loss:0.011855109594762325
Iteration: 842, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4412921369075775
loss_pred:0.031072046607732773, decouple_loss:0.010883163660764694
The generated pressure mean: 0.44448649883270264
loss_pred:0.03003350831568241, decouple_loss:0.011883978731930256
The generated pressure mean: 0.4462122917175293
loss_pred:0.029486294835805893, decouple_loss:0.011512963101267815
Iteration: 843, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44434526562690735
loss_pred:0.031154289841651917, decouple_loss:0.012833218090236187
The generated pressure mean: 0.4379829168319702
loss_pred:0.03089558333158493, decouple_loss:0.013028047978878021
The generated pressure mean: 0.44443365931510925
loss_pred:0.03154464811086655, decouple_loss:0.013035032898187637
Iteration: 844, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4433116912841797
loss_pred:0.028343448415398598, decouple_loss:0.010768648236989975
The generated pressure mean: 0.44188880920410156
loss_pred:0.03199968859553337, decouple_loss:0.010526490397751331
The generated pressure mean: 0.4433562755584717
loss_pred:0.03168308362364769, decouple_loss:0.010588609613478184
Iteration: 845, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4602772295475006
loss_pred:0.030156880617141724, decouple_loss:0.011208699084818363
The generated pressure mean: 0.45942097902297974
loss_pred:0.029849354177713394, decouple_loss:0.011519203893840313
The generated pressure mean: 0.46105530858039856
loss_pred:0.030027205124497414, decouple_loss:0.011241041123867035
Iteration: 846, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44501376152038574
loss_pred:0.03065919689834118, decouple_loss:0.010695531032979488
The generated pressure mean: 0.44629061222076416
loss_pred:0.031843896955251694, decouple_loss:0.010437500663101673
The generated pressure mean: 0.4492996633052826
loss_pred:0.028782794252038002, decouple_loss:0.010653537698090076
Iteration: 847, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43390515446662903
loss_pred:0.03308615833520889, decouple_loss:0.010089081712067127
The generated pressure mean: 0.44387009739875793
loss_pred:0.030574610456824303, decouple_loss:0.009858809411525726
The generated pressure mean: 0.4383094608783722
loss_pred:0.03088727779686451, decouple_loss:0.010611303150653839
Iteration: 848, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43920350074768066
loss_pred:0.030939461663365364, decouple_loss:0.011001398786902428
The generated pressure mean: 0.43998146057128906
loss_pred:0.029498253017663956, decouple_loss:0.010733313858509064
The generated pressure mean: 0.43825018405914307
loss_pred:0.03016233630478382, decouple_loss:0.010414372198283672
Iteration: 849, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4529060125350952
loss_pred:0.02986603043973446, decouple_loss:0.010236470960080624
The generated pressure mean: 0.4524460434913635
loss_pred:0.031080029904842377, decouple_loss:0.01057618297636509
The generated pressure mean: 0.4575904309749603
loss_pred:0.029125850647687912, decouple_loss:0.00993123184889555
Iteration: 850, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45724809169769287
loss_pred:0.030334943905472755, decouple_loss:0.010411190800368786
The generated pressure mean: 0.4558485448360443
loss_pred:0.030286328867077827, decouple_loss:0.010369696654379368
The generated pressure mean: 0.4519302248954773
loss_pred:0.030420081689953804, decouple_loss:0.010151048190891743
2023-04-16 04:40:55 testing...
The generated pressure mean: 0.4196440279483795
loss_pred:0.042100172489881516, decouple_loss:0.011388286016881466
The generated pressure mean: 0.4269138276576996
loss_pred:0.04165012389421463, decouple_loss:0.011408869177103043
The generated pressure mean: 0.4313076436519623
loss_pred:0.041987158358097076, decouple_loss:0.011649619787931442
Loss: 0.04248660057783127, avg_mse: 0.05532758682966232
current test mse: 0.055328
Iteration: 851, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44699743390083313
loss_pred:0.03105328604578972, decouple_loss:0.010395603254437447
The generated pressure mean: 0.4403189718723297
loss_pred:0.02966883033514023, decouple_loss:0.010441054590046406
The generated pressure mean: 0.43985438346862793
loss_pred:0.031075729057192802, decouple_loss:0.010466382838785648
Iteration: 852, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4455261528491974
loss_pred:0.031106337904930115, decouple_loss:0.010011627338826656
The generated pressure mean: 0.4384947419166565
loss_pred:0.02887103334069252, decouple_loss:0.010217213071882725
The generated pressure mean: 0.44360196590423584
loss_pred:0.028787653893232346, decouple_loss:0.009401743300259113
Iteration: 853, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44754892587661743
loss_pred:0.028915435075759888, decouple_loss:0.011119682341814041
The generated pressure mean: 0.44819051027297974
loss_pred:0.03023238107562065, decouple_loss:0.01142297126352787
The generated pressure mean: 0.44734102487564087
loss_pred:0.029005397111177444, decouple_loss:0.011310135945677757
Iteration: 854, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4437960982322693
loss_pred:0.03133133053779602, decouple_loss:0.009197390638291836
The generated pressure mean: 0.4445675015449524
loss_pred:0.03023725561797619, decouple_loss:0.008995463140308857
The generated pressure mean: 0.4420081079006195
loss_pred:0.030064886435866356, decouple_loss:0.009050503373146057
Iteration: 855, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4468129873275757
loss_pred:0.029485324397683144, decouple_loss:0.011114339344203472The generated pressure mean: 0.45439305901527405
loss_pred:0.030148446559906006, decouple_loss:0.010312297381460667
The generated pressure mean: 0.45799270272254944
loss_pred:0.029824398458003998, decouple_loss:0.010891325771808624
Iteration: 856, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4547038972377777
loss_pred:0.02892276458442211, decouple_loss:0.009138774126768112
The generated pressure mean: 0.45337891578674316
loss_pred:0.03052045777440071, decouple_loss:0.009046868421137333
The generated pressure mean: 0.4471358358860016
loss_pred:0.02949404902756214, decouple_loss:0.009768000803887844
Iteration: 857, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4398839473724365
loss_pred:0.03008594736456871, decouple_loss:0.009419663809239864
The generated pressure mean: 0.444348007440567
loss_pred:0.030150391161441803, decouple_loss:0.00938284769654274
The generated pressure mean: 0.4472034275531769
loss_pred:0.02859068103134632, decouple_loss:0.009598528034985065
Iteration: 858, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4438181519508362
loss_pred:0.028663838282227516, decouple_loss:0.010110101662576199
The generated pressure mean: 0.4477790296077728
loss_pred:0.029022319242358208, decouple_loss:0.010506671853363514
The generated pressure mean: 0.440917432308197
loss_pred:0.028591660782694817, decouple_loss:0.01009462121874094
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 859, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.455437034368515
loss_pred:0.02932412177324295, decouple_loss:0.009067700244486332
The generated pressure mean: 0.4545817971229553
loss_pred:0.028194762766361237, decouple_loss:0.00872836448252201
The generated pressure mean: 0.4546981751918793
loss_pred:0.028736956417560577, decouple_loss:0.008953070268034935
Iteration: 860, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4417401850223541
loss_pred:0.029400190338492393, decouple_loss:0.008823704905807972
The generated pressure mean: 0.4442039430141449
loss_pred:0.02945551648736, decouple_loss:0.009130453690886497
The generated pressure mean: 0.44069889187812805
loss_pred:0.03036550059914589, decouple_loss:0.008947838097810745
2023-04-16 04:42:55 testing...
The generated pressure mean: 0.4225274920463562
loss_pred:0.04246021807193756, decouple_loss:0.009709942154586315
The generated pressure mean: 0.4307597577571869
loss_pred:0.041741274297237396, decouple_loss:0.009849576279520988
The generated pressure mean: 0.4353694021701813
loss_pred:0.04200184717774391, decouple_loss:0.010424850508570671
Loss: 0.04256752133369446, avg_mse: 0.056579891592264175
current test mse: 0.05658
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012014_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012014_3_24hr.npz
NaN value num: 0
Iteration: 861, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43917787075042725
loss_pred:0.029399290680885315, decouple_loss:0.009087027981877327
The generated pressure mean: 0.4402673542499542
loss_pred:0.03125835210084915, decouple_loss:0.008601504378020763
The generated pressure mean: 0.4358631372451782
loss_pred:0.02904387377202511, decouple_loss:0.008397054858505726
Iteration: 862, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44499918818473816
loss_pred:0.031037593260407448, decouple_loss:0.008920217864215374
The generated pressure mean: 0.44372373819351196
loss_pred:0.029592018574476242, decouple_loss:0.009260845370590687
The generated pressure mean: 0.4443337321281433
loss_pred:0.029877768829464912, decouple_loss:0.009025171399116516
Iteration: 863, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45283862948417664
loss_pred:0.031692683696746826, decouple_loss:0.009891701862215996
The generated pressure mean: 0.45108306407928467
loss_pred:0.030140196904540062, decouple_loss:0.009751000441610813
The generated pressure mean: 0.4538736045360565
loss_pred:0.029248369857668877, decouple_loss:0.009789528325200081
Iteration: 864, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4497929811477661
loss_pred:0.030347004532814026, decouple_loss:0.010476132854819298
The generated pressure mean: 0.4516874849796295
loss_pred:0.029562806710600853, decouple_loss:0.0095576923340559
The generated pressure mean: 0.4445754289627075
loss_pred:0.030674468725919724, decouple_loss:0.009701067581772804
Iteration: 865, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4341844618320465
loss_pred:0.03105219453573227, decouple_loss:0.009209191426634789
The generated pressure mean: 0.44285088777542114
loss_pred:0.028778327628970146, decouple_loss:0.009319297969341278
The generated pressure mean: 0.430719792842865
loss_pred:0.029151441529393196, decouple_loss:0.009669866412878036
Iteration: 866, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45198097825050354
loss_pred:0.03061557561159134, decouple_loss:0.012275146320462227
The generated pressure mean: 0.4487365484237671
loss_pred:0.02985691837966442, decouple_loss:0.011550220660865307
The generated pressure mean: 0.44961386919021606
loss_pred:0.029073448851704597, decouple_loss:0.011709813959896564
Iteration: 867, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4432089030742645
loss_pred:0.029403487220406532, decouple_loss:0.008509561419487
The generated pressure mean: 0.44550999999046326
loss_pred:0.029925426468253136, decouple_loss:0.008848622441291809
The generated pressure mean: 0.4386565089225769
loss_pred:0.030661344528198242, decouple_loss:0.008427783846855164
Iteration: 868, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45095565915107727
loss_pred:0.03033505380153656, decouple_loss:0.008731890469789505
The generated pressure mean: 0.4437253177165985
loss_pred:0.029868006706237793, decouple_loss:0.007734579965472221
The generated pressure mean: 0.44589993357658386
loss_pred:0.030937500298023224, decouple_loss:0.0079666618257761
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 869, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44604772329330444
loss_pred:0.03127220645546913, decouple_loss:0.008299657143652439
The generated pressure mean: 0.44084426760673523
loss_pred:0.030220497399568558, decouple_loss:0.008574457839131355
The generated pressure mean: 0.4480392336845398
loss_pred:0.03022935800254345, decouple_loss:0.008734003640711308
Iteration: 870, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4532276690006256
loss_pred:0.030663520097732544, decouple_loss:0.010472679510712624
The generated pressure mean: 0.45572397112846375
loss_pred:0.030541885644197464, decouple_loss:0.01023815106600523
The generated pressure mean: 0.4500432014465332
loss_pred:0.029892895370721817, decouple_loss:0.010214468464255333
2023-04-16 04:45:33 testing...
The generated pressure mean: 0.42354798316955566
loss_pred:0.040111493319272995, decouple_loss:0.010598033666610718
The generated pressure mean: 0.4317333996295929
loss_pred:0.03942723572254181, decouple_loss:0.010331926867365837
The generated pressure mean: 0.436305433511734
loss_pred:0.03940214589238167, decouple_loss:0.010822048410773277
Loss: 0.040176160633563995, avg_mse: 0.05158335715532303
current test mse: 0.051583
Iteration: 871, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4383540749549866
loss_pred:0.030114222317934036, decouple_loss:0.00922269094735384
The generated pressure mean: 0.4442744255065918
loss_pred:0.03094763122498989, decouple_loss:0.009154988452792168
The generated pressure mean: 0.4393472671508789
loss_pred:0.028689207509160042, decouple_loss:0.00960394274443388
Iteration: 872, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43835678696632385
loss_pred:0.030020296573638916, decouple_loss:0.009774945676326752
The generated pressure mean: 0.4334917664527893
The generated pressure mean: 0.43443262577056885
loss_pred:0.030066240578889847, decouple_loss:0.008941015228629112
loss_pred:0.029636060819029808, decouple_loss:0.009341973811388016
Iteration: 873, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45234182476997375
loss_pred:0.02980116941034794, decouple_loss:0.010777777060866356
The generated pressure mean: 0.4542342722415924
loss_pred:0.030247550457715988, decouple_loss:0.01029914990067482
The generated pressure mean: 0.4502980709075928
loss_pred:0.030280720442533493, decouple_loss:0.010439605452120304
Iteration: 874, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46012553572654724
loss_pred:0.03074641153216362, decouple_loss:0.009798131883144379
The generated pressure mean: 0.4632805287837982
loss_pred:0.03139616549015045, decouple_loss:0.010036963038146496
The generated pressure mean: 0.4607006907463074
loss_pred:0.02892610803246498, decouple_loss:0.010405917651951313
Iteration: 875, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.434152752161026
loss_pred:0.030278826132416725, decouple_loss:0.00861525908112526
The generated pressure mean: 0.4373423755168915
loss_pred:0.029020579531788826, decouple_loss:0.008999844081699848
The generated pressure mean: 0.43756577372550964
loss_pred:0.028949828818440437, decouple_loss:0.008781010285019875
Iteration: 876, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.42761287093162537
loss_pred:0.029721777886152267, decouple_loss:0.008190004155039787
The generated pressure mean: 0.42793893814086914
loss_pred:0.030671684071421623, decouple_loss:0.007878940552473068
The generated pressure mean: 0.4326450526714325
loss_pred:0.028896359726786613, decouple_loss:0.007579851895570755
Iteration: 877, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4524444341659546
loss_pred:0.030756939202547073, decouple_loss:0.010838789865374565
The generated pressure mean: 0.45190757513046265
loss_pred:0.02917432226240635, decouple_loss:0.010820962488651276
The generated pressure mean: 0.45342832803726196
loss_pred:0.03037952445447445, decouple_loss:0.010820718482136726
Iteration: 878, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4608631432056427
loss_pred:0.02929702028632164, decouple_loss:0.01203662995249033
The generated pressure mean: 0.4640856683254242
loss_pred:0.029915520921349525, decouple_loss:0.011571135371923447
The generated pressure mean: 0.4617016911506653
loss_pred:0.03029283508658409, decouple_loss:0.01170311402529478
Iteration: 879, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44028475880622864
loss_pred:0.02922777272760868, decouple_loss:0.00964590348303318
The generated pressure mean: 0.4419260025024414
loss_pred:0.030565546825528145, decouple_loss:0.009183867834508419
The generated pressure mean: 0.4460347890853882
loss_pred:0.02973346598446369, decouple_loss:0.009073364548385143
Iteration: 880, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4281933009624481
loss_pred:0.028987957164645195, decouple_loss:0.008623074740171432
The generated pressure mean: 0.42984145879745483
loss_pred:0.03362887352705002, decouple_loss:0.009072608314454556
The generated pressure mean: 0.4319792687892914
loss_pred:0.03110005147755146, decouple_loss:0.008695532567799091
2023-04-16 04:47:34 testing...
The generated pressure mean: 0.41615012288093567
loss_pred:0.04164079576730728, decouple_loss:0.013147256337106228
The generated pressure mean: 0.42344439029693604
loss_pred:0.040552277117967606, decouple_loss:0.01338389702141285
The generated pressure mean: 0.42723292112350464
loss_pred:0.041504960507154465, decouple_loss:0.013728623278439045
Loss: 0.041903674602508545, avg_mse: 0.05312934145331383
current test mse: 0.053129
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012017_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012017_3_24hr.npz
NaN value num: 0
Iteration: 881, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4571458101272583
loss_pred:0.030385591089725494, decouple_loss:0.012078531086444855
The generated pressure mean: 0.45568984746932983
The generated pressure mean: 0.4596266746520996
loss_pred:0.03005356155335903, decouple_loss:0.012523430399596691
loss_pred:0.02950148470699787, decouple_loss:0.012372532859444618
Iteration: 882, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4718703329563141
loss_pred:0.029004788026213646, decouple_loss:0.011129782535135746
The generated pressure mean: 0.4720328748226166
loss_pred:0.03029727376997471, decouple_loss:0.010594035498797894
The generated pressure mean: 0.4730793833732605
loss_pred:0.030361827462911606, decouple_loss:0.010297480970621109
Iteration: 883, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44463786482810974
loss_pred:0.028939727693796158, decouple_loss:0.010485472157597542
The generated pressure mean: 0.44729945063591003
loss_pred:0.029418988153338432, decouple_loss:0.009598962031304836
The generated pressure mean: 0.4451800286769867
loss_pred:0.029286710545420647, decouple_loss:0.010255559347569942
Iteration: 884, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.42534205317497253
loss_pred:0.029548509046435356, decouple_loss:0.010425697080790997
The generated pressure mean: 0.4182989001274109
loss_pred:0.030084282159805298, decouple_loss:0.010486265644431114
The generated pressure mean: 0.42250776290893555
loss_pred:0.030608156695961952, decouple_loss:0.010867243632674217
Iteration: 885, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45133456587791443
loss_pred:0.0298406183719635, decouple_loss:0.010207303799688816
The generated pressure mean: 0.45015159249305725
loss_pred:0.028693396598100662, decouple_loss:0.00980388280004263
The generated pressure mean: 0.4488891065120697
loss_pred:0.029205983504652977, decouple_loss:0.010234713554382324
Iteration: 886, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.464307963848114
loss_pred:0.03024389035999775, decouple_loss:0.011891352012753487
The generated pressure mean: 0.465880423784256
loss_pred:0.028945989906787872, decouple_loss:0.01139418687671423
The generated pressure mean: 0.46729299426078796
loss_pred:0.028365183621644974, decouple_loss:0.011929640546441078
Iteration: 887, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4597424268722534
loss_pred:0.0291083175688982, decouple_loss:0.009684888646006584
The generated pressure mean: 0.4564860165119171
loss_pred:0.028145791962742805, decouple_loss:0.010573985055088997
The generated pressure mean: 0.4578136205673218
loss_pred:0.029359444975852966, decouple_loss:0.009885972365736961
Iteration: 888, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.42982161045074463
loss_pred:0.03162798658013344, decouple_loss:0.011213169433176517
The generated pressure mean: 0.42695003747940063
loss_pred:0.029305946081876755, decouple_loss:0.011163774877786636
The generated pressure mean: 0.4220535457134247
loss_pred:0.028859619051218033, decouple_loss:0.011694484390318394
Iteration: 889, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.435617595911026
loss_pred:0.028352605178952217, decouple_loss:0.009819910861551762
The generated pressure mean: 0.4356035590171814
loss_pred:0.029779087752103806, decouple_loss:0.009643473662436008
The generated pressure mean: 0.4361211657524109
loss_pred:0.02804758958518505, decouple_loss:0.009755895473062992
Iteration: 890, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4633554220199585
loss_pred:0.02990756556391716, decouple_loss:0.009847080335021019
The generated pressure mean: 0.46141743659973145
loss_pred:0.02761782333254814, decouple_loss:0.009151304140686989
The generated pressure mean: 0.45659658312797546
loss_pred:0.031468018889427185, decouple_loss:0.010118184611201286
2023-04-16 04:50:10 testing...
The generated pressure mean: 0.41705265641212463
loss_pred:0.04160396754741669, decouple_loss:0.010381069034337997
The generated pressure mean: 0.42406049370765686
loss_pred:0.04110416769981384, decouple_loss:0.010375604033470154
The generated pressure mean: 0.428703248500824
loss_pred:0.04143774136900902, decouple_loss:0.010862180031836033
Loss: 0.04190894216299057, avg_mse: 0.05530298873782158
current test mse: 0.055303
Iteration: 891, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4624535143375397
loss_pred:0.029276084154844284, decouple_loss:0.009004511870443821
The generated pressure mean: 0.45993107557296753
loss_pred:0.028260448947548866, decouple_loss:0.009660182520747185
The generated pressure mean: 0.46387720108032227
loss_pred:0.030763396993279457, decouple_loss:0.009620074182748795
Iteration: 892, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4417687952518463
The generated pressure mean: 0.4365420639514923
loss_pred:0.029544979333877563, decouple_loss:0.009081656113266945
loss_pred:0.030571576207876205, decouple_loss:0.008731463924050331
The generated pressure mean: 0.43940311670303345
loss_pred:0.028428710997104645, decouple_loss:0.00907053705304861
Iteration: 893, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.436644971370697
loss_pred:0.02953256480395794, decouple_loss:0.009653659537434578
The generated pressure mean: 0.4335823655128479
loss_pred:0.03226924315094948, decouple_loss:0.009977895766496658
The generated pressure mean: 0.43226689100265503
loss_pred:0.029902243986725807, decouple_loss:0.009349845349788666
Iteration: 894, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4387892484664917
loss_pred:0.02883118949830532, decouple_loss:0.008634323254227638
The generated pressure mean: 0.43957722187042236
loss_pred:0.030317412689328194, decouple_loss:0.008796942420303822
The generated pressure mean: 0.4386632442474365
loss_pred:0.028712822124361992, decouple_loss:0.009161672554910183
Iteration: 895, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4601758122444153
loss_pred:0.02936495840549469, decouple_loss:0.009361978620290756
The generated pressure mean: 0.459416002035141
loss_pred:0.03021770529448986, decouple_loss:0.009868504479527473
The generated pressure mean: 0.46159443259239197
loss_pred:0.028502367436885834, decouple_loss:0.010405951179564
Iteration: 896, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46346205472946167
loss_pred:0.02876186929643154, decouple_loss:0.009489312767982483
The generated pressure mean: 0.46089819073677063
loss_pred:0.02875112183392048, decouple_loss:0.00945785641670227
The generated pressure mean: 0.46446481347084045
loss_pred:0.02953159250319004, decouple_loss:0.009017661213874817
Iteration: 897, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4403209686279297
loss_pred:0.028484702110290527, decouple_loss:0.009519382379949093
The generated pressure mean: 0.44139477610588074
loss_pred:0.028367016464471817, decouple_loss:0.009477009065449238
The generated pressure mean: 0.436280757188797
loss_pred:0.028425265103578568, decouple_loss:0.010215622372925282
Iteration: 898, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.42962825298309326
loss_pred:0.03030448406934738, decouple_loss:0.009568985551595688
The generated pressure mean: 0.43241867423057556
loss_pred:0.029125183820724487, decouple_loss:0.009869984351098537
The generated pressure mean: 0.43632611632347107
loss_pred:0.029564468190073967, decouple_loss:0.009924535639584064
Iteration: 899, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45189011096954346
loss_pred:0.028098277747631073, decouple_loss:0.009075505658984184
The generated pressure mean: 0.45074042677879333
loss_pred:0.028383532539010048, decouple_loss:0.009333785623311996
The generated pressure mean: 0.44840630888938904
loss_pred:0.029480330646038055, decouple_loss:0.008762781508266926
Iteration: 900, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4562772810459137
loss_pred:0.02810661308467388, decouple_loss:0.009450413286685944
The generated pressure mean: 0.4527168869972229
loss_pred:0.029807448387145996, decouple_loss:0.009484187699854374
The generated pressure mean: 0.4529276490211487
loss_pred:0.02886824496090412, decouple_loss:0.009390993975102901
2023-04-16 04:52:11 testing...
The generated pressure mean: 0.41895031929016113
loss_pred:0.04272696003317833, decouple_loss:0.010575253516435623
The generated pressure mean: 0.42674481868743896
loss_pred:0.040859583765268326, decouple_loss:0.010432817041873932
The generated pressure mean: 0.4310345947742462
loss_pred:0.0412069596350193, decouple_loss:0.010953124612569809
Loss: 0.042130522429943085, avg_mse: 0.05440223217010498
current test mse: 0.054402
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012013_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012013_3_24hr.npz
NaN value num: 0
Iteration: 901, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4500037431716919
loss_pred:0.029690681025385857, decouple_loss:0.009580974467098713
The generated pressure mean: 0.4517050087451935
loss_pred:0.028574137017130852, decouple_loss:0.0100689847022295
The generated pressure mean: 0.4568261206150055
loss_pred:0.03031369112432003, decouple_loss:0.010094422847032547
Iteration: 902, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43825024366378784
loss_pred:0.03054966777563095, decouple_loss:0.009597189724445343
The generated pressure mean: 0.4337539076805115
loss_pred:0.0287924874573946, decouple_loss:0.009189977310597897
The generated pressure mean: 0.43990495800971985
loss_pred:0.03129581734538078, decouple_loss:0.00984448753297329
Iteration: 903, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43730801343917847
loss_pred:0.028098540380597115, decouple_loss:0.008420499041676521
The generated pressure mean: 0.43181607127189636
loss_pred:0.029232658445835114, decouple_loss:0.008426783606410027
The generated pressure mean: 0.4350120723247528
loss_pred:0.029440108686685562, decouple_loss:0.008968601003289223
Iteration: 904, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44207635521888733
loss_pred:0.030849963426589966, decouple_loss:0.008938857354223728
The generated pressure mean: 0.4386396110057831
loss_pred:0.029272399842739105, decouple_loss:0.009222903288900852
The generated pressure mean: 0.4405241310596466
loss_pred:0.02952352724969387, decouple_loss:0.009360087104141712
Iteration: 905, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45687994360923767
loss_pred:0.02870228886604309, decouple_loss:0.009145439602434635
The generated pressure mean: 0.4545063376426697
loss_pred:0.028768151998519897, decouple_loss:0.00882178544998169
The generated pressure mean: 0.4527943730354309
loss_pred:0.028756793588399887, decouple_loss:0.009382529184222221
Iteration: 906, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45133405923843384
loss_pred:0.02951294183731079, decouple_loss:0.009042943827807903
The generated pressure mean: 0.44934579730033875
loss_pred:0.029701968654990196, decouple_loss:0.00942008476704359
The generated pressure mean: 0.45442306995391846
loss_pred:0.03076760470867157, decouple_loss:0.009033487178385258
Iteration: 907, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4453487992286682
loss_pred:0.030563747510313988, decouple_loss:0.008387664332985878
The generated pressure mean: 0.4470807909965515
loss_pred:0.029454056173563004, decouple_loss:0.008745932951569557
The generated pressure mean: 0.441463440656662
loss_pred:0.027505027130246162, decouple_loss:0.00853694137185812
Iteration: 908, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43594858050346375
loss_pred:0.029982687905430794, decouple_loss:0.009198584593832493
The generated pressure mean: 0.4315100610256195
loss_pred:0.03008628636598587, decouple_loss:0.008871086873114109
The generated pressure mean: 0.4310518205165863
loss_pred:0.029364703223109245, decouple_loss:0.008444979786872864
Iteration: 909, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4486275315284729
loss_pred:0.029217664152383804, decouple_loss:0.00897296890616417
The generated pressure mean: 0.4570106267929077
loss_pred:0.030045364052057266, decouple_loss:0.008912994526326656
The generated pressure mean: 0.4539737105369568
loss_pred:0.029758861288428307, decouple_loss:0.00915346760302782
Iteration: 910, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4527824819087982
loss_pred:0.028059763833880424, decouple_loss:0.00795605219900608
The generated pressure mean: 0.4528364837169647
loss_pred:0.029434440657496452, decouple_loss:0.008302890695631504
The generated pressure mean: 0.45389965176582336
loss_pred:0.028558533638715744, decouple_loss:0.007900947704911232
2023-04-16 04:54:48 testing...
The generated pressure mean: 0.4222015142440796
loss_pred:0.04326212406158447, decouple_loss:0.009044645354151726
The generated pressure mean: 0.42966362833976746
loss_pred:0.0406857430934906, decouple_loss:0.008954640477895737
The generated pressure mean: 0.43381842970848083
loss_pred:0.042742565274238586, decouple_loss:0.009472256526350975
Loss: 0.04268800467252731, avg_mse: 0.05243659391999245
current test mse: 0.052437
Iteration: 911, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4443426728248596The generated pressure mean: 0.4406350255012512
loss_pred:0.02796471305191517, decouple_loss:0.007868734188377857
loss_pred:0.02800919860601425, decouple_loss:0.008400040678679943
The generated pressure mean: 0.43520933389663696
loss_pred:0.03018886037170887, decouple_loss:0.007911674678325653
Iteration: 912, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4385572075843811
The generated pressure mean: 0.43882113695144653
loss_pred:0.03045443445444107, decouple_loss:0.007888180203735828
loss_pred:0.029012715443968773, decouple_loss:0.007884352467954159
The generated pressure mean: 0.43811318278312683
loss_pred:0.028553100302815437, decouple_loss:0.007851756177842617
Iteration: 913, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45125123858451843
loss_pred:0.02833610028028488, decouple_loss:0.008157458156347275
The generated pressure mean: 0.45074763894081116
The generated pressure mean: 0.44916340708732605
loss_pred:0.027689296752214432, decouple_loss:0.008314143866300583
loss_pred:0.030507361516356468, decouple_loss:0.008421439677476883
Iteration: 914, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.454922080039978
loss_pred:0.029321439564228058, decouple_loss:0.008569604717195034
The generated pressure mean: 0.4543742835521698
loss_pred:0.02833612821996212, decouple_loss:0.008737423457205296
The generated pressure mean: 0.44860658049583435
loss_pred:0.028329193592071533, decouple_loss:0.00841099675744772
Iteration: 915, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43661269545555115
loss_pred:0.028516190126538277, decouple_loss:0.008683544583618641
The generated pressure mean: 0.4413606524467468
loss_pred:0.028705917298793793, decouple_loss:0.008630533702671528
The generated pressure mean: 0.4409995675086975
loss_pred:0.02828257717192173, decouple_loss:0.008411271497607231
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 916, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4324452579021454
loss_pred:0.028528984636068344, decouple_loss:0.009831516072154045
The generated pressure mean: 0.44248729944229126
loss_pred:0.028517916798591614, decouple_loss:0.008934338577091694
The generated pressure mean: 0.43981269001960754
loss_pred:0.029459508135914803, decouple_loss:0.009522372856736183
Iteration: 917, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4536205530166626
loss_pred:0.030391767621040344, decouple_loss:0.008845432661473751
The generated pressure mean: 0.4499082565307617
loss_pred:0.029191913083195686, decouple_loss:0.008884054608643055
The generated pressure mean: 0.45461058616638184
loss_pred:0.027123399078845978, decouple_loss:0.008363930508494377
Iteration: 918, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45411500334739685
loss_pred:0.029617957770824432, decouple_loss:0.008679870516061783
The generated pressure mean: 0.4515867233276367
loss_pred:0.029381055384874344, decouple_loss:0.009082706645131111
The generated pressure mean: 0.4587341845035553
loss_pred:0.028902851045131683, decouple_loss:0.009089536964893341
Iteration: 919, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4446895718574524
loss_pred:0.028586899861693382, decouple_loss:0.01000566128641367
The generated pressure mean: 0.4462966322898865
loss_pred:0.030354255810379982, decouple_loss:0.009990724734961987
The generated pressure mean: 0.4428572952747345
loss_pred:0.029149265959858894, decouple_loss:0.009793671779334545
Iteration: 920, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43592751026153564
loss_pred:0.027987461537122726, decouple_loss:0.01022664550691843
The generated pressure mean: 0.4355165362358093
loss_pred:0.028917791321873665, decouple_loss:0.009969742968678474
The generated pressure mean: 0.4425317049026489
loss_pred:0.027628133073449135, decouple_loss:0.00985482707619667
2023-04-16 04:56:49 testing...
The generated pressure mean: 0.4274247884750366
loss_pred:0.04052989184856415, decouple_loss:0.010214118286967278
The generated pressure mean: 0.4350607097148895
loss_pred:0.03902547061443329, decouple_loss:0.010478277690708637
The generated pressure mean: 0.44177353382110596
loss_pred:0.04022855684161186, decouple_loss:0.010812114924192429
Loss: 0.040453046560287476, avg_mse: 0.05202838033437729
current test mse: 0.052028
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012012_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012012_3_24hr.npz
NaN value num: 0
Iteration: 921, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4354376792907715
loss_pred:0.027344370260834694, decouple_loss:0.00870591588318348
The generated pressure mean: 0.4366881549358368
loss_pred:0.03042576275765896, decouple_loss:0.009646237827837467
The generated pressure mean: 0.43760064244270325
loss_pred:0.0300939679145813, decouple_loss:0.008619558066129684
Iteration: 922, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44915708899497986
The generated pressure mean: 0.4586838483810425
loss_pred:0.029915623366832733, decouple_loss:0.009758536703884602
loss_pred:0.029073812067508698, decouple_loss:0.00875366386026144
The generated pressure mean: 0.45619258284568787
loss_pred:0.029560619965195656, decouple_loss:0.008627260103821754
Iteration: 923, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45609769225120544
loss_pred:0.028528807684779167, decouple_loss:0.008271650411188602
The generated pressure mean: 0.4612255394458771
loss_pred:0.028532439842820168, decouple_loss:0.008565892465412617
The generated pressure mean: 0.4622296988964081
loss_pred:0.028161920607089996, decouple_loss:0.00906946137547493
Iteration: 924, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45212405920028687
loss_pred:0.028024062514305115, decouple_loss:0.00900887232273817
The generated pressure mean: 0.4503497779369354
loss_pred:0.02952093631029129, decouple_loss:0.009237859398126602
The generated pressure mean: 0.4436447024345398
loss_pred:0.028753558173775673, decouple_loss:0.009158934466540813
Iteration: 925, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44444793462753296
The generated pressure mean: 0.44033846259117126loss_pred:0.02963605336844921, decouple_loss:0.007995706982910633
loss_pred:0.027751928195357323, decouple_loss:0.0077201430685818195
The generated pressure mean: 0.4405002295970917
loss_pred:0.028231389820575714, decouple_loss:0.007934560999274254
Iteration: 926, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43822041153907776
loss_pred:0.028983503580093384, decouple_loss:0.009929840452969074
The generated pressure mean: 0.43693098425865173
loss_pred:0.02913222648203373, decouple_loss:0.010198700241744518
The generated pressure mean: 0.43239259719848633
loss_pred:0.029011372476816177, decouple_loss:0.009974288754165173
Iteration: 927, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44892632961273193
loss_pred:0.02752922847867012, decouple_loss:0.008887427859008312
The generated pressure mean: 0.44870930910110474
loss_pred:0.029236529022455215, decouple_loss:0.00940878689289093
The generated pressure mean: 0.4472285509109497
loss_pred:0.02748093754053116, decouple_loss:0.008952846750617027
Iteration: 928, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4539806842803955
loss_pred:0.02917458862066269, decouple_loss:0.009409081190824509
The generated pressure mean: 0.453157514333725
loss_pred:0.028737137094140053, decouple_loss:0.009081756696105003
The generated pressure mean: 0.45212826132774353
loss_pred:0.02914254553616047, decouple_loss:0.009495535865426064
Iteration: 929, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45216670632362366
loss_pred:0.029130741953849792, decouple_loss:0.010205034166574478
The generated pressure mean: 0.45063042640686035
loss_pred:0.028224999085068703, decouple_loss:0.01023762859404087
The generated pressure mean: 0.4516894221305847
loss_pred:0.028334327042102814, decouple_loss:0.010398389771580696
Iteration: 930, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4353220462799072
loss_pred:0.02853509970009327, decouple_loss:0.007897602394223213
The generated pressure mean: 0.4348667562007904
loss_pred:0.02892942726612091, decouple_loss:0.008353129029273987
The generated pressure mean: 0.4315420687198639
loss_pred:0.0282696895301342, decouple_loss:0.007732818368822336
2023-04-16 04:59:25 testing...
The generated pressure mean: 0.4192636013031006
loss_pred:0.03907173126935959, decouple_loss:0.010293799452483654
The generated pressure mean: 0.4261029064655304
loss_pred:0.039059318602085114, decouple_loss:0.010047737509012222
The generated pressure mean: 0.4317052364349365
loss_pred:0.03838934376835823, decouple_loss:0.01049878355115652
Loss: 0.03935413807630539, avg_mse: 0.05079270526766777
current test mse: 0.050793
Iteration: 931, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4571841359138489
loss_pred:0.028526674956083298, decouple_loss:0.010380192659795284
The generated pressure mean: 0.4580592215061188
loss_pred:0.02811868116259575, decouple_loss:0.009752382524311543
The generated pressure mean: 0.45729202032089233
loss_pred:0.02771824225783348, decouple_loss:0.009423981420695782
Iteration: 932, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44803136587142944
loss_pred:0.02785632014274597, decouple_loss:0.00909215584397316
The generated pressure mean: 0.44500017166137695
loss_pred:0.028430910781025887, decouple_loss:0.009523731656372547
The generated pressure mean: 0.4510403573513031
loss_pred:0.027343181893229485, decouple_loss:0.009385989047586918
Iteration: 933, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4385570287704468
loss_pred:0.028003161773085594, decouple_loss:0.008651180192828178
The generated pressure mean: 0.43996480107307434
loss_pred:0.02854905091226101, decouple_loss:0.008875967003405094
The generated pressure mean: 0.43110191822052
loss_pred:0.027595825493335724, decouple_loss:0.008645697496831417
Iteration: 934, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44743213057518005
The generated pressure mean: 0.44246628880500793loss_pred:0.029455676674842834, decouple_loss:0.011357039213180542
loss_pred:0.02831452339887619, decouple_loss:0.010920681059360504
The generated pressure mean: 0.4519936740398407
loss_pred:0.02945183962583542, decouple_loss:0.011338267475366592
Iteration: 935, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46366235613822937
The generated pressure mean: 0.4689605236053467loss_pred:0.027022095397114754, decouple_loss:0.009920292533934116
loss_pred:0.02980939857661724, decouple_loss:0.009592695161700249
The generated pressure mean: 0.46615439653396606
loss_pred:0.02764260023832321, decouple_loss:0.009580012410879135
Iteration: 936, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44618213176727295
loss_pred:0.027914825826883316, decouple_loss:0.008513580076396465
The generated pressure mean: 0.4436613619327545
loss_pred:0.028120942413806915, decouple_loss:0.009206696413457394
The generated pressure mean: 0.44637179374694824
loss_pred:0.028491748496890068, decouple_loss:0.008419379591941833
Iteration: 937, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.421489953994751
loss_pred:0.028921281918883324, decouple_loss:0.01125683169811964
The generated pressure mean: 0.42144620418548584
loss_pred:0.02759633958339691, decouple_loss:0.01151115819811821
The generated pressure mean: 0.41989535093307495
loss_pred:0.028108879923820496, decouple_loss:0.011535362340509892
Iteration: 938, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44193148612976074
loss_pred:0.029518090188503265, decouple_loss:0.012238040566444397
The generated pressure mean: 0.4481354355812073
loss_pred:0.028723042458295822, decouple_loss:0.011614751070737839
The generated pressure mean: 0.4501095712184906
loss_pred:0.028228744864463806, decouple_loss:0.012217560783028603
Iteration: 939, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.47133582830429077
loss_pred:0.028949899598956108, decouple_loss:0.008949898183345795
The generated pressure mean: 0.46927034854888916
loss_pred:0.029158897697925568, decouple_loss:0.008914078585803509
The generated pressure mean: 0.4672842025756836
loss_pred:0.02839885838329792, decouple_loss:0.008919958956539631
Iteration: 940, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4631340503692627
loss_pred:0.027864307165145874, decouple_loss:0.008837358094751835
The generated pressure mean: 0.45857733488082886
loss_pred:0.02765367552638054, decouple_loss:0.008531796745955944
The generated pressure mean: 0.4581054747104645
loss_pred:0.02818014845252037, decouple_loss:0.008659088984131813
2023-04-16 05:01:26 testing...
The generated pressure mean: 0.4274308979511261
loss_pred:0.03889554738998413, decouple_loss:0.011187239550054073
The generated pressure mean: 0.4353853464126587
loss_pred:0.03778056055307388, decouple_loss:0.011187469586730003
The generated pressure mean: 0.44087737798690796
loss_pred:0.037965334951877594, decouple_loss:0.011580739170312881
Loss: 0.038779739290475845, avg_mse: 0.04958093911409378
current test mse: 0.049581
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012007_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012007_3_24hr.npz
NaN value num: 0
Iteration: 941, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.42260074615478516
loss_pred:0.029538467526435852, decouple_loss:0.010842138901352882
The generated pressure mean: 0.4239215850830078
loss_pred:0.028490496799349785, decouple_loss:0.010271173901855946
The generated pressure mean: 0.431306391954422
loss_pred:0.02751270867884159, decouple_loss:0.010565291158854961
Iteration: 942, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.42789384722709656
The generated pressure mean: 0.42843225598335266
loss_pred:0.027734994888305664, decouple_loss:0.00938707496970892
loss_pred:0.027787450700998306, decouple_loss:0.009233027696609497
The generated pressure mean: 0.4295139014720917
loss_pred:0.029203766956925392, decouple_loss:0.008907435461878777
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 943, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4550587832927704
loss_pred:0.026556778699159622, decouple_loss:0.0087687773630023
The generated pressure mean: 0.4570595920085907The generated pressure mean: 0.4509740471839905
loss_pred:0.028506772592663765, decouple_loss:0.008537443354725838
loss_pred:0.02790181152522564, decouple_loss:0.008901230990886688
Iteration: 944, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.466796338558197
The generated pressure mean: 0.46757784485816956loss_pred:0.028005331754684448, decouple_loss:0.010466090403497219
loss_pred:0.02802462689578533, decouple_loss:0.010216092690825462
The generated pressure mean: 0.46372562646865845
loss_pred:0.028279852122068405, decouple_loss:0.010680708102881908
Iteration: 945, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4446440041065216
loss_pred:0.0277973935008049, decouple_loss:0.009599526412785053
The generated pressure mean: 0.4463888108730316
loss_pred:0.028467776253819466, decouple_loss:0.009508252143859863
The generated pressure mean: 0.4472281038761139
loss_pred:0.028478506952524185, decouple_loss:0.010076127015054226
Iteration: 946, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4351770579814911
loss_pred:0.02868627943098545, decouple_loss:0.00843992829322815
The generated pressure mean: 0.4346068203449249
loss_pred:0.028213251382112503, decouple_loss:0.007736392319202423
The generated pressure mean: 0.4344591796398163
loss_pred:0.029695920646190643, decouple_loss:0.00852066557854414
Iteration: 947, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4400598108768463
loss_pred:0.030132213607430458, decouple_loss:0.010371265932917595
The generated pressure mean: 0.437259703874588
loss_pred:0.029052609577775, decouple_loss:0.01014179177582264
The generated pressure mean: 0.4361441731452942
loss_pred:0.027401063591241837, decouple_loss:0.010428184643387794
Iteration: 948, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45817920565605164
loss_pred:0.028994247317314148, decouple_loss:0.008213868364691734
The generated pressure mean: 0.4584603011608124
loss_pred:0.028161706402897835, decouple_loss:0.008419319055974483
The generated pressure mean: 0.45842286944389343
loss_pred:0.02813834697008133, decouple_loss:0.008645474910736084
Iteration: 949, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4615163803100586
The generated pressure mean: 0.4603051245212555
loss_pred:0.02637309394776821, decouple_loss:0.009736299514770508
loss_pred:0.026706373319029808, decouple_loss:0.009442812763154507
The generated pressure mean: 0.461032897233963
loss_pred:0.03039117343723774, decouple_loss:0.009354948997497559
Iteration: 950, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43372851610183716
loss_pred:0.028444331139326096, decouple_loss:0.009848341345787048
The generated pressure mean: 0.43426206707954407
loss_pred:0.028334680944681168, decouple_loss:0.009685968048870564
The generated pressure mean: 0.4357517659664154
loss_pred:0.02824230119585991, decouple_loss:0.010048724710941315
2023-04-16 05:04:02 testing...
The generated pressure mean: 0.42356929183006287
loss_pred:0.03941252455115318, decouple_loss:0.010459152050316334
The generated pressure mean: 0.43357953429222107
loss_pred:0.03801755607128143, decouple_loss:0.010546023957431316
The generated pressure mean: 0.439523845911026
loss_pred:0.03844654932618141, decouple_loss:0.010912066325545311
Loss: 0.03915749862790108, avg_mse: 0.05122392252087593
current test mse: 0.051224
Iteration: 951, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43973204493522644
loss_pred:0.027862127870321274, decouple_loss:0.009407402947545052
The generated pressure mean: 0.4369055926799774
loss_pred:0.029627099633216858, decouple_loss:0.009360484778881073
The generated pressure mean: 0.4392909109592438
loss_pred:0.028716187924146652, decouple_loss:0.00962543860077858
Iteration: 952, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45895916223526
loss_pred:0.03003087267279625, decouple_loss:0.01122983917593956
The generated pressure mean: 0.4586811065673828
loss_pred:0.0282155629247427, decouple_loss:0.011660349555313587
The generated pressure mean: 0.45795542001724243
loss_pred:0.02831749990582466, decouple_loss:0.011600113473832607
Iteration: 953, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4463786482810974
loss_pred:0.027345765382051468, decouple_loss:0.008592166937887669
The generated pressure mean: 0.4486018121242523
loss_pred:0.02697250060737133, decouple_loss:0.008621113374829292
The generated pressure mean: 0.4485211670398712
loss_pred:0.02877901867032051, decouple_loss:0.008730101399123669
Iteration: 954, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4414265751838684
loss_pred:0.027574943378567696, decouple_loss:0.010396192781627178
The generated pressure mean: 0.4436819553375244
loss_pred:0.026902882382273674, decouple_loss:0.010200449265539646
The generated pressure mean: 0.44383251667022705
loss_pred:0.026323119178414345, decouple_loss:0.010334288701415062
Iteration: 955, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43598639965057373
loss_pred:0.02966497465968132, decouple_loss:0.011264790780842304
The generated pressure mean: 0.43903279304504395
loss_pred:0.0279502272605896, decouple_loss:0.012006718665361404
The generated pressure mean: 0.4453597962856293
loss_pred:0.028278566896915436, decouple_loss:0.011934173293411732
Iteration: 956, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4470445215702057
loss_pred:0.027726557105779648, decouple_loss:0.009756600484251976
The generated pressure mean: 0.4481460750102997
loss_pred:0.027434930205345154, decouple_loss:0.0097944475710392
The generated pressure mean: 0.4484644830226898
loss_pred:0.027427759021520615, decouple_loss:0.010019895620644093
Iteration: 957, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4479474723339081
loss_pred:0.027424564585089684, decouple_loss:0.009678924456238747
The generated pressure mean: 0.447788804769516
loss_pred:0.027520032599568367, decouple_loss:0.009793310426175594
The generated pressure mean: 0.44972914457321167
loss_pred:0.027326149865984917, decouple_loss:0.009825674816966057
Iteration: 958, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45357340574264526
loss_pred:0.030515937134623528, decouple_loss:0.011249905452132225
The generated pressure mean: 0.45081332325935364
loss_pred:0.027640722692012787, decouple_loss:0.010693645104765892
The generated pressure mean: 0.45306098461151123
loss_pred:0.026739969849586487, decouple_loss:0.010786451399326324
Iteration: 959, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4435814917087555
loss_pred:0.027512341737747192, decouple_loss:0.008752889931201935
The generated pressure mean: 0.4346753656864166
loss_pred:0.027916431427001953, decouple_loss:0.008628733456134796
The generated pressure mean: 0.4376049339771271
loss_pred:0.028293181210756302, decouple_loss:0.008859410881996155
Iteration: 960, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4474222660064697
loss_pred:0.02728249877691269, decouple_loss:0.009297656826674938
The generated pressure mean: 0.4480202794075012
loss_pred:0.027059372514486313, decouple_loss:0.009638272225856781
The generated pressure mean: 0.4506218433380127
loss_pred:0.026640042662620544, decouple_loss:0.00956953689455986
2023-04-16 05:06:04 testing...
The generated pressure mean: 0.4179442226886749
loss_pred:0.04096847027540207, decouple_loss:0.010226098820567131
The generated pressure mean: 0.42642831802368164
loss_pred:0.03876488655805588, decouple_loss:0.010023466311395168
The generated pressure mean: 0.4313904345035553
loss_pred:0.0399559810757637, decouple_loss:0.010500665754079819
Loss: 0.04040895029902458, avg_mse: 0.05262450501322746
current test mse: 0.052625
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012000_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012000_3_24hr.npz
NaN value num: 0
Iteration: 961, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45452678203582764
loss_pred:0.02768845297396183, decouple_loss:0.009260962717235088
The generated pressure mean: 0.4531151354312897
loss_pred:0.02855781838297844, decouple_loss:0.009279238060116768
The generated pressure mean: 0.4507282078266144
loss_pred:0.02775133028626442, decouple_loss:0.009188156574964523
Iteration: 962, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43865999579429626The generated pressure mean: 0.43268659710884094
loss_pred:0.02836391143500805, decouple_loss:0.009236323647201061
loss_pred:0.027874259278178215, decouple_loss:0.00901069026440382
The generated pressure mean: 0.4358237385749817
loss_pred:0.02627347595989704, decouple_loss:0.009062325581908226
Iteration: 963, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4453223645687103
loss_pred:0.028864813968539238, decouple_loss:0.008680620230734348
The generated pressure mean: 0.44618210196495056
The generated pressure mean: 0.4482625126838684
loss_pred:0.02811119705438614, decouple_loss:0.008608691394329071
loss_pred:0.028044193983078003, decouple_loss:0.00847613625228405
Iteration: 964, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45235881209373474
loss_pred:0.029151087626814842, decouple_loss:0.009293277747929096
The generated pressure mean: 0.4498310685157776
loss_pred:0.026919983327388763, decouple_loss:0.009018940851092339
The generated pressure mean: 0.45426324009895325
loss_pred:0.028585076332092285, decouple_loss:0.009007914923131466
Iteration: 965, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4475387632846832
loss_pred:0.028057225048542023, decouple_loss:0.008558199740946293
The generated pressure mean: 0.4416227638721466
loss_pred:0.028307830914855003, decouple_loss:0.008254628628492355
The generated pressure mean: 0.4439032971858978
loss_pred:0.02699662744998932, decouple_loss:0.008130362257361412
Iteration: 966, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44343653321266174
loss_pred:0.027911940589547157, decouple_loss:0.00812466349452734
The generated pressure mean: 0.4371914565563202
loss_pred:0.027440810576081276, decouple_loss:0.008447352796792984
The generated pressure mean: 0.4348979890346527
loss_pred:0.027619456872344017, decouple_loss:0.008276739157736301
Iteration: 967, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45465752482414246
loss_pred:0.02847297303378582, decouple_loss:0.008842951618134975
The generated pressure mean: 0.4453466534614563
loss_pred:0.027237338945269585, decouple_loss:0.008869361132383347
The generated pressure mean: 0.4522641897201538
loss_pred:0.02780926413834095, decouple_loss:0.008692620322108269
Iteration: 968, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4501790404319763
loss_pred:0.028057053685188293, decouple_loss:0.00923908594995737
The generated pressure mean: 0.4502817392349243
loss_pred:0.027795422822237015, decouple_loss:0.009379882365465164
The generated pressure mean: 0.45051971077919006
loss_pred:0.027005018666386604, decouple_loss:0.009221992455422878
Iteration: 969, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4483751654624939
loss_pred:0.028448082506656647, decouple_loss:0.011193118058145046
The generated pressure mean: 0.4463707506656647
loss_pred:0.028678830713033676, decouple_loss:0.011166034266352654
The generated pressure mean: 0.4489750862121582
loss_pred:0.027765851467847824, decouple_loss:0.01108721923083067
Iteration: 970, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4361029863357544
loss_pred:0.027446357533335686, decouple_loss:0.00859128125011921
The generated pressure mean: 0.4372907876968384
loss_pred:0.027813410386443138, decouple_loss:0.0086213992908597
The generated pressure mean: 0.4367638826370239
loss_pred:0.027020880952477455, decouple_loss:0.008459911681711674
2023-04-16 05:08:40 testing...
The generated pressure mean: 0.4197215139865875
loss_pred:0.03867381811141968, decouple_loss:0.009995241649448872
The generated pressure mean: 0.4301885962486267
loss_pred:0.03807511553168297, decouple_loss:0.009676891379058361
The generated pressure mean: 0.4357154965400696
loss_pred:0.037741001695394516, decouple_loss:0.009998101741075516
Loss: 0.038657814264297485, avg_mse: 0.05023997277021408
current test mse: 0.05024
Iteration: 971, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44310465455055237
loss_pred:0.02646658569574356, decouple_loss:0.00887263659387827
The generated pressure mean: 0.45127159357070923
loss_pred:0.03076399676501751, decouple_loss:0.009169278666377068
The generated pressure mean: 0.44287240505218506
loss_pred:0.02712276764214039, decouple_loss:0.00896069873124361
Iteration: 972, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4594220221042633
loss_pred:0.02802656963467598, decouple_loss:0.00993251707404852
The generated pressure mean: 0.45947733521461487
loss_pred:0.02756405994296074, decouple_loss:0.009601461701095104
The generated pressure mean: 0.45826447010040283
loss_pred:0.027372019365429878, decouple_loss:0.00973448995500803
Iteration: 973, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4465121924877167
loss_pred:0.02757616527378559, decouple_loss:0.01003127358853817
The generated pressure mean: 0.44266459345817566
loss_pred:0.0293169803917408, decouple_loss:0.009379470720887184
The generated pressure mean: 0.4473423361778259
loss_pred:0.028638634830713272, decouple_loss:0.010009163990616798
Iteration: 974, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4304591119289398
The generated pressure mean: 0.4285920262336731
loss_pred:0.02876569703221321, decouple_loss:0.008601968176662922
loss_pred:0.02804749086499214, decouple_loss:0.008889729157090187
The generated pressure mean: 0.43254756927490234
loss_pred:0.029166100546717644, decouple_loss:0.008820874616503716
Iteration: 975, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4515841007232666
The generated pressure mean: 0.4461464285850525
loss_pred:0.027680158615112305, decouple_loss:0.008335530757904053
loss_pred:0.028457822278141975, decouple_loss:0.008436423726379871
The generated pressure mean: 0.4487156271934509
loss_pred:0.027151530608534813, decouple_loss:0.008544953539967537
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 976, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4562244117259979
loss_pred:0.027466967701911926, decouple_loss:0.009095605462789536
The generated pressure mean: 0.4468275010585785
loss_pred:0.02727934718132019, decouple_loss:0.008496892638504505
The generated pressure mean: 0.4464561641216278
loss_pred:0.027725428342819214, decouple_loss:0.00871195923537016
Iteration: 977, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44420722126960754
loss_pred:0.027335479855537415, decouple_loss:0.009125362150371075
The generated pressure mean: 0.4513961374759674
loss_pred:0.028300786390900612, decouple_loss:0.009166077710688114
The generated pressure mean: 0.4417687952518463
loss_pred:0.02991463616490364, decouple_loss:0.009165672585368156
Iteration: 978, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4452662467956543
loss_pred:0.02751801162958145, decouple_loss:0.009260845370590687
The generated pressure mean: 0.4510103166103363
loss_pred:0.026851609349250793, decouple_loss:0.008810162544250488
The generated pressure mean: 0.4395257234573364
loss_pred:0.028534697368741035, decouple_loss:0.008997492492198944
Iteration: 979, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46307945251464844
loss_pred:0.028777875006198883, decouple_loss:0.008258436806499958
The generated pressure mean: 0.458958238363266
loss_pred:0.026946695521473885, decouple_loss:0.008414908312261105
The generated pressure mean: 0.45764365792274475
loss_pred:0.028143534436821938, decouple_loss:0.008206615224480629
Iteration: 980, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4383948743343353
loss_pred:0.02893948182463646, decouple_loss:0.009118551388382912
The generated pressure mean: 0.44228383898735046
loss_pred:0.02812073938548565, decouple_loss:0.008756409399211407
The generated pressure mean: 0.4345102906227112
loss_pred:0.027649564668536186, decouple_loss:0.008893046528100967
2023-04-16 05:10:40 testing...
The generated pressure mean: 0.42312896251678467
loss_pred:0.0396268367767334, decouple_loss:0.011316094547510147
The generated pressure mean: 0.4341479241847992
loss_pred:0.037577275186777115, decouple_loss:0.0113504184409976
The generated pressure mean: 0.4396727979183197
loss_pred:0.038095872849226, decouple_loss:0.011802944354712963
Loss: 0.039007820188999176, avg_mse: 0.05090399831533432
current test mse: 0.050904
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012004_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012004_3_24hr.npz
NaN value num: 0
Iteration: 981, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4364945888519287
loss_pred:0.02650642767548561, decouple_loss:0.01113949902355671
The generated pressure mean: 0.4392414689064026
loss_pred:0.02903713285923004, decouple_loss:0.010760587640106678
The generated pressure mean: 0.4403460919857025
loss_pred:0.027521103620529175, decouple_loss:0.01080828532576561
Iteration: 982, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4469681680202484
loss_pred:0.027072163298726082, decouple_loss:0.008845643140375614
The generated pressure mean: 0.44769805669784546
loss_pred:0.026881687343120575, decouple_loss:0.008918967097997665
The generated pressure mean: 0.44753363728523254
loss_pred:0.026849322021007538, decouple_loss:0.008816231973469257
Iteration: 983, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45888015627861023
loss_pred:0.027109980583190918, decouple_loss:0.009643884375691414
The generated pressure mean: 0.46119141578674316
loss_pred:0.027961449697613716, decouple_loss:0.009681910276412964
The generated pressure mean: 0.46100327372550964
loss_pred:0.028670594096183777, decouple_loss:0.009203202091157436
Iteration: 984, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44841423630714417
loss_pred:0.025842951610684395, decouple_loss:0.008895625360310078
The generated pressure mean: 0.446319043636322
loss_pred:0.027047425508499146, decouple_loss:0.009418551810085773
The generated pressure mean: 0.4497468173503876
loss_pred:0.027233175933361053, decouple_loss:0.009086396545171738
Iteration: 985, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4343085289001465
loss_pred:0.027224775403738022, decouple_loss:0.01092620100826025
The generated pressure mean: 0.4321499168872833
loss_pred:0.02678721211850643, decouple_loss:0.010097326710820198
The generated pressure mean: 0.4407102167606354
loss_pred:0.0290073249489069, decouple_loss:0.009893354959785938
Iteration: 986, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44620001316070557
loss_pred:0.02686639316380024, decouple_loss:0.00976132694631815
The generated pressure mean: 0.44465723633766174
loss_pred:0.028041690587997437, decouple_loss:0.009789375588297844
The generated pressure mean: 0.4446433484554291
loss_pred:0.026100218296051025, decouple_loss:0.010022995062172413
Iteration: 987, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4503321647644043
loss_pred:0.0266947653144598, decouple_loss:0.009708674624562263
The generated pressure mean: 0.45939940214157104
loss_pred:0.028018830344080925, decouple_loss:0.009847642853856087
The generated pressure mean: 0.4551946520805359
loss_pred:0.028386244550347328, decouple_loss:0.009447393007576466
Iteration: 988, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44409698247909546
loss_pred:0.028462784364819527, decouple_loss:0.009113125503063202
The generated pressure mean: 0.4429369270801544
loss_pred:0.026939181610941887, decouple_loss:0.008572591468691826
The generated pressure mean: 0.44157975912094116
loss_pred:0.02770317904651165, decouple_loss:0.008939707651734352
Iteration: 989, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4442732334136963
loss_pred:0.028231222182512283, decouple_loss:0.009515591897070408
The generated pressure mean: 0.44650259613990784
loss_pred:0.028487911447882652, decouple_loss:0.009250113740563393
The generated pressure mean: 0.4468592405319214
loss_pred:0.027804477140307426, decouple_loss:0.009221897460520267
Iteration: 990, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4455207586288452
loss_pred:0.026947496458888054, decouple_loss:0.007334467954933643
The generated pressure mean: 0.45284417271614075
loss_pred:0.027486540377140045, decouple_loss:0.007578159682452679
The generated pressure mean: 0.4514038562774658
loss_pred:0.02667219750583172, decouple_loss:0.008062236942350864
2023-04-16 05:13:16 testing...
The generated pressure mean: 0.41893723607063293
loss_pred:0.03925556316971779, decouple_loss:0.009935363195836544
The generated pressure mean: 0.42662081122398376
loss_pred:0.0392267107963562, decouple_loss:0.009764616377651691
The generated pressure mean: 0.43030431866645813
loss_pred:0.038557831197977066, decouple_loss:0.010198638774454594
Loss: 0.039511680603027344, avg_mse: 0.05110475420951843
current test mse: 0.051105
Iteration: 991, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45443814992904663
The generated pressure mean: 0.4543493986129761
loss_pred:0.02854091301560402, decouple_loss:0.00913072656840086
loss_pred:0.027048809453845024, decouple_loss:0.009496350772678852
The generated pressure mean: 0.4527153968811035
loss_pred:0.027195513248443604, decouple_loss:0.008988880552351475
Iteration: 992, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44059455394744873
loss_pred:0.027484580874443054, decouple_loss:0.0078020524233579636
The generated pressure mean: 0.4391612112522125
The generated pressure mean: 0.4410552382469177
loss_pred:0.02756849117577076, decouple_loss:0.008002545684576035
loss_pred:0.026270808652043343, decouple_loss:0.007637383881956339
Iteration: 993, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44189906120300293
loss_pred:0.02778017334640026, decouple_loss:0.009933685883879662
The generated pressure mean: 0.4426729679107666
loss_pred:0.02748718485236168, decouple_loss:0.009667659178376198
The generated pressure mean: 0.4428865909576416
loss_pred:0.02742258459329605, decouple_loss:0.009767979383468628
Iteration: 994, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44995856285095215
loss_pred:0.026156973093748093, decouple_loss:0.008901902474462986
The generated pressure mean: 0.448064923286438
loss_pred:0.026389218866825104, decouple_loss:0.00912247784435749
The generated pressure mean: 0.45246422290802
loss_pred:0.028042497113347054, decouple_loss:0.009142270311713219
Iteration: 995, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45225563645362854
loss_pred:0.026550358161330223, decouple_loss:0.008920878171920776
The generated pressure mean: 0.45067864656448364
loss_pred:0.0267383623868227, decouple_loss:0.009419232606887817
The generated pressure mean: 0.4551364481449127
loss_pred:0.02774122543632984, decouple_loss:0.008479814045131207
Iteration: 996, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45216166973114014
loss_pred:0.028289295732975006, decouple_loss:0.008993947878479958
The generated pressure mean: 0.44665423035621643
loss_pred:0.028235960751771927, decouple_loss:0.008899424225091934
The generated pressure mean: 0.44292792677879333
loss_pred:0.027005551382899284, decouple_loss:0.008574065752327442
Iteration: 997, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.433847039937973
loss_pred:0.026879357174038887, decouple_loss:0.009541708044707775
The generated pressure mean: 0.4408966302871704
loss_pred:0.028074178844690323, decouple_loss:0.009513777680695057
The generated pressure mean: 0.4367999732494354
loss_pred:0.026296064257621765, decouple_loss:0.009803500026464462
Iteration: 998, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44407105445861816
loss_pred:0.025949686765670776, decouple_loss:0.007414036430418491
The generated pressure mean: 0.4428325891494751
loss_pred:0.026293475180864334, decouple_loss:0.007796798832714558
The generated pressure mean: 0.4471852481365204
loss_pred:0.025321321561932564, decouple_loss:0.007371789310127497
Iteration: 999, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45751407742500305
loss_pred:0.025629039853811264, decouple_loss:0.009355608373880386
The generated pressure mean: 0.45828139781951904
loss_pred:0.02687148004770279, decouple_loss:0.008953151293098927
The generated pressure mean: 0.4575892388820648
loss_pred:0.026134563609957695, decouple_loss:0.008685974404215813
Iteration: 1000, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45960181951522827
loss_pred:0.026951629668474197, decouple_loss:0.008508401922881603
The generated pressure mean: 0.45806434750556946
loss_pred:0.026020869612693787, decouple_loss:0.008510449901223183
The generated pressure mean: 0.4560657739639282
loss_pred:0.026724934577941895, decouple_loss:0.008934581652283669
2023-04-16 05:15:17 itr: 1000
training loss: [0.02717166 0.02737705 0.02644639]
2023-04-16 05:15:17 testing...
The generated pressure mean: 0.42212149500846863
loss_pred:0.03941032662987709, decouple_loss:0.008899131789803505
The generated pressure mean: 0.43050652742385864
loss_pred:0.03865114599466324, decouple_loss:0.008919918909668922
The generated pressure mean: 0.43546637892723083
loss_pred:0.03892845660448074, decouple_loss:0.009503237903118134
Loss: 0.03945201635360718, avg_mse: 0.052154362201690674
current test mse: 0.052154
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012001_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012001_3_24hr.npz
NaN value num: 0
Iteration: 1001, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4454292356967926
loss_pred:0.02815147303044796, decouple_loss:0.008694712072610855
The generated pressure mean: 0.4426775574684143
loss_pred:0.02744915895164013, decouple_loss:0.008288765326142311
The generated pressure mean: 0.4367998242378235
loss_pred:0.027643078938126564, decouple_loss:0.00876993965357542
Iteration: 1002, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43086034059524536
loss_pred:0.028588278219103813, decouple_loss:0.008840569294989109
The generated pressure mean: 0.4336092472076416
loss_pred:0.030552351847290993, decouple_loss:0.008880884386599064
The generated pressure mean: 0.4318125545978546
loss_pred:0.02909422293305397, decouple_loss:0.009346823208034039
Iteration: 1003, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4412621259689331
loss_pred:0.02767757512629032, decouple_loss:0.010183773003518581
The generated pressure mean: 0.4464651048183441
loss_pred:0.028316721320152283, decouple_loss:0.009821619838476181
The generated pressure mean: 0.44888293743133545
loss_pred:0.026900924742221832, decouple_loss:0.009747033938765526
Iteration: 1004, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44949010014533997
loss_pred:0.02713777869939804, decouple_loss:0.008690191432833672
The generated pressure mean: 0.45649364590644836
loss_pred:0.02795957773923874, decouple_loss:0.00849446002393961
The generated pressure mean: 0.4539913833141327
loss_pred:0.02844659611582756, decouple_loss:0.00846831314265728
Iteration: 1005, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44648364186286926
loss_pred:0.02949550561606884, decouple_loss:0.009472846053540707
The generated pressure mean: 0.44948074221611023
loss_pred:0.028624864295125008, decouple_loss:0.00969325378537178
The generated pressure mean: 0.45251309871673584
loss_pred:0.026714729145169258, decouple_loss:0.009422402828931808
Iteration: 1006, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4444052278995514
loss_pred:0.028769657015800476, decouple_loss:0.008375043980777264
The generated pressure mean: 0.4474041759967804
loss_pred:0.026479007676243782, decouple_loss:0.008318954147398472
The generated pressure mean: 0.4392763376235962
loss_pred:0.029099948704242706, decouple_loss:0.008382256142795086
Iteration: 1007, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45503777265548706
loss_pred:0.027161814272403717, decouple_loss:0.010302744805812836
The generated pressure mean: 0.45205628871917725
loss_pred:0.029204126447439194, decouple_loss:0.010227912105619907
The generated pressure mean: 0.44871339201927185
loss_pred:0.028242068365216255, decouple_loss:0.010378235019743443
Iteration: 1008, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44362303614616394
loss_pred:0.028165357187390327, decouple_loss:0.010514895431697369
The generated pressure mean: 0.44640564918518066
loss_pred:0.02606627531349659, decouple_loss:0.010435397736728191
The generated pressure mean: 0.4448279142379761
loss_pred:0.026234280318021774, decouple_loss:0.010164902545511723
Iteration: 1009, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4379882216453552
loss_pred:0.027584504336118698, decouple_loss:0.012634994462132454
The generated pressure mean: 0.44123393297195435
loss_pred:0.027711806818842888, decouple_loss:0.012531163170933723
The generated pressure mean: 0.43609729409217834
loss_pred:0.03119472973048687, decouple_loss:0.012151301838457584
Iteration: 1010, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4426299035549164
loss_pred:0.028326846659183502, decouple_loss:0.01045818068087101
The generated pressure mean: 0.4441049098968506
loss_pred:0.02716120518743992, decouple_loss:0.010755525901913643
The generated pressure mean: 0.44814273715019226
loss_pred:0.026404744014143944, decouple_loss:0.010805058293044567
2023-04-16 05:17:58 testing...
The generated pressure mean: 0.4200630187988281
loss_pred:0.04022107273340225, decouple_loss:0.012077780440449715
The generated pressure mean: 0.42844781279563904
loss_pred:0.03852193057537079, decouple_loss:0.01260460913181305
The generated pressure mean: 0.43311241269111633
loss_pred:0.03909171745181084, decouple_loss:0.012794422917068005
Loss: 0.03990285471081734, avg_mse: 0.0511820912361145
current test mse: 0.051182
Iteration: 1011, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45241111516952515
loss_pred:0.028669269755482674, decouple_loss:0.010500840842723846
The generated pressure mean: 0.4542986750602722
loss_pred:0.029290039092302322, decouple_loss:0.011429752223193645
The generated pressure mean: 0.45879387855529785
loss_pred:0.026668863371014595, decouple_loss:0.010798661038279533
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1012, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.450417697429657
loss_pred:0.02695516310632229, decouple_loss:0.0099409194663167
The generated pressure mean: 0.4563838243484497
loss_pred:0.02587869018316269, decouple_loss:0.010100133717060089
The generated pressure mean: 0.4527899920940399
loss_pred:0.02833455614745617, decouple_loss:0.010250257328152657
Iteration: 1013, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4330635368824005
loss_pred:0.028524206951260567, decouple_loss:0.010151795111596584
The generated pressure mean: 0.43421614170074463
loss_pred:0.027228178456425667, decouple_loss:0.01027592457830906
The generated pressure mean: 0.43264153599739075
loss_pred:0.02637440524995327, decouple_loss:0.010253990069031715
Iteration: 1014, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44041067361831665
loss_pred:0.028135402128100395, decouple_loss:0.009903720580041409
The generated pressure mean: 0.4432162046432495
loss_pred:0.027341613546013832, decouple_loss:0.00983414612710476
The generated pressure mean: 0.44287440180778503
loss_pred:0.02643822506070137, decouple_loss:0.009330526925623417
Iteration: 1015, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45819494128227234
loss_pred:0.027670349925756454, decouple_loss:0.010166685096919537
The generated pressure mean: 0.46301668882369995
loss_pred:0.027044842019677162, decouple_loss:0.01028261985629797
The generated pressure mean: 0.4552064538002014
loss_pred:0.02860213816165924, decouple_loss:0.011067654937505722
Iteration: 1016, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45179283618927
loss_pred:0.028188223019242287, decouple_loss:0.008314698934555054
The generated pressure mean: 0.4449267089366913
loss_pred:0.027481650933623314, decouple_loss:0.00874029379338026
The generated pressure mean: 0.4543464183807373
loss_pred:0.026456277817487717, decouple_loss:0.00870017521083355
Iteration: 1017, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4340271055698395
loss_pred:0.026555268093943596, decouple_loss:0.009696460328996181
The generated pressure mean: 0.43425747752189636
loss_pred:0.027768263593316078, decouple_loss:0.010126330889761448
The generated pressure mean: 0.44088390469551086
loss_pred:0.02787838689982891, decouple_loss:0.010157558135688305
Iteration: 1018, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4436308741569519
loss_pred:0.029026253148913383, decouple_loss:0.009183051064610481
The generated pressure mean: 0.4488990008831024
loss_pred:0.027993913739919662, decouple_loss:0.00922120176255703
The generated pressure mean: 0.445235013961792
loss_pred:0.027676640078425407, decouple_loss:0.009093701839447021
Iteration: 1019, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4401228129863739
loss_pred:0.025744199752807617, decouple_loss:0.009576437994837761
The generated pressure mean: 0.4362983703613281
loss_pred:0.02818247117102146, decouple_loss:0.010037039406597614
The generated pressure mean: 0.4410790205001831
loss_pred:0.027834024280309677, decouple_loss:0.009649485349655151
Iteration: 1020, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.456442266702652
loss_pred:0.028871309012174606, decouple_loss:0.009176524356007576
The generated pressure mean: 0.45905759930610657
loss_pred:0.028388844802975655, decouple_loss:0.009839099831879139
The generated pressure mean: 0.45757487416267395
loss_pred:0.0266810804605484, decouple_loss:0.009081254713237286
2023-04-16 05:19:59 testing...
The generated pressure mean: 0.4208415448665619
loss_pred:0.0398288331925869, decouple_loss:0.010288354940712452
The generated pressure mean: 0.43177440762519836
loss_pred:0.03864565119147301, decouple_loss:0.010430566035211086
The generated pressure mean: 0.43692299723625183
loss_pred:0.03942979499697685, decouple_loss:0.010754246264696121
Loss: 0.039825983345508575, avg_mse: 0.053242914378643036
current test mse: 0.053243
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012019_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012019_3_24hr.npz
NaN value num: 0
Iteration: 1021, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.450765460729599
loss_pred:0.02725234255194664, decouple_loss:0.010071936994791031
The generated pressure mean: 0.45150867104530334
loss_pred:0.027936939150094986, decouple_loss:0.009673146530985832
The generated pressure mean: 0.4492810368537903
loss_pred:0.02894197776913643, decouple_loss:0.009659137576818466
Iteration: 1022, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4410560727119446
loss_pred:0.027677325531840324, decouple_loss:0.009617326781153679
The generated pressure mean: 0.4387276768684387
loss_pred:0.02780274860560894, decouple_loss:0.009939243085682392
The generated pressure mean: 0.4410781264305115
loss_pred:0.026995878666639328, decouple_loss:0.010274448432028294
Iteration: 1023, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4518071711063385
loss_pred:0.027175819501280785, decouple_loss:0.010570741258561611
The generated pressure mean: 0.4532248377799988
loss_pred:0.02773602306842804, decouple_loss:0.010599851608276367
The generated pressure mean: 0.4509957432746887
loss_pred:0.026971016079187393, decouple_loss:0.010276924818754196
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1024, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4434105455875397
loss_pred:0.02751840092241764, decouple_loss:0.009859824553132057
The generated pressure mean: 0.4445907473564148
loss_pred:0.026941338554024696, decouple_loss:0.009712650440633297
The generated pressure mean: 0.4435594975948334
loss_pred:0.02751862443983555, decouple_loss:0.010251977480947971
Iteration: 1025, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4433710277080536
The generated pressure mean: 0.44735077023506165
loss_pred:0.027845749631524086, decouple_loss:0.009192953817546368
loss_pred:0.02777933143079281, decouple_loss:0.009044773876667023
The generated pressure mean: 0.44771450757980347
loss_pred:0.02928692288696766, decouple_loss:0.009136145003139973
Iteration: 1026, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4488949775695801
loss_pred:0.02710239589214325, decouple_loss:0.0106292013078928
The generated pressure mean: 0.4510772228240967
loss_pred:0.027620723471045494, decouple_loss:0.010079092346131802
The generated pressure mean: 0.45405271649360657
loss_pred:0.027238870039582253, decouple_loss:0.009868709370493889
Iteration: 1027, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46036627888679504
loss_pred:0.02844107523560524, decouple_loss:0.008833406493067741
The generated pressure mean: 0.4573628604412079
loss_pred:0.028060156852006912, decouple_loss:0.009259866550564766
The generated pressure mean: 0.4567334055900574
loss_pred:0.028333060443401337, decouple_loss:0.009260277263820171
Iteration: 1028, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4358087480068207
loss_pred:0.027729932218790054, decouple_loss:0.007340327836573124
The generated pressure mean: 0.43747779726982117
loss_pred:0.029825272038578987, decouple_loss:0.008480709046125412
The generated pressure mean: 0.431744784116745
loss_pred:0.028144756332039833, decouple_loss:0.007494757417589426
Iteration: 1029, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4360312223434448
loss_pred:0.02838398702442646, decouple_loss:0.010052751749753952
The generated pressure mean: 0.4384843111038208
loss_pred:0.02785644680261612, decouple_loss:0.009845470078289509
The generated pressure mean: 0.436312198638916
loss_pred:0.029174666851758957, decouple_loss:0.009783083572983742
Iteration: 1030, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46228495240211487
loss_pred:0.028255846351385117, decouple_loss:0.008296212181448936
The generated pressure mean: 0.46203556656837463
loss_pred:0.026671959087252617, decouple_loss:0.00850749108940363
The generated pressure mean: 0.4636007845401764
loss_pred:0.02862948551774025, decouple_loss:0.008343559689819813
2023-04-16 05:22:40 testing...
The generated pressure mean: 0.4163993000984192
loss_pred:0.03904353827238083, decouple_loss:0.011202456429600716
The generated pressure mean: 0.4253931939601898
loss_pred:0.0377340093255043, decouple_loss:0.011573964729905128
The generated pressure mean: 0.4289228618144989
loss_pred:0.0380534902215004, decouple_loss:0.011757869273424149
Loss: 0.03885258361697197, avg_mse: 0.05069812014698982
current test mse: 0.050698
Iteration: 1031, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4601752758026123
loss_pred:0.02858695015311241, decouple_loss:0.011599374003708363
The generated pressure mean: 0.46305474638938904
loss_pred:0.028755784034729004, decouple_loss:0.011248569004237652
The generated pressure mean: 0.4615556299686432
loss_pred:0.026772944256663322, decouple_loss:0.010518818162381649
Iteration: 1032, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43124082684516907
loss_pred:0.028051435947418213, decouple_loss:0.00887973140925169
The generated pressure mean: 0.4293704926967621
loss_pred:0.0278584323823452, decouple_loss:0.008809264749288559
The generated pressure mean: 0.4319973289966583
loss_pred:0.027744024991989136, decouple_loss:0.008732483722269535
Iteration: 1033, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44489243626594543
loss_pred:0.02897251397371292, decouple_loss:0.0114832678809762
The generated pressure mean: 0.4447477161884308
loss_pred:0.027627114206552505, decouple_loss:0.011007916182279587
The generated pressure mean: 0.4408670961856842
loss_pred:0.027104567736387253, decouple_loss:0.011443606577813625
Iteration: 1034, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45234236121177673
loss_pred:0.027720632031559944, decouple_loss:0.010561283677816391
The generated pressure mean: 0.4476234018802643
loss_pred:0.028452105820178986, decouple_loss:0.010408087633550167
The generated pressure mean: 0.4473109841346741
loss_pred:0.02785377949476242, decouple_loss:0.010624096728861332
Iteration: 1035, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.451656699180603
loss_pred:0.02805977687239647, decouple_loss:0.010000442154705524
The generated pressure mean: 0.45513448119163513
loss_pred:0.02886604331433773, decouple_loss:0.009464053437113762
The generated pressure mean: 0.45477476716041565
loss_pred:0.02822927013039589, decouple_loss:0.009400657378137112
Iteration: 1036, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45124971866607666
loss_pred:0.029455892741680145, decouple_loss:0.010532359592616558
The generated pressure mean: 0.4533045291900635
loss_pred:0.027378687635064125, decouple_loss:0.011072549037635326
The generated pressure mean: 0.4561096429824829
loss_pred:0.027668358758091927, decouple_loss:0.011058436706662178
Iteration: 1037, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4333820939064026
loss_pred:0.028168590739369392, decouple_loss:0.010995971038937569
The generated pressure mean: 0.433506041765213
loss_pred:0.027900129556655884, decouple_loss:0.01078810729086399
The generated pressure mean: 0.4405568540096283
loss_pred:0.027518918737769127, decouple_loss:0.011348754167556763
Iteration: 1038, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44574296474456787
loss_pred:0.02707577869296074, decouple_loss:0.00847427174448967
The generated pressure mean: 0.44570478796958923
loss_pred:0.02695516124367714, decouple_loss:0.008802610449492931
The generated pressure mean: 0.44424253702163696
loss_pred:0.027464769780635834, decouple_loss:0.00859134178608656
Iteration: 1039, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4553593099117279
loss_pred:0.028689399361610413, decouple_loss:0.009718368761241436
The generated pressure mean: 0.46042320132255554
loss_pred:0.026970062404870987, decouple_loss:0.009712385945022106
The generated pressure mean: 0.46041783690452576
loss_pred:0.027505122125148773, decouple_loss:0.010535436682403088
Iteration: 1040, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45271363854408264
loss_pred:0.027391497045755386, decouple_loss:0.009914303198456764
The generated pressure mean: 0.4542022943496704
loss_pred:0.026895672082901, decouple_loss:0.0096715297549963
The generated pressure mean: 0.45164376497268677
loss_pred:0.027870986610651016, decouple_loss:0.00955037958920002
2023-04-16 05:24:40 testing...
The generated pressure mean: 0.4245218336582184
loss_pred:0.038152020424604416, decouple_loss:0.00929277390241623
The generated pressure mean: 0.4347931146621704
loss_pred:0.03787204250693321, decouple_loss:0.009488901123404503
The generated pressure mean: 0.44019582867622375
loss_pred:0.03728378191590309, decouple_loss:0.009734378196299076
Loss: 0.03824455291032791, avg_mse: 0.05060311406850815
current test mse: 0.050603
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012011_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012011_3_24hr.npz
NaN value num: 0
Iteration: 1041, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4309864342212677
loss_pred:0.027647249400615692, decouple_loss:0.008477415889501572
The generated pressure mean: 0.4275857210159302
loss_pred:0.027559194713830948, decouple_loss:0.008482301607728004
The generated pressure mean: 0.4300079047679901
loss_pred:0.02758493833243847, decouple_loss:0.00861439760774374
Iteration: 1042, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45035141706466675
loss_pred:0.027666980400681496, decouple_loss:0.010825956240296364
The generated pressure mean: 0.4482288658618927
loss_pred:0.02637883648276329, decouple_loss:0.01110130175948143
The generated pressure mean: 0.45080727338790894
loss_pred:0.029324756935238838, decouple_loss:0.011074750684201717
Iteration: 1043, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4529862105846405
loss_pred:0.027919715270400047, decouple_loss:0.00871636439114809
The generated pressure mean: 0.44980481266975403
loss_pred:0.02753940224647522, decouple_loss:0.00880658533424139
The generated pressure mean: 0.4487234652042389
loss_pred:0.026893476024270058, decouple_loss:0.008796434849500656
Iteration: 1044, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44858527183532715
loss_pred:0.027981918305158615, decouple_loss:0.010345113463699818
The generated pressure mean: 0.4433823525905609
loss_pred:0.027876555919647217, decouple_loss:0.01030548196285963
The generated pressure mean: 0.4434281289577484
loss_pred:0.027485636994242668, decouple_loss:0.010525654070079327
Iteration: 1045, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44656720757484436
loss_pred:0.026593994349241257, decouple_loss:0.008598266169428825
The generated pressure mean: 0.45056894421577454
loss_pred:0.02717478573322296, decouple_loss:0.008188060484826565
The generated pressure mean: 0.4460117220878601
loss_pred:0.02737102471292019, decouple_loss:0.008200228214263916
Iteration: 1046, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4397047460079193
loss_pred:0.028078114613890648, decouple_loss:0.00929834321141243
The generated pressure mean: 0.4451662302017212
loss_pred:0.028222549706697464, decouple_loss:0.00911679770797491
The generated pressure mean: 0.4349438548088074
loss_pred:0.026520079001784325, decouple_loss:0.009353375062346458
Iteration: 1047, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4430382549762726
loss_pred:0.026931660249829292, decouple_loss:0.009078830480575562
The generated pressure mean: 0.45214295387268066
loss_pred:0.02741347625851631, decouple_loss:0.00919886864721775
The generated pressure mean: 0.45348626375198364
loss_pred:0.027714895084500313, decouple_loss:0.009195653721690178
Iteration: 1048, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4493522644042969
loss_pred:0.028047913685441017, decouple_loss:0.007971479557454586
The generated pressure mean: 0.448393851518631
loss_pred:0.02896096184849739, decouple_loss:0.007764091715216637
The generated pressure mean: 0.4480994939804077
loss_pred:0.026937931776046753, decouple_loss:0.007906363345682621
Iteration: 1049, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4551660716533661
loss_pred:0.027344627305865288, decouple_loss:0.008835900574922562
The generated pressure mean: 0.4460923969745636
loss_pred:0.02890869230031967, decouple_loss:0.008674824610352516
The generated pressure mean: 0.45168858766555786
loss_pred:0.029099274426698685, decouple_loss:0.008612150326371193
Iteration: 1050, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43512165546417236
loss_pred:0.027141019701957703, decouple_loss:0.008639671839773655
The generated pressure mean: 0.4338855445384979
loss_pred:0.027378886938095093, decouple_loss:0.008558632805943489
The generated pressure mean: 0.43801411986351013
loss_pred:0.027601715177297592, decouple_loss:0.008802182972431183
2023-04-16 05:27:14 testing...
The generated pressure mean: 0.42172449827194214
loss_pred:0.03809959813952446, decouple_loss:0.010917861014604568
The generated pressure mean: 0.43110761046409607
loss_pred:0.03739434480667114, decouple_loss:0.01076983381062746
The generated pressure mean: 0.4365212321281433
loss_pred:0.03709562122821808, decouple_loss:0.011034244671463966
Loss: 0.038075223565101624, avg_mse: 0.05004776269197464
current test mse: 0.050048
Iteration: 1051, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4540676474571228
The generated pressure mean: 0.44407153129577637
loss_pred:0.027555223554372787, decouple_loss:0.00977468490600586
loss_pred:0.027787964791059494, decouple_loss:0.00995559524744749
The generated pressure mean: 0.450851172208786
loss_pred:0.02653634548187256, decouple_loss:0.009821814484894276
Iteration: 1052, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4453979730606079
loss_pred:0.027611039578914642, decouple_loss:0.009907293133437634
The generated pressure mean: 0.44912368059158325
loss_pred:0.03047877922654152, decouple_loss:0.009709821082651615
The generated pressure mean: 0.44983312487602234
loss_pred:0.02739185281097889, decouple_loss:0.009890572167932987
Iteration: 1053, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4395519196987152
loss_pred:0.02688462659716606, decouple_loss:0.011182409711182117
The generated pressure mean: 0.44275596737861633
loss_pred:0.028418822214007378, decouple_loss:0.011354450136423111
The generated pressure mean: 0.43580153584480286
loss_pred:0.02695597894489765, decouple_loss:0.01185790915042162
Iteration: 1054, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43634095788002014
loss_pred:0.028098439797759056, decouple_loss:0.008231771178543568
The generated pressure mean: 0.44478657841682434
loss_pred:0.027475839480757713, decouple_loss:0.0077558523043990135
The generated pressure mean: 0.44286826252937317
loss_pred:0.028345752507448196, decouple_loss:0.00809865165501833
Iteration: 1055, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45734208822250366
loss_pred:0.027809998020529747, decouple_loss:0.009418750181794167
The generated pressure mean: 0.4563111364841461
loss_pred:0.026970161125063896, decouple_loss:0.009448375552892685
The generated pressure mean: 0.45903050899505615
loss_pred:0.028387373313307762, decouple_loss:0.009300747886300087
Iteration: 1056, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45722922682762146
loss_pred:0.026234470307826996, decouple_loss:0.008790350519120693
The generated pressure mean: 0.4588265120983124
loss_pred:0.02749624289572239, decouple_loss:0.008775757625699043
The generated pressure mean: 0.4528651833534241
loss_pred:0.027064286172389984, decouple_loss:0.008671318180859089
Iteration: 1057, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4346142113208771
loss_pred:0.02658727392554283, decouple_loss:0.008367381058633327
The generated pressure mean: 0.4318335950374603
loss_pred:0.02730969525873661, decouple_loss:0.008863601833581924
The generated pressure mean: 0.4281688332557678
loss_pred:0.027449045330286026, decouple_loss:0.009096683003008366
Iteration: 1058, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43857407569885254
loss_pred:0.027109645307064056, decouple_loss:0.00907227210700512
The generated pressure mean: 0.43770620226860046
loss_pred:0.027012977749109268, decouple_loss:0.009527807123959064
The generated pressure mean: 0.4406311810016632
loss_pred:0.026292983442544937, decouple_loss:0.009227613918483257
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1059, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45586568117141724
loss_pred:0.02670411765575409, decouple_loss:0.008695420809090137
The generated pressure mean: 0.4525386393070221
loss_pred:0.02634125016629696, decouple_loss:0.008751468732953072
The generated pressure mean: 0.46022891998291016
loss_pred:0.028532404452562332, decouple_loss:0.00826912373304367
Iteration: 1060, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4471917450428009
loss_pred:0.026776840910315514, decouple_loss:0.010059607215225697
The generated pressure mean: 0.45371848344802856
loss_pred:0.026299752295017242, decouple_loss:0.009852726943790913
The generated pressure mean: 0.45038285851478577
loss_pred:0.027503279969096184, decouple_loss:0.00971828680485487
2023-04-16 05:29:15 testing...
The generated pressure mean: 0.4207024872303009
loss_pred:0.038973547518253326, decouple_loss:0.009320048615336418
The generated pressure mean: 0.4300840497016907
loss_pred:0.03849992901086807, decouple_loss:0.009376438334584236
The generated pressure mean: 0.43461504578590393
loss_pred:0.038593802601099014, decouple_loss:0.009814877063035965
Loss: 0.039164282381534576, avg_mse: 0.051949840039014816
current test mse: 0.05195
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012000_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012000_3_24hr.npz
NaN value num: 0
Iteration: 1061, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4436008632183075
loss_pred:0.026073144748806953, decouple_loss:0.009217260405421257
The generated pressure mean: 0.4406684339046478
loss_pred:0.02588723786175251, decouple_loss:0.008585291914641857
The generated pressure mean: 0.4418853521347046
loss_pred:0.028223097324371338, decouple_loss:0.009191062301397324
Iteration: 1062, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4434524178504944
loss_pred:0.02687574177980423, decouple_loss:0.01077981386333704
The generated pressure mean: 0.4472639262676239
loss_pred:0.025475328788161278, decouple_loss:0.010977279394865036
The generated pressure mean: 0.45013678073883057
loss_pred:0.026725037023425102, decouple_loss:0.010937449522316456
Iteration: 1063, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4489671289920807
loss_pred:0.029643530026078224, decouple_loss:0.00938665121793747
The generated pressure mean: 0.4526159465312958
loss_pred:0.0254440288990736, decouple_loss:0.008794584311544895
The generated pressure mean: 0.4503198266029358
loss_pred:0.026712987571954727, decouple_loss:0.00906395260244608
Iteration: 1064, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43952909111976624
loss_pred:0.025802357122302055, decouple_loss:0.010847552679479122
The generated pressure mean: 0.44351890683174133
loss_pred:0.025711949914693832, decouple_loss:0.010723017156124115
The generated pressure mean: 0.4405774772167206
loss_pred:0.028650527819991112, decouple_loss:0.010784278623759747
Iteration: 1065, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4473816454410553
loss_pred:0.026335664093494415, decouple_loss:0.009240447543561459
The generated pressure mean: 0.4511585831642151
loss_pred:0.028494488447904587, decouple_loss:0.00923130102455616
The generated pressure mean: 0.44584131240844727
loss_pred:0.026289822533726692, decouple_loss:0.009522894397377968
Iteration: 1066, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4480801820755005
loss_pred:0.026460876688361168, decouple_loss:0.011116362176835537
The generated pressure mean: 0.45885902643203735
loss_pred:0.02622280642390251, decouple_loss:0.011192708276212215
The generated pressure mean: 0.45476484298706055
loss_pred:0.02589709684252739, decouple_loss:0.010319207794964314
Iteration: 1067, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44735175371170044
loss_pred:0.026906311511993408, decouple_loss:0.010172396898269653
The generated pressure mean: 0.4493742883205414
loss_pred:0.026030875742435455, decouple_loss:0.010309111326932907
The generated pressure mean: 0.4428181052207947
loss_pred:0.02671080268919468, decouple_loss:0.010189640335738659
Iteration: 1068, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4358779489994049
loss_pred:0.025435226038098335, decouple_loss:0.009471585042774677
The generated pressure mean: 0.4375985264778137
loss_pred:0.02511744387447834, decouple_loss:0.009771396405994892
The generated pressure mean: 0.43098533153533936
loss_pred:0.025517597794532776, decouple_loss:0.010049418546259403
Iteration: 1069, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4461486339569092
loss_pred:0.026873331516981125, decouple_loss:0.00992946233600378
The generated pressure mean: 0.44605785608291626
loss_pred:0.026365047320723534, decouple_loss:0.009882749989628792
The generated pressure mean: 0.44114917516708374
loss_pred:0.027302611619234085, decouple_loss:0.010568640194833279
Iteration: 1070, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4631997048854828
loss_pred:0.02633286640048027, decouple_loss:0.009704122319817543
The generated pressure mean: 0.46146607398986816
loss_pred:0.02667159028351307, decouple_loss:0.009344839490950108
The generated pressure mean: 0.4591791033744812
loss_pred:0.026127638295292854, decouple_loss:0.008768933825194836
2023-04-16 05:31:51 testing...
The generated pressure mean: 0.419694721698761
loss_pred:0.03812924399971962, decouple_loss:0.009756922721862793
The generated pressure mean: 0.427381306886673
loss_pred:0.03755166381597519, decouple_loss:0.00970625039190054
The generated pressure mean: 0.4328586757183075
loss_pred:0.03789777308702469, decouple_loss:0.010090362280607224
Loss: 0.0383521169424057, avg_mse: 0.049902670085430145
current test mse: 0.049903
Iteration: 1071, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44407030940055847
loss_pred:0.027329588308930397, decouple_loss:0.008902132511138916
The generated pressure mean: 0.4515090882778168The generated pressure mean: 0.44605544209480286
loss_pred:0.026278438046574593, decouple_loss:0.00915724877268076
loss_pred:0.02665366604924202, decouple_loss:0.00880752969533205
Iteration: 1072, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43151596188545227
loss_pred:0.025290146470069885, decouple_loss:0.008660642430186272
The generated pressure mean: 0.4334816038608551
loss_pred:0.025910204276442528, decouple_loss:0.0085066519677639
The generated pressure mean: 0.4373590648174286
loss_pred:0.02628685161471367, decouple_loss:0.00855203066021204
Iteration: 1073, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4470198154449463
loss_pred:0.02685505524277687, decouple_loss:0.010025066323578358
The generated pressure mean: 0.4534105062484741
loss_pred:0.025848058983683586, decouple_loss:0.009083923883736134
The generated pressure mean: 0.4487820565700531
loss_pred:0.026074113324284554, decouple_loss:0.008782681077718735
Iteration: 1074, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4601469039916992
loss_pred:0.026244137436151505, decouple_loss:0.008530187420547009
The generated pressure mean: 0.45221003890037537
loss_pred:0.02699136734008789, decouple_loss:0.00836084596812725
The generated pressure mean: 0.45411136746406555
loss_pred:0.025862321257591248, decouple_loss:0.008182237856090069
Iteration: 1075, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44832175970077515
loss_pred:0.02776413783431053, decouple_loss:0.007638384588062763
The generated pressure mean: 0.4550284147262573
loss_pred:0.02632267028093338, decouple_loss:0.008087308146059513
The generated pressure mean: 0.4513034224510193
loss_pred:0.02802901528775692, decouple_loss:0.00751402648165822
Iteration: 1076, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4410763084888458
loss_pred:0.025828149169683456, decouple_loss:0.007533017545938492
The generated pressure mean: 0.43567171692848206
loss_pred:0.027058767154812813, decouple_loss:0.007177737075835466
The generated pressure mean: 0.4400956928730011
loss_pred:0.026317106559872627, decouple_loss:0.0073579526506364346
Iteration: 1077, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4466768503189087
loss_pred:0.026222024112939835, decouple_loss:0.007569159381091595
The generated pressure mean: 0.4432564377784729
loss_pred:0.025560833513736725, decouple_loss:0.007633584551513195
The generated pressure mean: 0.4424627125263214
loss_pred:0.02699708379805088, decouple_loss:0.007229467388242483
Iteration: 1078, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45247963070869446
loss_pred:0.02529299259185791, decouple_loss:0.007071001920849085
The generated pressure mean: 0.4498141407966614
loss_pred:0.026756759732961655, decouple_loss:0.006854764651507139
The generated pressure mean: 0.4485344886779785
loss_pred:0.027401132509112358, decouple_loss:0.007000580430030823
Iteration: 1079, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4459346532821655
loss_pred:0.026702746748924255, decouple_loss:0.008018352091312408
The generated pressure mean: 0.4458985924720764
loss_pred:0.026422010734677315, decouple_loss:0.007762357126921415
The generated pressure mean: 0.4375586211681366
loss_pred:0.026751797646284103, decouple_loss:0.008193626068532467
Iteration: 1080, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4490169584751129
loss_pred:0.027256743982434273, decouple_loss:0.009363001212477684
The generated pressure mean: 0.4576357305049896
loss_pred:0.028234878554940224, decouple_loss:0.009265096858143806
The generated pressure mean: 0.44980883598327637
loss_pred:0.026799313724040985, decouple_loss:0.00923194084316492
2023-04-16 05:33:52 testing...
The generated pressure mean: 0.42121177911758423
loss_pred:0.04025927186012268, decouple_loss:0.013184888288378716
The generated pressure mean: 0.43056562542915344
loss_pred:0.0389331690967083, decouple_loss:0.013583322055637836
The generated pressure mean: 0.4370371103286743
loss_pred:0.03903285786509514, decouple_loss:0.013768124394118786
Loss: 0.04008404165506363, avg_mse: 0.05284511670470238
current test mse: 0.052845
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012018_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012018_3_24hr.npz
NaN value num: 0
Iteration: 1081, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4433881342411041
loss_pred:0.027340419590473175, decouple_loss:0.011712292209267616
The generated pressure mean: 0.44998177886009216
loss_pred:0.027281777933239937, decouple_loss:0.010828450322151184
The generated pressure mean: 0.4473324716091156
loss_pred:0.027260830625891685, decouple_loss:0.011056723073124886
Iteration: 1082, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4504828453063965
loss_pred:0.030707599595189095, decouple_loss:0.009047827683389187
The generated pressure mean: 0.44727393984794617
loss_pred:0.025839172303676605, decouple_loss:0.00952172465622425
The generated pressure mean: 0.45413151383399963
loss_pred:0.028698571026325226, decouple_loss:0.009404871612787247
Iteration: 1083, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4441756308078766
loss_pred:0.029699191451072693, decouple_loss:0.00922591332346201
The generated pressure mean: 0.44650202989578247
loss_pred:0.027998249977827072, decouple_loss:0.008987830020487309
The generated pressure mean: 0.4435841143131256
loss_pred:0.028298236429691315, decouple_loss:0.009156842716038227
Iteration: 1084, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4467298984527588
loss_pred:0.027977291494607925, decouple_loss:0.009225990623235703
The generated pressure mean: 0.441771924495697
loss_pred:0.026668135076761246, decouple_loss:0.009651733562350273
The generated pressure mean: 0.4473116993904114
loss_pred:0.02774699218571186, decouple_loss:0.00925313401967287
Iteration: 1085, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4489288926124573
loss_pred:0.02804548665881157, decouple_loss:0.01066556852310896
The generated pressure mean: 0.4533991813659668
loss_pred:0.02896999754011631, decouple_loss:0.010302605107426643
The generated pressure mean: 0.4493199288845062
loss_pred:0.027957584708929062, decouple_loss:0.010136355645954609
Iteration: 1086, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.453291654586792
loss_pred:0.02769285812973976, decouple_loss:0.009354082867503166
The generated pressure mean: 0.45488888025283813
loss_pred:0.028090232983231544, decouple_loss:0.009382049553096294
The generated pressure mean: 0.45565736293792725
loss_pred:0.028208961710333824, decouple_loss:0.009237918071448803
Iteration: 1087, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44672948122024536
loss_pred:0.027100274339318275, decouple_loss:0.009984131902456284
The generated pressure mean: 0.44147390127182007
loss_pred:0.027172988280653954, decouple_loss:0.010039174929261208
The generated pressure mean: 0.4474330246448517
loss_pred:0.0281574297696352, decouple_loss:0.010202012024819851
Iteration: 1088, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44331902265548706
loss_pred:0.026870818808674812, decouple_loss:0.010206452570855618
The generated pressure mean: 0.44368577003479004
loss_pred:0.028789527714252472, decouple_loss:0.010377409867942333
The generated pressure mean: 0.4450353980064392
loss_pred:0.02827332727611065, decouple_loss:0.010308596305549145
Iteration: 1089, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44094720482826233
loss_pred:0.028902417048811913, decouple_loss:0.009854819625616074
The generated pressure mean: 0.4458194673061371
loss_pred:0.027633845806121826, decouple_loss:0.010050586424767971
The generated pressure mean: 0.44586047530174255
loss_pred:0.02725972793996334, decouple_loss:0.009641574695706367
Iteration: 1090, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45377790927886963
The generated pressure mean: 0.45154085755348206
loss_pred:0.028372924774885178, decouple_loss:0.008908234536647797
loss_pred:0.027929306030273438, decouple_loss:0.008601861074566841
The generated pressure mean: 0.4513894319534302
loss_pred:0.027990804985165596, decouple_loss:0.008576675318181515
2023-04-16 05:36:28 testing...
The generated pressure mean: 0.4188999533653259
loss_pred:0.03989018499851227, decouple_loss:0.009855993092060089
The generated pressure mean: 0.42792949080467224
loss_pred:0.03812956437468529, decouple_loss:0.009986097924411297
The generated pressure mean: 0.4341912567615509
loss_pred:0.03907176852226257, decouple_loss:0.010240267030894756
Loss: 0.039531879127025604, avg_mse: 0.05252579227089882
current test mse: 0.052526
Iteration: 1091, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4521069824695587
loss_pred:0.025935107842087746, decouple_loss:0.008810925297439098
The generated pressure mean: 0.4556427299976349
loss_pred:0.0280880369246006, decouple_loss:0.009322047233581543
The generated pressure mean: 0.45354634523391724
loss_pred:0.027290405705571175, decouple_loss:0.008839747868478298
Iteration: 1092, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4507693350315094
loss_pred:0.026190470904111862, decouple_loss:0.008764316327869892
The generated pressure mean: 0.45273008942604065
loss_pred:0.026231054216623306, decouple_loss:0.008844304829835892
The generated pressure mean: 0.4488113224506378
loss_pred:0.029265088960528374, decouple_loss:0.008972248993813992
Iteration: 1093, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4468514621257782
loss_pred:0.027565840631723404, decouple_loss:0.0075336783193051815
The generated pressure mean: 0.4403770864009857
loss_pred:0.027516290545463562, decouple_loss:0.0073851621709764
The generated pressure mean: 0.4458273947238922
loss_pred:0.02786567434668541, decouple_loss:0.007538359146565199
Iteration: 1094, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4376814365386963
loss_pred:0.027087682858109474, decouple_loss:0.009617314673960209
The generated pressure mean: 0.444255530834198
loss_pred:0.02718777395784855, decouple_loss:0.009697435423731804
The generated pressure mean: 0.4429646134376526
loss_pred:0.02671322040259838, decouple_loss:0.009666888043284416
Iteration: 1095, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44540953636169434
loss_pred:0.028389843180775642, decouple_loss:0.008251269347965717
The generated pressure mean: 0.446052610874176
loss_pred:0.028931178152561188, decouple_loss:0.008863844908773899
The generated pressure mean: 0.4462839961051941
loss_pred:0.028776954859495163, decouple_loss:0.007749570067971945
Iteration: 1096, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4547384977340698
loss_pred:0.028168901801109314, decouple_loss:0.010545359924435616
The generated pressure mean: 0.4516409933567047
loss_pred:0.027598274871706963, decouple_loss:0.010503261350095272
The generated pressure mean: 0.4510379135608673
loss_pred:0.02771315723657608, decouple_loss:0.01090601272881031
Iteration: 1097, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4579996168613434
loss_pred:0.02623366191983223, decouple_loss:0.009415793232619762
The generated pressure mean: 0.4587749242782593
loss_pred:0.028167342767119408, decouple_loss:0.009347856044769287
The generated pressure mean: 0.45748016238212585
loss_pred:0.026983162388205528, decouple_loss:0.009380331262946129
Iteration: 1098, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45048555731773376
loss_pred:0.028429651632905006, decouple_loss:0.008013302460312843
The generated pressure mean: 0.4552255868911743
loss_pred:0.029370903968811035, decouple_loss:0.008357904851436615
The generated pressure mean: 0.4533669948577881
loss_pred:0.02763209119439125, decouple_loss:0.007957774214446545
Iteration: 1099, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43359994888305664
The generated pressure mean: 0.44146353006362915
loss_pred:0.02568248100578785, decouple_loss:0.009996761567890644
loss_pred:0.028996719047427177, decouple_loss:0.010144977830350399
The generated pressure mean: 0.4350527822971344
loss_pred:0.027883457019925117, decouple_loss:0.009936767630279064
Iteration: 1100, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4346311092376709
loss_pred:0.027288096025586128, decouple_loss:0.008429251611232758
The generated pressure mean: 0.4356977045536041
loss_pred:0.02754291519522667, decouple_loss:0.008070175535976887
The generated pressure mean: 0.43466314673423767
loss_pred:0.0273726899176836, decouple_loss:0.008408451452851295
2023-04-16 05:38:29 testing...
The generated pressure mean: 0.41604894399642944
loss_pred:0.041667189449071884, decouple_loss:0.010637227445840836
The generated pressure mean: 0.42378947138786316
loss_pred:0.039655085653066635, decouple_loss:0.010697922669351101
The generated pressure mean: 0.42904528975486755
loss_pred:0.04080365225672722, decouple_loss:0.011163312941789627
Loss: 0.041250284761190414, avg_mse: 0.05572691559791565
current test mse: 0.055727
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012001_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012001_3_24hr.npz
NaN value num: 0
Iteration: 1101, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4603327512741089
loss_pred:0.025907954201102257, decouple_loss:0.009468979202210903
The generated pressure mean: 0.4600013196468353
loss_pred:0.02667374536395073, decouple_loss:0.009817942045629025
The generated pressure mean: 0.4595378041267395
loss_pred:0.02703695558011532, decouple_loss:0.009951873682439327
Iteration: 1102, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4663618206977844
loss_pred:0.027308251708745956, decouple_loss:0.009337185882031918
The generated pressure mean: 0.4596913456916809
loss_pred:0.027587033808231354, decouple_loss:0.0093417689204216
The generated pressure mean: 0.45964545011520386
loss_pred:0.02698342688381672, decouple_loss:0.00962574128061533
Iteration: 1103, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43592512607574463
loss_pred:0.02593853324651718, decouple_loss:0.008403238840401173
The generated pressure mean: 0.434771329164505
loss_pred:0.026547105982899666, decouple_loss:0.008261682465672493
The generated pressure mean: 0.4324754774570465
loss_pred:0.02702779695391655, decouple_loss:0.008313866332173347
Iteration: 1104, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4259490966796875
loss_pred:0.025924954563379288, decouple_loss:0.009209471754729748
The generated pressure mean: 0.4261966645717621
loss_pred:0.027843279764056206, decouple_loss:0.009313331916928291
The generated pressure mean: 0.42851147055625916
loss_pred:0.026179378852248192, decouple_loss:0.009400084614753723
Iteration: 1105, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4612368047237396
loss_pred:0.027816513553261757, decouple_loss:0.008551682345569134
The generated pressure mean: 0.44562533497810364
loss_pred:0.026497526094317436, decouple_loss:0.008958226069808006
The generated pressure mean: 0.4579552710056305
loss_pred:0.02691398374736309, decouple_loss:0.008171016350388527
Iteration: 1106, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4631645679473877
loss_pred:0.02577306143939495, decouple_loss:0.010511317290365696
The generated pressure mean: 0.46557149291038513
loss_pred:0.026204274967312813, decouple_loss:0.009299385361373425
The generated pressure mean: 0.4572802186012268
loss_pred:0.027681726962327957, decouple_loss:0.01000657957047224
Iteration: 1107, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4438364803791046
loss_pred:0.02689196914434433, decouple_loss:0.008746892213821411
The generated pressure mean: 0.4405752718448639
loss_pred:0.028368685394525528, decouple_loss:0.008382652886211872
The generated pressure mean: 0.44774487614631653
loss_pred:0.025635898113250732, decouple_loss:0.00893791951239109
Iteration: 1108, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4325699508190155
loss_pred:0.026799509301781654, decouple_loss:0.010222638957202435
The generated pressure mean: 0.439275860786438
loss_pred:0.027559079229831696, decouple_loss:0.010454023256897926
The generated pressure mean: 0.43235862255096436
loss_pred:0.028593450784683228, decouple_loss:0.009823986329138279
Iteration: 1109, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4474959075450897
loss_pred:0.027066979557275772, decouple_loss:0.008957024663686752
The generated pressure mean: 0.44891464710235596
loss_pred:0.027093231678009033, decouple_loss:0.00946484412997961
The generated pressure mean: 0.4540534019470215
loss_pred:0.026425547897815704, decouple_loss:0.009328903630375862
Iteration: 1110, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45359495282173157
loss_pred:0.027928950265049934, decouple_loss:0.011991018429398537
The generated pressure mean: 0.44682076573371887
loss_pred:0.026041239500045776, decouple_loss:0.012106595560908318
The generated pressure mean: 0.4500766694545746
loss_pred:0.02664520964026451, decouple_loss:0.013035688549280167
2023-04-16 05:41:06 testing...
The generated pressure mean: 0.4220592677593231
loss_pred:0.03937657177448273, decouple_loss:0.01336588617414236
The generated pressure mean: 0.4299420714378357
loss_pred:0.039407093077898026, decouple_loss:0.01370540913194418
The generated pressure mean: 0.43566858768463135
loss_pred:0.03852168470621109, decouple_loss:0.013784248381853104
Loss: 0.03978271037340164, avg_mse: 0.052770551294088364
current test mse: 0.052771
Iteration: 1111, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4377526044845581
loss_pred:0.02660045027732849, decouple_loss:0.012172769755125046
The generated pressure mean: 0.43938183784484863
loss_pred:0.02520895004272461, decouple_loss:0.012097921222448349
The generated pressure mean: 0.44053971767425537
loss_pred:0.026561886072158813, decouple_loss:0.012309348210692406
Iteration: 1112, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4502184987068176
loss_pred:0.02640652284026146, decouple_loss:0.009574346244335175
The generated pressure mean: 0.44558078050613403The generated pressure mean: 0.45164820551872253
loss_pred:0.02659410983324051, decouple_loss:0.010303731076419353
loss_pred:0.027984894812107086, decouple_loss:0.010020706802606583
Iteration: 1113, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44716328382492065
loss_pred:0.026064688339829445, decouple_loss:0.01097925752401352
The generated pressure mean: 0.44865289330482483
loss_pred:0.024866506457328796, decouple_loss:0.010853732004761696
The generated pressure mean: 0.4441315531730652
loss_pred:0.026694001629948616, decouple_loss:0.01056050043553114
Iteration: 1114, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4452045261859894
loss_pred:0.025668058544397354, decouple_loss:0.009376012720167637
The generated pressure mean: 0.44256749749183655
loss_pred:0.025877054780721664, decouple_loss:0.009035997092723846
The generated pressure mean: 0.4477204978466034
loss_pred:0.02674173191189766, decouple_loss:0.009616632014513016
Iteration: 1115, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4438604712486267
loss_pred:0.025986582040786743, decouple_loss:0.00855174195021391
The generated pressure mean: 0.44794008135795593
loss_pred:0.027633171528577805, decouple_loss:0.008260838687419891
The generated pressure mean: 0.44376978278160095
loss_pred:0.02650909312069416, decouple_loss:0.00881118979305029
Iteration: 1116, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44855985045433044
loss_pred:0.025943437591195107, decouple_loss:0.009844549000263214
The generated pressure mean: 0.445760041475296
loss_pred:0.026485778391361237, decouple_loss:0.009871644899249077
The generated pressure mean: 0.4446658492088318
loss_pred:0.026783879846334457, decouple_loss:0.00995717104524374
Iteration: 1117, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45144668221473694
loss_pred:0.026136428117752075, decouple_loss:0.009379983879625797
The generated pressure mean: 0.4498249292373657
loss_pred:0.026939671486616135, decouple_loss:0.009272178635001183
The generated pressure mean: 0.43887028098106384
loss_pred:0.02606733702123165, decouple_loss:0.009431447833776474
Iteration: 1118, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45375099778175354
loss_pred:0.026033569127321243, decouple_loss:0.008506369777023792
The generated pressure mean: 0.45536109805107117
loss_pred:0.02619035914540291, decouple_loss:0.009301883168518543
The generated pressure mean: 0.4526165723800659
loss_pred:0.027377985417842865, decouple_loss:0.008685106411576271
Iteration: 1119, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4389174282550812
loss_pred:0.026136066764593124, decouple_loss:0.008852748200297356
The generated pressure mean: 0.43175435066223145
loss_pred:0.027427537366747856, decouple_loss:0.009101820178329945
The generated pressure mean: 0.4298849403858185
loss_pred:0.027000239118933678, decouple_loss:0.00835744384676218
Iteration: 1120, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4367697834968567
loss_pred:0.02774108573794365, decouple_loss:0.009888668544590473
The generated pressure mean: 0.44819626212120056
loss_pred:0.02745942585170269, decouple_loss:0.009638583287596703
The generated pressure mean: 0.43778911232948303
loss_pred:0.025153018534183502, decouple_loss:0.009908168576657772
2023-04-16 05:43:07 testing...
The generated pressure mean: 0.415771484375
loss_pred:0.039754718542099, decouple_loss:0.008209934458136559
The generated pressure mean: 0.42602622509002686
loss_pred:0.03746572136878967, decouple_loss:0.008328437805175781
The generated pressure mean: 0.43050915002822876
loss_pred:0.038075365126132965, decouple_loss:0.008709528483450413
Loss: 0.03885273635387421, avg_mse: 0.051925744861364365
current test mse: 0.051926
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012010_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012010_3_24hr.npz
NaN value num: 0
Iteration: 1121, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4612988233566284
loss_pred:0.02566741220653057, decouple_loss:0.007009454071521759
The generated pressure mean: 0.46245601773262024
loss_pred:0.026525363326072693, decouple_loss:0.0072431848384439945
The generated pressure mean: 0.45723578333854675
loss_pred:0.026146959513425827, decouple_loss:0.007293235510587692
Iteration: 1122, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4505826532840729
loss_pred:0.025486161932349205, decouple_loss:0.008442070335149765
The generated pressure mean: 0.46301066875457764
loss_pred:0.026237742975354195, decouple_loss:0.008739917539060116
The generated pressure mean: 0.45187634229660034
loss_pred:0.0257567148655653, decouple_loss:0.008408453315496445
Iteration: 1123, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4431021213531494
loss_pred:0.026610875502228737, decouple_loss:0.007895712740719318
The generated pressure mean: 0.44636520743370056
loss_pred:0.02674981765449047, decouple_loss:0.007655153516680002
The generated pressure mean: 0.44084450602531433
loss_pred:0.02631980925798416, decouple_loss:0.007696734741330147
Iteration: 1124, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43408113718032837
loss_pred:0.02674499712884426, decouple_loss:0.008205397054553032
The generated pressure mean: 0.4348265528678894
loss_pred:0.02621619775891304, decouple_loss:0.007569990120828152
The generated pressure mean: 0.4291873574256897
loss_pred:0.02801079861819744, decouple_loss:0.008108370006084442
Iteration: 1125, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45554399490356445
loss_pred:0.025702154263854027, decouple_loss:0.008432353846728802
The generated pressure mean: 0.45365002751350403
loss_pred:0.02594904787838459, decouple_loss:0.008658883161842823
The generated pressure mean: 0.4545203149318695
loss_pred:0.02770984172821045, decouple_loss:0.008550668135285378
Iteration: 1126, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4504234194755554
loss_pred:0.026055501773953438, decouple_loss:0.008092164993286133
The generated pressure mean: 0.44644495844841003
loss_pred:0.02555893547832966, decouple_loss:0.008141966536641121
The generated pressure mean: 0.45259684324264526
loss_pred:0.02535870485007763, decouple_loss:0.007952100597321987
Iteration: 1127, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43810218572616577
loss_pred:0.02635134570300579, decouple_loss:0.0078666927292943
The generated pressure mean: 0.4404953122138977
loss_pred:0.025578968226909637, decouple_loss:0.007727569900453091
The generated pressure mean: 0.4387308955192566
loss_pred:0.02653845027089119, decouple_loss:0.007891302928328514
Iteration: 1128, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44582217931747437
loss_pred:0.02643893100321293, decouple_loss:0.007989556528627872
The generated pressure mean: 0.4535072147846222
loss_pred:0.025355219841003418, decouple_loss:0.008124524727463722
The generated pressure mean: 0.4516386091709137
loss_pred:0.026152240112423897, decouple_loss:0.007565579377114773
Iteration: 1129, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4546394944190979
loss_pred:0.02562435157597065, decouple_loss:0.007378824055194855
The generated pressure mean: 0.45112115144729614
loss_pred:0.025654271245002747, decouple_loss:0.007646636571735144
The generated pressure mean: 0.44709280133247375
loss_pred:0.025991886854171753, decouple_loss:0.007706963457167149
Iteration: 1130, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44837045669555664
loss_pred:0.025271842256188393, decouple_loss:0.008619393222033978
The generated pressure mean: 0.4450889825820923
loss_pred:0.02653474546968937, decouple_loss:0.008688177913427353
The generated pressure mean: 0.44321802258491516
loss_pred:0.026092728599905968, decouple_loss:0.008342703804373741
2023-04-16 05:45:42 testing...
The generated pressure mean: 0.4214024841785431
loss_pred:0.037831153720617294, decouple_loss:0.008001458831131458
The generated pressure mean: 0.43157777190208435
loss_pred:0.03644426912069321, decouple_loss:0.008110363967716694
The generated pressure mean: 0.4363546073436737
loss_pred:0.0371231883764267, decouple_loss:0.008312405087053776
Loss: 0.03753994032740593, avg_mse: 0.05013153702020645
current test mse: 0.050132
Iteration: 1131, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44002988934516907The generated pressure mean: 0.4398396611213684
loss_pred:0.02655639499425888, decouple_loss:0.007141541223973036
loss_pred:0.024302175268530846, decouple_loss:0.007176755927503109
The generated pressure mean: 0.4361630082130432
loss_pred:0.026768552139401436, decouple_loss:0.007500919047743082
Iteration: 1132, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44773969054222107
loss_pred:0.026227161288261414, decouple_loss:0.006799329072237015
The generated pressure mean: 0.4527796804904938
loss_pred:0.02660582773387432, decouple_loss:0.0070183794014155865
The generated pressure mean: 0.44700732827186584
loss_pred:0.02707562781870365, decouple_loss:0.0066783069632947445
Iteration: 1133, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46065184473991394
loss_pred:0.025171374902129173, decouple_loss:0.007136340253055096
The generated pressure mean: 0.45294246077537537
loss_pred:0.02699764259159565, decouple_loss:0.007440436165779829
The generated pressure mean: 0.4591571092605591
loss_pred:0.026026131585240364, decouple_loss:0.007270820904523134
Iteration: 1134, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.444195419549942
loss_pred:0.026193484663963318, decouple_loss:0.007148839998990297
The generated pressure mean: 0.44556739926338196
loss_pred:0.027038808912038803, decouple_loss:0.007298755459487438
The generated pressure mean: 0.4457920491695404
loss_pred:0.024870648980140686, decouple_loss:0.007253284566104412
Iteration: 1135, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43663373589515686
loss_pred:0.024620063602924347, decouple_loss:0.008892795071005821
The generated pressure mean: 0.43490082025527954
loss_pred:0.025833580642938614, decouple_loss:0.009478801861405373
The generated pressure mean: 0.4350301921367645
loss_pred:0.02892928197979927, decouple_loss:0.009272622875869274
Iteration: 1136, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45129379630088806
loss_pred:0.02616417407989502, decouple_loss:0.008533630520105362
The generated pressure mean: 0.45167994499206543
loss_pred:0.02756287157535553, decouple_loss:0.008939126506447792
The generated pressure mean: 0.4492437541484833
loss_pred:0.029106799513101578, decouple_loss:0.009090488776564598
Iteration: 1137, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4561728537082672
loss_pred:0.025784390047192574, decouple_loss:0.006974160671234131The generated pressure mean: 0.45211777091026306
loss_pred:0.0254143625497818, decouple_loss:0.007038705982267857
The generated pressure mean: 0.4542905390262604
loss_pred:0.02532694861292839, decouple_loss:0.0071753147058188915
Iteration: 1138, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4457327127456665
loss_pred:0.02718508616089821, decouple_loss:0.007708021905273199
The generated pressure mean: 0.4399629533290863
loss_pred:0.027076730504631996, decouple_loss:0.007295651827007532
The generated pressure mean: 0.44347503781318665
loss_pred:0.02576020359992981, decouple_loss:0.007388925179839134
Iteration: 1139, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4470263719558716
loss_pred:0.02599993348121643, decouple_loss:0.007822978310286999
The generated pressure mean: 0.4515100121498108
loss_pred:0.02653740718960762, decouple_loss:0.00776832876726985
The generated pressure mean: 0.4484449028968811
loss_pred:0.026754653081297874, decouple_loss:0.008213847875595093
Iteration: 1140, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43805360794067383
The generated pressure mean: 0.44720253348350525
loss_pred:0.026746654883027077, decouple_loss:0.007896468974649906
loss_pred:0.025694597512483597, decouple_loss:0.007480470929294825
The generated pressure mean: 0.436627060174942
loss_pred:0.026924969628453255, decouple_loss:0.007736654952168465
2023-04-16 05:47:42 testing...
The generated pressure mean: 0.4184756875038147
loss_pred:0.03889458253979683, decouple_loss:0.009068316780030727
The generated pressure mean: 0.42740562558174133
loss_pred:0.03754217550158501, decouple_loss:0.00934053584933281
The generated pressure mean: 0.4324651062488556
loss_pred:0.03794948756694794, decouple_loss:0.009683888405561447
Loss: 0.03859696164727211, avg_mse: 0.05202183127403259
current test mse: 0.052022
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012009_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012009_3_24hr.npz
NaN value num: 0
Iteration: 1141, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4481653571128845
loss_pred:0.026715317741036415, decouple_loss:0.008350887335836887
The generated pressure mean: 0.44453340768814087
loss_pred:0.026668066158890724, decouple_loss:0.008344966918230057
The generated pressure mean: 0.4465295970439911
loss_pred:0.026156218722462654, decouple_loss:0.008251750841736794
Iteration: 1142, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45434972643852234
loss_pred:0.026050087064504623, decouple_loss:0.007846391759812832
The generated pressure mean: 0.4593521058559418
loss_pred:0.026016710326075554, decouple_loss:0.008163530379533768
The generated pressure mean: 0.45321977138519287
loss_pred:0.025590993463993073, decouple_loss:0.007955333217978477
Iteration: 1143, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4477236866950989
loss_pred:0.02537236548960209, decouple_loss:0.007927356287837029
The generated pressure mean: 0.45005062222480774
loss_pred:0.027650101110339165, decouple_loss:0.008634825237095356
The generated pressure mean: 0.4528087079524994
loss_pred:0.02599826455116272, decouple_loss:0.007939324714243412
Iteration: 1144, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4429212808609009
loss_pred:0.026544544845819473, decouple_loss:0.008423564955592155
The generated pressure mean: 0.4502774178981781
loss_pred:0.02678852714598179, decouple_loss:0.008595230057835579
The generated pressure mean: 0.44303610920906067
loss_pred:0.026057787239551544, decouple_loss:0.008320765569806099
Iteration: 1145, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4464203417301178
loss_pred:0.02811862900853157, decouple_loss:0.00826739240437746
The generated pressure mean: 0.4381362497806549
loss_pred:0.026282647624611855, decouple_loss:0.007379276677966118
The generated pressure mean: 0.44714945554733276
loss_pred:0.02732864022254944, decouple_loss:0.007844893261790276
Iteration: 1146, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4574994444847107
loss_pred:0.02699231542646885, decouple_loss:0.008947640657424927
The generated pressure mean: 0.4559810161590576
loss_pred:0.026539897546172142, decouple_loss:0.009032103233039379
The generated pressure mean: 0.45747679471969604
loss_pred:0.026877591386437416, decouple_loss:0.008449389599263668
Iteration: 1147, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45124781131744385
loss_pred:0.0262004341930151, decouple_loss:0.008433296345174313
The generated pressure mean: 0.44809702038764954
loss_pred:0.02654077857732773, decouple_loss:0.008273132145404816
The generated pressure mean: 0.44686466455459595
loss_pred:0.02641974575817585, decouple_loss:0.008258787915110588
Iteration: 1148, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4371771812438965
loss_pred:0.027362411841750145, decouple_loss:0.008228495717048645
The generated pressure mean: 0.4408618211746216
loss_pred:0.026531558483839035, decouple_loss:0.007967344485223293
The generated pressure mean: 0.43566834926605225
loss_pred:0.026751523837447166, decouple_loss:0.008131289854645729
Iteration: 1149, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4532800018787384
loss_pred:0.026299143210053444, decouple_loss:0.00808967649936676
The generated pressure mean: 0.45290547609329224
loss_pred:0.02653021551668644, decouple_loss:0.008786685764789581
The generated pressure mean: 0.4476810097694397
loss_pred:0.0263112373650074, decouple_loss:0.008676519617438316
Iteration: 1150, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44078755378723145
loss_pred:0.025212308391928673, decouple_loss:0.008180446922779083
The generated pressure mean: 0.440454363822937
loss_pred:0.027171609923243523, decouple_loss:0.00856525544077158
The generated pressure mean: 0.43922388553619385
loss_pred:0.026827475056052208, decouple_loss:0.00856334064155817
2023-04-16 05:50:17 testing...
The generated pressure mean: 0.41974103450775146
loss_pred:0.03864385932683945, decouple_loss:0.008574179373681545
The generated pressure mean: 0.42987191677093506
loss_pred:0.03740910813212395, decouple_loss:0.008760562166571617
The generated pressure mean: 0.4355791509151459
loss_pred:0.03735743835568428, decouple_loss:0.009036941453814507
Loss: 0.038242995738983154, avg_mse: 0.05095586180686951
current test mse: 0.050956
Iteration: 1151, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44742506742477417
The generated pressure mean: 0.4404481053352356
loss_pred:0.026952622458338737, decouple_loss:0.007307678926736116
loss_pred:0.027134215459227562, decouple_loss:0.0076717594638466835
The generated pressure mean: 0.44723594188690186
loss_pred:0.0265867430716753, decouple_loss:0.007301251869648695
Iteration: 1152, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45926350355148315
loss_pred:0.025299452245235443, decouple_loss:0.008894016034901142
The generated pressure mean: 0.4686893820762634
loss_pred:0.027200935408473015, decouple_loss:0.008853703737258911
The generated pressure mean: 0.47059789299964905
loss_pred:0.025528937578201294, decouple_loss:0.009403500705957413
Iteration: 1153, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4547377824783325
loss_pred:0.025813555344939232, decouple_loss:0.00836724042892456
The generated pressure mean: 0.4548654854297638
loss_pred:0.024894628673791885, decouple_loss:0.008353774435818195
The generated pressure mean: 0.45441362261772156
loss_pred:0.026347771286964417, decouple_loss:0.008760199882090092
Iteration: 1154, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4318932294845581
loss_pred:0.026185132563114166, decouple_loss:0.009188850410282612
The generated pressure mean: 0.42060616612434387
loss_pred:0.026778804138302803, decouple_loss:0.009378306567668915
The generated pressure mean: 0.4175912141799927
loss_pred:0.027048274874687195, decouple_loss:0.009041788056492805
Iteration: 1155, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45044443011283875
loss_pred:0.02848147787153721, decouple_loss:0.008219518698751926
The generated pressure mean: 0.4432334005832672
loss_pred:0.026502490043640137, decouple_loss:0.008136284537613392
The generated pressure mean: 0.44029319286346436
loss_pred:0.027317717671394348, decouple_loss:0.00872635655105114
Iteration: 1156, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4591800570487976
loss_pred:0.026917319744825363, decouple_loss:0.008592461235821247
The generated pressure mean: 0.4566866159439087
loss_pred:0.026270505040884018, decouple_loss:0.008949564769864082
The generated pressure mean: 0.45657965540885925
loss_pred:0.02568719908595085, decouple_loss:0.009102561511099339
Iteration: 1157, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4549471437931061
The generated pressure mean: 0.45700398087501526loss_pred:0.026329340413212776, decouple_loss:0.008834054693579674
loss_pred:0.026662563905119896, decouple_loss:0.009636812843382359
The generated pressure mean: 0.4598672688007355
loss_pred:0.025662966072559357, decouple_loss:0.009322660975158215
Iteration: 1158, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44550853967666626
loss_pred:0.026530826464295387, decouple_loss:0.008852765895426273
The generated pressure mean: 0.4392085075378418
loss_pred:0.025834357365965843, decouple_loss:0.008431232534348965
The generated pressure mean: 0.44465476274490356
loss_pred:0.02600603923201561, decouple_loss:0.008267544209957123
Iteration: 1159, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4459729790687561
The generated pressure mean: 0.4458597004413605loss_pred:0.02679005265235901, decouple_loss:0.010573677718639374
loss_pred:0.025566836819052696, decouple_loss:0.010047940537333488
The generated pressure mean: 0.4503560960292816
loss_pred:0.026159347966313362, decouple_loss:0.01044144295156002
Iteration: 1160, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43760615587234497
loss_pred:0.02624211646616459, decouple_loss:0.009247325360774994
The generated pressure mean: 0.4425463080406189
loss_pred:0.025456491857767105, decouple_loss:0.009072310291230679
The generated pressure mean: 0.44203051924705505
loss_pred:0.025734374299645424, decouple_loss:0.009211597964167595
2023-04-16 05:52:17 testing...
The generated pressure mean: 0.41821882128715515
loss_pred:0.03959783539175987, decouple_loss:0.009495441801846027
The generated pressure mean: 0.4274992346763611
loss_pred:0.03858242928981781, decouple_loss:0.00953806471079588
The generated pressure mean: 0.4318056106567383
loss_pred:0.03944466635584831, decouple_loss:0.009962435811758041
Loss: 0.03969157859683037, avg_mse: 0.05360282585024834
current test mse: 0.053603
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012012_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012012_3_24hr.npz
NaN value num: 0
Iteration: 1161, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4464039206504822
loss_pred:0.026689354330301285, decouple_loss:0.008725335821509361
The generated pressure mean: 0.45417365431785583
loss_pred:0.027101410552859306, decouple_loss:0.0089814942330122
The generated pressure mean: 0.45028412342071533
loss_pred:0.02681158296763897, decouple_loss:0.008784954436123371
Iteration: 1162, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4556656777858734
loss_pred:0.025828303769230843, decouple_loss:0.009046905674040318
The generated pressure mean: 0.4565594792366028
loss_pred:0.02648616023361683, decouple_loss:0.009194470942020416
The generated pressure mean: 0.4561255872249603
loss_pred:0.026798034086823463, decouple_loss:0.008932510390877724
Iteration: 1163, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4387657642364502
loss_pred:0.027426373213529587, decouple_loss:0.0074606104753911495
The generated pressure mean: 0.44505566358566284
loss_pred:0.026569953188300133, decouple_loss:0.007571591529995203
The generated pressure mean: 0.4408305883407593
loss_pred:0.025876469910144806, decouple_loss:0.00806235708296299
Iteration: 1164, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43761321902275085
loss_pred:0.027333293110132217, decouple_loss:0.008550534956157207
The generated pressure mean: 0.44344887137413025
loss_pred:0.027165191248059273, decouple_loss:0.00837878230959177
The generated pressure mean: 0.43262892961502075
loss_pred:0.027005355805158615, decouple_loss:0.008303895592689514
Iteration: 1165, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43951210379600525
loss_pred:0.027784502133727074, decouple_loss:0.008656459860503674
The generated pressure mean: 0.44277942180633545
loss_pred:0.027225611731410027, decouple_loss:0.009157971478998661
The generated pressure mean: 0.44952285289764404
loss_pred:0.02661215141415596, decouple_loss:0.009139912202954292
Iteration: 1166, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4604756236076355
loss_pred:0.025850003585219383, decouple_loss:0.008520777337253094
The generated pressure mean: 0.4589768052101135
loss_pred:0.026889227330684662, decouple_loss:0.008331484161317348
The generated pressure mean: 0.45743319392204285
loss_pred:0.026624970138072968, decouple_loss:0.008367687463760376
Iteration: 1167, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44705384969711304
loss_pred:0.025857102125883102, decouple_loss:0.008063032291829586
The generated pressure mean: 0.44818124175071716
loss_pred:0.025533344596624374, decouple_loss:0.008309020660817623
The generated pressure mean: 0.4438919425010681
loss_pred:0.026357967406511307, decouple_loss:0.007858858443796635
Iteration: 1168, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44629260897636414
loss_pred:0.024956289678812027, decouple_loss:0.008533506654202938
The generated pressure mean: 0.4423288106918335
loss_pred:0.02753014676272869, decouple_loss:0.008659623563289642
The generated pressure mean: 0.44590380787849426
loss_pred:0.02677011489868164, decouple_loss:0.008447030559182167
Iteration: 1169, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44102755188941956
loss_pred:0.025912795215845108, decouple_loss:0.008029046468436718
The generated pressure mean: 0.4479238986968994
loss_pred:0.026075731962919235, decouple_loss:0.00827789306640625
The generated pressure mean: 0.4474218785762787
loss_pred:0.026273753494024277, decouple_loss:0.007947197183966637
Iteration: 1170, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4432904124259949
loss_pred:0.027281932532787323, decouple_loss:0.007787473499774933
The generated pressure mean: 0.4410441815853119
loss_pred:0.02552885189652443, decouple_loss:0.007470331154763699
The generated pressure mean: 0.44615012407302856
loss_pred:0.026417560875415802, decouple_loss:0.007370835170149803
2023-04-16 05:54:53 testing...
The generated pressure mean: 0.41930124163627625
loss_pred:0.03816263750195503, decouple_loss:0.00870396289974451
The generated pressure mean: 0.4272369146347046
loss_pred:0.03626593202352524, decouple_loss:0.009030290879309177
The generated pressure mean: 0.4324309527873993
loss_pred:0.03690759465098381, decouple_loss:0.00910921860486269
Loss: 0.037559445947408676, avg_mse: 0.050196848809719086
current test mse: 0.050197
Iteration: 1171, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45040231943130493
loss_pred:0.025565586984157562, decouple_loss:0.00800833199173212
The generated pressure mean: 0.44550007581710815
loss_pred:0.02574068121612072, decouple_loss:0.007587735075503588
The generated pressure mean: 0.4467967450618744
loss_pred:0.026099571958184242, decouple_loss:0.007768926210701466
Iteration: 1172, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45891886949539185
The generated pressure mean: 0.44738584756851196
loss_pred:0.026820635423064232, decouple_loss:0.007201949134469032
loss_pred:0.025515209883451462, decouple_loss:0.006923348642885685
The generated pressure mean: 0.4565776288509369
loss_pred:0.024815717712044716, decouple_loss:0.006842589005827904
Iteration: 1173, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44228315353393555
loss_pred:0.025394219905138016, decouple_loss:0.007717783562839031
The generated pressure mean: 0.44492635130882263
loss_pred:0.02667456865310669, decouple_loss:0.007629183121025562
The generated pressure mean: 0.44523489475250244
loss_pred:0.026660719886422157, decouple_loss:0.007466164883226156
Iteration: 1174, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.436481773853302
loss_pred:0.026992877945303917, decouple_loss:0.007986552082002163The generated pressure mean: 0.43560847640037537
loss_pred:0.026000209152698517, decouple_loss:0.00800133217126131
The generated pressure mean: 0.43407079577445984
loss_pred:0.02610498107969761, decouple_loss:0.007984809577465057
Iteration: 1175, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4468629062175751
loss_pred:0.025704745203256607, decouple_loss:0.007498647086322308
The generated pressure mean: 0.4407479763031006
loss_pred:0.025391804054379463, decouple_loss:0.007345984224230051
The generated pressure mean: 0.4503994286060333
loss_pred:0.026891453191637993, decouple_loss:0.007468707859516144
Iteration: 1176, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4546999931335449
loss_pred:0.02556127868592739, decouple_loss:0.00750246737152338
The generated pressure mean: 0.4514032304286957
loss_pred:0.0270855575799942, decouple_loss:0.007194030564278364
The generated pressure mean: 0.4570740759372711
loss_pred:0.026828503236174583, decouple_loss:0.007238639984279871
Iteration: 1177, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4561973214149475
loss_pred:0.025713546201586723, decouple_loss:0.008757587522268295
The generated pressure mean: 0.45470932126045227
loss_pred:0.02650275267660618, decouple_loss:0.008671488612890244
The generated pressure mean: 0.4520145654678345
loss_pred:0.02748938836157322, decouple_loss:0.008691824972629547
Iteration: 1178, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4397641718387604
loss_pred:0.025992341339588165, decouple_loss:0.0075759668834507465
The generated pressure mean: 0.4327247738838196
loss_pred:0.026448966935276985, decouple_loss:0.007492344826459885
The generated pressure mean: 0.43722450733184814
loss_pred:0.025350911542773247, decouple_loss:0.007585314568132162
Iteration: 1179, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4450640380382538
loss_pred:0.02575846202671528, decouple_loss:0.008966217748820782
The generated pressure mean: 0.44409143924713135
loss_pred:0.026417097076773643, decouple_loss:0.008833829313516617
The generated pressure mean: 0.4423336386680603
loss_pred:0.025546845048666, decouple_loss:0.008731178939342499
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1180, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45408549904823303
loss_pred:0.025585196912288666, decouple_loss:0.009494918398559093
The generated pressure mean: 0.44788968563079834
loss_pred:0.025125738233327866, decouple_loss:0.009249106980860233
The generated pressure mean: 0.44778111577033997
loss_pred:0.02580254152417183, decouple_loss:0.009615849703550339
2023-04-16 05:56:53 testing...
The generated pressure mean: 0.42032572627067566
loss_pred:0.038619376718997955, decouple_loss:0.009102584794163704
The generated pressure mean: 0.4282132685184479
loss_pred:0.03757558763027191, decouple_loss:0.009266446344554424
The generated pressure mean: 0.4339056611061096
loss_pred:0.0375518836081028, decouple_loss:0.009404732845723629
Loss: 0.0383785143494606, avg_mse: 0.052175041288137436
current test mse: 0.052175
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012016_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012016_3_24hr.npz
NaN value num: 0
Iteration: 1181, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45001348853111267
loss_pred:0.025662096217274666, decouple_loss:0.008287076838314533
The generated pressure mean: 0.44247695803642273
loss_pred:0.02791980654001236, decouple_loss:0.008546991273760796
The generated pressure mean: 0.44463521242141724
loss_pred:0.02753700688481331, decouple_loss:0.008236149325966835
Iteration: 1182, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4498598575592041
loss_pred:0.027866875752806664, decouple_loss:0.011222811415791512
The generated pressure mean: 0.4534492492675781
loss_pred:0.025490092113614082, decouple_loss:0.010531117208302021
The generated pressure mean: 0.4541504383087158
loss_pred:0.027488742023706436, decouple_loss:0.01055249385535717
Iteration: 1183, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4453912675380707
loss_pred:0.026728259399533272, decouple_loss:0.0074197519570589066
The generated pressure mean: 0.44607269763946533
loss_pred:0.026306776329874992, decouple_loss:0.007311463356018066
The generated pressure mean: 0.4494739770889282
loss_pred:0.026755936443805695, decouple_loss:0.0069534736685454845
Iteration: 1184, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4397718012332916
loss_pred:0.02810131572186947, decouple_loss:0.010442771017551422
The generated pressure mean: 0.4376991391181946
loss_pred:0.0266634039580822, decouple_loss:0.010832897387444973
The generated pressure mean: 0.43831291794776917
loss_pred:0.02549300715327263, decouple_loss:0.010379831306636333
Iteration: 1185, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4495837688446045
loss_pred:0.027756912633776665, decouple_loss:0.0073782773688435555
The generated pressure mean: 0.4499818682670593
loss_pred:0.02653934620320797, decouple_loss:0.00710267573595047
The generated pressure mean: 0.4509081244468689
loss_pred:0.02727341279387474, decouple_loss:0.00733449449762702
Iteration: 1186, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4503631591796875
loss_pred:0.02716364525258541, decouple_loss:0.010678242892026901
The generated pressure mean: 0.4503369629383087
loss_pred:0.026320114731788635, decouple_loss:0.010442369617521763
The generated pressure mean: 0.4519518315792084
loss_pred:0.02682035230100155, decouple_loss:0.01062551699578762
Iteration: 1187, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45000287890434265
loss_pred:0.026172956451773643, decouple_loss:0.007081210613250732
The generated pressure mean: 0.44765153527259827
loss_pred:0.025882020592689514, decouple_loss:0.007029141299426556
The generated pressure mean: 0.44345828890800476
loss_pred:0.0254962295293808, decouple_loss:0.007235506549477577
Iteration: 1188, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44129160046577454
loss_pred:0.026618558913469315, decouple_loss:0.010442606173455715
The generated pressure mean: 0.4386051297187805
loss_pred:0.02636924386024475, decouple_loss:0.010551895946264267
The generated pressure mean: 0.4403615891933441
loss_pred:0.026156866922974586, decouple_loss:0.01061389409005642
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1189, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44656792283058167
loss_pred:0.026449857279658318, decouple_loss:0.007696394808590412
The generated pressure mean: 0.445644348859787
loss_pred:0.026265429332852364, decouple_loss:0.00809158943593502
The generated pressure mean: 0.4474329352378845
loss_pred:0.02603411301970482, decouple_loss:0.008141553029417992
Iteration: 1190, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4578433036804199
The generated pressure mean: 0.4525803029537201loss_pred:0.026982540264725685, decouple_loss:0.010843644849956036
loss_pred:0.02485845610499382, decouple_loss:0.010940229520201683
The generated pressure mean: 0.4468540847301483
loss_pred:0.027220722287893295, decouple_loss:0.01102505810558796
2023-04-16 05:59:29 testing...
The generated pressure mean: 0.4216653108596802
loss_pred:0.03826242312788963, decouple_loss:0.009832767769694328
The generated pressure mean: 0.4323869049549103
loss_pred:0.03709600120782852, decouple_loss:0.009920873679220676
The generated pressure mean: 0.437566339969635
loss_pred:0.03755641356110573, decouple_loss:0.01016622968018055
Loss: 0.03813694417476654, avg_mse: 0.051822274923324585
current test mse: 0.051822
Iteration: 1191, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.439388632774353
The generated pressure mean: 0.44045010209083557
loss_pred:0.026391372084617615, decouple_loss:0.008820408955216408
loss_pred:0.024929728358983994, decouple_loss:0.008889027871191502
The generated pressure mean: 0.43854400515556335
loss_pred:0.025836443528532982, decouple_loss:0.00902708899229765
Iteration: 1192, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45364922285079956
loss_pred:0.027531908825039864, decouple_loss:0.009433076716959476
The generated pressure mean: 0.4511813521385193
loss_pred:0.02776142582297325, decouple_loss:0.009291566908359528
The generated pressure mean: 0.4537030756473541
loss_pred:0.027352428063750267, decouple_loss:0.009444108232855797
Iteration: 1193, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4478665590286255
loss_pred:0.02654915489256382, decouple_loss:0.008656774647533894
The generated pressure mean: 0.4459483027458191
loss_pred:0.02566029690206051, decouple_loss:0.008544673211872578
The generated pressure mean: 0.4456426203250885
loss_pred:0.027559392154216766, decouple_loss:0.008612783625721931
Iteration: 1194, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4453120231628418
loss_pred:0.02709379978477955, decouple_loss:0.009190084412693977
The generated pressure mean: 0.44547316431999207
loss_pred:0.026783324778079987, decouple_loss:0.009307041764259338
The generated pressure mean: 0.44279325008392334
loss_pred:0.027970364317297935, decouple_loss:0.009379847906529903
Iteration: 1195, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4394995868206024
loss_pred:0.02796679176390171, decouple_loss:0.008180362172424793
The generated pressure mean: 0.4399803578853607
loss_pred:0.02792147733271122, decouple_loss:0.008139804936945438
The generated pressure mean: 0.4362391233444214
loss_pred:0.02765623852610588, decouple_loss:0.008508826605975628
Iteration: 1196, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4574832618236542
loss_pred:0.027139006182551384, decouple_loss:0.009986523538827896
The generated pressure mean: 0.4567711353302002
loss_pred:0.02682439424097538, decouple_loss:0.009840099141001701
The generated pressure mean: 0.4578615128993988
loss_pred:0.02851729281246662, decouple_loss:0.010008766315877438
Iteration: 1197, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4555237591266632
loss_pred:0.02713434025645256, decouple_loss:0.008511439897119999
The generated pressure mean: 0.45425936579704285
loss_pred:0.025585714727640152, decouple_loss:0.008740721270442009
The generated pressure mean: 0.45423373579978943
loss_pred:0.026946701109409332, decouple_loss:0.008751867339015007
Iteration: 1198, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4333275258541107
loss_pred:0.025994591414928436, decouple_loss:0.009482210502028465The generated pressure mean: 0.4300205409526825
loss_pred:0.0276191309094429, decouple_loss:0.009597728960216045
The generated pressure mean: 0.43739378452301025
loss_pred:0.02702583372592926, decouple_loss:0.009551269933581352
Iteration: 1199, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4346156120300293
loss_pred:0.028272684663534164, decouple_loss:0.008732728660106659
The generated pressure mean: 0.4332311451435089
loss_pred:0.027643153443932533, decouple_loss:0.008508767001330853
The generated pressure mean: 0.43858805298805237
loss_pred:0.02590576745569706, decouple_loss:0.008416395634412766
Iteration: 1200, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4633823037147522
loss_pred:0.026230618357658386, decouple_loss:0.008968578651547432
The generated pressure mean: 0.4558206796646118
loss_pred:0.027111416682600975, decouple_loss:0.00884524267166853
The generated pressure mean: 0.45933982729911804
loss_pred:0.025562768802046776, decouple_loss:0.008601353503763676
2023-04-16 06:01:29 testing...
The generated pressure mean: 0.4143413305282593
loss_pred:0.038168422877788544, decouple_loss:0.010303225368261337
The generated pressure mean: 0.4235621392726898
loss_pred:0.0364387221634388, decouple_loss:0.010287128388881683
The generated pressure mean: 0.42784810066223145
loss_pred:0.03718949109315872, decouple_loss:0.010505503974854946
Loss: 0.03778380900621414, avg_mse: 0.05097753927111626
current test mse: 0.050978
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012002_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012002_3_24hr.npz
NaN value num: 0
Iteration: 1201, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4632717967033386
loss_pred:0.025085994973778725, decouple_loss:0.00940585508942604
The generated pressure mean: 0.46452030539512634
loss_pred:0.026995891705155373, decouple_loss:0.009616907685995102
The generated pressure mean: 0.4605245292186737
loss_pred:0.027413273230195045, decouple_loss:0.009458103217184544
Iteration: 1202, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43460553884506226
loss_pred:0.024980949237942696, decouple_loss:0.008243879303336143
The generated pressure mean: 0.4305916130542755
loss_pred:0.02505062334239483, decouple_loss:0.008068121038377285
The generated pressure mean: 0.43292081356048584
loss_pred:0.024797802790999413, decouple_loss:0.008211948908865452
Iteration: 1203, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4289972484111786
loss_pred:0.026055525988340378, decouple_loss:0.008805894292891026
The generated pressure mean: 0.42987126111984253
loss_pred:0.025462577119469643, decouple_loss:0.009304461069405079
The generated pressure mean: 0.4377121925354004
loss_pred:0.025615420192480087, decouple_loss:0.008976887911558151
Iteration: 1204, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4605337083339691
loss_pred:0.02552851289510727, decouple_loss:0.007518644444644451
The generated pressure mean: 0.4598965346813202
loss_pred:0.02606542408466339, decouple_loss:0.007275503594428301
The generated pressure mean: 0.45595425367355347
loss_pred:0.027203315868973732, decouple_loss:0.007696917280554771
Iteration: 1205, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4547068178653717
loss_pred:0.025906801223754883, decouple_loss:0.007571264635771513
The generated pressure mean: 0.45418858528137207
loss_pred:0.02584829367697239, decouple_loss:0.0075925188139081
The generated pressure mean: 0.4558956027030945
loss_pred:0.025747697800397873, decouple_loss:0.00792789924889803
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1206, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43291524052619934
loss_pred:0.026378484442830086, decouple_loss:0.009048698469996452
The generated pressure mean: 0.43767595291137695
loss_pred:0.02653629705309868, decouple_loss:0.009111767634749413
The generated pressure mean: 0.43779584765434265
loss_pred:0.027695955708622932, decouple_loss:0.008762616664171219
Iteration: 1207, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4554610848426819
loss_pred:0.0244769137352705, decouple_loss:0.009538386948406696
The generated pressure mean: 0.4493963122367859
loss_pred:0.027808506041765213, decouple_loss:0.009666653349995613
The generated pressure mean: 0.44877517223358154
loss_pred:0.02700658142566681, decouple_loss:0.00948665477335453
Iteration: 1208, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45343610644340515
loss_pred:0.02651669830083847, decouple_loss:0.008756735362112522
The generated pressure mean: 0.4569784104824066
loss_pred:0.02565346471965313, decouple_loss:0.008524039760231972
The generated pressure mean: 0.45267555117607117
loss_pred:0.02738826535642147, decouple_loss:0.00912685040384531
Iteration: 1209, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4267580807209015
loss_pred:0.02595103345811367, decouple_loss:0.008114282973110676
The generated pressure mean: 0.4299355745315552
loss_pred:0.026323765516281128, decouple_loss:0.008234551176428795
The generated pressure mean: 0.42705342173576355
loss_pred:0.02686886675655842, decouple_loss:0.008539769798517227
Iteration: 1210, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45166268944740295
loss_pred:0.026029331609606743, decouple_loss:0.008589478209614754
The generated pressure mean: 0.4512723684310913
loss_pred:0.02673082798719406, decouple_loss:0.00828448124229908
The generated pressure mean: 0.45266997814178467
loss_pred:0.026348277926445007, decouple_loss:0.00797364767640829
2023-04-16 06:04:22 testing...
The generated pressure mean: 0.41330111026763916
loss_pred:0.03923813998699188, decouple_loss:0.009000653401017189
The generated pressure mean: 0.42110756039619446
loss_pred:0.03805811330676079, decouple_loss:0.009179200977087021
The generated pressure mean: 0.4259287714958191
loss_pred:0.03851412236690521, decouple_loss:0.009325187653303146
Loss: 0.03906187787652016, avg_mse: 0.05307241156697273
current test mse: 0.053072
Iteration: 1211, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4589613080024719
loss_pred:0.02673001028597355, decouple_loss:0.008102918043732643
The generated pressure mean: 0.45965132117271423
loss_pred:0.026746205985546112, decouple_loss:0.00808094535022974
The generated pressure mean: 0.4657478630542755
loss_pred:0.02485981397330761, decouple_loss:0.008216160349547863
Iteration: 1212, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4422636926174164
loss_pred:0.02634982392191887, decouple_loss:0.008641011081635952
The generated pressure mean: 0.4413830637931824
The generated pressure mean: 0.4412974715232849
loss_pred:0.025989430025219917, decouple_loss:0.008592887781560421
loss_pred:0.02711866796016693, decouple_loss:0.008405842818319798
Iteration: 1213, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43708017468452454
loss_pred:0.026706470176577568, decouple_loss:0.008359583094716072
The generated pressure mean: 0.4374849796295166
loss_pred:0.025804881006479263, decouple_loss:0.008381538093090057
The generated pressure mean: 0.4382235109806061
loss_pred:0.025156673043966293, decouple_loss:0.008250056765973568
Iteration: 1214, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43777212500572205
loss_pred:0.025247151032090187, decouple_loss:0.009546929970383644
The generated pressure mean: 0.4420650005340576
loss_pred:0.024555141106247902, decouple_loss:0.009340284392237663
The generated pressure mean: 0.44168877601623535
loss_pred:0.025609981268644333, decouple_loss:0.008891821838915348
Iteration: 1215, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4501526653766632
loss_pred:0.02641945332288742, decouple_loss:0.008215648122131824
The generated pressure mean: 0.45197582244873047
loss_pred:0.025136509910225868, decouple_loss:0.008685674518346786
The generated pressure mean: 0.458777517080307
loss_pred:0.02433859184384346, decouple_loss:0.008607045747339725
Iteration: 1216, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4499468207359314
The generated pressure mean: 0.4525243043899536
loss_pred:0.02491520345211029, decouple_loss:0.009079770185053349
loss_pred:0.02599496953189373, decouple_loss:0.008533076383173466
The generated pressure mean: 0.4549378752708435
loss_pred:0.024013150483369827, decouple_loss:0.008923663757741451
Iteration: 1217, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43933215737342834
loss_pred:0.02670050598680973, decouple_loss:0.007550903130322695
The generated pressure mean: 0.43609166145324707
loss_pred:0.025687457993626595, decouple_loss:0.008157225325703621
The generated pressure mean: 0.44599783420562744
loss_pred:0.025388401001691818, decouple_loss:0.007642695680260658
Iteration: 1218, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4326765835285187
loss_pred:0.030487600713968277, decouple_loss:0.007896414026618004
The generated pressure mean: 0.43385037779808044
loss_pred:0.02693808078765869, decouple_loss:0.008136889897286892
The generated pressure mean: 0.43708887696266174
loss_pred:0.0254178736358881, decouple_loss:0.007862047292292118
Iteration: 1219, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4652765095233917
loss_pred:0.024709178134799004, decouple_loss:0.009203382767736912
The generated pressure mean: 0.4605304002761841
loss_pred:0.029477005824446678, decouple_loss:0.008953509852290154
The generated pressure mean: 0.4609673023223877
loss_pred:0.026724759489297867, decouple_loss:0.009184400551021099
Iteration: 1220, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4400564134120941
loss_pred:0.025817057117819786, decouple_loss:0.00924732256680727
The generated pressure mean: 0.4441019892692566
loss_pred:0.02613668143749237, decouple_loss:0.008986821398139
The generated pressure mean: 0.4422103762626648
loss_pred:0.027643729001283646, decouple_loss:0.009401804767549038
2023-04-16 06:06:23 testing...
The generated pressure mean: 0.42242860794067383
loss_pred:0.03951466083526611, decouple_loss:0.008336649276316166
The generated pressure mean: 0.4303266406059265
loss_pred:0.03843545541167259, decouple_loss:0.008536086417734623
The generated pressure mean: 0.4353945255279541
loss_pred:0.03997794911265373, decouple_loss:0.008666259236633778
Loss: 0.03973500430583954, avg_mse: 0.053941044956445694
current test mse: 0.053941
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012004_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012004_3_24hr.npz
NaN value num: 0
Iteration: 1221, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4399648904800415
loss_pred:0.025412868708372116, decouple_loss:0.007948956452310085
The generated pressure mean: 0.43926993012428284
loss_pred:0.02506742998957634, decouple_loss:0.007775750942528248
The generated pressure mean: 0.43616631627082825
loss_pred:0.02730693854391575, decouple_loss:0.00811680220067501
Iteration: 1222, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.448092520236969
loss_pred:0.0265627671033144, decouple_loss:0.009327243082225323
The generated pressure mean: 0.44122281670570374
loss_pred:0.02562517486512661, decouple_loss:0.009160718880593777
The generated pressure mean: 0.44689297676086426
loss_pred:0.026223013177514076, decouple_loss:0.00922204926609993
Iteration: 1223, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45901498198509216
loss_pred:0.02660464122891426, decouple_loss:0.007603735197335482
The generated pressure mean: 0.4572101831436157
loss_pred:0.02635767124593258, decouple_loss:0.007302998099476099
The generated pressure mean: 0.45622050762176514
loss_pred:0.02710428275167942, decouple_loss:0.00809480994939804
Iteration: 1224, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44786199927330017
loss_pred:0.02638900652527809, decouple_loss:0.00838159304112196
The generated pressure mean: 0.44780808687210083
loss_pred:0.02684125117957592, decouple_loss:0.008304842747747898
The generated pressure mean: 0.446178674697876
loss_pred:0.02577865496277809, decouple_loss:0.008273694664239883
Iteration: 1225, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4373573958873749
loss_pred:0.025310469791293144, decouple_loss:0.008205030113458633
The generated pressure mean: 0.4356147050857544
loss_pred:0.026421109214425087, decouple_loss:0.007922632619738579
The generated pressure mean: 0.43702104687690735
loss_pred:0.026065390557050705, decouple_loss:0.00810555275529623
Iteration: 1226, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4501926004886627
loss_pred:0.02771655283868313, decouple_loss:0.008577891625463963
The generated pressure mean: 0.44986045360565186
loss_pred:0.027025487273931503, decouple_loss:0.009049423038959503
The generated pressure mean: 0.4491555988788605
loss_pred:0.027098068967461586, decouple_loss:0.00884080771356821
Iteration: 1227, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4479006230831146
loss_pred:0.024632232263684273, decouple_loss:0.00891282968223095
The generated pressure mean: 0.4450541138648987
loss_pred:0.025362500920891762, decouple_loss:0.008762153796851635
The generated pressure mean: 0.4439314305782318
loss_pred:0.025740420445799828, decouple_loss:0.0095596294850111
Iteration: 1228, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44136330485343933
loss_pred:0.0252976156771183, decouple_loss:0.00845716055482626
The generated pressure mean: 0.44015172123908997
loss_pred:0.0242203027009964, decouple_loss:0.008902781642973423
The generated pressure mean: 0.43807509541511536
loss_pred:0.02618085779249668, decouple_loss:0.00866909883916378
Iteration: 1229, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44687312841415405
loss_pred:0.025622785091400146, decouple_loss:0.008029453456401825
The generated pressure mean: 0.4501245319843292
loss_pred:0.025202278047800064, decouple_loss:0.008818322792649269
The generated pressure mean: 0.44991710782051086
loss_pred:0.024667993187904358, decouple_loss:0.007880404591560364
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1230, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4641139507293701
loss_pred:0.025267500430345535, decouple_loss:0.008546329103410244
The generated pressure mean: 0.45759209990501404
loss_pred:0.02495983988046646, decouple_loss:0.008683777414262295
The generated pressure mean: 0.4627893269062042
loss_pred:0.02500138059258461, decouple_loss:0.0084296939894557
2023-04-16 06:09:00 testing...
The generated pressure mean: 0.4195486009120941
loss_pred:0.038924552500247955, decouple_loss:0.00865183211863041
The generated pressure mean: 0.4272806942462921
loss_pred:0.03783585503697395, decouple_loss:0.008910502307116985
The generated pressure mean: 0.43119320273399353
loss_pred:0.038185521960258484, decouple_loss:0.009116819128394127
Loss: 0.03875996172428131, avg_mse: 0.052812281996011734
current test mse: 0.052812
Iteration: 1231, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44613394141197205
loss_pred:0.02508697845041752, decouple_loss:0.008108790963888168
The generated pressure mean: 0.44339054822921753
loss_pred:0.025121113285422325, decouple_loss:0.007777998689562082
The generated pressure mean: 0.4408814609050751
loss_pred:0.025865016505122185, decouple_loss:0.008145465515553951
Iteration: 1232, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4380895495414734
The generated pressure mean: 0.43340060114860535
loss_pred:0.025279009714722633, decouple_loss:0.008848297409713268
loss_pred:0.025401340797543526, decouple_loss:0.009014713577926159
The generated pressure mean: 0.433830589056015
loss_pred:0.026581723242998123, decouple_loss:0.00889869686216116
Iteration: 1233, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45730289816856384
loss_pred:0.025363393127918243, decouple_loss:0.00873605441302061
The generated pressure mean: 0.4529818594455719
loss_pred:0.02538316883146763, decouple_loss:0.009180950000882149
The generated pressure mean: 0.45051997900009155
loss_pred:0.024820290505886078, decouple_loss:0.009589591063559055
Iteration: 1234, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4496396481990814
loss_pred:0.024649381637573242, decouple_loss:0.009557664394378662
The generated pressure mean: 0.452303409576416
loss_pred:0.02488136477768421, decouple_loss:0.00974932312965393
The generated pressure mean: 0.45259663462638855
loss_pred:0.024988315999507904, decouple_loss:0.009992648847401142
Iteration: 1235, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4448879361152649
loss_pred:0.02483052760362625, decouple_loss:0.008555123582482338
The generated pressure mean: 0.4407268762588501
loss_pred:0.02530088648200035, decouple_loss:0.008603710681200027
The generated pressure mean: 0.4462539255619049
loss_pred:0.0241436418145895, decouple_loss:0.008469901978969574
Iteration: 1236, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4392520487308502
loss_pred:0.024619750678539276, decouple_loss:0.00887577049434185
The generated pressure mean: 0.4445442259311676
loss_pred:0.024356350302696228, decouple_loss:0.009234773926436901
The generated pressure mean: 0.4377763271331787
loss_pred:0.024878645315766335, decouple_loss:0.008679809980094433
Iteration: 1237, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4493105709552765
loss_pred:0.02524343691766262, decouple_loss:0.008288176730275154
The generated pressure mean: 0.4461930990219116
loss_pred:0.024549968540668488, decouple_loss:0.008271807804703712
The generated pressure mean: 0.44590771198272705
loss_pred:0.024768978357315063, decouple_loss:0.008106841705739498
Iteration: 1238, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4509100019931793
loss_pred:0.025700610131025314, decouple_loss:0.009981149807572365
The generated pressure mean: 0.44618549942970276
loss_pred:0.024975331500172615, decouple_loss:0.00934312678873539
The generated pressure mean: 0.4523354768753052
loss_pred:0.0242680162191391, decouple_loss:0.009454178623855114
Iteration: 1239, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45139357447624207
loss_pred:0.024435121566057205, decouple_loss:0.007490729913115501
The generated pressure mean: 0.4437721371650696
loss_pred:0.02378694899380207, decouple_loss:0.007425433956086636
The generated pressure mean: 0.447661817073822
loss_pred:0.02703946642577648, decouple_loss:0.0072488742880523205
Iteration: 1240, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4452486038208008
loss_pred:0.024186313152313232, decouple_loss:0.011165907606482506
The generated pressure mean: 0.4385976195335388
loss_pred:0.027195218950510025, decouple_loss:0.010586615651845932
The generated pressure mean: 0.4435955286026001
loss_pred:0.024486960843205452, decouple_loss:0.010606753639876842
2023-04-16 06:11:01 testing...
The generated pressure mean: 0.41997113823890686
loss_pred:0.03676232323050499, decouple_loss:0.00836076121777296
The generated pressure mean: 0.42852193117141724
loss_pred:0.03569862246513367, decouple_loss:0.008412783965468407
The generated pressure mean: 0.4336532950401306
loss_pred:0.03632935881614685, decouple_loss:0.00855950452387333
Loss: 0.036685653030872345, avg_mse: 0.049815449863672256
current test mse: 0.049815
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012003_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012003_3_24hr.npz
NaN value num: 0
Iteration: 1241, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4427427053451538
loss_pred:0.025362569838762283, decouple_loss:0.007832646369934082
The generated pressure mean: 0.4463959336280823
loss_pred:0.025367818772792816, decouple_loss:0.007953367196023464
The generated pressure mean: 0.4483468234539032
loss_pred:0.024784030392766, decouple_loss:0.008260798640549183
Iteration: 1242, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44570010900497437
loss_pred:0.02515033632516861, decouple_loss:0.009603156708180904
The generated pressure mean: 0.4466777741909027
loss_pred:0.024526342749595642, decouple_loss:0.00974298920482397
The generated pressure mean: 0.4463917016983032
loss_pred:0.02488936483860016, decouple_loss:0.009782507084310055
Iteration: 1243, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45396408438682556
loss_pred:0.025330333039164543, decouple_loss:0.008509003557264805
The generated pressure mean: 0.4509071409702301
The generated pressure mean: 0.45338383316993713
loss_pred:0.02429473213851452, decouple_loss:0.008128236047923565
loss_pred:0.02594624273478985, decouple_loss:0.008354824967682362
Iteration: 1244, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4419843256473541
loss_pred:0.024428827688097954, decouple_loss:0.009189781732857227
The generated pressure mean: 0.4484419524669647
loss_pred:0.025813089683651924, decouple_loss:0.009113227017223835
The generated pressure mean: 0.44168704748153687
loss_pred:0.024887336418032646, decouple_loss:0.009079402312636375
Iteration: 1245, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4419577419757843
loss_pred:0.025738604366779327, decouple_loss:0.00767787778750062
The generated pressure mean: 0.4367242157459259
loss_pred:0.024394668638706207, decouple_loss:0.007990114390850067
The generated pressure mean: 0.443030446767807
loss_pred:0.027213795110583305, decouple_loss:0.00783511158078909
Iteration: 1246, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45087289810180664
loss_pred:0.025107385590672493, decouple_loss:0.007968662306666374
The generated pressure mean: 0.45231276750564575
loss_pred:0.024892441928386688, decouple_loss:0.008041014894843102
The generated pressure mean: 0.44768449664115906
loss_pred:0.02455320954322815, decouple_loss:0.008145526051521301
Iteration: 1247, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46225637197494507
loss_pred:0.024348361417651176, decouple_loss:0.008759589865803719
The generated pressure mean: 0.4601846933364868
loss_pred:0.024582339450716972, decouple_loss:0.008575734682381153
The generated pressure mean: 0.46020638942718506
loss_pred:0.0257551409304142, decouple_loss:0.00877472572028637
Iteration: 1248, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.446441113948822
loss_pred:0.02510259672999382, decouple_loss:0.008545788004994392
The generated pressure mean: 0.43862178921699524
loss_pred:0.0243291724473238, decouple_loss:0.008971795439720154
The generated pressure mean: 0.4449233114719391
loss_pred:0.02544284239411354, decouple_loss:0.008517157286405563
Iteration: 1249, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43348804116249084
loss_pred:0.02377169206738472, decouple_loss:0.008008193224668503
The generated pressure mean: 0.44484472274780273
loss_pred:0.02426883950829506, decouple_loss:0.00760285509750247
The generated pressure mean: 0.4448179006576538
loss_pred:0.02544105239212513, decouple_loss:0.007562838960438967
Iteration: 1250, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44894763827323914
loss_pred:0.024735169485211372, decouple_loss:0.008380160667002201
The generated pressure mean: 0.4477751553058624
loss_pred:0.025504697114229202, decouple_loss:0.008560653775930405
The generated pressure mean: 0.4474835693836212
loss_pred:0.024442555382847786, decouple_loss:0.008604058064520359
2023-04-16 06:13:43 testing...
The generated pressure mean: 0.41783902049064636
loss_pred:0.038330305367708206, decouple_loss:0.008449256420135498
The generated pressure mean: 0.4243593215942383
loss_pred:0.03717779368162155, decouple_loss:0.008384968154132366
The generated pressure mean: 0.42948243021965027
loss_pred:0.03816010057926178, decouple_loss:0.00895391870290041
Loss: 0.03831920027732849, avg_mse: 0.051683612167835236
current test mse: 0.051684
Iteration: 1251, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45320940017700195
loss_pred:0.02607298083603382, decouple_loss:0.007912740111351013
The generated pressure mean: 0.44936320185661316
loss_pred:0.02480863220989704, decouple_loss:0.007562592625617981
The generated pressure mean: 0.4517386257648468
loss_pred:0.025542892515659332, decouple_loss:0.007697484456002712
Iteration: 1252, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4435303807258606
loss_pred:0.025145934894680977, decouple_loss:0.008723556995391846
The generated pressure mean: 0.44767749309539795
loss_pred:0.023745447397232056, decouple_loss:0.00877459067851305
The generated pressure mean: 0.44398295879364014
loss_pred:0.024616777896881104, decouple_loss:0.008866318501532078
Iteration: 1253, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44229692220687866
loss_pred:0.02418268471956253, decouple_loss:0.008986657485365868
The generated pressure mean: 0.4462296664714813
loss_pred:0.026012923568487167, decouple_loss:0.008969945833086967
The generated pressure mean: 0.4448244869709015
loss_pred:0.02526720054447651, decouple_loss:0.009222191758453846
Iteration: 1254, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45860737562179565
loss_pred:0.02645588293671608, decouple_loss:0.009610992856323719
The generated pressure mean: 0.45995017886161804
loss_pred:0.027402520179748535, decouple_loss:0.009543134830892086
The generated pressure mean: 0.46274158358573914
loss_pred:0.024588294327259064, decouple_loss:0.009478013031184673
Iteration: 1255, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4380843937397003
loss_pred:0.02543250285089016, decouple_loss:0.008243904449045658
The generated pressure mean: 0.441234827041626
loss_pred:0.024797307327389717, decouple_loss:0.00814818311482668
The generated pressure mean: 0.4394330084323883
loss_pred:0.025132015347480774, decouple_loss:0.00874039065092802
Iteration: 1256, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43582719564437866
The generated pressure mean: 0.4294000566005707
loss_pred:0.025689054280519485, decouple_loss:0.010383442044258118
loss_pred:0.025918416678905487, decouple_loss:0.010054427199065685
The generated pressure mean: 0.4335325360298157
loss_pred:0.024148009717464447, decouple_loss:0.010023616254329681
Iteration: 1257, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4723769724369049
loss_pred:0.025700537487864494, decouple_loss:0.009709421545267105
The generated pressure mean: 0.4679836630821228
loss_pred:0.025687294080853462, decouple_loss:0.00966067798435688
The generated pressure mean: 0.4691126346588135
loss_pred:0.024149496108293533, decouple_loss:0.009477963671088219
Iteration: 1258, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45012491941452026
loss_pred:0.024693654850125313, decouple_loss:0.008609328418970108
The generated pressure mean: 0.4485172927379608
loss_pred:0.024440672248601913, decouple_loss:0.008866413496434689
The generated pressure mean: 0.44699183106422424
loss_pred:0.025325948372483253, decouple_loss:0.008648713119328022
Iteration: 1259, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4253360629081726
loss_pred:0.02559283748269081, decouple_loss:0.010086167603731155
The generated pressure mean: 0.42752406001091003
loss_pred:0.023842470720410347, decouple_loss:0.010122718289494514
The generated pressure mean: 0.42453426122665405
loss_pred:0.02444286085665226, decouple_loss:0.00992356613278389
Iteration: 1260, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45496875047683716
loss_pred:0.02312450483441353, decouple_loss:0.00919710099697113
The generated pressure mean: 0.4557410776615143
loss_pred:0.025353383272886276, decouple_loss:0.009246696718037128
The generated pressure mean: 0.4470084011554718
loss_pred:0.024471988901495934, decouple_loss:0.008977812714874744
2023-04-16 06:15:44 testing...
The generated pressure mean: 0.41620469093322754
loss_pred:0.03822885453701019, decouple_loss:0.00920555554330349
The generated pressure mean: 0.4243518114089966
loss_pred:0.037355586886405945, decouple_loss:0.009283727966248989
The generated pressure mean: 0.4301464855670929
loss_pred:0.037597887217998505, decouple_loss:0.009636223316192627
Loss: 0.038196202367544174, avg_mse: 0.05197136849164963
current test mse: 0.051971
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012008_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012008_3_24hr.npz
NaN value num: 0
Iteration: 1261, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4589921236038208
loss_pred:0.025709904730319977, decouple_loss:0.008839327841997147
The generated pressure mean: 0.4660583734512329
loss_pred:0.02562854252755642, decouple_loss:0.008943245746195316
The generated pressure mean: 0.46272012591362
loss_pred:0.0249944981187582, decouple_loss:0.00889111403375864
Iteration: 1262, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4400438964366913
loss_pred:0.024740075692534447, decouple_loss:0.00955578126013279
The generated pressure mean: 0.4365721046924591
loss_pred:0.026057535782456398, decouple_loss:0.009577253833413124
The generated pressure mean: 0.4419570863246918
loss_pred:0.025808585807681084, decouple_loss:0.009456563740968704
Iteration: 1263, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4369988739490509
loss_pred:0.024105332791805267, decouple_loss:0.00848099123686552
The generated pressure mean: 0.444710910320282
The generated pressure mean: 0.4388646185398102
loss_pred:0.025814225897192955, decouple_loss:0.008505160920321941
loss_pred:0.024705279618501663, decouple_loss:0.008275038562715054
Iteration: 1264, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.447906494140625
loss_pred:0.024682719260454178, decouple_loss:0.008744645863771439
The generated pressure mean: 0.44610899686813354
loss_pred:0.02442035637795925, decouple_loss:0.009180605411529541
The generated pressure mean: 0.44338080286979675
loss_pred:0.02378327213227749, decouple_loss:0.009575871750712395
Iteration: 1265, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4468264877796173
loss_pred:0.024096211418509483, decouple_loss:0.007855406031012535
The generated pressure mean: 0.44558262825012207
loss_pred:0.02572637051343918, decouple_loss:0.007854175753891468
The generated pressure mean: 0.44587355852127075
loss_pred:0.025344330817461014, decouple_loss:0.008160552009940147
Iteration: 1266, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4479748010635376
loss_pred:0.024761494249105453, decouple_loss:0.0075564393773674965
The generated pressure mean: 0.45389941334724426
loss_pred:0.02655894309282303, decouple_loss:0.007094157859683037
The generated pressure mean: 0.4511699676513672
loss_pred:0.02341587096452713, decouple_loss:0.007332896813750267
Iteration: 1267, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43438175320625305
loss_pred:0.025511687621474266, decouple_loss:0.007863081060349941
The generated pressure mean: 0.4420212209224701
loss_pred:0.0252493005245924, decouple_loss:0.008664925582706928
The generated pressure mean: 0.4428163766860962
loss_pred:0.025492073968052864, decouple_loss:0.008501144126057625
Iteration: 1268, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4444681406021118
loss_pred:0.025971850380301476, decouple_loss:0.007072982843965292
The generated pressure mean: 0.44474145770072937
loss_pred:0.024895332753658295, decouple_loss:0.00703926058486104
The generated pressure mean: 0.4449111223220825
loss_pred:0.02555612474679947, decouple_loss:0.007206393405795097
Iteration: 1269, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4475506544113159
loss_pred:0.025018567219376564, decouple_loss:0.007656280882656574
The generated pressure mean: 0.44848018884658813
loss_pred:0.024090511724352837, decouple_loss:0.007802396081387997
The generated pressure mean: 0.4464004635810852
loss_pred:0.02526787668466568, decouple_loss:0.00783697422593832
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1270, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4500007927417755
loss_pred:0.023986516520380974, decouple_loss:0.0068315486423671246
The generated pressure mean: 0.4547390639781952
loss_pred:0.025382857769727707, decouple_loss:0.006387660279870033
The generated pressure mean: 0.4516439139842987
loss_pred:0.02474963292479515, decouple_loss:0.006923528853803873
2023-04-16 06:18:35 testing...
The generated pressure mean: 0.41561171412467957
loss_pred:0.03695009648799896, decouple_loss:0.007930749095976353
The generated pressure mean: 0.4241161346435547
loss_pred:0.03508288413286209, decouple_loss:0.008210256695747375
The generated pressure mean: 0.42837443947792053
loss_pred:0.03638175502419472, decouple_loss:0.0084316935390234
Loss: 0.036547791212797165, avg_mse: 0.04941370710730553
current test mse: 0.049414
Iteration: 1271, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4521923065185547
loss_pred:0.025099242106080055, decouple_loss:0.007609073538333178
The generated pressure mean: 0.4540465772151947
loss_pred:0.024244563654065132, decouple_loss:0.007290560286492109
The generated pressure mean: 0.4558461904525757
loss_pred:0.025870317593216896, decouple_loss:0.00749107263982296
Iteration: 1272, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4338752329349518
loss_pred:0.024453824386000633, decouple_loss:0.00795152597129345
The generated pressure mean: 0.43715956807136536
loss_pred:0.025089655071496964, decouple_loss:0.008223949000239372
The generated pressure mean: 0.4379579722881317
loss_pred:0.02375181019306183, decouple_loss:0.007804746273905039
Iteration: 1273, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43674585223197937
loss_pred:0.02400277741253376, decouple_loss:0.009019855409860611
The generated pressure mean: 0.44005993008613586
loss_pred:0.02556874044239521, decouple_loss:0.00942917075008154
The generated pressure mean: 0.4353361129760742
loss_pred:0.024920424446463585, decouple_loss:0.009636026807129383
Iteration: 1274, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44963642954826355
loss_pred:0.02664809860289097, decouple_loss:0.00783293042331934
The generated pressure mean: 0.4502623975276947
loss_pred:0.02576318569481373, decouple_loss:0.007718605920672417
The generated pressure mean: 0.4443065822124481
loss_pred:0.025348559021949768, decouple_loss:0.007429908961057663
Iteration: 1275, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4531097412109375
loss_pred:0.024696752429008484, decouple_loss:0.009071371518075466
The generated pressure mean: 0.45192068815231323
loss_pred:0.024814311414957047, decouple_loss:0.008774865418672562
The generated pressure mean: 0.45175278186798096
loss_pred:0.02394062466919422, decouple_loss:0.008988539688289165
Iteration: 1276, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43956252932548523
loss_pred:0.025610676035284996, decouple_loss:0.007194614503532648
The generated pressure mean: 0.44757652282714844
loss_pred:0.02641369216144085, decouple_loss:0.006643190979957581
The generated pressure mean: 0.4418109059333801
loss_pred:0.025697609409689903, decouple_loss:0.007051736582070589
Iteration: 1277, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44727960228919983
loss_pred:0.024961533024907112, decouple_loss:0.006971881724894047
The generated pressure mean: 0.447858989238739
loss_pred:0.024462798610329628, decouple_loss:0.0071292477659881115
The generated pressure mean: 0.45010924339294434
loss_pred:0.02570880763232708, decouple_loss:0.006982691586017609
Iteration: 1278, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4494978189468384
loss_pred:0.024661073461174965, decouple_loss:0.005632581189274788
The generated pressure mean: 0.44788146018981934
loss_pred:0.02460234984755516, decouple_loss:0.005679106339812279
The generated pressure mean: 0.4462921917438507
loss_pred:0.0240426454693079, decouple_loss:0.005851732566952705
Iteration: 1279, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4559958875179291
The generated pressure mean: 0.4438217878341675
loss_pred:0.025553617626428604, decouple_loss:0.007831639610230923
loss_pred:0.026003597304224968, decouple_loss:0.007863491773605347
The generated pressure mean: 0.44919252395629883
loss_pred:0.02475956827402115, decouple_loss:0.007936635985970497
Iteration: 1280, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43762096762657166
loss_pred:0.02593257464468479, decouple_loss:0.0073149423114955425
The generated pressure mean: 0.4356224834918976
loss_pred:0.025316022336483, decouple_loss:0.006874908693134785
The generated pressure mean: 0.43202313780784607
loss_pred:0.02441711723804474, decouple_loss:0.007440217304974794
2023-04-16 06:20:35 testing...
The generated pressure mean: 0.4207899570465088
loss_pred:0.03660052642226219, decouple_loss:0.008471749722957611
The generated pressure mean: 0.4315013587474823
loss_pred:0.03540026769042015, decouple_loss:0.008706544525921345
The generated pressure mean: 0.43621355295181274
loss_pred:0.03587360680103302, decouple_loss:0.008871745318174362
Loss: 0.03639230132102966, avg_mse: 0.049711696803569794
current test mse: 0.049712
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012014_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012014_3_24hr.npz
NaN value num: 0
Iteration: 1281, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44449853897094727
loss_pred:0.025123830884695053, decouple_loss:0.00796723086386919
The generated pressure mean: 0.44177770614624023
loss_pred:0.024687647819519043, decouple_loss:0.008333703503012657
The generated pressure mean: 0.44435468316078186
loss_pred:0.025557445362210274, decouple_loss:0.008491436950862408
Iteration: 1282, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45253121852874756
loss_pred:0.024572283029556274, decouple_loss:0.006949395406991243
The generated pressure mean: 0.45123183727264404
loss_pred:0.024009957909584045, decouple_loss:0.007204519584774971
The generated pressure mean: 0.45305654406547546
loss_pred:0.028244877234101295, decouple_loss:0.00800879206508398
Iteration: 1283, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4461110532283783
loss_pred:0.02424236759543419, decouple_loss:0.008136827498674393
The generated pressure mean: 0.44801822304725647
loss_pred:0.023852918297052383, decouple_loss:0.007794360164552927
The generated pressure mean: 0.44673392176628113
loss_pred:0.02423247881233692, decouple_loss:0.008211441338062286
Iteration: 1284, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44402623176574707
loss_pred:0.025681721046566963, decouple_loss:0.007240666076540947
The generated pressure mean: 0.4398079216480255
loss_pred:0.02471045032143593, decouple_loss:0.006892668083310127
The generated pressure mean: 0.4400964677333832
loss_pred:0.025220533832907677, decouple_loss:0.006964813452214003
Iteration: 1285, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4524584114551544
loss_pred:0.02461443468928337, decouple_loss:0.00747648673132062
The generated pressure mean: 0.45138639211654663
loss_pred:0.02444407343864441, decouple_loss:0.00803728960454464
The generated pressure mean: 0.4554082155227661
loss_pred:0.023587094619870186, decouple_loss:0.00746225006878376
Iteration: 1286, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4508776366710663
loss_pred:0.025037245824933052, decouple_loss:0.00846517737954855
The generated pressure mean: 0.4455353021621704
loss_pred:0.026657480746507645, decouple_loss:0.008606340736150742
The generated pressure mean: 0.44746479392051697
loss_pred:0.024761470034718513, decouple_loss:0.00913919135928154
Iteration: 1287, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43130624294281006
loss_pred:0.02483351342380047, decouple_loss:0.008088620379567146
The generated pressure mean: 0.43005505204200745
loss_pred:0.024191146716475487, decouple_loss:0.008011452853679657
The generated pressure mean: 0.43565094470977783
loss_pred:0.025611456483602524, decouple_loss:0.007908610627055168
Iteration: 1288, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46927303075790405
loss_pred:0.026257548481225967, decouple_loss:0.008938093669712543
The generated pressure mean: 0.4640582799911499
loss_pred:0.023795709013938904, decouple_loss:0.009058661758899689
The generated pressure mean: 0.4674549102783203
loss_pred:0.02436733990907669, decouple_loss:0.009059341624379158
Iteration: 1289, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44993916153907776
loss_pred:0.0244656540453434, decouple_loss:0.00834044348448515
The generated pressure mean: 0.4462278485298157
loss_pred:0.02672545798122883, decouple_loss:0.008905536495149136
The generated pressure mean: 0.44812366366386414
loss_pred:0.02519882842898369, decouple_loss:0.008495239540934563
Iteration: 1290, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43239814043045044
The generated pressure mean: 0.427493155002594
loss_pred:0.02533862367272377, decouple_loss:0.009862365201115608
loss_pred:0.024965036660432816, decouple_loss:0.010075653903186321
The generated pressure mean: 0.43210074305534363
loss_pred:0.024879397824406624, decouple_loss:0.009841647930443287
2023-04-16 06:23:10 testing...
The generated pressure mean: 0.4194487929344177
loss_pred:0.03761162981390953, decouple_loss:0.008940444327890873
The generated pressure mean: 0.42835891246795654
loss_pred:0.03634718805551529, decouple_loss:0.009051104076206684
The generated pressure mean: 0.4338963031768799
loss_pred:0.03747022524476051, decouple_loss:0.00932080578058958
Loss: 0.037598222494125366, avg_mse: 0.05081746354699135
current test mse: 0.050817
Iteration: 1291, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44153615832328796
loss_pred:0.02374934032559395, decouple_loss:0.007566878106445074
The generated pressure mean: 0.4432857930660248
loss_pred:0.024056103080511093, decouple_loss:0.008328007534146309
The generated pressure mean: 0.4446086287498474
loss_pred:0.027401722967624664, decouple_loss:0.0074708471074700356
Iteration: 1292, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45369312167167664
loss_pred:0.02465546689927578, decouple_loss:0.009769094176590443
The generated pressure mean: 0.46070680022239685
loss_pred:0.026072297245264053, decouple_loss:0.009309585206210613
The generated pressure mean: 0.45694437623023987
loss_pred:0.025450920686125755, decouple_loss:0.009338241070508957
Iteration: 1293, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4601312577724457
loss_pred:0.02507343329489231, decouple_loss:0.009480822831392288
The generated pressure mean: 0.45174580812454224
loss_pred:0.023754050955176353, decouple_loss:0.009101479314267635
The generated pressure mean: 0.4549797475337982
loss_pred:0.02582298032939434, decouple_loss:0.009243639186024666
Iteration: 1294, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43950048089027405
The generated pressure mean: 0.441292941570282
loss_pred:0.02417849190533161, decouple_loss:0.008897971361875534
loss_pred:0.024932803586125374, decouple_loss:0.008071957156062126
The generated pressure mean: 0.4442756175994873
loss_pred:0.02518395148217678, decouple_loss:0.008180071599781513
Iteration: 1295, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4477525055408478
loss_pred:0.026224002242088318, decouple_loss:0.00782695971429348
The generated pressure mean: 0.4504089653491974
loss_pred:0.026293868198990822, decouple_loss:0.007497956044971943
The generated pressure mean: 0.447724848985672
loss_pred:0.02469431422650814, decouple_loss:0.007417888380587101
Iteration: 1296, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43549272418022156
loss_pred:0.025318214669823647, decouple_loss:0.00858744140714407
The generated pressure mean: 0.4407028257846832
loss_pred:0.02579064480960369, decouple_loss:0.008898920379579067
The generated pressure mean: 0.4367460608482361
loss_pred:0.02393968775868416, decouple_loss:0.008618628606200218
Iteration: 1297, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4455838203430176
loss_pred:0.025802867487072945, decouple_loss:0.0072687771171331406
The generated pressure mean: 0.4368886947631836
loss_pred:0.02510090544819832, decouple_loss:0.007443144917488098
The generated pressure mean: 0.4438134729862213
loss_pred:0.025422239676117897, decouple_loss:0.007372425869107246
Iteration: 1298, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.459419846534729
loss_pred:0.02583233267068863, decouple_loss:0.00850837491452694
The generated pressure mean: 0.45953282713890076
loss_pred:0.025204243138432503, decouple_loss:0.00829977449029684
The generated pressure mean: 0.4524981379508972
loss_pred:0.02461792342364788, decouple_loss:0.008462770842015743
Iteration: 1299, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4475623071193695
loss_pred:0.02413802035152912, decouple_loss:0.007051710970699787
The generated pressure mean: 0.4454951584339142
loss_pred:0.023994257673621178, decouple_loss:0.006986175198107958
The generated pressure mean: 0.4493658244609833
loss_pred:0.025914613157510757, decouple_loss:0.007064174860715866
Iteration: 1300, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4408460259437561
The generated pressure mean: 0.43893125653266907
loss_pred:0.024566585198044777, decouple_loss:0.009578420780599117
loss_pred:0.02472149021923542, decouple_loss:0.009221324697136879
The generated pressure mean: 0.4407831132411957
loss_pred:0.025852898135781288, decouple_loss:0.009382553398609161
2023-04-16 06:25:11 testing...
The generated pressure mean: 0.41871777176856995
loss_pred:0.03780744969844818, decouple_loss:0.010597852990031242
The generated pressure mean: 0.42800331115722656
loss_pred:0.03704046830534935, decouple_loss:0.010507876984775066
The generated pressure mean: 0.43308234214782715
loss_pred:0.03715365380048752, decouple_loss:0.01102136168628931
Loss: 0.03786931186914444, avg_mse: 0.05130337178707123
current test mse: 0.051303
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012017_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012017_3_24hr.npz
NaN value num: 0
Iteration: 1301, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4468044340610504
loss_pred:0.02544773370027542, decouple_loss:0.010269983671605587
The generated pressure mean: 0.44810983538627625
loss_pred:0.025383034721016884, decouple_loss:0.01028367504477501
The generated pressure mean: 0.45171311497688293
loss_pred:0.025639843195676804, decouple_loss:0.010057993233203888
Iteration: 1302, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44798964262008667
loss_pred:0.025624515488743782, decouple_loss:0.008744833990931511
The generated pressure mean: 0.4493336081504822
loss_pred:0.025483693927526474, decouple_loss:0.008955012075603008
The generated pressure mean: 0.45503321290016174
loss_pred:0.024567700922489166, decouple_loss:0.008483480662107468
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1303, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44629985094070435
loss_pred:0.02448432147502899, decouple_loss:0.009119715541601181The generated pressure mean: 0.4453407824039459
loss_pred:0.02489732950925827, decouple_loss:0.008947046473622322
The generated pressure mean: 0.44717490673065186
loss_pred:0.02499282918870449, decouple_loss:0.008673891425132751
Iteration: 1304, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44891202449798584
The generated pressure mean: 0.44091129302978516
loss_pred:0.025632327422499657, decouple_loss:0.008176862262189388
loss_pred:0.025164304301142693, decouple_loss:0.008025829680263996
The generated pressure mean: 0.439382404088974
loss_pred:0.023988572880625725, decouple_loss:0.008380505256354809
Iteration: 1305, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44941356778144836
loss_pred:0.0258262250572443, decouple_loss:0.008543966338038445
The generated pressure mean: 0.4498094916343689
loss_pred:0.024876298382878304, decouple_loss:0.008327214047312737
The generated pressure mean: 0.45207515358924866
loss_pred:0.02544897422194481, decouple_loss:0.008346772752702236
Iteration: 1306, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4418589174747467
loss_pred:0.025440404191613197, decouple_loss:0.009178626351058483
The generated pressure mean: 0.4427260756492615
loss_pred:0.02508225478231907, decouple_loss:0.009032811038196087
The generated pressure mean: 0.44357943534851074
loss_pred:0.026895157992839813, decouple_loss:0.00911471527069807
Iteration: 1307, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45419424772262573
loss_pred:0.024836581200361252, decouple_loss:0.008464801125228405
The generated pressure mean: 0.4571467638015747
loss_pred:0.02402167022228241, decouple_loss:0.008069801144301891
The generated pressure mean: 0.4542285203933716
loss_pred:0.024454869329929352, decouple_loss:0.008212205953896046
Iteration: 1308, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4486694931983948
The generated pressure mean: 0.4511755704879761
loss_pred:0.026477200910449028, decouple_loss:0.008941732347011566
loss_pred:0.025972459465265274, decouple_loss:0.009185775183141232
The generated pressure mean: 0.45012393593788147
loss_pred:0.02575378678739071, decouple_loss:0.009426678530871868
Iteration: 1309, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4310935139656067
loss_pred:0.023848848417401314, decouple_loss:0.007666326127946377
The generated pressure mean: 0.4236624240875244
loss_pred:0.025439640507102013, decouple_loss:0.007857536897063255
The generated pressure mean: 0.43209320306777954
loss_pred:0.02461376041173935, decouple_loss:0.007750359363853931
Iteration: 1310, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4510710537433624
loss_pred:0.024365659803152084, decouple_loss:0.0085346894338727
The generated pressure mean: 0.44909995794296265
loss_pred:0.02457853965461254, decouple_loss:0.008654262870550156
The generated pressure mean: 0.4466392695903778
loss_pred:0.02468891628086567, decouple_loss:0.008741341531276703
2023-04-16 06:27:50 testing...
The generated pressure mean: 0.4159439206123352
loss_pred:0.03833717107772827, decouple_loss:0.008559689857065678
The generated pressure mean: 0.42348840832710266
loss_pred:0.037623606622219086, decouple_loss:0.008817790076136589
The generated pressure mean: 0.42767852544784546
loss_pred:0.037533823400735855, decouple_loss:0.009130148217082024
Loss: 0.03827332705259323, avg_mse: 0.05240391939878464
current test mse: 0.052404
Iteration: 1311, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45978593826293945
loss_pred:0.025418367236852646, decouple_loss:0.007977153174579144
The generated pressure mean: 0.4625953435897827
loss_pred:0.025451824069023132, decouple_loss:0.00807890947908163
The generated pressure mean: 0.4617975950241089
loss_pred:0.023665400221943855, decouple_loss:0.008080992847681046
Iteration: 1312, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44380655884742737
loss_pred:0.024752452969551086, decouple_loss:0.008715194649994373
The generated pressure mean: 0.4448474049568176
The generated pressure mean: 0.4456893801689148loss_pred:0.02367236651480198, decouple_loss:0.008416319265961647
loss_pred:0.024320438504219055, decouple_loss:0.008571046404540539
Iteration: 1313, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4365035891532898
loss_pred:0.025161897763609886, decouple_loss:0.008303560316562653
The generated pressure mean: 0.43859437108039856
loss_pred:0.025876788422465324, decouple_loss:0.008306581526994705
The generated pressure mean: 0.43835166096687317
loss_pred:0.02386115863919258, decouple_loss:0.008121526800096035
Iteration: 1314, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45258620381355286
loss_pred:0.024909986183047295, decouple_loss:0.008201364427804947
The generated pressure mean: 0.45571157336235046
loss_pred:0.02344413660466671, decouple_loss:0.008075247518718243
The generated pressure mean: 0.45258596539497375
loss_pred:0.025553153827786446, decouple_loss:0.00844512041658163
Iteration: 1315, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44716447591781616
loss_pred:0.025172360241413116, decouple_loss:0.007524668704718351
The generated pressure mean: 0.4449705481529236
loss_pred:0.024315297603607178, decouple_loss:0.00748320622369647
The generated pressure mean: 0.44720032811164856
loss_pred:0.0261102132499218, decouple_loss:0.007309255190193653
Iteration: 1316, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44740983843803406
loss_pred:0.025147361680865288, decouple_loss:0.007620745338499546
The generated pressure mean: 0.4424927830696106
loss_pred:0.023974960669875145, decouple_loss:0.007818365469574928
The generated pressure mean: 0.44570204615592957
loss_pred:0.024852335453033447, decouple_loss:0.007955833338201046
Iteration: 1317, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4494732618331909
loss_pred:0.023818334564566612, decouple_loss:0.007605267688632011
The generated pressure mean: 0.45260536670684814
loss_pred:0.023984944447875023, decouple_loss:0.007340631913393736
The generated pressure mean: 0.45355990529060364
loss_pred:0.02535564824938774, decouple_loss:0.007196712773293257
Iteration: 1318, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44989699125289917
loss_pred:0.023342475295066833, decouple_loss:0.007514969911426306
The generated pressure mean: 0.44956544041633606
loss_pred:0.024303404614329338, decouple_loss:0.007830582559108734
The generated pressure mean: 0.4488518536090851
loss_pred:0.024181319400668144, decouple_loss:0.00768829882144928
Iteration: 1319, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4451771080493927
loss_pred:0.02324928529560566, decouple_loss:0.007875602692365646
The generated pressure mean: 0.4416702091693878
loss_pred:0.02528894878923893, decouple_loss:0.007448614574968815
The generated pressure mean: 0.44415804743766785
loss_pred:0.024141641333699226, decouple_loss:0.0070804087445139885
Iteration: 1320, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4544454514980316
loss_pred:0.02522444725036621, decouple_loss:0.0071658361703157425
The generated pressure mean: 0.45425352454185486
loss_pred:0.024635424837470055, decouple_loss:0.007275913376361132
The generated pressure mean: 0.4520764648914337
loss_pred:0.023607363924384117, decouple_loss:0.007639906369149685
2023-04-16 06:29:51 testing...
The generated pressure mean: 0.41965609788894653
loss_pred:0.03640277683734894, decouple_loss:0.007320908363908529
The generated pressure mean: 0.42731818556785583
loss_pred:0.03489792346954346, decouple_loss:0.007571596652269363
The generated pressure mean: 0.4323539733886719
loss_pred:0.03592963516712189, decouple_loss:0.007621629163622856
Loss: 0.036118682473897934, avg_mse: 0.04905208200216293
current test mse: 0.049052
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012018_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012018_3_24hr.npz
NaN value num: 0
Iteration: 1321, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4425615668296814
loss_pred:0.024282531812787056, decouple_loss:0.006770240142941475
The generated pressure mean: 0.446275532245636
loss_pred:0.023889673873782158, decouple_loss:0.006803110241889954The generated pressure mean: 0.44334402680397034
loss_pred:0.024660665541887283, decouple_loss:0.006873144302517176
Iteration: 1322, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4367828667163849
loss_pred:0.023345941677689552, decouple_loss:0.007118601351976395
The generated pressure mean: 0.44367170333862305
loss_pred:0.023842856287956238, decouple_loss:0.007049208972603083
The generated pressure mean: 0.4399583041667938
loss_pred:0.024303359910845757, decouple_loss:0.00694245332852006
Iteration: 1323, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4480574131011963
loss_pred:0.02416166290640831, decouple_loss:0.007692784536629915
The generated pressure mean: 0.4445115923881531
loss_pred:0.02393096499145031, decouple_loss:0.007327044848352671
The generated pressure mean: 0.4471796452999115
loss_pred:0.023181181401014328, decouple_loss:0.007353425957262516
Iteration: 1324, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46012380719184875
loss_pred:0.02495013363659382, decouple_loss:0.0076691326685249805
The generated pressure mean: 0.4579067826271057
loss_pred:0.02562176249921322, decouple_loss:0.007260840851813555
The generated pressure mean: 0.4621453285217285
loss_pred:0.02405405417084694, decouple_loss:0.007142682559788227
Iteration: 1325, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4344213902950287
loss_pred:0.024546921253204346, decouple_loss:0.007786210160702467
The generated pressure mean: 0.43674206733703613
loss_pred:0.024201389402151108, decouple_loss:0.008309279568493366
The generated pressure mean: 0.43617910146713257
loss_pred:0.024034688249230385, decouple_loss:0.0077906446531414986
Iteration: 1326, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43955495953559875
loss_pred:0.022967224940657616, decouple_loss:0.007835647091269493
The generated pressure mean: 0.43871697783470154
loss_pred:0.024151701480150223, decouple_loss:0.008029566146433353
The generated pressure mean: 0.43769049644470215
loss_pred:0.024913346394896507, decouple_loss:0.007832693867385387
Iteration: 1327, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46102267503738403
loss_pred:0.024520045146346092, decouple_loss:0.006972748786211014
The generated pressure mean: 0.46251052618026733
loss_pred:0.024533623829483986, decouple_loss:0.007062072400003672
The generated pressure mean: 0.4635661542415619
loss_pred:0.024741219356656075, decouple_loss:0.006911871023476124
Iteration: 1328, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45534756779670715
loss_pred:0.02451210469007492, decouple_loss:0.00719986530020833
The generated pressure mean: 0.4588938355445862
loss_pred:0.02517712488770485, decouple_loss:0.0070758117362856865
The generated pressure mean: 0.45402389764785767
loss_pred:0.023763485252857208, decouple_loss:0.007122617214918137
Iteration: 1329, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4398149251937866
loss_pred:0.02394445613026619, decouple_loss:0.007996708154678345
The generated pressure mean: 0.43659132719039917
loss_pred:0.02502589114010334, decouple_loss:0.007548918016254902
The generated pressure mean: 0.43860793113708496
loss_pred:0.023602383211255074, decouple_loss:0.008294086903333664
Iteration: 1330, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.435446560382843
loss_pred:0.02285292185842991, decouple_loss:0.006994095165282488
The generated pressure mean: 0.4398970305919647
loss_pred:0.023777782917022705, decouple_loss:0.007209038361907005
The generated pressure mean: 0.43235528469085693
loss_pred:0.02440662309527397, decouple_loss:0.006942068226635456
2023-04-16 06:32:26 testing...
The generated pressure mean: 0.41659945249557495
loss_pred:0.03716430440545082, decouple_loss:0.007325786165893078
The generated pressure mean: 0.4243210554122925
loss_pred:0.036922603845596313, decouple_loss:0.0075674764811992645
The generated pressure mean: 0.42830756306648254
loss_pred:0.03691617771983147, decouple_loss:0.007814641110599041
Loss: 0.03737949579954147, avg_mse: 0.051483672112226486
current test mse: 0.051484
Iteration: 1331, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45670756697654724
The generated pressure mean: 0.4530443251132965loss_pred:0.024309318512678146, decouple_loss:0.006399230565875769
loss_pred:0.023633290082216263, decouple_loss:0.006503002252429724
The generated pressure mean: 0.4567651152610779
loss_pred:0.02419300377368927, decouple_loss:0.0066433437168598175
Iteration: 1332, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45724043250083923The generated pressure mean: 0.4545692801475525
loss_pred:0.024361927062273026, decouple_loss:0.006168055813759565
loss_pred:0.023903757333755493, decouple_loss:0.006013565696775913
The generated pressure mean: 0.45588362216949463
loss_pred:0.023784924298524857, decouple_loss:0.005941875744611025
Iteration: 1333, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4512554705142975
loss_pred:0.02520308829843998, decouple_loss:0.006279429886490107
The generated pressure mean: 0.44935378432273865
loss_pred:0.023609261959791183, decouple_loss:0.006562445778399706
The generated pressure mean: 0.45313167572021484
loss_pred:0.02486981451511383, decouple_loss:0.006622285582125187
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1334, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43894726037979126
loss_pred:0.02456691861152649, decouple_loss:0.006172792986035347
The generated pressure mean: 0.43600839376449585
loss_pred:0.02452118881046772, decouple_loss:0.00589853385463357
The generated pressure mean: 0.43511050939559937
loss_pred:0.022772425785660744, decouple_loss:0.006301082670688629
Iteration: 1335, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4382704794406891
loss_pred:0.0253696758300066, decouple_loss:0.006603775080293417
The generated pressure mean: 0.4444728493690491
loss_pred:0.02409675531089306, decouple_loss:0.0064551918767392635
The generated pressure mean: 0.43976613879203796
loss_pred:0.023708678781986237, decouple_loss:0.006438955664634705
Iteration: 1336, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45869550108909607
The generated pressure mean: 0.4569571912288666
loss_pred:0.023107072338461876, decouple_loss:0.0066460431553423405
loss_pred:0.024337418377399445, decouple_loss:0.0069196512922644615
The generated pressure mean: 0.4564809203147888
loss_pred:0.023106815293431282, decouple_loss:0.006944320630282164
Iteration: 1337, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44958361983299255
loss_pred:0.024302296340465546, decouple_loss:0.007055636961013079
The generated pressure mean: 0.452875554561615
loss_pred:0.023004665970802307, decouple_loss:0.00667594326660037
The generated pressure mean: 0.45332810282707214
loss_pred:0.02476099506020546, decouple_loss:0.006699569523334503
Iteration: 1338, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4430709183216095
loss_pred:0.02537892945110798, decouple_loss:0.00744810001924634
The generated pressure mean: 0.44072791934013367
loss_pred:0.023849012330174446, decouple_loss:0.0074576763436198235
The generated pressure mean: 0.4420791268348694
loss_pred:0.025523049756884575, decouple_loss:0.007459535729140043
Iteration: 1339, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44882580637931824
loss_pred:0.024154558777809143, decouple_loss:0.007202917244285345
The generated pressure mean: 0.4501408636569977
loss_pred:0.02573721669614315, decouple_loss:0.006902174558490515
The generated pressure mean: 0.4499514102935791
loss_pred:0.023339910432696342, decouple_loss:0.007028498221188784
Iteration: 1340, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4356868267059326
loss_pred:0.02385663241147995, decouple_loss:0.007247032597661018
The generated pressure mean: 0.43451616168022156
loss_pred:0.024560624733567238, decouple_loss:0.00742867449298501
The generated pressure mean: 0.4404732286930084
loss_pred:0.024267973378300667, decouple_loss:0.007193268276751041
2023-04-16 06:34:26 testing...
The generated pressure mean: 0.4191453456878662
loss_pred:0.03664480522274971, decouple_loss:0.008487038314342499
The generated pressure mean: 0.42872539162635803
loss_pred:0.036073118448257446, decouple_loss:0.008765391074120998
The generated pressure mean: 0.4347529113292694
loss_pred:0.035779330879449844, decouple_loss:0.009018290787935257
Loss: 0.036603596061468124, avg_mse: 0.0502542182803154
current test mse: 0.050254
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012011_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012011_3_24hr.npz
NaN value num: 0
Iteration: 1341, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.452302485704422
loss_pred:0.02304370142519474, decouple_loss:0.007685298565775156
The generated pressure mean: 0.45123106241226196
loss_pred:0.024428443983197212, decouple_loss:0.008876016363501549
The generated pressure mean: 0.4526521861553192
loss_pred:0.023064766079187393, decouple_loss:0.00804874487221241
Iteration: 1342, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4621638357639313
loss_pred:0.024669399484992027, decouple_loss:0.007411011960357428
The generated pressure mean: 0.4616551101207733
loss_pred:0.02272041141986847, decouple_loss:0.007476072292774916
The generated pressure mean: 0.4652109742164612
loss_pred:0.023940399289131165, decouple_loss:0.007426201831549406
Iteration: 1343, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43693968653678894
loss_pred:0.022652562707662582, decouple_loss:0.0071973176673054695
The generated pressure mean: 0.44691136479377747
loss_pred:0.022221170365810394, decouple_loss:0.00757463788613677
The generated pressure mean: 0.4362284243106842
loss_pred:0.025541704148054123, decouple_loss:0.007561886217445135
Iteration: 1344, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4271146357059479
loss_pred:0.02405194565653801, decouple_loss:0.006719648838043213
The generated pressure mean: 0.4300898611545563
loss_pred:0.02375389076769352, decouple_loss:0.006290011573582888
The generated pressure mean: 0.4308386743068695
loss_pred:0.02460665814578533, decouple_loss:0.006562901195138693
Iteration: 1345, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45836764574050903
loss_pred:0.023004906252026558, decouple_loss:0.007257563527673483
The generated pressure mean: 0.45801180601119995
loss_pred:0.022802989929914474, decouple_loss:0.0076066842302680016
The generated pressure mean: 0.460742712020874
loss_pred:0.023484179750084877, decouple_loss:0.007523632608354092
Iteration: 1346, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45688340067863464
loss_pred:0.0237883310765028, decouple_loss:0.007555573247373104
The generated pressure mean: 0.4568181335926056
loss_pred:0.025030050426721573, decouple_loss:0.007687856443226337
The generated pressure mean: 0.4566851556301117
loss_pred:0.024623747915029526, decouple_loss:0.007564036641269922
Iteration: 1347, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4314507842063904
loss_pred:0.02512582391500473, decouple_loss:0.007837054319679737
The generated pressure mean: 0.4315829575061798
loss_pred:0.024585256353020668, decouple_loss:0.007229412905871868
The generated pressure mean: 0.43269073963165283
loss_pred:0.024140890687704086, decouple_loss:0.007196133024990559
Iteration: 1348, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4502481520175934
The generated pressure mean: 0.4504663944244385
loss_pred:0.02410074695944786, decouple_loss:0.006498999893665314
loss_pred:0.023738160729408264, decouple_loss:0.007463585585355759
The generated pressure mean: 0.4480377435684204
loss_pred:0.023976584896445274, decouple_loss:0.006293714977800846
Iteration: 1349, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45598089694976807
loss_pred:0.02411983720958233, decouple_loss:0.007006510626524687
The generated pressure mean: 0.45280757546424866
loss_pred:0.023709002882242203, decouple_loss:0.007620212621986866
The generated pressure mean: 0.4580058157444
loss_pred:0.02361954003572464, decouple_loss:0.007081056945025921
Iteration: 1350, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4465997815132141
loss_pred:0.02338823303580284, decouple_loss:0.007127551827579737
The generated pressure mean: 0.4471856355667114
loss_pred:0.023067539557814598, decouple_loss:0.007326085120439529
The generated pressure mean: 0.4500499367713928
loss_pred:0.023929933086037636, decouple_loss:0.00741235027089715
2023-04-16 06:37:02 testing...
The generated pressure mean: 0.42473483085632324
loss_pred:0.03643666207790375, decouple_loss:0.007916746661067009
The generated pressure mean: 0.43413686752319336
loss_pred:0.035167135298252106, decouple_loss:0.008134880103170872
The generated pressure mean: 0.44077715277671814
loss_pred:0.035769686102867126, decouple_loss:0.008455873467028141
Loss: 0.036199621856212616, avg_mse: 0.049519337713718414
current test mse: 0.049519
Iteration: 1351, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43373963236808777
loss_pred:0.023900406435132027, decouple_loss:0.007202942855656147
The generated pressure mean: 0.43070897459983826
loss_pred:0.027202820405364037, decouple_loss:0.007255008444190025
The generated pressure mean: 0.43100056052207947
loss_pred:0.023169176653027534, decouple_loss:0.007166792638599873
Iteration: 1352, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46347835659980774
loss_pred:0.024084247648715973, decouple_loss:0.007077149115502834The generated pressure mean: 0.46302175521850586
loss_pred:0.023896444588899612, decouple_loss:0.007218480110168457
The generated pressure mean: 0.4636891782283783
loss_pred:0.023865586146712303, decouple_loss:0.007202027831226587
Iteration: 1353, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45176419615745544
loss_pred:0.02303546480834484, decouple_loss:0.00753143522888422
The generated pressure mean: 0.4516993463039398
loss_pred:0.024888474494218826, decouple_loss:0.007629536557942629
The generated pressure mean: 0.4515072703361511
loss_pred:0.023738600313663483, decouple_loss:0.007762725930660963
Iteration: 1354, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4290347993373871
loss_pred:0.02325703576207161, decouple_loss:0.006923204753547907
The generated pressure mean: 0.43095386028289795
loss_pred:0.023460136726498604, decouple_loss:0.007163556758314371
The generated pressure mean: 0.42871972918510437
loss_pred:0.02429807372391224, decouple_loss:0.007553874980658293
Iteration: 1355, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4478169083595276
loss_pred:0.024281207472085953, decouple_loss:0.006865377072244883
The generated pressure mean: 0.44475817680358887
loss_pred:0.02373814582824707, decouple_loss:0.007251732982695103
The generated pressure mean: 0.44749876856803894
loss_pred:0.02341831661760807, decouple_loss:0.007342174649238586
Iteration: 1356, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4578201472759247
loss_pred:0.02278760075569153, decouple_loss:0.007602743338793516
The generated pressure mean: 0.4571967124938965
loss_pred:0.024990331381559372, decouple_loss:0.00792656373232603
The generated pressure mean: 0.46209123730659485
loss_pred:0.025767983868718147, decouple_loss:0.007429761812090874
Iteration: 1357, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44741344451904297
loss_pred:0.02457505278289318, decouple_loss:0.006747437175363302
The generated pressure mean: 0.44389551877975464
loss_pred:0.022820623591542244, decouple_loss:0.00649654446169734
The generated pressure mean: 0.4458843171596527
loss_pred:0.02414022572338581, decouple_loss:0.007029658183455467
Iteration: 1358, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4412166476249695
loss_pred:0.024585502222180367, decouple_loss:0.006629806477576494
The generated pressure mean: 0.4411284029483795
loss_pred:0.022996915504336357, decouple_loss:0.0074280668050050735
The generated pressure mean: 0.44258299469947815
loss_pred:0.023537077009677887, decouple_loss:0.006753412541002035
Iteration: 1359, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4421186149120331
loss_pred:0.02500150166451931, decouple_loss:0.006934506818652153
The generated pressure mean: 0.4429693818092346
loss_pred:0.023075653240084648, decouple_loss:0.006484726443886757
The generated pressure mean: 0.44203540682792664
loss_pred:0.022952251136302948, decouple_loss:0.00646724458783865
Iteration: 1360, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45795032382011414
loss_pred:0.023490063846111298, decouple_loss:0.007474460173398256
The generated pressure mean: 0.45004910230636597
loss_pred:0.02441006526350975, decouple_loss:0.007287933025509119
The generated pressure mean: 0.45101630687713623
loss_pred:0.025306859984993935, decouple_loss:0.007234999909996986
2023-04-16 06:39:03 testing...
The generated pressure mean: 0.4189545512199402
loss_pred:0.03742388263344765, decouple_loss:0.007520423270761967
The generated pressure mean: 0.42660772800445557
loss_pred:0.03618689626455307, decouple_loss:0.007742386311292648
The generated pressure mean: 0.4331504702568054
loss_pred:0.03668393939733505, decouple_loss:0.00797753781080246
Loss: 0.0371522456407547, avg_mse: 0.05161872133612633
current test mse: 0.051619
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012005_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012005_3_24hr.npz
NaN value num: 0
Iteration: 1361, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44787317514419556
loss_pred:0.023060239851474762, decouple_loss:0.006662321742624044
The generated pressure mean: 0.4530287981033325
loss_pred:0.024544382467865944, decouple_loss:0.006616394501179457
The generated pressure mean: 0.45764926075935364
loss_pred:0.021784059703350067, decouple_loss:0.006944982800632715
Iteration: 1362, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.441621869802475
loss_pred:0.02278851717710495, decouple_loss:0.006891060154885054
The generated pressure mean: 0.4468230605125427
loss_pred:0.024963263422250748, decouple_loss:0.006972933653742075
The generated pressure mean: 0.443204790353775
loss_pred:0.02236466482281685, decouple_loss:0.006821649149060249
Iteration: 1363, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4395391047000885
loss_pred:0.024706728756427765, decouple_loss:0.006691215094178915
The generated pressure mean: 0.44418829679489136
loss_pred:0.022056519985198975, decouple_loss:0.006729619577527046
The generated pressure mean: 0.4417821764945984
loss_pred:0.022312883287668228, decouple_loss:0.006593707948923111
Iteration: 1364, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45921602845191956
loss_pred:0.024422796443104744, decouple_loss:0.0066665769554674625
The generated pressure mean: 0.4590679407119751
loss_pred:0.02366974577307701, decouple_loss:0.006695766933262348
The generated pressure mean: 0.4632675051689148
loss_pred:0.023355521261692047, decouple_loss:0.0061105648055672646
Iteration: 1365, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4515291154384613
loss_pred:0.023444481194019318, decouple_loss:0.007340035401284695
The generated pressure mean: 0.4468156695365906
loss_pred:0.02404746599495411, decouple_loss:0.00703217601403594
The generated pressure mean: 0.45536544919013977
loss_pred:0.0224448274821043, decouple_loss:0.007394612301141024
Iteration: 1366, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4403407573699951
loss_pred:0.022860215976834297, decouple_loss:0.00884435698390007
The generated pressure mean: 0.443191796541214
loss_pred:0.022906506434082985, decouple_loss:0.009121956303715706
The generated pressure mean: 0.4375619888305664
loss_pred:0.022058388218283653, decouple_loss:0.008723645471036434
Iteration: 1367, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44262388348579407
loss_pred:0.02289089560508728, decouple_loss:0.006672183517366648
The generated pressure mean: 0.4421067535877228
loss_pred:0.024458806961774826, decouple_loss:0.0066301594488322735
The generated pressure mean: 0.43921470642089844
loss_pred:0.023099057376384735, decouple_loss:0.006664654240012169
Iteration: 1368, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4592825174331665
loss_pred:0.02434241957962513, decouple_loss:0.006672519259154797
The generated pressure mean: 0.46145251393318176
loss_pred:0.024131694808602333, decouple_loss:0.006898399908095598
The generated pressure mean: 0.4614616334438324
loss_pred:0.022527368739247322, decouple_loss:0.006759763695299625
Iteration: 1369, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4485217332839966
loss_pred:0.02247786894440651, decouple_loss:0.006650164723396301
The generated pressure mean: 0.44960618019104004
loss_pred:0.023836733773350716, decouple_loss:0.006835708394646645
The generated pressure mean: 0.4561372995376587
loss_pred:0.02188081666827202, decouple_loss:0.006943616084754467
Iteration: 1370, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4336719512939453
loss_pred:0.023728936910629272, decouple_loss:0.007543659768998623
The generated pressure mean: 0.4418277442455292
loss_pred:0.023238634690642357, decouple_loss:0.007162326481193304
The generated pressure mean: 0.44081562757492065
loss_pred:0.02231495827436447, decouple_loss:0.007316846400499344
2023-04-16 06:41:46 testing...
The generated pressure mean: 0.4196721613407135
loss_pred:0.036328788846731186, decouple_loss:0.007619559299200773
The generated pressure mean: 0.4284321665763855
loss_pred:0.03503768891096115, decouple_loss:0.00777820311486721
The generated pressure mean: 0.4320550262928009
loss_pred:0.03587550297379494, decouple_loss:0.007924636825919151
Loss: 0.03613603860139847, avg_mse: 0.0492841936647892
current test mse: 0.049284
Iteration: 1371, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44563132524490356The generated pressure mean: 0.4497016370296478
loss_pred:0.022869229316711426, decouple_loss:0.006943408865481615
loss_pred:0.02286413684487343, decouple_loss:0.007167439442127943
The generated pressure mean: 0.44505730271339417
loss_pred:0.024266302585601807, decouple_loss:0.006654058117419481
Iteration: 1372, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4465046525001526
loss_pred:0.02257661707699299, decouple_loss:0.006609255913645029
The generated pressure mean: 0.44465577602386475
loss_pred:0.02170281857252121, decouple_loss:0.007015773560851812
The generated pressure mean: 0.4473380446434021
loss_pred:0.02296171523630619, decouple_loss:0.0066703264601528645
Iteration: 1373, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.452667236328125
loss_pred:0.02252303436398506, decouple_loss:0.00744665926322341
The generated pressure mean: 0.4540603756904602
loss_pred:0.023415882140398026, decouple_loss:0.007135777268558741
The generated pressure mean: 0.45794302225112915
loss_pred:0.02091224119067192, decouple_loss:0.007224582601338625
Iteration: 1374, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4460504651069641
loss_pred:0.021445633843541145, decouple_loss:0.007784205488860607
The generated pressure mean: 0.4461568593978882
loss_pred:0.02412497065961361, decouple_loss:0.007805065717548132
The generated pressure mean: 0.4557301700115204
loss_pred:0.021941157057881355, decouple_loss:0.007628671359270811
Iteration: 1375, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44317376613616943
loss_pred:0.024127347394824028, decouple_loss:0.006776745896786451
The generated pressure mean: 0.44633767008781433
loss_pred:0.02308710105717182, decouple_loss:0.0068529830314219
The generated pressure mean: 0.44296255707740784
loss_pred:0.023071367293596268, decouple_loss:0.007161495741456747
Iteration: 1376, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44929519295692444
loss_pred:0.021663455292582512, decouple_loss:0.0059098415076732635
The generated pressure mean: 0.4480148255825043
loss_pred:0.023945536464452744, decouple_loss:0.0059744627214968204
The generated pressure mean: 0.4493613541126251
loss_pred:0.022807955741882324, decouple_loss:0.006205196026712656
Iteration: 1377, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44915109872817993
loss_pred:0.022475633770227432, decouple_loss:0.008272280916571617
The generated pressure mean: 0.44863706827163696
loss_pred:0.023425588384270668, decouple_loss:0.00804346427321434
The generated pressure mean: 0.4456551671028137
loss_pred:0.024028103798627853, decouple_loss:0.008012429811060429
Iteration: 1378, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4445892572402954
The generated pressure mean: 0.4428822100162506
loss_pred:0.02415706217288971, decouple_loss:0.006901559419929981
loss_pred:0.022032631561160088, decouple_loss:0.007160058245062828
The generated pressure mean: 0.44536730647087097
loss_pred:0.024028902873396873, decouple_loss:0.006721869111061096
Iteration: 1379, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4533911645412445
loss_pred:0.02227936126291752, decouple_loss:0.006121399346739054
The generated pressure mean: 0.4553380310535431
loss_pred:0.023803312331438065, decouple_loss:0.0062830764800310135
The generated pressure mean: 0.45898669958114624
loss_pred:0.023318883031606674, decouple_loss:0.006302741821855307
Iteration: 1380, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44728395342826843
loss_pred:0.023429952561855316, decouple_loss:0.007022787816822529
The generated pressure mean: 0.44952934980392456
loss_pred:0.022860465571284294, decouple_loss:0.006889353971928358
The generated pressure mean: 0.44691088795661926
loss_pred:0.023384185507893562, decouple_loss:0.007032888941466808
2023-04-16 06:43:47 testing...
The generated pressure mean: 0.4222676157951355
loss_pred:0.03528907522559166, decouple_loss:0.00796028133481741
The generated pressure mean: 0.4327680468559265
loss_pred:0.03435032442212105, decouple_loss:0.008197981864213943
The generated pressure mean: 0.4368201792240143
loss_pred:0.034840088337659836, decouple_loss:0.008485089987516403
Loss: 0.03523721918463707, avg_mse: 0.04782974720001221
current test mse: 0.04783
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012013_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012013_3_24hr.npz
NaN value num: 0
Iteration: 1381, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44236499071121216
loss_pred:0.022682465612888336, decouple_loss:0.006838641129434109
The generated pressure mean: 0.44408923387527466
loss_pred:0.02284392900764942, decouple_loss:0.007001711521297693
The generated pressure mean: 0.44772693514823914
loss_pred:0.023040151223540306, decouple_loss:0.00687415013089776
Iteration: 1382, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43924713134765625
loss_pred:0.02354678511619568, decouple_loss:0.005948096513748169
The generated pressure mean: 0.4449479579925537
loss_pred:0.02250581420958042, decouple_loss:0.006764308549463749
The generated pressure mean: 0.44535955786705017
loss_pred:0.024152034893631935, decouple_loss:0.006029559299349785
Iteration: 1383, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4468010663986206
loss_pred:0.024152880534529686, decouple_loss:0.007070458494126797
The generated pressure mean: 0.44341936707496643
loss_pred:0.022646944969892502, decouple_loss:0.007205549627542496
The generated pressure mean: 0.4470420479774475
loss_pred:0.02293011173605919, decouple_loss:0.007047859486192465
Iteration: 1384, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45162588357925415
loss_pred:0.023582369089126587, decouple_loss:0.0077691227197647095
The generated pressure mean: 0.4483874440193176
loss_pred:0.02287181280553341, decouple_loss:0.00743458466604352
The generated pressure mean: 0.4543142020702362
loss_pred:0.02374301664531231, decouple_loss:0.007760223932564259
Iteration: 1385, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4543307423591614
loss_pred:0.0238950215280056, decouple_loss:0.007787329610437155
The generated pressure mean: 0.4554358124732971
loss_pred:0.021910574287176132, decouple_loss:0.007209899369627237
The generated pressure mean: 0.46134448051452637
loss_pred:0.02429225854575634, decouple_loss:0.007280156947672367
Iteration: 1386, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4319598972797394
loss_pred:0.023637734353542328, decouple_loss:0.00774393929168582
The generated pressure mean: 0.43441978096961975
loss_pred:0.02264559082686901, decouple_loss:0.007831959053874016
The generated pressure mean: 0.4296300411224365
loss_pred:0.02560969442129135, decouple_loss:0.00787885021418333
Iteration: 1387, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4619937241077423
loss_pred:0.023914024233818054, decouple_loss:0.006511096842586994
The generated pressure mean: 0.45821231603622437
loss_pred:0.0226188562810421, decouple_loss:0.00687794666737318
The generated pressure mean: 0.4628586173057556
loss_pred:0.024322431534528732, decouple_loss:0.006662944331765175
Iteration: 1388, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44077202677726746
loss_pred:0.02429652214050293, decouple_loss:0.00783557165414095
The generated pressure mean: 0.44398388266563416
loss_pred:0.023468248546123505, decouple_loss:0.007438620086759329
The generated pressure mean: 0.4463207721710205
loss_pred:0.024210169911384583, decouple_loss:0.00744866905733943
Iteration: 1389, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4336220920085907
loss_pred:0.024786628782749176, decouple_loss:0.00767607381567359
The generated pressure mean: 0.4371446669101715
loss_pred:0.0231607798486948, decouple_loss:0.0074188909493386745
The generated pressure mean: 0.4404835104942322
loss_pred:0.022386329248547554, decouple_loss:0.00820943247526884
Iteration: 1390, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44851335883140564
loss_pred:0.024223769083619118, decouple_loss:0.008199155330657959
The generated pressure mean: 0.4437534511089325
loss_pred:0.022747933864593506, decouple_loss:0.0076838890090584755
The generated pressure mean: 0.44344907999038696
loss_pred:0.022828038781881332, decouple_loss:0.007977884262800217
2023-04-16 06:46:31 testing...
The generated pressure mean: 0.41667917370796204
loss_pred:0.03780936077237129, decouple_loss:0.009696876630187035
The generated pressure mean: 0.4262261986732483
loss_pred:0.03690086305141449, decouple_loss:0.009590331465005875
The generated pressure mean: 0.4307311177253723
loss_pred:0.03724514693021774, decouple_loss:0.009672175161540508
Loss: 0.0378011129796505, avg_mse: 0.05209898203611374
current test mse: 0.052099
Iteration: 1391, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4629746377468109
loss_pred:0.026038777083158493, decouple_loss:0.008645984344184399
The generated pressure mean: 0.46277037262916565
loss_pred:0.02419000305235386, decouple_loss:0.008668772876262665
The generated pressure mean: 0.45991605520248413
loss_pred:0.023852001875638962, decouple_loss:0.008518914692103863
Iteration: 1392, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.42267340421676636The generated pressure mean: 0.42545291781425476
loss_pred:0.025422148406505585, decouple_loss:0.012210213579237461
loss_pred:0.024737268686294556, decouple_loss:0.011681003496050835
The generated pressure mean: 0.42490947246551514
loss_pred:0.024900835007429123, decouple_loss:0.011944537051022053
Iteration: 1393, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4707423448562622
loss_pred:0.024371368810534477, decouple_loss:0.011566485278308392
The generated pressure mean: 0.4758665859699249
loss_pred:0.026844775304198265, decouple_loss:0.01157712284475565
The generated pressure mean: 0.47473880648612976
loss_pred:0.026739787310361862, decouple_loss:0.011829212307929993
Iteration: 1394, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4500882029533386
loss_pred:0.02340983971953392, decouple_loss:0.008836963213980198
The generated pressure mean: 0.4508858025074005
loss_pred:0.023235715925693512, decouple_loss:0.009111491031944752
The generated pressure mean: 0.4538152813911438
loss_pred:0.023636650294065475, decouple_loss:0.008795970119535923
Iteration: 1395, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.42835095524787903
loss_pred:0.024796776473522186, decouple_loss:0.010277923196554184
The generated pressure mean: 0.42682304978370667
loss_pred:0.022675219923257828, decouple_loss:0.010901154018938541
The generated pressure mean: 0.42602574825286865
loss_pred:0.024129435420036316, decouple_loss:0.010138513520359993
Iteration: 1396, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45079606771469116
loss_pred:0.026464108377695084, decouple_loss:0.008547392673790455
The generated pressure mean: 0.446210116147995
loss_pred:0.02555222436785698, decouple_loss:0.008406395092606544
The generated pressure mean: 0.44872981309890747
loss_pred:0.023821698501706123, decouple_loss:0.008294964209198952
Iteration: 1397, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45159879326820374
loss_pred:0.023488717153668404, decouple_loss:0.008509298786520958
The generated pressure mean: 0.45589926838874817
loss_pred:0.02366335317492485, decouple_loss:0.008673030883073807
The generated pressure mean: 0.45383185148239136
loss_pred:0.02422143518924713, decouple_loss:0.008963478729128838
Iteration: 1398, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44435909390449524
loss_pred:0.025972386822104454, decouple_loss:0.009984882548451424
The generated pressure mean: 0.4510703682899475
loss_pred:0.025963081046938896, decouple_loss:0.010160064324736595
The generated pressure mean: 0.4460943937301636
loss_pred:0.026517173275351524, decouple_loss:0.010365030728280544
Iteration: 1399, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4574090540409088
loss_pred:0.028056947514414787, decouple_loss:0.015172136016190052
The generated pressure mean: 0.46128734946250916
loss_pred:0.029395125806331635, decouple_loss:0.015025787986814976
The generated pressure mean: 0.4559250473976135
loss_pred:0.02919292449951172, decouple_loss:0.014720882289111614
Iteration: 1400, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4575899839401245
loss_pred:0.027095552533864975, decouple_loss:0.013572879135608673
The generated pressure mean: 0.4564385712146759
loss_pred:0.026288792490959167, decouple_loss:0.013836923986673355
The generated pressure mean: 0.45992499589920044
loss_pred:0.027762800455093384, decouple_loss:0.013770781457424164
2023-04-16 06:48:31 testing...
The generated pressure mean: 0.42416808009147644
loss_pred:0.039950381964445114, decouple_loss:0.014366674236953259
The generated pressure mean: 0.43079426884651184
loss_pred:0.038449496030807495, decouple_loss:0.014495805837213993
The generated pressure mean: 0.4341866672039032
loss_pred:0.0391642265021801, decouple_loss:0.014575871638953686
Loss: 0.03991200774908066, avg_mse: 0.0540350079536438
current test mse: 0.054035
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012007_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012007_3_24hr.npz
NaN value num: 0
Iteration: 1401, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4190717339515686
loss_pred:0.02670021913945675, decouple_loss:0.013863806612789631
The generated pressure mean: 0.419870525598526
loss_pred:0.027284344658255577, decouple_loss:0.013901880942285061
The generated pressure mean: 0.4237666726112366
loss_pred:0.026374952867627144, decouple_loss:0.013847916387021542
Iteration: 1402, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43753308057785034
loss_pred:0.02675534039735794, decouple_loss:0.013838531449437141
The generated pressure mean: 0.44074583053588867
loss_pred:0.027281153947114944, decouple_loss:0.013374041765928268
The generated pressure mean: 0.4370788335800171
loss_pred:0.02584962174296379, decouple_loss:0.013316052965819836
Iteration: 1403, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4600960612297058
loss_pred:0.026902681216597557, decouple_loss:0.014097710140049458
The generated pressure mean: 0.46187812089920044
loss_pred:0.026663171127438545, decouple_loss:0.014100061729550362
The generated pressure mean: 0.4540618658065796
loss_pred:0.02695714868605137, decouple_loss:0.013792529702186584
Iteration: 1404, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43933460116386414
loss_pred:0.025673458352684975, decouple_loss:0.012935081496834755
The generated pressure mean: 0.43880099058151245
loss_pred:0.024838559329509735, decouple_loss:0.013190887868404388
The generated pressure mean: 0.4437657594680786
loss_pred:0.0256725512444973, decouple_loss:0.01251113973557949
Iteration: 1405, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43774792551994324
loss_pred:0.02514958754181862, decouple_loss:0.013003719039261341
The generated pressure mean: 0.4373534917831421
loss_pred:0.024835528805851936, decouple_loss:0.012797781266272068
The generated pressure mean: 0.4364573657512665
loss_pred:0.025884613394737244, decouple_loss:0.012851082719862461
Iteration: 1406, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4550100266933441
loss_pred:0.024557214230298996, decouple_loss:0.012800335884094238
The generated pressure mean: 0.45290517807006836
loss_pred:0.025967800989747047, decouple_loss:0.012899353168904781
The generated pressure mean: 0.4557693898677826
loss_pred:0.025236140936613083, decouple_loss:0.012966560199856758
Iteration: 1407, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4568457007408142
loss_pred:0.026827562600374222, decouple_loss:0.013372154906392097
The generated pressure mean: 0.4550599455833435
loss_pred:0.02468978986144066, decouple_loss:0.01362519059330225
The generated pressure mean: 0.45999661087989807
loss_pred:0.02473793551325798, decouple_loss:0.013989136554300785
Iteration: 1408, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4400179982185364
loss_pred:0.02501607872545719, decouple_loss:0.013629617169499397
The generated pressure mean: 0.4432030916213989
loss_pred:0.024307414889335632, decouple_loss:0.013630124740302563
The generated pressure mean: 0.4442213475704193
loss_pred:0.02506650984287262, decouple_loss:0.013078424148261547
Iteration: 1409, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4307716190814972
loss_pred:0.026783393695950508, decouple_loss:0.012330716475844383
The generated pressure mean: 0.4355420172214508
loss_pred:0.02594371885061264, decouple_loss:0.012207123450934887
The generated pressure mean: 0.43318140506744385
loss_pred:0.024352874606847763, decouple_loss:0.011899469420313835
Iteration: 1410, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.448822945356369
loss_pred:0.026186488568782806, decouple_loss:0.016561809927225113
The generated pressure mean: 0.4469653069972992
loss_pred:0.024835048243403435, decouple_loss:0.016413630917668343
The generated pressure mean: 0.44659626483917236
loss_pred:0.024854330345988274, decouple_loss:0.016190409660339355
2023-04-16 06:51:09 testing...
The generated pressure mean: 0.4129539430141449
loss_pred:0.04121246933937073, decouple_loss:0.01726861298084259
The generated pressure mean: 0.42047858238220215
loss_pred:0.0402442067861557, decouple_loss:0.01690368726849556
The generated pressure mean: 0.4240553081035614
loss_pred:0.04082651063799858, decouple_loss:0.01706329733133316
Loss: 0.041614990681409836, avg_mse: 0.05879058316349983
current test mse: 0.058791
Iteration: 1411, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46498605608940125The generated pressure mean: 0.46967023611068726
loss_pred:0.02407046966254711, decouple_loss:0.016139250248670578
loss_pred:0.023891974240541458, decouple_loss:0.016873395070433617
The generated pressure mean: 0.47035667300224304
loss_pred:0.025338422507047653, decouple_loss:0.016213297843933105
Iteration: 1412, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4451206922531128
loss_pred:0.02611064352095127, decouple_loss:0.012473700568079948
The generated pressure mean: 0.44654950499534607
loss_pred:0.02350015379488468, decouple_loss:0.012711397372186184
The generated pressure mean: 0.4399089515209198
loss_pred:0.025807691738009453, decouple_loss:0.012611901387572289
Iteration: 1413, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4332551062107086
loss_pred:0.024761637672781944, decouple_loss:0.01220115926116705
The generated pressure mean: 0.4359520375728607
loss_pred:0.02458110824227333, decouple_loss:0.012381253764033318
The generated pressure mean: 0.430862158536911
loss_pred:0.02655891887843609, decouple_loss:0.012524799443781376
Iteration: 1414, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46311676502227783
loss_pred:0.023793721571564674, decouple_loss:0.013272272422909737
The generated pressure mean: 0.4586876332759857
loss_pred:0.024294717237353325, decouple_loss:0.013394205830991268
The generated pressure mean: 0.46089088916778564
loss_pred:0.024755235761404037, decouple_loss:0.013357261195778847
Iteration: 1415, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4611254036426544
loss_pred:0.024365009739995003, decouple_loss:0.01116888877004385
The generated pressure mean: 0.4600684642791748
loss_pred:0.024302255362272263, decouple_loss:0.011058817617595196
The generated pressure mean: 0.4608277678489685
loss_pred:0.0239101629704237, decouple_loss:0.011144464835524559
Iteration: 1416, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43084052205085754
loss_pred:0.024209290742874146, decouple_loss:0.012115063145756721
The generated pressure mean: 0.42872297763824463
loss_pred:0.02440747432410717, decouple_loss:0.012356948107481003
The generated pressure mean: 0.43333929777145386
loss_pred:0.02392021007835865, decouple_loss:0.012496686540544033
Iteration: 1417, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4344180226325989
loss_pred:0.025065744295716286, decouple_loss:0.011041436344385147
The generated pressure mean: 0.43817582726478577
loss_pred:0.023152276873588562, decouple_loss:0.011068738996982574
The generated pressure mean: 0.43484655022621155
loss_pred:0.02469179593026638, decouple_loss:0.011199506931006908
Iteration: 1418, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4501194953918457
loss_pred:0.023349668830633163, decouple_loss:0.010047664865851402
The generated pressure mean: 0.4502717852592468
loss_pred:0.02409801445901394, decouple_loss:0.00982873234897852
The generated pressure mean: 0.4475304186344147
loss_pred:0.02424909919500351, decouple_loss:0.009888089261949062
Iteration: 1419, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4613902270793915
loss_pred:0.023715924471616745, decouple_loss:0.010098266415297985
The generated pressure mean: 0.46290433406829834
loss_pred:0.0241143386811018, decouple_loss:0.010641767643392086
The generated pressure mean: 0.457523375749588
loss_pred:0.027044661343097687, decouple_loss:0.010542021133005619
Iteration: 1420, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4410381615161896
loss_pred:0.02442888729274273, decouple_loss:0.01068188901990652
The generated pressure mean: 0.4441237449645996
loss_pred:0.023477058857679367, decouple_loss:0.010633451864123344
The generated pressure mean: 0.44328945875167847
loss_pred:0.024492172524333, decouple_loss:0.010654053650796413
2023-04-16 06:53:09 testing...
The generated pressure mean: 0.424216091632843
loss_pred:0.03650752082467079, decouple_loss:0.010214860551059246
The generated pressure mean: 0.4338718354701996
loss_pred:0.03522301837801933, decouple_loss:0.010234519839286804
The generated pressure mean: 0.4383227527141571
loss_pred:0.03530601039528847, decouple_loss:0.010342152789235115
Loss: 0.036192044615745544, avg_mse: 0.04948746785521507
current test mse: 0.049487
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012005_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012005_3_24hr.npz
NaN value num: 0
Iteration: 1421, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43526384234428406
loss_pred:0.023897767066955566, decouple_loss:0.010114398784935474
The generated pressure mean: 0.4318263828754425
loss_pred:0.02394857257604599, decouple_loss:0.01000680960714817
The generated pressure mean: 0.43156880140304565
loss_pred:0.02646065317094326, decouple_loss:0.010056503117084503
Iteration: 1422, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45391643047332764
The generated pressure mean: 0.4528140723705292
loss_pred:0.02410932071506977, decouple_loss:0.009434137493371964
loss_pred:0.023810086771845818, decouple_loss:0.009298431687057018
The generated pressure mean: 0.4498565196990967
loss_pred:0.02447088249027729, decouple_loss:0.00949421152472496
Iteration: 1423, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.455369770526886
loss_pred:0.02522406540811062, decouple_loss:0.010714787058532238
The generated pressure mean: 0.45929521322250366
loss_pred:0.02578636445105076, decouple_loss:0.01055314764380455
The generated pressure mean: 0.45424339175224304
loss_pred:0.02357371523976326, decouple_loss:0.010816749185323715
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1424, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4470687508583069
loss_pred:0.0258603785187006, decouple_loss:0.010952071286737919
The generated pressure mean: 0.44567131996154785
loss_pred:0.02421320043504238, decouple_loss:0.01078123226761818
The generated pressure mean: 0.44602662324905396
loss_pred:0.02265995182096958, decouple_loss:0.010986324399709702
Iteration: 1425, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4419054388999939
loss_pred:0.023932723328471184, decouple_loss:0.010621808469295502
The generated pressure mean: 0.44683709740638733
loss_pred:0.023925237357616425, decouple_loss:0.01035686582326889
The generated pressure mean: 0.44701698422431946
loss_pred:0.024065490812063217, decouple_loss:0.01046979334205389
Iteration: 1426, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43892332911491394
loss_pred:0.02530888468027115, decouple_loss:0.00878053903579712
The generated pressure mean: 0.43814384937286377
loss_pred:0.023772897198796272, decouple_loss:0.008585495874285698
The generated pressure mean: 0.4373209774494171
loss_pred:0.024199139326810837, decouple_loss:0.008656996302306652
Iteration: 1427, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4488319456577301
loss_pred:0.025775162503123283, decouple_loss:0.009466012939810753
The generated pressure mean: 0.43724432587623596
loss_pred:0.022921588271856308, decouple_loss:0.009511522948741913
The generated pressure mean: 0.4478487968444824
loss_pred:0.023571278899908066, decouple_loss:0.009530522860586643
Iteration: 1428, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4604654908180237
loss_pred:0.023328416049480438, decouple_loss:0.008348663337528706
The generated pressure mean: 0.45945775508880615
loss_pred:0.023666348308324814, decouple_loss:0.008253592066466808
The generated pressure mean: 0.46617236733436584
loss_pred:0.024053512141108513, decouple_loss:0.008054540492594242
Iteration: 1429, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44434717297554016
loss_pred:0.023549435660243034, decouple_loss:0.00863310880959034
The generated pressure mean: 0.4428817927837372
loss_pred:0.02331225574016571, decouple_loss:0.008609365671873093
The generated pressure mean: 0.44504401087760925
loss_pred:0.023376697674393654, decouple_loss:0.008656822144985199
Iteration: 1430, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43760159611701965
loss_pred:0.024667367339134216, decouple_loss:0.007995743304491043
The generated pressure mean: 0.4418134391307831
loss_pred:0.023688241839408875, decouple_loss:0.00826073344796896
The generated pressure mean: 0.43947696685791016
loss_pred:0.022472508251667023, decouple_loss:0.008249563165009022
2023-04-16 06:55:45 testing...
The generated pressure mean: 0.41848820447921753
loss_pred:0.03634878993034363, decouple_loss:0.008156833238899708
The generated pressure mean: 0.4269000291824341
loss_pred:0.03511863946914673, decouple_loss:0.00846090167760849
The generated pressure mean: 0.4314858019351959
loss_pred:0.03529081121087074, decouple_loss:0.008645746856927872
Loss: 0.03600713610649109, avg_mse: 0.05019982159137726
current test mse: 0.0502
Iteration: 1431, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4406640827655792
loss_pred:0.024048831313848495, decouple_loss:0.007842102088034153
The generated pressure mean: 0.44224628806114197
loss_pred:0.024531560018658638, decouple_loss:0.007882471196353436
The generated pressure mean: 0.4364619851112366
loss_pred:0.023672254756093025, decouple_loss:0.008280540816485882
Iteration: 1432, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4633752107620239
loss_pred:0.024868279695510864, decouple_loss:0.00790784414857626
The generated pressure mean: 0.46031641960144043
loss_pred:0.023810166865587234, decouple_loss:0.008042842149734497
The generated pressure mean: 0.46408140659332275
loss_pred:0.02377736195921898, decouple_loss:0.0077892797999084
Iteration: 1433, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45702359080314636
loss_pred:0.023789022117853165, decouple_loss:0.0076115126721560955
The generated pressure mean: 0.45982345938682556
loss_pred:0.025583541020751, decouple_loss:0.007673713378608227
The generated pressure mean: 0.45146822929382324
loss_pred:0.023854847997426987, decouple_loss:0.007719647604972124
Iteration: 1434, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4436081647872925
loss_pred:0.02335984818637371, decouple_loss:0.007257395889610052
The generated pressure mean: 0.44049984216690063
loss_pred:0.023194588720798492, decouple_loss:0.007324575446546078
The generated pressure mean: 0.43789008259773254
loss_pred:0.023861469700932503, decouple_loss:0.0075316657312214375
Iteration: 1435, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4374377429485321
loss_pred:0.02366601675748825, decouple_loss:0.00887629110366106
The generated pressure mean: 0.4327933192253113
loss_pred:0.02467598021030426, decouple_loss:0.009113087318837643
The generated pressure mean: 0.43722811341285706
loss_pred:0.024225302040576935, decouple_loss:0.00904714222997427
Iteration: 1436, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4590901732444763
loss_pred:0.02425578236579895, decouple_loss:0.008551806211471558
The generated pressure mean: 0.45638665556907654
loss_pred:0.023724591359496117, decouple_loss:0.008422447368502617
The generated pressure mean: 0.45589613914489746
loss_pred:0.024080291390419006, decouple_loss:0.008372997865080833
Iteration: 1437, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44475021958351135
loss_pred:0.023876631632447243, decouple_loss:0.007984958589076996
The generated pressure mean: 0.45104044675827026
loss_pred:0.023571906611323357, decouple_loss:0.008449188433587551
The generated pressure mean: 0.4469866454601288
loss_pred:0.023638863116502762, decouple_loss:0.007997649721801281
Iteration: 1438, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4440738558769226
loss_pred:0.02205844409763813, decouple_loss:0.0073052565567195415
The generated pressure mean: 0.44471943378448486
loss_pred:0.022743843495845795, decouple_loss:0.007313515059649944
The generated pressure mean: 0.4439391493797302
loss_pred:0.022320188581943512, decouple_loss:0.007158785127103329
Iteration: 1439, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4506855905056
loss_pred:0.0242278091609478, decouple_loss:0.008879236876964569
The generated pressure mean: 0.44694241881370544
loss_pred:0.023235399276018143, decouple_loss:0.009134620428085327
The generated pressure mean: 0.44875362515449524
loss_pred:0.02320854365825653, decouple_loss:0.008519275113940239
Iteration: 1440, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4535374045372009
loss_pred:0.024181265383958817, decouple_loss:0.00891127623617649
The generated pressure mean: 0.4503473937511444
loss_pred:0.022425618022680283, decouple_loss:0.008872301317751408
The generated pressure mean: 0.44786709547042847
loss_pred:0.024026673287153244, decouple_loss:0.00875916238874197
2023-04-16 06:57:46 testing...
The generated pressure mean: 0.41803672909736633
loss_pred:0.03525776416063309, decouple_loss:0.007893429137766361
The generated pressure mean: 0.4268394410610199
loss_pred:0.0345291867852211, decouple_loss:0.00824220385402441
The generated pressure mean: 0.43051421642303467
loss_pred:0.034719329327344894, decouple_loss:0.008491331711411476
Loss: 0.035245876759290695, avg_mse: 0.04823872819542885
current test mse: 0.048239
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012015_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012015_3_24hr.npz
NaN value num: 0
Iteration: 1441, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44340214133262634
loss_pred:0.02413788251578808, decouple_loss:0.007166852243244648
The generated pressure mean: 0.4448038339614868
loss_pred:0.02356862649321556, decouple_loss:0.007378293201327324
The generated pressure mean: 0.4509480893611908
loss_pred:0.02317340113222599, decouple_loss:0.007402396760880947
Iteration: 1442, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4348176121711731
The generated pressure mean: 0.4376731216907501
loss_pred:0.02461988665163517, decouple_loss:0.00687483511865139
loss_pred:0.024321360513567924, decouple_loss:0.006181153003126383
The generated pressure mean: 0.437144011259079
loss_pred:0.02363278903067112, decouple_loss:0.006347838789224625
Iteration: 1443, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44905585050582886
loss_pred:0.02432378940284252, decouple_loss:0.006856164894998074
The generated pressure mean: 0.446317583322525
loss_pred:0.023857632651925087, decouple_loss:0.006717493291944265
The generated pressure mean: 0.4469476044178009
loss_pred:0.024469969794154167, decouple_loss:0.00655059190467
Iteration: 1444, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45389264822006226
loss_pred:0.023543601855635643, decouple_loss:0.007225428707897663
The generated pressure mean: 0.4532763659954071
loss_pred:0.024216745048761368, decouple_loss:0.007337544579058886
The generated pressure mean: 0.4537459909915924
loss_pred:0.025876544415950775, decouple_loss:0.007437520660459995
Iteration: 1445, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4480953812599182
loss_pred:0.02338079921901226, decouple_loss:0.006759398151189089
The generated pressure mean: 0.4444671869277954
loss_pred:0.025625869631767273, decouple_loss:0.0066399299539625645
The generated pressure mean: 0.4450906217098236
loss_pred:0.024361925199627876, decouple_loss:0.006806590128690004
Iteration: 1446, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44539713859558105
loss_pred:0.023234516382217407, decouple_loss:0.006599884480237961
The generated pressure mean: 0.4393104612827301
loss_pred:0.02468571439385414, decouple_loss:0.006219964940100908
The generated pressure mean: 0.4457378387451172
loss_pred:0.02385948784649372, decouple_loss:0.00655642943456769
Iteration: 1447, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44484004378318787
loss_pred:0.02336980402469635, decouple_loss:0.007104099728167057
The generated pressure mean: 0.4414665699005127
loss_pred:0.023500079289078712, decouple_loss:0.006930071394890547
The generated pressure mean: 0.45458465814590454
loss_pred:0.023573612794280052, decouple_loss:0.006802343297749758
Iteration: 1448, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4434702694416046
loss_pred:0.025483587756752968, decouple_loss:0.006635189056396484
The generated pressure mean: 0.443666934967041
loss_pred:0.02335291914641857, decouple_loss:0.0065476722083985806
The generated pressure mean: 0.43622276186943054
loss_pred:0.02431500516831875, decouple_loss:0.006739565636962652
Iteration: 1449, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43410560488700867
loss_pred:0.025665972381830215, decouple_loss:0.006448883563280106
The generated pressure mean: 0.43357616662979126
loss_pred:0.024514716118574142, decouple_loss:0.006215122994035482
The generated pressure mean: 0.43271467089653015
loss_pred:0.02549869753420353, decouple_loss:0.006351597141474485
Iteration: 1450, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46177592873573303
loss_pred:0.025314511731266975, decouple_loss:0.006397798657417297
The generated pressure mean: 0.4623646140098572
loss_pred:0.024607298895716667, decouple_loss:0.006333198864012957
The generated pressure mean: 0.4640112817287445
loss_pred:0.02650182880461216, decouple_loss:0.006434394046664238
2023-04-16 07:00:22 testing...
The generated pressure mean: 0.41560015082359314
loss_pred:0.03548186272382736, decouple_loss:0.007497651502490044
The generated pressure mean: 0.42303648591041565
loss_pred:0.03474989905953407, decouple_loss:0.007684839423745871
The generated pressure mean: 0.4265497326850891
loss_pred:0.03470633551478386, decouple_loss:0.007883429527282715
Loss: 0.03536380082368851, avg_mse: 0.04844174161553383
current test mse: 0.048442
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1451, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4537830054759979
loss_pred:0.024560164660215378, decouple_loss:0.00723038287833333
The generated pressure mean: 0.4499589800834656
loss_pred:0.024813152849674225, decouple_loss:0.0071820346638560295
The generated pressure mean: 0.4480304419994354
loss_pred:0.023348722606897354, decouple_loss:0.007075916975736618
Iteration: 1452, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43905892968177795
loss_pred:0.023300757631659508, decouple_loss:0.007574581541121006
The generated pressure mean: 0.4411643445491791
loss_pred:0.025067908689379692, decouple_loss:0.007349034305661917
The generated pressure mean: 0.4362909197807312
loss_pred:0.024940546602010727, decouple_loss:0.0073668803088366985
Iteration: 1453, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43449994921684265
loss_pred:0.023926790803670883, decouple_loss:0.007091018371284008
The generated pressure mean: 0.434604674577713
loss_pred:0.024566633626818657, decouple_loss:0.007155166007578373
The generated pressure mean: 0.4362408518791199
loss_pred:0.025136183947324753, decouple_loss:0.006768259219825268
Iteration: 1454, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45753028988838196
The generated pressure mean: 0.4585404396057129
loss_pred:0.023121241480112076, decouple_loss:0.007767044007778168
loss_pred:0.023762285709381104, decouple_loss:0.007104250602424145
The generated pressure mean: 0.45452967286109924
loss_pred:0.023649994283914566, decouple_loss:0.007462848909199238
Iteration: 1455, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44083261489868164
loss_pred:0.02282974123954773, decouple_loss:0.007412544451653957
The generated pressure mean: 0.4473579227924347
loss_pred:0.024515578523278236, decouple_loss:0.007264993153512478
The generated pressure mean: 0.4477590024471283
loss_pred:0.023798707872629166, decouple_loss:0.007275617681443691
Iteration: 1456, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43913307785987854
loss_pred:0.02459363266825676, decouple_loss:0.006984888110309839
The generated pressure mean: 0.43588218092918396
loss_pred:0.024372315034270287, decouple_loss:0.006962515879422426
The generated pressure mean: 0.4383156895637512
loss_pred:0.023073440417647362, decouple_loss:0.007029230240732431
Iteration: 1457, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4462728202342987
loss_pred:0.023539960384368896, decouple_loss:0.00690883444622159
The generated pressure mean: 0.4424046576023102
loss_pred:0.024944093078374863, decouple_loss:0.0068886782974004745
The generated pressure mean: 0.4465472400188446
loss_pred:0.024849487468600273, decouple_loss:0.006923674140125513
Iteration: 1458, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4536300003528595
loss_pred:0.023505983874201775, decouple_loss:0.007639759220182896
The generated pressure mean: 0.4501926600933075
loss_pred:0.02414201945066452, decouple_loss:0.007563995197415352
The generated pressure mean: 0.4509168267250061
loss_pred:0.023417221382260323, decouple_loss:0.007668876089155674
Iteration: 1459, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4506506323814392
loss_pred:0.02529292367398739, decouple_loss:0.006230086553841829
The generated pressure mean: 0.4526366889476776
loss_pred:0.023268897086381912, decouple_loss:0.006075172685086727
The generated pressure mean: 0.44713515043258667
loss_pred:0.02291599102318287, decouple_loss:0.006373088341206312
Iteration: 1460, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4449409246444702
loss_pred:0.024036066606640816, decouple_loss:0.0072132498025894165
The generated pressure mean: 0.43998393416404724
loss_pred:0.023709503933787346, decouple_loss:0.007215862162411213
The generated pressure mean: 0.4376162886619568
loss_pred:0.02302372269332409, decouple_loss:0.007341176737099886
2023-04-16 07:02:22 testing...
The generated pressure mean: 0.41919609904289246
loss_pred:0.03508075326681137, decouple_loss:0.009917627088725567
The generated pressure mean: 0.42812347412109375
loss_pred:0.034189581871032715, decouple_loss:0.010299084708094597
The generated pressure mean: 0.4320572316646576
loss_pred:0.03461325541138649, decouple_loss:0.010274924337863922
Loss: 0.035136058926582336, avg_mse: 0.048633724451065063
current test mse: 0.048634
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012008_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012008_3_24hr.npz
NaN value num: 0
Iteration: 1461, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4454995095729828
loss_pred:0.022485515102744102, decouple_loss:0.00968199223279953
The generated pressure mean: 0.4487103521823883
loss_pred:0.02287331223487854, decouple_loss:0.00941441673785448
The generated pressure mean: 0.4477553069591522
loss_pred:0.02316666580736637, decouple_loss:0.009444041177630424
Iteration: 1462, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45342472195625305The generated pressure mean: 0.45284950733184814
loss_pred:0.022762473672628403, decouple_loss:0.0071634710766375065
loss_pred:0.022322358563542366, decouple_loss:0.007196073420345783
The generated pressure mean: 0.45061466097831726
loss_pred:0.02307259663939476, decouple_loss:0.007493182551115751
Iteration: 1463, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4494020938873291
loss_pred:0.024970678612589836, decouple_loss:0.00825920607894659
The generated pressure mean: 0.44879287481307983
loss_pred:0.023670895025134087, decouple_loss:0.008335727266967297
The generated pressure mean: 0.44934338331222534
loss_pred:0.02552279829978943, decouple_loss:0.007918940857052803
Iteration: 1464, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43685227632522583
loss_pred:0.023431258276104927, decouple_loss:0.0074090976268053055
The generated pressure mean: 0.43889957666397095
loss_pred:0.023536479100584984, decouple_loss:0.007562559563666582
The generated pressure mean: 0.4400494396686554
loss_pred:0.02283535525202751, decouple_loss:0.006851546000689268
Iteration: 1465, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4421468675136566
loss_pred:0.024344852194190025, decouple_loss:0.010535573586821556
The generated pressure mean: 0.4405179023742676
loss_pred:0.022842343896627426, decouple_loss:0.011562543921172619
The generated pressure mean: 0.4462340474128723
loss_pred:0.02241504192352295, decouple_loss:0.010588797740638256
Iteration: 1466, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4576718211174011
The generated pressure mean: 0.46166566014289856
loss_pred:0.02546204999089241, decouple_loss:0.008208038285374641
loss_pred:0.02277032658457756, decouple_loss:0.008028951473534107
The generated pressure mean: 0.45786044001579285
loss_pred:0.023072918877005577, decouple_loss:0.008041046559810638
Iteration: 1467, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4438694417476654
loss_pred:0.024941107258200645, decouple_loss:0.00675311079248786
The generated pressure mean: 0.4437355697154999
loss_pred:0.024072153493762016, decouple_loss:0.0064179073087871075
The generated pressure mean: 0.44525882601737976
loss_pred:0.02316581830382347, decouple_loss:0.006790472194552422
Iteration: 1468, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4395378828048706
loss_pred:0.025096382945775986, decouple_loss:0.01078252587467432
The generated pressure mean: 0.4410240650177002
loss_pred:0.02467576041817665, decouple_loss:0.010625489056110382
The generated pressure mean: 0.43836072087287903
loss_pred:0.02427000179886818, decouple_loss:0.011094406247138977
Iteration: 1469, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45019686222076416
loss_pred:0.022910267114639282, decouple_loss:0.007552680559456348
The generated pressure mean: 0.45244136452674866
loss_pred:0.022877387702465057, decouple_loss:0.008437174372375011
The generated pressure mean: 0.4497639238834381
loss_pred:0.023658135905861855, decouple_loss:0.007990190759301186
Iteration: 1470, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44949665665626526
loss_pred:0.022463398054242134, decouple_loss:0.007978632114827633
The generated pressure mean: 0.45714762806892395
loss_pred:0.02240128256380558, decouple_loss:0.008497685194015503
The generated pressure mean: 0.45302096009254456
loss_pred:0.023372357711195946, decouple_loss:0.008631749078631401
2023-04-16 07:05:03 testing...
The generated pressure mean: 0.4208184480667114
loss_pred:0.03607209771871567, decouple_loss:0.010696849785745144
The generated pressure mean: 0.4315246045589447
loss_pred:0.034559465944767, decouple_loss:0.01048799604177475
The generated pressure mean: 0.4364466667175293
loss_pred:0.03571486845612526, decouple_loss:0.010682118125259876
Loss: 0.03597993031144142, avg_mse: 0.05032779648900032
current test mse: 0.050328
Iteration: 1471, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4418260455131531
The generated pressure mean: 0.43943312764167786
loss_pred:0.023339102044701576, decouple_loss:0.010213659144937992
loss_pred:0.023231541737914085, decouple_loss:0.010345207527279854
The generated pressure mean: 0.4461819529533386
loss_pred:0.0227779783308506, decouple_loss:0.010244307108223438
Iteration: 1472, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.434078186750412
loss_pred:0.02442450262606144, decouple_loss:0.00818274449557066
The generated pressure mean: 0.4377138018608093
loss_pred:0.02454741671681404, decouple_loss:0.008021154440939426
The generated pressure mean: 0.43884778022766113
loss_pred:0.02385331504046917, decouple_loss:0.008042859844863415
Iteration: 1473, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4509531557559967
loss_pred:0.024068661034107208, decouple_loss:0.009737593121826649
The generated pressure mean: 0.44611433148384094
loss_pred:0.022572427988052368, decouple_loss:0.009495838545262814
The generated pressure mean: 0.4503195881843567
loss_pred:0.022787950932979584, decouple_loss:0.009693030267953873
Iteration: 1474, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46286988258361816
loss_pred:0.023086311295628548, decouple_loss:0.010014355182647705
The generated pressure mean: 0.4594734311103821
loss_pred:0.023418404161930084, decouple_loss:0.010176701471209526
The generated pressure mean: 0.4547950327396393
loss_pred:0.024776365607976913, decouple_loss:0.009853285737335682
Iteration: 1475, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44256553053855896
loss_pred:0.025051141157746315, decouple_loss:0.007850315421819687
The generated pressure mean: 0.44741398096084595
loss_pred:0.02273298054933548, decouple_loss:0.00788644514977932
The generated pressure mean: 0.4426412880420685
loss_pred:0.023215053603053093, decouple_loss:0.007861197926104069
Iteration: 1476, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43624910712242126
loss_pred:0.021213406696915627, decouple_loss:0.009826074354350567
The generated pressure mean: 0.4329623281955719
loss_pred:0.023797446861863136, decouple_loss:0.00958254560828209
The generated pressure mean: 0.43242770433425903
loss_pred:0.02123427949845791, decouple_loss:0.009280625730752945
Iteration: 1477, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44395461678504944
loss_pred:0.022445136681199074, decouple_loss:0.0072876145131886005
The generated pressure mean: 0.4476046860218048
loss_pred:0.024483541026711464, decouple_loss:0.0069960481487214565
The generated pressure mean: 0.44439852237701416
loss_pred:0.022733362391591072, decouple_loss:0.007281219586730003
Iteration: 1478, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4595404863357544
loss_pred:0.023422295227646828, decouple_loss:0.008441595360636711
The generated pressure mean: 0.4601788818836212
loss_pred:0.022943619638681412, decouple_loss:0.008227342739701271
The generated pressure mean: 0.45375341176986694
loss_pred:0.023186925798654556, decouple_loss:0.008240562863647938
Iteration: 1479, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4534723460674286
loss_pred:0.022475911304354668, decouple_loss:0.00860572885721922
The generated pressure mean: 0.45053935050964355
loss_pred:0.023609664291143417, decouple_loss:0.008890543133020401
The generated pressure mean: 0.44950711727142334
loss_pred:0.02304128371179104, decouple_loss:0.008620228618383408
Iteration: 1480, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4435025155544281
loss_pred:0.021950922906398773, decouple_loss:0.006550859659910202
The generated pressure mean: 0.44619935750961304
loss_pred:0.022911041975021362, decouple_loss:0.00713886646553874
The generated pressure mean: 0.44447681307792664
loss_pred:0.022488856688141823, decouple_loss:0.007110456470400095
2023-04-16 07:07:04 testing...
The generated pressure mean: 0.42131996154785156
loss_pred:0.03493208810687065, decouple_loss:0.008666167967021465
The generated pressure mean: 0.4288480877876282
loss_pred:0.034848786890506744, decouple_loss:0.008660852909088135
The generated pressure mean: 0.43377792835235596
loss_pred:0.034505438059568405, decouple_loss:0.008836651220917702
Loss: 0.03519816696643829, avg_mse: 0.04819062352180481
current test mse: 0.048191
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012016_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012016_3_24hr.npz
NaN value num: 0
Iteration: 1481, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4383276402950287
loss_pred:0.024016207084059715, decouple_loss:0.00843993853777647
The generated pressure mean: 0.43408286571502686
loss_pred:0.02245008945465088, decouple_loss:0.008853156119585037
The generated pressure mean: 0.4356098175048828
loss_pred:0.023998454213142395, decouple_loss:0.008736948482692242
Iteration: 1482, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44841182231903076
loss_pred:0.02305104024708271, decouple_loss:0.007775554899126291
The generated pressure mean: 0.44904494285583496
loss_pred:0.025893669575452805, decouple_loss:0.007628683000802994
The generated pressure mean: 0.45047008991241455
loss_pred:0.022785503417253494, decouple_loss:0.008270889520645142
Iteration: 1483, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4526948928833008
loss_pred:0.024023771286010742, decouple_loss:0.008134959265589714
The generated pressure mean: 0.4473610520362854
loss_pred:0.02264968864619732, decouple_loss:0.008621115237474442
The generated pressure mean: 0.45387306809425354
loss_pred:0.02308551035821438, decouple_loss:0.008366284891963005
Iteration: 1484, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44041553139686584
loss_pred:0.023946011438965797, decouple_loss:0.0069638462737202644
The generated pressure mean: 0.44568464159965515
loss_pred:0.022371456027030945, decouple_loss:0.00731618981808424
The generated pressure mean: 0.44433364272117615
loss_pred:0.02342773601412773, decouple_loss:0.007051896303892136
Iteration: 1485, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45173174142837524
loss_pred:0.024929359555244446, decouple_loss:0.007961667142808437
The generated pressure mean: 0.4508700668811798
loss_pred:0.0229866411536932, decouple_loss:0.008113282732665539
The generated pressure mean: 0.4511639475822449
loss_pred:0.02308039925992489, decouple_loss:0.007792522199451923
Iteration: 1486, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44562453031539917
loss_pred:0.023985153064131737, decouple_loss:0.007625427562743425
The generated pressure mean: 0.44670578837394714
loss_pred:0.024001624435186386, decouple_loss:0.00766204996034503
The generated pressure mean: 0.4429103136062622
loss_pred:0.02292083390057087, decouple_loss:0.007635999470949173
Iteration: 1487, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4374222457408905
loss_pred:0.023319341242313385, decouple_loss:0.008022958412766457
The generated pressure mean: 0.43523895740509033
loss_pred:0.022295283153653145, decouple_loss:0.00818696990609169
The generated pressure mean: 0.43778809905052185
loss_pred:0.022557532414793968, decouple_loss:0.008071983233094215
Iteration: 1488, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4435613453388214
loss_pred:0.024337247014045715, decouple_loss:0.007898612879216671
The generated pressure mean: 0.43919089436531067
loss_pred:0.023784007877111435, decouple_loss:0.008011063560843468
The generated pressure mean: 0.4396471679210663
loss_pred:0.023576032370328903, decouple_loss:0.008328918367624283
Iteration: 1489, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4589320123195648
loss_pred:0.021854011341929436, decouple_loss:0.006828418932855129
The generated pressure mean: 0.4555944800376892
loss_pred:0.024090729653835297, decouple_loss:0.006833306513726711
The generated pressure mean: 0.45447462797164917
loss_pred:0.02315296046435833, decouple_loss:0.0068164705298841
Iteration: 1490, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4455932080745697
loss_pred:0.023855501785874367, decouple_loss:0.006963895633816719
The generated pressure mean: 0.442608118057251
loss_pred:0.02390104904770851, decouple_loss:0.00691461656242609
The generated pressure mean: 0.44808709621429443
loss_pred:0.022427013143897057, decouple_loss:0.007085333112627268
2023-04-16 07:09:43 testing...
The generated pressure mean: 0.42256683111190796
loss_pred:0.036236993968486786, decouple_loss:0.009119994007050991
The generated pressure mean: 0.4318621754646301
loss_pred:0.034831494092941284, decouple_loss:0.009211098775267601
The generated pressure mean: 0.43746548891067505
loss_pred:0.034986890852451324, decouple_loss:0.00933923851698637
Loss: 0.03581296652555466, avg_mse: 0.049879640340805054
current test mse: 0.04988
Iteration: 1491, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44289201498031616
loss_pred:0.024359164759516716, decouple_loss:0.008898349478840828
The generated pressure mean: 0.44795969128608704The generated pressure mean: 0.44290691614151
loss_pred:0.02178747020661831, decouple_loss:0.008585577830672264
loss_pred:0.02473423443734646, decouple_loss:0.008532007224857807
Iteration: 1492, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44941383600234985
loss_pred:0.023972978815436363, decouple_loss:0.006962338928133249
The generated pressure mean: 0.4477112293243408
The generated pressure mean: 0.44576480984687805
loss_pred:0.022531935945153236, decouple_loss:0.007079840637743473
loss_pred:0.02399841509759426, decouple_loss:0.006859355606138706
Iteration: 1493, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44442427158355713
loss_pred:0.02389715611934662, decouple_loss:0.00782916322350502
The generated pressure mean: 0.44373002648353577
The generated pressure mean: 0.4434497356414795loss_pred:0.02337813191115856, decouple_loss:0.007545484229922295
loss_pred:0.023021424189209938, decouple_loss:0.007135400082916021
Iteration: 1494, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4441417157649994
loss_pred:0.023045876994729042, decouple_loss:0.00880019087344408
The generated pressure mean: 0.44829297065734863
loss_pred:0.02294693887233734, decouple_loss:0.008752258494496346
The generated pressure mean: 0.4434894621372223
loss_pred:0.023361660540103912, decouple_loss:0.009059087373316288
Iteration: 1495, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45360255241394043
loss_pred:0.025220297276973724, decouple_loss:0.00607437826693058
The generated pressure mean: 0.4505479335784912
The generated pressure mean: 0.44716987013816833
loss_pred:0.02288687787950039, decouple_loss:0.005935674998909235
loss_pred:0.02454761601984501, decouple_loss:0.006071913056075573
Iteration: 1496, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4532392919063568
loss_pred:0.022875279188156128, decouple_loss:0.009645221754908562
The generated pressure mean: 0.4531845152378082
loss_pred:0.02375294826924801, decouple_loss:0.009496744722127914
The generated pressure mean: 0.45062702894210815
loss_pred:0.02251031994819641, decouple_loss:0.00970563292503357
Iteration: 1497, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44226154685020447
loss_pred:0.023376695811748505, decouple_loss:0.005853797774761915
The generated pressure mean: 0.44161099195480347
loss_pred:0.022168288007378578, decouple_loss:0.006114099640399218
The generated pressure mean: 0.4461565911769867
loss_pred:0.022743843495845795, decouple_loss:0.005907371640205383
Iteration: 1498, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4392010271549225
loss_pred:0.02418730966746807, decouple_loss:0.01078756246715784
The generated pressure mean: 0.43978676199913025
loss_pred:0.023698925971984863, decouple_loss:0.010463529266417027
The generated pressure mean: 0.4415736794471741
loss_pred:0.02207362651824951, decouple_loss:0.010638630017638206
Iteration: 1499, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44696423411369324
loss_pred:0.021626124158501625, decouple_loss:0.006633911747485399
The generated pressure mean: 0.4527024030685425
loss_pred:0.02378428913652897, decouple_loss:0.007015032693743706
The generated pressure mean: 0.4488442838191986
loss_pred:0.024611661210656166, decouple_loss:0.006487226113677025
Iteration: 1500, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4472939670085907
loss_pred:0.022426845505833626, decouple_loss:0.008793527260422707
The generated pressure mean: 0.44740036129951477
loss_pred:0.024404730647802353, decouple_loss:0.008849904872477055
The generated pressure mean: 0.4477756917476654
loss_pred:0.021980104967951775, decouple_loss:0.008881880901753902
2023-04-16 07:11:43 testing...
The generated pressure mean: 0.41996249556541443
loss_pred:0.03592676296830177, decouple_loss:0.007890717126429081
The generated pressure mean: 0.4279796779155731
loss_pred:0.034872591495513916, decouple_loss:0.008009551092982292
The generated pressure mean: 0.4331277906894684
loss_pred:0.03481321036815643, decouple_loss:0.008164830505847931
Loss: 0.03560527414083481, avg_mse: 0.048840153962373734
current test mse: 0.04884
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012002_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012002_3_24hr.npz
NaN value num: 0
Iteration: 1501, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44999197125434875
loss_pred:0.023706043139100075, decouple_loss:0.007298237178474665
The generated pressure mean: 0.45106828212738037
loss_pred:0.02224031649529934, decouple_loss:0.007755693979561329
The generated pressure mean: 0.4501807987689972
loss_pred:0.023915426805615425, decouple_loss:0.006877198815345764
Iteration: 1502, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4541597068309784
loss_pred:0.023412613198161125, decouple_loss:0.007576801348477602
The generated pressure mean: 0.45303595066070557
The generated pressure mean: 0.452690452337265
loss_pred:0.02215454913675785, decouple_loss:0.007296474650502205
loss_pred:0.02072913385927677, decouple_loss:0.007263957057148218
Iteration: 1503, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4370326101779938
loss_pred:0.02316681295633316, decouple_loss:0.007603374309837818
The generated pressure mean: 0.43904873728752136
loss_pred:0.02394772507250309, decouple_loss:0.0077024903148412704
The generated pressure mean: 0.44054925441741943
loss_pred:0.02257787622511387, decouple_loss:0.007873410359025002
Iteration: 1504, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45225095748901367
loss_pred:0.022292915731668472, decouple_loss:0.00711587630212307
The generated pressure mean: 0.4547612965106964
loss_pred:0.022878538817167282, decouple_loss:0.006692131515592337
The generated pressure mean: 0.4455801546573639
loss_pred:0.021502995863556862, decouple_loss:0.007255875039845705
Iteration: 1505, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45075997710227966
The generated pressure mean: 0.4507175385951996
loss_pred:0.0220932774245739, decouple_loss:0.007423514034599066
loss_pred:0.021368833258748055, decouple_loss:0.007305879145860672
The generated pressure mean: 0.44955116510391235
loss_pred:0.02358356863260269, decouple_loss:0.007341730408370495
Iteration: 1506, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4375321865081787
loss_pred:0.023373426869511604, decouple_loss:0.007202007342129946
The generated pressure mean: 0.4411712884902954
loss_pred:0.02329898066818714, decouple_loss:0.007523493375629187
The generated pressure mean: 0.4445527195930481
loss_pred:0.023977365344762802, decouple_loss:0.007274751551449299
Iteration: 1507, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4475155174732208
loss_pred:0.02378903701901436, decouple_loss:0.007302466779947281
The generated pressure mean: 0.4478805959224701
loss_pred:0.021908357739448547, decouple_loss:0.007426945026963949
The generated pressure mean: 0.4443548321723938
loss_pred:0.021886954084038734, decouple_loss:0.007092744577676058
Iteration: 1508, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45056816935539246
loss_pred:0.02286546677350998, decouple_loss:0.006506273057311773
The generated pressure mean: 0.4537593722343445
loss_pred:0.021089911460876465, decouple_loss:0.006332650780677795
The generated pressure mean: 0.45371586084365845
loss_pred:0.025198055431246758, decouple_loss:0.006125958636403084
Iteration: 1509, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4384171962738037
loss_pred:0.022947821766138077, decouple_loss:0.007501259446144104
The generated pressure mean: 0.4376579523086548
loss_pred:0.022867942228913307, decouple_loss:0.007697991095483303
The generated pressure mean: 0.43682822585105896
loss_pred:0.022911475971341133, decouple_loss:0.007511132396757603
Iteration: 1510, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45001310110092163
loss_pred:0.021076088771224022, decouple_loss:0.007630831561982632
The generated pressure mean: 0.4490469992160797
loss_pred:0.021755151450634003, decouple_loss:0.008228565566241741
The generated pressure mean: 0.4520769417285919
loss_pred:0.02102043107151985, decouple_loss:0.007906568236649036
2023-04-16 07:14:21 testing...
The generated pressure mean: 0.41729736328125
loss_pred:0.03642820566892624, decouple_loss:0.006629873998463154
The generated pressure mean: 0.42631202936172485
loss_pred:0.03510678559541702, decouple_loss:0.0066498504020273685
The generated pressure mean: 0.43082764744758606
loss_pred:0.035095538944005966, decouple_loss:0.007130361162126064
Loss: 0.03588367998600006, avg_mse: 0.05036747828125954
current test mse: 0.050367
Iteration: 1511, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.457895427942276
loss_pred:0.022270742803812027, decouple_loss:0.006218715570867062
The generated pressure mean: 0.46708399057388306
loss_pred:0.023065321147441864, decouple_loss:0.006136462092399597
The generated pressure mean: 0.45919069647789
loss_pred:0.02388296276330948, decouple_loss:0.005901179276406765
Iteration: 1512, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45108842849731445
loss_pred:0.02322768047451973, decouple_loss:0.00832702498883009
The generated pressure mean: 0.452465295791626The generated pressure mean: 0.44955340027809143
loss_pred:0.021389521658420563, decouple_loss:0.0076747373677790165loss_pred:0.02319365181028843, decouple_loss:0.00790716428309679
Iteration: 1513, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43445345759391785
loss_pred:0.023343998938798904, decouple_loss:0.00702710123732686
The generated pressure mean: 0.43745577335357666
loss_pred:0.020836617797613144, decouple_loss:0.0070952726528048515
The generated pressure mean: 0.4359970986843109
loss_pred:0.021760042756795883, decouple_loss:0.00711609423160553
Iteration: 1514, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43795886635780334
loss_pred:0.023726608604192734, decouple_loss:0.006816859822720289
The generated pressure mean: 0.4381614625453949
loss_pred:0.02241700515151024, decouple_loss:0.0073496513068675995
The generated pressure mean: 0.4450318515300751
loss_pred:0.023583825677633286, decouple_loss:0.007388380356132984
Iteration: 1515, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4552525579929352
loss_pred:0.02289825864136219, decouple_loss:0.006786370184272528
The generated pressure mean: 0.4555415213108063
loss_pred:0.020806333050131798, decouple_loss:0.006974789313971996
The generated pressure mean: 0.46073606610298157
loss_pred:0.022268196567893028, decouple_loss:0.007039579562842846
Iteration: 1516, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4509662389755249
loss_pred:0.02079773135483265, decouple_loss:0.007301087956875563
The generated pressure mean: 0.4514545798301697
loss_pred:0.023254159837961197, decouple_loss:0.0067651099525392056
The generated pressure mean: 0.4536614418029785
loss_pred:0.022464552894234657, decouple_loss:0.0069106207229197025
Iteration: 1517, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43538859486579895
loss_pred:0.023426197469234467, decouple_loss:0.007446396164596081
The generated pressure mean: 0.43946579098701477
loss_pred:0.021879788488149643, decouple_loss:0.007189317140728235
The generated pressure mean: 0.4343741834163666
loss_pred:0.021757453680038452, decouple_loss:0.0074805994518101215
Iteration: 1518, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4382878243923187
loss_pred:0.02165679633617401, decouple_loss:0.006935729179531336
The generated pressure mean: 0.4460560381412506
loss_pred:0.0213197972625494, decouple_loss:0.006692895665764809
The generated pressure mean: 0.43440571427345276
loss_pred:0.02035454846918583, decouple_loss:0.006850270088762045
Iteration: 1519, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45848751068115234
loss_pred:0.022287338972091675, decouple_loss:0.005823994986712933
The generated pressure mean: 0.45933812856674194
loss_pred:0.02026616968214512, decouple_loss:0.005823270883411169
The generated pressure mean: 0.461948037147522
loss_pred:0.023139899596571922, decouple_loss:0.005521760322153568
Iteration: 1520, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4600771367549896
loss_pred:0.023348115384578705, decouple_loss:0.006393529940396547
The generated pressure mean: 0.463845819234848
loss_pred:0.022504504770040512, decouple_loss:0.006768704392015934
The generated pressure mean: 0.46278685331344604
loss_pred:0.021896952763199806, decouple_loss:0.006485401187092066
2023-04-16 07:16:20 testing...
The generated pressure mean: 0.4226135015487671
loss_pred:0.03599372133612633, decouple_loss:0.007209236267954111
The generated pressure mean: 0.4326469600200653
loss_pred:0.03364803269505501, decouple_loss:0.00713176978752017
The generated pressure mean: 0.43701401352882385
loss_pred:0.034501608461141586, decouple_loss:0.007486040238291025
Loss: 0.03507824242115021, avg_mse: 0.04881197586655617
current test mse: 0.048812
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012010_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012010_3_24hr.npz
NaN value num: 0
Iteration: 1521, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43419960141181946
loss_pred:0.022596899420022964, decouple_loss:0.006830259691923857
The generated pressure mean: 0.4291808009147644
loss_pred:0.022618625313043594, decouple_loss:0.006787111982703209
The generated pressure mean: 0.4311326742172241
loss_pred:0.023775478824973106, decouple_loss:0.006910571362823248
Iteration: 1522, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4487939774990082
loss_pred:0.023221656680107117, decouple_loss:0.007329331710934639
The generated pressure mean: 0.44256383180618286
loss_pred:0.023136047646403313, decouple_loss:0.006876184139400721
The generated pressure mean: 0.4452414810657501
loss_pred:0.02282535284757614, decouple_loss:0.007137430366128683
Iteration: 1523, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45290741324424744
loss_pred:0.02256338857114315, decouple_loss:0.005845339968800545
The generated pressure mean: 0.44937485456466675
loss_pred:0.02235444262623787, decouple_loss:0.005781624466180801
The generated pressure mean: 0.4513651728630066
loss_pred:0.022812018170952797, decouple_loss:0.006052512675523758
Iteration: 1524, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4521302878856659
loss_pred:0.023731965571641922, decouple_loss:0.008143028244376183
The generated pressure mean: 0.4503193795681
loss_pred:0.02303396351635456, decouple_loss:0.008093887940049171
The generated pressure mean: 0.4504033923149109
loss_pred:0.023011095821857452, decouple_loss:0.00805366225540638
Iteration: 1525, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4326218366622925
loss_pred:0.026074105873703957, decouple_loss:0.008740165270864964
The generated pressure mean: 0.4374311864376068
loss_pred:0.02273997850716114, decouple_loss:0.008015917614102364
The generated pressure mean: 0.4384898841381073
loss_pred:0.025246694684028625, decouple_loss:0.008896570652723312
Iteration: 1526, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44461551308631897
loss_pred:0.022830430418252945, decouple_loss:0.00712450360879302
The generated pressure mean: 0.45016881823539734
loss_pred:0.02238539792597294, decouple_loss:0.007534311152994633
The generated pressure mean: 0.4477379024028778
loss_pred:0.02323940396308899, decouple_loss:0.007337698247283697
Iteration: 1527, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4586503505706787
loss_pred:0.024711763486266136, decouple_loss:0.006041189190000296
The generated pressure mean: 0.4577280879020691
loss_pred:0.02357291802763939, decouple_loss:0.00595959322527051
The generated pressure mean: 0.4534620940685272
loss_pred:0.023641051724553108, decouple_loss:0.005814533215016127
Iteration: 1528, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4488941431045532
loss_pred:0.022415200248360634, decouple_loss:0.006889576558023691
The generated pressure mean: 0.4460640549659729
loss_pred:0.023119425401091576, decouple_loss:0.0066724009811878204
The generated pressure mean: 0.44282564520835876
loss_pred:0.023717425763607025, decouple_loss:0.006707306485623121
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1529, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43394333124160767
The generated pressure mean: 0.43981924653053284loss_pred:0.023994507268071175, decouple_loss:0.006738264113664627
loss_pred:0.02292162925004959, decouple_loss:0.0068405913189053535
The generated pressure mean: 0.4358450770378113
loss_pred:0.022418824955821037, decouple_loss:0.007021802943199873
Iteration: 1530, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.451168954372406
loss_pred:0.023198040202260017, decouple_loss:0.00717442762106657
The generated pressure mean: 0.44583427906036377
loss_pred:0.022034544497728348, decouple_loss:0.006662470754235983
The generated pressure mean: 0.455208420753479
loss_pred:0.023430541157722473, decouple_loss:0.0068009342066943645
2023-04-16 07:18:57 testing...
The generated pressure mean: 0.417908638715744
loss_pred:0.03589439392089844, decouple_loss:0.007197576574981213
The generated pressure mean: 0.4262074828147888
loss_pred:0.03426307439804077, decouple_loss:0.007542444858700037
The generated pressure mean: 0.4304770529270172
loss_pred:0.03493007645010948, decouple_loss:0.007611307315528393
Loss: 0.03540170192718506, avg_mse: 0.04895759001374245
current test mse: 0.048958
Iteration: 1531, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44985660910606384
loss_pred:0.022470589727163315, decouple_loss:0.0071271853521466255
The generated pressure mean: 0.44950807094573975
loss_pred:0.021713022142648697, decouple_loss:0.006607047747820616
The generated pressure mean: 0.4522012174129486
loss_pred:0.022390911355614662, decouple_loss:0.006638196762651205
Iteration: 1532, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4427719712257385
loss_pred:0.023940378800034523, decouple_loss:0.007014756090939045
The generated pressure mean: 0.4401777982711792
loss_pred:0.022896569222211838, decouple_loss:0.007220757659524679
The generated pressure mean: 0.4366642236709595
loss_pred:0.023390693590044975, decouple_loss:0.006765460595488548
Iteration: 1533, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4460751712322235
loss_pred:0.023547383025288582, decouple_loss:0.006074211560189724
The generated pressure mean: 0.4459165930747986
loss_pred:0.022789794951677322, decouple_loss:0.006012168247252703
The generated pressure mean: 0.4467763602733612
loss_pred:0.024338025599718094, decouple_loss:0.0062454319559037685
Iteration: 1534, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4567773640155792
loss_pred:0.023095164448022842, decouple_loss:0.00617938581854105
The generated pressure mean: 0.4533664286136627
loss_pred:0.02235693484544754, decouple_loss:0.006746932864189148
The generated pressure mean: 0.4517941474914551
loss_pred:0.02292465791106224, decouple_loss:0.006223548203706741
Iteration: 1535, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4441920816898346
loss_pred:0.023663479834794998, decouple_loss:0.005950486287474632
The generated pressure mean: 0.4436030089855194
loss_pred:0.023300014436244965, decouple_loss:0.005922603886574507
The generated pressure mean: 0.4467415511608124
loss_pred:0.02360358089208603, decouple_loss:0.005858064629137516
Iteration: 1536, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44322630763053894
loss_pred:0.023135608062148094, decouple_loss:0.006526912562549114
The generated pressure mean: 0.4485013782978058
loss_pred:0.022556543350219727, decouple_loss:0.006045595742762089
The generated pressure mean: 0.44024938344955444
loss_pred:0.024470999836921692, decouple_loss:0.006174422800540924
Iteration: 1537, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45171764492988586
loss_pred:0.02186439372599125, decouple_loss:0.006287170108407736
The generated pressure mean: 0.44531288743019104
loss_pred:0.024095354601740837, decouple_loss:0.006199537310749292
The generated pressure mean: 0.44649291038513184
loss_pred:0.023607222363352776, decouple_loss:0.006212273612618446
Iteration: 1538, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4447915852069855
loss_pred:0.023190462961792946, decouple_loss:0.006194824818521738
The generated pressure mean: 0.44344276189804077
loss_pred:0.021648559719324112, decouple_loss:0.0064441184513270855
The generated pressure mean: 0.4437200427055359
loss_pred:0.023892207071185112, decouple_loss:0.0059268842451274395
Iteration: 1539, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45186179876327515
loss_pred:0.023179030045866966, decouple_loss:0.005685575306415558
The generated pressure mean: 0.4482811391353607
loss_pred:0.02246670424938202, decouple_loss:0.005873457994312048
The generated pressure mean: 0.4493198096752167
loss_pred:0.023822585120797157, decouple_loss:0.005817842204123735
Iteration: 1540, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4498664140701294
loss_pred:0.022722767665982246, decouple_loss:0.005244435742497444
The generated pressure mean: 0.44857057929039
loss_pred:0.021996265277266502, decouple_loss:0.00522600905969739
The generated pressure mean: 0.44784313440322876
loss_pred:0.02393040806055069, decouple_loss:0.005646346136927605
2023-04-16 07:20:57 testing...
The generated pressure mean: 0.4193364083766937
loss_pred:0.03573763370513916, decouple_loss:0.00715103792026639
The generated pressure mean: 0.4294000566005707
loss_pred:0.03433333709836006, decouple_loss:0.007186399307101965
The generated pressure mean: 0.4349483549594879
loss_pred:0.03455085679888725, decouple_loss:0.007418818771839142
Loss: 0.03523654863238335, avg_mse: 0.04879464954137802
current test mse: 0.048795
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012006_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012006_3_24hr.npz
NaN value num: 0
Iteration: 1541, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44490593671798706
loss_pred:0.02305849827826023, decouple_loss:0.006607238203287125
The generated pressure mean: 0.4422667324542999
loss_pred:0.022491032257676125, decouple_loss:0.006575653329491615
The generated pressure mean: 0.446689248085022
loss_pred:0.022710299119353294, decouple_loss:0.006372550968080759
Iteration: 1542, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4410792291164398
loss_pred:0.0224933922290802, decouple_loss:0.00721578998491168
The generated pressure mean: 0.43619558215141296
loss_pred:0.02369508519768715, decouple_loss:0.007422476075589657
The generated pressure mean: 0.4417954683303833
loss_pred:0.022766238078475, decouple_loss:0.00750714773312211
Iteration: 1543, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4513623118400574
loss_pred:0.02180480770766735, decouple_loss:0.007010657340288162
The generated pressure mean: 0.4546375572681427
loss_pred:0.02382691577076912, decouple_loss:0.0069273984991014
The generated pressure mean: 0.4516599178314209
loss_pred:0.022113965824246407, decouple_loss:0.007141266483813524
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1544, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45778369903564453
loss_pred:0.021947886794805527, decouple_loss:0.005034804809838533
The generated pressure mean: 0.45699530839920044
loss_pred:0.0232594795525074, decouple_loss:0.005075918510556221
The generated pressure mean: 0.45880165696144104
loss_pred:0.022188354283571243, decouple_loss:0.005230526905506849
Iteration: 1545, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4427015483379364
loss_pred:0.024818820878863335, decouple_loss:0.0072555141523480415
The generated pressure mean: 0.4463426172733307
loss_pred:0.02350892871618271, decouple_loss:0.006893344223499298
The generated pressure mean: 0.44573163986206055
loss_pred:0.02212219312787056, decouple_loss:0.007069732062518597
Iteration: 1546, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.42723798751831055
loss_pred:0.0225219689309597, decouple_loss:0.00763247674331069
The generated pressure mean: 0.4271121621131897
loss_pred:0.02307121269404888, decouple_loss:0.007856719195842743
The generated pressure mean: 0.4292133152484894
loss_pred:0.021667610853910446, decouple_loss:0.007973937317728996
Iteration: 1547, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45231738686561584
The generated pressure mean: 0.4499094784259796
loss_pred:0.023548100143671036, decouple_loss:0.007101478986442089
loss_pred:0.022518344223499298, decouple_loss:0.006411728449165821
The generated pressure mean: 0.4416123330593109
loss_pred:0.023105014115571976, decouple_loss:0.006871656980365515
Iteration: 1548, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4609896242618561
loss_pred:0.022994514554739, decouple_loss:0.007004913873970509
The generated pressure mean: 0.4629991054534912
loss_pred:0.024072697386145592, decouple_loss:0.006778514012694359
The generated pressure mean: 0.46626806259155273
loss_pred:0.023264190182089806, decouple_loss:0.006625379901379347
Iteration: 1549, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.448259562253952
loss_pred:0.02211943082511425, decouple_loss:0.006548261269927025
The generated pressure mean: 0.443666011095047
loss_pred:0.024136247113347054, decouple_loss:0.006368123460561037
The generated pressure mean: 0.4428968131542206
loss_pred:0.02305026352405548, decouple_loss:0.006549325305968523
Iteration: 1550, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.42775046825408936
loss_pred:0.02414723113179207, decouple_loss:0.007226255256682634
The generated pressure mean: 0.42812788486480713
loss_pred:0.02357267215847969, decouple_loss:0.007478097919374704
The generated pressure mean: 0.4291934370994568
loss_pred:0.02269953303039074, decouple_loss:0.007689958438277245
2023-04-16 07:23:40 testing...
The generated pressure mean: 0.41510245203971863
loss_pred:0.035660356283187866, decouple_loss:0.007024419028311968
The generated pressure mean: 0.42311903834342957
loss_pred:0.03434039652347565, decouple_loss:0.007083012256771326
The generated pressure mean: 0.42650681734085083
loss_pred:0.03490106761455536, decouple_loss:0.007326441816985607
Loss: 0.03532450646162033, avg_mse: 0.04903100058436394
current test mse: 0.049031
Iteration: 1551, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.455058217048645
loss_pred:0.023648003116250038, decouple_loss:0.0065453192219138145
The generated pressure mean: 0.45753178000450134
loss_pred:0.02267879620194435, decouple_loss:0.006695816293358803
The generated pressure mean: 0.4537418782711029
loss_pred:0.023198839277029037, decouple_loss:0.006801696494221687
Iteration: 1552, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.464097797870636
loss_pred:0.02221084199845791, decouple_loss:0.0065946257673203945
The generated pressure mean: 0.46338140964508057
loss_pred:0.023430779576301575, decouple_loss:0.0065672071650624275
The generated pressure mean: 0.4596090316772461
loss_pred:0.022267935797572136, decouple_loss:0.006637608632445335
Iteration: 1553, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4429612457752228
loss_pred:0.02213994227349758, decouple_loss:0.007346555590629578
The generated pressure mean: 0.445736289024353
loss_pred:0.02394876256585121, decouple_loss:0.007161557674407959
The generated pressure mean: 0.4464013874530792
loss_pred:0.023130079731345177, decouple_loss:0.007365534547716379
Iteration: 1554, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4310948848724365
loss_pred:0.022675786167383194, decouple_loss:0.007189834024757147
The generated pressure mean: 0.42607566714286804
loss_pred:0.022927414625883102, decouple_loss:0.007281518075615168
The generated pressure mean: 0.4230700135231018
loss_pred:0.02270379289984703, decouple_loss:0.007175785023719072
Iteration: 1555, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4463179111480713
loss_pred:0.02248426340520382, decouple_loss:0.00732880225405097
The generated pressure mean: 0.4465426802635193
loss_pred:0.024464448913931847, decouple_loss:0.00711227348074317
The generated pressure mean: 0.44981202483177185
loss_pred:0.02335967868566513, decouple_loss:0.006939683575183153
Iteration: 1556, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.472433477640152
loss_pred:0.023172250017523766, decouple_loss:0.009055391885340214
The generated pressure mean: 0.4689224660396576
loss_pred:0.023439548909664154, decouple_loss:0.009705563075840473
The generated pressure mean: 0.47434237599372864
loss_pred:0.022545531392097473, decouple_loss:0.008918501436710358
Iteration: 1557, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.439582884311676
loss_pred:0.023286771029233932, decouple_loss:0.006229964550584555
The generated pressure mean: 0.44070693850517273
loss_pred:0.023882610723376274, decouple_loss:0.006215886678546667
The generated pressure mean: 0.4399925172328949
loss_pred:0.023051276803016663, decouple_loss:0.006293592043220997
Iteration: 1558, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4333726763725281
loss_pred:0.02231728285551071, decouple_loss:0.006022172048687935
The generated pressure mean: 0.4377171993255615
loss_pred:0.02278817445039749, decouple_loss:0.006083087529987097
The generated pressure mean: 0.4376280605792999
loss_pred:0.023707883432507515, decouple_loss:0.006169647444039583
Iteration: 1559, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44878876209259033
loss_pred:0.022312145680189133, decouple_loss:0.006609522271901369
The generated pressure mean: 0.44718077778816223
loss_pred:0.023214168846607208, decouple_loss:0.007362443953752518
The generated pressure mean: 0.4516960382461548
loss_pred:0.0234297513961792, decouple_loss:0.006895813159644604
Iteration: 1560, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4480105936527252
loss_pred:0.023267420008778572, decouple_loss:0.007005501538515091
The generated pressure mean: 0.4487939178943634
loss_pred:0.022434568032622337, decouple_loss:0.0070801652036607265
The generated pressure mean: 0.45081019401550293
loss_pred:0.02313701994717121, decouple_loss:0.0068736025132238865
2023-04-16 07:25:39 testing...
The generated pressure mean: 0.4185115694999695
loss_pred:0.03534381091594696, decouple_loss:0.006309595890343189
The generated pressure mean: 0.4295651316642761
loss_pred:0.03445577621459961, decouple_loss:0.006565587595105171
The generated pressure mean: 0.4338028132915497
loss_pred:0.03484348580241203, decouple_loss:0.006928388029336929
Loss: 0.03521108627319336, avg_mse: 0.049017518758773804
current test mse: 0.049018
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012006_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012006_3_24hr.npz
NaN value num: 0
Iteration: 1561, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44298285245895386
loss_pred:0.02248971350491047, decouple_loss:0.005984376650303602
The generated pressure mean: 0.44915834069252014
The generated pressure mean: 0.4437664747238159
loss_pred:0.021296054124832153, decouple_loss:0.005792875774204731
loss_pred:0.02351074106991291, decouple_loss:0.005906939506530762
Iteration: 1562, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44710707664489746
loss_pred:0.024813491851091385, decouple_loss:0.006640088278800249
The generated pressure mean: 0.45446857810020447
The generated pressure mean: 0.4489095211029053
loss_pred:0.022667841985821724, decouple_loss:0.007530332542955875
loss_pred:0.021772127598524094, decouple_loss:0.006952200550585985
Iteration: 1563, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44647809863090515
loss_pred:0.023131992667913437, decouple_loss:0.0067367106676101685
The generated pressure mean: 0.4467138946056366
loss_pred:0.02174360863864422, decouple_loss:0.006604484748095274
The generated pressure mean: 0.448071151971817
loss_pred:0.021827450022101402, decouple_loss:0.006399120669811964
Iteration: 1564, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44155314564704895
The generated pressure mean: 0.4444538950920105
loss_pred:0.024204129353165627, decouple_loss:0.007848174311220646
loss_pred:0.02269090712070465, decouple_loss:0.007822916842997074
The generated pressure mean: 0.4445037245750427
loss_pred:0.022596800699830055, decouple_loss:0.007851370610296726
Iteration: 1565, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44653043150901794
loss_pred:0.021494030952453613, decouple_loss:0.006824739743024111
The generated pressure mean: 0.4459197521209717
loss_pred:0.022807858884334564, decouple_loss:0.006756676360964775
The generated pressure mean: 0.4444333016872406
loss_pred:0.021179335191845894, decouple_loss:0.007073619868606329
Iteration: 1566, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45772337913513184
loss_pred:0.022820428013801575, decouple_loss:0.007225024979561567
The generated pressure mean: 0.45262831449508667
loss_pred:0.02279006876051426, decouple_loss:0.007487741764634848
The generated pressure mean: 0.4521350562572479
loss_pred:0.02171142026782036, decouple_loss:0.007780327927321196
Iteration: 1567, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4528089761734009
loss_pred:0.02125379629433155, decouple_loss:0.006559537257999182
The generated pressure mean: 0.4544942080974579
loss_pred:0.023380059748888016, decouple_loss:0.006537921726703644
The generated pressure mean: 0.45466649532318115
loss_pred:0.020713472738862038, decouple_loss:0.006300798151642084
Iteration: 1568, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4389515817165375
loss_pred:0.021884677931666374, decouple_loss:0.006299357861280441
The generated pressure mean: 0.4393928349018097
loss_pred:0.0220059622079134, decouple_loss:0.006286334246397018
The generated pressure mean: 0.4438483417034149
loss_pred:0.024669446051120758, decouple_loss:0.0067214625887572765
Iteration: 1569, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4344148337841034
loss_pred:0.024082694202661514, decouple_loss:0.0059290071949362755
The generated pressure mean: 0.4391852617263794
loss_pred:0.021112369373440742, decouple_loss:0.005952134262770414
The generated pressure mean: 0.4361109733581543
loss_pred:0.02130964957177639, decouple_loss:0.005798769649118185
Iteration: 1570, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45958811044692993
loss_pred:0.022891398519277573, decouple_loss:0.006473319139331579
The generated pressure mean: 0.45260417461395264
loss_pred:0.024828903377056122, decouple_loss:0.0067230830900371075
The generated pressure mean: 0.4549993574619293
loss_pred:0.0215831957757473, decouple_loss:0.006282334215939045
2023-04-16 07:28:17 testing...
The generated pressure mean: 0.4178905487060547
loss_pred:0.034925445914268494, decouple_loss:0.006670510862022638
The generated pressure mean: 0.4267248809337616
loss_pred:0.03479493409395218, decouple_loss:0.006858143024146557
The generated pressure mean: 0.43125784397125244
loss_pred:0.03410003334283829, decouple_loss:0.007158520631492138
Loss: 0.0349515900015831, avg_mse: 0.048265986144542694
current test mse: 0.048266
Iteration: 1571, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4507557451725006
loss_pred:0.022486459463834763, decouple_loss:0.005876266863197088
The generated pressure mean: 0.44893521070480347
loss_pred:0.022378362715244293, decouple_loss:0.005893357563763857
The generated pressure mean: 0.4469265639781952
loss_pred:0.02255145087838173, decouple_loss:0.0061378031969070435
Iteration: 1572, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44500648975372314
loss_pred:0.02333320677280426, decouple_loss:0.005780680105090141
The generated pressure mean: 0.45143619179725647
loss_pred:0.023815583437681198, decouple_loss:0.006059609819203615
The generated pressure mean: 0.4464035630226135
loss_pred:0.023669013753533363, decouple_loss:0.006093461997807026
Iteration: 1573, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4508850574493408
loss_pred:0.021950891241431236, decouple_loss:0.006390920374542475
The generated pressure mean: 0.44811996817588806
loss_pred:0.021491743624210358, decouple_loss:0.006369332317262888
The generated pressure mean: 0.4496988356113434
loss_pred:0.02178538776934147, decouple_loss:0.006320550572127104
Iteration: 1574, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45459985733032227
loss_pred:0.02182593010365963, decouple_loss:0.005818665027618408
The generated pressure mean: 0.4520321190357208
loss_pred:0.022188831120729446, decouple_loss:0.005376066081225872
The generated pressure mean: 0.45164015889167786
loss_pred:0.021772852167487144, decouple_loss:0.006092342548072338
Iteration: 1575, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4500768780708313
loss_pred:0.02128244750201702, decouple_loss:0.006884328555315733
The generated pressure mean: 0.44974857568740845
loss_pred:0.021774927154183388, decouple_loss:0.006717226468026638
The generated pressure mean: 0.44738665223121643
loss_pred:0.022043434903025627, decouple_loss:0.007161747198551893
Iteration: 1576, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43699854612350464
loss_pred:0.02157779596745968, decouple_loss:0.005699071101844311
The generated pressure mean: 0.4404723048210144
loss_pred:0.02127237059175968, decouple_loss:0.005894075613468885
The generated pressure mean: 0.4398943781852722
loss_pred:0.022799428552389145, decouple_loss:0.005714993458241224
Iteration: 1577, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4451514482498169
loss_pred:0.022494012489914894, decouple_loss:0.005734081845730543
The generated pressure mean: 0.44895485043525696
loss_pred:0.021643906831741333, decouple_loss:0.005656386725604534
The generated pressure mean: 0.44292256236076355
loss_pred:0.021847601979970932, decouple_loss:0.005496102850884199
Iteration: 1578, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.450833797454834
loss_pred:0.022836986929178238, decouple_loss:0.006156278774142265
The generated pressure mean: 0.44541308283805847
loss_pred:0.022251306101679802, decouple_loss:0.006172997877001762
The generated pressure mean: 0.4506863057613373
loss_pred:0.021405257284641266, decouple_loss:0.006555402185767889
Iteration: 1579, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45039740204811096
loss_pred:0.021964265033602715, decouple_loss:0.006029999349266291
The generated pressure mean: 0.45201292634010315
loss_pred:0.022632699459791183, decouple_loss:0.005971760489046574
The generated pressure mean: 0.4508378505706787
loss_pred:0.021236736327409744, decouple_loss:0.00585857592523098
Iteration: 1580, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4486154317855835
loss_pred:0.023222623392939568, decouple_loss:0.006937527563422918
The generated pressure mean: 0.4512522220611572
loss_pred:0.021176960319280624, decouple_loss:0.006755303591489792
The generated pressure mean: 0.45412251353263855
loss_pred:0.022032050415873528, decouple_loss:0.007108595687896013
2023-04-16 07:30:17 testing...
The generated pressure mean: 0.4204510450363159
loss_pred:0.03612635284662247, decouple_loss:0.007027546409517527
The generated pressure mean: 0.42846396565437317
loss_pred:0.034451235085725784, decouple_loss:0.007090330123901367
The generated pressure mean: 0.4330979585647583
loss_pred:0.034964170306921005, decouple_loss:0.007431824691593647
Loss: 0.03553975000977516, avg_mse: 0.04976683109998703
current test mse: 0.049767
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012015_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012015_3_24hr.npz
NaN value num: 0
Iteration: 1581, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44521069526672363
loss_pred:0.022692792117595673, decouple_loss:0.0067855920642614365
The generated pressure mean: 0.44629377126693726
loss_pred:0.025217171758413315, decouple_loss:0.006324245594441891
The generated pressure mean: 0.44742387533187866
loss_pred:0.023177552968263626, decouple_loss:0.006536936387419701
Iteration: 1582, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43692606687545776
loss_pred:0.024875277653336525, decouple_loss:0.005448899231851101
The generated pressure mean: 0.4397558867931366
The generated pressure mean: 0.43790534138679504loss_pred:0.02291330136358738, decouple_loss:0.00530432490631938
loss_pred:0.023416105657815933, decouple_loss:0.005573249887675047
Iteration: 1583, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44833818078041077
loss_pred:0.0220792256295681, decouple_loss:0.005896316841244698
The generated pressure mean: 0.44219186902046204
loss_pred:0.023590514436364174, decouple_loss:0.006055581849068403
The generated pressure mean: 0.44551706314086914
loss_pred:0.023642955347895622, decouple_loss:0.005812047515064478
Iteration: 1584, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4612572491168976
loss_pred:0.02221035212278366, decouple_loss:0.005688055418431759
The generated pressure mean: 0.45964890718460083
loss_pred:0.024261729791760445, decouple_loss:0.005669855047017336
The generated pressure mean: 0.46265023946762085
loss_pred:0.023912517353892326, decouple_loss:0.005885740276426077
Iteration: 1585, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.449131041765213
loss_pred:0.02300039492547512, decouple_loss:0.005590702407062054
The generated pressure mean: 0.4409603476524353
loss_pred:0.023455148562788963, decouple_loss:0.006003125570714474
The generated pressure mean: 0.4461827576160431
loss_pred:0.024125415831804276, decouple_loss:0.005502957850694656
Iteration: 1586, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4388967752456665
loss_pred:0.024105478078126907, decouple_loss:0.006046396214514971
The generated pressure mean: 0.4358493387699127
loss_pred:0.022464081645011902, decouple_loss:0.005851626396179199
The generated pressure mean: 0.43233487010002136
loss_pred:0.023098766803741455, decouple_loss:0.0062955147586762905
Iteration: 1587, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44253942370414734
loss_pred:0.022093897685408592, decouple_loss:0.006395651958882809
The generated pressure mean: 0.4393751919269562
loss_pred:0.022472230717539787, decouple_loss:0.006205487996339798
The generated pressure mean: 0.44196006655693054
loss_pred:0.02331622876226902, decouple_loss:0.006569273769855499
Iteration: 1588, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4582533836364746
loss_pred:0.022550465539097786, decouple_loss:0.005620985291898251
The generated pressure mean: 0.45794999599456787
loss_pred:0.023488560691475868, decouple_loss:0.005528776906430721
The generated pressure mean: 0.46271446347236633
loss_pred:0.02266128920018673, decouple_loss:0.005967274308204651
Iteration: 1589, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45146644115448
loss_pred:0.022243309766054153, decouple_loss:0.0063949706964194775
The generated pressure mean: 0.4459318518638611
loss_pred:0.02238689549267292, decouple_loss:0.006724235136061907
The generated pressure mean: 0.45312756299972534
loss_pred:0.024552928283810616, decouple_loss:0.00649765320122242
Iteration: 1590, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4472830891609192
loss_pred:0.02267996035516262, decouple_loss:0.006810846272855997
The generated pressure mean: 0.44245076179504395
loss_pred:0.022259123623371124, decouple_loss:0.006430810783058405
The generated pressure mean: 0.4485762119293213
loss_pred:0.023317601531744003, decouple_loss:0.006813914515078068
2023-04-16 07:32:49 testing...
The generated pressure mean: 0.4206446707248688
loss_pred:0.035549096763134, decouple_loss:0.006585284601897001
The generated pressure mean: 0.4275011122226715
loss_pred:0.03472404554486275, decouple_loss:0.006866367533802986
The generated pressure mean: 0.4324018359184265
loss_pred:0.034823544323444366, decouple_loss:0.006896470673382282
Loss: 0.035371363162994385, avg_mse: 0.0493786484003067
current test mse: 0.049379
Iteration: 1591, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44314587116241455
loss_pred:0.02326185442507267, decouple_loss:0.005848942324519157
The generated pressure mean: 0.43980422616004944
loss_pred:0.021859435364603996, decouple_loss:0.0059169381856918335
The generated pressure mean: 0.44320380687713623
loss_pred:0.022962136194109917, decouple_loss:0.005786749068647623
Iteration: 1592, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4452912509441376
loss_pred:0.022573597729206085, decouple_loss:0.006637577898800373
The generated pressure mean: 0.43925419449806213
loss_pred:0.023258311673998833, decouple_loss:0.006447289604693651
The generated pressure mean: 0.4426850378513336
loss_pred:0.02170621044933796, decouple_loss:0.006789172999560833
Iteration: 1593, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4358578026294708
loss_pred:0.023317581042647362, decouple_loss:0.005762579385191202
The generated pressure mean: 0.44640490412712097
loss_pred:0.02217835932970047, decouple_loss:0.005646022502332926
The generated pressure mean: 0.4414738714694977
loss_pred:0.022059757262468338, decouple_loss:0.005286228843033314
Iteration: 1594, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46014678478240967
loss_pred:0.022999493405222893, decouple_loss:0.006809224374592304
The generated pressure mean: 0.45373010635375977
loss_pred:0.02241946943104267, decouple_loss:0.0067034210078418255
The generated pressure mean: 0.45905449986457825
loss_pred:0.022474294528365135, decouple_loss:0.00647332426160574
Iteration: 1595, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46026313304901123
loss_pred:0.02366451360285282, decouple_loss:0.005555668845772743
The generated pressure mean: 0.4620587229728699
loss_pred:0.02235395647585392, decouple_loss:0.00566734978929162
The generated pressure mean: 0.45613908767700195
loss_pred:0.022969134151935577, decouple_loss:0.0059984843246638775
Iteration: 1596, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43611055612564087
loss_pred:0.023176284506917, decouple_loss:0.005834951065480709
The generated pressure mean: 0.4339766204357147
loss_pred:0.023608673363924026, decouple_loss:0.006112335715442896
The generated pressure mean: 0.43548324704170227
loss_pred:0.022753357887268066, decouple_loss:0.006051193922758102
Iteration: 1597, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43519267439842224
The generated pressure mean: 0.4416073262691498
loss_pred:0.02274945005774498, decouple_loss:0.007167103700339794
loss_pred:0.026568571105599403, decouple_loss:0.007250778842717409
The generated pressure mean: 0.4415663778781891
loss_pred:0.02338743582367897, decouple_loss:0.007102101109921932
Iteration: 1598, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43275687098503113
loss_pred:0.022453974932432175, decouple_loss:0.006404193118214607
The generated pressure mean: 0.43968886137008667
loss_pred:0.02376781962811947, decouple_loss:0.006554791703820229
The generated pressure mean: 0.4328974783420563
loss_pred:0.02346184477210045, decouple_loss:0.00620726915076375
Iteration: 1599, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46448060870170593
loss_pred:0.02207099460065365, decouple_loss:0.006346061825752258
The generated pressure mean: 0.46540239453315735
loss_pred:0.023764489218592644, decouple_loss:0.00654443446546793
The generated pressure mean: 0.4576689898967743
loss_pred:0.023140892386436462, decouple_loss:0.006422253325581551
Iteration: 1600, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45348086953163147
loss_pred:0.02375810593366623, decouple_loss:0.005577627569437027
The generated pressure mean: 0.4581485688686371
loss_pred:0.022754603996872902, decouple_loss:0.005798330996185541
The generated pressure mean: 0.4538828432559967
loss_pred:0.023522282019257545, decouple_loss:0.005491053219884634
2023-04-16 07:34:49 testing...
The generated pressure mean: 0.4212099611759186
loss_pred:0.03560252860188484, decouple_loss:0.006681358907371759
The generated pressure mean: 0.429177850484848
loss_pred:0.03441466763615608, decouple_loss:0.0069570704363286495
The generated pressure mean: 0.43407267332077026
loss_pred:0.03451530262827873, decouple_loss:0.00718576880171895
Loss: 0.035191237926483154, avg_mse: 0.04965217038989067
current test mse: 0.049652
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012020_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012020_3_24hr.npz
NaN value num: 0
Iteration: 1601, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4459046721458435
loss_pred:0.022344054654240608, decouple_loss:0.006151380483061075
The generated pressure mean: 0.4428583085536957
loss_pred:0.02306985668838024, decouple_loss:0.006240405607968569
The generated pressure mean: 0.43708571791648865
loss_pred:0.022574735805392265, decouple_loss:0.006489654537290335
Iteration: 1602, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43991005420684814
loss_pred:0.023739246651530266, decouple_loss:0.006456553936004639
The generated pressure mean: 0.44958388805389404
loss_pred:0.02324339561164379, decouple_loss:0.006037264131009579
The generated pressure mean: 0.44914740324020386
loss_pred:0.0245758555829525, decouple_loss:0.0059341201558709145
Iteration: 1603, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45117539167404175
loss_pred:0.02288157306611538, decouple_loss:0.006562237162142992
The generated pressure mean: 0.450899213552475
loss_pred:0.024554111063480377, decouple_loss:0.006573688704520464
The generated pressure mean: 0.45136210322380066
loss_pred:0.022807849571108818, decouple_loss:0.006094607524573803
Iteration: 1604, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4493228495121002
loss_pred:0.023317428305745125, decouple_loss:0.007627340964972973
The generated pressure mean: 0.44922709465026855
loss_pred:0.023055432364344597, decouple_loss:0.00752861937507987
The generated pressure mean: 0.44969555735588074
loss_pred:0.02313223108649254, decouple_loss:0.007322205696254969
Iteration: 1605, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4486725330352783
loss_pred:0.023643316701054573, decouple_loss:0.007959643378853798
The generated pressure mean: 0.4513654410839081
loss_pred:0.024683665484189987, decouple_loss:0.008055491372942924
The generated pressure mean: 0.45099398493766785
loss_pred:0.022090468555688858, decouple_loss:0.00852809939533472
Iteration: 1606, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.446372389793396
loss_pred:0.0244002565741539, decouple_loss:0.007609959226101637
The generated pressure mean: 0.44771894812583923
loss_pred:0.02289416827261448, decouple_loss:0.0074161626398563385
The generated pressure mean: 0.4461805820465088
loss_pred:0.023898983374238014, decouple_loss:0.007570080924779177
Iteration: 1607, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4493016302585602
loss_pred:0.02205229550600052, decouple_loss:0.0064659761264920235
The generated pressure mean: 0.4491962790489197
loss_pred:0.02347838692367077, decouple_loss:0.006820786278694868
The generated pressure mean: 0.4532833695411682
loss_pred:0.022501004859805107, decouple_loss:0.0068312156945466995
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1608, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4473731517791748
loss_pred:0.023036658763885498, decouple_loss:0.007175829727202654
The generated pressure mean: 0.45558252930641174
loss_pred:0.02303583361208439, decouple_loss:0.0073140948079526424
The generated pressure mean: 0.44957664608955383
loss_pred:0.022631775587797165, decouple_loss:0.007503026630729437
Iteration: 1609, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.446569561958313
loss_pred:0.02245158515870571, decouple_loss:0.006058868486434221
The generated pressure mean: 0.4424935281276703
loss_pred:0.02408422902226448, decouple_loss:0.005895870737731457
The generated pressure mean: 0.44295936822891235
loss_pred:0.023013880476355553, decouple_loss:0.005941392853856087
Iteration: 1610, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4474759101867676
loss_pred:0.022561920806765556, decouple_loss:0.006634115241467953
The generated pressure mean: 0.44474348425865173
loss_pred:0.023961888626217842, decouple_loss:0.0064076827839016914
The generated pressure mean: 0.4535101652145386
loss_pred:0.023627527058124542, decouple_loss:0.006496630143374205
2023-04-16 07:37:23 testing...
The generated pressure mean: 0.4203709661960602
loss_pred:0.03405860438942909, decouple_loss:0.006900349631905556
The generated pressure mean: 0.42694950103759766
loss_pred:0.033399809151887894, decouple_loss:0.007076160982251167
The generated pressure mean: 0.43165087699890137
loss_pred:0.03377557173371315, decouple_loss:0.00720445578917861
Loss: 0.03409767895936966, avg_mse: 0.04714272543787956
current test mse: 0.047143
Iteration: 1611, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4469267725944519
loss_pred:0.02302105352282524, decouple_loss:0.006843168288469315
The generated pressure mean: 0.44920551776885986
loss_pred:0.024759560823440552, decouple_loss:0.006824555806815624
The generated pressure mean: 0.4454195499420166
loss_pred:0.022731343284249306, decouple_loss:0.006873216945677996
Iteration: 1612, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4435931444168091
loss_pred:0.023082083091139793, decouple_loss:0.006881031207740307
The generated pressure mean: 0.4423989951610565
loss_pred:0.023292280733585358, decouple_loss:0.006592740770429373
The generated pressure mean: 0.43671050667762756
loss_pred:0.022292988374829292, decouple_loss:0.006814492400735617
Iteration: 1613, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4576275050640106
loss_pred:0.02276207134127617, decouple_loss:0.006667819805443287
The generated pressure mean: 0.4563104808330536
loss_pred:0.022637486457824707, decouple_loss:0.00648054014891386
The generated pressure mean: 0.4542630612850189
loss_pred:0.023919302970170975, decouple_loss:0.00636764382943511
Iteration: 1614, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46157771348953247
loss_pred:0.023356540128588676, decouple_loss:0.005858432501554489
The generated pressure mean: 0.4570951759815216
loss_pred:0.022376971319317818, decouple_loss:0.005818288307636976
The generated pressure mean: 0.46100670099258423
loss_pred:0.023547710850834846, decouple_loss:0.0061431038193404675
Iteration: 1615, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4451369345188141
loss_pred:0.02325403317809105, decouple_loss:0.007312060333788395
The generated pressure mean: 0.44492343068122864
loss_pred:0.022898687049746513, decouple_loss:0.00760111678391695
The generated pressure mean: 0.4389585852622986
loss_pred:0.025914261117577553, decouple_loss:0.0073476387187838554
Iteration: 1616, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43262922763824463
loss_pred:0.02275840751826763, decouple_loss:0.005662593990564346
The generated pressure mean: 0.4404902756214142
loss_pred:0.02313670516014099, decouple_loss:0.005389838013797998
The generated pressure mean: 0.4385598301887512
loss_pred:0.02280484326183796, decouple_loss:0.005326521582901478
Iteration: 1617, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44579336047172546
loss_pred:0.024432705715298653, decouple_loss:0.007604667451232672
The generated pressure mean: 0.4491812586784363
loss_pred:0.023664386942982674, decouple_loss:0.007656131871044636
The generated pressure mean: 0.4510499835014343
loss_pred:0.02445441484451294, decouple_loss:0.007457381580024958
Iteration: 1618, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45771491527557373
loss_pred:0.023585207760334015, decouple_loss:0.007330284453928471
The generated pressure mean: 0.4546462297439575
loss_pred:0.02190895564854145, decouple_loss:0.007065349258482456
The generated pressure mean: 0.45091888308525085
loss_pred:0.021988147869706154, decouple_loss:0.007234204560518265
Iteration: 1619, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4533960521221161
loss_pred:0.021579818800091743, decouple_loss:0.007838984951376915
The generated pressure mean: 0.4510626494884491
loss_pred:0.023271536454558372, decouple_loss:0.0074524241499602795
The generated pressure mean: 0.45140719413757324
loss_pred:0.023857027292251587, decouple_loss:0.007707344368100166
Iteration: 1620, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4480459690093994
loss_pred:0.02268887870013714, decouple_loss:0.008489708416163921
The generated pressure mean: 0.4452288746833801
loss_pred:0.02267516776919365, decouple_loss:0.008233692497015
The generated pressure mean: 0.4437418580055237
loss_pred:0.02246064692735672, decouple_loss:0.008095145225524902
2023-04-16 07:39:25 testing...
The generated pressure mean: 0.42314258217811584
loss_pred:0.0351618155837059, decouple_loss:0.008286356925964355
The generated pressure mean: 0.42918720841407776
loss_pred:0.03412389010190964, decouple_loss:0.008151794783771038
The generated pressure mean: 0.43532124161720276
loss_pred:0.03440748527646065, decouple_loss:0.008379070088267326
Loss: 0.03497802093625069, avg_mse: 0.0491696372628212
current test mse: 0.04917
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012009_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012009_3_24hr.npz
NaN value num: 0
Iteration: 1621, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43626996874809265
loss_pred:0.023491129279136658, decouple_loss:0.007879486307501793
The generated pressure mean: 0.4403393566608429
The generated pressure mean: 0.4385116398334503
loss_pred:0.02230103313922882, decouple_loss:0.007715974003076553
loss_pred:0.022332813590765, decouple_loss:0.007968907244503498
Iteration: 1622, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44469645619392395
The generated pressure mean: 0.4479121267795563loss_pred:0.024813272058963776, decouple_loss:0.007453159894794226
loss_pred:0.02335277758538723, decouple_loss:0.0071545010432600975
The generated pressure mean: 0.44965896010398865
loss_pred:0.023033155128359795, decouple_loss:0.007113753817975521
Iteration: 1623, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4542154371738434
loss_pred:0.022326458245515823, decouple_loss:0.008165236562490463
The generated pressure mean: 0.4546293020248413
loss_pred:0.021868454292416573, decouple_loss:0.008627243340015411
The generated pressure mean: 0.45298293232917786
loss_pred:0.022892622277140617, decouple_loss:0.00865229219198227
Iteration: 1624, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4492586851119995
loss_pred:0.023471221327781677, decouple_loss:0.006465928629040718
The generated pressure mean: 0.45253416895866394
loss_pred:0.022267187014222145, decouple_loss:0.006797284819185734
The generated pressure mean: 0.4517003297805786
loss_pred:0.02287745475769043, decouple_loss:0.006660170387476683
Iteration: 1625, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4443204700946808
The generated pressure mean: 0.44290342926979065
loss_pred:0.023248402401804924, decouple_loss:0.009430434554815292
loss_pred:0.022673625499010086, decouple_loss:0.009654630906879902
The generated pressure mean: 0.44336363673210144
loss_pred:0.021961983293294907, decouple_loss:0.009306609630584717
Iteration: 1626, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4443080723285675
loss_pred:0.022230906412005424, decouple_loss:0.00631518941372633
The generated pressure mean: 0.44426313042640686
loss_pred:0.022350843995809555, decouple_loss:0.006601383909583092
The generated pressure mean: 0.4450860321521759
loss_pred:0.022341396659612656, decouple_loss:0.006391157396137714
Iteration: 1627, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4450172483921051
loss_pred:0.02166011370718479, decouple_loss:0.009868811815977097
The generated pressure mean: 0.4473012089729309
loss_pred:0.0227301474660635, decouple_loss:0.0097653241828084
The generated pressure mean: 0.4444531202316284
loss_pred:0.021763240918517113, decouple_loss:0.009721962735056877
Iteration: 1628, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45272132754325867
loss_pred:0.02278490923345089, decouple_loss:0.007543235085904598
The generated pressure mean: 0.4501577913761139
loss_pred:0.02302260883152485, decouple_loss:0.007201349828392267
The generated pressure mean: 0.44954177737236023
loss_pred:0.022986648604273796, decouple_loss:0.007360992021858692
Iteration: 1629, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44524890184402466
loss_pred:0.02234087511897087, decouple_loss:0.009059716947376728
The generated pressure mean: 0.44325003027915955
loss_pred:0.02168942801654339, decouple_loss:0.008557087741792202
The generated pressure mean: 0.44388121366500854
loss_pred:0.022509947419166565, decouple_loss:0.00898629892617464
Iteration: 1630, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4427235424518585
loss_pred:0.023338833823800087, decouple_loss:0.006832862738519907
The generated pressure mean: 0.44563496112823486
loss_pred:0.023447319865226746, decouple_loss:0.007155985571444035
The generated pressure mean: 0.4425714612007141
loss_pred:0.023172901943325996, decouple_loss:0.007088853511959314
2023-04-16 07:41:57 testing...
The generated pressure mean: 0.41952982544898987
loss_pred:0.03544102609157562, decouple_loss:0.008295771665871143
The generated pressure mean: 0.4268457889556885
loss_pred:0.03434327617287636, decouple_loss:0.008575216867029667
The generated pressure mean: 0.4319315552711487
loss_pred:0.034519921988248825, decouple_loss:0.008595257066190243
Loss: 0.03519251570105553, avg_mse: 0.04927179962396622
current test mse: 0.049272
Iteration: 1631, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4468981921672821
loss_pred:0.02184537798166275, decouple_loss:0.007970793172717094
The generated pressure mean: 0.4517863094806671
loss_pred:0.022451436147093773, decouple_loss:0.007880236022174358
The generated pressure mean: 0.4513339400291443
loss_pred:0.023210639134049416, decouple_loss:0.007888511754572392
Iteration: 1632, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45519405603408813
loss_pred:0.023486359044909477, decouple_loss:0.005894857924431562
The generated pressure mean: 0.4523545205593109
loss_pred:0.021845350041985512, decouple_loss:0.006121145095676184
The generated pressure mean: 0.4510454535484314
loss_pred:0.02476162277162075, decouple_loss:0.005929695442318916
Iteration: 1633, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44851401448249817
loss_pred:0.02249726466834545, decouple_loss:0.007780848536640406
The generated pressure mean: 0.44641607999801636
loss_pred:0.021822243928909302, decouple_loss:0.00799409206956625
The generated pressure mean: 0.45144349336624146
loss_pred:0.022782636806368828, decouple_loss:0.00873945839703083
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1634, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44177791476249695
loss_pred:0.022385817021131516, decouple_loss:0.0057562775909900665
The generated pressure mean: 0.4409348964691162
loss_pred:0.022723326459527016, decouple_loss:0.005402880720794201
The generated pressure mean: 0.44130632281303406
loss_pred:0.021581321954727173, decouple_loss:0.005494893528521061
Iteration: 1635, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.444441556930542
loss_pred:0.02232876420021057, decouple_loss:0.007568960078060627
The generated pressure mean: 0.44255682826042175
loss_pred:0.02143469825387001, decouple_loss:0.008240455761551857
The generated pressure mean: 0.44183051586151123
loss_pred:0.02313075214624405, decouple_loss:0.008025998249650002
Iteration: 1636, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44821837544441223
loss_pred:0.025180691853165627, decouple_loss:0.005818681791424751
The generated pressure mean: 0.4551284909248352
loss_pred:0.02231474220752716, decouple_loss:0.005497449077665806
The generated pressure mean: 0.4451320767402649
loss_pred:0.02227204293012619, decouple_loss:0.005861624609678984
Iteration: 1637, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45094242691993713
loss_pred:0.022343989461660385, decouple_loss:0.007701283320784569
The generated pressure mean: 0.4476095139980316
loss_pred:0.022125598043203354, decouple_loss:0.008152958936989307
The generated pressure mean: 0.44987165927886963
loss_pred:0.022498728707432747, decouple_loss:0.00795767456293106
Iteration: 1638, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45038220286369324
loss_pred:0.02173681929707527, decouple_loss:0.0058471886441111565
The generated pressure mean: 0.45315760374069214
loss_pred:0.022429125383496284, decouple_loss:0.006523936055600643
The generated pressure mean: 0.4526107907295227
loss_pred:0.023400111123919487, decouple_loss:0.0060855015181005
Iteration: 1639, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.429580956697464
loss_pred:0.02188795991241932, decouple_loss:0.0071557979099452496
The generated pressure mean: 0.4386714994907379
loss_pred:0.02267775498330593, decouple_loss:0.007027961779385805
The generated pressure mean: 0.4387873709201813
loss_pred:0.02292182482779026, decouple_loss:0.006911135744303465
Iteration: 1640, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4532627463340759
loss_pred:0.023465938866138458, decouple_loss:0.006234185304492712
The generated pressure mean: 0.4495057463645935
loss_pred:0.02338762767612934, decouple_loss:0.006364412605762482
The generated pressure mean: 0.44980230927467346
loss_pred:0.022259684279561043, decouple_loss:0.006356924772262573
2023-04-16 07:43:57 testing...
The generated pressure mean: 0.4177339971065521
loss_pred:0.03568452224135399, decouple_loss:0.006907658651471138
The generated pressure mean: 0.42748430371284485
loss_pred:0.034597884863615036, decouple_loss:0.006956746801733971
The generated pressure mean: 0.4307970702648163
loss_pred:0.03524603322148323, decouple_loss:0.0072264401242136955
Loss: 0.03552766144275665, avg_mse: 0.0502442941069603
current test mse: 0.050244
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012019_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012019_3_24hr.npz
NaN value num: 0
Iteration: 1641, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45439913868904114
loss_pred:0.021700676530599594, decouple_loss:0.00649402616545558
The generated pressure mean: 0.4580729305744171
loss_pred:0.022050729021430016, decouple_loss:0.007596964482218027
The generated pressure mean: 0.46012645959854126
loss_pred:0.021227622404694557, decouple_loss:0.006397319957613945
Iteration: 1642, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44643059372901917
loss_pred:0.021923530846834183, decouple_loss:0.006798680406063795
The generated pressure mean: 0.44259384274482727
loss_pred:0.020860008895397186, decouple_loss:0.00746552599593997
The generated pressure mean: 0.43868517875671387
loss_pred:0.023453494533896446, decouple_loss:0.0071255206130445
Iteration: 1643, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4438447058200836
loss_pred:0.02202589437365532, decouple_loss:0.006969533395022154
The generated pressure mean: 0.4453983008861542
loss_pred:0.022517817094922066, decouple_loss:0.007036818657070398
The generated pressure mean: 0.443541020154953
loss_pred:0.02279040589928627, decouple_loss:0.007159913890063763
Iteration: 1644, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45378801226615906
loss_pred:0.021763436496257782, decouple_loss:0.005919255316257477
The generated pressure mean: 0.4483051896095276
loss_pred:0.02270490862429142, decouple_loss:0.0058423494920134544
The generated pressure mean: 0.45251524448394775
loss_pred:0.02208145335316658, decouple_loss:0.005841550417244434
Iteration: 1645, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45265746116638184
loss_pred:0.022868989035487175, decouple_loss:0.00690482510253787
The generated pressure mean: 0.4537900686264038
loss_pred:0.022217053920030594, decouple_loss:0.0073753721080720425
The generated pressure mean: 0.4538591206073761
loss_pred:0.022311948239803314, decouple_loss:0.006992248352617025
Iteration: 1646, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44621357321739197
loss_pred:0.02344413846731186, decouple_loss:0.005731566809117794
The generated pressure mean: 0.4454335868358612
loss_pred:0.021662138402462006, decouple_loss:0.005482804495841265
The generated pressure mean: 0.4419502913951874
loss_pred:0.021990763023495674, decouple_loss:0.005671844817698002
Iteration: 1647, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44389674067497253
loss_pred:0.02210458368062973, decouple_loss:0.007264865096658468
The generated pressure mean: 0.4470314681529999
loss_pred:0.021335382014513016, decouple_loss:0.0072242943570017815
The generated pressure mean: 0.43848922848701477
loss_pred:0.022354789078235626, decouple_loss:0.007721805479377508
Iteration: 1648, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4466221034526825
loss_pred:0.021371664479374886, decouple_loss:0.00594820873811841
The generated pressure mean: 0.4526016414165497
loss_pred:0.02147320657968521, decouple_loss:0.0060973702929914
The generated pressure mean: 0.4518284797668457
loss_pred:0.020967574790120125, decouple_loss:0.006040685810148716
Iteration: 1649, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44811826944351196
loss_pred:0.0221731998026371, decouple_loss:0.0068366448394954205
The generated pressure mean: 0.4502616226673126
loss_pred:0.022626882418990135, decouple_loss:0.006552543956786394
The generated pressure mean: 0.45035338401794434
loss_pred:0.023239653557538986, decouple_loss:0.006611392833292484
Iteration: 1650, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44492003321647644
loss_pred:0.02355511300265789, decouple_loss:0.007507155183702707
The generated pressure mean: 0.4465421140193939
loss_pred:0.02182197757065296, decouple_loss:0.007634204346686602
The generated pressure mean: 0.44771894812583923
loss_pred:0.022053739055991173, decouple_loss:0.007254361175000668
2023-04-16 07:46:31 testing...
The generated pressure mean: 0.4197191298007965
loss_pred:0.03453800454735756, decouple_loss:0.006204310804605484
The generated pressure mean: 0.42934539914131165
loss_pred:0.03361047804355621, decouple_loss:0.006196835543960333
The generated pressure mean: 0.4330865442752838
loss_pred:0.033727016299963, decouple_loss:0.006361150648444891
Loss: 0.034271206706762314, avg_mse: 0.04794915020465851
current test mse: 0.047949
Iteration: 1651, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4460243582725525
loss_pred:0.021837586537003517, decouple_loss:0.005372127052396536
The generated pressure mean: 0.4519007205963135
loss_pred:0.02123425528407097, decouple_loss:0.005518157966434956
The generated pressure mean: 0.44963112473487854
loss_pred:0.02226565219461918, decouple_loss:0.005268201231956482
Iteration: 1652, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44061511754989624The generated pressure mean: 0.45040544867515564
loss_pred:0.02271011844277382, decouple_loss:0.006920057814568281loss_pred:0.02116674743592739, decouple_loss:0.006655890494585037
The generated pressure mean: 0.4458807110786438
loss_pred:0.02078970894217491, decouple_loss:0.007133047562092543
Iteration: 1653, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45039039850234985
The generated pressure mean: 0.4468939006328583
loss_pred:0.021363528445363045, decouple_loss:0.005861042533069849
loss_pred:0.02182227000594139, decouple_loss:0.005897888448089361
The generated pressure mean: 0.44922712445259094
loss_pred:0.02334398590028286, decouple_loss:0.00634053023532033
Iteration: 1654, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4476839303970337
loss_pred:0.02150721661746502, decouple_loss:0.005918228533118963
The generated pressure mean: 0.4511656165122986
loss_pred:0.022264376282691956, decouple_loss:0.006372726056724787
The generated pressure mean: 0.44968631863594055
loss_pred:0.023754527792334557, decouple_loss:0.006316737271845341
Iteration: 1655, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45758336782455444
loss_pred:0.0236354973167181, decouple_loss:0.007032579276710749
The generated pressure mean: 0.4534302055835724
loss_pred:0.022259259596467018, decouple_loss:0.006730168126523495
The generated pressure mean: 0.45499008893966675
loss_pred:0.022154521197080612, decouple_loss:0.006891577038913965
Iteration: 1656, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4457496106624603
loss_pred:0.021765056997537613, decouple_loss:0.007588859181851149
The generated pressure mean: 0.4424244165420532
loss_pred:0.021773675456643105, decouple_loss:0.007208103779703379
The generated pressure mean: 0.4441291391849518
loss_pred:0.022500447928905487, decouple_loss:0.007630520965903997
Iteration: 1657, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44732269644737244
loss_pred:0.02179133892059326, decouple_loss:0.0066332826390862465
The generated pressure mean: 0.43666326999664307
loss_pred:0.0216432623565197, decouple_loss:0.006606745533645153
The generated pressure mean: 0.44362545013427734
loss_pred:0.0216011144220829, decouple_loss:0.0063896337524056435
Iteration: 1658, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4564473628997803
loss_pred:0.023003986105322838, decouple_loss:0.008783359080553055
The generated pressure mean: 0.4591740667819977
loss_pred:0.022764375433325768, decouple_loss:0.009012057445943356
The generated pressure mean: 0.45514777302742004
loss_pred:0.023039329797029495, decouple_loss:0.009003697894513607
Iteration: 1659, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4431043565273285
loss_pred:0.022022772580385208, decouple_loss:0.007189865689724684
The generated pressure mean: 0.44183987379074097
loss_pred:0.02133062668144703, decouple_loss:0.007150257471948862
The generated pressure mean: 0.4458767771720886
loss_pred:0.02235555648803711, decouple_loss:0.007432103622704744
Iteration: 1660, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45081159472465515
loss_pred:0.021009603515267372, decouple_loss:0.009944603778421879
The generated pressure mean: 0.44757479429244995
loss_pred:0.022983262315392494, decouple_loss:0.009959209710359573
The generated pressure mean: 0.45700904726982117
loss_pred:0.02081235684454441, decouple_loss:0.00970265083014965
2023-04-16 07:48:32 testing...
The generated pressure mean: 0.41991445422172546
loss_pred:0.034986712038517, decouple_loss:0.008696049451828003
The generated pressure mean: 0.42780929803848267
loss_pred:0.0341864638030529, decouple_loss:0.008909312076866627
The generated pressure mean: 0.43188241124153137
loss_pred:0.03418964892625809, decouple_loss:0.009038742631673813
Loss: 0.03489834442734718, avg_mse: 0.048847876489162445
current test mse: 0.048848
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012003_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012003_3_24hr.npz
NaN value num: 0
Iteration: 1661, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4482653737068176
loss_pred:0.021707121282815933, decouple_loss:0.008466680534183979
The generated pressure mean: 0.4480934143066406
loss_pred:0.024010609835386276, decouple_loss:0.008165152743458748
The generated pressure mean: 0.44588160514831543
loss_pred:0.024571845307946205, decouple_loss:0.0082982974126935
Iteration: 1662, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45130908489227295
loss_pred:0.02150697261095047, decouple_loss:0.008051786571741104
The generated pressure mean: 0.45105522871017456
loss_pred:0.022527363151311874, decouple_loss:0.00813003908842802
The generated pressure mean: 0.4474356472492218
loss_pred:0.021446725353598595, decouple_loss:0.008546669036149979
Iteration: 1663, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4487743079662323
loss_pred:0.022514771670103073, decouple_loss:0.0073480792343616486
The generated pressure mean: 0.4446645677089691
loss_pred:0.022564150393009186, decouple_loss:0.007200639229267836
The generated pressure mean: 0.4407396912574768
loss_pred:0.023164177313447, decouple_loss:0.007063534576445818
Iteration: 1664, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43212637305259705
loss_pred:0.022143732756376266, decouple_loss:0.007981797680258751
The generated pressure mean: 0.43445074558258057
loss_pred:0.02274128422141075, decouple_loss:0.008026741445064545
The generated pressure mean: 0.4408833384513855
loss_pred:0.023072348907589912, decouple_loss:0.007797811646014452
Iteration: 1665, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4574176073074341
loss_pred:0.021507009863853455, decouple_loss:0.006212005391716957
The generated pressure mean: 0.45883750915527344
loss_pred:0.022446149960160255, decouple_loss:0.00636607501655817
The generated pressure mean: 0.4544376730918884
loss_pred:0.02204268053174019, decouple_loss:0.006535463500767946
Iteration: 1666, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46300458908081055
loss_pred:0.02083098143339157, decouple_loss:0.008029226213693619
The generated pressure mean: 0.45975786447525024
loss_pred:0.0220935121178627, decouple_loss:0.008240751922130585
The generated pressure mean: 0.4639369547367096
loss_pred:0.022333526983857155, decouple_loss:0.008315272629261017
Iteration: 1667, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4304966330528259
loss_pred:0.022225072607398033, decouple_loss:0.006048574112355709
The generated pressure mean: 0.43807873129844666
loss_pred:0.02165142074227333, decouple_loss:0.00591985322535038
The generated pressure mean: 0.43559959530830383
loss_pred:0.02229439467191696, decouple_loss:0.005994479637593031
Iteration: 1668, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4287551939487457
loss_pred:0.02125769853591919, decouple_loss:0.00848632212728262
The generated pressure mean: 0.4330858588218689
loss_pred:0.022983241826295853, decouple_loss:0.008679741062223911
The generated pressure mean: 0.4256475567817688
loss_pred:0.02254324220120907, decouple_loss:0.008382401429116726
Iteration: 1669, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46733948588371277
loss_pred:0.02052144706249237, decouple_loss:0.006562471855431795
The generated pressure mean: 0.47125908732414246
loss_pred:0.02259974740445614, decouple_loss:0.006644885521382093
The generated pressure mean: 0.4617724120616913
loss_pred:0.022540710866451263, decouple_loss:0.006367940455675125
Iteration: 1670, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4482276141643524
loss_pred:0.022970668971538544, decouple_loss:0.008519954979419708
The generated pressure mean: 0.45358362793922424
loss_pred:0.02160625159740448, decouple_loss:0.009109425358474255
The generated pressure mean: 0.44948524236679077
loss_pred:0.02163810469210148, decouple_loss:0.008777735754847527
2023-04-16 07:51:10 testing...
The generated pressure mean: 0.4206851124763489
loss_pred:0.035081591457128525, decouple_loss:0.0075277783907949924
The generated pressure mean: 0.4292934238910675
loss_pred:0.03337156027555466, decouple_loss:0.007652940694242716
The generated pressure mean: 0.43372198939323425
loss_pred:0.033832110464572906, decouple_loss:0.00783579982817173
Loss: 0.034478697925806046, avg_mse: 0.04877953603863716
current test mse: 0.04878
Iteration: 1671, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44437894225120544
loss_pred:0.021324316039681435, decouple_loss:0.007009727414697409
The generated pressure mean: 0.43935027718544006
loss_pred:0.022417768836021423, decouple_loss:0.006995274219661951
The generated pressure mean: 0.43789929151535034
loss_pred:0.022616518661379814, decouple_loss:0.007005052175372839
Iteration: 1672, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44594326615333557
loss_pred:0.021992819383740425, decouple_loss:0.009101878851652145
The generated pressure mean: 0.4476284384727478
loss_pred:0.022069554775953293, decouple_loss:0.008679692633450031
The generated pressure mean: 0.4511321485042572
loss_pred:0.021299337968230247, decouple_loss:0.009022241458296776
Iteration: 1673, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4518173038959503
loss_pred:0.02320355363190174, decouple_loss:0.007330866530537605
The generated pressure mean: 0.44898897409439087
loss_pred:0.021759187802672386, decouple_loss:0.007352242711931467
The generated pressure mean: 0.4457709491252899
loss_pred:0.021806897595524788, decouple_loss:0.007124084513634443
Iteration: 1674, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45206505060195923
loss_pred:0.022784139961004257, decouple_loss:0.008252971805632114
The generated pressure mean: 0.4461548626422882
loss_pred:0.021492669358849525, decouple_loss:0.008297589607536793
The generated pressure mean: 0.44668030738830566
loss_pred:0.023647086694836617, decouple_loss:0.00825903844088316
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1675, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4508020579814911
loss_pred:0.023652710020542145, decouple_loss:0.007685777265578508
The generated pressure mean: 0.4483840763568878
loss_pred:0.02150779776275158, decouple_loss:0.007657970301806927
The generated pressure mean: 0.45058611035346985
loss_pred:0.021614624187350273, decouple_loss:0.007771126460283995
Iteration: 1676, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4404028356075287
loss_pred:0.02231352962553501, decouple_loss:0.008140208199620247
The generated pressure mean: 0.443502813577652
loss_pred:0.022266799584031105, decouple_loss:0.0081657525151968
The generated pressure mean: 0.437284380197525
loss_pred:0.021837551146745682, decouple_loss:0.008298900909721851
Iteration: 1677, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44468608498573303
loss_pred:0.021980997174978256, decouple_loss:0.007843340747058392
The generated pressure mean: 0.44313618540763855
loss_pred:0.022054580971598625, decouple_loss:0.007486759219318628
The generated pressure mean: 0.4478931128978729
loss_pred:0.02116728201508522, decouple_loss:0.007715861778706312
Iteration: 1678, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45642170310020447
loss_pred:0.021949468180537224, decouple_loss:0.007574076298624277
The generated pressure mean: 0.45941054821014404
loss_pred:0.021625129505991936, decouple_loss:0.0075454856269061565
The generated pressure mean: 0.4512505531311035
loss_pred:0.022386660799384117, decouple_loss:0.0075194514356553555
Iteration: 1679, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4441044330596924
loss_pred:0.02308948151767254, decouple_loss:0.007322554010897875
The generated pressure mean: 0.4470691978931427
loss_pred:0.022745955735445023, decouple_loss:0.007342732511460781
The generated pressure mean: 0.4459676444530487
loss_pred:0.021868234500288963, decouple_loss:0.007261068560183048
Iteration: 1680, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43994176387786865
The generated pressure mean: 0.4422072470188141
loss_pred:0.02034785971045494, decouple_loss:0.007266317028552294
loss_pred:0.021578965708613396, decouple_loss:0.007443046197295189
The generated pressure mean: 0.4392881989479065
loss_pred:0.02120785042643547, decouple_loss:0.007850997149944305
2023-04-16 07:53:11 testing...
The generated pressure mean: 0.41849473118782043
loss_pred:0.03414006158709526, decouple_loss:0.007381911389529705
The generated pressure mean: 0.42673438787460327
loss_pred:0.033532753586769104, decouple_loss:0.007547090295702219
The generated pressure mean: 0.43100348114967346
loss_pred:0.03329643979668617, decouple_loss:0.007769172079861164
Loss: 0.03403472155332565, avg_mse: 0.04762391000986099
current test mse: 0.047624
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012014_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012014_3_24hr.npz
NaN value num: 0
Iteration: 1681, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4445885121822357
loss_pred:0.02152503840625286, decouple_loss:0.006926946807652712
The generated pressure mean: 0.4526651203632355
loss_pred:0.023593144491314888, decouple_loss:0.007009347900748253
The generated pressure mean: 0.4414914548397064
loss_pred:0.02239164523780346, decouple_loss:0.006959944032132626
Iteration: 1682, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44839441776275635
loss_pred:0.022142941132187843, decouple_loss:0.008349889889359474
The generated pressure mean: 0.45024624466896057
loss_pred:0.02320406399667263, decouple_loss:0.00819641724228859
The generated pressure mean: 0.4486185610294342
loss_pred:0.022231172770261765, decouple_loss:0.007871145382523537
Iteration: 1683, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4465222954750061
loss_pred:0.022892629727721214, decouple_loss:0.007247342262417078
The generated pressure mean: 0.440233051776886
loss_pred:0.022315919399261475, decouple_loss:0.006833145394921303
The generated pressure mean: 0.4516996741294861
loss_pred:0.022546080872416496, decouple_loss:0.006936417426913977
Iteration: 1684, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4502754807472229
loss_pred:0.022108256816864014, decouple_loss:0.006338277366012335
The generated pressure mean: 0.45753663778305054
loss_pred:0.02245054580271244, decouple_loss:0.006347133778035641
The generated pressure mean: 0.4555564820766449
loss_pred:0.022722024470567703, decouple_loss:0.0065759578719735146
Iteration: 1685, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4468362629413605
loss_pred:0.020971201360225677, decouple_loss:0.007322343531996012
The generated pressure mean: 0.44403091073036194
loss_pred:0.022861575707793236, decouple_loss:0.007528285961598158
The generated pressure mean: 0.4451945424079895
loss_pred:0.021880459040403366, decouple_loss:0.0071995556354522705
Iteration: 1686, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4327715039253235
loss_pred:0.021420327946543694, decouple_loss:0.006320485379546881
The generated pressure mean: 0.4354715049266815
loss_pred:0.021465951576828957, decouple_loss:0.006645132787525654
The generated pressure mean: 0.4352661073207855
loss_pred:0.021465281024575233, decouple_loss:0.0063308412209153175
Iteration: 1687, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45250841975212097
loss_pred:0.021794317290186882, decouple_loss:0.005764333996921778
The generated pressure mean: 0.44452744722366333
loss_pred:0.02225794643163681, decouple_loss:0.005932158324867487
The generated pressure mean: 0.44545525312423706
loss_pred:0.02211059257388115, decouple_loss:0.005959187168627977
Iteration: 1688, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4539603888988495
loss_pred:0.021029578521847725, decouple_loss:0.006644057109951973
The generated pressure mean: 0.45063963532447815
loss_pred:0.02239954099059105, decouple_loss:0.006606025621294975
The generated pressure mean: 0.45007747411727905
loss_pred:0.02205071784555912, decouple_loss:0.006647649221122265
Iteration: 1689, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4537014961242676
loss_pred:0.023439856246113777, decouple_loss:0.005937767680734396
The generated pressure mean: 0.4541161060333252
loss_pred:0.02241295762360096, decouple_loss:0.005980900954455137
The generated pressure mean: 0.4540725350379944
loss_pred:0.022606713697314262, decouple_loss:0.006076262332499027
Iteration: 1690, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.437846839427948
loss_pred:0.022010335698723793, decouple_loss:0.0070024817250669
The generated pressure mean: 0.4402858316898346
loss_pred:0.022786585614085197, decouple_loss:0.007342246826738119
The generated pressure mean: 0.4371671974658966
loss_pred:0.022388746961951256, decouple_loss:0.007199027109891176
2023-04-16 07:55:49 testing...
The generated pressure mean: 0.4197753071784973
loss_pred:0.03509854897856712, decouple_loss:0.006657371763139963
The generated pressure mean: 0.42713838815689087
loss_pred:0.033190950751304626, decouple_loss:0.00680175144225359
The generated pressure mean: 0.4311843514442444
loss_pred:0.034340959042310715, decouple_loss:0.0070365904830396175
Loss: 0.034551750868558884, avg_mse: 0.048098769038915634
current test mse: 0.048099
Iteration: 1691, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4362236559391022
loss_pred:0.0221857987344265, decouple_loss:0.005858357530087233
The generated pressure mean: 0.4458097517490387
loss_pred:0.02302536927163601, decouple_loss:0.006244980730116367
The generated pressure mean: 0.4407650828361511
loss_pred:0.023152954876422882, decouple_loss:0.005929694976657629
Iteration: 1692, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4534662067890167
loss_pred:0.023404764011502266, decouple_loss:0.006581850349903107
The generated pressure mean: 0.4550754427909851
loss_pred:0.02305266633629799, decouple_loss:0.00660400465130806
The generated pressure mean: 0.4501631259918213
loss_pred:0.02153410017490387, decouple_loss:0.00655499380081892
Iteration: 1693, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4493485689163208
The generated pressure mean: 0.44527554512023926
loss_pred:0.02200094796717167, decouple_loss:0.006203864701092243
loss_pred:0.022455701604485512, decouple_loss:0.006169242784380913
The generated pressure mean: 0.4476211369037628
loss_pred:0.02259160205721855, decouple_loss:0.006227681878954172
Iteration: 1694, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45353224873542786
loss_pred:0.021970057860016823, decouple_loss:0.005482969805598259
The generated pressure mean: 0.44882676005363464
loss_pred:0.021292271092534065, decouple_loss:0.0056635127402842045
The generated pressure mean: 0.4506798982620239
loss_pred:0.021076252683997154, decouple_loss:0.005529947113245726
Iteration: 1695, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43764153122901917
loss_pred:0.023242713883519173, decouple_loss:0.005576963070780039
The generated pressure mean: 0.4382488429546356
loss_pred:0.021823745220899582, decouple_loss:0.0053449710831046104
The generated pressure mean: 0.4412025809288025
loss_pred:0.022674154490232468, decouple_loss:0.005245882552117109
Iteration: 1696, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43673843145370483
The generated pressure mean: 0.43625766038894653
loss_pred:0.024397458881139755, decouple_loss:0.006108189933001995loss_pred:0.022589607164263725, decouple_loss:0.005740822292864323
The generated pressure mean: 0.43626388907432556
loss_pred:0.024054165929555893, decouple_loss:0.005845277104526758
Iteration: 1697, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4431992173194885
loss_pred:0.02341178059577942, decouple_loss:0.005637597292661667
The generated pressure mean: 0.4478754699230194
loss_pred:0.021478943526744843, decouple_loss:0.005340961739420891
The generated pressure mean: 0.4418086111545563
loss_pred:0.022369368001818657, decouple_loss:0.005560244433581829
Iteration: 1698, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4629850685596466
loss_pred:0.022378278896212578, decouple_loss:0.006019736640155315
The generated pressure mean: 0.4651600122451782
loss_pred:0.02369106188416481, decouple_loss:0.0060745286755263805
The generated pressure mean: 0.46345254778862
loss_pred:0.02414156310260296, decouple_loss:0.006030951626598835
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1699, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44655486941337585
loss_pred:0.02161131426692009, decouple_loss:0.005200243089348078
The generated pressure mean: 0.4451689124107361
loss_pred:0.021547067910432816, decouple_loss:0.005175377242267132
The generated pressure mean: 0.44382238388061523
loss_pred:0.022864053025841713, decouple_loss:0.0053380271419882774
Iteration: 1700, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4302496314048767
loss_pred:0.022975847125053406, decouple_loss:0.006625049281865358
The generated pressure mean: 0.4347480833530426
loss_pred:0.024638701230287552, decouple_loss:0.0066946521401405334
The generated pressure mean: 0.42984452843666077
loss_pred:0.02170654386281967, decouple_loss:0.006778676062822342
2023-04-16 07:57:51 testing...
The generated pressure mean: 0.4138314723968506
loss_pred:0.03585754334926605, decouple_loss:0.005877773743122816
The generated pressure mean: 0.4191995859146118
loss_pred:0.03502914309501648, decouple_loss:0.006089807488024235
The generated pressure mean: 0.42293643951416016
loss_pred:0.03533584624528885, decouple_loss:0.006154217291623354
Loss: 0.03570954129099846, avg_mse: 0.05076617747545242
current test mse: 0.050766
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012017_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012017_3_24hr.npz
NaN value num: 0
Iteration: 1701, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4610186219215393
loss_pred:0.022375093773007393, decouple_loss:0.00583272660151124
The generated pressure mean: 0.4608827233314514
loss_pred:0.021439626812934875, decouple_loss:0.006510036997497082
The generated pressure mean: 0.4658544361591339
loss_pred:0.02205430157482624, decouple_loss:0.005576971918344498
Iteration: 1702, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4562308192253113
loss_pred:0.020410757511854172, decouple_loss:0.0074318391270935535
The generated pressure mean: 0.4540625214576721
The generated pressure mean: 0.4512142241001129
loss_pred:0.02219303511083126, decouple_loss:0.006798263173550367
loss_pred:0.021398182958364487, decouple_loss:0.007217773701995611
Iteration: 1703, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.42939138412475586
loss_pred:0.022559095174074173, decouple_loss:0.005593317560851574
The generated pressure mean: 0.42943859100341797
loss_pred:0.02127510868012905, decouple_loss:0.005593691486865282
The generated pressure mean: 0.4321402311325073
loss_pred:0.023386426270008087, decouple_loss:0.005982287228107452
Iteration: 1704, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4403304159641266
loss_pred:0.02125272899866104, decouple_loss:0.006653219927102327
The generated pressure mean: 0.44576600193977356
loss_pred:0.02103169448673725, decouple_loss:0.006204179488122463
The generated pressure mean: 0.4487360715866089
loss_pred:0.021432744339108467, decouple_loss:0.0061007095500826836
Iteration: 1705, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4576420187950134
loss_pred:0.02201366424560547, decouple_loss:0.0065505243837833405
The generated pressure mean: 0.45535412430763245
loss_pred:0.020478693768382072, decouple_loss:0.0067772027105093
The generated pressure mean: 0.4539732038974762
loss_pred:0.020568037405610085, decouple_loss:0.007130852900445461
Iteration: 1706, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44677403569221497
loss_pred:0.022040748968720436, decouple_loss:0.005797292105853558
The generated pressure mean: 0.4553963541984558
loss_pred:0.02177114598453045, decouple_loss:0.005872029811143875
The generated pressure mean: 0.4458921551704407
loss_pred:0.021387511864304543, decouple_loss:0.005896815564483404
Iteration: 1707, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4500555098056793
loss_pred:0.021478604525327682, decouple_loss:0.007275733165442944
The generated pressure mean: 0.4525008797645569
loss_pred:0.02289852686226368, decouple_loss:0.007282739505171776
The generated pressure mean: 0.45132607221603394
loss_pred:0.022381022572517395, decouple_loss:0.007280802819877863
Iteration: 1708, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43776950240135193
loss_pred:0.022179240360856056, decouple_loss:0.006879621185362339
The generated pressure mean: 0.44521409273147583
loss_pred:0.023034142330288887, decouple_loss:0.006585491355508566
The generated pressure mean: 0.4454936683177948
loss_pred:0.023504383862018585, decouple_loss:0.006668679881840944
Iteration: 1709, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4440087378025055
loss_pred:0.023210622370243073, decouple_loss:0.00755341537296772
The generated pressure mean: 0.446620374917984
loss_pred:0.02114659734070301, decouple_loss:0.007841183803975582
The generated pressure mean: 0.44616469740867615
loss_pred:0.021987615153193474, decouple_loss:0.007525300607085228
Iteration: 1710, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44287142157554626
loss_pred:0.02214045636355877, decouple_loss:0.008035024628043175
The generated pressure mean: 0.4470658600330353
loss_pred:0.02296030893921852, decouple_loss:0.008064555935561657
The generated pressure mean: 0.44509050250053406
loss_pred:0.022290106862783432, decouple_loss:0.007661599200218916
2023-04-16 08:00:25 testing...
The generated pressure mean: 0.41608139872550964
loss_pred:0.03524112328886986, decouple_loss:0.007728485856205225
The generated pressure mean: 0.42363622784614563
loss_pred:0.03504610434174538, decouple_loss:0.007815368473529816
The generated pressure mean: 0.42784473299980164
loss_pred:0.03503118455410004, decouple_loss:0.00796673633158207
Loss: 0.03549797832965851, avg_mse: 0.04995982348918915
current test mse: 0.04996
Iteration: 1711, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45528754591941833
loss_pred:0.021083073690533638, decouple_loss:0.007070319261401892
The generated pressure mean: 0.4551727771759033
loss_pred:0.02296527661383152, decouple_loss:0.007136932574212551
The generated pressure mean: 0.45485737919807434
loss_pred:0.021973269060254097, decouple_loss:0.007087285164743662
Iteration: 1712, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4523933529853821
loss_pred:0.02272198721766472, decouple_loss:0.0074964482337236404
The generated pressure mean: 0.455841064453125
loss_pred:0.022090991958975792, decouple_loss:0.007299220189452171
The generated pressure mean: 0.4547198414802551
loss_pred:0.02192196436226368, decouple_loss:0.007151458412408829
Iteration: 1713, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43540158867836
loss_pred:0.021054981276392937, decouple_loss:0.007773887366056442
The generated pressure mean: 0.4402534067630768
loss_pred:0.021346205845475197, decouple_loss:0.00803548563271761
The generated pressure mean: 0.43695759773254395
loss_pred:0.022354543209075928, decouple_loss:0.007670029532164335
Iteration: 1714, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4440373480319977
loss_pred:0.01997445896267891, decouple_loss:0.007467544637620449
The generated pressure mean: 0.44549503922462463
loss_pred:0.023642390966415405, decouple_loss:0.0071724490262568
The generated pressure mean: 0.44329729676246643
loss_pred:0.020911071449518204, decouple_loss:0.00733748497441411
Iteration: 1715, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45079851150512695
loss_pred:0.021745076403021812, decouple_loss:0.00802203081548214
The generated pressure mean: 0.45015934109687805
loss_pred:0.021695442497730255, decouple_loss:0.008224730379879475
The generated pressure mean: 0.4482235312461853
loss_pred:0.020503904670476913, decouple_loss:0.007969772443175316
Iteration: 1716, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4521125257015228
loss_pred:0.02191053330898285, decouple_loss:0.007190908305346966
The generated pressure mean: 0.4572308659553528
loss_pred:0.021440062671899796, decouple_loss:0.006838140543550253
The generated pressure mean: 0.4509090185165405
loss_pred:0.021972378715872765, decouple_loss:0.006991939153522253
Iteration: 1717, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4510568380355835
loss_pred:0.021521955728530884, decouple_loss:0.008626369759440422
The generated pressure mean: 0.4535674452781677
loss_pred:0.02135530486702919, decouple_loss:0.008887154050171375
The generated pressure mean: 0.4514205753803253
loss_pred:0.02204093337059021, decouple_loss:0.00870712660253048
Iteration: 1718, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4355524480342865
loss_pred:0.022034401074051857, decouple_loss:0.006126214750111103
The generated pressure mean: 0.437394380569458
loss_pred:0.02272122912108898, decouple_loss:0.006269919686019421
The generated pressure mean: 0.4426059126853943
loss_pred:0.022393371909856796, decouple_loss:0.006318922620266676
Iteration: 1719, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43395599722862244
loss_pred:0.021671215072274208, decouple_loss:0.009134722873568535
The generated pressure mean: 0.4376002848148346
loss_pred:0.02033161371946335, decouple_loss:0.008603853173553944
The generated pressure mean: 0.4381037652492523
loss_pred:0.023791393265128136, decouple_loss:0.008925270289182663
Iteration: 1720, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.479518324136734
loss_pred:0.02171417698264122, decouple_loss:0.006707164458930492
The generated pressure mean: 0.4819945991039276
loss_pred:0.024693993851542473, decouple_loss:0.006563322152942419
The generated pressure mean: 0.47455033659935
loss_pred:0.022836901247501373, decouple_loss:0.006717819720506668
2023-04-16 08:02:25 testing...
The generated pressure mean: 0.42068663239479065
loss_pred:0.037430934607982635, decouple_loss:0.009737055748701096
The generated pressure mean: 0.42957255244255066
loss_pred:0.03535208851099014, decouple_loss:0.009825456887483597
The generated pressure mean: 0.4342760741710663
loss_pred:0.03592764213681221, decouple_loss:0.01003675814718008
Loss: 0.03673021122813225, avg_mse: 0.05077333748340607
current test mse: 0.050773
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012013_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012013_3_24hr.npz
NaN value num: 0
Iteration: 1721, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4345642924308777
loss_pred:0.02466782182455063, decouple_loss:0.009582762606441975
The generated pressure mean: 0.43519076704978943
loss_pred:0.021758655086159706, decouple_loss:0.009315825067460537
The generated pressure mean: 0.43630680441856384
loss_pred:0.022903315722942352, decouple_loss:0.00940650049597025
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1722, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43452727794647217
loss_pred:0.023606453090906143, decouple_loss:0.00839245319366455
The generated pressure mean: 0.4330826997756958The generated pressure mean: 0.4273962676525116
loss_pred:0.022387856617569923, decouple_loss:0.00846096035093069
loss_pred:0.022718561813235283, decouple_loss:0.008153961040079594
Iteration: 1723, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44735610485076904
loss_pred:0.022091759368777275, decouple_loss:0.007349684834480286
The generated pressure mean: 0.44802331924438477
loss_pred:0.021794378757476807, decouple_loss:0.007312217727303505
The generated pressure mean: 0.4524897634983063
loss_pred:0.023226644843816757, decouple_loss:0.0074388617649674416
Iteration: 1724, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4492051899433136
loss_pred:0.022402355447411537, decouple_loss:0.007050958927720785
The generated pressure mean: 0.45448440313339233
loss_pred:0.02305501140654087, decouple_loss:0.0070271906442940235
The generated pressure mean: 0.4494699537754059
loss_pred:0.022620851173996925, decouple_loss:0.006991015747189522
Iteration: 1725, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45685580372810364
loss_pred:0.021982375532388687, decouple_loss:0.007384308148175478
The generated pressure mean: 0.45825904607772827
loss_pred:0.02321266569197178, decouple_loss:0.007835677824914455
The generated pressure mean: 0.4560883045196533
loss_pred:0.025744663551449776, decouple_loss:0.007697318214923143
Iteration: 1726, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43864068388938904
loss_pred:0.023554256185889244, decouple_loss:0.007321697194129229
The generated pressure mean: 0.4449857175350189
loss_pred:0.02287861704826355, decouple_loss:0.007159255910664797
The generated pressure mean: 0.4414268136024475
loss_pred:0.022238053381443024, decouple_loss:0.007387809921056032
Iteration: 1727, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44167405366897583
loss_pred:0.022462908178567886, decouple_loss:0.006861450616270304
The generated pressure mean: 0.4364311397075653
loss_pred:0.022264568135142326, decouple_loss:0.006674399599432945
The generated pressure mean: 0.43669766187667847
loss_pred:0.023020513355731964, decouple_loss:0.006799296475946903
Iteration: 1728, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44553127884864807
The generated pressure mean: 0.44981318712234497
loss_pred:0.02202683873474598, decouple_loss:0.006376171018928289
loss_pred:0.022642895579338074, decouple_loss:0.00667409785091877
The generated pressure mean: 0.4516492784023285
loss_pred:0.02100132592022419, decouple_loss:0.006232806947082281
Iteration: 1729, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44970694184303284
loss_pred:0.022179394960403442, decouple_loss:0.007372325286269188
The generated pressure mean: 0.4517488479614258
loss_pred:0.022159811109304428, decouple_loss:0.007350813131779432
The generated pressure mean: 0.4563424289226532
loss_pred:0.021845918148756027, decouple_loss:0.007394291926175356
Iteration: 1730, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43861597776412964
loss_pred:0.020723719149827957, decouple_loss:0.007186919916421175
The generated pressure mean: 0.43966543674468994
loss_pred:0.02245526760816574, decouple_loss:0.007435851730406284
The generated pressure mean: 0.4373975694179535
loss_pred:0.021903056651353836, decouple_loss:0.007106449920684099
2023-04-16 08:05:03 testing...
The generated pressure mean: 0.41823068261146545
loss_pred:0.035592928528785706, decouple_loss:0.00756492093205452
The generated pressure mean: 0.4252307116985321
loss_pred:0.03455052152276039, decouple_loss:0.007757949642837048
The generated pressure mean: 0.42910483479499817
loss_pred:0.0348980687558651, decouple_loss:0.00780367199331522
Loss: 0.03539928048849106, avg_mse: 0.049942661076784134
current test mse: 0.049943
Iteration: 1731, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4433906376361847
loss_pred:0.025243015959858894, decouple_loss:0.0071433065459132195
The generated pressure mean: 0.44317057728767395
loss_pred:0.02161615900695324, decouple_loss:0.006899601314216852
The generated pressure mean: 0.443685919046402
loss_pred:0.02102007530629635, decouple_loss:0.007004552986472845
Iteration: 1732, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44554784893989563
loss_pred:0.02187124267220497, decouple_loss:0.007243597414344549
The generated pressure mean: 0.44369420409202576
loss_pred:0.021872274577617645, decouple_loss:0.007187670096755028
The generated pressure mean: 0.4469112455844879
loss_pred:0.022965868934988976, decouple_loss:0.006895144935697317
Iteration: 1733, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43698471784591675
loss_pred:0.023798787966370583, decouple_loss:0.006663413718342781
The generated pressure mean: 0.4365399479866028
loss_pred:0.022343529388308525, decouple_loss:0.006736526731401682
The generated pressure mean: 0.4424598813056946
loss_pred:0.0229258481413126, decouple_loss:0.0066365390084683895
Iteration: 1734, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.47288525104522705
loss_pred:0.02112041600048542, decouple_loss:0.007202327251434326
The generated pressure mean: 0.4653433859348297
loss_pred:0.025267504155635834, decouple_loss:0.0074857077561318874
The generated pressure mean: 0.46096763014793396
loss_pred:0.02210349030792713, decouple_loss:0.00722806341946125
Iteration: 1735, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43437808752059937
loss_pred:0.020831694826483727, decouple_loss:0.006269870791584253
The generated pressure mean: 0.43383505940437317
loss_pred:0.02173863910138607, decouple_loss:0.0058494326658546925
The generated pressure mean: 0.4363267719745636
loss_pred:0.021243084222078323, decouple_loss:0.00643164711073041
Iteration: 1736, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4292871057987213
loss_pred:0.022368555888533592, decouple_loss:0.006881528068333864
The generated pressure mean: 0.4285682439804077
loss_pred:0.02213907428085804, decouple_loss:0.006911233067512512
The generated pressure mean: 0.42847469449043274
loss_pred:0.022401778027415276, decouple_loss:0.006488312967121601
Iteration: 1737, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4576759934425354
loss_pred:0.021497676149010658, decouple_loss:0.0059091816656291485
The generated pressure mean: 0.4587259590625763
loss_pred:0.022126734256744385, decouple_loss:0.006135581526905298
The generated pressure mean: 0.46471288800239563
loss_pred:0.023143788799643517, decouple_loss:0.006232127081602812
Iteration: 1738, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45826974511146545
loss_pred:0.021271295845508575, decouple_loss:0.005671425722539425
The generated pressure mean: 0.4541561007499695
loss_pred:0.02278793416917324, decouple_loss:0.005677460227161646
The generated pressure mean: 0.46011748909950256
loss_pred:0.02102714218199253, decouple_loss:0.006022437941282988
Iteration: 1739, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43047019839286804
loss_pred:0.02303735725581646, decouple_loss:0.005873057991266251
The generated pressure mean: 0.4345565140247345
loss_pred:0.023118194192647934, decouple_loss:0.005595688242465258
The generated pressure mean: 0.43233954906463623
loss_pred:0.022956769913434982, decouple_loss:0.00577611243352294
Iteration: 1740, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44320887327194214
loss_pred:0.022446483373641968, decouple_loss:0.005694058258086443
The generated pressure mean: 0.4437938332557678
loss_pred:0.021913260221481323, decouple_loss:0.005889014340937138
The generated pressure mean: 0.4411267340183258
loss_pred:0.021563582122325897, decouple_loss:0.005654369946569204
2023-04-16 08:07:03 testing...
The generated pressure mean: 0.4163159132003784
loss_pred:0.03459471836686134, decouple_loss:0.005930616986006498
The generated pressure mean: 0.4246107041835785
loss_pred:0.033354632556438446, decouple_loss:0.006025263573974371
The generated pressure mean: 0.4285964071750641
loss_pred:0.03396483138203621, decouple_loss:0.006182494107633829
Loss: 0.034273698925971985, avg_mse: 0.04869123175740242
current test mse: 0.048691
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012012_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012012_3_24hr.npz
NaN value num: 0
Iteration: 1741, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.453809529542923
loss_pred:0.02136731520295143, decouple_loss:0.005911855958402157
The generated pressure mean: 0.4564630687236786
loss_pred:0.022497054189443588, decouple_loss:0.005666905082762241
The generated pressure mean: 0.4536641836166382
loss_pred:0.021237896755337715, decouple_loss:0.005831675138324499
Iteration: 1742, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4526355266571045
loss_pred:0.02173539064824581, decouple_loss:0.005728287622332573
The generated pressure mean: 0.45186713337898254
loss_pred:0.021434787660837173, decouple_loss:0.005383220035582781
The generated pressure mean: 0.4521041512489319
loss_pred:0.021876942366361618, decouple_loss:0.005972047336399555
Iteration: 1743, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44098249077796936
loss_pred:0.02156609483063221, decouple_loss:0.005711100064218044
The generated pressure mean: 0.438442200422287
loss_pred:0.02101144939661026, decouple_loss:0.005287518259137869
The generated pressure mean: 0.4383685290813446
loss_pred:0.0206000916659832, decouple_loss:0.005241329316049814
Iteration: 1744, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43238070607185364
loss_pred:0.022130843251943588, decouple_loss:0.006527174264192581
The generated pressure mean: 0.43334561586380005
loss_pred:0.021065590903162956, decouple_loss:0.00609827833250165
The generated pressure mean: 0.44571924209594727
loss_pred:0.021688958629965782, decouple_loss:0.005967927630990744
Iteration: 1745, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4485950469970703
loss_pred:0.02077837660908699, decouple_loss:0.006012736354023218
The generated pressure mean: 0.4545895755290985
loss_pred:0.022092025727033615, decouple_loss:0.006264790426939726
The generated pressure mean: 0.4546525478363037
loss_pred:0.02107805199921131, decouple_loss:0.006250757724046707
Iteration: 1746, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.455160915851593
loss_pred:0.02128862962126732, decouple_loss:0.006947624497115612
The generated pressure mean: 0.4500080645084381
loss_pred:0.02212480455636978, decouple_loss:0.006506421137601137
The generated pressure mean: 0.44990673661231995
loss_pred:0.021270837634801865, decouple_loss:0.00664337957277894
Iteration: 1747, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44948846101760864
loss_pred:0.02132457308471203, decouple_loss:0.0051325117237865925
The generated pressure mean: 0.4514051675796509
loss_pred:0.020496167242527008, decouple_loss:0.005441057495772839
The generated pressure mean: 0.4485449194908142
loss_pred:0.020973829552531242, decouple_loss:0.005367672070860863
Iteration: 1748, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4382845461368561
The generated pressure mean: 0.4374943971633911
loss_pred:0.021306945011019707, decouple_loss:0.005946224555373192
loss_pred:0.022414714097976685, decouple_loss:0.005897483788430691
The generated pressure mean: 0.44057855010032654
loss_pred:0.020736491307616234, decouple_loss:0.005636648740619421
Iteration: 1749, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4530463218688965
loss_pred:0.022455479949712753, decouple_loss:0.006512427236884832
The generated pressure mean: 0.44771823287010193
loss_pred:0.020780256018042564, decouple_loss:0.0061166794039309025
The generated pressure mean: 0.44275522232055664
loss_pred:0.021114569157361984, decouple_loss:0.006442262791097164
Iteration: 1750, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4535582661628723
loss_pred:0.021891968324780464, decouple_loss:0.006423010490834713
The generated pressure mean: 0.45766857266426086
loss_pred:0.021344376727938652, decouple_loss:0.006484415847808123
The generated pressure mean: 0.4595091938972473
loss_pred:0.02195264771580696, decouple_loss:0.006910592783242464
2023-04-16 08:09:54 testing...
The generated pressure mean: 0.4185701310634613
loss_pred:0.03395872935652733, decouple_loss:0.006149160675704479
The generated pressure mean: 0.4271785020828247
loss_pred:0.032676294445991516, decouple_loss:0.006258752662688494
The generated pressure mean: 0.4318245053291321
loss_pred:0.033246126025915146, decouple_loss:0.006567708216607571
Loss: 0.03360997885465622, avg_mse: 0.047556232661008835
current test mse: 0.047556
Iteration: 1751, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43752801418304443
The generated pressure mean: 0.4430989623069763
loss_pred:0.022348763421177864, decouple_loss:0.00563086336478591
loss_pred:0.022235890850424767, decouple_loss:0.005382736679166555
The generated pressure mean: 0.4461219608783722
loss_pred:0.022289996966719627, decouple_loss:0.0061502582393586636
Iteration: 1752, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4439198970794678
loss_pred:0.022162502631545067, decouple_loss:0.005466461181640625
The generated pressure mean: 0.44215062260627747
loss_pred:0.0203754473477602, decouple_loss:0.005384978838264942
The generated pressure mean: 0.43454214930534363
loss_pred:0.022049175575375557, decouple_loss:0.005331851541996002
Iteration: 1753, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4524306654930115
loss_pred:0.02114454098045826, decouple_loss:0.006062849424779415
The generated pressure mean: 0.44970816373825073
loss_pred:0.021267635747790337, decouple_loss:0.006165423896163702
The generated pressure mean: 0.45063793659210205
loss_pred:0.021351691335439682, decouple_loss:0.00614226283505559
Iteration: 1754, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45347166061401367
loss_pred:0.021721601486206055, decouple_loss:0.0065964991226792336
The generated pressure mean: 0.450366735458374
loss_pred:0.020989572629332542, decouple_loss:0.006678501144051552
The generated pressure mean: 0.45550140738487244
loss_pred:0.02082820050418377, decouple_loss:0.006457697134464979
Iteration: 1755, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43329188227653503
loss_pred:0.021277517080307007, decouple_loss:0.005502590909600258
The generated pressure mean: 0.43887224793434143
loss_pred:0.02219352312386036, decouple_loss:0.005654352717101574
The generated pressure mean: 0.44563028216362
loss_pred:0.021004529669880867, decouple_loss:0.005441878456622362
Iteration: 1756, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4456242620944977
loss_pred:0.022960208356380463, decouple_loss:0.005325531121343374
The generated pressure mean: 0.44606441259384155
loss_pred:0.020616697147488594, decouple_loss:0.005029262509196997
The generated pressure mean: 0.4483146667480469
loss_pred:0.021520130336284637, decouple_loss:0.005026684142649174
Iteration: 1757, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4416874051094055
loss_pred:0.022075455635786057, decouple_loss:0.005912344437092543
The generated pressure mean: 0.45398959517478943
loss_pred:0.023310476914048195, decouple_loss:0.005077154841274023
The generated pressure mean: 0.45234525203704834
loss_pred:0.021828915923833847, decouple_loss:0.005325562786310911
Iteration: 1758, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44411444664001465
loss_pred:0.022159894928336143, decouple_loss:0.005671277176588774
The generated pressure mean: 0.44352400302886963
loss_pred:0.02163468673825264, decouple_loss:0.005819900892674923
The generated pressure mean: 0.44479119777679443
loss_pred:0.02176572196185589, decouple_loss:0.005579519551247358
Iteration: 1759, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4511227011680603
loss_pred:0.020950742065906525, decouple_loss:0.007129769306629896The generated pressure mean: 0.4486332833766937
loss_pred:0.021493900567293167, decouple_loss:0.006678913254290819
The generated pressure mean: 0.44961079955101013
loss_pred:0.020957037806510925, decouple_loss:0.006552712991833687
Iteration: 1760, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4443572461605072
loss_pred:0.020226266235113144, decouple_loss:0.00563889229670167
The generated pressure mean: 0.44660094380378723
loss_pred:0.02238347753882408, decouple_loss:0.006251220591366291
The generated pressure mean: 0.4457622468471527
loss_pred:0.02110205963253975, decouple_loss:0.005687424447387457
2023-04-16 08:11:55 testing...
The generated pressure mean: 0.41879889369010925
loss_pred:0.03522880747914314, decouple_loss:0.005088896490633488
The generated pressure mean: 0.42742839455604553
loss_pred:0.03377879038453102, decouple_loss:0.005016154143959284
The generated pressure mean: 0.43095484375953674
loss_pred:0.03396374732255936, decouple_loss:0.005333949811756611
Loss: 0.034581102430820465, avg_mse: 0.04814821109175682
current test mse: 0.048148
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012007_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012007_3_24hr.npz
NaN value num: 0
Iteration: 1761, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43790552020072937
loss_pred:0.020627202466130257, decouple_loss:0.00474186334758997
The generated pressure mean: 0.4368397891521454
loss_pred:0.02146422676742077, decouple_loss:0.004876452963799238
The generated pressure mean: 0.4368435740470886
loss_pred:0.020564943552017212, decouple_loss:0.004925739951431751
Iteration: 1762, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4563530385494232
loss_pred:0.021095992997288704, decouple_loss:0.00500744953751564
The generated pressure mean: 0.46091243624687195
loss_pred:0.02111208252608776, decouple_loss:0.005141550209373236
The generated pressure mean: 0.4554932117462158
loss_pred:0.021614516153931618, decouple_loss:0.00574461417272687
Iteration: 1763, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4480750262737274
loss_pred:0.022108493372797966, decouple_loss:0.005793052725493908
The generated pressure mean: 0.450242817401886
loss_pred:0.020925311371684074, decouple_loss:0.005442200694233179
The generated pressure mean: 0.4499281346797943
loss_pred:0.021846307441592216, decouple_loss:0.00568355992436409
Iteration: 1764, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44740957021713257
loss_pred:0.02226325124502182, decouple_loss:0.005404052324593067
The generated pressure mean: 0.44411423802375793
loss_pred:0.023409418761730194, decouple_loss:0.005604233127087355
The generated pressure mean: 0.44632479548454285
loss_pred:0.02098757028579712, decouple_loss:0.005828441120684147
Iteration: 1765, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44074827432632446
loss_pred:0.021464111283421516, decouple_loss:0.00563268456608057
The generated pressure mean: 0.4442228376865387
loss_pred:0.022082623094320297, decouple_loss:0.005691325757652521
The generated pressure mean: 0.4453992247581482
loss_pred:0.020203085616230965, decouple_loss:0.0048388331197202206
Iteration: 1766, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4456106424331665
loss_pred:0.020922381430864334, decouple_loss:0.004743682220578194The generated pressure mean: 0.44327864050865173
loss_pred:0.021474869921803474, decouple_loss:0.00464849965646863
The generated pressure mean: 0.4475197494029999
loss_pred:0.020695248618721962, decouple_loss:0.0049398611299693584
Iteration: 1767, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45009875297546387
loss_pred:0.02032303251326084, decouple_loss:0.005828362423926592
The generated pressure mean: 0.44683322310447693
loss_pred:0.01982850395143032, decouple_loss:0.005911932326853275
The generated pressure mean: 0.4471685588359833
loss_pred:0.024084391072392464, decouple_loss:0.006840002257376909
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1768, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4475208520889282
The generated pressure mean: 0.44605201482772827loss_pred:0.02090914361178875, decouple_loss:0.006750585976988077
loss_pred:0.02122889831662178, decouple_loss:0.006068170536309481
The generated pressure mean: 0.44559139013290405
loss_pred:0.020087609067559242, decouple_loss:0.006530925165861845
Iteration: 1769, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4492811858654022
loss_pred:0.021022683009505272, decouple_loss:0.005519771482795477
The generated pressure mean: 0.4469141662120819
loss_pred:0.021058041602373123, decouple_loss:0.00493898568674922
The generated pressure mean: 0.44914624094963074
loss_pred:0.02144000306725502, decouple_loss:0.005565204191952944
Iteration: 1770, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44721928238868713
loss_pred:0.021726466715335846, decouple_loss:0.006549029611051083The generated pressure mean: 0.4486229419708252
loss_pred:0.02077324688434601, decouple_loss:0.006840003188699484
The generated pressure mean: 0.4530462920665741
loss_pred:0.020891297608613968, decouple_loss:0.005750891286879778
2023-04-16 08:14:34 testing...
The generated pressure mean: 0.42017418146133423
loss_pred:0.03431525081396103, decouple_loss:0.005600123666226864
The generated pressure mean: 0.42849481105804443
loss_pred:0.033041808754205704, decouple_loss:0.005685275420546532
The generated pressure mean: 0.4316238760948181
loss_pred:0.03360551595687866, decouple_loss:0.005858624819666147
Loss: 0.03393992781639099, avg_mse: 0.04757838696241379
current test mse: 0.047578
Iteration: 1771, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44703778624534607
The generated pressure mean: 0.44108346104621887
loss_pred:0.02157505229115486, decouple_loss:0.004953623749315739
loss_pred:0.02023061364889145, decouple_loss:0.005031352397054434
The generated pressure mean: 0.44318971037864685
loss_pred:0.02046414278447628, decouple_loss:0.004912248812615871
Iteration: 1772, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4544161260128021
loss_pred:0.0233760979026556, decouple_loss:0.0048093595542013645
The generated pressure mean: 0.4516455829143524
loss_pred:0.019997209310531616, decouple_loss:0.005104258190840483
The generated pressure mean: 0.4487343430519104
loss_pred:0.021480193361639977, decouple_loss:0.004983238410204649
Iteration: 1773, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4419310688972473
loss_pred:0.021793490275740623, decouple_loss:0.005128891207277775
The generated pressure mean: 0.44152459502220154
loss_pred:0.02155470848083496, decouple_loss:0.004737233743071556
The generated pressure mean: 0.4376995265483856
loss_pred:0.02100897580385208, decouple_loss:0.004816992208361626
Iteration: 1774, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4466821253299713
loss_pred:0.0241757333278656, decouple_loss:0.005687530618160963
The generated pressure mean: 0.44786274433135986
loss_pred:0.020017122849822044, decouple_loss:0.005456609185785055
The generated pressure mean: 0.44344696402549744
loss_pred:0.022095486521720886, decouple_loss:0.005660082213580608
Iteration: 1775, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45301517844200134
loss_pred:0.02064582332968712, decouple_loss:0.0064773354679346085
The generated pressure mean: 0.4547363817691803
loss_pred:0.021972402930259705, decouple_loss:0.006212799809873104
The generated pressure mean: 0.45257487893104553
loss_pred:0.021426232531666756, decouple_loss:0.006518649868667126
Iteration: 1776, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4494178593158722
loss_pred:0.020867766812443733, decouple_loss:0.0048151807859539986
The generated pressure mean: 0.44279325008392334
loss_pred:0.022488782182335854, decouple_loss:0.004911963827908039
The generated pressure mean: 0.44427725672721863
loss_pred:0.021040713414549828, decouple_loss:0.00495639955624938
Iteration: 1777, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44330331683158875
loss_pred:0.019554615020751953, decouple_loss:0.004191211890429258
The generated pressure mean: 0.4426332414150238
loss_pred:0.021458083763718605, decouple_loss:0.004360939376056194
The generated pressure mean: 0.44178900122642517
loss_pred:0.02075379714369774, decouple_loss:0.0046577719040215015
Iteration: 1778, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44570407271385193
loss_pred:0.020446518436074257, decouple_loss:0.004152398556470871
The generated pressure mean: 0.4462544918060303
loss_pred:0.020782845094799995, decouple_loss:0.00413925526663661
The generated pressure mean: 0.45104357600212097
loss_pred:0.02010374888777733, decouple_loss:0.0040066903457045555
Iteration: 1779, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4486863911151886
The generated pressure mean: 0.45009559392929077
loss_pred:0.02156098373234272, decouple_loss:0.005095801781862974
loss_pred:0.020533107221126556, decouple_loss:0.005074957385659218
The generated pressure mean: 0.45095065236091614
loss_pred:0.02088482677936554, decouple_loss:0.004939278122037649
Iteration: 1780, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4459519684314728
loss_pred:0.020538903772830963, decouple_loss:0.004900030326098204
The generated pressure mean: 0.44280585646629333
loss_pred:0.02183166705071926, decouple_loss:0.00465055275708437
The generated pressure mean: 0.443970263004303
loss_pred:0.020777510479092598, decouple_loss:0.004652848467230797
2023-04-16 08:16:35 testing...
The generated pressure mean: 0.4207318425178528
loss_pred:0.03358978405594826, decouple_loss:0.005269056186079979
The generated pressure mean: 0.4318058490753174
loss_pred:0.03225468471646309, decouple_loss:0.0055938828736543655
The generated pressure mean: 0.43531742691993713
loss_pred:0.032807666808366776, decouple_loss:0.005697872955352068
Loss: 0.03316006064414978, avg_mse: 0.046994876116514206
current test mse: 0.046995
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012000_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012000_3_24hr.npz
NaN value num: 0
Iteration: 1781, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44998762011528015
loss_pred:0.021362926810979843, decouple_loss:0.004598680417984724
The generated pressure mean: 0.44561728835105896
loss_pred:0.02121655084192753, decouple_loss:0.004451208282262087
The generated pressure mean: 0.4430030882358551
loss_pred:0.020774126052856445, decouple_loss:0.004614038858562708
Iteration: 1782, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4466235935688019
loss_pred:0.021193183958530426, decouple_loss:0.005401063244789839
The generated pressure mean: 0.4442264437675476
loss_pred:0.020748816430568695, decouple_loss:0.005410962272435427
The generated pressure mean: 0.4454057514667511
loss_pred:0.020934319123625755, decouple_loss:0.005540828686207533
Iteration: 1783, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44680818915367126
loss_pred:0.02053985372185707, decouple_loss:0.005041180644184351
The generated pressure mean: 0.44565349817276
loss_pred:0.02243058942258358, decouple_loss:0.004979731515049934
The generated pressure mean: 0.44593924283981323
loss_pred:0.02063954994082451, decouple_loss:0.005004651378840208
Iteration: 1784, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4446506202220917
loss_pred:0.020617637783288956, decouple_loss:0.004217428155243397
The generated pressure mean: 0.4490393102169037
loss_pred:0.021873299032449722, decouple_loss:0.004229314159601927
The generated pressure mean: 0.45159897208213806
loss_pred:0.020924199372529984, decouple_loss:0.00422371830791235
Iteration: 1785, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4516494870185852
loss_pred:0.020526355132460594, decouple_loss:0.004920107778161764
The generated pressure mean: 0.44516927003860474
loss_pred:0.021894635632634163, decouple_loss:0.0047831786796450615
The generated pressure mean: 0.4495612680912018
loss_pred:0.021758606657385826, decouple_loss:0.00475692842155695
Iteration: 1786, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4428725242614746
loss_pred:0.021648578345775604, decouple_loss:0.005283790174871683
The generated pressure mean: 0.442063570022583
loss_pred:0.0213368721306324, decouple_loss:0.0051369816064834595
The generated pressure mean: 0.4409577548503876
loss_pred:0.021118123084306717, decouple_loss:0.00527553167194128
Iteration: 1787, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44185778498649597
loss_pred:0.02082979492843151, decouple_loss:0.004921289626508951
The generated pressure mean: 0.44561803340911865
loss_pred:0.020401502028107643, decouple_loss:0.004828855860978365
The generated pressure mean: 0.4418158233165741
loss_pred:0.021708481013774872, decouple_loss:0.00474225077778101
Iteration: 1788, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4451693296432495
loss_pred:0.021252844482660294, decouple_loss:0.004792369436472654
The generated pressure mean: 0.4515218734741211
loss_pred:0.021124476566910744, decouple_loss:0.004831465892493725
The generated pressure mean: 0.4501015841960907
loss_pred:0.022179489955306053, decouple_loss:0.004912577103823423
Iteration: 1789, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44256994128227234
loss_pred:0.021729424595832825, decouple_loss:0.0046913521364331245
The generated pressure mean: 0.44757509231567383
loss_pred:0.020640060305595398, decouple_loss:0.004873380064964294
The generated pressure mean: 0.4444323480129242
loss_pred:0.02072175405919552, decouple_loss:0.004682103171944618
Iteration: 1790, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4376707375049591
loss_pred:0.020335635170340538, decouple_loss:0.005276038311421871
The generated pressure mean: 0.45108267664909363
loss_pred:0.023004697635769844, decouple_loss:0.00493234908208251
The generated pressure mean: 0.44842028617858887
loss_pred:0.020685279741883278, decouple_loss:0.005194070748984814
2023-04-16 08:19:13 testing...
The generated pressure mean: 0.41768279671669006
loss_pred:0.03408578410744667, decouple_loss:0.005161508917808533
The generated pressure mean: 0.4277845323085785
loss_pred:0.0324869267642498, decouple_loss:0.005449812393635511
The generated pressure mean: 0.43175941705703735
loss_pred:0.03315615653991699, decouple_loss:0.005608757492154837
Loss: 0.03351328894495964, avg_mse: 0.04747561737895012
current test mse: 0.047476
Iteration: 1791, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44927674531936646
loss_pred:0.020240291953086853, decouple_loss:0.004337303806096315
The generated pressure mean: 0.4482423663139343
loss_pred:0.02128850854933262, decouple_loss:0.004550866782665253
The generated pressure mean: 0.4458901584148407
loss_pred:0.02097845822572708, decouple_loss:0.004481960088014603
Iteration: 1792, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4403184950351715
loss_pred:0.02184443734586239, decouple_loss:0.004296577535569668
The generated pressure mean: 0.4435827136039734
loss_pred:0.0215693898499012, decouple_loss:0.004462203476577997
The generated pressure mean: 0.45137926936149597
loss_pred:0.021167896687984467, decouple_loss:0.0048556942492723465
Iteration: 1793, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.459180623292923
loss_pred:0.022330380976200104, decouple_loss:0.004952542949467897
The generated pressure mean: 0.45652127265930176
loss_pred:0.020325494930148125, decouple_loss:0.004590719472616911
The generated pressure mean: 0.45810532569885254
loss_pred:0.02195555716753006, decouple_loss:0.004702500533312559
Iteration: 1794, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43876150250434875
loss_pred:0.02200859971344471, decouple_loss:0.00575164845213294
The generated pressure mean: 0.4405304491519928
loss_pred:0.02091297134757042, decouple_loss:0.005360423121601343
The generated pressure mean: 0.4338914453983307
loss_pred:0.0209447480738163, decouple_loss:0.0055315555073320866
Iteration: 1795, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4395562708377838
loss_pred:0.02365264669060707, decouple_loss:0.005332977045327425
The generated pressure mean: 0.4415496289730072
loss_pred:0.021009059622883797, decouple_loss:0.005382557865232229
The generated pressure mean: 0.44194552302360535
loss_pred:0.02230682037770748, decouple_loss:0.005112993530929089
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1796, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4494265913963318
loss_pred:0.02227056585252285, decouple_loss:0.00536990026012063
The generated pressure mean: 0.45069071650505066
loss_pred:0.020851897075772285, decouple_loss:0.0057447818107903
The generated pressure mean: 0.44629621505737305
loss_pred:0.020917953923344612, decouple_loss:0.005259127356112003
Iteration: 1797, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4500209391117096
loss_pred:0.02039240300655365, decouple_loss:0.006308784242719412
The generated pressure mean: 0.4511229395866394
loss_pred:0.020310238003730774, decouple_loss:0.006624423433095217
The generated pressure mean: 0.46024081110954285
loss_pred:0.020885560661554337, decouple_loss:0.006635789759457111
Iteration: 1798, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45057231187820435
loss_pred:0.021725162863731384, decouple_loss:0.00539409089833498
The generated pressure mean: 0.44644638895988464
loss_pred:0.020187295973300934, decouple_loss:0.005443626083433628
The generated pressure mean: 0.44026121497154236
loss_pred:0.020643671974539757, decouple_loss:0.005282266065478325
Iteration: 1799, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4415593147277832
loss_pred:0.020089706405997276, decouple_loss:0.004912534262984991
The generated pressure mean: 0.4422508776187897
loss_pred:0.02080523408949375, decouple_loss:0.004774185363203287
The generated pressure mean: 0.44122958183288574
loss_pred:0.021438244730234146, decouple_loss:0.004680371377617121
Iteration: 1800, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45140063762664795
loss_pred:0.021405350416898727, decouple_loss:0.005861544515937567
The generated pressure mean: 0.4584274888038635
loss_pred:0.020793402567505836, decouple_loss:0.005842712242156267
The generated pressure mean: 0.4539865553379059
loss_pred:0.02026253379881382, decouple_loss:0.0056976634077727795
2023-04-16 08:21:14 testing...
The generated pressure mean: 0.4201911687850952
loss_pred:0.03354566916823387, decouple_loss:0.006655059289187193
The generated pressure mean: 0.43001589179039
loss_pred:0.03176521882414818, decouple_loss:0.006827849894762039
The generated pressure mean: 0.43356767296791077
loss_pred:0.032636139541864395, decouple_loss:0.007035684306174517
Loss: 0.032990988343954086, avg_mse: 0.04669523239135742
current test mse: 0.046695
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012004_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012004_3_24hr.npz
NaN value num: 0
Iteration: 1801, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44533729553222656
loss_pred:0.02048487775027752, decouple_loss:0.006582076195627451
The generated pressure mean: 0.4403747320175171
loss_pred:0.021029001101851463, decouple_loss:0.006720336154103279
The generated pressure mean: 0.44442468881607056
loss_pred:0.023180974647402763, decouple_loss:0.006177964620292187
Iteration: 1802, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43526753783226013
loss_pred:0.019836584106087685, decouple_loss:0.005487866699695587
The generated pressure mean: 0.4358198046684265
loss_pred:0.020525019615888596, decouple_loss:0.005331612657755613
The generated pressure mean: 0.4355667233467102
loss_pred:0.019651208072900772, decouple_loss:0.006105434149503708
Iteration: 1803, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.454703152179718
The generated pressure mean: 0.4602200984954834loss_pred:0.0204961895942688, decouple_loss:0.004720211029052734
loss_pred:0.01943536102771759, decouple_loss:0.004806844517588615
The generated pressure mean: 0.4609064757823944
loss_pred:0.020290885120630264, decouple_loss:0.004657147917896509
Iteration: 1804, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45269373059272766
loss_pred:0.01971895806491375, decouple_loss:0.005034571513533592
The generated pressure mean: 0.45307624340057373
loss_pred:0.020211929455399513, decouple_loss:0.005271993111819029
The generated pressure mean: 0.4519587457180023
loss_pred:0.020940853282809258, decouple_loss:0.005246074870228767
Iteration: 1805, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4350424110889435
loss_pred:0.019858993589878082, decouple_loss:0.006126382853835821
The generated pressure mean: 0.44084295630455017
loss_pred:0.020842405036091805, decouple_loss:0.0057403952814638615
The generated pressure mean: 0.43700894713401794
loss_pred:0.01963055692613125, decouple_loss:0.006274644285440445
Iteration: 1806, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4477928876876831
The generated pressure mean: 0.4464951157569885
loss_pred:0.02171088382601738, decouple_loss:0.006283523980528116
loss_pred:0.01986750401556492, decouple_loss:0.006248422432690859
The generated pressure mean: 0.4502578377723694
loss_pred:0.0214591883122921, decouple_loss:0.00661714281886816
Iteration: 1807, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4463147521018982
The generated pressure mean: 0.4469565153121948
loss_pred:0.019745415076613426, decouple_loss:0.004659924190491438
loss_pred:0.01967797614634037, decouple_loss:0.004768590908497572
The generated pressure mean: 0.4519197642803192
loss_pred:0.0204960647970438, decouple_loss:0.0045020063407719135
Iteration: 1808, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43951037526130676
The generated pressure mean: 0.45125284790992737
loss_pred:0.020635057240724564, decouple_loss:0.005602297373116016
loss_pred:0.020711112767457962, decouple_loss:0.005588126834481955
The generated pressure mean: 0.44602543115615845
loss_pred:0.021410096436738968, decouple_loss:0.005565267521888018
Iteration: 1809, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45122194290161133
loss_pred:0.021706175059080124, decouple_loss:0.006111915223300457
The generated pressure mean: 0.4554121792316437
loss_pred:0.021053748205304146, decouple_loss:0.006292296107858419
The generated pressure mean: 0.4489721357822418
loss_pred:0.020176013931632042, decouple_loss:0.005978465545922518
Iteration: 1810, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44571202993392944
loss_pred:0.020698266103863716, decouple_loss:0.005050631705671549
The generated pressure mean: 0.4464539885520935
loss_pred:0.020811082795262337, decouple_loss:0.00487881526350975
The generated pressure mean: 0.44459444284439087
loss_pred:0.01970493793487549, decouple_loss:0.00483342818915844
2023-04-16 08:23:52 testing...
The generated pressure mean: 0.41826149821281433
loss_pred:0.03347073122859001, decouple_loss:0.005400503985583782
The generated pressure mean: 0.42569851875305176
loss_pred:0.032795343548059464, decouple_loss:0.005532402545213699
The generated pressure mean: 0.42971763014793396
loss_pred:0.03316246718168259, decouple_loss:0.005766565445810556
Loss: 0.03342117369174957, avg_mse: 0.04743775352835655
current test mse: 0.047438
Iteration: 1811, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44627875089645386
The generated pressure mean: 0.44345393776893616
loss_pred:0.021228648722171783, decouple_loss:0.005081139970570803
loss_pred:0.020593993365764618, decouple_loss:0.004614296369254589
The generated pressure mean: 0.4453180134296417
loss_pred:0.018960172310471535, decouple_loss:0.004836046602576971
Iteration: 1812, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44857460260391235
loss_pred:0.02100437693297863, decouple_loss:0.004804306663572788
The generated pressure mean: 0.4486575722694397
loss_pred:0.021652044728398323, decouple_loss:0.004808072932064533
The generated pressure mean: 0.4518652856349945
loss_pred:0.020218191668391228, decouple_loss:0.004920239560306072
Iteration: 1813, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4406593143939972
loss_pred:0.020968841388821602, decouple_loss:0.0049430001527071
The generated pressure mean: 0.4397979974746704
loss_pred:0.020445985719561577, decouple_loss:0.004634604323655367
The generated pressure mean: 0.4393010437488556
loss_pred:0.01984182372689247, decouple_loss:0.0047746021300554276
Iteration: 1814, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4504009187221527
The generated pressure mean: 0.4491216838359833
loss_pred:0.02149583026766777, decouple_loss:0.005715217906981707
loss_pred:0.02009182795882225, decouple_loss:0.005685159936547279
The generated pressure mean: 0.44925418496131897
loss_pred:0.019947223365306854, decouple_loss:0.005533862859010696
Iteration: 1815, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45216870307922363
loss_pred:0.021815333515405655, decouple_loss:0.005515178199857473
The generated pressure mean: 0.4496144950389862
loss_pred:0.020219897851347923, decouple_loss:0.005452568177133799
The generated pressure mean: 0.4550052583217621
loss_pred:0.019724979996681213, decouple_loss:0.005325903184711933
Iteration: 1816, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.449761301279068
loss_pred:0.02140994183719158, decouple_loss:0.0052606272511184216
The generated pressure mean: 0.4535827934741974
loss_pred:0.021839292719960213, decouple_loss:0.005373124498873949
The generated pressure mean: 0.44897738099098206
loss_pred:0.021085692569613457, decouple_loss:0.005039466079324484
Iteration: 1817, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4475102722644806
loss_pred:0.02124643698334694, decouple_loss:0.00533087644726038
The generated pressure mean: 0.4450438618659973
loss_pred:0.020801709964871407, decouple_loss:0.0051420158706605434
The generated pressure mean: 0.4481988549232483
loss_pred:0.023938780650496483, decouple_loss:0.00521475076675415
Iteration: 1818, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43241599202156067
loss_pred:0.020549235865473747, decouple_loss:0.005650929640978575
The generated pressure mean: 0.43153563141822815
loss_pred:0.021310793235898018, decouple_loss:0.00587161211296916
The generated pressure mean: 0.4283551871776581
loss_pred:0.02266639657318592, decouple_loss:0.006000175140798092
Iteration: 1819, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45546430349349976
loss_pred:0.022747738286852837, decouple_loss:0.005307226907461882
The generated pressure mean: 0.45049625635147095
loss_pred:0.020022273063659668, decouple_loss:0.00542675144970417
The generated pressure mean: 0.4511736035346985
loss_pred:0.02077924646437168, decouple_loss:0.005206349305808544
Iteration: 1820, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45689281821250916
loss_pred:0.02007056586444378, decouple_loss:0.006441361736506224
The generated pressure mean: 0.4620789587497711
loss_pred:0.021991753950715065, decouple_loss:0.006511990446597338
The generated pressure mean: 0.4622921645641327
loss_pred:0.021553363651037216, decouple_loss:0.006620244588702917
2023-04-16 08:25:53 testing...
The generated pressure mean: 0.4193003177642822
loss_pred:0.034726761281490326, decouple_loss:0.005948740988969803
The generated pressure mean: 0.4268220067024231
loss_pred:0.033760275691747665, decouple_loss:0.006209904793649912
The generated pressure mean: 0.4305596351623535
loss_pred:0.033779773861169815, decouple_loss:0.006289719603955746
Loss: 0.03439640998840332, avg_mse: 0.048162322491407394
current test mse: 0.048162
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012001_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012001_3_24hr.npz
NaN value num: 0
Iteration: 1821, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44617387652397156
loss_pred:0.021044863387942314, decouple_loss:0.0056912642903625965
The generated pressure mean: 0.4470805525779724
loss_pred:0.02261163294315338, decouple_loss:0.0055640325881540775
The generated pressure mean: 0.4433622360229492
loss_pred:0.0207807794213295, decouple_loss:0.005437231156975031
Iteration: 1822, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4361175298690796
The generated pressure mean: 0.4320242404937744
loss_pred:0.020212814211845398, decouple_loss:0.006919016595929861
loss_pred:0.02252957969903946, decouple_loss:0.006854325998574495
The generated pressure mean: 0.43363863229751587
loss_pred:0.0211420189589262, decouple_loss:0.006807528901845217
Iteration: 1823, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4489591419696808
loss_pred:0.022169817239046097, decouple_loss:0.006402149796485901
The generated pressure mean: 0.4444062113761902
loss_pred:0.02343711256980896, decouple_loss:0.005912444554269314
The generated pressure mean: 0.45177406072616577
loss_pred:0.020217284560203552, decouple_loss:0.005813129246234894
Iteration: 1824, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4578233063220978
loss_pred:0.020492371171712875, decouple_loss:0.005804820917546749
The generated pressure mean: 0.4543725252151489
loss_pred:0.021227668970823288, decouple_loss:0.006072525400668383
The generated pressure mean: 0.45978161692619324
loss_pred:0.021664513275027275, decouple_loss:0.005824240855872631
Iteration: 1825, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.449647456407547
loss_pred:0.021710187196731567, decouple_loss:0.005855858325958252
The generated pressure mean: 0.44954705238342285
loss_pred:0.02091898024082184, decouple_loss:0.0060767303220927715
The generated pressure mean: 0.4437856078147888
loss_pred:0.022481054067611694, decouple_loss:0.0058425068855285645
Iteration: 1826, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4336383640766144
loss_pred:0.02002730406820774, decouple_loss:0.006424421910196543
The generated pressure mean: 0.43270835280418396
loss_pred:0.020883966237306595, decouple_loss:0.006480996496975422
The generated pressure mean: 0.43383949995040894
loss_pred:0.021386146545410156, decouple_loss:0.00661498075351119
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1827, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4540944993495941
loss_pred:0.021546795964241028, decouple_loss:0.006367451976984739
The generated pressure mean: 0.4446949064731598
loss_pred:0.02119622565805912, decouple_loss:0.006120643578469753
The generated pressure mean: 0.45138439536094666
loss_pred:0.020429598167538643, decouple_loss:0.00588205736130476
Iteration: 1828, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45640793442726135
loss_pred:0.02149847522377968, decouple_loss:0.005783198866993189
The generated pressure mean: 0.45123445987701416
loss_pred:0.020897215232253075, decouple_loss:0.00603327015414834
The generated pressure mean: 0.4594646990299225
loss_pred:0.02114279195666313, decouple_loss:0.005786383058875799
Iteration: 1829, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.442374587059021
loss_pred:0.021222326904535294, decouple_loss:0.005345128010958433
The generated pressure mean: 0.44775235652923584
loss_pred:0.020533882081508636, decouple_loss:0.005257027689367533
The generated pressure mean: 0.446119487285614
loss_pred:0.021765878424048424, decouple_loss:0.005479089450091124
Iteration: 1830, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4384356141090393
loss_pred:0.020671579986810684, decouple_loss:0.005662959534674883
The generated pressure mean: 0.44147321581840515
loss_pred:0.021541479974985123, decouple_loss:0.005753783509135246
The generated pressure mean: 0.4471481144428253
loss_pred:0.021472813561558723, decouple_loss:0.005771555472165346
2023-04-16 08:28:41 testing...
The generated pressure mean: 0.4173327684402466
loss_pred:0.03361845761537552, decouple_loss:0.007405496202409267
The generated pressure mean: 0.42574140429496765
loss_pred:0.03365613892674446, decouple_loss:0.007312682457268238
The generated pressure mean: 0.42950937151908875
loss_pred:0.032882772386074066, decouple_loss:0.007504130247980356
Loss: 0.03375616297125816, avg_mse: 0.04803142696619034
current test mse: 0.048031
Iteration: 1831, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.457060843706131
loss_pred:0.01988048665225506, decouple_loss:0.007172083482146263
The generated pressure mean: 0.44869402050971985
loss_pred:0.019461950287222862, decouple_loss:0.007300570607185364
The generated pressure mean: 0.45756691694259644
loss_pred:0.021416792646050453, decouple_loss:0.007047184277325869
Iteration: 1832, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4408508241176605
loss_pred:0.022421834990382195, decouple_loss:0.00734470970928669
The generated pressure mean: 0.44724398851394653
The generated pressure mean: 0.44437435269355774loss_pred:0.020570848137140274, decouple_loss:0.007177917752414942
loss_pred:0.0207047238945961, decouple_loss:0.0073233554139733315
Iteration: 1833, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43579497933387756
loss_pred:0.02174334228038788, decouple_loss:0.005487435031682253
The generated pressure mean: 0.4346417188644409
loss_pred:0.02223210036754608, decouple_loss:0.005459355190396309
The generated pressure mean: 0.43720877170562744
loss_pred:0.02018878422677517, decouple_loss:0.0051899440586566925
Iteration: 1834, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4524226188659668
loss_pred:0.02095872536301613, decouple_loss:0.008256785571575165
The generated pressure mean: 0.44695809483528137
loss_pred:0.019971588626503944, decouple_loss:0.007892890833318233
The generated pressure mean: 0.44820767641067505
loss_pred:0.021276265382766724, decouple_loss:0.00819435529410839
Iteration: 1835, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4523426294326782
loss_pred:0.021464042365550995, decouple_loss:0.006674150004982948
The generated pressure mean: 0.4473573565483093
loss_pred:0.02237103134393692, decouple_loss:0.006468798033893108
The generated pressure mean: 0.4505850374698639
loss_pred:0.021442033350467682, decouple_loss:0.006647771690040827
Iteration: 1836, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4386555254459381
loss_pred:0.019913483411073685, decouple_loss:0.006473226007074118
The generated pressure mean: 0.4410431683063507
loss_pred:0.019975891336798668, decouple_loss:0.006418132688850164
The generated pressure mean: 0.4327998757362366
loss_pred:0.02139159105718136, decouple_loss:0.006330087780952454
Iteration: 1837, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4550977647304535
loss_pred:0.021018439903855324, decouple_loss:0.005604660138487816
The generated pressure mean: 0.45279645919799805
loss_pred:0.020605146884918213, decouple_loss:0.005580482073128223
The generated pressure mean: 0.4526168704032898
loss_pred:0.021382199600338936, decouple_loss:0.005514958873391151
Iteration: 1838, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45076775550842285
loss_pred:0.020336421206593513, decouple_loss:0.006363662891089916
The generated pressure mean: 0.45252156257629395
loss_pred:0.020917901769280434, decouple_loss:0.006282137706875801
The generated pressure mean: 0.4493348002433777
loss_pred:0.021645380184054375, decouple_loss:0.0062783509492874146
Iteration: 1839, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44923874735832214
loss_pred:0.0203078705817461, decouple_loss:0.0059348647482693195
The generated pressure mean: 0.4430917799472809
loss_pred:0.021317865699529648, decouple_loss:0.005858756601810455
The generated pressure mean: 0.4486701488494873
loss_pred:0.020621025934815407, decouple_loss:0.005830258596688509
Iteration: 1840, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43519964814186096
loss_pred:0.02074628882110119, decouple_loss:0.005551363807171583
The generated pressure mean: 0.4417591094970703
loss_pred:0.02154766023159027, decouple_loss:0.005298964213579893
The generated pressure mean: 0.4408128559589386
loss_pred:0.021593395620584488, decouple_loss:0.0052664089016616344
2023-04-16 08:30:41 testing...
The generated pressure mean: 0.41809940338134766
loss_pred:0.03367076441645622, decouple_loss:0.007274158298969269
The generated pressure mean: 0.42583033442497253
loss_pred:0.033559031784534454, decouple_loss:0.007276195101439953
The generated pressure mean: 0.42985737323760986
loss_pred:0.03309498354792595, decouple_loss:0.007488807197660208
Loss: 0.033808913081884384, avg_mse: 0.04757223278284073
current test mse: 0.047572
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012019_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012019_3_24hr.npz
NaN value num: 0
Iteration: 1841, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45558109879493713
loss_pred:0.02078058570623398, decouple_loss:0.006750261411070824
The generated pressure mean: 0.4520430564880371
loss_pred:0.02116616815328598, decouple_loss:0.006904409267008305
The generated pressure mean: 0.4521183967590332
loss_pred:0.021622125059366226, decouple_loss:0.006683466024696827
Iteration: 1842, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45234766602516174
loss_pred:0.022231126204133034, decouple_loss:0.005260208621621132
The generated pressure mean: 0.452411025762558
loss_pred:0.020950669422745705, decouple_loss:0.005162124987691641
The generated pressure mean: 0.44926488399505615
loss_pred:0.021932046860456467, decouple_loss:0.005494473502039909
Iteration: 1843, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4398633539676666
loss_pred:0.022367754951119423, decouple_loss:0.005743062123656273
The generated pressure mean: 0.4415365755558014
loss_pred:0.02133319526910782, decouple_loss:0.005799529142677784
The generated pressure mean: 0.43638503551483154
loss_pred:0.022395068779587746, decouple_loss:0.006085640285164118
Iteration: 1844, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4380314350128174
loss_pred:0.02096656523644924, decouple_loss:0.006046039517968893
The generated pressure mean: 0.4375953674316406
loss_pred:0.02110845223069191, decouple_loss:0.005939199589192867
The generated pressure mean: 0.4361981451511383
loss_pred:0.02197561040520668, decouple_loss:0.0058464170433580875
Iteration: 1845, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46604084968566895
loss_pred:0.02060808427631855, decouple_loss:0.00483122980222106
The generated pressure mean: 0.46299034357070923
loss_pred:0.022118566557765007, decouple_loss:0.0047289221547544
The generated pressure mean: 0.4623063802719116
loss_pred:0.02196231298148632, decouple_loss:0.005027102306485176
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1846, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4590090811252594
loss_pred:0.021195752546191216, decouple_loss:0.0066313068382442
The generated pressure mean: 0.45637625455856323
loss_pred:0.02129090391099453, decouple_loss:0.006381879094988108
The generated pressure mean: 0.45650967955589294
loss_pred:0.02247021719813347, decouple_loss:0.00640215864405036
Iteration: 1847, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4339703619480133
loss_pred:0.020901348441839218, decouple_loss:0.006034876219928265
The generated pressure mean: 0.43599990010261536
loss_pred:0.0226716510951519, decouple_loss:0.00584942102432251
The generated pressure mean: 0.4362902343273163
loss_pred:0.022354377433657646, decouple_loss:0.005971727892756462
Iteration: 1848, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43767884373664856
loss_pred:0.0217654500156641, decouple_loss:0.006205403245985508
The generated pressure mean: 0.4394986033439636
loss_pred:0.022367412224411964, decouple_loss:0.006349478382617235
The generated pressure mean: 0.44052568078041077
loss_pred:0.021592045202851295, decouple_loss:0.006181004457175732
Iteration: 1849, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4563756585121155
loss_pred:0.020085321739315987, decouple_loss:0.006294178776443005
The generated pressure mean: 0.4559900462627411
loss_pred:0.02150058187544346, decouple_loss:0.0059326705522835255
The generated pressure mean: 0.4492446482181549
loss_pred:0.02164771966636181, decouple_loss:0.006100779864937067
Iteration: 1850, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4603462517261505
loss_pred:0.021949097514152527, decouple_loss:0.005149786826223135
The generated pressure mean: 0.457022100687027
loss_pred:0.024036789312958717, decouple_loss:0.005329574458301067
The generated pressure mean: 0.4610714018344879
loss_pred:0.02020644210278988, decouple_loss:0.005340684205293655
2023-04-16 08:33:21 testing...
The generated pressure mean: 0.42070627212524414
loss_pred:0.0326615534722805, decouple_loss:0.0057840496301651
The generated pressure mean: 0.43075957894325256
loss_pred:0.03194263577461243, decouple_loss:0.006146527361124754
The generated pressure mean: 0.43520429730415344
loss_pred:0.032098621129989624, decouple_loss:0.0062571000307798386
Loss: 0.032537396997213364, avg_mse: 0.04599582031369209
current test mse: 0.045996
Iteration: 1851, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4434431791305542
The generated pressure mean: 0.44099053740501404
loss_pred:0.0220946092158556, decouple_loss:0.005862357094883919
loss_pred:0.02099377103149891, decouple_loss:0.005022314377129078
The generated pressure mean: 0.4410477578639984
loss_pred:0.021066365763545036, decouple_loss:0.004881953354924917
Iteration: 1852, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4367923438549042
loss_pred:0.020988594740629196, decouple_loss:0.006205074023455381
The generated pressure mean: 0.44048166275024414
loss_pred:0.02074533700942993, decouple_loss:0.006891219411045313
The generated pressure mean: 0.43896475434303284
loss_pred:0.021665504202246666, decouple_loss:0.006642496678978205
Iteration: 1853, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4502218961715698
loss_pred:0.021838929504156113, decouple_loss:0.004502532072365284
The generated pressure mean: 0.4499301612377167
loss_pred:0.020787229761481285, decouple_loss:0.004724046215415001
The generated pressure mean: 0.4472840130329132
loss_pred:0.022251185029745102, decouple_loss:0.0049012149684131145
Iteration: 1854, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45268064737319946
loss_pred:0.020630333572626114, decouple_loss:0.006214802153408527
The generated pressure mean: 0.4571843147277832
loss_pred:0.02111448161303997, decouple_loss:0.00616308581084013
The generated pressure mean: 0.45745962858200073
loss_pred:0.021365080028772354, decouple_loss:0.006212180946022272
Iteration: 1855, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44099587202072144
loss_pred:0.021512089297175407, decouple_loss:0.006294690538197756
The generated pressure mean: 0.44902825355529785
loss_pred:0.02097625471651554, decouple_loss:0.006483809556812048
The generated pressure mean: 0.44525283575057983
loss_pred:0.02103428728878498, decouple_loss:0.006540727335959673
Iteration: 1856, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45295411348342896
loss_pred:0.022020623087882996, decouple_loss:0.005733669735491276
The generated pressure mean: 0.4499170184135437
loss_pred:0.02095695398747921, decouple_loss:0.005669161677360535
The generated pressure mean: 0.44840195775032043
loss_pred:0.023710791021585464, decouple_loss:0.005594052840024233
Iteration: 1857, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4439200460910797
loss_pred:0.021050788462162018, decouple_loss:0.005870980676263571
The generated pressure mean: 0.4436781108379364
loss_pred:0.02030552364885807, decouple_loss:0.005473319906741381
The generated pressure mean: 0.4418976306915283
loss_pred:0.021691326051950455, decouple_loss:0.005317220464348793
Iteration: 1858, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44411227107048035
loss_pred:0.021020369604229927, decouple_loss:0.005705330986529589
The generated pressure mean: 0.4439755976200104
loss_pred:0.0223512202501297, decouple_loss:0.00616972241550684
The generated pressure mean: 0.44621965289115906
loss_pred:0.021816829219460487, decouple_loss:0.006081981118768454
Iteration: 1859, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4492066502571106
loss_pred:0.02197885327041149, decouple_loss:0.005838454235345125
The generated pressure mean: 0.44802069664001465
loss_pred:0.021388433873653412, decouple_loss:0.005899456329643726
The generated pressure mean: 0.4501499533653259
loss_pred:0.02101702243089676, decouple_loss:0.005792667157948017
Iteration: 1860, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4481046199798584
loss_pred:0.02175885997712612, decouple_loss:0.005729438737034798
The generated pressure mean: 0.453037828207016
loss_pred:0.021329617127776146, decouple_loss:0.005756345111876726
The generated pressure mean: 0.4518512785434723
loss_pred:0.021497495472431183, decouple_loss:0.005756766069680452
2023-04-16 08:35:20 testing...
The generated pressure mean: 0.41611331701278687
loss_pred:0.03353404253721237, decouple_loss:0.0059887683019042015
The generated pressure mean: 0.4251181185245514
loss_pred:0.032164596021175385, decouple_loss:0.006061390042304993
The generated pressure mean: 0.4288806617259979
loss_pred:0.03275929391384125, decouple_loss:0.006158976349979639
Loss: 0.033122800290584564, avg_mse: 0.046692267060279846
current test mse: 0.046692
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012011_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012011_3_24hr.npz
NaN value num: 0
Iteration: 1861, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4611043930053711
loss_pred:0.020991289988160133, decouple_loss:0.0054705459624528885
The generated pressure mean: 0.4616154134273529
loss_pred:0.020866194739937782, decouple_loss:0.005413620267063379
The generated pressure mean: 0.4556272625923157
loss_pred:0.021328579634428024, decouple_loss:0.005794192664325237
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1862, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44200101494789124
loss_pred:0.021942321211099625, decouple_loss:0.00604866910725832
The generated pressure mean: 0.4388933479785919
loss_pred:0.0207704808562994, decouple_loss:0.0057898024097085
The generated pressure mean: 0.4367556571960449
loss_pred:0.02071293443441391, decouple_loss:0.00586593896150589
Iteration: 1863, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4353918135166168
loss_pred:0.02034490555524826, decouple_loss:0.0065170214511454105
The generated pressure mean: 0.4312251806259155
loss_pred:0.02097291871905327, decouple_loss:0.006267318967729807The generated pressure mean: 0.4342932105064392
loss_pred:0.02105049416422844, decouple_loss:0.006201989948749542
Iteration: 1864, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4515366554260254
loss_pred:0.02013043314218521, decouple_loss:0.006147848442196846
The generated pressure mean: 0.45115938782691956
loss_pred:0.02218305692076683, decouple_loss:0.0059122005477547646
The generated pressure mean: 0.4542498290538788
loss_pred:0.021682308986783028, decouple_loss:0.005800808314234018
Iteration: 1865, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4509674608707428
loss_pred:0.020209169015288353, decouple_loss:0.00551706925034523
The generated pressure mean: 0.453628271818161
loss_pred:0.021582206711173058, decouple_loss:0.005685936659574509
The generated pressure mean: 0.44637614488601685
loss_pred:0.021735170856118202, decouple_loss:0.005534269381314516
Iteration: 1866, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4466460347175598
loss_pred:0.02091437205672264, decouple_loss:0.0065186237916350365
The generated pressure mean: 0.4403102993965149
loss_pred:0.020572997629642487, decouple_loss:0.006412603426724672
The generated pressure mean: 0.4406287968158722
loss_pred:0.02058296650648117, decouple_loss:0.006374172400683165
Iteration: 1867, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4486593008041382
loss_pred:0.021227559074759483, decouple_loss:0.006044110748916864
The generated pressure mean: 0.44861605763435364
loss_pred:0.02243528701364994, decouple_loss:0.006297805812209845
The generated pressure mean: 0.44620856642723083
loss_pred:0.02258649840950966, decouple_loss:0.0062386770732700825
Iteration: 1868, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44181811809539795
loss_pred:0.021058019250631332, decouple_loss:0.005865014623850584
The generated pressure mean: 0.448501855134964
loss_pred:0.021583648398518562, decouple_loss:0.006017590872943401
The generated pressure mean: 0.44025304913520813
loss_pred:0.02145715430378914, decouple_loss:0.006012425757944584
Iteration: 1869, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44991785287857056
The generated pressure mean: 0.45401638746261597
loss_pred:0.020793111994862556, decouple_loss:0.006038473453372717
loss_pred:0.021305294707417488, decouple_loss:0.006011585239320993
The generated pressure mean: 0.45494264364242554
loss_pred:0.021084608510136604, decouple_loss:0.006258326582610607
Iteration: 1870, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4464051425457001
loss_pred:0.020810194313526154, decouple_loss:0.005346009973436594
The generated pressure mean: 0.4485272765159607
loss_pred:0.021132556721568108, decouple_loss:0.005274186376482248
The generated pressure mean: 0.44227340817451477
loss_pred:0.022278599441051483, decouple_loss:0.0054867942817509174
2023-04-16 08:37:54 testing...
The generated pressure mean: 0.4204089641571045
loss_pred:0.034322626888751984, decouple_loss:0.0061223772354424
The generated pressure mean: 0.42930683493614197
loss_pred:0.03280365467071533, decouple_loss:0.006377897225320339
The generated pressure mean: 0.4334750175476074
loss_pred:0.033516641706228256, decouple_loss:0.006456395145505667
Loss: 0.03386358544230461, avg_mse: 0.04840182512998581
current test mse: 0.048402
Iteration: 1871, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4436471462249756
loss_pred:0.021334467455744743, decouple_loss:0.005248928442597389
The generated pressure mean: 0.4416886270046234
loss_pred:0.02046951837837696, decouple_loss:0.005957901477813721
The generated pressure mean: 0.4475999176502228
loss_pred:0.021045377478003502, decouple_loss:0.005378466099500656
Iteration: 1872, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4417436718940735
loss_pred:0.022340180352330208, decouple_loss:0.005981494672596455
The generated pressure mean: 0.44555309414863586
The generated pressure mean: 0.44345712661743164
loss_pred:0.021411361172795296, decouple_loss:0.005984239745885134
loss_pred:0.021342243999242783, decouple_loss:0.006171511486172676
Iteration: 1873, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44386473298072815
loss_pred:0.020053312182426453, decouple_loss:0.0065377200953662395
The generated pressure mean: 0.4523831605911255
loss_pred:0.021865157410502434, decouple_loss:0.006209387443959713
The generated pressure mean: 0.44650307297706604
loss_pred:0.021020574495196342, decouple_loss:0.006285158451646566
Iteration: 1874, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43930524587631226
loss_pred:0.02099759690463543, decouple_loss:0.006118063349276781
The generated pressure mean: 0.44771820306777954
loss_pred:0.021955830976366997, decouple_loss:0.006211263593286276
The generated pressure mean: 0.4431780278682709
loss_pred:0.02158174104988575, decouple_loss:0.006006320472806692
Iteration: 1875, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4509153962135315
loss_pred:0.02011336013674736, decouple_loss:0.007049974985420704
The generated pressure mean: 0.4413481056690216
loss_pred:0.021119138225913048, decouple_loss:0.006701796315610409
The generated pressure mean: 0.4447331428527832
loss_pred:0.020978491753339767, decouple_loss:0.006803223863244057
Iteration: 1876, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45684462785720825
loss_pred:0.0207425057888031, decouple_loss:0.00691981753334403
The generated pressure mean: 0.4495824873447418
loss_pred:0.021542280912399292, decouple_loss:0.007154971826821566
The generated pressure mean: 0.4491698741912842
loss_pred:0.021653736010193825, decouple_loss:0.007395061664283276
Iteration: 1877, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4423659145832062
loss_pred:0.020241158083081245, decouple_loss:0.0067236884497106075
The generated pressure mean: 0.4441656172275543
loss_pred:0.02229575626552105, decouple_loss:0.006750010885298252
The generated pressure mean: 0.4403790533542633
loss_pred:0.020756861194968224, decouple_loss:0.006852300837635994
Iteration: 1878, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44520753622055054
loss_pred:0.02087101899087429, decouple_loss:0.007821891456842422
The generated pressure mean: 0.4451257586479187
loss_pred:0.021095460280776024, decouple_loss:0.007888218387961388
The generated pressure mean: 0.4466243386268616
loss_pred:0.020408373326063156, decouple_loss:0.0076591153629124165
Iteration: 1879, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44911444187164307
The generated pressure mean: 0.44753581285476685
loss_pred:0.022166626527905464, decouple_loss:0.006173828616738319
loss_pred:0.020821338519454002, decouple_loss:0.006374024320393801
The generated pressure mean: 0.4516865909099579
loss_pred:0.0206389632076025, decouple_loss:0.006328699178993702
Iteration: 1880, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44114410877227783
loss_pred:0.022307639941573143, decouple_loss:0.007785303983837366
The generated pressure mean: 0.43864351511001587
loss_pred:0.02068805880844593, decouple_loss:0.007792526390403509
The generated pressure mean: 0.44488582015037537
loss_pred:0.021891718730330467, decouple_loss:0.007772214710712433
2023-04-16 08:39:53 testing...
The generated pressure mean: 0.41847074031829834
loss_pred:0.03371013328433037, decouple_loss:0.00660428823903203
The generated pressure mean: 0.4275757372379303
loss_pred:0.03262244537472725, decouple_loss:0.0066700587049126625
The generated pressure mean: 0.4314872920513153
loss_pred:0.03323648124933243, decouple_loss:0.006905014626681805
Loss: 0.03352601081132889, avg_mse: 0.04778095334768295
current test mse: 0.047781
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012000_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012000_3_24hr.npz
NaN value num: 0
Iteration: 1881, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4498802125453949
loss_pred:0.021414892747998238, decouple_loss:0.006440350785851479
The generated pressure mean: 0.44628259539604187
loss_pred:0.021924495697021484, decouple_loss:0.006434404756873846
The generated pressure mean: 0.4548631012439728
loss_pred:0.019978558644652367, decouple_loss:0.006270279176533222
Iteration: 1882, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4441349506378174
loss_pred:0.020588437095284462, decouple_loss:0.007447865791618824
The generated pressure mean: 0.44971340894699097
loss_pred:0.019599316641688347, decouple_loss:0.007160203531384468
The generated pressure mean: 0.44852215051651
loss_pred:0.019436616450548172, decouple_loss:0.007670061197131872
Iteration: 1883, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4360131621360779
loss_pred:0.02022678591310978, decouple_loss:0.0068079219199717045
The generated pressure mean: 0.44238054752349854
loss_pred:0.020231563597917557, decouple_loss:0.0065850322134792805
The generated pressure mean: 0.44428253173828125
loss_pred:0.020903998985886574, decouple_loss:0.00666805962100625
Iteration: 1884, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44586730003356934
loss_pred:0.018896112218499184, decouple_loss:0.007567151915282011
The generated pressure mean: 0.4482036828994751
loss_pred:0.019495004788041115, decouple_loss:0.007210556883364916
The generated pressure mean: 0.4471833407878876
loss_pred:0.02030990645289421, decouple_loss:0.007385507225990295
Iteration: 1885, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46004778146743774
loss_pred:0.021131930872797966, decouple_loss:0.0065294476225972176
The generated pressure mean: 0.4607950448989868
loss_pred:0.022405726835131645, decouple_loss:0.00641666678711772
The generated pressure mean: 0.4674817621707916
loss_pred:0.020701145753264427, decouple_loss:0.006429146975278854
Iteration: 1886, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44194674491882324
loss_pred:0.02322196401655674, decouple_loss:0.007388661149889231
The generated pressure mean: 0.4375852644443512
loss_pred:0.01983683556318283, decouple_loss:0.00740252248942852
The generated pressure mean: 0.44151994585990906
loss_pred:0.02000395394861698, decouple_loss:0.007118211127817631
Iteration: 1887, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43105605244636536
loss_pred:0.01949000544846058, decouple_loss:0.005901298951357603
The generated pressure mean: 0.42862027883529663
loss_pred:0.021132858470082283, decouple_loss:0.005859187338501215
The generated pressure mean: 0.42921462655067444
loss_pred:0.020554495975375175, decouple_loss:0.00596010684967041
Iteration: 1888, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4554678499698639
loss_pred:0.01945936679840088, decouple_loss:0.006969111040234566
The generated pressure mean: 0.45385444164276123
loss_pred:0.02332550846040249, decouple_loss:0.007361783180385828
The generated pressure mean: 0.45167723298072815
loss_pred:0.01963319070637226, decouple_loss:0.007044355850666761
Iteration: 1889, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45834189653396606
loss_pred:0.020149508491158485, decouple_loss:0.006387469358742237
The generated pressure mean: 0.4648023843765259
loss_pred:0.01972508803009987, decouple_loss:0.006418660283088684
The generated pressure mean: 0.4625215232372284
loss_pred:0.02126341685652733, decouple_loss:0.006624023895710707
Iteration: 1890, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4409332871437073
loss_pred:0.01996271312236786, decouple_loss:0.006916690152138472
The generated pressure mean: 0.4426303803920746
loss_pred:0.020757324993610382, decouple_loss:0.006875395774841309
The generated pressure mean: 0.443446546792984
loss_pred:0.019126562401652336, decouple_loss:0.006802723743021488
2023-04-16 08:42:28 testing...
The generated pressure mean: 0.42070889472961426
loss_pred:0.03543030843138695, decouple_loss:0.006776968017220497
The generated pressure mean: 0.4297236502170563
loss_pred:0.03420649468898773, decouple_loss:0.00680022407323122
The generated pressure mean: 0.4322774410247803
loss_pred:0.03459375351667404, decouple_loss:0.006921207532286644
Loss: 0.03508516401052475, avg_mse: 0.05034712329506874
current test mse: 0.050347
Iteration: 1891, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44080305099487305
loss_pred:0.020168092101812363, decouple_loss:0.005925782024860382
The generated pressure mean: 0.4391530156135559
loss_pred:0.01926795020699501, decouple_loss:0.0059727877378463745
The generated pressure mean: 0.4400372803211212
loss_pred:0.020682256668806076, decouple_loss:0.0059064836241304874
Iteration: 1892, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44075626134872437
loss_pred:0.021413013339042664, decouple_loss:0.005853026174008846
The generated pressure mean: 0.4456486105918884
loss_pred:0.021556125953793526, decouple_loss:0.006117238663136959
The generated pressure mean: 0.44655513763427734
loss_pred:0.02032347582280636, decouple_loss:0.006022874265909195
Iteration: 1893, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45458805561065674
loss_pred:0.019145799800753593, decouple_loss:0.005943937227129936
The generated pressure mean: 0.45284825563430786
loss_pred:0.019802812486886978, decouple_loss:0.00596020370721817
The generated pressure mean: 0.4475274980068207
loss_pred:0.020725108683109283, decouple_loss:0.006128521636128426
Iteration: 1894, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44415682554244995The generated pressure mean: 0.44852933287620544
loss_pred:0.02130701206624508, decouple_loss:0.006633328273892403
loss_pred:0.020484615117311478, decouple_loss:0.006527683697640896
The generated pressure mean: 0.44705668091773987
loss_pred:0.020289221778512, decouple_loss:0.0064729549922049046
Iteration: 1895, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45001545548439026
loss_pred:0.01970810443162918, decouple_loss:0.006522512063384056
The generated pressure mean: 0.4520169496536255
loss_pred:0.021344786509871483, decouple_loss:0.006335355807095766
The generated pressure mean: 0.44791311025619507
loss_pred:0.018644506111741066, decouple_loss:0.0062700239941477776
Iteration: 1896, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44886329770088196
loss_pred:0.020469728857278824, decouple_loss:0.006823145318776369
The generated pressure mean: 0.44454362988471985
loss_pred:0.020194677636027336, decouple_loss:0.006967418827116489
The generated pressure mean: 0.44249752163887024
loss_pred:0.019672337919473648, decouple_loss:0.006590333767235279
Iteration: 1897, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43759506940841675
loss_pred:0.019641701132059097, decouple_loss:0.006179621908813715
The generated pressure mean: 0.4448680281639099
loss_pred:0.019340340048074722, decouple_loss:0.0060356371104717255
The generated pressure mean: 0.44036751985549927
loss_pred:0.021144283935427666, decouple_loss:0.0057960995472967625
Iteration: 1898, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45051509141921997
loss_pred:0.019832152873277664, decouple_loss:0.006688044406473637
The generated pressure mean: 0.4535027742385864
loss_pred:0.020594151690602303, decouple_loss:0.006785305682569742
The generated pressure mean: 0.4541855752468109
loss_pred:0.02114345319569111, decouple_loss:0.007088999729603529
Iteration: 1899, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45035043358802795
loss_pred:0.018961569294333458, decouple_loss:0.006139602977782488
The generated pressure mean: 0.45499327778816223
loss_pred:0.021911608055233955, decouple_loss:0.00603285850957036
The generated pressure mean: 0.4534493386745453
loss_pred:0.021680543199181557, decouple_loss:0.0061128754168748856
Iteration: 1900, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43606245517730713
loss_pred:0.019992612302303314, decouple_loss:0.007276461459696293
The generated pressure mean: 0.4330010712146759
loss_pred:0.021467939019203186, decouple_loss:0.007837039418518543
The generated pressure mean: 0.4416072368621826
loss_pred:0.018667802214622498, decouple_loss:0.007375229150056839
2023-04-16 08:44:28 testing...
The generated pressure mean: 0.4175240397453308
loss_pred:0.03308870270848274, decouple_loss:0.007033644709736109
The generated pressure mean: 0.42449820041656494
loss_pred:0.031799446791410446, decouple_loss:0.007138588931411505
The generated pressure mean: 0.4289718568325043
loss_pred:0.032313112169504166, decouple_loss:0.007339101750403643
Loss: 0.03275894373655319, avg_mse: 0.04638579487800598
current test mse: 0.046386
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012018_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012018_3_24hr.npz
NaN value num: 0
Iteration: 1901, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4579438865184784
loss_pred:0.021152321249246597, decouple_loss:0.006660314742475748
The generated pressure mean: 0.45139244198799133
loss_pred:0.02172037400305271, decouple_loss:0.0068597691133618355
The generated pressure mean: 0.4542403519153595
loss_pred:0.021678388118743896, decouple_loss:0.006786933168768883
Iteration: 1902, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45688173174858093
loss_pred:0.02088739164173603, decouple_loss:0.006435005459934473
The generated pressure mean: 0.4513683021068573
loss_pred:0.02136952430009842, decouple_loss:0.006445855833590031
The generated pressure mean: 0.44772496819496155
loss_pred:0.021143963560461998, decouple_loss:0.006480484269559383
Iteration: 1903, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4402979910373688
loss_pred:0.021245913580060005, decouple_loss:0.005530693102627993
The generated pressure mean: 0.44335615634918213
loss_pred:0.02126929722726345, decouple_loss:0.005718494765460491
The generated pressure mean: 0.43775272369384766
loss_pred:0.021570216864347458, decouple_loss:0.005913874600082636
Iteration: 1904, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4457274079322815
loss_pred:0.019572116434574127, decouple_loss:0.00658088643103838
The generated pressure mean: 0.4427790343761444
loss_pred:0.021585607901215553, decouple_loss:0.006577890831977129
The generated pressure mean: 0.44152000546455383
loss_pred:0.02106834016740322, decouple_loss:0.00667849974706769
Iteration: 1905, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4517000615596771
The generated pressure mean: 0.4509738087654114
loss_pred:0.022326478734612465, decouple_loss:0.005217898171395063
loss_pred:0.02018270082771778, decouple_loss:0.005166745278984308
The generated pressure mean: 0.45481687784194946
loss_pred:0.021011970937252045, decouple_loss:0.005154445767402649
Iteration: 1906, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4508325159549713
loss_pred:0.02073162980377674, decouple_loss:0.007656620815396309
The generated pressure mean: 0.4520910680294037
loss_pred:0.021238408982753754, decouple_loss:0.007537230849266052
The generated pressure mean: 0.45079806447029114
loss_pred:0.02064456045627594, decouple_loss:0.007307479623705149
Iteration: 1907, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45011231303215027
loss_pred:0.019952459260821342, decouple_loss:0.006166258826851845
The generated pressure mean: 0.4517269432544708
loss_pred:0.021088285371661186, decouple_loss:0.005887449719011784
The generated pressure mean: 0.4471006691455841
loss_pred:0.021151524037122726, decouple_loss:0.005821398925036192
Iteration: 1908, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44316351413726807
loss_pred:0.02072533592581749, decouple_loss:0.0064931828528642654
The generated pressure mean: 0.442175030708313
loss_pred:0.021294474601745605, decouple_loss:0.006333155557513237
The generated pressure mean: 0.44453462958335876
loss_pred:0.020097527652978897, decouple_loss:0.006238521076738834
Iteration: 1909, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4521247148513794
loss_pred:0.02100185677409172, decouple_loss:0.00707007572054863
The generated pressure mean: 0.4499718248844147
loss_pred:0.021121414378285408, decouple_loss:0.006886483170092106
The generated pressure mean: 0.45610007643699646
loss_pred:0.02203758805990219, decouple_loss:0.0073293838649988174
Iteration: 1910, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4386788308620453
loss_pred:0.021245526149868965, decouple_loss:0.0053605372086167336
The generated pressure mean: 0.44511157274246216
loss_pred:0.02099555917084217, decouple_loss:0.005375806707888842
The generated pressure mean: 0.4416952431201935
loss_pred:0.0202022697776556, decouple_loss:0.005304777063429356
2023-04-16 08:47:13 testing...
The generated pressure mean: 0.4201276898384094
loss_pred:0.032950259745121, decouple_loss:0.006908215116709471
The generated pressure mean: 0.42932364344596863
loss_pred:0.03212935850024223, decouple_loss:0.00705574918538332
The generated pressure mean: 0.43365365266799927
loss_pred:0.03216968849301338, decouple_loss:0.007161926478147507
Loss: 0.03276853263378143, avg_mse: 0.04635681211948395
current test mse: 0.046357
Iteration: 1911, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44366252422332764
loss_pred:0.021300479769706726, decouple_loss:0.0062124417163431644
The generated pressure mean: 0.4468928277492523
loss_pred:0.021403012797236443, decouple_loss:0.0064729955047369
The generated pressure mean: 0.4425463378429413
loss_pred:0.02117052488029003, decouple_loss:0.006308841984719038
Iteration: 1912, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45783501863479614
loss_pred:0.019190866500139236, decouple_loss:0.006459462456405163
The generated pressure mean: 0.46077850461006165
loss_pred:0.021107109263539314, decouple_loss:0.006126232445240021
The generated pressure mean: 0.45846304297447205
loss_pred:0.0217861607670784, decouple_loss:0.006239051464945078
Iteration: 1913, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44871681928634644
loss_pred:0.02156425081193447, decouple_loss:0.005756696220487356
The generated pressure mean: 0.4500168561935425
loss_pred:0.02040446549654007, decouple_loss:0.005652370862662792
The generated pressure mean: 0.45214352011680603
loss_pred:0.020565666258335114, decouple_loss:0.005742620676755905
Iteration: 1914, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43613407015800476
loss_pred:0.019119713455438614, decouple_loss:0.005907739046961069
The generated pressure mean: 0.4338642656803131
loss_pred:0.02029508911073208, decouple_loss:0.00613363878801465
The generated pressure mean: 0.4378914535045624
loss_pred:0.022282522171735764, decouple_loss:0.006106934044510126
Iteration: 1915, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44928911328315735
loss_pred:0.021915221586823463, decouple_loss:0.0058531067334115505
The generated pressure mean: 0.44434401392936707
loss_pred:0.021011238917708397, decouple_loss:0.006242783740162849
The generated pressure mean: 0.44538435339927673
loss_pred:0.020859140902757645, decouple_loss:0.005950114224106073
Iteration: 1916, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4539484679698944
loss_pred:0.021263984963297844, decouple_loss:0.006936298683285713
The generated pressure mean: 0.4571181535720825
loss_pred:0.02026470936834812, decouple_loss:0.006960486993193626
The generated pressure mean: 0.4481624364852905
loss_pred:0.02049396000802517, decouple_loss:0.0067674508318305016
Iteration: 1917, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4588819146156311
loss_pred:0.020425887778401375, decouple_loss:0.005687889643013477
The generated pressure mean: 0.45693087577819824
loss_pred:0.021247390657663345, decouple_loss:0.005658074282109737
The generated pressure mean: 0.4623262286186218
loss_pred:0.021947622299194336, decouple_loss:0.005483104847371578
Iteration: 1918, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4360668659210205
loss_pred:0.022535273805260658, decouple_loss:0.006300295237451792
The generated pressure mean: 0.43853214383125305
loss_pred:0.02107306942343712, decouple_loss:0.0061729224398732185
The generated pressure mean: 0.4398861527442932
loss_pred:0.020929371938109398, decouple_loss:0.006383721251040697
Iteration: 1919, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4418333172798157
loss_pred:0.02106163091957569, decouple_loss:0.006437577772885561
The generated pressure mean: 0.44153475761413574
loss_pred:0.020850766450166702, decouple_loss:0.006564160343259573
The generated pressure mean: 0.44319483637809753
loss_pred:0.021952206268906593, decouple_loss:0.006460488308221102
Iteration: 1920, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4566269814968109
loss_pred:0.021420450881123543, decouple_loss:0.005237756296992302
The generated pressure mean: 0.4579979479312897
loss_pred:0.02082183212041855, decouple_loss:0.005386903416365385
The generated pressure mean: 0.461468368768692
loss_pred:0.02111324667930603, decouple_loss:0.00516339810565114
2023-04-16 08:49:13 testing...
The generated pressure mean: 0.4180830419063568
loss_pred:0.033439699560403824, decouple_loss:0.006579228211194277
The generated pressure mean: 0.42759454250335693
loss_pred:0.03285836800932884, decouple_loss:0.00681156013160944
The generated pressure mean: 0.4306465685367584
loss_pred:0.03314996510744095, decouple_loss:0.006920540239661932
Loss: 0.033487867563962936, avg_mse: 0.047111738473176956
current test mse: 0.047112
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012001_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012001_3_24hr.npz
NaN value num: 0
Iteration: 1921, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45700642466545105
loss_pred:0.021018901839852333, decouple_loss:0.005648716352880001
The generated pressure mean: 0.4436216652393341
loss_pred:0.020959503948688507, decouple_loss:0.0057561458088457584
The generated pressure mean: 0.44998645782470703
loss_pred:0.0190045814961195, decouple_loss:0.005836735013872385
Iteration: 1922, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4429999887943268
loss_pred:0.02057448774576187, decouple_loss:0.005410355981439352
The generated pressure mean: 0.4411914050579071
loss_pred:0.023979859426617622, decouple_loss:0.005557660013437271
The generated pressure mean: 0.43775928020477295
loss_pred:0.020948754623532295, decouple_loss:0.005423856899142265
Iteration: 1923, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4333619475364685
loss_pred:0.020778456702828407, decouple_loss:0.005681679584085941
The generated pressure mean: 0.435274600982666
loss_pred:0.02198239229619503, decouple_loss:0.0057915979996323586
The generated pressure mean: 0.4294704496860504
loss_pred:0.02212649956345558, decouple_loss:0.005803345236927271
Iteration: 1924, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44701701402664185
loss_pred:0.021204452961683273, decouple_loss:0.006479017902165651
The generated pressure mean: 0.4437395930290222
loss_pred:0.019650490954518318, decouple_loss:0.006374711636453867
The generated pressure mean: 0.44649583101272583
loss_pred:0.021382974460721016, decouple_loss:0.006078667473047972
Iteration: 1925, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46815168857574463
The generated pressure mean: 0.46528854966163635
loss_pred:0.020793873816728592, decouple_loss:0.006672302260994911
loss_pred:0.021401923149824142, decouple_loss:0.006681779865175486
The generated pressure mean: 0.4711364507675171
loss_pred:0.01959473267197609, decouple_loss:0.006530052050948143
Iteration: 1926, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4500688910484314
loss_pred:0.02009260654449463, decouple_loss:0.005880078766494989
The generated pressure mean: 0.44785284996032715
loss_pred:0.01980949565768242, decouple_loss:0.006197419483214617
The generated pressure mean: 0.4517032504081726
loss_pred:0.020931143313646317, decouple_loss:0.005722845438867807
Iteration: 1927, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.41952741146087646
loss_pred:0.020871585234999657, decouple_loss:0.006069252733141184
The generated pressure mean: 0.4221838712692261
loss_pred:0.022039277479052544, decouple_loss:0.005897291470319033
The generated pressure mean: 0.42400598526000977
loss_pred:0.02003176137804985, decouple_loss:0.005922253709286451
Iteration: 1928, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43775784969329834
loss_pred:0.019829437136650085, decouple_loss:0.006217778194695711
The generated pressure mean: 0.4397983253002167
loss_pred:0.020410703495144844, decouple_loss:0.006435200572013855
The generated pressure mean: 0.43931007385253906
loss_pred:0.021057384088635445, decouple_loss:0.0062158671207726
Iteration: 1929, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4642714262008667
loss_pred:0.02024224027991295, decouple_loss:0.006345439702272415
The generated pressure mean: 0.46411973237991333
loss_pred:0.02123599871993065, decouple_loss:0.006751015782356262
The generated pressure mean: 0.466757208108902
loss_pred:0.020749123767018318, decouple_loss:0.00605639535933733
Iteration: 1930, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44790810346603394
loss_pred:0.021699676290154457, decouple_loss:0.0056549967266619205
The generated pressure mean: 0.4558769464492798
loss_pred:0.02014334127306938, decouple_loss:0.00556248938664794
The generated pressure mean: 0.45580440759658813
loss_pred:0.02010665088891983, decouple_loss:0.005953663494437933
2023-04-16 08:52:01 testing...
The generated pressure mean: 0.42120492458343506
loss_pred:0.03533107042312622, decouple_loss:0.007000506855547428
The generated pressure mean: 0.42912527918815613
loss_pred:0.03447958827018738, decouple_loss:0.006975085008889437
The generated pressure mean: 0.4335133731365204
loss_pred:0.03414440155029297, decouple_loss:0.007236947771161795
Loss: 0.03500523045659065, avg_mse: 0.05068139359354973
current test mse: 0.050681
Iteration: 1931, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44037091732025146
loss_pred:0.01987222023308277, decouple_loss:0.006392284762114286
The generated pressure mean: 0.43911013007164
loss_pred:0.021966267377138138, decouple_loss:0.006529575679451227
The generated pressure mean: 0.4401690661907196
loss_pred:0.0210321806371212, decouple_loss:0.0069443718530237675
Iteration: 1932, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44499173760414124
The generated pressure mean: 0.4475410580635071
The generated pressure mean: 0.444243848323822
loss_pred:0.020149236544966698, decouple_loss:0.006235861219465733
loss_pred:0.019790029153227806, decouple_loss:0.006137013901025057
loss_pred:0.020024558529257774, decouple_loss:0.006161608267575502
Iteration: 1933, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4486744999885559
loss_pred:0.02039000391960144, decouple_loss:0.006143246777355671
The generated pressure mean: 0.4505773186683655
loss_pred:0.02179430052638054, decouple_loss:0.006278225686401129
The generated pressure mean: 0.4517037868499756
loss_pred:0.02116650715470314, decouple_loss:0.0063406480476260185
Iteration: 1934, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44674885272979736
loss_pred:0.02039099670946598, decouple_loss:0.007236408069729805
The generated pressure mean: 0.43824395537376404
loss_pred:0.01965996064245701, decouple_loss:0.007024306803941727
The generated pressure mean: 0.4400016665458679
loss_pred:0.019533716142177582, decouple_loss:0.0074832867830991745
Iteration: 1935, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.443782776594162
loss_pred:0.01873183250427246, decouple_loss:0.006087451241910458
The generated pressure mean: 0.4442373514175415
loss_pred:0.01939578168094158, decouple_loss:0.005940279923379421
The generated pressure mean: 0.44613197445869446
loss_pred:0.020131036639213562, decouple_loss:0.005848675966262817
Iteration: 1936, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44733482599258423
loss_pred:0.020587876439094543, decouple_loss:0.006277810782194138
The generated pressure mean: 0.4442344903945923
loss_pred:0.020937951281666756, decouple_loss:0.00629540765658021
The generated pressure mean: 0.4433867037296295
loss_pred:0.021927373483777046, decouple_loss:0.006376482546329498
Iteration: 1937, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4430975019931793
loss_pred:0.021644966676831245, decouple_loss:0.006586130242794752
The generated pressure mean: 0.45572352409362793
loss_pred:0.0201910100877285, decouple_loss:0.006116911303251982
The generated pressure mean: 0.4496600031852722
loss_pred:0.021610692143440247, decouple_loss:0.005974852945655584
Iteration: 1938, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44839656352996826
loss_pred:0.020478636026382446, decouple_loss:0.00599638232961297
The generated pressure mean: 0.4474636912345886
loss_pred:0.02026502415537834, decouple_loss:0.005985483061522245
The generated pressure mean: 0.4506862163543701
loss_pred:0.020828651264309883, decouple_loss:0.006364878732711077
Iteration: 1939, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4438987672328949
loss_pred:0.019771799445152283, decouple_loss:0.0063358149491250515
The generated pressure mean: 0.43910717964172363
loss_pred:0.02015591785311699, decouple_loss:0.005684123374521732
The generated pressure mean: 0.4401935636997223
loss_pred:0.01926937885582447, decouple_loss:0.0067139375023543835
Iteration: 1940, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44305408000946045
loss_pred:0.020139440894126892, decouple_loss:0.005353834945708513
The generated pressure mean: 0.43599075078964233
loss_pred:0.01988794095814228, decouple_loss:0.005192424636334181
The generated pressure mean: 0.44073718786239624
loss_pred:0.02038191258907318, decouple_loss:0.005240678321570158
2023-04-16 08:54:00 testing...
The generated pressure mean: 0.41392782330513
loss_pred:0.036165643483400345, decouple_loss:0.006488071754574776
The generated pressure mean: 0.4232022762298584
loss_pred:0.03492876514792442, decouple_loss:0.0065976707264781
The generated pressure mean: 0.42653220891952515
loss_pred:0.03507634252309799, decouple_loss:0.006651716306805611
Loss: 0.03571920841932297, avg_mse: 0.05136914923787117
current test mse: 0.051369
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012010_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012010_3_24hr.npz
NaN value num: 0
Iteration: 1941, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.47067058086395264
loss_pred:0.02111564390361309, decouple_loss:0.005697756074368954
The generated pressure mean: 0.46307140588760376
loss_pred:0.02067653276026249, decouple_loss:0.005752413533627987
The generated pressure mean: 0.4639798402786255
loss_pred:0.02130652777850628, decouple_loss:0.006093238480389118
Iteration: 1942, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4413672387599945
loss_pred:0.019523920491337776, decouple_loss:0.0061421580612659454
The generated pressure mean: 0.4420843720436096
loss_pred:0.021104373037815094, decouple_loss:0.005767590831965208
The generated pressure mean: 0.44517025351524353
loss_pred:0.02066783607006073, decouple_loss:0.006230800412595272
Iteration: 1943, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.430740624666214
loss_pred:0.02067847177386284, decouple_loss:0.005881159566342831
The generated pressure mean: 0.435669869184494
loss_pred:0.020790614187717438, decouple_loss:0.005489630624651909
The generated pressure mean: 0.4266219735145569
loss_pred:0.020190445706248283, decouple_loss:0.0056934175081551075
Iteration: 1944, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4513479769229889
loss_pred:0.021223140880465508, decouple_loss:0.005154700018465519
The generated pressure mean: 0.4581719636917114
loss_pred:0.01899115741252899, decouple_loss:0.005054751876741648
The generated pressure mean: 0.45625317096710205
loss_pred:0.020085342228412628, decouple_loss:0.004978707991540432
Iteration: 1945, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44994691014289856
The generated pressure mean: 0.45357006788253784
loss_pred:0.02047417126595974, decouple_loss:0.005635233595967293
loss_pred:0.020542597398161888, decouple_loss:0.005706701893359423
The generated pressure mean: 0.45135122537612915
loss_pred:0.019572267308831215, decouple_loss:0.005452268291264772
Iteration: 1946, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4468984603881836
loss_pred:0.0196343082934618, decouple_loss:0.005097517278045416
The generated pressure mean: 0.4502969980239868
loss_pred:0.020018383860588074, decouple_loss:0.005372247658669949
The generated pressure mean: 0.44935107231140137
loss_pred:0.020261360332369804, decouple_loss:0.005124958232045174
Iteration: 1947, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4453507661819458
loss_pred:0.01937171071767807, decouple_loss:0.00614489009603858
The generated pressure mean: 0.44850367307662964
loss_pred:0.019709577783942223, decouple_loss:0.006084675434976816
The generated pressure mean: 0.44082111120224
loss_pred:0.021362273022532463, decouple_loss:0.006110521964728832
Iteration: 1948, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44174128770828247
The generated pressure mean: 0.4434898793697357
loss_pred:0.01979859359562397, decouple_loss:0.0059270551428198814
loss_pred:0.020275412127375603, decouple_loss:0.00594858406111598
The generated pressure mean: 0.4431408643722534
loss_pred:0.019159238785505295, decouple_loss:0.006183684803545475
Iteration: 1949, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44687163829803467
loss_pred:0.020046764984726906, decouple_loss:0.006156856659799814
The generated pressure mean: 0.4469490051269531
loss_pred:0.019910156726837158, decouple_loss:0.00600972818210721
The generated pressure mean: 0.43954479694366455
loss_pred:0.02032933197915554, decouple_loss:0.0061585367657244205
Iteration: 1950, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4449067711830139
loss_pred:0.01889365166425705, decouple_loss:0.005362529307603836
The generated pressure mean: 0.4408659338951111
loss_pred:0.019857993349432945, decouple_loss:0.005826128181070089
The generated pressure mean: 0.44246402382850647
loss_pred:0.018854837864637375, decouple_loss:0.005280643235892057
2023-04-16 08:56:34 testing...
The generated pressure mean: 0.41739651560783386
loss_pred:0.03437768667936325, decouple_loss:0.005534491501748562
The generated pressure mean: 0.4288599491119385
loss_pred:0.03281010314822197, decouple_loss:0.005490999203175306
The generated pressure mean: 0.4320698380470276
loss_pred:0.03295497968792915, decouple_loss:0.005701398942619562
Loss: 0.03365970402956009, avg_mse: 0.049142491072416306
current test mse: 0.049142
Iteration: 1951, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45475393533706665
loss_pred:0.020806439220905304, decouple_loss:0.0053468733094632626
The generated pressure mean: 0.4577181041240692
loss_pred:0.02109166420996189, decouple_loss:0.004713388625532389
The generated pressure mean: 0.4539172351360321
loss_pred:0.020312100648880005, decouple_loss:0.004829598590731621
Iteration: 1952, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4493788778781891
loss_pred:0.019163839519023895, decouple_loss:0.006537765730172396
The generated pressure mean: 0.45055463910102844
loss_pred:0.018577151000499725, decouple_loss:0.005581348203122616
The generated pressure mean: 0.44749459624290466
loss_pred:0.019826291128993034, decouple_loss:0.00550087308511138
Iteration: 1953, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4396258592605591
loss_pred:0.019747668877243996, decouple_loss:0.005457490682601929
The generated pressure mean: 0.4381850063800812
loss_pred:0.01991068385541439, decouple_loss:0.00541455065831542
The generated pressure mean: 0.4416135251522064
loss_pred:0.020082643255591393, decouple_loss:0.005142327398061752
Iteration: 1954, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4485866129398346
loss_pred:0.021461987867951393, decouple_loss:0.005434812977910042
The generated pressure mean: 0.4407121539115906
loss_pred:0.019648414105176926, decouple_loss:0.005696761887520552
The generated pressure mean: 0.4376983344554901
loss_pred:0.02052166499197483, decouple_loss:0.005555278155952692
Iteration: 1955, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4585862159729004
loss_pred:0.02040942758321762, decouple_loss:0.005481543019413948
The generated pressure mean: 0.46130606532096863
loss_pred:0.020028341561555862, decouple_loss:0.004971329588443041
The generated pressure mean: 0.46063822507858276
loss_pred:0.020026538521051407, decouple_loss:0.0051521011628210545
Iteration: 1956, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4409714639186859
loss_pred:0.018957678228616714, decouple_loss:0.00480224471539259
The generated pressure mean: 0.43873777985572815
loss_pred:0.021228255704045296, decouple_loss:0.0051224869675934315
The generated pressure mean: 0.4425310492515564
loss_pred:0.02037106268107891, decouple_loss:0.0048915911465883255
Iteration: 1957, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4407065510749817
loss_pred:0.019598180428147316, decouple_loss:0.004273132886737585
The generated pressure mean: 0.44333574175834656
loss_pred:0.021263092756271362, decouple_loss:0.004599888343364
The generated pressure mean: 0.44801026582717896
loss_pred:0.019216284155845642, decouple_loss:0.004875740502029657
Iteration: 1958, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45730772614479065
loss_pred:0.02032085694372654, decouple_loss:0.004822774790227413
The generated pressure mean: 0.44991326332092285
loss_pred:0.019507553428411484, decouple_loss:0.004908898379653692
The generated pressure mean: 0.45655396580696106
loss_pred:0.02144821360707283, decouple_loss:0.004851911682635546
Iteration: 1959, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4394911527633667
loss_pred:0.021067272871732712, decouple_loss:0.004952786955982447
The generated pressure mean: 0.43463534116744995
loss_pred:0.020140742883086205, decouple_loss:0.004897880833595991
The generated pressure mean: 0.440212607383728
loss_pred:0.021446719765663147, decouple_loss:0.004946783185005188
Iteration: 1960, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4499678313732147
loss_pred:0.01877574436366558, decouple_loss:0.0057174633257091045
The generated pressure mean: 0.4479096233844757
loss_pred:0.021601686254143715, decouple_loss:0.005642551928758621
The generated pressure mean: 0.4513729512691498
loss_pred:0.019912779331207275, decouple_loss:0.0055273245088756084
2023-04-16 08:58:35 testing...
The generated pressure mean: 0.4179559350013733
loss_pred:0.033524349331855774, decouple_loss:0.00691959448158741
The generated pressure mean: 0.42630302906036377
loss_pred:0.032440733164548874, decouple_loss:0.0070313639007508755
The generated pressure mean: 0.4298849403858185
loss_pred:0.03223620355129242, decouple_loss:0.007318548392504454
Loss: 0.03308825194835663, avg_mse: 0.047311149537563324
current test mse: 0.047311
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012009_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012009_3_24hr.npz
NaN value num: 0
Iteration: 1961, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4568667709827423
loss_pred:0.01926562376320362, decouple_loss:0.006422706414014101
The generated pressure mean: 0.4492241442203522
loss_pred:0.020641110837459564, decouple_loss:0.00650444533675909
The generated pressure mean: 0.45802798867225647
loss_pred:0.019033638760447502, decouple_loss:0.006656254641711712
Iteration: 1962, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44552716612815857
loss_pred:0.021863505244255066, decouple_loss:0.005661691538989544
The generated pressure mean: 0.44755908846855164
The generated pressure mean: 0.4421176612377167
loss_pred:0.020230775699019432, decouple_loss:0.005486336071044207
loss_pred:0.019854223355650902, decouple_loss:0.005895123817026615
Iteration: 1963, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43879881501197815
loss_pred:0.01949327625334263, decouple_loss:0.004355228040367365
The generated pressure mean: 0.4424421489238739
loss_pred:0.020778097212314606, decouple_loss:0.004155626520514488
The generated pressure mean: 0.4366931915283203
loss_pred:0.020629845559597015, decouple_loss:0.004506655037403107
Iteration: 1964, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4553444981575012
loss_pred:0.022921383380889893, decouple_loss:0.005154997110366821
The generated pressure mean: 0.4572101831436157
loss_pred:0.021562015637755394, decouple_loss:0.0053164479322731495
The generated pressure mean: 0.46105822920799255
loss_pred:0.019831139594316483, decouple_loss:0.005626277532428503
Iteration: 1965, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44160184264183044
loss_pred:0.020335184410214424, decouple_loss:0.005005872342735529
The generated pressure mean: 0.439594030380249
loss_pred:0.01960299350321293, decouple_loss:0.0049179899506270885
The generated pressure mean: 0.43515658378601074
loss_pred:0.02072649635374546, decouple_loss:0.005144542083144188
Iteration: 1966, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4469423294067383
loss_pred:0.020450914278626442, decouple_loss:0.004901469685137272
The generated pressure mean: 0.4456869065761566
loss_pred:0.020146027207374573, decouple_loss:0.005118097178637981
The generated pressure mean: 0.45042189955711365
loss_pred:0.019736703485250473, decouple_loss:0.004935449920594692
Iteration: 1967, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44894275069236755
loss_pred:0.020593266934156418, decouple_loss:0.004539051558822393
The generated pressure mean: 0.46105149388313293
loss_pred:0.021855488419532776, decouple_loss:0.004734659101814032
The generated pressure mean: 0.4581983983516693
loss_pred:0.020711049437522888, decouple_loss:0.004572303034365177
Iteration: 1968, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.445335328578949
loss_pred:0.020159197971224785, decouple_loss:0.005214763805270195
The generated pressure mean: 0.44002091884613037
loss_pred:0.02093658037483692, decouple_loss:0.005201131571084261
The generated pressure mean: 0.4401795268058777
loss_pred:0.019972283393144608, decouple_loss:0.005149975419044495
Iteration: 1969, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45618516206741333
loss_pred:0.022475115954875946, decouple_loss:0.004762868396937847
The generated pressure mean: 0.44735610485076904
loss_pred:0.020600372925400734, decouple_loss:0.004634575918316841
The generated pressure mean: 0.4491978585720062
loss_pred:0.02070949226617813, decouple_loss:0.004704491700977087
Iteration: 1970, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44761568307876587
loss_pred:0.021092526614665985, decouple_loss:0.005115604493767023
The generated pressure mean: 0.44904059171676636
loss_pred:0.021114127710461617, decouple_loss:0.005163757596164942
The generated pressure mean: 0.4429706037044525
loss_pred:0.0199798084795475, decouple_loss:0.0049262880347669125
2023-04-16 09:01:15 testing...
The generated pressure mean: 0.41642090678215027
loss_pred:0.03461581468582153, decouple_loss:0.006166281644254923
The generated pressure mean: 0.4240056872367859
loss_pred:0.033884793519973755, decouple_loss:0.006394549738615751
The generated pressure mean: 0.4281078279018402
loss_pred:0.03388103097677231, decouple_loss:0.0064554656855762005
Loss: 0.03444415330886841, avg_mse: 0.04896562173962593
current test mse: 0.048966
Iteration: 1971, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4452943205833435
loss_pred:0.020853616297245026, decouple_loss:0.005627680104225874
The generated pressure mean: 0.4559224843978882
loss_pred:0.020504828542470932, decouple_loss:0.005388888530433178
The generated pressure mean: 0.44370728731155396
loss_pred:0.019889753311872482, decouple_loss:0.005366590339690447
Iteration: 1972, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4375573992729187
loss_pred:0.020693916827440262, decouple_loss:0.00578248780220747
The generated pressure mean: 0.43948647379875183
loss_pred:0.020735330879688263, decouple_loss:0.005928755737841129
The generated pressure mean: 0.44520583748817444
loss_pred:0.01998044364154339, decouple_loss:0.005823772866278887
Iteration: 1973, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46203377842903137
loss_pred:0.02142218127846718, decouple_loss:0.006231480278074741
The generated pressure mean: 0.46112191677093506
loss_pred:0.021954424679279327, decouple_loss:0.006126141641288996
The generated pressure mean: 0.4657132625579834
loss_pred:0.019928978756070137, decouple_loss:0.006262423470616341
Iteration: 1974, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44441938400268555
loss_pred:0.020855363458395004, decouple_loss:0.006293848156929016
The generated pressure mean: 0.44149741530418396
loss_pred:0.019543269649147987, decouple_loss:0.0065521737560629845
The generated pressure mean: 0.44852301478385925
loss_pred:0.02059994824230671, decouple_loss:0.0065352520905435085
Iteration: 1975, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4371965825557709
loss_pred:0.020933659747242928, decouple_loss:0.005069193430244923
The generated pressure mean: 0.43918293714523315
loss_pred:0.019963370636105537, decouple_loss:0.004995609633624554
The generated pressure mean: 0.4426375925540924
loss_pred:0.021003881469368935, decouple_loss:0.004987618885934353
Iteration: 1976, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45071613788604736
loss_pred:0.01959403231739998, decouple_loss:0.005695701111108065
The generated pressure mean: 0.4456118047237396
loss_pred:0.020536696538329124, decouple_loss:0.005421503912657499
The generated pressure mean: 0.4511052668094635
loss_pred:0.019125137478113174, decouple_loss:0.005354718770831823
Iteration: 1977, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44980183243751526
loss_pred:0.02088351547718048, decouple_loss:0.005806116387248039
The generated pressure mean: 0.4549335539340973
loss_pred:0.019865471869707108, decouple_loss:0.005569014698266983
The generated pressure mean: 0.4531756639480591
loss_pred:0.020389623939990997, decouple_loss:0.005707500968128443
Iteration: 1978, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4409394860267639
loss_pred:0.019718850031495094, decouple_loss:0.004945478867739439
The generated pressure mean: 0.434700608253479
loss_pred:0.020357472822070122, decouple_loss:0.004898289684206247
The generated pressure mean: 0.4363188147544861
loss_pred:0.020921774208545685, decouple_loss:0.005098460242152214
Iteration: 1979, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44838187098503113
loss_pred:0.0190793015062809, decouple_loss:0.005548649467527866
The generated pressure mean: 0.4478296637535095
loss_pred:0.020326940342783928, decouple_loss:0.005715074483305216
The generated pressure mean: 0.4480104148387909
loss_pred:0.019787248224020004, decouple_loss:0.005483557935804129
Iteration: 1980, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46143972873687744
loss_pred:0.020389461889863014, decouple_loss:0.004532589577138424
The generated pressure mean: 0.4563805162906647
loss_pred:0.02054605819284916, decouple_loss:0.004837437532842159
The generated pressure mean: 0.4601229727268219
loss_pred:0.02066175825893879, decouple_loss:0.005032315384596586
2023-04-16 09:03:17 testing...
The generated pressure mean: 0.41807499527931213
loss_pred:0.034309979528188705, decouple_loss:0.005444904323667288
The generated pressure mean: 0.42431655526161194
loss_pred:0.03331184759736061, decouple_loss:0.005699663423001766
The generated pressure mean: 0.42793235182762146
loss_pred:0.033942196518182755, decouple_loss:0.005930105224251747
Loss: 0.034139253199100494, avg_mse: 0.049083247780799866
current test mse: 0.049083
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012012_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012012_3_24hr.npz
NaN value num: 0
Iteration: 1981, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45703351497650146
loss_pred:0.0208281259983778, decouple_loss:0.005029039923101664
The generated pressure mean: 0.4523734450340271
loss_pred:0.020090894773602486, decouple_loss:0.00507115526124835
The generated pressure mean: 0.448249876499176
loss_pred:0.02191474847495556, decouple_loss:0.004869145806878805
Iteration: 1982, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.438556045293808
loss_pred:0.021588388830423355, decouple_loss:0.005455276928842068
The generated pressure mean: 0.43556100130081177
The generated pressure mean: 0.4403066039085388
loss_pred:0.020395338535308838, decouple_loss:0.005681364331394434
loss_pred:0.01919698715209961, decouple_loss:0.005419088527560234
Iteration: 1983, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44181355834007263
loss_pred:0.02033424936234951, decouple_loss:0.005245467182248831
The generated pressure mean: 0.44280657172203064
loss_pred:0.01957891322672367, decouple_loss:0.004890005569905043
The generated pressure mean: 0.44067639112472534
loss_pred:0.020768040791153908, decouple_loss:0.004782890435308218
Iteration: 1984, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4448203146457672
loss_pred:0.020527899265289307, decouple_loss:0.005151187069714069
The generated pressure mean: 0.4472014605998993
loss_pred:0.020288851112127304, decouple_loss:0.005184380803257227
The generated pressure mean: 0.44112107157707214
loss_pred:0.020747536793351173, decouple_loss:0.005060495808720589
Iteration: 1985, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.455581933259964
loss_pred:0.020161665976047516, decouple_loss:0.005442323628813028
The generated pressure mean: 0.4584033787250519
loss_pred:0.01983053795993328, decouple_loss:0.005314853973686695
The generated pressure mean: 0.45383793115615845
loss_pred:0.02096358872950077, decouple_loss:0.005340368486940861
Iteration: 1986, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43527933955192566
loss_pred:0.021949199959635735, decouple_loss:0.004602864384651184
The generated pressure mean: 0.44063231348991394
loss_pred:0.020458782091736794, decouple_loss:0.00467266421765089
The generated pressure mean: 0.43853431940078735
loss_pred:0.020804446190595627, decouple_loss:0.004832897335290909
Iteration: 1987, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4469190537929535
loss_pred:0.020581388846039772, decouple_loss:0.004959875252097845
The generated pressure mean: 0.43863993883132935
loss_pred:0.020624510943889618, decouple_loss:0.005118243861943483
The generated pressure mean: 0.4453592896461487
loss_pred:0.022179946303367615, decouple_loss:0.005157026462256908
Iteration: 1988, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45873942971229553
loss_pred:0.020450003445148468, decouple_loss:0.004966408014297485
The generated pressure mean: 0.4598836302757263
loss_pred:0.02161414548754692, decouple_loss:0.004874708130955696
The generated pressure mean: 0.46147531270980835
loss_pred:0.01981917954981327, decouple_loss:0.0049176583997905254
Iteration: 1989, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4452957212924957
loss_pred:0.020072445273399353, decouple_loss:0.005477456375956535
The generated pressure mean: 0.44640204310417175
loss_pred:0.019593385979533195, decouple_loss:0.005694409366697073
The generated pressure mean: 0.44627973437309265
loss_pred:0.02008439227938652, decouple_loss:0.005669947247952223
Iteration: 1990, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43619784712791443
loss_pred:0.021057767793536186, decouple_loss:0.005242886021733284
The generated pressure mean: 0.4344395697116852
loss_pred:0.020650675520300865, decouple_loss:0.005078720860183239
The generated pressure mean: 0.4377267360687256
loss_pred:0.0207089651376009, decouple_loss:0.005263027735054493
2023-04-16 09:05:54 testing...
The generated pressure mean: 0.4182569682598114
loss_pred:0.0336327888071537, decouple_loss:0.006119856145232916
The generated pressure mean: 0.42606455087661743
loss_pred:0.03231414407491684, decouple_loss:0.006360170431435108
The generated pressure mean: 0.42999789118766785
loss_pred:0.03277088701725006, decouple_loss:0.006406712345778942
Loss: 0.033220719546079636, avg_mse: 0.048080239444971085
current test mse: 0.04808
Iteration: 1991, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4474780857563019
loss_pred:0.01966237649321556, decouple_loss:0.005553515627980232
The generated pressure mean: 0.44916287064552307
loss_pred:0.02035769261419773, decouple_loss:0.0055160680785775185
The generated pressure mean: 0.44805508852005005
loss_pred:0.021963590756058693, decouple_loss:0.005434160586446524
Iteration: 1992, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4500882625579834
loss_pred:0.020658383145928383, decouple_loss:0.005305751226842403
The generated pressure mean: 0.44907015562057495
The generated pressure mean: 0.4493761658668518
loss_pred:0.020509827882051468, decouple_loss:0.00523297768086195
loss_pred:0.019810635596513748, decouple_loss:0.005271501839160919
Iteration: 1993, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4463966190814972
loss_pred:0.018961599096655846, decouple_loss:0.004427382256835699
The generated pressure mean: 0.43968963623046875
loss_pred:0.022646883502602577, decouple_loss:0.00448532123118639
The generated pressure mean: 0.442456990480423
loss_pred:0.020271342247724533, decouple_loss:0.004468224011361599
Iteration: 1994, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45085281133651733
loss_pred:0.02007192187011242, decouple_loss:0.005479324609041214
The generated pressure mean: 0.44486764073371887
loss_pred:0.020363476127386093, decouple_loss:0.005710265599191189
The generated pressure mean: 0.44800180196762085
loss_pred:0.01983451656997204, decouple_loss:0.005747826769948006
Iteration: 1995, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44807180762290955
loss_pred:0.019827475771307945, decouple_loss:0.00467458413913846
The generated pressure mean: 0.4472816586494446
loss_pred:0.020675351843237877, decouple_loss:0.004961272235959768
The generated pressure mean: 0.4504983425140381
loss_pred:0.01876172423362732, decouple_loss:0.0046526044607162476
Iteration: 1996, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45052167773246765
loss_pred:0.01977364346385002, decouple_loss:0.006801282986998558
The generated pressure mean: 0.4402734935283661
loss_pred:0.0209408700466156, decouple_loss:0.006572285201400518
The generated pressure mean: 0.44253605604171753
loss_pred:0.020620394498109818, decouple_loss:0.006678187754005194
Iteration: 1997, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44780388474464417
loss_pred:0.0203411765396595, decouple_loss:0.004530128091573715
The generated pressure mean: 0.44081950187683105
loss_pred:0.02136954478919506, decouple_loss:0.0045350780710577965
The generated pressure mean: 0.44586676359176636
loss_pred:0.019781364127993584, decouple_loss:0.004489575047045946
Iteration: 1998, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4395114481449127
loss_pred:0.021462226286530495, decouple_loss:0.004771930165588856
The generated pressure mean: 0.4404594600200653
loss_pred:0.019320612773299217, decouple_loss:0.004763465840369463
The generated pressure mean: 0.441705584526062
loss_pred:0.020540527999401093, decouple_loss:0.004810513462871313
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1999, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46275973320007324
loss_pred:0.019195642322301865, decouple_loss:0.0044624945148825645
The generated pressure mean: 0.4659222364425659
loss_pred:0.020935362204909325, decouple_loss:0.004150896333158016
The generated pressure mean: 0.4581736922264099
loss_pred:0.019641799852252007, decouple_loss:0.004108057823032141
Iteration: 2000, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.444963276386261
loss_pred:0.020462676882743835, decouple_loss:0.004329189658164978
The generated pressure mean: 0.44517776370048523
loss_pred:0.01946699619293213, decouple_loss:0.004446697887033224
The generated pressure mean: 0.4435196816921234
loss_pred:0.019528815522789955, decouple_loss:0.004425460007041693
2023-04-16 09:07:57 itr: 2000
training loss: [0.01975009 0.02067914 0.01968933]
save model to /work/09012/haoli1/ls6/ERA5_PredRNN/checkpoints/WV_1_PC_0_EH_1_PS_40/model_2000.ckpt
2023-04-16 09:08:02 testing...
The generated pressure mean: 0.4215983748435974
loss_pred:0.032688550651073456, decouple_loss:0.00520110409706831
The generated pressure mean: 0.43014994263648987
loss_pred:0.031554706394672394, decouple_loss:0.005313892383128405
The generated pressure mean: 0.4343317151069641
loss_pred:0.03186827525496483, decouple_loss:0.005570150446146727
Loss: 0.032305262982845306, avg_mse: 0.04604364559054375
current test mse: 0.046044
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012016_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012016_3_24hr.npz
NaN value num: 0
Iteration: 2001, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44120150804519653
loss_pred:0.02090844325721264, decouple_loss:0.004654215183109045
The generated pressure mean: 0.4418412744998932
loss_pred:0.02152169682085514, decouple_loss:0.00453118234872818
The generated pressure mean: 0.4402686357498169
loss_pred:0.0224714707583189, decouple_loss:0.004194555804133415
Iteration: 2002, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44708845019340515
loss_pred:0.024719174951314926, decouple_loss:0.004617840051651001
The generated pressure mean: 0.44781389832496643
loss_pred:0.02199702523648739, decouple_loss:0.004749417304992676
The generated pressure mean: 0.45019569993019104
loss_pred:0.020498283207416534, decouple_loss:0.004819490015506744
Iteration: 2003, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4396447539329529
loss_pred:0.0213125329464674, decouple_loss:0.00609783036634326
The generated pressure mean: 0.4363110065460205
loss_pred:0.020762387663125992, decouple_loss:0.006597735453397036
The generated pressure mean: 0.4353155195713043
loss_pred:0.021429849788546562, decouple_loss:0.006519383285194635
Iteration: 2004, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4498935341835022
loss_pred:0.019742898643016815, decouple_loss:0.0053148516453802586
The generated pressure mean: 0.4553864598274231
loss_pred:0.01958402432501316, decouple_loss:0.0050972080789506435
The generated pressure mean: 0.4566197991371155
loss_pred:0.021728405728936195, decouple_loss:0.00530990120023489
Iteration: 2005, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45670270919799805
loss_pred:0.021289372816681862, decouple_loss:0.00583270937204361
The generated pressure mean: 0.46059030294418335
loss_pred:0.02189095877110958, decouple_loss:0.005731823388487101
The generated pressure mean: 0.460469126701355
loss_pred:0.021008837968111038, decouple_loss:0.005570066627115011
Iteration: 2006, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4439229369163513
loss_pred:0.021286308765411377, decouple_loss:0.005463598761707544
The generated pressure mean: 0.4407828152179718
loss_pred:0.021535994485020638, decouple_loss:0.005635461304336786
The generated pressure mean: 0.437376469373703
loss_pred:0.021741580218076706, decouple_loss:0.005205345340073109
Iteration: 2007, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4406659007072449
loss_pred:0.02241353690624237, decouple_loss:0.005409304052591324
The generated pressure mean: 0.43977001309394836
loss_pred:0.021051639690995216, decouple_loss:0.005255063995718956
The generated pressure mean: 0.4447293281555176
loss_pred:0.021026121452450752, decouple_loss:0.005490954499691725
Iteration: 2008, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4495405852794647
loss_pred:0.019046295434236526, decouple_loss:0.00568179739639163
The generated pressure mean: 0.4496545195579529
loss_pred:0.021037183701992035, decouple_loss:0.005862930789589882
The generated pressure mean: 0.44961369037628174
loss_pred:0.020474817603826523, decouple_loss:0.006111424881964922
Iteration: 2009, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4514637291431427
loss_pred:0.022891808301210403, decouple_loss:0.006053769029676914
The generated pressure mean: 0.45012524724006653
loss_pred:0.02096017636358738, decouple_loss:0.0061370329931378365
The generated pressure mean: 0.4471489191055298
loss_pred:0.02157561294734478, decouple_loss:0.006218103226274252
Iteration: 2010, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4422387480735779
loss_pred:0.020993733778595924, decouple_loss:0.005634994246065617
The generated pressure mean: 0.4464617073535919
loss_pred:0.020524896681308746, decouple_loss:0.005802909377962351
The generated pressure mean: 0.43911537528038025
loss_pred:0.020612165331840515, decouple_loss:0.005873257759958506
2023-04-16 09:10:40 testing...
The generated pressure mean: 0.4203606843948364
loss_pred:0.03352345898747444, decouple_loss:0.005820988677442074
The generated pressure mean: 0.42952287197113037
loss_pred:0.032151877880096436, decouple_loss:0.005803215783089399
The generated pressure mean: 0.4335070848464966
loss_pred:0.032518718391656876, decouple_loss:0.006037425249814987
Loss: 0.03302571177482605, avg_mse: 0.04704611748456955
current test mse: 0.047046
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 2011, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4476514756679535
loss_pred:0.02069229446351528, decouple_loss:0.005513979122042656
The generated pressure mean: 0.4511311948299408
loss_pred:0.02130313590168953, decouple_loss:0.005352577660232782
The generated pressure mean: 0.4481242895126343
loss_pred:0.02037903293967247, decouple_loss:0.0055520860478281975
Iteration: 2012, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4459471106529236The generated pressure mean: 0.45097970962524414
loss_pred:0.021807901561260223, decouple_loss:0.005489879287779331
loss_pred:0.02091187797486782, decouple_loss:0.005605550482869148
The generated pressure mean: 0.44508394598960876
loss_pred:0.02113635279238224, decouple_loss:0.005878367926925421
Iteration: 2013, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45194777846336365
loss_pred:0.02181759476661682, decouple_loss:0.006013453006744385
The generated pressure mean: 0.44779470562934875
loss_pred:0.02122393436729908, decouple_loss:0.0062287370674312115
The generated pressure mean: 0.44801953434944153
loss_pred:0.02176663652062416, decouple_loss:0.006176588125526905
Iteration: 2014, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4414764940738678
loss_pred:0.021622493863105774, decouple_loss:0.004926080349832773
The generated pressure mean: 0.4399470388889313
loss_pred:0.02125561609864235, decouple_loss:0.005103444214910269
The generated pressure mean: 0.44315728545188904
loss_pred:0.020386086776852608, decouple_loss:0.004768681712448597
Iteration: 2015, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4464668929576874
The generated pressure mean: 0.4424598217010498
loss_pred:0.020189715549349785, decouple_loss:0.005649675615131855
loss_pred:0.019678136333823204, decouple_loss:0.005720594897866249
The generated pressure mean: 0.4456495940685272
loss_pred:0.02128218300640583, decouple_loss:0.005653962027281523
Iteration: 2016, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45194676518440247
loss_pred:0.021858425810933113, decouple_loss:0.005711568519473076
The generated pressure mean: 0.45259809494018555
loss_pred:0.021585941314697266, decouple_loss:0.005568687338382006
The generated pressure mean: 0.44890350103378296
loss_pred:0.020978564396500587, decouple_loss:0.005683142691850662
Iteration: 2017, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45215028524398804
loss_pred:0.020634688436985016, decouple_loss:0.005312972702085972
The generated pressure mean: 0.44966641068458557
loss_pred:0.02070549875497818, decouple_loss:0.004967429209500551
The generated pressure mean: 0.4484594762325287
loss_pred:0.020715510472655296, decouple_loss:0.005174714606255293
Iteration: 2018, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4385451376438141
loss_pred:0.020122652873396873, decouple_loss:0.005318521987646818
The generated pressure mean: 0.4378202259540558
loss_pred:0.01972922496497631, decouple_loss:0.005376677494496107
The generated pressure mean: 0.4423847794532776
loss_pred:0.02026771381497383, decouple_loss:0.005566302686929703
Iteration: 2019, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44658973813056946
loss_pred:0.021464349702000618, decouple_loss:0.006455941125750542
The generated pressure mean: 0.448823481798172
loss_pred:0.02144346572458744, decouple_loss:0.00611432921141386
The generated pressure mean: 0.4446202516555786
loss_pred:0.020413991063833237, decouple_loss:0.006047296803444624
Iteration: 2020, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45257359743118286
loss_pred:0.0215959120541811, decouple_loss:0.005107345059514046
The generated pressure mean: 0.45184850692749023
loss_pred:0.0206630639731884, decouple_loss:0.0048823729157447815
The generated pressure mean: 0.4570322036743164
loss_pred:0.021444080397486687, decouple_loss:0.004823588766157627
2023-04-16 09:12:41 testing...
The generated pressure mean: 0.4210171699523926
loss_pred:0.03261696919798851, decouple_loss:0.006639609578996897
The generated pressure mean: 0.4302055239677429
loss_pred:0.031268857419490814, decouple_loss:0.006875815335661173
The generated pressure mean: 0.4339944124221802
loss_pred:0.03142618015408516, decouple_loss:0.00698858080431819
Loss: 0.03211240470409393, avg_mse: 0.04569801315665245
current test mse: 0.045698
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012002_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012002_3_24hr.npz
NaN value num: 0
Iteration: 2021, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4333045482635498
loss_pred:0.020252704620361328, decouple_loss:0.006783021613955498
The generated pressure mean: 0.43710091710090637
loss_pred:0.020649295300245285, decouple_loss:0.0062016891315579414
The generated pressure mean: 0.43577995896339417
loss_pred:0.02107580006122589, decouple_loss:0.0061824508011341095
Iteration: 2022, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.446951687335968
loss_pred:0.019498083740472794, decouple_loss:0.00519176758825779
The generated pressure mean: 0.4424996078014374
loss_pred:0.02056451328098774, decouple_loss:0.005285453051328659
The generated pressure mean: 0.44408389925956726
loss_pred:0.020186735317111015, decouple_loss:0.005421697162091732
Iteration: 2023, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4593099057674408
loss_pred:0.019532857462763786, decouple_loss:0.0060905572026968
The generated pressure mean: 0.4573642909526825
loss_pred:0.020439645275473595, decouple_loss:0.005991035141050816
The generated pressure mean: 0.4646542966365814
loss_pred:0.018888400867581367, decouple_loss:0.00570375332608819
Iteration: 2024, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45152992010116577
loss_pred:0.0198235921561718, decouple_loss:0.005486589390784502
The generated pressure mean: 0.45648670196533203
loss_pred:0.02087886445224285, decouple_loss:0.005685729905962944
The generated pressure mean: 0.45104414224624634
loss_pred:0.020026087760925293, decouple_loss:0.005744165275245905
Iteration: 2025, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4205981194972992
loss_pred:0.02042868174612522, decouple_loss:0.006374862976372242
The generated pressure mean: 0.42323434352874756
loss_pred:0.019653640687465668, decouple_loss:0.006514372769743204
The generated pressure mean: 0.4287864565849304
loss_pred:0.02086021564900875, decouple_loss:0.00644637132063508
Iteration: 2026, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44759392738342285
loss_pred:0.020934710279107094, decouple_loss:0.005303658545017242
The generated pressure mean: 0.448261022567749
loss_pred:0.02030946873128414, decouple_loss:0.005363927222788334
The generated pressure mean: 0.4472616910934448
loss_pred:0.019928453490138054, decouple_loss:0.005358145572245121
Iteration: 2027, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45485538244247437
loss_pred:0.01851525902748108, decouple_loss:0.00600635027512908
The generated pressure mean: 0.4560197591781616
loss_pred:0.01992683671414852, decouple_loss:0.006402468774467707
The generated pressure mean: 0.4561052918434143
loss_pred:0.01916981302201748, decouple_loss:0.00622243108227849
Iteration: 2028, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4473949372768402
loss_pred:0.0194229893386364, decouple_loss:0.006915607023984194
The generated pressure mean: 0.4481462836265564
loss_pred:0.021148337051272392, decouple_loss:0.006848411168903112
The generated pressure mean: 0.44792118668556213
loss_pred:0.01970956102013588, decouple_loss:0.006942213047295809
Iteration: 2029, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4434656798839569
loss_pred:0.019516875967383385, decouple_loss:0.005425944924354553
The generated pressure mean: 0.437294065952301
loss_pred:0.020828302949666977, decouple_loss:0.005748366471379995
The generated pressure mean: 0.4360375702381134
loss_pred:0.02130797691643238, decouple_loss:0.005570726003497839
Iteration: 2030, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.446411669254303
loss_pred:0.019829826429486275, decouple_loss:0.005767086520791054
The generated pressure mean: 0.45049524307250977
loss_pred:0.01827627420425415, decouple_loss:0.005973537918180227
The generated pressure mean: 0.44459447264671326
loss_pred:0.020728131756186485, decouple_loss:0.005750790238380432
2023-04-16 09:15:29 testing...
The generated pressure mean: 0.4157150685787201
loss_pred:0.033494964241981506, decouple_loss:0.006667708978056908
The generated pressure mean: 0.42279356718063354
loss_pred:0.032537445425987244, decouple_loss:0.006738137919455767
The generated pressure mean: 0.4255453944206238
loss_pred:0.03277992829680443, decouple_loss:0.007036014925688505
Loss: 0.033278144896030426, avg_mse: 0.047718796879053116
current test mse: 0.047719
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 2031, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45772895216941833
loss_pred:0.020071309059858322, decouple_loss:0.006414557807147503
The generated pressure mean: 0.45178908109664917
loss_pred:0.02114950679242611, decouple_loss:0.006095023825764656
The generated pressure mean: 0.4484596848487854
loss_pred:0.02068166621029377, decouple_loss:0.0063827307894825935
Iteration: 2032, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4395802617073059
loss_pred:0.020887207239866257, decouple_loss:0.005003518890589476
The generated pressure mean: 0.44211700558662415
The generated pressure mean: 0.44024819135665894
loss_pred:0.019592560827732086, decouple_loss:0.004871982149779797
loss_pred:0.018577035516500473, decouple_loss:0.004957900382578373
Iteration: 2033, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43866029381752014
loss_pred:0.0197917390614748, decouple_loss:0.005538292229175568
The generated pressure mean: 0.4390096962451935
loss_pred:0.020471565425395966, decouple_loss:0.005689775571227074
The generated pressure mean: 0.44078201055526733
loss_pred:0.020340630784630775, decouple_loss:0.005832672584801912
Iteration: 2034, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46161869168281555
loss_pred:0.020659124478697777, decouple_loss:0.005366784520447254
The generated pressure mean: 0.4603860080242157
loss_pred:0.01965356431901455, decouple_loss:0.005530369933694601
The generated pressure mean: 0.4633042514324188
loss_pred:0.019084719941020012, decouple_loss:0.0056667327880859375
Iteration: 2035, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44602063298225403
loss_pred:0.020863186568021774, decouple_loss:0.005437958519905806
The generated pressure mean: 0.4480798542499542
loss_pred:0.02007090300321579, decouple_loss:0.005293790251016617
The generated pressure mean: 0.44654637575149536
loss_pred:0.020931929349899292, decouple_loss:0.005485691595822573
Iteration: 2036, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4350762665271759The generated pressure mean: 0.43274807929992676
loss_pred:0.019447017461061478, decouple_loss:0.005552051588892937
loss_pred:0.019453665241599083, decouple_loss:0.005555703770369291
The generated pressure mean: 0.4352686405181885
loss_pred:0.020440682768821716, decouple_loss:0.005723096430301666
Iteration: 2037, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4474143981933594
loss_pred:0.020381107926368713, decouple_loss:0.005337972193956375
The generated pressure mean: 0.4441622197628021
loss_pred:0.01998050883412361, decouple_loss:0.005111559294164181
The generated pressure mean: 0.4475323557853699
loss_pred:0.022295789793133736, decouple_loss:0.0052704173140227795
Iteration: 2038, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4507915675640106
loss_pred:0.020385876297950745, decouple_loss:0.00559696089476347
The generated pressure mean: 0.4467942416667938
loss_pred:0.02042476274073124, decouple_loss:0.005850999150425196
The generated pressure mean: 0.4490075707435608
loss_pred:0.018756458535790443, decouple_loss:0.005655613262206316
Iteration: 2039, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4458882212638855
loss_pred:0.02024521492421627, decouple_loss:0.005466061644256115
The generated pressure mean: 0.44256243109703064
loss_pred:0.019406558945775032, decouple_loss:0.005241279024630785
The generated pressure mean: 0.4409933388233185
loss_pred:0.020087718963623047, decouple_loss:0.005520105827599764
Iteration: 2040, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45326748490333557
loss_pred:0.020327193662524223, decouple_loss:0.005403908900916576
The generated pressure mean: 0.4515201151371002
loss_pred:0.020213713869452477, decouple_loss:0.0054130880162119865
The generated pressure mean: 0.45059555768966675
loss_pred:0.022004907950758934, decouple_loss:0.005261575803160667
2023-04-16 09:17:29 testing...
The generated pressure mean: 0.41805538535118103
loss_pred:0.03290655463933945, decouple_loss:0.005587280727922916
The generated pressure mean: 0.4259305000305176
loss_pred:0.031205996870994568, decouple_loss:0.005632641259580851
The generated pressure mean: 0.4294247031211853
loss_pred:0.03157566487789154, decouple_loss:0.0058777728118002415
Loss: 0.0321810357272625, avg_mse: 0.04644600301980972
current test mse: 0.046446
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012004_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012004_3_24hr.npz
NaN value num: 0
Iteration: 2041, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4438972771167755
loss_pred:0.018972013145685196, decouple_loss:0.005132920574396849
The generated pressure mean: 0.4505649209022522
loss_pred:0.019021878018975258, decouple_loss:0.005195973441004753
The generated pressure mean: 0.4471482038497925
loss_pred:0.02244775928556919, decouple_loss:0.005190480034798384
Iteration: 2042, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.440931111574173
The generated pressure mean: 0.4407394528388977
loss_pred:0.01975376158952713, decouple_loss:0.0051684146746993065
loss_pred:0.020013993605971336, decouple_loss:0.005262873601168394
The generated pressure mean: 0.4414709806442261
loss_pred:0.02108277939260006, decouple_loss:0.0052341194823384285
Iteration: 2043, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44947031140327454
loss_pred:0.019261708483099937, decouple_loss:0.005562193226069212
The generated pressure mean: 0.4520573616027832
loss_pred:0.0200024601072073, decouple_loss:0.0050364211201667786
The generated pressure mean: 0.44701242446899414
loss_pred:0.019079266116023064, decouple_loss:0.005191009026020765
Iteration: 2044, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45694273710250854
loss_pred:0.020408540964126587, decouple_loss:0.005018472671508789
The generated pressure mean: 0.4560888707637787
loss_pred:0.019548118114471436, decouple_loss:0.005214422941207886
The generated pressure mean: 0.45755288004875183
loss_pred:0.02110779471695423, decouple_loss:0.005215817596763372
Iteration: 2045, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43134605884552
loss_pred:0.020562417805194855, decouple_loss:0.005436387844383717
The generated pressure mean: 0.4314202070236206
loss_pred:0.01986696384847164, decouple_loss:0.005588117986917496
The generated pressure mean: 0.4303869605064392
loss_pred:0.021972257643938065, decouple_loss:0.00554713886231184
Iteration: 2046, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4505464434623718
loss_pred:0.020393718034029007, decouple_loss:0.0052014864049851894
The generated pressure mean: 0.45495158433914185
loss_pred:0.021138682961463928, decouple_loss:0.005123414099216461
The generated pressure mean: 0.45569494366645813
loss_pred:0.020200546830892563, decouple_loss:0.004862734582275152
Iteration: 2047, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45363354682922363
loss_pred:0.020976293832063675, decouple_loss:0.006134484428912401
The generated pressure mean: 0.45291149616241455
loss_pred:0.020601633936166763, decouple_loss:0.0060663907788693905
The generated pressure mean: 0.45152249932289124
loss_pred:0.022251572459936142, decouple_loss:0.006164871621876955
Iteration: 2048, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.440001904964447
loss_pred:0.019918764010071754, decouple_loss:0.004756614565849304
The generated pressure mean: 0.43996661901474
loss_pred:0.019404148682951927, decouple_loss:0.004677321761846542
The generated pressure mean: 0.43806469440460205
loss_pred:0.020301396027207375, decouple_loss:0.004832889884710312
Iteration: 2049, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44004565477371216
loss_pred:0.020003581419587135, decouple_loss:0.004796212539076805
The generated pressure mean: 0.4403315484523773
loss_pred:0.02077573537826538, decouple_loss:0.004576732404530048
The generated pressure mean: 0.4379940330982208
loss_pred:0.01998155564069748, decouple_loss:0.004645077977329493
Iteration: 2050, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4558750092983246
loss_pred:0.02025851421058178, decouple_loss:0.0065828547812998295
The generated pressure mean: 0.4512467384338379
loss_pred:0.01960783638060093, decouple_loss:0.006422922946512699
The generated pressure mean: 0.4532841444015503
loss_pred:0.019642243161797523, decouple_loss:0.0064584338106215
2023-04-16 09:20:06 testing...
The generated pressure mean: 0.41548457741737366
loss_pred:0.035857927054166794, decouple_loss:0.006608074996620417
The generated pressure mean: 0.42334648966789246
loss_pred:0.035338714718818665, decouple_loss:0.0067009651102125645
The generated pressure mean: 0.4278925657272339
loss_pred:0.034645676612854004, decouple_loss:0.006780614610761404
Loss: 0.03561560437083244, avg_mse: 0.050544220954179764
current test mse: 0.050544
Iteration: 2051, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46357259154319763
The generated pressure mean: 0.46238747239112854
loss_pred:0.019720492884516716, decouple_loss:0.006005484610795975
loss_pred:0.02079656720161438, decouple_loss:0.006035401485860348
The generated pressure mean: 0.45641016960144043
loss_pred:0.020123016089200974, decouple_loss:0.005839812569320202
Iteration: 2052, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43755239248275757
loss_pred:0.020227910950779915, decouple_loss:0.0052055250853300095
The generated pressure mean: 0.435901015996933
loss_pred:0.019617300480604172, decouple_loss:0.004921982530504465
The generated pressure mean: 0.4372701644897461
loss_pred:0.020139610394835472, decouple_loss:0.0049192518927156925
Iteration: 2053, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44096454977989197
loss_pred:0.02056095376610756, decouple_loss:0.004329337272793055
The generated pressure mean: 0.4388667941093445
loss_pred:0.019825933501124382, decouple_loss:0.004473034758120775
The generated pressure mean: 0.43878304958343506
loss_pred:0.020061256363987923, decouple_loss:0.004353324417024851
Iteration: 2054, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4519409239292145
loss_pred:0.021247589960694313, decouple_loss:0.005293725524097681
The generated pressure mean: 0.4533717632293701
loss_pred:0.019917281344532967, decouple_loss:0.005317120347172022
The generated pressure mean: 0.4520528018474579
loss_pred:0.020281368866562843, decouple_loss:0.0051867300644516945
Iteration: 2055, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45504361391067505
loss_pred:0.020382612943649292, decouple_loss:0.005059356801211834
The generated pressure mean: 0.4592130482196808
loss_pred:0.019498510286211967, decouple_loss:0.004913107492029667
The generated pressure mean: 0.45687171816825867
loss_pred:0.020106717944145203, decouple_loss:0.00482229795306921
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 2056, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43812915682792664
loss_pred:0.022235587239265442, decouple_loss:0.005375751759856939
The generated pressure mean: 0.43666109442710876
loss_pred:0.02118663303554058, decouple_loss:0.005698745604604483
The generated pressure mean: 0.43756330013275146
loss_pred:0.019629666581749916, decouple_loss:0.005286314059048891
Iteration: 2057, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43020761013031006
loss_pred:0.02013525180518627, decouple_loss:0.005278646945953369
The generated pressure mean: 0.4292268455028534
loss_pred:0.0216761976480484, decouple_loss:0.005558101460337639
The generated pressure mean: 0.4222378730773926
loss_pred:0.020337482914328575, decouple_loss:0.005428620148450136
Iteration: 2058, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46051254868507385
loss_pred:0.020367102697491646, decouple_loss:0.005528958514332771
The generated pressure mean: 0.46293649077415466
loss_pred:0.019449299201369286, decouple_loss:0.005533264018595219
The generated pressure mean: 0.46020588278770447
loss_pred:0.020799513906240463, decouple_loss:0.005408138036727905
Iteration: 2059, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4659605920314789
The generated pressure mean: 0.46498018503189087loss_pred:0.021032527089118958, decouple_loss:0.005648428108543158
loss_pred:0.01958286203444004, decouple_loss:0.005740873981267214
The generated pressure mean: 0.46308133006095886
loss_pred:0.01960536278784275, decouple_loss:0.005875180941075087
Iteration: 2060, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.435733824968338
loss_pred:0.020279571413993835, decouple_loss:0.005792555399239063
The generated pressure mean: 0.4402855932712555
loss_pred:0.020314563065767288, decouple_loss:0.005640402436256409
The generated pressure mean: 0.43348488211631775
loss_pred:0.020670413970947266, decouple_loss:0.005592485424131155
2023-04-16 09:22:07 testing...
The generated pressure mean: 0.4218651056289673
loss_pred:0.035197604447603226, decouple_loss:0.006747998297214508
The generated pressure mean: 0.4307224452495575
loss_pred:0.03392024338245392, decouple_loss:0.006773375440388918
The generated pressure mean: 0.4342551529407501
loss_pred:0.033533863723278046, decouple_loss:0.0069436789490282536
Loss: 0.03455832228064537, avg_mse: 0.05046357586979866
current test mse: 0.050464
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012003_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012003_3_24hr.npz
NaN value num: 0
Iteration: 2061, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4340789318084717
loss_pred:0.019827991724014282, decouple_loss:0.006813345942646265
The generated pressure mean: 0.4372321367263794
loss_pred:0.019276414066553116, decouple_loss:0.006685120984911919
The generated pressure mean: 0.43292468786239624
loss_pred:0.01997329108417034, decouple_loss:0.006549217272549868
Iteration: 2062, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4500684440135956
loss_pred:0.019132519140839577, decouple_loss:0.0056524998508393764
The generated pressure mean: 0.44986534118652344
loss_pred:0.020546147599816322, decouple_loss:0.005583090707659721
The generated pressure mean: 0.44130992889404297
loss_pred:0.019337689504027367, decouple_loss:0.005240360274910927
Iteration: 2063, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45943358540534973
loss_pred:0.019922548905014992, decouple_loss:0.006066878791898489
The generated pressure mean: 0.4598011076450348
loss_pred:0.02021767757833004, decouple_loss:0.006304251030087471
The generated pressure mean: 0.46069392561912537
loss_pred:0.020313430577516556, decouple_loss:0.006189150735735893
Iteration: 2064, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45281916856765747
The generated pressure mean: 0.4527261555194855
loss_pred:0.018937915563583374, decouple_loss:0.005470941308885813
loss_pred:0.019779207184910774, decouple_loss:0.005313533823937178
The generated pressure mean: 0.4423532485961914
loss_pred:0.019940024241805077, decouple_loss:0.005596774630248547
Iteration: 2065, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4356675446033478
loss_pred:0.02015448920428753, decouple_loss:0.004883283283561468
The generated pressure mean: 0.43514731526374817
loss_pred:0.020036712288856506, decouple_loss:0.00487105967476964
The generated pressure mean: 0.4319904148578644
loss_pred:0.018880657851696014, decouple_loss:0.004964842461049557
Iteration: 2066, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4516400098800659
loss_pred:0.019200347363948822, decouple_loss:0.0048606074415147305
The generated pressure mean: 0.4490612745285034
loss_pred:0.019546017050743103, decouple_loss:0.004786238074302673
The generated pressure mean: 0.45243820548057556
loss_pred:0.023585563525557518, decouple_loss:0.0048135630786418915
Iteration: 2067, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4494350552558899
loss_pred:0.020394131541252136, decouple_loss:0.004639218095690012
The generated pressure mean: 0.45103856921195984
loss_pred:0.019588636234402657, decouple_loss:0.004915011581033468
The generated pressure mean: 0.45073071122169495
loss_pred:0.019796302542090416, decouple_loss:0.004682937171310186
Iteration: 2068, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44977957010269165
loss_pred:0.01934143528342247, decouple_loss:0.004905456677079201
The generated pressure mean: 0.451546311378479
loss_pred:0.019424760714173317, decouple_loss:0.004845163784921169
The generated pressure mean: 0.4489521086215973
loss_pred:0.02000093087553978, decouple_loss:0.0050193509086966515
Iteration: 2069, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4409967064857483
loss_pred:0.020997436717152596, decouple_loss:0.004742367658764124
The generated pressure mean: 0.4423414170742035
loss_pred:0.02068782038986683, decouple_loss:0.004768013022840023
The generated pressure mean: 0.44326719641685486
loss_pred:0.019806548953056335, decouple_loss:0.004826701711863279
Iteration: 2070, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4411728084087372
loss_pred:0.020553063601255417, decouple_loss:0.0052841403521597385
The generated pressure mean: 0.4434295892715454
loss_pred:0.018667111173272133, decouple_loss:0.00527604715898633
The generated pressure mean: 0.44864293932914734
loss_pred:0.02064112015068531, decouple_loss:0.005028971470892429
2023-04-16 09:24:51 testing...
The generated pressure mean: 0.4176834523677826
loss_pred:0.03374498337507248, decouple_loss:0.006202333606779575
The generated pressure mean: 0.42586153745651245
loss_pred:0.03246818110346794, decouple_loss:0.006264044903218746
The generated pressure mean: 0.4292113482952118
loss_pred:0.03259417414665222, decouple_loss:0.006379889324307442
Loss: 0.033249884843826294, avg_mse: 0.048037152737379074
current test mse: 0.048037
Iteration: 2071, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4527522623538971
loss_pred:0.020402614027261734, decouple_loss:0.005917869973927736
The generated pressure mean: 0.4524666965007782
loss_pred:0.01931910030543804, decouple_loss:0.0059846569783985615
The generated pressure mean: 0.45078301429748535
loss_pred:0.018951237201690674, decouple_loss:0.005963876843452454
Iteration: 2072, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4525768756866455
loss_pred:0.019321424886584282, decouple_loss:0.00524152023717761
The generated pressure mean: 0.45377659797668457
loss_pred:0.019324498251080513, decouple_loss:0.005243941675871611
The generated pressure mean: 0.4545128345489502
loss_pred:0.021027082577347755, decouple_loss:0.005237228237092495
Iteration: 2073, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4409189224243164
loss_pred:0.019573217257857323, decouple_loss:0.004705843050032854
The generated pressure mean: 0.44563230872154236
loss_pred:0.0184035524725914, decouple_loss:0.0044907378032803535
The generated pressure mean: 0.4434836804866791
loss_pred:0.019910605624318123, decouple_loss:0.004646815825253725
Iteration: 2074, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43962547183036804
loss_pred:0.01908082328736782, decouple_loss:0.00461969617754221
The generated pressure mean: 0.4397414028644562
loss_pred:0.0205068401992321, decouple_loss:0.004727588966488838
The generated pressure mean: 0.43520626425743103
loss_pred:0.021619334816932678, decouple_loss:0.0045389048755168915
Iteration: 2075, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45682215690612793
loss_pred:0.019741961732506752, decouple_loss:0.004569152370095253
The generated pressure mean: 0.4586818814277649
loss_pred:0.01962907239794731, decouple_loss:0.004524429328739643
The generated pressure mean: 0.4583567976951599
loss_pred:0.02173565700650215, decouple_loss:0.004288386553525925
Iteration: 2076, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43472805619239807The generated pressure mean: 0.43601351976394653
loss_pred:0.019664771854877472, decouple_loss:0.004833708051592112
loss_pred:0.01898917369544506, decouple_loss:0.004678111057728529
The generated pressure mean: 0.44224414229393005
loss_pred:0.02037043310701847, decouple_loss:0.0047258841805160046
Iteration: 2077, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45521071553230286
loss_pred:0.01972339302301407, decouple_loss:0.004702335689216852
The generated pressure mean: 0.44690367579460144
loss_pred:0.019501563161611557, decouple_loss:0.00458794878795743
The generated pressure mean: 0.4486418664455414
loss_pred:0.02023187279701233, decouple_loss:0.004331408999860287
Iteration: 2078, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45993003249168396
loss_pred:0.021586596965789795, decouple_loss:0.005685910116881132
The generated pressure mean: 0.45722413063049316
loss_pred:0.01896575838327408, decouple_loss:0.005803308449685574
The generated pressure mean: 0.456458181142807
loss_pred:0.018541235476732254, decouple_loss:0.005724816583096981
Iteration: 2079, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4439886510372162
loss_pred:0.020673882216215134, decouple_loss:0.005903184413909912
The generated pressure mean: 0.4471442997455597
loss_pred:0.020931005477905273, decouple_loss:0.006022948306053877
The generated pressure mean: 0.44677403569221497
loss_pred:0.020195219665765762, decouple_loss:0.006203026045113802
Iteration: 2080, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4391075074672699
loss_pred:0.019603181630373, decouple_loss:0.004716313909739256
The generated pressure mean: 0.44239023327827454
loss_pred:0.019230009987950325, decouple_loss:0.00507743377238512
The generated pressure mean: 0.440946489572525
loss_pred:0.01947254315018654, decouple_loss:0.004574579652398825
2023-04-16 09:26:51 testing...
The generated pressure mean: 0.41915658116340637
loss_pred:0.03369971737265587, decouple_loss:0.006065030582249165
The generated pressure mean: 0.4267851710319519
loss_pred:0.03303929418325424, decouple_loss:0.006224656943231821
The generated pressure mean: 0.43052247166633606
loss_pred:0.033857475966215134, decouple_loss:0.00633601937443018
Loss: 0.03384259343147278, avg_mse: 0.04839024692773819
current test mse: 0.04839
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012008_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012008_3_24hr.npz
NaN value num: 0
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 2081, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4446583688259125
loss_pred:0.020306695252656937, decouple_loss:0.005853440146893263
The generated pressure mean: 0.4456459879875183
loss_pred:0.021421700716018677, decouple_loss:0.0058539011515676975
The generated pressure mean: 0.4471215307712555
loss_pred:0.019783657044172287, decouple_loss:0.005736358463764191
Iteration: 2082, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45242491364479065
loss_pred:0.019796578213572502, decouple_loss:0.0061575789004564285
The generated pressure mean: 0.449582040309906
loss_pred:0.02285652980208397, decouple_loss:0.0062212953343987465
The generated pressure mean: 0.45419302582740784
loss_pred:0.02170621044933796, decouple_loss:0.006123832426965237
Iteration: 2083, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.42782801389694214
loss_pred:0.020507266744971275, decouple_loss:0.005785507615655661
The generated pressure mean: 0.4326351284980774
loss_pred:0.02158379927277565, decouple_loss:0.005758130457252264
The generated pressure mean: 0.43145087361335754
loss_pred:0.01951986365020275, decouple_loss:0.0058509414084255695
Iteration: 2084, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45867830514907837
loss_pred:0.021902581676840782, decouple_loss:0.005485272500663996
The generated pressure mean: 0.45196107029914856
loss_pred:0.0206607673317194, decouple_loss:0.005465173628181219
The generated pressure mean: 0.4509631395339966
loss_pred:0.020087316632270813, decouple_loss:0.005241125822067261
Iteration: 2085, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44439205527305603
loss_pred:0.02120205946266651, decouple_loss:0.005190400872379541
The generated pressure mean: 0.45033887028694153
loss_pred:0.019691292196512222, decouple_loss:0.005062558222562075
The generated pressure mean: 0.45024824142456055
loss_pred:0.02128109708428383, decouple_loss:0.004991710186004639
Iteration: 2086, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44597724080085754
loss_pred:0.02097187750041485, decouple_loss:0.004228419158607721
The generated pressure mean: 0.44665107131004333
loss_pred:0.020843617618083954, decouple_loss:0.004115751478821039
The generated pressure mean: 0.44567105174064636
loss_pred:0.02091064676642418, decouple_loss:0.004460886120796204
Iteration: 2087, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4472815692424774
loss_pred:0.01922048069536686, decouple_loss:0.006021882873028517
The generated pressure mean: 0.4482705891132355
loss_pred:0.019303880631923676, decouple_loss:0.005917734000831842
The generated pressure mean: 0.4515896141529083
loss_pred:0.019589848816394806, decouple_loss:0.005568238906562328
Iteration: 2088, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4431920051574707
loss_pred:0.020555347204208374, decouple_loss:0.0052675120532512665
The generated pressure mean: 0.43911001086235046
loss_pred:0.020613782107830048, decouple_loss:0.005354075692594051
The generated pressure mean: 0.4427172839641571
loss_pred:0.020182045176625252, decouple_loss:0.00537697272375226
Iteration: 2089, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44331660866737366
loss_pred:0.021014565601944923, decouple_loss:0.005535443779081106
The generated pressure mean: 0.4425230920314789
loss_pred:0.019955500960350037, decouple_loss:0.005667002871632576
The generated pressure mean: 0.4451681971549988
loss_pred:0.019007431343197823, decouple_loss:0.0055601405911147594
Iteration: 2090, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4522365927696228
loss_pred:0.019834840670228004, decouple_loss:0.005110079888254404
The generated pressure mean: 0.447226345539093
loss_pred:0.020010901615023613, decouple_loss:0.005205467343330383
The generated pressure mean: 0.44718727469444275
loss_pred:0.020229095593094826, decouple_loss:0.004975789226591587
2023-04-16 09:29:26 testing...
The generated pressure mean: 0.4197213053703308
loss_pred:0.03326266631484032, decouple_loss:0.005077966023236513
The generated pressure mean: 0.4296582341194153
loss_pred:0.03280577436089516, decouple_loss:0.0051660481840372086
The generated pressure mean: 0.433297723531723
loss_pred:0.03270697593688965, decouple_loss:0.0055603343062102795
Loss: 0.03318854793906212, avg_mse: 0.04786831885576248
current test mse: 0.047868
Iteration: 2091, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4424353241920471
The generated pressure mean: 0.4435328543186188
loss_pred:0.020531874150037766, decouple_loss:0.0045190127566456795
loss_pred:0.019607597962021828, decouple_loss:0.005072133615612984
The generated pressure mean: 0.4442675709724426
loss_pred:0.021271824836730957, decouple_loss:0.004814777988940477
Iteration: 2092, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4426470994949341
The generated pressure mean: 0.44373035430908203
loss_pred:0.01997130736708641, decouple_loss:0.005143907852470875
loss_pred:0.020728815346956253, decouple_loss:0.005249281879514456
The generated pressure mean: 0.4378643035888672
loss_pred:0.019891083240509033, decouple_loss:0.004800166469067335
Iteration: 2093, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4554591178894043
loss_pred:0.019853048026561737, decouple_loss:0.003933525178581476
The generated pressure mean: 0.4519033432006836
loss_pred:0.0187425147742033, decouple_loss:0.004363053012639284
The generated pressure mean: 0.44908618927001953
loss_pred:0.019595932215452194, decouple_loss:0.004120248835533857
Iteration: 2094, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4529207944869995
loss_pred:0.019982144236564636, decouple_loss:0.004902340471744537
The generated pressure mean: 0.44867008924484253
loss_pred:0.020131830126047134, decouple_loss:0.004875967279076576
The generated pressure mean: 0.4522266983985901
loss_pred:0.019793357700109482, decouple_loss:0.004968082066625357
Iteration: 2095, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4422129690647125
loss_pred:0.018990453332662582, decouple_loss:0.004613484721630812
The generated pressure mean: 0.4349871277809143
loss_pred:0.020729385316371918, decouple_loss:0.004646982531994581
The generated pressure mean: 0.4319591224193573
loss_pred:0.019631845876574516, decouple_loss:0.004641607403755188
Iteration: 2096, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4348670244216919
loss_pred:0.019924277439713478, decouple_loss:0.005255386233329773
The generated pressure mean: 0.4310356080532074
loss_pred:0.02008291333913803, decouple_loss:0.005479699466377497
The generated pressure mean: 0.43642356991767883
loss_pred:0.019786765798926353, decouple_loss:0.005194454453885555
Iteration: 2097, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4507952928543091
loss_pred:0.020222388207912445, decouple_loss:0.005716574843972921
The generated pressure mean: 0.45042863488197327
loss_pred:0.021165920421481133, decouple_loss:0.005794314667582512
The generated pressure mean: 0.45514246821403503
loss_pred:0.019771700724959373, decouple_loss:0.005621076561510563
Iteration: 2098, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4597312808036804
loss_pred:0.02023075520992279, decouple_loss:0.004873672034591436
The generated pressure mean: 0.45513612031936646
loss_pred:0.019964193925261497, decouple_loss:0.0048941997811198235
The generated pressure mean: 0.45996901392936707
loss_pred:0.019885782152414322, decouple_loss:0.005384569521993399
Iteration: 2099, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44195669889450073
loss_pred:0.021322062239050865, decouple_loss:0.004958792589604855
The generated pressure mean: 0.44131559133529663
loss_pred:0.019245417788624763, decouple_loss:0.004823688883334398
The generated pressure mean: 0.44680336117744446
loss_pred:0.020114852115511894, decouple_loss:0.005193170625716448
Iteration: 2100, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44047752022743225
loss_pred:0.0190594382584095, decouple_loss:0.004852937534451485
The generated pressure mean: 0.44568660855293274
loss_pred:0.020131142809987068, decouple_loss:0.004854380153119564
The generated pressure mean: 0.4391029477119446
loss_pred:0.019332021474838257, decouple_loss:0.004512360785156488
2023-04-16 09:31:26 testing...
The generated pressure mean: 0.4183292090892792
loss_pred:0.03760137781500816, decouple_loss:0.005853437818586826
The generated pressure mean: 0.42784926295280457
loss_pred:0.03599249944090843, decouple_loss:0.005989990197122097
The generated pressure mean: 0.4320286214351654
loss_pred:0.036635104566812515, decouple_loss:0.006145904306322336
Loss: 0.03704281896352768, avg_mse: 0.05318453907966614
current test mse: 0.053185
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012014_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012014_3_24hr.npz
NaN value num: 0
Iteration: 2101, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4464563727378845
loss_pred:0.01973644830286503, decouple_loss:0.005201516207307577
The generated pressure mean: 0.4533674120903015
loss_pred:0.021194439381361008, decouple_loss:0.005148081574589014
The generated pressure mean: 0.4533456563949585
loss_pred:0.019791407510638237, decouple_loss:0.004967215470969677
Iteration: 2102, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.433952271938324
loss_pred:0.02015935815870762, decouple_loss:0.005799990147352219
The generated pressure mean: 0.4375011920928955
loss_pred:0.020207839086651802, decouple_loss:0.005897297989577055
The generated pressure mean: 0.4340471625328064
loss_pred:0.019988466054201126, decouple_loss:0.006062425207346678
Iteration: 2103, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.450022429227829
loss_pred:0.0202319473028183, decouple_loss:0.004645561333745718
The generated pressure mean: 0.446361780166626
The generated pressure mean: 0.44977813959121704
loss_pred:0.020270049571990967, decouple_loss:0.004829027224332094
loss_pred:0.01980927400290966, decouple_loss:0.004757738206535578
Iteration: 2104, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.450043261051178
The generated pressure mean: 0.44850125908851624
loss_pred:0.021404137834906578, decouple_loss:0.005889807362109423
loss_pred:0.018542679026722908, decouple_loss:0.005286586005240679
The generated pressure mean: 0.445752888917923
loss_pred:0.01982228271663189, decouple_loss:0.0058807809837162495
Iteration: 2105, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4563385844230652
loss_pred:0.01974819228053093, decouple_loss:0.005937444046139717
The generated pressure mean: 0.45743927359580994
loss_pred:0.019904837012290955, decouple_loss:0.006056993268430233
The generated pressure mean: 0.45821571350097656
loss_pred:0.01938820816576481, decouple_loss:0.005965261720120907
Iteration: 2106, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4414672255516052
loss_pred:0.020420074462890625, decouple_loss:0.006172765977680683
The generated pressure mean: 0.44561967253685
loss_pred:0.020528720691800117, decouple_loss:0.005792140960693359
The generated pressure mean: 0.44486457109451294
loss_pred:0.020158836618065834, decouple_loss:0.0058569409884512424
Iteration: 2107, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43167299032211304
loss_pred:0.022664062678813934, decouple_loss:0.005360247567296028
The generated pressure mean: 0.43238499760627747
loss_pred:0.019385600462555885, decouple_loss:0.005583006888628006
The generated pressure mean: 0.43243101239204407
loss_pred:0.019624602049589157, decouple_loss:0.005180998705327511
Iteration: 2108, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4483663737773895
loss_pred:0.01931171678006649, decouple_loss:0.006242214236408472
The generated pressure mean: 0.44778797030448914
loss_pred:0.020455647259950638, decouple_loss:0.006223543547093868
The generated pressure mean: 0.4432345926761627
loss_pred:0.01981298252940178, decouple_loss:0.006397642195224762
Iteration: 2109, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45501425862312317
loss_pred:0.01923345774412155, decouple_loss:0.005986887961626053
The generated pressure mean: 0.4570758044719696
loss_pred:0.01953362487256527, decouple_loss:0.005928677041083574
The generated pressure mean: 0.4605841338634491
loss_pred:0.020196467638015747, decouple_loss:0.005787958856672049
Iteration: 2110, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44775694608688354
loss_pred:0.020075971260666847, decouple_loss:0.005293974652886391
The generated pressure mean: 0.4453203082084656
loss_pred:0.019420666620135307, decouple_loss:0.005389375612139702
The generated pressure mean: 0.4448646903038025
loss_pred:0.020295707508921623, decouple_loss:0.005716161336749792
2023-04-16 09:34:02 testing...
The generated pressure mean: 0.418905645608902
loss_pred:0.03465821221470833, decouple_loss:0.006043465808033943
The generated pressure mean: 0.4286104738712311
loss_pred:0.033870045095682144, decouple_loss:0.00605638837441802
The generated pressure mean: 0.43103736639022827
loss_pred:0.033984921872615814, decouple_loss:0.006296887062489986
Loss: 0.03447767347097397, avg_mse: 0.04994989559054375
current test mse: 0.04995
Iteration: 2111, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4399767816066742
The generated pressure mean: 0.4396047592163086
loss_pred:0.019968485459685326, decouple_loss:0.0052642375230789185
loss_pred:0.019557984545826912, decouple_loss:0.005132979713380337
The generated pressure mean: 0.4443962275981903
loss_pred:0.01979997754096985, decouple_loss:0.005126319359987974
Iteration: 2112, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4505915641784668
The generated pressure mean: 0.45548486709594727
loss_pred:0.019448379054665565, decouple_loss:0.005268747918307781
loss_pred:0.018637020140886307, decouple_loss:0.005114677827805281
The generated pressure mean: 0.4538370966911316
loss_pred:0.019188208505511284, decouple_loss:0.004898354411125183
Iteration: 2113, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4486343562602997
loss_pred:0.0185808464884758, decouple_loss:0.004721814300864935
The generated pressure mean: 0.45118361711502075
loss_pred:0.020005138590931892, decouple_loss:0.004472610540688038
The generated pressure mean: 0.4512273967266083
loss_pred:0.020820412784814835, decouple_loss:0.0047970418818295
Iteration: 2114, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4389503002166748
loss_pred:0.020629892125725746, decouple_loss:0.005431445315480232
The generated pressure mean: 0.4324685037136078
loss_pred:0.019703999161720276, decouple_loss:0.005574193317443132
The generated pressure mean: 0.43457669019699097
loss_pred:0.020010726526379585, decouple_loss:0.005381970666348934
Iteration: 2115, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43973010778427124
loss_pred:0.020405760034918785, decouple_loss:0.004803162068128586
The generated pressure mean: 0.4403049349784851
loss_pred:0.02025282382965088, decouple_loss:0.004739000927656889
The generated pressure mean: 0.4454796314239502
loss_pred:0.02028181590139866, decouple_loss:0.004814735148102045
Iteration: 2116, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45888569951057434
loss_pred:0.019921455532312393, decouple_loss:0.004706683102995157
The generated pressure mean: 0.4602448642253876
loss_pred:0.019709840416908264, decouple_loss:0.00457776477560401
The generated pressure mean: 0.4587039649486542
loss_pred:0.020350418984889984, decouple_loss:0.004432499408721924
Iteration: 2117, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45338162779808044
loss_pred:0.02032727561891079, decouple_loss:0.004941882565617561
The generated pressure mean: 0.4581539034843445
loss_pred:0.021898245438933372, decouple_loss:0.0050199395045638084
The generated pressure mean: 0.4542510509490967
loss_pred:0.01968054473400116, decouple_loss:0.005320514086633921
Iteration: 2118, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4342598617076874
loss_pred:0.01970244199037552, decouple_loss:0.005642254836857319
The generated pressure mean: 0.439894437789917
loss_pred:0.0196701493114233, decouple_loss:0.0062520247884094715
The generated pressure mean: 0.44164809584617615
loss_pred:0.020339377224445343, decouple_loss:0.0060206130146980286
Iteration: 2119, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4395469129085541
loss_pred:0.020098969340324402, decouple_loss:0.00493540707975626
The generated pressure mean: 0.4367655813694
loss_pred:0.019945628941059113, decouple_loss:0.005411660298705101
The generated pressure mean: 0.44125568866729736
loss_pred:0.01947089284658432, decouple_loss:0.0052520460449159145
Iteration: 2120, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4572739005088806
loss_pred:0.020090587437152863, decouple_loss:0.004278925247490406
The generated pressure mean: 0.45467570424079895
loss_pred:0.020155375823378563, decouple_loss:0.004325624089688063
The generated pressure mean: 0.4589022696018219
loss_pred:0.019547151401638985, decouple_loss:0.004203620366752148
2023-04-16 09:36:03 testing...
The generated pressure mean: 0.4196211099624634
loss_pred:0.033700890839099884, decouple_loss:0.005741775035858154
The generated pressure mean: 0.4275670051574707
loss_pred:0.03343472257256508, decouple_loss:0.005749869626015425
The generated pressure mean: 0.43031981587409973
loss_pred:0.033731162548065186, decouple_loss:0.006087169982492924
Loss: 0.033915240317583084, avg_mse: 0.04862723499536514
current test mse: 0.048627
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012017_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012017_3_24hr.npz
NaN value num: 0
Iteration: 2121, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4456339180469513
loss_pred:0.01911267824470997, decouple_loss:0.005132306832820177
The generated pressure mean: 0.4433234930038452
loss_pred:0.019122105091810226, decouple_loss:0.005200324580073357
The generated pressure mean: 0.44277969002723694
loss_pred:0.02055911347270012, decouple_loss:0.005204503890126944
Iteration: 2122, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44532737135887146
loss_pred:0.019111810252070427, decouple_loss:0.005141530651599169
The generated pressure mean: 0.44623950123786926
loss_pred:0.02071698009967804, decouple_loss:0.005252270493656397
The generated pressure mean: 0.43752771615982056
loss_pred:0.02080731838941574, decouple_loss:0.0051323180086910725
Iteration: 2123, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4511640667915344
loss_pred:0.01988496445119381, decouple_loss:0.004984461702406406
The generated pressure mean: 0.4506451189517975
loss_pred:0.020662184804677963, decouple_loss:0.00483329501003027
The generated pressure mean: 0.4501701891422272
loss_pred:0.02084781602025032, decouple_loss:0.0047280131839215755
Iteration: 2124, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4455832242965698
loss_pred:0.020105786621570587, decouple_loss:0.005671142600476742
The generated pressure mean: 0.44463852047920227
loss_pred:0.019357215613126755, decouple_loss:0.005667585879564285
The generated pressure mean: 0.45040178298950195
loss_pred:0.020175455138087273, decouple_loss:0.005532899405807257
Iteration: 2125, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44361892342567444
loss_pred:0.02108190208673477, decouple_loss:0.005603971425443888
The generated pressure mean: 0.4446101784706116
loss_pred:0.02024105191230774, decouple_loss:0.005514390766620636
The generated pressure mean: 0.4454795718193054
loss_pred:0.019002139568328857, decouple_loss:0.005604867357760668
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 2126, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45915907621383667
loss_pred:0.020791733637452126, decouple_loss:0.005630893632769585
The generated pressure mean: 0.45408400893211365
loss_pred:0.01958479732275009, decouple_loss:0.005411982536315918
The generated pressure mean: 0.45718899369239807
loss_pred:0.020566590130329132, decouple_loss:0.005489835515618324
Iteration: 2127, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44799867272377014
loss_pred:0.021043146029114723, decouple_loss:0.0055185891687870026
The generated pressure mean: 0.4469324052333832
loss_pred:0.01990656740963459, decouple_loss:0.005583977792412043
The generated pressure mean: 0.4420630633831024
loss_pred:0.019907284528017044, decouple_loss:0.005493417382240295
Iteration: 2128, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44234398007392883
loss_pred:0.019695814698934555, decouple_loss:0.00506216287612915
The generated pressure mean: 0.4425150454044342
loss_pred:0.019255580380558968, decouple_loss:0.005219690501689911
The generated pressure mean: 0.44450438022613525
loss_pred:0.01909441128373146, decouple_loss:0.005203929729759693
Iteration: 2129, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4492303729057312
loss_pred:0.01896943524479866, decouple_loss:0.003985722083598375
The generated pressure mean: 0.4485379457473755
loss_pred:0.019849669188261032, decouple_loss:0.004224095959216356
The generated pressure mean: 0.4455536901950836
loss_pred:0.019521240144968033, decouple_loss:0.004056280478835106
Iteration: 2130, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4430636167526245
loss_pred:0.019350875169038773, decouple_loss:0.004620295949280262
The generated pressure mean: 0.44450685381889343
loss_pred:0.019691668450832367, decouple_loss:0.004617976024746895
The generated pressure mean: 0.4428185820579529
loss_pred:0.019886920228600502, decouple_loss:0.0047233528457582
2023-04-16 09:38:39 testing...
The generated pressure mean: 0.41718989610671997
loss_pred:0.03283689543604851, decouple_loss:0.005702625960111618
The generated pressure mean: 0.42752933502197266
loss_pred:0.03265612944960594, decouple_loss:0.005936541128903627
The generated pressure mean: 0.4305424988269806
loss_pred:0.031643591821193695, decouple_loss:0.006013913080096245
Loss: 0.03267309069633484, avg_mse: 0.04700572043657303
current test mse: 0.047006
Iteration: 2131, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4483427107334137
loss_pred:0.020132794976234436, decouple_loss:0.005390799138695002The generated pressure mean: 0.4474717080593109
loss_pred:0.02082996629178524, decouple_loss:0.005084895994514227
The generated pressure mean: 0.45208463072776794
loss_pred:0.01865217462182045, decouple_loss:0.005310618318617344
Iteration: 2132, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44847774505615234
The generated pressure mean: 0.4485543668270111
loss_pred:0.019770383834838867, decouple_loss:0.005534653086215258
loss_pred:0.02032853104174137, decouple_loss:0.005726949777454138
The generated pressure mean: 0.44331249594688416
loss_pred:0.02074321359395981, decouple_loss:0.005616220645606518
Iteration: 2133, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4481586813926697
loss_pred:0.020219821482896805, decouple_loss:0.005016222130507231
The generated pressure mean: 0.4469422399997711
loss_pred:0.01900990679860115, decouple_loss:0.00493607809767127
The generated pressure mean: 0.447709321975708
loss_pred:0.02002277970314026, decouple_loss:0.004923080559819937
Iteration: 2134, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4487205743789673
loss_pred:0.019443556666374207, decouple_loss:0.005955345928668976
The generated pressure mean: 0.450415700674057
loss_pred:0.019630465656518936, decouple_loss:0.005896097514778376
The generated pressure mean: 0.44661614298820496
loss_pred:0.019817987456917763, decouple_loss:0.005980306304991245
Iteration: 2135, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44292643666267395
loss_pred:0.019530709832906723, decouple_loss:0.004846255294978619
The generated pressure mean: 0.4478776156902313
loss_pred:0.01910521648824215, decouple_loss:0.004804360680282116
The generated pressure mean: 0.44824618101119995
loss_pred:0.020022640004754066, decouple_loss:0.005095242522656918
Iteration: 2136, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45054611563682556
loss_pred:0.01956968754529953, decouple_loss:0.005852896720170975The generated pressure mean: 0.44374996423721313
loss_pred:0.019078804180026054, decouple_loss:0.005905041471123695
The generated pressure mean: 0.44857320189476013
loss_pred:0.020430030301213264, decouple_loss:0.005713706370443106
Iteration: 2137, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4471697509288788
loss_pred:0.019140297546982765, decouple_loss:0.004183122888207436
The generated pressure mean: 0.45039886236190796
loss_pred:0.020859861746430397, decouple_loss:0.004383628256618977
The generated pressure mean: 0.4485204219818115
loss_pred:0.019938668236136436, decouple_loss:0.004208301659673452
Iteration: 2138, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44329342246055603
loss_pred:0.020489944145083427, decouple_loss:0.004757719114422798
The generated pressure mean: 0.4441510736942291
loss_pred:0.020559553056955338, decouple_loss:0.004755612928420305
The generated pressure mean: 0.44245922565460205
loss_pred:0.01957627944648266, decouple_loss:0.0047932886518538
Iteration: 2139, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4501744508743286
loss_pred:0.019420601427555084, decouple_loss:0.004808312747627497
The generated pressure mean: 0.449209600687027
loss_pred:0.02045748010277748, decouple_loss:0.004911865573376417
The generated pressure mean: 0.4519573748111725
loss_pred:0.020231442525982857, decouple_loss:0.005095265340059996
Iteration: 2140, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.439146488904953
loss_pred:0.01979147084057331, decouple_loss:0.005005106329917908
The generated pressure mean: 0.4447285532951355
loss_pred:0.02066202089190483, decouple_loss:0.005242046434432268
The generated pressure mean: 0.4439118802547455
loss_pred:0.01866050250828266, decouple_loss:0.005037529394030571
2023-04-16 09:40:39 testing...
The generated pressure mean: 0.41723769903182983
loss_pred:0.03340395167469978, decouple_loss:0.004890526179224253
The generated pressure mean: 0.4262198209762573
loss_pred:0.032232560217380524, decouple_loss:0.005101412534713745
The generated pressure mean: 0.42998582124710083
loss_pred:0.03245791420340538, decouple_loss:0.005233937408775091
Loss: 0.03295190632343292, avg_mse: 0.047915201634168625
current test mse: 0.047915
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012018_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012018_3_24hr.npz
NaN value num: 0
Iteration: 2141, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44568464159965515
loss_pred:0.01930372603237629, decouple_loss:0.004577848128974438
The generated pressure mean: 0.4486713707447052
loss_pred:0.018512852489948273, decouple_loss:0.004417303018271923
The generated pressure mean: 0.4495316743850708
loss_pred:0.019749369472265244, decouple_loss:0.004290956538170576
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 2142, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4552830457687378
loss_pred:0.019841467961668968, decouple_loss:0.004399119410663843The generated pressure mean: 0.45869821310043335
loss_pred:0.02021416462957859, decouple_loss:0.004762256983667612
The generated pressure mean: 0.4532123804092407
loss_pred:0.020419178530573845, decouple_loss:0.004451006185263395
Iteration: 2143, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44172701239585876
loss_pred:0.018377680331468582, decouple_loss:0.004572050645947456
The generated pressure mean: 0.4429149627685547
loss_pred:0.018917998299002647, decouple_loss:0.004731130786240101
The generated pressure mean: 0.4447396397590637
loss_pred:0.019903279840946198, decouple_loss:0.004828465171158314
Iteration: 2144, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4431053102016449
The generated pressure mean: 0.4440939128398895
loss_pred:0.0207204632461071, decouple_loss:0.004504733253270388
loss_pred:0.02027815580368042, decouple_loss:0.004517179913818836
The generated pressure mean: 0.4434567987918854
loss_pred:0.019702911376953125, decouple_loss:0.004499970469623804
Iteration: 2145, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44154733419418335
The generated pressure mean: 0.4431628882884979
loss_pred:0.01990598440170288, decouple_loss:0.004824744537472725
loss_pred:0.019724354147911072, decouple_loss:0.004693461582064629
The generated pressure mean: 0.4434983432292938
loss_pred:0.019528428092598915, decouple_loss:0.005069826263934374
Iteration: 2146, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44259801506996155
loss_pred:0.019449807703495026, decouple_loss:0.004829758312553167
The generated pressure mean: 0.447094589471817
loss_pred:0.020027659833431244, decouple_loss:0.004908199422061443
The generated pressure mean: 0.45172521471977234
loss_pred:0.01980084553360939, decouple_loss:0.004993709269911051
Iteration: 2147, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45551395416259766
The generated pressure mean: 0.4582507014274597
loss_pred:0.01990509033203125, decouple_loss:0.004935814067721367
loss_pred:0.01947437971830368, decouple_loss:0.0050117154605686665
The generated pressure mean: 0.4543631672859192
loss_pred:0.019923647865653038, decouple_loss:0.004959317855536938
Iteration: 2148, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45280909538269043
The generated pressure mean: 0.4493992030620575loss_pred:0.0186340119689703, decouple_loss:0.004000786226242781
loss_pred:0.019097931683063507, decouple_loss:0.00395201425999403
The generated pressure mean: 0.4477904438972473
loss_pred:0.01962076686322689, decouple_loss:0.003994443919509649
Iteration: 2149, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4347635805606842
The generated pressure mean: 0.4345111846923828
loss_pred:0.01923578418791294, decouple_loss:0.005328104831278324
loss_pred:0.020378440618515015, decouple_loss:0.0050892154686152935
The generated pressure mean: 0.43307074904441833
loss_pred:0.02002258040010929, decouple_loss:0.0052264598198235035
Iteration: 2150, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4497353732585907
loss_pred:0.019515065476298332, decouple_loss:0.004997537937015295
The generated pressure mean: 0.4476030766963959
loss_pred:0.0193241648375988, decouple_loss:0.005259262397885323
The generated pressure mean: 0.45286911725997925
loss_pred:0.020017744973301888, decouple_loss:0.005152073223143816
2023-04-16 09:43:28 testing...
The generated pressure mean: 0.41470181941986084
loss_pred:0.03283603861927986, decouple_loss:0.0063413213938474655
The generated pressure mean: 0.4227685332298279
loss_pred:0.03212917596101761, decouple_loss:0.006419382058084011
The generated pressure mean: 0.4254804253578186
loss_pred:0.03249125927686691, decouple_loss:0.006545511074364185
Loss: 0.03280726075172424, avg_mse: 0.04735663905739784
current test mse: 0.047357
Iteration: 2151, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46009495854377747
loss_pred:0.019259409978985786, decouple_loss:0.005603666417300701
The generated pressure mean: 0.45753276348114014
loss_pred:0.01957620307803154, decouple_loss:0.00560687156394124
The generated pressure mean: 0.4589070975780487
loss_pred:0.019111545756459236, decouple_loss:0.0056794690899550915
Iteration: 2152, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.441567599773407
loss_pred:0.018700577318668365, decouple_loss:0.004942601080983877
The generated pressure mean: 0.44245174527168274
loss_pred:0.019748203456401825, decouple_loss:0.004942319355905056
The generated pressure mean: 0.44479167461395264
loss_pred:0.020267542451620102, decouple_loss:0.005211557727307081
Iteration: 2153, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4452170431613922
loss_pred:0.020194802433252335, decouple_loss:0.004648594185709953
The generated pressure mean: 0.44031664729118347
loss_pred:0.01972815953195095, decouple_loss:0.004524786025285721
The generated pressure mean: 0.4411456882953644
loss_pred:0.020152060315012932, decouple_loss:0.004738909658044577
Iteration: 2154, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44589516520500183
loss_pred:0.018937241286039352, decouple_loss:0.005853977520018816
The generated pressure mean: 0.44544172286987305
loss_pred:0.018938951194286346, decouple_loss:0.005424680653959513
The generated pressure mean: 0.4473404288291931
loss_pred:0.019619150087237358, decouple_loss:0.005203492008149624
Iteration: 2155, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45204371213912964
loss_pred:0.019603194668889046, decouple_loss:0.004221329465508461
The generated pressure mean: 0.4467391073703766
loss_pred:0.02016904205083847, decouple_loss:0.0041941748932003975
The generated pressure mean: 0.45014235377311707
loss_pred:0.019443871453404427, decouple_loss:0.004425146151334047
Iteration: 2156, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4494214653968811
The generated pressure mean: 0.44375625252723694
loss_pred:0.01947920396924019, decouple_loss:0.004991571884602308
loss_pred:0.018814705312252045, decouple_loss:0.004765079356729984
The generated pressure mean: 0.44562771916389465
loss_pred:0.019544029608368874, decouple_loss:0.004768927115947008
Iteration: 2157, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44664737582206726
loss_pred:0.02021222747862339, decouple_loss:0.004432861227542162
The generated pressure mean: 0.44788092374801636
loss_pred:0.019653089344501495, decouple_loss:0.004309751559048891
The generated pressure mean: 0.4431232810020447
loss_pred:0.019360732287168503, decouple_loss:0.004551868885755539
Iteration: 2158, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45021137595176697
loss_pred:0.01940309628844261, decouple_loss:0.004729507490992546
The generated pressure mean: 0.4506794810295105
loss_pred:0.019854234531521797, decouple_loss:0.004799241665750742
The generated pressure mean: 0.4517916440963745
loss_pred:0.018952926620841026, decouple_loss:0.004788505379110575
Iteration: 2159, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4516427516937256
loss_pred:0.019956568256020546, decouple_loss:0.004889266565442085
The generated pressure mean: 0.45169690251350403
loss_pred:0.019496643915772438, decouple_loss:0.00447942316532135
The generated pressure mean: 0.45187854766845703
loss_pred:0.02029542066156864, decouple_loss:0.004900472238659859
Iteration: 2160, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4386327266693115
loss_pred:0.01925531215965748, decouple_loss:0.004431921523064375
The generated pressure mean: 0.44304949045181274
loss_pred:0.019099336117506027, decouple_loss:0.004578270483762026
The generated pressure mean: 0.44379913806915283
loss_pred:0.01935911364853382, decouple_loss:0.004477800335735083
2023-04-16 09:45:28 testing...
The generated pressure mean: 0.4195563793182373
loss_pred:0.033625923097133636, decouple_loss:0.005389461759477854
The generated pressure mean: 0.4277384579181671
loss_pred:0.03220599144697189, decouple_loss:0.005497550591826439
The generated pressure mean: 0.4298212230205536
loss_pred:0.03276033699512482, decouple_loss:0.005692778620868921
Loss: 0.03314041346311569, avg_mse: 0.04752320796251297
current test mse: 0.047523
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012011_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012011_3_24hr.npz
NaN value num: 0
Iteration: 2161, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43942171335220337
loss_pred:0.02049882896244526, decouple_loss:0.004954857751727104
The generated pressure mean: 0.43983763456344604
The generated pressure mean: 0.4397542178630829
loss_pred:0.02045748382806778, decouple_loss:0.0050792088732123375
loss_pred:0.018838224932551384, decouple_loss:0.004903099033981562
Iteration: 2162, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44563427567481995
loss_pred:0.01918846182525158, decouple_loss:0.00459436746314168
The generated pressure mean: 0.4487752914428711
loss_pred:0.018568675965070724, decouple_loss:0.00416594510897994
The generated pressure mean: 0.45128333568573
loss_pred:0.02001897618174553, decouple_loss:0.00399256544187665
Iteration: 2163, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45167627930641174
loss_pred:0.019699638709425926, decouple_loss:0.0051115150563418865
The generated pressure mean: 0.45254549384117126
loss_pred:0.01931505650281906, decouple_loss:0.005230236798524857
The generated pressure mean: 0.4516410827636719
loss_pred:0.018922531977295876, decouple_loss:0.004921868909150362
Iteration: 2164, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4490698575973511
loss_pred:0.01962965354323387, decouple_loss:0.00448021711781621
The generated pressure mean: 0.4448476731777191
loss_pred:0.01757924072444439, decouple_loss:0.004583253990858793
The generated pressure mean: 0.44771334528923035
loss_pred:0.02038707211613655, decouple_loss:0.00439838133752346
Iteration: 2165, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4470965266227722
loss_pred:0.019373882561922073, decouple_loss:0.005393901839852333
The generated pressure mean: 0.4499180018901825
loss_pred:0.0201785359531641, decouple_loss:0.005325169302523136
The generated pressure mean: 0.44551509618759155
loss_pred:0.018629735335707664, decouple_loss:0.005000018049031496
Iteration: 2166, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43897926807403564
loss_pred:0.01822446472942829, decouple_loss:0.005374362226575613
The generated pressure mean: 0.4405144453048706
loss_pred:0.018234578892588615, decouple_loss:0.005507910158485174
The generated pressure mean: 0.44206488132476807
loss_pred:0.018604721873998642, decouple_loss:0.005291684530675411
Iteration: 2167, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4526345431804657
loss_pred:0.01826108805835247, decouple_loss:0.005078449845314026
The generated pressure mean: 0.45199453830718994
loss_pred:0.018451441079378128, decouple_loss:0.005270408466458321
The generated pressure mean: 0.45072826743125916
loss_pred:0.018938744440674782, decouple_loss:0.005234307609498501
Iteration: 2168, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4501706659793854
loss_pred:0.02079523354768753, decouple_loss:0.005258732941001654
The generated pressure mean: 0.4474225342273712
loss_pred:0.018766170367598534, decouple_loss:0.004933921154588461
The generated pressure mean: 0.44842997193336487
loss_pred:0.018381858244538307, decouple_loss:0.0048787654377520084
Iteration: 2169, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45059219002723694
loss_pred:0.019488614052534103, decouple_loss:0.005028455518186092
The generated pressure mean: 0.4509136378765106
loss_pred:0.02118472196161747, decouple_loss:0.0047902874648571014
The generated pressure mean: 0.4491825997829437
loss_pred:0.019578125327825546, decouple_loss:0.004893105011433363
Iteration: 2170, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4402996599674225
loss_pred:0.01923687383532524, decouple_loss:0.005426230374723673
The generated pressure mean: 0.44122833013534546
loss_pred:0.019243909046053886, decouple_loss:0.005292439367622137
The generated pressure mean: 0.44161057472229004
loss_pred:0.01846952736377716, decouple_loss:0.005263670347630978
2023-04-16 09:48:04 testing...
The generated pressure mean: 0.41812199354171753
loss_pred:0.03385136276483536, decouple_loss:0.005427815020084381
The generated pressure mean: 0.42805978655815125
loss_pred:0.03180327266454697, decouple_loss:0.005440733395516872
The generated pressure mean: 0.430583119392395
loss_pred:0.03210297226905823, decouple_loss:0.005584170576184988
Loss: 0.032860081642866135, avg_mse: 0.0473814383149147
current test mse: 0.047381
Iteration: 2171, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44793957471847534
loss_pred:0.018377745524048805, decouple_loss:0.004752742126584053
The generated pressure mean: 0.44385749101638794
loss_pred:0.018760373815894127, decouple_loss:0.0047668577171862125
The generated pressure mean: 0.44402363896369934
loss_pred:0.018202882260084152, decouple_loss:0.004760722164064646
Iteration: 2172, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4560414254665375
loss_pred:0.01882733590900898, decouple_loss:0.006012326572090387
The generated pressure mean: 0.4548528492450714
loss_pred:0.021012451499700546, decouple_loss:0.005950505379587412
The generated pressure mean: 0.45771101117134094
loss_pred:0.017971158027648926, decouple_loss:0.0058684395626187325
Iteration: 2173, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45137307047843933
loss_pred:0.0197459626942873, decouple_loss:0.005616085138171911
The generated pressure mean: 0.44950634241104126
loss_pred:0.018622979521751404, decouple_loss:0.005668074358254671
The generated pressure mean: 0.4527584910392761
loss_pred:0.018623951822519302, decouple_loss:0.0054050530306994915
Iteration: 2174, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4335959255695343
loss_pred:0.019688518717885017, decouple_loss:0.005319308489561081
The generated pressure mean: 0.4364960789680481
loss_pred:0.018810680136084557, decouple_loss:0.005246984306722879
The generated pressure mean: 0.4355543255805969
loss_pred:0.01926957443356514, decouple_loss:0.005195276811718941
Iteration: 2175, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4485616385936737
loss_pred:0.01884138025343418, decouple_loss:0.005536900833249092
The generated pressure mean: 0.4514195919036865
loss_pred:0.01887279748916626, decouple_loss:0.005707100033760071
The generated pressure mean: 0.45344382524490356
loss_pred:0.01919582113623619, decouple_loss:0.0057395631447434425
Iteration: 2176, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44513529539108276
loss_pred:0.017963306978344917, decouple_loss:0.005347259342670441
The generated pressure mean: 0.4470718502998352
loss_pred:0.018850307911634445, decouple_loss:0.0051488555036485195
The generated pressure mean: 0.4458707869052887
loss_pred:0.020356953144073486, decouple_loss:0.00511295348405838
Iteration: 2177, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45096731185913086
loss_pred:0.02186623588204384, decouple_loss:0.006586261559277773
The generated pressure mean: 0.45832622051239014
loss_pred:0.01850738190114498, decouple_loss:0.006476514972746372
The generated pressure mean: 0.45064088702201843
loss_pred:0.020064713433384895, decouple_loss:0.00648362934589386
Iteration: 2178, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4369555413722992
loss_pred:0.01838727481663227, decouple_loss:0.004981525242328644
The generated pressure mean: 0.44009917974472046
loss_pred:0.020121250301599503, decouple_loss:0.004940103739500046
The generated pressure mean: 0.44262686371803284
loss_pred:0.01910320483148098, decouple_loss:0.0047495863400399685
Iteration: 2179, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4392178952693939
loss_pred:0.019489161670207977, decouple_loss:0.00496895844116807
The generated pressure mean: 0.4401715397834778
loss_pred:0.019589034840464592, decouple_loss:0.005174939054995775
The generated pressure mean: 0.4385407865047455
loss_pred:0.019096897915005684, decouple_loss:0.005120290908962488
Iteration: 2180, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45982345938682556
loss_pred:0.01858253963291645, decouple_loss:0.005496047902852297
The generated pressure mean: 0.46050015091896057
loss_pred:0.018535973504185677, decouple_loss:0.0056289490312337875
The generated pressure mean: 0.45675981044769287
loss_pred:0.019588490948081017, decouple_loss:0.005398229695856571
2023-04-16 09:50:05 testing...
The generated pressure mean: 0.4156680405139923
loss_pred:0.03338278457522392, decouple_loss:0.00665771821513772
The generated pressure mean: 0.4237321615219116
loss_pred:0.03187239170074463, decouple_loss:0.006779623683542013
The generated pressure mean: 0.42675092816352844
loss_pred:0.0320122055709362, decouple_loss:0.006967623718082905
Loss: 0.032762542366981506, avg_mse: 0.046711381524801254
current test mse: 0.046711
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012005_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012005_3_24hr.npz
NaN value num: 0
Iteration: 2181, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4541579782962799
loss_pred:0.019806671887636185, decouple_loss:0.006407424807548523
The generated pressure mean: 0.4559285342693329
loss_pred:0.018986715003848076, decouple_loss:0.006333733908832073
The generated pressure mean: 0.46248161792755127
loss_pred:0.018359307199716568, decouple_loss:0.00628403015434742
Iteration: 2182, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44159239530563354
loss_pred:0.018676120787858963, decouple_loss:0.0061437105759978294
The generated pressure mean: 0.44485586881637573
loss_pred:0.019808251410722733, decouple_loss:0.0061525204218924046
The generated pressure mean: 0.44464772939682007
loss_pred:0.01891331933438778, decouple_loss:0.00617890665307641
Iteration: 2183, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43701350688934326
loss_pred:0.019893016666173935, decouple_loss:0.005144416354596615
The generated pressure mean: 0.43693551421165466
loss_pred:0.019233999773859978, decouple_loss:0.005248683504760265
The generated pressure mean: 0.4308032989501953
loss_pred:0.019221896305680275, decouple_loss:0.004933234769850969
Iteration: 2184, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4506034255027771
loss_pred:0.018248040229082108, decouple_loss:0.005056722555309534
The generated pressure mean: 0.45139291882514954
loss_pred:0.01756502129137516, decouple_loss:0.0047772955149412155
The generated pressure mean: 0.4486194849014282
loss_pred:0.017940612509846687, decouple_loss:0.004802176728844643
Iteration: 2185, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45559167861938477
loss_pred:0.01870947703719139, decouple_loss:0.0050519658252596855
The generated pressure mean: 0.4607497751712799
loss_pred:0.019000446423888206, decouple_loss:0.004806642420589924
The generated pressure mean: 0.45736706256866455
loss_pred:0.018779825419187546, decouple_loss:0.004922312684357166
Iteration: 2186, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45443543791770935
loss_pred:0.01816190406680107, decouple_loss:0.004985604900866747
The generated pressure mean: 0.4426717460155487
loss_pred:0.018383994698524475, decouple_loss:0.004896892234683037
The generated pressure mean: 0.4479933977127075
loss_pred:0.019789543002843857, decouple_loss:0.0048614563420414925
Iteration: 2187, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43682536482810974
loss_pred:0.01910659298300743, decouple_loss:0.005483571439981461
The generated pressure mean: 0.44449907541275024
loss_pred:0.01839781180024147, decouple_loss:0.00565232103690505
The generated pressure mean: 0.4429609775543213
loss_pred:0.018431391566991806, decouple_loss:0.005776091944426298
Iteration: 2188, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45031407475471497
loss_pred:0.01757843606173992, decouple_loss:0.00545985484495759
The generated pressure mean: 0.4477611184120178
loss_pred:0.018839912489056587, decouple_loss:0.005608502775430679
The generated pressure mean: 0.4482365548610687
loss_pred:0.017795762047171593, decouple_loss:0.005427462514489889
Iteration: 2189, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4522205889225006
loss_pred:0.020400552079081535, decouple_loss:0.0053803762421011925
The generated pressure mean: 0.45102083683013916
loss_pred:0.018763260915875435, decouple_loss:0.005302940960973501
The generated pressure mean: 0.45140379667282104
loss_pred:0.01978285051882267, decouple_loss:0.00534910848364234
Iteration: 2190, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4474698007106781
loss_pred:0.01781587302684784, decouple_loss:0.006019648630172014
The generated pressure mean: 0.45329493284225464
loss_pred:0.018152834847569466, decouple_loss:0.006352476309984922
The generated pressure mean: 0.4480589032173157
loss_pred:0.020842669531702995, decouple_loss:0.006311627104878426
2023-04-16 09:52:38 testing...
The generated pressure mean: 0.4191659688949585
loss_pred:0.03243936598300934, decouple_loss:0.0062102219089865685
The generated pressure mean: 0.42893388867378235
loss_pred:0.03163078799843788, decouple_loss:0.006318702362477779
The generated pressure mean: 0.431201308965683
loss_pred:0.0312472153455019, decouple_loss:0.006338199134916067
Loss: 0.03208690881729126, avg_mse: 0.04648244008421898
current test mse: 0.046482
Iteration: 2191, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4419124722480774
loss_pred:0.01822235994040966, decouple_loss:0.005498222541064024
The generated pressure mean: 0.4499468207359314
loss_pred:0.018862847238779068, decouple_loss:0.0057828533463180065
The generated pressure mean: 0.4443751871585846
loss_pred:0.01820044033229351, decouple_loss:0.005485475528985262
Iteration: 2192, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44181689620018005
loss_pred:0.018637197092175484, decouple_loss:0.0048236302100121975
The generated pressure mean: 0.451072096824646
loss_pred:0.018408650532364845, decouple_loss:0.0047933002933859825
The generated pressure mean: 0.4462340176105499
loss_pred:0.019064581021666527, decouple_loss:0.004804112017154694
Iteration: 2193, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4624733328819275
loss_pred:0.018035825341939926, decouple_loss:0.005150213837623596
The generated pressure mean: 0.4552174210548401
loss_pred:0.019138289615511894, decouple_loss:0.005090717226266861
The generated pressure mean: 0.45211613178253174
loss_pred:0.019589446485042572, decouple_loss:0.005267926026135683
Iteration: 2194, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4502740204334259
loss_pred:0.017950281500816345, decouple_loss:0.0057427906431257725
The generated pressure mean: 0.4506658911705017
loss_pred:0.01918734423816204, decouple_loss:0.005628663115203381
The generated pressure mean: 0.4469541311264038
loss_pred:0.01872940920293331, decouple_loss:0.005775655619800091
Iteration: 2195, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4417269229888916
loss_pred:0.018476329743862152, decouple_loss:0.0055414424277842045
The generated pressure mean: 0.45026811957359314
loss_pred:0.018836764618754387, decouple_loss:0.005416248459368944
The generated pressure mean: 0.4479013979434967
loss_pred:0.020763922482728958, decouple_loss:0.005482982844114304
Iteration: 2196, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4406035840511322
loss_pred:0.018797384575009346, decouple_loss:0.005067340098321438
The generated pressure mean: 0.43682485818862915
loss_pred:0.017763499170541763, decouple_loss:0.005324681755155325
The generated pressure mean: 0.44098472595214844
loss_pred:0.01922925002872944, decouple_loss:0.004912411328405142
Iteration: 2197, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4552527666091919
loss_pred:0.019192708656191826, decouple_loss:0.004921136889606714
The generated pressure mean: 0.45490726828575134
loss_pred:0.01956128142774105, decouple_loss:0.004969245754182339
The generated pressure mean: 0.45474502444267273
loss_pred:0.018146608024835587, decouple_loss:0.005094201769679785
Iteration: 2198, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44486308097839355
loss_pred:0.019012274220585823, decouple_loss:0.004763037897646427
The generated pressure mean: 0.4458483159542084
loss_pred:0.019156089052557945, decouple_loss:0.004804992116987705
The generated pressure mean: 0.44269657135009766
loss_pred:0.017601996660232544, decouple_loss:0.004639556165784597
Iteration: 2199, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45522257685661316
loss_pred:0.018933260813355446, decouple_loss:0.004924996756017208
The generated pressure mean: 0.45809829235076904
loss_pred:0.018132250756025314, decouple_loss:0.004941302351653576
The generated pressure mean: 0.45447057485580444
loss_pred:0.020025210455060005, decouple_loss:0.0048935506492853165
Iteration: 2200, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44444921612739563
loss_pred:0.01842016540467739, decouple_loss:0.0057749212719500065
The generated pressure mean: 0.4397185444831848
loss_pred:0.017826339229941368, decouple_loss:0.005792174953967333
The generated pressure mean: 0.44038712978363037
loss_pred:0.018381062895059586, decouple_loss:0.005520527716726065
2023-04-16 09:54:38 testing...
The generated pressure mean: 0.41809162497520447
loss_pred:0.03324663266539574, decouple_loss:0.005371569190174341
The generated pressure mean: 0.42742016911506653
loss_pred:0.032100267708301544, decouple_loss:0.005542899016290903
The generated pressure mean: 0.430948406457901
loss_pred:0.032328177243471146, decouple_loss:0.005628447514027357
Loss: 0.03283407539129257, avg_mse: 0.04820263758301735
current test mse: 0.048203
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012013_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012013_3_24hr.npz
NaN value num: 0
Iteration: 2201, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44858264923095703
loss_pred:0.0195762999355793, decouple_loss:0.004705057013779879
The generated pressure mean: 0.4444807469844818
loss_pred:0.020176248624920845, decouple_loss:0.00481001939624548
The generated pressure mean: 0.44852757453918457
loss_pred:0.01860365830361843, decouple_loss:0.0047316052950918674
Iteration: 2202, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45207712054252625
loss_pred:0.020336562767624855, decouple_loss:0.005574011709541082
The generated pressure mean: 0.45525065064430237
loss_pred:0.018541185185313225, decouple_loss:0.005310622043907642
The generated pressure mean: 0.4520071744918823
loss_pred:0.01855439320206642, decouple_loss:0.005600744392722845
Iteration: 2203, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43029746413230896
loss_pred:0.019718199968338013, decouple_loss:0.005191384349018335
The generated pressure mean: 0.4394490420818329
loss_pred:0.018730290234088898, decouple_loss:0.00545211648568511
The generated pressure mean: 0.4362211525440216
loss_pred:0.018885593861341476, decouple_loss:0.0057992818765342236
Iteration: 2204, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4497676193714142
loss_pred:0.01897740177810192, decouple_loss:0.004412101581692696
The generated pressure mean: 0.44585222005844116
loss_pred:0.018506521359086037, decouple_loss:0.004152811598032713
The generated pressure mean: 0.4456314444541931
loss_pred:0.01834755949676037, decouple_loss:0.004645374603569508
Iteration: 2205, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45335814356803894
loss_pred:0.020508646965026855, decouple_loss:0.006143285892903805
The generated pressure mean: 0.4565802812576294
loss_pred:0.01900583691895008, decouple_loss:0.006095453631132841
The generated pressure mean: 0.4576480984687805
loss_pred:0.020602039992809296, decouple_loss:0.006283934228122234
Iteration: 2206, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43584394454956055
loss_pred:0.019023962318897247, decouple_loss:0.0044316817075014114
The generated pressure mean: 0.43314242362976074
loss_pred:0.019108224660158157, decouple_loss:0.004673963878303766
The generated pressure mean: 0.4385235905647278
loss_pred:0.01822793297469616, decouple_loss:0.004527468699961901
Iteration: 2207, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44025272130966187
loss_pred:0.018229525536298752, decouple_loss:0.005035875365138054
The generated pressure mean: 0.44177231192588806
loss_pred:0.018557073548436165, decouple_loss:0.004958285018801689
The generated pressure mean: 0.4433433711528778
loss_pred:0.018817845731973648, decouple_loss:0.005098067689687014
Iteration: 2208, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4583400785923004
loss_pred:0.01937684789299965, decouple_loss:0.004790039733052254
The generated pressure mean: 0.4572892487049103
loss_pred:0.019827740266919136, decouple_loss:0.0046510715037584305
The generated pressure mean: 0.45400571823120117
loss_pred:0.019331350922584534, decouple_loss:0.004593107383698225
Iteration: 2209, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4533122479915619
loss_pred:0.01973472721874714, decouple_loss:0.005174287129193544
The generated pressure mean: 0.4590300917625427
loss_pred:0.020280422642827034, decouple_loss:0.005026716273277998
The generated pressure mean: 0.45369410514831543
loss_pred:0.021288452669978142, decouple_loss:0.004883660934865475
Iteration: 2210, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43306270241737366
loss_pred:0.018363557755947113, decouple_loss:0.00479002995416522
The generated pressure mean: 0.43397587537765503
loss_pred:0.01961362734436989, decouple_loss:0.004524094983935356
The generated pressure mean: 0.4321784973144531
loss_pred:0.01922108605504036, decouple_loss:0.004373082425445318
2023-04-16 09:57:16 testing...
The generated pressure mean: 0.4199885129928589
loss_pred:0.03187061473727226, decouple_loss:0.005904813297092915
The generated pressure mean: 0.42920634150505066
loss_pred:0.031004292890429497, decouple_loss:0.005750971846282482
The generated pressure mean: 0.43190449476242065
loss_pred:0.03118220716714859, decouple_loss:0.0060373167507350445
Loss: 0.03164725750684738, avg_mse: 0.04561736062169075
current test mse: 0.045617
Iteration: 2211, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43399757146835327
loss_pred:0.01832801289856434, decouple_loss:0.005512853153049946
The generated pressure mean: 0.43546995520591736
loss_pred:0.018390286713838577, decouple_loss:0.005175135564059019
The generated pressure mean: 0.4360080361366272
loss_pred:0.01824692077934742, decouple_loss:0.005019631236791611
Iteration: 2212, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46140918135643005
loss_pred:0.01926405541598797, decouple_loss:0.004906691610813141
The generated pressure mean: 0.46574926376342773
loss_pred:0.01870833896100521, decouple_loss:0.004917763639241457
The generated pressure mean: 0.4700336158275604
loss_pred:0.018892671912908554, decouple_loss:0.004846484400331974
Iteration: 2213, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4492328464984894
loss_pred:0.02009434998035431, decouple_loss:0.006202981807291508
The generated pressure mean: 0.4500860273838043
loss_pred:0.01788225956261158, decouple_loss:0.006274446379393339
The generated pressure mean: 0.4542466402053833
loss_pred:0.019052715972065926, decouple_loss:0.006039856001734734
Iteration: 2214, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4363391101360321
loss_pred:0.020478280261158943, decouple_loss:0.0045005157589912415
The generated pressure mean: 0.4353752136230469
loss_pred:0.018242165446281433, decouple_loss:0.004622798413038254
The generated pressure mean: 0.4386729300022125
loss_pred:0.019664380699396133, decouple_loss:0.0044261384755373
Iteration: 2215, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4434353709220886
loss_pred:0.01964149810373783, decouple_loss:0.005202832631766796
The generated pressure mean: 0.4437236189842224
loss_pred:0.019218815490603447, decouple_loss:0.00528834480792284
The generated pressure mean: 0.4397074580192566
loss_pred:0.020154064521193504, decouple_loss:0.005504084285348654
Iteration: 2216, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43963751196861267
loss_pred:0.019636843353509903, decouple_loss:0.004744594916701317
The generated pressure mean: 0.4427626430988312
loss_pred:0.019297704100608826, decouple_loss:0.004467588849365711
The generated pressure mean: 0.4443596601486206
loss_pred:0.01851416751742363, decouple_loss:0.00444814283400774
Iteration: 2217, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45652925968170166
loss_pred:0.018801115453243256, decouple_loss:0.005646229721605778
The generated pressure mean: 0.4578504264354706
loss_pred:0.01803123950958252, decouple_loss:0.006108073052018881
The generated pressure mean: 0.4574918746948242
loss_pred:0.0194866880774498, decouple_loss:0.005997355096042156
Iteration: 2218, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4534856081008911
loss_pred:0.018468743190169334, decouple_loss:0.005700469017028809
The generated pressure mean: 0.4513256251811981
loss_pred:0.019927069544792175, decouple_loss:0.005239649675786495
The generated pressure mean: 0.45209819078445435
loss_pred:0.018730346113443375, decouple_loss:0.00573303084820509
Iteration: 2219, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43270087242126465
loss_pred:0.018915502354502678, decouple_loss:0.005611158441752195
The generated pressure mean: 0.43334493041038513
loss_pred:0.019764617085456848, decouple_loss:0.005948932841420174
The generated pressure mean: 0.43372055888175964
loss_pred:0.019300883635878563, decouple_loss:0.005669871345162392
Iteration: 2220, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46073779463768005
loss_pred:0.019322842359542847, decouple_loss:0.004968933295458555
The generated pressure mean: 0.4571944773197174
loss_pred:0.019205521792173386, decouple_loss:0.005036305170506239
The generated pressure mean: 0.4626321792602539
loss_pred:0.018100757151842117, decouple_loss:0.004971036687493324
2023-04-16 09:59:18 testing...
The generated pressure mean: 0.41858798265457153
loss_pred:0.0320313535630703, decouple_loss:0.005481203552335501
The generated pressure mean: 0.42686063051223755
loss_pred:0.031906403601169586, decouple_loss:0.005754339508712292
The generated pressure mean: 0.4297824800014496
loss_pred:0.03123915195465088, decouple_loss:0.005934045650064945
Loss: 0.03201179951429367, avg_mse: 0.045826494693756104
current test mse: 0.045826
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012007_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012007_3_24hr.npz
NaN value num: 0
Iteration: 2221, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4413302540779114
loss_pred:0.018157267943024635, decouple_loss:0.005072429776191711
The generated pressure mean: 0.44564372301101685
loss_pred:0.019261211156845093, decouple_loss:0.004767183680087328
The generated pressure mean: 0.4449787437915802
loss_pred:0.019221145659685135, decouple_loss:0.005405224394053221
Iteration: 2222, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43851596117019653
loss_pred:0.018361611291766167, decouple_loss:0.005482840817421675
The generated pressure mean: 0.4381772577762604
loss_pred:0.018398158252239227, decouple_loss:0.005864711478352547
The generated pressure mean: 0.43945077061653137
loss_pred:0.01787933148443699, decouple_loss:0.005590272601693869
Iteration: 2223, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45602232217788696
loss_pred:0.0189697053283453, decouple_loss:0.005037643015384674
The generated pressure mean: 0.4526577889919281
The generated pressure mean: 0.45335012674331665
loss_pred:0.02045016922056675, decouple_loss:0.004797141999006271
loss_pred:0.018229030072689056, decouple_loss:0.005358025431632996
Iteration: 2224, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45076924562454224
loss_pred:0.018554916605353355, decouple_loss:0.004641387145966291
The generated pressure mean: 0.447812020778656
loss_pred:0.019509680569171906, decouple_loss:0.004583240021020174
The generated pressure mean: 0.45136284828186035
loss_pred:0.019194884225726128, decouple_loss:0.0048914579674601555
Iteration: 2225, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4477735161781311
loss_pred:0.019166547805070877, decouple_loss:0.00581791577860713
The generated pressure mean: 0.4417542517185211
loss_pred:0.019210515543818474, decouple_loss:0.005922271870076656
The generated pressure mean: 0.4444437623023987
loss_pred:0.01869536191225052, decouple_loss:0.005784562323242426
Iteration: 2226, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4445941746234894
loss_pred:0.01818748190999031, decouple_loss:0.004773711785674095
The generated pressure mean: 0.44504520297050476
loss_pred:0.018981631845235825, decouple_loss:0.004991240333765745
The generated pressure mean: 0.4413471221923828
loss_pred:0.018104782328009605, decouple_loss:0.0051306020468473434
Iteration: 2227, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4474852383136749
loss_pred:0.018877100199460983, decouple_loss:0.0056570894084870815
The generated pressure mean: 0.44920387864112854
loss_pred:0.020113082602620125, decouple_loss:0.005223823245614767
The generated pressure mean: 0.4458823502063751
loss_pred:0.018558155745267868, decouple_loss:0.005400463007390499
Iteration: 2228, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44872966408729553
The generated pressure mean: 0.44640547037124634
loss_pred:0.019106771796941757, decouple_loss:0.005151594523340464
loss_pred:0.01926727406680584, decouple_loss:0.004922499414533377
The generated pressure mean: 0.44680508971214294
loss_pred:0.018910478800535202, decouple_loss:0.005058624316006899
Iteration: 2229, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44623592495918274
loss_pred:0.0203202273696661, decouple_loss:0.0058732847683131695
The generated pressure mean: 0.44073358178138733
loss_pred:0.019984029233455658, decouple_loss:0.005964792799204588
The generated pressure mean: 0.449554443359375
loss_pred:0.018238775432109833, decouple_loss:0.006052713375538588
Iteration: 2230, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45320048928260803
loss_pred:0.017381396144628525, decouple_loss:0.005820089019834995
The generated pressure mean: 0.45582258701324463
loss_pred:0.018709296360611916, decouple_loss:0.005571336019784212
The generated pressure mean: 0.4484744966030121
loss_pred:0.019753823056817055, decouple_loss:0.005519072059541941
2023-04-16 10:01:54 testing...
The generated pressure mean: 0.4167287051677704
loss_pred:0.03273053839802742, decouple_loss:0.006102611776441336
The generated pressure mean: 0.4249322712421417
loss_pred:0.031331662088632584, decouple_loss:0.0063116964884102345
The generated pressure mean: 0.42807960510253906
loss_pred:0.0312952995300293, decouple_loss:0.006492759101092815
Loss: 0.03210095316171646, avg_mse: 0.04654188081622124
current test mse: 0.046542
Iteration: 2231, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4570063650608063
loss_pred:0.019395897164940834, decouple_loss:0.005659240763634443
The generated pressure mean: 0.45579713582992554
loss_pred:0.01896793767809868, decouple_loss:0.005498708225786686
The generated pressure mean: 0.45334550738334656
loss_pred:0.018956618383526802, decouple_loss:0.00576465018093586
Iteration: 2232, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43328073620796204
loss_pred:0.017970047891139984, decouple_loss:0.005208315793424845
The generated pressure mean: 0.43136128783226013
loss_pred:0.018792135640978813, decouple_loss:0.004905403591692448
The generated pressure mean: 0.43559107184410095
loss_pred:0.020508162677288055, decouple_loss:0.005168731790035963
Iteration: 2233, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.451180636882782
loss_pred:0.018404414877295494, decouple_loss:0.0038378636818379164
The generated pressure mean: 0.45251765847206116
loss_pred:0.018862159922719002, decouple_loss:0.0036725273821502924
The generated pressure mean: 0.4543582797050476
loss_pred:0.01942332461476326, decouple_loss:0.003704987931996584
Iteration: 2234, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44062501192092896
loss_pred:0.019395800307393074, decouple_loss:0.0058970982208848
The generated pressure mean: 0.44172167778015137
loss_pred:0.01912640407681465, decouple_loss:0.005756919737905264
The generated pressure mean: 0.44758331775665283
loss_pred:0.01737065240740776, decouple_loss:0.005740616470575333
Iteration: 2235, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4486895203590393
loss_pred:0.018335552886128426, decouple_loss:0.005181315820664167
The generated pressure mean: 0.4499680697917938
loss_pred:0.018418310210108757, decouple_loss:0.005549839232116938
The generated pressure mean: 0.44774070382118225
loss_pred:0.01848137564957142, decouple_loss:0.005488966125994921
Iteration: 2236, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4493091106414795
loss_pred:0.019566120579838753, decouple_loss:0.004451228305697441
The generated pressure mean: 0.4486834406852722
loss_pred:0.019679460674524307, decouple_loss:0.004535201471298933
The generated pressure mean: 0.4529437720775604
loss_pred:0.018903633579611778, decouple_loss:0.004359540995210409
Iteration: 2237, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44660627841949463
The generated pressure mean: 0.44681310653686523loss_pred:0.017282595857977867, decouple_loss:0.0049515715800225735
loss_pred:0.017943643033504486, decouple_loss:0.00507813785225153
The generated pressure mean: 0.44164344668388367
loss_pred:0.019202394410967827, decouple_loss:0.004993870388716459
Iteration: 2238, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44687551259994507
loss_pred:0.018610533326864243, decouple_loss:0.005374210886657238
The generated pressure mean: 0.4461590647697449
loss_pred:0.01995902881026268, decouple_loss:0.0052619329653680325
The generated pressure mean: 0.4521077573299408
loss_pred:0.018806856125593185, decouple_loss:0.005223825573921204
Iteration: 2239, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4408450722694397
The generated pressure mean: 0.43919894099235535
loss_pred:0.01912883296608925, decouple_loss:0.004864796064794064
loss_pred:0.01748965121805668, decouple_loss:0.005217142403125763
The generated pressure mean: 0.4396686851978302
loss_pred:0.01848028041422367, decouple_loss:0.005019643809646368
Iteration: 2240, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45076993107795715
loss_pred:0.017877250909805298, decouple_loss:0.004735127091407776
The generated pressure mean: 0.4485820531845093
loss_pred:0.016544776037335396, decouple_loss:0.004830970428884029
The generated pressure mean: 0.4513486921787262
loss_pred:0.018919333815574646, decouple_loss:0.005062277428805828
2023-04-16 10:03:55 testing...
The generated pressure mean: 0.41591140627861023
loss_pred:0.03346633538603783, decouple_loss:0.006302853114902973
The generated pressure mean: 0.42593899369239807
loss_pred:0.03181461989879608, decouple_loss:0.006377662532031536
The generated pressure mean: 0.4293270707130432
loss_pred:0.03236030414700508, decouple_loss:0.006488096434623003
Loss: 0.03286656364798546, avg_mse: 0.0471903495490551
current test mse: 0.04719
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012005_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012005_3_24hr.npz
NaN value num: 0
Iteration: 2241, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45852985978126526
loss_pred:0.020712610334157944, decouple_loss:0.005727506708353758
The generated pressure mean: 0.4593382477760315
loss_pred:0.019721753895282745, decouple_loss:0.005748395342379808
The generated pressure mean: 0.45599305629730225
loss_pred:0.02022303082048893, decouple_loss:0.005840138532221317
Iteration: 2242, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4300845265388489
loss_pred:0.0185517780482769, decouple_loss:0.005304616875946522
The generated pressure mean: 0.4330081343650818
loss_pred:0.019404862076044083, decouple_loss:0.005444258451461792
The generated pressure mean: 0.4305468797683716
loss_pred:0.019591297954320908, decouple_loss:0.005216899793595076
Iteration: 2243, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45329058170318604
loss_pred:0.018887877464294434, decouple_loss:0.005068687722086906
The generated pressure mean: 0.45450955629348755
loss_pred:0.01920901983976364, decouple_loss:0.005151587538421154
The generated pressure mean: 0.4520956873893738
loss_pred:0.019519643858075142, decouple_loss:0.0051888879388570786
Iteration: 2244, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4601450264453888
loss_pred:0.019840074703097343, decouple_loss:0.005820653401315212
The generated pressure mean: 0.4609448313713074
loss_pred:0.01919989474117756, decouple_loss:0.005833118222653866
The generated pressure mean: 0.46328204870224
loss_pred:0.019905807450413704, decouple_loss:0.00593603728339076
Iteration: 2245, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.434591680765152
The generated pressure mean: 0.4359769821166992
loss_pred:0.019523780792951584, decouple_loss:0.005208785645663738
loss_pred:0.018728436902165413, decouple_loss:0.005396346095949411
The generated pressure mean: 0.4350493550300598
loss_pred:0.019438134506344795, decouple_loss:0.005224523134529591
Iteration: 2246, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44432148337364197
loss_pred:0.019245820119976997, decouple_loss:0.005951519124209881
The generated pressure mean: 0.4422370493412018
loss_pred:0.01987830549478531, decouple_loss:0.006084484979510307
The generated pressure mean: 0.44751232862472534
loss_pred:0.019254719838500023, decouple_loss:0.006154322065412998
Iteration: 2247, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45492032170295715
loss_pred:0.019038764759898186, decouple_loss:0.004999211523681879
The generated pressure mean: 0.4547358751296997
loss_pred:0.018670199438929558, decouple_loss:0.004855434875935316
The generated pressure mean: 0.4542308449745178
loss_pred:0.018816959112882614, decouple_loss:0.004912584088742733
Iteration: 2248, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44219309091567993The generated pressure mean: 0.44967421889305115
loss_pred:0.019215136766433716, decouple_loss:0.006345983128994703
loss_pred:0.01898142322897911, decouple_loss:0.006472181528806686
The generated pressure mean: 0.45246708393096924
loss_pred:0.019764455035328865, decouple_loss:0.006455299444496632
Iteration: 2249, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44150620698928833
loss_pred:0.01863683946430683, decouple_loss:0.005534633994102478
The generated pressure mean: 0.44020310044288635
loss_pred:0.019981665536761284, decouple_loss:0.0053282734006643295
The generated pressure mean: 0.44054993987083435
loss_pred:0.019086848944425583, decouple_loss:0.005617940332740545
Iteration: 2250, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4420965909957886
loss_pred:0.01997417025268078, decouple_loss:0.005572628695517778
The generated pressure mean: 0.45087093114852905
loss_pred:0.019574394449591637, decouple_loss:0.005669232923537493
The generated pressure mean: 0.4403834342956543
loss_pred:0.019930781796574593, decouple_loss:0.005703235976397991
2023-04-16 10:06:32 testing...
The generated pressure mean: 0.4148799180984497
loss_pred:0.03325459733605385, decouple_loss:0.005838240496814251
The generated pressure mean: 0.4241291284561157
loss_pred:0.0319146104156971, decouple_loss:0.005955585744231939
The generated pressure mean: 0.42768967151641846
loss_pred:0.03213172405958176, decouple_loss:0.006074211094528437
Loss: 0.032731447368860245, avg_mse: 0.04799629747867584
current test mse: 0.047996
Iteration: 2251, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45349469780921936
loss_pred:0.018692344427108765, decouple_loss:0.005440856330096722
The generated pressure mean: 0.457875519990921
loss_pred:0.0196997057646513, decouple_loss:0.005649778991937637
The generated pressure mean: 0.45148634910583496
loss_pred:0.0189625583589077, decouple_loss:0.005457765888422728
Iteration: 2252, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45559874176979065
loss_pred:0.019094832241535187, decouple_loss:0.005077584646642208
The generated pressure mean: 0.4543793499469757
loss_pred:0.019119931384921074, decouple_loss:0.005003063473850489
The generated pressure mean: 0.4495025873184204
loss_pred:0.02125384286046028, decouple_loss:0.0051269265823066235
Iteration: 2253, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4434012770652771
loss_pred:0.018677208572626114, decouple_loss:0.0056211440823972225
The generated pressure mean: 0.44076842069625854The generated pressure mean: 0.4409215450286865
loss_pred:0.01967366226017475, decouple_loss:0.005891680717468262
loss_pred:0.02039002627134323, decouple_loss:0.005717125255614519
Iteration: 2254, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4435437321662903
loss_pred:0.01872718334197998, decouple_loss:0.0053826081566512585
The generated pressure mean: 0.44497743248939514
loss_pred:0.018251070752739906, decouple_loss:0.005269280169159174
The generated pressure mean: 0.44677430391311646
loss_pred:0.019800668582320213, decouple_loss:0.005428719334304333
Iteration: 2255, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4472211003303528
loss_pred:0.0193999782204628, decouple_loss:0.006870918907225132
The generated pressure mean: 0.44383111596107483
loss_pred:0.020779315382242203, decouple_loss:0.0065268874168396
The generated pressure mean: 0.43494123220443726
loss_pred:0.01906341128051281, decouple_loss:0.00678767915815115
Iteration: 2256, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4573823809623718
loss_pred:0.021091140806674957, decouple_loss:0.005757279694080353
The generated pressure mean: 0.4594295918941498
loss_pred:0.02015199512243271, decouple_loss:0.005617878865450621
The generated pressure mean: 0.4559103548526764
loss_pred:0.01818394474685192, decouple_loss:0.005583629943430424
Iteration: 2257, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44577550888061523
loss_pred:0.020031917840242386, decouple_loss:0.006454240996390581
The generated pressure mean: 0.4529488682746887
loss_pred:0.01957102306187153, decouple_loss:0.006501181051135063
The generated pressure mean: 0.44923311471939087
loss_pred:0.020355943590402603, decouple_loss:0.006344073452055454
Iteration: 2258, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4380668103694916
loss_pred:0.02079584449529648, decouple_loss:0.005727289244532585
The generated pressure mean: 0.4377858340740204
loss_pred:0.019330453127622604, decouple_loss:0.005678032990545034
The generated pressure mean: 0.4439672827720642
loss_pred:0.019097410142421722, decouple_loss:0.005599586293101311
Iteration: 2259, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4502437114715576
loss_pred:0.020284533500671387, decouple_loss:0.005359842907637358
The generated pressure mean: 0.45007047057151794
loss_pred:0.01936817727982998, decouple_loss:0.005491954740136862
The generated pressure mean: 0.44915977120399475
loss_pred:0.019888510927557945, decouple_loss:0.0051262518391013145
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 2260, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44621479511260986
loss_pred:0.019436586648225784, decouple_loss:0.005845851730555296
The generated pressure mean: 0.4467752277851105
loss_pred:0.020151549950242043, decouple_loss:0.005998073611408472
The generated pressure mean: 0.44388148188591003
loss_pred:0.018548130989074707, decouple_loss:0.00593571038916707
2023-04-16 10:08:33 testing...
The generated pressure mean: 0.41547414660453796
loss_pred:0.03275857865810394, decouple_loss:0.005032594781368971
The generated pressure mean: 0.4234614670276642
loss_pred:0.03136053308844566, decouple_loss:0.0051812888123095036
The generated pressure mean: 0.42686527967453003
loss_pred:0.03147410601377487, decouple_loss:0.005325190257281065
Loss: 0.0321233868598938, avg_mse: 0.046822335571050644
current test mse: 0.046822
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012015_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012015_3_24hr.npz
NaN value num: 0
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 2261, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45155787467956543
loss_pred:0.02170264907181263, decouple_loss:0.004630613140761852
The generated pressure mean: 0.44865620136260986
loss_pred:0.019714439287781715, decouple_loss:0.004569296725094318
The generated pressure mean: 0.44624173641204834
loss_pred:0.01978105679154396, decouple_loss:0.004664585459977388
Iteration: 2262, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4431535005569458
loss_pred:0.02043840102851391, decouple_loss:0.005410840269178152
The generated pressure mean: 0.4423690140247345
loss_pred:0.02019128017127514, decouple_loss:0.005090230144560337
The generated pressure mean: 0.4405897259712219
loss_pred:0.020648924633860588, decouple_loss:0.005291118752211332
Iteration: 2263, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4457245469093323
loss_pred:0.020412061363458633, decouple_loss:0.004908462055027485
The generated pressure mean: 0.45451053977012634
loss_pred:0.020100196823477745, decouple_loss:0.004817538894712925
The generated pressure mean: 0.44162654876708984
loss_pred:0.020398525521159172, decouple_loss:0.004760810174047947
Iteration: 2264, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44959914684295654
loss_pred:0.020597536116838455, decouple_loss:0.004919080063700676
The generated pressure mean: 0.44796979427337646
loss_pred:0.020017027854919434, decouple_loss:0.005186139605939388
The generated pressure mean: 0.4471759796142578
loss_pred:0.01931924745440483, decouple_loss:0.004792872816324234
Iteration: 2265, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4438742399215698
loss_pred:0.02006980963051319, decouple_loss:0.0046387482434511185
The generated pressure mean: 0.4476391077041626
loss_pred:0.02182602696120739, decouple_loss:0.0048713176511228085
The generated pressure mean: 0.4400295913219452
loss_pred:0.018785327672958374, decouple_loss:0.004577147774398327
Iteration: 2266, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44436541199684143
loss_pred:0.020790858194231987, decouple_loss:0.005576819181442261
The generated pressure mean: 0.43981024622917175
loss_pred:0.01897873543202877, decouple_loss:0.005604987498372793
The generated pressure mean: 0.4401969313621521
loss_pred:0.020346704870462418, decouple_loss:0.005364155862480402
Iteration: 2267, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4454478621482849
loss_pred:0.01910092867910862, decouple_loss:0.005459371954202652
The generated pressure mean: 0.4469528794288635
loss_pred:0.020847732201218605, decouple_loss:0.0055967457592487335
The generated pressure mean: 0.44469162821769714
loss_pred:0.019772518426179886, decouple_loss:0.0053697023540735245
Iteration: 2268, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4588591158390045
loss_pred:0.019329693168401718, decouple_loss:0.0052350969053804874
The generated pressure mean: 0.45770391821861267
loss_pred:0.019935956224799156, decouple_loss:0.005278521217405796
The generated pressure mean: 0.45657485723495483
loss_pred:0.021167337894439697, decouple_loss:0.005368832964450121
Iteration: 2269, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4449712336063385
loss_pred:0.019743479788303375, decouple_loss:0.005589482374489307
The generated pressure mean: 0.43881848454475403
loss_pred:0.020498840138316154, decouple_loss:0.005632149055600166
The generated pressure mean: 0.4376471936702728
loss_pred:0.020925208926200867, decouple_loss:0.005742683541029692
Iteration: 2270, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43243589997291565
loss_pred:0.020393235608935356, decouple_loss:0.005756461527198553
The generated pressure mean: 0.43643462657928467
loss_pred:0.020511917769908905, decouple_loss:0.005646105390042067
The generated pressure mean: 0.43659067153930664
loss_pred:0.019804697483778, decouple_loss:0.0058021582663059235
2023-04-16 10:11:09 testing...
The generated pressure mean: 0.41550981998443604
loss_pred:0.03371194005012512, decouple_loss:0.005976120475679636
The generated pressure mean: 0.42556536197662354
loss_pred:0.03198692202568054, decouple_loss:0.0062310174107551575
The generated pressure mean: 0.42796626687049866
loss_pred:0.03249717876315117, decouple_loss:0.006223540287464857
Loss: 0.033039193600416183, avg_mse: 0.048491720110177994
current test mse: 0.048492
Iteration: 2271, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4563729763031006
loss_pred:0.02002115733921528, decouple_loss:0.005486439913511276
The generated pressure mean: 0.45566555857658386
loss_pred:0.02000100538134575, decouple_loss:0.005565947387367487
The generated pressure mean: 0.45131462812423706
loss_pred:0.01922796480357647, decouple_loss:0.005466364789754152
Iteration: 2272, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4522118866443634
loss_pred:0.019101640209555626, decouple_loss:0.006066509988158941
The generated pressure mean: 0.4500879645347595
loss_pred:0.020002037286758423, decouple_loss:0.006112192291766405
The generated pressure mean: 0.45047101378440857
loss_pred:0.019925575703382492, decouple_loss:0.006214182358235121
Iteration: 2273, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45008620619773865
loss_pred:0.019024822860956192, decouple_loss:0.005110483150929213
The generated pressure mean: 0.44987815618515015
loss_pred:0.020553169772028923, decouple_loss:0.0053262123838067055
The generated pressure mean: 0.44887879490852356
loss_pred:0.01971469447016716, decouple_loss:0.004972010850906372
Iteration: 2274, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4352929890155792
loss_pred:0.02040923573076725, decouple_loss:0.005439762491732836
The generated pressure mean: 0.4362701177597046
loss_pred:0.02008694037795067, decouple_loss:0.00572482543066144
The generated pressure mean: 0.4311678409576416
loss_pred:0.02056707814335823, decouple_loss:0.00557696633040905
Iteration: 2275, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43839675188064575
loss_pred:0.020064393058419228, decouple_loss:0.005294875241816044
The generated pressure mean: 0.4430602490901947
loss_pred:0.020231910049915314, decouple_loss:0.005194756202399731
The generated pressure mean: 0.44118770956993103
loss_pred:0.018758904188871384, decouple_loss:0.005103388801217079
Iteration: 2276, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45438313484191895
loss_pred:0.019998101517558098, decouple_loss:0.004943232983350754
The generated pressure mean: 0.4504386782646179
loss_pred:0.020670495927333832, decouple_loss:0.004970444831997156
The generated pressure mean: 0.44811004400253296
loss_pred:0.02007330395281315, decouple_loss:0.004903336521238089
Iteration: 2277, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4424305558204651
loss_pred:0.02001030556857586, decouple_loss:0.005590799264609814
The generated pressure mean: 0.44505253434181213
loss_pred:0.02195013500750065, decouple_loss:0.005432658828794956
The generated pressure mean: 0.4424848258495331
loss_pred:0.01988098956644535, decouple_loss:0.005247743800282478
Iteration: 2278, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45043930411338806
loss_pred:0.019328037276864052, decouple_loss:0.004059488885104656
The generated pressure mean: 0.44974738359451294
loss_pred:0.0194455124437809, decouple_loss:0.004105165600776672
The generated pressure mean: 0.4557110369205475
loss_pred:0.019913267344236374, decouple_loss:0.004203352611511946
Iteration: 2279, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45282259583473206
loss_pred:0.020089522004127502, decouple_loss:0.006007062271237373
The generated pressure mean: 0.4599957764148712
loss_pred:0.018909404054284096, decouple_loss:0.005908419378101826
The generated pressure mean: 0.4538212716579437
loss_pred:0.021808132529258728, decouple_loss:0.006020284723490477
Iteration: 2280, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4339686930179596
loss_pred:0.019056737422943115, decouple_loss:0.0055967895314097404
The generated pressure mean: 0.4342218339443207
loss_pred:0.01937217079102993, decouple_loss:0.005597773939371109
The generated pressure mean: 0.4304055869579315
loss_pred:0.019834352657198906, decouple_loss:0.00541337113827467
2023-04-16 10:13:10 testing...
The generated pressure mean: 0.42010414600372314
loss_pred:0.03441409021615982, decouple_loss:0.005321092437952757
The generated pressure mean: 0.4274634122848511
loss_pred:0.032196491956710815, decouple_loss:0.005576912313699722
The generated pressure mean: 0.4295980632305145
loss_pred:0.03338177874684334, decouple_loss:0.005635691341012716
Loss: 0.03360635042190552, avg_mse: 0.048048000782728195
current test mse: 0.048048
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012008_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012008_3_24hr.npz
NaN value num: 0
Iteration: 2281, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4369796812534332
loss_pred:0.01872251182794571, decouple_loss:0.005014178343117237
The generated pressure mean: 0.4402710199356079
loss_pred:0.017636191099882126, decouple_loss:0.005049697123467922
The generated pressure mean: 0.4432240128517151
loss_pred:0.018550746142864227, decouple_loss:0.004949337337166071
Iteration: 2282, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4548485279083252
The generated pressure mean: 0.4556034207344055
loss_pred:0.018210394307971, decouple_loss:0.005625938531011343
loss_pred:0.018968194723129272, decouple_loss:0.005533711519092321
The generated pressure mean: 0.4552289843559265
loss_pred:0.018920814618468285, decouple_loss:0.005426519084721804
Iteration: 2283, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4585249423980713
loss_pred:0.019963808357715607, decouple_loss:0.005240922328084707
The generated pressure mean: 0.4539961814880371
loss_pred:0.020642848685383797, decouple_loss:0.005328973289579153
The generated pressure mean: 0.45483535528182983
loss_pred:0.02024773694574833, decouple_loss:0.005335058085620403
Iteration: 2284, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.42948344349861145
loss_pred:0.019724400714039803, decouple_loss:0.0050591337494552135
The generated pressure mean: 0.4277907907962799
loss_pred:0.0191835705190897, decouple_loss:0.00484452536329627
The generated pressure mean: 0.4357098937034607
loss_pred:0.019314637407660484, decouple_loss:0.005015052389353514
Iteration: 2285, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44637009501457214
loss_pred:0.019826022908091545, decouple_loss:0.005229742266237736
The generated pressure mean: 0.4480111598968506
loss_pred:0.01896841824054718, decouple_loss:0.005223167594522238
The generated pressure mean: 0.44331979751586914
loss_pred:0.018556376919150352, decouple_loss:0.005209652706980705
Iteration: 2286, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4565596878528595
loss_pred:0.018206946551799774, decouple_loss:0.0049201794900000095
The generated pressure mean: 0.4559962749481201
loss_pred:0.019302543252706528, decouple_loss:0.004569495562463999
The generated pressure mean: 0.45795026421546936
loss_pred:0.018758270889520645, decouple_loss:0.004506409168243408
Iteration: 2287, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45543280243873596
loss_pred:0.019910648465156555, decouple_loss:0.004847935400903225
The generated pressure mean: 0.4528537094593048
loss_pred:0.018568161875009537, decouple_loss:0.00490355771034956
The generated pressure mean: 0.4529324769973755
loss_pred:0.019789882004261017, decouple_loss:0.004738732241094112
Iteration: 2288, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4374833405017853
loss_pred:0.018453022465109825, decouple_loss:0.0039544478058815
The generated pressure mean: 0.4344783127307892
loss_pred:0.017895778641104698, decouple_loss:0.003695168998092413
The generated pressure mean: 0.4396505653858185
loss_pred:0.019500184804201126, decouple_loss:0.004346339963376522
Iteration: 2289, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.448032945394516
loss_pred:0.019086096435785294, decouple_loss:0.004239894449710846
The generated pressure mean: 0.4470047056674957
loss_pred:0.01804850623011589, decouple_loss:0.004464486613869667
The generated pressure mean: 0.4424194097518921
loss_pred:0.019187413156032562, decouple_loss:0.004539042711257935
Iteration: 2290, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44211453199386597
loss_pred:0.019532304257154465, decouple_loss:0.005117564462125301
The generated pressure mean: 0.44420090317726135
loss_pred:0.01855640858411789, decouple_loss:0.005521630868315697
The generated pressure mean: 0.4460061490535736
loss_pred:0.01899276115000248, decouple_loss:0.005815559066832066
2023-04-16 10:15:46 testing...
The generated pressure mean: 0.41530218720436096
loss_pred:0.03361361846327782, decouple_loss:0.006838371977210045
The generated pressure mean: 0.4226023256778717
loss_pred:0.03240051865577698, decouple_loss:0.0068519385531544685
The generated pressure mean: 0.42537054419517517
loss_pred:0.03245792165398598, decouple_loss:0.0070610386319458485
Loss: 0.03316987678408623, avg_mse: 0.047996845096349716
current test mse: 0.047997
Iteration: 2291, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45934849977493286
loss_pred:0.023524193093180656, decouple_loss:0.006091962102800608
The generated pressure mean: 0.4551562964916229
loss_pred:0.018612753599882126, decouple_loss:0.006425146944820881
The generated pressure mean: 0.4591771364212036
loss_pred:0.02064380794763565, decouple_loss:0.006216231733560562
Iteration: 2292, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4300684630870819
loss_pred:0.02049218863248825, decouple_loss:0.006168856285512447
The generated pressure mean: 0.4314732849597931
loss_pred:0.01973567344248295, decouple_loss:0.006043864414095879
The generated pressure mean: 0.42681434750556946
loss_pred:0.020768309012055397, decouple_loss:0.005976069252938032
Iteration: 2293, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4648534059524536
loss_pred:0.0210409052670002, decouple_loss:0.006495367735624313
The generated pressure mean: 0.4731215536594391
loss_pred:0.020530108362436295, decouple_loss:0.006665561813861132
The generated pressure mean: 0.4666956067085266
loss_pred:0.01953982189297676, decouple_loss:0.006339458283036947
Iteration: 2294, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44842880964279175
loss_pred:0.020505281165242195, decouple_loss:0.00771108316257596
The generated pressure mean: 0.4494698643684387
loss_pred:0.02084950916469097, decouple_loss:0.007657403592020273
The generated pressure mean: 0.4463561475276947
loss_pred:0.019844232127070427, decouple_loss:0.007698610424995422
Iteration: 2295, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.42175236344337463
loss_pred:0.019691122695803642, decouple_loss:0.005505397450178862
The generated pressure mean: 0.42322391271591187
loss_pred:0.01955401338636875, decouple_loss:0.005633374210447073
The generated pressure mean: 0.4241126775741577
loss_pred:0.02049623616039753, decouple_loss:0.005554230883717537
Iteration: 2296, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.48059818148612976
loss_pred:0.01984422281384468, decouple_loss:0.006153183989226818
The generated pressure mean: 0.47640958428382874
loss_pred:0.021034013479948044, decouple_loss:0.006574177648872137
The generated pressure mean: 0.4809948801994324
loss_pred:0.02128179930150509, decouple_loss:0.0062535288743674755
Iteration: 2297, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4343222379684448
loss_pred:0.018791303038597107, decouple_loss:0.006573584396392107
The generated pressure mean: 0.43795642256736755
loss_pred:0.020413201302289963, decouple_loss:0.006404441315680742
The generated pressure mean: 0.44005048274993896
loss_pred:0.020475545898079872, decouple_loss:0.006937534082680941
Iteration: 2298, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.42690756916999817
loss_pred:0.02309941127896309, decouple_loss:0.010716613382101059
The generated pressure mean: 0.42882636189460754
loss_pred:0.021162917837500572, decouple_loss:0.010218475013971329
The generated pressure mean: 0.4289591610431671
loss_pred:0.02091309428215027, decouple_loss:0.010732823051512241
Iteration: 2299, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4765673577785492
loss_pred:0.024243729189038277, decouple_loss:0.0149149838835001
The generated pressure mean: 0.47656670212745667
loss_pred:0.024534879252314568, decouple_loss:0.015098330564796925
The generated pressure mean: 0.4761422276496887
loss_pred:0.024916276335716248, decouple_loss:0.015051622875034809
Iteration: 2300, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4607771337032318
loss_pred:0.026523146778345108, decouple_loss:0.01676841266453266
The generated pressure mean: 0.4615069031715393
loss_pred:0.028748629614710808, decouple_loss:0.016978386789560318
The generated pressure mean: 0.463618665933609
loss_pred:0.02656022273004055, decouple_loss:0.01703697443008423
2023-04-16 10:17:47 testing...
The generated pressure mean: 0.4155954122543335
loss_pred:0.0376066230237484, decouple_loss:0.013616429641842842
The generated pressure mean: 0.4204806983470917
loss_pred:0.03627726808190346, decouple_loss:0.013695829547941685
The generated pressure mean: 0.4223441183567047
loss_pred:0.03659600019454956, decouple_loss:0.013709562830626965
Loss: 0.037510331720113754, avg_mse: 0.050978854298591614
current test mse: 0.050979
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012016_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012016_3_24hr.npz
NaN value num: 0
Iteration: 2301, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44603124260902405
loss_pred:0.02718690223991871, decouple_loss:0.013336364179849625
The generated pressure mean: 0.44383490085601807
loss_pred:0.024882720783352852, decouple_loss:0.013215212151408195
The generated pressure mean: 0.444160521030426
loss_pred:0.024718649685382843, decouple_loss:0.013292577117681503
Iteration: 2302, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4277077317237854
loss_pred:0.02610418200492859, decouple_loss:0.016062237322330475
The generated pressure mean: 0.43433257937431335
loss_pred:0.02535834163427353, decouple_loss:0.016005437821149826
The generated pressure mean: 0.43178102374076843
loss_pred:0.02858978696167469, decouple_loss:0.015986395999789238
Iteration: 2303, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4189454913139343
loss_pred:0.02470245212316513, decouple_loss:0.015372669324278831
The generated pressure mean: 0.41926437616348267
The generated pressure mean: 0.4166213274002075
loss_pred:0.02596481330692768, decouple_loss:0.015473120845854282
loss_pred:0.026488589122891426, decouple_loss:0.015210147015750408
Iteration: 2304, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.47688814997673035
loss_pred:0.026255885139107704, decouple_loss:0.015120994299650192
The generated pressure mean: 0.47573813796043396
loss_pred:0.02492712438106537, decouple_loss:0.014745265245437622
The generated pressure mean: 0.47816210985183716
loss_pred:0.024537967517971992, decouple_loss:0.014836953021585941
Iteration: 2305, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4379149079322815
loss_pred:0.025076156482100487, decouple_loss:0.01648556813597679
The generated pressure mean: 0.4403010904788971
loss_pred:0.025058221071958542, decouple_loss:0.016424160450696945
The generated pressure mean: 0.44151490926742554
loss_pred:0.024812625721096992, decouple_loss:0.01670624315738678
Iteration: 2306, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4249229431152344
loss_pred:0.02491999976336956, decouple_loss:0.015785427764058113
The generated pressure mean: 0.4288928508758545
loss_pred:0.02438404969871044, decouple_loss:0.015997521579265594
The generated pressure mean: 0.4257189929485321
loss_pred:0.024229925125837326, decouple_loss:0.015842461958527565
Iteration: 2307, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4486955404281616
loss_pred:0.02532961219549179, decouple_loss:0.016977664083242416
The generated pressure mean: 0.4457412362098694
loss_pred:0.025483349338173866, decouple_loss:0.017013080418109894
The generated pressure mean: 0.4497918486595154
loss_pred:0.02429812401533127, decouple_loss:0.017220767214894295
Iteration: 2308, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45713359117507935
The generated pressure mean: 0.459721177816391loss_pred:0.02390509471297264, decouple_loss:0.015367533080279827
loss_pred:0.023237621411681175, decouple_loss:0.0159489493817091
The generated pressure mean: 0.4614107310771942
loss_pred:0.026340408250689507, decouple_loss:0.015798181295394897
Iteration: 2309, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4518646001815796
loss_pred:0.027264386415481567, decouple_loss:0.019045675173401833
The generated pressure mean: 0.44973865151405334
loss_pred:0.025885559618473053, decouple_loss:0.019578032195568085
The generated pressure mean: 0.4516560137271881
loss_pred:0.027017872780561447, decouple_loss:0.01904330588877201
Iteration: 2310, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43953558802604675
loss_pred:0.029497897252440453, decouple_loss:0.02167217805981636
The generated pressure mean: 0.439494788646698
loss_pred:0.027274131774902344, decouple_loss:0.0215627271682024
The generated pressure mean: 0.44086092710494995
loss_pred:0.02603878080844879, decouple_loss:0.02157098613679409
2023-04-16 10:20:31 testing...
The generated pressure mean: 0.4087830185890198
loss_pred:0.049216486513614655, decouple_loss:0.022247910499572754
The generated pressure mean: 0.4139101505279541
loss_pred:0.04985464736819267, decouple_loss:0.022615903988480568
The generated pressure mean: 0.4173794090747833
loss_pred:0.04955936595797539, decouple_loss:0.022357117384672165
Loss: 0.05066385120153427, avg_mse: 0.07922056317329407
current test mse: 0.079221
Iteration: 2311, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4763534367084503
The generated pressure mean: 0.48074790835380554
loss_pred:0.027507634833455086, decouple_loss:0.02031848207116127
loss_pred:0.0277016069740057, decouple_loss:0.019692478701472282
The generated pressure mean: 0.4776608347892761
loss_pred:0.03003445640206337, decouple_loss:0.020369036123156548
Iteration: 2312, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44061633944511414
The generated pressure mean: 0.44031375646591187
loss_pred:0.02536454051733017, decouple_loss:0.017768487334251404
loss_pred:0.025017037987709045, decouple_loss:0.01733526401221752
The generated pressure mean: 0.4407194256782532
loss_pred:0.025013361126184464, decouple_loss:0.01777869090437889
Iteration: 2313, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.42724844813346863
loss_pred:0.025270167738199234, decouple_loss:0.024634329602122307
The generated pressure mean: 0.426856130361557
loss_pred:0.024848878383636475, decouple_loss:0.023997027426958084
The generated pressure mean: 0.4243863523006439
loss_pred:0.023855481296777725, decouple_loss:0.023813636973500252
Iteration: 2314, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4370666444301605
loss_pred:0.024587100371718407, decouple_loss:0.022165389731526375
The generated pressure mean: 0.4357783794403076
loss_pred:0.024750836193561554, decouple_loss:0.022189311683177948
The generated pressure mean: 0.43678924441337585
loss_pred:0.022691605612635612, decouple_loss:0.02246381901204586
Iteration: 2315, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46345359086990356
loss_pred:0.02692124992609024, decouple_loss:0.018394354730844498
The generated pressure mean: 0.4660499691963196
loss_pred:0.023541059345006943, decouple_loss:0.018260598182678223
The generated pressure mean: 0.46519044041633606
loss_pred:0.02703513763844967, decouple_loss:0.01820378750562668
Iteration: 2316, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45161202549934387
loss_pred:0.02259002812206745, decouple_loss:0.016608892008662224
The generated pressure mean: 0.4542526602745056
loss_pred:0.024225985631346703, decouple_loss:0.01665153168141842
The generated pressure mean: 0.4539470076560974
loss_pred:0.02527741529047489, decouple_loss:0.016694195568561554
Iteration: 2317, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43302643299102783
loss_pred:0.02315189130604267, decouple_loss:0.014803814701735973
The generated pressure mean: 0.42776358127593994
loss_pred:0.023464404046535492, decouple_loss:0.014835377223789692
The generated pressure mean: 0.43163952231407166
loss_pred:0.022839834913611412, decouple_loss:0.014725150540471077
Iteration: 2318, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44245338439941406
loss_pred:0.023220954462885857, decouple_loss:0.01351096760481596
The generated pressure mean: 0.4383547008037567
loss_pred:0.02251201868057251, decouple_loss:0.01371845230460167
The generated pressure mean: 0.43937167525291443
loss_pred:0.024517865851521492, decouple_loss:0.013737746514379978
Iteration: 2319, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46079403162002563
loss_pred:0.022915206849575043, decouple_loss:0.013130654580891132
The generated pressure mean: 0.46329620480537415
loss_pred:0.02161988988518715, decouple_loss:0.013258685357868671
The generated pressure mean: 0.46295469999313354
loss_pred:0.02232004888355732, decouple_loss:0.013240618631243706
Iteration: 2320, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4549674987792969
loss_pred:0.02166939340531826, decouple_loss:0.013169706799089909
The generated pressure mean: 0.45321235060691833
loss_pred:0.021840857341885567, decouple_loss:0.013438706286251545
The generated pressure mean: 0.4532569348812103
loss_pred:0.02509400062263012, decouple_loss:0.013590283691883087
2023-04-16 10:22:32 testing...
The generated pressure mean: 0.41935428977012634
loss_pred:0.036153778433799744, decouple_loss:0.012857037596404552
The generated pressure mean: 0.4268750846385956
loss_pred:0.03559816628694534, decouple_loss:0.013039919547736645
The generated pressure mean: 0.4299280643463135
loss_pred:0.03614148870110512, decouple_loss:0.013221686705946922
Loss: 0.036616455763578415, avg_mse: 0.052579011768102646
current test mse: 0.052579
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012002_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012002_3_24hr.npz
NaN value num: 0
Iteration: 2321, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4387339651584625
loss_pred:0.02138160727918148, decouple_loss:0.012858296744525433
The generated pressure mean: 0.43894919753074646
loss_pred:0.02197105437517166, decouple_loss:0.013742738403379917
The generated pressure mean: 0.4450739026069641
loss_pred:0.021756811067461967, decouple_loss:0.012547933496534824
Iteration: 2322, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.42836445569992065
loss_pred:0.020964588969945908, decouple_loss:0.01446150429546833
The generated pressure mean: 0.4337804615497589
loss_pred:0.021386129781603813, decouple_loss:0.01431905385106802
The generated pressure mean: 0.42956677079200745
loss_pred:0.021087775006890297, decouple_loss:0.014496486634016037
Iteration: 2323, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44551560282707214
loss_pred:0.021730605512857437, decouple_loss:0.012062146328389645
The generated pressure mean: 0.4457888901233673
loss_pred:0.01829722709953785, decouple_loss:0.011838199570775032
The generated pressure mean: 0.4440852999687195
loss_pred:0.023284150287508965, decouple_loss:0.01190148200839758
Iteration: 2324, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4629955291748047
loss_pred:0.021466203033924103, decouple_loss:0.013240986503660679
The generated pressure mean: 0.4627557098865509
loss_pred:0.019950103014707565, decouple_loss:0.01300160214304924
The generated pressure mean: 0.4643036723136902
loss_pred:0.021453097462654114, decouple_loss:0.013041392900049686
Iteration: 2325, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44333189725875854
loss_pred:0.022096935659646988, decouple_loss:0.011930410750210285
The generated pressure mean: 0.44156455993652344
loss_pred:0.020496690645813942, decouple_loss:0.01191619597375393
The generated pressure mean: 0.440211683511734
loss_pred:0.020892955362796783, decouple_loss:0.01197234820574522
Iteration: 2326, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4331109821796417
loss_pred:0.021295832470059395, decouple_loss:0.010897780768573284
The generated pressure mean: 0.4320155084133148
loss_pred:0.021557670086622238, decouple_loss:0.010443015024065971
The generated pressure mean: 0.4301867187023163
loss_pred:0.021052591502666473, decouple_loss:0.010641410946846008
Iteration: 2327, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4629386067390442
loss_pred:0.020281216129660606, decouple_loss:0.011056625284254551
The generated pressure mean: 0.46051734685897827
loss_pred:0.018317775800824165, decouple_loss:0.011104005388915539
The generated pressure mean: 0.4581197500228882
loss_pred:0.022187480702996254, decouple_loss:0.011537156999111176
Iteration: 2328, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4460914134979248
loss_pred:0.020771360024809837, decouple_loss:0.013623344711959362
The generated pressure mean: 0.4458500146865845
loss_pred:0.02186354622244835, decouple_loss:0.015222059562802315
The generated pressure mean: 0.4533405005931854
loss_pred:0.021054858341813087, decouple_loss:0.013762605376541615
Iteration: 2329, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46189355850219727
loss_pred:0.022075841203331947, decouple_loss:0.016595179215073586
The generated pressure mean: 0.4665842652320862
loss_pred:0.024198010563850403, decouple_loss:0.017236534506082535
The generated pressure mean: 0.4662541151046753
loss_pred:0.02168610878288746, decouple_loss:0.016243640333414078
Iteration: 2330, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43147990107536316
loss_pred:0.02430868335068226, decouple_loss:0.019439948722720146
The generated pressure mean: 0.4230070114135742
loss_pred:0.020998109132051468, decouple_loss:0.018763137981295586
The generated pressure mean: 0.4252151548862457
loss_pred:0.020974138751626015, decouple_loss:0.018903948366642
2023-04-16 10:25:09 testing...
The generated pressure mean: 0.41451361775398254
loss_pred:0.03623726963996887, decouple_loss:0.015836644917726517
The generated pressure mean: 0.42109689116477966
loss_pred:0.03436024487018585, decouple_loss:0.015905944630503654
The generated pressure mean: 0.42374658584594727
loss_pred:0.03548189625144005, decouple_loss:0.016054784879088402
Loss: 0.03615643084049225, avg_mse: 0.05046016722917557
current test mse: 0.05046
Iteration: 2331, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4468543231487274
loss_pred:0.02104409784078598, decouple_loss:0.01629713736474514
The generated pressure mean: 0.44507068395614624
loss_pred:0.021350447088479996, decouple_loss:0.016420813277363777
The generated pressure mean: 0.44646400213241577
loss_pred:0.02144966647028923, decouple_loss:0.01631608046591282
Iteration: 2332, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4682665169239044
The generated pressure mean: 0.46119797229766846
loss_pred:0.021710125729441643, decouple_loss:0.013136482797563076
loss_pred:0.02088177762925625, decouple_loss:0.013439993374049664
The generated pressure mean: 0.4610741138458252
loss_pred:0.020180517807602882, decouple_loss:0.013427185826003551
Iteration: 2333, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4643228054046631
loss_pred:0.022189117968082428, decouple_loss:0.016330933198332787
The generated pressure mean: 0.45964154601097107
loss_pred:0.022061316296458244, decouple_loss:0.0160866379737854
The generated pressure mean: 0.46130189299583435
loss_pred:0.023016706109046936, decouple_loss:0.016179615631699562
Iteration: 2334, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4248533546924591
loss_pred:0.02052200771868229, decouple_loss:0.011909774504601955
The generated pressure mean: 0.43112367391586304
loss_pred:0.020373418927192688, decouple_loss:0.012053809128701687
The generated pressure mean: 0.4258776605129242
loss_pred:0.021787865087389946, decouple_loss:0.011864048428833485
Iteration: 2335, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4238635301589966
The generated pressure mean: 0.4218897819519043loss_pred:0.02056283876299858, decouple_loss:0.011550679802894592
loss_pred:0.020088067278265953, decouple_loss:0.011967533268034458
The generated pressure mean: 0.41987186670303345
loss_pred:0.019285842776298523, decouple_loss:0.011730226688086987
Iteration: 2336, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45039185881614685
loss_pred:0.020245488733053207, decouple_loss:0.011391941457986832
The generated pressure mean: 0.4468180537223816
loss_pred:0.02160845510661602, decouple_loss:0.011433174833655357
The generated pressure mean: 0.445024311542511
loss_pred:0.019839173182845116, decouple_loss:0.011429240927100182
Iteration: 2337, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.48096764087677
loss_pred:0.019234811887145042, decouple_loss:0.011036940850317478
The generated pressure mean: 0.48232656717300415
loss_pred:0.02086123637855053, decouple_loss:0.01097305491566658
The generated pressure mean: 0.4811656177043915
loss_pred:0.020704155787825584, decouple_loss:0.011051086708903313
Iteration: 2338, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45995309948921204
loss_pred:0.020611580461263657, decouple_loss:0.01210072636604309
The generated pressure mean: 0.4684336185455322
loss_pred:0.021752802655100822, decouple_loss:0.011841950006783009
The generated pressure mean: 0.4636231064796448
loss_pred:0.021460307762026787, decouple_loss:0.012081518769264221
Iteration: 2339, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43434086441993713
The generated pressure mean: 0.4354593753814697
loss_pred:0.022756710648536682, decouple_loss:0.009935582056641579
loss_pred:0.02230667881667614, decouple_loss:0.010495934635400772
The generated pressure mean: 0.4373529553413391
loss_pred:0.022321181371808052, decouple_loss:0.010243983007967472
Iteration: 2340, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43034765124320984
loss_pred:0.0216930340975523, decouple_loss:0.012081006541848183
The generated pressure mean: 0.43139636516571045
loss_pred:0.02033468522131443, decouple_loss:0.011765789240598679
The generated pressure mean: 0.4297904372215271
loss_pred:0.02074056677520275, decouple_loss:0.011524684727191925
2023-04-16 10:27:10 testing...
The generated pressure mean: 0.42030438780784607
loss_pred:0.0386243537068367, decouple_loss:0.009654470719397068
The generated pressure mean: 0.4266042709350586
loss_pred:0.03764535114169121, decouple_loss:0.00990346074104309
The generated pressure mean: 0.42833513021469116
loss_pred:0.038642819970846176, decouple_loss:0.010069179348647594
Loss: 0.03879795968532562, avg_mse: 0.05682957544922829
current test mse: 0.05683
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012010_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012010_3_24hr.npz
NaN value num: 0
Iteration: 2341, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.42676210403442383
loss_pred:0.021428845822811127, decouple_loss:0.009540801867842674
The generated pressure mean: 0.4284190535545349
loss_pred:0.023181937634944916, decouple_loss:0.009766236878931522
The generated pressure mean: 0.43109750747680664
loss_pred:0.022415639832615852, decouple_loss:0.009296734817326069
Iteration: 2342, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45718592405319214
The generated pressure mean: 0.4578437805175781
loss_pred:0.019700326025485992, decouple_loss:0.009360788390040398
loss_pred:0.021765923127532005, decouple_loss:0.009604287333786488
The generated pressure mean: 0.45801785588264465
loss_pred:0.020738469436764717, decouple_loss:0.009476866573095322
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 2343, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46585986018180847
loss_pred:0.020602155476808548, decouple_loss:0.009320830926299095
The generated pressure mean: 0.462141752243042
The generated pressure mean: 0.4624881148338318
loss_pred:0.02259867824614048, decouple_loss:0.009291861206293106
loss_pred:0.02080819383263588, decouple_loss:0.009314339607954025
Iteration: 2344, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43765655159950256
The generated pressure mean: 0.4443877041339874
loss_pred:0.02079678326845169, decouple_loss:0.009792436845600605
loss_pred:0.02015216276049614, decouple_loss:0.009543239139020443
The generated pressure mean: 0.44548603892326355
loss_pred:0.022322462871670723, decouple_loss:0.009676971472799778
Iteration: 2345, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.42909204959869385
loss_pred:0.01869172230362892, decouple_loss:0.009252585470676422
The generated pressure mean: 0.42938515543937683
loss_pred:0.020613139495253563, decouple_loss:0.009496781975030899
The generated pressure mean: 0.4280124008655548
loss_pred:0.02061440609395504, decouple_loss:0.009605302475392818
Iteration: 2346, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44593894481658936
loss_pred:0.020504895597696304, decouple_loss:0.00912500824779272
The generated pressure mean: 0.44108712673187256
loss_pred:0.020913107320666313, decouple_loss:0.009249820373952389
The generated pressure mean: 0.43979111313819885
loss_pred:0.02103499136865139, decouple_loss:0.009191364049911499
Iteration: 2347, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45534953474998474
loss_pred:0.020887253805994987, decouple_loss:0.008355331607162952
The generated pressure mean: 0.4549751281738281
loss_pred:0.020054632797837257, decouple_loss:0.008597233332693577
The generated pressure mean: 0.45869043469429016
loss_pred:0.022389080375432968, decouple_loss:0.008333506993949413
Iteration: 2348, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4505382478237152
loss_pred:0.02102692984044552, decouple_loss:0.009051133878529072
The generated pressure mean: 0.4488883316516876
loss_pred:0.019691016525030136, decouple_loss:0.00929438229650259
The generated pressure mean: 0.4494974911212921
loss_pred:0.021365977823734283, decouple_loss:0.00944983959197998
Iteration: 2349, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43946370482444763
loss_pred:0.020610330626368523, decouple_loss:0.008881134912371635
The generated pressure mean: 0.4391302466392517
loss_pred:0.020422443747520447, decouple_loss:0.00891607254743576
The generated pressure mean: 0.4379482865333557
loss_pred:0.020127829164266586, decouple_loss:0.008695151656866074
Iteration: 2350, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4519501328468323
loss_pred:0.022042283788323402, decouple_loss:0.010846836492419243
The generated pressure mean: 0.4551016390323639
loss_pred:0.019764596596360207, decouple_loss:0.010601327754557133
The generated pressure mean: 0.4503750205039978
loss_pred:0.02125953882932663, decouple_loss:0.010724809020757675
2023-04-16 10:29:47 testing...
The generated pressure mean: 0.4164130985736847
loss_pred:0.03457295894622803, decouple_loss:0.00923161394894123
The generated pressure mean: 0.42479974031448364
loss_pred:0.03310733288526535, decouple_loss:0.009318945929408073
The generated pressure mean: 0.42726272344589233
loss_pred:0.03316863253712654, decouple_loss:0.009534488432109356
Loss: 0.034084394574165344, avg_mse: 0.04907858371734619
current test mse: 0.049079
Iteration: 2351, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45001134276390076
loss_pred:0.020629044622182846, decouple_loss:0.008955246768891811
The generated pressure mean: 0.45034149289131165
loss_pred:0.020666081458330154, decouple_loss:0.008846013806760311
The generated pressure mean: 0.45133668184280396
loss_pred:0.019539322704076767, decouple_loss:0.00884079746901989
Iteration: 2352, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43225789070129395
loss_pred:0.021140873432159424, decouple_loss:0.008411925286054611
The generated pressure mean: 0.43628573417663574
loss_pred:0.02020389772951603, decouple_loss:0.00851950328797102
The generated pressure mean: 0.43352141976356506
loss_pred:0.021418143063783646, decouple_loss:0.008582077920436859
Iteration: 2353, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.445472776889801
loss_pred:0.020696165040135384, decouple_loss:0.008404257707297802
The generated pressure mean: 0.4493003189563751
loss_pred:0.019651811569929123, decouple_loss:0.008200463838875294
The generated pressure mean: 0.4482121467590332
loss_pred:0.021372642368078232, decouple_loss:0.00849237572401762
Iteration: 2354, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45459508895874023
loss_pred:0.02195293828845024, decouple_loss:0.007426947820931673
The generated pressure mean: 0.44808849692344666
loss_pred:0.018943937495350838, decouple_loss:0.007381886709481478
The generated pressure mean: 0.4490906298160553
loss_pred:0.01933382824063301, decouple_loss:0.0076914625242352486
Iteration: 2355, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4454439878463745
loss_pred:0.018509432673454285, decouple_loss:0.009165898896753788
The generated pressure mean: 0.4438164532184601
loss_pred:0.020966731011867523, decouple_loss:0.009044750593602657
The generated pressure mean: 0.44621315598487854
loss_pred:0.01971610076725483, decouple_loss:0.009292952716350555
Iteration: 2356, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45487454533576965
loss_pred:0.020289044827222824, decouple_loss:0.0072340150363743305
The generated pressure mean: 0.4551573395729065
loss_pred:0.019793927669525146, decouple_loss:0.007093736436218023
The generated pressure mean: 0.4546573758125305
loss_pred:0.021367687731981277, decouple_loss:0.007137298583984375
Iteration: 2357, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.434869647026062
loss_pred:0.020260242745280266, decouple_loss:0.007155786734074354
The generated pressure mean: 0.438018798828125
loss_pred:0.02070271410048008, decouple_loss:0.0072241551242768764
The generated pressure mean: 0.43385326862335205
loss_pred:0.020494192838668823, decouple_loss:0.007277829572558403
Iteration: 2358, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4390632212162018
loss_pred:0.020570479333400726, decouple_loss:0.007451470475643873
The generated pressure mean: 0.43858084082603455
loss_pred:0.01945161074399948, decouple_loss:0.007456830702722073
The generated pressure mean: 0.4420827031135559
loss_pred:0.02093360759317875, decouple_loss:0.007394155487418175
Iteration: 2359, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45564281940460205
loss_pred:0.01861610636115074, decouple_loss:0.006633582524955273
The generated pressure mean: 0.4580627977848053
loss_pred:0.019589869305491447, decouple_loss:0.006683989893645048
The generated pressure mean: 0.45986124873161316
loss_pred:0.019512219354510307, decouple_loss:0.006743767764419317
Iteration: 2360, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45490536093711853
loss_pred:0.02024468034505844, decouple_loss:0.006945070810616016
The generated pressure mean: 0.452644407749176
loss_pred:0.018879670649766922, decouple_loss:0.006808770354837179
The generated pressure mean: 0.45550107955932617
loss_pred:0.019268004223704338, decouple_loss:0.006782462354749441
2023-04-16 10:31:48 testing...
The generated pressure mean: 0.4200790226459503
loss_pred:0.033508650958538055, decouple_loss:0.0070022596046328545
The generated pressure mean: 0.4267014265060425
loss_pred:0.0330597348511219, decouple_loss:0.007172348443418741
The generated pressure mean: 0.4301895201206207
loss_pred:0.03305889293551445, decouple_loss:0.007334280759096146
Loss: 0.033567577600479126, avg_mse: 0.048817865550518036
current test mse: 0.048818
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012006_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012006_3_24hr.npz
NaN value num: 0
Iteration: 2361, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4399442672729492
loss_pred:0.0202022697776556, decouple_loss:0.006647100672125816
The generated pressure mean: 0.44215357303619385
loss_pred:0.01899266242980957, decouple_loss:0.0064378161914646626
The generated pressure mean: 0.4421783983707428
loss_pred:0.019409513100981712, decouple_loss:0.006933283060789108
Iteration: 2362, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4317857027053833
loss_pred:0.02124289609491825, decouple_loss:0.00642624543979764
The generated pressure mean: 0.4317471981048584
loss_pred:0.022214435040950775, decouple_loss:0.006216493435204029
The generated pressure mean: 0.4335593283176422
loss_pred:0.019016532227396965, decouple_loss:0.006304757669568062
Iteration: 2363, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44142523407936096
loss_pred:0.0194051805883646, decouple_loss:0.0065714395605027676
The generated pressure mean: 0.43936172127723694
loss_pred:0.019337289035320282, decouple_loss:0.006303723435848951
The generated pressure mean: 0.43927815556526184
loss_pred:0.019822552800178528, decouple_loss:0.006151210982352495
Iteration: 2364, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4656672179698944
loss_pred:0.02013154700398445, decouple_loss:0.005909278057515621
The generated pressure mean: 0.464652955532074
loss_pred:0.019627317786216736, decouple_loss:0.005777982994914055
The generated pressure mean: 0.46400904655456543
loss_pred:0.020580541342496872, decouple_loss:0.005938938353210688
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 2365, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4523718059062958
loss_pred:0.02058027870953083, decouple_loss:0.006810811813920736
The generated pressure mean: 0.44995740056037903
loss_pred:0.01965554803609848, decouple_loss:0.0067613739520311356
The generated pressure mean: 0.45240381360054016
loss_pred:0.021026745438575745, decouple_loss:0.006671492010354996
Iteration: 2366, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4373883008956909
loss_pred:0.018294494599103928, decouple_loss:0.005425977986305952
The generated pressure mean: 0.4363061189651489
loss_pred:0.01935957558453083, decouple_loss:0.005411316640675068
The generated pressure mean: 0.43342897295951843
loss_pred:0.020401809364557266, decouple_loss:0.0052788229659199715
Iteration: 2367, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44043248891830444
The generated pressure mean: 0.4448010325431824loss_pred:0.018622325733304024, decouple_loss:0.005873436573892832
loss_pred:0.021160556003451347, decouple_loss:0.006118315272033215
The generated pressure mean: 0.43963876366615295
loss_pred:0.021864568814635277, decouple_loss:0.005938340909779072
Iteration: 2368, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44960808753967285
loss_pred:0.020446522161364555, decouple_loss:0.006779470946639776
The generated pressure mean: 0.4541532099246979
loss_pred:0.020210927352309227, decouple_loss:0.007040797267109156
The generated pressure mean: 0.4534815549850464
loss_pred:0.0211789570748806, decouple_loss:0.006882081273943186
Iteration: 2369, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4461958110332489
loss_pred:0.01914372481405735, decouple_loss:0.006016086786985397
The generated pressure mean: 0.44758111238479614
loss_pred:0.019375037401914597, decouple_loss:0.006353050470352173
The generated pressure mean: 0.4534584581851959
loss_pred:0.01974216289818287, decouple_loss:0.006334172561764717
Iteration: 2370, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4522104859352112
loss_pred:0.01893908530473709, decouple_loss:0.00878058560192585
The generated pressure mean: 0.45355674624443054
loss_pred:0.022419819608330727, decouple_loss:0.008769349195063114
The generated pressure mean: 0.4437684714794159
loss_pred:0.019176829606294632, decouple_loss:0.009177878499031067
2023-04-16 10:34:36 testing...
The generated pressure mean: 0.4189161956310272
loss_pred:0.0332021601498127, decouple_loss:0.008074508979916573
The generated pressure mean: 0.4253690242767334
loss_pred:0.032615941017866135, decouple_loss:0.008361023850739002
The generated pressure mean: 0.42904528975486755
loss_pred:0.03203572332859039, decouple_loss:0.008410187438130379
Loss: 0.03303204104304314, avg_mse: 0.04757780209183693
current test mse: 0.047578
Iteration: 2371, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44392916560173035
loss_pred:0.01980949379503727, decouple_loss:0.007521110586822033
The generated pressure mean: 0.4442082643508911
loss_pred:0.01909414306282997, decouple_loss:0.007865260355174541
The generated pressure mean: 0.43952441215515137
loss_pred:0.018935097381472588, decouple_loss:0.007584747858345509
Iteration: 2372, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43359652161598206
loss_pred:0.019767431542277336, decouple_loss:0.006076734513044357
The generated pressure mean: 0.43559131026268005
loss_pred:0.0206722654402256, decouple_loss:0.005844872910529375
The generated pressure mean: 0.4405345022678375
loss_pred:0.02246169000864029, decouple_loss:0.005921792238950729
Iteration: 2373, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44275346398353577
loss_pred:0.019444260746240616, decouple_loss:0.006779771763831377
The generated pressure mean: 0.44569963216781616
loss_pred:0.018881909549236298, decouple_loss:0.006428949069231749
The generated pressure mean: 0.4477250874042511
loss_pred:0.0197805967181921, decouple_loss:0.0064093549735844135
Iteration: 2374, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45458105206489563
loss_pred:0.018891457468271255, decouple_loss:0.005680305417627096
The generated pressure mean: 0.4534318447113037
loss_pred:0.01953285001218319, decouple_loss:0.005639150273054838
The generated pressure mean: 0.45438385009765625
loss_pred:0.01979040913283825, decouple_loss:0.005883513949811459
Iteration: 2375, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4530259668827057
loss_pred:0.01901928335428238, decouple_loss:0.006201121956110001
The generated pressure mean: 0.4501703083515167
loss_pred:0.021171515807509422, decouple_loss:0.006115414667874575
The generated pressure mean: 0.4506149888038635
loss_pred:0.01922132633626461, decouple_loss:0.005977566819638014
Iteration: 2376, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45274052023887634
loss_pred:0.01950095035135746, decouple_loss:0.006112170871347189
The generated pressure mean: 0.4442654252052307
loss_pred:0.01909242570400238, decouple_loss:0.006882051005959511
The generated pressure mean: 0.45129287242889404
loss_pred:0.019414637237787247, decouple_loss:0.005957882385700941
Iteration: 2377, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4423966407775879
loss_pred:0.01970169134438038, decouple_loss:0.005260531324893236
The generated pressure mean: 0.4370279014110565
loss_pred:0.020702075213193893, decouple_loss:0.0052649229764938354
The generated pressure mean: 0.4406210780143738
loss_pred:0.019422050565481186, decouple_loss:0.0052240327931940556
Iteration: 2378, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43104028701782227
The generated pressure mean: 0.43822765350341797loss_pred:0.019413722679018974, decouple_loss:0.006442440673708916
loss_pred:0.019442636519670486, decouple_loss:0.0062264809384942055
The generated pressure mean: 0.4323761463165283
loss_pred:0.01887725107371807, decouple_loss:0.006497420836240053
Iteration: 2379, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4525391757488251
loss_pred:0.01930883899331093, decouple_loss:0.006333914119750261
The generated pressure mean: 0.44474413990974426
loss_pred:0.01828722283244133, decouple_loss:0.006434933748096228
The generated pressure mean: 0.44867900013923645
loss_pred:0.01891327276825905, decouple_loss:0.006703199818730354
Iteration: 2380, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46165838837623596
loss_pred:0.021839480847120285, decouple_loss:0.0061576832085847855
The generated pressure mean: 0.4594112038612366
loss_pred:0.01969233527779579, decouple_loss:0.006182273384183645
The generated pressure mean: 0.4578486680984497
loss_pred:0.019011320546269417, decouple_loss:0.005823709536343813
2023-04-16 10:36:37 testing...
The generated pressure mean: 0.4166015684604645
loss_pred:0.03324787691235542, decouple_loss:0.006237365305423737
The generated pressure mean: 0.42434829473495483
loss_pred:0.0315125547349453, decouple_loss:0.006520620547235012
The generated pressure mean: 0.4272579848766327
loss_pred:0.03208545595407486, decouple_loss:0.006695892196148634
Loss: 0.03260619565844536, avg_mse: 0.0475182831287384
current test mse: 0.047518
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012006_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012006_3_24hr.npz
NaN value num: 0
Iteration: 2381, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4492354393005371
loss_pred:0.018464436754584312, decouple_loss:0.005882859230041504
The generated pressure mean: 0.4524826109409332
loss_pred:0.020118921995162964, decouple_loss:0.0060684881173074245
The generated pressure mean: 0.44884219765663147
loss_pred:0.018680205568671227, decouple_loss:0.005780819803476334
Iteration: 2382, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4375498294830322
loss_pred:0.019450193271040916, decouple_loss:0.006316619925200939
The generated pressure mean: 0.43845823407173157
loss_pred:0.019812636077404022, decouple_loss:0.005876999348402023
The generated pressure mean: 0.4397812485694885
loss_pred:0.02138431929051876, decouple_loss:0.006133717019110918
Iteration: 2383, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44517719745635986
loss_pred:0.01910554990172386, decouple_loss:0.00555369071662426
The generated pressure mean: 0.44064587354660034
loss_pred:0.01946776546537876, decouple_loss:0.005614060442894697
The generated pressure mean: 0.45064258575439453
loss_pred:0.020863112062215805, decouple_loss:0.005414146929979324
Iteration: 2384, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44726958870887756
loss_pred:0.018817013129591942, decouple_loss:0.006194333080202341
The generated pressure mean: 0.44497063755989075
loss_pred:0.01909446343779564, decouple_loss:0.005536380223929882
The generated pressure mean: 0.4462808668613434
loss_pred:0.019721226766705513, decouple_loss:0.006091794930398464
Iteration: 2385, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45355576276779175
loss_pred:0.018807172775268555, decouple_loss:0.006330500822514296
The generated pressure mean: 0.45398789644241333
loss_pred:0.0187799371778965, decouple_loss:0.006280990317463875
The generated pressure mean: 0.46220287680625916
loss_pred:0.02037845551967621, decouple_loss:0.006696423050016165
Iteration: 2386, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4423638880252838
loss_pred:0.018582426011562347, decouple_loss:0.006313086021691561
The generated pressure mean: 0.4433382749557495
loss_pred:0.01954152248799801, decouple_loss:0.006333346478641033
The generated pressure mean: 0.4459976851940155
loss_pred:0.01916557364165783, decouple_loss:0.006487639620900154
Iteration: 2387, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4334338307380676
loss_pred:0.019991863518953323, decouple_loss:0.0050403159111738205
The generated pressure mean: 0.4358092248439789
loss_pred:0.019187141209840775, decouple_loss:0.005239429417997599
The generated pressure mean: 0.4245673418045044
loss_pred:0.020752962678670883, decouple_loss:0.005442681256681681
Iteration: 2388, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4561699330806732
loss_pred:0.020473310723900795, decouple_loss:0.005755819845944643
The generated pressure mean: 0.460228830575943
loss_pred:0.019874054938554764, decouple_loss:0.006072575692087412
The generated pressure mean: 0.4542395770549774
loss_pred:0.018966590985655785, decouple_loss:0.006019897758960724
Iteration: 2389, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45925140380859375
loss_pred:0.019177133217453957, decouple_loss:0.008283056318759918
The generated pressure mean: 0.4521438181400299
loss_pred:0.019802642986178398, decouple_loss:0.008174237795174122
The generated pressure mean: 0.4588249921798706
loss_pred:0.018319085240364075, decouple_loss:0.008348852396011353
Iteration: 2390, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44991016387939453
loss_pred:0.020460641011595726, decouple_loss:0.0069105117581784725
The generated pressure mean: 0.4490088224411011
loss_pred:0.019154662266373634, decouple_loss:0.007330093998461962
The generated pressure mean: 0.4502679705619812
loss_pred:0.019875507801771164, decouple_loss:0.00685466593131423
2023-04-16 10:39:26 testing...
The generated pressure mean: 0.4215923547744751
loss_pred:0.03275532275438309, decouple_loss:0.008944820612668991
The generated pressure mean: 0.43085622787475586
loss_pred:0.03220413997769356, decouple_loss:0.009021597914397717
The generated pressure mean: 0.4339359700679779
loss_pred:0.03216275945305824, decouple_loss:0.009256879799067974
Loss: 0.032827794551849365, avg_mse: 0.047598518431186676
current test mse: 0.047599
Iteration: 2391, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.42934197187423706
The generated pressure mean: 0.4283158481121063
loss_pred:0.019910253584384918, decouple_loss:0.00846641231328249
loss_pred:0.01985918916761875, decouple_loss:0.008769450709223747
The generated pressure mean: 0.42964884638786316
loss_pred:0.0182188693434, decouple_loss:0.008111129514873028
Iteration: 2392, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43963074684143066
loss_pred:0.01831904426217079, decouple_loss:0.007183298002928495
The generated pressure mean: 0.4415493309497833
loss_pred:0.018306579440832138, decouple_loss:0.007047497201710939
The generated pressure mean: 0.43787693977355957
loss_pred:0.02010500803589821, decouple_loss:0.007087952457368374
Iteration: 2393, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46162086725234985
loss_pred:0.0189194418489933, decouple_loss:0.008309048600494862
The generated pressure mean: 0.4623294770717621
loss_pred:0.018094735220074654, decouple_loss:0.007905510254204273
The generated pressure mean: 0.4577677845954895
loss_pred:0.02138832025229931, decouple_loss:0.00784572958946228
Iteration: 2394, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4532645642757416
loss_pred:0.01911352388560772, decouple_loss:0.007179624401032925
The generated pressure mean: 0.4563869833946228
loss_pred:0.018272588029503822, decouple_loss:0.007395225577056408
The generated pressure mean: 0.4584542512893677
loss_pred:0.01758166216313839, decouple_loss:0.0069670178927481174
Iteration: 2395, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4445192515850067
loss_pred:0.01762818731367588, decouple_loss:0.007813935168087482
The generated pressure mean: 0.44312214851379395
loss_pred:0.019124498590826988, decouple_loss:0.0078076706267893314
The generated pressure mean: 0.4456155300140381
loss_pred:0.020555756986141205, decouple_loss:0.007724094670265913
Iteration: 2396, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4507012367248535
loss_pred:0.018336741253733635, decouple_loss:0.007560359314084053
The generated pressure mean: 0.4433166980743408
loss_pred:0.018385421484708786, decouple_loss:0.007502304390072823
The generated pressure mean: 0.445438027381897
loss_pred:0.017799483612179756, decouple_loss:0.007581194397062063
Iteration: 2397, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4445289969444275
The generated pressure mean: 0.4391574561595917loss_pred:0.01821662113070488, decouple_loss:0.007899652235209942
loss_pred:0.017794661223888397, decouple_loss:0.007953605614602566
The generated pressure mean: 0.44159623980522156
loss_pred:0.018002871423959732, decouple_loss:0.007788531482219696
Iteration: 2398, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.449349582195282
loss_pred:0.01836330257356167, decouple_loss:0.007020247634500265
The generated pressure mean: 0.44960373640060425
loss_pred:0.018628031015396118, decouple_loss:0.006824309937655926
The generated pressure mean: 0.45088112354278564
loss_pred:0.018426377326250076, decouple_loss:0.006979778409004211
Iteration: 2399, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4501242935657501
loss_pred:0.01908211037516594, decouple_loss:0.008703415282070637
The generated pressure mean: 0.45525017380714417
loss_pred:0.02021823823451996, decouple_loss:0.008597256615757942
The generated pressure mean: 0.4499485194683075
loss_pred:0.01897086761891842, decouple_loss:0.008899734355509281
Iteration: 2400, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4518962800502777
loss_pred:0.018552586436271667, decouple_loss:0.006732692942023277
The generated pressure mean: 0.45419788360595703
loss_pred:0.021097084507346153, decouple_loss:0.0069202398881316185
The generated pressure mean: 0.45351606607437134
loss_pred:0.018153054639697075, decouple_loss:0.006637286394834518
2023-04-16 10:41:27 testing...
The generated pressure mean: 0.4205761253833771
loss_pred:0.03294983133673668, decouple_loss:0.009235071018338203
The generated pressure mean: 0.4304807186126709
loss_pred:0.03130063787102699, decouple_loss:0.009223212487995625
The generated pressure mean: 0.4332611560821533
loss_pred:0.032010599970817566, decouple_loss:0.009410659782588482
Loss: 0.03255150839686394, avg_mse: 0.04716963320970535
current test mse: 0.04717
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012015_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012015_3_24hr.npz
NaN value num: 0
Iteration: 2401, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4382900893688202
loss_pred:0.019276943057775497, decouple_loss:0.008900782093405724
The generated pressure mean: 0.4355487823486328
loss_pred:0.021514277905225754, decouple_loss:0.00894430372864008
The generated pressure mean: 0.4357214570045471
loss_pred:0.021742505952715874, decouple_loss:0.009035315364599228
Iteration: 2402, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4404642879962921
loss_pred:0.0183849036693573, decouple_loss:0.007912284694612026
The generated pressure mean: 0.4395744800567627
loss_pred:0.018881870433688164, decouple_loss:0.008089182898402214
The generated pressure mean: 0.44400754570961
loss_pred:0.02186177857220173, decouple_loss:0.008135145530104637
Iteration: 2403, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4565938711166382
loss_pred:0.019996436312794685, decouple_loss:0.0065391636453568935
The generated pressure mean: 0.4553360641002655
loss_pred:0.01959102973341942, decouple_loss:0.006490171421319246
The generated pressure mean: 0.4567520022392273
loss_pred:0.02026163414120674, decouple_loss:0.006568961311131716
Iteration: 2404, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43830934166908264
loss_pred:0.02087939716875553, decouple_loss:0.007733229547739029
The generated pressure mean: 0.4332623779773712
loss_pred:0.02082054503262043, decouple_loss:0.007603456266224384
The generated pressure mean: 0.43627801537513733
loss_pred:0.01965074986219406, decouple_loss:0.007543685380369425
Iteration: 2405, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.448344349861145
loss_pred:0.019545668736100197, decouple_loss:0.006425272673368454
The generated pressure mean: 0.45382967591285706
loss_pred:0.021275512874126434, decouple_loss:0.00674043782055378
The generated pressure mean: 0.45584696531295776
loss_pred:0.020418230444192886, decouple_loss:0.006605999544262886
Iteration: 2406, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44986414909362793
loss_pred:0.020664691925048828, decouple_loss:0.006979383062571287The generated pressure mean: 0.45441392064094543
loss_pred:0.020511958748102188, decouple_loss:0.0069306110963225365
The generated pressure mean: 0.4574111998081207
loss_pred:0.02001582272350788, decouple_loss:0.007005702238529921
Iteration: 2407, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44474104046821594
loss_pred:0.019596969708800316, decouple_loss:0.006648669485002756
The generated pressure mean: 0.44303685426712036
loss_pred:0.019891837611794472, decouple_loss:0.006539837922900915
The generated pressure mean: 0.4404379427433014
loss_pred:0.019915150478482246, decouple_loss:0.006946655921638012
Iteration: 2408, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4477822184562683
loss_pred:0.018812846392393112, decouple_loss:0.007694321684539318
The generated pressure mean: 0.4488596022129059
loss_pred:0.021683814004063606, decouple_loss:0.007356204558163881
The generated pressure mean: 0.44594457745552063
loss_pred:0.018738793209195137, decouple_loss:0.007144187577068806
Iteration: 2409, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4396732449531555
loss_pred:0.019275927916169167, decouple_loss:0.0065828533843159676
The generated pressure mean: 0.4340241253376007
loss_pred:0.01908055879175663, decouple_loss:0.006641198880970478
The generated pressure mean: 0.4407969117164612
loss_pred:0.019610462710261345, decouple_loss:0.00662250118330121
Iteration: 2410, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4493016302585602
loss_pred:0.02054465189576149, decouple_loss:0.007536100223660469
The generated pressure mean: 0.4520237445831299
loss_pred:0.0193791463971138, decouple_loss:0.007481343112885952
The generated pressure mean: 0.44320017099380493
loss_pred:0.019387483596801758, decouple_loss:0.007590643595904112
2023-04-16 10:44:01 testing...
The generated pressure mean: 0.4170832931995392
loss_pred:0.03325524926185608, decouple_loss:0.006432763766497374
The generated pressure mean: 0.42473548650741577
loss_pred:0.03212180361151695, decouple_loss:0.006727101281285286
The generated pressure mean: 0.4279400110244751
loss_pred:0.032462868839502335, decouple_loss:0.007040934171527624
Loss: 0.03294999152421951, avg_mse: 0.048009589314460754
current test mse: 0.04801
Iteration: 2411, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4446955621242523
The generated pressure mean: 0.4520353674888611
loss_pred:0.01977786421775818, decouple_loss:0.0059780399315059185
loss_pred:0.019728219136595726, decouple_loss:0.0057054306380450726
The generated pressure mean: 0.4481014907360077
loss_pred:0.020131384953856468, decouple_loss:0.005776986014097929
Iteration: 2412, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4554498791694641
loss_pred:0.01925220713019371, decouple_loss:0.007461925968527794The generated pressure mean: 0.4592759311199188
loss_pred:0.020179877057671547, decouple_loss:0.007586360443383455
The generated pressure mean: 0.45483729243278503
loss_pred:0.019162757322192192, decouple_loss:0.0075368741527199745
Iteration: 2413, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.441616415977478
loss_pred:0.020229659974575043, decouple_loss:0.0059365262277424335
The generated pressure mean: 0.4413053095340729
loss_pred:0.019270526245236397, decouple_loss:0.005809122230857611
The generated pressure mean: 0.44217175245285034
loss_pred:0.019805729389190674, decouple_loss:0.0059664323925971985
Iteration: 2414, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4471358060836792
loss_pred:0.0198542308062315, decouple_loss:0.0076399086974561214
The generated pressure mean: 0.44149890542030334
loss_pred:0.019228560850024223, decouple_loss:0.007027493789792061
The generated pressure mean: 0.4421340227127075
loss_pred:0.01924695074558258, decouple_loss:0.007172912824898958
Iteration: 2415, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4441426992416382
loss_pred:0.019242675974965096, decouple_loss:0.0060070282779634
The generated pressure mean: 0.4399939775466919
loss_pred:0.020691215991973877, decouple_loss:0.00580037385225296
The generated pressure mean: 0.44025760889053345
loss_pred:0.019420718774199486, decouple_loss:0.005947261117398739
Iteration: 2416, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44371792674064636
The generated pressure mean: 0.4495517313480377loss_pred:0.019260453060269356, decouple_loss:0.0058174957521259785
loss_pred:0.01923724077641964, decouple_loss:0.005851363763213158
The generated pressure mean: 0.447994589805603
loss_pred:0.01935921236872673, decouple_loss:0.005790407303720713
Iteration: 2417, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45408934354782104
loss_pred:0.02005399763584137, decouple_loss:0.006333797238767147
The generated pressure mean: 0.44339653849601746
loss_pred:0.01908496953547001, decouple_loss:0.006581045221537352
The generated pressure mean: 0.4451361894607544
loss_pred:0.019778385758399963, decouple_loss:0.006549685262143612
Iteration: 2418, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4607710540294647
The generated pressure mean: 0.45990118384361267
loss_pred:0.01877877116203308, decouple_loss:0.005360367242246866
loss_pred:0.02009931392967701, decouple_loss:0.005622329190373421
The generated pressure mean: 0.4551721513271332
loss_pred:0.018799494951963425, decouple_loss:0.0055097960866987705
Iteration: 2419, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4496626853942871
loss_pred:0.018776785582304, decouple_loss:0.005904479883611202
The generated pressure mean: 0.44767019152641296
loss_pred:0.01820412278175354, decouple_loss:0.005926106590777636
The generated pressure mean: 0.45199185609817505
loss_pred:0.019295677542686462, decouple_loss:0.006229887250810862
Iteration: 2420, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43636617064476013
loss_pred:0.01848420314490795, decouple_loss:0.006367674563080072
The generated pressure mean: 0.4384087026119232
loss_pred:0.019679086282849312, decouple_loss:0.006426999345421791
The generated pressure mean: 0.4312030076980591
loss_pred:0.020074494183063507, decouple_loss:0.006643550470471382
2023-04-16 10:46:01 testing...
The generated pressure mean: 0.414653480052948
loss_pred:0.03433059900999069, decouple_loss:0.005638754460960627
The generated pressure mean: 0.423271507024765
loss_pred:0.03281741216778755, decouple_loss:0.005816129967570305
The generated pressure mean: 0.42645567655563354
loss_pred:0.03328763693571091, decouple_loss:0.006084107328206301
Loss: 0.03377086669206619, avg_mse: 0.04901434853672981
current test mse: 0.049014
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012020_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012020_3_24hr.npz
NaN value num: 0
Iteration: 2421, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45905208587646484
loss_pred:0.019264541566371918, decouple_loss:0.0052219172939658165
The generated pressure mean: 0.4606475532054901
loss_pred:0.02043350227177143, decouple_loss:0.005318257492035627
The generated pressure mean: 0.46138298511505127
loss_pred:0.02047652192413807, decouple_loss:0.005312816705554724
Iteration: 2422, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4419800043106079
loss_pred:0.018950480967760086, decouple_loss:0.0051992363296449184
The generated pressure mean: 0.44447681307792664
loss_pred:0.020212920382618904, decouple_loss:0.005199575796723366
The generated pressure mean: 0.4460037648677826
loss_pred:0.020297078415751457, decouple_loss:0.0055259051732718945
Iteration: 2423, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44301337003707886
loss_pred:0.020977754145860672, decouple_loss:0.006724211387336254
The generated pressure mean: 0.4425908029079437
loss_pred:0.018566396087408066, decouple_loss:0.006589307449758053
The generated pressure mean: 0.43671104311943054
loss_pred:0.019420333206653595, decouple_loss:0.006643482018262148
Iteration: 2424, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45457857847213745
loss_pred:0.02025556191802025, decouple_loss:0.006557281129062176
The generated pressure mean: 0.4529121220111847
loss_pred:0.021019669249653816, decouple_loss:0.006405362393707037
The generated pressure mean: 0.4490259885787964
loss_pred:0.01875094510614872, decouple_loss:0.0062973457388579845
Iteration: 2425, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45695027709007263
loss_pred:0.020693860948085785, decouple_loss:0.005321566015481949
The generated pressure mean: 0.4551057815551758
loss_pred:0.020193176344037056, decouple_loss:0.005385500378906727
The generated pressure mean: 0.45093217492103577
loss_pred:0.019487570971250534, decouple_loss:0.005259534809738398
Iteration: 2426, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44546881318092346
loss_pred:0.018717514351010323, decouple_loss:0.004027742426842451
The generated pressure mean: 0.4521956741809845
loss_pred:0.01957237906754017, decouple_loss:0.0039823949337005615
The generated pressure mean: 0.4508637487888336
loss_pred:0.019266044721007347, decouple_loss:0.004323925822973251
Iteration: 2427, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4549366533756256
loss_pred:0.020216258242726326, decouple_loss:0.006350536830723286
The generated pressure mean: 0.4486611485481262
loss_pred:0.02074163593351841, decouple_loss:0.006196210626512766
The generated pressure mean: 0.4495968520641327
loss_pred:0.022093644365668297, decouple_loss:0.006411342415958643
Iteration: 2428, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43773019313812256
loss_pred:0.019444352015852928, decouple_loss:0.0062570273876190186
The generated pressure mean: 0.4401167929172516
loss_pred:0.020760543644428253, decouple_loss:0.005776051431894302
The generated pressure mean: 0.437000572681427
loss_pred:0.020898355171084404, decouple_loss:0.005698418710380793
Iteration: 2429, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45282721519470215
loss_pred:0.01880011148750782, decouple_loss:0.005879692267626524
The generated pressure mean: 0.4520469903945923
loss_pred:0.019967203959822655, decouple_loss:0.006453241221606731
The generated pressure mean: 0.4486737847328186
loss_pred:0.019307060167193413, decouple_loss:0.006240422837436199
Iteration: 2430, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4482552111148834
loss_pred:0.019535942003130913, decouple_loss:0.006521748378872871
The generated pressure mean: 0.4448569118976593
loss_pred:0.019230598583817482, decouple_loss:0.006761015392839909
The generated pressure mean: 0.45102423429489136
loss_pred:0.019204119220376015, decouple_loss:0.006913354620337486
2023-04-16 10:48:48 testing...
The generated pressure mean: 0.4149979054927826
loss_pred:0.03408421203494072, decouple_loss:0.006919811014086008
The generated pressure mean: 0.4242088198661804
loss_pred:0.03261731564998627, decouple_loss:0.007184030953794718
The generated pressure mean: 0.42714136838912964
loss_pred:0.03372599557042122, decouple_loss:0.007278465200215578
Loss: 0.03383221477270126, avg_mse: 0.04980776831507683
current test mse: 0.049808
Iteration: 2431, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45672714710235596
loss_pred:0.01827995665371418, decouple_loss:0.00616079568862915
The generated pressure mean: 0.4585026800632477
loss_pred:0.0189182348549366, decouple_loss:0.006319127045571804
The generated pressure mean: 0.45858749747276306
loss_pred:0.02018069103360176, decouple_loss:0.006370706018060446
Iteration: 2432, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45182862877845764
loss_pred:0.01963849365711212, decouple_loss:0.005224321503192186
The generated pressure mean: 0.4479604661464691
loss_pred:0.019309554249048233, decouple_loss:0.005535494536161423
The generated pressure mean: 0.4546714723110199
loss_pred:0.019905822351574898, decouple_loss:0.00527162803336978
Iteration: 2433, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4411759674549103
loss_pred:0.019888609647750854, decouple_loss:0.0052843252196908
The generated pressure mean: 0.4411797523498535
loss_pred:0.020426103845238686, decouple_loss:0.005193125456571579
The generated pressure mean: 0.4366558790206909
loss_pred:0.02016221545636654, decouple_loss:0.005167571362107992
Iteration: 2434, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4543325901031494
loss_pred:0.02023935876786709, decouple_loss:0.005977201741188765
The generated pressure mean: 0.44601956009864807
loss_pred:0.02015979401767254, decouple_loss:0.005942180752754211
The generated pressure mean: 0.45209458470344543
loss_pred:0.019372934475541115, decouple_loss:0.005806816276162863
Iteration: 2435, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4493061304092407
The generated pressure mean: 0.450055330991745loss_pred:0.019560186192393303, decouple_loss:0.0068093338049948215
loss_pred:0.018229039385914803, decouple_loss:0.006583428010344505
The generated pressure mean: 0.44760236144065857
loss_pred:0.018765410408377647, decouple_loss:0.00656664464622736
Iteration: 2436, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45079687237739563
loss_pred:0.019671730697155, decouple_loss:0.0053477296605706215
The generated pressure mean: 0.45301344990730286
loss_pred:0.018816668540239334, decouple_loss:0.005217275582253933
The generated pressure mean: 0.4515289068222046
loss_pred:0.019862543791532516, decouple_loss:0.005352004896849394
Iteration: 2437, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4453585743904114
loss_pred:0.019847828894853592, decouple_loss:0.0062715765088796616
The generated pressure mean: 0.44694292545318604
loss_pred:0.01885507069528103, decouple_loss:0.006208308506757021
The generated pressure mean: 0.44734856486320496
loss_pred:0.018804796040058136, decouple_loss:0.006414136849343777
Iteration: 2438, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4501357972621918
loss_pred:0.01949089765548706, decouple_loss:0.006014908663928509
The generated pressure mean: 0.45470020174980164
loss_pred:0.018955400213599205, decouple_loss:0.005962214432656765
The generated pressure mean: 0.45571503043174744
loss_pred:0.020476333796977997, decouple_loss:0.005825446452945471
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 2439, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4502159059047699
loss_pred:0.019877266138792038, decouple_loss:0.00580993527546525
The generated pressure mean: 0.4572101831436157
loss_pred:0.018709471449255943, decouple_loss:0.005905590485781431
The generated pressure mean: 0.45133209228515625
loss_pred:0.017780566588044167, decouple_loss:0.005911196582019329
Iteration: 2440, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44161316752433777
loss_pred:0.019345764070749283, decouple_loss:0.0056868651881814
The generated pressure mean: 0.4460907578468323
loss_pred:0.01846078597009182, decouple_loss:0.0057668075896799564
The generated pressure mean: 0.44068798422813416
loss_pred:0.0191772673279047, decouple_loss:0.006158573552966118
2023-04-16 10:50:48 testing...
The generated pressure mean: 0.4197015166282654
loss_pred:0.03207753971219063, decouple_loss:0.0066899629309773445
The generated pressure mean: 0.4276224374771118
loss_pred:0.0312800258398056, decouple_loss:0.006779354531317949
The generated pressure mean: 0.43089917302131653
loss_pred:0.03182549774646759, decouple_loss:0.007049745414406061
Loss: 0.032069675624370575, avg_mse: 0.0469973124563694
current test mse: 0.046997
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012009_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012009_3_24hr.npz
NaN value num: 0
Iteration: 2441, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4413066506385803
loss_pred:0.019058402627706528, decouple_loss:0.0062550087459385395
The generated pressure mean: 0.44376444816589355
The generated pressure mean: 0.44062337279319763loss_pred:0.019117802381515503, decouple_loss:0.0065113576129078865
loss_pred:0.01864757388830185, decouple_loss:0.006170508451759815
Iteration: 2442, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4518486261367798
loss_pred:0.018482595682144165, decouple_loss:0.005702321883291006
The generated pressure mean: 0.45076265931129456
loss_pred:0.01863636076450348, decouple_loss:0.005839227698743343
The generated pressure mean: 0.45209261775016785
loss_pred:0.01913408190011978, decouple_loss:0.006055057048797607
Iteration: 2443, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45050230622291565
The generated pressure mean: 0.45112866163253784
loss_pred:0.019109925255179405, decouple_loss:0.005867101717740297
loss_pred:0.01843203790485859, decouple_loss:0.005759973078966141
The generated pressure mean: 0.4570540487766266
loss_pred:0.018836529925465584, decouple_loss:0.0060711209662258625
Iteration: 2444, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4449423849582672
loss_pred:0.0189518965780735, decouple_loss:0.00616913428530097
The generated pressure mean: 0.4487195611000061
loss_pred:0.019335418939590454, decouple_loss:0.006168484687805176
The generated pressure mean: 0.4433291554450989
loss_pred:0.019204238429665565, decouple_loss:0.006057783495634794
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 2445, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43366241455078125
loss_pred:0.01903606578707695, decouple_loss:0.004689439665526152
The generated pressure mean: 0.4389083683490753
loss_pred:0.019011983647942543, decouple_loss:0.004776389803737402
The generated pressure mean: 0.43816515803337097
loss_pred:0.01942097209393978, decouple_loss:0.00477222353219986
Iteration: 2446, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4504837095737457
loss_pred:0.020275739952921867, decouple_loss:0.00616087531670928
The generated pressure mean: 0.44551560282707214
loss_pred:0.018961552530527115, decouple_loss:0.00625667255371809
The generated pressure mean: 0.44872188568115234
loss_pred:0.020014522597193718, decouple_loss:0.006277318578213453
Iteration: 2447, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4530407190322876
loss_pred:0.01907125674188137, decouple_loss:0.004759924486279488
The generated pressure mean: 0.45431965589523315
loss_pred:0.0193166546523571, decouple_loss:0.0045655895955860615
The generated pressure mean: 0.4517301321029663
loss_pred:0.02151653915643692, decouple_loss:0.004791124723851681
Iteration: 2448, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4432167112827301
loss_pred:0.01935971900820732, decouple_loss:0.0055128405801951885
The generated pressure mean: 0.44521355628967285
loss_pred:0.018836023285984993, decouple_loss:0.005342782475054264
The generated pressure mean: 0.4452318251132965
loss_pred:0.019739070907235146, decouple_loss:0.005341880954802036
Iteration: 2449, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.446409672498703
loss_pred:0.019182557240128517, decouple_loss:0.005546786356717348
The generated pressure mean: 0.44278231263160706
loss_pred:0.01889044977724552, decouple_loss:0.005782233085483313
The generated pressure mean: 0.4421515464782715
loss_pred:0.019166555255651474, decouple_loss:0.005791960284113884
Iteration: 2450, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45083746314048767
loss_pred:0.018421174958348274, decouple_loss:0.004978964105248451
The generated pressure mean: 0.4424020051956177
loss_pred:0.0198895875364542, decouple_loss:0.004835410043597221
The generated pressure mean: 0.44326475262641907
loss_pred:0.018466856330633163, decouple_loss:0.00514410063624382
2023-04-16 10:53:26 testing...
The generated pressure mean: 0.4168154299259186
loss_pred:0.032926302403211594, decouple_loss:0.0050085773691535
The generated pressure mean: 0.42532557249069214
loss_pred:0.031962573528289795, decouple_loss:0.005119116045534611
The generated pressure mean: 0.4285106658935547
loss_pred:0.03262823820114136, decouple_loss:0.005240652244538069
Loss: 0.032761845737695694, avg_mse: 0.04824580252170563
current test mse: 0.048246
Iteration: 2451, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4508410692214966
The generated pressure mean: 0.45430272817611694
loss_pred:0.018118174746632576, decouple_loss:0.00442007090896368
loss_pred:0.02110002003610134, decouple_loss:0.004476938396692276
The generated pressure mean: 0.4517322778701782
loss_pred:0.01861952245235443, decouple_loss:0.004184350371360779
Iteration: 2452, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44307050108909607
The generated pressure mean: 0.4413245618343353
loss_pred:0.017866652458906174, decouple_loss:0.005160790402442217
loss_pred:0.01872839406132698, decouple_loss:0.004932599142193794
The generated pressure mean: 0.4396158456802368
loss_pred:0.019672855734825134, decouple_loss:0.005041810218244791
Iteration: 2453, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4446519613265991
loss_pred:0.01895398646593094, decouple_loss:0.005065626930445433
The generated pressure mean: 0.4391591250896454
loss_pred:0.019116079434752464, decouple_loss:0.0048244972713291645
The generated pressure mean: 0.44052454829216003
loss_pred:0.02014332264661789, decouple_loss:0.005030601751059294
Iteration: 2454, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45496007800102234
The generated pressure mean: 0.4502648115158081loss_pred:0.01885436475276947, decouple_loss:0.0040434314869344234
loss_pred:0.019835928454995155, decouple_loss:0.004421966150403023
The generated pressure mean: 0.4557092487812042
loss_pred:0.019117625430226326, decouple_loss:0.004274176433682442
Iteration: 2455, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4507253170013428
loss_pred:0.019786320626735687, decouple_loss:0.006171396467834711
The generated pressure mean: 0.44953468441963196
loss_pred:0.019115936011075974, decouple_loss:0.006254022009670734
The generated pressure mean: 0.45226553082466125
loss_pred:0.01877824403345585, decouple_loss:0.006095255259424448
Iteration: 2456, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4372807741165161
loss_pred:0.01805591955780983, decouple_loss:0.005208689719438553
The generated pressure mean: 0.4346486032009125
loss_pred:0.01950652524828911, decouple_loss:0.004950822331011295
The generated pressure mean: 0.43772000074386597
loss_pred:0.01895867846906185, decouple_loss:0.005315778777003288
Iteration: 2457, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4528946876525879
loss_pred:0.01853230968117714, decouple_loss:0.0059127178974449635
The generated pressure mean: 0.4531764090061188
loss_pred:0.020069420337677002, decouple_loss:0.006262988317757845
The generated pressure mean: 0.45262953639030457
loss_pred:0.019911671057343483, decouple_loss:0.006120550911873579
Iteration: 2458, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4503873884677887
loss_pred:0.018373508006334305, decouple_loss:0.005398779176175594
The generated pressure mean: 0.44706636667251587
loss_pred:0.018940549343824387, decouple_loss:0.005655074026435614
The generated pressure mean: 0.4450514316558838
loss_pred:0.01774315908551216, decouple_loss:0.006062735803425312
Iteration: 2459, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4422641396522522
loss_pred:0.018918639048933983, decouple_loss:0.005681071896106005
The generated pressure mean: 0.4452148377895355
loss_pred:0.01974225603044033, decouple_loss:0.005795703269541264
The generated pressure mean: 0.447531521320343
loss_pred:0.0195285864174366, decouple_loss:0.005857521202415228
Iteration: 2460, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44912752509117126
loss_pred:0.018977943807840347, decouple_loss:0.004263035021722317
The generated pressure mean: 0.4469143748283386
loss_pred:0.018494324758648872, decouple_loss:0.004694368690252304
The generated pressure mean: 0.4531169831752777
loss_pred:0.01892094872891903, decouple_loss:0.004761080257594585
2023-04-16 10:55:26 testing...
The generated pressure mean: 0.4165843725204468
loss_pred:0.03240464627742767, decouple_loss:0.0054436614736914635
The generated pressure mean: 0.4264903664588928
loss_pred:0.031881824135780334, decouple_loss:0.005522377789020538
The generated pressure mean: 0.4289845824241638
loss_pred:0.031740084290504456, decouple_loss:0.005857406184077263
Loss: 0.03228924423456192, avg_mse: 0.04712194576859474
current test mse: 0.047122
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012019_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012019_3_24hr.npz
NaN value num: 0
Iteration: 2461, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45535212755203247
loss_pred:0.01918143592774868, decouple_loss:0.005421006586402655
The generated pressure mean: 0.4546072483062744
loss_pred:0.01821013353765011, decouple_loss:0.005100819282233715
The generated pressure mean: 0.4552912414073944
loss_pred:0.018817443400621414, decouple_loss:0.005319997668266296
Iteration: 2462, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4362744390964508
loss_pred:0.01788843236863613, decouple_loss:0.0054305256344377995
The generated pressure mean: 0.4382595121860504
loss_pred:0.018803367391228676, decouple_loss:0.005189916118979454
The generated pressure mean: 0.44101959466934204
loss_pred:0.018735507503151894, decouple_loss:0.005143012385815382
Iteration: 2463, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44731032848358154
loss_pred:0.01879599317908287, decouple_loss:0.004474095534533262
The generated pressure mean: 0.4410996437072754
loss_pred:0.018115194514393806, decouple_loss:0.0044675120152533054
The generated pressure mean: 0.4429750442504883
loss_pred:0.01760570891201496, decouple_loss:0.004556781146675348
Iteration: 2464, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4533955156803131
loss_pred:0.01860964484512806, decouple_loss:0.004286166280508041
The generated pressure mean: 0.45565587282180786
loss_pred:0.01743220165371895, decouple_loss:0.004683532752096653
The generated pressure mean: 0.4540700614452362
loss_pred:0.018799085170030594, decouple_loss:0.00412038853392005
Iteration: 2465, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44971394538879395
loss_pred:0.018466761335730553, decouple_loss:0.004482813645154238
The generated pressure mean: 0.4560854434967041
loss_pred:0.019082026556134224, decouple_loss:0.004664496518671513
The generated pressure mean: 0.45205792784690857
loss_pred:0.018834583461284637, decouple_loss:0.004715081304311752
Iteration: 2466, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.446026086807251
loss_pred:0.021031739190220833, decouple_loss:0.00499797984957695
The generated pressure mean: 0.44729796051979065
loss_pred:0.01812305860221386, decouple_loss:0.0047661541029810905
The generated pressure mean: 0.4480556845664978
loss_pred:0.018992923200130463, decouple_loss:0.004714930895715952
Iteration: 2467, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44460591673851013
loss_pred:0.018163535743951797, decouple_loss:0.004389182664453983
The generated pressure mean: 0.4461483061313629
loss_pred:0.01805979199707508, decouple_loss:0.004459761548787355
The generated pressure mean: 0.4447726309299469
loss_pred:0.019476396963000298, decouple_loss:0.0044083078391849995
Iteration: 2468, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4395063817501068
loss_pred:0.018099766224622726, decouple_loss:0.004732792265713215
The generated pressure mean: 0.4509136378765106
loss_pred:0.019166158512234688, decouple_loss:0.004554085899144411
The generated pressure mean: 0.4492865204811096
loss_pred:0.01892622746527195, decouple_loss:0.004416214302182198
Iteration: 2469, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4534260332584381
loss_pred:0.01873369887471199, decouple_loss:0.005268337205052376
The generated pressure mean: 0.4524841606616974
loss_pred:0.019807975739240646, decouple_loss:0.005122900940477848
The generated pressure mean: 0.4483712613582611
loss_pred:0.01897335983812809, decouple_loss:0.005471423268318176
Iteration: 2470, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4387827217578888
loss_pred:0.0188800860196352, decouple_loss:0.004808078985661268
The generated pressure mean: 0.4417392313480377
loss_pred:0.019444122910499573, decouple_loss:0.004973114468157291
The generated pressure mean: 0.4383421242237091
loss_pred:0.01945333369076252, decouple_loss:0.004903579596430063
2023-04-16 10:58:01 testing...
The generated pressure mean: 0.41845589876174927
loss_pred:0.03284130245447159, decouple_loss:0.00529441237449646
The generated pressure mean: 0.42745086550712585
loss_pred:0.03132333979010582, decouple_loss:0.00541634950786829
The generated pressure mean: 0.4305212199687958
loss_pred:0.03168519213795662, decouple_loss:0.005688341334462166
Loss: 0.03222326561808586, avg_mse: 0.04708210378885269
current test mse: 0.047082
Iteration: 2471, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.443250447511673
loss_pred:0.018891751766204834, decouple_loss:0.0052054026164114475
The generated pressure mean: 0.45349669456481934
loss_pred:0.018467620015144348, decouple_loss:0.0043726530857384205
The generated pressure mean: 0.44246742129325867
loss_pred:0.017969800159335136, decouple_loss:0.004778706002980471
Iteration: 2472, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.464081734418869
loss_pred:0.019129715859889984, decouple_loss:0.0038924335967749357
The generated pressure mean: 0.4609246253967285
loss_pred:0.020216740667819977, decouple_loss:0.004290824756026268
The generated pressure mean: 0.4553394913673401
loss_pred:0.018262311816215515, decouple_loss:0.004163479898124933
Iteration: 2473, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45351293683052063
loss_pred:0.01799795776605606, decouple_loss:0.004904189612716436
The generated pressure mean: 0.4563596844673157
loss_pred:0.018125664442777634, decouple_loss:0.0053202370181679726
The generated pressure mean: 0.459759920835495
loss_pred:0.018590403720736504, decouple_loss:0.0052473354153335094
Iteration: 2474, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.432833194732666
loss_pred:0.01951831579208374, decouple_loss:0.0043156626634299755
The generated pressure mean: 0.4320407509803772
loss_pred:0.017859114333987236, decouple_loss:0.004195327404886484
The generated pressure mean: 0.43158212304115295
loss_pred:0.018070882186293602, decouple_loss:0.004224852658808231
Iteration: 2475, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44693371653556824
loss_pred:0.020409908145666122, decouple_loss:0.004009768832474947
The generated pressure mean: 0.44848203659057617
loss_pred:0.01927415281534195, decouple_loss:0.004299839958548546
The generated pressure mean: 0.4481704831123352
loss_pred:0.01902497000992298, decouple_loss:0.00396693404763937
Iteration: 2476, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4570813775062561
loss_pred:0.019205419346690178, decouple_loss:0.004668935667723417
The generated pressure mean: 0.46107590198516846
loss_pred:0.019281208515167236, decouple_loss:0.0044481405057013035
The generated pressure mean: 0.45767882466316223
loss_pred:0.01818169467151165, decouple_loss:0.004593958612531424
Iteration: 2477, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45142337679862976
loss_pred:0.019561123102903366, decouple_loss:0.005267447326332331
The generated pressure mean: 0.45040905475616455
loss_pred:0.01926327869296074, decouple_loss:0.005240698345005512
The generated pressure mean: 0.44956791400909424
loss_pred:0.02043246477842331, decouple_loss:0.0048721046186983585
Iteration: 2478, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44154712557792664
loss_pred:0.01882566139101982, decouple_loss:0.005072786472737789
The generated pressure mean: 0.4392894506454468
loss_pred:0.018529511988162994, decouple_loss:0.004979315213859081
The generated pressure mean: 0.4378250241279602
loss_pred:0.018642734736204147, decouple_loss:0.004897139500826597
Iteration: 2479, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4455358684062958
The generated pressure mean: 0.4494662582874298loss_pred:0.019196607172489166, decouple_loss:0.0036479784175753593
loss_pred:0.018907707184553146, decouple_loss:0.003748612944036722
The generated pressure mean: 0.44665735960006714
loss_pred:0.018383510410785675, decouple_loss:0.003504012944176793
Iteration: 2480, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4516361355781555
loss_pred:0.019709989428520203, decouple_loss:0.005271660163998604
The generated pressure mean: 0.44806602597236633
loss_pred:0.01858357898890972, decouple_loss:0.005345006473362446
The generated pressure mean: 0.4506385624408722
loss_pred:0.018986739218235016, decouple_loss:0.005360783077776432
2023-04-16 11:00:01 testing...
The generated pressure mean: 0.41848382353782654
loss_pred:0.03178679943084717, decouple_loss:0.005535876378417015
The generated pressure mean: 0.42587918043136597
loss_pred:0.030893420800566673, decouple_loss:0.005748155526816845
The generated pressure mean: 0.42957237362861633
loss_pred:0.03091680444777012, decouple_loss:0.005879441276192665
Loss: 0.03148506581783295, avg_mse: 0.04582807794213295
current test mse: 0.045828
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012003_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012003_3_24hr.npz
NaN value num: 0
Iteration: 2481, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4426969289779663
loss_pred:0.02040514536201954, decouple_loss:0.004924738314002752
The generated pressure mean: 0.4466259777545929
loss_pred:0.018655315041542053, decouple_loss:0.004892055410891771
The generated pressure mean: 0.4455336928367615
loss_pred:0.018467800691723824, decouple_loss:0.0050765774212777615
Iteration: 2482, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45325061678886414
The generated pressure mean: 0.45920082926750183
loss_pred:0.01994594745337963, decouple_loss:0.005852428264915943
loss_pred:0.01814747229218483, decouple_loss:0.005854039452970028
The generated pressure mean: 0.4631037414073944
loss_pred:0.019094564020633698, decouple_loss:0.005929775536060333
Iteration: 2483, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4515027105808258
loss_pred:0.019618043676018715, decouple_loss:0.004866954870522022
The generated pressure mean: 0.44934993982315063
loss_pred:0.020401980727910995, decouple_loss:0.004962611012160778
The generated pressure mean: 0.45187368988990784
loss_pred:0.01818915642797947, decouple_loss:0.004879793617874384
Iteration: 2484, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4394700229167938
loss_pred:0.019350768998265266, decouple_loss:0.005598386283963919
The generated pressure mean: 0.4377628564834595
loss_pred:0.01882494054734707, decouple_loss:0.005777692887932062
The generated pressure mean: 0.4322192370891571
loss_pred:0.01909707486629486, decouple_loss:0.005844390485435724
Iteration: 2485, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44362229108810425
loss_pred:0.01786295510828495, decouple_loss:0.00448898458853364
The generated pressure mean: 0.4382524788379669
loss_pred:0.017972998321056366, decouple_loss:0.004830367863178253
The generated pressure mean: 0.44554629921913147
loss_pred:0.01904030330479145, decouple_loss:0.004557143431156874
Iteration: 2486, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45063987374305725
loss_pred:0.019303761422634125, decouple_loss:0.0055410428903996944
The generated pressure mean: 0.4478113651275635
loss_pred:0.019368892535567284, decouple_loss:0.005625867284834385
The generated pressure mean: 0.45381495356559753
loss_pred:0.018664922565221786, decouple_loss:0.005170626100152731
Iteration: 2487, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44598624110221863
loss_pred:0.01880430243909359, decouple_loss:0.004609748721122742
The generated pressure mean: 0.4431920051574707
loss_pred:0.018464095890522003, decouple_loss:0.004854969214648008
The generated pressure mean: 0.44843590259552
loss_pred:0.018030110746622086, decouple_loss:0.005077585577964783
Iteration: 2488, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45104753971099854
loss_pred:0.020509997382760048, decouple_loss:0.0050705731846392155
The generated pressure mean: 0.44783124327659607
loss_pred:0.018286408856511116, decouple_loss:0.0050244322046637535
The generated pressure mean: 0.4451020061969757
loss_pred:0.018679484724998474, decouple_loss:0.00521409185603261
Iteration: 2489, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45134884119033813
loss_pred:0.018012620508670807, decouple_loss:0.00486924359574914
The generated pressure mean: 0.45385825634002686
loss_pred:0.020957710221409798, decouple_loss:0.0050657824613153934
The generated pressure mean: 0.4506273865699768
loss_pred:0.01938590407371521, decouple_loss:0.00475900387391448
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 2490, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4540788531303406
loss_pred:0.018820343539118767, decouple_loss:0.005808771587908268
The generated pressure mean: 0.45656341314315796
loss_pred:0.017870569601655006, decouple_loss:0.005981375463306904
The generated pressure mean: 0.45623520016670227
loss_pred:0.01809217594563961, decouple_loss:0.006051516160368919
2023-04-16 11:02:38 testing...
The generated pressure mean: 0.421045184135437
loss_pred:0.03205646574497223, decouple_loss:0.005915890913456678
The generated pressure mean: 0.4303090274333954
loss_pred:0.030433468520641327, decouple_loss:0.00609349412843585
The generated pressure mean: 0.4338306784629822
loss_pred:0.030648740008473396, decouple_loss:0.0062987180426716805
Loss: 0.03135136142373085, avg_mse: 0.04630948230624199
current test mse: 0.046309
Iteration: 2491, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4406813681125641
loss_pred:0.019191883504390717, decouple_loss:0.005477649625390768
The generated pressure mean: 0.43949297070503235
loss_pred:0.018327096477150917, decouple_loss:0.005485455971211195
The generated pressure mean: 0.43789026141166687
loss_pred:0.019179487600922585, decouple_loss:0.005436657462269068
Iteration: 2492, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4375641942024231The generated pressure mean: 0.4442594647407532
loss_pred:0.018566232174634933, decouple_loss:0.0068545714020729065
loss_pred:0.017733577638864517, decouple_loss:0.0067652747966349125
The generated pressure mean: 0.4393220543861389
loss_pred:0.018810061737895012, decouple_loss:0.006874964572489262
Iteration: 2493, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45315325260162354
loss_pred:0.018794123083353043, decouple_loss:0.0054803634993731976
The generated pressure mean: 0.4513952136039734
loss_pred:0.018512671813368797, decouple_loss:0.005692605394870043
The generated pressure mean: 0.45548710227012634
loss_pred:0.01885313354432583, decouple_loss:0.005234088748693466
Iteration: 2494, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4493570327758789
loss_pred:0.020245715975761414, decouple_loss:0.006509118247777224
The generated pressure mean: 0.444518506526947
loss_pred:0.018517374992370605, decouple_loss:0.006249910220503807
The generated pressure mean: 0.45217904448509216
loss_pred:0.018332986161112785, decouple_loss:0.00626696553081274
Iteration: 2495, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44373369216918945
loss_pred:0.018626928329467773, decouple_loss:0.005116644315421581
The generated pressure mean: 0.4476262629032135
loss_pred:0.017842810600996017, decouple_loss:0.005164830945432186
The generated pressure mean: 0.44212743639945984
loss_pred:0.01909777708351612, decouple_loss:0.005019600968807936
Iteration: 2496, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4437367618083954
loss_pred:0.018739057704806328, decouple_loss:0.00581083120778203
The generated pressure mean: 0.44720458984375
loss_pred:0.02140938676893711, decouple_loss:0.005821361672133207
The generated pressure mean: 0.4432026743888855
loss_pred:0.01911500096321106, decouple_loss:0.005898104049265385
Iteration: 2497, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45332300662994385
loss_pred:0.02011529915034771, decouple_loss:0.005811605602502823
The generated pressure mean: 0.4491977095603943
loss_pred:0.01830877736210823, decouple_loss:0.005934286396950483
The generated pressure mean: 0.4466477930545807
loss_pred:0.018017342314124107, decouple_loss:0.006015976425260305
Iteration: 2498, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44799867272377014
The generated pressure mean: 0.4513110816478729loss_pred:0.019739186391234398, decouple_loss:0.005986887961626053
loss_pred:0.01739971525967121, decouple_loss:0.005769074894487858
The generated pressure mean: 0.44882097840309143
loss_pred:0.018371596932411194, decouple_loss:0.005653087515383959
Iteration: 2499, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45180588960647583
loss_pred:0.019304554909467697, decouple_loss:0.005705320276319981
The generated pressure mean: 0.44753649830818176
loss_pred:0.01923321560025215, decouple_loss:0.0061234296299517155
The generated pressure mean: 0.44513171911239624
loss_pred:0.019469158723950386, decouple_loss:0.005889092572033405
Iteration: 2500, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44507166743278503
loss_pred:0.019355185329914093, decouple_loss:0.00708557665348053
The generated pressure mean: 0.4490455090999603
loss_pred:0.01911305822432041, decouple_loss:0.006967077497392893
The generated pressure mean: 0.4492914378643036
loss_pred:0.018888382241129875, decouple_loss:0.0071452041156589985
2023-04-16 11:04:39 testing...
The generated pressure mean: 0.4187592566013336
loss_pred:0.03124413639307022, decouple_loss:0.006234542466700077
The generated pressure mean: 0.42710453271865845
loss_pred:0.0298044141381979, decouple_loss:0.006357279606163502
The generated pressure mean: 0.42993852496147156
loss_pred:0.03008408471941948, decouple_loss:0.0064570242539048195
Loss: 0.030695026740431786, avg_mse: 0.04493870213627815
current test mse: 0.044939
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012014_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012014_3_24hr.npz
NaN value num: 0
Iteration: 2501, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44215676188468933
loss_pred:0.01937440223991871, decouple_loss:0.0057891239412128925
The generated pressure mean: 0.43993622064590454
loss_pred:0.019248925149440765, decouple_loss:0.0056931679137051105
The generated pressure mean: 0.44673866033554077
loss_pred:0.020152855664491653, decouple_loss:0.005696780979633331
Iteration: 2502, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4426381587982178
loss_pred:0.02039501443505287, decouple_loss:0.005686769727617502
The generated pressure mean: 0.44029808044433594
loss_pred:0.019186101853847504, decouple_loss:0.005657514091581106
The generated pressure mean: 0.44163015484809875
loss_pred:0.019501902163028717, decouple_loss:0.005812852643430233
Iteration: 2503, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4520314633846283
loss_pred:0.020249102264642715, decouple_loss:0.0052978903986513615
The generated pressure mean: 0.4577389359474182
loss_pred:0.020001517608761787, decouple_loss:0.00536612793803215
The generated pressure mean: 0.45683524012565613
loss_pred:0.01920240744948387, decouple_loss:0.005115217994898558
Iteration: 2504, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4441932439804077
loss_pred:0.01990141160786152, decouple_loss:0.0055679818615317345
The generated pressure mean: 0.44769448041915894
loss_pred:0.020363742485642433, decouple_loss:0.005402183160185814
The generated pressure mean: 0.44290924072265625
loss_pred:0.018073512241244316, decouple_loss:0.005469611845910549
Iteration: 2505, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4308346211910248
loss_pred:0.01854843832552433, decouple_loss:0.005537682678550482
The generated pressure mean: 0.42553961277008057
loss_pred:0.020827218890190125, decouple_loss:0.005282395984977484
The generated pressure mean: 0.42830249667167664
loss_pred:0.01853804662823677, decouple_loss:0.005262583959847689
Iteration: 2506, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4565841853618622
loss_pred:0.019353428855538368, decouple_loss:0.005547964014112949
The generated pressure mean: 0.46062353253364563
loss_pred:0.018932582810521126, decouple_loss:0.00543337082490325
The generated pressure mean: 0.4640445113182068
loss_pred:0.018244879320263863, decouple_loss:0.005525371991097927
Iteration: 2507, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4598115086555481
loss_pred:0.01936427131295204, decouple_loss:0.0049814097583293915
The generated pressure mean: 0.4629122018814087
loss_pred:0.01900545135140419, decouple_loss:0.00518543878570199
The generated pressure mean: 0.4595305621623993
loss_pred:0.020323850214481354, decouple_loss:0.005390888080000877
Iteration: 2508, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4330696761608124
loss_pred:0.02053205855190754, decouple_loss:0.006452052854001522
The generated pressure mean: 0.43335673213005066
loss_pred:0.01983795315027237, decouple_loss:0.00662691006436944
The generated pressure mean: 0.43643176555633545
loss_pred:0.01820916309952736, decouple_loss:0.0064721363596618176
Iteration: 2509, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4316767752170563
loss_pred:0.02000945806503296, decouple_loss:0.005837927106767893
The generated pressure mean: 0.43297919631004333
loss_pred:0.019632643088698387, decouple_loss:0.005597461946308613
The generated pressure mean: 0.4314780831336975
loss_pred:0.020025786012411118, decouple_loss:0.006185453850775957
Iteration: 2510, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4580688774585724
loss_pred:0.019919926300644875, decouple_loss:0.005480322055518627
The generated pressure mean: 0.45333608984947205
loss_pred:0.019073372706770897, decouple_loss:0.005001341458410025
The generated pressure mean: 0.4580540060997009
loss_pred:0.018871037289500237, decouple_loss:0.0055611627176404
2023-04-16 11:07:18 testing...
The generated pressure mean: 0.41811779141426086
loss_pred:0.0331537239253521, decouple_loss:0.005587481427937746
The generated pressure mean: 0.42768409848213196
loss_pred:0.03160171955823898, decouple_loss:0.005777108483016491
The generated pressure mean: 0.4312486946582794
loss_pred:0.032120149582624435, decouple_loss:0.006049977615475655
Loss: 0.032582104206085205, avg_mse: 0.04857322573661804
current test mse: 0.048573
Iteration: 2511, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45493605732917786
loss_pred:0.019342688843607903, decouple_loss:0.005235867574810982
The generated pressure mean: 0.4468550980091095
loss_pred:0.019727258011698723, decouple_loss:0.005077706649899483
The generated pressure mean: 0.4519333839416504
loss_pred:0.01852339506149292, decouple_loss:0.0050762421451509
Iteration: 2512, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44134318828582764
loss_pred:0.018411725759506226, decouple_loss:0.004970310255885124
The generated pressure mean: 0.4411255419254303
loss_pred:0.018947724252939224, decouple_loss:0.004853362217545509
The generated pressure mean: 0.44061607122421265
loss_pred:0.020504126325249672, decouple_loss:0.005215057171881199
Iteration: 2513, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4447552263736725
loss_pred:0.019237292930483818, decouple_loss:0.005840643774718046
The generated pressure mean: 0.44480687379837036
loss_pred:0.01940624788403511, decouple_loss:0.0055586909875273705
The generated pressure mean: 0.44562435150146484
loss_pred:0.01847226172685623, decouple_loss:0.0054863677360117435
Iteration: 2514, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4514927268028259
loss_pred:0.01928599178791046, decouple_loss:0.0044672731310129166
The generated pressure mean: 0.4544331729412079
loss_pred:0.01965232752263546, decouple_loss:0.004398790188133717
The generated pressure mean: 0.45653894543647766
loss_pred:0.018326610326766968, decouple_loss:0.004232546780258417
Iteration: 2515, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4417821764945984
loss_pred:0.018712662160396576, decouple_loss:0.0056039574556052685
The generated pressure mean: 0.4405127167701721
loss_pred:0.018948670476675034, decouple_loss:0.005441353656351566
The generated pressure mean: 0.4466351568698883
loss_pred:0.019306696951389313, decouple_loss:0.005531690549105406
Iteration: 2516, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4353073537349701
loss_pred:0.018798120319843292, decouple_loss:0.005223744083195925
The generated pressure mean: 0.43396812677383423
loss_pred:0.01890651136636734, decouple_loss:0.005370636936277151
The generated pressure mean: 0.434749573469162
loss_pred:0.019350949674844742, decouple_loss:0.005074981600046158
Iteration: 2517, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45538461208343506
loss_pred:0.018953310325741768, decouple_loss:0.005309013649821281
The generated pressure mean: 0.45326781272888184
loss_pred:0.018064698204398155, decouple_loss:0.0052751097828149796
The generated pressure mean: 0.4498916268348694
loss_pred:0.018950173631310463, decouple_loss:0.005072432570159435
Iteration: 2518, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4504125714302063
loss_pred:0.01810474321246147, decouple_loss:0.006432563532143831
The generated pressure mean: 0.4477584958076477
loss_pred:0.018929926678538322, decouple_loss:0.006172697525471449
The generated pressure mean: 0.4511398673057556
loss_pred:0.020050859078764915, decouple_loss:0.006529591046273708
Iteration: 2519, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4414765238761902
loss_pred:0.019329559057950974, decouple_loss:0.0056234621442854404
The generated pressure mean: 0.444124698638916
loss_pred:0.019740253686904907, decouple_loss:0.0054109711199998856
The generated pressure mean: 0.4420059323310852
loss_pred:0.02033574879169464, decouple_loss:0.0054023428820073605
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 2520, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44255319237709045
loss_pred:0.020282914862036705, decouple_loss:0.004701313562691212
The generated pressure mean: 0.4403892159461975
loss_pred:0.018793072551488876, decouple_loss:0.004823391325771809
The generated pressure mean: 0.4415667951107025
loss_pred:0.019307775422930717, decouple_loss:0.004968828987330198
2023-04-16 11:09:19 testing...
The generated pressure mean: 0.4163893163204193
loss_pred:0.03294298052787781, decouple_loss:0.00511552207171917
The generated pressure mean: 0.42417171597480774
loss_pred:0.031504303216934204, decouple_loss:0.005224110558629036
The generated pressure mean: 0.4274749457836151
loss_pred:0.03188515454530716, decouple_loss:0.00554992351680994
Loss: 0.03237564116716385, avg_mse: 0.04779895022511482
current test mse: 0.047799
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012017_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012017_3_24hr.npz
NaN value num: 0
Iteration: 2521, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4532184600830078
loss_pred:0.019764196127653122, decouple_loss:0.004745227284729481
The generated pressure mean: 0.45107895135879517
loss_pred:0.019870007410645485, decouple_loss:0.004750756546854973
The generated pressure mean: 0.4506545662879944
loss_pred:0.018866131082177162, decouple_loss:0.004938214085996151
Iteration: 2522, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4624827802181244
loss_pred:0.01807537116110325, decouple_loss:0.0055184876546263695
The generated pressure mean: 0.46147969365119934
loss_pred:0.018594518303871155, decouple_loss:0.005743270739912987
The generated pressure mean: 0.4588794708251953
loss_pred:0.01835707761347294, decouple_loss:0.005166307091712952
Iteration: 2523, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4428193271160126
loss_pred:0.01872503198683262, decouple_loss:0.0052273329347372055
The generated pressure mean: 0.4451548159122467
loss_pred:0.019993839785456657, decouple_loss:0.005256098695099354
The generated pressure mean: 0.44152402877807617
loss_pred:0.01870843768119812, decouple_loss:0.005042760632932186
Iteration: 2524, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4410525858402252
loss_pred:0.02041250839829445, decouple_loss:0.005784159991890192
The generated pressure mean: 0.4446336627006531
loss_pred:0.019006874412298203, decouple_loss:0.0055808923207223415
The generated pressure mean: 0.43952080607414246
loss_pred:0.019363198429346085, decouple_loss:0.005881765857338905
Iteration: 2525, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43960049748420715
loss_pred:0.01974991336464882, decouple_loss:0.004701551049947739
The generated pressure mean: 0.4402662515640259
loss_pred:0.01812629960477352, decouple_loss:0.005276033654808998
The generated pressure mean: 0.44330719113349915
loss_pred:0.018320750445127487, decouple_loss:0.005101488903164864
Iteration: 2526, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45365533232688904
loss_pred:0.01898684725165367, decouple_loss:0.005948117468506098
The generated pressure mean: 0.4489489495754242
loss_pred:0.01797214150428772, decouple_loss:0.006147931795567274
The generated pressure mean: 0.44854098558425903
loss_pred:0.018150461837649345, decouple_loss:0.006034684833139181
Iteration: 2527, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45770835876464844
loss_pred:0.01816285029053688, decouple_loss:0.005369223188608885
The generated pressure mean: 0.4631190896034241
loss_pred:0.018176373094320297, decouple_loss:0.005362980999052525
The generated pressure mean: 0.4585886299610138
loss_pred:0.01992534101009369, decouple_loss:0.005190965253859758
Iteration: 2528, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45053791999816895
loss_pred:0.0195369403809309, decouple_loss:0.005498835816979408
The generated pressure mean: 0.44642338156700134
loss_pred:0.01853172853589058, decouple_loss:0.005191844422370195
The generated pressure mean: 0.4439714848995209
loss_pred:0.019567199051380157, decouple_loss:0.005093864165246487
Iteration: 2529, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4356535077095032
loss_pred:0.01776696927845478, decouple_loss:0.0052097514271736145
The generated pressure mean: 0.440084844827652
loss_pred:0.018306849524378777, decouple_loss:0.005283708218485117
The generated pressure mean: 0.4408084750175476
loss_pred:0.017573237419128418, decouple_loss:0.005361452233046293
Iteration: 2530, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4472685754299164
loss_pred:0.01920783333480358, decouple_loss:0.005185834132134914
The generated pressure mean: 0.4462839961051941
loss_pred:0.01688726432621479, decouple_loss:0.0054430351592600346
The generated pressure mean: 0.44744691252708435
loss_pred:0.016420507803559303, decouple_loss:0.005469383671879768
2023-04-16 11:11:54 testing...
The generated pressure mean: 0.41811034083366394
loss_pred:0.03364968299865723, decouple_loss:0.005790300667285919
The generated pressure mean: 0.42648106813430786
loss_pred:0.03202027082443237, decouple_loss:0.005997845903038979
The generated pressure mean: 0.42980000376701355
loss_pred:0.03281933069229126, decouple_loss:0.006096803117543459
Loss: 0.03312784433364868, avg_mse: 0.04781050607562065
current test mse: 0.047811
Iteration: 2531, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4542500376701355
loss_pred:0.019465569406747818, decouple_loss:0.005254488438367844
The generated pressure mean: 0.45722830295562744
loss_pred:0.01777399145066738, decouple_loss:0.005044412799179554
The generated pressure mean: 0.4533696174621582
loss_pred:0.017220964655280113, decouple_loss:0.005110591650009155
Iteration: 2532, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44124171137809753
loss_pred:0.018763335421681404, decouple_loss:0.005248942878097296
The generated pressure mean: 0.44514158368110657
loss_pred:0.019787002354860306, decouple_loss:0.005395296961069107
The generated pressure mean: 0.4468790292739868
loss_pred:0.01787141151726246, decouple_loss:0.005193033721297979
Iteration: 2533, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4329562783241272
loss_pred:0.019517889246344566, decouple_loss:0.006224874407052994
The generated pressure mean: 0.4365370273590088
loss_pred:0.01789381355047226, decouple_loss:0.006271896418184042
The generated pressure mean: 0.4376090168952942
loss_pred:0.01862025447189808, decouple_loss:0.006202019285410643
Iteration: 2534, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45191770792007446
loss_pred:0.018711112439632416, decouple_loss:0.00442467350512743
The generated pressure mean: 0.45274069905281067
loss_pred:0.01889866776764393, decouple_loss:0.00440386263653636
The generated pressure mean: 0.4472156763076782
loss_pred:0.019239384680986404, decouple_loss:0.004625875502824783
Iteration: 2535, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4627676010131836
loss_pred:0.0184849351644516, decouple_loss:0.007306366227567196
The generated pressure mean: 0.45751428604125977
loss_pred:0.017048463225364685, decouple_loss:0.00794162880629301
The generated pressure mean: 0.46085575222969055
loss_pred:0.01978917047381401, decouple_loss:0.007169645745307207
Iteration: 2536, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4463760256767273
loss_pred:0.017899220809340477, decouple_loss:0.00553424097597599
The generated pressure mean: 0.44947630167007446
loss_pred:0.017768550664186478, decouple_loss:0.005495075136423111
The generated pressure mean: 0.44430962204933167
loss_pred:0.019042296335101128, decouple_loss:0.005894303321838379
Iteration: 2537, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4414110779762268
loss_pred:0.017456362023949623, decouple_loss:0.006837010383605957
The generated pressure mean: 0.4381549060344696
loss_pred:0.017950188368558884, decouple_loss:0.0066208383068442345
The generated pressure mean: 0.4371798038482666
loss_pred:0.017479483038187027, decouple_loss:0.007002575322985649
Iteration: 2538, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44734707474708557
loss_pred:0.017410609871149063, decouple_loss:0.006091301329433918
The generated pressure mean: 0.44769370555877686
loss_pred:0.0180259607732296, decouple_loss:0.006468441803008318
The generated pressure mean: 0.4401325285434723
loss_pred:0.017878763377666473, decouple_loss:0.006643955130130053
Iteration: 2539, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4488356411457062
loss_pred:0.01836531050503254, decouple_loss:0.007123404182493687
The generated pressure mean: 0.44803735613822937
loss_pred:0.018160952255129814, decouple_loss:0.006898042745888233
The generated pressure mean: 0.44578829407691956
loss_pred:0.017164837568998337, decouple_loss:0.007403992582112551
Iteration: 2540, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45523157715797424
loss_pred:0.01831917278468609, decouple_loss:0.006334820296615362
The generated pressure mean: 0.4564659297466278
loss_pred:0.018644051626324654, decouple_loss:0.006352643016725779
The generated pressure mean: 0.4549698829650879
loss_pred:0.01917804591357708, decouple_loss:0.006314550060778856
2023-04-16 11:13:54 testing...
The generated pressure mean: 0.4179713726043701
loss_pred:0.03208596259355545, decouple_loss:0.0071009863168001175
The generated pressure mean: 0.42793846130371094
loss_pred:0.03175695613026619, decouple_loss:0.0071496316231787205
The generated pressure mean: 0.4309404492378235
loss_pred:0.03138219937682152, decouple_loss:0.00742556806653738
Loss: 0.032102975994348526, avg_mse: 0.04691179841756821
current test mse: 0.046912
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012013_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012013_3_24hr.npz
NaN value num: 0
Iteration: 2541, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4514075815677643
loss_pred:0.019087878987193108, decouple_loss:0.006583719048649073
The generated pressure mean: 0.4488440155982971
loss_pred:0.018754450604319572, decouple_loss:0.0065994830802083015
The generated pressure mean: 0.4513621926307678
loss_pred:0.01960154063999653, decouple_loss:0.006541840266436338
Iteration: 2542, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43712908029556274
loss_pred:0.019008612260222435, decouple_loss:0.006645487155765295
The generated pressure mean: 0.43612393736839294
The generated pressure mean: 0.43665361404418945
loss_pred:0.01800534315407276, decouple_loss:0.006623059511184692
loss_pred:0.01958201453089714, decouple_loss:0.006596743129193783
Iteration: 2543, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44564348459243774
loss_pred:0.01775968447327614, decouple_loss:0.00581743149086833
The generated pressure mean: 0.4412125051021576
loss_pred:0.019379694014787674, decouple_loss:0.005672131199389696
The generated pressure mean: 0.4446444511413574
loss_pred:0.020045205950737, decouple_loss:0.005950659513473511
Iteration: 2544, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44656431674957275
loss_pred:0.020234819501638412, decouple_loss:0.006302890833467245
The generated pressure mean: 0.4471881687641144
loss_pred:0.018937086686491966, decouple_loss:0.006139480974525213
The generated pressure mean: 0.44220155477523804
loss_pred:0.01851058006286621, decouple_loss:0.006043045315891504
Iteration: 2545, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4546307921409607
loss_pred:0.019879568368196487, decouple_loss:0.0059337434358894825
The generated pressure mean: 0.4538176655769348
loss_pred:0.018849017098546028, decouple_loss:0.005981501657515764
The generated pressure mean: 0.4520646333694458
loss_pred:0.018485775217413902, decouple_loss:0.0056490302085876465
Iteration: 2546, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45102229714393616
loss_pred:0.020054642111063004, decouple_loss:0.0070343902334570885
The generated pressure mean: 0.44456905126571655
loss_pred:0.01835329830646515, decouple_loss:0.00682709040120244
The generated pressure mean: 0.4475915729999542
loss_pred:0.0206321831792593, decouple_loss:0.006837007123976946
Iteration: 2547, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4323464334011078
loss_pred:0.01890544593334198, decouple_loss:0.006445786915719509
The generated pressure mean: 0.43262436985969543
loss_pred:0.018147461116313934, decouple_loss:0.006473960820585489
The generated pressure mean: 0.43352144956588745
loss_pred:0.019364913925528526, decouple_loss:0.0064639560878276825
Iteration: 2548, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4517963230609894
loss_pred:0.018944304436445236, decouple_loss:0.007287892512977123
The generated pressure mean: 0.4494836926460266
loss_pred:0.018673207610845566, decouple_loss:0.007134446408599615
The generated pressure mean: 0.4548630118370056
loss_pred:0.01838325522840023, decouple_loss:0.007170690689235926
Iteration: 2549, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45358774065971375
The generated pressure mean: 0.45360299944877625
loss_pred:0.017931630834937096, decouple_loss:0.006551806814968586
loss_pred:0.017906006425619125, decouple_loss:0.006717179901897907
The generated pressure mean: 0.4504414200782776
loss_pred:0.01831064745783806, decouple_loss:0.006691691465675831
Iteration: 2550, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4430139660835266
loss_pred:0.019357869401574135, decouple_loss:0.007339060306549072
The generated pressure mean: 0.44111084938049316
loss_pred:0.019529877230525017, decouple_loss:0.007363256998360157
The generated pressure mean: 0.4408262073993683
loss_pred:0.01910988800227642, decouple_loss:0.007537732366472483
2023-04-16 11:16:31 testing...
The generated pressure mean: 0.4176853597164154
loss_pred:0.03162512183189392, decouple_loss:0.006713429465889931
The generated pressure mean: 0.42546674609184265
loss_pred:0.03045528195798397, decouple_loss:0.006984615232795477
The generated pressure mean: 0.42820388078689575
loss_pred:0.031000250950455666, decouple_loss:0.007038526702672243
Loss: 0.031372494995594025, avg_mse: 0.04576748237013817
current test mse: 0.045767
Iteration: 2551, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4395178556442261
loss_pred:0.020087456330657005, decouple_loss:0.006185951177030802
The generated pressure mean: 0.43702802062034607
loss_pred:0.01979091204702854, decouple_loss:0.0061861323192715645
The generated pressure mean: 0.4374787509441376
loss_pred:0.019580645486712456, decouple_loss:0.006026413757354021
Iteration: 2552, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4538615345954895
loss_pred:0.017669951543211937, decouple_loss:0.0074976603500545025
The generated pressure mean: 0.44396474957466125
loss_pred:0.019082169979810715, decouple_loss:0.007332331035286188
The generated pressure mean: 0.447233647108078
loss_pred:0.019649365916848183, decouple_loss:0.007349470630288124
Iteration: 2553, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45062968134880066
loss_pred:0.01858457364141941, decouple_loss:0.006394509691745043
The generated pressure mean: 0.4494013488292694
loss_pred:0.018158819526433945, decouple_loss:0.006491989362984896
The generated pressure mean: 0.4490979015827179
loss_pred:0.01846068911254406, decouple_loss:0.006460412405431271
Iteration: 2554, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4382447898387909
loss_pred:0.018671516329050064, decouple_loss:0.006889375392347574
The generated pressure mean: 0.44296854734420776
loss_pred:0.019980520009994507, decouple_loss:0.006763475015759468
The generated pressure mean: 0.4434072971343994
loss_pred:0.01886088401079178, decouple_loss:0.006881751585751772
Iteration: 2555, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44773030281066895
loss_pred:0.018730148673057556, decouple_loss:0.005637092050164938
The generated pressure mean: 0.4490201473236084
loss_pred:0.019637521356344223, decouple_loss:0.005594586953520775
The generated pressure mean: 0.4501942992210388
loss_pred:0.018117064610123634, decouple_loss:0.005541220307350159
Iteration: 2556, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45575815439224243
loss_pred:0.018556717783212662, decouple_loss:0.007040867581963539
The generated pressure mean: 0.45423004031181335
loss_pred:0.018909646198153496, decouple_loss:0.00691604008898139
The generated pressure mean: 0.4538366198539734
loss_pred:0.01802346482872963, decouple_loss:0.006901667919009924
Iteration: 2557, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43515869975090027
The generated pressure mean: 0.4330359399318695
loss_pred:0.018499519675970078, decouple_loss:0.004656220320612192
loss_pred:0.020328490063548088, decouple_loss:0.00450906390324235
The generated pressure mean: 0.4370999336242676
loss_pred:0.01872093230485916, decouple_loss:0.004499916452914476
Iteration: 2558, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4504019320011139
loss_pred:0.017675936222076416, decouple_loss:0.006509850267320871
The generated pressure mean: 0.4452994763851166
loss_pred:0.018447399139404297, decouple_loss:0.0066022067330777645
The generated pressure mean: 0.4462181627750397
loss_pred:0.019336022436618805, decouple_loss:0.006612080615013838
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 2559, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4437520205974579
loss_pred:0.018555955961346626, decouple_loss:0.00489079300314188
The generated pressure mean: 0.4470544159412384
loss_pred:0.017763443291187286, decouple_loss:0.004646793007850647
The generated pressure mean: 0.4501204192638397
loss_pred:0.01801243983209133, decouple_loss:0.004630940966308117
Iteration: 2560, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44769829511642456
The generated pressure mean: 0.44419795274734497loss_pred:0.01841118186712265, decouple_loss:0.006159686949104071
loss_pred:0.01809837482869625, decouple_loss:0.0060973698273301125
The generated pressure mean: 0.4419320523738861
loss_pred:0.01951250620186329, decouple_loss:0.0061320229433476925
2023-04-16 11:18:31 testing...
The generated pressure mean: 0.41660070419311523
loss_pred:0.03281496837735176, decouple_loss:0.005658923182636499
The generated pressure mean: 0.42613813281059265
loss_pred:0.031005682423710823, decouple_loss:0.005766239482909441
The generated pressure mean: 0.42877036333084106
loss_pred:0.031937550753355026, decouple_loss:0.005921889096498489
Loss: 0.03220852091908455, avg_mse: 0.0474478155374527
current test mse: 0.047448
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012012_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012012_3_24hr.npz
NaN value num: 0
Iteration: 2561, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44456109404563904
loss_pred:0.01909158006310463, decouple_loss:0.00524485856294632
The generated pressure mean: 0.44848960638046265
loss_pred:0.017373062670230865, decouple_loss:0.0050657945685088634
The generated pressure mean: 0.44441893696784973
loss_pred:0.0182560496032238, decouple_loss:0.005149596370756626
Iteration: 2562, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4563046395778656
loss_pred:0.017861241474747658, decouple_loss:0.005506410263478756
The generated pressure mean: 0.45672133564949036
loss_pred:0.01805981807410717, decouple_loss:0.005300821736454964
The generated pressure mean: 0.458016037940979
loss_pred:0.01791139878332615, decouple_loss:0.00532270222902298
Iteration: 2563, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44742193818092346
loss_pred:0.01968657784163952, decouple_loss:0.0056779878214001656
The generated pressure mean: 0.44399216771125793
loss_pred:0.017546461895108223, decouple_loss:0.005469928961247206
The generated pressure mean: 0.44852423667907715
loss_pred:0.0180122721940279, decouple_loss:0.005521515384316444
Iteration: 2564, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43913978338241577
loss_pred:0.017548082396388054, decouple_loss:0.0049994573928415775
The generated pressure mean: 0.4357863664627075
loss_pred:0.01779831200838089, decouple_loss:0.0051048328168690205
The generated pressure mean: 0.43825697898864746
loss_pred:0.018464630469679832, decouple_loss:0.005083888303488493
Iteration: 2565, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4423739016056061
loss_pred:0.017858780920505524, decouple_loss:0.005359516479074955
The generated pressure mean: 0.45114022493362427
loss_pred:0.017901010811328888, decouple_loss:0.005253147333860397
The generated pressure mean: 0.4493507444858551
loss_pred:0.017943046987056732, decouple_loss:0.005533589981496334
Iteration: 2566, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45145899057388306
loss_pred:0.017750514671206474, decouple_loss:0.004651815164834261
The generated pressure mean: 0.4514153301715851
loss_pred:0.017705783247947693, decouple_loss:0.0046251751482486725
The generated pressure mean: 0.4433837831020355
loss_pred:0.01807248964905739, decouple_loss:0.004693036433309317
Iteration: 2567, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4494571089744568
loss_pred:0.018033679574728012, decouple_loss:0.005579999648034573
The generated pressure mean: 0.44605425000190735
loss_pred:0.018384847790002823, decouple_loss:0.005404219962656498
The generated pressure mean: 0.4465988874435425
loss_pred:0.01871440000832081, decouple_loss:0.005105084273964167
Iteration: 2568, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.446681946516037
loss_pred:0.017936520278453827, decouple_loss:0.004356099292635918
The generated pressure mean: 0.4452493190765381
loss_pred:0.018178129568696022, decouple_loss:0.004386539570987225
The generated pressure mean: 0.4467967748641968
loss_pred:0.018068253993988037, decouple_loss:0.004441950470209122
Iteration: 2569, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4511117935180664
loss_pred:0.02001142129302025, decouple_loss:0.005313989240676165
The generated pressure mean: 0.4438555836677551
loss_pred:0.018828734755516052, decouple_loss:0.005725021008402109
The generated pressure mean: 0.4501875936985016
loss_pred:0.017541587352752686, decouple_loss:0.005228626541793346
Iteration: 2570, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4514232873916626
loss_pred:0.01852179877460003, decouple_loss:0.0044974107295274734
The generated pressure mean: 0.44536396861076355
loss_pred:0.018529755994677544, decouple_loss:0.004465938080102205
The generated pressure mean: 0.4517941176891327
loss_pred:0.020166758447885513, decouple_loss:0.004458911716938019
2023-04-16 11:21:16 testing...
The generated pressure mean: 0.41729527711868286
loss_pred:0.030757401138544083, decouple_loss:0.005083726719021797
The generated pressure mean: 0.4251379668712616
loss_pred:0.02968020923435688, decouple_loss:0.0051237186416983604
The generated pressure mean: 0.4275968074798584
loss_pred:0.029948119074106216, decouple_loss:0.005486867856234312
Loss: 0.030390148982405663, avg_mse: 0.044124942272901535
current test mse: 0.044125
Iteration: 2571, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44562196731567383
The generated pressure mean: 0.4472697675228119
loss_pred:0.017493836581707, decouple_loss:0.004785649944096804
loss_pred:0.017098646610975266, decouple_loss:0.0049464465118944645
The generated pressure mean: 0.4466075003147125
loss_pred:0.018682420253753662, decouple_loss:0.004554972983896732
Iteration: 2572, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44187605381011963
loss_pred:0.018178869038820267, decouple_loss:0.005173308774828911
The generated pressure mean: 0.44382545351982117
loss_pred:0.01860031671822071, decouple_loss:0.0054409257136285305
The generated pressure mean: 0.44277024269104004
loss_pred:0.018799232318997383, decouple_loss:0.00544721120968461
Iteration: 2573, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4465222656726837
loss_pred:0.018226057291030884, decouple_loss:0.004625198431313038
The generated pressure mean: 0.44352155923843384
loss_pred:0.01751028560101986, decouple_loss:0.0046651591546833515
The generated pressure mean: 0.447233647108078
loss_pred:0.01825227402150631, decouple_loss:0.004695137031376362
Iteration: 2574, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4540804624557495
loss_pred:0.018744846805930138, decouple_loss:0.005920298397541046
The generated pressure mean: 0.4564363360404968
loss_pred:0.018452949821949005, decouple_loss:0.0056180874817073345
The generated pressure mean: 0.45494285225868225
loss_pred:0.01786980964243412, decouple_loss:0.005762680899351835
Iteration: 2575, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43900060653686523
loss_pred:0.018014436587691307, decouple_loss:0.005262667778879404
The generated pressure mean: 0.4415479898452759
loss_pred:0.01805289089679718, decouple_loss:0.005365921184420586
The generated pressure mean: 0.4385125935077667
loss_pred:0.018344901502132416, decouple_loss:0.004963311366736889
Iteration: 2576, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4419102966785431
loss_pred:0.020100843161344528, decouple_loss:0.006599797867238522
The generated pressure mean: 0.44039082527160645
loss_pred:0.018290067091584206, decouple_loss:0.0066252159886062145
The generated pressure mean: 0.4321056008338928
loss_pred:0.019393285736441612, decouple_loss:0.007015865761786699
Iteration: 2577, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4482627809047699
loss_pred:0.018567319959402084, decouple_loss:0.00557330809533596
The generated pressure mean: 0.45354989171028137
loss_pred:0.018474450334906578, decouple_loss:0.005735582206398249
The generated pressure mean: 0.4496646821498871
loss_pred:0.019260480999946594, decouple_loss:0.00562092661857605
Iteration: 2578, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4564032554626465
loss_pred:0.01861738972365856, decouple_loss:0.005226914305239916
The generated pressure mean: 0.4497327506542206
loss_pred:0.01806800253689289, decouple_loss:0.00513661652803421
The generated pressure mean: 0.46314865350723267
loss_pred:0.01836034655570984, decouple_loss:0.005389604717493057
Iteration: 2579, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45108601450920105
loss_pred:0.0177915059030056, decouple_loss:0.004927807953208685
The generated pressure mean: 0.45292869210243225
loss_pred:0.01786990463733673, decouple_loss:0.005030527710914612
The generated pressure mean: 0.4499526023864746
loss_pred:0.0183771550655365, decouple_loss:0.004950101021677256
Iteration: 2580, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.42729419469833374
loss_pred:0.018836485221982002, decouple_loss:0.004920154809951782The generated pressure mean: 0.42571574449539185
loss_pred:0.018827280029654503, decouple_loss:0.005208901129662991
The generated pressure mean: 0.43275168538093567
loss_pred:0.01784602552652359, decouple_loss:0.005152789875864983
2023-04-16 11:23:16 testing...
The generated pressure mean: 0.41805216670036316
loss_pred:0.03255563601851463, decouple_loss:0.004842293448746204
The generated pressure mean: 0.4260585308074951
loss_pred:0.030995626002550125, decouple_loss:0.004882024135440588
The generated pressure mean: 0.4287613034248352
loss_pred:0.031744375824928284, decouple_loss:0.004941366147249937
Loss: 0.03200963884592056, avg_mse: 0.04674495756626129
current test mse: 0.046745
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012007_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012007_3_24hr.npz
NaN value num: 0
Iteration: 2581, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44956478476524353
loss_pred:0.018300972878932953, decouple_loss:0.004866787698119879
The generated pressure mean: 0.44878333806991577
loss_pred:0.01878397725522518, decouple_loss:0.004817713983356953
The generated pressure mean: 0.44704726338386536
loss_pred:0.01896350271999836, decouple_loss:0.004361684899777174
Iteration: 2582, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4602189362049103
loss_pred:0.018871767446398735, decouple_loss:0.004865983966737986
The generated pressure mean: 0.4633685350418091
loss_pred:0.019521892070770264, decouple_loss:0.0053102378733456135
The generated pressure mean: 0.4578784704208374
loss_pred:0.017206668853759766, decouple_loss:0.004864336922764778
Iteration: 2583, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4509337246417999
loss_pred:0.018817618489265442, decouple_loss:0.005269685294479132
The generated pressure mean: 0.4490528702735901
The generated pressure mean: 0.45098698139190674
loss_pred:0.018152406439185143, decouple_loss:0.0055849505588412285
loss_pred:0.019103143364191055, decouple_loss:0.00560565572232008
Iteration: 2584, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4404442608356476
loss_pred:0.019775914028286934, decouple_loss:0.0042317998595535755
The generated pressure mean: 0.4406607151031494
loss_pred:0.01921827532351017, decouple_loss:0.004310871474444866
The generated pressure mean: 0.442685067653656
loss_pred:0.01820320077240467, decouple_loss:0.004284407012164593
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 2585, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4403117001056671
loss_pred:0.019015442579984665, decouple_loss:0.006086260080337524
The generated pressure mean: 0.4396689534187317
loss_pred:0.018061978742480278, decouple_loss:0.005735443904995918
The generated pressure mean: 0.4367471933364868
loss_pred:0.01862681657075882, decouple_loss:0.005610608961433172
Iteration: 2586, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45285117626190186
The generated pressure mean: 0.44610607624053955
loss_pred:0.01811741478741169, decouple_loss:0.005540556740015745
loss_pred:0.017130525782704353, decouple_loss:0.005413280799984932
The generated pressure mean: 0.4526844322681427
loss_pred:0.018986329436302185, decouple_loss:0.005604372825473547
Iteration: 2587, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4528871178627014
loss_pred:0.01857854053378105, decouple_loss:0.005384152289479971
The generated pressure mean: 0.4545261859893799
loss_pred:0.01866922527551651, decouple_loss:0.005199553444981575
The generated pressure mean: 0.4507494568824768
loss_pred:0.0182410329580307, decouple_loss:0.0049491156823933125
Iteration: 2588, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4442889392375946
The generated pressure mean: 0.4421918988227844
loss_pred:0.017288073897361755, decouple_loss:0.005146618466824293
loss_pred:0.01931435987353325, decouple_loss:0.005266580730676651
The generated pressure mean: 0.4413866102695465
loss_pred:0.0174665916711092, decouple_loss:0.005301094613969326
Iteration: 2589, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44695183634757996
loss_pred:0.018839213997125626, decouple_loss:0.0048792362213134766
The generated pressure mean: 0.4459824860095978
loss_pred:0.018964318558573723, decouple_loss:0.0048754154704511166
The generated pressure mean: 0.44373393058776855
loss_pred:0.018189072608947754, decouple_loss:0.004874377511441708
Iteration: 2590, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4545327126979828
loss_pred:0.018348783254623413, decouple_loss:0.004859705921262503
The generated pressure mean: 0.45863616466522217
loss_pred:0.019434943795204163, decouple_loss:0.005204653367400169
The generated pressure mean: 0.45894017815589905
loss_pred:0.019995499402284622, decouple_loss:0.005206629168242216
2023-04-16 11:25:50 testing...
The generated pressure mean: 0.42165428400039673
loss_pred:0.03149878978729248, decouple_loss:0.0052231778390705585
The generated pressure mean: 0.43006661534309387
loss_pred:0.03038203716278076, decouple_loss:0.005509964656084776
The generated pressure mean: 0.4330997169017792
loss_pred:0.03030950017273426, decouple_loss:0.005639704875648022
Loss: 0.031002990901470184, avg_mse: 0.045719537883996964
current test mse: 0.04572
Iteration: 2591, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4346122443675995
loss_pred:0.01798364333808422, decouple_loss:0.004669264890253544
The generated pressure mean: 0.4308250844478607
loss_pred:0.018777063116431236, decouple_loss:0.00463779317215085
The generated pressure mean: 0.4367040991783142
loss_pred:0.018386244773864746, decouple_loss:0.004529655911028385
Iteration: 2592, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4440172016620636
loss_pred:0.019209936261177063, decouple_loss:0.004398415330797434
The generated pressure mean: 0.4356893002986908
loss_pred:0.0185838732868433, decouple_loss:0.004603179637342691
The generated pressure mean: 0.4430254399776459
loss_pred:0.01876366138458252, decouple_loss:0.004302510991692543
Iteration: 2593, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45904502272605896
loss_pred:0.0179249569773674, decouple_loss:0.004361501429229975
The generated pressure mean: 0.4634963572025299
loss_pred:0.018009211868047714, decouple_loss:0.004284926224499941
The generated pressure mean: 0.4629487693309784
loss_pred:0.01783067174255848, decouple_loss:0.004458179231733084
Iteration: 2594, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44928833842277527
loss_pred:0.019905775785446167, decouple_loss:0.00403031287714839
The generated pressure mean: 0.44950923323631287
loss_pred:0.01910674199461937, decouple_loss:0.0038632105570286512
The generated pressure mean: 0.45057371258735657
loss_pred:0.01929512806236744, decouple_loss:0.004058943595737219
Iteration: 2595, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4352298676967621
loss_pred:0.017427977174520493, decouple_loss:0.005407759919762611
The generated pressure mean: 0.4370420575141907
loss_pred:0.018620871007442474, decouple_loss:0.005497308447957039
The generated pressure mean: 0.44086122512817383
loss_pred:0.017737392336130142, decouple_loss:0.005289479158818722
Iteration: 2596, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4401351809501648
loss_pred:0.01956779882311821, decouple_loss:0.0041762301698327065
The generated pressure mean: 0.44077810645103455
loss_pred:0.018343539908528328, decouple_loss:0.004167046397924423
The generated pressure mean: 0.4432389438152313
loss_pred:0.018309611827135086, decouple_loss:0.004250270314514637
Iteration: 2597, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4494473338127136
loss_pred:0.01811859756708145, decouple_loss:0.005190087482333183
The generated pressure mean: 0.4513179063796997
loss_pred:0.018804684281349182, decouple_loss:0.005169425159692764
The generated pressure mean: 0.4510003924369812
loss_pred:0.018226824700832367, decouple_loss:0.005118843168020248
Iteration: 2598, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.451450377702713
The generated pressure mean: 0.44562485814094543loss_pred:0.016887102276086807, decouple_loss:0.00522511824965477
loss_pred:0.018157726153731346, decouple_loss:0.005058027803897858
The generated pressure mean: 0.44703882932662964
loss_pred:0.01889610104262829, decouple_loss:0.0052123297937214375
Iteration: 2599, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44884636998176575
loss_pred:0.017562590539455414, decouple_loss:0.0046808174811303616
The generated pressure mean: 0.45043477416038513
loss_pred:0.01707850769162178, decouple_loss:0.00472656823694706
The generated pressure mean: 0.4437815248966217
loss_pred:0.018629074096679688, decouple_loss:0.005162539891898632
Iteration: 2600, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4477316737174988
loss_pred:0.016669219359755516, decouple_loss:0.005191350821405649
The generated pressure mean: 0.448597252368927
loss_pred:0.020536208525300026, decouple_loss:0.00536437937989831
The generated pressure mean: 0.44680243730545044
loss_pred:0.018118318170309067, decouple_loss:0.005515961907804012
2023-04-16 11:27:50 testing...
The generated pressure mean: 0.4192328453063965
loss_pred:0.032146092504262924, decouple_loss:0.004532510880380869
The generated pressure mean: 0.4266960620880127
loss_pred:0.030855875462293625, decouple_loss:0.0046953726559877396
The generated pressure mean: 0.4297757148742676
loss_pred:0.031046975404024124, decouple_loss:0.004807314835488796
Loss: 0.03158356994390488, avg_mse: 0.04671365022659302
current test mse: 0.046714
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012000_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012000_3_24hr.npz
NaN value num: 0
Iteration: 2601, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4430258870124817
loss_pred:0.01865800842642784, decouple_loss:0.004171926062554121
The generated pressure mean: 0.44365599751472473
loss_pred:0.01813586615025997, decouple_loss:0.004063685890287161
The generated pressure mean: 0.4455828070640564
loss_pred:0.017938805744051933, decouple_loss:0.003994106315076351
Iteration: 2602, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43828457593917847
loss_pred:0.018910402432084084, decouple_loss:0.004775907378643751
The generated pressure mean: 0.4338379204273224
loss_pred:0.018342530354857445, decouple_loss:0.004808444529771805
The generated pressure mean: 0.44070833921432495
loss_pred:0.017166048288345337, decouple_loss:0.004813722800463438
Iteration: 2603, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44933751225471497
loss_pred:0.017566949129104614, decouple_loss:0.00416847039014101
The generated pressure mean: 0.44630369544029236
loss_pred:0.017885740846395493, decouple_loss:0.004285498987883329
The generated pressure mean: 0.44849300384521484
loss_pred:0.017287306487560272, decouple_loss:0.0041478415951132774
Iteration: 2604, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4570005238056183
loss_pred:0.01785145327448845, decouple_loss:0.005125144962221384
The generated pressure mean: 0.45598429441452026
loss_pred:0.019953535869717598, decouple_loss:0.005106798373162746
The generated pressure mean: 0.45773622393608093
loss_pred:0.017510727047920227, decouple_loss:0.0049481443129479885
Iteration: 2605, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.448279470205307
loss_pred:0.018714813515543938, decouple_loss:0.00473986379802227
The generated pressure mean: 0.4487660229206085
loss_pred:0.017650559544563293, decouple_loss:0.004562948364764452
The generated pressure mean: 0.4439179599285126
loss_pred:0.020257458090782166, decouple_loss:0.0046545518562197685
Iteration: 2606, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44021108746528625
loss_pred:0.017844028770923615, decouple_loss:0.005210130009800196
The generated pressure mean: 0.43695068359375
loss_pred:0.01854010671377182, decouple_loss:0.005173036828637123
The generated pressure mean: 0.4325987994670868
loss_pred:0.017917687073349953, decouple_loss:0.005017152521759272
Iteration: 2607, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4432811439037323
loss_pred:0.01795009709894657, decouple_loss:0.0046067493967711926
The generated pressure mean: 0.45053842663764954
loss_pred:0.018114514648914337, decouple_loss:0.004597439896315336
The generated pressure mean: 0.4493909478187561
loss_pred:0.01956210657954216, decouple_loss:0.004658483900129795
Iteration: 2608, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45242631435394287
loss_pred:0.019543219357728958, decouple_loss:0.004542335402220488
The generated pressure mean: 0.45795032382011414
loss_pred:0.018230432644486427, decouple_loss:0.004422349855303764
The generated pressure mean: 0.4427570700645447
loss_pred:0.017400719225406647, decouple_loss:0.004492306616157293
Iteration: 2609, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44627314805984497
loss_pred:0.017727002501487732, decouple_loss:0.0056498791091144085
The generated pressure mean: 0.4485154449939728
loss_pred:0.018729407340288162, decouple_loss:0.005544687155634165
The generated pressure mean: 0.4445350766181946
loss_pred:0.018613215535879135, decouple_loss:0.0056168739683926105
Iteration: 2610, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44042837619781494
loss_pred:0.018897078931331635, decouple_loss:0.004130118060857058
The generated pressure mean: 0.4359869360923767
loss_pred:0.01900072954595089, decouple_loss:0.004222337622195482
The generated pressure mean: 0.4399835169315338
loss_pred:0.01877831295132637, decouple_loss:0.0040920572355389595
2023-04-16 11:30:26 testing...
The generated pressure mean: 0.41709598898887634
loss_pred:0.03172490373253822, decouple_loss:0.0048523093573749065
The generated pressure mean: 0.424355685710907
loss_pred:0.029859691858291626, decouple_loss:0.005061313044279814
The generated pressure mean: 0.4281865656375885
loss_pred:0.030845001339912415, decouple_loss:0.00518495449796319
Loss: 0.031061511486768723, avg_mse: 0.045641884207725525
current test mse: 0.045642
Iteration: 2611, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4515431523323059
loss_pred:0.017908938229084015, decouple_loss:0.004458718933165073
The generated pressure mean: 0.45054545998573303
loss_pred:0.018515631556510925, decouple_loss:0.004468179773539305
The generated pressure mean: 0.45626527070999146
loss_pred:0.017986560240387917, decouple_loss:0.0043350146152079105
Iteration: 2612, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4478400945663452
loss_pred:0.01801803521811962, decouple_loss:0.004281340632587671
The generated pressure mean: 0.45151498913764954
loss_pred:0.018348418176174164, decouple_loss:0.004434516187757254
The generated pressure mean: 0.45076021552085876
loss_pred:0.019585881382226944, decouple_loss:0.004324453417211771
Iteration: 2613, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43818399310112
loss_pred:0.019465170800685883, decouple_loss:0.004893876146525145
The generated pressure mean: 0.44277915358543396
loss_pred:0.018638884648680687, decouple_loss:0.004733718000352383
The generated pressure mean: 0.43819066882133484
loss_pred:0.019267048686742783, decouple_loss:0.004923159722238779
Iteration: 2614, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4449583888053894
loss_pred:0.016930555924773216, decouple_loss:0.004838952794671059
The generated pressure mean: 0.4421311318874359
loss_pred:0.01800144650042057, decouple_loss:0.004905772861093283
The generated pressure mean: 0.44561639428138733
loss_pred:0.01713605970144272, decouple_loss:0.00492492038756609
Iteration: 2615, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45439663529396057
loss_pred:0.019374586641788483, decouple_loss:0.004419059492647648
The generated pressure mean: 0.44862544536590576
loss_pred:0.017525719478726387, decouple_loss:0.004170579835772514
The generated pressure mean: 0.4447809159755707
loss_pred:0.01989050954580307, decouple_loss:0.004260071087628603
Iteration: 2616, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4401714503765106
loss_pred:0.01808823272585869, decouple_loss:0.005240802187472582
The generated pressure mean: 0.4413830041885376
loss_pred:0.01809116080403328, decouple_loss:0.005159136839210987
The generated pressure mean: 0.4476122558116913
loss_pred:0.017410986125469208, decouple_loss:0.0052121481858193874
Iteration: 2617, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4547879099845886
loss_pred:0.01857171580195427, decouple_loss:0.005347182042896748
The generated pressure mean: 0.4506005048751831
loss_pred:0.01778300479054451, decouple_loss:0.0054321009665727615
The generated pressure mean: 0.4574637711048126
loss_pred:0.01892007328569889, decouple_loss:0.005551458336412907
Iteration: 2618, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4399332106113434
loss_pred:0.017654215916991234, decouple_loss:0.004281407222151756
The generated pressure mean: 0.44217297434806824
loss_pred:0.017822114750742912, decouple_loss:0.004324978217482567
The generated pressure mean: 0.4448917806148529
loss_pred:0.018391329795122147, decouple_loss:0.004275143146514893
Iteration: 2619, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4390253722667694
loss_pred:0.01912297122180462, decouple_loss:0.005739820655435324
The generated pressure mean: 0.440856009721756
loss_pred:0.019670099020004272, decouple_loss:0.005704551003873348
The generated pressure mean: 0.4391755163669586
loss_pred:0.017476534470915794, decouple_loss:0.005554753355681896
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 2620, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44629302620887756
loss_pred:0.017766986042261124, decouple_loss:0.004545236472040415
The generated pressure mean: 0.45323485136032104
loss_pred:0.018832821398973465, decouple_loss:0.004549018573015928
The generated pressure mean: 0.4523504674434662
loss_pred:0.01816548779606819, decouple_loss:0.004447746090590954
2023-04-16 11:32:26 testing...
The generated pressure mean: 0.4161281883716583
loss_pred:0.03193075209856033, decouple_loss:0.006488311570137739
The generated pressure mean: 0.42386531829833984
loss_pred:0.031108759343624115, decouple_loss:0.0065087126567959785
The generated pressure mean: 0.42695048451423645
loss_pred:0.03141625225543976, decouple_loss:0.006663578562438488
Loss: 0.03181293234229088, avg_mse: 0.04690123721957207
current test mse: 0.046901
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012004_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012004_3_24hr.npz
NaN value num: 0
Iteration: 2621, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45306915044784546
loss_pred:0.01761055551469326, decouple_loss:0.00612180819734931
The generated pressure mean: 0.45035049319267273
loss_pred:0.01799677312374115, decouple_loss:0.005999810993671417
The generated pressure mean: 0.45429620146751404
loss_pred:0.01874212920665741, decouple_loss:0.006267495919018984
Iteration: 2622, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4443246126174927
The generated pressure mean: 0.44656166434288025
loss_pred:0.01759813353419304, decouple_loss:0.00471923965960741
loss_pred:0.01772207021713257, decouple_loss:0.0046176123432815075
The generated pressure mean: 0.44314044713974
loss_pred:0.017050331458449364, decouple_loss:0.004701172932982445
Iteration: 2623, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44430023431777954
loss_pred:0.018001118674874306, decouple_loss:0.004925623536109924
The generated pressure mean: 0.4479214549064636The generated pressure mean: 0.4406178593635559
loss_pred:0.016809839755296707, decouple_loss:0.004993243142962456loss_pred:0.018336039036512375, decouple_loss:0.00524059496819973
Iteration: 2624, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4451228678226471
loss_pred:0.017030181363224983, decouple_loss:0.004555976949632168
The generated pressure mean: 0.44646868109703064
loss_pred:0.016659827902913094, decouple_loss:0.004227096680551767
The generated pressure mean: 0.4447118639945984
loss_pred:0.018317997455596924, decouple_loss:0.0042539723217487335
Iteration: 2625, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45037841796875
loss_pred:0.017872603610157967, decouple_loss:0.005017004441469908
The generated pressure mean: 0.4517925977706909
loss_pred:0.01781284809112549, decouple_loss:0.005040536168962717
The generated pressure mean: 0.45271384716033936
loss_pred:0.01679076999425888, decouple_loss:0.004992951173335314
Iteration: 2626, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44618821144104004
loss_pred:0.01770384982228279, decouple_loss:0.004736241884529591
The generated pressure mean: 0.44400903582572937
loss_pred:0.01785297505557537, decouple_loss:0.004516809247434139
The generated pressure mean: 0.44851571321487427
loss_pred:0.017428720369935036, decouple_loss:0.004589402582496405
Iteration: 2627, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4405156672000885
loss_pred:0.020958533510565758, decouple_loss:0.0040392447263002396
The generated pressure mean: 0.4419378638267517
loss_pred:0.01801159977912903, decouple_loss:0.0041333772242069244
The generated pressure mean: 0.4360215663909912
loss_pred:0.018865860998630524, decouple_loss:0.004027996677905321
Iteration: 2628, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45404306054115295
loss_pred:0.01802969165146351, decouple_loss:0.004104980733245611
The generated pressure mean: 0.4503359794616699
loss_pred:0.01756424643099308, decouple_loss:0.003934737294912338
The generated pressure mean: 0.4546196162700653
loss_pred:0.017764175310730934, decouple_loss:0.004014420788735151
Iteration: 2629, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45498228073120117
loss_pred:0.017715642228722572, decouple_loss:0.003957381471991539
The generated pressure mean: 0.4573003053665161
loss_pred:0.019024576991796494, decouple_loss:0.003759688464924693
The generated pressure mean: 0.45318591594696045
loss_pred:0.017020301893353462, decouple_loss:0.004053079057484865
Iteration: 2630, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.443361759185791
loss_pred:0.017943451181054115, decouple_loss:0.0044352104887366295
The generated pressure mean: 0.4420139491558075
loss_pred:0.01760360226035118, decouple_loss:0.004284068010747433
The generated pressure mean: 0.44411569833755493
loss_pred:0.017707467079162598, decouple_loss:0.004479017108678818
2023-04-16 11:35:06 testing...
The generated pressure mean: 0.4193403124809265
loss_pred:0.03345092758536339, decouple_loss:0.004124892875552177
The generated pressure mean: 0.428095281124115
loss_pred:0.03225009888410568, decouple_loss:0.004339167848229408
The generated pressure mean: 0.43106013536453247
loss_pred:0.03253185376524925, decouple_loss:0.004559187218546867
Loss: 0.032961346209049225, avg_mse: 0.04897425323724747
current test mse: 0.048974
Iteration: 2631, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44425714015960693
loss_pred:0.01855640858411789, decouple_loss:0.0034656941425055265
The generated pressure mean: 0.44231680035591125
loss_pred:0.018151378259062767, decouple_loss:0.003372670616954565
The generated pressure mean: 0.44345197081565857
loss_pred:0.018759198486804962, decouple_loss:0.003533719340339303
Iteration: 2632, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43992671370506287
loss_pred:0.01748715154826641, decouple_loss:0.0037520546466112137
The generated pressure mean: 0.44096896052360535
loss_pred:0.017981279641389847, decouple_loss:0.0038157878443598747
The generated pressure mean: 0.44022345542907715
loss_pred:0.018402524292469025, decouple_loss:0.0038220062851905823
Iteration: 2633, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4575488269329071
loss_pred:0.018085524439811707, decouple_loss:0.0046186442486941814
The generated pressure mean: 0.4578143060207367
loss_pred:0.018889453262090683, decouple_loss:0.0045457929372787476
The generated pressure mean: 0.45788589119911194
loss_pred:0.017499413341283798, decouple_loss:0.004659806843847036
Iteration: 2634, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4594801664352417
loss_pred:0.017490044236183167, decouple_loss:0.003950389567762613
The generated pressure mean: 0.45431849360466003
loss_pred:0.018750328570604324, decouple_loss:0.003869234351441264
The generated pressure mean: 0.4563944339752197
loss_pred:0.017639365047216415, decouple_loss:0.003845755010843277
Iteration: 2635, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4272381067276001
loss_pred:0.01880607195198536, decouple_loss:0.0046623023226857185
The generated pressure mean: 0.4331338703632355
loss_pred:0.017410356551408768, decouple_loss:0.004711283836513758
The generated pressure mean: 0.43065887689590454
loss_pred:0.01688280515372753, decouple_loss:0.004521596245467663
Iteration: 2636, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4386277198791504
loss_pred:0.016965612769126892, decouple_loss:0.004514793865382671
The generated pressure mean: 0.4372750222682953
loss_pred:0.017534606158733368, decouple_loss:0.0044634281657636166
The generated pressure mean: 0.4382895231246948
