After initialize model, args.img_channel:3
load model: /work/09012/haoli1/ls6/ERA5_PredRNN/checkpoints/WV_0_PC_1_EH_0_PS_40/model_model_test_schedule_sampling_DynaMean.ckpt
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012000_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012001_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012002_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012003_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012004_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012005_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012006_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012007_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012008_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012009_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012010_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012011_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012012_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012013_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012014_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012015_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012016_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012017_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012018_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012019_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012020_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012000_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012001_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012002_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012003_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012004_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012005_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012006_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012007_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012008_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012009_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012010_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012011_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012012_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012013_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012014_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012015_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012016_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012017_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012018_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012019_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012020_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012000_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012001_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012002_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012003_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012004_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012005_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012006_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012007_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012008_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012009_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012010_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012011_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012012_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012013_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012014_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012015_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012016_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012017_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012018_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012019_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012020_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012000_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012001_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012002_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012003_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012004_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012005_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012006_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012007_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012008_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012009_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012010_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012011_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012012_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012013_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012014_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012015_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012016_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012017_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012018_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012019_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012020_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012000_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012001_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012002_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012003_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012004_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012005_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012006_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012007_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012008_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012009_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012010_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012011_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012012_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012013_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012014_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012015_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012016_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012017_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012018_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012019_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012000_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012001_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012002_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012003_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012004_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012005_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012006_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012007_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012008_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012009_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012010_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012011_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012012_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012013_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012014_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012015_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012016_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012017_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012018_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012019_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012020_3_24hr.npz
train_data_files nums: 125
mnist test iterator, Loading data from /scratch/09012/haoli1/ERA5/val_dataset/era5_train_09012020_3_24hr.npz
NaN value num: 0
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012002_3_24hr.npz
NaN value num: 0
Iteration: 1, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44837766885757446, gen p mean: -0.0412619449198246, mean p set: 0.44885799288749695
loss_pred:0.015164308249950409, decouple_loss:0.0009216423495672643
The modified gen p mean: 0.451656699180603, gen p mean: -0.037655528634786606, mean p set: 0.4521370232105255
loss_pred:0.01550466101616621, decouple_loss:0.0010136880446225405
The modified gen p mean: 0.4497550427913666, gen p mean: -0.033310309052467346, mean p set: 0.4502353370189667
loss_pred:0.015290793962776661, decouple_loss:0.0010163724655285478
/work/09012/haoli1/ls6/Pyt/lib/python3.9/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '
Iteration: 2, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44856274127960205, gen p mean: -0.045776668936014175, mean p set: 0.44904303550720215
The modified gen p mean: 0.4472678005695343, gen p mean: -0.041746776551008224, mean p set: 0.447748064994812
loss_pred:0.0220180694013834, decouple_loss:0.006662823725491762
loss_pred:0.021373054012656212, decouple_loss:0.006546841934323311
The modified gen p mean: 0.4472696781158447, gen p mean: -0.049055006355047226, mean p set: 0.4477499723434448
loss_pred:0.02132371999323368, decouple_loss:0.00681731291115284
Iteration: 3, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488906264305115, gen p mean: -0.03801481053233147, mean p set: 0.4493709206581116
loss_pred:0.01600884273648262, decouple_loss:0.00496967788785696
The modified gen p mean: 0.44979915022850037, gen p mean: -0.03630324825644493, mean p set: 0.4502794146537781The modified gen p mean: 0.4499562680721283, gen p mean: -0.028796305879950523, mean p set: 0.4504365622997284
loss_pred:0.016150474548339844, decouple_loss:0.005118494387716055
loss_pred:0.015583663247525692, decouple_loss:0.004842786584049463
Iteration: 4, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488476812839508, gen p mean: -0.038508135825395584, mean p set: 0.4493279755115509
loss_pred:0.014715234749019146, decouple_loss:0.0033243035431951284
The modified gen p mean: 0.4475484788417816, gen p mean: -0.03135040029883385, mean p set: 0.4480287730693817The modified gen p mean: 0.4486962556838989, gen p mean: -0.03158289194107056, mean p set: 0.449176549911499
loss_pred:0.01590515673160553, decouple_loss:0.003325538244098425
loss_pred:0.01671241968870163, decouple_loss:0.0033439714461565018
Iteration: 5, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44961124658584595, gen p mean: -0.03136139735579491, mean p set: 0.45009157061576843
loss_pred:0.014760864898562431, decouple_loss:0.0035694779362529516
The modified gen p mean: 0.44755738973617554, gen p mean: -0.02753644436597824, mean p set: 0.44803765416145325The modified gen p mean: 0.44975847005844116, gen p mean: -0.029186060652136803, mean p set: 0.45023879408836365
loss_pred:0.015443751588463783, decouple_loss:0.0036281654611229897
loss_pred:0.015460493974387646, decouple_loss:0.0037906719371676445
Iteration: 6, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474261701107025, gen p mean: -0.03440256044268608, mean p set: 0.4479064643383026
loss_pred:0.015034586191177368, decouple_loss:0.003692894708365202
The modified gen p mean: 0.44819745421409607, gen p mean: -0.035343579947948456, mean p set: 0.44867774844169617The modified gen p mean: 0.448076993227005, gen p mean: -0.029565611854195595, mean p set: 0.4485572874546051
loss_pred:0.015052339993417263, decouple_loss:0.003965405747294426
loss_pred:0.015324546955525875, decouple_loss:0.0038819704204797745
Iteration: 7, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466943144798279, gen p mean: -0.04976961389183998, mean p set: 0.447174608707428
loss_pred:0.015282467007637024, decouple_loss:0.0032623307779431343
The modified gen p mean: 0.44839343428611755, gen p mean: -0.04392874985933304, mean p set: 0.44887375831604004The modified gen p mean: 0.44836610555648804, gen p mean: -0.04568671062588692, mean p set: 0.44884639978408813
loss_pred:0.014691409654915333, decouple_loss:0.0035244275350123644
loss_pred:0.015615798532962799, decouple_loss:0.003208644688129425
Iteration: 8, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493548274040222, gen p mean: -0.0487792082130909, mean p set: 0.4498351216316223
loss_pred:0.014541231095790863, decouple_loss:0.00351776578463614
The modified gen p mean: 0.4491240084171295, gen p mean: -0.05437896400690079, mean p set: 0.4496042728424072The modified gen p mean: 0.4476631283760071, gen p mean: -0.044941890984773636, mean p set: 0.44814345240592957
loss_pred:0.013639803044497967, decouple_loss:0.003646941389888525
loss_pred:0.015243561938405037, decouple_loss:0.003323081647977233
Iteration: 9, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489038288593292, gen p mean: -0.044306084513664246, mean p set: 0.4493841528892517
loss_pred:0.014649891294538975, decouple_loss:0.002994556212797761
The modified gen p mean: 0.4490068554878235, gen p mean: -0.05202016606926918, mean p set: 0.4494871497154236The modified gen p mean: 0.44972044229507446, gen p mean: -0.05256761610507965, mean p set: 0.45020073652267456
loss_pred:0.013709877617657185, decouple_loss:0.002934451913461089
loss_pred:0.013287714682519436, decouple_loss:0.0029021673835814
Iteration: 10, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471129775047302, gen p mean: -0.05036194622516632, mean p set: 0.4475933015346527
loss_pred:0.014767360873520374, decouple_loss:0.003239754820242524
The modified gen p mean: 0.4481935501098633, gen p mean: -0.04822356626391411, mean p set: 0.44867387413978577
The modified gen p mean: 0.4486277103424072, gen p mean: -0.04598056897521019, mean p set: 0.44910797476768494
loss_pred:0.01379487756639719, decouple_loss:0.0030214765574783087
loss_pred:0.014310132712125778, decouple_loss:0.00319990748539567
2023-05-01 05:37:04 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.04645105078816414, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04305806756019592, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.04256899654865265, mean p set: 0.4500633478164673
loss_pred:0.019650328904390335, decouple_loss:0.0027797031216323376
loss_pred:0.01838901825249195, decouple_loss:0.0028197704814374447
loss_pred:0.01848665438592434, decouple_loss:0.002757516223937273
WV_0_PC_1_EH_0_PS_40, loss: 0.01898128353059292, avg_mse: 0.02722238376736641
current test mse: 0.027222
At step 10, Best test: 0.027222
save model to /work/09012/haoli1/ls6/ERA5_PredRNN/checkpoints/WV_0_PC_1_EH_0_PS_40/model_test_schedule_sampling_DynaMean.ckpt
Iteration: 11, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44840124249458313, gen p mean: -0.040741149336099625, mean p set: 0.4488815367221832
loss_pred:0.01518207136541605, decouple_loss:0.0029201945289969444
The modified gen p mean: 0.4479535222053528, gen p mean: -0.04293174669146538, mean p set: 0.44843384623527527The modified gen p mean: 0.4467901289463043, gen p mean: -0.044112008064985275, mean p set: 0.4472704529762268
loss_pred:0.014652128331363201, decouple_loss:0.0027820346876978874
loss_pred:0.014354825951159, decouple_loss:0.0028036555740982294
Iteration: 12, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489346146583557, gen p mean: -0.04487953707575798, mean p set: 0.4494149386882782
loss_pred:0.014172152616083622, decouple_loss:0.0027794023044407368
The modified gen p mean: 0.44875746965408325, gen p mean: -0.044268425554037094, mean p set: 0.44923779368400574
The modified gen p mean: 0.4473476707935333, gen p mean: -0.03926971182227135, mean p set: 0.44782793521881104
loss_pred:0.014618562534451485, decouple_loss:0.0028149669524282217
loss_pred:0.01449488289654255, decouple_loss:0.0027969335205852985
Iteration: 13, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448194295167923, gen p mean: -0.04260317236185074, mean p set: 0.44867458939552307
loss_pred:0.014537033624947071, decouple_loss:0.002180417999625206
The modified gen p mean: 0.4469146728515625, gen p mean: -0.041103098541498184, mean p set: 0.447394996881485
The modified gen p mean: 0.4490821361541748, gen p mean: -0.044064927846193314, mean p set: 0.4495624303817749
loss_pred:0.013651086948812008, decouple_loss:0.0022715928498655558
loss_pred:0.013859225437045097, decouple_loss:0.0023376629687845707
Iteration: 14, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474162757396698, gen p mean: -0.04471331834793091, mean p set: 0.4478965699672699
loss_pred:0.013969065621495247, decouple_loss:0.0024180433247238398
The modified gen p mean: 0.44798243045806885, gen p mean: -0.04447529464960098, mean p set: 0.44846272468566895The modified gen p mean: 0.4486274719238281, gen p mean: -0.04181579872965813, mean p set: 0.44910773634910583
loss_pred:0.013142005540430546, decouple_loss:0.002722080098465085
loss_pred:0.013451547361910343, decouple_loss:0.0025523146614432335
Iteration: 15, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44738543033599854, gen p mean: -0.040588464587926865, mean p set: 0.44786569476127625
loss_pred:0.013581004925072193, decouple_loss:0.002252073958516121
The modified gen p mean: 0.4474971890449524, gen p mean: -0.0423722043633461, mean p set: 0.4479774832725525The modified gen p mean: 0.447256863117218, gen p mean: -0.038847729563713074, mean p set: 0.4477371871471405
loss_pred:0.013679823838174343, decouple_loss:0.002408482600003481
loss_pred:0.014093294739723206, decouple_loss:0.002117282710969448
Iteration: 16, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501930773258209, gen p mean: -0.03458578512072563, mean p set: 0.45067334175109863
loss_pred:0.013704057782888412, decouple_loss:0.0022533321753144264
The modified gen p mean: 0.4490741789340973, gen p mean: -0.035471655428409576, mean p set: 0.449554443359375The modified gen p mean: 0.4476976692676544, gen p mean: -0.03840929642319679, mean p set: 0.4481779932975769
loss_pred:0.01439516432583332, decouple_loss:0.0020634280517697334
loss_pred:0.014032997190952301, decouple_loss:0.0022991851437836885
Iteration: 17, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44841739535331726, gen p mean: -0.040011562407016754, mean p set: 0.44889771938323975
loss_pred:0.014364304952323437, decouple_loss:0.0019800052978098392
The modified gen p mean: 0.44785282015800476, gen p mean: -0.03842315822839737, mean p set: 0.44833314418792725The modified gen p mean: 0.4488057494163513, gen p mean: -0.036703694611787796, mean p set: 0.4492860734462738
loss_pred:0.013869326561689377, decouple_loss:0.002074499148875475
loss_pred:0.014262733981013298, decouple_loss:0.00214408989995718
Iteration: 18, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500373899936676, gen p mean: -0.03452815115451813, mean p set: 0.4505176842212677
loss_pred:0.013365788385272026, decouple_loss:0.0021196440793573856
The modified gen p mean: 0.4487262964248657, gen p mean: -0.04288729652762413, mean p set: 0.44920656085014343The modified gen p mean: 0.45075008273124695, gen p mean: -0.03682674095034599, mean p set: 0.45123034715652466
loss_pred:0.013720223680138588, decouple_loss:0.0020905272103846073
loss_pred:0.013572745025157928, decouple_loss:0.0021030947100371122
Iteration: 19, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474325478076935, gen p mean: -0.03680415078997612, mean p set: 0.4479128420352936
loss_pred:0.01344436313956976, decouple_loss:0.0022970614954829216
The modified gen p mean: 0.44811615347862244, gen p mean: -0.04229427129030228, mean p set: 0.44859644770622253The modified gen p mean: 0.4476599097251892, gen p mean: -0.04084612429141998, mean p set: 0.4481402039527893
loss_pred:0.01342436671257019, decouple_loss:0.002005176618695259
loss_pred:0.013582229614257812, decouple_loss:0.0019594153854995966
Iteration: 20, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44915971159935, gen p mean: -0.045474130660295486, mean p set: 0.4496400058269501
loss_pred:0.013424282893538475, decouple_loss:0.0019266331801190972
The modified gen p mean: 0.4489430785179138, gen p mean: -0.04520994797348976, mean p set: 0.4494233727455139
The modified gen p mean: 0.447856068611145, gen p mean: -0.044264014810323715, mean p set: 0.4483363628387451
loss_pred:0.01379531528800726, decouple_loss:0.001860493328422308
loss_pred:0.013710643164813519, decouple_loss:0.0018756058998405933
2023-05-01 05:39:02 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.047251634299755096, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.044090643525123596, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.043520309031009674, mean p set: 0.4500633478164673
loss_pred:0.019444599747657776, decouple_loss:0.0018305841367691755
loss_pred:0.018289322033524513, decouple_loss:0.0017578696133568883
loss_pred:0.018340522423386574, decouple_loss:0.001795160467736423
WV_0_PC_1_EH_0_PS_40, loss: 0.018781207501888275, avg_mse: 0.027294587343931198
current test mse: 0.027295
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012007_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012007_3_24hr.npz
NaN value num: 0
Iteration: 21, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492669999599457, gen p mean: -0.04224513843655586, mean p set: 0.4497472941875458
loss_pred:0.01544601283967495, decouple_loss:0.001591785461641848
The modified gen p mean: 0.45045509934425354, gen p mean: -0.038568004965782166, mean p set: 0.45093539357185364The modified gen p mean: 0.4501005709171295, gen p mean: -0.036474648863077164, mean p set: 0.4505808651447296
loss_pred:0.016829850152134895, decouple_loss:0.0017581460997462273
loss_pred:0.01697789505124092, decouple_loss:0.0016897139139473438
Iteration: 22, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44951292872428894, gen p mean: -0.037715744227170944, mean p set: 0.44999319314956665
loss_pred:0.01616663858294487, decouple_loss:0.0018912020605057478
The modified gen p mean: 0.4497455358505249, gen p mean: -0.04146139696240425, mean p set: 0.450225830078125The modified gen p mean: 0.44813019037246704, gen p mean: -0.04224549978971481, mean p set: 0.44861045479774475
loss_pred:0.01706152968108654, decouple_loss:0.002026092493906617
loss_pred:0.01626996323466301, decouple_loss:0.002122635254636407
Iteration: 23, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45073339343070984, gen p mean: -0.038105558604002, mean p set: 0.45121368765830994
loss_pred:0.015212222933769226, decouple_loss:0.0015933983959257603
The modified gen p mean: 0.4493371844291687, gen p mean: -0.04280852526426315, mean p set: 0.4498175084590912The modified gen p mean: 0.45000436902046204, gen p mean: -0.04130144417285919, mean p set: 0.45048466324806213
loss_pred:0.01601969264447689, decouple_loss:0.0019324043532833457
loss_pred:0.01624246872961521, decouple_loss:0.0018539185402914882
Iteration: 24, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44907498359680176, gen p mean: -0.04015349969267845, mean p set: 0.44955530762672424
loss_pred:0.015370788052678108, decouple_loss:0.002027231501415372
The modified gen p mean: 0.4509582817554474, gen p mean: -0.041513558477163315, mean p set: 0.4514385461807251The modified gen p mean: 0.4498671889305115, gen p mean: -0.039003290235996246, mean p set: 0.45034751296043396
loss_pred:0.01671425625681877, decouple_loss:0.001876196009106934
loss_pred:0.017049318179488182, decouple_loss:0.0019308733753859997
Iteration: 25, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44936704635620117, gen p mean: -0.04795460402965546, mean p set: 0.44984734058380127
loss_pred:0.016355685889720917, decouple_loss:0.0018445119494572282
The modified gen p mean: 0.44779276847839355, gen p mean: -0.040567025542259216, mean p set: 0.44827306270599365The modified gen p mean: 0.44930654764175415, gen p mean: -0.046168066561222076, mean p set: 0.44978684186935425
loss_pred:0.015924962237477303, decouple_loss:0.0017081539845094085
loss_pred:0.015380371361970901, decouple_loss:0.0015478000277653337
Iteration: 26, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450021892786026, gen p mean: -0.041677284985780716, mean p set: 0.4505022168159485
loss_pred:0.016350295394659042, decouple_loss:0.0017491945764049888
The modified gen p mean: 0.449098140001297, gen p mean: -0.04643334075808525, mean p set: 0.4495784640312195The modified gen p mean: 0.44841963052749634, gen p mean: -0.04554010182619095, mean p set: 0.44889989495277405
loss_pred:0.01624179817736149, decouple_loss:0.001836366718634963
loss_pred:0.015956614166498184, decouple_loss:0.001798467361368239
Iteration: 27, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494897425174713, gen p mean: -0.04872822016477585, mean p set: 0.4499700367450714
loss_pred:0.01581944338977337, decouple_loss:0.0016101014334708452
The modified gen p mean: 0.449989914894104, gen p mean: -0.04610120877623558, mean p set: 0.4504702091217041The modified gen p mean: 0.4501960873603821, gen p mean: -0.04799583926796913, mean p set: 0.4506763517856598
loss_pred:0.015768183395266533, decouple_loss:0.001733150682412088
loss_pred:0.01624802127480507, decouple_loss:0.0016857513692229986
Iteration: 28, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502352178096771, gen p mean: -0.04414539039134979, mean p set: 0.4507155418395996
loss_pred:0.01506250910460949, decouple_loss:0.001577623188495636
The modified gen p mean: 0.44828465580940247, gen p mean: -0.04694372043013573, mean p set: 0.44876495003700256
The modified gen p mean: 0.4504678249359131, gen p mean: -0.04405832663178444, mean p set: 0.4509481191635132
loss_pred:0.015814170241355896, decouple_loss:0.001678349799476564
loss_pred:0.016376759856939316, decouple_loss:0.0016180597012862563
Iteration: 29, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44839420914649963, gen p mean: -0.045886069536209106, mean p set: 0.44887450337409973
loss_pred:0.015236952342092991, decouple_loss:0.0015656998148187995
The modified gen p mean: 0.45088982582092285, gen p mean: -0.044910382479429245, mean p set: 0.45137009024620056The modified gen p mean: 0.448742538690567, gen p mean: -0.04462830349802971, mean p set: 0.4492228329181671
loss_pred:0.014317515306174755, decouple_loss:0.0016188434092327952
loss_pred:0.015940804034471512, decouple_loss:0.0017420396907255054
Iteration: 30, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483919143676758, gen p mean: -0.04400673508644104, mean p set: 0.4488722085952759
loss_pred:0.015721404924988747, decouple_loss:0.0015439785784110427
The modified gen p mean: 0.4500592350959778, gen p mean: -0.048956599086523056, mean p set: 0.4505395293235779
The modified gen p mean: 0.4501855969429016, gen p mean: -0.04298768565058708, mean p set: 0.4506658911705017
loss_pred:0.015414981171488762, decouple_loss:0.0014287790982052684
loss_pred:0.016460975632071495, decouple_loss:0.0015068751526996493
2023-05-01 05:41:34 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.05291806161403656, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04878539592027664, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.048979274928569794, mean p set: 0.4500633478164673
loss_pred:0.018694180995225906, decouple_loss:0.001848513726145029
loss_pred:0.017559215426445007, decouple_loss:0.001685580937191844
loss_pred:0.017647759988904, decouple_loss:0.0016731686191633344
WV_0_PC_1_EH_0_PS_40, loss: 0.018053840845823288, avg_mse: 0.025940191000699997
current test mse: 0.02594
At step 30, Best test: 0.02594
save model to /work/09012/haoli1/ls6/ERA5_PredRNN/checkpoints/WV_0_PC_1_EH_0_PS_40/model_test_schedule_sampling_DynaMean.ckpt
Iteration: 31, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488302171230316, gen p mean: -0.04746222868561745, mean p set: 0.4493105113506317
loss_pred:0.01611587218940258, decouple_loss:0.0015444558812305331
The modified gen p mean: 0.44945529103279114, gen p mean: -0.04139799252152443, mean p set: 0.4499356150627136
The modified gen p mean: 0.4501650929450989, gen p mean: -0.04301033169031143, mean p set: 0.45064541697502136
loss_pred:0.015735426917672157, decouple_loss:0.0015292325988411903
loss_pred:0.015895526856184006, decouple_loss:0.0015468777855858207
Iteration: 32, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476589858531952, gen p mean: -0.04522722586989403, mean p set: 0.4481392800807953
loss_pred:0.015300936996936798, decouple_loss:0.001409037271514535
The modified gen p mean: 0.44946929812431335, gen p mean: -0.04199022799730301, mean p set: 0.44994959235191345The modified gen p mean: 0.44918200373649597, gen p mean: -0.04882937669754028, mean p set: 0.4496622681617737
loss_pred:0.015930619090795517, decouple_loss:0.0014079136308282614
loss_pred:0.01543324813246727, decouple_loss:0.0013428375823423266
Iteration: 33, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44878411293029785, gen p mean: -0.041977595537900925, mean p set: 0.4492644667625427
loss_pred:0.015472874976694584, decouple_loss:0.0015964256599545479
The modified gen p mean: 0.45038241147994995, gen p mean: -0.04390664026141167, mean p set: 0.45086273550987244The modified gen p mean: 0.4485502243041992, gen p mean: -0.047103554010391235, mean p set: 0.44903048872947693
loss_pred:0.016231106594204903, decouple_loss:0.0014168642228469253
loss_pred:0.01578533835709095, decouple_loss:0.0014515497023239732
Iteration: 34, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44856709241867065, gen p mean: -0.04011192545294762, mean p set: 0.44904738664627075
loss_pred:0.016186142340302467, decouple_loss:0.0016073962906375527
The modified gen p mean: 0.4486611485481262, gen p mean: -0.039605218917131424, mean p set: 0.4491414725780487The modified gen p mean: 0.4479636251926422, gen p mean: -0.04642805829644203, mean p set: 0.4484439492225647
loss_pred:0.01603899523615837, decouple_loss:0.0016556093469262123loss_pred:0.015322292223572731, decouple_loss:0.0018157745944336057
Iteration: 35, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44951069355010986, gen p mean: -0.04415683075785637, mean p set: 0.44999101758003235
loss_pred:0.015572217293083668, decouple_loss:0.00135585549287498
The modified gen p mean: 0.4486050605773926, gen p mean: -0.04498571902513504, mean p set: 0.4490853548049927The modified gen p mean: 0.44873544573783875, gen p mean: -0.04269665107131004, mean p set: 0.44921573996543884
loss_pred:0.015098761767148972, decouple_loss:0.0014432842144742608
loss_pred:0.015040419064462185, decouple_loss:0.001477607642300427
Iteration: 36, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44935426115989685, gen p mean: -0.03807180002331734, mean p set: 0.44983452558517456
loss_pred:0.015899406746029854, decouple_loss:0.001654409570619464
The modified gen p mean: 0.4492523670196533, gen p mean: -0.043540406972169876, mean p set: 0.4497326612472534The modified gen p mean: 0.4500578045845032, gen p mean: -0.037451934069395065, mean p set: 0.4505380690097809
loss_pred:0.015386663377285004, decouple_loss:0.001625158591195941
loss_pred:0.016404610127210617, decouple_loss:0.001680539222434163
Iteration: 37, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483434557914734, gen p mean: -0.037801362574100494, mean p set: 0.4488237500190735
loss_pred:0.015763286501169205, decouple_loss:0.0013720561983063817
The modified gen p mean: 0.45050185918807983, gen p mean: -0.034257110208272934, mean p set: 0.45098215341567993The modified gen p mean: 0.45119160413742065, gen p mean: -0.03666089475154877, mean p set: 0.45167189836502075
loss_pred:0.016403580084443092, decouple_loss:0.0013280826387926936
loss_pred:0.015004180371761322, decouple_loss:0.0013087369734421372
Iteration: 38, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45030298829078674, gen p mean: -0.038145165890455246, mean p set: 0.45078325271606445
loss_pred:0.015854310244321823, decouple_loss:0.0014043354894965887
The modified gen p mean: 0.44888585805892944, gen p mean: -0.04193580895662308, mean p set: 0.44936615228652954The modified gen p mean: 0.44732365012168884, gen p mean: -0.03359285369515419, mean p set: 0.44780394434928894
loss_pred:0.015293925069272518, decouple_loss:0.0014547058381140232
loss_pred:0.015401259064674377, decouple_loss:0.0015585446963086724
Iteration: 39, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489796757698059, gen p mean: -0.03642420098185539, mean p set: 0.4494599997997284
The modified gen p mean: 0.44851192831993103, gen p mean: -0.037738069891929626, mean p set: 0.44899222254753113loss_pred:0.015565703622996807, decouple_loss:0.0013353497488424182
The modified gen p mean: 0.44812920689582825, gen p mean: -0.036661069840192795, mean p set: 0.44860953092575073
loss_pred:0.014562176540493965, decouple_loss:0.0013595843920484185
loss_pred:0.01533644087612629, decouple_loss:0.001423346227966249
Iteration: 40, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487535357475281, gen p mean: -0.04586200788617134, mean p set: 0.4492338001728058
loss_pred:0.01525698322802782, decouple_loss:0.0014292252017185092
The modified gen p mean: 0.4504282474517822, gen p mean: -0.037636853754520416, mean p set: 0.4509085714817047The modified gen p mean: 0.448365181684494, gen p mean: -0.04158513993024826, mean p set: 0.4488454759120941
loss_pred:0.01566847786307335, decouple_loss:0.0014126513851806521
loss_pred:0.015689045190811157, decouple_loss:0.0013802434550598264
2023-05-01 05:43:32 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.0505690723657608, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.046815626323223114, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.04687310755252838, mean p set: 0.4500633478164673
loss_pred:0.01863551326096058, decouple_loss:0.001585276098921895
loss_pred:0.0175087358802557, decouple_loss:0.0014466684078797698
loss_pred:0.017589014023542404, decouple_loss:0.0014401553198695183
WV_0_PC_1_EH_0_PS_40, loss: 0.017985623329877853, avg_mse: 0.025884617120027542
current test mse: 0.025885
At step 40, Best test: 0.025885
save model to /work/09012/haoli1/ls6/ERA5_PredRNN/checkpoints/WV_0_PC_1_EH_0_PS_40/model_test_schedule_sampling_DynaMean.ckpt
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012002_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012002_3_24hr.npz
NaN value num: 0
Iteration: 41, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490946829319, gen p mean: -0.038239963352680206, mean p set: 0.44957494735717773
loss_pred:0.015762165188789368, decouple_loss:0.0014142944710329175
The modified gen p mean: 0.44978171586990356, gen p mean: -0.04490857943892479, mean p set: 0.4502619802951813The modified gen p mean: 0.4490774869918823, gen p mean: -0.0481882318854332, mean p set: 0.4495577812194824
loss_pred:0.017294136807322502, decouple_loss:0.0015546404756605625
loss_pred:0.017122313380241394, decouple_loss:0.0014185362961143255
Iteration: 42, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497600793838501, gen p mean: -0.04343818873167038, mean p set: 0.4502403438091278
The modified gen p mean: 0.4491126239299774, gen p mean: -0.03830869123339653, mean p set: 0.4495929181575775
loss_pred:0.01621333137154579, decouple_loss:0.0013116271002218127
loss_pred:0.01701429672539234, decouple_loss:0.0013416307047009468
The modified gen p mean: 0.44943127036094666, gen p mean: -0.04258301854133606, mean p set: 0.44991159439086914
loss_pred:0.016189003363251686, decouple_loss:0.0012338220840319991
Iteration: 43, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495282769203186, gen p mean: -0.042141471058130264, mean p set: 0.4500085711479187
loss_pred:0.017135152593255043, decouple_loss:0.0015430358471348882
The modified gen p mean: 0.4497954249382019, gen p mean: -0.04889610409736633, mean p set: 0.450275719165802The modified gen p mean: 0.4489581882953644, gen p mean: -0.04195546358823776, mean p set: 0.4494384825229645
loss_pred:0.015437204390764236, decouple_loss:0.0015892318915575743
loss_pred:0.016084080561995506, decouple_loss:0.0015465093310922384
Iteration: 44, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44964835047721863, gen p mean: -0.05150590464472771, mean p set: 0.4501286447048187
loss_pred:0.015741880983114243, decouple_loss:0.0012062964960932732
The modified gen p mean: 0.45019733905792236, gen p mean: -0.04653108865022659, mean p set: 0.45067763328552246The modified gen p mean: 0.44900307059288025, gen p mean: -0.04095987230539322, mean p set: 0.44948339462280273
loss_pred:0.01664143241941929, decouple_loss:0.0012381799751892686
loss_pred:0.017060482874512672, decouple_loss:0.0011292938143014908
Iteration: 45, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4518599212169647, gen p mean: -0.043644979596138, mean p set: 0.4523402154445648
loss_pred:0.0181047972291708, decouple_loss:0.0014473421033471823
The modified gen p mean: 0.4493807554244995, gen p mean: -0.05051860585808754, mean p set: 0.4498610198497772The modified gen p mean: 0.4498962461948395, gen p mean: -0.04768473282456398, mean p set: 0.4503765404224396
loss_pred:0.01735379919409752, decouple_loss:0.0014122641878202558
loss_pred:0.017266351729631424, decouple_loss:0.0014702118933200836
Iteration: 46, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45126524567604065, gen p mean: -0.052747759968042374, mean p set: 0.45174553990364075
loss_pred:0.01732393354177475, decouple_loss:0.0013209687313064933
The modified gen p mean: 0.45185157656669617, gen p mean: -0.05144812911748886, mean p set: 0.45233187079429626The modified gen p mean: 0.449188768863678, gen p mean: -0.05298253521323204, mean p set: 0.4496690630912781
loss_pred:0.0173085555434227, decouple_loss:0.001190611277706921
loss_pred:0.016283519566059113, decouple_loss:0.0012245866237208247
Iteration: 47, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493029713630676, gen p mean: -0.05239127203822136, mean p set: 0.4497832953929901
loss_pred:0.017194829881191254, decouple_loss:0.0013444675132632256
The modified gen p mean: 0.45139554142951965, gen p mean: -0.05384861305356026, mean p set: 0.45187583565711975The modified gen p mean: 0.4512721002101898, gen p mean: -0.0519278347492218, mean p set: 0.45175236463546753
loss_pred:0.017541952431201935, decouple_loss:0.0015004051383584738
loss_pred:0.017368225380778313, decouple_loss:0.0013914669398218393
Iteration: 48, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44930359721183777, gen p mean: -0.049268387258052826, mean p set: 0.44978389143943787
loss_pred:0.015899697318673134, decouple_loss:0.0012676971964538097
The modified gen p mean: 0.44913119077682495, gen p mean: -0.053095102310180664, mean p set: 0.44961148500442505The modified gen p mean: 0.44902917742729187, gen p mean: -0.04371663182973862, mean p set: 0.44950950145721436
loss_pred:0.016484396532177925, decouple_loss:0.001175470883026719
loss_pred:0.017207641154527664, decouple_loss:0.0012983729830011725
Iteration: 49, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511229395866394, gen p mean: -0.047502197325229645, mean p set: 0.4516032636165619
loss_pred:0.016476720571517944, decouple_loss:0.0014350388664752245
The modified gen p mean: 0.4499051570892334, gen p mean: -0.047279827296733856, mean p set: 0.4503854513168335The modified gen p mean: 0.45158398151397705, gen p mean: -0.0509987473487854, mean p set: 0.45206427574157715
loss_pred:0.015745015814900398, decouple_loss:0.0014041000977158546
loss_pred:0.01687704026699066, decouple_loss:0.001397575601004064
Iteration: 50, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502370357513428, gen p mean: -0.04944276809692383, mean p set: 0.45071735978126526
loss_pred:0.01591874472796917, decouple_loss:0.0011797526385635138
The modified gen p mean: 0.45217129588127136, gen p mean: -0.050651900470256805, mean p set: 0.45265159010887146The modified gen p mean: 0.44948163628578186, gen p mean: -0.04372033476829529, mean p set: 0.44996196031570435
loss_pred:0.01737251691520214, decouple_loss:0.0011731015983968973
loss_pred:0.016767267137765884, decouple_loss:0.0013292200164869428
2023-05-01 05:46:12 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.059930089861154556, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.05568841099739075, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.055934324860572815, mean p set: 0.4500633478164673
loss_pred:0.018451886251568794, decouple_loss:0.0011964915320277214
loss_pred:0.017281988635659218, decouple_loss:0.0011909583117812872
loss_pred:0.01744423434138298, decouple_loss:0.0011676194844767451
WV_0_PC_1_EH_0_PS_40, loss: 0.017785288393497467, avg_mse: 0.02549363113939762
current test mse: 0.025494
At step 50, Best test: 0.025494
save model to /work/09012/haoli1/ls6/ERA5_PredRNN/checkpoints/WV_0_PC_1_EH_0_PS_40/model_test_schedule_sampling_DynaMean.ckpt
Iteration: 51, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511968195438385, gen p mean: -0.05422194302082062, mean p set: 0.451677143573761
loss_pred:0.017015526071190834, decouple_loss:0.0010925524402409792
The modified gen p mean: 0.4504595994949341, gen p mean: -0.050535526126623154, mean p set: 0.45093992352485657The modified gen p mean: 0.4491424560546875, gen p mean: -0.054592765867710114, mean p set: 0.4496227502822876
loss_pred:0.01751686818897724, decouple_loss:0.001214603311382234
loss_pred:0.015846775844693184, decouple_loss:0.0011472500627860427
Iteration: 52, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44988110661506653, gen p mean: -0.0526638887822628, mean p set: 0.4503614008426666The modified gen p mean: 0.44946157932281494, gen p mean: -0.05638963356614113, mean p set: 0.44994187355041504
loss_pred:0.01693945936858654, decouple_loss:0.0013040321646258235
loss_pred:0.016415098682045937, decouple_loss:0.0012984322383999825
The modified gen p mean: 0.4496801793575287, gen p mean: -0.05940193310379982, mean p set: 0.4501604735851288
loss_pred:0.01581820473074913, decouple_loss:0.0013453756691887975
Iteration: 53, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44972312450408936, gen p mean: -0.05427287891507149, mean p set: 0.45020341873168945
loss_pred:0.017086690291762352, decouple_loss:0.0012534764828160405
The modified gen p mean: 0.4504971206188202, gen p mean: -0.04917503893375397, mean p set: 0.4509774148464203The modified gen p mean: 0.4500953257083893, gen p mean: -0.049749914556741714, mean p set: 0.4505756199359894
loss_pred:0.01725507713854313, decouple_loss:0.0011070482432842255
loss_pred:0.01755356974899769, decouple_loss:0.0012352275662124157
Iteration: 54, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45159289240837097, gen p mean: -0.045073721557855606, mean p set: 0.45207321643829346
loss_pred:0.01729365438222885, decouple_loss:0.0012168772518634796
The modified gen p mean: 0.45152056217193604, gen p mean: -0.05137142166495323, mean p set: 0.45200085639953613The modified gen p mean: 0.4525979459285736, gen p mean: -0.05496342107653618, mean p set: 0.4530782699584961
loss_pred:0.016658229753375053, decouple_loss:0.001211823313497007
loss_pred:0.01696166582405567, decouple_loss:0.0012775567593052983
Iteration: 55, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44909989833831787, gen p mean: -0.05496123805642128, mean p set: 0.44958019256591797
loss_pred:0.01586025208234787, decouple_loss:0.0010877830209210515
The modified gen p mean: 0.4498801827430725, gen p mean: -0.05729164183139801, mean p set: 0.4503604471683502The modified gen p mean: 0.4495278596878052, gen p mean: -0.0498293861746788, mean p set: 0.4500081539154053
loss_pred:0.015685131773352623, decouple_loss:0.0012190418783575296
loss_pred:0.01688661053776741, decouple_loss:0.0011024244595319033
Iteration: 56, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45017534494400024, gen p mean: -0.05423365533351898, mean p set: 0.45065566897392273
loss_pred:0.016536999493837357, decouple_loss:0.0011834172764793038
The modified gen p mean: 0.44990983605384827, gen p mean: -0.05107390880584717, mean p set: 0.45039013028144836The modified gen p mean: 0.4492533504962921, gen p mean: -0.04667753726243973, mean p set: 0.4497336745262146
loss_pred:0.016536859795451164, decouple_loss:0.001111435005441308
loss_pred:0.01688438653945923, decouple_loss:0.001107527525164187
Iteration: 57, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44934192299842834, gen p mean: -0.04584586247801781, mean p set: 0.44982221722602844
loss_pred:0.01699245348572731, decouple_loss:0.001089046592824161
The modified gen p mean: 0.44958746433258057, gen p mean: -0.04677223041653633, mean p set: 0.45006775856018066The modified gen p mean: 0.450796902179718, gen p mean: -0.052578091621398926, mean p set: 0.4512771964073181
loss_pred:0.016199227422475815, decouple_loss:0.0010915485909208655
loss_pred:0.01690187305212021, decouple_loss:0.0011431227903813124
Iteration: 58, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503209590911865, gen p mean: -0.050634343177080154, mean p set: 0.45080122351646423
loss_pred:0.01676282100379467, decouple_loss:0.0010908516123890877
The modified gen p mean: 0.4511414170265198, gen p mean: -0.04622196406126022, mean p set: 0.4516216814517975The modified gen p mean: 0.4514003098011017, gen p mean: -0.04424716532230377, mean p set: 0.4518806040287018
loss_pred:0.016780976206064224, decouple_loss:0.0011904784478247166
loss_pred:0.017294179648160934, decouple_loss:0.0012170493137091398
Iteration: 59, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44933202862739563, gen p mean: -0.05597442016005516, mean p set: 0.4498123526573181
loss_pred:0.016962725669145584, decouple_loss:0.0010635830694809556
The modified gen p mean: 0.44922783970832825, gen p mean: -0.050360653549432755, mean p set: 0.44970813393592834The modified gen p mean: 0.45003461837768555, gen p mean: -0.050173815339803696, mean p set: 0.45051491260528564
loss_pred:0.016533352434635162, decouple_loss:0.0010770097142085433
loss_pred:0.016057349741458893, decouple_loss:0.0009944116463884711
Iteration: 60, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4506269693374634, gen p mean: -0.048731133341789246, mean p set: 0.4511072635650635
loss_pred:0.017028089612722397, decouple_loss:0.0011012089671567082
The modified gen p mean: 0.45121848583221436, gen p mean: -0.04846823215484619, mean p set: 0.45169880986213684The modified gen p mean: 0.44972214102745056, gen p mean: -0.053825315088033676, mean p set: 0.45020246505737305
loss_pred:0.016787031665444374, decouple_loss:0.0011632345849648118
loss_pred:0.016713367775082588, decouple_loss:0.0011503213318064809
2023-05-01 05:48:11 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.05877325311303139, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.054380256682634354, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.054690927267074585, mean p set: 0.4500633478164673
loss_pred:0.018354039639234543, decouple_loss:0.001257349387742579
loss_pred:0.01723271980881691, decouple_loss:0.0012163181090727448
loss_pred:0.017374563962221146, decouple_loss:0.0012083081528544426
WV_0_PC_1_EH_0_PS_40, loss: 0.01771514117717743, avg_mse: 0.025393899530172348
current test mse: 0.025394
At step 60, Best test: 0.025394
save model to /work/09012/haoli1/ls6/ERA5_PredRNN/checkpoints/WV_0_PC_1_EH_0_PS_40/model_test_schedule_sampling_DynaMean.ckpt
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012020_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012020_3_24hr.npz
NaN value num: 0
Iteration: 61, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4521292448043823, gen p mean: -0.05150281637907028, mean p set: 0.45260950922966003
loss_pred:0.018226774409413338, decouple_loss:0.001180920284241438
The modified gen p mean: 0.4527318775653839, gen p mean: -0.050435684621334076, mean p set: 0.453212171792984The modified gen p mean: 0.45097616314888, gen p mean: -0.04797730967402458, mean p set: 0.4514564573764801
loss_pred:0.01776740886271, decouple_loss:0.0012372228084132075
loss_pred:0.017484040930867195, decouple_loss:0.0011996321845799685
Iteration: 62, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45018839836120605, gen p mean: -0.0508696474134922, mean p set: 0.45066869258880615
loss_pred:0.01819312758743763, decouple_loss:0.0012601702474057674
The modified gen p mean: 0.4520719647407532, gen p mean: -0.04338737949728966, mean p set: 0.45255225896835327The modified gen p mean: 0.45225995779037476, gen p mean: -0.05177205055952072, mean p set: 0.45274025201797485
loss_pred:0.0175306499004364, decouple_loss:0.0012055501574650407
loss_pred:0.01663137786090374, decouple_loss:0.001172439195215702
Iteration: 63, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4524232745170593, gen p mean: -0.04364496469497681, mean p set: 0.4529035687446594
loss_pred:0.017856575548648834, decouple_loss:0.0012871091021224856
The modified gen p mean: 0.44984734058380127, gen p mean: -0.04776407778263092, mean p set: 0.45032763481140137The modified gen p mean: 0.45281991362571716, gen p mean: -0.048998862504959106, mean p set: 0.4533001780509949
loss_pred:0.01765291392803192, decouple_loss:0.0012786693405359983
loss_pred:0.0175789762288332, decouple_loss:0.0013931709108874202
Iteration: 64, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45134252309799194, gen p mean: -0.043696388602256775, mean p set: 0.45182281732559204
loss_pred:0.01740364357829094, decouple_loss:0.001313970540650189
The modified gen p mean: 0.4503718912601471, gen p mean: -0.04760655388236046, mean p set: 0.4508522152900696The modified gen p mean: 0.4498312771320343, gen p mean: -0.05201156064867973, mean p set: 0.4503115713596344
loss_pred:0.01755703240633011, decouple_loss:0.0013811312383040786
loss_pred:0.017006542533636093, decouple_loss:0.0013001442421227694
Iteration: 65, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45236605405807495, gen p mean: -0.04083014279603958, mean p set: 0.45284631848335266
The modified gen p mean: 0.4491223990917206, gen p mean: -0.04151983931660652, mean p set: 0.4496026933193207
loss_pred:0.017058096826076508, decouple_loss:0.0014335602754727006
loss_pred:0.017893923446536064, decouple_loss:0.0015187958488240838
The modified gen p mean: 0.45138150453567505, gen p mean: -0.036689646542072296, mean p set: 0.4518618583679199
loss_pred:0.017220474779605865, decouple_loss:0.0015927194617688656
Iteration: 66, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45186764001846313, gen p mean: -0.042957425117492676, mean p set: 0.45234790444374084
loss_pred:0.01718635857105255, decouple_loss:0.0013233502395451069
The modified gen p mean: 0.4527330696582794, gen p mean: -0.044996753334999084, mean p set: 0.45321333408355713The modified gen p mean: 0.4522389769554138, gen p mean: -0.03966332972049713, mean p set: 0.45271924138069153
loss_pred:0.016944386065006256, decouple_loss:0.0013033325085416436
loss_pred:0.01685549132525921, decouple_loss:0.0014429654693230987
Iteration: 67, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4525221884250641, gen p mean: -0.03873250260949135, mean p set: 0.4530024528503418
loss_pred:0.01725155860185623, decouple_loss:0.0012293149484321475
The modified gen p mean: 0.4531138837337494, gen p mean: -0.03550998494029045, mean p set: 0.4535941779613495The modified gen p mean: 0.4519554674625397, gen p mean: -0.0385957807302475, mean p set: 0.45243576169013977
loss_pred:0.017523009330034256, decouple_loss:0.0012567853555083275
loss_pred:0.017457861453294754, decouple_loss:0.0013401140458881855
Iteration: 68, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45016443729400635, gen p mean: -0.0360763855278492, mean p set: 0.45064473152160645
The modified gen p mean: 0.45179077982902527, gen p mean: -0.03712691366672516, mean p set: 0.45227110385894775
loss_pred:0.017684901133179665, decouple_loss:0.001338667469099164
loss_pred:0.017110908403992653, decouple_loss:0.0012797124218195677
The modified gen p mean: 0.4516649544239044, gen p mean: -0.03358134627342224, mean p set: 0.4521452486515045
loss_pred:0.017048200592398643, decouple_loss:0.001248354441486299
Iteration: 69, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502890408039093, gen p mean: -0.0370858758687973, mean p set: 0.450769305229187
The modified gen p mean: 0.4518081247806549, gen p mean: -0.0376175120472908, mean p set: 0.4522883892059326
loss_pred:0.016736214980483055, decouple_loss:0.0013742012670263648
loss_pred:0.01670854538679123, decouple_loss:0.001296297530643642
The modified gen p mean: 0.45123717188835144, gen p mean: -0.03208164498209953, mean p set: 0.45171743631362915
loss_pred:0.017073119059205055, decouple_loss:0.0012748369481414557
Iteration: 70, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4515398144721985, gen p mean: -0.030377930030226707, mean p set: 0.4520201086997986
loss_pred:0.01661549136042595, decouple_loss:0.0011777787003666162
The modified gen p mean: 0.45259809494018555, gen p mean: -0.04103746637701988, mean p set: 0.45307838916778564The modified gen p mean: 0.45063936710357666, gen p mean: -0.03476954251527786, mean p set: 0.45111966133117676
loss_pred:0.016455436125397682, decouple_loss:0.0012196560855954885
loss_pred:0.017423832789063454, decouple_loss:0.0012417928082868457
2023-05-01 05:50:48 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.037866029888391495, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.03429437056183815, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.03419557958841324, mean p set: 0.4500633478164673
loss_pred:0.018558060750365257, decouple_loss:0.001377562410198152
loss_pred:0.01752045378088951, decouple_loss:0.0014460603706538677
loss_pred:0.01757250353693962, decouple_loss:0.0013612365582957864
WV_0_PC_1_EH_0_PS_40, loss: 0.0179534200578928, avg_mse: 0.025811634957790375
current test mse: 0.025812
Iteration: 71, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497220814228058, gen p mean: -0.03491418436169624, mean p set: 0.4502023756504059
The modified gen p mean: 0.4507010281085968, gen p mean: -0.03098084032535553, mean p set: 0.4511813521385193
The modified gen p mean: 0.4513130486011505, gen p mean: -0.03005751222372055, mean p set: 0.4517933130264282
loss_pred:0.016802676022052765, decouple_loss:0.0013361334567889571
loss_pred:0.016274355351924896, decouple_loss:0.0013713161461055279loss_pred:0.016910571604967117, decouple_loss:0.00121537025552243
Iteration: 72, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.451688677072525, gen p mean: -0.027015946805477142, mean p set: 0.4521689713001251
loss_pred:0.016979612410068512, decouple_loss:0.0014206675114110112
The modified gen p mean: 0.4530556797981262, gen p mean: -0.03158698230981827, mean p set: 0.4535359740257263The modified gen p mean: 0.4522134065628052, gen p mean: -0.02710639126598835, mean p set: 0.45269373059272766
loss_pred:0.017160722985863686, decouple_loss:0.0013147291028872132
loss_pred:0.01700979471206665, decouple_loss:0.001199396327137947
Iteration: 73, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4530668258666992, gen p mean: -0.037682317197322845, mean p set: 0.4535471498966217
loss_pred:0.01657850295305252, decouple_loss:0.001422343892045319
The modified gen p mean: 0.45236918330192566, gen p mean: -0.03713667392730713, mean p set: 0.45284944772720337The modified gen p mean: 0.45240479707717896, gen p mean: -0.02710827998816967, mean p set: 0.45288509130477905
loss_pred:0.016718298196792603, decouple_loss:0.0013881382765248418
loss_pred:0.016408395022153854, decouple_loss:0.001360495574772358
Iteration: 74, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45107221603393555, gen p mean: -0.04025813564658165, mean p set: 0.45155251026153564
loss_pred:0.017292169854044914, decouple_loss:0.0013312037335708737
The modified gen p mean: 0.44991931319236755, gen p mean: -0.03746919706463814, mean p set: 0.45039960741996765The modified gen p mean: 0.4498354196548462, gen p mean: -0.036527857184410095, mean p set: 0.4503157436847687
loss_pred:0.017477773129940033, decouple_loss:0.0013214524369686842
loss_pred:0.016791466623544693, decouple_loss:0.0013425390934571624
Iteration: 75, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511075019836426, gen p mean: -0.03958587720990181, mean p set: 0.45158782601356506
loss_pred:0.017201339825987816, decouple_loss:0.0011212944518774748
The modified gen p mean: 0.4525023102760315, gen p mean: -0.03635057806968689, mean p set: 0.4529826045036316The modified gen p mean: 0.4503428041934967, gen p mean: -0.038887396454811096, mean p set: 0.4508230984210968
loss_pred:0.016917651519179344, decouple_loss:0.0013036290183663368
loss_pred:0.017364315688610077, decouple_loss:0.0012904963223263621
Iteration: 76, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4533770680427551, gen p mean: -0.038802620023489, mean p set: 0.45385733246803284
loss_pred:0.017409231513738632, decouple_loss:0.0012770185712724924
The modified gen p mean: 0.4530324935913086, gen p mean: -0.03781235218048096, mean p set: 0.4535127878189087The modified gen p mean: 0.4506247639656067, gen p mean: -0.04263286665081978, mean p set: 0.4511050879955292
loss_pred:0.017640983685851097, decouple_loss:0.0013490580022335052
loss_pred:0.017329439520835876, decouple_loss:0.001191560411825776
Iteration: 77, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4526446461677551, gen p mean: -0.04177086800336838, mean p set: 0.4531249403953552
loss_pred:0.017075033858418465, decouple_loss:0.0013155301567167044
The modified gen p mean: 0.45230579376220703, gen p mean: -0.03693993762135506, mean p set: 0.45278608798980713The modified gen p mean: 0.45109429955482483, gen p mean: -0.043830301612615585, mean p set: 0.45157456398010254
loss_pred:0.01673007197678089, decouple_loss:0.0013025910593569279
loss_pred:0.01807410642504692, decouple_loss:0.0012556117726489902
Iteration: 78, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511301815509796, gen p mean: -0.04815210402011871, mean p set: 0.4516104459762573
loss_pred:0.017037946730852127, decouple_loss:0.0012082533212378621
The modified gen p mean: 0.4515971541404724, gen p mean: -0.045106060802936554, mean p set: 0.4520774781703949The modified gen p mean: 0.44985446333885193, gen p mean: -0.043884798884391785, mean p set: 0.450334757566452
loss_pred:0.016685811802744865, decouple_loss:0.0011635980335995555
loss_pred:0.017360087484121323, decouple_loss:0.0012530257226899266
Iteration: 79, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4516293406486511, gen p mean: -0.041690777987241745, mean p set: 0.45210960507392883
loss_pred:0.016339050605893135, decouple_loss:0.0013757444685325027
The modified gen p mean: 0.45213136076927185, gen p mean: -0.03985240310430527, mean p set: 0.45261165499687195The modified gen p mean: 0.4519454538822174, gen p mean: -0.03886047378182411, mean p set: 0.4524257183074951
loss_pred:0.016242370009422302, decouple_loss:0.0014166372129693627
loss_pred:0.017586953938007355, decouple_loss:0.0017220155568793416
Iteration: 80, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45154717564582825, gen p mean: -0.039423879235982895, mean p set: 0.45202744007110596
loss_pred:0.01685173623263836, decouple_loss:0.0013428538804873824
The modified gen p mean: 0.45204871892929077, gen p mean: -0.03970829397439957, mean p set: 0.4525289833545685The modified gen p mean: 0.4519249498844147, gen p mean: -0.04980709031224251, mean p set: 0.45240524411201477
loss_pred:0.016955990344285965, decouple_loss:0.0012656127801164985
loss_pred:0.01650618016719818, decouple_loss:0.0012078931322321296
2023-05-01 05:52:41 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.04719176143407822, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.043176934123039246, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.04293900728225708, mean p set: 0.4500633478164673
loss_pred:0.018693357706069946, decouple_loss:0.0015648776898160577
loss_pred:0.01751028187572956, decouple_loss:0.0015403933357447386
loss_pred:0.01768386736512184, decouple_loss:0.0016028006793931127
WV_0_PC_1_EH_0_PS_40, loss: 0.018040969967842102, avg_mse: 0.02600277215242386
current test mse: 0.026003
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012005_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012005_3_24hr.npz
NaN value num: 0
Iteration: 81, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44973474740982056, gen p mean: -0.046250104904174805, mean p set: 0.45021507143974304
loss_pred:0.01742764562368393, decouple_loss:0.0017292213160544634
The modified gen p mean: 0.4498697519302368, gen p mean: -0.041256073862314224, mean p set: 0.4503500759601593The modified gen p mean: 0.4476441442966461, gen p mean: -0.04292774200439453, mean p set: 0.44812440872192383
loss_pred:0.017048906534910202, decouple_loss:0.0016900553600862622
loss_pred:0.01686214841902256, decouple_loss:0.0015857737744227052
Iteration: 82, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474796950817108, gen p mean: -0.04459889605641365, mean p set: 0.4479599893093109
loss_pred:0.017482494935393333, decouple_loss:0.0013253033393993974
The modified gen p mean: 0.44869494438171387, gen p mean: -0.04610354080796242, mean p set: 0.44917523860931396The modified gen p mean: 0.4487479627132416, gen p mean: -0.042737651616334915, mean p set: 0.4492282271385193
loss_pred:0.017680367454886436, decouple_loss:0.001374153303913772
loss_pred:0.017699923366308212, decouple_loss:0.0013596643693745136
Iteration: 83, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447918564081192, gen p mean: -0.04068277031183243, mean p set: 0.4483988583087921
loss_pred:0.01681741327047348, decouple_loss:0.0013218600070104003
The modified gen p mean: 0.4483083486557007, gen p mean: -0.043346602469682693, mean p set: 0.4487886428833008The modified gen p mean: 0.4496042728424072, gen p mean: -0.04051651805639267, mean p set: 0.4500845670700073
loss_pred:0.017293835058808327, decouple_loss:0.001401164336130023
loss_pred:0.016802292317152023, decouple_loss:0.001378199434839189
Iteration: 84, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448386013507843, gen p mean: -0.04591413959860802, mean p set: 0.4488662779331207
loss_pred:0.017012011259794235, decouple_loss:0.0012515783309936523
The modified gen p mean: 0.44764530658721924, gen p mean: -0.04669967293739319, mean p set: 0.4481256306171417The modified gen p mean: 0.44945579767227173, gen p mean: -0.0466785803437233, mean p set: 0.44993606209754944
loss_pred:0.017109114676713943, decouple_loss:0.001370067591778934
loss_pred:0.01699342578649521, decouple_loss:0.00133029674179852
Iteration: 85, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45032787322998047, gen p mean: -0.05039587616920471, mean p set: 0.45080816745758057
loss_pred:0.01756192371249199, decouple_loss:0.0014518511015921831
The modified gen p mean: 0.4502216875553131, gen p mean: -0.04966436326503754, mean p set: 0.4507019817829132The modified gen p mean: 0.4489058256149292, gen p mean: -0.049481842666864395, mean p set: 0.4493860900402069
loss_pred:0.016823695972561836, decouple_loss:0.0013945418177172542
loss_pred:0.017170192673802376, decouple_loss:0.001576138543896377
Iteration: 86, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482744038105011, gen p mean: -0.051750555634498596, mean p set: 0.4487546980381012
loss_pred:0.016887180507183075, decouple_loss:0.0012656159233301878
The modified gen p mean: 0.44978076219558716, gen p mean: -0.056783802807331085, mean p set: 0.45026108622550964The modified gen p mean: 0.44749295711517334, gen p mean: -0.05695931240916252, mean p set: 0.44797325134277344
loss_pred:0.017393821850419044, decouple_loss:0.001354167819954455
loss_pred:0.01726057380437851, decouple_loss:0.0013983011012896895
Iteration: 87, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44969335198402405, gen p mean: -0.06077107414603233, mean p set: 0.45017367601394653
loss_pred:0.016764428466558456, decouple_loss:0.0013420216273516417
The modified gen p mean: 0.4493016302585602, gen p mean: -0.05716267228126526, mean p set: 0.4497818946838379The modified gen p mean: 0.4499596357345581, gen p mean: -0.058948814868927, mean p set: 0.4504399299621582
loss_pred:0.0176127590239048, decouple_loss:0.0013262664433568716
loss_pred:0.016509559005498886, decouple_loss:0.0012885952601209283
Iteration: 88, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44807255268096924, gen p mean: -0.06419326364994049, mean p set: 0.44855284690856934
loss_pred:0.016817398369312286, decouple_loss:0.0012908090138807893
The modified gen p mean: 0.4491669237613678, gen p mean: -0.0584055595099926, mean p set: 0.4496472179889679The modified gen p mean: 0.4494518041610718, gen p mean: -0.060163967311382294, mean p set: 0.4499320983886719
loss_pred:0.01723751612007618, decouple_loss:0.001300431089475751
loss_pred:0.01699027605354786, decouple_loss:0.0011441463138908148
Iteration: 89, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448699414730072, gen p mean: -0.06037026643753052, mean p set: 0.4491797089576721
loss_pred:0.017154013738036156, decouple_loss:0.0012695265468209982
The modified gen p mean: 0.44840115308761597, gen p mean: -0.058040354400873184, mean p set: 0.44888144731521606The modified gen p mean: 0.44886529445648193, gen p mean: -0.0579734742641449, mean p set: 0.44934555888175964
loss_pred:0.0165064949542284, decouple_loss:0.0012083874316886067
loss_pred:0.017249060794711113, decouple_loss:0.0012510042870417237
Iteration: 90, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497861862182617, gen p mean: -0.05218733847141266, mean p set: 0.45026645064353943
loss_pred:0.016532275825738907, decouple_loss:0.0011469671735540032
The modified gen p mean: 0.44820016622543335, gen p mean: -0.05612591281533241, mean p set: 0.44868043065071106The modified gen p mean: 0.4486227035522461, gen p mean: -0.05316397175192833, mean p set: 0.4491029977798462
loss_pred:0.017150873318314552, decouple_loss:0.0012484150938689709
loss_pred:0.017500529065728188, decouple_loss:0.0011561547871679068
2023-05-01 05:55:19 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.05471610277891159, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.05021759495139122, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.05055466294288635, mean p set: 0.4500633478164673
loss_pred:0.01843496412038803, decouple_loss:0.0013312646187841892
loss_pred:0.017311159521341324, decouple_loss:0.0012911047087982297
loss_pred:0.017487214878201485, decouple_loss:0.0012302319519221783
WV_0_PC_1_EH_0_PS_40, loss: 0.01780865713953972, avg_mse: 0.025555258616805077
current test mse: 0.025555
Iteration: 91, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496310353279114, gen p mean: -0.05221334099769592, mean p set: 0.4501113295555115
The modified gen p mean: 0.44845178723335266, gen p mean: -0.051459819078445435, mean p set: 0.44893211126327515
The modified gen p mean: 0.4492219388484955, gen p mean: -0.05286220461130142, mean p set: 0.4497022032737732
loss_pred:0.017669927328824997, decouple_loss:0.001149949966929853
loss_pred:0.01695393957197666, decouple_loss:0.0012366276932880282loss_pred:0.01684139296412468, decouple_loss:0.0011992757208645344
Iteration: 92, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489375054836273, gen p mean: -0.04800508916378021, mean p set: 0.4494177997112274
The modified gen p mean: 0.4487854838371277, gen p mean: -0.049678776413202286, mean p set: 0.4492657780647278
loss_pred:0.017210839316248894, decouple_loss:0.0012457126285880804
loss_pred:0.017022617161273956, decouple_loss:0.0011172747472301126
The modified gen p mean: 0.4500262141227722, gen p mean: -0.048730816692113876, mean p set: 0.4505065083503723
loss_pred:0.016664676368236542, decouple_loss:0.0011641231831163168
Iteration: 93, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44815149903297424, gen p mean: -0.04663941636681557, mean p set: 0.44863176345825195
loss_pred:0.017520274966955185, decouple_loss:0.0012258108472451568
The modified gen p mean: 0.4498195946216583, gen p mean: -0.044322412461042404, mean p set: 0.4502998888492584The modified gen p mean: 0.4487926661968231, gen p mean: -0.04573242738842964, mean p set: 0.44927293062210083
loss_pred:0.017292024567723274, decouple_loss:0.0011454172199591994
loss_pred:0.016419554129242897, decouple_loss:0.0011430337326601148
Iteration: 94, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44799548387527466, gen p mean: -0.043536216020584106, mean p set: 0.44847577810287476
loss_pred:0.01711626723408699, decouple_loss:0.001347651006653905
The modified gen p mean: 0.44858092069625854, gen p mean: -0.04617419093847275, mean p set: 0.44906121492385864The modified gen p mean: 0.4486202001571655, gen p mean: -0.04421849921345711, mean p set: 0.44910046458244324
loss_pred:0.017194898799061775, decouple_loss:0.0017015388002619147
loss_pred:0.016834091395139694, decouple_loss:0.001439889776520431
Iteration: 95, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44796493649482727, gen p mean: -0.04732620343565941, mean p set: 0.44844523072242737
loss_pred:0.016818610951304436, decouple_loss:0.0011800365755334496
The modified gen p mean: 0.44971132278442383, gen p mean: -0.0452096126973629, mean p set: 0.4501916468143463The modified gen p mean: 0.4480952024459839, gen p mean: -0.04588128626346588, mean p set: 0.448575496673584
loss_pred:0.017651017755270004, decouple_loss:0.0013147846329957247
loss_pred:0.017167314887046814, decouple_loss:0.0011903722770512104
Iteration: 96, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489072859287262, gen p mean: -0.05045062303543091, mean p set: 0.4493875503540039
loss_pred:0.01738317869603634, decouple_loss:0.0012015784159302711
The modified gen p mean: 0.4479368031024933, gen p mean: -0.05192343890666962, mean p set: 0.4484170973300934The modified gen p mean: 0.4498950242996216, gen p mean: -0.04898660629987717, mean p set: 0.4503753185272217
loss_pred:0.016416486352682114, decouple_loss:0.0013935600873082876
loss_pred:0.01708221063017845, decouple_loss:0.001242934726178646
Iteration: 97, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44896426796913147, gen p mean: -0.04811913147568703, mean p set: 0.44944456219673157
loss_pred:0.01721220277249813, decouple_loss:0.0010868225945159793
The modified gen p mean: 0.4486786127090454, gen p mean: -0.048436038196086884, mean p set: 0.4491589367389679The modified gen p mean: 0.4490582346916199, gen p mean: -0.050786565989255905, mean p set: 0.44953852891921997
loss_pred:0.017521623522043228, decouple_loss:0.0011049407767131925
loss_pred:0.016868703067302704, decouple_loss:0.001169200986623764
Iteration: 98, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473685026168823, gen p mean: -0.05105515941977501, mean p set: 0.4478487968444824
loss_pred:0.016852054744958878, decouple_loss:0.0015293029136955738
The modified gen p mean: 0.4502228796482086, gen p mean: -0.05220431834459305, mean p set: 0.4507031738758087The modified gen p mean: 0.4509904682636261, gen p mean: -0.05297992751002312, mean p set: 0.4514707326889038
loss_pred:0.017010236158967018, decouple_loss:0.0014245322672650218
loss_pred:0.016430368646979332, decouple_loss:0.0016258221585303545
Iteration: 99, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45035356283187866, gen p mean: -0.04711638391017914, mean p set: 0.45083382725715637
loss_pred:0.016443071886897087, decouple_loss:0.0010875239968299866
The modified gen p mean: 0.44958382844924927, gen p mean: -0.0463368259370327, mean p set: 0.450064092874527The modified gen p mean: 0.45030322670936584, gen p mean: -0.04956281930208206, mean p set: 0.45078352093696594
loss_pred:0.016976963728666306, decouple_loss:0.001023278571665287
loss_pred:0.016336113214492798, decouple_loss:0.001159534091129899
Iteration: 100, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45045018196105957, gen p mean: -0.049092911183834076, mean p set: 0.4509304463863373
loss_pred:0.016558771952986717, decouple_loss:0.0013047560350969434
The modified gen p mean: 0.4484393894672394, gen p mean: -0.0465443916618824, mean p set: 0.4489196836948395The modified gen p mean: 0.4484138786792755, gen p mean: -0.04455079883337021, mean p set: 0.4488941431045532
loss_pred:0.016178421676158905, decouple_loss:0.001411747420206666
loss_pred:0.016444239765405655, decouple_loss:0.001297871465794742
2023-05-01 05:57:13 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.050163738429546356, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04569343850016594, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.04611467570066452, mean p set: 0.4500633478164673
loss_pred:0.018353719264268875, decouple_loss:0.0010493816807866096
loss_pred:0.017260825261473656, decouple_loss:0.00119441794231534
loss_pred:0.01743929460644722, decouple_loss:0.0011031831381842494
WV_0_PC_1_EH_0_PS_40, loss: 0.017740396782755852, avg_mse: 0.025462474673986435
current test mse: 0.025462
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012012_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012012_3_24hr.npz
NaN value num: 0
Iteration: 101, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4519721269607544, gen p mean: -0.045230355113744736, mean p set: 0.4524524509906769
loss_pred:0.01597013883292675, decouple_loss:0.0012924817856401205
The modified gen p mean: 0.44950199127197266, gen p mean: -0.03818133473396301, mean p set: 0.44998228549957275The modified gen p mean: 0.4500272572040558, gen p mean: -0.046208705753088, mean p set: 0.4505075514316559
loss_pred:0.016517508774995804, decouple_loss:0.0011078526731580496
loss_pred:0.017008576542139053, decouple_loss:0.0012639902997761965
Iteration: 102, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45023173093795776, gen p mean: -0.04040272906422615, mean p set: 0.45071205496788025
loss_pred:0.016706358641386032, decouple_loss:0.0012596540618687868
The modified gen p mean: 0.44954437017440796, gen p mean: -0.03893167898058891, mean p set: 0.45002463459968567The modified gen p mean: 0.4496683180332184, gen p mean: -0.04016109183430672, mean p set: 0.4501486122608185
loss_pred:0.01580081507563591, decouple_loss:0.001314537483267486
loss_pred:0.016343791037797928, decouple_loss:0.0012196970637887716
Iteration: 103, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44941961765289307, gen p mean: -0.041049525141716, mean p set: 0.44989991188049316
loss_pred:0.01635594479739666, decouple_loss:0.001147526316344738
The modified gen p mean: 0.4488760232925415, gen p mean: -0.03922518715262413, mean p set: 0.4493563175201416The modified gen p mean: 0.45147770643234253, gen p mean: -0.04325142130255699, mean p set: 0.4519580006599426
loss_pred:0.01647307723760605, decouple_loss:0.0012302013346925378
loss_pred:0.016845624893903732, decouple_loss:0.0012075586710125208
Iteration: 104, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498305916786194, gen p mean: -0.03266046941280365, mean p set: 0.4503108859062195
The modified gen p mean: 0.4490959942340851, gen p mean: -0.03803946450352669, mean p set: 0.44957631826400757
loss_pred:0.016376933082938194, decouple_loss:0.0011628782376646996
loss_pred:0.01633177511394024, decouple_loss:0.00123648252338171
The modified gen p mean: 0.4503077566623688, gen p mean: -0.036035824567079544, mean p set: 0.45078805088996887
loss_pred:0.01634308695793152, decouple_loss:0.0014853827888146043
Iteration: 105, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45019587874412537, gen p mean: -0.03634818643331528, mean p set: 0.45067617297172546
loss_pred:0.015502750873565674, decouple_loss:0.0010909521952271461
The modified gen p mean: 0.45013538002967834, gen p mean: -0.03514951840043068, mean p set: 0.45061564445495605The modified gen p mean: 0.4522729516029358, gen p mean: -0.036189474165439606, mean p set: 0.4527532756328583
loss_pred:0.015728285536170006, decouple_loss:0.0010979028884321451
loss_pred:0.01637098379433155, decouple_loss:0.0011544282315298915
Iteration: 106, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45002520084381104, gen p mean: -0.03743227198719978, mean p set: 0.4505055248737335
loss_pred:0.01586776226758957, decouple_loss:0.0012213666923344135
The modified gen p mean: 0.45040807127952576, gen p mean: -0.040467504411935806, mean p set: 0.45088836550712585The modified gen p mean: 0.4495808780193329, gen p mean: -0.043864618986845016, mean p set: 0.450061172246933
loss_pred:0.01678636111319065, decouple_loss:0.0012878839625045657
loss_pred:0.01610475964844227, decouple_loss:0.001159174833446741
Iteration: 107, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494835436344147, gen p mean: -0.03656833991408348, mean p set: 0.44996383786201477
loss_pred:0.01674807257950306, decouple_loss:0.0011883305851370096
The modified gen p mean: 0.4514539837837219, gen p mean: -0.035723671317100525, mean p set: 0.45193424820899963The modified gen p mean: 0.45172998309135437, gen p mean: -0.04070178046822548, mean p set: 0.45221027731895447
loss_pred:0.016789812594652176, decouple_loss:0.0012172264978289604
loss_pred:0.016021838411688805, decouple_loss:0.0011283870553597808
Iteration: 108, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494783282279968, gen p mean: -0.04539702832698822, mean p set: 0.4499586224555969
loss_pred:0.015978077426552773, decouple_loss:0.0010751130757853389
The modified gen p mean: 0.4501749277114868, gen p mean: -0.04472002759575844, mean p set: 0.4506552517414093The modified gen p mean: 0.45020461082458496, gen p mean: -0.03927808627486229, mean p set: 0.45068490505218506
loss_pred:0.01660444401204586, decouple_loss:0.0012218438787385821
loss_pred:0.016325203701853752, decouple_loss:0.0011762372450903058
Iteration: 109, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4509672224521637, gen p mean: -0.03572364151477814, mean p set: 0.4514475464820862
loss_pred:0.016722477972507477, decouple_loss:0.0011297623859718442
The modified gen p mean: 0.4525343179702759, gen p mean: -0.03829262778162956, mean p set: 0.45301464200019836The modified gen p mean: 0.44931161403656006, gen p mean: -0.03903678432106972, mean p set: 0.44979190826416016
loss_pred:0.015607872046530247, decouple_loss:0.001127285067923367
loss_pred:0.016364844515919685, decouple_loss:0.0010672779753804207
Iteration: 110, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45121529698371887, gen p mean: -0.03860582411289215, mean p set: 0.45169559121131897
loss_pred:0.01678820326924324, decouple_loss:0.0011330804554745555
The modified gen p mean: 0.452571302652359, gen p mean: -0.03993625193834305, mean p set: 0.4530515968799591The modified gen p mean: 0.452502965927124, gen p mean: -0.04039052501320839, mean p set: 0.4529832601547241
loss_pred:0.015208662487566471, decouple_loss:0.0010696434183046222
loss_pred:0.01611020788550377, decouple_loss:0.0011625721817836165
2023-05-01 05:59:48 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.05020393058657646, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830833911896, gen p mean: -0.0464182086288929, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.046026188880205154, mean p set: 0.45035696029663086
loss_pred:0.018634973093867302, decouple_loss:0.0012763355625793338
loss_pred:0.01755734160542488, decouple_loss:0.0012594067957252264
loss_pred:0.017482316121459007, decouple_loss:0.0012583237839862704
WV_0_PC_1_EH_0_PS_40, loss: 0.01795477792620659, avg_mse: 0.02584644965827465
current test mse: 0.025846
Iteration: 111, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508987367153168, gen p mean: -0.037127673625946045, mean p set: 0.45137903094291687
The modified gen p mean: 0.4503837525844574, gen p mean: -0.03941376879811287, mean p set: 0.4508640468120575
The modified gen p mean: 0.4491751790046692, gen p mean: -0.04020216315984726, mean p set: 0.4496554732322693
loss_pred:0.016083458438515663, decouple_loss:0.001141807995736599
loss_pred:0.016959398984909058, decouple_loss:0.0011341453064233065
loss_pred:0.015876326709985733, decouple_loss:0.0011895940406247973
Iteration: 112, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4521687626838684, gen p mean: -0.039840079843997955, mean p set: 0.4526490569114685
loss_pred:0.015605606138706207, decouple_loss:0.0013707197504118085
The modified gen p mean: 0.4498424530029297, gen p mean: -0.04143716022372246, mean p set: 0.4503227472305298The modified gen p mean: 0.4490496814250946, gen p mean: -0.04376813396811485, mean p set: 0.4495299756526947
loss_pred:0.016582056879997253, decouple_loss:0.001309174345806241
loss_pred:0.016359588131308556, decouple_loss:0.001215182477608323
Iteration: 113, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486158788204193, gen p mean: -0.041053928434848785, mean p set: 0.4490962028503418
loss_pred:0.01616818830370903, decouple_loss:0.0010711206123232841
The modified gen p mean: 0.452386736869812, gen p mean: -0.04412132501602173, mean p set: 0.4528670310974121The modified gen p mean: 0.44974303245544434, gen p mean: -0.044446080923080444, mean p set: 0.4502233564853668
loss_pred:0.015633272007107735, decouple_loss:0.0011264696950092912
loss_pred:0.01573283039033413, decouple_loss:0.0010055701714009047
Iteration: 114, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45037809014320374, gen p mean: -0.042907945811748505, mean p set: 0.45085835456848145
The modified gen p mean: 0.45165199041366577, gen p mean: -0.04413610324263573, mean p set: 0.45213228464126587
loss_pred:0.015973705798387527, decouple_loss:0.001389400102198124
loss_pred:0.015456557273864746, decouple_loss:0.0013872092822566628
The modified gen p mean: 0.4508315324783325, gen p mean: -0.04774746671319008, mean p set: 0.4513118267059326
loss_pred:0.015608301386237144, decouple_loss:0.0012040795991197228
Iteration: 115, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493556320667267, gen p mean: -0.04396325349807739, mean p set: 0.4498359262943268
The modified gen p mean: 0.4533083140850067, gen p mean: -0.041940122842788696, mean p set: 0.4537885785102844
loss_pred:0.015930792316794395, decouple_loss:0.0011904077837243676
loss_pred:0.014982008375227451, decouple_loss:0.0011901289690285921
The modified gen p mean: 0.44853904843330383, gen p mean: -0.04555882140994072, mean p set: 0.4490193724632263
loss_pred:0.015368636697530746, decouple_loss:0.0012637017061933875
Iteration: 116, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481469392776489, gen p mean: -0.04503898322582245, mean p set: 0.4486272633075714
loss_pred:0.015953775495290756, decouple_loss:0.0011054078349843621
The modified gen p mean: 0.4499151110649109, gen p mean: -0.04610723629593849, mean p set: 0.450395405292511The modified gen p mean: 0.44869571924209595, gen p mean: -0.03909963369369507, mean p set: 0.44917601346969604
loss_pred:0.015465620905160904, decouple_loss:0.0011816459009423852
loss_pred:0.016004376113414764, decouple_loss:0.001131709199398756
Iteration: 117, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44978445768356323, gen p mean: -0.03777202218770981, mean p set: 0.4502647817134857
loss_pred:0.016194140538573265, decouple_loss:0.0012781269615516067
The modified gen p mean: 0.4498869776725769, gen p mean: -0.03783714026212692, mean p set: 0.4503673017024994The modified gen p mean: 0.44951504468917847, gen p mean: -0.0376574844121933, mean p set: 0.44999533891677856
loss_pred:0.016248079016804695, decouple_loss:0.0012964134803041816
loss_pred:0.01515726838260889, decouple_loss:0.001262704492546618
Iteration: 118, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493119418621063, gen p mean: -0.04371953383088112, mean p set: 0.4497922658920288
loss_pred:0.01625102013349533, decouple_loss:0.0011858335928991437
The modified gen p mean: 0.45056042075157166, gen p mean: -0.04161678999662399, mean p set: 0.45104068517684937
The modified gen p mean: 0.44925764203071594, gen p mean: -0.03787333145737648, mean p set: 0.44973790645599365
loss_pred:0.016278237104415894, decouple_loss:0.0012058897409588099
loss_pred:0.015816595405340195, decouple_loss:0.0010553576285019517
Iteration: 119, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502578377723694, gen p mean: -0.042647380381822586, mean p set: 0.4507381319999695
loss_pred:0.01575666293501854, decouple_loss:0.0012275705812498927
The modified gen p mean: 0.4502831995487213, gen p mean: -0.039904046803712845, mean p set: 0.4507634937763214The modified gen p mean: 0.4503800570964813, gen p mean: -0.04276537895202637, mean p set: 0.4508603513240814
loss_pred:0.016060590744018555, decouple_loss:0.0011891775066033006
loss_pred:0.016173839569091797, decouple_loss:0.0012054714607074857
Iteration: 120, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44999271631240845, gen p mean: -0.04397989809513092, mean p set: 0.45047301054000854
loss_pred:0.016669001430273056, decouple_loss:0.0011467736912891269
The modified gen p mean: 0.4500104784965515, gen p mean: -0.04620771110057831, mean p set: 0.4504907429218292The modified gen p mean: 0.44874173402786255, gen p mean: -0.043033938854932785, mean p set: 0.44922199845314026
loss_pred:0.01520464662462473, decouple_loss:0.0012125521898269653
loss_pred:0.016572076827287674, decouple_loss:0.0012362207053229213
2023-05-01 06:01:41 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.05017048120498657, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04577812924981117, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04601648822426796, mean p set: 0.4500633478164673
loss_pred:0.018690921366214752, decouple_loss:0.0013853658456355333
loss_pred:0.01751404069364071, decouple_loss:0.001254034461453557
loss_pred:0.017645997926592827, decouple_loss:0.0012801483971998096
WV_0_PC_1_EH_0_PS_40, loss: 0.018015645444393158, avg_mse: 0.025968825444579124
current test mse: 0.025969
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012017_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012017_3_24hr.npz
NaN value num: 0
Iteration: 121, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45156461000442505, gen p mean: -0.038114212453365326, mean p set: 0.45204487442970276
loss_pred:0.016255557537078857, decouple_loss:0.0011617012787610292
The modified gen p mean: 0.4494275152683258, gen p mean: -0.035314325243234634, mean p set: 0.4499078094959259The modified gen p mean: 0.4508665204048157, gen p mean: -0.043541319668293, mean p set: 0.45134681463241577
loss_pred:0.017345253378152847, decouple_loss:0.0011900151148438454
loss_pred:0.016614999622106552, decouple_loss:0.0011471353936940432
Iteration: 122, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513913691043854, gen p mean: -0.035071875900030136, mean p set: 0.4518716335296631
loss_pred:0.017087291926145554, decouple_loss:0.001091320300474763
The modified gen p mean: 0.45013341307640076, gen p mean: -0.0367010124027729, mean p set: 0.45061367750167847The modified gen p mean: 0.45196518301963806, gen p mean: -0.04564821720123291, mean p set: 0.45244550704956055
loss_pred:0.017234716564416885, decouple_loss:0.001186569221317768
loss_pred:0.01623564586043358, decouple_loss:0.0012100139865651727
Iteration: 123, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45136353373527527, gen p mean: -0.03748607635498047, mean p set: 0.45184382796287537
loss_pred:0.016459619626402855, decouple_loss:0.0012367538874968886
The modified gen p mean: 0.4523071050643921, gen p mean: -0.03518657013773918, mean p set: 0.4527874290943146
The modified gen p mean: 0.45160791277885437, gen p mean: -0.036653924733400345, mean p set: 0.45208823680877686
loss_pred:0.017423678189516068, decouple_loss:0.0012153213610872626
loss_pred:0.016534795984625816, decouple_loss:0.0010925858514383435
Iteration: 124, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.451847106218338, gen p mean: -0.037868302315473557, mean p set: 0.4523273706436157
loss_pred:0.016841499134898186, decouple_loss:0.001399268745444715
The modified gen p mean: 0.45116686820983887, gen p mean: -0.03598090261220932, mean p set: 0.45164716243743896
The modified gen p mean: 0.45214131474494934, gen p mean: -0.034749388694763184, mean p set: 0.4526216387748718
loss_pred:0.016870783641934395, decouple_loss:0.0014016954228281975
loss_pred:0.017175786197185516, decouple_loss:0.0014563541626557708
Iteration: 125, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44973111152648926, gen p mean: -0.03720482066273689, mean p set: 0.45021140575408936
loss_pred:0.017223065719008446, decouple_loss:0.001307121361605823
The modified gen p mean: 0.452606737613678, gen p mean: -0.03865823149681091, mean p set: 0.4530870020389557The modified gen p mean: 0.45163705945014954, gen p mean: -0.035823170095682144, mean p set: 0.45211732387542725
loss_pred:0.0170390997081995, decouple_loss:0.0013043192448094487
loss_pred:0.016860518604516983, decouple_loss:0.0012781384866684675
Iteration: 126, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45151078701019287, gen p mean: -0.04059435427188873, mean p set: 0.4519910514354706
loss_pred:0.016778748482465744, decouple_loss:0.0012757059885188937
The modified gen p mean: 0.45215368270874023, gen p mean: -0.03710196539759636, mean p set: 0.4526340067386627The modified gen p mean: 0.45000511407852173, gen p mean: -0.041085172444581985, mean p set: 0.4504854083061218
loss_pred:0.01762745901942253, decouple_loss:0.0013998068170621991
loss_pred:0.016724606975913048, decouple_loss:0.0013989846920594573
Iteration: 127, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45213308930397034, gen p mean: -0.03878580778837204, mean p set: 0.45261338353157043
loss_pred:0.01712101697921753, decouple_loss:0.0011676008580252528
The modified gen p mean: 0.4520478844642639, gen p mean: -0.04790937155485153, mean p set: 0.4525282084941864The modified gen p mean: 0.451567679643631, gen p mean: -0.03940264508128166, mean p set: 0.4520479440689087
loss_pred:0.01591196097433567, decouple_loss:0.0012984141940250993
loss_pred:0.01632542535662651, decouple_loss:0.0011908484157174826
Iteration: 128, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4512441158294678, gen p mean: -0.041372351348400116, mean p set: 0.45172441005706787
loss_pred:0.01817525550723076, decouple_loss:0.0011955932714045048
The modified gen p mean: 0.4515194892883301, gen p mean: -0.03788047656416893, mean p set: 0.45199981331825256The modified gen p mean: 0.4521905481815338, gen p mean: -0.04287346825003624, mean p set: 0.4526708424091339
loss_pred:0.01646934077143669, decouple_loss:0.001184031250886619
loss_pred:0.01681254431605339, decouple_loss:0.0012259468203410506
Iteration: 129, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505527913570404, gen p mean: -0.04226570203900337, mean p set: 0.4510330855846405
loss_pred:0.01703343540430069, decouple_loss:0.0012216743780300021
The modified gen p mean: 0.45171889662742615, gen p mean: -0.04494468495249748, mean p set: 0.45219916105270386The modified gen p mean: 0.4510944187641144, gen p mean: -0.041777197271585464, mean p set: 0.45157474279403687
loss_pred:0.017190968617796898, decouple_loss:0.001161362393759191
loss_pred:0.0166902095079422, decouple_loss:0.0011538694379851222
Iteration: 130, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496256113052368, gen p mean: -0.04413827136158943, mean p set: 0.4501059055328369
loss_pred:0.017075642943382263, decouple_loss:0.0012218088377267122
The modified gen p mean: 0.4522380828857422, gen p mean: -0.044766996055841446, mean p set: 0.4527184069156647The modified gen p mean: 0.45214730501174927, gen p mean: -0.03959367051720619, mean p set: 0.452627569437027
loss_pred:0.017008410766720772, decouple_loss:0.0011539458064362407
loss_pred:0.0172401312738657, decouple_loss:0.0012368232710286975
2023-05-01 06:04:13 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.0586661659181118, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.05482387915253639, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.054813534021377563, mean p set: 0.4500633478164673
loss_pred:0.018519042059779167, decouple_loss:0.0012592675630003214
loss_pred:0.017353544011712074, decouple_loss:0.001173002296127379
loss_pred:0.017521873116493225, decouple_loss:0.0011339426273480058
WV_0_PC_1_EH_0_PS_40, loss: 0.017857592552900314, avg_mse: 0.02565464936196804
current test mse: 0.025655
Iteration: 131, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.452006995677948, gen p mean: -0.04817572981119156, mean p set: 0.4524872899055481
The modified gen p mean: 0.4505493640899658, gen p mean: -0.048734039068222046, mean p set: 0.4510296881198883
The modified gen p mean: 0.4511058032512665, gen p mean: -0.049802206456661224, mean p set: 0.4515860676765442
loss_pred:0.016296450048685074, decouple_loss:0.0010724363382905722
loss_pred:0.016606926918029785, decouple_loss:0.0010972925228998065
loss_pred:0.017300555482506752, decouple_loss:0.00112399912904948
Iteration: 132, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45119529962539673, gen p mean: -0.048029959201812744, mean p set: 0.4516755938529968
loss_pred:0.016623718664050102, decouple_loss:0.0014621643349528313
The modified gen p mean: 0.4505445659160614, gen p mean: -0.047113873064517975, mean p set: 0.4510248601436615The modified gen p mean: 0.45157450437545776, gen p mean: -0.046201568096876144, mean p set: 0.45205479860305786
loss_pred:0.016205599531531334, decouple_loss:0.001269503147341311
loss_pred:0.016660325229167938, decouple_loss:0.0014040808891877532
Iteration: 133, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4512491226196289, gen p mean: -0.04749150946736336, mean p set: 0.451729416847229
loss_pred:0.017076049000024796, decouple_loss:0.0011824462562799454
The modified gen p mean: 0.4513651728630066, gen p mean: -0.049352437257766724, mean p set: 0.4518454968929291The modified gen p mean: 0.452507883310318, gen p mean: -0.0445239283144474, mean p set: 0.4529881477355957
loss_pred:0.017019478604197502, decouple_loss:0.0014535009395331144
loss_pred:0.016730451956391335, decouple_loss:0.0013175857020542026
Iteration: 134, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45201826095581055, gen p mean: -0.05048097297549248, mean p set: 0.45249855518341064
loss_pred:0.01704537309706211, decouple_loss:0.0016664237482473254
The modified gen p mean: 0.45138177275657654, gen p mean: -0.04967687278985977, mean p set: 0.45186206698417664The modified gen p mean: 0.4515424966812134, gen p mean: -0.05189096927642822, mean p set: 0.4520227611064911
loss_pred:0.01729021966457367, decouple_loss:0.0015660625649616122
loss_pred:0.016616567969322205, decouple_loss:0.001608966151252389
Iteration: 135, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4515809118747711, gen p mean: -0.04722607880830765, mean p set: 0.4520612061023712
loss_pred:0.016914600506424904, decouple_loss:0.0012435155222192407
The modified gen p mean: 0.45209887623786926, gen p mean: -0.04755508154630661, mean p set: 0.452579140663147The modified gen p mean: 0.4500552713871002, gen p mean: -0.0475865975022316, mean p set: 0.45053553581237793
loss_pred:0.017128583043813705, decouple_loss:0.0012744673294946551
loss_pred:0.017143813893198967, decouple_loss:0.001228625187650323
Iteration: 136, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4520340859889984, gen p mean: -0.044873110949993134, mean p set: 0.4525144100189209
loss_pred:0.016711536794900894, decouple_loss:0.00157009600661695
The modified gen p mean: 0.4518471956253052, gen p mean: -0.051546789705753326, mean p set: 0.4523274898529053The modified gen p mean: 0.4510997235774994, gen p mean: -0.04677377641201019, mean p set: 0.4515799880027771
loss_pred:0.016656503081321716, decouple_loss:0.0014250446110963821
loss_pred:0.017040137201547623, decouple_loss:0.0014508109306916595
Iteration: 137, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45151031017303467, gen p mean: -0.04340734705328941, mean p set: 0.4519905745983124
loss_pred:0.016602538526058197, decouple_loss:0.001239474513567984
The modified gen p mean: 0.45300525426864624, gen p mean: -0.04490852355957031, mean p set: 0.4534855782985687The modified gen p mean: 0.4519518315792084, gen p mean: -0.04354369267821312, mean p set: 0.45243212580680847
loss_pred:0.016902783885598183, decouple_loss:0.0012721364619210362
loss_pred:0.016408775001764297, decouple_loss:0.001258090022020042
Iteration: 138, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45167702436447144, gen p mean: -0.04505055770277977, mean p set: 0.4521573483943939
loss_pred:0.01700013503432274, decouple_loss:0.0014468334848061204
The modified gen p mean: 0.45214712619781494, gen p mean: -0.04683962091803551, mean p set: 0.45262742042541504The modified gen p mean: 0.4527052342891693, gen p mean: -0.04449113830924034, mean p set: 0.4531855285167694
loss_pred:0.01678582839667797, decouple_loss:0.0013521714136004448
loss_pred:0.01676798053085804, decouple_loss:0.001318443100899458
Iteration: 139, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4520275294780731, gen p mean: -0.046533431857824326, mean p set: 0.4525078237056732
loss_pred:0.016726486384868622, decouple_loss:0.0012000337010249496
The modified gen p mean: 0.45161575078964233, gen p mean: -0.04394160956144333, mean p set: 0.45209604501724243The modified gen p mean: 0.4513823688030243, gen p mean: -0.04298511892557144, mean p set: 0.4518626928329468
loss_pred:0.0167044997215271, decouple_loss:0.0014957133680582047
loss_pred:0.016676677390933037, decouple_loss:0.0012819234980270267
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012004_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012004_3_24hr.npz
NaN value num: 0
Iteration: 140, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482608139514923, gen p mean: -0.05526815354824066, mean p set: 0.4487411379814148
loss_pred:0.014168385416269302, decouple_loss:0.0012542655458673835
The modified gen p mean: 0.4481760263442993, gen p mean: -0.05636461079120636, mean p set: 0.4486563205718994The modified gen p mean: 0.447750449180603, gen p mean: -0.05239572376012802, mean p set: 0.4482307732105255
loss_pred:0.014543433673679829, decouple_loss:0.0012689451687037945
loss_pred:0.014283781871199608, decouple_loss:0.0013195539359003305
2023-05-01 06:06:50 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.05578184500336647, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.0512443445622921, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.05154917761683464, mean p set: 0.4500633478164673
loss_pred:0.018558138981461525, decouple_loss:0.0012911000521853566
loss_pred:0.017402593046426773, decouple_loss:0.0014386376133188605
loss_pred:0.017521174624562263, decouple_loss:0.0013759557623416185
WV_0_PC_1_EH_0_PS_40, loss: 0.017895732074975967, avg_mse: 0.02572462148964405
current test mse: 0.025725
Iteration: 141, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475911259651184, gen p mean: -0.05248216167092323, mean p set: 0.4480714499950409
The modified gen p mean: 0.4465106725692749, gen p mean: -0.05757119134068489, mean p set: 0.446990966796875
The modified gen p mean: 0.44756534695625305, gen p mean: -0.05495987832546234, mean p set: 0.44804564118385315
loss_pred:0.014451617375016212, decouple_loss:0.0012491779634729028
loss_pred:0.014016245491802692, decouple_loss:0.0012453621020540595
loss_pred:0.014679763466119766, decouple_loss:0.0012248080456629395
Iteration: 142, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44810235500335693, gen p mean: -0.04990343004465103, mean p set: 0.4485826790332794
The modified gen p mean: 0.45018261671066284, gen p mean: -0.05375732108950615, mean p set: 0.45066288113594055
loss_pred:0.014407993294298649, decouple_loss:0.0012901942245662212
loss_pred:0.014397023245692253, decouple_loss:0.0012729755835607648
The modified gen p mean: 0.44847527146339417, gen p mean: -0.05347542464733124, mean p set: 0.44895556569099426
loss_pred:0.014721197076141834, decouple_loss:0.001341952825896442
Iteration: 143, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467921853065491, gen p mean: -0.052268415689468384, mean p set: 0.4472724497318268
The modified gen p mean: 0.44727641344070435, gen p mean: -0.05483170971274376, mean p set: 0.44775673747062683
loss_pred:0.014337655156850815, decouple_loss:0.0015434229280799627
loss_pred:0.01393716037273407, decouple_loss:0.001523262937553227
The modified gen p mean: 0.4477931559085846, gen p mean: -0.053854864090681076, mean p set: 0.4482734203338623
loss_pred:0.013780424371361732, decouple_loss:0.0011944540310651064
Iteration: 144, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487585425376892, gen p mean: -0.04628603905439377, mean p set: 0.4492388665676117
loss_pred:0.014080824330449104, decouple_loss:0.001417766441591084
The modified gen p mean: 0.44923385977745056, gen p mean: -0.04954802244901657, mean p set: 0.44971415400505066The modified gen p mean: 0.44935527443885803, gen p mean: -0.04106336086988449, mean p set: 0.44983553886413574
loss_pred:0.014488277025520802, decouple_loss:0.001442104228772223
loss_pred:0.014435555785894394, decouple_loss:0.0014254972338676453
Iteration: 145, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44648703932762146, gen p mean: -0.04659527912735939, mean p set: 0.44696733355522156
loss_pred:0.01360420510172844, decouple_loss:0.001460071885958314
The modified gen p mean: 0.44962185621261597, gen p mean: -0.04773523285984993, mean p set: 0.4501021206378937
The modified gen p mean: 0.4508858025074005, gen p mean: -0.04352908208966255, mean p set: 0.4513660967350006
loss_pred:0.01376223936676979, decouple_loss:0.0015062856255099177
loss_pred:0.014187628403306007, decouple_loss:0.001429736614227295
Iteration: 146, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473828375339508, gen p mean: -0.046601831912994385, mean p set: 0.4478631317615509
loss_pred:0.013618044555187225, decouple_loss:0.00152596237603575
The modified gen p mean: 0.4488388001918793, gen p mean: -0.03937607258558273, mean p set: 0.449319064617157The modified gen p mean: 0.44796425104141235, gen p mean: -0.04541486129164696, mean p set: 0.44844454526901245
loss_pred:0.0136647317558527, decouple_loss:0.0013904161751270294
loss_pred:0.01438422966748476, decouple_loss:0.0013535335892811418
Iteration: 147, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487621486186981, gen p mean: -0.03768638148903847, mean p set: 0.4492424428462982
loss_pred:0.014151375740766525, decouple_loss:0.0013874811120331287
The modified gen p mean: 0.4478696584701538, gen p mean: -0.04755481705069542, mean p set: 0.4483499228954315The modified gen p mean: 0.4490843415260315, gen p mean: -0.049985121935606, mean p set: 0.4495646357536316
loss_pred:0.01374820712953806, decouple_loss:0.0014175331452861428
loss_pred:0.013816975057125092, decouple_loss:0.0014228374930098653
Iteration: 148, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494085907936096, gen p mean: -0.04239746555685997, mean p set: 0.44988885521888733
loss_pred:0.014198425225913525, decouple_loss:0.0014638109132647514
The modified gen p mean: 0.44835537672042847, gen p mean: -0.04204736649990082, mean p set: 0.44883567094802856The modified gen p mean: 0.448636531829834, gen p mean: -0.0472138486802578, mean p set: 0.4491168260574341
loss_pred:0.014518656767904758, decouple_loss:0.0014105027075856924
loss_pred:0.01441669650375843, decouple_loss:0.0014494453789666295
Iteration: 149, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44837528467178345, gen p mean: -0.04322734475135803, mean p set: 0.44885557889938354
loss_pred:0.013908341526985168, decouple_loss:0.0013866473454982042
The modified gen p mean: 0.4484059512615204, gen p mean: -0.04211873933672905, mean p set: 0.4488862454891205The modified gen p mean: 0.4463944733142853, gen p mean: -0.051227349787950516, mean p set: 0.4468747675418854
loss_pred:0.014226687140762806, decouple_loss:0.00144763698335737
loss_pred:0.01400380302220583, decouple_loss:0.0014919200912117958
Iteration: 150, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483340084552765, gen p mean: -0.041765592992305756, mean p set: 0.4488143026828766
loss_pred:0.013896189630031586, decouple_loss:0.0013315490214154124
The modified gen p mean: 0.44615504145622253, gen p mean: -0.04808913916349411, mean p set: 0.44663533568382263The modified gen p mean: 0.44761234521865845, gen p mean: -0.04500895366072655, mean p set: 0.44809263944625854
loss_pred:0.013614523224532604, decouple_loss:0.0013867303496226668
loss_pred:0.0136406933888793, decouple_loss:0.0013530401047319174
2023-05-01 06:08:44 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.0485856831073761, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.044139303267002106, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04447655379772186, mean p set: 0.4500633478164673
loss_pred:0.019350968301296234, decouple_loss:0.0016309047350659966
loss_pred:0.018238922581076622, decouple_loss:0.0016333075473085046
loss_pred:0.018271097913384438, decouple_loss:0.0015660622157156467
WV_0_PC_1_EH_0_PS_40, loss: 0.01870083436369896, avg_mse: 0.02721991203725338
current test mse: 0.02722
Iteration: 151, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479285478591919, gen p mean: -0.04691527783870697, mean p set: 0.448408842086792
The modified gen p mean: 0.447777658700943, gen p mean: -0.04531658813357353, mean p set: 0.4482579529285431
The modified gen p mean: 0.44872066378593445, gen p mean: -0.04044121503829956, mean p set: 0.44920095801353455
loss_pred:0.014006707817316055, decouple_loss:0.0014718128368258476
loss_pred:0.01387717854231596, decouple_loss:0.001423636102117598
loss_pred:0.014026276767253876, decouple_loss:0.0015155593864619732
Iteration: 152, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483461380004883, gen p mean: -0.04875751957297325, mean p set: 0.4488264322280884
The modified gen p mean: 0.4481866657733917, gen p mean: -0.043245378881692886, mean p set: 0.44866693019866943
loss_pred:0.013537580147385597, decouple_loss:0.001325041870586574
loss_pred:0.013763412833213806, decouple_loss:0.001294408692047
The modified gen p mean: 0.44748514890670776, gen p mean: -0.044835250824689865, mean p set: 0.44796544313430786
loss_pred:0.013613604940474033, decouple_loss:0.0013744306052103639
Iteration: 153, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481053054332733, gen p mean: -0.045088041573762894, mean p set: 0.4485855996608734
loss_pred:0.014039616100490093, decouple_loss:0.0012650411808863282
The modified gen p mean: 0.44865861535072327, gen p mean: -0.03410935401916504, mean p set: 0.44913890957832336
The modified gen p mean: 0.44828712940216064, gen p mean: -0.043459657579660416, mean p set: 0.44876742362976074
loss_pred:0.013719413429498672, decouple_loss:0.001336200744844973
loss_pred:0.013887429609894753, decouple_loss:0.0014311515260487795
Iteration: 154, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44806262850761414, gen p mean: -0.04163005203008652, mean p set: 0.44854292273521423
loss_pred:0.014213664457201958, decouple_loss:0.0013039447367191315
The modified gen p mean: 0.44782358407974243, gen p mean: -0.04484633728861809, mean p set: 0.44830387830734253The modified gen p mean: 0.44831424951553345, gen p mean: -0.045941200107336044, mean p set: 0.44879457354545593
loss_pred:0.015053778886795044, decouple_loss:0.0013353695394471288
loss_pred:0.014362795278429985, decouple_loss:0.001351290731690824
Iteration: 155, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476674795150757, gen p mean: -0.04947609081864357, mean p set: 0.4481477439403534
loss_pred:0.01469657476991415, decouple_loss:0.0014368959236890078
The modified gen p mean: 0.4487915635108948, gen p mean: -0.05305427685379982, mean p set: 0.4492718279361725The modified gen p mean: 0.4502047300338745, gen p mean: -0.049571726471185684, mean p set: 0.450685054063797
loss_pred:0.014844268560409546, decouple_loss:0.001385395647957921
loss_pred:0.014983497560024261, decouple_loss:0.0014700175961479545
Iteration: 156, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44850486516952515, gen p mean: -0.0381624661386013, mean p set: 0.44898515939712524
loss_pred:0.014206184074282646, decouple_loss:0.0014840861549600959
The modified gen p mean: 0.44732072949409485, gen p mean: -0.04296258091926575, mean p set: 0.44780102372169495The modified gen p mean: 0.44707104563713074, gen p mean: -0.04932599142193794, mean p set: 0.44755133986473083
loss_pred:0.014483669772744179, decouple_loss:0.0016290446510538459
loss_pred:0.013606933876872063, decouple_loss:0.001487741363234818
Iteration: 157, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482540488243103, gen p mean: -0.044458817690610886, mean p set: 0.4487343728542328
loss_pred:0.014675249345600605, decouple_loss:0.001757777645252645
The modified gen p mean: 0.4487181603908539, gen p mean: -0.03437935933470726, mean p set: 0.44919851422309875The modified gen p mean: 0.4480462074279785, gen p mean: -0.04136298596858978, mean p set: 0.4485265016555786
loss_pred:0.014471663162112236, decouple_loss:0.0015351204201579094
loss_pred:0.01381058432161808, decouple_loss:0.001585727441124618
Iteration: 158, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44656041264533997, gen p mean: -0.038214683532714844, mean p set: 0.44704070687294006
loss_pred:0.01367100328207016, decouple_loss:0.001768793910741806
The modified gen p mean: 0.4482864737510681, gen p mean: -0.04194033890962601, mean p set: 0.4487667679786682The modified gen p mean: 0.44788697361946106, gen p mean: -0.04117555543780327, mean p set: 0.44836726784706116
loss_pred:0.013692214153707027, decouple_loss:0.0016022815834730864
loss_pred:0.01415096502751112, decouple_loss:0.0014959461987018585
Iteration: 159, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486162066459656, gen p mean: -0.042543910443782806, mean p set: 0.4490965008735657
loss_pred:0.01431321818381548, decouple_loss:0.001665303367190063
The modified gen p mean: 0.4487471878528595, gen p mean: -0.03697982057929039, mean p set: 0.4492274820804596The modified gen p mean: 0.4475422203540802, gen p mean: -0.03844805434346199, mean p set: 0.4480225145816803
loss_pred:0.013993578962981701, decouple_loss:0.0016852709231898189
loss_pred:0.014290581457316875, decouple_loss:0.001713539008051157
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012015_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012015_3_24hr.npz
NaN value num: 0
Iteration: 160, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497908651828766, gen p mean: -0.0349104106426239, mean p set: 0.4502711296081543
loss_pred:0.017743395641446114, decouple_loss:0.0017090279143303633
The modified gen p mean: 0.4506491422653198, gen p mean: -0.034520767629146576, mean p set: 0.4511294364929199The modified gen p mean: 0.44932082295417786, gen p mean: -0.031712137162685394, mean p set: 0.44980117678642273
loss_pred:0.018632080405950546, decouple_loss:0.0017169552156701684
loss_pred:0.018565185368061066, decouple_loss:0.0017283856868743896
2023-05-01 06:11:28 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.047260817140340805, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04302559420466423, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.043522316962480545, mean p set: 0.4500633478164673
loss_pred:0.019497891888022423, decouple_loss:0.0018546783830970526
loss_pred:0.018314678221940994, decouple_loss:0.0017551631899550557
loss_pred:0.018497126176953316, decouple_loss:0.0017668316140770912
WV_0_PC_1_EH_0_PS_40, loss: 0.018859511241316795, avg_mse: 0.027170633897185326
current test mse: 0.027171
Iteration: 161, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4509621262550354, gen p mean: -0.04058597609400749, mean p set: 0.4514424204826355
The modified gen p mean: 0.4493100941181183, gen p mean: -0.03633872792124748, mean p set: 0.4497903883457184
The modified gen p mean: 0.4508325159549713, gen p mean: -0.040387336164712906, mean p set: 0.4513128101825714
loss_pred:0.018453944474458694, decouple_loss:0.001906010671518743
loss_pred:0.01749199442565441, decouple_loss:0.0018580168252810836loss_pred:0.019079433754086494, decouple_loss:0.0017852765740826726
Iteration: 162, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508225619792938, gen p mean: -0.04820543900132179, mean p set: 0.4513028562068939
loss_pred:0.018037479370832443, decouple_loss:0.0017656629206612706
The modified gen p mean: 0.4490688443183899, gen p mean: -0.045467328280210495, mean p set: 0.4495491087436676
The modified gen p mean: 0.4507622718811035, gen p mean: -0.050452470779418945, mean p set: 0.4512425363063812
loss_pred:0.01818077638745308, decouple_loss:0.0017592584481462836
loss_pred:0.017412802204489708, decouple_loss:0.0018446457106620073
Iteration: 163, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45182010531425476, gen p mean: -0.04903256148099899, mean p set: 0.45230039954185486
loss_pred:0.018634606152772903, decouple_loss:0.0017783504445105791
The modified gen p mean: 0.45054006576538086, gen p mean: -0.054945092648267746, mean p set: 0.45102033019065857The modified gen p mean: 0.45042797923088074, gen p mean: -0.05017268657684326, mean p set: 0.45090827345848083
loss_pred:0.01803470216691494, decouple_loss:0.0018653301522135735
loss_pred:0.018446248024702072, decouple_loss:0.0018095108680427074
Iteration: 164, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502016603946686, gen p mean: -0.06348899006843567, mean p set: 0.4506819546222687
loss_pred:0.01724528893828392, decouple_loss:0.0018725154222920537
The modified gen p mean: 0.45051419734954834, gen p mean: -0.06182632967829704, mean p set: 0.4509945213794708
The modified gen p mean: 0.4498096704483032, gen p mean: -0.06030603125691414, mean p set: 0.45028993487358093
loss_pred:0.01753821410238743, decouple_loss:0.0018741328967735171
loss_pred:0.018114428967237473, decouple_loss:0.0019424991915002465
Iteration: 165, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508623778820038, gen p mean: -0.06157887727022171, mean p set: 0.4513426423072815
The modified gen p mean: 0.45088908076286316, gen p mean: -0.06868176907300949, mean p set: 0.45136934518814087
loss_pred:0.019243543967604637, decouple_loss:0.001693821744993329
loss_pred:0.01875646971166134, decouple_loss:0.0017461988609284163
The modified gen p mean: 0.44957202672958374, gen p mean: -0.06690110266208649, mean p set: 0.45005232095718384
loss_pred:0.019072068855166435, decouple_loss:0.0018085000338032842
Iteration: 166, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45079562067985535, gen p mean: -0.04584132879972458, mean p set: 0.45127591490745544
loss_pred:0.020245179533958435, decouple_loss:0.0021025973837822676
The modified gen p mean: 0.4507042169570923, gen p mean: -0.050115715712308884, mean p set: 0.4511845111846924The modified gen p mean: 0.4491346776485443, gen p mean: -0.04395138844847679, mean p set: 0.4496149718761444
loss_pred:0.018454965204000473, decouple_loss:0.0021874026861041784
loss_pred:0.0194410290569067, decouple_loss:0.0020423135720193386
Iteration: 167, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505538046360016, gen p mean: -0.03828508406877518, mean p set: 0.4510340988636017
loss_pred:0.018377181142568588, decouple_loss:0.0020209006033837795
The modified gen p mean: 0.44989699125289917, gen p mean: -0.03604511171579361, mean p set: 0.45037728548049927The modified gen p mean: 0.45065775513648987, gen p mean: -0.0407637357711792, mean p set: 0.45113804936408997
loss_pred:0.018216367810964584, decouple_loss:0.00201261043548584
loss_pred:0.01890685223042965, decouple_loss:0.0017953072674572468
Iteration: 168, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45032623410224915, gen p mean: -0.03781718388199806, mean p set: 0.45080649852752686
loss_pred:0.01823713630437851, decouple_loss:0.00232916628010571
The modified gen p mean: 0.4500710070133209, gen p mean: -0.03941316157579422, mean p set: 0.4505513310432434The modified gen p mean: 0.44991546869277954, gen p mean: -0.035297900438308716, mean p set: 0.450395792722702
loss_pred:0.01753450371325016, decouple_loss:0.0023347120732069016
loss_pred:0.01909118890762329, decouple_loss:0.0022458327002823353
Iteration: 169, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503765404224396, gen p mean: -0.04634911194443703, mean p set: 0.4508568048477173
loss_pred:0.01818040758371353, decouple_loss:0.0020936077926307917
The modified gen p mean: 0.450418084859848, gen p mean: -0.04585320129990578, mean p set: 0.4508983790874481The modified gen p mean: 0.45001962780952454, gen p mean: -0.048041343688964844, mean p set: 0.45049992203712463
loss_pred:0.01817096583545208, decouple_loss:0.0020830612629652023
loss_pred:0.018121415749192238, decouple_loss:0.0020356480963528156
Iteration: 170, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45033180713653564, gen p mean: -0.05720723420381546, mean p set: 0.45081210136413574
loss_pred:0.017664743587374687, decouple_loss:0.0018546656938269734
The modified gen p mean: 0.45081645250320435, gen p mean: -0.059526149183511734, mean p set: 0.45129671692848206The modified gen p mean: 0.44938963651657104, gen p mean: -0.05758459493517876, mean p set: 0.44986993074417114
loss_pred:0.01870797947049141, decouple_loss:0.0019074154552072287
loss_pred:0.017871767282485962, decouple_loss:0.0018669560085982084
2023-05-01 06:13:22 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.07589665055274963, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.07001905888319016, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.07152807712554932, mean p set: 0.4500633478164673
loss_pred:0.019401617348194122, decouple_loss:0.0020397650077939034
loss_pred:0.018236864358186722, decouple_loss:0.0020222789607942104
loss_pred:0.01834312081336975, decouple_loss:0.0020310734398663044
WV_0_PC_1_EH_0_PS_40, loss: 0.01876208744943142, avg_mse: 0.026753569021821022
current test mse: 0.026754
Iteration: 171, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498668313026428, gen p mean: -0.06299997121095657, mean p set: 0.45034709572792053
The modified gen p mean: 0.4498754143714905, gen p mean: -0.06619523465633392, mean p set: 0.4503557085990906
The modified gen p mean: 0.4488142728805542, gen p mean: -0.06372775137424469, mean p set: 0.4492945969104767
loss_pred:0.018244370818138123, decouple_loss:0.0020030788145959377
loss_pred:0.018851978704333305, decouple_loss:0.0021710796281695366
loss_pred:0.017688533291220665, decouple_loss:0.0021513577084988356
Iteration: 172, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497341513633728, gen p mean: -0.06570915132761002, mean p set: 0.4502144455909729
loss_pred:0.018129505217075348, decouple_loss:0.0018484516767784953
The modified gen p mean: 0.44982007145881653, gen p mean: -0.06811352074146271, mean p set: 0.4503003656864166The modified gen p mean: 0.45097872614860535, gen p mean: -0.06721576303243637, mean p set: 0.45145899057388306
loss_pred:0.018434565514326096, decouple_loss:0.0018970809178426862
loss_pred:0.018879206851124763, decouple_loss:0.0019543722737580538
Iteration: 173, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498710632324219, gen p mean: -0.06545930355787277, mean p set: 0.450351357460022
loss_pred:0.01787063479423523, decouple_loss:0.0017975543159991503
The modified gen p mean: 0.4500060975551605, gen p mean: -0.07113347947597504, mean p set: 0.4504863917827606The modified gen p mean: 0.4490700662136078, gen p mean: -0.06792944669723511, mean p set: 0.4495503306388855
loss_pred:0.018313271924853325, decouple_loss:0.0019543892703950405
loss_pred:0.01754530519247055, decouple_loss:0.0018189366674050689
Iteration: 174, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45042118430137634, gen p mean: -0.06479023396968842, mean p set: 0.45090147852897644
loss_pred:0.018303247168660164, decouple_loss:0.0018605338409543037
The modified gen p mean: 0.44912439584732056, gen p mean: -0.06712450087070465, mean p set: 0.44960469007492065The modified gen p mean: 0.4506174921989441, gen p mean: -0.0723932683467865, mean p set: 0.4510977864265442
loss_pred:0.018001077696681023, decouple_loss:0.0017619928112253547
loss_pred:0.017363203689455986, decouple_loss:0.0017857233760878444
Iteration: 175, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488238990306854, gen p mean: -0.06536082923412323, mean p set: 0.44930416345596313
loss_pred:0.017684275284409523, decouple_loss:0.0017836247570812702
The modified gen p mean: 0.4512409567832947, gen p mean: -0.07006426155567169, mean p set: 0.4517212510108948The modified gen p mean: 0.4500775933265686, gen p mean: -0.0687873512506485, mean p set: 0.4505578577518463
loss_pred:0.017479851841926575, decouple_loss:0.0019027309026569128
loss_pred:0.017615776509046555, decouple_loss:0.0018306398997083306
Iteration: 176, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45072463154792786, gen p mean: -0.060130827128887177, mean p set: 0.45120492577552795
loss_pred:0.018432030454277992, decouple_loss:0.0016039599431678653
The modified gen p mean: 0.4505615532398224, gen p mean: -0.06375806033611298, mean p set: 0.4510418474674225The modified gen p mean: 0.44994717836380005, gen p mean: -0.06489697843790054, mean p set: 0.45042750239372253
loss_pred:0.01770617999136448, decouple_loss:0.0016939640045166016
loss_pred:0.01782369241118431, decouple_loss:0.0016143100801855326
Iteration: 177, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45013561844825745, gen p mean: -0.060202740132808685, mean p set: 0.45061591267585754
loss_pred:0.017467040568590164, decouple_loss:0.0016985638067126274
The modified gen p mean: 0.4491664469242096, gen p mean: -0.06130606308579445, mean p set: 0.4496467411518097The modified gen p mean: 0.4482330083847046, gen p mean: -0.05855977535247803, mean p set: 0.4487132728099823
loss_pred:0.01849600113928318, decouple_loss:0.0017444066470488906
loss_pred:0.017921127378940582, decouple_loss:0.001794898067601025
Iteration: 178, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507591128349304, gen p mean: -0.056451089680194855, mean p set: 0.4512394070625305
loss_pred:0.018497386947274208, decouple_loss:0.00169186235871166
The modified gen p mean: 0.4493275582790375, gen p mean: -0.05219683423638344, mean p set: 0.44980788230895996The modified gen p mean: 0.4497521221637726, gen p mean: -0.05621577054262161, mean p set: 0.4502323865890503
loss_pred:0.01789076067507267, decouple_loss:0.0017103191930800676
loss_pred:0.017733916640281677, decouple_loss:0.0018199302721768618
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012013_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012013_3_24hr.npz
NaN value num: 0
Iteration: 179, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44839754700660706, gen p mean: -0.053821414709091187, mean p set: 0.44887787103652954
loss_pred:0.01761411316692829, decouple_loss:0.0016875530127435923
The modified gen p mean: 0.4477876126766205, gen p mean: -0.056405775249004364, mean p set: 0.4482679069042206The modified gen p mean: 0.44818419218063354, gen p mean: -0.0558164119720459, mean p set: 0.44866451621055603
loss_pred:0.017036832869052887, decouple_loss:0.0016805253690108657
loss_pred:0.016505612060427666, decouple_loss:0.0016726983012631536
Iteration: 180, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44985494017601013, gen p mean: -0.04532080888748169, mean p set: 0.45033523440361023
loss_pred:0.01688244938850403, decouple_loss:0.0016509146662428975
The modified gen p mean: 0.4506740868091583, gen p mean: -0.04977138713002205, mean p set: 0.45115435123443604The modified gen p mean: 0.4502808749675751, gen p mean: -0.05039146915078163, mean p set: 0.4507611393928528
loss_pred:0.01727798581123352, decouple_loss:0.0015610537957400084
loss_pred:0.01730668917298317, decouple_loss:0.0016744491877034307
2023-05-01 06:15:57 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.061104949563741684, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830833911896, gen p mean: -0.05699744075536728, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.05552765354514122, mean p set: 0.45035696029663086
loss_pred:0.018948376178741455, decouple_loss:0.001867780927568674
loss_pred:0.01791227050125599, decouple_loss:0.0017835693433880806
loss_pred:0.017787110060453415, decouple_loss:0.0018280930817127228
WV_0_PC_1_EH_0_PS_40, loss: 0.018307242542505264, avg_mse: 0.026121430099010468
current test mse: 0.026121
Iteration: 181, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45033779740333557, gen p mean: -0.048764102160930634, mean p set: 0.45081809163093567
The modified gen p mean: 0.4506209194660187, gen p mean: -0.04683856666088104, mean p set: 0.4511011838912964
The modified gen p mean: 0.44965460896492004, gen p mean: -0.045191965997219086, mean p set: 0.45013487339019775
loss_pred:0.016747256740927696, decouple_loss:0.001755055389367044
loss_pred:0.016561584547162056, decouple_loss:0.0017586752073839307
loss_pred:0.016749434173107147, decouple_loss:0.0017679808661341667
Iteration: 182, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485941231250763, gen p mean: -0.0506078265607357, mean p set: 0.4490744471549988
loss_pred:0.016681421548128128, decouple_loss:0.0015708499122411013
The modified gen p mean: 0.45013856887817383, gen p mean: -0.04760706052184105, mean p set: 0.4506188929080963The modified gen p mean: 0.45010942220687866, gen p mean: -0.047632310539484024, mean p set: 0.45058971643447876
loss_pred:0.016340075060725212, decouple_loss:0.0014736135490238667
loss_pred:0.016054389998316765, decouple_loss:0.001485380227677524
Iteration: 183, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481179416179657, gen p mean: -0.04325900226831436, mean p set: 0.4485982656478882
loss_pred:0.017631931230425835, decouple_loss:0.0016373321413993835
The modified gen p mean: 0.4477819502353668, gen p mean: -0.04381530359387398, mean p set: 0.44826221466064453The modified gen p mean: 0.45040223002433777, gen p mean: -0.043645597994327545, mean p set: 0.45088252425193787
loss_pred:0.01740719936788082, decouple_loss:0.0015074267284944654
loss_pred:0.016764622181653976, decouple_loss:0.0015934571856632829
Iteration: 184, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44734182953834534, gen p mean: -0.04372189939022064, mean p set: 0.44782212376594543
The modified gen p mean: 0.44726619124412537, gen p mean: -0.046616122126579285, mean p set: 0.44774648547172546
loss_pred:0.0169668048620224, decouple_loss:0.0014109209878370166
loss_pred:0.015786483883857727, decouple_loss:0.0015008068876340985
The modified gen p mean: 0.44847986102104187, gen p mean: -0.040381282567977905, mean p set: 0.44896015524864197
loss_pred:0.0173772145062685, decouple_loss:0.0014418258797377348
Iteration: 185, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498419165611267, gen p mean: -0.04175250604748726, mean p set: 0.4503222107887268
The modified gen p mean: 0.4481814205646515, gen p mean: -0.042497530579566956, mean p set: 0.4486616849899292
loss_pred:0.016764981672167778, decouple_loss:0.0015862658619880676
loss_pred:0.017570246011018753, decouple_loss:0.0014263897901400924
The modified gen p mean: 0.44850990176200867, gen p mean: -0.04457803815603256, mean p set: 0.44899022579193115
loss_pred:0.016471806913614273, decouple_loss:0.001514746923930943
Iteration: 186, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44746989011764526, gen p mean: -0.0397721529006958, mean p set: 0.447950154542923
The modified gen p mean: 0.4500086307525635, gen p mean: -0.03479206562042236, mean p set: 0.4504888951778412
loss_pred:0.016519518569111824, decouple_loss:0.0014140616403892636
loss_pred:0.015819670632481575, decouple_loss:0.001511391019448638
The modified gen p mean: 0.44976675510406494, gen p mean: -0.03738624230027199, mean p set: 0.4502470791339874
loss_pred:0.017074674367904663, decouple_loss:0.0014514403883367777
Iteration: 187, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45023879408836365, gen p mean: -0.03610922396183014, mean p set: 0.45071908831596375
The modified gen p mean: 0.4506320655345917, gen p mean: -0.03447593003511429, mean p set: 0.45111238956451416
loss_pred:0.01669495552778244, decouple_loss:0.0016068913973867893
loss_pred:0.017053132876753807, decouple_loss:0.001648077741265297
The modified gen p mean: 0.4498942792415619, gen p mean: -0.03345964848995209, mean p set: 0.4503746032714844
loss_pred:0.016631489619612694, decouple_loss:0.0014151866780593991
Iteration: 188, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483879804611206, gen p mean: -0.031631968915462494, mean p set: 0.4488682746887207
The modified gen p mean: 0.44833803176879883, gen p mean: -0.03210073709487915, mean p set: 0.44881829619407654
loss_pred:0.015861133113503456, decouple_loss:0.0017876486526802182
loss_pred:0.01683211699128151, decouple_loss:0.001858994597569108
The modified gen p mean: 0.4497023820877075, gen p mean: -0.02874865010380745, mean p set: 0.4501826763153076
loss_pred:0.015615543350577354, decouple_loss:0.0018224138766527176
Iteration: 189, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44859281182289124, gen p mean: -0.030725006014108658, mean p set: 0.44907310605049133
The modified gen p mean: 0.4473850131034851, gen p mean: -0.030244337394833565, mean p set: 0.4478653073310852
loss_pred:0.016667122021317482, decouple_loss:0.0013845888897776604
The modified gen p mean: 0.44900307059288025, gen p mean: -0.03207070380449295, mean p set: 0.44948336482048035
loss_pred:0.016912924125790596, decouple_loss:0.0013930735876783729
loss_pred:0.017042037099599838, decouple_loss:0.0013549223076552153
Iteration: 190, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450177401304245, gen p mean: -0.033543117344379425, mean p set: 0.4506576955318451
loss_pred:0.01627330668270588, decouple_loss:0.0017634319374337792
The modified gen p mean: 0.45001155138015747, gen p mean: -0.03516516834497452, mean p set: 0.45049184560775757The modified gen p mean: 0.44774147868156433, gen p mean: -0.028072915971279144, mean p set: 0.44822174310684204
loss_pred:0.017307600006461143, decouple_loss:0.0016730517381802201
loss_pred:0.016901573166251183, decouple_loss:0.0017081808764487505
2023-05-01 06:17:50 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.04616979882121086, mean p set: 0.4502691626548767
The modified gen p mean: 0.4498766362667084, gen p mean: -0.04107365757226944, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.0420081801712513, mean p set: 0.4500633478164673
loss_pred:0.0188054870814085, decouple_loss:0.0015358730452135205
loss_pred:0.01760707050561905, decouple_loss:0.0014418087666854262
loss_pred:0.017742466181516647, decouple_loss:0.001481283805333078
WV_0_PC_1_EH_0_PS_40, loss: 0.0181259922683239, avg_mse: 0.025985969230532646
current test mse: 0.025986
Iteration: 191, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486122727394104, gen p mean: -0.03658297285437584, mean p set: 0.4490925371646881
The modified gen p mean: 0.45012199878692627, gen p mean: -0.03780420869588852, mean p set: 0.45060229301452637
The modified gen p mean: 0.4502868950366974, gen p mean: -0.03222201019525528, mean p set: 0.4507671892642975
loss_pred:0.01641974039375782, decouple_loss:0.0014335870509967208
loss_pred:0.01594652608036995, decouple_loss:0.0013918729964643717
loss_pred:0.01646973006427288, decouple_loss:0.001443570596165955
Iteration: 192, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507506787776947, gen p mean: -0.0346638523042202, mean p set: 0.4512310028076172
The modified gen p mean: 0.447145938873291, gen p mean: -0.040637314319610596, mean p set: 0.4476262331008911loss_pred:0.015437554568052292, decouple_loss:0.0016127786366268992
The modified gen p mean: 0.44817742705345154, gen p mean: -0.034538205713033676, mean p set: 0.44865772128105164
loss_pred:0.016169987618923187, decouple_loss:0.0016756881959736347
loss_pred:0.015461906790733337, decouple_loss:0.0018184279324486852
Iteration: 193, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44968751072883606, gen p mean: -0.03074057213962078, mean p set: 0.45016783475875854
loss_pred:0.01585511304438114, decouple_loss:0.0013699372066184878
The modified gen p mean: 0.44942229986190796, gen p mean: -0.04114096611738205, mean p set: 0.44990259408950806The modified gen p mean: 0.44740962982177734, gen p mean: -0.0406799241900444, mean p set: 0.44788995385169983
loss_pred:0.016315553337335587, decouple_loss:0.0014508849708363414
loss_pred:0.015742409974336624, decouple_loss:0.0014616415137425065
Iteration: 194, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44747990369796753, gen p mean: -0.045693013817071915, mean p set: 0.4479601979255676
loss_pred:0.01516643725335598, decouple_loss:0.0015321564860641956
The modified gen p mean: 0.4478377103805542, gen p mean: -0.04283049702644348, mean p set: 0.4483179748058319The modified gen p mean: 0.45007219910621643, gen p mean: -0.03978118672966957, mean p set: 0.45055249333381653
loss_pred:0.015529642812907696, decouple_loss:0.0015255175530910492
loss_pred:0.016437392681837082, decouple_loss:0.001574454247020185
Iteration: 195, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44791412353515625, gen p mean: -0.043898433446884155, mean p set: 0.44839444756507874
loss_pred:0.01556466892361641, decouple_loss:0.001316363806836307
The modified gen p mean: 0.449121356010437, gen p mean: -0.043675366789102554, mean p set: 0.4496016502380371The modified gen p mean: 0.4484219253063202, gen p mean: -0.038199666887521744, mean p set: 0.4489021897315979
loss_pred:0.016297370195388794, decouple_loss:0.0013678761897608638
loss_pred:0.016730062663555145, decouple_loss:0.0013602337567135692
Iteration: 196, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44838863611221313, gen p mean: -0.04220398887991905, mean p set: 0.44886893033981323
loss_pred:0.01651868037879467, decouple_loss:0.0016029886901378632
The modified gen p mean: 0.447834849357605, gen p mean: -0.04183834418654442, mean p set: 0.4483151137828827The modified gen p mean: 0.45031341910362244, gen p mean: -0.04120607674121857, mean p set: 0.4507937431335449
loss_pred:0.015715332701802254, decouple_loss:0.001729927258566022
loss_pred:0.016411924734711647, decouple_loss:0.001459264662116766
Iteration: 197, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500276744365692, gen p mean: -0.040526438504457474, mean p set: 0.4505079984664917
loss_pred:0.015672046691179276, decouple_loss:0.0014400591608136892
The modified gen p mean: 0.4498848617076874, gen p mean: -0.041922908276319504, mean p set: 0.4503651261329651The modified gen p mean: 0.4505457878112793, gen p mean: -0.04063018411397934, mean p set: 0.4510261118412018
loss_pred:0.015498355962336063, decouple_loss:0.001349058235064149
loss_pred:0.016296109184622765, decouple_loss:0.0013914594892412424
Iteration: 198, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447441041469574, gen p mean: -0.043209418654441833, mean p set: 0.4479213356971741
loss_pred:0.015500008128583431, decouple_loss:0.0019321158761158586
The modified gen p mean: 0.4489588439464569, gen p mean: -0.0435810312628746, mean p set: 0.449439138174057
The modified gen p mean: 0.44752296805381775, gen p mean: -0.042778436094522476, mean p set: 0.44800323247909546
loss_pred:0.016265634447336197, decouple_loss:0.0016857169102877378
loss_pred:0.016341116279363632, decouple_loss:0.0017469280865043402
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012004_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012004_3_24hr.npz
NaN value num: 0
Iteration: 199, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450145959854126, gen p mean: -0.03748586028814316, mean p set: 0.4506262540817261
loss_pred:0.01699134148657322, decouple_loss:0.0014009819133207202
The modified gen p mean: 0.45094335079193115, gen p mean: -0.047390326857566833, mean p set: 0.45142364501953125The modified gen p mean: 0.4497143030166626, gen p mean: -0.044325705617666245, mean p set: 0.4501945972442627
loss_pred:0.017812229692935944, decouple_loss:0.0014118977123871446
loss_pred:0.01830805093050003, decouple_loss:0.0014841132797300816
Iteration: 200, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514380991458893, gen p mean: -0.03838520124554634, mean p set: 0.4519183933734894
The modified gen p mean: 0.4502315819263458, gen p mean: -0.04053749144077301, mean p set: 0.4507118761539459
loss_pred:0.016674086451530457, decouple_loss:0.0016049019759520888
loss_pred:0.01791510172188282, decouple_loss:0.001747713889926672
The modified gen p mean: 0.4498480260372162, gen p mean: -0.03916912153363228, mean p set: 0.4503283202648163
loss_pred:0.01682194508612156, decouple_loss:0.0015531039098277688
2023-05-01 06:20:24 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.04766879603266716, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.042826056480407715, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.04351183399558067, mean p set: 0.4500633478164673
loss_pred:0.018698614090681076, decouple_loss:0.0015487965429201722
loss_pred:0.017505653202533722, decouple_loss:0.0014461231185123324
loss_pred:0.017653603106737137, decouple_loss:0.0014829912688583136
WV_0_PC_1_EH_0_PS_40, loss: 0.018027257174253464, avg_mse: 0.025845613330602646
current test mse: 0.025846
Iteration: 201, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504311978816986, gen p mean: -0.034251563251018524, mean p set: 0.4509114921092987
The modified gen p mean: 0.44856712222099304, gen p mean: -0.04181453958153725, mean p set: 0.44904741644859314
The modified gen p mean: 0.4519311487674713, gen p mean: -0.043413110077381134, mean p set: 0.452411413192749
loss_pred:0.01747927814722061, decouple_loss:0.0015862260479480028
loss_pred:0.01679132506251335, decouple_loss:0.001374989515170455
loss_pred:0.019374284893274307, decouple_loss:0.0014100397238507867
Iteration: 202, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4510286748409271, gen p mean: -0.04614010080695152, mean p set: 0.4515089690685272
The modified gen p mean: 0.451698362827301, gen p mean: -0.0395723432302475, mean p set: 0.4521786570549011loss_pred:0.01779860258102417, decouple_loss:0.0014961980050429702
The modified gen p mean: 0.44896626472473145, gen p mean: -0.0421210452914238, mean p set: 0.44944655895233154
loss_pred:0.01673183962702751, decouple_loss:0.0015082054305821657
loss_pred:0.01637042686343193, decouple_loss:0.001465279026888311
Iteration: 203, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502875506877899, gen p mean: -0.04051978141069412, mean p set: 0.4507678747177124
loss_pred:0.016844769939780235, decouple_loss:0.0014631665544584394
The modified gen p mean: 0.4518994688987732, gen p mean: -0.03220018744468689, mean p set: 0.4523797929286957The modified gen p mean: 0.45046737790107727, gen p mean: -0.048561904579401016, mean p set: 0.45094767212867737
loss_pred:0.017228830605745316, decouple_loss:0.0013878592289984226
loss_pred:0.019138753414154053, decouple_loss:0.0015743083786219358
Iteration: 204, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493047595024109, gen p mean: -0.04955555871129036, mean p set: 0.449785053730011
loss_pred:0.017300598323345184, decouple_loss:0.001501514227129519
The modified gen p mean: 0.4512156546115875, gen p mean: -0.03522241860628128, mean p set: 0.4516959488391876The modified gen p mean: 0.44989413022994995, gen p mean: -0.04434901103377342, mean p set: 0.45037439465522766
loss_pred:0.016918791458010674, decouple_loss:0.001383960829116404
loss_pred:0.017279699444770813, decouple_loss:0.0014896445209160447
Iteration: 205, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499926269054413, gen p mean: -0.050338488072156906, mean p set: 0.4504729211330414
loss_pred:0.017399318516254425, decouple_loss:0.0012749508023262024
The modified gen p mean: 0.44933953881263733, gen p mean: -0.05239356681704521, mean p set: 0.4498198330402374The modified gen p mean: 0.4523484408855438, gen p mean: -0.04833660647273064, mean p set: 0.4528287649154663
loss_pred:0.017318731173872948, decouple_loss:0.001270030508749187
loss_pred:0.017120568081736565, decouple_loss:0.001284250058233738
Iteration: 206, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45169180631637573, gen p mean: -0.056816160678863525, mean p set: 0.45217210054397583
loss_pred:0.017422037199139595, decouple_loss:0.001491881557740271
The modified gen p mean: 0.45040133595466614, gen p mean: -0.05170244351029396, mean p set: 0.4508816599845886The modified gen p mean: 0.4519163966178894, gen p mean: -0.04808159917593002, mean p set: 0.4523966908454895
loss_pred:0.01656065136194229, decouple_loss:0.0014545721933245659
loss_pred:0.01647048629820347, decouple_loss:0.0016985157271847129
Iteration: 207, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511455297470093, gen p mean: -0.0508091039955616, mean p set: 0.451625794172287
loss_pred:0.016561491414904594, decouple_loss:0.0012498866999521852
The modified gen p mean: 0.4515685737133026, gen p mean: -0.0522773414850235, mean p set: 0.4520488977432251The modified gen p mean: 0.4495391845703125, gen p mean: -0.057099808007478714, mean p set: 0.4500194787979126
loss_pred:0.01709585450589657, decouple_loss:0.0013319338904693723
loss_pred:0.016819575801491737, decouple_loss:0.0012597996974363923
Iteration: 208, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45013299584388733, gen p mean: -0.0555245503783226, mean p set: 0.4506132900714874
loss_pred:0.01776999421417713, decouple_loss:0.0015431781066581607
The modified gen p mean: 0.45001593232154846, gen p mean: -0.05308407172560692, mean p set: 0.45049622654914856
The modified gen p mean: 0.45160412788391113, gen p mean: -0.05824428051710129, mean p set: 0.45208439230918884
loss_pred:0.018062936142086983, decouple_loss:0.0015043048188090324
loss_pred:0.017323758453130722, decouple_loss:0.0014500563265755773
Iteration: 209, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44992178678512573, gen p mean: -0.05527058243751526, mean p set: 0.4504021108150482
loss_pred:0.01827520690858364, decouple_loss:0.0013652490451931953
The modified gen p mean: 0.4519050717353821, gen p mean: -0.050276294350624084, mean p set: 0.4523853361606598The modified gen p mean: 0.45228272676467896, gen p mean: -0.05095842480659485, mean p set: 0.45276302099227905
loss_pred:0.017044445499777794, decouple_loss:0.0012137065641582012
loss_pred:0.017230156809091568, decouple_loss:0.0012972052209079266
Iteration: 210, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4523080885410309, gen p mean: -0.05157310888171196, mean p set: 0.452788382768631
loss_pred:0.016913358122110367, decouple_loss:0.0014738411409780383
The modified gen p mean: 0.45015671849250793, gen p mean: -0.05713648721575737, mean p set: 0.4506370425224304The modified gen p mean: 0.45015203952789307, gen p mean: -0.05119332671165466, mean p set: 0.4506323039531708
loss_pred:0.01752445474267006, decouple_loss:0.0014235745184123516
loss_pred:0.018927685916423798, decouple_loss:0.0015473501989617944
2023-05-01 06:22:18 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.05243825912475586, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.047196872532367706, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.04770585149526596, mean p set: 0.4500633478164673
loss_pred:0.01860145479440689, decouple_loss:0.001417549909092486
loss_pred:0.017452452331781387, decouple_loss:0.0014280581381171942
loss_pred:0.017550475895404816, decouple_loss:0.0014699259772896767
WV_0_PC_1_EH_0_PS_40, loss: 0.017940053716301918, avg_mse: 0.025680379942059517
current test mse: 0.02568
Iteration: 211, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45012637972831726, gen p mean: -0.04896000400185585, mean p set: 0.45060670375823975
The modified gen p mean: 0.44958290457725525, gen p mean: -0.050464481115341187, mean p set: 0.45006316900253296
The modified gen p mean: 0.4513561427593231, gen p mean: -0.03832395002245903, mean p set: 0.4518364667892456
loss_pred:0.016983747482299805, decouple_loss:0.0014124190201982856
loss_pred:0.017375750467181206, decouple_loss:0.0014115730300545692
loss_pred:0.01716323383152485, decouple_loss:0.0014435737393796444
Iteration: 212, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44880664348602295, gen p mean: -0.04277756065130234, mean p set: 0.44928696751594543
loss_pred:0.016097990795969963, decouple_loss:0.0013168059522286057
The modified gen p mean: 0.44841817021369934, gen p mean: -0.04864179342985153, mean p set: 0.44889846444129944The modified gen p mean: 0.44884514808654785, gen p mean: -0.04788397625088692, mean p set: 0.44932547211647034
loss_pred:0.017371363937854767, decouple_loss:0.0012542136246338487
loss_pred:0.018615495413541794, decouple_loss:0.0014991752104833722
Iteration: 213, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45008283853530884, gen p mean: -0.039532773196697235, mean p set: 0.4505631625652313
loss_pred:0.016533086076378822, decouple_loss:0.0014114824589341879
The modified gen p mean: 0.45040571689605713, gen p mean: -0.04189694672822952, mean p set: 0.4508860111236572The modified gen p mean: 0.4513000547885895, gen p mean: -0.045907847583293915, mean p set: 0.4517803192138672
loss_pred:0.01810191571712494, decouple_loss:0.001286162412725389
loss_pred:0.017324646934866905, decouple_loss:0.0012690906878560781
Iteration: 214, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449628621339798, gen p mean: -0.0437217652797699, mean p set: 0.45010891556739807
loss_pred:0.01731625758111477, decouple_loss:0.0011657007271423936
The modified gen p mean: 0.45132601261138916, gen p mean: -0.04517941549420357, mean p set: 0.45180633664131165The modified gen p mean: 0.44930869340896606, gen p mean: -0.04349919408559799, mean p set: 0.44978898763656616
loss_pred:0.01767451874911785, decouple_loss:0.0012241248041391373
loss_pred:0.016719555482268333, decouple_loss:0.001204855740070343
Iteration: 215, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513068199157715, gen p mean: -0.04098516330122948, mean p set: 0.4517871141433716
loss_pred:0.016929076984524727, decouple_loss:0.0013140529626980424
The modified gen p mean: 0.4507538080215454, gen p mean: -0.04571281000971794, mean p set: 0.4512340724468231The modified gen p mean: 0.4512999355792999, gen p mean: -0.047762833535671234, mean p set: 0.4517802298069
loss_pred:0.016832083463668823, decouple_loss:0.001338689704425633
loss_pred:0.017972001805901527, decouple_loss:0.00125003675930202
Iteration: 216, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513264298439026, gen p mean: -0.036712147295475006, mean p set: 0.4518067240715027
loss_pred:0.016024015843868256, decouple_loss:0.0011754340957850218
The modified gen p mean: 0.4498899281024933, gen p mean: -0.04169982671737671, mean p set: 0.45037025213241577The modified gen p mean: 0.4489753246307373, gen p mean: -0.04093454033136368, mean p set: 0.4494556486606598
loss_pred:0.016959290951490402, decouple_loss:0.0011250873794779181
loss_pred:0.017422538250684738, decouple_loss:0.0011586527107283473
Iteration: 217, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44915157556533813, gen p mean: -0.0466652512550354, mean p set: 0.44963186979293823
loss_pred:0.018417084589600563, decouple_loss:0.001333247753791511
The modified gen p mean: 0.4510977864265442, gen p mean: -0.03964320942759514, mean p set: 0.4515781104564667The modified gen p mean: 0.4499150216579437, gen p mean: -0.04522023722529411, mean p set: 0.4503953158855438
loss_pred:0.016123218461871147, decouple_loss:0.001246274565346539
loss_pred:0.01712917909026146, decouple_loss:0.001112497178837657
Iteration: 218, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505697786808014, gen p mean: -0.04263262450695038, mean p set: 0.4510500431060791
loss_pred:0.017116403207182884, decouple_loss:0.0011912266490980983
The modified gen p mean: 0.4487839937210083, gen p mean: -0.04471912980079651, mean p set: 0.4492642879486084The modified gen p mean: 0.4497564733028412, gen p mean: -0.04353996738791466, mean p set: 0.45023679733276367
loss_pred:0.017080936580896378, decouple_loss:0.0011874899500980973
loss_pred:0.01715869829058647, decouple_loss:0.0012558988528326154
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012019_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012019_3_24hr.npz
NaN value num: 0
Iteration: 219, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501849114894867, gen p mean: -0.04566143825650215, mean p set: 0.4506652057170868
loss_pred:0.017558839172124863, decouple_loss:0.0010575000196695328
The modified gen p mean: 0.44989821314811707, gen p mean: -0.04528890177607536, mean p set: 0.45037850737571716The modified gen p mean: 0.4475134313106537, gen p mean: -0.04542512446641922, mean p set: 0.4479937255382538
loss_pred:0.018453449010849, decouple_loss:0.0011748997494578362
loss_pred:0.01829380728304386, decouple_loss:0.0010809480445459485
Iteration: 220, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486970007419586, gen p mean: -0.047612741589546204, mean p set: 0.44917726516723633
loss_pred:0.018377413973212242, decouple_loss:0.0011417572386562824
The modified gen p mean: 0.4487517476081848, gen p mean: -0.04773653671145439, mean p set: 0.4492320418357849
The modified gen p mean: 0.44962504506111145, gen p mean: -0.049827441573143005, mean p set: 0.45010536909103394
loss_pred:0.018466971814632416, decouple_loss:0.001180600025691092
loss_pred:0.018604926764965057, decouple_loss:0.0011126609751954675
2023-05-01 06:24:50 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.05304710566997528, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04850347712635994, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04886830598115921, mean p set: 0.4500633478164673
loss_pred:0.018381880596280098, decouple_loss:0.0012579200556501746
loss_pred:0.017326416447758675, decouple_loss:0.0012232448207214475
loss_pred:0.01741846837103367, decouple_loss:0.001164260902442038
WV_0_PC_1_EH_0_PS_40, loss: 0.01776967942714691, avg_mse: 0.025419119745492935
current test mse: 0.025419
Iteration: 221, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493815302848816, gen p mean: -0.04875016212463379, mean p set: 0.4498618543148041
The modified gen p mean: 0.44697049260139465, gen p mean: -0.05296610668301582, mean p set: 0.44745081663131714
The modified gen p mean: 0.4487400949001312, gen p mean: -0.045920539647340775, mean p set: 0.4492203891277313
loss_pred:0.018175996840000153, decouple_loss:0.001181079656817019
loss_pred:0.017853200435638428, decouple_loss:0.001102654729038477
loss_pred:0.018420401960611343, decouple_loss:0.0011721102055162191
Iteration: 222, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447001188993454, gen p mean: -0.05704132467508316, mean p set: 0.4474814832210541
loss_pred:0.018253682181239128, decouple_loss:0.001026018988341093
The modified gen p mean: 0.44954660534858704, gen p mean: -0.04796943441033363, mean p set: 0.45002689957618713The modified gen p mean: 0.4479981064796448, gen p mean: -0.058385614305734634, mean p set: 0.44847843050956726
loss_pred:0.01842506043612957, decouple_loss:0.001167529379017651
loss_pred:0.01825730688869953, decouple_loss:0.0010750469518825412
Iteration: 223, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44855383038520813, gen p mean: -0.04886632785201073, mean p set: 0.4490341246128082
loss_pred:0.017409218475222588, decouple_loss:0.0012566681252792478
The modified gen p mean: 0.45001980662345886, gen p mean: -0.05216287449002266, mean p set: 0.4505000710487366The modified gen p mean: 0.4475889503955841, gen p mean: -0.06119035556912422, mean p set: 0.4480692446231842
loss_pred:0.018024062737822533, decouple_loss:0.0011846020352095366
loss_pred:0.018384836614131927, decouple_loss:0.001269771484658122
Iteration: 224, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491068422794342, gen p mean: -0.05311812460422516, mean p set: 0.4495871365070343
loss_pred:0.01859785057604313, decouple_loss:0.001273911795578897
The modified gen p mean: 0.4492200016975403, gen p mean: -0.05606822669506073, mean p set: 0.44970032572746277The modified gen p mean: 0.44981124997138977, gen p mean: -0.0568070225417614, mean p set: 0.45029157400131226
loss_pred:0.018546978011727333, decouple_loss:0.0012866464676335454
loss_pred:0.018286511301994324, decouple_loss:0.0012079792795702815
Iteration: 225, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481283724308014, gen p mean: -0.04974394664168358, mean p set: 0.44860872626304626
loss_pred:0.01744309440255165, decouple_loss:0.0010815801797434688
The modified gen p mean: 0.44958382844924927, gen p mean: -0.0589030385017395, mean p set: 0.45006415247917175The modified gen p mean: 0.44785863161087036, gen p mean: -0.05514613911509514, mean p set: 0.44833892583847046
loss_pred:0.018714789301156998, decouple_loss:0.001150051481090486
loss_pred:0.019121496006846428, decouple_loss:0.001098262146115303
Iteration: 226, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44943666458129883, gen p mean: -0.05840969830751419, mean p set: 0.44991692900657654
loss_pred:0.019416330382227898, decouple_loss:0.0011697724694386125
The modified gen p mean: 0.4495446979999542, gen p mean: -0.053204502910375595, mean p set: 0.45002496242523193
The modified gen p mean: 0.4490557014942169, gen p mean: -0.056539878249168396, mean p set: 0.44953596591949463
loss_pred:0.0182216614484787, decouple_loss:0.0011497137602418661
loss_pred:0.01855671964585781, decouple_loss:0.0012062211753800511
Iteration: 227, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44877147674560547, gen p mean: -0.04935596138238907, mean p set: 0.44925177097320557
loss_pred:0.018361633643507957, decouple_loss:0.0010726129403337836
The modified gen p mean: 0.4489491581916809, gen p mean: -0.04516394063830376, mean p set: 0.4494294226169586The modified gen p mean: 0.44869571924209595, gen p mean: -0.05041184276342392, mean p set: 0.44917601346969604
loss_pred:0.01855437643826008, decouple_loss:0.0011312676360830665
loss_pred:0.018985005095601082, decouple_loss:0.0011046971194446087
Iteration: 228, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495875835418701, gen p mean: -0.05215471237897873, mean p set: 0.4500678777694702
loss_pred:0.017710376530885696, decouple_loss:0.0012184872757643461
The modified gen p mean: 0.44948768615722656, gen p mean: -0.05337462201714516, mean p set: 0.44996798038482666The modified gen p mean: 0.4476543366909027, gen p mean: -0.048701610416173935, mean p set: 0.4481346309185028
loss_pred:0.018442032858729362, decouple_loss:0.0012685836991295218
loss_pred:0.018705464899539948, decouple_loss:0.0012399273691698909
Iteration: 229, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507370591163635, gen p mean: -0.04973587021231651, mean p set: 0.451217383146286
loss_pred:0.017688168212771416, decouple_loss:0.001068068784661591
The modified gen p mean: 0.45017313957214355, gen p mean: -0.052302729338407516, mean p set: 0.45065340399742126The modified gen p mean: 0.4486750662326813, gen p mean: -0.045243170112371445, mean p set: 0.44915536046028137
loss_pred:0.018024949356913567, decouple_loss:0.0010705481981858611
loss_pred:0.018534595146775246, decouple_loss:0.001081149443052709
Iteration: 230, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491044580936432, gen p mean: -0.049219947308301926, mean p set: 0.4495847821235657
loss_pred:0.018077651038765907, decouple_loss:0.001171510899439454
The modified gen p mean: 0.4487094581127167, gen p mean: -0.04712304100394249, mean p set: 0.4491897523403168The modified gen p mean: 0.4482823312282562, gen p mean: -0.05258660390973091, mean p set: 0.4487626254558563
loss_pred:0.018115485087037086, decouple_loss:0.0010904938681051135
loss_pred:0.01779005117714405, decouple_loss:0.0011613403912633657
2023-05-01 06:26:43 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.0504303015768528, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04624337702989578, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.046316809952259064, mean p set: 0.4500633478164673
loss_pred:0.01840883307158947, decouple_loss:0.0011393320746719837
loss_pred:0.01732373796403408, decouple_loss:0.0011433622566983104
loss_pred:0.017384665086865425, decouple_loss:0.0011404214892536402
WV_0_PC_1_EH_0_PS_40, loss: 0.017762798815965652, avg_mse: 0.02540673315525055
current test mse: 0.025407
Iteration: 231, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44730862975120544, gen p mean: -0.04736235737800598, mean p set: 0.44778892397880554
The modified gen p mean: 0.45032182335853577, gen p mean: -0.04853423312306404, mean p set: 0.45080211758613586
The modified gen p mean: 0.4490108788013458, gen p mean: -0.04797033220529556, mean p set: 0.44949114322662354
loss_pred:0.017877863720059395, decouple_loss:0.0010286701144650578
loss_pred:0.017984233796596527, decouple_loss:0.0010658291867002845
loss_pred:0.018024280667304993, decouple_loss:0.0012462815502658486
Iteration: 232, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44840845465660095, gen p mean: -0.049106717109680176, mean p set: 0.44888877868652344
loss_pred:0.017841316759586334, decouple_loss:0.001080002635717392
The modified gen p mean: 0.4490993618965149, gen p mean: -0.046485304832458496, mean p set: 0.449579656124115The modified gen p mean: 0.44789648056030273, gen p mean: -0.046469662338495255, mean p set: 0.44837674498558044
loss_pred:0.018476327881217003, decouple_loss:0.0011754855513572693
loss_pred:0.017098652198910713, decouple_loss:0.0010671236086636782
Iteration: 233, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479564130306244, gen p mean: -0.04855150356888771, mean p set: 0.4484367072582245
loss_pred:0.018212076276540756, decouple_loss:0.0010164459235966206
The modified gen p mean: 0.4485195279121399, gen p mean: -0.05168672651052475, mean p set: 0.4489997923374176The modified gen p mean: 0.4493502974510193, gen p mean: -0.0494220070540905, mean p set: 0.449830561876297
loss_pred:0.01854788139462471, decouple_loss:0.0010063236113637686
loss_pred:0.018047502264380455, decouple_loss:0.0010031372075900435
Iteration: 234, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44899824261665344, gen p mean: -0.05005597323179245, mean p set: 0.4494785666465759
loss_pred:0.018748687580227852, decouple_loss:0.0011647457722574472
The modified gen p mean: 0.4469609260559082, gen p mean: -0.050076548010110855, mean p set: 0.4474412202835083The modified gen p mean: 0.4474564790725708, gen p mean: -0.04854891449213028, mean p set: 0.4479367434978485
loss_pred:0.018299631774425507, decouple_loss:0.001054466818459332
loss_pred:0.01742180623114109, decouple_loss:0.0010791347594931722
Iteration: 235, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494367837905884, gen p mean: -0.04916049912571907, mean p set: 0.4499170780181885
loss_pred:0.017606718465685844, decouple_loss:0.0009830722119659185
The modified gen p mean: 0.4478062689304352, gen p mean: -0.052329618483781815, mean p set: 0.4482865631580353The modified gen p mean: 0.44915780425071716, gen p mean: -0.0498972125351429, mean p set: 0.44963809847831726
loss_pred:0.017733052372932434, decouple_loss:0.0009801818523555994
loss_pred:0.01847568340599537, decouple_loss:0.0010000963229686022
Iteration: 236, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497879445552826, gen p mean: -0.04985925927758217, mean p set: 0.4502682387828827
loss_pred:0.018295418471097946, decouple_loss:0.0010261164279654622
The modified gen p mean: 0.4491023123264313, gen p mean: -0.05170908197760582, mean p set: 0.44958263635635376The modified gen p mean: 0.4484054744243622, gen p mean: -0.05146804451942444, mean p set: 0.4488857388496399
loss_pred:0.017993943765759468, decouple_loss:0.0010351495584473014
loss_pred:0.018411697819828987, decouple_loss:0.0008937541861087084
Iteration: 237, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474480152130127, gen p mean: -0.05324695259332657, mean p set: 0.4479283094406128
loss_pred:0.018425798043608665, decouple_loss:0.0009691686136648059
The modified gen p mean: 0.45018404722213745, gen p mean: -0.05131513252854347, mean p set: 0.45066434144973755The modified gen p mean: 0.44856566190719604, gen p mean: -0.04506724700331688, mean p set: 0.44904592633247375
loss_pred:0.018504995852708817, decouple_loss:0.0009750596946105361
loss_pred:0.018145309761166573, decouple_loss:0.0010215521324425936
Iteration: 238, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493086040019989, gen p mean: -0.04870877042412758, mean p set: 0.449788898229599
loss_pred:0.018495304509997368, decouple_loss:0.0009993907297030091
The modified gen p mean: 0.4503835141658783, gen p mean: -0.049815014004707336, mean p set: 0.4508638381958008The modified gen p mean: 0.4484270215034485, gen p mean: -0.051315441727638245, mean p set: 0.4489073157310486
loss_pred:0.017023708671331406, decouple_loss:0.0009367521270178258
loss_pred:0.018426913768053055, decouple_loss:0.0010530257131904364
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012020_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012020_3_24hr.npz
NaN value num: 0
Iteration: 239, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4542848467826843, gen p mean: -0.03988250717520714, mean p set: 0.4547651410102844
loss_pred:0.017169184982776642, decouple_loss:0.0011154942912980914
The modified gen p mean: 0.45172128081321716, gen p mean: -0.033929042518138885, mean p set: 0.4522015452384949The modified gen p mean: 0.4528195261955261, gen p mean: -0.03391440585255623, mean p set: 0.4532998204231262
loss_pred:0.018091300502419472, decouple_loss:0.0010063009103760123
loss_pred:0.01771300658583641, decouple_loss:0.0010318023851141334
Iteration: 240, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45216551423072815, gen p mean: -0.034959156066179276, mean p set: 0.45264583826065063
The modified gen p mean: 0.452199250459671, gen p mean: -0.0415479801595211, mean p set: 0.4526795446872711
loss_pred:0.017347563058137894, decouple_loss:0.0012114146957173944
The modified gen p mean: 0.45335814356803894, gen p mean: -0.0394112691283226, mean p set: 0.45383843779563904
loss_pred:0.017945703119039536, decouple_loss:0.0011002987157553434
loss_pred:0.017680786550045013, decouple_loss:0.001105014467611909
2023-05-01 06:29:15 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.05224994197487831, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04778411239385605, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.04801788926124573, mean p set: 0.4500633478164673
loss_pred:0.018419364467263222, decouple_loss:0.0012125534703955054
loss_pred:0.01729610003530979, decouple_loss:0.001128417206928134
loss_pred:0.017326530069112778, decouple_loss:0.001152434037066996
WV_0_PC_1_EH_0_PS_40, loss: 0.017738889902830124, avg_mse: 0.02539108134806156
current test mse: 0.025391
At step 240, Best test: 0.025391
save model to /work/09012/haoli1/ls6/ERA5_PredRNN/checkpoints/WV_0_PC_1_EH_0_PS_40/model_test_schedule_sampling_DynaMean.ckpt
Iteration: 241, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4530980885028839, gen p mean: -0.03717287257313728, mean p set: 0.4535783529281616
loss_pred:0.017101265490055084, decouple_loss:0.0010588890872895718
The modified gen p mean: 0.4522591829299927, gen p mean: -0.03838459402322769, mean p set: 0.4527394771575928The modified gen p mean: 0.4537462890148163, gen p mean: -0.04106297343969345, mean p set: 0.4542265832424164
loss_pred:0.01802029274404049, decouple_loss:0.0010598009685054421
loss_pred:0.017402218654751778, decouple_loss:0.0011263152118772268
Iteration: 242, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4539163112640381, gen p mean: -0.040635593235492706, mean p set: 0.45439663529396057
The modified gen p mean: 0.4511502683162689, gen p mean: -0.03491624817252159, mean p set: 0.4516305923461914
loss_pred:0.016967441886663437, decouple_loss:0.0010578845394775271
loss_pred:0.018307043239474297, decouple_loss:0.0009844303131103516
The modified gen p mean: 0.45208877325057983, gen p mean: -0.04272258281707764, mean p set: 0.45256906747817993
loss_pred:0.017894713208079338, decouple_loss:0.0010001672198995948
Iteration: 243, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4530690610408783, gen p mean: -0.03685157001018524, mean p set: 0.4535493850708008
loss_pred:0.017289824783802032, decouple_loss:0.001042848569341004
The modified gen p mean: 0.4514142572879791, gen p mean: -0.03450910374522209, mean p set: 0.4518945813179016
The modified gen p mean: 0.45269808173179626, gen p mean: -0.03978122025728226, mean p set: 0.45317837595939636
loss_pred:0.018265368416905403, decouple_loss:0.0011076594237238169
loss_pred:0.017494384199380875, decouple_loss:0.0010872007114812732
Iteration: 244, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45379146933555603, gen p mean: -0.03860609605908394, mean p set: 0.45427173376083374
loss_pred:0.016814855858683586, decouple_loss:0.0010177172953262925
The modified gen p mean: 0.4526146352291107, gen p mean: -0.042777545750141144, mean p set: 0.4530949294567108The modified gen p mean: 0.4521203637123108, gen p mean: -0.036834560334682465, mean p set: 0.4526006579399109
loss_pred:0.017315862700343132, decouple_loss:0.0010326489573344588
loss_pred:0.01796790584921837, decouple_loss:0.0009997328743338585
Iteration: 245, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45392748713493347, gen p mean: -0.03691653534770012, mean p set: 0.45440778136253357
loss_pred:0.01715245097875595, decouple_loss:0.0009788789320737123
The modified gen p mean: 0.45453307032585144, gen p mean: -0.03744915872812271, mean p set: 0.45501336455345154The modified gen p mean: 0.45353010296821594, gen p mean: -0.038357000797986984, mean p set: 0.45401036739349365
loss_pred:0.01728120818734169, decouple_loss:0.0009646558319218457
loss_pred:0.017290594056248665, decouple_loss:0.0010439452016726136
Iteration: 246, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45242059230804443, gen p mean: -0.03537330776453018, mean p set: 0.45290088653564453
loss_pred:0.017981963232159615, decouple_loss:0.0010463704820722342
The modified gen p mean: 0.45326536893844604, gen p mean: -0.03834746405482292, mean p set: 0.45374566316604614The modified gen p mean: 0.45327383279800415, gen p mean: -0.04261244088411331, mean p set: 0.45375412702560425
loss_pred:0.017307812348008156, decouple_loss:0.0010752431116998196
loss_pred:0.017142901197075844, decouple_loss:0.0011322832433506846
Iteration: 247, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4529549181461334, gen p mean: -0.03575487434864044, mean p set: 0.4534352123737335
loss_pred:0.017793824896216393, decouple_loss:0.0010674976510927081
The modified gen p mean: 0.45424720644950867, gen p mean: -0.03947010263800621, mean p set: 0.45472750067710876The modified gen p mean: 0.45358502864837646, gen p mean: -0.039522260427474976, mean p set: 0.45406532287597656
loss_pred:0.016779230907559395, decouple_loss:0.0009822235442698002
loss_pred:0.016740284860134125, decouple_loss:0.0009922090684995055
Iteration: 248, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4526360332965851, gen p mean: -0.03686828538775444, mean p set: 0.4531163275241852
loss_pred:0.017306067049503326, decouple_loss:0.0011065352009609342
The modified gen p mean: 0.4532047212123871, gen p mean: -0.036902476102113724, mean p set: 0.45368504524230957The modified gen p mean: 0.45330193638801575, gen p mean: -0.03624872863292694, mean p set: 0.45378226041793823
loss_pred:0.017065325751900673, decouple_loss:0.0009750726167112589
loss_pred:0.0180917177349329, decouple_loss:0.0010818034643307328
Iteration: 249, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45377692580223083, gen p mean: -0.04129350185394287, mean p set: 0.45425722002983093
loss_pred:0.017204470932483673, decouple_loss:0.0010564043186604977
The modified gen p mean: 0.45416200160980225, gen p mean: -0.04172353819012642, mean p set: 0.45464229583740234The modified gen p mean: 0.4523431360721588, gen p mean: -0.040317703038454056, mean p set: 0.4528234302997589
loss_pred:0.01702790893614292, decouple_loss:0.0011019734665751457
loss_pred:0.017687873914837837, decouple_loss:0.0010831336257979274
Iteration: 250, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4525827467441559, gen p mean: -0.04056117311120033, mean p set: 0.45306307077407837
loss_pred:0.01735106110572815, decouple_loss:0.0011232707183808088
The modified gen p mean: 0.4537821114063263, gen p mean: -0.04405226558446884, mean p set: 0.4542624056339264The modified gen p mean: 0.45162105560302734, gen p mean: -0.0431535542011261, mean p set: 0.45210132002830505
loss_pred:0.01752668246626854, decouple_loss:0.0009949423838406801
loss_pred:0.017936747521162033, decouple_loss:0.0010102300439029932
2023-05-01 06:31:13 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.059532564133405685, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.05475737899541855, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.055053938180208206, mean p set: 0.4500633478164673
loss_pred:0.018546584993600845, decouple_loss:0.0013176542706787586
loss_pred:0.017431147396564484, decouple_loss:0.0011494975769892335
loss_pred:0.017512602731585503, decouple_loss:0.0011916973162442446
WV_0_PC_1_EH_0_PS_40, loss: 0.017891094088554382, avg_mse: 0.02567269653081894
current test mse: 0.025673
Iteration: 251, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4533783197402954, gen p mean: -0.0486382357776165, mean p set: 0.4538586437702179
The modified gen p mean: 0.45212578773498535, gen p mean: -0.04396246746182442, mean p set: 0.45260608196258545
The modified gen p mean: 0.45180827379226685, gen p mean: -0.047997742891311646, mean p set: 0.45228859782218933
loss_pred:0.017868610098958015, decouple_loss:0.0010264342417940497
loss_pred:0.0171439778059721, decouple_loss:0.0010392882395535707
loss_pred:0.018019692972302437, decouple_loss:0.0010496285976842046
Iteration: 252, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45371973514556885, gen p mean: -0.047263987362384796, mean p set: 0.45420005917549133
loss_pred:0.01666371524333954, decouple_loss:0.0011081978445872664
The modified gen p mean: 0.4510023593902588, gen p mean: -0.04449525475502014, mean p set: 0.4514826238155365The modified gen p mean: 0.45215287804603577, gen p mean: -0.041256170719861984, mean p set: 0.45263317227363586
loss_pred:0.017397604882717133, decouple_loss:0.000989602878689766
loss_pred:0.017420491203665733, decouple_loss:0.0010117962956428528
Iteration: 253, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45152685046195984, gen p mean: -0.039740391075611115, mean p set: 0.45200714468955994
loss_pred:0.0180757325142622, decouple_loss:0.0010378991719335318
The modified gen p mean: 0.4539887309074402, gen p mean: -0.04379606992006302, mean p set: 0.4544689953327179
The modified gen p mean: 0.4509071409702301, gen p mean: -0.038842324167490005, mean p set: 0.4513874351978302
loss_pred:0.01717831753194332, decouple_loss:0.001019965740852058
loss_pred:0.017421042546629906, decouple_loss:0.000959730357863009
Iteration: 254, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4521391689777374, gen p mean: -0.045087553560733795, mean p set: 0.45261943340301514
loss_pred:0.017902616411447525, decouple_loss:0.0011216049315407872
The modified gen p mean: 0.4531184434890747, gen p mean: -0.04676857218146324, mean p set: 0.4535987377166748The modified gen p mean: 0.45294082164764404, gen p mean: -0.045586418360471725, mean p set: 0.45342111587524414
loss_pred:0.01663571409881115, decouple_loss:0.0010032446589320898
loss_pred:0.01679624430835247, decouple_loss:0.0010490943677723408
Iteration: 255, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4526561498641968, gen p mean: -0.03595501184463501, mean p set: 0.4531364440917969
loss_pred:0.017872046679258347, decouple_loss:0.001124848029576242
The modified gen p mean: 0.453517884016037, gen p mean: -0.04191093519330025, mean p set: 0.4539981782436371The modified gen p mean: 0.4533141255378723, gen p mean: -0.04175911471247673, mean p set: 0.4537944197654724
loss_pred:0.016843147575855255, decouple_loss:0.0010777257848531008
loss_pred:0.017487769946455956, decouple_loss:0.0010430029360577464
Iteration: 256, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45428934693336487, gen p mean: -0.041872404515743256, mean p set: 0.45476964116096497
loss_pred:0.01713634841144085, decouple_loss:0.000918423873372376
The modified gen p mean: 0.4520069658756256, gen p mean: -0.03927767276763916, mean p set: 0.4524872601032257The modified gen p mean: 0.4524717628955841, gen p mean: -0.04058431088924408, mean p set: 0.452952116727829
loss_pred:0.017839772626757622, decouple_loss:0.0009579904726706445
loss_pred:0.017262885347008705, decouple_loss:0.00100018794182688
Iteration: 257, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45273497700691223, gen p mean: -0.04214584827423096, mean p set: 0.4532153010368347
loss_pred:0.01756630837917328, decouple_loss:0.001062330324202776
The modified gen p mean: 0.4529957175254822, gen p mean: -0.04369788244366646, mean p set: 0.4534760117530823
The modified gen p mean: 0.452231228351593, gen p mean: -0.048793863505125046, mean p set: 0.4527115225791931
loss_pred:0.01714886911213398, decouple_loss:0.0010699947597458959
loss_pred:0.017300596460700035, decouple_loss:0.0010762251913547516
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012005_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012005_3_24hr.npz
NaN value num: 0
Iteration: 258, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4519331455230713, gen p mean: -0.04789931699633598, mean p set: 0.4524134397506714
loss_pred:0.015411445870995522, decouple_loss:0.0011693030828610063
The modified gen p mean: 0.45272377133369446, gen p mean: -0.04720320925116539, mean p set: 0.45320409536361694The modified gen p mean: 0.4516843557357788, gen p mean: -0.04843657836318016, mean p set: 0.4521646797657013
loss_pred:0.01661752536892891, decouple_loss:0.0011499276151880622
loss_pred:0.01595674268901348, decouple_loss:0.001290715765208006
Iteration: 259, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4527815580368042, gen p mean: -0.04353823885321617, mean p set: 0.4532618522644043
loss_pred:0.017437204718589783, decouple_loss:0.0014217226998880506
The modified gen p mean: 0.452241986989975, gen p mean: -0.0450933575630188, mean p set: 0.4527222514152527The modified gen p mean: 0.45363762974739075, gen p mean: -0.04819384962320328, mean p set: 0.45411795377731323
loss_pred:0.015832452103495598, decouple_loss:0.001240700134076178
loss_pred:0.015238223597407341, decouple_loss:0.001422708504833281
Iteration: 260, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4525854289531708, gen p mean: -0.036144088953733444, mean p set: 0.4530657231807709
loss_pred:0.01558155007660389, decouple_loss:0.0013492924626916647
The modified gen p mean: 0.45134809613227844, gen p mean: -0.04066268354654312, mean p set: 0.4518284201622009The modified gen p mean: 0.45484495162963867, gen p mean: -0.03741421550512314, mean p set: 0.4553252160549164
loss_pred:0.01622706837952137, decouple_loss:0.001308467355556786
loss_pred:0.01638966239988804, decouple_loss:0.0012611915590241551
2023-05-01 06:33:40 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.05141088739037514, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.046773601323366165, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.0467984713613987, mean p set: 0.4500633478164673
loss_pred:0.018657440319657326, decouple_loss:0.001447015441954136
loss_pred:0.017527131363749504, decouple_loss:0.0013238796964287758
loss_pred:0.017585420981049538, decouple_loss:0.0013698770198971033
WV_0_PC_1_EH_0_PS_40, loss: 0.01799234375357628, avg_mse: 0.02583974599838257
current test mse: 0.02584
Iteration: 261, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45134198665618896, gen p mean: -0.037172190845012665, mean p set: 0.4518222510814667
The modified gen p mean: 0.4525059163570404, gen p mean: -0.0399547815322876, mean p set: 0.4529862403869629
The modified gen p mean: 0.4526849091053009, gen p mean: -0.03422955796122551, mean p set: 0.4531652331352234
loss_pred:0.01642761006951332, decouple_loss:0.0013367179781198502
loss_pred:0.016025885939598083, decouple_loss:0.0011787716066464782
loss_pred:0.015019340440630913, decouple_loss:0.0012509183725342155
Iteration: 262, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45305269956588745, gen p mean: -0.03695398196578026, mean p set: 0.45353299379348755
loss_pred:0.016428830102086067, decouple_loss:0.001195367774926126
The modified gen p mean: 0.45298337936401367, gen p mean: -0.04133986681699753, mean p set: 0.4534636437892914The modified gen p mean: 0.4525115191936493, gen p mean: -0.03521093726158142, mean p set: 0.4529918134212494
loss_pred:0.016976363956928253, decouple_loss:0.0013544257963076234
loss_pred:0.0169035904109478, decouple_loss:0.001318710739724338
Iteration: 263, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45237550139427185, gen p mean: -0.03654357045888901, mean p set: 0.45285579562187195
loss_pred:0.016659334301948547, decouple_loss:0.0013493993319571018
The modified gen p mean: 0.45179280638694763, gen p mean: -0.040703143924474716, mean p set: 0.45227310061454773The modified gen p mean: 0.4519527554512024, gen p mean: -0.03509386256337166, mean p set: 0.4524330198764801
loss_pred:0.015710409730672836, decouple_loss:0.0013392427936196327
loss_pred:0.017070217058062553, decouple_loss:0.0013358078431338072
Iteration: 264, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45199093222618103, gen p mean: -0.03753237798810005, mean p set: 0.45247119665145874
loss_pred:0.016544925048947334, decouple_loss:0.0015379643300548196
The modified gen p mean: 0.45320364832878113, gen p mean: -0.039458952844142914, mean p set: 0.4536839425563812The modified gen p mean: 0.4518902897834778, gen p mean: -0.03446474298834801, mean p set: 0.4523705840110779
loss_pred:0.01719968393445015, decouple_loss:0.0012696284102275968
loss_pred:0.01566798985004425, decouple_loss:0.0014129563933238387
Iteration: 265, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.453250527381897, gen p mean: -0.040418386459350586, mean p set: 0.45373082160949707
loss_pred:0.01466866210103035, decouple_loss:0.0011840907391160727
The modified gen p mean: 0.45210444927215576, gen p mean: -0.03653834015130997, mean p set: 0.45258474349975586The modified gen p mean: 0.45313453674316406, gen p mean: -0.04185427725315094, mean p set: 0.45361486077308655
loss_pred:0.014977368526160717, decouple_loss:0.0012780599063262343
loss_pred:0.016842719167470932, decouple_loss:0.001255706651136279
Iteration: 266, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4524298310279846, gen p mean: -0.032123710960149765, mean p set: 0.4529101252555847
loss_pred:0.015345584601163864, decouple_loss:0.001172366552054882
The modified gen p mean: 0.4529091417789459, gen p mean: -0.041402123868465424, mean p set: 0.45338940620422363The modified gen p mean: 0.4519041180610657, gen p mean: -0.03849680349230766, mean p set: 0.45238441228866577
loss_pred:0.015103881247341633, decouple_loss:0.001193849602714181
loss_pred:0.015963668003678322, decouple_loss:0.0013648365857079625
Iteration: 267, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4531157910823822, gen p mean: -0.03945881873369217, mean p set: 0.4535960853099823
loss_pred:0.017413830384612083, decouple_loss:0.0013922927901148796
The modified gen p mean: 0.4524511694908142, gen p mean: -0.031858716160058975, mean p set: 0.4529314935207367The modified gen p mean: 0.45311427116394043, gen p mean: -0.04269243776798248, mean p set: 0.4535945653915405
loss_pred:0.014631755650043488, decouple_loss:0.0011913720518350601
loss_pred:0.015361597761511803, decouple_loss:0.0012424340238794684
Iteration: 268, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4527721405029297, gen p mean: -0.042196232825517654, mean p set: 0.4532524347305298
loss_pred:0.01551738940179348, decouple_loss:0.001122580491937697
The modified gen p mean: 0.45377805829048157, gen p mean: -0.03448283299803734, mean p set: 0.45425835251808167The modified gen p mean: 0.45231375098228455, gen p mean: -0.038510020822286606, mean p set: 0.45279404520988464
loss_pred:0.01642417348921299, decouple_loss:0.0010806609643623233
loss_pred:0.016537388786673546, decouple_loss:0.00113709457218647
Iteration: 269, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513065814971924, gen p mean: -0.035404689610004425, mean p set: 0.4517868459224701
loss_pred:0.01571161486208439, decouple_loss:0.0015365220606327057
The modified gen p mean: 0.4533199667930603, gen p mean: -0.043482206761837006, mean p set: 0.4538002610206604The modified gen p mean: 0.4518020749092102, gen p mean: -0.03808817267417908, mean p set: 0.4522823691368103
loss_pred:0.015717757865786552, decouple_loss:0.0014181353617459536
loss_pred:0.016285976395010948, decouple_loss:0.0015335514908656478
Iteration: 270, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45301079750061035, gen p mean: -0.04137146472930908, mean p set: 0.45349109172821045
loss_pred:0.015522626228630543, decouple_loss:0.0011838731588795781
The modified gen p mean: 0.452714741230011, gen p mean: -0.04017418622970581, mean p set: 0.4531950354576111The modified gen p mean: 0.4525388479232788, gen p mean: -0.03824221342802048, mean p set: 0.4530191123485565
loss_pred:0.01660252921283245, decouple_loss:0.0012174402363598347
loss_pred:0.016712583601474762, decouple_loss:0.0011924614664167166
2023-05-01 06:35:33 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.051485221832990646, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04689093306660652, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.046845443546772, mean p set: 0.4500633478164673
loss_pred:0.018680470064282417, decouple_loss:0.0013081923825666308
loss_pred:0.017525626346468925, decouple_loss:0.0012092652032151818
loss_pred:0.017570212483406067, decouple_loss:0.0011984745506197214
WV_0_PC_1_EH_0_PS_40, loss: 0.017987368628382683, avg_mse: 0.02586333453655243
current test mse: 0.025863
Iteration: 271, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4525592029094696, gen p mean: -0.03995899111032486, mean p set: 0.4530394971370697
The modified gen p mean: 0.45416387915611267, gen p mean: -0.03537636250257492, mean p set: 0.45464417338371277
The modified gen p mean: 0.4527427554130554, gen p mean: -0.04059922322630882, mean p set: 0.45322301983833313
loss_pred:0.015026083216071129, decouple_loss:0.001030907267704606
loss_pred:0.015949957072734833, decouple_loss:0.0011540701379999518
loss_pred:0.016391893848776817, decouple_loss:0.0010878308676183224
Iteration: 272, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4542931020259857, gen p mean: -0.036445531994104385, mean p set: 0.4547733962535858
The modified gen p mean: 0.45410701632499695, gen p mean: -0.043721310794353485, mean p set: 0.45458728075027466
loss_pred:0.01633169874548912, decouple_loss:0.0012802018318325281
loss_pred:0.015951266512274742, decouple_loss:0.0013790979282930493
The modified gen p mean: 0.4527265727519989, gen p mean: -0.043579429388046265, mean p set: 0.453206866979599
loss_pred:0.014637315645813942, decouple_loss:0.0012795147486031055
Iteration: 273, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4524059295654297, gen p mean: -0.04106423631310463, mean p set: 0.4528862237930298
loss_pred:0.015269942581653595, decouple_loss:0.001108801574446261
The modified gen p mean: 0.4520016610622406, gen p mean: -0.03952774778008461, mean p set: 0.4524819552898407
The modified gen p mean: 0.4535497725009918, gen p mean: -0.04160371795296669, mean p set: 0.4540300667285919
loss_pred:0.01567027159035206, decouple_loss:0.0010836035944521427
loss_pred:0.01646476611495018, decouple_loss:0.0011168321361765265
Iteration: 274, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45320218801498413, gen p mean: -0.04103293642401695, mean p set: 0.45368245244026184
loss_pred:0.01572337932884693, decouple_loss:0.00124715780839324
The modified gen p mean: 0.4515909254550934, gen p mean: -0.03678559139370918, mean p set: 0.4520712196826935The modified gen p mean: 0.452231764793396, gen p mean: -0.04092787951231003, mean p set: 0.4527120590209961
loss_pred:0.015539123676717281, decouple_loss:0.001193684758618474
loss_pred:0.01601419784128666, decouple_loss:0.0012532267719507217
Iteration: 275, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4533917009830475, gen p mean: -0.037670232355594635, mean p set: 0.4538719952106476
loss_pred:0.016260026022791862, decouple_loss:0.0012316369684413075
The modified gen p mean: 0.4516180455684662, gen p mean: -0.04566814750432968, mean p set: 0.4520983099937439The modified gen p mean: 0.45258501172065735, gen p mean: -0.037393976002931595, mean p set: 0.45306530594825745
loss_pred:0.01486270036548376, decouple_loss:0.001255362294614315
loss_pred:0.01616252399981022, decouple_loss:0.00133403274230659
Iteration: 276, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45121005177497864, gen p mean: -0.03943921998143196, mean p set: 0.45169031620025635
loss_pred:0.01591573841869831, decouple_loss:0.0010492544388398528
The modified gen p mean: 0.4525229036808014, gen p mean: -0.03817279636859894, mean p set: 0.4530031979084015The modified gen p mean: 0.452146053314209, gen p mean: -0.0369943231344223, mean p set: 0.45262637734413147
loss_pred:0.01572621800005436, decouple_loss:0.0011588693596422672
loss_pred:0.01616048999130726, decouple_loss:0.001189891598187387
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012008_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012008_3_24hr.npz
NaN value num: 0
Iteration: 277, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483415484428406, gen p mean: -0.04667680710554123, mean p set: 0.4488218426704407
loss_pred:0.017485857009887695, decouple_loss:0.0012680349173024297
The modified gen p mean: 0.44823992252349854, gen p mean: -0.04590940475463867, mean p set: 0.4487202763557434The modified gen p mean: 0.45030975341796875, gen p mean: -0.04580407217144966, mean p set: 0.45079004764556885
loss_pred:0.01680229976773262, decouple_loss:0.0011700756149366498
loss_pred:0.016196073964238167, decouple_loss:0.0011706375516951084
Iteration: 278, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44924747943878174, gen p mean: -0.03827337548136711, mean p set: 0.44972777366638184
loss_pred:0.01654236577451229, decouple_loss:0.001218521618284285
The modified gen p mean: 0.44940653443336487, gen p mean: -0.04334099963307381, mean p set: 0.44988682866096497The modified gen p mean: 0.4485498070716858, gen p mean: -0.03882952034473419, mean p set: 0.4490301311016083
loss_pred:0.016504280269145966, decouple_loss:0.0012353725032880902
loss_pred:0.016768857836723328, decouple_loss:0.0011752103455364704
Iteration: 279, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44773152470588684, gen p mean: -0.040193140506744385, mean p set: 0.44821181893348694
loss_pred:0.01630435138940811, decouple_loss:0.0011485399445518851
The modified gen p mean: 0.4510635435581207, gen p mean: -0.04273040592670441, mean p set: 0.4515438675880432The modified gen p mean: 0.45041942596435547, gen p mean: -0.03951699659228325, mean p set: 0.45089972019195557
loss_pred:0.017894582822918892, decouple_loss:0.0011987907346338034
loss_pred:0.017134051769971848, decouple_loss:0.001150251948274672
Iteration: 280, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476298689842224, gen p mean: -0.03951241821050644, mean p set: 0.4481101632118225
loss_pred:0.01626582257449627, decouple_loss:0.001140550710260868
The modified gen p mean: 0.4493008553981781, gen p mean: -0.03822847083210945, mean p set: 0.4497811496257782The modified gen p mean: 0.45010000467300415, gen p mean: -0.034818507730960846, mean p set: 0.45058029890060425
loss_pred:0.017888398841023445, decouple_loss:0.0011939009418711066
loss_pred:0.01777207851409912, decouple_loss:0.0012033882085233927
2023-05-01 06:38:05 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.0425972156226635, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.038177065551280975, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.037901781499385834, mean p set: 0.4500633478164673
loss_pred:0.018502864986658096, decouple_loss:0.001195961725898087
loss_pred:0.017388978973031044, decouple_loss:0.001212565810419619
loss_pred:0.017447026446461678, decouple_loss:0.001191347953863442
WV_0_PC_1_EH_0_PS_40, loss: 0.017839621752500534, avg_mse: 0.0255733672529459
current test mse: 0.025573
Iteration: 281, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490615725517273, gen p mean: -0.038384810090065, mean p set: 0.4495418667793274
The modified gen p mean: 0.4502198398113251, gen p mean: -0.0358097217977047, mean p set: 0.45070016384124756
The modified gen p mean: 0.44993531703948975, gen p mean: -0.03430812805891037, mean p set: 0.45041564106941223
loss_pred:0.016823112964630127, decouple_loss:0.0012237232876941562
loss_pred:0.01662532426416874, decouple_loss:0.0013484152732416987
loss_pred:0.016683312132954597, decouple_loss:0.0012032983358949423
Iteration: 282, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44797056913375854, gen p mean: -0.037194978445768356, mean p set: 0.44845086336135864
The modified gen p mean: 0.4491945803165436, gen p mean: -0.04413411766290665, mean p set: 0.44967490434646606
loss_pred:0.0172123946249485, decouple_loss:0.0013199694221839309
loss_pred:0.016237575560808182, decouple_loss:0.001339990645647049
The modified gen p mean: 0.4500833749771118, gen p mean: -0.03540907800197601, mean p set: 0.4505636692047119
loss_pred:0.016539499163627625, decouple_loss:0.0011818615021184087
Iteration: 283, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45034605264663696, gen p mean: -0.03473125398159027, mean p set: 0.45082634687423706
The modified gen p mean: 0.44915708899497986, gen p mean: -0.03572359308600426, mean p set: 0.44963738322257996
loss_pred:0.016299951821565628, decouple_loss:0.0011799713829532266
loss_pred:0.01644914038479328, decouple_loss:0.0012894297251477838
The modified gen p mean: 0.449398398399353, gen p mean: -0.032387785613536835, mean p set: 0.4498787224292755
loss_pred:0.016144268214702606, decouple_loss:0.0011731508420780301
Iteration: 284, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45033302903175354, gen p mean: -0.03848183900117874, mean p set: 0.450813353061676
loss_pred:0.016094984486699104, decouple_loss:0.001108853379264474
The modified gen p mean: 0.4498796761035919, gen p mean: -0.03163490444421768, mean p set: 0.450359970331192The modified gen p mean: 0.44963711500167847, gen p mean: -0.03204898536205292, mean p set: 0.4501173794269562
loss_pred:0.01740618422627449, decouple_loss:0.001199626480229199
loss_pred:0.016047464683651924, decouple_loss:0.0011550193885341287
Iteration: 285, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44960451126098633, gen p mean: -0.03541659936308861, mean p set: 0.4500848054885864
loss_pred:0.017803160473704338, decouple_loss:0.0012329104356467724
The modified gen p mean: 0.44962725043296814, gen p mean: -0.03845131769776344, mean p set: 0.45010754466056824The modified gen p mean: 0.4500763416290283, gen p mean: -0.037658531218767166, mean p set: 0.4505566358566284
loss_pred:0.016863152384757996, decouple_loss:0.0012103033950552344
loss_pred:0.016586309298872948, decouple_loss:0.0013701841235160828
Iteration: 286, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493899643421173, gen p mean: -0.037346769124269485, mean p set: 0.4498702585697174
loss_pred:0.0169232077896595, decouple_loss:0.0011215038830414414
The modified gen p mean: 0.44868695735931396, gen p mean: -0.04240758344531059, mean p set: 0.44916728138923645The modified gen p mean: 0.44904953241348267, gen p mean: -0.03580794483423233, mean p set: 0.44952985644340515
loss_pred:0.01667853817343712, decouple_loss:0.0010837203590199351
loss_pred:0.015910029411315918, decouple_loss:0.0011065785074606538
Iteration: 287, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44900333881378174, gen p mean: -0.03717099875211716, mean p set: 0.44948363304138184
loss_pred:0.016563061624765396, decouple_loss:0.0012569708051159978
The modified gen p mean: 0.44854944944381714, gen p mean: -0.040463704615831375, mean p set: 0.44902974367141724The modified gen p mean: 0.44914504885673523, gen p mean: -0.03589203581213951, mean p set: 0.4496253430843353
loss_pred:0.016135063022375107, decouple_loss:0.0010708653135225177
loss_pred:0.016783861443400383, decouple_loss:0.0011482706759124994
Iteration: 288, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488687515258789, gen p mean: -0.0420583076775074, mean p set: 0.449349045753479
loss_pred:0.016970481723546982, decouple_loss:0.0011224054032936692
The modified gen p mean: 0.44890129566192627, gen p mean: -0.03850391134619713, mean p set: 0.44938161969184875
The modified gen p mean: 0.4482998549938202, gen p mean: -0.03979049250483513, mean p set: 0.4487801790237427
loss_pred:0.016248313710093498, decouple_loss:0.0010088140843436122
loss_pred:0.015794828534126282, decouple_loss:0.0010021146154031157
Iteration: 289, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480888843536377, gen p mean: -0.04272394999861717, mean p set: 0.4485691785812378
loss_pred:0.016017917543649673, decouple_loss:0.0011130542261525989
The modified gen p mean: 0.4496261477470398, gen p mean: -0.047617942094802856, mean p set: 0.4501064419746399The modified gen p mean: 0.4479730725288391, gen p mean: -0.04311525076627731, mean p set: 0.4484533667564392
loss_pred:0.0165441632270813, decouple_loss:0.001174027333036065
loss_pred:0.017051098868250847, decouple_loss:0.0011416038032621145
Iteration: 290, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496113657951355, gen p mean: -0.0433303639292717, mean p set: 0.4500916600227356
loss_pred:0.016368206590414047, decouple_loss:0.0011689049424603581
The modified gen p mean: 0.4499788284301758, gen p mean: -0.05378037691116333, mean p set: 0.4504591226577759The modified gen p mean: 0.45019569993019104, gen p mean: -0.046460844576358795, mean p set: 0.45067599415779114
loss_pred:0.01648651622235775, decouple_loss:0.0011398179922252893
loss_pred:0.016075899824500084, decouple_loss:0.0011501064291223884
2023-05-01 06:40:00 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.04889936000108719, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04405074939131737, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830237865448, gen p mean: -0.044203270226716995, mean p set: 0.4500633478164673
loss_pred:0.018466012552380562, decouple_loss:0.0010888545075431466
loss_pred:0.017443303018808365, decouple_loss:0.0010755335679277778
loss_pred:0.017428677529096603, decouple_loss:0.001050297636538744
WV_0_PC_1_EH_0_PS_40, loss: 0.017832910642027855, avg_mse: 0.025580793619155884
current test mse: 0.025581
Iteration: 291, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44863197207450867, gen p mean: -0.03842021897435188, mean p set: 0.44911229610443115
The modified gen p mean: 0.44886040687561035, gen p mean: -0.045853663235902786, mean p set: 0.4493407607078552
The modified gen p mean: 0.45083022117614746, gen p mean: -0.04138568043708801, mean p set: 0.45131051540374756
loss_pred:0.01739785261452198, decouple_loss:0.0009963023476302624
loss_pred:0.016505900770425797, decouple_loss:0.0010089072166010737
loss_pred:0.01724502630531788, decouple_loss:0.0010256245732307434
Iteration: 292, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495692253112793, gen p mean: -0.043514952063560486, mean p set: 0.4500495493412018
loss_pred:0.017115861177444458, decouple_loss:0.0012514025438576937
The modified gen p mean: 0.44907867908477783, gen p mean: -0.0433313213288784, mean p set: 0.4495590031147003The modified gen p mean: 0.4499967396259308, gen p mean: -0.04488656669855118, mean p set: 0.4504770338535309
loss_pred:0.01599499210715294, decouple_loss:0.0011761544737964869
loss_pred:0.016715683043003082, decouple_loss:0.0012458058772608638
Iteration: 293, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44935885071754456, gen p mean: -0.03963642194867134, mean p set: 0.44983911514282227
loss_pred:0.016700295731425285, decouple_loss:0.0010259237606078386
The modified gen p mean: 0.4490783214569092, gen p mean: -0.03897712752223015, mean p set: 0.4495586156845093The modified gen p mean: 0.44768422842025757, gen p mean: -0.04454217478632927, mean p set: 0.44816452264785767
loss_pred:0.017148379236459732, decouple_loss:0.0010693131480365992
loss_pred:0.017539264634251595, decouple_loss:0.0010898886248469353
Iteration: 294, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44802233576774597, gen p mean: -0.039603184908628464, mean p set: 0.44850265979766846
loss_pred:0.016201546415686607, decouple_loss:0.0010869172401726246
The modified gen p mean: 0.4502919018268585, gen p mean: -0.050936680287122726, mean p set: 0.4507721960544586
The modified gen p mean: 0.4507077932357788, gen p mean: -0.03585780784487724, mean p set: 0.4511880874633789
loss_pred:0.01639466919004917, decouple_loss:0.001033468870446086
loss_pred:0.017341841012239456, decouple_loss:0.0010632167104631662
Iteration: 295, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495902955532074, gen p mean: -0.04696134105324745, mean p set: 0.4500705897808075
loss_pred:0.01594284549355507, decouple_loss:0.001091920887120068
The modified gen p mean: 0.4498811662197113, gen p mean: -0.03996226191520691, mean p set: 0.4503614604473114The modified gen p mean: 0.4492672085762024, gen p mean: -0.034279875457286835, mean p set: 0.4497474730014801
loss_pred:0.016219040378928185, decouple_loss:0.001231610425747931
loss_pred:0.016625601798295975, decouple_loss:0.0011428602738305926
Iteration: 296, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44967159628868103, gen p mean: -0.04227634519338608, mean p set: 0.45015186071395874
loss_pred:0.01733466051518917, decouple_loss:0.0010948939016088843
The modified gen p mean: 0.4499998986721039, gen p mean: -0.04113547131419182, mean p set: 0.450480192899704
The modified gen p mean: 0.44783833622932434, gen p mean: -0.04103932902216911, mean p set: 0.44831863045692444
loss_pred:0.017043037340044975, decouple_loss:0.0011129941558465362
loss_pred:0.01678713783621788, decouple_loss:0.0010942256776615977
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012010_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012010_3_24hr.npz
NaN value num: 0
Iteration: 297, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477614462375641, gen p mean: -0.03862742707133293, mean p set: 0.4482417702674866
loss_pred:0.017564848065376282, decouple_loss:0.0010541779920458794
The modified gen p mean: 0.44806918501853943, gen p mean: -0.044977713376283646, mean p set: 0.4485495090484619The modified gen p mean: 0.4480290412902832, gen p mean: -0.04238349199295044, mean p set: 0.4485093653202057
loss_pred:0.01840306632220745, decouple_loss:0.001116627943702042
loss_pred:0.018703218549489975, decouple_loss:0.0013482377398759127
Iteration: 298, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495382308959961, gen p mean: -0.04245376959443092, mean p set: 0.4500185549259186
loss_pred:0.017514348030090332, decouple_loss:0.0012775843497365713
The modified gen p mean: 0.4469059705734253, gen p mean: -0.03913262486457825, mean p set: 0.447386234998703The modified gen p mean: 0.4478081166744232, gen p mean: -0.039389047771692276, mean p set: 0.4482884109020233
loss_pred:0.017428703606128693, decouple_loss:0.001211630878970027
loss_pred:0.017175564542412758, decouple_loss:0.0011876878561452031
Iteration: 299, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44697925448417664, gen p mean: -0.039675481617450714, mean p set: 0.4474595785140991
loss_pred:0.016734329983592033, decouple_loss:0.0011882742401212454
The modified gen p mean: 0.44695374369621277, gen p mean: -0.04157662391662598, mean p set: 0.44743403792381287The modified gen p mean: 0.44757428765296936, gen p mean: -0.0428222194314003, mean p set: 0.44805458188056946
loss_pred:0.018608465790748596, decouple_loss:0.0011800468200817704
loss_pred:0.016727032139897346, decouple_loss:0.0011542100692167878
Iteration: 300, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44677734375, gen p mean: -0.04329196363687515, mean p set: 0.4472576081752777
loss_pred:0.017182014882564545, decouple_loss:0.0010340147418901324
The modified gen p mean: 0.4475911259651184, gen p mean: -0.03961605206131935, mean p set: 0.4480714499950409The modified gen p mean: 0.44722703099250793, gen p mean: -0.041486527770757675, mean p set: 0.44770732522010803
loss_pred:0.017895067110657692, decouple_loss:0.0010342537425458431
loss_pred:0.0168522410094738, decouple_loss:0.0010675929952412844
2023-05-01 06:42:36 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.04515363276004791, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04026338458061218, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04048602655529976, mean p set: 0.4500633478164673
loss_pred:0.01833200268447399, decouple_loss:0.001233468297868967
loss_pred:0.0173278097063303, decouple_loss:0.0012597505701705813
loss_pred:0.01734783500432968, decouple_loss:0.001265968894585967
WV_0_PC_1_EH_0_PS_40, loss: 0.01773187145590782, avg_mse: 0.02536887861788273
current test mse: 0.025369
At step 300, Best test: 0.025369
save model to /work/09012/haoli1/ls6/ERA5_PredRNN/checkpoints/WV_0_PC_1_EH_0_PS_40/model_test_schedule_sampling_DynaMean.ckpt
Iteration: 301, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4463266134262085, gen p mean: -0.04568108916282654, mean p set: 0.4468069076538086
loss_pred:0.01692076213657856, decouple_loss:0.001108621945604682
The modified gen p mean: 0.44860216975212097, gen p mean: -0.042656682431697845, mean p set: 0.44908249378204346The modified gen p mean: 0.44763636589050293, gen p mean: -0.04152432084083557, mean p set: 0.448116660118103
loss_pred:0.01751421019434929, decouple_loss:0.0012630759738385677
loss_pred:0.018807442858815193, decouple_loss:0.0012534146662801504
Iteration: 302, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44797375798225403, gen p mean: -0.04753516614437103, mean p set: 0.4484540522098541
loss_pred:0.017302915453910828, decouple_loss:0.0011269424576312304
The modified gen p mean: 0.446316123008728, gen p mean: -0.04850974678993225, mean p set: 0.4467964172363281The modified gen p mean: 0.4468751847743988, gen p mean: -0.04602355509996414, mean p set: 0.4473554790019989
loss_pred:0.016610559076070786, decouple_loss:0.0011415623594075441
loss_pred:0.017208339646458626, decouple_loss:0.0010456505697220564
Iteration: 303, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485020637512207, gen p mean: -0.05125465989112854, mean p set: 0.4489823877811432
loss_pred:0.01765480265021324, decouple_loss:0.0011116564273834229
The modified gen p mean: 0.4478977620601654, gen p mean: -0.050014935433864594, mean p set: 0.4483780562877655The modified gen p mean: 0.44866013526916504, gen p mean: -0.052094943821430206, mean p set: 0.44914042949676514
loss_pred:0.017368841916322708, decouple_loss:0.0011079420801252127
loss_pred:0.01851269043982029, decouple_loss:0.0011791345896199346
Iteration: 304, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44706299901008606, gen p mean: -0.04957098513841629, mean p set: 0.44754326343536377
loss_pred:0.017590584233403206, decouple_loss:0.001123604946769774
The modified gen p mean: 0.44661226868629456, gen p mean: -0.048280976712703705, mean p set: 0.44709256291389465The modified gen p mean: 0.44795945286750793, gen p mean: -0.04651191085577011, mean p set: 0.44843971729278564
loss_pred:0.017679128795862198, decouple_loss:0.0010922770015895367
loss_pred:0.01779957488179207, decouple_loss:0.0010868348181247711
Iteration: 305, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44738319516181946, gen p mean: -0.0533236525952816, mean p set: 0.44786348938941956
loss_pred:0.017420120537281036, decouple_loss:0.0010646680602803826
The modified gen p mean: 0.4490973949432373, gen p mean: -0.052806559950113297, mean p set: 0.4495777189731598The modified gen p mean: 0.4476429224014282, gen p mean: -0.054899461567401886, mean p set: 0.4481232166290283
loss_pred:0.01826387643814087, decouple_loss:0.0010260409908369184
loss_pred:0.01681671477854252, decouple_loss:0.0010171517496928573
Iteration: 306, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466245174407959, gen p mean: -0.05789775028824806, mean p set: 0.447104811668396
loss_pred:0.016690444201231003, decouple_loss:0.0010992640163749456
The modified gen p mean: 0.4478965699672699, gen p mean: -0.05286026373505592, mean p set: 0.44837686419487The modified gen p mean: 0.4474125802516937, gen p mean: -0.05133017525076866, mean p set: 0.4478928744792938
loss_pred:0.01831013523042202, decouple_loss:0.0011711482657119632
loss_pred:0.018256861716508865, decouple_loss:0.0011553853983059525
Iteration: 307, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44926366209983826, gen p mean: -0.05644794553518295, mean p set: 0.44974398612976074
loss_pred:0.0173946600407362, decouple_loss:0.0011851273011416197
The modified gen p mean: 0.4479115903377533, gen p mean: -0.05233020335435867, mean p set: 0.448391854763031The modified gen p mean: 0.44746389985084534, gen p mean: -0.05331794545054436, mean p set: 0.4479442238807678
loss_pred:0.017994748428463936, decouple_loss:0.001133630983531475
loss_pred:0.01696540042757988, decouple_loss:0.0011876699281856418
Iteration: 308, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477812349796295, gen p mean: -0.04901748523116112, mean p set: 0.4482615292072296
loss_pred:0.017670385539531708, decouple_loss:0.0011680085444822907
The modified gen p mean: 0.4472706615924835, gen p mean: -0.05068937689065933, mean p set: 0.4477509558200836The modified gen p mean: 0.44669780135154724, gen p mean: -0.05037098005414009, mean p set: 0.44717806577682495
loss_pred:0.018441298976540565, decouple_loss:0.001149954623542726
loss_pred:0.018009714782238007, decouple_loss:0.0010687696048989892
Iteration: 309, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44698894023895264, gen p mean: -0.04297356307506561, mean p set: 0.4474692642688751
loss_pred:0.018523506820201874, decouple_loss:0.0010321412701159716
The modified gen p mean: 0.4465072751045227, gen p mean: -0.04782188683748245, mean p set: 0.4469875395298004
The modified gen p mean: 0.4475124478340149, gen p mean: -0.0494869202375412, mean p set: 0.447992742061615
loss_pred:0.017481904476881027, decouple_loss:0.0012278594076633453
loss_pred:0.01811530441045761, decouple_loss:0.0011600168654695153
Iteration: 310, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44634953141212463, gen p mean: -0.046169720590114594, mean p set: 0.44682982563972473
loss_pred:0.016323335468769073, decouple_loss:0.0010094466852024198
The modified gen p mean: 0.4468501806259155, gen p mean: -0.044022057205438614, mean p set: 0.4473304748535156The modified gen p mean: 0.44859179854393005, gen p mean: -0.04767724499106407, mean p set: 0.44907209277153015
loss_pred:0.017703525722026825, decouple_loss:0.0010105915134772658
loss_pred:0.01776878908276558, decouple_loss:0.0009957526344805956
2023-05-01 06:44:34 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.0484650693833828, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.043640490621328354, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04395462945103645, mean p set: 0.4500633478164673
loss_pred:0.018310748040676117, decouple_loss:0.0011585529427975416
loss_pred:0.017300182953476906, decouple_loss:0.0012171119451522827
loss_pred:0.017356637865304947, decouple_loss:0.0012158313766121864
WV_0_PC_1_EH_0_PS_40, loss: 0.017715714871883392, avg_mse: 0.025349086150527
current test mse: 0.025349
At step 310, Best test: 0.025349
save model to /work/09012/haoli1/ls6/ERA5_PredRNN/checkpoints/WV_0_PC_1_EH_0_PS_40/model_test_schedule_sampling_DynaMean.ckpt
Iteration: 311, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479251205921173, gen p mean: -0.04363948479294777, mean p set: 0.4484054148197174
loss_pred:0.018470587208867073, decouple_loss:0.0011581436265259981
The modified gen p mean: 0.4479468762874603, gen p mean: -0.05239032581448555, mean p set: 0.4484272003173828The modified gen p mean: 0.4465983510017395, gen p mean: -0.048666901886463165, mean p set: 0.4470786452293396
loss_pred:0.018106700852513313, decouple_loss:0.0011396994814276695
loss_pred:0.017710953950881958, decouple_loss:0.0011123043950647116
Iteration: 312, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465520977973938, gen p mean: -0.04489175230264664, mean p set: 0.4470323920249939
loss_pred:0.017475541681051254, decouple_loss:0.001075222622603178
The modified gen p mean: 0.4474947154521942, gen p mean: -0.04471525922417641, mean p set: 0.4479750096797943The modified gen p mean: 0.4462946653366089, gen p mean: -0.04583440721035004, mean p set: 0.446774959564209
loss_pred:0.01759677566587925, decouple_loss:0.0010578398359939456
loss_pred:0.017995743080973625, decouple_loss:0.0009801145642995834
Iteration: 313, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479336738586426, gen p mean: -0.04801388457417488, mean p set: 0.44841399788856506
loss_pred:0.018102776259183884, decouple_loss:0.0010312494123354554
The modified gen p mean: 0.44768568873405457, gen p mean: -0.05021067336201668, mean p set: 0.44816598296165466The modified gen p mean: 0.44730210304260254, gen p mean: -0.050198037177324295, mean p set: 0.44778236746788025
loss_pred:0.01761505752801895, decouple_loss:0.0010013635037466884
loss_pred:0.01793527975678444, decouple_loss:0.0009997007437050343
Iteration: 314, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44886574149131775, gen p mean: -0.05083131045103073, mean p set: 0.44934606552124023
loss_pred:0.01804276369512081, decouple_loss:0.0011735729640349746
The modified gen p mean: 0.4468787908554077, gen p mean: -0.05603098124265671, mean p set: 0.4473590552806854The modified gen p mean: 0.44862696528434753, gen p mean: -0.05285630747675896, mean p set: 0.44910722970962524
loss_pred:0.01708371751010418, decouple_loss:0.0012489903019741178
loss_pred:0.017464276403188705, decouple_loss:0.0011205591727048159
Iteration: 315, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44771096110343933, gen p mean: -0.05291251838207245, mean p set: 0.44819125533103943
loss_pred:0.016503289341926575, decouple_loss:0.000978508498519659
The modified gen p mean: 0.44763433933258057, gen p mean: -0.049521803855895996, mean p set: 0.44811463356018066The modified gen p mean: 0.4499262869358063, gen p mean: -0.05514545366168022, mean p set: 0.45040658116340637
loss_pred:0.017126701772212982, decouple_loss:0.0010429928079247475
loss_pred:0.018215205520391464, decouple_loss:0.0009533464326523244
Iteration: 316, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469698369503021, gen p mean: -0.052265897393226624, mean p set: 0.44745010137557983
loss_pred:0.018630022183060646, decouple_loss:0.000987338018603623
The modified gen p mean: 0.4468447268009186, gen p mean: -0.0523957796394825, mean p set: 0.44732505083084106The modified gen p mean: 0.4469502866268158, gen p mean: -0.05118188634514809, mean p set: 0.4474305510520935
loss_pred:0.01760672964155674, decouple_loss:0.0009738286607898772
loss_pred:0.017291011288762093, decouple_loss:0.001066083088517189
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012007_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012007_3_24hr.npz
NaN value num: 0
Iteration: 317, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484303593635559, gen p mean: -0.047476980835199356, mean p set: 0.4489106833934784
loss_pred:0.015087450854480267, decouple_loss:0.0011275155702605844
The modified gen p mean: 0.4482479691505432, gen p mean: -0.04705362021923065, mean p set: 0.4487282633781433The modified gen p mean: 0.44823968410491943, gen p mean: -0.04704179987311363, mean p set: 0.44871997833251953
loss_pred:0.014573669992387295, decouple_loss:0.0011057938681915402
loss_pred:0.01527255680412054, decouple_loss:0.0009679030044935644
Iteration: 318, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44771867990493774, gen p mean: -0.045085810124874115, mean p set: 0.44819900393486023
loss_pred:0.014532524161040783, decouple_loss:0.0009631150169298053
The modified gen p mean: 0.4475768804550171, gen p mean: -0.05031999573111534, mean p set: 0.4480571746826172The modified gen p mean: 0.448089063167572, gen p mean: -0.043351612985134125, mean p set: 0.4485693573951721
loss_pred:0.014946774579584599, decouple_loss:0.0009749477612785995
loss_pred:0.014236755669116974, decouple_loss:0.0010166472056880593
Iteration: 319, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447005033493042, gen p mean: -0.04268388822674751, mean p set: 0.4474853575229645
loss_pred:0.014076432213187218, decouple_loss:0.001176156336441636
The modified gen p mean: 0.4479919672012329, gen p mean: -0.03930891305208206, mean p set: 0.448472261428833
The modified gen p mean: 0.44881513714790344, gen p mean: -0.04076007753610611, mean p set: 0.44929543137550354
loss_pred:0.01406047958880663, decouple_loss:0.0012050035875290632
loss_pred:0.014525704085826874, decouple_loss:0.0012844557641074061
Iteration: 320, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470553696155548, gen p mean: -0.03944363072514534, mean p set: 0.4475356340408325
loss_pred:0.014309869147837162, decouple_loss:0.0011271454859524965
The modified gen p mean: 0.4477677047252655, gen p mean: -0.03887423500418663, mean p set: 0.4482479691505432The modified gen p mean: 0.44795140624046326, gen p mean: -0.03374436870217323, mean p set: 0.44843170046806335
loss_pred:0.014526478946208954, decouple_loss:0.0011274443240836263
loss_pred:0.013941356912255287, decouple_loss:0.0011745363008230925
2023-05-01 06:47:14 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.03535205498337746, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.03140486776828766, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.031381528824567795, mean p set: 0.4500633478164673
loss_pred:0.018745150417089462, decouple_loss:0.0012538429582491517
loss_pred:0.017724627628922462, decouple_loss:0.0012887483462691307
loss_pred:0.01772727444767952, decouple_loss:0.0012712155003100634
WV_0_PC_1_EH_0_PS_40, loss: 0.018129248172044754, avg_mse: 0.0261272881180048
current test mse: 0.026127
Iteration: 321, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475352168083191, gen p mean: -0.03188314661383629, mean p set: 0.4480155408382416
The modified gen p mean: 0.44702863693237305, gen p mean: -0.03680269047617912, mean p set: 0.44750893115997314
The modified gen p mean: 0.4480031430721283, gen p mean: -0.029370978474617004, mean p set: 0.4484834671020508
loss_pred:0.014303542673587799, decouple_loss:0.0012360949767753482
loss_pred:0.015450120903551579, decouple_loss:0.0013528764247894287
loss_pred:0.013782558031380177, decouple_loss:0.0012008423218503594
Iteration: 322, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44784078001976013, gen p mean: -0.032439861446619034, mean p set: 0.44832107424736023
loss_pred:0.014868201687932014, decouple_loss:0.0014846979174762964
The modified gen p mean: 0.44970178604125977, gen p mean: -0.0325334407389164, mean p set: 0.45018208026885986The modified gen p mean: 0.4468880593776703, gen p mean: -0.030896451324224472, mean p set: 0.447368323802948
loss_pred:0.014047984033823013, decouple_loss:0.00134347565472126
loss_pred:0.013129063881933689, decouple_loss:0.0012259152717888355
Iteration: 323, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44762858748435974, gen p mean: -0.02994164638221264, mean p set: 0.4481089115142822
loss_pred:0.014456422999501228, decouple_loss:0.001469663460738957
The modified gen p mean: 0.4483628273010254, gen p mean: -0.03326485678553581, mean p set: 0.4488431215286255The modified gen p mean: 0.4472527801990509, gen p mean: -0.03160715848207474, mean p set: 0.4477330446243286
loss_pred:0.013615204021334648, decouple_loss:0.00140126864425838
loss_pred:0.01395028829574585, decouple_loss:0.0012992598349228501
Iteration: 324, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44793441891670227, gen p mean: -0.033061448484659195, mean p set: 0.44841471314430237
loss_pred:0.014178607612848282, decouple_loss:0.0014014897169545293
The modified gen p mean: 0.4482412040233612, gen p mean: -0.03553194925189018, mean p set: 0.4487214982509613
The modified gen p mean: 0.446414589881897, gen p mean: -0.03867752104997635, mean p set: 0.4468948543071747
loss_pred:0.013958555646240711, decouple_loss:0.0015571597032248974
loss_pred:0.013374965637922287, decouple_loss:0.0017675303388386965
Iteration: 325, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474041759967804, gen p mean: -0.039944544434547424, mean p set: 0.4478845000267029
loss_pred:0.01356317289173603, decouple_loss:0.001499034115113318
The modified gen p mean: 0.448035329580307, gen p mean: -0.03633176162838936, mean p set: 0.4485156238079071The modified gen p mean: 0.4475904405117035, gen p mean: -0.042793113738298416, mean p set: 0.4480707347393036
loss_pred:0.013285219669342041, decouple_loss:0.0016094637103378773
loss_pred:0.01457208301872015, decouple_loss:0.0016957026673480868
Iteration: 326, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495560824871063, gen p mean: -0.0384599044919014, mean p set: 0.4500364065170288
loss_pred:0.01344951894134283, decouple_loss:0.0014057047665119171
The modified gen p mean: 0.4471322298049927, gen p mean: -0.041737817227840424, mean p set: 0.4476125240325928The modified gen p mean: 0.4491856098175049, gen p mean: -0.04099864512681961, mean p set: 0.449665904045105
loss_pred:0.013635328970849514, decouple_loss:0.001332867774181068
loss_pred:0.013104010373353958, decouple_loss:0.0013949043350294232
Iteration: 327, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44588345289230347, gen p mean: -0.03920538350939751, mean p set: 0.44636374711990356
loss_pred:0.01346176490187645, decouple_loss:0.0015128260711207986
The modified gen p mean: 0.4468289613723755, gen p mean: -0.044853296130895615, mean p set: 0.447309285402298The modified gen p mean: 0.44691556692123413, gen p mean: -0.04144106060266495, mean p set: 0.4473958909511566
loss_pred:0.012962845154106617, decouple_loss:0.001673588645644486
loss_pred:0.013578308746218681, decouple_loss:0.0015641298377886415
Iteration: 328, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471645653247833, gen p mean: -0.04061998799443245, mean p set: 0.4476448595523834
loss_pred:0.013610562309622765, decouple_loss:0.0016299101989716291
The modified gen p mean: 0.4483294188976288, gen p mean: -0.03950488939881325, mean p set: 0.4488097131252289The modified gen p mean: 0.4482189118862152, gen p mean: -0.03896607458591461, mean p set: 0.4486992359161377
loss_pred:0.0136729646474123, decouple_loss:0.0015170598635450006
loss_pred:0.013759678229689598, decouple_loss:0.0016199606470763683
Iteration: 329, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44617775082588196, gen p mean: -0.04107065871357918, mean p set: 0.44665804505348206
loss_pred:0.013311627320945263, decouple_loss:0.0014943171991035342
The modified gen p mean: 0.4478377103805542, gen p mean: -0.044364117085933685, mean p set: 0.4483180344104767The modified gen p mean: 0.4483945965766907, gen p mean: -0.03817727044224739, mean p set: 0.4488748610019684
loss_pred:0.014275344088673592, decouple_loss:0.0014144543092697859
loss_pred:0.013802054338157177, decouple_loss:0.001509808236733079
Iteration: 330, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44678202271461487, gen p mean: -0.039101362228393555, mean p set: 0.44726231694221497
loss_pred:0.01427378412336111, decouple_loss:0.001518065924756229
The modified gen p mean: 0.4485644996166229, gen p mean: -0.04461664333939552, mean p set: 0.44904476404190063The modified gen p mean: 0.4476761221885681, gen p mean: -0.04107128083705902, mean p set: 0.4481564164161682
loss_pred:0.013324913568794727, decouple_loss:0.0014656530693173409
loss_pred:0.01361746434122324, decouple_loss:0.0014898532535880804
2023-05-01 06:49:08 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.045415472239255905, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04159247502684593, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.041595708578825, mean p set: 0.4500633478164673
loss_pred:0.019254984334111214, decouple_loss:0.0014284509234130383
loss_pred:0.018096376210451126, decouple_loss:0.0014371855650097132
loss_pred:0.018192078918218613, decouple_loss:0.0014185493346303701
WV_0_PC_1_EH_0_PS_40, loss: 0.01858588308095932, avg_mse: 0.027029424905776978
current test mse: 0.027029
Iteration: 331, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494439661502838, gen p mean: -0.0440850704908371, mean p set: 0.4499242305755615
The modified gen p mean: 0.44707077741622925, gen p mean: -0.043026167899370193, mean p set: 0.44755110144615173
The modified gen p mean: 0.4474222660064697, gen p mean: -0.047122664749622345, mean p set: 0.4479025602340698
loss_pred:0.013190990313887596, decouple_loss:0.0013866693479940295
loss_pred:0.0132463239133358, decouple_loss:0.0015653894515708089
loss_pred:0.01361006312072277, decouple_loss:0.0013548474526032805
Iteration: 332, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482154846191406, gen p mean: -0.044029224663972855, mean p set: 0.44869574904441833
The modified gen p mean: 0.4468555450439453, gen p mean: -0.0458594411611557, mean p set: 0.4473358392715454
loss_pred:0.01354983076453209, decouple_loss:0.0013654784997925162
loss_pred:0.013379334472119808, decouple_loss:0.001362726092338562
The modified gen p mean: 0.4477846920490265, gen p mean: -0.045805107802152634, mean p set: 0.4482649564743042
loss_pred:0.013470928184688091, decouple_loss:0.0013393746921792626
Iteration: 333, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44812512397766113, gen p mean: -0.04370630905032158, mean p set: 0.44860541820526123
loss_pred:0.013486377894878387, decouple_loss:0.0014291544212028384
The modified gen p mean: 0.4489194452762604, gen p mean: -0.04479591175913811, mean p set: 0.44939976930618286The modified gen p mean: 0.4466460347175598, gen p mean: -0.04692717269062996, mean p set: 0.4471263289451599
loss_pred:0.012949529103934765, decouple_loss:0.0013740527210757136
loss_pred:0.013247202150523663, decouple_loss:0.0014926017029210925
Iteration: 334, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466298222541809, gen p mean: -0.04342511668801308, mean p set: 0.447110116481781
loss_pred:0.013774075545370579, decouple_loss:0.001486011897213757
The modified gen p mean: 0.44904136657714844, gen p mean: -0.04496976360678673, mean p set: 0.44952166080474854The modified gen p mean: 0.4461434781551361, gen p mean: -0.04638948664069176, mean p set: 0.4466237425804138
loss_pred:0.01317904144525528, decouple_loss:0.001463830703869462
loss_pred:0.013049622066318989, decouple_loss:0.001549909939058125
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 335, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447710245847702, gen p mean: -0.04007432237267494, mean p set: 0.4481905400753021
loss_pred:0.013381251133978367, decouple_loss:0.0013481313362717628
The modified gen p mean: 0.44852301478385925, gen p mean: -0.04076362028717995, mean p set: 0.44900330901145935The modified gen p mean: 0.4500880539417267, gen p mean: -0.042176585644483566, mean p set: 0.4505683481693268
loss_pred:0.012966467067599297, decouple_loss:0.0013111948501318693
loss_pred:0.01289246417582035, decouple_loss:0.0013195626670494676
Iteration: 336, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485396146774292, gen p mean: -0.04174315929412842, mean p set: 0.4490198791027069
loss_pred:0.013853359967470169, decouple_loss:0.0012983327032998204
The modified gen p mean: 0.4492429792881012, gen p mean: -0.04027030989527702, mean p set: 0.4497232735157013The modified gen p mean: 0.45016229152679443, gen p mean: -0.04235154390335083, mean p set: 0.4506426155567169
loss_pred:0.012778498232364655, decouple_loss:0.0014701803447678685
loss_pred:0.013026276603341103, decouple_loss:0.0014122967841103673
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012016_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012016_3_24hr.npz
NaN value num: 0
Iteration: 337, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472391903400421, gen p mean: -0.04259801283478737, mean p set: 0.4477194845676422
loss_pred:0.017595116049051285, decouple_loss:0.0013596181524917483
The modified gen p mean: 0.4470826983451843, gen p mean: -0.040994491428136826, mean p set: 0.4475629925727844The modified gen p mean: 0.4466773569583893, gen p mean: -0.041607171297073364, mean p set: 0.4471576511859894
loss_pred:0.01793288253247738, decouple_loss:0.0013859921600669622
loss_pred:0.01855466328561306, decouple_loss:0.0013849049573764205
Iteration: 338, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4461660385131836, gen p mean: -0.039218876510858536, mean p set: 0.4466463625431061
loss_pred:0.01880509778857231, decouple_loss:0.0012872176012024283
The modified gen p mean: 0.4455741345882416, gen p mean: -0.039588093757629395, mean p set: 0.4460543990135193The modified gen p mean: 0.44716790318489075, gen p mean: -0.04049234837293625, mean p set: 0.44764822721481323
loss_pred:0.01857529580593109, decouple_loss:0.0013147142017260194
loss_pred:0.017938820645213127, decouple_loss:0.001312498701736331
Iteration: 339, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44718053936958313, gen p mean: -0.03743476793169975, mean p set: 0.4476608335971832
The modified gen p mean: 0.4470619261264801, gen p mean: -0.040260542184114456, mean p set: 0.4475422501564026
loss_pred:0.016779230907559395, decouple_loss:0.0012653921730816364
loss_pred:0.018172547221183777, decouple_loss:0.001395510509610176
The modified gen p mean: 0.4473735988140106, gen p mean: -0.04258662089705467, mean p set: 0.4478538930416107
loss_pred:0.01767255738377571, decouple_loss:0.0013288616901263595
Iteration: 340, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44743451476097107, gen p mean: -0.043565694242715836, mean p set: 0.44791483879089355
loss_pred:0.018650483340024948, decouple_loss:0.0014460200909525156
The modified gen p mean: 0.447206974029541, gen p mean: -0.04353644326329231, mean p set: 0.4476872384548187The modified gen p mean: 0.44613581895828247, gen p mean: -0.04461348056793213, mean p set: 0.44661614298820496
loss_pred:0.017817284911870956, decouple_loss:0.0013561148662120104
loss_pred:0.01865515485405922, decouple_loss:0.0012945930939167738
2023-05-01 06:51:41 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.04943438619375229, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04568342864513397, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.0454118587076664, mean p set: 0.4500633478164673
loss_pred:0.018543299287557602, decouple_loss:0.001404080307111144
loss_pred:0.017481375485658646, decouple_loss:0.0013639489188790321
loss_pred:0.017610345035791397, decouple_loss:0.0013861141633242369
WV_0_PC_1_EH_0_PS_40, loss: 0.017947576940059662, avg_mse: 0.025765039026737213
current test mse: 0.025765
Iteration: 341, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44564107060432434, gen p mean: -0.048237331211566925, mean p set: 0.44612136483192444
The modified gen p mean: 0.4474543035030365, gen p mean: -0.04721488058567047, mean p set: 0.4479345977306366
The modified gen p mean: 0.4467078745365143, gen p mean: -0.048332568258047104, mean p set: 0.4471881687641144
loss_pred:0.018295539543032646, decouple_loss:0.0013369157677516341
loss_pred:0.018372617661952972, decouple_loss:0.0013686048332601786
loss_pred:0.01802394539117813, decouple_loss:0.0013287834590300918
Iteration: 342, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470779597759247, gen p mean: -0.05368897691369057, mean p set: 0.4475582540035248
loss_pred:0.0185871385037899, decouple_loss:0.0013263473520055413
The modified gen p mean: 0.44649913907051086, gen p mean: -0.05571378767490387, mean p set: 0.44697946310043335The modified gen p mean: 0.4475538730621338, gen p mean: -0.05032810941338539, mean p set: 0.4480341970920563
loss_pred:0.01894531585276127, decouple_loss:0.0012896595289930701
loss_pred:0.01834992505609989, decouple_loss:0.0012755452189594507
Iteration: 343, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470103681087494, gen p mean: -0.05355028808116913, mean p set: 0.4474906623363495
loss_pred:0.016582895070314407, decouple_loss:0.0013571138260886073
The modified gen p mean: 0.448380708694458, gen p mean: -0.0588592104613781, mean p set: 0.4488610029220581The modified gen p mean: 0.44908758997917175, gen p mean: -0.05106986314058304, mean p set: 0.44956785440444946
loss_pred:0.018660135567188263, decouple_loss:0.0012949623633176088
loss_pred:0.01799086108803749, decouple_loss:0.0012984221102669835
Iteration: 344, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474444091320038, gen p mean: -0.056756824254989624, mean p set: 0.4479246735572815
loss_pred:0.018540607765316963, decouple_loss:0.0013555530458688736
The modified gen p mean: 0.44831234216690063, gen p mean: -0.0507110059261322, mean p set: 0.44879260659217834The modified gen p mean: 0.44929271936416626, gen p mean: -0.05524580925703049, mean p set: 0.44977301359176636
loss_pred:0.018068809062242508, decouple_loss:0.0013381002936512232
loss_pred:0.017841698601841927, decouple_loss:0.0013548709684982896
Iteration: 345, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44669753313064575, gen p mean: -0.05907909572124481, mean p set: 0.44717782735824585
loss_pred:0.017143744975328445, decouple_loss:0.0011906590079888701
The modified gen p mean: 0.4472741186618805, gen p mean: -0.061679478734731674, mean p set: 0.4477544128894806The modified gen p mean: 0.44696423411369324, gen p mean: -0.05875341594219208, mean p set: 0.44744452834129333
loss_pred:0.01776568777859211, decouple_loss:0.001202259911224246
loss_pred:0.018024958670139313, decouple_loss:0.0012354041682556272
Iteration: 346, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474298357963562, gen p mean: -0.06386842578649521, mean p set: 0.4479101598262787
loss_pred:0.01826530508697033, decouple_loss:0.0012109284289181232
The modified gen p mean: 0.44815242290496826, gen p mean: -0.05923198536038399, mean p set: 0.44863274693489075The modified gen p mean: 0.4484826326370239, gen p mean: -0.058084890246391296, mean p set: 0.448962926864624
loss_pred:0.017654992640018463, decouple_loss:0.001193083357065916
loss_pred:0.018082309514284134, decouple_loss:0.0012195406015962362
Iteration: 347, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44806668162345886, gen p mean: -0.058444537222385406, mean p set: 0.44854697585105896
loss_pred:0.01802704483270645, decouple_loss:0.0011319465702399611
The modified gen p mean: 0.44747617840766907, gen p mean: -0.0584283322095871, mean p set: 0.4479564428329468The modified gen p mean: 0.44723373651504517, gen p mean: -0.056824371218681335, mean p set: 0.44771403074264526
loss_pred:0.018153809010982513, decouple_loss:0.0011852155439555645
loss_pred:0.017785483971238136, decouple_loss:0.001234498922713101
Iteration: 348, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467546045780182, gen p mean: -0.06629994511604309, mean p set: 0.4472349286079407
loss_pred:0.018008528277277946, decouple_loss:0.0010825485223904252
The modified gen p mean: 0.4487350881099701, gen p mean: -0.06391109526157379, mean p set: 0.4492153227329254The modified gen p mean: 0.4478066861629486, gen p mean: -0.05942932516336441, mean p set: 0.4482869803905487
loss_pred:0.018122544512152672, decouple_loss:0.0011294339783489704
loss_pred:0.017635831609368324, decouple_loss:0.0011971984058618546
Iteration: 349, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44809791445732117, gen p mean: -0.060308072715997696, mean p set: 0.44857820868492126
loss_pred:0.01763019897043705, decouple_loss:0.001174194156192243
The modified gen p mean: 0.44651511311531067, gen p mean: -0.06286711990833282, mean p set: 0.4469953775405884
The modified gen p mean: 0.4476652443408966, gen p mean: -0.06350482255220413, mean p set: 0.4481455683708191
loss_pred:0.01835891231894493, decouple_loss:0.0011634883703663945
loss_pred:0.01820390857756138, decouple_loss:0.001108550000935793
Iteration: 350, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44618886709213257, gen p mean: -0.06570473313331604, mean p set: 0.4466691315174103
loss_pred:0.01783328503370285, decouple_loss:0.0012520549353212118
The modified gen p mean: 0.4488820433616638, gen p mean: -0.06195882335305214, mean p set: 0.4493623375892639The modified gen p mean: 0.4473145008087158, gen p mean: -0.05894271284341812, mean p set: 0.44779476523399353
loss_pred:0.01646132580935955, decouple_loss:0.0012673499295488
loss_pred:0.017289025709033012, decouple_loss:0.0011315759038552642
2023-05-01 06:53:34 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.0664365291595459, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.06215701997280121, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.062388982623815536, mean p set: 0.4500633478164673
loss_pred:0.018464256078004837, decouple_loss:0.0012084238696843386
loss_pred:0.017353860661387444, decouple_loss:0.001106477458961308
loss_pred:0.01751773990690708, decouple_loss:0.0011100751580670476
WV_0_PC_1_EH_0_PS_40, loss: 0.017835702747106552, avg_mse: 0.025588421151041985
current test mse: 0.025588
Iteration: 351, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470864534378052, gen p mean: -0.06305121630430222, mean p set: 0.44756677746772766
The modified gen p mean: 0.4465456008911133, gen p mean: -0.06454639881849289, mean p set: 0.447025865316391
The modified gen p mean: 0.44745978713035583, gen p mean: -0.06441880762577057, mean p set: 0.4479401111602783
loss_pred:0.018253125250339508, decouple_loss:0.001103167305700481
loss_pred:0.017732637003064156, decouple_loss:0.0010862122289836407
loss_pred:0.016676798462867737, decouple_loss:0.0010923423105850816
Iteration: 352, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44771137833595276, gen p mean: -0.06205945089459419, mean p set: 0.44819167256355286
loss_pred:0.017994342371821404, decouple_loss:0.0010999046498909593
The modified gen p mean: 0.4476057291030884, gen p mean: -0.06273455172777176, mean p set: 0.44808605313301086The modified gen p mean: 0.4483150541782379, gen p mean: -0.059708427637815475, mean p set: 0.448795348405838
loss_pred:0.0173589326441288, decouple_loss:0.0011270245304331183
loss_pred:0.01809384673833847, decouple_loss:0.00119938759598881
Iteration: 353, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44686082005500793, gen p mean: -0.06189245730638504, mean p set: 0.4473411440849304
loss_pred:0.017516857013106346, decouple_loss:0.0011831956217065454
The modified gen p mean: 0.4483351409435272, gen p mean: -0.061692774295806885, mean p set: 0.44881540536880493
The modified gen p mean: 0.44818711280822754, gen p mean: -0.06109291687607765, mean p set: 0.44866740703582764
loss_pred:0.017206687480211258, decouple_loss:0.0012411238858476281
loss_pred:0.017566001042723656, decouple_loss:0.0011040129465982318
Iteration: 354, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44814085960388184, gen p mean: -0.05818474292755127, mean p set: 0.44862115383148193
loss_pred:0.017731865867972374, decouple_loss:0.001067533390596509
The modified gen p mean: 0.4464946687221527, gen p mean: -0.058318257331848145, mean p set: 0.4469749927520752The modified gen p mean: 0.4469808340072632, gen p mean: -0.056002672761678696, mean p set: 0.4474611282348633
loss_pred:0.01821725070476532, decouple_loss:0.0011023133993148804
loss_pred:0.01694783754646778, decouple_loss:0.0010917108738794923
Iteration: 355, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475862383842468, gen p mean: -0.05453042685985565, mean p set: 0.4480665326118469
loss_pred:0.016822807490825653, decouple_loss:0.0010567180579528213
The modified gen p mean: 0.44829297065734863, gen p mean: -0.05426912009716034, mean p set: 0.44877323508262634The modified gen p mean: 0.44587668776512146, gen p mean: -0.05886505916714668, mean p set: 0.44635701179504395
loss_pred:0.017530282959342003, decouple_loss:0.0010991906747221947
loss_pred:0.0179113931953907, decouple_loss:0.0011278890306130052
Iteration: 356, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44838374853134155, gen p mean: -0.05215167999267578, mean p set: 0.44886404275894165
loss_pred:0.017833583056926727, decouple_loss:0.0010630293982103467
The modified gen p mean: 0.4475901424884796, gen p mean: -0.06128888204693794, mean p set: 0.4480704367160797The modified gen p mean: 0.44712480902671814, gen p mean: -0.05792400613427162, mean p set: 0.44760507345199585
loss_pred:0.016415616497397423, decouple_loss:0.0010612575570121408
loss_pred:0.017157066613435745, decouple_loss:0.0010972712188959122
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012013_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012013_3_24hr.npz
NaN value num: 0
Iteration: 357, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4463731050491333, gen p mean: -0.06208541989326477, mean p set: 0.446853369474411
loss_pred:0.01732761785387993, decouple_loss:0.0010856552980840206
The modified gen p mean: 0.4478020966053009, gen p mean: -0.06324168294668198, mean p set: 0.4482823610305786
The modified gen p mean: 0.44780200719833374, gen p mean: -0.05576632171869278, mean p set: 0.44828227162361145
loss_pred:0.018507294356822968, decouple_loss:0.0011254427954554558
loss_pred:0.017165610566735268, decouple_loss:0.0011208908399567008
Iteration: 358, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44698622822761536, gen p mean: -0.06235818564891815, mean p set: 0.44746658205986023
loss_pred:0.018201617524027824, decouple_loss:0.0011668684892356396
The modified gen p mean: 0.44741541147232056, gen p mean: -0.05716819316148758, mean p set: 0.44789573550224304The modified gen p mean: 0.4479556679725647, gen p mean: -0.05400900915265083, mean p set: 0.4484359920024872
loss_pred:0.017218969762325287, decouple_loss:0.001030304585583508
loss_pred:0.01722528412938118, decouple_loss:0.001099400338716805
Iteration: 359, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464642107486725, gen p mean: -0.05965672433376312, mean p set: 0.4469445049762726
The modified gen p mean: 0.4473837912082672, gen p mean: -0.05383868142962456, mean p set: 0.4478640854358673
loss_pred:0.016906026750802994, decouple_loss:0.0010486041428521276
loss_pred:0.018015801906585693, decouple_loss:0.0010807672515511513
The modified gen p mean: 0.4486715495586395, gen p mean: -0.05281064286828041, mean p set: 0.44915181398391724
loss_pred:0.018062906339764595, decouple_loss:0.0010316150728613138
Iteration: 360, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464389681816101, gen p mean: -0.047771867364645004, mean p set: 0.4469192922115326
loss_pred:0.01830318756401539, decouple_loss:0.0011263459455221891
The modified gen p mean: 0.4460814893245697, gen p mean: -0.0538344569504261, mean p set: 0.4465617835521698The modified gen p mean: 0.4470159113407135, gen p mean: -0.0523686408996582, mean p set: 0.4474962055683136
loss_pred:0.017574096098542213, decouple_loss:0.0010704983724281192
loss_pred:0.016996141523122787, decouple_loss:0.001047457568347454
2023-05-01 06:56:08 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.050548482686281204, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04623400792479515, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04651171341538429, mean p set: 0.4500633478164673
loss_pred:0.0183107852935791, decouple_loss:0.0012147141387686133
loss_pred:0.01738567091524601, decouple_loss:0.0011353512527421117loss_pred:0.017254803329706192, decouple_loss:0.0011023074621334672
WV_0_PC_1_EH_0_PS_40, loss: 0.017707960680127144, avg_mse: 0.025361988693475723
current test mse: 0.025362
Iteration: 361, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464631974697113, gen p mean: -0.045488178730010986, mean p set: 0.4469434916973114
The modified gen p mean: 0.446698933839798, gen p mean: -0.05008295923471451, mean p set: 0.44717922806739807
The modified gen p mean: 0.4469752311706543, gen p mean: -0.04565802961587906, mean p set: 0.4474555552005768
loss_pred:0.017214786261320114, decouple_loss:0.0010327784111723304
loss_pred:0.017544666305184364, decouple_loss:0.0010451253037899733
loss_pred:0.017633482813835144, decouple_loss:0.0010963761014863849
Iteration: 362, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479420483112335, gen p mean: -0.049892034381628036, mean p set: 0.44842231273651123
loss_pred:0.017599690705537796, decouple_loss:0.0009907064959406853
The modified gen p mean: 0.44679510593414307, gen p mean: -0.04913700371980667, mean p set: 0.44727540016174316The modified gen p mean: 0.4459565281867981, gen p mean: -0.04883553832769394, mean p set: 0.4464368224143982
loss_pred:0.017733242362737656, decouple_loss:0.0010793352266773582
loss_pred:0.01743573136627674, decouple_loss:0.0009616696042940021
Iteration: 363, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4456441104412079, gen p mean: -0.04578590765595436, mean p set: 0.4461243748664856
loss_pred:0.017304232344031334, decouple_loss:0.0011576819233596325
The modified gen p mean: 0.44656896591186523, gen p mean: -0.044300585985183716, mean p set: 0.44704926013946533The modified gen p mean: 0.44673311710357666, gen p mean: -0.050057392567396164, mean p set: 0.44721341133117676
loss_pred:0.017145277932286263, decouple_loss:0.0010636313818395138
loss_pred:0.018022121861577034, decouple_loss:0.00115184485912323
Iteration: 364, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44686761498451233, gen p mean: -0.05150448530912399, mean p set: 0.4473479390144348
loss_pred:0.01756531000137329, decouple_loss:0.0011300002224743366
The modified gen p mean: 0.44801342487335205, gen p mean: -0.04961566999554634, mean p set: 0.44849371910095215The modified gen p mean: 0.4470379650592804, gen p mean: -0.05330171436071396, mean p set: 0.4475182592868805
loss_pred:0.017393464222550392, decouple_loss:0.0010843169875442982
loss_pred:0.017234772443771362, decouple_loss:0.0011973247164860368
Iteration: 365, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44699329137802124, gen p mean: -0.05986253544688225, mean p set: 0.44747358560562134
loss_pred:0.017025360837578773, decouple_loss:0.0012225958053022623
The modified gen p mean: 0.44687533378601074, gen p mean: -0.0503975972533226, mean p set: 0.44735562801361084The modified gen p mean: 0.4460988938808441, gen p mean: -0.048334378749132156, mean p set: 0.4465792179107666
loss_pred:0.01719469018280506, decouple_loss:0.0011468629818409681
loss_pred:0.017286518588662148, decouple_loss:0.001205123495310545
Iteration: 366, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44815316796302795, gen p mean: -0.05703603848814964, mean p set: 0.44863349199295044
loss_pred:0.01728169247508049, decouple_loss:0.001046287827193737
The modified gen p mean: 0.4471037983894348, gen p mean: -0.05330894514918327, mean p set: 0.4475840926170349The modified gen p mean: 0.4478500783443451, gen p mean: -0.052004244178533554, mean p set: 0.4483303725719452
loss_pred:0.017419597133994102, decouple_loss:0.0010361755266785622
loss_pred:0.016804194077849388, decouple_loss:0.0011513980571180582
Iteration: 367, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44664090871810913, gen p mean: -0.052891723811626434, mean p set: 0.44712120294570923
loss_pred:0.017811745405197144, decouple_loss:0.0010455325245857239
The modified gen p mean: 0.4478701055049896, gen p mean: -0.05312541127204895, mean p set: 0.4483503997325897The modified gen p mean: 0.44695407152175903, gen p mean: -0.04759815335273743, mean p set: 0.44743436574935913
loss_pred:0.01694726012647152, decouple_loss:0.0011218063300475478
loss_pred:0.016835974529385567, decouple_loss:0.0011816794285550714
Iteration: 368, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44770678877830505, gen p mean: -0.047640085220336914, mean p set: 0.44818708300590515
loss_pred:0.017072219401597977, decouple_loss:0.0010841300245374441
The modified gen p mean: 0.4472595155239105, gen p mean: -0.04840531200170517, mean p set: 0.4477398097515106The modified gen p mean: 0.4477015435695648, gen p mean: -0.04895275458693504, mean p set: 0.4481818377971649
loss_pred:0.018040550872683525, decouple_loss:0.0010161998216062784
loss_pred:0.016976455226540565, decouple_loss:0.001071266713552177
Iteration: 369, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473097324371338, gen p mean: -0.04360572621226311, mean p set: 0.4477900266647339
loss_pred:0.017570436000823975, decouple_loss:0.001021598931401968
The modified gen p mean: 0.4473395347595215, gen p mean: -0.04406825825572014, mean p set: 0.4478198289871216The modified gen p mean: 0.4480953514575958, gen p mean: -0.04459427297115326, mean p set: 0.44857561588287354
loss_pred:0.016738614067435265, decouple_loss:0.0009753081831149757
loss_pred:0.01747591234743595, decouple_loss:0.0010220111580565572
Iteration: 370, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44791150093078613, gen p mean: -0.04544678330421448, mean p set: 0.44839179515838623
loss_pred:0.01707541011273861, decouple_loss:0.0009589865221641958
The modified gen p mean: 0.4461131691932678, gen p mean: -0.04527502879500389, mean p set: 0.4465934634208679The modified gen p mean: 0.44674113392829895, gen p mean: -0.04348321631550789, mean p set: 0.44722142815589905
loss_pred:0.018095852807164192, decouple_loss:0.0013531091390177608
loss_pred:0.01655702106654644, decouple_loss:0.001307313796132803
2023-05-01 06:58:02 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.04526771232485771, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04112715646624565, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04146164655685425, mean p set: 0.4500633478164673
loss_pred:0.017230277881026268, decouple_loss:0.00124171853531152
loss_pred:0.018265508115291595, decouple_loss:0.0011086685117334127
loss_pred:0.01735760271549225, decouple_loss:0.0010839460883289576
WV_0_PC_1_EH_0_PS_40, loss: 0.017675034701824188, avg_mse: 0.025313595309853554
current test mse: 0.025314
At step 370, Best test: 0.025314
save model to /work/09012/haoli1/ls6/ERA5_PredRNN/checkpoints/WV_0_PC_1_EH_0_PS_40/model_test_schedule_sampling_DynaMean.ckpt
Iteration: 371, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44760680198669434, gen p mean: -0.045524753630161285, mean p set: 0.4480871260166168
loss_pred:0.017061324790120125, decouple_loss:0.0011332094436511397
The modified gen p mean: 0.4469386339187622, gen p mean: -0.03951822221279144, mean p set: 0.4474189281463623The modified gen p mean: 0.44737508893013, gen p mean: -0.049818068742752075, mean p set: 0.4478553533554077
loss_pred:0.017302434891462326, decouple_loss:0.001194915035739541
loss_pred:0.017634494230151176, decouple_loss:0.0011306204833090305
Iteration: 372, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44826653599739075, gen p mean: -0.04552161693572998, mean p set: 0.44874683022499084
loss_pred:0.017255956307053566, decouple_loss:0.0010087991831824183
The modified gen p mean: 0.4476120173931122, gen p mean: -0.04649928957223892, mean p set: 0.4480923116207123The modified gen p mean: 0.4484342038631439, gen p mean: -0.04299956187605858, mean p set: 0.448914498090744
loss_pred:0.017011484131217003, decouple_loss:0.00114374456461519
loss_pred:0.01721203699707985, decouple_loss:0.001089456956833601
Iteration: 373, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4462970495223999, gen p mean: -0.03797771781682968, mean p set: 0.44677734375
loss_pred:0.017463630065321922, decouple_loss:0.0013220636174082756
The modified gen p mean: 0.4477238655090332, gen p mean: -0.042816150933504105, mean p set: 0.4482041299343109The modified gen p mean: 0.4472610652446747, gen p mean: -0.037509314715862274, mean p set: 0.44774138927459717
loss_pred:0.016981091350317, decouple_loss:0.0012104493798688054
loss_pred:0.017743434756994247, decouple_loss:0.0013310560025274754
Iteration: 374, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.445488303899765, gen p mean: -0.0435018464922905, mean p set: 0.4459685981273651
loss_pred:0.01709788851439953, decouple_loss:0.0010226384038105607
The modified gen p mean: 0.4471263587474823, gen p mean: -0.0418863520026207, mean p set: 0.4476066827774048The modified gen p mean: 0.4464874863624573, gen p mean: -0.036954522132873535, mean p set: 0.4469677805900574
loss_pred:0.016630107536911964, decouple_loss:0.001065363292582333
loss_pred:0.017809022217988968, decouple_loss:0.0010413607815280557
Iteration: 375, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44642043113708496, gen p mean: -0.04316093400120735, mean p set: 0.44690072536468506
loss_pred:0.017055679112672806, decouple_loss:0.0012260538060218096
The modified gen p mean: 0.4461912512779236, gen p mean: -0.04393986240029335, mean p set: 0.4466714859008789The modified gen p mean: 0.44781431555747986, gen p mean: -0.043553609400987625, mean p set: 0.44829463958740234
loss_pred:0.017063340172171593, decouple_loss:0.0012133617419749498
loss_pred:0.017503058537840843, decouple_loss:0.0012430176138877869
Iteration: 376, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44800689816474915, gen p mean: -0.042605917900800705, mean p set: 0.44848719239234924
loss_pred:0.016936492174863815, decouple_loss:0.001067771459929645
The modified gen p mean: 0.44728413224220276, gen p mean: -0.04622375965118408, mean p set: 0.44776445627212524The modified gen p mean: 0.4456179440021515, gen p mean: -0.04294087365269661, mean p set: 0.446098268032074
loss_pred:0.01782604493200779, decouple_loss:0.0010832820553332567
loss_pred:0.017413899302482605, decouple_loss:0.0012009842321276665
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012017_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012017_3_24hr.npz
NaN value num: 0
Iteration: 377, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482339322566986, gen p mean: -0.04520346596837044, mean p set: 0.4487142562866211
loss_pred:0.017937297001481056, decouple_loss:0.001041423762217164
The modified gen p mean: 0.44807130098342896, gen p mean: -0.04943186417222023, mean p set: 0.44855156540870667The modified gen p mean: 0.44793984293937683, gen p mean: -0.04882786422967911, mean p set: 0.44842007756233215
loss_pred:0.017464961856603622, decouple_loss:0.0010969247668981552
loss_pred:0.017159078270196915, decouple_loss:0.0011436629574745893
Iteration: 378, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447792649269104, gen p mean: -0.046810537576675415, mean p set: 0.4482729434967041
loss_pred:0.017335237935185432, decouple_loss:0.0012060783337801695
The modified gen p mean: 0.4473387598991394, gen p mean: -0.0450085774064064, mean p set: 0.4478190541267395The modified gen p mean: 0.44815874099731445, gen p mean: -0.05179070308804512, mean p set: 0.44863903522491455
loss_pred:0.01755843125283718, decouple_loss:0.0011380614014342427
loss_pred:0.017797071486711502, decouple_loss:0.0011630032677203417
Iteration: 379, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479679763317108, gen p mean: -0.05112811177968979, mean p set: 0.4484483003616333
The modified gen p mean: 0.4485129415988922, gen p mean: -0.05172815918922424, mean p set: 0.4489932656288147loss_pred:0.017460046336054802, decouple_loss:0.0010171267203986645
The modified gen p mean: 0.44846266508102417, gen p mean: -0.048494383692741394, mean p set: 0.44894295930862427
loss_pred:0.016963422298431396, decouple_loss:0.0010557763744145632
loss_pred:0.016909794881939888, decouple_loss:0.0010751731460914016
Iteration: 380, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44800907373428345, gen p mean: -0.04814692214131355, mean p set: 0.44848933815956116
loss_pred:0.017214307561516762, decouple_loss:0.000969834509305656
The modified gen p mean: 0.44886964559555054, gen p mean: -0.0524207204580307, mean p set: 0.449349969625473The modified gen p mean: 0.44846925139427185, gen p mean: -0.04994923993945122, mean p set: 0.44894954562187195
loss_pred:0.0169463399797678, decouple_loss:0.0011198008432984352
loss_pred:0.017292410135269165, decouple_loss:0.0010224854340776801
2023-05-01 07:00:45 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.050534285604953766, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.046214740723371506, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.0467318557202816, mean p set: 0.4500633478164673
loss_pred:0.018288686871528625, decouple_loss:0.0013279457343742251
loss_pred:0.017200980335474014, decouple_loss:0.0012557816226035357
loss_pred:0.01734098233282566, decouple_loss:0.0013229533797129989
WV_0_PC_1_EH_0_PS_40, loss: 0.017675328999757767, avg_mse: 0.02531285211443901
current test mse: 0.025313
At step 380, Best test: 0.025313
save model to /work/09012/haoli1/ls6/ERA5_PredRNN/checkpoints/WV_0_PC_1_EH_0_PS_40/model_test_schedule_sampling_DynaMean.ckpt
Iteration: 381, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44839388132095337, gen p mean: -0.04968263581395149, mean p set: 0.44887417554855347
loss_pred:0.01696249656379223, decouple_loss:0.001087683835066855
The modified gen p mean: 0.4483512341976166, gen p mean: -0.05076032504439354, mean p set: 0.44883155822753906The modified gen p mean: 0.44744303822517395, gen p mean: -0.04516306519508362, mean p set: 0.44792336225509644
loss_pred:0.017716268077492714, decouple_loss:0.0011776859173551202
loss_pred:0.017276581376791, decouple_loss:0.0012085142079740763
Iteration: 382, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475019574165344, gen p mean: -0.044998396188020706, mean p set: 0.4479822516441345
The modified gen p mean: 0.44737720489501953, gen p mean: -0.05244273319840431, mean p set: 0.44785749912261963
loss_pred:0.01763857528567314, decouple_loss:0.0011412356980144978
loss_pred:0.01779928058385849, decouple_loss:0.0010334437247365713
The modified gen p mean: 0.4475162625312805, gen p mean: -0.05122599005699158, mean p set: 0.447996586561203
loss_pred:0.017680583521723747, decouple_loss:0.001020013471134007
Iteration: 383, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44767841696739197, gen p mean: -0.05195504426956177, mean p set: 0.44815871119499207
The modified gen p mean: 0.4472517967224121, gen p mean: -0.04587036743760109, mean p set: 0.4477321207523346
loss_pred:0.017436575144529343, decouple_loss:0.001112994272261858
loss_pred:0.01799526810646057, decouple_loss:0.0011798955965787172
The modified gen p mean: 0.44793784618377686, gen p mean: -0.04921333119273186, mean p set: 0.44841820001602173
loss_pred:0.016769947484135628, decouple_loss:0.0014112067874521017
Iteration: 384, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447767436504364, gen p mean: -0.045718446373939514, mean p set: 0.4482477605342865
The modified gen p mean: 0.4476771950721741, gen p mean: -0.047283414751291275, mean p set: 0.44815748929977417
loss_pred:0.01731131598353386, decouple_loss:0.001174916629679501
loss_pred:0.017851047217845917, decouple_loss:0.0010716693941503763
The modified gen p mean: 0.44805869460105896, gen p mean: -0.04817327857017517, mean p set: 0.44853898882865906
loss_pred:0.017586231231689453, decouple_loss:0.0013331127120181918
Iteration: 385, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44797033071517944, gen p mean: -0.045868705958127975, mean p set: 0.44845062494277954
loss_pred:0.017234601080417633, decouple_loss:0.001140034757554531
The modified gen p mean: 0.4478349983692169, gen p mean: -0.04583346098661423, mean p set: 0.4483153223991394The modified gen p mean: 0.44846218824386597, gen p mean: -0.04478181526064873, mean p set: 0.44894248247146606
loss_pred:0.01724082976579666, decouple_loss:0.001230185036547482
loss_pred:0.017820842564105988, decouple_loss:0.0011059073731303215
Iteration: 386, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474272131919861, gen p mean: -0.04128691926598549, mean p set: 0.4479075074195862
loss_pred:0.017775675281882286, decouple_loss:0.001097336527891457
The modified gen p mean: 0.4477475881576538, gen p mean: -0.047638069838285446, mean p set: 0.4482278525829315The modified gen p mean: 0.44819241762161255, gen p mean: -0.039969537407159805, mean p set: 0.44867268204689026
loss_pred:0.01730307750403881, decouple_loss:0.0011863434920087457
loss_pred:0.017521550878882408, decouple_loss:0.0013193018967285752
Iteration: 387, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476719796657562, gen p mean: -0.04886338859796524, mean p set: 0.4481523036956787
loss_pred:0.01724938303232193, decouple_loss:0.0010579356458038092
The modified gen p mean: 0.4477936327457428, gen p mean: -0.042175985872745514, mean p set: 0.4482739567756653The modified gen p mean: 0.44886672496795654, gen p mean: -0.04857486113905907, mean p set: 0.4493470788002014
loss_pred:0.017378682270646095, decouple_loss:0.000992129324004054
loss_pred:0.017097271978855133, decouple_loss:0.0010964253451675177
Iteration: 388, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478950798511505, gen p mean: -0.0469711571931839, mean p set: 0.4483753740787506
loss_pred:0.01624196209013462, decouple_loss:0.0011339213233441114
The modified gen p mean: 0.44849759340286255, gen p mean: -0.043534427881240845, mean p set: 0.44897785782814026The modified gen p mean: 0.44846972823143005, gen p mean: -0.045220643281936646, mean p set: 0.44895002245903015
loss_pred:0.01752268709242344, decouple_loss:0.001000136137008667
loss_pred:0.017361946403980255, decouple_loss:0.0010187964653596282
Iteration: 389, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44755542278289795, gen p mean: -0.045848067849874496, mean p set: 0.44803571701049805
loss_pred:0.016793856397271156, decouple_loss:0.0011045618448406458
The modified gen p mean: 0.44850581884384155, gen p mean: -0.04106331244111061, mean p set: 0.44898611307144165The modified gen p mean: 0.4475322663784027, gen p mean: -0.04025945067405701, mean p set: 0.4480125904083252
loss_pred:0.0174249317497015, decouple_loss:0.0010974156903102994
loss_pred:0.01775728352367878, decouple_loss:0.0010514874011278152
Iteration: 390, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44901150465011597, gen p mean: -0.04821968823671341, mean p set: 0.44949179887771606
loss_pred:0.017584774643182755, decouple_loss:0.0011539568658918142
The modified gen p mean: 0.44838833808898926, gen p mean: -0.03773722052574158, mean p set: 0.44886863231658936The modified gen p mean: 0.44729772210121155, gen p mean: -0.04339750111103058, mean p set: 0.44777801632881165
loss_pred:0.01729349046945572, decouple_loss:0.0009847464971244335
loss_pred:0.017011122778058052, decouple_loss:0.0012308016885071993
2023-05-01 07:02:43 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.04740821570158005, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04298114776611328, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04350940138101578, mean p set: 0.4500633478164673
loss_pred:0.01827992871403694, decouple_loss:0.0010326127521693707
loss_pred:0.01723477989435196, decouple_loss:0.0010059631895273924
loss_pred:0.017335791140794754, decouple_loss:0.0009463332244195044
WV_0_PC_1_EH_0_PS_40, loss: 0.017666582018136978, avg_mse: 0.02531920187175274
current test mse: 0.025319
Iteration: 391, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474294185638428, gen p mean: -0.04085958003997803, mean p set: 0.4479096829891205
The modified gen p mean: 0.44701382517814636, gen p mean: -0.04300856962800026, mean p set: 0.4474940896034241
The modified gen p mean: 0.44765704870224, gen p mean: -0.04750814288854599, mean p set: 0.4481373429298401
loss_pred:0.016433462500572205, decouple_loss:0.001004840712994337
loss_pred:0.017895909026265144, decouple_loss:0.0009332923800684512
loss_pred:0.017616502940654755, decouple_loss:0.0012042515445500612
Iteration: 392, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472630023956299, gen p mean: -0.043072741478681564, mean p set: 0.44774329662323
The modified gen p mean: 0.4483686089515686, gen p mean: -0.04577559977769852, mean p set: 0.4488488733768463
loss_pred:0.017175335437059402, decouple_loss:0.0010417279554530978
loss_pred:0.017512064427137375, decouple_loss:0.001158660277724266
The modified gen p mean: 0.4482515752315521, gen p mean: -0.04488223418593407, mean p set: 0.4487318992614746
loss_pred:0.017652174457907677, decouple_loss:0.0010644462890923023
Iteration: 393, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44823214411735535, gen p mean: -0.046087104827165604, mean p set: 0.44871240854263306
loss_pred:0.017471514642238617, decouple_loss:0.0010113519383594394
The modified gen p mean: 0.44795742630958557, gen p mean: -0.04578236863017082, mean p set: 0.44843775033950806The modified gen p mean: 0.4476569592952728, gen p mean: -0.04521654546260834, mean p set: 0.4481372833251953
loss_pred:0.01740182936191559, decouple_loss:0.0010605184361338615
loss_pred:0.017990708351135254, decouple_loss:0.0009899743599817157
Iteration: 394, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486573338508606, gen p mean: -0.04414818063378334, mean p set: 0.4491376578807831
loss_pred:0.01792137697339058, decouple_loss:0.0010459608165547252
The modified gen p mean: 0.44891196489334106, gen p mean: -0.05011114850640297, mean p set: 0.4493922293186188The modified gen p mean: 0.44760873913764954, gen p mean: -0.049875106662511826, mean p set: 0.44808903336524963
loss_pred:0.01724245212972164, decouple_loss:0.0010027977405115962
loss_pred:0.017216742038726807, decouple_loss:0.0009978034067898989
Iteration: 395, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480228126049042, gen p mean: -0.04355635493993759, mean p set: 0.4485030770301819
loss_pred:0.016928421333432198, decouple_loss:0.0011545317247509956
The modified gen p mean: 0.4489613473415375, gen p mean: -0.044392626732587814, mean p set: 0.4494416415691376The modified gen p mean: 0.4473279118537903, gen p mean: -0.04673703387379646, mean p set: 0.4478082060813904
loss_pred:0.017618419602513313, decouple_loss:0.0009741700487211347
loss_pred:0.017555322498083115, decouple_loss:0.0009715743944980204
Iteration: 396, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44836103916168213, gen p mean: -0.046067748218774796, mean p set: 0.4488413631916046
The modified gen p mean: 0.44756460189819336, gen p mean: -0.04251033440232277, mean p set: 0.44804492592811584
loss_pred:0.017516516149044037, decouple_loss:0.0010417788289487362
loss_pred:0.017309626564383507, decouple_loss:0.0010149418376386166
The modified gen p mean: 0.4469981789588928, gen p mean: -0.04819905012845993, mean p set: 0.4474784731864929
loss_pred:0.017409319058060646, decouple_loss:0.0010029609547927976
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012007_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012007_3_24hr.npz
NaN value num: 0
Iteration: 397, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483235776424408, gen p mean: -0.04716726019978523, mean p set: 0.4488038718700409
loss_pred:0.014221339486539364, decouple_loss:0.0010690924245864153
The modified gen p mean: 0.4477311670780182, gen p mean: -0.04980676248669624, mean p set: 0.4482114315032959The modified gen p mean: 0.44715479016304016, gen p mean: -0.04424499720335007, mean p set: 0.44763508439064026
loss_pred:0.014273002743721008, decouple_loss:0.0010213355999439955
loss_pred:0.01455574482679367, decouple_loss:0.001059570349752903
Iteration: 398, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44808006286621094, gen p mean: -0.04680848866701126, mean p set: 0.44856035709381104
loss_pred:0.014549714513123035, decouple_loss:0.0011252837721258402
The modified gen p mean: 0.4483779966831207, gen p mean: -0.045899566262960434, mean p set: 0.4488582909107208The modified gen p mean: 0.4479582905769348, gen p mean: -0.04520527273416519, mean p set: 0.4484385848045349
loss_pred:0.014327958226203918, decouple_loss:0.0010914676822721958
loss_pred:0.01472504623234272, decouple_loss:0.0010441300692036748
Iteration: 399, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44762122631073, gen p mean: -0.04947102814912796, mean p set: 0.4481014907360077
loss_pred:0.014600787311792374, decouple_loss:0.001241276622749865
The modified gen p mean: 0.4486527442932129, gen p mean: -0.052420392632484436, mean p set: 0.449133038520813The modified gen p mean: 0.44872990250587463, gen p mean: -0.04995434358716011, mean p set: 0.44921019673347473
loss_pred:0.014453898184001446, decouple_loss:0.0011327522806823254
loss_pred:0.014446261338889599, decouple_loss:0.0011998495319858193
Iteration: 400, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485163986682892, gen p mean: -0.047315508127212524, mean p set: 0.4489966928958893
loss_pred:0.014875958673655987, decouple_loss:0.0011765924282371998
The modified gen p mean: 0.4480270743370056, gen p mean: -0.05029767379164696, mean p set: 0.4485073983669281The modified gen p mean: 0.4473142623901367, gen p mean: -0.04431960731744766, mean p set: 0.4477945566177368
loss_pred:0.014017666690051556, decouple_loss:0.0012132193660363555
loss_pred:0.01462949812412262, decouple_loss:0.0011544267181307077
2023-05-01 07:05:20 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.04849375784397125, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.044439274817705154, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.045001231133937836, mean p set: 0.4500633478164673
loss_pred:0.01853887178003788, decouple_loss:0.0014600681606680155
loss_pred:0.017595624551177025, decouple_loss:0.0013428336242213845loss_pred:0.017511026933789253, decouple_loss:0.0013232625788077712
WV_0_PC_1_EH_0_PS_40, loss: 0.01795060932636261, avg_mse: 0.025786984711885452
current test mse: 0.025787
Iteration: 401, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44736239314079285, gen p mean: -0.049205128103494644, mean p set: 0.44784268736839294
The modified gen p mean: 0.44764864444732666, gen p mean: -0.04628895968198776, mean p set: 0.44812890887260437
The modified gen p mean: 0.447090744972229, gen p mean: -0.04942053183913231, mean p set: 0.4475710391998291
loss_pred:0.013749474659562111, decouple_loss:0.0012640377972275019
loss_pred:0.014721913263201714, decouple_loss:0.0012725904816761613
loss_pred:0.014450231567025185, decouple_loss:0.001482135383412242
Iteration: 402, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475186765193939, gen p mean: -0.04358025640249252, mean p set: 0.4479990005493164
The modified gen p mean: 0.44768163561820984, gen p mean: -0.04099295660853386, mean p set: 0.44816192984580994
loss_pred:0.013494622893631458, decouple_loss:0.0012084938352927566
loss_pred:0.01383745577186346, decouple_loss:0.001237441785633564
The modified gen p mean: 0.4484992027282715, gen p mean: -0.045323118567466736, mean p set: 0.4489794969558716
loss_pred:0.013960177078843117, decouple_loss:0.0011680045863613486
Iteration: 403, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493151009082794, gen p mean: -0.03431098535656929, mean p set: 0.4497953951358795
The modified gen p mean: 0.4481548070907593, gen p mean: -0.042043525725603104, mean p set: 0.4486351013183594
loss_pred:0.01421727892011404, decouple_loss:0.0013742076698690653
loss_pred:0.013405944220721722, decouple_loss:0.0015005642781034112
The modified gen p mean: 0.44750353693962097, gen p mean: -0.04151434451341629, mean p set: 0.44798383116722107
loss_pred:0.014603757299482822, decouple_loss:0.0015224878443405032
Iteration: 404, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446613073348999, gen p mean: -0.03862409666180611, mean p set: 0.4470933675765991
loss_pred:0.013628579676151276, decouple_loss:0.0012974467827007174
The modified gen p mean: 0.4474695920944214, gen p mean: -0.03798679634928703, mean p set: 0.4479498863220215The modified gen p mean: 0.4483889937400818, gen p mean: -0.045125436037778854, mean p set: 0.4488692879676819
loss_pred:0.014000101014971733, decouple_loss:0.001327107078395784
loss_pred:0.013519293628633022, decouple_loss:0.0012357169762253761
Iteration: 405, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448378324508667, gen p mean: -0.03269604220986366, mean p set: 0.4488586187362671
loss_pred:0.013711409643292427, decouple_loss:0.001436451799236238
The modified gen p mean: 0.44906172156333923, gen p mean: -0.029523614794015884, mean p set: 0.4495420455932617The modified gen p mean: 0.44846057891845703, gen p mean: -0.037898652255535126, mean p set: 0.44894084334373474
loss_pred:0.013508855365216732, decouple_loss:0.0014186433982104063
loss_pred:0.01350444182753563, decouple_loss:0.0014545866288244724
Iteration: 406, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484996497631073, gen p mean: -0.04094785824418068, mean p set: 0.4489799737930298
The modified gen p mean: 0.44755682349205017, gen p mean: -0.03067523054778576, mean p set: 0.44803711771965027
loss_pred:0.013561377301812172, decouple_loss:0.001462090527638793
loss_pred:0.014061534777283669, decouple_loss:0.0013800322776660323
The modified gen p mean: 0.44938555359840393, gen p mean: -0.025699300691485405, mean p set: 0.4498658776283264
loss_pred:0.013966318219900131, decouple_loss:0.001483805594034493
Iteration: 407, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479518532752991, gen p mean: -0.037822429090738297, mean p set: 0.44843214750289917The modified gen p mean: 0.4487769305706024, gen p mean: -0.03243591636419296, mean p set: 0.4492571949958801
loss_pred:0.01325682271271944, decouple_loss:0.0014590859645977616
loss_pred:0.013457713648676872, decouple_loss:0.0014173494419083
The modified gen p mean: 0.4477725923061371, gen p mean: -0.0326349213719368, mean p set: 0.4482528567314148
loss_pred:0.013268377631902695, decouple_loss:0.00133025785908103
Iteration: 408, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44822418689727783, gen p mean: -0.037320010364055634, mean p set: 0.4487045109272003
loss_pred:0.013516778126358986, decouple_loss:0.001440450083464384
The modified gen p mean: 0.44745561480522156, gen p mean: -0.031029123812913895, mean p set: 0.44793590903282166The modified gen p mean: 0.446932315826416, gen p mean: -0.03548969328403473, mean p set: 0.4474125802516937
loss_pred:0.013532404787838459, decouple_loss:0.001585384481586516
loss_pred:0.013213874772191048, decouple_loss:0.0014529773034155369
Iteration: 409, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44817668199539185, gen p mean: -0.0388525165617466, mean p set: 0.44865697622299194
loss_pred:0.013609952293336391, decouple_loss:0.0014171155635267496
The modified gen p mean: 0.44812268018722534, gen p mean: -0.040260232985019684, mean p set: 0.44860297441482544The modified gen p mean: 0.44796133041381836, gen p mean: -0.03903157263994217, mean p set: 0.44844159483909607
loss_pred:0.013203894719481468, decouple_loss:0.001502509112469852
loss_pred:0.013049108907580376, decouple_loss:0.0014436938799917698
Iteration: 410, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44736185669898987, gen p mean: -0.03793392702937126, mean p set: 0.44784215092658997
loss_pred:0.01328557264059782, decouple_loss:0.0014161380240693688
The modified gen p mean: 0.4481067955493927, gen p mean: -0.041611652821302414, mean p set: 0.4485870599746704The modified gen p mean: 0.4481460750102997, gen p mean: -0.039629627019166946, mean p set: 0.4486263692378998
loss_pred:0.012902683578431606, decouple_loss:0.00131704262457788
loss_pred:0.013689856044948101, decouple_loss:0.0013790706871077418
2023-05-01 07:07:12 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.044692475348711014, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.040389180183410645, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.040768660604953766, mean p set: 0.4500633478164673
loss_pred:0.01929640583693981, decouple_loss:0.0014467780711129308
loss_pred:0.01817999966442585, decouple_loss:0.00153718376532197
loss_pred:0.0183302853256464, decouple_loss:0.0015309517038986087
WV_0_PC_1_EH_0_PS_40, loss: 0.018677478656172752, avg_mse: 0.027218641713261604
current test mse: 0.027219
Iteration: 411, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484296441078186, gen p mean: -0.04498088359832764, mean p set: 0.4489099383354187
The modified gen p mean: 0.4485977590084076, gen p mean: -0.03915828838944435, mean p set: 0.4490780532360077
The modified gen p mean: 0.44834771752357483, gen p mean: -0.045598991215229034, mean p set: 0.4488280117511749
loss_pred:0.013401180505752563, decouple_loss:0.001405532588250935
loss_pred:0.012875823304057121, decouple_loss:0.0013948078267276287
loss_pred:0.013622855767607689, decouple_loss:0.0014763748040422797
Iteration: 412, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472711682319641, gen p mean: -0.036528412252664566, mean p set: 0.4477514326572418
The modified gen p mean: 0.44729694724082947, gen p mean: -0.04124978184700012, mean p set: 0.44777724146842957
loss_pred:0.01367830578237772, decouple_loss:0.0013174262130632997
loss_pred:0.013873632065951824, decouple_loss:0.0013055786257609725
The modified gen p mean: 0.4471145272254944, gen p mean: -0.039796870201826096, mean p set: 0.44759488105773926
loss_pred:0.013760581612586975, decouple_loss:0.0013622913975268602
Iteration: 413, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44723644852638245, gen p mean: -0.03832269087433815, mean p set: 0.44771671295166016
The modified gen p mean: 0.4480278193950653, gen p mean: -0.04061155393719673, mean p set: 0.4485081434249878
loss_pred:0.013824465684592724, decouple_loss:0.0013392081018537283
loss_pred:0.013703221455216408, decouple_loss:0.0013310422655194998
The modified gen p mean: 0.44777804613113403, gen p mean: -0.03869156911969185, mean p set: 0.44825834035873413
loss_pred:0.013436094857752323, decouple_loss:0.00139842729549855
Iteration: 414, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44857344031333923, gen p mean: -0.03877630457282066, mean p set: 0.44905373454093933
The modified gen p mean: 0.44730043411254883, gen p mean: -0.038283832371234894, mean p set: 0.4477807283401489
loss_pred:0.01353924348950386, decouple_loss:0.0013337451964616776
loss_pred:0.013583575375378132, decouple_loss:0.0013558787759393454
The modified gen p mean: 0.4474526047706604, gen p mean: -0.037973105907440186, mean p set: 0.4479329288005829
loss_pred:0.01296155620366335, decouple_loss:0.0013098272029310465
Iteration: 415, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490264058113098, gen p mean: -0.030759485438466072, mean p set: 0.4495067000389099
loss_pred:0.012905888259410858, decouple_loss:0.0011933880159631371
The modified gen p mean: 0.44728949666023254, gen p mean: -0.03675774484872818, mean p set: 0.44776979088783264The modified gen p mean: 0.4483753740787506, gen p mean: -0.03613677993416786, mean p set: 0.4488556683063507
loss_pred:0.01295017171651125, decouple_loss:0.0013004997745156288
loss_pred:0.013371494598686695, decouple_loss:0.0012592988787218928
Iteration: 416, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481242001056671, gen p mean: -0.03592918813228607, mean p set: 0.4486044645309448
loss_pred:0.012881523929536343, decouple_loss:0.0012203819351270795
The modified gen p mean: 0.44763848185539246, gen p mean: -0.037826698273420334, mean p set: 0.44811877608299255The modified gen p mean: 0.44725486636161804, gen p mean: -0.03759682923555374, mean p set: 0.44773516058921814
loss_pred:0.013670774176716805, decouple_loss:0.0015105045167729259
loss_pred:0.013055521994829178, decouple_loss:0.0011703759664669633
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012017_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012017_3_24hr.npz
NaN value num: 0
Iteration: 417, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498410224914551, gen p mean: -0.03034062311053276, mean p set: 0.4503213167190552
loss_pred:0.01738635264337063, decouple_loss:0.0013648702297359705
The modified gen p mean: 0.45030316710472107, gen p mean: -0.02840334177017212, mean p set: 0.4507834315299988The modified gen p mean: 0.450868159532547, gen p mean: -0.031258948147296906, mean p set: 0.4513484537601471
loss_pred:0.017858099192380905, decouple_loss:0.001271923421882093
loss_pred:0.01743263006210327, decouple_loss:0.0012724995613098145
Iteration: 418, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514210820198059, gen p mean: -0.032065439969301224, mean p set: 0.4519013464450836
The modified gen p mean: 0.4487508237361908, gen p mean: -0.03446175530552864, mean p set: 0.4492310881614685
loss_pred:0.01795388013124466, decouple_loss:0.0013150746235623956
loss_pred:0.018079038709402084, decouple_loss:0.0013607424916699529
The modified gen p mean: 0.4501321017742157, gen p mean: -0.03532631695270538, mean p set: 0.4506123960018158
loss_pred:0.017575809732079506, decouple_loss:0.0015055171679705381
Iteration: 419, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45147889852523804, gen p mean: -0.027910713106393814, mean p set: 0.45195919275283813
The modified gen p mean: 0.4521124064922333, gen p mean: -0.030374594032764435, mean p set: 0.4525927007198334
loss_pred:0.01825573295354843, decouple_loss:0.0013368581421673298
loss_pred:0.017359476536512375, decouple_loss:0.0013886495726183057
The modified gen p mean: 0.4520312249660492, gen p mean: -0.02725944295525551, mean p set: 0.4525114893913269
loss_pred:0.01788443885743618, decouple_loss:0.001389572280459106
Iteration: 420, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4516439437866211, gen p mean: -0.02307041361927986, mean p set: 0.4521242678165436
The modified gen p mean: 0.45226559042930603, gen p mean: -0.020568963140249252, mean p set: 0.45274588465690613
loss_pred:0.018631640821695328, decouple_loss:0.0013426485238596797
loss_pred:0.01701229438185692, decouple_loss:0.0014195145340636373
The modified gen p mean: 0.45227017998695374, gen p mean: -0.023360271006822586, mean p set: 0.45275044441223145
loss_pred:0.017656590789556503, decouple_loss:0.0013695203233510256
2023-05-01 07:09:49 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.034506455063819885, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.030563848093152046, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.03065331093966961, mean p set: 0.4500633478164673
loss_pred:0.018633894622325897, decouple_loss:0.001456330413930118
loss_pred:0.017532747238874435, decouple_loss:0.0014644674956798553loss_pred:0.017724348232150078, decouple_loss:0.0015071649104356766
WV_0_PC_1_EH_0_PS_40, loss: 0.01803746446967125, avg_mse: 0.02590743452310562
current test mse: 0.025907
Iteration: 421, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489928185939789, gen p mean: -0.02892620489001274, mean p set: 0.4494730830192566
The modified gen p mean: 0.451761931180954, gen p mean: -0.025196246802806854, mean p set: 0.4522422254085541
The modified gen p mean: 0.4491058588027954, gen p mean: -0.030132073909044266, mean p set: 0.4495861530303955
loss_pred:0.0183129720389843, decouple_loss:0.0015524179907515645
loss_pred:0.018037281930446625, decouple_loss:0.0015271884622052312
loss_pred:0.017531389370560646, decouple_loss:0.0014777304604649544
Iteration: 422, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44881126284599304, gen p mean: -0.02979670651257038, mean p set: 0.44929152727127075
The modified gen p mean: 0.4516895115375519, gen p mean: -0.028637265786528587, mean p set: 0.4521697759628296
loss_pred:0.017635904252529144, decouple_loss:0.0013424574863165617
loss_pred:0.017275050282478333, decouple_loss:0.0013834629207849503
The modified gen p mean: 0.449844092130661, gen p mean: -0.03193514421582222, mean p set: 0.4503243863582611
loss_pred:0.017153285443782806, decouple_loss:0.0013559760991483927
Iteration: 423, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45169979333877563, gen p mean: -0.027552999556064606, mean p set: 0.45218008756637573
The modified gen p mean: 0.4499744772911072, gen p mean: -0.03567901998758316, mean p set: 0.4504547715187073
loss_pred:0.017808204516768456, decouple_loss:0.001504558022134006
loss_pred:0.019057389348745346, decouple_loss:0.001567861414514482
The modified gen p mean: 0.44941064715385437, gen p mean: -0.030551135540008545, mean p set: 0.44989094138145447
loss_pred:0.017014838755130768, decouple_loss:0.001350424368865788
Iteration: 424, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44949042797088623, gen p mean: -0.036389172077178955, mean p set: 0.44997072219848633
loss_pred:0.01794189214706421, decouple_loss:0.0013585701817646623
The modified gen p mean: 0.4520352780818939, gen p mean: -0.029423806816339493, mean p set: 0.452515572309494The modified gen p mean: 0.4524064362049103, gen p mean: -0.029998278245329857, mean p set: 0.45288676023483276
loss_pred:0.017879413440823555, decouple_loss:0.0014952010242268443
loss_pred:0.018201656639575958, decouple_loss:0.0014921600231900811
Iteration: 425, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489936828613281, gen p mean: -0.041474346071481705, mean p set: 0.4494739770889282
loss_pred:0.017765315249562263, decouple_loss:0.0013407286023721099
The modified gen p mean: 0.4519834518432617, gen p mean: -0.031201640143990517, mean p set: 0.4524637460708618The modified gen p mean: 0.4528787434101105, gen p mean: -0.03245878592133522, mean p set: 0.45335903763771057
loss_pred:0.018143054097890854, decouple_loss:0.0012666558614000678
loss_pred:0.01726398430764675, decouple_loss:0.001332879182882607
Iteration: 426, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45021703839302063, gen p mean: -0.04138247296214104, mean p set: 0.4506973326206207
loss_pred:0.017217038199305534, decouple_loss:0.0015546681825071573
The modified gen p mean: 0.4494214653968811, gen p mean: -0.04346252977848053, mean p set: 0.4499017596244812The modified gen p mean: 0.4502570331096649, gen p mean: -0.04440651834011078, mean p set: 0.450737327337265
loss_pred:0.01810626871883869, decouple_loss:0.0013069109991192818
loss_pred:0.017863400280475616, decouple_loss:0.0014674571575596929
Iteration: 427, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514298737049103, gen p mean: -0.03778906911611557, mean p set: 0.45191019773483276
loss_pred:0.017503300681710243, decouple_loss:0.0013746838085353374
The modified gen p mean: 0.45171207189559937, gen p mean: -0.04148035869002342, mean p set: 0.4521923363208771The modified gen p mean: 0.44988295435905457, gen p mean: -0.03671049326658249, mean p set: 0.45036324858665466
loss_pred:0.01754683442413807, decouple_loss:0.001288850326091051
loss_pred:0.016712196171283722, decouple_loss:0.001267294050194323
Iteration: 428, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45123687386512756, gen p mean: -0.04090229049324989, mean p set: 0.45171716809272766
loss_pred:0.018239155411720276, decouple_loss:0.0013601278187707067
The modified gen p mean: 0.44993525743484497, gen p mean: -0.048848237842321396, mean p set: 0.4504155218601227The modified gen p mean: 0.4519214630126953, gen p mean: -0.039256371557712555, mean p set: 0.4524017870426178
loss_pred:0.01919090934097767, decouple_loss:0.001302009797655046
loss_pred:0.016825048252940178, decouple_loss:0.001324641634710133
Iteration: 429, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499061107635498, gen p mean: -0.051569148898124695, mean p set: 0.4503864049911499
loss_pred:0.01871774159371853, decouple_loss:0.0012394413352012634
The modified gen p mean: 0.4486709535121918, gen p mean: -0.05067764222621918, mean p set: 0.44915124773979187The modified gen p mean: 0.4504345655441284, gen p mean: -0.04503820836544037, mean p set: 0.4509148597717285
loss_pred:0.016960058361291885, decouple_loss:0.0014915431383997202
loss_pred:0.0168023481965065, decouple_loss:0.0013714951928704977
Iteration: 430, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45233818888664246, gen p mean: -0.0479281023144722, mean p set: 0.45281848311424255
loss_pred:0.017014505341649055, decouple_loss:0.0013455202570185065
The modified gen p mean: 0.4497663080692291, gen p mean: -0.052071474492549896, mean p set: 0.4502466022968292The modified gen p mean: 0.45222026109695435, gen p mean: -0.047653451561927795, mean p set: 0.45270055532455444
loss_pred:0.017278138548135757, decouple_loss:0.0013350300723686814
loss_pred:0.017897307872772217, decouple_loss:0.0012287122663110495
2023-05-01 07:11:42 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.05817009508609772, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.05393219366669655, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.05415062606334686, mean p set: 0.4500633478164673
loss_pred:0.018370281904935837, decouple_loss:0.0014342067297548056
loss_pred:0.017350325360894203, decouple_loss:0.0015629214467480779
loss_pred:0.01752324402332306, decouple_loss:0.0014665030175819993
WV_0_PC_1_EH_0_PS_40, loss: 0.017822343856096268, avg_mse: 0.02553778514266014
current test mse: 0.025538
Iteration: 431, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494694173336029, gen p mean: -0.053507041186094284, mean p set: 0.449949711561203
The modified gen p mean: 0.44986066222190857, gen p mean: -0.0551423616707325, mean p set: 0.45034095644950867
The modified gen p mean: 0.4488823413848877, gen p mean: -0.052722636610269547, mean p set: 0.4493626356124878
loss_pred:0.016948143020272255, decouple_loss:0.0013363468460738659
loss_pred:0.016631130129098892, decouple_loss:0.001360228518024087
loss_pred:0.017902959138154984, decouple_loss:0.0013263712171465158
Iteration: 432, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502771496772766, gen p mean: -0.05561629682779312, mean p set: 0.4507574439048767
The modified gen p mean: 0.4497336149215698, gen p mean: -0.05230887606739998, mean p set: 0.45021387934684753
loss_pred:0.01827813871204853, decouple_loss:0.001405973918735981
loss_pred:0.01718730852007866, decouple_loss:0.0012721504317596555
The modified gen p mean: 0.4492368698120117, gen p mean: -0.052881088107824326, mean p set: 0.4497171640396118
loss_pred:0.01665203459560871, decouple_loss:0.001309358049184084
Iteration: 433, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.451952189207077, gen p mean: -0.04976219683885574, mean p set: 0.4524324834346771
The modified gen p mean: 0.4493335485458374, gen p mean: -0.052314188331365585, mean p set: 0.4498138427734375
loss_pred:0.017239276319742203, decouple_loss:0.001514726085588336
loss_pred:0.016720235347747803, decouple_loss:0.0011673206463456154
The modified gen p mean: 0.450015664100647, gen p mean: -0.05255444720387459, mean p set: 0.4504959285259247
loss_pred:0.017809059470891953, decouple_loss:0.0011389871360734105
Iteration: 434, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45204421877861023, gen p mean: -0.04739910736680031, mean p set: 0.4525245130062103
The modified gen p mean: 0.45140278339385986, gen p mean: -0.04510792717337608, mean p set: 0.45188307762145996
loss_pred:0.017017807811498642, decouple_loss:0.001465232577174902
loss_pred:0.0179901085793972, decouple_loss:0.0014371711295098066
The modified gen p mean: 0.4522644281387329, gen p mean: -0.04527528956532478, mean p set: 0.452744722366333
loss_pred:0.016935953870415688, decouple_loss:0.0014419110957533121
Iteration: 435, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4523078501224518, gen p mean: -0.04620707035064697, mean p set: 0.4527881443500519
loss_pred:0.017811216413974762, decouple_loss:0.0012249895371496677
The modified gen p mean: 0.4522947669029236, gen p mean: -0.04194824770092964, mean p set: 0.4527750313282013
The modified gen p mean: 0.4518701732158661, gen p mean: -0.04548000171780586, mean p set: 0.4523504674434662
loss_pred:0.017575370147824287, decouple_loss:0.0015190350823104382
loss_pred:0.01706274412572384, decouple_loss:0.0014141855062916875
Iteration: 436, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45026251673698425, gen p mean: -0.049143265932798386, mean p set: 0.45074281096458435
loss_pred:0.01801183633506298, decouple_loss:0.0013718900736421347
The modified gen p mean: 0.44944971799850464, gen p mean: -0.04698857292532921, mean p set: 0.44993001222610474The modified gen p mean: 0.4517098665237427, gen p mean: -0.047419555485248566, mean p set: 0.45219019055366516
loss_pred:0.016818266361951828, decouple_loss:0.0014122611610218883
loss_pred:0.01737079583108425, decouple_loss:0.0012830011546611786
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012012_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012012_3_24hr.npz
NaN value num: 0
Iteration: 437, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4518972635269165, gen p mean: -0.037581607699394226, mean p set: 0.4523775279521942
loss_pred:0.017053209245204926, decouple_loss:0.0013077660696581006
The modified gen p mean: 0.4503174424171448, gen p mean: -0.04324200004339218, mean p set: 0.4507977068424225The modified gen p mean: 0.4526158273220062, gen p mean: -0.03286897391080856, mean p set: 0.45309609174728394
loss_pred:0.017291098833084106, decouple_loss:0.0014106609160080552
loss_pred:0.0174363162368536, decouple_loss:0.0013640668476000428
Iteration: 438, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45206180214881897, gen p mean: -0.04020906612277031, mean p set: 0.45254209637641907
The modified gen p mean: 0.45273756980895996, gen p mean: -0.041168563067913055, mean p set: 0.45321789383888245
loss_pred:0.017373140901327133, decouple_loss:0.001647516735829413
loss_pred:0.01704481802880764, decouple_loss:0.0014046515570953488
The modified gen p mean: 0.45333120226860046, gen p mean: -0.03830379620194435, mean p set: 0.45381149649620056
loss_pred:0.017692463472485542, decouple_loss:0.00144546153023839
Iteration: 439, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514777958393097, gen p mean: -0.04495064169168472, mean p set: 0.4519580900669098
The modified gen p mean: 0.4525606632232666, gen p mean: -0.03629171848297119, mean p set: 0.4530409872531891
loss_pred:0.017462169751524925, decouple_loss:0.0015243468806147575
loss_pred:0.01719018816947937, decouple_loss:0.0014247734798118472
The modified gen p mean: 0.45076799392700195, gen p mean: -0.034142620861530304, mean p set: 0.45124828815460205
loss_pred:0.017034363001585007, decouple_loss:0.001418285770341754
Iteration: 440, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450235515832901, gen p mean: -0.03874339163303375, mean p set: 0.4507158100605011
The modified gen p mean: 0.45320770144462585, gen p mean: -0.044774774461984634, mean p set: 0.45368802547454834
loss_pred:0.016664519906044006, decouple_loss:0.001354399137198925
loss_pred:0.01804243214428425, decouple_loss:0.0012124440399929881
The modified gen p mean: 0.4531252980232239, gen p mean: -0.031442221254110336, mean p set: 0.45360562205314636
loss_pred:0.017804306000471115, decouple_loss:0.0013039936311542988
2023-05-01 07:14:06 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.048260804265737534, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.044151321053504944, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.044069912284612656, mean p set: 0.4500633478164673
loss_pred:0.0183507539331913, decouple_loss:0.0014985490124672651
loss_pred:0.01733604073524475, decouple_loss:0.0014481216203421354
loss_pred:0.01740666851401329, decouple_loss:0.0014642192982137203
WV_0_PC_1_EH_0_PS_40, loss: 0.017771337181329727, avg_mse: 0.02545727789402008
current test mse: 0.025457
Iteration: 441, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45267388224601746, gen p mean: -0.0317767858505249, mean p set: 0.45315417647361755
The modified gen p mean: 0.45076048374176025, gen p mean: -0.0383894108235836, mean p set: 0.45124077796936035
The modified gen p mean: 0.4515746533870697, gen p mean: -0.040774185210466385, mean p set: 0.4520549178123474
loss_pred:0.017992103472352028, decouple_loss:0.001426883740350604
loss_pred:0.017110900953412056, decouple_loss:0.0013288597110658884loss_pred:0.016169799491763115, decouple_loss:0.0013286155881360173
Iteration: 442, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45073312520980835, gen p mean: -0.04160028323531151, mean p set: 0.45121341943740845
The modified gen p mean: 0.4513908624649048, gen p mean: -0.03882875666022301, mean p set: 0.4518711566925049
loss_pred:0.016763005405664444, decouple_loss:0.0012327590957283974
loss_pred:0.017223378643393517, decouple_loss:0.0012907576747238636
The modified gen p mean: 0.450947642326355, gen p mean: -0.03824860602617264, mean p set: 0.45142796635627747
loss_pred:0.016474759206175804, decouple_loss:0.00126094080042094
Iteration: 443, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4527921676635742, gen p mean: -0.0380646213889122, mean p set: 0.4532724618911743
loss_pred:0.01729757711291313, decouple_loss:0.0013138880021870136
The modified gen p mean: 0.45238208770751953, gen p mean: -0.05119238793849945, mean p set: 0.452862411737442The modified gen p mean: 0.45122694969177246, gen p mean: -0.046407099813222885, mean p set: 0.45170727372169495
loss_pred:0.017009802162647247, decouple_loss:0.0013399472227320075
loss_pred:0.01662692055106163, decouple_loss:0.0013173185288906097
Iteration: 444, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45189446210861206, gen p mean: -0.04947132617235184, mean p set: 0.45237478613853455
loss_pred:0.01752336509525776, decouple_loss:0.0011655375128611922
The modified gen p mean: 0.45140978693962097, gen p mean: -0.050536204129457474, mean p set: 0.45189008116722107The modified gen p mean: 0.45041078329086304, gen p mean: -0.04387430474162102, mean p set: 0.45089107751846313
loss_pred:0.0172756128013134, decouple_loss:0.001136886072345078
loss_pred:0.017325814813375473, decouple_loss:0.0011503619607537985
Iteration: 445, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45095402002334595, gen p mean: -0.04757761210203171, mean p set: 0.45143428444862366
loss_pred:0.01635959930717945, decouple_loss:0.0011243184562772512
The modified gen p mean: 0.45364052057266235, gen p mean: -0.04539703205227852, mean p set: 0.45412078499794006The modified gen p mean: 0.4510819911956787, gen p mean: -0.040606070309877396, mean p set: 0.4515622556209564
loss_pred:0.017037078738212585, decouple_loss:0.0011868925066664815
loss_pred:0.017039138823747635, decouple_loss:0.0011318569304421544
Iteration: 446, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45252203941345215, gen p mean: -0.04195491969585419, mean p set: 0.45300236344337463
The modified gen p mean: 0.451753169298172, gen p mean: -0.05557667836546898, mean p set: 0.4522334337234497
loss_pred:0.016988366842269897, decouple_loss:0.0010740755824372172
loss_pred:0.016820218414068222, decouple_loss:0.0012814196525141597
The modified gen p mean: 0.452274888753891, gen p mean: -0.05216966196894646, mean p set: 0.4527551829814911
loss_pred:0.0172059778124094, decouple_loss:0.00112160702701658
Iteration: 447, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513874650001526, gen p mean: -0.0526079498231411, mean p set: 0.4518677592277527
The modified gen p mean: 0.4521215856075287, gen p mean: -0.04706384241580963, mean p set: 0.4526018798351288
loss_pred:0.016821138560771942, decouple_loss:0.0010482458164915442
loss_pred:0.016933685168623924, decouple_loss:0.0011021356331184506
The modified gen p mean: 0.4526252746582031, gen p mean: -0.040792468935251236, mean p set: 0.4531055986881256
loss_pred:0.01703556999564171, decouple_loss:0.0010465234518051147
Iteration: 448, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4524537920951843, gen p mean: -0.0507686622440815, mean p set: 0.4529340863227844
loss_pred:0.017644127830863, decouple_loss:0.0012535856803879142
The modified gen p mean: 0.45103585720062256, gen p mean: -0.04414181783795357, mean p set: 0.45151615142822266The modified gen p mean: 0.45143890380859375, gen p mean: -0.04853026941418648, mean p set: 0.45191919803619385
loss_pred:0.016863610595464706, decouple_loss:0.0012295031920075417
loss_pred:0.016495566815137863, decouple_loss:0.0011198108550161123
Iteration: 449, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4520992636680603, gen p mean: -0.041813358664512634, mean p set: 0.4525795578956604
loss_pred:0.01757119409739971, decouple_loss:0.0011643300531432033
The modified gen p mean: 0.45297524333000183, gen p mean: -0.045987583696842194, mean p set: 0.4534555673599243The modified gen p mean: 0.4531868100166321, gen p mean: -0.04478313401341438, mean p set: 0.4536671042442322
loss_pred:0.01699342578649521, decouple_loss:0.0012898246059194207
loss_pred:0.016861185431480408, decouple_loss:0.0011327095562592149
Iteration: 450, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4510183334350586, gen p mean: -0.050704408437013626, mean p set: 0.4514986276626587
The modified gen p mean: 0.45133817195892334, gen p mean: -0.04589121416211128, mean p set: 0.45181846618652344
loss_pred:0.017139168456196785, decouple_loss:0.0011862508254125714
loss_pred:0.016981419175863266, decouple_loss:0.0012303092516958714
The modified gen p mean: 0.45296192169189453, gen p mean: -0.04567116126418114, mean p set: 0.45344221591949463
loss_pred:0.017438964918255806, decouple_loss:0.0013036164455115795
2023-05-01 07:15:58 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.05385991558432579, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.049551256000995636, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.049697473645210266, mean p set: 0.4500633478164673
loss_pred:0.018411502242088318, decouple_loss:0.001370784710161388
loss_pred:0.017297647893428802, decouple_loss:0.001217659912072122
loss_pred:0.017466356977820396, decouple_loss:0.0013004342326894403
WV_0_PC_1_EH_0_PS_40, loss: 0.017789985984563828, avg_mse: 0.025502966716885567
current test mse: 0.025503
Iteration: 451, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511534869670868, gen p mean: -0.03997090086340904, mean p set: 0.4516338109970093
The modified gen p mean: 0.45237088203430176, gen p mean: -0.04106925055384636, mean p set: 0.45285117626190186
The modified gen p mean: 0.4520900249481201, gen p mean: -0.04335731640458107, mean p set: 0.4525703489780426
loss_pred:0.016997940838336945, decouple_loss:0.001120788510888815
loss_pred:0.01735004410147667, decouple_loss:0.001232949667610228loss_pred:0.016979431733489037, decouple_loss:0.0011948132887482643
Iteration: 452, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4521677792072296, gen p mean: -0.047478482127189636, mean p set: 0.4526480436325073
The modified gen p mean: 0.45180171728134155, gen p mean: -0.04652336984872818, mean p set: 0.45228198170661926
loss_pred:0.016758879646658897, decouple_loss:0.0011796212056651711
loss_pred:0.017443822696805, decouple_loss:0.0012232206063345075
The modified gen p mean: 0.45124709606170654, gen p mean: -0.04010600596666336, mean p set: 0.45172739028930664
loss_pred:0.0167944747954607, decouple_loss:0.0011607257183641195
Iteration: 453, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45210137963294983, gen p mean: -0.04231139272451401, mean p set: 0.45258164405822754
The modified gen p mean: 0.45061159133911133, gen p mean: -0.04710150137543678, mean p set: 0.4510918855667114
loss_pred:0.017448315396904945, decouple_loss:0.001228422624990344
loss_pred:0.016820043325424194, decouple_loss:0.0010261598508805037
The modified gen p mean: 0.45308157801628113, gen p mean: -0.04215746372938156, mean p set: 0.4535618722438812
loss_pred:0.01651938259601593, decouple_loss:0.0011134995147585869
Iteration: 454, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508954882621765, gen p mean: -0.04234970360994339, mean p set: 0.451375812292099
loss_pred:0.01762365736067295, decouple_loss:0.0012245670659467578
The modified gen p mean: 0.45251381397247314, gen p mean: -0.04034740850329399, mean p set: 0.45299410820007324The modified gen p mean: 0.45241525769233704, gen p mean: -0.051234178245067596, mean p set: 0.4528955817222595
loss_pred:0.017118610441684723, decouple_loss:0.0012527081416919827
loss_pred:0.017192792147397995, decouple_loss:0.0012529140803962946
Iteration: 455, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45342594385147095, gen p mean: -0.04182867333292961, mean p set: 0.45390620827674866
loss_pred:0.017558099702000618, decouple_loss:0.001081810682080686
The modified gen p mean: 0.4532085657119751, gen p mean: -0.048899147659540176, mean p set: 0.4536888301372528The modified gen p mean: 0.4508211314678192, gen p mean: -0.0452156625688076, mean p set: 0.4513013958930969
loss_pred:0.017685996368527412, decouple_loss:0.0012148491805419326
loss_pred:0.01684761606156826, decouple_loss:0.0012566264485940337
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012010_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012010_3_24hr.npz
NaN value num: 0
Iteration: 456, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45183253288269043, gen p mean: -0.051271628588438034, mean p set: 0.4523128271102905
loss_pred:0.017002006992697716, decouple_loss:0.0012484490871429443
The modified gen p mean: 0.4517357051372528, gen p mean: -0.048104289919137955, mean p set: 0.4522160291671753The modified gen p mean: 0.4539630711078644, gen p mean: -0.04602367803454399, mean p set: 0.4544433653354645
loss_pred:0.016729304566979408, decouple_loss:0.0012191054411232471
loss_pred:0.017720066010951996, decouple_loss:0.0011514596408233047
Iteration: 457, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45040854811668396, gen p mean: -0.04977314919233322, mean p set: 0.45088884234428406
loss_pred:0.017821546643972397, decouple_loss:0.0011588544584810734
The modified gen p mean: 0.4525480270385742, gen p mean: -0.04796254262328148, mean p set: 0.4530283212661743The modified gen p mean: 0.45270365476608276, gen p mean: -0.04817366600036621, mean p set: 0.45318397879600525
loss_pred:0.017190081998705864, decouple_loss:0.001346982317045331
loss_pred:0.016829388216137886, decouple_loss:0.0012771676992997527
Iteration: 458, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45143216848373413, gen p mean: -0.04778119549155235, mean p set: 0.4519124925136566
loss_pred:0.018178751692175865, decouple_loss:0.001211394788697362
The modified gen p mean: 0.45160138607025146, gen p mean: -0.04771367833018303, mean p set: 0.4520816504955292The modified gen p mean: 0.45082801580429077, gen p mean: -0.05045868828892708, mean p set: 0.45130833983421326
loss_pred:0.017357785254716873, decouple_loss:0.001241758931428194
loss_pred:0.01711542159318924, decouple_loss:0.0013010349357500672
Iteration: 459, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44897574186325073, gen p mean: -0.03942761570215225, mean p set: 0.44945603609085083
The modified gen p mean: 0.4501592516899109, gen p mean: -0.042715270072221756, mean p set: 0.4506395757198334
loss_pred:0.016450224444270134, decouple_loss:0.001427519484423101
loss_pred:0.017056375741958618, decouple_loss:0.001331099309027195
The modified gen p mean: 0.450985848903656, gen p mean: -0.04619632661342621, mean p set: 0.4514661431312561
loss_pred:0.017144465819001198, decouple_loss:0.0013551957672461867
Iteration: 460, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45095574855804443, gen p mean: -0.04751308262348175, mean p set: 0.45143604278564453
loss_pred:0.016592111438512802, decouple_loss:0.0012322922702878714
The modified gen p mean: 0.4511801600456238, gen p mean: -0.04974042996764183, mean p set: 0.4516604542732239The modified gen p mean: 0.4512401521205902, gen p mean: -0.050874289125204086, mean p set: 0.4517205059528351
loss_pred:0.016612522304058075, decouple_loss:0.0012299928348511457
loss_pred:0.017638228833675385, decouple_loss:0.001232355134561658
2023-05-01 07:18:27 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.05544688552618027, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.05129172280430794, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.05163265019655228, mean p set: 0.4500633478164673
loss_pred:0.01838754490017891, decouple_loss:0.0012839843984693289
loss_pred:0.017312966287136078, decouple_loss:0.0013047595275565982
loss_pred:0.01744094491004944, decouple_loss:0.001280753524042666
WV_0_PC_1_EH_0_PS_40, loss: 0.017778310924768448, avg_mse: 0.025466470047831535
current test mse: 0.025466
Iteration: 461, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511350989341736, gen p mean: -0.05280322954058647, mean p set: 0.4516153931617737
The modified gen p mean: 0.45169639587402344, gen p mean: -0.05388028547167778, mean p set: 0.45217666029930115
The modified gen p mean: 0.4517442584037781, gen p mean: -0.05287851020693779, mean p set: 0.4522245526313782
loss_pred:0.016431419178843498, decouple_loss:0.0012221909128129482
loss_pred:0.017267026007175446, decouple_loss:0.0013973669847473502
loss_pred:0.016603834927082062, decouple_loss:0.0014400356449186802
Iteration: 462, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45147353410720825, gen p mean: -0.04975910112261772, mean p set: 0.45195385813713074
The modified gen p mean: 0.4518813490867615, gen p mean: -0.05185449868440628, mean p set: 0.4523616135120392
loss_pred:0.01742454618215561, decouple_loss:0.001427442068234086
loss_pred:0.01713900826871395, decouple_loss:0.0015119853196665645
The modified gen p mean: 0.4520858824253082, gen p mean: -0.050107527524232864, mean p set: 0.4525661766529083
loss_pred:0.0168134868144989, decouple_loss:0.0015815198421478271
Iteration: 463, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4527859687805176, gen p mean: -0.05430586636066437, mean p set: 0.4532662332057953
loss_pred:0.016841178759932518, decouple_loss:0.0016676142113283277
The modified gen p mean: 0.44999122619628906, gen p mean: -0.053085654973983765, mean p set: 0.45047152042388916The modified gen p mean: 0.45202934741973877, gen p mean: -0.055910930037498474, mean p set: 0.4525096118450165
loss_pred:0.016190679743885994, decouple_loss:0.0014273144770413637
loss_pred:0.016353977844119072, decouple_loss:0.0014107190072536469
Iteration: 464, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45179256796836853, gen p mean: -0.05785076320171356, mean p set: 0.45227286219596863
loss_pred:0.016659226268529892, decouple_loss:0.0014685546047985554
The modified gen p mean: 0.4508105218410492, gen p mean: -0.05287400633096695, mean p set: 0.4512908160686493The modified gen p mean: 0.45302069187164307, gen p mean: -0.05202848091721535, mean p set: 0.45350101590156555
loss_pred:0.016225052997469902, decouple_loss:0.001262339181266725
loss_pred:0.017007336020469666, decouple_loss:0.0016177042853087187
Iteration: 465, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44998785853385925, gen p mean: -0.048572689294815063, mean p set: 0.45046815276145935
loss_pred:0.01631646230816841, decouple_loss:0.0013382014585658908
The modified gen p mean: 0.4528464674949646, gen p mean: -0.05397363379597664, mean p set: 0.4533267617225647The modified gen p mean: 0.4489378333091736, gen p mean: -0.04415303096175194, mean p set: 0.4494180977344513
loss_pred:0.016130439937114716, decouple_loss:0.0014769462868571281
loss_pred:0.016588257625699043, decouple_loss:0.001227215863764286
Iteration: 466, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4518463611602783, gen p mean: -0.04839315265417099, mean p set: 0.4523266553878784
loss_pred:0.017016617581248283, decouple_loss:0.0013232359196990728
The modified gen p mean: 0.4518691897392273, gen p mean: -0.053596131503582, mean p set: 0.452349454164505The modified gen p mean: 0.4519600570201874, gen p mean: -0.051514338701963425, mean p set: 0.4524403214454651
loss_pred:0.016461579129099846, decouple_loss:0.0014360641362145543
loss_pred:0.016875872388482094, decouple_loss:0.0013142434181645513
Iteration: 467, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.453398197889328, gen p mean: -0.04696778953075409, mean p set: 0.4538784623146057
loss_pred:0.01649310067296028, decouple_loss:0.0011865007691085339
The modified gen p mean: 0.45122531056404114, gen p mean: -0.05120276287198067, mean p set: 0.45170560479164124The modified gen p mean: 0.4516017436981201, gen p mean: -0.051008354872465134, mean p set: 0.4520820379257202
loss_pred:0.016158392652869225, decouple_loss:0.0012235691538080573
loss_pred:0.017275787889957428, decouple_loss:0.0011780045460909605
Iteration: 468, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4537601172924042, gen p mean: -0.04627225548028946, mean p set: 0.4542403817176819
loss_pred:0.01686108484864235, decouple_loss:0.0014595433603972197
The modified gen p mean: 0.4519064426422119, gen p mean: -0.047265954315662384, mean p set: 0.452386736869812The modified gen p mean: 0.4506036043167114, gen p mean: -0.04656842350959778, mean p set: 0.4510838985443115
loss_pred:0.017343411222100258, decouple_loss:0.001341158407740295
loss_pred:0.01669415272772312, decouple_loss:0.001505053834989667
Iteration: 469, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507720172405243, gen p mean: -0.04127727448940277, mean p set: 0.4512523412704468
loss_pred:0.016931166872382164, decouple_loss:0.0011336413444951177
The modified gen p mean: 0.4505375623703003, gen p mean: -0.039976365864276886, mean p set: 0.451017826795578The modified gen p mean: 0.45124655961990356, gen p mean: -0.04629054293036461, mean p set: 0.45172688364982605
loss_pred:0.016363026574254036, decouple_loss:0.0011095009976997972
loss_pred:0.017592133954167366, decouple_loss:0.001171047450043261
Iteration: 470, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513090252876282, gen p mean: -0.04249176010489464, mean p set: 0.4517892897129059
loss_pred:0.01634058728814125, decouple_loss:0.0012848989572376013
The modified gen p mean: 0.451686829328537, gen p mean: -0.049049098044633865, mean p set: 0.4521671235561371The modified gen p mean: 0.4513400197029114, gen p mean: -0.044141124933958054, mean p set: 0.4518203139305115
loss_pred:0.01651739701628685, decouple_loss:0.0013106524711474776
loss_pred:0.017350677400827408, decouple_loss:0.0013826816575601697
2023-05-01 07:20:19 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.050116151571273804, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.045487768948078156, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.04575980454683304, mean p set: 0.4500633478164673
loss_pred:0.01850869320333004, decouple_loss:0.0012872308725491166
loss_pred:0.017422901466488838, decouple_loss:0.0013461242197081447
loss_pred:0.017502043396234512, decouple_loss:0.00125852320343256
WV_0_PC_1_EH_0_PS_40, loss: 0.017876077443361282, avg_mse: 0.025680093094706535
current test mse: 0.02568
Iteration: 471, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450575590133667, gen p mean: -0.04830527678132057, mean p set: 0.4510558545589447
The modified gen p mean: 0.45253291726112366, gen p mean: -0.04187573492527008, mean p set: 0.45301321148872375
The modified gen p mean: 0.45203670859336853, gen p mean: -0.047650448977947235, mean p set: 0.4525170624256134
loss_pred:0.016796499490737915, decouple_loss:0.0011503156274557114
loss_pred:0.017557313665747643, decouple_loss:0.0012296773493289948
loss_pred:0.017069542780518532, decouple_loss:0.0011149067431688309
Iteration: 472, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514986574649811, gen p mean: -0.0453822948038578, mean p set: 0.4519789516925812The modified gen p mean: 0.4513707756996155, gen p mean: -0.049522027373313904, mean p set: 0.4518510699272156
loss_pred:0.01739501953125, decouple_loss:0.0011347036343067884
loss_pred:0.017306983470916748, decouple_loss:0.0011690619867295027
The modified gen p mean: 0.4525426924228668, gen p mean: -0.04210905358195305, mean p set: 0.4530230164527893
loss_pred:0.016494791954755783, decouple_loss:0.0013028880348429084
Iteration: 473, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4516639709472656, gen p mean: -0.04088827595114708, mean p set: 0.4521442651748657
loss_pred:0.016387028619647026, decouple_loss:0.0013165846467018127
The modified gen p mean: 0.4496181011199951, gen p mean: -0.038316760212183, mean p set: 0.4500984251499176The modified gen p mean: 0.451517254114151, gen p mean: -0.04059867933392525, mean p set: 0.4519975483417511
loss_pred:0.016167597845196724, decouple_loss:0.0015370534965768456
loss_pred:0.016543332487344742, decouple_loss:0.0012501064920797944
Iteration: 474, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496695399284363, gen p mean: -0.039562955498695374, mean p set: 0.4501498341560364
loss_pred:0.016361093148589134, decouple_loss:0.0013905934756621718
The modified gen p mean: 0.4510897696018219, gen p mean: -0.04618411138653755, mean p set: 0.4515700936317444The modified gen p mean: 0.45329049229621887, gen p mean: -0.04478582739830017, mean p set: 0.45377078652381897
loss_pred:0.016163598746061325, decouple_loss:0.0013371467357501388
loss_pred:0.016246724873781204, decouple_loss:0.0013999396469444036
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012015_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012015_3_24hr.npz
NaN value num: 0
Iteration: 475, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472449719905853, gen p mean: -0.04660947248339653, mean p set: 0.4477252662181854
loss_pred:0.015663689002394676, decouple_loss:0.0012664174428209662
The modified gen p mean: 0.4481883943080902, gen p mean: -0.04844926670193672, mean p set: 0.4486686885356903The modified gen p mean: 0.44597193598747253, gen p mean: -0.049033861607313156, mean p set: 0.44645223021507263
loss_pred:0.015325463376939297, decouple_loss:0.0013233482604846358
loss_pred:0.015393193811178207, decouple_loss:0.0011789808049798012
Iteration: 476, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44937098026275635, gen p mean: -0.0442240945994854, mean p set: 0.44985130429267883
The modified gen p mean: 0.4484391510486603, gen p mean: -0.04800179600715637, mean p set: 0.448919415473938
loss_pred:0.01503443531692028, decouple_loss:0.0014780521159991622
loss_pred:0.014912623912096024, decouple_loss:0.0015010979259386659
The modified gen p mean: 0.44729089736938477, gen p mean: -0.05176436901092529, mean p set: 0.44777119159698486
loss_pred:0.01497880183160305, decouple_loss:0.0013856852892786264
Iteration: 477, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44835665822029114, gen p mean: -0.05598452687263489, mean p set: 0.4488369822502136
The modified gen p mean: 0.44821879267692566, gen p mean: -0.058540377765893936, mean p set: 0.44869908690452576
loss_pred:0.014783855527639389, decouple_loss:0.0015044898027554154
loss_pred:0.014461462385952473, decouple_loss:0.0015757695073261857
The modified gen p mean: 0.4485762417316437, gen p mean: -0.05672675371170044, mean p set: 0.4490565061569214
loss_pred:0.014297284185886383, decouple_loss:0.0014037140645086765
Iteration: 478, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44919610023498535, gen p mean: -0.05070314183831215, mean p set: 0.44967639446258545
The modified gen p mean: 0.4484703838825226, gen p mean: -0.06316511332988739, mean p set: 0.4489506781101227
loss_pred:0.014757785946130753, decouple_loss:0.001562621328048408
loss_pred:0.014552953653037548, decouple_loss:0.001546560670249164
The modified gen p mean: 0.4468974173069, gen p mean: -0.05742218345403671, mean p set: 0.4473777115345001
loss_pred:0.014814196154475212, decouple_loss:0.001517586992122233
Iteration: 479, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471522867679596, gen p mean: -0.05853322893381119, mean p set: 0.4476326107978821
loss_pred:0.014193800278007984, decouple_loss:0.0015259413048624992
The modified gen p mean: 0.4484618604183197, gen p mean: -0.05982965603470802, mean p set: 0.4489421248435974The modified gen p mean: 0.4480283856391907, gen p mean: -0.05895696580410004, mean p set: 0.44850867986679077
loss_pred:0.014042941853404045, decouple_loss:0.0015601902268826962
loss_pred:0.014491760171949863, decouple_loss:0.0014784656232222915
Iteration: 480, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480310380458832, gen p mean: -0.05491339787840843, mean p set: 0.4485113322734833
loss_pred:0.013895330019295216, decouple_loss:0.0016151037998497486
The modified gen p mean: 0.447185218334198, gen p mean: -0.05445251986384392, mean p set: 0.4476655125617981The modified gen p mean: 0.4479886591434479, gen p mean: -0.060135286301374435, mean p set: 0.448468953371048
loss_pred:0.013695338740944862, decouple_loss:0.0014048712328076363
loss_pred:0.014181037433445454, decouple_loss:0.0014497339725494385
2023-05-01 07:22:55 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.05747253820300102, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.05296621099114418, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.05379209294915199, mean p set: 0.4500633478164673
loss_pred:0.018241340294480324, decouple_loss:0.0014564169105142355
loss_pred:0.019535085186362267, decouple_loss:0.0015597620513290167
loss_pred:0.018404852598905563, decouple_loss:0.0014859929215162992
WV_0_PC_1_EH_0_PS_40, loss: 0.018802128732204437, avg_mse: 0.027327407151460648
current test mse: 0.027327
Iteration: 481, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483889639377594, gen p mean: -0.04986489936709404, mean p set: 0.4488692581653595
The modified gen p mean: 0.4475211799144745, gen p mean: -0.05337902531027794, mean p set: 0.4480014741420746
The modified gen p mean: 0.4474603533744812, gen p mean: -0.05395498871803284, mean p set: 0.4479406476020813
loss_pred:0.014375867322087288, decouple_loss:0.0013982459204271436
loss_pred:0.01448994129896164, decouple_loss:0.0014014417538419366
loss_pred:0.014055860228836536, decouple_loss:0.0013902264181524515
Iteration: 482, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44536155462265015, gen p mean: -0.05216321721673012, mean p set: 0.44584187865257263
The modified gen p mean: 0.4485549032688141, gen p mean: -0.042693130671978, mean p set: 0.4490351974964142loss_pred:0.014470264315605164, decouple_loss:0.0016613053157925606
The modified gen p mean: 0.4490232765674591, gen p mean: -0.04366343840956688, mean p set: 0.4495036005973816
loss_pred:0.014999990351498127, decouple_loss:0.0016096344916149974
loss_pred:0.01365926768630743, decouple_loss:0.0015873480588197708
Iteration: 483, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.445667028427124, gen p mean: -0.046843744814395905, mean p set: 0.4461473524570465
loss_pred:0.014196598902344704, decouple_loss:0.0016866541700437665
The modified gen p mean: 0.4471624791622162, gen p mean: -0.03675380349159241, mean p set: 0.44764280319213867The modified gen p mean: 0.44719794392585754, gen p mean: -0.04507020115852356, mean p set: 0.44767823815345764
loss_pred:0.01442455593496561, decouple_loss:0.0014492128975689411
loss_pred:0.01389788743108511, decouple_loss:0.0015471053775399923
Iteration: 484, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474680721759796, gen p mean: -0.04418022930622101, mean p set: 0.4479483664035797
loss_pred:0.013860974460840225, decouple_loss:0.0014075229410082102
The modified gen p mean: 0.4463062286376953, gen p mean: -0.047867849469184875, mean p set: 0.4467865526676178The modified gen p mean: 0.4477037787437439, gen p mean: -0.04854411259293556, mean p set: 0.448184072971344
loss_pred:0.0143583407625556, decouple_loss:0.0017075414070859551
loss_pred:0.013717813417315483, decouple_loss:0.0014335298910737038
Iteration: 485, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44762107729911804, gen p mean: -0.05013334006071091, mean p set: 0.4481014013290405
loss_pred:0.014094737358391285, decouple_loss:0.001406562514603138
The modified gen p mean: 0.44597384333610535, gen p mean: -0.048338666558265686, mean p set: 0.44645413756370544The modified gen p mean: 0.4471014738082886, gen p mean: -0.048288218677043915, mean p set: 0.4475817382335663
loss_pred:0.014075429178774357, decouple_loss:0.0015637829201295972
loss_pred:0.014147106558084488, decouple_loss:0.0014546971069648862
Iteration: 486, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447642058134079, gen p mean: -0.05757249519228935, mean p set: 0.44812238216400146
loss_pred:0.01399024948477745, decouple_loss:0.0014260174939408898
The modified gen p mean: 0.44746750593185425, gen p mean: -0.055239640176296234, mean p set: 0.44794782996177673The modified gen p mean: 0.44779130816459656, gen p mean: -0.05330463498830795, mean p set: 0.44827160239219666
loss_pred:0.0143027538433671, decouple_loss:0.0013638547388836741
loss_pred:0.014558297581970692, decouple_loss:0.001322303432971239
Iteration: 487, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44903576374053955, gen p mean: -0.056722622364759445, mean p set: 0.44951605796813965
loss_pred:0.013738510198891163, decouple_loss:0.0014362893998622894
The modified gen p mean: 0.4477511942386627, gen p mean: -0.061411626636981964, mean p set: 0.4482314884662628The modified gen p mean: 0.44641435146331787, gen p mean: -0.05881983041763306, mean p set: 0.44689464569091797
loss_pred:0.013610780239105225, decouple_loss:0.0014754543080925941
loss_pred:0.014072474092245102, decouple_loss:0.0014858422800898552
Iteration: 488, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448955237865448, gen p mean: -0.055697642266750336, mean p set: 0.4494354724884033
loss_pred:0.013975334353744984, decouple_loss:0.0013743926538154483
The modified gen p mean: 0.4475625157356262, gen p mean: -0.05775894969701767, mean p set: 0.4480428397655487The modified gen p mean: 0.4475595951080322, gen p mean: -0.054090213030576706, mean p set: 0.4480399191379547
loss_pred:0.013426559045910835, decouple_loss:0.0013494088780134916
loss_pred:0.013382858596742153, decouple_loss:0.0013647903688251972
Iteration: 489, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448258638381958, gen p mean: -0.04873410612344742, mean p set: 0.4487389624118805
loss_pred:0.014636874198913574, decouple_loss:0.0014580917777493596
The modified gen p mean: 0.44796302914619446, gen p mean: -0.05878811329603195, mean p set: 0.44844329357147217The modified gen p mean: 0.44896137714385986, gen p mean: -0.047880783677101135, mean p set: 0.44944167137145996
loss_pred:0.013643170706927776, decouple_loss:0.0016179572558030486
loss_pred:0.014184737578034401, decouple_loss:0.001447716262191534
Iteration: 490, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44841551780700684, gen p mean: -0.05292860418558121, mean p set: 0.44889581203460693
loss_pred:0.014057427644729614, decouple_loss:0.0014896877110004425
The modified gen p mean: 0.4459594190120697, gen p mean: -0.0531272329390049, mean p set: 0.4464397132396698The modified gen p mean: 0.4482795000076294, gen p mean: -0.04680388420820236, mean p set: 0.4487598240375519
loss_pred:0.01416208129376173, decouple_loss:0.0012533139670267701
loss_pred:0.014202107675373554, decouple_loss:0.0014035355998203158
2023-05-01 07:24:47 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.04701141268014908, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04348048195242882, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04326857253909111, mean p set: 0.4500633478164673
loss_pred:0.01928756572306156, decouple_loss:0.001447990769520402
loss_pred:0.018184293061494827, decouple_loss:0.0014431774616241455
loss_pred:0.018241988494992256, decouple_loss:0.0014325163792818785
WV_0_PC_1_EH_0_PS_40, loss: 0.018643345683813095, avg_mse: 0.02714540809392929
current test mse: 0.027145
Iteration: 491, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44716429710388184, gen p mean: -0.04239138960838318, mean p set: 0.44764459133148193
The modified gen p mean: 0.44793835282325745, gen p mean: -0.043085552752017975, mean p set: 0.44841864705085754
The modified gen p mean: 0.44818437099456787, gen p mean: -0.044681113213300705, mean p set: 0.4486646354198456
loss_pred:0.01377897709608078, decouple_loss:0.001451785210520029
loss_pred:0.013650569133460522, decouple_loss:0.0013426976511254907
loss_pred:0.013628050684928894, decouple_loss:0.0013562922831624746
Iteration: 492, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487364590167999, gen p mean: -0.03679937496781349, mean p set: 0.4492167532444
loss_pred:0.01443507894873619, decouple_loss:0.0013740479480475187
The modified gen p mean: 0.44798973202705383, gen p mean: -0.03603771701455116, mean p set: 0.44847002625465393The modified gen p mean: 0.44778892397880554, gen p mean: -0.04301721975207329, mean p set: 0.44826918840408325
loss_pred:0.013714571483433247, decouple_loss:0.0012815118534490466
loss_pred:0.014222957193851471, decouple_loss:0.001324228709563613
Iteration: 493, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44882652163505554, gen p mean: -0.03734556585550308, mean p set: 0.44930681586265564
loss_pred:0.014533326961100101, decouple_loss:0.0012411980424076319
The modified gen p mean: 0.4474125802516937, gen p mean: -0.04508871212601662, mean p set: 0.4478928744792938The modified gen p mean: 0.44860631227493286, gen p mean: -0.043439436703920364, mean p set: 0.44908660650253296
loss_pred:0.013441833667457104, decouple_loss:0.0013467425014823675
loss_pred:0.013558626174926758, decouple_loss:0.0014606574550271034
Iteration: 494, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44732344150543213, gen p mean: -0.04259954020380974, mean p set: 0.44780370593070984
loss_pred:0.014335925690829754, decouple_loss:0.0013355168048292398
The modified gen p mean: 0.4463588297367096, gen p mean: -0.043645039200782776, mean p set: 0.4468391239643097The modified gen p mean: 0.4482065737247467, gen p mean: -0.04462543874979019, mean p set: 0.4486868679523468
loss_pred:0.013838745653629303, decouple_loss:0.0013209263561293483
loss_pred:0.013673629611730576, decouple_loss:0.0014212606474757195
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012015_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012015_3_24hr.npz
NaN value num: 0
Iteration: 495, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490266442298889, gen p mean: -0.04375183582305908, mean p set: 0.4495069682598114
loss_pred:0.01922905631363392, decouple_loss:0.0014475445495918393
The modified gen p mean: 0.4482898414134979, gen p mean: -0.04300963878631592, mean p set: 0.448770135641098The modified gen p mean: 0.4502987265586853, gen p mean: -0.04487283155322075, mean p set: 0.4507790505886078
loss_pred:0.018547026440501213, decouple_loss:0.0013431136030703783
loss_pred:0.017698558047413826, decouple_loss:0.0013564983382821083
Iteration: 496, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476284086704254, gen p mean: -0.04807925224304199, mean p set: 0.4481086730957031
loss_pred:0.0185218695551157, decouple_loss:0.0014853457687422633
The modified gen p mean: 0.4505573809146881, gen p mean: -0.04853731021285057, mean p set: 0.4510376751422882The modified gen p mean: 0.44819462299346924, gen p mean: -0.05737636610865593, mean p set: 0.44867488741874695
loss_pred:0.017848987132310867, decouple_loss:0.0013420820469036698
loss_pred:0.01804044470191002, decouple_loss:0.001439182902686298
Iteration: 497, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44912129640579224, gen p mean: -0.048764824867248535, mean p set: 0.44960159063339233
loss_pred:0.017585188150405884, decouple_loss:0.0014038177905604243
The modified gen p mean: 0.4507276117801666, gen p mean: -0.05150119587779045, mean p set: 0.4512079358100891The modified gen p mean: 0.44891270995140076, gen p mean: -0.053034089505672455, mean p set: 0.44939300417900085
loss_pred:0.01732027903199196, decouple_loss:0.0014607078628614545
loss_pred:0.017933128401637077, decouple_loss:0.0014298839960247278
Iteration: 498, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490819573402405, gen p mean: -0.05470072850584984, mean p set: 0.4495622515678406
loss_pred:0.018560711294412613, decouple_loss:0.001409087679348886
The modified gen p mean: 0.4507257342338562, gen p mean: -0.05317114666104317, mean p set: 0.4512060284614563The modified gen p mean: 0.4473506212234497, gen p mean: -0.055720336735248566, mean p set: 0.4478309452533722
loss_pred:0.017422588542103767, decouple_loss:0.0013570531737059355
loss_pred:0.018650811165571213, decouple_loss:0.0013742281589657068
Iteration: 499, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484102725982666, gen p mean: -0.05361876264214516, mean p set: 0.4488905668258667
loss_pred:0.01791398599743843, decouple_loss:0.001448388327844441
The modified gen p mean: 0.4497939646244049, gen p mean: -0.05281809717416763, mean p set: 0.4502742886543274The modified gen p mean: 0.4487427771091461, gen p mean: -0.06162456050515175, mean p set: 0.4492231011390686
loss_pred:0.018069058656692505, decouple_loss:0.0013881801860406995
loss_pred:0.018208416178822517, decouple_loss:0.0014588430058211088
Iteration: 500, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505627155303955, gen p mean: -0.04841870814561844, mean p set: 0.4510430097579956
loss_pred:0.01721162721514702, decouple_loss:0.001559766591526568
The modified gen p mean: 0.4494977295398712, gen p mean: -0.050539664924144745, mean p set: 0.4499780237674713The modified gen p mean: 0.44947001338005066, gen p mean: -0.04693905636668205, mean p set: 0.44995033740997314
loss_pred:0.018467722460627556, decouple_loss:0.0014933343045413494
loss_pred:0.017966073006391525, decouple_loss:0.0015687920385971665
2023-05-01 07:27:17 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.054835062474012375, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.05116612836718559, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.05112698674201965, mean p set: 0.4500633478164673
loss_pred:0.018558319658041, decouple_loss:0.0015540176536887884
loss_pred:0.017487548291683197, decouple_loss:0.0014810586581006646
loss_pred:0.017612526193261147, decouple_loss:0.0015079788863658905
WV_0_PC_1_EH_0_PS_40, loss: 0.01796184852719307, avg_mse: 0.025783423334360123
current test mse: 0.025783
Iteration: 501, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45026326179504395, gen p mean: -0.046921975910663605, mean p set: 0.45074358582496643
The modified gen p mean: 0.44911545515060425, gen p mean: -0.04348921775817871, mean p set: 0.44959574937820435
The modified gen p mean: 0.4501079022884369, gen p mean: -0.04644021764397621, mean p set: 0.4505882263183594
loss_pred:0.017645971849560738, decouple_loss:0.0013676023809239268
loss_pred:0.01758616790175438, decouple_loss:0.0015122785698622465
loss_pred:0.01784389279782772, decouple_loss:0.0014570719795301557
Iteration: 502, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480634927749634, gen p mean: -0.047046639025211334, mean p set: 0.4485437870025635
loss_pred:0.018033139407634735, decouple_loss:0.0013419192982837558
The modified gen p mean: 0.45086026191711426, gen p mean: -0.04045595973730087, mean p set: 0.45134055614471436The modified gen p mean: 0.44841670989990234, gen p mean: -0.04098956286907196, mean p set: 0.44889700412750244
loss_pred:0.01825643703341484, decouple_loss:0.0014723405474796891
loss_pred:0.018196016550064087, decouple_loss:0.0013683900469914079
Iteration: 503, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507046639919281, gen p mean: -0.03958706930279732, mean p set: 0.4511849880218506
loss_pred:0.016862228512763977, decouple_loss:0.0015088364016264677
The modified gen p mean: 0.4500325322151184, gen p mean: -0.04350898042321205, mean p set: 0.4505128264427185The modified gen p mean: 0.4501286745071411, gen p mean: -0.04309014976024628, mean p set: 0.4506089687347412
loss_pred:0.0173304695636034, decouple_loss:0.0015150932595133781
loss_pred:0.01775979995727539, decouple_loss:0.0014689435483887792
Iteration: 504, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485870599746704, gen p mean: -0.04538785666227341, mean p set: 0.4490673840045929
loss_pred:0.018068574368953705, decouple_loss:0.0012906745541840792
The modified gen p mean: 0.45105379819869995, gen p mean: -0.04035184904932976, mean p set: 0.45153409242630005The modified gen p mean: 0.4507609009742737, gen p mean: -0.04181869328022003, mean p set: 0.4512411952018738
loss_pred:0.016573466360569, decouple_loss:0.0013637811644002795
loss_pred:0.016033407300710678, decouple_loss:0.0014027489814907312
Iteration: 505, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44984108209609985, gen p mean: -0.047375570982694626, mean p set: 0.45032137632369995
loss_pred:0.017968863248825073, decouple_loss:0.0015334469499066472
The modified gen p mean: 0.45115989446640015, gen p mean: -0.04174789413809776, mean p set: 0.45164018869400024The modified gen p mean: 0.4493923783302307, gen p mean: -0.04837360233068466, mean p set: 0.4498726725578308
loss_pred:0.018454913049936295, decouple_loss:0.0016498914919793606
loss_pred:0.01608497090637684, decouple_loss:0.001420359592884779
Iteration: 506, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493338167667389, gen p mean: -0.05264576897025108, mean p set: 0.4498141407966614
loss_pred:0.01809435896575451, decouple_loss:0.0013077117037028074
The modified gen p mean: 0.44769155979156494, gen p mean: -0.04597451165318489, mean p set: 0.44817185401916504The modified gen p mean: 0.44673827290534973, gen p mean: -0.05163966864347458, mean p set: 0.44721853733062744
loss_pred:0.017073260620236397, decouple_loss:0.0013109846040606499
loss_pred:0.01794794760644436, decouple_loss:0.0013899455079808831
Iteration: 507, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44797125458717346, gen p mean: -0.050735000520944595, mean p set: 0.44845154881477356
loss_pred:0.01781267486512661, decouple_loss:0.0012992791598662734
The modified gen p mean: 0.4476175606250763, gen p mean: -0.056987881660461426, mean p set: 0.4480978846549988The modified gen p mean: 0.4507363736629486, gen p mean: -0.05007190257310867, mean p set: 0.4512166678905487
loss_pred:0.018048975616693497, decouple_loss:0.0015014783712103963
loss_pred:0.016931353136897087, decouple_loss:0.001365960924886167
Iteration: 508, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485575556755066, gen p mean: -0.05809909105300903, mean p set: 0.4490378499031067
loss_pred:0.017660506069660187, decouple_loss:0.0014918588567525148
The modified gen p mean: 0.4496336281299591, gen p mean: -0.05840792879462242, mean p set: 0.4501139223575592The modified gen p mean: 0.44674256443977356, gen p mean: -0.05897555872797966, mean p set: 0.44722285866737366
loss_pred:0.017593352124094963, decouple_loss:0.0015778461238369346
loss_pred:0.017122531309723854, decouple_loss:0.0015205719973891973
Iteration: 509, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44873711466789246, gen p mean: -0.05799113214015961, mean p set: 0.44921740889549255
loss_pred:0.018056007102131844, decouple_loss:0.0013949881540611386
The modified gen p mean: 0.44949010014533997, gen p mean: -0.06044936552643776, mean p set: 0.44997039437294006The modified gen p mean: 0.45003268122673035, gen p mean: -0.05584247410297394, mean p set: 0.45051300525665283
loss_pred:0.0177735798060894, decouple_loss:0.001342009985819459
loss_pred:0.01704339310526848, decouple_loss:0.0012918366119265556
Iteration: 510, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45077434182167053, gen p mean: -0.05628308281302452, mean p set: 0.45125463604927063
The modified gen p mean: 0.4471046030521393, gen p mean: -0.061651963740587234, mean p set: 0.44758492708206177
loss_pred:0.01594424434006214, decouple_loss:0.0016309047350659966
loss_pred:0.017097171396017075, decouple_loss:0.0013904174556955695The modified gen p mean: 0.44839614629745483, gen p mean: -0.07053825259208679, mean p set: 0.44887641072273254
loss_pred:0.017727209255099297, decouple_loss:0.0015496744308620691
2023-05-01 07:29:10 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.06672810763120651, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.062454015016555786, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.06263598799705505, mean p set: 0.4500633478164673
loss_pred:0.018422016873955727, decouple_loss:0.001374902785755694
loss_pred:0.01735539548099041, decouple_loss:0.0015185433439910412
loss_pred:0.017434949055314064, decouple_loss:0.0014420588267967105
WV_0_PC_1_EH_0_PS_40, loss: 0.017809711396694183, avg_mse: 0.02552874945104122
current test mse: 0.025529
Iteration: 511, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486439526081085, gen p mean: -0.05510513484477997, mean p set: 0.449124276638031
The modified gen p mean: 0.4477318227291107, gen p mean: -0.06744007766246796, mean p set: 0.4482121169567108
The modified gen p mean: 0.44794583320617676, gen p mean: -0.06489226222038269, mean p set: 0.44842615723609924
loss_pred:0.017336975783109665, decouple_loss:0.0013437032466754317
loss_pred:0.01729789562523365, decouple_loss:0.0012384576257318258
loss_pred:0.017428776249289513, decouple_loss:0.0012941932072862983
Iteration: 512, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44714444875717163, gen p mean: -0.059007734060287476, mean p set: 0.4476247727870941
The modified gen p mean: 0.44995397329330444, gen p mean: -0.057354409247636795, mean p set: 0.45043426752090454
loss_pred:0.017995502799749374, decouple_loss:0.0013985519763082266
loss_pred:0.017301732674241066, decouple_loss:0.001515822485089302
The modified gen p mean: 0.44786569476127625, gen p mean: -0.06358702480792999, mean p set: 0.44834598898887634
loss_pred:0.017427802085876465, decouple_loss:0.0014746327651664615
Iteration: 513, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507928490638733, gen p mean: -0.051977626979351044, mean p set: 0.4512731432914734
loss_pred:0.016454102471470833, decouple_loss:0.0012949415249750018
The modified gen p mean: 0.4517247974872589, gen p mean: -0.05243563652038574, mean p set: 0.4522051215171814The modified gen p mean: 0.44914600253105164, gen p mean: -0.05147731304168701, mean p set: 0.44962626695632935
loss_pred:0.01646276004612446, decouple_loss:0.0012673556338995695
loss_pred:0.017972024157643318, decouple_loss:0.001199076883494854
Iteration: 514, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45025137066841125, gen p mean: -0.051739875227212906, mean p set: 0.45073163509368896
loss_pred:0.01783083565533161, decouple_loss:0.0014304808573797345
The modified gen p mean: 0.4480365812778473, gen p mean: -0.05491374805569649, mean p set: 0.4485168755054474The modified gen p mean: 0.44963186979293823, gen p mean: -0.0487813875079155, mean p set: 0.45011213421821594
loss_pred:0.017258990556001663, decouple_loss:0.001500578480772674
loss_pred:0.017690123990178108, decouple_loss:0.0013558112550526857
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012018_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012018_3_24hr.npz
NaN value num: 0
Iteration: 515, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494502544403076, gen p mean: -0.0525948628783226, mean p set: 0.4499305486679077
loss_pred:0.014950995333492756, decouple_loss:0.0014380892971530557
The modified gen p mean: 0.4475609362125397, gen p mean: -0.06032753363251686, mean p set: 0.4480412006378174The modified gen p mean: 0.44862130284309387, gen p mean: -0.05378805100917816, mean p set: 0.44910159707069397
loss_pred:0.015190644189715385, decouple_loss:0.0015984487254172564
loss_pred:0.015438634902238846, decouple_loss:0.0014083976857364178
Iteration: 516, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4510590434074402, gen p mean: -0.04565849527716637, mean p set: 0.4515393376350403
The modified gen p mean: 0.449535071849823, gen p mean: -0.048142239451408386, mean p set: 0.4500153958797455
loss_pred:0.015195507556200027, decouple_loss:0.0016392526449635625
loss_pred:0.0145902493968606, decouple_loss:0.001357310451567173
The modified gen p mean: 0.4487936794757843, gen p mean: -0.04938754439353943, mean p set: 0.4492739737033844
loss_pred:0.015544573776423931, decouple_loss:0.0014282226329669356
Iteration: 517, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449035108089447, gen p mean: -0.04851139709353447, mean p set: 0.4495154023170471
loss_pred:0.014645843766629696, decouple_loss:0.001300811069086194
The modified gen p mean: 0.4498286545276642, gen p mean: -0.0505310595035553, mean p set: 0.4503089487552643The modified gen p mean: 0.4483950436115265, gen p mean: -0.050754666328430176, mean p set: 0.4488753378391266
loss_pred:0.014254669658839703, decouple_loss:0.0013542206725105643
loss_pred:0.015124271623790264, decouple_loss:0.0012752835173159838
Iteration: 518, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485279321670532, gen p mean: -0.05691823735833168, mean p set: 0.4490082263946533
loss_pred:0.013985302299261093, decouple_loss:0.0013753349194303155
The modified gen p mean: 0.44802820682525635, gen p mean: -0.05667467042803764, mean p set: 0.44850850105285645The modified gen p mean: 0.44823336601257324, gen p mean: -0.05467889457941055, mean p set: 0.4487136900424957
loss_pred:0.01434240210801363, decouple_loss:0.0013170379679650068
loss_pred:0.015394430607557297, decouple_loss:0.0013805216876789927
Iteration: 519, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44823217391967773, gen p mean: -0.05524606257677078, mean p set: 0.44871246814727783
loss_pred:0.014643039554357529, decouple_loss:0.001411885255947709
The modified gen p mean: 0.45006632804870605, gen p mean: -0.044662296772003174, mean p set: 0.45054665207862854The modified gen p mean: 0.4486909806728363, gen p mean: -0.04778764024376869, mean p set: 0.4491713047027588
loss_pred:0.014433794654905796, decouple_loss:0.001591739826835692
loss_pred:0.014837915077805519, decouple_loss:0.0014549923362210393
Iteration: 520, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44916248321533203, gen p mean: -0.04375751316547394, mean p set: 0.44964277744293213
loss_pred:0.015136763453483582, decouple_loss:0.0014790419954806566
The modified gen p mean: 0.44893208146095276, gen p mean: -0.04586726054549217, mean p set: 0.44941237568855286The modified gen p mean: 0.44943416118621826, gen p mean: -0.053885992616415024, mean p set: 0.44991445541381836
loss_pred:0.014789512380957603, decouple_loss:0.001392147270962596
loss_pred:0.01432705856859684, decouple_loss:0.0014276992296800017
2023-05-01 07:31:38 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.05186770111322403, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.048663608729839325, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04840981215238571, mean p set: 0.4500633478164673
loss_pred:0.019144471734762192, decouple_loss:0.0016319681890308857
loss_pred:0.01803053356707096, decouple_loss:0.0016960398061200976
loss_pred:0.018107149749994278, decouple_loss:0.0016465765656903386
WV_0_PC_1_EH_0_PS_40, loss: 0.018510296940803528, avg_mse: 0.0267880167812109
current test mse: 0.026788
Iteration: 521, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492180645465851, gen p mean: -0.049283672124147415, mean p set: 0.4496983587741852
The modified gen p mean: 0.4483445882797241, gen p mean: -0.04771905764937401, mean p set: 0.4488248825073242
The modified gen p mean: 0.4480951428413391, gen p mean: -0.04839519038796425, mean p set: 0.4485754370689392
loss_pred:0.014431347139179707, decouple_loss:0.0015519744483754039
loss_pred:0.014551282860338688, decouple_loss:0.0016389744123443961
loss_pred:0.014713025651872158, decouple_loss:0.0016372919781133533
Iteration: 522, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490126073360443, gen p mean: -0.04239409789443016, mean p set: 0.4494929015636444
loss_pred:0.014383173547685146, decouple_loss:0.0013948943233117461
The modified gen p mean: 0.4490033686161041, gen p mean: -0.04959835112094879, mean p set: 0.4494836926460266The modified gen p mean: 0.44786709547042847, gen p mean: -0.04901639372110367, mean p set: 0.44834738969802856
loss_pred:0.013757675886154175, decouple_loss:0.0014334475854411721
loss_pred:0.01351446658372879, decouple_loss:0.0015525927301496267
Iteration: 523, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44851556420326233, gen p mean: -0.04267708584666252, mean p set: 0.4489958584308624
loss_pred:0.014352620579302311, decouple_loss:0.0015468831406906247
The modified gen p mean: 0.4478452801704407, gen p mean: -0.05446843057870865, mean p set: 0.44832560420036316The modified gen p mean: 0.44851452112197876, gen p mean: -0.04702211916446686, mean p set: 0.44899484515190125
loss_pred:0.01356539037078619, decouple_loss:0.0015215374296531081
loss_pred:0.014907298609614372, decouple_loss:0.0015099028823897243
Iteration: 524, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44827431440353394, gen p mean: -0.05114702880382538, mean p set: 0.4487546384334564
loss_pred:0.014479300938546658, decouple_loss:0.0015438328264281154
The modified gen p mean: 0.4492962062358856, gen p mean: -0.04444701597094536, mean p set: 0.44977647066116333The modified gen p mean: 0.4478103518486023, gen p mean: -0.052412863820791245, mean p set: 0.44829061627388
loss_pred:0.014006348326802254, decouple_loss:0.0015876307152211666
loss_pred:0.013688981533050537, decouple_loss:0.0013923897640779614
Iteration: 525, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4506921172142029, gen p mean: -0.03927105292677879, mean p set: 0.451172411441803
loss_pred:0.01417709793895483, decouple_loss:0.001517213531769812
The modified gen p mean: 0.44875583052635193, gen p mean: -0.0499919056892395, mean p set: 0.449236124753952The modified gen p mean: 0.448900431394577, gen p mean: -0.04426562413573265, mean p set: 0.4493807256221771
loss_pred:0.013625052757561207, decouple_loss:0.001437610131688416
loss_pred:0.013879303820431232, decouple_loss:0.0015461932634934783
Iteration: 526, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488747715950012, gen p mean: -0.048534564673900604, mean p set: 0.4493550956249237
loss_pred:0.0141077172011137, decouple_loss:0.0015032909577712417
The modified gen p mean: 0.4479655623435974, gen p mean: -0.05082939192652702, mean p set: 0.4484458863735199The modified gen p mean: 0.4478776156902313, gen p mean: -0.047119688242673874, mean p set: 0.4483579099178314
loss_pred:0.01384818833321333, decouple_loss:0.0014901466201990843
loss_pred:0.013347947038710117, decouple_loss:0.0015024776803329587
Iteration: 527, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44879257678985596, gen p mean: -0.04370582848787308, mean p set: 0.44927287101745605
loss_pred:0.014172603376209736, decouple_loss:0.001439917366951704
The modified gen p mean: 0.44861987233161926, gen p mean: -0.041592106223106384, mean p set: 0.44910016655921936The modified gen p mean: 0.449282169342041, gen p mean: -0.0441095344722271, mean p set: 0.4497624933719635
loss_pred:0.014233977533876896, decouple_loss:0.0015411839121952653
loss_pred:0.014236661605536938, decouple_loss:0.0014342592330649495
Iteration: 528, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493091106414795, gen p mean: -0.044418271631002426, mean p set: 0.4497894048690796
loss_pred:0.01343464944511652, decouple_loss:0.0014546866295859218
The modified gen p mean: 0.4500401020050049, gen p mean: -0.041408754885196686, mean p set: 0.450520396232605The modified gen p mean: 0.4490082561969757, gen p mean: -0.04324769973754883, mean p set: 0.4494885504245758
loss_pred:0.013811346143484116, decouple_loss:0.001386883668601513
loss_pred:0.014592958614230156, decouple_loss:0.0013328961795195937
Iteration: 529, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45011135935783386, gen p mean: -0.04935409128665924, mean p set: 0.45059165358543396
loss_pred:0.013961155898869038, decouple_loss:0.0013323448365554214
The modified gen p mean: 0.44937974214553833, gen p mean: -0.03961696848273277, mean p set: 0.44986000657081604The modified gen p mean: 0.4491003453731537, gen p mean: -0.045540183782577515, mean p set: 0.4495806396007538
loss_pred:0.013738032430410385, decouple_loss:0.001397620071657002
loss_pred:0.013464631512761116, decouple_loss:0.0014260413590818644
Iteration: 530, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499236047267914, gen p mean: -0.045870326459407806, mean p set: 0.4504038989543915
loss_pred:0.013749249279499054, decouple_loss:0.0012730719754472375
The modified gen p mean: 0.4479248821735382, gen p mean: -0.04026832804083824, mean p set: 0.4484051764011383The modified gen p mean: 0.44961708784103394, gen p mean: -0.04428695887327194, mean p set: 0.4500974118709564
loss_pred:0.013725556433200836, decouple_loss:0.0012821933487430215
loss_pred:0.014084446243941784, decouple_loss:0.0013630557805299759
2023-05-01 07:33:30 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.04811833053827286, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.0444323793053627, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04460827261209488, mean p set: 0.4500633478164673
loss_pred:0.01936263032257557, decouple_loss:0.001401247805915773
loss_pred:0.01821407675743103, decouple_loss:0.0014658891595900059loss_pred:0.018320072442293167, decouple_loss:0.0014536877861246467
WV_0_PC_1_EH_0_PS_40, loss: 0.01870427280664444, avg_mse: 0.02728920616209507
current test mse: 0.027289
Iteration: 531, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44982975721359253, gen p mean: -0.041595879942178726, mean p set: 0.450310081243515
The modified gen p mean: 0.4479435980319977, gen p mean: -0.04558737948536873, mean p set: 0.44842392206192017
The modified gen p mean: 0.44948530197143555, gen p mean: -0.04009721055626869, mean p set: 0.44996556639671326
loss_pred:0.013727557845413685, decouple_loss:0.0013763878960162401
loss_pred:0.014144085347652435, decouple_loss:0.001381904468871653
loss_pred:0.01331610418856144, decouple_loss:0.0013452849816530943
Iteration: 532, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44945013523101807, gen p mean: -0.046280570328235626, mean p set: 0.4499303698539734
loss_pred:0.01435299776494503, decouple_loss:0.0013751891674473882
The modified gen p mean: 0.4492394030094147, gen p mean: -0.03923266753554344, mean p set: 0.44971972703933716The modified gen p mean: 0.44800862669944763, gen p mean: -0.04746386781334877, mean p set: 0.44848892092704773
loss_pred:0.013795924372971058, decouple_loss:0.0013228007592260838
loss_pred:0.014050382189452648, decouple_loss:0.0013934674207121134
Iteration: 533, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44853314757347107, gen p mean: -0.03926540166139603, mean p set: 0.44901344180107117
loss_pred:0.01398402824997902, decouple_loss:0.0012977136066183448
The modified gen p mean: 0.44885820150375366, gen p mean: -0.044264111667871475, mean p set: 0.44933852553367615The modified gen p mean: 0.44849181175231934, gen p mean: -0.04158883914351463, mean p set: 0.44897210597991943
loss_pred:0.013195198960602283, decouple_loss:0.0013333712704479694
loss_pred:0.013917308300733566, decouple_loss:0.001291358727030456
Iteration: 534, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44956347346305847, gen p mean: -0.039295755326747894, mean p set: 0.45004376769065857
loss_pred:0.013110439293086529, decouple_loss:0.001304267207160592
The modified gen p mean: 0.44955405592918396, gen p mean: -0.04059198498725891, mean p set: 0.45003435015678406The modified gen p mean: 0.4490712881088257, gen p mean: -0.04455137625336647, mean p set: 0.4495515525341034
loss_pred:0.01341166254132986, decouple_loss:0.001351316343061626
loss_pred:0.013393762521445751, decouple_loss:0.0014533199137076735
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012016_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012016_3_24hr.npz
NaN value num: 0
Iteration: 535, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514193832874298, gen p mean: -0.032748084515333176, mean p set: 0.4518997073173523
loss_pred:0.017651712521910667, decouple_loss:0.0016097387997433543
The modified gen p mean: 0.45178964734077454, gen p mean: -0.038736261427402496, mean p set: 0.45226994156837463The modified gen p mean: 0.4512234926223755, gen p mean: -0.03806309774518013, mean p set: 0.4517037868499756
loss_pred:0.015861406922340393, decouple_loss:0.0015437941765412688
loss_pred:0.01772252842783928, decouple_loss:0.0014722152845934033
Iteration: 536, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4532153904438019, gen p mean: -0.034464363008737564, mean p set: 0.453695684671402
loss_pred:0.016181515529751778, decouple_loss:0.001385612296871841
The modified gen p mean: 0.4506746828556061, gen p mean: -0.03549954295158386, mean p set: 0.4511549472808838
The modified gen p mean: 0.45175787806510925, gen p mean: -0.04147699475288391, mean p set: 0.45223820209503174
loss_pred:0.016640184447169304, decouple_loss:0.001390268444083631
loss_pred:0.017356060445308685, decouple_loss:0.001369789824821055
Iteration: 537, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45079344511032104, gen p mean: -0.03733111917972565, mean p set: 0.45127376914024353
The modified gen p mean: 0.45154112577438354, gen p mean: -0.037963952869176865, mean p set: 0.45202142000198364
loss_pred:0.01737257093191147, decouple_loss:0.0014298142632469535
loss_pred:0.016947705298662186, decouple_loss:0.0014283553464338183
The modified gen p mean: 0.45226433873176575, gen p mean: -0.03654296323657036, mean p set: 0.45274466276168823
loss_pred:0.01707734726369381, decouple_loss:0.0013590093003585935
Iteration: 538, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4512425363063812, gen p mean: -0.04368998855352402, mean p set: 0.4517228305339813
The modified gen p mean: 0.4514394700527191, gen p mean: -0.03703931346535683, mean p set: 0.4519197940826416
loss_pred:0.017092155292630196, decouple_loss:0.0014062622794881463
loss_pred:0.016600780189037323, decouple_loss:0.001476410310715437
The modified gen p mean: 0.45178744196891785, gen p mean: -0.04065202176570892, mean p set: 0.45226770639419556
loss_pred:0.01617509126663208, decouple_loss:0.0013835150748491287
Iteration: 539, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45174500346183777, gen p mean: -0.03731319308280945, mean p set: 0.45222529768943787
loss_pred:0.01692652888596058, decouple_loss:0.0012991187395527959
The modified gen p mean: 0.4505658447742462, gen p mean: -0.03995365649461746, mean p set: 0.4510461390018463The modified gen p mean: 0.4511440396308899, gen p mean: -0.04150377959012985, mean p set: 0.45162433385849
loss_pred:0.017328180372714996, decouple_loss:0.0013556022895500064
loss_pred:0.017073696479201317, decouple_loss:0.001376663101837039
Iteration: 540, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45156580209732056, gen p mean: -0.0417989045381546, mean p set: 0.45204612612724304
The modified gen p mean: 0.4513148069381714, gen p mean: -0.03628182411193848, mean p set: 0.4517951011657715
loss_pred:0.01597893238067627, decouple_loss:0.0012987196678295732
loss_pred:0.016785284504294395, decouple_loss:0.0012844485463574529
The modified gen p mean: 0.4516027867794037, gen p mean: -0.03481443598866463, mean p set: 0.4520830810070038
loss_pred:0.016520008444786072, decouple_loss:0.0013078083284199238
2023-05-01 07:35:53 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.046350233256816864, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04251221939921379, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.0427246168255806, mean p set: 0.4500633478164673
loss_pred:0.01888718456029892, decouple_loss:0.0015854125376790762
loss_pred:0.017747947946190834, decouple_loss:0.0015450716018676758
loss_pred:0.017888644710183144, decouple_loss:0.0014738345053046942
WV_0_PC_1_EH_0_PS_40, loss: 0.0182513315230608, avg_mse: 0.026390142738819122
current test mse: 0.02639
Iteration: 541, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.452554315328598, gen p mean: -0.044183723628520966, mean p set: 0.4530346095561981
The modified gen p mean: 0.4501608610153198, gen p mean: -0.03810279071331024, mean p set: 0.45064112544059753
The modified gen p mean: 0.4502146244049072, gen p mean: -0.03696329519152641, mean p set: 0.4506949186325073
loss_pred:0.01693074218928814, decouple_loss:0.0013624172424897552
loss_pred:0.015713077038526535, decouple_loss:0.001401779125444591
loss_pred:0.017112160101532936, decouple_loss:0.0013188233133405447
Iteration: 542, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507308900356293, gen p mean: -0.030399499461054802, mean p set: 0.45121118426322937
loss_pred:0.01706189662218094, decouple_loss:0.0014808657579123974
The modified gen p mean: 0.45070749521255493, gen p mean: -0.04045464098453522, mean p set: 0.45118778944015503The modified gen p mean: 0.4505062401294708, gen p mean: -0.03825248405337334, mean p set: 0.45098650455474854
loss_pred:0.015434435568749905, decouple_loss:0.001336373621597886
loss_pred:0.016326112672686577, decouple_loss:0.0013834466226398945
Iteration: 543, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514380693435669, gen p mean: -0.04226171225309372, mean p set: 0.451918363571167
loss_pred:0.01570134051144123, decouple_loss:0.0012702065287157893
The modified gen p mean: 0.45111456513404846, gen p mean: -0.038057997822761536, mean p set: 0.45159485936164856The modified gen p mean: 0.4532906711101532, gen p mean: -0.035709626972675323, mean p set: 0.4537709653377533
loss_pred:0.01547829620540142, decouple_loss:0.001199522870592773
loss_pred:0.016339588910341263, decouple_loss:0.0012268784921616316
Iteration: 544, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45145928859710693, gen p mean: -0.03706514462828636, mean p set: 0.45193958282470703
loss_pred:0.015861855819821358, decouple_loss:0.0013306818436831236
The modified gen p mean: 0.45270445942878723, gen p mean: -0.038391295820474625, mean p set: 0.45318475365638733The modified gen p mean: 0.452044278383255, gen p mean: -0.0372212789952755, mean p set: 0.4525245428085327
loss_pred:0.015326694585382938, decouple_loss:0.001198106212541461
loss_pred:0.015557625330984592, decouple_loss:0.0013608428416773677
Iteration: 545, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511578679084778, gen p mean: -0.035656120628118515, mean p set: 0.4516381621360779
loss_pred:0.016730498522520065, decouple_loss:0.0014555546222254634
The modified gen p mean: 0.45327654480934143, gen p mean: -0.041278209537267685, mean p set: 0.4537568688392639The modified gen p mean: 0.4507941007614136, gen p mean: -0.04333789274096489, mean p set: 0.45127442479133606
loss_pred:0.01580938883125782, decouple_loss:0.0014745034277439117
loss_pred:0.016602545976638794, decouple_loss:0.0015188540564849973
Iteration: 546, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4510784447193146, gen p mean: -0.03978733345866203, mean p set: 0.4515587389469147
loss_pred:0.0165545754134655, decouple_loss:0.0013447883538901806
The modified gen p mean: 0.4522475302219391, gen p mean: -0.03654495254158974, mean p set: 0.4527277946472168The modified gen p mean: 0.4511788487434387, gen p mean: -0.0449337400496006, mean p set: 0.4516591429710388
loss_pred:0.017007870599627495, decouple_loss:0.0013760317815467715
loss_pred:0.01592387445271015, decouple_loss:0.001323278178460896
Iteration: 547, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4506503641605377, gen p mean: -0.04464394226670265, mean p set: 0.4511306881904602
loss_pred:0.015918675810098648, decouple_loss:0.001180973369628191
The modified gen p mean: 0.45021769404411316, gen p mean: -0.04583245888352394, mean p set: 0.45069798827171326The modified gen p mean: 0.45244091749191284, gen p mean: -0.03613739833235741, mean p set: 0.45292118191719055
loss_pred:0.016866371035575867, decouple_loss:0.0012645728420466185
loss_pred:0.01563776098191738, decouple_loss:0.0011999515118077397
Iteration: 548, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44989460706710815, gen p mean: -0.049730025231838226, mean p set: 0.45037490129470825
loss_pred:0.016697056591510773, decouple_loss:0.0013182958355173469
The modified gen p mean: 0.45160067081451416, gen p mean: -0.04391802102327347, mean p set: 0.45208099484443665The modified gen p mean: 0.45239225029945374, gen p mean: -0.04699331894516945, mean p set: 0.45287254452705383
loss_pred:0.016275908797979355, decouple_loss:0.0012772055342793465
loss_pred:0.016515428200364113, decouple_loss:0.0013435421278700233
Iteration: 549, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45112621784210205, gen p mean: -0.046201083809137344, mean p set: 0.45160651206970215
loss_pred:0.016890650615096092, decouple_loss:0.001512336079031229
The modified gen p mean: 0.45201635360717773, gen p mean: -0.04094533249735832, mean p set: 0.4524966776371002The modified gen p mean: 0.4534396529197693, gen p mean: -0.04900958389043808, mean p set: 0.4539199471473694
loss_pred:0.016998160630464554, decouple_loss:0.001515538664534688
loss_pred:0.015399894677102566, decouple_loss:0.0014071225887164474
Iteration: 550, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4522682726383209, gen p mean: -0.04706883430480957, mean p set: 0.4527485966682434
loss_pred:0.016347190365195274, decouple_loss:0.0012646863469853997
The modified gen p mean: 0.4514700770378113, gen p mean: -0.0489441379904747, mean p set: 0.45195040106773376The modified gen p mean: 0.4525368809700012, gen p mean: -0.04688325524330139, mean p set: 0.45301714539527893
loss_pred:0.016476444900035858, decouple_loss:0.0012608985416591167
loss_pred:0.015686390921473503, decouple_loss:0.0013544735265895724
2023-05-01 07:37:46 testing...
The modified gen p mean: 0.44987666606903076, gen p mean: -0.05261019617319107, mean p set: 0.45035696029663086
The modified gen p mean: 0.449788898229599, gen p mean: -0.05676821246743202, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830535888672, gen p mean: -0.05269455909729004, mean p set: 0.4500633478164673
loss_pred:0.017595341429114342, decouple_loss:0.0016967541305348277
loss_pred:0.018739985302090645, decouple_loss:0.0016330619109794497
loss_pred:0.017751218751072884, decouple_loss:0.0016104317037388682
WV_0_PC_1_EH_0_PS_40, loss: 0.01811118796467781, avg_mse: 0.02613258734345436
current test mse: 0.026133
Iteration: 551, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4516121447086334, gen p mean: -0.047883644700050354, mean p set: 0.45209240913391113
The modified gen p mean: 0.4538593888282776, gen p mean: -0.05014199763536453, mean p set: 0.4543396830558777
The modified gen p mean: 0.450717568397522, gen p mean: -0.04115566238760948, mean p set: 0.45119786262512207
loss_pred:0.01648542284965515, decouple_loss:0.0015249564312398434
loss_pred:0.016198154538869858, decouple_loss:0.0013728848425671458
loss_pred:0.016196077689528465, decouple_loss:0.001415362348780036
Iteration: 552, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45226389169692993, gen p mean: -0.0485159233212471, mean p set: 0.45274418592453003
loss_pred:0.015525133349001408, decouple_loss:0.0012364003341645002
The modified gen p mean: 0.45206692814826965, gen p mean: -0.048965681344270706, mean p set: 0.45254722237586975The modified gen p mean: 0.4506472647190094, gen p mean: -0.043590664863586426, mean p set: 0.4511275291442871
loss_pred:0.015691079199314117, decouple_loss:0.0012211368884891272
loss_pred:0.017313316464424133, decouple_loss:0.0012632098514586687
Iteration: 553, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513789713382721, gen p mean: -0.04431568831205368, mean p set: 0.4518592655658722
loss_pred:0.017157113179564476, decouple_loss:0.0012753693154081702
The modified gen p mean: 0.45160356163978577, gen p mean: -0.04859777167439461, mean p set: 0.4520838260650635The modified gen p mean: 0.45117104053497314, gen p mean: -0.048849619925022125, mean p set: 0.45165136456489563
loss_pred:0.016479015350341797, decouple_loss:0.0013305427273735404
loss_pred:0.01593645103275776, decouple_loss:0.001279959105886519
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012013_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012013_3_24hr.npz
NaN value num: 0
Iteration: 554, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44652870297431946, gen p mean: -0.0540337860584259, mean p set: 0.44700896739959717
loss_pred:0.014225824736058712, decouple_loss:0.0014346251264214516
The modified gen p mean: 0.4466029703617096, gen p mean: -0.050740525126457214, mean p set: 0.4470832645893097The modified gen p mean: 0.4455907940864563, gen p mean: -0.05071670189499855, mean p set: 0.4460710883140564
loss_pred:0.013740316033363342, decouple_loss:0.0014996810350567102
loss_pred:0.013963764533400536, decouple_loss:0.0013624521670863032
Iteration: 555, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44666650891304016, gen p mean: -0.05530724301934242, mean p set: 0.44714680314064026
loss_pred:0.014607247896492481, decouple_loss:0.0014008722500875592
The modified gen p mean: 0.44678181409835815, gen p mean: -0.053412314504384995, mean p set: 0.44726207852363586The modified gen p mean: 0.44674399495124817, gen p mean: -0.05613911151885986, mean p set: 0.44722431898117065
loss_pred:0.014326153323054314, decouple_loss:0.0013754955725744367
loss_pred:0.01441226713359356, decouple_loss:0.0012877759290859103
Iteration: 556, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44624581933021545, gen p mean: -0.05027491971850395, mean p set: 0.44672611355781555
loss_pred:0.014183348044753075, decouple_loss:0.0013871138216927648
The modified gen p mean: 0.44574326276779175, gen p mean: -0.050817329436540604, mean p set: 0.44622352719306946The modified gen p mean: 0.4463469684123993, gen p mean: -0.04918644577264786, mean p set: 0.4468272626399994
loss_pred:0.014147069305181503, decouple_loss:0.0015336970100179315
loss_pred:0.013932038098573685, decouple_loss:0.001655804575420916
Iteration: 557, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44668835401535034, gen p mean: -0.044794339686632156, mean p set: 0.44716861844062805
loss_pred:0.013906802982091904, decouple_loss:0.0015215923776850104
The modified gen p mean: 0.44626617431640625, gen p mean: -0.0448409728705883, mean p set: 0.44674646854400635The modified gen p mean: 0.4475097358226776, gen p mean: -0.045416444540023804, mean p set: 0.4479900598526001
loss_pred:0.01434444822371006, decouple_loss:0.0014558729017153382
loss_pred:0.013530144467949867, decouple_loss:0.0013885714579373598
Iteration: 558, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4456627666950226, gen p mean: -0.043347351253032684, mean p set: 0.4461430609226227
The modified gen p mean: 0.44607841968536377, gen p mean: -0.04170019552111626, mean p set: 0.4465586841106415
loss_pred:0.014194834046065807, decouple_loss:0.0015244805254042149
loss_pred:0.014240162447094917, decouple_loss:0.0014100404223427176
The modified gen p mean: 0.4472411274909973, gen p mean: -0.04812739044427872, mean p set: 0.4477214217185974
loss_pred:0.013837541453540325, decouple_loss:0.0013548602582886815
Iteration: 559, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44773462414741516, gen p mean: -0.037666674703359604, mean p set: 0.44821488857269287
loss_pred:0.013922118581831455, decouple_loss:0.0013745884643867612
The modified gen p mean: 0.4464870095252991, gen p mean: -0.04041976109147072, mean p set: 0.44696730375289917
The modified gen p mean: 0.4474034011363983, gen p mean: -0.04038690775632858, mean p set: 0.447883665561676
loss_pred:0.013558519072830677, decouple_loss:0.0013521487126126885
loss_pred:0.014134448952972889, decouple_loss:0.0013429062673822045
Iteration: 560, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44724833965301514, gen p mean: -0.03813408315181732, mean p set: 0.44772863388061523
The modified gen p mean: 0.4469756484031677, gen p mean: -0.03728099167346954, mean p set: 0.44745591282844543
loss_pred:0.013629760593175888, decouple_loss:0.001452475436963141
loss_pred:0.014015738852322102, decouple_loss:0.0014095902442932129
The modified gen p mean: 0.44795098900794983, gen p mean: -0.04203619807958603, mean p set: 0.4484312832355499
loss_pred:0.013821697793900967, decouple_loss:0.001628211815841496
2023-05-01 07:40:16 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.043843287974596024, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.040074482560157776, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04002745449542999, mean p set: 0.4500633478164673
loss_pred:0.019232213497161865, decouple_loss:0.0014298445312306285
loss_pred:0.018023479729890823, decouple_loss:0.0014551602071151137
loss_pred:0.018185080960392952, decouple_loss:0.0014305075164884329
WV_0_PC_1_EH_0_PS_40, loss: 0.018552184104919434, avg_mse: 0.026997035369277
current test mse: 0.026997
Iteration: 561, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466501772403717, gen p mean: -0.043827466666698456, mean p set: 0.4471304714679718
The modified gen p mean: 0.4461185932159424, gen p mean: -0.041501086205244064, mean p set: 0.44659891724586487
The modified gen p mean: 0.44590479135513306, gen p mean: -0.04008111357688904, mean p set: 0.44638508558273315
loss_pred:0.013605247251689434, decouple_loss:0.0013405978679656982
loss_pred:0.01384926587343216, decouple_loss:0.001358057837933302
loss_pred:0.013880358077585697, decouple_loss:0.0015388006577268243
Iteration: 562, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473629593849182, gen p mean: -0.04817056655883789, mean p set: 0.4478432536125183
The modified gen p mean: 0.4476061463356018, gen p mean: -0.04410061240196228, mean p set: 0.4480864405632019
loss_pred:0.013914482668042183, decouple_loss:0.0015038460260257125
loss_pred:0.013651672750711441, decouple_loss:0.001672451733611524The modified gen p mean: 0.4475902318954468, gen p mean: -0.04330943524837494, mean p set: 0.4480704963207245
loss_pred:0.013727198354899883, decouple_loss:0.0017134420340880752
Iteration: 563, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44784975051879883, gen p mean: -0.04865508899092674, mean p set: 0.4483300447463989
The modified gen p mean: 0.44651859998703003, gen p mean: -0.0455767847597599, mean p set: 0.4469989240169525
loss_pred:0.013893037103116512, decouple_loss:0.0012993615819141269
loss_pred:0.013640898279845715, decouple_loss:0.0014397806953638792
The modified gen p mean: 0.4475697875022888, gen p mean: -0.05217717960476875, mean p set: 0.4480500817298889
loss_pred:0.013074065558612347, decouple_loss:0.0014103101566433907
Iteration: 564, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476163685321808, gen p mean: -0.04568993300199509, mean p set: 0.4480966627597809
The modified gen p mean: 0.44720005989074707, gen p mean: -0.04704132303595543, mean p set: 0.44768035411834717
loss_pred:0.013788583688437939, decouple_loss:0.001317519461736083
loss_pred:0.013207599520683289, decouple_loss:0.0013453213032335043
The modified gen p mean: 0.44661709666252136, gen p mean: -0.047033317387104034, mean p set: 0.44709739089012146
loss_pred:0.014023707248270512, decouple_loss:0.0013419425813481212
Iteration: 565, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447532594203949, gen p mean: -0.0505245178937912, mean p set: 0.4480128884315491
The modified gen p mean: 0.44771623611450195, gen p mean: -0.04726944491267204, mean p set: 0.44819650053977966
loss_pred:0.014499305747449398, decouple_loss:0.0014095824444666505
loss_pred:0.013161208480596542, decouple_loss:0.0012927822535857558
The modified gen p mean: 0.4459882080554962, gen p mean: -0.05074799060821533, mean p set: 0.4464685022830963
loss_pred:0.01385955698788166, decouple_loss:0.0014747940003871918
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 566, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44630762934684753, gen p mean: -0.04627533629536629, mean p set: 0.44678789377212524
The modified gen p mean: 0.44708752632141113, gen p mean: -0.048625797033309937, mean p set: 0.44756782054901123
loss_pred:0.012994935736060143, decouple_loss:0.001294245827011764
loss_pred:0.013316831551492214, decouple_loss:0.0012889500940218568
The modified gen p mean: 0.4467221200466156, gen p mean: -0.046135321259498596, mean p set: 0.4472024440765381
loss_pred:0.013837016187608242, decouple_loss:0.0013182931579649448
Iteration: 567, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465849697589874, gen p mean: -0.04922705888748169, mean p set: 0.44706523418426514
The modified gen p mean: 0.44701576232910156, gen p mean: -0.045356303453445435, mean p set: 0.44749605655670166
loss_pred:0.013691811822354794, decouple_loss:0.001266313367523253
The modified gen p mean: 0.44704368710517883, gen p mean: -0.04652654752135277, mean p set: 0.44752398133277893loss_pred:0.013289721682667732, decouple_loss:0.0014629537472501397
loss_pred:0.013473503291606903, decouple_loss:0.0014502406120300293
Iteration: 568, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474562108516693, gen p mean: -0.04372550547122955, mean p set: 0.4479365348815918
The modified gen p mean: 0.4471098482608795, gen p mean: -0.04620970040559769, mean p set: 0.4475901126861572
loss_pred:0.013920214958488941, decouple_loss:0.0013310170033946633
loss_pred:0.013645841740071774, decouple_loss:0.0013516034232452512
The modified gen p mean: 0.44654762744903564, gen p mean: -0.04257167503237724, mean p set: 0.44702792167663574
loss_pred:0.013499289751052856, decouple_loss:0.0014328991528600454
Iteration: 569, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470585584640503, gen p mean: -0.04569777846336365, mean p set: 0.4475388824939728
The modified gen p mean: 0.4462556838989258, gen p mean: -0.04812408983707428, mean p set: 0.4467359483242035
loss_pred:0.013394404202699661, decouple_loss:0.0013116876361891627
loss_pred:0.013449293561279774, decouple_loss:0.001450135256163776
The modified gen p mean: 0.44697433710098267, gen p mean: -0.05074113979935646, mean p set: 0.44745466113090515
loss_pred:0.013456108048558235, decouple_loss:0.0012929901713505387
Iteration: 570, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4458150565624237, gen p mean: -0.04635371267795563, mean p set: 0.4462953209877014
The modified gen p mean: 0.44725650548934937, gen p mean: -0.04715760424733162, mean p set: 0.44773682951927185
loss_pred:0.01321270689368248, decouple_loss:0.0012195415329188108
loss_pred:0.013500397093594074, decouple_loss:0.0012179659679532051
The modified gen p mean: 0.44653964042663574, gen p mean: -0.046463534235954285, mean p set: 0.4470199644565582
loss_pred:0.013854366727173328, decouple_loss:0.0011638615978881717
2023-05-01 07:42:09 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.05007535591721535, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04618148133158684, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.04623471200466156, mean p set: 0.4500633478164673
loss_pred:0.019125331193208694, decouple_loss:0.001427889452315867
loss_pred:0.017977027222514153, decouple_loss:0.0013333422830328345
loss_pred:0.018053146079182625, decouple_loss:0.0013108574785292149
WV_0_PC_1_EH_0_PS_40, loss: 0.01845303736627102, avg_mse: 0.026859156787395477
current test mse: 0.026859
Iteration: 571, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4463847279548645, gen p mean: -0.04663129523396492, mean p set: 0.4468649923801422
The modified gen p mean: 0.4469921588897705, gen p mean: -0.05259469524025917, mean p set: 0.4474724233150482
The modified gen p mean: 0.44677555561065674, gen p mean: -0.05181453004479408, mean p set: 0.44725584983825684
loss_pred:0.013411277905106544, decouple_loss:0.0013017042074352503
loss_pred:0.013879562728106976, decouple_loss:0.0012068809010088444
loss_pred:0.013665786013007164, decouple_loss:0.001403407659381628
Iteration: 572, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44695645570755005, gen p mean: -0.05296716094017029, mean p set: 0.44743674993515015
The modified gen p mean: 0.44622835516929626, gen p mean: -0.04449114575982094, mean p set: 0.446708619594574
loss_pred:0.013477640226483345, decouple_loss:0.0013333434471860528
loss_pred:0.01380171813070774, decouple_loss:0.0014732256531715393
The modified gen p mean: 0.4465055465698242, gen p mean: -0.04745190218091011, mean p set: 0.4469858705997467
loss_pred:0.013614470139145851, decouple_loss:0.0015516143757849932
Iteration: 573, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44697147607803345, gen p mean: -0.045991748571395874, mean p set: 0.44745174050331116
loss_pred:0.013491935096681118, decouple_loss:0.0014024304691702127
The modified gen p mean: 0.4474700093269348, gen p mean: -0.048348937183618546, mean p set: 0.4479503035545349The modified gen p mean: 0.4472186267375946, gen p mean: -0.04834591597318649, mean p set: 0.4476989209651947
loss_pred:0.012593877501785755, decouple_loss:0.0012719478690996766
loss_pred:0.013535301201045513, decouple_loss:0.001336109358817339
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012014_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012014_3_24hr.npz
NaN value num: 0
Iteration: 574, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44718873500823975, gen p mean: -0.04628240689635277, mean p set: 0.44766902923583984
loss_pred:0.0137766283005476, decouple_loss:0.0014157883124426007
The modified gen p mean: 0.4464482367038727, gen p mean: -0.04593735933303833, mean p set: 0.44692856073379517The modified gen p mean: 0.44689762592315674, gen p mean: -0.04405544698238373, mean p set: 0.44737792015075684
loss_pred:0.013812084682285786, decouple_loss:0.0013565808767452836
loss_pred:0.013966438360512257, decouple_loss:0.0012753738556057215
Iteration: 575, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4460561275482178, gen p mean: -0.04773357883095741, mean p set: 0.44653645157814026
loss_pred:0.013404260389506817, decouple_loss:0.0013030186528339982
The modified gen p mean: 0.44727882742881775, gen p mean: -0.0491257905960083, mean p set: 0.44775912165641785The modified gen p mean: 0.4464617967605591, gen p mean: -0.047498080879449844, mean p set: 0.4469420909881592
loss_pred:0.014562861993908882, decouple_loss:0.0012917250860482454
loss_pred:0.014359421096742153, decouple_loss:0.0012853130465373397
Iteration: 576, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465339481830597, gen p mean: -0.04471144452691078, mean p set: 0.4470142424106598
loss_pred:0.01379520632326603, decouple_loss:0.0012610823614522815
The modified gen p mean: 0.4474382996559143, gen p mean: -0.04673628881573677, mean p set: 0.447918564081192The modified gen p mean: 0.4476187825202942, gen p mean: -0.04877418652176857, mean p set: 0.4480991065502167
loss_pred:0.013209567405283451, decouple_loss:0.001379870343953371
loss_pred:0.013966812752187252, decouple_loss:0.0013125480618327856
Iteration: 577, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44739457964897156, gen p mean: -0.04827836900949478, mean p set: 0.44787484407424927
The modified gen p mean: 0.4466998875141144, gen p mean: -0.05413660407066345, mean p set: 0.4471801817417145
loss_pred:0.013790134340524673, decouple_loss:0.0013144968543201685
loss_pred:0.014173917472362518, decouple_loss:0.0013655642978847027
The modified gen p mean: 0.4469756782054901, gen p mean: -0.04921596124768257, mean p set: 0.4474559724330902
loss_pred:0.013383879326283932, decouple_loss:0.001258158590644598
Iteration: 578, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44548192620277405, gen p mean: -0.05344455689191818, mean p set: 0.44596222043037415
The modified gen p mean: 0.4480176568031311, gen p mean: -0.051156576722860336, mean p set: 0.4484979510307312
loss_pred:0.013644245453178883, decouple_loss:0.0015927046770229936
loss_pred:0.014051678590476513, decouple_loss:0.0014110273914411664
The modified gen p mean: 0.44595468044281006, gen p mean: -0.05183624476194382, mean p set: 0.44643494486808777
loss_pred:0.013455947861075401, decouple_loss:0.0014014755142852664
Iteration: 579, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44622841477394104, gen p mean: -0.05218503624200821, mean p set: 0.4467087388038635
loss_pred:0.01391754113137722, decouple_loss:0.0011980747804045677
The modified gen p mean: 0.44649195671081543, gen p mean: -0.05348658561706543, mean p set: 0.4469722807407379The modified gen p mean: 0.44583743810653687, gen p mean: -0.05394652858376503, mean p set: 0.44631776213645935
loss_pred:0.013727603480219841, decouple_loss:0.0011889823945239186
loss_pred:0.013380388729274273, decouple_loss:0.0011789199197664857
Iteration: 580, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477819502353668, gen p mean: -0.05325080454349518, mean p set: 0.4482622444629669
loss_pred:0.013931327499449253, decouple_loss:0.001317798625677824
The modified gen p mean: 0.4462399482727051, gen p mean: -0.05010151118040085, mean p set: 0.4467202425003052The modified gen p mean: 0.44601970911026, gen p mean: -0.052250806242227554, mean p set: 0.4465000033378601
loss_pred:0.013872730545699596, decouple_loss:0.001375994412228465
loss_pred:0.013545637018978596, decouple_loss:0.0011383926030248404
2023-05-01 07:44:41 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.05323129519820213, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04931279644370079, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04966118186712265, mean p set: 0.4500633478164673
loss_pred:0.019218027591705322, decouple_loss:0.0014404179528355598
loss_pred:0.01807369291782379, decouple_loss:0.0013666346203535795
loss_pred:0.01813669316470623, decouple_loss:0.0013103487435728312
WV_0_PC_1_EH_0_PS_40, loss: 0.018544761463999748, avg_mse: 0.0270468071103096
current test mse: 0.027047
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 581, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467596709728241, gen p mean: -0.047257017344236374, mean p set: 0.4472399353981018
The modified gen p mean: 0.4475046992301941, gen p mean: -0.052978210151195526, mean p set: 0.4479850232601166
The modified gen p mean: 0.44654616713523865, gen p mean: -0.049392204731702805, mean p set: 0.44702646136283875
loss_pred:0.013607574626803398, decouple_loss:0.0014716906007379293
loss_pred:0.013981412164866924, decouple_loss:0.001465474022552371loss_pred:0.013870748691260815, decouple_loss:0.0012933065881952643
Iteration: 582, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472518265247345, gen p mean: -0.04949723929166794, mean p set: 0.447732150554657
loss_pred:0.01356002688407898, decouple_loss:0.001251506619155407
The modified gen p mean: 0.4466250538825989, gen p mean: -0.05029359087347984, mean p set: 0.447105348110199The modified gen p mean: 0.4464503824710846, gen p mean: -0.05266549065709114, mean p set: 0.4469307065010071
loss_pred:0.01419750601053238, decouple_loss:0.0013031666167080402
loss_pred:0.013818737119436264, decouple_loss:0.0012202734360471368
Iteration: 583, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44750991463661194, gen p mean: -0.05050427094101906, mean p set: 0.44799020886421204
loss_pred:0.013570358976721764, decouple_loss:0.001194838434457779
The modified gen p mean: 0.44529393315315247, gen p mean: -0.052203837782144547, mean p set: 0.4457741975784302The modified gen p mean: 0.4480317533016205, gen p mean: -0.0530160591006279, mean p set: 0.44851207733154297
loss_pred:0.013201035559177399, decouple_loss:0.0013386289356276393
loss_pred:0.01355835609138012, decouple_loss:0.0013423939235508442
Iteration: 584, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44656628370285034, gen p mean: -0.052592094987630844, mean p set: 0.44704657793045044
loss_pred:0.013827660121023655, decouple_loss:0.0012236264301463962
The modified gen p mean: 0.44619378447532654, gen p mean: -0.05011875554919243, mean p set: 0.44667407870292664The modified gen p mean: 0.44623321294784546, gen p mean: -0.048703014850616455, mean p set: 0.44671353697776794
loss_pred:0.014048222452402115, decouple_loss:0.0013145506381988525
loss_pred:0.014292266219854355, decouple_loss:0.0011668947990983725
Iteration: 585, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4459005892276764, gen p mean: -0.04997044429183006, mean p set: 0.4463808834552765
loss_pred:0.013388293795287609, decouple_loss:0.0011933130444958806
The modified gen p mean: 0.4459228217601776, gen p mean: -0.048909712582826614, mean p set: 0.4464031159877777The modified gen p mean: 0.4467129707336426, gen p mean: -0.05220121890306473, mean p set: 0.4471932351589203
loss_pred:0.013661027885973454, decouple_loss:0.0011727086966857314
loss_pred:0.013864526525139809, decouple_loss:0.0012136523146182299
Iteration: 586, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4458337724208832, gen p mean: -0.046078816056251526, mean p set: 0.4463140368461609
loss_pred:0.01364897657185793, decouple_loss:0.001138661289587617
The modified gen p mean: 0.44761812686920166, gen p mean: -0.04862114414572716, mean p set: 0.44809842109680176The modified gen p mean: 0.4457559883594513, gen p mean: -0.048547662794589996, mean p set: 0.4462362825870514
loss_pred:0.013397429138422012, decouple_loss:0.0010847109369933605
loss_pred:0.013446095399558544, decouple_loss:0.0013623774284496903
Iteration: 587, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480520784854889, gen p mean: -0.049994923174381256, mean p set: 0.448532372713089
loss_pred:0.013514132238924503, decouple_loss:0.0011692370753735304
The modified gen p mean: 0.4465043246746063, gen p mean: -0.05134766548871994, mean p set: 0.4469846189022064The modified gen p mean: 0.4456821382045746, gen p mean: -0.04759317263960838, mean p set: 0.44616246223449707
loss_pred:0.01400794554501772, decouple_loss:0.001140702748671174
loss_pred:0.013940959237515926, decouple_loss:0.0011176889529451728
Iteration: 588, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468311369419098, gen p mean: -0.04896068945527077, mean p set: 0.4473114311695099
loss_pred:0.013183260336518288, decouple_loss:0.0012349799508228898
The modified gen p mean: 0.445599764585495, gen p mean: -0.053388528525829315, mean p set: 0.4460800588130951The modified gen p mean: 0.44607147574424744, gen p mean: -0.05063183605670929, mean p set: 0.44655176997184753
loss_pred:0.013344398699700832, decouple_loss:0.001385386218316853
loss_pred:0.013801546767354012, decouple_loss:0.0012522514443844557
Iteration: 589, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484091103076935, gen p mean: -0.0513039231300354, mean p set: 0.44888943433761597
loss_pred:0.01363081019371748, decouple_loss:0.0011420395458117127
The modified gen p mean: 0.44653698801994324, gen p mean: -0.050211045891046524, mean p set: 0.4470173120498657The modified gen p mean: 0.44647157192230225, gen p mean: -0.053526870906353, mean p set: 0.44695183634757996
loss_pred:0.013548599556088448, decouple_loss:0.0010437798919156194
loss_pred:0.013605245389044285, decouple_loss:0.00110915070399642
Iteration: 590, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44759777188301086, gen p mean: -0.049300506711006165, mean p set: 0.44807806611061096
loss_pred:0.01375089306384325, decouple_loss:0.0012272574240341783
The modified gen p mean: 0.44677507877349854, gen p mean: -0.04934453219175339, mean p set: 0.44725537300109863The modified gen p mean: 0.44631731510162354, gen p mean: -0.0504654161632061, mean p set: 0.44679760932922363
loss_pred:0.013874565251171589, decouple_loss:0.0012464304454624653
loss_pred:0.013262338005006313, decouple_loss:0.0012701357482001185
2023-05-01 07:46:34 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.05100107938051224, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.047032393515110016, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.047392554581165314, mean p set: 0.4500633478164673
loss_pred:0.019165650010108948, decouple_loss:0.001202254556119442
loss_pred:0.018066924065351486, decouple_loss:0.0011766639072448015
loss_pred:0.01815684139728546, decouple_loss:0.0012028751662001014
WV_0_PC_1_EH_0_PS_40, loss: 0.018522834405303, avg_mse: 0.027043910697102547
current test mse: 0.027044
Iteration: 591, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44696757197380066, gen p mean: -0.04741210862994194, mean p set: 0.44744786620140076
The modified gen p mean: 0.44740718603134155, gen p mean: -0.046995822340250015, mean p set: 0.44788745045661926
The modified gen p mean: 0.44765180349349976, gen p mean: -0.049498651176691055, mean p set: 0.44813206791877747
loss_pred:0.013697071932256222, decouple_loss:0.0010325266048312187
loss_pred:0.013765447773039341, decouple_loss:0.001087257987819612loss_pred:0.013759852387011051, decouple_loss:0.001187170622870326
Iteration: 592, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44703683257102966, gen p mean: -0.053288280963897705, mean p set: 0.44751712679862976
loss_pred:0.013644693419337273, decouple_loss:0.0010756483534350991
The modified gen p mean: 0.44665437936782837, gen p mean: -0.04928912967443466, mean p set: 0.44713470339775085The modified gen p mean: 0.4479432702064514, gen p mean: -0.05009818449616432, mean p set: 0.4484235644340515
loss_pred:0.013798407278954983, decouple_loss:0.00102166214492172
loss_pred:0.01310251746326685, decouple_loss:0.0010673487558960915
Iteration: 593, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465695023536682, gen p mean: -0.05020789057016373, mean p set: 0.4470498263835907
loss_pred:0.012919680215418339, decouple_loss:0.0011334930313751101
The modified gen p mean: 0.44621577858924866, gen p mean: -0.04518336430191994, mean p set: 0.44669607281684875The modified gen p mean: 0.44592297077178955, gen p mean: -0.04895206168293953, mean p set: 0.44640329480171204
loss_pred:0.01329503022134304, decouple_loss:0.0011309237452223897
loss_pred:0.013577082194387913, decouple_loss:0.0011085642036050558
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012009_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012009_3_24hr.npz
NaN value num: 0
Iteration: 594, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.451077401638031, gen p mean: -0.03304778039455414, mean p set: 0.4515576958656311
loss_pred:0.017606554552912712, decouple_loss:0.0012644826201722026
The modified gen p mean: 0.45256805419921875, gen p mean: -0.043072279542684555, mean p set: 0.45304831862449646The modified gen p mean: 0.4514826536178589, gen p mean: -0.03909861668944359, mean p set: 0.4519629180431366
loss_pred:0.01817292347550392, decouple_loss:0.0013341580051928759
loss_pred:0.017166323959827423, decouple_loss:0.0012375504011288285
Iteration: 595, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4515998959541321, gen p mean: -0.033310145139694214, mean p set: 0.4520801901817322
loss_pred:0.017395438626408577, decouple_loss:0.0012727861758321524
The modified gen p mean: 0.4513040781021118, gen p mean: -0.0364157035946846, mean p set: 0.4517843425273895The modified gen p mean: 0.4512985348701477, gen p mean: -0.03992282971739769, mean p set: 0.4517787992954254
loss_pred:0.019185204058885574, decouple_loss:0.0012021586298942566
loss_pred:0.01733480952680111, decouple_loss:0.0012134276330471039
Iteration: 596, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4519338011741638, gen p mean: -0.033723894506692886, mean p set: 0.4524140954017639
loss_pred:0.017587315291166306, decouple_loss:0.0012640260392799973
The modified gen p mean: 0.45078417658805847, gen p mean: -0.03422942012548447, mean p set: 0.45126447081565857The modified gen p mean: 0.45052945613861084, gen p mean: -0.03537595272064209, mean p set: 0.4510097801685333
loss_pred:0.01730744168162346, decouple_loss:0.001197783974930644
loss_pred:0.017408303916454315, decouple_loss:0.001199349295347929
Iteration: 597, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45097991824150085, gen p mean: -0.03297499194741249, mean p set: 0.45146021246910095
loss_pred:0.01714039407670498, decouple_loss:0.0012549777748063207
The modified gen p mean: 0.45186030864715576, gen p mean: -0.03400791436433792, mean p set: 0.45234063267707825The modified gen p mean: 0.45034295320510864, gen p mean: -0.0382349006831646, mean p set: 0.45082327723503113
loss_pred:0.01772141642868519, decouple_loss:0.0012587279779836535
loss_pred:0.018042990937829018, decouple_loss:0.0013075011083856225
Iteration: 598, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44956016540527344, gen p mean: -0.031145619228482246, mean p set: 0.45004045963287354
loss_pred:0.017375754192471504, decouple_loss:0.0012408547336235642
The modified gen p mean: 0.45090213418006897, gen p mean: -0.028302283957600594, mean p set: 0.45138245820999146The modified gen p mean: 0.4514698088169098, gen p mean: -0.028550541028380394, mean p set: 0.4519501030445099
loss_pred:0.017169924452900887, decouple_loss:0.0013047474203631282
loss_pred:0.01698950119316578, decouple_loss:0.0013428296661004424
Iteration: 599, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45242762565612793, gen p mean: -0.038790639489889145, mean p set: 0.452907919883728
loss_pred:0.01734711416065693, decouple_loss:0.0013659031828865409
The modified gen p mean: 0.45151910185813904, gen p mean: -0.03270835056900978, mean p set: 0.45199936628341675The modified gen p mean: 0.45069774985313416, gen p mean: -0.02994958497583866, mean p set: 0.45117807388305664
loss_pred:0.017911599949002266, decouple_loss:0.0013509886339306831
loss_pred:0.01754963956773281, decouple_loss:0.0013314989628270268
Iteration: 600, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.451202392578125, gen p mean: -0.03251458331942558, mean p set: 0.4516826570034027
loss_pred:0.01773100346326828, decouple_loss:0.0015176207525655627
The modified gen p mean: 0.45069530606269836, gen p mean: -0.03698599338531494, mean p set: 0.45117560029029846
The modified gen p mean: 0.4515032470226288, gen p mean: -0.03214184194803238, mean p set: 0.4519835412502289
loss_pred:0.016633545979857445, decouple_loss:0.0015506466152146459
loss_pred:0.016915282234549522, decouple_loss:0.001569088315591216
2023-05-01 07:49:04 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.046183742582798004, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.042317818850278854, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04237298294901848, mean p set: 0.4500633478164673
loss_pred:0.018553702160716057, decouple_loss:0.0016115335747599602
loss_pred:0.01750263199210167, decouple_loss:0.0016850011888891459
loss_pred:0.01753091625869274, decouple_loss:0.0015899809077382088
WV_0_PC_1_EH_0_PS_40, loss: 0.017943859100341797, avg_mse: 0.02577763982117176
current test mse: 0.025778
Iteration: 601, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4512511193752289, gen p mean: -0.03542079031467438, mean p set: 0.451731413602829
The modified gen p mean: 0.44851183891296387, gen p mean: -0.036860331892967224, mean p set: 0.44899213314056396
The modified gen p mean: 0.4503227770328522, gen p mean: -0.0391533300280571, mean p set: 0.45080307126045227
loss_pred:0.016995741054415703, decouple_loss:0.001598484581336379
loss_pred:0.01824195124208927, decouple_loss:0.0016030018450692296
loss_pred:0.016943005844950676, decouple_loss:0.0014976903330534697
Iteration: 602, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45106908679008484, gen p mean: -0.035934895277023315, mean p set: 0.4515494108200073
loss_pred:0.016850514337420464, decouple_loss:0.001449886243790388
The modified gen p mean: 0.4519680440425873, gen p mean: -0.036199308931827545, mean p set: 0.4524483382701874The modified gen p mean: 0.45360517501831055, gen p mean: -0.035776812583208084, mean p set: 0.45408543944358826
loss_pred:0.017270205542445183, decouple_loss:0.0014491166220977902
loss_pred:0.017991317436099052, decouple_loss:0.0013155477354303002
Iteration: 603, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45162591338157654, gen p mean: -0.03169785812497139, mean p set: 0.452106237411499
loss_pred:0.017164992168545723, decouple_loss:0.0013567950809374452
The modified gen p mean: 0.4505951404571533, gen p mean: -0.03490256145596504, mean p set: 0.4510754346847534The modified gen p mean: 0.4506705701351166, gen p mean: -0.038866590708494186, mean p set: 0.4511508643627167
loss_pred:0.017055345699191093, decouple_loss:0.001333982334472239
loss_pred:0.016343865543603897, decouple_loss:0.0012767512816935778
Iteration: 604, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494178593158722, gen p mean: -0.036167263984680176, mean p set: 0.4498981535434723
loss_pred:0.0164935365319252, decouple_loss:0.0015315597411245108
The modified gen p mean: 0.44912320375442505, gen p mean: -0.035120099782943726, mean p set: 0.44960349798202515The modified gen p mean: 0.45162829756736755, gen p mean: -0.03802468627691269, mean p set: 0.45210859179496765
loss_pred:0.01671774499118328, decouple_loss:0.0015480798901990056
loss_pred:0.016906477510929108, decouple_loss:0.00178351195063442
Iteration: 605, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4520045518875122, gen p mean: -0.0329936183989048, mean p set: 0.4524848163127899
loss_pred:0.0167702566832304, decouple_loss:0.0014520254917442799
The modified gen p mean: 0.44933655858039856, gen p mean: -0.03677823394536972, mean p set: 0.44981685280799866The modified gen p mean: 0.4511418342590332, gen p mean: -0.032126348465681076, mean p set: 0.4516221284866333
loss_pred:0.016775915399193764, decouple_loss:0.0013733218656852841
loss_pred:0.016565613448619843, decouple_loss:0.0013230533804744482
Iteration: 606, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45080241560935974, gen p mean: -0.031179197132587433, mean p set: 0.4512827396392822
loss_pred:0.017008652910590172, decouple_loss:0.0013984529068693519
The modified gen p mean: 0.4513959586620331, gen p mean: -0.039042845368385315, mean p set: 0.45187628269195557The modified gen p mean: 0.45093315839767456, gen p mean: -0.03620099276304245, mean p set: 0.45141345262527466
loss_pred:0.016900865361094475, decouple_loss:0.0014811414293944836
loss_pred:0.017606636509299278, decouple_loss:0.0014412745367735624
Iteration: 607, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45201241970062256, gen p mean: -0.04196050763130188, mean p set: 0.45249274373054504
loss_pred:0.017890362069010735, decouple_loss:0.0013413021806627512
The modified gen p mean: 0.45340844988822937, gen p mean: -0.04444442689418793, mean p set: 0.45388877391815186The modified gen p mean: 0.4510737657546997, gen p mean: -0.04460650682449341, mean p set: 0.4515541195869446
loss_pred:0.01651638001203537, decouple_loss:0.0012275379849597812
loss_pred:0.017297137528657913, decouple_loss:0.0014046459691599011
Iteration: 608, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501095116138458, gen p mean: -0.05058768391609192, mean p set: 0.4505898058414459
loss_pred:0.01750565506517887, decouple_loss:0.001322406344115734
The modified gen p mean: 0.4498218894004822, gen p mean: -0.043067511171102524, mean p set: 0.4503021836280823The modified gen p mean: 0.4496452510356903, gen p mean: -0.04779961705207825, mean p set: 0.4501255452632904
loss_pred:0.016594041138887405, decouple_loss:0.0012674976605921984
loss_pred:0.01626969501376152, decouple_loss:0.0012188805267214775
Iteration: 609, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44991493225097656, gen p mean: -0.04957348480820656, mean p set: 0.45039525628089905
loss_pred:0.01712646335363388, decouple_loss:0.0012196153402328491
The modified gen p mean: 0.4514462351799011, gen p mean: -0.05191921442747116, mean p set: 0.4519265294075012The modified gen p mean: 0.4499053955078125, gen p mean: -0.051180463284254074, mean p set: 0.4503856897354126
loss_pred:0.01753212884068489, decouple_loss:0.0013832018012180924
loss_pred:0.017401978373527527, decouple_loss:0.0013603653060272336
Iteration: 610, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507061541080475, gen p mean: -0.04546109959483147, mean p set: 0.4511864483356476
loss_pred:0.017123114317655563, decouple_loss:0.0012064771726727486
The modified gen p mean: 0.4502853751182556, gen p mean: -0.055648475885391235, mean p set: 0.4507656991481781The modified gen p mean: 0.45071613788604736, gen p mean: -0.05529981851577759, mean p set: 0.4511964023113251
loss_pred:0.017536992207169533, decouple_loss:0.0013369261287152767
loss_pred:0.016757844015955925, decouple_loss:0.0012869990896433592
2023-05-01 07:50:56 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.06046915799379349, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.056433796882629395, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.05646977201104164, mean p set: 0.4500633478164673
loss_pred:0.018424738198518753, decouple_loss:0.0013241826090961695
loss_pred:0.017372341826558113, decouple_loss:0.0012724798871204257
loss_pred:0.01745682768523693, decouple_loss:0.0012897487031295896
WV_0_PC_1_EH_0_PS_40, loss: 0.017816077917814255, avg_mse: 0.025515446439385414
current test mse: 0.025515
Iteration: 611, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45245257019996643, gen p mean: -0.05007604509592056, mean p set: 0.45293283462524414
The modified gen p mean: 0.4511569142341614, gen p mean: -0.0558180995285511, mean p set: 0.45163723826408386
The modified gen p mean: 0.44942522048950195, gen p mean: -0.05066191777586937, mean p set: 0.44990551471710205
loss_pred:0.016682995483279228, decouple_loss:0.001143106841482222
loss_pred:0.01718907058238983, decouple_loss:0.0011382718803361058
loss_pred:0.01713259145617485, decouple_loss:0.0012143217027187347
Iteration: 612, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45230787992477417, gen p mean: -0.050834137946367264, mean p set: 0.45278817415237427
The modified gen p mean: 0.45188799500465393, gen p mean: -0.04945453628897667, mean p set: 0.45236828923225403
loss_pred:0.018178585916757584, decouple_loss:0.0011909524910151958
loss_pred:0.018374228850007057, decouple_loss:0.001208091271109879
The modified gen p mean: 0.4483846127986908, gen p mean: -0.049473583698272705, mean p set: 0.4488649070262909
loss_pred:0.01667785458266735, decouple_loss:0.0012430993374437094
Iteration: 613, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45307889580726624, gen p mean: -0.045936305075883865, mean p set: 0.45355916023254395
loss_pred:0.017176566645503044, decouple_loss:0.0011431697057560086
The modified gen p mean: 0.4511520564556122, gen p mean: -0.04721326008439064, mean p set: 0.4516323506832123The modified gen p mean: 0.4503142237663269, gen p mean: -0.05232343450188637, mean p set: 0.450794517993927
loss_pred:0.017174679785966873, decouple_loss:0.0012286505661904812
loss_pred:0.016874192282557487, decouple_loss:0.0012506158091127872
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012006_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012006_3_24hr.npz
NaN value num: 0
Iteration: 614, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44835829734802246, gen p mean: -0.056352537125349045, mean p set: 0.44883859157562256
loss_pred:0.014723529107868671, decouple_loss:0.001146543538197875
The modified gen p mean: 0.44917911291122437, gen p mean: -0.0510273352265358, mean p set: 0.44965940713882446The modified gen p mean: 0.4474453926086426, gen p mean: -0.0579068548977375, mean p set: 0.4479256868362427
loss_pred:0.014957892708480358, decouple_loss:0.001251049805432558
loss_pred:0.015040706843137741, decouple_loss:0.0013521617511287332
Iteration: 615, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44849705696105957, gen p mean: -0.05028217285871506, mean p set: 0.44897738099098206
loss_pred:0.014993051998317242, decouple_loss:0.0012360223336145282
The modified gen p mean: 0.44782355427742004, gen p mean: -0.047746118158102036, mean p set: 0.44830384850502014The modified gen p mean: 0.4486697316169739, gen p mean: -0.05711615830659866, mean p set: 0.449150025844574
loss_pred:0.014736351557075977, decouple_loss:0.0013037709286436439
loss_pred:0.014448278583586216, decouple_loss:0.0012812636559829116
Iteration: 616, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492274522781372, gen p mean: -0.05395050719380379, mean p set: 0.4497077465057373
The modified gen p mean: 0.4487152099609375, gen p mean: -0.044811032712459564, mean p set: 0.44919553399086
loss_pred:0.014305325224995613, decouple_loss:0.0012187787797302008
loss_pred:0.015368403866887093, decouple_loss:0.001233815448358655
The modified gen p mean: 0.4478321373462677, gen p mean: -0.04828467592597008, mean p set: 0.4483124613761902
loss_pred:0.014255179092288017, decouple_loss:0.0011486007133498788
Iteration: 617, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481750428676605, gen p mean: -0.05863499641418457, mean p set: 0.4486553370952606
The modified gen p mean: 0.4489496946334839, gen p mean: -0.051817186176776886, mean p set: 0.449429988861084
loss_pred:0.014376096427440643, decouple_loss:0.0013579785590991378
loss_pred:0.014686019159853458, decouple_loss:0.0013383561745285988
The modified gen p mean: 0.44786936044692993, gen p mean: -0.0550013929605484, mean p set: 0.44834965467453003
loss_pred:0.014662795700132847, decouple_loss:0.0014240567106753588
Iteration: 618, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485422670841217, gen p mean: -0.05595552548766136, mean p set: 0.4490225911140442
loss_pred:0.014297684654593468, decouple_loss:0.0014273576671257615
The modified gen p mean: 0.44923076033592224, gen p mean: -0.048634517937898636, mean p set: 0.44971105456352234The modified gen p mean: 0.44971179962158203, gen p mean: -0.05696588009595871, mean p set: 0.45019209384918213
loss_pred:0.014810911379754543, decouple_loss:0.0014516020892187953
loss_pred:0.014449873007833958, decouple_loss:0.0014980208361521363
Iteration: 619, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44858604669570923, gen p mean: -0.06089090183377266, mean p set: 0.4490663409233093
The modified gen p mean: 0.4479890465736389, gen p mean: -0.06400705873966217, mean p set: 0.448469340801239
loss_pred:0.013916073366999626, decouple_loss:0.0013794831465929747
loss_pred:0.014076595194637775, decouple_loss:0.0014994667144492269
The modified gen p mean: 0.44914141297340393, gen p mean: -0.052413228899240494, mean p set: 0.4496217370033264
loss_pred:0.014460776932537556, decouple_loss:0.00136984430719167
Iteration: 620, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484230577945709, gen p mean: -0.056005969643592834, mean p set: 0.4489034116268158
The modified gen p mean: 0.4483506977558136, gen p mean: -0.057952139526605606, mean p set: 0.4488309919834137
loss_pred:0.013936634175479412, decouple_loss:0.0013797874562442303
loss_pred:0.014321811497211456, decouple_loss:0.0014446869026869535
The modified gen p mean: 0.4477083086967468, gen p mean: -0.05125890299677849, mean p set: 0.4481886029243469
loss_pred:0.013980339281260967, decouple_loss:0.0013693501241505146
2023-05-01 07:53:26 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.05741557478904724, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.05395623669028282, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.054080139845609665, mean p set: 0.4500633478164673
loss_pred:0.018947843462228775, decouple_loss:0.0014508034801110625
loss_pred:0.0179454293102026, decouple_loss:0.0014851641608402133
loss_pred:0.017991242930293083, decouple_loss:0.0014776241732761264
WV_0_PC_1_EH_0_PS_40, loss: 0.018368398770689964, avg_mse: 0.02656860649585724
current test mse: 0.026569
Iteration: 621, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487597942352295, gen p mean: -0.05704742670059204, mean p set: 0.4492400586605072
The modified gen p mean: 0.44840681552886963, gen p mean: -0.056793905794620514, mean p set: 0.4488871097564697
The modified gen p mean: 0.448650598526001, gen p mean: -0.05325685441493988, mean p set: 0.44913092255592346
loss_pred:0.013860299251973629, decouple_loss:0.0014969580806791782
loss_pred:0.014386773109436035, decouple_loss:0.0015280471416190267
loss_pred:0.014351220801472664, decouple_loss:0.0016621638787910342
Iteration: 622, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501950442790985, gen p mean: -0.05257846415042877, mean p set: 0.4506753385066986
The modified gen p mean: 0.4481826722621918, gen p mean: -0.05318586155772209, mean p set: 0.44866296648979187
loss_pred:0.01426294818520546, decouple_loss:0.0015097139403223991
loss_pred:0.014110317453742027, decouple_loss:0.0016022116178646684
The modified gen p mean: 0.4497270882129669, gen p mean: -0.05512664467096329, mean p set: 0.450207382440567
loss_pred:0.01412825658917427, decouple_loss:0.0014557023532688618
Iteration: 623, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480856955051422, gen p mean: -0.05203963816165924, mean p set: 0.4485659599304199
loss_pred:0.013749096542596817, decouple_loss:0.0015671424334868789
The modified gen p mean: 0.4476867914199829, gen p mean: -0.047822002321481705, mean p set: 0.4481671154499054The modified gen p mean: 0.44792136549949646, gen p mean: -0.04929641634225845, mean p set: 0.44840162992477417
loss_pred:0.013957105576992035, decouple_loss:0.0014871374005451798
loss_pred:0.013846722431480885, decouple_loss:0.0015628673136234283
Iteration: 624, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479455053806305, gen p mean: -0.05806433781981468, mean p set: 0.4484257698059082
loss_pred:0.013643557205796242, decouple_loss:0.0015343718696385622
The modified gen p mean: 0.44761672616004944, gen p mean: -0.04884786158800125, mean p set: 0.4480970501899719The modified gen p mean: 0.44793662428855896, gen p mean: -0.04840441420674324, mean p set: 0.44841691851615906
loss_pred:0.013658227398991585, decouple_loss:0.001543625839985907
loss_pred:0.0135997598990798, decouple_loss:0.0015101254684850574
Iteration: 625, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484025537967682, gen p mean: -0.04875406250357628, mean p set: 0.4488828480243683
loss_pred:0.01371199544519186, decouple_loss:0.001558666699565947
The modified gen p mean: 0.4485883116722107, gen p mean: -0.0528813973069191, mean p set: 0.4490686058998108
The modified gen p mean: 0.44944050908088684, gen p mean: -0.051354557275772095, mean p set: 0.44992080330848694
loss_pred:0.014680042862892151, decouple_loss:0.0014468992594629526
loss_pred:0.014141697436571121, decouple_loss:0.0015267288545146585
Iteration: 626, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487764537334442, gen p mean: -0.04846500605344772, mean p set: 0.4492567181587219
loss_pred:0.013641715049743652, decouple_loss:0.0014003291726112366
The modified gen p mean: 0.4499695599079132, gen p mean: -0.0521443746984005, mean p set: 0.4504498541355133The modified gen p mean: 0.44852012395858765, gen p mean: -0.051991865038871765, mean p set: 0.44900044798851013
loss_pred:0.013908008113503456, decouple_loss:0.001490089576691389
loss_pred:0.013709834776818752, decouple_loss:0.0015927922213450074
Iteration: 627, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474776089191437, gen p mean: -0.05507902801036835, mean p set: 0.4479579031467438
loss_pred:0.013579820282757282, decouple_loss:0.0013723255833610892
The modified gen p mean: 0.44784513115882874, gen p mean: -0.04721812903881073, mean p set: 0.44832542538642883The modified gen p mean: 0.447337806224823, gen p mean: -0.049519721418619156, mean p set: 0.4478180706501007
loss_pred:0.01385614462196827, decouple_loss:0.0013528026174753904loss_pred:0.01348252035677433, decouple_loss:0.0014659155858680606
Iteration: 628, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44877615571022034, gen p mean: -0.05059551075100899, mean p set: 0.44925642013549805
loss_pred:0.013821207918226719, decouple_loss:0.0013835892314091325
The modified gen p mean: 0.44897907972335815, gen p mean: -0.05143774673342705, mean p set: 0.44945937395095825The modified gen p mean: 0.4494444727897644, gen p mean: -0.05015728995203972, mean p set: 0.4499247372150421
loss_pred:0.01354094035923481, decouple_loss:0.0014993436634540558
loss_pred:0.013255641795694828, decouple_loss:0.0015021340223029256
Iteration: 629, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471559524536133, gen p mean: -0.05267547816038132, mean p set: 0.4476362466812134
loss_pred:0.013946503400802612, decouple_loss:0.0015111452667042613
The modified gen p mean: 0.448161780834198, gen p mean: -0.04963517189025879, mean p set: 0.4486420452594757
The modified gen p mean: 0.4488055408000946, gen p mean: -0.049978986382484436, mean p set: 0.4492858350276947
loss_pred:0.01401180773973465, decouple_loss:0.0013727884506806731
loss_pred:0.013599997386336327, decouple_loss:0.0013425488723441958
Iteration: 630, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44881996512413025, gen p mean: -0.05340125039219856, mean p set: 0.44930025935173035
loss_pred:0.013398060575127602, decouple_loss:0.0013099771458655596
The modified gen p mean: 0.44945159554481506, gen p mean: -0.04991907998919487, mean p set: 0.44993188977241516The modified gen p mean: 0.4491707384586334, gen p mean: -0.057951077818870544, mean p set: 0.4496510326862335
loss_pred:0.013439426198601723, decouple_loss:0.0013741983566433191
loss_pred:0.013520040549337864, decouple_loss:0.0014024931006133556
2023-05-01 07:55:18 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.05361929535865784, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04990478232502937, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.05016195774078369, mean p set: 0.4500633478164673
loss_pred:0.019248880445957184, decouple_loss:0.0014237158466130495
loss_pred:0.018153555691242218, decouple_loss:0.0013288147747516632
loss_pred:0.018191354349255562, decouple_loss:0.0013681937707588077
WV_0_PC_1_EH_0_PS_40, loss: 0.018599942326545715, avg_mse: 0.02711835689842701
current test mse: 0.027118
Iteration: 631, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476096034049988, gen p mean: -0.051029812544584274, mean p set: 0.4480898678302765
The modified gen p mean: 0.44857487082481384, gen p mean: -0.04907361418008804, mean p set: 0.44905519485473633
The modified gen p mean: 0.44808343052864075, gen p mean: -0.051574770361185074, mean p set: 0.44856372475624084
loss_pred:0.01354046631604433, decouple_loss:0.0013845984358340502
loss_pred:0.013577153906226158, decouple_loss:0.0013978726929053664loss_pred:0.01342470571398735, decouple_loss:0.0013580421218648553
Iteration: 632, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44884929060935974, gen p mean: -0.04862170293927193, mean p set: 0.44932955503463745
The modified gen p mean: 0.4484126567840576, gen p mean: -0.05415724590420723, mean p set: 0.4488929510116577
loss_pred:0.014116177335381508, decouple_loss:0.001408491632901132
loss_pred:0.013602224178612232, decouple_loss:0.0013254469959065318
The modified gen p mean: 0.4480079710483551, gen p mean: -0.051784828305244446, mean p set: 0.4484882652759552
loss_pred:0.013410530053079128, decouple_loss:0.0012919028522446752
Iteration: 633, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44868409633636475, gen p mean: -0.04877295717597008, mean p set: 0.44916436076164246
loss_pred:0.013181472197175026, decouple_loss:0.0012781756231561303
The modified gen p mean: 0.44895660877227783, gen p mean: -0.05000991001725197, mean p set: 0.44943690299987793The modified gen p mean: 0.4488219618797302, gen p mean: -0.045026544481515884, mean p set: 0.44930222630500793
loss_pred:0.013180009089410305, decouple_loss:0.0013528707204386592
loss_pred:0.013888491317629814, decouple_loss:0.0014526292216032743
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012012_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012012_3_24hr.npz
NaN value num: 0
Iteration: 634, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477330446243286, gen p mean: -0.04725441709160805, mean p set: 0.4482133686542511
loss_pred:0.01361337210983038, decouple_loss:0.0011877669021487236
The modified gen p mean: 0.44769418239593506, gen p mean: -0.050344131886959076, mean p set: 0.44817450642585754The modified gen p mean: 0.4477849304676056, gen p mean: -0.04737202450633049, mean p set: 0.4482652246952057
loss_pred:0.013419372960925102, decouple_loss:0.0011791498400270939
loss_pred:0.0139864981174469, decouple_loss:0.0013677943497896194
Iteration: 635, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44720256328582764, gen p mean: -0.04832226410508156, mean p set: 0.4476828873157501
The modified gen p mean: 0.44679224491119385, gen p mean: -0.04693804308772087, mean p set: 0.44727250933647156
loss_pred:0.013391326181590557, decouple_loss:0.0012971344403922558
loss_pred:0.013384527526795864, decouple_loss:0.0012776105431839824
The modified gen p mean: 0.44695988297462463, gen p mean: -0.0505245178937912, mean p set: 0.4474402070045471
loss_pred:0.01368525717407465, decouple_loss:0.001366725075058639
Iteration: 636, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484599232673645, gen p mean: -0.04773171618580818, mean p set: 0.448940247297287
loss_pred:0.01400583703070879, decouple_loss:0.0012814549263566732
The modified gen p mean: 0.4474269449710846, gen p mean: -0.04327406734228134, mean p set: 0.4479072690010071The modified gen p mean: 0.4469079375267029, gen p mean: -0.04897673428058624, mean p set: 0.4473881721496582
loss_pred:0.014042414724826813, decouple_loss:0.0011684763012453914
loss_pred:0.013462714850902557, decouple_loss:0.0012956932187080383
Iteration: 637, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480159282684326, gen p mean: -0.037681128829717636, mean p set: 0.4484962224960327
loss_pred:0.013700163923203945, decouple_loss:0.0012379501713439822
The modified gen p mean: 0.4475523829460144, gen p mean: -0.04221443459391594, mean p set: 0.4480327069759369The modified gen p mean: 0.44752028584480286, gen p mean: -0.04298282042145729, mean p set: 0.44800058007240295
loss_pred:0.01284101977944374, decouple_loss:0.0013792958343401551
loss_pred:0.01337223220616579, decouple_loss:0.0012837272370234132
Iteration: 638, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44597822427749634, gen p mean: -0.04497227072715759, mean p set: 0.44645851850509644
loss_pred:0.013414446264505386, decouple_loss:0.0012085102498531342
The modified gen p mean: 0.44849732518196106, gen p mean: -0.045636557042598724, mean p set: 0.44897761940956116The modified gen p mean: 0.446382999420166, gen p mean: -0.04676762968301773, mean p set: 0.4468632936477661
loss_pred:0.013218512758612633, decouple_loss:0.001274272333830595
loss_pred:0.013155707158148289, decouple_loss:0.0012422252912074327
Iteration: 639, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481739103794098, gen p mean: -0.0471322201192379, mean p set: 0.4486541748046875
loss_pred:0.014093883335590363, decouple_loss:0.001400363864377141
The modified gen p mean: 0.44647812843322754, gen p mean: -0.049897368997335434, mean p set: 0.44695839285850525The modified gen p mean: 0.4472866654396057, gen p mean: -0.05216238275170326, mean p set: 0.4477669298648834
loss_pred:0.013359339907765388, decouple_loss:0.0013015212025493383
loss_pred:0.013245347887277603, decouple_loss:0.0014816747279837728
Iteration: 640, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44812092185020447, gen p mean: -0.049103740602731705, mean p set: 0.44860121607780457
The modified gen p mean: 0.44865262508392334, gen p mean: -0.045575328171253204, mean p set: 0.44913291931152344
loss_pred:0.012745841406285763, decouple_loss:0.0012019090354442596
loss_pred:0.013955194503068924, decouple_loss:0.0012559748720377684
The modified gen p mean: 0.447234183549881, gen p mean: -0.0498826801776886, mean p set: 0.4477144777774811
loss_pred:0.013467068783938885, decouple_loss:0.0012308667646721005
2023-05-01 07:57:52 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.0506528876721859, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04697130620479584, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04702010378241539, mean p set: 0.4500633478164673
loss_pred:0.01926441304385662, decouple_loss:0.0014090071199461818
loss_pred:0.018100954592227936, decouple_loss:0.0012467498891055584
loss_pred:0.018181663006544113, decouple_loss:0.0012939535081386566
WV_0_PC_1_EH_0_PS_40, loss: 0.018581505864858627, avg_mse: 0.02711404301226139
current test mse: 0.027114
Iteration: 641, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474409818649292, gen p mean: -0.05001792684197426, mean p set: 0.4479212760925293
The modified gen p mean: 0.44876790046691895, gen p mean: -0.04696807637810707, mean p set: 0.44924822449684143
The modified gen p mean: 0.4478985369205475, gen p mean: -0.048264045268297195, mean p set: 0.4483788311481476
loss_pred:0.013310356065630913, decouple_loss:0.0012567207450047135
loss_pred:0.013247226364910603, decouple_loss:0.0012916810810565948
loss_pred:0.013667888939380646, decouple_loss:0.0011676078429445624
Iteration: 642, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468739926815033, gen p mean: -0.044400762766599655, mean p set: 0.4473542869091034
loss_pred:0.013386312872171402, decouple_loss:0.0011765244416892529
The modified gen p mean: 0.44814231991767883, gen p mean: -0.04695320501923561, mean p set: 0.44862261414527893The modified gen p mean: 0.4470200538635254, gen p mean: -0.04981869086623192, mean p set: 0.4475003480911255
loss_pred:0.012816931121051311, decouple_loss:0.0012700605439022183
loss_pred:0.012928214855492115, decouple_loss:0.0012668108101934195
Iteration: 643, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467793107032776, gen p mean: -0.046163152903318405, mean p set: 0.4472596049308777
loss_pred:0.013206534087657928, decouple_loss:0.0010893516009673476
The modified gen p mean: 0.445629358291626, gen p mean: -0.04368960112333298, mean p set: 0.4461096227169037
The modified gen p mean: 0.4476092755794525, gen p mean: -0.04262469708919525, mean p set: 0.4480895698070526
loss_pred:0.013232378289103508, decouple_loss:0.0011586047476157546
loss_pred:0.013171807862818241, decouple_loss:0.0010969131253659725
Iteration: 644, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44741907715797424, gen p mean: -0.04558062553405762, mean p set: 0.44789940118789673
loss_pred:0.013727941550314426, decouple_loss:0.0013962365919724107
The modified gen p mean: 0.4476260542869568, gen p mean: -0.0465744249522686, mean p set: 0.4481063485145569
The modified gen p mean: 0.4474744498729706, gen p mean: -0.04581062123179436, mean p set: 0.4479547441005707
loss_pred:0.013790949247777462, decouple_loss:0.0013667758321389556
loss_pred:0.012830906547605991, decouple_loss:0.001317706424742937
Iteration: 645, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472868740558624, gen p mean: -0.04778219014406204, mean p set: 0.4477671980857849
loss_pred:0.013155058957636356, decouple_loss:0.0011478171218186617
The modified gen p mean: 0.44869038462638855, gen p mean: -0.04191174730658531, mean p set: 0.44917070865631104The modified gen p mean: 0.44864141941070557, gen p mean: -0.04009207710623741, mean p set: 0.4491216838359833
loss_pred:0.013704235665500164, decouple_loss:0.0011415083426982164
loss_pred:0.013231717050075531, decouple_loss:0.0011708741076290607
Iteration: 646, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478982090950012, gen p mean: -0.04561104625463486, mean p set: 0.44837847352027893
loss_pred:0.012903560884296894, decouple_loss:0.0011976731475442648
The modified gen p mean: 0.44812050461769104, gen p mean: -0.043357595801353455, mean p set: 0.44860079884529114The modified gen p mean: 0.4471847116947174, gen p mean: -0.050102271139621735, mean p set: 0.4476650059223175
loss_pred:0.01312692929059267, decouple_loss:0.0012336005456745625
loss_pred:0.013636529445648193, decouple_loss:0.0012493632966652513
Iteration: 647, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474908113479614, gen p mean: -0.049149222671985626, mean p set: 0.4479711353778839
loss_pred:0.013358814641833305, decouple_loss:0.0012465098407119513
The modified gen p mean: 0.447037011384964, gen p mean: -0.04704632982611656, mean p set: 0.4475173056125641The modified gen p mean: 0.4477022588253021, gen p mean: -0.04482043534517288, mean p set: 0.4481825828552246
loss_pred:0.013446011580526829, decouple_loss:0.0013487220276147127
loss_pred:0.012964233756065369, decouple_loss:0.0011472735786810517
Iteration: 648, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478203058242798, gen p mean: -0.04928254336118698, mean p set: 0.4483005702495575
loss_pred:0.013580652885138988, decouple_loss:0.001187462592497468
The modified gen p mean: 0.44765475392341614, gen p mean: -0.050529636442661285, mean p set: 0.44813501834869385The modified gen p mean: 0.44803979992866516, gen p mean: -0.052521754056215286, mean p set: 0.44852009415626526
loss_pred:0.013292094692587852, decouple_loss:0.001215632539242506
loss_pred:0.013279440812766552, decouple_loss:0.0011929937172681093
Iteration: 649, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477180242538452, gen p mean: -0.049361418932676315, mean p set: 0.4481982886791229
loss_pred:0.012772372923791409, decouple_loss:0.001203987980261445
The modified gen p mean: 0.44654789566993713, gen p mean: -0.05234720557928085, mean p set: 0.4470282196998596The modified gen p mean: 0.44773608446121216, gen p mean: -0.050246141850948334, mean p set: 0.44821637868881226
loss_pred:0.013258534483611584, decouple_loss:0.0011460885871201754
loss_pred:0.013439489528536797, decouple_loss:0.0010502930963411927
Iteration: 650, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44790807366371155, gen p mean: -0.050314147025346756, mean p set: 0.44838836789131165
loss_pred:0.01295457873493433, decouple_loss:0.0011505946749821305
The modified gen p mean: 0.44743573665618896, gen p mean: -0.05037856847047806, mean p set: 0.44791606068611145The modified gen p mean: 0.4477033019065857, gen p mean: -0.050307828933000565, mean p set: 0.4481835961341858
loss_pred:0.013302386738359928, decouple_loss:0.0011253098491579294
loss_pred:0.013533373363316059, decouple_loss:0.0011668774532154202
2023-05-01 07:59:45 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.053444478660821915, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.05005887895822525, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.05006042867898941, mean p set: 0.4500633478164673
loss_pred:0.019239788874983788, decouple_loss:0.0013281159335747361
loss_pred:0.018038934096693993, decouple_loss:0.0012691935990005732
loss_pred:0.01812213845551014, decouple_loss:0.001252547255717218
WV_0_PC_1_EH_0_PS_40, loss: 0.01853111945092678, avg_mse: 0.02705642394721508
current test mse: 0.027056
Iteration: 651, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486699402332306, gen p mean: -0.052873771637678146, mean p set: 0.4491502642631531
The modified gen p mean: 0.4478236734867096, gen p mean: -0.05103839188814163, mean p set: 0.4483039677143097
The modified gen p mean: 0.44838908314704895, gen p mean: -0.05325903743505478, mean p set: 0.44886934757232666
loss_pred:0.013062938116490841, decouple_loss:0.0012784661957994103
loss_pred:0.013800057582557201, decouple_loss:0.0012854273663833737
loss_pred:0.012501779943704605, decouple_loss:0.0012108696391806006
Iteration: 652, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446853905916214, gen p mean: -0.05184254050254822, mean p set: 0.4473342299461365
loss_pred:0.013336439616978168, decouple_loss:0.0011775112943723798
The modified gen p mean: 0.4469403028488159, gen p mean: -0.05057091265916824, mean p set: 0.4474206268787384The modified gen p mean: 0.44732311367988586, gen p mean: -0.049117106944322586, mean p set: 0.44780340790748596
loss_pred:0.013124953955411911, decouple_loss:0.001116266124881804
loss_pred:0.012927290052175522, decouple_loss:0.0010763481259346008
Iteration: 653, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44628408551216125, gen p mean: -0.04158998280763626, mean p set: 0.44676437973976135
loss_pred:0.013145104050636292, decouple_loss:0.0013725210446864367
The modified gen p mean: 0.44889017939567566, gen p mean: -0.04540751129388809, mean p set: 0.44937047362327576The modified gen p mean: 0.44730570912361145, gen p mean: -0.049487415701150894, mean p set: 0.44778600335121155
loss_pred:0.013113276101648808, decouple_loss:0.0012860903516411781
loss_pred:0.013807429932057858, decouple_loss:0.0013339468277990818
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012009_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012009_3_24hr.npz
NaN value num: 0
Iteration: 654, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473860263824463, gen p mean: -0.04739862680435181, mean p set: 0.4478663504123688
loss_pred:0.013659129850566387, decouple_loss:0.0011642973404377699
The modified gen p mean: 0.4492068290710449, gen p mean: -0.044230200350284576, mean p set: 0.449687123298645The modified gen p mean: 0.4494730532169342, gen p mean: -0.039548005908727646, mean p set: 0.4499533474445343
loss_pred:0.01417404506355524, decouple_loss:0.0011713721323758364
loss_pred:0.013735286891460419, decouple_loss:0.0011633068788796663
Iteration: 655, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44789427518844604, gen p mean: -0.03941594809293747, mean p set: 0.44837456941604614
loss_pred:0.013976962305605412, decouple_loss:0.0010749547509476542
The modified gen p mean: 0.44901955127716064, gen p mean: -0.044344887137413025, mean p set: 0.44949984550476074The modified gen p mean: 0.4476395547389984, gen p mean: -0.04639725387096405, mean p set: 0.4481198489665985
loss_pred:0.013562863692641258, decouple_loss:0.0012478672433644533
loss_pred:0.013638341799378395, decouple_loss:0.0011802447261288762
Iteration: 656, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493882358074188, gen p mean: -0.04443832114338875, mean p set: 0.4498685300350189
loss_pred:0.013894512318074703, decouple_loss:0.0012023086892440915
The modified gen p mean: 0.44813576340675354, gen p mean: -0.04500395059585571, mean p set: 0.44861605763435364The modified gen p mean: 0.4501529932022095, gen p mean: -0.04227783530950546, mean p set: 0.4506332576274872
loss_pred:0.014198659919202328, decouple_loss:0.001172776217572391
loss_pred:0.013253466226160526, decouple_loss:0.0011748134857043624
Iteration: 657, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44910916686058044, gen p mean: -0.047326404601335526, mean p set: 0.44958946108818054
loss_pred:0.013831736519932747, decouple_loss:0.001181822270154953
The modified gen p mean: 0.448865681886673, gen p mean: -0.05022188276052475, mean p set: 0.4493459463119507The modified gen p mean: 0.4484004080295563, gen p mean: -0.04070257395505905, mean p set: 0.44888070225715637
loss_pred:0.013599029742181301, decouple_loss:0.0011716728331521153
loss_pred:0.013888753019273281, decouple_loss:0.0013654142385348678
Iteration: 658, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44796690344810486, gen p mean: -0.04783538728952408, mean p set: 0.44844722747802734
loss_pred:0.013972905464470387, decouple_loss:0.001094340579584241
The modified gen p mean: 0.44856056571006775, gen p mean: -0.056316226720809937, mean p set: 0.44904085993766785The modified gen p mean: 0.4487476646900177, gen p mean: -0.0531269870698452, mean p set: 0.4492279887199402
loss_pred:0.013667632825672626, decouple_loss:0.0012126939836889505
loss_pred:0.013666179031133652, decouple_loss:0.0011169718345627189
Iteration: 659, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44854825735092163, gen p mean: -0.05111780762672424, mean p set: 0.44902855157852173
loss_pred:0.01383472140878439, decouple_loss:0.0012149328831583261
The modified gen p mean: 0.44869935512542725, gen p mean: -0.05245398357510567, mean p set: 0.44917967915534973The modified gen p mean: 0.4491323232650757, gen p mean: -0.050656434148550034, mean p set: 0.4496126174926758
loss_pred:0.013606228865683079, decouple_loss:0.0012107300572097301
loss_pred:0.013371705077588558, decouple_loss:0.0012761298567056656
Iteration: 660, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480966627597809, gen p mean: -0.04789344221353531, mean p set: 0.4485769271850586
loss_pred:0.013765850104391575, decouple_loss:0.0010969960130751133
The modified gen p mean: 0.4484628736972809, gen p mean: -0.04820480942726135, mean p set: 0.448943167924881The modified gen p mean: 0.44662222266197205, gen p mean: -0.05429887771606445, mean p set: 0.44710251688957214
loss_pred:0.013659821823239326, decouple_loss:0.0011855147313326597
loss_pred:0.013545960187911987, decouple_loss:0.0011858674697577953
2023-05-01 08:02:10 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.048403866589069366, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04543301835656166, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.045560747385025024, mean p set: 0.4500633478164673
loss_pred:0.019269658252596855, decouple_loss:0.0012111919932067394
loss_pred:0.01806267537176609, decouple_loss:0.0011695445282384753
loss_pred:0.018112363293766975, decouple_loss:0.001095632091164589
WV_0_PC_1_EH_0_PS_40, loss: 0.018539506942033768, avg_mse: 0.02708432823419571
current test mse: 0.027084
Iteration: 661, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44772836565971375, gen p mean: -0.04507426917552948, mean p set: 0.44820865988731384
The modified gen p mean: 0.4487565755844116, gen p mean: -0.039022158831357956, mean p set: 0.4492368996143341
The modified gen p mean: 0.4490792155265808, gen p mean: -0.047361794859170914, mean p set: 0.4495595097541809
loss_pred:0.013493400998413563, decouple_loss:0.001083887880668044
loss_pred:0.014087164774537086, decouple_loss:0.001103597111068666
loss_pred:0.013743559829890728, decouple_loss:0.0010822369949892163
Iteration: 662, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44927430152893066, gen p mean: -0.04251348227262497, mean p set: 0.44975459575653076
The modified gen p mean: 0.4472452998161316, gen p mean: -0.041118260473012924, mean p set: 0.4477255642414093
loss_pred:0.01351905893534422, decouple_loss:0.0011568480404093862
loss_pred:0.013628646731376648, decouple_loss:0.00101949623785913
The modified gen p mean: 0.4495239555835724, gen p mean: -0.045819852501153946, mean p set: 0.4500042200088501
loss_pred:0.013595176860690117, decouple_loss:0.0011470754398033023
Iteration: 663, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44974711537361145, gen p mean: -0.03903697431087494, mean p set: 0.45022737979888916
loss_pred:0.013835926540195942, decouple_loss:0.001134432153776288
The modified gen p mean: 0.44838768243789673, gen p mean: -0.04659825563430786, mean p set: 0.4488680362701416The modified gen p mean: 0.446489542722702, gen p mean: -0.046872496604919434, mean p set: 0.4469698667526245
loss_pred:0.013542313128709793, decouple_loss:0.0012931486126035452
loss_pred:0.013511358760297298, decouple_loss:0.001265195314772427
Iteration: 664, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44935813546180725, gen p mean: -0.04606381058692932, mean p set: 0.44983842968940735
loss_pred:0.014038586989045143, decouple_loss:0.0011294942814856768
The modified gen p mean: 0.4499039351940155, gen p mean: -0.04171682894229889, mean p set: 0.4503842294216156The modified gen p mean: 0.4502018690109253, gen p mean: -0.03922303393483162, mean p set: 0.450682133436203
loss_pred:0.01409407053142786, decouple_loss:0.0011660787276923656
loss_pred:0.013903409242630005, decouple_loss:0.0010786975035443902
Iteration: 665, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493992328643799, gen p mean: -0.04331369325518608, mean p set: 0.44987955689430237
loss_pred:0.013686507008969784, decouple_loss:0.0010808154474943876
The modified gen p mean: 0.4475764334201813, gen p mean: -0.04093000665307045, mean p set: 0.448056697845459The modified gen p mean: 0.44888004660606384, gen p mean: -0.04567616432905197, mean p set: 0.44936034083366394
loss_pred:0.01351697463542223, decouple_loss:0.0010649062460288405
loss_pred:0.013131747022271156, decouple_loss:0.0010291016660630703
Iteration: 666, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478687345981598, gen p mean: -0.04371064528822899, mean p set: 0.4483490288257599
loss_pred:0.013763660565018654, decouple_loss:0.0010702377185225487
The modified gen p mean: 0.4481092393398285, gen p mean: -0.03629886731505394, mean p set: 0.4485895335674286The modified gen p mean: 0.4493604004383087, gen p mean: -0.04418717324733734, mean p set: 0.4498407244682312
loss_pred:0.013357915915548801, decouple_loss:0.0010057856561616063
loss_pred:0.013571753166615963, decouple_loss:0.0011057393858209252
Iteration: 667, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484816789627075, gen p mean: -0.05257195606827736, mean p set: 0.44896194338798523
loss_pred:0.013790551573038101, decouple_loss:0.0012969374656677246
The modified gen p mean: 0.4481106400489807, gen p mean: -0.04494720324873924, mean p set: 0.4485909342765808The modified gen p mean: 0.4499817490577698, gen p mean: -0.04358683526515961, mean p set: 0.45046207308769226
loss_pred:0.013949712738394737, decouple_loss:0.0011823835084214807
loss_pred:0.01322139147669077, decouple_loss:0.0011665340280160308
Iteration: 668, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44880861043930054, gen p mean: -0.04824312403798103, mean p set: 0.449288934469223
loss_pred:0.01365506462752819, decouple_loss:0.001178773120045662
The modified gen p mean: 0.45015114545822144, gen p mean: -0.04514964297413826, mean p set: 0.45063140988349915The modified gen p mean: 0.44852957129478455, gen p mean: -0.04511911794543266, mean p set: 0.44900989532470703
loss_pred:0.013887634500861168, decouple_loss:0.0010275396052747965
loss_pred:0.013891823589801788, decouple_loss:0.0010897788451984525
Iteration: 669, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485054016113281, gen p mean: -0.048709139227867126, mean p set: 0.44898566603660583
loss_pred:0.013431716710329056, decouple_loss:0.0010587741853669286
The modified gen p mean: 0.4477268159389496, gen p mean: -0.049237266182899475, mean p set: 0.44820713996887207The modified gen p mean: 0.44979003071784973, gen p mean: -0.047406092286109924, mean p set: 0.4502703547477722
loss_pred:0.01382531225681305, decouple_loss:0.0010483539663255215
loss_pred:0.013709008693695068, decouple_loss:0.0011203137692064047
Iteration: 670, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504079818725586, gen p mean: -0.04140977934002876, mean p set: 0.4508882462978363
loss_pred:0.01322657149285078, decouple_loss:0.0011315991869196296
The modified gen p mean: 0.44897758960723877, gen p mean: -0.0454348586499691, mean p set: 0.44945788383483887The modified gen p mean: 0.4494432210922241, gen p mean: -0.03919637203216553, mean p set: 0.4499235153198242
loss_pred:0.01381530612707138, decouple_loss:0.0011112019419670105
loss_pred:0.013252145610749722, decouple_loss:0.0011030277237296104
2023-05-01 08:04:02 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.04760949686169624, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04428323730826378, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.044468991458415985, mean p set: 0.4500633478164673
loss_pred:0.019352316856384277, decouple_loss:0.0012353940401226282
loss_pred:0.01815551333129406, decouple_loss:0.0011843392858281732
loss_pred:0.01822378858923912, decouple_loss:0.0011891080066561699
WV_0_PC_1_EH_0_PS_40, loss: 0.01863735355436802, avg_mse: 0.02727537788450718
current test mse: 0.027275
Iteration: 671, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44884318113327026, gen p mean: -0.046413931995630264, mean p set: 0.44932347536087036
The modified gen p mean: 0.4491191506385803, gen p mean: -0.05022760480642319, mean p set: 0.4495994448661804
The modified gen p mean: 0.4486571252346039, gen p mean: -0.04923171177506447, mean p set: 0.449137419462204
loss_pred:0.01370085310190916, decouple_loss:0.0012000546557828784
loss_pred:0.01318457443267107, decouple_loss:0.001093973987735808
loss_pred:0.013613526709377766, decouple_loss:0.001201832783408463
Iteration: 672, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44981876015663147, gen p mean: -0.04248778149485588, mean p set: 0.45029905438423157
loss_pred:0.013381721451878548, decouple_loss:0.0011431468883529305
The modified gen p mean: 0.44882890582084656, gen p mean: -0.04739353433251381, mean p set: 0.44930922985076904The modified gen p mean: 0.4491627514362335, gen p mean: -0.044488780200481415, mean p set: 0.44964301586151123
loss_pred:0.013816643506288528, decouple_loss:0.0011903544655069709
loss_pred:0.013685428537428379, decouple_loss:0.0011136026587337255
Iteration: 673, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495813846588135, gen p mean: -0.04513166844844818, mean p set: 0.4500616788864136
loss_pred:0.013813572935760021, decouple_loss:0.0011219559237360954
The modified gen p mean: 0.4481542408466339, gen p mean: -0.041564881801605225, mean p set: 0.448634535074234The modified gen p mean: 0.4478866457939148, gen p mean: -0.03990010544657707, mean p set: 0.4483669102191925
loss_pred:0.013616373762488365, decouple_loss:0.0010996500495821238
loss_pred:0.013634666800498962, decouple_loss:0.0011198516003787518
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012019_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012019_3_24hr.npz
NaN value num: 0
Iteration: 674, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4515930414199829, gen p mean: -0.03456418216228485, mean p set: 0.452073335647583
loss_pred:0.016523810103535652, decouple_loss:0.0011361202923581004
The modified gen p mean: 0.45139825344085693, gen p mean: -0.034439921379089355, mean p set: 0.45187854766845703The modified gen p mean: 0.45107710361480713, gen p mean: -0.030331721529364586, mean p set: 0.4515573978424072
loss_pred:0.016887543722987175, decouple_loss:0.0012461411533877254
loss_pred:0.015489952638745308, decouple_loss:0.0012430945644155145
Iteration: 675, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45152682065963745, gen p mean: -0.03574075922369957, mean p set: 0.45200711488723755
loss_pred:0.016810771077871323, decouple_loss:0.0013912877766415477
The modified gen p mean: 0.451937735080719, gen p mean: -0.030123798176646233, mean p set: 0.4524179995059967The modified gen p mean: 0.45290979743003845, gen p mean: -0.03250880166888237, mean p set: 0.4533900320529938
loss_pred:0.016510426998138428, decouple_loss:0.0015280164079740644
loss_pred:0.015579761005938053, decouple_loss:0.0014280517352744937
Iteration: 676, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502286911010742, gen p mean: -0.026961952447891235, mean p set: 0.4507089853286743
loss_pred:0.01599094271659851, decouple_loss:0.0013059730408713222
The modified gen p mean: 0.4516752064228058, gen p mean: -0.03030732274055481, mean p set: 0.4521554708480835The modified gen p mean: 0.4514961838722229, gen p mean: -0.027221927419304848, mean p set: 0.451976478099823
loss_pred:0.016024941578507423, decouple_loss:0.0013409446692094207
loss_pred:0.01659131422638893, decouple_loss:0.0012936752755194902
Iteration: 677, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45104217529296875, gen p mean: -0.0299519132822752, mean p set: 0.45152246952056885
loss_pred:0.017007237300276756, decouple_loss:0.0014628974022343755
The modified gen p mean: 0.4509286880493164, gen p mean: -0.030474340543150902, mean p set: 0.4514089822769165The modified gen p mean: 0.45241662859916687, gen p mean: -0.029799384996294975, mean p set: 0.4528968930244446
loss_pred:0.016175879165530205, decouple_loss:0.0013863323256373405
loss_pred:0.015247611328959465, decouple_loss:0.0016186930006369948
Iteration: 678, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504019320011139, gen p mean: -0.03899424150586128, mean p set: 0.450882226228714
loss_pred:0.015191936865448952, decouple_loss:0.0013094909954816103
The modified gen p mean: 0.45146703720092773, gen p mean: -0.03325800970196724, mean p set: 0.4519473612308502The modified gen p mean: 0.4507935345172882, gen p mean: -0.027734681963920593, mean p set: 0.4512738585472107
loss_pred:0.016260528936982155, decouple_loss:0.0015642161015421152
loss_pred:0.01653422601521015, decouple_loss:0.0014818294439464808
Iteration: 679, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45051705837249756, gen p mean: -0.03514625132083893, mean p set: 0.45099735260009766
loss_pred:0.015555733814835548, decouple_loss:0.0013471333077177405
The modified gen p mean: 0.4507963955402374, gen p mean: -0.033584438264369965, mean p set: 0.4512766897678375The modified gen p mean: 0.4509282410144806, gen p mean: -0.03781906142830849, mean p set: 0.4514085352420807
loss_pred:0.015976017341017723, decouple_loss:0.0013647997984662652
loss_pred:0.015559885650873184, decouple_loss:0.0012781537370756269
Iteration: 680, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508490264415741, gen p mean: -0.03345797583460808, mean p set: 0.4513293206691742
loss_pred:0.015605510212481022, decouple_loss:0.0012950635282322764
The modified gen p mean: 0.45098811388015747, gen p mean: -0.040224142372608185, mean p set: 0.45146840810775757The modified gen p mean: 0.4502018690109253, gen p mean: -0.037948090583086014, mean p set: 0.450682133436203
loss_pred:0.016352077946066856, decouple_loss:0.0013368547661229968
loss_pred:0.016311287879943848, decouple_loss:0.0013277172110974789
2023-05-01 08:06:30 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.04810544475913048, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04509500041604042, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.04514436796307564, mean p set: 0.4500633478164673
loss_pred:0.018678562715649605, decouple_loss:0.0012485886691138148
loss_pred:0.017562102526426315, decouple_loss:0.0012360045220702887
loss_pred:0.017611969262361526, decouple_loss:0.0012283440446481109
WV_0_PC_1_EH_0_PS_40, loss: 0.01801276206970215, avg_mse: 0.025997264310717583
current test mse: 0.025997
Iteration: 681, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497269093990326, gen p mean: -0.04078024998307228, mean p set: 0.4502072036266327
The modified gen p mean: 0.45063239336013794, gen p mean: -0.0448732003569603, mean p set: 0.45111268758773804
The modified gen p mean: 0.45237085223197937, gen p mean: -0.040098708122968674, mean p set: 0.45285114645957947
loss_pred:0.01571902446448803, decouple_loss:0.0013244675938040018
loss_pred:0.015978367999196053, decouple_loss:0.0012218558695167303
loss_pred:0.015090305358171463, decouple_loss:0.0011952676577493548
Iteration: 682, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45010122656822205, gen p mean: -0.034465890377759933, mean p set: 0.45058155059814453
loss_pred:0.01580648310482502, decouple_loss:0.0015429327031597495
The modified gen p mean: 0.4505757689476013, gen p mean: -0.03772147372364998, mean p set: 0.4510560631752014The modified gen p mean: 0.45307403802871704, gen p mean: -0.040098294615745544, mean p set: 0.4535543620586395
loss_pred:0.01573825441300869, decouple_loss:0.001339097274467349
loss_pred:0.015520943328738213, decouple_loss:0.0014516615774482489
Iteration: 683, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45027273893356323, gen p mean: -0.03858982026576996, mean p set: 0.45075303316116333
loss_pred:0.01578245498239994, decouple_loss:0.0013425275683403015
The modified gen p mean: 0.4505290687084198, gen p mean: -0.04858052358031273, mean p set: 0.4510093629360199The modified gen p mean: 0.4506165087223053, gen p mean: -0.04107796773314476, mean p set: 0.4510968327522278
loss_pred:0.015536949969828129, decouple_loss:0.0011859828373417258
loss_pred:0.01598541811108589, decouple_loss:0.001204556436277926
Iteration: 684, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45158693194389343, gen p mean: -0.046280425041913986, mean p set: 0.45206722617149353
loss_pred:0.016482215374708176, decouple_loss:0.0012940943706780672
The modified gen p mean: 0.452144593000412, gen p mean: -0.044304557144641876, mean p set: 0.4526248872280121The modified gen p mean: 0.4519047737121582, gen p mean: -0.04130562022328377, mean p set: 0.4523850381374359
loss_pred:0.016102997586131096, decouple_loss:0.001267039217054844
loss_pred:0.01625050976872444, decouple_loss:0.001464605564251542
Iteration: 685, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507906138896942, gen p mean: -0.045603107661008835, mean p set: 0.4512709379196167
loss_pred:0.015770742669701576, decouple_loss:0.0013473103754222393
The modified gen p mean: 0.45110297203063965, gen p mean: -0.04360373690724373, mean p set: 0.45158323645591736The modified gen p mean: 0.4524185061454773, gen p mean: -0.037747789174318314, mean p set: 0.452898770570755
loss_pred:0.016311626881361008, decouple_loss:0.0014914445346221328
loss_pred:0.016501853242516518, decouple_loss:0.0014868701109662652
Iteration: 686, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45168137550354004, gen p mean: -0.040592093020677567, mean p set: 0.4521616995334625
loss_pred:0.01652275025844574, decouple_loss:0.0012768357992172241
The modified gen p mean: 0.45111170411109924, gen p mean: -0.04828052222728729, mean p set: 0.45159196853637695The modified gen p mean: 0.45018839836120605, gen p mean: -0.04755239188671112, mean p set: 0.45066869258880615
loss_pred:0.016259117051959038, decouple_loss:0.0012953103287145495
loss_pred:0.016078578308224678, decouple_loss:0.0013045305386185646
Iteration: 687, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45081135630607605, gen p mean: -0.04006797820329666, mean p set: 0.45129165053367615
loss_pred:0.0157923586666584, decouple_loss:0.0015029005007818341
The modified gen p mean: 0.45073381066322327, gen p mean: -0.04136205464601517, mean p set: 0.45121413469314575The modified gen p mean: 0.4518786370754242, gen p mean: -0.044694315642118454, mean p set: 0.4523589313030243
loss_pred:0.015649106353521347, decouple_loss:0.0014504252467304468
loss_pred:0.015667201951146126, decouple_loss:0.001675303908996284
Iteration: 688, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45104271173477173, gen p mean: -0.04445739835500717, mean p set: 0.4515230059623718
loss_pred:0.015455219894647598, decouple_loss:0.0011129062622785568
The modified gen p mean: 0.45099154114723206, gen p mean: -0.04213622212409973, mean p set: 0.45147183537483215The modified gen p mean: 0.4517216682434082, gen p mean: -0.0410328134894371, mean p set: 0.4522019624710083
loss_pred:0.015468618832528591, decouple_loss:0.0012532604159787297
loss_pred:0.016133252531290054, decouple_loss:0.0012288388097658753
Iteration: 689, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4517934322357178, gen p mean: -0.04232199117541313, mean p set: 0.4522736966609955
loss_pred:0.015543715097010136, decouple_loss:0.0013528016861528158
The modified gen p mean: 0.45177724957466125, gen p mean: -0.04042930528521538, mean p set: 0.45225754380226135The modified gen p mean: 0.44992557168006897, gen p mean: -0.035216573625802994, mean p set: 0.45040586590766907
loss_pred:0.016522757709026337, decouple_loss:0.0013364640763029456
loss_pred:0.01565803587436676, decouple_loss:0.0014910371974110603
Iteration: 690, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44968485832214355, gen p mean: -0.0387004017829895, mean p set: 0.45016512274742126
loss_pred:0.01597950980067253, decouple_loss:0.0012745191343128681
The modified gen p mean: 0.4510782063007355, gen p mean: -0.03970303386449814, mean p set: 0.4515584707260132The modified gen p mean: 0.45102861523628235, gen p mean: -0.04105142131447792, mean p set: 0.45150890946388245
loss_pred:0.015040921978652477, decouple_loss:0.0012805287260562181
loss_pred:0.01652643084526062, decouple_loss:0.0012118580052629113
2023-05-01 08:08:22 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.05037911236286163, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.0471995510160923, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04719776660203934, mean p set: 0.4500633478164673
loss_pred:0.018477795645594597, decouple_loss:0.001309657352976501
loss_pred:0.017437215894460678, decouple_loss:0.0013183529954403639
loss_pred:0.017453201115131378, decouple_loss:0.0012760760728269815
WV_0_PC_1_EH_0_PS_40, loss: 0.017854472622275352, avg_mse: 0.02569572813808918
current test mse: 0.025696
Iteration: 691, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45015791058540344, gen p mean: -0.04326844587922096, mean p set: 0.45063820481300354
The modified gen p mean: 0.4501418471336365, gen p mean: -0.03850707411766052, mean p set: 0.4506221413612366
The modified gen p mean: 0.4512355327606201, gen p mean: -0.04177823290228844, mean p set: 0.4517157971858978
loss_pred:0.016478735953569412, decouple_loss:0.0013467621756717563
loss_pred:0.015659555792808533, decouple_loss:0.0011976698879152536
loss_pred:0.01571292243897915, decouple_loss:0.0012584453215822577
Iteration: 692, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513534903526306, gen p mean: -0.04079160839319229, mean p set: 0.4518337547779083
The modified gen p mean: 0.4512689709663391, gen p mean: -0.03991599380970001, mean p set: 0.4517492651939392
loss_pred:0.015880856662988663, decouple_loss:0.0011527640745043755
loss_pred:0.015232277102768421, decouple_loss:0.0011248717783018947
The modified gen p mean: 0.4504564106464386, gen p mean: -0.038283221423625946, mean p set: 0.4509367048740387
loss_pred:0.015242784284055233, decouple_loss:0.0012152986600995064
Iteration: 693, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505321681499481, gen p mean: -0.042728353291749954, mean p set: 0.4510124921798706
loss_pred:0.01565401442348957, decouple_loss:0.0011917592491954565
The modified gen p mean: 0.451174259185791, gen p mean: -0.040506139397621155, mean p set: 0.4516545534133911The modified gen p mean: 0.4511336088180542, gen p mean: -0.04187608137726784, mean p set: 0.4516139328479767
loss_pred:0.016293859109282494, decouple_loss:0.001241534948348999
loss_pred:0.016300996765494347, decouple_loss:0.0011483130510896444
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012000_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012000_3_24hr.npz
NaN value num: 0
Iteration: 694, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4512357711791992, gen p mean: -0.04121680185198784, mean p set: 0.4517160654067993
loss_pred:0.016601819545030594, decouple_loss:0.0012540067546069622
The modified gen p mean: 0.4515511989593506, gen p mean: -0.046315744519233704, mean p set: 0.4520314931869507The modified gen p mean: 0.44978779554367065, gen p mean: -0.04489918425679207, mean p set: 0.45026808977127075
loss_pred:0.016918472945690155, decouple_loss:0.0012357579544186592
loss_pred:0.016222769394516945, decouple_loss:0.001301610958762467
Iteration: 695, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45145177841186523, gen p mean: -0.04495220258831978, mean p set: 0.4519321024417877
loss_pred:0.01613629050552845, decouple_loss:0.0011066125007346272
The modified gen p mean: 0.4499928653240204, gen p mean: -0.04555480554699898, mean p set: 0.4504731595516205The modified gen p mean: 0.44950807094573975, gen p mean: -0.04484585300087929, mean p set: 0.44998836517333984
loss_pred:0.016693994402885437, decouple_loss:0.0011784919770434499
loss_pred:0.016164811328053474, decouple_loss:0.0012130620889365673
Iteration: 696, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44874751567840576, gen p mean: -0.05241117998957634, mean p set: 0.44922778010368347
The modified gen p mean: 0.4513486921787262, gen p mean: -0.045030925422906876, mean p set: 0.4518289566040039
loss_pred:0.016268612816929817, decouple_loss:0.0013547054259106517
loss_pred:0.01524880900979042, decouple_loss:0.001314028282649815
The modified gen p mean: 0.449867308139801, gen p mean: -0.049826331436634064, mean p set: 0.4503476321697235
loss_pred:0.0157634150236845, decouple_loss:0.0013834078563377261
Iteration: 697, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44892239570617676, gen p mean: -0.04875735193490982, mean p set: 0.44940266013145447
loss_pred:0.01589079387485981, decouple_loss:0.0012151924893260002
The modified gen p mean: 0.448850154876709, gen p mean: -0.05487632006406784, mean p set: 0.4493304491043091The modified gen p mean: 0.4507521092891693, gen p mean: -0.0469130203127861, mean p set: 0.4512324035167694
loss_pred:0.016178887337446213, decouple_loss:0.0012127634836360812
loss_pred:0.016051800921559334, decouple_loss:0.0011922578560188413
Iteration: 698, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511222839355469, gen p mean: -0.05307498201727867, mean p set: 0.4516025483608246
loss_pred:0.016905244439840317, decouple_loss:0.0010735744144767523
The modified gen p mean: 0.45039644837379456, gen p mean: -0.05260481685400009, mean p set: 0.45087674260139465The modified gen p mean: 0.45150044560432434, gen p mean: -0.050037119537591934, mean p set: 0.45198073983192444
loss_pred:0.016200022771954536, decouple_loss:0.0013852767879143357
loss_pred:0.017047254368662834, decouple_loss:0.0012187618995085359
Iteration: 699, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511565864086151, gen p mean: -0.05120442435145378, mean p set: 0.4516368806362152
The modified gen p mean: 0.44974350929260254, gen p mean: -0.05905357748270035, mean p set: 0.45022377371788025
loss_pred:0.016833694651722908, decouple_loss:0.0011375258909538388
loss_pred:0.01601526513695717, decouple_loss:0.001177184167318046
The modified gen p mean: 0.45114535093307495, gen p mean: -0.053135987371206284, mean p set: 0.45162567496299744
loss_pred:0.017084645107388496, decouple_loss:0.0011275910073891282
Iteration: 700, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504871368408203, gen p mean: -0.056851278990507126, mean p set: 0.4509674608707428
loss_pred:0.016090670600533485, decouple_loss:0.0011419765651226044
The modified gen p mean: 0.45027345418930054, gen p mean: -0.052870798856019974, mean p set: 0.45075374841690063The modified gen p mean: 0.4509528577327728, gen p mean: -0.04954920709133148, mean p set: 0.4514331519603729
loss_pred:0.016841236501932144, decouple_loss:0.0011527981841936707
loss_pred:0.01582832634449005, decouple_loss:0.0011897882213816047
2023-05-01 08:10:51 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.05578480660915375, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.05242563784122467, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.05252200365066528, mean p set: 0.4500633478164673
loss_pred:0.018486207351088524, decouple_loss:0.0013164543779566884
loss_pred:0.01739642210304737, decouple_loss:0.001192977768369019
loss_pred:0.017521899193525314, decouple_loss:0.001229983870871365
WV_0_PC_1_EH_0_PS_40, loss: 0.017863832414150238, avg_mse: 0.02566898986697197
current test mse: 0.025669
Iteration: 701, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.451978862285614, gen p mean: -0.05138551443815231, mean p set: 0.4524591267108917
The modified gen p mean: 0.4513408839702606, gen p mean: -0.052386727184057236, mean p set: 0.4518211781978607
The modified gen p mean: 0.4492553770542145, gen p mean: -0.04948422685265541, mean p set: 0.4497356712818146
loss_pred:0.01574438437819481, decouple_loss:0.001108720200136304
loss_pred:0.016072528436779976, decouple_loss:0.001169924740679562
loss_pred:0.016669342294335365, decouple_loss:0.0011856750352308154
Iteration: 702, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44903847575187683, gen p mean: -0.04532753676176071, mean p set: 0.44951876997947693
loss_pred:0.015887923538684845, decouple_loss:0.0011844319524243474
The modified gen p mean: 0.4494360089302063, gen p mean: -0.04838591441512108, mean p set: 0.4499163329601288The modified gen p mean: 0.4516649544239044, gen p mean: -0.04820742830634117, mean p set: 0.4521452486515045
loss_pred:0.016850894317030907, decouple_loss:0.0011848949361592531
loss_pred:0.01616404578089714, decouple_loss:0.001177214551717043
Iteration: 703, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44813987612724304, gen p mean: -0.049784328788518906, mean p set: 0.44862014055252075
loss_pred:0.01595630869269371, decouple_loss:0.001101633650250733
The modified gen p mean: 0.45149609446525574, gen p mean: -0.037090692669153214, mean p set: 0.45197638869285583The modified gen p mean: 0.4505842626094818, gen p mean: -0.04676820710301399, mean p set: 0.4510645270347595
loss_pred:0.01556060928851366, decouple_loss:0.001095544546842575
loss_pred:0.01610455848276615, decouple_loss:0.0011774664744734764
Iteration: 704, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511817693710327, gen p mean: -0.0422736294567585, mean p set: 0.4516620337963104
loss_pred:0.015776244923472404, decouple_loss:0.001241060090251267
The modified gen p mean: 0.44996708631515503, gen p mean: -0.04909246042370796, mean p set: 0.4504474103450775The modified gen p mean: 0.4501604437828064, gen p mean: -0.03869304060935974, mean p set: 0.4506407380104065
loss_pred:0.01604640483856201, decouple_loss:0.0012371647171676159
loss_pred:0.015821125358343124, decouple_loss:0.0011381665244698524
Iteration: 705, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493885040283203, gen p mean: -0.039732925593853, mean p set: 0.4498688280582428
loss_pred:0.016207417473196983, decouple_loss:0.0011424111435189843
The modified gen p mean: 0.45285388827323914, gen p mean: -0.04211033135652542, mean p set: 0.45333418250083923The modified gen p mean: 0.4476620852947235, gen p mean: -0.04530152305960655, mean p set: 0.448142409324646
loss_pred:0.01660623401403427, decouple_loss:0.0011845513945445418
loss_pred:0.015358923003077507, decouple_loss:0.0011340108467265964
Iteration: 706, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44969499111175537, gen p mean: -0.044182177633047104, mean p set: 0.4501752555370331
loss_pred:0.01602023094892502, decouple_loss:0.0011573624797165394
The modified gen p mean: 0.4490898847579956, gen p mean: -0.04143428057432175, mean p set: 0.4495701789855957The modified gen p mean: 0.451507031917572, gen p mean: -0.04254336282610893, mean p set: 0.4519873261451721
loss_pred:0.016636226326227188, decouple_loss:0.0010839139577001333
loss_pred:0.01677219569683075, decouple_loss:0.0011723043862730265
Iteration: 707, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44905152916908264, gen p mean: -0.045429572463035583, mean p set: 0.44953182339668274
loss_pred:0.015728089958429337, decouple_loss:0.0010439266916364431
The modified gen p mean: 0.45082300901412964, gen p mean: -0.04579287767410278, mean p set: 0.45130327343940735The modified gen p mean: 0.4518389105796814, gen p mean: -0.04572616145014763, mean p set: 0.4523191750049591
loss_pred:0.015824351459741592, decouple_loss:0.0011808847775682807
loss_pred:0.016568653285503387, decouple_loss:0.0010951937874779105
Iteration: 708, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44991931319236755, gen p mean: -0.048445720225572586, mean p set: 0.45039960741996765
loss_pred:0.01647445745766163, decouple_loss:0.0011323096696287394
The modified gen p mean: 0.4512248933315277, gen p mean: -0.0463237427175045, mean p set: 0.4517051577568054The modified gen p mean: 0.44980132579803467, gen p mean: -0.04879560321569443, mean p set: 0.45028162002563477
loss_pred:0.0157025083899498, decouple_loss:0.0012732796603813767
loss_pred:0.01660761423408985, decouple_loss:0.0010834087152034044
Iteration: 709, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514739513397217, gen p mean: -0.04941670224070549, mean p set: 0.45195427536964417
loss_pred:0.015364550054073334, decouple_loss:0.001035186811350286
The modified gen p mean: 0.45277971029281616, gen p mean: -0.050461769104003906, mean p set: 0.45326003432273865The modified gen p mean: 0.4493529200553894, gen p mean: -0.04667956754565239, mean p set: 0.4498332440853119
loss_pred:0.01570112444460392, decouple_loss:0.0010837005684152246
loss_pred:0.015941504389047623, decouple_loss:0.0012137525482103229
Iteration: 710, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44974252581596375, gen p mean: -0.047429051250219345, mean p set: 0.45022279024124146
loss_pred:0.016138294711709023, decouple_loss:0.0012224146630614996
The modified gen p mean: 0.4496873617172241, gen p mean: -0.05259225517511368, mean p set: 0.4501676559448242The modified gen p mean: 0.4498118460178375, gen p mean: -0.05231892690062523, mean p set: 0.45029211044311523
loss_pred:0.01625984162092209, decouple_loss:0.0012376138474792242
loss_pred:0.016252879053354263, decouple_loss:0.0011736518936231732
2023-05-01 08:12:43 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.051838431507349014, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04823429882526398, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.048640526831150055, mean p set: 0.4500633478164673
loss_pred:0.018475500866770744, decouple_loss:0.001201231381855905
loss_pred:0.017315398901700974, decouple_loss:0.0012285989942029119
loss_pred:0.017459355294704437, decouple_loss:0.0011980864219367504
WV_0_PC_1_EH_0_PS_40, loss: 0.017810551449656487, avg_mse: 0.0255922582000494
current test mse: 0.025592
Iteration: 711, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4528837203979492, gen p mean: -0.04822432994842529, mean p set: 0.4533640444278717
The modified gen p mean: 0.45214930176734924, gen p mean: -0.04957251623272896, mean p set: 0.45262959599494934
The modified gen p mean: 0.4494718015193939, gen p mean: -0.050433069467544556, mean p set: 0.449952095746994
loss_pred:0.015407518483698368, decouple_loss:0.001063728705048561
loss_pred:0.015475587919354439, decouple_loss:0.0010758931748569012
loss_pred:0.01574338972568512, decouple_loss:0.0011102453572675586
Iteration: 712, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45127806067466736, gen p mean: -0.042931895703077316, mean p set: 0.45175832509994507
The modified gen p mean: 0.4512796998023987, gen p mean: -0.041320428252220154, mean p set: 0.4517599642276764
loss_pred:0.015994232147932053, decouple_loss:0.000964114151429385
loss_pred:0.015564520843327045, decouple_loss:0.0011031939648091793
The modified gen p mean: 0.45160701870918274, gen p mean: -0.04516715556383133, mean p set: 0.45208731293678284
loss_pred:0.01593937911093235, decouple_loss:0.0010683494620025158
Iteration: 713, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4528367221355438, gen p mean: -0.045105211436748505, mean p set: 0.4533170461654663
loss_pred:0.015471097081899643, decouple_loss:0.0011092845816165209
The modified gen p mean: 0.4514136016368866, gen p mean: -0.042697127908468246, mean p set: 0.4518939256668091The modified gen p mean: 0.4493926763534546, gen p mean: -0.04156045615673065, mean p set: 0.4498729407787323
loss_pred:0.015913615003228188, decouple_loss:0.0011449672747403383
loss_pred:0.016693247482180595, decouple_loss:0.001094479113817215
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012008_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012008_3_24hr.npz
NaN value num: 0
Iteration: 714, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483950734138489, gen p mean: -0.04801023006439209, mean p set: 0.448875367641449
loss_pred:0.014619861729443073, decouple_loss:0.0011183051392436028
The modified gen p mean: 0.44934898614883423, gen p mean: -0.04421953484416008, mean p set: 0.4498293101787567The modified gen p mean: 0.4479721784591675, gen p mean: -0.04721039906144142, mean p set: 0.4484524726867676
loss_pred:0.014631863683462143, decouple_loss:0.001070678699761629
loss_pred:0.014926696196198463, decouple_loss:0.001036659348756075
Iteration: 715, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477499723434448, gen p mean: -0.045439187437295914, mean p set: 0.4482302665710449
loss_pred:0.01422386895865202, decouple_loss:0.0012709175935015082
The modified gen p mean: 0.44713103771209717, gen p mean: -0.050937674939632416, mean p set: 0.44761136174201965The modified gen p mean: 0.44948098063468933, gen p mean: -0.05013847351074219, mean p set: 0.4499613046646118
loss_pred:0.014028197154402733, decouple_loss:0.0011996758403256536
loss_pred:0.014220585115253925, decouple_loss:0.0011923741549253464
Iteration: 716, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483235776424408, gen p mean: -0.04889090359210968, mean p set: 0.4488039016723633
loss_pred:0.013733809813857079, decouple_loss:0.0012047431664541364
The modified gen p mean: 0.44810476899147034, gen p mean: -0.05024965479969978, mean p set: 0.4485850930213928The modified gen p mean: 0.4479479193687439, gen p mean: -0.05510937049984932, mean p set: 0.4484281837940216
loss_pred:0.014916947111487389, decouple_loss:0.0013196091167628765
loss_pred:0.013811130076646805, decouple_loss:0.0012005133321508765
Iteration: 717, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44857507944107056, gen p mean: -0.06208725646138191, mean p set: 0.44905540347099304
loss_pred:0.013754947111010551, decouple_loss:0.0013066816609352827
The modified gen p mean: 0.4467870593070984, gen p mean: -0.054489996284246445, mean p set: 0.4472673535346985The modified gen p mean: 0.44797995686531067, gen p mean: -0.05060417577624321, mean p set: 0.44846025109291077
loss_pred:0.013987944461405277, decouple_loss:0.0012400184059515595
loss_pred:0.013637121766805649, decouple_loss:0.0012727429857477546
Iteration: 718, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44743573665618896, gen p mean: -0.05758591368794441, mean p set: 0.44791606068611145
loss_pred:0.013623378239572048, decouple_loss:0.00127535464707762
The modified gen p mean: 0.4473644196987152, gen p mean: -0.05347451940178871, mean p set: 0.4478446841239929The modified gen p mean: 0.44617441296577454, gen p mean: -0.05206863209605217, mean p set: 0.44665467739105225
loss_pred:0.014102349989116192, decouple_loss:0.0012765707215294242
loss_pred:0.014185279607772827, decouple_loss:0.0012814367655664682
Iteration: 719, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449179083108902, gen p mean: -0.051872313022613525, mean p set: 0.4496593773365021
loss_pred:0.013358180411159992, decouple_loss:0.0013157210778445005
The modified gen p mean: 0.4482094943523407, gen p mean: -0.05405043438076973, mean p set: 0.4486897885799408The modified gen p mean: 0.4468684494495392, gen p mean: -0.0589735247194767, mean p set: 0.4473487436771393
loss_pred:0.013552856631577015, decouple_loss:0.001286421436816454
loss_pred:0.013627943582832813, decouple_loss:0.0014214103575795889
Iteration: 720, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479027986526489, gen p mean: -0.053147077560424805, mean p set: 0.4483831226825714
loss_pred:0.013460012152791023, decouple_loss:0.0013099050847813487
The modified gen p mean: 0.44757500290870667, gen p mean: -0.05050037428736687, mean p set: 0.4480552673339844The modified gen p mean: 0.4469151496887207, gen p mean: -0.05357715114951134, mean p set: 0.4473954439163208
loss_pred:0.013639659620821476, decouple_loss:0.0012642992660403252
loss_pred:0.013895955868065357, decouple_loss:0.0014001624658703804
2023-05-01 08:15:11 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.053326502442359924, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.049633339047431946, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.05012146756052971, mean p set: 0.4500633478164673
loss_pred:0.0193518977612257, decouple_loss:0.0013095657341182232
loss_pred:0.018232952803373337, decouple_loss:0.0012959103332832456
loss_pred:0.018250588327646255, decouple_loss:0.0013231689808890224
WV_0_PC_1_EH_0_PS_40, loss: 0.01867729052901268, avg_mse: 0.027215048670768738
current test mse: 0.027215
Iteration: 721, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44690239429473877, gen p mean: -0.046366848051548004, mean p set: 0.44738268852233887
The modified gen p mean: 0.44851401448249817, gen p mean: -0.05458192527294159, mean p set: 0.4489942789077759
The modified gen p mean: 0.44779494404792786, gen p mean: -0.049407389014959335, mean p set: 0.44827526807785034
loss_pred:0.01396819856017828, decouple_loss:0.0013159781228750944
loss_pred:0.01383635587990284, decouple_loss:0.001253682654350996
loss_pred:0.013470874167978764, decouple_loss:0.0013343323953449726
Iteration: 722, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486221969127655, gen p mean: -0.04533633589744568, mean p set: 0.4491024613380432
loss_pred:0.013139253482222557, decouple_loss:0.0014140395214781165
The modified gen p mean: 0.4469769597053528, gen p mean: -0.047967758029699326, mean p set: 0.4474572539329529The modified gen p mean: 0.44767674803733826, gen p mean: -0.051781728863716125, mean p set: 0.44815701246261597
loss_pred:0.01336693111807108, decouple_loss:0.0013800865272060037
loss_pred:0.013477173633873463, decouple_loss:0.0014156476827338338
Iteration: 723, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44692468643188477, gen p mean: -0.047473255544900894, mean p set: 0.44740498065948486
loss_pred:0.01323323231190443, decouple_loss:0.0012782779522240162
The modified gen p mean: 0.4475136697292328, gen p mean: -0.05312160402536392, mean p set: 0.4479939937591553The modified gen p mean: 0.44778189063072205, gen p mean: -0.04914272949099541, mean p set: 0.44826218485832214
loss_pred:0.013386097736656666, decouple_loss:0.0012956296559423208
loss_pred:0.013283977285027504, decouple_loss:0.0013284486485645175
Iteration: 724, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44798722863197327, gen p mean: -0.052956461906433105, mean p set: 0.44846752285957336
loss_pred:0.012930500321090221, decouple_loss:0.0013322633458301425
The modified gen p mean: 0.4466054439544678, gen p mean: -0.044515904039144516, mean p set: 0.4470857083797455The modified gen p mean: 0.4471588730812073, gen p mean: -0.051119621843099594, mean p set: 0.4476391673088074
loss_pred:0.013119068928062916, decouple_loss:0.0014417424099519849
loss_pred:0.01366342417895794, decouple_loss:0.0013378062285482883
Iteration: 725, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484352171421051, gen p mean: -0.051133893430233, mean p set: 0.4489155113697052
loss_pred:0.013464895077049732, decouple_loss:0.001353369909338653
The modified gen p mean: 0.4480445384979248, gen p mean: -0.04590550810098648, mean p set: 0.4485248327255249The modified gen p mean: 0.44826120138168335, gen p mean: -0.046473100781440735, mean p set: 0.44874149560928345
loss_pred:0.012972524389624596, decouple_loss:0.0012768462765961885
loss_pred:0.01322975941002369, decouple_loss:0.0013146272394806147
Iteration: 726, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44811391830444336, gen p mean: -0.049645133316516876, mean p set: 0.44859424233436584
loss_pred:0.013452313840389252, decouple_loss:0.0012797858798876405
The modified gen p mean: 0.44645363092422485, gen p mean: -0.04954148083925247, mean p set: 0.44693389534950256The modified gen p mean: 0.44668376445770264, gen p mean: -0.051290787756443024, mean p set: 0.44716405868530273
loss_pred:0.01319937501102686, decouple_loss:0.0013104184763506055
loss_pred:0.013371096923947334, decouple_loss:0.0013312966329976916
Iteration: 727, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473857879638672, gen p mean: -0.04928788170218468, mean p set: 0.4478660821914673
loss_pred:0.013239118270576, decouple_loss:0.001307494007050991
The modified gen p mean: 0.44687357544898987, gen p mean: -0.053549785166978836, mean p set: 0.44735386967658997The modified gen p mean: 0.447916179895401, gen p mean: -0.05193789675831795, mean p set: 0.4483965039253235
loss_pred:0.013644861057400703, decouple_loss:0.0014203833416104317
loss_pred:0.013124843128025532, decouple_loss:0.0013771320227533579
Iteration: 728, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44828876852989197, gen p mean: -0.046519771218299866, mean p set: 0.44876906275749207
loss_pred:0.012632847763597965, decouple_loss:0.0011991332285106182
The modified gen p mean: 0.44765833020210266, gen p mean: -0.047591377049684525, mean p set: 0.44813862442970276The modified gen p mean: 0.44847428798675537, gen p mean: -0.04653698205947876, mean p set: 0.44895458221435547
loss_pred:0.01284285169094801, decouple_loss:0.0012262426316738129
loss_pred:0.01376255415380001, decouple_loss:0.001265085069462657
Iteration: 729, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472668468952179, gen p mean: -0.04764469340443611, mean p set: 0.447747141122818
loss_pred:0.013033200986683369, decouple_loss:0.001382573158480227
The modified gen p mean: 0.4476200342178345, gen p mean: -0.05726784095168114, mean p set: 0.4481002688407898The modified gen p mean: 0.4483543634414673, gen p mean: -0.047258686274290085, mean p set: 0.4488346576690674
loss_pred:0.013159139081835747, decouple_loss:0.0015377592062577605
loss_pred:0.013408812694251537, decouple_loss:0.0013887904351577163
Iteration: 730, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44900399446487427, gen p mean: -0.0468440055847168, mean p set: 0.449484258890152
loss_pred:0.013436766341328621, decouple_loss:0.0012113467091694474
The modified gen p mean: 0.44793081283569336, gen p mean: -0.050411682575941086, mean p set: 0.44841110706329346The modified gen p mean: 0.44643887877464294, gen p mean: -0.05201421678066254, mean p set: 0.44691917300224304
loss_pred:0.01384667493402958, decouple_loss:0.001202652812935412
loss_pred:0.013324806466698647, decouple_loss:0.0012804956641048193
2023-05-01 08:17:03 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.05048524588346481, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04653073847293854, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04697078838944435, mean p set: 0.4500633478164673
loss_pred:0.01933472417294979, decouple_loss:0.0013214386999607086
loss_pred:0.01819194294512272, decouple_loss:0.001344746327959001
loss_pred:0.018249232321977615, decouple_loss:0.001315210829488933
WV_0_PC_1_EH_0_PS_40, loss: 0.01865832321345806, avg_mse: 0.027272691950201988
current test mse: 0.027273
Iteration: 731, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497775733470917, gen p mean: -0.04810159280896187, mean p set: 0.45025789737701416
The modified gen p mean: 0.4472023844718933, gen p mean: -0.04790613427758217, mean p set: 0.4476827085018158
The modified gen p mean: 0.44781970977783203, gen p mean: -0.05015435814857483, mean p set: 0.44829997420310974
loss_pred:0.013263756409287453, decouple_loss:0.0013019416946917772
loss_pred:0.012745818123221397, decouple_loss:0.0014302359195426106
loss_pred:0.013213840313255787, decouple_loss:0.001241062069311738
Iteration: 732, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472697675228119, gen p mean: -0.04490409418940544, mean p set: 0.4477500915527344
The modified gen p mean: 0.448159396648407, gen p mean: -0.045762307941913605, mean p set: 0.4486396908760071
loss_pred:0.013103061355650425, decouple_loss:0.0012183437356725335
loss_pred:0.01324346661567688, decouple_loss:0.0012143076164647937
The modified gen p mean: 0.44802576303482056, gen p mean: -0.043406032025814056, mean p set: 0.44850608706474304
loss_pred:0.012719403952360153, decouple_loss:0.0011903613340109587
Iteration: 733, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477563798427582, gen p mean: -0.048796024173498154, mean p set: 0.4482366442680359
loss_pred:0.012525312602519989, decouple_loss:0.001300034113228321
The modified gen p mean: 0.44762831926345825, gen p mean: -0.04559977352619171, mean p set: 0.44810861349105835The modified gen p mean: 0.4489873945713043, gen p mean: -0.04505161568522453, mean p set: 0.4494676887989044
loss_pred:0.012978877872228622, decouple_loss:0.0012443282175809145
loss_pred:0.013069565407931805, decouple_loss:0.001209022244438529
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012020_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012020_3_24hr.npz
NaN value num: 0
Iteration: 734, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45013242959976196, gen p mean: -0.049711521714925766, mean p set: 0.45061272382736206
loss_pred:0.019192513078451157, decouple_loss:0.0016372292302548885
The modified gen p mean: 0.44849124550819397, gen p mean: -0.0454527847468853, mean p set: 0.44897153973579407The modified gen p mean: 0.4489961862564087, gen p mean: -0.04512910172343254, mean p set: 0.4494764804840088
loss_pred:0.018356844782829285, decouple_loss:0.001412045443430543
loss_pred:0.017858272418379784, decouple_loss:0.0013060736237093806
Iteration: 735, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44985103607177734, gen p mean: -0.048136599361896515, mean p set: 0.45033130049705505
loss_pred:0.018874231725931168, decouple_loss:0.0014623431488871574
The modified gen p mean: 0.44948074221611023, gen p mean: -0.04578542709350586, mean p set: 0.4499610364437103The modified gen p mean: 0.4494662880897522, gen p mean: -0.048362359404563904, mean p set: 0.4499465525150299
loss_pred:0.018154505640268326, decouple_loss:0.0013242085697129369
loss_pred:0.01742096245288849, decouple_loss:0.0014127568574622273
Iteration: 736, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44819748401641846, gen p mean: -0.044438861310482025, mean p set: 0.44867777824401855
loss_pred:0.01774287037551403, decouple_loss:0.0014812271110713482
The modified gen p mean: 0.4489402174949646, gen p mean: -0.04710524529218674, mean p set: 0.4494204819202423The modified gen p mean: 0.4481431245803833, gen p mean: -0.04425692930817604, mean p set: 0.4486234188079834
loss_pred:0.01889045350253582, decouple_loss:0.001597607391886413
loss_pred:0.01788908801972866, decouple_loss:0.0015828171744942665
Iteration: 737, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44919368624687195, gen p mean: -0.04484695568680763, mean p set: 0.44967401027679443
loss_pred:0.017686977982521057, decouple_loss:0.0013021136401221156
The modified gen p mean: 0.44877657294273376, gen p mean: -0.04829518124461174, mean p set: 0.44925686717033386The modified gen p mean: 0.4498935043811798, gen p mean: -0.046381495893001556, mean p set: 0.4503738284111023
loss_pred:0.017514843493700027, decouple_loss:0.0012927325442433357
loss_pred:0.01790357008576393, decouple_loss:0.0013084650272503495
Iteration: 738, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44827064871788025, gen p mean: -0.0494207963347435, mean p set: 0.44875091314315796
The modified gen p mean: 0.4479087293148041, gen p mean: -0.04777932167053223, mean p set: 0.4483890235424042loss_pred:0.018313121050596237, decouple_loss:0.0013090195134282112
The modified gen p mean: 0.4488782286643982, gen p mean: -0.05229131132364273, mean p set: 0.4493584930896759
loss_pred:0.017541902139782906, decouple_loss:0.001381558133289218
loss_pred:0.018982335925102234, decouple_loss:0.0012822261778637767
Iteration: 739, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44987931847572327, gen p mean: -0.05780339986085892, mean p set: 0.45035961270332336
loss_pred:0.01824314147233963, decouple_loss:0.0013714631786569953
The modified gen p mean: 0.4486444890499115, gen p mean: -0.05034908652305603, mean p set: 0.4491247832775116The modified gen p mean: 0.4494567811489105, gen p mean: -0.0481472946703434, mean p set: 0.4499370753765106
loss_pred:0.017653120681643486, decouple_loss:0.001464409870095551
loss_pred:0.017465200275182724, decouple_loss:0.0013287723995745182
Iteration: 740, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44995805621147156, gen p mean: -0.05465695634484291, mean p set: 0.45043838024139404
The modified gen p mean: 0.4486680030822754, gen p mean: -0.058773498982191086, mean p set: 0.4491483271121979
loss_pred:0.017524974420666695, decouple_loss:0.0013534463942050934
loss_pred:0.017565274611115456, decouple_loss:0.0013996362686157227
The modified gen p mean: 0.4496510624885559, gen p mean: -0.05396512523293495, mean p set: 0.4501313269138336
loss_pred:0.017782652750611305, decouple_loss:0.0012634593294933438
2023-05-01 08:19:33 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.056705255061388016, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.05297284200787544, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.05339345335960388, mean p set: 0.4500633478164673
loss_pred:0.018496599048376083, decouple_loss:0.0014108320465311408
loss_pred:0.0173655916005373, decouple_loss:0.0014046966098248959
loss_pred:0.01749594882130623, decouple_loss:0.0013537679333239794
WV_0_PC_1_EH_0_PS_40, loss: 0.017855536192655563, avg_mse: 0.025603804737329483
current test mse: 0.025604
Iteration: 741, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492981731891632, gen p mean: -0.05541040748357773, mean p set: 0.4497784972190857
The modified gen p mean: 0.44845089316368103, gen p mean: -0.05216333642601967, mean p set: 0.4489312171936035
The modified gen p mean: 0.4497009813785553, gen p mean: -0.05748258903622627, mean p set: 0.4501812756061554
loss_pred:0.01803317479789257, decouple_loss:0.001408115611411631
loss_pred:0.01952875591814518, decouple_loss:0.0013343613827601075
loss_pred:0.017899345606565475, decouple_loss:0.0013168873265385628
Iteration: 742, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44961875677108765, gen p mean: -0.054661210626363754, mean p set: 0.45009905099868774
The modified gen p mean: 0.44917985796928406, gen p mean: -0.05523579940199852, mean p set: 0.44966015219688416
loss_pred:0.018153956159949303, decouple_loss:0.0013089271960780025
loss_pred:0.017484301701188087, decouple_loss:0.0012816846137866378
The modified gen p mean: 0.4496336579322815, gen p mean: -0.06042438745498657, mean p set: 0.450113981962204
loss_pred:0.017748190090060234, decouple_loss:0.0014122467255219817
Iteration: 743, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487052857875824, gen p mean: -0.05219860002398491, mean p set: 0.4491855800151825
loss_pred:0.017625337466597557, decouple_loss:0.0013020725455135107
The modified gen p mean: 0.44935736060142517, gen p mean: -0.056742481887340546, mean p set: 0.44983765482902527The modified gen p mean: 0.4501723051071167, gen p mean: -0.057921748608350754, mean p set: 0.4506526291370392
loss_pred:0.01645492948591709, decouple_loss:0.001192831085063517
loss_pred:0.018745623528957367, decouple_loss:0.0012440584832802415
Iteration: 744, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44872575998306274, gen p mean: -0.053769271820783615, mean p set: 0.44920605421066284
loss_pred:0.017674388363957405, decouple_loss:0.0012997683370485902
The modified gen p mean: 0.44877374172210693, gen p mean: -0.05591554194688797, mean p set: 0.44925400614738464The modified gen p mean: 0.44969406723976135, gen p mean: -0.06004650518298149, mean p set: 0.45017439126968384
loss_pred:0.017592843621969223, decouple_loss:0.0013564584078267217
loss_pred:0.018381426110863686, decouple_loss:0.0015186782693490386
Iteration: 745, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481669068336487, gen p mean: -0.05964858457446098, mean p set: 0.44864723086357117
loss_pred:0.017712799832224846, decouple_loss:0.0013987041311338544
The modified gen p mean: 0.44895657896995544, gen p mean: -0.05204833298921585, mean p set: 0.44943687319755554The modified gen p mean: 0.44971853494644165, gen p mean: -0.05835395306348801, mean p set: 0.45019885897636414
loss_pred:0.017289696261286736, decouple_loss:0.0012934240512549877
loss_pred:0.018100237473845482, decouple_loss:0.0012701564701274037
Iteration: 746, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499937891960144, gen p mean: -0.05219188332557678, mean p set: 0.4504740536212921
loss_pred:0.017265908420085907, decouple_loss:0.0012101377360522747
The modified gen p mean: 0.44854292273521423, gen p mean: -0.05148360878229141, mean p set: 0.44902318716049194The modified gen p mean: 0.44881120324134827, gen p mean: -0.05565681681036949, mean p set: 0.44929149746894836
loss_pred:0.017352290451526642, decouple_loss:0.0012266080593690276
loss_pred:0.018178677186369896, decouple_loss:0.0011776533210650086
Iteration: 747, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44972896575927734, gen p mean: -0.05505381524562836, mean p set: 0.45020923018455505
loss_pred:0.018452061340212822, decouple_loss:0.0013432806590572
The modified gen p mean: 0.4486953318119049, gen p mean: -0.04761466756463051, mean p set: 0.449175626039505The modified gen p mean: 0.449593186378479, gen p mean: -0.050947029143571854, mean p set: 0.4500735104084015
loss_pred:0.01744239404797554, decouple_loss:0.0012621375499293208
loss_pred:0.01835303194820881, decouple_loss:0.0012519059237092733
Iteration: 748, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492073953151703, gen p mean: -0.05370982363820076, mean p set: 0.4496876895427704
loss_pred:0.017805010080337524, decouple_loss:0.0012000850401818752
The modified gen p mean: 0.4489441514015198, gen p mean: -0.05329998955130577, mean p set: 0.4494244158267975The modified gen p mean: 0.4492141604423523, gen p mean: -0.05657678097486496, mean p set: 0.44969442486763
loss_pred:0.019134143367409706, decouple_loss:0.0012101338943466544
loss_pred:0.016804756596684456, decouple_loss:0.0012306582648307085
Iteration: 749, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44947925209999084, gen p mean: -0.04897649586200714, mean p set: 0.44995957612991333
loss_pred:0.017593596130609512, decouple_loss:0.0011176132829859853
The modified gen p mean: 0.4497392177581787, gen p mean: -0.05369585007429123, mean p set: 0.4502195417881012The modified gen p mean: 0.4485274851322174, gen p mean: -0.04673635959625244, mean p set: 0.4490078091621399
loss_pred:0.0177170243114233, decouple_loss:0.0011764626251533628
loss_pred:0.017069069668650627, decouple_loss:0.0012948544463142753
Iteration: 750, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44904962182044983, gen p mean: -0.05014082044363022, mean p set: 0.4495299160480499
loss_pred:0.017652548849582672, decouple_loss:0.0012269133003428578
The modified gen p mean: 0.44877198338508606, gen p mean: -0.0448775440454483, mean p set: 0.44925227761268616The modified gen p mean: 0.4496626853942871, gen p mean: -0.05082893371582031, mean p set: 0.4501429796218872
loss_pred:0.017583509907126427, decouple_loss:0.001153608551248908
loss_pred:0.01691797934472561, decouple_loss:0.0013091356959193945
2023-05-01 08:21:25 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.049998689442873, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04626428335905075, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.046619027853012085, mean p set: 0.4500633478164673
loss_pred:0.018343038856983185, decouple_loss:0.0011719202157109976
loss_pred:0.017308805137872696, decouple_loss:0.0011250602547079325
loss_pred:0.017328493297100067, decouple_loss:0.001127133728004992
WV_0_PC_1_EH_0_PS_40, loss: 0.017717180773615837, avg_mse: 0.025403130799531937
current test mse: 0.025403
Iteration: 751, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45037803053855896, gen p mean: -0.05121263489127159, mean p set: 0.45085832476615906
The modified gen p mean: 0.44922593235969543, gen p mean: -0.047404948621988297, mean p set: 0.4497062563896179
The modified gen p mean: 0.4490707218647003, gen p mean: -0.05236942693591118, mean p set: 0.4495510160923004
loss_pred:0.019148334860801697, decouple_loss:0.0012079495936632156
loss_pred:0.01796189695596695, decouple_loss:0.0011499635875225067
loss_pred:0.017590565606951714, decouple_loss:0.0011295038275420666
Iteration: 752, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499054551124573, gen p mean: -0.04755478724837303, mean p set: 0.450385719537735
The modified gen p mean: 0.4495718479156494, gen p mean: -0.045072127133607864, mean p set: 0.4500521421432495
loss_pred:0.017731331288814545, decouple_loss:0.001351634506136179
loss_pred:0.016729675233364105, decouple_loss:0.0012497712159529328
The modified gen p mean: 0.4497492015361786, gen p mean: -0.04812358692288399, mean p set: 0.4502294957637787
loss_pred:0.018228111788630486, decouple_loss:0.0013148277066648006
Iteration: 753, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44825479388237, gen p mean: -0.042155567556619644, mean p set: 0.4487350583076477
loss_pred:0.017562136054039, decouple_loss:0.001161125022917986
The modified gen p mean: 0.4497183859348297, gen p mean: -0.04581348970532417, mean p set: 0.4501986801624298The modified gen p mean: 0.4502822160720825, gen p mean: -0.049940209835767746, mean p set: 0.4507625102996826
loss_pred:0.01716458797454834, decouple_loss:0.0010720283025875688
loss_pred:0.018210597336292267, decouple_loss:0.0011557104298844934
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012001_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012001_3_24hr.npz
NaN value num: 0
Iteration: 754, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470219612121582, gen p mean: -0.05081414431333542, mean p set: 0.4475022256374359
loss_pred:0.014651688747107983, decouple_loss:0.0012905937619507313
The modified gen p mean: 0.4480348825454712, gen p mean: -0.04871707782149315, mean p set: 0.4485151767730713The modified gen p mean: 0.4468749761581421, gen p mean: -0.04675424098968506, mean p set: 0.4473552703857422
loss_pred:0.01427964586764574, decouple_loss:0.0012621431378647685
loss_pred:0.01464313454926014, decouple_loss:0.0011444489937275648
Iteration: 755, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4459710121154785, gen p mean: -0.051723726093769073, mean p set: 0.4464513063430786
loss_pred:0.014969360083341599, decouple_loss:0.0011454637860879302
The modified gen p mean: 0.4457424283027649, gen p mean: -0.05218486487865448, mean p set: 0.4462227523326874The modified gen p mean: 0.44601142406463623, gen p mean: -0.048336926847696304, mean p set: 0.44649171829223633
loss_pred:0.01507555041462183, decouple_loss:0.0011737128952518106
loss_pred:0.013816390186548233, decouple_loss:0.0012416362296789885
Iteration: 756, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466317892074585, gen p mean: -0.04984712973237038, mean p set: 0.4471120834350586
loss_pred:0.014617751352488995, decouple_loss:0.0012721836101263762
The modified gen p mean: 0.44644472002983093, gen p mean: -0.04869707301259041, mean p set: 0.4469250440597534The modified gen p mean: 0.4470670819282532, gen p mean: -0.04869780316948891, mean p set: 0.44754740595817566
loss_pred:0.014554675668478012, decouple_loss:0.0014499783283099532
loss_pred:0.014834960922598839, decouple_loss:0.0014030812308192253
Iteration: 757, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44724223017692566, gen p mean: -0.047763094305992126, mean p set: 0.44772249460220337
loss_pred:0.01448232401162386, decouple_loss:0.0014858837239444256
The modified gen p mean: 0.44523462653160095, gen p mean: -0.053639139980077744, mean p set: 0.44571492075920105The modified gen p mean: 0.4470917880535126, gen p mean: -0.04954433813691139, mean p set: 0.44757208228111267
loss_pred:0.013495001941919327, decouple_loss:0.001522977720014751
loss_pred:0.013457978144288063, decouple_loss:0.0015028847847133875
Iteration: 758, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477525055408478, gen p mean: -0.04912111908197403, mean p set: 0.44823282957077026
loss_pred:0.014239136129617691, decouple_loss:0.0013958601048216224
The modified gen p mean: 0.4466207027435303, gen p mean: -0.047948528081178665, mean p set: 0.44710099697113037The modified gen p mean: 0.4481533467769623, gen p mean: -0.04835968092083931, mean p set: 0.4486336410045624
loss_pred:0.01342145074158907, decouple_loss:0.0013533489545807242
loss_pred:0.013722456991672516, decouple_loss:0.001381550682708621
Iteration: 759, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44730597734451294, gen p mean: -0.04544208198785782, mean p set: 0.44778627157211304
loss_pred:0.01391943171620369, decouple_loss:0.0013174109626561403
The modified gen p mean: 0.4478665292263031, gen p mean: -0.04610225185751915, mean p set: 0.4483468234539032The modified gen p mean: 0.44826430082321167, gen p mean: -0.045834966003894806, mean p set: 0.4487445652484894
loss_pred:0.013344502076506615, decouple_loss:0.001267363433726132
loss_pred:0.013869828544557095, decouple_loss:0.001291091786697507
Iteration: 760, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479070007801056, gen p mean: -0.04990701377391815, mean p set: 0.4483872950077057
The modified gen p mean: 0.44653376936912537, gen p mean: -0.04661628231406212, mean p set: 0.44701406359672546
loss_pred:0.013599093072116375, decouple_loss:0.0015052629169076681
loss_pred:0.014008601196110249, decouple_loss:0.0013648400781676173
The modified gen p mean: 0.4484339952468872, gen p mean: -0.05054997280240059, mean p set: 0.4489142596721649
loss_pred:0.013552151620388031, decouple_loss:0.0013966854894533753
2023-05-01 08:23:56 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.04805789887905121, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04448946937918663, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.04478564113378525, mean p set: 0.4500633478164673
loss_pred:0.01915852725505829, decouple_loss:0.001429394818842411
loss_pred:0.01801960915327072, decouple_loss:0.0014691498363390565
loss_pred:0.018118122592568398, decouple_loss:0.0014541458804160357
WV_0_PC_1_EH_0_PS_40, loss: 0.018504632636904716, avg_mse: 0.026851441711187363
current test mse: 0.026851
Iteration: 761, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44720178842544556, gen p mean: -0.04569987952709198, mean p set: 0.44768208265304565
The modified gen p mean: 0.4474366009235382, gen p mean: -0.04502309113740921, mean p set: 0.4479168951511383
The modified gen p mean: 0.44825175404548645, gen p mean: -0.04556853696703911, mean p set: 0.44873204827308655
loss_pred:0.013357440009713173, decouple_loss:0.001395104336552322
loss_pred:0.013301792554557323, decouple_loss:0.0015085367485880852
loss_pred:0.013096176087856293, decouple_loss:0.0015058598946779966
Iteration: 762, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446228951215744, gen p mean: -0.0494433157145977, mean p set: 0.4467092752456665
loss_pred:0.013882284983992577, decouple_loss:0.0015449809143319726
The modified gen p mean: 0.4461544156074524, gen p mean: -0.048002805560827255, mean p set: 0.4466347098350525
The modified gen p mean: 0.44881632924079895, gen p mean: -0.05068496614694595, mean p set: 0.44929662346839905
loss_pred:0.013230846263468266, decouple_loss:0.0015216171741485596
loss_pred:0.013403013348579407, decouple_loss:0.001494683907367289
Iteration: 763, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44799819588661194, gen p mean: -0.047085557132959366, mean p set: 0.44847849011421204
loss_pred:0.013156017288565636, decouple_loss:0.0014582668663933873
The modified gen p mean: 0.44879618287086487, gen p mean: -0.049867548048496246, mean p set: 0.44927650690078735The modified gen p mean: 0.44723355770111084, gen p mean: -0.04492921382188797, mean p set: 0.4477138817310333
loss_pred:0.0131088150665164, decouple_loss:0.0014103747671470046
loss_pred:0.01347570400685072, decouple_loss:0.0014228376094251871
Iteration: 764, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472917318344116, gen p mean: -0.04475352540612221, mean p set: 0.4477720260620117
loss_pred:0.013399932533502579, decouple_loss:0.0014096824452280998
The modified gen p mean: 0.4469941556453705, gen p mean: -0.04716768488287926, mean p set: 0.44747447967529297The modified gen p mean: 0.44603413343429565, gen p mean: -0.051014162600040436, mean p set: 0.44651445746421814
loss_pred:0.01346481591463089, decouple_loss:0.0014489293098449707
loss_pred:0.012691590003669262, decouple_loss:0.0014427939895540476
Iteration: 765, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44694459438323975, gen p mean: -0.04892159253358841, mean p set: 0.44742488861083984
loss_pred:0.014013214968144894, decouple_loss:0.001429698197171092
The modified gen p mean: 0.44767576456069946, gen p mean: -0.04310232400894165, mean p set: 0.44815605878829956The modified gen p mean: 0.44817274808883667, gen p mean: -0.04635515436530113, mean p set: 0.4486530125141144
loss_pred:0.013069777749478817, decouple_loss:0.0013385382480919361
loss_pred:0.014496714808046818, decouple_loss:0.0013748484198004007
Iteration: 766, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44639313220977783, gen p mean: -0.0453118234872818, mean p set: 0.44687342643737793
loss_pred:0.013702689670026302, decouple_loss:0.0014285907382145524
The modified gen p mean: 0.4490118622779846, gen p mean: -0.04710948467254639, mean p set: 0.44949212670326233The modified gen p mean: 0.44795510172843933, gen p mean: -0.04194320738315582, mean p set: 0.44843539595603943
loss_pred:0.013095318339765072, decouple_loss:0.0014108464820310473
loss_pred:0.012881792150437832, decouple_loss:0.0013407873921096325
Iteration: 767, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481518566608429, gen p mean: -0.04351309314370155, mean p set: 0.4486321210861206
loss_pred:0.013157485984265804, decouple_loss:0.001302950782701373
The modified gen p mean: 0.4475573003292084, gen p mean: -0.041654445230960846, mean p set: 0.44803762435913086The modified gen p mean: 0.44811418652534485, gen p mean: -0.042994365096092224, mean p set: 0.44859448075294495
loss_pred:0.013281888328492641, decouple_loss:0.0013271603966131806
loss_pred:0.013947750441730022, decouple_loss:0.001375319785438478
Iteration: 768, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44648075103759766, gen p mean: -0.04326397180557251, mean p set: 0.44696107506752014
loss_pred:0.013373663648962975, decouple_loss:0.001284716883674264
The modified gen p mean: 0.44770726561546326, gen p mean: -0.046985577791929245, mean p set: 0.44818755984306335The modified gen p mean: 0.4486105442047119, gen p mean: -0.0476447269320488, mean p set: 0.449090838432312
loss_pred:0.012993453070521355, decouple_loss:0.001313568907789886
loss_pred:0.012875932268798351, decouple_loss:0.0013699562987312675
Iteration: 769, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44669008255004883, gen p mean: -0.0476185642182827, mean p set: 0.44717034697532654
loss_pred:0.01351164560765028, decouple_loss:0.0014211097732186317
The modified gen p mean: 0.4455767869949341, gen p mean: -0.0492570735514164, mean p set: 0.4460570514202118The modified gen p mean: 0.4465906322002411, gen p mean: -0.0467977412045002, mean p set: 0.4470709264278412
loss_pred:0.012606407515704632, decouple_loss:0.0014615082181990147
loss_pred:0.013585612177848816, decouple_loss:0.0013394085690379143
Iteration: 770, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483518600463867, gen p mean: -0.04470188543200493, mean p set: 0.4488321542739868
loss_pred:0.012942246161401272, decouple_loss:0.001349462429061532
The modified gen p mean: 0.4467604160308838, gen p mean: -0.04357524588704109, mean p set: 0.4472406804561615The modified gen p mean: 0.4466645419597626, gen p mean: -0.045510634779930115, mean p set: 0.44714486598968506
loss_pred:0.013341475278139114, decouple_loss:0.001326046185567975
loss_pred:0.01330393273383379, decouple_loss:0.001377543550916016
2023-05-01 08:25:48 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.04498085752129555, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04130789637565613, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04147534817457199, mean p set: 0.4500633478164673
loss_pred:0.019204160198569298, decouple_loss:0.0013091877335682511
loss_pred:0.017989102751016617, decouple_loss:0.0013013704447075725
loss_pred:0.018133841454982758, decouple_loss:0.0013096496695652604
WV_0_PC_1_EH_0_PS_40, loss: 0.0185077041387558, avg_mse: 0.026959221810102463
current test mse: 0.026959
Iteration: 771, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447226345539093, gen p mean: -0.044758252799510956, mean p set: 0.4477066397666931
The modified gen p mean: 0.44880780577659607, gen p mean: -0.047340743243694305, mean p set: 0.44928810000419617
The modified gen p mean: 0.44729161262512207, gen p mean: -0.042501963675022125, mean p set: 0.44777190685272217
loss_pred:0.01274843979626894, decouple_loss:0.0012939420994371176
loss_pred:0.013439648784697056, decouple_loss:0.0012633015867322683
loss_pred:0.0132076945155859, decouple_loss:0.0013116541085764766
Iteration: 772, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44639071822166443, gen p mean: -0.04335885867476463, mean p set: 0.44687098264694214
The modified gen p mean: 0.4476628601551056, gen p mean: -0.043820444494485855, mean p set: 0.4481431543827057
loss_pred:0.012986389920115471, decouple_loss:0.0013296187389642
loss_pred:0.012974328361451626, decouple_loss:0.0012422160943970084
The modified gen p mean: 0.44865882396698, gen p mean: -0.04874030500650406, mean p set: 0.44913914799690247
loss_pred:0.013264660723507404, decouple_loss:0.0013122748350724578
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 773, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470854103565216, gen p mean: -0.04044706001877785, mean p set: 0.4475656747817993
The modified gen p mean: 0.4475003480911255, gen p mean: -0.04323723912239075, mean p set: 0.4479806125164032
loss_pred:0.01324588991701603, decouple_loss:0.0012980838073417544
loss_pred:0.013125311583280563, decouple_loss:0.0012762568658217788
The modified gen p mean: 0.4478265047073364, gen p mean: -0.04233941063284874, mean p set: 0.4483067989349365
loss_pred:0.013862552121281624, decouple_loss:0.0012918879510834813
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012000_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012000_3_24hr.npz
NaN value num: 0
Iteration: 774, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44651955366134644, gen p mean: -0.042202576994895935, mean p set: 0.44699984788894653
loss_pred:0.016419176012277603, decouple_loss:0.0013841897016391158
The modified gen p mean: 0.44729548692703247, gen p mean: -0.03854701668024063, mean p set: 0.44777578115463257The modified gen p mean: 0.44694966077804565, gen p mean: -0.03500230237841606, mean p set: 0.44742998480796814
loss_pred:0.01630197837948799, decouple_loss:0.001235066563822329
loss_pred:0.017529020085930824, decouple_loss:0.00120242137927562
Iteration: 775, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471486806869507, gen p mean: -0.033700693398714066, mean p set: 0.44762900471687317
loss_pred:0.016015149652957916, decouple_loss:0.0014871887397021055
The modified gen p mean: 0.44653427600860596, gen p mean: -0.036148738116025925, mean p set: 0.44701457023620605The modified gen p mean: 0.4475298523902893, gen p mean: -0.03219137713313103, mean p set: 0.4480101466178894
loss_pred:0.016143599525094032, decouple_loss:0.0014386370312422514
loss_pred:0.0163514856249094, decouple_loss:0.0014699632301926613
Iteration: 776, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470890164375305, gen p mean: -0.041808463633060455, mean p set: 0.447569340467453
loss_pred:0.01627274975180626, decouple_loss:0.001405047602020204
The modified gen p mean: 0.4477144181728363, gen p mean: -0.03394162654876709, mean p set: 0.4481947124004364The modified gen p mean: 0.4463948905467987, gen p mean: -0.03725295886397362, mean p set: 0.4468752145767212
loss_pred:0.015782957896590233, decouple_loss:0.0012874677777290344
loss_pred:0.01708659902215004, decouple_loss:0.0013913640286773443
Iteration: 777, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4461573362350464, gen p mean: -0.03667754307389259, mean p set: 0.44663766026496887The modified gen p mean: 0.44758981466293335, gen p mean: -0.03300551697611809, mean p set: 0.44807007908821106
loss_pred:0.015679581090807915, decouple_loss:0.0014802145306020975
loss_pred:0.016172127798199654, decouple_loss:0.0015106300124898553
The modified gen p mean: 0.44772693514823914, gen p mean: -0.03740905597805977, mean p set: 0.44820722937583923
loss_pred:0.01670251041650772, decouple_loss:0.001556173898279667
Iteration: 778, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44728323817253113, gen p mean: -0.03743633255362511, mean p set: 0.4477635622024536
loss_pred:0.01590956747531891, decouple_loss:0.0013954663882032037
The modified gen p mean: 0.44905388355255127, gen p mean: -0.04136582091450691, mean p set: 0.44953420758247375The modified gen p mean: 0.4484093189239502, gen p mean: -0.03982817754149437, mean p set: 0.4488895833492279
loss_pred:0.016061104834079742, decouple_loss:0.001561918412335217
loss_pred:0.016154883429408073, decouple_loss:0.0015130768297240138
Iteration: 779, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469406008720398, gen p mean: -0.0441795289516449, mean p set: 0.4474208950996399
loss_pred:0.015595111064612865, decouple_loss:0.0015223738737404346
The modified gen p mean: 0.44735077023506165, gen p mean: -0.03481997549533844, mean p set: 0.44783106446266174The modified gen p mean: 0.44772329926490784, gen p mean: -0.04404909536242485, mean p set: 0.44820359349250793
loss_pred:0.015839869156479836, decouple_loss:0.0013467342359945178
loss_pred:0.016098354011774063, decouple_loss:0.0014207139611244202
Iteration: 780, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4463564455509186, gen p mean: -0.038516901433467865, mean p set: 0.4468367099761963
loss_pred:0.01579052209854126, decouple_loss:0.0013042838545516133
The modified gen p mean: 0.4472377598285675, gen p mean: -0.03423760086297989, mean p set: 0.4477180242538452The modified gen p mean: 0.44698768854141235, gen p mean: -0.03981020674109459, mean p set: 0.44746798276901245
loss_pred:0.015942541882395744, decouple_loss:0.0012852409854531288
loss_pred:0.016906965523958206, decouple_loss:0.001342359813861549
2023-05-01 08:28:18 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.04236562177538872, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.03880041837692261, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.039085276424884796, mean p set: 0.4500633478164673
loss_pred:0.018575387075543404, decouple_loss:0.0013197725638747215
loss_pred:0.017481695860624313, decouple_loss:0.001337287831120193
loss_pred:0.017488012090325356, decouple_loss:0.0013124393299221992
WV_0_PC_1_EH_0_PS_40, loss: 0.01791452430188656, avg_mse: 0.025755535811185837
current test mse: 0.025756
Iteration: 781, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447034627199173, gen p mean: -0.04406805709004402, mean p set: 0.4475148916244507
The modified gen p mean: 0.4480491578578949, gen p mean: -0.035761985927820206, mean p set: 0.4485294818878174
The modified gen p mean: 0.4473206698894501, gen p mean: -0.0397317111492157, mean p set: 0.44780099391937256
loss_pred:0.01557930652052164, decouple_loss:0.001257399097084999
loss_pred:0.01571940816938877, decouple_loss:0.0012937780702486634
loss_pred:0.016534730792045593, decouple_loss:0.0013426166260614991
Iteration: 782, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4459533095359802, gen p mean: -0.0407395102083683, mean p set: 0.4464336037635803
The modified gen p mean: 0.4476718306541443, gen p mean: -0.04303798824548721, mean p set: 0.448152095079422
loss_pred:0.015591256320476532, decouple_loss:0.001195062417536974
loss_pred:0.01587739586830139, decouple_loss:0.001255531213246286
The modified gen p mean: 0.4474044740200043, gen p mean: -0.04402888938784599, mean p set: 0.44788476824760437
loss_pred:0.015151403844356537, decouple_loss:0.001262183184735477
Iteration: 783, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44622308015823364, gen p mean: -0.04646569490432739, mean p set: 0.44670340418815613
loss_pred:0.01568644493818283, decouple_loss:0.001242611207999289
The modified gen p mean: 0.4471409320831299, gen p mean: -0.04647219181060791, mean p set: 0.44762122631073The modified gen p mean: 0.44848692417144775, gen p mean: -0.04787929728627205, mean p set: 0.44896718859672546
loss_pred:0.01568836160004139, decouple_loss:0.0012179025216028094
loss_pred:0.0159889105707407, decouple_loss:0.001381631474941969
Iteration: 784, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478931128978729, gen p mean: -0.04939704015851021, mean p set: 0.448373407125473
loss_pred:0.01584838703274727, decouple_loss:0.0013176754582673311
The modified gen p mean: 0.4484701454639435, gen p mean: -0.04249102994799614, mean p set: 0.4489504396915436The modified gen p mean: 0.44661176204681396, gen p mean: -0.049117665737867355, mean p set: 0.44709208607673645
loss_pred:0.016373388469219208, decouple_loss:0.0012551340041682124
loss_pred:0.01567247323691845, decouple_loss:0.0014071917394176126
Iteration: 785, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44721198081970215, gen p mean: -0.04856136813759804, mean p set: 0.44769227504730225
loss_pred:0.015336073003709316, decouple_loss:0.0011650240048766136
The modified gen p mean: 0.4470658600330353, gen p mean: -0.04229229316115379, mean p set: 0.447546124458313The modified gen p mean: 0.4474177360534668, gen p mean: -0.04986349865794182, mean p set: 0.4478980302810669
loss_pred:0.015912802889943123, decouple_loss:0.0011621910380199552
loss_pred:0.016637204214930534, decouple_loss:0.0011670138919726014
Iteration: 786, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469947814941406, gen p mean: -0.05172787606716156, mean p set: 0.4474751055240631
loss_pred:0.015336042270064354, decouple_loss:0.001162771601229906
The modified gen p mean: 0.4464568793773651, gen p mean: -0.04945356026291847, mean p set: 0.4469371736049652The modified gen p mean: 0.44717586040496826, gen p mean: -0.04929210618138313, mean p set: 0.44765612483024597
loss_pred:0.015685077756643295, decouple_loss:0.0012309285812079906
loss_pred:0.015663253143429756, decouple_loss:0.0011619984870776534
Iteration: 787, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4456823468208313, gen p mean: -0.05366494506597519, mean p set: 0.4461626410484314
loss_pred:0.015191707760095596, decouple_loss:0.001114667858928442
The modified gen p mean: 0.44757845997810364, gen p mean: -0.051870815455913544, mean p set: 0.44805875420570374The modified gen p mean: 0.44786348938941956, gen p mean: -0.05206948146224022, mean p set: 0.44834375381469727
loss_pred:0.01552347932010889, decouple_loss:0.001091772341169417
loss_pred:0.016641631722450256, decouple_loss:0.0011385927209630609
Iteration: 788, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4461892247200012, gen p mean: -0.055322274565696716, mean p set: 0.4466695487499237
loss_pred:0.015941094607114792, decouple_loss:0.0011169419158250093
The modified gen p mean: 0.44681090116500854, gen p mean: -0.055521730333566666, mean p set: 0.44729119539260864The modified gen p mean: 0.4494279623031616, gen p mean: -0.059550657868385315, mean p set: 0.44990822672843933
loss_pred:0.01553982775658369, decouple_loss:0.0012191066052764654
loss_pred:0.01577095314860344, decouple_loss:0.0013056218158453703
Iteration: 789, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469488859176636, gen p mean: -0.055417176336050034, mean p set: 0.44742920994758606
loss_pred:0.015791714191436768, decouple_loss:0.001155286910943687
The modified gen p mean: 0.4472357928752899, gen p mean: -0.05330841243267059, mean p set: 0.4477160573005676The modified gen p mean: 0.4472602307796478, gen p mean: -0.0568721629679203, mean p set: 0.4477405250072479
loss_pred:0.015627972781658173, decouple_loss:0.0011477632215246558
loss_pred:0.01553016435354948, decouple_loss:0.001093420316465199
Iteration: 790, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44760647416114807, gen p mean: -0.05228148028254509, mean p set: 0.44808676838874817
loss_pred:0.015494993887841702, decouple_loss:0.0011250510578975081
The modified gen p mean: 0.4473946988582611, gen p mean: -0.055326465517282486, mean p set: 0.4478749930858612The modified gen p mean: 0.4471362829208374, gen p mean: -0.05804385244846344, mean p set: 0.4476166069507599
loss_pred:0.015551874414086342, decouple_loss:0.0011008166475221515
loss_pred:0.015834707766771317, decouple_loss:0.0011448441073298454
2023-05-01 08:30:10 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.05378430709242821, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04957086220383644, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.050253577530384064, mean p set: 0.4500633478164673
loss_pred:0.01842816360294819, decouple_loss:0.001145771355368197
loss_pred:0.017357809469103813, decouple_loss:0.0011128134792670608
loss_pred:0.017380857840180397, decouple_loss:0.0011085758451372385
WV_0_PC_1_EH_0_PS_40, loss: 0.017778396606445312, avg_mse: 0.02555401436984539
current test mse: 0.025554
Iteration: 791, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476805627346039, gen p mean: -0.051388733088970184, mean p set: 0.448160856962204
The modified gen p mean: 0.44615963101387024, gen p mean: -0.05073998123407364, mean p set: 0.4466399550437927
The modified gen p mean: 0.44671183824539185, gen p mean: -0.05275214836001396, mean p set: 0.44719216227531433
loss_pred:0.015169534832239151, decouple_loss:0.0010860281763598323
loss_pred:0.016003530472517014, decouple_loss:0.0010939465137198567loss_pred:0.015615670010447502, decouple_loss:0.0011141124414280057
Iteration: 792, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473946690559387, gen p mean: -0.04924120754003525, mean p set: 0.4478749632835388
The modified gen p mean: 0.4473939538002014, gen p mean: -0.05242360383272171, mean p set: 0.4478742182254791
loss_pred:0.0155491279438138, decouple_loss:0.0011336160823702812
loss_pred:0.016223877668380737, decouple_loss:0.0011562771396711469
The modified gen p mean: 0.44731464982032776, gen p mean: -0.0479099415242672, mean p set: 0.44779494404792786
loss_pred:0.016106808558106422, decouple_loss:0.0011606878833845258
Iteration: 793, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44675564765930176, gen p mean: -0.049981556832790375, mean p set: 0.44723597168922424
loss_pred:0.01583842933177948, decouple_loss:0.001078941859304905
The modified gen p mean: 0.44754984974861145, gen p mean: -0.04697953909635544, mean p set: 0.44803011417388916The modified gen p mean: 0.44558024406433105, gen p mean: -0.0495302751660347, mean p set: 0.44606053829193115
loss_pred:0.016758935526013374, decouple_loss:0.0011452998733147979
loss_pred:0.015175812877714634, decouple_loss:0.0011074882932007313
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012014_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012014_3_24hr.npz
NaN value num: 0
Iteration: 794, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45108312368392944, gen p mean: -0.04326161369681358, mean p set: 0.45156341791152954
loss_pred:0.016560139134526253, decouple_loss:0.0012076250277459621
The modified gen p mean: 0.4518849551677704, gen p mean: -0.04760080203413963, mean p set: 0.4523652195930481The modified gen p mean: 0.45077091455459595, gen p mean: -0.043912824243307114, mean p set: 0.45125120878219604
loss_pred:0.01708712801337242, decouple_loss:0.0012459520949050784
loss_pred:0.016900919377803802, decouple_loss:0.0011489151511341333
Iteration: 795, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504571557044983, gen p mean: -0.044164564460515976, mean p set: 0.450937420129776
loss_pred:0.016754494979977608, decouple_loss:0.0012204133672639728
The modified gen p mean: 0.4500598609447479, gen p mean: -0.04299835488200188, mean p set: 0.45054012537002563The modified gen p mean: 0.4517694115638733, gen p mean: -0.04011174663901329, mean p set: 0.4522497057914734
loss_pred:0.016959618777036667, decouple_loss:0.0012854188680648804
loss_pred:0.017131853848695755, decouple_loss:0.0012579172616824508
Iteration: 796, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45142993330955505, gen p mean: -0.04303537309169769, mean p set: 0.45191025733947754
The modified gen p mean: 0.45007872581481934, gen p mean: -0.0457429476082325, mean p set: 0.45055902004241943
loss_pred:0.016260743141174316, decouple_loss:0.0012355227954685688
loss_pred:0.016542993485927582, decouple_loss:0.0012804717989638448
The modified gen p mean: 0.44920673966407776, gen p mean: -0.04640316963195801, mean p set: 0.44968703389167786
loss_pred:0.016792485490441322, decouple_loss:0.0012900658184662461
Iteration: 797, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45024293661117554, gen p mean: -0.0404551737010479, mean p set: 0.45072323083877563
The modified gen p mean: 0.4500267207622528, gen p mean: -0.03869856148958206, mean p set: 0.4505070447921753
loss_pred:0.015897853299975395, decouple_loss:0.0014103968860581517
loss_pred:0.01779549941420555, decouple_loss:0.0014171896036714315
The modified gen p mean: 0.45292118191719055, gen p mean: -0.04017158970236778, mean p set: 0.45340150594711304
loss_pred:0.01676199771463871, decouple_loss:0.0014566087629646063
Iteration: 798, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44960248470306396, gen p mean: -0.04407912865281105, mean p set: 0.45008277893066406
loss_pred:0.016591493040323257, decouple_loss:0.0011887367581948638
The modified gen p mean: 0.45049917697906494, gen p mean: -0.0455378033220768, mean p set: 0.45097947120666504The modified gen p mean: 0.4492179751396179, gen p mean: -0.04894934594631195, mean p set: 0.4496982991695404
loss_pred:0.016758758574724197, decouple_loss:0.0011079005198553205
loss_pred:0.01602424494922161, decouple_loss:0.0011320598423480988
Iteration: 799, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45041683316230774, gen p mean: -0.04574338346719742, mean p set: 0.4508971571922302
loss_pred:0.016253001987934113, decouple_loss:0.0013652755878865719
The modified gen p mean: 0.45054343342781067, gen p mean: -0.04692805930972099, mean p set: 0.4510236978530884The modified gen p mean: 0.44935160875320435, gen p mean: -0.04484102502465248, mean p set: 0.44983193278312683
loss_pred:0.016028769314289093, decouple_loss:0.0012659974163398147
loss_pred:0.017730247229337692, decouple_loss:0.0013328470522537827
Iteration: 800, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45270371437072754, gen p mean: -0.049671612679958344, mean p set: 0.45318400859832764
loss_pred:0.01700648106634617, decouple_loss:0.0011961462441831827
The modified gen p mean: 0.4519236385822296, gen p mean: -0.049772411584854126, mean p set: 0.4524039626121521The modified gen p mean: 0.4502231180667877, gen p mean: -0.046111322939395905, mean p set: 0.4507034122943878
loss_pred:0.016442740336060524, decouple_loss:0.0011331249261274934
loss_pred:0.015889771282672882, decouple_loss:0.001166501664556563
2023-05-01 08:32:35 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.057569243013858795, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.05356832966208458, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.05413943901658058, mean p set: 0.4500633478164673
loss_pred:0.018485693261027336, decouple_loss:0.001410181517712772
loss_pred:0.017344247549772263, decouple_loss:0.0014043145347386599
loss_pred:0.017429685220122337, decouple_loss:0.0013535834150388837
WV_0_PC_1_EH_0_PS_40, loss: 0.01782267726957798, avg_mse: 0.02560807392001152
current test mse: 0.025608
Iteration: 801, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45019471645355225, gen p mean: -0.04796402528882027, mean p set: 0.45067504048347473
The modified gen p mean: 0.4497902989387512, gen p mean: -0.04802831634879112, mean p set: 0.4502705931663513
The modified gen p mean: 0.4504399001598358, gen p mean: -0.04845980554819107, mean p set: 0.4509201943874359
loss_pred:0.01637660339474678, decouple_loss:0.0013796946732327342
loss_pred:0.016209974884986877, decouple_loss:0.0013190357713028789
loss_pred:0.015915539115667343, decouple_loss:0.0012802958954125643
Iteration: 802, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501752555370331, gen p mean: -0.05092615261673927, mean p set: 0.4506555497646332
The modified gen p mean: 0.450313001871109, gen p mean: -0.046318382024765015, mean p set: 0.4507932960987091
loss_pred:0.016724327579140663, decouple_loss:0.0012575052678585052
loss_pred:0.01600828766822815, decouple_loss:0.001122735091485083The modified gen p mean: 0.45299437642097473, gen p mean: -0.04960024356842041, mean p set: 0.45347464084625244
loss_pred:0.01651301048696041, decouple_loss:0.0012570768594741821
Iteration: 803, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450580358505249, gen p mean: -0.04483884945511818, mean p set: 0.4510606527328491
loss_pred:0.01652512699365616, decouple_loss:0.0013400432653725147
The modified gen p mean: 0.4504378139972687, gen p mean: -0.047757990658283234, mean p set: 0.4509181082248688
The modified gen p mean: 0.4494049847126007, gen p mean: -0.044477805495262146, mean p set: 0.4498852789402008
loss_pred:0.016311025246977806, decouple_loss:0.0012879699934273958
loss_pred:0.017089175060391426, decouple_loss:0.0013475514715537429
Iteration: 804, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4520682990550995, gen p mean: -0.048907674849033356, mean p set: 0.4525485932826996
loss_pred:0.016557155176997185, decouple_loss:0.0013303160667419434
The modified gen p mean: 0.45139604806900024, gen p mean: -0.04542403295636177, mean p set: 0.45187634229660034The modified gen p mean: 0.4532533288002014, gen p mean: -0.04597543925046921, mean p set: 0.4537335932254791
loss_pred:0.016469398513436317, decouple_loss:0.0012357296654954553
loss_pred:0.016656246036291122, decouple_loss:0.0014090995537117124
Iteration: 805, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494568109512329, gen p mean: -0.045716721564531326, mean p set: 0.449937105178833
loss_pred:0.015700697898864746, decouple_loss:0.0014019259251654148
The modified gen p mean: 0.4515954256057739, gen p mean: -0.045033399015665054, mean p set: 0.45207569003105164The modified gen p mean: 0.44996997714042664, gen p mean: -0.044477540999650955, mean p set: 0.4504503011703491
loss_pred:0.01684745028614998, decouple_loss:0.0012652046279981732
loss_pred:0.016138380393385887, decouple_loss:0.0013088630512356758
Iteration: 806, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45020055770874023, gen p mean: -0.04351557418704033, mean p set: 0.45068085193634033
loss_pred:0.015780197456479073, decouple_loss:0.0013957847841084003
The modified gen p mean: 0.4526252746582031, gen p mean: -0.04510369151830673, mean p set: 0.4531055688858032The modified gen p mean: 0.44996151328086853, gen p mean: -0.045136015862226486, mean p set: 0.450441837310791
loss_pred:0.016702264547348022, decouple_loss:0.0013202335685491562
loss_pred:0.016354918479919434, decouple_loss:0.001377331092953682
Iteration: 807, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45263898372650146, gen p mean: -0.04415329918265343, mean p set: 0.45311927795410156
loss_pred:0.016163716092705727, decouple_loss:0.0011684385826811194
The modified gen p mean: 0.44915416836738586, gen p mean: -0.048978812992572784, mean p set: 0.44963446259498596The modified gen p mean: 0.4514337182044983, gen p mean: -0.05088918283581734, mean p set: 0.4519140422344208
loss_pred:0.01696784794330597, decouple_loss:0.0012485921615734696
loss_pred:0.016232511028647423, decouple_loss:0.001168208778835833
Iteration: 808, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45090559124946594, gen p mean: -0.04276340454816818, mean p set: 0.4513859152793884
loss_pred:0.01694328337907791, decouple_loss:0.001351459650322795
The modified gen p mean: 0.45062196254730225, gen p mean: -0.04229414090514183, mean p set: 0.45110225677490234The modified gen p mean: 0.45077022910118103, gen p mean: -0.04004620015621185, mean p set: 0.4512505531311035
loss_pred:0.016293151304125786, decouple_loss:0.0013845694484189153
loss_pred:0.017033005133271217, decouple_loss:0.0013231501216068864
Iteration: 809, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503708779811859, gen p mean: -0.043999847024679184, mean p set: 0.4508511424064636
loss_pred:0.01651928201317787, decouple_loss:0.0011398522183299065
The modified gen p mean: 0.4504302740097046, gen p mean: -0.04622437059879303, mean p set: 0.4509105384349823The modified gen p mean: 0.45261842012405396, gen p mean: -0.04413643106818199, mean p set: 0.45309871435165405
loss_pred:0.016601091250777245, decouple_loss:0.001252543181180954
loss_pred:0.016377033665776253, decouple_loss:0.001199262449517846
Iteration: 810, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45138290524482727, gen p mean: -0.04844696447253227, mean p set: 0.45186319947242737
loss_pred:0.016649825498461723, decouple_loss:0.0013077305629849434
The modified gen p mean: 0.4532553255558014, gen p mean: -0.04200153052806854, mean p set: 0.4537356197834015The modified gen p mean: 0.4500761032104492, gen p mean: -0.04509435221552849, mean p set: 0.4505563974380493
loss_pred:0.016745353117585182, decouple_loss:0.001480180537328124
loss_pred:0.01704205758869648, decouple_loss:0.0013164476258680224
2023-05-01 08:34:27 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.05187409371137619, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04773430898785591, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.04827810823917389, mean p set: 0.4500633478164673
loss_pred:0.01847362518310547, decouple_loss:0.0013711716746911407
loss_pred:0.01731862872838974, decouple_loss:0.0012867203913629055
loss_pred:0.01743263751268387, decouple_loss:0.0013023685896769166
WV_0_PC_1_EH_0_PS_40, loss: 0.01780763640999794, avg_mse: 0.02556736208498478
current test mse: 0.025567
Iteration: 811, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496538043022156, gen p mean: -0.04715902730822563, mean p set: 0.4501340985298157
The modified gen p mean: 0.45214036107063293, gen p mean: -0.04847954958677292, mean p set: 0.45262065529823303
The modified gen p mean: 0.4513232409954071, gen p mean: -0.04555865749716759, mean p set: 0.4518035352230072
loss_pred:0.016394497826695442, decouple_loss:0.0012358204694464803
loss_pred:0.016638213768601418, decouple_loss:0.0013111564330756664
loss_pred:0.01655883714556694, decouple_loss:0.0011810578871518373
Iteration: 812, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4525906443595886, gen p mean: -0.049454815685749054, mean p set: 0.4530709385871887
The modified gen p mean: 0.4500027298927307, gen p mean: -0.04233153536915779, mean p set: 0.4504829943180084
loss_pred:0.01611694134771824, decouple_loss:0.0012850105995312333
loss_pred:0.015253089368343353, decouple_loss:0.0013044987572357059
The modified gen p mean: 0.45068982243537903, gen p mean: -0.04027831554412842, mean p set: 0.4511701166629791
loss_pred:0.016077222302556038, decouple_loss:0.0012266297126188874
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012013_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012013_3_24hr.npz
NaN value num: 0
Iteration: 813, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45143359899520874, gen p mean: -0.04893774911761284, mean p set: 0.45191389322280884
loss_pred:0.016447214409708977, decouple_loss:0.0012682484230026603
The modified gen p mean: 0.450664222240448, gen p mean: -0.04907657951116562, mean p set: 0.4511445164680481The modified gen p mean: 0.4490281939506531, gen p mean: -0.046667538583278656, mean p set: 0.4495084881782532
loss_pred:0.016835911199450493, decouple_loss:0.0012115304125472903
loss_pred:0.016495415940880775, decouple_loss:0.0011401468655094504
Iteration: 814, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44914960861206055, gen p mean: -0.0466914065182209, mean p set: 0.44962990283966064
loss_pred:0.017139114439487457, decouple_loss:0.0013417007867246866
The modified gen p mean: 0.44977468252182007, gen p mean: -0.04880055412650108, mean p set: 0.45025497674942017The modified gen p mean: 0.4503542184829712, gen p mean: -0.044682953506708145, mean p set: 0.4508344829082489
loss_pred:0.016737427562475204, decouple_loss:0.0013221915578469634
loss_pred:0.016474787145853043, decouple_loss:0.0013071332359686494
Iteration: 815, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502987265586853, gen p mean: -0.04887712001800537, mean p set: 0.4507790505886078
loss_pred:0.016725728288292885, decouple_loss:0.0012654962483793497
The modified gen p mean: 0.4475767910480499, gen p mean: -0.04691093787550926, mean p set: 0.4480571150779724The modified gen p mean: 0.45064085721969604, gen p mean: -0.05464593693614006, mean p set: 0.45112112164497375
loss_pred:0.016041604802012444, decouple_loss:0.0012693105963990092
loss_pred:0.016393115743994713, decouple_loss:0.0011867685243487358
Iteration: 816, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45018118619918823, gen p mean: -0.05195508524775505, mean p set: 0.45066148042678833
loss_pred:0.016086701303720474, decouple_loss:0.0012440773425623775
The modified gen p mean: 0.4502270519733429, gen p mean: -0.05358872190117836, mean p set: 0.4507073163986206The modified gen p mean: 0.4491533041000366, gen p mean: -0.050766292959451675, mean p set: 0.4496335983276367
loss_pred:0.016880903393030167, decouple_loss:0.0012481017038226128
loss_pred:0.015936823561787605, decouple_loss:0.0011949804611504078
Iteration: 817, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493718445301056, gen p mean: -0.05355533957481384, mean p set: 0.4498521387577057
loss_pred:0.01672237366437912, decouple_loss:0.00122190045658499
The modified gen p mean: 0.4497581422328949, gen p mean: -0.05175022780895233, mean p set: 0.450238436460495The modified gen p mean: 0.4488906264305115, gen p mean: -0.052679967135190964, mean p set: 0.4493708908557892
loss_pred:0.016219552606344223, decouple_loss:0.0012205002130940557
loss_pred:0.01697772927582264, decouple_loss:0.0013304171152412891
Iteration: 818, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487893283367157, gen p mean: -0.051959387958049774, mean p set: 0.4492696523666382
loss_pred:0.01622672565281391, decouple_loss:0.0011889118468388915
The modified gen p mean: 0.4497682452201843, gen p mean: -0.04929891973733902, mean p set: 0.4502485692501068The modified gen p mean: 0.45052289962768555, gen p mean: -0.05181973800063133, mean p set: 0.45100319385528564
loss_pred:0.016131769865751266, decouple_loss:0.0011684804921969771
loss_pred:0.01653776504099369, decouple_loss:0.0011899458477273583
Iteration: 819, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501963257789612, gen p mean: -0.054098837077617645, mean p set: 0.4506766200065613
loss_pred:0.016052329912781715, decouple_loss:0.0013511130819097161
The modified gen p mean: 0.4486197829246521, gen p mean: -0.04952537268400192, mean p set: 0.4491001069545746The modified gen p mean: 0.4504499137401581, gen p mean: -0.055425744503736496, mean p set: 0.4509302079677582
loss_pred:0.016285046935081482, decouple_loss:0.001224001869559288
loss_pred:0.016188189387321472, decouple_loss:0.0014032734325155616
Iteration: 820, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498160481452942, gen p mean: -0.047580424696207047, mean p set: 0.4502963423728943
loss_pred:0.015355215407907963, decouple_loss:0.0013060207711532712
The modified gen p mean: 0.4507297873497009, gen p mean: -0.05128323659300804, mean p set: 0.451210081577301The modified gen p mean: 0.4504632353782654, gen p mean: -0.04968991130590439, mean p set: 0.4509435296058655
loss_pred:0.016236433759331703, decouple_loss:0.001211607246659696
loss_pred:0.016512667760252953, decouple_loss:0.0012136765290051699
2023-05-01 08:36:57 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.051059868186712265, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04698040336370468, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04738352447748184, mean p set: 0.4500633478164673
loss_pred:0.018581466749310493, decouple_loss:0.001380215398967266
loss_pred:0.01746799610555172, decouple_loss:0.001335251610726118
loss_pred:0.017543762922286987, decouple_loss:0.001332416315563023
WV_0_PC_1_EH_0_PS_40, loss: 0.017931874841451645, avg_mse: 0.025819934904575348
current test mse: 0.02582
Iteration: 821, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45121094584465027, gen p mean: -0.04648740962147713, mean p set: 0.451691210269928
The modified gen p mean: 0.4498402774333954, gen p mean: -0.052194707095623016, mean p set: 0.4503205716609955
The modified gen p mean: 0.45086774230003357, gen p mean: -0.04769944027066231, mean p set: 0.45134806632995605
loss_pred:0.01642749086022377, decouple_loss:0.0014429896837100387
loss_pred:0.015963487327098846, decouple_loss:0.001219548867084086
loss_pred:0.016261620447039604, decouple_loss:0.0015187878161668777
Iteration: 822, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492305815219879, gen p mean: -0.042691610753536224, mean p set: 0.449710875749588
loss_pred:0.016601664945483208, decouple_loss:0.001126892864704132
The modified gen p mean: 0.44861987233161926, gen p mean: -0.044815413653850555, mean p set: 0.44910016655921936The modified gen p mean: 0.4509749114513397, gen p mean: -0.048535995185375214, mean p set: 0.4514552056789398
loss_pred:0.016684016212821007, decouple_loss:0.0013289415510371327
loss_pred:0.016089310869574547, decouple_loss:0.0011769876582548022
Iteration: 823, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44930556416511536, gen p mean: -0.04343131184577942, mean p set: 0.44978588819503784
loss_pred:0.017010943964123726, decouple_loss:0.0014410145813599229
The modified gen p mean: 0.45072245597839355, gen p mean: -0.0465901680290699, mean p set: 0.45120275020599365
The modified gen p mean: 0.45012760162353516, gen p mean: -0.04251466691493988, mean p set: 0.45060789585113525
loss_pred:0.01579182595014572, decouple_loss:0.0013044924708083272
loss_pred:0.016529059037566185, decouple_loss:0.0013023982755839825
Iteration: 824, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45092812180519104, gen p mean: -0.04771919175982475, mean p set: 0.45140841603279114
loss_pred:0.016343677416443825, decouple_loss:0.001228216104209423
The modified gen p mean: 0.44987475872039795, gen p mean: -0.048884887248277664, mean p set: 0.45035505294799805The modified gen p mean: 0.450836181640625, gen p mean: -0.041194915771484375, mean p set: 0.4513164758682251
loss_pred:0.01646663434803486, decouple_loss:0.0012607722310349345
loss_pred:0.01616721972823143, decouple_loss:0.0012578206369653344
Iteration: 825, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45036378502845764, gen p mean: -0.040863022208213806, mean p set: 0.45084407925605774The modified gen p mean: 0.4474261403083801, gen p mean: -0.04311381280422211, mean p set: 0.4479064345359802
loss_pred:0.01684839278459549, decouple_loss:0.0012446284526959062
loss_pred:0.016179686412215233, decouple_loss:0.0012242201482877135
The modified gen p mean: 0.45089560747146606, gen p mean: -0.04770733788609505, mean p set: 0.45137593150138855
loss_pred:0.01693916693329811, decouple_loss:0.0013424349017441273
Iteration: 826, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45106908679008484, gen p mean: -0.04620331898331642, mean p set: 0.45154935121536255
The modified gen p mean: 0.44932565093040466, gen p mean: -0.043930087238550186, mean p set: 0.4498059153556824
loss_pred:0.016964275389909744, decouple_loss:0.0015471128281205893
loss_pred:0.01641569845378399, decouple_loss:0.0014384562382474542
The modified gen p mean: 0.4502500593662262, gen p mean: -0.046592362225055695, mean p set: 0.4507302939891815
loss_pred:0.016168605536222458, decouple_loss:0.001587512088008225
Iteration: 827, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491064250469208, gen p mean: -0.04566643014550209, mean p set: 0.44958674907684326
The modified gen p mean: 0.4508408308029175, gen p mean: -0.04890548810362816, mean p set: 0.4513210952281952
loss_pred:0.01654282584786415, decouple_loss:0.0011096097296103835
loss_pred:0.01605123281478882, decouple_loss:0.0011667838552966714
The modified gen p mean: 0.45054301619529724, gen p mean: -0.04926150664687157, mean p set: 0.4510233402252197
loss_pred:0.016198940575122833, decouple_loss:0.0011879096273332834
Iteration: 828, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503313899040222, gen p mean: -0.04453762248158455, mean p set: 0.4508116841316223
The modified gen p mean: 0.45062705874443054, gen p mean: -0.04869575425982475, mean p set: 0.451107382774353
loss_pred:0.016443459317088127, decouple_loss:0.0012769486056640744
loss_pred:0.015874579548835754, decouple_loss:0.0012960574822500348
The modified gen p mean: 0.4507967233657837, gen p mean: -0.049586836248636246, mean p set: 0.4512770175933838
loss_pred:0.016230659559369087, decouple_loss:0.001329410239122808
Iteration: 829, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44876593351364136, gen p mean: -0.047037042677402496, mean p set: 0.44924622774124146
loss_pred:0.015961097553372383, decouple_loss:0.0011399759678170085
The modified gen p mean: 0.45021581649780273, gen p mean: -0.05383124202489853, mean p set: 0.45069611072540283The modified gen p mean: 0.44924396276474, gen p mean: -0.04507654160261154, mean p set: 0.4497242569923401
loss_pred:0.015417274087667465, decouple_loss:0.0013083539670333266
loss_pred:0.016581416130065918, decouple_loss:0.0012631614226847887
Iteration: 830, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44862794876098633, gen p mean: -0.04999667778611183, mean p set: 0.44910821318626404
loss_pred:0.016259098425507545, decouple_loss:0.0010920350905507803
The modified gen p mean: 0.4506102502346039, gen p mean: -0.053032126277685165, mean p set: 0.451090544462204The modified gen p mean: 0.4498802423477173, gen p mean: -0.04422013834118843, mean p set: 0.4503605365753174
loss_pred:0.015581098385155201, decouple_loss:0.0013086835388094187
loss_pred:0.015784861519932747, decouple_loss:0.0012712898897007108
2023-05-01 08:38:50 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.05298898369073868, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04890013113617897, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.04940544068813324, mean p set: 0.4500633478164673
loss_pred:0.01862894557416439, decouple_loss:0.0012390408664941788
loss_pred:0.017419688403606415, decouple_loss:0.0012081526219844818
loss_pred:0.01756412535905838, decouple_loss:0.001193257630802691
WV_0_PC_1_EH_0_PS_40, loss: 0.01793159358203411, avg_mse: 0.025845175608992577
current test mse: 0.025845
Iteration: 831, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501218795776367, gen p mean: -0.05193212628364563, mean p set: 0.45060214400291443
The modified gen p mean: 0.4509217143058777, gen p mean: -0.051182761788368225, mean p set: 0.4514020085334778
The modified gen p mean: 0.45033878087997437, gen p mean: -0.05369342863559723, mean p set: 0.45081907510757446
loss_pred:0.015775011852383614, decouple_loss:0.0012340160319581628
loss_pred:0.01637428253889084, decouple_loss:0.0012352928752079606
loss_pred:0.016322221606969833, decouple_loss:0.0012935803970322013
Iteration: 832, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507124722003937, gen p mean: -0.05504891648888588, mean p set: 0.45119279623031616
loss_pred:0.01568595878779888, decouple_loss:0.0012576403096318245
The modified gen p mean: 0.4498560428619385, gen p mean: -0.05033845826983452, mean p set: 0.4503363370895386The modified gen p mean: 0.4486290216445923, gen p mean: -0.05331357195973396, mean p set: 0.4491093158721924
loss_pred:0.016638634726405144, decouple_loss:0.0011370721040293574
loss_pred:0.01647709682583809, decouple_loss:0.0011816496262326837
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012014_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012014_3_24hr.npz
NaN value num: 0
Iteration: 833, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467674791812897, gen p mean: -0.0491739921271801, mean p set: 0.44724777340888977
loss_pred:0.016761451959609985, decouple_loss:0.0012227058177813888
The modified gen p mean: 0.44614872336387634, gen p mean: -0.0584266223013401, mean p set: 0.44662904739379883The modified gen p mean: 0.4481840431690216, gen p mean: -0.051550865173339844, mean p set: 0.4486643373966217
loss_pred:0.01788693107664585, decouple_loss:0.001026000245474279
loss_pred:0.016818450763821602, decouple_loss:0.0012204984668642282
Iteration: 834, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468212425708771, gen p mean: -0.05359293892979622, mean p set: 0.44730156660079956
loss_pred:0.017124520614743233, decouple_loss:0.0012485157931223512
The modified gen p mean: 0.44628244638442993, gen p mean: -0.056463271379470825, mean p set: 0.4467627704143524The modified gen p mean: 0.4463682472705841, gen p mean: -0.05528317019343376, mean p set: 0.4468485414981842
loss_pred:0.01686248928308487, decouple_loss:0.0011454169871285558
loss_pred:0.016125932335853577, decouple_loss:0.001151748700067401
Iteration: 835, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44708535075187683, gen p mean: -0.053880710154771805, mean p set: 0.44756564497947693
loss_pred:0.016096562147140503, decouple_loss:0.0010929679265245795
The modified gen p mean: 0.44829297065734863, gen p mean: -0.050950728356838226, mean p set: 0.44877323508262634The modified gen p mean: 0.4469218850135803, gen p mean: -0.04790830984711647, mean p set: 0.4474022090435028
loss_pred:0.017243003472685814, decouple_loss:0.0013120645890012383
loss_pred:0.017534289509058, decouple_loss:0.0013928089756518602
Iteration: 836, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4463445842266083, gen p mean: -0.05092320218682289, mean p set: 0.4468248784542084
The modified gen p mean: 0.4466865360736847, gen p mean: -0.047127269208431244, mean p set: 0.4471668004989624
loss_pred:0.01641610823571682, decouple_loss:0.0011570426868274808
loss_pred:0.017349733039736748, decouple_loss:0.001096353866159916
The modified gen p mean: 0.4470100402832031, gen p mean: -0.04986140877008438, mean p set: 0.4474903643131256
loss_pred:0.0165137629956007, decouple_loss:0.0011869933223351836
Iteration: 837, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468585252761841, gen p mean: -0.05223590508103371, mean p set: 0.4473387897014618
The modified gen p mean: 0.44689828157424927, gen p mean: -0.04866686090826988, mean p set: 0.44737857580184937
loss_pred:0.016542736440896988, decouple_loss:0.0011664596386253834
loss_pred:0.017454124987125397, decouple_loss:0.0011099714320152998
The modified gen p mean: 0.44659125804901123, gen p mean: -0.05307973548769951, mean p set: 0.44707152247428894
loss_pred:0.016342924907803535, decouple_loss:0.0012331026373431087
Iteration: 838, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480167329311371, gen p mean: -0.04975743964314461, mean p set: 0.4484969973564148
The modified gen p mean: 0.44636473059654236, gen p mean: -0.052740830928087234, mean p set: 0.44684502482414246
The modified gen p mean: 0.4475116431713104, gen p mean: -0.052360162138938904, mean p set: 0.44799190759658813
loss_pred:0.017541006207466125, decouple_loss:0.001101206406019628
loss_pred:0.01619766093790531, decouple_loss:0.0010810986859723926loss_pred:0.01601393334567547, decouple_loss:0.0012150872498750687
Iteration: 839, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44776710867881775, gen p mean: -0.0533355288207531, mean p set: 0.44824743270874023
loss_pred:0.017534729093313217, decouple_loss:0.0011296928860247135
The modified gen p mean: 0.44592970609664917, gen p mean: -0.053786031901836395, mean p set: 0.44641000032424927The modified gen p mean: 0.4468817412853241, gen p mean: -0.05217587575316429, mean p set: 0.4473620653152466
loss_pred:0.01691291667521, decouple_loss:0.001085389289073646
loss_pred:0.017225714400410652, decouple_loss:0.001061906572431326
Iteration: 840, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44753193855285645, gen p mean: -0.05342325568199158, mean p set: 0.44801223278045654
The modified gen p mean: 0.4462626576423645, gen p mean: -0.04811674356460571, mean p set: 0.446742981672287
loss_pred:0.01756514608860016, decouple_loss:0.0012385027948766947
loss_pred:0.01713136024773121, decouple_loss:0.0012002246221527457
The modified gen p mean: 0.4489080309867859, gen p mean: -0.04681283235549927, mean p set: 0.449388325214386
loss_pred:0.017113294452428818, decouple_loss:0.0012230254942551255
2023-05-01 08:41:18 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.05155999958515167, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.0476398766040802, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04784102365374565, mean p set: 0.4500633478164673
loss_pred:0.018504612147808075, decouple_loss:0.0011049672029912472
loss_pred:0.017479564994573593, decouple_loss:0.0010692393407225609loss_pred:0.017369624227285385, decouple_loss:0.0010897960746660829
WV_0_PC_1_EH_0_PS_40, loss: 0.01783899962902069, avg_mse: 0.02566949836909771
current test mse: 0.025669
Iteration: 841, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477754235267639, gen p mean: -0.048960115760564804, mean p set: 0.4482557475566864
The modified gen p mean: 0.44618141651153564, gen p mean: -0.0456499382853508, mean p set: 0.44666171073913574
The modified gen p mean: 0.4473278820514679, gen p mean: -0.045202989131212234, mean p set: 0.4478082060813904
loss_pred:0.01676056534051895, decouple_loss:0.0010198357049375772
loss_pred:0.01705978997051716, decouple_loss:0.0010876243468374014
loss_pred:0.01657532900571823, decouple_loss:0.001077531254850328
Iteration: 842, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483528137207031, gen p mean: -0.046346575021743774, mean p set: 0.44883307814598083
loss_pred:0.01765676587820053, decouple_loss:0.0010328444186598063
The modified gen p mean: 0.44858789443969727, gen p mean: -0.04656623676419258, mean p set: 0.44906821846961975The modified gen p mean: 0.4461723566055298, gen p mean: -0.0534425713121891, mean p set: 0.4466526508331299
loss_pred:0.01649225503206253, decouple_loss:0.0010260019917041063
loss_pred:0.016361374408006668, decouple_loss:0.0010680592386052012
Iteration: 843, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44828104972839355, gen p mean: -0.04823882505297661, mean p set: 0.44876134395599365
loss_pred:0.01797710545361042, decouple_loss:0.0010664035798981786
The modified gen p mean: 0.44600510597229004, gen p mean: -0.04869208112359047, mean p set: 0.44648540019989014The modified gen p mean: 0.44634950160980225, gen p mean: -0.049563270062208176, mean p set: 0.44682982563972473
loss_pred:0.01726522669196129, decouple_loss:0.0011993655934929848
loss_pred:0.016840318217873573, decouple_loss:0.0012146541848778725
Iteration: 844, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484892189502716, gen p mean: -0.04877406358718872, mean p set: 0.4489694833755493
loss_pred:0.017307274043560028, decouple_loss:0.0011370350839570165
The modified gen p mean: 0.44731980562210083, gen p mean: -0.0495045967400074, mean p set: 0.44780007004737854The modified gen p mean: 0.445794939994812, gen p mean: -0.05279796943068504, mean p set: 0.4462752044200897
loss_pred:0.016694990918040276, decouple_loss:0.0011811885051429272
loss_pred:0.016812963411211967, decouple_loss:0.0011382944649085402
Iteration: 845, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4461558759212494, gen p mean: -0.049275897443294525, mean p set: 0.4466361403465271
The modified gen p mean: 0.44708576798439026, gen p mean: -0.04775235801935196, mean p set: 0.44756606221199036
loss_pred:0.01657073386013508, decouple_loss:0.0010569639271125197
loss_pred:0.016267813742160797, decouple_loss:0.0011068820022046566
The modified gen p mean: 0.44763386249542236, gen p mean: -0.049911465495824814, mean p set: 0.44811415672302246
loss_pred:0.017413444817066193, decouple_loss:0.0010853806743398309
Iteration: 846, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44629043340682983, gen p mean: -0.0489514097571373, mean p set: 0.4467707574367523
loss_pred:0.016998037695884705, decouple_loss:0.0011401670053601265
The modified gen p mean: 0.4487491250038147, gen p mean: -0.047892794013023376, mean p set: 0.4492294192314148The modified gen p mean: 0.44673365354537964, gen p mean: -0.043149709701538086, mean p set: 0.4472139775753021
loss_pred:0.017397619783878326, decouple_loss:0.0010431327391415834
loss_pred:0.01643694005906582, decouple_loss:0.00114756403490901
Iteration: 847, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469245970249176, gen p mean: -0.048388246446847916, mean p set: 0.4474048614501953
loss_pred:0.016645580530166626, decouple_loss:0.001082909875549376
The modified gen p mean: 0.4477894604206085, gen p mean: -0.044412702322006226, mean p set: 0.44826972484588623The modified gen p mean: 0.44622454047203064, gen p mean: -0.045364197343587875, mean p set: 0.44670480489730835
loss_pred:0.016533315181732178, decouple_loss:0.0010281511349603534
loss_pred:0.01607062667608261, decouple_loss:0.001101547502912581
Iteration: 848, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475215971469879, gen p mean: -0.04640932008624077, mean p set: 0.448001891374588
loss_pred:0.017524724826216698, decouple_loss:0.001186360721476376
The modified gen p mean: 0.4460732042789459, gen p mean: -0.04556281864643097, mean p set: 0.446553498506546The modified gen p mean: 0.448238730430603, gen p mean: -0.04630469158291817, mean p set: 0.4487190544605255
loss_pred:0.016504282131791115, decouple_loss:0.001109156641177833
loss_pred:0.01747152768075466, decouple_loss:0.0013351414818316698
Iteration: 849, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469447135925293, gen p mean: -0.04287659749388695, mean p set: 0.4474250078201294
loss_pred:0.017269635573029518, decouple_loss:0.0011183741735294461
The modified gen p mean: 0.4487219750881195, gen p mean: -0.047665711492300034, mean p set: 0.4492022693157196The modified gen p mean: 0.44834718108177185, gen p mean: -0.04623626545071602, mean p set: 0.44882747530937195
loss_pred:0.017553167417645454, decouple_loss:0.0013668666360899806
loss_pred:0.0173970814794302, decouple_loss:0.0010584024712443352
Iteration: 850, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44628268480300903, gen p mean: -0.04860231652855873, mean p set: 0.4467630088329315
loss_pred:0.017091646790504456, decouple_loss:0.0010714996606111526
The modified gen p mean: 0.44714465737342834, gen p mean: -0.043131958693265915, mean p set: 0.44762495160102844The modified gen p mean: 0.4462166130542755, gen p mean: -0.048317085951566696, mean p set: 0.4466968774795532
loss_pred:0.017006918787956238, decouple_loss:0.00107093236874789
loss_pred:0.016107527539134026, decouple_loss:0.0010598269291222095
2023-05-01 08:43:10 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.05278778076171875, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.0488007552921772, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.04909640550613403, mean p set: 0.4500633478164673
loss_pred:0.01851821504533291, decouple_loss:0.0010917721083387733
loss_pred:0.01737195998430252, decouple_loss:0.001074369065463543
loss_pred:0.0174242053180933, decouple_loss:0.0010698122205212712
WV_0_PC_1_EH_0_PS_40, loss: 0.01782539300620556, avg_mse: 0.025640157982707024
current test mse: 0.02564
Iteration: 851, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473405182361603, gen p mean: -0.053240638226270676, mean p set: 0.4478208124637604
The modified gen p mean: 0.4477706551551819, gen p mean: -0.05203714594244957, mean p set: 0.448250949382782
The modified gen p mean: 0.44886305928230286, gen p mean: -0.051692839711904526, mean p set: 0.44934335350990295
loss_pred:0.017556753009557724, decouple_loss:0.0011010128073394299
loss_pred:0.017250744625926018, decouple_loss:0.0010820840252563357
loss_pred:0.01711420901119709, decouple_loss:0.0010626324219629169
Iteration: 852, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44780921936035156, gen p mean: -0.04760979488492012, mean p set: 0.44828951358795166
loss_pred:0.016352040693163872, decouple_loss:0.0011961845448240638
The modified gen p mean: 0.44678714871406555, gen p mean: -0.0488547757267952, mean p set: 0.44726744294166565The modified gen p mean: 0.4469979703426361, gen p mean: -0.05133592709898949, mean p set: 0.4474782347679138
loss_pred:0.016434621065855026, decouple_loss:0.0010794309200718999
loss_pred:0.016623178496956825, decouple_loss:0.0011557310353964567
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012009_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012009_3_24hr.npz
NaN value num: 0
Iteration: 853, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44784677028656006, gen p mean: -0.05005696415901184, mean p set: 0.44832706451416016
loss_pred:0.014843285083770752, decouple_loss:0.0010704933665692806
The modified gen p mean: 0.44753408432006836, gen p mean: -0.048073213547468185, mean p set: 0.44801437854766846The modified gen p mean: 0.44558775424957275, gen p mean: -0.057697515934705734, mean p set: 0.44606801867485046
loss_pred:0.015031500719487667, decouple_loss:0.0011563810985535383
loss_pred:0.014780626632273197, decouple_loss:0.001120691536925733
Iteration: 854, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44741398096084595, gen p mean: -0.051424019038677216, mean p set: 0.44789430499076843
loss_pred:0.014789081178605556, decouple_loss:0.0011374636087566614
The modified gen p mean: 0.4469814896583557, gen p mean: -0.052482523024082184, mean p set: 0.4474617540836334The modified gen p mean: 0.44727861881256104, gen p mean: -0.05605670437216759, mean p set: 0.44775891304016113
loss_pred:0.014922511763870716, decouple_loss:0.0010950668947771192
loss_pred:0.014961276203393936, decouple_loss:0.001221704063937068
Iteration: 855, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476727247238159, gen p mean: -0.055166516453027725, mean p set: 0.4481530487537384
The modified gen p mean: 0.44661808013916016, gen p mean: -0.05989782512187958, mean p set: 0.44709834456443787
loss_pred:0.014349682256579399, decouple_loss:0.0012868635822087526
loss_pred:0.014654440805315971, decouple_loss:0.0012257684720680118
The modified gen p mean: 0.4472886323928833, gen p mean: -0.05088687315583229, mean p set: 0.4477689266204834
loss_pred:0.014851092360913754, decouple_loss:0.0011897305957973003
Iteration: 856, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485139846801758, gen p mean: -0.05228312313556671, mean p set: 0.4489942789077759
loss_pred:0.014726771973073483, decouple_loss:0.0011504024732857943
The modified gen p mean: 0.4483659267425537, gen p mean: -0.05534297227859497, mean p set: 0.4488462209701538The modified gen p mean: 0.4471273124217987, gen p mean: -0.053599726408720016, mean p set: 0.4476076066493988
loss_pred:0.014664909802377224, decouple_loss:0.0011344789527356625
loss_pred:0.014450098387897015, decouple_loss:0.0011282787891104817
Iteration: 857, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44854751229286194, gen p mean: -0.04975038394331932, mean p set: 0.44902777671813965
The modified gen p mean: 0.4473239481449127, gen p mean: -0.05007321760058403, mean p set: 0.44780421257019043
loss_pred:0.0146695701405406, decouple_loss:0.0013504300732165575
loss_pred:0.014335370622575283, decouple_loss:0.0012811796041205525
The modified gen p mean: 0.44803327322006226, gen p mean: -0.0508200079202652, mean p set: 0.44851356744766235
loss_pred:0.014887189492583275, decouple_loss:0.0013613522751256824
Iteration: 858, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487041234970093, gen p mean: -0.054774511605501175, mean p set: 0.449184387922287
The modified gen p mean: 0.4468082785606384, gen p mean: -0.05302959308028221, mean p set: 0.4472885727882385
loss_pred:0.014400910586118698, decouple_loss:0.0013016203884035349
loss_pred:0.014779853634536266, decouple_loss:0.0013452362036332488
The modified gen p mean: 0.44909849762916565, gen p mean: -0.05529056116938591, mean p set: 0.44957879185676575
loss_pred:0.01419809553772211, decouple_loss:0.0012536861468106508
Iteration: 859, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44692885875701904, gen p mean: -0.05667326971888542, mean p set: 0.44740915298461914
loss_pred:0.014328623190522194, decouple_loss:0.0014093209756538272
The modified gen p mean: 0.4494333863258362, gen p mean: -0.049716487526893616, mean p set: 0.4499136209487915The modified gen p mean: 0.44608765840530396, gen p mean: -0.0541146956384182, mean p set: 0.44656795263290405
loss_pred:0.014742542058229446, decouple_loss:0.0016249665059149265
loss_pred:0.014195450581610203, decouple_loss:0.0014452191535383463
Iteration: 860, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44727686047554016, gen p mean: -0.05121586099267006, mean p set: 0.44775715470314026
loss_pred:0.014410510659217834, decouple_loss:0.0012768972665071487
The modified gen p mean: 0.44713956117630005, gen p mean: -0.05843806266784668, mean p set: 0.44761988520622253The modified gen p mean: 0.44821038842201233, gen p mean: -0.052633412182331085, mean p set: 0.44869065284729004
loss_pred:0.014262240380048752, decouple_loss:0.0012387832393869758
loss_pred:0.014213314279913902, decouple_loss:0.0012392408680170774
2023-05-01 08:45:40 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.05060894787311554, mean p set: 0.4502691626548767
The modified gen p mean: 0.4498766362667084, gen p mean: -0.0464000441133976, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.046541839838027954, mean p set: 0.4500633478164673
loss_pred:0.01921728067100048, decouple_loss:0.0014378349296748638
loss_pred:0.018073521554470062, decouple_loss:0.0014151971554383636
loss_pred:0.01817149482667446, decouple_loss:0.0014252741821110249
WV_0_PC_1_EH_0_PS_40, loss: 0.018558736890554428, avg_mse: 0.026988059282302856
current test mse: 0.026988
Iteration: 861, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44697925448417664, gen p mean: -0.05223068967461586, mean p set: 0.44745954871177673
The modified gen p mean: 0.4483204185962677, gen p mean: -0.04956595227122307, mean p set: 0.4488007128238678
loss_pred:0.014079274609684944, decouple_loss:0.001280949218198657
The modified gen p mean: 0.448018342256546, gen p mean: -0.05220082774758339, mean p set: 0.4484986364841461
loss_pred:0.014131815172731876, decouple_loss:0.0013502336805686355
loss_pred:0.014017434790730476, decouple_loss:0.001291185151785612
Iteration: 862, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480317533016205, gen p mean: -0.044848404824733734, mean p set: 0.4485120475292206
loss_pred:0.014638622291386127, decouple_loss:0.0014058256056159735
The modified gen p mean: 0.446424663066864, gen p mean: -0.049695324152708054, mean p set: 0.4469049572944641The modified gen p mean: 0.4493890106678009, gen p mean: -0.04402794688940048, mean p set: 0.449869304895401
loss_pred:0.014440421015024185, decouple_loss:0.0014754479052498937
loss_pred:0.014296683482825756, decouple_loss:0.0014802952064201236
Iteration: 863, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474327862262726, gen p mean: -0.04231646656990051, mean p set: 0.4479130506515503
loss_pred:0.013972052372992039, decouple_loss:0.0013072373112663627
The modified gen p mean: 0.44839411973953247, gen p mean: -0.04427217319607735, mean p set: 0.44887441396713257The modified gen p mean: 0.44679686427116394, gen p mean: -0.048548586666584015, mean p set: 0.44727712869644165
loss_pred:0.014230134896934032, decouple_loss:0.0012861487921327353
loss_pred:0.013737598434090614, decouple_loss:0.0012772949412465096
Iteration: 864, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475298225879669, gen p mean: -0.04652244970202446, mean p set: 0.44801008701324463
loss_pred:0.014079617336392403, decouple_loss:0.0012197713367640972
The modified gen p mean: 0.4476068913936615, gen p mean: -0.04277047514915466, mean p set: 0.448087215423584The modified gen p mean: 0.4461471736431122, gen p mean: -0.04829331859946251, mean p set: 0.4466274678707123
loss_pred:0.013827204704284668, decouple_loss:0.0012478182325139642
loss_pred:0.01431804709136486, decouple_loss:0.0013478795299306512
Iteration: 865, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44548624753952026, gen p mean: -0.045853979885578156, mean p set: 0.445966511964798
loss_pred:0.014479651115834713, decouple_loss:0.0013169150333851576
The modified gen p mean: 0.44623613357543945, gen p mean: -0.049329157918691635, mean p set: 0.44671642780303955The modified gen p mean: 0.4461550712585449, gen p mean: -0.04580308496952057, mean p set: 0.4466353952884674
loss_pred:0.014220478013157845, decouple_loss:0.0012540924362838268
loss_pred:0.014000747352838516, decouple_loss:0.0014043430564925075
Iteration: 866, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4461553692817688, gen p mean: -0.04580574855208397, mean p set: 0.4466356933116913
loss_pred:0.013956760056316853, decouple_loss:0.0013691367348656058
The modified gen p mean: 0.44778165221214294, gen p mean: -0.043996959924697876, mean p set: 0.44826194643974304The modified gen p mean: 0.4470822811126709, gen p mean: -0.04466455057263374, mean p set: 0.447562575340271
loss_pred:0.014003518037497997, decouple_loss:0.0013726797187700868
loss_pred:0.014403152279555798, decouple_loss:0.0014394454192370176
Iteration: 867, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44719719886779785, gen p mean: -0.04820983484387398, mean p set: 0.44767752289772034
loss_pred:0.013737360946834087, decouple_loss:0.0012297312496230006
The modified gen p mean: 0.4473932087421417, gen p mean: -0.04772738367319107, mean p set: 0.4478735327720642The modified gen p mean: 0.44688746333122253, gen p mean: -0.04328306391835213, mean p set: 0.44736772775650024
loss_pred:0.013762437738478184, decouple_loss:0.0012049339711666107
loss_pred:0.013826341368258, decouple_loss:0.0012608520919457078
Iteration: 868, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44982996582984924, gen p mean: -0.04624505713582039, mean p set: 0.45031026005744934
loss_pred:0.013950513675808907, decouple_loss:0.0016540884971618652
The modified gen p mean: 0.4471665918827057, gen p mean: -0.04605843871831894, mean p set: 0.447646826505661The modified gen p mean: 0.44736161828041077, gen p mean: -0.04663033410906792, mean p set: 0.44784191250801086
loss_pred:0.014008007943630219, decouple_loss:0.001553781097754836
loss_pred:0.013868337497115135, decouple_loss:0.0014804401434957981
Iteration: 869, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483109414577484, gen p mean: -0.04379387944936752, mean p set: 0.4487912356853485
loss_pred:0.01420427393168211, decouple_loss:0.0011726871598511934
The modified gen p mean: 0.4478420615196228, gen p mean: -0.04456981644034386, mean p set: 0.4483223557472229The modified gen p mean: 0.44773584604263306, gen p mean: -0.045602958649396896, mean p set: 0.44821611046791077
loss_pred:0.013870005495846272, decouple_loss:0.0012014374369755387
loss_pred:0.01426735334098339, decouple_loss:0.0012518932344391942
Iteration: 870, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468348026275635, gen p mean: -0.04845769330859184, mean p set: 0.4473150670528412
loss_pred:0.014012053608894348, decouple_loss:0.001377706415951252
The modified gen p mean: 0.44749554991722107, gen p mean: -0.047912925481796265, mean p set: 0.4479758143424988The modified gen p mean: 0.44852012395858765, gen p mean: -0.04856688901782036, mean p set: 0.44900041818618774
loss_pred:0.013545289635658264, decouple_loss:0.001416506594978273
loss_pred:0.013657746836543083, decouple_loss:0.001349919126369059
2023-05-01 08:47:33 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.04964809492230415, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04583282023668289, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.04577123373746872, mean p set: 0.4500633478164673
loss_pred:0.019189145416021347, decouple_loss:0.0012834682129323483
loss_pred:0.018096555024385452, decouple_loss:0.0013927749823778868
loss_pred:0.018143728375434875, decouple_loss:0.0013553316239267588
WV_0_PC_1_EH_0_PS_40, loss: 0.0185436699539423, avg_mse: 0.027012668550014496
current test mse: 0.027013
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 871, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493076503276825, gen p mean: -0.04834543168544769, mean p set: 0.449787974357605
The modified gen p mean: 0.4487951695919037, gen p mean: -0.04390542581677437, mean p set: 0.4492754638195038
The modified gen p mean: 0.44861432909965515, gen p mean: -0.04517330974340439, mean p set: 0.44909462332725525
loss_pred:0.013846799731254578, decouple_loss:0.0013344243634492159
loss_pred:0.01380456518381834, decouple_loss:0.0012512117391452193
loss_pred:0.013846151530742645, decouple_loss:0.0013229502364993095
Iteration: 872, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44760459661483765, gen p mean: -0.0473918691277504, mean p set: 0.44808489084243774
loss_pred:0.013601579703390598, decouple_loss:0.0012946785427629948
The modified gen p mean: 0.44779470562934875, gen p mean: -0.041406434029340744, mean p set: 0.44827497005462646The modified gen p mean: 0.4478175938129425, gen p mean: -0.045240309089422226, mean p set: 0.4482978880405426
loss_pred:0.014032174833118916, decouple_loss:0.0013857086887583137
loss_pred:0.013698048889636993, decouple_loss:0.001383828348480165
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012008_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012008_3_24hr.npz
NaN value num: 0
Iteration: 873, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44609305262565613, gen p mean: -0.04650929942727089, mean p set: 0.4465733468532562
loss_pred:0.017692292109131813, decouple_loss:0.0012845066376030445
The modified gen p mean: 0.44629257917404175, gen p mean: -0.04791463911533356, mean p set: 0.44677287340164185The modified gen p mean: 0.446490615606308, gen p mean: -0.04528791084885597, mean p set: 0.4469709098339081
loss_pred:0.01805402897298336, decouple_loss:0.0012756524374708533
loss_pred:0.017445208504796028, decouple_loss:0.0011330919805914164
Iteration: 874, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44762691855430603, gen p mean: -0.04395560920238495, mean p set: 0.44810721278190613
The modified gen p mean: 0.4488474428653717, gen p mean: -0.03806614130735397, mean p set: 0.4493277370929718
loss_pred:0.016845786944031715, decouple_loss:0.0015406061429530382
loss_pred:0.016659753397107124, decouple_loss:0.0014671622775495052
The modified gen p mean: 0.44824230670928955, gen p mean: -0.04509497061371803, mean p set: 0.44872260093688965
loss_pred:0.016736237332224846, decouple_loss:0.0014484267449006438
Iteration: 875, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44649001955986023, gen p mean: -0.0331307016313076, mean p set: 0.4469703137874603
loss_pred:0.01755431666970253, decouple_loss:0.0016077441396191716
The modified gen p mean: 0.4459577202796936, gen p mean: -0.03607991710305214, mean p set: 0.4464380145072937The modified gen p mean: 0.44751420617103577, gen p mean: -0.034241873770952225, mean p set: 0.4479944705963135
loss_pred:0.016721263527870178, decouple_loss:0.0015797321684658527
loss_pred:0.017454637214541435, decouple_loss:0.0015114053385332227
Iteration: 876, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44586387276649475, gen p mean: -0.03197232633829117, mean p set: 0.44634416699409485
loss_pred:0.017509976401925087, decouple_loss:0.0014016926288604736
The modified gen p mean: 0.4474918842315674, gen p mean: -0.031975746154785156, mean p set: 0.4479721784591675The modified gen p mean: 0.445686012506485, gen p mean: -0.032303422689437866, mean p set: 0.4461663067340851
loss_pred:0.01758427545428276, decouple_loss:0.0013969432329759002
loss_pred:0.016626233235001564, decouple_loss:0.0012819996336475015
Iteration: 877, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44582054018974304, gen p mean: -0.035506464540958405, mean p set: 0.44630083441734314
loss_pred:0.017551515251398087, decouple_loss:0.0013983693206682801
The modified gen p mean: 0.44680672883987427, gen p mean: -0.04020876809954643, mean p set: 0.44728702306747437The modified gen p mean: 0.4458196759223938, gen p mean: -0.03158384934067726, mean p set: 0.4462999701499939
loss_pred:0.01774374395608902, decouple_loss:0.0013911868445575237
loss_pred:0.017246242612600327, decouple_loss:0.0014388923300430179
Iteration: 878, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479345381259918, gen p mean: -0.045281145721673965, mean p set: 0.44841480255126953
loss_pred:0.016209321096539497, decouple_loss:0.0016363944159820676
The modified gen p mean: 0.44628211855888367, gen p mean: -0.03912197798490524, mean p set: 0.4467623829841614The modified gen p mean: 0.4456903040409088, gen p mean: -0.040036510676145554, mean p set: 0.4461705982685089
loss_pred:0.01759665086865425, decouple_loss:0.0014126766473054886
loss_pred:0.017893211916089058, decouple_loss:0.0015720626106485724
Iteration: 879, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4462442994117737, gen p mean: -0.04398027062416077, mean p set: 0.4467245936393738
loss_pred:0.017253119498491287, decouple_loss:0.0014031566679477692
The modified gen p mean: 0.44668063521385193, gen p mean: -0.04092853143811226, mean p set: 0.44716089963912964The modified gen p mean: 0.44615408778190613, gen p mean: -0.042894791811704636, mean p set: 0.4466344118118286
loss_pred:0.01731974445283413, decouple_loss:0.0014156302204355597
loss_pred:0.01687725819647312, decouple_loss:0.0013058759504929185
Iteration: 880, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469850957393646, gen p mean: -0.049407582730054855, mean p set: 0.4474653899669647
loss_pred:0.017380788922309875, decouple_loss:0.001304303528741002
The modified gen p mean: 0.4469478130340576, gen p mean: -0.043546706438064575, mean p set: 0.4474280774593353The modified gen p mean: 0.4463704228401184, gen p mean: -0.04464602842926979, mean p set: 0.4468507766723633
loss_pred:0.017417561262845993, decouple_loss:0.0013723555020987988
loss_pred:0.01658676750957966, decouple_loss:0.001339258742518723
2023-05-01 08:50:01 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.04576119780540466, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04191139340400696, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.04215617850422859, mean p set: 0.4500633478164673
loss_pred:0.018455514684319496, decouple_loss:0.0012920438311994076
loss_pred:0.01744861714541912, decouple_loss:0.0013210270553827286
loss_pred:0.017540164291858673, decouple_loss:0.001298836199566722
WV_0_PC_1_EH_0_PS_40, loss: 0.017879962921142578, avg_mse: 0.025656916201114655
current test mse: 0.025657
Iteration: 881, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464409351348877, gen p mean: -0.04795069247484207, mean p set: 0.4469212293624878
The modified gen p mean: 0.44563257694244385, gen p mean: -0.04425131529569626, mean p set: 0.44611287117004395
The modified gen p mean: 0.44646114110946655, gen p mean: -0.04116927459836006, mean p set: 0.44694146513938904
loss_pred:0.01700223609805107, decouple_loss:0.0013304041931405663
loss_pred:0.01733415387570858, decouple_loss:0.0012718208599835634loss_pred:0.016693921759724617, decouple_loss:0.001335785025730729
Iteration: 882, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44685351848602295, gen p mean: -0.04509584233164787, mean p set: 0.44733378291130066
loss_pred:0.017687799409031868, decouple_loss:0.001292205648496747
The modified gen p mean: 0.4470170736312866, gen p mean: -0.04828733578324318, mean p set: 0.44749733805656433The modified gen p mean: 0.44712796807289124, gen p mean: -0.05310015380382538, mean p set: 0.44760826230049133
loss_pred:0.016910117119550705, decouple_loss:0.0012750014429911971
loss_pred:0.017459193244576454, decouple_loss:0.0012703881366178393
Iteration: 883, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468127191066742, gen p mean: -0.04592010751366615, mean p set: 0.4472929835319519
loss_pred:0.016386602073907852, decouple_loss:0.0011730986880138516
The modified gen p mean: 0.4468720555305481, gen p mean: -0.04751722142100334, mean p set: 0.4473523199558258The modified gen p mean: 0.446000874042511, gen p mean: -0.04818413034081459, mean p set: 0.44648122787475586
loss_pred:0.017098797485232353, decouple_loss:0.0011883467668667436
loss_pred:0.016400866210460663, decouple_loss:0.001276688533835113
Iteration: 884, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4463740587234497, gen p mean: -0.0450998917222023, mean p set: 0.4468543529510498
loss_pred:0.017172716557979584, decouple_loss:0.0013570047449320555
The modified gen p mean: 0.4459913671016693, gen p mean: -0.045981813222169876, mean p set: 0.4464716613292694The modified gen p mean: 0.44696301221847534, gen p mean: -0.046528108417987823, mean p set: 0.44744330644607544
loss_pred:0.016370290890336037, decouple_loss:0.001383019844070077
loss_pred:0.016439009457826614, decouple_loss:0.0013445975491777062
Iteration: 885, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486481845378876, gen p mean: -0.04309695214033127, mean p set: 0.44912847876548767
loss_pred:0.016212891787290573, decouple_loss:0.0013740179128944874
The modified gen p mean: 0.44811761379241943, gen p mean: -0.041998811066150665, mean p set: 0.44859790802001953The modified gen p mean: 0.4454819858074188, gen p mean: -0.04402998462319374, mean p set: 0.4459622800350189
loss_pred:0.016404185444116592, decouple_loss:0.0013834135606884956
loss_pred:0.017047308385372162, decouple_loss:0.0012519210577011108
Iteration: 886, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469824731349945, gen p mean: -0.04504130780696869, mean p set: 0.4474627375602722
loss_pred:0.01735897734761238, decouple_loss:0.0012753313640132546
The modified gen p mean: 0.44588515162467957, gen p mean: -0.04729246348142624, mean p set: 0.44636544585227966The modified gen p mean: 0.4456685185432434, gen p mean: -0.04535245895385742, mean p set: 0.4461488425731659
loss_pred:0.016896449029445648, decouple_loss:0.0012477266136556864
loss_pred:0.016874993219971657, decouple_loss:0.0012589326361194253
Iteration: 887, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4455968141555786, gen p mean: -0.04996117949485779, mean p set: 0.4460771083831787
loss_pred:0.017171356827020645, decouple_loss:0.001228469074703753
The modified gen p mean: 0.4467600882053375, gen p mean: -0.047151584178209305, mean p set: 0.4472403824329376The modified gen p mean: 0.44578951597213745, gen p mean: -0.04704204201698303, mean p set: 0.44626984000205994
loss_pred:0.017297156155109406, decouple_loss:0.0012103255139663815
loss_pred:0.0172031931579113, decouple_loss:0.0012243734672665596
Iteration: 888, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44573476910591125, gen p mean: -0.052093006670475006, mean p set: 0.44621503353118896
loss_pred:0.01681581884622574, decouple_loss:0.0011348488042131066
The modified gen p mean: 0.4465961754322052, gen p mean: -0.04957639425992966, mean p set: 0.4470764696598053The modified gen p mean: 0.44659650325775146, gen p mean: -0.053982917219400406, mean p set: 0.44707679748535156
loss_pred:0.016994591802358627, decouple_loss:0.0011271844850853086
loss_pred:0.016999322921037674, decouple_loss:0.0012620253255590796
Iteration: 889, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44690370559692383, gen p mean: -0.05601812154054642, mean p set: 0.4473839998245239
loss_pred:0.016321120783686638, decouple_loss:0.0011224672198295593
The modified gen p mean: 0.4472256004810333, gen p mean: -0.05607439577579498, mean p set: 0.44770586490631104The modified gen p mean: 0.44619178771972656, gen p mean: -0.05145777761936188, mean p set: 0.44667208194732666
loss_pred:0.01672074757516384, decouple_loss:0.0011435964843258262
loss_pred:0.01684497855603695, decouple_loss:0.0010861118789762259
Iteration: 890, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4462193548679352, gen p mean: -0.05507184565067291, mean p set: 0.4466996490955353
loss_pred:0.017325202003121376, decouple_loss:0.001173566561192274
The modified gen p mean: 0.4475557506084442, gen p mean: -0.05425889417529106, mean p set: 0.4480360448360443The modified gen p mean: 0.4463377594947815, gen p mean: -0.05966842174530029, mean p set: 0.4468180239200592
loss_pred:0.01693701557815075, decouple_loss:0.0012512197718024254
loss_pred:0.016502773389220238, decouple_loss:0.0013081597862765193
2023-05-01 08:51:53 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.05520547181367874, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.051207415759563446, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.05145082250237465, mean p set: 0.4500633478164673
loss_pred:0.018364883959293365, decouple_loss:0.0011475245701149106
loss_pred:0.01732705533504486, decouple_loss:0.001181994448415935
loss_pred:0.017350707203149796, decouple_loss:0.0011738166213035583
WV_0_PC_1_EH_0_PS_40, loss: 0.017739271745085716, avg_mse: 0.02542521059513092
current test mse: 0.025425
Iteration: 891, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474466145038605, gen p mean: -0.05686144903302193, mean p set: 0.44792690873146057
The modified gen p mean: 0.4463348984718323, gen p mean: -0.051846377551555634, mean p set: 0.4468151926994324
The modified gen p mean: 0.4461957514286041, gen p mean: -0.05714083090424538, mean p set: 0.4466760754585266
loss_pred:0.016860509291291237, decouple_loss:0.0011661152821034193
loss_pred:0.016751252114772797, decouple_loss:0.0012230199063196778
loss_pred:0.016766037791967392, decouple_loss:0.0011815943289548159
Iteration: 892, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448067307472229, gen p mean: -0.0503033772110939, mean p set: 0.4485476016998291
loss_pred:0.016230333596467972, decouple_loss:0.0012152136769145727
The modified gen p mean: 0.44643571972846985, gen p mean: -0.0511917844414711, mean p set: 0.44691601395606995The modified gen p mean: 0.446650892496109, gen p mean: -0.04993779584765434, mean p set: 0.4471311867237091
loss_pred:0.016452359035611153, decouple_loss:0.0012037359410896897
loss_pred:0.017360862344503403, decouple_loss:0.0011999307898804545
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012014_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012014_3_24hr.npz
NaN value num: 0
Iteration: 893, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45079007744789124, gen p mean: -0.04352687671780586, mean p set: 0.45127037167549133
loss_pred:0.017099926248192787, decouple_loss:0.0012109670788049698
The modified gen p mean: 0.4492426812648773, gen p mean: -0.044459179043769836, mean p set: 0.4497230052947998The modified gen p mean: 0.4506310820579529, gen p mean: -0.039712321013212204, mean p set: 0.451111376285553
loss_pred:0.016500942409038544, decouple_loss:0.0012430066708475351
loss_pred:0.01628439500927925, decouple_loss:0.001111044199205935
Iteration: 894, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44972679018974304, gen p mean: -0.03942590206861496, mean p set: 0.45020708441734314
loss_pred:0.017325054854154587, decouple_loss:0.0011605493491515517
The modified gen p mean: 0.4481632709503174, gen p mean: -0.04161294922232628, mean p set: 0.4486435651779175The modified gen p mean: 0.45048201084136963, gen p mean: -0.04356684535741806, mean p set: 0.4509623348712921
loss_pred:0.016024868935346603, decouple_loss:0.0010958184720948339
loss_pred:0.01749122142791748, decouple_loss:0.0011615726398304105
Iteration: 895, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508521556854248, gen p mean: -0.04634098708629608, mean p set: 0.4513324499130249
loss_pred:0.016208171844482422, decouple_loss:0.001247685169801116
The modified gen p mean: 0.4497719705104828, gen p mean: -0.041645634919404984, mean p set: 0.4502522349357605The modified gen p mean: 0.4478864371776581, gen p mean: -0.04197690263390541, mean p set: 0.4483667314052582
loss_pred:0.015971742570400238, decouple_loss:0.0012272431049495935
loss_pred:0.016876114532351494, decouple_loss:0.0011742992792278528
Iteration: 896, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491342604160309, gen p mean: -0.04098896309733391, mean p set: 0.4496145248413086
loss_pred:0.017308032140135765, decouple_loss:0.0010946504771709442
The modified gen p mean: 0.4473547339439392, gen p mean: -0.04868125170469284, mean p set: 0.4478350281715393The modified gen p mean: 0.44895386695861816, gen p mean: -0.048871707171201706, mean p set: 0.44943416118621826
loss_pred:0.015791045501828194, decouple_loss:0.0011523972498252988
loss_pred:0.01652236469089985, decouple_loss:0.0010931678116321564
Iteration: 897, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45113056898117065, gen p mean: -0.048706188797950745, mean p set: 0.45161086320877075
loss_pred:0.016533832997083664, decouple_loss:0.0012193043949082494
The modified gen p mean: 0.4504573941230774, gen p mean: -0.053922977298498154, mean p set: 0.4509376883506775The modified gen p mean: 0.45106571912765503, gen p mean: -0.05129474028944969, mean p set: 0.45154598355293274
loss_pred:0.016254283487796783, decouple_loss:0.0012037251144647598
loss_pred:0.016271298751235008, decouple_loss:0.0011835939949378371
Iteration: 898, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514255225658417, gen p mean: -0.05904848873615265, mean p set: 0.4519057869911194
loss_pred:0.01765591651201248, decouple_loss:0.0012130889808759093
The modified gen p mean: 0.4508323669433594, gen p mean: -0.050976887345314026, mean p set: 0.45131269097328186The modified gen p mean: 0.45174404978752136, gen p mean: -0.049734704196453094, mean p set: 0.45222434401512146
loss_pred:0.015606268309056759, decouple_loss:0.0012293854961171746
loss_pred:0.016338320448994637, decouple_loss:0.001184574794024229
Iteration: 899, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45154479146003723, gen p mean: -0.06012233719229698, mean p set: 0.45202508568763733
loss_pred:0.017929820343852043, decouple_loss:0.0011135309468954802
The modified gen p mean: 0.44853904843330383, gen p mean: -0.05727614089846611, mean p set: 0.44901934266090393The modified gen p mean: 0.4486335217952728, gen p mean: -0.05849358066916466, mean p set: 0.4491138160228729
loss_pred:0.01628226414322853, decouple_loss:0.0010949530405923724
loss_pred:0.01662846840918064, decouple_loss:0.0011352072469890118
Iteration: 900, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44963958859443665, gen p mean: -0.06441545486450195, mean p set: 0.45011985301971436
loss_pred:0.015944704413414, decouple_loss:0.001363040297292173
The modified gen p mean: 0.4495418071746826, gen p mean: -0.0562632717192173, mean p set: 0.4500221312046051The modified gen p mean: 0.44983917474746704, gen p mean: -0.06484366953372955, mean p set: 0.45031946897506714
loss_pred:0.01571919396519661, decouple_loss:0.0013251684140414
loss_pred:0.016606302931904793, decouple_loss:0.0014112134231254458
2023-05-01 08:54:23 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.06803079694509506, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.06400502473115921, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.06448645889759064, mean p set: 0.4500633478164673
loss_pred:0.018451059237122536, decouple_loss:0.0012932150857523084
loss_pred:0.017350753769278526, decouple_loss:0.001222441322170198
loss_pred:0.017474282532930374, decouple_loss:0.001220469013787806
WV_0_PC_1_EH_0_PS_40, loss: 0.017820967361330986, avg_mse: 0.02559034898877144
current test mse: 0.02559
Iteration: 901, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44784224033355713, gen p mean: -0.059865307062864304, mean p set: 0.4483225345611572
The modified gen p mean: 0.44890737533569336, gen p mean: -0.056462280452251434, mean p set: 0.44938766956329346
The modified gen p mean: 0.44892340898513794, gen p mean: -0.051856689155101776, mean p set: 0.44940370321273804
loss_pred:0.01650097779929638, decouple_loss:0.0011737293098121881
loss_pred:0.016915559768676758, decouple_loss:0.0011326601961627603
loss_pred:0.015905262902379036, decouple_loss:0.0011349685955792665
Iteration: 902, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45031604170799255, gen p mean: -0.05804143846035004, mean p set: 0.45079630613327026
loss_pred:0.016086997464299202, decouple_loss:0.0012798209208995104
The modified gen p mean: 0.4504087269306183, gen p mean: -0.061319105327129364, mean p set: 0.450888991355896The modified gen p mean: 0.4503253698348999, gen p mean: -0.05485359579324722, mean p set: 0.4508056342601776
loss_pred:0.016231046989560127, decouple_loss:0.0012761661782860756
loss_pred:0.015495482832193375, decouple_loss:0.0013163929106667638
Iteration: 903, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45032864809036255, gen p mean: -0.0654890388250351, mean p set: 0.45080891251564026
loss_pred:0.01672428287565708, decouple_loss:0.0013277409598231316
The modified gen p mean: 0.4487953186035156, gen p mean: -0.05407063663005829, mean p set: 0.4492756426334381The modified gen p mean: 0.45027220249176025, gen p mean: -0.05714496597647667, mean p set: 0.45075252652168274
loss_pred:0.017353925853967667, decouple_loss:0.0011745941592380404
loss_pred:0.016541017219424248, decouple_loss:0.0012523193145170808
Iteration: 904, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495052695274353, gen p mean: -0.0535442978143692, mean p set: 0.4499855935573578
loss_pred:0.015821512788534164, decouple_loss:0.0013080204371362925
The modified gen p mean: 0.44856590032577515, gen p mean: -0.05320873484015465, mean p set: 0.44904619455337524The modified gen p mean: 0.44764038920402527, gen p mean: -0.0573706291615963, mean p set: 0.44812071323394775
loss_pred:0.01707666739821434, decouple_loss:0.0012579055037349463
loss_pred:0.016797080636024475, decouple_loss:0.0012435115640982985
Iteration: 905, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477939307689667, gen p mean: -0.05331369489431381, mean p set: 0.4482741951942444
loss_pred:0.01654616929590702, decouple_loss:0.001139437546953559
The modified gen p mean: 0.44923338294029236, gen p mean: -0.0486321821808815, mean p set: 0.44971367716789246The modified gen p mean: 0.4502425491809845, gen p mean: -0.05395935848355293, mean p set: 0.4507228434085846
loss_pred:0.017167512327432632, decouple_loss:0.0011899007949978113
loss_pred:0.016139505431056023, decouple_loss:0.0011346576502546668
Iteration: 906, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44736045598983765, gen p mean: -0.049705538898706436, mean p set: 0.44784078001976013
loss_pred:0.01613731123507023, decouple_loss:0.0010827342048287392
The modified gen p mean: 0.44947919249534607, gen p mean: -0.051071759313344955, mean p set: 0.4499594569206238The modified gen p mean: 0.4494793713092804, gen p mean: -0.04626026377081871, mean p set: 0.4499596655368805
loss_pred:0.016115445643663406, decouple_loss:0.0011063888669013977
loss_pred:0.015759766101837158, decouple_loss:0.0011273928685113788
Iteration: 907, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44781583547592163, gen p mean: -0.04915190115571022, mean p set: 0.44829609990119934The modified gen p mean: 0.4489624798297882, gen p mean: -0.04466036334633827, mean p set: 0.4494428038597107
loss_pred:0.016337484121322632, decouple_loss:0.0011252413969486952
loss_pred:0.016417495906352997, decouple_loss:0.00117119075730443
The modified gen p mean: 0.45043060183525085, gen p mean: -0.0435633659362793, mean p set: 0.45091089606285095
loss_pred:0.015923229977488518, decouple_loss:0.0011383022647351027
Iteration: 908, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44994351267814636, gen p mean: -0.043561965227127075, mean p set: 0.4504237771034241
loss_pred:0.016484780237078667, decouple_loss:0.0010772603563964367
The modified gen p mean: 0.44889235496520996, gen p mean: -0.03881075605750084, mean p set: 0.44937264919281006The modified gen p mean: 0.44900259375572205, gen p mean: -0.042457565665245056, mean p set: 0.44948288798332214
loss_pred:0.016960488632321358, decouple_loss:0.0010736426338553429
loss_pred:0.015501280315220356, decouple_loss:0.001003775978460908
Iteration: 909, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482405185699463, gen p mean: -0.04633210599422455, mean p set: 0.4487208127975464
loss_pred:0.01581460051238537, decouple_loss:0.001150038093328476
The modified gen p mean: 0.4473794400691986, gen p mean: -0.04964591562747955, mean p set: 0.4478597342967987The modified gen p mean: 0.4495643079280853, gen p mean: -0.04786394536495209, mean p set: 0.4500446021556854
loss_pred:0.016552254557609558, decouple_loss:0.0011585010215640068
loss_pred:0.016422616317868233, decouple_loss:0.0011486788280308247
Iteration: 910, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511122405529022, gen p mean: -0.047102563083171844, mean p set: 0.4515925347805023
The modified gen p mean: 0.44919106364250183, gen p mean: -0.04602320119738579, mean p set: 0.44967135787010193
loss_pred:0.01569407992064953, decouple_loss:0.0010218898532912135
loss_pred:0.016492489725351334, decouple_loss:0.0010380325838923454
The modified gen p mean: 0.4510965049266815, gen p mean: -0.04568100348114967, mean p set: 0.4515767991542816
loss_pred:0.015612248331308365, decouple_loss:0.0010791622335091233
2023-05-01 08:56:15 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.05945155769586563, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.05580059811472893, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.05583755299448967, mean p set: 0.4500633478164673
loss_pred:0.01846238039433956, decouple_loss:0.0013401813339442015
loss_pred:0.01740197278559208, decouple_loss:0.0011678878217935562
loss_pred:0.017576511949300766, decouple_loss:0.0012270900188013911
WV_0_PC_1_EH_0_PS_40, loss: 0.017875872552394867, avg_mse: 0.025698604062199593
current test mse: 0.025699
Iteration: 911, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4521694481372833, gen p mean: -0.047214288264513016, mean p set: 0.4526497423648834
The modified gen p mean: 0.45023971796035767, gen p mean: -0.04931466653943062, mean p set: 0.45072001218795776
The modified gen p mean: 0.44846534729003906, gen p mean: -0.05192567780613899, mean p set: 0.4489456117153168
loss_pred:0.016070924699306488, decouple_loss:0.0012844791635870934
loss_pred:0.016427211463451385, decouple_loss:0.0012541119940578938
loss_pred:0.016056671738624573, decouple_loss:0.001059597241692245
Iteration: 912, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44781234860420227, gen p mean: -0.057478975504636765, mean p set: 0.44829264283180237
loss_pred:0.016201436519622803, decouple_loss:0.0010365665657445788
The modified gen p mean: 0.44945549964904785, gen p mean: -0.05608075112104416, mean p set: 0.44993579387664795The modified gen p mean: 0.44993776082992554, gen p mean: -0.05852590128779411, mean p set: 0.45041805505752563
loss_pred:0.015933217480778694, decouple_loss:0.001104250317439437
loss_pred:0.015816979110240936, decouple_loss:0.0010671350173652172
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012001_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012001_3_24hr.npz
NaN value num: 0
Iteration: 913, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45109593868255615, gen p mean: -0.05245315283536911, mean p set: 0.45157620310783386
loss_pred:0.016072606667876244, decouple_loss:0.0012662048684433103
The modified gen p mean: 0.450602650642395, gen p mean: -0.05265616253018379, mean p set: 0.45108291506767273The modified gen p mean: 0.4516427516937256, gen p mean: -0.06010688841342926, mean p set: 0.4521230459213257
loss_pred:0.016057398170232773, decouple_loss:0.0012899142457172275
loss_pred:0.016127265989780426, decouple_loss:0.0012341898400336504
Iteration: 914, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44881415367126465, gen p mean: -0.04768045246601105, mean p set: 0.44929447770118713
loss_pred:0.015930144116282463, decouple_loss:0.0012142196064814925
The modified gen p mean: 0.44839081168174744, gen p mean: -0.052665308117866516, mean p set: 0.44887110590934753The modified gen p mean: 0.45187345147132874, gen p mean: -0.053938593715429306, mean p set: 0.45235374569892883
loss_pred:0.016027096658945084, decouple_loss:0.0012368950992822647
loss_pred:0.01550211664289236, decouple_loss:0.0012147653615102172
Iteration: 915, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4512201249599457, gen p mean: -0.045225467532873154, mean p set: 0.4517004191875458
loss_pred:0.01563144288957119, decouple_loss:0.001133639831095934
The modified gen p mean: 0.44953253865242004, gen p mean: -0.045839931815862656, mean p set: 0.45001283288002014The modified gen p mean: 0.4499624967575073, gen p mean: -0.04527587071061134, mean p set: 0.45044276118278503
loss_pred:0.015390191227197647, decouple_loss:0.0011332373833283782
loss_pred:0.01527534332126379, decouple_loss:0.0012325304560363293
Iteration: 916, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45107895135879517, gen p mean: -0.04131946712732315, mean p set: 0.45155924558639526
loss_pred:0.01556742936372757, decouple_loss:0.001489124959334731
The modified gen p mean: 0.4494893252849579, gen p mean: -0.04129170998930931, mean p set: 0.449969619512558The modified gen p mean: 0.45157793164253235, gen p mean: -0.042477305978536606, mean p set: 0.45205825567245483
loss_pred:0.015866264700889587, decouple_loss:0.0014544300502166152
loss_pred:0.016097288578748703, decouple_loss:0.001237412798218429
Iteration: 917, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45210736989974976, gen p mean: -0.048955924808979034, mean p set: 0.45258763432502747
loss_pred:0.015938568860292435, decouple_loss:0.0015183612704277039
The modified gen p mean: 0.45139288902282715, gen p mean: -0.044206175953149796, mean p set: 0.45187318325042725The modified gen p mean: 0.45011767745018005, gen p mean: -0.040061790496110916, mean p set: 0.45059797167778015
loss_pred:0.016173826530575752, decouple_loss:0.0012324184644967318
loss_pred:0.015486381947994232, decouple_loss:0.0013358475407585502
Iteration: 918, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500531256198883, gen p mean: -0.04231538251042366, mean p set: 0.4505334198474884
loss_pred:0.01552209910005331, decouple_loss:0.0012985533103346825
The modified gen p mean: 0.45037874579429626, gen p mean: -0.0405452735722065, mean p set: 0.45085906982421875The modified gen p mean: 0.4480988383293152, gen p mean: -0.0483320951461792, mean p set: 0.4485791027545929
loss_pred:0.015953494235873222, decouple_loss:0.001357196131721139
loss_pred:0.015712829306721687, decouple_loss:0.00133652170188725
Iteration: 919, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4516884684562683, gen p mean: -0.04843366891145706, mean p set: 0.4521687626838684
loss_pred:0.01585317775607109, decouple_loss:0.001317087560892105
The modified gen p mean: 0.4509420394897461, gen p mean: -0.046441998332738876, mean p set: 0.4514223337173462The modified gen p mean: 0.44852709770202637, gen p mean: -0.044306326657533646, mean p set: 0.44900739192962646
loss_pred:0.015547635033726692, decouple_loss:0.0013110514264553785
loss_pred:0.015765883028507233, decouple_loss:0.0012612714199349284
Iteration: 920, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490911662578583, gen p mean: -0.044178690761327744, mean p set: 0.44957149028778076
loss_pred:0.01588480919599533, decouple_loss:0.0012749007437378168
The modified gen p mean: 0.4483596086502075, gen p mean: -0.04245826229453087, mean p set: 0.44883993268013The modified gen p mean: 0.44764724373817444, gen p mean: -0.04626191779971123, mean p set: 0.44812753796577454
loss_pred:0.015064013190567493, decouple_loss:0.0013132609892636538
loss_pred:0.015611892566084862, decouple_loss:0.00128786894492805
2023-05-01 08:58:44 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.04870567098259926, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04489559307694435, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.04528648778796196, mean p set: 0.4500633478164673
loss_pred:0.01865304447710514, decouple_loss:0.001349296304397285
loss_pred:0.017542531713843346, decouple_loss:0.0012724078260362148
loss_pred:0.017706500366330147, decouple_loss:0.0013004695065319538
WV_0_PC_1_EH_0_PS_40, loss: 0.018032729625701904, avg_mse: 0.02597905695438385
current test mse: 0.025979
Iteration: 921, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486495554447174, gen p mean: -0.0409344919025898, mean p set: 0.4491298198699951
The modified gen p mean: 0.44800224900245667, gen p mean: -0.04618902876973152, mean p set: 0.44848257303237915
The modified gen p mean: 0.4517090320587158, gen p mean: -0.04601946473121643, mean p set: 0.4521893560886383
loss_pred:0.015623193234205246, decouple_loss:0.001261608675122261
loss_pred:0.015399770811200142, decouple_loss:0.0012444662861526012
loss_pred:0.014977067708969116, decouple_loss:0.001243748003616929
Iteration: 922, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477993845939636, gen p mean: -0.043028704822063446, mean p set: 0.4482796788215637
loss_pred:0.01513603888452053, decouple_loss:0.0012417217949405313
The modified gen p mean: 0.45140671730041504, gen p mean: -0.041301216930150986, mean p set: 0.45188701152801514The modified gen p mean: 0.4490036070346832, gen p mean: -0.0415455661714077, mean p set: 0.4494839310646057
loss_pred:0.015054840594530106, decouple_loss:0.0012602831702679396
loss_pred:0.015211916528642178, decouple_loss:0.0011899196542799473
Iteration: 923, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44922271370887756, gen p mean: -0.04079355299472809, mean p set: 0.4497029781341553
loss_pred:0.015257956460118294, decouple_loss:0.0014549236511811614
The modified gen p mean: 0.44979265332221985, gen p mean: -0.03375940024852753, mean p set: 0.45027294754981995The modified gen p mean: 0.450158029794693, gen p mean: -0.03357555717229843, mean p set: 0.4506383240222931
loss_pred:0.015539743937551975, decouple_loss:0.0013994843466207385
loss_pred:0.015485873445868492, decouple_loss:0.0012524755438789725
Iteration: 924, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.451168417930603, gen p mean: -0.03476707637310028, mean p set: 0.4516487121582031
loss_pred:0.01577102392911911, decouple_loss:0.001378196175210178
The modified gen p mean: 0.45214930176734924, gen p mean: -0.03745818883180618, mean p set: 0.45262959599494934The modified gen p mean: 0.4507247507572174, gen p mean: -0.03915337845683098, mean p set: 0.4512050449848175
loss_pred:0.015050124377012253, decouple_loss:0.001410490251146257
loss_pred:0.015137742273509502, decouple_loss:0.0014542206190526485
Iteration: 925, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504612982273102, gen p mean: -0.03795024752616882, mean p set: 0.4509415924549103
loss_pred:0.015265431255102158, decouple_loss:0.0011797132901847363
The modified gen p mean: 0.44808316230773926, gen p mean: -0.037656642496585846, mean p set: 0.44856342673301697The modified gen p mean: 0.450859397649765, gen p mean: -0.03963461145758629, mean p set: 0.4513396918773651
loss_pred:0.015118769370019436, decouple_loss:0.0011912055779248476
loss_pred:0.015082547441124916, decouple_loss:0.0011717370944097638
Iteration: 926, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45045655965805054, gen p mean: -0.0317685604095459, mean p set: 0.45093685388565063
loss_pred:0.015921588987112045, decouple_loss:0.0011598217533901334
The modified gen p mean: 0.44832879304885864, gen p mean: -0.03881445154547691, mean p set: 0.44880905747413635The modified gen p mean: 0.4507182240486145, gen p mean: -0.04138897359371185, mean p set: 0.4511985182762146
loss_pred:0.015355178155004978, decouple_loss:0.0012941515306010842
loss_pred:0.015357616357505322, decouple_loss:0.0012869663769379258
Iteration: 927, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45089954137802124, gen p mean: -0.04194478318095207, mean p set: 0.45137983560562134
loss_pred:0.015304818749427795, decouple_loss:0.0012097855797037482
The modified gen p mean: 0.44834089279174805, gen p mean: -0.03840699791908264, mean p set: 0.44882118701934814The modified gen p mean: 0.4497833847999573, gen p mean: -0.03598683699965477, mean p set: 0.4502636790275574
loss_pred:0.015045872889459133, decouple_loss:0.0011070353211835027
loss_pred:0.0156423170119524, decouple_loss:0.0011761403875425458
Iteration: 928, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502004384994507, gen p mean: -0.03547514230012894, mean p set: 0.4506807327270508
loss_pred:0.015342695638537407, decouple_loss:0.0011763835791498423
The modified gen p mean: 0.4486803114414215, gen p mean: -0.03933689370751381, mean p set: 0.4491605758666992The modified gen p mean: 0.45202067494392395, gen p mean: -0.04455419257283211, mean p set: 0.45250096917152405
loss_pred:0.015221665613353252, decouple_loss:0.0011370813008397818
loss_pred:0.015636160969734192, decouple_loss:0.0013077522162348032
Iteration: 929, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4506099224090576, gen p mean: -0.040188487619161606, mean p set: 0.4510902166366577
loss_pred:0.015394001267850399, decouple_loss:0.0010587401920929551
The modified gen p mean: 0.45025599002838135, gen p mean: -0.0427057184278965, mean p set: 0.45073628425598145The modified gen p mean: 0.4482850134372711, gen p mean: -0.04314279556274414, mean p set: 0.4487653374671936
loss_pred:0.015394948422908783, decouple_loss:0.001017741858959198
loss_pred:0.015431979671120644, decouple_loss:0.0011179324937984347
Iteration: 930, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487482011318207, gen p mean: -0.04422488808631897, mean p set: 0.44922852516174316
loss_pred:0.015222716145217419, decouple_loss:0.0010717232944443822
The modified gen p mean: 0.44978296756744385, gen p mean: -0.04146328940987587, mean p set: 0.45026326179504395The modified gen p mean: 0.4515479505062103, gen p mean: -0.044325873255729675, mean p set: 0.4520282447338104
loss_pred:0.015623115934431553, decouple_loss:0.0010665756417438388
loss_pred:0.015263891778886318, decouple_loss:0.001054964610375464
2023-05-01 09:00:38 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.049731988459825516, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.045702435076236725, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04634499549865723, mean p set: 0.4500633478164673
loss_pred:0.018558144569396973, decouple_loss:0.0012019346468150616
loss_pred:0.01744895614683628, decouple_loss:0.001155627309344709
loss_pred:0.0175892673432827, decouple_loss:0.0011648375075310469
WV_0_PC_1_EH_0_PS_40, loss: 0.01792416349053383, avg_mse: 0.025825683027505875
current test mse: 0.025826
Iteration: 931, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4510978162288666, gen p mean: -0.04510870575904846, mean p set: 0.4515781104564667
The modified gen p mean: 0.447933554649353, gen p mean: -0.04699411243200302, mean p set: 0.44841381907463074
The modified gen p mean: 0.4506893754005432, gen p mean: -0.048779167234897614, mean p set: 0.4511696398258209
loss_pred:0.015529675409197807, decouple_loss:0.0011713415151461959
loss_pred:0.015549440868198872, decouple_loss:0.0011002089595422149
loss_pred:0.014954749494791031, decouple_loss:0.0011094985529780388
Iteration: 932, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497433006763458, gen p mean: -0.042249735444784164, mean p set: 0.4502235949039459
The modified gen p mean: 0.4499184191226959, gen p mean: -0.04739907756447792, mean p set: 0.450398713350296
loss_pred:0.01544544193893671, decouple_loss:0.001131300930865109
loss_pred:0.015015027485787868, decouple_loss:0.0013338638236746192
The modified gen p mean: 0.44859692454338074, gen p mean: -0.04949446767568588, mean p set: 0.44907721877098083
loss_pred:0.015426989644765854, decouple_loss:0.0012384513393044472
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012000_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012000_3_24hr.npz
NaN value num: 0
Iteration: 933, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449867308139801, gen p mean: -0.05070553719997406, mean p set: 0.4503476321697235
loss_pred:0.014525897800922394, decouple_loss:0.001033499138429761
The modified gen p mean: 0.45160701870918274, gen p mean: -0.04859151691198349, mean p set: 0.45208731293678284The modified gen p mean: 0.4512248933315277, gen p mean: -0.04714992642402649, mean p set: 0.4517051577568054
loss_pred:0.015062544494867325, decouple_loss:0.0011286957887932658
loss_pred:0.0149428965523839, decouple_loss:0.0010142810642719269
Iteration: 934, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494718015193939, gen p mean: -0.05101429671049118, mean p set: 0.449952095746994
loss_pred:0.014480292797088623, decouple_loss:0.0011644895421341062
The modified gen p mean: 0.4528837502002716, gen p mean: -0.04800171032547951, mean p set: 0.4533640444278717The modified gen p mean: 0.4511817693710327, gen p mean: -0.04780946671962738, mean p set: 0.4516620337963104
loss_pred:0.014549446292221546, decouple_loss:0.001260973745957017
loss_pred:0.014815089292824268, decouple_loss:0.0012085504131391644
Iteration: 935, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499928653240204, gen p mean: -0.04608049988746643, mean p set: 0.4504731595516205
loss_pred:0.015379790216684341, decouple_loss:0.0010255081579089165
The modified gen p mean: 0.4516649544239044, gen p mean: -0.04563643038272858, mean p set: 0.4521452486515045The modified gen p mean: 0.4515511989593506, gen p mean: -0.04677325114607811, mean p set: 0.4520314931869507
loss_pred:0.014840484596788883, decouple_loss:0.001101815258152783
loss_pred:0.015145151875913143, decouple_loss:0.0010066054528579116
Iteration: 936, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44981178641319275, gen p mean: -0.04885202646255493, mean p set: 0.45029211044311523
loss_pred:0.015141546726226807, decouple_loss:0.0011858984362334013
The modified gen p mean: 0.4493926763534546, gen p mean: -0.043081752955913544, mean p set: 0.4498729407787323The modified gen p mean: 0.44813981652259827, gen p mean: -0.05025902017951012, mean p set: 0.44862014055252075
loss_pred:0.01561033632606268, decouple_loss:0.001222587889060378
loss_pred:0.01499062031507492, decouple_loss:0.001241434132680297
Iteration: 937, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45149609446525574, gen p mean: -0.03545934334397316, mean p set: 0.45197638869285583
loss_pred:0.014531770721077919, decouple_loss:0.0010755012044683099
The modified gen p mean: 0.44991931319236755, gen p mean: -0.04442152753472328, mean p set: 0.45039960741996765The modified gen p mean: 0.44974344968795776, gen p mean: -0.049944039434194565, mean p set: 0.45022377371788025
loss_pred:0.01480445172637701, decouple_loss:0.0011815634788945317
loss_pred:0.01538721565157175, decouple_loss:0.0011537442915141582
Iteration: 938, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.451507031917572, gen p mean: -0.04168868809938431, mean p set: 0.4519873261451721
The modified gen p mean: 0.45150044560432434, gen p mean: -0.038702208548784256, mean p set: 0.45198073983192444
loss_pred:0.015618259087204933, decouple_loss:0.0010602864203974605
loss_pred:0.014977830462157726, decouple_loss:0.0014302318450063467
The modified gen p mean: 0.4518389105796814, gen p mean: -0.0413178987801075, mean p set: 0.4523191750049591
loss_pred:0.015463119372725487, decouple_loss:0.0012468317290768027
Iteration: 939, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45027345418930054, gen p mean: -0.042058371007442474, mean p set: 0.45075374841690063
The modified gen p mean: 0.4490898549556732, gen p mean: -0.040120236575603485, mean p set: 0.4495701789855957
loss_pred:0.01559443213045597, decouple_loss:0.0012063209433108568
loss_pred:0.015345141291618347, decouple_loss:0.00123879115562886
The modified gen p mean: 0.45145177841186523, gen p mean: -0.04030746966600418, mean p set: 0.4519321024417877
loss_pred:0.014764024876058102, decouple_loss:0.001242765341885388
Iteration: 940, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511222839355469, gen p mean: -0.04330391064286232, mean p set: 0.4516025483608246
The modified gen p mean: 0.45058420300483704, gen p mean: -0.04539508372545242, mean p set: 0.4510645270347595
loss_pred:0.015662044286727905, decouple_loss:0.0010381516767665744
loss_pred:0.014981023035943508, decouple_loss:0.001043030177243054
The modified gen p mean: 0.4501604437828064, gen p mean: -0.039530199021101, mean p set: 0.4506407380104065
loss_pred:0.014966768212616444, decouple_loss:0.0010895014274865389
2023-05-01 09:03:11 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.04941413924098015, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.045352376997470856, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830237865448, gen p mean: -0.04589017853140831, mean p set: 0.4500633478164673
loss_pred:0.018493274226784706, decouple_loss:0.0013173457700759172
loss_pred:0.017458749935030937, decouple_loss:0.0013039418263360858
loss_pred:0.017599329352378845, decouple_loss:0.001291937194764614
WV_0_PC_1_EH_0_PS_40, loss: 0.017915671691298485, avg_mse: 0.02579524740576744
current test mse: 0.025795
Iteration: 941, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507520794868469, gen p mean: -0.04189398139715195, mean p set: 0.4512324035167694
The modified gen p mean: 0.44978782534599304, gen p mean: -0.04341286048293114, mean p set: 0.45026808977127075
The modified gen p mean: 0.4492553770542145, gen p mean: -0.04240479692816734, mean p set: 0.4497356712818146
loss_pred:0.014462421648204327, decouple_loss:0.001152241020463407
loss_pred:0.014912201091647148, decouple_loss:0.001186957350000739
loss_pred:0.015472752042114735, decouple_loss:0.0011405422119423747
Iteration: 942, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44905152916908264, gen p mean: -0.04607732221484184, mean p set: 0.44953182339668274
The modified gen p mean: 0.44892236590385437, gen p mean: -0.044896017760038376, mean p set: 0.44940266013145447
loss_pred:0.014641053974628448, decouple_loss:0.001175400917418301
loss_pred:0.014662833884358406, decouple_loss:0.0011582716833800077
The modified gen p mean: 0.4512780010700226, gen p mean: -0.044473063200712204, mean p set: 0.45175832509994507
loss_pred:0.015005283057689667, decouple_loss:0.0010827552760019898
Iteration: 943, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45039647817611694, gen p mean: -0.04849163442850113, mean p set: 0.45087674260139465
loss_pred:0.015749625861644745, decouple_loss:0.0010974290780723095
The modified gen p mean: 0.4488501250743866, gen p mean: -0.053761281073093414, mean p set: 0.4493304491043091The modified gen p mean: 0.4476621448993683, gen p mean: -0.052801601588726044, mean p set: 0.448142409324646
loss_pred:0.015272555872797966, decouple_loss:0.0010251675266772509
loss_pred:0.014848073944449425, decouple_loss:0.0010754051618278027
Iteration: 944, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45147398114204407, gen p mean: -0.049609240144491196, mean p set: 0.45195427536964417
loss_pred:0.014354651793837547, decouple_loss:0.0011779834749177098
The modified gen p mean: 0.44980132579803467, gen p mean: -0.05065564811229706, mean p set: 0.45028162002563477The modified gen p mean: 0.45277976989746094, gen p mean: -0.05023028329014778, mean p set: 0.45326003432273865
loss_pred:0.015552678145468235, decouple_loss:0.0012347581796348095
loss_pred:0.014548820443451405, decouple_loss:0.0011971136555075645
Iteration: 945, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44874751567840576, gen p mean: -0.053643304854631424, mean p set: 0.44922778010368347
loss_pred:0.014849213883280754, decouple_loss:0.001182186882942915
The modified gen p mean: 0.451978862285614, gen p mean: -0.048182837665081024, mean p set: 0.4524591267108917The modified gen p mean: 0.4509528577327728, gen p mean: -0.04612882062792778, mean p set: 0.4514331519603729
loss_pred:0.014643133617937565, decouple_loss:0.001098582404665649loss_pred:0.0144662382081151, decouple_loss:0.001168440910987556
Iteration: 946, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44996708631515503, gen p mean: -0.05519291013479233, mean p set: 0.4504474103450775
loss_pred:0.014586742036044598, decouple_loss:0.0013862918131053448
The modified gen p mean: 0.4513486921787262, gen p mean: -0.04496663436293602, mean p set: 0.4518289566040039The modified gen p mean: 0.4494360387325287, gen p mean: -0.04884111136198044, mean p set: 0.4499163329601288
loss_pred:0.01550374273210764, decouple_loss:0.0011043001431971788
loss_pred:0.014086689800024033, decouple_loss:0.0011072758352383971
Iteration: 947, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504871964454651, gen p mean: -0.05120815336704254, mean p set: 0.4509674608707428
loss_pred:0.014753432013094425, decouple_loss:0.001200129627250135
The modified gen p mean: 0.4493885636329651, gen p mean: -0.045284975320100784, mean p set: 0.4498688280582428The modified gen p mean: 0.4512796401977539, gen p mean: -0.04375934973359108, mean p set: 0.4517599642276764
loss_pred:0.014396902173757553, decouple_loss:0.0011091709602624178
loss_pred:0.015019044280052185, decouple_loss:0.001207926427014172
Iteration: 948, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4528367817401886, gen p mean: -0.04643963277339935, mean p set: 0.4533170461654663
loss_pred:0.014326581731438637, decouple_loss:0.0010806011268869042
The modified gen p mean: 0.45123574137687683, gen p mean: -0.04110834747552872, mean p set: 0.4517160654067993The modified gen p mean: 0.4511565864086151, gen p mean: -0.04494301602244377, mean p set: 0.4516368806362152
loss_pred:0.015374280512332916, decouple_loss:0.0010327245108783245
loss_pred:0.014947241172194481, decouple_loss:0.0010989130241796374
Iteration: 949, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45082294940948486, gen p mean: -0.04516160488128662, mean p set: 0.45130327343940735
loss_pred:0.014638758264482021, decouple_loss:0.001367446267977357
The modified gen p mean: 0.44903847575187683, gen p mean: -0.04247903451323509, mean p set: 0.44951876997947693The modified gen p mean: 0.45285388827323914, gen p mean: -0.04608995094895363, mean p set: 0.45333418250083923
loss_pred:0.014529284089803696, decouple_loss:0.0014141295105218887
loss_pred:0.01421164907515049, decouple_loss:0.0011896674986928701
Iteration: 950, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44969499111175537, gen p mean: -0.04594044014811516, mean p set: 0.4501752555370331
loss_pred:0.014624346047639847, decouple_loss:0.0012169210240244865
The modified gen p mean: 0.4514136016368866, gen p mean: -0.04290340095758438, mean p set: 0.4518939256668091The modified gen p mean: 0.4496873617172241, gen p mean: -0.04894312098622322, mean p set: 0.4501676559448242
loss_pred:0.014711213298141956, decouple_loss:0.001153712859377265
loss_pred:0.015011577866971493, decouple_loss:0.0011853090254589915
2023-05-01 09:05:04 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.05006320774555206, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04642508924007416, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04694606736302376, mean p set: 0.4500633478164673
loss_pred:0.018566928803920746, decouple_loss:0.0012838519178330898
loss_pred:0.017533885315060616, decouple_loss:0.0012692139716818929
loss_pred:0.017621692270040512, decouple_loss:0.0013394675916060805
WV_0_PC_1_EH_0_PS_40, loss: 0.017972378060221672, avg_mse: 0.0259296502918005
current test mse: 0.02593
Iteration: 951, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44950807094573975, gen p mean: -0.043861810117959976, mean p set: 0.44998836517333984
The modified gen p mean: 0.4513408839702606, gen p mean: -0.045833609998226166, mean p set: 0.4518211781978607
The modified gen p mean: 0.45114535093307495, gen p mean: -0.0456264354288578, mean p set: 0.45162567496299744
loss_pred:0.01557990163564682, decouple_loss:0.0012630678247660398
loss_pred:0.014562128111720085, decouple_loss:0.0013329960638657212
loss_pred:0.015295127406716347, decouple_loss:0.001506089000031352
Iteration: 952, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493529200553894, gen p mean: -0.043887361884117126, mean p set: 0.4498332440853119
The modified gen p mean: 0.44974252581596375, gen p mean: -0.044869862496852875, mean p set: 0.45022279024124146
loss_pred:0.014679157175123692, decouple_loss:0.0010252095526084304
loss_pred:0.014994530007243156, decouple_loss:0.0011526949238032103
The modified gen p mean: 0.45214930176734924, gen p mean: -0.04813230037689209, mean p set: 0.45262959599494934
loss_pred:0.014582434669137001, decouple_loss:0.0011442594695836306
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012013_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012013_3_24hr.npz
NaN value num: 0
Iteration: 953, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480850100517273, gen p mean: -0.04520246759057045, mean p set: 0.4485653042793274
loss_pred:0.013662513345479965, decouple_loss:0.001184603781439364
The modified gen p mean: 0.4485373795032501, gen p mean: -0.04714994132518768, mean p set: 0.4490176737308502The modified gen p mean: 0.4474093019962311, gen p mean: -0.045819804072380066, mean p set: 0.4478895962238312
loss_pred:0.013604098930954933, decouple_loss:0.0012182905338704586
loss_pred:0.014055945910513401, decouple_loss:0.001278633251786232
Iteration: 954, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480471909046173, gen p mean: -0.05308869481086731, mean p set: 0.4485274851322174
loss_pred:0.014146204106509686, decouple_loss:0.0011857629287987947
The modified gen p mean: 0.4487799406051636, gen p mean: -0.052312422543764114, mean p set: 0.44926023483276367The modified gen p mean: 0.44742703437805176, gen p mean: -0.05324045941233635, mean p set: 0.44790735840797424
loss_pred:0.013931225053966045, decouple_loss:0.0011075407965108752
loss_pred:0.013763157650828362, decouple_loss:0.0012107320362702012
Iteration: 955, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489162862300873, gen p mean: -0.05122782662510872, mean p set: 0.4493965804576874
loss_pred:0.013729213736951351, decouple_loss:0.0012247804552316666
The modified gen p mean: 0.4470941126346588, gen p mean: -0.05254153907299042, mean p set: 0.4475743770599365
The modified gen p mean: 0.4479955732822418, gen p mean: -0.05904432386159897, mean p set: 0.4484758675098419
loss_pred:0.014218875207006931, decouple_loss:0.0012647981056943536
loss_pred:0.013700240291655064, decouple_loss:0.0012250778963789344
Iteration: 956, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473222494125366, gen p mean: -0.06238071247935295, mean p set: 0.4478025436401367
loss_pred:0.013346095569431782, decouple_loss:0.0012969428207725286
The modified gen p mean: 0.44627130031585693, gen p mean: -0.055934589356184006, mean p set: 0.44675159454345703The modified gen p mean: 0.44829919934272766, gen p mean: -0.053303129971027374, mean p set: 0.44877946376800537
loss_pred:0.014206679537892342, decouple_loss:0.0012372498167678714
loss_pred:0.013425050303339958, decouple_loss:0.0015299440128728747
Iteration: 957, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44819068908691406, gen p mean: -0.0547957606613636, mean p set: 0.4486709535121918
loss_pred:0.01328579057008028, decouple_loss:0.0012263467069715261
The modified gen p mean: 0.44724029302597046, gen p mean: -0.059743482619524, mean p set: 0.44772061705589294The modified gen p mean: 0.44876283407211304, gen p mean: -0.04886050894856453, mean p set: 0.44924309849739075
loss_pred:0.01407286524772644, decouple_loss:0.0013479649787768722
loss_pred:0.013611583970487118, decouple_loss:0.0012804587604478002
Iteration: 958, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44708892703056335, gen p mean: -0.055226881057024, mean p set: 0.44756919145584106
loss_pred:0.014179243706166744, decouple_loss:0.0012815457303076982
The modified gen p mean: 0.44776856899261475, gen p mean: -0.06134777143597603, mean p set: 0.44824886322021484The modified gen p mean: 0.4469245970249176, gen p mean: -0.05592852830886841, mean p set: 0.4474049210548401
loss_pred:0.013445957563817501, decouple_loss:0.0013064172817394137
loss_pred:0.013659442774951458, decouple_loss:0.0014825937105342746
Iteration: 959, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44779109954833984, gen p mean: -0.05868495628237724, mean p set: 0.44827136397361755
loss_pred:0.013255099765956402, decouple_loss:0.001329347607679665
The modified gen p mean: 0.4483893811702728, gen p mean: -0.05078420042991638, mean p set: 0.4488696753978729The modified gen p mean: 0.44799885153770447, gen p mean: -0.057700201869010925, mean p set: 0.4484791159629822
loss_pred:0.01354227215051651, decouple_loss:0.00128147192299366
loss_pred:0.013502731919288635, decouple_loss:0.0013124679680913687
Iteration: 960, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474467933177948, gen p mean: -0.048899855464696884, mean p set: 0.4479270875453949
loss_pred:0.013038983568549156, decouple_loss:0.0014144110027700663
The modified gen p mean: 0.4470864534378052, gen p mean: -0.0556069016456604, mean p set: 0.44756677746772766The modified gen p mean: 0.4481365978717804, gen p mean: -0.051890816539525986, mean p set: 0.4486168920993805
loss_pred:0.01347100455313921, decouple_loss:0.0014256472932174802
loss_pred:0.013533948920667171, decouple_loss:0.001342803705483675
2023-05-01 09:07:35 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.04936668649315834, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04529755935072899, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.0460423082113266, mean p set: 0.4500633478164673
loss_pred:0.019144421443343163, decouple_loss:0.0015379093820229173
loss_pred:0.018102364614605904, decouple_loss:0.0013233069330453873
loss_pred:0.018140582367777824, decouple_loss:0.0013479923363775015
WV_0_PC_1_EH_0_PS_40, loss: 0.018532609567046165, avg_mse: 0.02697085216641426
current test mse: 0.026971
Iteration: 961, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473112225532532, gen p mean: -0.04667080193758011, mean p set: 0.44779151678085327
The modified gen p mean: 0.4467009902000427, gen p mean: -0.043209392577409744, mean p set: 0.4471812844276428
The modified gen p mean: 0.44784659147262573, gen p mean: -0.04538114741444588, mean p set: 0.44832685589790344
loss_pred:0.013313593342900276, decouple_loss:0.0015652105212211609
loss_pred:0.013503278605639935, decouple_loss:0.001386985881254077
loss_pred:0.013478194363415241, decouple_loss:0.0015191177371889353
Iteration: 962, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44889259338378906, gen p mean: -0.04090163856744766, mean p set: 0.44937291741371155
The modified gen p mean: 0.4465149939060211, gen p mean: -0.04548542946577072, mean p set: 0.4469953179359436
loss_pred:0.013492350466549397, decouple_loss:0.0013954374007880688
loss_pred:0.013386198319494724, decouple_loss:0.0013389195082709193
The modified gen p mean: 0.44763094186782837, gen p mean: -0.04541400074958801, mean p set: 0.4481112062931061
loss_pred:0.013754132203757763, decouple_loss:0.0013162764953449368
Iteration: 963, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467791020870209, gen p mean: -0.052414536476135254, mean p set: 0.44725939631462097
loss_pred:0.013347725383937359, decouple_loss:0.001365439034998417
The modified gen p mean: 0.4468412697315216, gen p mean: -0.05322849750518799, mean p set: 0.4473215639591217The modified gen p mean: 0.44745805859565735, gen p mean: -0.05276225134730339, mean p set: 0.44793838262557983
loss_pred:0.013472696766257286, decouple_loss:0.0013458937173709273
loss_pred:0.013302729465067387, decouple_loss:0.001392332254908979
Iteration: 964, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448162704706192, gen p mean: -0.042969368398189545, mean p set: 0.4486429989337921
loss_pred:0.013722366653382778, decouple_loss:0.0015050156507641077
The modified gen p mean: 0.4474667012691498, gen p mean: -0.05371983349323273, mean p set: 0.4479469656944275The modified gen p mean: 0.4470463991165161, gen p mean: -0.050743069499731064, mean p set: 0.4475267231464386
loss_pred:0.013151288032531738, decouple_loss:0.0015248908894136548
loss_pred:0.01355183869600296, decouple_loss:0.0014148756163194776
Iteration: 965, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446719229221344, gen p mean: -0.057870570570230484, mean p set: 0.4471994936466217
loss_pred:0.013521078042685986, decouple_loss:0.0013227120507508516
The modified gen p mean: 0.4462844133377075, gen p mean: -0.0513092577457428, mean p set: 0.44676467776298523The modified gen p mean: 0.4465497136116028, gen p mean: -0.05310206115245819, mean p set: 0.4470299780368805
loss_pred:0.013586373068392277, decouple_loss:0.0013002189807593822
loss_pred:0.013251745142042637, decouple_loss:0.001224279636517167
Iteration: 966, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478975832462311, gen p mean: -0.049314405769109726, mean p set: 0.4483778774738312
loss_pred:0.013492530211806297, decouple_loss:0.0013716511894017458
The modified gen p mean: 0.44681647419929504, gen p mean: -0.05892976000905037, mean p set: 0.44729676842689514The modified gen p mean: 0.4487040936946869, gen p mean: -0.05229121074080467, mean p set: 0.449184387922287
loss_pred:0.013262763619422913, decouple_loss:0.0013543913373723626
loss_pred:0.013299038633704185, decouple_loss:0.001474179094657302
Iteration: 967, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44788146018981934, gen p mean: -0.05573846772313118, mean p set: 0.44836175441741943
loss_pred:0.013204028829932213, decouple_loss:0.0014647585339844227
The modified gen p mean: 0.4472711682319641, gen p mean: -0.052552901208400726, mean p set: 0.4477514624595642The modified gen p mean: 0.4477558732032776, gen p mean: -0.056097324937582016, mean p set: 0.4482361972332001
loss_pred:0.012833712622523308, decouple_loss:0.0013589576119557023loss_pred:0.01300420518964529, decouple_loss:0.0014104689471423626
Iteration: 968, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44799256324768066, gen p mean: -0.047796830534935, mean p set: 0.44847285747528076
loss_pred:0.013406015001237392, decouple_loss:0.0013707004254683852
The modified gen p mean: 0.4472111463546753, gen p mean: -0.05066681280732155, mean p set: 0.4476914703845978The modified gen p mean: 0.44725826382637024, gen p mean: -0.054293833673000336, mean p set: 0.4477385878562927
loss_pred:0.013163811527192593, decouple_loss:0.0012894917745143175
loss_pred:0.013290340080857277, decouple_loss:0.0013016402954235673
Iteration: 969, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466283321380615, gen p mean: -0.0436425618827343, mean p set: 0.447108656167984
loss_pred:0.01302812248468399, decouple_loss:0.0013175199273973703
The modified gen p mean: 0.44747141003608704, gen p mean: -0.05029409006237984, mean p set: 0.44795170426368713The modified gen p mean: 0.44750797748565674, gen p mean: -0.04350806027650833, mean p set: 0.44798827171325684
loss_pred:0.013358207419514656, decouple_loss:0.001285439939238131
loss_pred:0.012773796916007996, decouple_loss:0.0012251546140760183
Iteration: 970, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469221234321594, gen p mean: -0.045604150742292404, mean p set: 0.4474024176597595
loss_pred:0.013164042495191097, decouple_loss:0.001237225253134966
The modified gen p mean: 0.4478999376296997, gen p mean: -0.04111504554748535, mean p set: 0.4483802020549774The modified gen p mean: 0.447113960981369, gen p mean: -0.05123935267329216, mean p set: 0.44759422540664673
loss_pred:0.013194098137319088, decouple_loss:0.0011960628908127546
loss_pred:0.012830699793994427, decouple_loss:0.0013578598154708743
2023-05-01 09:09:27 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.04903225600719452, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04550394043326378, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.045740991830825806, mean p set: 0.4500633478164673
loss_pred:0.019212206825613976, decouple_loss:0.0013188066659495234
loss_pred:0.018183143809437752, decouple_loss:0.001307993195950985
loss_pred:0.018214281648397446, decouple_loss:0.0011904033599421382
WV_0_PC_1_EH_0_PS_40, loss: 0.018600163981318474, avg_mse: 0.027141697704792023
current test mse: 0.027142
Iteration: 971, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44691383838653564, gen p mean: -0.0449175126850605, mean p set: 0.44739410281181335
The modified gen p mean: 0.44652217626571655, gen p mean: -0.05021900311112404, mean p set: 0.44700247049331665
The modified gen p mean: 0.44717198610305786, gen p mean: -0.048832327127456665, mean p set: 0.44765228033065796
loss_pred:0.013171561993658543, decouple_loss:0.0013389947125688195
loss_pred:0.013661317527294159, decouple_loss:0.0012902314774692059
loss_pred:0.013410123065114021, decouple_loss:0.0012794791255146265
Iteration: 972, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44752824306488037, gen p mean: -0.048809073865413666, mean p set: 0.44800853729248047
The modified gen p mean: 0.448482483625412, gen p mean: -0.04889779910445213, mean p set: 0.4489628076553345
loss_pred:0.013061602599918842, decouple_loss:0.0011938249226659536
loss_pred:0.013287837617099285, decouple_loss:0.0011244973866268992
The modified gen p mean: 0.4462960362434387, gen p mean: -0.04961759224534035, mean p set: 0.44677630066871643
loss_pred:0.013462509028613567, decouple_loss:0.001142097287811339
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012018_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012018_3_24hr.npz
NaN value num: 0
Iteration: 973, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475128948688507, gen p mean: -0.04746184125542641, mean p set: 0.4479931592941284
loss_pred:0.016439160332083702, decouple_loss:0.0012265130644664168
The modified gen p mean: 0.4461628794670105, gen p mean: -0.04689415916800499, mean p set: 0.4466431736946106The modified gen p mean: 0.4480680525302887, gen p mean: -0.05748854577541351, mean p set: 0.4485483467578888
loss_pred:0.018237752839922905, decouple_loss:0.0012094180565327406
loss_pred:0.017755985260009766, decouple_loss:0.001316797686740756
Iteration: 974, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44760385155677795, gen p mean: -0.04919369891285896, mean p set: 0.44808417558670044
loss_pred:0.018098575994372368, decouple_loss:0.0013588619185611606
The modified gen p mean: 0.4472379982471466, gen p mean: -0.04782084375619888, mean p set: 0.4477182924747467The modified gen p mean: 0.44806066155433655, gen p mean: -0.054915737360715866, mean p set: 0.44854092597961426
loss_pred:0.01815624348819256, decouple_loss:0.001205245265737176
loss_pred:0.017572591081261635, decouple_loss:0.0012939013540744781
Iteration: 975, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482061564922333, gen p mean: -0.04609142243862152, mean p set: 0.44868648052215576
loss_pred:0.016510872170329094, decouple_loss:0.0013313597301021218
The modified gen p mean: 0.44899240136146545, gen p mean: -0.04501403868198395, mean p set: 0.44947269558906555The modified gen p mean: 0.4477001428604126, gen p mean: -0.04593506455421448, mean p set: 0.4481804668903351
loss_pred:0.017350103706121445, decouple_loss:0.0012460470898076892
loss_pred:0.017139697447419167, decouple_loss:0.0014254205161705613
Iteration: 976, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44777607917785645, gen p mean: -0.049239061772823334, mean p set: 0.44825637340545654
The modified gen p mean: 0.44797283411026, gen p mean: -0.04811257869005203, mean p set: 0.4484530985355377
loss_pred:0.016936983913183212, decouple_loss:0.0012978996383026242
loss_pred:0.01623068004846573, decouple_loss:0.0013115787878632545
The modified gen p mean: 0.448306679725647, gen p mean: -0.049329668283462524, mean p set: 0.44878700375556946
loss_pred:0.01759207993745804, decouple_loss:0.0012201190693303943
Iteration: 977, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44826894998550415, gen p mean: -0.049853891134262085, mean p set: 0.44874924421310425
The modified gen p mean: 0.44624578952789307, gen p mean: -0.053952205926179886, mean p set: 0.44672608375549316
loss_pred:0.016199005767703056, decouple_loss:0.0015573326963931322
loss_pred:0.017396144568920135, decouple_loss:0.0017598089762032032The modified gen p mean: 0.44676050543785095, gen p mean: -0.0533558689057827, mean p set: 0.44724079966545105
loss_pred:0.018099525943398476, decouple_loss:0.0017032106406986713
Iteration: 978, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4461364150047302, gen p mean: -0.05515903979539871, mean p set: 0.4466167390346527
loss_pred:0.017733506858348846, decouple_loss:0.0013407915830612183
The modified gen p mean: 0.44753503799438477, gen p mean: -0.0519971027970314, mean p set: 0.44801533222198486
The modified gen p mean: 0.4488983154296875, gen p mean: -0.05550992488861084, mean p set: 0.4493786096572876
loss_pred:0.01664135418832302, decouple_loss:0.001357713364996016
loss_pred:0.016827400773763657, decouple_loss:0.0013764678733423352
Iteration: 979, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44887346029281616, gen p mean: -0.05432164669036865, mean p set: 0.44935378432273865
loss_pred:0.01707024686038494, decouple_loss:0.001558016869239509
The modified gen p mean: 0.44796857237815857, gen p mean: -0.06028327718377113, mean p set: 0.4484488368034363The modified gen p mean: 0.44825199246406555, gen p mean: -0.05782201886177063, mean p set: 0.44873231649398804
loss_pred:0.016810141503810883, decouple_loss:0.0015471624210476875
loss_pred:0.016850370913743973, decouple_loss:0.0014716243604198098
Iteration: 980, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44938093423843384, gen p mean: -0.0585741363465786, mean p set: 0.44986119866371155
loss_pred:0.016874926164746284, decouple_loss:0.0014223242178559303
The modified gen p mean: 0.44583308696746826, gen p mean: -0.059600625187158585, mean p set: 0.44631341099739075The modified gen p mean: 0.4483039677143097, gen p mean: -0.0572887659072876, mean p set: 0.4487842321395874
loss_pred:0.017714057117700577, decouple_loss:0.0014739533653482795
loss_pred:0.016859332099556923, decouple_loss:0.0012977395672351122
2023-05-01 09:12:02 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.058293651789426804, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.05445196107029915, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.0547737292945385, mean p set: 0.4500633478164673
loss_pred:0.018403954803943634, decouple_loss:0.0013630856992676854
loss_pred:0.0173882395029068, decouple_loss:0.0014808120904490352
loss_pred:0.017463942989706993, decouple_loss:0.0014109753537923098
WV_0_PC_1_EH_0_PS_40, loss: 0.017822962254285812, avg_mse: 0.025609347969293594
current test mse: 0.025609
Iteration: 981, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44906744360923767, gen p mean: -0.055274661630392075, mean p set: 0.4495477080345154
The modified gen p mean: 0.4476563036441803, gen p mean: -0.05280544236302376, mean p set: 0.4481366276741028
The modified gen p mean: 0.4481285512447357, gen p mean: -0.05477292835712433, mean p set: 0.4486088454723358
loss_pred:0.016661345958709717, decouple_loss:0.001270108507014811
loss_pred:0.016584930941462517, decouple_loss:0.0012429873459041119
loss_pred:0.016430461779236794, decouple_loss:0.0013672662898898125
Iteration: 982, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44722896814346313, gen p mean: -0.0543481819331646, mean p set: 0.44770923256874084
loss_pred:0.01755005307495594, decouple_loss:0.0013798682484775782
The modified gen p mean: 0.4473567306995392, gen p mean: -0.05144304409623146, mean p set: 0.4478370249271393The modified gen p mean: 0.4467930793762207, gen p mean: -0.05426240712404251, mean p set: 0.4472734034061432
loss_pred:0.017618870362639427, decouple_loss:0.0014001387171447277
loss_pred:0.01722770556807518, decouple_loss:0.0013831675751134753
Iteration: 983, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448581725358963, gen p mean: -0.05616908147931099, mean p set: 0.4490620791912079
loss_pred:0.017449039965867996, decouple_loss:0.0014903033152222633
The modified gen p mean: 0.4476211667060852, gen p mean: -0.05478355661034584, mean p set: 0.4481014907360077The modified gen p mean: 0.44772711396217346, gen p mean: -0.055574048310518265, mean p set: 0.44820740818977356
loss_pred:0.017497671768069267, decouple_loss:0.0014252944383770227
loss_pred:0.01662345603108406, decouple_loss:0.0015501301968470216
Iteration: 984, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44810646772384644, gen p mean: -0.05802534893155098, mean p set: 0.4485867917537689
loss_pred:0.016779005527496338, decouple_loss:0.001269884523935616
The modified gen p mean: 0.44812729954719543, gen p mean: -0.05103043466806412, mean p set: 0.44860756397247314The modified gen p mean: 0.4492214322090149, gen p mean: -0.05202755331993103, mean p set: 0.4497016966342926
loss_pred:0.01625818945467472, decouple_loss:0.0012586148222908378
loss_pred:0.017121536657214165, decouple_loss:0.0012684047687798738
Iteration: 985, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44672706723213196, gen p mean: -0.05068891495466232, mean p set: 0.44720733165740967
loss_pred:0.01700109988451004, decouple_loss:0.0012454460375010967
The modified gen p mean: 0.4488906264305115, gen p mean: -0.051256000995635986, mean p set: 0.44937095046043396The modified gen p mean: 0.44757699966430664, gen p mean: -0.056433118879795074, mean p set: 0.44805729389190674
loss_pred:0.0166618749499321, decouple_loss:0.0013747180346399546
loss_pred:0.01700456626713276, decouple_loss:0.0012669425923377275
Iteration: 986, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495514929294586, gen p mean: -0.053999487310647964, mean p set: 0.4500318169593811
loss_pred:0.01620500348508358, decouple_loss:0.001237609307281673
The modified gen p mean: 0.4467003345489502, gen p mean: -0.05818555876612663, mean p set: 0.4471806287765503The modified gen p mean: 0.44710925221443176, gen p mean: -0.05850213021039963, mean p set: 0.44758954644203186
loss_pred:0.017295662313699722, decouple_loss:0.00130551983602345
loss_pred:0.017080578953027725, decouple_loss:0.0013173101469874382
Iteration: 987, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470476806163788, gen p mean: -0.058343805372714996, mean p set: 0.4475279748439789
loss_pred:0.017593415454030037, decouple_loss:0.001232815789990127
The modified gen p mean: 0.44801101088523865, gen p mean: -0.05279165133833885, mean p set: 0.44849130511283875The modified gen p mean: 0.4490949511528015, gen p mean: -0.05295107886195183, mean p set: 0.449575275182724
loss_pred:0.016071518883109093, decouple_loss:0.0012549578677862883
loss_pred:0.016795488074421883, decouple_loss:0.0011994446394965053
Iteration: 988, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473099708557129, gen p mean: -0.05799386277794838, mean p set: 0.447790265083313
loss_pred:0.016791481524705887, decouple_loss:0.0012307179858908057
The modified gen p mean: 0.44797590374946594, gen p mean: -0.05299844592809677, mean p set: 0.44845619797706604The modified gen p mean: 0.448026180267334, gen p mean: -0.05714631453156471, mean p set: 0.4485064744949341
loss_pred:0.015401744283735752, decouple_loss:0.0011848177528008819
loss_pred:0.017021790146827698, decouple_loss:0.0012423861771821976
Iteration: 989, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503830373287201, gen p mean: -0.053215283900499344, mean p set: 0.4508633017539978
loss_pred:0.016294455155730247, decouple_loss:0.001123963505961001
The modified gen p mean: 0.4483500123023987, gen p mean: -0.05252193659543991, mean p set: 0.4488303065299988The modified gen p mean: 0.44652047753334045, gen p mean: -0.05290156230330467, mean p set: 0.44700080156326294
loss_pred:0.01639200560748577, decouple_loss:0.0011308570392429829
loss_pred:0.01771024614572525, decouple_loss:0.001174206263385713
Iteration: 990, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465082287788391, gen p mean: -0.05292727053165436, mean p set: 0.4469884932041168
loss_pred:0.01693749986588955, decouple_loss:0.0012415774399414659
The modified gen p mean: 0.4480954706668854, gen p mean: -0.05184349790215492, mean p set: 0.4485757648944855
The modified gen p mean: 0.4474814534187317, gen p mean: -0.05126897245645523, mean p set: 0.4479617476463318
loss_pred:0.016397487372159958, decouple_loss:0.0012229414423927665
loss_pred:0.016232050955295563, decouple_loss:0.0011846291599795222
2023-05-01 09:13:55 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.05627875030040741, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.052576951682567596, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.05283453315496445, mean p set: 0.4500633478164673
loss_pred:0.018428344279527664, decouple_loss:0.0012824800796806812
loss_pred:0.017385950312018394, decouple_loss:0.0012211056891828775
loss_pred:0.01751001551747322, decouple_loss:0.0012461619917303324
WV_0_PC_1_EH_0_PS_40, loss: 0.017837267369031906, avg_mse: 0.02565774880349636
current test mse: 0.025658
Iteration: 991, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482826292514801, gen p mean: -0.05937546119093895, mean p set: 0.4487628936767578
The modified gen p mean: 0.4478619396686554, gen p mean: -0.054278966039419174, mean p set: 0.4483422338962555
The modified gen p mean: 0.45025894045829773, gen p mean: -0.053456202149391174, mean p set: 0.4507392346858978
loss_pred:0.016164354979991913, decouple_loss:0.0013412318658083677
loss_pred:0.01706003025174141, decouple_loss:0.0015208073891699314
loss_pred:0.016825828701257706, decouple_loss:0.0013024325016885996
Iteration: 992, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491898715496063, gen p mean: -0.050035182386636734, mean p set: 0.44967013597488403
The modified gen p mean: 0.44850054383277893, gen p mean: -0.052585940808057785, mean p set: 0.44898083806037903
loss_pred:0.016060324385762215, decouple_loss:0.0011576120741665363
loss_pred:0.01695777103304863, decouple_loss:0.001066825119778514
The modified gen p mean: 0.44721996784210205, gen p mean: -0.05192159488797188, mean p set: 0.44770026206970215
loss_pred:0.017745481804013252, decouple_loss:0.0011390745639801025
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012016_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012016_3_24hr.npz
NaN value num: 0
Iteration: 993, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497251510620117, gen p mean: -0.04051097482442856, mean p set: 0.4502054452896118
loss_pred:0.01758679375052452, decouple_loss:0.001396500039845705
The modified gen p mean: 0.44891878962516785, gen p mean: -0.04502420127391815, mean p set: 0.44939908385276794The modified gen p mean: 0.44997620582580566, gen p mean: -0.0458395890891552, mean p set: 0.45045650005340576
loss_pred:0.017218634486198425, decouple_loss:0.0013154373737052083
loss_pred:0.016589267179369926, decouple_loss:0.0013685859739780426
Iteration: 994, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492427706718445, gen p mean: -0.03498667851090431, mean p set: 0.4497230648994446
loss_pred:0.017857054248452187, decouple_loss:0.0012594849104061723
The modified gen p mean: 0.4509778916835785, gen p mean: -0.03700584918260574, mean p set: 0.451458215713501The modified gen p mean: 0.44930577278137207, gen p mean: -0.03751935064792633, mean p set: 0.4497860372066498
loss_pred:0.017150158062577248, decouple_loss:0.0014303411589935422
loss_pred:0.017864271998405457, decouple_loss:0.001255963696166873
Iteration: 995, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45044204592704773, gen p mean: -0.031202835962176323, mean p set: 0.4509223401546478
The modified gen p mean: 0.4501352906227112, gen p mean: -0.037909697741270065, mean p set: 0.45061561465263367
loss_pred:0.017000576481223106, decouple_loss:0.0011888056760653853
loss_pred:0.01704294979572296, decouple_loss:0.0011909931199625134
The modified gen p mean: 0.4503643810749054, gen p mean: -0.030429238453507423, mean p set: 0.4508446753025055
loss_pred:0.017166871577501297, decouple_loss:0.001362024573609233
Iteration: 996, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494689106941223, gen p mean: -0.04655183479189873, mean p set: 0.4499492049217224
The modified gen p mean: 0.45041823387145996, gen p mean: -0.03439577296376228, mean p set: 0.45089852809906006
loss_pred:0.016717208549380302, decouple_loss:0.001434203004464507
loss_pred:0.01770583726465702, decouple_loss:0.0013089015847072005
The modified gen p mean: 0.44817909598350525, gen p mean: -0.03499636426568031, mean p set: 0.44865939021110535
loss_pred:0.017351539805531502, decouple_loss:0.0014527699677273631
Iteration: 997, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477386474609375, gen p mean: -0.04685182496905327, mean p set: 0.4482189118862152
The modified gen p mean: 0.4495847821235657, gen p mean: -0.04135182499885559, mean p set: 0.45006507635116577
loss_pred:0.017852677032351494, decouple_loss:0.0012231097789481282
loss_pred:0.018230965360999107, decouple_loss:0.0011687078513205051
The modified gen p mean: 0.4488801956176758, gen p mean: -0.04001115262508392, mean p set: 0.44936051964759827
loss_pred:0.01720505580306053, decouple_loss:0.0011995966779068112
Iteration: 998, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44883424043655396, gen p mean: -0.04693301022052765, mean p set: 0.44931453466415405
The modified gen p mean: 0.449876070022583, gen p mean: -0.054823290556669235, mean p set: 0.4503563344478607
loss_pred:0.0177049171179533, decouple_loss:0.0012162154307588935
loss_pred:0.016687151044607162, decouple_loss:0.001239799545146525
The modified gen p mean: 0.4519200921058655, gen p mean: -0.045419640839099884, mean p set: 0.4524003565311432
loss_pred:0.01726258546113968, decouple_loss:0.0014017550274729729
Iteration: 999, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449848473072052, gen p mean: -0.04914511740207672, mean p set: 0.4503287672996521
The modified gen p mean: 0.44890153408050537, gen p mean: -0.0447705015540123, mean p set: 0.44938188791275024
loss_pred:0.017864510416984558, decouple_loss:0.0014764618827030063
loss_pred:0.01685612089931965, decouple_loss:0.0013295701937749982
The modified gen p mean: 0.4523296058177948, gen p mean: -0.04790749400854111, mean p set: 0.4528099000453949
loss_pred:0.016753345727920532, decouple_loss:0.0013412142870947719
Iteration: 1000, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504496455192566, gen p mean: -0.046529386192560196, mean p set: 0.4509299099445343The modified gen p mean: 0.45065709948539734, gen p mean: -0.04777359962463379, mean p set: 0.45113739371299744
loss_pred:0.016883989796042442, decouple_loss:0.0012655194150283933
loss_pred:0.01713288016617298, decouple_loss:0.0012478361604735255
The modified gen p mean: 0.44792625308036804, gen p mean: -0.05160367488861084, mean p set: 0.44840651750564575
loss_pred:0.017572827637195587, decouple_loss:0.0013330710353329778
2023-05-01 09:16:23 itr: 1000
training loss: [0.01763948 0.01694727 0.01719527]
2023-05-01 09:16:23 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.058957066386938095, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.055033762007951736, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.055260635912418365, mean p set: 0.4500633478164673
loss_pred:0.018372289836406708, decouple_loss:0.0012785762082785368
loss_pred:0.017313240095973015, decouple_loss:0.0011852119350805879
loss_pred:0.01748088374733925, decouple_loss:0.0011720539769157767
WV_0_PC_1_EH_0_PS_40, loss: 0.01778273656964302, avg_mse: 0.02550772950053215
current test mse: 0.025508
Iteration: 1001, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44886693358421326, gen p mean: -0.047415994107723236, mean p set: 0.44934722781181335
The modified gen p mean: 0.44779255986213684, gen p mean: -0.05518192797899246, mean p set: 0.44827285408973694
The modified gen p mean: 0.44957196712493896, gen p mean: -0.04560443013906479, mean p set: 0.45005226135253906
loss_pred:0.017710335552692413, decouple_loss:0.0010634820209816098
loss_pred:0.01730634830892086, decouple_loss:0.0011585212778300047
loss_pred:0.017637647688388824, decouple_loss:0.0012075991835445166
Iteration: 1002, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450179785490036, gen p mean: -0.048433635383844376, mean p set: 0.4506600499153137
The modified gen p mean: 0.44977957010269165, gen p mean: -0.04748234525322914, mean p set: 0.45025986433029175
loss_pred:0.017375674098730087, decouple_loss:0.0012757625663653016
loss_pred:0.017146790400147438, decouple_loss:0.001321470714174211
The modified gen p mean: 0.45028096437454224, gen p mean: -0.049907803535461426, mean p set: 0.45076125860214233
loss_pred:0.016879113391041756, decouple_loss:0.001169939641840756
Iteration: 1003, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44793638586997986, gen p mean: -0.04728013277053833, mean p set: 0.44841670989990234
loss_pred:0.016816148534417152, decouple_loss:0.001383696449920535
The modified gen p mean: 0.449520468711853, gen p mean: -0.04454586282372475, mean p set: 0.45000073313713074The modified gen p mean: 0.4481503665447235, gen p mean: -0.04371218755841255, mean p set: 0.448630690574646
loss_pred:0.0169956237077713, decouple_loss:0.0013463840587064624
loss_pred:0.016704410314559937, decouple_loss:0.0011831090087071061
Iteration: 1004, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503604471683502, gen p mean: -0.05019000545144081, mean p set: 0.45084071159362793
loss_pred:0.01643671654164791, decouple_loss:0.0012232703156769276
The modified gen p mean: 0.4481624364852905, gen p mean: -0.043954119086265564, mean p set: 0.448642760515213The modified gen p mean: 0.45000168681144714, gen p mean: -0.04461400583386421, mean p set: 0.45048198103904724
loss_pred:0.017761969938874245, decouple_loss:0.0011002282844856381
loss_pred:0.01689794287085533, decouple_loss:0.0012288271682336926
Iteration: 1005, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488838016986847, gen p mean: -0.04206541180610657, mean p set: 0.4493641257286072
loss_pred:0.01646830327808857, decouple_loss:0.00135735550429672
The modified gen p mean: 0.45057055354118347, gen p mean: -0.0371386855840683, mean p set: 0.45105084776878357The modified gen p mean: 0.4496047794818878, gen p mean: -0.04259413108229637, mean p set: 0.4500850439071655
loss_pred:0.017295222729444504, decouple_loss:0.0013134311884641647
loss_pred:0.017126820981502533, decouple_loss:0.0013206243747845292
Iteration: 1006, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481627643108368, gen p mean: -0.04300675913691521, mean p set: 0.4486430585384369
loss_pred:0.016636589542031288, decouple_loss:0.0011049407767131925
The modified gen p mean: 0.4485178291797638, gen p mean: -0.042288366705179214, mean p set: 0.4489981234073639The modified gen p mean: 0.449825257062912, gen p mean: -0.04079116880893707, mean p set: 0.4503055810928345
loss_pred:0.016660965979099274, decouple_loss:0.0011312385322526097
loss_pred:0.017313392832875252, decouple_loss:0.0012845309684053063
Iteration: 1007, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44959649443626404, gen p mean: -0.041901033371686935, mean p set: 0.45007678866386414
The modified gen p mean: 0.44871675968170166, gen p mean: -0.03752261400222778, mean p set: 0.44919705390930176
loss_pred:0.017548467963933945, decouple_loss:0.0010808664374053478
loss_pred:0.016977766528725624, decouple_loss:0.0011094426736235619
The modified gen p mean: 0.4512498378753662, gen p mean: -0.03963292017579079, mean p set: 0.4517301619052887
loss_pred:0.017022257670760155, decouple_loss:0.0012204853119328618
Iteration: 1008, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484577775001526, gen p mean: -0.05173735320568085, mean p set: 0.4489381015300751
loss_pred:0.01720382831990719, decouple_loss:0.001163822365924716
The modified gen p mean: 0.44855108857154846, gen p mean: -0.04972485080361366, mean p set: 0.44903138279914856
The modified gen p mean: 0.4490698575973511, gen p mean: -0.044203709810972214, mean p set: 0.44955018162727356
loss_pred:0.016826597973704338, decouple_loss:0.0012268454302102327
loss_pred:0.017168330028653145, decouple_loss:0.0011309611145406961
Iteration: 1009, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44882020354270935, gen p mean: -0.05210267752408981, mean p set: 0.44930049777030945
loss_pred:0.0168616883456707, decouple_loss:0.001027572900056839
The modified gen p mean: 0.4471310079097748, gen p mean: -0.05168459191918373, mean p set: 0.4476113021373749The modified gen p mean: 0.450557142496109, gen p mean: -0.0435391366481781, mean p set: 0.4510374367237091
loss_pred:0.016591602936387062, decouple_loss:0.0011747977696359158
loss_pred:0.017909087240695953, decouple_loss:0.0012830191990360618
Iteration: 1010, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45012331008911133, gen p mean: -0.0456513874232769, mean p set: 0.4506036043167114
loss_pred:0.01724066212773323, decouple_loss:0.0011950205080211163
The modified gen p mean: 0.4479113817214966, gen p mean: -0.04565976932644844, mean p set: 0.4483916759490967The modified gen p mean: 0.44812336564064026, gen p mean: -0.046053726226091385, mean p set: 0.44860365986824036
loss_pred:0.017507560551166534, decouple_loss:0.0011969843180850148
loss_pred:0.01676330342888832, decouple_loss:0.0011406592093408108
2023-05-01 09:18:17 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.057612694799900055, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.05395006015896797, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.054141368716955185, mean p set: 0.4500633478164673
loss_pred:0.018346747383475304, decouple_loss:0.0012713128235191107
loss_pred:0.01730276271700859, decouple_loss:0.0012024885509163141
loss_pred:0.017417648807168007, decouple_loss:0.001182881067506969
WV_0_PC_1_EH_0_PS_40, loss: 0.017749998718500137, avg_mse: 0.025429239496588707
current test mse: 0.025429
Iteration: 1011, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502688944339752, gen p mean: -0.043977290391922, mean p set: 0.4507491886615753
The modified gen p mean: 0.4496050179004669, gen p mean: -0.04826214909553528, mean p set: 0.450085312128067
The modified gen p mean: 0.44763854146003723, gen p mean: -0.055252183228731155, mean p set: 0.44811883568763733
loss_pred:0.017084861174225807, decouple_loss:0.0012998763704672456
loss_pred:0.017142603173851967, decouple_loss:0.0012782640988007188loss_pred:0.01691894792020321, decouple_loss:0.0010750129586085677
Iteration: 1012, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44996973872184753, gen p mean: -0.04911438375711441, mean p set: 0.45045000314712524
loss_pred:0.0172859076410532, decouple_loss:0.0014338245382532477
The modified gen p mean: 0.45015621185302734, gen p mean: -0.048089779913425446, mean p set: 0.45063650608062744
The modified gen p mean: 0.4506303369998932, gen p mean: -0.0477602481842041, mean p set: 0.4511106312274933
loss_pred:0.017313504591584206, decouple_loss:0.0011087956372648478
loss_pred:0.017341509461402893, decouple_loss:0.0014263485791161656
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012010_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012010_3_24hr.npz
NaN value num: 0
Iteration: 1013, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45080429315567017, gen p mean: -0.06323913484811783, mean p set: 0.45128458738327026
loss_pred:0.01771462708711624, decouple_loss:0.0011764696100726724
The modified gen p mean: 0.4508184790611267, gen p mean: -0.05214179307222366, mean p set: 0.4512987732887268The modified gen p mean: 0.45128583908081055, gen p mean: -0.05296784266829491, mean p set: 0.45176616311073303
loss_pred:0.01733378693461418, decouple_loss:0.0012541551841422915
loss_pred:0.01701752096414566, decouple_loss:0.0011556025128811598
Iteration: 1014, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4515972435474396, gen p mean: -0.05650357902050018, mean p set: 0.4520775377750397
loss_pred:0.016576888039708138, decouple_loss:0.0011510179610922933
The modified gen p mean: 0.4487875998020172, gen p mean: -0.054059192538261414, mean p set: 0.4492678940296173The modified gen p mean: 0.4504936635494232, gen p mean: -0.05522549897432327, mean p set: 0.4509739875793457
loss_pred:0.017084477469325066, decouple_loss:0.0011974861845374107
loss_pred:0.017395539209246635, decouple_loss:0.0013112934539094567
Iteration: 1015, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491048753261566, gen p mean: -0.05754616856575012, mean p set: 0.4495851993560791
loss_pred:0.01720166578888893, decouple_loss:0.0013192761689424515
The modified gen p mean: 0.45182347297668457, gen p mean: -0.05570265278220177, mean p set: 0.4523037374019623The modified gen p mean: 0.45096108317375183, gen p mean: -0.05755625292658806, mean p set: 0.45144134759902954
loss_pred:0.017137601971626282, decouple_loss:0.0013768295757472515
loss_pred:0.01677924022078514, decouple_loss:0.0012420032871887088
Iteration: 1016, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498027563095093, gen p mean: -0.058616138994693756, mean p set: 0.450283020734787
loss_pred:0.016622118651866913, decouple_loss:0.001250407425686717
The modified gen p mean: 0.4498886168003082, gen p mean: -0.06266514956951141, mean p set: 0.4503689110279083The modified gen p mean: 0.45091500878334045, gen p mean: -0.05584409087896347, mean p set: 0.45139533281326294
loss_pred:0.016849197447299957, decouple_loss:0.0010827286168932915
loss_pred:0.017138443887233734, decouple_loss:0.0011153843952342868
Iteration: 1017, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4509302079677582, gen p mean: -0.05262552201747894, mean p set: 0.45141053199768066
loss_pred:0.017642274498939514, decouple_loss:0.0011404643300920725
The modified gen p mean: 0.4500940144062042, gen p mean: -0.05389142781496048, mean p set: 0.4505743086338043The modified gen p mean: 0.4501175582408905, gen p mean: -0.050103120505809784, mean p set: 0.4505978226661682
loss_pred:0.016800744459033012, decouple_loss:0.0011862193932756782
loss_pred:0.01748255081474781, decouple_loss:0.0013098224299028516
Iteration: 1018, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497884511947632, gen p mean: -0.04829045385122299, mean p set: 0.4502687156200409
loss_pred:0.016654128208756447, decouple_loss:0.0012384760193526745
The modified gen p mean: 0.4506232440471649, gen p mean: -0.04916226863861084, mean p set: 0.4511035680770874
The modified gen p mean: 0.450306236743927, gen p mean: -0.050958480685949326, mean p set: 0.4507865309715271
loss_pred:0.017346883192658424, decouple_loss:0.0012722550891339779
loss_pred:0.016373444348573685, decouple_loss:0.001308865612372756
Iteration: 1019, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501121938228607, gen p mean: -0.0490071065723896, mean p set: 0.4505924582481384
loss_pred:0.016630087047815323, decouple_loss:0.0011554397642612457
The modified gen p mean: 0.4512008726596832, gen p mean: -0.04084926098585129, mean p set: 0.4516811966896057The modified gen p mean: 0.4505902826786041, gen p mean: -0.04202254116535187, mean p set: 0.4510705769062042
loss_pred:0.017104197293519974, decouple_loss:0.0013487340183928609
loss_pred:0.016413424164056778, decouple_loss:0.0012996058212593198
Iteration: 1020, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45035356283187866, gen p mean: -0.042419806122779846, mean p set: 0.45083388686180115
loss_pred:0.017222708091139793, decouple_loss:0.001277644420042634
The modified gen p mean: 0.45126527547836304, gen p mean: -0.04375044256448746, mean p set: 0.45174556970596313The modified gen p mean: 0.45136839151382446, gen p mean: -0.04280765727162361, mean p set: 0.4518486559391022
loss_pred:0.01721968874335289, decouple_loss:0.0013677756069228053
loss_pred:0.016203954815864563, decouple_loss:0.0013338241260498762
2023-05-01 09:20:50 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.04704464599490166, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04299382492899895, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04330318421125412, mean p set: 0.4500633478164673
loss_pred:0.01842411234974861, decouple_loss:0.001270183129236102
loss_pred:0.017373807728290558, decouple_loss:0.0012788234744220972
loss_pred:0.01744743622839451, decouple_loss:0.001253839349374175
WV_0_PC_1_EH_0_PS_40, loss: 0.017811832949519157, avg_mse: 0.025559648871421814
current test mse: 0.02556
Iteration: 1021, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4521726965904236, gen p mean: -0.04270302504301071, mean p set: 0.45265302062034607
The modified gen p mean: 0.4503456652164459, gen p mean: -0.04290922358632088, mean p set: 0.4508259892463684
The modified gen p mean: 0.4508441686630249, gen p mean: -0.04065588861703873, mean p set: 0.4513244926929474
loss_pred:0.01727658323943615, decouple_loss:0.0013275485252961516
loss_pred:0.01647319085896015, decouple_loss:0.0012979371240362525
loss_pred:0.016146883368492126, decouple_loss:0.0013174704508855939
Iteration: 1022, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513743817806244, gen p mean: -0.03889831155538559, mean p set: 0.4518546462059021
loss_pred:0.017000582069158554, decouple_loss:0.0012603242648765445
The modified gen p mean: 0.44879794120788574, gen p mean: -0.04244522377848625, mean p set: 0.44927823543548584The modified gen p mean: 0.45252037048339844, gen p mean: -0.04426868259906769, mean p set: 0.45300063490867615
loss_pred:0.016103440895676613, decouple_loss:0.0012403303990140557
loss_pred:0.01717539317905903, decouple_loss:0.0012902898015454412
Iteration: 1023, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45087429881095886, gen p mean: -0.03967415541410446, mean p set: 0.45135459303855896
loss_pred:0.01614135131239891, decouple_loss:0.0011400585062801838
The modified gen p mean: 0.4503532350063324, gen p mean: -0.04538551717996597, mean p set: 0.4508335292339325The modified gen p mean: 0.45211341977119446, gen p mean: -0.04401347413659096, mean p set: 0.45259371399879456
loss_pred:0.01683969423174858, decouple_loss:0.001147065544500947
loss_pred:0.01663810946047306, decouple_loss:0.0011291827540844679
Iteration: 1024, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508654773235321, gen p mean: -0.04483054578304291, mean p set: 0.4513457417488098
loss_pred:0.01749844290316105, decouple_loss:0.0011915331706404686
The modified gen p mean: 0.4503021836280823, gen p mean: -0.04695475846529007, mean p set: 0.45078244805336The modified gen p mean: 0.45104846358299255, gen p mean: -0.04410538449883461, mean p set: 0.45152872800827026
loss_pred:0.016769349575042725, decouple_loss:0.0011687732767313719
loss_pred:0.016785377636551857, decouple_loss:0.0012290331069380045
Iteration: 1025, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505714178085327, gen p mean: -0.04846148565411568, mean p set: 0.4510516822338104
The modified gen p mean: 0.4503781795501709, gen p mean: -0.04421360790729523, mean p set: 0.450858473777771
loss_pred:0.016570892184972763, decouple_loss:0.0011964676668867469
loss_pred:0.017387043684720993, decouple_loss:0.0012129402020946145
The modified gen p mean: 0.4503122568130493, gen p mean: -0.0509222149848938, mean p set: 0.4507925808429718
loss_pred:0.016642635688185692, decouple_loss:0.001304803998209536
Iteration: 1026, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45070645213127136, gen p mean: -0.047493815422058105, mean p set: 0.4511867165565491
loss_pred:0.01749831810593605, decouple_loss:0.0011572508374229074
The modified gen p mean: 0.45181915163993835, gen p mean: -0.04659458249807358, mean p set: 0.45229944586753845The modified gen p mean: 0.45015034079551697, gen p mean: -0.05134664103388786, mean p set: 0.45063063502311707
loss_pred:0.016597721725702286, decouple_loss:0.0010807168437168002
loss_pred:0.016327619552612305, decouple_loss:0.0012279385700821877
Iteration: 1027, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45170944929122925, gen p mean: -0.04805750027298927, mean p set: 0.45218974351882935
loss_pred:0.017053987830877304, decouple_loss:0.0012015752727165818
The modified gen p mean: 0.4505552351474762, gen p mean: -0.046942394226789474, mean p set: 0.4510355293750763The modified gen p mean: 0.450673371553421, gen p mean: -0.04662274569272995, mean p set: 0.4511536657810211
loss_pred:0.016097143292427063, decouple_loss:0.0011642873287200928
loss_pred:0.016529953107237816, decouple_loss:0.0012754789786413312
Iteration: 1028, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450674831867218, gen p mean: -0.05409149080514908, mean p set: 0.4511551260948181
loss_pred:0.017747776582837105, decouple_loss:0.001193854259327054
The modified gen p mean: 0.4508250951766968, gen p mean: -0.04234984517097473, mean p set: 0.4513053894042969The modified gen p mean: 0.4509161710739136, gen p mean: -0.046274583786726, mean p set: 0.45139649510383606
loss_pred:0.017336620017886162, decouple_loss:0.0012023119488731027
loss_pred:0.01623738370835781, decouple_loss:0.001075896667316556
Iteration: 1029, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508809447288513, gen p mean: -0.04658525064587593, mean p set: 0.4513612687587738
loss_pred:0.016295798122882843, decouple_loss:0.0011444210540503263
The modified gen p mean: 0.45150989294052124, gen p mean: -0.045417021960020065, mean p set: 0.45199018716812134The modified gen p mean: 0.4511512517929077, gen p mean: -0.04560338705778122, mean p set: 0.4516315758228302
loss_pred:0.016420897096395493, decouple_loss:0.0012651411816477776
loss_pred:0.017121756449341774, decouple_loss:0.001302967662923038
Iteration: 1030, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45113706588745117, gen p mean: -0.04475967213511467, mean p set: 0.45161738991737366
loss_pred:0.01621153950691223, decouple_loss:0.0010965288383886218
The modified gen p mean: 0.45160576701164246, gen p mean: -0.041524045169353485, mean p set: 0.45208606123924255The modified gen p mean: 0.45000413060188293, gen p mean: -0.04055339843034744, mean p set: 0.45048442482948303
loss_pred:0.0167804304510355, decouple_loss:0.0012474829563871026
loss_pred:0.017009947448968887, decouple_loss:0.00119372783228755
2023-05-01 09:22:44 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.04716252535581589, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04316572844982147, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.043330200016498566, mean p set: 0.4500633478164673
loss_pred:0.018430039286613464, decouple_loss:0.0011967308819293976
loss_pred:0.01736164279282093, decouple_loss:0.0011740594636648893
loss_pred:0.01746029406785965, decouple_loss:0.0011977035319432616
WV_0_PC_1_EH_0_PS_40, loss: 0.01781013421714306, avg_mse: 0.025590207427740097
current test mse: 0.02559
Iteration: 1031, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45102566480636597, gen p mean: -0.04181442782282829, mean p set: 0.45150595903396606
The modified gen p mean: 0.45091378688812256, gen p mean: -0.04171134531497955, mean p set: 0.45139408111572266
The modified gen p mean: 0.4504493474960327, gen p mean: -0.045600052922964096, mean p set: 0.4509296715259552
loss_pred:0.017186682671308517, decouple_loss:0.001213179319165647
loss_pred:0.01640673540532589, decouple_loss:0.0011891444446519017
loss_pred:0.016803786158561707, decouple_loss:0.0011918325908482075
Iteration: 1032, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500894844532013, gen p mean: -0.0502949059009552, mean p set: 0.4505697786808014
The modified gen p mean: 0.451437383890152, gen p mean: -0.04364397004246712, mean p set: 0.4519176781177521
loss_pred:0.017740219831466675, decouple_loss:0.0011785919778048992
loss_pred:0.016273895278573036, decouple_loss:0.001261022174730897
The modified gen p mean: 0.450095534324646, gen p mean: -0.0459030419588089, mean p set: 0.4505757987499237
loss_pred:0.016411757096648216, decouple_loss:0.0011076030787080526
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012003_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012003_3_24hr.npz
NaN value num: 0
Iteration: 1033, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45128461718559265, gen p mean: -0.04169943928718567, mean p set: 0.45176488161087036
loss_pred:0.01597621478140354, decouple_loss:0.0012623491929844022
The modified gen p mean: 0.45121800899505615, gen p mean: -0.03978424146771431, mean p set: 0.45169830322265625The modified gen p mean: 0.45116060972213745, gen p mean: -0.042410798370838165, mean p set: 0.45164093375205994
loss_pred:0.015540637075901031, decouple_loss:0.0013171423925086856
loss_pred:0.015431483276188374, decouple_loss:0.0012700563529506326
Iteration: 1034, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45068731904029846, gen p mean: -0.04406839609146118, mean p set: 0.45116758346557617
loss_pred:0.01590932533144951, decouple_loss:0.0012360477121546865
The modified gen p mean: 0.45282426476478577, gen p mean: -0.04060596227645874, mean p set: 0.4533045291900635The modified gen p mean: 0.4502285420894623, gen p mean: -0.0439019612967968, mean p set: 0.4507088363170624
loss_pred:0.015860551968216896, decouple_loss:0.00123116304166615
loss_pred:0.015660611912608147, decouple_loss:0.001162893371656537
Iteration: 1035, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44962698221206665, gen p mean: -0.04624544084072113, mean p set: 0.45010724663734436
loss_pred:0.015922728925943375, decouple_loss:0.0011333641596138477
The modified gen p mean: 0.45181411504745483, gen p mean: -0.03995373472571373, mean p set: 0.45229440927505493The modified gen p mean: 0.45076966285705566, gen p mean: -0.0411069318652153, mean p set: 0.45124995708465576
loss_pred:0.015748880803585052, decouple_loss:0.0013400268508121371
loss_pred:0.016689777374267578, decouple_loss:0.0012134885182604194
Iteration: 1036, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44994911551475525, gen p mean: -0.043036382645368576, mean p set: 0.45042940974235535
The modified gen p mean: 0.44996029138565063, gen p mean: -0.04519097879528999, mean p set: 0.45044055581092834
loss_pred:0.016508113592863083, decouple_loss:0.0011929518077522516
loss_pred:0.016449175775051117, decouple_loss:0.0011360665084794164
The modified gen p mean: 0.45080623030662537, gen p mean: -0.04586362838745117, mean p set: 0.45128652453422546
loss_pred:0.015743928030133247, decouple_loss:0.001248872373253107
Iteration: 1037, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4525086283683777, gen p mean: -0.044661134481430054, mean p set: 0.4529889225959778
The modified gen p mean: 0.4518243670463562, gen p mean: -0.04871514439582825, mean p set: 0.4523046314716339
loss_pred:0.01565861515700817, decouple_loss:0.001346500008367002
loss_pred:0.015810292214155197, decouple_loss:0.0012090196833014488
The modified gen p mean: 0.45068761706352234, gen p mean: -0.04377315193414688, mean p set: 0.45116788148880005
loss_pred:0.016116194427013397, decouple_loss:0.0013089940184727311
Iteration: 1038, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44978272914886475, gen p mean: -0.04472631961107254, mean p set: 0.45026299357414246
loss_pred:0.016256239265203476, decouple_loss:0.0012631947174668312
The modified gen p mean: 0.45046862959861755, gen p mean: -0.0466361828148365, mean p set: 0.45094895362854004The modified gen p mean: 0.4515930414199829, gen p mean: -0.04870270565152168, mean p set: 0.4520733654499054
loss_pred:0.015821821987628937, decouple_loss:0.001282239449210465
loss_pred:0.01576421409845352, decouple_loss:0.0013950405409559608
Iteration: 1039, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504152536392212, gen p mean: -0.048743799328804016, mean p set: 0.4508955478668213
The modified gen p mean: 0.45172634720802307, gen p mean: -0.05121907964348793, mean p set: 0.45220664143562317
loss_pred:0.015554052777588367, decouple_loss:0.0012400354025885463
loss_pred:0.015561521053314209, decouple_loss:0.001270702457986772
The modified gen p mean: 0.45220863819122314, gen p mean: -0.04851142317056656, mean p set: 0.45268896222114563
loss_pred:0.015261562541127205, decouple_loss:0.0012849150225520134
Iteration: 1040, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45129308104515076, gen p mean: -0.050721317529678345, mean p set: 0.45177337527275085
loss_pred:0.016038646921515465, decouple_loss:0.0012178746983408928
The modified gen p mean: 0.45102256536483765, gen p mean: -0.04645535722374916, mean p set: 0.45150282979011536The modified gen p mean: 0.45082539319992065, gen p mean: -0.04809670150279999, mean p set: 0.45130568742752075
loss_pred:0.015562083572149277, decouple_loss:0.0012640502536669374
loss_pred:0.015508370473980904, decouple_loss:0.001356594730168581
2023-05-01 09:25:22 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.05599496513605118, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.051965031772851944, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.05249294638633728, mean p set: 0.4500633478164673
loss_pred:0.01846913993358612, decouple_loss:0.0012456269469112158
loss_pred:0.017416367307305336, decouple_loss:0.001229733694344759
loss_pred:0.01746666617691517, decouple_loss:0.001274071168154478
WV_0_PC_1_EH_0_PS_40, loss: 0.017846548929810524, avg_mse: 0.025650538504123688
current test mse: 0.025651
Iteration: 1041, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45262861251831055, gen p mean: -0.04637822508811951, mean p set: 0.45310890674591064
The modified gen p mean: 0.4522443115711212, gen p mean: -0.04894518852233887, mean p set: 0.4527246057987213
The modified gen p mean: 0.4519196152687073, gen p mean: -0.04643028602004051, mean p set: 0.45239993929862976
loss_pred:0.015743570402264595, decouple_loss:0.001195337506942451
loss_pred:0.015417881309986115, decouple_loss:0.0011807008413597941
loss_pred:0.01522805169224739, decouple_loss:0.0012106200447306037
Iteration: 1042, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4518912732601166, gen p mean: -0.04445192962884903, mean p set: 0.4523715376853943
loss_pred:0.015082048252224922, decouple_loss:0.0013127655256539583
The modified gen p mean: 0.45287275314331055, gen p mean: -0.04278397560119629, mean p set: 0.45335304737091064The modified gen p mean: 0.4513220489025116, gen p mean: -0.04091309756040573, mean p set: 0.4518023431301117
loss_pred:0.016332346946001053, decouple_loss:0.0012924968032166362
loss_pred:0.015398369170725346, decouple_loss:0.0012483852915465832
Iteration: 1043, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45061710476875305, gen p mean: -0.044653668999671936, mean p set: 0.45109736919403076
loss_pred:0.015636270865797997, decouple_loss:0.0013811985263600945
The modified gen p mean: 0.4500848054885864, gen p mean: -0.04741191118955612, mean p set: 0.4505651295185089The modified gen p mean: 0.45203185081481934, gen p mean: -0.040450677275657654, mean p set: 0.45251214504241943
loss_pred:0.015857160091400146, decouple_loss:0.001233555842190981
loss_pred:0.01580175571143627, decouple_loss:0.0013319433201104403
Iteration: 1044, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505796730518341, gen p mean: -0.04471179470419884, mean p set: 0.4510599374771118
loss_pred:0.01566878706216812, decouple_loss:0.0011728355893865228
The modified gen p mean: 0.45182886719703674, gen p mean: -0.04186785966157913, mean p set: 0.4523092210292816The modified gen p mean: 0.45056819915771484, gen p mean: -0.04568498209118843, mean p set: 0.45104846358299255
loss_pred:0.01564149186015129, decouple_loss:0.0012308218283578753
loss_pred:0.015463298186659813, decouple_loss:0.001128489850088954
Iteration: 1045, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4510365128517151, gen p mean: -0.0470212921500206, mean p set: 0.4515168070793152
loss_pred:0.015476974658668041, decouple_loss:0.0012069576187059283
The modified gen p mean: 0.4511014521121979, gen p mean: -0.04795036092400551, mean p set: 0.4515817165374756The modified gen p mean: 0.4514588415622711, gen p mean: -0.04190700873732567, mean p set: 0.4519391357898712
loss_pred:0.015017621219158173, decouple_loss:0.0015950287925079465
loss_pred:0.01613510213792324, decouple_loss:0.0012170524569228292
Iteration: 1046, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44986605644226074, gen p mean: -0.04785863682627678, mean p set: 0.45034632086753845
loss_pred:0.01544285099953413, decouple_loss:0.0012431048089638352
The modified gen p mean: 0.45187824964523315, gen p mean: -0.048158228397369385, mean p set: 0.45235851407051086The modified gen p mean: 0.45126569271087646, gen p mean: -0.05097155272960663, mean p set: 0.4517459571361542
loss_pred:0.015295078046619892, decouple_loss:0.0013063437072560191
loss_pred:0.016136685386300087, decouple_loss:0.0013882472412660718
Iteration: 1047, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4518423080444336, gen p mean: -0.049277033656835556, mean p set: 0.4523225724697113
loss_pred:0.015031199902296066, decouple_loss:0.0011773628648370504
The modified gen p mean: 0.4533810317516327, gen p mean: -0.04880042001605034, mean p set: 0.4538613259792328The modified gen p mean: 0.45319584012031555, gen p mean: -0.04544208198785782, mean p set: 0.45367616415023804
loss_pred:0.015526634640991688, decouple_loss:0.001109987497329712
loss_pred:0.01616828329861164, decouple_loss:0.0011729924008250237
Iteration: 1048, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4521043300628662, gen p mean: -0.0498000793159008, mean p set: 0.4525846242904663
loss_pred:0.01562819816172123, decouple_loss:0.0011849692091345787
The modified gen p mean: 0.45170214772224426, gen p mean: -0.047150466591119766, mean p set: 0.45218244194984436The modified gen p mean: 0.45107415318489075, gen p mean: -0.04926976561546326, mean p set: 0.45155444741249084
loss_pred:0.015835843980312347, decouple_loss:0.0012599900364875793
loss_pred:0.015187948942184448, decouple_loss:0.0012734511401504278
Iteration: 1049, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4518909454345703, gen p mean: -0.04221247136592865, mean p set: 0.4523712396621704
loss_pred:0.016381297260522842, decouple_loss:0.0013279534177854657
The modified gen p mean: 0.45086026191711426, gen p mean: -0.04898142069578171, mean p set: 0.45134058594703674The modified gen p mean: 0.45255526900291443, gen p mean: -0.044167645275592804, mean p set: 0.45303553342819214
loss_pred:0.015372994355857372, decouple_loss:0.0013510403223335743
loss_pred:0.015487312339246273, decouple_loss:0.0012929746881127357
Iteration: 1050, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492797553539276, gen p mean: -0.04118715599179268, mean p set: 0.4497600495815277
loss_pred:0.015860101208090782, decouple_loss:0.001224507112056017
The modified gen p mean: 0.4504478871822357, gen p mean: -0.04952198639512062, mean p set: 0.4509281814098358The modified gen p mean: 0.45045846700668335, gen p mean: -0.04367601498961449, mean p set: 0.45093876123428345
loss_pred:0.015943121165037155, decouple_loss:0.0010975667973980308
loss_pred:0.015653233975172043, decouple_loss:0.0013144464464858174
2023-05-01 09:27:16 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.050641726702451706, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.046625588089227676, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.047005292028188705, mean p set: 0.4500633478164673
loss_pred:0.018382420763373375, decouple_loss:0.0012865805765613914
loss_pred:0.017382469028234482, decouple_loss:0.0012507912470027804
loss_pred:0.017429431900382042, decouple_loss:0.0011533397482708097
WV_0_PC_1_EH_0_PS_40, loss: 0.017792953178286552, avg_mse: 0.025563355535268784
current test mse: 0.025563
Iteration: 1051, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503079950809479, gen p mean: -0.04529866203665733, mean p set: 0.450788289308548
The modified gen p mean: 0.451941579580307, gen p mean: -0.03951895236968994, mean p set: 0.4524218738079071
The modified gen p mean: 0.4514724612236023, gen p mean: -0.040632057934999466, mean p set: 0.4519527554512024
loss_pred:0.015261758118867874, decouple_loss:0.0012311942409723997
loss_pred:0.015628308057785034, decouple_loss:0.0011538673425093293
loss_pred:0.015266891568899155, decouple_loss:0.001264867722056806
Iteration: 1052, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511999487876892, gen p mean: -0.0393201969563961, mean p set: 0.4516802132129669
loss_pred:0.014910055324435234, decouple_loss:0.0010648372117429972
The modified gen p mean: 0.4497283101081848, gen p mean: -0.0406833253800869, mean p set: 0.4502086043357849The modified gen p mean: 0.4520137310028076, gen p mean: -0.036743149161338806, mean p set: 0.4524940252304077
loss_pred:0.015236417762935162, decouple_loss:0.0012456354452297091
loss_pred:0.01552848145365715, decouple_loss:0.00106861034873873
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012011_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012011_3_24hr.npz
NaN value num: 0
Iteration: 1053, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44893988966941833, gen p mean: -0.04887135326862335, mean p set: 0.44942015409469604
loss_pred:0.01691892184317112, decouple_loss:0.0013220695545896888
The modified gen p mean: 0.4496529698371887, gen p mean: -0.04807009547948837, mean p set: 0.4501332640647888The modified gen p mean: 0.4484826624393463, gen p mean: -0.048177704215049744, mean p set: 0.4489629566669464
loss_pred:0.017016088590025902, decouple_loss:0.0012436241377145052
loss_pred:0.016877831891179085, decouple_loss:0.0012794678332284093
Iteration: 1054, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4536886215209961, gen p mean: -0.044741999357938766, mean p set: 0.4541688859462738
loss_pred:0.016290932893753052, decouple_loss:0.001141240238212049
The modified gen p mean: 0.44970130920410156, gen p mean: -0.046061113476753235, mean p set: 0.45018160343170166The modified gen p mean: 0.45334023237228394, gen p mean: -0.04343307018280029, mean p set: 0.4538205564022064
loss_pred:0.017261527478694916, decouple_loss:0.0010556711349636316
loss_pred:0.017085792496800423, decouple_loss:0.001092134159989655
Iteration: 1055, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44835197925567627, gen p mean: -0.044536661356687546, mean p set: 0.44883227348327637
loss_pred:0.017090028151869774, decouple_loss:0.0011622975580394268
The modified gen p mean: 0.4529041349887848, gen p mean: -0.04014812782406807, mean p set: 0.4533843994140625The modified gen p mean: 0.4527861773967743, gen p mean: -0.04366051405668259, mean p set: 0.4532664716243744
loss_pred:0.01700037345290184, decouple_loss:0.0012384816072881222
loss_pred:0.01626500114798546, decouple_loss:0.0012192666763439775
Iteration: 1056, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496348202228546, gen p mean: -0.04863067343831062, mean p set: 0.4501151144504547
loss_pred:0.016567101702094078, decouple_loss:0.0011144836898893118
The modified gen p mean: 0.45147180557250977, gen p mean: -0.04361947998404503, mean p set: 0.45195209980010986The modified gen p mean: 0.44916778802871704, gen p mean: -0.04474782198667526, mean p set: 0.44964808225631714
loss_pred:0.017076276242733, decouple_loss:0.0011913895141333342
loss_pred:0.016649845987558365, decouple_loss:0.0010950487339869142
Iteration: 1057, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505113959312439, gen p mean: -0.04050803929567337, mean p set: 0.4509917199611664
loss_pred:0.016173740848898888, decouple_loss:0.0012309851590543985
The modified gen p mean: 0.4536969065666199, gen p mean: -0.04247491434216499, mean p set: 0.45417720079421997The modified gen p mean: 0.4494574964046478, gen p mean: -0.04387759044766426, mean p set: 0.4499378204345703
loss_pred:0.01704571209847927, decouple_loss:0.0011186430929228663
loss_pred:0.016655631363391876, decouple_loss:0.001138622872531414
Iteration: 1058, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4534391462802887, gen p mean: -0.04018515348434448, mean p set: 0.4539194405078888
loss_pred:0.015992436558008194, decouple_loss:0.0011523839784786105
The modified gen p mean: 0.45128703117370605, gen p mean: -0.04504416882991791, mean p set: 0.45176732540130615The modified gen p mean: 0.45138779282569885, gen p mean: -0.04684465378522873, mean p set: 0.45186808705329895
loss_pred:0.016861433163285255, decouple_loss:0.0011985627934336662
loss_pred:0.015562564134597778, decouple_loss:0.001079134177416563
Iteration: 1059, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45116493105888367, gen p mean: -0.04481527581810951, mean p set: 0.45164522528648376
loss_pred:0.016703560948371887, decouple_loss:0.0010976995108649135
The modified gen p mean: 0.44795286655426025, gen p mean: -0.04110310971736908, mean p set: 0.44843316078186035The modified gen p mean: 0.45353665947914124, gen p mean: -0.046088043600320816, mean p set: 0.4540169835090637
loss_pred:0.01707468368113041, decouple_loss:0.0010363248875364661
loss_pred:0.01584104634821415, decouple_loss:0.0010682758875191212
Iteration: 1060, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490250051021576, gen p mean: -0.04125180467963219, mean p set: 0.4495052993297577
loss_pred:0.01653185673058033, decouple_loss:0.0010389020899310708
The modified gen p mean: 0.4525482952594757, gen p mean: -0.04343462735414505, mean p set: 0.4530285596847534The modified gen p mean: 0.452358216047287, gen p mean: -0.039766810834407806, mean p set: 0.4528384804725647
loss_pred:0.016319535672664642, decouple_loss:0.0010419391328468919
loss_pred:0.015837404876947403, decouple_loss:0.001162190455943346
2023-05-01 09:29:45 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.04936537146568298, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04588878154754639, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04628570377826691, mean p set: 0.4500633478164673
loss_pred:0.018404215574264526, decouple_loss:0.0011242994805797935
loss_pred:0.017314760014414787, decouple_loss:0.0011351046850904822
loss_pred:0.017402488738298416, decouple_loss:0.0011322784703224897
WV_0_PC_1_EH_0_PS_40, loss: 0.017763681709766388, avg_mse: 0.025503985583782196
current test mse: 0.025504
Iteration: 1061, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493475556373596, gen p mean: -0.04316317290067673, mean p set: 0.4498278796672821
The modified gen p mean: 0.45189160108566284, gen p mean: -0.04121780022978783, mean p set: 0.45237189531326294
The modified gen p mean: 0.4519825875759125, gen p mean: -0.03914368152618408, mean p set: 0.4524628818035126
loss_pred:0.016270259395241737, decouple_loss:0.0011011079186573625
loss_pred:0.016747884452342987, decouple_loss:0.0010721269063651562
loss_pred:0.016188645735383034, decouple_loss:0.0011059048119932413
Iteration: 1062, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502444267272949, gen p mean: -0.040325697511434555, mean p set: 0.450724720954895
loss_pred:0.01588979922235012, decouple_loss:0.0011861083330586553
The modified gen p mean: 0.45214441418647766, gen p mean: -0.04343586787581444, mean p set: 0.45262470841407776The modified gen p mean: 0.44904935359954834, gen p mean: -0.043963827192783356, mean p set: 0.44952961802482605
loss_pred:0.016056373715400696, decouple_loss:0.001037787413224578
loss_pred:0.01668059639632702, decouple_loss:0.001069427002221346
Iteration: 1063, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4538688063621521, gen p mean: -0.045160021632909775, mean p set: 0.4543490707874298
loss_pred:0.015902811661362648, decouple_loss:0.001210271380841732
The modified gen p mean: 0.4518738090991974, gen p mean: -0.04140683263540268, mean p set: 0.4523541033267975The modified gen p mean: 0.4521077275276184, gen p mean: -0.04128043353557587, mean p set: 0.4525880217552185
loss_pred:0.016047371551394463, decouple_loss:0.0010715575190261006
loss_pred:0.016015226021409035, decouple_loss:0.0010815543355420232
Iteration: 1064, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45027536153793335, gen p mean: -0.038107842206954956, mean p set: 0.45075568556785583
loss_pred:0.016115421429276466, decouple_loss:0.001106109470129013
The modified gen p mean: 0.45065250992774963, gen p mean: -0.04506388306617737, mean p set: 0.45113280415534973The modified gen p mean: 0.4490574300289154, gen p mean: -0.04327854514122009, mean p set: 0.4495377540588379
loss_pred:0.016860567033290863, decouple_loss:0.0010467584943398833
loss_pred:0.015531021170318127, decouple_loss:0.0010734018869698048
Iteration: 1065, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4527747631072998, gen p mean: -0.03944697976112366, mean p set: 0.4532550275325775
loss_pred:0.01587144285440445, decouple_loss:0.00117608648724854
The modified gen p mean: 0.45162874460220337, gen p mean: -0.040038250386714935, mean p set: 0.45210903882980347The modified gen p mean: 0.44947129487991333, gen p mean: -0.04423147439956665, mean p set: 0.4499515891075134
loss_pred:0.016687573865056038, decouple_loss:0.0010975729674100876
loss_pred:0.016229648143053055, decouple_loss:0.0011081686243414879
Iteration: 1066, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511868953704834, gen p mean: -0.043480247259140015, mean p set: 0.4516671597957611
loss_pred:0.016739798709750175, decouple_loss:0.0011585293104872108
The modified gen p mean: 0.44776785373687744, gen p mean: -0.04595685377717018, mean p set: 0.4482481777667999The modified gen p mean: 0.4479731023311615, gen p mean: -0.045402560383081436, mean p set: 0.448453426361084
loss_pred:0.01689138263463974, decouple_loss:0.0011201362358406186
loss_pred:0.016714906319975853, decouple_loss:0.0010728522902354598
Iteration: 1067, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490417540073395, gen p mean: -0.045020513236522675, mean p set: 0.4495220482349396
loss_pred:0.01674112118780613, decouple_loss:0.0010730642825365067
The modified gen p mean: 0.4502812325954437, gen p mean: -0.04461147263646126, mean p set: 0.4507615268230438The modified gen p mean: 0.4503602981567383, gen p mean: -0.03668951243162155, mean p set: 0.4508405923843384
loss_pred:0.01650306023657322, decouple_loss:0.0010361362947151065
loss_pred:0.015974652022123337, decouple_loss:0.001068839686922729
Iteration: 1068, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45263221859931946, gen p mean: -0.0431629940867424, mean p set: 0.45311251282691956
loss_pred:0.015323835425078869, decouple_loss:0.0011055201757699251
The modified gen p mean: 0.45214828848838806, gen p mean: -0.04015449061989784, mean p set: 0.45262858271598816The modified gen p mean: 0.45114830136299133, gen p mean: -0.045614153146743774, mean p set: 0.45162856578826904
loss_pred:0.01648418977856636, decouple_loss:0.0012271287851035595
loss_pred:0.015364943072199821, decouple_loss:0.0010349132353439927
Iteration: 1069, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514996409416199, gen p mean: -0.04107711464166641, mean p set: 0.45197993516921997
loss_pred:0.016187133267521858, decouple_loss:0.001060088281519711
The modified gen p mean: 0.45039981603622437, gen p mean: -0.04110172763466835, mean p set: 0.45088011026382446The modified gen p mean: 0.44961437582969666, gen p mean: -0.04806733876466751, mean p set: 0.45009464025497437
loss_pred:0.015795515850186348, decouple_loss:0.0010977458441630006
loss_pred:0.016206907108426094, decouple_loss:0.0010460061021149158
Iteration: 1070, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44802621006965637, gen p mean: -0.044712893664836884, mean p set: 0.44850653409957886
loss_pred:0.016897423192858696, decouple_loss:0.0009906445629894733
The modified gen p mean: 0.4515826106071472, gen p mean: -0.04421131685376167, mean p set: 0.4520629048347473The modified gen p mean: 0.45109039545059204, gen p mean: -0.0443505123257637, mean p set: 0.45157068967819214
loss_pred:0.016336411237716675, decouple_loss:0.0010332823731005192
loss_pred:0.016240542754530907, decouple_loss:0.0011045531136915088
2023-05-01 09:31:38 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.05229690670967102, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04860837757587433, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.0492694154381752, mean p set: 0.4500633478164673
loss_pred:0.018388735130429268, decouple_loss:0.0011991043575108051
loss_pred:0.01733095571398735, decouple_loss:0.001172091462649405
loss_pred:0.01739264652132988, decouple_loss:0.0011674335692077875
WV_0_PC_1_EH_0_PS_40, loss: 0.017763089388608932, avg_mse: 0.025504061952233315
current test mse: 0.025504
Iteration: 1071, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44808679819107056, gen p mean: -0.04884810000658035, mean p set: 0.44856709241867065
The modified gen p mean: 0.4522474408149719, gen p mean: -0.043149709701538086, mean p set: 0.452727735042572
The modified gen p mean: 0.4527755677700043, gen p mean: -0.04502040520310402, mean p set: 0.45325586199760437
loss_pred:0.016426339745521545, decouple_loss:0.0010764183243736625
loss_pred:0.016792455688118935, decouple_loss:0.0010622459230944514
loss_pred:0.0156432893127203, decouple_loss:0.001181268715299666
Iteration: 1072, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513629972934723, gen p mean: -0.04271611198782921, mean p set: 0.4518432915210724
The modified gen p mean: 0.4505225718021393, gen p mean: -0.03961281478404999, mean p set: 0.4510028660297394
loss_pred:0.0160500630736351, decouple_loss:0.0010156395146623254
loss_pred:0.015890343114733696, decouple_loss:0.00098618830088526The modified gen p mean: 0.45012110471725464, gen p mean: -0.044016558676958084, mean p set: 0.45060133934020996
loss_pred:0.015629684552550316, decouple_loss:0.0010135520715266466
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012000_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012000_3_24hr.npz
NaN value num: 0
Iteration: 1073, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44937461614608765, gen p mean: -0.04639500007033348, mean p set: 0.44985491037368774
loss_pred:0.014791448600590229, decouple_loss:0.0010874556610360742
The modified gen p mean: 0.4501919448375702, gen p mean: -0.04361829161643982, mean p set: 0.4506722390651703The modified gen p mean: 0.4488963186740875, gen p mean: -0.04748331010341644, mean p set: 0.4493766129016876
loss_pred:0.01481109019368887, decouple_loss:0.0011118189431726933
loss_pred:0.014696820639073849, decouple_loss:0.001141803222708404
Iteration: 1074, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473118782043457, gen p mean: -0.05402982234954834, mean p set: 0.4477921724319458
loss_pred:0.013992857187986374, decouple_loss:0.001167222624644637
The modified gen p mean: 0.44876590371131897, gen p mean: -0.047485172748565674, mean p set: 0.44924619793891907The modified gen p mean: 0.4490028917789459, gen p mean: -0.04826528951525688, mean p set: 0.44948315620422363
loss_pred:0.014377204701304436, decouple_loss:0.0010366546921432018
loss_pred:0.014634424820542336, decouple_loss:0.0011048606829717755
Iteration: 1075, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484160840511322, gen p mean: -0.052226338535547256, mean p set: 0.4488963484764099
loss_pred:0.013930453918874264, decouple_loss:0.0011726116063073277
The modified gen p mean: 0.4488517940044403, gen p mean: -0.05336638167500496, mean p set: 0.4493320882320404The modified gen p mean: 0.44738543033599854, gen p mean: -0.05484958365559578, mean p set: 0.44786572456359863
loss_pred:0.013774437829852104, decouple_loss:0.0012018020497635007
loss_pred:0.01387455128133297, decouple_loss:0.0011943936115130782
Iteration: 1076, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44736942648887634, gen p mean: -0.04789475351572037, mean p set: 0.44784975051879883
loss_pred:0.013509633019566536, decouple_loss:0.0012532848631963134
The modified gen p mean: 0.4478943645954132, gen p mean: -0.054150402545928955, mean p set: 0.4483746588230133The modified gen p mean: 0.4461825489997864, gen p mean: -0.05432942882180214, mean p set: 0.4466628134250641
loss_pred:0.014423694461584091, decouple_loss:0.0012355436338111758
loss_pred:0.013752882368862629, decouple_loss:0.0012974324636161327
Iteration: 1077, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473456144332886, gen p mean: -0.04704192653298378, mean p set: 0.44782590866088867
loss_pred:0.014030678197741508, decouple_loss:0.0012959627201780677
The modified gen p mean: 0.4464013874530792, gen p mean: -0.04971761628985405, mean p set: 0.4468816816806793The modified gen p mean: 0.44794389605522156, gen p mean: -0.0516057088971138, mean p set: 0.44842419028282166
loss_pred:0.014029646292328835, decouple_loss:0.0013836654834449291
loss_pred:0.013936600647866726, decouple_loss:0.0012878826819360256
Iteration: 1078, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488774240016937, gen p mean: -0.05356937646865845, mean p set: 0.4493577182292938
loss_pred:0.01299373246729374, decouple_loss:0.0013187979348003864
The modified gen p mean: 0.4481538236141205, gen p mean: -0.05336223542690277, mean p set: 0.44863414764404297The modified gen p mean: 0.4491006135940552, gen p mean: -0.04745551198720932, mean p set: 0.4495809078216553
loss_pred:0.01394387986510992, decouple_loss:0.001262960839085281
loss_pred:0.013358400203287601, decouple_loss:0.0012572379782795906
Iteration: 1079, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44693154096603394, gen p mean: -0.0547855980694294, mean p set: 0.44741183519363403
loss_pred:0.013469898141920567, decouple_loss:0.001545711187645793
The modified gen p mean: 0.4492894113063812, gen p mean: -0.046607472002506256, mean p set: 0.44976967573165894The modified gen p mean: 0.4476581811904907, gen p mean: -0.04837080463767052, mean p set: 0.4481384754180908
loss_pred:0.013669177889823914, decouple_loss:0.0013278827536851168
loss_pred:0.013060546480119228, decouple_loss:0.001520997961051762
Iteration: 1080, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464573562145233, gen p mean: -0.05049808695912361, mean p set: 0.4469376802444458
loss_pred:0.013817079365253448, decouple_loss:0.0014866574201732874
The modified gen p mean: 0.44902482628822327, gen p mean: -0.04956653714179993, mean p set: 0.44950512051582336The modified gen p mean: 0.4487685561180115, gen p mean: -0.05295019969344139, mean p set: 0.44924888014793396
loss_pred:0.0135646415874362, decouple_loss:0.0013382891193032265
loss_pred:0.013422920368611813, decouple_loss:0.0013147835852578282
2023-05-01 09:34:10 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.05761810019612312, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.05380190163850784, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.054593805223703384, mean p set: 0.4500633478164673
loss_pred:0.019261466339230537, decouple_loss:0.0013970760628581047
loss_pred:0.01819664239883423, decouple_loss:0.0013743588933721185
loss_pred:0.018172452226281166, decouple_loss:0.001421533990651369
WV_0_PC_1_EH_0_PS_40, loss: 0.018613403663039207, avg_mse: 0.027093349024653435
current test mse: 0.027093
Iteration: 1081, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468691051006317, gen p mean: -0.059659428894519806, mean p set: 0.4473493695259094
The modified gen p mean: 0.44661128520965576, gen p mean: -0.056430019438266754, mean p set: 0.44709157943725586
The modified gen p mean: 0.4492303431034088, gen p mean: -0.05779746547341347, mean p set: 0.4497106075286865
loss_pred:0.013514968566596508, decouple_loss:0.0014220377197489142
loss_pred:0.013486113399267197, decouple_loss:0.001288721919991076
loss_pred:0.013334186747670174, decouple_loss:0.0013047719839960337
Iteration: 1082, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44871610403060913, gen p mean: -0.059303123503923416, mean p set: 0.4491964280605316
loss_pred:0.01281012874096632, decouple_loss:0.001515743206255138
The modified gen p mean: 0.44705814123153687, gen p mean: -0.05709930509328842, mean p set: 0.44753846526145935The modified gen p mean: 0.4470460116863251, gen p mean: -0.058491576462984085, mean p set: 0.44752633571624756
loss_pred:0.012864011339843273, decouple_loss:0.0014246952487155795
loss_pred:0.01350949052721262, decouple_loss:0.0013823090121150017
Iteration: 1083, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482777416706085, gen p mean: -0.05688898265361786, mean p set: 0.4487580358982086
loss_pred:0.012610260397195816, decouple_loss:0.0013909318950027227
The modified gen p mean: 0.44775640964508057, gen p mean: -0.052279312163591385, mean p set: 0.44823670387268066The modified gen p mean: 0.4493301808834076, gen p mean: -0.052244774997234344, mean p set: 0.4498105049133301
loss_pred:0.013405770994722843, decouple_loss:0.001345631550066173
loss_pred:0.013375927694141865, decouple_loss:0.00138680764939636
Iteration: 1084, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44793716073036194, gen p mean: -0.04892028868198395, mean p set: 0.44841745495796204
loss_pred:0.012964989989995956, decouple_loss:0.0015051554655656219
The modified gen p mean: 0.44830477237701416, gen p mean: -0.052924029529094696, mean p set: 0.44878509640693665The modified gen p mean: 0.4480293095111847, gen p mean: -0.05270375311374664, mean p set: 0.4485096037387848
loss_pred:0.013247525319457054, decouple_loss:0.0016074900049716234
loss_pred:0.013423007912933826, decouple_loss:0.0015847592148929834
Iteration: 1085, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44750961661338806, gen p mean: -0.05419270321726799, mean p set: 0.44798991084098816
loss_pred:0.012561136856675148, decouple_loss:0.001270559849217534
The modified gen p mean: 0.44783085584640503, gen p mean: -0.05110059306025505, mean p set: 0.4483111500740051The modified gen p mean: 0.44831985235214233, gen p mean: -0.05653708800673485, mean p set: 0.44880014657974243
loss_pred:0.012870434671640396, decouple_loss:0.0012953527038916945
loss_pred:0.013708705082535744, decouple_loss:0.0014831859152764082
Iteration: 1086, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44921791553497314, gen p mean: -0.049485284835100174, mean p set: 0.44969815015792847
loss_pred:0.013310900889337063, decouple_loss:0.0013179020024836063
The modified gen p mean: 0.4488295018672943, gen p mean: -0.054143570363521576, mean p set: 0.4493098258972168The modified gen p mean: 0.4472600817680359, gen p mean: -0.05110405758023262, mean p set: 0.4477404057979584
loss_pred:0.01273323129862547, decouple_loss:0.0015921111917123199
loss_pred:0.013064689934253693, decouple_loss:0.0015883849700912833
Iteration: 1087, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485984742641449, gen p mean: -0.05158011615276337, mean p set: 0.449078768491745
loss_pred:0.013063892722129822, decouple_loss:0.0014906880678609014
The modified gen p mean: 0.4482327103614807, gen p mean: -0.05544731393456459, mean p set: 0.4487130343914032The modified gen p mean: 0.4474874436855316, gen p mean: -0.055878255516290665, mean p set: 0.4479677379131317
loss_pred:0.013082338497042656, decouple_loss:0.0013316216645762324
loss_pred:0.01291911955922842, decouple_loss:0.0015334992203861475
Iteration: 1088, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449720174074173, gen p mean: -0.053312644362449646, mean p set: 0.45020049810409546
loss_pred:0.013407151214778423, decouple_loss:0.0012280324008315802
The modified gen p mean: 0.4460189938545227, gen p mean: -0.05373234674334526, mean p set: 0.4464992880821228The modified gen p mean: 0.44790494441986084, gen p mean: -0.049639664590358734, mean p set: 0.44838523864746094
loss_pred:0.013604576699435711, decouple_loss:0.0012404238805174828
loss_pred:0.013641596771776676, decouple_loss:0.001304737525060773
Iteration: 1089, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44823944568634033, gen p mean: -0.054330676794052124, mean p set: 0.4487197697162628
loss_pred:0.013047202490270138, decouple_loss:0.0014766056556254625
The modified gen p mean: 0.4491988718509674, gen p mean: -0.05610515549778938, mean p set: 0.4496791362762451The modified gen p mean: 0.4472804069519043, gen p mean: -0.05346938222646713, mean p set: 0.447760671377182
loss_pred:0.012992705218493938, decouple_loss:0.0014623799361288548
loss_pred:0.013471798971295357, decouple_loss:0.0013699136907234788
Iteration: 1090, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44858017563819885, gen p mean: -0.050179921090602875, mean p set: 0.44906049966812134
loss_pred:0.013281854800879955, decouple_loss:0.0013976299669593573
The modified gen p mean: 0.44693103432655334, gen p mean: -0.054858241230249405, mean p set: 0.44741132855415344The modified gen p mean: 0.4474087357521057, gen p mean: -0.05511179193854332, mean p set: 0.4478890001773834
loss_pred:0.013332873582839966, decouple_loss:0.001527481246739626
loss_pred:0.01322283037006855, decouple_loss:0.0012944266200065613
2023-05-01 09:36:03 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.05852869153022766, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.05455009639263153, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.055177319794893265, mean p set: 0.4500633478164673
loss_pred:0.019097207114100456, decouple_loss:0.0012476403499022126
loss_pred:0.018096333369612694, decouple_loss:0.00125648092944175
loss_pred:0.018043382093310356, decouple_loss:0.001231015776284039
WV_0_PC_1_EH_0_PS_40, loss: 0.018474560230970383, avg_mse: 0.02689753845334053
current test mse: 0.026898
Iteration: 1091, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447195440530777, gen p mean: -0.05551380291581154, mean p set: 0.4476757347583771
The modified gen p mean: 0.44701382517814636, gen p mean: -0.05279092863202095, mean p set: 0.44749414920806885
The modified gen p mean: 0.4500364065170288, gen p mean: -0.05126865580677986, mean p set: 0.4505167305469513
loss_pred:0.013764919713139534, decouple_loss:0.0011909259483218193
loss_pred:0.012896448373794556, decouple_loss:0.001202176557853818
loss_pred:0.01319138240069151, decouple_loss:0.0013560401275753975
Iteration: 1092, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481850862503052, gen p mean: -0.0544237457215786, mean p set: 0.44866541028022766
loss_pred:0.013167657889425755, decouple_loss:0.001255487441085279
The modified gen p mean: 0.4471631646156311, gen p mean: -0.055000413209199905, mean p set: 0.4476434886455536The modified gen p mean: 0.4476604163646698, gen p mean: -0.05269297584891319, mean p set: 0.4481406807899475
loss_pred:0.013087525963783264, decouple_loss:0.0012966826325282454
loss_pred:0.01295274868607521, decouple_loss:0.0013020028127357364
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012015_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012015_3_24hr.npz
NaN value num: 0
Iteration: 1093, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44676896929740906, gen p mean: -0.047455091029405594, mean p set: 0.44724923372268677
loss_pred:0.018982775509357452, decouple_loss:0.001242208993062377
The modified gen p mean: 0.44777151942253113, gen p mean: -0.052267152816057205, mean p set: 0.4482518434524536The modified gen p mean: 0.44663065671920776, gen p mean: -0.05835683271288872, mean p set: 0.4471109211444855
loss_pred:0.018609553575515747, decouple_loss:0.001211503054946661
loss_pred:0.01913638599216938, decouple_loss:0.0012819459661841393
Iteration: 1094, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473522901535034, gen p mean: -0.05004484951496124, mean p set: 0.4478325843811035
loss_pred:0.0190263744443655, decouple_loss:0.0013124747201800346
The modified gen p mean: 0.446615993976593, gen p mean: -0.043650828301906586, mean p set: 0.4470962882041931The modified gen p mean: 0.4458296000957489, gen p mean: -0.04296945035457611, mean p set: 0.4463099241256714
loss_pred:0.019323620945215225, decouple_loss:0.001306819962337613
loss_pred:0.018535569310188293, decouple_loss:0.0012959575979039073
Iteration: 1095, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44784945249557495, gen p mean: -0.051640383899211884, mean p set: 0.44832971692085266
loss_pred:0.01878889463841915, decouple_loss:0.0013324738247320056
The modified gen p mean: 0.44685637950897217, gen p mean: -0.046434186398983, mean p set: 0.44733667373657227The modified gen p mean: 0.4489671587944031, gen p mean: -0.04473938047885895, mean p set: 0.4494474530220032
loss_pred:0.019310811534523964, decouple_loss:0.0013278480619192123
loss_pred:0.018631305545568466, decouple_loss:0.0014130683848634362
Iteration: 1096, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44693970680236816, gen p mean: -0.04870828613638878, mean p set: 0.4474199414253235
loss_pred:0.01908775046467781, decouple_loss:0.0014726587105542421
The modified gen p mean: 0.44541826844215393, gen p mean: -0.04564337804913521, mean p set: 0.44589856266975403The modified gen p mean: 0.4461279511451721, gen p mean: -0.052683863788843155, mean p set: 0.4466082453727722
loss_pred:0.01865139789879322, decouple_loss:0.0014276234433054924
loss_pred:0.017770089209079742, decouple_loss:0.0013280995190143585
Iteration: 1097, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481044113636017, gen p mean: -0.04863899201154709, mean p set: 0.4485847055912018
loss_pred:0.01828644797205925, decouple_loss:0.0013916345778852701
The modified gen p mean: 0.44697073101997375, gen p mean: -0.04980573058128357, mean p set: 0.44745099544525146The modified gen p mean: 0.44561466574668884, gen p mean: -0.0465429313480854, mean p set: 0.44609498977661133
loss_pred:0.01856161095201969, decouple_loss:0.001466425135731697
loss_pred:0.018103042617440224, decouple_loss:0.0014378895284608006
Iteration: 1098, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474208950996399, gen p mean: -0.05590182542800903, mean p set: 0.4479012191295624
loss_pred:0.018385475501418114, decouple_loss:0.0012412715004757047
The modified gen p mean: 0.4479689598083496, gen p mean: -0.05711092799901962, mean p set: 0.4484492540359497The modified gen p mean: 0.44766369462013245, gen p mean: -0.05603018403053284, mean p set: 0.44814398884773254
loss_pred:0.01754808984696865, decouple_loss:0.0013007409870624542
loss_pred:0.017992906272411346, decouple_loss:0.0012743930565193295
Iteration: 1099, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471697509288788, gen p mean: -0.05790633335709572, mean p set: 0.4476500451564789
loss_pred:0.01820491813123226, decouple_loss:0.0013408950762823224
The modified gen p mean: 0.4463559091091156, gen p mean: -0.060633640736341476, mean p set: 0.4468361735343933The modified gen p mean: 0.44757890701293945, gen p mean: -0.0606527216732502, mean p set: 0.44805923104286194
loss_pred:0.0181179940700531, decouple_loss:0.0014317469904199243
loss_pred:0.018206698819994926, decouple_loss:0.001344882883131504
Iteration: 1100, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480862617492676, gen p mean: -0.0612235963344574, mean p set: 0.4485665559768677
loss_pred:0.018094908446073532, decouple_loss:0.0013899996411055326
The modified gen p mean: 0.44708627462387085, gen p mean: -0.059794869273900986, mean p set: 0.44756653904914856The modified gen p mean: 0.44770190119743347, gen p mean: -0.0655788853764534, mean p set: 0.44818219542503357
loss_pred:0.018061736598610878, decouple_loss:0.0013608253793790936
loss_pred:0.01801935024559498, decouple_loss:0.0013723501469939947
2023-05-01 09:38:34 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.062060751020908356, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.0585903637111187, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.05859629809856415, mean p set: 0.4500633478164673
loss_pred:0.01840970665216446, decouple_loss:0.0012775234645232558
loss_pred:0.01733783259987831, decouple_loss:0.0012619434855878353
loss_pred:0.017480872571468353, decouple_loss:0.0012498340802267194
WV_0_PC_1_EH_0_PS_40, loss: 0.017805960029363632, avg_mse: 0.025533612817525864
current test mse: 0.025534
Iteration: 1101, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474359452724457, gen p mean: -0.06003224849700928, mean p set: 0.4479162395000458
The modified gen p mean: 0.4461263120174408, gen p mean: -0.05918361619114876, mean p set: 0.4466065764427185
The modified gen p mean: 0.4479663074016571, gen p mean: -0.059360042214393616, mean p set: 0.4484466016292572
loss_pred:0.017949411645531654, decouple_loss:0.0013100472278892994
loss_pred:0.01792985573410988, decouple_loss:0.0012210436398163438
loss_pred:0.01835225336253643, decouple_loss:0.0011797264451161027
Iteration: 1102, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44873663783073425, gen p mean: -0.05528184026479721, mean p set: 0.44921690225601196
loss_pred:0.017985349521040916, decouple_loss:0.0013350893277674913
The modified gen p mean: 0.4478876292705536, gen p mean: -0.06040411442518234, mean p set: 0.4483678936958313The modified gen p mean: 0.44643425941467285, gen p mean: -0.05849667266011238, mean p set: 0.44691455364227295
loss_pred:0.017447564750909805, decouple_loss:0.001354304957203567
loss_pred:0.017879383638501167, decouple_loss:0.0013317159609869123
Iteration: 1103, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.445453941822052, gen p mean: -0.0600983165204525, mean p set: 0.4459342360496521
loss_pred:0.017740406095981598, decouple_loss:0.0012499731965363026
The modified gen p mean: 0.44683387875556946, gen p mean: -0.05470496788620949, mean p set: 0.44731420278549194The modified gen p mean: 0.44816336035728455, gen p mean: -0.05738334357738495, mean p set: 0.44864365458488464
loss_pred:0.01765488274395466, decouple_loss:0.0012396994279697537
loss_pred:0.017968323081731796, decouple_loss:0.0013154703192412853
Iteration: 1104, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4461621940135956, gen p mean: -0.055327557027339935, mean p set: 0.4466424882411957
loss_pred:0.018462108448147774, decouple_loss:0.0011684275232255459
The modified gen p mean: 0.4470093846321106, gen p mean: -0.05296109989285469, mean p set: 0.4474896788597107The modified gen p mean: 0.4479116201400757, gen p mean: -0.05038423091173172, mean p set: 0.4483919143676758
loss_pred:0.017639225348830223, decouple_loss:0.0011524236761033535
loss_pred:0.017564093694090843, decouple_loss:0.0011135886888951063
Iteration: 1105, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4452609717845917, gen p mean: -0.05862855911254883, mean p set: 0.4457412362098694
loss_pred:0.017864573746919632, decouple_loss:0.0012597194872796535
The modified gen p mean: 0.4463479816913605, gen p mean: -0.05370939522981644, mean p set: 0.44682827591896057The modified gen p mean: 0.44811344146728516, gen p mean: -0.05439281836152077, mean p set: 0.44859373569488525
loss_pred:0.018306083977222443, decouple_loss:0.0012290291488170624
loss_pred:0.017737695947289467, decouple_loss:0.0012221414363011718
Iteration: 1106, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44718998670578003, gen p mean: -0.05616135522723198, mean p set: 0.4476702809333801
loss_pred:0.01758534088730812, decouple_loss:0.0012134795542806387
The modified gen p mean: 0.44537967443466187, gen p mean: -0.05336049571633339, mean p set: 0.4458599388599396The modified gen p mean: 0.44587939977645874, gen p mean: -0.053884752094745636, mean p set: 0.44635969400405884
loss_pred:0.017938997596502304, decouple_loss:0.0013038943288847804
loss_pred:0.017708081752061844, decouple_loss:0.001258920761756599
Iteration: 1107, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4462960660457611, gen p mean: -0.06119280308485031, mean p set: 0.4467763900756836
loss_pred:0.017727162688970566, decouple_loss:0.0012470538495108485
The modified gen p mean: 0.4478360414505005, gen p mean: -0.05241154506802559, mean p set: 0.4483163356781006The modified gen p mean: 0.4478738307952881, gen p mean: -0.056410595774650574, mean p set: 0.4483541250228882
loss_pred:0.018069949001073837, decouple_loss:0.0012011852813884616
loss_pred:0.017746934667229652, decouple_loss:0.001313759945333004
Iteration: 1108, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471026659011841, gen p mean: -0.0547909215092659, mean p set: 0.4475829601287842
loss_pred:0.01711893081665039, decouple_loss:0.0012735442724078894
The modified gen p mean: 0.44656720757484436, gen p mean: -0.055677302181720734, mean p set: 0.44704747200012207The modified gen p mean: 0.44539394974708557, gen p mean: -0.05456226319074631, mean p set: 0.44587424397468567
loss_pred:0.017824335023760796, decouple_loss:0.0013578780926764011
loss_pred:0.01827697828412056, decouple_loss:0.0014007861027494073
Iteration: 1109, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466838240623474, gen p mean: -0.05954352021217346, mean p set: 0.4471641182899475
loss_pred:0.018134716898202896, decouple_loss:0.0012452572118490934
The modified gen p mean: 0.44625091552734375, gen p mean: -0.0625542551279068, mean p set: 0.44673120975494385The modified gen p mean: 0.44641926884651184, gen p mean: -0.05578995496034622, mean p set: 0.4468995928764343
loss_pred:0.017734477296471596, decouple_loss:0.0012368627358227968
loss_pred:0.01784207485616207, decouple_loss:0.001231062924489379
Iteration: 1110, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44745323061943054, gen p mean: -0.05553765222430229, mean p set: 0.44793352484703064
The modified gen p mean: 0.4460795223712921, gen p mean: -0.05702372267842293, mean p set: 0.4465598464012146loss_pred:0.0176154263317585, decouple_loss:0.0012987095396965742
The modified gen p mean: 0.44684791564941406, gen p mean: -0.0536251924932003, mean p set: 0.44732820987701416
loss_pred:0.017622942104935646, decouple_loss:0.0012792166089639068
loss_pred:0.01864060014486313, decouple_loss:0.001264658523723483
2023-05-01 09:40:28 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.05702200531959534, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.05363839492201805, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.05390854552388191, mean p set: 0.4500633478164673
loss_pred:0.018268924206495285, decouple_loss:0.001222105580382049
loss_pred:0.017282923683524132, decouple_loss:0.0011951994383707643
loss_pred:0.017335575073957443, decouple_loss:0.0012009099591523409
WV_0_PC_1_EH_0_PS_40, loss: 0.01768944412469864, avg_mse: 0.025334808975458145
current test mse: 0.025335
Iteration: 1111, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4458533823490143, gen p mean: -0.05561655014753342, mean p set: 0.4463336765766144
The modified gen p mean: 0.447578489780426, gen p mean: -0.059281591325998306, mean p set: 0.4480588138103485
The modified gen p mean: 0.44713306427001953, gen p mean: -0.054513685405254364, mean p set: 0.44761335849761963
loss_pred:0.01856399141252041, decouple_loss:0.0011437699431553483
loss_pred:0.01786579005420208, decouple_loss:0.0013290937058627605
loss_pred:0.018400074914097786, decouple_loss:0.0011754547012969851
Iteration: 1112, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.445504754781723, gen p mean: -0.059670496731996536, mean p set: 0.4459850490093231
loss_pred:0.017342327162623405, decouple_loss:0.0011865614214912057
The modified gen p mean: 0.44572141766548157, gen p mean: -0.053605422377586365, mean p set: 0.44620171189308167The modified gen p mean: 0.44740989804267883, gen p mean: -0.055635370314121246, mean p set: 0.44789019227027893
loss_pred:0.01838390715420246, decouple_loss:0.0012128879316151142
loss_pred:0.017686927691102028, decouple_loss:0.0012260362273082137
Traceback (most recent call last):
  File "/work/09012/haoli1/ls6/ERA5_PredRNN/predrnn-pytorch/run1.py", line 338, in <module>
    train_wrapper(model)
  File "/work/09012/haoli1/ls6/ERA5_PredRNN/predrnn-pytorch/run1.py", line 259, in train_wrapper
    train_input_handle = datasets_factory.data_provider(
  File "/work/09012/haoli1/ls6/ERA5_PredRNN/predrnn-pytorch/core/data_provider/datasets_factory.py", line 48, in data_provider
    train_input_handle = datasets_map[dataset_name].InputHandle(train_input_param)
  File "/work/09012/haoli1/ls6/ERA5_PredRNN/predrnn-pytorch/core/data_provider/mnist_new.py", line 26, in __init__
    self.load()
  File "/work/09012/haoli1/ls6/ERA5_PredRNN/predrnn-pytorch/core/data_provider/mnist_new.py", line 31, in load
    self.data['clips'] = dat_1['clips']
  File "/work/09012/haoli1/ls6/Pyt/lib/python3.9/site-packages/numpy/lib/npyio.py", line 260, in __getitem__
    raise KeyError("%s is not a file in the archive" % key)
KeyError: 'clips is not a file in the archive'
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012004_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012004_3_24hr.npz